define("DS/GEONavCommonAPI/GEONavCommonServices",["UWA/Core","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/WAFData/WAFData"],(function(e,r,o){"use strict";var t="X-DS-CSRFTOKEN";return{_csrf:"",callService:function(e,o,t){var n=this,s=e.envId?e.envId:widget.getValue("x3dPlatformId");r.getServiceUrl({serviceName:e.serviceName,platformId:s,onComplete:function(r){var s;Array.isArray(r)?r.length&&(s=r[0].url):r.constructor===String&&(s=r),n.requestService({url:s+e.URI,requestOptions:e.requestOptions},o,t)},onFailure:function(r){console.log(r.message);var o={message:"The "+e.serviceName+" Service has not been found in the platform"};t(o)}})},callFCSService:function(e,r,t){var n={method:"GET",type:"text",onComplete:function(e){r(e)},onFailure:function(e){console.log(e.message);t({message:"GEONavCommonServices: error calling FCS service"})}},s=UWA.extend(UWA.clone(n),e.requestOptions);o.authenticatedRequest(e.actionurl,s)},requestService:function(e,r,n){var s=this,a={method:"GET",type:"json",onComplete:function(e,o,t){var n=s.getCSRFTokenFromHeader(o);n&&(s._csrf=n),r(e)},onFailure:function(e){console.log(e.message);n({message:"error calling web service"})}},i=UWA.extend(UWA.clone(a),e.requestOptions);i.headers||(i.headers={}),i.headers[t]=s._csrf||"",o.authenticatedRequest(e.url,i)},getCSRFTokenFromHeader:function(e){return void 0===e?"":e[t]||e[t.toLowerCase()]}}}));