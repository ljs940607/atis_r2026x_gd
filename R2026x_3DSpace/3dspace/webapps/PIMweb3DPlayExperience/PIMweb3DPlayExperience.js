/*!  Copyright 2019 Dassault Systemes. All rights reserved. */
!function(){"use strict";let e;function t(e){return e.pimCtrl&&e.pimCtrl.clearIsr(),Object.getPrototypeOf(e.exp).clearView.apply(e.exp,e.args)}function n(e,t,n,i){var r;e&&t&&n&&(r=["onIsrAdded","onItfAdded"].map((function(t){return e.subscribe(t,o)})),e.load(n));function o(){r.forEach(e.unsubscribe,e),r=void 0,window.widget&&t.pad3DViewer.getContentName({callbacks:{onComplete:function(e){window.widget.setTitle(e.contentName)},onFailure:function(){}}}),setTimeout((function(){t.publish("ASSET/LOADINGFINISHED",{loadAssetInfo:i.asset})}),10)}}function i(i){var r,o,a=i.exp;a.clearView=function(){return t({exp:a,pimCtrl:r,args:arguments})},a.dispose=function(){var e=function(e){var n;if(e.args&&!0===e.args.disposeFrameWindow?(t(e),e.pimCtrl&&e.pimCtrl.dereference()):e.pimCtrl&&e.pimCtrl.deactivate(),e.pimExpPref&&e.exp&&e.exp.pad3DViewer&&require("DS/CATWebUXPreferences/CATWebUXPreferencesManager").unreferencePreferenceManager({context:e.exp.pad3DViewer.getFrameWindow()}),window.widget&&window.widget.setMetas({helpPath:void 0}),e.args&&!0!==e.args.disposeFrameWindow){var i=e.exp.pad3DViewer.getCommandContext();n=Object.getPrototypeOf(e.exp).dispose.apply(e.exp,e.args);var r=require("DS/CATWebUXComponents/DMUCommandsManager").getCommandCheckHeaders(i);r&&Object.keys(r).forEach((function(e){delete r[e]}))}else n=Object.getPrototypeOf(e.exp).dispose.apply(e.exp,e.args);return n}({exp:a,pimCtrl:r,pimExpPref:o,args:arguments});return r=o=null,e},a.refresh=function(){return function(e){return Object.getPrototypeOf(e.exp).refresh.apply(e.exp,e.args)}({exp:a,pimCtrl:r,args:arguments})},a.onPreCreate=function(){this.args.visu={fetchMePreferenceSettings:!0}},a.onPostCreate=function(){return r||require(["DS/PIMwebViewController/PIMwebItfCtrl"],(function(e){(r=e.getItfCtrl({pad3DViewer:a.pad3DViewer})).activate({readOnly:!0,noStatusBarCmd:!0})})),function(e){var t=e.exp.pad3DViewer;return t&&(require("DS/PADUtils/PADSettingsMgt").setSetting("settypes",!0),require("DS/CATWebUXComponents/DMUCommandsManager").setDefaultCommand({ID:"PIMwebDefaultHdr",className:"DS/PIMwebViewController/PIMwebDefaultCmd",context:t.getCommandContext()}),t.getViewer().setPicking({primitive:0,trapSelection:!0,trapPrimitive:!1,trapGPU:!0}),window.widget&&(window.widget.setMetas({helpPath:"PIMweb3DPlayExperience/assets/help"}),window.widget.dispatchEvent("onPlayExperienceReady",[{pad3DViewer:t}]))),Object.getPrototypeOf(e.exp).onPostCreate.apply(e.exp,e.args)}({exp:a,pimCtrl:r,args:arguments})},a.onLightboxReady=function(){let t=require("DS/CATWebUXComponents/DMUCommandsManager");e.lightbox.useDefaultActions(!1),e.lightbox.addAction({name:"Publish to 3DSwym",text:"Publish",fonticon:"share-alt",handler:function(){let n=t.getCommand("DMUPublishToSwymCmdHdr",e.pad3DViewer.getCommandContext());n&&n.begin()}}),e.lightbox.addAction({name:"Information",text:"Information",fonticon:"info",handler:function(){e.lightbox._lightbox.onClickInformation().begin()}}),e.lightbox.addAction({name:"more",text:"more",fonticon:"chevron-down",items:[{name:"Copy Screenshot",text:"Copy Screenshot",fonticon:"copy",handler:function(){let n=t.getCommand("DMUCaptureCmdHdr",e.pad3DViewer.getCommandContext());n&&n.begin()}},{name:"Save Screenshot",text:"Save Screenshot",fonticon:"picture-export",handler:function(){e.lightbox._lightbox.onClickSaveScreenshot()}},{name:"Print Screenshot",text:"Print Screenshot",fonticon:"print",handler:function(){e.lightbox._lightbox.onClickPrintScreenshot()}}]})},a.loadAsset=function(e){e&&e.asset&&e.asset.physicalid||window.console.log("No data provided!!"),r?(r.activate({readOnly:!0}),require("DS/PADUtils/PADUtilsServices").multiTenantMgt([{envId:e.asset.tenant,contextId:e.asset.contextid}],require("DS/ENOPAD3DViewer/utils/PAD3DViewerModelServices").getRoots(a.pad3DViewer),(function(t){t.isMultiTenant||(i.isr?n(r,a,{isrID:e.asset.physicalid},e):n(r,a,{metricID:e.asset.physicalid},e))}))):(a.pad3DViewer.setDefaultContextualMenuVisibility(!1),a.pad3DViewer.setDefaultContextualBarVisibility(!1),a.pad3DViewer.setOpenWithMenuAvailability(!1),require(["DS/PIMwebViewController/PIMwebItfCtrl"],(function(t){r=t.getItfCtrl({pad3DViewer:a.pad3DViewer}),a.loadAsset(e)})))},i.options.options&&i.options.options.pad3DViewer&&require(["DS/CATWebUXPreferences/CATWebUXPreferencesManager"].concat([]),(function(e){(o=e.getPreferenceManager({context:i.options.options.pad3DViewer.getFrameWindow()})).removeAllPreferences()})),i.options.commandApplication=!1,i.options.workbenchs=[{module:"PIMweb3DPlayExperience",name:"PIMweb3DPlayExperience"}]}define("DS/PIMweb3DPlayExperience/PIMwebIsr3DPlayExperience",["DS/3DPlayExperienceModule/PlayExperience3D"],(function(t){return t.extend({init:function(t){e=this,i({exp:this,options:t,isr:!0}),this._parent(t)}})})),define("DS/PIMweb3DPlayExperience/PIMwebItf3DPlayExperience",["DS/3DPlayExperienceModule/PlayExperience3D"],(function(t){return t.extend({init:function(t){e=this,i({exp:this,options:t,isr:!1}),this._parent(t)}})}))}();