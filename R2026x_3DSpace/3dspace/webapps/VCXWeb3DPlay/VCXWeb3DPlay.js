define("DS/VCXWeb3DPlay/VCXModelManagerPlayManager",["require","exports","DS/VCXWebComposer/VCXCAT3DXModelManager"],(function(e,t,r){"use strict";class a extends r{_GoToPreferredSceneAtStart(){let e=this._experienceBase.getManager("VCXSequenceManager");if(e.GetListSequences().length){let t=e.GetOrderedListOfAllScenariosIds(!0);if(t.length){let e=t[0];this._experienceBase.getManager("VCXAPIManager").GoToScenario(e)}}}}return Object.defineProperty(a.prototype,"componentType",{enumerable:!0,get:function(){return"VCXCAT3DXModelManager"}}),a})),define("DS/VCXWeb3DPlay/VCXNotificationPlayManager",["require","exports","DS/VCXWebKernel/VCXNotificationManager","UWA/Core"],(function(e,t,r,a){"use strict";class i extends r{constructor(){super(...arguments),this._isHide=!1}addProgressNotification(e){if(this._isHide)return;let t=this._experienceBase.getManager("VCXWeb3DPlayManager");if(t){let e=t.QueryInterface("XCTEWSIExperienceMgr");e&&e.update3DPlayProgressBar(this.computeBarValue(e.currentValue,98,100))}this.modal.show()}hideCurtain(){this.modal.style.opacity=0,this._isHide=!0,setTimeout((()=>this.modal.hide()),1e3)}postInitialize(){super.postInitialize(),this.modal=a.createElement("div",{class:"vcx-Modal-Hide"}),this.modal.hide();let e=document.getElementById("canvas-div");e&&this.modal.inject(e),this._loadingPanel=null}}return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXNotificationManager"}}),i})),define("DS/VCXWeb3DPlay/VCX3DPlayDictionary",[],(function(){"use strict";var e={VCXEWSManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},CXPCameraActor_Spec:{CATI3DExperienceObject:"DS/CAT3DExpModel/extensions/CATE3DExperienceObject",W3AISGNodeHolder:"DS/VCXWebDressup/VCXViewpoint/VCXCameraSGNodeHolder"},VCXComponentOccurrenceComposer:{CATI3DX3DActorAsset:"DS/CATCXPModel/extensions/CATE3DX3DActorOverrideAssetMedia",W3AISGNodeHolder:"DS/VCXWeb3DPlay/VCXNodeHolderAsset3DPlay",CATI3DXOverrideAssetProperties:"DS/CATCXPModel/extensions/CATE3DXOverrideAssetProperties",CATI3DExperienceObject:"DS/VCXWebComposer/CATE3DExperienceObjectNavigable",CATI3DXAssetHolder:"DS/CAT3DExpModel/extensions/CATE3DXAssetHolder"},Model_VPMReference_Spec:{CATI3DX3DActorAsset:"DS/CATCXPModel/extensions/CATE3DX3DActorAssetMedia",W3AISGNodeHolder:"DS/VCXWeb3DPlay/VCXNodeHolderAsset3DPlay",VCXIModifiable:"DS/VCXWeb3DMaster/VCXModifiableOccurrenceComposer",VCXIModifiableView:"DS/VCXWeb3DMaster/VCXModifiableViewOccurrenceComposer",CATI3DExperienceObject:"DS/VCXWebComposer/CATE3DExperienceObjectNavigable",CATI3DXAssetHolder:"DS/CAT3DExpModel/extensions/CATE3DXAssetHolder",VCXIModelNavigable:"DS/VCXWeb3DMaster/VCXNavigableAssetOccurrenceComposer",VCXITreeNode:"DS/VCXWebTreeExtensions/VCXTreeNodeOccurrence",VCXIPulseBehavior:"DS/VCXWebPulseManager/VCXPulseBehaviorOccurrence",VCXISensible:"DS/VCXWebComposer/VCXASensible",VCXIVisibility:"DS/VCXWebVisibilityImpl/VCXVisibilityOccurrence",CATI3DXAssetProperties:"DS/CATCXPModel/extensions/CATE3DXAssetProperties"},AmbienceModel_Spec:{CATI3DXAmbienceAsset:"DS/CAT3DExpAmbienceModelWebMedia/extensions/CATE3DXAmbienceAssetMedia",CATI3DXAssetHolder:"DS/CAT3DExpModel/extensions/CATE3DXAssetHolder",CATI3DExperienceObject:"DS/CAT3DExpModel/extensions/CATE3DExperienceObject"},VCXComponentAssetOccurrenceComposer:{W3AISGNodeHolder:"DS/VCXWebComposer/VCXNodeHolderAssetOccurrenceComposer"},Abstract3DExperienceObject_Spec:{CATIAlias:"DS/CAT3DExpModel/extensions/CATEAlias",CATI3DExperienceObject:"DS/CAT3DExpModel/extensions/CATE3DExperienceObject",VCXIModelNavigable:"DS/WebApplicationBase/VCXAModelNavigable",CATI3DXAssetHolder:"DS/CAT3DExpModel/extensions/CATE3DXAssetHolder"},CXPCoveringMaterial_Spec:{CATI3DXAssetProperties:"DS/VCXWeb3DPlay/VCXE3DXAssetProperties",CATI3DXMaterialAsset:"DS/CAT3DExpMaterialWebMedia/extensions/CATE3DXMaterialAssetMedia",CATI3DExperienceObject:"DS/CAT3DExpModel/extensions/CATE3DExperienceObject",VCXIMaterialCache:"DS/VCXWeb3DPlay/VCXECoveringMaterialPlayCache"},APIPlayerManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},CXPExperience_Spec:{CATICXPResourcesMgr:"DS/CATCXPModel/extensions/CATECXPExperienceResourcesMgr",VCXIModelNavigable:"DS/VCXWebComposer/VCXModelNavigableRoot",VCXISensible:"DS/VCXWebComposer/VCXASensible",VCXITreeNode:"DS/VCXWebTreeExtensions/VCXTreeNodeOccurrence",VCXIVisibility:"DS/VCXWebVisibility/VCXVisibility",W3AISGNodeHolder:"DS/VCXWebComposer/VCXNodeHolderRoot",VCXIModifiable:"DS/VCXWebEWS/VCXModifiableRoot",VCXIModifiableView:"DS/VCXWebEWS/VCXModifiableViewRoot"},CXPURLResource_Spec:{CATI3DXURLResourceAsset:"DS/StudioResourceModelWeb/extensions/CATE3DXURLResourceAsset",VCXIRessourceAsset:"DS/VCXWebDocManager/VCXERessourceURLAsset"},CXPSoundResource_Spec:{CATI3DXSoundResourceAsset:"DS/StudioResourceModelWeb/extensions/CATE3DXSoundResourceAsset"},CXPPictureResource_Spec:{CATI3DXPictureResourceAsset:"DS/StudioResourceModelWeb/extensions/CATE3DXPictureResourceAsset",VCXIRessourceAsset:"DS/VCXWebDocManager/VCXERessourcePictureAsset"},CXPMaterialApplication_Spec:{CATI3DExperienceObject:"DS/CAT3DExpModel/extensions/CATE3DExperienceObject"},CXPKeyframerResource_Spec:{CATI3DXKeyframerResourceAsset:"DS/StudioResourceModelWeb/extensions/CATE3DXKeyframerResourceAsset",VCXIRessourceAsset:"DS/VCXWebDocManager/VCXERessourceKeyFramerAsset"}},t={CATI3DX3DActorAsset:"DS/CATCXPModel/interfaces/CATI3DX3DActorAsset",W3AISGNodeHolder:"DS/WebApplicationBase/W3AISGNodeHolder",CATI3DXOverrideAssetProperties:"DS/CATCXPModel/interfaces/CATI3DXOverrideAssetProperties",CATI3DXAssetHolder:"DS/CAT3DExpModel/interfaces/CATI3DXAssetHolder",CATI3DExperienceObject:"DS/CAT3DExpModel/interfaces/CATI3DExperienceObject",CATI3DXJSONProcessor:"DS/VIAIdeaExperienceScenarioModelWeb/interfaces/CATI3DXJSONProcessor",CATI3DXAmbienceAsset:"DS/CAT3DExpAmbienceModelWeb/interfaces/CATI3DXAmbienceAsset",CATI3DXMaterialAsset:"DS/CAT3DExpMaterialWeb/interfaces/CATI3DXMaterialAsset",CATI3DXPictureResourceAsset:"DS/StudioResourceModelWeb/interfaces/CATI3DXPictureResourceAsset",CATI3DXSoundResourceAsset:"DS/StudioResourceModelWeb/interfaces/CATI3DXSoundResourceAsset",CATI3DXURLResourceAsset:"DS/StudioResourceModelWeb/interfaces/CATI3DXURLResourceAsset",CATIAlias:"DS/CAT3DExpModel/interfaces/CATIAlias",CATICXPResourcesMgr:"DS/CATCXPModel/interfaces/CATICXPResourcesMgr",CATI3DXAssetProperties:"DS/CATCXPModel/interfaces/CATI3DXAssetProperties",CATI3DXKeyframerResourceAsset:"DS/StudioResourceModelWeb/interfaces/CATI3DXKeyframerResourceAsset",VCXIRessourceAsset:"DS/VCXWebDocManager/VCXIRessourceAsset"},r={Model_VPMOccurrence_Spec:"DS/VCXWeb3DMaster/VCXComponentOccurrenceComposer",Model_VPMReference_Spec:"DS/VCXWebComposer/Model_VPMReference_Spec",AmbienceModel_Spec:"DS/VCXWebDressup/VCXAmbience/AmbienceModel_Spec",VCXEWSManager:"DS/VCXWeb3DPlay/VCXEWSManager3DPlay",ExpTrackManager_Spec:"DS/VCXWebKernel/ExpTrackManager_Spec",APIPlayerManager:"DS/XCTWebExperienceAppPlay/managers/APIPlayerManager",VCXNotificationManager:"DS/VCXWeb3DPlay/VCXNotificationPlayManager",VCXCAT3DXModelManager:"DS/VCXWeb3DPlay/VCXModelManagerPlayManager"};return{GetDictionary:function(){return{interfaces:t,components:r,extensions:e}}}})),define("DS/VCXWeb3DPlay/VCXE3DXAssetProperties",["require","exports"],(function(e,t){"use strict";return class{async getPhysicalId(){return this._object.QueryInterface("CATI3DXAssetHolder")._getLinkDescription()}getAssetStatus(){return this._object.QueryInterface("CATI3DXAssetHolder")._getAssetStatus()}}})),define("DS/VCXWeb3DPlay/VCXNodeHolderAsset3DPlay",["require","exports","DS/Visualization/Node3D","DS/Visualization/ThreeJS_DS","DS/WebApplicationBase/W3AASGNodeHolder"],(function(e,t,r,a,i){"use strict";return class extends i{init(){}async buildSGNode(){let e=this.QueryInterface("CATI3DX3DActorAsset");this._sgNode=await e.getNode3D().catch((()=>{let e=new r;return e.setMatrix(null),e})).then((e=>{e.productType="VPMInstance",e.name=this.QueryInterface("CATI3DExperienceObject").GetValueByName("_varName"),this.GetObject().name=e.name;let t=this.GetLocalPosition();var r=new a.Matrix4(t[0],t[3],t[6],t[9],t[1],t[4],t[7],t[10],t[2],t[5],t[8],t[11],0,0,0,1);return e.setMatrix(r),e}));let t=this.QueryInterface("VCXIModelNavigable").getParent().QueryInterface("W3AISGNodeHolder"),i=t.getPathElement(),s=t.getSGNode();this._pathElement=i.clone(),this._pathElement.addElement(this._sgNode),s.addChild(this._sgNode),this.GetObject().SetIsMesh(!0);let n=this.QueryInterface("VCXIModelNavigable").getChildren();if(this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("DSXMDeterministLoading"))for(let e of n)await(e.QueryInterface("W3AISGNodeHolder")?.getSGNode());else await Promise.all(n.map((e=>e.QueryInterface("W3AISGNodeHolder")?.getSGNode())));return this._sgNode}isSelfManagedPathElement(){return!0}GetLocalPosition(){var e=this.QueryInterface("CATI3DExperienceObject").GetValueByName("_varposition");return e&&12===e.length?e:this.QueryInterface("CATI3DX3DActorAsset").getPositionInAssetContext()}getPathElement(){return this._pathElement}}})),define("DS/VCXWeb3DPlay/VCXWebPlayerOptionsMgr",["require","exports"],(function(e,t){"use strict";return class{Dispose(){delete this._playerOptions}setPlayerOptions(e){let t=e.playExperience??{};t.onModelLoadingProgression=t.onModelLoadingProgression??function(){},t.onModelLoadingCompleted=t.onModelLoadingCompleted??function(){},this._playerOptions={transparentBackground:e.transparentBackground??!1,workbench:"VCXWeb3DPlay",workbenchModule:"VCXWebDsxmApp.xml",playExperience:t,optimizeRaycasting:e.OptimizeRaycasting??!0,...e},e.playExperience&&(e.playExperience.modelLoadComplete=void 0,e.playExperience.autoReframe=!1)}getPlayerOptions(){return this._playerOptions?this._playerOptions:{}}}}));var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWeb3DPlay/VCXECoveringMaterialPlayCache",["require","exports","DS/VCXWebMaterials/VCXECoveringMaterialCache"],(function(e,t,r){"use strict";r=__importDefault(r);class a extends r.default{async _applyMiacChanges(e){let t=this.GetParent();if(!t)return;let r=t?.QueryInterface("W3AISGNodeHolder"),a=r?.getPathElement(),i=await this.GetObject().QueryInterface("CATI3DXMaterialAsset").getMaterial();if(e){let e=await this.getMaterialVisu();a.addSubstituteMaterial(null,i,e,!0)}else a.removeSubstituteMaterial(null,i)}}return a})),define("DS/VCXWeb3DPlay/VCXEWSManager3DPlay",["require","exports","DS/VCXWebEWS/VCXEWSManagerBase"],(function(e,t,r){"use strict";class a extends r{constructor(){super(),window&&window.localStorage&&window.localStorage.setItem("EWS_DisableGetWebVisuMaterial","true")}async initialize(){}async GetFactory(){}GetVirtualPool(){return""}GetAppIdentifier(){return""}async GetFactoryCSIOptions(){}}return Object.defineProperty(a.prototype,"componentType",{enumerable:!0,get:function(){return"VCXEWSManager"}}),a})),define("DS/VCXWeb3DPlay/VCXWebExperienceMgr",["require","exports","DS/CoreEvents/Events"],(function(e,t,r){"use strict";return class{constructor(){this.currentValue=0}async onExperienceReady(e){let t=this._object.QueryInterface("XCTEWSIPlayerOptionsMgr").getPlayerOptions().playExperience;this._onModelLoadingProgression=t.onModelLoadingProgression,this._onModelLoadingCompleted=t.onModelLoadingCompleted,this.currentValue=70,await this.loadExperience(e),this.currentValue=100,this._onModelLoadingCompleted(),this._object._experienceBase.getManager("VCXNotificationManager").hideCurtain()}update3DPlayProgressBar(e){this.currentValue=e,this._onModelLoadingProgression({loaded:e,total:100})}onPreDisposeExperience(){}async loadExperience(e){let t=this._object._experienceBase;e.QueryInterface("CATI3DExperienceObject").SetVolatile(),t.getManager("VCXContextManager").getMainViewer().setVisuEnv("None");var r=e.QueryInterface("W3AISGNodeHolder").getSGNode();t.getManager("VCXContextManager").setRootNode(r),e.QueryInterface("CATI3DExperienceObject").GetValueByName("scenariosKF")[0].QueryInterface("CATI3DXJSONProcessor").Process(),t.getManager("VCXScenarioManager").RestoreNeutralPropertiesOneModifiable(t.getManager("VCXPlayManager").QueryInterface("VCXIModifiable").GetHashing(),null),await this.applyPlayerOptionAtInit(),await t.getManager("VCXCAT3DXModelManager")._LoadExperienceModel(),t.getManager("VCXPlayManager").setPlayMode(!0),await t.getManager("VCXExperience").waitLoops(1)}async applyPlayerOptionAtInit(){let e=this._object._experienceBase,t=e.getManager("VCXContextManager");if(e.getManager("VCXContextManager").getUrlVars().debug)return;let r=e.getManager("VCXPlayManager").QueryInterface("VCXIModifiable");t.setSupported("DisplayUIPropertiesPanel",r.GetPropertyValue("VCXPlayManager.showPropertiesPanel")),t.setSupported("DisplayUIAssemblyPanel",r.GetPropertyValue("VCXPlayManager.showAssemblyPanel")),t.setSupported("DisplayUIDressupsPanel",r.GetPropertyValue("VCXPlayManager.showDressupPanel")),t.setSupported("DisplayUIScenariosPanel",r.GetPropertyValue("VCXPlayManager.showScenePanel"));let a=this._object.QueryInterface("XCTEWSIPlayerOptionsMgr");if(!a)return;a=a.getPlayerOptions();let i=t.getMainViewer();i.ambience.getBackground().setActivated(!a.transparentBackground),i.setBackgroundColor("rgb(0,0,0)","0")}}})),define("DS/VCXWeb3DPlay/VCXWebxHighglightAppDSXM",["DS/VCXWebPlayServices/VCXWebAppHelperPlay","DS/VCXWeb3DPlay/VCX3DPlayDictionary","text!DS/VCXWeb3DPlay/assets/base/VCXComposerManagersDescription.json","DS/VCXWebPlayServices/VCXGUIDescriptionPlay"],(function(e,t,r,a){"use strict";return e.extend({init:function(e){this._parent(e),this.supportWebApplicationBase=!1},_setContextApp:function(){if(this._parent()){const e=this._experienceBase.getManager("VCXContextManager");if(e)return e.setSupported("GUIArchitectureV2",!0),e.setSupported("DSXMPlayer",!0),e.setSupported("useAPICXP",!1),e.setSupported("TweakingMaterial",!0),e.setSupported("VCXPIPSupport"),e.setContextFromName("ExperienceIn3DPlay"),this._experienceBase.odt&&e.setSupported("DSXMDeterministLoading"),!0}},addComposerManagers:function(){this._prepareListManagers();this._setContextApp()&&this._parent()},_prepareListManagers:function(){this._parent(),this._declareComposerManagers(r)},addDictionaries:async function(){await this._parent(),await this.AddDictionaryDescription(t)},onPostCreate:async function(e){await this._parent(e);const t=this._experienceBase.getManager("VCXGUIManager");return await this._declareGUIComponents(t,a),this._experienceBase}})}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWeb3DPlay/VCXWeb3DPlayManager",["require","exports","DS/VCXWeb3DPlay/VCXWebxHighglightAppDSXM","DS/VCXWebComponents/VCXWebComponentBaseExperience"],(function(e,t,r,a){"use strict";a=__importDefault(a);class i extends a.default{constructor(){super(),this.alreadyInit=!1,this.lockUnitiliaze=!1,this._webapphelper=new r}async initialize(){if(this.alreadyInit)return;this.alreadyInit=!0,console.log("init 3DPlayer"),window.widget&&(window.widget.isLocalMode=!0);let e=this.GetObject()._experienceBase;this.lockUnitiliaze=!0,await e._ManagerSet.unInitialize(!0);let t=e.getManager("VCXContextManager").getFrameWindow();return e._ManagerSet.removeManager("VCXContextManager"),this.lockUnitiliaze=!1,this._webapphelper.experienceBase=this._experienceBase,await this._experienceBase.initializeDefault(this._webapphelper),await this._webapphelper.onPostCreate(this._experienceBase),await e._ManagerSet.initialize(!0),e.getManager("VCXContextManager").setFrameWindow(t),await e._ManagerSet.postInitialize(!0),console.log("end init 3DPlayer"),!0}async unInitialize(){this.lockUnitiliaze||(this.lockUnitiliaze=!0,await this.GetObject()._experienceBase._ManagerSet.unInitialize(!0),this.lockUnitiliaze=!1)}getInitPhase(){return 1}}return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXWeb3DPlayManager"}}),i}));