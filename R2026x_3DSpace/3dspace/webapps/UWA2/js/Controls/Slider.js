define("UWA/Controls/Slider",["UWA/Core","UWA/Utils","UWA/Utils/Client","UWA/Event","UWA/Element","UWA/Controls/Abstract"],(function(e,t,s,n,i,o){"use strict";var a=o.extend({name:"uwa-slider",defaultOptions:{className:"",isTouch:s.Features.touchEvents,value:0,handleButton:!1,handleDragTreshold:40,slider:{html:[{tag:"div",class:"scrubber-wrapper",html:{tag:"div",class:"scrubber",html:[{tag:"div",class:"progress"},{tag:"div",class:"loaded"},{tag:"div",class:"handle handle-hide"}]}}],scrubberClass:"scrubber",progressClass:"progress",handleClass:"handle",loadedClass:"loaded"}},init:function(e){e=e||{},this._parent(e),this.eventNames={start:this.options.isTouch?"touchstart":"mousedown",move:this.options.isTouch?"touchmove":"mousemove",end:this.options.isTouch?"touchend":"mouseup"},this.body=e.body||document.body,this.bodyEvents={},this.options.handleButton&&(this.bodyEvents[this.eventNames.move]=this.onHandleDrag.bind(this),this.bodyEvents[this.eventNames.end]=this.onHandleDragEnd.bind(this)),this._buildSkeleton(),this._attachEvents(),this.reset()},reset:function(){var e=this,t=e.elements;e.loadedPercent=0,t.progress.setStyle("width",0),e._updatePosition(0)},show:function(){this.container.show()},hide:function(){this.container.hide()},setValue:function(e){e<0||e>100?console.log("The value should be an integer between 0 and 100"):(this.setOption("value",e),this._updatePosition(e))},setLoadedValue:function(e){this.elements.loaded.setStyle("width",e+"%")},onInjected:function(){this.options.value>0&&this._updatePosition(this.options.value)},onHandleDragStart:function(e){var t=this.elements.handle,s=n.getPosition(e).x-t.getPosition(document).x;Math.abs(s)<=this.options.handleDragTreshold&&(n.stop(e),i.addEvents.call(this.body,this.bodyEvents))},onHandleDrag:function(e){n.stop(e);var t=n.getPosition(e).x,s=this.elements.scrubber.getParent().getClientRects()[0].left;(s=t-s)<0?s=0:s>this.elements.scrubber.offsetWidth&&(s=this.elements.scrubber.offsetWidth),this._updateValue(s)},onHandleDragEnd:function(e){n.stop(e),i.removeEvents.call(this.body,this.bodyEvents),this.drag=null},onProgressBarClick:function(e){var t;t=n.getPosition(e).x-this.elements.scrubber.getPosition(document).x,this._updateValue(t)},_buildSkeleton:function(){var t,s,n=this,i=n.options,o=i.slider;return i.container&&e.is(i.container.getElement(".controls-slider"),"element")?((t=i.container.getElement(".controls-slider")).addClassName(this.getClassNames()),t.addContent(i.slider.html)):t=e.createElement("div",{class:this.getClassNames(),html:i.slider.html}),s=t.getElement.bind(t),n.elements={scrubber:s("."+o.scrubberClass),progress:s("."+o.progressClass),handle:s("."+o.handleClass),loaded:s("."+o.loadedClass)},i.handleButton&&n.elements.handle.removeClassName("handle-hide"),n.container=t,n},_attachEvents:function(){var e=this,t=e.elements,s=e.dispatchEvent.bind(e);return e.options.handleButton&&e.container.addEvent(e.eventNames.start,e.onHandleDragStart.bind(e)),t.scrubber.addEvent("click",s.bind(e,"onProgressBarClick")),this},_updateValue:function(e){var t=this.elements.scrubber.offsetWidth,s=Math.round(100*e/t);this.setOption("value",s),this._updatePosition(s),this.dispatchEvent("onChange",s)},_updatePosition:function(e){if(this.container&&this.container.isInjected()){var t=this.elements.progress,s=this.elements.scrubber,n=this.elements.handle,i=n.offsetWidth/2/s.offsetWidth*100;t.setStyle("width",e+"%"),n.setStyle("left",e-i+"%")}}});return e.namespace("Controls/Slider",a,e)}));