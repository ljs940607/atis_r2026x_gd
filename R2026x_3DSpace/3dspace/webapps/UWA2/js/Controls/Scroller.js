define("UWA/Controls/Scroller",["UWA/Core","UWA/Class/Timed","UWA/Controls/Abstract","UWA/Utils/Client","UWA/Event","UWA/Element","UWA/Fx"],(function(e,t,o,i,n,r,s){"use strict";var l,a=/input|textarea|select/i,c=/auto|scroll/i,h=i.Features,u=i.Platform,x=i.Engine.version>=5.1&&Boolean(u.ios);function p(e){return e>>0}function d(e){var t,o,i=!0,r=n.getElement(e);return r&&(t=r.getTagName(),o=r.getStyle("overflow"),i=t&&!t.match(a)&&!o.match(c)),i}function y(e){var t=e.type;return-1!==t.indexOf("mouse")?"mouse":-1!==t.indexOf("touch")?"touch":-1!==t.indexOf("ointer")?"pointer":"none"}function g(e,t,o){"init"===e?r.addEvents.call(t,{touchstart:o,mousedown:o,MSPointerDown:o}):"start"===e?r.addEvents.call(t,{touchmove:o,mousemove:o,MSPointerMove:o,touchend:o,touchcancel:o,mouseup:o,MSPointerUp:o}):"stop"===e?r.removeEvents.call(t,{touchmove:o,mousemove:o,MSPointerMove:o,touchcancel:o,touchend:o,mouseup:o,MSPointerUp:o}):"destroy"===e&&r.removeEvents.call(t,{touchstart:o,mousedown:o,MSPointerDown:o,touchmove:o,mousemove:o,MSPointerMove:o,touchcancel:o,touchend:o,mouseup:o,MSPointerUp:o})}return(l=o.extend(t,{name:"uwa-scroller",position:null,direction:null,scroll:null,maxScroll:null,scroller:null,maxPage:null,scrollBars:null,isScrolling:!1,isTracking:!1,isDragging:!1,isPulling:!1,enabled:!0,defaultOptions:{className:"",width:"",height:"",bounce:!1,momentum:!1,snap:!1,threshold:6,lockDirection:!0,scrollableX:!0,scrollableY:!0,scrollbarH:!0,scrollbarV:!0,scrollTime:250,scrollSize:40,scrollDrag:h.dragAndDrop&&!u.blackberry,useTransform:h.transitionsCSS&&!u.webos,useNative:u.blackberry,isTouch:h.touchEvents,has3d:h.cssMatrix,preventDefaultMouseWheel:!1,debugPixel:!1},init:function(t,o){var i=this;i._parent(o),o=i.options,e.extend(i,{position:{x:0,y:0},direction:{x:0,y:0},scroll:{x:!1,y:!1,width:0,height:0},maxScroll:{x:0,y:0},scroller:{width:0,height:0},page:{x:0,y:0},maxPage:{x:0,y:0},scrollBars:{x:null,y:null}}),o.useNative?i.buildNative(t):i.buildSkeleton(t),i.initEvents(),i.setPosition(0,0,0,!0)},destroy:function(){var e=this,t=e.elements,o=t.element,i=t.scroller,n=t.wrapper,s=t.scrollerParent,a=e.eventHandler;l.activeScroller===e&&delete l.activeScroller,o&&(r.removeEvent.call(o,"resize",a),r.inject.call(o,i,"before")),s&&r.removeEvent.call(s,"resize",a),g("destroy",i,e.eventHandler),r.removeEvents.call(i,{keydown:a,mousewheel:a}),i.destroy(),n.destroy()},setOptions:function(e){this._parent(e);var t=(e=this.options).snap;return e.snap=!0===t?{x:null,y:null}:"number"==typeof t?{x:t,y:t}:t,this},buildNative:function(t){var o=this,i=u.android||u.blackberry||x?"scroll":"auto",r=o.options,s=o.elements={element:t,scroller:e.createElement("div",{class:o.getClassNames("","-native"),styles:{overflow:i,overflowScrolling:"touch",zIndex:"0",position:"relative",height:r.height||"100%",width:r.width||"100%",userSelect:"none",zoom:"1"}}),wrapper:e.createElement("div",{class:r.className+"-wrapper"}),ghost:e.createElement("div",{styles:{height:"10px",width:"10px",background:"#000",position:"absolute",zIndex:"1",opacity:r.debugPixel?1:0},events:{click:function(e){return n.stop(e),!1}}})};s.scroller.style.webkitOverflowScrolling="touch",o.body=!1===r.body?s.scroller:r.body||document.body,s.scroller.inject(t,"before"),s.wrapper.inject(s.scroller),s.ghost.inject(s.scroller),t.inject(s.wrapper),s.scrollerParent=s.scroller.getParent(),s.scroller.addEvent("scroll",(function(){o.position=o.getPosition(),o.setAnimate("onScroll",(function(){o.triggerOnScroll(),o.triggerOnScrollEnd()}))})),o.onRefresh()},buildSkeleton:function(t){var o=this,r=o.options,s=o.scrollBars,a=o.elements={element:t,scroller:e.createElement("div",{class:o.getClassNames("","-fake"),tabindex:"0",styles:{overflow:"hidden",position:"relative",userSelect:"none",outline:0,zoom:"1"}}),wrapper:e.createElement("div",{class:r.className+"-wrapper",styles:{width:"100%",height:"100%",position:"relative"}}),ghost:e.createElement("div",{styles:{height:"10px",width:"10px",background:"#000",position:"absolute",zIndex:"1",opacity:r.debugPixel?1:0},events:{click:function(e){n.stop(e),o.updateGhostPosition({y:0,x:0})}}})};o.body=r.body||i.Engine.ie?document.body:window,a.scroller.addContent([a.wrapper,a.ghost]).inject(t,"before"),t.inject(a.wrapper),a.scrollerParent=a.scroller.getParent(),s.x=r.scrollableX&&r.scrollbarH&&new l.Scrollbar(e.extend({dir:"horizontal"},r.scrollbar),o),s.y=r.scrollableY&&r.scrollbarV&&new l.Scrollbar(e.extend({dir:"vertical"},r.scrollbar),o),o.onRefresh()},initEvents:function(){var e,t=this,o=t.options,i=t.elements;e=t.eventHandler=t.handleEvent.bind(t),i.scroller.addEvents({keydown:e,mousewheel:e}),o.scrollDrag&&(g("init",i.scroller,t.eventHandler),t.setCursor("grab"),i.scroller.addEvents({mousemove:n.preventDefault,touchmove:n.preventDefault})),i.element.addEvent("resize",e),i.scrollerParent.addEvent("resize",e)},handleEvent:function(e){var t,o=this;switch(e.type){case"touchstart":case"mousedown":case"MSPointerDown":t=o.dispatchEvent("onScrollInit",[e]);break;case"touchmove":case"mousemove":case"MSPointerMove":t=o.dispatchEvent("onScrollMove",[e]);break;case"touchend":case"touchcancel":case"mouseup":case"MSPointerUp":t=o.dispatchEvent("onScrollStop",[e]);break;case"DOMMouseScroll":case"onmousewheel":case"mousewheel":t=o.dispatchEvent("onMouseWheel",[e]);break;case"keydown":t=o.dispatchEvent("onKeyDown",[e]);break;case"DOMSubtreeModified":case"orientationchange":case"resize":t=o.dispatchEvent("onRefresh",[e])}return t},scrollTo:function(e,t,o){var i,n=this,r=n.options;o=isNaN(o)?r.scrollTime:o,n.options.snap&&(e=(i=n.snap(e,t)).x,t=i.y,o=Math.min(i.time,o)),n.setPosition(e,t,o)},scrollToPage:function(e,t,o){var i=this,n=i.options,r=i.getPage(),s=i.position,l=i.getSnapSize();n.snap||(r.x=-p(s.x/l.x),r.y=-p(s.y/l.y)),"next"===e?e=++r.x:"prev"===e&&(e=--r.x),"next"===t?t=++r.y:"prev"===t&&(t=--r.y),e=!1!==e?-e*l.x:s.x,t=!1!==t?-t*l.y:s.y,o=isNaN(o)?n.scrollTime:o,e=(l=i.snap(e,t)).x,t=l.y,o=Math.min(l.time,o),i.setPosition(e,t,o)},scrollToElement:function(e,t,o){"string"==typeof t?t={x:t,y:t}:void 0===t&&(t={x:"center",y:"center"});var i,n,s,l,a=this,c=a.scroll,h=a.maxScroll,u=r.getPosition.call(e,a.elements.wrapper),x=r.getDimensions.call(e),p=a.getSnapSize(),d={x:c.width,y:c.height},y={};for(x={x:x.outerWidth,y:x.outerHeight},i=0;i<2;i+=1)c[n=i?"x":"y"]?(s=-u[n],"center"===t[n]?s+=(d[n]-x[n])/2:"end"===t[n]&&(s+=d[n]-x[n])):s=0,l=s<h[n],s=s>0?0:l?h[n]:s,!l&&a.options.snap&&(s=Math[i?"floor":"round"](s/p[n])*p[n]),s<h[n]&&(s=h[n]),y[n]=s;a.setPosition(y.x,y.y,o)},setPosition:function(e,t,o,i){var n,r,s=this,l=s.options,a=s.scrollBars,c=s.scroll,h=s.getPosition();o=isNaN(o)?l.scrollTime:o,r={x:e,y:t},l.bounce||(r=s.bounce(r)),n={x:h.x-r.x,y:h.y-r.y},s.direction={x:0===n.x?0:n.x>0?-1:1,y:0===n.y?0:n.y>0?-1:1},0===n.x&&0===n.y||(s.scrollToPosition(r,o),a.x&&c.x&&0!==n.x&&a.x.setPosition(r.x,o,i),a.y&&c.y&&0!==n.y&&a.y.setPosition(r.y,o,i),!s.isPulling&&(s.isMaxPosition("x")&&0!==n.x||s.isMaxPosition("y")&&0!==n.y)&&s.dispatchEvent("onScrollPull"))},stopScroll:function(){this.scrollToPosition(this.getPosition(!0),0)},scrollToPosition:function(e,t){t=t||0;var o,i,n=this,r=n.elements,l=r.scroller,a=r.wrapper,c=n.options;n.triggerOnScrollStart(),n.position=e,c.useNative?(l.scrollTop=-e.y,l.scrollLeft=-e.x,n.triggerOnScroll(),n.triggerOnScrollEnd()):c.useTransform?(a.removeEvent("transitionEnd"),t>0&&a.addEvent("transitionEnd",(function(){a.removeEvent("transitionEnd"),n.triggerOnScrollEnd()})),i={transformOrigin:"0 0",transform:"translateZ(0)",fontSmoothing:"antialiased",perspective:800,transformStyle:"preserve-3d",transitionDelay:"0ms",transitionDuration:t+"ms",transitionProperty:a.getStyleName("transform",!0),transitionTimingFunction:"cubic-bezier(0.33, 0.66, 0.66, 1)"},c.has3d?i.transform="translate3d("+e.x+"px,"+e.y+"px, 0)":i.transform="translate("+e.x+"px,"+e.y+"px)",a.setStyles(i),0===t&&n.triggerOnScrollEnd()):((o=n.fx=n.fx||new s(a,{transition:"cubicOut",wait:!1,events:{onComplete:function(){n.triggerOnScrollEnd()},onAnimate:function(){n.triggerOnScroll()}}})).setOptions({duration:t}),o.start({top:e.y,left:e.x}))},triggerOnScrollStart:function(){var e=this,t=e.options,o=e.isScrolling;e.clearDelayed("onScrollEnd"),o||(e.dispatchEvent("onScrollStart"),(t.useNative||t.useTransform)&&e.setAnimate("onScroll",(function t(){e.triggerOnScroll(),e.setAnimate("onScroll",t)}))),e.dispatchEvent("onScroll")},triggerOnScroll:function(){this.dispatchEvent("onScroll")},triggerOnScrollEnd:function(){var e=this,t=e.options;e.setDelayed("onScrollEnd",(function(){(t.useNative||t.useTransform)&&e.clearAnimate("onScroll"),e.dispatchEvent("onScrollEnd")}),100)},getPosition:function(e){var t,o,i=!1,n=this.options,s=this.elements;if(n.useNative)o={y:-s.scroller.scrollTop,x:-s.scroller.scrollLeft};else if(n.useTransform){if(o={y:0,x:0},(t=r.getStyle.call(s.wrapper,"transform",!0))&&"none"!==t)if(h.matrixCSS)try{o={y:(t=new(window.WebKitCSSMatrix||window.MSCSSMatrix||window.MOZCSSMatrix||window.CSSMatrix)(t)).f,x:t.e}}catch(e){}else i=0===t.indexOf("matrix3d"),t=t.replace(/[^0-9-.,]/g,"").split(","),o={y:Number(t[i?13:5]),x:Number(t[i?12:4])};e&&(o={x:p(o.x),y:p(o.y)})}else o={y:(e?parseInt:parseFloat)(s.wrapper.style.top||0,10),x:(e?parseInt:parseFloat)(s.wrapper.style.left||0,10)};if(isNaN(o.x)||isNaN(o.y))throw new Error("Invalid scroller position");return o},getResetPosition:function(){var e=this,t=e.scroll,o=e.getPosition(),i=e.maxScroll,n=o.x,r=o.y;return o.x>=0||!t.x?n=0:o.x<i.x&&(n=i.x),o.y>0||!t.y?r=0:o.y<i.y&&(r=i.y),{x:p(n),y:p(r)}},isInViewport:function(e,t,o){var i,n,s=this.elements.wrapper,l=r.getOffsets,a=r.getDimensions,c=l.call(s,!0),h=l.call(e),u=a.call(s),x=a.call(e),p=this.getPosition(),d=u.outerHeight,y=u.outerWidth,g=x.width,m=x.height,v=h.y,S=h.x;return c.y=c.y-p.y,c.x=c.x-p.x,t?(i=S<c.x+y&&S+g>c.x,n=v<c.y+d&&v+m>c.y):(i=S>=c.x&&S+g<=c.x+y,n=v>=c.y&&v+m<=c.y+d),"x"===o?i:("y"===o||i)&&n},isMaxPosition:function(e,t,o){t=t||this.getPosition(),o=o||this.direction[e];var i=this.maxScroll;return o>0?t[e]>=0:t[e]<=i[e]},hasOverflow:function(e){var t=this.scroll,o=this.scroller,i=t.width<o.width,n=t.height<o.height;return"x"===e?i:"y"===e?n:i||n},setSize:function(e){var t=this.options,o=!1;t.width!==e.width&&(o=!0,this.setOption("width",e.width)),t.height!==e.height&&(o=!0,this.setOption("height",e.height)),o&&this.dispatchEvent("onRefresh")},setCursor:function(e){var t=this.scroll;"grabbing"!==e||t.x&&t.y||(e=t.x?"col-resize":"row-resize"),this.elements.scroller.setStyle("cursor",e)},focus:function(){return this.elements.scroller&&this.elements.scroller.focus(),this},updateGhostPosition:function(e){var t=this.elements,o=t.scroller.getOffsets();this.options.useNative&&(o.y-=t.scroller.scrollTop,o.x-=t.scroller.scrollLeft),t.ghost.setStyles({top:e.y-o.y-5,left:e.x-o.x-5})},createDebugPixel:function(t,o,i,n){var r,s=this,l=s.elements;s.options.debugPixel&&(s.debugPixels=s.debugPixels||[],n&&s.debugPixels.forEach((function(e){e.remove()})),r=l.scroller.getOffsets(),s.options.useNative&&(r.y-=l.scroller.scrollTop,r.x-=l.scroller.scrollLeft),s.debugPixels.push(e.createElement("div",{title:(i||"")+" x:"+t.x+" y:"+t.y,styles:{height:"4px",width:"4px",background:o||"red",position:"absolute",zIndex:"1",top:t.y-r.y-2,left:t.x-r.x-2}}).inject(l.scroller)))},getPage:function(){var e,t,o,i=this,n=i.getPosition(),r=i.getSnapSize(),s=i.maxScroll,l={};for(t=0;t<2;t++)e=n[o=t?"x":"y"]/r[o],l[o]=-e,e*=r[o],isNaN(e)||e>0?l[o]=0:e<s[o]&&(l[o]=i.maxPage[o]);return l},getSnapSize:function(){var e=this.options.snap,t=this.scroll;return{x:e&&e.x||t.width,y:e&&e.y||t.height}},getScrollSize:function(){var e=this.options,t=e.snap;return{x:t&&t.x||e.scrollSize,y:t&&t.y||e.scrollSize}},bounce:function(e){var t,o,i=this.maxScroll;for(t=0;t<2;t+=1)(e[o=t?"x":"y"]>=0||e[o]<i[o])&&(e[o]=e[o]>=0||i[o]>=0?0:i[o]);return e},momentum:function(e,t,o,i,n){var r,s,l,a,c,h,u,x,d,y,g=6e-4,m=this.scroll,v=this.scroller,S={x:e,y:t},f={x:0,y:0},b={x:Number(S.x),y:Number(S.y),time:n};for(r=0;r<2;r++)l=r?"width":"height",c=i[s=r?"x":"y"]-o[s],m[s]&&n<=350&&0!==c&&(x=(a=Math.min(Math.abs(c)/n,1.9))*a/.0012,u=m[l],d=-S[s],y=v[l]-m[l]+S[s],h=u/(6/(x/a*g)),c>0&&x>d?(a=a*(d+=h)/x,x=d):c<0&&x>y&&(a=a*(y+=h)/x,x=y),b[s]=p(S[s]+x*(c<0?-1:1)),f[s]=a/g);return b.time=Math.max(f.y,f.x),b},snap:function(e,t,o){var i,n,r,s,l,a=this,c=a.getPage(),h=a.getSnapSize(),u=a.maxScroll,x={x:e,y:t};for(l={x:0===(s={x:(o=o||a.position).x-e,y:o.y-t}).x?0:s.x>0?-1:1,y:0===s.y?0:s.y>0?-1:1},n=0;n<2;n++)0!==s[r=n?"x":"y"]&&(i=Math[l[r]<0?"floor":l[r]?"ceil":"round"](x[r]/h[r]),c[r]=-i,i*=h[r],isNaN(i)||i>0?i=c[r]=0:i<u[r]&&(c[r]=a.maxPage[r],i=u[r]),x[r]=i);return x.time=p(Math.max(Math.abs(o.x-x.x)/h.x*500,Math.abs(o.y-x.y)/h.y*500)),x},onScrollInit:function(e){var t,o,i,s,a,c=this,h=c.options;!n.isDefaultPrevented(e)&&(a=c,!l.activeScroller||l.activeScroller===a)&&function(e){return e.scroll.x||e.scroll.y||e.options.bounce}(c)&&function(e){return"touchstart"===e.type||0===n.whichButton(e)}(e)&&d(e)&&(o=y(e),i=n.getPosition(e),s=e.timeStamp,t=c.getPosition(!0),l.activeScroller=c,"mouse"===o&&n.stop(e),c.createDebugPixel(i,"green","onScrollInit",!0),c.isTracking=o,g("start",c.body,c.eventHandler),(c.isPulling||c.isScrolling)&&c.updateGhostPosition(i),c.scrollStart={time:s,position:t,event:i},c.scrollMove={time:s,direction:!1,event:i},c.positions=[],h.momentum&&c.isScrolling&&c.setDelayed("stopOnScrollInit",(function(){var e=c.getPosition(!0);!1!==c.isDragging||e.x===t.x&&e.y===t.y||(c.setPosition(t.x,t.y,0),c.createDebugPixel(i,"purple","stopOnScrollInit"))}),150),c.setDelayed("focusOnScrollInit",(function(){var e=c.elements.scroller,t=e.getDocument().activeElement;t&&r.isInjected.call(t,e)||c.focus()}),75),c.setCursor("grabbing"))},onScrollMove:function(t){var o,i,r,s,l,a,c,h,u,x,p,d,g=this,m=g.options,v=g.positions,S=n.getPosition(t),f=m.lockDirection?m.threshold:0,b=m.threshold;g.isTracking===y(t)&&(n.stop(t),g.updateGhostPosition(S),g.clearDelayed("stopOnScrollInit"),g.isDragging?(s=g.scrollMove,i=g.maxScroll,o=e.clone(g.position),a=t.timeStamp,h=S.y-s.event.y,p=0===(c=S.x-s.event.x)?0:c>0?-1:1,d=0===h?0:h>0?-1:1,g.enableScrollX&&(o.x+=c,(o.x<i.x||o.x>0)&&(m.bounce?o.x-=c/2:o.x<i.x?o.x=i.x:o.x=0)),g.enableScrollY&&(o.y+=h,(o.y<i.y||o.y>0)&&(m.bounce?o.y-=h/2:o.y<i.y?o.y=i.y:o.y=0)),v.length>60&&v.splice(0,30),v.push(o.x,o.y,a),g.setPosition(o.x,o.y,0),g.scrollMove.direction&&(g.enableScrollX&&0!==s.direction.x&&s.direction.x!==p||g.enableScrollY&&0!==s.direction.y&&s.direction.y!==d)?(g.createDebugPixel(S,"yellow","onScrollMove:directionChange"),g.scrollStart={time:a,position:o,event:S}):g.createDebugPixel(S,"orange","onScrollMove:isDragging"),g.scrollMove={time:a,direction:{x:p,y:d},position:o,event:S}):(r=g.scroll,l=g.scrollStart,u=Math.abs(S.x-l.event.x),x=Math.abs(S.y-l.event.y),g.enableScrollX=r.x&&u>=f,g.enableScrollY=(r.y||!r.x&&!r.y)&&x>=f,g.isDragging=(g.enableScrollX||g.enableScrollY)&&(u>=b||x>=b),g.isDragging&&g.isScrolling&&g.stopScroll(),g.createDebugPixel(S,"red","onScrollMove:notDragging")))},onScrollStop:function(e){var t,o,i,r,s,a=this,c=a.options,h=c.scrollTime;a.isTracking===y(e)&&(a.isTracking=!1,l.activeScroller===a&&delete l.activeScroller,g("stop",a.body,a.eventHandler),r=n.getPosition(e),t=a.getResetPosition(!0),s=e.timeStamp,a.createDebugPixel(r,"blue","onScrollMove"),a.setCursor("grab"),a.isDragging&&(a.isDragging=!1,i=a.scrollStart,a.scrollEnd=o={time:s,position:t,event:r},n.stop(e),a.updateGhostPosition(r),o.event.x===i.event.x&&o.event.y===i.event.y||(c.momentum&&(t=a.momentum(t.x,t.y,i.event,o.event,o.time-i.time),h=Math.max(t.time,h)),c.snap&&(t=a.snap(t.x,t.y,i.position),h=Math.max(t.time,h)))),a.setPosition(t.x,t.y,h,!1),a.positions.length=0,a.scrollStart=null,a.scrollMove=null,a.scrollEnd=null,a.setDelayed("resetGhostPosition",(function(){a.updateGhostPosition({x:0,y:0})}),500))},onScrollStart:function(){this.isScrolling=!0},onScroll:function(){},onScrollEnd:function(){var e=this,t=e.options;e.isScrolling&&(e.isScrolling=!1,t.useTransform&&e.elements.wrapper.removeEvent("transitionEnd",e.eventHandler)),e.isTracking||(e.isPulling=!1,e.setAnimate("onResetPosition",(function(){var t,o=e.getResetPosition(),i=e.getPosition(),n=e.scrollBars;e.options.snap&&(t=e.snap(o.x,o.y),o.x=t.x,o.y=t.y),i.x!==o.x||i.y!==o.y?e.setPosition(o.x,o.y):(n.x&&n.x.onScrollEnd(),n.y&&n.y.onScrollEnd())})))},onScrollPull:function(){this.isPulling=!0},onKeyDown:function(e){var t=this,o=t.position,i=t.scroll,r=t.getScrollSize(),s=e.keyCode,l=38===s,a=37===s,c=40===s||l?"y":!(!(39===s)&&!a)&&"x",h=l||a?1:-1,u={x:o.x,y:o.y};i[c]&&d(e)&&!t.isMaxPosition(c,o,h)&&(n.stop(e),u[c]+=h*r[c],t.scrollTo(u.x,u.y))},onMouseWheel:function(e){var t=this,o=t.options,i=t.position,r=t.scroll,s=r.x&&!r.y||"shift"===n.whichKey(e)?"x":"y",l=t.getScrollSize(),a=n.wheelDelta(e),c={x:i.x,y:i.y};a&&r[s]&&!t.isMaxPosition(s,i,a)?(n.stop(e),c[s]+=a*l[s],t.scrollTo(c.x,c.y)):o.preventDefaultMouseWheel&&n.stop(e)},onRefresh:function(){if(!this.elements.scroller.isInjected()||this.isScrolling)return!1;var e,t,o,i,n=this,s=n.options,l=n.elements,a=n.position,c=n.scrollBars,h=r.getScrolls.call(l.element),u=r.getDimensions.call(l.scrollerParent);if(o={width:h.width,height:h.height},(t={width:s.width||u.innerWidth,height:s.height||u.innerHeight}).width===n.scroll.width&&t.height===n.scroll.height&&o.width===n.scroller.width&&o.height===n.scroller.height)return!1;i={},!1!==s.scrollableX&&(i.width=t.width),!1!==s.scrollableY&&(i.height=t.height),l.scroller.setStyles(i),t.x=s.scrollableX&&t.width<h.width,t.y=s.scrollableY&&t.height<h.height,n.maxScroll={x:o.width<t.width?0:t.width-o.width,y:o.height<t.height?0:t.height-o.height},n.maxPage={x:Math.ceil(o.width/t.width),y:Math.ceil(o.height/t.height)},n.scroll=t,n.scroller=o,c.x&&c.x.setSize(t.width,o.width),c.y&&c.y.setSize(t.height,o.height),e=n.getResetPosition(),n.moved||e.x===a.x&&e.y===a.y||n.setPosition(e.x,e.y,0,!0),l.scroller.toggleClassName("scrollable",t.y||t.x),l.scroller.toggleClassName("scrollable-x",t.x),l.scroller.toggleClassName("scrollable-y",t.y)}})).Scrollbar=o.extend({name:"uwa-scroller-scrollbar",defaultOptions:{className:"",barColor:"#555",bgColor:"#EEE",opacity:1,dir:"vertical",padding:2,width:6,roundCorder:!0,autoHide:!0,draggable:!0,elastic:!1,debugPixel:!1},position:{x:0,y:0},scroller:null,visible:!0,init:function(e,t){this._parent(e),this.scroller=t,this.buildSkeleton(),this.initEvents(),this.options.autoHide&&this.hide()},destroy:function(){this.elements.wrapper.remove()},createDebugPixel:function(t,o,i,n){var r,s=this,l=s.isHorizontal,a=s.elements;s.options.debugPixel&&(s.debugPixels=s.debugPixels||[],n&&s.debugPixels.forEach((function(e){e.remove()})),r=a.wrapper.getOffsets(),s.debugPixels.push(e.createElement("div",{title:(i||"")+" x:"+t.x+" y:"+t.y,styles:{height:"2px",width:"4px",background:o||"red",position:"absolute",zIndex:"11",top:l?0:t.y-r.y-2,left:l?t.x-r.x-2:0}}).inject(s.scroller.elements.scroller)))},buildSkeleton:function(){var t,o,n=this,r=n.options,s=n.scroller.options,l="horizontal"===r.dir,a=parseInt(r.padding,10),c=parseInt(r.width,10),h=r.roundCorder?p(r.width/2*100/100):0,u=n.scroller.elements.scroller;n.isHorizontal=l,n.axis=l?"x":"y",n.reverseAxis=l?"y":"x",n.elements.wrapper=o=e.createElement("div",{class:n.getClassNames("","-"+r.dir),styles:{zIndex:"10",position:"absolute",overflow:"hidden",opacity:r.opacity}}).inject(u),r.bgColor&&o.setStyle("background",r.bgColor),l?o.setStyles({bottom:a+"px",left:a+"px",height:c+"px"}):o.setStyles({top:a+"px",right:a+"px",width:c+"px"}),n.elements.bar=t=e.createElement("div",{styles:{background:r.barColor,zIndex:"10",position:"absolute",top:0,left:0}}).inject(o),i.Engine.ie<7&&t.setHTML("&nbsp;&nbsp;&nbsp;"),l?t.setStyles({borderRadius:h+"px "+h+"px",width:c+"px",minWidth:c+1+"px",minHeight:c+"px"}):t.setStyles({borderRadius:h+"px "+h+"px",height:c+"px",minWidth:c+"px",minHeight:c+1+"px"}),r.useTransform&&(t.setStyles({transformOrigin:"0 0",transform:"translateZ(0)"}),s.has3d&&t.setStyles({perspective:800,transformStyle:"preserve-3d"}))},initEvents:function(){var e=this,t=e.options,o=e.elements;e.eventHandler=e.handleEvent.bind(e),t.draggable&&(g("init",o.bar,e.eventHandler),o.bar.setStyle("cursor","grab")),t.autoHide&&o.wrapper.addEvents({mouseenter:function(){e.focused=!0,e.show()},mouseleave:function(){e.focused=!1,e.hide()}})},handleEvent:function(e){var t,o=this;switch(e.type){case"touchstart":case"mousedown":t=o.dispatchEvent("onScrollInit",[e]);break;case"touchmove":case"mousemove":t=o.dispatchEvent("onScrollMove",[e]);break;case"touchend":case"touchcancel":case"mouseup":t=o.dispatchEvent("onScrollStop",[e])}return t},setSize:function(e,t){var o=this,i=o.options,n=o.scroller.scroll,r=o.isHorizontal,s=r?n.y:n.x,l=parseInt(i.width,10),a=parseInt(i.padding,10);t<=e?o.hide(!0):(i.autoHide||o.show(),o.maxSize=p(e-2*a-(s?l:0)),o.minSize=l,o.size=Math.min(Math.max(o.maxSize*o.maxSize/t,3*l),o.maxSize),o.maxScroll=o.maxSize-o.size,o.minScroll=0,o.toWrapperProp=o.maxScroll/(e-t),o.toPropWrapper=t/o.maxSize,o.elements.wrapper.setStyle(r?"width":"height",o.maxSize+"px"),o.elements.bar.setStyle(r?"width":"height",o.size+"px"))},onScrollInit:function(e){n.stop(e);var t=this,o="grabbing",i=t.scroller,r=n.getPosition(e);t.createDebugPixel(r,"#7FFF00",!0),g("start",i.body,t.eventHandler),t.scrollStart={x:r.x,y:r.y},t.scrollMove={x:r.x,y:r.y},t.elements.bar.setStyle("cursor",o),i.setCursor(o),i.isTracking=!0,i.isDragging=!0},onScrollMove:function(e){n.stop(e);var t=this,o=t.axis,i=t.toPropWrapper,r=t.scroller,s=r.maxScroll,l=t.scrollMove,a=t.isHorizontal,c=r.position,h=n.getPosition(e),u=a?(h.x-l.x)*i:0,x=a?0:(h.y-l.y)*i,p={x:c.x-u,y:c.y-x};p[o]>s[o]&&p[o]<0?(t.createDebugPixel(h,"orange"),r.setPosition(p.x,p.y,0),t.scrollMove={x:h.x,y:h.y}):t.createDebugPixel(h,"red")},onScrollStop:function(e){n.stop(e);var t=this,o="grab",i=t.scroller,r=n.getPosition(e),s=i.getResetPosition();t.createDebugPixel(r,"#00CED1"),i.setPosition(s.x,s.y,NaN,!1,!0),g("stop",t.scroller.body,t.eventHandler),t.focused||t.hide(),t.elements.bar.setStyle("cursor",o),t.scroller.setCursor(o),t.scrollMove=null,t.scrollStart=null,i.isTracking=!1,i.isDragging=!1},setPosition:function(e,t,o){var i,n,r,l,a,c=this,h=c.elements.bar,u=c.scroller,x=c.size,p=c.axis,d=c.dimension,y=c.minSize,g=c.position,m=c.maxScroll,v=c.minScroll,S=c.options,f=u.options,b={y:0,x:0};n=c.toWrapperProp*e,l=c.isHorizontal?"width":"height",n<0?S.elastic?(a=Math.max(x+n,y),b[p]=v):b[p]=v:n>m?S.elastic?(a=Math.max(x-(n-m),y),b[p]=Math.min(n,m+x-y)):b[p]=m:(a=x,b[p]=n),b.x===g.x&&b.y===g.y&&d===a||(o?t=0:c.show(),b={x:b.x,y:b.y},f.useTransform?(r={transitionDelay:"0ms",transitionDuration:t+"ms",transitionProperty:[h.getStyleName("transform",!0)].concat([l]).join(","),transitionTimingFunction:"cubic-bezier(0.33, 0.66, 0.66, 1.0)"},a&&S.elastic&&(r[l]=a+"px"),S.has3d?r.transform="translate3d("+b.x+"px,"+b.y+"px, 0)":r.transform="translate("+b.x+"px,"+b.y+"px)",h.setStyles(r)):((i=c.fx=c.fx||new s(h,{transition:"cubicOut",wait:!1})).setOptions({duration:t}),r={top:[g.y,b.y],left:[g.x,b.x]},a&&S.elastic&&(r[l]=[x,a]),i.start(r))),c.position=b,c.dimension=a},onScrollStart:function(){this.show()},onScrollEnd:function(){this.hide()},show:function(){var t,o=this;o.visible||(t={opacity:o.options.opacity},o.scroller.options.useTransform&&e.merge(t,{transitionProperty:"opacity",transitionDelay:"0ms",transitionDuration:"50ms"}),o.elements.wrapper.setStyles(t),o.visible=!0)},hide:function(t){var o,i=this;!i.visible||i.focused||i.scrollMove||!i.options.autoHide&&!t||(o={opacity:0},i.scroller.options.useTransform&&e.merge(o,{transitionProperty:"opacity",transitionDelay:t?"0ms":"300ms",transitionDuration:t?"0ms":"150ms"}),i.elements.wrapper.setStyles(o),i.visible=!1)}}),e.namespace("Controls/Scroller",l,e)}));