define("UWA/Controls/ToolTip",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Element","UWA/Class/Timed","UWA/Utils/Client","UWA/Controls/DropDown"],(function(t,e,o,i,n,s,l){"use strict";var d,a=new l.Pointy({autoPosition:["below-start","right-start","left-start","above-start"],margin:20,positionOptions:{relative:document.querySelector("body")}}),r=new n,h=o.extend({name:"uwa-tooltip",content:"",defaultOptions:{id:"uwa-tooltip",className:"",width:"auto",delay:800,showOver:!0,root:null},mousePosition:{},init:function(e,o,i){this._parent(i),this.content=o||"",this._tooltipped=t.extendElement(e),this._attachEvents()},destroy:function(){this.hide(),this._detachEvents(),this._parent()},_attachEvents:function(){if(!this._events){var t=this._events={tooltipped:{},tooltippedOnShown:{},bodyOnShown:{}};this.options.showOver&&(t.tooltipped.mouseover=this.dispatchAsEventListener("onShowTooltip"),t.tooltippedOnShown.mouseout=this.dispatchAsEventListener("onHideTooltip"),t.tooltippedOnShown.click=this.dispatchAsEventListener("onHideTooltip"),t.bodyOnShown.mousemove=this.dispatchAsEventListener("onMoveTooltip"))}this._tooltipped.addEvents(this._events.tooltipped)},_detachEvents:function(){this._events&&(this._tooltipped.removeEvents(this._events.tooltipped),this._tooltipped.removeEvents(this._events.tooltippedOnShown),i.removeEvents.call(document.querySelector("body"),this._events.bodyOnShown,!0))},buildSkeleton:function(){for(var t,e=this,o=e.options,n=i.getDocument.call(e._tooltipped),s=e.getRootNode(),l=i.getChildren.call(s),r=o.id,h=0;(t=n.getElementById(o.id))&&!(l.indexOf(t)>=0);)o.id=r+"-"+h++;return t||((t=a.getContent()).id=o.id,void 0===d&&(d=t.className),t.set("class",d+" "+this.getClassNames()),t.setStyle("width",o.width),t.inject(s)),e._tooltip=t,t},_tooltippedIsActive:function(){var t=this._tooltipped;function e(t){var e=t.getStyles(["visibility","opacity"]);return"hidden"!==e.visibility&&e.opacity>0}var o=e(t)&&t.getParents().every(e),n=s.getScrolls(),l=document.elementFromPoint(this.mousePosition.x-n.x,this.mousePosition.y-n.y),d=i.isInjected.call(l,t)||l===t;return o&&d},show:function(e,o){var i,n,s,l,d,r=this,h=t.is,p=r._tooltip,u=r._tooltipped;if(e||this._tooltippedIsActive()){if(p||(p=r.buildSkeleton()),a.getInnerElement().setContent(r.content),p.show(),h(e)){if((h(e,"string")||h(e,"object")&&h(e.x,"string")&&h(e.y,"string"))&&(e=u.getPosition(!1,e),l={relative:this._tooltipped.getOffsetParent()},o))for(d=p.getDimensions(),i=0;i<2;i+=1)s=i?"width":"height",e[n=i?"x":"y"]=e[n]-d[s]/2}else e=r.mousePosition,l={relative:document.querySelector("body")};return p.addClassName("show"),a.setPosition(e,l),r.visible=!0,this.dispatchEvent("onShow"),r}},hide:function(){var t=this,e=t._tooltip;return t.visible&&(e.removeClassName("show"),e.hide(),this.dispatchEvent("onHide")),r.clearDelayed(),t.visible=!1,t},toggle:function(){var t=this;t.visible?t.hide():t.show()},setDelay:function(){var t=this,e=t.options.delay;t.visible||r.setDelayed("tooltip",(function(){t.show()}),e)},onShowTooltip:function(t){var o=this;o.mousePosition=e.getPosition(t),this._tooltipped.addEvents(this._events.tooltippedOnShown),i.addEvents.call(document.querySelector("body"),this._events.bodyOnShown,null,null,!0),this.options.delay?o.setDelay():o.show()},onMoveTooltip:function(t){var o=this,i=o.options.delay;o.mousePosition=e.getPosition(t),i>0?(o.hide(),o.setDelay()):a.setPosition(o.mousePosition)},onHideTooltip:function(o){"click"!==o.type&&t.equals(this.mousePosition,e.getPosition(o))||(this._tooltipped.removeEvents(this._events.tooltippedOnShown),i.removeEvents.call(document.querySelector("body"),this._events.bodyOnShown,!0),this.hide())},getRootNode:function(){return this.options.root||this._tooltipped.getOffsetParent()}});return e.onDomReady((function(){if(!s.Features.touchEvents){var t,o,n=document.querySelector("body"),l=0;i.addEvent.call(n,"mouseover [uwa-tooltip]",(function(i){var s=e.getElement(i);if(s&&s.getAttribute("uwa-tooltip")&&(s!==t||o!==s.getAttribute("uwa-tooltip"))){t=s,o=s.getAttribute("uwa-tooltip");var d="true"===s.getAttribute("uwa-tooltip-quick"),a=Number(s.getAttribute("uwa-tooltip-delay"))||800,r=!!(d&&Date.now()-l<500)&&200;s.set("title","");var p=new h(s,s.getAttribute("uwa-tooltip"),{root:n,delay:r||a});p.dispatchEvent("onShowTooltip",[i]),d&&(p.addEvent("onShow",(function(){p.setOption("delay",a)})),p.addEvent("onHide",(function(){l=Date.now()})))}}))}})),t.namespace("Controls/ToolTip",h,t)}));