define("DS/GraphListView/GraphListViewNodeEdgeViewsTemplate",["UWA/Core","DS/egraph/core","DS/egraph/utils","DS/egraph/views","DS/egraph/iact","DS/UIKIT/Tooltip","i18n!DS/GraphListView/assets/nls/ColumnsTitles","css!DS/GraphListView/styles/GraphListViewNodeEdgeViewsTemplate"],(function(e,t,n,i,o,a,s){"use strict";var r,d=!0;function l(){i.SVGEdgeView.call(this,"subway-edge-view")}function _(){i.HTMLNodeView.call(this)}return n.inherit(l,i.SVGEdgeView),l.prototype.onmodifyDisplay=function(e,t,n){i.SVGEdgeView.prototype.onmodifyDisplay.apply(this,arguments);var o,a=this.display.elt,s=e.cl1.c.node,r=e.cl2.c.node,d=r.__MASTER__.options.ancestors;if(d)var l=d.find((e=>e.custom_line_color));(o=l?l.custom_line_color:e.data.color)&&(a.style.stroke=o),e.selected?a.className.baseVal+=" selected":a.className.baseVal=a.className.baseVal.replace(/\selected\b/g,""),r.data.data.options.grid.minororder>0&&r.data.data.options.grid.secondaries||s.data.data.options.grid.minororder>0&&s.data.data.options.grid.secondaries&&Array.isArray(r.data.data.options.ancestors)&&r.data.data.options.ancestors.find((function(e){return"I"===e.semantic.toUpperCase()}))?a.style.strokeDasharray="5,3":r.data.data.options.ancestors&&r.data.data.options.ancestors.find((function(e){return"SO"===e.semantic.toUpperCase()}))&&(a.style.strokeDasharray="15,2,2,2,2,2")},n.inherit(_,i.HTMLNodeView),_.prototype.buildNodeElement=function(t){return r||(r=e.createElement("div",{class:"subway-node-view"})),e.extendElement(r.cloneNode(!0))},_.prototype.onmodifyDisplay=function(){i.HTMLNodeView.prototype.onmodifyDisplay.apply(this,arguments);var e=this.display.elt,t=arguments[0],n=function(e,t,n){var i=e.actualWidth+n;t.style.borderRadius=i/2+"px",t.style.width=i+"px",t.style.height=i+"px",t.style.left=e.actualLeft-n/2+"px",t.style.top=e.actualTop-n/2+"px"};t.data.goingUp=!0;var o=t.data.manager,r=t.__MASTER__.__BRANCH__;if(o&&t.__MASTER__.__LISTVIEWCOPY__&&t.__MASTER__._parentNode&&t.__MASTER__._parentNode.__LISTVIEWCOPY__){var l=t.data.manager.getRowPosition(t.__MASTER__._parentNode.__LISTVIEWCOPY__._getRowID()),_=t.data.manager.getRowPosition(t.__MASTER__.__LISTVIEWCOPY__._getRowID());t.data.goingUp=_<=l}else if(o&&r.nodeList.length>=2&&r.nodeList[1].__LISTVIEWCOPY__){l=t.data.manager.getRowPosition(r.nodeList[0].__LISTVIEWCOPY__._getRowID()),_=t.data.manager.getRowPosition(r.nodeList[1].__LISTVIEWCOPY__._getRowID());t.data.goingUp=_<=l}else t.data.goingUp=!t.gr.data||null==t.gr.data.ascending||!t.gr.data.ascending;if(t.selected?n(t,e,4):n(t,e,0),e.style.background=t.data.color,d){"up"==t.data.pruneMode?e.style.clipPath=1==t.data.goingUp?"polygon(50% 0%, 0% 100%, 100% 100%)":"polygon(50% 100%, 0% 0%, 100% 0%)":"down"==t.data.pruneMode&&(e.style.clipPath=1==t.data.goingUp?"polygon(50% 100%, 0% 0%, 100% 0%)":"polygon(50% 0%, 0% 100%, 100% 100%)"),"locked"!=t.data.pruneMode&&(e.tooltip||(delete e.tooltip,e.tooltip=new a({target:e,body:void 0,offset:{x:10,y:14},position:"bottom"})),e.setStyle("cursor","pointer"));var h=function(e,t){e.tooltip&&(t.data.tooltipText&&""!=t.data.tooltipText?(e.tooltip.getBody().setHTML(t.data.tooltipText),e.tooltip.getBody().show()):e.tooltip.getBody().hide())};if(e.onmouseenter=function(i){"locked"!=t.data.pruneMode&&d&&(n(t,e,12),h(e,t))},e.onmouseleave=function(i){"locked"!=t.data.pruneMode&&d&&(t.selected?n(t,e,4):n(t,e,0),"up"==t.data.pruneMode?e.style.clipPath=1==t.data.goingUp?"polygon(50% 0%, 0% 100%, 100% 100%)":"polygon(50% 100%, 0% 0%, 100% 0%)":"down"==t.data.pruneMode?e.style.clipPath=1==t.data.goingUp?"polygon(50% 100%, 0% 0%, 100% 0%)":"polygon(50% 0%, 0% 100%, 100% 100%)":e.style.clipPath="")},e.onmousemove=function(n){"locked"!=t.data.pruneMode&&d&&(t.data.pruneMode?(e.style.clipPath="","up"==t.data.pruneMode?t.data.tooltipText=s.clickToShowDescendants:t.data.tooltipText=s.clickToShowAncestors):1==t.data.goingUp&&n.offsetY<11||0==t.data.goingUp&&n.offsetY>=11||!t.data.data.options.ancestors?(e.style.clipPath=1==t.data.goingUp?"polygon(50% 0%, 0% 100%, 100% 100%)":"polygon(50% 100%, 0% 0%, 100% 0%)",t.data.tooltipText=s.clickToHideDescendants):(e.style.clipPath=1==t.data.goingUp?"polygon(50% 100%, 0% 0%, 100% 0%)":"polygon(50% 0%, 0% 100%, 100% 100%)",t.data.tooltipText=s.clickToHideAncestors),h(e,t))},e.onmousedown=function(n){if(n.button&&1!=n.button||!d)return!1;var i=t.data.data;if(!t.isProcessingClick){t.isProcessingClick=!0,t.data.pruneMode?"up"!=t.data.pruneMode&&"down"!=t.data.pruneMode||(e.style.clipPath="",t.data.pruneMode=void 0):("down"==n.pruneMode||1==t.data.goingUp&&n.offsetY>=11||0==t.data.goingUp&&n.offsetY<11)&&t.data.data.options.ancestors&&"up"!=n.pruneMode?(e.style.clipPath=1==t.data.goingUp?"polygon(50% 100%, 0% 0%, 100% 0%)":"polygon(50% 0%, 0% 100%, 100% 100%)",t.data.pruneMode="down"):(e.style.clipPath=1==t.data.goingUp?"polygon(50% 0%, 0% 100%, 100% 100%)":"polygon(50% 100%, 0% 0%, 100% 0%)",t.data.pruneMode="up");for(var o=[],a=!1,s=0;s<i.__BRANCH__.nodeList.length;s++){var r=i.__BRANCH__.nodeList[s];if("up"==t.data.pruneMode)r.options.id==i.options.id?(a=!0,o.push({id:r.options.id,pruneMode:"up",branchId:i.__BRANCH__.data.physicalid})):a&&o.push({id:r.options.id,pruneMode:a?"out":"none",branchId:i.__BRANCH__.data.physicalid});else if("down"==t.data.pruneMode){if(r.options.id==i.options.id){a=!0,o.push({id:r.options.id,pruneMode:"down",branchId:i.__BRANCH__.data.physicalid});break}}else if(r.options.id==i.options.id){a=!0,o.push({id:r.options.id,pruneMode:"none",branchId:i.__BRANCH__.data.physicalid});break}}h(e,t),i._modelEvents.publish({event:"_ENOXVersionExplorerUpdatePruneState",data:o}),setTimeout((function(){t.isProcessingClick=!1}),200)}},t.data.data.options.ancestors)t.data.data.options.ancestors.find((function(e){return e.filterid&&e.hasExpand||e.rootPid}))&&(e.style.webkitMaskImage="radial-gradient(circle farthest-side at center, transparent 30%, blue 40%)")}},_.size=function(){return 16},_.getBorderThickness=function(){return 4},{NodeView:_,EdgeView:l,EdgeGeometry:{radius:8,onupdate:function(e){var n,i,o,a,s,r,d,l,_,h=e.swapConnectors?e.cl2.c:e.cl1.c,c=e.swapConnectors?e.cl1.c:e.cl2.c,u=h.aleft,p=c.aleft,g=h.atop,m=c.atop,f=(e.cl1.c.node.height,h.anormx),v=h.anormy,C=c.anormx,E=c.anormy,w=4*(Math.SQRT2-1)/3,S=this.radius,M=S*w;!0===e.merge?u!==p?(i=a=u,d=_=m,s=(o=m-v*S)+v*M,r=(l=u-(C=(u-p)/Math.abs(u-p))*S)+C*M,n=[t.PathCmd.M,u,g,t.PathCmd.L,i,o,t.PathCmd.C,l,_,a,s,r,d,t.PathCmd.L,p,m]):n=[]:u===p?n=[t.PathCmd.M,u,g,t.PathCmd.L,p,m]:(s=o=g,l=r=p,a=(i=p-f*S)+f*M,i<u&&(i=u),d=(_=g-E*S)+E*M,n=[t.PathCmd.M,u,g,t.PathCmd.L,i,o,t.PathCmd.C,l,_,a,s,r,d,t.PathCmd.L,p,m]);e.set("path",n)}},branchDistance:function(){return 16},setPruning:function(e){d=e}}})),define("DS/GraphListView/ColumnManagerBase",["UWA/Core","UWA/Class","DS/LifecycleDAGUtils/ArrayFunctions","DS/Controls/TooltipModel","i18n!DS/GraphListView/assets/nls/ColumnsTitles"],(function(e,t,n,i,o){"use strict";return t.extend({_columns:void 0,init:function(e){var t=this;this._columns=[{text:"",dataIndex:"bi_color",width:10,isSortable:!1,sortableFlag:!1,isDraggable:!1,isEditable:!1,alwaysOn:!0,isHidden:!0,visibleFlag:!1},{text:o.colGraph,dataIndex:"__GRAPH__",columnDragEnabledFlag:!1,width:150,style:{overflow:"scroll"},isSortable:!0,isShowHideable:!0,isDraggable:!1,isEditable:!1,alwaysOn:!0,isHidden:!1,visibleFlag:!0,onCellRequest:function(e){let t=this.reuseCellContent("graph_reusable_content_id");t.computeContentSize=function(){return e.cellView.collectionView._currentGraphViewWidth},t.getTweakerPadding=function(){return 2},e.cellView.setReusableContent(t),e.cellView.getContent().empty(),e.cellView.getContent().style.backgroundImage="url('')"}},"function"==typeof e.onNodeDropdownMenu?{text:o.colMenu,width:40,dataIndex:"__DROPDOWN__",isSortable:!1,isShowHideable:!0,sortableFlag:!1,isDraggable:!1,isEditable:!1,pinned:"right",alwaysOn:!0,getCellTooltip:function(e){return{shortHelp:o.colMenu,updateModel:!1}},onCellRequest:function(t){if(!t.isHeader){let n=this.reuseCellContent("dropdown_reusable_content_id");n.computeContentSize=function(){return 40},n.getTweakerPadding=function(){return 2},t.cellView.getReusableContent()&&n.removeEvent("mousedown"),n.addEvent("mousedown",(function(n){t.nodeModel.__disableSelections__=!0,n.preventDefault(),n.stopPropagation(),t.cellView.collectionView._manager.setActiveCell(t.nodeModel),e.onNodeDropdownMenu({cellInfos:t,event:n}),setTimeout((function(){t.nodeModel.__disableSelections__=!1}),300)})),t.cellView.setReusableContent(n)}}}:{},{text:o.colIntent,dataIndex:"__Intent__",width:50,isSortable:!0,sortableFlag:!0,isDraggable:!1,isEditable:!1,isHidden:!0,visibleFlag:!1,isPinnable:!0,isShowHideable:!1,alwaysOn:!0,getCellValue:function(e){var n="";if(!e.isHeader){var i=e.nodeModel;if(i.options&&i.options.ancestors)for(var o=0;o<i.options.ancestors.length;o++)if(null!=i.options.ancestors[o].dontHighlightLink){var a=t.versionExplorerController.intents[i.options.ancestors[o].semantic];""!==n&&a&&(n+=","),a&&(n+=a)}e.nodeModel.options.grid.__Intent__=n,e.nodeModel.__MASTER__.options.grid.__Intent__=n}return n},getCellTypeRepresentation:function(e){return"string"}},{text:o.colSpecification,dataIndex:"__Specification__",width:20,isSortable:!1,sortableFlag:!1,isDraggable:!1,isShowHideable:!1,isEditable:!1,isHidden:!0,visibleFlag:!1,alwaysOn:!0,getCellValue:function(e){var t=e.nodeModel,n="";t&&t.options&&t.options.ancestors&&(t.options.ancestors.find((function(e){return e.hasExpand}))&&(n="filter"));return{icon:{iconName:n,fontIconFamily:WUXManagedFontIcons.Font3DS},label:"",iconSize:{height:"100%",width:"100%"},alignment:"center",position:"far",events:{mouseenter:function(e){}},action:{callback:function(e){}}}},getCellTypeRepresentation:function(e){var t=e.nodeModel;t&&t.options&&t.options.ancestors&&t.options.ancestors.find((function(e){return e.hasExpand}));return"user"},getCellTooltip:function(e){var n="",i=e.nodeModel;if(i&&i.options&&i.options.ancestors){var a=i.options.ancestors.find((function(e){return e.hasExpand}));if(a){n=o.colFilter;var s=t.versionExplorerController.getFilterHashObject(a.filterid);s&&s.filterQuery&&s.filterQuery.filter&&s.filterQuery.filter.title&&(n=s.filterQuery.filter.title)}}return{shortHelp:n,updateModel:!1}}},{text:o.colTitle,dataIndex:"tree",width:225,isSortable:!0,isDraggable:!0,isEditable:!1,alwaysOn:!0,isHidden:!1,visibleFlag:!0},{text:o.colBranchTitle,dataIndex:"__BranchTitle__",width:150,isSortable:!1,sortableFlag:!1,isDraggable:!0,isEditable:!1,isHidden:!0,alwaysOn:!0,visibleFlag:!1,getCellValue:function(e){var t="";if(!e.isHeader){var n=e.nodeModel;if(n.options&&n.options.ancestors){var i=n.options.ancestors.find((function(e){return e.title}));i&&(t=i.title)}}return t},getCellTypeRepresentation:function(e){return"string"}},{text:o.colInformation,dataIndex:"__Information__",width:225,isSortable:!1,sortableFlag:!1,isDraggable:!1,isEditable:!0,alwaysOn:!0,isHidden:!0,visibleFlag:!1}],this._customColumnViews=[];var n=this._columns.findIndex((function(e){return!e.dataIndex}));n>0&&this._columns.splice(n,1),this.filtersOn=!1},getColumns:function(){return this._columns.slice()},getCustomColumnView:function(){return this._customColumnViews},setDefaultColumns:function(t,n){if(!0===n)this._columns=t;else for(var i=t.length,o=0;o<i;o++){var a=this._columns.findIndex((function(e){return e.dataIndex===t[o].dataIndex}));a>=0?this._columns[a]=e.extend(this._columns[a],t[o],!0):this._columns.push(t[o])}},insertDefaultColumns:function(e){for(var t=e.length,n=0;n<t;n++){var i=this._columns.findIndex((function(t){var i=e[n].insertAfterIndex||"__GRAPH__";return t.dataIndex===i}));i>=0?this._columns.splice(++i,0,e[n]):this._columns.push(e[n])}},addColumns:function(e){if(Array.isArray(e)&&e.length)for(var t=0,n=e.length;t<n;t++)this._columns.findIndex((function(n){return n.dataIndex===e[t].dataIndex}))<0&&this._columns.push(this._customizeColumnView(e[t]))},hasFilterColumns:function(){return this.filtersOn},updateIntentColumnState:function(){if(Array.isArray(this._columns))for(var e=1,t=0,n=this._columns.length;t<n&&e>0;t++)"__Intent__"===this._columns[t].dataIndex&&(e--,Object.keys(this.versionExplorerController.intents).length>0&&(this._columns[t].isHidden=!1,this._columns[t].visibleFlag=!0,this._columns[t].isShowHideable=!0))},modifyFilterColumns:function(e){var t=this;t.filtersOn=e;var n=function(e){var n=t._columns.find((function(t){return t.dataIndex===e}));n&&(n.versionExplorerController=t.versionExplorerController,n.isShowHideable=!0,"__Specification__"===e&&function(e){e.cellClickCB=function(t){if(t.view&&t.view._cellInfos&&t.view._cellInfos.nodeModel){var n=t.view._cellInfos.nodeModel;n.options&&n.options.ancestors&&n.options.ancestors.find((function(e){return e.filterid&&e.hasExpand}))&&(e.isProcessingClick||(e.isProcessingClick=!0,e.versionExplorerController.publishEvent("_ENOXVersionExplorerLaunchFilterSpecification",n),setTimeout((function(){e.isProcessingClick=!1}),200)))}}}(n))};if(Array.isArray(this._columns))for(var i=2,o=0,a=this._columns.length;o<a&&i>0;o++)"__Specification__"===this._columns[o].dataIndex&&(i--,this._columns[o].isHidden=!e,this._columns[o].visibleFlag=e,e&&n(this._columns[o].dataIndex))},_customizeColumnView:function(t){return t=e.extend({text:void 0,dataIndex:void 0,width:"auto",isSortable:!0,isEditable:!1,isHidden:!1},t)},removeColumns:function(e){if(Array.isArray(e)&&e.length)for(var t=0,n=e.length;t<n;t++)this._columns.splice(this._columns.findIndex((function(n){return e[t]===n.dataIndex})),1)},empty:function(){this.removeColumns(this._columns.reduce((function(e,t,n,i){return t.alwaysOn||e.push(t.dataIndex),e}),[]))},showColumns:function(e){for(var t=0,n=e.length;t<n;t++){var i=this._columns.find((function(n){return n.dataIndex===e[t]}));i&&(i.isHidden=!1,i.visibleFlag=!0)}},hideColumns:function(e){for(var t=0,n=e.length;t<n;t++){var i=this._columns.find((function(n){return n.dataIndex===e[t]}));i&&(i.isHidden=!0,i.visibleFlag=!1)}},arrangeColumns:function(e){for(var t={revision:"code",created:"creationDate",owner:"ownerName",maturity:"maturity_nls",project:"project_nls",policy:"policy_nls",organization:"organization_nls",type:"type_nls",reservedby:"reservedbyName"},n=0,i={},o=0;o<this._columns.length;o++)0==this._columns[o].isDraggable&&(i[this._columns[o].dataIndex]=n++);o=0;for(var a=e.length;o<a;o++){var s=void 0===t[e[o]]?e[o]:t[e[o]],r=this._columns.find((function(e){return e.dataIndex===s}));r&&(i[r.dataIndex]=n++)}this._columns.sort((function(e,t){return 0==e.isDraggable&&0==t.isDraggable?i[e.dataIndex]-i[t.dataIndex]:0==e.isDraggable&&0!=t.isDraggable?-1:0!=e.isDraggable&&0==t.isDraggable?1:i[e.dataIndex]>=0&&i[t.dataIndex]>=0?i[e.dataIndex]-i[t.dataIndex]:i[e.dataIndex]>=0&&void 0===i[t.dataIndex]?1:void 0===i[e.dataIndex]&&i[t.dataIndex]>=0?-1:1}))}})})),define("DS/GraphListView/SubwayGraph",["UWA/Core","DS/egraph/core","DS/egraph/utils","DS/egraph/views","DS/egraph/iact","DS/LifecycleDAGUtils/ArrayFunctions","DS/Utilities/Data","css!DS/egraph/views.css","css!DS/egraph/views_default.css"],(function(e,t,n,i,o,a,s){"use strict";function r(e,n,i,o,a,s,r){function d(e,i){var o=new t.Connector;return o.multiset(["cstr","attach"],t.BorderCstr[i],["cstr","offset"],n/2),e.appendConnector(o),o}var l=new t.Node;return l.data={},l.data.color=a,l.data.pruneMode=r,l.views.main=new this.options.nodeView,l.multiset("left",i,"top",o,"width",n,"height",n),l.data.cTop=d(l,"TOP"),l.data.cBot=d(l,"BOTTOM"),l.data.cRight=d(l,"RIGHT"),l.data.cLeft=d(l,"LEFT"),l.data.parentEdges=[],l.data.childEdges=[],l.data.manager="function"==typeof this.getManager?this.getManager():this,s&&(l.data.data=s,s.__SUBWAYGRAPHNODE__=l,l.__MASTER__=s),l.customPropertyFlags={color:t.PropertyFlag.VIEW},e.addNode(l),l}function d(e,n,i,o,a,s){var r;return(r=new t.Edge).set("geometry",this.options.edgeGeometry),r.views.main=new this.options.edgeView,r.data={color:s},e.addEdge(n,i,r),r.childNode=a,r.parentNode=o,a.data.parentEdges.push(r),o.data.childEdges.push(r),r.customPropertyFlags={color:t.PropertyFlag.VIEW},r}return{initGraph:function(){this._grMergeConnections=[],this._graph=new t.EGraph,this._graph.addView("main",new i.HTMLGraphView(this.options.graphContainer));new o.StateMachine(this._graph,void 0,{},this._graph.views.main)},_addNode:function(e,t,n,i,o){var a=this._graph;r.bind(this)(a,this.options.nodeSize,t,n,i||e.__BRANCH__.data.color,e,o)},_drawEdge:function(e,t,n){var i,o,a=this._graph,s=this._manager,r=t.__SUBWAYGRAPHNODE__,l=e.__SUBWAYGRAPHNODE__;if(r&&l){var _=s.getRowPosition(t.__LISTVIEWCOPY__._getRowID())>s.getRowPosition(e.__LISTVIEWCOPY__._getRowID());o=_?l.data.cBot:l.data.cTop,i=e.__BRANCH__===t.__BRANCH__?_?r.data.cTop:r.data.cBot:r.data.cRight;for(var h,c=!0,u=0,p=l.data.parentEdges,g=p.length;u<g;u++)if((h=p[u]).childNode===l&&h.parentNode===r){h.cl1.c===i&&h.cl2.c===o?c=!1:this._removeEdge(h);break}c?d.bind(this)(a,i,o,r,l,n||e.__BRANCH__.data.color):n&&n!==h.data.color&&h.multiset(["data","color"],n)}},_drawHiddenNodeMerge:function(e){var t=this._graph,n=e.parent,i=e.child;if(n.__SUBWAYGRAPHNODE__&&i.__SUBWAYGRAPHNODE__){var o=n.__SUBWAYGRAPHNODE__,a=i.__SUBWAYGRAPHNODE__,s=this._manager,l=this.options.paddingLeft+this._model.getBranchID(e.mergeHiddenNode.__BRANCH__)*this.options.branchDistance,_=(o.top+a.top)/2,h=this._grMergeConnections.find((function(t){return t.masterMerge===e})),c=h?(h.grHiddenBranchMergeNode.actualLeft!==l||h.grHiddenBranchMergeNode.actualTop!==_&&h.grHiddenBranchMergeNode.multiset("left",l,"top",_),h.grHiddenBranchMergeNode):r.bind(this)(t,this.options.nodeSize,l,_,"transparent",e.mergeHiddenNode),u=s.getRowPosition(n.__LISTVIEWCOPY__._getRowID())>s.getRowPosition(i.__LISTVIEWCOPY__._getRowID()),p=c.data[u?"cBot":"cTop"],g=c.data[u?"cTop":"cBot"];if(!h||h.edges[0].cl2.c!==p&&h.edges[1].cl2.c!==g){if(h)for(;h.edges.length;){var m=h.edges.pop();this._removeEdge(m)}var f=d.bind(this)(t,!0===e.mergeLeft?o.data.cLeft:o.data.cRight,p,o,c,n.__BRANCH__.data.color),v=d.bind(this)(t,u?a.data.cBot:a.data.cTop,g,a,c,n.__BRANCH__.data.color),C=d.bind(this)(t,c.data.cBot,c.data.cTop,c,c,n.__BRANCH__.data.color);v.swapConnectors=f.hiddenNodeMergeEdge=v.hiddenNodeMergeEdge=v.merge=C.hiddenNodeMergeEdge=!0,f.merge=f.swapConnectors=e.mergeLeft,h?h.edges=[f,v,C]:(c.data.mergeHiddenNode=e.mergeHiddenNode,this._grMergeConnections.push({grHiddenBranchMergeNode:c,grParent:o,grChild:a,edges:[f,v,C],masterMerge:e}))}}},_removeHiddenBranchMerge:function(e){this._removeNode(e.grHiddenBranchMergeNode)},_drawMergeEdge:function(e){var t,n=this._manager,i=e.parent,o=e.child,a=i.__SUBWAYGRAPHNODE__,s=o.__SUBWAYGRAPHNODE__;if(a&&s){var r,l=this._grMergeConnections.find((function(t){return t.masterMerge===e})),_=n.getRowPosition(a.__MASTER__.__LISTVIEWCOPY__._getRowID())>n.getRowPosition(s.__MASTER__.__LISTVIEWCOPY__._getRowID()),h=_?s.data.cBot:s.data.cTop;r=!0===e.mergeBetweenRoots?!0===e.mergeLeft?a.data.cLeft:a.data.cRight:i.__BRANCH__===o.__BRANCH__?_?a.data.cTop:a.data.cBot:r=_?a.data.cTop:a.data.cBot,(!l||l.edge.cl1.c!==r||l.edge.cl2.c!==h)&&(l&&this._removeMerge(l),(t=d.bind(this)(this._graph,r,h,a,s,e.custom_line_color||i.__BRANCH__.data.color)).merge=!(i.__BRANCH__===o.__BRANCH__),!0===e.mergeBetweenRoots&&(t.swapConnectors=e.mergeLeft),this._grMergeConnections.push({grParent:a,grChild:s,edge:t,masterMerge:e}))}},_removeEdge:function(e,t){var n;!t&&e.childNode&&(n=e.childNode.data.parentEdges.indexOf(e))>=0&&(e.childNode.data.parentEdges.splice(n,1),e.childNode=null),e.parentNode&&(n=e.parentNode.data.childEdges.indexOf(e))>=0&&(e.parentNode.data.childEdges.splice(n,1),e.parentNode=null),e.remove()},_removeMerge:function(e){this._grMergeConnections.splice(this._grMergeConnections.indexOf(e),1),e.grHiddenBranchMergeNode?this._removeHiddenBranchMerge(e):this._removeEdge(e.edge)},_removeNode:function(e){var t;if(e){for(;t=e.data.parentEdges.pop();){if(!0===t.hasOwnProperty("merge")&&!0!==t.hiddenNodeMergeEdge){var n=this._grMergeConnections.findIndex((function(e){return e.edge===t}));n>=0&&this._grMergeConnections.splice(n,1)}this._removeEdge(t,!0)}t=e.data.childEdges.filter((function(e){return!0===e.hiddenNodeMergeEdge}));for(var i=0;i<t.length;i++){var o=this._grMergeConnections.splice(this._grMergeConnections.find((function(e){return e.mergeHiddenNode&&e.edges.indexOf(t[i])>=0})),1);1===o.length&&this._removeHiddenBranchMerge(o[0])}e.remove()}},_clearGraph:function(){var e,t=this._graph;t.withLockedUpdate((function(){for(var n=t.edges.first;n;n=e)e=n.next,n.remove();for(var i=t.nodes.first;i;i=e)e=i.next,i.__MASTER__.__SUBWAYGRAPHNODE__=void 0,i.__MASTER__=void 0,i.remove()})),this._grMergeConnections=[]},_updateGraph:function(e){var t=this,n=Array.isArray(t._model._nodeList)&&t._model._nodeList.length?t._model._nodeList:t._model.getAllDescendants(),i=t._manager,o=i.layout&&i.layout.cellHeight>0?i.layout.cellHeight:0;0===o&&(o=i.layout&&"function"==typeof i.layout.getDefaultRowHeight?i.layout.getDefaultRowHeight():o=i.options.defaultCellHeight);var r=t._nodesRemoved;let d;for(;d=r.pop(),d;)t._removeNode(d.__MASTER__.__SUBWAYGRAPHNODE__);let l=(o-t.options.nodeSize)/2;function _(){a.intersectionDifference(t._model._mergeConnections,t._grMergeConnections,(function(e,t){return t.masterMerge===e}))[1].difference.forEach((function(e){t._removeMerge(e)})),s.forEach(t._model._mergeConnections,(function(e){t._graph.withLockedUpdate((function(){e.mergeHiddenNode?t._drawHiddenNodeMerge(e):t._drawMergeEdge(e)}))}),50,(function(){t._updateGraphSelection()}))}t._treeDoc._getTrueRoot().processDescendants({async:!0,onlyVisibleNodes:!0,processNode:function(e){if(e.nodeModel.__MASTER__){let o=e.nodeModel,a=o.__MASTER__,s=a.__SUBWAYGRAPHNODE__,r=o._getRowID(),d=i.getRowPosition(r),_=t._model.getBranchID(a.__BRANCH__),h=t.options.paddingLeft+(_&&_>=0?_:0)*t.options.branchDistance,c=d+l,u=a.options.grid.custom_node_color||a.__BRANCH__.data.color;var n=t._model._pruneHash?void 0:"locked";let p=t._model._pruneHash?t._model._pruneHash[o.options.id]:void 0;p&&(n=p.pruneMode),t._graph.data?t._graph.data.ascending=t.options.ascending:t._graph.data={ascending:t.options.ascending},t._graph.withLockedUpdate((function(){s?s.actualLeft!==h||s.actualTop!==c?s.multiset("left",h,"top",c):a.options.grid.custom_node_color&&s.data.color!==a.options.grid.custom_node_color||!a.options.grid.custom_node_color&&s.data.color!==a.__BRANCH__.data.color?s.multiset(["data","color"],a.options.grid.custom_node_color||a.__BRANCH__.data.color):(s.multiset("left",h,"top",c+1),s.multiset("left",h,"top",c)):t._addNode(a,h,c,u,n)}))}},onCompleteCB:function(){s.forEach(n,(function(e){t._graph.withLockedUpdate((function(){let n;if(Array.isArray(e.options.ancestors)&&e.options.ancestors.length){let t=e.options.ancestors.find((function(e){return"I"!==e.semantic}));n=t&&t.custom_line_color?t.custom_line_color:e.__BRANCH__.data.color}t._drawEdge(e,e.getParent(),n)}))}),50,_)}});var h=Math.max(t.options.paddingLeft+t._model._branchArray.length*t.options.branchDistance+t.options.nodeSize+t.options.paddingRight,t.options.minGraphColumnWidth),c=!isNaN(t.options.maxGraphColumnWidth)&&t.options.maxGraphColumnWidth>0?t.graphColumnWidth=Math.min(h,t.options.maxGraphColumnWidth):h;isNaN(t._currentGraphColumnWidth)?(t._currentGraphViewWidth=h,t.layout&&"function"==typeof t.layout.getColumnWidth?t._currentGraphColumnWidth=h=t.layout.getColumnWidth("__GRAPH__"):t._currentGraphColumnWidth=c,t.options.graphContainer.setStyle("width",c+"px"),t.options.graphContainer.getElement(".egraph_views_domroot").setStyle("width",h+"px")):h>t._currentGraphViewWidth&&t._currentGraphColumnWidth>0&&h>t._currentGraphColumnWidth&&(t._currentGraphViewWidth=h,t.options.graphContainer.setStyle("width",c+"px"),t.options.graphContainer.getElement(".egraph_views_domroot").setStyle("width",h+"px"),i.setColumnWidth("__GRAPH__",c))},_updateGraphSelection:function(){var e=Array.isArray(this._model._nodeList)&&this._model._nodeList.length?this._model._nodeList:this._model.getAllDescendants(),t=this,n=this._model,i=this._manager,o=(this._treeDoc.getRoots(),this._graph);i.prepareUpdateView(),this.highlightNodesOnSelect&&this._graph.withLockedUpdate((function(){for(var i=0,a=e.length;i<a;i+=1)if(e[i].__SUBWAYGRAPHNODE__)if(n.getXSO().isIn(e[i])){var s=e[i].__SUBWAYGRAPHNODE__;o.addToSelection(s),t.options.highlightParentEdgesOnNodeSelect&&s.data.parentEdges.forEach((function(e){o.addToSelection(e)}))}else if(o.isSelected(e[i].__SUBWAYGRAPHNODE__)){s=e[i].__SUBWAYGRAPHNODE__;o.removeFromSelection(s),t.options.highlightParentEdgesOnNodeSelect&&s.data.parentEdges.forEach((function(e){o.isSelected(e)&&o.removeFromSelection(e)}))}})),setTimeout((function(){i.pushUpdateView()}),200)}}})),define("DS/GraphListView/GraphListView",["UWA/Core","UWA/Class","DS/GraphListView/ColumnManagerBase","DS/GraphListView/SubwayGraph","DS/LifecycleDAGModel/DAGDocumentModel","DS/Tree/Tree","DS/GraphListView/GraphListViewNodeEdgeViewsTemplate","DS/LifecycleDAGUtils/ArrayFunctions","DS/TreeModel/TreeNodeModel","css!DS/GraphListView/styles/GraphListView"],(function(e,t,n,i,o,a,s,r,d){"use strict";return a.extend({init:function(t){var i=this;t=t||{},this._listViewModelEventTokens={},this._listViewManagerEventTokens={},this._masterModelEventTokens={},this._isActivated=!1,this._isPreparingColumns=0,(t=e.extend({apiVersion:2,useAsyncPreExpand:!0,enableTreeColumnEllipsisOverflow:!0,enableKeyboardNavigation:!0,resize:{columns:!0,rows:!1},show:{columnHeaders:!0,rowHeaders:!1},performances:{buildLinks:!1,preloadPool:!0,useRequestAnimationFrameRendering:!1},selection:{cells:!1},columnManager:new n(t),nodeView:s.NodeView,edgeView:s.EdgeView,edgeGeometry:s.EdgeGeometry,maxGraphColumnWidth:null,minGraphColumnWidth:70,paddingLeft:10,paddingRight:10,nodeSize:s.NodeView.size(),branchDistance:s.branchDistance(),ascending:!1,isEditable:!0,showScrollbarsOnHover:!0},t,!0)).columns=t.columnManager.getColumns(),t.columnManager._listView=this,this._parent(t);var a=t.container.getElement(".subway-listview-listcontainer");a&&a.remove(),this.inject(t.container),this._treeDoc=this.getDocument(),this._manager=this.getManager(),this._nodesRemoved=[];this.options.columnManager.getColumns();this.options.columnManager.getCustomColumnView().forEach((function(e){e.id&&e.buildContent&&i._manager.registerReusableCellContent(e)})),this.elements.container.addClassName("subway-listview-listcontainer");var r=this.elements.container.getElement(".wux-datagrid");r&&r.setStyle("height","inherit"),(r=this.elements.container.getElement(".wux-layouts-gridengine"))&&r.setStyle("height","inherit");var d=e.createElement("div",{class:"subway-graph-canvas"});if(this._manager.elements.poolContainerRel.appendChild(d),this.options.graphContainer=d,this.initGraph(),this._manager.onColumnWidthUpdate((function(e){if(0===e.columnID){var t=i.elements.container.getElement(".wux-datagrid"),n=t?t.getElementsByClassName("wux-scroller"):void 0,o=n&&n.length>0?n[0]:void 0;o&&o.scroll(0,0)}"__GRAPH__"===e.dataIndex&&"number"==typeof e.width&&e.width!==i.graphColWidth&&(d.setStyle("width",e.width.toString()+"px"),i.graphColWidth=e.width)})),this._model=this.options.model||new o,!(this._model instanceof o))throw Error("SubwayListView=>ListView.SetModel: model must be instance of DAGDocumentModel")},_addEventListeners:function(){this._addEvent("LISTVIEWMODEL","select",this.onSelectListView.bind(this)),this._addEvent("LISTVIEWMODEL","unselect",this.onUnselectListView.bind(this)),this._addEvent("MASTER","prepareAddDelete",this.prepareUpdateView.bind(this)),this._addEvent("MASTER","pushAddDelete",this.pushUpdateViewAndUpdateGraph.bind(this)),this._addEvent("MASTER","cancelAddDelete",this.cancelUpdate.bind(this)),this._addEvent("MASTER","empty",this.empty.bind(this)),this._addEvent("MASTER","select",this.onSelectMaster.bind(this)),this._addEvent("MASTER","unselect",this.onUnselectMaster.bind(this)),this._addEvent("MASTER","attributeChanged",this.onMasterNodeAttributeChanged.bind(this)),this._addEvent("LISTVIEWMANAGER","sort",this.onSort.bind(this)),this._addEvent("LISTVIEWMANAGER","dblClick",function(e){var t=e.nodeModel.__MASTER__;"function"==typeof this.options.onNodeDoubleClick&&this.options.onNodeDoubleClick(t)}.bind(this)),this._isActivated=!0},deactivate:function(){for(var e in this._listViewModelEventTokens)this._removeEvent("LISTVIEWMODEL",e);for(var e in this._masterModelEventTokens)this._removeEvent("MASTER",e);for(var e in this._listViewManagerEventTokens)this._removeEvent("LISTVIEWMANAGER",e);this._isActivated=!1},activate:function(){this.prepareUpdateView(),this.pushUpdateViewAndUpdateGraph(),this._addEventListeners()},getModel:function(){return this._model},empty:function(){this._treeDoc.empty(),this._clearGraph()},updateNodes:function(){var e=this._treeDoc,t=(this._manager,Array.isArray(this._model._nodeList)&&this._model._nodeList.length?this._model._nodeList:this._model.getAllDescendants());"function"==typeof this.options.nodeSortFunction&&t.sort(this.options.nodeSortFunction),this._treeDoc.prepareUpdate();
//!this._isActivated && this.prepareUpdateView();
for(var n,i=0,o=e.getAllDescendants(),a=o.length;i<a;i+=1)(!(n=o[i]).__MASTER__||t.indexOf(n.__MASTER__)<0)&&this._nodesRemoved.push(e.removeRoot(n));i=0,a=t.length;for(var s=t[i];i<a;s=t[i+=1]){s.__LISTVIEWCOPY__&&s.__LISTVIEWCOPY__.__MASTER__===s?s.__LISTVIEWCOPY__.refreshNodeData(s):this._addChild(s),!0!==s._isSelected||s.__LISTVIEWCOPY__.isSelected()?!s._isSelected&&s.__LISTVIEWCOPY__.isSelected()&&s.__LISTVIEWCOPY__.unselect():s.__LISTVIEWCOPY__.select();var r=s.getAttribute("__filter__");r!==s.__LISTVIEWCOPY__.getAttribute("__filter__")&&s.__LISTVIEWCOPY__.setAttribute("__filter__",r)}this._treeDoc.pushUpdate()},_addChild:function(e){var t,n=this._treeDoc;this._model._nodeList.indexOf(e)>=0&&!e.__LISTVIEWCOPY__&&(t=function(e){var t=e.clone();return t.__MASTER__=e,e.__LISTVIEWCOPY__=t,t}(e),n.addRoot(t))},addChildCallback:function(e){this._addChild(e.data.nodeModel)},_removeChild:function(e){var t=this._treeDoc;if(t.getRoots().length){var n=e.__LISTVIEWCOPY__,i=e.getAllDescendants();this._nodesRemoved.push(t.removeRoot(n));for(var o=0;o<i.length;o++)this._nodesRemoved.push(t.removeRoot(i[o].__LISTVIEWCOPY__))}},removeChildCallback:function(e){this._removeChild(e.data.nodeModel)},prepareUpdateView:function(e){this._manager.prepareUpdateView()},pushUpdateView:function(e){this._manager.pushUpdateView(),this._manager._giveFocus(!0)},pushUpdateViewAndUpdateGraph:function(e){this.updateNodes(),this.pushUpdateView(),this._updateGraph()},cancelUpdate:function(e){this._manager._preventNextUpdateView(),this._manager.pushUpdateView(),this._manager._unpreventNextUpdateView()},onSelectListView:function(e){var t=e.data.nodeModel.__MASTER__;this._model.getXSO().isIn(t)||t.select()},onUnselectListView:function(e){var t=e.data.nodeModel.__MASTER__;this._model.getXSO().isIn(t)&&t.unselect()},onSelectMaster:function(e){var t=e.data.nodeModel;t.__LISTVIEWCOPY__&&!this._treeDoc.getXSO().isIn(t.__LISTVIEWCOPY__)&&t.__LISTVIEWCOPY__.select()},onUnselectMaster:function(e){var t=e.data.nodeModel;this._treeDoc.getXSO().isIn(t.__LISTVIEWCOPY__)&&t.__LISTVIEWCOPY__.unselect()},_addEvent:function(e,t,n){switch(e){case"LISTVIEWMODEL":this._listViewModelEventTokens[t]=this._listViewModelEventTokens[t]||this._treeDoc.subscribe({event:t},n);break;case"LISTVIEWMANAGER":this._listViewManagerEventTokens[t]=this._listViewManagerEventTokens[t]||this._manager._modelEvents.subscribe({event:t},n);break;case"MASTER":this._masterModelEventTokens[t]=this._masterModelEventTokens[t]||this._model.subscribe({event:t},n)}},_removeEvent:function(e,t){switch(e){case"LISTVIEWMODEL":this._listViewModelEventTokens[t]&&this._treeDoc.unsubscribe(this._listViewModelEventTokens[t],this._listViewModelEventTokens[t]=void 0);break;case"LISTVIEWMANAGER":this._listViewManagerEventTokens[t]&&this._manager._modelEvents.unsubscribe(this._listViewManagerEventTokens[t],this._listViewManagerEventTokens[t]=void 0);break;case"MASTER":this._masterModelEventTokens[t]&&this._model.unsubscribe(this._masterModelEventTokens[t],this._masterModelEventTokens[t]=void 0)}},onMasterNodeAttributeChanged:function(e){var t;if(t=e.target.__LISTVIEWCOPY__){var n={};n[e.data.changedAttribute]=e.data.changedAttributeValue,"function"==typeof t.refreshNodeData?t.refreshNodeData(n):t.setAttribute(e.data.changedAttribute,e.data.changedAttributeValue),this._manager.updateRowView(t._getRowID())}},updateColumns:function(e){var t="boolean"!=typeof e||e,n=this.options.columnManager.getColumns();t&&this.loadColumns(n);for(var i=0,o=n.length;i<o;i++)this._manager[n[i].isHidden?"hideColumn":"showColumn"](n[i].dataIndex)},getColumnManager:function(){return this.options.columnManager},prepareUpdateColumns:function(){this._isPreparingColumns++,this.prepareUpdateView()},pushUpdateColumns:function(){this._isPreparingColumns--,0===this._isPreparingColumns?(this.updateColumns(),this.pushUpdateView()):this._isPreparingColumns<0&&this._isPreparingColumns},onSort:function(e){var t="__GRAPH__",n=this._manager;"string"==typeof this.options.graphSortingColumnID&&e.columnDataIndex===this.options.graphSortingColumnID||Array.isArray(this.options.graphSortingColumnID)&&this.options.graphSortingColumnID.indexOf(e.columnDataIndex)>=0?(this.options.ascending="asc"===e.sortOrder,this._updateGraph(),n.isColumnHidden(t)&&(n.elements.poolContainerRel.getElement(".subway-graph-canvas").show(),n.showColumn(t))):!n.isColumnHidden(t)&&(n.hideColumn(t),n.elements.poolContainerRel.getElement(".subway-graph-canvas").hide())},cleanup:function(){this.deactivate(),this.empty()},setFocus:function(e){e instanceof d&&this._manager._setActiveAndScrollToNode(e.__LISTVIEWCOPY__)},setRowHeight:function(e){var t=this._manager;if(!isNaN(e)&&e>0&&t.options.defaultCellHeight!==e){this.prepareUpdateView();var n=this._treeDoc.getRoots();t._invalidateLayout(),t._instance._hideRowInsertionMark();for(var i=0,o=n.length;i<o;i++){var a=n[i]._getRowID(),s=t.getRowHeight(a);t.setCellsContainerSize({height:t.getCellsContainerSize().height-s+e},!1),t._listOfRowsHeight[a]=e,t._modelEvents.publish({event:"/MANAGER/ROW/HEIGHT",data:{rowID:a,height:e}})}t._indexRowsPosition({fromRowID:0,async:!1}),t.options.defaultCellHeight=e,this.pushUpdateViewAndUpdateGraph()}}},i)})),define("DS/GraphListView/GraphDataGridListView",["UWA/Core","UWA/Class","DS/GraphListView/ColumnManagerBase","DS/GraphListView/SubwayGraph","DS/LifecycleDAGModel/DAGDocumentModel","DS/DataGridView/DataGridView","DS/GraphListView/GraphListViewNodeEdgeViewsTemplate","DS/LifecycleDAGUtils/ArrayFunctions","DS/TreeModel/TreeNodeModel","DS/TreeModel/TreeDocument","DS/TreeModel/DataModelSet","css!DS/GraphListView/styles/GraphListView"],(function(e,t,n,i,o,a,s,r,d,l,_){"use strict";return a.extend({init:function(t){var i=this;t=t||{},this._listViewModelEventTokens={},this._listViewManagerEventTokens={},this._masterModelEventTokens={},this._isActivated=!1,this._isPreparingColumns=0;var a=t.versionExplorerController.options.pruningState;void 0!==a&&s.setPruning(a);var r=!0;null!=t.versionExplorerController.options.unselectAllOnEmptyArea&&(r=t.versionExplorerController.options.unselectAllOnEmptyArea),(t=e.extend({apiVersion:2,useAsyncPreExpand:!0,enableTreeColumnEllipsisOverflow:!0,enableKeyboardNavigation:!0,identifier:1==t.useGlobalStorage?t.globalStorageName:"RevisionExplorerCustomizeColumns-DataGrid",useWidgetPreferencesFlag:1!=t.useGlobalStorage,cellDragEnabledFlag:!0,resize:{columns:!0,rows:!1},show:{columnHeaders:!0,rowHeaders:!1},performances:{buildLinks:!1,preloadPool:!0,useRequestAnimationFrameRendering:!1},columnManager:new n(t),nodeView:s.NodeView,edgeView:s.EdgeView,edgeGeometry:s.EdgeGeometry,maxGraphColumnWidth:null,minGraphColumnWidth:70,paddingLeft:10,paddingRight:10,nodeSize:s.NodeView.size(),branchDistance:s.branchDistance(),ascending:!1,isEditable:!0,showScrollbarsOnHover:!0,defaultColumnDef:{width:"auto",typeRepresentation:"string",getCellClassName:e=>-1==e.rowID||!i._model._FILTER_ENABLED||e.nodeModel&&e.nodeModel.__MASTER__.getAttribute("__filter__")?"":"subway-graph-unselectable",allowUnsafeHTMLContent:!1},selection:{cells:!1,viewBased:!1,nodes:!0,preSelection:!1,toggle:!0,unselectAllOnEmptyArea:r,enableListSelection:!0,canMultiSelect:!1},selectionBehavior:{selectOnContextualEvent:!1,unselectAllOnEmptyArea:r,toggle:!0},layoutOptions:{rowsHeader:!0,cellHeight:t.defaultCellHeight}},t,!0)).columns=t.columnManager.getColumns();var d=new _,h=new l({dataModelSet:d,shouldBeSelected:function(e){return!e.__disableSelections__}});h.getFilterManager();if(h.subscribe({event:"filter"},(function(e){var n=null!=e.data.propertyId;setTimeout((function(){var e=i._manager,o=h.getFilterManager().isDataFiltered();!o&&e.elements.header&&(e.elements.header.getElementsByClassName("wux-datagridview-filter").length>0&&(o=!0));n?i.prepareUpdateColumns():i.prepareUpdateView(),e.elements.poolContainer.getElement(".subway-graph-canvas").hide();var a=i.getColumnOrGroup("__GRAPH__"),s=a.isHidden||!a.visibleFlag,r=t.versionExplorerController._isGraphColumnHiddenExplicitly,d=t.versionExplorerController._isGraphColumnHiddenByFilter;r||((o||s)&&1!=d?(i.getColumnManager().hideColumns(["__GRAPH__"]),d=t.versionExplorerController._isGraphColumnHiddenByFilter=o&&1!=s&&1!=r,null==t.versionExplorerController._isGraphColumnHiddenExplicitly&&(r=t.versionExplorerController._isGraphColumnHiddenExplicitly=!0)):(i.getColumnManager().showColumns(["__GRAPH__"]),t.versionExplorerController._isGraphColumnHiddenByFilter=!1,null==t.versionExplorerController._isGraphColumnHiddenExplicitly&&(r=t.versionExplorerController._isGraphColumnHiddenExplicitly=!1))),n?i.pushUpdateColumns():i.pushUpdateViewAndUpdateGraph(),setTimeout((function(){i._setSubwayGraphCanvasWidth(),o||r||s&&!d||e.elements.poolContainer.getElement(".subway-graph-canvas").show()}),200)}),n?200:0)})),this._model=t.model||new o,this._model._GraphListViewModel=h,this._model._GraphListView=this,!(this._model instanceof o))throw Error("SubwayListView=>ListView.SetModel: model must be instance of DAGDocumentModel");t.treeDocument=h,t.treeDocument.isFirstLoad=!0,t.columnManager._listView=this,this._parent(t),this.options=t;var c=t.container.getElement(".subway-listview-listcontainer");c&&c.remove(),this.inject(t.container),this._treeDoc=this.getTreeDocument(),this._manager=i,this._nodesRemoved=[],this.options.columnManager.getCustomColumnView().forEach((function(e){e.id&&e.buildContent&&i._manager.registerReusableCellContent(e)})),this.elements.container.addClassName("subway-listview-listcontainer");var u=this.elements.container.getElement(".wux-datagrid");u&&u.setStyle("height","inherit"),(u=this.elements.container.getElement(".wux-layouts-gridengine"))&&u.setStyle("height","inherit");var p=e.createElement("div",{class:"subway-graph-canvas"});this._manager.elements.poolContainer.appendChild(p),this.options.graphContainer=p,this.initGraph(),this.addEventListener("columnWidthChange",(function(e){if(e.options.columnID==i.layout.getColumnIndex("__GRAPH__"))i._setSubwayGraphCanvasWidth();else if(e.options.columnIDs)for(var t=0;t<e.options.columnIDs.length;t++)if("__GRAPH__"===e.options.columnIDs[t]){i._setSubwayGraphCanvasWidth();break}})),this.layout.getRowHeightFunction=function(e){return i.layout.cellHeight}},_setSubwayGraphCanvasWidth:function(){var e=this._manager.elements.poolContainer.getElement(".subway-graph-canvas"),t=this.layout.getColumnWidth("__GRAPH__");e.setStyle("width",t.toString()+"px"),e.getElement(".egraph_views_domroot").setStyle("width",t+"px"),this._manager._currentGraphColumnWidth=t},_updateFilters:function(){for(var e='{"label":{"filterId":"stringRegexp"}',t=this.options.columnManager.getColumns(),n=!1,i=0,o=t.length;i<o;i++){if(!("__GRAPH__"==t[i].dataIndex||"__DROPDOWN__"==t[i].dataIndex||"thumbnail"==t[i].dataIndex||"bi_color"==t[i].dataIndex||"__Information__"==t[i].dataIndex||"__Specification__"==t[i].dataIndex)){this._model._GraphListViewModel.getFilterManager().filterModel[t[i].dataIndex]||(n=!0);var a="creationDate"==t[i].dataIndex||"modified"==t[i].dataIndex;if(!a&&this._model._nodeList.length>0&&this._model._nodeList[0].options&&this._model._nodeList[0].options.grid){a=!1;for(var s=0;s<this._model._nodeList.length;s++){if((d=this._model._nodeList[s].options.grid[t[i].dataIndex])instanceof Date){a=!0;break}if(null!=d)break}}var r=!1;if(!r&&this._model._nodeList.length>0&&this._model._nodeList[0].options&&this._model._nodeList[0].options.grid)for(s=0;s<this._model._nodeList.length;s++){var d;if("number"==typeof(d=this._model._nodeList[s].options.grid[t[i].dataIndex])){r=!0;break}if(null!=d)break}var l="maturity_nls"==t[i].dataIndex||"__Intent__"==t[i].dataIndex;a?(e+=",",e+='"'+t[i].dataIndex+'":{"filterId":"date"}'):l?(e+=",",e+='"'+t[i].dataIndex+'":{"filterId":"set"}'):r?(e+=",",e+='"'+t[i].dataIndex+'":{"filterId":"number"}'):(e+=",",e+='"'+t[i].dataIndex+'":{"filterId":"stringRegexp"}')}}e+="}";this._treeDoc;if(n){let t=JSON.parse(e);this._model._GraphListViewModel.setFilterModel(t)}},_addEventListeners:function(){this._addEvent("LISTVIEWMODEL","select",this.onSelectListView.bind(this)),this._addEvent("LISTVIEWMANAGER","UPDATE_VIEW_COMPLETED",this.onUpdateViewCompleated.bind(this)),this._addEvent("LISTVIEWMODEL","unselect",this.onUnselectListView.bind(this)),this._addEvent("MASTER","prepareAddDelete",this.prepareUpdateView.bind(this)),this._addEvent("MASTER","pushAddDelete",this.pushUpdateViewAndUpdateGraph.bind(this)),this._addEvent("MASTER","cancelAddDelete",this.cancelUpdate.bind(this)),this._addEvent("MASTER","empty",this.empty.bind(this)),this._addEvent("MASTER","select",this.onSelectMaster.bind(this)),this._addEvent("MASTER","unselect",this.onUnselectMaster.bind(this)),this._addEvent("MASTER","attributeChanged",this.onMasterNodeAttributeChanged.bind(this)),this._addEvent("LISTVIEWMANAGER","sort",this.onSort.bind(this)),this._addEvent("LISTVIEWMANAGER","dblClick",function(e){var t=e.nodeModel.__MASTER__;"function"==typeof this.options.onNodeDoubleClick&&this.options.onNodeDoubleClick(t)}.bind(this)),this._isActivated=!0},deactivate:function(){for(var e in this._listViewModelEventTokens)this._removeEvent("LISTVIEWMODEL",e);for(var e in this._masterModelEventTokens)this._removeEvent("MASTER",e);for(var e in this._listViewManagerEventTokens)this._removeEvent("LISTVIEWMANAGER",e);this._isActivated=!1},activate:function(){this.prepareUpdateView(),this.pushUpdateViewAndUpdateGraph(),this._addEventListeners()},getModel:function(){return this._model},empty:function(){this._clearGraph()},updateNodes:function(){var e=this._treeDoc,t=Array.isArray(this._model._nodeList)&&this._model._nodeList.length?this._model._nodeList:this._model.getAllDescendants();if("function"==typeof this.options.nodeSortFunction)t.sort(this.options.nodeSortFunction);else{t.sort((function(e,t){return!t&&(t=e=this),e.options.fakeDate&&t.options.fakeDate?e.options.fakeDate.getTime()==t.options.fakeDate.getTime()?0:e.options.fakeDate.getTime()<t.options.fakeDate.getTime()?1:-1:e.options.creationDate.getTime()==t.options.creationDate.getTime()?0:e.options.creationDate.getTime()<t.options.creationDate.getTime()?1:-1}))}this._treeDoc.prepareUpdate();for(
//!this._isActivated && this.prepareUpdateView();
var n=e.getAllDescendants(),i=0;i<n.length;i++){var o=n[i];(!o.__MASTER__||t.indexOf(o.__MASTER__)<0)&&this._nodesRemoved.push(e.removeRoot(o))}for(i=0;i<t.length;i++){var a=t[i];a.__LISTVIEWCOPY__&&a.__LISTVIEWCOPY__.__MASTER__===a?a.__LISTVIEWCOPY__.refreshNodeData(a):this._addChild(a),!0!==a._isSelected||a.__LISTVIEWCOPY__.isSelected()?!a._isSelected&&a.__LISTVIEWCOPY__.isSelected()&&a.__LISTVIEWCOPY__.unselect():a.__LISTVIEWCOPY__.select();var s=a.getAttribute("__filter__");s!==a.__LISTVIEWCOPY__.getAttribute("__filter__")&&a.__LISTVIEWCOPY__.setAttribute("__filter__",s)}this._treeDoc.pushUpdate(),e.isFirstLoad&&(e.isFirstLoad=void 0)},_addChild:function(e){var t,n=this._treeDoc,i=this._model._nodeList;if(i.indexOf(e)>=0&&!e.__LISTVIEWCOPY__)if(t=function(e){var t=e.clone();return t.__MASTER__=e,e.__LISTVIEWCOPY__=t,t}(e),null!==this.sortModel&&this.sortModel.length>0&&"asc"===this.sortModel[0].sort)n.addRoot(t);else{var o=i.indexOf(e);n.addRoot(t,o)}},addChildCallback:function(e){this._addChild(e.data.nodeModel)},_removeChild:function(e){var t=this._treeDoc;if(t.getRoots().length){var n=e.__LISTVIEWCOPY__,i=e.getAllDescendants();this._nodesRemoved.push(t.removeRoot(n));for(var o=0;o<i.length;o++)this._nodesRemoved.push(t.removeRoot(i[o].__LISTVIEWCOPY__))}},removeChildCallback:function(e){this._removeChild(e.data.nodeModel)},pushUpdateViewAndUpdateGraph:function(e){this.updateNodes(),this.pushUpdateView(),this._updateGraph()},cancelUpdate:function(e){this._manager.pushUpdateView()},onSelectListView:function(e){var t=e.data.nodeModel.__MASTER__;this._model.getXSO().isIn(t)||t.select()},onUnselectListView:function(e){var t=e.data.nodeModel.__MASTER__;this._model.getXSO().isIn(t)&&t.unselect()},onUpdateViewCompleated:function(e){},onSelectMaster:function(e){var t=e.data.nodeModel;t.__LISTVIEWCOPY__&&!this._treeDoc.getXSO().isIn(t.__LISTVIEWCOPY__)&&t.__LISTVIEWCOPY__.select()},onUnselectMaster:function(e){var t=e.data.nodeModel;t.__LISTVIEWCOPY__&&this._treeDoc.getXSO().isIn(t.__LISTVIEWCOPY__)&&t.__LISTVIEWCOPY__.unselect()},_addEvent:function(e,t,n){switch(e){case"LISTVIEWMODEL":this._listViewModelEventTokens[t]=this._listViewModelEventTokens[t]||this._treeDoc.subscribe({event:t},n);break;case"LISTVIEWMANAGER":this._listViewManagerEventTokens[t]=this._listViewManagerEventTokens[t]||this._manager._modelEvents.subscribe({event:t},n);break;case"MASTER":this._masterModelEventTokens[t]=this._masterModelEventTokens[t]||this.getTreeDocument().subscribe({event:t},n);break;case"MODEL":this._masterModelEventTokens[t]=this._masterModelEventTokens[t]||this._model.subscribe({event:t},n)}},_removeEvent:function(e,t){switch(e){case"LISTVIEWMODEL":this._listViewModelEventTokens[t]&&this._treeDoc.unsubscribe(this._listViewModelEventTokens[t],this._listViewModelEventTokens[t]=void 0);break;case"LISTVIEWMANAGER":this._listViewManagerEventTokens[t]&&this._manager._modelEvents.unsubscribe(this._listViewManagerEventTokens[t],this._listViewManagerEventTokens[t]=void 0);break;case"MASTER":case"MODEL":this._masterModelEventTokens[t]&&this._model.unsubscribe(this._masterModelEventTokens[t],this._masterModelEventTokens[t]=void 0)}},onMasterNodeAttributeChanged:function(e){var t;if(t=e.target.__LISTVIEWCOPY__){var n={};n[e.data.changedAttribute]=e.data.changedAttributeValue,"function"==typeof t.refreshNodeData?t.refreshNodeData(n):t.setAttribute(e.data.changedAttribute,e.data.changedAttributeValue),this._manager.updateRowView(t._getRowID())}},getRowPosition(e){return this.layout.getRowPosition(e)},setColumnWidth(e,t){var n=this.layout.getColumnIndex(e);n>0&&(this.layout.setColumnWidth(n,t),this.layout._saveColumnWidthInPreferences(n),this.pushUpdateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0},!0))},updateColumns:function(e){var t=this,n="boolean"!=typeof e||e,i=this.options.columnManager.getColumns();if(n){this.layout._saveDataInPreferences("unpinnedColumnsOrder",{}),this.layout._saveDataInPreferences("pinnedColumnsOrder",{}),this.layout.deleteDataGridViewPreferences();for(var o=0,a=i.length;o<a;o++)this.getColumnOrGroup(i[o].dataIndex)&&(i[o].pinned=this.getColumnOrGroup(i[o].dataIndex).pinned,this.getColumnOrGroup(i[o].dataIndex).isShowHideable&&this.getColumnOrGroup(i[o].dataIndex).alwaysOn&&(i[o].isHidden=!this.layout.getColumnVisibleFlag(i[o].dataIndex),i[o].visibleFlag=!i[o].isHidden)),this._removeColumnOrGroup(this.columns,i[o].dataIndex);this.layout.applyColumns();for(o=0,a=i.length;o<a;o++)if(null!=i[o].pinned&&"unpinned"!=i[o].pinned&&0!=i[o].isDraggable&&"left"!=i[o].pinned){this.getColumnOrGroup(i[o])||this.addColumnOrGroup(i[o]),0==i[o].isHidden?i[o].visibleFlag=!0:i[o].visibleFlag=!1,this.layout.setColumnVisibleFlag(i[o].dataIndex,i[o].visibleFlag,{isUserInteraction:!0});var s="unpinned"==i[o].pinned?"right":i[o].pinned;this.layout.setColumnPinned(i[o].dataIndex,s,{isUserInteraction:!0})}for(o=0,a=i.length;o<a;o++)if(null!=i[o].pinned&&"unpinned"!=i[o].pinned&&0==i[o].isDraggable){this.getColumnOrGroup(i[o])||this.addColumnOrGroup(i[o]),0==i[o].isHidden?i[o].visibleFlag=!0:i[o].visibleFlag=!1,this.layout.setColumnVisibleFlag(i[o].dataIndex,i[o].visibleFlag,{isUserInteraction:!0});s="unpinned"==i[o].pinned?"right":i[o].pinned;this.layout.setColumnPinned(i[o].dataIndex,s,{isUserInteraction:!0})}for(o=0,a=i.length;o<a;o++)null!=i[o].pinned&&"unpinned"!=i[o].pinned||(this.getColumnOrGroup(i[o])||this.addColumnOrGroup(i[o],o),0==i[o].isHidden?i[o].visibleFlag=!0:i[o].visibleFlag=!1,this.layout.setColumnVisibleFlag(i[o].dataIndex,i[o].visibleFlag,{isUserInteraction:!0}));for(o=0,a=i.length;o<a;o++)if(null!=i[o].pinned&&"unpinned"!=i[o].pinned&&0!=i[o].isDraggable&&"right"!=i[o].pinned){this.getColumnOrGroup(i[o])||this.addColumnOrGroup(i[o]),0==i[o].isHidden?i[o].visibleFlag=!0:i[o].visibleFlag=!1,this.layout.setColumnVisibleFlag(i[o].dataIndex,i[o].visibleFlag,{isUserInteraction:!0});s="unpinned"==i[o].pinned?"right":i[o].pinned;this.layout.setColumnPinned(i[o].dataIndex,s,{isUserInteraction:!0})}}if(this._manager.options.selection.canMultiSelect){this.layout.rowsHeader=this.layoutOptions.rowsHeader=!0,this.rowSelection="multiple";var r=this._model.getXSO().get();for(o=0;o<r.length;o++)r[o].options.grid.__checked__=!0}else this.layout.rowsHeader=this.layoutOptions.rowsHeader=!1,this.rowSelection="single";this.columnSelection="none",this.cellSelection="none",this._updateFilters(),this.sortModel&&this.sortModel.length>0&&setTimeout((function(){var e=t.sortModel;t.sortModel=void 0,t.sortModel=e,t.layout.saveColumnSortModelInPreferences()}),200),this.addEventListener("columnOrderChange",(function(e){})),this.addEventListener("allCellsRendered",(function(e){})),this.addEventListener("filterChange",(function(e){t.prepareUpdateView(),t.pushUpdateViewAndUpdateGraph()})),this.addEventListener("sortModelChange",(function(e){var n=t.sortModel!==t.lastSortModel;t.lastSortModel=t.sortModel,n&&t.sortModel&&t.sortModel.length>0&&t._updateGraph()})),n&&this.pushUpdateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0},!0)},getColumnManager:function(){return this.options.columnManager},prepareUpdateColumns:function(){this._isPreparingColumns++,this.prepareUpdateView()},pushUpdateColumns:function(){this._isPreparingColumns--,0===this._isPreparingColumns?(this.updateColumns(),this.pushUpdateView()):this._isPreparingColumns<0&&this._isPreparingColumns},onSort:function(e){},cleanup:function(){this.deactivate(),this.empty()},setFocus:function(e){e instanceof d&&(this.setActiveCell(e.__LISTVIEWCOPY__),this.scrollToCellAt(e.__LISTVIEWCOPY__))},setRowHeight:function(e){var t=this.layout.layoutDensity;26===e?"compact"!==t&&(this.layout.layoutDensity="compact"):"comfortable"!==t&&(this.layout.layoutDensity="comfortable"),this.layout.cellHeight=e}},i)}));