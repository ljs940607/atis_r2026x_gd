define("DS/XAppUXComponents/XAppWelcomeScreenIntegrator",["UWA/Core","DS/XAppServices/XAppWelcomeScreenServices","DS/XAppServices/XAppTrackers","i18n!DS/XAppUXComponents/assets/nls/XAppWelcomeScreenIntegrator","css!DS/XAppUXComponents/assets/css/XAppWelcomeScreenIntegrator"],(function(e,t,n,i){"use strict";var o=function(e){this.options=e,this._lastTaskProgressBarStepTime=0};return o.prototype.initialize=function(){this._configureWidgetOptions(),this._listenEvents()},o.prototype.destroy=function(){this.clean()},o.prototype.clean=function(){delete this.options,this._lastTaskProgressBarStepTime=0,this._unlistenEvents()},o.prototype._listenEvents=function(){let e=this.getExecutionContext();if(e){let i=e.getComponent(WAfrStandardComponentKey.ModelEvents);i&&(this._onWelcomeScreenReadyEventToken=t.callWhenWelcomeScreenViewIsReady(e,this._addAppSwitchButton.bind(this)),this._onButtonClickedEventToken=i.subscribe({event:"EVT_WelcomeScreenButtonClicked"},this._onSidePanelButtonClick.bind(this)),this._onLinkClickedEventToken=i.subscribe({event:"EVT_WelcomeScreenLinkClicked"},this._onSidePanelLinkClick.bind(this)),this._onFileDroppedEventToken=i.subscribe({event:"EVT_WelcomeScreenFileDropped"},(function(t){let i=!(!t||!t.isDropOK)&&!!t.isDropOk;n.trackLandingPageOnDrop(e,{isDropOk:String(i)})})),this._onGuidedTourClickedEventToken=i.subscribe({event:"EVT_WelcomeScreenGuidedTourClicked"},(function(){n.trackLandingPageAppOverviewClick(e)})),this._onTaskProgressBarCompleteStepEventToken=i.subscribe({event:"XApp/WelcomeScreen/TaskProgressBarCompleteStep"},this._onTaskProgressBarCompleteStep.bind(this)),this._onTaskProgressBarCloseEventToken=i.subscribe({event:"XApp/WelcomeScreen/TaskProgressBarClose"},this._onTaskProgressBarClose.bind(this)))}},o.prototype._unlistenEvents=function(){let e=this.getExecutionContext();if(e){let t=e.getComponent(WAfrStandardComponentKey.ModelEvents);if(t){let e=[this._onWelcomeScreenReadyEventToken,this._onViewReadyEventToken,this._onButtonClickedEventToken,this._onLinkClickedEventToken,this._onFileDroppedEventToken,this._onGuidedTourClickedEventToken,this._onTaskProgressBarCompleteStepEventToken,this._onTaskProgressBarCloseEventToken];for(let n=0;n<e.length;++n)t.unsubscribe(e[n])}}},o.prototype._configureWidgetOptions=function(){widget&&widget.setValue("x3dShowSendToMobile",!1)},o.prototype._onTaskProgressBarCompleteStep=function(e){if(e&&e.progressBar){1===e.progressBar.currentStep&&(this._lastTaskProgressBarStepTime=0);let t=e.progressBar.lastStepChangeTime-this._lastTaskProgressBarStepTime;this._lastTaskProgressBarStepTime=e.progressBar.lastStepChangeTime;let i=e.progressBar.lastStepChangeTime-e.progressBar.startTime,o=t>0?Math.round(t/1e3*10,1)/10:null,s=Math.round(i/1e3*10)/10,r=e.progressBar.currentStep&&e.progressBar.currentStep===e.progressBar.totalStepCount;n.trackModelLoadingTime(this.getExecutionContext(),{fromAction:e.fromAction,progressStepNameIdentifier:e.stepName,stepDurationInSeconds:o,totalTimeInSeconds:s,isLoadingOver:r?1:0,progressStepIndex:e.progressBar.currentStep?e.progressBar.currentStep:null,progressStepsNb:e.progressBar.totalStepCount?e.progressBar.totalStepCount:null})}},o.prototype._onTaskProgressBarClose=function(e){if(e&&e.progressBar){let t=e.progressBar.startTime>0?Math.floor((Date.now()-e.progressBar.startTime)/1e3):null;n.trackModelLoadingCancelled(this.getExecutionContext(),{stepIndex:e.progressBar.currentStep,stepsNb:e.progressBar.totalStepCount,ellapsedTimeBeforeCancel:t,progressRate:Math.floor(e.progressBar.barProgressRate)})}},o.prototype._onSidePanelLinkClick=function(e){n.trackLandingPageLinkClick(this.getExecutionContext(),{linkName:e.id})},o.prototype._onSidePanelButtonClick=function(e){n.trackLandingPageActionButtonClick(this.getExecutionContext(),{buttonName:e.id})},o.prototype._addAppSwitchButton=function(){let t=document.getElementsByClassName("afr-welcome-screen-title"),o=t.length>0?t[t.length-1]:null,s=o?o.textContent:null;if(s&&this.options.appSwitchAction){let t=s.split(" "),r=t.pop(),a=t.join(" ");if(this.appSwitchButton={tag:"span",class:"xapp-appswitch-btn fonticon fonticon-chevron-down",title:i.get("SwitchAppBtn.Hover"),events:{click:function(e){let t=this.getExecutionContext();if(t){let i=t.getComponent(WAfrStandardComponentKey.HandlerComponent);i&&i.executeHandler({id:this.options.appSwitchAction,args:{fromLandingPage:!0,button:e.currentTarget}}),n.trackLandingPageAppSwitchClick(t)}}.bind(this)}},o.innerHTML="",a.length>0){new e.Element("span",{text:a+" "}).inject(o)}new e.Element("span",{html:[{tag:"span",text:r},this.appSwitchButton],styles:/iPad|iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1?{display:"inline-block"}:{"white-space":"nowrap"}}).inject(o)}},o})),define("DS/XAppUXComponents/XAppDragAndDropManager",["UWA/Promise"],(function(e){"use strict";var t=function(){Object.defineProperty(this,"dndOverlayTypes",{value:{forbidden:"Forbidden",overItems:"OverItems",overFullPage:"OverFullPage"},writable:!1})};return t.prototype.initalize=function(e){this.options=e,this.hideOverlayToken=void 0,this.dndItemOverlays=[],this.dndFullPageOverlay=null,this.dndForbiddenOverlay=null,void 0!==this.options.dragAndDrop&&!0!==this.options.dragAndDrop||(this._initViewerDDEventListeners(e),this.buildOverlay(e))},t.prototype.destroy=function(){this.clean()},t.prototype.buildOverlay=function(e){e&&e.overlayContainer&&e.callbacks&&(this.dndFullPageOverlay=new UWA.Element("div",{class:"xapp-dnd-fullpage",html:[{tag:"div",class:e.icons.dragAndDrop+" fonticon-5x"}],events:{drop:e.callbacks.onDrop}}),this.dndFullPageOverlay.inject(e.overlayContainer),this.dndFullPageOverlay.hide(),this.dndForbiddenOverlay=new UWA.Element("div",{class:"xapp-dnd-fullpage",html:[{tag:"div",class:e.icons.forbidden+" fonticon-5x"}]}),this.dndForbiddenOverlay.inject(e.overlayContainer),this.dndForbiddenOverlay.hide())},t.prototype.clean=function(){this._removeViewerDDEventListeners(this.options),this.dndFullPageOverlay&&(this.dndFullPageOverlay.remove(),this.dndFullPageOverlay.destroy(),delete this.dndFullPageOverlay),this.dndForbiddenOverlay&&(this.dndForbiddenOverlay.remove(),this.dndForbiddenOverlay.destroy(),delete this.dndForbiddenOverlay),delete this.options},t.prototype.onDragEnter=function(t,n){if(!("string"==typeof this.options.appId&&""!==this.options.appId&&n.dataTransfer.types.indexOf(this.options.appId)>=0||n.dataTransfer&&Array.isArray(n.dataTransfer.types)&&0===n.dataTransfer.types.length&&""===n.dataTransfer.getData("text")))if(n.stopPropagation(),n.preventDefault(),this.options.callbacks.onDragEnter&&"function"==typeof this.options.callbacks.onDragEnter){(function(){let t,i=this.options.callbacks.onDragEnter(n);return t=Promise.prototype.isPrototypeOf(i)?i:new e((function(e){e(i)})),t}).bind(this)().then(function(e){switch(e){case this.dndOverlayTypes.overItems:let e=0;for(;e<this.dndItemOverlays.length;e++)this.dndItemOverlays[e].show();break;case this.dndOverlayTypes.overFullPage:this.dndFullPageOverlay.show();break;case this.dndOverlayTypes.forbidden:this.dndForbiddenOverlay.show()}}.bind(this))}else this.dndFullPageOverlay.show()},t.prototype.onDragLeave=function(e,t){this.hideOverlayToken=setTimeout(function(){t.stopPropagation(),this.hideDnDOverlay()}.bind(this),300)},t.prototype.onDragOver=function(e,t){clearTimeout(this.hideOverlayToken),this.hideOverlayToken=void 0,t.stopPropagation(),t.preventDefault()},t.prototype.onDrop=function(e,t){t.preventDefault(),this.hideDnDOverlay()},t.prototype.hideDnDOverlay=function(){for(var e=0;e<this.dndItemOverlays.length;e++)this.dndItemOverlays[e].hide();this.dndFullPageOverlay.hide(),this.dndForbiddenOverlay.hide()},t.prototype._initViewerDDEventListeners=function(e){e&&e.viewer&&(e.__eventsCB__={},e.__eventsCB__.onDropCB=this.onDrop.bind(this,e),e.__eventsCB__.onDragEnterCB=this.onDragEnter.bind(this,e),e.__eventsCB__.onDragLeaveCB=this.onDragLeave.bind(this,e),e.__eventsCB__.onDragOverCB=this.onDragOver.bind(this,e),e.viewer.addEventListener("dragenter",e.__eventsCB__.onDragEnterCB,!1),e.viewer.addEventListener("dragleave",e.__eventsCB__.onDragLeaveCB,!1),e.viewer.addEventListener("dragover",e.__eventsCB__.onDragOverCB,!1),e.viewer.addEventListener("drop",e.__eventsCB__.onDropCB,!1))},t.prototype._removeViewerDDEventListeners=function(e){e&&e.viewer&&e.__eventsCB__&&(e.viewer.removeEventListener("dragenter",e.__eventsCB__.onDragEnterCB,!1),e.viewer.removeEventListener("dragleave",e.__eventsCB__.onDragLeaveCB,!1),e.viewer.removeEventListener("dragover",e.__eventsCB__.onDragOverCB,!1),e.viewer.removeEventListener("drop",e.__eventsCB__.onDropCB,!1))},t})),define("DS/XAppUXComponents/XAppNotificationsManager",["UWA/Core","DS/Notifications/NotificationsManagerViewOnScreen","DS/Notifications/NotificationsManagerUXMessages","DS/UIKIT/Alert","css!DS/XAppUXComponents/assets/css/XAppNotificationsManager"],(function(e,t,n,i){"use strict";var o=function(){this.notifManager=null,this.alertElement=null};return o.prototype.initialize=function(){},o.prototype.displayNotifications=function(o,s){var r=[];return s&&s.notExclusive||this.clearNotifications("","",s),s&&!0===s.bUiKit?(null===this.alertElement&&(this.alertElement=new i(e.extend(e.clone({closable:!0,visible:!0,autoHide:!0,hideDelay:8e3,className:"xapp-alert"}),s.options))),this.alertElement&&(s.dialogElement&&this.alertElement.inject(s.dialogElement),o&&Array.isArray(o)&&o.forEach(function(e){if(e&&"string"==typeof e.message){var t=e.message.replace(/\.\n/g,". ").replace(/!\n/g,"! ").replace(/\?\n/g,"? ").replace(/\n/g,". ");this.alertElement.add({className:e.level,message:t})}}.bind(this)))):(null===this.notifManager&&(this.notifManager=n,t.setNotificationManager(this.notifManager)),o&&Array.isArray(o)&&o.forEach(function(e){var t=this.notifManager.addNotif({level:e.level,title:e.title,subtitle:e.subtitle,message:e.message,action:e.action,sticky:e.sticky});r.push(t)}.bind(this))),r},o.prototype.clearNotifications=function(e,n,i){i&&!0===i.bUiKit?this.alertElement&&(this.alertElement.destroy(),this.alertElement=null):t.removeNotifications(e,n)},o.prototype.clean=function(){},o.prototype.destroy=function(){},o})),define("DS/XAppUXComponents/XAppNotificationMask",["UWA/Core","DS/UIKIT/Spinner","css!DS/UIKIT/UIKIT","css!DS/XAppUXComponents/assets/css/XAppNotificationMask"],(function(e,t){"use strict";var n=function(){};return n.prototype.mask=function(n,i){var o,s=i||document.body;this.isMasked(s)&&this.unmask(s),s.addClassName("xapp-masked"),o=e.createElement("div",{class:"xapp-mask"}),n&&e.createElement("div",{class:"xapp-mask-wrapper",html:{tag:"div",class:"xapp-mask-content",html:["string"==typeof n.iconClassName?"spinner"===n.iconClassName?new t({visible:!0,animate:!0,spin:!0}):{tag:"span",class:n.iconClassName}:void 0,{tag:"span",class:"string"==typeof n.description?"text":"",html:n.description},n.action?{tag:"div",html:{tag:"div",class:"btn btn-default xapp-mask-content-btn",text:n.action.label,events:{click:n.action.callback}}}:void 0]}}).inject(o),o.inject(s)},n.prototype.unmask=function(e){var t=e||document.body,n=t.getElement(" > .xapp-mask");n&&n.destroy(),t.removeClassName("xapp-masked")},n.prototype.isMasked=function(e){return(e||document.body).hasClassName("xapp-masked")},n})),define("DS/XAppUXComponents/XAppProgressBar",["UWA/Core","DS/Controls/Loader","i18n!DS/XAppUXComponents/assets/nls/XAppProgressBarMessages","DS/Controls/Button","DS/CoreEvents/Events","DS/VisuEvents/EventsManager","DS/Controls/TooltipModel","css!XAppUXComponents/XAppProgressBar"],(function(e,t,n,i,o,s,r,a){"use strict";var l,p=null,c=0,d=0,h=!1;let u=0;var g,v=new Map,m=null,f=new e.Element("div",{id:"loader_background_div",class:"loader_background"});f.hide(),f.inject(document.body);var _=new e.Element("div",{class:"loader_container"});let C=e.createElement("div").addClassName("swx-progressbar-text");C.inject(_),_.inject(f);var y=new t({text:""});y.elements.container.classList.add("xapp-progressbar-spinner"),y.elements.progressBar.shape="linear",y.inject(_),y.elements.progressBar.statusFlag=!1,y.elements.progressBar.displayStyle="lite",y._modelEvents.subscribe({event:"START"},(function(){if(h||f.show(),y.elements.progressBar.visibleFlag&&(o.publish({event:"loaderSTART"}),l)){let e=l.getComponent("SWXWebAppHealthComponent");e&&this.elements&&this.elements.label&&this.elements.label.textContent&&e.logClientEventLocally("onStart","Spinner",this.elements.label.textContent)}})),y._modelEvents.subscribe({event:"END"},f.hide.bind(f)),y._modelEvents.subscribe({event:"END"},(function(){if(y.elements.progressBar.visibleFlag&&(o.publish({event:"loaderEND"}),l)){let e=l.getComponent("SWXWebAppHealthComponent");e&&this.elements&&this.elements.label&&this.elements.label.textContent&&e.logClientEventLocally("onEnd","Spinner",this.elements.label.textContent)}}));var b=new i({label:n.get("cancel"),displayStyle:"lite",showLabelFlag:!1,icon:{iconName:"close wux-ui-3ds",fontIconFamily:WUXManagedFontIcons.Font3DS}});function D(e){if(l){var t=l.getComponent("SWXWAfrFeatureSetComponent");t&&t.setIsProgressBlockerVisible(e)}}b.elements.container.classList.add("xapp-progressbar-cancelbtn"),b.getContent().setAttribute("qaaid","spinnerCancel"),b.hide(),b.inject(_);const S=e=>{if(e&&e.gesture){let t=v.get(e.gesture.name);if(t){t.callbacks.forEach((n=>{n.cb&&n.cb.call(t,e)}));let n=E();if(n){let e=n.canvas.style.cursor;f.style.cursor=e}}}};function B(){if(! --c){d&&clearTimeout(d),p&&(p.disconnect(),p=null);let t=document.querySelector(".xapp-waitingbar-top-container");t&&t.removeClassName("xapp-progressbar-closed_by_blockingbar"),D(!1),y.off(),b.hide(),v.forEach(((e,t)=>{s.removeEvent(f,`on${t}`,S)})),v.clear();let n=E();n&&n.currentViewpoint&&n.currentViewpoint.removeDivToManipulation(f);let i=document.querySelector(".wux-notification-screen");if(i&&i.setStyle("z-index","1000"),m&&l){var e=l.getComponent(WAfrStandardComponentKey.UIFrame);if(e){let t=e.getImmersiveFrame();t&&(t.removeEventListener("freeZoneResize",m),m=null)}}}c<0&&(console.warn("XAppProgressBar::hide() Called hide() too many times."),c=0),y.incremental=!1,y.elements.progressBar.statusFlag=!1,y.elements.progressBar.infiniteFlag=!0,y.elements.progressBar.displayStyle="lite"}function w(){c=1,h=!1,B()}var x;function A(e,t=null){if(y&&y.incremental)if(x&&clearInterval(x),t){let n=t.valSrc;y.update(`${n}%`),x=setInterval((function(){y.update(`${n}%`),n+=t.incr||5,n>=e&&(y.update(`${e}%`),clearInterval(x))}),t.interval||1e3)}else y.update(e?`${e}%`:void 0)}function k(e){function t(){u--,0===u?(h=!1,_.style.display="",c?c>0&&f.show():b.hide()):D(!0)}return h=!0,D(!1),_.style.display="none",f.hide(),u++,e.then(t,t),e}function E(){if(l){var e=l.getComponent("Viewer");if(e)return e.get3DViewer()}}function T(){let e=function(){var e={left:0,right:0,top:0,bottom:0};if(l){var t=l.getComponent(WAfrStandardComponentKey.UIFrame);if(t){let o=t.getImmersiveFrame();if(o){var n=o.getFreeZone();if(n){var i=n.getOffsets?n.getOffsets():{x:0,y:0};e={left:i.x,right:i.x+n.offsetWidth,top:i.y,bottom:i.y+n.offsetHeight}}}}}return e}(),t=e.top+3,n=e.left+(e.right-e.left)/2-_.offsetWidth/2,i=t+_.offsetHeight/2,o=[n,e.left+(e.right-e.left)/2,e.left+(e.right-e.left)/2+_.offsetWidth/2].reduce(((e,t)=>-1===e?function(e,t){let n=-1,i=E();if(Array.isArray(e)&&i&&i.canvas){let o=e.findIndex((e=>e===_)),s=e.findIndex((e=>e===i.canvas));o=o<0?0:o;let r=-1;if(s>-1&&o<s&&Array.isArray(t)&&t.length>0)for(let n=o+1;n<s;n++)e[n]&&e[n].className&&e[n].className.includes&&t.some((t=>e[n].className.includes(t)))&&(r=n);if(r>-1){let t=e[r].getBoundingClientRect();t&&t.bottom>0&&(n=t.bottom+3)}}return n}(document.elementsFromPoint(t,i),["modebar","sketchbar"]):e),-1);if(t=o>=0?o:t,n+_.offsetWidth>e.right){let t=n+_.offsetWidth-e.right;n=n-t>0?n-t:0}return{top:t,left:n}}const F=()=>{let e=document.querySelector(".wux-notification-screen");e&&e.setStyle("z-index","99999");let t=E();if(t&&t.currentViewpoint&&t.canvas&&0===v.size){t.currentViewpoint.addDivToManipulation(f);let e=s.getGestureRecognizers();if(Array.isArray(e)){e.filter((e=>e.view.includes(t.canvas))).forEach((e=>{v.set(e.name,e),s.addEvent(f,`on${e.name}`,S)}))}}};var P=async function(e,t,i){y.elements.progressBar.shape="linear",!g&&l&&(g=function(e,t,n){let i=null,o=e.getComponent("AFR_ModelEvents");return o&&(i=o.subscribe(t,n)),i}(l,{event:"XApp/CSICommunication/onNodeStatusChange"},(function(e){e&&2===e.status&&w()})));var s=i||{};if(!s.bypassLandingPageCheck&&l&&l&&!0===l.getWelcomeScreenState())return t;let a=e?e.toLowerCase().replace(/[^a-zA-Z ]/g,""):void 0,h=n.get("cancelBtnProcess"),u=h&&a?h.replace(/\{processName\}/g,a):n.get("cancelBtnGeneral");b.tooltipInfos=new r({title:n.get("cancel"),shortHelp:u});let v=e&&i&&i.supplement?`${e} ${i.supplement}`:e;C.innerText=v||n.get("processing"),y.fadeDuration=0,s.onCancel&&(b.onClick=function(){o.publish({event:"loaderCANCEL"}),s.onCancel(),b.hide()},b.show()),y&&y.elements&&y.elements.progressBar&&(y.elements.progressBar.visibleFlag=!s.hideBar),s.hideBar&&b&&b.hide&&b.hide(),s.incremental?(y.incremental=s.incremental,y.elements.progressBar.statusFlag=!0,y.elements.progressBar.displayStyle="normal",A(0)):(y.elements.progressBar.statusFlag=!1,y.elements.progressBar.displayStyle="lite",A());let f=document.querySelector(".xapp-waitingbar-top-container");if(!c){if(s.waitTime)d=setTimeout((function(){D(!0),y.on(),F();let e=T();_.style.top=e.top+"px",_.style.left=e.left+"px",f&&f.addClassName("xapp-progressbar-closed_by_blockingbar")}),s.waitTime);else{D(!0),y.on(),F();let e=T();_.style.top=e.top+"px",_.style.left=e.left+"px",f&&f.addClassName("xapp-progressbar-closed_by_blockingbar")}if(!m&&l){var S=l.getComponent(WAfrStandardComponentKey.UIFrame);if(S){let e=S.getImmersiveFrame();e&&(m=e=>{let t=T();_.style.top=t.top+"px",_.style.left=t.left+"px"},e.addEventListener("freeZoneResize",m))}}}return++c,t&&t.then(B).catch(B),function(){const e="div[class*='wux-controls-loader'][class*='wux-controls-modalContent']";let t=document.querySelector(e);t?t.addClassName("xapp-progressbar-hidden_by_blockingbar"):p||(p=new MutationObserver((t=>{let n=document.querySelector(e);n&&(n.addClassName("xapp-progressbar-hidden_by_blockingbar"),p&&(p.disconnect(),p=null))}))).observe(document,{childList:!0,subtree:!0})}(),t};return{initialize:function(e){l=e},show:P,update:A,hideWhile:k,forceHide:w,isShowing:function(){return c>0},setBackground:function(e){f.removeClassName("transparent"),f.removeClassName("white"),e&&f.addClassName(e)},unsetBackground:function(e){f.removeClassName(e)},hideUntil:function(){let e;return k(new Promise((t=>{e=t}))),e},showUntil:function(e,t){let n,i=new Promise((e=>n=e));return P(e,i,t),n}}})),define("DS/XAppUXComponents/XAppViewerDragAndDropComponent",["UWA/Core","UWA/Promise","DS/XAppUXComponents/XAppDragAndDropManager","css!DS/XAppLandingPage/assets/css/XAppLandingPageCoreV3"],(function(e,t,n){"use strict";var i=function(e){this.options=e};return i.prototype.initialize=function(){this._dragAndDropManager||(this._dragAndDropManager=new n);let e=this.getExecutionContext().getSourceApp();e||(e=this.getExecutionContext().getTargetApp());let t=e?e.getId().toLowerCase():"",i=this.getExecutionContext().getComponent("Viewer");if(i){let e=i.get3DViewer();if(e){let n=function(){let n=this.buildDDOptions({appId:t,viewer:e.elements.container});this._dragAndDropManager.initalize(n)}.bind(this);if(this.resources)n();else{this.resources={},this.loadJsonResources(["i18n!DS/XAppLandingPage/assets/nls/XAppHomePage.json","text!DS/XAppLandingPage/assets/rsc/XAppHomePage.json"]).then(n)}}}},i.prototype.clean=function(){this._dragAndDropManager&&this._dragAndDropManager.clean()},i.prototype.destroy=function(){this.clean(),this._dragAndDropManager&&(this._dragAndDropManager.destroy(),delete this._dragAndDropManager),delete this.resources},i.prototype.buildDDOptions=function(e){return{appId:e.appId,callbacks:{onDrop:this.onDrop.bind(this),onDragEnter:this.onDragEnter.bind(this)},dragAndDrop:!0,icons:{dragAndDrop:this.resources["DragDrop.FontIcon"],forbidden:this.resources["Forbidden.FontIcon"]},overlayContainer:e.viewer,viewer:e.viewer}},i.prototype.loadJsonResources=function(n){return new t(function(t){if(n&&Array.isArray(n)){var i=function(o){o<n.length?require([n[o]],function(t){"object"!=typeof t&&(t=JSON.parse(t)),this.resources=e.extend(e.clone(this.resources),t),i(o+1)}.bind(this)):t()}.bind(this);i(0)}}.bind(this))},i.prototype.onDrop=function(e){if(e.preventDefault(),!this.options.onDrop)return;let t;var n=e.dataTransfer.getData("text");if(n)try{t=JSON.parse(n).data.items[0]}catch(e){}let i={dataParam:t,text:n,files:e.dataTransfer.files,items:e.dataTransfer.items,types:e.dataTransfer.types};this.displaySaveDialog().then(function(t){t&&this.executeAction(this.options.onDrop,e,i)}.bind(this))},i.prototype.displaySaveDialog=function(){return new t(function(e,t){let n=this.getExecutionContext().getComponent("AFR_HandlerComponent");n&&"string"==typeof this.options.closeAction?n.executeHandler({id:this.options.closeAction,args:{callback:e}}):t()}.bind(this))},i.prototype.executeAction=function(e,n,i){return new t(function(t){if(e&&"string"==typeof e){var o=this.getExecutionContext();if(o){var s=o.getComponent(WAfrStandardComponentKey.HandlerComponent);s&&s.executeHandler({id:e,args:{event:n,data:i}}).then(t.bind(this))}}else t()}.bind(this))},i.prototype.onDragEnter=function(e){return new t(function(t){this.options.onDragEnter&&"string"==typeof this.options.onDragEnter?this.executeAction(this.options.onDragEnter,e).then(t.bind(null)):t(this._dragAndDropManager.dndOverlayTypes.overFullPage)}.bind(this))},i})),define("DS/XAppUXComponents/XAppWaitingBar",["UWA/Core","DS/Controls/Button","DS/Controls/ProgressBar","DS/XAppUXComponents/XAppProgressBar","i18n!DS/XAppUXComponents/assets/nls/XAppWaitingBar.json","css!DS/XAppUXComponents/assets/css/XAppWaitingBar.css"],(function(e,t,n,i,o){"use strict";let s=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};var r=function(){this._initialized=!1,this._isShown=!1,this._waitingBarZIndex=-1};r.prototype.initialize=function(){if(!this._initialized){let e=this.getExecutionContext();e&&(i.initialize(e),this._uiFrameComponent=e.getComponent(WAfrStandardComponentKey.UIFrame),a.call(this),l.call(this),this._initialized=!0,this._eventsComponent=e.getComponent(WAfrStandardComponentKey.ModelEvents),this._eventsComponent&&this._eventsComponent.publish({event:"XApp/WaitingBar/onInitialized"}))}},r.prototype.clean=function(){this.end()},r.prototype.destroy=function(){this._topContainerDiv&&(this._topContainerDiv.destroy(),this._topContainerDiv=null),this._initialized=!1},r.prototype.isInitialized=function(){return this._initialized},r.prototype.isShown=function(){return this._isShown},r.prototype.setStepNumber=function(e,t){let n=!1;this._indexNumberDiv&&(t&&void 0!==e||!t&&e>0)&&(this._indexNumberDiv.setText(e.toString()),n=!0),this._totalNumberDiv&&t>0&&(this._totalNumberDiv.setText(" / "+t.toString()),n=!0),this._numberContainerDiv.isHidden()&&n&&this._numberContainerDiv.show()},r.prototype.setIcon=function(e){this._iconContainerDiv&&(this._icon&&this._iconContainerDiv.removeClassName(this._icon),e&&(this._iconContainerDiv.addClassName(e),this._iconContainerDiv.show()),this._icon=e)},r.prototype.getIcon=function(){return this._icon},r.prototype.setTitle=function(e){this._titleDiv&&this._titleDiv.setHTML(s(e))},r.prototype.getTitle=function(){var e="";return this._titleDiv&&(e=this._titleDiv.getHTML()),e},r.prototype.setTitleSupplement=function(e){this._titleSupplementDiv&&(this._titleSupplementDiv.setHTML(s(e)),this._titleSupplementDiv.show())},r.prototype.setAdditionalInfo=function(e){this._additionalInfoDiv&&this._additionalInfoDiv.setHTML(e)},r.prototype.addAdditionalInfoColor=function(e){this._additionalInfoDiv&&this._additionalInfoDiv.addClassName(e)},r.prototype.removeAdditionalInfoColor=function(e){this._additionalInfoDiv&&this._additionalInfoDiv.removeClassName(e)},r.prototype.setStopButtonVisibleFlag=function(e){this._stopButton&&(this._stopButton.visibleFlag=e)},r.prototype.setPauseButtonVisibleFlag=function(e){this._pauseButton&&(this._pauseButton.visibleFlag=e)},r.prototype.setPlayButtonVisibleFlag=function(e){this._playButton&&(this._playButton.visibleFlag=e)},r.prototype.setProgressBarVisibleFlag=function(e){this._progressbarContainerDiv&&this._progressbarContainerDiv[e?"show":"hide"]()},r.prototype.setProgressBarValue=function(e){this._progressBar&&(this._progressBar.infiniteFlag&&(this._progressBar.infiniteFlag=!1),this._progressBar.value=e)},r.prototype.setProgressBarDisabled=function(e){this._progressBar&&(this._progressBar.disabled=e)},r.prototype.setProgressBarStatusFlag=function(e){this._progressBar&&(this._progressBar.statusFlag=e)},r.prototype.setProgressBarInfiniteFlag=function(e){this._progressBar&&(this._progressBar.infiniteFlag=e)},r.prototype.setProgressBarEmphasize=function(e){this._progressBar&&(this._progressBar.emphasize=e)},r.prototype.setDoNotHide=function(){this._bDoNotHide=!0},r.prototype.unsetDoNotHide=function(){this._bDoNotHide=!1},r.prototype.setCustomClassName=function(e){this._topContainerDiv&&(e?this._topContainerDiv.setAttribute("data-custom-class",e):this._topContainerDiv.removeAttribute("data-custom-class"))},r.prototype.start=function(e){p.call(this,e),c.call(this,e),d.call(this,e),this.show(e)},r.prototype.end=function(){!0!==this._bDoNotHide&&(this.hide(),this.reset())},r.prototype.show=function(e){var t=500;e&&(this._onStopButtonClick=e.onStopButtonClick,this._onPauseButtonClick=e.onPauseButtonClick,this._onPlayButtonClick=e.onPlayButtonClick,t=e.delayBeforeShow),this._isShown||(clearTimeout(this._showTimeoutToken),this._showTimeoutToken=setTimeout(function(){this._isShown=!0,this._eventsComponent&&this._eventsComponent.publish({event:"XApp/WaitingBar/onShow"}),this._topContainerDiv.removeClassName("closed"),this._topContainerDiv.addClassName("isVisible"),this.bringToFront()}.bind(this),t))},r.prototype.hide=function(){clearTimeout(this._showTimeoutToken),this._isShown&&(this._isShown=!1,this._eventsComponent&&this._eventsComponent.publish({event:"XApp/WaitingBar/onHide"}),this._topContainerDiv.removeClassName("isVisible"),this._topContainerDiv.addClassName("closed"))},r.prototype.bringToFront=function(){var e=-1;if(this._uiFrameComponent){var t=this._uiFrameComponent.getImmersiveFrame();if(t){var n=t.windows;if(n)for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];if(o){var s=o.getZIndex();e<s&&(e=s)}}}e>=this._waitingBarZIndex&&(this._waitingBarZIndex=e+1,this._topContainerDiv.setStyle("z-index",this._waitingBarZIndex))}},r.prototype.reset=function(){this._numberContainerDiv&&this._numberContainerDiv.hide(),this._indexNumberDiv&&(this._indexNumberDiv.setText(""),this._indexNumberDiv.show()),this._totalNumberDiv&&(this._totalNumberDiv.setText(""),this._totalNumberDiv.show()),this._iconContainerDiv&&(this._iconContainerDiv.removeClassName(this._icon),this._iconContainerDiv.hide()),this._infosContainerDiv&&this._infosContainerDiv.show(),this._titleContainerDiv&&this._titleContainerDiv.show(),this._titleDiv&&this._titleDiv.show(),this._titleSupplementDiv&&this._titleSupplementDiv.hide(),this._additionalInfoDiv&&this._additionalInfoDiv.show(),this._buttonsContainerDiv&&this._buttonsContainerDiv.show(),this.setStopButtonVisibleFlag(!0),this.setPauseButtonVisibleFlag(!1),this.setPlayButtonVisibleFlag(!1),this.setProgressBarVisibleFlag(!0),this.setProgressBarValue(0),this.setProgressBarInfiniteFlag(!1),this.setProgressBarStatusFlag(!0),this.setCustomClassName(null)};var a=function(){var t=this._uiFrameComponent?this._uiFrameComponent.getUIFrame():null;t&&(this._topContainerDiv=e.createElement("div",{class:"xapp-waitingbar-top-container closed"}).inject(t),this._mainContainerDiv=e.createElement("div",{class:"xapp-waitingbar-main-container"}).inject(this._topContainerDiv),this._numberContainerDiv=e.createElement("div",{class:"xapp-waitingbar-info-container xapp-waitingbar-number"}).inject(this._mainContainerDiv),this._indexNumberDiv=e.createElement("div",{class:"xapp-waitingbar-text black inline"}).inject(this._numberContainerDiv),this._totalNumberDiv=e.createElement("div",{class:"xapp-waitingbar-text inline"}).inject(this._numberContainerDiv),this._iconContainerDiv=e.createElement("div",{class:"xapp-waitingbar-info-container xapp-waitingbar-icon"}).inject(this._mainContainerDiv),this._iconContainerDiv.hide(),this._infosContainerDiv=e.createElement("div",{class:"xapp-waitingbar-info-container xapp-waitingbar-title"}).inject(this._mainContainerDiv),this._titleContainerDiv=e.createElement("div",{class:"xapp-waitingbar-title-container"}).inject(this._infosContainerDiv),this._titleDiv=e.createElement("div",{class:"xapp-waitingbar-text black inline"}).inject(this._titleContainerDiv),this._titleSupplementDiv=e.createElement("div",{class:"xapp-waitingbar-text black italic inline"}).inject(this._titleContainerDiv),this._titleSupplementDiv.hide(),this._additionalInfoDiv=e.createElement("div",{class:"xapp-waitingbar-text"}).inject(this._infosContainerDiv),this._progressbarContainerDiv=e.createElement("div",{class:"xapp-waitingbar-progress-container"}).inject(this._mainContainerDiv),this._buttonsContainerDiv=e.createElement("div",{class:"xapp-waitingbar-buttons-container"}).inject(this._mainContainerDiv),this._progressBar=new n({value:0,displayStyle:"lite"}).inject(this._progressbarContainerDiv))},l=function(){this._uiFrameComponent&&(this._stopButton=new t({label:"",displayStyle:"icon",icon:{iconName:"stop",fontIconFamily:WUXManagedFontIcons.Font3DS},onClick:function(){"function"==typeof this._onStopButtonClick&&this._onStopButtonClick()}.bind(this)}).inject(this._buttonsContainerDiv),this._stopButton.getContent().title=o.get("WaitingBar.Stop"),this._pauseButton=new t({label:"",displayStyle:"icon",icon:{iconName:"pause",fontIconFamily:WUXManagedFontIcons.Font3DS},onClick:function(){"function"==typeof this._onPauseButtonClick&&this._onPauseButtonClick()}.bind(this)}).inject(this._buttonsContainerDiv),this._playButton=new t({label:"",displayStyle:"icon",icon:{iconName:"play",fontIconFamily:WUXManagedFontIcons.Font3DS},onClick:function(){"function"==typeof this._onPlayButtonClick&&this._onPlayButtonClick()}.bind(this)}).inject(this._buttonsContainerDiv))},p=function(e){e&&("number"==typeof e.indexNumber||"number"==typeof e.totalNumber?this.setStepNumber(e.indexNumber,e.totalNumber):this._numberContainerDiv&&this._numberContainerDiv.hide(),"string"==typeof e.icon&&this.setIcon(e.icon),"string"==typeof e.title||"string"==typeof e.titleSupplement||"string"==typeof e.additionalInfo?("string"==typeof e.title||"string"==typeof e.titleSupplement?("string"==typeof e.title?this.setTitle(e.title):this._titleDiv&&this._titleDiv.hide(),"string"==typeof e.titleSupplement?this.setTitleSupplement(e.titleSupplement):this._titleSupplementDiv&&this._titleSupplementDiv.hide()):this._titleContainerDiv&&this._titleContainerDiv.hide(),"string"==typeof e.additionalInfo?this.setAdditionalInfo(e.additionalInfo):this._additionalInfoDiv&&this._additionalInfoDiv.hide()):this._infosContainerDiv&&this._infosContainerDiv.hide())},c=function(e){var t=!(!e||"boolean"!=typeof e.stopButtonVisibleFlag)&&e.stopButtonVisibleFlag;this.setStopButtonVisibleFlag(t);var n=!(!e||"boolean"!=typeof e.pauseButtonVisibleFlag)&&e.pauseButtonVisibleFlag;this.setPauseButtonVisibleFlag(!1);var i=!(!e||"boolean"!=typeof e.playButtonVisibleFlag)&&e.playButtonVisibleFlag;this.setPlayButtonVisibleFlag(i),!1===i&&!1===n&&!1===t&&this._buttonsContainerDiv&&this._buttonsContainerDiv.hide()},d=function(e){e&&("number"==typeof e.progressValue&&this.setProgressBarValue(e.progressValue),"boolean"==typeof e.progressDisabled&&this.setProgressBarDisabled(e.progressDisabled),"string"==typeof e.progressEmphasize&&this.setProgressBarEmphasize(e.progressEmphasize),"boolean"==typeof e.statusFlag&&this.setProgressBarStatusFlag(e.statusFlag)),this.setProgressBarInfiniteFlag(!e||"boolean"!=typeof e.progressInfiniteFlag||e.progressInfiniteFlag)};return r}));