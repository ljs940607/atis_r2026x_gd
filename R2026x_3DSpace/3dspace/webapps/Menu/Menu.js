define("DS/Menu/Menu",["DS/Core/PointerEvents","DS/Utilities/TouchUtils","DS/Utilities/Dom","DS/Utilities/Utils","DS/Utilities/KeyboardUtils"],(function(t,e,i,n,o,s){"use strict";var u=document.createElement("div");u.innerHTML=['<div class="wux-menu">','<div class="wux-menu-parent">','<div class="wux-menu-parent-up wux-menu-push wux-ui-3ds wux-ui-3ds-chevron-left"></div>','<div class="wux-menu-parent-title"></div>',"</div>",'<div class="wux-menu-scroll-up wux-ui-3ds wux-ui-3ds-chevron-up wux-menu-scroll-disabled"></div>','<div class="wux-menu-scrollable">','<div class="wux-menu-container">','<div class="wux-menu-column wux-menu-column-left"></div>','<div class="wux-menu-column wux-menu-column-icon"></div>','<div class="wux-menu-column wux-menu-column-title"></div>','<div class="wux-menu-column wux-menu-column-accelerator"></div>','<div class="wux-menu-column wux-menu-column-submenu"></div>',"</div>","</div>",'<div class="wux-menu-scroll-down wux-ui-3ds wux-ui-3ds-chevron-down"></div>',"</div>",'<div class="wux-menu-cell"></div>','<div class="wux-menu-overlap"></div>','<div class="wux-menu-overlap-submenu"></div>','<div class="wux-menu-collection-item"></div>'].join("");var a=u.querySelector(".wux-menu"),r=u.querySelector(".wux-menu-cell"),c=u.querySelector(".wux-menu-overlap"),l=u.querySelector(".wux-menu-collection-item"),d={},h=[],m=-1,f=-1,p=-1,w=-1,v=void 0,g=void 0,b=-1,x=-1,y=0,_=0,E=0,S=!1;const I=2;var L=0,M=[],T=function(t,e){this.content=t,this.menu_uid=e,this.previous_uid=-1,this.next_uid=-1,this.submenu_uid=-1,this.cells=[],this.uid=M.push(this)-1},C=function(t,e,i,n,o){this.parent=t,this.parentTitle=i,this.content=n,this.config=o,this.parent_item_uid=e?e.uid:-1,this.first_uid=-1,this.focus_uid=-1,this.uid=h.push(this)-1,this.loadingSubMenuFromMenuItemUid=void 0};function O(t,e,n){if(t.tooltip)if("string"==typeof t.tooltip){let i={shortHelp:t.tooltip};e.tooltipInfos=i}else"object"==typeof t.tooltip&&(e.tooltipInfos=t.tooltip);else t.title&&n&&(e.tooltipInfos={getAllInformationCB:()=>{if(i.computeStringWidth(t.title,12,"Arial",!1,!1)>n.offsetWidth)return{model:{shortHelp:t.title}}}})}function N(t){var e=M[t].cells,i=e.length>1||e[0].classList.contains("wux-menu-collection-item")||"disabled"===M[t].content.state?e[0]:M[M[t].previous_uid].cells[0],n=e[e.length-1],o=i.getBoundingClientRect(),s=n.getBoundingClientRect(),u=null!==i.previousElementSibling?o.height-i.clientHeight:0,a={};return a.top=o.top-u,a.right=s.right,a.bottom=o.bottom,a.left=o.left,a.width=s.right-o.left,a.height=o.height+u,a}function U(t){return t?t.dataset&&void 0!==t.dataset.wuxMenuUid?Number(t.dataset.wuxMenuUid):U(t.parentNode):-1}function D(t){if(t>=0)return h[M[t].menu_uid]}function R(t,e){if(t<0)return;if(!e)return;const i=M[t];if(!i)return;if(i.submenu_uid>=0&&!h[i.submenu_uid])return;let n={};if(i.submenu_uid<0){const t=h[i.menu_uid];t&&(n=Object.assign({},t.config));const o=new C(t,i,i.content.title,e,n);o.buildView(),i.submenu_uid=o.uid}else h[i.submenu_uid]&&(n=Object.assign({},h[i.submenu_uid].config),h[i.submenu_uid].content=e,h[i.submenu_uid].buildView());n.parentItemRect=N(t),h[i.submenu_uid].show(n)}function A(t){var e=t.target.dataset.wuxMenuItemUid;if(e>=0){var i=D(e);i&&(h[M[e].menu_uid].focus_uid!=e&&i.setHoverState(h[M[e].menu_uid].focus_uid,!1,!1),i.setHoverState(e,!0,!1)),w=e}else w=-1;-1!=(f=U(t.target))&&(p=f)}function k(t){var e=t.target.dataset.wuxMenuItemUid;if(e>=0){var i=D(e);i&&i.setHoverState(e,!1,!1)}}function H(t){t.clientX==b&&t.clientY==x||(b=t.clientX,x=t.clientY,-1==U(t.target)?void 0===g&&(g=window.setTimeout(X,50)):void 0!==g&&(window.clearTimeout(g),g=void 0),void 0!==v&&(window.clearTimeout(v),v=void 0),v=window.setTimeout(W,50))}function F(e){if(e&&e.target&&e.target.dataset){const t=e.target.dataset.wuxMenuItemUid;if(t>=0){const e=D(t);e&&e.view.classList.remove("wux-menu-focus-visible")}}if(t.isTouchEvent(e)&&(A(e),e.target.style.cursor="pointer"),e.touches&&1===e.touches.length){var i=(new Date).getTime(),n=i-y,o=Math.abs(_-e.touches[0].clientX),s=Math.abs(E-e.touches[0].clientY);o<10&&s<10&&n<500&&e.preventDefault(),_=e.touches[0].clientX,E=e.touches[0].clientY,y=i}-1==U(e.target)&&d.hide()}function B(e){if(0===e.button||t.isTouchEvent(e)){var i=e.target.dataset.wuxMenuItemUid;if(i>=0){var o=M[i];if(o)if(-1!=o.submenu_uid){for(var s=m;s!=o.menu_uid&&void 0!==h[s].parent;)h[s].hide(),s=h[s].parent.uid;var u=Object.assign({},h[o.submenu_uid].config);u.parentItemRect=N(i),h[o.submenu_uid].show(u)}else{if("CheckItem"!==o.content.type&&"RadioItem"!==o.content.type&&n.isFunction(o.content.submenu))if(L!==I){if(W(),!o.content.action)return}else{if(n.isAsyncFunction(o.content.submenu)){h[o.menu_uid].loadingSubMenuFromMenuItemUid=o.uid;const t=w;o.content.submenu().then((e=>{if(!e||o.menu_uid<0||!h[o.menu_uid])return;const i=h[o.menu_uid].loadingSubMenuFromMenuItemUid;h[o.menu_uid].loadingSubMenuFromMenuItemUid=void 0,void 0!==i&&o.uid===i&&R(t,e)}))}else if(n.isFunction(o.content.submenu)){const t=o.content.submenu();R(w,t)}if(!o.content.action)return}V(o)}}else e.target.classList.contains("wux-menu-scroll-up")?Y({deltaY:-20,target:e.target}):e.target.classList.contains("wux-menu-scroll-down")?Y({deltaY:20,target:e.target}):e.target.classList.contains("wux-menu-parent-up")&&-1!=m&&h[m].hide();const t=e.target.dataset.wuxDynamicMenuItemUid;if(t>=0){const i=M[t],o={};if(o.info={target:e.target},o.data={event:e,target:e.target,targetPosition:{x:e.offsetX,y:e.offsetY},windowPosition:{x:e.clientX,y:e.clientY}},n.isAsyncFunction(i.content.submenu))i.content.submenu(o).then((e=>R(t,e)));else if(n.isFunction(i.content.submenu)){const e=i.content.submenu(o);R(t,e)}}}}function P(t){-1!=m&&(h[m].onKeyDown(t.keyCode||t.location),o.isMoveKey(t.keyCode)&&(t.preventDefault(),t.stopPropagation()))}function q(t){-1!=m&&o.isMoveKey(t.keyCode)&&(t.preventDefault(),t.stopPropagation())}function j(t){t.stopPropagation(),t.preventDefault()}function V(t){let e;if(t){const i=D(t.uid);i&&i.config&&(e=i.config.doNotHideOnAction)}e||d.hide(!0),t&&t.content&&t.content.action&&(t.content.action.callback?t.content.action.callback.call(t.content.action.this,{context:t.content.action.context}):t.content.action.func&&n.attachSimpleCallback(t.content.action.module,t.content.action.func,t.content.action.argument,t.content.action.context))}function z(t){t&&"resize"===t.type&&t.target.window!==t.target||d.hide()}function Y(t){for(var e=t.target;e&&e.dataset&&void 0===e.dataset.wuxMenuUid;)e=e.parentNode;if(e&&e.dataset){var i=e.dataset.wuxMenuUid;if(i>=0){var n=h[i];if(n&&n.view&&n.view.classList.contains("wux-menu-with-scroll")){var o=n.view.querySelector(".wux-menu-scroll-up"),s=n.view.querySelector(".wux-menu-scrollable"),u=n.view.querySelector(".wux-menu-scroll-down"),a=n.view.querySelector(".wux-menu-container"),r=s.getBoundingClientRect(),c=a.getBoundingClientRect();c.height,r.height;if(t.deltaY>0){var l=c.top-r.top-20;r.height-l>=c.height&&(l=r.height-c.height,u.classList.add("wux-menu-scroll-disabled")),a.style.top=l+"px",o.classList.remove("wux-menu-scroll-disabled")}else{(l=c.top-r.top+20)>=0&&(l=0,o.classList.add("wux-menu-scroll-disabled")),a.style.top=l+"px",u.classList.remove("wux-menu-scroll-disabled")}}}}}function W(){if(v=void 0,f<0){for(var t=p>=0?p:0,e=m;e!=t&&void 0!==h[e].parent;)h[e].hide(),e=h[e].parent.uid;m=t}else if(L!==I){var i=-1;w>=0&&(i=M[w].submenu_uid);for(e=m;e!=f&&e!=i&&void 0!==h[e].parent;)h[e].hide(),e=h[e].parent.uid;const t=w>=0?M[w]:void 0;if(t&&e!=i)if(t.content&&n.isFunction(t.content.submenu)){if("CheckItem"!==t.content.type&&"RadioItem"!==t.content.type)if(n.isAsyncFunction(t.content.submenu)){h[e].loadingSubMenuFromMenuItemUid=t.uid;const n=w;t.content.submenu().then((o=>{if(!o||e<0||!h[e])return;const s=h[e].loadingSubMenuFromMenuItemUid;h[e].loadingSubMenuFromMenuItemUid=void 0,void 0!==s&&t.uid===s&&(R(n,o),i=t.submenu_uid)}))}else if(n.isFunction(t.content.submenu)){const e=t.content.submenu();R(w,e),i=t.submenu_uid}}else if(i>=0){var o=Object.assign({},h[t.submenu_uid].config);o.parentItemRect=N(w),h[i].show(o)}m=i>=0?i:f}}function X(){g=void 0;for(var t=p>=0?p:0,e=m;e!=t&&void 0!==h[e].parent;)h[e].hide(),e=h[e].parent.uid;m=t}function K(t){n.isWindow(t.target)&&!i.firstParentWithClass(t.relatedTarget,"wux-menu",t.target.document.body)&&d.hide()}return C.prototype.buildView=function(){if(this.parent&&!(this.parent instanceof C))throw new Error("Invalid parent, parent must be a Menu instance.");if(this.useTouchInput=e.getTouchMode()||this.config&&this.config.forceTouchMode,!this.content||!this.content.length)throw new Error("Invalid content, menu must contain at least one item.");this.showIcons=!1,this.showTitles=!1,this.showAccelerators=!1,this.showSubMenuSeparators=!1,this.showSubMenus=!1,this.view=a.cloneNode(!0),this.view.dataset.wuxMenuUid=this.uid,this.uid>0&&L===I&&(this.view.classList.add("wux-menu-replace"),this.view.querySelector(".wux-menu-parent-title").textContent=this.parentTitle);var t=this.view.querySelector(".wux-menu-column-left"),o=this.view.querySelector(".wux-menu-column-icon"),s=this.view.querySelector(".wux-menu-column-title"),u=this.view.querySelector(".wux-menu-column-accelerator"),d=this.view.querySelector(".wux-menu-column-submenu"),h=this,m=-1;this.content.forEach((function(e,a,f){!function(t){if(!t||!t.type)throw new Error("Invalid item, 'type' property is mandatory.");if(t.icon&&t.fonticon)throw new Error("Invalid item, 'icon' and 'fonticon' properties cannot be set together.");if(t.icon&&"string"!=typeof t.icon&&(!n.isObject(t.icon)||"string"!=typeof t.icon.iconClasses&&"string"!=typeof t.icon.iconPath&&"string"!=typeof t.icon.iconName))throw new Error("Invalid item, 'icon' property must be a string or an object compliant with an icon definition");if(t.fonticon&&(!n.isObject(t.fonticon)||!t.fonticon.content||"string"!=typeof t.fonticon.content))throw new Error("Invalid item, 'fonticon' property must be an object with a 'content' string property.");if(t.submenu&&(!Array.isArray(t.submenu)||!t.submenu.length)&&!n.isFunction(t.submenu))throw new Error("Invalid item, 'submenu' property must be an non empty array of menu items or a function");if(t.action&&!t.action.callback&&!t.action.func)throw new Error("Invalid item, 'action' property must be defined.");if(t.action&&t.action.callback&&"function"!=typeof t.action.callback)throw new Error("Invalid item, 'action.callback' property must be a function.");if(t.action&&(t.action.func&&"string"!=typeof t.action.func||t.action.module&&"string"!=typeof t.action.module))throw new Error("Invalid item, 'action.func' and 'action.module' properties must be strings.")}(e);var p=!1,w=!1;if(e.state){var v=e.state.toLowerCase().split("|");p=v.indexOf("disabled")>=0,w=v.indexOf("selected")>=0}var g=t.appendChild(r.cloneNode(!0)),b=o.appendChild(r.cloneNode(!0)),x=s.appendChild(r.cloneNode(!0)),y=u.appendChild(r.cloneNode(!0)),_=d.appendChild(r.cloneNode(!0)),E=g.appendChild(c.cloneNode(!0)),S=[g,b,x,y,_];if("SeparatorItem"===e.type||p||"CollectionItem"===e.type||E.setAttribute("tabindex","0"),"SeparatorItem"===e.type)S.forEach((function(t,e,i){t.classList.add("wux-menu-separator")}));else if("TitleItem"===e.type)S.forEach((function(t,e,i){t.classList.add("wux-menu-title"),p&&t.classList.add("wux-menu-disabled")})),e.title&&(E.textContent=e.title),O(e,E,E);else if("PushItem"===e.type){var I;if(p||(L=new T(e,h.uid),-1!=m&&(L.previous_uid=m,M[m].next_uid=L.uid),m=L.uid,E.dataset.wuxMenuItemUid=L.uid,L.cells.push(g,b,x,y)),e.submenu&&!n.isFunction(e.submenu)&&e.action?(I=new T(e,h.uid),-1!=m&&(I.previous_uid=m,M[m].next_uid=I.uid),m=I.uid,_.setAttribute("tabindex","0"),I.cells.push(_),_.dataset.wuxMenuItemUid=I.uid):L&&L.cells.push(_),-1==this.first_uid&&(L||I)&&(this.first_uid=L?L.uid:I.uid),S.forEach((function(t,e,i){t.classList.add("wux-menu-push"),p&&t.classList.add("wux-menu-disabled")})),e.icon)this.showIcons=!0,b.appendChild(i.generateIcon(e.icon));else if(e.fonticon){if(this.showIcons=!0,"&#"===e.fonticon.content.substr(0,2))b.innerHTML=e.fonticon.content;else e.fonticon.content.split(" ").forEach((function(t,e,i){b.classList.add(t)}));e.fonticon.family&&(b.style.fontFamily=e.fonticon.family)}if(e.badge?(this.showTitles=!0,e.badge.inject(x)):e.title&&(this.showTitles=!0,x.textContent=e.title),e.accelerator&&(this.showAccelerators=!0,y.textContent=e.accelerator),e.submenu)if(this.showSubMenus=!0,e.action&&(this.showSubMenuSeparators=!0,E.classList.add("wux-menu-submenu-separator"),_.classList.add("wux-menu-submenu-separator")),_.classList.add("wux-menu-submenu","wux-ui-3ds","wux-ui-3ds-chevron-right"),!n.isFunction(e.submenu))(N=new C(this,I||L,e.title,e.submenu,this.config)).buildView(),I?I.submenu_uid=N.uid:L&&(L.submenu_uid=N.uid);O(e,E,x)}else if("CheckItem"===e.type||"RadioItem"===e.type){var L,N;if(p||(L=new T(e,h.uid),-1!=m&&(L.previous_uid=m,M[m].next_uid=L.uid),m=L.uid,L.cells.push(g,b,x,y),E.dataset.wuxMenuItemUid=L.uid,e.submenu?n.isFunction(e.submenu)?(L.cells.push(_),_.dataset.wuxDynamicMenuItemUid=L.uid):e.action?((I=new T(e,h.uid)).previous_uid=m,M[m].next_uid=I.uid,m=I.uid,I.cells.push(_),_.dataset.wuxMenuItemUid=I.uid):L.cells.push(_):L.cells.push(_),-1==this.first_uid&&(this.first_uid=L.uid)),S.forEach((function(t,i,n){t.classList.add("CheckItem"===e.type?"wux-menu-check":"wux-menu-radio"),p&&t.classList.add("wux-menu-disabled"),w&&t.classList.add("wux-menu-selected")})),e.icon)this.showIcons=!0,b.appendChild(i.generateIcon(e.icon));else if(e.fonticon){if(this.showIcons=!0,"&#"===e.fonticon.content.substr(0,2))b.innerHTML=e.fonticon.content;else e.fonticon.content.split(" ").forEach((function(t,e,i){b.classList.add(t)}));e.fonticon.family&&(b.style.fontFamily=e.fonticon.family)}if(e.title&&(this.showTitles=!0,x.textContent=e.title),e.accelerator&&(this.showAccelerators=!0,y.textContent=e.accelerator),e.submenu)if(this.showSubMenus=!0,e.action&&(this.showSubMenuSeparators=!0,E.classList.add("wux-menu-submenu-separator"),_.classList.add("wux-menu-submenu-separator")),_.classList.add("wux-menu-submenu","wux-ui-3ds","wux-ui-3ds-chevron-right"),!n.isFunction(e.submenu))(N=new C(this,I||L,e.title,e.submenu,this.config)).buildView(),I?I.submenu_uid=N.uid:L&&(L.submenu_uid=N.uid);O(e,E,x)}else{if("CollectionItem"!==e.type)throw new Error("Invalid item, '"+e.type+"' is an unsupported 'type' property.");S.forEach((function(t,e,i){t.classList.add("wux-menu-collection"),p&&t.classList.add("wux-menu-disabled")})),e.items&&e.items.forEach((function(t,e,i){if(t.icon&&t.fonticon)throw new Error("Invalid item, 'icon' and 'fonticon' properties cannot be set together.");if(t.icon&&"string"!=typeof t.icon)throw new Error("Invalid item, 'icon' property must be a string.");if(t.fonticon&&(!n.isObject(t.fonticon)||!t.fonticon.content||"string"!=typeof t.fonticon.content))throw new Error("Invalid item, 'fonticon' property must be an object with a 'content' string property.");if(t.action&&"function"!=typeof t.action.callback)throw new Error("Invalid item, 'action.callback' property must be a function.");var o=!1;t.state&&(o=t.state.toLowerCase().split("|").indexOf("disabled")>=0);var s,u,a=l.cloneNode(!0);if(p||o?a.classList.add("wux-menu-disabled"):a.setAttribute("tabindex","0"),t.icon)a.style.backgroundImage="url("===(s=t.icon).substr(0,4)?s:'url("'+s+'")';else if(t.fonticon){if("&#"===t.fonticon.content.substr(0,2))a.innerHTML=t.fonticon.content;else t.fonticon.content.split(" ").forEach((function(t,e,i){a.classList.add(t)}));t.fonticon.family&&(a.style.fontFamily=t.fonticon.family)}O(t,a),p||o||(u=new T(t,h.uid),-1!=m&&(u.previous_uid=m,M[m].next_uid=u.uid),m=u.uid,u.cells.push(a),a.dataset.wuxMenuItemUid=u.uid,-1==this.first_uid&&(this.first_uid=u.uid)),this.appendChild(a)}),E)}}),this),-1!=this.first_uid&&(M[this.first_uid].previous_uid=m,M[m].next_uid=this.first_uid),this.useTouchInput?this.view.classList.add("wux-menu-touch"):this.view.classList.add("wux-menu-mouse"),this.showIcons||o.parentNode.removeChild(o),this.showTitles||s.parentNode.removeChild(s),this.showAccelerators||u.parentNode.removeChild(u),this.showSubMenus||d.parentNode.removeChild(d),this.showIcons||s.classList.add("wux-menu-column-left-margin"),(this.showAccelerators||!this.showSubMenus||this.showSubMenuSeparators)&&(this.showTitles?s.classList.add("wux-menu-column-right-margin"):o.classList.add("wux-menu-column-right-margin")),!this.showAccelerators||this.showSubMenus&&!this.showSubMenuSeparators||u.classList.add("wux-menu-column-right-margin")},C.prototype.updateSize=function(){const t=320,e=this.config&&this.config.targetDocument||document;let i=!0;if(this.view){let s;if(this.config&&this.config._size&&void 0!==this.config._size.width)s=this.config._size.width+28;else if(s=this.view.getBoundingClientRect().width,s<90||s>t){const e=this.view.querySelector(".wux-menu-column-title");if(e){let i=e.getBoundingClientRect().width;i+=s>t?t-s:90-s,e.style.width=i+"px",s=this.view.getBoundingClientRect().width}}for(var n=this.view.querySelectorAll(".wux-menu-overlap"),o=0;o<n.length;o++)if(n[o].classList.contains("wux-menu-submenu-separator")){const t=this.view.querySelector(".wux-menu-column-submenu"),e=t?t.getBoundingClientRect().width:0;n[o].style.width=s-e+"px"}else n[o].style.width=s+"px";const u=this.view.querySelectorAll(".wux-menu-column"),a=this.view.querySelectorAll(".wux-menu-collection .wux-menu-overlap");for(let t=0;t<a.length;t++){const e=Array.prototype.indexOf.call(a[t].parentNode.parentNode.children,a[t].parentNode),i=a[t].getBoundingClientRect().height;for(let t=0;t<u.length;t++)u[t].children[e].style.height=i+"px"}let r=e.documentElement.clientWidth;this.config&&this.config.display&&(this.config.display.paddingLeft&&(r-=this.config.display.paddingLeft),this.config.display.paddingRight&&(r-=this.config.display.paddingRight)),s+t>r&&(i=!1)}return i},C.prototype.setFirstMenuElementState=function(){if(this.first_uid>=0&&this.first_uid<M.length){this.focus_uid=this.first_uid,this.parent&&this.parent_item_uid>=0&&this.parent.setHoverState(this.parent_item_uid,!0,!1);M[this.first_uid].cells;this.setHoverState(this.focus_uid,!0,!0)}},C.prototype.setHoverState=function(t,e,i){if(this.focus_uid>=0&&this.focus_uid<M.length){const t=M[this.focus_uid].cells;for(const e of t)e.classList.remove("wux-menu-hover")}if(t>=0&&t<M.length){e&&(this.focus_uid=t,this.parent&&this.parent_item_uid>=0&&this.parent.setHoverState(this.parent_item_uid,!0,!1));const n=M[t].cells;for(const t of n)e?t.classList.add("wux-menu-hover"):t.classList.remove("wux-menu-hover");i&&(n[0].children[0]&&n[0].children[0].classList.contains("wux-menu-overlap")?n[0].children[0].focus():(n[0].classList.contains("wux-menu-submenu-separator")&&n[0].classList.contains("wux-menu-submenu")||n[0].classList.contains("wux-menu-collection-item"))&&n[0].focus())}e||i||this.focus_uid!==t||(this.focus_uid=-1)},C.prototype.makeItemVisible=function(t){if(this.view&&this.view.classList.contains("wux-menu-with-scroll")){var e=N(t),i=this.view.querySelector(".wux-menu-scroll-up"),n=this.view.querySelector(".wux-menu-scrollable"),o=this.view.querySelector(".wux-menu-scroll-down"),s=this.view.querySelector(".wux-menu-container"),u=n.getBoundingClientRect(),a=s.getBoundingClientRect();a.height,u.height;if(e.top<u.top)(r=a.top-e.top)>=0&&(r=0,i.classList.add("wux-menu-scroll-disabled")),s.style.top=r+"px",o.classList.remove("wux-menu-scroll-disabled");else if(e.bottom>u.bottom){var r=a.top-u.top-(e.bottom-u.bottom);u.height-r>=a.height&&(r=u.height-a.height,o.classList.add("wux-menu-scroll-disabled")),s.style.top=r+"px",i.classList.remove("wux-menu-scroll-disabled")}}},C.prototype.onKeyDown=function(t){if(-1==this.first_uid)return;const e=this.view.classList.contains("wux-menu-focus-visible");e||this.view.classList.add("wux-menu-focus-visible");let i=this.focus_uid,n=this.focus_uid,s=!1,u=!1;if(o.validate(t)){if(-1!=this.focus_uid){var a=M[this.focus_uid].submenu_uid;if(-1!=a)(r=Object.assign({},h[a].config)).parentItemRect=N(this.focus_uid),r.openViaKeyboardInteraction=!!e,h[a].show(r),s=!0,u=!0;else V(M[this.focus_uid])}}else if(27==t)this.parent?(this.hide(),n=this.parent.focus_uid,m=this.parent.uid):d.hide();else if(37==t)-1!==M[i].submenu_uid&&1===M[i].cells.length?n=M[i].previous_uid:0===m?s=!0:(this.hide(),n=this.parent.focus_uid,m=this.parent.uid);else if(38==t)n=-1==this.focus_uid?M[this.first_uid].previous_uid:M[this.focus_uid].previous_uid,n===i&&(s=!0);else if(39==t){if(-1!=this.focus_uid){let t=M[this.focus_uid].submenu_uid,e=M[this.focus_uid].content.submenu;var r;if(-1!=t)(r=Object.assign({},h[t].config)).parentItemRect=N(this.focus_uid),r.openViaKeyboardInteraction=!0,h[t].show(r),n=h[t].first_uid,m=t,u=!0,s=!0;else e&&-1===t?(n=M[this.focus_uid].next_uid,s=!1):s=!0}}else 40==t&&(n=-1===this.focus_uid?this.first_uid:M[this.focus_uid].next_uid,n===i&&(s=!0));s||this.setHoverState(i,!1,!1),u?this.focus_uid=i:(this.setHoverState(n,!0,!0),this.makeItemVisible(n),this.focus_uid=n)},C.prototype.show=function(t){let e;if(this.view){const s=t&&t.targetDocument||document,u=this.view,a=n.getElementTranslation(s.body),r=function(t,e){a.length>=2&&(t-=a[0],e-=a[1]),u.style.left=t+"px",u.style.top=e+"px"};let c=0,l=0;const h=s.documentElement.clientWidth,f=s.documentElement.clientHeight;let w=!1;if(this.uid>0&&L===I){w=!0;const t=this.parent.view.getBoundingClientRect();c=t.left,l=t.top}else t&&t.position&&(c=t.position.x,l=t.position.y),t&&t.parentItemRect&&!S&&(c=t.parentItemRect.right,l=t.parentItemRect.top);if(r(c,l),s.body.appendChild(this.view),!this.updateSize()&&0===L&&0===this.uid){L=I;const t=this.config||{};t.submenu="replace",d.show(this.content,t,d._callbacks),e=!0}let v=this.view.getBoundingClientRect();!w&&t&&t.parentItemRect&&S&&(c=t.parentItemRect.left-v.width,l=t.parentItemRect.top,r(c,l),v=this.view.getBoundingClientRect());let g=0,b=0,x=h,y=f;t&&t.display&&(t.display.paddingLeft&&(g=t.display.paddingLeft),t.display.paddingTop&&(b=t.display.paddingTop),t.display.paddingRight&&(x-=t.display.paddingRight),t.display.paddingBottom&&(y-=t.display.paddingBottom));const _=y-b;if(!w&&t&&t.layout)for(var i=t.layout.toLowerCase().split("|"),o=0;o<i.length&&("topleft"===i[o]?r(c,l):"topright"===i[o]?r(c-v.width,l):"bottomleft"===i[o]?r(c,l-v.height):"bottomright"===i[o]&&r(c-v.width,l-v.height),v=this.view.getBoundingClientRect(),!(v.left>=g&&v.right<x&&v.top>=b&&v.bottom<y));o++);if(v.left<g||v.right>=x||v.top<b||v.bottom>=y){let e=v.left,i=v.top;v.right>x&&(L!==I&&t&&t.parentItemRect&&!S&&t.parentItemRect.left-v.width>=g?(e=t.parentItemRect.left-v.width,i=t.parentItemRect.top,S=!0):e=x-v.width),v.bottom>y&&(i=y-v.height),e<g&&(e=g),i<b&&(i=b),r(e,i),v.height>y-i&&(this.view.style.height=_+"px",this.view.classList.add("wux-menu-with-scroll"))}m=this.uid,this.setFirstMenuElementState(),t&&t.openViaKeyboardInteraction&&this.view.classList.add("wux-menu-focus-visible"),w&&(this.parent.view.style.display="none",p=this.uid)}return e},C.prototype.hide=function(){if(this.view&&this.view.parentNode&&(this.view.classList.remove("wux-menu-focus-visible"),this.view.parentNode.removeChild(this.view),this.setHoverState(-1,!1,!1),this.parent&&"none"===this.parent.view.style.display&&(this.parent.view.style.display="",m=this.parent.uid,p=this.parent.uid,this.parent.focus_uid>=0))){var t=N(this.parent.focus_uid);(b<t.left||b>t.right||x<t.top||x>t.bottom)&&this.parent.setHoverState(this.parent.focus_uid,!1,!1)}},d.show=function(e,n,o){window.__karma__&&(d.__currentDisplayedMenuModel=e);const s=n&&n.targetDocument||document,u=s?s.defaultView:null;d.hide(),d._callbacks=o,L=0,n&&"replace"===n.submenu?L=I:n&&"outside"===n.submenu&&(L=1);var a=new C(void 0,void 0,void 0,e,n);if(a.buildView(),!a.show(n))return i.addEventOnElement(this,s,"mouseover",A,!0),i.addEventOnElement(this,s,t.POINTEROUT,k),i.addEventOnElement(this,s,t.POINTERMOVE,H),i.addEventOnElement(this,s,t.POINTERDOWN,F),i.addEventOnElement(this,s,t.POINTERHIT,B),i.addEventOnElement(this,s,"keydown",P,!0),i.addEventOnElement(this,s,"keyup",q,!0),i.addEventOnElement(this,s,"resize",z,!1),i.addEventOnElement(this,s,"contextmenu",j,!1),i.addEventOnElement(this,s,"wheel",Y,!0),u&&i.addEventOnElement(this,u,"blur",K,!0),d._callbacks&&d._callbacks.onShow&&d._callbacks.onShow(),this._onShow(),h&&h.length&&(a._resizeAndScrollEvtsHandler=i.addScrollAndResizeListener(h[0],h[0].view,z)),a.view.getBoundingClientRect()},d.hide=function(e){if(h&&h.length>0){const s=h[0]&&h[0].config&&h[0].config.targetDocument||document,u=s?s.defaultView:null;h[0]&&h[0]._resizeAndScrollEvtsHandler&&(i.removeScrollAndResizeListener(h[0]._resizeAndScrollEvtsHandler),delete h[0]._resizeAndScrollEvtsHandler),i.removeEventOnElement(this,s,"mouseover",A,!0),i.removeEventOnElement(this,s,t.POINTEROUT,k),i.removeEventOnElement(this,s,t.POINTERMOVE,H),i.removeEventOnElement(this,s,t.POINTERDOWN,F),i.removeEventOnElement(this,s,t.POINTERHIT,B),i.removeEventOnElement(this,s,"keydown",P,!0),i.removeEventOnElement(this,s,"keyup",q,!0),i.removeEventOnElement(this,s,"resize",z,!1),i.removeEventOnElement(this,s,"contextmenu",j,!1),i.removeEventOnElement(this,s,"wheel",Y,!0),u&&i.removeEventOnElement(this,u,"blur",K,!0),void 0!==v&&(window.clearTimeout(v),v=void 0),void 0!==g&&(window.clearTimeout(g),g=void 0);for(var n=0;n<h.length;n++)if(h[n].view){var o=h[n].view.parentNode;o&&o.removeChild(h[n].view)}h=[],m=-1,f=-1,p=-1,w=-1,M=[],S=!1,d._callbacks&&d._callbacks.onHide&&d._callbacks.onHide(e)}},d._onShow=function(){},d.updateModel=function(t){for(const e of t)for(const t of M)if(t&&t.content&&"CheckItem"===t.content.type&&e.title===t.content.title){t.content.state=e.state;for(const e of t.cells){d.getItemState(t.content)&d.MENU_STATE_SELECTED?e.classList.add("wux-menu-selected"):e.classList.remove("wux-menu-selected")}}},d.MENU_STATE_NONE=0,d.MENU_STATE_SELECTED=1,d.MENU_STATE_DISABLED=2,d.translateStateStringToBitField=t=>{let e=d.MENU_STATE_NONE;const i=t.toLowerCase().split("|");return-1===i.indexOf("unselected")&&i.indexOf("selected")>=0&&(e|=d.MENU_STATE_SELECTED),i.indexOf("disabled")>=0&&(e|=d.MENU_STATE_DISABLED),e},d.translateStateBitFieldToString=t=>{let e=!1,i=!1;return t&d.MENU_STATE_SELECTED&&(e=!0),t&d.MENU_STATE_DISABLED&&(i=!0),`${e?"selected":""}${e&&i?"|":""}${i?"disabled":""}`},d.getItemState=t=>{let e=d.MENU_STATE_NONE;return t&&void 0!==t.state&&null!==t.state&&(e=d.translateStateStringToBitField(t.state)),e},d.setItemState=(t,e)=>{t&&null!=e&&(t.state=d.translateStateBitFieldToString(e))},d.getMenuItemUidFromNode=t=>t&&t.dataset?void 0!==t.dataset.wuxDynamicMenuItemUid&&null!==t.dataset.wuxDynamicMenuItemUid?t.dataset.wuxDynamicMenuItemUid:void 0!==t.dataset.wuxMenuItemUid&&null!==t.dataset.wuxMenuItemUid?t.dataset.wuxMenuItemUid:void 0:-1,d.getMenuDescriptionFromUid=t=>{if(M[t])return M[t].content},d})),define("DS/Menu/ContextualMenu",["DS/Menu/Menu","DS/Core/PointerEvents","DS/Utilities/Utils"],(function(t,e,i){"use strict";var n=void 0,o="mouse",s="auto";function u(t){e.isTouchEvent(t)&&a(t)}function a(e){t.hide();for(var u=[],a=e.target;a;){if(a["wux-data-contextual"])for(var r=a.getBoundingClientRect?a.getBoundingClientRect():{left:0,top:0},c=e.pageX-r.left,l=e.pageY-r.top,d=a["wux-data-contextual"],h=0;h<d.length;h++){var m=d[h].params.callback.call(d[h].params.this,{context:d[h].params.context,info:{position:{x:c,y:l},target:e.target},data:{event:e,listener:a,listenerPosition:{x:c,y:l},target:e.target,targetPosition:{x:e.offsetX,y:e.offsetY},windowPosition:{x:e.clientX,y:e.clientY}}});m&&i.isPromise(m)?u.push(m):m&&m.length>0&&u.push(Promise.resolve(m))}let t=i.getDocumentWindow(a);a=a===t?void 0:a.parentNode?a.parentNode:t}return(u.length>0||!e.target||"input"!==e.target.tagName.toLowerCase()&&"textarea"!==e.target.tagName.toLowerCase()&&!e.target.isContentEditable)&&e.preventDefault(),u&&u.length>0&&(e.actionPerformed=!0,Promise.allSettled(u).then((function(u){var a=[],r=0;if(u&&u.length>0)for(var c=0;c<u.length;c++)u[c].value&&u[c].value.length>0&&(a.length>r&&(a.push({type:"SeparatorItem"}),r=a.length),a=a.concat(u[c].value));if(a&&a.length>0){const u=i.getDocumentOwner(e.target);t.show(a,{display:n,input:o,position:{x:e.pageX,y:e.pageY},submenu:s,targetDocument:u},{onShow:()=>{e.target&&e.target.setAttributeNode(u.createAttribute("is-displaying-menu"))},onHide:t=>{if(e.target){e.target.removeAttribute("is-displaying-menu");for(var i=e.target["wux-data-contextual"],n=0;Array.isArray(i)&&n<i.length;n++)i[n]&&i[n].params&&i[n].params.onHideCB&&i[n].params&&i[n].params.onHideCB(t)}}})}}))),!1}var r={setGlobalConfig:function(t){if(!t)throw new Error("Invalid configuration.");if(t.display&&(n=t.display),t.input){if("mouse"!==t.input&&"touch"!==t.input)throw new Error("Invalid input configuration, expected values are 'mouse' or 'touch'.");o=t.input}if(t.submenu){if("replace"!==t.submenu&&"outside"!==t.submenu&&"auto"!==t.submenu)throw new Error("Invalid submenu configuration, expected values are 'replace', 'outside' or 'auto'.");s=t.submenu}},addEventListener:function(t,n){if(!t||!n)throw new Error("Invalid parameters.");if(t!==i.getDocumentWindow(t)&&!i.isHTMLElement(t))throw new Error("Invalid parameters, 'target' must be the window or an HTMLElement.");if(!n.callback||!i.isFunction(n.callback))throw new Error("Invalid parameters, 'params.callback' must be a function.");var o=t["wux-data-contextual"];return o||((o=[]).next=0,t["wux-data-contextual"]=o,n&&n.noDOMEvents||(t.addEventListener("contextmenu",a),t.addEventListener(e.LONGHOLD,u))),o.push({uid:o.next,params:n}),o.next++}};return r.removeEventListener=function(t,i){if(!t||(n=i,isNaN(parseFloat(n))||!isFinite(n)))throw new Error("Invalid parameters.");var n,o=t["wux-data-contextual"];if(!o)throw new Error("Invalid target.");for(var s=0;s<o.length&&o[s].uid!=i;)s++;if(s>=o.length)throw new Error("Invalid uid.");o.length>1?(o.splice(s,1),o.next=o[o.length-1].uid+1):(t.removeEventListener("contextmenu",a),t.removeEventListener(e.LONGHOLD,u),delete t["wux-data-contextual"])},r.buildAndDisplayContextualMenu=(t,e)=>{const i=new MouseEvent("contextmenu",e);Object.defineProperty(i,"target",{writable:!1,value:t}),a(i)},r}));