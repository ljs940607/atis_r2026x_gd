define("DS/DELWKODicoServices/DELWKOCustoXmlUtils",["UWA/Core"],(function(e){"use strict";return function(){var t=[],i=function(t,i,r){var n,s,o,u=t.split("."),a={},c={},f={},p=function(t,r){var n,s=[];if(!e.is(s[i])){for(n=0;n<r.length;++n){if(!e.is(t[r[n]])){t=null;break}t=t[r[n]]}if(e.is(t))if(s[i]={},"array"===e.typeOf(t))for(n=0;n<t.length;++n)s[i][t[n][i]]=t[n];else"object"===e.typeOf(t)&&(s[i][t[i]]=t)}return s[i]};if(e.is(r))if("array"===e.typeOf(r[u[0]]))for(o=0;o<r[u[0]].length;o++)c=r[u[0]][o],s=t.indexOf("."),n=(n=t.substring(s+1,t.length)).split("."),e.is(c[n],"array")?(a=p(c,n),e.merge(f,a)):f=p(c=r,u);else f=p(c=r,u);return f};return{retrieveAttributesInfoFromXml:function(r){var n,s,o,u,a,c,f,p,y,d=function(i){var r,n,s=["reference","instance"];for(r in n=function(e){var i;i=r.split("."),function(e){var i,r;if(e.dicoType&&e.attribute)if(t.length<=0)t.push({type:e.dicoType,attributes:[e.attribute]});else{for(i=0;i<t.length;i++){if(e.dicoType===t[i].type){-1===t[i].attributes.indexOf(e.attribute)&&t[i].attributes.push(e.attribute),r=!0;break}r=!1}!1===r&&t.push({type:e.dicoType,attributes:[e.attribute]})}}({attribute:s.indexOf(i[i.length-1])>-1?i[i.length-2]:i[i.length-1],dicoType:e})},i)if(Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&i[r].dicoType){const t=i[r].dicoType;e.is(t,"array")?t.forEach((function(e){const t=e.dicoType;n(t)})):n(t)}};if(e.is(r)){if(e.is(r.uiCusto,"array")&&r.uiCusto.forEach((function(t){e.is(t)&&(d(i("Config.Columns.Column","dataIndex",t)),d(i("Config.Label","dataIndex",t)))})),e.is(r.insertFormCusto))for(c in u=r.insertFormCusto,a=i("AttributesDescriptionList.Type","name",u))a.hasOwnProperty(c)&&d(i("Section.Attribute","name",a[c]));if(e.is(r.editFormCusto))for(o in n=r.editFormCusto,s=i("AttributesDescriptionList.Type","name",n))s.hasOwnProperty(o)&&d(i("Attribute","name",s[o]));if(e.is(r.createWorkOrderFromProcessCusto))for(c in u=r.createWorkOrderFromProcessCusto,a=i("AttributesDescriptionList.Type","name",u))a.hasOwnProperty(c)&&d(i("Section.Attribute","name",a[c]));if(e.is(r.graphViewCusto)&&(f=r.graphViewCusto).Config.Preferences.BOMView.Content.Type)for(p=f.Config.Preferences.BOMView.Content.Type,y=0;y<p.length;y++)d(i("Row","dataIndex",p[y]));return t}}}}})),define("DS/DELWKODicoServices/DELWKOAttributeConfigExt",["UWA/Core","DS/DELPPWLoggerModel_FD02/LoggerUtils","DS/DELPPWWebServices_FD02/WebserviceUtils","DS/DELPPWResourceServices_FD02/ResourceUtils","text!DS/DELWKODicoServices/assets/json/DELWKOProperties.json"],(function(e,t,i,r,n){"use strict";return{}})),define("DS/DELWKODicoServices/DELWKODicoUtils",["UWA/Core","UWA/Class","DS/DELPPWWebServices_FD02/WebserviceUtils","DS/DELPPWDicoServices_FD02/ModelConfigExt","DS/DELPPWDicoServices_FD02/AttributeConfigExt","DS/DELPPWResourceServices_FD02/ResourceUtils","DS/DELWKODicoServices/DELWKOCustoXmlUtils","text!DS/DELPPWDicoServices_FD02/assets/json/ReadOnlyTypes.json"],(function(e,t,i,r,n,s,o,u){"use strict";var a=t.singleton(r,n,{name:"DELWKODicoUtils",_modelAttrsJSON:[],_modelTypeConfig:{},_typeHierarchy:{},_readOnlyTypes:null,_acceptedPPRTypesForActions:null,_acceptedBaseTypesForActions:null,_isAutoCreateScopeOnHOP:!1,_typeAttrInfo:{},_typeMaturityInfo:{},_dicoTypesAttributesProperties:[],init:function(t){var i,r,n=this;if(this._readOnlyTypes=new Set(JSON.parse(u)),t=t||{},!e.is(t.modelRelationsXML)||!e.is(t.modelCustomRelationsXML))throw new Error("modelTypesPath or modelRelationsXML or modelCustomRelationsXML options not defined");n.options=t,(i=!!e.is(t.acceptedPPRTypesForActionsFilePath)&&t.acceptedPPRTypesForActionsFilePath)&&require(["text!"+i],(function(t){e.is(t)?n._acceptedPPRTypesForActions=e.is(t,"string")?e.Json.decode(t):t:e.getLogger().debug("Accepted Types for DnD mapping is not defined.")})),(r=!!e.is(t.acceptedBaseTypesForActionsFilePath)&&t.acceptedBaseTypesForActionsFilePath)&&require(["text!"+r],(function(t){e.is(t)?n._acceptedBaseTypesForActions=e.is(t,"string")?e.Json.decode(t):t:e.getLogger().debug("Accepted base types are not defined.")}))},setup:function(t,i){var r=this.options.modelTypesPath||"DS/DELWKODicoServices/assets/json/ModelTypes.json";require(["text!"+r],(function(r){a._modelAttrsJSON=a._retrieveAttributesInfo(),a._modelTypeConfig=e.Json.decode(r),a._initPromiseExec(t,i)}),(function(e){i(e)}))},_retrieveAttributesInfo:function(){var e;return e={uiCusto:[i.getXMLValues("CAPRESOURCE.columnConfigPath"),i.getXMLValues("ROUTINGS.columnConfigPath"),i.getXMLValues("RESOURCE.columnConfigPath"),i.getXMLValues("MANUFACTURING.columnConfigPath"),i.getXMLValues("MBOM.columnConfigPath"),i.getXMLValues("EBOM.columnConfigPath"),i.getXMLValues("ORIGIN.columnConfigPath"),i.getXMLValues("ALTERNATES_AND_SUBSTITUTES.columnConfigPath"),i.getXMLValues("ALTERNATE.columnConfigPath"),i.getXMLValues("RESULTING_PRODUCT_VIEW.columnConfigPath"),i.getXMLValues("AUXILIARY.columnConfigPath")],insertFormCusto:i.getXMLValues("insertFormAttributeXML"),createWorkOrderFromProcessCusto:i.getXMLValues("createWorkOrderFromProcessFormAttributeXML"),editFormCusto:i.getXMLValues("editFormAttributesXML"),graphViewCusto:i.getXMLValues("MBOM.bomViewXML")},(new o).retrieveAttributesInfoFromXml(e)},_retrieveAttrMaskInfoForPPRTypes:function(e,t){var i=["PROCESS","RESOURCE","PRODUCT","PART","SYSTEM","OPERATION","WORKORDER","EXECHEADER"],r=[];i.indexOf("PROCESS")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForProcessTypes.bind(this))),i.indexOf("RESOURCE")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForResourceTypes.bind(this))),i.indexOf("PRODUCT")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForProductTypes.bind(this))),i.indexOf("PART")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForPartTypes.bind(this))),i.indexOf("SYSTEM")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForSystemTypes.bind(this))),i.indexOf("OPERATION")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForOperationTypes.bind(this))),i.indexOf("WORKORDER")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForWorkOrderTypes.bind(this))),i.indexOf("EXECHEADER")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForExecHeaderTypes.bind(this))),Promise.all(r).then((function(){e()}),(function(e){t(e)}))},_retrieveNlsMaturity:function(t,r){var n=this;i.webServiceRequest({url:"dsmfg/V0/WKO/getNLSValuesMaturityState",method:"GET",onComplete:function(i){e.is(i)&&(n.addMaturityInfoType("transition",i.transition),n.addMaturityInfoType("states",i.states)),e.is(t,"function")&&t()},onFailure:r,onTimeout:r})},addMaturityInfoType:function(e,t){this._typeMaturityInfo[e]=t},getStatesNlsFromDico:function(t){var i=void 0,r=this.getMaturityInfoType("states");return e.is(r)&&r.forEach((e=>{e.Name===t&&(i=e.NLS)})),i},getTransitionsNlsFromDico:function(t){var i=void 0,r=this.getMaturityInfoType("transition");return e.is(r)&&r.forEach((e=>{e.Name===t&&(i=e.NLS)})),i},getMaturityInfoType:function(e){return this._typeMaturityInfo[e]},addAttrOfType:function(e,t){this._typeAttrInfo[e]=t},getAttrOfType:function(e){return this._typeAttrInfo[e]},getAttributeOfType:function(t,r,n){var s=this;i.webServiceRequest({url:"dsmfg/private/V0/invoke/getTypesAttributes",method:"GET",data:{payload:JSON.stringify([t]),inherit:!0},onComplete:function(t){e.is(t)&&(t=t.results,Array.isArray(t)&&t.forEach((function(e){var t;t=e.attributes.map((function(e){return e.name})),s.addAttrOfType(e.name,t)}))),e.is(r,"function")&&r()},onFailure:n,onTimeout:n})},_retrieveAttrMaskInfoForWorkOrderTypes:function(e,t){this.getAttributeOfType("WORKORDER",e,t)},_retrieveAttrMaskInfoForExecHeaderTypes:function(e,t){this.getAttributeOfType("EXECHEADER",e,t)},_retrieveExtnInfoForRefTypes:function(e,t){var i=this,r=["PROCESS","PART","SYSTEM","OPERATION","SERVICE","WORKORDER","EXECHEADER"],n=[];this.getReferenceTypes().forEach((function(e){var t=i.getPPRType(e);r.indexOf(t)>-1&&n.push(e)})),this.getExtnInfoOfTypes(n,e,t)},_initPromiseExec:function(e,t){var i=this,r=[new Promise(a._retrieveRefDicoType.bind(i)),new Promise(a._retrieveInstDicoType.bind(i)),new Promise(a._retrieveDocDicoType.bind(i)),new Promise(a._retrieveResourceType.bind(i)),new Promise(a._retrievePPRTypes.bind(i))];Promise.all(r).then((function(){new Promise(a._retrieveModelCustomRelations.bind(i)).then((function(){a._initPromiseExec2(e,t)}),(function(e){t(e)}))}),(function(e){t(e)}))},_initPromiseExec2:function(e,t){var i=this,r=[new Promise(a._retrieveModelCustomRelations.bind(i)),new Promise(a._retrieveModelRelations.bind(i)),new Promise(a._retrieveDicoAttributeInfo.bind(i)),new Promise(a._retrieveAttrMaskInfoForPPRTypes.bind(i)),new Promise(a._retrieveSharedIconPath.bind(i)),new Promise(a._retrieveExtnInfoForClassTypes.bind(i)),new Promise(a._getDicoTypesAttributesIndexMapping.bind(i)),new Promise(a._retrieveNlsMaturity.bind(i))];"ENXENG_AP"!==widget.getValue("appId")&&"DELWKB_AP"!==widget.getValue("appId")&&r.push(new Promise(a._retrieveValidChildTypes.bind(i))),Promise.all(r).then((function(){e()}),(function(e){t(e)}))},_retrieveSharedIconPath:function(t,r){var n=s.getIconNames();e.is(n,"array")&&n.length>0?i.webServiceRequest({url:"dsmfg/private/V0/invoke/getSharedIconPath",method:"POST",data:JSON.stringify(n),onComplete:function(e){s.setSharedIconPath(e),t()},onFailure:r,onTimeout:r}):t()},_retrieveDimensions:function(e,t){i.webServiceRequest({url:"dictionary/dimensions",method:"GET",onComplete:function(t){s.addDimensions(t.results),e()},onFailure:t,onTimeout:t})},_retrieveDicoType:function(t,r,n){var o=this;i.webServiceRequest({url:"dictionary/getTypeInfo?parentInfo=true",method:"POST",data:JSON.stringify(t),onComplete:function(t){r(),Object.keys(t).forEach((function(i){for(var r=[],n=e.is(t[i].parent)?t[i].parent:null;null!==n;)r.push(n),n=e.is(t[n].parent)?t[n].parent:null;r.length>0&&(r.reverse(),-1!==o.getReferenceTypes().indexOf(r[0])?o._modelTypeConfig.reference.types.push(i):-1!==o.getInstanceTypes().indexOf(r[0])&&o._modelTypeConfig.instance.types.push(i),-1!==o.getDocumentTypes().indexOf(r[0])&&o._modelTypeConfig.document.types.push(i),e.is(t[r[0]].derivedTypes,"array")||(t[r[0]].derivedTypes=[]),t[r[0]].derivedTypes.push(i)),t[i].inheritanceChain=r})),s.addIcons(t),o._typeHierarchy=e.merge(o._typeHierarchy,t)},onFailure:n,onTimeout:n})},_retrieveRefDicoType:function(e,t){this._retrieveDicoType(this.getReferenceTypes(),e,t)},_retrieveInstDicoType:function(e,t){this._retrieveDicoType(this.getInstanceTypes(),e,t)},_retrieveDocDicoType:function(e,t){this._retrieveDicoType(this.getDocumentTypes(),e,t)},_retrieveResourceType:function(e,t){var r=this;i.webServiceRequest({url:"dictionary/getTypeInfo",method:"POST",data:JSON.stringify(["Resource"]),onComplete:function(t){var i=Object.keys(t).filter((function(e){return"Resource"!==e}));t.Resource.derivedTypes=i,t.Resource.inheritanceChain=[],r._typeHierarchy.Resource=t.Resource,e()},onFailure:t,onTimeout:t})},_getDicoTypesAttributesIndexMapping:function(t,r){var n=this,s=this._getDicoTypes(),o=function(e){LoggerUtils.error("Failed to retrieve attribute index mapping from server: "+e),r()};e.is(s,"array")&&s.length>0?i.webServiceRequest({url:"dsmfg/private/V0/invoke/getPredicates",method:"POST",data:JSON.stringify(s),onComplete:function(i){e.is(i,"array")&&(n._dicoTypesAttributesProperties=i),t()},onFailure:o,onTimeout:o}):t()},_getDicoTypes:function(){var t=["PLMEntity","PLMInstance"];return function i(r){e.is(r,"object")?Object.keys(r).forEach((function(n){"dicoType"===n&&e.is(r[n],"string")?"BusinessType"===r[n]||t.includes(r[n])||t.push(r[n]):i(r[n])})):e.is(r,"array")&&r.forEach((function(e){i(e)}))}(i._xmlCache),t},getAcceptedPPRTypesForActions:function(){return this._acceptedPPRTypesForActions},getAcceptedBaseTypesForActions:function(){return this._acceptedBaseTypesForActions},getParentTypes:function(t){let i=[];return e.is(this._typeHierarchy[t])&&(i=this._typeHierarchy[t].inheritanceChain||[]),i},getReadOnlyTypes:function(){return this._readOnlyTypes},getTypeHierarchy:function(t){return e.is(this._typeHierarchy[t])&&Array.isArray(this._typeHierarchy[t].derivedTypes)?this._typeHierarchy[t].derivedTypes:[]},getTypeInfo:function(t){var i;return e.is(this._typeHierarchy[t])&&(i=this._typeHierarchy[t]),i},getReferenceTypes:function(){return this._modelTypeConfig.reference.types},getInstanceTypes:function(){return this._modelTypeConfig.instance.types},getDocumentTypes:function(){return this._modelTypeConfig.document.types},getConnectionTypes:function(){return this._modelTypeConfig.connection.types},isEntityReference:function(e){return-1!==this.getReferenceTypes().indexOf(e)},isEntityInstance:function(e){return-1!==this.getInstanceTypes().indexOf(e)},isEntityConnection:function(e){return-1!==this.getConnectionTypes().indexOf(e)},isAKindOf:function(t,i){var r=!1,n=e.is(t)?e.is(t,"string")?t:e.is(t.get,"function")?t.get("type"):null:null,s=e.is(i,"string")&&0<i.length?a.getTypeHierarchy(i):null;return e.is(n,"string")&&e.is(i,"string")&&(i===n?r=!0:Array.isArray(s)&&(r=s.some((function(e){return n===e}),this))),r},getDicoTypeIndexesForAttribute:function(t,i){var r=[],n="";return e.is(this._dicoTypesAttributesProperties,"array")&&this._dicoTypesAttributesProperties.forEach((function(e){if(e.name===t||e.fullName===t)if(e.kind===i)r.push(e.uri);else if("interface"===e.kind){if(e.uri.startsWith("tbr."))switch(i){case"entity":n="bo"+e.uri.substring(3);break;case"relation":n="ro"+e.uri.substring(3);break;default:n=e.uri}else n=e.uri;r.push(n)}}),this),r},getDicoTypeAttributesForIndex:function(t,i){var r=[],n="";return e.is(this._dicoTypesAttributesProperties,"array")&&this._dicoTypesAttributesProperties.forEach((function(e){if(e.uri===t&&e.kind===i)r.push(e.name);else if("interface"===e.kind)if(e.uri.startsWith("tbr.")){switch(i){case"entity":n="bo"+e.uri.substring(3);break;case"relation":n="ro"+e.uri.substring(3);break;default:n=e.uri}n===t&&r.push(e.name)}else e.uri===t&&r.push(e.name)}),this),r},getTypeDicoNLSValue:function(e){return this._typeHierarchy[e].typeNLS}});return a}));