define("DS/DELPPWManageCapableResourcesModule/ManageStepOperationsUsageBaseUI",["UWA/Core","text!DS/DELPPWManageCapableResourcesModule/assets/json/ManageCapableRscTLVOption.json"],(function(e,n){"use strict";var t,a;return function(o,r,i,s,c,u,l,d,p,g){var f,I,m,h,P;return P=e.Json.decode(n),m=function(e){var n=[],t=p.getConnection(e.linkPID),a=o.getBehavior("CapableResourceLinkBehaviour").packConnInfo(t),r=p.getSecondaryResourceLinksInfo(t);return n.push({displayType:"MANAGESTEPOPERATIONSUI",dataIndex:"V_EstimatedTime",dicoType:"DELLmiEstimatedTime",primaryLinkPID:t.get("PID"),entity:"link",isGroupable:!1,isFilterable:!1}),n.push({displayType:"MANAGESTEPOPERATIONSUI",text:a.resourceUsage?a.resourceUsage:a.toName,dataIndex:t.get("PID"),isGroupable:!1,isFilterable:!1}),r.forEach((function(e){n.push({displayType:"MANAGESTEPOPERATIONSUI",text:e.resourceUsage?e.resourceUsage:e.toName,dataIndex:e.connPID,isGroupable:!1,isFilterable:!1})})),n},I=function(n){var t,r=s.getWUXNodeModel();t=P.ManageStepOperationsUsagePanel,(t=e.extend(t,{treeDocument:r},!0)).columnConfig.Columns.Column=m(n),i.createTreeListView(t),i.getContent().setStyles({top:"0px"}),o.notify("populateMangeStepOpertionsUI",{breadcrumb:a,columnInfo:t.columnConfig.Columns.Column})},h=function(e){var n=g.getReferenceModel(e).get("PLMEntity.V_Name");t.title=l.getNLSValue("ManageStepOperation.Title",{resource:n}),t.icon=l.getIconURLFromKey("Manage Step Operation Usages")},f=function(n){var t,i=r.getComponent("Breadcrumb");t=e.clone(n.breadcrumbValue),(a=new i({value:t,mode:i.MODE.EXCLUSIVE_SELECTION})).inject(n.breadcrumbContainer),h(n.resourcePID),a.addEventListener("selectionChange",(function(){o.notify("reBuildManageCapableRscUI")}))},{buildSkeleton:function(e){var n=e||{};t=n.panel,f(n),I(n)},getBreadCrumb:function(){return a}}}})),define("DS/DELPPWManageCapableResourcesModule/ReplaceResourceWarningReport",["UWA/Core"],(function(e){"use strict";return function(n,t,a,o){var r,i,s,c,u=a.getComponent("TreeNodeModel"),l=a.getComponent("TreeDocument"),d=a.getComponent("DataGridView"),p=a.getComponent("Element"),g=a.getComponent("Button");return r=new l,i=function(){var e=[{text:o.getNLSValue("ReplaceResourceInLink.WarningDialog.Column.LinkedResourceParameter"),dataIndex:"tree"},{text:o.getNLSValue("ReplaceResourceInLink.WarningDialog.Column.ResourceParameterList"),dataIndex:"RPList"},{text:o.getNLSValue("ReplaceResourceInLink.WarningDialog.Column.Issues"),dataIndex:"Status"}];return new d({columns:e,treeDocument:r,defaultColumnDef:{width:"auto"}})},s=function(n){var t=a.create("Dialog",{width:600,height:300}),r=new p("div",{class:"ApplyFilter-Dialog"}),s=function(){t.close(),e.is(r)&&(r.destroy(),null),t=null};t.domId="ReplaceResource-WarningDialog",t.title=o.getNLSValue("ReplaceResourceInLink.WarningDialog.Title"),t.modalFlag=!0,t.resizableFlag=!0,i().inject(r),t.content=r,t.buttons={Ok:new g({label:o.getNLSValue("ReplaceResourceInLink.WarningDialog.Apply"),onClick:function(){s(),e.is(n,"function")&&n()}}),Cancel:new g({label:o.getNLSValue("ReplaceResourceInLink.WarningDialog.Cancel"),onClick:s})},t.show()},c=function(e){Array.isArray(e)&&(r.prepareUpdate(),e.forEach((function(e){if(e.status===t.INCONSISTENT_AFTER_REPLACE){let n=new u({label:e.rpName,grid:{RPList:e.rpLISTName,Status:o.getNLSValue("ManageCapableResource.ReplaceResourceInLink."+e.status)}});r.addRoot(n)}})),r.pushUpdate())},{buildWarningDialog:function(n,t,a){t?(s(a),c(n)):e.is(a,"function")&&a()}}}})),define("DS/DELPPWManageCapableResourcesModule/ManageStepOperationsUsageUI",["UWA/Core","DS/DELPPWManageCapableResourcesModule/ManageStepOperationsUsageBaseUI"],(function(e,n){"use strict";return function(t,a,o,r,i,s,c,u,l,d){var p,g,f;const I="noChildren",m=function(n){var t={label:n.name,icons:[c.getIconURLFromKey(n.type)],referencePID:n.refPID,instancePID:n.instPID,children:[],grid:{cellInfo:{columns:n.columns,rowInfo:n.rowInfo}}};return n.columns.forEach((function(a,o){if(0===o){let o=a.dicoType+"."+a.dataIndex+(e.is(a.entity)?"."+a.entity:""),r=e.is(n.rowInfo[o].estimatedTime)?n.rowInfo[o].estimatedTime:null;t.grid[o]=r}else{let o=e.is(n.rowInfo[a.dataIndex].availabilityMode)?n.rowInfo[a.dataIndex].availabilityMode:"";t.grid[a.dataIndex]=o}})),t},h=function(e){return r.addNodeModel(e)};return f=function(n,t){var a={},o=d.getBreadCrumbRIRPath(),r=d.getImpacted(n,!1,{relationTypes:["PrimaryResourceLinkDetail","SecondaryResourceLinkDetail"]}),i=e.clone(o);return i.push(t),i.push(n),r.forEach((function(e){var n=e.get("PID"),t=e.get("to"),o=e.get("type"),r="Undefined"===e.get(o+".V_AvailabilityMode")?"":e.get(o+".V_AvailabilityMode"),i=e.get("DELLmiEstimatedTime.V_EstimatedTime");a[t]={resourceDetailPID:n,availabilityMode:r,estimatedTime:i}})),g.forEach((function(n,t){var o=[];0!==t&&(e.is(a[n.dataIndex])||(o.push({type:"ResourceDetail",idFrom:i,idTo:n.dataIndex}),a[n.dataIndex]={connectionParams:o}))})),a[g[0].dicoType+"."+g[0].dataIndex+(e.is(g[0].entity)?"."+g[0].entity:"")]=a[g[1].dataIndex],a},p=new n(t,a,o,r,i,s,c,u,l,d),e.extend(p,{populateUI:function(n){var t,a,o=n.breadcrumb.value.length,i=n.breadcrumb.value[o-1],s=[],c=[];g=n.columnInfo,r.emptyNodeModel(),a=d.getBreadCrumbRIRPath(),(t=d.getChildrenInfo(i.refPID)).forEach((function(t){var o,r,i=[];n.columnInfo.forEach((function(n){var o=e.clone(a);o.push(t.instPID),o.push(t.refPID),i.push({type:"ResourceDetail",idFrom:o,idTo:e.is(n.primaryLinkPID)?n.primaryLinkPID:n.dataIndex})})),o=d.getImpacted(t.refPID,!1,{relationTypes:["PrimaryResourceLinkDetail","SecondaryResourceLinkDetail"]}),r=i.filter((function(e){return!o.some((function(n){var t=n.get("from"),a=n.get("to");return JSON.stringify(t)===JSON.stringify(e.idFrom)&&a===e.idTo}))})),s=s.concat(r)})),new Promise((function(e,n){d.fetchRscDetailLinkBulk(s,{onComplete:function(n){c=s.filter((function(e){return!n.some((function(n){var t=n.get("from"),a=n.get("to");return JSON.stringify(t)===JSON.stringify(e.idFrom)&&a===e.idTo}))})),e(c)},onFailure:function(){n()}})})).then((function(){r.prepareUpdate(),t.forEach((function(e){var t,a;e.columns=n.columnInfo,e.rowInfo=f(e.refPID,e.instPID),t=m(e),a=h(t),r.updateNodeState(a,I)})),r.pushUpdate()}))},addNode:function(e){var n,t,a=e.get("PID"),o=e.get("isInstanceOf"),s=i.getReference(o),u={name:s.get("PLMEntity.V_Name"),type:s.get("type"),instPID:a,icon:c.getIconURLFromKey(s.get("type")),refPID:o};u.columns=g,u.rowInfo=f(u.refPID,u.instPID),n=m(u),t=h(n),r.updateNodeState(t,I)}})}})),define("DS/DELPPWManageCapableResourcesModule/ManageCapableResourcesBaseUI",["UWA/Core","DS/Core/PointerEvents","DS/DELPPWManageCapableResourcesModule/ReplaceResourceWarningReport","text!DS/DELPPWManageCapableResourcesModule/assets/json/ManageCapableRscTLVOption.json"],(function(e,n,t,a){"use strict";const o=["VPMReference","ErgoHuman"],r={CONSISTENT:"Consistent",INCONSISTENT_AFTER_REPLACE:"InconsistentAfterReplace"};var i,s,c,u,l,d,p,g=!1;return function(f,I,m,h,P,C,R,D,v,L,U,E,b){var S,M,y,N,k,A,O,T,w,x,V,B,F,W;return O=e.Json.decode(a),y=function(t){var a,o,r=h.getWUXNodeModel();o=function(n,t){var a={};!1===b.getStepOperationUIState()&&2===n.multipleHitCount&&("tree"===n.dsModel._activeCellStableID.columnDataIndex&&"DELAsmProcessCanUseCnx"===v.getConnection(t.nodeModel.getLinkPID()).get("type")&&(a.panel=i,a.breadcrumbValue=e.clone(p.value),a.resourcePID=t.nodeModel.getReferencePID(),a.linkPID=t.nodeModel.getLinkPID(),a.breadcrumbContainer=c,p.remove(),m.getToolBarContent().remove(),f.notify("openManagStepOperationPanel",a)),"Preferred"===n.dsModel._activeCellStableID.columnDataIndex&&"DELAsmProcessCanUseCnx"===v.getConnection(t.nodeModel.getLinkPID()).get("type")&&b.setPreferred(t.nodeModel.getLinkPID()))},A=O.ManageCapableResourcesPanel,A=e.extend(A,{treeDocument:r,treeListViewContainer:u,toolbarContainer:l,dataGridViewOptions:{toolbarOptions:{actionHandler:x},rowGroupingOptions:{canNodeBeGrouped:function(e){return e.isRoot()}}}},!0),A=e.extend(A,t,!0),m.createTreeListView(A),a=m.getDataGridView(),!1===g&&(a.addEventListener(n.POINTERHIT,o),g=!0)},V=function(){var e=p.value;i.title=R.getNLSValue("ManageCapableResource.Title",{operation:P.getDisplayName(P.getReferenceModel(e[e.length-1].refPID))}),i.icon=R.getIconURLFromKey("CapableResourceManageLinks")},M=function(n){var t=I.getComponent("Breadcrumb");p=new t({value:b.getBreadcrumbValue(n),mode:t.MODE.EXCLUSIVE_SELECTION}),V(),p.inject(c),p.addEventListener("change",(function(){V(),f.notify("refreshManageCapableResourceView",p.value[p.value.length-1].refPID)})),p.addEventListener("selectionChange",(function(){var e,n,t=1===p.selectedValues.length?p.selectedValues[0].refPID:null,a=[];if(null!==t){for(e=b.getBreadCrumbRefPIDs().indexOf(t),n=0;n<=e;n++)a.push(p.value[n]);p.value=a}})),p.onContextualEvent=function(n){var t,a,o=[];return a=n.indexFound,o.push({type:"TitleItem",title:R.getNLSValue("ManageCapableResource.Breadcrumb.Children")}),t=p.selectedValues[0].refPID,b.getChildrenInfo(t).forEach((function(n){o.push({type:"RadioItem",title:n.name,action:{callback:function(){var t,o,r,i=[];for(t=0;t<=a;t++)i.push(p.value[t]);(o=e.clone(p.value[a].path)).push(n.instPID),i.push({instPID:n.instPID,refPID:n.refPID,label:n.name,icon:{iconPath:n.icon,iconSize:{width:"20px",height:"20px"}},path:o}),r=b.isBreadCrumbLabelSameAsNewLabel(i),p.selectedValues=[],p.value=i,r&&f.notify("refreshManageCapableResourceView",p.value[p.value.length-1].refPID)},context:n}})})),o},b.setBreadCrumb(p)},T=function(){p.inject(c),V()},S=function(){var n,t=I.getComponent("WUXFrameWindowsManager").getFrameWindow(f.getAppContext()),a=I.getComponent("WUXDockAreaEnum");s=I.create("Element","div",{class:"mngrsc-panel-container"}),c=I.create("Element","div",{class:"mngrsc-breadcrumb-container"}),d=I.create("Element","div",{class:"mngrsc-navigator"}),l=e.createElement("div",{class:"ppr-toolbar"}),u=I.create("Element","div",{class:"mngrsc-tree-container"}),c.inject(d),l.inject(d),d.inject(s),u.inject(s),i=I.create("Panel",{identifier:"ManageCapableResourcesPanel",domId:"ManageCapableResourcesView",side:a.RightDockArea,currentDockArea:a.RightDockArea,immersiveFrame:t.getImmersiveFrame(),content:s,minWidth:300,height:300,minHeight:350,visibleFlag:!1,resizableFlag:!0,useBordersFlag:!0,collapsibleFlag:!1,verticallyStretchableFlag:!0}),n=t.getImmersiveFrame().getDockingElement(i.currentDockArea),e.is(n)&&(n.collapseDockingZoneFlag=!1),i.close=function(){e.is(k)?f.notify("toggleCmdCheckHeaderState",{cmdName:k,cmdState:!1}):N()}},w=function(){c.getChildren()[0].remove(),T(),m.createTreeListView(A),f.notify("refreshManageCapableResourceView",p.value[p.value.length-1].refPID),b.setStepOperationUIState(!1)},N=function(){i.hide()},B=function(){var e,n,t=[],a=[],o=D.getSelections();n=function(e){return new Promise((function(n,t){var a={onComplete:function(){n()},onFailure:function(){t()}};v.deleteConnection(e,a)}))},o[1].forEach((function(e){var n=v.getConnection(e);"DELAsmProcessCanUseCnx"===n.get("type")?t.push(e):"SecondaryCandidateResourceLink"===n.get("type")&&a.push(e)})),e=a.map((function(e){return n(e)})),Promise.allSettled(e).then((function(e){var a=0;e.forEach((function(e){"rejected"===e.state&&a++})),0===a&&t.map((function(e){return n(e)}))}))},W=function(n){return new Promise((function(t,a){var o=P.getReference(n);e.is(o)?t():P.fetchRoot(n,{onComplete:function(){t()},onFailure:function(){a()}})}))},x=function(n){var a,s,u,l,d,g,P,C={};switch(n){case"MCROpenManageStepOperationsUI":1===(P=D.getSelections())[1].length&&"DELAsmProcessCanUseCnx"===(a=v.getConnection(P[1][0])).get("type")&&(C.panel=i,C.breadcrumbValue=e.clone(p.value),C.resourcePID=a.get("to"),C.linkPID=a.get("PID"),C.breadcrumbContainer=c,p.remove(),m.getToolBarContent().remove(),f.notify("openManagStepOperationPanel",C));break;case"MCRReplaceResourceInLink":if(g=new t(f,r,I,R),e.is(document.getElementById("search-dialog-container")))break;s=b.getBreadCrumbRIRPath(),u=s[s.length-1],P=D.getSelections(),l=P[1][0],a=v.getConnection(l),d=a.get("to"),F=function(e){var n,t=e[0].id;d!==t?W(t).then((function(){if((n=b.canReplaceResource(u,t,l)).canReplace){let e,n;b.fetchResourceParametersInfo(d,(function(a){var o,i,c=!1;e=a,(o=Object.keys(e)).length>0&&(i=o.map((function(e){return[d,e]}))),b.fetchResourceParameterFromPlan(s,i,l,(function(a){var o;o=new Promise((function(o,i){Array.isArray(a)&&a.length>0?b.fetchResourceParametersInfo(t,(function(t){n=t,a.forEach((function(t){n.hasOwnProperty(t.rpListPID)?t.status=r.CONSISTENT:(t.status=r.INCONSISTENT_AFTER_REPLACE,c=!0),t.rpLISTName=e[t.rpListPID].rpListName,t.rpName=e[t.rpListPID][t.rpPID].V_Name})),o()})):o()})),o.then((function(){g.buildWarningDialog(a,c,(function(){var e=s.toString();b.replaceResourceInLink(t,e,l,{onComplete:function(){h.withTransactionUpdate((function(){f.notify("updateRelationsColumn",d),f.notify("updateRelationsColumn",s[s.length-1])}))}})}))}))}))}))}else f.warn(n.errorMessage)})):f.warn(R.getNLSValue("ManageCapableResource.ReplaceResourceInLink.SameResource"))},U.showSearchDialoguAndActivate(F,{types:o,command:"ReplaceResourceInLink"});break;case"MCRDeleteLinks":B()}},{buildUI:function(e){var n;e.manageCapableResourcesCmdId&&(k=e.manageCapableResourcesCmdId),S(),n=D.getSelectionsWithPaths(),M(n[0][0]),y(e),f.notify("refreshManageCapableResourceView",p.value[p.value.length-1].refPID)},reBuildUI:function(){w()},showUI:function(){i.show()},reloadUI:function(){var e,n,t=D.getSelectionsWithPaths();1===t[0].length&&(e=b.getBreadcrumbValue(t[0][0]),n=b.isBreadCrumbLabelSameAsNewLabel(e),p.selectedValues=[],p.value=e,n&&f.notify("refreshManageCapableResourceView",p.value[p.value.length-1].refPID))},enableToolBarButtons:function(){var e=D.getSelectionsWithPaths(),n=e[1],t=[];n.length>0&&t.push("MCRDeleteLinks"),1===n.length&&t.push("MCRReplaceResourceInLink"),b.isBreadCrumbLastElementHeaderOperation()&&1===n.length&&b.isPrimaryCapableResourceLink(e[1][0].id)&&t.push("MCROpenManageStepOperationsUI"),m.enableToolBarItems(t)},deleteLink:function(){B()},isActive:function(){return!!e.is(i)&&i.visibleFlag},getBreadCrumb:function(){return p},showORGROUPColumn:function(){m.getDataGridView().showColumn("DELAsmProcessCanUseCnx.V_CapableRscGroupIndex.link")},hideORGROUPColumn:function(){m.getDataGridView().hideColumn("DELAsmProcessCanUseCnx.V_CapableRscGroupIndex.link")},closePanel:function(){e.is(i)&&i.close()},destroy:function(){this.isActive()&&N(),e.is(i)&&(i.destroy(),i=void 0)}}}})),define("DS/DELPPWManageCapableResourcesModule/ManageCapableResourcesUI",["UWA/Core","DS/DELPPWManageCapableResourcesModule/ManageCapableResourcesBaseUI"],(function(e,n){"use strict";return function(t,a,o,r,i,s,c,u,l,d,p,g,f){var I,m;m={NO_CHILDREN:"noChildren",EXPANDING:"expanding",PARTIALLY_EXPANDED:"partiallyExpanded",EXPANDED:"expanded",COLLAPSED:"collapsed"};const h=function(e){return{label:e.toName,icons:[c.getIconURLFromKey(e.toType)],referencePID:e.toPID,instancePID:e.resourceUsagePID,linkPID:e.connPID,children:[],grid:{Type:c.getNLSValue(e.toType),Preferred:"TRUE"===e.isPreferred?c.getIconURLFromKey("Favorites"):"",ResourceUsage:e.resourceUsage,"DELLmiEstimatedTime.V_EstimatedTime.link":e.estimatedTime,"DELAsmProcessCanUseCnx.V_CapableRscGroupIndex.link":e.capableRscGroupIndex,Document:"",Position:""}}},P=function(e){return r.addNodeModel(e)},C=function(e,n){return r.addNodeModel(n,e)};return I=new n(t,a,o,r,i,s,c,u,l,d,p,g,f),e.extend(I,{addNode:function(n){var t,a,o,i,s,c=n.get("type"),u=n.get("from"),l=f.getBreadCrumbLastElementRefPID(),d=g.packConnInfo(n);"DELAsmProcessCanUseCnx"===c&&u===l?(t=h(d),o=r.getNodeModel(d.connPID),e.is(o)||(a=P(t),r.updateNodeState(a,m.NO_CHILDREN))):"SecondaryCandidateResourceLink"===c&&(i=h(d),o=r.getNodeModel(d.connPID),e.is(o)||(a=r.getNodeModel(d.fromPID),e.is(a,"array")&&a.length>0&&(a=a[0],s=C(a,i),a.getState()!==m.EXPANDED&&r.updateNodeState(a,m.EXPANDED),r.updateNodeState(s,m.NO_CHILDREN))))},removeNode:function(n){var t,a,o=n.get("type"),i=g.packConnInfo(n);"DELAsmProcessCanUseCnx"===o?(a=r.getNodeModel(i.connPID),e.is(a,"array")&&a.length>0&&(a[0].removeChildren(),a[0].remove())):"SecondaryCandidateResourceLink"===o&&(t=r.getNodeModel(i.connPID),e.is(t,"array")&&t.length>0&&((t=t[0]).remove(),0===(a=r.getNodeModel(i.fromPID)[0]).getChildren().length&&r.updateNodeState(a,m.NO_CHILDREN)))},loadLinkInfo:function(e){var n,t,a,o,i,s=[],c=f.getBreadCrumbRIRPath();i=function(e){s.push({type:"ResourceUsage",idFrom:c,idTo:e.connPID})},g.getPrimaryResourceLinksInfo(e).forEach((function(e){""===e.resourceUsage&&i(e),l.getSecondaryResourceLinksInfo(e.connPID).forEach((function(e){""===e.resourceUsage&&i(e)}))})),new Promise((function(e,n){f.fetchResourceUsages(s,{onComplete:function(){e()},onFailure:function(){n()}})})).then((function(){r.prepareUpdate(),r.emptyNodeModel(),g.getPrimaryResourceLinksInfo(e).forEach((function(e){var i=l.getSecondaryResourceLinksInfo(e.connPID);a=h(e),n=P(a),r.updateNodeState(n,m.NO_CHILDREN),i.forEach((function(e){n.getState()!==m.EXPANDED&&r.updateNodeState(n,m.EXPANDED),o=h(e),t=C(n,o),r.updateNodeState(t,m.NO_CHILDREN)}))})),r.pushUpdate()})).catch((function(){r.prepareUpdate(),r.emptyNodeModel(),r.pushUpdate()}))},updateNode:function(n){var t,a=n.linkPID?n.linkPID:n.pid,o=e.is(n.instPID)?n.instPID:null,i=r.getNodeModel(a);e.is(n.linkPID)&&delete n.linkPID,e.is(n.pid)&&delete n.pid,e.is(n.instPID)&&delete n.instPID,["DELLmiEstimatedTime.V_EstimatedTime","DELAsmProcessCanUseCnx.V_CapableRscGroupIndex"].forEach((function(t){e.is(n[t])&&(n[t+".link"]=n[t],delete n[t])})),e.is(n["DELAsmProcessCanUseCnx.V_IsPreferred"])&&(n.Preferred="TRUE"===n["DELAsmProcessCanUseCnx.V_IsPreferred"]?c.getIconURLFromKey("Favorites"):""),t={grid:n},e.is(i,"array")&&i.forEach((function(n){n.updateOptions(t),e.is(o)&&n.setInstancePID(o)}))},updateImpactedInfo:function(n){var t=n||{},a=this;r.prepareUpdate(),Object.keys(t).forEach((function(n){let o={linkPID:n};e.merge(o,t[n]),a.updateNode(o)})),r.pushUpdate()}})}})),define("DS/DELPPWManageCapableResourcesModule/ManageCapableResourcesModule",["UWA/Core","DS/DELPPWManageCapableResourcesModule/ManageCapableResourcesUI","DS/DELPPWManageCapableResourcesModule/ManageStepOperationsUsageUI"],(function(e,n,t){"use strict";return{behaviors:["WUXNodeModelBehavior","UXFactoryBehavior","TreeListViewBehavior","ModelBehavior","LinkBehavior","ResourceBehavior","SelectionBehavior","RootsBehavior","ViewBehavior","SearchBehavior","CapableResourceLinkBehaviour","ManageCapableResourcesBehaviour"],creator:function(a,o,r,i,s,c,u,l,d,p,g,f,I){var m,h,P,C,R,D,v="DELAsmProcessCanUseCnx",L="SecondaryCandidateResourceLink";return R=function(){return!1===I.getStepOperationUIState()},h=function(e){var n,t,a=e.linkPID;n={onComplete:function(e){var n={linkPID:a,attrRscUsage:"ResourceUsage",rscUsageValue:e.get("PLMInstance.PLM_ExternalID"),instPID:e.get("PID")};I.setResourceUsage(n)}},t={isAggregatedBy:e.isAggregatedBy,isInstanceOf:e.isInstanceOf},I.createResourceUsage(t,n)},D=function(n){const t=n.target;e.is(t)&&t.getAllDescendants().forEach((function(e){0===e.getChildren().length?o.updateNodeState(e,"noChildren"):o.updateNodeState(e,"expanded")}))},{listenTo:function(){return{select:this.onSelect,connectionAdded:this.onAddNode,instanceAdded:this.onAddInstance,instanceRemoved:this.onRemoveInst,referenceChanged:this.onChangeReference,instanceChanged:this.onChangeInstance,connectionRemoved:this.onRemoveConnection,connectionChanged:this.onConnectionChanged,createResourceUsage:this.onCreateResourceUsage,updateResourceUsage:this.onUpdateResourceUsage,replaceResourceInLink:this.onReplaceResourceInLink,updateImpactedInfoMCRUI:this.onUpdateImpactedInfoMCRUI,refreshManageCapableResourceView:this.refreshManageCapableResourceView,reBuildManageCapableRscUI:this.reBuildUI,openManagStepOperationPanel:this.startStepOperationUI,populateMangeStepOpertionsUI:this.populateMangeStepOpertionsUI,refreshImpacted:this.rePopulateMangeStepOpertionsUI,refreshAll:this.onRefreshAll}},onStart:function(e){o.removePreExpandListener(),I.setStepOperationUIState(!1),m=new n(a,r,i,o,s,d,u,l,c,p,g,f,I),new Promise(I.retrieveAttrInfos).then((function(){m.buildUI(e),m.showUI()})).catch((function(){a.warn("ManageCapableResource.FetchAttributeInfo.Failed")})),o.addEventListener("groupNodes",D)},reBuildUI:function(){I.setStepOperationUIState(!1),m.reBuildUI()},onStop:function(){m.destroy(),m=void 0},manageGrouping:function(){var e,n=i.getDataGridView();e={dataIndexesToGroup:[],ignorePreprocess:!1},I.getStepOperationUIState()||(I.canGroupApplied()?(m.showORGROUPColumn(),e.dataIndexesToGroup=["DELAsmProcessCanUseCnx.V_CapableRscGroupIndex.link"]):m.hideORGROUPColumn()),n.groupRows(e)},refreshManageCapableResourceView:function(e){m.loadLinkInfo(e),this.manageGrouping()},onAddNode:function(n){var t,a=[],r=[];R()&&(o.prepareUpdate(),(n=e.is(n,"array")?n:[n]).forEach((function(e){(t=e.get("type"))===v?a.push(e):t===L&&r.push(e)})),a.concat(r).forEach((function(e){m.addNode(e)})),o.pushUpdate())},onRemoveConnection:function(e){var n;R()&&(o.prepareUpdate(),(e=Array.isArray(e)?e:[e]).forEach((function(e){(n=e.get("type"))!==v&&n!==L||m.removeNode(e)})),o.pushUpdate())},onChangeReference:function(n){var t=function(e){o.updateAttributes(e)};o.prepareUpdate(),e.is(n,"array")?n.forEach((function(e){t(e)})):t(n),o.pushUpdate()},onChangeInstance:function(n){var t=function(e){var n,t=e.changedAttributes();for(const a in t)t.hasOwnProperty(a)&&"PLMInstance.PLM_ExternalID"===a&&(n={pid:e.get("PID"),ResourceUsage:e.get("PLMInstance.PLM_ExternalID")},m.updateNode(n))};o.prepareUpdate(),e.is(n,"array")?n.forEach((function(e){t(e)})):t(n),o.pushUpdate()},onConnectionChanged:function(n){var t=function(t){var a=t.changedAttributes(),o=t.get("type");o!==v&&o!==L||!e.is(a)||(a.linkPID=n.get("PID"),m.updateNode(a))};o.prepareUpdate(),e.is(n,"array")?n.forEach((function(e){t(e)})):t(n),o.pushUpdate()},onCreateResourceUsage:function(n){I.isUsagePossible()&&(e.is(n,"array")?n.forEach((function(e){h(e)})):h(n))},onUpdateResourceUsage:function(n,t){var a,o;o=e.is(n.instMdl)?n.instMdl:I.getResourceUsage(n.linkPID),e.is(o)&&(a={linkPID:n.linkPID,instPID:o.get("PID"),ResourceUsage:o.get("PLMInstance.PLM_ExternalID")},e.is(t)&&!0===t?I.setResourceUsage(a):m.updateNode(a))},onReplaceResourceInLink:function(e){var n=Array.isArray(e)?e:[e],t=this;o.prepareUpdate(),n.forEach((function(e){var n;n=f.packConnInfo(e),o.getNodeModel(n.connPID).forEach((function(e){e.setIcons([u.getIconURLFromKey(n.toType)]),e.setLabel(n.toName),e.setAttribute("Type",u.getNLSValue(n.toType)),e.setReferencePID(n.toPID)})),t.onUpdateResourceUsage({linkPID:n.connPID})})),o.pushUpdate()},onAddNodeNupdateResourceUsage:function(e){var n={linkPID:e.conn.get("PID"),instMdl:e.instMdl};this.onAddNode(e.conn),this.onUpdateResourceUsage(n,!0)},onUpdateImpactedInfoMCRUI:function(n){var t=n||{};e.is(t.PrimaryRscLinksInfo)&&m.updateImpactedInfo(t.PrimaryRscLinksInfo)},onSelect:function(e){R()&&(e.sourceId===a.getId()?m.enableToolBarButtons():m.reloadUI())},startStepOperationUI:function(e){I.setStepOperationUIState(!0),this.manageGrouping(),P=new t(a,r,i,o,s,d,u,l,c,I),o.getTreeDocument().empty(),P.buildSkeleton(e)},populateMangeStepOpertionsUI:function(e){C=e,P.populateUI(C)},rePopulateMangeStepOpertionsUI:function(e){var n=I.getBreadCrumbLastElementRefPID();!R()&&e.impactedChildren.indexOf(n)>-1&&P.populateUI(C)},onAddInstance:function(n){var t=function(e){I.getBreadCrumbLastElementRefPID()===e.get("isAggregatedBy")&&s.isOperation(e)&&P.addNode(e)};R()||(o.prepareUpdate(),e.is(n,"array")?n.forEach((function(e){t(e)})):t(n),o.pushUpdate())},onRemoveInst:function(n){var t=function(n){var t;e.is(n)&&(t=o.getNodeModel(n.id),e.is(t,"array")&&t.length>0&&t[0].remove())};R()||(o.prepareUpdate(),e.is(n,"array")?n.forEach((function(e){t(e)})):t(n),o.pushUpdate())},onRefreshAll:function(){e.is(m)&&m.closePanel()}}}}}));