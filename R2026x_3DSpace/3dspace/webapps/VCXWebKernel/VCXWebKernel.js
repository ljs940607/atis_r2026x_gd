define("DS/VCXWebKernel/VCXNodeHolderActorList",["DS/WebApplicationBase/W3AASGNodeHolder","DS/Visualization/PathElement"],(function(e,t){"use strict";return e.extend({init:function(){},buildSGNode:function(){return null},getPathElement:function(){return new t},isSelfManagedPathElement:function(){return!0}})}));var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXModelNavigableActorList",["require","exports","DS/WebApplicationBase/VCXAModelNavigable"],(function(e,t,n){"use strict";n=__importDefault(n);class i extends n.default{getChildren(){var e=this.QueryInterface("VCXIModifiable");if(!e)return[];for(var t=e.GetProperty("Actor.ListActors").GetPropertyValue().GetValue(),n=[],i=0;i<t.length;i++){var r=t[i],o=this.GetObject()._experienceBase.ComponentsMap.GetComponentFromLink(r);let e=o?.QueryInterface("VCXIModelNavigable");e&&n.push(e)}return n}isSelfOrganized(){return!0}}return i}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXCmdChangeMarker",["require","exports","DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCommand","DS/VCXWebKernelCommands/VCXCmdChangeComponent","DS/VCXWebKernelCommands/VCXCmdChangeModifiable"],(function(e,t,n,i,r,o){"use strict";i=__importDefault(i),r=__importDefault(r),o=__importDefault(o);class a extends i.default{constructor(e){super(e),this._type="VCXCmdChangeMarker",this._title="Change markers",this._markersToAdd=[],this._markerToRemove=[],this._scenario=null,this._bLockEvents=!1}AddMarkerToScenario(e,t,n){e&&"undefined"!==n&&(this._markersToAdd[n]=e),this._scenario=t}RemoveMarkerFromScenario(e,t){if(e){var n=e.QueryInterface("VCXIModifiable")?.GetProperty("Actor.TimePos").GetPropertyValue().GetValue();this._markerToRemove[n]=e}this._scenario=t}Do(){let e=this._experienceBase.getManager("VCXCommandManager");if(this._scenario){var t=new o.default(this._experienceBase),i=new r.default(this._experienceBase);for(var a in this._markersToAdd)if(this._markersToAdd.hasOwnProperty(a)){var s=this._markersToAdd[a];i.AddComponents(s);let e=s.QueryInterface("VCXIModifiable");e&&t.AddModifiables(e)}for(var a in this._markerToRemove)if(this._markerToRemove.hasOwnProperty(a)){s=this._markerToRemove[a];i.RemoveComponents(s);let e=s.QueryInterface("VCXIModifiable");e&&t.RemoveModifiables(e)}for(var a in e.Push(i),e.Push(t),this._markersToAdd)if(this._markersToAdd.hasOwnProperty(a)){s=this._markersToAdd[a];this._scenario.AddMarker(a,s),s.SetParentScenario(this._scenario.GetID())}for(var a in this._markerToRemove)this._markerToRemove.hasOwnProperty(a)&&this._scenario.RemoveMarker(a);if(this._bLockEvents);else{var l={arrayToAdd:this._markersToAdd,arrayToRemove:this._markerToRemove};n.publish({event:"VCX_MARKERS_CHANGED",data:l})}}else console.log("VCXCmdChangeMarker: scenario not found")}Invert(){var e=this._markersToAdd;this._markersToAdd=this._markerToRemove,this._markerToRemove=e}SetLockEvents(e){this._bLockEvents=e}}return a})),define("DS/VCXWebKernel/VCXModifiableDRMManager",["UWA/Core","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueBoolean","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],(function(e,t,n,i,r,o,a){"use strict";return t.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,n){if(n||(n={}),n.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;if("Display.Tree"===e){var i=t.GetValue();this.GetObject().GetDisplayTree()!==i&&this.GetObject().SetDisplayTree(i)}else if("Display.Timeline"===e){var r=t.GetValue();this.GetObject().GetDisplayTimeline()!==r&&this.GetObject().SetDisplayTimeline(r)}else if("Display.PropertiesPanel"===e){var o=t.GetValue();this.GetObject().GetDisplayPropertiesPanel()!==o&&this.GetObject().SetDisplayPropertiesPanel(o)}else{if("Display.ScenariosPanel"!==e){n.fromChildClass=!0;var a=this._parent(e,t,n);return a||console.log("property not found : '"+e+"'"),a}var s=t.GetValue();this.GetObject().GetDisplayScenariosPanel()!==s&&this.GetObject().SetDisplayScenariosPanel(s)}return!0},GetProperty:function(e){var t=null;if("Display.Tree"===e){var n=this.GetObject().GetDisplayTree();(c=new o).SetValue(n),t=new i(new r(e,2,!0,a),c)}else if("Display.Timeline"===e){var s=this.GetObject().GetDisplayTimeline();(c=new o).SetValue(s),t=new i(new r(e,2,!0,a),c)}else if("Display.PropertiesPanel"===e){var l=this.GetObject().GetDisplayPropertiesPanel();(c=new o).SetValue(l),t=new i(new r(e,2,!0,a),c)}else if("Display.ScenariosPanel"===e){var c,p=this.GetObject().GetDisplayScenariosPanel();(c=new o).SetValue(p),t=new i(new r(e,2,!0,a),c)}return t},GetProperties:function(){var e=new n;return e.AddOrModifyProperty(this.GetProperty("Display.Tree")),e.AddOrModifyProperty(this.GetProperty("Display.Timeline")),e.AddOrModifyProperty(this.GetProperty("Display.PropertiesPanel")),e.AddOrModifyProperty(this.GetProperty("Display.ScenariosPanel")),e}})})),define("DS/VCXWebKernel/VCXModifiableMarker",["DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueBoolean","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],(function(e,t,n,i,r,o,a,s){"use strict";return e.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,n){if(n||(n={}),n.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;if("Actor.Name"===e){var i=t.GetValue();this.GetObject().name!==i&&(this.GetObject().name=i)}else if("Actor.TimePos"===e){var r=t.GetValue();this.GetObject().timePos!==r&&(this.GetObject().timePos=r)}else{if("Actor.IsMilestone"!==e){n.fromChildClass=!0;var o=this._parent(e,t,n);return o||console.log("property not found : '"+e+"'"),o}var a=t.GetValue();this.GetObject().isMileStone!==a&&(this.GetObject().isMileStone=a)}return!0},GetProperty:function(e){var t=null;if("Actor.Name"===e){var l=this.GetObject().name;if(l){var c=new o;c.SetValue(l),t=new n(new i(e,2,!0,s),c)}}else if("Actor.TimePos"===e){var p=this.GetObject().timePos;if(null!==p){var h=new r;h.SetValue(p),t=new n(new i(e,0,!0,s),h)}}else if("Actor.IsMilestone"===e){var u=this.GetObject().isMileStone;if(null!==u){var d=new a;d.SetValue(u),t=new n(new i(e,0,!0,s),d)}}return t},GetProperties:function(){var e=new t;return e.AddOrModifyProperty(this.GetProperty("Actor.TimePos")),e.AddOrModifyProperty(this.GetProperty("Actor.Name")),e.AddOrModifyProperty(this.GetProperty("Actor.IsMilestone")),e}})}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXCmdChangeSelection",["require","exports","DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCommand"],(function(e,t,n,i){"use strict";i=__importDefault(i);class r extends i.default{constructor(e,t=!1){super(e),this._type="VCXCmdChangeSelection",this._title="Change selection",this._DoNotUpdateCSO=t,this._compToAdd=[],this._compToRemove=[],this._bLockEvents=!1}_sendWarningIfNecessary(e,t){r._deprecatedWarnCounts[t]>0&&(console.warn(e),--r._deprecatedWarnCounts[t])}Do(){let e=this._experienceBase.getManager("VCXSelectionManager");e.addComponentsToSelection(this._compToAdd,this._DoNotUpdateCSO),e.removeComponentsFromSelection(this._compToRemove,this._DoNotUpdateCSO),this._bLockEvents||n.publish({event:"VCX_SELECTION_CHANGED"})}Invert(){var e=this._compToAdd;this._compToAdd=this._compToRemove,this._compToRemove=e}SaveContext(){}AddComponentsToSelection(e){if(!e)return!1;this._compToAdd=this._compToAdd.concat(e)}AddToSelection(e){if(e.QueryInterface("VCXIModifiable")===e){this._sendWarningIfNecessary("The method 'AddToSelection' used with a modifiable as parameter is now deprecated. Please use a component instead of a modifiable.","AddToSelection"),e=e.GetObject()}this._compToAdd.push(e)}RemoveComponentsFromSelection(e){if(!e)return!1;this._compToRemove=this._compToRemove.concat(e)}RemoveFromSelection(e){if(e.QueryInterface("VCXIModifiable")===e){this._sendWarningIfNecessary("The method 'RemoveFromSelection' used with a modifiable as parameter is now deprecated. Please use a component instead of a modifiable.","RemoveFromSelection"),e=e.GetObject()}this._compToRemove.push(e)}SetSelection(e){if(e&&e.QueryInterface("VCXIModifiable")===e){this._sendWarningIfNecessary("The method 'SetSelection' used with a modifiable as parameter is now deprecated. Please use a component instead of a modifiable.","SetSelection"),e=e.GetObject()}var t=this._experienceBase.getManager("VCXSelectionManager").GetComponentsFromCurrentSelection();if(e){var n,i=!1;(n=e.GetID())||console.log("VCXCmdChangeSelection: id is not defined for this component !");for(var r=0;r<t.length;r++){var o=t[r].GetID();o?o!==n?this.RemoveFromSelection(t[r]):i=!0:console.log("VCXCmdChangeSelection: currentId is empty !")}!i&&n&&this.AddToSelection(e)}else this.RemoveComponentsFromSelection(t)}SetComponentsSelection(e){for(var t=this._experienceBase.getManager("VCXSelectionManager").GetComponentsFromCurrentSelection(),n=0;n<t.length;n++){var i=t[n];if(i){for(var r=!1,o=0;o<e.length;o++){var a=e[o];if(a&&a===i){r=!0;break}}r||this.RemoveFromSelection(i)}}this.AddComponentsToSelection(e)}SetModifiablesSelection(e){this._sendWarningIfNecessary("/!\\ The method SetModifiablesSelection(arrModifiables) is DEPRECATED /!\\\nPlease use method cmdChangeSelection.SetComponentsSelection(arrComponents) instead.","SetModifiablesSelection");var t=e.map((function(e){return e.GetObject()}));this.SetComponentsSelection(t)}SetLockEvents(e){this._bLockEvents=e}static buildCmd(e){return new r(e)}}return r.nbInitWarns=3,r._deprecatedWarnCounts={AddToSelection:r.nbInitWarns,RemoveFromSelection:r.nbInitWarns,SetSelection:r.nbInitWarns,SetModifiablesSelection:r.nbInitWarns},r})),define("DS/VCXWebKernel/VCXMarkerManager",["UWA/Class","DS/CoreEvents/Events"],(function(e,t){"use strict";var n=e.extend({initialize:function(){this._callback=null,this._tokenMarkerSeq=t.subscribe({event:"VCX_UPDATE_MARKER_SEQ"},(e=>{this.UpdateMarkerSequence(e)}))},unInitialize:function(){this._callback=null,this._tokenMarkerSeq&&(t.unsubscribe(this._tokenMarkerSeq),this._tokenMarkerSeq=null)},UpdateMarkerSequence:function(e){if(this._callback){var t=e.scenarioID,n=this._experienceBase.ComponentsMap.GetComponentFromID(t);if(n){var i=n.GetTrackMarkers();if(i){var r=i.GetPreviousKey(e.time);if(r){var o=r.GetValue().GetValue();if(n.GetCurrentMarkerSequence()!==o&&(n.SetCurrentMarkerSequence(o),this._callback)){var a=this._experienceBase.ComponentsMap.GetComponentFromID(o);if(a){var s=a.GetTimePos(),l=a.GetName(),c=a.IsMilestone();this._callback(l,s,c,t,o)}}}}}}},RegisterMarkerSequenceCB:function(e){this._callback=e}});return Object.defineProperty(n.prototype,"componentType",{enumerable:!0,get:function(){return"VCXMarkerManager"}}),n})),define("DS/VCXWebKernel/VCXAContextualContent",["UWA/Class"],(function(e){"use strict";var t=e.extend({createContentCommandsPanel:function(e,t,n){let i={};e.sort(((e,t)=>e.order-t.order));let r=0;for(let o of e){let e={type:"button"};e.name="Change"+t+"0"+r,e.cmdId={id:o.name,args:o.commandArgs||{}},e.iconFolder=n,e.icon="icons/32/"+o.icon+".png",e.noPreview=o.noPreview||!1,i[e.name]=e,r++}return i},appendContent:function(e,t,n){}});return t.content=[],t})),define("DS/VCXWebKernel/VCXMultiUserInputManager",["UWA/Class"],(function(e){"use strict";var t=e.extend({postInitialize:function(){this._parent(),this._runningCommand=[]},unInitialize:function(){this._parent()},update:function(e){for(var t=0;t<this._runningCommand.length;t++)this._runningCommand[t].update&&this._runningCommand[t].update(e)},preRender:function(e){for(var t=0;t<this._runningCommand.length;t++)this._runningCommand[t].preRender&&this._runningCommand[t].preRender(e)},postRender:function(e){for(var t=0;t<this._runningCommand.length;t++)this._runningCommand[t].postRender&&this._runningCommand[t].postRender(e)},postUpdate:function(e){for(var t=0;t<this._runningCommand.length;t++)this._runningCommand[t].postUpdate&&this._runningCommand[t].postUpdate(e)},registerCommand:function(e){this._runningCommand.push(e)},unRegisterCommand:function(e){this._runningCommand.pop(e)}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXMultiUserInputManager"}}),t}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXActorList_Spec",["require","exports","DS/VCXWebExperienceBase/VCXComponentOccurrenceExperience"],(function(e,t,n){"use strict";n=__importDefault(n);class i extends n.default{constructor(){super(),this._arrayActors=[],this._arrayActors=[],this._bEnable=!0,this._GroupID=null}SetName(e){e&&(this._name=e)}GetName(){return this._name}SetArrayActors(e){if(Array.isArray(e)&&0!==e.length)for(var t=0;t<e.length;t++){var n=e[t];this.AddActor(n)}}GetArrayActors(){return this._arrayActors}AddActor(e){for(var t=!1,n=0;n<this._arrayActors.length;n++){if(this._arrayActors[n]===e){t=!0;break}}if(!t){var i=this._experienceBase.ComponentsMap.GetComponentFromID(e);i&&(this._arrayActors.push(e),this.getManagerName&&this._experienceBase.getManager(this.getManagerName()).addComponentToMapSelectionSet(i,this))}}RemoveActor(e){for(var t=0;t<this._arrayActors.length;t++){if(this._arrayActors[t]===e){this._arrayActors.splice(t,1);var n=this._experienceBase.ComponentsMap.GetComponentFromID(e);n&&this.getManagerName&&this._experienceBase.getManager(this.getManagerName()).removeComponentFromMapSelectionSet(n,this);break}}}get enable(){return this._bEnable}set enable(e){this._bEnable=e}get GroupID(){return this._GroupID}set GroupID(e){this._GroupID=e}}return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXActorList_Spec"}}),i}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXCmdGoToMarker",["require","exports","DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCommand","DS/VCXWebKernelCommands/VCXCmdChangeTimePos","DS/VCXWebKernelCommands/VCXCmdGoToScenario"],(function(e,t,n,i,r,o){"use strict";i=__importDefault(i),r=__importDefault(r),o=__importDefault(o);class a extends i.default{constructor(e){super(e),this._type="VCXCmdGoToMarker",this._title="Go to markers",this._targetMarker=null,this._frameForDo=null,this._frameForUndo=null,this._bLockEvents=!1}GoToMarker(e){this._targetMarker=this._experienceBase.ComponentsMap.GetComponentFromID(e),this._targetMarker&&(this._frameForDo=this._targetMarker.QueryInterface("VCXIModifiable")?.GetProperty("Actor.TimePos").GetPropertyValue().GetValue())}GoToNextMarker(){let e=this._experienceBase.getManager("VCXScenarioManager");var t=e.GetCurrentFrame(),n=e.GetCurrentScenario(),i=this._experienceBase.ComponentsMap.GetComponentFromID(n),r=i.GetTrackMarkers(),o=!1;if(r){var a=r.GetNextStrictKey(t);if(null!==a){var s=a.GetValue().GetValue(),l=a.GetFrame();this._targetMarker=this._experienceBase.ComponentsMap.GetComponentFromID(s),this._frameForDo=l,o=!0}}o||(this._frameForDo=i.GetMaxFrame())}GoToPreviousMarker(){let e=this._experienceBase.getManager("VCXScenarioManager");var t=e.GetCurrentFrame(),n=e.GetCurrentScenario(),i=this._experienceBase.ComponentsMap.GetComponentFromID(n).GetTrackMarkers(),r=!1;if(i){var o=i.GetPreviousStrictKey(t);if(null!==o){var a=o.GetValue().GetValue(),s=o.GetFrame();this._targetMarker=this._experienceBase.ComponentsMap.GetComponentFromID(a),this._frameForDo=s,r=!0}}r||(this._frameForDo=0)}Do(){let e=this._experienceBase.getManager("VCXScenarioManager"),t=this._experienceBase.getManager("VCXCommandManager");if(this._targetMarker){var i=this._targetMarker.GetParentScenario();if(i!==e.GetCurrentScenario()){var a=new o.default(this._experienceBase);a.GoToScenario(i),t.Push(a)}}var s=new r.default(this._experienceBase);s.ChangeTimePos(this._frameForDo),t.Push(s);this._bLockEvents||n.publish({event:"VCX_GOTO_MARKER",data:this._frameForDo}),this._callback&&this._callback()}SaveContext(){let e=this._experienceBase.getManager("VCXScenarioManager");this._frameForUndo=e.GetCurrentFrame()}Redo(){this._bLockEvents||n.publish({event:"VCX_GOTO_MARKER",data:this._frameForDo})}Undo(){this._bLockEvents||n.publish({event:"VCX_GOTO_MARKER",data:this._frameForUndo})}Invert(){}SetLockEvents(e){this._bLockEvents=e}}return a}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXNotificationManager",["require","exports","DS/VCXWebComponents/VCXWebComponentBaseExperience","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","i18n!DS/VCXWebKernel/assets/nls/VCXWebKernel","DS/VCXWebIO/VCXLogServices","UWA/Core","DS/Controls/ProgressBar","DS/ControlsEx/LoadingPanel","css!DS/VCXWebKernel/VCXWebKernel"],(function(e,t,n,i,r,o,a,s,l,c){"use strict";n=__importDefault(n),i=__importDefault(i),r=__importDefault(r),o=__importDefault(o),a=__importDefault(a),l=__importDefault(l),c=__importDefault(c);class p{constructor(e,t){this.notifStacks=new Set,this.displayMode=e,this.manager=t}initialize(){}dispose(){}cleanAll(){}addProgress(e){this.notifStacks.add(e)}updateProgress(e){}endProgress(e){this.notifStacks.delete(e)}successProgress(e){}errorProgress(e,t){}getLastItem(){return 0===this.notifStacks.size?null:Array.from(this.notifStacks)[this.notifStacks.size-1]}}class h extends p{constructor(e){super(f.FDisplayMode.SILENT|f.FDisplayMode.PROGRESSSPINNER|f.FDisplayMode.PROGRESSBAR|f.FDisplayMode.CONSOLE|f.FDisplayMode.BUBBLEFLOW,e)}addProgress(e){super.addProgress(e),this.manager._experienceBase.AddEventHelperLifecycle(e.strAction+" "+e.strObjectType+" "+e.strObjectName,e.notifId?.toString(),"b")}endProgress(e){super.endProgress(e),this.manager._experienceBase.AddEventHelperLifecycle(e.strAction+" "+e.strObjectType+" "+e.strObjectName,e.notifId?.toString(),"e")}}class u extends p{constructor(e){super(f.FDisplayMode.BUBBLEFLOW,e)}_completeWuxOptions(e,t,n,i){t.level=n,t.sticky="success"!==n,"info"===n&&e.showPourcent&&(t.message=e.currentProgressLevel+" / "+e.totalProgressLevel),"error"===n&&(t.message=i),t.allowUnsafeHTML=!1,t.title=e.strAction+" "+e.strObjectType,t.subtitle=e.strObjectName}addProgress(e){super.addProgress(e),e.wuxNotifId=this._sendNotif(e,"info")}updateProgress(e){let t={};this._completeWuxOptions(e,t,"info"),i.default.modifyNotif(e.wuxNotifId,t)}endProgress(e){super.endProgress(e),r.default.removeNotification(e.wuxNotifId)}successProgress(e){this._sendNotif(e,"success")}errorProgress(e,t){this._sendNotif(e,"error",t)}_sendNotif(e,t,n){let r={};return this._completeWuxOptions(e,r,t,n),i.default.addNotif(r)}cleanAll(){this.notifStacks.forEach((e=>this.endProgress(e)))}}class d extends p{constructor(e){super(f.FDisplayMode.CONSOLE,e)}addProgress(e){super.addProgress(e),console.log("addProgressNotification: "+this.manager._getFormatedName(e))}endProgress(e){super.endProgress(e),console.log("endProgressNotification: "+this.manager._getFormatedName(e))}successProgress(e){super.successProgress(e),console.log("successProgress: "+this.manager._getFormatedName(e))}updateProgress(e){super.updateProgress(e),console.log("updateProgress: "+this.manager._getFormatedName(e))}errorProgress(e,t){super.successProgress(e),console.log("successProgress: "+this.manager._getFormatedName(e)),console.warn(t)}}class m extends p{constructor(e){super(f.FDisplayMode.PROGRESSBAR,e),this._notificationProgressBarContainer=null,this._progressBar=null,this.timer=null,this.buildView()}buildView(){var e=document.querySelector('div[data-type="ui-frame-2d"]');e&&(this._notificationProgressBarContainer=(0,s.createElement)("div",{html:"",class:"vcx-Notification-Progress-Bar-Container"}).inject(e,"top").hide(),this._progressBar=new l.default({displayStyle:"lite"}).inject(this._notificationProgressBarContainer))}dispose(){this._progressBar?.remove(),this._progressBar=null,this._notificationProgressBarContainer?.remove(),this._notificationProgressBarContainer=null}setValue(){if(!this._progressBar)return;let e=this.getLastItem();if(!e)return;let t=this._progressBar.value;"number"==typeof t&&this.manager&&(void 0!==e.percentValue?this._progressBar.value=e.percentValue:this._progressBar.value=this.manager.computeBarValue(t))}addProgress(e){super.addProgress(e),this.setValue(),1===this.notifStacks.size&&(this.timer&&clearTimeout(this.timer),this._notificationProgressBarContainer?.show())}updateProgress(e){this.setValue()}endProgress(e){super.endProgress(e),0===this.notifStacks.size&&(this.timer=setTimeout(this._cleanProgressBar.bind(this),100))}_cleanProgressBar(){this._progressBar&&(this._progressBar.emphasize="info",this._progressBar.value=0,this._notificationProgressBarContainer?.hide())}successProgress(e){this._progressBar&&(this._progressBar.emphasize="success",this._progressBar.value=100)}errorProgress(e,t){this._progressBar&&(this._progressBar.emphasize="high-attention",this._progressBar.value=100)}}class C extends p{constructor(e){super(f.FDisplayMode.LOADINGPANEL,e),this.panelViewTitle=null,this.panelViewSubtitleContainer=null,this.panelViewMainSubtitle=null,this.panelViewSecondarySubtitle=null,this.panelView=null,this.timer=null,this.buildView()}buildView(){this.panelView=new c.default({modalFlag:!0,statusFlag:!1,info:" ",value:0,width:"25%"}).inject(document.body),this.panelView.getContent().addClassName("vcx-Notification-LoadingPanel"),this.panelViewTitle=(0,s.createElement)("div",{html:"",class:"vcx-loading-panel-title"}),this.panelView.elements._panel.insertBefore(this.panelViewTitle,this.panelView.elements._panel.firstChild),this.panelViewSubtitleContainer=(0,s.createElement)("div",{html:"",class:"vcx-loading-panel-subtitle-container"}).inject(this.panelView.elements._panel),this.panelViewMainSubtitle=(0,s.createElement)("div",{html:"",class:"vcx-loading-panel-subtitle vcx-main-subtitle"}).inject(this.panelViewSubtitleContainer),this.panelViewSecondarySubtitle=(0,s.createElement)("div",{html:"",class:"vcx-loading-panel-subtitle vcx-secondary-subtitle"}).inject(this.panelViewSubtitleContainer)}resetPanelView(){this.panelView&&this.panelViewTitle&&this.panelViewMainSubtitle&&this.panelViewSecondarySubtitle&&(this.panelView.value=0,this.panelView.emphasize="info",this.panelViewTitle.innerHTML="",this.panelViewMainSubtitle.innerHTML="",this.panelViewSecondarySubtitle.innerHTML="",this.panelView.getContent().addClassName("info"))}dispose(){this.panelView?.destroy()}_displayView(){this.panelView&&(this.panelView.show(),this.panelView.on(),f._addTempStyle())}_hideView(){this.panelView?.off(),this.panelView?.hide(),f._removeTempStyle(),this.resetPanelView()}setValue(e){if(!(this.panelView&&this.panelViewTitle&&this.panelViewMainSubtitle&&this.panelViewSecondarySubtitle))return;let t=this.getLastItem();if(!t)return;this.panelView.getContent().addClassName("infoProgressBar"),100===this.panelView?.value&&this.resetPanelView(),t.notifTitle&&(this.panelViewTitle.textContent=t.notifTitle),t.strAction&&(this.panelViewMainSubtitle.textContent=t.strAction);let n="";t.strObjectName&&(n=t.strObjectName),t.strObjectType&&(n+=" "+t.strObjectType),this.panelViewSecondarySubtitle.textContent=n;let i=this.panelView.value;"number"==typeof i&&this.manager&&e&&(void 0!==t.percentValue?this.panelView.value=t.percentValue:this.panelView.value=this.manager.computeBarValue(i))}addProgress(e){super.addProgress(e),this.setValue(!0),1===this.notifStacks.size&&(this.timer&&clearTimeout(this.timer),this._displayView())}updateProgress(e){this.setValue(!0)}endProgress(e){super.endProgress(e),0===this.notifStacks.size&&(this.timer=setTimeout(this._hideView.bind(this),1e3)),this.setValue(!1)}successProgress(e){this.panelView&&(this.panelView.getContent().removeClassName("infoProgressBar"),this.panelView.emphasize="success",this.panelView.value=100)}errorProgress(e,t){this.panelView&&(this.panelView.getContent().removeClassName("infoProgressBar"),this.panelView.emphasize="high-attention",this.panelView.value=100)}}class g extends p{constructor(e){super(f.FDisplayMode.PROGRESSSPINNER,e),this._progressBarContainer=null,this._progressBar=null,this.timer=null,this.buildView()}buildView(){let e=this.manager._experienceBase.getManager("VCXGUIManager").getUsableArea(!1);e&&(this._progressBarContainer=(0,s.createElement)("div",{html:"",class:"vcx-Notification-Progress-Spinner-Container"}).inject(e,"top").hide(),this._progressBar=new l.default({displayStyle:"lite",infiniteFlag:!0,height:25,shape:"circular"}).inject(this._progressBarContainer),this._progressBarContainer?.inject(e).hide())}dispose(){this._progressBar?.remove(),this._progressBar=null,this._progressBarContainer?.remove(),this._progressBarContainer=null}_displayView(){this._progressBarContainer&&(this._progressBarContainer.style.display="")}_hideView(){this._progressBarContainer&&(this._progressBarContainer.style.display="none"),this._progressBar&&(this._progressBar.infiniteFlag=!0,this._progressBar.emphasize="info",this._progressBar.value=0)}addProgress(e){super.addProgress(e),1===this.notifStacks.size&&(this.timer&&clearTimeout(this.timer),this._displayView())}endProgress(e){super.endProgress(e),0===this.notifStacks.size&&(this.timer=setTimeout(this._hideView.bind(this),100))}successProgress(e){this._progressBar&&(this._progressBar.infiniteFlag=!1,this._progressBar.emphasize="success",this._progressBar.value=100)}errorProgress(e){this._progressBar&&(this._progressBar.infiniteFlag=!1,this._progressBar.emphasize="high-attention",this._progressBar.value=100)}}class f extends n.default{constructor(){super(),this.views=[],this._notifCounter=0,this._notifStack=new Map}postInitialize(){r.default.setNotificationManager(i.default),r.default.setStackingPolicy(7),r.default.setRemoveStackOnFirstTimeoutFlag(!0),this.views.push(new d(this)),this.views.push(new u(this)),this.views.push(new m(this)),this.views.push(new C(this)),this.views.push(new g(this)),localStorage.getItem("DebugNotificationLifecycle")&&this.views.push(new h(this)),Object.values(this.views).forEach((e=>e.initialize()))}unInitialize(){this._clearAllProgressNotifications(),this.clearAllNotifications(),this._notifStack.clear(),this._notifCounter=0,Object.values(this.views).forEach((e=>e.dispose()))}_generateNotificationId(){return++this._notifCounter}_clearAllProgressNotifications(){this.views.forEach((e=>e.cleanAll()))}_updateVCXOptionsLabels(e,t){e.strObjectType=t.strObjectType??e.strObjectType,e.strObjectName=t.strObjectName??e.strObjectType,e.strAction=t.strAction??e.strAction,e.notifTitle=t.notifTitle??e.notifTitle,e.totalProgressLevel=t.totalProgressLevel??e.totalProgressLevel,e.currentProgressLevel=t.currentProgressLevel??e.currentProgressLevel,e.percentValue=t.percentValue??(e.currentProgressLevel??1)/(e.totalProgressLevel??2)*100}_completeVCXInputOptions(e){e.strObjectType=e.strObjectType||"",e.strObjectName=e.strObjectName||e.strObjectType,e.strAction=e.strAction||o.default["ProgressNotification.Loading"],e.iPromise=e.iPromise||void 0,e.totalProgressLevel=e.totalProgressLevel||2,e.currentProgressLevel=e.currentProgressLevel||0,e.percentValue=e.percentValue||void 0,e.maskDisplayAdd=e.maskDisplayAdd||f.FDisplayMode.CONSOLE|f.FDisplayMode.BUBBLEFLOW,!0===e?.maskDisplayEnd&&(e.maskDisplayEnd=e.maskDisplayAdd),e.maskDisplayEnd=e.maskDisplayEnd||f.FDisplayMode.CONSOLE,e.maskDisplayErr=e.maskDisplayErr||f.FDisplayMode.CONSOLE|f.FDisplayMode.BUBBLEFLOW}_getFormatedName(e){return e.strAction+" : "+e.strObjectName}computeBarValue(e,t=100,n=70){let i=n*(t-e)/200;return e+=(t-e)/2-Math.random()*i}addNotification(e){return e.category=e.message,i.default.addNotif(e)}clearAllNotifications(){r.default.removeNotifications("",""),r.default.removeNotifications()}addProgressNotification(e){var t=this._generateNotificationId();if(this._completeVCXInputOptions(e),e.notifId=t,this._notifStack[t]=e,this.views.forEach((t=>e.maskDisplayAdd&&e.maskDisplayAdd&t.displayMode&&t.addProgress(e))),this._notifStack[t].iPromise){var n=e.strAction+" "+e.strObjectType+" "+e.strObjectName;const i=a.default.generateUUID();a.default.memoryLog(n,!0,i),this._notifStack[t].iPromise.then((()=>{this.endProgressNotification(t),a.default.memoryLog(n,!1,i)})).catch((e=>{this.errorProgressNotification(t,e),console.error(e),a.default.memoryLog(n,!1,i)}))}return t}updateProgressNotification(e,t){if(this._notifStack[e]){let n=this._notifStack[e];t||(n.showPourcent=!0,t={currentProgressLevel:Math.min(n.currentProgressLevel+1,n.totalProgressLevel)}),this._updateVCXOptionsLabels(n,t),this.views.forEach((e=>n.maskDisplayAdd&e.displayMode&&e.updateProgress(n)))}}endProgressNotification(e,t=!1){if(this._notifStack[e]){let n=this._notifStack[e];t&&(n.maskDisplayEnd=n.maskDisplayEnd|n.maskDisplayAdd,console.warn("isLastStep is not suppose to be use, prefer settings the maskDisplayEnd: instead !")),this.views.forEach((e=>n.maskDisplayEnd&e.displayMode&&e.successProgress(n))),this.views.forEach((e=>n.maskDisplayAdd&e.displayMode&&e.endProgress(n)))}}errorProgressNotification(e,t){if(this._notifStack[e]){var n="object"==typeof t&&t.message?t.message:t;let i=this._notifStack[e];this.views.forEach((e=>i.maskDisplayErr&e.displayMode&&e.errorProgress(i,n))),this.views.forEach((e=>i.maskDisplayAdd&e.displayMode&&e.endProgress(i)))}}static _addTempStyle(){var e=document.querySelector(".xapp-background-image");e&&(e.style.webkitFilter="blur(5px)",e.style.filter="blur(5px)");var t=document.querySelector(".xapp-app-container");t&&(t.style.visibility="hidden");var n=document.querySelector(".vcx-Notification-Curtain-Title");n&&(n.style.fontSize="4rem");let i=document.querySelector(".afr-welcome-screen-container");if(i){let e=i.children;for(let t=0;t<e.length;t++){let n=e[t];"IMG"!==n.nodeName&&(n.style.visibility="hidden")}}let r=document.querySelector(".vcx-Notification-LoadingPanel");r&&r.firstChild&&!localStorage.getItem("VCX_NoBlur_NotifODT")&&(r.firstChild.style.backdropFilter="blur(5px)")}}return f._removeTempStyle=function(){console.warn("removing temporary style");var e=document.querySelector(".xapp-background-image");e&&(e.style.webkitFilter="",e.style.filter="");var t=document.querySelector(".xapp-app-container");t&&(t.style.visibility="");let n=document.querySelector(".afr-welcome-screen-container");if(n){let e=n.children;for(let t=0;t<e.length;t++){e[t].style.visibility=""}}let i=document.querySelector(".vcx-Notification-LoadingPanel");i&&(i.firstChild.style.backdropFilter="")},function(e){let t;!function(e){e[e.SILENT=1]="SILENT",e[e.CONSOLE=2]="CONSOLE",e[e.BUBBLEFLOW=4]="BUBBLEFLOW",e[e.PROGRESSBAR=8]="PROGRESSBAR",e[e.LOADINGPANEL=16]="LOADINGPANEL",e[e.PROGRESSSPINNER=64]="PROGRESSSPINNER"}(t=e.FDisplayMode||(e.FDisplayMode={}))}(f||(f={})),Object.defineProperty(f.prototype,"componentType",{enumerable:!0,get:function(){return"VCXNotificationManager"}}),f})),define("DS/VCXWebKernel/VCXDRMManager",["UWA/Class"],(function(e){"use strict";var t=e.extend({init:function(){},initialize:function(){this._bDisplayWatermark=!1,this._bDisplaySignature=!1,this._bValidSignature=!0,this._bDisplayTree=!0,this._bValidDate=!0,this._bDisplayTimeline=!0,this._bDisplayPropertiesPanel=!0,this._bDisplayScenariosPanel=!0,this._bDisplayPaper=!1},SetDisplayWatermark:function(e){this._bDisplayWatermark=e},GetDisplayWatermark:function(){return this._bDisplayWatermark},SetDisplaySignature:function(e){this._bDisplaySignature=e},GetDisplaySignature:function(){return this._bDisplaySignature},SetValidSignature:function(e){this._bValidSignature=e},GetValidSignature:function(){return this._bValidSignature},SetDisplayTree:function(e){this._bDisplayTree=e},GetDisplayTree:function(){return this._bDisplayTree},SetValidDate:function(e){this._bValidDate=e},GetValidDate:function(){return this._bValidDate},SetDisplayTimeline:function(e){this._bDisplayTimeline=e},GetDisplayTimeline:function(){return this._bDisplayTimeline},SetDisplayPropertiesPanel:function(e){this._bDisplayPropertiesPanel=e},GetDisplayPropertiesPanel:function(){return this._bDisplayPropertiesPanel},SetDisplayScenariosPanel:function(e){this._bDisplayScenariosPanel=e},GetDisplayScenariosPanel:function(){return this._bDisplayScenariosPanel},SetDisplayPaper:function(e){this._bDisplayPaper=e},GetDisplayPaper:function(){return this._bDisplayPaper},GetType:function(){return"VCXDRMManager"}});return t.LitSignatureMode={LIT_SIGNATURE_DISPLAY_AND_BLOCK:0,LIT_SIGNATURE_DISPLAY_AND_PASS:1,LIT_SIGNATURE_NO_DISPLAY:2},t}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXWebSelectionManager",["require","exports","DS/VCXWebVisu/VCXModifiablesAccess","DS/VCXWebModifiablesServices/VCXModifiablesServices","DS/Core/Core","DS/CoreEvents/Events","DS/VCXWebComponents/VCXWebComponentBaseExperience"],(function(e,t,n,i,r,o,a){"use strict";r=__importDefault(r),o=__importDefault(o),a=__importDefault(a);class s extends a.default{constructor(){super(...arguments),this._WUXEventTokens={},this._defaultHLValue=!0,this._setComponents={},this._excludeParts=!1,this._excludeDressups=!1,this._keepLinkSelectable=!0,this._keepHotspotsSelectable=!0,this._keepAssemblySelectionModeActive=!1,this._keepPartListItemsSelectable=!0,this._keepSelectableItems=!1,this._apiCBAddSel=null,this._apiCBRemoveSel=null,this.original_HLData=null,this.original_PreHLData=null,this.PreHLData=null,this.HLData=null,this.LockVCXEvents=!1,this._componentsJustAdded=[],this._componentsJustRemoved=[]}postInitialize(){this._setComponents={},this.activatePrepicking(!0),this._defaultHLValue=!0;var e=this._experienceBase.getManager("VCXContextManager").getTrapSelectionRequirements();this.setTrapSelection(e.pick,e.prePick),this._excludeParts=!1,this._excludeDressups=!1,this._keepLinkSelectable=!0,this._keepHotspotsSelectable=!0,this._keepAssemblySelectionModeActive=!1,this._keepPartListItemsSelectable=!0,this._keepSelectableItems=!1,this.original_HLData=null,this.original_PreHLData=null,this._apiCBAddSel=null,this._apiCBRemoveSel=null,this._WUXEventTokens={},this._WUXEventTokens.VCX_VOLATILE_PERSISTENT_POST=o.default.subscribe({event:"VCX_VOLATILE_PERSISTENT_POST"},(e=>{let t=this._getSubStructNameFromComponent(e.component);!!this._setComponents[t][e.component.getPreviousComponentID()]&&(delete this._setComponents[t][e.component.getPreviousComponentID()],this._setComponents[t][e.component.GetID()]=e.component)})),this._WUXEventTokens.VCX_SELECTION_COMPONENTSLIST_ADD=o.default.subscribe({event:"VCX_SELECTION_COMPONENTSLIST_ADD"},(e=>{if(this._apiCBAddSel){for(var t=[],n=0;n<e.length;n++){var i=e[n];i&&t.push(i.GetID())}this._apiCBAddSel(t)}})),this._WUXEventTokens.VCX_SELECTION_COMPONENTSLIST_REMOVE=o.default.subscribe({event:"VCX_SELECTION_COMPONENTSLIST_REMOVE"},(e=>{if(this._apiCBRemoveSel){for(var t=[],n=0;n<e.length;n++){var i=e[n];i&&t.push(i.GetID())}this._apiCBRemoveSel(t)}})),this._WUXEventTokens.VCX_TEMPORARILY_HIDE_DECORATION=o.default.subscribe({event:"VCX_TEMPORARILY_HIDE_DECORATION"},(e=>{e&&e.viewer&&this.SetHighlightRenderVisibility(e.viewer,!1)})),this._WUXEventTokens.VCX_RESTORE_TEMPORARILY_HIDDEN_DECORATION=o.default.subscribe({event:"VCX_RESTORE_TEMPORARILY_HIDDEN_DECORATION"},(e=>{e&&e.viewer&&this.SetHighlightRenderVisibility(e.viewer,!0)})),this._WUXEventTokens.VCX_SELECTION_PREADD=o.default.subscribe({event:"VCX_SELECTION_PREADD"},this.filterWithModeSelection.bind(this)),this._WUXEventTokens.VCX_PREHIGHLIGHT_PREADD=o.default.subscribe({event:"VCX_PREHIGHLIGHT_PREADD"},this.filterWithModeSelection.bind(this)),this._WUXEventTokens.VCX_HIGHLIGHT_PREADD=o.default.subscribe({event:"VCX_HIGHLIGHT_PREADD"},this.filterWithModeSelection.bind(this))}filterWithModeSelection(e){if(e&&Array.isArray(e)){let r=Array.from(e);for(let o=r.length-1;o>=0;o--){var t=r[o].pathElement,i=n.GetModifiableFromPathElement(t,this._experienceBase);i&&!this.checkIsSelectable(i.GetObject())&&e.splice(o,1)}}}checkIsSelectable(e){if(this._keepSelectableItems){if(this._keepLinkSelectable&&e.hyperlinkID>=0)return!0;let t=this._experienceBase.getManager("VCXHotspotManager");if(this._keepHotspotsSelectable&&t&&t.GetEnabledHotspotFromComponentID(e.GetID()))return!0;let n=this._experienceBase.getManager("VCXComponentPartListManager");if(this.keepPartListItemsSelectable&&n&&n.isPartOfPartList(e))return!0}return e.IsKindOf("VCXDressup_Spec")?!this.excludeDressups:!e.IsKindOf("VCXComponentOccurrenceExt")||!this.excludeParts}unInitialize(){for(var e in this._WUXEventTokens)this._WUXEventTokens.hasOwnProperty(e)&&this._WUXEventTokens[e]&&(o.default.unsubscribe(this._WUXEventTokens[e]),delete this._WUXEventTokens[e]);r.default.Selection.CSOManager.empty(!1),r.default.Selection.HSOManager.empty(!1),r.default.Selection.PSOManager.empty(!1),this._setComponents={},this._apiCBAddSel=null,this._apiCBRemoveSel=null;const t=this._experienceBase.getManager("VCXContextManager").getMainViewer();t&&(this.SetHighlightRenderVisibility(t,!0),this.resetOverrideStyle(t,!0),this.resetOverrideStyle(t,!1))}_setStyleHighlight(e,t){var n=e.getHighlightData();let i=this._getStyleHighlight(e),r={...i,...t};return n.colorEnabled=r.colorEnabled,n.haloEnabled=r.haloEnabled,n.outlineEnabled=r.outlineEnabled,n.priority=r.priority,n.visibleAlpha=r.visibleAlpha,e.setHighlightData(r.polite,n),i}_getStyleHighlight(e){var t=e.getHighlightData();return{polite:e.advanced,colorEnabled:t.colorEnabled,haloEnabled:t.haloEnabled,outlineEnabled:t.outlineEnabled,priority:t.priority,visibleAlpha:t.visibleAlpha}}setOverrideStyle(e,t,n){let i=t?this.PreHLData:this.HLData,r=e&&e.internalSceneGraph&&e.internalSceneGraph&&(t?e.internalSceneGraph.selectionPreHL:e.internalSceneGraph.selectionHL);if(n.polite=r.advanced,!this.original_PreHLData&&t&&(this.original_PreHLData=this._getStyleHighlight(r)),this.original_HLData||t||(this.original_HLData=this._getStyleHighlight(r)),i){let e={...i};return t?this.PreHLData=n:this.HLData=n,e}return this._setStyleHighlight(r,n)}resetOverrideStyle(e,t){return this.original_PreHLData&&t?(this.setOverrideStyle(e,t,this.original_PreHLData),!0):!(!this.original_HLData||t)&&(this.setOverrideStyle(e,t,this.original_HLData),!0)}setPreHighlightVisibility(e,t){if(t){(n=e&&e.internalSceneGraph&&e.internalSceneGraph&&e.internalSceneGraph.selectionPreHL)&&this.PreHLData&&this._setStyleHighlight(n,this.PreHLData),this.PreHLData=null}else{var n=e&&e.internalSceneGraph&&e.internalSceneGraph&&e.internalSceneGraph.selectionPreHL;!this.PreHLData&&n&&(this.PreHLData=this._setStyleHighlight(n,{polite:n.advanced,colorEnabled:!1,haloEnabled:!1,outlineEnabled:!1,priority:-100}))}}setSelectionVisibility(e,t){if(t){(n=e&&e.internalSceneGraph&&e.internalSceneGraph&&e.internalSceneGraph.selectionHL)&&this.HLData&&this._setStyleHighlight(n,this.HLData),this.HLData=null}else{var n=e&&e.internalSceneGraph&&e.internalSceneGraph&&e.internalSceneGraph.selectionHL;!this.HLData&&n&&(this.HLData=this._setStyleHighlight(n,{polite:n.advanced,colorEnabled:!1,haloEnabled:!1,outlineEnabled:!1,priority:-100}))}}SetHighlightRenderVisibility(e,t){if(t){if(!this.LockVCXEvents)return;this.setPreHighlightVisibility(e,t),this.setSelectionVisibility(e,t),this.LockVCXEvents=!1}else{if(this.LockVCXEvents)return;this.LockVCXEvents=!0,this.setPreHighlightVisibility(e,t),this.setSelectionVisibility(e,t)}o.default.publish({event:"VCX_CHANGE_HIGHLIGHTS_VISIBILITY"})}RegisterAddSelectionCB(e){this._apiCBAddSel=e}RegisterRemoveSelectionCB(e){this._apiCBRemoveSel=e}_getSubStructNameFromComponent(e){var t="others";return e.IsKindOf("VCXScenario")?t="scenarios":e.QueryInterface("W3AISGNodeHolder")&&(t="visu"),this._setComponents[t]||(this._setComponents[t]={}),t}GetSelection(e){var t=null;"CSO"===e?t=r.default.Selection.CSOManager:"HSO"===e?t=r.default.Selection.HSOManager:"PSO"===e&&(t=r.default.Selection.PSOManager);var n=t?.get();return n}ProcessComponentsFromSelection(e,t){if(t)for(var n=this.GetComponentsFromSelection(e),i=0;i<n.length;i++)t(n[i])}ChangeSelectionForContextual(){this.GetComponentsFromSelection("PSO").length<1||this.addComponentsToSelection(this.GetComponentsFromSelection("PSO"))}GetComponentsFromSelection(e){if("CSO"===e)return this.GetComponentsFromCurrentSelection();var t=[],n=this.GetSelection(e);if(void 0===n)return t;for(var i={},r=n.length,o=0;o<r;o++){var a=n[o];if(void 0===a)continue;let e=this._experienceBase.ComponentsMap.GetComponentFromPathElement(a.pathElement);e||(e=this._experienceBase.getManager("VCXSelectManager").GetComponentFromPathElement(a.pathElement),e&&e.IsKindOf("VCXDressup_Spec")&&(e=null)),e&&!i[e.GetID()]&&(t.push(e),i[e.GetID()]=e)}return t}RefreshXSO(){}setComponentsAsSelection(e,t){if(this._experienceBase.odt){var n=this.GetComponentsFromCurrentSelection();this._logForODTRecord(n,!0)}this._setComponents={},this.addComponentsToSelection(e,!0),t||this.RefreshXSO()}addComponentsToSelection(e,t=!1){if(Array.isArray(e)){if(0!==e.length){"boolean"!=typeof t&&(t=!1);var n=[],i=[];if(this._keepAssemblySelectionModeActive){for(var r=0;r<e.length;++r){var a=e[r];if(a&&a.IsKindOf("VCXComponentOccurrenceExt")&&a.IsMesh()){var s,l=a.QueryInterface("VCXIModelNavigable").getParent();l&&(s=l.GetObject())&&(n.push(s),i.push(a))}}n.length<=0&&(n=e),this._addToSelectionCache(n)}else this._addToSelectionCache(e);if(0!==this._componentsJustAdded.length){var c=this._componentsJustAdded.slice(0);this._componentsJustAdded=[],t||this.RefreshXSO(),this.LockVCXEvents||(o.default.publish({event:"VCX_SELECTION_COMPONENTSLIST_ADD",data:c}),this._keepAssemblySelectionModeActive&&o.default.publish({event:"VCX_SELECTION_COMPONENTSLIST_REMOVE_FROM_TREE_ASSY_SEL",data:i})),this._experienceBase.odt&&this._logForODTRecord(c,!1)}}}else console.log("[VCXWebSelectionManager] An array is required as first argument of the 'addComponentsToSelection' method.")}removeComponentsFromSelection(e,t){if(Array.isArray(e)){if(0!==e.length&&("boolean"!=typeof t&&(t=!1),this._removeFromSelectionCache(e),0!==this._componentsJustRemoved.length)){var n=this._componentsJustRemoved.slice(0);this._componentsJustRemoved=[],t||this.RefreshXSO(),this.LockVCXEvents||o.default.publish({event:"VCX_SELECTION_COMPONENTSLIST_REMOVE",data:n}),this._experienceBase.odt&&this._logForODTRecord(n,!0),this.HasActors()||window.setTimeout((()=>{this.HasActors()||this.LockVCXEvents||o.default.publish({event:"VCX_SELECTED_ACTORS_EMPTY"})}),200)}}else console.log("[VCXWebSelectionManager] An array is required as first argument of the 'removeComponentsFromSelection' method.")}_alterSelectionCache(e,t){var n="_removeFromSelectionCache",i="_removeCompChildrenToSelectionCache";t&&(n="_addToSelectionCache",i="_addCompChildrenToSelectionCache");for(var r=0;r<e.length;++r){var o=e[r];if(o){var a=o.QueryInterface("VCXIModifiable"),s=o.QueryInterface("VCXISelectBehavior");if(s){var l=s.GetListForSelection();let e=l.indexOf(o);if(e>=0&&l.splice(e),l.length>0&&this[n](l),-1===e)continue}if(a){var c=o.GetID(),p=this._getSubStructNameFromComponent(o);c&&(t&&this._setComponents[p][c]!==o?(this._setComponents[p][c]=o,this._componentsJustAdded.push(o)):t||this._setComponents[p][c]!==o||(delete this._setComponents[p][c],this._componentsJustRemoved.push(o)))}else this[i](o)}}}_addToSelectionCache(e){this._alterSelectionCache(e,!0)}_removeFromSelectionCache(e){this._alterSelectionCache(e,!1)}_alterSelectionCacheWithCompChildren(e,t){for(var n=e.QueryInterface("VCXIModelNavigable"),i=n&&n.getChildren(),r=0;r<i.length;++r){var o=i[r].GetObject(),a=o.GetID();if(a){var s=this._getSubStructNameFromComponent(o);t&&this._setComponents[s][a]!==o?(this._setComponents[s][a]=o,this._componentsJustAdded.push(o)):t||this._setComponents[s][a]!==o||(delete this._setComponents[s][a],this._componentsJustRemoved.push(o))}}}_addCompChildrenToSelectionCache(e){this._alterSelectionCacheWithCompChildren(e,!0)}_removeCompChildrenToSelectionCache(e){this._alterSelectionCacheWithCompChildren(e,!1)}HasActors(){for(var e=this.GetComponentsFromCurrentSelection(),t=0;t<e.length;t++){var n=e[t];if(n.IsKindOf("VCXDressup_Spec")||n.IsKindOf("VCXWebComponentOccurrence"))return!0}return!1}HasOccurence(){let e=!1;return this.GetComponentsFromCurrentSelection("VCXWebComponentOccurrence",(()=>(e=!0,!1))),e}GetComponentsFromCurrentSelection(e,t){if("VCXScenario"===e)return this.GetScenariosComponentsFromCurrentSelection();var n=[];for(var i in this._setComponents)if(this._setComponents.hasOwnProperty(i)){var r=this._setComponents[i];for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];if(!a)continue;var s=!0;if(e&&(a.IsKindOf(e)||(s=!1)),s)if(t){if(t(a))return[]}else n.push(a)}}return n}GetScenariosComponentsFromCurrentSelection(){var e=[];if(this._setComponents.scenarios)for(var t in this._setComponents.scenarios)if(this._setComponents.scenarios.hasOwnProperty(t)){var n=this._setComponents.scenarios[t];n&&e.push(n)}return e}GetSGComponentsFromCurrentSelection(){var e=[];if(this._setComponents.visu)for(var t in this._setComponents.visu)if(this._setComponents.visu.hasOwnProperty(t)){var n=this._setComponents.visu[t];n&&e.push(n)}return e}isIn(e){var t=e;if(t.QueryInterface("VCXIModifiable")){var n=!1;for(var i in this._setComponents)if(this._setComponents.hasOwnProperty(i)){var r=this._setComponents[i];if(n=n||r.hasOwnProperty(t.GetID()))break}return n}}setTrapSelection(e,t){"boolean"==typeof e?(this._experienceBase.getManager("VCXContextManager").getMainViewer()?.setPicking({trapSelection:e,trapPrimitive:!1,trapGPU:!0}),e&&"boolean"==typeof t&&this._experienceBase.getManager("VCXContextManager").getMainViewer()?.setPrePicking({trapSelection:t,trapPrimitive:!1})):console.warn("[VCXWebSelectionManager] Method setTrapSelection: a boolean is needed as first argument")}activatePrepicking(e){this._experienceBase.getManager("VCXContextManager").getMainViewer()?.setPrePicking({activated:e})}setDefaultHighlightValue(e){this._defaultHLValue=e}getDefaultHighlightValue(){return this._defaultHLValue}_logForODTRecord(e,t){for(var n=[],i=0;i<e.length;++i){var r=e[i];if(!r||"VCXComponentHotspot"!==r.GetType()){var o=r&&r.GetID();o&&n.push(o)}}if("record"===this._experienceBase.odt){var a=this._experienceBase.getManager("VCXODTManager");a._isActivatingSelSetHotspotGr||a.LogAPI(t?"VCXRemoveSelection":"VCXAddSelection",n)}else this._experienceBase.odt}buildXSOfilter(){const e=[r.default.Selection.CSOManager,r.default.Selection.HSOManager,r.default.Selection.PSOManager];for(let r of e){let e=r.get(),o=[];for(let r of e){var t=r.pathElement,i=n.GetModifiableFromPathElement(t,this._experienceBase);i&&!this.checkIsSelectable(i.GetObject())&&o.push(r)}r.remove(o)}}get componentType(){return"VCXWebSelectionManager"}get excludeDressups(){return this._excludeDressups}set excludeDressups(e){this._excludeDressups=e,this.buildXSOfilter()}get excludeParts(){return this._excludeParts}set excludeParts(e){this._excludeParts=e,this.buildXSOfilter()}get keepLinkSelectable(){return this._keepLinkSelectable}set keepLinkSelectable(e){this._keepLinkSelectable=e,this.buildXSOfilter()}get keepHotspotsSelectable(){return this._keepHotspotsSelectable}set keepHotspotsSelectable(e){this._keepHotspotsSelectable=e,this.buildXSOfilter()}get keepPartListItemsSelectable(){return this._keepPartListItemsSelectable}set keepPartListItemsSelectable(e){this._keepPartListItemsSelectable=e,this.buildXSOfilter()}get keepAssemblySelectionModeActive(){return this._keepAssemblySelectionModeActive}set keepAssemblySelectionModeActive(e){this._keepAssemblySelectionModeActive=e}get keepSelectableItems(){return this._keepSelectableItems}set keepSelectableItems(e){this._keepSelectableItems=e}}return s})),define("DS/VCXWebKernel/VCXIContextualContent",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("DS/VCXWebKernel/VCXModifiableActorList",["DS/VCXWebExperienceBase/VCXModifiableOccurrenceExperience","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyGroupSet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueLink","DS/VCXWebProperties/VCXPropertyValueMap","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],(function(e,t,n,i,r,o,a,s,l){"use strict";return e.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,n){if(n||(n={}),n.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;var i=t.GetValue();if("Actor.Enable"===e)this.GetObject().enable!==i&&(this.GetObject().enable=i);else if("Actor.ListActors"===e){let e=[...this.GetObject().GetArrayActors()];for(var r=t.GetValue(),o=0;o<r.length;o++){for(var a=r[o].GetValue(),s=0;s<e.length;s++){if(e[s]===a){e.splice(s,1);break}}this.GetObject().AddActor(a)}for(o=0;o<e.length;o++)this.GetObject().RemoveActor(e[o]);this._listActorsEdited=!0}else{if("Actor.GroupID"!==e){n.fromChildClass=!0;var l=this._parent(e,t,n);return l||console.log("property not found : '"+e+"'"),l}this.GetObject()._groupID=t.GetValue()}return!0},GetProperty:function(e){var t=null;if("Actor.Enable"===e){var n=new o;n.SetValue(this.GetObject().enable),t=new i(new r(e,2,!0,l),n)}else if("Actor.ListActors"===e){var c=new s;let n=this.GetObject().GetArrayActors().map((e=>{let t=new a;return t.SetValue(e),t}));c.SetValue(n),(p=new r(e,2,!0,l)).SetVisible(!1),t=new i(p,c)}else if("Actor.GroupID"===e){var p,h=new a,u=this.GetObject()._groupID;u&&h.SetValue(u),(p=new r(e,0,!0,l)).SetVisible(!1),t=new i(p,h)}else t=this._parent(e);return t},GetProperties:function(){var e=new t;return e.AddOrModifyProperty(this.GetProperty("Actor.Name")),e.AddOrModifyProperty(this.GetProperty("Actor.Color")),e.AddOrModifyProperty(this.GetProperty("Actor.Enable")),e.AddOrModifyProperty(this.GetProperty("Actor.ToolTip")),e.AddOrModifyProperty(this.GetProperty("Actor.Hyperlink")),e.AddOrModifyProperty(this.GetProperty("Actor.ListActors")),e}})})),define("DS/VCXWebKernel/VCXComponentMarker",["UWA/Class"],(function(e){"use strict";var t=e.extend({init:function(){this._parentScenarioID="",this._timePos=null,this._isMileStone=!1,this._name=null},GetType:function(){return this.componentType},SetName:function(e){this.name!==e&&(this.name=e)},GetName:function(){return this.name},GetTimePos:function(){return this.timePos},IsMilestone:function(){return this.isMileStone},SetParentScenario:function(e){this._parentScenarioID=e},GetParentScenario:function(){return this._parentScenarioID}});return Object.defineProperty(t.prototype,"name",{enumerable:!0,get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e)}}),Object.defineProperty(t.prototype,"timePos",{enumerable:!0,get:function(){return this._timePos},set:function(e){this._timePos=e}}),Object.defineProperty(t.prototype,"isMileStone",{enumerable:!0,get:function(){return this._isMileStone},set:function(e){this._isMileStone=e}}),Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentMarker"}}),t})),define("DS/VCXWebKernel/VCXIMagnetLine",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("DS/VCXWebKernel/VCXModifiableViewActorList",["DS/VCXWebExperienceBase/VCXModifiableViewOccurrenceExperience"],(function(e){"use strict";return e.extend({init:function(){this._parent()},getPropertyGroups:function(e){e||(e={}),this._parent(e);this.getGroupPropertiesOrders();return e["Group.Essentials"].removeProperty("Actor.Opacity"),e}})})),define("DS/VCXWebKernel/VCXAMagnetLine",["UWA/Class"],(function(e){"use strict";return e.extend({isMagnetizable:function(){return!1}})})),define("DS/VCXWebKernel/VCXICuttableObject",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("DS/VCXWebKernel/VCXActorDocManager",["UWA/Class","DS/VCXWebIO/VCXFileServices"],(function(e,t){"use strict";var n=e.extend({init:function(){this._mapDataB64=[]},Build:function(){this._experienceBase.getManager("VCXDocManager").actorDocManager=this},GetType:function(){return this.componentType},RemoveDocument:function(e){delete this._mapDataB64[e]},AddDocToBase64Map:function(e,n,i){if(void 0===i){var r=this,o=n.GetValueURL().GetValue(),a=n.GetFileName().GetValue();t.BlobURLToBase64(o,a,(function(e,t){e&&(r._mapDataB64[t]=e)}),e)}else this._mapDataB64[e]=i}});return Object.defineProperty(n.prototype,"componentType",{enumerable:!0,get:function(){return"VCXActorDocManager"}}),n})),define("DS/VCXWebKernel/VCXIMaterialCache",["require","exports"],(function(e,t){"use strict";var n;return function(e){e.name="VCXIMaterialCache"}(n||(n={})),n})),define("DS/VCXWebKernel/ExpTrackManager_Spec",["UWA/Class"],(function(e){"use strict";var t=e.extend({init:function(){},GetType:function(){return this.componentType}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"ExpTrackManager_Spec"}}),t})),define("DS/VCXWebKernel/VCXModifiableActorDocManager",["UWA/Core","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyValueMap","DS/VCXWebProperties/VCXPropertyValueBin","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValuePath","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueDocId","DS/VCXWebIO/VCXFileServices","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],(function(e,t,n,i,r,o,a,s,l,c,p,h,u,d){"use strict";return t.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,n){if(n||(n={}),n.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;switch(e){case"DocManager.defaultIndex":var i=this.GetObject()._experienceBase.getManager("VCXDocManager");console.log("DocManager.defaultIndex = "+t.GetValue()),i.SetDefaultImageIndex(t.GetValue());break;case"DocManager.documents":console.log("Initialization of DocManager from VCXModifiableActorDocManager"),console.log("onchange property with DocManager.documents");i=this.GetObject()._experienceBase.getManager("VCXDocManager");if(t instanceof o)for(var r=0;r<t._value.length;r++){var a=t._value[r];if(a){var s=new c;a.GetValueAtIndex(0)&&s.SetPathType(a.GetValueAtIndex(0)),a.GetValueAtIndex(2)&&s.SetFileName(a.GetValueAtIndex(2)),a.GetValueAtIndex(3)&&s.SetValueLink(a.GetValueAtIndex(3));var h=new p;h.SetValue(!0),s.SetValueBool(h),a.GetValueAtIndex(4)&&s.SetDocIdParent(a.GetValueAtIndex(4));var d=a.GetValueAtIndex(1);s.SetValueURL(d);var m=a.GetValueAtIndex(5);if(m){var C="data:"+d.GetValue()+";base64,"+m.GetValue(),g=u.dataURLToBlob(C),f=window.URL.createObjectURL(g),S=new l;S.SetValue(f),console.log("-------- DOC blobURL ="+f+"\n"),s.SetValueURL(S),!this.GetObject()._experienceBase.getManager("VCXContextManager").IsLocalMode()&&this.GetObject()._experienceBase.getManager("VCXContextManager").getUseResourcesManager()||(i.actorDocManager._mapDataB64[r]=C)}i._map[r]=s}}break;default:return n.fromChildClass=!0,this._parent(e,t,n)}return!0},OnChangePropertiesEnd:function(){},GetProperty:function(e){var t=null;if("DocManager.defaultIndex"===e){var r=new s,c=this.GetObject()._experienceBase.getManager("VCXDocManager");r.SetValue(c.GetDefaultImageIndex()),t=new n(new i(e,i.EBehaviorType.Singleton),r)}else if("DocManager.documents"===e){c=this.GetObject()._experienceBase.getManager("VCXDocManager");for(var p=new o,h=c.NumberOfDoc(),u=0;u<h;u++){var m=c.GetPropPath(u);if(m)if(m.GetValueBool().GetValue()){var C=new o;if(C.SetValueAtIndex(0,m.GetPathType()),C.SetValueAtIndex(2,m.GetFileName()),C.SetValueAtIndex(3,m.GetValueLink()),C.SetValueAtIndex(4,m.GetDocIdParent()),m.GetValueURL().GetValue().indexOf("blob:")>=0){var g=c.actorDocManager._mapDataB64[u];if(g){var f=g.split(";base64,"),S=f[0].split(":")[1],_=new a;_.SetValue(f[1]),C.SetValueAtIndex(5,_);var V=new l;V.SetValue(S),C.SetValueAtIndex(1,V)}else console.log("docmanager : BAD base64 cache !!")}else C.SetValueAtIndex(1,m.GetValueURL());p.SetValueAtIndex(u,C)}}var b=new i(e,i.EBehaviorType.Singleton,!0,d);b.SetVisible(!1),t=new n(b,p)}else t=this._parent(e);return t},GetProperties:function(){var e=this._parent();return!this.GetObject()._experienceBase.getManager("VCXContextManager").IsLocalMode()&&this.GetObject()._experienceBase.getManager("VCXContextManager").getUseResourcesManager()||e.AddOrModifyProperty(this.GetProperty("DocManager.documents")),e.AddOrModifyProperty(this.GetProperty("DocManager.defaultIndex")),e}})})),define("DS/VCXWebKernel/VCXModifiableSelectionManager",["UWA/Core","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueMap","DS/VCXWebProperties/VCXPropertyValueLink"],(function(e,t,n,i,r,o,a){"use strict";return t.extend({init:function(){this._parent()},GetListSelection:function(){return this.GetObject().GetComponentsFromSelection("CSO")},GetProperty:function(e){var t=null;if("SelectionManager.ListCSO"===e){for(var n=this.GetListSelection(),s=[],l=0;l<n.length;l++){var c=n[l].GetID();s.push(c)}var p=new o,h=0;s.sort();for(l=0;l<s.length;l++){c=s[l];var u=new a;u.SetValue(c),p.SetValueAtIndex(h,u),h++}t=new i(new r(e,2),p)}return t},GetProperties:function(){var e=new n;return e.AddOrModifyProperty(this.GetProperty("SelectionManager.ListCSO")),e}})})),define("DS/VCXWebKernel/VCXModifiableHotspot",["DS/VCXWebKernel/VCXModifiableActorList","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueHyperlinkId","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueColor","DS/VCXWebProperties/VCXPropertyValueMap","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],(function(e,t,n,i,r,o,a,s,l,c){"use strict";return e.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,n){if(n||(n={}),n.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;if("highlight.color"!==e){n.fromChildClass=!0;var i=this._parent(e,t,n);return i||console.log("property not found : '"+e+"'"),i}return this.GetObject().highlight=t.GetValue()[0],!0},OnChangePropertiesEnd:function(){if(this._previousEnableValue!==this.GetProperty("Actor.Enable").GetPropertyValue().Value){this._previousEnableValue=this.GetProperty("Actor.Enable").GetPropertyValue().Value;var e=this.GetObject()._experienceBase.getManager("VCXSelectionManager");e&&e.buildXSOfilter&&e.buildXSOfilter()}this._parent()},GetProperty:function(e){var t=null;if("highlight.color"===e){if(this.GetObject().highlight){var r=new s,o=this.GetObject().highlight.getColorHighlight();o&&r.GetValue().SetThreeColor(o.color);var a=new i(e,2,!0,c);t=new n(a,r)}}else"highlight.color.actors"===e||(t=this._parent(e));return t},GetProperties:function(){var e=this._parent();return this.GetObject()._experienceBase.odt&&(e.AddOrModifyProperty(this.GetProperty("highlight.color")),e.AddOrModifyProperty(this.GetProperty("highlight.color.actors"))),e}})})),define("DS/VCXWebKernel/VCXSelectManager",["DS/Core/Core","DS/CoreEvents/Events","DS/VCXWebKernel/VCXCmdChangeSelection","UWA/Class","DS/VCXWebSystem/VCXAdvancedEventService","DS/Visualization/PathElement"],(function(e,t,n,i,r,o){"use strict";let a=[e.Selection.CSOManager,e.Selection.HSOManager,e.Selection.PSOManager];for(let e of a)e.__proto__._add=e.__proto__.add,e.__proto__.add=function(e){const t=Array.isArray(e)?e:[e];this._add(t)};var s={add:"onAdd",postAdd:"onPostAdd",preAdd:"onPreAdd",preRemove:"onPreRemove",remove:"onRemove",postRemove:"onPostRemove",preEmpty:"onPreEmpty",empty:"onEmpty"};Object.freeze(s);var l=i.extend({postInitialize:function(){this._subscribeEvents(),this._excludedFromXSOHyperlinksPathes=[],this._componentsToAdd=[],this._componentsToRemove=[],this.blockedCBFlags={SELECTION:1,HIGHLIGHT:2,PREHIGHLIGHT:4},this.blockedCBEvents={add:0,postAdd:0,preAdd:0,preRemove:0,preRemove:0,remove:0,postRemove:0,preEmpty:0,empty:0},this._selectionManager=this._experienceBase.getManager("VCXSelectionManager")},getInitPhase:function(){return 9},GetComponentFromPathElement:function(e){if(!e||!e.externalPath||e.externalPath.length<2)return null;let t=e.clone();const n=t.externalPath[t.externalPath.length-1];n.userData&&1===n.children.length&&n.userData.type.includes("Inst")&&t.addElement(n.children[0]);let i=null;for(;!i&&t&&t.externalPath&&t.externalPath.length>1;)i=this._experienceBase.ComponentsMap.GetComponentFromPathElement(t),t.externalPath.pop();return i},unableSelectionInPlayMode:function(){this._experienceBase.getManager("VCXContextManager").getMainViewer().setPicking({activated:!1}),this._experienceBase.getManager("VCXContextManager").getMainViewer().setPrePicking({activated:!1})},lockSelection:function(e){this._experienceBase.getManager("VCXContextManager").getMainViewer().setPicking({activated:!e}),this._experienceBase.getManager("VCXContextManager").getMainViewer().setPrePicking({activated:!e}),this._masterLock=e,e?this.blockEventCallback("all","SELECTION"):this.unblockEventCallback("all","SELECTION"),e?this.blockEventCallback("all","HIGHLIGHT"):this.unblockEventCallback("all","HIGHLIGHT"),e?this.blockEventCallback("all","PREHIGHLIGHT"):this.unblockEventCallback("all","PREHIGHLIGHT"),t.publish({event:"VCX_LOCK_SELECTION",data:{lock:e}})},blockEventCallback:function(e,t){if("all"===e)for(var n=Object.keys(this.blockedCBEvents),i=0;i<n.length;++i){var r=n[i];this.blockedCBEvents[r]=this.blockedCBEvents[r]|this.blockedCBFlags[t]}else this.blockedCBEvents.hasOwnProperty(e)&&(this.blockedCBEvents[e]=this.blockedCBEvents[e]|this.blockedCBFlags[t])},unblockEventCallback:function(e,t){if(!this._masterLock)if("all"===e)for(var n=Object.keys(this.blockedCBEvents),i=0;i<n.length;++i){var r=n[i];this.blockedCBEvents[r]=this.blockedCBEvents[r]&~this.blockedCBFlags[t]}else this.blockedCBEvents.hasOwnProperty(e)&&(this.blockedCBEvents[e]=this.blockedCBEvents[e]&~this.blockedCBFlags[t])},isEventCallbackBlocked:function(e,t){return Boolean(this.blockedCBEvents[e]&this.blockedCBFlags[t])},_subscribeEvents:function(){var t=e.Selection.CSOManager,n=e.Selection.HSOManager,i=e.Selection.PSOManager,r=this,o=function(e,t){var n=s[e];return function(i){r.isEventCallbackBlocked(e,t)||r[n](i,t)}};this._xsoEventSubscrArray={CSO:[],HSO:[],PSO:[]};for(var a=Object.keys(s),l=0;l<a.length;++l){var c=a[l],p=s[c];this._xsoEventSubscrArray.CSO.push(t[p](o(c,"SELECTION"))),this._xsoEventSubscrArray.HSO.push(n[p](o(c,"HIGHLIGHT"))),this._xsoEventSubscrArray.PSO.push(i[p](o(c,"PREHIGHLIGHT")))}},_unsubscribeEvents:function(){var t={CSO:e.Selection.CSOManager,HSO:e.Selection.HSOManager,PSO:e.Selection.PSOManager},n=[];for(this._xsoEventSubscrArray&&(n=Object.keys(this._xsoEventSubscrArray));0!==n.length;){for(var i=0;i<n.length;++i){var r=n[i],o=this._xsoEventSubscrArray[r].pop();t[r].unsubscribe(o),0===this._xsoEventSubscrArray[r].length&&delete this._xsoEventSubscrArray[r]}n=Object.keys(this._xsoEventSubscrArray)}},unInitialize:function(){this._unsubscribeEvents(),this._selectionManager=null},switchSensibilityForPreviewHyperlinks:function(e,t){if(e&&"boolean"==typeof t){var n=this.GetComponentFromPathElement(e);if(n&&n.QueryInterface){var i=null;if(t)(i=n.QueryInterface("VCXISensible"))&&(i.setSelectable(t),i.setHighlightable(t));else this._experienceBase.getManager("VCXHyperlinkManager").ObjectHasHyperlink(n)&&(i=n.QueryInterface("VCXISensible"))&&(i.setSelectable(t),i.setHighlightable(t))}}},switchOnSensibilityForAllHyperlinks:function(){for(;0!==this._excludedFromXSOHyperlinksPathes.length;){var e=this._excludedFromXSOHyperlinksPathes.pop();this.switchSensibilityForPreviewHyperlinks(e,!0)}},_storeToAddCompFromPathElement:function(e){var t=this.GetComponentFromPathElement(e);if(t&&t.QueryInterface){var n=!1,i=this._experienceBase.getManager("VCXHotspotManager").GetEnabledHotspotFromComponentID(t.GetID(),!0);if(i&&(n=!0,this._experienceBase.getManager("VCXHotspotManager").DeactivateAllHotspots(),this._experienceBase.getManager("VCXHotspotManager").DeactivateAllHotspots(!0),this._experienceBase.getManager("VCXAPIManager").SelectHotspot(i.GetID())),!n){var r=t.QueryInterface("VCXISensible");r&&r.getSelectable()&&(this._selectionManager.isIn(t)||this._componentsToAdd.push(t))}}},_storeToRemoveCompFromPathElement:function(e){var t=this.GetComponentFromPathElement(e);t&&this._selectionManager.isIn(t)&&this._componentsToRemove.push(t)},onAdd:function(e,t){var n=null;let i=this._experienceBase.getManager("VCXHyperlinkManager");i&&i.isActive()&&"PREHIGHLIGHT"===t?(n=e).pathElement&&(this.switchSensibilityForPreviewHyperlinks(n.pathElement,!1),this._excludedFromXSOHyperlinksPathes.push(n.pathElement)):"SELECTION"===t&&(n=e).pathElement&&this._storeToAddCompFromPathElement(n.pathElement)},onPostAdd:function(e,i){if("SELECTION"!==i)0!==e.length&&t.publish({event:"VCX_"+i+"_ADD",data:e});else if("SELECTION"===i&&0!==this._componentsToAdd.length){var r=new n(this._experienceBase,!0);r.AddComponentsToSelection(this._componentsToAdd),this._experienceBase.getManager("VCXCommandManager").Do(r),t.publish({event:"VCXActiveCardMATERIAL",data:null})}this._componentsToAdd=[]},onRemove:function(e,t){var n=null;let i=this._experienceBase.getManager("VCXHyperlinkManager");if(i&&i.isActive()&&"PREHIGHLIGHT"===t){var r=null;(n=e).pathElement&&(this.switchSensibilityForPreviewHyperlinks(n.pathElement,!0),r=this._excludedFromXSOHyperlinksPathes.indexOf(n.pathElement),this._excludedFromXSOHyperlinksPathes.splice(r,1))}else"SELECTION"===t&&(n=e).pathElement&&this._storeToRemoveCompFromPathElement(n.pathElement)},onPreAdd:function(e,t){r.publish({event:"VCX_"+t+"_PREADD",data:e})},onPreRemove:function(e,t){r.publish({event:"VCX_"+t+"_PREREMOVE",data:e})},onPostRemove:function(e,i){if("SELECTION"!==i)0!==e.length&&t.publish({event:"VCX_"+i+"_REMOVE",data:e});else if("SELECTION"===i&&this._componentsToRemove&&0!==this._componentsToRemove.length){var r=new n(this._experienceBase,!0);r.RemoveComponentsFromSelection(this._componentsToRemove),this._experienceBase.getManager("VCXCommandManager").Do(r)}this._componentsToRemove=[]},onPreEmpty:function(e,n){this.blockEventCallback("remove",n),t.publish({event:"VCX_"+n+"_PREEMPTY",data:e})},onEmpty:function(e,i){let r=this._experienceBase.getManager("VCXHyperlinkManager");if(r&&r.isActive()&&"PREHIGHLIGHT"===i)this.switchOnSensibilityForAllHyperlinks();else if("SELECTION"===i){var o=this._selectionManager.GetSGComponentsFromCurrentSelection();if(0!==o.length){var a=new n(this._experienceBase,!0);a.RemoveComponentsFromSelection(o),this._experienceBase.getManager("VCXCommandManager").Do(a)}}t.publish({event:"VCX_"+i+"_EMPTY",data:e}),this.unblockEventCallback("remove",i)}});return Object.defineProperty(l.prototype,"componentType",{enumerable:!0,get:function(){return"VCXSelectManager"}}),l}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXComponentHotspot",["require","exports","DS/VCXWebKernel/VCXActorList_Spec"],(function(e,t,n){"use strict";n=__importDefault(n);class i extends n.default{constructor(){super(),this._highlight=null,this._alpha=null}AddActor(e){for(var t=!1,n=0;n<this._arrayActors.length;n++){if(this._arrayActors[n]===e){t=!0;break}}if(!t){this._arrayActors.push(e);var i=this._experienceBase.getManager("VCXHotspotManager");i&&i.addComponentToMapPrehighlight(e,this)}}RemoveActor(e){for(var t=0;t<this._arrayActors.length;t++){if(this._arrayActors[t]===e){this._arrayActors.splice(t,1);break}}}get highlight(){return this._highlight}set highlight(e){this._highlight=e}}return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentHotspot"}}),i})),define("DS/VCXWebKernel/VCXAPIManager",["DS/CoreEvents/Events","UWA/Class","DS/VCXWebKernel/VCXCmdChangeSelection","DS/VCXWebKernelCommands/VCXCmdChangeTimePos","DS/VCXWebKernel/VCXCmdGoToMarker","DS/VCXWebKernelCommands/VCXCmdChangePropertiesAutokey","DS/VCXWebProperties/VCXPropertyMap","DS/VCXWebExperienceLoader/VCXExperienceSaverBase","DS/VCXWebExperienceLoader/VCXExperienceLoaderBase","DS/VCXWebKernelCommands/VCXCmdChangeVisibility","DS/VCXWebVisibility/VCXIVisibility","DS/Visualization/ThreeJS_DS","DS/Animation/PropertyAnimation"],(function(e,t,n,i,r,o,a,s,l,c,p,h,u){"use strict";var d,m=t.extend({initialize:function(){this._experienceSaver=new s,this._experienceLoader=new l,this._experienceLoader.InitLoader(this._experienceBase),this._buildInfo=null,this.frameWindow=this._experienceBase.getManager("VCXContextManager").getFrameWindow(),this.rotationQueue=[],this._isReadyForPlaneRotation=!0,this.ang=0,this.isrotating=!1,this.time=0,this.rotationflag=0,this.pos="",d=this},unInitialize:function(){this._experienceSaver=null,this._experienceLoader=null,this.viewControl=null},GoToScenario:function(e,t){if(e)return this._experienceBase.getManager("VCXGUIManager").GoToScenarioContext()?new Promise((n=>{this._experienceBase.getManager("VCXExperience").GoToScenarioWithInterpolation(e,(()=>{t&&t(),n()}))})):void 0},HasAnimation:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(t)return t.HasAnimation();console.log("APIManager:: HasAnimation. Scenario not found.")},AxisRotation:function(e,t,n,i,r){if(d._isReadyForPlaneRotation){function o(e,i,r){if(null!==this.control&&1==r){var o=new function(){var i;i="y"==t||"Y"==t?new h.Vector3(0,1,0):"x"==t||"X"==t?new h.Vector3(0,0,-1.55):"-x"==t||"-X"==t?new h.Vector3(0,0,1.55):"-y"==t||"-Y"==t?new h.Vector3(0,0,3.12):"-z"==t||"-Z"==t?new h.Vector3(-1.6,1,0):new h.Vector3(1.6,2,0),this._orientation=(new h.Quaternion).setFromEuler(i,"XYZ"),this._key1=new h.Quaternion;var r,o,a=0,s=0,l=0;"-x"==t||"-X"==t||"x"==t||"X"==t?a=1*n:"-y"==t||"-Y"==t||"y"==t||"Y"==t?s=1*n:l=1*n,this._key2=(new h.Quaternion).setFromAxisAngle(new h.Vector3(a,s,l),Math.PI/2),this._key3=(new h.Quaternion).setFromAxisAngle(new h.Vector3(a,s,l),Math.PI),this._key4=(new h.Quaternion).setFromAxisAngle(new h.Vector3(a,s,l),3*Math.PI/2),this._duration=e,this.duration=function(){return this._duration},this.valueAt=function(e){r=(new Date).getTime();var t,n,i,a,s=this._duration;let l=e%s/s;return l>=0&&l<.25?(o=(new Date).getTime(),t=this._key1,n=this._key2,a=l/.25):l>=.25&&l<.5?(o=(new Date).getTime(),t=this._key2,n=this._key3,a=(l-.25)/.25):l>=.5&&l<.75?(o=(new Date).getTime(),t=this._key3,n=this._key4,a=(l-.5)/.25):(o=(new Date).getTime(),t=this._key4,n=this._key1,a=(l-.75)/.25),i=new h.Quaternion,h.Quaternion.slerp(t,n,i,a),console.log(o-r),i.multiply(this._orientation)}};d.anim=new u(this.control,"orientation",o),1==i&&d.anim.setLoop(1),0==d.isrotating&&(d.anim.start(),d.isrotating=!0)}}return 1==e&&0==d.isrotating?(this.view=this._experienceBase.getManager("VCXContextManager").getMainViewer().currentViewpoint,this.view.rotate=o,this.view.rotate(1e3*i,r,1),0==r&&(d.isrotating=!1),-1==n&&(d.pos=" Reverse "),d.pos+"Rotation Started along "+t+" axis"):1==e&&1==d.isrotating?"Rotation along an axis already running":0==e&&1==d.isrotating?(d.anim.stop(),d.isrotating=!1,"Rotation along axis Stoped"):"NO Rotations Detected"}return"Rotation along a Plane already running"},start_plane_rotation:function(e,t){e.normalize(),t.normalize(),0==d.time&&(d.time=5.5),d._isReadyForPlaneRotation=!1;var n=Math.acos(t.dot(e))*(180/Math.PI),i=Math.floor(Math.abs(n)),r=n-i,o=0,a=t.cross(e);a.normalize();var s=function(){var e=(new h.Quaternion).setFromAxisAngle(a,-d.time*(Math.PI/180)),t=i-o;if(t>=d.time?e.setFromAxisAngle(a,-d.time*(Math.PI/180)):t<d.time?e.setFromAxisAngle(a,-t*(Math.PI/180)):o>i&&e.setFromAxisAngle(a,-r*(Math.PI/180)),d.viewControl&&d.viewControl.orientation.multiplyQuaternions(e,d.viewControl.orientation.clone()),d.viewControl&&d.viewControl.update(),d.frameWindow.getViewer().render(),0!=d.rotation_flag)return(i=360)-o>=d.time?0!=d.loop_flag?o=d.time:o+=d.time:o=360,o<360?void requestAnimationFrame(s):(d._isReadyForPlaneRotation=!0,"Rotation Ended")};s()},PlaneRotation:function(e,t,n,i,r){if(0==d.isrotating){var o,a={};d.frameWindow=d._experienceBase.getManager("VCXContextManager").getFrameWindow(),d.viewpoint=d._experienceBase.getManager("VCXContextManager").getFrameWindow().getViewpoint(),d.viewControl=d.viewpoint.getControl(),d.loop_flag=r,d.rotation_flag=e,d.ang=360,d._isReadyForPlaneRotation?(i>0&&(d.time=6/i),-1==n?"v"==t||"V"==t?(a={from:d.viewpoint.getSightDirection(),to:d.viewpoint.getUpDirection()},o="Rotation in Vertical(-) Direction Started"):"h"!=t&&"H"!=t||(a={from:d.viewpoint.getSightDirection(),to:d.viewpoint.getSightDirection().clone().cross(d.viewpoint.getUpDirection())},o="Rotation in Horizontal(-) Direction Started"):"v"==t||"V"==t?(a={from:d.viewpoint.getSightDirection(),to:d.viewpoint.getUpDirection().multiplyScalar(-1)},o="Rotation in Vertical Direction Started"):"h"!=t&&"H"!=t||(a={from:d.viewpoint.getSightDirection(),to:d.viewpoint.getUpDirection().cross(d.viewpoint.getSightDirection())},o="Rotation in Horizontal Direction Started"),a.from&&a.to&&d.start_plane_rotation(a.from,a.to)):o="Rotation along a Plane already running "}else o="Rotation along an Axis already Running";return o},StopRotation:function(){return 1==d.rotation_flag?(d.rotation_flag=0,d._isReadyForPlaneRotation=!0,"Rotation along plane Stoped"):this.AxisRotation(0)},PlayAnimation:async function(t){return new Promise((n=>{var i=this,r=this._experienceBase.getManager("VCXScenarioManager"),o=r.GetCurrentScenario();if(t){if(t===o&&this._experienceBase.getManager("VCXScenarioManager").GetIsPlayingCurrentScenario())return}else t=o;var a=this._experienceBase.ComponentsMap.GetComponentFromID(t);a||console.log("VCXAPIManager : NO scenario for PlayAnimation");var s=function(){if(a.HasAnimation()){e.publish({event:"VCX_START_PLAY"});var t=i._experienceBase.getManager("VCXContextManager");t&&("0"==t.getUrlVars().boost||a.BuildAnimatedModifiablesSets(r._keyframer)),r.SetIsPlayingCurrentScenario(!0),n()}},l=function(){r.GetCurrentScenario()!==t?i.GoToScenario(t,s):s()};this._experienceBase.getManager("VVCXPulseManager")&&this._experienceBase.getManager("VCXPulseManager").isActive()?this._experienceBase.getManager("VCXPulseManager").StopPulse(l):l()}))},PauseAnimation:function(){var t=this._experienceBase.getManager("VCXScenarioManager");t.GetIsPlayingCurrentScenario()&&(t.SetIsPlayingCurrentScenario(!1),e.publish({event:"VCX_PAUSE_PLAY"}))},StopAnimation:function(){var t=this._experienceBase.getManager("VCXScenarioManager");if(t.GetIsPlayingCurrentScenario()){var n=t.GetCurrentScenario(),r=this._experienceBase.ComponentsMap.GetComponentFromID(n).GetCurrentFrame(),o=new i(this._experienceBase);o.ChangeTimePos(0,r),this._experienceBase.getManager("VCXCommandManager").Push(o),t.SetIsPlayingCurrentScenario(!1),e.publish({event:"VCX_STOP_PLAY"})}},GetAnimationTime:function(){var e=this._experienceBase.getManager("VCXScenarioManager").GetCurrentTime();return console.log("API GetAnimationTime : "+e),e},SetReferenceAxisSystemVisisbility:function(e){var t,n=this._experienceBase.getManager("VCXContextManager"),i=n.getMainViewer().getReferenceAxisSystemNode();if("1"===e)if(1==i._enabled)t="Reference Axis Compass Already On";else{const e=this._experienceBase.getManager("VCXRobotAdapter");e&&e.showReferenceAxisSystem(!0),t="Reference Axis Compass On"}else if("0"===e)if(0==i._enabled)t="Reference Axis Compass Already Off";else{const e=this._experienceBase.getManager("VCXRobotAdapter");e&&e.showReferenceAxisSystem(!1),t="Reference Axis Compass Off"}else t="Invalid Input";return n.renderAll(),t},GetAnimationDuration:function(e){var t=0;if(e){var n=this._experienceBase.getManager("VCXScenarioManager");if(n)t=n.GetMaxFrame(e)/n.GetFPS();console.log("API GetAnimationDuration : "+t)}return t},GoToMarker:function(e,t){var n=this;if(this._experienceBase.ComponentsMap.GetComponentFromID(e)){var i=new r(n._experienceBase.getManager("VCXScenarioManager"),n._experienceBase.getManager("VCXCommandManager"),n._experienceBase.ComponentsMap);i.GoToMarker(e),i.SetCallback(t),n._experienceBase.getManager("VCXCommandManager").Push(i)}},ActivateSelectionSet:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(t){var i=new n(this._experienceBase);i.AddToSelection(t),this._experienceBase.getManager("VCXCommandManager").Do(i)}else console.log("Component selection set not found.")},DeactivateSelectionSet:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(t){var i=new n(this._experienceBase);i.RemoveFromSelection(t),this._experienceBase.getManager("VCXCommandManager").Do(i)}else console.log("Component selection set not found.")},ActivateHotspotOnClick:function(e){this.ActivateHyperlink(e)},ActivateHyperlink:async function(e,t){return new Promise((n=>{const i=()=>{t&&t(),n()};var r=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(r){var o=r.QueryInterface("VCXIModifiable");this._experienceBase.getManager("VCXHyperlinkManager").OpenHyperlink(o,i)}else console.log("Component not found.")}))},SelectHotspot:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);t?(this._experienceBase.getManager("VCXHotspotManager").ActivateHotspotFromTree(t),this._experienceBase.getManager("VCXContextManager").renderAll()):console.log("Component hotspot not found.")},DeselectHotspot:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);t?(this._experienceBase.getManager("VCXHotspotManager").DeactivateHotspotFromTree(t),this._experienceBase.getManager("VCXContextManager").renderAll()):console.log("Component hotspot not found.")},RegisterAddSelectionCB:function(e){this._experienceBase.getManager("VCXSelectionManager").RegisterAddSelectionCB(e)},RegisterRemoveSelectionCB:function(e){this._experienceBase.getManager("VCXSelectionManager").RegisterRemoveSelectionCB(e)},RegisterMarkerSequenceCB:function(e){this._experienceBase.getManager("VCXMarkerManager").RegisterMarkerSequenceCB(e)},GetAllHotspots:function(){for(var e={},t=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentHotspot"),n=0;n<t.length;n++){var i=t[n];if(i){var r=i.GetArrayActors();e[i.GetID()]=r}}return e},GetSelectedObjects:function(){for(var e=[],t=this._experienceBase.getManager("VCXSelectionManager").GetComponentsFromCurrentSelection(),n=0;n<t.length;n++){var i=t[n];i&&e.push(i.GetID())}return e},ChangeProperties:function(e){var t=this._experienceLoader.LoadPropMap(e),n=new o(this._experienceBase);n.ChangePropertiesFromMap(t),this._experienceBase.getManager("VCXCommandManager").Do(n)},GetProperties:function(e,t){var n=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(n){var i=new a,r=n.QueryInterface("VCXIModifiable");if(t){var o=r.GetProperty(t);o&&i.AddOrModifyProperty(r.GetHashing(),o)}else{var s=r.GetProperties();i.AddOrModifyPropertySet(r.GetHashing(),s)}return this._experienceSaver._PropMapToJson(this._experienceBase,i)}console.log("Object not found")},ActivateTooltipDisplayOnPartHover:function(e){if(this._experienceBase){var t=this._experienceBase.getManager("VCXGUIManager");t&&t.setTooltipDisplay(!0)}},DeactivateTooltipDisplayOnPartHover:function(e){if(this._experienceBase){var t=this._experienceBase.getManager("VCXGUIManager");t&&t.setTooltipDisplay(!1)}},SetPreventPartsFromBeingSelectable:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").excludeParts=e)},GetPreventPartsFromBeingSelectable:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").excludeParts},SetPreventCollaborativeActorsFromBeingSelectable:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").excludeDressups=e)},GetPreventCollaborativeActorsFromBeingSelectable:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").excludeDressups},SetKeepLinkSelectable:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable=e)},GetKeepLinkSelectable:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable},TrapSelectionMode:function(e){this._experienceBase.getManager("VCXContextManager").getFrameWindow().getViewpoint().control.setRotationOverTrapSelection(e)},SetKeepHotspotsSelectable:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable=e)},GetKeepHotspotsSelectable:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable},SetKeepAssemblySelectionModeActive:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").keepAssemblySelectionModeActive=e)},GetKeepAssemblySelectionModeActive:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").keepAssemblySelectionModeActive},GetAllActors:function(e){var t,n,i=[],r=!1;""===e&&(r=!0);var o,a=e.toLowerCase();if(r||"mesh"===a)for(var s=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentOccurrenceExt"),l=0;l<s.length;++l){var c=s[l];c&&(c.IsMesh()&&i.push(c.GetID()))}if((r||"collab"===a)&&(n=this._experienceBase.ComponentsMap.GetComponentFromType("VCXDressup_Spec")),(r||"pmi"===a)&&(t=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentCompositePmi")),n&&t?o=n.concat(t):n?o=n:t&&(o=t),o)for(l=0;l<o.length;++l){var p=o[l];p&&i.push(p.GetID())}return i},SelectActors:function(e){for(var t=[],i=0;i<e.length;++i){var r=this._experienceBase.ComponentsMap.GetComponentFromID(e[i]);r&&t.push(r)}var o=new n(this._experienceBase);t&&t.length<=0?o.SetSelection(null):o.AddComponentsToSelection(t),this._experienceBase.getManager("VCXCommandManager").Do(o)},GetScenarios:function(){let e=this._experienceBase.getManager("VCXScenarioManager").GetScenarios();return Object.keys(e).map((t=>({id:t,name:e[t].GetName()})))},GoToFirstScenario:function(){let e=this._experienceBase.getManager("VCXSequenceManager");if(e.GetListSequences().length){let t=e.GetOrderedListOfAllScenariosIds(!0);if(t.length){let e=t[0];return this.GoToScenario(e)}}return!1},setPlayPauseStatus:function(e){let t=this._experienceBase.getManager("VCXGUIManager").GetGUIComponentFromName("VCXPlayCtrl");t&&t.setPlayPauseStatus(e)},setVisibilityImmersiveNav:function(e){this._experienceBase.getManager("VCXPlayManager").saveProperty("VCXPlayManager.immersiveNav",e);let t=this._experienceBase.getManager("VCXGUIManager").GetGUIComponentFromName("VCXPlayCtrl");t&&t.setupPlayer()},ZoomFitAll:function(e){var t=this._experienceBase.getManager("VCXUserInputControllerManager");t&&t.ZoomFitSelection(e)},SetVisibility:function(e,t){for(var n=[],i=0;i<e.length;++i){var r=this._experienceBase.ComponentsMap.GetComponentFromID(e[i]);if(r)r.QueryInterface("VCXIVisibility")&&n.push(r)}if(0!==n.length){var o=new c(this._experienceBase),a=p.EVisState.Hidden;t&&(a=p.EVisState.Visible),o.ChangeVisibility(n,a),this._experienceBase.getManager("VCXCommandManager").Push(o)}},GetVisibility:function(e){var t=-1,n=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(!n)return t;var i=n.QueryInterface("VCXIVisibility");if(i){var r=i.GetVisibility();r===p.EVisState.Hidden?t=0:r===p.EVisState.Visible&&(t=1)}return t},GetViewport:function(){var e=this._experienceBase.ComponentsMap.GetComponentFromType("VCXViewport_Spec");if(e&&e.length>0)return e[0].GetID()}});return Object.defineProperty(m.prototype,"componentType",{enumerable:!0,get:function(){return"VCXAPIManager"}}),Object.defineProperty(m.prototype,"preventCollaborativeActorsFromBeingSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").excludeDressups},set:function(e){this._experienceBase.getManager("VCXSelectionManager").excludeDressups=e}}),Object.defineProperty(m.prototype,"preventPartsFromBeingSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").excludeParts},set:function(e){this._experienceBase.getManager("VCXSelectionManager").excludeParts=e}}),Object.defineProperty(m.prototype,"keepLinkSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable=e}}),Object.defineProperty(m.prototype,"keepHotspotSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable=e}}),Object.defineProperty(m.prototype,"keepAssemblySelectionModeActive",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepAssemblySelectionModeActive},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepAssemblySelectionModeActive=e}}),m}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXSelectionSet_Spec",["require","exports","DS/VCXWebKernel/VCXActorList_Spec"],(function(e,t,n){"use strict";n=__importDefault(n);class i extends n.default{Build(){return this.QueryInterface("VCXISelectBehavior").SetSelectMode(1),this}getManagerName(){return"VCXSelectionSetManager"}}return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXSelectionSet_Spec"}}),i}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXGroupSelectionSet_Spec",["require","exports","DS/VCXWebKernel/VCXActorList_Spec"],(function(e,t,n){"use strict";n=__importDefault(n);class i extends n.default{Build(){return this.QueryInterface("VCXISelectBehavior")?.SetSelectMode(1),this}AddActor(e){super.AddActor(e);var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);t&&(t.GroupID=this.GetID())}}return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXGroupSelectionSet_Spec"}}),i}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXSelectionManager",["require","exports","DS/Core/Core","DS/VCXWebKernel/VCXWebSelectionManager"],(function(e,t,n,i){"use strict";n=__importDefault(n),i=__importDefault(i);class r extends i.default{constructor(){super(...arguments),this._refreshXSORequested=!1}update(e){this._refreshXSORequested&&(this._refreshXSORequested=!1,this._RefreshXSO())}RefreshXSO(){this._refreshXSORequested=!0}_RefreshXSO(){for(var e=[],t=this.GetSGComponentsFromCurrentSelection(),i=0;i<t.length;++i){var r=t[i].QueryInterface("W3AISGNodeHolder");if(r&&r.getPathElement){var o=r.getPathElement();o&&e.push({pathElement:o})}else console.log("Found a component without sgNode/pathElement in selection from visu.")}var a=this._experienceBase.getManager("VCXSelectManager");a.blockEventCallback("all","SELECTION"),a.blockEventCallback("all","HIGHLIGHT");try{n.default.Selection.CSOManager.remove(Array.from(n.default.Selection.CSOManager.get())),n.default.Selection.HSOManager.remove(Array.from(n.default.Selection.HSOManager.get())),n.default.Selection.CSOManager.add(e),n.default.Selection.HSOManager.add(e)}catch(e){console.error(e)}a.unblockEventCallback("all","SELECTION"),a.unblockEventCallback("all","HIGHLIGHT")}getSelectionContext(e){if("object"!=typeof e)throw new Error("selectionContextFiler must be an object");const t=this._experienceBase.getManager("VCXSelectionManager").GetComponentsFromSelection("CSO");let n=[];if("list"===e.scenariosFilter&&e.scenarios)n=e.scenarios;else if("all"===e.scenariosFilter){const e=this._experienceBase.getManager("VCXScenarioManager").GetScenarios();for(let t in e)n.push(e[t])}else n=t.filter((e=>e.IsKindOf("VCXScenario")));let i=!1,r=!1;return{scenarios:n,dressups:(e.dressups||t).filter((e=>"ViewpointID"===e.GetID()?(i=!0,!1):e.IsKindOf("VCXViewport_Spec")?(r=!0,!0):e.IsKindOf("VCXDressup_Spec"))),parts:(e.parts||t).filter((e=>e.IsKindOf("VCXComponentOccurrenceExt"))),cameraSelected:i,viewportSelected:r}}get componentType(){return"VCXSelectionManager"}}return r}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXComponentGroupHotspot",["require","exports","DS/VCXWebKernel/VCXActorList_Spec"],(function(e,t,n){"use strict";n=__importDefault(n);class i extends n.default{constructor(){super(),this._bEnable=!1}Build(){return this.QueryInterface("VCXISelectBehavior")?.SetSelectMode(1),this}}return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentGroupHotspot"}}),i})),define("DS/VCXWebKernel/VCXModifiableSelectionSet",["DS/VCXWebKernel/VCXModifiableActorList","DS/VCXWebProperties/VCXPropertySet","DS/CoreEvents/Events"],(function(e,t,n){"use strict";return e.extend({init:function(){this._parent()},GetProperties:function(){var e=new t;return e.AddOrModifyProperty(this.GetProperty("Actor.Name")),e.AddOrModifyProperty(this.GetProperty("Actor.ListActors")),e},OnChangePropertiesEnd:function(){this._parent(),this._listActorsEdited&&(this._listActorsEdited=!1,n.publish({event:"VCX_SELECTIONSETS_UPDATED",data:this.GetObject()}))}})})),define("DS/VCXWebKernel/VCXModifiableGroupActorList",["DS/VCXWebKernel/VCXModifiableActorList","DS/VCXWebProperties/VCXPropertySet"],(function(e,t){"use strict";return e.extend({init:function(){this._parent()},GetProperties:function(){var e=new t;return e.AddOrModifyProperty(this.GetProperty("Actor.ListActors")),e}})})),define("DS/VCXWebKernel/VCXContextualContentOccurenceExperience",["DS/VCXWebKernel/VCXAContextualContent"],(function(e){"use strict";return e.extend({generateFontButton:function(e){const t=document.createElement("canvas");t.width=32,t.height=32;const n=t.getContext("2d");if(window.devicePixelRatio){var i=t.width,r=t.height;t.width=i*window.devicePixelRatio,t.height=r*window.devicePixelRatio,n.scale(window.devicePixelRatio,window.devicePixelRatio)}n.textAlign="center",n.textBaseline="alphabetic";const o=this.QueryInterface("VCXIModifiable");let a="Abc";"VCXCallout_Spec"===this.GetObject().componentType&&(a="123");const s=o.GetFontPropertyValue("Collab.Text.Font");if(s){var l="";l+=" "+(s.Italic?"italic":"normal"),l+=" "+(s.Weight||400),l+=" 14px",l+=" "+e,n.font=l}return n.fillText(a,16,22.4),t.toDataURL()},getFontList:function(){return[{fontID:"Arial"},{fontID:"Arial Black"},{fontID:"Comic Sans MS"},{fontID:"Courier New"},{fontID:"Georgia"},{fontID:"Impact"},{fontID:"Lucida Console"},{fontID:"Lucida Sans Unicode"},{fontID:"Palatino Linotype"},{fontID:"Tahoma"},{fontID:"Times New Roman"},{fontID:"Verdana"}]},createContentFontCommandsPanel:function(){let e={};return this.getFontList().forEach((t=>{let n={type:"button"};n.name=t.fontID.replaceAll(" ",""),n.cmdId={id:"VCX2DTextChangeFontCmd",args:{fontID:t.fontID,_fontID:t.fontID}},n.iconPath=this.generateFontButton(t.fontID),e[n.name]=n})),e},appendContent:function(e,t,n){this._parent(e,t,n),t&&(e.Visibility={type:"button",name:"Dropdown_hide",cmdId:"VCXHideSelectionCmd",index:20},e.CopyStyle={type:"button",name:"CopyStyle",cmdId:"VCXFormatPainterCmd",index:35},e.TransformHack={type:"button",name:"Transform2",cmdId:"VCXTransformCmd",index:40},e.RestorePosition={type:"button",name:"RestorePosition",cmdId:"VCXRestoreNeutralPositionCmd",index:50},e.CreateAssociativePath={type:"button",name:"CreateAssociativePath",cmdId:"VCXCreateDressupAssociativePathCBCmd",index:52},1===t.length&&(e.ParentSelector={type:"button",name:"ParentSelector",cmdId:"VCXParentSelectorCmd",index:80}))}})})),define("DS/VCXWebKernel/VCXContextualContentOccurenceExt",["DS/VCXWebKernel/VCXContextualContentOccurenceExperience","DS/VCXWebKernelCommands/VCXCmdApplyTo","i18n!DS/VCXWebKernel/assets/nls/VCXWebKernel"],(function(e,t,n){"use strict";return e.extend({appendContent:function(e,i,r){this._parent(e,i,r),i&&i.length>0&&!i.find((e=>!e.IsKindOf("VCXComponentOccurrenceComposer")))&&(e.ApplyNewMaterialOnSelection={type:"button",name:"ApplyNewMaterialOnSelection",cmdId:"VCXApplyNewMaterialOnSelectionCmd",index:30});const o=this.GetObject()._experienceBase;let a=[];a.push({type:"PushItem",title:n["Cmd.AddToSelectionSetCmd"],state:o.ComponentsMap.GetComponentFromType("VCXSelectionSet_Spec").length>0?"enabled":"disabled",action:"VCXAddToSelectionSetCmd",fonticon:{content:"wux-ui-3ds-folder-add wux-ui-3ds"}}),a.push({type:"PushItem",title:n["Cmd.Isolate"],state:i&&(i.length>0?"enabled":"disabled"),action:"VCXIsolateCmd",fonticon:{content:"wux-ui-3ds-eye wux-ui-3ds"}}),a.push({type:"PushItem",title:"Apply To",fonticon:{content:"wux-ui-3ds-propagate wux-ui-3ds"},submenu:[{type:"PushItem",title:n["Cmd.ApplyTo.All"],state:t.checkSelectionContext(o,{scenariosFilter:"all"}).state,fonticon:{content:"wux-ui-3ds-select-all-checkboxes wux-ui-3ds"},action:"VCXApplyToAllCmd"},{type:"PushItem",title:n["Cmd.ApplyTo.Selected"],state:t.checkSelectionContext(o,{scenariosFilter:"selected"}).state,fonticon:{content:"wux-ui-3ds-select-on wux-ui-3ds"},action:"VCXApplyToSelectedCmd"}]}),a.push({type:"PushItem",title:n["Cmd.SelectSimilarColor"],action:"VCXSelectSimilarColor",fonticon:{content:"wux-ui-3ds-pipette wux-ui-3ds"}}),a.push({type:"PushItem",title:n["Cmd.SelectSimilarInstance"],action:"VCXSelectSimilarInstance",fonticon:{content:"wux-ui-3ds-object-instance-select wux-ui-3ds"}}),e.Menu={type:"menu",name:"Dropdown_hide",cmdId:"VCXMenuCmd",content:a,index:100}}})}));