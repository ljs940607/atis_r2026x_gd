define("DS/IssueCommon/commands/Open",["UWA/Class","DS/ApplicationFrame/Command"],(function(e,t){"use strict";return e.extend(t,{execute:function(){require(["DS/IssueComponents/open/Open"],(function(e){e.openWith()}))}})})),define("DS/IssueCommon/utils/TaskManager",["UWA/Core","UWA/Class","UWA/Class/Events","DS/PlatformAPI/PlatformAPI","DS/IssueServices/Contexts","css!DS/IssueCommon/IssueCommon.css"],(function(e,t,n,s,i){"use strict";var a={ISU_TASK_MANAGER:"ISU_TASK_MANAGER"},o={FILTER:"FILTER",SELECT_IN_3D:"SELECT_IN_3D",PREFERENCES:"PREFERENCES",ADD_OBJECTS:"ADD_OBJECTS",TAKE_SCREENSHOT:"TAKE_SCREENSHOT",GET_FILTERED_ISSUES:"GET_FILTERED_ISSUES"},r={NEW:"NEW",PROCESSING:"PROCESSING"},d=0;return t.singleton(n,{_counter:0,_taskList:[],_subscriber:[],_metadataOpts:{},init:function(){var e=this;e._counter=0,e._taskList=[],e._subscriber=[],e._metadataOpts={},e._metadataOpts[a.ISU_TASK_MANAGER]=a.ISU_TASK_MANAGER,e._subscriber.push(s.subscribe("DS/IssueManagementTask/ready",e._ready.bind(e))),e._subscriber.push(s.subscribe("DS/IssueManagementTask/done",e._end.bind(e)))},destroy:function(){},add:function(t,n,a,d){var l=this;if(!e.is(t,"string"))throw new Error('Invalid arguments[0] "type". Expected a String');if(-1===Object.keys(o).indexOf(t))throw new Error('Task type "'+t+'" is not supported');if(!e.is(n,"array"))throw new Error('Invalid arguments[1] "args". Expected an Array');if(!e.is(a,"function"))throw new Error('Invalid arguments[2] "callback". Expected a Function');if(e.is(d)&&!e.is(d,"function"))throw new Error('Invalid arguments[3] "cancelCallback". Expected a Function');var c=i.get("widget")||window.widget;l._counter+=1;var u={taskType:t,taskId:"id-"+l._counter,state:r.NEW,widgetIdIM:c.id,widgetId3D:"",args:n,callback:a,cancelCallback:d||null};l._taskList.push(u);var m=[],p={};return m.push([u.taskId]),p[u.taskId]={taskType:u.taskType,widgetIdIM:u.widgetIdIM},s.publish("DS/IssueManagementTask/add",{metadata:{appId:c.id,appName:c.name,timestamp:Math.floor(Date.now()),options:e.clone(l._metadataOpts)},data:{paths:m,attributes:p},version:"1.0"}),u},cancelAll:function(){for(var e=this._taskList.slice(),t=0;t<e.length;t++)this.cancel(e[t].taskId)},getTaskList:function(){return this._taskList},_searchTask:function(e){for(var t=this,n=0;n<t._taskList.length;n++)if(t._taskList[n].taskId===e)return t._taskList[n];return null},_removeTask:function(e){for(var t=this,n=0;n<t._taskList.length;n++)if(t._taskList[n].taskId===e){t._taskList.splice(n,1);break}},_end:function(t){var n,s,a=i.get("widget")||window.widget;if(t.data.paths.length>0){var o=t.data.paths[d][d],r=t.data.attributes[o],l=this._searchTask(o);n=a.body.getDimensions().height,s=window.getComputedStyle(a.body),0!==n&&"none"!==s.display&&l&&l.widgetIdIM===r.widgetIdIM&&l.widgetId3D===r.widgetId3D&&(this._removeTask(l.taskId),t.metadata.options.canceled?e.is(l.cancelCallback,"function")&&l.cancelCallback():l.callback(r.response))}},cancel:function(t){var n=this,s=n._searchTask(t);s&&(""!==s.widgetId3D?n.publish(s,"cancel"):(n._removeTask(s.taskId),e.is(s.cancelCallback,"function")&&s.cancelCallback()))},publish:function(t,n){var a=i.get("widget")||window.widget,o=[],r={};o.push([t.taskId]),r[t.taskId]={taskId:t.taskId,taskType:t.taskType,widgetIdIM:t.widgetIdIM,widgetId3D:t.widgetId3D},s.publish("DS/IssueManagementTask/"+n,{metadata:{appId:a.id,appName:a.name,timestamp:Math.floor(Date.now()),options:e.clone(this._metadataOpts)},data:{paths:o,attributes:r},version:"1.0"})},addSelectIn3DTask:function(e,t,n){return this.add(o.SELECT_IN_3D,[n],e,t)},addFilterTask:function(t,n){if(!e.is(t,"array"))throw new Error('Invalid arguments[0] "ids". Expected an Array');if(!e.is(n,"function"))throw new Error('Invalid arguments[1] "callback". Expected a Function');var s=[t];return this.add(o.FILTER,s,n,null)},addPreferencesTask:function(t){if(!e.is(t,"function"))throw new Error('Invalid arguments[1] "callback". Expected a Function');return this.add(o.PREFERENCES,[],t,null)},addGetFilteredIssuesTask:function(t){if(!e.is(t,"function"))throw new Error('Invalid arguments[1] "callback". Expected a Function');return this.add(o.GET_FILTERED_ISSUES,[],t,null)},addObjectsTask:function(e,t){return this.add(o.ADD_OBJECTS,[],e,t)},addTakeScreenshotTask:function(e,t){return this.add(o.TAKE_SCREENSHOT,[],e,t)},_isMasked:function(e){return e.hasClassName("masked")},_ready:function(t){var n=i.get("widget")||window.widget;if(t.data.paths.length>0){var a=t.data.paths[d][d],o=t.data.attributes[a],l=this._searchTask(a);if(l&&l.widgetIdIM===o.widgetIdIM&&l.state===r.NEW){l.state=r.PROCESSING,l.widgetId3D=o.widgetId3D;var c=[],u={};c.push([l.taskId]),u[l.taskId]={taskId:l.taskId,taskType:l.taskType,widgetIdIM:l.widgetIdIM,widgetId3D:l.widgetId3D,args:l.args},s.publish("DS/IssueManagementTask/exec",{metadata:{appId:n.id,appName:n.name,timestamp:Math.floor(Date.now()),options:e.clone(this._metadataOpts)},data:{paths:c,attributes:u},version:"1.0"})}}}})})),define("DS/IssueCommon/commands/CollaborativeLifecycle",["DS/ApplicationFrame/Command"],(function(e){"use strict";return e.extend({execute:function(){require(["DS/IssueCommon/utils/Selector","DS/IssueComponents/external/CollaborativeLifecycle"],(function(e,t){var n=e.getSelection({type:"all"}),s=[];n.physicalIds.forEach((function(e){var t=e.split(","),i=t[t.length-1];i.includes("i3dx:")?s.push(n.map[i].pid):s.push(i)})),t.execute(s)}))}})})),define("DS/IssueCommon/commands/CommandsManager",["DS/ApplicationFrame/CommandsManager"],(function(e){"use strict";var t={disabled:!1,commands:{toEnable:[],toDisable:[]},commandCheckHeaders:{toEnable:[],toDisable:[]}},n="Default";return{setContext:function(e){n=e},disableAll:function(){if(!0!==t.disabled){var s=n,i=e.getCommands(s),a=i?Object.keys(i):[],o=e.getCommandCheckHeaders(s),r=o?Object.keys(o):[];t={disabled:!0,commands:{toEnable:[],toDisable:[]},commandCheckHeaders:{toEnable:[],toDisable:[]}};for(var d=0;d<a.length;d++)"function"==typeof i[a[d]].isEnabled&&(i[a[d]].isEnabled()?t.commands.toEnable.push(a[d]):t.commands.toDisable.push(a[d]));for(var l=0;l<r.length;l++)"function"==typeof o[r[l]].isEnabled&&(o[r[l]].isEnabled()?t.commandCheckHeaders.toEnable.push(r[l]):t.commandCheckHeaders.toDisable.push(r[l]));(t&&(t.commands.toEnable.length||t.commands.toDisable.length)||t&&(t.commandCheckHeaders.toEnable.length||t.commandCheckHeaders.toDisable.length))&&e.disableAll(s)}},enableAll:function(){if(!1!==t.disabled){var s=n;(t&&(t.commands.toEnable.length||t.commands.toDisable.length)||t&&(t.commandCheckHeaders.toEnable.length||t.commandCheckHeaders.toDisable.length))&&e.enableAll(s);var i=e.getCommands(s);if(t&&t.commands){for(var a=0;a<t.commands.toEnable.length;a++)i[t.commands.toEnable[a]].enable();for(var o=0;o<t.commands.toDisable.length;o++)i[t.commands.toDisable[o]].disable()}var r=e.getCommandCheckHeaders(s);if(t&&t.commandCheckHeaders){for(var d=0;d<t.commandCheckHeaders.toEnable.length;d++)r[t.commandCheckHeaders.toEnable[d]].enable();for(var l=0;l<t.commandCheckHeaders.toDisable.length;l++)r[t.commandCheckHeaders.toDisable[l]].disable()}t={disabled:!1,commands:{toEnable:[],toDisable:[]},commandCheckHeaders:{toEnable:[],toDisable:[]}}}},getCommand:function(t){var s=n;return e.getCommand(t,s)},getCommandCheckHeader:function(t){var s=n;return e.getCommandCheckHeader(t,s)},clean:function(t){t||(t="Default"),e._commandsState[t]={lastCommand:[],currentCommand:null,defaultCommand:null},e.resetDefaultCommand(t),e._isCommandEnding=!1,e._ignoreCommandBeginWhileEndingCommand=!1,["_commands","_cmdCheckHeader"].forEach((function(n){var s;null!=(s=t&&null!=e[n]&&e[n][t]?e[n][t]:e[n])&&Object.keys(s).forEach((function(e){var t=s[e];t&&t._destroy&&t._destroy(),delete s[e]}))}))}}})),define("DS/IssueCommon/commands/Move",["UWA/Core","DS/ApplicationFrame/Command"],(function(e,t){"use strict";var n=200;return t.extend({init:function(e){this._parent(e,{isAsynchronous:!0})},execute:function(t){var s=this;require(["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeOwnerCmd","DS/LifecycleServices/LifecycleServicesSettings","DS/PlatformAPI/PlatformAPI","DS/IssueCommon/commands/CommandsManager","DS/IssueCommon/utils/Selector","DS/IssueServices/Contexts","DS/IssueServices/services/PlatformServices"],(function(t,i,a,o,r,d,l){var c=d.get("widget")||window.widget,u=o.getCommand("ActionBar_ChangeOwnerCmd_"+c.id);e.is(u,"object")||i.app_initialization((function(){var i=r.getSelection({type:"issue"}),o=[];i.physicalIds.forEach((function(e){var t={getID:function(){return i.map[e].id},getLabel:function(){return i.map[e].title}};o.push(t)}));var d={securityContext:{SecurityContext:"ctx::"+decodeURIComponent(l.getSecurityContext())},getSecurityContext:function(){return this.securityContext},getSelectedNodes:function(){return o}};e.is(u,"object")||(u=new t({ID:"ActionBar_ChangeOwnerCmd_"+c.id,context:d})),u.onEnd((function(){s.end();var e=setInterval((function(){u.transferOwnershipPanel&&u.transferOwnershipPanel.addEvent&&(clearInterval(e),u.transferOwnershipPanel.addEvent("onClose",(function(){for(var e=[],t={},n=r.getSelection({type:"issue"}),s=n.physicalIds,i=0;i<s.length;i++)e.push([n.map[s[i]].id]),t[n.map[s[i]].id]={id:n.map[s[i]].id,type:n.map[s[i]].type,name:n.map[s[i]].name,title:n.map[s[i]].title,modifiedAttributes:["owner"]};a.publish("DS/Object/update",{metadata:{appId:c.id,appName:c.name,timestamp:Math.floor(Date.now())},data:{paths:e,attributes:t},version:"1.0"})})))}),n)}))})),e.is(u,"object")&&u.begin()}))}})})),define("DS/IssueCommon/facets/Placeholder",["UWA/Class/View","UWA/Core","i18n!DS/IssueCommon/assets/nls/IssueCommon","text!DS/IssueCommon/assets/Settings.json"],(function(e,t,n,s){"use strict";var i="attachments",a="comments",o="history",r="relations",d="members",l="content",c="classification";return e.extend({name:"DS/IssueCommon/facets/Placeholder",tag:"div",className:"placeholder-view fade-in-element",setup:function(){},render:function(e){var u=this,m=JSON.parse(s),p=m.contentLimit,g=m.membersLimit;u.empty();var I="",S="";switch(e){case i:I="attach",S=n.attachmentsPlaceholder;break;case a:I="chat",S=n.commentsPlaceholder;break;case o:I="navigation-history",S=n.historyPlaceholder;break;case r:I="object-related",S=n.relationsPlaceholder;break;case d:I="users",S=n.replace(n.maxIssuePlaceholder,{number:g});break;case l:I="location",S=n.replace(n.maxIssuePlaceholder,{number:p});break;case c:I="classification-book",S=n.classificationFacet}var f=t.createElement("div",{class:"placeholder-content",html:[t.createElement("span",{class:"fonticon fonticon-5x fonticon-"+I}),t.createElement("span",{class:"placeholder-label",html:S})]});return u.container.setContent(f),u},empty:function(){this.container.empty()}})})),define("DS/IssueCommon/commands/AttachmentManager",["UWA/Class","UWA/Core","UWA/Class/Listener","DS/ApplicationFrame/Command","DS/PADUtils/views/PADAlert"],(function(e,t,n,s,i){"use strict";var a="ENXISSU_AP",o="ENX3DIR_AP",r=100,d=!0;return e.extend(s,n,{_instances:[],init:function(e){var t=this;t._parent(e,{isAsynchronous:!0}),t.authoring=null,t.selectedObject=null},execute:function(){var e=this;require(["DS/ENOFloatingPanel/ENOFloatingPanel","DS/PlatformAPI/PlatformAPI","DS/IssueAttachmentManager/IssueAttachmentManager","DS/IssueCommon/utils/Utils","DS/IssueServices/Contexts","DS/IssueServices/utils/LocalStorage","UWA/Class/Promise","i18n!DS/IssueCommon/assets/nls/IssueCommon","i18n!DS/IssueAttachmentManager/assets/nls/IssueAttachmentManager"],(function(n,s,l,c,u,m,p,g,I){var S=u.get("widget"),f=u.get("component"),h=u.get("eventsHandler");new p((function(n){var s="",i="",r="";if(t.is(e.selectedObject)&&t.is(e.selectedObject.physicalId,"string")&&t.is(e.selectedObject.title,"string")&&t.is(e.selectedObject.name,"string"))n({id:e.selectedObject.physicalId,title:e.selectedObject.title,name:e.selectedObject.name});else if(S.name===a){var d=f.getSelectedNodes();d.length>0&&(s=d[d.length-1].options.id,i=d[d.length-1].options.title,r=d[d.length-1].options.name),n({id:s,title:i,name:r})}else if(S.name===o){var l=f.getSelectedIssues();l.length>0&&(s=l[l.length-1].id,i=l[l.length-1].title,r=l[l.length-1].name),n({id:s,title:i,name:r})}})).then((function(a){var m=a.id,p=a.title,E=a.name,v=Date.now(),y=S.body.getDimensions(),b={mode:1,catalogLayout:S.getValue("attachmentLayout")?S.getValue("attachmentLayout"):1,catalogVisibility:!0,sliderVisibility:!1,height:y.height-100,width:y.width-100,top:"20px",left:"50px",annotationPreLaunchCallback:function(){if(e._instances.hasOwnProperty(v)&&c.Mask.mask(e._instances[v].elements.container),S.name===o)try{this.annotationCanvasTarget=f.get3DContext().root.getViewer().canvas}catch(e){}else this.annotationCanvasDefaultDimensions={width:y.width-50,height:y.height-50}},annotationSaveCallback:function(){e._instances.hasOwnProperty(v)&&c.Mask.unmask(e._instances[v].elements.container)},annotationExitCallback:function(){e._instances.hasOwnProperty(v)&&c.Mask.unmask(e._instances[v].elements.container)}},A=t.clone(S.getValue("attachmentManagerModalPreferences")),C=t.clone(S.getValue("attachmentManagerPreferences")),D=t.merge(A||{},b);(D=t.merge(C||{},D)).id=m,D.authoring=t.is(e.authoring,"boolean")?e.authoring:d;var w=new l(D),T=e._instances[v]=new n({animate:!0,autocenter:!0,closable:!0,limitParent:!1,overlay:!1,resizable:!0,visible:!0,className:"isu-am-modal",title:g.replace(g.attachments.title,{title:p,name:E}),header:null,body:w,events:{onShow:function(){var t=this;t.attachmentManager=w,t.instanceId=v,t._subscriberId=Math.random().toString(36).substr(2,9),t.attachmentManager.render(),t.attachmentManager.isLoaded.then((function(){e._utils._addCustomCommands.apply(t),t.attachmentManager.container.setAttribute("tabindex","0"),t.attachmentManager.container.focus(),t.attachmentManager.resize();var n=c.throttle((function(){t.attachmentManager.resize()}),r);e.listenTo(t,"onResizeFloating",n),e.listenTo(t.attachmentManager,"onRefresh",e._utils._addCustomCommands.bind(t)),e.listenTo(t.attachmentManager,"onUpdate",(function(e){for(var n=[],i={},a=Object.keys(e.objects),o=0;o<a.length;o++)n.push([e.objects[a[o]].physicalId]),i[e.objects[a[o]].physicalId]={id:e.objects[a[o]].physicalId,type:e.objects[a[o]].type||"Issue",modifiedAttributes:["attachments"]};var r="DS/Object/update",d={metadata:{appId:u.get("widget").id,appName:u.get("widget").name,timestamp:Math.floor(Date.now()),options:{}},data:{paths:n,attributes:i},version:"1.0"};null!==h?h.publish(t._subscriberId,r,d):s.publish(r,d)})),t._eventListeners=[{event:"DS/Object/update",listener:function(e){if(t.attachmentManager&&t.attachmentManager.id){var n=e.data.paths.some((function(e){return t.attachmentManager.id===e[0]}));n&&t.attachmentManager.refresh()}},conditions:{type:"issue",attributes:["attachments"]}},{event:"DS/Object/select",listener:function(n){if(!t._holdIssueFlg){var s="";if(1===n.data.paths.length&&(s=n.data.paths.pop().pop()),""!==s&&s!==t.attachmentManager.collection.id){var i="",a="";if(n.data.attributes.hasOwnProperty(s)){var o=n.data.attributes[s];i=o.title,a=o.name}t.setTitle(g.replace(g.attachments.title,{title:i,name:a})),t.attachmentManager.refresh(s).then((function(){e._utils._addCustomCommands.apply(t)}))}}},conditions:{type:"issue"}}];for(var i=0;i<t._eventListeners.length;i++){var a=t._eventListeners[i];a.token=null!==h?h.subscribe(t._subscriberId,a.event,a.listener.bind(t),a.conditions):s.subscribe(a.event,a.listener.bind(t))}e.authoring=null,e.selectedObject=null,e.end()})).catch((function(e){if(e.internalError&&e.internalError.includes("ErrorCode:1500127")){var t=c.getErrorMessage("0");c.displayErrorMessage(t,"error"),T.destroy()}else i.displayNotification({msg:I.notifications.Init.failure,eventID:"error"})}))},onClose:function(){var t=this;if(S.setValue("attachmentManagerModalPreferences",{width:t.elements.container.clientWidth,height:t.elements.container.clientHeight,top:t.elements.container.offsetTop,left:t.elements.container.offsetLeft}),e.stopListening(t,"onResizeFloating"),e.stopListening(t.attachmentManager,"onUpdate"),Array.isArray(t._eventListeners))for(var n=0;n<t._eventListeners.length;n++){var i=t._eventListeners[n];null!==h?h.unsubscribe(i.token):s.unsubscribe(i.token)}t._eventListeners=[],t.attachmentManager.resetPADAlert(),t.attachmentManager.destroy(),t.attachmentManager=null,delete e._instances[t.instanceId],t.destroy()}}});T.inject(S.body),T.elements.container.setStyle("height",D.height),T.elements.container.setStyle("width",D.width),T.elements.container.setStyle("zIndex","25")}))}))},_utils:{_addCustomCommands:function(){var e=this;require(["i18n!DS/IssueCommon/assets/nls/IssueCommon"],(function(t){var n=function(){e._holdIssueFlg=!e._holdIssueFlg,e.attachmentManager.views.header.iconBarFix.getItem("hold").elements.container.toggleClassName("active",e._holdIssueFlg),e.attachmentManager.contextualMenu.customCommands.forEach((function(t){"hold"===t.name&&(t.state=e._holdIssueFlg?"selected":"unselected")}))};(e._holdIssueFlg=!1,e.attachmentManager.views.header.iconBarFix.addItem({id:"hold",fonticon:"pin",text:t.attachments.holdIssue,selectable:!0,handler:n}),e.attachmentManager&&e.attachmentManager.contextualMenu&&e.attachmentManager.contextualMenu.customCommands)&&(e.attachmentManager.contextualMenu.customCommands.some((function(e){return"hold"===e.name}))||e.attachmentManager.contextualMenu.customCommands.push({name:"hold",title:t.attachments.holdIssue,type:"RadioItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x fonticon-pin"},data:null,state:e._holdIssueFlg?"selected":"unselected",action:{callback:n}}))}))}}})})),define("DS/IssueCommon/commands/Close",["UWA/Class","DS/ApplicationFrame/Command"],(function(e,t){"use strict";return e.extend(t,{init:function(e){this._parent(e)},execute:function(){require(["DS/IssueComponents/close/Close","DS/IssueCommon/utils/Selector","DS/IssueServices/Contexts"],(function(e,t,n){var s=n.get("widget")||window.widget,i=t.getSelection({type:"issue"});s.body.getElement(".isu-close-dialog")||new e({physicalIds:i.physicalIds}).render()}))}})})),define("DS/IssueCommon/facets/Team",["UWA/Class/View","UWA/Core","DS/UIKIT/Scroller","DS/IssueComponents/team/Team","DS/IssueComponents/team/TeamNew","DS/IssueServices/Contexts","DS/IssueServices/services/IssueServices","DS/IssueServices/utils/Performance","css!DS/IssueCommon/IssueCommon.css"],(function(e,t,n,s,i,a,o,r){"use strict";return e.extend({name:"DS/IssueCommon/facets/Team",tag:"div",className:"team-view fade-in-element",defaultOptions:{physicalIds:[]},team:null,_subscriberId:"",_eventListeners:[],setup:function(e){var t=this;r.start(t.name+" setup"),t._parent(e),t.team=new i({physicalIds:t.getOption("physicalIds")}),t._subscriberId=Math.random().toString(36).substr(2,9),t.listenTo(t.team,"onReady",(function(e){t.dispatchEvent("onReady",e)})),t.listenTo(t.team,"onFailure",(function(e){t.dispatchEvent("onFailure",e)})),t.listenTo(t.team,"onUpdate",(function(e){for(var n=[],s={},i=Object.keys(e.issues),o=0;o<i.length;o++)n.push([e.issues[i[o]].id]),s[e.issues[i[o]].id]={id:e.issues[i[o]].id,type:e.issues[i[o]].type,name:e.issues[i[o]].name,title:e.issues[i[o]].title,modifiedAttributes:["assignees"]};a.get("eventsHandler").publish(t._subscriberId,"DS/Object/update",{metadata:{appId:a.get("widget").id,appName:a.get("widget").name,timestamp:Math.floor(Date.now()),options:{}},data:{paths:n,attributes:s},version:"1.0"})})),t._eventListeners=[{event:"DS/Object/update",listener:function(e){t.team&&t.team.physicalIds&&(e.data.paths.some((function(e){return-1!==t.team.physicalIds.indexOf(e[0])}))&&t.team.refresh())},conditions:{type:"issue",attributes:["owner","assignees"]}}];for(var n=0;n<t._eventListeners.length;n++){var s=t._eventListeners[n];s.token=a.get("eventsHandler").subscribe(t._subscriberId,s.event,s.listener.bind(t),s.conditions)}r.end(t.name+" setup")},render:function(){var e=this;return r.start(e.name+" render"),e.team.render().inject(e.container),r.end(e.name+" render"),e},refresh:function(e){return this.setOption("physicalIds",e),this.team.refresh(e)},destroy:function(){var e=this;if(e.stopListening(e.team,"onReady"),e.stopListening(e.team,"onFailure"),e.stopListening(e.team,"onUpdate"),Array.isArray(e._eventListeners))for(var t=0;t<e._eventListeners.length;t++){var n=e._eventListeners[t];a.get("eventsHandler").unsubscribe(n.token)}e._eventListeners=[],e._subcriberId="",e.team.destroy(),e.team=null,e.container.empty()}})})),define("DS/IssueCommon/commands/Reopen",["UWA/Class","DS/ApplicationFrame/Command"],(function(e,t){"use strict";return e.extend(t,{init:function(e){this._parent(e)},execute:function(){require(["DS/IssueComponents/reopen/Reopen","DS/IssueCommon/utils/Selector","DS/IssueServices/Contexts"],(function(e,t,n){var s=n.get("widget"),i=t.getSelection({type:"issue"});s.body.getElement(".isu-reopen-dialog")||new e({physicalIds:i.physicalIds}).render()}))}})})),define("DS/IssueCommon/utils/EventsHandler",["UWA/Class/Listener","UWA/Class/Promise","UWA/Controls/Abstract","UWA/Core","DS/IssueServices/Contexts","DS/PlatformAPI/PlatformAPI"],(function(e,t,n,s,i,a){"use strict";var o={INTERNAL_APPLICATIONS:["ENXISSU_AP","ENX3DIR_AP"],SUPPORTED_EVENTS:["DS/IssueManagementTask/add","DS/IssueManagementTask/ready","DS/IssueManagementTask/exec","DS/IssueManagementTask/done","DS/IssueManagementTask/cancel","DS/Object/create","DS/Object/delete","DS/Object/update","DS/Object/select"]};return n.extend(e,{name:"DS/IssueCommon/utils/EventsHandler",_logger:null,init:function(e){var t=this;t._parent(e),t._id=Math.random().toString(36).substr(2,9),t._subscriptions={"DS/Object/update":{"*":[],issue:{"*":[]}}},t._tokens={};var n=function(e){return function(n){if(s.is(n.metadata,"object")){if(s.is(n.metadata.options,"object")&&s.is(n.metadata.options.isuEventsHandlerId,"string")&&n.metadata.options.isuEventsHandlerId===t._id)return;if("DS/Object/select"===e&&n.metadata.appId!==i.get("widget").id&&"ENXISSU_AP"===n.metadata.appName)return}t.publish(t._id,e,n,!0)}};t._platformAPIListeners=o.SUPPORTED_EVENTS.map((function(e){return{event:e,listener:n(e)}}));for(var r=0;r<t._platformAPIListeners.length;r++){var d=t._platformAPIListeners[r];d.token=a.subscribe(d.event,d.listener)}},destroy:function(){this._subscriptions={}},subscribe:function(e,t,n,i){var a=this,o={id:Math.random().toString(36).substr(2,9),subscriberId:e,event:t,callback:n,conditions:s.is(i,"object")?i:null,subscriptions:[]};if(void 0===a._subscriptions[t]&&(a._subscriptions[t]={"*":[]}),s.is(i,"object")&&s.is(i.type,"string")){var r=i.type;void 0===a._subscriptions[t][r]&&(a._subscriptions[t][r]={"*":[]}),Array.isArray(i.attributes)&&i.attributes.length>0?i.attributes.forEach((function(e){void 0===a._subscriptions[t][r][e]&&(a._subscriptions[t][r][e]=[]),a._subscriptions[t][r][e].push(o.id),o.subscriptions.push({callback:n,event:t,type:r,attribute:e})})):(a._subscriptions[t][r]["*"].push(o.id),o.subscriptions.push({callback:n,event:t,type:r}))}else a._subscriptions[t]["*"].push(o.id),o.subscriptions.push({callback:n,event:t,type:"*"});return a._tokens[o.id]=o,o.id},unsubscribe:function(e){var t=this;if(t._tokens.hasOwnProperty(e)){var n=t._tokens[e];if(null===n.conditions||void 0===n.conditions){if(-1!==t._subscriptions[n.event]["*"].indexOf(e)){var i=t._subscriptions[n.event]["*"].indexOf(e);t._subscriptions[n.event]["*"].splice(i,1)}}else if(s.is(n.conditions.type,"string")&&s.is(t._subscriptions[n.event][n.conditions.type],"object"))if(Array.isArray(n.conditions.attributes))n.conditions.attributes.forEach((function(s){if(-1!==t._subscriptions[n.event][n.conditions.type][s].indexOf(e)){var i=t._subscriptions[n.event][n.conditions.type][s].indexOf(e);t._subscriptions[n.event][n.conditions.type][s].splice(i,1)}}));else if(-1!==t._subscriptions[n.event][n.conditions.type]["*"].indexOf(e)){var a=t._subscriptions[n.event][n.conditions.type]["*"].indexOf(e);t._subscriptions[n.event][n.conditions.type]["*"].splice(a,1)}delete t._tokens[e]}},publish:function(e,t,n,i){var r=this;if(void 0!==r._subscriptions[t]&&s.is(n.data,"object")&&Array.isArray(n.data.paths)&&s.is(n.data.attributes,"object")){var d={};n.data.paths.forEach((function(e){if(s.is(n.data.attributes[e],"object")&&s.is(n.data.attributes[e].type,"string")){var t=n.data.attributes[e].type.toLowerCase();Array.isArray(d[t])||(d[t]=[]),d[t].push(n.data.attributes[e])}}));var l=Object.keys(d);if(-1===o.INTERNAL_APPLICATIONS.indexOf(n.metadata.appName)){Object.keys(r._tokens).forEach((function(e){var i=r._tokens[e];i.event===t&&i.callback(s.clone(n))}))}else{var c=[];r._subscriptions[t]["*"].forEach((function(t){var i=r._tokens[t];-1===c.indexOf(t)&&i.subscriberId!==e&&(c.push(t),i.callback(s.clone(n)))})),l.forEach((function(i){if(s.is(r._subscriptions[t][i],"object")){r._subscriptions[t][i]["*"].forEach((function(t){var i=r._tokens[t];-1===c.indexOf(t)&&i.subscriberId!==e&&(c.push(t),i.callback(s.clone(n)))}));var a=d[i][0].modifiedAttributes,o=Object.keys(r._subscriptions[t][i]);if(Array.isArray(a))for(var l=0;l<o.length;l++){var u=o[l];-1===a.indexOf("*")&&-1===a.indexOf(u)||r._subscriptions[t][i][u].forEach((function(t){var i=r._tokens[t];-1===c.indexOf(t)&&i.subscriberId!==e&&(c.push(t),i.callback(s.clone(n)))}))}}}))}}if(!0!==i){var u=s.clone(n);s.is(u.metadata.options,"object")||(u.metadata.options={}),u.metadata.options.isuEventsHandlerId=r._id,a.publish(t,u)}}})})),define("DS/IssueCommon/commands/CreateIssuePLMNew",["DS/ENONewWidget/command/NewContentCommandBase","DS/PlatformAPI/PlatformAPI","DS/PADUtils/views/PADAlert","DS/IssueServices/Contexts","i18n!DS/IssueComponents/assets/nls/IssueComponents","DS/IssueServices/services/PlatformServices"],(function(e,t,n,s,i,a){"use strict";var o="IssueCommon";return e.extend({defaults:{type:"Issue"},init:function(e){this.app=e.app,this._parent(e)},getType(){return this.defaults.type},execute:function(){this.launchCreationDialog()},launchCreationDialog(){var e=this.getCreateOptions({});this.launchCreateNew(e)},getOptions(e){var r;return widget&&widget.getPreference("pad_security_ctx")&&(r=widget.getPreference("pad_security_ctx").value),{options:{typeName:"Issue"},context:{service:"3DSpace",tenant:a.getTenant(),header:{SecurityContext:r}},events:{onSuccess:function(e){let a=e.result[0].identifier;var r=s.get("widget")||window.widget,d=[],l={};d.push([a]),l[a]={};var c=Math.floor(Date.now()),u={metadata:{appId:r.id,appName:o,timestamp:c,options:{}},data:{paths:d,attributes:l},version:"1.0"};t.publish("DS/Object/create",u);const m=i.replace(i.create.creationSuccess,{title:""});n.displayNotification({msg:m.replace("''",""),eventID:"success"})},onFailure:function(e){n.displayNotification({msg:i.create.creationFailed,eventID:"error"})},onCancel:function(e){this.createOptsModel&&this.createOptsModel._attributes&&"ISU_MGMT"===this.createOptsModel._attributes.app&&s.get("component")._getCommandCheckHeaderForInlineCreate()}}}},_publishEvent:function(e,n){var i=s.get("widget")||window.widget,a=[],r={};a.push([e]),r[e]={};var d=Math.floor(Date.now()),l={metadata:{appId:i.id,appName:o,timestamp:d,options:{}},data:{paths:a,attributes:r},version:"1.0"};t.publish(n,l)}})})),define("DS/IssueCommon/facets/RelatedContent",["UWA/Core","UWA/Class/View","DS/IssueComponents/related/RelatedContent","DS/IssueServices/Contexts","DS/IssueServices/utils/Performance","css!DS/IssueCommon/IssueCommon.css"],(function(e,t,n,s,i){"use strict";return t.extend({name:"DS/IssueCommon/facets/RelatedContent",tagName:"div",className:"relatedContent-view fade-in-element",defaultOptions:{physicalIds:[]},related:null,_subscriberId:"",_eventListeners:[],setup:function(e){var t=this;i.start(t.name+" setup"),t._parent(e),t.relatedContent=new n({ids:t.getOption("physicalIds"),intercom:!0}),t._subscriberId=Math.random().toString(36).substr(2,9),t.listenTo(t.relatedContent,"onReady",(function(e){t.dispatchEvent("onReady",e)})),t.listenTo(t.relatedContent,"onFailure",(function(e){t.dispatchEvent("onFailure",e)})),t.listenTo(t.relatedContent,"onUpdate",(function(e){for(var n=[],i={},a=Object.keys(e.issues),o=0;o<a.length;o++)n.push([e.issues[a[o]].id]),i[e.issues[a[o]].id]={id:e.issues[a[o]].id,type:e.issues[a[o]].type,name:e.issues[a[o]].name,title:e.issues[a[o]].title,modifiedAttributes:e.relation};s.get("eventsHandler").publish(t._subscriberId,"DS/Object/update",{metadata:{appId:s.get("widget").id,appName:s.get("widget").name,timestamp:Math.floor(Date.now()),options:{}},data:{paths:n,attributes:i},version:"1.0"})})),t._eventListeners=[{event:"DS/Object/update",listener:function(e){t.relatedContent&&t.relatedContent.options.ids&&(e.data.paths.some((function(e){return-1!==t.relatedContent.options.ids.indexOf(e[0])}))&&t.relatedContent.refresh(t.relatedContent.options.ids))},conditions:{type:"issue",attributes:["reportedAgainst","resolvedItems","resolvedBy","contexts"]}}];for(var a=0;a<t._eventListeners.length;a++){var o=t._eventListeners[a];o.token=s.get("eventsHandler").subscribe(t._subscriberId,o.event,o.listener.bind(t),o.conditions)}i.end(t.name+" setup")},render:function(){var e=this;return i.start(e.name+" render"),e.relatedContent.render().inject(e.container),i.end(e.name+" render"),e},refresh:function(e){return this.setOption("physicalIds",e),this.relatedContent.refresh(e)},destroy:function(){var e=this;if(e.stopListening(e.relatedContent,"onReady"),e.stopListening(e.relatedContent,"onFailure"),e.stopListening(e.relatedContent,"onUpdate"),Array.isArray(e._eventListeners))for(var t=0;t<e._eventListeners.length;t++){var n=e._eventListeners[t];s.get("eventsHandler").unsubscribe(n.token)}e._eventListeners=[],e._subcriberId="",e.relatedContent.destroy(),e.relatedContent=null,e.container.empty()}})})),define("DS/IssueCommon/utils/Selector",["UWA/Core","DS/IssueServices/Contexts"],(function(e,t){"use strict";var n="Issue",s="ENXISSU_AP",i="ENX3DIR_AP",a=function(s){var i={physicalIds:[],issueNames:[],map:{}},a=s&&e.is(s.type,"string")?s.type:"all",o=[];null!=t.get("component")&&(o=t.get("component").getSelectedNodes());for(var r=0;r<o.length;r++){var d=o[r];"issue"!==a&&"all"!==a||d.options.type!==n&&d.options.baseType!==n||(i.physicalIds.push(d.options.physicalId),i.issueNames.push(d.options.name),i.map[d.options.physicalId]={id:d.options.physicalId,physicalId:d.options.physicalId,type:d.options.type,name:d.options.name,title:d.options.title,serviceId:"3DSpace",description:d.options.description,owner:d.options.owner,coOwners:d.options.coOwners,assignees:d.options.assignees,contributors:d.options.contributors,contexts:d.options.contexts,reportedAgainst:d.options.reportedAgainst,resolvedBy:d.options.resolvedBy,resolvedItems:d.options.resolvedItems}),"object"!==a&&"all"!==a||d.options.baseType===n||(i.physicalIds.push(d.options.physicalId),i.issueNames.push(d.options.name),i.map[d.options.physicalId]={id:d.options.physicalId,pid:d.options.pid,serviceId:d.options.serviceId,physicalId:d.options.physicalId,type:d.options.type,name:d.options.name,title:d.options.title})}return i},o=function(s){var i={physicalIds:[],issueNames:[],map:{}},a=s&&e.is(s.type,"string")?s.type:"all",o=t.get("component")?t.get("component").getManager():null;if(null===o)return i;for(var r=t.get("component").getSelectedIssues(),d=o.getIssues().map,l=0;l<r.length;l++){var c=d[r[l].id].model;"issue"!==a&&"all"!==a||c.get("type")!==n&&c.get("baseType")!==n||(i.physicalIds.push(c.get("physicalId")),i.issueNames.push(c.get("name")),i.map[c.get("physicalId")]={id:c.get("physicalId"),physicalId:c.get("physicalId"),type:c.get("type"),name:c.get("name"),title:c.get("title"),serviceId:"3DSpace",description:c.get("description"),owner:c.get("owner"),coOwners:c.get("coOwners"),assignees:c.get("assignees"),contributors:c.get("contributors"),contexts:c.get("contexts"),reportedAgainst:c.get("reportedAgainst"),resolvedBy:c.get("resolvedBy"),resolvedItems:c.get("resolvedItems")}),"object"!==a&&"all"!==a||c.type===n&&c.get("baseType")===n||(i.physicalIds.push(c.id),i.issueNames.push(c.name),i.map[c.id]={id:c.id,physicalId:c.id,type:c.type,name:c.name,title:c.title,serviceId:"3DSpace"})}return i},r=function(e){for(var n={physicalIds:[],issueNames:[],map:{}},s=(t.get("templateComponentDialog")?t.get("templateComponentDialog"):t.get("templateComponent")).document.getSelectedTemplateNodes(),i=0;i<s.length;i++){var a=s[i];n.physicalIds.push(a.options.physicalId),n.issueNames.push(a.options.name),n.map[a.options.physicalId]={id:a.options.physicalId,physicalId:a.options.physicalId,type:a.options.type,name:a.options.name,title:a.options.title,serviceId:"3DSpace",description:a.options.description,owner:a.options.owner,coOwners:a.options.coOwners,assignees:a.options.assignees,contributors:a.options.contributors,contexts:a.options.contexts,reportedAgainst:a.options.reportedAgainst,resolvedBy:a.options.resolvedBy,resolvedItems:a.options.resolvedItems}}return n};return{getSelection:function(e){var n=t.get("widget")||window.widget;return n.name===s?n.getValue("IsIssueSummaryView")?a(e):r(e):n.name===i?t.get("templateComponentDialog")?r(e):o(e):{physicalIds:[],issueNames:[],map:{}}}}})),define("DS/IssueCommon/commands/Delete",["UWA/Class","DS/ApplicationFrame/Command"],(function(e,t){"use strict";return e.extend(t,{init:function(e){this._parent(e)},execute:function(){require(["DS/IssueComponents/delete/Delete","DS/IssueCommon/utils/Selector","DS/IssueServices/Contexts"],(function(e,t,n){var s=n.get("widget")||window.widget,i=t.getSelection({type:"issue"});s.body.getElement(".delete-issues-dialog")||new e({physicalIds:i.physicalIds}).render()}))}})})),define("DS/IssueCommon/utils/DocumentUtils",["UWA/Promise","DS/IssueServices/services/PlatformServices","DS/PADUtils/views/PADAlert","DS/DocumentManagement/DocumentManagement"],(function(e,t,n,s){"use strict";return{init:function(){},preview:function(e){this._loadCommands(e,"Preview")},edit:function(e){this._loadCommands(e,"Edit")},undoEdit:function(e){this._loadCommands(e,"UndoEdit")},update:function(e){this._loadCommands(e,"Update")},download:function(e){this._loadCommands(e,"Download")},getDocumentsData:function(n){return new e((function(e,i){s.getDocuments(n,{tenant:t.getTenant(),securityContext:"ctx::"+decodeURIComponent(t.getSecurityContext()),tenantUrl:t.get3DSpaceUrl(),additionalURLParams:"$fields=indexedTypeicon",onComplete:function(t){t.success&&Array.isArray(t.data)?e(t):i()},onFailure:function(e){i()}})}))},_loadCommands:function(e,n){var s=this;require(["DS/DocumentCommands/ENOXDocumentCommands","DS/DocumentCommands/DocumentCommandsV2","DS/CoreEvents/ModelEvents","DS/IssueCommon/utils/Utils"],(function(i,a,o,r){var d=decodeURIComponent(t.getSecurityContext()),l=t.getTenant(),c=t.get3DSpaceUrl(),u=t.get3DDashboardUrl(),m=(t.get3DSwymUrl(),t.getPlatformUrl()),p={};if("Download"===n||"Preview"===n){var g=e.selected.map((function(e){return e.id}));s.getDocumentsData(g).then((function(e){var i=e.data,d=new o;d.subscribe({event:"docv2-show-notification"},(function(e){r.displayErrorMessage(e,e.level)})),d.subscribe({event:"docv2-undoedit-complete"},(function(e){s.getDocumentsData(g).then((function(t){i=t.data,d.publish({event:"docv2-preview-reload-toolbar",data:{nodeModel:e.nodeModel}})}))})),d.subscribe({event:"docv2-edit-complete"},(function(e){s.getDocumentsData(g).then((function(t){i=t.data,d.publish({event:"docv2-preview-reload-toolbar",data:{nodeModel:e.nodeModel}})}))})),d.subscribe({event:"docv2-update-complete"},(function(e){s.getDocumentsData(g).then((function(t){i=t.data,d.publish({event:"docv2-preview-reload-toolbar",data:{nodeModel:e.nodeModel}}),d.publish({event:"docv2-preview-reload-viewer",data:{nodeModel:e.nodeModel}})}))})),new a(p={fetchSecurityContext:function(){return decodeURIComponent(t.getSecurityContext())},getSelectedNodes:function(){return i},getDocumentFromNodeModel:function(e){return e},platformUrls:m,events:d}).commands[n].execute()}))}else{p={document:{id:e.data.id,contextId:d,serviceId:"3DSpace",envId:l,index:1,data:e.data,type:"Document"},platformUrls:{"3DSpace":c,"3DDashboard":u},onComplete:function(t){"Update"===t.action&&"attachments"===e.from&&e.menu.dispatchEvent("request:updateFile",{item:e.selected[0],lock:!0})}};var I=new i;I.init(p),s.cmds=I.render(),s.cmds[n].handler()}}))}}})),define("DS/IssueCommon/commands/Compare",["DS/ApplicationFrame/Command"],(function(e){"use strict";return e.extend({execute:function(){var e=this;require(["DS/IssueCommon/utils/Selector","DS/IssueComponents/external/Compare"],(function(t,n){e.selection=t.getSelection({type:"all"});var s=[];Object.keys(e.selection.map).forEach((function(t){var n=e.selection.map[t].physicalId.split(","),i=n[n.length-1];s.push({physicalId:i.includes("i3dx:")?e.selection.map[t].pid:i,type:e.selection.map[t].type,serviceId:e.selection.map[t].serviceId})})),n.execute(s)}))}})})),define("DS/IssueCommon/commands/RelationalExplorer",["DS/ApplicationFrame/Command"],(function(e){"use strict";return e.extend({execute:function(){require(["DS/IssueCommon/utils/Selector","DS/IssueComponents/external/RelationalExplorer"],(function(e,t){var n=e.getSelection({type:"all"}),s=[];n.physicalIds.forEach((function(e){var t=e.split(","),i=t[t.length-1],a=n.map[i]?n.map[i].serviceId:"3DSpace";if(i.includes("i3dx:")&&(i=n.map[i].pid),!s.some((e=>e.id===i))){var o={id:i,serviceId:a};s.push(o)}})),t.execute(s)}))}})})),define("DS/IssueCommon/commands/Duplicate",["UWA/Class","DS/ApplicationFrame/Command"],(function(e,t){"use strict";return e.extend(t,{init:function(e){this._parent(e)},execute:function(){require(["DS/IssueComponents/duplicate/Duplicate","DS/IssueCommon/utils/Selector","DS/IssueServices/Contexts"],(function(e,t,n){var s=n.get("widget")||window.widget,i=t.getSelection({type:"issue"});s.body.getElement(".duplicate-issues-dialog")||new e({physicalIds:i.physicalIds}).render()}))}})})),define("DS/IssueCommon/commands/3DMarkup",["DS/ApplicationFrame/Command"],(function(e){"use strict";return e.extend({execute:function(){require(["DS/IssueCommon/utils/Selector","DS/IssueComponents/external/3DMarkup"],(function(e,t){var n=e.getSelection({type:"all"});t.execute(n.physicalIds)}))}})})),define("DS/IssueCommon/facets/Attachments",["UWA/Class/Promise","UWA/Core","UWA/Class/View","DS/IssueAttachmentManager/IssueAttachmentManager","DS/IssueCommon/commands/CommandsManager","DS/IssueCommon/facets/Placeholder","DS/IssueServices/Contexts","DS/IssueServices/utils/Performance","css!DS/IssueCommon/IssueCommon.css","i18n!DS/IssueCommon/assets/nls/IssueCommon"],(function(e,t,n,s,i,a,o,r,d,l){"use strict";var c="ENXISSU_AP",u="ENX3DIR_AP";return n.extend({name:"DS/IssueCommon/facets/Attachments",tag:"div",className:"attachments-view fade-in-element",manager:null,_subscriberId:"",_eventListeners:[],setup:function(n){var i=this;i.options=n,r.start(i.name+" setup"),i._parent(n),i._deferred={},i.isLoaded=new e((function(e,t){i._deferred.resolve=e,i._deferred.reject=t})),i.target=t.createElement("div",{class:"attachments-content"}),i.container.setContent(i.target);var a=o.get("widget")||window.widget,d=o.get("component"),l=a.body?a.body.getDimensions():a.getDimensions();n.facet&&a.setValue("isPropertiesFacet",!0);var c={mode:2,catalogLayout:"function"==typeof a.getValue&&a.getValue("attachmentLayout")?a.getValue("attachmentLayout"):1,catalogVisibility:!0,sliderVisibility:!1,annotationPreLaunchCallback:function(){if(i.hasOwnProperty("modal")&&i.modal.hide(),a.name===u)try{this.annotationCanvasTarget=t.Element.getElement.call(d.get3DContext().root.getFrameWindow().elements.viewerFrame,"canvas")}catch(e){}else this.annotationCanvasDefaultDimensions={width:l.width-50,height:l.height-50}}},m="function"==typeof a.getValue&&a.getValue("attachmentManagerPreferences")?a.getValue("attachmentManagerPreferences"):{};c=t.merge(c,m||{});var p=i.getOption("physicalIds");c.id=p[p.length-1],i.manager=new s(c),i._subscriberId=Math.random().toString(36).substr(2,9),r.end(i.name+" setup")},render:function(){var e=this;!1===e.isValidSelection()?(e.target.hide(),e.placeholder.show(e.container)):(e.placeholder.hide(e.container),e.target.show()),r.start(e.name+" render");var t=o.get("component");return e.manager.render().inject(e.target),e.manager.isLoaded.then((function(){e.utils._addCustomCommands.apply(e),e.manager.container.setAttribute("tabindex","0"),e.manager.container.focus(),e.manager.resize(),e.listenTo(e.manager,"onRefresh",e.utils._addCustomCommands.bind(e)),t?e.listenTo(t,"onResize",(function(){e.manager.resize()})):e.listenTo(window.widget,"onResize",(function(){e.manager.resize()})),e.listenTo(e.manager,"onUpdate",(function(t){for(var n=[],s={},i=Object.keys(t.objects),a=0;a<i.length;a++)n.push([t.objects[i[a]].physicalId]),s[t.objects[i[a]].physicalId]={id:t.objects[i[a]].physicalId,type:t.objects[i[a]].type||"Issue",modifiedAttributes:["attachments"]};o.get("eventsHandler").publish(e._subscriberId,"DS/Object/update",{metadata:{appId:o.get("widget")?o.get("widget").id:window.widget.id,appName:o.get("widget")?o.get("widget").name:window.widget.name,timestamp:Math.floor(Date.now()),options:{}},data:{paths:n,attributes:s},version:"1.0"})})),e._eventListeners=[{event:"DS/Object/update",listener:function(t){e.manager&&e.manager.id&&(t.data.paths.some((function(t){return e.manager.id===t[0]}))&&e.manager.refresh())},conditions:{type:"issue",attributes:["attachments","state"]}}];for(var n=0;n<e._eventListeners.length;n++){var s=e._eventListeners[n];s.token=o.get("eventsHandler").subscribe(e._subscriberId,s.event,s.listener.bind(e),s.conditions)}e._deferred.resolve(),e.dispatchEvent("onReady",{})})),r.end(e.name+" render"),e},refresh:function(t){var n=this;return n.setOption("physicalIds",t),n.isLoaded=new e((function(e,t){n._deferred.resolve=e,n._deferred.reject=t})),!1===n.isValidSelection()?(n.target.hide(),n.placeholder.show(n.container),setTimeout((function(){n._deferred.resolve(),n.dispatchEvent("onReady",{})}),0),n.isLoaded):(n.placeholder.hide(n.container),n.target.show(),n.options.physicalIds=t,n.manager.refresh(n.options.physicalIds[n.options.physicalIds.length-1]).then((function(){n._deferred.resolve()})),n.isLoaded)},resize:function(){this.manager.resize()},destroy:function(){var e=this,t=o.get("component");if(e.stopListening(t,"onResize"),e.stopListening(e.manager,"onUpdate"),e.stopListening(e.manager,"onRefresh"),Array.isArray(e._eventListeners))for(var n=0;n<e._eventListeners.length;n++){var s=e._eventListeners[n];o.get("eventsHandler").unsubscribe(s.token)}e._eventListeners=[],e._subcriberId="",null!==e.manager&&(e.manager.destroy(),e.manager=null),e.destroy()},isValidSelection:function(){var e=this.getOption("physicalIds");return Array.isArray(e)&&1===e.length},placeholder:{_view:new a,show:function(e){this._view.render("attachments").inject(e),this._view.show()},hide:function(){this._view.hide(),this._view.empty()}},utils:{_addCustomCommands:function(){var e=this,t=function(){i.getCommand("AttachmentManager").begin({authoring:e.manager.authoring})};(e.manager.views.header.iconBarFix.addItem({id:"popup",fonticon:"popup",text:l.attachments.popup,selectable:!0,handler:t}),o.get("widget").name===c?e.manager.views.header.iconBarFix.getItem("popup").elements.container.show():e.manager.views.header.iconBarFix.getItem("popup").elements.container.hide(),this.manager&&this.manager.contextualMenu&&this.manager.contextualMenu.customCommands)&&(this.manager.contextualMenu.customCommands.some((function(e){return"popup"===e.name}))||this.manager.contextualMenu.customCommands.push({name:"popup",title:l.attachments.popup,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x fonticon-popup"},data:null,action:{callback:t}}))}}})})),define("DS/IssueCommon/facets/MembersFacet",["UWA/Core","DS/EditPropWidget/facets/Common/FacetsBase","DS/EditPropWidget/constants/EditPropConstants","UWA/Class/Model","DS/UIKIT/Mask","DS/IssueServices/services/PlatformServices","DS/IssueCommon/utils/EventsHandler","DS/IssueServices/Contexts"],(function(e,t,n,s,i,a,o,r){"use strict";var d=t.extend({init:function(){this._parent.apply(this,arguments),this.elements.container||(this.elements.container=e.createElement("div",{id:"members-container"})),this.eventsHandler=new o,r.add("eventsHandler",this.eventsHandler)},updateFacet:function(){var e=this;i.mask(this.elements.container),a.initPlatformServices().then((()=>{require(["DS/IssueCommon/facets/Team"],(function(t){if(e.elements&&e.elements.container){var n=e.getModel();if(!n)return!1;if(1==n.isMergedModel())return;var s={model:n,container:e.elements.container,physicalIds:[n.get("objectId")]};e.elements.container.setContent(""),new t(s).render(),i.unmask(e.elements.container)}}))}))},destroyComponent:function(){e.is(this.destroy,"function")&&this.destroy()}});return d})),define("DS/IssueCommon/facets/CommentsFacet",["UWA/Core","DS/EditPropWidget/facets/Common/FacetsBase","DS/EditPropWidget/constants/EditPropConstants","UWA/Class/Model","DS/UIKIT/Mask","DS/IssueServices/services/PlatformServices","DS/IssueCommon/utils/EventsHandler","DS/IssueServices/Contexts"],(function(e,t,n,s,i,a,o,r){"use strict";var d=t.extend({init:function(){this._parent.apply(this,arguments),this.elements.container||(this.elements.container=e.createElement("div",{id:"contents-container"})),this.eventsHandler=new o,r.add("eventsHandler",this.eventsHandler)},updateFacet:function(){var e=this;i.mask(this.elements.container),a.initPlatformServices().then((()=>{require(["DS/IssueCommon/facets/Comments"],(function(t){if(e.elements&&e.elements.container){var n=e.getModel();if(!n)return!1;if(1==n.isMergedModel())return;var s={model:n,container:e.elements.container,physicalIds:[n.get("objectId")]};e.elements.container.setContent(""),new t(s).render(),widget.setValue("isPropertiesFacet",!0),i.unmask(e.elements.container)}}))}))},destroyComponent:function(){e.is(this.destroy,"function")&&this.destroy()}});return d})),define("DS/IssueCommon/facets/HistoryFacet",["UWA/Core","DS/EditPropWidget/facets/Common/FacetsBase","DS/EditPropWidget/constants/EditPropConstants","UWA/Class/Model","DS/UIKIT/Mask","DS/IssueServices/services/PlatformServices","DS/IssueCommon/utils/EventsHandler","DS/IssueServices/Contexts"],(function(e,t,n,s,i,a,o,r){"use strict";var d=t.extend({init:function(){this._parent.apply(this,arguments),this.elements.container||(this.elements.container=e.createElement("div",{id:"History-container"})),this.eventsHandler=new o,r.add("eventsHandler",this.eventsHandler)},updateFacet:function(){var e=this;i.mask(this.elements.container),a.initPlatformServices().then((()=>{require(["DS/IssueCommon/facets/History"],(function(t){if(e.elements&&e.elements.container){var n=e.getModel();if(!n)return!1;if(1==n.isMergedModel())return;var s={model:n,container:e.elements.container,physicalIds:[n.get("objectId")],facet:!0};e.elements.container.setContent(""),e.HistoryView=new t(s),e.HistoryView.render(),i.unmask(e.elements.container)}}))}))},onResize:function(){this.HistoryView.resize()},destroyComponent:function(){e.is(this.destroy,"function")&&this.destroy(),this.destroy()}});return d})),define("DS/IssueCommon/facets/AttachmentFacet",["UWA/Core","DS/EditPropWidget/facets/Common/FacetsBase","DS/EditPropWidget/constants/EditPropConstants","UWA/Class/Model","DS/UIKIT/Mask","DS/IssueServices/services/PlatformServices","DS/IssueCommon/utils/EventsHandler","DS/IssueServices/Contexts"],(function(e,t,n,s,i,a,o,r){"use strict";var d=t.extend({init:function(){this._parent.apply(this,arguments),this.elements.container||(this.elements.container=e.createElement("div",{id:"members-container"})),this.eventsHandler=new o,r.add("eventsHandler",this.eventsHandler),r.add("widget",window.widget)},updateFacet:function(){var e=this;i.mask(this.elements.container),a.initPlatformServices().then((()=>{require(["DS/IssueCommon/facets/Attachments"],(function(t){if(e.elements&&e.elements.container){var n=e.getModel();if(!n)return!1;if(1==n.isMergedModel())return;var s={model:n,container:e.elements.container,physicalIds:[n.get("objectId")],facet:!0};e.elements.container.setContent(""),new t(s).render(),i.unmask(e.elements.container)}}))}))},destroyComponent:function(){e.is(this.destroy,"function")&&this.destroy()}});return d})),define("DS/IssueCommon/facets/ContentsFacet",["UWA/Core","DS/EditPropWidget/facets/Common/FacetsBase","DS/EditPropWidget/constants/EditPropConstants","UWA/Class/Model","DS/UIKIT/Mask","DS/IssueServices/services/PlatformServices","DS/IssueCommon/utils/EventsHandler","DS/IssueServices/Contexts"],(function(e,t,n,s,i,a,o,r){"use strict";var d=t.extend({init:function(){this._parent.apply(this,arguments),this.elements.container||(this.elements.container=e.createElement("div",{id:"contents-container"})),this.eventsHandler=new o,r.add("eventsHandler",this.eventsHandler)},updateFacet:function(){var e=this;i.mask(this.elements.container),a.initPlatformServices().then((()=>{require(["DS/IssueCommon/facets/RelatedContent"],(function(t){if(e.elements&&e.elements.container){var n=e.getModel();if(!n)return!1;if(1==n.isMergedModel())return;var s={model:n,container:e.elements.container,physicalIds:[n.get("objectId")]};e.elements.container.setContent(""),new t(s).render(),widget.setValue("isPropertiesFacet",!0),i.unmask(e.elements.container)}}))}))},destroyComponent:function(){e.is(this.destroy,"function")&&this.destroy()}});return d})),define("DS/IssueCommon/commands/ChangeOwner",["UWA/Core","UWA/Class/Promise","UWA/Class","DS/ApplicationFrame/Command","DS/IssueCommon/utils/Selector","DS/IssueServices/services/IssueServices","DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_TransferOwnershipCmd","DS/LifecycleServices/LifecycleServicesSettings","DS/PlatformAPI/PlatformAPI","DS/IssueCommon/commands/CommandsManager","DS/IssueServices/Contexts","DS/IssueServices/services/PlatformServices"],(function(e,t,n,s,i,a,o,r,d,l,c,u){"use strict";var m=200;return n.extend({init:function(e){this._parent(e,{isAsynchronous:!0})},execute:async function(t){var n=this;require([],(function(){var s=c.get("widget")||window.widget,a=l.getCommand("ActionBar_TransferOwnershipCmd_"+s.id);e.is(a,"object")?a.begin():r.app_initialization((function(){n.getSelection(t).then((e=>{var t=[];e.physicalIds.forEach((function(n){var s={getID:function(){return e.map[n].id},getLabel:function(){return e.map[n].title}};t.push(s)}));var n={securityContext:{SecurityContext:"ctx::"+decodeURIComponent(u.getSecurityContext())},getSecurityContext:function(){return this.securityContext},getSelectedNodes:function(){return t}};(a=new o({ID:"ActionBar_TransferOwnershipCmd_"+s.id,context:n})).onEnd((function(){var e=setInterval((function(){a.transferOwnershipPanel&&a.transferOwnershipPanel.addEvent&&(clearInterval(e),a.transferOwnershipPanel.addEvent("onClose",(function(){for(var e=[],t={},n=i.getSelection({type:"issue"}),a=n.physicalIds,o=0;o<a.length;o++)e.push([n.map[a[o]].id]),t[n.map[a[o]].id]={id:n.map[a[o]].id,type:n.map[a[o]].type,name:n.map[a[o]].name,title:n.map[a[o]].title,modifiedAttributes:["owner"]};d.publish("DS/Object/update",{metadata:{appId:s.id,appName:s.name,timestamp:Math.floor(Date.now())},data:{paths:e,attributes:t},version:"1.0"})})))}),m)})),a.begin()}))}))}))},getSelection:function(e){return new t((function(t,n){var s=i.getSelection({type:"issue"});0==s.physicalIds.length?e.length>0&&a.issues.retrieve({data:{objects:e.reduce((function(e,t){return e.push({physicalId:t}),e}),[])}}).then((function(e){for(var n=0;n<e.results.length;n++){var i=e.results[n].body,a={};a.id=i.physicalId,a.title=i.title,s.physicalIds.push(a.id),s.map[i.physicalId]=a}t(s)})):t(s)}))}})})),define("DS/IssueCommon/utils/Utils",["UWA/Class/Promise","UWA/Controls/Input","UWA/Core","DS/UIKIT/Mask","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger","DS/PADUtils/views/PADAlert","DS/WebappsUtils/WebappsUtils","DS/IssueServices/services/IssueServices","DS/IssueCommon/utils/Selector","DS/Utilities/DateUtils","DS/IssueServices/services/PlatformServices","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/TransientWidget/TransientWidget","DS/IssueServices/Contexts","DS/ApplicationFrame/ActionBar","DS/IssueCommon/commands/CommandsManager","DS/IssueTracker/IssueTracker","DS/IssueTracker/IssueDimension","DS/IssueTracker/IssueDimensionMapping","DS/IssueTracker/IssueValue","i18n!DS/IssueCommon/assets/nls/IssueCommon"],(function(e,t,n,s,i,a,o,r,d,l,c,u,m,p,g,I,S,f,h,E,v,y,b){"use strict";var A="Issue",C=["created","modified","estimatedStartDate","estimatedEndDate","actualStartDate","actualEndDate","resolutionDate"],D=10,w="#dashboard:/tab:/app:ENXISSU_AP/content:XSharedContentId=",T={TREE_TYPE_RESOLVED_BY:"resolvedBy"},_={getIconByState:function(e,t,n){return n.indexOf("http")>=0?n:n.indexOf("http")<0||n.indexOf("common/images")?n.indexOf("http")>=0?n:u.get3DSpaceUrl()+"/"+n:""==n||n.indexOf("http")<0?(n="common/images/iconSmallIssue.png").indexOf("http")>=0?n:u.get3DSpaceUrl()+"/"+n:n},getFormattedDate:function(e,t){for(var n=window.widget.lang,s=C,i=0;i<s.length;i++)isNaN(Date.parse(e[s[i]]))?e[s[i]]="":e[s[i]]=new Date(e[s[i]]).toLocaleString(n,t);return e},getTypeRepOfAttribute:function(e){let t="string";if(e.type)return"timestamp"===e.type?"date":"real"===e.type?"number":e.type;let n="";if(e.range&&e.range.dataTypes){const s=e.range.dataTypes[0].indexOf("#");switch(n=e.range.dataTypes[0].slice(s+1),n){case"real":case"integer":t="number";break;case"timestamp":t="datetime";break;case"boolean":t="boolean";break;default:t="string"}}return t},getFormattedValueAsPerTypeRepresentation:function(e,t){const n=I.get("CustomAttributesPredicates");if(n&&!n[e])return t;let s="";switch(n[e].typeRepresentation){case"datetime":case"date":s=new Date(t),"Invalid Date"==s&&(s="");break;case"timestamp":s=new Date(t);break;case"integer":s=""!==t?parseInt(t):t;break;case"real":case"number":if(isNaN(t))try{let e=JSON.parse(t);Array.isArray(e)&&(s=e)}catch(e){s=""}else s=""!==t?Number(t):t;break;case"boolean":s="FALSE"!=t&&"false"!=t&&"False"!=t&&(""!==t?Boolean(t):t);break;default:s=t}return s},setColumnFilteringOnColumn:function(e,t){var n=e.getTreeDocument().getFilterManager();const s=this._getFilterIdForColumn(t);n.setPropertyFilterModel(t.dataIndex,{filterId:s})},setColumnFilteringOnAllColumns:function(e){var t=e.getTreeDocument().getFilterManager();const n=["ds6w:contexts","ds6w:reportedAgainst","ds6w:resolvedBy","ds6w:priority","ds6w:state","Approvals"];e.columns.forEach((e=>{if(n.indexOf(e.dataIndex)>=0){let n=e.dataIndex;t.setPropertyFilterModel(n,{filterId:"set"})}else if(n.indexOf(e.dataIndex)<0){const n=this._getFilterIdForColumn(e);let s=e.dataIndex;"tree"===e.dataIndex&&(s="label"),t.setPropertyFilterModel(s,{filterId:n})}}))},_getFilterIdForColumn:function(e){let t="set";switch(e.typeRepresentation?e.typeRepresentation:"string"){case"datetime":t="date";break;case"integer":case"real":case"number":t="number";break;case"boolean":t="set";break;default:t="string"}return t},getTextFromHTML:function(e){var t=n.createElement("div",{html:n.String.escapeHTML(e)});return t.textContent||t.innerText||""},timeSince:function(e){var t=Math.floor((new Date-e)/1e3),n=Math.floor(t/31536e3);return n>1?b.replace(b.dates.years,{number:n}):(n=Math.floor(t/2592e3))>1?b.replace(b.dates.months,{number:n}):(n=Math.floor(t/86400))>1?b.replace(b.dates.days,{number:n}):(n=Math.floor(t/3600))>1?b.replace(b.dates.hours,{number:n}):(n=Math.floor(t/60))>1?b.replace(b.dates.minutes,{number:n}):b.replace(b.dates.seconds,{number:Math.floor(t>=0?t:0)})},uploadImages:function(n){var s=this;return new e((function(e){var s=new t.File("Input.File",{visibility:"hidden",styles:{display:"none"}});s.elements.container.setStyle("display","none"),s.elements.input.multiple=void 0===n||n,s.elements.input.accept="image/png, image/jpeg",s.elements.input.addEventListener("change",(function(t){s.destroy(),s=null,e(t.target.files)}),!1),s.elements.input.addEventListener("click",(function(e){e.stopPropagation()})),s.elements.input.click()})).then((function(t){if(0===(t=Array.from(t)).length)return e.reject(new Error("No selected files to be uploaded"));var n=[];return t.forEach((function(e){n.push(s.isImage(e))})),e.all(n)})).then((function(t){return 0===(t=t.reduce((function(e,t){return"success"===t.status?e.push(t.file):o.displayNotification({msg:b.replace(b.images.errorUpload,{name:t.file.name}),eventID:"error"}),e}),[])).length?e.reject(new Error("No valid files to be uploaded")):e.resolve(t)}))},isImage:function(t){var n=new FileReader;return new e((function(e){n.onload=function(n){var s=n.target.result,i=new Uint8Array(s);255===i[0]&&216===i[1]&&255===i[i.byteLength-2]&&217===i[i.byteLength-1]||137===i[0]&&80===i[1]&&78===i[2]&&71===i[3]?e({status:"success",file:t}):(71===i[0]&&73===i[1]&&70===i[2]&&56===i[3]||66===i[0]&&i[1],e({status:"error",file:t}))},n.readAsArrayBuffer(t)}))},readImageURI:function(t){var n=new FileReader;return new e((function(e){n.onload=function(t){e(t.target.result)},n.readAsDataURL(t)}))},showRevisionModal:function(e){new S({context:{},file:"IssueRevision.xml",module:"IssueCommon"});!1===e.nodeModel.isSelected()&&e.nodeModel.select();u.get3DSpaceUrl(),u.get3DDashboardUrl(),I.get("widget")||window.widget;var t=[];"object"==typeof e.nodeModel.options.icons[0]&&e.nodeModel.options.icons.shift(),t.push(e.nodeModel);var n=function(){return t}().map((function(e){var t=e,n=t.options.id.split(",");return t.options.id=n[n.length-1],t.options.physicalId&&0!=t.options.physicalId.length||(t.options.physicalId=t.options.data.id),t.getID||(t.getID=function(){return physicalID}),t})),s={getSelectedNodes:()=>n};if(e.nodeModel){var i=f.getCommand("HistoryHdr");i.context=s,i&&i.begin()}},_debounceTimeouts:[],debounce:function(e,t,n){var s,i=this;return function(){var a=this,o=arguments,r=n&&!s;clearTimeout(s);var d=i._debounceTimeouts.indexOf(s);-1!==d&&i._debounceTimeouts.splice(d,1),s=setTimeout((function(){s=null,n||e.apply(a,o)}),t),i._debounceTimeouts.push(s),r&&e.apply(a,o)}},throttle:function(e,t,n){var s,i,a,o=null,r=0;n||(n={});var d=function(){r=!1===n.leading?0:Date.now(),o=null,a=e.apply(s,i),o||(s=i=null)};return function(){var l=Date.now();r||!1!==n.leading||(r=l);var c=t-(l-r);return s=this,i=arguments,c<=0||c>t?(o&&(clearTimeout(o),o=null),r=l,a=e.apply(s,i),o||(s=i=null)):o||!1===n.trailing||(o=setTimeout(d,c)),a}},isValid3DXContent:function(e){if(n.equals(e,null)||n.equals(e,void 0))return!1;if(!e.hasOwnProperty("protocol")||!n.equals(e.protocol,"3DXContent"))return!1;if(!e.hasOwnProperty("version")||!n.is(e.version,"string"))return!1;if(!e.hasOwnProperty("source")||!n.is(e.source,"string"))return!1;if(e.hasOwnProperty("widgetId")&&!n.is(e.widgetId,"string"))return!1;if(!e.hasOwnProperty("data")||!n.is(e.data,"object"))return!1;if(!e.data.hasOwnProperty("items")||!n.is(e.data.items,"array"))return!1;if(e.data.items.length>0&&!e.data.items.every((function(e){if(!e.hasOwnProperty("envId")||!n.is(e.envId,"string"))return!1;if(!e.hasOwnProperty("objectId")||!n.is(e.objectId,"string"))return!1;if(!e.hasOwnProperty("serviceId")||!n.is(e.serviceId,"string")||!e.serviceId.toLowerCase().includes("3dspace")&&!e.hasOwnProperty("i3dx")||!e.serviceId.toLowerCase().includes("3dspace")&&e.hasOwnProperty("i3dx")&&""==e.i3dx)return!1;if(!e.hasOwnProperty("objectType")||!n.is(e.objectType,"string"))return!1;if(e.hasOwnProperty("displayName")&&!n.is(e.displayName,"string"))return!1;if(e.hasOwnProperty("contextId")&&!n.is(e.contextId,"string"))return!1;if(e.hasOwnProperty("displayPreview")&&!n.is(e.displayPreview,"string"))return!1;if(e.hasOwnProperty("displayIcon")&&!n.is(e.displayIcon,"string"))return!1;if(e.hasOwnProperty("path")){if(!n.is(e.path,"array"))return!1;if(!e.path.every((function(e){return!(!e.hasOwnProperty("resourceid")||!n.is(e.resourceid,"string"))&&!(e.hasOwnProperty("type")&&!n.is(e.type,"string"))})))return!1}return!0})))return!1;return!0},computeSharedIssuesURL:function(e){var t=u.get3DDashboardUrl()+w;return t+=encodeURIComponent(JSON.stringify({issues:n.clone(e)}))},copyTextToClipboard:function(e){var t=document.createElement("textarea");t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.width="2em",t.style.height="2em",t.style.padding=0,t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value=e,document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(e){}document.body.removeChild(t)},isJson:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},isInteger:function(e){return Number.isInteger?Number.isInteger(e):"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},addCSSMaturityClasses:function(e,t){var n=this,s={};if(void 0===t.policies)return;let i=t.policies;for(let e=0;i&&e<i.length;e++){s[i[e].policyName]=i[e].states}for(let t in s){let i=s[t];for(let s=0;s<i.length;s++){let a=i[s].activeColor,o="{color:"+("#FFFFFF"===a?"#000000":"#FFFFFF")+" ; background-color:"+a+";}",r=n.cleanStatusForCSS(i[s].stateSysName),d="lc-status-"+n.cleanStatusForCSS(t)+"-"+r+(e?"-withClass":""),l="."+d+(e?" ."+e:"");n.createCSSClass(d,o,l)}}},cleanStatusForCSS:function(e){return e.replace(/(\.| )/g,"-")},createCSSClass:function(e,t,n){if(null===document.getElementById(e)){var s=document.createElement("style");s.type="text/css",s.id=e;let i=n||"."+e;s.innerHTML=i+t,document.getElementsByTagName("head")[0].appendChild(s)}},publishSelectAll:function(e){var t=I.get("widget")||window.widget,n=t.getValue("appId")+"_"+t.id,s=[];e.paths.forEach((e=>{e[0].includes("i3dx")&&s.push(e[0])}));var a={metadata:{uid:Math.random(),originUid:Math.random(),appid:n,originWidgetId:t.id,timestamp:Math.floor(Date.now())},data:{paths:e.paths,i3dxIds:s,attributes:e.attributes,version:"1.1",tenant:u.getTenant()}};i.publish("DS/ENO/select",a),i.publish("DS/PADUtils/PADCommandProxy/select",a),t.setValue("xHighlightFlag",!0),setTimeout((()=>{t.setValue("xHighlightFlag",!1)}),1e3)},getNLSValueForCustomAttr:function(e,t){let n=[];return e.split(",").forEach((e=>{t.literalInfo.forEach((t=>{e.trim()==t.value.trim()&&n.push(t.nlsValue)}))})),n},setClassificationAttrNLS:function(e){if(Array.isArray(e)&&e[0].properties&&Array.isArray(e[0].properties)){let t=e[0].properties,n=[];if(t.map((e=>n.push(e.curi))),n.length>0)return d.getNLSNames({data:n.toString()}).then((e=>{if(e&&e.vocabularyElementNLSInfo&&Array.isArray(e.vocabularyElementNLSInfo)){let n=e.vocabularyElementNLSInfo;const s=new Map(n.map((e=>[e.uri,e.nlsName])));t=t.map((e=>s.has(e.curi)?{...e,predicateNLS:s.get(e.curi)}:e))}})).catch((e=>{console.error("Error:",e)})).finally((()=>{var e=t.reduce(((e,t)=>{const{selectable:n,label:s,rangeValues:i,predicateNLS:a}=t;if(i&&i.length>0){const t=i.reduce(((e,t)=>(e[t.value]={nlsValue:t.nlsValue},e)),{});e[n]={label:a||s,rangeValues:t}}else e[n]={label:a||s};return e}),{});I.add("classAttrNLS",e)}))}},updateNLSForClassifAttr:function(e){e&&Array.isArray(e)&&e.forEach((e=>{let t;if(e.classAttributes&&Array.isArray(e.classAttributes)?t=e.classAttributes:e.ClassAttributes&&e.ClassAttributes.member&&Array.isArray(e.ClassAttributes.member)&&(t=e.ClassAttributes.member),t&&Array.isArray(t)){var n=I.get("classAttrNLS");t.forEach((e=>{e.authorizedValues&&Array.isArray(e.authorizedValues)&&e.authorizedValues.forEach(((t,s)=>{n&&n[e.name]&&(n[e.name].rangeValues[t]&&n[e.name].rangeValues[t].nlsValue?e.authorizedValues[s]={nlsValue:n[e.name].rangeValues[t].nlsValue,value:t}:e.authorizedValues[s]={value:t})})),e.label=n&&n[e.name]&&n[e.name].label||e.name}))}}))},getMulValueAttr:function(e,t){let n=I.get("classAttrNLS"),s=t.slice(1,-1).split(",");return n&&s.forEach(((t,i)=>{n[e].rangeValues[t.trim()]&&n[e].rangeValues[t.trim()].nlsValue?s[i]=n[e].rangeValues[t.trim()].nlsValue:s[i]=t})),s.toString()},Mask:{_timeouts:[],mask:function(e,t){var i=this,a=n.merge({},t);if(!0===i._timeouts.every((function(t){return t.element!==e}))){var o=setTimeout((function(){s.mask(e,a.message)}),a.delay||D);Array.isArray(i._timeouts)||(i._timeouts=[]),i._timeouts.push({element:e,timeout:o})}},unmask:function(e){var t=this,n=-1;t._timeouts.some((function(t,s){return t.element===e&&(n=s,!0)})),n>-1&&(clearInterval(t._timeouts[n].timeout),t._timeouts.splice(n,1)),s.isMasked(e)&&s.unmask(e)}},get3DSwymUrl:function(){return u.get3DSwymUrl()},getErrorMessage:function(e){var t={};return t.title=b.error[e].title,t.subtitle=b.error[e].subtitle,t.message=b.error[e].message,t},displayErrorMessage:function(e,t){var n=this;e.level=t,e.sticky=!1,e.allowUnsafeHTML=!1,void 0===n._notif_manager&&(n._notif_manager=m,p.setNotificationManager(n._notif_manager),p.setStackingPolicy(5)),n._notif_manager.addNotif(e)},viewProperties:function(e,t){var n=I.get("widget")||window.widget;t.toLowerCase().includes("3dspace")?t="3DSpace":t.toLowerCase().includes("swym")&&(t="3DSwym");var s=[],i={getID:function(){return e},getI3DX:function(){return e},source:t,tenant:u.getTenant(),type:""};s.push(i);var a={appId:n.name,_selection:s,getSecurityContext:function(){return{SecurityContext:decodeURIComponent(u.getSecurityContext())}},getSelectedNodes:function(){return this._selection},displayNotification:function(){}};require(["DS/LifecycleControls/EditPropDialog"],(function(e){(new e).launchProperties(a)}))},removeErrorNotification:function(){p.removeNotifications(null,"error")},cloudProbeUtils:{sendCreateIssueTrackerEvent:function(e){var t,n=(I.get("widget")||window.widget).name,s="",i=h.Availability.FALSE,a=h.Availability.FALSE,o=h.Availability.FALSE,r=h.Availability.FALSE,d=h.Availability.FALSE,l=h.Availability.FALSE,c=h.Availability.FALSE,m=h.Availability.FALSE,p=h.Availability.FALSE,g="",S="",f=h.Availability.FALSE,v=e.createData;if(null==e.options.escapeToClose||e.options.escapeToClose||(s=h.IssueCreation.TOOLBAR),"CreateFrom3D"==e.options.issueCreationType&&(s=h.IssueCreation.GEOMETRY),"InlineIssue"==e.options.issueCreationType&&(s=h.IssueCreation.INLINE,S=h.IssueCreationStatus.SAVEASDRAFT),"IFB"==e.options.issueCreationType&&e.options.escapeToClose&&(s=h.IssueCreation.NEWISSUE),"IFT"==e.options.issueCreationType&&e.options.escapeToClose&&(s=h.IssueCreation.NEWFROMTEMPLATE),null!=e.options.advancedDuplicate){s=e.options.advancedDuplicate?h.IssueCreation.ADVANCEDUPLICATE:h.IssueCreation.DUPLICATE,S=h.IssueCreationStatus.SAVEASDRAFT;var y=u.getSecurityContexts();y.cspaces.forEach((e=>{e.value.includes(y.securityContext)&&(g=e.roleNls)}))}v&&(v.waitingOn&&"Analyst"==v.waitingOn&&(i=h.Availability.TRUE),v.classification&&v.classification.length>0&&(a=h.Availability.TRUE),v.contexts&&v.contexts.length>0&&(o=h.Availability.TRUE),v.reportedAgainst&&v.reportedAgainst.length>0&&(r=h.Availability.TRUE),e.views&&e.views.attachments.view.collection.length>0&&(d=h.Availability.TRUE),v.coOwners&&v.coOwners.length>0&&(l=h.Availability.TRUE),v.assignees&&v.assignees.length>0&&(c=h.Availability.TRUE),v.type&&"Issue"!=v.type&&(m=h.Availability.TRUE),v.contributors&&v.contributors.length>0&&(p=h.Availability.TRUE),v.securityContexts&&u.getSecurityContexts().cspaces.forEach((e=>{e.value.includes(v.securityContexts)&&(g=e.roleNls)})),v.state&&"Create"==v.state?S=h.IssueCreationStatus.SAVEASDRAFT:v.state&&"Assign"==v.state&&(S=h.IssueCreationStatus.START),v.informedUsers&&v.informedUsers.length>0&&(f=h.Availability.TRUE)),t=h.getDeviceUsedForOperation(),h.createEventBuilder({category:h.Category.USAGE,action:h.Events.CLICK,tenant:u.getTenant()}).setLabel(h.Labels.ISSUEMANAGEMENT_CREATE_ISSUE).setAppId(n).addDimension(E.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE,s).addDimension(E.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_APPROVAL_ACTIVATE,i).addDimension(E.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CLASSIFICATION,a).addDimension(E.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CONTAINS_CONTEXTS,o).addDimension(E.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CONTAINS_AFFECTEDITEMS,r).addDimension(E.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CONTAINS_ATTACHMENTS,d).addDimension(E.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CONTAINS_COOWNER,l).addDimension(E.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CONTAINS_ASSIGNEE,c).addDimension(E.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUE_CUSTOM_TYPE_OOTB,m).addDimension(E.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CONTAINS_CONTRIBUTORS,p).addDimension(E.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATION_ROLE,g).addDimension(E.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_STATUS_AT_CREATION,S).addDimension(E.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_MEDIA,t).addDimension(E.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CONTAINS_INFORMEDUSERS,f).send()},sendIMCommandsTrackerEvent:function({options:e}){var t=(I.get("widget")||window.widget).name,n="",s="",i="",a="",o="";v[E.ISSUEMANAGEMENT_COMMANDS.TYPE].allowedValues.includes(e.pd1)&&(n=e.pd1),v[E.ISSUEMANAGEMENT_COMMANDS.VIEW].allowedValues.includes(e.pd2)&&(s=e.pd2),v[E.ISSUEMANAGEMENT_COMMANDS.FACET].allowedValues.includes(e.pd3)&&(i=e.pd3),v[E.ISSUEMANAGEMENT_COMMANDS.COMMAND].allowedValues.includes(e.pd4)&&(a=e.pd4),null!=e.pd5&&null!=e.pd5&&(o=e.pd5),h.createEventBuilder({category:h.Category.USAGE,action:h.Events.CLICK,tenant:u.getTenant()}).setLabel(h.Labels.ISSUEMANAGEMENT_COMMANDS).setAppId(t).addDimension("IMtype",n).addDimension("IMview",s).addDimension("IMfacet",i).addDimension("IMcommand",a).addDimension("IMcommandpath",o).send()},sendI3DRCommandsTrackerEvent:function({options:e}){var t=(I.get("widget")||window.widget).name,n="",s="",i="",a="",o="";v[E.ISSUE3DREVIEW_COMMANDS.TYPE].allowedValues.includes(e.pd1)&&(n=e.pd1),v[E.ISSUE3DREVIEW_COMMANDS.VIEW].allowedValues.includes(e.pd2)&&(s=e.pd2),v[E.ISSUE3DREVIEW_COMMANDS.FACET].allowedValues.includes(e.pd3)&&(i=e.pd3),v[E.ISSUE3DREVIEW_COMMANDS.COMMAND].allowedValues.includes(e.pd4)&&(a=e.pd4),null!=e.pd5&&null!=e.pd5&&(o=e.pd5),h.createEventBuilder({category:h.Category.USAGE,action:h.Events.CLICK,tenant:u.getTenant()}).setLabel(h.Labels.ISSUE3DREVIEW_COMMANDS).setAppId(t).addDimension("I3DRtype",n).addDimension("I3DRview",s).addDimension("I3DRfacet",i).addDimension("I3DRcommand",a).addDimension("I3DRcommandpath",o).send()},sendIssueFacetsTrackerEvent:function({options:e}){var t=(I.get("widget")||window.widget).name,n="";v[E.ISSUE_FACET.ISSUE_FACET].allowedValues.includes(e.pd1)&&(n=e.pd1),h.createEventBuilder({category:h.Category.USAGE,action:h.Events.CLICK,tenant:u.getTenant()}).setLabel(h.Labels.ISSUE_FACETS).setAppId(t).addDimension(E.ISSUE_FACET.ISSUE_FACET,n).send()},sendFilterIssueMgmtTrackerEvent:function(e){var t,n,s,i,a,o,r,d,l,c,m,p,g,S,f,v,b,A,C,D=(I.get("widget")||window.widget).name,w=this.fetchFilterValues(e);t=w.owned,n=w.assigned,s=w.reported,i=w.responsible,a=w.contributed,o=w.closed,r=w.media,d=w.ownedCount,l=w.assignedCount,c=w.reportedCount,m=w.responsibleCount,p=w.contributedCount,g=w.closedCount,S=w.ownedAssigned,f=w.ownedAssignedOrg,v=w.ownedAssignedComb,b=w.ownedAssignedCompleted,A=w.ownedAssignedOrgCompleted,C=w.ownedAssignedCombCompleted,h.createEventBuilder({category:h.Category.USAGE,action:h.Events.CLICK,tenant:u.getTenant()}).setLabel(h.Labels.ISSUEMANAGEMENT_FILTER).setAppId(D).addDimension(E.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDBYME,t).addDimension(E.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_ASSIGNEDTOME,n).addDimension(E.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDBYMYORGANIZATION,s).addDimension(E.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_ASSIGNEDTOMYORGANIZATION,i).addDimension(E.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_WHEREICONTRIBUTE,a).addDimension(E.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_COMPLETED,o).addDimension(E.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_MEDIA,r).addPersonalValue(y.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDBYME_TOTALNOISSUES,d).addPersonalValue(y.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_ASSIGNEDTOME_TOTALNOISSUES,l).addPersonalValue(y.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDBYMYORGANIZATION_TOTALNOISSUES,c).addPersonalValue(y.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_ASSIGNEDTOMYORGANIZATION_TOTALNOISSUES,m).addPersonalValue(y.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_WHEREICONTRIBUTE_TOTALNOISSUES,p).addPersonalValue(y.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_COMPLETED_TOTALNOISSUES,g).addPersonalValue(y.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDASSIGNED_TOTALNOISSUES,S).addPersonalValue(y.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDASSIGNEDORG_TOTALNOISSUES,f).addPersonalValue(y.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDASSIGNEDCOMBINED_TOTALNOISSUES,v).addPersonalValue(y.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDASSIGNEDCOMPLETED_TOTALNOISSUES,b).addPersonalValue(y.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDASSIGNEDORGCOMPLETED_TOTALNOISSUES,A).addPersonalValue(y.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDASSIGNEDCOMPLETEDCOMBINED_TOTALNOISSUES,C).send()},sendFilterIssue3DReviewTrackerEvent:function(e){var t,n,s,i,a,o,r,d,l,c,m,p,g,S,f,v,b,A,C,D,w=(I.get("widget")||window.widget).name,T=this.fetchFilterValues(e);t=T.owned,n=T.assigned,s=T.reported,i=T.responsible,a=T.contributed,o=T.closed,r=T.synchronize,d=T.media,l=T.ownedCount,c=T.assignedCount,m=T.reportedCount,p=T.responsibleCount,g=T.contributedCount,S=T.closedCount,f=T.ownedAssigned,v=T.ownedAssignedOrg,b=T.ownedAssignedComb,A=T.ownedAssignedCompleted,C=T.ownedAssignedOrgCompleted,D=T.ownedAssignedCombCompleted,h.createEventBuilder({category:h.Category.USAGE,action:h.Events.CLICK,tenant:u.getTenant()}).setLabel(h.Labels.ISSUE3DREVIEW_FILTER).setAppId(w).addDimension(E.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDBYME,t).addDimension(E.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_ASSIGNEDTOME,n).addDimension(E.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDBYMYORGANIZATION,s).addDimension(E.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_ASSIGNEDTOMYORGANIZATION,i).addDimension(E.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_WHEREICONTRIBUTE,a).addDimension(E.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_COMPLETED,o).addDimension(E.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_SYNCHRONIZED,r).addDimension(E.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_MEDIA,d).addPersonalValue(y.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDBYME_TOTALNOISSUES,l).addPersonalValue(y.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_ASSIGNEDTOME_TOTALNOISSUES,c).addPersonalValue(y.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDBYMYORGANIZATION_TOTALNOISSUES,m).addPersonalValue(y.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_ASSIGNEDTOMYORGANIZATION_TOTALNOISSUES,p).addPersonalValue(y.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_WHEREICONTRIBUTE_TOTALNOISSUES,g).addPersonalValue(y.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_COMPLETED_TOTALNOISSUES,S).addPersonalValue(y.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDASSIGNED_TOTALNOISSUES,f).addPersonalValue(y.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDASSIGNEDORG_TOTALNOISSUES,v).addPersonalValue(y.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDASSIGNEDCOMBINED_TOTALNOISSUES,b).addPersonalValue(y.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDASSIGNEDCOMPLETED_TOTALNOISSUES,A).addPersonalValue(y.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDASSIGNEDORGCOMPLETED_TOTALNOISSUES,C).addPersonalValue(y.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDASSIGNEDCOMPLETEDCOMBINED_TOTALNOISSUES,D).send()},fetchFilterValues:function(e){var t,n=e.filter,s=h.Availability.FALSE,i=h.Availability.FALSE,a=h.Availability.FALSE,o=h.Availability.FALSE,r=h.Availability.FALSE,d=h.Availability.FALSE,l=h.Availability.FALSE,c=0,u=0,m=0,p=0,g=0,I=0,S=0,f=0,E=0,v=0,y=0,b=0;return n.owned&&1==n.owned&&(s=h.Availability.TRUE),n.assigned&&1==n.assigned&&(i=h.Availability.TRUE),n.reported&&1==n.reported&&(a=h.Availability.TRUE),n.responsible&&1==n.responsible&&(o=h.Availability.TRUE),n.contributed&&1==n.contributed&&(r=h.Availability.TRUE),n.closed&&1==n.closed&&(d=h.Availability.TRUE),n.synchronize&&1==n.synchronize&&(l=h.Availability.TRUE,s=h.Availability.FALSE,i=h.Availability.FALSE,a=h.Availability.FALSE,o=h.Availability.FALSE,r=h.Availability.FALSE,d=h.Availability.FALSE),t=h.getDeviceUsedForOperation(),1!=n.owned||0!=n.assigned&&null!=n.assigned||0!=n.reported&&null!=n.reported||0!=n.responsible&&null!=n.responsible||0!=n.contributed&&null!=n.contributed||0!=n.closed&&null!=n.closed?0!=n.owned&&null!=n.owned||1!=n.assigned||0!=n.reported&&null!=n.reported||0!=n.responsible&&null!=n.responsible||0!=n.contributed&&null!=n.contributed||0!=n.closed&&null!=n.closed?0!=n.owned&&null!=n.owned||0!=n.assigned&&null!=n.assigned||1!=n.reported||0!=n.responsible&&null!=n.responsible||0!=n.contributed&&null!=n.contributed||0!=n.closed&&null!=n.closed?0!=n.owned&&null!=n.owned||0!=n.assigned&&null!=n.assigned||0!=n.reported&&null!=n.reported||1!=n.responsible||0!=n.contributed&&null!=n.contributed||0!=n.closed&&null!=n.closed?0!=n.owned&&null!=n.owned||0!=n.assigned&&null!=n.assigned||0!=n.reported&&null!=n.reported||0!=n.responsible&&null!=n.responsible||1!=n.contributed||0!=n.closed&&null!=n.closed?0!=n.owned&&null!=n.owned||0!=n.assigned&&null!=n.assigned||0!=n.reported&&null!=n.reported||0!=n.responsible&&null!=n.responsible||0!=n.contributed&&null!=n.contributed||1!=n.closed?1!=n.owned||1!=n.assigned||0!=n.reported&&null!=n.reported||0!=n.responsible&&null!=n.responsible||0!=n.contributed&&null!=n.contributed||0!=n.closed&&null!=n.closed?0!=n.owned&&null!=n.owned||0!=n.assigned&&null!=n.assigned||1!=n.reported||1!=n.responsible||0!=n.contributed&&null!=n.contributed||0!=n.closed&&null!=n.closed?1!=n.owned||1!=n.assigned||1!=n.reported||1!=n.responsible||0!=n.contributed&&null!=n.contributed||0!=n.closed&&null!=n.closed?1!=n.owned||1!=n.assigned||0!=n.reported&&null!=n.reported||0!=n.responsible&&null!=n.responsible||0!=n.contributed&&null!=n.contributed||1!=n.closed?0!=n.owned&&null!=n.owned||0!=n.assigned&&null!=n.assigned||1!=n.reported||1!=n.responsible||0!=n.contributed&&null!=n.contributed||1!=n.closed?1!=n.owned||1!=n.assigned||1!=n.reported||1!=n.responsible||0!=n.contributed&&null!=n.contributed||1!=n.closed||(b=e.noOfIssues):y=e.noOfIssues:v=e.noOfIssues:E=e.noOfIssues:f=e.noOfIssues:S=e.noOfIssues:I=e.noOfIssues:g=e.noOfIssues:m=e.noOfIssues:p=e.noOfIssues:u=e.noOfIssues:c=e.noOfIssues,{owned:s,assigned:i,reported:a,responsible:o,contributed:r,closed:d,synchronize:l,media:t,ownedCount:c,assignedCount:u,reportedCount:m,responsibleCount:p,contributedCount:g,closedCount:I,ownedAssigned:S,ownedAssignedOrg:f,ownedAssignedComb:E,ownedAssignedCompleted:v,ownedAssignedOrgCompleted:y,ownedAssignedCombCompleted:b}}},updateI3DxIds:function(e){e.forEach((e=>{if(e.serviceId&&e.serviceId.toLowerCase().includes("3dspace")||e.sourceid&&e.sourceid.toLowerCase().includes("3dspace")){const t=/^[0-9a-fA-F]{32}$/;e.objectId&&t.test(e.objectId)&&(e.i3dx=""),e.id&&t.test(e.id)&&(e["ds6w:i3dx_value"]="")}}))},addAsResolvedBy:function(e,t,n,a,r){var l=this,c=I.get("widget")||window.widget;s.mask(c.body);var u={physicalId:t};u[T.TREE_TYPE_RESOLVED_BY]=[{physicalId:e,envId:n,serviceId:a,objectType:r}],d.related.update({data:{objects:[u]}}).then((function(){var e=[],n={};e.push([t]),n[t]={id:t,type:A,modifiedAttributes:["resolvedBy"]};var a=I.get("widget")||window.widget;i.publish("DS/Object/update",{metadata:{appId:a.id,appName:a.name,timestamp:Math.floor(Date.now())},data:{paths:e,attributes:n},version:"1.0"}),s.unmask(a.body)}),(function(t){if(s.unmask(c.body),d.issues.delete({data:{objects:[{physicalId:e}]}}),t.error.internal.includes("2005")){var n=l.getErrorMessage("2005");l.displayErrorMessage(n,"error")}else o.displayNotification({msg:t.error.message,eventID:"error"})}))},getSelection:function(t){return new e((function(e,n){var s=l.getSelection({type:"issue"});if(0==s.physicalIds.length)t.length>0&&d.issues.retrieve({data:{objects:t.reduce((function(e,t){return e.push({physicalId:t}),e}),[])}}).then((function(t){for(var n=0;n<t.results.length;n++){var i=t.results[n].body,a={};a.id=i.physicalId,a.title=i.title,a.description=i.description,a.contexts=i.contexts,a.reportedAgainst=i.reportedAgainst,a.assignees=i.assignees,a.owner=i.owner,s.physicalIds.push(a.id),s.map[i.physicalId]=a}e(s)}));else{if(1!==s.physicalIds.length)return;e(s)}}))},formatDate:function(e,t){var n=new Date(e);const s={datePrecision:t&&t.datePrecision?t.datePrecision:"day",dateStyle:t&&t.dateStyle?t.dateStyle:"medium",timePrecision:t&&t.timePrecision?t.timePrecision:"none"};var i=c.formatDateToString(n,s);return i&&i.length>0?i:e}};return _})),define("DS/IssueCommon/commands/AddUsingSearchAsResolvedBy",["UWA/Class","UWA/Core","DS/ApplicationFrame/Command","DS/PlatformAPI/PlatformAPI","DS/PADUtils/views/PADAlert","DS/IssueCommon/utils/Utils","DS/IssueComponents/utils/Utils","DS/IssueServices/Contexts","DS/IssueServices/services/IssueServices","DS/IssueServices/services/PlatformServices","i18n!DS/IssueCommon/assets/nls/IssueCommon"],(function(e,t,n,s,i,a,o,r,d,l,c){"use strict";var u={ISSUE_TYPE:"Issue",CATEGORY_RESOLVED_BY:"resolvedBy",ISSUE_MANAGEMENT:"ENXISSU_AP",ISSUE_3D_REVIEW:"ENX3DIR_AP",CATEGORIES_TO_ADD_ISSUE_TYPE_OBJECT:["resolvedBy"]};return e.extend(n,{init:function(e){this._parent(e)},execute:function(){var e=r.get("application"),n=t.is(e,"object")&&e.isStandalone,s=r.get("component");if(n){var d=s.getSelectedNodes()[0].getID(),m=l.getTenant(),p=s.taskManager.addObjectsTask((function(e){Array.isArray(e)&&a.addAsResolvedBy(e[0].physicalId,d,m,e[0].serviceId,e[0].objectType),s.unmaskForTask(p)}),(function(){s.unmaskForTask(p)}));s.maskForTask(p,"Please provide some existing object(s) to add.")}else{var g=l.getTenant(),I=c.resolvedBy;l.search({title:I,default_search_criteria:"",callback:function(e){var t=[u.ISSUE_TYPE];try{a.updateI3DxIds(e);var n=[],d=[],l=0,m=r.get("widget").name==u.ISSUE_MANAGEMENT?s.getSelectedNodes()[0].getID():s.getSelectedIssues()[0].id,p=r.get("widget").name==u.ISSUE_MANAGEMENT?s.getSelectedNodes()[0].options.name:s.getSelectedIssues()[0].name,I=r.get("widget").name==u.ISSUE_MANAGEMENT?s.getSelectedNodes()[0].options.title:s.getSelectedIssues()[0].title;e.forEach((e=>{d.push(e["ds6w:type_value"])})),d.length>0&&o.getTypesHierarchy(d).then((s=>{for(var o=0;o<e.length;o++){var r=e[o];if(r.hasOwnProperty("sourceid_value")){if(r.sourceid_value.includes(":")){const e=r.sourceid_value.split(":");r.sourceid_value=e[0]}var d=r.sourceid_value.toLowerCase();if(-1===d.indexOf("3dspace")&&(!r.hasOwnProperty("ds6w:i3dx_value")||""==r["ds6w:i3dx_value"]))throw new Error("Object not supported")}if(!s[r["ds6w:type_value"]].hierarchy.includes(t[0])&&r["ds6w:type_value"]!==t[0]||u.CATEGORIES_TO_ADD_ISSUE_TYPE_OBJECT.includes(u.CATEGORY_RESOLVED_BY)){var S=r["ds6w:i3dx_value"]&&""!=r["ds6w:i3dx_value"]?r["ds6w:i3dx_value"]:r.id;n.push({id:S,serviceId:d,objectType:r["ds6w:type_value"]})}else l++}if(n.length>0){var f=0;for(o=0;o<n.length;o++)n[o].id!==m&&(a.addAsResolvedBy(n[o].id,m,g,d,r["ds6w:type_value"]),f++);if(!(f>0))return void i.displayNotification({msg:c.errorSameIssue,eventID:"error"});i.displayNotification({msg:c.replace(c.attachSuccessResolvedBy,{count:f,issue:I+" ("+p+")"}),eventID:"success"})}0===l||i.displayNotification({msg:c.replace(c.issueNotDroppable,{number:l}),eventID:"error"})}))}catch(e){return i.displayNotification({msg:c.errorNotSupportedObject,eventID:"warning"}),null}},cancel:function(){}})}}})})),define("DS/IssueCommon/commands/ChangeAction",["UWA/Class","UWA/Core","DS/ApplicationFrame/Command","DS/Logger/Logger","DS/PADUtils/views/PADAlert","DS/PlatformAPI/PlatformAPI","DS/IssueCommon/utils/Utils","DS/IssueServices/Contexts","DS/IssueServices/services/IssueServices"],(function(e,t,n,s,i,a,o,r,d){"use strict";return e.extend({init:function(e){this._logger=s.getLogger("DS/IssueCommon/components/IssueTreeListView"),this._parent(e)},execute:function(e){var n=r.get("widget")||window.widget,s=e&&e.ids?e.ids:null;o.Mask.mask(n.body),require(["DS/IssueAttachmentManager/services/AttachmentServices","DS/ENOChgActionCMDs/scripts/CAActionBarController","DS/ENOChgActionCMDs/scripts/Commands/AddToNewCA","DS/IssueServices/services/PlatformServices"],(function(e,i,a,r){o.getSelection(s).then((s=>{var d=s.physicalIds[s.physicalIds.length-1];e.getDocumentsFrom(d).then((function(e){var t=e.attachments,n=[];return t.forEach((function(e){n.push({id:e.id,type:e.type,service:"3dspace"})})),n})).then((function(e){var l=decodeURIComponent(r.getSecurityContext());i.initializeInfra().then((function(){i.clearObjects(),i.setSecurityContext(l);var c=r.getTenant();i.setTenant(c),i.setVersion("v1");var u=[];s.map[d].contexts.forEach((function(e){var t=e.type?e.type:e.objectType;u.push({id:e.physicalId,type:t,service:"3dspace"})})),i.addContext(u);var m=[];s.map[d].reportedAgainst.forEach((function(e){var t=e.type?e.type:e.objectType;m.push({id:e.physicalId,type:t,service:"3dspace"})})),i.addProposed(m),i.addReferential(e),i.addAssignee(s.map[d].assignees.filter((e=>"person"===e.type)).map((e=>e.user))),i.addFollower([s.map[d].owner.user]),i.addTitle(s.map[d].title),i.addDescription(s.map[d].description),o.Mask.unmask(n.body),a.prototype.execute((function(e){t.is(e,"string")&&(e=JSON.parse(e));var n=e.changeaction.id.replace("pid:",""),s=r.getTenant(),i=e.changeaction.type;o.addAsResolvedBy(n,d,s,"3dspace",i)}),(function(){}))}))})).catch((function(e){if(e.internalError&&e.internalError.includes("ErrorCode:1500127")){var t=o.getErrorMessage("0");o.displayErrorMessage(t,"error")}})).finally((function(){o.Mask.unmask(n.body)}))}))}))}})})),define("DS/IssueCommon/facets/History",["UWA/Class/Promise","UWA/Class/View","UWA/Core","DS/IssueComponents/routes/Routes","DS/IssueCommon/facets/Placeholder","DS/IssueServices/Contexts","DS/IssueServices/utils/Performance","DS/IssueTimeline/IssueTimeline","DS/IssueCommon/utils/Utils","css!DS/IssueCommon/IssueCommon.css"],(function(e,t,n,s,i,a,o,r,d){"use strict";return t.extend({name:"DS/IssueCommon/facets/History",tagName:"div",className:"history-view fade-in-element",defaultOptions:{physicalIds:[]},timeline:null,_subscriberId:"",_eventListeners:[],setup:function(t){var i=this;o.start(i.name+" setup"),i.formulaRatio=!0===t.facet?1.25:1.4,i._parent(t),i.target=n.createElement("div",{class:"history-content"}),i.container.setContent(i.target);var d=i.getOption("physicalIds");i.timeline=new r({physicalId:d[d.length-1]}),i.routes=new s({physicalId:d[d.length-1]});var l=new e((function(e,t){i.listenTo(i.timeline,"onReady",(function(t){e(t)})),i.listenTo(i.timeline,"onFailure",(function(e){t(e)}))})),c=new e((function(e,t){i.listenTo(i.routes,"onReady",(function(t){i.container.toggleClassName("history-view-timeline-only",i.routes.isEmpty),e(t)})),i.listenTo(i.routes,"onFailure",(function(e){t(e)}))}));e.all([l,c]).then((function(e){i.container.toggleClassName("history-view-wide",i.container.offsetWidth>i.container.offsetHeight*i.formulaRatio),i.container.toggleClassName("history-view-timeline-only",null===i.routes||i.routes.isEmpty),i.dispatchEvent("onReady",e)})).catch((function(e){i.dispatchEvent("onFailure",e)})),i._subscriberId=Math.random().toString(36).substr(2,9),i._eventListeners=[{event:"DS/Object/update",listener:function(e){i.routes&&i.routes.getOption("physicalId")&&(e.data.paths.reduce((function(e,t){return e.push(t.pop()),e}),[]).indexOf(i.routes.getOption("physicalId"))>-1&&i.routes.refresh(i.routes.getOption("physicalId")).then((function(){i.container.toggleClassName("history-view-timeline-only",null===i.routes||i.routes.isEmpty)})))},conditions:{type:"issue",attributes:["state","assignees"]}},{event:"DS/Object/update",listener:function(e){i.timeline&&i.timeline.getOption("physicalId")&&(e.data.paths.reduce((function(e,t){return e.push(t.pop()),e}),[]).indexOf(i.timeline.getOption("physicalId"))>-1&&i.timeline.refresh(i.timeline.getOption("physicalId")))},conditions:{type:"issue"}}];for(var u=0;u<i._eventListeners.length;u++){var m=i._eventListeners[u];m.token=a.get("eventsHandler").subscribe(i._subscriberId,m.event,m.listener.bind(i),m.conditions)}o.end(i.name+" setup")},render:function(){var e=this;return!1===e.isValidSelection()?(e.elements.target.hide(),e.placeholder.show(e.container)):(e.placeholder.hide(e.container),e.target.show()),o.start(e.name+" render"),e.timeline.render().inject(e.target),e.routes.render().inject(e.target),e.container.toggleClassName("history-view-wide",e.container.offsetWidth>e.container.offsetHeight*e.formulaRatio),e.container.toggleClassName("history-view-timeline-only",!0),o.end(e.name+" render"),e},refresh:function(t){var n=this;return n.setOption("physicalIds",t),!1===n.isValidSelection()?(n.target.hide(),n.placeholder.show(n.container),setTimeout((function(){n.dispatchEvent("onReady",{})}),0),e.resolve()):(n.placeholder.hide(n.container),n.target.show(),e.all([n.timeline.refresh(t[t.length-1]),n.routes.refresh(t[t.length-1])]).then((function(){n.container.toggleClassName("history-view-timeline-only",null===n.routes||n.routes.isEmpty),n.dispatchEvent("onReady",{});try{d.cloudProbeUtils.sendIssueFacetsTrackerEvent({options:{pd1:"InformationHistory"}})}catch(e){}})))},resize:function(){var e=this;null!==e.timeline&&e.timeline.resize(),null!==e.routes&&e.routes.resize(),e.container.toggleClassName("history-view-wide",e.container.offsetWidth>e.container.offsetHeight*e.formulaRatio)},destroy:function(){var e=this;if(e.stopListening(e.timeline,"onReady"),e.stopListening(e.timeline,"onFailure"),Array.isArray(e._eventListeners))for(var t=0;t<e._eventListeners.length;t++){var n=e._eventListeners[t];a.get("eventsHandler").unsubscribe(n.token)}e._eventListeners=[],e._subcriberId="",e.timeline.destroy(),e.timeline=null,e.container.empty()},isValidSelection:function(){var e=this.getOption("physicalIds");return Array.isArray(e)&&1===e.length},placeholder:{_view:new i,show:function(e){this._view.render("history").inject(e),this._view.show()},hide:function(){this._view.hide(),this._view.empty()}}})})),define("DS/IssueCommon/utils/ModelParser",["UWA/Core","DS/Logger/Logger","DS/IssueCommon/utils/Utils","DS/IssueComponents/utils/Utils","DS/IssueServices/utils/Performance","DS/IssueServices/services/IssueServices","DS/IssueServices/Contexts","i18n!DS/IssueCommon/assets/nls/IssueCommon"],(function(e,t,n,s,i,a,o,r){"use strict";var d={BASE_NLS:"ISU_TYPE_NLS",ISSUE_EXTENSIONS:"ISSUE_EXTENSIONS",NODE:{id:"",physicalId:"",type:"",name:"",title:"",baseType:"",organizationTitle:"",organization:"",collaborativeSpaceTitle:"",collaborativeSpace:"",actionTaken:"",actualEndDate:"",actualStartDate:"",validation:{activated:!1,fetched:!1,toString:{validation:function(){var e=this;if(!0!==e.activated)return r.validationNone;if(!e.status)return r.validationLoading;var t="";switch(e.status){case"none":t=r.validationNone;break;case"loading":t=r.validationLoading;break;case"approved":t=r.validationApproved;break;case"rejected":t=r.validationRejected;break;case"inProgress":t=r.validationInProgress;break;case"notStarted":t=r.validationNotStarted;break;default:t=""}return t}}.validation},assignees:[],contributors:[],informedUsers:[],contexts:[],created:"",description:"",estimatedEndDate:"",estimatedStartDate:"",modified:"",originator:{},owner:{},coOwners:[],priority:"",isAffectedItemsIds:"",reportedAgainst:[],reportingOrganization:"",reportingOrganizationTitle:"",resolutionDate:"",resolutionRecommendation:"",resolutionStatement:"",resolvedBy:[],resolvedItems:[],responsibleOrganization:"",responsibleOrganizationTitle:"",revision:"",isLastRevision:"",state:"",completionType:"",waitingOn:"",iconurl:"",custom:{},escalationRequired:"",occurrence:"",library:"",libraries:"",completionType:""},MAPPING:{id:"",physicalId:"",isAffectedItemsIds:"",type:"ds6w:type",name:"ds6w:name",title:"ds6w:title",organizationTitle:"ds6w:organization",organization:"ds6w:organization",collaborativeSpaceTitle:"ds6w:collaborativeSpace",collaborativeSpace:"ds6w:collaborativeSpace",actionTaken:"ds6w:actionTaken",actualEndDate:"ds6w:actualEndDate",actualStartDate:"ds6w:actualStartDate",validation:"ds6w:validation",assignees:"ds6w:assignees",contributors:"ds6w:contributors",informedUsers:"ds6w:informedUsers",contexts:"ds6w:contexts",created:"ds6w:created",description:"ds6w:description",estimatedEndDate:"ds6w:estimatedEndDate",estimatedStartDate:"ds6w:estimatedStartDate",modified:"ds6w:modified",originator:"ds6w:originator",owner:"ds6w:owner",coOwners:"ds6w:coOwners",priority:"ds6w:priority",reportedAgainst:"ds6w:reportedAgainst",reportingOrganizationTitle:"ds6w:reportingOrganization",resolutionDate:"ds6w:resolutionDate",resolutionRecommendation:"ds6w:resolutionRecommendation",resolutionStatement:"ds6w:resolutionStatement",resolvedBy:"ds6w:resolvedBy",resolvedItems:"ds6w:resolvedItems",responsibleOrganizationTitle:"ds6w:responsibleOrganization",revision:"ds6w:revision",isLastRevision:"ds6w:isLastRevision",state:"ds6w:state",completionType:"ds6w:completionType",waitingOn:"ds6w:waitingOn",escalationRequired:"ds6w:escalationRequired",occurrence:"ds6w:occurrence",library:"LibraryClasses",libraries:"Library"},NO_VALIDATION:"Unassigned",VALIDATION:"Analyst"},l=function(t){var s=e.clone(d.NODE);for(var i in s.grid={},s.icons=[],d.NODE)d.NODE.hasOwnProperty(i)&&(s[i]=t[i]?t[i]:e.clone(d.NODE[i]));s.id=t.physicalId?t.physicalId:s.id,s.physicalId=s.id,s.grid.id=s.id,s.resourceid=s.id,s.indexed=t.indexed;var a=n.getIconByState(s.state,s.type,s.iconurl);for(var l in s.icons.push(a),d.MAPPING)switch(l){case"organization":""==s.organizationTitle&&(s.grid[d.MAPPING[l]]=s[l]);break;case"collaborativeSpace":""==s.collaborativeSpaceTitle&&(s.grid[d.MAPPING[l]]=s[l]);break;case"waitingOn":s.grid.Approvals="Unassigned"!==s[l]&&""!==s[l];break;default:s.grid[d.MAPPING[l]]=s[l]}var c=o.get(d.BASE_NLS);c&&c["ds6w:type"]&&Object.keys(c["ds6w:type"]).includes(s.type)&&(s.grid["ds6w:type"]=c["ds6w:type"][s.type],s.grid.type=s.type,s.grid.typeNLS=c["ds6w:type"][s.type]),c&&c["ds6w:organizationResponsible"]&&(Object.keys(c["ds6w:organizationResponsible"]).includes(s.organization)&&(s.grid["ds6w:organization"]=c["ds6w:organizationResponsible"][s.organization]),Object.keys(c["ds6w:organizationResponsible"]).includes(s.responsibleOrganization)&&(s.grid["ds6w:responsibleOrganization"]=c["ds6w:organizationResponsible"][s.responsibleOrganization]),Object.keys(c["ds6w:organizationResponsible"]).includes(s.reportingOrganization)&&(s.grid["ds6w:reportingOrganization"]=c["ds6w:organizationResponsible"][s.reportingOrganization])),c&&c["ds6w:project"]&&Object.keys(c["ds6w:project"]).includes(s.collaborativeSpace)&&(s.grid["ds6w:collaborativeSpace"]=c["ds6w:project"][s.collaborativeSpace]);var u=o.get(d.ISSUE_EXTENSIONS);if(u){const e=[];Object.keys(u).forEach((t=>{let n=t.replace("ds6w:","");n=t.replace("ds6wg:",""),e.push(t)})),s.grid.interfaces=e,s.grid.interfacesNLS=u}s.label=s.display=""!==s.title?s.title:s.name,s.grid[d.MAPPING.assignees]=s.assignees.reduce((function(e,t){return e+t.fullName+", "}),""),s.grid[d.MAPPING.assignees].length>0&&(s.grid[d.MAPPING.assignees]=s.grid[d.MAPPING.assignees].trim(),s.grid[d.MAPPING.assignees]=s.grid[d.MAPPING.assignees].substring(0,s.grid[d.MAPPING.assignees].length-1)),s.grid[d.MAPPING.contributors]=s.contributors.reduce((function(e,t){return e+t.fullName+", "}),""),s.grid[d.MAPPING.contributors].length>0&&(s.grid[d.MAPPING.contributors]=s.grid[d.MAPPING.contributors].trim(),s.grid[d.MAPPING.contributors]=s.grid[d.MAPPING.contributors].substring(0,s.grid[d.MAPPING.contributors].length-1)),s.grid[d.MAPPING.informedUsers]=s.informedUsers.reduce((function(e,t){return e+t.fullName+", "}),""),s.grid[d.MAPPING.informedUsers].length>0&&(s.grid[d.MAPPING.informedUsers]=s.grid[d.MAPPING.informedUsers].trim(),s.grid[d.MAPPING.informedUsers]=s.grid[d.MAPPING.informedUsers].substring(0,s.grid[d.MAPPING.informedUsers].length-1)),s.grid[d.MAPPING.coOwners]=s.coOwners.reduce((function(e,t){return e+t.fullName+", "}),""),s.grid[d.MAPPING.coOwners].length>0&&(s.grid[d.MAPPING.coOwners]=s.grid[d.MAPPING.coOwners].trim(),s.grid[d.MAPPING.coOwners]=s.grid[d.MAPPING.coOwners].substring(0,s.grid[d.MAPPING.coOwners].length-1)),s.grid[d.MAPPING.contexts]=String(s.contexts.length),s.grid[d.MAPPING.originator]=s.originator.fullName?s.originator.fullName:"",s.grid[d.MAPPING.owner]=s.owner.fullName?s.owner.fullName:"",s.grid[d.MAPPING.priority]=r.priorities[s.priority.toLowerCase()],s.grid[d.MAPPING.reportedAgainst]=String(s.reportedAgainst.length),s.grid[d.MAPPING.resolvedBy]=String(s.resolvedBy.length),s.grid[d.MAPPING.resolvedItems]=String(s.resolvedItems.length);var m=o.get("maturityGraph");if(s.grid[d.MAPPING.state]=m?m[t.state]:r.maturity[s.state.toLowerCase()],"Issue Template"==t.policy){var p=o.get("templateMaturityGraph");s.grid[d.MAPPING.state]=p?p[t.state]:r.maturity[s.state.toLowerCase()],s.data=t.data}for(var g in s.waitingOn===d.VALIDATION&&(s.validation.activated=!0),s.custom)s.custom.hasOwnProperty(g)&&(s.grid[g]=s.custom[g]);if(Array.isArray(t.classification)?s.classification=t.classification:s.classification=t.classification?t.classification.split(""):[],Array.isArray(t.additionalPredicate))for(let e=0;e<t.additionalPredicate.length;e++){let n=Object.keys(t.additionalPredicate[e])[0],i=t.additionalPredicate[e][n];switch(n){case"ds6w:what/ds6w:libraries":s.grid[d.MAPPING.libraries]=i,s.libraries=i;break;case"ds6w:what/ds6w:library":s.grid[d.MAPPING.library]=i,s.library=i}}return s},c=function(t,n){var s=e.clone(d.NODE);s.grid={},s.icons=[];for(var i=t.attributes,a=0;a<i.length;a++){var o=i[a];if("Warning:Flattening"!==o.value&&"Warning:JPO"!==o.value)switch(e.is(o.name,"string")?o.name.replace("ds6w:what/","").replace("ds6w:when/","").replace("ds6w:who/",""):o.name){case"resourceid":null!=s.id&&""!=s.id||(s.id=o.value),s.physicalId=o.value;break;case"organization":s.organization=o.value,s.grid["ds6w:organization"]=o.dispValue;break;case"project":s.collaborativeSpace=o.value,s.grid["ds6w:collaborativeSpace"]=o.value;break;case"ds6w:project":s.collaborativeSpace=o.dispValue,s.grid["ds6w:collaborativeSpace"]=o.dispValue;break;case"ds6w:identifier":s.name=o.value;break;case"ds6w:label":s.title=o.value;break;case"ds6w:status":s.state=o.value,s.grid["ds6w:state"]=o.dispValue;break;case"ds6w:type":s.type=o.value,s.grid["ds6w:type"]=o.dispValue,s.grid.type=o.dispValue,s.grid.typeNLS=o.dispValue;break;case"ds6w:responsible":s.owner.fullName=o.value;break;case"owner":case"ds6w:responsibleUid":s.owner.user=o.value;break;case"type_icon_url":s.icons.push(o.value);break;case"ds6w:modified":s.modified=o.value;break;case"ds6w:created":s.created=o.value;break;case"ds6wg:revision":s.revision=o.value;break;case"ds6w:isLastRevision":var r=o.value;r&&""!==r&&(s.isLastRevision="true"===r.toLowerCase());break;case"lastrevision":var l=o.value;""===s.isLastRevision&&l&&""!==l&&(s.isLastRevision="true"===l.toLowerCase());break;case"description":case"ds6w:description":s.description=o.value,s.grid["ds6w:description"]=o.value;break;case"ds6w:i3dx":""!=o.value&&(s.id=o.value);break;case"sourceid":s.serviceId=o.value;break;default:-1!==n.indexOf(o.name)&&(s.grid[o.name]=o.value)}}return s.resourceid=s.id,s.label=s.display=""!==s.title?s.title:s.name,s.grid["ds6w:owner"]=s.owner,s.grid["ds6w:modified"]=s.modified,s.grid["ds6w:created"]=s.created,s.grid["ds6w:revision"]=s.revision,s.grid["ds6w:isLastRevision"]=s.isLastRevision,s.grid["ds6w:originator"]=s.owner,s.originator=s.owner,s.grid.id=s.id,s};return{name:"DS/IssueCommon/utils/ModelParser",parse:function(e,t){var n=[];if(i.start(this.name+" parse"),t=t||{},Array.isArray(t.predicates)||(t.predicates=[]),Array.isArray(e))if(!0===t.useIndex)for(var s=0;s<e.length;s++)n.push(c(e[s],t.predicates));else for(var a=0;a<e.length;a++)n.push(l(e[a]));else n=!0===t.useIndex?c(e,t.predicates):l(e);return i.end(this.name+" parse"),n},update:function(e,t){e.context=t.context}}})),define("DS/IssueCommon/commands/Templates",["UWA/Class","DS/ApplicationFrame/Command","DS/IssueCommon/utils/Utils","DS/IssueServices/Contexts"],(function(e,t,n,s){"use strict";var i="PLMNewEnablement";return e.extend(t,{init:function(e){this._parent(e,{isAsynchronous:!0}),s.get(i)&&this.disable()},execute:function(){var e=this;!0!==e.utils.isAlreadyRunning()&&require(["DS/IssueComponents/templates/TemplatesDialog"],(function(t){var n=s.get("widget")||window.widget;e.component=new t(n.body,{editMode:!0,onClose:function(){e.end()},onEnd:function(){}}),e.component.render()}))},beginExecute:function(){if(!0!==this.utils.isAlreadyRunning()){var e=s.get("widget")||window.widget;n.Mask.mask(e.body)}},endExecute:function(){var e=s.get("widget")||window.widget;n.Mask.unmask(e.body)},utils:{isAlreadyRunning:function(){var e=s.get("widget")||window.widget;return null!==e.body.getElement(".create-template-chooser-dialog")||null!==e.body.getElement(".create-view-dialog")}}})})),define("DS/IssueCommon/facets/Comments",["UWA/Class/Promise","UWA/Class/View","UWA/Core","DS/UIKIT/Scroller","DS/SocialToolbar/SocialToolbar","DS/IssueServices/Contexts","DS/IssueCommon/facets/Placeholder","DS/IssueServices/services/PlatformServices","DS/IssueServices/services/IssueServices","DS/IssueServices/utils/Performance","DS/IssueCommon/utils/Utils","DS/SocialToolbarVue/SocialToolbarVueUWAView","DS/PlatformAPI/PlatformAPI","css!DS/IssueCommon/IssueCommon.css"],(function(e,t,n,s,i,a,o,r,d,l,c,u,m){"use strict";return t.extend({name:"DS/IssueManagement/views/facets/Comments",tag:"div",className:"comments-view fade-in-element",defaultOptions:{physicalIds:[]},comments:null,elements:{target:null,scroller:null},setup:function(e){var t=this;l.start(t.name+" setup"),t._parent(e),t.elements.target=n.createElement("div",{class:"comments-content"}),t.container.setContent(t.elements.target),t.elements.scroller=new s({element:t.elements.target}).inject(t.container),t.comments=null,l.end(t.name+" setup")},render:function(){var e=this;if(!1===e.isValidSelection())return e.elements.target.hide(),e.placeholder.show(e.container),setTimeout((function(){e.dispatchEvent("onReady",{})}),0),e;e.placeholder.hide(e.container),e.elements.target.show(),l.start(e.name+" render");var t=e.getOption("physicalIds"),n={protocol:"3DXContent",version:"",source:"",widgetId:"",data:{items:[{envId:r.getTenant(),serviceId:"3DSpace",objectId:t[0],objectType:"Issue",facet:"properties"}]}};let s="/#app:ENXISSU_AP/content:X3DContentId="+encodeURIComponent(JSON.stringify(n));const i={props:{disableFeatures:{disableShare:!0,disableLike:!0,disableShowUserProfile:!0},subjectUri:"pid:"+t[t.length-1],platformId:r.getTenant(),currentUser:{login:r.getUserName(),displayName:r.getFullName(),firstName:r.getFirstName(),lastName:r.getLastName()},urls:{service:r.get3DSpaceUrl()+"/resources",serviceCSRF:{name:"X-DS-CSRFTOKEN",token:"1WEH-GJ3W-VBP6-T8T1-R9D5-MWEY-VDXS-51GA"},registry:e.getRegistryUrl(),swym:r.get3DSwymUrl(),fedsearch:r.get3DSearchUrl()},atInit:{nbCommentsToLoad:10},appForcedLinkUri:s}};e.comments=new u;var a=e.comments.render(i);return a.inject(e.elements.scroller.getInnerElement()),e.listenToOnce(e.comments,"onPopulate",(function(){e.dispatchEvent("onReady",{})})),a.listenTo(a,{onClickOnLikeBtn(e){console.log("### onClickOnLikeBtn",e)},onClickOnCommentBtn(e){console.log("### onClickOnCommentBtn",e)},onClickOnShareBtn(e){console.log("### onClickOnShareBtn",e)},onClickOnExtraActionBtn(e){console.log("### onClickOnExtraActionBtn",e)},onClickOnMedia(e){console.log("### onClickOnMedia",e)},onToggleLikeSubject(e){console.log("### onToggleLikeSubject",e)},onAddComment(t){console.log("### onAddComment",t),e.addMentionedUser(t),e.notifyUsers(t)},onEditComment(t){console.log("### onEditComment",t),e.addMentionedUser(t),e.notifyUsers(t)},onRemoveComment(e){console.log("### onRemoveComment",e)},onToggleLikeComment(e){console.log("### onToggleLikeComment",e)},onLoadInitialComments(t){console.log("### onLoadInitialComments",t),e.dispatchEvent("onReady",{})},onClickOnUser(t){e.onClickOnUser(t)}}),e},refresh:function(t){var n=this;return null!==n.comments&&(n.comments.destroy(),n.comments=null),n.setOption("physicalIds",t),n.render(),new e((function(e){n.listenToOnce(n,"onReady",e)}))},destroy:function(){var e=this;e.stopListening(e,"onReady"),null!==e.comments&&(e.comments.destroy(),e.comments=null),e.container.empty()},isValidSelection:function(){var e=this.getOption("physicalIds");return Array.isArray(e)&&1===e.length},addMentionedUser:function(e){if(e){var t="",s=e.subjectUri;if(s.length>0&&s.includes("pid:")){let e="pid:",n=s.indexOf(e)+e.length,i=s.length;t=s.substring(n,i)}var i=e.comment.richMessage,a='data-login="',o=[];i.split("</a>").forEach((function(e){if(e.length>0&&e.includes('class="sum-user-link sm-link"')&&e.includes(a)){let n=e.indexOf(a)+12,s=e.indexOf('"',n);var t=e.substring(n,s);o.push(t)}}));var r=[];if(o.forEach((function(e){r.push({user:e})})),o.length>0&&t.length>0){var l=[{contributors:r,physicalId:t,userContext:"mentionedUser"}];d.people.update({data:{objects:l}}).catch((function(e){if(e.error.message.includes("'business object' does not exist")){var t=c.getErrorMessage("0");c.displayErrorMessage(t,"error")}else if(n.is(e.error.internal)&&e.error.internal.includes("You do not have the permissions to perform this action")){t=c.getErrorMessage("1");c.displayErrorMessage(t,"error")}else if(n.is(e.error.internal)&&e.error.internal.includes("No toconnect access to business object")){t=c.getErrorMessage("10");c.displayErrorMessage(t,"error")}else if(n.is(e.error.internal)&&e.error.internal.includes("No 'modify' access on Attribute 'Co-Owners' for")){t=c.getErrorMessage("2005");c.displayErrorMessage(t,"error")}else PADAlert.displayNotification({msg:e.error.message,eventID:"error"})}))}}},notifyUsers:function(e){if(e){var t="",n=e.subjectUri;if(n.length>0&&n.includes("pid:")){let e="pid:",s=n.indexOf(e)+e.length,i=n.length;t=n.substring(s,i)}var s=e.comment.richMessage,i='data-login="',a=[];if(s.split("</a>").forEach((function(e){if(e.length>0&&e.includes('class="sum-user-link sm-link"')&&e.includes(i)){let n=e.indexOf(i)+12,s=e.indexOf('"',n);var t=e.substring(n,s);a.push(t)}})),t.length>0){e={issue:t,users:a.toString()};d.comments.notify({data:e})}}},placeholder:{_view:new o,show:function(e){this._view.render("comments").inject(e),this._view.show()},hide:function(){this._view.hide(),this._view.empty()}},getRegistryUrl:function(){var e;return r.isCloudEnvironment()?e=require("DS/PlatformAPI/PlatformAPI").getApplicationConfiguration("app.urls.registry"):(e=require("DS/PlatformAPI/PlatformAPI").getApplicationConfiguration("app.urls.myapps")).includes("resources/AppsMngtRegistry")||(e=`${e}/resources/AppsMngtRegistry`.replace(/([^:]\/)\/+/g,"$1")),e},onClickOnUser:function(e){null!=e.userLogin&&r.getUserProfile(e.userLogin),null!=e.usersGroupId&&r.getUserGroupProfile(e.usersGroupId)}})})),define("DS/IssueCommon/commands/CreateTask",["UWA/Class","UWA/Core","DS/ApplicationFrame/Command","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger","DS/PADUtils/views/PADAlert","DS/IssueCommon/utils/Utils","DS/IssueServices/Contexts","DS/IssueServices/services/IssueServices","i18n!DS/IssueCommon/assets/nls/IssueCommon"],(function(e,t,n,s,i,a,o,r,d,l){"use strict";return e.extend({init:function(e){this._parent(e)},execute:function(e){r.get("widget")||window.widget;var n=e&&e.ids?e.ids:null;require(["DS/CollabComponents/CreateTask","DS/IssueServices/services/PlatformServices"],(function(e,s){o.getSelection(n).then((n=>{var i=n.physicalIds[n.physicalIds.length-1];new e({title:n.map[i].title,description:n.map[i].description,url_3DSpace:s.get3DSpaceUrl(),space:"ctx::"+decodeURIComponent(s.getSecurityContext()),enableAllTaskTypes:!0,onCompleteCallback:function(e){let n=e.isStandaloneTask&&e.isStandaloneTask();if(t.is(e,"string")&&(e=JSON.parse(e)),n)var a=e.getI3dx&&e.getI3dx()||e.id,r=e.serviceHosting||"3dplan";else a=e.id,r="3dspace";var d=s.getTenant(),l=e.getObjectType&&e.getObjectType();o.addAsResolvedBy(a,i,d,r,l)},onFailureCallback:function(e){var t=e.length&&e[2],n=l.taskCreationFailed;t.response.internalError&&t.response.internalError.includes("1500127")?(n=o.getErrorMessage("0"),o.displayErrorMessage(n,"error")):t.response.internalError&&t.response.internalError.includes("1500028")?(n=o.getErrorMessage("1500028_1"),o.displayErrorMessage(n,"error")):t&&t.response&&t.response.error&&t.response.error.length?(n=t.response.error,a.displayNotification({title:l.cannotCreateTask,msg:n,eventID:"error"})):a.displayNotification({msg:n,eventID:"error"})},onExecuteCreateTask:function(){},onCancelCallback:function(){},scopes:[]}).renderAsDialog({enableRepeat:!0})}))}))}})})),define("DS/IssueCommon/commands/Share",["UWA/Class","DS/ApplicationFrame/Command","DS/PADUtils/views/PADAlert","DS/IssueCommon/utils/Selector","DS/IssueCommon/utils/Utils","DS/IssueServices/services/PlatformServices","i18n!DS/IssueCommon/assets/nls/IssueCommon"],(function(e,t,n,s,i,a,o){"use strict";var r=100;return e.extend(t,{init:function(e){this._parent(e)},execute:function(){var e=s.getSelection({type:"issue"}).physicalIds,t=s.getSelection({type:"issue"}).issueNames,a=i.computeSharedIssuesURL(e);i.copyTextToClipboard(a),e.length>=r?n.displayNotification({msg:o.replace(o.share.info,{number:r}),eventID:"info"}):1==t.length?n.displayNotification({msg:o.replace(o.share.successSingle,{name:t}),eventID:"success"}):n.displayNotification({msg:o.replace(o.share.successMultiple,{number:e.length}),eventID:"success"})}})})),define("DS/IssueCommon/commands/Create",["UWA/Core","UWA/Class","UWA/Class/Listener","UWA/Class/Promise","DS/ApplicationFrame/Command","DS/IssueCommon/utils/Utils","DS/IssueCommon/commands/CommandsManager","DS/IssueCommon/commands/CreateIssuePLMNew","DS/IssueServices/Contexts","DS/UIKIT/Mask"],(function(e,t,n,s,i,a,o,r,d,l){"use strict";var c="ENXISSU_AP",u="ENX3DIR_AP",m="PLMNewEnablement",p=t.extend(i,n,{mode:"",component:null,init:function(e){this._parent(e,{isAsynchronous:!0}),d.get(m)&&"CreateFromTemplate"==e.ID&&this.disable()},execute:function(){var e=this;if(!0===e.utils.isAlreadyRunning())return e._reset(),void e.end();var t=d.get("widget"),n=d.get("component");new s((function(s){t.name===u&&!0!==n.isDisplayed()?require(["DS/UIKIT/Mask"],(function(i){i.mask(t.body),e.listenTo(n,"onDisplay",(function(){e.stopListening(n,"onDisplay"),i.unmask(t.body),s()})),d.get("pad3DViewer").getExecutionContext().getComponent(WAfrStandardComponentKey.HandlerComponent).setCheckState({id:"Display",state:!0})})):s()})).then((function(){var t=e.getArguments();t&&t.length>0&&(e.mode=t[t.length-1].Value),void 0!==e.utils[e.mode]?e.utils[e.mode].apply(e):e.utils.IFB.apply(e)}))},beginExecute:function(){if(!0!==this.utils.isAlreadyRunning()&&!this.utils.isPLMNew_Enabled()){var e=d.get("widget")||window.widget;a.Mask.mask(e.body)}},endExecute:function(){var e=d.get("widget")||window.widget;a.Mask.unmask(e.body),this.mode=null},_reset:function(){var e=this;e.autoFillData=null,e.template=null,e.mode=null},utils:{isAlreadyRunning:function(){var e=d.get("widget")||window.widget;return null!==e.body.getElement(".create-template-chooser-dialog")||null!==e.body.getElement(".create-view-dialog")},isPLMNew_Enabled:function(){return d.get(m)},IFB:function(){var t=this;t.utils.isPLMNew_Enabled()?(new r({app:"ISU_3D"}).execute(),t.end()):require(["DS/IssueComponents/create/Create"],(function(n){var i=d.get("widget")||window.widget,a=i.name===u;t.component=new n(i.body,{escapeToClose:!a,issueCreationType:t.mode}),t.component.render(),t.component.isLoaded.then((function(){var n=d.get("widget")||window.widget;if(n.name!==c&&n.name!==u||o.disableAll(),t.listenTo(t.component,"onCreateDialogClose",(function(){var e=d.get("widget")||window.widget;t.stopListening(t.component,"onCreateDialogClose"),e.name!==c&&e.name!==u||o.enableAll()})),e.is(t.autoFillData,"object")){var i={id:"template-"+n.id+"-"+Date.now(),info:{description:null,name:null},ui:{},data:e.clone(t.autoFillData),hidden:{}};return t.component.applyTemplate(i)}return s.resolve()})).finally((function(){t._reset(),t.end()}))}))},_openCreateAndApplyTemplate:function(t){var n=this,s=d.get("widget")||window.widget,i=s.name===u,a=d.get("templateComponentDialog")?d.get("templateComponentDialog"):d.get("templateComponent");require(["DS/PADUtils/views/PADAlert","DS/IssueComponents/create/Create","i18n!DS/IssueCommon/assets/nls/IssueCommon"],(function(r,m,p){if(null!==t&&null!=a){var g=new m(s.body,{escapeToClose:!i,issueCreationType:n.mode}),I=t.data;null==I&&((I={}).data={},I.info={}),a.updateDataPresentOnNode(t.physicalId,I).then((s=>{a.updateTemplateData(I).then((function(){g.render(),g.isLoaded.then((function(){var t=d.get("widget")||window.widget;t.name!==c&&t.name!==u||o.disableAll(),n.listenTo(g,"onCreateDialogClose",(function(){var e=d.get("widget")||window.widget;n.stopListening(n.component,"onCreateDialogClose"),e.name!==c&&e.name!==u||o.enableAll()}));var s=e.clone(I);e.is(n.autoFillData,"object")&&(s=e.extend(s,{data:e.clone(n.autoFillData)},!0));return g.applyTemplate(s)})).catch((function(e){g._logger.error(e),l.unmask(g.elements.dialog.getBody()),g.dispatchEvent("onCreateDialogClose"),g.elements.dialog.destroy(),g.destroy(),r.displayNotification({msg:p.replace(p.create.templateApplyError,{name:t.info.name}),eventID:"error"})})).finally((function(){n._reset(),n.end()}))}))})).catch((e=>{}))}else n._reset(),n.end()}))},IFT:function(){var t=this;if(e.is(t.template,"object")){var n=e.clone(t.template);t.utils._openCreateAndApplyTemplate.call(t,n)}else require(["DS/IssueComponents/templates/TemplatesDialog"],(function(e){var n=d.get("widget")||window.widget;t.component=new e(n.body,{editMode:!1,onClose:function(){t._reset(),t.end()},onEnd:t.utils._openCreateAndApplyTemplate.bind(t)}),t.component.render()}))}}});return p}));