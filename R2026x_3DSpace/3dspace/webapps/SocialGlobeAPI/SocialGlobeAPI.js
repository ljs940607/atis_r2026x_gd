define("DS/SocialGlobeAPI/Core/Representation",["require","exports"],(function(e,t){"use strict";return function(){function e(e,t){this.model=e,this.id=e.getId(),this.type=t,this.container=null}return e.prototype.getNode=function(){return this.node},e.prototype.setContainer=function(e){this.container=e},e.prototype.updateVisible=function(){this.container&&(this.model.isVisible()?this.container.attach(this):this.container.detach(this))},e.prototype.isVisible=function(){return this.model.isVisible()},e}()})),define("DS/SocialGlobeAPI/Configuration",["require","exports"],(function(e,t){"use strict";return{colors:{selectedColor:"#368ec4"},displayModes:["default","bubble","extent"],defaultValue:{clusteringOpts:{animate:!0,zoomToBoundsOnClick:!0,disableClusteringAtZoom:19,maxClusterRadius:80}},state:{clustering:{}},viewers:{leafletViewer:{renderers:{marker:["MarkerLeafletRenderer"],link:["LinkLeafletRenderer"]}},cityViewer:{},sphericViewer:{}},rendererRepresentationType:{MarkerLeafletRenderer:"default",LinkLeafletRenderer:"default"}}})),define("DS/SocialGlobeAPI/Type/ViewerTypes",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("DS/SocialGlobeAPI/Tools",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={isHexaColor:function(e){var t=/^#[0-9A-F]{6}$/i;return console.log("isHexaColor: str: ".concat(e,", test (").concat(t.test(e),")")),t.test(e)}}})),define("DS/SocialGlobeAPI/Core/MapEventManager",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this.eventBus=e}return e.prototype.onLinkCreated=function(e){return this.eventBus.on(this.eventBus.events.viewer.edition.link,e),this},e.prototype.onMoveStart=function(e){return this.eventBus.on(this.eventBus.events.map.movestart,e),this},e.prototype.onMoveEnd=function(e){return this.eventBus.on(this.eventBus.events.map.moveend,e),this},e.prototype.onZoomStart=function(e){return this.eventBus.on(this.eventBus.events.map.zoomstart,e),this},e.prototype.onZoomEnd=function(e){return this.eventBus.on(this.eventBus.events.map.zoomend,e),this},e.prototype.onPanStart=function(e){return this.eventBus.on(this.eventBus.events.map.panstart,e),this},e.prototype.onPanEnd=function(e){return this.eventBus.on(this.eventBus.events.map.panend,e),this},e.prototype.offMoveStart=function(e){return this.eventBus.off(this.eventBus.events.map.movestart,e),this},e.prototype.offMoveEnd=function(e){return this.eventBus.off(this.eventBus.events.map.moveend,e),this},e.prototype.offZoomStart=function(e){return this.eventBus.off(this.eventBus.events.map.zoomstart,e),this},e.prototype.offZoomEnd=function(e){return this.eventBus.off(this.eventBus.events.map.zoomend,e),this},e.prototype.offPanStart=function(e){return this.eventBus.off(this.eventBus.events.map.panstart,e),this},e.prototype.offPanEnd=function(e){return this.eventBus.off(this.eventBus.events.map.panend,e),this},e.prototype.offLinkCreated=function(e){return this.eventBus.off(this.eventBus.events.viewer.edition.link,e),this},e}();t.default=o})),define("DS/SocialGlobeAPI/Core/Manager",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this.type=e,this.dataModel=new Map,this.onUpdate=t}return e.prototype.hasFeature=function(e){return this.dataModel.has(e)},e.prototype.getFeature=function(e){return this.dataModel.get(e)},e.prototype.addModel=function(e){e.addEvent("onChange:selected",this.update("selected")),e.addEvent("onChange:position",this.update("popupPosition")),e.addEvent("onChange:popup",this.update("popup")),e.addEvent("onChange:visible",this.update("visible")),this.dataModel.set(e.getId(),e)},e.prototype.removeModel=function(e){e.removeEvent("onChange:selected"),e.removeEvent("onChange:popup"),e.removeEvent("onChange:position"),e.clear({silent:!0}),this.dataModel.delete(e.getId())},e.prototype.getType=function(){return this.type},e.prototype.update=function(e){var t=this;return function(o){return null==t?void 0:t.onUpdate(e,o)}},e.prototype.reset=function(){this.dataModel.clear()},e}();t.default=o}));var __extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),__rest=this&&this.__rest||function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(o[n[r]]=e[n[r]])}return o};define("DS/SocialGlobeAPI/UI/PlusMinusButton/PlusMinusButton",["require","exports","DS/Controls/Abstract","DS/Core/WebUXComponents","DS/Controls/Button","UWA/Core","css!DS/SocialGlobeAPI/UI/PlusMinusButton/PlusMinusButton.css"],(function(e,t,o,n,r,i){"use strict";var s=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.init=function(t){var o=t.onPlus,n=t.onMinus,r=__rest(t,["onPlus","onMinus"]);this.onPlus=o,this.onMinus=n,e.prototype.init.call(this,r)},t.prototype.buildView=function(){this.elements.container.addClassName("mapDemoUIControls");var e=i.createElement("div",{class:"mapDemoZoomInOutDiv"}).inject(this.elements.container);this.elements.plusBtn=new r({icon:{iconName:"plus",fontIconFamily:1},displayStyle:"lite",onClick:this.onPlus}).inject(e),this.elements.MinusBtn=new r({icon:{iconName:"minus",fontIconFamily:1},displayStyle:"lite",onClick:this.onMinus}).inject(e)},t.prototype.inject=function(t,o){return e.prototype.inject.call(this,t,o)},t}(o);return n.addClass(s,"MapDemoUIControls"),s})),define("DS/SocialGlobeAPI/Type/DisplayModeTypes",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("DS/SocialGlobeAPI/Model/Feature",["UWA/Class/Model","UWA/Utils"],(function(e,t){"use strict";const o={trigger:"click",offset:{x:0,y:0},content:null};return e.extend({urlRoot:"/feature",defaults:{type:"feature",id:"",title:"",desc:"",color:"Blue",visible:!0,editable:!0,selectable:!0,selected:!1,onSelectCallback:[],onUnSelectCallback:[],userData:{},position:0,popup:{trigger:null,offset:{x:0,y:0},content:null}},setup:function(){this.id||(this.id=t.getUUID()),this._attributes.id=this.id,this._attributes.onSelectCallback=[],this._attributes.onUnSelectCallback=[]},positionChange:function(){const e=this.get("position");this.set("position",e+1)},select:function(){this.setSelected(!0)},unSelect:function(){this.setSelected(!1)},setDesc:function(e){this.getEditable()&&this.set("desc",e)},setUserData:function(e){this.getEditable()&&this.set("userData",e)},setUserDatum:function(e,t){if(!this.getEditable())return;const o=this.getUserData();o[e]=t,this.setUserData(o)},setVisible:function(e){this.set("visible",e)},setSelectable:function(e){this.set("selectable",e)},setEditable:function(e){this.set("editable",e)},setSelected:function(e,t){this.set("selected",e,t)},setOnSelectCallback:function(e){if(void 0===e)return;this.get("onSelectCallback").push(e)},unsetOnSelectCallback:function(e){const t=this.get("onSelectCallback"),o=t.findIndex((t=>t===e));-1!==o&&t.splice(o,1)},setOnUnSelectCallback:function(e){if(void 0===e)return;this.get("onUnSelectCallback").push(e)},unsetOnUnSelectCallback:function(e){const t=this.get("onUnSelectCallback"),o=t.findIndex((t=>t===e));-1!==o&&t.splice(o,1)},setColor:function(e){this.getEditable()&&this.set("color",e)},setTitle:function(e){this.getEditable()&&this.set("title",e)},setPopup:function(e){this.set("popup",{...o,...e})},getTitle:function(){return this.get("title")},getUserData:function(){return this.get("userData")},getUserDatum:function(e){return this.get("userData")[e]},getPopup:function(){return this.get("popup")},getEditable:function(){return this.get("editable")},getColor:function(){return this.get("color")},getId:function(){return this.get("id")},getType:function(){return this.get("type")},getDesc:function(){return this.get("desc")},isVisible:function(){return this.get("visible")},isSelectable:function(){return this.get("selectable")},isSelected:function(){return this.get("selected")},callSelectCallback:function(){this.get("onSelectCallback").forEach((e=>e(this._getCallbackArg())))},callUnSelectCallback:function(){this.get("onUnSelectCallback").forEach((e=>e(this._getCallbackArg())))},_getCallbackArg:function(){return this}})})),define("DS/SocialGlobeAPI/Core/EventBus",["require","exports"],(function(e,t){"use strict";var o="/MapComponentEvents";return function(){function e(){this.root=o,this.events={renderer:{activate:o+"/renderer/activate",disable:o+"/renderer/disable"},viewer:{selection:o+"/viewer/selection",edition:{link:o+"/viewer/edition/link"}},map:{zoomstart:o+"/map/zoomstart",zoomend:o+"/map/zoomend",movestart:o+"/map/movestart",moveend:o+"/map/moveend",panstart:o+"/map/panstart",panend:o+"/map/panend",linkcreated:o+"/map/linkcreated",mousedown:o+"/map/mousedown"},state:{reset:o+"/state/reset",display:o+"/state/display",clustering:o+"/state/clustering",batch:o+"/state/batch",edit:o+"/state/edit"},marker:{selected:o+"/marker/update/selected"},link:{selected:o+"/link/update/selected"}},this.modelEvents=[o+"/marker/add",o+"/marker/remove",o+"/marker/update/selected",o+"/marker/update/position",o+"/marker/update/lat",o+"/marker/update/lng",o+"/marker/update/icon",o+"/marker/update/badge",o+"/marker/update/color",o+"/marker/update/popup",o+"/marker/update/notification",o+"/marker/update/popupPosition",o+"/marker/update/visible",o+"/link/add",o+"/link/remove",o+"/link/update/selected",o+"/link/update/position",o+"/link/update/pattern",o+"/link/update/icon",o+"/link/update/color",o+"/link/update/bidirectional",o+"/link/update/origin",o+"/link/update/destination",o+"/link/update/weight",o+"/link/update/opacity",o+"/link/update/popup",o+"/link/update/popupPosition",o+"/link/update/visible"],this.listeners=new Map}return e.prototype.on=function(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)},e.prototype.emit=function(e,t){this.listeners.has(e)&&this.listeners.get(e).forEach((function(e){return e(t)}))},e.prototype.off=function(e,t){if(this.listeners.has(e)){var o=this.listeners.get(e);this.listeners.set(e,o.filter((function(e){return e!==t})))}},e}()})),define("DS/SocialGlobeAPI/Type/State",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("DS/SocialGlobeAPI/Core/IMapEvents",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("DS/SocialGlobeAPI/HTML/Marker",["require","exports","DS/Utilities/Dom","DS/Controls/Popup"],(function(e,t,o,n){"use strict";return function(){function e(){}return e.getHTMLElement=function(e){return(new DOMParser).parseFromString(e,"text/html").body.firstChild},e.getMarkerHTMLString=function(t){var o="<div class='marker2d'  id=\"".concat(t.getId(),'" >');return o+=e.getIconHTMLString(t.getIcon(),t.getColor()),o+=t.getNotification()?e.getNotificationHTMLString(t.getNotification().text,t.getNotification().color):"",o+=t.getBadge()?e.getBadgeHTMLString(t.getBadge().icon,t.getBadge().color):"",o+="</div>"},e.getIconHTMLString=function(t,o){var n='\n      <div class="gv-marker"><svg version="1.1" baseProfile="basic" id="Calque_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 32 32" xml:space="preserve">\n        <g>\n          <path class="'.concat(e.svgMarkerClassName,'" fill="#FFFFFF" d="M16,31.5c-0.6,0-1.2-0.3-1.6-0.8l-7.2-9.6c-0.2-0.3-0.4-0.6-0.6-0.9c-1.5-2.5-2-5.5-1.2-8.3\n            C6,9,7.8,6.6,10.3,5.1C12,4,14,3.5,16,3.5c2,0,4,0.5,5.7,1.6c2.5,1.5,4.3,3.9,5,6.8c0.7,2.8,0.3,5.8-1.2,8.3\n            c-0.2,0.3-0.4,0.6-0.6,0.9l-7.2,9.6C17.2,31.2,16.6,31.5,16,31.5z" />\n          <path fill="#3d3d3d" d="M16,4L16,4c1.9,0,3.8,0.5,5.4,1.5c2.4,1.4,4.1,3.7,4.8,6.5c0.7,2.7,0.3,5.5-1.2,7.9\n            c-0.2,0.3-0.4,0.6-0.6,0.9l-7.2,9.6C16.9,30.8,16.5,31,16,31c-0.5,0-0.9-0.2-1.2-0.6l-7.2-9.6c-0.2-0.3-0.4-0.6-0.6-0.9\n            c-1.4-2.4-1.9-5.2-1.2-7.9c0.7-2.7,2.4-5,4.8-6.5C12.2,4.5,14.1,4,16,4L16,4 M16,3C16,3,16,3,16,3C16,3,16,3,16,3L16,3\n            C16,3,16,3,16,3c-2,0-4.1,0.5-5.9,1.6C4.6,7.9,2.9,15,6.1,20.4c0.2,0.3,0.4,0.7,0.7,1L14,31c0.5,0.6,1.2,1,2,1c0.8,0,1.5-0.4,2-1\n            l7.2-9.6c0.2-0.3,0.5-0.6,0.7-1c3.3-5.4,1.5-12.5-3.9-15.8C20.1,3.5,18,3,16,3C16,3,16,3,16,3L16,3L16,3z" />\n        </g>\n      </svg></div>\n    ');return n+="<div class='".concat(e.iconClassName,"' style='color:").concat(o,"'>").concat(e.getUiIcon(t),"</div>")},e.getUiIcon=function(e){var t=o.generateIcon(e);return t.removeClassName("wux-ui-3ds-lg"),t.outerHTML},e.getDivIcon=function(t,o){var n="<div class='".concat(t,"'>").concat(e.getUiIcon(o),"</div>");return e.getHTMLElement(n)},e.getNotificationHTMLString=function(t,o){var n="";if(!t)return n;var r=parseInt(t)<99?t.toString():"99+",i=o||"#E87B00";return n+='<div class="'.concat(e.notificationClassName,'" style="background-color:').concat(i,'">').concat(r,"</div>")},e.getBadgeHTMLString=function(t,o){var n="";if(!t)return n;var r=t||"user",i=o||"#00B8DE";return n+='<div class="'.concat(e.badgeClassName,'" style="background-color:').concat(i,'">').concat(this.getUiIcon(r),"</div>")},e.createPopup=function(e,t){var o=t.content,r=t.offset;t.trigger;if(null==o)return null;var i=new n({target:e,trigger:"",constraint:"screen",offset:r});return i.addEventListener("show",(function(e){i.getBody()||i.setBody("function"!=typeof o?o:o.call())})),i},e.iconClassName="gv-marker-icon",e.badgeClassName="gv-badge",e.notificationClassName="gv-notif",e.svgMarkerClassName="svg-marker",e}()})),define("DS/SocialGlobeAPI/Core/Container",["require","exports"],(function(e,t){"use strict";return function(){function e(e,t){this.createRepresentation=t,this.type=e,this.views=new Map}return e.prototype.addView=function(e){var t=this.createRepresentation(e);this.views.set(e.getId(),t),e.isVisible()&&this.attach(t),t.setContainer(this)},e.prototype.removeView=function(e){this.views.has(e)&&(this.detach(this.views.get(e)),this.views.get(e).delete(),this.views.delete(e))},e.prototype.getNodeType=function(){return this.type},e.prototype.hasView=function(e){return this.views.has(e)},e.prototype.get=function(e){return this.views.get(e)},e.prototype.clear=function(){this.views.forEach((function(e){return e.delete()})),this.views.clear(),this.detachAll()},e}()})),define("DS/SocialGlobeAPI/Model/Model",["UWA/Class/Model","UWA/Utils"],(function(e,t){"use strict";return e.extend({defaults:{type:"model",id:"",visible:!0},setup:function(){this.id||(this.id=t.getUUID()),this._attributes.id=this.id},getId:function(){return this.get("id")},getType:function(){return this.get("type")},isVisible:function(){return this.get("visible")}})})),define("DS/SocialGlobeAPI/Core/Component",["require","exports"],(function(e,t){"use strict";return function(e){this.eventBus=e}})),define("DS/SocialGlobeAPI/Core/Event",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.events=new Map,this.dispatch=this.dispatch.bind(this)}return e.prototype.addEventListener=function(e,t){var o;this.events.has(e)||this.events.set(e,[]),null===(o=this.events.get(e))||void 0===o||o.push(t)},e.prototype.dispatch=function(e){for(var t,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];null===(t=this.events.get(e))||void 0===t||t.forEach((function(e){return e.apply(void 0,o)}))},e.prototype.removeListener=function(e,t){var o=this.events.get(e);if(!o)return!1;var n=o.findIndex((function(e){return e===t}));return-1!==n&&(o.splice(n,1),!0)},e}();t.default=o})),define("DS/SocialGlobeAPI/Core/Renderer",["require","exports","DS/SocialGlobeAPI/Configuration"],(function(e,t,o){"use strict";return function(){function e(e,t,n,r){this.name=r,this.type=n,this.representationType=o.rendererRepresentationType[this.name],this.viewerId=e.getId(),this.viewerType=e.getType(),this.container=t,this.rootNode=e.getRepresentationRootNode(this.container.getNodeType()),this.handleSelection=this.handleSelection.bind(this),this.handleUnSelection=this.handleUnSelection.bind(this)}return e.prototype.addView=function(e){e.getType()===this.type&&this.container.addView(e)},e.prototype.removeView=function(e){e.getType()===this.type&&this.container.removeView(e.getId())},e.prototype.loadDataModel=function(e){var t=this;e.forEach((function(e){e.getType()===t.type&&t.container.addView(e)}))},e.prototype.onClustering=function(e){e?this.hide():this.show()},e.prototype.show=function(){this.container.addTo(this.rootNode)},e.prototype.hide=function(){this.container.removeFrom(this.rootNode)},e.prototype.clear=function(){this.container.removeFrom(this.rootNode),this.container.clear()},e.prototype.getRepresentationType=function(){return this.representationType},e.prototype.update=function(e,t){var o=t.getId();if(this.container.hasView(o)){var n=this.container.get(o),r="update".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));if(!(r in n))throw new Error("".concat(this.type).concat(this.getRepresentationType(),"Renderer - ").concat(r," unexists for views."));n[r]()}},e.prototype.handleSelection=function(e){var t=e.getId(),o=this.container.get(t);o&&o.select()},e.prototype.handleUnSelection=function(e){var t=e.getId(),o=this.container.get(t);o&&o.unselect()},e.prototype.getViewerId=function(){return this.viewerId},e.prototype.getType=function(){return this.type},e.prototype.getViewerType=function(){return this.viewerType},e.prototype.reset=function(){this.container.clear()},e}()}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/Container/LeafletContainer",["require","exports","DS/SocialGlobeAPI/Core/Container","SocialGlobe/assets/leaflet/leaflet"],(function(e,t,o,n){"use strict";return function(e){function t(t){var o=e.call(this,"leaflet",t)||this;return o.defaultNode=n.layerGroup(),o.node=o.defaultNode,o.attach=o.attach.bind(o),o}return __extends(t,e),t.prototype.setNode=function(e){var t=this;this.detachAll(),this.node=e,this.views.forEach((function(e){e.isVisible()&&t.attach(e)}))},t.prototype.addView=function(t){e.prototype.addView.call(this,t)},t.prototype.attach=function(e){this.node.addLayer(e.getNode())},t.prototype.detach=function(e){this.node.removeLayer(e.getNode())},t.prototype.addTo=function(e){this.node.addTo(e)},t.prototype.removeFrom=function(e){this.node.removeFrom(e)},t.prototype.detachAll=function(){var e;null===(e=this.node)||void 0===e||e.clearLayers()},t.prototype.forEach=function(e){this.views.forEach((function(t){return e(t)}))},t}(o)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},__assign.apply(this,arguments)};define("DS/SocialGlobeAPI/Core/DisplayModeController",["require","exports","DS/SocialGlobeAPI/Core/Component"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t,o,n,r){var i=e.call(this,r)||this;return i.options=__assign(__assign({},n),o),i.name=t,i.renderers=[],i.models=[],i}return __extends(t,e),t.prototype.getName=function(){return this.name},t.prototype.getModel=function(e){var t=this.models.findIndex((function(t){return t.getId()===e}));return-1===t?null:this.models[t]},t.prototype.disconnect=function(){var e=this;this.renderers.forEach((function(t){t.clear(),e.eventBus.emit(e.eventBus.events.renderer.disable,t)})),this.renderers=[],this.models=[]},t.prototype.connectRenderer=function(e){void 0!==e&&(e.loadDataModel(this.models),e.show(),this.renderers.push(e),this.eventBus.emit(this.eventBus.events.renderer.activate,e))},t}(o);t.default=n})),define("DS/SocialGlobeAPI/Model/Marker",["DS/SocialGlobeAPI/Model/Feature"],(function(e){"use strict";return e.extend({defaults:{type:"marker",lat:0,lng:0,icon:"record",notification:{text:null,color:"#E87B00"},badge:{icon:null,color:"#00B8DE"},properties:{},color:"#3d3d3d"},setup:function(e,t){this._parent(e,t),e.popup&&this.setPopup(e.popup)},setLat:function(e){this.getEditable()&&this.set("lat",e)},setLng:function(e){this.getEditable()&&this.set("lng",e)},setIcon:function(e){if(!this.getEditable())return;const t=e||"record";this.set("icon",t)},setNotification:function(e){if(!this.getEditable())return;this.set("notification",{text:null,color:"#E87B00",...e})},setBadge:function(e){if(!this.getEditable())return;this.set("badge",{icon:null,color:"#00B8DE",...e})},setProperty:function(e,t){if(!this.getEditable())return;const o=this.get("properties");this.set("properties",{...o,[e]:t})},getLatLng:function(){return[this.get("lat"),this.get("lng")]},getLat:function(){return this.get("lat")},getLng:function(){return this.get("lng")},getIcon:function(){return this.get("icon")},getNotification:function(){return this.get("notification")},getBadge:function(){return this.get("badge")},getProperty:function(e){return this.get("properties")[e]}})}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/Representation/PopupRepresentation",["require","exports","DS/SocialGlobeAPI/HTML/Marker","DS/SocialGlobeAPI/Core/Representation"],(function(e,t,o,n){"use strict";return function(e){function t(t,o){var n=e.call(this,t,o)||this;return n.updateSelected=function(){n.model.isSelected()?n.select():n.unselect()},n.updatePopup=function(){var e=n.model.isSelected()&&"hover"!==n.model.getPopup().trigger;n.popup&&(n.popup.hide(),n.popup.target=null,n.popup=null),n.model.getPopup().content&&(n.createPopup(),e&&n.popup.show())},n.updatePopupPosition=function(){var e,t;null===(e=n.popup)||void 0===e||e.hide(),null===(t=n.popup)||void 0===t||t.show()},n}return __extends(t,e),t.prototype.createPopup=function(){this.popup=o.createPopup(this.getPopupTarget(),this.model.getPopup())},t.prototype.addHoverBehavior=function(){var e=this;this.getPopupHoverLayer().on("mouseover",(function(){e.onMouseOver()})),this.getPopupHoverLayer().on("mouseout",(function(){e.onMouseOut()}))},t.prototype.onMouseOver=function(){var e;"click"!==this.model.getPopup().trigger&&(null===(e=this.popup)||void 0===e||e.show())},t.prototype.onMouseOut=function(){var e;"click"!==this.model.getPopup().trigger&&(null===(e=this.popup)||void 0===e||e.hide())},t.prototype.select=function(){var e;"hover"!==this.model.getPopup().trigger&&null!=this.popup&&(null===(e=this.popup)||void 0===e||e.show(),"both"===this.model.getPopup().trigger&&this.getPopupHoverLayer().off("mouseout"))},t.prototype.unselect=function(){var e,t=this;"hover"!==this.model.getPopup().trigger&&null!==this.popup&&(null===(e=this.popup)||void 0===e||e.hide(),"both"===this.model.getPopup().trigger&&this.getPopupHoverLayer().on("mouseout",(function(){t.onMouseOut()})))},t.prototype.delete=function(){var e;null===(e=this.popup)||void 0===e||e.hide(),this.getPopupHoverLayer().off("mouseover"),this.getPopupHoverLayer().off("mouseout")},t}(n)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/Representation/LeafletRepresentation",["require","exports","DS/SocialGlobeAPI/Representation/PopupRepresentation"],(function(e,t,o){"use strict";return function(e){function t(t,o){return e.call(this,t,o)||this}return __extends(t,e),t}(o)})),define("DS/SocialGlobeAPI/DisplayMode/Bubble/BubbleModel",["DS/SocialGlobeAPI/Model/Feature"],(function(e){"use strict";return e.extend({defaults:{type:"bubble",radius:0,color:null,opacity:null,strokeColor:null,strokeWidth:null,lat:0,lng:0,marker:null,onSelectCallback:[],onUnSelectCallback:[]},setup:function(e,t){this._parent(e,t)},getAttributes:function(){return{radius:this.get("radius"),color:this.get("color"),opacity:this.get("opacity"),strokeColor:this.get("strokeColor"),strokeWidth:this.get("strokeWidth")}},getLatLon:function(){return[this.get("lat"),this.get("lng")]},getMarkerId:function(){return this.get("marker").getId()},getBubbleInfos(){return{color:this.get("color"),marker:this.get("marker")}},_getCallbackArg:function(){return this.getBubbleInfos()}})}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/Core/Viewer",["require","exports","DS/SocialGlobeAPI/Core/Component"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(o,n,r){var i=e.call(this,r)||this;return i.id=o,i.type=n+"Viewer",i.rootNodes=new Map,i.container=document.getElementById(o),i.container.classList.add(t.cssClassContainer),i.initContainerClickDispatcher(),i}return __extends(t,e),t.prototype.getId=function(){return this.id},t.prototype.getType=function(){return this.type},t.prototype.getRepresentationRootNode=function(e){return this.rootNodes.get(e)},t.prototype.initContainerClickDispatcher=function(){var e=this;this.container.addEventListener("click",(function(t){var o=t.target,n=o.getAttribute("id");if(!n){var r=new RegExp(/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i);o.classList.forEach((function(e){e.match(r)&&(n=e)}))}e.eventBus.emit(e.eventBus.events.viewer.selection,n)}))},t.cssClassContainer="map-component",t}(o);t.default=n}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},__assign.apply(this,arguments)};define("DS/SocialGlobeAPI/Viewer/LeafletViewer",["require","exports","DS/SocialGlobeAPI/Core/Viewer","SocialGlobe/assets/leaflet/leaflet","DS/VEND3js/5.7.0/d3.min","DS/SocialGlobeAPI/Model/Marker","DS/Web3DXCityFoundation/StringProvider"],(function(e,t,o,n,r,i,s){"use strict";return function(e){function t(t,o,i){var s=e.call(this,t,"leaflet",i)||this;return s.initMap(o),s.setTrademark2D(),s.trackResize(),s.initRootNodes(),n.svg({clickable:!0}).addTo(s.map),s.svg=r.select(s.map.getPanes().overlayPane).select("svg").attr("pointer-events","auto"),s.g=s.svg.append("g").attr("class",""),s.dispatchMapEvent=s.dispatchMapEvent.bind(s),s.initMapEvents(),s}return __extends(t,e),t.prototype.initRootNodes=function(){var e=n.layerGroup();e.addTo(this.map),this.rootNodes.set("leaflet",e)},t.prototype.initMapEvents=function(){var e=this;this.map.on("zoomend",(function(){e.dispatchMapEvent(e.eventBus.events.map.zoomend)})),this.map.on("zoomstart",(function(){return e.dispatchMapEvent(e.eventBus.events.map.zoomstart)})),this.map.on("dragstart",(function(){return e.dispatchMapEvent(e.eventBus.events.map.panstart)})),this.map.on("dragend",(function(){return e.dispatchMapEvent(e.eventBus.events.map.panend)})),this.map.on("mousedown",(function(){e.eventBus.emit(e.eventBus.events.map.mousedown,null)}))},t.prototype.initMap=function(e){var t=e.initialCoordinates,o=void 0===t?[48.786192,2.210616]:t,r=e.initialZoomLevel,i=void 0===r?8:r,s=e.initialMaxLevel,a=void 0===s?19:s,l=e.minZoom,c=void 0===l?0:l;if(this.map=n.map(this.container,{zoomControl:!1,maxBounds:[[-90,-180],[90,180]],doubleClickZoom:!1,maxZoom:a,minZoom:c,maxBoundsViscosity:1,center:o,zoom:i}),!this.map.getPane("background-link")){var u=this.map.createPane("background-link");u.style.zIndex=350,u.style.pointerEvents="none"}n.DomUtil.addClass(this.container,"crosshair-cursor-enabled")},t.prototype.onClick=function(e){this.map.on("click",(function(t){e(t.latlng.lat,t.latlng.lng)}))},t.prototype.offClick=function(){this.map.off("click")},t.prototype.setTrademark2D=function(){var e=s.getOsmTrademark();this.map.attributionControl.addAttribution(e),this.map.attributionControl.setPrefix(!1),this.map.attributionControl._container.classList.add("trademark")},t.prototype.addTileLayer=function(e){this.tileLayer=n.tileLayer(e,{maxNativeZoom:20,maxZoom:20,noWrap:!0}),this.map.addLayer(this.tileLayer)},t.prototype.trackResize=function(){var e=this;if(!window.ResizeObserver)throw new Error("ResizeObserver not available on this browser");this.resizeObserver=new ResizeObserver((function(){e.map.invalidateSize()})),this.resizeObserver.observe(this.container)},t.prototype.moveCamera=function(e,t,o){var n,r,i;if(void 0===o&&(o={}),!(null==o?void 0:o.viewerId)||(null==o?void 0:o.viewerId)===this.getId()){var s=o.zoomLevel,a=o.outOnly,l=s||this.map.getZoom();if(a&&this.isLatLonInsideExtent(e,t)){if(l===this.getZoomLvl())return;e=(n=this.getCenter())[0],t=n[1]}this.dispatchMapEvent(this.eventBus.events.map.movestart),this.map.flyTo([e,t],l,{animate:null===(r=o.animate)||void 0===r||r,duration:null!==(i=o.duration)&&void 0!==i?i:2}),this.dispatchMapEvent(this.eventBus.events.map.moveend)}},t.prototype.dispatchMapEvent=function(e){var t=this.getCenter(),o=this.getExtent(),n=this.getZoomLvl();this.eventBus.emit(e,{center:t,extent:o,zoomLvl:n,id:this.id})},t.prototype.isLatLonInsideExtent=function(e,t){return this.map.getBounds().contains([e,t])},t.prototype.fitBounds=function(e,t){(null==t?void 0:t.viewerId)&&(null==t?void 0:t.viewerId)!==this.getId()||this.map.fitBounds(e,t)},t.prototype.onDnDLink=function(e){var o=this;this.map.on("mousedown",(function(r){var s=e(o.getMarkerIdFromEvent(r));if(s&&s instanceof i){var a=s.getLatLng(),l=[r.latlng.lat,r.latlng.lng],c=n.polyline([a,l],{color:"#3d3d3d",opacity:.4}).addTo(o.rootNodes.get("leaflet"));o.map.on("mousemove",(function(e){o.map.dragging.disable();var r=[e.latlng.lat,e.latlng.lng];c.setLatLngs([a,r]);var i=e.containerPoint,s=o.map.latLngToContainerPoint(n.latLng(a));t.closeToBorders(i,o.map.getSize())&&o.map.panBy(t.calculateVector(s,i))})),o.map.on("mouseup",(function(t){var n=e(o.getMarkerIdFromEvent(t));c.removeFrom(o.rootNodes.get("leaflet")),n&&n instanceof i&&o.eventBus.emit(o.eventBus.events.viewer.edition.link,[s,n]),o.map.off("mousemove"),o.map.off("mouseup"),o.map.off("move"),o.map.dragging.enable()}))}}))},t.prototype.offDnDLink=function(){this.map.off("mousedown")},t.prototype.getMarkerIdFromEvent=function(e){return e.originalEvent.target.getAttribute("id")},t.prototype.getZoomLvl=function(){return this.map.getZoom()},t.prototype.getCenter=function(){var e=this.map.getCenter();return[e.lat,e.lng]},t.prototype.getExtent=function(){var e=this.map.getBounds(),t=e._northEast,o=e._southWest;return[[t.lat,t.lng],[o.lat,o.lng]]},t.prototype.zoomIn=function(e){if(!(null==e?void 0:e.viewerId)||(null==e?void 0:e.viewerId)===this.getId()){var t=this.getZoomLvl()+1;return this.zoom(t,e),t}},t.prototype.zoomOut=function(e){if(!(null==e?void 0:e.viewerId)||(null==e?void 0:e.viewerId)===this.getId()){var t=this.getZoomLvl()-1;return this.zoom(t,e),t}},t.prototype.zoom=function(e,t){var o=this.getCenter(),n=o[0],r=o[1];this.moveCamera(n,r,__assign({zoomLevel:e},t))},t.closeToBorders=function(e,t){var o=e.x,n=e.y,r=t.x,i=t.y;return o<10||o>r-10||n<10||n>i-10},t.calculateVector=function(e,t){var o=e.x,n=e.y,r=t.x-o,i=t.y-n,s=Math.sqrt(Math.pow(r,2)+Math.pow(i,2));return{x:30*(r/s),y:30*(i/s)}},t}(o.default)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/Manager/SelectionManager",["require","exports","DS/SocialGlobeAPI/Core/Component"],(function(e,t,o){"use strict";var n=function(e){function t(t,o,n){var r=e.call(this,n)||this;return r.selectionStrategies=[],r.unSelectionStrategies=[],r.selectedItems=[],r.selectionCallback=t,r.unSelectionCallback=o,r.onMouseDown=r.onMouseDown.bind(r),r.onZoomEnd=r.onZoomEnd.bind(r),r.onRendererActivated=r.onRendererActivated.bind(r),r.onRendererDisabled=r.onRendererDisabled.bind(r),r.onModelSelected=r.onModelSelected.bind(r),r.initListeners(),r}return __extends(t,e),t.prototype.getSelection=function(){return this.selectedItems.map((function(e){return e.model}))},t.prototype.addToSelection=function(e,t){this.selectedItems.push({name:e,model:t})},t.prototype.removeFromSelection=function(e){var t=this.selectedItems.findIndex((function(t){return t.model===e}));this.selectedItems.splice(t,1)},t.prototype.initListeners=function(){this.eventBus.on(this.eventBus.events.map.mousedown,this.onMouseDown),this.eventBus.on(this.eventBus.events.map.zoomend,this.onZoomEnd),this.eventBus.on(this.eventBus.events.renderer.activate,this.onRendererActivated),this.eventBus.on(this.eventBus.events.renderer.disable,this.onRendererDisabled),this.eventBus.on(this.eventBus.events.marker.selected,this.onModelSelected),this.eventBus.on(this.eventBus.events.link.selected,this.onModelSelected)},t.prototype.onModelSelected=function(e){e.isSelected()?this.select(e.getType(),e):this.unSelect(e.getType(),e)},t.prototype.onZoomEnd=function(){this.selectedItems.forEach((function(e){return e.model.positionChange()}))},t.prototype.onMouseDown=function(){this.clearSelection()},t.prototype.onRendererActivated=function(e){var t="".concat(e.getViewerType(),":").concat(e.getViewerId(),":").concat(e.getType());this.registerSelectionStrategy(t,e.handleSelection),this.registerUnSelectionStrategy(t,e.handleUnSelection)},t.prototype.onRendererDisabled=function(e){var t="".concat(e.getViewerType(),":").concat(e.getViewerId(),":").concat(e.getType());this.unRegisterSelectionStrategy(t),this.unRegisterUnSelectionStrategy(t)},t.prototype.removeStrategies=function(e){this.clearSelection(),this.selectionStrategies=this.selectionStrategies.filter((function(t){return t.getName()!==e})),this.unSelectionStrategies=this.unSelectionStrategies.filter((function(t){return t.getName()!==e}))},t.prototype.clearSelection=function(){var e=this;this.selectedItems.forEach((function(t){var o=t.name,n=t.model;e.unSelectByClick(o,n)})),this.selectedItems=[]},t.prototype.registerSelectionStrategy=function(e,t){this.selectionStrategies.push(new r(e,t))},t.prototype.registerUnSelectionStrategy=function(e,t){this.unSelectionStrategies.push(new r(e,t))},t.prototype.unRegisterSelectionStrategy=function(e){this.selectionStrategies=this.selectionStrategies.filter((function(t){return t.getName()!==e}))},t.prototype.unRegisterUnSelectionStrategy=function(e){this.unSelectionStrategies=this.unSelectionStrategies.filter((function(t){return t.getName()!==e}))},t.prototype.select=function(e,t){t.isSelectable()?(this.clearSelection(),this._getSelectionStrategies(e).forEach((function(e){return e.execute(t)})),this.selectionCallback(t),this.addToSelection(e,t)):t.setSelected(!1,{silent:!0})},t.prototype.selectByClick=function(e,t){var o=this._getSelectionStrategies(e);this.clearSelection(),o.forEach((function(e){return e.execute(t)})),o.length>0&&(t.setSelected(!0,{silent:!0}),this.selectionCallback(t),t.callSelectCallback()),this.addToSelection(e,t)},t.prototype.unSelect=function(e,t){this._getUnSelectionStrategies(e).forEach((function(e){return e.execute(t)})),this.unSelectionCallback(t),this.removeFromSelection(t)},t.prototype.unSelectByClick=function(e,t){var o=this._getUnSelectionStrategies(e);o.forEach((function(e){return e.execute(t)})),o.length>0&&(t.setSelected(!1,{silent:!0}),this.unSelectionCallback(t),t.callUnSelectCallback()),this.removeFromSelection(t)},t.prototype._getSelectionStrategies=function(e){return this.selectionStrategies.filter((function(t){var o=t.getName().split(":");o[0],o[1];return o[2]===e}))},t.prototype._getUnSelectionStrategies=function(e){return this.unSelectionStrategies.filter((function(t){var o=t.getName().split(":");o[0],o[1];return o[2]===e}))},t}(o),r=function(){function e(e,t){this._name=e,this._handler=t}return e.prototype.getName=function(){return this._name},e.prototype.execute=function(e){return this._handler(e)},e}();return n})),define("DS/SocialGlobeAPI/VisuModel/Link/Link2DBuilder",["require","exports","SocialGlobe/assets/leaflet/leaflet","SocialGlobe/assets/leaflet/leaflet-polyline-decorator","DS/SocialGlobeAPI/HTML/Marker"],(function(e,t,o,n,r){"use strict";return o.Symbol.ArrowHead.Opposite=o.Symbol.ArrowHead.extend({_buildArrowPath:function(e,t){return e.heading+=180,o.Symbol.ArrowHead.prototype._buildArrowPath.call(this,e,t)}}),o.Symbol.arrowHead.opposite=function(e){return new o.Symbol.ArrowHead.Opposite(e)},function(){function e(){}return e.createArrow=function(t){return o.polylineDecorator(e.getLeafletLatLng(t),{patterns:[{offset:"100%",repeat:0,symbol:o.Symbol.arrowHead({pixelSize:15,polygon:!1,pathOptions:{stroke:!0,color:t.getColor(),weight:t.getWeight()}})}]})},e.createOppositeArrow=function(t){return t.getBidirectional()?o.polylineDecorator(e.getLeafletLatLng(t),{patterns:[{offset:"0%",repeat:0,symbol:o.Symbol.arrowHead.opposite({pixelSize:15,polygon:!1,pathOptions:{stroke:!0,color:t.getColor(),weight:t.getWeight()}})}]}):null},e.createBackgroundArrow=function(t){return o.polylineDecorator(e.getLeafletLatLng(t),{patterns:[{offset:"100%",repeat:0,symbol:o.Symbol.arrowHead({pixelSize:15,polygon:!1,pathOptions:{pane:"background-link",stroke:!0,color:"transparent",weight:t.getWeight()+2}})}]})},e.createBackgroundOppositeArrow=function(e){return e.getBidirectional()?o.polylineDecorator(this.getLeafletLatLng(e),{patterns:[{offset:"0%",repeat:0,symbol:o.Symbol.arrowHead.opposite({pixelSize:15,polygon:!1,pathOptions:{pane:"background-link",stroke:!0,color:"transparent",weight:e.getWeight()+3}})}]}):null},e.createLine=function(t,n,r,i,s,a,l){void 0===l&&(l=null);var c={className:n,weight:r,opacity:i,color:s,dashArray:e.patterns[a],bubblingMouseEvents:!0};return l&&(c.pane=l),o.polyline(t,c)},e.createMiddleMarker=function(t,n){var r=e._getMiddle(t),i=o.divIcon({html:n,iconSize:[0,0]});return o.marker(r,{icon:i})},e.createIcon=function(t,n){var i=n.getIcon();if(!i)return!1;var s=e._getMiddle(n),a=o.divIcon({html:r.getDivIcon(t,i),iconSize:[17,14.5]});return o.marker(s,{icon:a})},e._getMiddle=function(e){var t=e.getOrigin().getLatLng(),o=e.getDestination().getLatLng();return[(t[0]+o[0])/2,(t[1]+o[1])/2]},e.getLeafletLatLng=function(e){return e.getLatLngs().map((function(e){return o.latLng(e)}))},e.createPopup=function(e,t){return r.createPopup(e,t)},e.patterns={solid:[1],dotted:[1,4],dashed:[7,7],dashdotted:[7,4,1,4]},e}()})),define("DS/SocialGlobeAPI/Model/Link",["DS/SocialGlobeAPI/Model/Feature"],(function(e){"use strict";return e.extend({defaults:{type:"link",origin:null,destination:null,bidirectional:!1,icon:null,pattern:"solid",color:"#3d3d3d",weight:3.5,opacity:.9},setup:function(e,t){this._parent(e,t)},setOrigin:function(e){this.getEditable()&&this.set("origin",e)},setDestination:function(e){this.getEditable()&&this.set("destination",e)},setBidirectional:function(e){this.getEditable()&&this.set("bidirectional",e)},setIcon:function(e){this.getEditable()&&this.set("icon",e)},setPattern:function(e){this.getEditable()&&this.set("pattern",e)},setWeight:function(e){this.getEditable()&&this.set("weight",e)},setOpacity:function(e){this.getEditable()&&this.set("opacity",e)},getOrigin:function(){return this.get("origin")},getDestination:function(){return this.get("destination")},getBidirectional:function(){return this.get("bidirectional")},getIcon:function(){return this.get("icon")},getPattern:function(){return this.get("pattern")},getWeight:function(){return this.get("weight")},getOpacity:function(){return this.get("opacity")},getLatLngs:function(){return[this.getOrigin().getLatLng(),this.getDestination().getLatLng()]}})}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/Representation/LinkLeafletRepresentation",["require","exports","DS/SocialGlobeAPI/Representation/LeafletRepresentation","UWA/Core","SocialGlobe/assets/leaflet/leaflet","DS/SocialGlobeAPI/VisuModel/Link/Link2DBuilder","DS/SocialGlobeAPI/Configuration"],(function(e,t,o,n,r,i,s){"use strict";var a=s.colors.selectedColor;return function(e){function t(o){var s=e.call(this,o,"default")||this;return s.updatePosition=function(){var e=i.getLeafletLatLng(s.getModel()),t=s.link,o=t.line,n=t.arrow,r=t.oppositeArrow,a=t.middleMarker,l=t.hoverLine,c=s.background,u=c.line,p=c.arrow,d=c.oppositeArrow;o.setLatLngs(e),l.setLatLngs(e),u.setLatLngs(e),n.setPaths(e),p.setPaths(e),a.setLatLng(i._getMiddle(s.getModel())),r&&r.setPaths(e),d&&d.setPaths(e)},s.updateIcon=function(){var e=s.getModel().getIcon(),o=s.link,n=o.layerGroup,r=o.iconMarker;if(n.hasLayer(r)&&n.removeLayer(r),e){var a=i.createIcon(t.divIconClassName,s.model);n.addLayer(a),s.link.iconMarker=a}},s.updateColor=function(){var e=i.createArrow(s.getModel()),t=s.link,o=t.line,n=t.arrow,r=t.layerGroup;o.setStyle({color:s.getModel().getColor()}),r.removeLayer(n),r.addLayer(e),s.link.arrow=e},s.updatePattern=function(){s.link.line.setStyle({dashArray:i.patterns[s.getModel().getPattern()]})},s.updateBidirectional=function(){var e=s.link,t=e.layerGroup,o=e.oppositeArrow,n=s.background,r=n.layerGroup,a=n.oppositeArrow,l=i.createOppositeArrow(s.getModel()),c=i.createBackgroundOppositeArrow(s.getModel());o&&t.removeLayer(o),a&&r.removeLayer(a),l&&(t.addLayer(l),r.addLayer(c),s.link.oppositeArrow=l,s.background.oppositeArrow=c)},s.popupTarget=n.createElement("div",{class:"link-popup-target"}),s.createLink(),s.createBackground(),s.node=r.layerGroup().addLayer(s.link.layerGroup).addLayer(s.background.layerGroup),s.createPopup(),s.addHoverBehavior(),s}return __extends(t,e),t.prototype.getPopupTarget=function(){return this.popupTarget},t.prototype.getPopupHoverLayer=function(){return this.link.hoverLine},t.prototype.onMouseOver=function(){e.prototype.onMouseOver.call(this),this.background.line.options.color!==a&&this.colorizeLink("#FFFFFF",this.getModel().getColor())},t.prototype.onMouseOut=function(){e.prototype.onMouseOut.call(this),this.background.line.options.color!==a&&this.colorizeLink(this.getModel().getColor(),"transparent")},t.prototype.colorizeLink=function(e,t){var o=this.link,n=o.line,r=o.arrow,i=o.oppositeArrow,s=this.background,a=s.line,l=s.arrow,c=s.oppositeArrow;n.setStyle({color:e}),r.setStyle({color:e}),i&&i.setStyle({color:e}),a.setStyle({color:t}),l.setStyle({color:t}),c&&c.setStyle({color:t})},t.prototype.createBackground=function(){var e=i.createLine(i.getLeafletLatLng(this.getModel()),"background-line",this.getModel().getWeight()+2,.9,"transparent","solid","background-link"),t=i.createBackgroundArrow(this.getModel()),o=i.createBackgroundOppositeArrow(this.getModel()),n=r.layerGroup().addLayer(e).addLayer(t);o&&n.addLayer(o),this.background={arrow:t,layerGroup:n,line:e,oppositeArrow:o}},t.prototype.createLink=function(){var e=i.createLine(i.getLeafletLatLng(this.getModel()),"link-line",this.getModel().getWeight(),this.getModel().getOpacity(),this.getModel().getColor(),this.getModel().getPattern()),o=i.createLine(i.getLeafletLatLng(this.getModel()),"hover-line ".concat(this.getModel().getId()),this.getModel().getWeight()+4,this.getModel().getOpacity(),"transparent",this.getModel().getPattern()),n=i.createArrow(this.getModel()),s=i.createMiddleMarker(this.getModel(),this.popupTarget),a=i.createIcon(t.divIconClassName,this.getModel()),l=i.createOppositeArrow(this.getModel()),c=r.layerGroup().addLayer(e).addLayer(o).addLayer(n).addLayer(s);l&&c.addLayer(l),a&&c.addLayer(a),this.link={arrow:n,hoverLine:o,middleMarker:s,layerGroup:c,line:e,oppositeArrow:l,iconMarker:a}},t.prototype.getModel=function(){return this.model},t.prototype.select=function(){e.prototype.select.call(this),this.colorizeLink("#FFFFFF","#368ec4")},t.prototype.unselect=function(){e.prototype.unselect.call(this),this.colorizeLink(this.getModel().getColor(),"transparent")},t.prototype.delete=function(){e.prototype.delete.call(this)},t.divIconClassName="link-icon",t}(o)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/Manager/LinkManager",["require","exports","DS/SocialGlobeAPI/Core/Manager","DS/SocialGlobeAPI/Model/Link"],(function(e,t,o,n){"use strict";return function(e){function t(t){return e.call(this,"link",t)||this}return __extends(t,e),t.prototype.add=function(t){var o=new n(t);return o.addEvent("onChange:pattern",this.update("pattern")),o.addEvent("onChange:icon",this.update("icon")),o.addEvent("onChange:color",this.update("color")),o.addEvent("onChange:bidirectional",this.update("bidirectional")),o.addEvent("onChange:origin",this.update("position")),o.addEvent("onChange:destination",this.update("position")),o.addEvent("onChange:weight",this.update("position")),o.addEvent("onChange:opacity",this.update("position")),e.prototype.addModel.call(this,o),o},t.prototype.remove=function(t){t.removeEvent("onChange:pattern"),t.removeEvent("onChange:icon"),t.removeEvent("onChange:color"),t.removeEvent("onChange:bidirectional"),t.removeEvent("onChange:origin"),t.removeEvent("onChange:destination"),t.removeEvent("onChange:weight"),t.removeEvent("onChange:opacity"),e.prototype.removeModel.call(this,t)},t}(o.default)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/Renderer/LinkLeafletRenderer",["require","exports","DS/SocialGlobeAPI/Representation/LinkLeafletRepresentation","DS/SocialGlobeAPI/Core/Renderer","DS/SocialGlobeAPI/Container/LeafletContainer"],(function(e,t,o,n,r){"use strict";return function(e){function t(t){var n=new r((function(e){return new o(e)}));return e.call(this,t,n,"link","LinkLeafletRenderer")||this}return __extends(t,e),t}(n)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/DisplayMode/Extent/ExtentLeafletRepresentation",["require","exports","SocialGlobe/assets/leaflet/leaflet","DS/SocialGlobeAPI/Core/Representation","DS/SocialGlobeAPI/Configuration"],(function(e,t,o,n,r){"use strict";return function(e){function t(t){var n=e.call(this,t,"extent")||this,r=n.model.getAttributes(),i=r.extent,s=r.strokeColor,a=r.color,l=r.weight;return n.node=o.rectangle(i,{fillColor:a,color:s,weight:l}),n}return __extends(t,e),t.prototype.select=function(){this.circleLayer.setStyle({color:"#FFFFFF",strokeColor:r.colors.selectedColor})},t.prototype.unselect=function(){var e=this.model.getAttributes(),t=e.color,o=e.strokeColor;this.circleLayer.setStyle({color:o,strokeColor:t})},t.prototype.delete=function(){},t}(n)})),define("DS/SocialGlobeAPI/DisplayMode/Extent/ExtentModel",["DS/SocialGlobeAPI/Model/Model"],(function(e){"use strict";return e.extend({defaults:{type:"extent",color:null,strokeColor:null,strokeWidth:null,extent:null},setup:function(e,t){this._parent(e,t)},getAttributes:function(){return{color:this.get("color"),strokeColor:this.get("strokeColor"),weight:this.get("strokeWidth"),extent:this.get("extent")}}})}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/DisplayMode/Bubble/BubbleLeafletRepresentation",["require","exports","UWA/Core","SocialGlobe/assets/leaflet/leaflet","DS/SocialGlobeAPI/HTML/Marker","DS/SocialGlobeAPI/Representation/LeafletRepresentation","DS/SocialGlobeAPI/Configuration"],(function(e,t,o,n,r,i,s){"use strict";return function(e){function t(t){var o=e.call(this,t,"bubble")||this,r=o.model.getAttributes(),i=r.radius,s=r.color,a=r.strokeColor,l=r.opacity,c=r.strokeWidth;return o.node=n.layerGroup(),o.circleLayer=n.circleMarker(o.model.getLatLon(),{radius:i,color:a,fillColor:s,fillOpacity:l,weight:c,className:"".concat(o.model.getId())}),o.circleLayer.addTo(o.node),o.addPopupContainer(),o.addHoverBehavior(),o}return __extends(t,e),t.prototype.addPopupContainer=function(){this.popupTarget=new o.Element("div",{class:"bubble-div"});var e=n.divIcon({html:this.popupTarget,iconSize:[20,20],iconAnchor:[10,10],className:"bubble-div"});this.divMarker=n.marker(this.model.getLatLon(),{icon:e}),this.divMarker.addTo(this.node),this.popup=r.createPopup(this.popupTarget,this.model.getPopup())},t.prototype.onMouseOut=function(){if(this.circleLayer.options.fillColor!==s.colors.selectedColor){var t=this.model.getAttributes(),o=t.color,n=t.strokeColor;this.circleLayer.setStyle({fillColor:o,color:n}),e.prototype.onMouseOut.call(this)}},t.prototype.getPopupTarget=function(){return this.popupTarget},t.prototype.getPopupHoverLayer=function(){return this.circleLayer},t.prototype.select=function(){this.circleLayer.setStyle({color:"#FFFFFF",fillColor:s.colors.selectedColor}),e.prototype.select.call(this)},t.prototype.unselect=function(){var t=this.model.getAttributes(),o=t.color,n=t.strokeColor;this.circleLayer.setStyle({color:n,fillColor:o}),e.prototype.unselect.call(this)},t.prototype.delete=function(){e.prototype.delete.call(this)},t}(i)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/DisplayMode/Extent/ExtentLeafletRenderer",["require","exports","DS/SocialGlobeAPI/DisplayMode/Extent/ExtentLeafletRepresentation","DS/SocialGlobeAPI/Core/Renderer","DS/SocialGlobeAPI/Container/LeafletContainer"],(function(e,t,o,n,r){"use strict";return function(e){function t(t){var n=new r((function(e){return new o(e)}));return e.call(this,t,n,"extent","ExtentLeafletRenderer")||this}return __extends(t,e),t}(n)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/Representation/MarkerLeafletRepresentation",["require","exports","DS/SocialGlobeAPI/HTML/Marker","SocialGlobe/assets/leaflet/leaflet","DS/SocialGlobeAPI/Representation/LeafletRepresentation"],(function(e,t,o,n,r){"use strict";return function(e){function t(r){var i=e.call(this,r,"default")||this;i.updatePosition=function(){i.node.setLatLng(i.model.getLatLng())},i.updateColor=function(){var e=i.model.getColor(),n=i.domNode.querySelector(".".concat(o.iconClassName));t.changeColor(n,e)},i.updateNotification=function(){var e=i.model.getNotification(),n=e.text,r=e.color,s=i.domNode.querySelector(".".concat(o.notificationClassName));if(null!=n)if(null!==s)t.changeBackgroundColor(s,r),s.innerText=n>99?"99+":n;else{var a=o.getHTMLElement(o.getNotificationHTMLString(n,r));i.domNode.appendChild(a)}else null!==s&&i.domNode.removeChild(s)},i.updateBadge=function(){var e=i.model.getBadge(),n=e.icon,r=e.color,s=i.domNode.querySelector(".".concat(o.badgeClassName));if(null!=n)if(null!==s)t.changeBackgroundColor(s,r),s.innerHTML=o.getUiIcon(n);else{var a=o.getHTMLElement(o.getBadgeHTMLString(n,r));i.domNode.appendChild(a)}else null!==s&&i.domNode.removeChild(s)},i.updateIcon=function(){var e=i.model.getIcon(),t=i.domNode.querySelector(".".concat(o.iconClassName));null!=(null==t?void 0:t.firstChild)&&t.removeChild(t.firstChild),t.innerHTML=o.getUiIcon(e)},i.domNode=o.getHTMLElement(o.getMarkerHTMLString(i.model));var s=n.divIcon({html:i.domNode,className:"",iconSize:[32,32],iconAnchor:[16,32]});return i.node=n.marker(n.latLng(i.model.getLatLng()),{icon:s,uuid:r.getId(),pmIgnore:!0,bubblingMouseEvents:!0}),i.createPopup(),i.addHoverBehavior(),i}return __extends(t,e),t.prototype.getPopupTarget=function(){return this.domNode},t.prototype.getPopupHoverLayer=function(){return this.node},t.prototype.select=function(){var n=this.domNode.querySelector(".".concat(o.iconClassName)),r=this.domNode.querySelector(".".concat(o.svgMarkerClassName));t.changeColor(n,"#FFFFFF"),t.changeColor(r,"#368ec4"),this.domNode.classList.add("selected"),e.prototype.select.call(this)},t.prototype.unselect=function(){var n=this.model.getColor(),r=this.domNode.querySelector(".".concat(o.iconClassName)),i=this.domNode.querySelector(".".concat(o.svgMarkerClassName));t.changeColor(r,n),t.changeColor(i,"#FFFFFF"),this.domNode.classList.remove("selected"),e.prototype.unselect.call(this)},t.prototype.delete=function(){e.prototype.delete.call(this)},t.changeColor=function(e,t){switch(e.nodeName){case"DIV":e.style.color=t;break;case"path":e.setAttribute("fill",t)}},t.changeBackgroundColor=function(e,t){if("DIV"===e.nodeName)e.style.backgroundColor=t},t}(r)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/DisplayMode/Bubble/BubbleLeafletRenderer",["require","exports","DS/SocialGlobeAPI/DisplayMode/Bubble/BubbleLeafletRepresentation","DS/SocialGlobeAPI/Core/Renderer","DS/SocialGlobeAPI/Container/LeafletContainer"],(function(e,t,o,n,r){"use strict";return function(e){function t(t){var n=new r((function(e){return new o(e)}));return e.call(this,t,n,"bubble","BubbleLeafletRenderer")||this}return __extends(t,e),t}(n)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},__assign.apply(this,arguments)};define("DS/SocialGlobeAPI/DisplayMode/Extent/ExtentController",["require","exports","DS/SocialGlobeAPI/DisplayMode/Extent/ExtentModel","DS/SocialGlobeAPI/DisplayMode/Extent/ExtentLeafletRenderer","DS/SocialGlobeAPI/Core/DisplayModeController"],(function(e,t,o,n,r){"use strict";return function(e){function t(t,o,n){var r=e.call(this,"extent",t,o,n)||this;return r.renderers=[],r.layerViewers=[],r}return __extends(t,e),t.prototype.process=function(e){var t=1/0,n=1/0,r=-1/0,i=-1/0;e.filter((function(e){return"marker"===e.getType()})).forEach((function(e){var o=e.getLatLng(),s=o[0],a=o[1];t=s<t?s:t,n=a<n?a:n,r=s>r?s:r,i=a>i?a:i}));var s=[[t,n],[r,i]];this.models.push(new o(__assign(__assign({},this.options),{extent:s})))},t.prototype.connect=function(e){var t;"leafletViewer"===e.getType()&&(t=new n(e)),this.connectRenderer(t)},t.prototype.getFeature=function(e){return null},t}(r.default)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/Renderer/MarkerLeafletRenderer",["require","exports","SocialGlobe/assets/leaflet/leaflet-markercluster","SocialGlobe/assets/leaflet/leaflet","DS/SocialGlobeAPI/Representation/MarkerLeafletRepresentation","DS/SocialGlobeAPI/Core/Renderer","DS/SocialGlobeAPI/Container/LeafletContainer"],(function(e,t,o,n,r,i,s){"use strict";return function(e){function t(t,o){var i=this,a=new s((function(e){return new r(e)}));return(i=e.call(this,t,a,"marker","MarkerLeafletRenderer")||this).markerNode=n.layerGroup(),i.clusteringNode=null,i.container.setNode(i.markerNode),i.onClustering=i.onClustering.bind(i),i.onClustering(o),i}return __extends(t,e),t.prototype.addView=function(t){e.prototype.addView.call(this,t)},t.prototype.onClustering=function(e){var t;e?(this.initCluster(e),this.container.removeFrom(this.rootNode),this.clusteringNode.addTo(this.rootNode),this.container.setNode(this.clusteringNode)):(null===(t=this.clusteringNode)||void 0===t||t.removeFrom(this.rootNode),this.container.setNode(this.markerNode),this.container.addTo(this.rootNode),this.clusteringNode=null)},t.prototype.initCluster=function(e){var t=e.animate,o=e.disableClusteringAtZoom,r=e.maxClusterRadius,i=e.zoomToBoundsOnClick;this.clusteringNode=n.markerClusterGroup({maxClusterRadius:r,disableClusteringAtZoom:o,animate:t,zoomToBoundsOnClick:i,iconCreateFunction:function(e){return n.divIcon({html:e.getChildCount(),className:"customCluster",iconSize:n.point(40,40)})},showCoverageonHover:!1,removeOutsideVisibleBounds:!1})},t.prototype.reset=function(){var t;e.prototype.reset.call(this),this.markerNode.clearLayers(),null===(t=this.clusteringNode)||void 0===t||t.clearLayers()},t}(i)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/DisplayMode/Bubble/BubbleController",["require","exports","DS/SocialGlobeAPI/Core/DisplayModeController","DS/SocialGlobeAPI/Tools","DS/SocialGlobeAPI/DisplayMode/Bubble/BubbleModel","DS/VEND3js/5.7.0/d3.min","DS/SocialGlobeAPI/DisplayMode/Bubble/BubbleLeafletRenderer"],(function(e,t,o,n,r,i,s){"use strict";return function(e){function t(t,o,n){var r=e.call(this,"bubble",t,o,n)||this;return r.getMaxPropertyValue=function(e,t){return i.max(e,(function(e){return e.getProperty(t)}))},r}return __extends(t,e),t.prototype.process=function(e){var t=this,o=e.filter((function(e){return"marker"===e.getType()})).filter((function(e){return void 0!==e.getProperty(t.options.sizePropertyName)}));0!==o.length&&(this.setScaleSize(o),this.setColorGenerator(o),this.models=o.map((function(e){var o=t.options,n=o.sizePropertyName,i=o.scale,s=o.strokeColor,a=o.opacity,l=o.strokeWidth,c=o.popup,u=o.onSelect,p=o.onUnSelect,d=e.getLatLng(),f=d[0],h=d[1],g=new r({radius:t.sizeScaler(e.getProperty(n))*i,color:t.colorGenerator(e),strokeColor:s,opacity:a,strokeWidth:l,lat:f,lng:h,marker:e});return c&&g.setPopup({trigger:c.trigger,content:c.content(g.getBubbleInfos())}),g.setOnSelectCallback(u),g.setOnUnSelectCallback(p),g})))},t.prototype.setColorGenerator=function(e){var t=this.options.color;"string"!=typeof t?this.setGradientColorGenerator(e,t):void 0!==e[0].getUserDatum(t)?this.colorGenerator=function(e){return e.getUserDatum(t)}:(this.checkColor(t),this.colorGenerator=function(){return t})},t.prototype.setGradientColorGenerator=function(e,t){var o=[],n=[],r=this.getMaxPropertyValue(e,t.colorPropertyName);this.parseGradientColors(t.colors).forEach((function(e){n.push(r*e.stopValue),o.push(e.color)}));var s="linear"===t.interpolationType?i.scaleLinear():i.scaleThreshold();s.domain(n).range(o),"linear"===t.interpolationType&&s.interpolate(i.interpolate),this.colorGenerator=function(e){return s(e.getProperty(t.colorPropertyName)||0)}},t.prototype.parseGradientColors=function(e){var t=this,o=typeof e[0];if(!e.every((function(e){return typeof e===o})))throw new Error('All gradient colors must have the same type. Either HexaColor either litteral { stopValue: "X%", color: HexaColor }');var n=1/e.length,r=e.map((function(e,o){return"string"==typeof e?(t.checkColor(e),{stopValue:n*(o+1),color:e}):(t.checkColor(e.color),{stopValue:parseFloat(e.stopValue)/100,color:e.color})}));if(!r.every((function(e){return e.stopValue<=1})))throw new Error("All gradient stop value must be in [0%-100%]");return r.sort((function(e,t){return e.stopValue-t.stopValue})),r},t.prototype.checkColor=function(e){if(!n.default.isHexaColor(e))throw new Error("Bad color argument: ".concat(e,". Hexadecimal color needed."))},t.prototype.setScaleSize=function(e){var t=this.options,o=t.maxValue,n=t.minValue,r=t.sizePropertyName,s=null!=o?o:this.getMaxPropertyValue(e,r);this.sizeScaler=i.scaleSqrt().domain([n,s]).range([0,15])},t.prototype.connect=function(e){var t;"leafletViewer"===e.getType()&&(t=new s(e)),this.connectRenderer(t)},t}(o.default)})),define("DS/SocialGlobeAPI/Renderer/RendererFactory",["require","exports","DS/SocialGlobeAPI/Renderer/MarkerLeafletRenderer","DS/SocialGlobeAPI/Renderer/LinkLeafletRenderer"],(function(e,t,o,n){"use strict";return function(){function e(){}return e.createRenderer=function(e,t,r){switch(e){case"MarkerLeafletRenderer":return new o(t,null==r?void 0:r.clustering);case"LinkLeafletRenderer":return new n(t);default:throw new Error("Unknown renderer type: ".concat(e))}},e}()})),define("DS/SocialGlobeAPI/PluginsSettings",["require","exports","DS/SocialGlobeAPI/DisplayMode/Bubble/BubbleController","DS/SocialGlobeAPI/DisplayMode/Extent/ExtentController"],(function(e,t,o,n){"use strict";return{clustering:{controller:"ClusteringController",defaultOpts:{animate:!0,zoomToBoundsOnClick:!0,disableClusteringAtZoom:19,maxClusterRadius:80}},bubble:{controller:o,defaultOpts:{minValue:0,opacity:.8,color:"#005685",scale:1,strokeColor:"#fFfFfF",strokeWidth:1}},extent:{controller:n,defaultOpts:{color:"#121212",strokeColor:"#000000",strokeWidth:1}}}}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/Core/RendererManager",["require","exports","DS/SocialGlobeAPI/Core/Component"],(function(e,t,o){"use strict";return function(e){function t(t){var o=e.call(this,t)||this;return o.renderers=new Map,o.activeRenderers=[],o.onModelAdded=o.onModelAdded.bind(o),o.onModelRemoved=o.onModelRemoved.bind(o),o.onReset=o.onReset.bind(o),o.onBatch=o.onBatch.bind(o),o.onClustering=o.onClustering.bind(o),o.initListeners(),o}return __extends(t,e),t.prototype.initListeners=function(){var e=this;this.eventBus.modelEvents.forEach((function(t){var o=t.substring(e.eventBus.root.length+1).split("/"),n=(o[0],o[1]),r=o[2];"add"===n?e.eventBus.on(t,e.onModelAdded):"update"===n?e.eventBus.on(t,e.getUpdateListener(r)):"remove"===n&&e.eventBus.on(t,e.onModelRemoved)})),this.eventBus.on(this.eventBus.events.state.reset,this.onReset),this.eventBus.on(this.eventBus.events.state.batch,this.onBatch),this.eventBus.on(this.eventBus.events.state.clustering,this.onClustering)},t.prototype.onClustering=function(e){this.renderers.forEach((function(t){t.forEach((function(t){t.forEach((function(t){t.onClustering(e)}))}))}))},t.prototype.onModelRemoved=function(e){this.activeRenderers.forEach((function(t){t.removeView(e)}))},t.prototype.getUpdateListener=function(e){var t=this;return function(o){t.activeRenderers.forEach((function(t){t.update(e,o)}))}},t.prototype.onBatch=function(e){this.activeRenderers.forEach((function(t){t.loadDataModel(e)}))},t.prototype.onModelAdded=function(e){this.activeRenderers.forEach((function(t){t.addView(e)}))},t.prototype.registerRenderer=function(e,t,o,n){var r,i,s,a;void 0===n&&(n="default"),this.renderers.has(e)||this.renderers.set(e,new Map),(null===(r=this.renderers.get(e))||void 0===r?void 0:r.has(t))||null===(i=this.renderers.get(e))||void 0===i||i.set(t,new Map),null===(a=null===(s=this.renderers.get(e))||void 0===s?void 0:s.get(t))||void 0===a||a.set(n,o)},t.prototype.activateRenderer=function(e,t,o){var n,r,i=null===(r=null===(n=this.renderers.get(e))||void 0===n?void 0:n.get(t))||void 0===r?void 0:r.get(o);i&&(i.show(),this.activeRenderers.push(i),this.eventBus.emit(this.eventBus.events.renderer.activate,i))},t.prototype.disableRenderer=function(e,t,o){var n,r,i=null===(r=null===(n=this.renderers.get(e))||void 0===n?void 0:n.get(t))||void 0===r?void 0:r.get(o),s=this.activeRenderers.indexOf(i);-1!==s&&(i.clear(),this.activeRenderers.splice(s,1),this.eventBus.emit(this.eventBus.events.renderer.disable,i))},t.prototype.unregisterRenderer=function(e,t,o){var n,r,i,s;void 0===o&&(o="default");var a=null===(r=null===(n=this.renderers.get(e))||void 0===n?void 0:n.get(t))||void 0===r?void 0:r.get(o),l=this.activeRenderers.indexOf(a);a.hide(),null===(s=null===(i=this.renderers.get(e))||void 0===i?void 0:i.get(t))||void 0===s||s.delete(o),l>-1&&this.activeRenderers.splice(l,1)},t.prototype.removeViewer=function(e){this.renderers.delete(e),this.activeRenderers=this.activeRenderers.filter((function(t){return t.getViewerId()!==e}))},t.prototype.hideActiveRenderers=function(){this.activeRenderers.forEach((function(e){return e.hide()}))},t.prototype.showActiveRenderers=function(){this.activeRenderers.forEach((function(e){return e.show()}))},t.prototype.onReset=function(){this.activeRenderers.forEach((function(e){return e.reset()}))},t}(o)})),define("DS/SocialGlobeAPI/DisplayMode/DisplayModeFactory",["require","exports","DS/SocialGlobeAPI/PluginsSettings"],(function(e,t,o){"use strict";return function(){function e(){}return e.hasDisplayMode=function(e){return o.hasOwnProperty(e)},e.build=function(t,o,n){var r=e.getController(t,o,n);return r||!1},e.getController=function(t,n,r){if(!e.hasDisplayMode(t))return!1;var i=o[t];return new(0,i.controller)(n,i.defaultOpts,r)},e}()}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/Manager/MarkerManager",["require","exports","DS/SocialGlobeAPI/Core/Manager","DS/SocialGlobeAPI/Model/Marker"],(function(e,t,o,n){"use strict";return function(e){function t(t){return e.call(this,"marker",t)||this}return __extends(t,e),t.prototype.add=function(t){var o=new n(t);return o.addEvent("onChange:lat",this.update("position")),o.addEvent("onChange:lng",this.update("position")),o.addEvent("onChange:badge",this.update("badge")),o.addEvent("onChange:icon",this.update("icon")),o.addEvent("onChange:notification",this.update("notification")),o.addEvent("onChange:color",this.update("color")),e.prototype.addModel.call(this,o),o},t.prototype.getExtent=function(){var e=1/0,t=1/0,o=-1/0,n=-1/0;return this.dataModel.forEach((function(r){var i=r.getLatLng(),s=i[0],a=i[1];e=s<e?s:e,t=a<t?a:t,o=s>o?s:o,n=s>n?s:n})),[[e,t],[o,n]]},t.prototype.remove=function(t){t.removeEvent("onChange:lat"),t.removeEvent("onChange:lng"),t.removeEvent("onChange:badge"),t.removeEvent("onChange:icon"),t.removeEvent("onChange:notification"),t.removeEvent("onChange:color"),e.prototype.removeModel.call(this,t)},t}(o.default)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/DisplayMode/DisplayModeManager",["require","exports","DS/SocialGlobeAPI/DisplayMode/DisplayModeFactory","DS/SocialGlobeAPI/Core/Component"],(function(e,t,o,n){"use strict";return function(e){function t(t){var o=e.call(this,t)||this;return o.controller=null,o}return __extends(t,e),t.prototype.getModel=function(e){var t;return null===(t=this.controller)||void 0===t?void 0:t.getModel(e)},t.prototype.initController=function(e,t){var n=e.name,r=e.options;if(!o.hasDisplayMode(n))throw new Error("Display Exception: ".concat(n," doesn't exists"));this.disconnect(),this.controller=o.build(n,r,this.eventBus),this.controller.process(t)},t.prototype.initRenderers=function(e){var t=this;e.forEach((function(e){return t.controller.connect(e)}))},t.prototype.disconnect=function(){var e;null===(e=this.controller)||void 0===e||e.disconnect(),this.controller=null},t}(n)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/Core/StateManager",["require","exports","DS/SocialGlobeAPI/Manager/MarkerManager","DS/SocialGlobeAPI/Manager/LinkManager","DS/SocialGlobeAPI/Configuration","DS/SocialGlobeAPI/Core/Component"],(function(e,t,o,n,r,i){"use strict";return function(e){function t(t,r){var i=e.call(this,r)||this;return i.managers=new Map,i.batch=!1,i.onModelUpdate=i.onModelUpdate.bind(i),i.onLinkEdition=i.onLinkEdition.bind(i),i.getModel=i.getModel.bind(i),i.managers.set("marker",new o(i.onModelUpdate)),i.managers.set("link",new n(i.onModelUpdate)),i.displayMode="default",i.editMode="default",i.init(t),i.initListeners(),i}return __extends(t,e),t.prototype.initListeners=function(){this.eventBus.on(this.eventBus.events.viewer.edition.link,this.onLinkEdition)},t.prototype.init=function(e){},t.prototype.onLinkEdition=function(e){var t=e[0],o=e[1],n=this.addLink({origin:t,destination:o});this.eventBus.emit(this.eventBus.events.map.linkcreated,n)},t.prototype.setDisplayMode=function(e){var t=e.name,o="default"===t;this.getDataModel().forEach((function(e){return e.setEditable(!!o)})),o&&this.setDefaultDisplayMode(e.options),this.displayMode=t,this.eventBus.emit(this.eventBus.events.state.display,e)},t.prototype.setDefaultDisplayMode=function(e){var t={};e&&e.clustering?(t.clusteringOpts={},Object.assign(t.clusteringOpts,r.defaultValue.clusteringOpts,e.clusteringOpts),t.clustering=!0):t.clustering=!1,this.setClustering(t)},t.prototype.setClustering=function(e){!1===this.clustering&&!1===e.clustering||(e.clustering?this.eventBus.emit(this.eventBus.events.state.clustering,e.clusteringOpts):this.eventBus.emit(this.eventBus.events.state.clustering,e.clustering),this.clustering=e.clustering)},t.prototype.setEditMode=function(e){this.editMode=e,this.eventBus.emit(this.eventBus.events.state.edit,e)},t.prototype.getModel=function(e){var t=this.managers.get("marker"),o=this.managers.get("link");return t.hasFeature(e)?t.getFeature(e):o.hasFeature(e)?o.getFeature(e):null},t.prototype.reset=function(){this.managers.forEach((function(e){return e.reset()})),this.eventBus.emit(this.eventBus.events.state.reset,null)},t.prototype.getDataModel=function(){var e=[];return this.managers.forEach((function(t){e=e.concat(Array.from(t.dataModel,(function(e){e[0];return e[1]})))})),e},t.prototype.addMarker=function(e){var t=this.managers.get("marker").add(e);return!1===this.batch&&this.eventBus.emit(this.eventBus.root+"/marker/add",t),t},t.prototype.addLink=function(e){var t=this.managers.get("link").add(e);return!1===this.batch&&this.eventBus.emit(this.eventBus.root+"/link/add",t),t},t.prototype.startBatch=function(){this.batch=!0},t.prototype.sendBatch=function(){this.eventBus.emit(this.eventBus.events.state.batch,this.getDataModel()),this.batch=!1},t.prototype.removeMarker=function(e){e.isSelected()&&e.unSelect(),this.eventBus.emit(this.eventBus.root+"/marker/remove",e),this.managers.get("marker").remove(e)},t.prototype.removeLink=function(e){e.isSelected()&&e.unSelect(),this.eventBus.emit(this.eventBus.root+"/link/remove",e),this.managers.get("link").remove(e)},t.prototype.select=function(e){"object"==typeof e&&this.managers.forEach((function(t){t.dataModel.forEach((function(t){for(var o=0,n=Object.entries(e);o<n.length;o++){var r=n[o],i=r[0],s=r[1];t.getUserDatum(i)===s&&t.select()}}))}))},t.prototype.unSelect=function(e){"object"==typeof e&&this.managers.forEach((function(t){t.dataModel.forEach((function(t){for(var o=0,n=Object.entries(e);o<n.length;o++){var r=n[o],i=r[0],s=r[1];t.getUserDatum(i)===s&&t.unSelect()}}))}))},t.prototype.getState=function(){return{clustering:this.clustering}},t.prototype.isDefaultDisplay=function(){return"default"===this.displayMode},t.prototype.onModelUpdate=function(e,t){this.eventBus.emit(this.eventBus.root+"/".concat(t.getType(),"/update/").concat(e),t)},t}(i)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/SocialGlobeAPI/Core/Orchestrator",["require","exports","DS/SocialGlobeAPI/Configuration","DS/SocialGlobeAPI/Core/RendererManager","DS/SocialGlobeAPI/Renderer/RendererFactory","DS/SocialGlobeAPI/DisplayMode/DisplayModeManager","DS/SocialGlobeAPI/Viewer/LeafletViewer","DS/SocialGlobeAPI/Core/Component"],(function(e,t,o,n,r,i,s,a){"use strict";return function(e){function t(t,o){var r=e.call(this,o)||this;return r.stateManager=t,r.rendererManager=new n(o),r.displayModeManager=new i(o),r.viewers=new Map,r.onActivateRenderer=r.onActivateRenderer.bind(r),r.onDisplayChange=r.onDisplayChange.bind(r),r.onEditChange=r.onEditChange.bind(r),r.initListeners(),r}return __extends(t,e),t.prototype.initListeners=function(){this.eventBus.on(this.eventBus.events.renderer.activate,this.onActivateRenderer),this.eventBus.on(this.eventBus.events.state.display,this.onDisplayChange),this.eventBus.on(this.eventBus.events.state.edit,this.onEditChange)},t.prototype.getModel=function(e){return this.stateManager.isDefaultDisplay()?this.stateManager.getModel(e):this.displayModeManager.getModel(e)},t.prototype.addViewer=function(e){this.viewers.set(e.getId(),e),this.initializeRenderersForViewer(e)},t.prototype.getZoomLvl=function(e){var t=this.viewers.get(e);return t&&t.getZoomLvl()},t.prototype.getCenter=function(e){var t=this.viewers.get(e);return t&&t.getCenter()},t.prototype.getViewerExtent=function(e){var t=this.viewers.get(e);return t&&t.getExtent()},t.prototype.zoomIn=function(e){var t;return this.viewers.forEach((function(o){t=o.zoomIn(e)})),t},t.prototype.zoomOut=function(e){var t;return this.viewers.forEach((function(o){t=o.zoomOut(e)})),t},t.prototype.moveCamera=function(e,t,o){this.viewers.forEach((function(n){n.moveCamera(e,t,o)}))},t.prototype.fitBounds=function(e,t){this.viewers.forEach((function(o){o.fitBounds(e,t)}))},t.prototype.initializeRenderersForViewer=function(e){var t=this,n=o.viewers[e.getType()].renderers;Object.entries(n).forEach((function(o){var n=o[0];o[1].forEach((function(o){var i=r.createRenderer(o,e,t.stateManager.getState()),s=i.getRepresentationType();t.rendererManager.registerRenderer(e.getId(),n,i,s),"default"===s&&t.rendererManager.activateRenderer(e.getId(),n,s)}))}))},t.prototype.onActivateRenderer=function(e){var t=this.getDatamodel();e.loadDataModel(t)},t.prototype.onDisplayChange=function(e){"default"===e.name?(this.displayModeManager.disconnect(),this.rendererManager.showActiveRenderers()):(this.rendererManager.hideActiveRenderers(),this.displayModeManager.initController(e,this.stateManager.getDataModel()),this.displayModeManager.initRenderers(Array.from(this.viewers,(function(e){e[0];return e[1]}))))},t.prototype.onEditChange=function(e){var t=this;"default"===e?this.viewers.forEach((function(e){e instanceof s&&e.offDnDLink()})):"link"===e&&this.viewers.forEach((function(e){e instanceof s&&e.onDnDLink(t.stateManager.getModel)}))},t.prototype.getDatamodel=function(){return this.stateManager.getDataModel()},t}(a)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},__assign.apply(this,arguments)};var __awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function a(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},__generator=this&&this.__generator||function(e,t){var o,n,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(o)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(o=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{o=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},__spreadArray=(__rest=this&&this.__rest||function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(o[n[r]]=e[n[r]])}return o},this&&this.__spreadArray||function(e,t,o){if(o||2===arguments.length)for(var n,r=0,i=t.length;r<i;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))});define("DS/SocialGlobeAPI/GlobeAPI",["require","exports","DS/Web3DXCityFoundation/Geocoder","DS/SocialGlobeServices/MapNavigator/MapNavigatorServices","DS/SocialGlobeServices/Geocoding/GeocodingServices","DS/SocialGlobe/Utils","DS/SocialGlobeAPI/Manager/SelectionManager","DS/SocialGlobeAPI/Viewer/LeafletViewer","DS/SocialGlobeAPI/Model/Feature","DS/SocialGlobeAPI/Core/StateManager","DS/SocialGlobeAPI/Core/Orchestrator","DS/SocialGlobeAPI/Core/Event","DS/SocialGlobeAPI/Core/EventBus","DS/SocialGlobeAPI/Configuration","DS/SocialGlobeAPI/UI/PlusMinusButton/PlusMinusButton","DS/SocialGlobeAPI/Core/MapEventManager","css!DS/SocialGlobeAPI/style.css","css!DS/SocialGlobeAPI/leaflet.css"],(function(e,t,o,n,r,i,s,a,l,c,u,p,d,f,h,g){"use strict";var v,y;!function(e){e.Default="default",e.Clustering="clustering",e.Bubble="bubble"}(v||(v={})),function(e){e.Default="default",e.Link="link"}(y||(y={}));var m=function(e){function t(t,o,n,r,i){void 0===i&&(i={});var a=e.call(this)||this;return a.tmsUrl=n,a.appId=r,a._displayMode=v.Default,a._editMode=y.Default,a.tenantId=o,a.geocodingServiceUrl=i.geocodingServiceUrl||"",a.eventBus=new d,a.selectionManager=new s(a.getDispatcher("select"),a.getDispatcher("unselect"),a.eventBus),a.stateManager=new c(f.state,a.eventBus),a.orchestrator=new u(a.stateManager,a.eventBus),a.mapEvents=new g.default(a.eventBus),a.handleSelection=a.handleSelection.bind(a),a.getDispatcher=a.getDispatcher.bind(a),a.initListeners(),a.add2DViewer(t,i),a}return __extends(t,e),t.build=function(e,o){return __awaiter(this,arguments,void 0,(function(e,o,r){var s,a,l;return void 0===r&&(r={}),__generator(this,(function(c){return s=i.getAppId("MapComponentDefault"),a=function(e,t,o){return void 0===o&&(o="png"),"".concat(e,"{z}/{x}/{y}.").concat(o,"?tenant=").concat(t,"&appid=").concat(s)},l=null==r?void 0:r.tmsUrl,[2,n.retrieveMapUrl(o,s).then((function(i){return l=n.get2dTmsUrl(i,o),l=a(l,o),new t(e,o,l,s,r)})).catch((function(n){return console.error("GlobeAPI.ts: Error retrieving map url:",n),"string"==typeof l?(l=a(l,o,r.tmsExtension),new t(e,o,l,s,r)):new t(e,o,void 0,s,r)}))]}))}))},t.prototype.initListeners=function(){this.eventBus.on(this.eventBus.events.viewer.selection,this.handleSelection)},t.prototype.getDispatcher=function(e){var t=this;return function(){for(var o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];return t.dispatch.apply(t,__spreadArray([e],o,!1))}},t.prototype.handleSelection=function(e){var t=this.orchestrator.getModel(e);t?t.isSelected()?this.selectionManager.unSelectByClick(t.getType(),t):this.selectionManager.selectByClick(t.getType(),t):this.selectionManager.clearSelection()},t.prototype.add2DViewer=function(e,t){var o=new a(e,t,this.eventBus);o.onClick(this.getDispatcher("click")),this.tmsUrl&&o.addTileLayer(this.tmsUrl),this.orchestrator.addViewer(o),t.showControls&&new h({onPlus:function(){return o.zoomIn({animate:!0,duration:.5})},onMinus:function(){return o.zoomOut({animate:!0,duration:.5})}}).inject(document.getElementById(e))},t.prototype.addGeoJson=function(e){var t=this;if(!this.guard())return!1;var o=[];return this.reset(),this.stateManager.startBatch(),"FeatureCollection"===e.type?e.features.forEach((function(e){o.push(t.readGeoJson(e))})):o.push(this.readGeoJson(e)),this.stateManager.sendBatch(),o},t.prototype.readGeoJson=function(e){var t,o=e.properties,n=e.geometry;if("Point"===n.type){var r=n.coordinates,i=r[0],s=r[1],a=o.title,l=o.description,c=__rest(o,["title","description"]);t=this.addMarker(s,i,a,l,{properties:c})}return t},t.prototype.moveCamera=function(e,t,o){this.orchestrator.moveCamera(e,t,o)},t.prototype.fitBounds=function(e,t){this.orchestrator.fitBounds(e,t)},t.prototype.addMarker=function(e,t,o,n,r){if(this.guard())return this.stateManager.addMarker(__assign(__assign({},r),{lat:e,lng:t,title:o,desc:n}))},t.prototype.reset=function(){this.guard()&&(this.selectionManager.clearSelection(),this.stateManager.reset())},t.prototype.select=function(e){e instanceof l&&(e={id:e.getId()}),this.stateManager.select(e)},t.prototype.unselect=function(e){this.stateManager.unSelect(e)},t.prototype.getZoomLvl=function(e){return this.orchestrator.getZoomLvl(e)},t.prototype.getCenter=function(e){return this.orchestrator.getCenter(e)},t.prototype.getExtent=function(e){return this.orchestrator.getViewerExtent(e)},t.prototype.zoomIn=function(e){return this.orchestrator.zoomIn(e)},t.prototype.zoomOut=function(e){return this.orchestrator.zoomOut(e)},t.prototype.setOnSelectCallback=function(e){this.addEventListener("select",e)},t.prototype.unsetOnSelectCallback=function(e){this.removeListener("select",e)},t.prototype.setOnUnSelectCallback=function(e){this.addEventListener("unselect",e)},t.prototype.unsetOnUnSelectCallback=function(e){this.removeListener("unselect",e)},t.prototype.setOnClickCallback=function(e){this.addEventListener("click",e)},t.prototype.unsetClickCallback=function(e){this.removeListener("click",e)},t.prototype.addLink=function(e,t){if(this.guard()){var o=e[0],n=e[1],r=__assign({origin:o,destination:n},t);return this.stateManager.addLink(r)}},t.prototype.removeLink=function(e){this.guard()&&this.stateManager.removeLink(e)},t.prototype.removeMarker=function(e){this.guard()&&this.stateManager.removeMarker(e)},t.prototype._getGeocodingUrl=function(){var e=this;return r.retrieveGeocodingUrl(this.tenantId).then((function(t){if(""===t)return Promise.reject(new Error("Unable to retrieve Geocoding service URL."));e.geocodingServiceUrl=t+"/resources/geocoding"}))},t.prototype.getTypedGeocodingURL=function(e){return this.geocodingServiceUrl&&"".concat(this.geocodingServiceUrl,"/").concat(e,"?appid=").concat(this.appId)},t.prototype.geocoding=function(e,t){return __awaiter(this,void 0,void 0,(function(){var o,n,i=this;return __generator(this,(function(s){return o="search",n=function(e){return"string"==typeof e?r.geocoding(e,i.tenantId,i.getTypedGeocodingURL(o),t):r.stucturedGeocoding(e,i.tenantId,i.getTypedGeocodingURL(o))},this.geocodingServiceUrl?[2,n(e)]:[2,this._getGeocodingUrl().then((function(){return n(e)}))]}))}))},t.prototype.reverseGeocoding=function(e,t,o,n){return __awaiter(this,void 0,void 0,(function(){var i,s=this;return __generator(this,(function(a){return i="reverse",this.geocodingServiceUrl?[2,r.reverseGeocoding(e,t,o,n,this.tenantId,this.getTypedGeocodingURL(i))]:[2,this._getGeocodingUrl().then((function(){return r.reverseGeocoding(e,t,o,n,s.tenantId,s.getTypedGeocodingURL(i))}))]}))}))},t.prototype._loadProj=function(e){return new Promise((function(t){o.loadProjection(e,t)}))},t.prototype.proj=function(e,t,n,r){var i=this._loadProj(t),s=this._loadProj(n);return Promise.all([i,s]).then((function(){return o.proj(e,t,n,r)}))},t.prototype.setEditMode=function(e){void 0===e&&(e="default"),this.stateManager.setEditMode(e)},t.prototype.display=function(e,t){if(void 0===e&&(e="default"),!f.displayModes.includes(e))throw new Error("GlobeAPI: Bad display name: ".concat(e));var o={name:e,options:t};this.selectionManager.clearSelection(),this.stateManager.setDisplayMode(o),this._displayMode=e},t.prototype.guard=function(){return this._displayMode===v.Default&&this._editMode===y.Default},t}(p.default);return m}));