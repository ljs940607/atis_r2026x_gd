define("DS/ENOXVersionExplorerController/CreateNewVersionController",["UWA/Core","UWA/Controls/Abstract","DS/ENOXVersionExplorerViews/NewVersionDialog","DS/ENOXVersionExplorerViews/NewRevisionDialog","DS/ENOXVersionExplorerModelManager/ModelManagerBase","DS/ENOXVersionExplorerModel/VersionTreeDocumentModel","DS/LifecycleCmd/MessageMediator","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","UWA/Promise","DS/ENOXVersionExplorerModelManager/ModelManagerP","DS/ENOXVersionExplorerModelManager/ModelManagerHistory2","DS/ENOXVersionExplorerModelManager/ModelManagerRDF","DS/ENOXVersionExplorerUtils/ENOXVersionExplorerUtils"],(function(e,t,n,i,o,r,s,a,d,l,c,u,p){"use strict";return t.extend({init:function(t){t=t||{};var E=this,f=void 0,h=void 0;E=this;function v(e,t){if("string"==typeof t&&t.length&&e!==a.DATA_MODEL_TYPES.MODEL_HISTORY&&(e=a.DATA_MODEL_TYPES[t.contains(":")?"MODEL_RDF":"MODEL_REVISION"]),e&&f._DATA_MODEL_TYPE!==e){switch(f._DATA_MODEL_TYPE=e,f._DATA_MODEL_TYPE){case a.DATA_MODEL_TYPES.MODEL_RDF:h=u;break;case a.DATA_MODEL_TYPES.MODEL_HISTORY:h=c;break;default:h=l}f.setManager(h)}}function _(e){E.dispatchEvent("ENOXVersionExplorerError",e)}function x(e){f.createNewVersionPromise({parentid:e.parent.options.id,title:e.title,description:e.description,versionSemantic:e.versionSemantic,nextRevision:e.parent.nextRevision,itemID:f.itemID,loadThumbnail:!1}).then((function(e){s.dispatchEvent("_ENOXVersionExplorerNewVersionCreated",e),E.dispatchEvent("ENOXVersionExplorerNewVersionCreated",e)}),_)}t=e.extend({newVersionDialogContainer:null},t),this._parent(t),f=new(r.implement(o));var m=e.Class.extend({showDialog:function(e){if("string"!=typeof e.parentID||!e.parentID.length)throw Error("CreateNewVersionController:showDialog: parentPhysical ID cannot be null");v(e.dataModelType,e.type),f.loadVersionModelPromise({id:e.parentID,loadThumbnail:!1,tenantId:e.tenantId,securityContext:e.securityContext}).then((function(){var o=f.searchByID(e.parentID);if(o.length>1)throw Error("CreateNewVersionController:showDialog: more than one node with same ID");if(!o.length)throw Error("CreateNewVersionController:showDialog: Parent ID not found");f._DATA_MODEL_TYPE===a.DATA_MODEL_TYPES.MODEL_REVISION?function(e){var n=e.parentTreeNode;if(!n)throw Error("CreateNewVersionController:_displayNewRevisionDialog parent tree node is null");i.displayDialog({defaultName:n.options.grid.title,derivedFrom:{id:n.options.id,name:n.options.grid.title+" "+n.options.grid.code},nextRevision:p.getNextRevision(n.options.grid.code.split(".")[0])+".1",parentContainer:t.newVersionDialogContainer,onOK:function(e,t){x({title:e,description:t,parent:n,versionSemantic:"E"})}})}({parentTreeNode:o[0]}):function(e){var i=e.parentTreeNode;if(!i)throw Error("CreateNewVersionController:_displayNewversionDialog parent tree node is null");n.displayDialog({dataModelType:f._DATA_MODEL_TYPE,defaultName:f.getNewVersionName(),derivedFrom:{id:i.options.id,name:i.options.grid.title},parentContainer:t.newVersionDialogContainer,onOK:function(e,t,n){x({title:e,description:t,parent:i,nextRevision:p.getNextRevision(i.options.grid.code.split(".")[0])+".1",versionSemantic:n})}})}({parentTreeNode:o[0]})}),_)},canNewVersionBeCreatedPromise:function(e){if("string"!=typeof e.parentID||!e.parentID.length)throw Error("CreateNewVersionController:canNewVersionBeCreatedPromise: parentPhysical ID cannot be null");return v(e.dataModelType,e.type),new d((function(t,n){f.loadVersionModelPromise({id:e.parentID,loadThumbnail:!1,tenantId:e.tenantId,securityContext:e.securityContext}).then((function(){var n=f.searchByID(e.parentID);if(n.length>1)throw Error("CreateNewVersionController:showDialog: more than one node with same ID");if(!n.length)throw Error("CreateNewVersionController:showDialog: Parent ID not found");t(n[0].isLeaf())}),n)}))}});e.Class.implement.call(this,m)}})})),define("DS/ENOXVersionExplorerController/VersionExplorerEventList",["UWA/Core","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/ENOXVersionExplorerModel/VersionTreeNodeModel","DS/ENOXVersionExplorerViews/NodeDropdownMenu","DS/WebappsUtils/WebappsUtils","DS/LifecycleCmd/CommandAPI","DS/LifecycleServices/LifecycleCommandManager","i18n!DS/ENOXVersionExplorerController/assets/nls/NodeDropdownMenuNLS","css!DS/ENOXVersionExplorerController/styles/VersionExplorerEventList"],(function(e,t,n,i,o,r,s,a,d,l){"use strict";var c=function(e,t){return"url("+r.getWebappsBaseUrl()+(t||"RevisionFamily")+"/assets/icons/32/"+e+")"};return function(r,l){function u(t){var n,o,r,s;t instanceof i?(o=t,n={position:{x:0,y:0},selectedNodes:[]}):o=(n=t.menuctx).treeNode,void 0!==o.options&&void 0!==o.options.label&&void 0!==o.options.label&&(s=e.String.unescapeHTML(o.options.label));var a=o.options.data.type;void 0!==a&&0!=a.length||(a=o.options.grid.type);var d=o.options.grid&&o.options.grid.contents&&o.options.grid.contents.length>0?o.options.grid.contents[0].id:o.options.id,c=void 0;return"xRevisionElement"===o.options.grid.type&&l.options.versionExplorerController&&l.options.versionExplorerController._revisionFamily&&(c={revisionMode:l.options.versionExplorerController.revisionMode,graphProprietary:l.options.versionExplorerController.graphProprietary,originalEBProduct:l.options.versionExplorerController._revisionFamily.originalEBProduct}),r={physicalid:d,id:d,displayName:s,revision:o.options.grid.code,type:a,pos:[n.position.x,n.position.y],selectedNodes:n.selectedNodes,name:s,revisionModeInfo:c},t.menuctx=void 0,r}this._eventList=[{id:"ENOXVersionExplorerSetActiveVersion",subscribed:!0,published:!1,externalsub:!0,externalpub:!1,subfn:function(e){var t=this,n=e.data||e,o={};n instanceof i?o.treeNode=n:o.id=n&&"string"==typeof n.id?n.id:"string"==typeof n?n:void 0,o.treeNode||o.id||(o.id=t._activeVersion||t._currentVersion),o.id&&t._setActiveVersion(o)}},{id:"ENOXVersionExplorerLoadVersionModel",subscribed:!0,externalsub:!0,onComplete:!0,subfn:function(t){var n=this,i=t&&(t.data||t)||{};if(!("string"==typeof i.id&&i.id.length||"object"==typeof i.id&&null!==i.id))throw Error("ENOXVersionExplorerLoadVersionModel:id <physicalid> cannot be null");var o=i&&"function"==typeof i.onComplete?function(e){i.onComplete(e),n.publishEvent("ENOXVersionExplorerLoadCompleted",e)}:function(e){n.publishEvent("ENOXVersionExplorerLoadCompleted",e)};n._loadVersionModel(e.merge({reframe:!0,onComplete:o},i))}},{id:"ENOXVersionExplorerLoadCompleted",published:!0,externalpub:!0,subscribed:!0,subfn:function(e){null==this.commandManager&&(this.commandManager=new a,this.commandManager.addEvent("onCompleteGetOptions",(function(e){for(var t=!1,n=0;n<e.options.length;++n){var i=e.options[n];if(i.hasOwnProperty("newRevisionFromOldRevisionAllowed")){this._REVISION_FROM_NON_LEAF_ALLOWED=i.newRevisionFromOldRevisionAllowed,t=!0;break}}!1===t&&(this._REVISION_FROM_NON_LEAF_ALLOWED=!0)}),this));try{var t={data:[{physicalid:e.id}],command:"revise"};void 0===this.tenant&&void 0!==e&&(this.tenant=e.tenantId),this.commandManager.setTenant(this.tenant),this.commandManager.getOptions(t,(function(e){}),this._context)}finally{}}},{id:"ENOXVersionExplorerRefresh",subscribed:!0,published:!1,externalsub:!0,externalpub:!1,onComplete:!0,subfn:function(t){var n=this,i=t&&(t.data||t)||{};if(i.id=i.id||n._currentVersion,i.tenantId=i.tenantId||n._tenantId,i.context=i.context||n._context,i.type=i.type||n._type,i.dataModelType=i.dataModelType||r._DATA_MODEL_TYPE,"portfolio"===i.applicationName&&!0===i.forcereload&&(r.itemID=null),!("string"==typeof i.id&&i.id.length||"object"==typeof i.id&&null!==i.id))throw Error("ENOXVersionExplorerRefresh:id <physicalid> cannot be null");var o=i&&"function"==typeof i.onComplete?function(e){i.onComplete(e),n.publishEvent("ENOXVersionExplorerLoadCompleted",e)}:function(e){n.publishEvent("ENOXVersionExplorerLoadCompleted",e)};n._loadVersionModel(e.merge({reframe:!0,onComplete:o},i))}},{id:"ENOXVersionExplorerThumbnailGraphLayoutChanged",published:!0,externalsub:!1,externalpub:!0},{id:"ENOXVersionExplorerOpenVersion",externalpub:!0,published:!0},{id:"preENOXVersionExplorerNewRevisionFrom",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerNewRevisionFrom",subfn:function(e){this.publishEvent("preEventCompletedENOXVersionExplorerNewRevisionFrom",e)},allowPreventDefault:!0},{id:"preEventCompletedENOXVersionExplorerNewRevisionFrom",subscribed:!0,externalsub:!1,subfn:function(e){var n=this,o=e.data||e;if(r._DATA_MODEL_TYPE===t.DATA_MODEL_TYPES.MODEL_RDF){var a={};o instanceof i?a.treeNode=o:a.id=o&&"string"==typeof o.id?o.id:"string"==typeof o?o:void 0,n._displayNewRevisionDialog(a)}else window.widget.options||(window.widget.options={}),window.widget.options._pruneHash=r._pruneHash,window.widget.options._branchColorHash=r._branchColorHash,s.runCommand("ReviseFromHdr",[u(o)],n._widget,n._context)}},{id:"preENOXVersionExplorerCompareToSelected",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerCompareToSelected",subfn:function(e){this.publishEvent("preEventCompletedENOXVersionExplorerCompareToSelected",e)},allowPreventDefault:!0},{id:"preENOXVersionExplorerMergeIntoSelected",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerMergeIntoSelected",subfn:function(e){this.publishEvent("preEventCompletedENOXVersionExplorerMergeIntoSelected",e)},allowPreventDefault:!0},{id:"preENOXVersionExplorerCompareWithBranchOrigin",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerCompareWithBranchOrigin",subfn:function(e){this.publishEvent("preEventCompletedENOXVersionExplorerCompareWithBranchOrigin",e)},allowPreventDefault:!0},{id:"preENOXVersionExplorerViewRevisionsOfRoot",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerViewRevisionsOfRoot",subfn:function(e){this.publishEvent("preEventCompletedENOXVersionExplorerViewRevisionsOfRoot",e)},allowPreventDefault:!0},{id:"preENOXVersionExplorerSetPruneModeUp",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerSetPruneMode",subfn:function(e){e.pruneMode="up";this.publishEvent("preEventCompletedENOXVersionExplorerSetPruneMode",e)},allowPreventDefault:!0},{id:"preENOXVersionExplorerSetPruneModeDown",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerSetPruneMode",subfn:function(e){e.pruneMode="down";this.publishEvent("preEventCompletedENOXVersionExplorerSetPruneMode",e)},allowPreventDefault:!0},{id:"preENOXVersionExplorerSetPruneModeNone",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerSetPruneMode",subfn:function(e){e.pruneMode="none";this.publishEvent("preEventCompletedENOXVersionExplorerSetPruneMode",e)},allowPreventDefault:!0},{id:"preENOXVersionExplorerSetPruneModeNoneAncestors",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerSetPruneMode",subfn:function(e){e.pruneMode="none";this.publishEvent("preEventCompletedENOXVersionExplorerSetPruneMode",e)},allowPreventDefault:!0},{id:"preENOXVersionExplorerSetPruneModeNoneDescendants",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerSetPruneMode",subfn:function(e){e.pruneMode="none";this.publishEvent("preEventCompletedENOXVersionExplorerSetPruneMode",e)},allowPreventDefault:!0},{id:"preEventCompletedENOXVersionExplorerSetPruneMode",subscribed:!0,externalsub:!1,subfn:function(e){var t=e.__SUBWAYGRAPHNODE__;t&&t.view&&t.view.display.elt.onmousedown({pruneMode:e.pruneMode})}},{id:"preEventCompletedENOXVersionExplorerCompareToSelected",subscribed:!0,externalsub:!1,subfn:function(e){for(var t,n,i,o,r,s=e.data||e,a=s.options.data.id,d=s.options.data.contextId,l=s.options.data.serviceId,c=s.options.data.type,u=s.options.data.displayName,p=this.getSelectedNodes(),E=0;E<p.length;E++){var f=p[E];if(f._options.id!==a){t=f._options.id,n=f._options.data.contextId,i=f._options.data.serviceId,o=f._options.data.type,r=f._options.data.displayName;break}}this._showCompare({id:a,contextId:d,serviceId:l,objectType:c,displayName:u},{id:t,contextId:n,serviceId:i,objectType:o,displayName:r})}},{id:"preEventCompletedENOXVersionExplorerMergeIntoSelected",subscribed:!0,externalsub:!1,subfn:function(e){for(var t=this,n=e.data||e,i=u(n),o=n.options.data.id,r=null,a=t.getSelectedNodes(),d=0;d<a.length;d++){var l=a[d];if(l._options.id!==o){r=u(l);break}}s.runCommand("MergeHdr",[r,i],t._widget,t._context)}},{id:"preEventCompletedENOXVersionExplorerCompareWithBranchOrigin",subscribed:!0,externalsub:!1,subfn:function(e){var t,n,i,o,r=e.data||e,s=r.options.data.id,a=r.options.data.contextId,d=r.options.data.serviceId,l=r.options.data.type,c=r.options.data.displayName;if(e.options&&e.options.ancestors){var u=e.options.ancestors.find((function(e){return e.filterid&&e.hasExpand}));if(!u&&e.__BRANCH__&&e.__BRANCH__.nodeList[0].options.ancestors&&(u=e.__BRANCH__.nodeList[0].options.ancestors.find((function(e){return e.filterid&&e.hasExpand}))),u){t=u.id,n=a,i=d,o=l,void 0;var p=this.getFilter({id:s,contextId:a,serviceId:d,objectType:l,displayName:c});if(p&&p.referencedObject){var E=p.referencedObject;if(E.identifier!==t){E.identifier=t;var f=E.relativePath.substring(0,E.relativePath.length-32);if(f+=t,E.relativePath=f,p.filter&&p.filter.filterSpecifications){var h=p.filter.filterSpecifications;for(var v of h){var _=v.filterCriteria;for(var x of _)if("context"===x.criteriaType){var m=x.excludedNodesList;m&&(x.excludedNodesList=m.filter((e=>e.indexOf(t)>-1)).map((e=>e.slice(e.indexOf(t)))));var b=x.addedNodesList;b&&(x.addedNodesList=b.filter((e=>e.indexOf(t)>-1)).map((e=>e.slice(e.indexOf(t)))))}}}}}this._showCompare({id:s,contextId:a,serviceId:d,objectType:l,displayName:c,filter:undefined},{id:t,contextId:n,serviceId:i,objectType:o,displayName:undefined,filter:p})}}}},{id:"preEventCompletedENOXVersionExplorerViewRevisionsOfRoot",subscribed:!0,externalsub:!1,subfn:function(e){var t=this,n=e.options.ancestors.find((function(e){return e.rootPid})).rootPid;t._currentVersion=n,r._circularColorArray.resetCurrentIndex(),r._forceReset=!0,r.items=null;var i=t.subscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",(function(e){t.unsubscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",i),t.resetFilter(),t.select(n)}));t.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:!0})}},{id:"preENOXVersionExplorerDownload",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerDownload",subfn:function(e){this.publishEvent("preEventCompletedENOXVersionExplorerDownload",e)},allowPreventDefault:!0},{id:"preEventCompletedENOXVersionExplorerDownload",subscribed:!0,externalsub:!1,subfn:function(e){var t=e.data||e;s.runCommand("DownloadHdr",[u(t)],this._widget,this._context)}},{id:"preENOXVersionExplorerPreview",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerPreview",subfn:function(e){this.publishEvent("preEventCompletedENOXVersionExplorerPreview",e)},allowPreventDefault:!0},{id:"preEventCompletedENOXVersionExplorerPreview",subscribed:!0,externalsub:!1,subfn:function(e){var t=e.data||e;s.runCommand("PreviewHdr",[u(t)],this._widget,this._context)}},{id:"preENOXVersionExplorerWhereUsed",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerWhereUse",subfn:function(e){this.publishEvent("preEventCompletedENOXVersionExplorerWhereUse",e)},allowPreventDefault:!0},{id:"preEventCompletedENOXVersionExplorerWhereUse",subscribed:!0,externalsub:!1,subfn:function(e){var t=e.data||e,n=t.options.data.id,i=t.options.data.type,o=t.options.data.displayName,r=t.options.data.contextId,s=t.options.data.serviceId;this._showWhereUsed({id:n,type:i,displayName:o,contextId:r,serviceId:s})}},{id:"preENOXVersionExplorerCreateNewVersion",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerCreateNewVersion",subfn:function(e){this.publishEvent("preEventCompletedENOXVersionExplorerCreateNewVersion",e)},allowPreventDefault:!0},{id:"preEventCompletedENOXVersionExplorerCreateNewVersion",subscribed:!0,externalsub:!1,subfn:function(e){var n=this,o=e.data||e;if(r._DATA_MODEL_TYPE===t.DATA_MODEL_TYPES.MODEL_RDF){var a={};o instanceof i?a.treeNode=o:a.id=o&&"string"==typeof o.id?o.id:"string"==typeof o?o:void 0,n._displayNewRevisionDialog(a)}else s.runCommand("RevisionHdr",[u(o)],n._widget,n._context)}},{id:"ENOXVersionExplorerNewVersionCreated",published:!0,externalpub:!0,subscribed:!0,subfn:function(e){var n=e.data||e;if(l._getActiveView()===t.DISPLAY_MODES.THUMBNAIL_VIEW&&l._thumbnailGraphView){var i=[];i.push(n),n.getParent()&&i.push(n.getParent()),l._thumbnailGraphView.reframeOn(i)}}},{id:"preENOXVersionExplorerCreateNewBranch",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerCreateNewBranch",subfn:function(e){this.publishEvent("preEventCompletedENOXVersionExplorerCreateNewBranch",e)},allowPreventDefault:!0},{id:"preEventCompletedENOXVersionExplorerCreateNewBranch",subscribed:!0,externalsub:!1,subfn:function(e){var n=this,o=e.data||e;if(r._DATA_MODEL_TYPE===t.DATA_MODEL_TYPES.MODEL_RDF){var a={};o instanceof i?a.treeNode=o:a.id=o&&"string"==typeof o.id?o.id:"string"==typeof o?o:void 0,n._displayNewVersionDialog(a)}else s.runCommand("NewBranchHdr",[u(o)],n._widget,n._context)}},{id:"preENOXVersionExplorerEditBranchTitle",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerEditBranchTitle",subfn:function(e){this.publishEvent("preEventCompletedENOXVersionExplorerEditBranchTitle",e)},allowPreventDefault:!0},{id:"preEventCompletedENOXVersionExplorerEditBranchTitle",published:!0,externalsub:!1,subfn:function(e){var t=e.data||e,n=t.options.data.id,i=t.options.data.displayName,o="";e.options&&e.options.ancestors&&(o=e.options.ancestors[0].title),this._displayEditDialog(n,i,o)},allowPreventDefault:!0},{id:"preENOXVersionExplorerCreateDuplicate",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerCreateDuplicate",subfn:function(e){this.publishEvent("preEventCompletedENOXVersionExplorerCreateDuplicate",e)},allowPreventDefault:!0},{id:"preEventCompletedENOXVersionExplorerCreateDuplicate",subscribed:!0,externalsub:!1,subfn:function(e){var n=this,o=e.data||e;if(r._DATA_MODEL_TYPE===t.DATA_MODEL_TYPES.MODEL_RDF){var a={};o instanceof i?a.treeNode=o:a.id=o&&"string"==typeof o.id?o.id:"string"==typeof o?o:void 0,n._displayNewVersionDialog(a)}else s.runCommand("DuplicateHdr",[u(o)],n._widget,n._context)}},{id:"preENOXVersionExplorerDeleteVersion",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerDeleteVersion",subfn:function(e){r._forceLoadTree=!0,this.publishEvent("preEventCompletedENOXVersionExplorerDeleteVersion",e)},allowPreventDefault:!0},{id:"preEventCompletedENOXVersionExplorerDeleteVersion",subscribed:!0,externalsub:!1,subfn:function(e){var t=e.data||e;s.runCommand("DeleteHdr",[u(t)],this._widget,this._context)}},{id:"ENOXVersionExplorerVersionDeleteCompleted",published:!0,externalpub:!0},{id:"preEventENOXVersionExplorerShowMaturity",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerShowMaturity",subfn:function(e){this.publishEvent("preEventCompletedENOXVersionExplorerShowMaturity",e)},allowPreventDefault:!0},{id:"preEventENOXVersionExplorerOpenWith",published:!0,externalpub:!0,onCompleteEvent:"preEventCompletedENOXVersionExplorerOpenWith",subfn:function(e){this.publishEvent("preEventCompletedENOXVersionExplorerOpenWith",e)},allowPreventDefault:!0},{id:"preEventCompletedENOXVersionExplorerShowMaturity",published:!0,externalpub:!0,subscribed:!0,externalsub:!1,allowPreventDefault:!0,subfn:function(e){var t=e.data||e;s.runCommand("MaturityHdr",[u(t)],this._widget,this._context)}},{id:"ENOXVersionExplorerDoubleClickVersion",published:!0,externalpub:!0},{id:"ENOXVersionExplorerError",published:!0,externalpub:!0},{id:"ENOXVersionExplorerCompare",published:!0,externalpub:!0,subscribed:!1,externalsub:!1},{id:"select",published:!0,externalpub:!0,subscribed:!0,subfn:function(e){void 0!==l._highlightParents&&l._highlightParents(e.data.nodeModel)},externalsub:!0,noPubFn:!0},{id:"unselect",published:!0,externalpub:!0,subscribed:!0,subfn:function(e){void 0!==l._unhighlightParents&&l._unhighlightParents(e.data.nodeModel)},externalsub:!0,noPubFn:!0},{id:"ENOXVersionExplorerVersionModified",published:!0,externalpub:!0},{id:"ENOXVersionExplorerVersionOwnerChanged",published:!0,externalpub:!0},{id:"ENOXVersionExplorerDisplayProperties",published:!0,externalpub:!0,subscribed:!0,externalsub:!1,allowPreventDefault:!0,subfn:function(e){var t=e.data||e;s.runCommand("Properties",[u(t)],this._widget,this._context)}},{id:"ENOXVersionExplorerModalOK",published:!0,externalpub:!0},{id:"ENOXVersionExplorerModalCancel",published:!0,externalpub:!0},{id:"ENOXVersionExplorerDropdownMenu",published:!0,externalpub:!1,subscribed:!0,externalsub:!1,subfn:function(e){var t=e.data||e,n=this;if(n._isWebInWinMode()){var i=t.treeNode.options.grid.type,r=t.treeNode.options.grid.name,s=t.treeNode.options.grid.code,a=t.treeNode.options.grid.id;n._getWebInWinSocket().contextCallback=function(e){n._getNodeDropdownMenuListPromise(t.treeNode).then((function(e){t.menuList=e,o.displayNodeDropdownMenu.bind(n)(t)}))},n._fetchNativeContextMenu(a,i,r,s)}else n._getNodeDropdownMenuListPromise(t.treeNode).then((function(e){t.menuList=e,o.displayNodeDropdownMenu.bind(n)(t)}))},allowPreventDefault:!0},{id:"ENOXVersionExplorerOnDrag",published:!0,externalpub:!1,subscribed:!0,externalsub:!1,subfn:function(e){var t=e.data||e,n=this;n._getNodeDropdownMenuListPromise(t.treeNode).then((function(e){t.menuList=e,o.displayNodeDropdownMenu.bind(n)(t)}))},allowPreventDefault:!0},{id:"ENOXVersionExplorerOnDrop",published:!0,externalpub:!1,subscribed:!0,externalsub:!1,subfn:function(e){var t=e.data||e,n=this;n._getNodeDropdownMenuListPromise(t.treeNode).then((function(e){t.menuList=e,o.displayNodeDropdownMenu.bind(n)(t)}))},allowPreventDefault:!0},{id:"_ENOXVersionExplorerInternalRefresh",published:!0,subscribed:!0,externalpub:!1,externalsub:!1,subfn:function(t){var n=this;if(!("string"==typeof n._currentVersion&&n._currentVersion.length||"object"==typeof n._currentVersion&&null!==n._currentVersion))throw Error("_ENOXVersionExplorerInternalRefresh: _versionExplorerController._currentVersion is not defined");n._loadVersionModel(e.extend({id:n._currentVersion,tenantId:n._tenantId,securityContext:n._securityContext,context:n._context,type:n._type,dataModelType:r._DATA_MODEL_TYPE,onComplete:function(e){n.publishEvent("_ENOXVersionExplorerInternalRefreshCompleted",e)}},t))}},{id:"_ENOXVersionExplorerLaunchFilterSpecification",published:!0,externalpub:!0,subscribed:!0,externalsub:!1,allowPreventDefault:!0,subfn:function(e){e.data}},{id:"_ENOXVersionExplorerUpdatePruneState",published:!0,externalpub:!0,subscribed:!0,externalsub:!1,allowPreventDefault:!0,subfn:function(e){var t=e.data||e,n=this,i=function(e,t,n,i){Object.keys(r._pruneHash).map((function(o){(r._pruneHash[o].branchId!=e&&"down"!=t||r._pruneHash[o].pruneMode!=t)&&(r._pruneHash[o].branchId!=e&&"down"!=n||r._pruneHash[o].pruneMode!=n)&&(r._pruneHash[o].branchId!=e&&"down"!=i||r._pruneHash[o].pruneMode!=i)||delete r._pruneHash[o]}))},o=void 0,s=r._pruneHash[t[0].id];s&&(o=s.pruneMode),"up"==t[0].pruneMode?"down"==o?i(t[0].branchId,"up","out","down"):i(t[0].branchId,"up","out"):"down"==t[0].pruneMode?"up"==o?i(t[0].branchId,"up","out","down"):i(t[0].branchId,"down"):"none"==t[0].pruneMode&&("up"==o?i(t[0].branchId,"up","out"):"down"==o&&i(t[0].branchId,"down"));for(var a=0;a<t.length;a++)"none"==t[a].pruneMode?delete r._pruneHash[t[a].id]:"up"==t[a].pruneMode?r._pruneHash[t[a].id]={pruneMode:"up",branchId:t[a].branchId}:"out"==t[a].pruneMode?r._pruneHash[t[a].id]={pruneMode:"out",branchId:t[a].branchId}:"down"==t[a].pruneMode&&(r._pruneHash[t[a].id]={pruneMode:"down",branchId:t[a].branchId});r._forceLoadTree=!0,n.publishEvent("_ENOXVersionExplorerInternalRefresh",{refresh:!0});var d=n.subscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",(function(e){n.unsubscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",d),n.resetFilter()}),!1)}},{id:"_ENOXVersionExplorerInternalRefreshCompleted",published:!0,externalpub:!1,subscribed:!0,externalsub:!1},{id:"_ENOXVersionExplorerSelectionModeChanged",published:!0,externalpub:!1,subscribed:!0,externalsub:!1},{id:"_ENOXVersionExplorerManageMultiSelect",published:!0,externalpub:!1,subscribed:!0,externalsub:!1},{id:"_ENOXVersionExplorerNoActions",published:!1,externalpub:!1,pubfn:function(){}},{id:"_ENOXVersionExplorerViewChanged",published:!0,externalpub:!1,subfn:function(e){r._loadThumbnailsAsync()}}],this._menuList=[{id:"ENOXVersionExplorerOpenVersion",event:"ENOXVersionExplorerOpenVersion",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open",family:WUXManagedFontIcons.Font3DS},text:d.open,userAccess:["read","write"],checkVersion:function(e){return!e.isxRev()&&!e.isMIB()&&!e.isActive()},nodeDropdown:!0},{id:"ENOXVersionExplorerOpenWith",event:"preEventENOXVersionExplorerOpenWith",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-menu-dot",family:WUXManagedFontIcons.Font3DS},icon:c("I_OpenWith.png","ENXNav"),text:d.openWith,userAccess:["read","write"],checkVersion:function(e){return!1},nodeDropdown:!0},{id:"ENOXVersionExplorerPreview",event:"preENOXVersionExplorerPreview",fonticon:{content:"fonticon fonticon-2x fonticon-eye",family:WUXManagedFontIcons.Font3DS},text:d.preview,checkAccess:["read","write"],checkVersion:function(e){return s.checkAvailability("PreviewHdr",[u(e)],this._widget,this._context)},nodeDropdown:!0},{id:"divider"},{id:"ENOXVersionExplorerCreateNewRevision",event:"preENOXVersionExplorerCreateNewVersion",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-line-add",family:WUXManagedFontIcons.Font3DS},icon:s.getIconPath("RevisionHdr"),text:s.getTitle("RevisionHdr"),checkAccess:["read","write"],checkVersion:function(e){var i=this;return!i.isEffectivityBasedReused()&&(!0===n.X_DESIGN||r._DATA_MODEL_TYPE===t.DATA_MODEL_TYPES.MODEL_RDF||null!=i._REVISION_FROM_NON_LEAF_ALLOWED&&((e.isLeaf()||!0===i._REVISION_FROM_NON_LEAF_ALLOWED)&&s.checkAvailability("RevisionHdr",[u(e)],i._widget,i._context)))},nodeDropdown:!0},{id:"ENOXVersionExplorerNewRevisionFrom",event:"preENOXVersionExplorerNewRevisionFrom",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-branch-add wux-ui-3ds-flip-vertical version-explorer-noflip-border",family:WUXManagedFontIcons.Font3DS},icon:s.getIconPath("ReviseFromHdr"),text:s.getTitle("ReviseFromHdr"),checkAccess:["read","write"],checkVersion:function(e){return!e.isxRev()&&!e.isMIB()&&s.checkAvailability("ReviseFromHdr",[u(e)],this._widget,this._context)},nodeDropdown:!0},{id:"ENOXVersionExplorerCreateNewBranch",event:"preENOXVersionExplorerCreateNewBranch",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-branch-add",family:WUXManagedFontIcons.Font3DS},icon:s.getIconPath("NewBranchHdr"),text:s.getTitle("NewBranchHdr"),checkAccess:["read","write"],checkVersion:function(e){var i=this,o=!0===n.X_DESIGN||r._DATA_MODEL_TYPE===t.DATA_MODEL_TYPES.MODEL_RDF||s.checkAvailability("NewBranchHdr",[u(e)],i._widget,i._context);return!i.isEffectivityBasedReused()&&o},nodeDropdown:!0},{id:"ENOXVersionExplorerCompareWithBranchOrigin",event:"preENOXVersionExplorerCompareWithBranchOrigin",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-part-compare",family:WUXManagedFontIcons.Font3DS},icon:c("I_Compare.png"),text:d.compareWithBranchOrigin,checkAccess:["read","write"],checkVersion:function(e){return!!(e.__BRANCH__&&e.__BRANCH__.nodeList[0].options.ancestors&&e.__BRANCH__.nodeList[0].options.ancestors.find((function(e){return e.filterid&&e.hasExpand})))},nodeDropdown:!0},{id:"ENOXVersionExplorerViewRevisionsOfRoot",event:"preENOXVersionExplorerViewRevisionsOfRoot",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-branch-list",family:WUXManagedFontIcons.Font3DS},text:d.viewRevisionsOfRoot,checkAccess:["read","write"],checkVersion:function(e){return!!(e.__BRANCH__&&e.__BRANCH__.nodeList[0].options.ancestors&&e.__BRANCH__.nodeList[0].options.ancestors.find((function(e){return e.rootPid})))},nodeDropdown:!0},{id:"ENOXVersionExplorerEditBranchTitle",event:"preENOXVersionExplorerEditBranchTitle",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-pencil",family:WUXManagedFontIcons.Font3DS},text:d.editBranchTitle,checkAccess:["read","write"],checkVersion:function(e){return!!(e.isMIB()&&e.__BRANCH__&&e.__BRANCH__.nodeList[0].options.ancestors)},nodeDropdown:!0},{id:"ENOXVersionExplorerDuplicate",event:"preENOXVersionExplorerCreateDuplicate",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-duplicate",family:WUXManagedFontIcons.Font3DS},icon:s.getIconPath("DuplicateHdr"),text:s.getTitle("DuplicateHdr"),checkAccess:["read","write"],checkVersion:function(e){return!e.isxRev()&&!e.isMIB()&&s.checkAvailability("DuplicateHdr",[u(e)],this._widget,this._context)},nodeDropdown:!0},{id:"ENOXVersionExplorerCompareToSelected",event:"preENOXVersionExplorerCompareToSelected",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-part-compare",family:WUXManagedFontIcons.Font3DS},icon:c("I_Compare.png"),text:d.compareTo,checkAccess:["read","write"],checkVersion:function(e){return!1},nodeDropdown:!0},{id:"ENOXVersionExplorerMergeIntoSelected",event:"preENOXVersionExplorerMergeIntoSelected",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-branch-downward",family:WUXManagedFontIcons.Font3DS},icon:s.getIconPath("MergeHdr"),text:d.mergeInto,checkAccess:["read","write"],checkVersion:function(e){return!1},nodeDropdown:!0},{id:"ENOXVersionExplorerPruneDescendants",event:"preENOXVersionExplorerSetPruneModeUp",fonticon:{content:"wux-ui-3ds wux-ui-3ds-lg wux-ui-3ds-flow-tree-expand-down",family:WUXManagedFontIcons.Font3DS},text:d.hideDescendants,checkAccess:["read","write"],pruneMode:"up",checkVersion:function(e){if(l._getActiveView()===t.DISPLAY_MODES.SUBWAY_VIEW&&0!=this.options.pruningState){var n=e.__SUBWAYGRAPHNODE__&&e.__SUBWAYGRAPHNODE__.data?e.__SUBWAYGRAPHNODE__.data.pruneMode:void 0;return"up"!=n&&"down"!=n}return!1},nodeDropdown:!0},{id:"ENOXVersionExplorerPruneAncestors",event:"preENOXVersionExplorerSetPruneModeDown",fonticon:{content:"wux-ui-3ds wux-ui-3ds-lg wux-ui-3ds-flow-tree-expand-up",family:WUXManagedFontIcons.Font3DS},text:d.hideAncestors,checkAccess:["read","write"],pruneMode:"down",checkVersion:function(e){if(l._getActiveView()===t.DISPLAY_MODES.SUBWAY_VIEW&&e.options.ancestors&&0!=this.options.pruningState){var n=e.__SUBWAYGRAPHNODE__&&e.__SUBWAYGRAPHNODE__.data?e.__SUBWAYGRAPHNODE__.data.pruneMode:void 0;return"up"!=n&&"down"!=n}return!1},nodeDropdown:!0},{id:"ENOXVersionExplorerPruneNoneAncestors",event:"preENOXVersionExplorerSetPruneModeNoneAncestors",fonticon:{content:"wux-ui-3ds wux-ui-3ds-lg wux-ui-3ds-flow-tree-expand-up",family:WUXManagedFontIcons.Font3DS},text:d.showAncestors,checkAccess:["read","write"],pruneMode:"none",checkVersion:function(e){return l._getActiveView()===t.DISPLAY_MODES.SUBWAY_VIEW&&0!=this.options.pruningState&&"down"==(e.__SUBWAYGRAPHNODE__&&e.__SUBWAYGRAPHNODE__.data?e.__SUBWAYGRAPHNODE__.data.pruneMode:void 0)},nodeDropdown:!0},{id:"ENOXVersionExplorerPruneNoneDescendants",event:"preENOXVersionExplorerSetPruneModeNoneDescendants",fonticon:{content:"wux-ui-3ds wux-ui-3ds-lg wux-ui-3ds-flow-tree-expand-down",family:WUXManagedFontIcons.Font3DS},text:d.showDescendants,checkAccess:["read","write"],pruneMode:"none",checkVersion:function(e){return l._getActiveView()===t.DISPLAY_MODES.SUBWAY_VIEW&&0!=this.options.pruningState&&"up"==(e.__SUBWAYGRAPHNODE__&&e.__SUBWAYGRAPHNODE__.data?e.__SUBWAYGRAPHNODE__.data.pruneMode:void 0)},nodeDropdown:!0},{id:"ENOXVersionExplorerShowMaturity",event:"preEventENOXVersionExplorerShowMaturity",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-collaborative-lifecycle-management",family:WUXManagedFontIcons.Font3DS},icon:s.getIconPath("MaturityHdr"),text:s.getTitle("MaturityHdr"),userAccess:["read","write"],checkVersion:function(e){var t=this;return!t.isEffectivityBasedReused()&&!e.isMIB()&&s.checkAvailability("MaturityHdr",[u(e)],t._widget,t._context)},nodeDropdown:!0},{id:"divider"},{id:"ENOXVersionExplorerWhereUsed",event:"preENOXVersionExplorerWhereUsed",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-object-related",family:WUXManagedFontIcons.Font3DS},icon:c("I_ENORIPE32.png"),text:d.relations,checkAccess:["read","write"],checkVersion:function(e){return!1},nodeDropdown:!0},{id:"ENOXVersionExplorerDownload",event:"preENOXVersionExplorerDownload",fonticon:{content:"fonticon fonticon-2x fonticon-download",family:WUXManagedFontIcons.Font3DS},text:d.download,checkAccess:["read","write"],checkVersion:function(e){return s.checkAvailability("DownloadHdr",[u(e)],this._widget,this._context)},nodeDropdown:!0},{id:"ENOXVersionExplorerDisplayProperties",event:"ENOXVersionExplorerDisplayProperties",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-info-open-in-a-new-window",family:WUXManagedFontIcons.Font3DS},icon:s.getIconPath("Information"),text:s.getTitle("Information"),userAccess:["read","write"],checkVersion:function(e){return!this.isEffectivityBasedReused()&&r._DATA_MODEL_TYPE!==t.DATA_MODEL_TYPES.MODEL_RDF},nodeDropdown:!0},{id:"divider"},{id:"ENOXVersionExplorerDeleteVersion",event:"preENOXVersionExplorerDeleteVersion",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash",family:WUXManagedFontIcons.Font3DS},icon:s.getIconPath("DeleteHdr"),text:s.getTitle("DeleteHdr"),checkAccess:["read","write"],checkVersion:function(e){var t=this;/*!treeNode.isMIB() &&*/
return!t.isEffectivityBasedReused()&&s.checkAvailability("DeleteHdr",[u(e)],t._widget,t._context)},nodeDropdown:!0}],this._multiSelectMenuList=[{id:"ENOXVersionExplorerNoActions",event:"_ENOXVersionExplorerNoActions",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-block",family:WUXManagedFontIcons.Font3DS},text:d.noActions,checkVersion:function(e){return!0},multiSelectMenu:!0,minNodes:2,maxNodes:1/0,excludeIfOtherItemsExist:!0}]}})),define("DS/ENOXVersionExplorerController/VersionExplorerEventManager",["UWA/Core","UWA/Class","UWA/Promise","DS/ENOXVersionExplorerController/VersionExplorerEventList","DS/i3DXCompassPlatformServices/OpenWith","DS/CoreEvents/ModelEvents"],(function(e,t,n,i,o,r){"use strict";var s=r.extend({_disabledEventList:[],init:function(r,a,d){this._parent(r);var l=a;s.implement({addExternalNodeDropdownMenuItem:function(e){for(var t=Array.isArray(e)?e:new Array(e),n=0;n<t.length;n++){if("string"!=typeof(e=t[n]).id||!e.id.length)throw Error("VersionExplorerEventManager:addDropDownMenuItem - eventId cannot be null ");if(!e.icon&&!e.fonticon)throw Error("VersionExplorerEventManager:addDropDownMenuItem - icon cannot be null ");if("string"!=typeof e.text||!e.text.length)throw Error("VersionExplorerEventManager:addDropDownMenuItem - menu text cannot be null ");if("function"!=typeof e.subfn)throw Error("VersionExplorerEventManager:addDropDownMenuItem - subscribe function cannot be null");if("function"!=typeof e.checkVersion)throw Error("VersionExplorerEventManager:addDropDownMenuItem - checkVersion function cannot be null");var i={id:e.id,externalpub:!0,published:!0,externalEvent:!0,subfn:e.subfn};this._eventList.push(i),this._registerEvent(i),this._menuList.push({id:e.id,event:e.id,icon:e.icon||void 0,fonticon:e.fonticon||void 0,text:e.text,checkVersion:e.checkVersion,externalMenu:!0,nodeDropdown:!0})}},addExternalMultiSelectDropdownMenuItem:function(e){for(var t=Array.isArray(e)?e:new Array(e),n=0;n<t.length;n++){if("string"!=typeof(e=t[n]).id||!e.id.length)throw Error("VersionExplorerEventManager:addDropDownMenuItem - eventId cannot be null ");if(!e.icon&&!e.fonticon)throw Error("VersionExplorerEventManager:addDropDownMenuItem - icon cannot be null ");if("string"!=typeof e.text||!e.text.length)throw Error("VersionExplorerEventManager:addDropDownMenuItem - menu text cannot be null ");if("function"!=typeof e.subfn)throw Error("VersionExplorerEventManager:addDropDownMenuItem - subscribe function cannot be null");if("function"!=typeof e.checkVersion)throw Error("VersionExplorerEventManager:addDropDownMenuItem - checkVersion function cannot be null");var i={id:e.id,externalpub:!0,published:!0,externalEvent:!0,subfn:e.subfn};this._eventList.push(i),this._registerEvent(i),this._multiSelectMenuList.push({id:e.id,event:e.id,icon:e.icon||void 0,fonticon:e.fonticon||void 0,text:e.text,checkVersion:e.checkVersion,externalMenu:!0,multiSelectMenu:!0,minNodes:e.minNodes||2,maxNodes:e.maxNodes||1/0})}},removeExternalNodeDropdownMenuItem:function(e){this._removeExternalDropdownMenuItem(e)},removeExternalMultiSelectDropdownMenuItem:function(e){this._removeExternalDropdownMenuItem(e,!0)},getPublishedEvents:function(){return this._eventList.reduce((function(e,t){return!0===t.published&&!0===t.externalpub&&e.push({event:t.id,onCompleteEvent:t.onCompleteEvent}),e}),[])},getSubscribedEvents:function(){return this._eventList.reduce((function(e,t){return!0===t.subscribed&&!0===t.externalsub&&e.push({event:t.id,onComplete:t.onComplete}),e}),[])},subscribeEvent:function(e,t,n){var i,o=this._getEvent(e);return o&&"function"==typeof t&&(i=this.subscribe({event:o.id},t),n&&o.tokenDefault&&!0===o.allowPreventDefault&&(this.unsubscribe(o.tokenDefault),o.tokenDefault=void 0),o.tokens.push(i)),i},unsubscribeEvent:function(e,t){var n=this._getEvent(e);if(n&&t){var i=n.tokens.splice(n.tokens.indexOf(t),1);1===i.length&&this.unsubscribe(i[0]),n.tokens.length||!n.subfn||n.tokenDefault||(n.tokenDefault=this.subscribe({event:n.id},n.externalEvent?n.subfn:n.subfn.bind(this)))}},publishEvent:function(e,t){var n=this._getEvent(e);n&&"function"==typeof n.pubfn&&n.pubfn(t)},disablePublishEvent:function(e){this._disabledEventList.push(e)},enablePublishEvent:function(e){this._disabledEventList.splice(this._disabledEventList.indexOf(e),1)},getMenuItemsIDList:function(e){return this[e?"_multiSelectMenuList":"_menuList"].reduce((function(e,t){return!("divider"===t.id||"ENOXVersionExplorerNoActions"===t.id)&&e.push(t.id),e}),[])},hideMenuItem:function(e,t){var n=this[t?"_multiSelectMenuList":"_menuList"].find((function(t){return t.id===e}));n&&(n.disabled=!0)},showMenuItem:function(e,t){var n=this[t?"_multiSelectMenuList":"_menuList"].find((function(t){return t.id===e}));n&&(n.disabled=!1)},setCheckVersionExternalFunction:function(e,t,n){var i=this[n?"_multiSelectMenuList":"_menuList"].find((function(t){return t.id===e}));i&&"function"==typeof t&&(i.checkVersionExternal=t)},resetCheckVersionExternalFunction:function(e,t){var n=this[t?"_multiSelectMenuList":"_menuList"].find((function(t){return t.id===e}));n&&(n.checkVersionExternal=void 0)},publish:function(e){if("select"===e.event||"unselect"===e.event&&e.context&&e.context.options){var t=e.context.options;if(t.grid&&t.grid.contents&&t.grid.contents[0].id){var n=t.grid.contents[0].id;e.context.options.cid=n}}this._disabledEventList.indexOf(e.event)<0&&this._parent(e)},_removeExternalDropdownMenuItem:function(e,t){var n,i,o=!0===t?"_multiSelectMenuList":"_menuList";1===(i=1===(n=this[o].splice(this[o].findIndex((function(t){return t.id===e&&!0===t.externalMenu})),1)).length?this._eventList.find((function(e){return e.id===n[0].id&&!0===n[0].externalMenu&&!0===e.externalEvent})):[]).length&&this._unregisterEvent(i[0])},_registerEvent:function(e){e.noPubFn||(e.pubfn=function(t){this.publish({event:e.id,data:t})}.bind(this)),e.tokens=[],e.subfn&&(e.tokenDefault=this.subscribe({event:e.id},e.externalEvent?e.subfn:e.subfn.bind(this)))},_unregisterEvent:function(e){for(var t=e.tokens.length,n=0;n<t;n++)this.unsubscribe(e.tokens[n]);e.tokens=[],e.tokenDefault&&(this.unsubscribe(e.tokenDefault),e.defaultToken=void 0)},_getEvent:function(e){return this._eventList.find((function(t){return t.id===e}))},_getMenuItemList:function(e){var t=this;return t[!0===e?"_multiSelectMenuList":"_menuList"].map((function(e){if("object"==typeof e){var n={};if("divider"===e.event)n=e;else for(var i in e)n[i]="event"===i?t._eventList.find((function(t){return t.id===e[i]})):e[i];return n}}))},_getNodeDropdownMenuListPromise:function(e){var t=this;return l._getPreContextualMenuPromise(e).then((function(e){var i=e;return new n((function(e,n){var o=t._getMenuItemList().reduce((function(e,n,o,r){return n&&n.id&&("divider"===n.id||!n.disabled&&!!(n.checkVersionExternal||(!0===n.event.externalEvent?n.checkVersion:n.checkVersion.bind(t)))(i)&&!0===n.nodeDropdown)&&e.push(n),e}),[]);"divider"==o[o.length-1].id&&o.pop();for(var r=-1,s=0;s<o.length;s++)if("ENOXVersionExplorerOpenWith"===o[s].id){r=s;break}if(!(r<0))return t._getNodeDropdownMenuListOpenWithPromise(i).then((function(t){t.length>0?o[r].submenu=t:o.splice(r,1),e(o)}));e(o)}))}))},_getNodeDropdownMenuListOpenWithPromise:function(t){var i=this;return new n((function(n,s){var a=[],d=t.options.data.type;void 0!==d&&0!==d.length||!t.options.grid||(d=t.options.data.type=t.options.grid.type);var l=t.options.grid["ds6w:kind"];i._widget?require(["DS/PADUtils/PADUtilsServices","DS/PADUtils/PADWSAccess"],(function(i,s){i.app_initialization((function(){var s=t;s.options.type=s.options.data.type,s.options.displayname=r.label,s.getID=function(){return this.options.grid&&this.options.grid.contents&&this.options.grid.contents.length>0?this.options.grid.contents[0].id:this.options.id},i.contentOpenWith([s],(function(t){Array.isArray(t.data.items)&&t.data.items.length>0&&l&&(t.data.items[0]["ds6w:kind"]=l,"SystemModel"===s.options.type&&Array.isArray(t.data.items[0].objectTaxonomies)&&t.data.items[0].objectTaxonomies.length>0&&(t.data.items[0].objectTaxonomies[t.data.items[0].objectTaxonomies.length-1]=l));var r=new o;r.set3DXContent(t,!1),e.is(r.retrieveCompatibleApps,"function")&&r.retrieveCompatibleApps((function(t){var r=!1;s.options.type===d&&t.forEach((function(e){e.text.contains("CATIA V5")&&(r=!0),a.push({type:"PushItem",title:e.text,fonticon:void 0!==e.fonticon&&null!==e.fonticon&&e.fonticon.length>0?{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+e.fonticon,family:WUXManagedFontIcons.Font3DS}:void 0,icon:void 0!==e.icon&&null!==e.icon&&e.icon.length>0?e.icon:"",action:{callback:e.handler}})})),r||"XCADNonPSBaseRepReference"!==s.options.type?s.options.type===d&&n(a):(s.options.type="VPMReference",i.contentOpenWith([s],(function(t){var i=new o;i.set3DXContent(t,!1),e.is(i.retrieveCompatibleApps,"function")&&i.retrieveCompatibleApps((function(e){e.forEach((function(e){e.text.contains("CATIA V5")&&a.push({type:"PushItem",title:e.text,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+e.fonticon,family:WUXManagedFontIcons.Font3DS},action:{callback:e.handler}})})),s.options.type=d,n(a)}))})))}))}))}))})):n(a)}))},_getMultiSelectMenuListPromise:function(e){if(!Array.isArray(e))throw Error("_getMultiSelectMenuListPromise.nodeList: Input not of type array");var t=this,i=e.length;return new n((function(n,o){var r=t._getMenuItemList(!0).reduce((function(n,o,r,s){var a=!0;if(!0===o.multiSelectMenu&&i>=o.minNodes&&i<=o.maxNodes)for(var d=0;d<i;d++)a&=!o.disabled&&(o.checkVersionExternal||o.checkVersion).bind(t)(e[d],e);return o&&o.id&&("divider"===o.id||!0===Boolean(a))&&n.push(o),n}),[]);r.length&&"divider"==r[r.length-1].id&&r.pop(),r.length>1&&r.splice(r.findIndex((function(e){return!0===e.excludeIfOtherItemsExist})),1),n(r)}))}}),t.implement.call(this,new i(a,d));for(var c=this._eventList.length,u=0;u<c;u++){var p=this._eventList[u];this._registerEvent(p)}}});return s})),define("DS/ENOXVersionExplorerController/VersionExplorerController",["UWA/Core","UWA/Utils/InterCom","DS/ENOXVersionExplorerModel/VersionTreeDocumentModel","DS/ENOXVersionExplorerModel/VersionTreeNodeModel","DS/ENOXVersionExplorerViews/VersionExplorerView","DS/ENOXVersionExplorerViews/NewVersionDialog","DS/ENOXVersionExplorerViews/NewRevisionDialog","DS/ENOXVersionExplorerController/VersionExplorerEventManager","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/ENOXVersionExplorerModelManager/ModelManagerBase","DS/ENOXVersionExplorerModelManager/ModelManagerP","DS/ENOXVersionExplorerModelManager/ModelManagerRDF","DS/ENOXVersionExplorerModelManager/ModelManagerHistory2","DS/ENOXVersionExplorerUtils/ArrayFunctions","DS/ENOXVersionExplorerUtils/ColumnList","DS/WAFData/WAFData","DS/LifecycleCmd/MessageMediator","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleServices/DictionaryServices","DS/LifecycleControls/CommandDialogWUX","DS/ENOXVersionExplorerViews/VersionExplorerPrefs","DS/PlatformAPI/PlatformAPI","DS/WebInWinHelper/WebInWinHelper","DS/Controls/LineEditor","i18n!DS/ENOXVersionExplorerController/assets/nls/NodeDropdownMenuNLS"],(function(e,t,n,i,o,r,s,a,d,l,c,u,p,E,f,h,v,_,x,m,b,D,O,g,N,w,y){"use strict";return a.extend({_currentVersion:void 0,_activeVersion:void 0,_context:void 0,_tenant:void 0,_type:void 0,_widget:void 0,init:function(a){var M,V,C,S,I,A,T,L,P=void 0,X=void 0,R=void 0,W=void 0,k=void 0,F=void 0,B=!1,U=void 0;function H(t){if(console.log("IR-1307806 - _refreshVersionExplorer - Refresh Check"),1!=P.refreshInProgress){var n;if(P.refreshInProgress=!0,console.log("IR-1307806 - _refreshVersionExplorer - Refresh Do"),setTimeout((function(){P.refreshInProgress=void 0}),50),"string"==typeof t){var o=JSON.parse(t),r=o.Refresh;if(r)if(Array.isArray(r.created)&&r.created.length>0&&R.isNodeInModel(r.created[0].sourceObjectId))n={physicalid:r.created[0].physicalid,tenant:o.tenant,fireEvent:"ENOXVersionExplorerNewVersionCreated"},r.created[0].forceLoad&&(n.forceLoad=r.created[0].forceLoad);else if(Array.isArray(r.modified)&&r.modified.length>0&&R.isNodeInModel(r.modified[0].physicalid))n={physicalid:r.modified[0].physicalid,tenant:o.tenant,fireEvent:"ENOXVersionExplorerVersionModified"};else if(Array.isArray(r.deleted)&&r.deleted.length>0&&R.isNodeInModel(r.deleted[0].physicalid)){var s=f.intersectionDifference(r.deleted,R._nodeList,(function(e,t){return e.physicalid===t.options.id})),a=s[1].difference,d=s[1].intersection;d.length&&(n={removedVersion:d[0],fireEvent:"ENOXVersionExplorerVersionDeleteCompleted"},d[0]===P._activeVersion&&(P._activeVersion=void 0),a.length&&e.extend(n,{physicalid:a[0].options.id,tenant:o.tenant}))}}else if(t&&t.authored&&t.authored.modified&&e.is(t.authored.modified,"array")&&1===t.authored.modified.length){if(e.is(t.authored.modified[0],"string")&&R.isNodeInModel(t.authored.modified[0]))n={physicalid:t.authored.modified[0],fireEvent:"ENOXVersionExplorerVersionModified"};else if(e.is(t.authored.modified[0].physicalid,"string")&&R.isNodeInModel(t.authored.modified[0].physicalid)&&e.is(t.authored.modified[0].key,"string")&&e.is("ownerChanged"===t.authored.modified[0].key)){var l=R._nodeList.findIndex((function(e){return e.options.id===t.authored.modified[0].physicalid}));n=0===l&&1===R._nodeList.length?{removedVersion:R.searchByID(t.authored.modified[0].physicalid)[0],fireEvent:"ENOXVersionExplorerVersionOwnerChanged"}:{removedVersion:R.searchByID(t.authored.modified[0].physicalid)[0],fireEvent:"ENOXVersionExplorerVersionOwnerChanged",physicalid:R._nodeList[0===l?1:0].options.id}}}else t.options&&t.options.id?n={physicalid:t.options.id,fireEvent:"NewVersionCreated"}:P.refreshInProgress=void 0;n&&(n.physicalid?(n.forceLoad&&(R._circularColorArray.resetCurrentIndex(),R._forceReset=!0,R.items=null),P._loadVersionModel({id:n.physicalid,tenantId:n.tenant,context:P._context,securityContext:P._securityContext,type:R.type,dataModelType:R._DATA_MODEL_TYPE,onComplete:function(e){var t,o;if(t=n.fireEvent.contains("Created")||n.fireEvent.contains("Modified")?1===(o=R.searchByID(n.physicalid)).length?o[0]:void 0:n.removedVersion,P._activeVersion){var r=R.searchByID(P._activeVersion);1===r.length&&r[0]instanceof i&&!r[0].isActive()&&P._setActiveVersion({treeNode:r[0]})}t&&P.publishEvent(n.fireEvent,t)}})):R.empty())}}function Y(e){console.log("VersionExplorerController error handler"),console.log(e),P.publishEvent("ENOXVersionExplorerError",e),X.unmask()}function j(e,t){R.createNewVersionPromise({parentid:e.parent.options.id,title:e.title,description:e.description,versionSemantic:e.versionSemantic,nextRevision:e.parent.nextRevision,itemID:R.itemID}).then(t,Y)}P=this,a=a||{},this._widget=a.widget,l._widget=a.widget,I="boolean"!=typeof a.autoUpdate||a.autoUpdate,(R=new(n.implement(c)))._isODT=a._isODT,R.useGlobalStorage="boolean"==typeof a.useGlobalStorage&&a.useGlobalStorage,R._versiongraphFlags=Array.isArray(a.versiongraphFlags)?a.versiongraphFlags:[],R._versionPidsToKeep=Array.isArray(a.versionPidsToKeep)?a.versionPidsToKeep:[],R._validIntents=Array.isArray(a.intentsToKeep)?a.intentsToKeep:[],R._useFontIcons="boolean"==typeof a.useIcons&&a.useIcons,R.globalStorageName=a.globalStorageName,R.webToWinComSocket=a.webToWinComSocket,this._ID=R._ID="VE_"+Date.now().valueOf().toString(),B=!!a.disableSelection&&a.disableSelection,F=a.userData?a.userData:{},M=a.versionGraphContainer,C=a.nodeEdgeViewsTemplate,S=a.customOnDrop,V=a.newVersionDialogContainer,A=a.useWebCommandsOnNative,T=a.disableMaturityButton,a.context,L=a.fromWebInWinWrapper,this._historyUIContainer=a.historyUIContainer,this._revisionFamily=a.revisionFamily,U=new O(a.widget,"RevisionExplorerCustomizeColumns",void 0,void 0,a._isODT,R.useGlobalStorage,R.globalStorageName,R.webToWinComSocket),I&&(_.addEvent("_ENOXVersionExplorerNewVersionCreated",H),this.refreshSub=g.subscribe("Lifecycle.Modification",H),require(["DS/PADUtils/PADCommandProxy"],(function(e){P.PADCommandProxy=e.create({events:{onRefresh:H.bind(P)}})}))),X=new o({parentContainer:M,nodeEdgeViewsTemplate:C,customOnDrop:S,versionExplorerController:P,versionModel:R,_isODT:a._isODT,customizeColumns:U}),this._parent(a,R,X),R._getTrueRoot()._modelEvents._setParent(this),X.build(),R._SELECTION_MODE=a.selectionMode||d.SELECTION_MODES.MULTI_SELECT_ONLY|d.SELECTION_MODES.WITH_COMMANDS,R._SELECTION_MODE>=0&&R._SELECTION_MODE&d.SELECTION_MODES.SINGLE_SELECT_ONLY&&(R._SELECTION_MODE&=~d.SELECTION_MODES.MULTI_SELECT_ONLY),e.Class.implement.call(this,{setSelectionMode:function(e){k=R._SELECTION_MODE,e>=0&&e&d.SELECTION_MODES.SINGLE_SELECT_ONLY&&(e&=~d.SELECTION_MODES.MULTI_SELECT_ONLY),X.setSelectionMode(e>=0?e:d.SELECTION_MODES.MULTI_SELECT_ONLY|d.SELECTION_MODES.WITH_COMMANDS)},restorePreviousSelectionMode:function(){X.setSelectionMode(k||d.SELECTION_MODES.MULTI_SELECT_ONLY|d.SELECTION_MODES.WITH_COMMANDS)},showDialog:function(t,n,o){var r;null==n&&(n=null!=this._widget?this._widget.body:null),X.showDialog(t,n,o);var s,a=1===(r=R.searchByID(P._activeVersion)).length?r[0]:void 0;a instanceof i&&(void 0!==a.options&&void 0!==a.options.label&&void 0!==a.options.label&&(s=e.String.unescapeHTML(a.options.label)),X.setTitle(s))},hideDialog:function(){X.hideDialog()},cleanup:function(){I&&_.removeEvent("_ENOXVersionExplorerNewVersionCreated",H),X.cleanup(),R.empty(),R.itemID=null,R.items=null},getSelectedNodes:function(){return R.getSelectedNodes()},getDisableSelection:function(){return B},setDisableSelection:function(e){B=e},getUserData:function(e){return F[e]},setUserData:function(e,t){F[e]=t},getToolbar:function(){return X.getToolbar()},setSingleSelectionMode:function(){this.setSelectionMode(R._SELECTION_MODE&~d.SELECTION_MODES.MULTI_SELECT_ONLY)},setMultiSelectionMode:function(){this.setSelectionMode(R._SELECTION_MODE|d.SELECTION_MODES.MULTI_SELECT_ONLY)},enableCommands:function(){this.setSelectionMode(R._SELECTION_MODE|d.SELECTION_MODES.WITH_COMMANDS)},areCommandsEnabled:function(){return!!(R._SELECTION_MODE&d.SELECTION_MODES.WITH_COMMANDS)},disableCommands:function(){this.setSelectionMode(R._SELECTION_MODE&~d.SELECTION_MODES.WITH_COMMANDS)},select:function(e,t){var n=e instanceof i?[e]:"string"==typeof e&&e.length?R.searchByID(e):void 0;Array.isArray(n)&&1===n.length&&(R.prepareAddDelete(),n[0].select(t),n[0].__LISTVIEWCOPY__&&n[0].__LISTVIEWCOPY__.select(),R.pushAddDelete())},unselect:function(e,t){var n=e instanceof i?[e]:"string"==typeof e&&e.length?R.searchByID(e):void 0;Array.isArray(n)&&1===n.length&&(R.prepareAddDelete(),n[0].unselect(t),n[0].__LISTVIEWCOPY__&&n[0].__LISTVIEWCOPY__.unselect(),R.pushAddDelete())},unselectAll:function(){R&&(R.prepareAddDelete(),R.unselectAll(),R.pushAddDelete())},applyFilter:function(e){if(R){R.filterData=e,R.prepareAddDelete(),R._FILTER_ENABLED=!0;var t=R?R.applyFilter(e):[];R.pushAddDelete()}return t},resetFilter:function(){R&&null!=R.filterData&&this.applyFilter(R.filterData)},clearFilter:function(){R&&(R.prepareAddDelete(),R._FILTER_ENABLED=!1,R&&R.clearFilter(),R.pushAddDelete())},enableDrag:function(e){this.setSelectionMode(R._SELECTION_MODE|d.SELECTION_MODES.ALLOW_DRAG)},disableDrag:function(){this.setSelectionMode(R._SELECTION_MODE&~d.SELECTION_MODES.ALLOW_DRAG)},enableDrop:function(){this.setSelectionMode(R._SELECTION_MODE|d.SELECTION_MODES.ALLOW_DROP)},disableDrop:function(){this.setSelectionMode(R._SELECTION_MODE&~d.SELECTION_MODES.ALLOW_DROP)},getObjects:function(){return R._nodeList.slice()},reframeAll:function(){X&&X.reframeThumbnailGraph()},setRevisionMode:function(e){e&&(P.revisionMode=e)},clearRevisionMode:function(){P.revisionMode=null},setGraphProprietary:function(e){e&&(P.graphProprietary=e)},setCurrentObjectEffectivityBased:function(e){P.currentObjectEffectivityBased&&(P.currentObjectEffectivityBased=e)},getCurrentObjectEffectivityBased:function(){return P.currentObjectEffectivityBased},isEffectivityBased:function(){return P.revisionMode&&"effectivity_based"===P.revisionMode},isEffectivityBasedReused:function(){return P.revisionMode&&"effectivity_based_reused"===P.revisionMode},isAnyEffectivityBasedMode:function(){return P.revisionMode&&("effectivity_based"===P.revisionMode||"effectivity_based_reused"===P.revisionMode||"effectivity_based_model"===P.revisionMode)},isEffectivityBasedModeOrEffectivityBasedReuseMode:function(){return P.revisionMode&&("effectivity_based"===P.revisionMode||"effectivity_based_reused"===P.revisionMode)},changeGraphCurrentVersionAndRefresh:function(e){var t=this;if(e&&e.physicalid){t._currentVersion=e.physicalid,R._circularColorArray.resetCurrentIndex(),R._forceReset=!0,t.setRevisionMode("effectivity_based"),R.items=null,e.revision||(e.revision="");var n=t.subscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",(function(i){t.unsubscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",n),t.resetFilter(),t.select(e.physicalid),e.id=e.physicalid,t._historyUIContainer&&e.displayName&&"function"==typeof t._historyUIContainer.setTitleFromObject&&t._historyUIContainer.setTitleFromObject(e),t._historyUIContainer&&"function"==typeof t._historyUIContainer.setNewTitleFromObject&&t._historyUIContainer.setNewTitleFromObject(e),t._revisionFamily&&(t._revisionFamily.originalEBProduct=e,t._revisionFamily.dispatchEvent("ModelUpdated",e))}));t.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:!0})}},_getAllowedSemanticsPromise:function(t,n,i,o){return 1==o._isODT?new e.Class.Promise((function(e,t){e({allowedSemantics:[{id:"",mode:[],semantic:[],status:"SUCCEEDED"}],intents:[]})})):x.getAllowedSemanticsPromise(t,n,i)},_getMaturityStatesAttributes:function(t,n,i){return new e.Class.Promise((function(e,o){var r=new Set;r.add(t);var s={policies:Array.from(r)},a=JSON.stringify(s),d=m.get3DSpaceWSUrl(n,"/resources/lifecycle/maturity/getStatesAttributes",null);v.authenticatedRequest(d,{method:"POST",type:"text",headers:m.getHeaders(encodeURIComponent(i)),timeout:6e5,data:a,onComplete:function(t){var n="string"==typeof t?JSON.parse(t):t;e(n)},onFailure:function(t,n){e({})},ontimeout:function(){e({})}})}))},_loadVersionModel:function(e){if(a._isODT||X.setLoadingMask(),R.type=e.type||R.type||"",e.context&&e.context&&e.context.getSecurityContext){var t=e.context.getSecurityContext();e.securityContext=t.SecurityContext||t}else if(e.context&&e.context.options&&e.context.options.context&&e.context.options.context.getSecurityContext){t=e.context.options.context.getSecurityContext();e.securityContext=t.SecurityContext||t}void 0===e.securityContext&&(e.securityContext=this._securityContext),widget.securityContext=e.securityContext,"function"!=typeof widget.getValue&&(widget.getValue=function(t){if("x3dPlatformId"===t)return e.tenantId});var n=e.tenantId;!n&&e.tenant&&(n=e.tenant),n||(n=widget.getValue("x3dPlatformId"));var i=[e.id],o=["3DSpace"],r=[],s=[0];P._app_initialization((function(){P._loadAttrs(i,o,r,s,n,(function(t){!function(o){var r,s={};!function(e,t,n,i,o,r){if(e===d.DATA_MODEL_TYPES.MODEL_HISTORY&&(R._DupToggling=!0,!1===l.UserSettings.displayDuplicates&&(e=d.DATA_MODEL_TYPES.MODEL_REVISION,R._forceReset=!0)),"string"==typeof t&&t.length&&e!==d.DATA_MODEL_TYPES.MODEL_HISTORY&&e!==d.DATA_MODEL_TYPES.MODEL_CUSTOM&&(e=d.DATA_MODEL_TYPES[t.contains(":")?"MODEL_RDF":"MODEL_REVISION"]),void 0!==R.lastType&&R.lastType!==t&&(R._forceReset=!0),R.lastType=t,R._forceReset||R._DATA_MODEL_TYPE!==e){R._forceReset=!1,R._DATA_MODEL_TYPE=e;for(var s=h(R._DATA_MODEL_TYPE),a={},c=0;c<s.columns.length;c++)a[s.columns[c].dbKey]=c;if(n&&n.length>0){var f={nlsLabel:!0,"PLMEntity.PLM_ExternalID":!0,"PLMEntity.V_Name":!0,"PLMEntity.V_description":!0,current:!0,originated:!0},v=n[0].basicData,_=n[0].data,x=n[0].computed,m=(n[0].extensions,n[0].groupData);P._isMIB=0==n[0].physicalID.indexOf("cid:");for(var b={},D=[v,_,x,m],O=0;O<D.length;O++){var g=D[O];if(void 0!==g)for(c=0;c<g.length;c++){var N=g[c],w=N.selectable,y=N.name,M=N.nls,V=N.path;if(null==N.attrID&&(void 0!==V&&(w=y=V),(!w||0!==w.indexOf("branch."))&&"SystemModel.Title"!==w&&"attribute[Title]"!==N.selectable)){if(null!=o&&N.path===o&&N.value&&N.value.length>0&&(r["ds6w:kind"]=N.value[0]),void 0===M&&N.displayName&&(M=N.displayName),void 0===w&&y){var C=(w=y).split(":");w=C[C.length-1]}void 0===a[w]&&void 0===f[w]&&(b[w]={dbKey:w,outputKey:y,columnNLS:M})}}}for(var c in b)s.columns.push(b[c]);P._isMIB&&(s.columns.push({dbKey:"__BranchTitle__",outputKey:"__BranchTitle__",columnNLS:"Branch Title"}),s.columns.push({dbKey:"SystemModel.SystemContentType",outputKey:"SystemModel.SystemContentType",columnNLS:"SystemContentType"}))}switch(U.setParams("RevisionExplorerCustomizeColumns_"+R._DATA_MODEL_TYPE.toString(),s.columns,s.defaultCols,s.resetGraphListView,s.resetGraphView),R._DATA_MODEL_TYPE){case d.DATA_MODEL_TYPES.MODEL_RDF:W=p;break;case d.DATA_MODEL_TYPES.MODEL_HISTORY:W=E;break;case d.DATA_MODEL_TYPES.MODEL_CUSTOM:if(!i)throw Error("VersionExplorerController:setModelManager - Custom model manager not provided for data model type MODEL_CUSTOM");W=i;break;default:W=u}R.setManager(W)}}(e.dataModelType,R.type,t,e.customModelManager,o,s),X&&X.updateViewOptions();var c=e.onComplete;P.options.context?P._context=P.options.context:e.context&&e.context.options&&e.context.options.context?P._context=e.context.options.context:self._context=e.context,P._tenantId=n,P._securityContext=e.securityContext,P._securityContext&&(P._context?"function"!=typeof P._context.getSecurityContext&&(P._context.getSecurityContext=function(){return{SecurityContext:P._securityContext}}):P._context={getSecurityContext:function(){return{SecurityContext:P._securityContext}}}),r=h(R._DATA_MODEL_TYPE).excludeFromQuery,e.attributeList=U.getAlldbKeys();var v={revision:"code",created:"creationDate",owner:"ownerName",maturity:"maturity_nls",project:"project_nls",policy:"policy_nls",organization:"organization_nls",type:"type_nls",reservedby:"reservedbyName"},_={};e.attributeList.forEach((function(e){var t=void 0===v[e]?e:v[e];_[e]=t}));for(var m=U.load(),b=0,D=m.length;b<D;b++){var O=void 0;O=m[b].startsWith("###")?m[b].replace("###",""):m[b],_[O]&&delete _[O]}var g=P.options.customizeColumnAttributeHash;if(g){var N=Object.keys(g);for(b=0;b<N.length;b++)delete _[N[b]]}delete _["SystemModel.SystemContentType"],delete _.policy,delete _.policy_nls,null!=o&&delete _[o];var w={};Array.isArray(r)&&r.length&&r.forEach((function(e){w[e]=!0})),(N=Object.keys(_)).forEach((function(e){w[e]||r.push(e)})),Array.isArray(r)&&r.length&&(e.attributeList=f.intersectionDifference(e.attributeList,r,(function(e,t){return e===t}))[0].difference);var y=e.attributeList.indexOf("__BranchTitle__");y>=0&&e.attributeList.splice(y,1),e.ds6w_kind=s["ds6w:kind"];var M=[];(!P.isEffectivityBasedModeOrEffectivityBasedReuseMode()||null!=R._validIntents&&0!==R._validIntents.length||a._isODT?new Promise(((e,t)=>e())):(R._validIntents=["E","D","LAST","S"],new Promise(((e,t)=>e({allowedSemantics:[{semantic:["E","D","R","LAST","S"]}]}))))).then((function(t){if(t&&t.allowedSemantics[0].semantic){if((M=t.allowedSemantics[0].semantic).includes("R"))var n=P._filterSemantics(M);R._validIntents=n}return R.loadVersionModelPromise(e)})).then((function(t){P.refreshView=t,y>=0&&e.attributeList.push("__BranchTitle__");var n="";return R.mainBranchRoot&&R.mainBranchRoot.policy&&(n=R.mainBranchRoot.policy),""==n&&R.objectHash&&R.objectHash[e.id]&&R.objectHash[e.id].policy&&(n=R.objectHash[e.id].policy),P._getMaturityStatesAttributes(n,P._tenantId,P._securityContext)})).then((function(e){return P._statesData=e,P._getAllowedSemanticsPromise(i,P._context,{nlsintents:!0,scope:"branch"},a)})).then((function(t){if(x.isAnyEffectivityBasedMode(e.id,t)&&!P.revisionMode){let n=x.getRevisionMode(e.id,t);P.setRevisionMode(n)}P.intents=[];var n=0;if(t.intents&&t.allowedSemantics&&t.allowedSemantics.length>0&&t.allowedSemantics[0].semantic&&t.allowedSemantics[0].semantic.length>0){for(var i=0;i<t.intents.length;i++)switch(P.isEffectivityBasedModeOrEffectivityBasedReuseMode()&&(t.allowedSemantics[0].semantic=["E","D","LAST","R"],M.length>0&&(t.allowedSemantics[0].semantic=M)),t.intents[i].short){case"S":case"F":case"D":t.allowedSemantics[0].semantic.find((function(e){return t.intents[i].short===e}))&&(n++,P.intents[t.intents[i].short]=t.intents[i].title);break;case"R":if(P.isEffectivityBasedModeOrEffectivityBasedReuseMode())t.allowedSemantics[0].semantic.find((function(e){return t.intents[i].short===e}))&&(n++,P.intents[t.intents[i].short]=t.intents[i].title)}n<2&&!P.isEffectivityBasedModeOrEffectivityBasedReuseMode()&&(P.intents=[])}a._isODT||X.unmask(),P.refreshView&&X.displayView(e.reframe),P._currentVersion=e.id,"function"==typeof c&&c(e)})).catch((e=>{P._widget&&P._widget.data&&P._widget.data.TemporaryPropertiesWidget&&X.cleanup(),P._widget&&P._widget.lifecycleWidget&&P._widget.lifecycleWidget.empty(),Y(e)}))}("SystemModel.SystemContentType")}),void 0,void 0,l)}))},_setActiveVersion:function(t){var n;if(t.treeNode)n=t.treeNode;else if(t.id){var i=R.searchByID(t.id);1===i.length&&(n=i[0])}if(R.prepareAddDelete(),R.setAttributeAll("__isActive__",!1),n){var o;if(R.setAttribute(n,"__isActive__",!0),P._activeVersion=n.options.id,void 0!==n.options&&void 0!==n.options.label&&void 0!==n.options.label){var r={};n.options.eStrings&&(r=n.options.eStrings),!0===r[n.options.label]&&(o=e.String.unescapeHTML(n.options.label))}X.setTitle(o)}R.pushAddDelete()},_displayNewVersionDialog:function(e){var t;if(e.treeNode)t=e.treeNode;else if(e.id){var n=R.searchByID(e.id);1===n.length&&(t=n[0])}t&&r.displayDialog({dataModelType:R._DATA_MODEL_TYPE,defaultName:R.getNewVersionName(),derivedFrom:{id:t.options.id,name:t.options.grid.title},parentContainer:V,onOK:function(e,n,i){j({title:e,description:n,parent:t,versionSemantic:i},(function(e){P.publishEvent("ENOXVersionExplorerNewVersionCreated",e)}))}})},_showWhereUsed:function(e){if(null!==R.webToWinComSocket&&void 0!==R.webToWinComSocket)return N.fireWintopCommand(R.webToWinComSocket,e,"CATRelNavWebInWinCmdHdr"),void N.closePanel(R.webToWinComSocket);var n=m.getTenant(),i=require("DS/PADUtils/PADCommandProxy").create();require(["DS/PADUtils/PADUtilsServices"],(function(o){var r=[];r.push({envId:n,serviceId:e.serviceId,contextId:e.contextId,objectId:e.id,objectType:e.type,displayName:e.displayName});var s={protocol:"3DXContent",version:"1.0",source:"ENOSTDE_AP",data:{items:r}},a={attributes:{},paths:[],version:"1.1"},d=new t.Socket("compassPageSocket");d.subscribeServer("com.ds.compass",window.parent),d.dispatchEvent("onSetX3DContent",s,"compassPageSocket"),d.addListener("launchApp",(function(e){i.select(a),i.destroy(),console.log("Response = "+JSON.stringify(e))})),d.dispatchEvent("onLaunchApp",{appId:"ENORIPE_AP"},"compassPageSocket")}))},_getMainBranchAttribute:e=>R.mainBranchRoot?R.mainBranchRoot[e]:"",_isMaturityButtonDisabled:()=>T,_isFromWebInWinWrapper:()=>L,getRoots:()=>R.getRoots(),refreshListViewColumns(){R&&R._GraphListView&&(R._GraphListView.prepareUpdateColumns(),R._GraphListView.pushUpdateColumns())},saveCustomizedColumns(){for(var e={code:"revision",creationDate:"created",ownerName:"owner",maturity_nls:"maturity",project_nls:"project",policy_nls:"policy",organization_nls:"organization",type_nls:"type",reservedbyName:"reservedby"},t=[],n=X._subwayGraphView.getColumnManager()._listView.layout,i=0,o=n._balancedColumnTree.length;i<o;i++){var r=n._balancedColumnTree[i].dataIndex;if(0==n._balancedColumnTree[i].isHidden)if(!n._balancedColumnTree[i].alwaysOn||"tree"===r||"__BranchTitle__"===r){var s=void 0===e[r]?r:e[r];t.push(s)}}X._subwayGraphView.getColumnManager().arrangeColumns(t),U.save(t)},_setUseWebCommandsOnNative(){var e=!1;if(this._isWebInWinMode()){var t=this._getMainBranchAttribute("type");if(""===t){var n=this.getSelectedNodes();n.length>0&&(t=n[0].options.grid.type)}if("xRevisionElement"===t&&(e=!0),1!=A)return e;"ConfiguredBaseline"===t&&(e=!0)}return e},_fetchNativeContextMenu:function(e,t,n,i){var o=[],r={displayName:n,id:e,name:n,physicalid:e,revision:i,type:t};o.push(r),N.fetchContextFromSelection(R.webToWinComSocket,o)},_getWebInWinSocket:function(){return R.webToWinComSocket},_isWebInWinMode:function(){return null!==R.webToWinComSocket&&void 0!==R.webToWinComSocket},getFilterHashObject:function(e){return R.filterHash[e]},getFilter:function(e){var t=void 0,n=R.objectHash[e.id];if(n&&n.ancestors){var i=n.ancestors.find((function(e){return e.filterid&&e.hasExpand}));if(i){var o=R.filterHash&&R.filterHash[i.filterid];o&&o.filterQuery&&(t=o.filterQuery.filter)}}return t},_showCompare:function(e,t){if(null===R.webToWinComSocket||void 0===R.webToWinComSocket){var n=m.getTenant(),i=[];if(null!==e&&i.push({envId:n,serviceId:e.serviceId,contextId:e.contextId,objectId:e.id,objectType:e.objectType,displayName:e.displayName,filterSpec:e.filter}),null!==t&&i.push({envId:n,serviceId:t.serviceId,contextId:t.contextId,objectId:t.id,objectType:t.objectType,displayName:t.displayName,filterSpec:t.filter}),i.length>0){var o={envId:n,protocol:"3DXContent",version:"1.0",source:"ENOSTDE_AP",data:{items:i}};require(["DS/TransientWidget/TransientWidget"],(function(e){e.showWidget("ENOCOMP_AP","",{X3DContentId:JSON.stringify(o)},{mode:"transient"})}))}}else N.launchWinCompare(R.webToWinComSocket,e,t)},_displayNewRevisionDialog:function(e){var t;if(e.treeNode)t=e.treeNode;else if(e.id){var n=R.searchByID(e.id);1===n.length&&(t=n[0])}t&&s.displayDialog({defaultName:t.options.grid.title,derivedFrom:{id:t.options.id,name:t.options.grid.title+" "+t.options.grid.code},nextRevision:t.nextRevision,parentContainer:V,onOK:function(e,n){j({title:e,description:n,parent:t,versionSemantic:"E"},(function(e){P.publishEvent("ENOXVersionExplorerNewVersionCreated",e)}))}})},_displayEditDialog:function(t,n,i){var o=new D,r=e.createElement("div",{class:"editDialog_content",styles:{display:"grid","grid-template-columns":"1fr 1fr","margin-top":"5px"}});new e.Element("text",{text:y.branchTitle,class:"branchtitle_label",styles:{"font-weight":"bold","margin-right":"3px"}}).inject(r);var s=new w({value:i});s.getContent().addClassName("branchtitle_input"),s.inject(r);o.createDialog(r,{title:y.editBranchTitle+" - "+n,identifier:"EditBranchTitle",container:widget.elements.wrapper,modalFlag:!0,OKBtnText:y.save,onOk:function(){var e=this.dialog.elements._contentDiv.querySelector(".branchtitle_input input").value;R.setBranchTitlePromise(t,e).then((function(){P.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:!0})})),console.log(e),o.destroy()},onClose:function(){o.destroy()}})},_forceLoad:function(){!0===R.usePersistentColor()&&R._circularColorArray.currentIndex||R._circularColorArray.resetCurrentIndex(),R._forceReset=!0,R.items=null},_app_initialization:function(e){m.app_initialization(e)},_loadAttrs(e,t,n,i,o,r){x.loadAttrs(e,t,n,i,o,r,"Revisions")},_getIsKindOfPromise:(e,t,n)=>b.getIsKindOfPromise(e,t,n),_filterSemantics(e){var t=[];return e.forEach((e=>{"R"!==e&&t.push(e)})),t}}),a._isODT&&e.Class.implement.call(this,{_ODTGetVersionExplorerView:function(){return X},_ODTGetVersionModel:function(){return R}})}})}));