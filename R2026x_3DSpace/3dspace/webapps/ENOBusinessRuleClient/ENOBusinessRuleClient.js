define("DS/ENOBusinessRuleClient/Services",["UWA/Class","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/ENOCollabToolsUI/tracker/ENOCollabTrackerBackEnd"],(function(e,t,n,i){return e.extend({init:function(e){e&&(this.context=e,UWA.is(this.context.tenant)||(this.context.tenant="OnPremise"))},runBusinessRuleForUI:function(e,t,n,s,o){var a={BRInfo:{brID:e},valuate:t},r=e>2?"Properties":"New";i.enrichRequestWithMetrics(a,{UXName:r}),UWA.is(e)&&UWA.is(t)&&this._post(a,{path:"/resources/v1/collabServices/businessrule/op/run"},(function(e){n(e)}),(function(e){s(e)}),(function(e){o(e)}))},_post:function(e,n,i,s,o){var a=JSON.stringify(e),r=n.path+"?tenant="+this.context.tenant,c=this.getHeaders();this.get3DSpaceBaseUrl((function(e){var n=e+r;t.authenticatedRequest(n,{method:"POST",headers:c,timeout:2e3,data:a,type:"json",onComplete:function(e){i(e)},onFailure:function(e){s(e)},onTimeout:function(e){o(e)}})}))},getHeaders:function(){var e={Accept:"application/json","Content-Type":"application/json","Accept-Language":widget.lang},t=this.context.header;for(var n in t)if(UWA.is(n)){var i=t[n];"SecurityContext"===n&&(i=encodeURIComponent(i)),e[n]=i}return e},get3DSpaceBaseUrl:function(e){var t=this;this.baseUrl?e(this.baseUrl):n.getServiceUrl({serviceName:"3DSpace",platformId:t.context.tenant,onComplete:function(n){UWA.is(n)?t.baseUrl=n:console.error("ENOBusinessRuleClient: 3DSpace base URL not found"),e(t.baseUrl)}})}})}));