define("DS/CATFLWidgetProperties/CATFLPropertiesServices",["UWA/Class","UWA/Class/Options","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger"],(function(e,t,i,n,o){"use strict";var r=e.singleton(t,{tenant:null,init:function(e){this._parent(),this._logger=o.getLogger(r)},instance:function(){return this._logger.log("instance"),this},getTenant:function(){return this._logger.log("getTenant"),this.tenant},setTenant:function(e){this._logger.log("setTenant"),this.tenant=e},getInstance:function(e){this._logger.log("getInstance",e);try{this.init(e)}catch(e){}for(var t in e)this.options[t]=e[t];return this},get3DSpaceUrl:function(e){this._logger.log("get3DSpaceUrl",e);var t=location.protocol+"//"+location.hostname,i="3DSpace";return e&&(e.serverUrl=t,e.serverUri=i),t+"/"+i},get3DSpaceBaseUrl:function(e){this._logger.log("get3DSpaceBaseUrl");var t;if(!UWA.is(this.getOption("platform_services"),"array"))throw new Error("Platform services not initialize yet");UWA.is(e)||(e=getTenant());try{for(var i=0;i<this.getOption("platform_services").length;i++)if(this.getOption("platform_services")[i].platformId==e){t=this.getOption("platform_services")[i]["3DSpace"];break}}catch(e){t=this.get3DSpaceUrl()}return t},app_initialization:function(e,t){this._logger.log("app_initialization");var n=this,o=!1;try{UWA.is(this.getOption("platform_services"),"array")||(o=!0)}catch(e){o=!0}o?t?(n.setOption("platform_services",t),e()):(n._logger.log("get Platform Services"),i.getPlatformServices({onComplete:function(t){n.setOption("platform_services",t),void 0!==window.widget&&window.widget&&void 0!==window.widget.getValue("x3dPlatformId")&&window.widget.getValue("x3dPlatformId")&&window.widget.getValue("x3dPlatformId").trim().length>0?n.tenant=window.widget.getValue("x3dPlatformId"):n.tenant=t[0].platformId,e()},onFailure:function(e){throw n._logger.error("Cannot retrieve the Platform Services"),new Error("Cannot retrieve the Platform Services")}})):(n._logger.log("Platform Services already initialized"),e())},getSecurityContext:function(){return this._logger.log("getSecurityContext"),widget.hasPreference("xPref_CREDENTIAL")?widget.getValue("xPref_CREDENTIAL"):widget.hasPreference("security_ctx")?widget.getValue("security_ctx"):widget.getValue("securityContext")}});return r})),define("DS/CATFLWidgetProperties/facets/CATFLSpecificationDocumentFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/Logger/Logger","DS/EditPropWidget/facets/Common/FacetsBase","DS/CATFLWidgetProperties/CATFLPropertiesServices","i18n!DS/CATFLWidgetProperties/assets/nls/CATFLProperties.json","css!DS/CATFLWidgetProperties/CATFLWidgetProperties.css"],(function(e,t,i,n,o,r,s,a){"use strict";var c=i.extend(o,{init:function(e){this._logger=n.getLogger(c),this._parent(e),this.buildView()},buildView:function(){this._logger.log("buildView");var t=this;t.elements.container=e.createElement("div",{class:"relatedDocuments_spec"}),t.multiselDisplay=e.createElement("div",{class:"notSupported"}).inject(t.elements.container),t.iconHolder=e.createElement("span",{class:"blockIcon"}).inject(t.multiselDisplay),t.infoMsgH2Tag=e.createElement("h2",{class:"information_msg"}).inject(t.multiselDisplay),t.multiselDisplay.hide()},initSpecificationsPane:function(){this._logger.log("initSpecificationsPane");var e=this;require(["DS/ENOXSpecificationsUX/SpecificationsPane","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],(function(t,i){var n=e.getModel()?e.getModel().getTenant():r.getTenant(),o={parentObject:{},connectorOptions:{fetchSecurityContext:function(){return r.getSecurityContext()},getWorkUnderHeaders:function(){if(i){var e=i.get();return e&&e.change&&""!==e.change.id?{"DS-Change-Authoring-Context":"pid:"+e.change.id}:{}}},platformUrls:{"3DSpace":r.get3DSpaceBaseUrl(n),platformId:n},webinwin:!1},supportedTypes:{includedTypes:["Document"]}};e.getModelID()&&(o.parentObject.parentId=e.getModelID()),e.documentsPane=new t(o),e.documentsPane.modelEvents.subscribe({event:"upload-attachment-complete"},e.refreshNode.bind(e)),e.documentsPane.modelEvents.subscribe({event:"attach-attachment-complete"},e.refreshNode.bind(e)),e.documentsPane.modelEvents.subscribe({event:"detach-attachment-complete"},e.refreshNode.bind(e)),e.elements.container.appendChild(e.documentsPane.elements.container),e.multiselDisplay.isHidden()||e.documentsPane.hide()}),(function(){e._logger.warn("require of DS/ENOXSpecificationsUX/SpecificationsPane failed"),e.notApplicable()}))},refreshNode:function(e){this._logger.log("refreshNode",e);var t=this;require(["DS/PADUtils/PADCommandProxy"],(function(i){var n={authored:{modified:[t.getModelID()],documentdata:e}},o=i.create();o.authored({authored:!0}),o.refresh(n),o.destroy()}))},getModelID:function(){return this.getModel().get("objectId")},isRelationship:function(){return"relationship"===this.getModel().get("metatype")},updateFacet:function(){this._logger.log("updateFacet");var e=this;if(!e.getModel())return this.notApplicable(),!1;var t=e.getModelID();if(!t||e.isRelationship())return this.notApplicable(),!1;e.multiselDisplay.hide(),e.documentsPane?(e.documentsPane.show(),e.documentsPane.options.parentObject.parentId!==t&&e.documentsPane.setParentObject({parentId:t})):r.app_initialization(e.initSpecificationsPane.bind(e))},destroyComponent:function(){this._logger.log("destroyComponent"),e.is(this.destroy,"function")&&this.destroy()},notApplicable:function(){this._logger.log("notApplicable");var e=this;e.infoMsgH2Tag.setText(s.msg_not_supported_selection),e.iconHolder.addClassName("wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-block"),e.multiselDisplay.show(),e.documentsPane&&e.documentsPane.hide()},onResize:function(){this._logger.log("onResize")},onRefresh:function(){this._logger.log("onRefresh"),this.updateFacet()}});return c})),define("DS/CATFLWidgetProperties/facets/CATFLAttachementFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/Logger/Logger","DS/EditPropWidget/facets/Common/FacetsBase","DS/CATFLWidgetProperties/CATFLPropertiesServices","i18n!DS/CATFLWidgetProperties/assets/nls/CATFLProperties.json","css!DS/CATFLWidgetProperties/CATFLWidgetProperties.css"],(function(e,t,i,n,o,r,s,a){"use strict";var c=i.extend(o,{init:function(e){this._logger=n.getLogger(c),this._parent(e),this.buildView(e)},buildView:function(t){this._logger.log("buildView");var i=this;i.elements.container=e.createElement("div",{class:"relatedDocuments"}),i.multiselDisplay=e.createElement("div",{class:"notSupported"}).inject(i.elements.container),i.iconHolder=e.createElement("span",{class:"blockIcon"}).inject(i.multiselDisplay),i.infoMsgH2Tag=e.createElement("h2",{class:"information_msg"}).inject(i.multiselDisplay),i.multiselDisplay.hide()},initAttachmentsPane:function(){this._logger.log("initAttachmentsPane");var e=this;require(["DS/ENOXAttachmentsUX/AttachmentsPane","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],(function(t,i){var n=e.getModel()?e.getModel().getTenant():r.getTenant(),o={parentObject:{},connectorOptions:{fetchSecurityContext:function(){return r.getSecurityContext()},getWorkUnderHeaders:function(){if(i){var e=i.get();return e&&e.change&&""!==e.change.id?{"DS-Change-Authoring-Context":"pid:"+e.change.id}:{}}},platformUrls:{"3DSpace":r.get3DSpaceBaseUrl(n),platformId:n},webinwin:!1},supportedTypes:{includedTypes:["Document"]}};e.getModelID()&&(o.parentObject.parentId=e.getModelID()),e.documentsPane=new t(o),e.elements.container.appendChild(e.documentsPane.elements.container),e.multiselDisplay.isHidden()||e.documentsPane.hide()}),(function(){e._logger.warn("require of DS/ENOXSpecificationsUX/SpecificationsPane failed"),e.notApplicable()}))},refreshNode:function(e){this._logger.log("refreshNode",e);var t=this;require(["DS/PADUtils/PADCommandProxy"],(function(i){var n={authored:{modified:[t.getModelID()],data:e}},o=i.create();o.authored({authored:!0}),o.refresh(n),o.destroy()}))},getModelID:function(){return this.getModel().get("objectId")},isRelationship:function(){return"relationship"===this.getModel().get("metatype")},updateFacet:function(){this._logger.log("updateFacet");var e=this;if(!e.getModel())return this.notApplicable(),!1;var t=e.getModelID();if(!t||e.isRelationship())return this.notApplicable(),!1;e.multiselDisplay.hide(),e.documentsPane?(e.documentsPane.show(),e.documentsPane.options.parentObject.parentId!==t&&e.documentsPane.setParentObject({parentId:t})):r.app_initialization(e.initAttachmentsPane.bind(e))},destroyComponent:function(){this._logger.log("destroyComponent"),e.is(this.destroy,"function")&&this.destroy()},notApplicable:function(){var e=this;e.infoMsgH2Tag.setText(s.msg_not_supported_selection),e.iconHolder.addClassName("wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-block"),e.multiselDisplay.show(),e.documentsPane&&e.documentsPane.hide()},onResize:function(){this._logger.log("onResize")},onRefresh:function(){this._logger.log("onRefresh"),this.updateFacet()}});return c}));