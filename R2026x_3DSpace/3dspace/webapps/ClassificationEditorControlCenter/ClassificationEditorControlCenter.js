define("DS/ClassificationEditorControlCenter/utils/ControlCenterAlerts",["require","exports","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],(function(e,t,i,r){"use strict";return class{static displayNotification(e){let t=i;r.setNotificationManager(t),r.setStackingPolicy(5),t.addNotif({allowUnsafeHTML:!0,level:e.className,title:e.title,subtitle:e.subtitle,message:e.message,sticky:!!e.sticky&&e.sticky,poNotifId:e.poNotifId})}}})),define("DS/ClassificationEditorControlCenter/services/PlatformServices",["require","exports","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","UWA/Core"],(function(e,t,i,r){"use strict";class o{static initializePlatformServicesIdentifiers(){var e=this;return new Promise(((t,r)=>{i.getPlatformServices({onComplete:i=>{let r=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise";Array.isArray(i)?e.platformServices=i.find((e=>e.platformId==r)):e.platformServices=i,console.log("Platform Services URLs initialized"),t()},onFailure:t=>{e.platformServices=null,r(),console.error(`Error retrieving Platform Services: ${t}`)}})}))}static _getPlatformServiceURL(e){let t="";return r.owns(this.platformServices,e)&&(t=this.platformServices[e]),t}static getPlatformServices(){return this.platformServices}static get3DSpaceURL(){return this._getPlatformServiceURL(o.SERVICE_3DSPACE)}static get3DSearchURL(){return this._getPlatformServiceURL(o.SERVICE_3DSEARCH)}static get3DCompassURL(){return this._getPlatformServiceURL(o.SERVICE_3DCOMPASS)}static get3DPassportURL(){return this._getPlatformServiceURL(o.SERVICE_3DPASSPORT)}static get3DDashboardURL(){return this._getPlatformServiceURL(o.SERVICE_3DDASHBOARD)}static get3DSwymServiceUrl(){return this._getPlatformServiceURL(o.SERVICE_3DSWYM)}static getPlatformId(){return this._getPlatformServiceURL(o.KEY_TENANT)}}return o.SERVICE_3DSPACE="3DSpace",o.SERVICE_3DCOMPASS="3DCompass",o.SERVICE_3DSEARCH="3DSearch",o.SERVICE_3DPASSPORT="3DPassport",o.SERVICE_3DDASHBOARD="3DDashboard",o.SERVICE_3DSWYM="3DSwym",o.KEY_TENANT="platformId",o})),define("DS/ClassificationEditorControlCenter/services/ClassificationControlCenterWebServices",["require","exports","DS/ClassificationEditorControlCenter/services/PlatformServices","DS/WAFData/WAFData"],(function(e,t,i,r){"use strict";return class{static async getCCmUserList(){let e={method:"GET",timeout:12e4,headers:{Accept:"application/json","content-type":"application/json"}};const t=i.get3DSpaceURL()+"/resources/ipclassification/controlcenter/fetchdata?tenant="+i.getPlatformId();try{return await this.callServiceRequest(t,e)}catch(e){throw e}}static async updateCCMUserOrExpression(e){let t={method:"POST",timeout:12e4,headers:{Accept:"application/json","content-type":"application/json"}};var r=i.get3DSpaceURL()+"/resources/ipclassification/controlcenter/updatedata?tenant="+i.getPlatformId();e.userId&&e.permission?t.data={userId:e.userId,permission:e.permission}:t.data={isPermissionRestrictionEnabled:e.isPermissionRestrictionEnabled},t.data=JSON.stringify(t.data);try{return await this.callServiceRequest(r,t)}catch(e){throw e}}static callServiceRequest(e,t){return new Promise(((i,o)=>{t.onComplete=e=>{i(e)},t.onFailure=(e,t)=>{o(t)},r.authenticatedRequest(e,t)}))}}})),define("DS/ClassificationEditorControlCenter/utils/UIUtils",["require","exports","DS/TreeModel/BaseFilter","DS/ClassificationEditorControlCenter/services/PlatformServices","i18n!DS/ClassificationEditorControlCenter/assets/ClassificationEditorControlCenter"],(function(e,t,i,r,o){"use strict";return class{constructor(){this.isSearchActive=!1}setTreeNodeModel(e){this.treeNodeModel=e}getTreeNodeModel(){return this.treeNodeModel}setGeneratedToolbar(e){this.generatedToolbar=e}getGeneratedToolbar(){return this.generatedToolbar}getColoumns(){return[{dataIndex:"userList",text:o.get("CCM_Manager"),pinned:"left",typeRepresentation:"user",editableFlag:!1},{dataIndex:"Specialist",text:o.get("CCM_specialist_title"),typeRepresentation:"radio",editionPolicy:"EditionInPlace"},{dataIndex:"Expert",text:o.get("CCM_expert_title"),typeRepresentation:"radio",editionPolicy:"EditionInPlace"},{dataIndex:"Architect",text:o.get("CCM_architect_title"),typeRepresentation:"radio",editionPolicy:"EditionInPlace"}]}getToolbarEntries(){var e=this;return this.model={entries:[{id:"SearchTextBox",dataElements:{typeRepresentation:"string",allowResetToUndefinedByUIFlag:!0,label:"Search",tooltip:"Search",position:"far",category:"1",placeholder:o.get("search_name"),onNodeLiveUpdate(t,i){e.performSearch(i)},visibleFlag:!1}},{id:"SearchToggle",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"search",fontIconFamily:1},label:"Search",tooltipInfos:{title:o.get("search"),shortHelp:o.get("search_short_help")},position:"far",category:"1",value(){e.setSearchInputBox()},visibleFlag:!0}}]},this.model}buildUserIcon(e){var t=this;e.forEach((e=>{"userList"==e.dataIndex&&(e.getCellValue=e=>{var i,r,o=e.nodeModel.options.grid.userId,s=e.nodeModel?e.nodeModel.options.grid.userList:void 0;return o&&(i=t.__getUserThumbnailURL(o)),null!=i?r={icon:{iconPath:"url("+i+")",className:"dgv-user-thumbnail"},label:s}:s&&(r={icon:undefined,label:s}),r})}))}__getUserThumbnailURL(e){var t,i=r.get3DSwymServiceUrl();return null!=i&&""!=i&&(t=i+"/api/user/getpicture/login/"+e),t}performSearch(e){var t=i.inherit({publishedProperties:{},isDataFiltered:function(e){if(this.filterModel&&this.filterModel.query){var t=this.filterModel.query.toLowerCase();return!e.options.grid.userList.toLowerCase().contains(t)}return!1},isEmpty:function(){return!this.filterModel||void 0===this.filterModel.query}}),r=this.getTreeNodeModel().getFilterManager();r.registerFilter("superFilter",t),"string"==typeof e&&e.trim().length>0?r.setPropertyFilterModel("superFilter",{filterId:"superFilter",filterModel:{query:e}}):r.setPropertyFilterModel("superFilter",{filterId:"superFilter"})}setSearchInputBox(){var e=this;e.isSearchActive?(e.isSearchActive=!1,e.toggleSearch(!1)):(e.isSearchActive=!0,e.toggleSearch(!0))}toggleSearch(e){if(this.getGeneratedToolbar().updateNodeModel("SearchTextBox",{visibleFlag:e}),!e)for(let e=0;e<this.model.entries.length;e++)"SearchTextBox"===this.model.entries[e].id&&(this.model.entries[e].grid.data="",this.model.entries[e].onNodeLiveUpdate(""))}}})),define("DS/ClassificationEditorControlCenter/utils/ControlCenterUIComponents",["require","exports","DS/Controls/Toggle","DS/Controls/ButtonGroup","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","i18n!DS/ClassificationEditorControlCenter/assets/ClassificationEditorControlCenter","UWA/Core","DS/ClassificationEditorControlCenter/services/ClassificationControlCenterWebServices","DS/ClassificationEditorControlCenter/utils/UIUtils","DS/Tweakers/GeneratedToolbar","DS/ClassificationEditorControlCenter/utils/ControlCenterAlerts","DS/IPClassifyUtil/IPClassifyUtility"],(function(e,t,i,r,o,s,n,a,l,c,d,C,u,h){"use strict";return class{constructor(){this.data=[],this.isUpdateCCMUserInProgress=!1,this.uiUtils=new d}buildGeneratedToolbar(e){var t=this.uiUtils.getToolbarEntries(),i=C.prototype.createTreeDocument(t),r=new C({overflowManagement:"dropdown",direction:"horizontal",items:i});r.inject(e),this.uiUtils.setGeneratedToolbar(r)}buildGridView(e,t){for(var i=this,r=0;r<t.length;r++){var a="Specialist"===t[r].permission,l="Expert"===t[r].permission,c="Architect"===t[r].permission;this.data.push({userId:t[r].userId,userList:t[r%t.length].fullName,Specialist:a,Expert:l,Architect:c})}var d=this.uiUtils.getColoumns(),C=new o;C.prepareUpdate();r=0;for(var u=this.data.length;r<u;r++){var h=this.data[r],p=new s({label:h.tree,grid:h});C.addChild(p)}C.expandAll(),C.pushUpdate(),this.uiUtils.setTreeNodeModel(C),this.uiUtils.buildUserIcon(d),this.switchUserPermission(C),C.setFilterModel({Specialist:{filterId:"set"},Expert:{filterId:"set"},Architect:{filterId:"set"},superFilter:{filterId:"superFilter"}}),this.dataGridView=new n({identifier:"controlCenterDataGridView",treeDocument:C,domId:"controlCenterDataGridViewDomId",columns:d,defaultColumnDef:{width:150,minWidth:40,editableFlag:!0,dataIndex:"",typeRepresentation:""},showRowIndexFlag:!1,showSelectionCheckBoxesFlag:!1,layoutOptions:{rowsHeader:!1},onContextualEvent:e=>{var t=[];if(e&&e.collectionView&&-1===e.cellInfos.rowID){t=e.collectionView.buildDefaultContextualMenu(e,{pin:!0,firstColumnsVisibility:!1,columnsManagement:!1,sizeColumnToFit:!0,insertRow:!0})}return t}});let g=widget.getValue("controlCenter_UserList_sort");if(null==g||null==g)this.applySort({data:[{sort:"asc",dataIndex:"userList"}]});else{let e=JSON.parse(g);this.applySort(e)}return this.isRestrictionEnabled||(this.dataGridView.elements.container.style.pointerEvents="none",this.dataGridView.elements.container.style.opacity="0.5"),this.dataGridView.inject(e),this.setModelProperty(C),this.dataGridView.addEventListener("sortModelChange",(function(){i.sortColumn()})),this.dataGridView}setModelProperty(e){this.localModel=e}getModelProperty(){return this.localModel}applySort(e){this.dataGridView.sortModel=e.data,this.dataGridView.reapplySortModel()}sortColumn(){let e=this.dataGridView.sortModel,t=JSON.stringify(e);widget.setValue("controlCenter_UserList_sort",t)}buildToggleButton(e,t){var o=new r({type:"checkbox"});this.restrictionButton=new i({label:a.get("toolbar_header"),type:"switch",value:0,checkFlag:t}),o.addChild(this.restrictionButton),this.isRestrictionEnabled=t;var s=l.createElement("div",{class:"ControlCenterToolbarCommandsContainer"}).inject(e);o.inject(s),this.toggleRestrictionButton()}switchUserPermission(e){const t=["Specialist","Expert","Architect"];e.onNodeModelUpdate((e=>{const i=e.data.nodeModel;if(i){const r=e.data.attributes,o={userId:e.data.nodeModel.options.grid.userId,permission:Object.keys(r)[0]};Object.keys(r).forEach((e=>{i.getAttributeValue(e)&&t.forEach((t=>{t!==e&&(i.setAttribute(t,!1),this.isUpdateCCMUserInProgress||this.updateUserPermission(o))}))}))}}))}async updateUserPermission(e){this.isUpdateCCMUserInProgress=!0;try{h.sendTrackerPageEvent("ClassificationEditor_ControlCenter",e.permission);const t=await c.updateCCMUserOrExpression(e);let i=JSON.parse(t);const{userName:r,permission:o}=i;this.displayNotification("permission_update_successful","success",{name:r,updatedPermission:o})}catch(e){this.displayNotification("permission_update_failure","error")}finally{this.isUpdateCCMUserInProgress=!1}}toggleRestrictionButton(){this.restrictionButton.addEventListener("change",(e=>{this.toggleGridViewInteractivity(this.restrictionButton.checkFlag),this.updateRestrictionStatus(this.restrictionButton.checkFlag)}))}toggleGridViewInteractivity(e){const t=this.dataGridView.elements.container;t.style.pointerEvents=e?"auto":"none",t.style.opacity=e?"1":"0.5"}async updateRestrictionStatus(e){e?h.sendTrackerPageEvent("ClassificationEditor_ControlCenter","Restriction button Enabled"):h.sendTrackerPageEvent("ClassificationEditor_ControlCenter","Restriction button Disabled");const t={isPermissionRestrictionEnabled:e};try{const e=await c.updateCCMUserOrExpression(t),i="true"===JSON.parse(e).isPermissionRestrictionEnabled?a.get("on"):a.get("off");this.displayNotification("restriction_mode_switched","success",{restrictionToggle:i})}catch(e){this.displayNotification("restriction_mode_switched","error")}}displayNotification(e,t,i){const r=i?a.replace(a.get(e),i):a.get(e);u.displayNotification({message:r,className:t})}}})),define("DS/ClassificationEditorControlCenter/dataProvider/ControlCenterContentProvider",["require","exports","DS/ClassificationEditorControlCenter/utils/ControlCenterUIComponents","DS/ClassificationEditorControlCenter/services/ClassificationControlCenterWebServices","DS/ClassificationEditorControlCenter/utils/ControlCenterAlerts","DS/Controls/Loader","DS/Controls/ModalContainer","i18n!DS/ClassificationEditorControlCenter/assets/ClassificationEditorControlCenter"],(function(e,t,i,r,o,s,n,a){"use strict";return class{getDataGridView(){return this.dataGridView}buildWidgetUI(e,t){this._getControlCenterUserData().then((r=>{for(var o=[],s=0;s<r.classificationManagerInfo.length;s++){var n=r.classificationManagerInfo[s];console.log(n),o.push({userId:n.userId,fullName:n.fullName,permission:n.permission})}let a=new i;a.buildToggleButton(t,r.isPermissionRestrictionEnabled),this.dataGridView=a.buildGridView(e,o),a.buildGeneratedToolbar(t)})).catch((e=>{console.log(e)}))}async _getControlCenterUserData(){try{let e=(new s).inject(widget.body.globalLoaderContainer);n.createModal(widget.body.globalLoaderContainer,e.elements.container),e.on(a.get("loading"));const t=await r.getCCmUserList(),i=JSON.parse(t);return n.removeModal(widget.body.globalLoaderContainer),e.off(a.get("loading")),i}catch(e){throw o.displayNotification({message:e,className:"error"}),e}}}})),define("DS/ClassificationEditorControlCenter/ClassificationEditorControlCenter",["require","exports","UWA/Core","DS/Windows/ImmersiveFrame","DS/ClassificationEditorControlCenter/dataProvider/ControlCenterContentProvider","DS/ClassificationEditorControlCenter/services/PlatformServices","css!DS/ClassificationEditorControlCenter/ClassificationEditorControlCenter.css"],(function(e,t,i,r,o,s){"use strict";return class{constructor(){}init(e){this.widget=e,e.body.empty(),this._buildSkeleton(),this.widget.addEvent("onRefresh",this.onRefresh.bind(this))}onRefresh(){this._buildSkeleton()}_buildSkeleton(){s.initializePlatformServicesIdentifiers().then((()=>{let e=new i.Element("div",{class:"ClassificationEditorControlCenter-container",style:{"vertical-align":"top"}});this.widget.body.empty(),e.inject(this.widget.body);let t=new r;t.inject(e);let s=this.widget.body.container=i.createElement("div",{class:"ClassificationEditorControlCenter_global_container"}).inject(t.getFreeZone(),"top");this.widget.body.globalLoaderContainer=i.createElement("div",{class:"ClassificationEditorControlCenter_global_loader"}).inject(this.widget.body.container);let n=i.createElement("div",{class:"ControlCenterToolbarContainer"}).inject(s),a=i.createElement("div",{class:"dataGridViewContainer"}).inject(s);this.contentProvider=new o,this.contentProvider.buildWidgetUI(a,n)}))}getDataProvider(){return this.contentProvider}}}));