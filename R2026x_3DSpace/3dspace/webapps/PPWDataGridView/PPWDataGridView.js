define("DS/PPWDataGridView/RecursiveGrouping",["UWA/Core","UWA/Class","DS/PPWTreeNodeModel/PPWTreeNodeModel","i18n!DS/PPWDataGridView/assets/nls/ContextualMenu.json"],(function(e,t,i,n){"use strict";var o,r,a,l,s,u,d,c,p,h,g,f,_,m,v,w,y,C,V;return o=function(t){var n=!1;return e.is(t)&&e.is(t.getNodeSource,"function")&&(n=t.getNodeSource()===i.NODE_SOURCE.GROUPING),n},r=function(e){return-1===e.getNodeDepth()?e.getNodeDepth():e.getParents().filter((e=>!o(e))).length},a=function(t,i){this.rowGroupingOptions.maxDepth=e.is(i)&&i?void 0:t,this.rowGroupingOptions.depth=function(e){return e>=this}.bind(t)},l=function(t,i){var n;switch(t){case"date":n=e.is(i,"number")?i:Date.parse(i),isNaN(n)||(i=new Date(n));break;case"number":case"integer":case"float":n=isNaN(i)?i:parseFloat(i);break;default:n=i}return n},s=function(t){var i,n;i=(t=t||{}).onDropCell,t.onDropCell=function(t,n){var r,a,s,u,d,c,p=this,h=[];if(e.is(n.nodeModel)&&o(n.nodeModel))a=(r=n.nodeModel).getProperty(),u=p.layout.getColumnIndex(a),c=p.layout.getColumnOptionValue(u,"setCellValueBulk"),e.is(c,"function")&&(s=r.getIdentifier(),(Array.isArray(n.droppedNodes)?n.droppedNodes:[]).forEach((t=>{var i,n,o,r;i=t._getRowID(),Number.isInteger(i)&&i>-1&&Number.isInteger(u)&&u>-1&&(n=p.layout.getCellIDFromCoordinates({rowID:i,columnID:u}))&&p.getCellEditableState(n)&&(o=p.getCellInfosAt(n),h.push(o),e.is(d)||(r=p.layout._getCellTypeRepresentation({cellID:n,columnID:u,rowID:i,cellModel:s,nodeModel:t}),d=l(r,s)))})),h.length>0&&c.call(p,h,d));else{if(!e.is(i,"function"))return!1;i.call(this,t,n)}},n=t.onDragOverCell,t.onDragOverCell=function(t,i){var r,a,l=this,s=!0;return e.is(i.nodeModel)&&o(i.nodeModel)?(r=i.nodeModel,a=r.getProperty(),(Array.isArray(i.draggedNodes)?i.draggedNodes:[]).some((e=>{var t,i,n,o,r=!0;return t=l.layout,i=e._getRowID(),n=t.getColumnIndex(a),i&&n&&(o=t.getCellIDFromCoordinates({rowID:i,columnID:n}))&&(r=l.getCellEditableState(o)),!r}))||t.preventDefault(),s=!0):s=!e.is(n,"function")||n.call(this,t,i),s}},u=function(t){var i,n;n=function(t){var n,r,a,l,s="N/A",u=function(t){var i,n,r=t.getChildren();if(Array.isArray(r)&&r.length>0)for(i=0;i<r.length&&(n=o(r[i])?u(r[i]):r[i],!e.is(n));i++);return n};return e.is(t)&&o(t)?(r=t.getProperty(),a=u(t),n=this.layout.getColumnOptionValue(r,"getGroupingNodeLabel"),e.is(n,"function")?s=n.call(this,t,r):e.is(a)&&(l=t.getOriginalChildrenInformation().notHiddenNotFilteredChildrenCount,s=e.is(i,"function")?i.call(this,t):this.layout.getColumnOptionValue(r,"text")+": "+t.getIdentifier()+" ("+l+")")):e.is(i,"function")&&(s=i.call(this,t)),s},(t=t||{}).rowGroupingOptions=t.rowGroupingOptions||{},i=t.rowGroupingOptions.getGroupingNodeLabel,t.rowGroupingOptions.getGroupingNodeLabel=n.bind(this._dgv)},d=function(){return[{iconName:"group"}]},c=function(t,i,n){return e.is(n)||(n=t.getTreeDocument()._getTrueRoot()),-1===n._propertiesToGroup.indexOf(i)?"unselected":"selected"},C=function(t,n){e.is(n)||(n=this.getTreeDocument()._getTrueRoot()),n._propertiesToGroup=t,n.getAllDescendants().forEach((function(e){e.getNodeSource()===i.NODE_SOURCE.MODEL&&(e._propertiesToGroup=t)}))},p=function(t,n){var o,l,s;if(s=e.is(n)?n:this.getTreeDocument()._getTrueRoot(),e.is(this._rowModel)){"clear"===t?(s._propertiesToGroup=[],o="clear"):((l=s._propertiesToGroup.indexOf(t))>-1?s._propertiesToGroup.splice(l,1):s._propertiesToGroup.push(t),o=-1===l?"add":"remove"),s.getAllDescendants().forEach((function(e){var n;if(e.getNodeSource()===i.NODE_SOURCE.MODEL)switch(n=e._propertiesToGroup.indexOf(t),o){case"add":n<0&&e._propertiesToGroup.push(t);break;case"remove":(n=e._propertiesToGroup.indexOf(t))>-1&&e._propertiesToGroup.splice(n,1);break;case"clear":e._propertiesToGroup=[]}}));let u=e.is(n)?r(n)+1:0;a.call(this,u,"clear"===t),this.groupRows({dataIndexesToGroup:s._propertiesToGroup,ignorePreprocess:!0})}},h=function(t){var i=t.target;if(!o(i)&&Array.isArray(i._propertiesToGroup)&&i._propertiesToGroup.length>0&&!(i._appliedGroupingProps.join(",")===i._propertiesToGroup.join(","))){let t=e.is(i)?r(i)+1:0;a.call(this,t),this.groupRows({dataIndexesToGroup:i._propertiesToGroup,ignorePreprocess:!0})}},y=function(t){var i,n,o,l,s=this,u={},d=Number.MAX_VALUE;t.forEach((function(t){i=t.target,n=t.nodeModel,e.is(i)&&e.is(n)&&Array.isArray(i._propertiesToGroup)&&i._propertiesToGroup.length>0&&(l=r(i),t.event&&"update"===t.event?(o=Array.from(i._propertiesToGroup),a.call(s,l+1),i._propertiesToGroup=[],s.groupRows({dataIndexesToGroup:[],ignorePreprocess:!0}),i._propertiesToGroup=o,s.groupRows({dataIndexesToGroup:o,ignorePreprocess:!0})):(u[l]=u[l]||[],u[l].push(i),l<d&&(d=l)))})),Object.keys(u).length>0&&(a.call(s,parseInt(d)+1),s.reapplyRowGrouping())},g=function e(t){let i=t.getParent();return o(i)?e(i):i},f=function(){this._transactionCounter++,null===this._transactions&&(this._transactions=[])},_=function(){var e;this._transactionCounter--,0===this._transactionCounter&&(e=Array.isArray(this._transactions)?Array.from(this._transactions):[],this._transactions=null,e.length>0&&y.call(this._dgv,e))},m=function(t){var i,n,r;n=t.target,r=t.data.nodeModel,e.is(r)&&!o(r)&&(!e.is(n)||o(n)||n._isGroupingInProgress||Array.isArray(n._propertiesToGroup)&&n._propertiesToGroup.length>0&&(r._propertiesToGroup=e.clone(n._propertiesToGroup),i={event:"addchild",target:n,nodeModel:r},Array.isArray(this._transactions)?this._transactions.push(i):y.call(this._dgv,[i])))},v=function(t){var i,n,r;n=t.target,r=t.data.nodeModel,e.is(n)&&o(n)&&e.is(r)&&!o(r)&&((n=g(n))._isGroupingInProgress||(i={event:"remove",target:n,nodeModel:r},Array.isArray(this._transactions)?this._transactions.push(i):y.call(this._dgv,[i])))},w=function(t){var i,n,r,a,l,s;n=(r=t.data.nodeModel).getParent(),e.is(n)&&o(n)&&e.is(r)&&!o(r)&&(a=t.data.attributes,(s=e.is(a)?Object.keys(a):[]).length>0&&(n=g(n),l=Array.isArray(n._propertiesToGroup)?e.clone(n._propertiesToGroup):[],s.some((e=>{var t="label"===e?"tree":e;return l.indexOf(t)>-1}))&&(i={event:"update",target:n,nodeModel:r},Array.isArray(this._transactions)?this._transactions.push(i):y.call(this._dgv,[i]))))},V=function(){var e;(e=this._dgv.getTreeDocument()).addEventListener("prepareUpdate",f.bind(this)),e.addEventListener("addChild",m.bind(this)),e.addEventListener("removeChild",v.bind(this)),e.addEventListener("pushUpdate",_.bind(this)),e.addEventListener("nodeModelUpdate",w.bind(this))},t.extend({_dgv:null,_transactions:null,_transactionCounter:0,init:function(e){this._dgv=e,this._transactions=null,this._transactionCounter=0},handlePreCreation:function(t){var i;return i=t.rowGroupingOptions||{},i=e.merge(i,{getGroupingNodeIcons:d}),t.rowGroupingOptions=i,u.call(this,t),s.call(this,t),t},handlePostCreation:function(e){this._dgv.getTreeDocument().addEventListener("postExpand",h.bind(this._dgv)),V.call(this),e&&Array.isArray(e.initialDataIndecesToGroup)&&e.initialDataIndecesToGroup.length>0&&this._dgv.groupRows({dataIndexesToGroup:e.initialDataIndecesToGroup})},getGroupByMenu:function(t){var i,o,r=this,a=[],l=[],s=t.collectionView,u=!1,d=t.cellInfos.nodeModel,h=function(t){var i=d;return e.is(i)||(i=r._dgv.getTreeDocument()._getTrueRoot()),i._propertiesToGroup.indexOf(t.dataIndex)>-1},g=function(e){let t=c(s,e.dataIndex,d);return"selected"!==t||u||(u=!0),{type:"CheckItem",title:e.text,state:t,icon:e.icon,action:{callback:p.bind(s,e.dataIndex,d)}}};return i=s.layout.getLeafColumns(),function(){var e;for(o=0;o<i.length;o++)(e=i[s.layout._orderedColumnsIndexes[o]]).groupableFlag&&(!1!==e.visibleFlag||e.defaultGroupable||h(e))&&l.push(g(e))}(),l.length>0&&(a.push({type:"PushItem",id:"GroupBy",title:n.get("ContextualMenu.GroupBy.Title"),icon:{iconName:"group",fontIconFamily:WUXManagedFontIcons.Font3DS},submenu:l}),u&&a.push({type:"PushItem",id:"ClearGroupBy",title:n.get("ContextualMenu.ClearGroupBy.Title"),icon:{iconName:"group-delete",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{callback:p.bind(s,"clear",d)}})),a},doGroupingPreprocess:function(e){var t=e.dataIndexesToGroup,i=e.nodeModel;return C.call(this._dgv,t,i)}})})),define("DS/PPWDataGridView/PPWTweakerUtils",["UWA/Core","DS/Utilities/Utils"],(function(e,t){"use strict";var i,n,o,r,a,l,s,u,d;return o=function(e){return/^-?\d+$/.test(e)},i=function(t,i){return(t.allowedUnits||[]).find((function(t){return e.is(i,"string")&&i.length>0?t.Name===i||t.label===i:t.defaultUnit}))},r=function(t){var i=e.is(t)?t:"",n=[],o=0;for(o=0;o<i.length;o++)if(" "===i[o]){n[0]=t.slice(0,o),n[1]=t.slice(o+1),n[1]=e.is(n[1],"string")?n[1].trim():"";break}return 0===n.length&&n.push(i),n},a=function(e){return 0===(e.allowedUnits||[]).length},n=function(){if(!window)return navigator.language;const e=window.WUX||window.top.WUX;return e&&e.regionalFormatLanguage||navigator.language},d=function(i,o){var r,a="",l=o||{};const s=n(),u=t.getDecimalSeparator(),d=!!e.is(l.preservePrecisionInReadonly)&&l.preservePrecisionInReadonly;var[c,p]=i.toString().split(".");return a=p,r=new Intl.NumberFormat(s).format(c),e.is(p)&&p.length>0&&!d&&(a=`0.${p}`,a=2===(a=(a=new Intl.NumberFormat(s,{maximumFractionDigits:6}).format(a)).split(u)).length?a[1]:p),r+=e.is(a,"string")&&a.length>0?u+a:""},u=function(e,i){var n={number:"",unit:""},a=r(e),l=t.getDecimalSeparator(),s="Integer"===i;if(a&&a.length>0){let e=a[0];e=e.toString().replace(l,"."),""!==e&&(s?n.number=o(e)?e.toString():"":isNaN(Number(e))||(n.number=e.toString())),n.unit=a[1]||""}return n},l=function(t,n){var o,r="";const l=t.integer?"Integer":"Double",s=u(n,l);return e.is(s.number,"string")&&s.number.length>0&&(o=i(t,s.unit),r=s.number,a(t)?s.unit&&(r=""):r=e.is(o)?`${r} ${o.Name}`:"",t.integer&&r.length>0&&(r=parseInt(r).toString())),r},s=function(n,o,r){var l=r||{},s="";const c=l.formatNumber||!1,p=l.translateUnit||!1,h=l.unitAsEntered||!1,g=n.preservePrecisionInReadonly,f=t.getDecimalSeparator();if(e.is(o,"string")&&o.length>0){const t=u(o);if(e.is(t.number,"string")&&t.number.length>0&&(s=c?d(t.number,{preservePrecisionInReadonly:g}):t.number.replace(".",f),!a(n))){const o=i(n,t.unit);if(h&&t.unit.length>0)s+=` ${e.is(o)&&o.label.length>0?o.label:t.unit}`;else if(e.is(o)){const e=p?o.NLSName:o.label;s+=e.length>0?` ${e}`:""}else s=""}}return s},{getMagnitudeValue:function(e,t){return l(e,t)},getMagnitudeValueForDisplay:function(e,t,i){return s(e,t,i)},getValueInSplit:function(e){return r(e)}}})),define("DS/PPWDataGridView/ColumnFiltering",["UWA/Core","UWA/Class"],(function(e,t){"use strict";var i,n,o,r,a;return i=function(){this._transactionCounter++,null===this._transactions&&(this._transactions=[])},n=function(){var e;this._transactionCounter--,0===this._transactionCounter&&(e=Array.isArray(this._transactions)?Array.from(this._transactions):[],this._transactions=null,e.length>0&&r.call(this._dgv,e))},o=function(t,i){var n;n=i.data.nodeModel,e.is(n)&&(Array.isArray(this._transactions)?this._transactions.push(t):r.call(this._dgv,t))},r=function(t){var i,n,o;n=(i=this.getTreeDocument()).getFilterManager(),o=n.filterModel,Object.keys(o).some((t=>e.is(o[t])&&e.is(o[t].filterModel)))&&i.reapplyFilterModel()},a=function(){var e;(e=this._dgv.getTreeDocument()).addEventListener("prepareUpdate",i.bind(this)),e.addEventListener("pushUpdate",n.bind(this)),e.addEventListener("addChild",o.bind(this,"addChild")),e.addEventListener("removeChild",o.bind(this,"removeChild")),e.addEventListener("nodeModelUpdate",o.bind(this,"nodeModelUpdate"))},t.extend({_dgv:null,_transactions:null,_transactionCounter:0,init:function(e){this._dgv=e},handlePostCreation:function(){this.setFilterModel(),a.call(this)},setFilterModel:function(){var t=this,i={};this._dgv.columns.forEach((function(n){var o,r,a,l={};if(e.is(n.filterInfos)){if(o="tree"===n.dataIndex?"label":n.dataIndex,"boolean"===n.filterInfos.type)r="string",l._isBoolean=!0;else r=n.filterInfos.type;(a=n.filterInfos.options)&&(a.getCellValueForFilter&&(a.getCellValueForFilter=a.getCellValueForFilter.bind(t._dgv)),l=e.extend(l,a,!0)),i[o]={filterId:r,filterOptions:l}}})),Object.keys(i).length>0&&this._dgv.treeDocument.setFilterModel(i)}})})),define("DS/PPWDataGridView/PPWDataGridView",["UWA/Core","DS/Utilities/Dom","DS/DataGridView/DataGridView","DS/PPWDataGridView/ColumnFiltering","DS/PPWDataGridView/RecursiveGrouping","i18n!DS/PPWDataGridView/assets/nls/ContextualMenu.json"],(function(e,t,i,n,o,r){"use strict";var a,l,s,u,d,c,p,h,g,f=["Filter","Pin","SizeColumnToFit","Hide","GroupBy"];return p=function(e){var i,n,o,r,a,l=[],s=e.collectionView,u=e.cellInfos&&-1===e.cellInfos.rowID;if(!u&&e.infos&&e.infos.target&&(u=t.firstParentWithClass(e.infos.target,"wux-layouts-header")),u)for(o=(n=s.layout).getLeafColumns(),r=0;r<o.length;r++)i=o[n._orderedColumnsIndexes[r]],a=n.getColumnVisibleFlag(i.dataIndex)?"selected":"unselected",l.push({type:"CheckItem",title:i.text,icon:i.icon,state:n.getColumnAlwaysVisibleFlag(i.dataIndex)?"disabled|"+a:a,action:{callback:function(e){var t;e&&e.context&&e.context.id&&(t=n.getColumnVisibleFlag(e.context.id),n.setColumnVisibleFlag(e.context.id,!t,{isUserInteraction:!0}))},context:{id:i.dataIndex}}});return l},s=function(e){var t,i=[];return(t=p(e)).length>0&&i.push({type:"PushItem",title:r.get("ContextualMenu.DisplayColumns.Title"),icon:{iconName:"eye",fontIconFamily:WUXManagedFontIcons.Font3DS},submenu:t}),i},l=function(e){let t,i,n=this,o=[];return e&&e.cellInfos&&-1===e.cellInfos.rowID&&e.collectionView&&(t=e.collectionView,t._contextualMenuBuilder&&f.forEach((function(r){var a;"Hide"===r?i=s(e):"GroupBy"===r?i=n._recursiveGroupingHelper.getGroupByMenu(e):(a="_create"+r+"ContextualMenu",i=t._contextualMenuBuilder[a](e)),o=o.concat(i)}))),o},u=function(e){var t;return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{expandCollapse:!0})),t},a=function(t,i){var n,o,r=[],a=[];return function(t){var i,n=!1;return e.is(t)&&e.is(t.cellInfos)&&e.is(t.cellInfos.nodeModel)&&e.is(t.collectionView)&&(i=t.collectionView.getTreeDocument(),e.is(i)&&(n=i.isGroupingNodeModel(t.cellInfos.nodeModel))),n}(i)?a=u.call(this,i):(e.is(i.cellInfos)&&(-1===i.cellInfos.rowID?r=l.call(this,i):(n=(o=i.cellInfos.nodeModel).getChildren(),(Array.isArray(n)&&n.length>0||"partiallyExpanded"===o.getState())&&(r=this._recursiveGroupingHelper.getGroupByMenu(i)))),a=e.is(t,"function")&&i.collectionView?t.call(i.collectionView,i,r):r),a},g=function(){const e=this.getTypeRepresentationFactory();e.options.directory.registerTemplates({numberWithUnit:{path:"DS/PPWDataGridView/TweakerPPWMagnitude",options:{}}}),e.options.directory.registerTypeRepresentations({numberWithUnit:{stdTemplate:"numberWithUnit"}})},d=function(t){g.call(this),t.filterViewOptions=t.filterViewOptions||{},t.filterViewOptions=e.merge(t.filterViewOptions,{ignoreGroupingNodes:!0}),this._recursiveGroupingHelper=new o(this),this._columnFilteringHelper=new n(this),(t=this._recursiveGroupingHelper.handlePreCreation(t)).onContextualEvent=a.bind(this,t.onContextualEvent),e.is(t.selectionBehavior)||(t.selectionBehavior={}),e.is(t.selectionBehavior.showMixedStateOnParents)||(t.selectionBehavior.showMixedStateOnParents=!0)},c=function(e){this._recursiveGroupingHelper.handlePostCreation(e),this._columnFilteringHelper.handlePostCreation()},h=function(t,i,n){var o,r,a,l,s=this,u=function e(t){t.forEach((function(t){o.isGroupingNodeModel(t)?e(t.getChildren()):t.isSelected()||s.selectNodeModel(t,!0,n)}))};l=this.getCellInfosAt(t),e.is(l)&&l.columnID>-1&&(o=this.getTreeDocument(),r=l.nodeModel,o.isGroupingNodeModel(r)&&(i||n||o.getXSO().empty(!0),a=r.getChildren(),Array.isArray(a)&&o.withTransactionUpdate((function(){u(a)}))))},i.extend({name:"PPRDataGridView",init:function(e){d.call(this,e=e||{}),this._parent(e),c.call(this,e)},groupRows:function(t){var i,n,o,r=this;if(t=t||{},o=this.getTreeDocument(),n=this.rowGroupingOptions.depth,i=!e.is(t.ignorePreprocess)||!t.ignorePreprocess,delete t.ignorePreprocess,i&&this._recursiveGroupingHelper.doGroupingPreprocess(t),e.is(n)&&Array.isArray(t.dataIndexesToGroup)&&0===t.dataIndexesToGroup.length&&(!e.is(this._rowModel._latestGroupingOptions)||Array.isArray(this._rowModel._latestGroupingOptions)&&0===this._rowModel._latestGroupingOptions.length)){let e;"function"!=typeof n&&(e=Array.isArray(n)?n:[n],e.sort(((e,t)=>t-e)));const t=function(t){if(e){const i=e.indexOf(t);return 1===e.length&&-1===e[0]||-1!==i}return n.call(o,t)};let i=!1;(function e(n,a){if(!o.isGroupingNodeModel(n)&&t(a)){let e=n.getParents().filter((e=>!o.isGroupingNodeModel(e))),t=e.length>0?e[0]:o._getTrueRoot();Array.isArray(t._appliedGroupingProps)&&t._appliedGroupingProps.length>0&&(r._rowModel._latestGroupingOptions=Array.from(t._appliedGroupingProps),i=!0)}else if(!i){const t=n.getChildren();t&&t.forEach((t=>{e(t,a+(o.isGroupingNodeModel(t)?0:1))}))}})(o._getTrueRoot(),o._getTrueRoot().getNodeDepth())}this._parent(t)},getCellEditableState:function(t){var i,n,o;return o=this.layout.getCellCoordinatesAt(t),i=this.getNodeModelAtRowID(o.rowID),n=this.getTreeDocument(),(!e.is(i)||!n.isGroupingNodeModel(i))&&this._parent(t)},selectCell:function(e,t,i,n){this._parent(e,t,i,n),h.call(this,e,t,i)}})})),define("DS/PPWDataGridView/UnitDropdownPopup",["UWA/Core","UWA/Class","DS/Controls/Popup","DS/DataGridView/DataGridView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/PPWDataGridView/PPWTweakerUtils","i18n!DS/PPWDataGridView/assets/nls/TweakerControl.json"],(function(e,t,i,n,o,r,a,l){"use strict";var s,u,d,c,p,h,g,f,_,m,v;return v=function(){this._model&&Array.isArray(this._xsoToken)&&this._xsoToken.forEach((e=>this._model.getXSO().unsubscribe(e))),this._xsoToken=[]},m=function(){const e=this,t=this._editor,i=this._model.getXSO().onPostAdd((function(i){if(Array.isArray(i)&&i.length>0){const n=i[0].getAttributeValue("unitLabel"),o=t.valueToCommit,r=`${a.getValueInSplit(o)[0]} ${n}`;t._setFormattedValue=!0,t.valueToCommit=r,d.call(e),t.removeValiditySign(),t._onFocusReceived(!1)}}));this._xsoToken.push(i)},p=function(){this._dataGridViewContainer&&this._dataGridViewContainer.setStyle("width",this._editor.elements.container.offsetWidth+"px")},h=function(e){let t=0,i=this._model,n=this._editor,o=this._dataGridView,r=this._dataGridViewContainer;if(!o||!r)return false;let a=o.layout.getDefaultCellHeight();if(i&&0!==i.getRoots().length){t=0;let r=n._maximumItemsDisplayed*(a+1),l=e?Math.min(e.bottom-4,r):r;if(0===i.getNumberOfVisibleDescendants())t=a;else{for(let[e,n,r]=[0,0,i?i.getNumberOfVisibleDescendants():0];e<r&&t<l;e++)n=(o.layout&&o.layout.getRowHeightFunction?o.layout.getRowHeightFunction(e):a)+1,t+=n;t=Math.min(t,l)}}else t=10*a;const l=t+"px";r.style.height!==l&&(r.style.height=l)},c=function(){var e;const t=this._editor.allowedUnits||[],i=[];for(let n=0;n<t.length;n++){const o=t[n];e=o.label,e+=o.NLSName.length>0?` (${o.NLSName})`:"";const a=new r({label:e,grid:{unitLabel:o.label}});i.push(a)}this._model||(this._model=new o),v.call(this),this._model.empty(),this._model.addRoot(i),m.call(this)},g=function(e){if(this._model&&(this._model.getFilterManager().setPropertyFilterModel("label",{filterId:"stringRegexp",filterModel:{condition1:{type:"contains",filter:e}}}),e.length>0)){const e=f.call(this);_.call(this,e)}},_=function(e){this._dataGridView&&(this._dataGridView.setActiveCell(e,!0,!0),this._dataGridView.setPreselectedCell(e))},f=function(){let e=-1;if(!this._dataGridView||!this._model)return e;let t=this._model.getFilterManager();return this._model.processDescendants({processNode:i=>{if(i.nodeModel.canBeFiltered(t.propertyId)&&!t.isDataFiltered(i.nodeModel))return e=this._dataGridView.layout.getCellIDFromCoordinates({rowID:i.nodeModel._getRowID(),columnID:0}),{stopProcessing:!0}},onlyVisibleNodes:!0}),e},u=function(){const e=this._popup,t=this._delayPopupCreationInfos;if(e){if(e.visibleFlag)return;e.visibleFlag=!0}else t&&"function"==typeof t.createVisiblePopup&&Array.isArray(this._editor.allowedUnits)&&this._editor.allowedUnits.length>0&&t.createVisiblePopup()},d=function(){this._popup&&this._popup.visibleFlag&&(this._popup.visibleFlag=!1)},s=function(){const t=this;var o,r;t._delayPopupCreationInfos||(o={target:t._editor,position:"bottom",offset:{x:0,y:4},trigger:"escape",toggleFlag:!0,forceKeepOrientation:!0,constraint:"screen",className:"wux-controls-autoComplete-popup wux-controls-popup",alignment:"near",overlap:!1,shouldDisplayCallback:function(){return c.call(t),!0},getBody:function(){var i;return t._dataGridViewContainer=new e.Element("div",{html:""}),t._dataGridViewContainer.addClassName("wux-controls-autoComplete-dataGridViewContainer"),i={treeDocument:t._model,cellSelection:"none",selectionBehavior:{toggle:!0,selectOnPointerUp:!0},showAlternateBackgroundFlag:!1,showRowBorderFlag:!0,selectionStyle:"lightSelectionEdging",rowSelection:"single",selectNextCellOnEnterFlag:!1,layoutOptions:{columnsHeader:!1,rowsHeader:!1},touchMode:t._editor.touchMode,placeholder:l.get("NumbeWithUnitControl.UnitNotFound.Placeholder"),columns:[{dataIndex:"tree",text:"",showTextFlag:!1,icon:void 0,minWidth:40,width:"auto",visibleFlag:!0,editableFlag:!1,editionPolicy:"EditionOnDoubleClick",resizableFlag:!1,selectableFlag:!1,sortableFlag:!1,groupableFlag:!1,printableFlag:!1,massUpdateAllowedFlag:!1,splittableFlag:!1,compareFunctionCB:void 0,autoSizePadding:0,pinned:"unpinned",onCellRequest:void 0,hasCellValue:void 0,setCellValue:void 0,getCellValueForCopy:void 0,getCellValueForSort:void 0,processCellValueFromPaste:void 0,getCellValueForExport:void 0,getCellKPIColor:void 0,getCellGroupingKey:void 0,getGroupingNodeOptions:void 0}]},t._dataGridView=new n(i),t._dataGridView._setScrollbarsHidden({horizontal:!0}),t._dataGridView.getContent().addClassName("wux-controls-autoComplete-dataGridView"),t._dataGridView.inject(t._dataGridViewContainer),p.call(t),h.call(t),t._dataGridViewContainer},beforeDisplayCallback:function(){p.call(t),h.call(t),g.call(t,""),t._dataGridView&&t._dataGridView.setFindStr("",!1,void 0,!0)}},r=function(e){t._popup=e,t._editor.preventBlurForTargetedElements([t._popup])},t._delayPopupCreationInfos=i.delayPopupCreation(o,r))},t.extend({_editor:null,init:function(e){this._editor=e,s.call(this)},showPopup:function(t){e.is(t,"string")&&(g.call(this,t),h.call(this)),u.call(this)},hidePopup:function(){g.call(this,""),d.call(this)},isPopupVisible:function(){return e.is(this._popup)&&this._popup.visibleFlag}})})),define("DS/PPWDataGridView/PPWMagnitudeLineEditor",["UWA/Core","DS/Utilities/Dom","DS/Controls/LineEditor","DS/Utilities/KeyboardUtils","DS/PPWDataGridView/PPWTweakerUtils","DS/PPWDataGridView/UnitDropdownPopup","css!DS/PPWDataGridView/PPWDataGridView.css"],(function(e,t,i,n,o,r){"use strict";var a,l,s,u,d,c;return l=function(i){i.elements._errorSign||(i.elements._errorSign=e.createElement("div",{class:"ppw-controls-numberwithunit-validitysign"}),i.elements._errorSign.inject(i.elements.container),i.elements._invalidErrorSign=e.createElement("div",{class:"ppw-controls-numberwithunit-invalidsignattention"}),i.elements._invalidErrorSign.inject(i.elements._errorSign),t.generateIcon("attention",{target:i.elements._invalidErrorSign}),i.elements.container.setAttribute("with-ppw-validsign",""),i.elements._invalidErrorSign.show())},s=function(e){e.elements.container.removeAttribute("with-ppw-validsign"),e.elements._errorSign&&(e.elements._errorSign.remove(),delete e.elements._errorSign)},c=function(e){var t,i="";return t=this._getInputField(),i=null===e||""===e?"":o.getMagnitudeValueForDisplay(this,e),t.value=i,i},a=function(){const i=this;t.addEventOnElement(i,i,"blur",(function(t){if(e.is(i._unitpopup)&&i._unitpopup.isPopupVisible())return void t.stopPropagation();const n=i.value;e.is(n)&&""!==n&&c.call(i,n.trim())})),t.addEventOnElement(i,i,"keydown",(function(t){if(t.keyCode===n.ENTER&&!t.ctrlKey&&!t.shiftKey&&!t.altKey){const t=i.value;if(!e.is(t)||""===t)return;0===c.call(i,t.trim()).length&&s(i)}})),t.addEventOnElement(i,i._getInputField(),"input",(function(e){var t=i._getInputField().value;if(e.stopPropagation(),t.length>0){0===o.getMagnitudeValue(i,t).toString().length?l(i):s(i);const e=o.getValueInSplit(t);2===e.length?u.call(i,e[1]||""):d.call(i)}else d.call(i),s(i)})),t.addEventOnElement(i,i,"change",(function(){i.autoCommitFlag||s(i)}))},u=function(t){e.is(this._unitpopup)&&this._unitpopup.showPopup(t)},d=function(){e.is(this._unitpopup)&&this._unitpopup.hidePopup()},i.inherit({name:"MagnitudeLineEditor",_setFormattedValue:!1,_unitpopup:void 0,publishedProperties:{allowedUnits:{defaultValue:void 0,type:"object"},integer:{defaultValue:!1,type:"boolean"},_maximumItemsDisplayed:{defaultValue:10,type:"integer"}},buildView:function(){this._parent(),this.elements.container.addClassName("ppw-controls-numberwithunit-editor"),this._unitpopup=new r(this)},handleEvents:function(){this._parent(),a.call(this)},getInputValue:function(){return this._getInputField().value},getValue:function(){var e=this.value,t="";return e.length>0&&(t=o.getMagnitudeValue(this,e.trim())),t},setValue:function(e){if(this._properties.value.value!==e){const t=o.getMagnitudeValueForDisplay(this,e);this.value=t}},_applyValueToCommit(e,t){this._setFormattedValue&&(t=o.getMagnitudeValueForDisplay(this,t,{unitAsEntered:!0}),this.valueToCommit=t),this._parent(e,t),this._setFormattedValue=!1},isValid:function(){var e="";const t=this.value;return t.length>0&&(e=o.getMagnitudeValue(this,t.trim())),!(t.length>0&&0===e.length)},removeValiditySign:function(){s(this)},destroy:function(){e.is(this._unitpopup)&&(this._unitpopup=void 0),this._parent()}})})),define("DS/PPWDataGridView/PPWMagnitudeSelectionChipsEditor",["UWA/Core","DS/Controls/SelectionChipsEditor","DS/Controls/SelectionChips","DS/PPWDataGridView/PPWTweakerUtils","DS/PPWDataGridView/PPWMagnitudeLineEditor"],(function(e,t,i,n,o){"use strict";var r;function a(e,t){const i=this;var o;e&&(t=t||[],Array.isArray(t)&&(o=t.map((function(e){return{label:n.getMagnitudeValueForDisplay(i,e,{formatNumber:!0,translateUnit:!0}),value:e}})),e.removeAllChips(),e.addChips(o)))}function l(e){return n.getMagnitudeValue(this,e)}return r=i.inherit({name:"MagnitudeSelectionChips",publishedProperties:{allowedUnits:{defaultValue:void 0,type:"object"},integer:{defaultValue:!1,type:"boolean"}},addChip:function(t){var i=t||{};!e.is(i.value)&&e.is(i.label)&&(i.value=i.label,i.label=n.getMagnitudeValueForDisplay(this,i.label,{formatNumber:!0,translateUnit:!0})),this._parent(i)}}),t.inherit({name:"MagnitudeSelectionChipsEditor",publishedProperties:{allowedUnits:{defaultValue:void 0,type:"object"},integer:{defaultValue:!1,type:"boolean"}},getAllowedUnits:function(){return this.allowedUnits},getValue:function(){return this._selectionChips.getAllChipsOptions().map((function(e){return e.value}))},_postBuildView:function(){this._lineEditor=new o({placeholder:this.placeholder,displayStyle:"lite",fireOnlyFromUIInteractionFlag:!0,selectAllOnFocus:!0,disabled:this.disabled,touchMode:this.touchMode,maxLength:this.maxLength,allowedUnits:this.allowedUnits}),this._selectionChips=new r({fireOnlyFromUIInteractionFlag:!0,selection:this.selection,disabled:this.disabled,touchMode:this.touchMode,allowedUnits:this.allowedUnits}),this.customValidator=l.bind(this),this._selectionChips.addLastWidget(this._lineEditor),this._selectionChips.inject(this.elements.container),a.call(this,this._selectionChips,this.value)}})})),define("DS/PPWDataGridView/TweakerPPWMagnitude",["UWA/Core","DS/Utilities/Utils","DS/Utilities/Dom","DS/Utilities/KeyboardUtils","DS/Tweakers/TweakerBase","DS/Tweakers/TweakerUtils","DS/Tweakers/StringViewModules","DS/PPWDataGridView/PPWTweakerUtils","DS/PPWDataGridView/PPWMagnitudeLineEditor","DS/PPWDataGridView/PPWMagnitudeSelectionChipsEditor"],(function(e,t,i,n,o,r,a,l,s,u){"use strict";var d,c,p,h,g,f,_=o.inherit({name:"TweakerPPWMagnitude",publishedProperties:{allowedUnits:{defaultValue:void 0,type:"object"},units:{defaultValue:"",type:"string"},displayStyle:{defaultValue:"numberWithUnit",type:"string"},value:{defaultValue:0,type:"number",advancedSetter:!0,recordFlag:!0},valueType:{defaultValue:"number",type:"string"},minValue:{defaultValue:void 0,type:"number"},maxValue:{defaultValue:void 0,type:"number"},stepValue:{defaultValue:.1,type:"number"},referenceValue:{defaultValue:void 0,type:"number"},integer:{defaultValue:!1,type:"boolean"},preservePrecisionInReadonly:{defaultValue:!1,type:"boolean"}},setProperties:function(t){!e.is(t.value)||this.allowMultipleValuesFlag||this.readOnly||(t.value=l.getMagnitudeValueForDisplay(this,t.value)),this._parent(t)}}),m={};d=function(t,i){var n=this,o="",r=i||{};return r.formatNumber=!0,r.translateUnit=!!e.is(i)&&i.translateUnit,t,this._tweaker.allowMultipleValuesFlag?(o=((e.is(t)&&t.length>0?Array.isArray(t)?t:[t]:[])||[]).map((function(e){return l.getMagnitudeValueForDisplay(n._tweaker,e,r)})),o=this._tweaker.getStringFromValue(o)):o=l.getMagnitudeValueForDisplay(this._tweaker,t,r),o},f=function(e){if(Object.keys(m).length)return;const t=e.getPublishedPropertiesDefaultValue();["maxLength","uniqueValue","customValidator","selection"].forEach((e=>{m[e]=t[e]})),Object.freeze(m)},c=function(e,t){a.Base.call(this,e,t)},t.applyMixin(c,a.Base),h=function(e,t){a.LineEditor.call(this,e,t)},t.applyMixin(h,a.LineEditor);return Object.freeze({customValidator:void 0,customFormatter:void 0}),h.prototype.buildView=function(){var e=this._options.viewOptions||{};this._view=[],this._tweaker._updateInformationToDisplay(this._tweaker.value),this.setIcon(this._tweaker._currentValueIcon),e.escapeHTML=this._tweaker.escapeHTML,e.touchMode=this._tweaker._getCurrentTouchMode(),e.disabled=this._tweaker.readOnly,e.placeholder=this._tweaker.placeholder,e.requiredFlag=this._tweaker.requiredFlag,e.selectAllOnFocus=!0,e.fireOnlyFromUIInteractionFlag=!0,e.autoCommitFlag=!0,e.pattern=this._tweaker.pattern,e.autoCorrectFlag=this._tweaker.autoCorrectFlag,e.displayClearFieldButtonFlag=this._tweaker.allowResetToUndefinedByUIFlag,e.allowedUnits=this._tweaker.allowedUnits,e.integer=this._tweaker.integer,this._editor=new s(e),this._view.push(this._editor),this._tweaker.viewOptions&&this.setViewOptions(this._tweaker.viewOptions);const t=l.getMagnitudeValueForDisplay(this._tweaker,this._tweaker.value);this.setValue(t),this._updateValidState()},h.prototype.handleEvents=function(){var e=this,t=this._tweaker,o=this._editor,r=()=>{const i=o.value.toString(),n=o.getValue(),r=n.toString();var a=i.length>0&&r.length>0&&t.value!==r;return a&&(o._setFormattedValue=!0,e.setTweakerValue(n),o._setFormattedValue=!1),a};o&&t&&(i.addEventOnElement(t,o,"blur",(function(){r()?(t.onPostEdit(),e._iconWasInvalidDuringModification=!1,e._updateValidState()):(t.onCancelEdit(),this._liveChangeOccurred=!1)})),i.addEventOnElement(t,o,"uncommittedChange",(function(i){i.stopPropagation(),e._preEditState||t.validState||(e._iconWasInvalidDuringModification=!0),t.onPreEdit()})),i.addEventOnElement(t,o,"clear",(function(){t.value=void 0})),o.elements.inputField&&(i.addEventOnElement(t,o.elements.inputField,"keydown",(function(i){i.keyCode===n.ESCAPE&&(t._cancelableValue&&t._cancelableValue!==t.value&&(i.actionPerformed=!0),e.latestKeydownEvent=i,t.onCancelEdit()),i.keyCode!==n.ENTER||i.ctrlKey||i.shiftKey||i.altKey||!t._liveChangeOccurred||(r()?t.onChange():t.onCancelEdit(),e.latestKeydownEvent=i,i.actionPerformed=!0)})),i.addEventOnElement(t,o.elements.inputField,"keyup",(function(t){e.latestKeydownEvent&&(e.latestKeydownEvent.actionPerformed&&(t.actionPerformed=!0),e.latestKeydownEvent=void 0)}))),i.addEventOnElement(t,o,"change",(function(e){e.stopPropagation()})))},p=function(e,t){o.prototype.VIEW_MODULES.readOnly.classObject.call(this,e,t)},t.applyMixin(p,o.prototype.VIEW_MODULES.readOnly.classObject),p.prototype.setViewOptions=function(e,t){var i=t&&t.multipleValuesSeparator,n=e&&e.multipleValuesSeparator,o=this._tweaker;if(n!==i){const e=d.call(this,o.value);this.formatHTMLValue(e)}},p.prototype.buildView=function(){var e=this._tweaker;const t=d.call(this,e.value,{translateUnit:!0});this.formatHTMLValue(t),this.setEmphasize(this._tweaker.emphasize),this.setBackgroundColor(this._tweaker.backgroundColor)},p.prototype.setValue=function(e){if(!this._tweaker)return;const t=d.call(this,e,{translateUnit:!0});this.formatHTMLValue(t)},g=function(e,t){a.SelectionChipsEditor.call(this,e,t)},t.applyMixin(g,a.SelectionChipsEditor),g.prototype.setValue=function(e){var t=e,i=this._tweaker;Array.isArray(e)&&(t=e.map((function(e){return l.getMagnitudeValueForDisplay(i,e)}))),a.SelectionChipsEditor.prototype.setValue.call(this,t)},g.prototype.buildView=function(){var t=this,o=this._tweaker;this._tweaker.elements.container.addClassName("wux-tweakers-selectionchipseditor");let a=this._options.viewOptions||{};a.placeholder=this._tweaker.placeholder,a.value=o.value,a.disabled=o.disabled,a.touchMode=o._getCurrentTouchMode(),a.allowedUnits=o.allowedUnits,a.integer=o.integer,a.fireOnlyFromUIInteractionFlag=!0,this._viewInlined=e.createElement("div"),this._view=r._buildTweakerAggregateView(this._tweaker,{viewModule:this,inlined:this._viewInlined,getExtended:function(){return t._viewExtended||(t._viewExtended=new u(a),f(t._viewExtended),t._tweaker.viewOptions&&t.setViewOptions(t._tweaker.viewOptions),i.addEventOnElement(t,t._viewExtended,"change",(function(i){i.stopPropagation();let n=t._viewExtended.value;if(n&&Array.isArray(n)){let i=[];for(let t=0,r=n.length;t<r;++t){let r=l.getMagnitudeValue(o,n[t]);e.is(r)&&r.toString().length>0&&i.push(r)}t.setTweakerValue(i)}})),i.addEventOnElement(t,t._viewExtended.getContent(),"keydown",(function(e){!e.actionPerformed||e.keyCode!==n.TAB&&e.keyCode!==n.ENTER&&e.keyCode!==n.ESCAPE||e.stopPropagation()}))),t._viewExtended}},{overlapContainer:!0,hasButton:!this._options.readOnly,getExtendedViewHeight:()=>"auto",onPopupDisplay:function(){t._view.elements.extendedViewContainer&&t._view.elements.extendedViewContainer.getContent().setStyle("min-height",t._view.getContent().offsetHeight),t._viewExtended&&t._viewExtended.focus({preventScroll:!0})}}),this._view.getContent().addClassName("wux-tweakers-string-lineeditordots"),this.setTouchMode(a.touchMode),this.setValue(a.value)},_.prototype.baseViewModule=c,_.prototype.VIEW_MODULES={numberWithUnit:{classObject:h},numberWithUnit_readOnly:{classObject:p},numberWithUnit_allowMultipleValues:{classObject:g}},_.prototype.registerViewModule=function(){},_}));