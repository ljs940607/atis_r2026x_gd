define("DS/MPFMyCartSummary/MyCartSummaryFactory",["DS/MPFServices/MarketplaceServices","DS/MPFConnector/MarketplaceConnector","DS/MPFConnector/AppsConnector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFPortfolioModel/compass/CompassPortfolioCollection","DS/MPFPortfolioModel/compass/CompassPortfolioDataProxy","DS/MPFPersonModel/PersonFactory","DS/MPFPspModel/PspFactory","DS/MPFCountryModel/CountryFactory","DS/MPFTaxModel/TaxEstimationFactory","DS/MPFClickAndBuyComponent/ClickAndBuyStateMachine","DS/MPFClickAndBuyComponent/ClickAndBuyComponent"],((e,o,t,r,c,a,s,n,i,p,y,P)=>{"use strict";return class{static async createMyCartSummary({service:o=e.CLICK_AND_BUY}={}){const{connector:C,my3dExpConnector:l,myAppsConnector:m}=await this._fetchConnectors({service:o}),M=r.getInstance(C),[T,F,S,f,u,d,A,h,E]=await M.getFactories([r.Types.PERSON,r.Types.COUNTRY,r.Types.PORTFOLIO,r.Types.TENANT,r.Types.PSP,r.Types.CART,r.Types.CART_ITEM,r.Types.TAX_ESTIMATION,r.Types.COUPON_CREATION]),D=T.createModel(s.Types.ME),I=F.createCollection(i.Types.SP_PUBLIC_OPENED_COUNTRIES),_=u.createModel(n.Types.PARAM_PSP),w=h.createModel(p.Types.TAX_ESTIMATION),[O]=await Promise.all([this._fetchCompassInfo(m),this._fetchMeWithoutError(D),I.fetchPromise()]),N=new t(O.portfolio),v=new c([],{dataProxy:new a(N)}),x=new y({page:y.Pages.CART,cookieKey:"swymlang",service:o,me:D,countries:I}),R=new P({stateMachine:x,psp:_,taxEstimation:w,compassPortfolios:v,cartFactory:d,cartItemFactory:A,portfolioFactory:S,tenantFactory:f,couponFactory:E,countries:I,service:o,my3dExpConnector:l});return await R.load(),R}static _fetchMeWithoutError(e){return new Promise(((o,t)=>e.fetch({onComplete:o,onFailure:t,onPassportError:e=>{console.error(e),o()}})))}static _fetchCompassInfo(e){return new Promise(((o,t)=>{e.request(e.url("/infos/feature/compass"),{onComplete:o,onFailure:t})}))}static async _fetchConnectors({service:e}){const r=await o.fetchPromise({service:e});return{connector:r,my3dExpConnector:await o.fetchPromise({backend:"my3dexperience",platformId:r.platformId,service:e}),myAppsConnector:await t.fetchPromise()}}}}));