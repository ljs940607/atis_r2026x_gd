define("DS/ModelLoader_mineschedanimation/GEOMSAResult3D",["UWA/Core","UWA/Class"],(function(e,t){"use strict";return t.extend({init:function(t){var i=this;t.canvassetting&&(i.canvassetting=e.extend({locations:{colouring:"by location"},mining:{visibility:"removed",visible:"true"},filling:{visibility:"added",visible:"true"},development:{visibility:"added",visible:"true"},activities:{visible:"true"},stockpiles:{visible:"true"},tags:{visible:"false"}},t.canvassetting,!0),i.initCanvassetting=e.extend({locations:{colouring:"by location"},mining:{visibility:"removed",visible:"true"},filling:{visibility:"added",visible:"true"},development:{visibility:"added",visible:"true"},activities:{visible:"true"},stockpiles:{visible:"true"},tags:{visible:"false"}},t.canvassetting,!0)),i.node=t.node,i.periods=[],t.periods&&t.periods.length&&(i.periods=t.periods),i.currentPeriod=0,i.msaNodes=[]},applyPeriod:function(e){var t=this,i=t.currentPeriod;void 0!==e&&(i=e),void 0!==i&&(t.msaNodes.forEach((function(e){e.applyPeriod(i)})),t.currentPeriod=i)},modifyFillingVisibility:function(e){var t=this;if("added"===e||"removed"===e||"single"===e){t.canvassetting.filling.visible="true";var i=t.canvassetting.filling.visibility,s=i.split(" ");t.canvassetting.filling.visibility=i.replace(s[0],e)}else"false"===e&&(t.canvassetting.filling.visible="false")},modifyMiningVisibility:function(e){var t=this;if("added"===e||"removed"===e||"single"===e){t.canvassetting.mining.visible="true";var i=t.canvassetting.mining.visibility,s=i.split(" ");t.canvassetting.mining.visibility=i.replace(s[0],e)}else"false"===e&&(t.canvassetting.mining.visible="false")},modifyDvlpVisibility:function(e){var t=this;if("added"===e||"removed"===e||"single"===e){t.canvassetting.development.visible="true";var i=t.canvassetting.development.visibility,s=i.split(" ");t.canvassetting.development.visibility=i.replace(s[0],e)}else"false"===e&&(t.canvassetting.development.visible="false")},setting:function(e,t){var i=this;if(void 0!==t&&void 0!==e)switch(t){case"activity":i.canvassetting.activities.visible=e;break;case"stockpile":i.canvassetting.stockpiles.visible=e;break;case"production":i.modifyDvlpVisibility(e),i.modifyFillingVisibility(e),i.modifyMiningVisibility(e);break;default:console.log("This parameter is not implemented")}console.log("init"),console.log(i.initCanvassetting)},restore:function(){var e=this;e.canvassetting.activities.visible=e.initCanvassetting.activities.visible,e.canvassetting.development.visible=e.initCanvassetting.development.visible,e.canvassetting.filling.visible=e.initCanvassetting.filling.visible,e.canvassetting.mining.visible=e.initCanvassetting.mining.visible,e.canvassetting.stockpiles.visible=e.initCanvassetting.stockpiles.visible,e.canvassetting.tags.visible=e.initCanvassetting.tags.visible,e.canvassetting.development.visibility=e.initCanvassetting.development.visibility,e.canvassetting.filling.visibility=e.initCanvassetting.filling.visibility,e.canvassetting.mining.visibility=e.initCanvassetting.mining.visibility},inWitchSetting:{mining:"mining",filling:"filling",development:"development",activity:"activities",stockpile:"stockpiles"}})})),define("DS/ModelLoader_mineschedanimation/GEOMSAMeshNode",["UWA/Core","UWA/Class","DS/Visualization/ThreeJS_DS","DS/Mesh/Mesh"],(function(e,t,i,s){"use strict";return t.extend({init:function(e){var t=this;t.tag=e.tag,t.visibility=e.visibility,t.overridevisibility=e.overridevisibility,t.result3dNode=e.result3dNode,t.node=e.node,t.result3dNode&&t.result3dNode.msaResult3d&&t.result3dNode.msaResult3d.msaNodes&&t.result3dNode.msaResult3d.msaNodes.push(t),t.color=e.color,t.node.css3DNode&&"stockpile"===t.visibility||(t.period=e.period)},_getVisibility:function(){var e=this,t="single";if(e.result3dNode&&e.result3dNode.msaResult3d&&e.result3dNode.msaResult3d.canvassetting&&e.visibility){var i=e.result3dNode.msaResult3d.inWitchSetting[e.visibility];e.result3dNode.msaResult3d.canvassetting[i].visibility&&(t=e.result3dNode.msaResult3d.canvassetting[i].visibility),e.overridevisibility&&(t=e.overridevisibility)}var s={};return s.isAtStart=!e.period||t.includes("at start"),t.includes("added")?s.mode="added":t.includes("removed")?(s.mode="removed",s.isAtStart=!0):s.mode="single",s},_getVisible:function(){var e=this,t=!0;if(e.result3dNode&&e.result3dNode.msaResult3d&&e.result3dNode.msaResult3d.canvassetting)if(e.node.css3DNode&&"true"!==e.result3dNode.msaResult3d.canvassetting.tags.visible)t=!1;else if(e.visibility){var i=e.result3dNode.msaResult3d.inWitchSetting[e.visibility];t=void 0===e.result3dNode.msaResult3d.canvassetting[i].visible||"true"===e.result3dNode.msaResult3d.canvassetting[i].visible}return t},_getColors:function(){var e,t=this;if(t.color)if(e={"by location":t.color},"mining"!==t.visibility&&"filling"!==t.visibility&&"development"!==t.visibility)e["by period"]=e["by location"];else if(t.result3dNode&&t.result3dNode.msaResult3d&&t.result3dNode.msaResult3d.canvassetting){var i=t.period%12;e["by period"]={a:t.color.a},e["by period"].r=i<3||i>9?255:i>3&&i<9?0:127,e["by period"].g=i<1||i>7?0:i>1&&i<7?255:127,e["by period"].b=i<5||i>11?0:i>5&&i<11?255:127}return e},applyColorSettings:function(){var e=this,t=e._getColors();if(t&&t["by period"]&&t["by location"]&&e.result3dNode&&e.result3dNode.msaResult3d&&e.result3dNode.msaResult3d.canvassetting){var i,n=new s.Color(t["by period"].r/255,t["by period"].g/255,t["by period"].b/255,t["by period"].a/255),a=new s.Color(t["by location"].r/255,t["by location"].g/255,t["by location"].b/255,t["by location"].a/255);if(i=e.result3dNode.msaResult3d.canvassetting.locations&&"by period"===e.result3dNode.msaResult3d.canvassetting.locations.colouring?n:a,e.node.css3DNode)e.node.css3DNode.element.style.backgroundColor="rgba("+255*i.r+", "+255*i.g+", "+255*i.b+", 0.5)";else if(e.node.mesh3js){var r=e.node.mesh3js.sceneGraph.children[0];r.getPrimitivesCount()&&(r.getPrimitiveGroup(0).gas.color.r=i.r,r.getPrimitiveGroup(0).gas.color.g=i.g,r.getPrimitiveGroup(0).gas.color.b=i.b)}}},applyPeriod:function(e){var t=this,i=!1;if(t._getVisible()){var s=t._getVisibility();t.node.css3DNode?void 0===t.period||"added"===s.mode&&t.period===e||"single"===s.mode&&t.period===e||"removed"===s.mode&&t.period===e+1?(i=!0,t.node.css3DNode.element.style.removeProperty("display")):i=!1:i=0===e?!(!s.isAtStart||t.node.css3DNode):void 0===t.period||"added"===s.mode&&t.period<=e||"single"===s.mode&&t.period===e||"removed"===s.mode&&t.period>e}t.node.setVisibility(i)}})})),define("DS/ModelLoader_mineschedanimation/loader",["UWA/Core","UWA/Utils","DS/WebappsUtils/WebappsUtils","DS/Mesh/Mesh","DS/Visualization/SceneGraphFactory","DS/Visualization/Node3D","DS/Visualization/ThreeJS_DS","DS/WAFData/WAFData","DS/Visualization/Utils","DS/SceneGraphNodes/CSS3DNode","DS/SceneGraphNodes/CSS2DNode","DS/ModelLoader_mineschedanimation/GEOMSAMeshNode","DS/ModelLoader_mineschedanimation/GEOMSAResult3D"],(function(e,t,i,s,n,a,r,l,o,d,u,v,c){"use strict";return function(){this.load=function(e,t,i,s){var n=this;n.scene=new a,n.scene.name="scene",e.provider&&"FILE"===e.provider&&null!=e.filename&&""===e.filename.trim()&&(e.filename=e.serverurl);var r=e,l={scene:n.scene,url:r,callbacks:{progress:i,done:s}};n._readMineSchedAnimationFD1(l),t&&t(n.scene)},this._downloadFileFD1=function(e,t){e.provider&&"FILE"===e.provider?l.request(e.filename,{method:"GET",responseType:"arraybuffer",type:"arraybuffer",onComplete:t}):l.handlerequest(e,{method:"GET",responseType:"arraybuffer",type:"arraybuffer",onComplete:t})},this.creDelegUnzip=function(e){var t=this,i=t._msaworker.promises.length;e.id=i;var s={},n=new Promise((function(i){t._msaworker.postMessage(e),s.resolve=function(e){i(e)}}));return t._msaworker.promises[i]=s,n},this._readMineSchedAnimationFD1=function(e){var s=this,n=i.getWebappsBaseUrl(),a=t.matchUrl(n,window.location)?null:"Passport",r=[{provider:"FILE",filename:"AmdLoader.js",serverurl:n+"AmdLoader/",requiredAuth:a},{provider:"FILE",filename:"ThreeJS_Base.js",serverurl:n+"Mesh/",requiredAuth:a},{provider:"FILE",filename:"GEO7zip.js",serverurl:n+"GEO7zip/",requiredAuth:a},{provider:"FILE",filename:"minizip-asm.min.js",serverurl:n+"GEO7zip/nodejs/node_modules/minizip-asm.js/lib/",requiredAuth:a},{provider:"FILE",filename:"mineschedanimationWorker.js",serverurl:n+"GEOV1Workers/",requiredAuth:a}];if(!s._msaworker){s._msaworker={promises:[],initialize:function(e){if(5===s._msaworker.workers.length)s._msaworker.workers.forEach((function(t){t.postMessage(e)}));else var t=setInterval((function(){5===s._msaworker.workers.length&&(clearInterval(t),s._msaworker.initialize(e))}),50)},postMessage:function(e){var t=s._msaworker.workers.shift();s._msaworker.workers.push(t),t.postMessage(e)},terminate:function(){s._msaworker.workers.forEach((function(e){e.terminate()}))},workers:[]};for(var l=function(e){var t=s._msaworker.promises[e.data.id],i={data:e.data.data,zipSize:e.data.zipSize,meshInputs:e.data.meshInputs};t.resolve(i)},d=1;d<=5;d++)o.getWorkerBlobFromSpecs(r,(function(e){var t=new Worker(e);t.onmessage=function(e){l(e)},s._msaworker.workers.push(t)}))}if(!s._plyworker){s._plyworker={promises:[],postMessage:function(e){var t=s._plyworker.workers.shift();s._plyworker.workers.push(t),t.postMessage(e)},terminate:function(){s._plyworker.workers.forEach((function(e){e.terminate()}))},workers:[]};for(var u=function(e){var t=s._plyworker.promises[e.data.id],i={meshInputs:e.data.meshInputs};t.resolve(i)},v=1;v<=3;v++)o.getWorkerBlobFromSpecs(r,(function(e){var t=new Worker(e);t.onmessage=function(e){u(e)},s._plyworker.workers.push(t)}))}s._downloadFileFD1(e.url,(function(t){if(s._msaworker){var i=s._msaworker.promises.length,n={},a=new Promise((function(e){s._msaworker.initialize({arraybuffer:t,id:i}),n.resolve=function(t){e(t)}}));s._msaworker.promises[i]=n,a.then((function(){return s.creDelegUnzip({meshName:"results3d.xml"}).then((function(t){s.totalprogress||(s.totalprogress=t.zipSize,s.progress=0),s.progress+=1,e.callbacks.progress&&e.callbacks.progress({loaded:s.progress,total:s.totalprogress});var i=s._createResult3D(e,t.data),n={loaderinputs:e,result3DEntry:t.data,result3DNode:i};return s._appendMeshes(n)})).then((function(){s._msaworker.terminate(),s._plyworker.terminate(),e.callbacks.done()}))}))}}))},this._createResult3D=function(e,t){var i=new a;i.name="Result3dNode",i.productType="Reference3D",e.scene.addChild(i);for(var s=(new DOMParser).parseFromString(t.data,"text/xml"),n={},r=s.evaluate("/results3d/settings/canvassettings/*",s,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),l=0;l<r.snapshotLength;l++){var o=r.snapshotItem(l);n.canvassetting||(n.canvassetting={});var d=o.nodeName;n.canvassetting[d]={};for(var u=s.evaluate("./*",o,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),v=0;v<u.snapshotLength;v++){var p=u.snapshotItem(v),m=p.nodeName,g=p.textContent;n.canvassetting[d][m]=g}}for(var h,f=s.evaluate("/results3d/period",s,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),b=[],N=0;N<f.snapshotLength;N++){0===N&&b.push({number:0}),h=f.snapshotItem(N);var P=s.evaluate("./number",h,null,XPathResult.ANY_TYPE,null),y=s.evaluate("./start",h,null,XPathResult.ANY_TYPE,null),_=s.evaluate("./end",h,null,XPathResult.ANY_TYPE,null),E=P.iterateNext().textContent,D=y.iterateNext(),R=_.iterateNext(),w=new Date(D.attributes.year.value,D.attributes.month.value,D.attributes.day.value),x=new Date(R.attributes.year.value,R.attributes.month.value,R.attributes.day.value),S={number:parseInt(E),start:w,end:x};b.push(S)}n.node=i,n.periods=b;var A=new c(n);return i.msaResult3d=A,i},this._appendMeshes=function(e){var t=this,i=[];return i=(i=(i=i.concat(t._appendStaticMeshes(e))).concat(t._appendMeshForPeriod(e))).concat(t._appendScaledMesh(e)),Promise.all(i)},this._appendStaticMeshes=function(e){for(var t,i=this,s=[],n=(new DOMParser).parseFromString(e.result3DEntry.data,"text/xml"),a=n.evaluate("/results3d/staticmesh",n,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),r=0;r<a.snapshotLength;r++){t=a.snapshotItem(r);var l=n.evaluate("./filename",t,null,XPathResult.ANY_TYPE,null),o=n.evaluate("./color/r",t,null,XPathResult.ANY_TYPE,null),d=n.evaluate("./color/g",t,null,XPathResult.ANY_TYPE,null),u=n.evaluate("./color/b",t,null,XPathResult.ANY_TYPE,null),v=n.evaluate("./color/a",t,null,XPathResult.ANY_TYPE,null),c=l.iterateNext().textContent,p={Red:o.iterateNext().textContent,Green:d.iterateNext().textContent,Blue:u.iterateNext().textContent,Alpha:v.iterateNext().textContent};p.color={r:parseInt(p.Red),g:parseInt(p.Green),b:parseInt(p.Blue),a:parseInt(p.Alpha)},p.result3dNode=e.result3DNode;var m,g=n.evaluate("./tag/line",t,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);if(g){p.Tags=[],p.tag=[];for(var h=0;h<g.snapshotLength;h++)m=g.snapshotItem(h),p.Tags.push(m.textContent),p.tag.push(m.textContent)}if(i._msaworker){var f=i.creDelegUnzip({meshName:c}),b=Promise.resolve(p),N=Promise.all([b,f]).then((function(t){var s=t[0],n=t[1].data;return i._parsePLY(n.data,s).then((function(t){var s=t.createdMesh,n=t.parameters;return new Promise((function(t){n.bs=s.getBoundingSphere(),n.bb=s.getBoundingBox();var a=i._createTagNode(n);e.result3DNode.addChild(s),a&&e.result3DNode.addChild(a),s.mesh3js.sceneGraph.children[0].solid=1,t(s)}))}))}));s.push(N),N.then((function(){i.progress+=1,e.loaderinputs.callbacks.progress&&e.loaderinputs.callbacks.progress({loaded:i.progress,total:i.totalprogress})}))}}return s},this._appendMeshForPeriod=function(e){for(var t,i=this,s=[],n=(new DOMParser).parseFromString(e.result3DEntry.data,"text/xml"),a=n.evaluate("/results3d/meshforperiod",n,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),r=0;r<a.snapshotLength;r++){t=a.snapshotItem(r);var l=n.evaluate("./filename",t,null,XPathResult.ANY_TYPE,null),o=n.evaluate("./color/r",t,null,XPathResult.ANY_TYPE,null),d=n.evaluate("./color/g",t,null,XPathResult.ANY_TYPE,null),u=n.evaluate("./color/b",t,null,XPathResult.ANY_TYPE,null),v=n.evaluate("./color/a",t,null,XPathResult.ANY_TYPE,null),c=n.evaluate("./period",t,null,XPathResult.ANY_TYPE,null),p=n.evaluate("./visibility",t,null,XPathResult.ANY_TYPE,null),m=n.evaluate("./overridevisibility",t,null,XPathResult.ANY_TYPE,null),g=l.iterateNext().textContent,h={Red:o.iterateNext().textContent,Green:d.iterateNext().textContent,Blue:u.iterateNext().textContent,Alpha:v.iterateNext().textContent,Period:c.iterateNext().textContent};if(h.color={r:parseInt(h.Red),g:parseInt(h.Green),b:parseInt(h.Blue),a:parseInt(h.Alpha)},h.period=parseInt(h.Period),p){var f=p.iterateNext();f&&(h.visibility=f.textContent)}if(m){var b=m.iterateNext();b&&(h.overridevisibility=b.textContent)}h.result3dNode=e.result3DNode;var N,P=n.evaluate("./tag/line",t,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);if(P){h.Tags=[],h.tag=[];for(var y=0;y<P.snapshotLength;y++)N=P.snapshotItem(y),h.Tags.push(N.textContent),h.tag.push(N.textContent)}if(i._msaworker){var _=i.creDelegUnzip({meshName:g}),E=Promise.all([Promise.resolve(h),_]).then((function(t){var s=t[0],n=t[1].data;return i._parsePLY(n.data,s).then((function(t){var s=t.createdMesh,n=t.parameters;return new Promise((function(t){n.bs=s.getBoundingSphere(),n.bb=s.getBoundingBox();var a=i._createTagNode(n);e.result3DNode.addChild(s),a&&e.result3DNode.addChild(a),s.mesh3js.sceneGraph.children[0].solid=1,t(s)}))}))}));s.push(E),E.then((function(){i.progress+=1,e.loaderinputs.callbacks.progress&&e.loaderinputs.callbacks.progress({loaded:i.progress,total:i.totalprogress})}))}}return s},this._appendScaledMesh=function(t){for(var i,s=this,n=[],r=(new DOMParser).parseFromString(t.result3DEntry.data,"text/xml"),l=r.evaluate("/results3d/scaledmesh",r,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),o=0;o<l.snapshotLength;o++){i=l.snapshotItem(o);for(var d=r.evaluate("./filename",i,null,XPathResult.ANY_TYPE,null),u=r.evaluate("./color/r",i,null,XPathResult.ANY_TYPE,null),v=r.evaluate("./color/g",i,null,XPathResult.ANY_TYPE,null),c=r.evaluate("./color/b",i,null,XPathResult.ANY_TYPE,null),p=r.evaluate("./color/a",i,null,XPathResult.ANY_TYPE,null),m=r.evaluate("./location/x",i,null,XPathResult.ANY_TYPE,null),g=r.evaluate("./location/y",i,null,XPathResult.ANY_TYPE,null),h=r.evaluate("./location/z",i,null,XPathResult.ANY_TYPE,null),f=r.evaluate("./scalefactors/factor",i,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),b=[],N=0;N<f.snapshotLength;N++){var P=f.snapshotItem(N),y=r.evaluate("./period",P,null,XPathResult.ANY_TYPE,null),_=r.evaluate("./scale",P,null,XPathResult.ANY_TYPE,null);b[N]={period:y.iterateNext().textContent,scale:_.iterateNext().textContent}}var E=d.iterateNext().textContent,D={Red:u.iterateNext().textContent,Green:v.iterateNext().textContent,Blue:c.iterateNext().textContent,Alpha:p.iterateNext().textContent,LocationX:m.iterateNext().textContent,LocationY:g.iterateNext().textContent,LocationZ:h.iterateNext().textContent,ScaleFactors:b};D.color={r:parseInt(D.Red),g:parseInt(D.Green),b:parseInt(D.Blue),a:parseInt(D.Alpha)},D.visibility="stockpile";var R,w=r.evaluate("./tag/line",i,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);if(w){D.Tags=[],D.tag=[];for(var x=0;x<w.snapshotLength;x++)R=w.snapshotItem(x),D.Tags.push(R.textContent),D.tag.push(R.textContent)}if(s._msaworker){var S=s.creDelegUnzip({meshName:E}),A=Promise.all([Promise.resolve(D),S]).then((function(i){var n=i[0],r=i[1].data,l=n.ScaleFactors,o=n.LocationX,d=n.LocationY,u=n.LocationZ,v=new a(r.name);t.result3DNode.addChild(v);for(var c=[],p=0;p<l.length;p++){var m=l[p],g=e.clone(n);g.Scale=m.scale,g.period=parseInt(m.period),g.result3dNode=t.result3DNode;var h=s._parsePLY(r.data,g).then((function(e){var t=e.createdMesh;return new Promise((function(e){t.translateX(1e3*o),t.translateY(1e3*d),t.translateZ(1e3*u),v.addChild(t),t.mesh3js.sceneGraph.children[0].solid=1,e(t)}))}));c.push(h)}n.bs=v.getBoundingSphere(),n.bb=v.getBoundingBox();var f=s._createTagNode(n);return f&&t.result3DNode.addChild(f),Promise.all(c)}));n.push(A),A.then((function(){s.progress+=1,t.loaderinputs.callbacks.progress&&t.loaderinputs.callbacks.progress({loaded:s.progress,total:s.totalprogress})}))}}return n};this._parsePLY=function(e,t){var i=this;if(3===i._plyworker.workers.length){var a=i._plyworker.promises.length,l={},o=new Promise((function(s){i._plyworker.postMessage({ply:e,parameters:{color:t.color,Scale:t.Scale},id:a}),l.resolve=function(e){s(e)}}));i._plyworker.promises[a]=l;var d=Promise.all([Promise.resolve(t),o]).then((function(e){return new Promise((function(t){var i=e[0],a=e[1].meshInputs,l=function(e,t,i,a,l){var o=new s.PrimitiveGroup;o.fillAttr=new s.FillAttributes,o.lineAttr=new s.LineAttributes,o.pointAttr=new s.PointAttributes;var d=new s.Buffer;d.size=9*e,d.component=s.VertexComponentEnum.POSITION,d.format=s.DataTypeEnum.FLOAT,d.dimension=3,d.data=t;var u=new s.Buffer;u.size=9*e,u.component=s.VertexComponentEnum.NORMAL,u.format=s.DataTypeEnum.FLOAT,u.dimension=3,u.data=i;var v=null;a&&((v=new s.Buffer).size=4*e,v.component=s.VertexComponentEnum.DIFFUSE_COLOR,v.format=s.DataTypeEnum.FLOAT,v.dimension=4,v.data=l),o.addBuffer(0,d),o.addBuffer(1,u),a&&o.addBuffer(2,v);var c=new s.Primitive({identifier:"face"});c.geomType="FACE",c.nbIndices=3*e,c.connectivity=s.ConnectivityTypeEnum.TRIANGLES,c.attr={fill:new s.FillAttributes(new s.Color(l[0]/255,l[1]/255,l[2]/255,l[3]/255)),line:new s.LineAttributes,point:new s.PointAttributes};var p=new r.MeshPhongMaterial({color:(new r.Color).setRGB(l[0]/255,l[1]/255,l[2]/255),opacity:l[3]/255,side:r.DoubleSide});p.force=!0,c.material=p;var m=new s.VertexComponent;m.component=s.VertexComponentEnum.POSITION,m.nbVertices=3*e,m.nbValuesPerVertex=3,m.format=s.DataTypeEnum.FLOAT,m.cardinality=0,m.bufferId=0,m.indices=null;var g=new s.VertexComponent;g.component=s.VertexComponentEnum.NORMAL,g.nbVertices=3*e,g.nbValuesPerVertex=3,g.format=s.DataTypeEnum.FLOAT,g.cardinality=0,g.bufferId=1,g.indices=null,c.addVertexComponent(m),c.addVertexComponent(g);var h=null;return a&&((h=new s.VertexComponent).component=s.VertexComponentEnum.DIFFUSE_COLOR,h.nbVertices=3*e,h.nbValuesPerVertex=4,h.format=s.DataTypeEnum.FLOAT,h.cardinality=0,h.bufferId=2,h.indices=null,c.addVertexComponent(h)),o.addPrimitive(c),n.createMeshNode(o)}(a.nbFaces,a.vertices,a.normals,!0,a.colors),o=i.Tags;l.tags=o,i.node=l;var d=new v(i);l.msaNode=d,d.applyColorSettings(),d.applyPeriod(0),t({createdMesh:l,parameters:i})}))}));return d}var u=setInterval((function(){3===i._plyworker.workers.length&&(clearInterval(u),_parsePLY(e,t))}),50)},this._createTagNode=function(){}}}));