define("DS/ENOCharacteristicsApp/controls/CreateCharacteristics",["UWA/Core","UWA/Controls/Abstract","DS/Controls/Toggle","DS/Controls/ButtonGroup","DS/Controls/LineEditor","DS/Controls/TooltipModel","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENOCharacteristicsApp/view/NewDialog","DS/ENOCharacteristicsApp/view/CreateCharacteristicsForm","DS/ENOCharacteristicsApp/service/CharacteristicsServiceWrapper","DS/ENOCharacteristicsApp/utils/Notification","DS/ENOCharacteristicsApp/utils/Constants","DS/ENOCharacteristicsApp/utils/CharacteristicsUtils","DS/XSRCommonComponents/utils/XSRMask","DS/ENOCharacteristicsApp/utils/IndexServiceProvider","DS/XSRCommonComponents/utils/RequestUtil","DS/ENOCharacteristicsApp/utils/CharacteristicsValidation","DS/ENOCharacteristicsApp/controls/CharTestMethodControl","DS/ENOCharacteristicsApp/controls/DimensionChangeActions","DS/ENOCharacteristicsApp/controls/BuildCreateCharInput","text!DS/ENOCharacteristicsApp/assets/config/CreateCharacteristicsFields.json","i18n!DS/ENOCharacteristicsApp/assets/nls/ENOCharacteristicsApp"],(function(e,i,t,a,s,l,n,r,o,d,m,p,c,u,h,f,g,F,T,D,v,I,w){"use strict";return i.extend({newForm:null,dimDialog:null,categoryList:null,dimensionList:null,dbDimensionList:null,dimensionWithDisplayUnitList:null,dbDisplayUnitList:null,newTextField:null,precisionList:null,missedTargetActionList:null,parameterTemplate:null,formFields:null,defaultDimensionModel:null,target:null,options:null,dialog:null,charTitle:null,carryOverDimension:null,dimensionUnitMap:null,testMethodModel:null,searchKeyMappings:{testmethods:{resourceid:"physicalid","ds6w:what/ds6w:status":"CURRENT","ds6w:label":"LABEL","ds6w:identifier":"name","ds6w:what/ds6w:type":"type","ds6w:who/ds6w:responsible":"owner"}},init:function(e){this._parent(e),this.testMethodsList,this.appCore=e.appCore,this.target=widget.body,this.createCloseAction=e.createCloseAction,this.createAction=e.createAction,this.parentId=e.parentId,this.parentTitle=e.title,this.container=widget.body,this.modelEvents=e.modelEvents,this.mTestMethodIds=[],this.allDimensionSetControl,this.isSpecificationLimitsDisabled=e.isSpecificationLimitsDisabled,this.isRoutineReleaseLimitsDisabled=e.isRoutineReleaseLimitsDisabled},loadFields:function(){var e=JSON.parse(I);h.maskLoader(this.container);var i=e.fields.groupHeader,t=[],a=this.isSpecificationLimitsDisabled,s=this.isRoutineReleaseLimitsDisabled;i.forEach((function(e){"label_RoutineReleaseLimit"===e.groupLabel&&s||"label_SpecificationLimit"===e.groupLabel&&a||t.push(e)})),e.fields.groupHeader=t,this.initCreatForm(e)},_performSearch:function(e){},initCreatForm:async function(i){var l=i,r=this;await this.loadParameterTemplatesAndArbitraryUnits(),await this.loadDefaultDimensionPrefList(),this.loadAllDimensionDisplayUnits();if(this.newForm=new d(l).render(),this.formFields=this.newForm.formfieldControls,this.searchTestMethods(),this.parameterTemplate&&this.parameterTemplate.length>0){const e=this.parameterTemplate.map((e=>({labelItem:e.labelNLS,valueItem:{title:e.labelNLS,...Object.fromEntries(Object.entries(e).filter((([e])=>"labelNLS"!==e)))}})));this.newForm.updateField(e,"ParameterTemplate",!1),this.formFields.ParameterTemplate.inputfield.value=w.placeHolder_MissedTargetAction}this.allDimensionUnits&&this.allDimensionUnits.length>0&&(this.newForm.updateField(this.allDimensionUnits,"DisplayUnit",!1),this.newForm.dimensionUnit=this.allDimensionUnits);var p=this.options;p.Title=w.label_NewCharacteristics+" | "+this.parentTitle,p.Content=this.newForm.container,p.width=580,p.height=500,p.renderTo=this.target,h.unmaskLoader(this.container),this.dialog=new o(p),this.dialog.destroyPrevDialog(),this.dialog.render(),this.newForm.listenTo(this.newForm,"EVENT_TYPE_CHANGE",(function(e){var i=e.field;c.KEY_DIMENSION===i&&r.dimensionChangeEvent(l)})),this.newForm.listenTo(this.newForm,"SELECT_CHANGE_EVENT",(e=>r.evt_SelectChange(e))),this.newForm.listenTo(this.newForm,"SELECT_CHANGE_EMPTY_EVENT",(function(e){"parametertemplate"===e.toLowerCase()&&r.newForm.resetFields(),"dimension"===e.toLowerCase()&&(r.newForm.updateField(null,"DisplayUnit",!1),r.formFields.DisplayUnit.inputfield.value="",r.formFields.Precision.inputfield.value=""),r.newForm.dispatchEvent("CONTAINS_DIRTY_FIELD")})),this.newForm.listenTo(this.newForm,"InvalidValueChange",(function(e){r.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!1)})),this.newForm.listenTo(this.newForm,"UNCOMMITTED_AUTOCOMPLETE",(function(e){this.carryOverDimension=e})),this.newForm.listenTo(this.newForm,"CONTAINS_DIRTY_FIELD",(function(e){r.formFields.Type.inputfield.value===c.MEASUREMENT_CHAR&&(r.formFields.Dimension.inputfield.value||r.formFields.DimensionText.inputfield.value)&&r.formFields.Title.inputfield.value?null!==e&&e&&e.hasDirtyField?r.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!1):(r.checkLimitsFields(r.formFields),r.formFields.Dimension.inputfield.value&&"USER_DEFINED_UNIT"!==r.formFields.Dimension.inputfield.value&&!r.formFields.DisplayUnit.inputfield.value||r.formFields.IncludedLowerTarget.inputfield.checkFlag&&!r.formFields.LowerTarget.inputfield.value||r.formFields.IncludedUpperTarget.inputfield.checkFlag&&!r.formFields.UpperTarget.inputfield.value||r.formFields.LowerTarget.inputfield.value&&r.formFields.UpperTarget.inputfield.value&&r.formFields.LowerTarget.inputfield.value==r.formFields.UpperTarget.inputfield.value&&(!r.formFields.IncludedLowerTarget.inputfield.checkFlag||!r.formFields.IncludedUpperTarget.inputfield.checkFlag)||r.formFields.LowerTarget.inputfield.value&&r.formFields.LowerTarget.inputfield.value===r.formFields.Target.inputfield.value&&!r.formFields.IncludedLowerTarget.inputfield.checkFlag||r.formFields.UpperTarget.inputfield.value&&r.formFields.UpperTarget.inputfield.value===r.formFields.Target.inputfield.value&&!r.formFields.IncludedUpperTarget.inputfield.checkFlag||!r.isRoutineReleaseLimitsDisabled&&r.formFields.LowerRoutineIncluded.inputfield.checkFlag&&!r.formFields.LowerRoutineReleaseLimit.inputfield.value||!r.isRoutineReleaseLimitsDisabled&&r.formFields.UpperRoutineIncluded.inputfield.checkFlag&&!r.formFields.UpperRoutineReleaseLimit.inputfield.value||!r.isSpecificationLimitsDisabled&&r.formFields.LowerSpecificationIncluded.inputfield.checkFlag&&!r.formFields.LowerSpecificationLimit.inputfield.value||!r.isSpecificationLimitsDisabled&&r.formFields.UpperSpecificationIncluded.inputfield.checkFlag&&!r.formFields.UpperSpecificationLimit.inputfield.value?r.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!1):r.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!0)):r.formFields.Type.inputfield.value===c.DESCRIPTIVE_CHAR&&r.formFields.Title.inputfield.value?r.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!0):r.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!1)})),this.newForm.listenTo(this.newForm,"TYPE_TOGGLE_CHANGE",(function(e){var i={hasDirtyField:!1};r.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",i)})),this.newForm.listenTo(this.newForm,"EVENT_TEST_METHOD_BUTTON_CLICK",(function(e){var i=this.formfieldControls.TestMethod,t=this.mTestMethodIds;i.inputfield.value;new T({testMethodField:i,testMethodsIds:t})})),this.newForm.listenTo(this.newForm,"EVENT_DIMENSION_BUTTON_CLICK",(function(i){var l=this,d=[];if("undefined"!=typeof widget){var m=r.dimensionWithDisplayUnitList;m.sort((function(e,i){let t=e.displayName.toLowerCase(),a=i.displayName.toLowerCase();return t>a?1:t<a?-1:0}));for(var p=new e.Element("div",{class:"Dimension-List-Container"}),c=new a({type:"radio"}),u=new n({}),h=0;h<m.length;h++)c.addChild(new t({type:"radio",label:m[h].displayName,value:m[h].id}));this.dimensionButtonGroup=c;var f=new s({domId:i.domId||"charDimSearchEditor",placeholder:w.placeHolder_SelectDimension,displayClearFieldButtonFlag:!0,value:this.carryOverDimension});d.push(f),f.inject(p),f.addEventListener("uncommittedChange",function(e){for(var i=e.dsModel.valueToCommit||l.carryOverDimension,t=l.dimensionButtonGroup.elements.container.getChildren(),a=0;a<t.length;a++){var s=t[a],n=t[a].getChildren()[1].getText();i&&-1!==n.toUpperCase().indexOf(i.toUpperCase())||n===w.label_OtherDimension?(console.log(n),s.hasClassName("char-dim-hide")&&s.removeClassName("char-dim-hide")):""!=i&&s.addClassName("char-dim-hide")}l.carryOverDimension=null}.bind(this.dimDialog)),f.addEventListener("change",function(e){if(""===e.dsModel.value)for(var t=l.dimensionButtonGroup.elements.container.getChildren(),a=0;a<t.length;a++){var s=t[a];s.hasClassName("char-dim-hide")&&s.removeClassName("char-dim-hide")}l.dimDialog.dispatchEvent("CONTAINS_DIRTY_FIELD",i)}.bind(this.dimDialog)),d.push(c),c.inject(p),c.addEventListener("change",function(e){l.dimDialog.dispatchEvent("CONTAINS_DIRTY_FIELD",i)}.bind(this.dimDialog)),r.allDimensionSetControl=d,r.allDimensionModel=u;var g=this.options;g.Title=w.label_Dimension,g.Content=p,g.width=500,g.height=400,g.renderTo=r.target,g.RemoveApplyButton=!0,g.OKLabel=w.label_Button_Ok,this.dimDialog=new o(g),this.dimDialog.render(),this.carryOverDimension&&f.fire("uncommittedChange"),l.dimDialog.listenTo(l.dimDialog,"EVENT_CLICK_CHAR_OK",(function(e){r.allDimensionSetControl[0].value;var i=r.allDimensionSetControl[1].value;if(i.length>0){var t=i[0];r.allDimensionSetControl[1].getButtonFromValue(t).label}r.formFields.Dimension.inputfield.value=t,l.dimDialog.closeDialog()}))}})),this.initTypeList(),this.loadPrecision(),this.loadMissedTargetAction(),this.formFields.Precision.fieldControl.getTextFromValue=function(){return(0===this.value?0:1/Math.pow(10,this.value)).toString()};var u={};u.formFields=this.formFields,u.parentId=this.parentId,u.testMethods=this.testMethodsList,u.isRoutineReleaseLimitsDisabled=this.isRoutineReleaseLimitsDisabled,u.isSpecificationLimitsDisabled=this.isSpecificationLimitsDisabled;var f,g=new v(u);this.createCharInput=g,this.dialog.listenTo(this.dialog,"EVENT_CLICK_CHAR_OK",(function(){if(r.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!1),r.validateFields()){if(f=g.setRequestInputs({}),r.charData=f,r.charTitle=r.charData.title,r.showCreateLoader(),f)this.charTitle=f.Title,(new m).createCharacteristics(f).then(r.createCharCallBack.bind(r),r.onError.bind(r));else console.log("Unable to get input parameters for create characteristics."),r.stopLoader()}})),this.dialog.listenTo(this.dialog,"EVENT_CLICK_CHAR_APPLY",(function(){if(r.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!1),r.validateFields()){if(f=g.setRequestInputs({}),r.charData=f,r.charTitle=r.charData.title,r.showCreateLoader(),f)this.charTitle=f.Title,(new m).createCharacteristics(f).then(r.createCharApplyCallBack.bind(r),r.onError.bind(r));else console.log("Unable to get input parameters for create characteristics."),r.stopLoader()}}))},setKeyMappings:function(e){this._keyMappings=e},getKeyMappings:function(){return this._keyMappings},searchTestMethods:function(){var e,i=[],t=this;g.getloginUser();e={key:"query",value:'(flattenedtaxonomies:"types/Test Method Specification" AND (current==Release OR current==RELEASED) AND latestrevision==TRUE)'},t.setKeyMappings(t.searchKeyMappings),(new f).searchTestMethods(e,["id","ds6w:originator","ds6w:identifier","ds6w:label","ds6w:created","ds6w:policy","ds6w:type"],null).then((function(e){var a;if("string"==typeof e&&(a=JSON.parse(e)),a){for(var s=a.infos.nresults,l=a.results,n=t.getKeyMappings().testmethods,o=0;o<s;o++){for(var d=l[o].attributes,m={},p=0;p<d.length;p++){var c=d[p],u=c.name;n.hasOwnProperty(u)&&(m[n[u]]=c.dispValue||c.value,c.dispValue&&(m[n[u].concat("actualValue")]=c.value))}i.push(m)}t.testMethodsList=i,t.testMethodMap=new Map;var h=t.formFields.TestMethod.inputfield.elementsTree;for(o=0;o<i.length;o++){var f=new r({label:i[o].name+" : "+i[o].LABEL,value:i[o].physicalid});h.addChild(f),t.testMethodMap.set(i[o].physicalid,{name:i[o].name,title:i[o].LABEL})}t.testMethodModel=h}})).catch((function(e){h.unmaskLoader(t.container),p.clearNotifications(),p.displayNotification({eventID:"warning",msg:e})}))},showCreateLoader:function(){var e=this.charTitle,i=w.replace(w.get("CreatingCharacteristic"),{title:e});h.maskLoader(this.container,i)},stopLoader:function(){h.unmaskLoader(this.container)},loadDefaultDimensionPrefList:function(){var e=this;return(new m).getDimensionDisplayUnitSet().then((function(i){if(void 0!==i){var t=JSON.parse(i),a=[];e.dimensionUnitMap=new Map,t.forEach((function(i){i.units.forEach((function(e){var t={labelItem:`${e.displayName} (${i.displayName})`,valueItem:e.id};a.push(t)})),e.dimensionUnitMap.set(i.id,i.displayName)})),e.arbitraryunits&&Array.isArray(e.arbitraryunits)&&e.arbitraryunits.forEach((function(e){var i={labelItem:`${e.symbolNLS} (${w.label_ArbitraryUnit})`,valueItem:e.uri};a.push(i)})),a.sort(((e,i)=>e.labelItem.toLowerCase().localeCompare(i.labelItem.toLowerCase()))),e.allDimensionUnits=a}})).catch((function(){console.error("Failed to get All Dimensions and Display Units List!")}))},loadAllDimensionDisplayUnits:function(){var e=this;(new m).getDimensionDisplayUnitSet().then((function(i){if(void 0!==i){var t=JSON.parse(i);e.dimensionWithDisplayUnitList=t}})).catch((function(e){}))},loadPrecision:function(){var e=[{labelItem:"0.1",valueItem:"0.1"},{labelItem:"0.01",valueItem:"0.01"},{labelItem:"0.001",valueItem:"0.001"},{labelItem:"0.0001",valueItem:"0.0001"},{labelItem:"0.00001",valueItem:"0.00001"},{labelItem:"0.000001",valueItem:"0.000001"},{labelItem:"0.0000001",valueItem:"0.0000001"},{labelItem:"0.00000001",valueItem:"0.00000001"},{labelItem:"0.000000001",valueItem:"0.000000001"},{labelItem:"0.0000000001",valueItem:"0.0000000001"}];this.precisionList=e,e.length>0&&null!=e&&(this.newForm.updateField(e,"Precision",!1),this.formFields.Precision.inputfield.placeholder=w.placeHolder_Precision)},loadMissedTargetAction:function(){var e=[{labelItem:w.label_NoActionRequired,valueItem:"No Action Required"},{labelItem:w.label_HoldandRetest,valueItem:"Hold and Retest"},{labelItem:w.label_ShipandMonitor,valueItem:"Ship and Monitor"}];this.missedTargetActionList=e,e.length>0&&null!=e&&(this.formFields.MissedTargetAction.inputfield.placeholder=w.placeHolder_MissedTargetAction,this.newForm.updateField(e,"MissedTargetAction",!1),this.formFields.MissedTargetAction.inputfield.value=e[0].valueItem)},loadParameterTemplatesAndArbitraryUnits:function(){let e=this;return(new m).getParameterTemplatesAndArbitraryUnits().then((i=>{void 0!==i&&(e.parameterTemplate=i.parameters?i.parameters:[],e.arbitraryunits=i.units?i.units:[])}))},dimensionChangeEvent:function(){var e={};e.formFields=this.formFields,e.allDimensionSet=this.dimensionWithDisplayUnitList,e.dimensionList=this.dimensionList;new D(e)},initTypeList:function(){var e=[{labelItem:w.typeMeasurement,valueItem:c.MEASUREMENT_CHAR},{labelItem:w.typeDescriptive,valueItem:c.DESCRIPTIVE_CHAR}];this.newForm.updateField(e,"Type",!1)},createCharApplyCallBack:function(e){var i=this;i.charData.testMethodsData=i.testMethodMap,i.charData.physicalId=e.data.physicalid;let t={extensions:e.data.interfaces,appCore:i.appCore};var a=u.createCharData(i.charData,t);if(null==e){h.unmaskLoader(i.container),i.stopLoader();var s=e.message;return p.clearNotifications(),void p.displayNotification({eventID:"error",msg:s||w.CharacteristicCreateFailure})}if(void 0!==e&&(h.unmaskLoader(i.container),i.createCloseAction(a,i),i.stopLoader(),p.clearNotifications(),p.displayNotification({eventID:"success",msg:w.CharacteristicCreateSuccess}),i.newForm.resetFields(),c.MEASUREMENT_CHAR===i.formFields.Type.fieldControl.value)){var l=[];l.push(i.formFields.DisplayUnit),l.push(i.formFields.Precision),u.hideUnhideToggle(l,"unhide");var n=[];n.push(i.formFields.PrecisionText),u.hideUnhideToggle(n,"hide"),i.formFields.DisplayUnit.fieldControl.fieldoptions.isMandatory=!0,document.getElementById("charLabel_UOM").getChildren()[0].getChildren()[0].show()}setTimeout(i.stopLoader(),1e3)},createCharCallBack:function(e){var i=this;i.charData.testMethodsData=i.testMethodMap,i.charData.physicalId=e.data.physicalid;let t={extensions:e.data.interfaces,appCore:i.appCore};var a=u.createCharData(i.charData,t);if(i.charTitle=a.title,null==e){h.unmaskLoader(i.container);var s=e.message;return p.clearNotifications(),void p.displayNotification({eventID:"error",msg:s||w.CharacteristicCreateFailure})}void 0!==e&&(i.createCloseAction(a,i),i.dialog.closeDialog(),i.showCreateLoader(),p.clearNotifications(),p.displayNotification({eventID:"success",msg:w.CharacteristicCreateSuccess})),setTimeout(i.stopLoader(),1e3)},enableOrDisableDialogButtons:function(e){e?this.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",{hasDirtyField:!1}):this.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",{hasDirtyField:!0})},onError:function(e){this.enableOrDisableDialogButtons(!1),this.stopLoader(),this.newForm.resetFields(),h.unmaskLoader(this.container),e&&(e.includes("No changetype access to business object 'PlmParameter")||e.includes("No fromconnect access to business object 'VPMReference"))?(p.clearNotifications(),p.displayNotification({eventID:"error",msg:w.Message_Error_CreateCharAccess})):(p.clearNotifications(),p.displayNotification({eventID:"error",msg:e||w.Message_Error_CreateCharAccess}))},resetToolTip:function(){this.formFields.Template.inputfield.tooltipInfos=new l({shortHelp:""})},setToolTip:function(e){this.formFields.Template.inputfield.tooltipInfos=new l({shortHelp:e.description})},validateFields:function(){var i,t,a,s,l,n=!0,r=!1;for(i in this.formFields)if(this.formFields.hasOwnProperty(i)){var o=this.formFields[i];if(e.is(o.inputfield.fieldoptions)&&(l=!e.is(o.inputfield.fieldoptions.visible)||o.inputfield.fieldoptions.visible,a=!!e.is(o.inputfield.fieldoptions.isMandatory)&&o.inputfield.fieldoptions.isMandatory),o.inputfield.fieldoptions)if(s=e.is(o.inputfield.fieldoptions.fieldName)?o.inputfield.fieldoptions.fieldName:"",l&&a)if(!this.hasValue(o.inputfield.value))o.inputfield._giveFocus(),r=!0,t=void 0!==t?t+","+s:s,n=!1}return p.clearNotifications(),r&&p.displayNotification({eventID:"error",msg:w.RequiredFields+t}),n},hasValue:function(e){return null!=e&&""!==e},checkLimitsFields:function(e){var i=this;e.IncludedLowerTarget.inputfield.checkFlag&&!e.LowerTarget.inputfield.value||e.IncludedUpperTarget.inputfield.checkFlag&&!e.UpperTarget.inputfield.value?i.newForm.toggleErrorMessage("acceptancecriteria",w.LowerUpperValueIfIncEnabled,!0):!e.LowerTarget.inputfield.value||!e.UpperTarget.inputfield.value||e.LowerTarget.inputfield.value!=e.UpperTarget.inputfield.value||e.IncludedLowerTarget.inputfield.checkFlag&&e.IncludedUpperTarget.inputfield.checkFlag?e.LowerTarget.inputfield.value&&""!==e.LowerTarget.inputfield.value&&e.LowerTarget.inputfield.value===e.Target.inputfield.value&&!e.IncludedLowerTarget.inputfield.checkFlag?i.newForm.toggleErrorMessage("acceptancecriteria",w.lowerIncCheck,!0):e.UpperTarget.inputfield.value&&""!==e.UpperTarget.inputfield.value&&e.UpperTarget.inputfield.value===e.Target.inputfield.value&&!e.IncludedUpperTarget.inputfield.checkFlag?i.newForm.toggleErrorMessage("acceptancecriteria",w.upperIncCheck,!0):i.newForm.toggleErrorMessage("acceptancecriteria","",!1):i.newForm.toggleErrorMessage("acceptancecriteria",w.activateInc,!0),this.isRoutineReleaseLimitsDisabled||(e.LowerRoutineIncluded.inputfield.checkFlag&&!e.LowerRoutineReleaseLimit.inputfield.value||e.UpperRoutineIncluded.inputfield.checkFlag&&!e.UpperRoutineReleaseLimit.inputfield.value?i.newForm.toggleErrorMessage("routinereleaselimit",w.LowerUpperRoutineValueIfIncEnabled,!0):i.newForm.toggleErrorMessage("routinereleaselimit",w.LowerUpperRoutineValueIfIncEnabled,!1)),this.isSpecificationLimitsDisabled||(e.LowerSpecificationIncluded.inputfield.checkFlag&&!e.LowerSpecificationLimit.inputfield.value||e.UpperSpecificationIncluded.inputfield.checkFlag&&!e.UpperSpecificationLimit.inputfield.value?i.newForm.toggleErrorMessage("specificationlimit",w.LowerUpperSpecificationValueIfIncEnabled,!0):i.newForm.toggleErrorMessage("specificationlimit",w.LowerUpperSpecificationValueIfIncEnabled,!1))},evt_SelectChange:function(e){var i=this;"type"===e.toLowerCase()&&("DescriptiveCharacteristic"===i.formFields.Type.inputfield.value?((s=[]).push(i.formFields.Dimension),s.push(i.formFields.DisplayUnit),s.push(i.formFields.Precision),s.push(i.formFields.DimensionText),s.push(i.formFields.PrecisionText),s.push(i.formFields.LowerTarget),s.push(i.formFields.Target),s.push(i.formFields.TargetNew_Parameter),s.push(i.formFields.UpperTarget),s.push(i.formFields.IncludedLowerTarget),s.push(i.formFields.IncludedUpperTarget),u.hideUnhideToggle(s,"hide"),i.formFields.Target.inputfield.value="",i.formFields.TargetNew.inputfield.value="",(a=[]).push(i.formFields.TargetNew),u.hideUnhideToggle(a,"unhide"),i.formFields.Dimension.fieldControl.fieldoptions.isMandatory=!1,i.formFields.Dimension.fieldControl.hasDirtyField=!1,i.formFields.DisplayUnit.fieldControl.fieldoptions.isMandatory=!1,i.formFields.DisplayUnit.fieldControl.hasDirtyField=!1,document.getElementById("charLabel_Dimension").getParent().getParent().hide(),document.getElementById("charLabel_UOM").getParent().getParent().hide(),document.getElementById("charLabel_Precision").getParent().getParent().hide(),document.getElementById("charLineEditorlowertarget").getParent().getParent().hide(),document.getElementById("charLineEditoruppertarget").getParent().getParent().hide(),document.getElementById("routinereleaselimit_error_icon")&&document.getElementById("routinereleaselimit_error_icon").getParent().getParent().getParent().hide(),document.getElementById("specificationlimit_error_icon")&&document.getElementById("specificationlimit_error_icon").getParent().getParent().getParent().hide(),document.getElementById("charLineEditortarget").hide(),document.getElementById("acceptancecriteria_error_icon").hide()):((s=[]).push(i.formFields.PrecisionText),s.push(i.formFields.TargetNew),s.push(i.formFields.TargetNew_Parameter),u.hideUnhideToggle(s,"hide"),(a=[]).push(i.formFields.Dimension),a.push(i.formFields.DisplayUnit),a.push(i.formFields.Precision),a.push(i.formFields.Target),a.push(i.formFields.LowerTarget),a.push(i.formFields.Target),a.push(i.formFields.UpperTarget),a.push(i.formFields.IncludedLowerTarget),a.push(i.formFields.IncludedUpperTarget),u.hideUnhideToggle(a,"unhide"),i.formFields.Target.inputfield.value="",i.formFields.TargetNew.inputfield.value="",i.formFields.Dimension.inputfield.value="",i.formFields.DimensionText.inputfield.value="",i.formFields.DisplayUnit.inputfield.value="",document.getElementById("charLabel_Dimension").getParent().getParent().show(),document.getElementById("charLabel_UOM").getParent().getParent().show(),document.getElementById("charLabel_Precision").getParent().getParent().show(),document.getElementById("charLineEditorlowertarget").getParent().getParent().show(),document.getElementById("charLineEditoruppertarget").getParent().getParent().show(),document.getElementById("routinereleaselimit_error_icon")&&document.getElementById("routinereleaselimit_error_icon").getParent().getParent().getParent().show(),document.getElementById("specificationlimit_error_icon")&&document.getElementById("specificationlimit_error_icon").getParent().getParent().getParent().show(),document.getElementById("charLineEditortarget").show(),document.getElementById("acceptancecriteria_error_icon").show(),i.formFields.Dimension.fieldControl.fieldoptions.isMandatory=!0,i.formFields.DisplayUnit.fieldControl.fieldoptions.isMandatory=!0,i.formFields.LowerTarget.inlineContainer.show(),i.formFields.UpperTarget.inlineContainer.show(),i.formFields.DisplayUnit.inlineContainer.show(),i.formFields.LowerSpecificationLimit&&i.formFields.LowerSpecificationLimit.expander.show(),i.formFields.LowerRoutineReleaseLimit&&i.formFields.LowerRoutineReleaseLimit.expander.show(),this.newForm.dispatchEvent("CONTAINS_DIRTY_FIELD")));if(("description"===e.toLowerCase()||"characteristicsnotes"===e.toLowerCase()||"missedtargetaction"===e.toLowerCase())&&"DescriptiveCharacteristic"===i.formFields.Type.inputfield.value&&null!=this.formFields.ParameterTemplate.inputfield.value){const e=this.formFields.TargetNew.inputfield.value,t=this.formFields.ParameterTemplate.inputfield.value.possibleValues;let a=!0;null==t?a=!0:(a=t.includes(e),a||i.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!1))}if("displayunit"===e.toLowerCase()){i.formFields.Dimension.inputfield.value="";var t=this.formFields.DisplayUnit.inputfield.value;if(this.arbitraryunits.some((e=>e.uri===t)))i.formFields.Dimension.inputfield.value=w.label_ArbitraryUnit,i.formFields.DimensionText.inputfield.value="ArbitraryUnit",this.newForm.dispatchEvent("CONTAINS_DIRTY_FIELD",!0);else{var a,s,l=this.dimensionWithDisplayUnitList.find((e=>e.units.some((e=>e.id===t))));l.displayName;i.formFields.Dimension.inputfield.value=l.displayName,i.formFields.DimensionText.inputfield.value=l.id,i.formFields.Dimension.inputfield.disabled=!0,i.formFields.Precision.inputfield.value=0,(a=[]).push(i.formFields.DisplayUnit),a.push(i.formFields.Precision),u.hideUnhideToggle(a,"unhide"),(s=[]).push(i.formFields.PrecisionText),u.hideUnhideToggle(s,"hide"),i.formFields.DisplayUnit.fieldControl.fieldoptions.isMandatory=!0,document.getElementById("charLabel_UOM").getChildren()[0].getChildren()[0].show();var n={};n.formFields=this.formFields,n.allDimensionSet=this.dimensionWithDisplayUnitList,n.dimensionList=this.dimensionUnitMap;new D(n);this.newForm.dispatchEvent("CONTAINS_DIRTY_FIELD")}}if("dimension"===e.toLowerCase()&&this.newForm.dispatchEvent("CONTAINS_DIRTY_FIELD"),"targetnew_parameter"===e.toLowerCase()&&(this.formFields.TargetNew.inputfield.value=this.formFields.TargetNew_Parameter.inputfield.value,""==this.formFields.TargetNew_Parameter.inputfield.value?this.formFields.TargetNew_Parameter.inputfield.placeholder="":this.formFields.TargetNew_Parameter.inputfield.placeholder=w.placeHolder_SelectTarget),"parametertemplate"===e.toLowerCase()){this.newForm.dispatchEvent("CONTAINS_DIRTY_FIELD");var r=this.formFields.ParameterTemplate.inputfield.value;this.formFields.Type&&(this.formFields.Type.inputfield.disabled=!1),this.formFields.Title&&(this.formFields.Title.inputfield.disabled=!1),this.formFields.DisplayUnit&&(this.formFields.DisplayUnit.inputfield.value=""),this.formFields.DisplayUnit.inputfield.disabled=!1,this.formFields.TargetNew&&(this.formFields.TargetNew.inputfield.disabled=!1),this.formFields.TargetNew_Parameter&&(this.formFields.TargetNew_Parameter.inputfield.disabled=!1),"String"===r.type?this.formFields.Type.inputfield.value="DescriptiveCharacteristic":this.formFields.Type.inputfield.value="MeasurementCharacteristic",this.formFields.Type.inputfield.disabled=!0,Object.keys(r).forEach((e=>{switch(e){case"title":this.formFields.Title.inputfield.value=r.title,this.formFields.Title.inputfield.disabled=!0;break;case"possibleValues":if(this.formFields.TargetNew&&this.formFields.TargetNew_Parameter)if(Array.isArray(r.possibleValues)&&r.possibleValues.length>1){u.hideUnhideToggle([this.formFields.TargetNew],"hide"),u.hideUnhideToggle([this.formFields.TargetNew_Parameter],"unhide");const e=r.possibleValues.map((e=>({labelItem:e,valueItem:e})));this.newForm.updateField(e,"TargetNew_Parameter",!1),i.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!1)}else u.hideUnhideToggle([this.formFields.TargetNew_Parameter],"hide"),u.hideUnhideToggle([this.formFields.TargetNew],"unhide"),this.formFields.TargetNew.inputfield.value=r.possibleValues?.[0]||"",this.formFields.TargetNew.inputfield.disabled=!0;break;case"dimension":if(this.formFields.Dimension)if("ArbitraryUnit"==r.dimension){if(this.formFields.Dimension.inputfield.value=w.label_ArbitraryUnit,this.formFields.DimensionText.inputfield.value="ArbitraryUnit",this.formFields.Dimension.inputfield.disabled=!0,r.unit&&Array.isArray(r.unit)&&r.unit.length>0){const e=this.arbitraryunits.filter((e=>r.unit.includes(e.uri))).map((e=>({labelItem:`${e.symbolNLS} (${w.label_ArbitraryUnit})`,valueItem:e.uri})));e.length>0&&this.newForm.updateField(e,"DisplayUnit",!1),1==e.length&&(this.formFields.DisplayUnit.inputfield.value=e[0].valueItem,this.formFields.DisplayUnit.inputfield.disabled=!0)}}else{const e=(e,i)=>i.find((i=>i.name===`DSDim_${e.dimension}`||i["3DSpaceDimensionName"]===`DSDim_${e.dimension}`)),i=e(r,this.dimensionWithDisplayUnitList);if(i&&(this.formFields.Dimension.inputfield.value=i.displayName,this.formFields.DimensionText.inputfield.value=i.id,this.formFields.Dimension.inputfield.disabled=!0),r.unit){if(this.formFields.DisplayUnit&&Array.isArray(r.unit)&&r.unit.length>0){const e=((e,t)=>e.map((e=>t?.units?.find((i=>i.name===e)))).filter(Boolean).map((e=>({labelItem:`${e.displayName} (${i.displayName})`,valueItem:e.id}))))(r.unit,i);this.newForm.updateField(e,"DisplayUnit",!1),1==e.length&&(this.formFields.DisplayUnit.inputfield.value=e[0].valueItem,this.formFields.DisplayUnit.inputfield.disabled=!0)}}else if(i.units){const e=i.units.map((e=>({labelItem:`${e.displayName} (${i.displayName})`,valueItem:e.id})));this.newForm.updateField(e,"DisplayUnit",!1)}}}}))}}})}));