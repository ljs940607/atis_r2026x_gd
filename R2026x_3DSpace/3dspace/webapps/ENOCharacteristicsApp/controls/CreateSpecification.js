define("DS/ENOCharacteristicsApp/controls/CreateSpecification",["UWA/Core","UWA/Controls/Abstract","DS/Controls/TooltipModel","DS/ENOCharacteristicsApp/view/NewDialog","DS/ENOCharacteristicsApp/view/CreateCharacteristicsForm","DS/ENOCharacteristicsApp/service/CharacteristicsServiceWrapper","DS/ENOCharacteristicsApp/utils/Notification","DS/ENOCharacteristicsApp/utils/Constants","DS/ENOCharacteristicsApp/utils/CharacteristicsUtils","DS/ENOCharacteristicsApp/utils/CharacteristicsMask","text!DS/ENOCharacteristicsApp/assets/config/CreateSpecificationFields.json","i18n!DS/ENOCharacteristicsApp/assets/nls/ENOCharacteristicsApp"],(function(e,t,i,a,s,r,o,n,c,l,p,d){"use strict";return t.extend({newForm:null,formFields:null,defaultDimensionModel:null,target:null,options:null,dialog:null,init:function(e){this._parent(e),this.target=widget.body,this.createCloseAction=e.createCloseAction,this.createAction=e.createAction,this.parentId=e.parentId,this.container=widget.body,this.modelEvents=e.modelEvents,this.appCore=e.appCore,this.mTestMethodIds=[]},loadFields:function(){var e=JSON.parse(p);l.maskLoader(this.container),this.initCreatForm(e)},initCreatForm:function(e){var t=e;this.newForm=new s(t).render(),this.formFields=this.newForm.formfieldControls;var i=this,o=this.options;o.Title=d.label_Performance_Specifications,o.Content=this.newForm.container,o.width=580,o.renderTo=this.target,l.unmaskLoader(this.container),this.dialog=new a(o),this.dialog.destroyPrevDialog(),this.dialog.render(),this.newForm.listenTo(this.newForm,"CONTAINS_DIRTY_FIELD",(function(e){i.formFields.Type.inputfield.value&&i.formFields.Title.inputfield.value?i.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!0):i.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!1)})),this.newForm.listenTo(this.newForm,"UNCOMMITTED_TYPE",(function(){i.newForm.updateField(c.allTypeSet,"Type",!1)}));var n=function(){var e={};return e.formFields=i.formFields,e.parentId=i.parentId,e};this.dialog.listenTo(this.dialog,"EVENT_CLICK_CHAR_OK",(function(){i.enableOrDisableDialogButtons(!0);var e;e=n();var t={};(t.title=e.formFields.Title.inputfield.value,t.description=e.formFields.Description.inputfield.value,t.notes=e.formFields.Notes.inputfield.value,t.type=e.formFields.Type.inputfield.value,i.specData=t,t)?(new r).createSpecification(t,e.parentId).then(i.createSpecCallBack.bind(i),i.onError.bind(i)):(console.log("Unable to get input parameters for create characteristics."),i.stopLoader())})),this.dialog.listenTo(this.dialog,"EVENT_CLICK_CHAR_APPLY",(function(){i.enableOrDisableDialogButtons(!0);var e;e=n();var t={};(t.title=e.formFields.Title.inputfield.value,t.description=e.formFields.Description.inputfield.value,t.notes=e.formFields.Notes.inputfield.value,t.type=e.formFields.Type.inputfield.value,i.specData=t,t)?(new r).createSpecification(t,e.parentId).then(i.createSpecCallBackCreate.bind(i),i.onError.bind(i)):(console.log("Unable to get input parameters for create characteristics."),i.stopLoader())})),this.initTypeList()},enableOrDisableDialogButtons:function(e){e?this.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!1):this.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!0)},createSpecCallBack:function(e){var t=this;t.specData.physicalid=e.data.physicalid;let i={extensions:e.data.interfaces,appCore:t.appCore};var a=c.createSpecData(t.specData,i);if(null==e){l.unmaskLoader(t.container);var s=e.message;return o.clearNotifications(),void o.displayNotification({eventID:"error",msg:s||d.SpecificationCreateFailure})}void 0!==e&&(t.createCloseAction(a,t),t.dialog.closeDialog(),t.showCreateLoader(),o.clearNotifications(),o.displayNotification({eventID:"success",msg:d.SpecificationCreateSuccess})),setTimeout(t.stopLoader(),1e3)},createSpecCallBackCreate:function(e){var t=this;t.specData.physicalid=e.data.physicalid;let i={extensions:e.data.interfaces,appCore:t.appCore};var a=c.createSpecData(t.specData,i);if(null==e){l.unmaskLoader(t.container);var s=e.message;return o.clearNotifications(),void o.displayNotification({eventID:"error",msg:s||d.SpecificationCreateFailure})}void 0!==e&&(t.createCloseAction(a,t),t.showCreateLoader(),o.clearNotifications(),o.displayNotification({eventID:"success",msg:d.SpecificationCreateSuccess})),t.newForm.resetFields(),setTimeout(t.stopLoader(),1e3)},onError:function(e){this.enableOrDisableDialogButtons(!1),this.stopLoader(),this.newForm.resetFields(),l.unmaskLoader(this.container),o.clearNotifications(),o.displayNotification({eventID:"error",msg:d.Message_Error_CreateSpecAccess||e})},showCreateLoader:function(){l.maskLoader(this.container)},stopLoader:function(){l.unmaskLoader(this.container)},initTypeList:function(){var e=this;e.newForm.updateField(c.allTypeSet,"Type",!1),1==c.allTypeSet.length&&(e.formFields.Type.inputfield.value=c.allTypeSet[0].valueItem,e.formFields.Type.inputfield.disabled=!0)}})}));