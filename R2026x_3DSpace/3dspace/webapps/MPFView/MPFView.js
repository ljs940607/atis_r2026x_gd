define("DS/MPFView/ControlsTag",["UWA/Core","UWA/Class/View","DS/UIKIT/Input/Text","DS/MPFServices/ObjectService","css!DS/MPFView/MPFView"],(function(e,t,i,s){"use strict";const n=Object.freeze({ON_CHANGE:"onChange",DELETE:"delete"}),a=Object.freeze({READ:"read",EDIT:"edit"}),r=t.extend({className:"mpf-controls-tag",setup:function(e={}){s.requiredOfType(e.value,"string","options.value must be a string"),this.value=e.value,this.validator=e.validator||function(){return!0},this.currentMode=e.currentMode||a.READ,this.isReadOnly=!0===e.isReadOnly,this.tag=this._createReadTag(),this.deleteButton=this._createDeleteButton(),this.input=this._createTextInput()},render:function(){let e;return this.currentMode===a.EDIT?(this._adaptInputSize(),this.input.setValue(this.value),e=this.input):(this.tag.setText(this.value),e={tag:"div",class:"mpf-input-group",html:[this.tag,this.deleteButton]}),this.container.setContent(e),this},destroy:function(){this.deleteButton.destroy(),this.tag.destroy(),this._parent(),this.container=null},setReadMode:function(){this.currentMode===a.EDIT&&(this._removeErrors(),this.value=this.input.getValue(),this.currentMode=a.READ,this.render())},setEditMode:function(){!0!==this.isReadOnly&&this.currentMode===a.READ&&(this.currentMode=a.EDIT,this.render(),this.input.setFocus())},showError:function(t){e.is(t,"string")&&(this._removeErrors(),this.container.addClassName("mpf-invalid"),this.errorContainer=e.createElement("div",{class:"mpf-error",text:t}).inject(this.container))},getValue:function(){return this.currentMode===a.READ?this.value:null},validate:function(e){return e=e||this.input.getValue(),this.validator(e)},_toReadMode:function(e){const t=this.validate();t.isValid?this.setReadMode():this.showError(t.message),e&&this.dispatchEvent(n.ON_CHANGE)},_createTextInput:function(){return new i({value:this.value,events:{onChange:this._toReadMode.bind(this,!0)},attributes:{events:{blur:this._toReadMode.bind(this,!1),keyup:e=>{13===e.keyCode&&this._toReadMode(!1)}}}})},_createReadTag:function(){return e.createElement("div",{class:"mpf-read-tag",events:{dblclick:this.setEditMode.bind(this)}})},_createDeleteButton:function(){return e.createElement("div",{class:"mpf-delete-button",html:[{tag:"span",class:"fonticon fonticon-cancel"}],events:{click:this.dispatchEvent.bind(this,n.DELETE)}})},_removeErrors:function(){this.container.removeClassName("mpf-invalid"),this.errorContainer&&(this.errorContainer.destroy(),this.errorContainer=null)},_adaptInputSize:function(){const e=this.container.getElement(".mpf-input-group");e&&this.input.elements.container.setStyle("width",e.getStyle("width"))}});return r.Events=n,r.Modes=a,r})),define("DS/MPFView/IconSelectInput",["UWA/Core","UWA/Element","DS/UIKIT/Input/Select"],(function(e,t,i){"use strict";return i.extend({addOption:function(i,s){const n=this.elements;let a,r,l=n.input,o=n.content;e.is(i,"object")?e.is(i.value)||(i.value=i.label):i=""+i,e.is(i,"object")||(i={value:i}),i.value=""+i.value,a=this.getOption(i,"option",void 0,!0);const h=!!a;if(h||(a=e.createElement("option"),this.custom&&(r=e.createElement("li",{class:"result-option"}))),i.group&&(l=this.getOption(i.group,"optgroup"),l?this.custom&&(o=this.getOption(l,void 0,!0).getElement("ul")):(l=e.createElement("optgroup",{label:i.group}).inject(n.input),this.custom&&(o=e.createElement("li",{class:"result-group",html:[{tag:"span",class:"result-group-label",text:i.group},{tag:"ul",class:"result-group-sub"}]}).inject(n.content).getElement("ul")))),!e.is(i.label)&&!e.is(i.value))return this;if(t.set.call(a,{text:e.is(i.label)?i.label:i.value,value:e.is(i.value)?i.value:i.label,selected:i.selected,disabled:i.disabled,attributes:i.attributes}),this.custom){if(r||(r=this.getOption(a,void 0,!0)),i.attributes&&Object.keys(i.attributes).forEach((function(e){r.setAttribute(e,i.attributes[e])})),""===i.label||!i.value&&!i.label)this.template.setOption(r,"&nbsp;",!0);else{const t=e.is(i.label)?i.label:i.value;i.icon?this.template.setOption(r,this._getLabelElement(t,i.icon,r),!0):this.template.setOption(r,t)}r.toggleClassName("result-option-disabled",!!i.disabled),h&&o===r.getParent()||r.inject(o,s),this.visible&&this.options.showTooltips&&this._setTooltip(r,r.getText())}return h&&l===a.getParent()||a.inject(l,s),this},setupTemplates:function(i){var s;this.template={},this.template.setOption=(s=!!i.template,function(e,i,n){var a={};a[s||n?"html":"text"]=i,t.set.call(e,a,i)}),this.template.getOption=function(e){return e.hasClassName("result-option")?e:e.hasClassName("mpf-option-label")?e.parentElement:void 0},this.template.setChoice=function(e,i,s){t.set.call(e,{text:i})},this.template.getText=function(e){return t.getText.call(e)},e.extend(this.template,i.template)},_getLabelElement:(e,t)=>[{tag:"span",class:"mpf-option-label fonticon fonticon-"+t},{tag:"span",class:"mpf-option-label",text:e}]})})),define("DS/MPFView/ValidationResultBuilder",["UWA/Class"],(function(e){"use strict";return e.extend({init(e={}){this.isValid=!1!==e.isValid,this.errors=e.errors&&e.errors.slice()||[]},addError(e,t){return this.isValid=!1,this.errors.push({field:e,message:t}),this},build(){return{isValid:this.isValid,errors:this.errors}}})})),define("DS/MPFView/FieldFileInput",["UWA/Core","UWA/Class/View","UWA/String","UWA/Promise","UWA/Class/Model","DS/UIKIT/Input/File","DS/UIKIT/Tooltip","DS/MPFServices/ObjectService","DS/MPFUtils/FormatUtils","i18n!DS/MPFView/assets/nls/FieldFileInput","css!DS/MPFView/MPFView"],(function(e,t,i,s,n,a,r,l,o,h){"use strict";const d=Object.freeze({NEW_FILE_SELECTED:"newFileSelected",INVALID_FILE_SELECTED:"invalidFileSelected",ON_SAVE:"onSave",ON_ERROR:"onError"}),c=t.extend({className:"mpf-file-entry mpf-entry-v2",domEvents:{change:"_onChange"},setup:function(e){this._parent(e),this.fileModel=e.fileModel,this.fieldName=e.fieldName,this.fieldLabel=e.fieldLabel,this.buttonText=e.buttonText,this.acceptedFileTypes=e.acceptedFileTypes,this.wrongFileTypeMessage=e.wrongFileTypeMessage,this.maxFileSize=e.maxFileSize,this.tooltip=e.tooltip,this.placeholder=e.placeholder||h.get("noFileSelected"),this.showTextInput=!1!==e.showTextInput,this.required=!0===e.required,this.readOnly=!0===e.readOnly,this.buttonBefore=!1!==e.buttonBefore,this.saveOnChange=!0===e.saveOnChange,this.saveOnChange&&l.requiredOfPrototype(this.fileModel,n,"options.fileModel must be a UWA/Class/Model if saveOnChange is set to true"),this.input=this._createInput(),this.entry=this._createEntry()},render:function(){return this.container.setContent(this.entry),this},destroy:function(){this.file=null,this.input.destroy(),this.fileModel=null,this._parent(),this.container=null},getFile:function(){return this.file},save:function(e){return this.fileModel?this.file?this._saveFile(this.file,e):s.resolve(this.fileModel):s.reject("file model is not defined")},setDisabled:function(e=!0){e?this.disable():this.enable()},enable:function(){this.input.enable()},disable:function(){this.input.disable()},isDisabled:function(){return this.input.isDisabled()},_saveFile:function(e,t){e=e||this.file;const i=s.deferred(),n=new FormData;return n.append("file",e),t||(t={}),t.method="POST",t.data=n,t.onComplete=i.resolve,t.onFailure=function(e,t,s){i.reject({model:e,response:t,options:s})},this.fileModel.save(null,t),i.promise},_onChange:function(t){if(this._removeErrorMessage(),e.is(t.target)&&e.is(t.target.files)&&t.target.files.length>0){const e=t.target.files[0];this.validate(e)?(this.file=e,this.dispatchEvent(d.NEW_FILE_SELECTED,this.file),this.saveOnChange&&this._saveFile(this.file).then((e=>{this.dispatchEvent(d.ON_SAVE,e)})).catch((e=>{this.showErrorMessage(h.get("fileUploadFailed")),this.dispatchEvent(d.ON_ERROR,e)}))):(this.file=null,this.dispatchEvent(d.INVALID_FILE_SELECTED,e))}},validate:function(t){return t=t||this.file,e.is(t)?this.acceptedFileTypes&&this.acceptedFileTypes.indexOf(t.type)<0?(this.showErrorMessage(this.wrongFileTypeMessage||h.get("wrongFileType")),!1):this.maxFileSize&&this.maxFileSize<t.size?(this.showErrorMessage(i.format(h.get("fileTooBig"),o.getReadableFileSize(this.maxFileSize))),!1):(this._removeErrorMessage(),!0):!this.required||(this.showErrorMessage(i.format(h.get("isRequired"),this.fieldLabel)),!1)},_createInput:function(){const e={name:this.fieldName,disabled:this.readOnly,input:this.showTextInput,buttonText:this.buttonText,buttonClassName:this.buttonClassName,multiple:this.allowMultipleFiles,buttonBefore:this.buttonBefore,placeholder:this.placeholder,required:this.required};return this.tooltip&&(e.attributes={title:this.tooltip},e.inputAttributes={title:this.tooltip}),new a(e)},_createEntry:function(){const t=[],i=[];return(this.fieldLabel||this.tooltip)&&(this.fieldLabel&&(t.push(this.fieldLabel),this.required&&""!==this.fieldLabel&&t.push('&nbsp;<em class="mpf-required">*</em>')),this.tooltip&&t.push(this._createTooltip()),i.push(e.createElement("span",{class:"mpf-label",html:t}))),i.push(this.input),e.createElement("label",{html:i})},_createTooltip:function(){const t=e.createElement("span",{class:"fonticon fonticon-info mpf-entry-tooltip"});return new r({target:t,body:this.tooltip}),t},showErrorMessage:function(t){e.is(t,"string")&&(this._removeErrorMessage(),this.entry.getElement(".input-file.input-group").addClassName("mpf-invalid"),e.createElement("p",{class:"mpf-error",text:e.is(t)?t:""}).inject(this.container))},isShowingError:function(){return!!this.container.getElement("p.mpf-error")},_removeErrorMessage:function(){this.entry.getElement(".input-file.input-group").removeClassName("mpf-invalid");const t=this.container.getElement("p.mpf-error");e.is(t)&&this.container.removeChild(t)}});return c.Events=d,c})),define("DS/MPFView/FieldReplaceImage",["UWA/Core","UWA/Class/View","UWA/Promise","UWA/String","DS/MPFServices/ObjectService","DS/MPFModel/MPFModel","i18n!DS/MPFView/assets/nls/FieldFileInput","css!DS/MPFView/MPFView"],(function(e,t,i,s,n,a,r){"use strict";const l=Object.freeze({UPDATE:"update",ERROR:"error"}),o=t.extend({domEvents:{change:"_onChange",click:"_onClick"},className:"mpf-entry-v2 mpf-field-replace-image",setup:function(e={}){this.imageModel=e.imageModel,n.requiredOfPrototype(this.model,a,"options.model must be a MPFModel"),n.requiredOfPrototype(this.imageModel,a,"options.imageModel must be a MPFModel"),n.requiredOfType(e.fieldName,"string","options.fieldName must be a string"),this.fieldName=e.fieldName,this.fieldLabel=e.fieldLabel,this.actionName=e.actionName||r.get("replaceImage"),this.imageShape=e.imageShape||"rectangle",this.saveOnChange=!0===e.saveOnChange,this.unsetFallback=e.unsetFallback,this.acceptedFileTypes=e.acceptedFileTypes||["image/jpeg","image/png","image/bmp","image/gif"],this.maxFileSize=e.maxFileSize,this.iconName=e.iconName||"retweet",this.entry=this._createEntry(),this.imageModel.setParentResourceId(this.model.get("id")),this.listenTo(this.model,"onChange:"+this.fieldName,this._updateImagePreview.bind(this))},render:function(){return this.container.setContent(this.entry),this},destroy:function(){this.stopListening(),this.model=null,this.imageModel=null,this.invisibleInput.destroy(),this._parent(),this.container=null},showLoading:function(){return this.setActionName(r.get("loading")),this.icon.addClassName("spinning"),this},hideLoading:function(){return this.setActionName(this.actionName),this.icon.removeClassName("spinning"),this},setActionName:function(t){return e.is(t,"string")&&this.actionLabel.setText(t),this},save:function(t){if(t=t||this.file,e.is(t)){this.showLoading();var s=i.deferred();return this._uploadImage(t).then((e=>{this.model.set(this.fieldName,e.get(this.fieldName)),this.reset(),this.hideLoading(),this.dispatchEvent(l.UPDATE),s.resolve(this.model)})).catch((e=>{this.saveOnChange&&this.reset(),this.hideLoading(),this.dispatchEvent(l.ERROR,{message:r.get("fileUploadFailed")}),s.reject(e)})),s.promise}},reset:function(){return this._updateImagePreview(),this._resetHiddenFileInput(),this.file=null,this},_displayNewImage:function(e){const t=new window.FileReader;t.onload=()=>{this.file=e,this.hideLoading(),this._updateImagePreview(t.result),this.dispatchEvent(l.UPDATE)},t.onerror=e=>{this.hideLoading(),console.error(e),this.dispatchEvent(l.ERROR,{message:r.get("fileCouldNotBeLoaded")})},this.showLoading(),t.readAsDataURL(e)},_onChange:function(t){if(e.is(t.target)&&e.is(t.target.files)&&t.target.files.length>0){const e=t.target.files[0];this._validateNewFile(e)?this.saveOnChange?this.save(e).catch((e=>console.log(e))):this._displayNewImage(e):this._resetHiddenFileInput()}},_onClick:function(){this.invisibleInput.focus(),this.invisibleInput.click()},_uploadImage:function(e){const t=i.deferred(),s=new FormData;s.append("file",e);const n={method:"POST"};return n.data=s,n.onComplete=t.resolve,n.onFailure=function(e,i,s){t.reject({model:e,response:i,options:s})},this.imageModel.clear(),this.imageModel.save(null,n),t.promise},_validateNewFile:function(t){if(this.acceptedFileTypes.indexOf(t.type)<0)return this.dispatchEvent(l.ERROR,{message:r.get("wrongFileType")}),!1;if(e.is(this.maxFileSize,"number")&&t.size>this.maxFileSize)return this.dispatchEvent(l.ERROR,{message:s.format(r.get("fileTooBig"),this._getReadableFileSize(this.maxFileSize))}),!1;const i={[this.fieldName]:t};let n=this.model.validate(i);return e.is(n)&&n.length>0&&(n=n.filter((e=>e.field===this.fieldName||e.fieldName===this.fieldName))),!e.is(n)||0===n.length},_resetHiddenFileInput:function(){this.invisibleInput.value=""},_createEntry:function(){const t=this._createControl();this.label=this._createLabel(),this.invisibleInput=this._createInput();return e.createElement("div",{html:[{tag:"label",html:this.label},t,this.invisibleInput]})},_createLabel:function(){return e.createElement("span",{class:"mpf-label",text:this.fieldLabel})},_createControl:function(){const t=this.acceptedFileTypes[0];for(var i=1;i<this.acceptedFileTypes.length;i++)t.concat(t,",",this.acceptedFileTypes[i]);return this.icon=this._createIcon(),this.image=this._createImage(),this.actionLabel=this._createActionName(),e.createElement("label",{class:"mpf-control",type:"file",accepts:t,for:this.fieldName,html:[this.image,this.icon,this.actionLabel]})},_createImage:function(){let t;const i=this.model.get(this.fieldName);return t=i?e.createElement("div",{class:"round"===this.imageShape?"mpf-image round":"mpf-image",styles:{"background-image":"url("+i+")"}}):this.unsetFallback?this.unsetFallback:e.createElement("div",{class:"round"===this.imageShape?"mpf-image mpf-empty round":"mpf-image mpf-empty"}),t},_updateImagePreview:function(t){const i=e.is(t,"string")?t:this.model.get(this.fieldName);e.is(i)&&i.length>0?(this.image.removeClassName("mpf-empty"),this.image.setStyle("background-image","url("+i+")")):(this.image.addClassName("mpf-empty"),this.image.setStyle("background-image","none"))},_createIcon:function(){return e.createElement("span",{class:"fonticon fonticon-2x fonticon-"+this.iconName})},_createActionName:function(){return e.createElement("span",{class:"mpf-action-name",text:this.actionName})},_createInput:function(){let t=this.acceptedFileTypes[0];for(let e=1;e<this.acceptedFileTypes.length;e++)t=t+","+this.acceptedFileTypes[e];return e.createElement("input",{class:"invisible-input",name:this.fieldName,type:"file",accepts:t})},_getReadableFileSize:function(e){const t=Math.floor(Math.log(e)/Math.log(1024)),i=[r.get("bytes"),r.get("kiloByte"),r.get("megaByte"),r.get("gigaByte"),r.get("teraByte"),"Pb","Eb","Zb","Yb"];return 1*(e/Math.pow(1024,t)).toFixed(2)+i[t]}});return o.Events=Object.freeze(l),o})),define("DS/MPFView/ConfirmationModal",["UWA/Class/View","DS/UIKIT/Input/Button","DS/UIKIT/Modal","DS/UIKIT/Mask","DS/UIKIT/Alert","i18n!DS/MPFView/assets/nls/ConfirmationModal"],(function(e,t,i,s,n,a){"use strict";const r=Object.freeze({CONFIRM:"onConfirm",CANCEL:"onCancel"}),l=e.extend({className:"mpf-confirmation-modal",setup:function(e={}){this.confirmButtonLabel=e.confirmButtonLabel||a.get("ok"),this.cancelButtonLabel=e.cancelButtonLabel||a.get("cancel"),this.autoHideAlerts=!1!==e.autoHideAlerts,this.alertHideDelay=e.alertHideDelay||3e3,this.confirmButton=this._createConfirmButton(),this.cancelButton=this._createCancelButton(),this.alert=this._createAlert(),this.modal=this._createModal(e.header||"",e.body,this.confirmButton,this.cancelButton)},render:function(){return this.container.setContent(this.modal),this},show:function(){this.modal.show()},hide:function(){this.modal.hide()},setLoading:function(e=!0,t){this.confirmButton.load(e),this.cancelButton.load(e),e?s.mask(this.modal.getBody(),t):s.unmask(this.modal.getBody())},setBody(e){return this.modal.setBody([this.alert,e])},showAlert({message:e,className:t}){this.alert.add({message:e,className:t}).show()},destroy:function(){this.modal.destroy(),this._parent(),this.container=null},_createConfirmButton:function(){var e=new t({className:"primary",value:this.confirmButtonLabel});return e.addEvent("onClick",this.dispatchEvent.bind(this,r.CONFIRM)),e},_createCancelButton:function(){const e=new t({value:this.cancelButtonLabel});return e.addEvent("onClick",(()=>{this.hide(),this.dispatchEvent(r.CANCEL)})),e},_createAlert(){return new n({closable:!0,visible:!1,autoHide:this.autoHideAlerts,hideDelay:this.alertHideDelay})},_createModal:function(e,t,s,n){return new i({header:e,body:[this.alert,t],footer:[s,n],events:{onHide:()=>{this.alert.hide(),this.alert.getMessages().forEach((e=>this.alert.remove(e)))}}})}});return l.Events=r,l})),define("DS/MPFView/CollapsibleModal",["UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Tooltip","DS/MPFServices/ObjectService","i18n!DS/MPFView/assets/nls/CollapsibleModal","css!DS/MPFView/MPFView"],(function(e,t,i,s,n){"use strict";const a=Object.freeze({}),r=t.extend({init(e){e.className="mpf-collapsible-modal",this._parent(e)},setHeader:function(t){const s=this.getHeader(),a=this.options,r=this.elements;s.empty(),r.collapseIcon=e.createElement("span",{class:"mpf-collapse-icon fonticon fonticon-chevron-down",events:{click:this._toggleVisibility.bind(this)}}),s.addContent(r.collapseIcon);const l=e.createElement("div",{class:"mpf-title-wrapper"});return t&&l.setContent(t),s.addContent(l),a.closable&&(r.close=e.createElement("span",{class:"close fonticon fonticon-cancel",events:{click:()=>{this.hide()}}}),s.addContent(r.close),r.closeTooltip=new i({position:"bottom",target:r.close,body:n.get("close")})),this},show(){this.expand(),this._parent()},collapse(){this.elements.collapseIcon.removeClassName("fonticon-chevron-down"),this.elements.collapseIcon.addClassName("fonticon-chevron-up"),this.elements.wrapper.addClassName("mpf-collapsed"),this.collapsed=!0},expand(){this.elements.collapseIcon.removeClassName("fonticon-chevron-up"),this.elements.collapseIcon.addClassName("fonticon-chevron-down"),this.elements.wrapper.removeClassName("mpf-collapsed"),this.collapsed=!1},_toggleVisibility(){this.collapsed?this.expand():this.collapse()}});return r.Events=a,r})),define("DS/MPFView/MPFView",["UWA/Core","UWA/Promise","UWA/Class/View"],(function(e,t,i){"use strict";return i.extend({setup:function(e){this.messages=null,this.readOnly=!0===e.readOnly,this.required=!0===e.required,this.lockSave=!0===e.lockSave,this._resetMessages()},save:function(){var e,i,s=t.deferred();return this.lockSave?s.resolve():(this._resetMessages(),e=this.container.getElements("input").reduce((function(e,t){return e[t.name]=t.value.trim(),e}),{}),this.model.set(e)?(this.inputs.forEach((function(e){e.setDisabled()})),(i=this.model.validate(this.model.toJSON()))&&i.length>0?(Array.apply.push(this.messages.error,i),s.reject("Validation failed")):this.model.save(null,{onComplete:function(){s.resolve()},onFailure:function(){s.reject("Unable to save model")}})):s.reject("Unable to update model")),s.promise},setReadOnly:function(e){this.readOnly=!0===e,this.inputs.forEach((function(e){e.setDisabled(!1)}))},addErrorMessage:function(e,t){e&&this.container.getElement('[name="'+e+'"]').addClassName("mpf-error"),this.messages.error.push(t)},_resetMessages:function(){this.messages={info:[],warning:[],error:[]}}})})),define("DS/MPFView/FieldTextInput",["UWA/Core","UWA/Promise","UWA/String","UWA/Class/View","DS/UIKIT/Input/Text","DS/UIKIT/Tooltip","i18n!DS/MPFView/assets/nls/FieldTextInput"],(function(e,t,i,s,n,a,r){"use strict";return s.extend({className:"mpf-entry",setup:function(t){this._parent(t),this.fieldName=t.fieldName,this.fieldLabel=t.fieldLabel,this.fieldPrefix=t.fieldPrefix,this.required=!0===t.required,this.readOnly=!0===t.readOnly,this.dynamicValidation=!0===t.dynamicValidation,this.saveOnChange=!0===t.saveOnChange,this.tooltip=t.tooltip,this.maxlength=t.maxlength,this.silent=!e.is(t.silent)||t.silent,this.input=this._createInput(),this.entry=this._createEntry(this.fieldLabel),this.force=!0===t.force,this.horizontalLayout=!0===t.horizontalLayout},domEvents:{change:"onChange"},onChange:function(e){e||(e={}),this._synchronizeModel(e),this.saveOnChange&&this.model.savePromise(this.model.pick(this.fieldName),{patch:!0}),this.dispatchEvent("update",this.model)},_synchronizeModel:function(e){var t,i={};t=!0===e.force||!0===this.force,(!this.dynamicValidation||void 0===this.validate()||t)&&(i[this.fieldName]=this.input.getValue(),this.model.set(i,{silent:this.silent}))},getValue:function(){return this.fieldPrefix?this.fieldPrefix+this.input.getValue():this.input.getValue()},setValue:function(e){this.input.setValue(e),this.onChange()},resetValue:function(){this.input.setValue(""),this.onChange({force:!0})},getInput:function(){return this.input},render:function(){return this._removeErrorMsg(),this.container.setContent(this.entry),this.horizontalLayout&&!this.container.hasClassName("mpf-oneline")&&this.container.addClassName("mpf-oneline"),this},validate:function(){var t,i,s=!1,n=this.entry.getElement("input"),a=n.name,r=this.entry,l={};if(l[a]=this.getValue(),i=this.model.validate(l),this._removeErrorMsg(),e.is(i)&&i.length>0&&i.forEach((function(t){e.is(t.field)&&t.field===a&&(s=!0)})),s||!this.required||this.input.getValue()&&this.input.getValue().trim().length>0||(i||(i=[]),i.push({field:a,errorType:"ErrorRequired"})),i&&(t=i.filter((function(e){return e.field===a}))).length>0){var o=t[0];return n.addClassName("mpf-invalidField mpf-inputError"),e.createElement("p",{class:"mpf-error",text:e.is(o.message)?o.message:this._getMsgError(o)}).inject(r),t}},focus:function(){this.input.focus()},_removeErrorMsg:function(){var e,t=this.entry.getElement("input"),i=this.entry;t.removeClassName("mpf-invalidField mpf-inputError"),e=i.getElements("p.mpf-error");for(var s=0;s<e.length;s++)i.removeChild(e[s])},_getMsgError:function(t){var s,n=!1;if(e.is(this.fieldLabel)&&e.is(this.fieldLabel[0]))return s=i.capitalize(this.fieldLabel[0]),["A","E","I","O","U","Y"].forEach((function(e){s===e&&(n=!0)})),n?i.format(r.get(t.errorType+"Vowel"),i.unCamelCase(this.fieldLabel," ")):i.format(r.get(t.errorType),i.unCamelCase(this.fieldLabel," "))},save:function(){var e,i={};return e=t.deferred(),i[this.fieldName]=this.getValue(),this.model.set(i)?(this.validate(),e.resolve(this.model)):e.reject("Unable to save model"),e.promise},setDisabled:function(e){this.input.setDisabled(!1!==e)},destroy:function(){this.input=null,this.stopListening(this.model),this.model=null,this._parent()},_createInput:function(){var e;return e=this.model.get(this.fieldName)||"",this.fieldPrefix&&(e=e.replace(this.fieldPrefix,"")),new n({name:this.fieldName,value:e,disabled:this.readOnly,required:this.required,maxlength:this.maxlength})},_createEntry:function(t){var i,s;return(i=[]).push(t),this.required&&""!==t&&i.push('&nbsp;<em class="mpf-required">*</em>'),this.tooltip&&i.push(this._createTooltip()),s=[{tag:"span",class:"mpf-label",html:i}],this.fieldPrefix&&s.push({tag:"span",class:"mpf-prefix",text:this.fieldPrefix}),s.push(this.input),e.createElement("label",{html:s})},_createTooltip:function(){var t;return t=e.createElement("span",{class:"fonticon fonticon-info mpf-entry-tooltip"}),new a({target:t,body:this.tooltip}),t}})})),define("DS/MPFView/AsyncValidationTextInput",["UWA/Core","UWA/Class/View","UWA/String","DS/UIKIT/Input/Text","DS/MPFServices/ObjectService","DS/MPFModel/ModelValidator","i18n!DS/MPFView/assets/nls/FieldTextInput","css!DS/MPFView/MPFView"],(function(e,t,i,s,n,a,r){"use strict";const l=Object.freeze({VALIDATION_STATE_CHANGE:"onValidationStateChange"}),o=Object.freeze({DEFAULT:"default",INVALID:"invalid",LOADING:"loading",SUCCESS_INFO:"success-info",VALID:"valid"}),h=[o.SUCCESS_INFO,o.VALID],d=[o.DEFAULT,o.LOADING,o.INVALID],c=new Map;c.set(o.DEFAULT,"mpf-default"),c.set(o.INVALID,"mpf-invalid"),c.set(o.LOADING,"mpf-loading"),c.set(o.SUCCESS_INFO,"mpf-success"),c.set(o.VALID,"mpf-default");const u=t.extend({className:()=>"mpf-async-validation-text-input",setup({model:e,fieldName:t,fieldLabel:i,asyncValidation:s,required:n=!1,disabled:a=!1,iconClass:r="spell-check",useModelValidation:l=!0}={}){this.model=e,this.fieldName=t,this.fieldLabel=i,this.asyncValidation=s,this.required=n,this.disabled=a,this.useModelValidation=l,this.iconClass=r,this.input=this._createInput(),this.state=this._getInitialState(),this.container.addClassName(c.get(this.state))},render({errorMessage:t}={}){const i=e.createElement("div",{class:"mpf-input-container",html:[this.input]});this.state!==o.LOADING&&this.state!==o.SUCCESS_INFO||i.addContent({tag:"span",class:`mpf-icon fonticon fonticon-${this.iconClass}`});const s=[e.createElement("label",{html:[{tag:"span",class:"mpf-label",html:[this.fieldLabel,this.required&&{tag:"em",class:"mpf-required",text:" *"}]},i]})];return t&&s.push({tag:"div",class:"mpf-error",text:t}),this.container.setContent(s),this},disable(){this.input.disable()},enable(){this.input.enable()},getValue(){return this.input.getValue()},setValue(e){this.input.setValue(e)},setLabel(e){e!==this.fieldLabel&&(this.fieldLabel=e,this.render())},setRequired(e){e!==this.required&&(this.required=e,this.state=this._getInitialState(),this.render())},reset(){this._clearClassNames(),this.input.setValue(""),this.model.unset(this.fieldName),this.state=this._getInitialState(),this.render()},isValid(){return h.includes(this.state)},validate({value:e}){let t;this.useModelValidation&&(t=this.model.validate(this.fieldName),t||this.required&&!e&&(t=[{errorType:a.ErrorTypes.REQUIRED}])),t&&t.length>0?t[0].errorType===a.ErrorTypes.INVALID?this.changeState(o.INVALID,{errorMessage:i.format(r.get("invalidField"),this.fieldLabel)}):this.changeState(o.INVALID,{errorMessage:i.format(r.get("requiredField"),this.fieldLabel)}):"function"==typeof this.asyncValidation?(this.changeState(o.LOADING),this.asyncValidation({value:e}).then((({isValid:t,errorMessage:s})=>{t?""===e?this.changeState(this.required?o.DEFAULT:o.VALID):this._showSuccessStyle():this.changeState(o.INVALID,{errorMessage:s||i.format(r.get("invalidField"),this.fieldLabel)})})).catch((e=>{console.error(e),this.changeState(o.INVALID,{errorMessage:r.get("unableToValidate",{label:this.fieldLabel})})}))):this.changeState(o.VALID)},abortAsyncStateChange(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)},changeState(e,{errorMessage:t}={}){if(e!==this.state){this._clearClassNames();let i=!1;(d.includes(this.state)&&h.includes(e)||h.includes(this.state)&&d.includes(e))&&(i=!0),this.state=e,this.container.addClassName(c.get(this.state)),this.render({errorMessage:t}),i&&this.dispatchEvent(l.VALIDATION_STATE_CHANGE,{state:this.state})}else this.state===o.INVALID&&e===o.INVALID&&t&&this.render({errorMessage:t})},destroy(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.model=null,this._parent(),this.container=null},_clearClassNames(){c.forEach((e=>{this.container.removeClassName(e)}))},_getInitialState(){const e=this.model.get(this.fieldName);let t;if(e){const i=this.model.validate(this.fieldName),s=!i||0===i.length;this.asyncValidation?(t=o.LOADING,this.asyncValidation({value:e}).then((e=>{t=e&&s?o.VALID:o.INVALID}))):t=s?o.VALID:o.INVALID}else t=this.required?o.DEFAULT:o.VALID;return t},_onChange(){const e=this.input.getValue();this.model.set(this.fieldName,e),this.validate({value:e})},_showSuccessStyle(){this.changeState(o.SUCCESS_INFO),this.timeoutId=setTimeout((()=>{this.changeState(o.VALID)}),3e3)},_createInput(){return new s({name:this.fieldName,value:this.model.get(this.fieldName)||"",className:o.DEFAULT,disabled:this.disabled,events:{onChange:this._onChange.bind(this)}})}});return u.Events=l,u.States=o,u})),define("DS/MPFView/FieldButtonInput",["UWA/Core","UWA/Promise","UWA/String","UWA/Class/View","DS/UIKIT/Input/Button"],(function(e,t,i,s,n){"use strict";return s.extend({className:"mpf-button",setup:function(e){this._parent(e),this.buttonName=e.buttonName,this.buttonLabel=e.buttonLabel,this.events=e.events||{},this.className=e.className||"default",this.icon=e.icon||"",this.input=this._createInput(this.buttonName,this.buttonLabel,this.className,this.icon,this.events),this.entry=this._createEntry()},render:function(){return this.container.setContent(this.entry),this},_createInput:function(e,t,i,s,a){return new n({name:e,value:t,className:i,icon:s,events:a})},_createEntry:function(){return e.createElement("label",{html:[this.input]})}})})),define("DS/MPFView/FieldToggleInput",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/UIKIT/Input/Toggle"],(function(e,t,i,s){"use strict";const n=Object.freeze({SAVING:"saving",SAVED:"saved",ERROR:"error",UPDATE:"update"}),a=t.extend({className:"mpf-entry",setup(e){e||(e={}),this.fieldName=e.fieldName,this.fieldLabel=e.fieldLabel,this.required=!0===e.required,this.readOnly=!0===e.readOnly,this.saveOnChange=!0===e.saveOnChange,this.useStringValue=!0===e.useStringValue,this.onValue=e.onValue||!this.useStringValue||"TRUE",this.offValue=e.offValue||!!this.useStringValue&&"FALSE",this.type=e.type||"checkbox",this.input=this._createToggle()},render(e){const t=this.model.get(this.fieldName),i=t===this.onValue||!0===t||"true"===t||"TRUE"===t;return this.input.setCheck(i),this.container.setContent(this.input),this},isChecked(){return this.input.isChecked()},setReadOnly(e){this.readOnly=!0===e,this.input.setDisabled(this.readOnly)},onChange(){this.saveOnChange?this.save():this.model.set(this.fieldName,this.getValue()),this.dispatchEvent(n.UPDATE)},save(){const e=this;return i.mask(this.input.elements.container),this.dispatchEvent(n.SAVING),this.model.savePromise(this.fieldName,this.getValue(),{patch:!0}).then((function(){i.unmask(e.input.elements.container),e.render(),e.dispatchEvent(n.SAVED)})).catch((function(t){i.unmask(e.input.elements.container),e.render(),e.dispatchEvent(n.ERROR,t)}))},getValue:function(){return this.input.isChecked()?this.onValue:this.offValue},destroy:function(){this.model=null,this.input=null,this._parent(),this.container=null},_createToggle:function(){return new s({className:"mpf-toggle primary",type:this.type,name:this.fieldName,label:this.fieldLabel,required:this.required,disabled:this.readOnly,events:{onChange:this.onChange.bind(this)}})}});return a.Events=Object.freeze(n),a})),define("DS/MPFView/ResponsiveTable",["UWA/Class/View","DS/MPFServices/ObjectService","css!DS/MPFView/MPFView"],(function(e,t){"use strict";const i=Object.freeze({}),s=e.extend({className:"mpf-responsive-table",setup({headerCells:e,rows:i}={}){t.requiredOfType(e,"array","options.headerCells must be an array"),t.requiredOfType(i,"array","options.rows must be an array"),this.headerCells=e,this.rows=i},render(){return this.container.setContent([this._renderMobileVersion(),this._renderDesktopVersion()]),this},destroy(){this.headerCells=null,this.rows=null,this._parent(),this.container=null},_renderMobileVersion(){return{tag:"div",class:"mpf-mobile-table",html:this.rows.map((e=>({tag:"div",class:"mpf-mobile-block",html:e.map(((e,t)=>({tag:"div",class:"mpf-mobile-cell",html:[{tag:"div",class:"mpf-mobile-cell-title",html:this.headerCells[t]},{tag:"div",class:"mpf-mobile-cell-value",html:e.mobile?e.mobile:e}]})))})))}},_renderDesktopVersion(){return{tag:"table",class:"mpf-dektop-table",html:[{tag:"thead",html:[{tag:"tr",html:this.headerCells.map((e=>({tag:"th",html:e})))}]},{tag:"tbody",html:[this.rows.map((e=>({tag:"tr",html:e.map((e=>({tag:"td",html:e.desktop?e.desktop:e})))})))]}]}}});return s.Events=i,s})),define("DS/MPFView/TemporaryBanner",["UWA/Class/View","DS/MPFServices/ObjectService"],(function(e,t){"use strict";const i=Object.freeze({}),s=e.extend({className:"mpf-temporary-banner",setup({message:e,from:i,until:s}={}){t.requiredOfType(e,"string","options.message must be a string"),this.message=e,this.from=i,this.until=s},render(){const e=this._getCurrentDate();return e>=this.from&&e<=this.until?this.container.setContent([{tag:"div",class:"alert-message alert-warning alert-has-icon",html:[{tag:"span",class:"icon fonticon"},this.message]}]):this.container.empty(),this},destroy(){this._parent(),this.container=null},_getCurrentDate:()=>new Date});return s.Events=i,s})),define("DS/MPFView/FieldPriceInput",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFModel/MPFModel","DS/UIKIT/Input/Text","i18n!DS/MPFView/assets/nls/FieldPriceInput","css!DS/MPFView/MPFView"],(function(e,t,i,s,n,a){"use strict";const r=Object.freeze({EUR:"€",USD:"$",GBP:"£"});return t.extend({className:"mpf-entry-v2 mpf-price-input",setup:function(e={}){i.requiredOfPrototype(this.model,s,"options.model must be an MPFModel"),this.fieldName=e.fieldName,this.fieldLabel=e.fieldLabel,this.currency=e.currency,this.min=e.min,this.max=e.max,this.numberDecimals=e.numberDecimals||2,this.readOnly=!0===e.readOnly,this.required=!0===e.required,this.errorMessage=e.errorMessage},render:function(){return this.container.setContent([{tag:"div",class:"mpf-input-and-error",html:[{tag:"label",html:[this._renderLabel(),this._createInput()]},{tag:"p",class:this.errorMessage?"mpf-error":"hidden",html:this.errorMessage}]},{tag:"div",class:"mpf-curency",text:r[this.currency]||this.currency||"?"}]),this.errorMessage?this.container.addClassName("mpf-invalid"):this.container.removeClassName("mpf-invalid"),this},showError:function(e){this.errorMessage=e,this.render()},focus:function(){const e=this.container.getElement("input");e&&e.focus()},destroy:function(){this.model=null,this._parent(),this.container=null},_renderLabel:function(){const t=e.createElement("span",{class:"mpf-label",text:this.fieldLabel});return this.required&&t.addContent(["&nbsp;",{tag:"em",class:"mpf-required",text:"*"}]),t},_onChange:function(e){const t=e.target.value;if(""===t)this.errorMessage="",this.model.set(this.fieldName,t);else{var i=this._correctValue(t);i?(this.errorMessage="",i.toString()!==this.model.get(this.fieldName)&&this.model.set(this.fieldName,i),i.toString()!==t&&this.render()):(this.errorMessage=a.get("numbersOnly"),this.render())}},_correctValue:function(e){let t;e&&(e=e.replace(/[^0-9,.]/g,""));let i=parseFloat(e);return isNaN(i)||(this.min&&i<this.min&&(i=this.min),this.max&&i>this.max&&(i=this.max),i=Math.round(i*Math.pow(10,this.numberDecimals))/Math.pow(10,this.numberDecimals),t=i.toFixed(this.numberDecimals)),t},_createInput:function(){return new n({name:this.fieldName,value:this._correctValue(this.model.get(this.fieldName))||"",disabled:this.readOnly,required:this.required,events:{onChange:this._onChange.bind(this)}})}})})),define("DS/MPFView/GuidanceHelper",["UWA/Core","UWA/Class/View","DS/UIKIT/Popover","DS/UIKIT/Tooltip"],(function(e,t,i,s){"use strict";return t.extend({tagName:"span",className:"mpf-guidance-helper",setup(e){this._parent(e),this.popover=null,this.title=e.title||"",this.content=e.content||"",this.position=e.position||"bottom",this.styles=e.styles||{},this.target=e.target,this.severity=e.severity||2,this.useTooltip=!0===e.useTooltip,this._buildSkeleton()},_buildSkeleton:function(){let t=null;t=this.target?this.target:e.createElement("span",{class:"fonticon fonticon-"+(1===this.severity?"help":"info"),styles:e.merge(this.styles,{fontSize:"14px",color:"#b4b6ba"})});const n={target:t,trigger:"hover touch",position:this.position,body:this.content};this.title&&(n.title=this.title),this.popover=this.useTooltip?new s(n):new i(n),this.container.setContent(t)},setContent:function(e){this.popover&&this.popover.setBody(e)},render:function(){}})})),define("DS/MPFView/InitialsDotV2",["UWA/Class/View","css!DS/MPFView/MPFView"],(function(e){"use strict";const t=Object.freeze({}),i=["#078BFA","#F95753","#6FBC4B","#9E846A","#AA4BB2","#1A997B","#F564A3","#FF8A2E"],s="#77797c",n=e.extend({className:"mpf-initials-dot-v2",setup({title:e,image:t,icon:i,backgroundColor:s}={}){this.title=e,this.image=t,this.icon=i,this.backgroundColor=s},render(){let e;return e=this.image?this._renderImage():this.icon?this._renderIcon():this.title?this._renderInitials():this._renderDefault(),this.container.setContent(e),this},destroy(){this._parent(),this.container=null},_renderImage(){this.container.addClassName("mpf-initial-dot-image"),this.container.setStyle("background-image",`url(${this.image})`)},_renderIcon(){return this.container.setStyle("background-color",this.backgroundColor||s),{tag:"span",class:"fonticon fonticon-"+this.icon}},_renderInitials(){const e=this.title.trim().split(" ");let t=e[0].charAt(0).toUpperCase(),s=0;e[1]?(t+=e[1].charAt(0).toUpperCase(),s=(t.charCodeAt(0)+t.charCodeAt(1))%i.length):s=t.charCodeAt(0)%i.length,s<0&&(s*=-1);const n=this.backgroundColor||i[s];return this.container.setStyle("background-color",n),t},_renderDefault(){return this.container.setStyle("background-color",this.backgroundColor||s),"--"}});return n.Events=t,n})),define("DS/MPFView/ManuallyClosedModal",["DS/UIKIT/Modal"],(function(e){"use strict";const t=Object.freeze({ON_CLOSE:"onCloseClicked"}),i=e.extend({setHeader(e){return this._parent(e),this.elements.close&&(this.elements.close.removeEvent("click"),this.elements.close.addEvent("click",(()=>{this.dispatchEvent(t.ON_CLOSE)}))),this},handleEvents(){this.options.escapeToClose&&(this._mpfOnKeyUp||(this._mpfOnKeyUp=this._onKeyUp.bind(this)),document.addEventListener("keyup",this._mpfOnKeyUp,!0))},destroy(){document.removeEventListener("keyup",this._mpfOnKeyUp,!0),this._parent()},_onKeyUp(e){const i=e.code;!this.isVisible||"Escape"!==i&&"Esc"!==i||(this.dispatchEvent(t.ON_CLOSE),this.hide())}});return i.Events=t,i})),define("DS/MPFView/FieldSelectInput",["UWA/Core","UWA/String","UWA/Promise","UWA/Class/View","DS/UIKIT/Input/Select","i18n!DS/MPFView/assets/nls/FieldTextInput"],(function(e,t,i,s,n,a){"use strict";return s.extend({className:"mpf-select",domEvents:{change:"onChange"},setup:function(e={}){this._parent(e),this.fieldName=e.fieldName,this.fieldLabel=e.fieldLabel,this.required=!0===e.required,this.readOnly=!0===e.readOnly,this.selectableOptions=e.selectableOptions||[],this.placeholder=e.placeholder,this.select=this._createSelect(),this.entry=this._createEntry(this.fieldLabel)},getValue:function(){return this.select.getValue()},setReadOnly:function(e){this.readOnly=!0===e,this.readOnly?this.select.disable():this.select.enable()},isDisabled:function(){return this.select.isDisabled()},render:function(){return this.model.get(this.fieldName)&&this.select.select(this.model.get(this.fieldName)),this.container.setContent([this.entry,this.select]),this},onChange:function(){const e=this.getValue();e&&(this.model.set(this.fieldName,e[0]),this.validate())},validate:function(){const i=this.container.getElement(".select"),s=i.getParent();let n=this.model.validate(this.model.omit());i.removeClassName("mpf-invalidField");const r=s.getElement("p");if(null!==r&&s.removeChild(r),this.required){0===this.getValue().shift().length&&(n||(n=[]),n.push({field:this.fieldName,message:t.format(a.get("ErrorRequired"),this.fieldLabel.toLowerCase())}))}n&&n.filter((t=>{t.field===this.fieldName&&(i.addClassName("mpf-invalidField"),e.createElement("p",{class:"mpf-inputError",text:t.message}).inject(s))}))},save:function(){const e=i.deferred(),t={[this.fieldName]:this.getValue()};return this.model.set(t)?this.validate():e.reject("Unable to save model"),e.promise},add:function(e){return this.select.add(e)},remove:function(e){return this.select.remove(e)},_createSelect:function(){return new n({name:this.fieldName,placeholder:this.placeholder,disabled:this.readOnly,required:this.required,options:this.selectableOptions})},_createEntry:function(t){this.required&&(t+='&nbsp;<em class="mpf-required">*</em>');return e.createElement("label",{html:{tag:"span",class:"mpf-label",html:t}})}})})),define("DS/MPFView/InitialsDot",["UWA/Controls/Abstract","UWA/Core","css!DS/MPFUI/MPFUI"],(function(e,t){"use strict";return e.extend({init(e={}){this._parent(e),this._title="",this._image=null,"string"==typeof e.title&&(this._title=e.title),"string"==typeof e.image&&(this._image=e.image),this._buildSkeleton()},_buildSkeleton(){this.elements.container=t.createElement("div",{class:"mpf-initial-dot"+(this._image?" mpf-initial-dot-image":"")}),this._image?this._renderImage():this._renderInitials()},_renderImage(){this.elements.container.style.backgroundImage="url("+this._image+")"},_renderInitials(){if(this._title){const e=["#078BFA","#F95753","#6FBC4B","#9E846A","#AA4BB2","#1A997B","#F564A3","#FF8A2E"];if(this._title&&""!==this._title){const t=this._title.trim().split(" ");let i=t[0].charAt(0).toUpperCase(),s=0;t[1]?(i+=t[1].charAt(0).toUpperCase(),s=(i.charCodeAt(0)+i.charCodeAt(1))%e.length):s=i.charCodeAt(0)%e.length,s<0&&(s*=-1),this.elements.container.style.backgroundColor=e[s],this.elements.container.setText(i)}else this.elements.container.style.backgroundColor="grey",this.elements.container.setText("--")}}})})),define("DS/MPFView/SortByDragItem",["UWA/Class/View","DS/MPFServices/ObjectService","DS/UIKIT/Input/Text"],(function(e,t,i){"use strict";const s=Object.freeze({READ:"read",WRITE:"write"}),n=Object.freeze({LABEL_CHANGE:"labelChange",HOVERED:"hovered",DRAG_START:"dragStart",DRAG_END:"dragEnd",DELETE:"deleteItem"}),a=e.extend({className:"mpf-sort-by-drag-item",attributes:{draggable:!0},domEvents:{dragstart:"_onDragStart",dragend:"_onDragEnd",dragenter:"_onDragEnter",dragover:"_onDragOver"},setup(e={}){t.requiredOfType(e.label,"string","options.label must be a string"),t.requiredOfType(e.index,"number","options.index must be a number"),this.id=e.id,this.currentLabel=e.label,this.originalLabel=e.label,this.currentIndex=e.index,this.originalIndex=e.index,this.isRemovable=!0===e.isRemovable,this.isPushedDown=!0===e.isPushedDown,this.state=e.state||s.READ,this.isDragged=!1,this.input=this._createInput()},render(){let e;return e=this.isDragged?this._renderPlaceholder():this.state===s.WRITE?this._renderWriteMode():this._renderReadMode(),this.container.setContent(e),this},destroy(){this._parent(),this.container=null},setIndex(e){this.currentIndex=e},getIndex(){return this.currentIndex},getOriginalIndex(){return this.originalIndex},getId(){return this.id},isDragged(){return this.isDragged},getModifications(){const e={};return this.currentLabel!==this.originalLabel&&(e.label=this.currentLabel),this.currentIndex!==this.originalIndex&&(e.index=this.currentIndex),Object.keys(e).length>0&&(e.id=this.id),e},_onSaveLabel(){this.currentLabel=this.input.getValue(),this.state=s.READ,this.render(),this.dispatchEvent(n.LABEL_CHANGE,{label:this.currentLabel,index:this.currentIndex})},_onCancel(){this.input.setValue(this.currentLabel),this.state=s.READ,this.render()},_edit(){this.state=s.WRITE,this.render()},_onDragStart(e){this.isDragged=!0,this.container.addClassName("mpf-dragged"),this.dispatchEvent(n.DRAG_START,this)},_onDragEnd(){this.isDragged=!1,this.container.removeClassName("mpf-dragged"),this.render(),this.dispatchEvent(n.DRAG_END,this)},_onDragEnter(e){e.preventDefault(),e.stopPropagation(),this.isDragged||e.currentTarget!==this.container||this.dispatchEvent(n.HOVERED,this)},_onDragOver(e){e.preventDefault(),e.stopPropagation()},_renderPlaceholder:()=>[{tag:"div",class:"mpf-placeholder",html:[{tag:"span",class:"fonticon fonticon-left mpf-placeholder-icon"}]}],_renderReadMode(){const e=[];return this.isRemovable&&e.push({tag:"div",class:"fonticon fonticon-trash mpf-edit-icon",events:{click:this.dispatchEvent.bind(this,n.DELETE,this.id)}}),e.push({tag:"div",class:"fonticon fonticon-pencil mpf-edit-icon",events:{click:this._edit.bind(this)}}),[{tag:"div",class:"mpf-drag-tile",html:[{tag:"span",class:"fonticon fonticon-drag-grip"}]},{tag:"div",class:"mpf-label",text:this.currentLabel},{tag:"div",class:"mpf-icon-container",html:e}]},_renderWriteMode(){return[this.input,{tag:"div",class:"mpf-edit-icons-container",html:[{tag:"span",class:"fonticon fonticon-check mpf-apply-icon",events:{click:this._onSaveLabel.bind(this)}},{tag:"span",class:"fonticon fonticon-wrong mpf-cancel-icon",events:{click:this._onCancel.bind(this)}}]}]},_createInput(){return new i({value:this.currentLabel})}});return a.Events=n,a})),define("DS/MPFView/RatingStarsTile",["UWA/Core","UWA/Event","UWA/Class/View","DS/MPFError/BadArgumentError","css!DS/MPFView/MPFView"],(function(e,t,i,s){"use strict";const n="disabled";return i.extend({className:"mpf-rating-stars-tile",domEvents:{"click .mpf-star":"_onStarClicked"},setup(t={}){this.max=e.is(t.max)?Math.round(t.max):5,e.is(t.rating,"number")&&(this.rating=t.rating),this.starSize=t.starSize||26,this.editable=!0===t.editable,this.colors=this._initColors(t.colors)},render(){e.is(this.rating,"number")?this._unsetDefaultState():this._setDefaultState(),this._removeStarEvents(),this.stars=[];for(let e=0;e<this.max;e++){const t=this._calcYellowFraction(e);this.stars.push(this._createStar(t,e))}return this.container.setContent(this.stars),this},getRating(){return this.rating},setRating(t){if(!(e.is(t,"number")&&t>=0&&t<=this.max))throw new s("rating must be between 0 and the defined maximum of "+this.max+" (both inclusively)");return this.rating=t,this.render(),this},unsetRating(){return this.rating=null,this.render(),this},setEditable(e){return this.editable=!1!==e,this.render(),this},destroy(){this._removeStarEvents(),this._parent(),this.container=null},_initColors(e={}){const t={};return t.rating=e.rating||"#FEE000",t.max=e.max||"#b4b6ba",t.outline=this._darkenColor(t.rating,.15),t},_setDefaultState(){this._renderedRating=this.max/2,this.container.hasClassName(n)||this.container.addClassName(n)},_unsetDefaultState(){this._renderedRating=this.rating,this.container.hasClassName(n)&&this.container.removeClassName(n)},_calcYellowFraction(e){let t=this._renderedRating-e;return t=t<1?t<0?0:t:1,t},_createStar(t,i){const s=[],n=24*t;if(t>0&&s.push(this._createStarPart(this.colors.rating,0,n)),t<1){const e=24*(1-t);s.push(this._createStarPart(this.colors.max,n,e))}if(this.editable){const e=this._createStarPart(this.colors.outline,0,null,"stroke");s.push(e)}const a=e.createElement("div",{class:"mpf-star",html:s,styles:{width:this.starSize,height:this.starSize}});return this.editable&&(a.index=i,a.addEvent("mouseenter",this._onMouseEnter.bind(this,i)),a.addEvent("mouseleave",this._onMouseLeave.bind(this,i))),a},_createStarPart(e,t,i=24,s="fill"){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"viewBox",t+" 0 "+i+" 24");const a=document.createElementNS("http://www.w3.org/2000/svg","path");return a.setAttributeNS(null,"d","M12 .587l3.668 7.568 8.332 1.151-6.064 5.828 1.48 8.279-7.416-3.967-7.417 3.967 1.481-8.279-6.064-5.828 8.332-1.151z"),a.setAttributeNS(null,s,e),"stroke"===s&&(n.setAttribute("class","star-outline"),a.setAttributeNS(null,"fill","none")),n.appendChild(a),n},_onStarClicked:function(e){if(this.editable){t.stop(e);const i=t.getElement(e).index+1;i!==this.rating&&(this.setRating(i),this.dispatchEvent("newRating",this.rating))}},_onMouseEnter:function(e){for(let t=0;t<=e;t++)this.stars[t].addClassName("show-outline")},_onMouseLeave:function(e){for(let t=0;t<=e;t++)this.stars[t].removeClassName("show-outline")},_darkenColor:function(e,t){const i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);let s="#";for(let e=1;e<i.length;e++){let n=i[e];n=Math.round(parseInt(n,16)*(1-t));let a=n.toString(16);a=1===a.length?"0"+a:a,s+=a}return s},_removeStarEvents:function(){if(this.stars)for(let e=0;e<this.stars.length;e++)this.stars[e].removeEvents()}})})),define("DS/MPFView/EmptyView",["UWA/Class/View","DS/MPFUtils/MPFUtils"],(function(e,t){"use strict";let i;const s=e.extend({className:"mpf-hidden",setup:t.doNothing,render:function(){return this},destroy:t.doNothing,setDisabled:t.doNothing,hide:t.doNothing,show:t.doNothing,uncheck:t.doNothing});return s.getInstance=function(){return i||(i=new s),i},Object.freeze(s),s})),define("DS/MPFView/FieldNumberInput",["UWA/Core","UWA/Class/View","DS/UIKIT/Input/Number"],(function(e,t,i){"use strict";return t.extend({className:"mpf-entry",domEvents:{change:"onChange"},setup:function(e){this.fieldName=e.fieldName,this.fieldLabel=e.fieldLabel,this.required=!0===e.required,this.readOnly=!0===e.readOnly,this.min=e.min||0,this.max=e.max||10,this.step=e.step||1,this.tooltip=e.tooltip,this.wrapper=this._createWrapper()},onChange:function(){this.model.set(this.fieldName,this.input.getValue())},render:function(){return this.container.setContent(this.wrapper),this},_createWrapper:function(){var t,i;return t=e.createElement("span",{class:"mpf-label",text:this.fieldLabel}),this.required&&(i=e.createElement("em",{class:"mpf-required",text:"*"}),t.addContent(["&nbsp;",i])),this.input=this._createInput(),e.createElement("label",{html:[t,this.input]})},_createInput:function(){return new i({value:this.model.get(this.fieldName)||this.min,min:this.min,max:this.max,step:this.step,events:{onChange:this._forceValidRange.bind(this)}})},_forceValidRange:function(){var e;this.input&&(e=this.input.getValue(),this.min&&e<this.min?this.input.setValue(this.min):this.max&&e>this.max&&this.input.setValue(this.max))}})})),define("DS/MPFView/InformationTooltip",["UWA/Class/View","DS/UIKIT/Tooltip"],(function(e,t){"use strict";return e.extend({className:"mpf-info fonticon fonticon-info",setup(e){this.text=e.text},render(){return new t({position:"bottom",trigger:"touch",body:this.text,target:this.container}),this}})})),define("DS/MPFView/DropZone",["UWA/Core","UWA/String","UWA/Class/View","DS/UIKIT/Alert","DS/UIKIT/Input/Button","DS/MPFUtils/FormatUtils","i18n!DS/MPFView/assets/nls/DropZone","css!DS/MPFView/MPFView"],(function(e,t,i,s,n,a,r){"use strict";const l=Object.freeze({ON_CLICK:"onClick",ON_DROP:"onDrop"}),o=i.extend({className:"mpf-dropzone",setup:function(t={}){this.acceptedFileTypes=t.acceptedFileTypes,this.maxFileSize=t.maxFileSize,this.tooltip=t.tooltip,e.is(t.additionalClassName,"string")&&this.container.addClassName(t.additionalClassName),this.dropZone=this._createDropZone(),this.mask=this._createMask(),this.alert=this._createAlert(),this.mask.addEvents({click:this._onClick.bind(this),dragenter:this._onDragEnter.bind(this),dragover:this._onDragOver.bind(this),dragleave:this._onDragLeave.bind(this),drop:this._onDrop.bind(this)})},render:function(){return this.container.setContent([this.alert,this.dropZone,this.mask]),this},destroy:function(){this.mask.removeEvents(),this.uploadButton.destroy(),this._parent(),this.container=null},showLoading:function(){this.uploadButton.load(!0)},hideLoading:function(){this.uploadButton.load(!1)},showAlert:function(e){const t=this.alert.getMessages();for(var i=0;i<t.length;i++)this.alert.remove(t[i]);this.alert.add(e).show()},_onClick:function(){this.dispatchEvent(l.ON_CLICK)},_onDragEnter:function(e){e.stopPropagation(),e.preventDefault();const t=this._getFilesFromEvent(e),i=this._getWrongFormatIndices(t);t.length>i.length&&this.container.addClassName("hovered")},_onDragOver:function(e){e.stopPropagation(),e.preventDefault()},_onDragLeave:function(e){e.stopPropagation(),e.preventDefault(),this.container.removeClassName("hovered")},_onDrop:function(e){e.stopPropagation(),e.preventDefault(),this.container.removeClassName("hovered");const t=this._getFilesFromEvent(e),i=this._getWrongFormatIndices(t),s=this._getTooBigIndices(t),n=i.concat(s),a=this._filterUnacceptedFiles(t,n);n.length>0&&this.alert.add({className:"error",message:this._createOnDropErrorMessage(t,n,i,s)}).show(),a.length>0&&this.dispatchEvent(l.ON_DROP,{files:a})},_createOnDropErrorMessage:function(e,i,s,n){let l="";return 1===i.length&&1===e.length?s.length>0?l=r.get("wrongFileType"):n.length>0&&(l=r.get(t.format(r.get("fileTooBig"),a.getReadableFileSize(this.maxFileSize)))):(s.length>0&&(l+=t.format(r.get("filesHaveWrongFormat"),s.length,e.length)),n.length>0&&(l.length>0&&(l+=", "),l+=t.format(r.get("filesExceedSizeOf"),n.length,e.length,a.getReadableFileSize(this.maxFileSize)))),l},_filterUnacceptedFiles:function(e,t){const i=[];for(let s=0;s<e.length;s++)t.indexOf(s)<0&&i.push(e[s]);return i},_getTooBigIndices:function(e){const t=[];if(this.maxFileSize)for(let i=0;i<e.length;i++){const s=e[i];s&&s.size>this.maxFileSize&&t.push(i)}return t},_getWrongFormatIndices:function(e){const t=[];if(this.acceptedFileTypes)for(let i=0;i<e.length;i++)this.acceptedFileTypes.indexOf(e[i].type)<0&&t.push(i);return t},_getFilesFromEvent:function(t){let i;const s=[];e.is(t.dataTransfer)&&e.is(t.dataTransfer.items)&&t.dataTransfer.items.length>0?i=t.dataTransfer.items:e.is(t.dataTransfer)&&e.is(t.dataTransfer.files)&&(i=t.dataTransfer.files);for(let t=0;t<i.length;t++){const n=i[t];e.is(n.getAsFile,"function")&&n.getAsFile()?s.push(n.getAsFile()):s.push(n)}return s},_createDropZone:function(){const t=e.createElement("span",{class:"fonticon fonticon-2x fonticon-popup"}),i=e.createElement("div",{html:r.get("dropFileMessage")}),s=e.createElement("div",{html:[{tag:"div",class:"mpf-dropzone-orline"},{tag:"div",class:"mpf-dropzone-ortext",html:r.get("orMessage")}]});return this.uploadButton=new n({className:"primary",value:r.get("upContent")}),e.createElement("div",{class:"mpf-dropzone-visible-elements",html:[t,i,s,this.uploadButton]})},_createMask:function(){const t=e.createElement("div",{class:"mpf-dropzone-mask"});return this.tooltip&&t.setAttribute("title",this.tooltip),t},_createAlert:function(){return new s({autoHide:!0,hideDelay:5e3,closeOnClick:!0})}});return o.Events=l,o})),define("DS/MPFView/DropdownFieldDateInput",["UWA/Core","UWA/String","UWA/Class/View","DS/UIKIT/Input/Date","DS/UIKIT/IconDropdown","DS/MPFView/ValidationResultBuilder","i18n!DS/MPFView/assets/nls/FieldTextInput","css!DS/MPFView/MPFView"],(function(e,t,i,s,n,a,r){"use strict";const l=Object.freeze({UPDATE:"update"}),o=i.extend({className:"mpf-entry mpf-dropdown-date",domEvents:{change:"onChange"},setup(e={}){this.fieldName=e.fieldName,this.fieldLabel=e.fieldLabel,this.saveOnChange=!0===e.saveOnChange,this.placeholder=e.placeholder,this.useIsoFormat=e.useIsoFormat,this.renderDatePickerInside=!1===e.renderDatePickerInside,this.wrapper=this._createWrapper(),e.additionalClassName&&this.container.addClassName(e.additionalClassName)},render(){let e;return this.renderDatePickerInside?(e=this.container.getElement("label"),e&&e.remove(),this.wrapper.inject(this.container,"top")):this.container.setContent(this.wrapper),this},onChange(){const e=this.input.getDate();if(e){const t=("0"+e.getDate()).slice(-2),i=("0"+(e.getMonth()+1)).slice(-2);let s=e.getFullYear()+"-"+i+"-"+t;this.useIsoFormat&&(s=this._convertToISO(s)),this.validate().isValid&&(this.model.set(this.fieldName,s),this.saveOnChange&&this.model.savePromise(this.model.pick(this.fieldName),{patch:!0}),this.dispatchEvent(l.UPDATE,this.model))}},_convertToISO:e=>e+"T00:00:00Z",setMinDate(e){this.min=e,this.input&&this.input.setMinDate(e)},setMaxDate(e){this.max=e,this.input&&this.input.setMaxDate(e)},getDate(){return this.input.getDate()},getValue(){return this.input.getValue().trim()},validate(){const e=new a;this._clearValidationErrors();const i=""===this.getValue();if(this.required&&i&&e.addError(this.fieldName,t.format(r.get("requiredField"),this.fieldLabel)),e.isValid){const t={};t[this.fieldName]=this.getValue();const i=this.model.validate(t);i&&i.filter(this._resultByFieldName.bind(this)).forEach((function(t){e.addError(this.fieldName,t.message)}),this)}const s=e.build();return this.showValidationErrors(s),s},showValidationErrors(t){this.container.removeClassName("mpf-invalid"),this.container.getElements(".mpf-error").forEach((function(e){e.remove()})),t.isValid||(this.container.addClassName("mpf-invalid"),t.errors.forEach((function(t){return e.createElement("p",{class:"mpf-error",text:t.message}).inject(this.container)}),this))},_clearValidationErrors(){this.container.removeClassName("mpf-invalid"),this.container.getElements(".mpf-error").forEach((function(e){e.remove()}))},_resultByFieldName(e){return e.fieldName===this.fieldName||e.field===this.fieldName},_createWrapper(){const t=e.createElement("span",{class:"mpf-label",text:this.fieldLabel});if(this.required){const i=e.createElement("em",{class:"mpf-required",text:"*"});t.addContent(["&nbsp;",i])}this.input=this._createInput(),this.target=this._createTarget(),this.iconDropdown=this._createIconDropdown(this.target);return e.createElement("div",{class:"mpf-dropdown-field-date-input-header",html:[e.createElement("label",{html:[t,this.target,this.iconDropdown.hide()]}),this.input]})},_createInput(){const e={value:this.model.get(this.fieldName)||"",name:this.fieldName||"",placeholder:this.placeholder,className:"mpf-"+this.fieldName,pickerClassName:"mpf-"+this.fieldName+"-datepicker"};return this.renderDatePickerInside&&(e.renderTo=this.container),new s(e)},_createTarget:()=>e.createElement("div",{class:"fonticon fonticon-math-equal fonticon-clickable"}),_createIconDropdown:e=>new n({target:e,items:[{fonticon:"fonticon fonticon-math-less-than-equal "},{selected:!0,fonticon:"fonticon fonticon-math-equal "},{fonticon:"fonticon fonticon-math-greater-than-equal "}],events:{onClick:function(t,i){e.set("class",i.elements.icon.className)}}})});return o.Events=l,o})),define("DS/MPFView/TaggerInput",["UWA/Core","UWA/Class/View","DS/UIKIT/Input/Text","DS/MPFView/ControlsTag","css!DS/MPFView/MPFView"],(function(e,t,i,s){"use strict";const n=Object.freeze({ITEM_ADDED:"itemAdded",ITEM_REMOVED:"itemRemoved",ITEM_CHANGED:"itemChanged"}),a=t.extend({className:"mpf-tagger-input",setup(e={}){this.placeholder=e.placeholder,this.validator=e.validator||function(){return{isValid:!0}},this.items=e.items||[],this.tags=this._createTags(this.items),this.input=this._createTextInput()},render(){const e=[];for(let t=0;t<this.tags.length;t++)e.push(this.tags[t].render());return this.container.setContent([{tag:"div",class:"mpf-tags-container",html:e},this.input]),this},destroy(){this.clear(),this._parent(),this.container=null},focus(){this.input.focus()},clear(){for(let e=0;e<this.tags.length;e++)this.tags[e].destroy();this.items=[],this.tags=[],this._removeErrorMessage(),this.input.setValue("")},showError(e){this.input.elements.container.addClassName("mpf-invalid"),this.container.addContent({tag:"p",class:"mpf-error",text:e})},getValues(){const e=[];for(let t=0;t<this.tags.length;t++){const i=this.tags[t].getValue();i&&e.push(i)}return e},_removeErrorMessage(){this.input.elements.container.removeClassName("mpf-invalid");const t=this.container.getElement("p.mpf-error");e.is(t)&&this.container.removeChild(t)},_createTags(e){const t=[];for(let i=0;i<e.length;i++)t.push(this._createTag(e[i],i));return t},_createTag(e){const t=new s({value:e,validator:this.validator});return this.listenTo(t,s.Events.DELETE,this._removeTag.bind(this,t)),this.listenTo(t,s.Events.ON_CHANGE,this.dispatchEvent.bind(this,n.ITEM_CHANGED)),t},_addTag(){const e=this.input.getValue(),t=this.validate(e);t.isValid?(this.tags.push(this._createTag(e)),this.input.setValue(""),this.render(),this.focus(),this.dispatchEvent(n.ITEM_ADDED,e)):this.showError(t.message)},_removeTag(e){const t=this.tags.indexOf(e);if(-1!==t){this.tags.splice(t,1)[0].destroy(),this.dispatchEvent(n.ITEM_REMOVED)}},_createTextInput(){return new i({placeholder:this.placeholder,onChange:this.validate.bind(this),className:"mpf-text-input",events:{onChange:this._addTag.bind(this)}})},validate(e){return this._removeErrorMessage(),this.validator(e)}});return a.Events=n,a})),define("DS/MPFView/FieldTextInputV2",["UWA/Core","UWA/String","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFModel/MPFModel","DS/UIKIT/Input/Text","DS/UIKIT/Tooltip","DS/MPFView/ValidationResultBuilder","i18n!DS/MPFView/assets/nls/FieldTextInput","css!DS/MPFView/MPFView"],(function(e,t,i,s,n,a,r,l,o){"use strict";const h=Object.freeze({UPDATE:"update"}),d=i.extend({className:"mpf-entry-v2",domEvents:{change:"onChange",keyup:"_onKeyUp"},setup:function(t={}){this._parent(t),s.requiredOfPrototype(this.model,n,"this.model must be a MPFModel"),this.fieldName=t.fieldName,this.fieldLabel=t.fieldLabel,this.fieldPrefix=t.fieldPrefix,this.required=!0===t.required,this.readOnly=!0===t.readOnly,this.dynamicValidation=!0===t.dynamicValidation,this.keyUpValidation=!0===t.keyUpValidation,this.saveOnChange=!0===t.saveOnChange,this.tooltip=t.tooltip,this.maxlength=t.maxlength,this.silent=!e.is(t.silent)||t.silent,this.multiline=!0===t.multiline,this.multilineRows=t.multilineRows||1,this.trim=!1!==t.trim,this.type=t.type||"text",this.placeholder=t.placeholder,this.pattern=t.pattern,this.input=this._createInput(),this.entry=this._createEntry(this.fieldLabel)},render:function(){return this.container.setContent(this.entry),this},addContentInEntry(e){this.entry.addContent(e)},isValid(){const e=this.getValue().trim();if(e!==(this.model.get(this.fieldName)||"")||this.required&&""===e)return!1;{const e=this.model.validate(this.fieldName);return!e||0===e.length}},validate:function(i={}){const s=new l,n={};if(this._removeErrorMessage(),this.required&&""===this.getValue().trim()&&s.addError(this.fieldName,t.format(o.get("requiredField"),this.fieldLabel)),(e.is(this.pattern)&&-1===this.getValue().search(this.pattern)||e.is(i.pattern)&&-1===this.getValue().search(i.pattern))&&s.addError(this.fieldName,t.format(o.get("invalidField"),this.fieldLabel)),s.isValid){this.model.get(this.fieldName)!==this.getValue()&&(n[this.fieldName]=this.getValue(),this.model.set(n,{silent:this.silent}));const t=this.model.validate(this.fieldName);e.is(t)&&t.forEach((e=>{s.addError(this.fieldName,e.message)}))}const a=s.build();return a.isValid||this._displayErrorMessage(a),a},save:function(){return this.model.savePromise(this.model.pick(this.fieldName),{patch:!0})},focus:function(){return this.input.focus()},_displayErrorMessage:function(t){const i=t.errors[0];this.container.addClassName("mpf-invalid"),e.createElement("p",{class:"mpf-error",text:e.is(i.message)?i.message:""}).inject(this.container)},_removeErrorMessage:function(){this.container.removeClassName("mpf-invalid");const t=this.container.getElement("p");e.is(t)&&this.container.removeChild(t)},onChange:function(){if(this.saveOnChange){this.validate().isValid&&this.save()}else(this.dynamicValidation||this.keyUpValidation)&&this.validate();this.dispatchEvent(h.UPDATE,this.model)},getValue:function(){let e;const t=this.trim?this.input.getValue().trim():this.input.getValue();return e=this.fieldPrefix?this.fieldPrefix+t:t,e},setValue:function(e,t={}){this.input.setValue(e),!0!==t.silent&&this.onChange()},resetValue:function(e={}){this.input.setValue(""),!0!==e.silent&&this.onChange(),this._removeErrorMessage()},getInput:function(){return this.input},setDisabled:function(e){this.readOnly=!1!==e,this.input.setDisabled(this.readOnly)},_onKeyUp:function(){this.keyUpValidation&&(this.validate(),this.dispatchEvent(h.UPDATE,this.model))},_createInput:function(){let e=this.model.get(this.fieldName)||"";this.fieldPrefix&&(e=e.replace(this.fieldPrefix,""));return new a({name:this.fieldName,value:e,disabled:this.readOnly,required:this.required,maxlength:this.maxlength,multiline:this.multiline,rows:this.multilineRows,placeholder:this.placeholder,attributes:{type:this.type}})},_createEntry:function(t){const i=[],s=[];i.push(t),this.required&&""!==t&&i.push('&nbsp;<em class="mpf-required">*</em>'),this.tooltip&&i.push(this._createTooltip()),s.push(e.createElement("span",{class:"mpf-label",html:i})),this.fieldPrefix&&e.createElement("span",{class:"mpf-prefix",html:this.fieldPrefix}),s.push(this.input);return e.createElement("label",{html:s})},_createTooltip:function(){const t=e.createElement("span",{class:"fonticon fonticon-info mpf-entry-tooltip"});return new r({target:t,body:this.tooltip}),t},destroy:function(){this.input=null,this.stopListening(this.model),this.model=null,this._parent()}});return d.Events=h,d})),define("DS/MPFView/SortByDragList",["UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFView/ConfirmationModal","DS/MPFView/SortByDragItem","i18n!DS/MPFView/assets/nls/SortByDragList","css!DS/MPFView/MPFView"],(function(e,t,i,s,n){"use strict";const a=Object.freeze({CHANGE:"onChange"}),r=e.extend({className:"mpf-sort-by-drag-list",setup(e={}){t.requiredOfType(e.items,"array","options.items must be an array of objects"),this.originalItems=e.items,this.draggedItem=null,this.items=this._createItems(e.items),this.confirmDeletionModal=this._createConfirmDeletionModal()},render(){return this.container.setContent([this.confirmDeletionModal.render(),this.items.map((e=>e.render()))]),this},contains(e){return!!this.items.find((t=>t.currentLabel===e))},add({id:e,label:t,isRemovable:i}){return this.items.push(this._createItem({id:e,label:t,isRemovable:i},this.items.length)),this._dispatchChangeEvent(),this},wasModified(){let e=!1,t=0;const i=Math.max(this.items.length,this.originalItems.length);for(;!1===e&&t<i;){const i=this.items[t],s=this.originalItems[t];i&&s?i.currentLabel!==s.label&&(e=!0):e=!0,++t}return e},getModifedArray(){return this.items.map((e=>({label:e.currentLabel,originalLabel:e.originalLabel,id:e.id})))},destroy(){this.stopListening(),this.items.forEach((e=>e.destroy())),this.items=null,this.draggedItem=null,this._parent(),this.container=null},_showConfirmDeletionModal(e){this.stopListening(this.confirmDeletionModal),this.listenTo(this.confirmDeletionModal,i.Events.CONFIRM,this._removeItem.bind(this,e)),this.confirmDeletionModal.show()},_removeItem(e){this.items.splice(this.items.indexOf(e),1),this.confirmDeletionModal.hide(),this.render(),this._dispatchChangeEvent()},_dispatchChangeEvent(){this.dispatchEvent(a.CHANGE,this.wasModified())},_onDragOver(e){null!==this.draggedItem&&e!==this.draggedItem&&(this.items.splice(this.draggedItem.getIndex(),1),this.items.splice(e.getIndex(),0,this.draggedItem),this.items.forEach(((e,t)=>{e.setIndex(t)})),this.render())},_createConfirmDeletionModal:()=>new i({header:n.get("deleteItem"),body:n.get("confirmDeletionQuestion"),confirmButtonLabel:n.get("delete")}),_createItems(e){return e.map(this._createItem.bind(this))},_createItem({id:e,label:t,isRemovable:i},n){const a=new s({id:e,label:t,index:n,isRemovable:i});return this.listenTo(a,s.Events.HOVERED,this._onDragOver.bind(this)),this.listenTo(a,s.Events.DRAG_START,(e=>{this.draggedItem=e})),this.listenTo(a,s.Events.DRAG_END,(()=>{this.draggedItem=null,this._dispatchChangeEvent()})),this.listenTo(a,s.Events.LABEL_CHANGE,this._dispatchChangeEvent.bind(this)),this.listenTo(a,s.Events.DELETE,this._showConfirmDeletionModal.bind(this,a)),a}});return r.Events=a,r})),define("DS/MPFView/FieldDateInput",["UWA/Core","UWA/String","UWA/Class/View","DS/UIKIT/Input/Date","DS/MPFView/ValidationResultBuilder","i18n!DS/MPFView/assets/nls/FieldTextInput","css!DS/MPFView/MPFView"],(function(e,t,i,s,n,a){"use strict";const r=Object.freeze({UPDATE:"update"}),l=i.extend({className:"mpf-entry mpf-date",domEvents:{change:"onChange"},setup:function(e={}){this.fieldName=e.fieldName,this.fieldLabel=e.fieldLabel,this.required=!0===e.required,this.readOnly=!0===e.readOnly,this.saveOnChange=!0===e.saveOnChange,this.renderDatePickerInside=!0===e.renderDatePickerInside,this.useIsoFormat=!0===e.useIsoFormat,this.tooltip=e.tooltip,this.placeholder=e.placeholder,this.min=e.min,this.max=e.max,this.wrapper=this._createWrapper(),e.additionalClassName&&this.container.addClassName(e.additionalClassName)},render:function(){let e;return this.renderDatePickerInside?(e=this.container.getElement("label"),e&&e.remove(),this.wrapper.inject(this.container,"top")):this.container.setContent(this.wrapper),this},onChange:function(){const e=this.input.getDate();if(e){const t=e.getDate(),i=e.getMonth()+1,s=e.getFullYear(),n=this.useIsoFormat?s+"-"+i+"-"+t:i+"/"+t+"/"+s;this.validate().isValid&&(this.model.set(this.fieldName,n),this.saveOnChange&&this.model.savePromise(this.model.pick(this.fieldName),{patch:!0}),this.dispatchEvent(r.UPDATE,this.model))}},setReadOnly:function(e){this.input.setDisabled(e)},setMinDate:function(e){this.min=e,this.input&&this.input.setMinDate(e)},setMaxDate:function(e){this.max=e,this.input&&this.input.setMaxDate(e)},getDate:function(){return this.input.getDate()},getValue:function(){return this.input.getValue().trim()},setValue:function(e,t={}){this.input.setValue(e),!0!==t.silent&&this.onChange()},validate:function(){const e=new n;this._clearValidationErrors();const i=""===this.getValue();if(this.required&&i&&e.addError(this.fieldName,t.format(a.get("requiredField"),this.fieldLabel)),e.isValid){const t={};t[this.fieldName]=this.getValue();const i=this.model.validate(t);i&&i.filter(this._resultByFieldName.bind(this)).forEach((function(t){e.addError(this.fieldName,t.message)}),this)}const s=e.build();return this.showValidationErrors(s),s},showValidationErrors:function(t){this.container.removeClassName("mpf-invalid"),this.container.getElements(".mpf-error").forEach((function(e){e.remove()})),t.isValid||(this.container.addClassName("mpf-invalid"),t.errors.forEach((function(t){return e.createElement("p",{class:"mpf-error",text:t.message}).inject(this.container)}),this))},focus:function(){return this.input.focus()},_clearValidationErrors:function(){this.container.removeClassName("mpf-invalid"),this.container.getElements(".mpf-error").forEach((function(e){e.remove()}))},_resultByFieldName:function(e){return e.fieldName===this.fieldName||e.field===this.fieldName},_createWrapper:function(){const t=e.createElement("span",{class:"mpf-label",text:this.fieldLabel});if(this.required){const i=e.createElement("em",{class:"mpf-required",text:"*"});t.addContent(["&nbsp;",i])}this.input=this._createInput();return e.createElement("label",{html:[t,this.input]})},_createInput:function(){const e={value:this.model.get(this.fieldName)||"",name:this.fieldName||"",min:this.min,max:this.max,disabled:this.readOnly,className:"mpf-"+this.fieldName,pickerClassName:"mpf-"+this.fieldName+"-datepicker",placeholder:this.placeholder};return this.renderDatePickerInside&&(e.renderTo=this.container),new s(e)}});return l.Events=r,l})),define("DS/MPFView/FieldNumberInputV2",["UWA/Core","UWA/String","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFModel/MPFModel","DS/UIKIT/Input/Number","DS/MPFView/ValidationResultBuilder","i18n!DS/MPFView/assets/nls/FieldTextInput","css!DS/MPFView/MPFView"],(function(e,t,i,s,n,a,r,l){"use strict";const o=Object.freeze({UPDATE:"update"}),h=i.extend({className:"mpf-number-input-v2",setup:function(e={}){s.requiredOfPrototype(this.model,n,"options.model must be a MPFModel"),s.requiredOfType(e.fieldName,"string","options.fieldName must be a string"),s.requiredOfType(e.fieldLabel,"string","options.fieldLabel must be a string"),this.fieldName=e.fieldName,this.fieldLabel=e.fieldLabel,this.required=!0===e.required,this.readOnly=!0===e.readOnly,this.useStringValues=!1!==e.useStringValues,this.min=e.min||0,this.max=e.max||10,this.step=e.step||1,this.tooltip=e.tooltip,this.input=this._createInput()},onChange:function(){this.input&&(this.useStringValues?this.model.set(this.fieldName,this.getValue()):this.model.set(this.fieldName,parseFloat(this.getValue()))),this.dispatchEvent(o.UPDATE,this.model)},render:function(){return this.label=e.createElement("span",{class:"mpf-label",html:[this._renderLabel(),this.input]}),this.container.setContent([this.label]),this},getValue:function(){let e;if(","===this.input.options.decimalSeparator){e=this.input.getValue().replace(",",".")}else e=this.input.getValue();return this.useStringValues?e:parseFloat(e)},setValue:function(e){return this.input.setValue(e)},addContentInLabel(e){this.label.addContent(e)},destroy:function(){this.model=null,this._parent(),this.container=null},validate:function(){const i=new r,s={};if(this._removeErrorMessage(),this.required&&"0"===this.getValue()&&i.addError(this.fieldName,t.format(l.get("requiredField"),this.fieldLabel)),i.isValid){this.model.get(this.fieldName)!==this.getValue()&&(s[this.fieldName]=this.getValue(),this.model.set(s,{silent:this.silent}));const t=this.model.validate(this.fieldName);e.is(t)&&t.forEach((e=>{i.addError(this.fieldName,e.message)}))}const n=i.build();return n.isValid||this._displayErrorMessage(n),n},_displayErrorMessage:function(t){const i=t.errors[0];this.container.addClassName("mpf-invalid"),e.createElement("p",{class:"mpf-error",text:e.is(i.message)?i.message:""}).inject(this.container)},_removeErrorMessage:function(){this.container.removeClassName("mpf-invalid");const t=this.container.getElement("p");e.is(t)&&this.container.removeChild(t)},_renderLabel:function(){const t=e.createElement("label",{text:this.fieldLabel});return this.required&&t.addContent(["&nbsp;",{tag:"em",class:"mpf-required",text:"*"}]),t},setDisabled:function(e){this.readOnly=!1!==e,this.input.setDisabled(this.readOnly)},_createInput:function(){return new a({value:this.model.get(this.fieldName)||this.min,min:this.min,max:this.max,step:this.step,disabled:this.readOnly,events:{onChange:this.onChange.bind(this)}})}});return h.Events=o,h})),define("DS/MPFView/FieldSelectInputV2",["UWA/Core","UWA/String","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFModel/MPFModel","DS/MPFView/ValidationResultBuilder","DS/UIKIT/Input/Select","i18n!DS/MPFView/assets/nls/FieldTextInput","css!DS/MPFView/MPFView"],(function(e,t,i,s,n,a,r,l){"use strict";const o=Object.freeze({UPDATE:"update"}),h=i.extend({className:"mpf-select-v2",domEvents:{change:"onChange"},setup:function(t={}){this._parent(t),s.requiredOfPrototype(this.model,n,"this.model must be a MPFModel"),this.fieldName=t.fieldName,this.fieldLabel=t.fieldLabel,this.required=!0===t.required,this.readOnly=!0===t.readOnly,this.dynamicValidation=!0===t.dynamicValidation,this.saveOnChange=!0===t.saveOnChange,this.silent=!e.is(t.silent)||t.silent,this.selectableOptions=t.selectableOptions||[],this.multipleOptionsSelectable=!0===t.multipleOptionsSelectable,this.placeholder=t.placeholder,this.select=this._createSelect(),this.entry=this._createEntry(this.fieldLabel)},render:function(){return this.container.setContent(this.entry),this},destroy:function(){this.entry.destroy(),this.select=null,this.selectableOptions=null,this.model=null,this._parent(),this.container=null},isValid(){const e=this.getValue().trim();if(e!==this.model.get(this.fieldName)||this.required&&""===e)return!1;{const e=this.model.validate(this.fieldName);return!e||0===e.length}},validate:function(){const i=new a;if(this._removeErrorMessage(),this.required&&""===this.getValue().trim()&&i.addError(this.fieldName,t.format(l.get("requiredField"),this.fieldLabel)),i.isValid){const t={[this.fieldName]:this.getValue()};this.model.get(this.fieldName)!==this.getValue()&&this.model.set(t,{silent:this.silent});const s=this.model.validate(this.model.pick(this.fieldName));e.is(s)&&s.filter((e=>e.fieldName===this.fieldName)).forEach((e=>{i.addError(this.fieldName,e.message)}))}const s=i.build();return s.isValid||this._displayErrorMessage(s),s},save:function(){return this.model.savePromise(this.model.pick(this.fieldName),{patch:!0})},_displayErrorMessage:function(t){const i=t.errors[0];this.container.addClassName("mpf-invalid"),e.createElement("p",{class:"mpf-error",text:e.is(i.message)?i.message:""}).inject(this.container)},_removeErrorMessage:function(){this.container.removeClassName("mpf-invalid");const t=this.container.getElement("p");e.is(t)&&this.container.removeChild(t)},onChange:function(){this.dynamicValidation&&this.validate(),this.saveOnChange&&this.save(),this.dispatchEvent(o.UPDATE,this.model)},getValue:function(){return this.multipleOptionsSelectable?this.select.getValue():this.select.getValue()[0]},setValue:function(e,t={}){this.select.select(e),!0!==t.silent&&this.onChange()},resetValue:function(e={}){this.select.clear(),!0!==e.silent&&this.onChange(),this._removeErrorMessage()},setReadOnly:function(e){this.readOnly=!1!==e,this.readOnly?this.select.disable():this.select.enable()},isDisabled:function(){return this.select.isDisabled()},add:function(e){return this.select.add(e)},remove:function(e){return this.select.remove(e)},_createSelect:function(){const e=this.model.get(this.fieldName)||"";return new r({name:this.fieldName,value:e,placeholder:this.placeholder,disabled:this.readOnly,required:this.required,options:this.selectableOptions,multiple:this.multipleOptionsSelectable})},_createEntry:function(t){const i=[];return i.push(t),this.required&&""!==t&&i.push('&nbsp;<em class="mpf-required">*</em>'),e.createElement("span",{class:"mpf-label",html:[e.createElement("label",{html:i}),this.select]})}});return h.Events=o,h}));