define("DS/SourcingFacetNavigation/models/EquivalentItems",["DS/SourcingCommonInfra/utils/Services"],(function(e){"use strict";var t=function(){this.source="sourcing"};return t.prototype.init=function(){e.initialize()},t.prototype.getAllEquivalentItems=function(t){return t.isMEI?t.endpoint="/resources/v1/modeler/dssourcing/qualifications/target/"+t.id:t.endpoint="/resources/v1/modeler/dssourcing/qualifications/context/"+t.id+"/equivalentqualifications",t.includeParams&&(t.endpoint=t.endpoint+"?"+t.includeParams),t.source=this.source,e.getDataPromise(t)},t.prototype.getAllEquivalentItemsFromTargetItemId=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications/target/"+t.id,t.includeParams&&(t.endpoint=t.endpoint+"?"+t.includeParams),t.source=this.source,e.getDataPromise(t)},t.prototype.getAllEquivalentItemsFromAllContextItems=function(t){let i={endpoint:"/resources/v1/modeler/dssourcing/qualifications/contextQualifications?type=equivalentQualification"};return i.postData=t,i.source=this.source,e.performPostPromise(i)},t.prototype.getProxyObjectId=function(t){return t.endpoint="/resources/dssourcing/ProxyObject",t.source=this.source,t.postData=t.data,e.performPostPromise(t)},t})),define("DS/SourcingFacetNavigation/controllers/EquivalentItemsController",["DS/SourcingFacetNavigation/models/EquivalentItems","DS/SourcingCommonInfra/utils/SearchUtility","DS/SourcingCommonInfra/utils/Constants","DS/SourcingCommonInfra/utils/NotificationsUtil","DS/SourcingCommonInfra/utils/OpenWithService"],(function(e,t,i,n,a){"use strict";var o=function(i){this.app=i.app?i.app:void 0,this.NLS=this.app?this.app.i18NProvider:void 0,this.model=new e,this.searchUtil=new t,widget&&(widget.notificationUtil=n)};return o.prototype.getMEIData=async function(e){let t=this,n=await t.searchUtil.getSearchPayload([e],[i.VPMREFERENCE],[]),a=await t.searchUtil.callFederatedSearch(n),o=t.searchUtil.processFedSearchData(a),l="",r=!1;return new Promise((n=>{if(o.length>0&&o[0]["ds6w:what/ds6w:kind"]===i.MEI_EXTENSION){l="$include=Context",r=!0;let a=o[0]["ds6w:label"]?o[0]["ds6w:label"]:"",s=o[0].sourceid?o[0].sourceid.split(":")[0]:i.SOURCE_3DSPACE,d=o[0].sourceid?o[0].sourceid.split(":")[1]:t.app.platformServices.platformId,c={data:[{id:e,type:i.MEI_PROXY,dataelements:{"ProxyItem.Proxy_Title":a,"ProxyItem.Proxy_Service":s,"ProxyItem.Proxy_Tenant":d}}]};t.model.getProxyObjectId({data:c}).then((function(i){t.model.getAllEquivalentItems({id:i[e],includeParams:l,isMEI:r}).then((async function(e){let i=await t.processMEIData(e.data,r,o);n({meiData:i,isMEI:r})}),(function(){n({})})).catch((function(){n({})}))}))}else l="$include=target",t.model.getAllEquivalentItems({id:e,includeParams:l,isMEI:r}).then((async function(e){let i=await t.processMEIData(e.data,r,o);n({meiData:i,isMEI:r})}),(function(){n({})})).catch((function(){n({})}))}))},o.prototype.processMEIData=async function(e,t,n){let a,o,l=this,r={"ds6w:status":[]};t?(o=e.filter((e=>e.type===i.TYPE_SRC_GENERAL_QUALIFICATION)),e=e.filter((e=>e.type===i.EEQ_TYPE)),a="Context"):a="target",e.forEach((e=>{e.relateddata[a].forEach((t=>{t.dataelements.eqApproved=e.dataelements["SRC Approved"],t.dataelements.eqState=e.dataelements.state,t.dataelements.eqStateDisplay=e.dataelements.stateDisplay,t.dataelements.eqEffectivityEndDate=e.dataelements["Effectivity End Date"],t.dataelements.eqEffectivityStartDate=e.dataelements["Effectivity Start Date"],t.dataelements.eqName=e.dataelements.name,t.dataelements.eqRevision=e.dataelements.revision,t.dataelements.eqTitle=e.dataelements.title,t.dataelements.eqPreferred=e.dataelements["SRC Preferred"],t.dataelements.islast="TRUE"===e.dataelements.islast}))}));let s=e.map((e=>e.relateddata[a])),d=[],c=[],u=[],p="",m=e[0].relateddata.Context[0].dataelements.Proxy_Id;s.forEach((e=>{e.forEach((e=>{d.push(e),u.push(e.dataelements.Proxy_Id)}))})),l.app.platformServices.platformId!==i.ONPREMISE&&u.push(m);let f=await l.searchUtil.getSearchPayload(u,[i.VPMREFERENCE],[]),g=await l.searchUtil.callFederatedSearch(f),h=l.searchUtil.processFedSearchData(g);if(l.app.platformServices.platformId===i.ONPREMISE||t)p=t?`${n[0]["ds6w:label"]} (${n[0]["ds6wg:revision"]})`:`${e[0].relateddata.Context[0].dataelements.Title} (${e[0].relateddata.Context[0].dataelements.Revision})`;else{let e=h.findIndex((e=>e.resourceid===m)),t=h.splice(e,1)[0];p=`${t["ds6w:label"]} (${t["ds6wg:revision"]})`}t||(h=h.filter((e=>e["ds6w:who/ds6w:responsible/ds6w:manufacturer"]))),h.forEach((n=>{let a=d.filter((e=>e.dataelements.Proxy_Id===n.physicalid&&e.dataelements.islast))[0],s=a.dataelements;t&&(s.state=o[0].dataelements.state,s.genQualificationApproved=o[0].dataelements["SRC Approved"],s.genQualificationLastTimeBuy=o[0].dataelements["Last Time Buy"],s.genQualificationEffectivityEndDate=o[0].dataelements["Effectivity End Date"]);let u=l.checkMeiValidity(s,n["ds6w:what/ds6w:status"].split(".").pop());r["ds6w:status"].push({value:n["ds6w:what/ds6w:status"],source:[i.SERVICE_3DSPACE]}),c.push({grid:{id:n.physicalid,actualType:t?n["ds6w:what/ds6w:type"]:i.MEI_PROXY,status:u.icon,statusTip:u.tooltip,title:n["ds6w:label"],...!t&&{partNumber:n["ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber"]},prdName:n.name,revision:n["ds6wg:revision"],...!t&&{manufacturer:n["ds6w:who/ds6w:responsible/ds6w:manufacturer"]},description:n["ds6w:description"]?n["ds6w:description"]:a.dataelements.Description,maturity:n["ds6w:what/ds6w:status"],type:n["ds6w:what/ds6w:type_value"]?n["ds6w:what/ds6w:type_value"]:n["ds6w:what/ds6w:type"],serviceId:i.SERVICE_3DSPACE,owner:n["ds6w:who/ds6w:responsible"],eqName:a.dataelements.eqName,eqRevision:a.dataelements.eqRevision,eqApproved:l.NLS[a.dataelements.eqApproved],eqState:a.dataelements.eqStateDisplay,eqEffectivityStartDate:a.dataelements.eqEffectivityStartDate,eqEffectivityEndDate:a.dataelements.eqEffectivityEndDate,eqTitle:a.dataelements.eqTitle,...!t&&{gqName:a.dataelements.genQualificationName,gqRevision:a.dataelements.genQualificationRevision,gqApproved:l.NLS[a.dataelements.genQualificationApproved],gqState:a.dataelements.stateDisplay,gqLastTimeBuy:a.dataelements.genQualificationLastTimeBuy,gqEffectivityStartDate:a.dataelements.genQualificationEffectivityStartDate,gqEffectivityEndDate:a.dataelements.genQualificationEffectivityEndDate,gqTitle:a.dataelements.genQualificationTitle}},contextName:p,label:n["ds6w:label"],thumbnail:t?require.toUrl(n.preview_url):require.toUrl("SourcingCommonInfra/assets/icons/MEI-Thumbnail.png"),thumbnail_qual:require.toUrl("SourcingCommonInfra/assets/icons/Qualification16.png"),id:n.physicalid,statusbarIcons:u.icon,statusbarIconsTooltips:u.tooltip,...!t&&{subLabel:l.getSubLabel(n)},contextualMenu:l.onContextualEventCallback,isQualificationReleased:e.state&&e.state===i.RELEASED&&e.eqState===i.RELEASED||!e.state&&e.eqState===i.RELEASED})}));let E=await l.searchUtil.getNlsOfPropertiesValues(r);return c.forEach((e=>{e.grid.maturityDisplay=E["ds6w:status"][e.grid.maturity],e.description=l.getDescription(e.grid)})),c},o.prototype.checkMeiValidity=function(e,t){let n=this,a={icon:["expand-up"],tooltip:[n.NLS.in_progress]};return t!==i.RELEASED&&t!==i.RELEASED_MEI_STATE||e.state!==i.RELEASED||e.eqState!==i.RELEASED?e.state&&e.state!==i.OBSOLETE&&e.eqState!==i.OBSOLETE||(a={icon:["wrong"],tooltip:[n.NLS.invalid]}):a="Yes"===e.genQualificationApproved&&"Yes"===e.eqApproved&&""===e.genQualificationLastTimeBuy&&(""===e.eqEffectivityEndDate||new Date(e.eqEffectivityEndDate)>new Date)&&(""===e.genQualificationEffectivityEndDate||new Date(e.genQualificationEffectivityEndDate)>new Date)?{icon:["check"],tooltip:[n.NLS.valid]}:"Yes"===e.genQualificationApproved&&"Yes"===e.eqApproved&&""!==e.genQualificationLastTimeBuy&&(""===e.eqEffectivityEndDate||new Date(e.eqEffectivityEndDate)>new Date)&&(""===e.genQualificationEffectivityEndDate||new Date(e.genQualificationEffectivityEndDate)>new Date)?{icon:["clock"],tooltip:[n.NLS.pending_obsolete]}:{icon:["wrong"],tooltip:[n.NLS.invalid]},"TRUE"===e.eqPreferred&&(a.icon.push("status-ok"),a.tooltip.push(n.NLS.preferred)),a},o.prototype.getDescription=function(e){let t={state:e.maturityDisplay,revision:e.revision,owner:e.owner};return Object.values(t).filter((e=>e)).join(" | ")},o.prototype.getSubLabel=function(e){let t=UWA.createElement("div");return function(e){let t=UWA.createElement("div",{name:"CompanyLabel"});return UWA.createElement("span",{class:"xsourcing-company-icon fonticon fonticon-fonticon fonticon-factory"}).inject(t),UWA.createElement("span",{class:"xsourcing-company-name"}).inject(t).innerHTML=e?e["ds6w:who/ds6w:responsible/ds6w:manufacturer"]:void 0,t}(e).inject(t),t},o.prototype.onContextualEventCallback=function(e){let t=[];if((e.cellInfos?e.cellInfos.rowID:null)<0)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e):[];if(e){let i=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(i)return a.getOpenWithMenu(i).then((function(e){return t.push({id:"OpenWith",type:"PushItem",title:"Open with",icon:"open-menu-dot",submenu:e}),t}))}return t},o.prototype.getContextData=function(e){let t=this,i={data:[]};return e.forEach((e=>{i.data.push({id:e})})),new Promise((n=>{t.model.getAllEquivalentItemsFromAllContextItems(i).then((async function(i){let a=await t.processEQData(i.data),o=t.getColumnData(a,e);n(o)}),(function(){n([])})).catch((function(){n([])}))}))},o.prototype.processEQData=async function(e){let t=this,n=[],a=await t.searchUtil.getSearchPayload(e.map((e=>e.target[0].physicalid)),[i.VPMREFERENCE],[]),o=await t.searchUtil.callFederatedSearch(a);return t.searchUtil.processFedSearchData(o).forEach((t=>{let i=e.filter((e=>e.target[0].physicalid===t.physicalid))[0];n[i.target[0].physicalid]=t["ds6w:what/ds6w:status"].split(".").pop()})),e.map((e=>({contextId:e.Context[0].physicalid,eqState:e.state,gqState:e.target[0].generalQualification.length>0?e.target[0].generalQualification[e.target[0].generalQualification.length-1].state:"",meiOK:e.target[0].generalQualification.length>0&&(t.isMEIOK(n,e)&&""===e.target[0].generalQualification[e.target[0].generalQualification.length-1]["Last Time Buy"]),pendingObsolete:e.target[0].generalQualification.length>0&&(t.isMEIOK(n,e)&&""!==e.target[0].generalQualification[e.target[0].generalQualification.length-1]["Last Time Buy"]),meiDeleted:n[e.target[0].physicalid]})))},o.prototype.isMEIOK=function(e,t){let n=t.target[0].generalQualification[t.target[0].generalQualification.length-1];return e[t.target[0].physicalid]===i.RELEASED_MEI_STATE&&t.state===i.RELEASED&&n.state===i.RELEASED&&"Yes"===t["SRC Approved"]&&"Yes"===n["SRC Approved"]&&(""===t["Effectivity End Date"]||new Date(t["Effectivity End Date"])>new Date)&&(""===n["Effectivity End Date"]||new Date(n["Effectivity End Date"])>new Date)},o.prototype.getColumnData=async function(e,t){let n=this,a=[],o=await n.searchUtil.getSearchPayload(t,[i.VPMREFERENCE],[]),l=await n.searchUtil.callFederatedSearch(o);return n.searchUtil.processFedSearchData(l).map((e=>e.resourceid)).forEach((t=>{let o="",l=e.filter((e=>e.contextId===t&&!!e.meiDeleted)),r=l.filter((e=>e.meiOK)),s=l.filter((e=>e.pendingObsolete)),d=l.filter((e=>e.eqState!==i.RELEASED&&e.eqState!==i.OBSOLETE||e.gqState!==i.RELEASED&&e.gqState!==i.OBSOLETE)),c=l.filter((e=>""===e.gqState));switch(!0){case r.length>0&&0===d.length&&0===s.length:o={icon:["check"],tooltip:n.NLS.valid};break;case r.length>0&&1===s.length:o={icon:["check","clock"],tooltip:n.NLS.pending_obsolete};break;case r.length>0&&d.length>0:o={icon:["record"],tooltip:n.NLS.under_qualification};break;case 1===s.length:o={icon:["clock"],tooltip:n.NLS.last_pending_obsolete};break;case 0===r.length&&d.length>0&&0===c.length:o={icon:["expand-up"],tooltip:n.NLS.first_qualification};break;default:o={icon:["wrong"],tooltip:n.NLS.invalid}}a[t]=o})),a},o})),define("DS/SourcingFacetNavigation/views/MEIColumnDataProvider",["UWA/Core","DS/SourcingFacetNavigation/controllers/EquivalentItemsController","DS/SourcingCommonInfra/utils/PlatformServices","DS/ENOXLogger/Logger","DS/Utilities/Dom","i18n!DS/SourcingFacetNavigation/assets/nls/SourcingFacetNavigation"],((e,t,i,n,a,o)=>{"use strict";let l;return l||(l=new class{constructor(){this.name="MEIColumns",this.i18NProvider=Object.freeze(o),this.columns={MEIColumn:{text:this.i18NProvider.mei,dataIndex:"MEIColumn",ds6w:o.mei,allowUnsafeHTMLContent:!1,getContentCallback:this.getContentCallback,maxWidth:800,minWidth:20,width:200}};let e={i18NProvider:this.i18NProvider};e.logger=n,i.getPlatformServices(e).then((async function(t){e.platformServices=t})),this.controller=new t({app:e})}isAdditionalColumnsAvailable(t){if(!1===e.is(t,"function"))throw new Error("A callback function should be defined");t(!0)}getName(){return this.name}getManagedColumnNames(){return Object.keys(this.columns)}toBeUpdated(t){if(!e.is(t))return!1;return!e.is(t.MEIColumn)}getAdditionalColumnsUX(e){this.getManagedColumnNames().forEach((t=>{const i=e.findIndex((e=>e.dataIndex===t));e.splice(i,i>=0?1:0,this.columns[t])}))}updateAttributes(e,t){const{pids:i}=e;this.getDetails(i).then((e=>{const i=e,n=this.buildAnswer({refPids:i});t(n)}))}buildAnswer(e){const{refPids:t}=e,i={pids:{}};return Object.keys(t).forEach((e=>{i.pids[e]||(i.pids[e]={}),i.pids[e].MEIColumn=t[e]})),i}getDetails(e){let t=this;return new Promise((async i=>{i(await t.controller.getContextData(e))}))}getContentCallback(t){return e.extend({...t,typeRepresentation:"icon"},{getCellValue:function(e){let t=e.nodeModel.getAttributeValue("MEIColumn");if(t instanceof Object&&t.icon){var i=[];return t.icon.forEach((e=>{i.push(e)})),i}},getCellSemantics:function(){return{allowMultipleValuesFlag:!0}},getCellTooltip:function(e){if(!e||!e.nodeModel&&!e.cellModel)return;return{shortHelp:e.rowID<0?e.cellModel:e.nodeModel.getAttributeValue("MEIColumn")?e.nodeModel.getAttributeValue("MEIColumn").tooltip:""}},getCellValueForExport:function(e){if(!e||!e.nodeModel&&!e.cellModel)return;return e.rowID<0?e.cellModel:e.nodeModel.getAttributeValue("MEIColumn")?e.nodeModel.getAttributeValue("MEIColumn").tooltip:""},getCellGroupingKey:function(e){if(!e||!e.nodeModel&&!e.cellModel)return;return e.rowID<0?e.cellModel:e.nodeModel.getAttributeValue("MEIColumn")?e.nodeModel.getAttributeValue("MEIColumn").tooltip:""}})}}),Reflect.preventExtensions(l),l})),define("DS/SourcingFacetNavigation/views/EIView",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/Utilities/Dom","DS/ENOXLogger/Logger","DS/DataGridView/DataGridView","DS/CollectionView/ResponsiveTilesCollectionView","DS/ENOXCollectionToolBar/js/ENOXCollectionToolBarV2","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CoreEvents/ModelEvents","DS/SourcingCommonInfra/utils/PlatformServices","DS/SourcingFacetNavigation/controllers/EquivalentItemsController","i18n!DS/SourcingFacetNavigation/assets/nls/SourcingFacetNavigation","css!DS/SourcingFacetNavigation/SourcingFacetNavigation.css"],(function(e,t,i,n,a,o,l,r,s,d,c,u,p,m){"use strict";var f=t.extend({name:"mei-view",tagName:"div",domEvents:{},setup:function(e){let t=this;this.container.addClassName(this.getClassNames("-container")),this.i18NProvider=Object.freeze(m);let i={i18NProvider:this.i18NProvider};i.logger=a,u.getPlatformServices(i).then((async function(n){i.platformServices=n,!t.multiple&&t.loadData(e)})),this.controller=new p({app:i})},update:function(){let e=this.outerDiv.parentElement.parentElement?this.outerDiv.parentElement.parentElement.getBoundingClientRect():this.outerDiv.parentElement.getBoundingClientRect();this.outerDiv.style.height=e.height+"px"},exportDataToCSV:function(e,t){let i=this._dataGridView.getAsCSV(e),n=t;let a=new Blob(["\ufeff"+i],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),l=URL.createObjectURL(a);o.setAttribute("href",l),o.setAttribute("download",n),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)},render:function(t){let i=this;this.container.empty(),this._modelEvents=new c,this.multiple=t;let a=e.createElement("div",{class:"toolbar-container"}).inject(i.container),o={modelEvents:i._modelEvents,showItemCount:!0,filter:{},sort:[{id:"title",text:m.title,disabled:!0,type:"string"}],views:[{id:"Tile",text:m.tile,fonticon:"view-small-tile"},{id:"Table",text:m.table,fonticon:"view-list"}],currentView:["Tile"],actions:[{id:"exportToCSV",text:m.export_csv,disabled:!0,fonticon:"export-to-csv",handler:function(){let e=i.fileName;i.exportDataToCSV({forceQuotes:!0,allColumns:!0,addLevelInformation:!0},e)}}]};this.collectionToolbar=new r(o),this.collectionToolbar.inject(a),this.outerDiv=e.createElement("div",{class:"outerDiv",styles:{height:"100%"}}).inject(this.container);let l=e.createElement("div",{class:"emptyContainerStyle",html:t?m.select_only_one_item:m.data_unavailable_message});i.outerDiv.appendChild(l),i._modelEvents.subscribe({event:"enox-collection-toolbar-sort-activated"},(function(e){var t={sortAttribute:e.sortAttribute,sortOrder:e.sortOrder},n="asc"===t.sortOrder.toLowerCase()?1:-1;i._tilecollectionView&&i._tilecollectionView.TreedocModel._trueRoot.sortChildren({isRecursive:!0,sortFunction:function(e,i){try{return n*e._options.grid[t.sortAttribute].localeCompare(i._options.grid[t.sortAttribute])}catch(e){}}})}));let s="Tile";return i._modelEvents.subscribe({event:"enox-collection-toolbar-switch-view-activated"},(function(e){s=e,i.gridModel&&(i.outerDiv.innerHTML="",i.gridModel.prepareUpdate(),i.gridModel.ungroupRoots(),i.gridModel.pushUpdate(),"Table"===e?i._dataGridView.getContent().inject(i.outerDiv):"Tile"===e&&i._tilecollectionView.getContent().inject(i.outerDiv))})),i._modelEvents.subscribe({event:"enox-collection-toolbar-filter-search-value"},(function(e){i.handlefilterData(e.searchValue[0])})),i._modelEvents.subscribe({event:"enox-collection-toolbar-click-filter-search"},(function(e){"Tile"===s?e.elements.container.hasClassName("enox-collection-toolbar-filter-activated")?document.querySelector(".outerDiv .wux-layouts-responsivecollectionview")&&document.querySelector(".outerDiv .wux-layouts-responsivecollectionview").style.setProperty("top","45px","important"):document.querySelector(".outerDiv .wux-layouts-responsivecollectionview")&&document.querySelector(".outerDiv .wux-layouts-responsivecollectionview").style.setProperty("top","90px","important"):"Table"===s&&(e.elements.container.hasClassName("enox-collection-toolbar-filter-activated")?document.querySelector(".outerDiv .wux-layouts-datagridview")&&document.querySelector(".outerDiv .wux-layouts-datagridview").style.setProperty("top","45px","important"):document.querySelector(".outerDiv .wux-layouts-datagridview")&&document.querySelector(".outerDiv .wux-layouts-datagridview").style.setProperty("top","90px","important"))})),n.addResizeListener(this.outerDiv,(function(){i.update()}),0),this.container},getLabelForCell:function(e){var t="";let i=this.layout.getLeafColumns()[e.columnID];if(i)if("tree"===i.dataIndex)t=e.nodeModel._options.grid.statusTip[0];else{let n=i.dataIndex;t=(t=e.nodeModel.getAttributeValue(n))?t.label?t.label:t:""}return t},loadData:async function(e){let t=this;t.container&&t.container.parentElement&&i.mask(t.container.parentElement,m.loading_mei);let n=await t.controller.getMEIData(e),a=n.meiData;if(a&&a.length>0){let e=[{text:m.status,dataIndex:"tree",alignment:"center",width:150,typeRepresentation:"icon",getCellValue:function(e){return e.nodeModel.getAttributeValue("status")},getCellSemantics:function(){return{allowMultipleValuesFlag:!0}},getCellTooltip:function(e){return{shortHelp:e.nodeModel?e.nodeModel._options.grid.statusTip.map(String).join(", "):"",updateModel:!1}},getCellValueForExport:function(e){if(e.nodeModel&&e.nodeModel._options){if(e.nodeModel._options.identifier)return e.nodeModel._options.label;if(e.nodeModel._options.grid)return e.nodeModel._options.grid.statusTip.map(String).join(", ")}return e.cellModel}},{text:m.equivalent_items,dataIndex:"MEI",children:[{text:m.title,dataIndex:"title",typeRepresentation:"url",width:150,getCellValue:function(e){let t;if(e.nodeModel&&e.nodeModel._options.grid.title)return t={icon:{iconPath:e.nodeModel._options.thumbnail},label:e.nodeModel._options.grid.title},t},getCellValueForExport:function(e){return e.nodeModel?e.nodeModel._options.grid.title:e.cellModel}},...n.isMEI?[]:[{text:m.manufacturer_part_number,dataIndex:"partNumber",width:200}],{text:m.name,dataIndex:"prdName",width:200},{text:m.revision,dataIndex:"revision",width:100},...n.isMEI?[]:[{text:m.manufacturer,dataIndex:"manufacturer",width:125}],{text:m.description,dataIndex:"description",width:150},{text:m.maturity_state,dataIndex:"maturityDisplay",width:125}]},{text:m.equivalent_qualification,dataIndex:"equivalentQualificationDetails",children:[{text:m.title,dataIndex:"eqTitle",width:150},{text:m.name,dataIndex:"eqName",typeRepresentation:"url",width:150,getCellValue:function(e){let t;if(e.nodeModel&&e.nodeModel._options.grid.eqName)return t={icon:{iconPath:e.nodeModel._options.thumbnail_qual},label:e.nodeModel._options.grid.eqName},t},getCellValueForExport:function(e){return e.nodeModel?e.nodeModel._options.grid.eqName:e.cellModel}},{text:m.revision,dataIndex:"eqRevision",width:125},{text:m.qualification_status,dataIndex:"eqApproved",width:150},{text:m.maturity_state,dataIndex:"eqState",width:150},{text:m.effective_date_from,dataIndex:"eqEffectivityStartDate",width:150},{text:m.effective_date_to,dataIndex:"eqEffectivityEndDate",width:150}]},...n.isMEI?[]:[{text:m.general_qualification,dataIndex:"genQualificationDetails",children:[{text:m.title,dataIndex:"gqTitle",width:150},{text:m.name,dataIndex:"gqName",width:150,typeRepresentation:"url",getCellValue:function(e){let t;if(e.nodeModel&&e.nodeModel._options.grid.gqName)return t={icon:{iconPath:e.nodeModel._options.thumbnail_qual},label:e.nodeModel._options.grid.gqName},t},getCellValueForExport:function(e){return e.nodeModel?e.nodeModel._options.grid.gqName:e.cellModel}},{text:m.revision,dataIndex:"gqRevision",width:125},{text:m.qualification_status,dataIndex:"gqApproved",width:150},{text:m.maturity_state,dataIndex:"gqState",width:150},{text:m.last_time_buy,dataIndex:"gqLastTimeBuy",width:150},{text:m.effective_date_from,dataIndex:"gqEffectivityStartDate",width:150},{text:m.effective_date_to,dataIndex:"gqEffectivityEndDate",width:150}]}]];this.fileName=a[0].contextName,t.outerDiv.innerHTML="",this.collectionToolbar._modelEvents.publish({event:"enox-collection-toolbar-enable-action",data:"exportToCSV"}),this.gridModel=new s;let i={useDragAndDrop:!0,onDragStartCell:function(e,i){let n=t.fomatDnDData(i);return e.dataTransfer.setData("text/plain",JSON.stringify(n)),!1}};this._tilecollectionView=new l(i);let r={identifier:"MEI_QUAL_XEN",layoutOptions:{layoutDensity:"compact"},rowSelection:"none",defaultColumnDef:{getCellGroupingKey:t.getLabelForCell},rowGroupingOptions:{hideGroupedColumns:!1},columns:e,rowDragEnabledFlag:!0,onDragStartRowHeader:function(e,i){let n=t.fomatDnDData(i);return e.dataTransfer.setData("text/plain",JSON.stringify(n)),!1}};this._dataGridView=new o(r),this._dataGridView.treeDocument=this.gridModel,this._tilecollectionView.model=t.gridModel,this._tilecollectionView.onContextualEvent={callback:t.controller.onContextualEventCallback},t._dataGridView.onContextualEvent=t.controller.onContextualEventCallback,this._tilecollectionView.model=t.gridModel,this._tilecollectionView.inject(t.outerDiv),this.gridModel.prepareUpdate();for(const e of a)this.gridModel.addRoot(new d(e));this.gridModel.pushUpdate(),this._modelEvents.publish({event:"enox-collection-toolbar-items-count-update",data:a.length}),this._tilecollectionView.supportsSelection=function(){return!1},t.gridModel.prepareUpdate(),t.gridModel.ungroupRoots(),t.gridModel.pushUpdate()}t.update(),t.container&&t.container.parentElement&&i.unmask(t.container.parentElement)},handlefilterData:function(e){let t=this,i=t.gridModel.getRoots();t.gridModel.prepareUpdate(),i.forEach((i=>{t.hideShowRow(e,i)}));let n=t.gridModel.getNumberOfVisibleDescendants();t._modelEvents.publish({event:"enox-collection-toolbar-items-count-update",data:n}),t.gridModel.pushUpdate()},hideShowRow:function(e,t){if(e){var i=new RegExp(e,"i"),n=!1;(n=n||i.test(t.options.grid.title))?t.show():t.hide(!0)}else t.show()},onDestroy:function(){return this._parent.apply(this,arguments)},fomatDnDData:function(e){var t=e.nodeModel.options.grid,i=t.serviceId,n=[{envId:u._platformId,contextId:"",serviceId:i,objectId:t.id,objectType:t.type,displayName:e.nodeModel.options.label,displayType:t.type}];return{protocol:"3DXContent",version:"1.1",source:widget.data.appId,widgetId:widget.id,data:{items:n}}}});return f})),define("DS/SourcingFacetNavigation/facets/EquivalentItemsFacet",["UWA/Core","DS/UIKIT/Mask","DS/EditPropWidget/facets/Common/FacetsBase","DS/SourcingFacetNavigation/views/EIView"],((e,t,i,n)=>{"use strict";return class extends i{constructor(e){super(e),this.initView()}updateFacet(){this.contentDiv.empty(),t.mask(this.contentDiv);const e=this.retrieveSelection();new n(e[0].referenceId).render([...new Set(e.map((e=>e.referenceId)))].length>1).inject(this.contentDiv),t.unmask(this.contentDiv)}initView(){this.elements.container||(this.elements.container=e.createElement("div",{id:"templateFacet-mainContainer"}),this.contentDiv=e.createElement("div",{id:"templateFacet-content"}),this.elements.container.appendChild(this.contentDiv))}retrieveSelection(){const e=this.getModel();if(!e)return[];return(e.getMergingModels?Object.values(e.getMergingModels()):[e]).map((e=>{const t=e.get("metatype"),i="relationship"===t?e.get("selReferenceID"):e.get("objectId"),n="relationship"===t?e.get("objectId"):void 0;return"relationship"===t?{metatype:t,referenceId:i,instanceId:n}:{metatype:t,referenceId:i}}))}destroyComponent(){}onResize(){}onRefresh(){}onAction(){}}}));