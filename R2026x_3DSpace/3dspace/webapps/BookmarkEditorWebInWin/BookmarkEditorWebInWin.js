define("DS/BookmarkEditorWebInWin/BookmarkWebInWin",["DS/i3DXCompass/Data","DS/IPClassifyUtil/IPSettingsMgr","DS/IPClassifyUXUtil/service/IPClassifyUXUtilWebService","DS/IPClassifyUtil/IPClassifyUtility"],(function(e,t,o,n){var i=window.bookmark.params;console.log("Inside BookmarkWebInWin"),widget.setValue("noCompass",!0),widget.setValue("x3dAppId","ENOFOL3_AP"),t.setSetting("pad_security_ctx",i.securityContext);var s="boolean"==typeof i.standalone&&i.standalone;widget.setValue("standalone",s),widget.id=Math.round(1e3*Math.random()).toString(),widget.setValue("x3dSharedId",widget.id);let a="true"===i.IsReferenceExpandEnabled;widget.setValue("allow-products-expand",a),i.userId&&(window.dsUserLogin=i.userId);var d=i.tenantId||i.tenant;window.bookmark.params.tenant=d,(d=d||n.getTenantId())&&(widget.setValue("x3dPlatformId",d),t.setSetting("x3dPlatformId",d));let r=["folderTreeSelectedNode","FolderCusto_treelistview","vMigration","folderTreeStructure"],l="ENOFOL3AP_Preferences";function c(){let e=localStorage.getItem(l),t=JSON.parse(e);for(var o in t)widget.setValue(o,t[o]);widget.addEvent("onUpdateValue",(e=>{r.indexOf(e)>=0&&function(){let e={};r.forEach((t=>{let o=widget.getValue(t);e[t]=o})),localStorage.setItem(l,JSON.stringify(e))}()}))}return new Promise((async t=>{c();var n=!widget.body;widget.body=widget.body?widget.body:UWA.createElement("div"),widget.body.addClassName("FolderEditor"),widget.body.setStyles({height:"100%",width:"100%",position:"relative","text-align":"initial","z-index":0}),window.COMPASS_CONFIG=window.COMPASS_CONFIG?window.COMPASS_CONFIG:{myAppsBaseUrl:i.myAppsUrl,userId:i.userId,lang:i.lang},e.initialize({myAppsBaseUrl:i.myAppsUrl,userId:i.userId,passportUrl:"",proxyTicketUrl:""});let s=o.getConnectedUserInfo(),a=await s;widget.userId=a.userId||a.name,widget.fullName=a.firstname+" "+a.lastname,widget.userId&&(window.dsUserLogin=widget.userId);require(["DS/UWPClientCode/PublicAPI"],(e=>{e.user={login:widget.userId}})),document.body.getElement("#tempDiv").remove(),n&&widget.body.inject(document.body,"top"),window.performance.mark("createWidget_begin");var d=new FolderEditor({widget:widget,defaultSelectionPath:i.defaultSelectionPath,contextID:i.contextID,launchWithReadMode:i.launchWithReadMode,showDBCmd:i.showDBCmd,folderToOpen:i.folderToOpen,multiselection:!1!==i.multiselection,nativeAuthMode:i.switchtoAuthoringMode});1==window.Odt&&(window.swFolderEditor=d),widget.dispatchEvent("onResize"),t(d)}))})),window.dsDashboardWindow=window.dsDashboardWindow?window.dsDashboardWindow:{top:window};let prereqCEF="DS/WebInWinUtils/dscef",prereqList=["i18n!DS/BookmarkEditorWebInWin/assets/nls/BookmarkWebInWin"];window.dscef||prereqList.push(prereqCEF),define("DS/BookmarkEditorWebInWin/BookmarkEditorWebInWin",prereqList,(e=>{require(["DS/UWPClientCode/PublicAPI"]);var t=null;let o={},n=0,i={},s={refreshSession:function(){Object.keys(i).length>0&&require(["DS/IPClassifyUtil/IPClassifyCommunication"],(e=>{e.publish("refreshSession",{mapIds:i}),i={}}))},onObjectInSessionCheck:function(t){let n=t.objectsMatched,s=t.inSessionIds,a=t.commId,d=o[a],r=d.promiseResolve;d&&delete o[a],n&&(i={...i,...s},require(["DS/IPClassifyUtil/IPClassifyAlert"],(t=>{let o=UWA.createElement("a",{styles:{cursor:"pointer"},text:e.refresh,onmouseup:"window.refreshSession()"});t.displayNotification({...e.sessionRefreshNeeded,messageHtml:o})}))),r()},onModifiedObjectsCheck:function(t){let n=t.objectsMatched,i=t.inSessionIds,s=t.commId,a=o[s],d=a.promiseResolve;a&&delete o[s];require(["DS/IPClassifyUXUtil/IPConfirmationDialog","DS/IPClassifyUXUtil/IPClassifyLoaderGlobal"],((t,o)=>{if(n){o.removeComponentToLoad("global","checkInSession");let n=a.nlsInfo.title?a.nlsInfo.title:"";n&&(n+=" - ");let s=Object.keys(a.mapObjects).length;if(s>1)n+=e.replace(e.titleNbObject,{nb:s});else{n+=Object.values(i)[0]}t.confirmDialog({className:"updateConfirmation",immersiveFrame:widget.immersiveFrame,title:n,message:e.confirmUpdateMsg,details:e.confirmationMsg,type:"warning",rejectOnCancel:!0,buttonLabels:{Yes:a.nlsInfo.button?a.nlsInfo.button:e.continueUpdate,No:e.cancelUpdate}}).then((()=>{d({continue:!0})})).catch((e=>{e&&console.log(e),d({continue:!1})}))}else o.removeComponentToLoad("global","checkInSession"),d({continue:!0})}))},confirmModifiedInSession:async function(t,{title:i,button:s}){return new Promise((a=>{require(["DS/IPClassifyUtil/IPClassifyCommunication","DS/IPClassifyUXUtil/IPClassifyLoaderGlobal"],((d,r)=>{let l={isCancelled:!1,cancel:function(){this.isCancelled=!0,a({continue:!1})}};r.addComponentsToLoad("global",{checkInSession:e.checkInSession},{withCancel:!0,cancelObject:l}),n++,o[n]={promiseResolve:function(e){l.isCancelled||a(e)},mapObjects:t,nlsInfo:{title:i,button:s}},d.publish("checkModifyStatus",{mapIds:t,commId:n},!0)}))}))},warnRefreshIfNeeded:async function(e){return new Promise((t=>{require(["DS/IPClassifyUtil/IPClassifyCommunication"],(i=>{n++,o[n]={promiseResolve:function(e){t(e)},mapObjects:e},console.log("commId : "+n),i.publish("checkObjectsInSession",{mapIds:e,commId:n},!0)}))}))}};for(var a in window.availableMethods={...s,onReady:function(){require(["DS/BookmarkEditorWebInWin/BookmarkWebInWin","DS/IPClassifyUtil/IPClassifyCommunication","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/MessageBus/MessageBus"],(function(e,o){e.then((e=>{t=e,o.publish("bookmarkEditorReady","",!0),console.log("onReady")}))}))},jsFunction:function(e){if(console.log(e),window.bookmark="string"==typeof e?JSON.parse(e):e,!e.params.sessionManagement)for(let e in s)delete window[e];console.log("jsFunction"),onReady()},setCtxMenu:function(e,o,n){t&&t.setCtxMenu(e,o,n)},onClearSelection:function(){t&&t.onClearSelection()},SelectSearchObjs:function(e){t&&t.insertSelectedSearchObjs(e)},openBookmark:function(e,t){require(["DS/FolderEditor/views/FolderMode","DS/FolderEditor/Folder_CSO"],((o,n)=>{t&&o.switchtoAuthoringMode(!0);let i=n.getDefaultModelFromId(e);n.dispatchBookmarkNodeSelection(i)}))}},window.exportCmd={onWebInWinFilterChange:function(e){t&&t.onWebInWinFilterChange(e)},expandToBookmark:function(e){if(t&&e){var o="string"==typeof e?JSON.parse(e):e;t.expandToBookmarkExternally(o)}},setFilterOnContent:function(e){if(t){var o=null;o="object"==typeof e?e:o,require(["DS/IPClassifyUtil/IPClassifyModelEvents"],(e=>{e.publish({event:"applyExclusiveFilter",data:o})}))}}},exportCmd)window[a]=window.exportCmd[a];for(var a in availableMethods)window[a]=window.availableMethods[a];var d=function(){"undefined"!=typeof dscef&&(dscef.sendString('{"operation":"readyForInit"}'),dscef.sendString("isReadyForInit"))},r={onLoad:function(){(location.search.contains("test=true")||window.odt)&&require(["DS/BksStandalone/Standalone"],(e=>{e({launchWithReadMode:!0,showDBCmd:!1,standalone:!0,folderToOpen:"",multiselection:!0,sessionManagement:!0}).then((e=>{d(),jsFunction({params:e})}))})),d()}};require(["UWA/Widget"],(function(e){var t=window.widget=new e;t.body=UWA.createElement("div",{class:"bk_widgetBody"}),t.body.inject(document.body),t.addEventOnce("onLoad",r.onLoad.bind(this)),t.launch()}))})),require(["DS/BookmarkEditorWebInWin/BookmarkEditorWebInWin"]);