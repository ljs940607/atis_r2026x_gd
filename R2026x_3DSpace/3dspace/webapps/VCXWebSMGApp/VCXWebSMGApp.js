var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebSMGApp/VCXSmgDragDropManager",["require","exports","DS/VCXWebInteropSMG/VCXSmgLoader","DS/VCXWebComposer/VCXExperienceLoader","DS/VCXWebDragDrop/VCXDragDropServices","DS/VCXWebDragDrop/VCXDragDropManager"],(function(e,t,n,r,a,i){"use strict";a=__importDefault(a),i=__importDefault(i);class o extends i.default{_onDrop(e){this.dropCB(e)}async dropCB(e){var t=this._experienceBase,i=t.getManager("VCXContextManager");let o=a.default.GetRawDataFromDragEvent(e);if(this._CheckCurrentDraggableItem(e)){var s=o.files,l=!1;if(s){l=!0;for(let e=0;e<s.length;e++){let t=s[e];void 0!==t&&(t.type||(l=!1))}}if(s){if(s.length>0){var p=i.CheckInputFile(!1);if(!l&&!p.supported){var c={level:"warning",title:"Loading",subtitle:p.message,sticky:!0};return t.getManager("VCXNotificationManager").addNotification(c),void t.getManager("VCXGUIManager").getGettingStartedUI().dropZoneOFF()}}var g=null,u=null,d={};if(1===s.length&&"record"===t.odt){var C=s[0],h=t.getManager("VCXGUIManager").getGettingStartedUI();let e=await t.getManager("VCXAPIManager").OpenModel(C,(()=>{h.endLoadingExperience()}));if(e)return e}t.getManager("VCXGUIManager").RemoveDropZone();for(var M=0;M<s.length;M++){if(void 0!==(C=s[M])){var m=C.name;if(void 0!==m){var V=m.slice(m.lastIndexOf(".")+1);if(V=V.toLowerCase(),!(p=i.CheckInputExtension(V)).supported){t.getManager("VCXNotificationManager").addNotification({level:"warning",title:"Action not supported",message:p.message});continue}if("smg"===V||"smgs"===V)g=C;else{if("smggeom"!==V)return super.dropCB(e);d[C.name]=C,u=C}}}}var f=this.getProgressBar(),S=i.IsLocalMode();h=t.getManager("VCXGUIManager").getGettingStartedUI();if(g){var _=i.getIfStanAlonePlayerIsInDevMode();if((S||_)&&t&&t.webApplication){var X=t.webApplication;X.app.supportWebApplicationBase?(X.app._experienceBase._parentBase&&await X.RequestCloseExperienceBase(),t=await X.RequestNewExperienceBase()):t=await X.requestNewExperienceBaseAsync(),h.startLoadingExperience(),"record"===t.odt&&t.getManager("VCXODTManager").SetModelSMG(g);var P=new n;P._progressBar=f,P.Load(t,i.getMainViewer(),g,(()=>{h.endLoadingExperience()}))}}else{if(!u)return f.off(),this.dropCB(e);"record"===t.odt&&t.getManager("VCXODTManager").SetModelForZip(u);var x=new r;await x.Load({experienceBase:t,mapAssets:d,jsonFile:""}),f.off(),h&&h.endLoadingExperience()}}}}}return o})),define("DS/VCXWebSMGApp/VCXSmgExperience",["DS/VCXWebComposer/VCXExperience","DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCmdGoToScenario","DS/VCXWebKernelCommands/VCXCmdChangeComponent","DS/VCXWebKernelCommands/VCXCmdChangeSequence","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebKernelCommands/VCXCmdChangePropertiesAutokey","DS/VCXWebIO/VCXLogServices"],(function(e,t,n,r,a,i,o,s,l,p){"use strict";var c=e.extend({OnEndLoading:async function(e,r){console.log("VCXSmgExperience::OnEndLoading begin");var c=e;if(0===this._experienceBase.ComponentsMap.GetComponentFromType("CXPCameraActor_Spec").length){var g=this._experienceBase.Factory.BuildComponent("CXPCameraActor_Spec");g.SetID("CameraActorId"),this._experienceBase.ComponentsMap.AddComponent(g)}else c=!1;if(0===this._experienceBase.ComponentsMap.GetComponentFromType("VCXViewport_Spec").length){var u=this._experienceBase.Factory.BuildComponent("VCXViewport_Spec");u.SetID("ViewportActorId"),this._experienceBase.ComponentsMap.AddComponent(u)}if(0===this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentGround").length){var d=this._experienceBase.Factory.BuildComponent("VCXComponentGround");d.SetID("GroundActorId"),this._experienceBase.ComponentsMap.AddComponent(d)}if(e&&r)for(var C in r)if(r.hasOwnProperty(C)){var h=r[C];if("products"===C)for(var M=0;M<h.length;M++){var m=h[M],V=m.QueryInterface("W3AISGNodeHolder"),f=V.getSGNode(),S=V.getPathElement(),_=m.QueryInterface("VCXIModelNavigable");this._experienceBase.BuildComponentsFromNodeEXT(f,S,_,{attributeToUse:"productType",componentTypeForRootNode:"VCXComponentOccurrenceComposer",Instance3D:"VCXComponentOccurrenceComposer",InstanceRep:"VCXComponentMesh",defaultType:null}),t.publish({event:"VCX_ADD_ASSET",data:m})}}c&&(this._experienceBase.getManager("VCXGUIManager").InitGUI(),await this._experienceBase.getManager("VCXExperience").InitImagePanels()),this._experienceBase.getManager("VCXGUIManager").RefreshGUI(),this._experienceBase.getManager("VCXPaperManager").updatePaper({propagateEvent:!0}),this.EndLoadingDressups(),this.EndLoadingViewpoints();var X=!1,P="",x=this._experienceBase.getManager("VCXScenarioManager").QueryInterface("VCXIModifiable");return UWA.Promise.resolve().then(function(){if(c){var e=this._experienceBase.Factory.BuildComponent("VCXScenarioSequence");e.SetName("Sequence 1");var t=new a(this._experienceBase);t.PushSequence(e),this._experienceBase.getManager("VCXCommandManager").Do(t);return this.CreateNewScenario(!0).then((e=>P=e.GetID()))}if(p.memoryLog("RestoreNeutralProperties",!0),this._experienceBase.getManager("VCXScenarioManager").RestoreNeutralProperties(),p.memoryLog("RestoreNeutralProperties",!1),P=x.GetProperty("ScenarioManager.startScenarioId").GetPropertyValue().GetValue())X=!0;else{var n=this._experienceBase.getManager("VCXSequenceManager"),r=n.GetListSequences();if(P=r[0].GetListScenariosId()[0],1===this.GetViewMode()){var i=n.GetListSequencesFromType(0);if(i.length>1){var o=i[1];"Views"!==o.GetName()&&console.warn("Unexpected sequence tag"),o.GetListScenariosId().length&&(P=o.GetListScenariosId()[0])}}}return P}.bind(this)).then(function(e){if(!X){var r=new s(e),a=new i(new o("ScenarioManager.startScenarioId",2),r),c=new l(this._experienceBase,!0);c.ChangeProperty(x,a),this._experienceBase.getManager("VCXCommandManager").Do(c)}p.memoryLog("GoToScenario",!0);var g=new n(this._experienceBase);g.GoToScenario(e),this._experienceBase.getManager("VCXCommandManager").Do(g),p.memoryLog("GoToScenario",!1),p.memoryLog("VCXGUIManager setUpTrees",!0),this._experienceBase.getManager("VCXGUIManager").setUpTrees(),p.memoryLog("VCXGUIManager setUpTrees",!1);var u=!0===this._experienceBase.getManager("VCXContextManager").getContextFromName("ExperienceInConnectedPlayer"),d=this._experienceBase.getManager("VCXContextManager").getContextFromName("PlayerMode");if(u){var C=this;setTimeout((function(){C._experienceBase.getManager("VCXAPIManager").HasAnimation("AnimationSmgID")&&C._experienceBase.getManager("VCXAPIManager").PlayAnimation("AnimationSmgID")}),2e3)}else d||this._experienceBase.getManager("VCXScenarioManager").SetAutoKey(!0);console.log("VCXSmgExperience::OnEndLoading end"),console.log(" VCXStatNb3DNodes = "+this._statNb3DNodes),setTimeout((function(){document.querySelector("div.wux-windows-immersive-frame").dispatchEvent(new Event("resize"))}),500),t.publish({event:"VCX_END_LOADING_DONE"})}.bind(this))},addApplicationManagers:function(){var e=this._experienceBase.getManager("VCXContextManager").getContextFromName("PlayerMode"),t=this._experienceBase.getManager("VCXContextManager").getContextFromName("ProdHighMode"),n=this._experienceBase.getManager("VCXContextManager").getContextFromName("ExperienceIn3DPlay"),a=this._experienceBase.getManager("VCXContextManager").getContextFromName("ExperienceInConnectedPlayer"),i=[];(this._addManager("VCXNotificationManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXGUIManager",1,this._experienceBase._ManagerSet,i,6),this._experienceBase.getManager("VCXContextManager").isSupported("GUIArchitectureV2")?this._addManager("VCXGUIManager1",1,this._experienceBase._ManagerSet,i,6):this._addManager("VCXGUIManager0",1,this._experienceBase._ManagerSet,i,6),this._addManager("VCXSelectionManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXSelectManager",2,this._experienceBase._ManagerSet,i),this._addManager("VCXMultiUserInputManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXMaterialManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXPaperManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXDressupManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXImageManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXHyperlinkManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXStylesManager",1,this._experienceBase._ManagerSet,i),this._experienceBase.getManager("VCXContextManager").isSupported("VCXIV")&&this._addManager("VCXIVManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXPlayManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXVisuManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXContextualContentManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXAPIManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXMarkerManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXDRMManager",1,this._ManagerSet,i),this._addManager("VCXPulseManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXManipulatorManager",1,this._experienceBase._ManagerSet,i),e||t)&&(this._addManager("VCXSectionManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCX3DGridManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXRobotAdapter",1,this._experienceBase._ManagerSet,i),this._addManager("VCXComponentBomManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXVolatileGhostingManager",1,this._experienceBase._ManagerSet,i).setKeepGhostCommand(!0),this._experienceBase.getManager("VCXContextManager").isSupported("VCXQueryEngine")&&this._addManager("VCXQueryEngine",1,this._experienceBase._ManagerSet,i),this._addManager("VCXHotspotManager",1,this._experienceBase._ManagerSet,i),this._addManager("VCXSelectionSetManager",1,this._experienceBase._ManagerSet,i),this._experienceBase.getManager("VCXContextManager").setSupported("PartZoom"));this._addManager("VCXUserInputControllerManager",1,this._experienceBase._ManagerSet,i),!a&&n&&this._addManager("VCXComposerAPIManager",1,this._experienceBase._ManagerSet,i),t&&(this._addManager("VCXCanonicsManager",1,this._experienceBase._ManagerSet,i),(void 0!==this._experienceBase.getManager("VCXContextManager").getUrlVars().debug||this._experienceBase.odt)&&(this._experienceBase.getManager("VCXContextManager").setSupported("Section"),this._experienceBase.getManager("VCXContextManager").setSupported("Paths")));var o=new r(this._experienceBase);return o.AddComponents(i),this._experienceBase.getManager("VCXCommandManager").Do(o),i}});return Object.defineProperty(c.prototype,"componentType",{enumerable:!0,get:function(){return"VCXExperience"}}),c})),define("DS/VCXWebSMGApp/VCXMaterialManagerSMG",["DS/VCXWebVisualization/VCXMaterialManager","DS/VCXWebSystem/VCXEnums","DS/Visualization/ThreeJS_DS"],(function(e,t,n){"use strict";var r=e.extend({initialize:function(){this._parent(),this._texSteelSpecular=null,this._texSteelGlossiness=null,this._texMetalbrushedNormal=null},unInitialize:function(){this._parent(),this._releaseTexture(this._texSteelSpecular),this._releaseTexture(this._texSteelGlossiness),this._releaseTexture(this._texMetalbrushedNormal)},postInitialize:function(){this._parent(),this._texSteelSpecular=this.loadMaterialFromPath("VCXWebSMGApp","texture/VCX_steel_s.jpg"),this._texSteelGlossiness=this.loadMaterialFromPath("VCXWebSMGApp","texture/VCX_steel_g.jpg"),this._texMetalbrushedNormal=this.loadMaterialFromPath("VCXWebSMGApp","texture/VCX_metalbrushed_n.jpg")},getSharedMaterial:function(e){var r=e._envID+"|"+e._textureDocID,a=this._materialsCustom.get(r);if(!a){switch(a=this._parent(e),e._envID){case t.EnvironmentalId.Chromic:a.color=t.Color.White,a.opacity=1,a.metalness=.3,a.metalnessMap=this._texMetalbrushedNormal,a.transparent=!1,a.name="Chromic";break;case t.EnvironmentalId.Metal:a.color=t.Color.White,a.opacity=1,a.metalnessMap=this._texSteelGlossiness,a.transparent=!1,a.roughness=.1,a.metalness=.2,a.specularContrib=.3,a.name="Metal";break;case t.EnvironmentalId.MetalBrushed:a.color=t.Color.White,a.opacity=1,a.metalnessMap=this._texSteelGlossiness,a.transparent=!1,a.roughness=.5,a.metalness=.2,a.specularContrib=.3,a.name="MetalBrushed";break;case t.EnvironmentalId.Plastic:a.color=t.Color.Black,a.opacity=1,a.transparent=!1,a.roughness=.1,a.metalness=.1,a.specularContrib=.3,a.name="Plastic";break;case t.EnvironmentalId.Glass:a.color=t.Color.Black,a.opacity=.5,a.transparent=!0,a.roughness=.1,a.metalness=.8,a.specularContrib=.3,a.name="Glass";break;case t.EnvironmentalId.GlassPlastic:a.color=t.Color.Black,a.opacity=.3,a.transparent=!0,a.roughness=.1,a.metalness=.4,a.specularContrib=.3,a.name="GlassPlastic";break;case t.EnvironmentalId.ChromicWithColor:a.color=t.Color.White,a.opacity=1,a.emissive=t.Color.Black,a.metalness=.8,a.glossiness=.9,a.specularMap=this._texSteelSpecular,a.transparent=!1,a.name="ChromicWithColor";break;case t.EnvironmentalId.Unknown:break;case t.EnvironmentalId.Gold:a.color=t.Color.Gold,a.opacity=1,a.emissive=t.Color.Black,a.specular=t.Color.Black,a.metalness=.5,a.normalMap=this._texMetalbrushedNormal,a.transparent=!1,a.name="Gold";break;case t.EnvironmentalId.Aluminium:a.color=t.Color.White,a.opacity=1,a.metalness=.2,a.metalnessMap=this._texSteelSpecular,a.transparent=!1,a.roughness=.5,a.metalness=.2,a.specularContrib=.1,a.name="Aluminium";break;case t.EnvironmentalId.Satin:(a=new n.PhysicalMaterial({color:240,specular:657930,glossiness:.05,sheen:.25,sheenMode:n.SheenMode.SATIN})).color=t.Color.Satin,a.opacity=1,a.emissive=t.Color.Black,a.name="Satin"}this._materialsCustom.set(r,a)}return a},isTextureVisible:function(e){var n=this._parent(e);switch(e){case t.EnvironmentalId.Metal:case t.EnvironmentalId.MetalBrushed:case t.EnvironmentalId.Plastic:case t.EnvironmentalId.GlassPlastic:case t.EnvironmentalId.ChromicWithColor:n=!0}return n}});return Object.defineProperty(r.prototype,"componentType",{enumerable:!0,get:function(){return"VCXMaterialManager"}}),r})),define("DS/VCXWebSMGApp/VCXComposerAPIManager",["UWA/Core","DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCmdChangeTimePos","DS/VCXWebKernel/VCXAPIManager","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebVisu/VCXModifiablesAccess"],(function(e,t,n,r,a,i){"use strict";var o=r.extend({initialize:function(){this._parent(),this._APIMngr=this._experienceBase.getManager("VCXAPIManager"),this._versionInfo=null,this._ApiCBEndSce=null,this._WUXEventTokens={};var e=this;this._WUXEventTokens.VCX_END_TRANSITION=t.subscribe({event:"VCX_END_TRANSITION"},(function(t){e._ApiCBEndSce&&t._name&&t._ID&&e._ApiCBEndSce(t._name,t._ID)}))},unInitialize:function(){for(var e in this._parent(),this._APIMngr=null,this._ApiCBEndSce=null,this._WUXEventTokens)this._WUXEventTokens.hasOwnProperty(e)&&this._WUXEventTokens[e]&&(t.unsubscribe(this._WUXEventTokens[e]),this._WUXEventTokens[e]=null)},GoToScenario:function(e,t){this._APIMngr.GoToScenario(e,t)},PlayAnimation:function(e){if(null==e&&(e="AnimationSmgID",this.GetAnimationTime()>=this.GetAnimationDuration(e))){var t=new n(this._experienceBase);t.ChangeTimePos(0,!1),this._experienceBase.getManager("VCXCommandManager").Push(t)}this._APIMngr.PlayAnimation(e)},HasAnimation:function(e){return null==e&&(e="AnimationSmgID"),this._APIMngr.HasAnimation(e)},PauseAnimation:function(){return this._APIMngr.PauseAnimation()},StopAnimation:function(){return this._APIMngr.StopAnimation()},GetAnimationTime:function(){return this._APIMngr.GetAnimationTime()},GetAnimationDuration:function(e){return null==e&&(e="AnimationSmgID"),this._APIMngr.GetAnimationDuration(e)},GoToView:function(e,t){this._APIMngr.GoToScenario(e,t)},GoToMarker:function(e,t){this._APIMngr.GoToMarker(e,t)},ActivateSelectionSet:function(e){this._APIMngr.ActivateSelectionSet(e)},DeactivateSelectionSet:function(e){this._APIMngr.DeactivateSelectionSet(e)},SelectHotspot:function(e){this._experienceBase.ComponentsMap.GetComponentFromID(e)&&(this._experienceBase.getManager("VCXHotspotManager").DeactivateAllHotspots(),this._experienceBase.getManager("VCXHotspotManager").DeactivateAllHotspots(!0),this._APIMngr.SelectHotspot(e))},DeselectHotspot:function(e){this._APIMngr.DeselectHotspot(e)},RegisterAddSelectionCB:function(e){this._APIMngr.RegisterAddSelectionCB(e)},RegisterRemoveSelectionCB:function(e){this._APIMngr.RegisterRemoveSelectionCB(e)},RegisterMarkerSequenceCB:function(e){this._APIMngr.RegisterMarkerSequenceCB(e)},RegisterEndScenarioCB:function(e){this._ApiCBEndSce=e},RegisterDoubleClickCB:function(e){this._experienceBase.getManager("VCXUserInputControllerManager").RegisterDoubleClickCB(e)},GetAllHotspots:function(){return this._APIMngr.GetAllHotspots()},ChangeAntialiasing:function(e){const t={NoAA:0,SMAA:1,FXAA:3,FSAA:4,SSAA:6,TAA:8};let n=this._experienceBase.getManager("VCXContextManager"),r=this._experienceBase.getManager("VCXContextManager").getActiveViewport();if(r&&n){let i=r.QueryInterface("VCXIModifiable");i&&i.OnChangeProperty("Environment.AA",new a(t[e])),n.applyToViewers((function(t){t.setAntiAliasing(e)})),n.renderAll()}else console.error("Change Antialiasing API Failed")},GetAntialiasingMode:function(){let e=null,t=this._experienceBase.getManager("VCXContextManager");return t?(t.applyToViewers((function(t){e=t.antiAliasing})),e):(console.error("Get Antialiasing API Failed"),"Something went wrong")},GetSelectedObjects:function(){return this._APIMngr.GetSelectedObjects()},ChangeProperties:function(e){this._APIMngr.ChangeProperties(e)},GetProperties:function(e,t){var n=this._APIMngr.GetProperties(e,t),r=n[e];for(var a in r)if(r.hasOwnProperty(a)){var o=r[a]?r[a].name:"",s=r[a]?r[a].value:null;if("Actor.ToolTip"===o||"Collab.Text"===o){var l=i.ValuateLinkedProperties(s,this._experienceBase,e,e,null);n[e][a].value=l}}return n},ActivateTooltipDisplayOnPartHover:function(){this._APIMngr.ActivateTooltipDisplayOnPartHover()},DeactivateTooltipDisplayOnPartHover:function(){this._APIMngr.DeactivateTooltipDisplayOnPartHover()},SetPreventPartsFromBeingSelectable:function(e){this._APIMngr.SetPreventPartsFromBeingSelectable(e)},GetPreventPartsFromBeingSelectable:function(){return this._APIMngr.GetPreventPartsFromBeingSelectable()},SetPreventCollaborativeActorsFromBeingSelectable:function(e){this._APIMngr.SetPreventCollaborativeActorsFromBeingSelectable(e)},GetPreventCollaborativeActorsFromBeingSelectable:function(){return this._APIMngr.GetPreventCollaborativeActorsFromBeingSelectable()},SetKeepLinkSelectable:function(e){this._APIMngr.SetKeepLinkSelectable(e)},GetKeepLinkSelectable:function(){return this._APIMngr.GetKeepLinkSelectable()},TrapSelectionMode:function(e){this._APIMngr.TrapSelectionMode(e)},SetKeepHotspotsSelectable:function(e){this._APIMngr.SetKeepHotspotsSelectable(e)},GetKeepHotspotsSelectable:function(){return this._APIMngr.GetKeepHotspotsSelectable()},SetKeepAssemblySelectionModeActive:function(e){this._APIMngr.SetKeepAssemblySelectionModeActive(e)},GetKeepAssemblySelectionModeActive:function(){return this._APIMngr.GetKeepAssemblySelectionModeActive()},GetAllActors:function(e){return this._APIMngr.GetAllActors(e)},SelectActors:function(e){return this._APIMngr.SelectActors(e)},ZoomFitAll:function(e){return this._APIMngr.ZoomFitAll(e)},GetViewport:function(){return this._APIMngr.GetViewport()},SetVisibility:function(e,t){return this._APIMngr.SetVisibility(e,t)},GetVisibility:function(e,t){return this._APIMngr.GetVisibility(e)},SetReferenceAxisSystemVisisbility:function(e){return this._APIMngr.SetReferenceAxisSystemVisisbility(e)},StartRotation:function(e){var t,n,r=null,a=null,i=null,o=null;return 1==e.length?(r=e.pop(),"No Error"==(n=this.ErrorCheck(r,a,i,o))?1==this.AxisCheck(r)?t=this._APIMngr.AxisRotation(1,r,1,2,1):2==this.AxisCheck(r)&&(t=this._APIMngr.PlaneRotation(1,r,1,2,1)):t=n):2==e.length?(a=1*e.pop(),r=e.pop(),"No Error"==(n=this.ErrorCheck(r,a,i,o))?1==this.AxisCheck(r)?-1!=a&&1!=a||(t=this._APIMngr.AxisRotation(1,r,a,2,1)):2==this.AxisCheck(r)&&(-1!=a&&1!=a||(t=this._APIMngr.PlaneRotation(1,r,a,2,1))):t=n):3==e.length?(i=1*e.pop(),a=1*e.pop(),r=e.pop(),"No Error"==(n=this.ErrorCheck(r,a,i,o))?1==this.AxisCheck(r)?(-1==a||1==a)&&i>0&&(t=this._APIMngr.AxisRotation(1,r,a,i,1)):2==this.AxisCheck(r)&&(-1==a||1==a)&&i>0&&(t=this._APIMngr.PlaneRotation(1,r,a,i,1)):t=n):4==e.length&&(o=1*e.pop(),i=1*e.pop(),a=1*e.pop(),r=e.pop(),"No Error"==(n=this.ErrorCheck(r,a,i,o))?1==this.AxisCheck(r)?0!=o&&1!=o||!(i>0)||-1!=a&&1!=a||(t=this._APIMngr.AxisRotation(1,r,a,i,o)):2==this.AxisCheck(r)&&(0!=o&&1!=o||!(i>0)||-1!=a&&1!=a||(t=this._APIMngr.PlaneRotation(1,r,a,i,o))):t=n),t},StopRotation:function(){return this._APIMngr.StopRotation()},AxisCheck:function(e){return"x"==e||"-x"==e||"y"==e||"-y"==e||"z"==e||"-z"==e||"X"==e||"-X"==e||"Y"==e||"-Y"==e||"Z"==e||"-Z"==e?1:"h"==e||"H"==e||"V"==e||"v"==e?2:0},ErrorCheck:function(e,t,n,r){return null!=e&&0==this.AxisCheck(e)?"Please Enter Valid Rotation Axis/Plane":null!=t&&-1!=t&&1!=t?"Please Enter Valid Rotation Direction":null!=n&&n<=0?"Please Enter Valid time multiplier":null!=r&&0!=r&&1!=r?"Please Enter Valid Loop Flag":"No Error"},FetchInformation:function(e){if(this._experienceBase.getManager("VCXContextManager").getIfStanAlonePlayerIsInDevMode()){var t=e.lastIndexOf("/"),n=e.slice(0,t);t=n.lastIndexOf("/"),t=(n=n.slice(0,t)).lastIndexOf("/");var r=(n=n.slice(0,t))+"/ComposerWebPlayer/version.json",a=new XMLHttpRequest;a.open("GET",r);var i=this;a.onreadystatechange=function(){if(4===a.readyState&&(200===a.status||0===a.status)){var e=a.responseText,t=/{.*{(.*)}.*{(.*)}.(.*)}/,n=t.exec(e),r=n[1],o=/.*"(.*)",.*"(.*)"/.exec(r),s=n[3],l=(t=/([A-Z]{2}).*"(.*)"/).exec(s);i._versionInfo=o[1]+" "+l[1]+" "+l[2],i._buildInfo=o[2]}},a.send()}},AddInformation:function(e,t){if(this._experienceBase.getManager("VCXContextManager").getIfStanAlonePlayerIsInDevMode()){this.AddFileOpenOptions(e,t);var n=e.getElementById("DivLogo"),r=e.getElementById("buildVersion");if(this._versionInfo&&this._buildInfo&&!r){var a=e.createElement("div");a.id="divBuildVersion";var i=this._versionInfo.slice(this._versionInfo.indexOf(".")+1,this._versionInfo.lastIndexOf(".")),o=this._versionInfo.slice(this._versionInfo.lastIndexOf(".")+1),s=i.slice(0,i.indexOf(".")),l=o.slice(o.lastIndexOf(" ")+1),p=o.slice(0,o.indexOf(" "));this._mapVerNumbers&&this._mapVerNumbers.has(s)&&(s=this._mapVerNumbers.get(s));var c=e.createElement("text");c.id="buildVersion";var g="Version: "+s+" FD"+l+" ("+p+")";c.innerHTML=g,a.appendChild(c);var u=e.createElement("br");a.appendChild(u);var d=this._buildInfo.slice(0,this._buildInfo.indexOf(".")),C=this._buildInfo.slice(this._buildInfo.indexOf(".")+1),h=e.createElement("text");h.id="builddate";var M="  Build: "+d+" ("+C+")";h.innerHTML=M,a.appendChild(h),n?n.insertBefore(a,n.childNodes[0]):window.alert(g+"\n"+M)}}},AddFileOpenOptions:function(e,t){var n=e.getElementById("SelectSMG"),r=e.getElementById("BrowseSMG");if(n&&!r){var a=e.createElement("br");n.appendChild(a);var i=e.createElement("a");i.id="BrowseSMG",i.href="#",i.text="Browse SMG file on disk",n.appendChild(i);var o=this;i.onclick=function(){o.OpenFileBrowser(t)}}},OpenFileBrowser:function(e){var t=document.createElement("input");t.type="file",t.id="fileBrowserId",t.click(),console.log("Load smg file"),t.addEventListener("change",(function(t){var n=this.files,r=n.length?n[0]:null;if(r&&r instanceof Blob){r.name;var a=new window.FileReader;a.onloadend=function(){var t=a.result,n=new Blob([t],{type:r.type}),i=window.URL.createObjectURL(n),o={experience:{filename:"DS/VCXWebAuthoringApp/VCXWebPlayerExperience"}};o.asset={filename:i,mimetype:"smg",type:"smg",format:"smg",provider:"FILE"},e.loadAsset(o)},a.readAsArrayBuffer(r)}}))}});return Object.defineProperty(o.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComposerAPIManager"}}),Object.defineProperty(o.prototype,"preventCollaborativeActorsFromBeingSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").excludeDressups},set:function(e){this._experienceBase.getManager("VCXSelectionManager").excludeDressups=e}}),Object.defineProperty(o.prototype,"preventPartsFromBeingSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").excludeParts},set:function(e){this._experienceBase.getManager("VCXSelectionManager").excludeParts=e}}),Object.defineProperty(o.prototype,"keepLinkSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable=e}}),Object.defineProperty(o.prototype,"keepHotspotSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable=e}}),o})),define("DS/VCXWebSMGApp/VCXComponentBomManager",["UWA/Class","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebKernelCommands/VCXCmdChangePropertiesAutokey","DS/VCXWebVisibility/VCXIVisibility","DS/VCXWebModifiables/VCXModelChangeListener"],(function(e,t,n,r,a,i,o,s){"use strict";var l=e.extend({init:function(){},postInitialize:function(){this._experienceBase.getManager("VCXContextManager").loadCssFile("VCXWebSMGApp/VCXWebSMGApp.css",1)},unInitialize:function(){this._experienceBase.getManager("VCXContextManager").unloadCssFile("VCXWebSMGApp/VCXWebSMGApp.css",1)},postUpdate:function(e){this.filterHasChanged=!1},GetColumn:function(e){var t=this.QueryInterface("VCXIModifiable");if(t){var n=t.GetProperty("ColumnTreeList.ColumnList").GetPropertyValue();if(e>=n._value.length)return;return n.GetValueAtIndex(e)}},GetColumnName:function(e){var t=this.GetColumn(e);return void 0===t?void 0:t.GetValueAtIndex(0)},GetColumnWidth:function(e){var t=this.GetColumn(e);return void 0===t?void 0:t.GetValueAtIndex(1)},GetColumnCommonRoot:function(e){var t=this.GetColumn(e);return void 0===t?void 0:t.GetValueAtIndex(2)},GetColumnLabel:function(e){var t=this.GetColumn(e);return void 0===t?void 0:t.GetValueAtIndex(3)},GetPropertyValueAt:function(e,t){var n=this.GetColumn(e);return void 0===n?void 0:n.GetValueAtIndex(t)},GetPropertyValueIdentifierAt:function(e,t){var n=void 0;switch(t){case 0:n="ColumnTree.Name";break;case 1:n="ColumnTree.Width";break;case 2:n="ColumnTree.CommonRoot";break;case 3:n="ColumnTree.Label"}return n},GetColumnNumber:function(){var e=this.QueryInterface("VCXIModifiable");return e?e.GetProperty("ColumnTreeList.ColumnList").GetPropertyValue()._value.length:0},SetSortOption:function(e){var o=this.QueryInterface("VCXIModifiable");if(o){var s=new r;s.SetValue(e.propertyName);var l=new t(new n("BOM.Sort.PropertyName",0),s),p=new i(this._experienceBase,!0);p.ChangeProperty(o,l),this._experienceBase.getManager("VCXCommandManager").Push(p),(s=new a).SetValue(e.ascendant),l=new t(new n("BOM.Sort.Ascendant",0),s),(p=new i(this._experienceBase,!0)).ChangeProperty(o,l),this._experienceBase.getManager("VCXCommandManager").Push(p)}},GetSortOption:function(){var e=this.QueryInterface("VCXIModifiable");if(e){var t=e.GetProperty("BOM.Sort.Ascendant"),n=t.GetPropertyValue().Value;return{propertyName:(t=e.GetProperty("BOM.Sort.PropertyName")).GetPropertyValue().Value,ascendant:n}}return 0},GetColumnPropertyValuesNumber:function(){return 4},GetBOMId:function(e){for(var t=this.GetBOMContent(!1),n=e.GetObject().QueryInterface("W3AISGNodeHolder").getPathElement().getLastElement(),r=1;;r++){if(!t[r])return r;if(t[r].element===n)return r}},GetBOMContent:function(e){for(var t=!1,n=[],r=this._experienceBase.getManager("VCXDressupManager").getDressupsFromGroup("Callouts"),a=0;a<r.length;a++){var i=r[a];if(i){var s=i.QueryInterface("VCXIVisibility");if(s&&s.GetVisibility()!==o.EVisState.Hidden){var l=i.QueryInterface("VCXIModifiable");if(l)for(var p=l.GetAttachedOccurences(),c=0;c<p.length;c++){if(d=p[c])if(C=d.QueryInterface("VCXIModifiable"))(h=C.GetProperty("Actor.BomId"))&&(M=h.GetPropertyValue().Value)&&(t=!0,n[M]||(n[M]={},n[M].calloutComponents=[],n[M].itemComponents=[]),n[M].calloutComponents.push(i),n[M].itemComponents.indexOf(d)<0&&n[M].itemComponents.push(d),n[M].element=d.QueryInterface("W3AISGNodeHolder").getPathElement().getLastElement())}}}}t||(e=!1);for(var g=this._experienceBase.ComponentsMap.GetComponentFromType("VCXWebComponentOccurrence"),u=0;u<g.length;u++){var d;if(d=g[u]){let t=d.QueryInterface("VCXIVisibility");var C,h,M;if(t&&t.GetVisibility()!==o.EVisState.Hidden)if(C=d.QueryInterface("VCXIModifiable"))if(h=C.GetProperty("Actor.BomId"))(M=h.GetPropertyValue().Value)&&(e||n[M]||(n[M]={},n[M].itemComponents=[]),n[M]&&n[M].itemComponents.indexOf(d)<0&&(n[M].itemComponents.push(d),n[M].element=d.QueryInterface("W3AISGNodeHolder").getPathElement().getLastElement()))}}return n}});return Object.defineProperty(l.prototype,"filterHasChanged",{enumerable:!0,get:function(){return this._filterHasChanged},set:function(e){this._filterHasChanged=e}}),Object.defineProperty(l.prototype,"ListHasChanged",{enumerable:!0,get:function(){var e=!1,t=this._experienceBase.getManager("VCXModelChangeListener");return t&&(e|=t.hasChanged(s.FChangeFlag.BomID),e|=t.hasChanged(s.FChangeFlag.DressupVisibility),e|=t.hasChanged(s.FChangeFlag.Visibility)),e|=this.filterHasChanged}}),Object.defineProperty(l.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentBomManager"}}),l}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebSMGApp/VCXSMGLoadHelper",["require","exports","DS/VCXWebComposer/VCXExperienceLoader","DS/VCXWebInteropSMG/VCXSmgXmlLoader","DS/VCXWebInteropSMG/VCXSmgLoader","DS/Controls/Loader"],(function(e,t,n,r,a,i){"use strict";i=__importDefault(i);return class{static async openFile(e,t){for(var o="",s="",l="",p="",c=null,g={},u=t.target,d=0;d<u.files.length;d++){var C=u.files[d];if(void 0!==C){var h=C.name;if(void 0!==h){var M=h.slice(h.lastIndexOf(".")+1);"json"===(M=M.toLowerCase())||"ctps"===M?o=C:"3dxml"===M?(s=window.URL.createObjectURL(C),g[C.name]=s):"smgxml"===M?l=C:"smg"===M||"smgs"===M?p=C:"smggeom"===M&&(g[C.name]=C,c=C)}}}var m=document.getElementsByClassName("wux-windows-docking-element-free-zone wux-docking-element-bottom")[0],V=new i.default({text:"Preparing...",showButtonFlag:!1});if(V.inject(m),V.getContent().setStyles({opacity:"1",position:"absolute",bottom:"calc(50% - 100px)",left:"calc(50% - 50px)"}),V.on("Opening"),e&&e.webApplication){var f,S=e.webApplication;if(S.app.supportWebApplicationBase?(S.app._experienceBase._parentBase&&await S.RequestCloseExperienceBase(),e=await S.RequestNewExperienceBase()):e=await S.requestNewExperienceBaseAsync(),0!==Object.keys(g).length)f=n;else if(l)f=r;else{if(!p)throw new Error("Not supported file");f=a}var _=e.getManager("VCXGUIManager").getGettingStartedUI();_.startLoadingExperience(),window.WUX.setFullscreen();var X=e.getManager("VCXContextManager").getMainViewer();if(0!==Object.keys(g).length){"record"===e.odt&&(""!==s?e.getManager("VCXODTManager").SetModelForZip(s):c&&e.getManager("VCXODTManager").SetModelForZip(c));var P=new f;await P.Load({experienceBase:e,mapAssets:g,jsonFile:o}),V.off("Opening"),_.endLoadingExperience()}else if(l){(new f).Load(e,X,l,!0,undefined)}else if(p){var x=new f;x._progressBar=V,"record"===e.odt&&e.getManager("VCXODTManager").SetModelForZip(p),x.Load(e,X,p,(function(){V.off("Opening"),_.endLoadingExperience()}))}else V.off("Opening"),_.endLoadingExperience()}}}})),define("DS/VCXWebSMGApp/VCXBomManagerModifiable",["DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueMap"],(function(e,t,n,r,a,i,o,s){"use strict";return e.extend({init:function(e){this._Properties=[]},BuildProp:function(e,r,a){var i=new n(e,1),o=new r;o.Value=a,this._Properties[e]=new t(i,o),this.SetProperty(e,o)},BuildColumn:function(e,t,n,r){var a=new s,l=new o;return l.SetValue(e),a.SetValueAtIndex(0,l),(l=new i).SetValue(t),a.SetValueAtIndex(1,l),(l=new i).SetValue(n),a.SetValueAtIndex(2,l),(l=new o).SetValue(r),a.SetValueAtIndex(3,l),a},Build:function(){this._parent(),this.BuildProp("BOM.Filter",i,0),this.BuildProp("BOM.Sort.Ascendant",a,!0),this.BuildProp("BOM.Sort.PropertyName",o,"Bom.Description");var e=new s;e.SetValueAtIndex(0,this.BuildColumn("Bom.Description",100,0,"")),e.SetValueAtIndex(1,this.BuildColumn("Actor.BomId",50,0,"")),e.SetValueAtIndex(2,this.BuildColumn("Bom.Quantity",40,0,""));var r=new n("ColumnTreeList.ColumnList",1);this._Properties["ColumnTreeList.ColumnList"]=new t(r,e),this.SetProperty("ColumnTreeList.ColumnList",e)},SetProperty:function(e,r){var a=new n(e,0);this._Properties[e]=new t(a,r.Clone())},OnChangeProperty:function(e,t,n){if(n||(n={}),n.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;this.SetProperty(e,t)},OnChangePropertiesEnd:function(){this.GetObject().update&&this.GetObject().update()},GetProperty:function(e){var n=null;return void 0!==this._Properties[e]&&(n=new t(this._Properties[e].GetPropertyInfo(),this._Properties[e].GetPropertyValue().Clone())),n},GetProperties:function(e){var t=new r;for(var n in this._Properties)this._Properties.hasOwnProperty(n)&&t.AddOrModifyProperty(this.GetProperty(n));return t}})})),define("DS/VCXWebSMGApp/VCXPlayComposerManagerModifiable",["UWA/Core","DS/VCXWebPlayBase/VCXPlayManagerModifiable","DS/VCXWebProperties/VCXPropertyValueBoolean"],(function(e,t,n){"use strict";return t.extend({Build:function(){this._parent();let e=[this.BuildProperty("VCXPlayManager.showActionBar",n,!0),this.BuildProperty("VCXPlayManager.showScenePanel",n,!0),this.BuildProperty("VCXPlayManager.showPropertiesPanel",n,!0),this.BuildProperty("VCXPlayManager.showAssemblyPanel",n,!0),this.BuildProperty("VCXPlayManager.showDressupPanel",n,!0),this.BuildProperty("VCXPlayManager.showSelection",n,!0),this.BuildProperty("VCXPlayManager.showPreHighlight",n,!0),this.BuildProperty("VCXPlayManager.showPreHighlightOnlyInteractiveActor",n,!1),this.BuildProperty("VCXPlayManager.showCanvas",n,!1),this.BuildProperty("VCXPlayManager.showBlackBorderPreview",n,!1),this.BuildProperty("VCXPlayManager.showRobot",n,!0),this.BuildProperty("VCXPlayManager.showAuthoringTooltip",n,!0)];this.BuildProperties(e)}})})),define("DS/VCXWebSMGApp/VCXSMG3DPlayDictionary",[],(function(){"use strict";var e={VCXPlayManager:{VCXIModifiable:"DS/VCXWebSMGApp/VCXPlayComposerManagerModifiable"},VCXComposerAPIManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"}},t={W3AIManager:"DS/WebApplicationBase/W3AIManager"},n={VCXComposerAPIManager:"DS/VCXWebSMGApp/VCXComposerAPIManager"};return{GetDictionary:function(){return{interfaces:t,components:n,extensions:e}}}}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebSMGApp/VCXOpenCmd",["require","exports","DS/VCXWebProducts/VCXAFRCmdBase","UWA/Core","DS/VCXWebSMGApp/VCXSMGLoadHelper"],(function(e,t,n,r,a){"use strict";n=__importDefault(n),a=__importDefault(a);class i extends n.default{constructor(e){super(e,{odtCmd:!0,isAsynchronous:!0})}async beginExecute(){var e=this.getFrameWindow().getUIFrame();if(null===document.getElementById("VCXOpenFileHiddenButton")){var t=(0,r.createElement)("input",{name:"Open",id:"VCXOpenFileHiddenButton",styles:{position:"absolute",left:"-99999px"},type:"file",multiple:"multiple",accept:".json,.3dxml,.smgxml,.smg,.smggeom"}).inject(e);document.getElementById("VCXOpenFileHiddenButton")?.addEventListener("change",(e=>{a.default.openFile(this._experienceBase,e),t.destroy(),this.end()}),!1)}var n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null);var i=document.getElementById("VCXOpenFileHiddenButton");!i?.dispatchEvent(n)&&console.log("VCXOpenFileHiddenButton : A handler called preventDefault")}}return i}));