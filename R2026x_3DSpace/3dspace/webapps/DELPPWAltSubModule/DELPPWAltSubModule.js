define("DS/DELPPWAltSubModule/ReplaceByAlternateDialog",["UWA/Core"],(function(e){"use strict";return function(t,n,i){const l=0,o=1,r=2;let a;const c=function(){let e=!1,t=!1,n=!1;if(i=a.value,Array.isArray(i)&&i.length>0){switch(a.value[0]){case l:e=!1,t=!1,n=!1;break;case o:e=!0,t=!0,n=!1;break;case r:e=!0,t=!1,n=!0}}var i;return{isReplaceAll:e,restrictToUnderSameParent:t,replaceAllInstances:n}},s=function(s){let u=e.createElement("div",{class:"replaceByAlternateOptions-container",styles:{padding:"10px 5px"}});a=function(t){const a=(e=!1)=>n.create("Toggle",{type:"radio",label:i.getNLSValue("AltSub.ReplaceDialog.ReplaceSelected"),value:l,checkFlag:e}),c=(e=!1)=>n.create("Toggle",{type:"radio",label:i.getNLSValue("AltSub.ReplaceDialog.RestrictToSameParent"),value:o,checkFlag:e}),s=(...e)=>{let t=n.create("ButtonGroup",{type:"radio"});for(const n of e)t.addChild(n);return t},u=(t=>e.is(t)&&"instance"===t.type)(t)||(t=>!e.is(t))(t)?s(a(!0),c(),((e=!1)=>n.create("Toggle",{type:"radio",label:i.getNLSValue("AltSub.ReplaceDialog.ReplaceAllInstances"),value:r,checkFlag:e}))()):s(a(!0),c());return u}(t),a.inject(u);let g=e.createElement("div",{class:"replaceByAlternateOptions-content-container"});u.inject(g);!function(t,l){let o=n.create("Dialog",{title:i.getNLSValue("AltSub.ReplaceDialog.Title"),domId:"replaceByAlternateOptionsDialog",identifier:"replaceByAlternateOptionsDialog",content:t,minHeight:150,minWidth:400,modalFlag:!0,resizableFlag:!0,buttons:{Cancel:n.create("Button",{onClick:function(){o.close()}}),Ok:n.create("Button",{emphasize:"primary",onClick:function(){if(e.is(l,"function")){const e=c();l(e)}o.close()}})}});o.close=function(){this.destroy()}}(g,s)};return{show:function(e){s(e)}}}})),define("DS/DELPPWAltSubModule/AltSubViewUI",["UWA/Core","DS/Utilities/Dom"],(function(e,t){"use strict";return function(n,i,l,o,r,a,c,s){var u,g,d,f,m,p=o.getComponent("WUXDockAreaEnum"),S=o.getComponent("WUXFrameWindowsManager").getFrameWindow(n.getAppContext()).getImmersiveFrame();return u=function(t){var r=n.getElement(),c=o.createElement("div",{class:"tree-list-container"}),s=e.is(a)?a.getIconURLFromKey(t):"";f=a.getNLSValue("View.AlternatesAndSubstitutes.Title"),(m=e.createElement("div")).className="context-product-title",m.setAttribute("id","context-product-title"),m.setStyles({left:"10px",position:"relative",width:"fit-content"}),c.inject(r),i.loadDocument(l.getWUXNodeModel()),i.getContent().inject(c),(g=o.create("Panel",{header:m,position:{at:"right"},minWidth:300,minHeight:250,height:250,title:a.getNLSValue("View.AlternatesAndSubstitutes.Title"),icon:s,side:p.RightDockArea,currentDockArea:p.RightDockArea,identifier:"panel-"+d,content:r,resizableFlag:!0,closeButtonFlag:!0,useBordersFlag:!0,visibleFlag:!1,collapsibleFlag:!0,verticallyStretchableFlag:!1})).close=function(){e.is(d)?n.notify("toggleCmdCheckHeaderState",{cmdName:d,cmdState:!1}):g.hide()}},{init:function(t,i){e.is(t,"string")?(d=t,u(i)):n.debug("AltSubViewUI","Command name is not defined to create UI.")},destroy:function(){l.emptyNodeModel(),e.is(g)&&(g.destroy(),g=void 0)},toggle:function(t){var n;t.state&&!g.visibleFlag?(g.immersiveFrame=S,n=S.getDockingElement(g.currentDockArea),e.is(n)&&(n.collapseDockingZoneFlag=!1),g.show()):g.hide()},updateTitle:function(t){var n=e.is(t,"string")?t:null;e.is(n)&&""!==n?g.title=f+" - "+n:g.title=f},setContextProductTitle:function(n,i){var l,o=e.createElement("div"),r=e.createElement("div"),a=e.is(i,"string")?i:null;o.className="title-base",o.setStyles({display:"flex","align-items":"center",height:"22px"}),r.className="title-text",r.setStyles({"padding-left":"10px"}),e.is(a)&&((l=t.generateIcon({iconPath:a,iconSize:{width:"22px",height:"22px"}})).className="title-icon",l.inject(o)),r.setContent(n),r.inject(o),m.setContent(o)},launchMfgItemCreateNewCmd:function(t,i,l){var o,r,u,g,d=e.is(t)&&e.is(t.arguments)?t.arguments:null,f=e.is(t)&&e.is(t.commandTitleNLSKey,"string")?t.commandTitleNLSKey:null,m=e.is(t)&&e.is(t.cmdSuccessNLSKey,"string")?t.cmdSuccessNLSKey:null,p=e.is(t)&&e.is(t.cmdFailureNLSKey,"string")?t.cmdFailureNLSKey:null,S=e.is(t)&&e.is(t.ebomPID,"string")?t.ebomPID:null,y=e.is(t)&&e.is(t.token)?t.token:null,b=e.is(t)&&e.is(t.logToken)?t.logToken:null,h=!0,A={isCreateRoot:!0,fatherReferenceID:null,linkType:null,type:null,ebomReferenceID:S,dialogBoxTitle:null,callbacks:{onSuccess:null,onFailure:null,onCancel:null},backendInfo:{url:c.get3DSpaceUrl().slice(0,-1),tenant:c.getTenant(),securityContext:c.getSecurityContext(),headers:c.getHeaders({isAuthoringCtx:!0})},oneDelmiaAggregationMode:n.getPreferenceValue("oneDelmiaAggregationMode"),isXRev:n.getPreferenceValue("isXRevisionActivated"),preferences:[n.getPreferenceValue("MASS"),n.getPreferenceValue("VOLUME"),n.getPreferenceValue("AREA"),n.getPreferenceValue("LENGTH"),e.is(t)&&e.is(t.configurationPID)?t.configurationPID:""],copyModelProductToItemUponSL:n.getPreferenceValue("copyModelProductToItemUponSL")};e.is(d,"array")&&d.forEach((function(t){if(e.is(t)&&e.is(t.ID,"string")&&e.is(t.Value,"string"))switch(t.ID){case"ReferenceType":A.type=e.is(t.Value,"string")?t.Value.split("/")[1]:null,A.dialogBoxTitle=a.getNLSValue(f,{type:a.getNLSValue(A.type)});break;case"LinkType":A.linkType=t.Value.toUpperCase()}})),A.callbacks.onSuccess=function(t){var n,o,r={createdObject:null,toObject:null,iNewLinkType:(n=A.linkType,o=n.charAt(0).toUpperCase()+n.slice(1).toLowerCase(),"Resultingproduct"===o&&(o="ResultingProduct"),o),token:y,logToken:b,cmdSuccessNLSKey:m},a={onComplete:function(e){r.createdObject=e,r.toObject=c.getReference(S),i(r)},onFailure:function(){l("AltSub.FailToFetchNewReference")},forceDBMode:!0};e.is(t)&&e.is(t.result,"array")&&t.result.length>0&&(t.result[0].identifier,"string")&&t.result[0].identifier.length>0&&(h=!1,c.fetchRoot(t.result[0].identifier,a))},A.callbacks.onFailure=function(e){var t={key:"AltSub.FailToCreateNewReference",result:e,token:y,logToken:b,toObject:c.getReference(S),cmdFailureNLSKey:p};h&&l(t)},A.callbacks.onCancel=A.callbacks.onFailure,o="selectedEBOMrefId",r=e.is(S,"array")&&S.length>0?S[0]:S,u=null,g="Unkwown",e.is(r,"string")&&r.length>0?(u=c.getReference(c.getReferenceId(r)),e.is(u)&&(g=u.get("type")),n.debug(o+": "+r+", reference type: "+g)):n.debug("No "+o+" object ID"),new s(A).execute()},launchMfgItemCreateCmd:function(t,n,i){var l,o,c,s,u,g,d,f=t.arguments,m={},p=function(){e.is(l)&&(l.isVisible()&&l.destroyUI(),l=void 0)};p(),Array.isArray(f)&&(f.forEach((function(t){e.is(t)&&e.is(t.ID,"string")&&e.is(t.Value,"string")&&("ReferenceType"===t.ID?o=t.Value:"LinkType"===t.ID&&(c=t.Value))})),e.is(o)&&e.is(c)&&(g=o.split("/"),d=null,2===g.length&&(d=g[1]),s=d,m.cmdId="CreateMfgItemAndScope",m.onOKCallBack=function(e){var t=a.getNLSValue(m.cmdTitle,{type:a.getNLSValue(s||"",null,"Type")});i(e,c,t),p()},m.onCancelCallback=function(){p()},m.newObjType=o,m.isInstancePossible=null,m.cmdTitle=n(c),m.implementingSection=!1,m.implementedSection=!0,m.optionsSection=!1,m.checkForImplementingScope=!1,m.modalFlag=!0,m.multiSelectionOfImplementing=!1,m.multiSelectionOfImplemented=!1,l=r.createImplementUI(m),!0===(u=l.getSelectionsWithPaths()).bUpdateImplemented&&(l.updateImplemented(u.selNodes),l.showDCFormForCreate(!0))))}}}})),define("DS/DELPPWAltSubModule/AltSubModule",["UWA/Core","DS/DELPPWAltSubModule/AltSubViewUI","DS/DELPPWAltSubModule/ReplaceByAlternateDialog","DS/DELPPWInsertCmdPLMNewModule/InsertPLMNewCommand"],(function(e,t,n,i){"use strict";var l=function(){var t=null;return{of:function(e){return t=e,this},combineWith:function(n){return e.extend(t,n,true),this},get:function(){return t}}};return{behaviors:["TreeListViewBehavior","WUXNodeModelBehavior","AssignProductBehavior","UXFactoryBehavior","MfgItemUXBehavor","ModelBehavior","SelectionBehavior","ResourceBehavior","AltSubBehavior","AppPreferencesBehavior"],creator:function(o,r,a,c,s,u,g,d,f,m,p){var S,y,b,h,A,I,L,C,N,T,v,R,M,P,D,k={STATUS:"AltSub_status",ENG_RELATION:"AltSub_engRelation",CONTEXT:"AltSub_context"},V="AltSub_mfgItem",U="AltSub_mfgRev",O="AltSub_relType",F="AltSub_org",w=m.getLinkTypeEnum(),E=!1,x=null,B=null;return b=function(e){return e.isReference()?e.get("PLMEntity.V_Name"):e.get("PLMInstance.PLM_ExternalID")},h=function(e){var t="";return e.isReference()&&(t=e.get("revision")),t},A=function(e){var t="";return t=b(e),e.isReference()&&(t+=" "+h(e)),t},I=function(t){var n=t||{},i=e.is(n.status)?n.status:null,l=e.is(n.referenceModel)?n.referenceModel:null,o=e.is(n.instanceModel)?n.instanceModel:null,r="",a=null;e.is(i,"string")?"loading"===i?r=f.getNLSValue("loading"):"noSelection"===i&&(r=f.getNLSValue("AltSub.NoSelection")):e.is(l)||e.is(o)?(e.is(l)&&(r+=A(l),a=f.getIconURLFromKey(l.get("type"))),e.is(o)&&(r+=" ( "+A(o)+" )")):r=f.getNLSValue("AltSub.NoContextProduct"),y.setContextProductTitle(r,a)},L=function(){var t,n,i,l,r=d.getSelectionsWithPaths();E||(B=null,a.emptyNodeModel(),I({status:"loading"}),Array.isArray(r)&&r.length>1&&1===r[1].length?(l=r[1][0],e.is(l)?(t=g.getReferenceModel(l.id),x=t.get("PID"),y.updateTitle(g.getDisplayName(t)),i=l.path,n=l.path.length>0?l.id:null,m.getEnggAlternatesAndMfgs(t.get("PID"),n,i,(function(t){var l,r,c,s=t.mfgReferenceId;e.is(x)&&s===x&&(l=t.results,r=t.contextLinkNavigated,I({referenceModel:t.contextProductModel.reference,instanceModel:t.contextProductModel.instance}),Array.isArray(l)&&l.length>0&&(c=0===i.length,a.prepareUpdate(),l.forEach((function(e){T(e,r,c)})),a.pushUpdate()),B=n,o.notify("AltSubViewLoaded"))}))):o.debug("No selection in mbom to load AlternateAndSubstitutes view data.")):(x=null,y.updateTitle(""),I({status:"noSelection"})))},C=function(t,n,i,l,o,r){return{label:A(t),grid:{[k.STATUS]:n,[k.ENG_RELATION]:i,[k.CONTEXT]:e.is(o)?A(o):""},restrictLinkCreation:r,substitute:(t=>{let n=null;return e.is(t)&&(n={type:t.isInstance()?"instance":"reference",context:t.get("PID")}),n})(o),engRelType:l}},N=function(t,n,i,l){return e.is(t)?{isContextMfgRoot:l,mfgReferenceId:t.get("PID"),mfgRelType:i,grid:{[V]:b(t),[U]:h(t),[O]:n,[F]:t.get("organization"),cellInfo:{IconUrl:f.getIconURLFromKey(t.get("type"))}}}:{isContextMfgRoot:l,grid:{[V]:"",cellInfo:{IconUrl:null}}}},T=function(t,n,i){var o,c,s,u,g,d,f=t.eng,m=t.mfg,p=new l;c=f.referenceModel,s=m.referenceModel,d=f.isContextProduct?n:null,u=C(c,f.status,f.engRelTypeNLS,f.engRelType,f.substituteContextModel,d),g=e.is(s)?N(s,m.mfgRelTypeNLS,m.mfgRelType,i):N(null),o=p.of(r.getReferenceNodeOptions(c)).combineWith(u).combineWith(g).get(),a.addNodeModel(o)},v=function(e){var t,n=e.options,i=n.grid;return t=Object.keys(k).reduce((function(e,t){var n=k[t];return e[n]=i[n],e}),{}),{label:n.label,grid:t,restrictLinkCreation:n.restrictLinkCreation,substitute:n.substitute,engRelType:n.engRelType}},R=function(t,n,i){var o,c,s,u,g=a.getSelectedNodes();1===g.length&&(o=g[0],s=N(t,f.getNLSValue("AltSub.Link."+i),i),e.is(o.options.mfgReferenceId)?(c=v(o),u=(new l).of(r.getReferenceNodeOptions(n)).combineWith(c).combineWith(s).get(),a.addNodeModel(u)):o.updateOptions(s))},M=function(t){var n=f.getNLSValue("AltSub.CreatingMfgItem"),i=d.getSelectionsWithPaths(o.getId()),l=null,r=null,a=function(e){R(e.createdObject,e.toObject,e.iNewLinkType),o.info(f.getNLSValue(e.cmdSuccessNLSKey,{processName:A(e.createdObject),productName:A(e.toObject)}),e.logToken),o.notify("stopProgress",e),o.notify("referenceCreated",{referencePID:e.createdObject.id}),S.removeModalLoader(n),E=!1},s=function(t){var i,l=e.is(t)&&e.is(t.result)?t.result:null;e.is(l)&&e.is(l.result,"array")&&e.is(l.result.length>0)&&e.is(l.result[0].errors)&&e.is(l.result[0].errors[0].length>0)&&e.is(l.result[0].errors[0].errorMessages,"array")?(i=l.result[0].errors[0].errorMessages[0],o.log(i,t.logToken)):o.log(f.getNLSValue(t.cmdFailureNLSKey,{productName:A(t.toObject)}),t.logToken),o.notify("stopProgress",t),S.removeModalLoader(n),E=!1},u=function(e){return e===w.RESULTING_PRODUCT?"ImplementUI.CreateImplementingAndResultingProduct":"ImplementUI.CreateImplementingAndScope"},g=!!(e.is(t)&&e.is(t.isOldCreateCmd,"boolean")&&t.isOldCreateCmd);e.is(t.arguments,"array")&&t.arguments.forEach((function(n,i){e.is(n)&&e.is(n.ID,"string")&&e.is(n.Value,"string")&&"LinkType"===n.ID&&("Resultingproduct"===(r=n.Value.charAt(0).toUpperCase()+n.Value.slice(1).toLowerCase())&&(r="ResultingProduct"),t.arguments[i].Value=r)})),e.is(i,"array")&&i.length>0&&e.is(i[0],"array")&&i[0].length>0&&e.is(i[0][0].id,"string")&&i[0][0].id.length>0&&(l=i[0][0].id),g?y.launchMfgItemCreateCmd(t,u,(function(e,t,i){var l=e.securityContextOverride,o=e.implementedIDs,r=e.newObjAttributes;E=!0,S.displayModalLoader(n,(function(){var e=function(e){var i;1===e.length&&(i=e[0],R(i.createdObject,i.toObject,t)),S.removeModalLoader(n),E=!1},a=function(){S.removeModalLoader(n),E=!1};t===w.SCOPE?c.createMfgItemAndScopeLink(o,r,i,{onComplete:e,onFailure:a,securityContextOverride:l}):t===w.RESULTING_PRODUCT&&c.createMfgItemAndResultingProductLink(o,r,i,{onComplete:e,onFailure:a,securityContextOverride:l})}))})):(E=!0,t.logToken=o.log(f.getNLSValue("AltSub.CreatingMfgItem")),t.commandTitleNLSKey=u(r),t.cmdSuccessNLSKey=r===w.RESULTING_PRODUCT?"createMfgItemAndResultingProductLink.Success":"CreateMfgItemAndScope.Success",t.cmdFailureNLSKey=function(e){return e===w.RESULTING_PRODUCT?"createMfgItemAndResultingProductLink.Failure":"CreateMfgItemAndScope.Failure"}(r),t.ebomPID=l,t.configurationPID=p.getConfigurationPID(),o.notify("startProgress",t),S.displayModalLoader(n,(function(){y.launchMfgItemCreateNewCmd(t,a,s)})))},P=function(){var t,n=a.getSelectedNodes();1===n.length&&(t=n[0].options.mfgReferenceId,e.is(t)&&o.notify("referenceAdded",[g.getReference(t),null,{withLinksResolved:!0}]))},D=function(){const t=B;if(e.is(t)){const i=a.getSelectedNodes();if(1===i.length){const l=i[0],r=l.options.mfgReferenceId,a=l.options.substitute;if(e.is(r)){new n(a,s,f).show((function(e){o.notify("doReplaceByMfgAlternate",[t,r,e,a])}))}}}},{listenTo:function(){return{select:L,CreateMfgItemAndLinkAltSubst:M,AddMfgItemToMBOMAltSub:P,ReplaceByAlternate:D}},onStart:function(e){var n,l,c=e||{};n=c.relatedCmdId,l=c.moduleIcon,(y=new t(o,r,a,s,u,f,g,i)).init(n,l),S=r.getDataGridView(),y.toggle({state:!0}),L()},onStop:function(){E=!1,e.is(y)&&(y.destroy(),y=void 0),x=null}}}}}));