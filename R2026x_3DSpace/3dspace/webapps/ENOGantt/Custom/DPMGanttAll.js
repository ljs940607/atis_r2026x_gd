define("DS/ENOGantt/Custom/DPMGanttAll",["UWA/Class","DS/ENOGantt/Ven/Ext","DS/ENOGantt/Ven/Bryntum","DS/ENOGantt/Data/ResponseUtil","DS/ENOGantt/GanttUtil","DS/ENOGantt/URLStore","DS/ENOGantt/GanttConstants"],(function(e,t,a,n,i,r,l){return e.extend({init:function(){var e='<h5 class="sch-task-tip-header">{Name}</h5><table><tr><td>'+App.Nls["emxProgramCentral.Common.StartDate"]+':</td> <td align="left">{[this.getStartDateString(values)]}</td></tr><tr><td>'+App.Nls["emxProgramCentral.Common.EndDate"]+':</td> <td align="left">{[this.getEndDateString(values)]}</td></tr><tr><td>'+App.Nls["emxProgramCentral.Gantt.Tooltip.Progress"]+':</td> <td align="left">{[this.getPercentDoneString(values)]}%</td></tr><tr><td>'+App.Nls["emxProgramCentral.Gantt.Calendar"]+':</td> <td align="left">{[this.getTaskCalendarName(values)]}</td></tr>';App.Infra.ViewId!=App.Infra.Views.VIEW_STATUS_REPORT&&(e=e+'<tr><td valign="top">'+App.Nls["emxProgramCentral.Common.Assignee"]+':</td><td width="100px" align="left">{[values.Assignee]}</td></tr>'),e+="</table>",t.define("DS.ENOGantt.DPMGanttAll.feature.TaskResize",{override:"Gnt.feature.TaskResize",mode:"startendduration",onMouseMove:function(e,n){var i,r=this.ganttView,l=this.taskRec,o=this.taskEl,s=r.rtl,d=this.isStart,p=s&&!d||!s&&d,c=r.getSnapPixelAmount(),u=(o.getWidth(),{target:o,record:l,isStart:d,isWest:p,handles:p?"w":"e",minHeight:1,minWidth:c=Math.max(1,c),widthIncrement:c,listeners:{resizedrag:this.partialResize,resize:this.afterResize,scope:this}});l instanceof a.model.TaskSegment&&(i=this.taskEl.next(".sch-gantt-task-segment"))&&(u.maxWidth=s?i.getRight()-o.getRight():i.getLeft()-o.getLeft()),u.constrainRegion=o.up(r.getItemSelector()).getRegion(),o.addCls("sch-gantt-resizing"),this.ganttView.fireEvent("taskresizestart",this.ganttView,this.taskRec);var g=o.down(".sch-gantt-progress-bar",!0);g&&t.fly(g).setWidth(100*t.fly(g).getWidth()/o.getWidth()+"%"),this.resizable=t.create("Ext.resizer.Resizer",u),this.resizable.resizeTracker.onMouseDown(this.mouseDownEvent,this.resizable[p?"west":"east"].dom),this.resizable.resizeTracker.onMouseMove(e,this.resizable[this.handlePos].dom),this.useTooltip&&(this.tip?this.tip.enable():this.tip=t.create(t.apply({xclass:"Gnt.Tooltip",mode:this.mode,gantt:this.ganttView,constrainTo:this.ganttView.up("grid").el,cls:"gnt-resize-tip"},this.tooltipConfig)),this.tip.updateContent(l.getStartDate(),l.getEndDate(),!0,l),this.tip.showBy(o,e.getX()),t.getBody().on("mouseup",(function(){this.tip.disable()}),this,{single:!0}))}}),t.define("DS.ENOGantt.DPMGanttAll.Gnt.Tooltip",{override:"Gnt.Tooltip",mode:"startendduration",initComponent:function(){var e=this;"startendduration"==e.mode?(e.initialDefaultAlign=e.defaultAlign,e.rtl=e.gantt.rtl,e.startLabel=e.L("startText"),e.durationLabel=e.L("durationText"),e.endLabel=e.L("endText"),e.template||(e.template=new t.Template('<div class="sch-timetipwrap x-fa {cls}"><table cellpadding="0" cellspacing="0"><tpl if="value1"><tr><td class="sch-gantt-tip-desc">{label1}</td><td class="sch-gantt-tip-value">{value1}</td></tr></tpl><tr><td class="sch-gantt-tip-desc">{label2}</td><td class="sch-gantt-tip-value">{value2}</td></tr><tr><td class="sch-gantt-tip-desc">{label3}</td><td class="sch-gantt-tip-value">{value3}</td></tr></table></div>').compile()),e.callParent(arguments),e.update(e.template.apply({value1:"",value2:"",value3:""})),e.addCls("gnt-tooltip"),e.avoidPointer&&e.on({scope:e,mouseover:{element:"el",fn:e.onTipElementMouseOver}})):e.callParent(arguments)},updateContent:function(e,t,a,n){var i,r=this;i="startendduration"===r.mode?r.getStartEndDurationContent(e,t,a,n):"duration"===r.mode?r.getDurationContent(e,t,a,n):r.getStartEndContent(e,t,a,n),r.update(i)},getStartEndDurationContent:function(e,a,n,i){var r,l=this.gantt,o=this,s=e&&l.getFormattedDate(e);r=e?a-e>0?l.getFormattedEndDate(a,e):s:l.getFormattedEndDate(a);var d=i.getDurationUnit(),p=i.calculateDuration(e,a,d);if(this.cls&&"gnt-dragdrop-tip"==this.cls&&(p=i.data.Duration),"ProjectTemplateView"==App.Infra.ViewId)var c={cls:n?"sch-tip-ok fa-check":"sch-tip-notok fa-ban",label3:o.durationLabel,value3:parseFloat(t.Number.toFixed(p,this.durationDecimalPrecision))+" "+Sch.util.Date.getReadableNameOfUnit(d,p>1),task:i};else{c={cls:n?"sch-tip-ok fa-check":"sch-tip-notok fa-ban",label2:o.endLabel,value2:r,task:i};e&&(c.label1=o.startLabel,c.value1=e&&l.getFormattedDate(e)),p&&(c.label3=o.durationLabel,c.value3=parseFloat(t.Number.toFixed(p,this.durationDecimalPrecision))+" "+Sch.util.Date.getReadableNameOfUnit(d,p>1))}return this.template.apply(c)}}),t.define("DS.ENOGantt.DPMGanttAll.TooltipTamplate",{extend:"Gnt.template.TaskTooltip",disableFormats:!0,dateFormat:null,markup:['<tpl if="records">','<tpl for="records">','<tpl if="xindex &lt;= _maxItemsInTooltip_">',"_bodyTpl_","</tpl>","</tpl>",'<tpl if="records.length &gt; _maxItemsInTooltip_">','<div class="sch-task-tip-extra">',"{[this.getOverflowText(values)]}","</div>","</tpl>","<tpl else>","_bodyTpl_","</tpl>"].join(""),bodyMarkup:[e].join(""),constructor:function(e,t){this.markup=e||this.markup,this.callParent([this.markup]),this.dateFormat=t},getPercentDoneString:function(e){e._record;var t=e.PercentDone;return Math.round(t)},getTaskCalendarName:function(e){return e.DPMTaskCalendarName}}),t.define("DS.ENGantt.patches.Task",{extend:"Sch.util.Patch",target:"Gnt.model.Task",overrides:{setStartDateWithoutPropagation:function(e,t,a){var n,i,r=this,l=r.getTaskStore(!0);return t=!1!==t,l&&!0!==a&&!1!==a?a=l.skipWeekendsDuringDragDrop:!0!==a&&!1!==a&&(a=!1),r.autoCalculateLag(),r.beginEdit(),e?(!a||r.isMilestone()&&l&&l.scheduleByConstraints||(e=r.skipNonWorkingTime(e,!0)),r.set(r.startDateField,e),l&&r.isSegmented()&&r.updateSegmentsDates(),!1!==t?r.set(r.endDateField,r.recalculateEndDate(e)):(i=this.getEndDate())&&(this.constrainSegments(),r.set(r.durationField,r.calculateDuration(e,i,r.getDurationUnit())))):(r.set(r.durationField,null),r.set(r.startDateField,null),r.setSegmentsWithoutPropagation(null)),n=r.getDuration(),i=r.getEndDate(),e&&i&&null==n&&r.set(r.durationField,r.calculateDuration(e,i,r.getDurationUnit())),r.onPotentialEffortChange(),r.endEdit(),!0},setEndDateWithoutPropagation:function(e,a,n){var i,r,l=this,o=l.getTaskStore(!0);a&&(this.isEndDateModified=!0),a=!1!==a,!0!==n&&!1!==n&&o?n=o.skipWeekendsDuringDragDrop:!0!==n&&!1!==n&&(n=!1),l.autoCalculateLag(),l.beginEdit();var s=l.getEndDate();if(e)if(e<(r=l.getStartDate())&&!1===a&&(e=r),n&&(!n||l.isMilestone()&&o&&o.scheduleByConstraints||(e=l.skipNonWorkingTime(e,!1))),!1!==a)i=l.getDuration(),t.isNumber(i)?(o&&l.isSegmented()&&e-s&&l.updateSegmentsDates({isForward:!1,endDate:e}),l.set(l.startDateField,l.calculateStartDate(e,i,l.getDurationUnit())),l.set(l.endDateField,e)):l.set(l.endDateField,e);else{var d=l.isMilestone();if(e<r&&l.set(l.startDateField,e),l.set(l.endDateField,e),l.constrainSegments(),r&&(l.set(l.durationField,l.calculateDuration(r,e,l.getDurationUnit())),d&&!l.isMilestone())){var p=l.skipNonWorkingTime(r,!0);p-r!=0&&l.set(l.startDateField,p)}}else l.set(l.durationField,null),l.set(l.endDateField,null),l.setSegments(null);return i=l.getDuration(),r=l.getStartDate(),e&&r&&null==i&&l.set(l.durationField,l.calculateDuration(r,e,l.getDurationUnit())),l.onPotentialEffortChange(),l.endEdit(),!0},getPinConstraintType:function(e){var t,a=!1;return"Project Finish Date"===(e=e||this.getTaskStore(!0)).getRoot().childNodes[0].data.ScheduleFrom&&(a=!0),this.isEndDateModified?(t="finishnoearlierthan",a&&(t="finishnolaterthan"),t):a?"finishnolaterthan":"startnoearlierthan"},pinWithoutPropagation:function(e,t){var a=this,n=a.getTaskStore(!0);if(a.isPinnable(n)){var i=a.getPinConstraintType(n),r=!1;scheduleFrom=n.getRoot().childNodes[0].data.ScheduleFrom,"Project Finish Date"===scheduleFrom&&(r=!0),taskDate=r||a.isEndDateModified?a.getEndDate():a.getStartDate(),delete a.isEndDateModified,a.setConstraintWithoutPropagation(i,taskDate)}},getCriticalPaths:function(){for(var e,t=[this],a=[[this]];e=t.shift();){for(var n=e.getIncomingDependencies(),i=[],r=0;r<n.length;r++){var l=n[r],o=l.getSourceTask();null!=o&&"True"===o.get("isOverallCritical")&&l.isCritical(l)&&i.push(o)}i.length&&a.push(i)}return a},addTaskBelow:function(e){var t=this,a=t.parentNode;a.indexOf(t);return e=e||new t.self,App.Infra.doNotPropagate?a.appendChild(e):t.callParent(arguments)}}}),t.define("DS.ENOGantt.DPMGanttAll.Component",{override:"Ext.Component",getMaskTarget:function(){return this.getEl()}}),t.define("DS.ENOGantt.DPMGanttAll.column.EndDate",{override:"Gnt.column.EndDate",validateStartDate:!1,keepDuration:!0}),t.define("DS.ENOGantt.DPMGanttAll.field.EndDate",{override:"Gnt.field.EndDate",validateStartDate:!1,keepDuration:!0}),t.define("DS.ENOGantt.DPMGanttAll.util.DependencyParser",{override:"Gnt.util.DependencyParser",parse:function(e){if(!e)return[];for(var a=e.split(","),n=[],i=this.dependencyRegex,r=0;r<a.length;r++){var l=a[r];if(l||r!=a.length-1){var o={};if(!(s=i.test(l)))return null;-1==l.indexOf("+")&&-1==l.indexOf("-")&&(l+="+0 d");var s,d=(s=l.split(new RegExp("(([a-zA-Z0-9_-]+((sw+)+))?:)?(-?d+)?:(FS|SF|FF|SS|sf|fs|ff|ss|Sf|Fs|Ff|Ss|sS|sF|fS|fF)?([+-]{1})(d+(.d+)?s[DdHh])?")))[0];if(d.indexOf(":")>=0){var p=d.split(":"),c=p[0];o.predProjectName=c,o.isExtDep=!0,d=p[1]}else App.Infra.RootProjectname&&(o.predProjectName=App.Infra.RootProjectname);o.taskId=parseInt(d,10),o.predTaskSeqNumber=o.taskId,o.type=t.Array.indexOf(this.types,(s[6]||this.types[2]).toUpperCase());var u=s[10];if(u){var g=this.durationParser.parse(u,!0);if(!g)return null;"-"==s[7]&&(g.value=-1*g.value),g.value=parseFloat(g.value).toFixed(1),o.lag=g.value,o.lagUnit=g.unit.toLocaleLowerCase()||Sch.util.Date.DAY}n.push(o)}}return n}}),t.define("DS.ENOGantt.DPMGanttAll.field.Dependency",{override:"Gnt.field.Dependency",getTaskIdFromDependency:function(e,t){var a,n=this.task.getTaskStore(),r=e.taskId;if(this.useSequenceNumber){if(e.isExtDep){var l=e.predProjectName,o=this.task.get("TaskProjectId"),s=!1,d=(x=n.toArray()).length,p=0,c="",u=App.Infra.ColumnIndex.Name;for(idx=p;idx<d;idx++){var g=(b=x[idx]).get(App.Infra.Columns[u].dataIndex),h=b.get("Id");if(g&&n.RefinementUtil.patternMatches(l,g)&&o!=h){c=b.get("Id"),s=!0;break}}if(!s){if(t){var m=l,f=r;this.taskId=r;var v=i.getExternalProjectTaskBySequenceId(m,f);return r=v.taskId,projectPhyId=v.projectPhyId,e.fromProjectId=projectPhyId,e.ToAddToTask=!0,e.predTaskSeqNumber=f,r}return{taskId:void 0,isExtprojDep:!0}}o=c,d=(x=n.toArray()).length,p=0;var D=App.Infra.ColumnIndex.TaskSequenceId;for(idx=p;idx<d;idx++){if((g=(b=x[idx]).get(App.Infra.Columns[D].dataIndex))&&""+r==g){if((h=b.get("TaskProjectId"))==o){a=b;break}}else;}}else{o=this.task.get("TaskProjectId"),d=(x=n.toArray()).length,p=0,D=App.Infra.ColumnIndex.TaskSequenceId;var x,C=App.Infra.Columns[D].dataIndex;for(idx=p;idx<d;idx++){var b;if((g=(b=x[idx]).get(C))&&""+r==g){if((h=b.get("TaskProjectId"))==o){a=b;break}}else;}}r=a&&a.getId()}if(!r){l=e.predProjectName,f=e.taskId;this.taskId=r,r=(v=i.getExternalProjectTaskBySequenceId(l,f)).taskId,projectPhyId=v.projectPhyId,e.fromProjectId=projectPhyId}return r},applyChanges:function(e){var a,l=(e=e||this.task).getTaskStore().dependencyStore,o=this.getDependencies(),s=this.isPredecessor(),d=s?e.getIncomingDependencies(!0):e.getOutgoingDependencies(!0),p=[],c=t.Array.map(o,(function(e){return this.getTaskIdFromDependency(e)}),this);for(a=0;a<d.length;a++)t.Array.contains(c,d[a][s?"getSourceId":"getTargetId"]())||p.push(d[a]);p.length>0&&l.remove(p);var u=[],g=[];for(a=0;a<o.length;a++){var h=o[a],m=this.getTaskIdFromDependency(h,!0),f=l.getTasksLinkingDependency(m,e.getId());if(f)f.beginEdit(),f.setType(h.type),f.setLag(h.lag,h.lagUnit),f.endEdit();else if(h.ToAddToTask){var v={isExtDep:!0};v.From=m,v.To=e.getId(),v.Type=h.type,v.predTaskSeqNumber=h.predTaskSeqNumber,v.predProjectName=h.predProjectName,v.fromProjectId=h.fromProjectId,v.Lag=h.lag||0,v.LagUnit=h.lagUnit||"d",g.push(v)}else{var D=e.taskStore.getModelById(m),x="";if(D)x=D.get("Name");else{var C=h.predProjectName,b=h.predTaskSeqNumber,k=t.ComponentQuery.query("#dpmprojectgantt")[0].taskStore.getRoot().childNodes[0].id,y=r.getExternalProjectTaskBySequenceIdURL(C,b,k,!1);y+="&needTaskName=true",x=i.syncAjaxCall(y,"GET").taskName}var S=e.get("TaskSequenceId");S&&(S=parseInt(S)),(f=new l.model).setSourceId(s?m:e.getId()),f.setTargetId(s?e.getId():m),f.setType(h.type),f.data.predTaskSeqNumber=h.predTaskSeqNumber,f.data.predecessorTaskName=x,f.data.predProjectName=h.predProjectName,f.data.taskSeqNumber=S,f.data.successorTaskName=e.get("Name"),f.fromProjectId=h.fromProjectId,f.setLag(h.lag||0,h.lagUnit||"d"),u.push(f)}}if(u.length>0&&l.add(u),g){var T=e.get("ExternalDependencies"),F=g;T||(e.data.ExternalDependencies=[]),e.set("ExternalDependencies",F),n.setRawExternalDependency(e,g,T)}},getErrors:function(e){if(!e)return[];var a=this.dependencyParser.parse(e);if(!a)return[this.L("invalidFormatText")];for(var n,i=this.getDependencies(),r=this.isPredecessor(),l=this.task,o=l.getTaskStore().dependencyStore,s=l[r?"predecessors":"successors"],d=this.dependencyParser.types,p=o.allowedDependencyTypes,c=o.model.Type,u=[],g=0;g<i.length;g++){var h=i[g],m=this.getTaskIdFromDependency(h,!0);if(m&&m.isExtprojDep)return"";if(!(n=m))return[this.L("invalidDependencyText")];if(o.allowedDependencyTypes&&!o.isValidDependencyType(h.type)){for(var f="",v=0,D=p.length;v<D;v++)f+=d[c[p[v]]]+",";return[t.String.format(this.L("invalidDependencyType"),d[h.type],f.substring(0,f.length-1))]}var x=new o.model;x.setSourceId(r?n:l.getId()),x.setTargetId(r?l.getId():n),x.setType(h.type),x.data.predProjectName=h.predProjectName,x.setLag(h.lag,h.lagUnit),u.push(x)}for(g=0;g<u.length;g++)if(!o.isValidDependency(u[g],u,s))return[this.L("invalidDependencyText")];return this.callParent([a.value])},getFieldDisplayValue:function(e){var t=e.getTaskStore();if(this.isPredecessor()){var a=e.getId(),n=e.getAllDependencies(),i=e.get("ExternalDependencies");i&&i.length>0&&(n=n.concat(i));var r=new Array,l=n.length;for(idx=0;idx<l;idx++){var o=n[idx],s=o.isExtDep;if(s)var d=parseInt(o.Type),p=o.To,c=o.predTaskSeqNumber,u=o.predProjectName,g=(o.predProjectId,o.Lag),h=o.LagUnit;else{if((c=o.getFrom())==a)continue;c=(c=t.getModelById(c))?c.get("TaskSequenceId"):o.data.predTaskSeqNumber;p=o.getTo(),d=o.getType(),g=o.getLag(),u=o.data.predProjectName,h=o.getLagUnit()}if(!u&&o.getFrom()){var m=o.getFrom();if(C=t.getModelById(m)){var f=C.get("TaskProjectId"),v=t.getModelById(f);v&&(u=v.get("Name"))}}switch(d){case 0:d="SS";break;case 1:d="SF";break;case 2:d="FS";break;case 3:d="FF"}var D=parseInt(g)>=0?"+":"",x="";if(u){var C,b=!0,k=(t.data.items[0].data.Id,t.getModelById(p).get("TaskProjectId")),y="";m=s?o.From:o.getFrom();(C=t.getModelById(m))&&(y=C.get("TaskProjectId")),k!=y&&o.fromProjectId!=k||(b=!1),b&&(x=u+":")}x=x+c+":"+d+D+g+" "+h,r.push(x)}return r.sort(),r.join(",")}}}),t.define("DS.ENOGantt.DPMGanttAll.plugin.ConstraintResolutionGui",{override:"Gnt.plugin.ConstraintResolutionGui",onConstraintConflict:function(e,n){var i,r=this,l=r.getCmp(),o=l.lockedGrid.getView(),s=l.normalGrid.getView(),d=l.getDependencyView(),p={destroy:function(){t.destroy(i)}};function c(){o.refreshNode(e),s.refreshNode(e);try{d.updateDependencies(e.getAllDependencies()).then(null,t.emptyFn)}catch(e){console.log(e)}}if(c(),r.hasStoredResolutionForContext(n))r.resolveSilently(n,c);else{var u={dateFormat:r.getDateFormat(),resolutionContext:n};n.windowTitle&&(u.title=n.windowTitle),r.window=new a.widget.ConstraintResolutionWindow(u),i=r.window.on({ok:t.Function.bind(r.onUserActionOk,r,[n,c,r.window,p],!0),cancel:t.Function.bind(r.onUserActionCancel,r,[n,c,r.window,p],!0),close:t.Function.bind(r.onUserActionClose,r,[n,c,p],!0),destroyable:!0}),l.completeEdit(),r.window.show()}}}),t.define("DS.ENOGantt.DPMGanttAll.constraint.Base",{override:"Gnt.constraint.Base",getRemoveConstraintResolutionOption:function(e,a,n){n=n||a.getConstraintDate();var i=a.getTaskStore(!0);return{id:"remove-constraint",title:t.String.format(this.L("Remove the constraint"),this.L("name")),resolve:function(){(a.setConstraintWithoutPropagation("startnoearlierthan"),i.scheduleByConstraints&&a.getEarlyStartDate()<=a.getStartDate())&&a.pinWithoutPropagation(undefined,!0);e()}}}}),t.define("DS.ENOGantt.DPMGanttAll.widget.taskeditor.TaskEditor",{extend:"Sch.util.Patch",target:"Gnt.widget.taskeditor.TaskEditor",overrides:{buildItems:function(){var e=this;return items=[],e.taskForm=t.create(e.taskFormClass,t.apply({xtype:"taskform",xclass:e.taskFormClass,task:e.task,border:!1,taskStore:e.taskStore,showBaseline:e.showBaseline,showRollup:!1},e.taskForm,e.taskFormConfig)),items=e.callParent(arguments),items}}}),t.define("DS.ENOGantt.DPMGanttAll.util.DurationParser",{extend:"Sch.util.Patch",target:"Gnt.util.DurationParser",overrides:{parse:function(e,a){var n=this.durationRegex.exec(e);if(null==e||!n)return null;var i,r=this.parseNumberFn(n[1]),l=n[2];return l&&!a&&(t.iterate(this.L("unitsRegex"),(function(e,t){if(t.test(l))return i=Sch.util.Date.getUnitByName(e),!1})),i||(i=l)),i||(i=l),{value:r,unit:i}}}}),t.define("DS.ENOGantt.Ext.tree.View",{extend:"Sch.util.Patch",target:"Ext.tree.View",overrides:{expand:function(e,t,a,n,r){var l=this,o=arguments;if(r)return l.callParent(o);new UWA.Promise((function(t,a){i.isReadyToExpand(e,t)})).then((function(i){return l.expand(e,t,a,n,!0)}))}}}),t.define("DS.ENOGantt.picker.Pattern",{extend:"Ext.picker.Color",alias:"widget.patternPicker",renderTpl:['<tpl for="patterns">','<a href="#" role="button" class=" {parent.itemCls} {palleteCls}" hidefocus="on">','<span class="{parent.itemCls}-inner {.} {.}-RMB" >&#160;</span>',"</a>","</tpl>"],patterns:["diagonal1","diagonal2","diagonal3","diagonal4","cal4","pattern1","pattern2","pattern3","pattern4","cal5"],patRe:/(\s.*?-)/,handleClick:function(e){var t,a=this;if(e.stopEvent(),!a.disabled){var n=(t=e.currentTarget.children[0].className.match(a.patRe)[1]).substring(t.lastIndexOf(" ")+1,t.length-1);a.fireEvent("select",a,n)}},initRenderData:function(){var e=this,a=this.renderTpl.html;return a=a.replace("{palleteCls}",App.Infra.palleteClass),this.renderTpl.html=a,t.apply(e.superclass.callParent(),{itemCls:e.itemCls,patterns:e.patterns,row:e.row,height:e.height})}}),t.define("DS.ENOGantt.picker.Symbol",{extend:"Ext.picker.Color",alias:"widget.symbolPicker",renderTpl:['<tpl for="symbols">','<a href="#" role="button" class=" {parent.itemCls} {palleteCls}" hidefocus="on">','<span class="{parent.itemCls}-inner {.} {.}-RMB" >&#160;</span>',"</a>","</tpl>"],patRe:/(\s.*?-)/,handleClick:function(e){var t,a=this;e.stopEvent(),a.disabled||(t=(t=e.currentTarget.children[0].className.match(a.patRe)[1]).substring(t.lastIndexOf(" ")+1,t.length-1),a.fireEvent("select",a,t))},initRenderData:function(){var e=this,a=this.renderTpl.html;return a=a.replace("{palleteCls}",App.Infra.palleteClass),this.renderTpl.html=a,t.apply(e.superclass.callParent(),{itemCls:e.itemCls,symbols:e.symbols,row:e.row,height:e.height})}}),t.define("DS.ENOGantt.DPMGanttAll.Button",{override:"Ext.button.Button",onEnable:function(){var e=this,t=e.href,a=e.hrefTarget,n=e.el.dom;e.callSuper(),e.removeCls(e._disabledCls),e.el.setTabIndex(e.tabIndex),t&&(n.href=t),a&&(n.target=a)},onDisable:function(){var e=this,t=e.el.dom;e.callSuper(),e.addCls(e._disabledCls),e.removeCls(e.overCls),e.el.setTabIndex(null),e.href&&t.removeAttribute("href"),e.hrefTarget&&t.removeAttribute("target")}}),t.define("DS.ENOGantt.DPMGanttAll.panel.Gantt",{override:"Gnt.panel.Gantt",onTaskReorder:function(e,a,n,i){var r=this.valid;if(r){var l=a.view.store,o=a.view.up("ganttpanel"),s=this.getTargetFromEvent(n),d=this.view.getRecord(s),p=o.getSchedulingView().getVerticalScroll();if(r=d!==i._reorderingTask){var c=i.records,u={},g=this.view;if(o.suspendRefreshOnTaskReorder&&o.suspendRefresh(),t.Array.each(c,(function(e){u[e.parentNode.id]=e.parentNode})),l.suspendAutoRecalculateParents++,r=this.self.prototype.onNodeDrop.apply(this,arguments),l.suspendAutoRecalculateParents--,r){u[c[0].parentNode.id]=c[0].parentNode;var h=t.Object.getValues(u);h.sort((function(e,t){return e.data.depth>t.data.depth?-1:1})),t.Array.each(h,(function(e){e.refreshCalculatedParentNodeData()}))}o.suspendRefreshOnTaskReorder&&o.resumeRefresh(!0),setTimeout((function(){g.setScrollY(p)}),0)}}return r}}),t.define("DS.ENOGantt.DPMGanttAll.plugin.gridviewdragdrop",{override:"Ext.tree.plugin.TreeViewDragDrop",dragText:"{0} "+App.Nls["emxProgramCentral.dragdrop.dragText"]}),t.define("DS.ENOGantt.DPMGanttAll.widget.ConstraintResolutionForm",{extend:"Sch.util.Patch",target:"Gnt.widget.ConstraintResolutionForm",overrides:{setupFooterFromResolutionContext:function(e){var a=this;t.isObject(e)&&t.isArray(e.resolutions)||t.Error.raise("Invalid resolution context provided!"),a.fbar={itemId:"footer-tb",items:[{xtype:"checkbox",itemId:"dont-ask-cb",boxLabel:a.L("Don't ask again"),tabIndex:e.resolutions.length+1,hidden:!0},"->",{text:a.L("OK"),itemId:"ok-btn",style:"border-color:#368EC4;background-color:#368EC4;color:#FFFFFF !important;font-size:14px",cls:"apply-button-text",formBind:!0,tabIndex:e.resolutions.length+2,handler:a.onUserActionOk,scope:a},{text:a.L("Cancel"),itemId:"cancel-btn",tabIndex:e.resolutions.length+3,handler:a.onUserActionCancel,scope:a}]}}}}),t.define("DS.ENOGantt.DPMGanttAll.ConstraintType",{extend:"Sch.util.Patch",target:"Gnt.field.ConstraintType",overrides:{statics:{buildDefaultConstraintTypeList:function(e){var a=[];return t.Array.each(t.ClassManager.getNamesByExpression("gntconstraint.*"),(function(e){var n=t.ClassManager.get(e),i=n.alias[0].split(".").pop();n&&a.push([i,n.L("name")])})),a=t.Array.sort(a,(function(e,t){return l.constraintTypeMap[e[0]]>l.constraintTypeMap[t[0]]?1:-1})),e&&a.unshift([null,""]),a}}}}),t.define("DS.ENOGantt.DPMGanttAll.widget.DependencyGrid",{override:"Gnt.widget.DependencyGrid",buildColumns:function(){var e=this,t=this.store.model.prototype,a=[],n=this.dependencyStore&&this.dependencyStore.getTaskStore();this.tasksCombo=this.buildTasksCombo(),n?this.bindTaskStore():(this.deferredStoreBind=!0,this.tasksCombo.on("afterrender",this.bindTaskStore,this));var i=t["predecessors"===this.direction?"fromField":"toField"];return this.useSequenceNumber?a.push({text:this.L("snText"),dataIndex:i,renderer:function(t,a,n){var r=e.dependencyStore&&e.dependencyStore.getTaskStore(),l=r&&r.getModelById(n.get(i));return l?l.getSequenceNumber():""},width:50}):a.push({text:this.L("idText"),dataIndex:i,width:50}),a.push({text:this.L("taskText"),dataIndex:i,flex:1,editor:this.tasksCombo,renderer:function(t,a,n){return e.taskRender(t,a,n)}}),this.lagEditor=this.buildLagEditor(),this.typesCombo=this.buildTypesCombo(),a.push({text:this.L("typeText"),dataIndex:t.typeField,width:120,renderer:this.dependencyTypeRender,scope:this,editor:this.typesCombo},{text:this.L("lagText"),dataIndex:t.lagField,width:100,editor:this.lagEditor,renderer:function(a,n,i){return e.lagEditor.valueToVisible(a,i.get(t.lagUnitField),2)}}),a}}),t.define("DS.ENOGantt.DPMGanttAll.colorpick.ButtonController",{override:"Ext.ux.colorpick.ButtonController",onClick:function(){var e,a,n=t.ComponentQuery.query("#dpmprojectgantt")[0];if(n)var i=n.lockedGrid.getSelectionModel().selected.items;var r=this.getView(),l=this.getPopup();a=i&&1==i.length?""==(e=i[0].get("Color"))?t.ux.colorpick.ColorUtils.parseColor("#5FA2DD"):t.ux.colorpick.ColorUtils.parseColor(e):t.ux.colorpick.ColorUtils.parseColor("#5FA2DD");var o=l.colorPicker;o.setColor(a),o.setPreviousColor(a),l.showBy(r,"tl-br?")}}),t.define("DS.ENOGantt.DPMGanttAll.colorpick.Button",{override:"Ext.ux.colorpick.Button",renderTpl:'<a class="x-btn x-unselectable x-border-item x-box-item x-btn-default-small" style="padding: 0px 5px; margin: 0px; height: 18px;" hidefocus="on" unselectable="on" role="button" aria-hidden="false" aria-disabled="false" id="{id}" tabindex="0" ><span id="{id}-btnWrap" data-ref="btnWrap" role="presentation" unselectable="on" style class="x-btn-wrap x-btn-wrap-default-small "><span id="{id}-btnEl" data-ref="btnEl" unselectable="on" style="height: auto; width: 75px; text-overflow: ellipsis;" class="x-btn-button x-btn-button-default-small x-btn-text x-btn-button-center " title="'+App.Nls["emxProgramCentral.Gantt.MoreColors"]+'"><span id="{id}-btnIconEl" data-ref="btnIconEl" role="presentation" unselectable="on" class="x-btn-icon-el x-btn-icon-el-default-small" style></span><span id="{id}-btnInnerEl" data-ref="btnInnerEl" unselectable="on" class="x-btn-inner x-btn-inner-default-small">'+App.Nls["emxProgramCentral.Gantt.MoreColors"]+'</span></span></span><div id="{id}-tooltipEl" data-ref="tooltipEl" role="presentation" class="x-btn-tooltip"></div></a>'}),t.define("DS.ENOGantt.DPMGanttAll.colorpick.Selector",{override:"Ext.ux.colorpick.Selector",getPreviewAndButtons:function(e,t){var a=[{xtype:"colorpickercolorpreview",flex:1,bind:{color:{bindTo:"{selectedColor}",deep:!0}}}];return t.showPreviousColor&&a.push({xtype:"colorpickercolorpreview",flex:1,bind:{color:{bindTo:"{previousColor}",deep:!0}},listeners:{click:"onPreviousColorSelected"}}),t.showOkCancelButtons&&a.push({xtype:"button",id:"okButton",text:"OK",tooltip:"OK",margin:"10 0 0 0",padding:"10 0 10 0",handler:"onOK"},{xtype:"button",text:App.Nls["emxProgramCentral.Gantt.DependencyEditor.Cancel"],tooltip:App.Nls["emxProgramCentral.Gantt.DependencyEditor.Cancel"],margin:"10 0 0 0",padding:"10 0 10 0",handler:"onCancel"}),{xtype:"container",viewModel:e,width:70,margin:"0 0 0 10",items:a,layout:{type:"vbox",align:"stretch"}}},getMapAndHexRGBFields:function(e){var a=this,n={top:0,right:a.fieldPad,bottom:0,left:0},i=a.fieldWidth;return{xtype:"container",viewModel:e,cls:t.baseCSSPrefix+"colorpicker-escape-overflow",flex:1,layout:{type:"vbox",align:"stretch"},margin:"0 10 0 0",items:[{xtype:"colorpickercolormap",reference:"colorMap",flex:1,bind:{position:{bindTo:"{selectedColor}",deep:!0},hue:"{selectedColor.h}"},listeners:{handledrag:"onColorMapHandleDrag"}},{xtype:"container",layout:"hbox",defaults:{labelAlign:"top",labelSeparator:"",allowBlank:!1,onChange:function(){this.isValid()?t.form.field.Base.prototype.onChange.apply(this,arguments):t.getCmp("okButton").setDisabled(!0),0==t.getCmp("hexField").getErrors().length&&0==t.getCmp("RField").getErrors().length&&0==t.getCmp("BField").getErrors().length&&0==t.getCmp("GField").getErrors().length&&t.getCmp("okButton").setDisabled(!1)}},items:[{xtype:"textfield",id:"hexField",fieldLabel:"HEX",flex:1,bind:"{hex}",margin:n,regex:/^#[0-9a-f]{6}$/i,readonly:a.getHexReadOnly()},{xtype:"numberfield",id:"RField",fieldLabel:"R",bind:"{red}",width:i,hideTrigger:!0,maxValue:255,minValue:0,allowDecimals:!1,margin:n},{xtype:"numberfield",id:"GField",fieldLabel:"G",bind:"{green}",width:i,hideTrigger:!0,maxValue:255,minValue:0,allowDecimals:!1,margin:n},{xtype:"numberfield",id:"BField",fieldLabel:"B",bind:"{blue}",width:i,hideTrigger:!0,maxValue:255,minValue:0,allowDecimals:!1,margin:0}]}]}},getSliderAndHField:function(e){var a=this.fieldWidth;return{xtype:"container",viewModel:e,cls:t.baseCSSPrefix+"colorpicker-escape-overflow",width:a,layout:{type:"vbox",align:"stretch"},items:[{xtype:"colorpickersliderhue",reference:"hueSlider",flex:1,bind:{hue:"{selectedColor.h}"},width:a,listeners:{handledrag:"onHueSliderHandleDrag"}},{xtype:"numberfield",id:"HField",fieldLabel:"H",labelAlign:"top",labelSeparator:"",bind:"{hue}",hideTrigger:!0,maxValue:360,minValue:0,allowBlank:!1,margin:0,validator:function(e){return null==t.getCmp("SField").getValue()||(e<=360&&t.getCmp("RField").getValue()<=255&&t.getCmp("GField").getValue()<=255&&t.getCmp("BField").getValue()<=255&&t.getCmp("SField").getValue()<=100&&t.getCmp("VField").getValue()<=100&&t.getCmp("AField").getValue()<=100?(t.getCmp("okButton").setDisabled(!1),!0):(t.getCmp("okButton").setDisabled(!0),!0))}}]}},getSliderAndSField:function(e){var a=this,n=a.fieldWidth;return{xtype:"container",viewModel:e,cls:t.baseCSSPrefix+"colorpicker-escape-overflow",width:n,layout:{type:"vbox",align:"stretch"},margin:{right:a.fieldPad,left:a.fieldPad},items:[{xtype:"colorpickerslidersaturation",reference:"satSlider",flex:1,bind:{saturation:"{saturation}",hue:"{selectedColor.h}"},width:n,listeners:{handledrag:"onSaturationSliderHandleDrag"}},{xtype:"numberfield",fieldLabel:"S",id:"SField",labelAlign:"top",labelSeparator:"",bind:"{saturation}",hideTrigger:!0,maxValue:100,minValue:0,allowBlank:!1,margin:0,validator:function(e){return null==t.getCmp("VField").getValue()||(e<=100&&t.getCmp("RField").getValue()<=255&&t.getCmp("GField").getValue()<=255&&t.getCmp("BField").getValue()<=255&&t.getCmp("HField").getValue()<=360&&t.getCmp("VField").getValue()<=100&&t.getCmp("AField").getValue()<=100?(t.getCmp("okButton").setDisabled(!1),!0):(t.getCmp("okButton").setDisabled(!0),!0))}}]}},getSliderAndVField:function(e){var a=this.fieldWidth;return{xtype:"container",viewModel:e,cls:t.baseCSSPrefix+"colorpicker-escape-overflow",width:a,layout:{type:"vbox",align:"stretch"},items:[{xtype:"colorpickerslidervalue",reference:"valueSlider",flex:1,bind:{value:"{value}",hue:"{selectedColor.h}"},width:a,listeners:{handledrag:"onValueSliderHandleDrag"}},{xtype:"numberfield",fieldLabel:"V",id:"VField",labelAlign:"top",labelSeparator:"",bind:"{value}",hideTrigger:!0,maxValue:100,minValue:0,allowBlank:!1,margin:0,validator:function(e){return null==t.getCmp("AField").getValue()||(e<=100&&t.getCmp("RField").getValue()<=255&&t.getCmp("GField").getValue()<=255&&t.getCmp("BField").getValue()<=255&&t.getCmp("HField").getValue()<=360&&t.getCmp("SField").getValue()<=100&&t.getCmp("AField").getValue()<=100?(t.getCmp("okButton").setDisabled(!1),!0):(t.getCmp("okButton").setDisabled(!0),!0))}}]}},getSliderAndAField:function(e){var a=this.fieldWidth;return{xtype:"container",viewModel:e,cls:t.baseCSSPrefix+"colorpicker-escape-overflow",width:a,layout:{type:"vbox",align:"stretch"},margin:{left:this.fieldPad},items:[{xtype:"colorpickerslideralpha",reference:"alphaSlider",flex:1,bind:{alpha:"{alpha}",color:{bindTo:"{selectedColor}",deep:!0}},width:a,listeners:{handledrag:"onAlphaSliderHandleDrag"}},{xtype:"numberfield",fieldLabel:"A",id:"AField",labelAlign:"top",labelSeparator:"",bind:"{alpha}",hideTrigger:!0,maxValue:100,minValue:0,allowBlank:!1,margin:0,validator:function(e){return e<=100&&t.getCmp("RField").getValue()<=255&&t.getCmp("GField").getValue()<=255&&t.getCmp("BField").getValue()<=255&&t.getCmp("HField").getValue()<=360&&t.getCmp("SField").getValue()<=100&&t.getCmp("VField").getValue()<=100?(t.getCmp("okButton").setDisabled(!1),!0):(t.getCmp("okButton").setDisabled(!0),!0)}}]}}}),t.define("DS.ENOGantt.DPMGanttAll.colorpick.SelectorController",{override:"Ext.ux.colorpick.SelectorController",onCancel:function(){0==t.getCmp("hexField").getErrors().length&&0==t.getCmp("RField").getErrors().length&&0==t.getCmp("GField").getErrors().length&&0==t.getCmp("BField").getErrors().length&&0==t.getCmp("HField").getErrors().length&&0==t.getCmp("SField").getErrors().length&&0==t.getCmp("VField").getErrors().length&&0==t.getCmp("AField").getErrors().length||(t.getCmp("hexField").setValue("#"+this.getView().getValue().toUpperCase()),t.getCmp("RField").setValue(this.getView().color.r),t.getCmp("GField").setValue(this.getView().color.g),t.getCmp("BField").setValue(this.getView().color.b),t.getCmp("HField").setValue(parseFloat(360*this.getView().color.h).toFixed(2)),t.getCmp("SField").setValue(parseFloat(100*this.getView().color.s).toFixed(2)),t.getCmp("VField").setValue(parseFloat(100*this.getView().color.v).toFixed(2)),t.getCmp("AField").setValue(parseFloat(100*this.getView().color.a).toFixed(2))),this.fireViewEvent("cancel",this.getView())}}),t.define("DS.ENOGantt.DPMGanttAll.scroll.Scroller",{override:"Ext.scroll.Scroller",ensureVisible:function(e,a){var n,i,r,l=this,o=l.getPosition();return e?(e&&e.element&&!e.isElement&&(e=(a=e).element),n=(a=a||{}).highlight,(i=l.getEnsureVisibleXY(e,a)).y===o.y&&i.x===o.x||!l.component.selection||0!=l.component.selection.isLast()?(n&&l.doHighlight(e,n),r=t.Deferred.getCachedResolved()):(n&&l.on({scrollend:"doHighlight",scope:l,single:!0,args:[e,n]}),r=l.doScrollTo(i.x,i.y,a.animation))):r=t.Deferred.getCachedRejected(),r}}),t.define("DS.ENOGantt.DPMGanttAll.model.Task",{override:"Gnt.model.Task",extend:"Sch.model.Range",alias:"gntmodel.event",normalizeParent:function(){for(var e=this.childNodes,t=0,a=0,n=0,i=0,r=0,l=this.autoCalculatePercentDoneForParentTask,o=this.autoCalculateEffortForParentTask,s=this.autoCalculateCostForParentTask,d=e.length>0,p=!1,c=0;c<e.length;c++){var u=e[c],g=u.isLeaf();if(g||u.normalizeParent(),o&&(t+=u.getEffort("MILLI")),s&&(i+=u.getCost(),r+=u.getActualCost()),l){var h=g?u.getDuration("MILLI")||0:u.childTasksDuration,m=u.getPercentDone()||0;a+=h,n+=g?h*m:u.completedChildTasksDuration,p=p||this.hasUnfinishedMilestone||0===h&&m<100,d=d&&0===h&&m>=100}}if(l){var f=0;this.childTasksDuration=a,this.completedChildTasksDuration=n,this.hasUnfinishedMilestone=p,a>0?100===(f=n/a)&&p&&(f=99):d&&(f=100),this.getPercentDone()!=f&&"FALSE"==this.data.isSummaryTask&&(this.data[this.percentDoneField]=f)}o&&this.getEffort("MILLI")!=t&&(this.data[this.effortField]=this.getUnitConverter().convertMSDurationToUnit(t,this.getEffortUnit())),l&&o&&(this.data[this.actualEffortField]=this.calculateActualEffort()),s&&(this.data[this.actualCostField]=r,this.data[this.costField]=i),this.data[this.costVarianceField]=this.calculateCostVariance(),this.data[this.effortVarianceField]=this.calculateEffortVariance()},isCritical:function(){return"True"===this.get("isOverallCritical")}}),t.define("DS.ENOGantt.DPMGanttAll.view.Gantt",{override:"Gnt.view.Gantt",getTemplateForTask:function(e,a){if(e.isMilestone(a)){var n=e.get("Symbol"),r=e.get("Pattern");if((null==r||""==r)&&null!=n&&""!=n){var l=e.get("Color"),o=App.Infra.milestoneCFG;null!=o&&""!=o||(o=this.config);var s='<img unselectable="on" style="<tpl if="print">height: {side}px; border-left-width: {side}px; </tpl>{style}" src="'+i.getSVGImage(e,n,l,r)+'" class="'+n+'{cls}" />',d='<div id="'+o.prefix+'{id}" {attr} class="sch-gantt-item sch-gantt-milestone-diamond-ct">'+s+'<tpl if="isRollup"><tpl else>'+(o.enableDependencyDragDrop?this.dependencyTerminalMarkup:"")+"</tpl></div>",p=this.getTemplateConfig();return(u=t.apply({},d&&{innerTpl:d},p)).customInnerTpl=s,u.symbol=n,u.pattern=r,this.setupTemplate(null,"Gnt.template.Milestone",u)}return this.milestoneTemplate}if(e.isLeaf()){if(0==App.Infra.showPercentComplete){p=this.getTemplateConfig();var c=this.taskBodyTemplate.replaceAll("{[Gnt.column.PercentDone.prototype.defaultRenderer(values.percentDone)]}%",""),u=t.apply({},c&&{innerTpl:c},p);return this.setupTemplate(null,"Gnt.template.Task",u)}return this.eventTemplate}if(0==App.Infra.showPercentComplete){p=this.getTemplateConfig();var g=this.parentTaskBodyTemplate.replaceAll("{[Gnt.column.PercentDone.prototype.defaultRenderer(values.percentDone)]}%","");u=t.apply({},g&&{innerTpl:g},p);return this.setupTemplate(null,"Gnt.template.ParentTask",u)}return this.parentEventTemplate}}),t.define("DS.ENOGantt.DPMGanttAll.Ext.panel.Table",{override:"Ext.panel.Table",sealedColumns:!0,listeners:{columnmove:function(e,t,a,n,i){App.Infra.isColumnReordered=!0},columnresize:function(e,t,a,n){i.cacheColumnConfiguration(e,t,n,"width",parseInt(a))},columnshow:function(e,t,a){i.cacheColumnConfiguration(e,t,a,"hideColumn",!1)},columnhide:function(e,t,a){i.cacheColumnConfiguration(e,t,a,"hideColumn",!0)}}}),t.define("DS.ENOGantt.DPMGanttAll.template.Milestone",{override:"Gnt.template.Milestone",innerTpl:'<img unselectable="on" style="<tpl if="print">height: {side}px; border-left-width: {side}px; </tpl>{style}" src="'+t.BLANK_IMAGE_URL+'" class="sch-gantt-milestone-diamond {cls}" />',getInnerTpl:function(e){var t=this.innerTpl;App.Infra.milestoneCFG=e;var a=e.symbol,n=e.pattern;return null!=n&&""!=n||null==a||""==a||(t=e.customInnerTpl),'<div id="'+e.prefix+'{id}" {attr} class="sch-gantt-item sch-gantt-milestone-diamond-ct">'+t+'<tpl if="isRollup"><tpl else>'+(e.enableDependencyDragDrop?this.dependencyTerminalMarkup:"")+"</tpl></div>"}}),t.define("DS.ENOGantt.DPMGanttAll.util.Date",{override:"Sch.util.Date",getReadableNameOfUnit:function(e,t){this.isLocaleApplied()||this.applyLocale();var a=this._unitNames.d,n=this._unitNames.h,i=this._unitNames.w,r=this._unitNames.mon,l=this._unitNames[e];return!l||l!=a&&l!=n&&l!=i&&l!=r?a[t?"plural":"single"]:l[t?"plural":"single"]}})}})}));