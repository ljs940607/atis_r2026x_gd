define("DS/ENOGantt/Infra",["UWA/Class","DS/Foundation2/FoundationV2Data","DS/E6WCommonUI/UIHelper","DS/ENOGantt/URLStore","DS/ENOGantt/GanttUtil","DS/ENOGantt/Ven/Ext","DS/ENOGantt/Ven/Bryntum","DS/ENOProjectMgmtModels/Models/FieldsDefinition","DS/ENOGantt/Nls/Eno/"+window.languageGlobalVar,"DS/ENOGantt/Nls/Ext/"+window.languageGlobalVar,"DS/ENOGantt/Nls/Sch/"+window.languageGlobalVar,"DS/ENOGantt/Nls/Gnt/"+window.languageGlobalVar],(function(e,t,n,a,r,i,o,l,s){"use strict";return i.ns("App"),App.Gantt={},App.csrf={name:"",value:""},App.Gantt.filter={fields:{},filterBy:{}},App.Nls=s,e.extend({init:function(e){let t=UWA.clone(e||{},!1),n=t.viewCollection,r=t.contextInfo;enoviaServer.viewId||(enoviaServer.viewId="WBSView");let i=a.getInfraURL();n.getDataModelDetails({model:r,fields:i.fields,include:i.include,customParams:i.customParams,doNotCache:!0}).then(this.handleOnCompleteInfra.bind(this,e))},handleOnCompleteInfra:function(e,t){let n=this;var a=t._attributes;e.viewCollection.getDataModelDetails({refresh:!0,doNotCache:!0,fields:"none,columns",customParams:{viewId:enoviaServer.viewId,referenceId:null==enoviaServer.referenceId?"":enoviaServer.referenceId},model:e.contextInfo}).then((function(i){a.columns=i.get("columns").replace(/M d, Y/g,r.getDateFormat()),n.setupInfra(t,a,e),e.loadWidget()}))},setupInfra:function(e,t,r){var o=e._attributes.relelements,s=e._attributes.subTypesInfo[0],E="TRUE"==t.kindofTemplate,d="TRUE"==t.kindofBaseline,I="TRUE"==t.kindofExperiment,p="TRUE"==t.kindofConcept,u="TRUE"==t.modifyAccess,S=(n.isMobile(),!0),m=!0,c=!1,f=!0,A={VIEW_WBS:"WBSView",VIEW_ACTUAL:"ActualWBSView",VIEW_PLAN_VERSUS_ACTUAL:"PlannedVsActualView",VIEW_BASELINE_WBS:"ProjectBaselineView",VIEW_BASELINE_VERSUS_CURRENT_BASELINE:"BaselineVsCurrentBaselineView",VIEW_BASELINE_VERSUS_CURRENT_BASELINE2:"BaselineVsCurrentBaselineView2",VIEW_EXPERIMENT_VERSUS_PROJECT:"ExperimentVsProjectView",VIEW_TEMPLATE_WBS:"ProjectTemplateView",VIEW_STATUS_REPORT:"StatusReportViewer"};E?enoviaServer.viewId=A.VIEW_TEMPLATE_WBS:d?(enoviaServer.viewId!=A.VIEW_BASELINE_VERSUS_CURRENT_BASELINE2&&enoviaServer.viewId!=A.VIEW_BASELINE_VERSUS_CURRENT_BASELINE||(c=!0),enoviaServer.viewId=A.VIEW_BASELINE_WBS,S=!0):enoviaServer.viewId||(enoviaServer.viewId=A.VIEW_WBS);var v=enoviaServer.viewId;A.VIEW_WBS==v?(S=!u,"Cancel"==t.state&&(S=!0),m=!1,(I||p)&&((t.routeId||"Cancel"==t.experimentProjectState||"Hold"==t.experimentProjectState)&&(S=!0),m=!0)):A.VIEW_TEMPLATE_WBS==v?(S=!u,"Released"!=t.state&&"Obsolete"!=t.state||(S=!0)):A.VIEW_PLAN_VERSUS_ACTUAL==v||A.VIEW_BASELINE_VERSUS_CURRENT_BASELINE==v?(m=!1,c=!0):A.VIEW_BASELINE_VERSUS_CURRENT_BASELINE2==v||A.VIEW_EXPERIMENT_VERSUS_PROJECT==v?c=!0:A.VIEW_STATUS_REPORT==v&&(m=!1,f=!1);App.Infra={contextInfo:e,ViewId:enoviaServer.viewId,ReadOnly:S,HideView:m,BaselineRequired:c,ToolbarRequired:!0,NameFilterRequired:f,TypeOf:{ProjectTemplate:E,ProjectBaseline:d,Experiment:I,ProjectConcept:p},Views:A,routeId:t.routeId,showPercentComplete:!E};var V=t.columns;delete t.columns;var _=this.getColumnsInfo(V),C=_.columns,w=_.columnsIndex;App.Infra.CustomeColumnDataIndex=_.customeColumnDataIndex,App.Infra.customeColumnEditableData=_.customeColumnEditableData,App.Infra.Columns=C,App.Infra.ColumnIndex=w,App.Infra.ExtTaskArray=new Array,App.Infra.expandStatus={},App.Infra.Load={},App.Infra.projectDataElements=t,App.Infra.RootProjectname=t.title,App.Infra.projectRelElements=o,App.Infra.isCustomizedEnvironment=!1,App.Infra.DerivativeTypes=s,App.Infra.hasDPMLicense=!1;var N=t.lagCalendar;App.Infra.depLagCalendar="Predecessor Task Calendar"==N?"source":"Project Default Calendar"==N?"project":"target",l.getFieldDefinitionColumn("projects","hasDPMAccess")&&(App.Infra.hasDPMLicense=!0);let R=l.getFieldDefinitionColumn("projects","disableOwnershipInheritance").fieldDefinitionRangeItem.DPM_DisableOwnershipInheritance.default;App.Infra.disableOwnershipInheritance=R,i.Ajax.request({url:a.getCustomizationFlagURL(),async:!1,success:function(e){var t=JSON.parse(e.responseText.trim());t.isCustomizedEnvironment&&(App.Infra.isCustomizedEnvironment=t.isCustomizedEnvironment)}})},getColumnsInfo:function(e){var t={},n=JSON.parse(e),a={},r=[],i={},o=[];t.customeColumnEditableData=i,t.customeColumnDataIndex=r,t.columns=o;for(let e=0,t=n.length;e<t;e++){if((E=n[e]).customColumn){"datecolumn"==E.xtype&&r.push(E.dataIndex);var l=E.name,s=E.editable;i[l]={isEditable:s,xtype:E.xtype}}null==E.name&&(a[E.text]=e),o.push(E)}a={};for(let e=0,t=o.length;e<t;e++){var E;a[(E=o[e]).name]=e}var d=o[a.Name];if(App.Infra.ViewId!=App.Infra.Views.VIEW_WBS&&App.Infra.ViewId!=App.Infra.Views.VIEW_TEMPLATE_WBS||(d&&!d.width&&(d.width=200),d.layout="vbox",d.items=[{id:"filterField",xtype:"textfield",width:"100%",emptyText:App.Nls["emxProgramCentral.Common.Filter"],enableKeyEvents:!0,reference:"filterByName"}]),d&&!d.width&&(d.width=350),App.Infra.ViewId!=App.Infra.Views.VIEW_STATUS_REPORT){var I=o[a.Status];I.sortable=!1,I.renderer=function(e,t,n){var a=n.get("Status"),r=App.Nls["emxProgramCentral.Gantt.TaskStatus."+a];if(r)return'<div title="'+r+'" class="status '+a+'">&nbsp;</div>'},t.columnsIndex=a;var p=a.Dependency;o[p].useSequenceNumber=!0,delete o[p].editor}return t}})}));