define("DS/GEOWebSearchUI/ContextMenu",["UWA/Controls/Abstract"],(function(e){"use strict";var o="dsexploration:SiteVersion",t="dsgeology:GeologicModelVersion",i="dsgeospatial:CompoundSRS",n="dsexploration:TerrainVersion",s="GEOXMD_AP",c="GEOXGDM_AP",a="OpenInGeologyModeling",l="ShowInGEODataExplorer",r="OpenInGEODataExplorer";return e.extend({name:"GEOVIAAction",_compass_socket:null,_action_info:null,_role_check_promise:null,init:function(){},availableForTypes:function(){return[o,t,i,n]},getActionForObject:function(e,s){var c=this;require(["UWA/Class/Promise","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],(function(d,u){if(UWA.is(e.sourceid,"string")&&0===e.sourceid.toLowerCase().indexOf("geovia")){UWA.is(c._role_check_promise)||(c._role_check_promise=new d((function(e,o){u.getGrantedRoles((function(t){if(UWA.is(t,"array"))for(var i=0;i<t.length;i++)if(t[i]&&("GML"===t[i].id||"InternalDS"===t[i].id))return void e();o()}))})));c._role_check_promise.then((function(){if(UWA.is(s)){var d=[];require(["DS/RuntimeView/NLSManager"],(function(u){u.loadResource({resourceFile:"GEOWebSearchUI/ContextMenu"}),u.onResourceLoaded({resourceFile:"GEOWebSearchUI/ContextMenu"},(function(){switch(e["ds6w:type_value"]||e["ds6w:type"]){case t:d.push({title:this.getTitle({key:a}),icon:"level-down",id:"geovia_xmd_open",multisel:!1,callback:c.launchCustoAction.bind(c)}),d.push({title:this.getTitle({key:l}),icon:"level-down",id:"geovia_xgdm_open",multisel:!1,callback:c.launchCustoAction.bind(c)});break;case o:d.push({title:this.getTitle({key:r}),icon:"level-down",id:"geovia_xgdm_open",multisel:!1,callback:c.launchCustoAction.bind(c)});break;case i:case n:d.push({title:this.getTitle({key:l}),icon:"level-down",id:"geovia_xgdm_open",multisel:!1,callback:c.launchCustoAction.bind(c)})}s.call(null,d)}))}))}}))}}))},launchCustoAction:function(e){var o=this;require(["UWA/Utils/InterCom"],(function(t){if(UWA.is(e)){var i="GEOVIAcompassSocket";null===o._compass_socket&&(o._compass_socket=new t.Socket(i),o._compass_socket.subscribeServer("com.ds.compass",window.parent));var n,a=e.model.get("sourceid_value")||e.model.get("sourceid"),l={protocol:"3DXContent",version:"1.1",source:"X3DSEAR_AP",data:{items:[{envId:a=a?a.split(":")[1]:e.model.get("tenant"),objectId:e.model.get("id"),objectType:e.model.get("ds6w:type_value")||e.model.get("ds6w:type"),displayName:e.model.get("ds6w:label").replace(/&gt;/g,">").replace(/&lt;/g,"<"),serviceId:e.model.get("ds6w:where/ds6w:source/ds6w:dataSource_value")||e.model.get("ds6w:where/ds6w:source/ds6w:dataSource")}]}};switch(o._compass_socket.dispatchEvent("onSetX3DContent",l,i),e.action_id){case"geovia_xmd_open":n={appId:s};break;case"geovia_xgdm_open":n={appId:c}}o._compass_socket.dispatchEvent("onLaunchApp",n,i)}}))}})}));