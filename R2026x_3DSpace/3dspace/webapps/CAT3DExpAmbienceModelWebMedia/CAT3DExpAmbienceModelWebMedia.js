define("DS/CAT3DExpAmbienceModelWebMedia/extensions/CATE3DXAmbienceAssetMedia",["UWA/Core","DS/CAT3DExpAmbienceModelWeb/extensions/CATE3DXAmbienceAsset","DS/Visualization/ModelLoader","DS/Visualization/Node3D","DS/CAT3DExpModel/XCTExpUint8ArrayAsset"],(function(e,t,i,n,r){"use strict";return t.extend({_getAmbienceFromAsset:async function(t){if(!(t instanceof r))return e.Promise.reject(new Error("Cant retrieve ambience asset for object "+this.GetObject().GetID()));const o=e.Promise.deferred(),s=new i,c=t.getBlobUrl();s.setFileType(this._getFileType(t)),s.setOnLoadedCallback((function(e){URL.revokeObjectURL(c),o.resolve(e.ambiance)}));let a=new n;if("true"===localStorage.getItem("CXPWeb_enableViewerForAmbience")&&this._object&&this._object._experienceBase){let e=this._object._experienceBase.getManager("CAT3DXVisuManager");e&&e.getViewer()&&e.getViewer().getRootNode()&&(a._occurrences[0].scene3js=e.getViewer().getRootNode()._occurrences[0].scene3js)}s.loadModel(c,a);return await o.promise},_getFileType:function(e){const t=e.getName();for(const e in this._typeExtMap)if(t.endsWith(e))return this._typeExtMap[e]},_typeExtMap:{".cgr":"cgr",".xcgr":"cgr",".3dxml":"xmlv43",".3dx":"3dx",".3dxc":"3dxc"}})}));