define("DS/ENODerivedFormatEssentials/Utils/DerivedFormatUtil",["DS/UIKIT/Alert","DS/UIKIT/Mask","DS/UIKIT/SuperModal","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/WAFData/WAFData","UWA/Promise","DS/Utilities/UUID"],(function(e,t,a,n,i,r,o){return{platformServices:null,maskView:function(e){document.getElementsByClassName("edfm-formatlistview")[0]&&!t.isMasked(document.getElementsByClassName("edfm-formatlistview")[0])?t.mask(document.getElementsByClassName("edfm-formatlistview")[0]):e&&!t.isMasked(e)&&t.mask(e)},maskTitleTabView:function(e){document.getElementsByClassName("edfm-namerule-listview")[0]&&!t.isMasked(document.getElementsByClassName("edfm-namerule-listview")[0])?t.mask(document.getElementsByClassName("edfm-namerule-listview")[0]):e&&!t.isMasked(e)&&t.mask(e)},unmaskView:function(){document.getElementsByClassName("edfm-formatlistview")[0]&&t.isMasked(document.getElementsByClassName("edfm-formatlistview")[0])&&t.unmask(document.getElementsByClassName("edfm-formatlistview")[0])},unmaskTitleTabView:function(){document.getElementsByClassName("edfm-namerule-listview")[0]&&t.isMasked(document.getElementsByClassName("edfm-namerule-listview")[0])&&t.unmask(document.getElementsByClassName("edfm-namerule-listview")[0])},alert:function(){return new e({visible:!0,autoHide:!0,hideDelay:3e3}).inject(document.getElementsByClassName("info-section")[0])},confimationModal:function(e,t){var n="";return"delete"==t?n=derivedformatmanagementinfra.getNLSData().label.deleteConfirm+"\n\n":"apply"==t&&(n=derivedformatmanagementinfra.getNLSData().label.applyConfirm+"\n\n"),n+=derivedformatmanagementinfra.getNLSData().label.confirmation,(new a).dialog({closable:!0,body:n,title:derivedformatmanagementinfra.getNLSData().label.warning,buttons:[{className:"primary",value:derivedformatmanagementinfra.getNLSData().button.yes,action:e},{value:derivedformatmanagementinfra.getNLSData().button.no,action:function(e){e.hide()}}]})},toggleTrigger(){(new a).dialog({closable:!0,body:derivedformatmanagementinfra.getNLSData().label.reloadCache,title:derivedformatmanagementinfra.getNLSData().label.important+":"})},get3DSpaceUrl:function(){return this.getPlatformURL("3DSpace")},getPlatformId:function(){return"undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise"},retrievePlatformUrl:function(){var e=this;return new r((function(t,a){null===e.platformServices?n.getPlatformServices({onComplete:function(a){e.platformServices=a,t()},onFailure:function(e){a(e)}}):t()}))},getTenantInfo:function(e){for(var t=this,a={},n=0;n<t.platformServices.length;n++)if(t.platformServices[n].platformId===e){a=t.platformServices[n];break}return a},getPlatformURL:function(e){var t=this;if(!UWA.is(t.platformServices,"array"))throw new Error("Platform services not initialize yet");var a=t.getPlatformId(),n=t.getTenantInfo(a);if(void 0===n[e])throw console.error("No "+e+" URL available for this tenant."),new Error("Unknown service "+e);return n[e]},sendServerRequest:function(e){var t=this,a={},n=derivedformatmanagementinfra.getSecurityContext();a.method=e.method,a.headers={Accept:"application/json","Accept-Language":widget.lang,"Content-Type":"application/json"},n&&(a.headers.SecurityContext=encodeURIComponent(n)),a.type="json",a.proxy="passport",a.timeout=void 0!==e.timeout?e.timeout:3e5,a.onComplete=e.onComplete,a.onFailure=e.onFailure,a.onTimeout=void 0!==e.onTimeout?e.onTimeout:e.onFailure;var r=e.data;a.data=JSON.stringify(r),t.retrievePlatformUrl().then((function(){var n=t.get3DSpaceUrl();i.authenticatedRequest(n+e.url,a)}))},server:function(e){var t={};t.headers={Accept:"application/json","Accept-Language":widget.lang,"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"};var a=widget.widgetDomain,n=e&&e.api?e.api:"",r={url:e.url||`${a}/resources/v1/collaboration${n}`,method:e.method||this.SERVER.VERB.GET,data:e.data,dataType:e.dataType||"json",timeout:e.timeout||5e5,cache:e.cache||3600,proxy:e.proxy||void 0,onComplete:e.onComplete,onFailure:e.onFailure,headers:e.headers&&UWA.merge(e.headers,t.headers)||t.headers};return i.authenticatedRequest(r.url,r)},getUserInformation:function(e){var t=this,a={};return new r((function(n,r){if(e){var o=t.getPlatformURL("3DSwym");t.getCSRFToken(o).then((function(t){return a.headers={"X-DS-SWYM-CSRFTOKEN":t},a.url=`${o}/api/user/find/login/${e}`,a.method="GET",a.timeout=5e5,a.onComplete=function(e){var t=JSON.parse(e).result,a=t.first_name+" "+t.last_name,i=t.ut_state;n({label:a,status:i})},a.onFailure=function(e){r(e)},i.authenticatedRequest(a.url,a)}))}}))},getCSRFToken:function(e){return new r((function(t,a){var n={};return n.url=`${e}/api/index/tk`,n.method="GET",n.timeout=5e5,n.onComplete=function(e){if(!e)return null;var a=JSON.parse(e).result.ServerToken;t(a)},n.onFailure=function(e){a(e)},i.authenticatedRequest(n.url,n)}))},unique:function(){return o.v4().substring(0,10).replaceAll("-","")}}}));