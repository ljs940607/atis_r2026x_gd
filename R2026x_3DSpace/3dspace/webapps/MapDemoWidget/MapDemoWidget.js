define("DS/MapDemoWidget/models/DisplayModeModelGetter",["require","exports"],(function(e,t){"use strict";return function(){function e(){}return e.getModel=function(t,o){switch(t){case"default":return e.getDefaultModel(o);case"bubble":return e.getBubbleModel(o);case"extent":return e.getExtentModel(o)}},e.getDefaultModel=function(e){return[{id:"clustering",label:"clustering",typeRepresentation:"boolean",value:e.clustering},{id:"maxClusterRadius",label:"Cluster radius",typeRepresentation:"integer",value:e.maxClusterRadius,visibleFlag:e.clustering,semantics:{units:"px"}},{id:"disableClusteringAtZoom",label:"Zoom Level deactivation",typeRepresentation:"integer",value:e.disableClusteringAtZoom,visibleFlag:e.clustering},{id:"zoomToBoundsOnClick",label:"Zoom on click",typeRepresentation:"boolean",visibleFlag:e.clustering,value:e.zoomToBoundsOnClick},{id:"animate",label:"Clustering animation",typeRepresentation:"boolean",visibleFlag:e.clustering,value:e.animate}]},e.getBubbleModel=function(e){var t,o;return[{id:"sizePropertyName",label:"Size Attribute",typeRepresentation:"string",value:e.sizePropertyName},{id:"maxValue",label:"Maximum Size",typeRepresentation:"number",value:e.maxValue},{id:"minValue",label:"Minimum Value",typeRepresentation:"number",value:e.minValue},{id:"opacity",label:"Opacity",typeRepresentation:"opacity",semantics:{minValue:0,maxValue:1,stepValue:.01},value:e.opacity},{id:"primaryColor",label:"Color",typeRepresentation:"color",value:e.primaryColor},{id:"scale",label:"Scale Factor",typeRepresentation:"number",value:e.scale},{id:"strokeColor",label:"Stroke Color",typeRepresentation:"color",value:e.strokeColor},{id:"strokeWidth",label:"Stroke Width",typeRepresentation:"number",value:e.strokeWidth},{id:"gradientSettingsFolder",label:"Gradient Settings",style:"expander",expandedFlag:!0,children:[{id:"colorPropertyName",label:"Color Property Name",typeRepresentation:"string",value:null===(t=e.gradiantSettings)||void 0===t?void 0:t.colorPropertyName},{id:"secondaryColor",label:"Secondary Color",typeRepresentation:"color",value:null===(o=e.gradiantSettings)||void 0===o?void 0:o.secondaryColor}]}]},e.getExtentModel=function(e){return[{id:"color",label:"Color",typeRepresentation:"color",value:e.color},{id:"strokeColor",label:"Stroke color",typeRepresentation:"color",value:e.strokeColor},{id:"strokeWidth",label:"Stroke width",typeRepresentation:"number",value:e.strokeWidth,semantics:{units:"px"}}]},e}()})),define("DS/MapDemoWidget/MapDemoUtils",["require","exports","DS/WebappsUtils/WebappsUtils","text!DS/Core/wux-3ds-fonticons.css"],(function(e,t,o,n){"use strict";return function(){function e(){}return e.readFileAsText=function(e){return new Promise((function(t,o){e||o();var n=new FileReader;n.onerror=o,n.onload=function(){return t({file:e,content:n.result})},n.readAsText(e)}))},e.extendToolbarModel=function(e,t){var o;return null===(o=null==t?void 0:t.entries)||void 0===o||o.forEach((function(t){var o,n=null==t?void 0:t.id;if(n&&e[n]){var i=null===(o=null==t?void 0:t.dataElements)||void 0===o?void 0:o.action;i&&(i.argument=e[n])}})),t},e.valueTransformer=function(e){return"string"==typeof e&&/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$/.test(e)?"#".concat(e):e},e.getFontIconsList=function(){return e.fontIconsList||(e.fontIconsList=e.generateFontIconsList()),e.fontIconsList},e.generateFontIconsList=function(){return n.match(/wux-ui-3ds-(.*):before/gi).map((function(e){var t=e.replace(/wux-ui-3ds-(.*):before/,"$1");return{value:t,icon:{iconName:t,fontIconFamily:1}}}))},e.imagesUrl=o.getWebappsBaseUrl()+"MapDemoWidget/assets/data/images/",e.getThumbnailURL=function(t){return e.imagesUrl+t},e}()}));var __extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/MapDemoWidget/views/MapDemoBaseView",["require","exports","DS/Controls/Abstract"],(function(e,t,o){"use strict";var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(t){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];this.map=t.map,this.controller=t,this.initView.apply(this,o),e.prototype.init.apply(this,o)},t}(o);return n}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/MapDemoWidget/views/MapDemoMiniMapView",["require","exports","DS/Controls/Abstract","DS/Core/WebUXComponents","DS/SocialGlobeAPI/GlobeAPI"],(function(e,t,o,n,i){"use strict";var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.buildView=function(){var e=this;this.elements.container.addClassName("mapDemoMiniMapView"),this.elements.container.id="MapDemoMiniMapView";var t=widget.getValue("x3dPlatformId")||"";setTimeout((function(){i.build("MapDemoMiniMapView",t,{initialCoordinates:e.currentCoordinates||[0,0],initialZoomLevel:1,tmsMaxLevel:9,tmsUrl:t?void 0:"https://tile.openstreetmap.org/"}).then((function(t){e.miniMap=t,e.currentLocation=e.miniMap.addMarker(e.currentCoordinates[0]||0,e.currentCoordinates[1]||0,"currentLocation","",{})}))}),1e3)},t.prototype.updateLocation=function(e,t){this.currentCoordinates=[e,t],this.currentLocation&&(this.currentLocation.setLat(e),this.currentLocation.setLng(t))},t}(o);return n.addClass(r,"MapDemoMiniMapView"),r}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();var __spreadArray=this&&this.__spreadArray||function(e,t,o){if(o||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};define("DS/MapDemoWidget/models/MapDemoFeaturesDocument",["require","exports","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel"],(function(e,t,o,n){"use strict";var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.addFeatures=function(e){var t=this;e&&Array.isArray(e)&&e.forEach((function(e){return t.addRoot(new n({label:e.getTitle(),icons:["marker"===e.getType()?"location":"flow-line"],value:e}))}))},t.prototype.removeFeatures=function(e){var t=this;e.forEach((function(e){var o=t.getFeatureNodeById(e.getId());t.removeRoot(o)}))},t.prototype.selectFeature=function(e){var t=this.getFeatureNodeById(null==e?void 0:e.getId());t&&this.getXSO().unique(t)},t.prototype.unselectFeature=function(e){this.getFeatureNodeById(null==e?void 0:e.getId())&&this.getXSO().empty()},t.prototype.featureEdited=function(e){var t=this.getFeatureNodeById(null==e?void 0:e.getId());null==t||t.updateOptions({label:e.getTitle()})},t.prototype.getPossibleValues=function(){return this.getRoots().map((function(e){var t;return{label:null==e?void 0:e.getLabel(),value:null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.value.getId()}}))},t.prototype.getPossibleProperties=function(){return this.getRoots().reduce((function(e,t){var o,n,i=Object.keys((null===(n=null===(o=null==t?void 0:t.options)||void 0===o?void 0:o.value)||void 0===n?void 0:n.get("properties"))||{});return Array.from(new Set(__spreadArray(__spreadArray([],i,!0),e,!0)))}),[])},t.prototype.getPropertyMinMax=function(e){return this.getRoots().reduce((function(t,o){var n,i,r=null===(i=null===(n=null==o?void 0:o.options)||void 0===n?void 0:n.value)||void 0===i?void 0:i.get("properties")[e];return{min:Math.min(t.min,r),max:Math.max(t.max,r)}}),{min:1/0,max:-1/0})},t.prototype.getFeatureById=function(e){var t,o;return null===(o=null===(t=null==this?void 0:this.getFeatureNodeById(e))||void 0===t?void 0:t.options)||void 0===o?void 0:o.value},t.prototype.getFeatureNodeById=function(e){var t=this.search({match:function(t){var o,n,i;return e===(null===(i=null===(n=null===(o=null==t?void 0:t.nodeModel)||void 0===o?void 0:o.options)||void 0===n?void 0:n.value)||void 0===i?void 0:i.getId())}});return t&&t[0]},t}(o);return i}));var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))},__generator=this&&this.__generator||function(e,t){var o,n,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(s){return function(l){if(o)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(o=1,n&&(i=2&l[0]?n.return:l[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,l[1])).done)return i;switch(n=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{o=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};define("DS/MapDemoWidget/ExtentDemoWidget",["require","exports","DS/SocialGlobeAPI/GlobeAPI","DS/Core/Core","UWA/Core","DS/Windows/ImmersiveFrame","DS/Windows/Panel","DS/Core/WebUXGlobalEnums","DS/Form/Form","text!DS/MapDemoWidget/assets/data/ExtentDemoDepartments.geojson","text!DS/MapDemoWidget/assets/data/WFSServerSample.json","text!DS/MapDemoWidget/assets/data/authorizedEpsgSample.json","css!DS/MapDemoWidget/MapDemoWidget.css"],(function(e,t,o,n,i,r,a,l,s,u,c,d){"use strict";return function(){function e(){var t=this;this.init=function(){return __awaiter(t,void 0,void 0,(function(){var t,p,m,v,f,h,g,y,M,D,b;return __generator(this,(function(_){switch(_.label){case 0:return n.setFullscreen(),(t=(new r).inject(widget.body)).getContent().style.backgroundColor="white",p=[0,0],m=i.createElement("div",{id:"mapPanelContent",class:"mapPanelContent",html:"\n        <div class='mapContainer' id ='mapContainer'></div>\n      "}),new a(__assign(__assign({},v={immersiveFrame:t,resizableFlag:!0,closeButtonFlag:!1}),{identifier:"MapComponent",title:"Map Component",icon:"map",content:m,usePaddingFlag:!1,maximizedFlag:!0,maximizeButtonFlag:!0})),f=widget.getValue("x3dPlatformId")||"",[4,o.build("mapContainer",f,{initialCoordinates:p,initialZoomLevel:2,initialMaxLevel:18,tmsUrl:f?void 0:"https://tile.openstreetmap.org/"})];case 1:return h=_.sent(),g=__assign(__assign({},v),{minWidth:400,verticallyStretchableFlag:!0,currentDockArea:l.WUXDockAreaEnum.LeftDockArea}),y=new s({globalInformation:{text:"Choose an item in the list",emphasize:"info",icon:"info"},model:[{id:"departments",label:"French Departments",typeRepresentation:"string"},{id:"wfs_sample",label:"WFS Server Sample",typeRepresentation:"string"},{id:"epsg_samples",label:"EPSG Samples",typeRepresentation:"string"}],readOnly:!1,buttons:[],onModelUpdate:function(t){var o,n,i=t.value;switch(t.id){case"departments":var r=M.find((function(e){return e.code===i}));o=r.value[0],n=r.value[2];break;case"wfs_sample":var a=D.find((function(e){return e.code===i}));o=a.value.LowerCorner,n=a.value.UpperCorner;break;case"epsg_samples":var l=b.find((function(e){return e.code===i}));o=[l.value[0],l.value[1]],n=[l.value[2],l.value[3]]}e.updateExtent(h,o,n)}}),M=JSON.parse(u).features.map((function(e){return{code:e.properties.code,label:e.properties.nom,value:e.geometry.coordinates[0]}})),y.updateModelItem("departments",{value:void 0,semantics:{possibleValues:M.map((function(e){return{label:e.label,value:e.code}}))}}),D=JSON.parse(c).WFS_Capabilities.FeatureTypeList.map((function(e){return{code:e.Name,label:e.Title,value:e.WGS84BoundingBox}})),y.updateModelItem("wfs_sample",{value:void 0,semantics:{possibleValues:D.map((function(e){return{label:e.label,value:e.code}}))}}),b=JSON.parse(d).map((function(e){return{code:e.code,label:"".concat(e.code," - ").concat(e.name),value:e.wgs84BBox}})),y.updateModelItem("epsg_samples",{value:void 0,semantics:{possibleValues:b.map((function(e){return{label:e.label,value:e.code}}))}}),new a(__assign(__assign({},g),{identifier:"UI Controls",title:"UI Controls",icon:"cog",content:y})),[2]}}))}))}}return e.updateExtent=function(e,t,o){e.display("default"),e.reset(),e.addMarker(t[1],t[0],"min","",{}),e.addMarker(o[1],o[0],"max","",{}),e.fitBounds([[t[1],t[0]],[o[1],o[0]]],{animate:!1}),e.getZoomLvl("mapContainer")>2&&e.zoomOut({viewerId:"mapContainer",animate:!1}),e.display("extent",{color:"#FF0000",strokeColor:"#FF0000"})},e}()})),define("DS/MapDemoWidget/type/Options",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign.apply(this,arguments)};define("DS/MapDemoWidget/views/MapDemoMarkerEditorView",["require","exports","DS/MapDemoWidget/views/MapDemoBaseView","DS/Core/WebUXComponents","DS/Form/Form","DS/MapDemoWidget/MapDemoUtils","text!DS/MapDemoWidget/assets/models/MapDemoMarkerEditorViewModel.json"],(function(e,t,o,n,i,r,a){"use strict";var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"currentMarker",{get:function(){return this._currentMarker},set:function(e){this._currentMarker=e,this.updateInternalView()},enumerable:!1,configurable:!0}),t.prototype.initView=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];this.createMode=e||!1},t.prototype.buildView=function(){var e=this;this.elements.container.addClassName("mapDemoMarkerEditorView");var t=JSON.parse(a);this.createMode||(t.globalInformation=void 0),t.onModelUpdate=function(e){var t,o,n,i,a=null==e?void 0:e.id,l=r.valueTransformer(null==e?void 0:e.value),s=null===(n=null===(o=null===(t=null==this?void 0:this.elements)||void 0===t?void 0:t.container)||void 0===o?void 0:o.getParent())||void 0===n?void 0:n.dsModel,u=null==s?void 0:s.currentMarker;if(u){if(["title","lat","lng","desc","color","icon","visible"].includes(a))u["set".concat(a.charAt(0).toUpperCase()+a.slice(1))](l);else{if(["notificationText","notificationColor"].includes(a)){var c=__assign({},u.getNotification());c["notificationText"===a?"text":"color"]=l,u.setNotification(c)}if(["badgeIcon","badgeColor"].includes(a)){var d=__assign({},u.getBadge());d["badgeIcon"===a?"icon":"color"]=l,u.setBadge(d)}if(["popupTrigger","popupContent"].includes(a)){var p=__assign({},u.getPopup());p["popupTrigger"===a?"trigger":"content"]=l,u.setPopup(p)}}"title"===a&&(null===(i=null==s?void 0:s.controller)||void 0===i||i.publish({event:"/MapDemoWidget/markerEdited",data:u}))}},t.onModelLiveUpdate=function(e){var t,o,n,i=null==e?void 0:e.id,a=r.valueTransformer(null==e?void 0:e.value),l=null===(n=null===(o=null===(t=null==this?void 0:this.elements)||void 0===t?void 0:t.container)||void 0===o?void 0:o.getParent())||void 0===n?void 0:n.dsModel,s=null==l?void 0:l.currentMarker;if(s)switch(i){case"color":s.setColor(a);break;case"notificationColor":s.setNotification(__assign(__assign({},s.getNotification()),{color:a}));break;case"badgeColor":s.setBadge(__assign(__assign({},s.getBadge()),{color:a}))}},this.form=new i(t),this.form.updateModelItem("icon",{value:void 0,semantics:{possibleValues:r.getFontIconsList()}}),this.form.updateModelItem("badgeIcon",{value:void 0,semantics:{possibleValues:r.getFontIconsList()}}),this.form.inject(this.elements.container),this.createMode&&this.controller.subscribe({event:"/MapDemoWidget/onClick"},(function(t){e.form.updateModelItem("lat",{value:t.lat}),e.form.updateModelItem("lng",{value:t.lon})}))},t.prototype.updateInternalView=function(){var e=this;if(this.currentMarker&&this.form){var t=this.currentMarker,o=(t.getEditable(),t.getNotification()),n=t.getBadge(),i=t.getPopup();[["title",t.getTitle()],["lat",t.getLat()],["lng",t.getLng()],["desc",t.getDesc()],["icon",t.getIcon()],["color",t.getColor()],["notificationText",null==o?void 0:o.text],["notificationColor",null==o?void 0:o.color],["badgeIcon",(null==n?void 0:n.icon)?n.icon:void 0],["badgeColor",null==n?void 0:n.color],["popupTrigger",null==i?void 0:i.trigger],["popupContent",null==i?void 0:i.content]].forEach((function(t){e.form.updateModelItem(t[0],{value:t[1]})}))}},t}(o);return n.addClass(l,"MapDemoMarkerEditorView"),l}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign.apply(this,arguments)};define("DS/MapDemoWidget/views/MapDemoLinkEditorView",["require","exports","DS/MapDemoWidget/views/MapDemoBaseView","DS/Core/WebUXComponents","DS/Form/Form","DS/MapDemoWidget/MapDemoUtils","text!DS/MapDemoWidget/assets/models/MapDemoLinkEditorViewModel.json"],(function(e,t,o,n,i,r,a){"use strict";var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"currentLink",{get:function(){return this._currentLink},set:function(e){this._currentLink=e,this.updateInternalView()},enumerable:!1,configurable:!0}),t.prototype.initView=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];this.createMode=e||!1},t.prototype.buildView=function(){this.elements.container.addClassName("mapDemoLinkEditorView");var e=JSON.parse(a);this.createMode||(e.globalInformation=void 0),e.onModelUpdate=function(e){var t,o,n,i,a,l=null==e?void 0:e.id,s=r.valueTransformer(null==e?void 0:e.value),u=null===(n=null===(o=null===(t=null==this?void 0:this.elements)||void 0===t?void 0:t.container)||void 0===o?void 0:o.getParent())||void 0===n?void 0:n.dsModel,c=null==u?void 0:u.currentLink;if(c&&(["origin","destination"].includes(l)&&(s=null===(i=null==u?void 0:u.controller)||void 0===i?void 0:i.markersDocument.getFeatureById(s)),["title","origin","destination","desc","color","bidirectional","icon","pattern","weight","opacity"].includes(l)&&c["set".concat(l.charAt(0).toUpperCase()+l.slice(1))](s),"title"===l&&(null===(a=null==u?void 0:u.controller)||void 0===a||a.publish({event:"/MapDemoWidget/linkEdited",data:c})),["popupTrigger","popupContent"].includes(l))){var d=__assign({},c.getPopup());d["popupTrigger"===l?"trigger":"content"]=s,c.setPopup(d)}},e.onModelLiveUpdate=function(e){var t,o,n,i=null==e?void 0:e.id,a=r.valueTransformer(null==e?void 0:e.value),l=null===(n=null===(o=null===(t=null==this?void 0:this.elements)||void 0===t?void 0:t.container)||void 0===o?void 0:o.getParent())||void 0===n?void 0:n.dsModel,s=null==l?void 0:l.currentLink;if(s)switch(i){case"color":s.setColor(a);break;case"opacity":s.setOpacity(a)}},this.form=new i(e),this.form.updateModelItem("icon",{value:void 0,semantics:{possibleValues:r.getFontIconsList()}}),this.form.updateModelItem("origin",{semantics:{possibleValues:this.controller.markersDocument.getPossibleValues()}}),this.form.updateModelItem("destination",{semantics:{possibleValues:this.controller.markersDocument.getPossibleValues()}}),this.form.inject(this.elements.container)},t.prototype.updateInternalView=function(){var e=this;if(this.currentLink&&this.form){var t=this.currentLink,o=(t.getEditable(),t.getPopup());[["title",t.getTitle()],["origin",t.getOrigin().getId()],["destination",t.getDestination().getId()],["desc",t.getDesc()],["color",t.getColor()],["bidirectional",t.getBidirectional()],["icon",t.getIcon()],["pattern",t.getPattern()],["weight",t.getWeight()],["opacity",t.getOpacity()],["popupTrigger",null==o?void 0:o.trigger],["popupContent",null==o?void 0:o.content]].forEach((function(t){e.form.updateModelItem(t[0],{value:t[1]})}))}},t}(o);return n.addClass(l,"MapDemoLinkEditorView"),l})),define("DS/MapDemoWidget/commands/MapDemoToolbarFunctions",["require","exports","DS/Windows/Dialog","DS/Controls/Button","DS/MapDemoWidget/views/MapDemoMarkerEditorView","DS/MapDemoWidget/views/MapDemoLinkEditorView","DS/MapDemoWidget/MapDemoUtils"],(function(e,t,o,n,i,r,a){"use strict";return function(){function e(){}return e.moveTo=function(e){var t,o,n,i,r,a,l,s=null===(o=null===(t=null==e?void 0:e.context)||void 0===t?void 0:t.executionContext)||void 0===o?void 0:o.form,u=null===(r=null===(i=null===(n=null==e?void 0:e.context)||void 0===n?void 0:n.executionContext)||void 0===i?void 0:i.controller)||void 0===r?void 0:r.map,c=0,d=0;(null==e?void 0:e.coordinates)?(c=null==e?void 0:e.coordinates[0],d=null==e?void 0:e.coordinates[1],s.updateModelItem("lat",{value:c}),s.updateModelItem("lon",{value:d})):(c=null===(a=null==s?void 0:s.getModelItem("lat"))||void 0===a?void 0:a.value,d=null===(l=null==s?void 0:s.getModelItem("lon"))||void 0===l?void 0:l.value),null==u||u.moveCamera(c,d,(null==e?void 0:e.zoomLevel)?{zoomLevel:e.zoomLevel}:void 0)},e.reset=function(e){var t,o,n,i,r,a,l,s,u;null===(o=null===(t=null==e?void 0:e.context)||void 0===t?void 0:t.toolbar)||void 0===o||o.updateNodeModel("loadGeoJson",{grid:{data:void 0}}),null===(a=null===(r=null===(i=null===(n=null==e?void 0:e.context)||void 0===n?void 0:n.executionContext)||void 0===i?void 0:i.controller)||void 0===r?void 0:r.map)||void 0===a||a.reset(),null===(u=null===(s=null===(l=null==e?void 0:e.context)||void 0===l?void 0:l.executionContext)||void 0===s?void 0:s.markersDocument)||void 0===u||u.empty()},e.deleteFeature=function(e){var t,o,n,i,r=null===(o=null===(t=null==e?void 0:e.context)||void 0===t?void 0:t.executionContext)||void 0===o?void 0:o.controller,a=null==r?void 0:r.map,l=null===(i=null===(n=null==e?void 0:e.context)||void 0===n?void 0:n.executionContext)||void 0===i?void 0:i.currentFeature;switch(l.getType()){case"marker":r.publish({event:"/MapDemoWidget/removeMarkers",data:[l]}),null==a||a.removeMarker(l);break;case"link":r.publish({event:"/MapDemoWidget/removeLinks",data:[l]}),null==a||a.removeLink(l)}},e.createMarker=function(e){var t,r,l,s,u=null===(r=null===(t=null==e?void 0:e.context)||void 0===t?void 0:t.executionContext)||void 0===r?void 0:r.immersiveFrame,c=null===(s=null===(l=null==e?void 0:e.context)||void 0===l?void 0:l.executionContext)||void 0===s?void 0:s.controller,d=(null==c||c.map,new i(c,!0)),p=new o({title:"Create New Marker",identifier:"createMarkerViewDialog",icon:{iconName:"location",fontIconFamily:1},content:d.getContent(),immersiveFrame:u,buttons:{Ok:new n({onClick:function(e){var t,o,n,i,r,l,s,u,m,v,f,h,g=d.form,y=c.map.addMarker(null===(t=null==g?void 0:g.getModelItem("lat"))||void 0===t?void 0:t.value,null===(o=null==g?void 0:g.getModelItem("lng"))||void 0===o?void 0:o.value,null===(n=null==g?void 0:g.getModelItem("title"))||void 0===n?void 0:n.value,null===(i=null==g?void 0:g.getModelItem("desc"))||void 0===i?void 0:i.value,{icon:null===(r=null==g?void 0:g.getModelItem("icon"))||void 0===r?void 0:r.value,color:a.valueTransformer(null===(l=null==g?void 0:g.getModelItem("color"))||void 0===l?void 0:l.value),notification:{text:null===(s=null==g?void 0:g.getModelItem("notificationText"))||void 0===s?void 0:s.value,color:a.valueTransformer(null===(u=null==g?void 0:g.getModelItem("notificationColor"))||void 0===u?void 0:u.value)},badge:{icon:null===(m=null==g?void 0:g.getModelItem("badgeText"))||void 0===m?void 0:m.value,color:a.valueTransformer(null===(v=null==g?void 0:g.getModelItem("badgeColor"))||void 0===v?void 0:v.value)},popup:{trigger:null===(f=null==g?void 0:g.getModelItem("popupTrigger"))||void 0===f?void 0:f.value,content:null===(h=null==g?void 0:g.getModelItem("popupContent"))||void 0===h?void 0:h.value}});c.publish({event:"/MapDemoWidget/addMarkers",data:[y]}),p.close()}}),Cancel:new n({onClick:function(){p.close()}})}})},e.createLink=function(e){var t,i,l,s,u=null===(i=null===(t=null==e?void 0:e.context)||void 0===t?void 0:t.executionContext)||void 0===i?void 0:i.immersiveFrame,c=null===(s=null===(l=null==e?void 0:e.context)||void 0===l?void 0:l.executionContext)||void 0===s?void 0:s.controller,d=null==c?void 0:c.map,p=new r(c,!0);null==d||d.setEditMode("link");var m=new o({title:"Create New Link",identifier:"createLinkDialog",icon:{iconName:"location",fontIconFamily:1},content:p.getContent(),immersiveFrame:u,buttons:{Ok:new n({onClick:function(e){var t,o,n,i;c.map.setEditMode("default");var r=p.form,l=null===(t=null==r?void 0:r.getModelItem("origin"))||void 0===t?void 0:t.value,s=null===(o=null==r?void 0:r.getModelItem("destination"))||void 0===o?void 0:o.value,u=null===(n=null==c?void 0:c.markersDocument)||void 0===n?void 0:n.getFeatureById(l),d=null===(i=null==c?void 0:c.markersDocument)||void 0===i?void 0:i.getFeatureById(s);if(u&&d){var v={};["title","desc","color","bidirectional","icon","pattern","weight","opacity"].forEach((function(e){var t;v[e]=a.valueTransformer(null===(t=null==r?void 0:r.getModelItem(e))||void 0===t?void 0:t.value)}));var f=c.map.addLink([u,d],v);c.publish({event:"/MapDemoWidget/addLinks",data:[f]})}m.close()}}),Cancel:new n({onClick:function(){c.map.setEditMode("default"),m.close()}})}})},e}()}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/MapDemoWidget/views/MapDemoPropertiesView",["require","exports","DS/MapDemoWidget/views/MapDemoBaseView","DS/Core/WebUXComponents","DS/Tweakers/GeneratedToolbar","DS/MapDemoWidget/views/MapDemoMarkerEditorView","DS/MapDemoWidget/views/MapDemoLinkEditorView"],(function(e,t,o,n,i,r,a){"use strict";var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initView=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.buildView=function(){var e=this;this.elements.container.addClassName("mapDemoPropertiesView"),this.toolbar=new i({executionContext:this,items:i.prototype.createTreeDocument({entries:[{id:"info",dataElements:{typeRepresentation:"detailedInfo",value:{label:"No Entity Selected"}},readOnly:!0,position:"near"},{id:"deleteFeature",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"trash",fontIconFamily:1},action:{module:"DS/MapDemoWidget/commands/MapDemoToolbarFunctions",func:"deleteFeature",argument:{feature:this.currentFeature}},disabled:!0,position:"far"}}]})}),this.controller.map.setOnSelectCallback(this.onSelectCB.bind(this)),[["/MapDemoWidget/selectFeature",function(t){return e.onSelectCB(t)}],["/MapDemoWidget/unselectMarker",function(t){return e.onUnselectCB(t)}],["/MapDemoWidget/markerEdited",function(t){return e.updateFeatureInfo(t)}],["/MapDemoWidget/removeMarkers",function(t){return e.clearSelection()}],["/MapDemoWidget/removeLinks",function(t){return e.clearSelection()}]].forEach((function(t){var o;null===(o=null==e?void 0:e.controller)||void 0===o||o.subscribe({event:t[0]},t[1])})),this.toolbar.inject(this.elements.container)},t.prototype.updateFeatureInfo=function(e){var t=e.getType();this.toolbar.updateNodeModel("info",{grid:{data:{label:e.getTitle(),icon:"marker"===t?"location":"flow-line"}}})},t.prototype.onSelectCB=function(e){switch(this.currentFeature=e,this.updateFeatureInfo(this.currentFeature),this.toolbar.updateNodeModel("deleteFeature",{disabled:!1}),e.setOnUnSelectCallback(this.onUnselectCB.bind(this)),e.getType()){case"marker":!this.internalView||this.internalView instanceof r||this.removeInternalView(),this.internalView||(this.internalView=new r(this.controller),this.internalView.inject(this.elements.container)),this.internalView.currentMarker=e;break;case"link":!this.internalView||this.internalView instanceof a||this.removeInternalView(),this.internalView||(this.internalView=new a(this.controller),this.internalView.inject(this.elements.container),this.internalView.currentLink=e)}},t.prototype.onUnselectCB=function(e){e===this.currentFeature&&this.clearSelection()},t.prototype.removeInternalView=function(){this.internalView&&(this.internalView.remove(),this.internalView.destroy(),this.internalView=void 0)},t.prototype.clearSelection=function(){this.toolbar.updateNodeModel("info",{grid:{data:{label:"No Entity Selected",icon:void 0,subLabel:void 0}}}),this.removeInternalView(),this.toolbar.updateNodeModel("deleteFeature",{disabled:!0})},t}(o);return n.addClass(l,"MapDemoPropertiesView"),l}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/MapDemoWidget/controllers/MapDemoController",["require","exports","DS/MapDemoWidget/models/MapDemoFeaturesDocument","DS/CoreEvents/ModelEvents","DS/MapDemoWidget/MapDemoUtils","DS/VENTurfJS/turf.min"],(function(e,t,o,n,i,r){"use strict";return function(e){function t(t){var n=e.call(this)||this;return n.markersDocument=new o,n.linksDocument=new o,n.map=t,n.map.setOnClickCallback((function(e,t){return n.publish({event:"/MapDemoWidget/onClick",data:{lat:e,lon:t}})})),n}return __extends(t,e),t.prototype.loadMarkers=function(e){var t=this;e&&i.readFileAsText(e).then((function(e){var o=JSON.parse(e.content),n=r.bbox(o);t.map.fitBounds([[n[1],n[0]],[n[3],n[2]]]);var i=t.map.addGeoJson(o);t.markersDocument.addFeatures(i)}))},t}(n)}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/MapDemoWidget/views/MapDemoInfoView",["require","exports","DS/MapDemoWidget/views/MapDemoBaseView","DS/Core/WebUXComponents","DS/Form/Form","DS/Tweakers/GeneratedToolbar","DS/MapDemoWidget/MapDemoUtils","DS/MapDemoWidget/views/MapDemoMiniMapView","text!DS/MapDemoWidget/assets/models/MapDemoInfoViewModel.json"],(function(e,t,o,n,i,r,a,l,s){"use strict";var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initView=function(e,t){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];this.homeCoordinates=[e,t]},t.prototype.updateLocation=function(e,t){this.form.updateModelItem("lat",{value:e}),this.form.updateModelItem("lon",{value:t}),this.miniMap.updateLocation(e,t)},t.prototype.buildView=function(){var e=this;this.elements.container.addClassName("mapDemoInfoView");var t=JSON.parse(s);this.toolbar=new r({executionContext:this,items:r.prototype.createTreeDocument(a.extendToolbarModel({home:{coordinates:this.homeCoordinates,zoomLevel:12}},t.toolbarModel))}),this.toolbar.inject(this.elements.container),this.form=new i(t.formModel),this.form.inject(this.elements.container),this.miniMap=new l,this.miniMap.inject(this.elements.container),this.updateLocation(this.homeCoordinates[0],this.homeCoordinates[1]),this.controller.subscribe({event:"/MapDemoWidget/onClick"},(function(t){return e.updateLocation(t.lat,t.lon)})),this.controller.subscribe({event:"/MapDemoWidget/selectFeature"},(function(t){"marker"===t.getType()&&e.updateLocation(t.getLat(),t.getLng())}))},t}(o);return n.addClass(u,"mapDemoInfoView"),u}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/MapDemoWidget/views/MapDemoLinksView",["require","exports","DS/MapDemoWidget/views/MapDemoBaseView","DS/Core/WebUXComponents","DS/Tweakers/GeneratedToolbar","DS/DataGridView/DataGridView"],(function(e,t,o,n,i,r){"use strict";var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initView=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];this.immersiveFrame=e},t.prototype.buildView=function(){var e,t,o=this;this.elements.container.addClassName("mapDemoLinksView"),this.toolbar=new i({executionContext:this,items:i.prototype.createTreeDocument({entries:[{id:"createLink",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"plus",fontIconFamily:1},action:{module:"DS/MapDemoWidget/commands/MapDemoToolbarFunctions",func:"createLink",argument:{map:this.map}},position:"far"}},{id:"reset",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"reset",fontIconFamily:1},action:{module:"DS/MapDemoWidget/commands/MapDemoToolbarFunctions",func:"reset",argument:{map:this.map}}},position:"far"}]})}),this.toolbar.inject(this.elements.container),this.linksDocument=this.controller.linksDocument,this.linksCollection=new r({placeholder:"Create or Load Links here!",treeDocument:this.linksDocument,showAlternateBackgroundFlag:!1,rowSelection:"single",cellSelection:"none",columns:[{dataIndex:"tree",typeRepresentation:"string"}]});var n=this.linksCollection.layout;n.rowsHeader=!1,n.columnsHeader=!1,this.linksCollection.inject(this.elements.container),[["/MapDemoWidget/addLinks",function(e){return o.linksDocument.addFeatures(e)}],["/MapDemoWidget/selectfeature",function(e){return null==e?void 0:e.select()}],["/MapDemoWidget/linkEdited",function(e){return o.linksDocument.featureEdited(e)}],["/MapDemoWidget/removeLinks",function(e){return o.linksDocument.removeFeatures(e)}]].forEach((function(e){var t;null===(t=null==o?void 0:o.controller)||void 0===t||t.subscribe({event:e[0]},e[1])})),null===(t=null===(e=this.linksCollection)||void 0===e?void 0:e.getNodesXSO())||void 0===t||t.onPostAdd((function(e){var t,n,i;if(e&&e[0]){var r=null===(n=null===(t=e[0])||void 0===t?void 0:t.options)||void 0===n?void 0:n.value;r&&(r.select(),null===(i=null==o?void 0:o.controller)||void 0===i||i.publish({event:"/MapDemoWidget/selectFeature",data:r}))}}))},t}(o);return n.addClass(a,"MapDemoLinksView"),a}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign.apply(this,arguments)};define("DS/MapDemoWidget/views/MapDemo3DSOfficesView",["require","exports","DS/MapDemoWidget/views/MapDemoBaseView","DS/Core/WebUXComponents","DS/TreeModel/TreeDocument","DS/CollectionView/ResponsiveLargeTilesCollectionView","text!DS/MapDemoWidget/assets/data/MapDemo3DSOffices.json"],(function(e,t,o,n,i,r,a){"use strict";var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initView=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.buildView=function(){var e=this;this.elements.container.addClassName("mapDemo3DSOfficesView"),this.officesCollection=new r({selectionBehavior:{canMultiSelect:!1}}),this.officesDocument=new i,this.officesDocument.loadModel(JSON.parse(a).map((function(e){return __assign(__assign({},e),{icons:["location"],statusbarIcons:["lock"],emptyStatusbarVisibleFlag:!0})}))),this.officesCollection.loadApplicativeModel(this.officesDocument),this.officesCollection.inject(this.elements.container),this.officesCollection.onSelectionAdd((function(t){var o=null==t?void 0:t.options;e.controller.publish({event:"/MapDemoWidget/displayModeSelected",data:"default"}),e.currentMarker&&(e.controller.map.removeMarker(e.currentMarker),e.controller.publish({event:"/MapDemoWidget/removeMarkers",data:[e.currentMarker]})),e.controller.map.moveCamera(o.coordinates[0],o.coordinates[1],{zoomLevel:18}),e.currentMarker=e.controller.map.addMarker(o.coordinates[0],o.coordinates[1],o.label,o.subLabel,{popup:{content:o.label}}),e.currentMarker.setEditable(!1),e.controller.publish({event:"/MapDemoWidget/addMarkers",data:[e.currentMarker]}),setTimeout((function(){e.currentMarker.select(),e.controller.publish({event:"/MapDemoWidget/selectFeature",data:e.currentMarker})}),1800)}))},t}(o);return n.addClass(l,"MapDemo3DSOfficesView"),l}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/MapDemoWidget/views/MapDemoUIControls",["require","exports","DS/MapDemoWidget/views/MapDemoBaseView","DS/Core/WebUXComponents","DS/Controls/Button","UWA/Core"],(function(e,t,o,n,i,r){"use strict";var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initView=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.buildView=function(){var e=this;if(this.elements.container.addClassName("mapDemoUIControls"),navigator.geolocation&&"https:"===location.protocol){var t=r.createElement("div",{class:"mapDemoUserLocDiv"}).inject(this.elements.container);new i({icon:{iconName:"location",fontIconFamily:1},displayStyle:"lite",onClick:function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(t){return e.controller.map.moveCamera(t.coords.latitude,t.coords.longitude,{zoomLevel:17})}),(function(e){return console.log(e)}))}}).inject(t)}},t}(o);return n.addClass(a,"MapDemoUIControls"),a}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/MapDemoWidget/views/MapDemoDisplayModesView",["require","exports","DS/MapDemoWidget/views/MapDemoBaseView","DS/Core/WebUXComponents","DS/TreeModel/TreeDocument","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/MapDemoWidget/MapDemoUtils"],(function(e,t,o,n,i,r,a){"use strict";var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initView=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.buildView=function(){var e=this;this.elements.container.addClassName("mapDemoDisplayModesView"),this.displayModesCollection=new r({selectionBehavior:{canMultiSelect:!1}}),this.displayModesDocument=new i,this.displayModesDocument.loadModel([{label:"Default",thumbnail:a.getThumbnailURL("displayMode_Default.jpg"),icons:[{iconName:"eye-cog",fontIconFamily:1}],subLabel:"Display Mode",description:"Default visualization mode to navigate through loaded data.",value:"default"},{label:"Bubble Map",thumbnail:a.getThumbnailURL("displayMode_BubbleMap.jpg"),icons:[{iconName:"eye-cog",fontIconFamily:1}],subLabel:"Display Mode",description:"Use circles of different size to represent a numeric value on a territory.",value:"bubble"},{label:"Extent",thumbnail:a.getThumbnailURL("displayMode_BubbleMap.jpg"),icons:[{iconName:"eye-cog",fontIconFamily:1}],subLabel:"Display Mode",description:"Get the extent of the loaded markers.",value:"extent"}]),this.displayModesCollection.loadApplicativeModel(this.displayModesDocument),this.displayModesCollection.inject(this.elements.container),this.displayModesCollection.getNodesXSO().add(this.displayModesDocument.getRoots()[0]),this.displayModesCollection.onSelectionAdd((function(t){var o,n=null==t?void 0:t.options;null===(o=null==e?void 0:e.controller)||void 0===o||o.publish({event:"/MapDemoWidget/displayModeSelected",data:n.value})}))},t}(o);return n.addClass(l,"MapDemoDisplayModesView"),l}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();define("DS/MapDemoWidget/views/MapDemoMarkersView",["require","exports","DS/MapDemoWidget/views/MapDemoBaseView","DS/Core/WebUXComponents","DS/Tweakers/GeneratedToolbar","DS/DataGridView/DataGridView"],(function(e,t,o,n,i,r){"use strict";var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initView=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];this.immersiveFrame=e},t.prototype.buildView=function(){var e,t,o,n,a=this;this.elements.container.addClassName("mapDemoMarkersView"),this.toolbar=new i({executionContext:this,items:i.prototype.createTreeDocument({entries:[{id:"loadGeoJson",dataElements:{typeRepresentation:"file",placeholder:"Select a Geojson file",fileTypes:".json, .geojson",allowMultipleValuesFlag:!1},position:"near",onNodeUpdate:function(e){var t,o,n=null==e?void 0:e.getAttributeValue("data");null===(o=null===(t=null==this?void 0:this.executionContext)||void 0===t?void 0:t.controller)||void 0===o||o.loadMarkers(n)}},{id:"createMarker",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"plus",fontIconFamily:1},action:{module:"DS/MapDemoWidget/commands/MapDemoToolbarFunctions",func:"createMarker"},position:"far"}},{id:"reset",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"reset",fontIconFamily:1},action:{module:"DS/MapDemoWidget/commands/MapDemoToolbarFunctions",func:"reset"}},position:"far"}]})}),this.toolbar.inject(this.elements.container),this.markersDocument=this.controller.markersDocument,this.markersCollection=new r({placeholder:"",treeDocument:void 0,showAlternateBackgroundFlag:!1,rowSelection:"single",cellSelection:"none",columns:[{dataIndex:"tree",typeRepresentation:"string"}]});var l=this.markersCollection.layout;l.rowsHeader=!1,l.columnsHeader=!1,this.markersCollection.treeDocument=this.markersDocument,this.markersCollection.placeholder="Create or Load Markers here!",this.markersCollection.inject(this.elements.container),[["/MapDemoWidget/addMarkers",function(e){a.markersDocument.addFeatures(e),e.forEach((function(e){e.setOnSelectCallback((function(){return a.markersDocument.selectFeature(e)})),e.setOnUnSelectCallback((function(){return a.markersDocument.unselectFeature(e)}))}))}],["/MapDemoWidget/removeMarkers",function(e){return a.markersDocument.removeFeatures(e)}],["/MapDemoWidget/selectFeature",function(e){return null==e?void 0:e.select()}],["/MapDemoWidget/markerEdited",function(e){return a.markersDocument.featureEdited(e)}],["/MapDemoWidget/markerSelected",function(e){return a.markersDocument.selectFeature(e)}]].forEach((function(e){var t;null===(t=null==a?void 0:a.controller)||void 0===t||t.subscribe({event:e[0]},e[1])})),null===(t=null===(e=this.markersCollection)||void 0===e?void 0:e.getNodesXSO())||void 0===t||t.onPostAdd((function(e){var t,o;if(e&&e[0]){var n=null===(o=null===(t=e[0])||void 0===t?void 0:t.options)||void 0===o?void 0:o.value;n&&(n.select(),a.controller.publish({event:"/MapDemoWidget/selectFeature",data:n}),a.controller.map.moveCamera(n.getLat(),n.getLng(),{outOnly:!0}))}})),null===(n=null===(o=this.markersCollection)||void 0===o?void 0:o.getNodesXSO())||void 0===n||n.onPostRemove((function(e){var t,o;if(e&&e[0]){var n=null===(o=null===(t=e[0])||void 0===t?void 0:t.options)||void 0===o?void 0:o.value;n&&(n.unSelect(),a.controller.publish({event:"/MapDemoWidget/unselectMarker",data:n}))}}))},t}(o);return n.addClass(a,"MapDemoMarkersView"),a}));__extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign.apply(this,arguments)};var __rest=this&&this.__rest||function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(o[n[i]]=e[n[i]])}return o};define("DS/MapDemoWidget/views/MapDemoDisplayModeSettingsView",["require","exports","DS/MapDemoWidget/views/MapDemoBaseView","DS/Core/WebUXComponents","DS/Form/Form","DS/MapDemoWidget/MapDemoUtils","DS/MapDemoWidget/models/DisplayModeModelGetter"],(function(e,t,o,n,i,r,a){"use strict";var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bubbleMapOptions={minValue:0,opacity:.8,primaryColor:"#005685",scale:1,strokeColor:"#FFFFFF",strokeWidth:1,gradiantSettings:void 0},t.clusteringOptions={clustering:!0,maxClusterRadius:80,disableClusteringAtZoom:19,zoomToBoundsOnClick:!0,animate:!0},t.extentOptions={color:"#121212",strokeColor:"#000000",strokeWidth:1},t}return __extends(t,e),t.prototype.initView=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.buildView=function(){var e,t=this;this.elements.container.addClassName("mapDemoDisplayModeSettingsView"),this.displayMode="default",this.onModelUpdate=this.onModelUpdate.bind(this),this.form=new i({globalInformation:{text:"Display mode: ".concat(this.displayMode),emphasize:"primary",icon:"eye-cog"}}),this.form.inject(this.elements.container),this.form.onModelUpdate=this.onModelUpdate,null===(e=null==this?void 0:this.controller)||void 0===e||e.subscribe({event:"/MapDemoWidget/displayModeSelected"},(function(e){return t.updateDisplayMode(e)}))},t.prototype.updateDisplayMode=function(e){var t,o;this.displayMode=e,this.form.globalInformation=__assign(__assign({},this.form.globalInformation),{text:"Display mode: ".concat(this.displayMode)});var n=a.getModel(this.displayMode,this.getOptions());this.form.model=n,"bubble"===e&&(this.form.updateModelItem("sizePropertyName",{semantics:{possibleValues:this.controller.markersDocument.getPossibleProperties()}}),this.form.updateModelItem("colorPropertyName",{semantics:{possibleValues:this.controller.markersDocument.getPossibleProperties()}})),null===(o=null===(t=null==this?void 0:this.controller)||void 0===t?void 0:t.map)||void 0===o||o.display(e,this.getDisplayOptions())},t.prototype.onModelUpdate=function(e){var t,o,n,i,a,l,s,u,c=null==e?void 0:e.id,d=r.valueTransformer(null==e?void 0:e.value);switch(this.displayMode){case"default":"clustering"===c&&(this.form.updateModelItem("maxClusterRadius",{visibleFlag:d}),this.form.updateModelItem("disableClusteringAtZoom",{visibleFlag:d}),this.form.updateModelItem("zoomToBoundsOnClick",{visibleFlag:d}),this.form.updateModelItem("animate",{visibleFlag:d})),this.clusteringOptions[c]=d,null===(o=null===(t=null==this?void 0:this.controller)||void 0===t?void 0:t.map)||void 0===o||o.display(this.displayMode,this.getDisplayOptions());break;case"extent":this.extentOptions[c]=d,null===(i=null===(n=null==this?void 0:this.controller)||void 0===n?void 0:n.map)||void 0===i||i.display(this.displayMode,this.extentOptions);break;case"bubble":if(this.bubbleMapOptions[c]=d,"sizePropertyName"===c){var p=null===(l=null===(a=null==this?void 0:this.controller)||void 0===a?void 0:a.markersDocument)||void 0===l?void 0:l.getPropertyMinMax(d);this.form.updateModelItem("minValue",{value:p.min}),this.form.updateModelItem("maxValue",{value:p.max}),this.bubbleMapOptions.minValue=p.min,this.bubbleMapOptions.maxValue=p.max}"colorPropertyName"===c&&d&&(this.bubbleMapOptions.gradiantSettings=d?{colorPropertyName:d,secondaryColor:r.valueTransformer(this.form.getModelItem("secondaryColor").value)}:void 0),"secondaryColor"===c&&this.form.getModelItem("colorPropertyName").value&&(this.bubbleMapOptions.gradiantSettings={colorPropertyName:this.form.getModelItem("colorPropertyName").value,secondaryColor:d}),null===(u=null===(s=null==this?void 0:this.controller)||void 0===s?void 0:s.map)||void 0===u||u.display(this.displayMode,this.getDisplayOptions())}},t.prototype.getOptions=function(){switch(this.displayMode){case"default":return this.clusteringOptions;case"bubble":return this.bubbleMapOptions;case"extent":return this.extentOptions}},t.prototype.getDisplayOptions=function(){var e,t=this.getOptions();switch(this.displayMode){case"default":console.log(""),e=t.clustering?{clustering:!0,clusteringOptions:t}:null;break;case"bubble":e=function(e){var t,o=e.gradiantSettings,n=e.primaryColor,i=__rest(e,["gradiantSettings","primaryColor"]);t=e.gradiantSettings?{interpolationType:"linear",colorPropertyName:null==o?void 0:o.colorPropertyName,colors:[n,null==o?void 0:o.secondaryColor]}:n;return __assign({color:t},i)}(t);break;default:e=t}return e},t}(o);return n.addClass(l,"MapDemoDisplayModeSettingsView"),l}));__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function a(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))},__generator=this&&this.__generator||function(e,t){var o,n,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(s){return function(l){if(o)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(r=0)),r;)try{if(o=1,n&&(i=2&l[0]?n.return:l[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,l[1])).done)return i;switch(n=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{o=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};define("DS/MapDemoWidget/MapDemoWidget",["require","exports","DS/SocialGlobeAPI/GlobeAPI","DS/Core/Core","UWA/Core","DS/Windows/ImmersiveFrame","DS/Windows/Panel","DS/Core/WebUXGlobalEnums","DS/MapDemoWidget/views/MapDemoInfoView","DS/MapDemoWidget/views/MapDemoMarkersView","DS/MapDemoWidget/views/MapDemoLinksView","DS/MapDemoWidget/views/MapDemoPropertiesView","DS/MapDemoWidget/views/MapDemo3DSOfficesView","DS/MapDemoWidget/views/MapDemoDisplayModesView","DS/MapDemoWidget/controllers/MapDemoController","DS/MapDemoWidget/views/MapDemoUIControls","DS/MapDemoWidget/views/MapDemoDisplayModeSettingsView","css!DS/MapDemoWidget/MapDemoWidget.css"],(function(e,t,o,n,i,r,a,l,s,u,c,d,p,m,v,f,h){"use strict";return function(){var e=this;this.init=function(){return __awaiter(e,void 0,void 0,(function(){var e,t,g,y,M,D,b,_,w,C,S,k=this;return __generator(this,(function(x){switch(x.label){case 0:return n.setFullscreen(),this.immersiveFrame=(new r).inject(widget.body),this.immersiveFrame.getContent().style.backgroundColor="white",e=[48.1375690750536,-1.6208163509485936],this.mapPanelContent=i.createElement("div",{id:"mapPanelContent",class:"mapPanelContent",html:"\n        <div class='mapContainer' id ='mapContainer'></div>\n      "}),t={immersiveFrame:this.immersiveFrame,resizableFlag:!0,closeButtonFlag:!1},new a(__assign(__assign({},t),{identifier:"MapComponent",title:"Map Component",icon:"map",content:this.mapPanelContent,usePaddingFlag:!1,maximizedFlag:!0,maximizeButtonFlag:!0})),g=widget.getValue("x3dPlatformId")||"",y=this,[4,o.build("mapContainer",g,{initialCoordinates:e,initialZoomLevel:12,tmsMaxLevel:19,tmsUrl:g?void 0:"https://tile.openstreetmap.org/"})];case 1:return y.map=x.sent(),this.map.mapEvents.onPanStart((function(e){return console.log("panstart: ",e)})).onPanEnd((function(e){return console.log("panend: ",e)})).onMoveStart((function(e){return console.log("movestart: ",e)})).onMoveEnd((function(e){return console.log("moveend: ",e)})).onZoomStart((function(e){return console.log("zoomstart: ",e)})).onZoomEnd((function(e){return console.log("zoomend: ",e)})).onLinkCreated((function(e){return k.controller.linksDocument.addFeatures([e])})),this.controller=new v(this.map),new f(this.controller).inject(this.mapPanelContent),M=new a(__assign(__assign({},t),{identifier:"MapDemoPropertiesView",title:"Properties",icon:"properties",content:new d(this.controller).getContent(),minWidth:400,currentDockArea:l.WUXDockAreaEnum.RightDockArea})),D=new a(__assign(__assign({},t),{identifier:"MapDemoDisplayModeSettingsView",title:"Display Mode Settings",icon:"cog",content:new h(this.controller).getContent(),minWidth:400,currentDockArea:l.WUXDockAreaEnum.RightDockArea})),M.attachToWindow(D,l.WUXSnapAreaEnum.InsideArea,"before"),new a(__assign(__assign({},t),{identifier:"MapDemoInfoView",title:"Info",icon:"info",content:new s(this.controller,e[0],e[1]).getContent(),currentDockArea:l.WUXDockAreaEnum.RightDockArea})),b=__assign(__assign({},t),{minWidth:400,verticallyStretchableFlag:!0,currentDockArea:l.WUXDockAreaEnum.LeftDockArea}),_=new a(__assign(__assign({},b),{identifier:"MapDemoMarkersView",title:"Markers",icon:"location",content:new u(this.controller,this.immersiveFrame).getContent()})),w=new a(__assign(__assign({},b),{identifier:"MapDemoLinksView",title:"Links",icon:"flow-line",content:new c(this.controller,this.immersiveFrame).getContent()})),C=new a(__assign(__assign({},b),{identifier:"MapDemo3DSOfficesView",title:"DS Offices",icon:"logo-3ds-company",content:new p(this.controller,this.immersiveFrame).getContent()})),S=new a(__assign(__assign({},b),{identifier:"MapDemoDisplayModesView",title:"Display Modes",icon:"eye-cog",content:new m(this.controller,this.immersiveFrame).getContent()})),w.attachToWindow(S,l.WUXSnapAreaEnum.InsideArea,"before"),_.attachToWindow(w,l.WUXSnapAreaEnum.InsideArea,"before"),C.attachToWindow(_,l.WUXSnapAreaEnum.InsideArea,"before"),this.controller.subscribe({event:"/MapDemoWidget/displayModeSelected"},(function(e){return"default"===e?M.ensureVisible():D.ensureVisible()})),[2]}}))}))}}}));