define("DS/CATFLCockpitWidget/utils/group.util",[],(function(){"use strict";return{getGroupNodeParent:function(e){let t=this,i=e.getParent();return i.getID?i:t.getGroupNodeParent(i)},removeGroupNodesOnEmpty:function(e){let t=this,i=e.getParent();return e.getChildren()&&0!==e.getChildren().length||e.remove(),i.getID?void 0:t.removeGroupNodesOnEmpty(i)}}})),define("DS/CATFLCockpitWidget/components/CreateLogicalItemModal/SAXPLMNew/PLMNewSAXCmd",["DS/ENONewWidget/command/NewContentCommandBase"],(function(e){"use strict";return e.extend({defaults:{type:"RFLVPMLogicalReference"},init:function(e){this._parent(e)},getType(){return this.options.options.typeName},execute:function(){this.launchCreationDialog()},launchCreationDialog:function(){var e=this.getCreateOptions({});this.launchCreateNew(e)},getOptions:function(){return this.options}})})),define("DS/CATFLCockpitWidget/utils/model.events.util",["UWA/Core","DS/CoreEvents/ModelEvents"],(function(e,t){"use strict";var i={},n=[];return{createAppEventObject:function(e){return i[e]=new t,i[e]},subscribeEvent:function(){},getFLWebModelEventsObj:function(e){return i[e]},publishEvent:function(e){this.getFLWebModelEventsObj(e.userAction).publish({event:e.eventName,data:e.eventData}),this.cleanSubscriptionAndUserAction(e)},cleanSubscriptionAndUserAction:function(e){this.getFLWebModelEventsObj(e.userAction).unsubscribe({event:e.eventName})},deleteAppEventObject:function(e){delete i[e]},addToSubscriptionList:function(e){n.push(e)},getSubscriptionList:function(){return n},removeFromSubscriptionList:function(e){n=n.filter((function(t){return t!==e}))},clearSubscriptionList:function(){n=[]}}})),define("DS/CATFLCockpitWidget/utils/search.util",["UWA/Core","UWA/Utils/InterCom","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i){"use strict";var n={initialize:function(){this.socketName="search_socket_"+(new Date).getTime(),this.socket=new t.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var e=this.options();return this.socket.dispatchEvent("RegisterContext",e),this},options:function(t,i,n,o,r,a,s){var l={};return l.title=t,l.mode="furtive",l.app_socket_id=this.socketName,l.widget_id=widget.id,l.default_with_precond=!0,l.show_precond=!1,l.idcard_activated=!1,l.multiSel=!!e.is(r)&&r,l.role=n,i&&(l.precond="",(i=i.split(",")).forEach((function(e,t){0!==t&&(l.precond+=" OR "),l.precond+='flattenedtaxonomies:"types/'+e+'"'}))),l.recent_search={types:i},a&&(l.precond?l.precond="( "+l.precond+") AND "+a:l.precond=a),s&&s.length>0&&(l.columns=s),l},destroy:function(){var e={};e.widget_id=widget.id,this.socket.dispatchEvent("unregisterSearchContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.disconnect(),delete this.socket},activate:function(e,t,i,n,o,r,a,s){var l=this.options(e,t,i,n,o,a,s);this.callback=r,this.socket.dispatchEvent("RegisterContext",l),this.socket.dispatchEvent("InContextSearch",l)},isAvailable:function(){return e.is(this.socket)},configureSearch:function(e){this.isAvailable()||this.initialize(e)},launchSearch:function(e){var t=e.searchTitle||i.label_search_title;this.activate(t,e.allowedTypes,e.role||"",e.criteria,e.bMultiSel,(function(t){e.in_apps_callback(t)}),e.additionalQuery,e.selectable)},objectsSelected:function(e){var t,i,n=[];if(this.callback){for(t=0,i=e.length;t<i;t++)n.push(e[t]);this.callback(n)}}};return n.initialize(),n})),define("DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbar",["DS/Tweakers/GeneratedToolbar","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t){"use strict";var i=function(e,t){this.wrapper=e,this.render(t)};return i.prototype.render=function(t){var i=this,n={entries:[]};i._addExpandActionEntry(n),i._addCollapseActionEntry(n),i._addExportActionEntry(n),i._addSwitchMatrixActionEntry(n),i._addFilterActionEntry(n);var o=e.prototype.createTreeDocument(n);i.catflGeneratedToolbar=new e({overflowManagement:"dropdown",direction:"horizontal",items:o}),i.catflGeneratedToolbar.inject(t)},i.prototype._addExpandActionEntry=function(e){var i=this;e.entries.push({id:"expAll_btn",dataElements:{typeRepresentation:"functionMenuIconCount",tooltip:t.action_expand,value:{menu:[{type:"PushItem",title:"0",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(0),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=-1}}},{type:"PushItem",title:"1",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(1),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=1}}},{type:"PushItem",title:"2",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(2),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=2}}},{type:"PushItem",title:"3",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(3),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=3}}},{type:"PushItem",title:"4",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(4),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=4}}},{type:"PushItem",title:"N",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(-1),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=0}}}]},icon:{iconName:"flow-tree-expand-down",fontIconFamily:1},count:-1,position:"far",category:"1"}})},i.prototype._addCollapseActionEntry=function(e){e.entries.push({id:"collapse_btn",dataElements:{typeRepresentation:"functionIcon",action:{module:"DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",func:"executeToolbarCmd",argument:{id:"collapse_btn",toolbarCtx:this}},tooltip:t.action_collapse_all,icon:{iconName:"flow-tree-expand-up",fontIconFamily:1},position:"far",category:"1"}})},i.prototype._addExportActionEntry=function(e){e.entries.push({id:"export_btn",dataElements:{typeRepresentation:"functionIcon",action:{module:"DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",func:"executeToolbarCmd",argument:{id:"export_btn",toolbarCtx:this}},tooltip:t.action_export_2_excel,icon:{iconName:"export",fontIconFamily:1},position:"far",category:"2"}})},i.prototype._addSwitchMatrixActionEntry=function(e){e.entries.push({id:"switchMatrix_btn",dataElements:{typeRepresentation:"functionIcon",action:{module:"DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",func:"executeToolbarCmd",argument:{id:"switchMatrix_btn",toolbarCtx:this}},tooltip:t.action_switch_matrix,icon:{iconName:"table-row-column",fontIconFamily:1},position:"far",category:"2"}})},i.prototype._addFilterActionEntry=function(e){e.entries.push({id:"filter_btn",dataElements:{typeRepresentation:"functionIcon",action:{module:"DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",func:"executeToolbarCmd",argument:{id:"filter_btn",toolbarCtx:this}},tooltip:t.action_Filter,icon:{iconName:"filter",fontIconFamily:1},position:"far",category:"3"}})},i})),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.filter",["UWA/Core"],(function(e){return{createFilterOnAttributeCategory:function(e,t,i,n){var o=this;return e.inherit({isDataFiltered:function(e){return this._parent(e)||!t.call(o,e)},_applyFilterModel:function(e){if(this._getCurrentFilter){var t=this._getCurrentFilter();t&&(t.filterModel=this.filterModel)}if(this.filterManager){if(this.filterManager.model.prepareUpdate&&this.filterManager.model.prepareUpdate(),this._listOfFilteredData.forEach((function(e){e.decrementFilteredCount()})),this._listOfFilteredData=[],!this.filterModel)return this.filterManager.publish("filterModelChange",{propertyId:this.propertyId,filter:this}),this.filterManager.filterModel[this.propertyId]&&delete this.filterManager.filterModel[this.propertyId].filterModel,void(this.filterManager.model.pushUpdate&&this.filterManager.model.pushUpdate({updateType:WUXModelUpdateTypes.Filtering}));this.filterManager.filterModel[this.propertyId].filterModel=this.filterModel;var o=this;this.filterManager.model.processDescendants&&this.filterManager.model.processDescendants({treeTraversalOrder:"postOrder",processNode:function(e){function t(e){if(e!==r){!function(e){var t=o._listOfFilteredData.indexOf(e);-1!==t?(o._listOfFilteredData.splice(t,1),e.decrementFilteredCount()):e._preventFiltering=!0}(e);var i=e.getChildren();i&&i.forEach((function(e){t(e)}))}}if(!0===this._preventFiltering)return delete this._preventFiltering,void(i&&n&&i(this,t));if(e.nodeModel.canBeFiltered(o.propertyId)&&o.isDataFiltered(e.nodeModel))this.incrementFilteredCount(),o._listOfFilteredData.push(this);else{this.getParents().forEach((function(e){e._preventFiltering=!0}));var r=this;i&&i(this,t)}}}),this.filterManager.publish("filterModelChange",{propertyId:this.propertyId,filter:this}),this.filterManager.model.pushUpdate&&this.filterManager.model.pushUpdate({updateType:WUXModelUpdateTypes.Filtering})}}})},registerSpecificFilters:function(e,t,i,n,o){var r=e.getTreeDocument().getFilterManager(),a=e.getFilterViewManager();for(var s of(this.defaultFiltersIds||this.defaultFilterViewsIds||(this.defaultFiltersIds=Object.keys(r.FILTERS_MAP)),this.defaultFiltersIds)){let e=r.getFilterClassName(s),l=this.createFilterOnAttributeCategory(e,i,n,o);r.registerFilter(s+t,l);let c=a.getFilterViewClassName(s);c&&a.registerFilterView(s+t,c.inherit({}))}},createFilterModelWithCustomCondition:function(e,t){var i={};for(var n in t){let o=t[n].filterId+e;i[n]={filterId:o},"set"===t[n].filterId?i[n].filterModel=[]:i[n].filterModel={}}return i},registerAndCreateSpecificFilter:function(e,t,i){var n=this.filtersInfo[t];return this.registerSpecificFilters(e,t,n.conditionFunction,n.additionalProcessOnNode,n.doAdditionalProcessOnParentNode),this.createFilterModelWithCustomCondition(t,i)},registerAndCreateAllFilters:function(e,t){this.filtersInfo={PilotingDisciplines:{conditionFunction:this.isNodePilotingDiscipline,additionalProcessOnNode:this.showSiblingsCategory,doAdditionalProcessOnParentNode:!1},Disciplines:{conditionFunction:this.isNodeDiscipline,additionalProcessOnNode:this.showSiblingsCategory,doAdditionalProcessOnParentNode:!1},ProposedSolutions:{conditionFunction:this.isNodeProposedSolution,additionalProcessOnNode:this.showSiblingsCategory,doAdditionalProcessOnParentNode:!1},StructureHidingCategory:{conditionFunction:this.isStructure,doAdditionalProcessOnParentNode:!1},StructureShowingCategory:{conditionFunction:this.isStructure,additionalProcessOnNode:this.showAllCategory,doAdditionalProcessOnParentNode:!0}};var i={};for(const o of Object.keys(this.filtersInfo)){var n=this.registerAndCreateSpecificFilter(e,o,t);i[o]=n}return i},copyOldFilterModelInNewFilterModel:function(e,t){for(var i in e)t[i]&&t[i].filterModel&&(e[i].filterModel=t[i].filterModel)},changeFilterModel:function(e,t){var i=e.getTreeDocument().getFilterManager().filterModel;this.copyOldFilterModelInNewFilterModel(t,i),e.getTreeDocument().setFilterModel(t,{keepDefaultFilterModel:!0})},isNodePilotingDiscipline:function(e){var t=!1,i=!1,n=!1,o=e._options.linkInfo;o&&(t="ref"===o.objType&&"implementing"===o.linkType,e._options.grid.kindOfRFLP&&(i="L"===e._options.grid.kindOfRFLP),n=!!e.getParent().getParent()._options.grid.architectureNumber);return t&&i&&n},isNodeDiscipline:function(e){var t=!1,i=!1,n=e._options.linkInfo,o=!1;n&&(t="implementing"===n.linkType&&"inst"===n.objType,i="RFLVPMLogicalReference"===e._options.type,o=!!e.getParent().getParent()._options.grid.architectureNumber);return t&&i&&o},isNodeProposedSolution:function(e){var t="P"===e.options.grid.kindOfRFLP,i=!1;t&&(i="proposedSolutionCategory"===e.getParent().options.type);return t&&i},isStructure:function(e){var t=e.options.linkInfo,i=e.options.virtual,n="L"===e.options.grid.kindOfRFLP;return!t&&!i&&n},clearFilterModels:function(e){var t=e.getTreeDocument().getFilterManager().getFilters();for(var i in t)t[i].filterId.startsWith("set")?t[i].filterModel=[]:t[i].filterModel={}},showAllCategory:function(e,t){e.getChildren().forEach((function(e){e._options.type.includes("Category")&&t(e)}))},showSiblingsCategory:function(e,t){e.getParent().getParent().getChildren().forEach((function(e){e._options.type.includes("Category")&&t(e)}))}}})),define("DS/CATFLCockpitWidget/utils/SAXTracker",["DS/Usage/TrackerAPI"],(function(e){"use strict";return class{static trackCommandLaunched(e){e&&this.trackPageEvent({eventCategory:"command",eventAction:e,eventLabel:e})}static trackPageEvent({eventCategory:t,eventAction:i,eventLabel:n,eventValue:o}){let r={eventCategory:t||null,eventAction:i||null,eventLabel:n||null,eventValue:o||null,appID:widget.getValue("appId"),tenant:widget.getValue("x3dPlatformId"),scope:"Dashboard"};e.trackPageEvent(r)}}})),define("DS/CATFLCockpitWidget/utils/modelObj.util",["UWA/Class/Model"],(function(e){"use strict";var t=e.extend({setup:function(e){this._parent(e)},getID:function(){return this.get("physicalid")},getLabel:function(){return this.get("label")},getType:function(){return this.get("type")},getDisplayName:function(){return this.get("label")},getParent:function(){return this.get("parent")?new t(this.get("parent")):null},getRelationID:function(){return this.get("relID")}});return t})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/ReplaceByDuplicateCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/AuthGenericCommands/commands/AuthGenericCmdReplaceByDuplicate","DS/AuthGenericCommands/AppContext","DS/UIKIT/Mask","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","i18n!DS/UPSCommands/assets/nls/UPSAuthCatalog.json","i18n!DS/AuthGenericCommands/assets/nls/AuthGenericCommandsCatalog.json"],(function(e,t,i,n,o,r,a,s){"use strict";var l={RFLVPMLogicalReference:!0,RFLVPMLogicalInstance:!0};return e.extend(t,i,{init:function(e){n.isExternalContext=!0,n.beginBlockingTransaction=function(){o.mask(e.container,r.msg_processing)},n.endBlockingTransaction=function(){o.unmask(e.container,r.msg_processing)},this._parent(e)},defaultOptions:{className:"UPSAuthCmdReplaceByDuplicate",modeler:"product",version:"1.0",bAllOrNothing:!1,availability:"multiSelection",commandName:a.UPSAuthReplaceByDuplicate,reportTitle:a.UPSAuthInsertDuplicate_report,chooser:{precondFilter:'(flattenedtaxonomies:"types/VPMReference")',precondFilterDrawing:'(flattenedtaxonomies:"types/Drawing" AND [ds6w:composed]:FALSE)',source:["3dspace"],multiSel:!1,advanced_search:{showByDefault:!0}},remapErrors:[{modeler:"Error from [ProductOperations : replaceReference] Id [Instance duplication failed] : Error from [PLMxKRefInstanceTemplate : checkAggregationBusinessRules] Id [Instance Aggregation forbidden [S_OK/False]]",user:a.replace_V6_under_V5},{modeler:"Input parameters are not valid",user:s.ERR_007},{modeler:"You don't have the required license for this command.",user:s.error_license},{modeler:"Embedded Component not supported",user:a.authoring_failed_EC},{modeler:"ERR_FUN092398",user:a.ERR_FUN092398}],isValidSelection:function(e,t){var i={valid:[],invalid:[],status:!0};e.forEach((function(e){var t=e.getType();l[t]?i.valid.push(e):(i.invalid.push(e),i.status=!1)})),t(i)}}})})),define("DS/CATFLCockpitWidget/utils/tooltip.util",["DS/Controls/TooltipModel"],(function(e){"use strict";return{loadTooltips:function(t){let i={},n=[];return t.forEach((function(t){i[t]=new e,i[t]._properties.allowUnsafeHTMLLongHelp.value=!0,i[t]._properties.mouseRelativePosition.value=!1,n.push(i[t].loadFromHelpRscFile("CATFLCockpitWidget/help",t))})),Promise.all(n).then((function(){return i}))},setTooltip:function(e,t,i){i.then((function(i){e.tooltipInfos=i[t]}))}}})),define("DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow",["DS/Windows/Dialog","DS/Controls/Button","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i){return{createWindow:function(n,o,r,a,s){var l=new e({title:n,content:o,width:500,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new t({label:r||i.label_submit,emphasize:"primary",onClick:function(){a(),l.close()}}),Close:new t({label:i.cancel_button,emphasize:"secondary",onClick:function(){s&&"function"==typeof s&&s(),l.close()}})}});return l.addEventListener("close",(function(){l.destroy()})),l}}})),define("DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel",["DS/TreeModel/TreeNodeModel"],(function(e){"use strict";var t=["RFLPLMFunctionalConnection","RFLVPMLogicalConnection"],i=["RFLPLMFlowExpositionInstance","RFLVPMSystemTypeExpositionInstance","RFLPLMFunctionalConnector","RFLVPMLogicalPort"];function n(t){this.options={grid:{},color:"rgba(0, 0, 0, 0)",isUIActive:!1,relationid:"",physicalid:"",type:"",basetype:"",relationtype:"",virtual:!1},this.options.grid.active_color="rgba(0, 0, 0, 0)",this.options.grid.bi_color="rgba(0, 0, 0, 0)",this.options=UWA.extend(this.options,t),e.call(this,this.options)}function o(e){e._getFilterInfo||(e._getFilterInfo=n.prototype._getFilterInfo.bind(e),e._getChildrenFilterInfo=n.prototype._getChildrenFilterInfo.bind(e),e._removeChildrenFilterInfo=n.prototype._removeChildrenFilterInfo.bind(e),e.filterInChild=n.prototype.filterInChild.bind(e),e.filterOutChild=n.prototype.filterOutChild.bind(e))}return n.prototype=Object.create(e.prototype),n.prototype.getRealPath=function(){var e=this.getPath();return e.length>0&&e[0].isVirtual()&&e.shift(),e},n.prototype.isVirtual=function(){return this.options.virtual},n.prototype.getAttribute=function(e){return"ds6w:label-Instance"===e&&(e="instanceName"),this.getAttributeValue(e)},n.prototype.isConnection=function(){return t.indexOf(this.getBaseType())>=0},n.prototype.isConnector=function(){return i.indexOf(this.getBaseType())>=0},n.prototype.getType=function(){return this.options.type},n.prototype.getBaseType=function(){return this.options.basetype},n.prototype.getRelationType=function(){return this.options.relationtype},n.prototype.getGroups=function(){let e;return e=this.options.merged?this.options.grp:UWA.Utils.splat(this.options.grp),e},n.prototype.setID=function(e){this.options.physicalid=e},n.prototype.getID=function(){return this.options.physicalid},n.prototype.getReferenceID=function(){return this.options.physicalid},n.prototype.getRelationID=function(){return this.options.relationid},n.prototype.setRelationID=function(e,t){this.options.relationid=e,this.options.relationtype=t},n.prototype.addChild=function(e,t){if(!Array.isArray(e)){var i=this.getTreeDocument();if(i&&e.options.physicalid&&e.options.physicalid.length>0){var n=i.getRoots()[0];0==Object.keys(i.mappedNodesToIds).length&&n.options.physicalid.length>0&&(i.mappedNodesToIds[n.options.physicalid]=[n]),i.mappedNodesToIds[e.options.physicalid]||(i.mappedNodesToIds[e.options.physicalid]=[]),i.mappedNodesToIds[e.options.physicalid].push(e)}return this._addChild(e,t)}},n.prototype.removeChild=function(t){if(!Array.isArray(t)){var i=this.getTreeDocument();if(i&&t.options.physicalid&&t.options.physicalid.length>0){var n=i.mappedNodesToIds[t.options.physicalid];if(n){for(var o=n.length-1;o>=0;o--){n[o]._id===t._id&&n.splice(o,1)}n.length<=0&&delete i.mappedNodesToIds[t.options.physicalid]}}return Object.create(e.prototype).removeChild.call(this,t)}},n.prototype.getNodesById=function(e){var t={listOfFoundNodes:[]};return this._groupingOptions?this.getChildrenFromGroupById(e,t):this._getNodesById(e,t),t.listOfFoundNodes},n.prototype.getChildrenFromGroupById=function(e,t){this.getChildren().forEach(((i,o)=>{i.getID?i._getNodesById(e,t):n.prototype.getChildrenFromGroupById.call(i,e,t)}))},n.prototype._getNodesById=function(e,t){var i=!1;if(this.getID()===e)t.listOfFoundNodes.push(this),i=!0;else{var n=this.getChildren();if(n)for(var o=0;n&&o<n.length;o++)i=n[o]._getNodesById(e,t)||i}return i},n.prototype.getSortableAttributeValue=function(e){var t=this;switch(e){case"label1":case"label2":return t.options.label;case"maturity":return t.options.maturityState;case"owner":return t.options.owner;case"creationDate":return new Date(t.options.creationDate).getTime();case"modificationDate":return new Date(t.options.modificationDate).getTime()}},n.prototype.getNodesByRelId=function(e){var t={listOfFoundNodes:[],foundId:void 0};return this._groupingOptions?this.getChildrenFromGroupByRelId(e,t):this._getNodesByRelId(e,t),t.listOfFoundNodes},n.prototype.getChildrenFromGroupByRelId=function(e,t){this.getChildren().forEach(((i,o)=>{i.getID?i._getNodesByRelId(e,t):n.prototype.getChildrenFromGroupByRelId.call(i,e,t)}))},n.prototype._getNodesByRelId=function(e,t){var i=this.options.relationid,n=this.getID();if(i===e)t.listOfFoundNodes.push(this),t.foundId=n;else if(n!==t.foundId){var o=this.getChildren();if(o)for(var r=0;r<o.length;r++)o[r]._getNodesByRelId(e,t)}},n.prototype.getOccurencePath=function(e){UWA.is(e,"function")&&e(this);var t=this.options.actualParent||this.getParent();if(this.isRoot()||this.isVirtual()||!t)return[this.options.physicalid];var i=t.getOccurencePath(e);return i.push(this.options.instance.physicalid),i.push(this.options.physicalid),i},n.prototype.setActive=function(e){this.updateOptions({isUIActive:e})},n.prototype.isActive=function(){return this.options.isUIActive},n.prototype.setColor=function(e){this.updateOptions({color:e,grid:{active_color:e}})},n.prototype._removeFilterInfo=function(){delete this.options._filterInfo},n.prototype._removeChildrenFilterInfo=function(){delete this.options._childrenFilterInfo},n.prototype._getFilterInfo=function(e){return!this.options._filterInfo&&Boolean(e)&&(this.options._filterInfo={}),this.options._filterInfo},n.prototype._getChildrenFilterInfo=function(e){return!this.options._childrenFilterInfo&&Boolean(e)&&(this.options._childrenFilterInfo={}),this.options._childrenFilterInfo},n.prototype.filterOut=function(){var e=this.isRoot()?this.getTreeDocument():this.getParent();null!==e&&(o(e),e.filterOutChild(this))},n.prototype.filterIn=function(e){var t=this._getFilterInfo();if(t&&t.parentBeforeFiltering){var i=t.parentBeforeFiltering;o(i),i.filterInChild(this)}if(Boolean(e)){var n,r=this._getChildrenFilterInfo();(n=r&&r.childrenBeforeFiltering?r.childrenBeforeFiltering:this.getChildren())&&n.forEach((function(t){t.filterIn(e)}))}},n.prototype.filterOutChild=function(e){var t=this.getChildren();if(t.indexOf(e)<0)throw"Not a child";var i=this._getChildrenFilterInfo(!0);if(!i.childrenBeforeFiltering){i.childrenBeforeFiltering=t&&t.length>0?t.slice(0):[];UWA.is(this._expandState)&&(i.expandStateBeforeFiltering={noExpandState:"noChildren",expandingState:"expanding",partiallyExpandedState:"partiallyExpanded",collapseState:"expanded",expandState:"collapsed"}[this._expandState])}e._getFilterInfo(!0).parentBeforeFiltering=this,UWA.is(this.removeChild,"function")?this.removeChild(e):this.removeRoot(e,!0,!0),UWA.is(this.setState,"function")&&this.setState({state:i.expandStateBeforeFiltering}),i.filteredOutChildren||(i.filteredOutChildren=[]),i.filteredOutChildren.push(e)},n.prototype.filterInChild=function(e){var t=this._getChildrenFilterInfo();if(t){var i=t.childrenBeforeFiltering;if(i){var n=i.indexOf(e);if(n>=0){var o=e._getFilterInfo();if(o&&o.parentBeforeFiltering===this){var r,a=this.getChildren();if(a)for(var s=0;s<a.length;s++){var l=a[s];if(i.indexOf(l)>n){r=l;break}}delete o.parentBeforeFiltering,void 0!==e.options.isRootAttached?!0===e.options.isRootAttached&&this.insertBefore(e,r):this.insertBefore(e,r),UWA.is(this.setState,"function")&&this.setState({state:t.expandStateBeforeFiltering}),e._removeFilterInfo();var c=t.filteredOutChildren.indexOf(e);t.filteredOutChildren.splice(c,1),0===t.filteredOutChildren.length&&this._removeChildrenFilterInfo()}}}}},n.prototype.isDescendantOf=function(e){var t;if(t=e instanceof n?e.getID():e,this.getID()===t)return!0;if(!this.isRoot()){var i=this.getParent();if(i)return i.isDescendantOf(t)}return!1},n})),define("DS/CATFLCockpitWidget/components/ContentListView/decorators/contentlistview.viewport",[],(function(){"use strict";return{getFirstVisibleNodeInViewport:function(){var e=Object.values(this.contentView.getVisibleCellsInViewport());for(let t=0;t<e.length;t++){let i=e[t],n=this.contentView.getCellInfosAt(i).nodeModel;if(n)return n}},focusViewportOnNode:function(e){let t=null;if(e){if(e.isVisible())t=e;else{let i=e.getNextVisibleNode();if(i)t=i;else{let i=e.getPreviousVisibleNode();i&&(t=i)}}}t&&this.contentView.ensureNodeModelVisible(t,!1,!1,0,!1)}}})),define("DS/CATFLCockpitWidget/utils/gridview.dnd.util",[],(function(){"use strict";return{makeGridViewDroppable:function(e){var t=this,i=widget.body.querySelector(".fl-cockpit-app-container"),n=i.getElement("#drop-insert-instance");n||(n=new UWA.createElement("div",{id:"drop-insert-instance",class:"hidden"}).inject(i)),e.contentView.onDragEnterCell=t._onDragEnterGridView.bind(t,e.acceptDrop,e.getTextInvite),e.contentView.onDragEnterRowHeader=t._onDragEnterGridView.bind(t,e.acceptDrop,e.getTextInvite),e.contentView.onDragLeaveCell=t._onDragLeaveGridView.bind(t),e.contentView.onDragLeaveRowHeader=t._onDragLeaveGridView.bind(t),e.contentView.onDropCell=t._onDropGridView.bind(t,e.onDropCallback),e.contentView.onDropRowHeader=t._onDropGridView.bind(t,e.onDropCallback),e.contentView.onDragOverCell=t._onDragOverGridView.bind(t,e.acceptDrop,e.getTextInvite),e.contentView.onDragOverRowHeader=t._onDragOverGridView.bind(t,e.acceptDrop,e.getTextInvite)},_manageDisplayDropInviteGridView:function(e,t){var i=widget.body.querySelector(".fl-cockpit-app-container").getElement("#drop-insert-instance");i&&(e?(t.icon&&t.text&&(i.innerHTML="<i class='wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-"+t.icon+"'></i><h5 class='font-3dsregular insert'>"+t.text+"</h5>"),i.removeClassName("hidden"),i.addClassName("show")):(i.removeClassName("show"),i.addClassName("hidden")))},_onDragOverGridView:function(e,t,i,n){var o=e(i,n),r=t?t(i,n,o):void 0;return r&&this._manageDisplayDropInviteGridView(!0,r),!!o&&(i.preventDefault(),!0)},_onDragEnterGridView:function(e,t,i,n){var o=e(i,n),r=t?t(i,n,o):void 0;return r&&this._manageDisplayDropInviteGridView(!0,r),!0},_onDragLeaveGridView:function(){return this._manageDisplayDropInviteGridView(),!0},_onDropGridView:function(e,t,i){return this._manageDisplayDropInviteGridView(),e(t,i),!1}}})),define("DS/CATFLCockpitWidget/utils/maturity.util",[],(function(){"use strict";return{createCSSClass:function(e,t,i){if(null===document.getElementById(e)){let n=document.createElement("style");n.type="text/css",n.id=e;let o=i||"."+e;n.innerHTML=o+t,document.getElementsByTagName("head")[0].appendChild(n)}},getAndCreateMaturityClass:function(e,t,i){return`lc-status-${e}-${t?"activeColor":"inactiveColor"}-withClass ${i?"lc-link-class":""}`},createCSSMaturityClasses:function(e,t){var i=this;for(let n in e){let o=e[n];["activeColor","inactiveColor"].forEach((e=>{let r=o?.[e],a=`{color:${"#FFFFFF"===r?"#000000":"#FFFFFF"} ; background-color:${r};}`,s=`lc-status-${n}-${e}-withClass`,l=`.${s} .${t}`;i.createCSSClass(s,a,l)}))}}}})),define("DS/CATFLCockpitWidget/utils/zip.util",["UWA/Utils","DS/ZipJS/inflate","DS/ZipJS/deflate"],(function(e){"use strict";return{jsonZip:function(t){if(!t)return t;if(t.length>0&&"{"!==t[0]&&"["!==t[0])return t;var i=t;try{i=encodeURIComponent(t)}catch(e){}for(var n=new ArrayBuffer(i.length),o=new Uint8Array(n),r=0;r<i.length;r++)o[r]=i.charCodeAt(r);var a=new Deflater;a.append(o);var s=a.flush().reduce(((e,t)=>e+String.fromCharCode(t)),""),l="ZIP:"+e.base64Encode(s);return console.log("Size zipped string="+l.length),l},jsonUnzip:function(t){if(!t||!1===t.startsWith("ZIP:"))return t;var i=t=t.replace("ZIP:","");try{i=e.base64Decode(t)}catch(e){}for(var n=new ArrayBuffer(i.length),o=new Uint8Array(n),r=0;r<i.length;r++)o[r]=i.charCodeAt(r);var a=new Inflater,s=a.append(o);a.flush();var l=s.reduce(((e,t)=>e+String.fromCharCode(t)),"");return l=decodeURIComponent(l),console.log("Size unzipped string="+l.length),l}}})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/ReplaceByRevisionCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/AuthGenericCommands/AppContext","DS/AuthGenericCommands/commands/AuthGenericCmdRevisionUpdate","DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","i18n!DS/AuthGenericCommands/assets/nls/AuthGenericCommandsCatalog.json"],(function(e,t,i,n,o,r,a,s){"use strict";var l={RFLVPMLogicalReference:!0,RFLVPMLogicalInstance:!0};return e.extend(t,n,{init:function(e){i.isExternalContext=!0,i.beginBlockingTransaction=function(){o.mask(e.container,a.msg_processing)},i.endBlockingTransaction=function(){o.unmask(e.container,a.msg_processing)},this._parent(e)},defaultOptions:{modeler:"v1/modeler/dsfl",version:"1.0",bAllOrNothing:!1,availability:"multiSelection",commandName:a.action_replace_other_rev,reportTitle:a.action_replace_other_rev_report,commandMode:"FlatList",options:{webInWin:!1,visibleColumn:{IsModified:!0,Title:!0,Revision:!0,Maturity:!0,Type:!0,Responsible:!0,Candidate:!0,ReplaceAction:!0,ExpectedRevision:!0,ExpectedMaturity:!0},EnableByRevision:!0,EnableBubbleup:!1,EnableCompare:!1},remapErrors:[{modeler:"Input parameters are not valid",user:s.ERR_008},{modeler:"You don't have the required license for this command.",user:s.error_license},{modeler:"Embedded Component not supported",user:a.authoring_failed_EC},{modeler:"ERR_FUN092398",user:a.ERR_FUN092398}],isValidSelection:function(e,t){var n={valid:[],invalid:[],status:!0},o=[],r=[];e.forEach((function(e){if(i.isRoot(e)){var t=i.getName(e);r.push({node:e,why:"ROOT",name:t})}else o.push(e)})),i.getParentWithChild(o).forEach((function(e){var t=e.child,n=o.indexOf(t);if(n>-1){o.splice(n,1);var a=i.getName(t);r.push({node:t,why:"CHILD",name:a,parent:e.parent})}})),o.forEach((function(e){var t=e.getType();if(!0===l[t])n.valid.push(e);else{var o=i.getName(e);r.push({node:e,why:"TYPE",name:o})}})),n.invalid=r,n.status=0===r.length,t(n)}}})})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/ReplaceByLatestRevisionCmd",["UWA/Class","DS/UIKIT/Mask","DS/ApplicationFrame/Command","DS/AuthGenericCommands/AppContext","DS/AuthGenericCommands/commands/AuthGenericCmdReplaceByLatestRevision","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","i18n!DS/AuthGenericCommands/assets/nls/AuthGenericCommandsCatalog.json"],(function(e,t,i,n,o,r,a,s){"use strict";var l={RFLVPMLogicalReference:!0,RFLVPMLogicalInstance:!0};return e.extend(i,o,{init:function(e){n.isExternalContext=!0,n.beginBlockingTransaction=function(){t.mask(e.container,a.msg_processing)},n.endBlockingTransaction=function(){t.unmask(e.container,a.msg_processing)},this._parent(e)},defaultOptions:{modeler:"v1/modeler/dsfl",version:"1.0",bAllOrNothing:!1,availability:"multiSelection",commandName:a.action_replace_latest_rev,reportTitle:a.action_replace_latest_rev_report,remapErrors:[{modeler:"Input parameters are not valid",user:s.ERR_008},{modeler:"You don't have the required license for this command.",user:s.error_license},{modeler:"Embedded Component not supported",user:a.authoring_failed_EC},{modeler:"ERR_FUN092398",user:a.ERR_FUN092398}],isValidSelection:function(e,t){var i={valid:[],invalid:[],status:!0};e.forEach((function(e){var t=e.getType();l[t]?i.valid.push(e):(i.invalid.push(e),i.status=!1)})),t(i)}}})})),define("DS/CATFLCockpitWidget/utils/config.util",["UWA/Core","UWA/Class/Promise","UWA/Utils/InterCom","DS/WAFData/WAFData","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/CATFLCockpitWidget/utils/model.events.util","text!DS/CATFLCockpitWidget/assets/config/webservices.conf.json","text!DS/CATFLCockpitWidget/assets/config/masks.conf.json","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json"],(function(e,t,i,n,o,r,a,s,l,c,d,u){"use strict";var p={nlsBasicAttributesBO:{},nlsBasicAttributesRel:{},identifiers:JSON.parse(u),masks:JSON.parse(c),localStorageKeys:JSON.parse(d),webservices:JSON.parse(l),mappingType:{}};return p.mappingType[p.identifiers.type_act_logref]={nlsName:p.identifiers.type_logicalref,icon:"I_VPMNavLogical.png"},p.mappingType[p.identifiers.type_act_loginstance]={nlsName:p.identifiers.rel_logicalInstance},p.mappingType[p.identifiers.type_document]={icon:"I_TextDoc22x22.png"},p.mappingType[p.identifiers.type_usecase]={icon:"iconReqTypeUseCase.png"},p.mappingType[p.identifiers.type_requirement]={icon:"iconReqTypeRequirement.png"},p.mappingType[p.identifiers.type_reqSpec]={icon:"iconReqTypeRequirementSpecification.png"},p.mappingType[p.identifiers.type_reqGroup]={icon:"iconReqTypeSpecificationFolder.png"},p.mappingType[p.identifiers.type_act_functref]={icon:"I_VPMNavFunction.png"},p.mappingType[p.identifiers.type_act_physical]={icon:"I_VPMNavProduct.png"},{cleanRecentlyAuthoredItemsInLocalStorage:function(){var e=1e3*parseInt(widget.getPreference(p.localStorageKeys.timeoutIndex).value,10);let t=this;for(var i=localStorage.length-1;i>=0;i--){var n=localStorage.key(i);-1!==n.indexOf(p.localStorageKeys.recentlyAuthored)&&Date.now()-JSON.parse(t.SAXStorage().getItem(n),10)>e&&t.SAXStorage().removeItem(n)}},setAuthIDforWIW:function(e,t){this.AuthIDForWIW={workunder:e,value:t}},getAuthorizedWorkUnder:function(e){var t={},i=a.get();if(e){let e="DS-Configuration-Authoring-Context",i=null;this.AuthIDForWIW&&this.AuthIDForWIW.value&&("evolution"===this.AuthIDForWIW.workunder?i="pid:"+this.AuthIDForWIW.value:(e="DS-Change-Authoring-Context",i=this.AuthIDForWIW.value),t[e]=i)}else if(i&&i&&i.AuthoringContextHeader)for(var n in i.AuthoringContextHeader)t[n]=i.AuthoringContextHeader[n];return t},getEntry:function(e){return p[e]},getFullConfig:function(){return p},getPlatformServices:function(){var i=this;return new t((function(t,n){r.getPlatformServices({onComplete:function(n){var o={};e.is(n,"array")&&n.length>0&&n.forEach((function(e){o[e.platformId]=e})),i._platformServices=o,i.retrieveSecurityContext().then((function(e){t(e)}))},onFailure:n})}))},retrieveCurrentUser:function(){var e=this;return new t((function(t,i){if(e._user&&e._user.id)return t(e._user);r.getUser({onComplete:function(i){e._user={id:i.id,email:i.email,firstName:i.firstname,lastName:i.lastname},t(e._user)},onFailure:i})}))},getSecurityContext:function(){var e=widget.getPreference(p.localStorageKeys.credentials),t=widget.getValue("widgetSecCtxPref"),i=this;return e&&e.value?i._securityContext=e.value:i._securityContext=t&&null!==t?t:null,i._securityContext},getServiceURL:function(e){var t=this.getTenant();if(this._platformServices)return this._platformServices[t][e]},retrieveSecurityContext:function(){var i=this,o=null;return new t((function(t,r){var a=i.getServiceURL("3DSpace")+p.webservices.pnoCredential+"&tenant="+i.getTenant();n.authenticatedRequest(a,{method:"GET",type:"json",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(n){e.is(n.collabspaces,"array")&&0===n.collabspaces.length&&t(!1),o=i.credentialDataParser(n),t(o)},onFailure:r,onTimeout:r})}))},getTenant:function(){var t=this;return e.is(t._tenant)||(t._tenant=widget.getValue("x3dPlatformId")),t._tenant},switchPlatform:function(e){return!(!e||!e instanceof String)&&(widget.setValue("x3dPlatformId",e),this._tenant=e,!0)},getUser:function(e){var t=this,i="";if(t._user)return"isFullName"===e?i=t._user.firstName+" "+t._user.lastName:"isTrigram"===e?i=t._user.id:i},form3DXContent:function(e){return{protocol:"3DXContent",version:"1.1",source:widget.getValue("appId"),widgetId:widget.id,data:{items:this.getItemDetailsToShare(e)}}},getItemDetailsToShare:function(e){var t=this,i=[],n=t.getSecurityContext();let o=widget.getValue("ngFilter");if(o&&(o=JSON.parse(o)),1==e.length&&e[0].isRoot()&&o&&o.filterId){let e={envId:t.getTenant(),serviceId:"3DSpace",contextId:n,objectId:o.filterId,objectType:p.identifiers.type_act_advfilter,displayName:o.filterTitle,displayType:p.identifiers.type_advfilter};i.push(e)}else e.forEach((function(e){i.push({envId:t.getTenant(),serviceId:"3DSpace",contextId:n,objectId:e.getID(),objectType:e.options.grid.actualType||e.options.type,displayName:e.getLabel(),facetName:"realized",path:[{resourceid:e.getID(),type:e.getType()}]})}));return i},setObjectOnCompass:function(t){var n=this,o=e.is(widget)&&widget.id?"flcockpitcompassSocket_"+widget.id:"flcockpitcompassSocket";n.flcockpitIntercom||(n.flcockpitIntercom=new i.Socket(o),n.flcockpitIntercom.subscribeServer("com.ds.compass",window.parent)),0===t.data.items.length?(n.flcockpitIntercom.dispatchEvent("onResetObject",{}),n.flcockpitIntercom.dispatchEvent("onResetX3DContent",{},o)):(n.flcockpitIntercom.dispatchEvent("onSetObject",t.data.items[0]),n.flcockpitIntercom.dispatchEvent("onSetX3DContent",t,o))},launchCrossAppSelection:function(e){var t={attributes:e.reduce((function(e,t){return e[t.getID()]={type:t.getType(),label:t.getLabel()},e}),{}),paths:e.map((function(e){return e.getOccurencePath()})),version:"1.1"},i={metadata:{uid:Math.random(),originUid:Math.random(),timestamp:Date.now(),appid:widget.getValue("appId")+"_"+widget.id,originWidgetId:widget.id},data:t};o.publish("DS/PADUtils/PADCommandProxy/select",i)},getTypeIconUrl:function(e){let t,i,n=this,o=p.mappingType[e];return o.custo?(i=p.mappingType.iconsCommonImagePath.substring(p.mappingType.iconsCommonImagePath.indexOf("enovia")+6),t=n.getServiceURL("3DSpace")+i+o.icon):t=n.getServiceURL("3DSpace")+"/snresources/images/icons/small/"+o.icon,{iconPath:t,iconSize:{width:"16px",height:"16px"}}},credentialDataParser:function(e){let t,i,n,o=" â— ",r=this;r._theListSC=[],r._theListSC_NLS=[],r.returnList=[],r._SCPreferredDB=null;let a=e.preferredcredentials;if(a.collabspace&&a.role&&a.organization){let e=a.collabspace,o=a.role;var s=a.organization;t=e.name,i=o.name,n=s.name,r._SCPreferredDB=i+"."+n+"."+t}let l=e.collabspaces;if(l&&l.length>0){let e,t=!1;for(let i=0;i<l.length;i++){let n=l[i].couples||[];for(let i=0;i<n.length;i++){let o=n[i];if(void 0===e&&(e=o.organization.name),e!==o.organization.name){t=!0;break}}if(t)break}for(let e=0;e<l.length;e++){let i=l[e],n=i.name,a=i.title,s=i.couples;for(let e=0;e<s.length;e++){let i=s[e],l=i.organization,c=i.role,d=l.name,u=l.title,p=c.name,g=c.nls,f=p+"."+d+"."+n,m=t?a+o+u+o+g:a+o+g;r._theListSC.push(f),r._theListSC_NLS.push(m),r.returnList.push({label:m,value:f})}}}return{optionList:r.returnList,defaultValue:r._SCPreferredDB}},retrieveCSRFToken:function(){var e=this;return new t((function(t,i){var o=e.getServiceURL("3DSpace")+p.webservices.getCSRFToken+"?tenant="+e.getTenant();n.authenticatedRequest(o,{method:"GET",type:"json",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(i){e.csrfToken=i.csrf.value,t()},onFailure:i,onTimeout:i})}))},refreshCSRFToken:function(){var e=this;setTimeout((function(){e.retrieveCSRFToken(),e.refreshCSRFToken()}),9e5)},getCSRFToken:function(){return this.csrfToken},SAXStorage:function(){return{setItem(e,t){e.contains(p.localStorageKeys.recentlyAuthored)&&s.getFLWebModelEventsObj("flweb-model-events")&&s.getFLWebModelEventsObj("flweb-model-events").publish({event:"item-loaded-from-database",data:{id:e,timestamp:t,authoring:!0}}),localStorage.setItem(e,t),widget.setValue(e,t)},getItem:e=>widget.getValue(e)||localStorage.getItem(e)||null,removeItem(e){localStorage.removeItem(e),widget.deleteValue(e)}}},get3DswymUrl:function(){return this.getServiceURL("3DSwym")},getUserImage:function(e){return this.get3DswymUrl()&&e?this.get3DswymUrl()+"/api/user/getpicture/login/"+e+"/format/normal":null},getNlsBasicAttributesBO:function(e){return p.nlsBasicAttributesBO[e]||e},getNlsBasicAttributesRel:function(e){return p.nlsBasicAttributesRel[e]||e},setWidgetLink:function(e){p.widgetLink=e},getWidgetLink:function(){return p.widgetLink}}})),define("DS/CATFLCockpitWidget/components/PropertiesPanel/facets/RelatedDocumentsFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/CATFLCockpitWidget/utils/config.util","DS/EditPropWidget/facets/Common/FacetsBase","DS/ENOXAttachmentsUX/AttachmentsPane","DS/ENOXSpecificationsUX/SpecificationsPane","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l){"use strict";let c=s.getFLWebModelEventsObj("flcockpit-content-list-view");return t.extend(i,o,{init:function(e){this._parent(e),this.buildView(e)},buildView:function(){var t=this;let i,o=this.getActiveNodeDetails().node,s=n.getSecurityContext();s=s.split(".")[0],i=o&&o.options&&o.options.grid&&o.options.grid.organization&&o.options.grid.project?s+"."+o.options.grid.organization+"."+o.options.grid.project:n.getSecurityContext(),t.elements.container=e.createElement("div",{class:t.options.specificationDocuments?"relatedDocuments_spec":"relatedDocuments"}),t.multiselDisplay=e.createElement("div",{class:"notSupported"}).inject(t.elements.container),t.iconHolder=e.createElement("span",{class:"blockIcon"}).inject(t.multiselDisplay),t.infoMsgH2Tag=e.createElement("h2",{class:"information_msg"}).inject(t.multiselDisplay),t.multiselDisplay.hide();var l={parentObject:{parentId:o.options.physicalid},connectorOptions:{fetchSecurityContext:function(){return i},getWorkUnderHeaders:function(){return n.getAuthorizedWorkUnder()},platformUrls:{"3DSpace":n.getServiceURL("3DSpace"),platformId:n.getTenant()},webinwin:!1}};t.options.specificationDocuments?(t.documentsPane=new a(l),t.documentsPane.modelEvents.subscribe({event:"upload-attachment-complete"},(function(){t.refreshNode()})),t.documentsPane.modelEvents.subscribe({event:"attach-attachment-complete"},(function(){t.refreshNode()})),t.documentsPane.modelEvents.subscribe({event:"detach-attachment-complete"},(function(){t.refreshNode()}))):t.documentsPane=new r(l),t.elements.container.appendChild(t.documentsPane.elements.container),t.multiselDisplay.isHidden()||t.documentsPane.hide()},refreshNode:function(){var e=this.getActiveNodeDetails().node;c.publish({event:"refresh-documents-by-id",data:{nodes:[e],docType:"specificationDocumentsCategory"}})},getActiveNodeDetails:function(){var e=null,t=null;if(this.options.getAppContext()){var i=this.options.getAppContext().getTreeDocument().getSelectedNodes();if(0===i.length){var n=this.options.getAppContext().getTreeDocument().getRoots()[0];n&&(e=n.options.physicalid,t=n)}else 1===i.length&&(e=i[0].options.physicalid,t=i[0])}return{nodeID:e,node:t}},updateFacet:function(){var e=this.getActiveNodeDetails().nodeID;!e||"specificationDocumentsCategory"===this.getActiveNodeDetails().node.getParent().options.type&&"SPECIFICATION_DOCUMENT"===this.options.tabId?this.notApplicable():(this.multiselDisplay.hide(),this.documentsPane&&(this.documentsPane.show(),this.documentsPane.options.parentObject.parentId!==e&&this.documentsPane.setParentObject({parentId:e})))},destroyComponent:function(){},notApplicable:function(){this.infoMsgH2Tag.setText(l.msg_not_supported_selection),this.iconHolder.addClassName("wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-block"),this.multiselDisplay.show(),this.documentsPane&&this.documentsPane.hide()},onResize:function(){},onRefresh:function(){}})})),define("DS/CATFLCockpitWidget/utils/common.util",["UWA/Core","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","UWA/Controls/Drag","DS/Windows/Panel","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/Tab","DS/Tweakers/TweakerDate","DS/CATFLCockpitWidget/utils/model.events.util","DS/DataDragAndDrop/DataDragAndDrop","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","DS/CATFLCockpitWidget/utils/config.util","DS/Utilities/DateUtils","DS/i3DXCompassPlatformServices/OpenWith"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f){"use strict";let m,h=p.getFullConfig(),v=h.localStorageKeys,C=t;i.setNotificationManager(C),i.setStackingPolicy(17),require(["DS/CATFLCockpitWidget/utils/gridview.util.extended"],(function(e){m=e}));var y={alertMessage:function(e,t,i,n,o){i=i?i.replace(/(\r\n|\n|\r)/gm,"<br>"):"",n=n?n.replace(/(\r\n|\n|\r)/gm,"<br>"):"",C.addNotif({level:e,title:t,subtitle:i,message:n,sticky:!1,helpResources:{WebHelp:o}})},displayError:function(t,i,n,o,r){var a=o;t&&(t.errorResp&&t.errorResp.message&&500!==t.errorResp.status?a=t.errorResp.message:e.is(t.error,"string")&&(a=t.error)),n=n?n.replace(/(\r\n|\n|\r)/gm,"<br>"):"",a=a?a.replace(/(\r\n|\n|\r)/gm,"<br>"):"",y.alertMessage("error",i,n,a,r)},create3DXJsonFromDGVSelection:function(e,t){var i,n=[];t=void 0===t||t;let o=widget.getValue("ngFilter");if(o&&(o=JSON.parse(o)),1===e.length&&e[0].isRoot()&&o&&o.filterId)i={contextId:"ctx::"+p.getSecurityContext(),displayName:o.filterTitle,displayType:h.identifiers.type_advfilter,objectId:o.filterId,objectType:h.identifiers.type_act_advfilter,envId:p.getTenant(),serviceId:"3DSpace"},n.push(i);else for(var r=0;r<e.length;r++){if(i={contextId:"ctx::"+p.getSecurityContext(),displayName:e[r].options.label,displayType:e[r].options.grid.actualType||e[r].options.type,objectId:e[r].options.physicalid,objectType:e[r].options.grid.actualType||e[r].options.type,envId:p.getTenant(),serviceId:"3DSpace"},t){var a=e[r].getParent().options.physicalid;void 0!==a&&a.length>0&&(i.path=this._createPathFor3DXContent(e[r]))}n.push(i)}return{protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("appId"),widgetId:widget.id,data:{items:n}}},_createPathFor3DXContent:function(e){for(var t=[],i=e;void 0!==i.options.physicalid;)t.push({resourceid:i.options.physicalid,type:h.identifiers.type_act_logref}),i.options.instance&&i.options.instance.physicalid&&t.push({resourceid:i.options.instance.physicalid,type:h.identifiers.type_act_loginstance}),i=i.getParent();return t.reverse()},debounce:function(e,t,i){var n;return function(){var o=this,r=arguments,a=i&&!n;clearTimeout(n),n=setTimeout((function(){n=null,i||e.apply(o,r)}),t),a&&e.apply(o,r)}},getFileInput:function(){var t=new e.createElement("input",{id:"fileExplorer",type:"file",styles:{display:"none"}}).inject(widget.body);return t.removeEvents(),t},makeDroppable:function(t,i,n){var o=this,r=t.getElement("#drop-invite");r||(r=new e.createElement("div",{id:"drop-invite",class:"hidden",html:i}).inject(t)),r.callback=n;var a={enter:o._manageDragEvents.bind(o),leave:o._manageDragEvents.bind(o),over:o._manageDragEvents.bind(o),drop:o._manageDropEvent.bind(o)};d.droppable(t,a)},_manageDragEvents:function(e,t){var i,n=(i=e).getElement("#drop-invite");switch(t.type){case"dragenter":case"dragover":i.addClassName("droppable"),n.removeClassName("hidden"),n.addClassName("show");break;case"dragleave":if(t.target!==n)return!1;i.removeClassName("droppable"),n.removeClassName("show"),n.addClassName("hidden")}return!0},_manageDropEvent:function(t,i){var n,o=(n=i).getElement("#drop-invite");if(t.trim().length>0){if(e.is(t,"string"))try{t=JSON.parse(t)}catch{t=null}var r=t&&t.data&&t.data.items?t.data.items:null;o.callback(r)}n.hasClassName("droppable")&&n.removeClassName("droppable"),o.removeClassName("show"),o.addClassName("hidden")},cleanDragNDrop:function(e,t){d.clean(e,t)},formatDate:function(e){return e instanceof Date?e:(e.indexOf("@")>=0&&(e=e.replace("@"," ")),e.indexOf(":GMT")>=0&&(e=e.replace(":GMT"," GMT")),new Date(e))},displayDate:function(e,t){if(t=t||{},e instanceof Date)return g.formatDateToString(e,t);var i=this.formatDate(e);return g.formatDateToString(i,t)},addDateTimeAsTweaker:function(e,t){var i=new l({value:e,readOnly:!0,displayStyle:"date",timePickerFlag:!0,timePickerPrecision:"sec"});return t&&i.inject(t),i},isDateEqual:function(e,t){if(e===t)return!0;if(e&&t){var i=y.formatDate(e),n=y.formatDate(t);return i.setHours(0,0,0),n.setHours(0,0,0),i.getTime()===n.getTime()}return!1},checkIfRecentlyAuthored:function(e,t){var i,n=parseInt(widget.getPreference(v.timeoutIndex).value,10);i=t?v.recentlyAuthoredStructure:v.recentlyAuthored;var o=p.SAXStorage().getItem(i+e);if(null!==o){if(Date.now()-parseInt(o,10)<1e3*n)return c.getFLWebModelEventsObj("flweb-model-events").publish({event:"item-loaded-from-database",data:{id:e,timestamp:o}}),!0;p.SAXStorage().removeItem(i+e)}return!1},checkIfMaturityIsReleasedOrObsolete:function(e){return null!=e&&(-1!==e.indexOf("RELEASED")||-1!==e.indexOf("OBSOLETE"))},getUserWorkUnderPositionPref:function(){try{return widget.getPreference(v.workunderpos).value}catch{return null}},getUserWorkUnderShowPref:function(){try{return widget.getPreference(v.displayWorkUnder).value}catch{return null}},getUserWorkUnderOnConfig:function(){try{return widget.getPreference(v.workunderonconfig).value}catch{return null}},setUserWorkUnderOnConfig:function(e){widget.setValue(v.workunderonconfig,e)},setCfgAuthoringContextDragEvent:function(e){e||(e=widget.body.getElement(".fl-cockpit-triptych-main-container")),!this.bubbleDragControl&&e&&(this.bubbleDragControl=new n.Move({container:e,delegate:"#BubbleContainer > *",centerHandles:!0,handles:function(e){return e.target.getClosest("#BubbleContainer")},stop:function(){var t=e.querySelector("#BubbleContainer");if(t){var i=t.style.top,n=t.style.left;widget.setValues({"bubble-top":i,"bubble-left":n})}}}))},unsetCfgAuthoringContextDragEvent:function(){var e=this;if(e.bubbleDragControl){e.bubbleDragControl&&(e.bubbleDragControl.destroy(),e.bubbleDragControl=null);var t=widget.getElement(".fl-cockpit-triptych-main-container").querySelector("#BubbleContainer");if(t){var i=t.style.top,n=t.style.left;(i||n)&&t.setStyles({top:null,left:null})}widget.setValue("bubble-top",null),widget.setValue("bubble-left",null)}},getOpenWithCompatibleApps:function(t,i){if(t){var n=p.form3DXContent([t]);i&&(n.data.items[0].objectTaxonomies=i,n.data.items[0].objectTaxonomies.push(t.options.grid.actualType||t.options.type));var o=new f;return o.set3DXContent(n,!1),e.is(o.retrieveCompatibleApps,"function")?new Promise((function(t){e.is(o.retrieveCompatibleApps,"function")?o.retrieveCompatibleApps((function(e){t(e)})):t([])})):void 0}},downloadFile:function(e,t,i){var n="text/plain;charset=utf-8";if(i&&(t="\ufeff"+t),window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(new Blob([t],{type:n}),e);else if(document.queryCommandSupported("SaveAs")){var o=document.createElement("iframe");o.setAttribute("style","display:none;"),document.body.appendChild(o),o.contentWindow.document.open("text/html","replace"),o.contentWindow.document.write(t),o.contentWindow.document.close(),o.contentWindow.focus(),o.contentWindow.document.execCommand("SaveAs",!0,e),document.body.removeChild(o)}else{var r,a=window.document.createElement("a");"download"in a?(r=URL.createObjectURL(new Blob([t],{type:n})),a.setAttribute("download",e)):(r="data:"+n+","+encodeURIComponent(t),a.setAttribute("target","_blank"),a.setAttribute("download",e)),a.href=r,a.setAttribute("style","display:none;"),document.body.appendChild(a),setTimeout((function(){if(a.click)a.click();else if(document.createEvent){var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0),a.dispatchEvent(e)}document.body.removeChild(a)}),0)}},convertToDoubleDigit:function(e){var t=e;return e<10&&(t="0"+e),t},validateTenant:function(e){var t=p.getTenant(),i=e.envId;return p.switchPlatform(i)?(widget.getPreference("xPref_3DEXPERIENCE_PLATFORM")&&widget.setValue("xPref_3DEXPERIENCE_PLATFORM",i),y.alertMessage("info",null,u.info_platform_changed),!0):(y.alertMessage("error",null,u.replace(u.error_incorrect_platform,{displayName:e.displayName,tenant:t})),!1)},getUserCustomAttributes:function(e){return e?h.userAdditionalAttributesForPhysicalProduct:h.userAdditionalAttributes},getUserCustomAttributesCURI:function(){var e={bo:[],rel:[]},t=y.getUserCustomAttributes();return t&&t.forEach((function(t){t.bo&&!e.bo.includes(t.curi)?e.bo.push(t.curi):t.bo||e.rel.includes(t.curi)||e.rel.push(t.curi)})),e},createBatchServiceReqExecution:function(e,t,i,n,o){var r=e.length,a=this;if(0===r)return;n||(a.occNodesToExpand={});let s=widget.getValue(v.componentView);var l=Math.ceil(r/50),d=widget.getValue("currentConfig");let u=widget.getValue("xRevision");var p=null;d&&d.filterCompiledForm?p=d.filterCompiledForm:u&&u.filterCompiledForm&&(p=u.filterCompiledForm);let g=[];var f,h;c.getFLWebModelEventsObj("flcockpit-content-list-view").subscribe({event:"content-list-view-referenceLinks-loaded"},(function(n){if(a.occNodesToExpand&&Object.keys(a.occNodesToExpand).length>0){let o=[];if(n.forEach((function(e){a.occNodesToExpand[e]&&(o=o.concat(a.occNodesToExpand[e]),delete a.occNodesToExpand[e])})),o.length>0){let n=a.expandNodesBasedonLevel.bind(a,e,t,i);a.occNodesToExpand&&0!==Object.keys(a.occNodesToExpand).length?m.addOccImplementLinksToNodesInBatch(o,i.collectionView.treeDocument):m.addOccImplementLinksToNodesInBatch(o,i.collectionView.treeDocument,n)}}}));for(var C=0;C<l;C++)if(f=50*C,h=e.slice(f,f+50),g.push(m.getExpandServicesForBatchCalls(h,p,n,t,i)),h.forEach((function(e){e.options.noIndexOrDBExpand=!0,e.options.hasBeenExpanded=!0,n||("-1"===t?e.options.dontExpandAllLvl=!0:"2"===t&&(e.options.dontExpandTwoLvl=!0))})),n&&o&&s===v.structuredView){a.occNodesToExpand||(a.occNodesToExpand={});let e=[];h.forEach((function(t){let i=t.options.actualParent;i.options.implementLinks&&e.push(i.options.physicalid);let n=a.occNodesToExpand[i.options.physicalid]||[];n.push(t),a.occNodesToExpand[i.options.physicalid]=n})),a.actionPendingNodes||(a.actionPendingNodes={}),a.actionPendingNodes[o.options.physicalid]||(a.actionPendingNodes[o.options.physicalid]={node:o,level:t}),e.length>0&&c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-referenceLinks-loaded",data:e})}return Promise.all(g)},expandNodesBasedonLevel:function(){let e=this;for(let t in e.actionPendingNodes){let i=e.actionPendingNodes[t].level,n=e.actionPendingNodes[t].node;"-1"===i?n.expandAll():"2"===i&&n.expandNLevels({numberOfLevelsToExpand:"2"}),delete e.actionPendingNodes[t]}},sortNodesIntoDBandIndex:function(e,t){let i,n={},o=[],r=[];return e&&e.length>0&&e.forEach((function(e){if(t){if(i=y.checkIfRecentlyAuthored(e.options.physicalid,!0),!i){let t=e.getOccurencePath();for(let e=0;e<t.length;e+=2)if(y.checkIfRecentlyAuthored(t[e],!0)){i=!0;break}}}else i=y.checkIfRecentlyAuthored(e.options.physicalid);i?o.push(e):r.push(e)})),n.databaseNodes=o,n.indexNodes=r,n},createReportStatusPanel:function(t,i){var n=new e.Element("div"),r=new s({displayStyle:"strip"});function a(t){for(var i=new e.Element("ul"),n=0,o=t.length;n<o;n++){var r=e.Element("div",{styles:{"white-space":"pre-line"}});r.textContent=t[n],i.appendChild(new e.Element("li").appendChild(r))}var a=new e.Element("div",{styles:{padding:"2px","word-wrap":"break-word"}});return a.appendChild(new e.Element("div").appendChild(i)),a}r.reorderFlag=!1,r.pinFlag=!0,r.showComboBoxFlag=!1,r.editableFlag=!1,r.multiSelFlag=!0,r.centeredFlag=!1,r.touchMode=!0;var l=0;function c(e,t,i){i&&i.length>0&&(e.add({label:t+" ("+i.length+")",content:a(i),isSelected:0===l,index:l}),l++)}return c(r,u.success_header,i.success),c(r,u.warning_header,i.warning),c(r,u.error_header,i.error),r.inject(n),new o({title:t,content:n,position:{my:"center",at:"center"},width:600,allowedDockAreas:0,immersiveFrame:widget.immersiveFrame,resizableFlag:!0,collapsibleFlag:!1,minWidth:600,minHeight:85})},getUserCustomHeaderView:function(){return h.customHeaderView},createMapSelectableForAdditionalAttr:function(){var e={},t=y.getUserCustomAttributes();return t&&t.forEach((function(t){t.selectable&&t.selectable.length?Array.isArray(t.selectable)?t.selectable.forEach((function(i){e[i.toLowerCase()]=t})):e[t.selectable.toLowerCase()]=t:Object.values(t.selectable).flat().forEach((function(i){e[i.toLowerCase()]=t}))})),e},getNLSValueFromRangeValuesAttribute:function(e,t,i,n){if(void 0!==e.rangeValues&&i[t]&&("string"===e.type||"date"===e.type||"integer"===e.type||"number"===e.type))if(n&&(n[t]=i[t]),e.multiValuated){if(i[t]=Array.isArray(i[t])?i[t]:i[t].split(","),n&&(Array.isArray(i[t])?n[t]=i[t].slice():n[t]=i[t]),"string"===e.type||"integer"===e.type||"number"===e.type)for(let n=0;n<i[t].length;n++){let o=e.rangeValues.find((function(e){return e.value===i[t][n]}));o&&(i[t][n]=o.nlsValue)}else if("date"===e.type)for(let n=0;n<i[t].length;n++){let o=e.rangeValues.find((function(e){return y.isDateEqual(e.value,i[t][n])}));o&&(i[t][n]=o.formatDateValue)}}else if("string"===e.type||"integer"===e.type||"number"===e.type){let n=e.rangeValues.find((function(e){return e.value===i[t]}));n&&(i[t]=n.nlsValue)}else if("date"===e.type){let n=e.rangeValues.find((function(e){return y.isDateEqual(e.value,i[t])}));n&&(i[t]=n.formatDateValue)}}};return y})),define("DS/CATFLCockpitWidget/utils/xhr.util",["DS/WAFData/WAFData","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n){"use strict";var o=t.getFullConfig(),r=o.webservices.getCSRFToken;return{get:function(e,t){return this.makeServiceCall(e,"GET",null,null,null,t)},post:function(e,t,i,n){return this.customTimeout=i,this.makeServiceCall(e,"POST",t,null,null,n)},patch:function(e,t){return this.makeServiceCall(e,"PATCH",t)},put:function(e,i,n,o){var r,a,s="PUT";return r=n?{method:s,headers:n,data:i||null}:this.generateFetchOptions(s,!0,!0,!0,!1,i),a=o&&o.targetService?o.targetService:"3DSpace",r.targetService=a,e=t.getServiceURL(a)+e,this.buildAjaxCall(e,r,s)},makeServiceCall:function(e,i,n,o,r,a){var s,l,c,d,u;s=!a||"boolean"!=typeof a.accept||a.accept,l=!a||"boolean"!=typeof a.content||a.content,c=!a||"boolean"!=typeof a.secCtx||a.secCtx,d=!a||"boolean"!=typeof a.authoringCtx||a.authoringCtx,a&&"number"==typeof a.timeout&&(this.customTimeout=a.timeout);var p=r?this.generateFetchOptions("POST",!1,!0,!0,!0,n):this.generateFetchOptions(i,s,l,c,d,n),g="",f=!1;return window.location.href.indexOf("createLogicalReferencesFromDiagram.html")>-1||window.location.href.indexOf("setArchitectureNumberOnPSpool.html")>-1||window.location.href.indexOf("validateEffectivityIsImplementedBy.html")>-1?(g=window.location.href.substring(0,window.location.href.indexOf("/webapps")),f=!0):(u=a&&a.targetService?a.targetService:r?"3DSearch":"3DSpace",g=t.getServiceURL(u)),(p=r?this.generateFetchOptions("POST",!1,!0,!0,!0,n):this.generateFetchOptions(i,s,l,c,d,n,f)).targetService=u,a&&a.responseType&&(p.responseType=a.responseType),e=r?t.getServiceURL("3DSearch")+"/search":g+e,f&&a&&a.wiwSecurityContext?p.headers.SecurityContext=a.wiwSecurityContext:a&&a.securityContext&&(p.headers.SecurityContext=a.securityContext),this.buildAjaxCall(e,p,i,o)},makeMultipleServiceCalls:function(e,t){var i=this;if(t)return UWA.Promise.all(e);var n=e.map((function(e){return i.makeServiceCall(e.url,e.method,e.data,e.noCSRF,e.isIndexCall)}));return UWA.Promise.all(n)},generateFetchOptions:function(e,i,n,o,r,a,s){var l={};l["Accept-Language"]=widget.lang,i&&(l.Accept="application/json"),n&&(l["Content-Type"]="application/json"),o&&(l.SecurityContext=t.getSecurityContext());var c=t.getAuthorizedWorkUnder(s);return r&&c&&"GET"!==e&&Object.assign(l,c),{method:e,headers:l,data:a||null}},buildAjaxCall:function(e,i,n,o){var a=this;return o||"POST"!==n&&"PATCH"!==n&&"DELETE"!==n?a.createPromiseFunction(e,i):window.location.href.indexOf("createLogicalReferencesFromDiagram.html")>-1||window.location.href.indexOf("setArchitectureNumberOnPSpool.html")>-1||window.location.href.indexOf("validateEffectivityIsImplementedBy.html")>-1?a.get(r).then((function(t){return i.headers.ENO_CSRF_TOKEN=JSON.parse(t).csrf.value,i.headers.SecurityContext?a.createPromiseFunction(e,i):a.get("/resources/pno/person/getsecuritycontext").then((function(t){return i.headers.SecurityContext=JSON.parse(t).SecurityContext,a.createPromiseFunction(e,i)}))})):(i.headers.ENO_CSRF_TOKEN=t.getCSRFToken(),a.createPromiseFunction(e,i))},createPromiseFunction:function(r,a){var s=this;return new Promise((function(l,c){Number.isInteger(s.customTimeout)&&(a.timeout=s.customTimeout),a.onComplete=l,a.onFailure=function(e,t){try{t=JSON.parse(t)}catch{t={}}c({error:e,errorResp:t})},a.onTimeout=function(e){i.alertMessage("error","",n.error_request_timedOut),c({error:e})},o.identifiers.tenant_based_services.indexOf(a.targetService)>=0&&(r.indexOf("?")>=0?r+="&tenant="+t.getTenant():r+="?tenant="+t.getTenant()),e.authenticatedRequest(r,a)}))}}})),define("DS/CATFLCockpitWidget/services/thumbnail.service",["DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/WAFData/WAFData"],(function(e,t,i,n){"use strict";var o=i.getFullConfig();i.getFullConfig().webservices.getCSRFToken;return{createFCSTicket:function(){var t=o.webservices.generateFCSTicket;return e.makeServiceCall(t,"PUT")},checkInThumbNail:function(e,t,i){var n=this,o={};o.method=i,o.headers={},t&&(o.data=t);return new Promise((function(t,i){n.createPromiseFunction(e,o,t,i)}))},createPromiseFunction:function(e,t,o,r){t.onComplete=o,t.onFailure=r,t.onTimeout=r,e.indexOf("?")>=0?e+="&tenant="+i.getTenant():e+="?tenant="+i.getTenant(),n.authenticatedRequest(e,t)}}})),define("DS/CATFLCockpitWidget/services/common.service",["DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/PlatformAPI/PlatformAPI","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s){"use strict";var l=n.getFullConfig();a=JSON.parse(a);return{getItemInfo:function(e){var t=l.webservices.getItemInfo+l.webservices.getConfigInfoMask;return i.post(t,JSON.stringify(e),0).then((function(e){return JSON.parse(e)}))},applyWorkUnderEvolution:function(e,o){var a=e.model,s=e.modelVer,c=e.xRev,d={},u=l.webservices.evolutionExpr.url;if(c&&c.xRevAttachedId){var p=l.webservices.evolutionExpr.xmlExprxRev;p=p.replace(new RegExp("{versionID}","g"),c.xRevVer),d={"Dictionary Contexts":c.xRevAttachedId,"Evolution Expression":p}}else{if(!a.physicalid||!s.physicalid)return Promise.reject(new Error("invalid input"));var g=l.webservices.evolutionExpr.xmlExpr;g=(g=(g=g.replace(new RegExp("{modelName}","g"),a.name)).replace(new RegExp("{productName}","g"),s.backEndName)).replace(new RegExp("{productRevision}","g"),s.revision);let e=a.displayName?a.displayName:a.name;g=(g=g.replace(new RegExp("{productTitle}","g"),s.name)).replace(new RegExp("{modelTitle}","g"),e),d={"Dictionary Contexts":a.physicalid,"Evolution Expression":g}}if(o){return i.post(u,JSON.stringify(d)).then((function(e){if(null!==(e=JSON.parse(e)).ACId&&""!==e.ACId&&null!==e.XSLTExpr&&""!==e.XSLTExpr)return n.setAuthIDforWIW("evolution",e.ACId),"Success"})).catch((function(e){console.error(e)}))}return i.post(u,JSON.stringify(d)).then((function(e){if(null!==(e=JSON.parse(e)).ACId&&""!==e.ACId&&null!==e.XSLTExpr&&""!==e.XSLTExpr){var i=r.get();i.evolution.id=e.ACId,i.evolution.displayExpression=e.XSLTExpr,c&&(i.evolution.xRevReferencePId=c.xRevAttachedId),r.setEffectivity(i),t.publish("sessionEff",i),t.publish("toggleActiveSE")}})).catch((function(e){let t=e&&e.errorResp&&e.errorResp.errorMessage?e.errorResp.errorMessage:null;return console.error(e),Promise.reject(t)}))},getUserPreferences:function(e){var t=l.webservices.getUserPreferences;return t=t+"?name="+e,i.get(t,{secCtx:!1,targetService:"3DCompass"}).then((function(e){var t={};return e&&""!==e&&(t=JSON.parse(e)),t})).catch((function(e){o.displayError(e,null,null,s.error_get_user_pref)}))},setUserPreferences:function(e){var t=l.webservices.setUserPreferences,n={};e&&(n=e);return i.put(t,n,{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},{targetService:"3DCompass"}).then((function(e){return JSON.parse(e)})).catch((function(e){o.displayError(e,null,null,s.error_set_user_pref)}))},getKindOfRFLP:function(e){var t=l.webservices.getItemInfo+l.webservices.isKindOfFetchField;return i.post(t,JSON.stringify(e)).then((function(e){var t=[];return e&&(e=UWA.is(e,"string")?JSON.parse(e):e).member&&e.member[0]&&e.member[0].kindOfRFLP&&e.member.forEach((function(e){t.push(e.kindOfRFLP)})),t}))},getVisualCues:function(){var e=l.webservices.getVisualCues;return i.post(e,JSON.stringify({})).then((function(e){return JSON.parse(e)})).catch((function(){}))},exportVisualCues:function(e,t){var n=l.webservices.exportConvergenceCues;return this.getUserPreferences(a.user_pref_cues).then((function(r){var a=r.cues_state,l=r.combined_state;if(a&&Object.keys(a).length>0){var c=Object.values(a),d={};if(l&&l.active){for(var u in l.combinedCues)l.combinedCues.hasOwnProperty(u)&&(l.combinedCues[u]=l.combinedCues[u]);d={isCombinedConvergenceActivated:!0,combinedConvergenceOperator:l.operator,combinedConvergenceDefinition:l.combinedCues}}else d.isCombinedConvergenceActivated=!1;var p={cueInfo:c,instanceIds:e,occurrenceInfo:t,combinedConvergenceInfo:d};return i.post(n,JSON.stringify(p),0,{responseType:"arraybuffer"}).then((function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"}),i=document.createElement("a");i.href=URL.createObjectURL(t);var n=new Date,r=o.convertToDoubleDigit(n.getMonth()+1),a=o.convertToDoubleDigit(n.getDate()),l=o.convertToDoubleDigit(n.getHours()),c=o.convertToDoubleDigit(n.getMinutes()),d=o.convertToDoubleDigit(n.getSeconds()),u=r+"_"+a+"_"+n.getFullYear()+"_"+l+"_"+c+"_"+d;i.download="ExportConvergenceStates_"+u+".xlsx",i.click(),URL.revokeObjectURL(i.href),i.remove(),o.alertMessage("success",null,s.msg_cue_export_success)})).catch((function(e){return o.displayError(e,null,null,s.error_export_cues_failed),Promise.reject()}))}o.alertMessage("error",null,s.msg_userPref_cues)}))},validateVisualCues:function(e,t){var n=l.webservices.validateVisualCues;return this.getUserPreferences(a.user_pref_cues).then((function(r){var a=r.cues_state,l=r.combined_state;if(a&&Object.keys(a).length>0){var c=Object.values(a),d={};if(l&&l.active){for(var u in l.combinedCues)l.combinedCues.hasOwnProperty(u)&&(l.combinedCues[u]=l.combinedCues[u]);d={isCombinedConvergenceActivated:!0,combinedConvergenceOperator:l.operator,combinedConvergenceDefinition:l.combinedCues}}else d.isCombinedConvergenceActivated=!1;var p={cueInfo:c,instanceIds:e,occurrenceInfo:t,combinedConvergenceInfo:d};return i.post(n,JSON.stringify(p),0).then((function(e){return JSON.parse(e)}))}o.alertMessage("error",null,s.msg_userPref_cues)}))},getCuesReportOnInstance:function(e,t,n){var r=l.webservices.cuesReportOnInst,a={cueInfo:e,instanceId:t,occurrenceInfo:n};return i.post(r,JSON.stringify(a),0).then((function(e){return JSON.parse(e)})).catch((function(e){return o.displayError(e,null,null,s.msg_generic_error_get_failed),Promise.reject()}))},getParameterizationSetting:function(e){var t=l.webservices.getParameterizationSetting;return i.post(t,JSON.stringify(e)).then((function(e){return JSON.parse(e)})).catch((function(e){return o.displayError(e,null,null,s.msg_generic_error_get_failed),Promise.reject()}))},getTypeSchemaDetails:function(e){var t=l.webservices.getTypeSchemaDetails;return i.post(t,JSON.stringify(e)).then((function(e){return JSON.parse(e)})).catch((function(e){return o.displayError(e,null,null,s.msg_generic_error_get_failed),Promise.reject()}))},getExtensionsForClass:function(e){return i.post(l.webservices.getExtensionsForClass,JSON.stringify({class:e})).then((function(e){return JSON.parse(e).results})).catch((function(e){return o.displayError(e,null,null,s.error_get_extensions),[]}))},getPredicateValues:function(t){return new Promise((function(i){e.getNlsOfPropertiesValues(JSON.stringify(t),{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(e){i(e)}})}))},getTypeHierarchy:function(e){let t;return l._typeHierarchies||(l._typeHierarchies={}),l._typeHierarchies[e]&&(t=l._typeHierarchies[e]),new Promise((function(n){if(t)return void n(t);let o={types:[e]};var r=l.webservices.getTypeHierarchy;return i.post(r,JSON.stringify(o)).then((function(e){e=JSON.parse(e),l._typeHierarchies[e.types_hierarchies[0].type]=e.types_hierarchies[0].hierarchy,n(e.types_hierarchies[0].hierarchy)})).catch((function(){n([])}))}))}}})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/SetWorkUnderEvolutionCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/Toggle","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l){"use strict";var c=o.getFullConfig().localStorageKeys;return e.extend(t,{init:function(e){e=UWA.extend(e,{isAsynchronous:!1}),this._parent(e)},execute:function(){if(this.options.context){let e=n.getUserWorkUnderOnConfig();this.model=this.options.context.model,this.modelVersion=this.options.context.modelVersion,this.xRev=this.options.context.xRev,(this.model&&this.modelVersion&&"Release"!==this.modelVersion.current&&"Obsolete"!==this.modelVersion.current||this.xRev)&&(e===c.alwaysSetWorkunderOnConfig?this._synchronizeWorkUnder():e===c.askSetWorkunderOnConfig&&this._buildPrefWorkUnderDialog())}},_buildPrefWorkUnderDialog:function(){var e=this;this.prefWorkUnderDialog=new r({title:l.header_work_under_evolution,domId:"dialog-work-under-pref",content:this._createPrefWorkUnderContent(),immersiveFrame:widget.immersiveFrame,resizableFlag:!1,modalFlag:!0,buttons:{No:new a({onClick:function(){e.prefCheckbox.checkFlag&&n.setUserWorkUnderOnConfig(c.neverSetWorkunderOnConfig),e.prefWorkUnderDialog.destroy()}}),Yes:new a({onClick:function(){e.prefCheckbox.checkFlag&&n.setUserWorkUnderOnConfig(c.alwaysSetWorkunderOnConfig),e._synchronizeWorkUnder()}})}})},_createPrefWorkUnderContent:function(){var e=this;let t=UWA.createElement("div",{class:"container-work-under-pref"}),i={title:"",revision:""};return this.modelVersion?i={title:this.modelVersion.name,revision:this.modelVersion.revision}:this.xRev&&(i={title:this.xRev.xRevTitle,revision:this.xRev.xRevVer}),e.textInfoElement=UWA.createElement("div",{html:l.replace(l.msg_work_under_with_config,i),styles:{height:"auto",position:"relative",padding:"5px"}}),e.prefCheckbox=new s({type:"checkbox",value:0,checkFlag:!1,label:l.label_do_not_ask}),e.textInfoElement.inject(t),e.prefCheckbox.inject(t),t},_synchronizeWorkUnder:function(){var e=this;i.applyWorkUnderEvolution({model:e.model,modelVer:e.modelVersion,xRev:e.xRev}).then((function(){e.prefWorkUnderDialog.destroy()})).catch((function(t){n.alertMessage("error",l.msg_fail_work_under_with_config,t),e.prefWorkUnderDialog.destroy()}))}})})),define("DS/CATFLCockpitWidget/services/implementlink.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n){var o=e.getFullConfig();return{getRefImplementLinks:function(e){var r=o.webservices.createLogItem+e+o.webservices.keyMaskForService+o.masks.logItemImplementLinksMask;return i.get(r).then((function(e){var t=JSON.parse(e).member[0];return{implemented:t["Implemented by"],implementing:t.Implementing}})).catch((function(e){t.displayError(e,null,null,n.msg_generic_error_get_failed)}))},getInstanceImplementLinks:function(e,r,a){var s=this.confAllImplPathsOnNodes(e,r,!0,a),l=!1;if(s&&s.payload){let e=!1,t=!1;s.payload.isImplementingPath&&s.payload.isImplementingPath.length>0&&(e=!0),s.payload.isImplementedByPath&&s.payload.isImplementedByPath.length>0&&(t=!0),e||t||(l=!0)}else l=!0;if(l)return Promise.resolve();var c=o.webservices.getLogItemOccImplementLink;return i.post(c,JSON.stringify(s.payload),0).then((function(e){var t=JSON.parse(e).member,i=[];return t&&t.forEach((function(e){let t=e.selectedoccpath,n=UWA.is(t,"string")?t:t[t.length-1];s.pathData[n][t.toString()].forEach((function(t){i.push({node:t,implemented:e.isImplementedBy,implementing:e.isImplementing})}))})),i})).catch((function(e){t.displayError(e,null,null,n.msg_generic_error_get_failed)}))},confAllImplPathsOnNodes:function(e,t,i,n){let o=this,r={},a={},s=!0,l=!0;if(n&&(s=void 0===n.bIsImplementing||n.bIsImplementing,l=void 0===n.bIsImplementedBy||n.bIsImplementedBy),t){let e=widget.getValue("configurable_expand")||{};if(e.isImplementing?a.isImplementingPath=[]:s=!1,e.isImplementedBy?a.isImplementedByPath=[]:l=!1,!s&&!l)return{}}else a.isImplementingPath=[],a.isImplementedByPath=[];if(e&&e.length>0){let t,n;e.forEach((function(e){if(!e.isRoot()){t=e.options.instance.physicalid;let u=[];if(t&&(r[t]||(r[t]={}),s&&(n=o.getAllImplPaths("implementing",e,[],[]),n.forEach((function(i){u.push(i.join("|")),r[t][i]?r[t][i].push(e):(r[t][i]=[e],a.isImplementingPath.push(i))}))),l&&(n=o.getAllImplPaths("implemented",e,[],[]),n.forEach((function(i){let n=i.join("|");if(u.indexOf(n)<0)u.push(n),r[t][i]?r[t][i].push(e):(r[t][i]=[e],a.isImplementedByPath.push(i));else{a.isImplementedByPath.some((e=>i.every(((t,i)=>t===e[i]))))||a.isImplementedByPath.push(i)}}))),i)){var c=e.getNodesByRelId("implementinginst"+t)[0],d=e.getNodesByRelId("implementedinst"+t)[0];c&&c.remove(),d&&d.remove()}}}))}return{pathData:r,payload:a}},formAllImplPathsOnNodes:function(e,t){var i,n=this,o={};let r=!0,a=!0;if(t){let e=widget.getValue("configurable_expand")||{};if(e.isImplementing||(r=!1),e.isImplementedBy||(a=!1),!r&&!a)return o}return e&&e.length>0&&e.forEach((function(e){e.isRoot()||(i=e.options.instance.physicalid)&&(o[i]={},r&&(o[i].implementing=n.getAllImplPaths("implementing",e,[],[])),a&&(o[i].implementedBy=n.getAllImplPaths("implemented",e,[],[])))})),o},getAllImplPaths:function(e,t,i,n){var o=t.options.actualParent||t.getParent();if(o){if(i.push(t.options.instance.physicalid),o.isRoot())return i.reverse(),n.push(i),n;if(o.options.implementLinks&&o.options.implementLinks[e]){var r=i.slice();r.reverse(),n.push(r)}return this.getAllImplPaths(e,o,i,n)}},createScopeLinks:function(e){var t=o.webservices.createScopeLinks;return i.post(t,JSON.stringify(e),0).then((function(e){return e}))},deleteImplementLinks:function(e){var t=o.webservices.deleteImplementLinks;return i.post(t,JSON.stringify(e)).then((function(e){return e}))},createOccurrenceLinks:function(e){var t=o.webservices.createOccurrenceLinks;return i.post(t,JSON.stringify(e)).then((function(e){return e}))},deleteOccurrenceLinks:function(e){var t=o.webservices.deleteOccurrenceLinks;return i.post(t,JSON.stringify(e)).then((function(e){return e}))}}})),define("DS/CATFLCockpitWidget/services/model.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/WAFData/WAFData","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r){var a=e.getFullConfig(),s=a.identifiers;return{getModelPIDFromLogicalReference:function(e){return i.get(a.webservices.dsfl_getLogItem+e+"/model").then((function(e){var t=JSON.parse(e);if(void 0!==t.rootObjects){var i=t.rootObjects[0],n={};return i.attributes.forEach((function(e){void 0!==e.value&&(n[e.name]=e.value)})),i.attributes=n,i}return null})).catch((function(e){var i=e.error.message.slice(e.error.message.indexOf("ResponseCode")),n=r.error_get_model;i&&i.indexOf("404")>=0&&(n=r.error_get_model_media),t.displayError(e,null,null,n)}))},getModelVersionFromModelPID:function(t){let i,o=this,r=t.name,a=t.physicalid?t.physicalid:t.id;i=window.location.href.indexOf("createLogicalReferencesFromDiagram.html")>-1?window.location.href.substring(0,window.location.href.indexOf("/webapps")):e.getServiceURL("3DSpace");var s=i+"/resources/modeler/browsing/browseservice/pid:"+a+"/configurationdictionary?products=1&attributes=1&tenant="+e.getTenant(),l=new FormData;let c={filterExpression:'<?xml version="1.0" encoding="UTF-8"?><CfgFilterExpression xmlns="urn:com:dassault_systemes:config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:com:dassault_systemes:config CfgFilterExpression.xsd"><FilterSelection SelectionMode="Strict"><Context xmlns="urn:com:dassault_systemes:config" HolderType="Model" HolderName="'+r+'"/></FilterSelection></CfgFilterExpression>'};return l.append("evolutionExpression",JSON.stringify(c)),new Promise((function(t,i){var r={method:"POST",headers:{SecurityContext:e.getSecurityContext()||"","Accept-Language":widget.lang},data:l,onComplete:function(e){var i=JSON.parse(e).products,n=[];Object.keys(i).length>0&&(i.created=new Date(i.originated).getTime(),n.push(i)),o._addNextRevisionAndOrBranchToModelVersionsList(n,i),n=n.sort((function(e,t){return e.created>t.created?1:e.created<t.created?-1:0})),t(n)},onFailure:i,onTimeout:i};n.authenticatedRequest(s,r)}))},_addNextRevisionAndOrBranchToModelVersionsList:function(e,t){if(t["Main Derived"]&&void 0!==t["Main Derived"].id&&(t["Main Derived"].created=new Date(t["Main Derived"].originated).getTime(),e.push(t["Main Derived"]),this._addNextRevisionAndOrBranchToModelVersionsList(e,t["Main Derived"])),t.Derived&&t.Derived.length>0)for(var i=0;i<t.Derived.length;i++)t.Derived[i].created=new Date(t.Derived[i].originated).getTime(),e.push(t.Derived[i]),this._addNextRevisionAndOrBranchToModelVersionsList(e,t.Derived[i])},getProductConfigurationsFromModelVersion:function(e,t){var n="/resources/modeler/browsing/model/"+e+'/getproductconfigurations?filteringCriteria={"version": "1.0.0", "input": {"status": "0","basics": "owner,description,current,to[Product Configuration].from.attribute[Marketing Name],to[Product Configuration].from.revision","attributes": "FilterCompiledForm","productPIDs":"'+t+'"}}';return i.get(encodeURI(n)).then((function(e){return JSON.parse(e).productconfigurations}))},createVolatileFilter:function(e){var t,n=a.webservices.getVolatileFilter;return t="xRevisionElement"===e.type?'<CfgFilterExpression xs:schemaLocation = "urn:com:dassault_systemes:config CfgFilterExpression.xsd" xmlns:xs = "http://www.w3.org/2001/XMLSchema-instance" xmlns = "urn:com:dassault_systemes:config"><FilterSelection SelectionMode="Strict" SelectionView="Current"><XRevision><Single Revision = "'+e.modelVerRev+'"/></XRevision></FilterSelection></CfgFilterExpression>':'<CfgFilterExpression xs:schemaLocation = "urn:com:dassault_systemes:config CfgFilterExpression.xsd" xmlns:xs = "http://www.w3.org/2001/XMLSchema-instance" xmlns = "urn:com:dassault_systemes:config"><FilterSelection SelectionMode="150%" SelectionView="'+s.view_evolution_current+'"><TreeSeries Type = "ProductState" Name = "'+e.modelName+'"><Single Name = "'+e.modelVerName+'" Revision = "'+e.modelVerRev+'"/></TreeSeries></FilterSelection></CfgFilterExpression>',i.post(n,JSON.stringify({version:"1.2",output:{targetFormat:"TXT"},expression:{version:"0.1",format:"xml",content:t},dictionary:{version:"0.1",id:{pid:e.modelID}}})).then((function(e){return JSON.parse(e)}))},getConfigContextInfo:function(e){var n=a.webservices.getConfigContextInfo,o={version:"1.1",modelMask:"Read",enabledCriteria:"NO",cfgCtxt:"YES",xRevisionContent:"YES",pidList:e};return i.post(n,JSON.stringify(o),0).then((function(e){return JSON.parse(e)})).catch((function(){t.alertMessage("error",null,r.error_get_config_ctx)}))},getEffectivityInfo:function(e,t){var n=a.webservices.getEffectivityInfo,r={version:"1.3",output:{targetFormat:t||"TXT",withDescription:"YES",view:"ALL",domains:"ALL"},pidList:e},s=null;return"function"==typeof o.getConfigurationRevisionDetails&&(s=o.getConfigurationRevisionDetails().configurationRevision),s&&s.configRevision&&(r.configurationRev=s.configRevision[0].id),i.post(n,JSON.stringify(r),0).then((function(e){return JSON.parse(e).expressions})).catch((function(){}))},setMultipleFilterableObjectInfo:function(e,n){var o=a.webservices.setMultipleFilterableObjectInfo;let s={version:"1.2",expression:{output:{targetFormat:"TXT",withDescription:"YES",view:"All",domains:"All"},contentFormat:"XML",expressionList:e,dictionary:{version:"0.1",idList:n,format:"xml"}}};return i.post(o,JSON.stringify(s),0).then((function(e){return JSON.parse(e)})).catch((function(e){let i=e.errorResp?e.errorResp.errorMessage:r.error_wiw_copy_eff;t.alertMessage("error",r.error_wiw_title_copy_eff,i)}))},filterValidation:function(e,t,n){var o=[];n=n||!1,t.forEach((function(e){var t;t=n?[{name:"physicalId ",value:e.physicalId},{name:"V_CompiledExpression",value:e.compiledExpression}]:[{name:"physicalId ",value:e.physicalId}],o.push({path:[{attributes:t}]})}));var r=a.webservices.getFilterValidation;return i.post(r,JSON.stringify({version:"1.0",detailedResults:"No",filter:{format:"bin",value:e},occurrences:{ApplyMasterComposition:"no",withBinaries:n?"yes":"no",paths:o}}),0).then((function(e){let t=JSON.parse(e);if("SUCCEEDED"===t.occurrences.status){var i=[];return t.occurrences.paths.forEach((function(e){i.push({status:e.status,PIDInstance:e.path[0].pid})})),i}return Promise.reject(new Error("Service_failed"))})).catch((function(){return Promise.reject(new Error("Service_failed"))}))},allFilterValidation:function(e,t,n){var o=this,r=[],a=[];return a=(n=n||!1)?e.map((function(e){return{physicalId:e.options.instance.physicalid,compiledExpression:e.options.instance.effectivitycompiledform}})):e.map((function(e){return{physicalId:e.options.instance.physicalid}})),t.forEach((function(e){e.FilterCompiledForm&&r.push(o.filterValidation(e.FilterCompiledForm,a,n))})),i.makeMultipleServiceCalls(r,!0).then((function(i){var n=[];return i.forEach((function(i,o){var r=[];i.forEach((function(t,i){r.push({filterValidationStatus:t.status,nodeInstance:e[i]})})),n.push({modelversion:t[o].mv,productConfiguration:t[o].pc,instances:r})})),n}))},getMVandPCinformationFromModel:function(e){var t=this;return t.getModelVersionFromModelPID(e).then((function(n){if(n.length<1)return Promise.reject(new Error("No_ModelVersions"));var o=[],r={model:e,modelversions:[]};return n.forEach((function(i){r.modelversions.push({modelversion:i});var n=i.id;n.indexOf("pid")>=0&&(n=n.substring(4)),o.push(t.getProductConfigurationsFromModelVersion(e.physicalid,n))})),i.makeMultipleServiceCalls(o,!0).then((function(e){return e.forEach((function(e,t){r.modelversions[t].productConfigurations=[],e.forEach((function(e){r.modelversions[t].productConfigurations.push(e)}))})),r}))}))},getEffConsistencyReportofItemNProduct:function(e){let n=a.webservices.compareEvolutionEffectivityForLAndP;return i.post(n,JSON.stringify(e),0).then((function(e){return JSON.parse(e)})).catch((function(e){t.displayError(e,null,null,null)}))},getEffConsistencyReportofItemNDiscipline:function(e){let n=a.webservices.compareEvolutionEffectivityForItemAnd2D;return i.post(n,JSON.stringify(e),0).then((function(e){return JSON.parse(e)})).catch((function(e){t.displayError(e,null,null,null)}))},getEffConsistencyReportofDisciplineNItem:function(e){let n=a.webservices.compareEvolutionEffectivityFor2DAndItem;return i.post(n,JSON.stringify(e),0).then((function(e){return JSON.parse(e)})).catch((function(e){t.displayError(e,null,null,null)}))},getChangeControl:function(e){let n=a.webservices.getChangeControl;return i.post(n,JSON.stringify(e),0).then((function(e){return JSON.parse(e)})).catch((function(e){t.displayError(e,null,null,null)}))}}})),define("DS/CATFLCockpitWidget/components/ModelPCSelector/configurationSelector",["DS/Windows/Dialog","DS/Controls/Button","DS/Handlebars/Handlebars4","DS/WUXAutoComplete/AutoComplete","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","text!DS/CATFLCockpitWidget/components/ModelPCSelector/modelPCSelector.html","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f,m){var h="MODELVERSION",v="PC",C=JSON.parse(f),y={setActiveModel:function(e){this.configDetails.model=e},setActiveModelVersion:function(e){this.configDetails.modelVersion=e},setActiveProductConfig:function(e){this.configDetails.productConfiguration=e},getActiveModel:function(){return this.configDetails.model},getActiveModelVersion:function(e){return this.configDetails.modelVersion},getActiveProdConfig:function(){return this.configDetails.productConfiguration},init:function(t,i,a,c,d){var u,g=this;g.itemID=i,g.configDetails={model:{},modelVersion:{},productConfiguration:{}},g.configurationType=t,a&&(Array.isArray(a)&&a.length>0?g.allModels=a:g.setActiveModel({physicalid:a.physicalid?a.physicalid:a.id,name:a.name,revision:a.revision,objId:a.id,displayName:a.displayName})),c&&g.setActiveModelVersion({physicalid:c.physicalid?c.physicalid:c.id,name:c.name,revision:c.revision,current:c.current,backEndName:c.backEndName}),d&&g.setActiveProductConfig({physicalid:d.physicalid?d.physicalid:d.id,name:d.name,filterCompiledForm:d.filterCompiledForm,objId:d.id}),g.modalWindow&&g.modalWindow.close(),l.configureSearch();var f=g.getModalContent();g.modalWindow=new e({title:f.header,content:f.content,buttons:f.buttons,width:580,height:150,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame});var h=g.modalWindow.getContent().getElement("#modelVersionRow"),C=g.modalWindow.getContent().getElement("#productConfRow"),y=g.getActiveModel(),b=g.getActiveModelVersion(),_=g.getActiveProdConfig();if(h){var w=h.getElement(".autoCompleteContainer"),D=h.getElement(".searchContainer");w&&(u=b.physicalid,g.modVerAutoComplete=new n({allowFreeInputFlag:!1,minLengthBeforeSearch:3,multiSearchMode:!1,placeholder:f.modverPlaceholder}),g.modVerAutoComplete.addEventListener("change",(function(e){var t=g.modVerAutoComplete.selectedItems;if(t){var i=(t=t.options).physicalid?t.physicalid:t.modelVersionID;i.indexOf("pid")>=0&&(i=i.substring(4)),g.submitButton.disabled=i===u,t.model&&g.setActiveModel({physicalid:t.model.physicalid?t.model.physicalid:t.model.id,name:t.model.name,objId:t.model.id?t.model.id:t.model.objId,displayName:t.model.displayName}),g.setActiveModelVersion({physicalid:i,name:t.name?t.name:t.modelVersionName,revision:t.revision,backEndName:t.backEndName,current:t.current})}else g.submitButton.disabled=!u,g.setActiveModelVersion({physicalid:null,name:null,revision:null,backEndName:null,current:null})})),g.formAutocomplMVDataset(),g.modVerAutoComplete.inject(w)),D&&(D.onclick=g.searchModVer.bind(g))}if(C){var S=C.getElement(".autoCompleteContainer"),I=C.getElement(".searchContainer");S&&(g.pcAutoComplete=new n({allowFreeInputFlag:!1,minLengthBeforeSearch:3,multiSearchMode:!1,placeholder:m.ph_header_config_pc}),g.pcAutoComplete.addEventListener("change",(function(e){var t=g.pcAutoComplete.selectedItems;t?((t=t.options).physicalid.indexOf("pid")>=0&&(t.physicalid=t.physicalid.substring(4)),g.setActiveProductConfig({physicalid:t.physicalid?t.physicalid:t.id,name:t.name,label:t.label,filterCompiledForm:t.attributes.FilterCompiledForm})):g.setActiveProductConfig({physicalid:null,name:null,filterCompiledForm:null})})),g.pcAutoComplete.inject(S),g.configurationType===v&&s.getProductConfigurationsFromModelVersion(y.physicalid,b.physicalid).then((function(e){var t=new o;e.forEach((function(e){e.label=e.marketingName,e.physicalid=e.id,e.value=e.id&&e.id.indexOf("pid")>=0?e.id.substring(4):e.id,e.icon=p.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_FTRProductConfig.png",t.addRoot(new r(e))})),g.pcAutoComplete.elementsTree=t,_.physicalid&&g._retrieveItemInProductConfigurationDataset(_.physicalid)}))),I&&(I.onclick=g.searchPC.bind(g))}return g.modalWindow},getModalContent:function(){var e=this,n=e.configurationType,o={header:"",content:"",buttons:{}},r=i.compile(g),a={};return e.submitButton=new t({id:"configurationSubmit",domId:"configurationSubmit",label:m.confirmation_button,onClick:e.onSubmitCallback.bind(e),disabled:!1}),e.cancelButton=new t({id:"configurationCancel",domId:"configurationCancel",label:m.cancel_button,onClick:function(){e.modalWindow.close()}}),o.buttons.Ok=e.submitButton,o.buttons.Cancel=e.cancelButton,n===h?(o.header=m.header_config_modver,o.modverPlaceholder=m.ph_header_config_modver,a.rows=[{rowId:"modelVersionRow"}],a.modal_title="",e.submitButton.disabled=!0,o.buttons.Cancel=e.cancelButton):n===v&&(o.header=m.header_config_pc,a.rows=[{rowId:"productConfRow"}],a.modal_title="",o.buttons.Cancel=e.cancelButton),o.content=r(a),o},onSubmitCallback:function(){var e=this,t=e.configurationType,i=e.getActiveModel(),n=e.getActiveModelVersion(),o=e.getActiveProdConfig(),r=d.getFLWebModelEventsObj("flweb-model-events");n.physicalid?o.physicalid?o.filterCompiledForm?r.publish({event:"mod-PC-selection-successful",data:{itemID:e.itemID,model:i,modelVer:n,pc:o,filterCompiledForm:o.filterCompiledForm}}):s.createVolatileFilter({modelID:i.physicalid,modelName:i.name,modelVerName:n.backEndName,modelVerRev:n.revision}).then((function(t){r.publish({event:"mod-PC-selection-successful",data:{itemID:e.itemID,model:i,modelVer:n,pc:o,filterCompiledForm:t.filterBinaryForExpand}})})):e.publishSelectedModVer():t===h&&(u.alertMessage("success",null,m.attachedConfigurationFilterRemoved),r.publish({event:"allmod-selection-successful",data:{itemID:e.itemID}})),e.modalWindow.close()},searchModVer:function(){var e=this,t=(e.configurationType,{searchTitle:m.label_search_modelVer,allowedTypes:C.type_products,role:"",criteria:"",bMultiSel:!1,in_apps_callback:function(t){e._retrieveItemInModelVersionDataset("pid:"+t[0].id)}});if(e.allModels){var i="";e.allModels.forEach((function(e){var t=e.id;i+='[BASED_ON_MODEL]:"'+t+'" OR '})),t.additionalQuery="("+i.substring(0,i.length-4)+")"}else e.getActiveModel()&&e.getActiveModel().objId&&(t.additionalQuery='[BASED_ON_MODEL]:"'+e.getActiveModel().objId+'"');l.launchSearch(t)},searchPC:function(){var e=this,t=e.getActiveModelVersion().physicalid,i=(e.configurationType,{searchTitle:m.label_search_pc,allowedTypes:C.type_productConfiguration,role:"",criteria:"",bMultiSel:!1,additionalQuery:'[BASED_ON_MODEL_VERSION_PID]:"'+t+'"'});null!==t?(i.in_apps_callback=function(t){e._retrieveItemInProductConfigurationDataset("pid:"+t[0].id)},l.launchSearch(i)):u.alertMessage("error",null,"Please select Model Version","")},_retrieveItemInModelVersionDataset:function(e){e&&e.indexOf("pid")>=0&&(e=e.substring(4)),this.modVerAutoComplete.value=e},_retrieveItemInProductConfigurationDataset:function(e){e&&e.indexOf("pid")>=0&&(e=e.substring(4)),this.pcAutoComplete.value=e},publishSelectedModVer:function(){var e=this,t=e.getActiveModel(),i=e.getActiveModelVersion(),n=(e.getActiveProdConfig(),d.getFLWebModelEventsObj("flweb-model-events"));s.createVolatileFilter({modelID:t.physicalid,modelName:t.name,modelVerName:i.backEndName,modelVerRev:i.revision}).then((function(o){n.publish({event:"mod-PC-selection-successful",data:{itemID:e.itemID,model:t,modelVer:i,pc:null,filterCompiledForm:o.filterBinaryForExpand}})}))},formAutocomplMVDataset:function(){var e=this,t=[],i=e.getActiveModel(),n=e.getActiveModelVersion();e.allModels?e.allModels.forEach((function(e){e.physicalid?e.physicalid:e.id,t.push(s.getModelVersionFromModelPID(e))})):i.physicalid&&t.push(s.getModelVersionFromModelPID(i)),c.makeMultipleServiceCalls(t,!0).then((function(t){var a,s=new o;t.forEach((function(t,n){e.allModels?a=e.allModels[n]:i.physicalid&&(a=i),t.forEach((function(e){s.addRoot(new r({modelVersionID:e.id,modelVersionName:e.attributes.MarketingName,revision:e.revision,current:e.current,value:e.id&&e.id.indexOf("pid")>=0?e.id.substring(4):e.id,label:e.attributes.MarketingName+" "+e.revision,backEndName:e.name,model:a,icon:p.getServiceURL("3DSpace")+"/snresources/images/icons/small/iconSmallProduct.png"}))}))})),console.log("datasetTreeModel",s.getRoots()),e.modVerAutoComplete.elementsTree=s,n.physicalid&&e._retrieveItemInModelVersionDataset(n.physicalid)}))}};return y})),define("DS/CATFLCockpitWidget/utils/contextManager.util",["UWA/Class","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/utils/config.util"],(function(e,t,i,n,o,r,a){"use strict";return e.singleton({_selectedItems:[],getContext:function(e){this.treeDocument=e;let i=function(){versionExplorer.setCheckVersionExternalFunction("ENOXVersionExplorerOpenVersion",(function(e){return e.options.id!==widget.getValue("currentOpenedItem")&&"LandingPage"!==widget.getValue("currentView")})),versionExplorer.subscribeEvent("ENOXVersionExplorerOpenVersion",(function(e){customizations[1](e),versionExplorer.hideDialog()}),!1)}.toString(),s=function(e){if(!e)return;let t=e.options.id,i=e.options.grid.type,s=e.options.grid.title,l=e.options.grid.revision,c=widget.getValue("xRevAttached"),d=widget.getValue("currentOpenedItem");if("xRevisionElement"===i){let e=this.getSelectedNodes()[0]?._attributes.physicalid;if(d===e)o.createVolatileFilter({modelID:c.physicalid,modelVerRev:l,type:i}).then((function(e){n.getFLWebModelEventsObj("flweb-model-events").publish({event:"mod-PC-selection-successful",data:{itemID:widget.getValue("currentOpenedItem"),xRevAttachedId:c.physicalid,xRevVerId:t,xRevVer:l,xRevName:s,filterCompiledForm:e.filterBinaryForExpand,type:i}})}));else{var u=a.getFullConfig().identifiers;r.getUserPreferences(u.user_pref_openedItems_conf).then((function(i){if(i){var o=UWA.is(i,"string")?JSON.parse(i):i;if(!o[e]){if(Object.keys(o).length===u.limit_usrPref_openedItems_conf)delete o[Object.keys(o)[0]];o[e]={}}o[e].xRevAttachedId=c.physicalid,o[e].xRevVerId=t,o[e].xRevVer=l,r.setUserPreferences({name:u.user_pref_openedItems_conf,value:JSON.stringify(o)}).then((function(){n.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:e||d}})}))}}))}}else n.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:t}})}.bind(this);return this.infoForCustomization={VersionExplorerCustomization:[i,s]},this.elements={container:widget.body},this.displayNotification=function(e){"error"===e.eventID||"warning"===e.eventID?t.alertMessage("error",null,e.msg||e):t.alertMessage("success",null,e.msg||e)},this},init:function(e){this.options={widget:widget},this._parent(e)},addSelection:function(e){var t=this;UWA.is(e,"array")?e.forEach((function(e){t._selectedItems.push(e)})):(e.object="",this._selectedItems.push(e))},setBIFilter:function(e){this._biFilter=e,this.isIndexMode=function(){return!0}},isRoot:function(e){return e.isRoot()},getRoots:function(){return this.treeDocument.getRoots()},getChildren:function(e){return e.getChildren()||[]},getNodesById:function(e){return this.treeDocument.getNodesById(e)},getParents:function(e){return e.getParents()},getRelationID:function(e){return e.options.instance?e.options.instance.physicalid:null},getReference:function(e){return e.getID()},getParent:function(e){var t=e.getParent();return t.options.referenceId=t.options.physicalid,t.options.grid.instanceId=t.options.relationid,null!=t&&void 0!==t&&t.isVirtual&&t.isVirtual()&&(t=t.getParent()),t},getType:function(e){return e.getType()},getName:function(e){return e.getLabel()},getSelectedNodes:function(){return this._selectedItems},isDescendantOf:function(e,t){return e.isDescendantOf(t)},author:function(){return!0},resetSelection:function(){this._selectedItems=[],this._biFilter=null,this.isIndexMode=null},getSecurityContext:function(){return{SecurityContext:"ctx::"+i.getSecurityContext()}},getSetting:function(e){var t=null;switch(e){case"tenant":t=i.getTenant();break;case"securityContext":t=i.getSecurityContext()}return t},getParentWithChild:function(e){if(null!=e&&e.length){for(var t=[],i=e.length,n=0;n<i;n++)for(var o=e[n],r=0;r<i;r++)if(n!==r)for(var a=e[r],s=a.getParent();s;)s===o&&(a.options.grid["ds6w:label"]=a.options.label,t.push({parent:o,child:a})),s=s.getParent();return t}return[]},isThereARootSelected:function(){for(var e=this.getSelectedNodes(),t=0;t<e.length;t++)if(this.isRoot(e[t]))return!0;return!1},getOrdering:function(){return{}},getInstance:function(e){return e.getRelationID()},refresh:function(e){if(e.operations&&e.operations.length>0){let t=this.getSelectedNodes();n.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-items-on-replace",data:{replaceDetails:e.operations,selectedNodes:t}})}},_is2DContext:function(){return!0},getLeafNodes:function(e){let t=[],i=e?e.getVisibleChildren():e.getChildren();return i&&Array.isArray(i)&&0!==i.length?i.forEach((e=>{let i=this.getLeafNodes(e);t.push(...i)})):t.push(e),t},getDataForCfgAnalysisCommands:function(e){let t,i,n={selectedNodes:[]},o=this.getSelectedNodes(),r=o.length,a=o[0]._attributes.treeData,s=a.isRoot();for(i=0;i<r;i++)t=s?{rootID:o[i].getID(),rootAlias:o[i].getLabel(),id:o[i].getID(),alias:o[i].getLabel(),isRoot:!0}:{id:"CfgInstantiatedConfigurationCommands"==e?a.getRelationID():a.getID(),alias:a.getLabel(),parentID:a.getParent().getID(),parentalias:a.getParent().getLabel(),rootID:a.getRoot().getID(),rootAlias:a.getRoot().getLabel(),isRoot:!1},n.selectedNodes.push(t);return n},getDescendantsDataForCfgAnalysisCommands:function(){var e={descendantNodes:[],occurrences:[]},t=this.getSelectedNodes();if(1==t.length){var i=0;let d=t[0]._attributes.treeData;if(d.isRoot()||d._isExpanded){i=d.getAllDescendants({onlyVisibleNodes:!0});for(let t=0;t<i.length;t++){let o=i[t];if(!o.isGroupingNode&&"Logical Reference"==o.options.grid.type){var n={physicalID:o.getRelationID()};e.descendantNodes.push(n)}}var o=this.getLeafNodes(d);for(let t=0;t<o.length;t++){let i=o[t];if(!i.isGroupingNode&&"Logical Reference"==i.options.grid.type){for(var r=i.getOccurencePath(),a=[],s=0;s<r.length;s++){var l={instancePID:r[s]};a.push(l)}var c={path:a};e.occurrences.push(c)}}}}return e}})})),define("DS/CATFLCockpitWidget/commands/CATFLNextGenFilterCmd",["DS/ENONextGenFilterCmd/commands/ENONextGenFilterCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],(function(e,t){"use strict";return e.extend({init:function(e){this.name=e.ID,this.viewController=e.viewController,e.context?this.context=t.getContext():this.context=e.context,this._parent(e)},getAppParams:function(){return{widgetId:widget.id,appId:widget.id}},getSelectorManager:function(){return this.viewController.contentView.getTreeDocument().getXSO()||null},getRoots:function(){if(widget.getValue("currentView")&&"LandingPage"!==widget.getValue("currentView")){var e=this.viewController.contentView.getTreeDocument().getRoots()[0];return e?[{id:e.getID(),filtered:0,Label:e.getLabel()}]:[]}return[]},getSelection:function(){var e={path:[],label:[]},t=[],i=this.viewController.contentView.getTreeDocument().getRoots()[0];if(widget.getValue("currentView")&&"LandingPage"!==widget.getValue("currentView")){if(i&&(t=[i]),t.forEach((function(t){e.path.push([t.getID()]),e.label.push([t.getLabel()])})),this.viewController.contentView.getTreeDocument().getSelectedNodes()){var n=this.viewController.contentView.getTreeDocument().getSelectedNodes();n.length>=1&&n[0].getID()!==t[0].getID()&&n.forEach((function(t){e.path.push(t.getOccurencePath()),e.label.push([t.getLabel()])}))}}else;return e}})})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/CopyVariantEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgCopyEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],(function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach((function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()})})),{selectedNodes:i,nodes:e}}})})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/CopyLinkCmd",["DS/ApplicationFrame/Command","DS/PADServices/utils/CompassUtils","DS/PADServices/utils/GlobalUtils","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/contextManager.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a){"use strict";return e.extend({init:function(e){this._parent(e)},execute:function(){let e=n.getServiceURL("3DDashboard"),s="#app:"+i.getAppId()+"/content:X3DContentId=",l=r.getSelectedNodes(),c=t.buildX3DContent(l);var d=e+s+encodeURIComponent(JSON.stringify(c));return i.copyTexttoCLipboard(d).then((function(e){e?o.alertMessage("success",null,a.replace(a.msg_copy_link_success,{label:l[0].getLabel()})):o.alertMessage("error",null,a.msg_copy_link_error)}))}})})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/CopyEvolutionEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgCopyEvolutionEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],(function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach((function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()})})),{selectedNodes:i,nodes:e}}})})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/ExtendEvolutionEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgExtendEvolutionEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util"],(function(e,t,i,n){"use strict";return e.extend({init:function(e){var t=e||{};this._parent(t,{mode:"exclusive",isAsynchronous:!0})},getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach((function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()})})),{selectedNodes:i,nodes:e}}})})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/SelectByConfigurationCriteriaCmd",["DS/CfgAnalysisCommands/commands/CfgSelectByConfigurationCriteriaCmd","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","DS/CfgBaseUX/scripts/CfgUtility"],(function(e,t,i,n,o){"use strict";return e.extend({getData:function(){return this.end(),t.getDataForCfgAnalysisCommands()},getDescendantsData:function(){return t.getDescendantsDataForCfgAnalysisCommands()},selectLeaves:function(e){var i=this;let n=t.getSelectedNodes()[0];if(n._attributes.treeData.unselect(),n._attributes.treeData.unselectAll(),null!=e&&null!=e.occurrences){var r=e.occurrences;let t=0;for(var a=0;a<r.length;a++)"ErrorTooComplexExpression"==r[a].status&&t++;if(t>0){var s={primaryButton:"Yes",secondaryButton:"No",messageToDisplayOnDialog:"Status not computed on "+t+" instances. \n Do you want to highlight them?",dontShowAgain:!1,targetBody:widget.body,primaryCallback:function(){i.highlightLeavesWithStatus(r,"ErrorTooComplexExpression")},secondaryCallback:function(){i.highlightLeavesWithStatus(r,"Valid")}};o.showUserChoiceDialog(s)}else i.highlightLeavesWithStatus(r)}},highlightLeavesWithStatus:function(e){var o=0;let r=t.getSelectedNodes()[0]._attributes.treeData.getAllDescendants();for(var a=0;a<e.length;a++){let t=e[a];if("Valid"==t.status){let e=t.pids.substring(1,t.pids.length-1).split(", ");for(var s=0;a<r.length;s++){let t=r[s];if(t._options.grid.type&&t.getID()==e[e.length-1]){t.select(),o++;break}}}}o>1?i.alertMessage("info",null,o+" "+n.instances_selected):i.alertMessage("info",null,o+" "+n.instance_selected)},selectInstances:function(e){let o=t.getSelectedNodes()[0];o._attributes.treeData.unselect(),o._attributes.treeData.unselectAll();let r=o._attributes.treeData.getAllDescendants();if(null!=e&&null!=e.instances){for(var a=e.instances,s=0,l=0;l<a.length;l++)"used"==a[l].status&&r.forEach((function(t){if(t._options.grid.type){t.getNodesByRelId(e.instances[l].physicalID).forEach((function(e){e.select(),s++}))}}));s>1?i.alertMessage("info",null,s+" "+n.instances_selected):i.alertMessage("info",null,s+" "+n.instance_selected)}}})})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/AddToConfigurationRevisionCmd",["DS/CfgEffectivityCommands/commands/CfgAddToConfigurationRevisionCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],(function(e,t){"use strict";return e.extend({init:function(e){var t=e||{};this._parent(t,{mode:"exclusive",isAsynchronous:!0})},getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach((function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()})})),{selectedNodes:i,nodes:e}}})})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/PasteEvolutionEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgPasteEvolutionEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],(function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[],n=[];return e.forEach((function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()}),n.push(e._attributes.nodeModel)})),{selectedNodes:i,nodes:e,padNodes:n}}})})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/PasteVariantEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgPasteEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],(function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[],n=[];return e.forEach((function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()}),n.push(e._attributes.nodeModel)})),{selectedNodes:i,nodes:e,padNodes:n}}})})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/EditEvolutionEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgEvolutionCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],(function(e,t){"use strict";return e.extend({init:function(e){var t=e||{};this._parent(t,{mode:"exclusive",isAsynchronous:!0})},getData:function(){var e=t.getSelectedNodes()[0];return{selectedNodes:[{id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()}],nodes:e}}})})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/EditVariantEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgVariantEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],(function(e,t){"use strict";return e.extend({init:function(e){var t=e||{};this._parent(t,{mode:"exclusive",isAsynchronous:!0})},getData:function(){var e,i={selectedNodes:[]},n=t.getSelectedNodes(),o=n.length;for(e=0;e<o;e++){var r={id:n[e].getID(),alias:n[e].getLabel(),isRoot:!1,VPMRef:n[e].getType(),parentID:n[e].getParent().getID(),parentalias:n[e].getParent().getLabel(),referenceId:n[e]._attributes.nodeModel.getID(),referenceTypeNLS:n[e]._attributes.nodeModel.options.grid.type,instanceType:n[e]._attributes.nodeModel.options.instance_type,instanceTypeNLS:n[e]._attributes.nodeModel.options.grid.instance_type};i.selectedNodes.push(r)}return i}})})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/EditConfigurationContextCmd",["DS/CfgConfigurationCommands/commands/CfgEditConfigurationContextCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],(function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach((function(e){i.push({id:e.getID(),alias:e.getLabel()})})),{selectedNodes:i}}})})),define("DS/CATFLCockpitWidget/utils/preferences.util",["DS/ENOXWidgetPreferences/js/ENOXWidgetPreferences","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/utils/zip.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o){"use strict";var r=t.getFullConfig(),a=r.localStorageKeys,s=r.identifiers;const l=[{label:o.label_upper_left,value:"top-left"},{label:o.label_upper_right,value:"top-right"},{label:o.label_lower_left,value:"bottom-left"},{label:o.label_lower_right,value:"bottom-right"},{label:o.label_free_pos,value:s.workUnder_pos_freeValue}];return{buildPreferences:function(){var i=this;return e.addPlatformSelectionPreferenceToWidget({roles:["SAX"]}),widget.addEvent("onIndexOrDatabaseModeChange",this.onIndexOrDatabaseModeChange.bind(this)),e.addCredentialPreferenceToWidget({usePreferredCredentials:!0}).then((function(){widget.addPreference({name:a.showSpecDocs,type:"boolean",label:o.label_show_spec_doc,defaultValue:!1}),widget.addPreference({name:a.indexDatabaseMode,type:"list",label:o.label_index_and_database_mode,defaultValue:a.indexAndDatabaseMode,options:[{label:o.label_always_use_db,value:a.onlyDatabaseMode},{label:o.label_switch_between_index_and_db,value:a.indexAndDatabaseMode}],onchange:"onIndexOrDatabaseModeChange"}),i.addTimeoutIndexPreference(),widget.addPreference({name:a.depthFlattenedView,label:o.label_depth_flat_view,type:"range",defaultValue:"2",step:"1",min:"2",max:"10"}),widget.addPreference({name:a.depthFlattenedViewArchitectureItemOnly,label:o.label_depth_flat_view_arch,type:"range",defaultValue:"4",step:"1",min:"2",max:"10"}),widget.addPreference({name:a.displayWorkUnder,defaultValue:!0,type:"boolean",label:o.label_display_work_under,onchange:"onChangeControl"}),widget.getPreference(a.displayWorkUnder).value?widget.addPreference({name:a.workunderpos,type:"list",label:o.label_work_under_position,defaultValue:"bottom-right",options:l}):widget.addPreference({name:a.workunderpos,type:"hidden"}),widget.addEvent("onChangeControl",i.onChangeControl.bind(i)),widget.addPreference({name:a.workunderonconfig,type:"list",label:o.label_pref_work_under_on_config,defaultValue:a.askSetWorkunderOnConfig,options:[{label:o.label_workunder_ask_each_time,value:a.askSetWorkunderOnConfig},{label:o.label_workunder_always,value:a.alwaysSetWorkunderOnConfig},{label:o.label_workunder_never,value:a.neverSetWorkunderOnConfig}]}),widget.addPreference({name:a.exportConfigData,defaultValue:a.exportGridviewPrefNever,type:"list",label:o.export_gridview_pref_name,options:[{label:o.export_gridview_pref_ask,value:a.exportGridviewPrefAsk},{label:o.export_gridview_pref_always,value:a.exportGridviewPrefAlways},{label:o.export_gridview_pref_never,value:a.exportGridviewPrefNever}]}),r.disableIndexAcceleration="only_db"===widget.getPreference(a.indexDatabaseMode).value,t.cleanRecentlyAuthoredItemsInLocalStorage()}))},updateDisplayWorkUnder:function(){const e=widget.getPreference(a.displayWorkUnder).value,t=widget.getPreference(a.workunderpos);!0===e?widget.addPreference({name:a.workunderpos,type:"list",label:o.label_work_under_position,defaultValue:t.value?t.value:"bottom-right",options:l}):widget.addPreference({name:a.workunderpos,type:"hidden"})},onChangeControl:function(e,t){this.updateDisplayWorkUnder(),widget.dispatchEvent("onEdit",{name:e,value:t})},setWorkUnderPreferences:function(){this.updateDisplayWorkUnder()},addTimeoutIndexPreference:function(){var e={name:a.timeoutIndex,type:"list",label:o.label_time_enable_indexing,defaultValue:"180",options:[{label:o.label_one_minute,value:"60"},{label:o.label_three_minute,value:"180"},{label:o.label_five_minute,value:"300"},{label:o.label_ten_minute,value:"600"}]};"only_db"===widget.getPreference(a.indexDatabaseMode).value&&(e.disabled=!0),widget.addPreference(e)},onIndexOrDatabaseModeChange:function(e,t){this.addTimeoutIndexPreference(),r.disableIndexAcceleration="only_db"===t,widget.dispatchEvent("onEdit")},saveUserCustomAttributes:function(e){let t,o=e.extensions,a=e.userAdditionalAttributes,s=e.isForPhysicalProduct,l=s?r.localStorageKeys.userAdditionalAttributesForPhysicalProduct:r.localStorageKeys.userAdditionalAttributes,c={extensions:o,userAdditionalAttributes:a};s?r.userAdditionalAttributesForPhysicalProduct=a:r.userAdditionalAttributes=a,o||a?(c=JSON.stringify(c),t=n.jsonZip(c),localStorage.setItem(l,t),widget.setValue(l,t)):(localStorage.removeItem(l),widget.setValue(l,null)),i.setUserPreferences({name:l,value:c})},getNSaveUserCustomAttributes:function(e){let t=e?r.localStorageKeys.userAdditionalAttributesForPhysicalProduct:r.localStorageKeys.userAdditionalAttributes,o=widget.getValue(t)||localStorage.getItem(t),a=n.jsonUnzip(o);if(a){o=o.startsWith("ZIP:")?o:n.jsonZip(o),localStorage.setItem(t,o),widget.setValue(t,o);let i=JSON.parse(a);return e?r.userAdditionalAttributesForPhysicalProduct=i.userAdditionalAttributes:r.userAdditionalAttributes=i.userAdditionalAttributes,Promise.resolve(i)}return i.getUserPreferences(t).then((function(i){if(i){let o,a;0!==Object.keys(i).length&&(o=JSON.stringify(i),a=n.jsonZip(o),localStorage.setItem(t,a),widget.setValue(t,a),e?r.userAdditionalAttributesForPhysicalProduct=i.userAdditionalAttributes:r.userAdditionalAttributes=i.userAdditionalAttributes)}return i}))},saveUserCustomViews:function(e,t){let n=r.localStorageKeys.customViews,o={customViews:e,currentCustomViewIdentifier:t},a=JSON.stringify(o);localStorage.setItem(n,a),widget.setValue(n,a),i.setUserPreferences({name:n,value:a})},getUserCustomViews:function(){let e=r.localStorageKeys.customViews,t=widget.getValue(e)||localStorage.getItem(e);return t?Promise.resolve(JSON.parse(t)):i.getUserPreferences(e).then((function(t){return 0!==Object.keys(t).length&&(localStorage.setItem(e,JSON.stringify(t)),widget.setValue(e,JSON.stringify(t))),t}))},saveCustomHeaderView:function(e){var t=r.localStorageKeys.customHeaderView,n=JSON.stringify(e);localStorage.setItem(t,n),widget.setValue(t,n),i.setUserPreferences({name:t,value:n}),r.customHeaderView=e},getCustomHeaderView:function(){var e=r.localStorageKeys.customHeaderView,t=widget.getValue(e)||localStorage.getItem(e);return t?(r.customHeaderView=JSON.parse(t),Promise.resolve(JSON.parse(t))):i.getUserPreferences(e).then((function(t){return 0!==Object.keys(t).length&&(localStorage.setItem(e,JSON.stringify(t)),widget.setValue(e,JSON.stringify(t))),r.customHeaderView=t,t}))}}})),define("DS/CATFLCockpitWidget/utils/widgetlink.util",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i){"use strict";var n={findWidgetLinkCommand:function(e){var i=e[0],o=n.getIDsImplementLinksOfItem(i),r=t.getWidgetLink(),a=[];o&&o.length>0&&(a=o.map((e=>[e]))),r&&r.publish("DS/ExternalWdgtCom/Find",{paths:a})},subscribeToFindEvent:function(o){t.getWidgetLink().subscribe("DS/ExternalWdgtCom/Find",(function(t){n.selectNodesFromPathId(o,t.paths)||e.alertMessage("info",null,i.msg_no_match_in_filter)}))},getIDsImplementLinksOfItem:function(e){var t=[];if(e){var i=e.getChildren();i&&i.length>0&&i.forEach(((e,i)=>{if("implementLinksCategory"===e.options.type){var n=e.getChildren();n&&n.length>0&&n.forEach(((e,i)=>{e.options.linkInfo&&e.options.physicalid&&!t.includes(e.options.physicalid)&&t.push(e.options.physicalid)}))}}))}return t},hasItemImplementLinks:function(e){if(e){var t=e.getChildren();if(t&&t.length>0)for(let e of t)if("implementLinksCategory"===e.options.type)return!0}return!1},selectNodesFromPathId:function(e,t){e.treeDocument.unselectAll();var i=!0;return t&&t.length>0&&t.forEach(((t,n)=>{if(t.length>0){var o=t[t.length-1],r=e.treeDocument.getNodesById(o);r&&r.length>0&&r.forEach(((t,n)=>{!t.options.virtual&&t.isVisible()&&(t.select(),i&&e.ensureNodeModelVisible(t,!0,!1,.5,!0),i=!1)}))}})),!i},linkWidget:function(){return new Promise((e=>{parent.require(["DS/WidgetLink/WidgetLink"],(i=>{let n=i.get(widget);console.log("----\x3e widgetlink",n),t.setWidgetLink(n),n.setLinkability({appIds:[],open:!0,uses:["ENXContent"],implements:["ENXContent"]}),e()}))}))}};return n})),define("DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller",["DS/CATFLCockpitWidget/utils/modelObj.util","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/utils/widgetlink.util"],(function(e,t,i){"use strict";return{init:function(e,t){e&&this._generateCommand(e,t)},_generateCommand:function(n,o){var r,a=this;switch(t.resetSelection(),n){case"HistoryCommand":o.forEach((function(i){r=new e(i),t.addSelection(r)})),require(["DS/LifecycleCmd/HistoryCmd","css!DS/egraph/views.css"],(function(e){a.historyCmd&&a.historyCmd.historyDlg||(a.historyCmd=new e({context:t.getContext(),ID:"HistoryHdr"}),a._beginCommand(a.historyCmd))}));break;case"DuplicateCommand":widget._biFilter&&t.setBIFilter(widget._biFilter),o.forEach((function(i){(r=new e(i)).options={grid:{"ds6w:type":i.displayType,"ds6wg:revision":i.revision},type:i.type,icons:[i.icons[0].iconPath]},t.addSelection(r)})),require(["DS/LifecycleCmd/DuplicateCmd"],(function(e){a.duplicateCmd=new e({context:t.getContext(),ID:"DuplicateHdr"}),a._beginCommand(a.duplicateCmd)}));break;case"MaturityCommand":o.forEach((function(i){r=new e(i),t.addSelection(r)})),require(["DS/LifecycleCmd/MaturityCmd","css!DS/egraph/views.css"],(function(e){a.maturityCmd=new e({context:t.getContext(),ID:"MaturityHdr"}),a._beginCommand(a.maturityCmd)}));break;case"EditConfigurationContextCmd":o.forEach((function(i){r=new e(i),t.addSelection(r)})),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/EditConfigurationContextCmd"],(function(e){a.editConfigurationContextCmd=new e,a.editConfigurationContextCmd.execute()}));break;case"SelectByConfigurationCriteriaCmd":o.forEach((function(i){r=new e(i),t.addSelection(r)})),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/SelectByConfigurationCriteriaCmd"],(function(e){a.selectByConfigurationCriteriaCmd=new e,a.selectByConfigurationCriteriaCmd.execute()}));break;case"CopyVariantEffectivityCmd":o.items.forEach((function(i){r=new e(i),t.addSelection(r)})),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/CopyVariantEffectivityCmd"],(function(e){a.copyVariantEffectivityCmd=new e(o),a.copyVariantEffectivityCmd.execute()}));break;case"PasteVariantEffectivityCmd":o.items.forEach((function(i){r=new e(i),t.addSelection(r)})),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/PasteVariantEffectivityCmd"],(function(e){a.pasteVariantEffectivityCmd=new e,a.pasteVariantEffectivityCmd.execute()}));break;case"EditVariantEffectivityCmd":o.items.forEach((function(i){r=new e(i),t.addSelection(r)})),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/EditVariantEffectivityCmd"],(function(e){a.editVariantEffectivityCmd=new e(o),a.editVariantEffectivityCmd.execute()}));break;case"CopyEvolutionEffectivityCmd":o.items.forEach((function(i){r=new e(i),t.addSelection(r)})),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/CopyEvolutionEffectivityCmd"],(function(e){a.copyEvolutionEffectivityCmd=new e(o),a.copyEvolutionEffectivityCmd.execute()}));break;case"PasteEvolutionEffectivityCmd":o.items.forEach((function(i){r=new e(i),t.addSelection(r)})),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/PasteEvolutionEffectivityCmd"],(function(e){a.pasteEvolutionEffectivityCmd=new e,a.pasteEvolutionEffectivityCmd.execute()}));break;case"EditEvolutionEffectivityCmd":o.items.forEach((function(i){r=new e(i),t.addSelection(r)})),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/EditEvolutionEffectivityCmd"],(function(e){a.editEvolutionEffectivityCmd=new e(o),a.editEvolutionEffectivityCmd.execute()}));break;case"ExtendEvolutionEffectivityCmd":o.items.forEach((function(i){r=new e(i),t.addSelection(r)})),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/ExtendEvolutionEffectivityCmd"],(function(e){a.editEvolutionEffectivityCmd=new e,a.editEvolutionEffectivityCmd.execute()}));break;case"AddToConfigurationRevisionCmd":o.items.forEach((function(i){r=new e(i),t.addSelection(r)})),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/AddToConfigurationRevisionCmd"],(function(e){a.addToConfigurationRevisionCmd=new e,a.addToConfigurationRevisionCmd.execute()}));break;case"ChangeOwnerCommand":o.forEach((function(i){(r=new e(i)).options={grid:{"ds6w:type":i.displayType,"ds6wg:revision":i.revision,"ds6wg:responsible":i.owner},icons:i.icons},t.addSelection(r)})),require(["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeOwnerCmd"],(function(e){a.changeOwnerCmd=new e({context:t.getContext(),ID:"ActionBar_ChangeOwner"}),a._beginCommand(a.changeOwnerCmd)}));break;case"CompareCmd":o.forEach((function(i){t.addSelection(new e(i))})),require(["DS/CompareCmd/CompareCmd"],(function(e){a.compareCmd=new e({context:t.getContext(),ID:"CompareHdr"}),a._beginCommand(a.compareCmd)}));break;case"ShareCmd":o.forEach((function(i){(r=new e(i)).options={grid:{"ds6w:type":i.displayType,"ds6wg:revision":i.revision,"ds6wg:responsible":i.owner},subLabel:i.owner,icons:i.icons},t.addSelection(r)})),require(["DS/ENOCollabSharingCmds/commands/AccessRightCmd/ActionBar_AccessRightCmd"],(function(e){a.shareCmd=new e({context:t.getContext(),ID:"ActionBar_AccessRightCmd"}),a._beginCommand(a.shareCmd)}));break;case"ReserveCmd":o.forEach((function(i){let n=new e(i);n.options={grid:{"ds6w:label-Instance":i.instanceName}},t.addSelection(n)})),require(["DS/ENOCollabSharingCmds/commands/ReserveCmd/ActionBar_ReserveCmd"],(function(e){a.reserveHdr=new e({context:t.getContext(),ID:"ReserveHdr"}),a._beginCommand(a.reserveHdr)}));break;case"UnreserveCmd":o.forEach((function(i){let n=new e(i);n.options={grid:{"ds6w:label-Instance":i.instanceName}},t.addSelection(n)})),require(["DS/ENOCollabSharingCmds/commands/UnreserveCmd/ActionBar_UnreserveCmd"],(function(e){a.unreserveHdr=new e({context:t.getContext(),ID:"UnreserveHdr"}),a._beginCommand(a.unreserveHdr)}));break;case"NGFilterCmd":require(["DS/CATFLCockpitWidget/commands/CATFLNextGenFilterCmd"],(function(e){a.nextgenFilterCmd=new e({context:t.getContext(),ID:"CATFLNextGenFilterCmd",viewController:o.viewController}),a._beginCommand(a.nextgenFilterCmd)}));break;case"ReplaceByLatestRevCmd":o.treeDocument.getSelectedNodes().forEach((function(e){t.addSelection(e)})),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/ReplaceByLatestRevisionCmd"],(function(e){a.replaceByLatestRevCmd=new e({context:t.getContext(o.treeDocument),ID:"ReplaceByLatestRevisionCmd",container:o.getContent()}),a._beginCommand(a.replaceByLatestRevCmd)}));break;case"ReplaceByRevCmd":o.treeDocument.getSelectedNodes().forEach((function(e){e.options.grid["ds6w:responsible"]=e.options.grid.owner,e.options.grid["ds6w:type"]=e.options.grid.type,t.addSelection(e)})),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/ReplaceByRevisionCmd"],(function(e){a.replaceByRevisionCmd=new e({context:t.getContext(o.treeDocument),ID:"ReplaceByRevCmd",container:o.getContent()}),a._beginCommand(a.replaceByRevisionCmd)}));break;case"ReplaceByDuplicate":o.treeDocument.getSelectedNodes().forEach((function(e){e.options.label=e.getLabel(),e.options.grid.instanceId=e.options.relationid,e.options.grid["ds6wg:revision"]=e.options.grid.revision,e.options.grid["ds6w:type"]=e.options.grid.type,e.options.grid["ds6w:status"]=e.options.grid.maturity,e.options.thumbnail=e.options.icons[0].iconPath,t.addSelection(e)})),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/ReplaceByDuplicateCmd"],(function(e){a.replaceByDuplicate=new e({context:t.getContext(o.treeDocument),ID:"UPSAuthReplaceByDuplicate",container:o.getContent()}),a._beginCommand(a.replaceByDuplicate)}));break;case"FindWidgetLinkCmd":i.findWidgetLinkCommand(o.selection);break;case"CopyLinkCmd":t.addSelection(o.selection[0]),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/CopyLinkCmd"],(function(e){a.copyLinkCmd=new e({context:t.getContext(o.treeDocument),ID:"CopyLink",isEnabled:!0,arguments:{}}),a._beginCommand(a.copyLinkCmd)}));break;case"SetWorkUnderEvolutionCommand":require(["DS/CATFLCockpitWidget/components/CommandsCtrl/SetWorkUnderEvolutionCmd"],(function(e){a.setWorkUnderEvolution=new e({context:o.config,ID:"setWorkUnderEvolution"}),a._beginCommand(a.setWorkUnderEvolution)}))}},_beginCommand:function(e){e.begin()}}})),define("DS/CATFLCockpitWidget/services/dimensions.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/xhr.util"],(function(e,t){"use strict";var i=e.getFullConfig();return{getAllDimensions:function(e){return t.get(e.webservices.getDimensionsFromDictionary).then((function(t){e.dimensions={},JSON.parse(t).results.forEach((function(t){var i={};t.Units.forEach((function(e){i[e.Name]={label:e.label,NLSName:e.NLSName}})),e.dimensions[t.Name]={MKSUnit:t.MKSUnit,NLS:t.NLS,Units:i}}))}))},convertValues:function(e){return t.post(i.webservices.convertValues,JSON.stringify(e)).then((function(e){return JSON.parse(e)}))}}})),define("DS/CATFLCockpitWidget/services/pno.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n){var o=e.getFullConfig();return{getPnO:function(e){return t.get(o.webservices.pno+e).then((function(e){return JSON.parse(e)}))},getCreateCredentials:function(e){e||(e="RFLVPMLogicalReference");let r=o.webservices.getCreateCredential+e;return t.get(r).then((function(e){let t=(e=JSON.parse(e)).credentials,i=new Map;if(t.forEach((function(e){e.prjname&&(i.has(e.prjname)||i.set(e.prjname,[]),i.get(e.prjname).push(e))})),0==i.size)throw new Error("No project found");(o.credential??={}).createCredentials=i})).catch((function(e){let t=null,o=null;return"No project found"==e?.message?(e=null,t=n.NoProjectErrTitle,o=n.NoProjectErrMsg):e?.errorResp?.credentials&&(e=null,o=n.ApplyCredError),i.displayError(e,t,null,o,"EXP3DBasicsUserMap/base-m-access-roles-sb.htm"),Promise.reject()}))}}})),define("DS/CATFLCockpitWidget/services/space.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o){var r=e.getFullConfig();return{getSpaceHierarchy:function(e){return i.get(r.webservices.getSpaceHierarchy+e).then((function(e){return JSON.parse(e).spaceHierarchy})).catch((function(e){var i=o.error_get_space_hierarchy,n=e.error.message.slice(e.error.message.indexOf("ResponseCode"));n&&n.indexOf("404")>=0&&(i=o.error_missing_space_media),t.displayError(e,null,null,i)}))},createSPPConnection:function(e,a){var s={SPPConnections:[{Objects:[],Spaces:[]}]};return e instanceof Array&&e.length>20&&t.alertMessage("warning",null,o.replace(o.msg_bulkOperation_limitReached,{limit:20})),e.forEach((function(e){s.SPPConnections[0].Objects.push({physicalid:e.options.physicalid,logicalid:e.options.logicalid,majorid:e.options.majorid,type:e.options.grid.actualType})})),a.forEach((function(e){s.SPPConnections[0].Spaces.push({physicalid:e.options.physicalid,logicalid:e.options.logicalid,majorid:e.options.majorid,type:e.options.type||r.identifiers.type_design_ref})})),i.post(r.webservices.createSPPConnection,JSON.stringify(s),0).then((function(i){return t.alertMessage("success",null,o.msg_assign_spaces_success),n.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:e}),JSON.parse(i)}),(function(e){var i=e.error.message.slice(e.error.message.indexOf("ResponseCode"));if(i){if(i.indexOf("401")>=0)return void t.displayError("error",o.error_assign_space_failed_title,o.error_assign_space_failed_subtitle,null);if(i.indexOf("404")>=0)return void t.displayError("error",null,null,o.error_missing_space_media)}t.displayError("error",null,null,o.error_generic_system_and_network)}))},navigateSPPConnection:function(e){return i.makeServiceCall(r.webservices.navigateSPPConnection,"POST",JSON.stringify({physicalids:e}),!0).then((function(e){return JSON.parse(e).results})).catch((function(e){var i=o.error_get_spaces_attached,n=e.error.message.slice(e.error.message.indexOf("ResponseCode"));n&&n.indexOf("404")>=0&&(i=o.error_missing_space_media),t.displayError(e,null,null,i)}))},deleteSPPConnection:function(e,a){return i.post(r.webservices.deleteSPPConnection,JSON.stringify({physicalids:e})).then((function(){t.alertMessage("success",null,o.msg_delete_spaces_success),n.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:a})}),(function(e){let i=e.error.message.slice(e.error.message.indexOf("ResponseCode"));if(i){if(i.indexOf("401")>=0)return void t.displayError("error",o.error_del_space_failed_title,o.error_assign_space_failed_subtitle,null);if(i.indexOf("404")>=0)return void t.displayError("error",null,null,o.error_missing_space_media)}t.displayError("error",null,null,o.error_generic_system_and_network)}))}}})),define("DS/CATFLCockpitWidget/utils/configuration.util",["UWA/Core","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/CATFLCockpitWidget/utils/config.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r){"use strict";return{updateContentWithListOfModels:function(e){let a=e.container,s=e.cfgContexts;var l=new t,c=new n({selectionBehavior:{canMultiSelect:e.canMultiSelect||!1,toggle:e.toggle||!1,unselectAllOnEmptyArea:e.unselectAllOnEmptyArea||!1}}).inject(a);return s.forEach(((e,t)=>{var n=e.content&&e.content.results&&e.content.results.length>0?e.content.results[0]:null;if(n){var a="",s="",c="",d="",u="";u=window.location.href.indexOf("validateEffectivityIsImplementedBy.html")>-1?window.location.href.substring(0,window.location.href.indexOf("/webapps"))+"/common/images/I_Model_Thumbnail.png":o.getServiceURL("3DSpace")+"/common/images/I_Model_Thumbnail.png",n.data&&n.data.length>0&&n.data[0]&&n.data[0].value&&n.data[0].value.length>0&&n.data[0].value[0]&&"Marketing Name"==n.data[0].name&&(a=n.data[0].value[0]),n.basicData.forEach(((e,t)=>{"name"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(s=e.value[0]),"owner"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(c=e.value[0]),"current"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(d=e.value[0])}));var p=new i({label:a,thumbnail:n.preview_url&&""!==n.preview_url?n.preview_url:u,subLabel:s+" | "+c,description:r.label_maturity+" : "+d,dataModel:{physicalid:n.physicalID,name:s,title:a}});l.addRoot(p)}})),c.loadApplicativeModel(l),c}}})),define("DS/CATFLCockpitWidget/components/WIWItemCreationModal/WIWValidateEffectivity",["UWA/Core","DS/UIKIT/Mask","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/DataGridView/DataGridView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Controls/Button","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/configuration.util","DS/CATFLCockpitWidget/services/model.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p){c.getFullConfig().identifiers;return{init:function(e,t){var i=this;i.options=e,i.immersiveFrame=new n({}),i.checkEffDialog=i.createDialogCheckEffConsistency(),i.errorNodes={noContexts:[],noEffectivity:[],noOccLinks:[],ctxWUC:[]},i.instDetails={},i.parentDetails={},i.nodesToProcess={instanceIds:[],nodes:[]};let o=e.ListSelectedInstances;for(let e=0;e<o.length;e++){let t=o[e];if(t.instanceID){let e=t.parentID;if(e){let n=t.instanceID;i.instDetails[n]=i.instDetails[n]?i.instDetails[n].push(t):[t],i.parentDetails[e]||(i.parentDetails[e]=[]),i.parentDetails[e].indexOf(n)<0&&i.parentDetails[e].push(n)}}}let r=Object.keys(i.parentDetails);r&&r.length>0&&i.validateRelatedContexts(r).then((()=>{if(i.noCtxInst=[],i.parentWUCInst=[],i.cfgContextDetails){attachedContexts=i.cfgContextDetails.contextInfo;let e=i.cfgContextDetails.referencesInfo,n=i.cfgContextDetails.chgCtrl;if(e.forEach((e=>{"no"===e.hasConfigContext.toLowerCase()&&i.noCtxInst.push(...i.parentDetails[e.pid])})),n)for(let e in n)"none"!==n[e]&&i.parentWUCInst.push(...i.parentDetails[e]);attachedContexts.length>1?i._manageViewForMoreThanOneContext():i._manageViewForOneContext(),i.immersiveFrame.inject(t)}}))},validateRelatedContexts:function(e){let t=this;var i=[];i.push(u.getConfigContextInfo(e));let n=e.map((e=>"pid:"+e));return i.push(u.getChangeControl({ObjectsListForGetChangeControl:n})),Promise.all(i).then((e=>{let i=e[0],n=e[1];if(i?i.contextInfo&&i.contextInfo.length>0?t.cfgContextDetails=i:l.alertMessage("error",null,p.error_no_model_attached):l.alertMessage("error",null,p.error_info_models),n){let e={};n.objectListChangeControlled.forEach((t=>{e[t.id.slice(4)]=t.changeControlValue})),t.cfgContextDetails.chgCtrl=e}}))},createDialogCheckEffConsistency:function(){let t=this;t.content=e.createElement("div",{class:"effectivity-consistency-container"}),checkEffDialog=new i({title:p.action_check_effectivity_consistency,height:500,width:1200,resizableFlag:!0,modalFlag:!0,immersiveFrame:t.immersiveFrame,content:t.content}),checkEffDialog._applyButtons(),checkEffDialog.addEventListener("close",(function(){t.gridView&&t.gridView.destroy(),t.checkEffDialog.destroy()}));let n=p.outfitting_message,o=e.createElement("div");return e.createElement("p",{html:n}).inject(o),o.inject(checkEffDialog.getContent().getElement(".effectivity-consistency-container")),checkEffDialog},viewEffConsistencyReport:function(i){let n=this,s=i&&i.effConsistencyMap,c=n.checkEffDialog.getContent().querySelector(".effectivity-consistency-container");t.mask(c,p.msg_loading);var d={iconPath:window.location.href.substring(0,window.location.href.indexOf("/webapps"))+"/snresources/images/icons/small/I_VPMNavLogical.png",iconSize:{height:"16px",width:"16px"}};let u=n.checkEffDialog.getContent().getElement(".effectivity-consistency-container .model-selection-container"),g=n.checkEffDialog.getContent().getElement(".effectivity-consistency-container .eff-consistency-griview");if(u&&u.hide(),g&&g.show(),n.gridView)n.gridView.treeDocument.empty(),n.errorNodes.noOccLinks=[],n.errorNodes.noEffectivity=[];else{let t=n.getColumnDefForEffConsistencyReport(),i=e.createElement("div",{class:"eff-consistency-griview"});n.gridView=new o({identifier:"grid-view-effectivity-consistency",height:"inherit",treeDocument:new r({useAsyncPreExpand:!0}),columns:t,rowSelection:"none",rowDragEnabledFlag:!0,rowReorderEnabledFlag:!1,defaultColumnDef:{width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{expandCollapse:!0})),t}}),n.gridView.sortModel=[{dataIndex:"isEffConsistent",sort:"asc"}];var f={label:{filterId:"stringRegexp"},revision:{filterId:"stringRegexp"},instanceName:{filterId:"stringRegexp"},type:{filterId:"stringRegexp"},isEffConsistent:{filterId:"set"}};n.gridView.treeDocument.setFilterModel(f),n.gridView.onDragStartRowHeader=function(e,t){return e.dataTransfer.setData("Text",JSON.stringify(l.create3DXJsonFromDGVSelection([t.nodeModel],!1))),!0},n.gridView.getContent().inject(i),n.checkEffDialog.getContent().getElement(".effectivity-consistency-container").appendChild(i)}n.gridView.treeDocument.prepareUpdate();let m=[];if(n.errorNodes={noContexts:[],noEffectivity:[],noOccLinks:[],ctxWUC:[]},s)for(let e in s){let t=s[e],i=t.effectivityCheck&&t.effectivityCheck.status,o={instanceName:t.instanceTitle,instanceId:t.instanceID,CurrentEvolutionEffectivity:t.currentEffectivity&&t.currentEffectivity.replace(/(\r\n|\n|\r)/gm," "),isEffConsistent:!(!i||"valid"!==i.toLowerCase()),revision:t.referenceRevision,type:t.referenceTypeNLS},r=new a({physicalid:t.referenceID,label:t.referenceTitle,type:t.referenceType,icons:[d],grid:o});var h=o.instanceId,v=!1;n.noCtxInst.indexOf(h)>=0&&(v=!0,n.errorNodes.noContexts.push(r)),n.parentWUCInst.indexOf(h)>=0&&(v=!0,n.errorNodes.ctxWUC.push(r)),v||(n.nodesToProcess.instanceIds.push(h),n.nodesToProcess.nodes.push(r),i&&"notprocessed"===i.toLowerCase()||t.effectivityCheck.isOccOccEmpty?(t.effectivityCheck.isOccOccEmpty&&n.errorNodes.noOccLinks&&n.errorNodes.noOccLinks.push(r),t.effectivityCheck.isEvolutionEmpty&&n.errorNodes.noEffectivity&&n.errorNodes.noEffectivity.push(r)):(t.isImplementedBy&&t.isImplementedBy.forEach((e=>{var t=new a({physicalid:e.referenceID,label:e.referenceTitle,type:e.referenceType,icons:[d],grid:{instanceName:e.instanceTitle,instanceId:e.instanceID,CurrentEvolutionEffectivity:e.currentEffectivity&&e.currentEffectivity.replace(/(\r\n|\n|\r)/gm," "),revision:e.referenceRevision,type:e.referenceTypeNLS}});r.addChild(t)})),i&&"computationerror"===i.toLowerCase()?(delete r.options.grid.isEffConsistent,m.push(r)):n.gridView.treeDocument.addRoot(r)))}if(m&&m.length>0){let e=new a({label:p.label_processed_error});m.forEach((t=>{e.addChild(t)})),e.getChildren()&&e.getChildren().length>0&&n.gridView.treeDocument.addRoot(e)}if(n.errorNodes){let e=new a({label:p.label_unprocessed_items});if(n.errorNodes.noContexts.length>0){let t=new a({label:p.label_no_cfg_ctx});n.errorNodes.noContexts.forEach((e=>{var i=new a({physicalid:e.options.physicalid,label:e.options.label,icons:[d],grid:{instanceName:e.options.grid.instanceName,instanceId:e.options.grid.instanceId,revision:e.options.grid.revision,type:e.options.grid.type}});t.addChild(i)})),t.getChildren().length>0&&e.addChild(t)}if(n.errorNodes.noOccLinks.length>0){let t=new a({label:p.label_no_occ_link});n.errorNodes.noOccLinks.forEach((e=>{var i=new a({physicalid:e.options.physicalid,label:e.options.label,icons:[d],grid:{instanceName:e.options.grid.instanceName,instanceId:e.options.grid.instanceId,revision:e.options.grid.revision,type:e.options.grid.type}});t.addChild(i)})),t.getChildren().length>0&&e.addChild(t)}if(n.errorNodes.noEffectivity.length>0){let t=new a({label:p.label_no_eff});n.errorNodes.noEffectivity.forEach((e=>{var i=new a({physicalid:e.options.physicalid,label:e.options.label,icons:[d],grid:{instanceName:e.options.grid.instanceName,instanceId:e.options.grid.instanceId,revision:e.options.grid.revision,type:e.options.grid.type}});t.addChild(i)})),t.getChildren().length>0&&e.addChild(t)}if(n.errorNodes.ctxWUC.length>0){let t=new a({label:p.label_ctx_wuc});n.errorNodes.ctxWUC.forEach((e=>{var i=new a({physicalid:e.options.physicalid,label:e.options.label,icons:[d],grid:{instanceName:e.options.grid.instanceName,instanceId:e.options.grid.instanceId,revision:e.options.grid.revision,type:e.options.grid.type}});t.addChild(i)})),t.getChildren().length>0&&e.addChild(t)}e.getChildren()&&e.getChildren().length>0&&n.gridView.treeDocument.addRoot(e)}t.unmask(c),n.gridView.treeDocument.expandAll(),n.gridView.treeDocument.pushUpdate()},getColumnDefForEffConsistencyReport:function(){return[{text:p.label_title,dataIndex:"tree",editableFlag:!1,alwaysVisibleFlag:!0,pinned:"left",width:200},{text:p.label_revision,dataIndex:"revision",editableFlag:!1,alwaysVisibleFlag:!0},{text:p.label_type,dataIndex:"type",editableFlag:!1,alwaysVisibleFlag:!0},{text:p.label_title,icon:{iconName:"object-instance"},dataIndex:"instanceName",editableFlag:!1,alwaysVisibleFlag:!0},{text:p.label_current_evolution,dataIndex:"CurrentEvolutionEffectivity",alwaysVisibleFlag:!0,sortableFlag:!1,editableFlag:!1,width:500},{text:p.label_valid,dataIndex:"isEffConsistent",typeRepresentation:"boolean",editableFlag:!1,width:95,getCellClassName:function(e){return e&&e.nodeModel?!0===e.nodeModel.options.grid.isEffConsistent?"sax-is-valid-true":"sax-is-valid-false":null},alwaysVisibleFlag:!0}]},_manageViewForMoreThanOneContext:function(){var t=this,i=t.checkEffDialog.getContent().getElement(".effectivity-consistency-container .model-selection-container");let n=t.checkEffDialog.getContent().getElement(".effectivity-consistency-container .eff-consistency-griview");i?(i&&i.show(),n&&n.hide()):(i=e.createElement("div",{class:"model-selection-container"})).inject(t.checkEffDialog.getContent().getElement(".effectivity-consistency-container")),t.checkEffDialog.title=p.action_check_effectivity_consistency+" - "+p.action_outfitting+" - "+p.label_select_model;var o=t.cfgContextDetails.contextInfo;t.tileCollectionOfModels=d.updateContentWithListOfModels({cfgContexts:o,container:i}),t.tileCollectionOfModels.onSelectionAdd((function(){t.checkEffDialog.buttons.Open.disabled=!1})),t.checkEffDialog.buttons={Open:new s({label:p.label_next,emphasize:"primary",onClick:t._onSelectionOfModel.bind(t),disabled:!0}),Cancel:new s({emphasize:"secondary",onClick:function(){t.checkEffDialog.close(),window.dscef&&dscef.sendString("validateEffectivityCanceledNotif")}})},t.checkEffDialog._applyButtons()},_manageViewForOneContext:function(){var e=this;e.getEffConsistencyReport(),e.checkEffDialog.buttons={Ok:new s({label:p.action_close,emphasize:"primary",onClick:function(){e.checkEffDialog.close(),window.dscef&&dscef.sendString("validateEffectivityClosedNotif")}}),Cancel:new s({onClick:function(){e.checkEffDialog.close(),window.dscef&&dscef.sendString("validateEffectivityCanceledNotif")},visibleFlag:!1})},e.checkEffDialog._applyButtons()},_onSelectionOfModel:function(){let e=this;if(e.tileCollectionOfModels&&e.tileCollectionOfModels.TreedocModel){var t=e.tileCollectionOfModels.TreedocModel.getSelectedNodes();1===t.length&&e.getEffConsistencyReport(t).then((function(){e.checkEffDialog.buttons={Ok:new s({label:p.action_close,emphasize:"primary",onClick:function(){e.checkEffDialog.close(),window.dscef&&dscef.sendString("validateEffectivityClosedNotif")}}),Reset:new s({label:p.action_previous,emphasize:"secondary",onClick:e._manageViewForMoreThanOneContext.bind(e)})},e.checkEffDialog._applyButtons()}))}},getEffConsistencyReport:function(e){var i=this,n=[],o=[];let r=i.checkEffDialog.getContent().querySelector(".effectivity-consistency-container");i.options.ListSelectedInstances.forEach((function(e){n.push(e.instanceID)})),n.forEach((function(e){o.push([e])}));let a={model:e?e[0].options.dataModel.physicalid:i.cfgContextDetails.contextInfo[0].modelPID,instanceIds:n,occurrenceInfo:{isImplementedByPath:o}};return u.getEffConsistencyReportofDisciplineNItem(a).then((function(e){let t;t=i.cfgContextDetails.contextInfo.length>1?i.tileCollectionOfModels.TreedocModel.getSelectedNodes()[0].getLabel():i.cfgContextDetails.contextInfo[0].content.results[0].data[0].value[0],i.checkEffDialog.title=p.action_check_effectivity_consistency+" - "+p.action_outfitting+" - "+t,i.viewEffConsistencyReport({effConsistencyMap:e})})).catch((function(e){t.unmask(r),i.checkEffDialog.close(),l.alertMessage("error",null,e.message),window.dscef&&dscef.sendString("validateEffectivityEndNotif",JSON.stringify(resp))}))}}})),define("DS/CATFLCockpitWidget/commands/RelatedObjectCmd",["UWA/Utils/InterCom","DS/CATFLCockpitWidget/utils/config.util","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json"],(function(e,t,i){"use strict";JSON.parse(i);return{execute:function(i,n){var o=t.form3DXContent([n]),r=new e.Socket("compassPageSocket");r.subscribeServer("com.ds.compass",window.parent),r.dispatchEvent("onSetX3DContent",o,"compassPageSocket"),o.appId=i,r.dispatchEvent("onLaunchApp",o,"compassPageSocket")}}}));var map={};define("DS/CATFLCockpitWidget/utils/pno.util",["DS/CATFLCockpitWidget/services/pno.service"],(function(e){return{getFullName:function(t){return void 0===map[t]&&(map[t]=e.getPnO(t)),map[t].then((function(e){return e.firstname+" "+e.lastname}))}}})),define("DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrix",["DS/Menu/Menu","DS/CATFLWebMatrix/TraceabilityMatrix","DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbar","DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/implementlink.service","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s){"use strict";var l=JSON.parse(a);return{init:function(e){var n=this;n.field={inverted:!1,expandLevel:0},n.firstSystem=e.system1,n.secondSystem=e.system2,n.linkType=e.linkType,n.typesMap=e.typesMap,n.trMatrixModelEvents=e.modelEvents;var r=n.container=UWA.createElement("div",{class:"trmatrix-main-container"}),a=UWA.createElement("div",{class:"trmatrix-toolbar-container"}).inject(r);if(n.trMatrixToolbar=new i(n,a),n.trMatrixContainer=UWA.createElement("div",{class:"traceability-matrix-container"}).inject(r),n.field.rows=[],n.field.columns=[],n.firstSystem.getChildren()&&n.secondSystem.getChildren())return n.firstSystem.getChildren().forEach((function(e){n.field.rows.push(n.generateStructure(e,!0))})),n.secondSystem.getChildren().forEach((function(e){n.field.columns.push(n.generateStructure(e,!1))})),t.resetRefRefMap(),n.createMatrix(),r;o.alertMessage("error",null,"",s.msg_system_missing_children)},injectMatrix:function(){this.trMatrix&&this.trMatrix.inject(this.trMatrixContainer)},createMatrix:function(){var e=this;e.trMatrix&&e.trMatrix.container.remove();var i={rows:e.field.inverted?e.field.columns:e.field.rows,columns:e.field.inverted?e.field.rows:e.field.columns,fixedHeaders:!0},o={onContextMenu:e.manageContextualMenuEvt.bind(e),onNewCell:e.manageCellDisplay.bind(e)};e.trMatrix=new t.Matrix(i,o),e.trMatrix.onCellSelected=function(i,o,r){if(t.Matrix.prototype.onCellSelected.call(this,i,o,r),!e.trMatrix.loading&&i&&i.getState()===t.CellState.NORMAL)if(i.relations.length>0){var a=o.data&&o.data.name?o.data.name:"",l=r.data&&r.data.name?r.data.name:"",c=UWA.createElement("p",{html:s.msg_delete_implementLink_confrimation+a+" & "+l});n.createWindow(s.label_delete_implementLink_header,c,s.action_delete,e.deleteImplementLink.bind(e,i,o,r))}else e.createImplementLink(i,o,r)}},generateStructure:function(e,t){var i,n,o=e.options.label||e.options.grid.name;o+=" "+e.options.grid.revision,e.options.instance&&e.options.instance.name&&(o+="("+e.options.instance.name+")"),i={id:e.options.instance?e.options.instance.physicalid:e.options.physicalid,type:e.options.instance.type,name:o,refId:e.options.physicalid,refType:e.options.grid.actualType,node:e,isContext:t,children:[],relations:e.relations};var r=e.getChildren();if(r)for(n=0;n<r.length;n++)i.children.push(this.generateStructure(r[n],t));return i},_setLoading:function(e){this.trMatrix.loading=e,this.trMatrix.table.toggleClass("loading",e)},createImplementLink:function(e,i,n){var a=this;e.setState(t.CellState.LOADING),a._setLoading(!0);var l=a.formDataObjFromCell(i,n);r.createOccurrenceLinks(l).then((function(){var r={id:e.id};r.path=i.getPath(),a._setLoading(!1),e.setState(t.CellState.NORMAL),e.addRelation(r),a.trMatrix.registerRelation(i,n,r);var c={};i.data.isContext?(c.firstSystemNode=i.data.node,c.secondSystemNode=n.data.node,c.ctxPath=l[0].implementing):(c.secondSystemNode=i.data.node,c.firstSystemNode=n.data.node,c.ctxPath=l[0].implemented),a.trMatrixModelEvents.publish({event:"occLink-refresh",data:c}),o.alertMessage("success",null,"",s.msg_occ2occ_create_success)})).catch((function(i){a._setLoading(!1),e.setState(t.CellState.NORMAL),o.displayError(i,null,null,s.error_create_occocc_link)}))},deleteImplementLink:function(e,i,n){var a=this;e.setState(t.CellState.LOADING),a._setLoading(!0);var l=a.formDataObjFromCell(i,n);r.deleteOccurrenceLinks(l).then((function(){a._setLoading(!1),e.setState(t.CellState.NORMAL);var r=e.relations[0];e.removeRelation(r),a.trMatrix.unregisterRelation(i,n,r);var c={};i.data.isContext?(c.firstSystemNode=i.data.node,c.secondSystemNode=n.data.node,c.ctxPath=l[0].implementing):(c.secondSystemNode=i.data.node,c.firstSystemNode=n.data.node,c.ctxPath=l[0].implemented),a.trMatrixModelEvents.publish({event:"occLink-refresh",data:c}),o.alertMessage("success",null,"",s.msg_delete_link_success)})).catch((function(i){a._setLoading(!1),e.setState(t.CellState.NORMAL),o.displayError(i,null,null,s.error_delete_link)}))},formDataObjFromCell:function(e,t){var i,n,o=this,r=o.getPathFromNodeToRoot(e.data.node,[]),a=o.getPathFromNodeToRoot(t.data.node,[]),s=r.path,l=a.path,c=[];return r.root===o.firstSystem.options.physicalid?(i=s,n=l):(i=l,n=s),"implementing"===o.linkType?c.push({implementing:i,implemented:n}):c.push({implementing:n,implemented:i}),c},getPathFromNodeToRoot:function(e,t){return e.isRoot()?(t.reverse(),{path:t,root:e.options.physicalid}):(t.push(e.options.instance.physicalid),this.getPathFromNodeToRoot(e.getParent(),t))},manageCellDisplay:function(e,i,n){i.data.refType!==l.type_chapter&&n.data.refType!==l.type_chapter||e.setState(t.CellState.DISABLED)},manageContextualMenuEvt:function(t,i){e.show(this.getContextualMenu(t),{input:"mouse",position:{x:i.pageX,y:i.pageY},submenu:"auto"})},getContextualMenu:function(e){var t=this;return[{type:"PushItem",title:s.action_set_root,fonticon:{content:"wux-ui-3ds wux-ui-3ds-open"},action:{callback:function(){t.trMatrix.setCurrentRoot(e)}}}]},getOption:function(e){var t=this;if(t.field&&t.field.hasOwnProperty(e))return t.field[e]},setOption:function(e,t){var i=this;i.field||(i.field={}),i.field[e]=t}}})),define("DS/CATFLCockpitWidget/components/ConvergenceCues/ConvergenceCues.export",["DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n){"use strict";return{exportCuesForItems:function(){var o,r,a=this.contentListViewController.contentView.treeDocument.getSelectedNodes(),s=[];if(a.length<=0)i.alertMessage("error",null,n.error_cue_export_noSelItems);else if(o=this.contentListViewController.contentView.treeDocument.getRoots()[0].options.physicalid,1!==a.length||a[0]._options.physicalid!==o){for(var l=[],c=!1,d=0;d<a.length;d++)a[d].options.instance&&(r=a[d].options.instance.physicalid,s.push(r),l.push(a[d]),a[d].options.cueDetails&&(c=!0));var u=t.confAllImplPathsOnNodes(l,!1,!1);s&&s.length>0&&(a.length>20&&i.alertMessage("info",null,n.info_download_short_while),c&&i.alertMessage("warning",null,n.msg_cue_export_warning),e.exportVisualCues(s,u.payload))}else i.alertMessage("error",null,n.error_export_cue_computation_root)}}})),define("DS/CATFLCockpitWidget/components/ModelPCSelector/checkEffectivityConsistency",["UWA/Core","DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/configuration.util","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/services/implementlink.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p){"use strict";var g=s.getFullConfig().identifiers;let f=function(e){let t=this,i=e.selectedNodes;t.action=e.action,t.instDetails={},t.parentDetails={},t.nodesToProcess={instanceIds:[],nodes:[]},t.errorNodes={noContexts:[],noEffectivity:[],noOccLinks:[],ctxWUC:[]};for(let e=0;e<i.length;e++){let n=i[e];if(n.options.instance&&n.options.instance.physicalid){let e=n.options.actualParent;if(e){let i=n.options.instance.physicalid;t.instDetails[i]=t.instDetails[i]?t.instDetails[i].push(n):[n],t.parentDetails[e.options.physicalid]||(t.parentDetails[e.options.physicalid]=[]),t.parentDetails[e.options.physicalid].indexOf(i)<0&&t.parentDetails[e.options.physicalid].push(i)}}}let n=Object.keys(t.parentDetails);n&&n.length>0&&t._validateRelatedContexts(n).then((()=>{let e=[],i=[];if(t.cfgContextDetails){let n=t.cfgContextDetails.contextInfo,o=t.cfgContextDetails.referencesInfo,r=t.cfgContextDetails.chgCtrl;if(o.forEach((i=>{"no"===i.hasConfigContext.toLowerCase()&&e.push(...t.parentDetails[i.pid])})),r)for(let e in r)"none"!==r[e]&&i.push(...t.parentDetails[e]);for(let n in t.instDetails){let o=!1,r=t.instDetails[n];e.indexOf(n)>=0&&(o=!0,t.errorNodes.noContexts.push(...r)),i.indexOf(n)>=0&&(o=!0,t.errorNodes.ctxWUC.push(...r)),o||(t.nodesToProcess.instanceIds.push(n),t.nodesToProcess.nodes.push(...r))}t.checkEffDialog=t._createDialogCheckEffConsistency(n),n.length>1?t._manageViewForMoreThanOneContext(n):t._manageViewForOneContext(n)}}))};return f.prototype._validateRelatedContexts=function(e){let t=this;var i=[];i.push(d.getConfigContextInfo(e));let n=e.map((e=>"pid:"+e));return i.push(d.getChangeControl({ObjectsListForGetChangeControl:n})),Promise.all(i).then((e=>{let i=e[0],n=e[1];if(i?i.contextInfo&&i.contextInfo.length>0?t.cfgContextDetails=i:l.alertMessage("error",null,p.error_no_model_attached):l.alertMessage("error",null,p.error_info_models),n){let e={};n.objectListChangeControlled.forEach((t=>{e[t.id.slice(4)]=t.changeControlValue})),t.cfgContextDetails.chgCtrl=e}}))},f.prototype._createDialogCheckEffConsistency=function(){let t=this,n=e.createElement("div",{class:"effectivity-consistency-container"}),o=new i({title:p.action_check_effectivity_consistency,height:500,width:1200,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,content:n});o.addEventListener("close",(function(){t.gridView&&t.gridView.destroy(),t.checkEffDialog.destroy()}));let r="outfitting"===t.action?p.outfitting_message:p.discipline_message,a=e.createElement("div");return e.createElement("p",{html:r}).inject(a),a.inject(o.getContent().getElement(".effectivity-consistency-container")),o},f.prototype._manageViewForMoreThanOneContext=function(t){var i=this;let o="outfitting"===i.action?p.action_outfitting:p.action_discipline;i.checkEffDialog.title=p.action_check_effectivity_consistency+" - "+o+" - "+p.label_select_model;let r=i.checkEffDialog.getContent().getElement(".effectivity-consistency-container .model-selection-container"),a=i.checkEffDialog.getContent().getElement(".effectivity-consistency-container .eff-consistency-griview");if(r)r&&r.show(),a&&a.hide();else{let n=e.createElement("div",{class:"model-selection-container"});n.inject(i.checkEffDialog.getContent().getElement(".effectivity-consistency-container")),i.tileCollectionOfModels=c.updateContentWithListOfModels({cfgContexts:t,container:n}),i.tileCollectionOfModels.onSelectionAdd((function(){i.checkEffDialog.buttons.Open.disabled=!1}))}i.checkEffDialog.buttons={Open:new n({label:p.label_next,emphasize:"primary",onClick:i._onSelectionOfModel.bind(i,t),disabled:!0}),Cancel:new n({emphasize:"secondary",onClick:function(){i.checkEffDialog.close()}})},i.checkEffDialog._applyButtons()},f.prototype._manageViewForOneContext=function(e){let t=this,i=e[0].content,o=i&&i.results&&i.results.length>0?i.results[0]:null,r="";o&&(o.data.forEach((e=>{"attribute[Marketing Name]"===e.selectable&&e.value&&e.value.length>0&&e.value[0]&&(r=e.value[0])})),t.checkEffConsistencyOfItemNProduct({model:{physicalid:o.physicalID,title:r}}).then((function(){t.checkEffDialog.buttons={Ok:new n({label:p.action_close,emphasize:"primary",onClick:function(){t.checkEffDialog.close()}}),Cancel:new n({onClick:function(){t.checkEffDialog.close()},visibleFlag:!1})},t.checkEffDialog._applyButtons()})))},f.prototype._onSelectionOfModel=function(e){let t=this;if(t.tileCollectionOfModels&&t.tileCollectionOfModels.TreedocModel){var i=t.tileCollectionOfModels.TreedocModel.getSelectedNodes();if(1===i.length){let o=i[0].options.dataModel;t.checkEffConsistencyOfItemNProduct({model:{physicalid:o.physicalid,title:o.title}}).then((function(){t.checkEffDialog.buttons={Ok:new n({label:p.action_close,emphasize:"primary",onClick:function(){t.checkEffDialog.close()}}),Reset:new n({label:p.action_previous,emphasize:"secondary",onClick:t._manageViewForMoreThanOneContext.bind(t,e)})},t.checkEffDialog._applyButtons()}))}}},f.prototype.checkEffConsistencyOfItemNProduct=function(e){let i=this,n=i.checkEffDialog.getContent().querySelector(".effectivity-consistency-container");if(t.mask(n,p.msg_loading),i.nodesToProcess.nodes.length<=0)return i.checkEffDialog.title=p.action_check_effectivity_consistency+" - "+e.model.title,i.viewEffConsistencyReport(),t.unmask(n),Promise.resolve();var o=u.confAllImplPathsOnNodes(i.nodesToProcess.nodes,!1,!1,{bIsImplementedBy:"outfitting"===this.action,bIsImplementing:"discipline"===this.action});if(e.model.physicalid&&"outfitting"===this.action){let r=o&&o.payload&&o.payload.isImplementedByPath;if(!r)return void l.alertMessage("error",null,"Unable to fetch effectivity consistency details");let a={model:e.model.physicalid,instanceIds:i.nodesToProcess.instanceIds,occurrenceInfo:{isImplementedByPath:r}};return d.getEffConsistencyReportofItemNProduct(a).then((function(o){i.checkEffDialog.title=p.action_check_effectivity_consistency+" - "+p.action_outfitting+" - "+e.model.title,i.viewEffConsistencyReport({effConsistencyMap:o}),t.unmask(n)})).catch((function(e){t.unmask(n),i.checkEffDialog.close(),l.alertMessage("error",null,e.message)}))}if(e.model.physicalid&&"discipline"===this.action){let r=o&&o.payload&&o.payload.isImplementingPath;if(!r)return void l.alertMessage("error",null,"Unable to fetch effectivity consistency details");let a={model:e.model.physicalid,instanceIds:i.nodesToProcess.instanceIds,occurrenceInfo:{isImplementingPath:r}};return d.getEffConsistencyReportofItemNDiscipline(a).then((function(o){i.checkEffDialog.title=p.action_check_effectivity_consistency+" - "+p.action_discipline+" - "+e.model.title,i.viewEffConsistencyReport({effConsistencyMap:o}),t.unmask(n)})).catch((function(e){t.unmask(n),i.checkEffDialog.close(),l.alertMessage("error",null,e.message)}))}l.alertMessage("error",null,"Unable to fetch effectivity consistency details")},f.prototype.viewEffConsistencyReport=function(t){let i=this,n=t&&t.effConsistencyMap,c=i.checkEffDialog.getContent().getElement(".effectivity-consistency-container .model-selection-container"),d=i.checkEffDialog.getContent().getElement(".effectivity-consistency-container .eff-consistency-griview");if(c&&c.hide(),d&&d.show(),i.gridView)i.gridView.treeDocument.empty(),i.errorNodes.noOccLinks=[],i.errorNodes.noEffectivity=[];else{let t=i.getColumnDefForEffConsistencyReport(),n=e.createElement("div",{class:"eff-consistency-griview"});i.gridView=new a({identifier:"grid-view-effectivity-consistency",height:"inherit",treeDocument:new o({useAsyncPreExpand:!0,shouldAcceptDrag:function(e){return!!e.options.physicalid}}),columns:t,rowSelection:"none",rowDragEnabledFlag:!0,rowReorderEnabledFlag:!1,defaultColumnDef:{width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{expandCollapse:!0})),t}}),i.gridView.sortModel=[{dataIndex:"isEffConsistent",sort:"asc"}];var u={label:{filterId:"stringRegexp"},revision:{filterId:"stringRegexp"},instanceName:{filterId:"stringRegexp"},type:{filterId:"stringRegexp"}};"discipline"===i.action&&(u.isEffConsistent={filterId:"set"}),i.gridView.treeDocument.setFilterModel(u),i.gridView.onDragStartRowHeader=function(e,t){return e.dataTransfer.setData("Text",JSON.stringify(l.create3DXJsonFromDGVSelection([t.nodeModel],!1))),!0},i.gridView.getContent().inject(n),i.checkEffDialog.getContent().getElement(".effectivity-consistency-container").appendChild(n)}i.gridView.treeDocument.prepareUpdate();let f=[];if(n)for(let e in n){let t=n[e],o=t.effectivityCheck&&t.effectivityCheck.status,a={instanceName:t.instanceTitle,instanceId:t.instanceID,CurrentEvolutionEffectivity:t.currentEffectivity&&t.currentEffectivity.replace(/(\r\n|\n|\r)/gm," "),revision:t.referenceRevision,type:t.referenceTypeNLS};"outfitting"===i.action&&(a.isEffConsistent=!(!o||"valid"!==o.toLowerCase()));let l=new r({physicalid:t.referenceID,label:t.referenceTitle,type:t.referenceType,icons:[s.getTypeIconUrl(g.type_act_logref)],grid:a});"outfitting"===i.action&&o&&"notprocessed"===o.toLowerCase()||"discipline"===i.action&&t.effectivityCheck.isOccOccEmpty?(t.effectivityCheck.isOccOccEmpty&&i.errorNodes.noOccLinks&&i.errorNodes.noOccLinks.push(l),t.effectivityCheck.isEvolutionEmpty&&i.errorNodes.noEffectivity&&i.errorNodes.noEffectivity.push(l)):("outfitting"===i.action&&t.isImplementedBy?t.isImplementedBy.forEach((e=>{var t=new r({physicalid:e.referenceID,label:e.referenceTitle,type:e.referenceType,icons:[s.getTypeIconUrl(g.type_act_physical)],grid:{instanceName:e.instanceTitle,instanceId:e.instanceID,CurrentEvolutionEffectivity:e.currentEffectivity&&e.currentEffectivity.replace(/(\r\n|\n|\r)/gm," "),revision:e.referenceRevision,type:e.referenceTypeNLS}});l.addChild(t)})):"discipline"===i.action&&t.isImplementing&&t.isImplementing.forEach((e=>{var t=new r({physicalid:e.referenceID,label:e.referenceTitle,type:e.referenceType,icons:[s.getTypeIconUrl(g.type_act_logref)],grid:{instanceName:e.instanceTitle,instanceId:e.instanceID,CurrentEvolutionEffectivity:e.currentEffectivity&&e.currentEffectivity.replace(/(\r\n|\n|\r)/gm," "),isEffConsistent:!(!e.status||"valid"!==e.status.toLowerCase()),revision:e.referenceRevision,type:e.referenceTypeNLS}});l.addChild(t)})),o&&"computationerror"===o.toLowerCase()?(delete l.options.grid.isEffConsistent,f.push(l)):i.gridView.treeDocument.addRoot(l))}if(f&&f.length>0){let e=new r({label:p.label_processed_error});f.forEach((t=>{e.addChild(t)})),e.getChildren()&&e.getChildren().length>0&&i.gridView.treeDocument.addRoot(e)}if(i.errorNodes){let e=new r({label:p.label_unprocessed_items});if(i.errorNodes.noContexts.length>0){let t=new r({label:p.label_no_cfg_ctx});i.errorNodes.noContexts.forEach((e=>{var i=new r({physicalid:e.options.physicalid,label:e.options.label,icons:[s.getTypeIconUrl(g.type_act_logref)],grid:{instanceName:e.options.grid.instanceName,instanceId:e.options.instance.physicalid,revision:e.options.grid.revision,type:e.options.grid.type}});t.addChild(i)})),t.getChildren().length>0&&e.addChild(t)}if(i.errorNodes.noOccLinks.length>0){let t=new r({label:p.label_no_occ_link});i.errorNodes.noOccLinks.forEach((e=>{var i=new r({physicalid:e.options.physicalid,label:e.options.label,icons:[s.getTypeIconUrl(g.type_act_logref)],grid:{instanceName:e.options.grid.instanceName,instanceId:e.options.grid.instanceId,revision:e.options.grid.revision,type:e.options.grid.type}});t.addChild(i)})),t.getChildren().length>0&&e.addChild(t)}if(i.errorNodes.noEffectivity.length>0){let t=new r({label:p.label_no_eff});i.errorNodes.noEffectivity.forEach((e=>{var i=new r({physicalid:e.options.physicalid,label:e.options.label,icons:[s.getTypeIconUrl(g.type_act_logref)],grid:{instanceName:e.options.grid.instanceName,instanceId:e.options.grid.instanceId,revision:e.options.grid.revision,type:e.options.grid.type}});t.addChild(i)})),t.getChildren().length>0&&e.addChild(t)}if(i.errorNodes.ctxWUC.length>0){let t=new r({label:p.label_ctx_wuc});i.errorNodes.ctxWUC.forEach((e=>{var i=new r({physicalid:e.options.physicalid,label:e.options.label,icons:[s.getTypeIconUrl(g.type_act_logref)],grid:{instanceName:e.options.grid.instanceName,instanceId:e.options.instance.physicalid,revision:e.options.grid.revision,type:e.options.grid.type}});t.addChild(i)})),t.getChildren().length>0&&e.addChild(t)}e.getChildren()&&e.getChildren().length>0&&i.gridView.treeDocument.addRoot(e)}i.gridView.treeDocument.expandAll(),i.gridView.treeDocument.pushUpdate()},f.prototype.getColumnDefForEffConsistencyReport=function(){return[{text:p.label_title,dataIndex:"tree",editableFlag:!1,alwaysVisibleFlag:!0,pinned:"left",width:200},{text:s.getNlsBasicAttributesBO("ds6wg:revision"),dataIndex:"revision",editableFlag:!1,alwaysVisibleFlag:!0},{text:s.getNlsBasicAttributesBO("ds6w:type"),dataIndex:"type",editableFlag:!1,alwaysVisibleFlag:!0},{text:s.getNlsBasicAttributesBO("ds6w:label"),icon:{iconName:"object-instance"},dataIndex:"instanceName",editableFlag:!1,alwaysVisibleFlag:!0},{text:p.label_current_evolution,dataIndex:"CurrentEvolutionEffectivity",alwaysVisibleFlag:!0,sortableFlag:!1,editableFlag:!1,width:500},{text:p.label_valid,dataIndex:"isEffConsistent",typeRepresentation:"boolean",editableFlag:!1,width:95,getCellClassName:function(e){return e&&e.nodeModel?!0===e.nodeModel.options.grid.isEffConsistent?"sax-is-valid-true":"sax-is-valid-false":null},alwaysVisibleFlag:!0}]},f})),define("DS/CATFLCockpitWidget/components/IDCard/decorators/idcard.database-icon",["DS/Controls/TooltipModel","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/tooltip.util","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r){"use strict";let a=n.loadTooltips(["indexModeActive","databaseModeActive"]),s=i.getFullConfig();const l="only_db",c="only_index",d="index_and_db";return{addDatabaseIcon:function(e){this.idcard=e,this.databaseIcon=this.idcard.container.querySelector(".generic-icon"),this.prefIndexDatabaseMode=widget.getPreference(s.localStorageKeys.indexDatabaseMode).value,this.prefTimeoutIndex=parseInt(widget.getPreference(s.localStorageKeys.timeoutIndex).value,10),this._reset(),this.prefIndexDatabaseMode===s.localStorageKeys.indexAndDatabaseMode&&(this.flwebModelEvents=o.getFLWebModelEventsObj("flweb-model-events"),this.flwebModelEvents.subscribe({event:"item-loaded-from-database"},this._onItemLoadedFromDatabase.bind(this)),this.flwebModelEvents.subscribe({event:"flweb-ngfilter-added"},this._reset.bind(this)))},_reset:function(){this.prefIndexDatabaseMode===s.localStorageKeys.onlyDatabaseMode?this._updateDatabaseIcon(l):this._updateDatabaseIcon(c),this._clearTimeoutSwitchBackToIndexMode()},_updateDatabaseIcon:function(e){this.currentState=e,this.databaseIcon.classList.remove("fonticon-database","fonticon-database-refresh","fonticon-database-hourglass","active","active-light"),e===c?(widget.setValue("databaseModeActive",0),n.setTooltip(this.databaseIcon,"indexModeActive",a),this.databaseIcon.classList.add("fonticon","fonticon-database-refresh")):(widget.setValue("databaseModeActive",1),n.setTooltip(this.databaseIcon,"databaseModeActive",a),e===d?this.databaseIcon.classList.add("fonticon","fonticon-database-hourglass","active"):e===l&&this.databaseIcon.classList.add("fonticon","fonticon-database","active-light"))},_onItemLoadedFromDatabase:function(e){this.prefIndexDatabaseMode===s.localStorageKeys.indexAndDatabaseMode&&(this.currentState!==d&&(e.authoring&&t.alertMessage("info",r.title_switched_to_db_mode,null,r.msg_switched_to_db_mode),this._updateDatabaseIcon(d)),this.timeoutSwitchBackToIndex?e.timestamp+1e3*this.prefTimeoutIndex>this.timeoutEnd&&this._launchTimeoutSwitchBackToIndexMode(e.timestamp):this._launchTimeoutSwitchBackToIndexMode(e.timestamp))},_launchTimeoutSwitchBackToIndexMode:function(e){let i=this;i._clearTimeoutSwitchBackToIndexMode(),i.timeoutEnd=e+1e3*this.prefTimeoutIndex,i.timeoutSwitchBackToIndex=setTimeout((function(){t.alertMessage("info",r.title_switched_to_index_mode,null,r.replace(r.msg_switched_to_index_mode_auto,{timeout:i.prefTimeoutIndex/60})),i._updateDatabaseIcon(c)}),i.timeoutEnd-Date.now())},_clearTimeoutSwitchBackToIndexMode:function(){this.timeoutSwitchBackToIndex&&clearTimeout(this.timeoutSwitchBackToIndex),this.timeoutEnd=null}}})),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.configure.expand",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l){"use strict";var c=JSON.parse(s),d=function(e){this.options=e};return d.prototype.render=function(e){var n=this,o=n.getExpandOptionsContainer();n.dialog=new t({title:l.action_configure_expand,content:o,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new i({label:l.apply_button,emphasize:"primary",disabled:!0,onClick:n._applyConfiguredExpandOperation.bind(n,e)}),Cancel:new i({emphasize:"secondary",onClick:function(){n.dialog.close()}})},activateButtonsIfActionPerformed:!1}),n.dialog.addEventListener("close",(function(){n.dialog.destroy()}))},d.prototype.getExpandOptionsContainer=function(){let t=this,i=widget.getValue("configurable_expand"),a=!1;i||(a=!0,i={});var s=widget.getValue(c.componentView);let d=e.createElement("div",{class:"configure-expand-options-container"});t.optsButtonGroup=new n({type:"checkbox"});let u=s===c.structuredView;return t.optsButtonGroup.addChild(new o({type:"checkbox",label:l.label_implementing,value:"implementing",checkFlag:i.implementing||a,visibleFlag:u})),t.optsButtonGroup.addChild(new o({type:"checkbox",label:l.label_is_implementing,value:"isImplementing",checkFlag:i.isImplementing||a,visibleFlag:u})),t.optsButtonGroup.addChild(new o({type:"checkbox",label:l.label_implemented_by,value:"implementedBy",checkFlag:i.implementedBy||a,visibleFlag:u})),t.optsButtonGroup.addChild(new o({type:"checkbox",label:l.label_is_implemented_by,value:"isImplementedBy",checkFlag:i.isImplementedBy||a,visibleFlag:u})),t.optsButtonGroup.addChild(new o({type:"checkbox",label:l.label_proposed_solution,value:"proposedSolution",checkFlag:i.proposedSolution||a})),t.optsButtonGroup.addChild(new o({type:"checkbox",label:l.label_spec_documents,value:"specDocs",checkFlag:i.specDocs||a})),t.optsButtonGroup.addEventListener("change",(function(){let e,n=Object.keys(i)||[],o=t.optsButtonGroup.value,a=!1;o.indexOf("isImplementing")>=0&&o.indexOf("implementing")<0&&(t.optsButtonGroup.getButtonFromValue("implementing").checkFlag=!0,a=!0),o.indexOf("isImplementedBy")>=0&&o.indexOf("implementedBy")<0&&(t.optsButtonGroup.getButtonFromValue("implementedBy").checkFlag=!0,a=!0),a&&(o=t.optsButtonGroup.value,r.alertMessage("warning",null,l.msg_config_exp_occLink_warning)),e=o.length===n.length&&o.every((function(e){return n.indexOf(e)>=0}));var s=t.dialog.buttons.Ok;s.disabled=!!e})),t.optsButtonGroup.inject(d),d},d.prototype._applyConfiguredExpandOperation=function(e){let t={};this.optsButtonGroup.value.forEach((function(e){t[e]=!0})),widget.setValue("configurable_expand",t),e.setConfigureExpandButtonActiveState(t),a.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-refresh"}),this.dialog.close()},d})),define("DS/CATFLCockpitWidget/components/PropertiesPanel/propertiespanel.controller",["DS/CoreEvents/ModelEvents","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","DS/CATFLCockpitWidget/utils/config.util","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a){"use strict";let s=JSON.parse(r);return{init:function(n){var r=this;r.triptych=n,r.modelEvents=new e,r.parentContainer=n.getRightPanelContent();var a=[i.FACET_PROPERTIES,i.FACET_INSTANCE,i.FACET_CLASSIFICATIONS,i.FACET_SHARING,i.FACET_RELATIONS,i.FACET_EFFECTIVITY,i.FACET_CHANGE,i.FACET_iCHANGE,i.FACET_SWYMCOMMENTS,i.FACET_ADMIN],s={typeOfDisplay:i.ALL,selectionType:i.NO_SELECTION,facets:a,extraNotif:!0,editMode:!1,readOnly:!1,context:{getSecurityContext:function(){return{SecurityContext:o.getSecurityContext()}}}};return this.EditPropWidget=new t(s),this.addHistoryTab(),this.addAttachmentsTab(),this.addSpecDocsTab(),this.EditPropWidget.elements.container.inject(r.parentContainer),n.modelEvents.subscribe({event:"triptych-panel-show-started"},(function(e){"right"===e&&r.contentToLoad&&r.loadModel(r.contentToLoad.items,r.contentToLoad.isImplLinkInfo)})),r},loadModel:function(e,t,i){let n=this;i&&(n.contentView=i),n.triptych._isRightOpen?(n.EditPropWidget.initDatas(n._createEditPropModel(e,t)),n.contentToLoad=null):n.contentToLoad={items:e,isImplLinkInfo:t}},_createEditPropModel:function(e,t){let i=this,r=[],a=[];return i._formObjForEditProp(e,t).forEach((function(e){a.push(e.physicalid);let t=new n({metatype:e.metatype?e.metatype:"businessobject",objectId:e.physicalid,instrefid:e.childPID,tenant:o.getTenant(),source:"3DSpace"});t.set("isTransient",!1),t.addEvent("onSave",(function(){i.modelEvents.publish({event:"properties-panel-on-save",data:a})})),r.push(t)})),r},_formObjForEditProp:function(e,t){var i=[];if(0===e.length){if(widget.getValue("currentView")&&"LandingPage"!==widget.getValue("currentView")){var n=widget.getValue("currentOpenedItem");i.push({physicalid:n,rootPID:n,metatype:"businessobject"})}}else e.forEach((function(e){e.options.instance&&e.options.instance.physicalid?i.push({physicalid:e.options.instance.physicalid,childPID:e.options.physicalid,rootPID:e.getRoot().options.physicalid,metatype:"relationship"}):e.options.linkInfo&&e.options.linkInfo.objType&&t?i.push({physicalid:e.options.linkInfo.implementId,rootPID:e.getRoot().options.physicalid,metatype:"businessobject"}):e.options.physicalid&&i.push({physicalid:e.options.physicalid,rootPID:e.getRoot().options.physicalid,metatype:"businessobject"})}));return i},addAttachmentsTab:function(){this.EditPropWidget.addFacets([{require:"DS/CATFLCockpitWidget/components/PropertiesPanel/facets/RelatedDocumentsFacet",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"REFERENCE_DOCUMENT",icon:"attach",text:a.label_attachmentsTab},options:{getAppContext:this.getContentView.bind(this),specificationDocuments:!1}}])},addSpecDocsTab:function(){var e=this;s.showSpecDocs&&widget.getPreference(s.showSpecDocs)&&widget.getPreference(s.showSpecDocs).value&&e.EditPropWidget.addFacets([{require:"DS/CATFLCockpitWidget/components/PropertiesPanel/facets/RelatedDocumentsFacet",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"SPECIFICATION_DOCUMENT",icon:"doc-log",text:a.label_specifcationsTab},options:{getAppContext:e.getContentView.bind(e),specificationDocuments:!0}}])},addHistoryTab:function(){var e=this;e.EditPropWidget.addFacets([{require:"DS/EditPropWidget/facets/GeneralHistory/History",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"History",icon:"clock",text:a.label_history},options:{getAppContext:e.getContentView.bind(e)}}])},getContentView:function(){return this.contentView}}})),define("DS/CATFLCockpitWidget/components/ContentListView/decorators/contentlistview.filterModel",["DS/CATFLCockpitWidget/components/ContentListView/contentlistview.filter","DS/CATFLCockpitWidget/components/ContentListView/decorators/contentlistview.viewport"],(function(e,t){"use strict";var i=[];return{manageDefaultFilterModel:function(){var e=this,t={revision:{filterId:"stringRegexp"},isLastVersion:{filterId:"set"},instanceName:{filterId:"stringRegexp"},owner:{filterId:"stringRegexp"},isReserved:{filterId:"set"},modificationDate:{filterId:"date"},description:{filterId:"stringRegexp"},type:{filterId:"stringRegexp"},name:{filterId:"stringRegexp"},creationDate:{filterId:"date"},architectureNumber:{filterId:"stringRegexp"},instance_description:{filterId:"stringRegexp"},label:{filterId:"stringRegexp"},maturity:{filterId:"set"},instance_isReserved:{filterId:"set"}};e.contentView.columns.forEach((function(e){e.isCustomAttribute&&("date"===e.typeRepresentation?t[e.dataIndex]={filterId:"date"}:"integer"===e.typeRepresentation||"number"===e.typeRepresentation?t[e.dataIndex]={filterId:"number"}:"boolean"===e.typeRepresentation?t[e.dataIndex]={filterId:"set"}:"multilineString"===e.typeRepresentation?t[e.dataIndex]={filterId:"stringRegexp"}:t[e.dataIndex]={filterId:"string",filterOptions:{allowRegexp:!0}})})),e.contentView.options.defaultFilterModel=t,e.contentView.treeDocument.setFilterModel(t)},manageSpecificFilterModels:function(){var n=this;let o=n.contentView.options.defaultFilterModel;for(var r of i)n.modelEvents.unsubscribe(r);(i=[]).push(n.modelEvents.subscribe({event:"content-list-view-clearFilterModels"},(function(){e.clearFilterModels(n.contentView)})));var a=e.registerAndCreateAllFilters(n.contentView,o);n.contentView.options.currentFilterModelName=null,i.push(n.modelEvents.subscribe({event:"content-list-view-apply-specific-filter"},(function(i){let r;if(i.toFocus&&(r=t.getFirstVisibleNodeInViewport.call(n)),"noFilter"===i.filterName)n.contentView.options.currentFilterModelName?e.changeFilterModel(n.contentView,o):n.contentView.getTreeDocument().reapplyFilterModel(),n.contentView.options.currentFilterModelName=null;else{let t=a[i.filterName];t&&(n.contentView.options.currentFilterModelName!==i.filterName?e.changeFilterModel(n.contentView,t):n.contentView.getTreeDocument().reapplyFilterModel(),n.contentView.options.currentFilterModelName=i.filterName)}i.toFocus&&t.focusViewportOnNode.call(n,r)})))}}})),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.additionalcolumns",["DS/CATFLCockpitWidget/utils/config.util"],(function(){"use strict";return{_getAdditionalColumns:function(e){return e.gridview||(e.gridview={}),Promise.all([this._getConfigurationColumns(e)])},_getConfigurationColumns:function(e){let t=[],i={},n=[];var o=new Promise((function(e){require(["DS/CfgWebAppEffectivityUX/scripts/CfgConfigurationContextColumn"],(function(n){n.isAdditionalColumnsAvailable((function(o){if(!0===o){let e=[];n.getAdditionalColumnsUXDGV(e),e.forEach((e=>{"ConfigurationContext"===e.dataIndex?e.columnModule="cfgContext":"RevisionMaster"===e.dataIndex?e.columnModule="revisionMaster":"RevisionMode"===e.dataIndex&&(e.columnModule="revisionMode"),t.push(e)})),i.cfgContext=n}e()})),o.name="Add "+n.getName()}))}));n.push(o);var r=new Promise((function(e){require(["DS/CfgWebAppEffectivityUX/scripts/CfgEffectivityColumns"],(function(n){n.isAdditionalColumnsAvailable((function(o){if(!0===o){let e=[];n.getAdditionalColumnsUXDGV(e),e.forEach((e=>{e.columnModule="cfgEffectivty",t.push(e)})),i.cfgEffectivty=n}e()})),r.name="Add "+n.getName()}))}));n.push(r);var a=new Promise((function(e){require(["DS/CfgWebAppEffectivityUX/scripts/CfgConfigurationRevisionColumn"],(function(n){n.isAdditionalColumnsAvailable((function(o){if(!0===o){let e=[];n.getAdditionalColumnsUXDGV(e),e.forEach((e=>{e.columnModule="ConfigurationRevision",t.push(e)})),i.ConfigurationRevision=n}e()})),a.name="Add "+n.getName()}))}));return n.push(a),Promise.all(n).then((function(){t.length>0&&(e.gridview._additionalColumns?e.gridview._additionalColumns.push(...t):e.gridview._additionalColumns=t),Object.keys(i).length>0&&(e.gridview.additionalColumnsModules=i)}))}}})),define("DS/CATFLCockpitWidget/services/config.service",["DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/CATFLCockpitWidget/services/dimensions.service","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/maturity.util","DS/ClassificationUtil/ClassificationUtil","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.additionalcolumns","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s){"use strict";var l={PRIVATE:"Private",IN_WORK:"In Work",FROZEN:"Frozen",RELEASED:"Released",OBSOLETE:"Obsolete",Private:"Private",InWork:"In Work",Frozen:"Frozen",Release:"Release",Obsolete:"Obsolete"};let c=["VPLM_SMB_Definition_MajorRev","Requirement"];return{extendConfiguration:function(e){var i=this;return Promise.all([i._getSubTypesMetaData(e),i._getBasicAttributesProperties(e),i._getAdditionalAttributesRangeValues(e),i._getLatestClassificationRanges(e),i._getNlsMaturityValues(e),i._getConfiguredAdminStatus(e),i._getConfigurationSettings(e),a._getAdditionalColumns(e),t.getAllDimensions(e),i._getPolicyStateInformation(e)]).then((function(){o.createCSSMaturityClasses(e.MAPPING_MATURITY_COLOR,"wux-controls-label")}))},_getNlsMaturityValues:function(t){return new Promise((function(i){e.getNlsOfPropertiesValues(JSON.stringify({"ds6w:status":["PRIVATE","IN_WORK","FROZEN","RELEASED","OBSOLETE","Private","InWork","Frozen","Release","Obsolete"]}),{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(e){var n=e["ds6w:status"];for(var o in t.MAPPING_MATURITY={},n)Object.hasOwnProperty.call(n,o)&&(t.MAPPING_MATURITY[o]=n[o]);i()},onFailure:function(){t.MAPPING_MATURITY=l,i()}})}))},getNLSOfKeyValues:function(t){return new Promise((function(i){e.getNlsOfPropertiesValues(JSON.stringify(t),{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(e){e&&i(e)},onFailure:function(){console.warn("FedDictionaryAccessAPI.getNlsOfPropertiesValues failed for"+t),i()}})}))},_getBasicAttributesProperties:function(t){let i=[];return[{predicatesList:t.identifiers.index_services.select_bo,configNlsKey:"nlsBasicAttributesBO"},{predicatesList:t.identifiers.index_services.select_rel,configNlsKey:"nlsBasicAttributesRel"}].forEach((function(n){i.push(new Promise((function(i,o){e.getResourcesInfo(n.predicatesList.join(","),{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(e){t[n.configNlsKey]={};for(let i=0;i<e.length;i++)t[n.configNlsKey][e[i].curi]=e[i].label;i()},onFailure:function(){o()}})})))})),Promise.all(i)},_getLatestClassificationRanges:function(){let e={};return(n.getUserCustomAttributes()||[]).forEach((function(t){t.isClassification&&(e[t.curi]=t)})),0===Object.keys(e).length?Promise.resolve():r.classificationAttributesPromise({apiVersion:"R2019x",lang:widget.lang||"en"}).then((function(t){t&&t[0].properties.forEach((function(t){e[t.curi]&&(e[t.curi].rangeValues=t.rangeValues)}))}))},_getAdditionalAttributesRangeValues:function(){var t=n.getUserCustomAttributes()||[],i=n.getUserCustomAttributes(!0)||[],o=t.concat(i),r={},a={};return o.forEach((function(e){if(void 0===e.rangeValues||e.isClassification||"date"===e.type){if(void 0!==e.rangeValues&&"date"===e.type)for(var t=0;t<e.rangeValues.length;t++)e.rangeValues[t].formatDateValue=n.displayDate(e.rangeValues[t].value)}else{r[e.curi]=[],a[e.curi]={};for(var i=0;i<e.rangeValues.length;i++)r[e.curi].push(e.rangeValues[i].value),a[e.curi][e.rangeValues[i].value]=e.rangeValues[i]}})),new Promise((function(t){e.getNlsOfPropertiesValues(JSON.stringify(r),{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(e){o.forEach((function(t){if(void 0!==e[t.curi])for(var i in e[t.curi])Object.hasOwnProperty.call(e[t.curi],i)&&(a[t.curi][i].nlsValue=e[t.curi][i])})),t()},onFailure:function(){t()}})}))},_getSubTypesMetaData:function(e){return e.logicalRefSubTypes=[],i.post(e.webservices.dsfl_getSubTypesMetaData,JSON.stringify([e.identifiers.type_act_logref]),0).then((function(t){e.logicalRefSubTypes=JSON.parse(t).Types,e.logicalRefSubTypes.forEach((function(t){void 0===e.mappingType[t.Name]&&(e.mappingType[t.Name]={nlsName:t.NLS,icon:t.IconName,custo:"True"===t.Custo})})),e.mappingType.iconsPath=JSON.parse(t).iconsPath,e.mappingType.iconsCommonImagePath=JSON.parse(t).iconsCommonImagePath})).catch((function(e){var t=e.error.message.slice(e.error.message.indexOf("ResponseCode")),i=s.error_get_subtypes;t&&t.indexOf("404")>=0&&(i=s.error_get_subtypes_media),n.displayError(e,null,null,i)}))},_getConfiguredAdminStatus:function(e){let t=e.webservices.getReadOnlyAdminSettings;return e.adminStatus={},i.post(t,JSON.stringify({})).then((function(t){for(var i in t=JSON.parse(t))"status"!==i&&(e.adminStatus[i]=t[i])})).catch((function(){}))},_getConfigurationSettings:function(e){let t=e.webservices.getConfigurationSettings;return i.post(t,JSON.stringify({version:"1.0",settings:["xRevisionActivation"]})).then((function(t){let i="enabled"===(t=JSON.parse(t)).settings[0].value;e.xRevision=i})).catch((function(){}))},_getPolicyStateInformation:function(e){return e.MAPPING_MATURITY_COLOR={},i.post(e.webservices.getStatesAttributes,JSON.stringify({policies:c})).then((function(t){JSON.parse(t).policies.forEach((function(t,i){t.states.forEach((function(t,i){e.MAPPING_MATURITY_COLOR[t.stateSysName]={inactiveColor:t.inactiveColor,activeColor:t.activeColor}}))}))}))}}})),define("DS/CATFLCockpitWidget/parser/database.parser",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/services/config.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n){"use strict";var o=t.getFullConfig(),r={attributes:function(t){let i=[],n={};if(n=e.createMapSelectableForAdditionalAttr(),t){if(!Array.isArray(t)&&("string"==typeof t||"object"==typeof t&&!t.member))return t;(t=t.member||t).forEach((function(t){let o,r={};for(o in t)if("id"===o)r.physicalid=t[o];else if("title"===o)r.label=t[o];else if("revision"===o)r.revision=t[o];else if("isLastVersion"===o)r.isLastVersion="TRUE"===t[o];else if("state"===o)r.maturity=r.status=t[o];else if("stateDB"===o)r.current=t[o];else if("owner"===o)r.owner=t[o];else if("ds6w:reserved"===o)r.isReserved=t[o];else if("created"===o)r.creationDate=e.formatDate(t[o]);else if("modified"===o)r.modificationDate=e.formatDate(t[o]);else if("description"===o)r.description=t[o];else if("type"===o)r.type=t.typeNLS||t[o],r.actualType=t.typeDB||t[o];else if("type_icon_url"===o)r.icons={iconPath:t[o],iconSize:{height:"16px",width:"16px"}};else if("name"===o)r.name=t[o];else if("architectureNumber"===o)r.architectureNumber=t[o];else{var a=n[o.toLowerCase()];if(a){if(a.multiValuated){var s=[];t[o]&&(s=t[o].split(/\u0007/)),r[a.curi]=s}else r[a.curi]=t[o]||"";a.manipulationUnit&&(r[a.curi+"_actual"]=r[a.curi],r[a.curi]=""),e.getNLSValueFromRangeValuesAttribute(a,a.curi,r)}else r[o]=t[o]}i.push(r)}))}return i},parseDocumentAttributes:function(t){let i=[];return t&&t.documents&&(t=t.documents).forEach((function(t){let n={};for(let i in t)if("id"===i)n.physicalid=t[i];else if("type"===i)n.type=t.typeNLS||t[i],n.actualType=t.typeDB||t[i];else if("dataelements"===i){let o=t[i];for(let t in o)"title"===t?n.label=o[t]:"revision"===t?n.revision=o[t]:"isLatestRevision"===t?n.isLastVersion="TRUE"===o[t]:"stateNLS"===t?(n.status=o[t],n.maturity=o[t]):"state"===t?n.current=o[t]:"originated"===t?n.creationDate=e.formatDate(o[t]):"modified"===t?n.modificationDate=e.formatDate(o[t]):"description"===t?n.description=o[t]:"name"===t?n.name=o[t]:"collabspace"===t?n.collabspace=o[t]:"comments"===t&&(n.comments=o[t])}else if("relateddata"===i){let e=t[i],o=e?.ownerInfo[0]?.dataelements?.firstname,r=e?.ownerInfo[0]?.dataelements?.lastname;n.owner=o.concat(" "+r)}else n[i]=t[i];i.push(n)})),i},parseDBSpaceData:function(e){let t=[];return e.forEach((function(e){let i={physicalid:e.objPhysicalId,label:e.objLabel,revision:e.objRevision,type:e.objType,connectionId:e.ownerPhysicalId,connectionType:e.ownerType};t.push(i)})),t},defaultInstanceParser:function(i,o){var r,a={};let s={};r=e.createMapSelectableForAdditionalAttr(),i.forEach((function(i){var o={grid:{}};if(i.attributes&&i.attributes.length){for(var l=0;l<i.attributes.length;l++){var c=i.attributes[l].name,d=i.attributes[l].value;if("PLMInstance.PLM_ExternalID"===c)o.grid.instanceName=d;else if("PLMInstance.V_description"===c)o.grid.instance_description=d;else if("reserved"===c)o.grid.instance_isReserved=d;else if("reserved_NLS"===c)o.grid.instance_reservedBy=d||"";else if("modified"===c)o.instance={modificationDate:e.formatDate(d)};else{var u=r[c.toLowerCase()];if(u&&!u.bo){var p=u.multiValuated||u.isSharedPredicateOnSameType||u.isSharedPredicate&&(u.isClassification||u.isOnExtension);if(void 0!==o.grid["instance_"+u.curi]||void 0!==o.grid["instance_"+u.curi+"_actual"]){var g="instance_"+u.curi;if(u.manipulationUnit&&(g="instance_"+u.curi+"_actual",o.grid["instance_"+u.curi]=[]),Array.isArray(o.grid[g])||(o.grid[g]=o.grid[g]?[o.grid[g]]:[]),d)if(p){let e=[];d&&(e=d.split(/\u0007/)),o.grid[g]=o.grid[g].concat(e)}else o.grid[g].push(d)}else{if(p){let e=[];d&&(e=d.split(/\u0007/)),o.grid["instance_"+u.curi]=e}else o.grid["instance_"+u.curi]=d||"";u.manipulationUnit&&(o.grid["instance_"+u.curi+"_actual"]=o.grid["instance_"+u.curi],u.multiValuated?o.grid["instance_"+u.curi]=[]:o.grid["instance_"+u.curi]="")}e.getNLSValueFromRangeValuesAttribute(u,"instance_"+u.curi,o.grid,o)}}}let a=t.getUser("isTrigram"),s=t.getUser("isFullName");if(o.grid.instance_isReservedByOther=!1,"FALSE"===o.grid.instance_isReserved)o.instance_isReserved=o.grid.instance_isReserved,o.grid.instance_isReserved=n.notLocked;else if("TRUE"===o.grid.instance_isReserved){let e=o.grid.instance_reservedBy;o.instance_isReserved=o.grid.instance_isReserved,o.grid.instance_reservedBy===a||o.grid.instance_reservedBy===s?o.grid.instance_isReserved=n.lockedBy.replace("{user}",e):(o.grid.instance_isReserved=n.lockedBy.replace("{user}",e),o.grid.instance_isReservedByOther=!0)}}i.attributes=o,a[i.uuid]=i,s[i.physicalid]=i.uuid}));let l={};return o.forEach((function(e){l[e]={map:a,rootUuid:s[e]}})),l},defaultExpandParser:function(r,a){var s,l={};let c={},d=[],u={},p={},g={};s=e.createMapSelectableForAdditionalAttr(),r.forEach((function(i){var r={physicalid:i.physicalid,resourceid:i.physicalid,type:o.identifiers.type_act_logref,grid:{architectureNumber:"",kindOfRFLP:"L"}},a=o.mappingType[i.type];a&&a.nlsName?r.grid.type=a.nlsName:r.grid.type=i.type,a&&a.icon?r.icons=[t.getTypeIconUrl(i.type)]:r.icons=[t.getTypeIconUrl(o.identifiers.type_act_logref)],r.grid.actualType=i.type;let d={};if(i.attributes&&i.attributes.length){for(var f=0;f<i.attributes.length;f++){var m=i.attributes[f].name,h=i.attributes[f].value;if("PLMEntity.V_Name"===m||"Title"===m)r.label=h;else if("name"===m)r.grid.name=h;else if("PLMEntity.V_description"===m)r.grid.description=h||"";else if("revision"===m)r.grid.revision=h;else if("current"===m)r.maturity=h;else if("current_NLS"===m)r.grid.maturity=h;else if("owner"===m)r.owner=h;else if("owner_NLS"===m)r.grid.owner=h;else if("originated"===m)r.grid.creationDate=e.formatDate(h);else if("modified"===m)r.grid.modificationDate=e.formatDate(h);else if("reserved"===m)r.grid.isReserved=h;else if("reserved_NLS"===m)r.grid.reservedBy=h||"";else if("PLMReference.V_isLastVersion"===m)r.grid.isLastVersion="TRUE"===h;else if("ArchitectureExtension.V_ArchitectureNumber"===m)r.grid.architectureNumber=h;else if("policy_NLS"===m||"organization_NLS"===m)d[m]=h;else if("organization"===m)r.grid.organization=h,r.grid["ds6w:organizationResponsible"]=h;else if("project"===m)u["ds6w:project"]||(u["ds6w:project"]=[]),u["ds6w:project"].indexOf(h)<0&&u["ds6w:project"].push(h),p[r.resourceid]||(p[r.resourceid]={}),p[r.resourceid]["ds6w:project"]=h,r.grid.project=h;else{var v=s[m.toLowerCase()];if(v){var C=v.multiValuated||v.isSharedPredicateOnSameType||v.isSharedPredicate&&(v.isClassification||v.isOnExtension);if(void 0!==r.grid[v.curi]||void 0!==r.grid[v.curi+"_actual"]){var y=v.curi;if(v.manipulationUnit&&(y=v.curi+"_actual",r.grid[v.curi]=[]),Array.isArray(r.grid[y])||(r.grid[y]=r.grid[y]?[r.grid[y]]:[]),h)if(C){let e=[];h&&(e=h.split(/\u0007/)),r.grid[y]=r.grid[y].concat(e)}else r.grid[y].push(h)}else{if(C){let e=[];h&&(e=h.split(/\u0007/)),r.grid[v.curi]=e}else r.grid[v.curi]=h||"";v.manipulationUnit&&(r.grid[v.curi+"_actual"]=r.grid[v.curi],v.multiValuated?r.grid[v.curi]=[]:r.grid[v.curi]="")}e.getNLSValueFromRangeValuesAttribute(v,v.curi,r.grid,r)}}}var b=t.getUser("isTrigram"),_=t.getUser("isFullName");if(r.grid.isReservedByOther=!1,r.type===o.identifiers.type_act_logref)if("FALSE"===r.grid.isReserved)r.isReserved=r.grid.isReserved,r.grid.isReserved=n.notLocked;else if(r.grid.reservedBy===b||r.grid.reservedBy===_){r.isReserved=r.grid.isReserved;let e=r.grid.reservedBy;r.grid.isReserved=n.lockedBy.replace("{user}",e)}else{r.isReserved=r.grid.isReserved;let e=r.grid.reservedBy;r.grid.isReserved=n.lockedBy.replace("{user}",e),r.grid.isReservedByOther=!0}}r.grid.owner||(r.grid.owner=r.owner),r.grid.maturity||(r.grid.maturity=r.maturity),r.grid["ds6w:organizationResponsible"]&&d.organization_NLS&&(r.grid["ds6w:organizationResponsible"]=d.organization_NLS),r.grid["ds6w:policy"]&&d.policy_NLS&&(r.grid["ds6w:policy"]=d.policy_NLS),r.grid["ds6w:project"]&&(r.grid["ds6w:project"]=u),g[r.resourceid]={attributes:r.grid},i.attributes=r,l[i.uuid]=i,c[i.physicalid]=i.uuid}));var f=function(e){for(let t of Object.keys(p)){if(!g[t])continue;let i=g[t].attributes,n=p[t];for(let t in n)if(Object.hasOwnProperty.call(n,t)){let o=e[t][n[t]];if(!o)continue;i[t]=o}}};let m;o.nlsAdditionalAttributes=o.nlsAdditionalAttributes?o.nlsAdditionalAttributes:{};for(let e in u)if(Object.hasOwnProperty.call(o.nlsAdditionalAttributes,e)){u[e]=Array.isArray(u[e])?u[e]:[];for(let t=0;t<=u[e].length-1;t++){let i=u[e][t];Object.keys(o.nlsAdditionalAttributes[e]).includes(i)||(m=!0)}}else m=!0;m?d.push(i.getNLSOfKeyValues(u).then((function(e){for(let t in e)o.nlsAdditionalAttributes[t]=e[t];f(e)}))):f(o.nlsAdditionalAttributes);let h={};return a.forEach((function(e){h[e]={map:l,rootUuid:c[e]}})),Promise.all(d).then((function(){return h}))},parseItemToConfigCtx:function(e){let t={};return e&&e.length>0&&e.forEach((function(e){let i=e.contextOf,n=e.content&&e.content.results&&e.content.results.length>0?e.content.results[0]:null;if(n&&i.length>0){let o={},r=n.basicData;for(let e=r.length-1;e>=0;e--){let t=r[e];if("name"===t.name){o.backEndName=t.value[0];break}}o.name=n.data[0].value[0],o.physicalid=e.modelPID;for(let e=0;e<i.length;e++){let n,r=i[e],a={};t[r]?(n=t[r].displayValue,a=t[r].contexts,a[o.physicalid]||(n+=","+o.name,a[o.physicalid]=o)):(n=o.name,a[o.physicalid]=o),t[r]={displayValue:n,contexts:a}}}})),t},classificationParser:function(t){var i={};let n=e.createMapSelectableForAdditionalAttr()||{};return t.forEach((e=>{e.Attributes&&e.Attributes.length>0&&e.Attributes.forEach((e=>{var t=n[e.name.toLowerCase()]?n[e.name.toLowerCase()].curi:void 0;t&&(void 0!==i[t]?(Array.isArray(i[t])||(i[t]=i[t]||!1===i[t]?[i[t]]:[]),Array.isArray(e.value)?i[t].concat(e.value):(e.value||!1===e.value)&&i[t].push(e.value)):i[t]=e.value)}))})),i}};return r})),define("DS/CATFLCockpitWidget/services/modeler.service",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/pno.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/services/dimensions.service","DS/CATFLCockpitWidget/parser/database.parser","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s){"use strict";var l=t.getFullConfig();var c={expand:function(t){var i=l.webservices.dsfl_getLogItem+"structure?addNLSValues=true",o=t.depth?t.depth:"0",r=a.defaultExpandParser,c=t.parser?t.parser:r,d={physicalids:t.itemIDs,depthLevel:o,filterExpression:t.configFilter};return n.post(i,JSON.stringify(d),0).then((function(e){return c(JSON.parse(e).rootObjects,t.itemIDs)})).catch((function(t){var i=t.error.message.slice(t.error.message.indexOf("ResponseCode")),n=s.error_get_structure;i&&i.indexOf("404")>=0&&(n=s.error_get_structure_media),e.displayError(t,null,null,n)}))},getAttributes:function(t){var i=l.webservices.dsfl_getLogItem+t.itemID+"/attributes?addNLSValues=true",o=t.parser?t.parser:a.defaultExpandParser;return n.get(i).then((function(e){return o(JSON.parse(e).rootObjects,[t.itemID]).then((function(e){if(e&&e[t.itemID]){var i=e[t.itemID];return i.map[i.rootUuid]}}))})).catch((function(t){var i=t.error.message.slice(t.error.message.indexOf("ResponseCode")),n=s.error_get_logitem;i&&i.indexOf("404")>=0&&(n=s.error_get_logitem_media),e.displayError(t,null,null,n)}))},getInstanceAttributes:function(t){var i=l.webservices.dsfl_getLogItem+t.parentID+"/dslog:LogInstance/"+t.instID+"/attributes",o=t.parser?t.parser:a.defaultInstanceParser;return n.get(i).then((function(e){let i=o(JSON.parse(e).rootObjects,[t.instID]);if(i&&i[t.instID]){var n=i[t.instID];return n.map[n.rootUuid]}})).catch((function(t){var i=t.error.message.slice(t.error.message.indexOf("ResponseCode")),n=s.error_get_logitem;i&&i.indexOf("404")>=0&&(n=s.error_get_logitem_media),e.displayError(t,null,null,n)}))},getObjectAttributes:function(t,i){var o=l.webservices.dsfl_getObjectAttributes;return n.post(o,JSON.stringify({physicalids:t}),0).then((function(e){if(i){var n=a.defaultInstanceParser(JSON.parse(e).rootObjects,t);for(var o in n)n.hasOwnProperty(o)&&(n[o]=n[o].map[n[o].rootUuid]);return n}return a.defaultExpandParser(JSON.parse(e).rootObjects,t).then((function(e){for(var t in e)e.hasOwnProperty(t)&&(e[t]=e[t].map[e[t].rootUuid]);return e}))})).catch((function(t){e.displayError(t,null,null,s.error_get_logitem)}))},defaultCRSParser:function(t){return{physicalid:t.id,label:t.title,type:t.type,grid:{kindOfRFLP:t.kindOfRFLP,revision:t.revision,description:t.description,name:t.name,type:t.typeNLS||t.type,actualType:t.type,creationDate:e.formatDate(t.created),modificationDate:e.formatDate(t.modified),maturity:t.state,current:t.stateDB,owner:t.owner,architectureNumber:t.architectureNumber}}},refreshTreeNodeModel:function(i,n,o){let r,a=this,s={},d=[];o&&(r=o.getGroupingOptions());let u=e.getUserCustomAttributes();u&&u.forEach((function(e){e.manipulationUnit&&e.manipulationUnit!==l.dimensions[e.dimension].MKSUnit?s[e.curi]=e:e.manipulationUnit&&d.push(e.curi)}));let p=[];return c.getObjectAttributes(Object.keys(i)).then((function(e){for(var c in e)if(e.hasOwnProperty(c)){let o=e[c],r=i[c];n&&t.SAXStorage().setItem(l.localStorageKeys.recentlyAuthored+c,Date.now()),o.attributes&&o.attributes.grid&&("#DENIED!"===o.attributes.grid.owner?r.forEach((function(e){e.getParent().removeChild(e)})):p.push(a._convertValuesAndUpdateNodes(r,o,s,d)))}return Promise.all(p).then((()=>{r&&o.groupRows(r)}))}))},refreshInstanceNodeModel:function(i,n){let r=this,a={},s=[],d=e.getUserCustomAttributes();return d&&d.forEach((function(e){e.bo||(e.manipulationUnit&&e.manipulationUnit!==l.dimensions[e.dimension].MKSUnit?a[e.curi]=e:e.manipulationUnit&&s.push(e.curi))})),c.getObjectAttributes(Object.keys(i),!0).then((function(e){for(var c in e)if(e.hasOwnProperty(c)){var d=e[c],u=i[c];let p=u[0].getParent();widget.getValue("groupingEnabled")&&!p.getID&&(p=o.getGroupNodeParent(p));let g=p.options.physicalid;n&&t.SAXStorage().setItem(l.localStorageKeys.recentlyAuthoredStructure+g,Date.now()),d.attributes&&d.attributes.grid&&r._convertValuesAndUpdateNodes(u,d,a,s)}}))},_convertValuesAndUpdateNodes:function(e,t,i,n){let o=[],a=[];for(let e in i)if(i.hasOwnProperty(e)){let n=i[e];if(n.bo||(e="instance_"+e),(""===t.attributes.grid[e]||t.attributes.grid[e]&&0===t.attributes.grid[e].length)&&t.attributes.grid[e+"_actual"]){let i;n.multiValuated||Array.isArray(t.attributes.grid[e+"_actual"])?(i=t.attributes.grid[e+"_actual"],0===i.length?(i=0,i=[i.toString()]):i.map((e=>e.toString()))):(i=+t.attributes.grid[e+"_actual"]||0,i=[i.toString()]),o.push({UnitFrom:l.dimensions[n.dimension].MKSUnit,UnitTo:n.manipulationUnit,Dimension:n.dimension,Values:i}),a.push(e)}}return n.forEach((function(e){let i=t.attributes.grid[e+"_actual"];i&&(t.attributes.grid[e]=i)})),o.length>0?r.convertValues(o).then((function(i){i.Response&&(a.forEach((function(e,n){i.Response[n].ConvertedValues&&(t.attributes.grid[e]=UWA.is(i.Response[n].ConvertedValues,"string")?i.Response[n].ConvertedValues.split(";")[0]:i.Response[n].ConvertedValues)})),e.forEach((function(e){e.updateOptions(t.attributes)})))})):(e.forEach((function(e){e.updateOptions(t.attributes)})),Promise.resolve())},navigate:function(t){let i=l.webservices.getItems+l.webservices.keyFieldForService;t.fields&&(i+=t.fields.join());let o=t.payload;return n.post(i,JSON.stringify(o),0).then((function(e){e=e&&UWA.is(e,"string")?JSON.parse(e):e;let t={};if(e.member&&e.member.length>0){e.member.forEach((function(e,i){let n,r={};e.outputs;for(n in e)r[n]=a.attributes(e[n]);t[o[i]]=r}))}return t}),(function(t){e.displayError(t,null,null,s.msg_generic_error_get_failed)}))},getObjectClassificationAttributes:function(e){var t=l.webservices.getClassificationAttributes+e+l.webservices.classificationAttributesMask;return n.get(t).then((function(e){return e&&(e=JSON.parse(e)).member[0]&&e.member[0].ClassificationAttributes&&e.member[0].ClassificationAttributes.member&&e.member[0].ClassificationAttributes.member.length>0?a.classificationParser(e.member[0].ClassificationAttributes.member):{}}))}};return c})),define("DS/CATFLCockpitWidget/services/document.service",["DS/DocumentManagement/DocumentManagement","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/parser/database.parser","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r){"use strict";var a=JSON.parse(o);return{getDocument:function(i,n){return new Promise((function(o,r){e.getDocumentsFromParent({getVersions:!0,relInfo:{parentDirection:"from",parentId:i,parentRelName:n?a.rel_specification:a.rel_document},securityContext:t.getSecurityContext(),tenant:t.getTenant(),tenantUrl:t.getServiceURL("3DSpace"),onFailure:function(e){r(e)},onComplete:function(e){o(e)}})}))},createDocument:function(e,o,a,s){require(["DS/DocumentCreateNew/CreateNew"],(function(l){new l({tenantUrl:t.getServiceURL("3DSpace"),securityContext:a,tenant:t.getTenant(),immersiveFrame:widget.immersiveFrame,parentId:e,parentRelName:o,getWorkUnderHeaders:function(){return t.getAuthorizedWorkUnder()},onUploadStart:function(){},onCancel:function(){},onError:function(e){let t={errorResp:{message:e?.message}};i.displayError(t,r.error_creation,null,r.replace(r.error_no_access,{errorOp:r.action_insert_new+" "+r.label_document}))},onDocumentUpload:function(e){let t=n.parseDocumentAttributes(e);s(t)}}).selectFilesAndCreate()}))},downloadDocument:function(i){var n=this;return new Promise((function(o,r){var a={tenant:t.getTenant(),securityContext:t.getSecurityContext(),tenantUrl:t.getServiceURL("3DSpace"),onFailure:r,onComplete:function(e){n.launchDownloadfromURLs(e),o()}};e.downloadDocuments(i,a)}))},launchDownloadfromURLs:function(e){var t=this;e.reduce((function(e,i){return new Promise((function(n){e.then((function(){t._downloadFromFCS(i.downloadUrl),setTimeout((function(){n()}),106)}))}))}),new Promise((function(e){e()})))},_downloadFromFCS:function(e){var t=document.createElement("div");t.style.display="none",e+="&__fcs__attachment=true",t.innerHTML='<a href="'+e+'" download></a>';var i=t.querySelector("a");document.body.appendChild(t),setTimeout((function(){i.click(),document.body.removeChild(t)}),66)},removeDocument:function(i,n,o){return new Promise((function(r,s){var l={relInfo:{parentId:i,parentRelName:o?a.rel_specification:a.rel_document,parentDirection:"from"},tenant:t.getTenant(),securityContext:t.getSecurityContext(),tenantUrl:t.getServiceURL("3DSpace"),onComplete:r,onFailure:s},c=t.getAuthorizedWorkUnder();c&&(l.additionalHeaders=c),e.disconnectDocumentFromParent(n,l)}))},attachDocument:function(i,n,o,r){return new Promise((function(a,s){var l={relInfo:{parentId:i,parentRelName:o,parentDirection:"from"},tenant:t.getTenant(),securityContext:r,tenantUrl:t.getServiceURL("3DSpace"),onComplete:a,onFailure:s},c=t.getAuthorizedWorkUnder();c&&(l.additionalHeaders=c),e.connectDocumentToParent(n,l)}))}}})),define("DS/CATFLCockpitWidget/parser/index.parser",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/services/config.service","text!DS/CATFLCockpitWidget/assets/config/mapping.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r){"use strict";var a=JSON.parse(o),s=t.getFullConfig(),l=s.identifiers,c={attributes:function(t){let i=this,n=[],o=e.getUserCustomAttributes(),r=[],l=[],c=[];return o&&o.forEach((function(e){e.manipulationUnit&&r.push(e.curi),e.multiValuated&&l.push(e.curi),(e.isSharedPredicateOnSameType||e.isSharedPredicate&&(e.isClassification||e.isOnExtension))&&c.push(e.curi)})),t&&t.forEach((function(t){let d,u,p={};for(d in t)if(u=a[d],"ds6w:label"===d)p.label=t[d];else if("ds6wg:revision"===d)p.revision=t[d];else if("ds6w:isLastRevision"===d)p[u]="TRUE"===t[d].toUpperCase();else if("ds6w:status"===d)p.status=t[d],p[u]=s.MAPPING_MATURITY[t[d].split(".")[1]]||t.current;else if("ds6w:responsible"===d)p.owner=t[d];else if("ds6w:reserved"===d)p.isReserved=t[d];else if("ds6w:created"===d||"ds6w:modified"===d)p[u]=e.formatDate(t[d]);else if("ds6w:description"===d)p.description=t[d];else if("ds6w:type"===d){let e=s.mappingType[t[d]];e&&e.nlsName&&(p[u]=e.nlsName),p.actualType=t[d]}else if("type_icon_url"===d)p.icons={iconPath:t[d],iconSize:{height:"16px",width:"16px"}};else if("ds6w:identifier"===d)p[u]=t[d];else if("ds6wg:architectureextension.v_architecturenumber"===d)p[u]=t[d];else if("taxonomies"===d){let e,n=t[d];if(Array.isArray(n))for(var g=0;g<n.length&&(e=i.getKindOfRFLPFromTaxonomy(n[g]),null===e);g++);else e=i.getKindOfRFLPFromTaxonomy(n);p.kindOfRFLP=e,p[d]=t[d]}else"ds6wg:EnterpriseExtension.V_PartNumber"===d?p["physical_"+d]=t[d]:((l.indexOf(d)>=0||c.indexOf(d)>=0)&&!Array.isArray(t[d])&&(t[d]=t[d]?[t[d]]:[]),r.indexOf(d)>=0?(p[d+"_actual"]=t[d],p[d]=""):p[d]=t[d]);o&&o.forEach((function(t){e.getNLSValueFromRangeValuesAttribute(t,t.curi,p)})),n.push(p)})),n},parseDataToNodeFormat:function(e){let t=e.data,i=[];return t.forEach((function(t){let n={physicalid:t.physicalid,label:t.label,type:t.actualType||t.type,icons:[t.icons],children:void 0};e.virtual&&(n.virtual=e.virtual);n.grid=JSON.parse(JSON.stringify(t)),n.grid.isReserved="",n.isReserved="",i.push(n)})),i},getKindOfRFLPFromTaxonomy:function(e){return e.indexOf(l.type_usecase)>=0||e.indexOf(l.type_requirement)>=0||e.indexOf(l.type_reqSpec)>=0||e.indexOf(l.type_reqGroup)>=0?"R":e.indexOf(l.type_act_functref)>=0?"F":e.indexOf(l.type_act_logref)>=0?"L":e.indexOf(l.type_act_physical)>=0?"P":null},progressiveExpandParser:function(t){let i=this;if(!t.results)return null;let o={},r={},a=[],c=[];if(t){let u,p=t.results||[],g=e.getUserCustomAttributes(),f=[],m=[],h=[],v={},C={};g&&g.forEach((function(e){e.manipulationUnit&&f.push(e.curi),e.multiValuated&&m.push(e.curi),(e.isSharedPredicateOnSameType||e.isSharedPredicate&&(e.isClassification||e.isOnExtension))&&h.push(e.curi)}));for(let e=0;e<p.length;e++){let t,n=p[e];n.taxonomies?(-1!==n.taxonomies.indexOf(l.type_act_logref)?t=i.parseProgressiveExpandItemAttr(n,f,m,h,v,C):-1!==n.taxonomies.indexOf(l.type_act_loginstance)&&(t=i.parseProgressiveExpandInstAttr(n,f,m,h,v,C)),t&&(r[t.resourceid]={attributes:t})):n.Path&&a.push(n.Path)}s.nlsAdditionalAttributes=s.nlsAdditionalAttributes?s.nlsAdditionalAttributes:{};var d=function(e){for(let t of Object.keys(C)){if(!r[t])continue;let i=r[t].attributes,n=C[t];for(let t in n)if(n.hasOwnProperty(t)){let o=e[t][n[t]];if(!o)continue;i.grid[t]=o}}};for(let e in v)if(s.nlsAdditionalAttributes.hasOwnProperty(e)){v[e]=Array.isArray(v[e])?v[e]:[];for(let t=0;t<=v[e].length-1;t++){let i=v[e][t];Object.keys(s.nlsAdditionalAttributes[e]).includes(i)||(u=!0)}}else u=!0;u?c.push(n.getNLSOfKeyValues(v).then((function(e){for(let t in e)s.nlsAdditionalAttributes[t]=e[t];d(e)}))):d(s.nlsAdditionalAttributes),o.map=r,o.paths=a}return Promise.all(c).then((function(){return o}))},parseProgressiveExpandItemAttr:function(i,n,o,c,d,u){if(i){let f=t.getUser("isTrigram"),m=t.getUser("isFullName"),h={grid:{}};for(let r in i){let f=a[r];if("taxonomies"===r)h.type=l.type_act_logref,h.grid.kindOfRFLP="L",h.grid[r]=i[r];else if("physicalid"===r||"logicalid"===r||"majorid"===r||"resourceid"===r)h[r]=i[r],h.grid[r]=i[r];else if("ds6w:label"===r)h.label=i[r];else if("ds6w:type"===r){var p=s.mappingType[i[r]];p?(h.grid[f]=p.nlsName,h.icons=p.icon?[t.getTypeIconUrl(i[r])]:[t.getTypeIconUrl(l.type_act_logref)]):(h.grid[f]=i[r],h.icons=[t.getTypeIconUrl(l.type_act_logref)]),h.grid.actualType=i[r]}else if("ds6w:status"===r)h[f]=i[r],h.grid[f]=s.MAPPING_MATURITY[i[r].split(".")[1]];else if("ds6w:created"===r||"ds6w:modified"===r)h.grid[f]=e.formatDate(i[r]);else if("ds6w:isLastRevision"===r)h.grid[f]="TRUE"===i[r].toUpperCase();else if("ds6w:reserved"===r)h.grid.isReserved=i[r];else if("ds6w:reservedBy"===r)h.grid.reservedBy=i[r]?i[r]:"";else if("ro.plminstance.v_effectivitycompiledform"===r)h[f]=i[r];else{var g=f||r;if(o.indexOf(g)>=0||c.indexOf(g)>=0)n.indexOf(g)>=0?(h.grid[g+"_actual"]=[],i[r]&&(h.grid[g+"_actual"]=i[r].split(","))):h.grid[g]=i[r].split(",");else if(n.indexOf(g)>=0)h.grid[g+"_actual"]=i[r],h.grid[g]="";else if("ds6w:organizationResponsible"===g){let e=i[g];d[g]||(d[g]=[]),d[g].indexOf(e)<0&&d[g].push(e),u[h.resourceid]||(u[h.resourceid]={}),u[h.resourceid][g]=e,h.grid[g]=i[r],h.grid.organization=i[r]}else if("ds6w:project"===g){let e=i[g];d[g]||(d[g]=[]),d[g].indexOf(e)<0&&d[g].push(e),u[h.resourceid]||(u[h.resourceid]={}),u[h.resourceid][g]=e,h.grid[g]=i[r],h.grid.project=i[r]}else h.grid[g]=i[r]}}if(h.type===l.type_act_logref){if(h.grid.isReservedByOther=!1,"FALSE"===h.grid.isReserved)h.isReserved=h.grid.isReserved,h.grid.isReserved=r.notLocked;else if(h.grid.reservedBy===f||h.grid.reservedBy===m){h.isReserved=h.grid.isReserved;let e=h.grid.reservedBy;h.grid.isReserved=r.lockedBy.replace("{user}",e)}else{h.isReserved=h.grid.isReserved;let e=h.grid.reservedBy;h.grid.isReserved=r.lockedBy.replace("{user}",e),h.grid.isReservedByOther=!0}let t=e.getUserCustomAttributes();t&&t.forEach((function(t){t.bo&&(void 0===h.grid[t.curi]&&(o.indexOf(t.curi)>=0||c.indexOf(t.curi)>=0?h.grid[t.curi]=[]:h.grid[t.curi]=""),e.getNLSValueFromRangeValuesAttribute(t,t.curi,h.grid,h))})),h.grid.description=h.grid.description||"",h.grid.architectureNumber=h.grid.architectureNumber||""}return h.physicalid||(h.physicalid=h.resourceid),h}},parseProgressiveExpandInstAttr:function(i,n,o,c,d,u){if(i){let f={grid:{}};for(let e in i){let t=a[e];if("taxonomies"===e)f.type=l.type_act_loginstance;else if("physicalid"===e||"logicalid"===e||"majorid"===e||"resourceid"===e)f[e]=i[e],f.grid[e]=i[e];else if("from"===e||"to"===e)f[e]=i[e];else if("ds6w:label"===e)f.label=i[e];else if("ds6w:description"===e)f.description=i[e];else if("ds6w:reserved"===e)f.grid.isReserved=i[e];else if("ds6w:reservedBy"===e)f.grid.reservedBy=i[e]?i[e]:"";else if("ds6w:type"===e){var p=s.mappingType[i[e]];f.grid[t]=p?p.nlsName:i[e],f.grid.actualType=i[e]}else{var g=t||e;if(o.indexOf(g)>=0||c.indexOf(g)>=0)n.indexOf(g)>=0?(f.grid[g+"_actual"]=[],i[e]&&(f.grid[g+"_actual"]=i[e].split(","))):f.grid[g]=i[e].split(",");else if(n.indexOf(g)>=0)f.grid[g+"_actual"]=i[e],f.grid[g]="";else if("ds6w:organizationResponsible"===g){let t=i[g];d[g]||(d[g]=[]),d[g].indexOf(t)<0&&d[g].push(t),u[f.resourceid]||(u[f.resourceid]={}),u[f.resourceid][g]=t,f.grid[g]=i[e]}else if("ds6w:project"===g){let t=i[g];d[g]||(d[g]=[]),d[g].indexOf(t)<0&&d[g].push(t),u[f.resourceid]||(u[f.resourceid]={}),u[f.resourceid][g]=t,f.grid[g]=i[e]}else f.grid[g]=i[e]}}let m=e.getUserCustomAttributes();m&&m.forEach((function(t){t.bo||(void 0===f.grid[t.curi]&&(o.indexOf(t.curi)>=0||c.indexOf(t.curi)>=0?f.grid[t.curi]=[]:f.grid[t.curi]=""),e.getNLSValueFromRangeValuesAttribute(t,t.curi,f.grid,f))})),f.description=f.description||"",f.physicalid||(f.physicalid=f.resourceid);let h=t.getUser("isTrigram"),v=t.getUser("isFullName");if(f.grid.isReservedByOther=!1,"FALSE"===f.grid.isReserved)f.isReserved=f.grid.isReserved,f.grid.isReserved=r.notLocked;else if(f.grid.reservedBy===h||f.grid.reservedBy===v){f.isReserved=f.grid.isReserved;let e=f.grid.reservedBy;f.grid.isReserved=r.lockedBy.replace("{user}",e)}else{f.isReserved=f.grid.isReserved;let e=f.grid.reservedBy;f.grid.isReserved=r.lockedBy.replace("{user}",e),f.grid.isReservedByOther=!0}return f}},mapAttributes:function(t){var i,n=[];return t&&t.forEach((function(t){var o=t.attributes;let r={};for(var l=0;l<o.length;l++){let t=o[l].name.split("/").pop();i=a[t],"ds6w:label"===t?r.label=o[l].value:"ds6wg:revision"===t?r.revision=o[l].value:"ds6w:status"===t?(r.status=o[l].value,r[i]=s.MAPPING_MATURITY[o[l].value.split(".")[1]]||o[l].value):"ds6w:identifier"===t?r.name=o[l].value:"ds6w:type"===t?(r.type=o[l].value,r.NLStype=o[l].dispValue):"preview_url"===t?r.icon=o[l].value:"ds6wg:architectureextension.v_architecturenumber"===t?r.architectureNumber=o[l].value:"ds6w:responsible"===t?r.owner=o[l].value:"ds6w:created"===t||"ds6w:modified"===t?r[i]=e.formatDate(o[l].value):r[t]=o[l].value}n.push(r)})),n}};return c})),define("DS/CATFLCockpitWidget/services/index.service",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/parser/index.parser","text!DS/CATFLCockpitWidget/assets/config/expandv2.conf.json"],(function(e,t,i,n,o){"use strict";var r=t.getFullConfig(),a=r.identifiers,s=r.localStorageKeys,l=JSON.parse(o),c={fetch:function(e,o,a){var s={physicalid:e,label:"CATFLCockpit-ExecuteFetch",select_predicate:o,tenant:t.getTenant()};return i.makeServiceCall(r.webservices.fetchService,"POST",JSON.stringify(s),!0,null,{timeout:0}).then((function(e){var t=JSON.parse(e).results,i=[];return a?i=n.mapAttributes(t):t.forEach((function(e){for(var t={},n=e.attributes,o=0;o<n.length;o++)if("type_icon_url"!==n[o].name&&"preview_url"!==n[o].name){var r=t[n[o].name];r?(r.value&&!Array.isArray(r.value)&&(r.value=[r.value]),n[o].value&&(r.value||(r.value=[]),r.value.push(n[o].value)),r.dispValue&&!Array.isArray(r.dispValue)&&(r.dispValue=[r.dispValue]),n[o].dispValue&&(r.dispValue||(r.dispValue=[]),r.dispValue.push(n[o].dispValue))):t[n[o].name]=n[o]}i.push(t)})),i}))},expandV2:function(e){var t=r.webservices.progressiveExpand;return"Flat"===e.synthType&&(l.withConfigFilter_FlatSynth_Json.batch.expands[0].label="SAX_FlatSynthWithCfg_"+Date.now(),l.withConfigFilter_FlatSynth_Json.batch.expands[0].root.physical_id=e.forSynthesis.IDs,e.forSynthesis.configFilter?(l.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.config_filter=e.forSynthesis.configFilter,l.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.all&&delete l.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.all):(l.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.all=1,l.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.config_filter&&delete l.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.config_filter)),i.makeServiceCall(t,"POST",JSON.stringify(l.withConfigFilter_FlatSynth_Json),!0,null,{timeout:0})},navigate:function(o){o.attributes=o.attributes.concat(e.getUserCustomAttributesCURI().bo);let a=r.webservices.navigateService+"?SecurityContext="+t.getSecurityContext();return i.makeServiceCall(a,"POST",JSON.stringify(o),!0,null,{timeout:0}).then((function(e){if((e=e&&UWA.is(e,"string")?JSON.parse(e):e)&&e.infos&&"OK"===e.infos.status){let t,i=e.result,o={};return i.forEach((function(e){let i={};i.input_object=n.attributes([e.input_object]);let r=e.outputs;for(t in r)r.hasOwnProperty(t)&&(i[t]=n.attributes(r[t]));o[e.input_object.physicalid]=i})),o}}))},progressiveExpand:function(o){let l=this;console.log("inside progressiveExpand");let c={},d=[],u=o.expandLevel,p=widget.getValue("component-view");u||(u=p===s.flattenedView?widget.getPreference(s.depthFlattenedView).value:p===s.flattenedViewOnlyArchitectureItem?widget.getPreference(s.depthFlattenedViewArchitectureItemOnly).value:1);for(let e in o.rootWithPaths)if(o.rootWithPaths.hasOwnProperty(e)){let t={label:"CATFLCockpit-ExecuteExpand-"+e,root:{physical_id:e}};o.filter?(t.filter=o.filter,o.aggregation_processors&&(t.aggregation_processors=o.aggregation_processors)):(t.filter=l.getFiterQueryForProgExp(e,o.rootWithPaths,o.configFilter),t.graph=l.getGraphQueryForProgExp([a.type_act_logref],[a.type_act_loginstance]),-1!==u&&(t.aggregation_processors=l.getAggProcForProgExp(e,o.rootWithPaths,u))),d.push(t)}c.expands=d;var g={},f=o.select_bo?o.select_bo:r.identifiers.index_services.select_bo.slice(),m=o.select_rel?o.select_rel:r.identifiers.index_services.select_rel.slice(),h=e.getUserCustomAttributesCURI();f=f.concat(h.bo,["ds6w:organizationResponsible","ds6w:project"]),m=m.concat(h.rel),g.select_object=f,g.select_relation=m,g.format="entity_relation_occurrence";let v={batch:c,outputs:g};var C=r.webservices.progressiveExpand+"?output_format=cvjson&SecurityContext="+t.getSecurityContext();return i.makeServiceCall(C,"POST",JSON.stringify(v),!0,null,{timeout:0}).then((e=>(e=UWA.is(e,"string")?JSON.parse(e):e,n.progressiveExpandParser(e))))},getFiterQueryForProgExp:function(e,t,i){let n=this,o=[];return t[e].length>0&&o.push(n.createOrFilterForPaths(t[e])),i&&o.push({config_filter:i}),o.push({and:{filters:[{sequence_filter:n.getSequenceFilter('(flattenedtaxonomies:"reltypes/RFLVPMLogicalInstance")')}]}}),{and:{filters:o}}},createOrFilterForPaths:function(e){let t=this,i=[];for(let n=0;n<e.length;n++)i.push(t.getPrefixFilter(e[n]));return{or:{filters:i}}},getPrefixFilter:function(e){return{prefix_filter:{prefix_path:[{physical_id_path:e}]}}},getSequenceFilter:function(e){return{sequence:[{uql:e}]}},getGraphQueryForProgExp:function(){let e={descending_condition_relation:{uql:'flattenedtaxonomies:"reltypes/RFLVPMLogicalInstance"'},descending_condition_object:{uql:'(flattenedtaxonomies:"types/RFLVPMLogicalReference")'}};return e},getAggProcForProgExp:function(e,t,i){let n=[],o=this.createOrFilterForPaths(t[e]);return o.max_distance_from_prefix=i.toString(),n.push({truncate:o}),n},getUserContent:function(){var e=t.getUser("isTrigram"),o={label:"CATFLCockpit-ExecuteFetch",nresults:40,order_by:"desc",order_field:"ds6w:modified",select_file:["icon","thumbnail_2d"],query:"[flattenedtaxonomies]:types/"+a.type_act_logref+" AND [owner]:"+e,select_predicate:r.identifiers.index_services.select_bo,start:"0",tenant:t.getTenant(),with_indexing_date:!0,with_nls:!0};let s={targetService:"3DSearch",authoringCtx:!1};return i.makeServiceCall("/search","POST",JSON.stringify(o),!0,null,s).then((function(e){var t=JSON.parse(e).results;return n.mapAttributes(t)}))},getRecentsContent:function(){var e={label:"CATFLCockpit-ExecuteFetch",nresults:40,order_by:"desc",order_field:"ds6w:modified",select_file:["icon","thumbnail_2d"],select_predicate:r.identifiers.index_services.select_bo,start:"0",tenant:t.getTenant(),with_indexing_date:!0,with_nls:!1};let o={targetService:"3DSearch",authoringCtx:!1};return i.makeServiceCall("/recent","POST",JSON.stringify(e),!0,null,o).then((function(e){var t=JSON.parse(e).results;return n.mapAttributes(t)}))}};return c})),define("DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument",["UWA/Core","DS/TreeModel/TreeDocument","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/utils/common.util","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json"],(function(e,t,i,n,o,r){"use strict";JSON.parse(r);return t.extend({isMain:!1,_activeNode:null,defaultOptions:{shouldAcceptDrop:function(e){return!0}},init:function(t){this.mappedNodesToIds={},t=e.extend(e.clone(this.defaultOptions),t),this._parent(t),t.isMain&&(this.isMain=t.isMain)},updateTags:function(){this.isMain&&this.getModelEvents().publish({event:"setPathTags",context:this})},onRootAdded:function(){this.isMain&&this.getModelEvents().publish({event:"onRootAdded",context:this})},setActiveNode:function(e){null!==this._activeNode&&(this._activeNode.setActive(!1),this._activeNode.setColor("rgba(0, 0, 0, 0)")),this._activeNode=e,this._activeNode.setActive(!0),this._activeNode.setColor("rgba(54,142,196, 0.8)")},getActiveNode:function(e){return this._activeNode},empty:function(){this.mappedNodesToIds={},this._getTrueRoot().empty(),this._numberOfNodesInDocument=0,this._parent()},getRealRoots:function(t){var i=[],n=this.getRoots(t);if(null!=n&&n.forEach((function(e){if(e.isVirtual()){var t=e.getChildren();t&&t.length>0&&(i=i.concat(t))}else i.push(e)})),Boolean(t)&&e.is(this._getChildrenFilterInfo,"function")){var o=this._getChildrenFilterInfo();if(o&&e.is(o.childrenBeforeFiltering,"array")){var r=i;i=o.childrenBeforeFiltering.slice(0),r.forEach((function(e){i.indexOf(e)<0&&i.push(e)}))}}return i},getRoots:function(t){var i=this._parent();if(Boolean(t)&&e.is(this._getChildrenFilterInfo,"function")){var n=this._getChildrenFilterInfo();if(n&&e.is(n.childrenBeforeFiltering,"array")){var o=i;i=n.childrenBeforeFiltering.slice(0),o.forEach((function(e){i.indexOf(e)<0&&i.push(e)}))}}return i},removeRoot:function(t,i,n){var o=this;o._doNotBroadcastSelect=!0;var r=o.hasOwnProperty("detachedRoots")?o.detachedRoots.indexOf(t):-1;if(r>=0)o.detachedRoots.splice(r,1);else{if(o.getRealRoots().indexOf(t)>=0)t.getParent().removeChild(t);if((!e.is(n,"boolean")||!n)&&e.is(o._getChildrenFilterInfo,"function")){var a=o._getChildrenFilterInfo();if(a&&e.is(a.childrenBeforeFiltering,"array")){var s=a.childrenBeforeFiltering.indexOf(t);s>=0&&a.childrenBeforeFiltering.splice(s,1)}if(a&&e.is(a.filteredOutChildren,"array")){var l=a.filteredOutChildren.indexOf(t);l>=0&&a.filteredOutChildren.splice(l,1)}}}if(o._doNotBroadcastSelect=!1,!e.is(i,"boolean")||!i){var c=this.getRealRoots().length;e.is(this.detachedRoots,"array")&&(c+=this.detachedRoots.length),this.getModelEvents().publish({event:"onRemoveRoot",data:{pid:t.getID(),remainingRoots:c}});var d=null;this.getRealRoots().length>0?d=this.getRealRoots()[0]:e.is(this.detachedRoots,"array")&&this.detachedRoots.length>0&&(d=this.detachedRoots[0]),this.getModelEvents().publish({event:"onRootAdded",data:{isremove:!0,added_node:d,nb_root:c}})}},getNodesByIDPath:function(e){function t(e,i,n,o){if(e.getID()===i[n])if(n===i.length-1)o.push(e);else{var r=e.getChildren();r&&r.length>0&&(n+=1,r.forEach((function(e){t(e,i,n,o)})))}}var i=[];return this.getRealRoots().forEach((function(n){t(n,e,0,i)})),i},getNodesById:function(e){var t=[];return this.getRoots().forEach((function(i){var n=i.getNodesById(e);t=t.concat(n)})),t},getMappedNodesFromId:function(e){return this.mappedNodesToIds&&this.mappedNodesToIds[e]?this.mappedNodesToIds[e]:this.getNodesById(e)},searchRootById:function(e){var t,i=this.getRoots(!0);this.hasOwnProperty("detachedRoots")&&(i=i.concat(this.detachedRoots));for(var n=0;n<i.length;n++)if(i[n].options.physicalid===e){t=i[n];break}return t},applyFilter:function(e,t,r){for(var a=this,s=[],l=o.checkIfRecentlyAuthored(e.filterRootIds[0],!0),c=0;c<e.filterRootIds.length;c++){var d=a.searchRootById(e.filterRootIds[c]);d&&(d.options.CVQuery=e.CVQuery,s.push(d))}if(e.empty){if(e.filterRootIds&&1===e.filterRootIds.length){var u=e.filterRootIds[0],p={},g=a.getConfigurationContext();if(g&&g.filterCompiledForm&&(p.configFilter=g.filterCompiledForm),l)p.itemIDs=[u],i.expand(p).then((function(e){e=e?e[s[0].options.physicalid]:{},a.onExpandComplete(s,t,r,l,e)}));else{let e={};e[u]=[[u]],n.progressiveExpand({rootWithPaths:e,configFilter:p.configFilter}).then(a.onExpandComplete.bind(a,s,t,r,l))}}}else if(e.CVQueryV2){let i={};i[u=e.filterRootIds[0]]=[[u]];let o=e.CVQueryV2.filter,c=e.CVQueryV2.aggregation_processors;e.CVQueryV2.batch&&e.CVQueryV2.batch.expands[0]&&(o||(o=e.CVQueryV2.batch.expands[0].filter),c||(c=e.CVQueryV2.batch.expands[0].aggregation_processors)),n.progressiveExpand({rootWithPaths:i,filter:o,aggregation_processors:c}).then(a.onExpandComplete.bind(a,s,t,r,l))}},onExpandComplete:function(e,t,i,n,o){var r=this;try{r.prepareUpdate();var a=!1;if(o&&o.map&&0!==Object.keys(o.map).length&&(n||o.paths&&0!==o.paths.length)||(a=!0),a)e.forEach((function(e){let t=e.getChildren();for(let i=t.length-1;i>=0;i--)t[i].getID()&&e.removeChild(t[i]);e.expand()})),t({response:null,recentlyAuthored:n});else o.srcFromNGFilter=!0,t({treedocument:r,root_nodes:e,response:o,expand_level:-1,selectPathLeaf:!1,recentlyAuthored:n})}catch(e){console.error("error in filtering",e)}finally{r.pushUpdate(),i&&i()}},setConfigurationContext:function(e){this._configurationContext={model:e.model,modelVersion:e.modelVer,pc:e.pc,filterCompiledForm:e.filterCompiledForm}},getConfigurationContext:function(){return this._configurationContext?this._configurationContext:null},addToMappedNodes:function(e){var t=this;t.mappedNodesToIds[e.options.physicalid]?t.mappedNodesToIds[e.options.physicalid].push(e):t.mappedNodesToIds[e.options.physicalid]=[e]},removeFromMappedNodes:function(e){var t=this;if(t.mappedNodesToIds[e.options.physicalid]){for(var i=t.mappedNodesToIds[e.options.physicalid],n=i.length-1;n>=0;n--){i[n]._id===e._id&&i.splice(n,1)}i.length<=0&&delete t.mappedNodesToIds[e.options.physicalid]}}})})),define("DS/CATFLCockpitWidget/utils/gridview.util",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/services/config.service","DS/CATFLCockpitWidget/parser/index.parser","DS/CATFLCockpitWidget/parser/database.parser","text!DS/CATFLCockpitWidget/assets/config/navigate.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f){"use strict";var m=o.getFullConfig(),h=m.identifiers,v=m.localStorageKeys,C=JSON.parse(g),y={createTreeDocumentFromIndexResponse:function(e,i,o,r){var a,s,c,d,u=this,p={},g=[];if(!e)return;var f=e.map,m=e.paths,C=!1,y={},b=widget.getValue(v.componentView),_=widget.getValue("ngFilter"),w=_&&_.length>0;let D;if(b===v.flattenedView?D=widget.getPreference(v.depthFlattenedView).value:b===v.flattenedViewOnlyArchitectureItem&&(D=widget.getPreference(v.depthFlattenedViewArchitectureItemOnly).value),i||(C=!0,i=new t({useAsyncPreExpand:!0}),this._addExpandCollapseBehaviors(i,r,!1)),!C&&o||(1!==m[0].length||f[m[0][0]].attributes.grid||(f[m[0][0]].attributes.noIndexOrDBExpand=!0,f[m[0][0]].attributes.physicalid=f[m[0][0]].physicalid,f[m[0][0]].attributes.grid={physicalid:f[m[0][0]].physicalid}),o=u._addLogItemIndexResponse(i,null,f[m[0][0]]),0===Object.keys(i.mappedNodesToIds).length&&o.options.physicalid.length>0&&(i.mappedNodesToIds[o.options.physicalid]=[o])),1===m.length&&1===m[0].length)return i.getRoots()[0].expand(),i;let S={};i.getRoots()[0].getAllDescendants().forEach((function(e){e.options.type===h.type_act_logref&&e.options.instance&&(S[e.options.instance.physicalid]||(S[e.options.instance.physicalid]=[]),S[e.options.instance.physicalid].push(e))}));var I,A=o;let F;y[m[0][0]]=i.getRoots()[0];for(var k=0;k<m.length;k++)for(var E=1;E<m[k].length;E+=2)if(a=f[m[k][E]],s=f[m[k][E+1]],a&&s&&(s.attributes.type!==h.type_act_logref||b!==v.flattenedViewOnlyArchitectureItem||0!==s.attributes.grid.architectureNumber.length)){if(b===v.structuredView||a.alreadyAdded||(a.alreadyAdded=!0),(w||b!==v.structuredView&&E<m[k].length-2)&&(s.attributes.noIndexOrDBExpand=!0),d=m[k].slice(0,E).join("|"),A=b===v.structuredView?F!==d&&y[d]?y[d]:o:Math.floor(d.split("|").length/2)<D?o:y[d],I=F!==d&&y[d]?y[d]:o,S){let e=S[a.attributes.physicalid],t=I.getOccurencePath();if(e&&t){let i;t.push(a.attributes.physicalid,s.attributes.physicalid);let n=JSON.stringify(t);for(let t=0;t<e.length;t++)if(JSON.stringify(e[t].getOccurencePath())===n){i=!0,y[d=m[k].slice(0,E+2).join("|")]=e[t];break}if(i)continue}}if(!n.checkIfRecentlyAuthored(I.options.physicalid,!0)&&s.attributes.type===h.type_act_logref){var x=s.attributes.physicalid;if(n.checkIfRecentlyAuthored(x,!0)){var T={};a&&(T.pid=a.attributes.physicalid,T.visualCue=a.attributes.visualCue,T.name=a.attributes.label),g.push(l.expand({itemIDs:[x],depth:"1",configFilter:r}).then(u.addStructureToChild.bind(u,x,A,T,S)));break}y[d=m[k].slice(0,E+2).join("|")]?c=y[d]:(c=u._addLogItemIndexResponse(A,a,s,I),y[d]=c,c.options.type===h.type_act_logref&&c.options.instance&&(S[c.options.instance.physicalid]||(S[c.options.instance.physicalid]=[]),S[c.options.instance.physicalid].push(c)),n.checkIfRecentlyAuthored(x)&&(void 0===p[x]&&(p[x]=[]),p[x].push(c)))}}return n.checkIfRecentlyAuthored(o.options.physicalid)&&(p[o.options.physicalid]=[o]),Object.keys(p).length>0&&g.push(l.refreshTreeNodeModel(p),!1),Promise.all(g).finally((function(){o.options.noIndexOrDBExpand=!0,i&&!i.getRoots()[0].options.hasBeenExpanded&&i.getRoots()[0].expand()})),i},addStructureToChild:function(e,t,i,n,o){let r=o[e],a=r.map[r.rootUuid];this._addLogItemDslogModelerResponse(t,a,r.map,i,null,n)},createTreeDocumentFromDslogModelerResponse:function(e,i){i||(i=new t({useAsyncPreExpand:!0})),this._addLogItemDslogModelerResponse(i,e.map[e.rootUuid],e.map);var n=i.getRoots()[0];return 0===Object.keys(i.mappedNodesToIds).length&&n.options.physicalid.length>0&&(i.mappedNodesToIds[n.options.physicalid]=[n]),this._addExpandCollapseBehaviors(i,null,!0),i.getRoots()[0].expand(),i},_addLogItemIndexResponse:function(e,t,n,o){var r=JSON.parse(JSON.stringify(n));if(null!==t)for(var a in r.attributes.instance={physicalid:t.attributes.physicalid,visualCue:t.attributes.visualCue,effectivitycompiledform:t.attributes.effectivitycompiledform,modificationDate:t.attributes.grid.modificationDate},r.attributes.grid.instanceName=t.attributes.label,r.attributes.grid.instance_description=t.attributes.description,t.attributes.grid)t.attributes.grid.hasOwnProperty(a)&&(r.attributes.grid["instance_"+a]=t.attributes.grid[a]),t.attributes.hasOwnProperty(a)&&(r.attributes["instance_"+a]=t.attributes[a]);r.attributes.children=[];var s=e.addChild(new i(r.attributes));return t&&s.setRelationID(t.attributes.physicalid),o&&(s.options.actualParent=o),s},_addLogItemDslogModelerResponse:function(e,t,n,o,r,a){var s=this,l=r||0,c={};!r&&e.options.actualDepth&&(l=e.options.actualDepth+1);var u,p,g=JSON.parse(JSON.stringify(t)),f=widget.getValue(v.componentView),C=!0;f===v.flattenedView?u=widget.getPreference(v.depthFlattenedView).value:f===v.flattenedViewOnlyArchitectureItem&&(u=widget.getPreference(v.depthFlattenedViewArchitectureItemOnly).value,e.getRoot&&0===g.attributes.grid.architectureNumber.length&&(C=!1,p=e));var y=!1;if(a&&void 0!==o){let t=a[o.pid],i=e.getOccurencePath();if(t&&i){i.push(o.pid,g.attributes.physicalid);let e=JSON.stringify(i);for(let i=0;i<t.length;i++)if(JSON.stringify(t[i].getOccurencePath())===e){y=!0,p=t[i];break}}}!y&&C&&(g.attributes.children=[],p=new i(g.attributes),o&&p.setRelationID(o.pid),p.options.actualParent=e,p.options.actualDepth=l,f!==v.structuredView&&void 0!==e.getRoot&&l<=parseInt(u,10)?e.getRoot().addChild(p):e.addChild(p),o&&(p.options.instance={physicalid:o.pid,visualCue:o.visualCue,modificationDate:o.modificationDate},p.options.grid.instanceName=o.name,p.options.grid.cue="",p.options.grid.instance_actualType=o.actualType,p.options.grid.instance_description=o.description||"",p.options.grid.instance_isReserved=o.isReserved,p.options.grid.instance_isReservedByOther=o.instance_isReservedByOther,p.options.instance_isReserved=o.instance_isReserved,p.options.grid.instance_reservedBy=o.instance_reservedBy,p.options.grid=Object.assign(p.options.grid,o.customAttributes),p.options=Object.assign(p.options,o.customAttributesInternalValues)),a&&o&&p.options.type===h.type_act_logref&&p.options.instance&&(a[p.options.instance.physicalid]||(a[p.options.instance.physicalid]=[]),a[p.options.instance.physicalid].push(p)));let b=[];c={};var _=function(e,t){for(let i in t){let n=i.split("instance_")[1];c[n]=Array.isArray(c[n])?c[n]:[];for(let o=0;o<=c[n].length-1;o++)"ds6w:project"===n&&(t[i]=e[n][c[n][o]]?e[n][c[n][o]]:t[i]),"ds6w:organizationResponsible"===n&&(t[i]=e[n][c[n][o]]?e[n][c[n][o]]:t[i])}};g.instances&&(p.options.noIndexOrDBExpand=!0,++l,g.instances.forEach((function(e){let t;var i=s._getInstDetailsFromModelerResp(e);for(let e in i.customAttributes){let n=i.customAttributes[e],o=e.split("instance_")[1];if("ds6w:organizationResponsible"===o||"ds6w:project"===o)if(c[o]||(c[o]=[]),c[o].push(n),m.nlsAdditionalAttributes.hasOwnProperty(o)){Object.keys(m.nlsAdditionalAttributes[o]).includes(n)||(t=!0)}else t=!0}t?(b.push(d.getNLSOfKeyValues(c).then((function(e){for(let t in e)m.nlsAdditionalAttributes[t]=e[t],_(e,i.customAttributes)}))),Promise.all(b).then((function(){s._addLogItemDslogModelerResponse(p,n[e.toUuid],n,i,l,a)}))):(_(m.nlsAdditionalAttributes,i.customAttributes),s._addLogItemDslogModelerResponse(p,n[e.toUuid],n,i,l,a))})))},_getInstDetailsFromModelerResp:function(e){if(!e)return;var t,i,r={},a={};let s,l;i=n.createMapSelectableForAdditionalAttr();for(var c={pid:e.physicalid,visualCue:e.visualCue,customAttributes:r,customAttributesInternalValues:a,actualType:e.type},d=0;d<e.attributes.length;d++)if("PLMInstance.PLM_ExternalID"===e.attributes[d].name)c.name=e.attributes[d].value;else if("PLMInstance.V_description"===e.attributes[d].name)c.description=e.attributes[d].value;else if("modified"===e.attributes[d].name)c.modificationDate=n.formatDate(e.attributes[d].value);else if("owner_NLS"===e.attributes[d].name)t=e.attributes[d].value;else if("reserved_NLS"===e.attributes[d].name)s=e.attributes[d].value;else if("organization_NLS"===e.attributes[d].name)l=e.attributes[d].value;else if("reserved"===e.attributes[d].name)c.isReserved=e.attributes[d].value;else{var u=i[e.attributes[d].name.toLowerCase()];if(u){if(void 0!==r["instance_"+u.curi]||void 0!==r["instance_"+u.curi+"_actual"]){var p="instance_"+u.curi;if(u.manipulationUnit&&(p="instance_"+u.curi+"_actual",r["instance_"+u.curi]=[]),Array.isArray(r[p])||(r[p]=r[p]?[r[p]]:[]),e.attributes[d].value)if(u.multiValuated||e.attributes[d].value&&e.attributes[d].value.indexOf("")>=0){var g=[];e.attributes[d].value&&(g=e.attributes[d].value.split(/\u0007/)),r[p]=r[p].concat(g)}else r[p].push(e.attributes[d].value)}else{if(u.multiValuated||e.attributes[d].value&&e.attributes[d].value.indexOf("")>=0){g=[];e.attributes[d].value&&(g=e.attributes[d].value.split(/\u0007/)),r["instance_"+u.curi]=g}else r["instance_"+u.curi]=e.attributes[d].value||"";u.manipulationUnit&&(r["instance_"+u.curi+"_actual"]=r["instance_"+u.curi],u.multiValuated?r["instance_"+u.curi]=[]:r["instance_"+u.curi]="")}n.getNLSValueFromRangeValuesAttribute(u,"instance_"+u.curi,r,a)}}return r["instance_ds6w:responsible"]=t,r["instance_ds6w:reservedBy"]&&s&&(r["instance_ds6w:reservedBy"]=s),r["instance_ds6w:organizationResponsible"]&&l&&(r["instance_ds6w:organizationResponsible"]=l),c.instance_reservedBy=s,c.instance_isReserved=c.isReserved,"FALSE"===c.isReserved?c.isReserved=f.notLocked:"TRUE"===c.isReserved&&(c.isReserved=f.lockedBy.replace("{user}",s),c.instance_reservedBy===o.getUser("isTrigram")||c.instance_reservedBy===o.getUser("isFullName")?c.instance_isReservedByOther=!1:c.instance_isReservedByOther=!0),c.customAttributes=r,c.customAttributesInternalValues=a,c},_createCategoryNode:function(e,t){return e.addChild(new i(t))},_addExpandCollapseBehaviors:function(e){e.onPreExpand((function(t){t.target.options.hasBeenExpanded||t.target.options.type!==h.type_act_logref?t.target.preExpandDone():y.expandNodestoNLevel({level:"1",selectedNodes:[t.target],params:{collectionView:{getContent:function(){return widget.body},treeDocument:e},onPreExpand:!0}})})),e.onPostExpand((function(){this.getModelEvents().publish({event:"colorizeNodesFromTagger"})}))},crRecTimeoutToCheckTreeDocExp:function(e,t){var i=this;e&&(e.isExpanding()?setTimeout((function(){i.crRecTimeoutToCheckTreeDocExp(e,t)}),200):t())},addDBExpandCallBack:function(e,t,i,n){var o=this;i.map[i.rootUuid]&&!i.map[i.rootUuid].instances||(n&&!t&&(t={},n.getRoots()[0].getAllDescendants().forEach((function(e){e.options.type===h.type_act_logref&&e.options.instance&&(t[e.options.instance.physicalid]||(t[e.options.instance.physicalid]=[]),t[e.options.instance.physicalid].push(e))}))),i.map[i.rootUuid].instances.forEach((function(n){var r=o._getInstDetailsFromModelerResp(n);o._addLogItemDslogModelerResponse(e,i.map[n.toUuid],i.map,r,null,t)})))},addDBNavigate:function(e,t){let i,n=this,o=widget.getValue(v.componentView),a=[],s=[];for(i=e.length-1;i>=0;i--){var c=e[i];c.options.physicalid&&(c.isRoot()||c.options.instance&&c.options.instance.physicalid)?a.indexOf(c.options.physicalid)<0&&a.push(c.options.physicalid):e.splice(i,1)}let d=!0,u=!0,g=!0,f=!0,m=!0;if(t&&t.navigateTypes){let e=t.navigateTypes,i=widget.getValue("configurable_expand")||{};d=e.indexOf("ZONE")>=0||!1,u=e.indexOf("SPECIFICATION_DOCUMENT")>=0&&i.specDocs||!1,g=e.indexOf("PROPOSED_SOLUTION")>=0&&i.proposedSolution||!1,f=e.indexOf("IMPLEMENTEDBY_LINK")>=0&&i.implementedBy||!1,m=e.indexOf("IMPLEMENTING_LINK")>=0&&i.implementing||!1}if(d&&s.push("dsmvlog:Reference.SPPConnection.Details"),u&&s.push("dsmvlog:Reference.SpecificationDocument.Details"),g&&s.push("dsmvlog:Reference.ProposedSolution.Details"),f&&o===v.structuredView&&s.push("dsmvlog:Reference.ImplementLink.ImplementedBy.Details"),m&&o===v.structuredView&&s.push("dsmvlog:Reference.ImplementLink.Implementing.Details"),!(s.length<=0))return l.navigate({payload:a,fields:s}).then((function(i){let a=[],l=[],c=!1;return e.forEach((function(e){let r=i[e.options.physicalid];if(r){let i,a=[e];for(i in t&&t.treeDocument&&(a=t.treeDocument.getMappedNodesFromId(e.options.physicalid)),0===Object.keys(r).length&&d?r.SPPConnections=[]:1===Object.keys(r).length&&u&&1===s.length&&(r.specificationDocument=[]),f&&!r["Implemented by"]&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implemented=!1),m&&!r.Implementing&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implementing=!1),c||!m&&!f||(c=!0),r)if("proposedsolution"===i)a.forEach((function(e){l.push(n.updateSolutionsOnNode(e,r[i],t))}));else if("Implementing"===i&&o===v.structuredView){let e={objType:"ref",linkType:"implementing"};a.forEach((function(o){l.push(n.updateLinksOnNode(e,o,r[i],t))}))}else if("Implemented by"===i&&o===v.structuredView){let e={objType:"ref",linkType:"implemented"};a.forEach((function(o){l.push(n.updateLinksOnNode(e,o,r[i],t))}))}else if("specificationDocument"===i)a.forEach((function(e){l.push(n.updateDocsOnNode(h.type_spec_document,e,r[i],t))}));else if("SPPConnections"===i){var g=p.parseDBSpaceData(r[i]);a.forEach((function(e){n.updateSpacesOnNode(e,g)}))}}e.options.instance&&a.push(e.options.physicalid)})),c&&a.length>0&&r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-referenceLinks-loaded",data:a}),Promise.all(l)}))},addIndexNavigate:function(e,t){let i,n=this,o=widget.getValue(v.componentView),a=Object.assign({},C.basic);for(a.input_physical_ids=[],i=e.length-1;i>=0;i--){var l=e[i];l.options.physicalid&&(l.isRoot()||l.options.instance&&l.options.instance.physicalid)?a.input_physical_ids.push(l.options.physicalid):e.splice(i,1)}if(0===a.input_physical_ids.length)return;a.label="navigate_rel_logref",a.primitives=[],a.patterns={},a.patternTypeFilters={};let c=C[h.type_act_logref],d=!0,p=!0,g=!0,f=!0,m=!0,y=widget.getValue("configurable_expand")||{};if(t&&t.navigateTypes){let e=t.navigateTypes;d=e.indexOf("ZONE")>=0||!1,p=e.indexOf("SPECIFICATION_DOCUMENT")>=0&&y.specDocs||!1,g=e.indexOf("PROPOSED_SOLUTION")>=0&&y.proposedSolution||!1,f=e.indexOf("IMPLEMENTEDBY_LINK")>=0&&y.implementedBy||!1,m=e.indexOf("IMPLEMENTING_LINK")>=0&&y.implementing||!1}return d&&(a.primitives.push(c.ZONE.primitives),a.patterns.ZONE=c.ZONE.patterns),p&&(a.primitives.push(c.SPECIFICATION_DOCUMENT.primitives),a.patterns.SPECIFICATION_DOCUMENT=c.SPECIFICATION_DOCUMENT.patterns),g&&(a.primitives.push(c.PROPOSED_SOLUTION.primitives),a.patterns.PROPOSED_SOLUTION=c.PROPOSED_SOLUTION.patterns,a.attributes=a.attributes.concat(h.index_services.select_physical)),f&&o===v.structuredView&&(a.primitives.push(c.IMPLEMENTEDBY_LINK.primitives),a.patterns.IMPLEMENTEDBY_LINK=c.IMPLEMENTEDBY_LINK.patterns,a.patternTypeFilters.IMPLEMENTEDBY_LINK=c.IMPLEMENTEDBY_LINK.patternTypeFilters),m&&o===v.structuredView&&(a.primitives.push(c.IMPLEMENTING_LINK.primitives),a.patterns.IMPLEMENTING_LINK=c.IMPLEMENTING_LINK.patterns,a.patternTypeFilters.IMPLEMENTING_LINK=c.IMPLEMENTING_LINK.patternTypeFilters),a.primitives.length<=0?void 0:s.navigate(a).then((function(i){let a=[],s=[],l=!1;return e.forEach((function(e){let r=i[e.options.physicalid];if(r){let i;for(i in d&&!r.ZONE&&(r.ZONE=[]),f&&!r.IMPLEMENTEDBY_LINK&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implemented=!1),m&&!r.IMPLEMENTING_LINK&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implementing=!1),l||!m&&!f||(l=!0),r)if("PROPOSED_SOLUTION"===i)s.push(n.updateSolutionsOnNode(e,r[i],t));else if("IMPLEMENTING_LINK"===i&&o===v.structuredView){let o={objType:"ref",linkType:"implementing"},a=n.formImplLinksFromNavigatedData(r[i]);a=u.attributes(a),s.push(n.updateLinksOnNode(o,e,a,t))}else if("IMPLEMENTEDBY_LINK"===i&&o===v.structuredView){let o={objType:"ref",linkType:"implemented"},a=n.formImplLinksFromNavigatedData(r[i]);a=u.attributes(a),s.push(n.updateLinksOnNode(o,e,a,t))}else if("REFERENCE_DOCUMENT"===i)s.push(n.updateDocsOnNode(h.type_attach_document,e,r[i],t));else if("SPECIFICATION_DOCUMENT"===i)s.push(n.updateDocsOnNode(h.type_spec_document,e,r[i],t));else if("ZONE"===i){let t=n.formSpacesFromNavigatedData(r[i]);t=u.attributes(t),n.updateSpacesOnNode(e,t)}}e.options.instance&&a.push(e.options.physicalid)})),l&&a.length>0&&r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-referenceLinks-loaded",data:a}),Promise.all(s)}))},formImplLinksFromNavigatedData:function(e){let t=[];return e&&e.length>0&&e.forEach((function(e){let i=e.elements[0];i.implementlink={id:e.owner.physicalid},t.push(i)})),t},formSpacesFromNavigatedData:function(e){let t=[];return e&&e.length>0&&e.forEach((function(e){let i=e.elements[0];i.connectionId=e.owner.physicalid,t.push(i)})),t},updateSolutionsOnNode:function(e,t,n){let r=e.options.instance?e.options.instance.physicalid:"",a=e.getNodesByRelId("proposedsolution"+r)[0];if(t&&!(t.length<=0))return e.options.hasProposedSolution=!0,a?a.removeChildren():(a=new i({label:f.label_proposed_solution,icons:[{iconName:"product"}],type:"proposedSolutionCategory",editableFlag:!1}),a.setRelationID("proposedsolution"+r),e.addChild(a),e.updateOptions()),this.validateNLSTypesForItems(t).then((function(){u.parseDataToNodeFormat({virtual:!0,data:t}).forEach((function(e){e.icons[0]||(e.icons=[o.getTypeIconUrl(h.type_act_physical)]),a.addChild(new i(e))})),n&&n.bExpand&&a.expand()}));a&&e.removeChild(a)},validateNLSTypesForItems:function(e){let t=[],i=[];if(e.forEach((function(e){e.type||(t.indexOf(e.actualType)<0&&t.push(e.actualType),i.push(e))})),t.length>0){let e={"ds6w:type":t};return a.getPredicateValues(e).then((function(e){if(e){let t,n=e["ds6w:type"];for(t in i.forEach((function(e){!e.type&&n[e.actualType]&&(e.type=n[e.actualType])})),n)n.hasOwnProperty(t)&&(m.mappingType[t]||(m.mappingType[t]={}),m.mappingType[t].nlsName=n[t])}}))}return Promise.resolve()},updateLinksOnNode:function(e,t,n,r){let a=this,s=t.options.instance?t.options.instance.physicalid:"",l=e.linkType+e.objType,c=f[l],d=t.getNodesByRelId(l+s)[0];if(n&&!(n.length<=0))return d?d.removeChildren():(d=a._createCategoryNode(t,{label:c,type:"implementLinksCategory",icons:[{iconName:"forward"}],editableFlag:!1}),d.setRelationID(l+s),t.addChild(d),t.updateOptions()),"ref"===e.objType&&(t.options.implementLinks||(t.options.implementLinks={}),n&&n.length>0?t.options.implementLinks[e.linkType]=!0:t.options.implementLinks[e.linkType]=!1),a.validateNLSTypesForItems(n).then((function(){u.parseDataToNodeFormat({virtual:!0,data:n}).forEach((function(n){n.linkInfo=JSON.parse(JSON.stringify(e));let r=n.implementlink||n.grid.implementlink;n.linkInfo.implementId=r?r.id:null;let a=n.implementLinkContext||n.grid.implementLinkContext;a||"ref"!==e.objType||("implementing"===e.linkType?(a=f.implementingref+": "+t.options.label+" "+t.options.grid.revision+"::",a+=f.implementedref+": "+n.label+" "+n.grid.revision):(a=f.implementingref+": "+n.label+" "+n.grid.revision+"::",a+=f.implementedref+": "+t.options.label+" "+t.options.grid.revision)),a&&(a=a.split("::"),n.grid.titleTooltip="",a.forEach((function(e){n.grid.titleTooltip+=e+"\n"})),n.grid.titleTooltip=n.grid.titleTooltip.substr(0,n.grid.titleTooltip.length-1)),n.icons[0]||("R"===n.grid.kindOfRFLP?void 0!==m.mappingType[n.type]?n.icons=[o.getTypeIconUrl(n.type)]:n.icons=[o.getTypeIconUrl(h.type_requirement)]:"F"===n.grid.kindOfRFLP?n.icons=[o.getTypeIconUrl(h.type_act_functref)]:"L"===n.grid.kindOfRFLP?n.icons=[o.getTypeIconUrl(h.type_act_logref)]:"P"===n.grid.kindOfRFLP&&(n.icons=[o.getTypeIconUrl(h.type_act_physical)])),d.addChild(new i(n))})),r&&r.bExpand&&d.expand()}));d&&t.removeChild(d)},updateDocsOnNode:function(e,t,n,r,a){let s,l=t.options.instance?t.options.instance.physicalid:"",c=t.getNodesByRelId(e+l)[0];if(s=e===h.type_attach_document?f.label_ref_documents:f.label_spec_documents,n&&!(n.length<=0))return c?a||c.removeChildren():(c=new i({label:s,icons:[{iconName:"doc"}],type:e,editableFlag:!1}),c.setRelationID(e+l),t.addChild(c),t.updateOptions()),this.validateNLSTypesForItems(n).then((function(){u.parseDataToNodeFormat({virtual:!0,data:n}).forEach((function(e){e.icons[0]||(e.icons=[o.getTypeIconUrl(h.type_document)]),c.addChild(new i(e))})),r&&r.bExpand&&c.expand()}));c&&t.removeChild(c)},updateSpacesOnNode:function(e,t){if(!t||t.length<=0)e.options.assignedSpacesPID=[],e.updateOptions({grid:{assignedSpaces:""}});else{var i={assignedSpacesPID:[],grid:{assignedSpaces:""}};e.options.grid.assignedSpaces="";for(var n=0;n<t.length;n++)i.assignedSpacesPID.push({obj:t[n].physicalid,owner:t[n].connectionId}),i.grid.assignedSpaces+=t[n].label+", ";i.grid.assignedSpaces=i.grid.assignedSpaces.slice(0,-2),e.updateOptions(i)}},_addOccImplementLinksToNode:function(e){var t=this;if(!e.isRoot())return c.getInstanceImplementLinks([e],!0).then((function(e){e&&e.forEach((function(e){t.manageImplementLinkResp(e.node,"inst",e,{keepNodes:!0})}))}))},manageImplementLinkResp:function(e,t,i,n){var o,r=this,a=e.options.instance?e.options.instance.physicalid:"";("ref"===t&&(e.options.implementLinks||(e.options.implementLinks={})),i)&&(i.implementing||n.keepNodes||(o=e.getNodesByRelId("implementing"+t+a)[0])&&o.remove(),i.implemented||n.keepNodes||(o=e.getNodesByRelId("implemented"+t+a)[0])&&o.remove(),["implementing","implemented"].forEach((function(o){if(i[o]){var s=f[o+t],l=e.getNodesByRelId(o+t+a)[0];l?n.keepNodes||l.removeChildren():(l=r._createCategoryNode(e,{label:s,type:"implementLinksCategory",icons:[{iconName:"forward"}]})).setRelationID(o+t+a);var c=i[o]&&i[o].member?i[o].member:i[o];"ref"===t&&(c&&c.length>0?e.options.implementLinks[o]=!0:e.options.implementLinks[o]=!1);var d={objType:t,linkType:o};r._parseImplementLinksAndAddToNode(c,d,l),n&&n.bExpand&&l.expand()}})))},_parseImplementLinksAndAddToNode:function(e,t,n){var r=!1;"inst"===t.objType&&(r=!0),e.forEach((function(e){var a,s,c;let d=e.implementlink;if(r&&(e=e.reference&&e.reference.member?e.reference.member[0]:e.reference),"R"===e.kindOfRFLP)a=h.type_requirement,s=[o.getTypeIconUrl(a)];else if("F"===e.kindOfRFLP)a=h.type_act_functref,s=[o.getTypeIconUrl(a)];else if("L"===e.kindOfRFLP)a=h.type_act_logref,s=[o.getTypeIconUrl(a)];else{if("P"!==e.kindOfRFLP)return;a=h.type_act_physical,s=[o.getTypeIconUrl(a)]}var u=l.defaultCRSParser(e);u.type=a,u.icons=s,u.grid.isLastVersion="TRUE"===e.isLastVersion,u.virtual=!0,u.linkInfo=JSON.parse(JSON.stringify(t)),u.linkInfo.implementId=d?d.id:null,(c=d?d.implementLinkContext:null)&&(c=c.split("::"),u.grid.titleTooltip="",c.forEach((function(e){u.grid.titleTooltip+=e+"\n"})),u.grid.titleTooltip=u.grid.titleTooltip.substr(0,u.grid.titleTooltip.length-1)),n.addChild(new i(u)),n.updateOptions()})),null===n.getChildren()&&n.getParent().removeChild(n)},addAssignedSpacesAttribute:function(e){let t=this,i=[];if(null==e||0===e.length)return Promise.resolve();let o=e.filter((function(e){return e.options.physicalid})),r=[],a=[];if(m.disableIndexAcceleration)r=o;else{let e=n.sortNodesIntoDBandIndex(o,!1);r=e.databaseNodes,a=e.indexNodes}return 0===r.length&&0===a.length?Promise.resolve():(r.length>0&&i.push(t.addDBNavigate(r,{navigateTypes:["ZONE"]})),a.length>0&&i.push(t.addIndexNavigate(a,{navigateTypes:["ZONE"]})),Promise.all(i))},expandNodestoNLevel:function(t){let i=t.level,o=t.params.collectionView.treeDocument.getRoots()[0],r=t.selectedNodes,a=[];for(var s=0;s<r.length;s++){let e,t=r[s];if("1"===i?e=!t.options.hasBeenExpanded:"2"===i?t.options.dontExpandTwoLvl?e=!1:t.options.hasBeenExpanded?t.getChildren().forEach((function(t){t.options.type===h.type_act_logref&&t.options.instance&&(t.options.hasBeenExpanded||(e=!0))})):e=!0:"-1"===i&&(t.options.dontExpandAllLvl?e=!1:t.options.hasBeenExpanded?(t.getAllDescendants().forEach((function(t){t.options.type===h.type_act_logref&&t.options.instance&&(t.options.hasBeenExpanded||(e=!0))})),e||(e=!1)):e=!0),e){if(t.options.physicalid===o.options.physicalid&&"-1"===i){a=[t];break}a.push(t)}else"-1"===i?t.expandAll():t.expandNLevels({numberOfLevelsToExpand:i})}if(a.length>0){var l=i||"-1";t.params.collectionView.treeDocument.prepareUpdate(),n.createBatchServiceReqExecution(a,l,t.params).then((function(){t.params.collectionView.treeDocument.reapplyFilterModel(),a&&a.forEach((function(e){"-1"===l?e.expandAll():"2"===l?e.expandNLevels({numberOfLevelsToExpand:l}):t.params.onPreExpand?e.preExpandDone():e.expandNLevels({numberOfLevelsToExpand:l})})),t.params.collectionView.treeDocument.pushUpdate(),e.unmask(t.params.collectionView.getContent())}))}}};return y})),define("DS/CATFLCockpitWidget/utils/gridview.util.extended",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/implementlink.service"],(function(e,t,i,n,o,r,a){"use strict";let s=i.getFullConfig(),l=s.identifiers,c=s.localStorageKeys;return{expandNFetchOtherNodes:function(i,n,o){var r;if("-1"===o){if(0===(r=n.getAllDescendants().filter((function(e){return!(e.options.type!==l.type_act_logref||!e.options.instance)&&!e.options.hasBeenExpanded}))).length)return void n.expandAll()}else if(0===(r=n.getChildren().filter((function(e){return!(e.options.type!==l.type_act_logref||!e.options.instance)&&!e.options.hasBeenExpanded}))).length)return void n.expandNLevels({numberOfLevelsToExpand:o});return e.mask(i.collectionView.getContent()),n.expand(),t.createBatchServiceReqExecution(r,o,i,!0,n)},getExpandServicesForBatchCalls:function(e,i,o,r,a){let l=this,d=[],u=s.disableIndexAcceleration,p=widget.getValue(c.componentView),g=!1;if(!o){let n=[];if(e.forEach((function(e){("1"!==r||"1"===r&&!e.options.noIndexOrDBExpand)&&n.push(e)})),u)d.push(l.addDBExpandForBatch(n,i,r,a));else{var f=t.sortNodesIntoDBandIndex(n,!0);f.indexNodes.length>0&&d.push(l.addIndexExpandForBatch(f.indexNodes,i,r,a)),f.databaseNodes.length>0&&d.push(l.addDBExpandForBatch(f.databaseNodes,i,r,a))}p===c.structuredView&&("2"!==r&&"-1"!==r||(g=!0),d.push(l.addOccImplementLinksToNodesInBatch(e,null,null,{bExpand:g})))}let m=[],h=[];if(u)m=e;else{let i=t.sortNodesIntoDBandIndex(e,!1);m=i.databaseNodes,h=i.indexNodes}let v=["SPECIFICATION_DOCUMENT","PROPOSED_SOLUTION","REFERENCE_DOCUMENT","IMPLEMENTING_LINK","IMPLEMENTEDBY_LINK"];return o||"2"!==r&&"-1"!==r||(g=!0),m.length>0&&d.push(n.addDBNavigate(m,{navigateTypes:v,bExpand:g})),h.length>0&&d.push(n.addIndexNavigate(h,{navigateTypes:v,bExpand:g})),Promise.all(d)},addIndexExpandForBatch:function(e,t,i,r){let a,s=this,l=[],c={},d={},u=widget.getValue("ngFilter");if(u&&u.length>0){if("1"!==i){let t=[];return e.forEach((function(e){t.push(s.expandNFetchOtherNodes(r,e,i))})),Promise.all(t)}return Promise.resolve()}return e.forEach((function(e){if(a||(a=e.getTreeDocument()),"1"!==i||"1"===i&&!e.options.noIndexOrDBExpand){l.push(e.options.physicalid);let t=e.getOccurencePath();c[t[0]]?c[t[0]].push(t):c[t[0]]=[t],d[e.options.physicalid]=e}})),l.length<=0?Promise.resolve():o.progressiveExpand({rootWithPaths:c,configFilter:t,expandLevel:parseInt(i)}).then((function(o){n.createTreeDocumentFromIndexResponse(o,a,a.getRoots()[0],t);let l=[];return e.forEach((function(e){"1"!==i&&l.push(s.expandNFetchOtherNodes(r,e,i))})),Promise.all(l)}))},addDBExpandForBatch:function(e,t,i,o){let a,s=this,l=[],c={},d=widget.getValue("ngFilter");if(d&&d.length>0){if("1"!==i){let t=[];return e.forEach((function(e){t.push(s.expandNFetchOtherNodes(o,e,i))})),Promise.all(t)}return Promise.resolve()}return e.forEach((function(e){a||(a=e.getTreeDocument()),("1"!==i||"1"===i&&!e.options.noIndexOrDBExpand)&&(l.push(e.options.physicalid),c[e.options.physicalid]=e)})),l.length<=0?Promise.resolve():r.expand({itemIDs:l,depth:"-1"===i?"0":i,configFilter:t}).then((function(t){let r=[];return e.forEach((function(e){let l=e.options.physicalid;n.addDBExpandCallBack(e,null,t[l],a),"1"!==i&&r.push(s.expandNFetchOtherNodes(o,e,i))})),Promise.all(r)}))},addOccImplementLinksToNodesInBatch:function(e,t,i,o){for(var r={},s=0;s<e.length;s++)e[s].isRoot()||(r[e[s].options.instance.physicalid]=e[s]);return widget.getValue(c.componentView)!==c.structuredView?Promise.resolve():a.getInstanceImplementLinks(e,!0).then((function(e){e&&((o=o||{}).keepNodes=!0,t&&t.prepareUpdate(),e.forEach((function(e){n.manageImplementLinkResp(e.node,"inst",e,o)})),t&&(t.reapplyFilterModel(),t.pushUpdate())),i&&i()}))}}})),define("DS/CATFLCockpitWidget/services/logitem.service",["DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/gridview.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a){"use strict";var s=o.getFullConfig(),l=s.localStorageKeys;var c={createLogItem:function(e){var t=s.webservices.createLogItem;let r={};return e.credential&&(r.securityContext=e.credential),i.post(t,JSON.stringify(e),null,r).then((function(e){var t=JSON.parse(e).member[0];return o.SAXStorage().setItem(l.recentlyAuthoredStructure+t.id,Date.now()),t})).catch((function(e){n.displayError(e,null,null,a.error_create_item)}))},createLogItemInstanceNew:function(e,t,n){var r=s.webservices.createLogItemInstanceNew+t+"/dslog:LogInstancePRIVATE";let a={};return e.credential&&(a.securityContext=e.credential),i.post(r,JSON.stringify(e),n?0:void 0,a).then((function(e){o.SAXStorage().setItem(l.recentlyAuthoredStructure+t,Date.now());var i=(e=JSON.parse(e)).member&&e.member[0]?e.member[0].reference:null;return i&&o.SAXStorage().setItem(l.recentlyAuthoredStructure+i,Date.now()),e}))},getlogRefDiagramProposal:function(e,t){var n=s.webservices.createLogRefFromDiagramProp;return i.post(n,JSON.stringify(e),0,{wiwSecurityContext:t}).then((function(e){return JSON.parse(e)}))},getDataForSetArchNumberOnPSpool:function(e,t){var n=s.webservices.getDataForSetArchNumberOnPSpool;return i.post(n,JSON.stringify(e),0,{wiwSecurityContext:t}).then((function(e){return JSON.parse(e)}))},setArchitectureNumberOnPSpool:function(e,t,n){var o=s.webservices.setArchitectureNumberOnPSpool;return i.post(o,JSON.stringify(e),t,{wiwSecurityContext:n})},createItemFromDialogue:function(e,t,n){var o=s.webservices.createLogRefFromDiagram;return i.post(o,JSON.stringify(e),t,{wiwSecurityContext:n})},deleteLogItemInstance:function(e,t){t instanceof Array&&t.length>20&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:20}));var o="/resources/v1/modeler/dslog/dslog:LogItemPRIVATE/"+e+"/dslog:LogInstancePRIVATE/DELETE";return i.post(o,JSON.stringify(t),0).then((function(e){return JSON.parse(e)}))},getLogItemWithExpand:function(t,i){var a=this;if(s.disableIndexAcceleration||n.checkIfRecentlyAuthored(t,!0))return a._expandFromModeler(t,i);let c={};c[t]=[[t]];let d={rootWithPaths:c};var u=widget.getValue("ngFilter");if(u&&u.length>0){var p=JSON.parse(u);d.filter=p.CVQueryV2.filter,d.aggregation_processors=p.CVQueryV2.aggregation_processors,p.CVQueryV2.batch&&p.CVQueryV2.batch.expands[0]&&(d.filter||(d.filter=p.CVQueryV2.batch.expands[0].filter),d.aggregation_processors||(d.aggregation_processors=p.CVQueryV2.batch.expands[0].aggregation_processors))}else d.configFilter=i;return e.progressiveExpand(d).then((function(e){if(null===e)return o.SAXStorage().setItem(l.recentlyAuthoredStructure+t,Date.now()),a._expandFromModeler(t,i);let n=!1;0===e.paths.length&&(e.paths.push([t]),e.map[t]={physicalid:t,attributes:{physicalid:t}},n=!0);let s=r.createTreeDocumentFromIndexResponse(e);if(n){let e=s.getRoots()[0];var c={},d=[];return c[e.options.physicalid]=[e],d.push(a.refreshTreeNodeModel(c,!1)),d.push(r.addDBNavigate([e],{navigateTypes:["ZONE"],treeDocument:s})),Promise.all(d).then((()=>(e.expand(),s)))}return s}))},_expandFromModeler:function(e,i){var n=widget.getValue("component-view"),o="1";return n===l.flattenedView?o=widget.getPreference(l.depthFlattenedView).value:n===l.flattenedViewOnlyArchitectureItem&&(o=widget.getPreference(l.depthFlattenedViewArchitectureItemOnly).value),t.expand({itemIDs:[e],depth:o,configFilter:i}).then((function(t){return r.createTreeDocumentFromDslogModelerResponse(t[e])}))},updateAttribute:function(e){var t=[],o=s.webservices.updateAttributes;return e instanceof Array&&e.length>1e3&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:1e3})),e.forEach((function(e){var i={method:"PATCH",body:[],queryParams:{select:["physicalid","modified"]}};for(var n in e.instID?i.path="model/rel/"+e.instID:i.path="model/bus/"+e.refID,e.attributes)e.attributes.hasOwnProperty(n)&&(e.attributes[n]&&e.attributes[n].unitName&&e.attributes[n].dimensionType?i.body.push({op:"replace",path:n,value:e.attributes[n].value,unitName:e.attributes[n].unitName,dimensionType:e.attributes[n].dimensionType}):i.body.push({op:"replace",path:n,value:e.attributes[n]}),i.queryParams.select.push("attribute["+n+"]"));t.push(i)})),i.makeServiceCall(o,"PUT",JSON.stringify({requests:t})).then((function(e){var t=JSON.parse(e).results;if(t){var i=[];for(var n in t)0!==t[n].body.errors.length&&i.push({physicalid:t[n].body.physicalid,errors:t[n].body.errors});return 0!==i.length?Promise.reject({error:{message:a.msg_error_no_modification_possible,errorList:i}}):t}return Promise.reject()}))},getLogItemModel:function(e){var t=s.webservices.dsfl_getLogItem+e+"/model";return i.get(t).then((function(e){var t={};e=JSON.parse(e);var i=null;return Object.keys(e).length>0&&e.rootObjects.length>0&&(i=[],e.rootObjects.forEach((function(e){(t={}).physicalid=e.physicalid?e.physicalid:null;for(var n=0;n<e.attributes.length;n++)"id"===e.attributes[n].name?t.id=e.attributes[n].value:"name"===e.attributes[n].name&&(t.name=e.attributes[n].value);i.push(t)}))),i})).catch((function(e){var t=e.error.message.slice(e.error.message.indexOf("ResponseCode")),i=a.error_get_model;t&&t.indexOf("404")>=0&&(i=a.error_get_model_media),n.displayError(e,null,null,i)}))},getLogItemAttributes:function(e){return t.getObjectAttributes([e])},displayMoreAttributes:function(t,i,o){var r=this,s=[],l=[],c=[],d=[],u=[];i.forEach((function(e){s.push(e.options.physicalid),void 0===c[e.options.physicalid]&&(c[e.options.physicalid]=[]),c[e.options.physicalid].push(e),e.options.instance&&e.options.instance.physicalid&&(l.push(e.options.instance.physicalid),void 0===d[e.options.instance.physicalid]&&(d[e.options.instance.physicalid]=[]),d[e.options.instance.physicalid].push(e))}));var p=[],g=[],f=n.getUserCustomAttributes(o);f&&f.forEach((function(e){e.bo?p.push(e.curi):g.push(e.curi)})),p.length>0&&u.push(e.fetch(s,p).then((function(e){r._mapFetchResultsToTreeNodeModel(e,c,!1,o),t.requestDelayedModelData()}))),g.length>0&&l.length>0&&u.push(e.fetch(l,g).then((function(e){r._mapFetchResultsToTreeNodeModel(e,d,!0),t.requestDelayedModelData()}))),u.length>0?Promise.all(u).then((function(){1===i.length?o?n.alertMessage("info",null,a.msg_additional_attributes_displayed_success_single_solution):n.alertMessage("info",null,a.msg_additional_attributes_displayed_success_single):o?n.alertMessage("info",null,a.msg_additional_attributes_displayed_success_multiple_solutions):n.alertMessage("info",null,a.msg_additional_attributes_displayed_success_multiple)})):n.alertMessage("warning",null,a.warning_no_additional_attributes_to_displayed)},_mapFetchResultsToTreeNodeModel:function(e,t,i,o){let r=n.getUserCustomAttributes(o),a=[],s=[],l=[];r&&r.forEach((function(e){e.manipulationUnit&&a.push(e.curi),e.multiValuated&&s.push(e.curi),(e.isSharedPredicateOnSameType||e.isSharedPredicate&&(e.isClassification||e.isOnExtension))&&l.push(e.curi)}));for(var c=0;c<e.length;c++){var d={grid:{}};for(var u in e[c])if("resourceid"!==u){var p=e[c][u].dispValue||e[c][u].value;(s.indexOf(u)>=0||l.indexOf(u)>=0)&&!Array.isArray(p)&&(p=p?[p]:[]),i?a.indexOf(u)>=0?(d.grid["instance_"+u+"_actual"]=p,d.grid["instance_"+u]=""):d.grid["instance_"+u]=p:o?a.indexOf(u)>=0?(d.grid["physical_"+u+"_actual"]=p,d.grid["physical_"+u]=""):d.grid["physical_"+u]=p:a.indexOf(u)>=0?(d.grid[u+"_actual"]=p,d.grid[u]=""):d.grid[u]=p}r.forEach((function(e){var t=e.curi;i?t="instance_"+t:o&&(t="physical_"+t),n.getNLSValueFromRangeValuesAttribute(e,t,d.grid)}));for(var g=t[e[c].resourceid.value],f=0;f<g.length;f++)g[f].updateOptions(d)}},getCustomField:function(e){var t="",o="";null!=e&&(t=e.options.physicalid,o=e.options.label+" "+e.options.grid.revision);var r=s.webservices.dsfl_getCustomFields;return i.post(r,JSON.stringify({parentID:t}),0).then((function(e){return JSON.parse(e)})).catch((function(e){var t=a.replace(a.error_get_customFields,{title:o});return e.errorResp&&e.errorResp.message&&500!==e.errorResp.status?t+=e.errorResp.message:UWA.is(e.error,"string")&&(t+=e.error),n.alertMessage("error",null,t),Promise.reject()}))},refreshTreeNodeModel:function(e,i,n){return t.refreshTreeNodeModel(e,i,n)},refreshInstanceNodeModel:function(e,i){return t.refreshInstanceNodeModel(e,i)},getArchitectureNumberProposal:function(e){var t=s.webservices.getArchitectureNumberProposal;return i.post(t,JSON.stringify(e),0)},getANProposalForReparent:function(e){var t=s.webservices.getANProposalForReparent;return i.post(t,JSON.stringify(e),0)},setArchitectureNumber:function(e){e.architectureNumbers&&e.architectureNumbers instanceof Array&&e.architectureNumbers.length>100&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:100}));var t=s.webservices.setArchitectureNumber;return i.post(t,JSON.stringify(e),0)},setANandReparent:function(e){e.architectureNumbers&&e.architectureNumbers instanceof Array&&e.architectureNumbers.length>5&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:5}));var t=s.webservices.setANandReparent+s.webservices.getLogInstMask;return i.post(t,JSON.stringify(e),0)},detachArchitectureReferenceExtension:function(e,t){e instanceof Array&&e.length>100&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:100}));var o={SelectedReferences:e,action:t},r=s.webservices.detachArchitectureReferenceExtension;return i.post(r,JSON.stringify(o),0)},updateSolutionIDAttributes:function(e,t){let o={};t&&(o.securityContext=t),e instanceof Array&&e.length>20&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:20}),o);var r=s.webservices.addSolutions;return i.post(r,JSON.stringify(e),0,o).then((function(e){return JSON.parse(e)}))},detachSolution:function(e){var t=s.webservices.removeSolutions;return i.post(t,JSON.stringify(e),0)},replaceWithExistingRef:function(e,t,n,o){var r=s.webservices.replaceWithExistingRef+s.webservices.getLogInstMask;return i.post(r,JSON.stringify([{referenceID:n,instanceID:t,replaceWith:o}])).then((function(e){return JSON.parse(e)}))},replaceWithNewRef:function(e,t,n,o,r,a){var l=s.webservices.replaceWithExistingRef+s.webservices.getLogInstMask,c={};r&&Object.keys(r).length>0&&(c.CustomFields=r),o&&(c.type=o),c.attributes=n?{title:n}:{};let d={};a&&(d.securityContext=a);var u={replaceWith:"newReference",instanceID:t,newReference:c};return Object.keys(r).length>0&&(u.CustomFields=r),i.post(l,JSON.stringify([u]),null,d).then((function(e){return JSON.parse(e)}))},replaceWithNewRevision:function(e){var t=s.webservices.replaceWithExistingRef+s.webservices.getLogInstMask;return e instanceof Array&&e.length>100&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:100})),i.post(t,JSON.stringify(e),0).then((function(e){return JSON.parse(e)}))},ReplaceByLatestSolOrReq:function(e){let t=e.payload,o=e.type,r=s.webservices.replaceSolOrReq.replace("{type}",o);return t instanceof Array&&t.length>100&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:100})),i.post(r,JSON.stringify(t),0).then((function(e){return JSON.parse(e)}))},reparentInstances:function(e){var t=s.webservices.reparentInstances+s.webservices.getLogInstMask;return e instanceof Array&&e.length>5&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:5})),i.post(t,JSON.stringify(e),0).then((function(e){return e}))},getSubTypes:function(e){return e||(e=""),i.post(s.webservices.dslog_getSubTypes,JSON.stringify({parentType:e}),0).then((function(e){return JSON.parse(e)}))},getSubTypesOfLogicalReferenceAndInstance:function(){return i.post(s.webservices.getTypeInfo,JSON.stringify([s.identifiers.type_act_logref,s.identifiers.type_act_loginstance]),0).then((function(e){var t=JSON.parse(e),i={};for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];void 0!==o.parent&&(void 0===i[o.parent]&&(i[o.parent]=[o.parent]),i[o.parent].push(n))}return i}))},consolidateLogicalDefinition:function(e){return e.instanceIds&&e.instanceIds instanceof Array&&e.instanceIds.length>1e3&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:1e3})),i.post(s.webservices.consolidateLogDefn,JSON.stringify(e),0).then((function(e){return JSON.parse(e)}))},compareWithLastOutfitted:function(e){return i.post(s.webservices.compareWithLastOutfitted,JSON.stringify(e),0).then((function(e){return JSON.parse(e)})).catch((function(e){return Promise.reject(e)}))},recomputeArchNum:function(e){return i.post(s.webservices.recomputeArchNum,JSON.stringify(e),0).then((function(e){return JSON.parse(e)})).catch((function(e){return Promise.reject(e)}))},checkToUpdateSpace:function(e){var t=e.map((function(e){return e.options.physicalid}));return i.post(s.webservices.checkToUpdateSpace,JSON.stringify(t),0).then((function(e){return JSON.parse(e)}),(function(e){return Promise.reject(e)}))},getLogItemClassificationAttributes:function(e){return t.getObjectClassificationAttributes(e)}};return c})),define("DS/CATFLCockpitWidget/utils/refresh.util",["DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/UIKIT/Mask","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c){"use strict";var d=r.getFullConfig(),u=d.localStorageKeys,p={addChildrenToParent:function(e,t,n,o){var a=[],l={},c=[];o=o||!1,e.prepareUpdate(),t.forEach((function(e){n.forEach((function(t){var i=new s({hasBeenExpanded:!1,noIndexOrDBExpand:!1,physicalid:t.reference,instance:{physicalid:t.id},grid:{physicalid:t.reference,instanceName:t.name,instance_description:""},actualParent:e,children:[]});t.id&&i.setRelationID(t.id),e.addChild(i),c.indexOf(e.options.physicalid)<0&&(c.push(e.options.physicalid),r.SAXStorage().setItem(u.recentlyAuthoredStructure+e.options.physicalid,Date.now())),a.indexOf(t.reference)<0&&a.push(t.reference),Object.keys(l).indexOf(t.id)<0&&(l[t.id]=i)}))})),e.pushUpdate(),i.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:a,tagAsRecentlyAuthored:o}})},refreshNodeDetails:function(t){var i=this,o=t.arrayOfPID,r=t.tagAsRecentlyAuthored,a={},s=[],l=[];o&&(o.forEach((function(e){var t=i.contentView.treeDocument.getMappedNodesFromId(e);if(a[e]=t||[],t&&t.length>0)for(var n=0;n<t.length;n++){var o=t[0];if(o.options.physicalid&&(o.isRoot()||o.options.instance&&o.options.instance.physicalid)){l.push(o);break}}})),s.push(e.refreshTreeNodeModel(a,r,i.contentView)),t.dontLoadSpaceInfo||s.push(n.addDBNavigate(l,{navigateTypes:["ZONE"],treeDocument:i.contentView.treeDocument})),Promise.all(s).then((()=>{})))},refreshInstDetailsonNode:function(t){let i,n=this,o=[],r={},a=Object.keys(t.instIdMap),s=[];if(a.forEach((function(e){i=t.instIdMap[e],i&&i instanceof Array||(i=n.contentView.treeDocument.getRoots()[0].getNodesByRelId(e)),s.push(i[0].options.physicalid),r[e]=i||[]})),t.bInstance&&o.push(e.refreshInstanceNodeModel(r,!0)),t.bEffectivity){var l={relids:a,pids:s},u=d.gridview.additionalColumnsModules.cfgEffectivty;u&&o.push(new Promise((function(e,t){u.updateAttributes(l,(function(i){var n=UWA.is(i,"string")?JSON.parse(i):i;e(n),t("Error in Cfg_updateAttributes")}),n)})).then((function(e){let t=e?e.relids:{};n.contentView.treeDocument.withTransactionUpdate((function(){a.forEach((function(e){var i=r[e],n=t[e];n&&(n.VariantEffectivity.trim()||(n.VariantEffectivity=c.label_none),i.forEach((e=>{e.updateOptions({grid:n})})))}))}))})))}Promise.all(o).then((()=>{let e=n.contentView.getGroupingOptions();e&&n.contentView.groupRows(e)}))},refreshSpacesonNode:function(e){e&&(e.forEach((function(e){r.SAXStorage().setItem(u.recentlyAuthored+e.options.physicalid,Date.now())})),n.addDBNavigate(e,{navigateTypes:["ZONE"],treeDocument:this.contentView.treeDocument}))},refreshSolutionsonNode:function(e){e&&(e.forEach((function(e){r.SAXStorage().setItem(u.recentlyAuthored+e.options.physicalid,Date.now())})),n.addDBNavigate(e,{navigateTypes:["PROPOSED_SOLUTION"],treeDocument:this.contentView.treeDocument}))},refreshDocumentsOnNodes:function(e){var t=this,i=e.nodes,o=e.docType;if(i){let e=new Set;(i=i.filter((function(t){let i=t.options.physicalid;return!e.has(i)&&e.add(i)}))).forEach((function(e){r.SAXStorage().setItem(u.recentlyAuthored+e.options.physicalid,Date.now())})),"attachedDocumentsCategory"===o?n.addDBNavigate(i,{navigateTypes:["REFERENCE_DOCUMENT"],treeDocument:t.contentView.treeDocument}):"specificationDocumentsCategory"===o?n.addDBNavigate(i,{navigateTypes:["SPECIFICATION_DOCUMENT"],treeDocument:t.contentView.treeDocument}):n.addDBNavigate(i,{navigateTypes:["SPECIFICATION_DOCUMENT","REFERENCE_DOCUMENT"],treeDocument:t.contentView.treeDocument})}},refreshReferenceLinksOnNodes:function(e){e&&(e.forEach((function(e){r.SAXStorage().setItem(u.recentlyAuthored+e.options.physicalid,Date.now())})),n.addDBNavigate(e,{navigateTypes:["IMPLEMENTEDBY_LINK","IMPLEMENTING_LINK"],treeDocument:this.contentView.treeDocument}))},removeItemsFromCatogry:function(e){var t=this,i=e.nodes,n=e.categoryType;let o=widget.getValue("groupingEnabled");i&&i.length>0&&i.forEach((function(e){var i=e.options.physicalid,r=e.getParent();if(r){var s=r.getParent();if(o&&!s.getID&&(s=a.getGroupNodeParent(s)),o&&s.isRoot()){let e=r.getParent();r.getChildren().forEach((function(e){e.options.physicalid===i&&e.remove()})),r.getChildren()&&0!==r.getChildren().length||r.remove(),a.removeGroupNodesOnEmpty(e)}else{(t.contentView.treeDocument.getMappedNodesFromId(s.options.physicalid)||[s]).forEach((function(e){var t=e.options.instance?e.options.instance.physicalid:"",o=e.getNodesByRelId(n+t)[0];o.getChildren().forEach((function(e){e.options.physicalid===i&&e.remove()})),o.getChildren()&&0!==o.getChildren().length||o.remove(),e.expand()}))}}}))},refreshNodesOnReparent:function(e){var t=e.resp,i=e.params,n=e.newParent,a=e.instArray;t=t&&UWA.is(t,"string")?JSON.parse(t):t;var s=i.collectionView.treeDocument.getMappedNodesFromId(n.options.physicalid),d=t&&t.member?t.member:[];a.forEach((function(e){r.SAXStorage().setItem(u.recentlyAuthoredStructure+e.getParent().options.physicalid,Date.now());var t=i.collectionView.treeDocument.getMappedNodesFromId(e.options.physicalid)||[e];for(let i=t.length-1;i>=0;i--){var n=t[i];if(n.options.instance.physicalid===e.options.instance.physicalid){var o=n.getParent();o.removeChild(n),o.expand()}}})),this.addChildrenToParent(i.collectionView.treeDocument,s,d,!0),l.unmask(i.collectionView.getContent()),o.alertMessage("success",null,c.msg_reparentSuccess)},refreshNodesOnReplace:function(e){let n=[];e.instID?n=e.instID:e.replaceDetails.forEach((e=>n.push(e.old)));let o=e.replaceDetails,a=e.selectedNodes,s=this.contentView?this.contentView.treeDocument:a[0].getTreeDocument();var l=[],c={},d=[];return t.getObjectAttributes(n).then((function(e){let t=[];t=a.filter((e=>n.includes(e.options.instance.physicalid)));let g=e;o&&o.length>0&&(t.forEach((function(e,t){r.SAXStorage().setItem(u.recentlyAuthoredStructure+e.getParent().options.physicalid,Date.now());let i=e.options.instance.physicalid;d.push(e.options.label);var n=s.getMappedNodesFromId(e.options.physicalid);n||(n=[e]);let a={oldInstExist:g,oldInstId:i,newReferenceId:o[t].new?o[t].new.reference:o[t].reference,newInstanceId:o[t].new?o[t].new.instance:o[t].id,newInstanceName:o[t].name,mappedNodes:n,selectedNode:e};var f=p.replaceByOperation(a);l.push(...f.newNodesList),c={...c,...f.instanceNodes}})),i.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:l,tagAsRecentlyAuthored:!0}}),i.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-inst-by-id",data:{instIdMap:c,bInstance:!0,bEffectivity:!0}}))}))},refreshConnectedDIFNode:function(e){var i={itemID:e.options.physicalid};return t.getAttributes(i).then((function(t){e.updateOptions({grid:{maturity:t.attributes.grid.maturity,current:t.attributes.maturity,owner:t.attributes.grid.owner}})})).catch((function(e){o.alertMessage("error",null,e.errorResp.message)}))},replaceByOperation:function(e){let t=e.oldInstExist,i=e.oldInstId,n=e.newReferenceId,o=e.newInstanceId,r=e.newInstanceName,a=e.mappedNodes,l=e.selectedNode?e.selectedNode:a[0],c=[],d={},u=!0,p=a[0].getTreeDocument();for(var g=a.length-1;g>=0;g--){var f=a[g];if(f.options.instance.physicalid===i){let e=f.getParent();p.prepareUpdate(),t[i].isProxy&&(e.removeChild(f),u=!1);let a=new s({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,configContexts:void 0,physicalid:n,instance:{physicalid:o},grid:{instanceName:r,physicalid:n,configCtx:void 0},children:f.getChildren()?f.getChildren():[]});a.setRelationID(o),e.addChild(a),u||a.select(),p.pushUpdate(),u&&(c.push(f.getID()),d[f.getRelationID()]=f)}}return c.push(n),d[o]=l,{newNodesList:c,instanceNodes:d}}};return p})),define("DS/CATFLCockpitWidget/services/predicate.service",["DS/CATFLCockpitWidget/services/logitem.service","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/xhr.util"],(function(e,t,i,n){"use strict";var o,r,a=i.getFullConfig(),s=i.getFullConfig().identifiers;return{getLtypes:function(){return o||(o=e.getSubTypesOfLogicalReferenceAndInstance()),o},getPredicatesForLtypes:function(){var e=this;return r||(r=e.getLtypes().then((function(t){return e.getPredicates(t[s.type_act_logref],t[s.type_act_loginstance]).catch((function(){return r=null,e.getPredicatesForLtypes()}))}))),r},getPredicates:function(e,t){return Promise.all([this._splicedGetPropertiesForClass(e),this._splicedGetPropertiesForClass(t)]).then((function(e){return[e[0],e[1]]}))},getPropertiesPredicates:function(e){var t=a.webservices.getInfoProperties,i=[];for(var o in e){var r=[];for(var s in e[o])r.push(s);i.push({type:o,attributes:r})}return i.length>0?n.post(t,JSON.stringify(i)):Promise.resolve(null)},getNLSPredicates:function(e){var i=e.map((e=>e.curi)),n=i.join(",");return new Promise((function(o){t.getResourcesInfo(n,{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(t){var n="string"==typeof t?JSON.parse(t):t,r={};Array.isArray(n)&&i.length===n.length?n.forEach((function(e){r[e.curi]=e.label})):(console.warn("Inconsistent NLS answer compared to input"),e.forEach((function(e){r[e.curi]=e.nls}))),o(r)},onFailure:function(){var t={};e.forEach((function(e){t[e.curi]=e.nls})),o(t)}})}))},_splicedGetPropertiesForClass:function(e){if(0===e.length)return[];var i=[],n=[];if(e.length>25)for(var o=0;o<e.length;o+=25)i.push(e.slice(o,o+25));else i.push(e);for(var r=0;r<i.length;r++)n.push(new Promise((function(e,n){t.getPropertiesForClass(i[r],{apiVersion:"R2019x",lang:widget.lang||"en",tenantId:widget.getValue("x3dPlatformId"),onComplete:function(t){e(t)},onFailure:function(t){t.stack.contains("timedout")?n(t):e([])}})})));return Promise.all(n).then((function(e){return[].concat.apply([],e)}))}}})),define("DS/CATFLCockpitWidget/utils/architectureNumber.util",["UWA/Core","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/logitem.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n){"use strict";return{executeRecompute:function(e){let o,r,a,s,l,c,d=this,u=e.isWIWcall,p=e.an_action,g=e.rows,f=[],m=!0,h={AN_ACTION:p,anColumns:[],instances:[]},v=!1;for(let t=0;t<g.length;t++){var C=g[t];if("ok"===C.getChildren()[0].getAttribute("status")){f.push(C),o=u?C.getAttribute("data-id"):C.getAttribute("referenceID"),r=C.getElement(".archidcell").innerText,s=null,l=null,c={},a={},C.getElements("[architectureidcolumn=true]").forEach((e=>{if(s=e.getAttribute("id"),"true"===e.getAttribute("editable")){let t=e.getChildren()&&e.getChildren()[0];l=t.dsModel.value}else l=e.getHTML();c[s]=l,v||h.anColumns.push(s)})),h.anColumns.length>0&&(v=!0),e.forReparent?Array.isArray(C.getAttribute("instanceIDs"))?a.instanceIDs=C.getAttribute("instanceIDs"):a.instanceIDs=C.getAttribute("instanceIDs").split(","):a.instanceID=u?C.getAttribute("data-instance"):C.getAttribute("instanceID"),a.referenceID=o,a.ArchitectureNumber=r,a.ArchitectureNumberTokens=c,h.instances.push(a),C.getAttribute("data-type")&&(h.logicalRefType=C.getAttribute("data-type")),m=!1}}m?t.alertMessage("error",null,n.log_ref_selection_error):(e.SelectionContext&&(h.SelectionContext=e.SelectionContext),i.recomputeArchNum(h).then((function(e){d.updateRowsOnRecompute(u,e,f),t.alertMessage("success",null,"",n.msg_recompute_setArch_success)}),(function(e){t.displayError(e,null,null,n.error_recompute_failed)})))},updateRowsOnRecompute:function(e,t,i){let n,o,r=this,a=e?"data-instance":"referenceID";i.forEach((function(e){o=t[e.getAttribute(a)],Object.keys(o).forEach((function(t){if(n=e.getElement("#"+t),n)if("true"===n.getAttribute("editable")){let e=n.getChildren()[0].dsModel;e.value=o[t];let i=e.elementsList;if(i){let n;for(let e=0;e<i.length;e++)if(i[e].value===o[t]){n=e;break}n&&(e.selectedIndex=n,e._applySelectedIndex())}}else n.setHTML(o[t]);e.getElement("#ANRecompute")&&e.getElement("#ANRecompute").hasClassName("errordiv")&&e.getElement("#ANRecompute").removeClassName("errordiv")})),r.updateArchitectureID(null,e,!0)}))},updateArchitectureID:function(e,t,i){let n=t.getElements("[architectureidcolumn=true]");var o="",r=null;e&&e.removeClassName&&e.removeClassName("errordiv"),n.forEach((e=>{if("true"===e.getAttribute("editable")){let t=e.getChildren()&&e.getChildren()[0];o+=t.dsModel._properties.valueToCommit?t.dsModel._properties.valueToCommit.value:t.dsModel.value?t.dsModel.value:""}else o+=e.getHTML()})),(r=t.getElement(".archidcell"))&&r.getText()!=o&&(r.setText(o),r.removeClassName("errordiv"),!i&&t.getElement("#ANRecompute")&&t.getElement("#ANRecompute").addClassName("errordiv"))},checkifANcontainsInvalidChars:function(e){return/[<>&'\\]/.test(e)}}})),define("DS/CATFLCockpitWidget/mixins/CATFLBIFilter",["UWA/Class","UWA/Class/Events","DS/ENOFilterBIUX/FilterBIComponentProxy","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","text!DS/CATFLCockpitWidget/assets/config/mapping.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c){"use strict";var d=o.getFullConfig(),u=d.identifiers,p=JSON.parse(l);return e.extend(t,{_biFilter:null,filterInitialized:!1,_id2removeFromFilterProxy:[],_filterAlreadyTreatedRoot:[],defaultOptions:{model:null},init:function(e){this.options={model:e.view?e.view.treeDocument:void 0,view:e.view},this.initializeBI()},initializeBI:function(){this._createProxy()},cleanProxy:function(){this._biFilter&&this._biFilter.cleanProxy&&this._biFilter.cleanProxy()},removeRootFromFilterProxy:function(e){this._biFilter&&(this._biFilter.resetNGFilterUI({appId:widget.id,widgetId:widget.id,rootIds:e.rootId2remove}),this._biFilter.removeRoot(e.rootId2remove))},addFilter:function(){},loadFilters:function(){},onModifyPreferences:function(){},onApplyNGFilter:function(e){var t=this;null!==e&&t.options.model.applyFilter(e,t.processNGFilter.bind(t,e),t.finalprocessNGFilter.bind(t))},finalprocessNGFilter:function(){a.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-ngfilter-applied"})},processNGFilter:function(e,t){var i=this;let o=function(){if(t.response?(t.recentlyAuthored&&!e.empty&&n.alertMessage("warning",null,c.warn_indexed_data_filtered),t.treedocument.empty(),t.treedocument.hasBeenExpanded=!0,t.recentlyAuthored&&e.empty?r.createTreeDocumentFromDslogModelerResponse(t.response,t.treedocument):r.createTreeDocumentFromIndexResponse(t.response,t.treedocument)):n.alertMessage("info",null,c.msg_no_match_in_filter),e.empty&&i.options){let e=i.options.view.getGroupingOptions();e&&i.options.view.groupRows(e)}};if(e.empty){if(widget.setValue("ngFilter",null),widget._biFilter=null,widget.setValue("ngFilterSessionBuilt",!1),a.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-ngfilter-removed",data:{filterName:null}}),widget.getValue("modelAttached")||widget.getValue("xRevAttached")){var s=widget.getValue("currentOpenedItem");a.getFLWebModelEventsObj("flweb-model-events").publish({event:"allmod-selection-successful",data:{itemID:s}})}o()}else{e&&e.filterMdl&&delete e.filterMdl;let t=i._biFilter.hasFilter(e.filterRootIds[0]);t.filterId&&(e.filterId=t.filterId),i.setFilterSpec?i.setFilterSpec=!1:(widget.setValue("ngFilter",JSON.stringify(e)),widget._biFilter=this._biFilter,a.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-ngfilter-added",data:{filterName:e.filterName,filterTitle:e.filterTitle}}),o())}},onSetPathTags:function(){if(this._biFilter){var e=this;setTimeout((function(){var t={nodes:[],paths:[]},i={};function n(e){if(!e.isHidden()){var o=e.getRealPath().map((function(e){return function(e){return i.hasOwnProperty(e)||(t.nodes.push(e),i[e]=t.nodes.length-1),i[e]}(e.getID())}));t.paths.push(o);var r=e.getChildren();r&&r.forEach((function(e){n(e)}))}}e.options.model.getRealRoots().forEach((function(e){n(e)})),e._biFilter.setPathTags(t)}))}},onSetTagsWithExpandSynthesis:function(){if(this._biFilter&&this.options.model&&this.options.model.getRealRoots()[0]){var e=this;this._biFilter.setSynthesisMode("flat"),setTimeout((function(){var t=e.options.model.getRealRoots()[0],i=t?t.getID():null;e._biFilter.setTagsWithExpandSynthesis&&i&&e._biFilter.setTagsWithExpandSynthesis([i],{type_filter_rel:["RFLVPMLogicalInstance","RFLPLMFunctionalInstance"]})}))}},onTagsLoadingComplete:function(){},onFilterBIColorize:function(e){if(this.colorizeActivated=!0,e){this.predicateKind=e.tagColors&&e.tagColors.length?e.tagColors[0].type:null;for(var t=this.colorMap={map:{}},i=0;i<e.tagColors.length;i++){if(void 0===t.predicate){var n=e.tagColors[i].predicate.split("/"),o=n[n.length-1];t.predicate=o}var r=e.tagColors[i].object;UWA.is(e.tagColors[i].object,"array")&&(r=e.tagColors[i].object.join("/"),this.predicateKind="arrayPredicates"),t.map[r]=e.tagColors[i].color,t.map[e.tagColors[i].dispValue]=e.tagColors[i].color}this.colorizeNodes()}},colorizeNodes:function(){var e=this,t=p[this.colorMap.predicate]||this.colorMap.predicate;e.options.view.columns.find((e=>e.dataIndex===t))?e.options.model.withTransactionUpdate((function(){e.options.model.getAllDescendants().forEach((function(i){if(i.isVisible()&&!i.options.virtual){var n=t?i.options[t]?i.options[t]:i.options.grid[t]:void 0,o=null;if("date"===e.predicateKind){var r=new Date(n),a=r.getFullYear()+"/"+(r.getMonth()+1).toString().padStart(2,"0")+"/"+r.getDate().toString().padStart(2,"0"),s=r.getFullYear()+"/"+(r.getMonth()+1).toString().padStart(2,"0"),l=r.getFullYear();o=e.colorMap.map[a]?e.colorMap.map[a]:e.colorMap.map[s]?e.colorMap.map[s]:e.colorMap.map[l]?e.colorMap.map[l]:"rgba(0, 0, 0, 0)"}else"type"===t?o=e.colorMap.map[i.options.grid[t]]?e.colorMap.map[i.options.grid[t]]:"rgba(0, 0, 0, 0)":o||(o=e.colorMap.map[i.options[t]]?e.colorMap.map[i.options[t]]:e.colorMap.map[i.options.grid[t]]?e.colorMap.map[i.options.grid[t]]:"rgba(0, 0, 0, 0)");o||(o=e.colorMap.map[n]?e.colorMap.map[n]:"rgba(0, 0, 0, 0)");var c={color:o,isBeingCut:!1,grid:{bi_color:o}};i.updateOptions(c)}}))})):(n.alertMessage("error",null,c.error_filter_colorize_predicate),this.onFilterBIUnColorize())},onFilterBIUnColorize:function(){var e=this;this.colorizeActivated=!1,e.options.model.withTransactionUpdate((function(){e.options.model.getRealRoots().forEach((function(e){var t={color:"rgba(0, 0, 0, 0)",grid:{bi_color:"rgba(0, 0, 0, 0)"}};e.updateOptions(t),e.getAllDescendants().forEach((function(e){e.updateOptions(t)}))}))}))},onFilterBIFilteringEvent:function(e){var t=this;(t.getAllModels?t.getAllModels():[t.options.model]).forEach((function(i){i.withTransactionUpdate((function(){i.getRoots(!0).slice(0).forEach((function(e){e.filterIn(!0)}));var n=i.getRealRoots(!0).slice(0);n.forEach((function(e){e.filterIn(!0)}));var o=e.filteredSubjectList;if(o){for(var r=e.nodes,a=[],s={},l=function(e){return r[e]},c=0;c<o.length;c++){var d=o[c];s.hasOwnProperty(d)||a.push(d.map(l))}a.forEach((function(e){i.getNodesByIDPath(e).forEach((function(e){e._filterStatus="IN",e.getParents().forEach((function(e){e._filterStatus="IN"}))}))}));var u=function e(t,i){if("IN"===t._filterStatus){var n=t.getChildren();n&&n.length>0&&n.slice(0).forEach((function(t){e(t)}))}else t.filterOut(),i&&i.push(t),!0;delete t._filterStatus};n.forEach((function(e){u(e);var t=!1;if(e.options._childrenFilterInfo){var i=e.options._childrenFilterInfo.filteredOutChildren;i&&i.length>0&&(t=!0)}t&&(e.setState({state:"partiallyExpanded"}),e.options.padstate="partiallyExpanded"),t=!1}))}else console.error("Invalid Argument : %o",e);t.onSetPathTags()}))}))},onFilterSave:function(e){let t=e.rootId;s.getKindOfRFLP([t]).then((function(t){if(t&&"L"===t[0]){var i=widget.getValue("ngFilter");i?(i=JSON.parse(i)).filterId=e.filterId:i=e,widget.setValue("ngFilter",JSON.stringify(i))}}))},onFilterClose:function(){},_createProxy:function(){var e=this,t={tenant:o.getTenant(),processingMode:"appProcessing",colorize:!0,widgetId:widget.id,appId:widget.id,ExpandSynthesisON:!0};UWA.is(e.onFilterFilteringEvent,"function")&&(t.events={addFilterChangeListener:e.onFilterFilteringEvent.bind(e)}),e._biFilter=new i(t),e._biFilter.addEvent("TagsLoadingComplete",e.onTagsLoadingComplete,e),e._biFilter.addEvent("SaveNGFilter",e.onFilterSave,e),e._biFilter.addEvent("NGFilter_Close",e.onFilterClose,e),e._biFilter.addEvent("FilterBIColorize",e.onFilterBIColorize,e),e._biFilter.addEvent("FilterBIUnColorize",e.onFilterBIUnColorize,e),e._biFilter.addEvent("FilterBIFilteringEvent",e.onFilterBIFilteringEvent,e);var n=e.options.model;if(void 0!==n&&(e.options.model.getModelEvents().subscribe({event:"onRootAdded"},e.onSetTagsWithExpandSynthesis.bind(e)),e.options.model.getModelEvents().subscribe({event:"colorizeNodesFromTagger"},(function(){e.colorizeActivated&&e.colorizeNodes()}))),UWA.is(e._biFilter.setNGFilterOptions,"function")){var r={expandServices:["progressive","expand"],appId:widget.id};e._biFilter.setNGFilterOptions(r),e._biFilter.addEvent("ApplyNGFilter",e.onApplyNGFilter,e),void 0!==n&&(e.options.model._isVolumeFilter=!0)}e.filterInitialized=!0,e.dispatchEvent("filterInitialized",e.filterInitialized)},updateModel:function(e){var t=this;t.options.view=e,t.options.model=e.treeDocument,t.options.model.getModelEvents().subscribe({event:"onRootAdded"},t.onSetTagsWithExpandSynthesis.bind(t)),t.options.model.getModelEvents().subscribe({event:"colorizeNodesFromTagger"},(function(){t.colorizeActivated&&t.colorizeNodes()})),t.options.model._isVolumeFilter=!0},retrieveFilterInfo:function(e,t){var i=this,n=t.objectId;i._biFilter.retrieveFilters({filterObjects:[t],droppedEnvId:widget.getValue("x3dPlatformId"),doNotFillTheTagger:!1,callback:i.processFilterInfo.bind(i,e,n)})},processFilterInfo:function(e,t,i){var r=this;let l=function(){let e=widget.getValue("previouslyOpenedItems");if(e){e=JSON.parse(e);let i=e.indexOf(t);i>=0&&e.splice(i,1),widget.setValue("previouslyOpenedItems",JSON.stringify(e))}};if(i&&Array.isArray(i.success)&&i.success.length>0){var p=i.success[0],g=p.rootId;p.filter||(widget.deleteValue("currentOpenedItem"),widget.deleteValue("currentlyOpenedItems"),widget.setValue("currentView","LandingPage"),widget.deleteValue("ngFilter"),g&&e.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:g}),a.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"}));var f={filterRootIds:[g],empty:!1,filterName:p.filterName?p.filterName:null,filterTitle:p.filterTitle,filterId:t,CVQuery:p.filter?p.filter.CVQuery:null,CVQueryV2:p.filter?p.filter.CVQueryV2:null};if(e.itemId!==g)s.getKindOfRFLP([g]).then((function(t){if(t&&"L"===t[0]){var i=a.getFLWebModelEventsObj("flcockpit-content-list-view"),s=i.subscribe({event:"content-list-view-refresh-complete"},(function(e){i.unsubscribe(s),r.crRecTimeoutToCheckTreeDocExp(e,f)}));e.load(g,!1,!0)}else{n.alertMessage("error",null,c.error_invalid_filter),l();var d=widget.getValue("ngFilter");if(d&&d.length>0){var p=JSON.parse(d);p.filterId?(g&&e.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:g}),e.contentListView.catflBIFilter._biFilter.retrieveFilters({filterObjects:[{envId:o.getTenant(),serviceId:"3DSpace",contextId:"ctx::"+o.getSecurityContext(),objectId:p.filterId,objectType:u.type_act_advfilter,displayName:p.filterTitle}],droppedEnvId:o.getTenant(),doNotFillTheTagger:!1})):(e.contentListView.catflBIFilter._biFilter.resetNGFilterUI({appId:widget.id,widgetId:widget.id,rootIds:[e.itemId]}),e.contentListView.catflBIFilter._biFilter.removeRoot(e.itemId),f={filterRootIds:[e.itemId],empty:!0,filterName:""},n.alertMessage("warning",null,c.warn_clear_filter),e.contentListView.catflBIFilter._biFilter.dispatchEvent("ApplyNGFilter",f))}else widget.getValue("currentOpenedItem")?g&&(e.contentListView.catflBIFilter._biFilter.resetNGFilterUI({appId:widget.id,widgetId:widget.id,rootIds:[g]}),e.contentListView.catflBIFilter._biFilter.removeRoot(g)):(widget.deleteValue("X3DContentId"),widget.deleteValue("currentOpenedItem"),widget.deleteValue("currentlyOpenedItems"),widget.setValue("currentView","LandingPage"),widget.deleteValue("ngFilter"),g&&(e.contentListView.catflBIFilter._biFilter.resetNGFilterUI({appId:widget.id,widgetId:widget.id,rootIds:[g]}),e.contentListView.catflBIFilter._biFilter.removeRoot(g)),a.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"}))}}));else{if(d.disableIndexAcceleration)return void n.alertMessage("warning",null,c.warn_filter_only_indexed_mode);r.onSetTagsWithExpandSynthesis(),e.contentListView.catflBIFilter._biFilter.dispatchEvent("ApplyNGFilter",f)}}else if(i&&Array.isArray(i.failure)&&i.failure.length>0){n.alertMessage("error",null,c.error_invalid_filter),l();let t,i=widget.getValue("ngFilter"),s=widget.getValue("currentOpenedItem");if(i&&i.length>0){t=JSON.parse(i);let n={envId:o.getTenant(),serviceId:"3DSpace",contextId:"ctx::"+o.getSecurityContext(),objectId:t?t.filterId:s,objectType:u.type_act_advfilter,i3dx:"",displayType:c.action_adv_filter};r.retrieveFilterInfo(e,n)}else s?e.load(s,!1):a.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"})}},crRecTimeoutToCheckTreeDocExp:function(e,t){var i=this;if(e.contentListView&&e.contentListView.contentView.treeDocument)if(e.contentListView.contentView.treeDocument.isExpanding())setTimeout((function(){i.crRecTimeoutToCheckTreeDocExp(e,t)}),200);else{if(d.disableIndexAcceleration)return void n.alertMessage("warning",null,c.warn_filter_only_indexed_mode);e.contentListView.catflBIFilter._biFilter.dispatchEvent("ApplyNGFilter",t)}}})})),define("DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment",["DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/Handlebars/Handlebars","DS/DataGridView/DataGridView","DS/Windows/Dialog","DS/Controls/Button","DS/UIKIT/Mask","DS/CATFLCockpitWidget/services/space.service","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/utils/model.events.util","text!DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f){"use strict";var m=c.getFullConfig(),h=m.identifiers,v=m.localStorageKeys,C={main:i.compile(g)},y=function(e){this.logicalRef=e;var t=this;l.checkToUpdateSpace([e]).then((function(i){t.pilotingDisciplineWarnMsg=null,"WARNING_PILOTDISC"===i[e.options.physicalid]&&(t.pilotingDisciplineWarnMsg=f.msg_has_piloting_discipline_warn),t.render()}),(function(e){d.displayError(e,null,null,f.msg_generic_error_get_failed)}))};return y.prototype.render=function(){var e=this;e.dialog=new o({title:f.action_assign_space+" - "+e.logicalRef.options.label,content:C.main({labelSpaceConceptRoot:f.label_space_concept_root,labelNoSelection:f.message_no_space_concept_root_selected,iconTooltip:f.select_space_concept_root,warningMsg:e.pilotingDisciplineWarnMsg}),height:500,width:700,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new r({label:f.label_assign,emphasize:"primary",disabled:!0,onClick:function(){a.mask(e.dialog.elements._mainContentDiv,f.msg_processing);var t=e.treeDocument.getSelectedNodes(),i=e.logicalRef.options.assignedSpacesPID,n=[],o=[];i&&i.length>0&&(e.treeDocument.getAllDescendants().forEach((function(e){i.forEach((function(t){e.options.physicalid!==t.obj||e.isSelected()||n.push(t.owner)}))})),n.length>0&&o.push(s.deleteSPPConnection(n,[e.logicalRef]))),t.length>0&&(t=t.filter((function(e){if(i&&i.length>0)for(var t=0;t<i.length;t++)if(e.options.physicalid===i[t].obj)return!1;return!0}))).length>0&&o.push(s.createSPPConnection([e.logicalRef],t)),Promise.all(o).then((function(){p.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-spaces-by-id",data:[e.logicalRef]}),e.dialog.close()})).catch((function(){a.unmask(e.dialog.elements._mainContentDiv)}))}}),Cancel:new r({emphasize:"secondary",onClick:function(){e.dialog.close()}})}}),e.dialog.addEventListener("close",(function(){e.dialog.destroy()})),e.dialog.elements.container.classList.add("flweb-space-assigment-panel"),new r({label:f.label_search,emphasize:"primary",icon:{iconName:"search"}}).inject(e.dialog.elements.container.querySelector(".search-icon")).getContent().addEventListener("buttonclick",(function(){u.launchSearch({searchTitle:f.label_search_spConceptRoot,allowedTypes:h.type_spaceRoot,role:"",criteria:h.type_spaceRoot,bMultiSel:!1,in_apps_callback:function(t){e._loadSpaceHierarchy(t[0].id,t[0]["ds6w:label"],t[0]["ds6wg:revision"])}})}));var t=widget.getValue(v.previousSpaceHierarchy);t&&(t=JSON.parse(t),e._loadSpaceHierarchy(t.id,t.label,t.revision))},y.prototype._loadSpaceHierarchy=function(e,t,i){var n=this;s.getSpaceHierarchy(e).then((function(o){o.length>1&&(n.dialog.elements.container.querySelector(".label-space-concept-root-name").textContent=t,widget.setValue(v.previousSpaceHierarchy,JSON.stringify({id:e,label:t,revision:i})),n._createDataGridView(t,i,o,n.logicalRef.options.assignedSpacesPID))}))},y.prototype._createDataGridView=function(i,o,r,a){var s=this;s.treeDocument=new e({useAsyncPreExpand:!0}),s.treeDocument.prepareUpdate(),s.treeDocument.options.shouldBeSelected=function(e){return e.options.type===h.type_design_ref};var l=s.treeDocument.addChild(new t({label:i,isSpaceRoot:!0,icons:[{iconPath:c.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_SppSpaceConceptRoot.png",iconSize:{height:"16px",width:"16px"}}],grid:{revision:o}}));r.forEach((function(e){s._parseSpaceNode(l,e)})),a&&l.getAllDescendants().forEach((function(e){for(var t=0;t<a.length;t++)a[t].obj===e.options.physicalid&&e.select()})),s.treeDocument.getXSO().onPostAdd(s._activateOkButton.bind(s)),s.treeDocument.getXSO().onPostRemove(s._activateOkButton.bind(s)),s.treeDocument.setFilterModel({label:{filterId:"stringRegexp"},revision:{filterId:"stringRegexp"}}),s.treeDocument.pushUpdate(),s.treeDocument.expandAll();var d=new n({identifier:"SystemArchitectureRelease_SpaceAssignment",height:"inherit",treeDocument:s.treeDocument,selectionBehavior:{unselectAllOnEmptyArea:!1},columns:[{text:c.getNlsBasicAttributesBO("ds6w:label"),dataIndex:"tree",alwaysVisibleFlag:!0,pinned:"left"},{text:c.getNlsBasicAttributesBO("ds6wg:revision"),dataIndex:"revision"},{text:c.getNlsBasicAttributesBO("ds6w:description"),dataIndex:"description"},{text:c.getNlsBasicAttributesBO("ds6w:isLastRevision"),dataIndex:"isLastVersion",typeRepresentation:"boolean",width:95,visibleFlag:!1},{text:c.getNlsBasicAttributesBO("ds6w:modified"),dataIndex:"modificationDate",typeRepresentation:"datetime",semantics:{timePickerPrecision:"sec"},visibleFlag:!1},{text:c.getNlsBasicAttributesBO("ds6w:created"),dataIndex:"creationDate",typeRepresentation:"datetime",semantics:{timePickerPrecision:"sec"},visibleFlag:!1},{text:c.getNlsBasicAttributesBO("ds6w:status"),dataIndex:"maturity",visibleFlag:!1},{text:c.getNlsBasicAttributesBO("ds6w:responsible"),dataIndex:"owner",visibleFlag:!1},{text:c.getNlsBasicAttributesBO("ds6w:reserved"),dataIndex:"isReserved",typeRepresentation:"boolean",width:95,visibleFlag:!1},{text:c.getNlsBasicAttributesBO("ds6w:type"),dataIndex:"type",visibleFlag:!1}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},sortModel:[{dataIndex:"tree",sort:"asc"}]}),u=s.dialog.elements._contentDiv.querySelector(".dgv-container");u.innerHTML="",u.appendChild(d.getContent())},y.prototype._parseSpaceNode=function(e,i){var n=this;if(void 0===i.icons){var o=e.addChild(new t({physicalid:i.physicalid,label:i.title,type:i.type,grid:{description:i.description,isLastVersion:"TRUE"===i.isLastRevision,maturity:m.MAPPING_MATURITY[i.maturityState],type:i.nlsType,owner:i.ownerFullName,isReserved:"TRUE"===i.reservation,revision:i.revision}}));o.options.icons=[{iconSize:{height:"16px",width:"16px"}}],o.options.type===h.type_space_concept_node?o.options.icons[0].iconPath=c.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_SppSpaceConceptNode.png":o.options.type===h.type_design_ref&&(o.options.icons[0].iconPath=c.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_3DPart.png"),o.options.grid.creationDate=d.formatDate(i.creationDate),o.options.grid.modificationDate=d.formatDate(i.modificationDate),i.children&&i.children.forEach((function(e){n._parseSpaceNode(o,e)}))}},y.prototype._activateOkButton=function(){this.dialog.buttons.Ok.disabled=!1},y})),define("DS/CATFLCockpitWidget/utils/checkArchitectureNumberUnicity.util",["UWA/Core","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/utils/xhr.util","DS/TreeModel/BaseFilter","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r){"use strict";return{updateEffectivityCompiledFormForNodes:function(e){var t=[],n={};return e&&e.forEach((function(e,i){e.options.instance&&e.options.instance.physicalid&&(t.push(e.options.instance.physicalid),n[e.options.instance.physicalid]=e)})),t.length>0?i.fetch(t,["ro.plminstance.v_effectivitycompiledform"]).then((function(e){if(e)for(var t=0;t<e.length;t++){var i=n[e[t].resourceid.value];i.options.instance.effectivitycompiledform=void 0,e[t]["ro.plminstance.v_effectivitycompiledform"]&&void 0!==e[t]["ro.plminstance.v_effectivitycompiledform"]&&(i.options.instance.effectivitycompiledform=e[t]["ro.plminstance.v_effectivitycompiledform"].value)}})):Promise.resolve()},updateDisplayedEffectivityForNodes:function(e){var i={};return t.getEffectivityInfo(e).then((function(e){for(var t in e){var n=e[t];if(n.content){if(i[t]={},n.content.Evolution){var o=n.content.Evolution.Current;i[t].evolution=o?o.replace(/(\r\n|\n|\r)/gm," "):""}if(n.content.Variant){var r=n.content.Variant;i[t].variant=r?r.replace(/(\r\n|\n|\r)/gm," "):""}}}return i}))},getInstancesWithDuplicatedAN:function(e){var t=e||[];return(t=t.filter((function(e){return e.options.grid.architectureNumber}))).length<1?null:(t=t.reduce((function(e,t){return e[[t.options.grid.architectureNumber]]=(e[t.options.grid.architectureNumber]||[]).concat(t),e}),{}),t=Object.values(t).filter((function(e){return e.length>=2})),t=[].concat.apply([],t))},checkANOnEvolution:function(e,i,o){var r=this,a=[],s=[];return i.forEach((function(e,i){s.push(t.createVolatileFilter({modelID:o.physicalid,modelName:o.name,modelVerName:e.name,modelVerRev:e.revision}))})),n.makeMultipleServiceCalls(s,!0).then((function(n){return n.forEach((function(e,t){a.push({FilterCompiledForm:e.filterBinaryForExpand,mv:i[t]})})),t.allFilterValidation(e,a,!0).then((function(e){return r.calculIntersection(e)}))}))},checkANOnVariant:function(e,i){var n=this,o=[];return i.forEach((function(e,t){e.productConfiguration.attributes.FilterCompiledForm&&o.push({FilterCompiledForm:e.productConfiguration.attributes.FilterCompiledForm,mv:e.modelversion,pc:e.productConfiguration})})),o.length>0?t.allFilterValidation(e,o,!0).then((function(e){return n.calculIntersection(e)})):Promise.reject(new Error("all_PC_empty"))},calculIntersection:function(e){var t={};return e&&e.length>0&&e.forEach((function(e,i){var n=e.instances.reduce((function(e,t){return e[[t.nodeInstance.options.grid.architectureNumber]]=(e[t.nodeInstance.options.grid.architectureNumber]||[]).concat(t),e}),{});for(var o in n){var r=n[o].reduce((function(e,t){return e[[t.filterValidationStatus]]=(e[t.filterValidationStatus]||[]).concat(t),e}),{});t[o]||(t[o]={}),r.valid&&r.valid.length>0&&r.valid.forEach((function(i,n){t[o][i.nodeInstance.options.instance.physicalid]||(t[o][i.nodeInstance.options.instance.physicalid]={nodeInstance:i.nodeInstance,intersectionEffectivity:[]}),r.valid.length>=2&&t[o][i.nodeInstance.options.instance.physicalid].intersectionEffectivity.push({modelversion:e.modelversion,productConfiguration:e.productConfiguration})})),r.invalid&&r.invalid.length>0&&r.invalid.forEach((function(e,i){t[o][e.nodeInstance.options.instance.physicalid]||(t[o][e.nodeInstance.options.instance.physicalid]={nodeInstance:e.nodeInstance,intersectionEffectivity:[]})}))}})),t},createFilterForArraysValues:function(){return o.inherit({publishedProperties:{},isDataFiltered:function(e){var t=e.getAttributeValue(this.propertyId);return!t||!!(t&&this.filterModel&&this.filterModel.selectedValues)&&!this.filterModel.selectedValues.every((e=>t.includes(e)))},isEmpty:function(){return!this.filterModel||void 0===this.filterModel.selectedValues}})},registerFilterForArraysValues:function(e){var t=e.getFilterManager(),i=this.createFilterForArraysValues();t.registerFilter("stringArray",i)}}})),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.columns",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/dimensions.service","DS/CATFLCockpitWidget/services/predicate.service","DS/CATFLCockpitWidget/utils/model.events.util","DS/Utilities/StringUtils","DS/Utilities/Utils","DS/CATFLCockpitWidget/utils/maturity.util","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u){"use strict";var p=e.getFullConfig(),g=p.identifiers,f=p.localStorageKeys;const m={icon:{iconName:"lock-open",fontIconFamily:1},label:"",url:"#UNEXISTANT_ID"},h={icon:{iconName:"key",fontIconFamily:1,className:"sax-lockedBy"},label:"",url:"#UNEXISTANT_ID"},v={icon:{iconName:"lock",fontIconFamily:1,className:"sax-lockedByOther"},label:"",url:"#UNEXISTANT_ID"};return{getDataGridViewColumns:async function(e){var t=this;t.contentView=e;var i=e.invalidateLayout.bind(e),n=t.getBaseColumns(i);return t.addAdditionalColumns(n,i),await t.addUserAdditionalColumns(n,i),n},getBaseColumns:function(t){var i=this,n=new Intl.Collator,o=[{value:!0,icon:{iconName:"check",fontIconFamily:1,className:"sax-is-last-version-true"}},{value:!1,icon:{iconName:"close",fontIconFamily:1,className:"sax-is-last-version-false"}}];return[{text:e.getNlsBasicAttributesBO("ds6w:label"),dataIndex:"tree",editableFlag:!0,sortableFlag:!0,alwaysVisibleFlag:!0,pinned:"left",width:300,setCellValue:i._defaultSetCellValue.bind(i,t,"title"),getCellEditableState:i._defaultGetCellEditableState,compareFunction:function(e,t,i,o){var r=i.options.type,a=o.options.type;return"attachedDocumentsCategory"===r?-1:"attachedDocumentsCategory"===a?1:"specificationDocumentsCategory"===r?-1:"specificationDocumentsCategory"===a?1:"proposedSolutionCategory"===r?-1:"proposedSolutionCategory"===a?1:"implementLinksCategory"===r?-1:"implementLinksCategory"===a?1:s.compareLocal(e,t,{intlCollator:n})}},{text:u.action_cue_status,dataIndex:"cue",alignment:"center",typeRepresentation:"icon",sortableFlag:!0,compareFunction:function(e,t){return e===t?0:"group"===e?-1:"group"===t?1:"alert"===e?-1:"alert"===t?1:"status-ko"===e?-1:"status-ko"===t?1:"attention"===e?-1:"attention"===t?1:"info"===e?-1:"info"===t?1:"status-ok"===e?-1:"status-ok"===t?1:void 0},groupableFlag:!1},{text:e.getNlsBasicAttributesBO("ds6wg:revision"),dataIndex:"revision",getCellTypeRepresentation:i._getCellTypeResentation.bind(null,"revision"),hyperlinkTarget:"_self",getCellValue:i._defaultGetCellValueForClickableColumn.bind(i,"revision"),getCellGroupingKey:i._getCellGroupingKey.bind(i,"revision")},{text:e.getNlsBasicAttributesBO("ds6w:isLastRevision"),dataIndex:"isLastVersion",typeRepresentation:"customBoolean",width:95,getCellSemantics:function(){return{possibleValues:o}},getCellGroupingKey:i._getCellGroupingKey.bind(i,"isLastVersion")},{text:e.getNlsBasicAttributesBO("ds6w:label"),icon:{iconName:"object-instance"},dataIndex:"instanceName",editableFlag:!0,setCellValue:i._defaultSetCellValue.bind(i,t,"instanceName"),getCellEditableState:i._defaultGetCellEditableState,getCellGroupingKey:i._getCellGroupingKey.bind(i,"instanceName")},{text:e.getNlsBasicAttributesBO("ds6w:status"),dataIndex:"maturity",typeRepresentation:"tag",hyperlinkTarget:"_self",getCellValue:i._defaultGetCellValueForClickableColumn.bind(i,"maturity"),getCellGroupingKey:i._getCellGroupingKey.bind(i,"maturity"),getCellClassName:i._getCellClassName.bind(i,"maturity")},{text:e.getNlsBasicAttributesBO("ds6w:responsible"),dataIndex:"owner",typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:i._defaultGetCellValueForClickableColumn.bind(i,"owner"),getCellGroupingKey:i._getCellGroupingKey.bind(i,"owner")},{text:e.getNlsBasicAttributesBO("ds6w:reserved"),dataIndex:"isReserved",alignment:"center",typeRepresentation:"icon",width:95,getCellValue:i._getCellValueforLockColumns.bind(i,"isReserved"),getCellGroupingKey:i._getCellGroupingKey.bind(i,"isReserved"),getCellClassName:i._getCellClassName.bind(i,"isReserved")},{text:e.getNlsBasicAttributesBO("ds6w:modified"),dataIndex:"modificationDate",typeRepresentation:"datetime",semantics:{timePickerPrecision:"sec"},getCellValue:i._defaultGetCellValueForDate.bind(i,"modificationDate")},{text:e.getNlsBasicAttributesBO("ds6w:description"),dataIndex:"description",editableFlag:!0,setCellValue:i._defaultSetCellValue.bind(i,t,"description"),getCellEditableState:i._defaultGetCellEditableState,typeRepresentation:"multilineString",editionPolicy:"EditionOnClick"},{text:e.getNlsBasicAttributesBO("ds6w:description"),icon:{iconName:"object-instance"},dataIndex:"instance_description",setCellValue:i._defaultSetCellValue.bind(i,t,"instance_description"),visibleFlag:!1,editableFlag:!0,typeRepresentation:"multilineString",editionPolicy:"EditionOnClick"},{text:e.getNlsBasicAttributesBO("ds6w:type"),dataIndex:"type"},{text:e.getNlsBasicAttributesBO("ds6w:identifier"),dataIndex:"name"},{text:e.getNlsBasicAttributesBO("ds6w:created"),dataIndex:"creationDate",typeRepresentation:"datetime",semantics:{timePickerPrecision:"sec"},getCellValue:i._defaultGetCellValueForDate.bind(i,"creationDate")},{text:u.label_arch_no,dataIndex:"architectureNumber",getCellTypeRepresentation:i._getCellTypeResentation.bind(null,"architectureNumber"),hyperlinkTarget:"_self",getCellValue:i._defaultGetCellValueForClickableColumn.bind(i,"architectureNumber"),getCellGroupingKey:i._getCellGroupingKey.bind(i,"architectureNumber")},{text:u.label_assigned_spaces,dataIndex:"assignedSpaces",typeRepresentation:"url",hyperlinkTarget:"_self",sortableFlag:!1,groupableFlag:!1,getCellValue:i._defaultGetCellValueForClickableColumn.bind(i,"assignedSpaces"),getCellGroupingKey:i._getCellGroupingKey.bind(i,"assignedSpaces")},{text:e.getNlsBasicAttributesRel("ds6w:reserved"),dataIndex:"instance_isReserved",icon:{iconName:"object-instance"},alignment:"center",typeRepresentation:"icon",getCellValue:i._getCellValueforLockColumns.bind(i,"instance_isReserved"),visibleFlag:!1,getCellGroupingKey:i._getCellGroupingKey.bind(i,"instance_isReserved"),getCellClassName:i._getCellClassName.bind(i,"instance_isReserved")},{text:e.getNlsBasicAttributesBO("ds6w:reservedBy"),dataIndex:"reservedBy",typeRepresentation:"string",visibleFlag:!1},{text:e.getNlsBasicAttributesRel("ds6w:reservedBy"),dataIndex:"instance_reservedBy",icon:{iconName:"object-instance"},typeRepresentation:"string",visibleFlag:!1}]},addAdditionalColumns:function(e){let t=this;if(p.gridview&&p.gridview._additionalColumns){let i=p.gridview._additionalColumns;i.forEach((function(e){let i={groupableFlag:!1};"VariantEffectivity"===e.dataIndex&&(i={typeRepresentation:"url",hyperlinkTarget:"_self",getCellTypeRepresentation:t._getCellTypeResentation.bind(t,"VariantEffectivity"),getCellValue:t._defaultGetCellValueForClickableColumn.bind(t,"VariantEffectivity")}),"ConfigurationRevision"===e.dataIndex&&(i.getCellValue=function(e){return e.nodeModel.options.grid.ConfigurationRevision||""===e.nodeModel.options.grid.ConfigurationRevision||(e.nodeModel.options.grid.ConfigurationRevision=""),e.nodeModel.options.grid.ConfigurationRevision}),UWA.extend(e,i)})),e.push(...i)}},addUserAdditionalColumns:async function(e,i){var n=this,o=t.getUserCustomAttributes()||[],a=t.getUserCustomAttributes(!0)||[],s=o.concat(a),c=await r.getNLSPredicates(s);s.forEach((function(t){var o={text:c[t.curi]||t.curi,typeRepresentation:t.type,isCustomAttribute:!0};if(t.multiLine&&(o.typeRepresentation="multilineString",o.editionPolicy="EditionOnClick"),t.dimension){var r=p.dimensions[t.dimension];t.manipulationUnit?(o.text=o.text+" ("+r.Units[t.manipulationUnit].NLSName+")",o.groupableFlag=!1):o.text=o.text+" ("+r.Units[r.MKSUnit].NLSName+")"}t.readOnly?o.editableFlag=!1:(o.getCellEditableState=n._additionalAttributeGetCellEditableState.bind(n,t),"boolean"===t.type?o.setCellValue=l.debounce(n._additionalAttributeSetCellValue.bind(n,i,t),500):o.setCellValue=n._additionalAttributeSetCellValue.bind(n,i,t)),t.bo?t.isOnPhysicalProduct?(o.dataIndex="physical_"+t.curi,o.icon={iconName:"3dproduct"}):o.dataIndex=t.curi:(o.dataIndex="instance_"+t.curi,o.icon={iconName:"object-instance"});var a=t.isSharedPredicateOnSameType||t.isSharedPredicate&&(t.isClassification||t.isOnExtension);if((t.multiValuated||a)&&(o.editionPolicy="EditionOnClick",o.getCellSemantics=function(){return{allowMultipleValuesFlag:!0}},t.multiLine&&(o.editableFlag=!1,o.getCellEditableState=void 0,o.getCellValue=function(e){var t=e.nodeModel.options.grid[o.dataIndex];return t&&Array.isArray(t)?t.join(" , "):t})),"date"===t.type&&void 0===t.rangeValues&&(o.getCellValue=n._additionalAttributeGetCellValueDate.bind(n,o.dataIndex,t.multiValuated||a)),"boolean"===t.type)t.multiValuated||a||(o.getCellValue=function(e){var t=e.nodeModel.options.grid[o.dataIndex];if(t){if("TRUE"===t.toUpperCase())return!0;if("FALSE"===t.toUpperCase())return!1}});else if(void 0!==t.rangeValues&&t.rangeValues.length>0){o.typeRepresentation="string",o.editionPolicy="EditionOnClick";for(var s=[],d=0;d<t.rangeValues.length;d++)t.rangeValues[d].formatDateValue?s.push(t.rangeValues[d].formatDateValue):s.push(t.rangeValues[d].nlsValue);var u=!1;t.readOnly&&(u=!0),o.getCellSemantics=function(){return{possibleValues:u?null:s,allowMultipleValuesFlag:t.multiValuated||a}}}e.push(o)}))},_getCellTypeResentation:function(e,t){return t.nodeModel?t.nodeModel.options.type!==g.type_act_logref||t.nodeModel.options.virtual?"string":"url":"string"},_defaultGetCellEditableState:function(e){return!(!e.nodeModel||e.nodeModel.options.type!==g.type_act_logref||e.nodeModel.options.virtual)&&!(t.checkIfMaturityIsReleasedOrObsolete(e.nodeModel.options.maturity)||e.nodeModel.options.grid&&e.nodeModel.options.grid.isReservedByOther)},_additionalAttributeGetCellEditableState:function(e,t){var i=!1;return!e.isOnExtension&&!e.isClassification&&e.declaredInArray&&t&&t.nodeModel&&(e.bo&&!e.declaredInArray.includes(t.nodeModel.options.grid.actualType)||!e.bo&&!e.declaredInArray.includes(t.nodeModel.options.grid.instance_actualType))&&(i=!0),!i&&this._defaultGetCellEditableState(t)},_defaultGetCellValueForClickableColumn:function(e,t){var i=t.nodeModel.options.physicalid,n=u.label_none;("architectureNumber"===e&&(t.nodeModel.getParent()&&t.nodeModel.getParent().options.type===g.type_spec_document||"F"===t.nodeModel.options.grid.kindOfRFLP||"R"===t.nodeModel.options.grid.kindOfRFLP||"DIF"===t.nodeModel.options.grid.kindOfRFLP)||(t.nodeModel.isRoot()||t.nodeModel.options.virtual)&&"VariantEffectivity"===e||!i||i.length<=0)&&(n=""),"revision"===e&&t.nodeModel.getParent()&&(n="");var o=t.nodeModel.options.grid[e]||n;let r={label:o,url:"#UNEXISTANT_ID"};switch(e){case"maturity":return o;case"owner":{let e=Object.assign(r,{icon:"fonticon fonticon-user-alt"});return o.length>0&&t.nodeModel.options.type===g.type_act_logref&&!t.nodeModel.options.virtual||"L"===t.nodeModel.options.grid.kindOfRFLP&&t.nodeModel.options.linkInfo&&"implementing"===t.nodeModel.options.linkInfo.linkType&&"ref"===t.nodeModel.options.linkInfo.objType||t.nodeModel.getParent()&&t.nodeModel.getParent().options.type===g.type_spec_document||"DIF"===t.nodeModel.options.grid.kindOfRFLP?e:o.length>0?(delete e.url,e):o}default:return"url"===this._getCellTypeResentation(e,t)?r:o}},_getCellClassName:function(e,t){if(t.nodeModel){if("maturity"===e){let e,i=t.nodeModel.options.maturity??t.nodeModel.options.grid.current;if(i){if("string"!=typeof i)return null;i=i.split(".")[1]??i.split(".")[0],e=t.nodeModel.options.type===g.type_act_logref&&!t.nodeModel.options.virtual||"L"===t.nodeModel.options.grid.kindOfRFLP&&t.nodeModel.options.linkInfo&&"implementing"===t.nodeModel.options.linkInfo.linkType&&"ref"===t.nodeModel.options.linkInfo.objType||t.nodeModel.getParent()&&t.nodeModel.getParent().options.type===g.type_spec_document||"DIF"===t.nodeModel.options.grid.kindOfRFLP?c.getAndCreateMaturityClass(i,!0,!0):c.getAndCreateMaturityClass(i,!1,!1)}return e}if(("isReserved"===e||"instance_isReserved"===e&&!t.nodeModel.isRoot())&&t.nodeModel.options.type===g.type_act_logref&&!t.nodeModel.options.virtual)return"lc-link-class"}},_defaultSetCellValue:function(o,r,s,l){var c=this,g="instanceName"===r||"instance_description"===r;let m=p.adminStatus.ReferenceTitleMaxLength||100;if("title"===r&&(0===l.length||l.length>m)){if(0===l.length)t.alertMessage("error",null,u.msg_mandatory_field_title);else if(l.length>m){let e=u.replace(u.msg_too_long_field_title,{fieldName:u.label_title,maxLength:m});t.alertMessage("error",null,e)}o({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}else{var h;if("instanceName"===r){let e=p.adminStatus.InstanceNameMaxLength||100;if(l.length>e){let i=u.replace(u.msg_too_long_field_title,{fieldName:u.label_instance_title,maxLength:e});return t.alertMessage("error",null,i),void o({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}h=n.updateAttribute([{refID:s.nodeModel.options.physicalid,instID:s.nodeModel.options.instance.physicalid,attributes:{"PLMInstance.PLM_ExternalID":l}}])}else if("instance_description"===r)h=n.updateAttribute([{refID:s.nodeModel.options.physicalid,instID:s.nodeModel.options.instance.physicalid,attributes:{"PLMInstance.V_description":l}}]);else{var v={};"title"===r?v["PLMEntity.V_Name"]=l:"description"===r?v["PLMEntity.V_description"]=l:v[r]=l,h=n.updateAttribute([{refID:s.nodeModel.options.physicalid,attributes:v}])}c.contentView.displayModalLoader(u.msg_processing),h.then((function(n){let u=n&&n[0]&&n[0].body,p=[],m=[];if("title"===r||"description"===r){var h=widget.getValue("currentOpenedItem");h&&h===s.nodeModel.options.physicalid&&a.getFLWebModelEventsObj("flweb-model-events").publish({event:"idcard-refresh"})}var v=n[0].body.modified?t.formatDate(u.modified.value[0]):null;if((c.contentView.treeDocument.getMappedNodesFromId(s.nodeModel.options.physicalid)||[s.nodeModel]).forEach((function(e){if("title"===r)e.options.label=l,e.options.grid.modificationDate=v;else if(g)if(u.oldInstancePhysicalid){let t=e.getParent(),i=new d({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,physicalid:e.options.physicalid,instance:{physicalid:u.physicalid},grid:{physicalid:e.options.physicalid},actualParent:e.options.actualParent,children:[]});i.setRelationID(u.physicalid),t.addChild(i,e._rowID),p.push(i),m.push(e)}else e.options.instance&&e.options.instance.physicalid===s.nodeModel.options.instance.physicalid&&(e.options.grid[r]=l,e.options.instance.modificationDate=v);else e.options.grid[r]=l,e.options.grid.modificationDate=v})),g){if(p.length>0&&m.length>0){s.nodeModel.unselect(),s.nodeModel.getNextNode().select();let e={};e[u.oldInstancePhysicalid]=m,e[u.physicalid]=p;let t=a.getFLWebModelEventsObj("flcockpit-content-list-view");t.publish({event:"refresh-nodes-by-id",data:{arrayOfPID:[m[0].options.physicalid],tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:!0}}),t.publish({event:"refresh-inst-by-id",data:{instIdMap:e,bInstance:!0,bEffectivity:!0}})}let t=widget.getValue("groupingEnabled"),n=s.nodeModel.getParent();t&&!n.getID&&(n=i.getGroupNodeParent(n)),e.SAXStorage().setItem(f.recentlyAuthoredStructure+n.getID(),Date.now())}else e.SAXStorage().setItem(f.recentlyAuthored+s.nodeModel.getID(),Date.now());o({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0});let C=c.contentView.getGroupingOptions();C&&c.contentView.groupRows(C)})).catch((function(){o({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),t.displayError({},u.msg_error_no_modification_possible,null,u.msg_error_modification_not_allowed)})).finally((function(){c.contentView.removeModalLoader(u.msg_processing)}))}},_additionalAttributeSetCellValue:function(e,i,r,a){let s,l,c=this,d=!1;c.contentView.displayModalLoader(u.msg_processing);var g=Array.isArray(a),f=null;if(void 0!==i.rangeValues){if(g){var m=[];if("string"===i.type||"date"===i.type){f=a.slice();for(var h=0;h<a.length;h++){let e=i.rangeValues.find((function(e){return e.formatDateValue?new Date(e.formatDateValue).getTime()===new Date(a[h]).getTime():e.nlsValue===a[h]}));void 0!==e?m.push(e.value):m.push(a[h])}a=m}}else if("string"===i.type||"date"===i.type){f=a;let e=i.rangeValues.find((function(e){return e.formatDateValue?new Date(e.formatDateValue).getTime()===new Date(a).getTime():e.nlsValue===a}));void 0!==e&&(a=e.value)}}else i.manipulationUnit&&i.manipulationUnit!==p.dimensions[i.dimension].MKSUnit?(d=!0,g&&a.length<=0&&(d=!1)):"boolean"!==i.type||g?"integer"!==i.type&&"number"!==i.type||g?"date"===i.type&&(a=g?a.map((function(e){return e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+"@12:00:00:GMT"})):a.getFullYear()+"/"+(a.getMonth()+1)+"/"+a.getDate()+"@12:00:00:GMT"):a=a.toString():a=a.toString().toUpperCase();var v=!1;if(r.cellModel&&(g&&a.length===r.cellModel.length?("date"===i.type&&a.every(((e,t)=>new Date(e).getTime()===new Date(r.cellModel[t]).getTime()))||a.every(((e,t)=>e===r.cellModel[t])))&&(v=!0):("date"===i.type&&new Date(a).getTime()===new Date(r.cellModel).getTime()||a===r.cellModel)&&(v=!0)),v)return void c.contentView.removeModalLoader(u.msg_processing);let C={refID:r.nodeModel.options.physicalid,attributes:{}},y=function(i,n){if(e({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),i&&i.error&&i.error.errorList&&i.error.errorList[0]&&i.error.errorList[0].errors){var o=i.error.errorList[0].errors.map((e=>e.message)).join(". ");t.displayError({},u.msg_error_no_modification_possible,null,o)}else n.isOnExtension?t.displayError({},u.msg_error_no_modification_possible,null,u.msg_error_edit_attributes_on_extensions_failed):t.displayError({},u.msg_error_no_modification_possible,null,u.msg_error_modification_not_allowed)};var b=i.selectable;if(void 0===b.length){var _=null;(_=!i.bo&&r.nodeModel.options.instance?r.nodeModel.options.grid.instance_actualType:r.nodeModel.options.grid.actualType)&&(b=i.selectable[_])}if(i.manipulationUnit?(a=g?a.map((e=>e.toString())):a.toString(),C.attributes[b]={unitName:i.manipulationUnit,dimensionType:i.dimension,value:a}):C.attributes[b]=a,!i.bo&&r.nodeModel.options.instance&&(C.instID=r.nodeModel.options.instance.physicalid),d){let t=[{UnitFrom:i.manipulationUnit,UnitTo:p.dimensions[i.dimension].MKSUnit,Dimension:i.dimension,Values:g?a:[a]}];l=o.convertValues(t).then((function(t){t.Response&&(s=UWA.is(t.Response[0].ConvertedValues,"string")?t.Response[0].ConvertedValues.split(";")[0]:t.Response[0].ConvertedValues[0],n.updateAttribute([C]).then((function(t){c._checkUpdateAttributeResults(e,t,r,i,b,a,f,s)})).catch((function(e){y(e,i)})))}))}else l=i.manipulationUnit?n.updateAttribute([C]).then((function(t){c._checkUpdateAttributeResults(e,t,r,i,b,a,f,a)})).catch((function(e){y(e,i)})):n.updateAttribute([C]).then((function(t){c._checkUpdateAttributeResults(e,t,r,i,b,a,f)})).catch((function(e){y(e,i)}));l.finally((function(){c.contentView.removeModalLoader(u.msg_processing);let e=c.contentView.getGroupingOptions();e&&c.contentView.groupRows(e)}))},_defaultGetCellValueForDate:function(e,i){if(i&&i.nodeModel&&i.nodeModel.options.grid[e])return t.formatDate(i.nodeModel.options.grid[e])},_getCellValueforLockColumns:function(e,t){if("isReserved"===e){if(!t.nodeModel.options.grid.isReserved||!t.nodeModel.options.isReserved)return;return"FALSE"===t.nodeModel.options.isReserved?(t.nodeModel.options.grid.lockTooltipRef=u.notLocked+"\n"+u.clickToLock,m.icon):t.nodeModel.options.grid.isReservedByOther?(t.nodeModel.options.grid.lockTooltipRef=u.onlyLockedBy+" "+t.nodeModel.options.grid.reservedBy+"\n"+u.clickToUnlock,v.icon):(t.nodeModel.options.grid.lockTooltipRef=u.onlyLockedBy+" "+t.nodeModel.options.grid.reservedBy+"\n"+u.clickToUnlock,h.icon)}if("instance_isReserved"===e){if(!t.nodeModel.options.grid.isReserved||!t.nodeModel.options.isReserved||t.nodeModel.isRoot())return;return void 0===t.nodeModel.options.instance_isReserved&&(t.nodeModel.options.instance_isReserved="FALSE",t.nodeModel.options.grid.instance_isReserved=u.notLocked),"FALSE"===t.nodeModel.options.instance_isReserved?(t.nodeModel.options.grid.lockTooltipIns=u.notLocked+"\n"+u.clickToLock,m.icon):t.nodeModel.options.grid.instance_isReservedByOther?(t.nodeModel.options.grid.lockTooltipIns=u.onlyLockedBy+" "+t.nodeModel.options.grid.instance_reservedBy+"\n"+u.clickToUnlock,v.icon):(t.nodeModel.options.grid.lockTooltipIns=u.onlyLockedBy+" "+t.nodeModel.options.grid.instance_reservedBy+"\n"+u.clickToUnlock,h.icon)}},_additionalAttributeGetCellValueDate:function(e,i,n){if(n&&n.nodeModel){var o=n.nodeModel.getAttributeValue(e);return o?i?(Array.isArray(o)?o:o.split(",")).map((function(e){return t.formatDate(e)})):t.formatDate(o):o}},_checkUpdateAttributeResults:function(i,n,o,r,s,l,c,p){var g=n[0].body.modified?t.formatDate(n[0].body.modified.value[0]).getTime():null,m=new Date(o.nodeModel.options.grid.modificationDate).getTime(),h=g!==(o.nodeModel.options.instance?new Date(o.nodeModel.options.instance.modificationDate).getTime():null);if(g!==m&&r.bo||h&&!r.bo){let i={grid:{}},s=!1;r.bo?(c?(i[r.curi]=l,i.grid[r.curi]=c):(i.grid[r.curi]=l,p&&(i.grid[r.curi+"_actual"]=p)),i.grid.modificationDate=t.formatDate(n[0].body.modified.value[0]),e.SAXStorage().setItem(f.recentlyAuthored+o.nodeModel.getID(),Date.now())):(s=!0,c?(i["instance_"+r.curi]=l,i.grid["instance_"+r.curi]=c):(i.grid["instance_"+r.curi]=l,p&&(i.grid["instance_"+r.curi+"_actual"]=p)),i.instance={modificationDate:t.formatDate(n[0].body.modified.value[0])},e.SAXStorage().setItem(f.recentlyAuthoredStructure+o.nodeModel.getParent().getID(),Date.now()));let u=[],g=[];(this.contentView.treeDocument.getMappedNodesFromId(o.nodeModel.options.physicalid)||[o.nodeModel]).forEach((function(e){if(s)if(n[0].body.oldInstancePhysicalid){let t=e.getParent(),i=new d({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,physicalid:e.options.physicalid,instance:{physicalid:n[0].body.physicalid},grid:{physicalid:e.options.physicalid},actualParent:e.options.actualParent,children:[]});i.setRelationID(n[0].body.physicalid),t.addChild(i,e._rowID),g.push(i),u.push(e)}else e.options.instance&&e.options.instance.physicalid===o.nodeModel.options.instance.physicalid&&e.updateOptions(i);else e.updateOptions(i)}));var v=widget.getValue("currentOpenedItem");if(v&&v===o.nodeModel.options.physicalid&&a.getFLWebModelEventsObj("flweb-model-events").publish({event:"idcard-refresh"}),g.length>0&&u.length>0){o.nodeModel.unselect(),o.nodeModel.getNextNode().select();let e={};e[n[0].body.oldInstancePhysicalid]=u,e[n[0].body.physicalid]=g;let t=a.getFLWebModelEventsObj("flcockpit-content-list-view");t.publish({event:"refresh-nodes-by-id",data:{arrayOfPID:[u[0].options.physicalid],tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:!0}}),t.publish({event:"refresh-inst-by-id",data:{instIdMap:e,bInstance:!0,bEffectivity:!0}})}}else i({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),r.isOnExtension?t.displayError({},u.msg_error_no_modification_possible,null,u.msg_error_edit_attributes_on_extensions_failed):t.displayError({},u.msg_error_no_modification_possible,null,u.msg_error_edit_attributes_not_on_extensions_failed)},_getCellGroupingKey:function(e,t){let i=this;if(t.nodeModel&&t.columnID){let n=i.contentView.getColumnOrGroup(t.columnID).typeRepresentation,o=t.nodeModel.options.grid[e];if("icon"===n){if("cue"===e){let e;switch(o){case"group":e="cue_combined";break;case"alert":e="cue_critical";break;case"status-ko":e="cue_error";break;case"attention":e="cue_warning";break;case"info":e="cue_info"}return u[e]}if("isReserved"===e){let e=t.nodeModel.options.isReserved;if("TRUE"===e)return t.nodeModel.options.grid.reservedBy;if("FALSE"===e)return t.nodeModel.options.grid.isReserved;if(void 0===e)return u.label_false}else if("instance_isReserved"===e){let e=t.nodeModel.options.instance_isReserved;if("TRUE"===e)return t.nodeModel.options.grid.instance_reservedBy;if("FALSE"===e)return t.nodeModel.options.grid.instance_isReserved;if(void 0===e)return u.label_false}}else if("customBoolean"===n)return o?u.label_true:u.label_false;return t.nodeModel.options.grid[e]}}}})),define("DS/CATFLCockpitWidget/components/AttributesManagement/AttributesManagement",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/UIKIT/Mask","DS/ClassificationUtil/ClassificationUtil","DS/CATFLCockpitWidget/services/predicate.service","DS/Windows/Dialog","DS/Controls/Button","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/preferences.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/zip.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f){"use strict";let m=c.getFullConfig(),h=m.identifiers,v={"http://www.w3.org/2001/XMLSchema#boolean":"boolean","http://www.w3.org/2001/XMLSchema#integer":"integer","http://www.w3.org/2001/XMLSchema#real":"number","http://www.w3.org/2001/XMLSchema#timestamp":"date"},C=h.index_services.select_bo.map((e=>e.toLowerCase())),y=h.index_services.select_rel.map((e=>e.toLowerCase())),b=["ds6w:bookmarks","ds6w:folder","ds6w:library","ds6w:libraries"];var _=function(e,t,i){var n=this;this.isForPhysicalProduct=e||!1,this.dialogTitle=e?f.attributes_browser_for_physical_product:f.attributes_browser,this.isForPhysicalProduct?(this.types=t||[],this.typesInstance=i||[],this.render()):r.getLtypes().then((function(e){n.types=e[h.type_act_logref],n.typesInstance=e[h.type_act_loginstance],n.render()}))};return _.prototype.render=function(){var t=this;t.dialog=new a({title:t.dialogTitle+" - "+f.label_select_extensions,height:500,width:700,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new s({label:f.label_next,emphasize:"primary"}),Cancel:new s({emphasize:"secondary"})}}),t.dialog.addEventListener("close",(function(){t.dialog.destroy()})),t.dgv=new i({identifier:"SystemArchitectureRelease_AttributesManagement_DGV",height:"inherit",treeDocument:new e({useAsyncPreExpand:!0}),selectionBehavior:{unselectAllOnEmptyArea:!1},columns:[{typeRepresentation:"icon",dataIndex:"iconType",width:40},{text:f.label_name,dataIndex:"name"},{text:f.label_declared_in,dataIndex:"declaredIn"}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!0,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t},getCellTooltip:function(e){return e.nodeModel&&0===e.columnID?{shortHelp:t.isForPhysicalProduct?f.label_declared_in_physical_product:e.nodeModel.options.isOnInstance?f.label_declared_in_instance:f.label_declared_in_reference,updateModel:!1}:t.dgv.getCellDefaultTooltip(e)}}),t.dialog.elements._contentDiv.appendChild(t.dgv.getContent()),t.dgv.treeDocument.setFilterModel({name:{filterId:"stringRegexp"}}),t.dgv.sortModel=[{dataIndex:"iconType",sort:"desc"},{dataIndex:"name",sort:"asc"}],t.renderListOfExtensions()},_.prototype.renderListOfExtensions=function(){var e=this;n.mask(e.dialog.elements._contentDiv,f.msg_loading);var i=[];e.types&&e.types.length>0&&i.push(l.getExtensionsForClass(e.types)),e.typesInstance&&e.typesInstance.length>0&&i.push(l.getExtensionsForClass(e.typesInstance,!0)),Promise.all(i).then((function(i){e.dgv.treeDocument.empty();for(var o=[{},{}],r=0;r<i.length;r++)for(var a=1===r,l=0;l<i[r].length;l++)for(var c=i[r][l].interfaces,d=0;d<c.length;d++)if("Yes"!==c[d].automatic){var u=c[d].name;void 0===o[r][u]?o[r][u]={uri:c[d].name,isOnInstance:a,grid:{iconType:a?"object-instance":"object-reference",name:c[d].nlsName,declaredIn:[i[r][l].name]}}:o[r][u].grid.declaredIn.push(i[r][l].name)}for(r=0;r<o.length;r++)for(var p in o[r])o[r][p].grid.declaredIn.length===i[r].length&&(o[r][p].grid.declaredIn=f.label_all_levels),e.dgv.treeDocument.addChild(new t(o[r][p]));var h=e.isForPhysicalProduct?m.localStorageKeys.userAdditionalAttributesForPhysicalProduct:m.localStorageKeys.userAdditionalAttributes;let v=localStorage.getItem(h);var C=JSON.parse(g.jsonUnzip(v)),y=C?C.extensions:null;null!==y&&e.dgv.treeDocument.getAllDescendants().forEach((function(e){-1!==y.indexOf(e.options.uri)&&e.select()})),e.dgv.treeDocument.getFilterManager().setPropertyFilterModel("declaredIn",{filterId:"set"}),e.dgv.reapplySortModel(),e.dialog.title=e.dialogTitle+" - "+f.label_select_extensions,e.dialog.buttons={Ok:new s({label:f.label_next,emphasize:"primary",onClick:function(){e.renderListOfAttributes()}}),Cancel:new s({emphasize:"secondary",onClick:function(){e.dialog.close()}})},n.unmask(e.dialog.elements._contentDiv)}))},_.prototype.renderListOfAttributes=function(){var e=this;n.mask(e.dialog.elements._contentDiv,f.msg_loading);for(var i=e.dgv.treeDocument.getSelectedNodes(),a=[],l=[],c=[],_=0;_<i.length;_++)a.push(i[_].options.uri),i[_].options.isOnInstance?l.push(i[_].options.uri):c.push(i[_].options.uri);var w=[];if(this.isForPhysicalProduct){var D=e.types.concat(c),S=e.typesInstance.concat(l);w.push(r.getPredicates(D,S))}else w.push(r.getPredicatesForLtypes()),w.push(r.getPredicates(c,l));let I=o.classificationAttributesPromise({apiVersion:"R2019x",lang:widget.lang||"en"}).then((function(e){return e})).catch((function(){return[]}));w.push(I),Promise.all(w).then((function(i){var o=[{},{},{}],l=[[],[],[]];e.isForPhysicalProduct?(l[0]=i[0][0],l[1]=i[0][1],l[2]=i[1]):(l[0]=i[0][0].concat(i[1][0]),l[1]=i[0][1].concat(i[1][1]),l[2]=i[2]),l.forEach((function(e,t){for(var i=0;i<e.length;i++)for(var n=e[i],r=0;r<n.properties.length;r++){var s=n.properties[r],l=n.classInfo.curi.replace("ds6w:","").replace("ds6wg:","");if(void 0===o[t][s.curi])s.declaredIn=[],o[t][s.curi]=s,-1!==a.indexOf(l)&&(s.isOnExtension=!0);else{var c=o[t][s.curi];if(c.selectable!==s.selectable)if(c.isSharedPredicate=!0,(c.dimension&&s.dimension&&c.dimension!==s.dimension||c.manipulationUnit&&s.manipulationUnit&&c.manipulationUnit!==s.manipulationUnit)&&(c.notConvertible=!0,c.manipulationUnit=null),-1!==a.indexOf(l)&&(c.isOnExtension=!0),2===t)Array.isArray(c.selectable)||(c.selectable=[c.selectable]),c.selectable.push(s.selectable);else if(c.selectable){if(void 0!==c.selectable.length){var d=c.selectable;c.selectable={},c.declaredIn.forEach((function(e){c.selectable[e]=d}))}void 0===c.selectable[l]?c.selectable[l]=s.selectable:(Array.isArray(c.selectable[l])||c.selectable[l]===s.selectable||(c.selectable[l]=[c.selectable[l]]),c.selectable[l].includes(s.selectable)||(c.selectable[l].push(s.selectable),c.isSharedPredicateOnSameType=!0))}}2===t||o[t][s.curi].declaredIn.includes(l)||o[t][s.curi].declaredIn.push(l)}}));var c=Object.values(o[2]).map((function(e){return{curi:e.curi,nls:e.label}})).filter((function(e){return void 0!==e.curi})),_={};r.getNLSPredicates(c).then((function(e){_=e||{}})).finally((function(){e.dgv.treeDocument.empty();for(var i=0;i<o.length;i++)for(var c in o[i])if(o[i][c].curi){var w=o[i][c];if(0===i&&-1===C.indexOf(w.curi.toLowerCase())||1===i&&-1===y.indexOf(w.curi.toLowerCase())||2===i){var D=new t({attribute:w,isOnInstance:1===i,isClassification:2===i,isOnExtension:w.isOnExtension,grid:{iconType:0===i||2===i?"object-reference":"object-instance",name:2===i?_[w.curi]||w.label:w.label||w.curi,declaredIn:w.declaredIn.length===l[i].length||2===i?f.label_all_levels:w.declaredIn.join()},declaredInArray:w.declaredIn});e.dgv.treeDocument.addChild(D)}}var S=e.isForPhysicalProduct?m.localStorageKeys.userAdditionalAttributesForPhysicalProduct:m.localStorageKeys.userAdditionalAttributes;let I=localStorage.getItem(S);var A=JSON.parse(g.jsonUnzip(I));if(A){var F={bo:[],rel:[]};A.userAdditionalAttributes&&A.userAdditionalAttributes.forEach((function(e){e.bo?F.bo.push(e.curi):F.rel.push(e.curi)})),(F.bo.length>0||F.rel.length>0)&&e.dgv.treeDocument.getAllDescendants().forEach((function(e){e.options.isOnInstance&&-1!==F.rel.indexOf(e.options.attribute.curi)?e.select():e.options.isOnInstance||-1===F.bo.indexOf(e.options.attribute.curi)||e.select()}))}e.dgv.treeDocument.getFilterManager().setPropertyFilterModel("declaredIn",{filterId:"stringRegexp"}),e.dgv.reapplySortModel(),e.dialog.title=e.dialogTitle+" - "+f.label_select_attributes,e.dialog.buttons={Ok:new s({label:f.action_close,emphasize:"primary",onClick:function(){var t,i={},n={},o=e.dgv.treeDocument.getSelectedNodes();0!==o.length&&(t=[],o.forEach((function(o){var r=o.options.attribute.isSharedPredicateOnSameType||o.options.attribute.isSharedPredicate&&(o.options.isClassification||o.options.isOnExtension);r=o.options.attribute.notConvertible||r;var a=o.options.attribute.manipulationUnit&&o.options.attribute.manipulationUnit!==m.dimensions[o.options.attribute.dimension].MKSUnit&&void 0!==o.options.attribute.rangeValues&&o.options.attribute.rangeValues.length>0;"date"===v[o.options.attribute.dataType]&&void 0!==o.options.attribute.rangeValues&&o.options.attribute.rangeValues.length>0&&o.options.attribute.rangeValues.forEach((e=>{e.formatDateValue=d.displayDate(e.value)}));var s={curi:o.options.attribute.curi,nls:o.options.attribute.label,type:v[o.options.attribute.dataType]||"string",isClassification:o.options.isClassification,bo:!o.options.isOnInstance,isOnExtension:o.options.isOnExtension,isOnPhysicalProduct:e.isForPhysicalProduct,rangeValues:o.options.attribute.rangeValues,selectable:o.options.attribute.selectable,dimension:o.options.attribute.dimension,manipulationUnit:o.options.attribute.manipulationUnit,declaredIn:o.options.grid.declaredIn,declaredInArray:o.options.declaredInArray,readOnly:r||a||"computed"===o.options.attribute.nature||"ReadOnly"===o.options.attribute.userAccess,isSharedPredicate:o.options.attribute.isSharedPredicate,isSharedPredicateOnSameType:o.options.attribute.isSharedPredicateOnSameType,notConvertible:o.options.attribute.notConvertible,multiValuated:b.includes(o.options.attribute.curi)||o.options.isClassification&&o.options.attribute.valuetype&&"multival"===o.options.attribute.valuetype,multiLine:o.options.isClassification&&o.options.attribute.multiline&&"TRUE"===o.options.attribute.multiline};if(t.push(s),!o.options.isClassification){var l;l=o.options.attribute.declaredIn.includes(h.type_act_logref)?h.type_act_logref:o.options.attribute.declaredIn[0],i[l]||(i[l]={},n[l]={});var c=o.options.attribute.originCuri.replace("ds6w:","").replace("ds6wg:","");i[l][c]?(i[l][c]=[i[l][c]],i[l][c].push(s)):(i[l][c]=s,n[l][c]=s)}}))),r.getPropertiesPredicates(n).then((function(n){n&&(n=JSON.parse(n)).forEach((function(e){e.info.forEach((function(t){i[e.type][t.Name].length>0?i[e.type][t.Name].forEach((e=>{e.multiLine="Yes"===t.MultiLine,e.multiValuated="Yes"===t.MultiValuated})):(i[e.type][t.Name].multiLine="Yes"===t.MultiLine,i[e.type][t.Name].multiValuated="Yes"===t.MultiValuated)}))})),u.saveUserCustomAttributes({extensions:a,userAdditionalAttributes:t,isForPhysicalProduct:e.isForPhysicalProduct}),p.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-refresh-columns",data:{refreshView:!0}}),p.getFLWebModelEventsObj("flweb-model-events").publish({event:"save-user-custom-attributes"})})),e.dialog.close()}}),Cancel:new s({label:f.action_back,emphasize:"secondary",onClick:function(){e.renderListOfExtensions()}})},n.unmask(e.dialog.elements._contentDiv)}))}))},_})),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.creation",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/document.service","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a){"use strict";var s=JSON.parse(r),l=t.getFullConfig();return{createDocument:function(n,r){let c,d={treeDocument:n.getTreeDocument(),navigateTypes:["SPECIFICATION_DOCUMENT"]},u=d.treeDocument.getMappedNodesFromId(n.options.physicalid);r&&(c=s.rel_specification);let p=t.getSecurityContext();p=p.split(".")[0];let g=p+"."+n.options.grid.organization+"."+n.options.grid.project;o.createDocument(n.options.physicalid,c,g,(function(o){if(t.SAXStorage().setItem(l.localStorageKeys.recentlyAuthored+n.options.physicalid,Date.now()),!(widget.getValue("configurable_expand")||{}).specDocs)return void e.alertMessage("success",null,a.msg_header_create_success,o[0].label+a.msg_add_doc_success);let r=new Set;u.forEach((function(t){i.updateDocsOnNode(s.type_spec_document,t,o,d,!0).then((function(){t.updateOptions(),r.has(t.options.physicalid)||(e.alertMessage("success",null,a.msg_header_create_success,o[0].label+a.msg_add_doc_success),r.add(t.options.physicalid))}))}))}))},createNewItemReference:function(t,i,o,r){var s={items:[{attributes:{}}]};return""!==t.trim()&&(s.items[0].attributes.title=t),i&&(s.items[0].type=i),Object.keys(o).length>0&&(s.items[0].CustomFields=o),r&&(s.credential=r),n.createLogItem(s).then((function(i){if(i)return e.alertMessage("success",null,a.msg_header_create_success,t+a.msg_create_success),i}))},createNewItemInstance:function(t,i,o,r,s,l){var c=r;c||(c="dslog:LogItemPRIVATE");var d={instances:[{attributes:{},referencedItem:{type:c,attributes:{}}}]};return Object.keys(s).length>0&&(d.instances[0].referencedItem.CustomFields=JSON.parse(JSON.stringify(s))),""!==o.trim()&&(d.instances[0].referencedItem.attributes.title=o),l&&(d.credential=l),n.createLogItemInstanceNew(d,t).then((function(t){return 0===o.length&&d.name&&d.name.length>0&&(o=d.name.slice(0,-2)),o.length>0?e.alertMessage("success",null,a.msg_header_create_success,o+a.msg_create_success):e.alertMessage("success",null,a.msg_header_create_success,a.create_log_ref_from_dialog_success),t}),(function(t){e.displayError(t,null,a.error_creation,a.msg_add_item_error)}))}}})),define("DS/CATFLCockpitWidget/components/ImplementLinks/implementLinks.controller",["DS/UIKIT/Mask","DS/Windows/Dialog","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrix","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f,m){"use strict";let h=n.getFullConfig(),v=h.identifiers,C=h.localStorageKeys;var y={manageRef2RefImplRel:function(e){let t;t=e.isReleased?v.type_act_physical:v.type_usecase+","+v.type_requirement+","+v.type_reqSpec+","+v.type_reqGroup+","+v.type_act_functref+","+v.type_act_logref+","+v.type_act_physical,i.launchSearch({allowedTypes:t,role:"",criteria:t,bMultiSel:!0,in_apps_callback:function(t){var i,n=e.selectedNode,r=[],s=[];t.forEach((function(e){s.push(e.id)})),c.getKindOfRFLP(s).then((function(e){e&&e.length>0&&(e.forEach((function(e,t){i={},"P"===e?(i.implementing=s[t],i.implemented=n.options.physicalid):(i.implementing=n.options.physicalid,i.implemented=s[t]),r.push(i)})),u.createScopeLinks(r).then((function(){a.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-refLinks-by-id",data:[n]}),o.alertMessage("success","",m.msg_ref2ref_create_success)})).catch((function(e){o.displayError(e,null,null,m.error_create_refref_link)})))}),(function(e){o.displayError(e,null,m.error_create_refref_link)}))}})},manageOcc2OccImplRel:function(t){var i=this;let n=widget.getValue(C.componentView);var g=widget.body.querySelector(".fl-cockpit-app-container");e.mask(g,m.msg_loading);var f=t.selectedNode,h=f.getParent().getRelationID();h=h.slice(0,h.indexOf("ref"));var v=f.getParent().getParent();widget.getValue("groupingEnabled")&&!v.getID&&(v=l.getGroupNodeParent(v));var y=t.selectedNode.options.linkInfo.linkType,b={bIsImplementing:"implementing"===y,bIsImplementedBy:"implemented"===y};let _=widget.getValue("currentConfig"),w=_?_.filterCompiledForm:null;Promise.all([d.expand({itemIDs:[v.options.physicalid],configFilter:w}),d.expand({itemIDs:[f.options.physicalid],configFilter:w})]).then((function(t){i.instToNodeMap={},i.refTypes=[],i.instTypes=[];var l=i.mapParentToChildren(t[0][v.options.physicalid],!0),d=i.mapParentToChildren(t[1][f.options.physicalid],!1);if(l&&d){if(!l.getChildren()||!d.getChildren())return e.unmask(g),void o.alertMessage("error",null,"",m.msg_system_missing_children);l.options.implementLinks=v.options.implementLinks;var y=new p({useAsyncPreExpand:!0});y.addChild(l),y.addChild(d);var _=[];_.push(c.getTypeSchemaDetails({Type:i.refTypes,Relationship:i.instTypes}));let t=Object.values(i.instToNodeMap);if(t.length>300)for(let e=0;e<t.length;e+=300)_.push(u.getInstanceImplementLinks(t.slice(e,e+300),null,b));else _.push(u.getInstanceImplementLinks(t,null,b));r.makeMultipleServiceCalls(_,!0).then((function(t){var o=t[0],r=[];for(let e=1;e<t.length;e++)r=r.concat(t[e]);var c=i.mapRefNInstTypes(o);r.forEach((function(e){if(e[h]){var t=e.node,i=[];e[h].forEach((function(n){i.push({id:e.node.options.instance.physicalid,path:n.path,state:"nochange"}),t.relations=i}))}})),i.trMatrixModelEvents=a.createAppEventObject("trMatrix-model-events"),i.trMatrixModelEvents.subscribe({event:"occLink-refresh"},(function(e){if(e&&e.firstSystemNode){var t=v.getTreeDocument().getNodesById(e.firstSystemNode.options.physicalid);t&&t.forEach((function(t){let i=u.getAllImplPaths(h,t,[],[]);t.options.instance.physicalid===e.firstSystemNode.options.instance.physicalid&&i.indexOf(e.ctxPath)&&(a.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:[t]}),n===C.structuredView&&t.options.hasBeenExpanded&&s._addOccImplementLinksToNode(t))}))}})),i.launchTraceabilityMatrix({system1:l,system2:d,linkType:h,typesMap:c,modelEvents:i.trMatrixModelEvents}),e.unmask(g)}))}})).catch((function(t){e.unmask(g),o.displayError(t,null,null,m.error_manage_occocc_link)}))},mapParentToChildren:function(e,t){var i,n=e.map,o=e.rootUuid;return n[o]&&(i=this.createNodeStruct(null,n[o],n,null,t)),i},createNodeStruct:function(e,t,i,n,o){var r,a=this,s=new g(t.attributes);e?e.addChild(s):r||(r=s),a.refTypes.indexOf(s.options.grid.actualType)<0&&a.refTypes.push(s.options.grid.actualType),n&&(s.options.instance={physicalid:n.pid,type:n.type,name:n.name},o&&(a.instToNodeMap[n.pid]=s),a.instTypes.indexOf(n.type)<0&&a.instTypes.push(n.type));var l=t.instances||t.relations;return l&&l.forEach((function(e){let t;if(e.attributes)for(let i=0;i<e.attributes.length;i++)if("PLMInstance.PLM_ExternalID"===e.attributes[i].name){t=e.attributes[i].value;break}a.createNodeStruct(s,i[e.toUuid],i,{pid:e.physicalid,type:e.type,name:t},o)})),r},mapRefNInstTypes:function(e){var t,i={references:{},instances:{}};return this.refTypes.forEach((function(n){t=e.Type[n],i.references[n]={name:t.TypeNLS||n,parent:t.Hierarchy}})),this.instTypes.forEach((function(n){t=e.Relationship[n],i.instances[n]={name:t.RelationshipNLS||n,parent:t.Hierarchy}})),i},launchTraceabilityMatrix:function(e){var i=e.system1.options.label+" "+e.system1.options.grid.revision,n=e.system2.options.label+" "+e.system2.options.grid.revision,o=f.init(e);if(o){var r=new t({title:m.replace(m.header_traceability_matrix,{system1:i,system2:n}),content:o,height:600,width:1400,resizableFlag:!0,movableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame});f.injectMatrix(),r.addEventListener("close",(function(){r.destroy()}))}},deleteImplRel:function(e){var t,i=e.selectedNodes,r=[];if(i.forEach((function(e){(t=e.options.linkInfo)&&r.push(t.implementId)})),r.length>0)return u.deleteImplementLinks(r).then((function(){var r,s=[];let c=widget.getValue("groupingEnabled");i.forEach((function(i){t=i.options.linkInfo;var o=i.getParent().getParent();c&&!o.getID&&(o=l.getGroupNodeParent(o)),n.SAXStorage().setItem(h.localStorageKeys.recentlyAuthored+o.options.physicalid,Date.now()),(r=e.treeDocument.getMappedNodesFromId(o.options.physicalid))||(r=[o]),r.forEach((function(e){s.push(e);var i=e.options.instance?e.options.instance.physicalid:"",n=e.getNodesByRelId(t.linkType+t.objType+i)[0];n&&(n.getChildren().forEach((function(e){e.options.linkInfo.implementId===t.implementId&&e.remove()})),n.getChildren()&&0!==n.getChildren().length||n.remove()),e.expand()}))})),o.alertMessage("success","",m.msg_delete_link_success),a.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:s})})).catch((function(e){o.displayError(e,null,null,m.error_delete_link)}))}};return y})),define("DS/CATFLCockpitWidget/components/CreateLogicalItemModal/SAXPLMNew/SAXPLMNewCmdUtils",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/components/CreateLogicalItemModal/SAXPLMNew/PLMNewSAXCmd","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r){"use strict";var a=e.getFullConfig().identifiers;return{init:function(e){this.parentItem=e.parentItem,this.treeDocument=e.treeDocument,this.isReplaceCall=e.isReplaceCall,this.xRevision=e.xRevision;let t=this.getCreateoptions();new o(t).execute()},getCreateoptions:function(){let t={options:{typeName:a.type_act_logref,objType:a.type_act_logref},context:{serviceBaseUrl:e.getServiceURL("3DSpace"),tenant:e.getTenant(),header:{SecurityContext:"ctx::"+e.getSecurityContext()}},viewType:"tabView",labelTopBar:r.action_add_new,facets:this.getFacets(),notification:!1,events:this.getCallbacks(this,this.parentItem,this.treeDocument,this.isReplaceCall)};var i=e.getAuthorizedWorkUnder();return null!=i&&0!=Object.keys(i).length&&Object.assign(t.context.header,i),this.parentItem&&this.parentItem.options.physicalid&&(t.options.parentPIDs=[this.parentItem.options.physicalid],this.isReplaceCall&&this.parentItem.options.instance&&this.parentItem.options.instance.physicalid&&(t.options.selectedIDs=[this.parentItem.options.instance.physicalid])),t},getCallbacks:function(e,o,a,s){let l={onSuccess:function(e){if("success"!==e.status||!e.result||!e.result[0].identifier)return;let l,c=e.result[0].identifier,d=e.result[0].relations;if(o&&o.options.physicalid&&(l=o.options.physicalid),!s||l){if(a&&o&&l&&d){let e={id:d[0].relationshipID,name:d[0].instanceName,reference:c};var u=a.getMappedNodesFromId(l);if(u||(u=o),s){let i=[u[0].options.instance.physicalid];t.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-items-on-replace",data:{replaceDetails:[e],selectedNodes:u,instID:i}})}else n.addChildrenToParent(a,u,[e],!0)}else t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:c}});s?i.alertMessage("success",null,"",r.msg_replace_success):i.alertMessage("success",null,r.msg_header_create_success,r.create_log_ref_from_dialog_success)}},onFailure:function(){i.displayError({},r.error_creation,null,r.replace(r.error_no_access,{errorOp:r.action_insert_new+" "+r.label_log_ref}))},onCancel:function(){}};return l.onSuccess.bind(),l},getFacets:function(){let e=[{name:"classificationFacet",facetoptions:{isBookmark:!0,isLibrary:!0,isExportControl:!0}}];if(this.xRevision){const t={name:"revisionFacet"};e.push(t)}return e}}})),define("DS/CATFLCockpitWidget/components/WIWItemCreationModal/WIWItemCreationModalView",["UWA/Core","UWA/Class/View","DS/UIKIT/Spinner","DS/UIKIT/Input/Text","DS/UIKIT/Scroller","DS/UIKIT/Tooltip","DS/Controls/LineEditor","DS/WUXAutoComplete/AutoComplete","DS/Controls/Toggle","DS/UIKIT/Mask","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/architectureNumber.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g){"use strict";return t.extend({name:"WIWItemCreationModalView",tagName:"div",collection:null,toupdate:null,spinner:null,init:function(t){t=e.clone(t||{},!1),this._parent(t),this.collection=t.collection,this.action=t.collection.winInfo.action},setCollection:function(e){return this.collection=e,this.action=e.winInfo.action,this},createTableComponent:function(t,i,n){var o=e.createElement(t,n);return o.inject(i),o},createTableHeaderView:function(t,i,n){var o=this,r=null,a=e.createElement("tr"),s=o.createTableComponent("th",a,{status:"ok",class:"archNo-th-checkbox"});(r=new l({type:"checkbox",value:0,checkFlag:!0})).addEventListener("change",(function(e){o.toggleAllEvent(e,this,o.container)})),r.inject(s);o.createTableComponent("th",a,{html:"#"});t.forEach((function(e){var t={html:i[e].label};i[e].architectureIdColumn&&(t.class="archidcolumn"),o.createTableComponent("th",a,t)})),this.collection.showRowLevelRecomputation&&o.createTableComponent("th",a,{styles:{"background-color":"#E2E4E3"}}).appendText(g.label_reEvaluate_ArchNo),n>=1&&o.createTableComponent("th",a,{html:g.arch_no_header});let c=o.options.cfgCtxInfo;return c&&(c.bCopyEff||c.bApplyConfig)&&o.createTableComponent("th",a,{html:g.label_apply_evolution}),a},createMetaDataOfRow:function(e){var t={};return t["data-id"]=e.referenceID,t["data-instance"]=e.instanceID,e.logicalRefType&&(t["data-type"]=e.logicalRefType),t.addRefRef=e.addRefRef,t},createTableBodyView:function(t,i,n,o,c){let d,u,f=this,m=null,h=!0,v=f.options.cfgCtxInfo;for(let C=0;C<o.length;C++){h=!0!==o[C].forbidSetAN;let y=f.createMetaDataOfRow(o[C]);y.class="item-row";let b=f.createTableComponent("tr",t.getElement(".itemDetails"),y),_="",w="";if(h){let e=f.createTableComponent("td",b,{status:"ok",class:"archNo-td-checkbox",styles:{"background-color":"#D5E8F2"}});m=new l({type:"checkbox",value:0,checkFlag:!0}),m.addEventListener("buttonclick",(function(e){f.toggleEvent(e,this,f.container)})),m.inject(e)}else{let t=f.createTableComponent("td",b,{class:"iconColor",styles:{color:"#EA4F37"}});e.createElement("span",{class:"fonticon fonticon-status-ko"}).inject(t);let i="";o[C].forbidSetANErrorMessages.forEach((function(e){i=i+e+"<br><br>"})),new r({target:t,body:i})}if(h){if(f.createTableComponent("td",b,{html:C+1,editable:!1,styles:{"background-color":"#D5E8F2"}}),i.forEach((function(e){let t,i,r=n[e];if(u={id:r.key,name:r.label,architectureidcolumn:void 0!==r.architectureIdColumn&&r.architectureIdColumn,required:r.required,editable:r.editable,styles:{"background-color":"#D5E8F2"}},d=f.createTableComponent("td",b,u),r.editable)if(d.setAttribute("type","lineEditor"),"enum"===r.format){let n=r.range,a=r.rangeLabel,l=r.rangeTooltip,c="",u=[];c=""!==o[C][e]?o[C][e]:r.defaultValue?r.defaultValue:"";for(let e=0;e<n.length;e++)u.push({label:a?a[e]:n[e],value:n[e],description:l&&l[e]?l[e]:null});t=new s({elementsTree:u,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1}),t.value=c,t.inject(d),i=t.getContent().getElement("input"),t.addEventListener("change",p.updateArchitectureID.bind(f,i,b,!1))}else t=new a({className:"form-control",placeholder:"Enter "+n[e].label,attributes:{autocomplete:"off",name:r.label},value:o[C][e],requiredFlag:r.required}),t.inject(d),i=t._myInput,i.addEventListener("keyup",p.updateArchitectureID.bind(f,i,b,!1)),i.addEventListener("keydown",f.nextEditableCell);else d.setHTML(o[C][e]);n[e].architectureIdColumn&&(w="enum"===r.format?t.value?t.value:"":o[C][e],_+=w)})),f.collection.showRowLevelRecomputation&&(u={id:"ANRecompute",architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":"#D5E8F2",cursor:"pointer"}},d=f.createTableComponent("td",b,u),e.createElement("span",{class:"fonticon fonticon-compute"}).inject(d),d.addEventListener("click",(function(e){"ok"===e.currentTarget.closest("tr").getChildren()[0].getAttribute("status")&&p.executeRecompute({isWIWcall:!0,an_action:f.collection.AN_ACTION,rows:[e.currentTarget.closest("tr")],SelectionContext:f.collection.SelectionContext})}))),c>=1){let e={class:"archidcell",html:_,styles:{"background-color":"#D5E8F2"}};f.createTableComponent("td",b,e)}}else if(f.createTableComponent("td",b,{html:C+1,editable:!1,styles:{"background-color":"#f9f9f9"}}),i.forEach((function(e){let t=n[e],i={id:t.key,name:t.label,architectureidcolumn:void 0!==t.architectureIdColumn&&t.architectureIdColumn,required:t.required,editable:!1,styles:{"background-color":"#f9f9f9"}};f.createTableComponent("td",b,i).setHTML(o[C][e])})),f.collection.showRowLevelRecomputation&&(u={id:"ANRecompute",architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":"#f9f9f9"}},d=f.createTableComponent("td",b,u)),c>=1){let e={class:"archidcell",styles:{"background-color":"#f9f9f9"}};f.createTableComponent("td",b,e)}if(v&&(v.bCopyEff||v.bApplyConfig)){let e=h?"#D5E8F2":"#f9f9f9",t={id:"applicableEvolution",name:g.label_apply_evolution,architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":e}};f.createTableComponent("td",b,t).setHTML(o[C].applicableEvolution)}}},toggleAllEvent:function(e,t,i){var n=t.getParent(),o=n.getAttribute("status"),r=i.getElements(".archNo-td-checkbox"),a=!0;"ok"===o?(a=!1,n.setAttribute("status","ko")):n.setAttribute("status","ok");for(var s=0;s<r.length;s++){r[s].getParent().getChildren().forEach((function(e,t){var i=e.getElement(".wux-controls-checkbox"),n=e.getElement(".wux-ui-fa.wux-icon");a?(0==t&&(e.setAttribute("status","ok"),i.dsModel.checkFlag=!0,n.addClassName("wux-ui-fa-check")),e.setStyle("background-color","#D5E8F2"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!1)):(0==t&&(e.setAttribute("status","ko"),i.dsModel.checkFlag=!1,n.removeClassName("wux-ui-fa-check")),e.setStyle("background-color","hsl(0, 0%, 98%)"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!0))}))}},toggleEvent:function(e,t,i){var n=t.getParent(),o=n.getAttribute("status");"ok"===o?(n.getParent().getChildren().forEach((function(e){e.setStyle("background-color","hsl(0, 0%, 98%)"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!0)})),n.setAttribute("status","ko")):"ko"===o&&(n.getParent().getChildren().forEach((function(e){e.setStyle("background-color","#D5E8F2"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!1)})),n.setAttribute("status","ok"));for(var r=i.getElements(".archNo-td-checkbox"),a=i.getElements(".archNo-th-checkbox")[0].getParent().getChildren()[0],s=a.getElement(".wux-controls-checkbox"),l=a.getElement(".wux-ui-fa.wux-icon"),c=!0,d=0,u=0;u<r.length;u++)"ko"===r[u].getAttribute("status")&&c?c=!1:"ok"===r[u].getAttribute("status")&&d++;c?(s.dsModel.checkFlag=!0,l.removeClassName("wux-toggle-mixed-icon"),l.addClassName("wux-ui-fa-check")):!c&&d>0?(l.removeClassName("wux-ui-fa-check"),l.addClassName("wux-toggle-mixed-icon")):0===d&&(s.dsModel.checkFlag=!1,l.removeClassName("wux-toggle-mixed-icon"))},render:function(e){let t=this;t.container=e;let i=this.collection.columnNames,n=this.collection.columns,o=this.collection.rows;t.createTableComponent("sup",e.getElement(".identifier-msg"),{html:g.arch_no_identifier_message});let r,a=0;i.forEach((function(e,t){n[e].architectureIdColumn&&(a++,r||(r=t))}));let s=t.options.cfgCtxInfo;if(s&&(s.bCopyEff||s.bApplyConfig)&&s.effectivityResponse){let e={};for(let t in s.effectivityResponse){let i=s.effectivityResponse[t];if(i&&"YES"===i.hasEffectivity){let n=i.content&&i.content.Evolution;e[t]=n.Current.replace(/(\r\n|\n|\r)/gm," ")}}o.forEach((t=>{let i=Array.isArray(t.instanceID)?t.instanceID:[t.instanceID];t.evolutionEffectivity="";let n=[];i.forEach((i=>{let o=e[i];o&&n.indexOf(o)<0&&(t.evolutionEffectivity+=o,n.push(o))})),s.bCopyEff&&(t.applicableEvolution=t.evolutionEffectivity)}))}t.createTableHeaderView(i,n,a).inject(e.getElement(".columnHeader")),t.createTableBodyView(e,i,n,o,a)},nextEditableCell:function(e){if(e.stopPropagation(),9==e.which){e.preventDefault();var t=e.currentTarget.getParent().getParent(),i=t.cellIndex,n=t.getParent().getChildren(),o=n.length,r=!1;if(i<o-1)for(var a=i+1;a<o;a++)if("true"==n[a].getAttribute("editable")){n[a].getChildren()[0].getChildren()[0].focus(),r=!0;break}if(!r){var s=e.currentTarget.getParent().getParent().getParent().nextSibling;s&&s.getElementsByClassName("wux-controls-abstract wux-controls-lineeditor")[0].getChildren()[0].focus()}}},applyCopyEffectivity:function(){let e=this.container.getElements(".item-row"),t=this.collection.rows;e.forEach(((e,i)=>{e.getElement("#applicableEvolution").setText(t[i].evolutionEffectivity)}))},applySelectedConfiguration:function(e){let t=this.container.getElements(".item-row"),i=e.modelVersionName+": Model Version "+e.modelVersionName+"-"+e.revision+"<";t.forEach((e=>{e.getElement("#applicableEvolution").setText(i)}))},resetApplicableEvolution:function(){this.container.getElements(".item-row").forEach((e=>{e.getElement("#applicableEvolution").setText("")}))}})})),define("DS/CATFLCockpitWidget/components/WIWItemCreationModal/WIWItemCreationModal",["UWA/Core","DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Toggle","DS/Controls/Button","DS/CATFLCockpitWidget/components/WIWItemCreationModal/WIWItemCreationModalView","DS/Handlebars/Handlebars4","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/architectureNumber.util","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/UIKIT/Autocomplete","DS/CATFLCockpitWidget/services/model.service","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/components/WIWItemCreationModal/WIWItemCreationModal.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f,m,h,v){m=JSON.parse(m);return{init:function(e,t,i,n){var o=this;return o.windowTitle=t.winInfo.title,o.okBtnTxt=t.winInfo.submitBtn,o.action=t.winInfo.action,o.changeControl=t.changecontrol,o.cfgCtxInfo=i,o.duplicateP2LWarningIDs={},o.activeModel=null,o.activeModelVersion=null,o.securityContext=n,o.createModal(e,t),"createLogRefFromDiagram"===o.action&&(o.instanceCount=t.instanceCount,o.previousModelVersion=JSON.parse(localStorage.getItem("flwebcockpit-selectedModelVersion-"+t.SelectionContext.LinkedSystem)),o.cfgCtxInfo.bCopyEff&&o.addCopyEffView(),o.cfgCtxInfo.bApplyConfig&&o.pushSelectModelVerView(t.SelectionContext.LinkedSystem)),o.pushSetArchView(t)},createModal:function(e,i){let n=this,r=a.compile(h),s=!!n.cfgCtxInfo&&n.cfgCtxInfo.bCopyEff,l=!!n.cfgCtxInfo&&n.cfgCtxInfo.bApplyConfig,d=UWA.createElement("div",{html:r({copyEff:s,workUnderEvol:l,workUnderEvolTitle:v.action_apply_evol_eff}),class:"wiw-set-architecture-number"});d.getElement(".table-wrapper").setStyles({"padding-bottom":"20px"}),d.inject(e),n.modalWindow=e;let p=n.modalWindow.getElement(".wiw-footer");if(new o({label:n.okBtnTxt,emphasize:"primary",onClick:function(e){n.architectureIdMap=[];let i,o,r=0,a=[],s=n.modalWindow.getElements(".item-row"),l=null,d=null;t.mask(n.modalWindow);let p={};for(let e=0;e<s.length;e++){let t={},g=s[e];if(!g.getChildren()[0].getAttribute("status")||"ko"===g.getChildren()[0].getAttribute("status")){r++;continue}let f,m=g.getAttribute("data-id");i=g.querySelectorAll('[required = "true"]'),o=!1;for(let e=0;e<i.length;e++){let t=i[e];if("true"===t.getAttribute("editable"))if(""==t.getElement("input").value.trim()){t.getElement("input").scrollIntoView(),t.getElement("input").addClassName("errordiv"),c.alertMessage("error",null,v.req_field_error_header,t.getAttribute("name")+v.arch_number_required_field),o=!0;break}}if(o)break;if(f=g.getElement(".archidcell")?g.getElement(".archidcell").getHTML():g.querySelector('[architectureidcolumn = "true"]').getElement("input").value.trim(),u.checkifANcontainsInvalidChars(f)){c.alertMessage("error",null,"",v.msg_set_arch_num_failed_invalid_char),g.getElement(".archidcell")?g.getElement(".archidcell").addClassName("errordiv"):g.querySelector('[architectureidcolumn = "true"]').addClassName("errordiv"),o=!0;break}let h=null,C=null,y={};g.getChildren().forEach((function(e){if("true"===e.getAttribute("architectureidcolumn")){if(h=e.getAttribute("id"),"true"===e.getAttribute("editable")){let t=e.getChildren()&&e.getChildren()[0];C=t.dsModel.value}else C=e.getHTML();y[h]=C}})),"createLogRefFromDiagram"===n.action?(m=g.getAttribute("data-id"),l=g.getAttribute("data-instance"),p[l]=f,d=g.getAttribute("data-type"),t.referenceID=m,t.instanceID=l,t.ArchitectureNumber=f,d&&(t.logicalRefType=d),t.addRefRef=g.getAttribute("addRefRef"),t.ArchitectureNumberTokens=y,n.architectureIdMap.push(t)):"setArcNumPhysical"===n.action&&(a.push(g.getAttribute("data-id")),g.getChildren()[0].hasClassName("archNo-td-checkbox")&&(m=g.getAttribute("data-id"),l=g.getAttribute("data-instance"),n.architectureIdMap.push({referenceID:m,instanceID:l,ArchitectureNumber:f,ArchitectureNumberTokens:y})))}if(r===s.length&&(c.alertMessage("error",null,v.log_ref_selection_error),o=!0),o)t.unmask(n.modalWindow);else if("createLogRefFromDiagram"===n.action)n.createLogRefServiceCall(p);else if("setArcNumPhysical"===n.action){var g={architectureNumbers:n.architectureIdMap};n.callPromiseService(g,a)}}}).inject(p),i.showBulkRecomputation&&"createLogRefFromDiagram"===n.action)new o({label:v.label_reEvaluate_ArchNo,onClick:function(e){u.executeRecompute({isWIWcall:!0,an_action:i.AN_ACTION,rows:n.modalWindow.getElement(".itemDetails").getChildren("tr"),SelectionContext:i.SelectionContext})}}).inject(p);new o({label:v.cancel_button,emphasize:"secondary",onClick:function(e){n.modalWindow.destroy(),window.dscef&&("createLogRefFromDiagram"===n.action?dscef.sendString("createLogicalReferencesFromDiagramCanceledNotif"):"setArcNumPhysical"===n.action&&dscef.sendString("setArchitectureNumberOnPSpoolCanceledNotif"))}}).inject(p);n.modalWindow.addEventListener("close",(function(e){window.dscef&&(dscef.sendString("createLogicalReferencesFromDiagramClosedNotif"),"createLogRefFromDiagram"===n.action?dscef.sendString("createLogicalReferencesFromDiagramCanceledNotif"):"setArcNumPhysical"===n.action&&dscef.sendString("setArchitectureNumberOnPSpoolCanceledNotif"))}))},createLogRefServiceCall:function(e){(i=this).instanceCount&&i.instanceCount>100&&c.alertMessage("warning",null,v.msg_manyItemsToItemize);var t={},i=this;t.SelectionContext=i.collection.SelectionContext,t.ListSelectedInstances=i.architectureIdMap,t.AN_ACTION=i.collection.AN_ACTION,i.activeModelVersion&&i.activeModelVersion.physicalid?l.applyWorkUnderEvolution({model:i.activeModel,modelVer:i.activeModelVersion},!0).then((function(n){i.callPromiseService(t,e),localStorage.setItem("flwebcockpit-selectedModelVersion-"+i.collection.SelectionContext.LinkedSystem,JSON.stringify({modelVersion:i.activeModelVersion.physicalid}))})):i.callPromiseService(t,e)},callPromiseService:function(e,t){var i=this;if("createLogRefFromDiagram"===i.action){var n=[];for(var o in i.duplicateP2LWarningIDs){i.duplicateP2LWarningIDs[o]===t[o]&&n.push(o)}e.ignoreP2LWarningIDs=n,i.duplicateP2LWarningIDs={},i.changeControl&&d.setAuthIDforWIW("change",i.changeControl),s.createItemFromDialogue(e,0,i.securityContext).then(i.createFromDiagramServiceCallback.bind(i,t),i.serviceCallFailureFunction.bind(i))}else"setArcNumPhysical"===i.action&&(i.removeCSS(t),s.setArchitectureNumberOnPSpool(e,0,i.securityContext).then(i.setArchitectureNumberOnPSpoolServiceCallback.bind(i),i.serviceCallFailureFunction.bind(i)))},setArchitectureNumberOnPSpoolServiceCallback:function(e){var i=JSON.parse(e),n=this;if(200===i.status){c.alertMessage("success",null,"",v.msg_set_arch_num_onP),n.modalWindow.destroy();var o={status:200,ModifiedPReferences:[]};for(var r in i)1==i[r]&&o.ModifiedPReferences.push(r);window.dscef&&dscef.sendString("setArchitectureNumberOnPSpoolEndNotif",JSON.stringify(o))}else if(400===i.status){var a,s=null,l=n.modalWindow.getElement(".itemDetails").getElements("tr"),d=[],u=[],p=[];l.forEach((function(e){var t=e.getAttribute("data-id"),n=e.getAttribute("data-instance");"NOCSGROUP"==i[t]||"FROZEN_REV"==i[t]||"NO_MODIFY_ACCESS"==i[t]?d.push(t):"KO"==i[t]||"UNICITY_KO"==i[t]?u.push(t):"INVALID_CHAR"==i[n]&&p.push(t)})),d.length>0?(s="errordiv",n.setCSS(d,s),a={type:"error",message:v.msg_error_set_architecture_number_unselect_reference}):u.length>0?(s="errordiv",n.setCSS(u,s),a={type:"error",message:v.arch_number_unique_error}):p.length>0?(s="errordiv",n.setCSS(p,s),a={type:"error",message:v.msg_set_arch_num_failed_invalid_char}):a={type:"error",message:v.msg_set_arch_num_failed},a&&(t.unmask(n.modalWindow),c.alertMessage(a.type,null,"",a.message))}},setCSS:function(e,t){var i=this;e.forEach((function(e){var n=i.modalWindow.getElement('.itemDetails tr[data-id ="'+e+'"]'),o=n.getElement(".archidcell");if(t)if(o)o.addClassName(t),o.setStyle("color","#EA4F37"),o.scrollIntoView();else{var r=n.querySelector('[architectureidcolumn = "true"]');o.addClassName(t),r.getElement("input").setStyle("color","#EA4F37"),r.getElement("input").scrollIntoView()}else{if(!o)o=(r=n.querySelector('[architectureidcolumn = "true"]')).getElement("input");o.hasClassName("errordiv")&&o.setStyle("color","hsl(0, 0%, 0%)")}}))},removeCSS:function(){for(var e=this.modalWindow.getElement(".itemDetails").getElements("tr"),t=0;t<e.length;t++)for(var i=0;i<e[t].getChildren().length;i++)e[t].getChildren()[i].hasClassName("archidcell errordiv")&&(e[t].getChildren()[i].removeClassName("errordiv"),e[t].getChildren()[i].setStyle("color","hsl(0, 0%, 0%)"))},createFromDiagramServiceCallback:function(e,i){var n=JSON.parse(i),o=this;if(200===n.status)if(o.copyEffToggle&&o.copyEffToggle.checkFlag){let e=Object.keys(o.cfgCtxInfo.mapIdToItemModel),t=[],i={},r=[];e.forEach((function(e){t.push({pid:e})})),f.getEffectivityInfo(o.cfgCtxInfo.instIds,"XML").then((function(e){let a=e;if(a){for(let e in a){let t=[],n=a[e];if("YES"===n.hasEffectivity){let o=n.content.Evolution&&n.content.Evolution.Current?n.content.Evolution.Current:null;o&&t.push({domain:"Evolution",content:o}),i[e]=t}}n.ImplementLinks.forEach((function(e){i[e.discipline.instanceID]&&r.push({pid:e.item.instanceID,expressions:i[e.discipline.instanceID]})})),r&&r.length>0?f.setMultipleFilterableObjectInfo(r,t).then((function(){c.alertMessage("success",null,"",v.create_log_ref_from_dialog_success),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n))}),(function(e){c.displayError(e,null,null,v.msg_error_wiw_copy_eff_failed),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n))})):(c.alertMessage("success",null,"",v.create_log_ref_from_dialog_success),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n)))}else c.alertMessage("success",null,"",v.create_log_ref_from_dialog_success),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n))}))}else c.alertMessage("success",null,"",v.create_log_ref_from_dialog_success),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n));else if(400===n.status){var r=o.modalWindow.getElement(".itemDetails").getElements("tr"),a=!1,s=!1,l=!1,d=null,u=null,p=!1;r.forEach((function(t){var i=t.getAttribute("data-instance");"NON_COMPLIANCE"===n[i]?(u=!0,d="#EA4F37"):"NOCSGROUP"==n[i]?(l=!0,d="#844138"):"UNICITY_KO"==n[i]?(a=!0,d="#EA4F37"):"P2L_DUPLICATE_WARNING"==n[i]?(o.duplicateP2LWarningIDs[i]=e[i],s=!0,d="#E87B00"):"INVALID_CHAR"==n[i]?(p=!0,d="#EA4F37"):d=null;var r=t.getElement(".archidcell");if(d){if(r)r.addClassName("errordiv"),r.setStyle("color",d),r.scrollIntoView();else(c=t.querySelector('[architectureidcolumn = "true"]')).getElement("input").setStyle("color",d),c.getElement("input").scrollIntoView()}else{var c;if(!r)r=(c=t.querySelector('[architectureidcolumn = "true"]')).getElement("input");r.setStyle("color","hsl(0, 0%, 0%)")}})),u?(t.unmask(o.modalWindow),c.alertMessage("error",null,"",v.msg_arch_number_non_compliance)):l?(t.unmask(o.modalWindow),c.alertMessage("error",null,"",v.msg_error_set_architecture_number_nocsgroup)):a?(t.unmask(o.modalWindow),c.alertMessage("error",null,"",v.arch_number_unique_error)):s?(t.unmask(o.modalWindow),c.alertMessage("warning",null,"",v.msg_error_create_fromDiagram_p2lwarning)):p?(t.unmask(o.modalWindow),c.alertMessage("error",null,"",v.msg_set_arch_num_failed_invalid_char)):c.alertMessage("error",null,"",v.msg_set_arch_num_failed)}else t.unmask(o.modalWindow),c.alertMessage("error",null,"",v.instance_creation_failed)},serviceCallFailureFunction:function(e){window.dscef&&(e.error&&e.error.message&&e.error.message.contains("timedout")?dscef.sendString("createLogicalReferencesFromDiagramRequestTimedoutNotif"):dscef.sendString("createLogicalReferencesFromDiagramRequestFailedNotif"));var i="";e.errorResp&&e.errorResp.message?i=e.errorResp.message:e.error&&e.error.message?i=e.error.message:e.message&&(i=e.message),t.unmask(this.modalWindow),c.alertMessage("error",null,"",i)},addCopyEffView:function(){var e=this,t=e.modalWindow.getElement(".copy-effectivity");e.copyEffToggle=new n({type:"switch",label:v.action_copy_effectivity,checkFlag:!0}).inject(t),e.copyEffToggle.addEventListener("change",(function(t){let i=e.modVerAutoComplete.isDisabled();e.copyEffToggle.checkFlag?(!i&&e.modVerAutoComplete.setDisabled(!0),e.modVerAutoComplete.unselectAll(),e.activeModelVersion=null,d.setAuthIDforWIW("evolution",null),e._WIWItemCreationModalView.applyCopyEffectivity()):(i&&e.modVerAutoComplete.setDisabled(!1),e._WIWItemCreationModalView.resetApplicableEvolution())}))},pushSelectModelVerView:function(e){var t=this;let i=t.cfgCtxInfo.itemModels;t.cfgCtxInfo.mapIdToItemModel={};var n=t.modalWindow.getElement(".config-selection").getElement(".autoCompleteSection");t.modVerAutoComplete=new g({showSuggestsOnFocus:!0,placeholder:v.ph_header_config_modver,disabled:t.cfgCtxInfo.bCopyEff,events:{onSelect:function(e){let i=t.cfgCtxInfo.mapIdToItemModel[e.model];t.activeModel={physicalid:i.physicalid,name:i.name},t.activeModelVersion={physicalid:e.physicalid?e.physicalid:e.modelVersionID,name:e.name?e.name:e.modelVersionName,revision:e.revision,backEndName:e.backEndName},t._WIWItemCreationModalView.applySelectedConfiguration(e)},onUnselect:function(){this.selectedItems&&0===this.selectedItems.length&&(t.activeModel=null,t.activeModelVersion=null,d.setAuthIDforWIW("evolution",null),t._WIWItemCreationModalView.resetApplicableEvolution())}}});let o=[],r=[];i.forEach((e=>{r.push(e.physicalid),t.cfgCtxInfo.mapIdToItemModel[e.physicalid]=e,o.push(f.getModelVersionFromModelPID(e))})),Promise.all(o).then((function(e){let i=[],o=[];e.forEach(((e,t)=>{let n=r[t];e.forEach((e=>{o.indexOf(e.id)<0&&i.push({modelVersionID:e.id,modelVersionName:e.attributes.MarketingName,revision:e.revision,value:e.attributes.MarketingName+" "+e.revision,subLabel:e.current_NLS,backEndName:e.name,model:n})}))})),t.modVerAutoComplete.addDataset({name:"model_version_select_data",items:i}),!t.cfgCtxInfo.bCopyEff&&t.previousModelVersion&&t.previousModelVersion.modelVersion&&t._retrieveModelVersionFromDataset(t.previousModelVersion.modelVersion),t.modVerAutoComplete.inject(n)}))},pushSetArchView:function(e){let t=this;return t.collection=e,t._WIWItemCreationModalView=new r({collection:e,cfgCtxInfo:t.cfgCtxInfo}),t._WIWItemCreationModalView.render(t.modalWindow),t.modalWindow},_retrieveModelVersionFromDataset:function(e){var t=this;e&&e.indexOf("pid")>=0&&(e=e.substring(4)),t.modVerAutoComplete.datasets.forEach((function(i){i.items.forEach((function(i){if(i.modelVersionID.indexOf("pid")>=0&&(i.modelVersionID=i.modelVersionID.substring(4)),i.modelVersionID===e)return t.modVerAutoComplete.onSelect(i),void t.modVerAutoComplete.dispatchEvent("onSelect",[i])}))}))}}})),define("DS/CATFLCockpitWidget/components/SpaceAssignment/Copy/SpaceAssignmentCopy",["DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/space.service","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r){return{open:function(e,i){var n=this;n.item=e,n.treeDocument=i,n.treeDocument.getSelectedNodes()[0].unselect(),n.tokenPostAdd=i.getXSO().onPostAdd(n._onXSOChanged.bind(n,e,i)),n.tokenPostRemove=i.getXSO().onPostRemove(n._onXSOChanged.bind(n,e,i)),t.alertMessage("success",null,r.msg_copy_space_success)},validateAndSubmit:function(){var e=this;if(void 0!==e.selectedNodes&&0!==e.selectedNodes.length){var i="";n.checkToUpdateSpace(e.selectedNodes).then((function(t){if(e.selectedNodes.forEach((function(e){"WARNING_PILOTDISC"==t[e.options.physicalid]&&(i+=e.options.label+"<br>")})),e._cleanAndDestroy(),""!==i){var n=UWA.createElement("div",{html:r.msg_has_piloting_discipline_list+"<br>"+i,styles:{"min-height":"100px","max-height":"210px","overflow-y":"auto"}});o.createWindow(r.label_confirm_warn_piloting_header,n,r.label_confrim_warn_piloting_button,(function(){e._submit()}))}else e._submit()}),(function(i){e._cleanAndDestroy(),t.displayError(i,null,null,r.msg_generic_error_get_failed)}))}else e._cleanAndDestroy()},_submit:function(){var n=this,o=[];n.item.options.assignedSpacesPID&&n.item.options.assignedSpacesPID.length>0&&n.item.options.assignedSpacesPID.forEach((function(e){o.push({options:{physicalid:e.obj}})}));var a,s=[],l=[];if(n.selectedNodes.forEach((function(e){var t=e.options.assignedSpacesPID;if(t&&t.length>0)for(var i=0;i<t.length;i++)s.push(t[i].owner),l.push(e)})),0===s.length){if(0==o.length)return void t.displayError("error",null,r.msg_error_no_space_assigned_src_dest);a=Promise.resolve()}else a=i.deleteSPPConnection(s,l);a.then((function(){(o.length>0?a.then((function(){return i.createSPPConnection(n.selectedNodes,o)})):Promise.resolve()).then((function(){e.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-spaces-by-id",data:n.selectedNodes})}))}))},_onXSOChanged:function(e,t){this.selectedNodes=t.getSelectedNodes().filter((function(t){return t.options.physicalid!==e.options.physicalid}))},_cleanAndDestroy:function(){var e=this;e.treeDocument.getXSO().unsubscribe(e.tokenPostAdd),e.treeDocument.getXSO().unsubscribe(e.tokenPostRemove)}}})),define("DS/CATFLCockpitWidget/components/CreateLogicalItemModal/logRef.createPanel.modalWindow",["UWA/Core","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/WUXAutoComplete/AutoComplete","DS/Controls/Button","DS/Controls/LineEditor","DS/Controls/SpinBox","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Controls/TooltipModel","DS/UIKIT/Mask","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.creation","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/services/pno.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f,m,h,v,C,y,b,_){"use strict";let w=h.getFullConfig(),D=w.identifiers;return{createFieldRowDiv:function(t,i,n,o,r,a){let s=e.createElement("div",{class:t});i&&s.setStyles(i);let l,c=e.createElement("label",{html:n,allowUnsafeHTML:!0}),d=e.createElement("div",{class:"mandIcon wux-ui-3ds wux-ui-3ds-new-create",styles:{color:"#ea4f37","vertical-align":"top","padding-left":"3px","font-size":"7px"}});a&&(l=e.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-info fonticon-display fonticon-color-display",styles:{color:"#77797c","padding-left":"4px","font-size":"12px"}}),l.tooltipInfos=new u({title:a.title,shortHelp:a.shortHelp,longHelp:a.longHelp,allowUnsafeHTMLShortHelp:!0}));var p=e.createElement("div",{class:"field-container"});return c.inject(p),r&&d.inject(p),a&&l.inject(p),p.inject(s),o.addClassName("elem-container"),o.inject(s),s},formatSubTypeList:function(e){var t=this;if(t.logRefSubTypes=h.getFullConfig().logicalRefSubTypes,t.logRefSubTypes&&t.logRefSubTypes.length<1&&(t.showSubtype=!1),t.logRefSubTypesCurated=[],t.showSubtype&&e){let n=null,o=null;for(let r in e){o=!1;for(var i=0;i<t.logRefSubTypes.length;i++)if(n=t.logRefSubTypes[i],r===n.Name){t.logRefSubTypesCurated.push(n),o=!0;break}o||t.logRefSubTypesCurated.push({NLS:r,Name:r,Package:e[r],PackageName:e[r],Parent:D.type_act_logref})}t.logRefSubTypesCurated.sort((function(e,t){return e.NLS.toLowerCase()<t.NLS.toLowerCase()?1:e.NLS.toLowerCase()>t.NLS.toLowerCase()?-1:0})),t.logRefSubTypesCurated.sort((function(e,t){return e.PackageName.toLowerCase()<t.PackageName.toLowerCase()?1:e.PackageName.toLowerCase()>t.PackageName.toLowerCase()?-1:0})),t.logRefSubTypesCurated.reverse()}},createAutocomplete:function(){var e=this,t=null,i=null,a=null;let s=!1,l=!1,c=localStorage.getItem("prevSelSubType");var d=new n({shouldBeSelected:function(e){return!e.options.isPackage}}),u=null;d.prepareUpdate();for(var p=null,g=0;g<e.logRefSubTypesCurated.length;g++)"True"!==(p=e.logRefSubTypesCurated[g]).Abstract&&(!(i=p.PackageName)||null!==t&&t===i||(null!==a&&(d.addRoot(a),a.expandAll()),a=new o({label:i,value:p.Package,isPackage:!0}),t=i),u=p.IconName?h.getTypeIconUrl(p.Name).iconPath:h.getTypeIconUrl(D.type_act_logref).iconPath,a.addChild(new o({label:p.NLS,icons:[u],isPackage:!1,value:p.Name})),p.Name===c?l=!0:p.Name===D.type_act_logref&&(s=!0));null!==a&&(d.addRoot(a),a.expandAll()),d.pushUpdate();var f=new r({elementsTree:d,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1});return f.getContent().addClassName("basicFieldAttribute"),f.addEventListener("change",e.manageEmptyField.bind(e,f,!0)),f.value=e.getPreviousSelectedSubType(c,l,s),f},getPreviousSelectedSubType:function(e,t,i){if(t)return e;if(i)return D.type_act_logref;let n="";for(var o=0;o<this.logRefSubTypesCurated.length;o++){let e=this.logRefSubTypesCurated[o];if("True"!==e.Abstract){n=e.Name;break}}return n},createCustomFields:function(t,i){var n,o,a,d=this,u=null;t.forEach((function(t){var p,g={};if(u=i[t],n=u.format,o=void 0!==u.editable&&!u.editable,p=null,a=null,null,"string"==n||"number"==n||"enum"==n||"boolean"==n){switch(n){case"string":(p=new s({placeholder:_.ph_title,value:void 0===u.value?void 0===u.defaultValue?"":u.defaultValue:u.value,disabled:o,selectAllOnFocus:!0,displayClearFieldButtonFlag:!0})).getContent().getElement("input").addClassName("customFieldAttribute"),g.type="textBox",g.required=u.required,p.addEventListener("change",d.manageEmptyField.bind(d,p,g.required));break;case"enum":var f=u.range,m=u.rangeLabel,h="";h=u.value?u.value:u.defaultValue?u.defaultValue:"";for(var v=[],C=0;C<f.length;C++)v.push({label:void 0!==m?m[C]:f[C],value:f[C]});(p=new r({elementsTree:v,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1,disabled:o})).value=h,g.type="dropDown",g.required=u.required,p.addEventListener("change",d.manageEmptyField.bind(d,p,g.required));break;case"number":h="";u.defaultValue&&(h=u.defaultValue),u.value&&(h=u.value),p=new l({value:h,maxValue:1e7,stepValue:1,disabled:o}),g.type="numberBox",g.required=u.required,p.addEventListener("change",d.manageEmptyField.bind(d,p,g.required));break;case"boolean":p=new c({type:"switch",disabled:o,checkFlag:void 0===u.value?void 0!==u.defaultValue&&u.defaultValue:u.value}),g.type="checkBox",g.required=u.required;break;default:return}a=e.createElement("div",{class:"custom-field-container"}),g.element=p,g.label=u.label,g.key=t,p.inject(a),p.getContent().addClassName("customFieldAttribute"),d.createFieldRowDiv("customFieldRow",null,u.label,a,null,null).inject(d.logRefCreateForm),d._inputElemList.push(g)}}))},createFooter:function(){var e=null,t=null,i=null,n={};if(null===this.rootID)e=_.msg_create_and_open,t="btn-create-and-close";else if(this.isReplaceCall)e=_.msg_create_and_replace,t="btn-replace-and-close";else{e=_.action_create,i=_.msg_create_and_close,t="btn-create";var o=new a({label:i});o.getContent().classList.add("btn-create-and-close")}var r=new a({label:e});r.getContent().classList.add(t);var s=new a({label:_.action_close,onClick:function(){document.getElementById("create-logicalref-immersiveFrame").destroy()}});return s.getContent().classList.add("btn-close"),n={Cancel:s,Ok:r},null!=i&&o&&(n.Apply=o),n},createTitleField:function(){var t,i=this,n=new s({placeholder:_.ph_title,selectAllOnFocus:!0,sizeInCharNumber:w.adminStatus.ReferenceTitleMaxLength||100,displayClearFieldButtonFlag:!0});n.getContent().getElement("input").addClassName("basicFieldAttribute"),t={type:"textBoxNameField",required:!1,element:n},i._inputElemList.push(t);var o=e.createElement("div",{class:"title-box"});n.inject(o),i.createFieldRowDiv("titleFieldRow",null,_.label_title,o,null,null).inject(i.logRefCreateForm)},createTypeField:function(){var t=this,i=t.createAutocomplete(),n={type:"dropDownTypeField",required:!1,element:i,label:_.label_type};t._inputElemList.push(n);var o=e.createElement("div",{class:"item-type-selector"});i.inject(o),t.createFieldRowDiv("typeFieldRow",null,_.label_type,o,!0,null).inject(t.logRefCreateForm),i.addEventListener("change",(function(){w.credential.createCredentials=void 0,t._createCollabSpaceField(i.value)}))},_createCollabSpaceField:async function(t){let i=this;document.getElementsByClassName("csFieldRow").length>0&&document.getElementsByClassName("csFieldRow")[0].remove(),w.credential.createCredentials||await b.getCreateCredentials(t);let n=[...w.credential.createCredentials.values()].map((e=>({label:e[0].prjtitle,value:e[0].prjname}))),o=1==n.length;null==w.credential.collabspace&&(w.credential.collabspace=n[0].value,w.credential.org=w.credential.createCredentials.get(w.credential.collabspace)[0].orgname);let r=new d({elementsList:n,enableSearchFlag:!1,disabled:o,value:w.credential.collabspace});r.getContent().addClassName("csFieldRow");let a={type:"csField",required:!0,element:r,label:_.project},s=i._inputElemList.findIndex((e=>e.type===a.type));-1!==s?i._inputElemList[s]=a:i._inputElemList.push(a);let l=e.createElement("div",{class:"cs-Container"});r.inject(l);let c={title:_.PrjHelp_title,shortHelp:_.PrjHelp_short,longHelp:_.PrjHelp_long};i.createFieldRowDiv("csFieldRow",null,_.project,l,!0,c).inject(i.logRefCreateForm),i._createOrgField(r),r.addEventListener("change",(function(){i._createOrgField(r)}))},_createOrgField:function(t){let i=this;document.getElementsByClassName("orgFieldRow").length>0&&document.getElementsByClassName("orgFieldRow")[0].remove();let n=t.value,o=[...w.credential.createCredentials.get(n)].map((e=>({label:e.orgtitle,value:e.orgname}))),r=1==o.length,a=new d({elementsList:o,enableSearchFlag:!1,value:w.credential.org,disabled:r});a.getContent().addClassName("orgFieldRow");var s=e.createElement("div",{class:"org-Container"});a.inject(s);let l,c={type:"orgField",required:!0,element:a,label:_.organization},u=i._inputElemList.findIndex((e=>e.type===c.type));-1!==u?i._inputElemList[u]=c:i._inputElemList.push(c),1===new Set([...w.credential.createCredentials.values()].flat().map((e=>e.orgname))).size&&(l={display:"none"});let p={title:_.OrgHelp_title,shortHelp:_.OrgHelp_short,longHelp:_.OrgHelp_long};i.createFieldRowDiv("orgFieldRow",l,_.organization,s,!0,p).inject(i.logRefCreateForm)},create:function(n,o,r,a,s,l,c){var d=this;d._inputElemList=[],d.showSubtype=s,d.isReplaceCall=a,d.modelEventsContentListView=C.getFLWebModelEventsObj("flcockpit-content-list-view"),d.parentID=o?o.options.physicalid:null,d.rootID=o?o.getRoot().options.physicalid:null,d.parentItem=o,o&&d.isReplaceCall&&(d.replaceRefId=o.getParent().options.physicalid,d.replaceInsId=o.options.instance.physicalid,d.replaceRootId=o.getRoot().options.physicalid);var u=d.createFooter(),p=new t({domId:"create-logicalref-immersiveFrame"});null!=n&&p.inject(n),d.logRefCreateForm=e.createElement("div",{class:"logRef-create-form"}),d.modal=new i({title:_.action_add_new,content:d.logRefCreateForm,domId:"create-logicalref-dialog",immersiveFrame:p,width:580,resizableFlag:!0,buttons:u,modalFlag:!0}),d.modal.close=function(){document.getElementById("create-logicalref-immersiveFrame").destroy()},d.createTitleField(),d.showSubtype&&(d.formatSubTypeList(l),d.createTypeField()),d._createCollabSpaceField(localStorage.getItem("prevSelSubType"));var g=r.fieldNames,f=r.fields;for(var m in g&&d.createCustomFields(g,f),d.modal.buttons){var h=d.modal.buttons[m];null===d.rootID||d.isReplaceCall||h.getContent().hasClassName("btn-create")&&(h.onClick=function(){d._createReferenceItem(!1,c)}),d.isReplaceCall?h.getContent().hasClassName("btn-replace-and-close")&&(h.onClick=function(){d._createReferenceItem(!0,c)}):h.getContent().hasClassName("btn-create-and-close")&&(h.onClick=function(){d._createReferenceItem(!0,c)})}return d.modal},_createReferenceItem:function(e,t){for(var i,n,o,r,a,s,l,c=this,d={},u=0;u<c._inputElemList.length;u++)if("textBoxNameField"===(r=c._inputElemList[u]).type)i=r.element.value.trim();else if("dropDownTypeField"===r.type){if(!r.element.value||""==r.element.value)return m.alertMessage("error",null,_.req_field_error_header,_.replace(_.error_field_reqd,{field:r.label})),r.element.getContent().getElement("input").addClassName("error-empty-field"),void r.element.getContent().focus();n=r.element.value,localStorage.setItem("prevSelSubType",n)}else if("csField"===r.type)a=r.element.value;else if("orgField"===r.type)s=r.element.value;else{if("checkBox"===r.type)o=r.element.checkFlag;else if(o=r.element.value,r.required&&(!o||""==r.element.value))return m.alertMessage("error",null,_.req_field_error_header,_.replace(_.error_field_reqd,{field:r.label})),r.element.getContent().getElement("input").addClassName("error-empty-field"),void r.element.getContent().focus();d[r.key]=o}if(null!=a){null==s&&(s=w.credential.createCredentials.get(a)[0].orgname);let e=w.credential.createCredentials.get(a).filter((e=>e.orgname==s)).map((e=>e.rolename))[0];l=e+"."+s+"."+a,w.credential={...w.credential,role:e,org:s,collabspace:a}}p.mask(c.modal.elements._contentDiv,_.msg_creating),(c.isReplaceCall&&c.replaceRefId&&c.replaceInsId?f.replaceWithNewRef(c.replaceRefId,c.replaceInsId,i,n,d,l):null===c.rootID?g.createNewItemReference(i,n,d,l):g.createNewItemInstance(c.parentID,c.rootID,i,n,d,l)).then((function(i){if(p.unmask(c.modal.elements._contentDiv),null!==c.rootID||c.isReplaceCall)if(c.isReplaceCall&&c.replaceRootId)if(document.getElementById("create-logicalref-immersiveFrame").destroy(),200==i.status||i.member){if(i.member?i.member[0]:null){let e=[(n=t.getMappedNodesFromId(c.parentItem.options.physicalid))[0].options.instance.physicalid];v.refreshNodesOnReplace({replaceDetails:i.member,selectedNodes:n,instID:e}).then((function(){m.alertMessage("success",null,"",_.msg_replace_success)}))}}else m.alertMessage("error",null,"",i.message);else{var n;if(e&&document.getElementById("create-logicalref-immersiveFrame").destroy(),i&&i.member)(n=t.getMappedNodesFromId(c.parentItem.options.physicalid))||(n=[c.parentItem]),v.addChildrenToParent(t,n,i.member,!0)}else document.getElementById("create-logicalref-immersiveFrame").destroy(),C.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:i.id?i.id:i.physicalid}})}),(function(e){document.getElementById("create-logicalref-immersiveFrame").destroy(),m.displayError(e,null,null,_.error_create_item)}))},manageEmptyField:function(e,t){t&&(e.value&&e.value.length>0?e.getContent().getElement("input").removeClassName("error-empty-field"):e.getContent().getElement("input").addClassName("error-empty-field"))}}})),define("DS/CATFLCockpitWidget/components/CreateLogicalItemModal/CreateLogicalItemHelper",["DS/CATFLCockpitWidget/utils/config.util","DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/pno.service","DS/CATFLCockpitWidget/components/CreateLogicalItemModal/logRef.createPanel.modalWindow","DS/CATFLCockpitWidget/components/CreateLogicalItemModal/SAXPLMNew/SAXPLMNewCmdUtils","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l){"use strict";var c=e.getFullConfig(),d=c.identifiers;return{createNewLogicalItem:function(e){var t=null,i=!1;!e.isRoot&&e.treeDocument&&(t=0===e.treeDocument.getSelectedNodes().length?e.treeDocument.getRoots()[0]:e.treeDocument.getSelectedNodes()[0]),e.data&&e.data.isReplaceCall&&(i=!0),c?.adminStatus?.NewCreationPanelEnabled?this.createNewPLMNew({parentItem:t,isReplaceCall:i,treeDocument:e.treeDocument,xRevision:c.xRevision}):this.createNewSAX({parentItem:t,isReplaceCall:i,treeDocument:e.treeDocument})},createNewSAX:async function(e){let s=widget.body.querySelector(".fl-cockpit-app-container");t.mask(s,l.msg_loading),r.getCreateCredentials(localStorage.getItem("prevSelSubType")).then((function(){n.getCustomField(e.parentItem).then((function(r){var c=d.param_subtype_key;o.getParameterizationSetting([c]).then((function(o){var d=!o||o[c];if(d){let o="";e.parentItem&&e.parentItem.options.grid&&e.parentItem.options.grid.actualType&&(o=e.parentItem.options.grid.actualType),n.getSubTypes(o).then((function(n){n&&Object.keys(n).length>0?a.create(s,e.parentItem,r,e.isReplaceCall,d,n,e.treeDocument):i.alertMessage("info",null,l.warn_instantiation_not_allowed),t.unmask(s)}),(function(){i.alertMessage("error",null,l.error_get_subtypes),t.unmask(s)}))}else a.create(s,e.parentItem,r,e.isReplaceCall,d,null,e.treeDocument),t.unmask(s)}),(function(){t.unmask(s)}))}),(function(){t.unmask(s)}))}),(function(){t.unmask(s)}))},createNewPLMNew:function(e){s.init(e)}}})),define("DS/CATFLCockpitWidget/components/DisciplineIterations/lastOutfittedState.compare",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s){"use strict";var l=function(e){this.options=e};return l.prototype.render=function(){var e=this,a={instanceId:e.options.selectedNodes[0].options.instance.physicalid,occurrenceInfo:r.confAllImplPathsOnNodes(e.options.selectedNodes,!1,!1).payload};o.compareWithLastOutfitted(a).then((function(n){var o=e.getCompareOptionsContainer(n);e.dialog=new t({title:s.compareWithLastOutfitted,content:o,width:350,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Cancel:new i({emphasize:"secondary",onClick:function(){e.dialog.close()}})}}),e.dialog.addEventListener("close",(function(){e.dialog.destroy()}))})).catch((function(e){n.displayError(e,null,null,s.error_compare_last_outfitted)}))},l.prototype.getCompareOptionsContainer=function(t){var i=this,n=e.createElement("div",{class:"compare-options-container"}),o=e.createElement("div",{class:"compare-options-subcontainer"}).inject(n);i._createItemCompareSection(t.compareLogicalItem).inject(o);var r=e.createElement("div",{class:"compare-options-subcontainer"}).inject(n);i._createPilotingDiscCompareSection(t.pilotingDisciplines).inject(r);var a=e.createElement("div",{class:"compare-options-subcontainer"}).inject(n);return i._createPropSolnCompareSection(t.proposedSolutions).inject(a),n},l.prototype._createItemCompareSection=function(t){var n=this,o=t.left,r=t.right,a=o.title+" "+o.revision,l=r.title+" "+r.revision,c=e.createElement("div",{class:"compare-item-container"});e.createElement("div",{class:"compare-options-subheader",html:s.label_log_ref}).inject(c);var d=e.createElement("div",{class:"compare-item-subcontainer"}).inject(c),u=e.createElement("div",{class:"compare-row-container"}).inject(d);e.createElement("div",{html:a+" with "+l}).inject(u);var p=[];return p.push({physicalid:o.physicalid,label:a},{physicalid:r.physicalid,label:l}),new i({label:s.compare,emphasize:"primary",onClick:function(){n.launchCompare(p)}}).inject(u),c},l.prototype._createPilotingDiscCompareSection=function(t){var n=this,o=e.createElement("div",{class:"compare-item-container"});e.createElement("div",{class:"compare-options-subheader",html:s.header_subtitle_piloting_disc}).inject(o);var r=e.createElement("div",{class:"compare-item-subcontainer"}).inject(o);if(t)return t&&t.compare&&t.compare.forEach((function(t){var o=e.createElement("div",{class:"compare-row-container"}).inject(r),a=t.left,l=t.right,c=a.title+" "+a.revision,d=l.title+" "+l.revision;e.createElement("div",{html:c+s.anchor_with+d}).inject(o);var u=[];u.push({physicalid:a.physicalid,label:c},{physicalid:l.physicalid,label:d}),new i({label:s.compare,emphasize:"primary",onClick:function(){n.launchCompare(u)}}).inject(o)})),t&&t.unchanged&&n._createViewRowDispSection({type:"pilotingDisciplines",items:t.unchanged,value:s.label_unchanged,container:r}),t&&t.newlyDefined&&n._createViewRowDispSection({type:"pilotingDisciplines",items:t.newlyDefined,value:s.label_newlyDefined,container:r}),t&&t.previouslyDefined&&n._createViewRowDispSection({type:"pilotingDisciplines",items:t.previouslyDefined,value:s.label_previouslyDefined,container:r}),o;r.innerHTML=s.label_none},l.prototype._createPropSolnCompareSection=function(t){var n=this,o=[],r=e.createElement("div",{class:"compare-item-container"}),a=e.createElement("div",{class:"compare-options-subheader"}).inject(r);e.createElement("div",{html:s.label_proposed_solution}).inject(a);var l=e.createElement("div",{class:"compare-item-subcontainer"}).inject(r);if(t){if(t&&t.compare){var c=e.createElement("div",{class:"compare-row-container"}).inject(l),d=e.createElement("div",{class:"solns-container"}).inject(c);t.compare.forEach((function(t){var i=t.title+" "+t.revision;e.createElement("div",{html:i}).inject(d),o.push({physicalid:t.physicalid,label:i})}))}return t&&t.unchanged&&(n._createViewRowDispSection({type:"proposedSolutions",items:t.unchanged,value:s.label_unchanged,container:l}),t.unchanged.forEach((function(e){o.push({physicalid:e.physicalid,label:e.title+" "+e.revision})}))),t&&t.newlyDefined&&(n._createViewRowDispSection({type:"proposedSolutions",items:t.newlyDefined,value:s.label_newlyDefined,container:l}),t.newlyDefined.forEach((function(e){o.push({physicalid:e.physicalid,label:e.title+" "+e.revision})}))),t&&t.previouslyDefined&&(n._createViewRowDispSection({type:"proposedSolutions",items:t.previouslyDefined,value:s.label_previouslyDefined,container:l}),t.previouslyDefined.forEach((function(e){o.push({physicalid:e.physicalid,label:e.title+" "+e.revision})}))),o&&o.length>1&&new i({label:s.compare_all,emphasize:"primary",onClick:function(){n.launchCompare(o)}}).inject(a),r}l.innerHTML=s.label_none},l.prototype._createViewRowDispSection=function(t){var i=e.createElement("div",{class:"info-row-container"}).inject(t.container);e.createElement("div",{html:"<b><em>"+t.value+"</em></b>"}).inject(i);var n=e.createElement("div",{class:"info-row-container"}).inject(i),o=e.createElement("div").inject(n);t.items.forEach((function(t){e.createElement("div",{html:t.title+" "+t.revision}).inject(o)}))},l.prototype.launchCompare=function(e){a.init("CompareCmd",e)},l})),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.effectivity",["DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/parser/database.parser","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a){"use strict";var s=t.getFullConfig(),l={modifiedEditCfgCtx:function(t){let i=this.ctxItemPage?this.ctxItemPage:this,r=i.contentListView.contentView.getTreeDocument();if("cfgEditConfigurationContext"===t.commandName){let t,a=[],s=r.getSelectedNodes(),c=i.contentListView.contentView.layout.getColumnVisibleFlag("ConfigurationContext");s&&s.length>0?(t=s[0].options.physicalid===i.itemId||!1,s.forEach((function(e){a.push(e.options.physicalid)}))):(t=!0,a.push(i.itemId));let d=!!c;t?n.getConfigContextInfo([i.itemId]).then((function(t){if(t){let n,s=o.parseItemToConfigCtx(t.contextInfo)[i.itemId];if(s&&s.contexts){n=[];for(let e in s.contexts)s.contexts.hasOwnProperty(e)&&n.push({name:s.contexts[e].backEndName,physicalid:e,displayName:s.contexts[e].name})}let c=e.getFLWebModelEventsObj("flweb-model-events"),u=widget.getValue("modelAttached"),p=widget.getValue("currentConfig"),g=function(){widget.setValue("modelAttached",n),widget.setValue("currentConfig",null),i._loadItemWithConfigCtx(n)};u?s?(widget.setValue("modelAttached",n),p&&Object.keys(s.contexts).indexOf(p.model.physicalid)<0?(d=!1,g()):d=!0):(d=!1,c.publish({event:"mod-selection-removed",data:{itemID:i.itemId}})):s?(d=!1,g()):d=!0,d&&l.updateCfgCtxColumn(a,r)}})):d&&l.updateCfgCtxColumn(a,r)}},updateCfgCtxColumn:function(e,t){var i=this,n={relids:[],pids:e},o=[],r=s.gridview.additionalColumnsModules.cfgContext;if(r){var a=new Promise((function(e){r.updateAttributes(n,(function(t){var i=UWA.is(t,"string")?JSON.parse(t):t;e(i)}),i)}));o.push(a),o.length?Promise.all(o).then((function(i){let n=i&&i[0]?i[0].pids:{};t.withTransactionUpdate((function(){e.forEach((function(e){t.getMappedNodesFromId(e).forEach((function(t){let i={grid:n[e]};t.updateOptions(i)}))}))}))})).catch((function(){console.log("An Error Occured")})):console.info("No cfg ctx to update")}},refreshEffectivityChanges:function(e){let t=this.ctxItemPage?this.ctxItemPage:this;e=JSON.parse(e);let i=t.contentListView.contentView.getTreeDocument(),n=e.commandName,o=e.response?e.response.results:null,r=[],a=[];switch(n){case"cfgExtendEvolutionEffectivity":case"cfgEditEvolution":case"cfgPasteEvolution":"cfgExtendEvolutionEffectivity"===n?(o=e.response.resources,o.forEach((function(e){"SUCCESS"===e.status&&e.identifier?a.push(e.identifier):"FAILED"===e.status&&r.push(e.errorDetails)}))):o.forEach((function(e){e.existing&&"SUCCESS"===e.status?a.push(e.existing.pid):"FAILED"===e.status&&r.push(e.errorDetails)})),a.length&&l.refreshCfgValues({treeDocument:i,relids:a});break;case"cfgInlineVariant":case"cfgEditVariant":case"cfgMassEditVariant":case"cfgPasteVariant":let u,p=[];o.forEach((function(e){"SUCCESS"===e.status?e.new?(u={oldId:e.existing.pid,newId:e.new.pid},p.push(u)):a.push(e.existing.pid):"FAILED"===e.status&&r.push(e.errorDetails)})),p.length&&l.splitInstance({treeDocument:i,couples:p}),a.length&&l.refreshCfgValues({treeDocument:i,relids:a});break;case"cfgRevManualComposition":let g=e.data.pids;var c={pids:g},d=s.gridview.additionalColumnsModules.ConfigurationRevision;d&&new Promise((function(e,i){d.updateAttributes(c,(function(t){var n=UWA.is(t,"string")?JSON.parse(t):t;e(n),i("Error in CfgRev_updateAttributes")}),t)})).then((function(e){let t=e?e.pids:{};Object.keys(t).length>0&&i.withTransactionUpdate((function(){g.forEach((function(e){var n=i.getMappedNodesFromId(e),o=t[e]?t[e].ConfigurationRevision:"";n.forEach((e=>{e.updateOptions({grid:{ConfigurationRevision:o}})}))}))}))}))}},refreshCfgValues:function(e){var i=this;if(e.relids&&e.relids){var n=e.pids||[],o=e.relMap||{};(n.length<=0||Object.keys(o).length<=0)&&e.relids.forEach((function(i){var r=e.treeDocument.getRoots()[0].getNodesByRelId(i);r&&r.length&&(r.forEach((e=>{t.SAXStorage().setItem(s.localStorageKeys.recentlyAuthoredStructure+e.getParent().options.physicalid,Date.now()),n.push(e.getID())})),o[i]?o[i].push(...r):o[i]=r)}));var r={relids:e.relids,pids:n},l=[],c=s.gridview.additionalColumnsModules.cfgEffectivty;if(c){var d=new Promise((function(e){c.updateAttributes(r,(function(t){var i=UWA.is(t,"string")?JSON.parse(t):t;e(i)}),i)}));l.push(d),l.length?Promise.all(l).then((function(t){let i={};t&&t.length&&t.forEach((e=>{e.relids&&(i=e.relids)})),e.treeDocument.withTransactionUpdate((function(){e.relids.forEach((function(e){var t=o[e];if(t&&t.length){var n=i[e];n.VariantEffectivity.trim()||(n.VariantEffectivity=a.label_none),n&&t.forEach((e=>{e.updateOptions({grid:n})}))}}))}))})).catch((function(){console.log("An Error Occured")})):console.info("No cfg to update")}else console.info("No cfg Module")}else console.error("no relids to refresh")},splitInstance:function(e){let i,n,o,a,c,d,u,p={},g=[],f=[];e.treeDocument.withTransactionUpdate((function(){try{for(let l=0;l<e.couples.length;l++)if(i=e.couples[l].oldId,n=e.couples[l].newId,o=e.treeDocument.getRoots()[0].getNodesByRelId(i),o&&o.length>0){p[i]?p[i].push(...o):p[i]=o,p[n]||(p[n]=[]),g.indexOf(i)<0&&g.push(i),g.indexOf(n)<0&&g.push(n);for(let e=0;e<o.length;e++)a=o[e],a&&(f.push(a.getID()),c=a.getParent(),c&&(u=UWA.clone(a.options,!1),u.grid=UWA.clone(a.options.grid),u.instance=UWA.clone(a.options.instance),d=new r(u),d.setRelationID(n),d.options.instance.physicalid=n,d.options.hasBeenExpanded=!1,d.options.noIndexOrDBExpand=!1,d.collapse(),c.insertBefore(d,a),d.options.actualParent=c,p[n].push(d),t.SAXStorage().setItem(s.localStorageKeys.recentlyAuthoredStructure+c.options.physicalid,Date.now())))}}catch(e){console.error("error >>:",e)}finally{console.info("splitInstance done")}})),e.relids=g,e.pids=f,e.relMap=p,l.refreshCfgValues(e)}};return l})),define("DS/CATFLCockpitWidget/components/ArchitectureNumber/checkArchitectureNumberUnicity",["UWA/Core","DS/Controls/Loader","DS/Controls/ModalContainer","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/pno.util","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/Controls/Toggle","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/Accordeon","DS/Controls/Label","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/utils/checkArchitectureNumberUnicity.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f,m,h,v,C,y){"use strict";var b=r.getFullConfig(),_=function(e){this.refWithConfig=e.refWithConfig,this.nodesToCheck=e.nodesToCheck,this.dialog=null,this.gridView=null,this.multiModels=!1;var n=new t({text:y.msg_loading});i.createModal(widget.body,n.elements.container),n.on(),this._createCheckANUnicityComponent().then((function(){n.off(),i.removeModal(widget.body)}))};return _.prototype._createModalArchitectureNumberUnicity=function(){var t=this,i=new s({title:y.action_architecture_number_unicity_effectivity,height:700,width:1400,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,visibleFlag:!1});i.addEventListener("close",(function(){i.destroy(),t.gridView&&t.gridView.destroy()}));var n=e.createElement("div",{class:"container-unicity-AN"});return i.elements._contentDiv.appendChild(n),i},_.prototype._displayModalArchitectureNumberUnicity=function(){this.dialog&&!this.dialog.visibleFlag&&(this.dialog.visibleFlag=!0)},_.prototype._createCheckANUnicityComponent=function(){var e=this;return v.getConfigContextInfo([e.refWithConfig.options.physicalid]).then((function(i){i?(e.configCtxResp=i,i.contextInfo&&i.contextInfo.length>0?(e.dialog=e._createModalArchitectureNumberUnicity(),e.loader=new t({text:y.msg_loading}),i.contextInfo.length>1?(e.multiModels=!0,e._displayModalArchitectureNumberUnicity(),e._manageComponentForMoreThanOneModel(i)):e._manageComponentForOneModel(i)):n.alertMessage("error",null,y.error_no_model_attached)):n.alertMessage("error",null,y.error_info_models)}))},_.prototype._manageComponentForOneModel=function(e){var t=e.contextInfo[0].content&&e.contextInfo[0].content.results&&e.contextInfo[0].content.results.length>0?e.contextInfo[0].content.results[0]:null,i="",n="";t.data&&t.data.length>0&&t.data[0]&&t.data[0].value&&t.data[0].value.length>0&&t.data[0].value[0]&&"Marketing Name"==t.data[0].name&&(n=t.data[0].value[0]),t.basicData.forEach(((e,t)=>{"name"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(i=e.value[0])}));var o={physicalid:t.physicalID,name:i,title:n};this._manageCheckANUnicityForModel(o)},_.prototype._manageComponentForMoreThanOneModel=function(e){var t=this;t.tilecollectionOfModels=t.displayModelListChoice(e.contextInfo,t.dialog.elements._contentDiv.getElementsByClassName("container-unicity-AN")[0]),t.tilecollectionOfModels.onSelectionAdd((function(){t.dialog.buttons.Ok.disabled=!1})),t.dialog.title=y.action_architecture_number_unicity_effectivity+" - "+t.refWithConfig.options.label+" - "+y.label_select_model,t.dialog.buttons={Ok:new g({label:y.label_next,emphasize:"primary",onClick:function(){if(t.tilecollectionOfModels&&t.tilecollectionOfModels.TreedocModel&&t.tilecollectionOfModels.TreedocModel.getSelectedNodes().length>0){t.dialog.buttons.Ok.disabled=!0;var e=t.tilecollectionOfModels.TreedocModel.getSelectedNodes()[0].options.dataModel;t._manageCheckANUnicityForModel(e)}},disabled:!0}),Cancel:new g({emphasize:"secondary",onClick:function(){t.dialog.close()}})}},_.prototype.displayDuplicatedArchitectureNumbers=function(t,i,n){var o=[{text:y.label_title,dataIndex:"tree",editableFlag:!1,sortableFlag:!0,alwaysVisibleFlag:!0,pinned:"left"},{dataIndex:"revision",text:b.nlsBasicAttributesBO["ds6wg:revision"],textExport:b.nlsBasicAttributesBO["ds6wg:revision"],visibleFlag:!0,editableFlag:!1,pinned:"left",width:90},{icon:{iconName:"object-instance"},dataIndex:"instanceName",text:b.nlsBasicAttributesBO["ds6w:label"],textExport:y.label_title_instance,visibleFlag:!0,editableFlag:!1},{text:y.label_an_valid,dataIndex:"isANValid",typeRepresentation:"boolean",width:80,getCellClassName:function(e){return e&&e.nodeModel?!0===e.nodeModel.options.grid.isANValid?"sax-is-valid-AN-true":"sax-is-valid-AN-false":null},getCellTooltip:function(e){var t="";if(e&&e.nodeModel){var i=e.nodeModel.options.grid.isANValid;void 0!==i&&(t=!0===i?y.label_valid:y.label_invalid)}return{getAllInformationCB:()=>({model:{shortHelp:t}})}},alwaysVisibleFlag:!0},{text:y.label_intersection_effectivity,dataIndex:"intersectionEffectivity",typeRepresentation:"string",alwaysVisibleFlag:!0},{text:y.label_current_evolution,dataIndex:"effCurrentEvol",alwaysVisibleFlag:!0,sortableFlag:!1,editableFlag:!1}];n&&o.push({text:y.label_variant_option,dataIndex:"effVariant",alwaysVisibleFlag:!0,sortableFlag:!1,editableFlag:!1});var r=new d({identifier:"grid-view-unicity-AN-effectivity",height:"inherit",treeDocument:new l({useAsyncPreExpand:!0}),columns:o,rowSelection:"none",defaultColumnDef:{width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!1,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t}}),a={label:{filterId:"stringRegexp"},isANValid:{filterId:"set",filterModel:[]}};n?C.registerFilterForArraysValues(r.treeDocument):a.intersectionEffectivity={filterId:"stringRegexp"},r.treeDocument.setFilterModel(a),r.treeDocument.empty();var s=[];return Object.values(t)&&Object.values(t).length>0&&Object.values(t).forEach(((e,t)=>{s=s.concat(Object.keys(e))})),C.updateDisplayedEffectivityForNodes(s).then((function(n){var o=n,a=e.createElement("div",{class:"container-checkAN-gridView"});for(var s in i.appendChild(a),a.appendChild(r.getContent()),r.treeDocument.prepareUpdate(),t){var l=new c({label:s,icons:["progress-3"]});for(var d in t[s]){var u={isANValid:!(t[s][d].intersectionEffectivity.length>0),intersectionEffectivity:t[s][d].intersectionEffectivity.map((function(e){var t=e.productConfiguration?"-"+e.productConfiguration.marketingName:"";return e.modelversion.displayValue+"-"+e.modelversion.revision+t})),effCurrentEvol:o[d]?o[d].evolution:t[s][d].nodeInstance.options.grid.CurrentEvolutionEffectivity,effVariant:o[d]?o[d].variant:t[s][d].nodeInstance.options.grid.VariantEffectivity};u=e.merge(u,t[s][d].nodeInstance.options.grid);var p=new c({label:t[s][d].nodeInstance.options.label,icons:t[s][d].nodeInstance.options.icons,grid:u});l.addChild(p)}r.treeDocument.addRoot(l)}return r.treeDocument.expandAll(),r.treeDocument.pushUpdate(),r}))},_.prototype._createMessageContentInDialog=function(t){var i=e.createElement("div",{class:"dialogMessage",html:t}),n=this.dialog.elements._contentDiv.getElementsByClassName("container-unicity-AN")[0];n.empty(),n.appendChild(i)},_.prototype._manageCheckANUnicityForModel=function(e){var t=this,o=C.getInstancesWithDuplicatedAN(t.nodesToCheck);if(o&&o.length>0)return t.loader.visibleFlag||(i.createModal(t.dialog.elements.container,t.loader.elements.container),t.loader.on()),v.getMVandPCinformationFromModel(e).then((function(e){var n=e.modelversions.filter((e=>e.productConfigurations.length>0&&e.productConfigurations.filter((e=>e.attributes.FilterCompiledForm)).length>0));if(n.length>0){var o=JSON.parse(localStorage.getItem(b.localStorageKeys.selectedPCcheckAN||null));t.manageCheckANForProductConfig(e,o),t.loader.visibleFlag&&(t.loader.off(),i.removeModal(t.dialog.elements.container))}else t.manageCheckANForEvolution(e)})).catch((function(o){o&&"No_ModelVersions"===o.message?n.alertMessage("error",null,y.replace(y.msg_no_modelVersions,{modelName:e.title})):n.alertMessage("error",null,y.msg_error_an_unicity_configuration),t.loader.visibleFlag&&(t.loader.off(),i.removeModal(t.dialog.elements.container)),t.multiModels||t.dialog.close()}));var r="";return r=o?y.msg_no_an_duplication:y.msg_an_not_assigned,t._displayModalArchitectureNumberUnicity(),t.dialog.title=y.action_architecture_number_unicity_effectivity+" - "+e.title,t._createMessageContentInDialog(r),t.dialog.buttons={Close:new g({emphasize:"secondary",onClick:function(){t.dialog.close()}})},t.multiModels&&(t.dialog.buttons.Reset=new g({label:y.action_previous,emphasize:"secondary",onClick:function(){t._manageComponentForMoreThanOneModel(t.configCtxResp)}}),t.dialog._applyButtons()),Promise.resolve()},_.prototype.displayModelListChoice=function(e,t){var i=new l,n=new h({selectionBehavior:{canMultiSelect:!1,toggle:!1,unselectAllOnEmptyArea:!1}}).inject(t);return e.forEach(((e,t)=>{var n=e.content&&e.content.results&&e.content.results.length>0?e.content.results[0]:null;if(n){var o="",a="",s="",l="",d=r.getServiceURL("3DSpace")+"/common/images/I_Model_Thumbnail.png";n.data&&n.data.length>0&&n.data[0]&&n.data[0].value&&n.data[0].value.length>0&&n.data[0].value[0]&&"Marketing Name"==n.data[0].name&&(o=n.data[0].value[0]),n.basicData.forEach(((e,t)=>{"name"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(a=e.value[0]),"owner"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(s=e.value[0]),"current"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(l=e.value[0])}));var u=new c({label:o,thumbnail:n.preview_url&&""!==n.preview_url?n.preview_url:d,subLabel:a+" | "+s,description:y.label_maturity+" : "+l,dataModel:{physicalid:n.physicalID,name:a,title:o}});i.addRoot(u)}})),n.loadApplicativeModel(i),n},_.prototype.exportCSV=function(e,t,i){var o=this,a=o.gridView.treeDocument,s=[{text:y.label_arch_no,dataIndex:"architectureNo"}];o.gridView.columns.forEach(((e,t)=>{s.push({text:e.textExport?e.textExport:e.text,dataIndex:e.dataIndex})}));var u=new d({treeDocument:new l({useAsyncPreExpand:!0}),columns:s,defaultColumnDef:{width:"auto"}});u.treeDocument.empty(),u.treeDocument.prepareUpdate(),a&&a.getChildren()&&a.getChildren().forEach(((e,t)=>{var i=new c({label:"",grid:{architectureNo:e.options.label}});u.treeDocument.addChild(i),e.getChildren().forEach(((e,t)=>{var i=new c({label:e.options.label,grid:{...e.options.grid,intersectionEffectivity:e.options.grid.intersectionEffectivity.join(","),isANValid:e.options.grid.isANValid?y.label_valid:y.label_invalid}});u.treeDocument.addChild(i)}))})),u.treeDocument.expandAll(),u.treeDocument.pushUpdate();var p=u.getAsCSV(),g=o.refWithConfig.options.label+"_"+e.title+"_"+(t?y.title_export_an_unicity_variant:y.title_export_an_unicity_evolution)+".csv",f=new Date,m=r.getUser("isFullName"),h=y.label_none;widget.getValue("ngFilter")?h=JSON.parse(widget.getValue("ngFilter")).filterTitle:widget.getValue("currentConfig")&&(h=widget.getValue("currentConfig").modelVersion.name+" "+widget.getValue("currentConfig").modelVersion.revision+" "+widget.getValue("currentConfig").pc.label);var v="";t&&i.forEach(((e,t)=>{v=v+e.modelversion.displayValue+"-"+e.modelversion.revision+"-"+e.productConfiguration.marketingName+"; "})),p=(t?y.action_architecture_number_unicity_product_congiguration:y.action_architecture_number_unicity_evolution)+"\n"+y.label_filename+","+g+"\n"+y.label_export_datetime_utcformat+","+f+"\n"+y.label_exported_by+","+m+"\n"+y.label_applied_product_configuration+","+h+"\n"+(t?y.label_PC_selected+","+v:"")+"\n\n\n"+p,n.downloadFile(g,p,!0),n.alertMessage("success",null,y.msg_an_unicity_on_effectivity_export_success)},_.prototype.displayProductConfigChoices=function(t,i,n){var o=[{text:y.label_title,dataIndex:"tree",editableFlag:!1,sortableFlag:!0,alwaysVisibleFlag:!0,pinned:"left"},{text:y.label_name,dataIndex:"name",typeRepresentation:"string",alwaysVisibleFlag:!0},{text:y.label_owner,dataIndex:"owner",typeRepresentation:"string",alwaysVisibleFlag:!0},{text:y.label_maturity,dataIndex:"maturity",typeRepresentation:"string",alwaysVisibleFlag:!0},{text:y.label_description,dataIndex:"description",typeRepresentation:"string"}],r=new d({identifier:"grid-view-pc-choices",height:"inherit",treeDocument:new l({useAsyncPreExpand:!0,shouldBeSelected:function(e){return!!e.options.pcInfo}}),columns:o,rowSelection:"multiple",defaultColumnDef:{width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!1,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t}});r.treeDocument.setFilterModel({label:{filterId:"stringRegexp"},name:{filterId:"stringRegexp"},description:{filterId:"stringRegexp"},owner:{filterId:"stringRegexp"},maturity:{filterId:"set"}}),r.treeDocument.empty();var s=e.createElement("div",{class:"container-checkAN-gridView"});return i.appendChild(s),s.appendChild(r.getContent()),r.treeDocument.prepareUpdate(),t.modelversions.forEach((function(e,t){var i=new c({label:e.modelversion.displayValue+"-"+e.modelversion.revision}),n=!1;e.productConfigurations.forEach((function(t,o){if(t.attributes.FilterCompiledForm){n=!0;var r=t.basics?t.basics.owner:"",a=new c({label:t.marketingName,pcInfo:t,mvInfo:e.modelversion,grid:{name:t.name,owner:r,maturity:t.basics?t.basics.current:"",description:t.basics?t.basics.description:""}});i.addChild(a)}})),n&&r.treeDocument.addRoot(i)})),r.treeDocument.expandAll(),r.treeDocument.pushUpdate(),r.treeDocument.withTransactionUpdate((function(){r.treeDocument.getAllDescendants().forEach(((e,t)=>{var i=e.options.grid.owner;i&&a.getFullName(i).then((function(t){t&&e.setAttribute("owner",t)})),n&&e.options.pcInfo&&-1!==n.indexOf(e.options.pcInfo.id)&&e.select()}))})),r},_.prototype.manageDisplayCheckANResults=function(t,i,o,r){var a=this;a._displayModalArchitectureNumberUnicity();var s=o?y.action_architecture_number_unicity_product_congiguration:y.action_architecture_number_unicity_evolution;if(a.dialog.title=s+" - "+a.refWithConfig.options.label+" - "+i.title,0!==Object.keys(t).length){a.dialog.buttons={SaveAll:new g({label:y.action_export,emphasize:"primary",onClick:function(){a.exportCSV(i,o,r)}}),Close:new g({emphasize:"secondary",onClick:function(){a.dialog.close()}})},a.dialog._applyButtons();var l=a.dialog.elements._contentDiv.getElementsByClassName("container-unicity-AN")[0];if(l.empty(),o){var c=e.createElement("div",{class:"container-checkAN-selection-PC"});l.appendChild(c),a.filterListPC=[];var d=new e.Element("div");r.forEach(((e,t)=>{let i=new m({value:e.modelversion.displayValue+"-"+e.modelversion.revision+"-"+e.productConfiguration.marketingName,emphasize:"secondary"});i.inject(d),i.addEventListener("click",(function(e){"secondary"===i.emphasize?(i.emphasize="primary",a.filterListPC.push(i.value)):(i.emphasize="secondary",a.filterListPC=a.filterListPC.filter((e=>e!==i.value))),a.manageFilterSelectionPC(a.filterListPC)}))})),new f({items:[{header:y.label_PC_selected,content:d}],style:"filled-group"}).inject(c)}return a.displayDuplicatedArchitectureNumbers(t,l,o).then((function(e){a.gridView=e})).catch((function(e){n.alertMessage("error",null,y.msg_error_an_unicity_update_evolution),a.multiModels||o||a.dialog.close()}))}return a._createMessageContentInDialog(y.msg_no_an_duplication),a.dialog.buttons={Close:new g({emphasize:"secondary",onClick:function(){a.dialog.close()}})},Promise.resolve()},_.prototype.manageFilterSelectionPC=function(e){if(this.gridView){let t=this.gridView.getTreeDocument().getFilterManager(),i={};e.length>0&&(i={selectedValues:e}),t.setPropertyFilterModel("intersectionEffectivity",{filterId:"stringArray",filterModel:i})}},_.prototype.manageCheckANForProductConfig=function(t,o){var r=this;r._displayModalArchitectureNumberUnicity(),r.dialog.title=y.action_architecture_number_unicity_effectivity+" - "+r.refWithConfig.options.label;var a=r.dialog.elements._contentDiv.getElementsByClassName("container-unicity-AN")[0];a.empty();var s=e.createElement("div",{class:"container-checkAN-info-selectPC",html:y.label_info_select_PC});a.appendChild(s),r.gridView=r.displayProductConfigChoices(t,a,o),r.dialog.buttons={SaveAll:new g({label:y.label_next,emphasize:"primary",onClick:function(){var e=r.gridView.treeDocument.getSelectedNodes();if(e.length>0){var o=e.map((function(e){return{productConfiguration:e.options.pcInfo,modelversion:e.options.mvInfo}})),a=e.map((function(e){return e.options.pcInfo.id}));localStorage.setItem(b.localStorageKeys.selectedPCcheckAN,JSON.stringify(a)),r.loader.visibleFlag||(i.createModal(r.dialog.elements.container,r.loader.elements.container),r.loader.on()),C.checkANOnVariant(r.nodesToCheck,o).then((function(e){r.manageDisplayCheckANResults(e,t.model,!0,o).then((function(){r.loader.visibleFlag&&(r.loader.off(),i.removeModal(r.dialog.elements.container))})),r.dialog.buttons.Reset=new g({label:y.action_previous,emphasize:"secondary",onClick:function(){r.manageCheckANForProductConfig(t,a)}}),r.dialog._applyButtons()})).catch((function(e){r.loader.visibleFlag&&(r.loader.off(),i.removeModal(r.dialog.elements.container)),n.alertMessage("error",null,y.msg_error_an_unicity_variant)}))}else localStorage.setItem(b.localStorageKeys.selectedPCcheckAN,null),r.manageCheckANForEvolution(t,!0)}}),Cancel:new g({emphasize:"secondary",onClick:function(){r.dialog.close()}})},r.multiModels&&(r.dialog.buttons.Reset=new g({label:y.action_previous,emphasize:"secondary",onClick:function(){r._manageComponentForMoreThanOneModel(r.configCtxResp)}})),r.dialog._applyButtons()},_.prototype.manageCheckANForEvolution=function(e,t){var o=this,r=e.modelversions.map((e=>e.modelversion));C.checkANOnEvolution(o.nodesToCheck,r,e.model).then((function(n){o.manageDisplayCheckANResults(n,e.model,!1).then((function(){o.loader.visibleFlag&&(o.loader.off(),i.removeModal(o.dialog.elements.container))})),t?(o.dialog.buttons.Reset=new g({label:y.action_previous,emphasize:"secondary",onClick:function(){o.manageCheckANForProductConfig(e)}}),o.dialog._applyButtons()):o.multiModels&&(o.dialog.buttons.Reset=new g({label:y.action_previous,emphasize:"secondary",onClick:function(){o._manageComponentForMoreThanOneModel(o.configCtxResp)}}),o.dialog._applyButtons())})).catch((function(e){n.alertMessage("error",null,y.msg_error_an_unicity_evolution),o.loader.visibleFlag&&(o.loader.off(),i.removeModal(o.dialog.elements.container)),o.multiModels||o.dialog.close()}))},_})),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.deletion",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/document.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/utils/config.util","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c){"use strict";var d=JSON.parse(l);return{deleteLogItemInstance:function(t){var n=this,r={success:[],failure:[],errorMessages:[]};n.promises=[],n.params=t,n.contentViewContainer=t.collectionView.getContent();var a=t.collectionView.treeDocument.getSelectedNodes();e.mask(n.contentViewContainer,c.msg_processing);let l=widget.getValue("groupingEnabled");var u={},p={};for(var g in a.forEach((function(e){var t=e.options.instance.physicalid,n=e.getParent();l&&!n.getID&&(n=i.getGroupNodeParent(n));let o=n.options.physicalid;void 0===u[o]&&(u[o]=[],p[o]=[]),u[o].push(t),p[o].push(e)})),u)Object.hasOwnProperty.call(u,g)&&n.promises.push(o.deleteLogItemInstance(g,u[g]).then(n.updateViewOnDelete.bind(n,t.collectionView.treeDocument,p[g],"success",r,u[g])).then((function(){s.SAXStorage().setItem(d.recentlyAuthoredStructure+g,Date.now())})).catch(n.updateViewOnDelete.bind(n,t.collectionView.treeDocument,p[g],"failure",r,u[g])))},updateViewOnDelete:function(o,r,l,u,p,g){var f=this;f.promises.push(a.getObjectAttributes(p).then((function(e){let t=widget.getValue("groupingEnabled"),a=!1,c=[],p={},f=r[0].getParent();t&&!f.getID&&(f=i.getGroupNodeParent(f));let m=f.options.physicalid;if("success"===l){u.success.push(f.options.label);let l=r.map((e=>e.options.instance.physicalid));if(t&&f.isRoot())r.forEach((function(t){let n=t.getParent();n.getChildren().forEach((function(i){i.options.instance&&i.options.instance.physicalid===t.options.instance.physicalid&&(e[i.options.instance.physicalid].isProxy?i.remove():(a=!0,c.push(i.getID()),p[i.getRelationID()]=i))})),i.removeGroupNodesOnEmpty(n)}));else{let t=o.getMappedNodesFromId(m),i=[];t.forEach((function(t){t.getChildren().forEach((function(t){t.options.instance&&l.includes(t.options.instance.physicalid)&&(e[t.options.instance.physicalid].isProxy?i.push(t):(a=!0,c.push(t.getID()),p[t.getRelationID()]=t))}));for(let e=0;e<i.length;e++)i[e].remove();t.expand()}))}a&&(n.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:c,tagAsRecentlyAuthored:!0}}),n.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-inst-by-id",data:{instIdMap:p,bInstance:!0,bEffectivity:!0}})),s.SAXStorage().setItem(d.recentlyAuthoredStructure+m,Date.now())}else g.errorResp&&g.errorResp.message&&(Object.keys(u.errorMessages).indexOf(g.errorResp.message)<0?u.errorMessages[g.errorResp.message]=[f.options.label]:u.errorMessages[g.errorResp.message].push(f.options.label)),u.failure.push(f.options.label)}))),Promise.all(f.promises).finally((function(){if(u&&u.success.length>0){let e=f.params.collectionView.getGroupingOptions();e&&f.params.collectionView.groupRows(e),t.alertMessage("success",null,c.msg_inst_detach_success+u.success.toString())}if(u&&u.failure.length>0){let e=u.failure.toString();if(u.errorMessages&&Object.keys(u.errorMessages).length>0){e+="<br><br>"+c.error_details;for(let t in u.errorMessages)e+="<br><b>"+u.errorMessages[t].toString()+"</b><br>",t.indexOf("\n\n")>=0&&(t=t.split("\n\n")[1]),e+=t}t.alertMessage("error",null,null,c.msg_inst_detach_failure+e)}e.unmask(f.contentViewContainer)}))}}})),define("DS/CATFLCockpitWidget/components/RefineSelection/RefineSelection",["DS/Windows/Dialog","DS/Controls/Button","DS/Handlebars/Handlebars","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","text!DS/CATFLCockpitWidget/components/RefineSelection/RefineSelection.html","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util"],(function(e,t,i,n,o,r,a){"use strict";var s=r.getFullConfig(),l=s.identifiers,c=[{id:"structureInstances",nlsName:n.label_structure_instances,checkedByDefault:!0,subcategory:[{id:"onlystructureleaves",nlsName:n.label_only_structure_leaves,checkedByDefault:!1},{id:"onlykeyarchcomp",nlsName:n.label_only_key_arch_comp,checkedByDefault:!1}]},{id:"implementing",nlsName:n.label_implementing,checkedByDefault:!1,subcategory:[{id:"implementingReq",nlsName:n.label_requirement,checkedByDefault:!1},{id:"implementingFunc",nlsName:n.label_functional,checkedByDefault:!1},{id:"implementingLog",nlsName:n.label_logical,checkedByDefault:!1}]},{id:"isimplementing",nlsName:n.label_is_implementing,checkedByDefault:!1,subcategory:[{id:"isimplementingReq",nlsName:n.label_requirement,checkedByDefault:!1},{id:"isimplementingFunc",nlsName:n.label_functional,checkedByDefault:!1},{id:"isimplementingLog",nlsName:n.label_logical,checkedByDefault:!1}]},{id:"implmentedBy",nlsName:n.label_implemented_by,checkedByDefault:!1,subcategory:[{id:"implmentedByLog",nlsName:n.label_logical,checkedByDefault:!1},{id:"implmentedByPrd",nlsName:n.label_product,checkedByDefault:!1}]},{id:"isImplmentedBy",nlsName:n.label_is_implemented_by,checkedByDefault:!1,subcategory:[{id:"isImplmentedByLog",nlsName:n.label_logical,checkedByDefault:!1},{id:"isImplmentedByPrd",nlsName:n.label_product,checkedByDefault:!1}]},{id:"proposedsolution",nlsName:n.label_proposed_solution,checkedByDefault:!1},{id:"specDocs",nlsName:n.label_spec_documents,checkedByDefault:!1}],d={main:i.compile(o)},u=function(e,t){this.selectedNodes=e,this.treeDocument=t,this.render()};return u.prototype.render=function(){var i=this;i.dialog=new e({title:n.label_refine_selection,content:d.main({Header:i.selectedNodes.length+" "+n.label_data_grid,CategoryObject:c,CombCuesid:"combcues",CombCuesName:n.label_only_comb_cues}),height:630,width:340,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new t({label:n.label_refine,emphasize:"primary",onClick:function(){var e,t=[];if(i.contentDiv.querySelector(".checkbox-refine-by-cues").checked)for(e=0;e<i.selectedNodes.length;e++)(void 0===i.selectedNodes[e].options.cueDetails||"group"!==i.selectedNodes[e].options.cueDetails.cue)&&t.push(i.selectedNodes[e]);else for(e=0;e<i.selectedNodes.length;e++){var o=i.dialog.elements.container;if(o.querySelector("#structureInstances").checked||i.selectedNodes[e].options.virtual)if(!o.querySelector("#onlystructureleaves").checked||i.selectedNodes[e].options.virtual||i._isNodeLeaf(i.selectedNodes[e]))if(!o.querySelector("#onlykeyarchcomp").checked||i.selectedNodes[e].options.virtual||i.selectedNodes[e].options.grid.architectureNumber){if(i.selectedNodes[e].options.virtual){if(!o.querySelector("#implementingReq").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementingref")&&"R"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#implementingFunc").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementingref")&&"F"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#implementingLog").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementingref")&&"L"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#isimplementingReq").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementinginst")&&"R"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#isimplementingFunc").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementinginst")&&"F"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#isimplementingLog").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementinginst")&&"L"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#implmentedByLog").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementedref")&&"L"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#implmentedByPrd").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementedref")&&"P"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#isImplmentedByLog").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementedinst")&&"L"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#isImplmentedByPrd").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementedinst")&&"P"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#proposedsolution").checked&&i.selectedNodes[e].getParent().getType()===l.type_proposed_solution){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#specDocs").checked&&i.selectedNodes[e].getParent().getType()===l.type_spec_document){t.push(i.selectedNodes[e]);continue}if("DIF"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}}}else t.push(i.selectedNodes[e]);else t.push(i.selectedNodes[e]);else t.push(i.selectedNodes[e])}t.length===i.selectedNodes.length?a.alertMessage("warning",null,n.warn_refine_selection_empty_result):i.treeDocument.getXSO().remove(t),i._saveUserSelection(),i.dialog.close()}}),Close:new t({emphasize:"secondary",onClick:function(){i.dialog.close()}})}}),i.dialog.elements.container.classList.add("flweb-refine-selection-panel"),i.contentDiv=i.dialog.elements._contentDiv;var o=JSON.parse(localStorage.getItem(s.localStorageKeys.refineSelectionOptions));null!==o&&i.contentDiv.querySelectorAll("[type=checkbox]").forEach((function(e){e.checked=o[e.id].checked,e.indeterminate=o[e.id].indeterminate,e.disabled=o[e.id].disabled})),i._disableRefineByCategoryCheckboxes(i.contentDiv.querySelector("#combcues").checked),i._checkifOkButtonIsEnabled(),c.forEach((function(e){if(i.contentDiv.querySelector("#"+e.id).addEventListener("click",(function(){"structureInstances"===e.id?i._disableStructureSubCategoriesCheckboxes():i._updateSubcategorySelection(e),i._checkifOkButtonIsEnabled()})),void 0!==e.subcategory)for(var t=0;t<e.subcategory.length;t++){var n=e.subcategory[t];i.contentDiv.querySelector("#"+n.id).addEventListener("click",(function(){"onlystructureleaves"===n.id||"onlykeyarchcomp"===n.id?i._updateStructureRootCategory():i._updateRootCategorySelection(e),i._checkifOkButtonIsEnabled()}))}})),i.contentDiv.querySelector("#combcues").addEventListener("click",(function(e){i._disableRefineByCategoryCheckboxes(e.currentTarget.checked),i._checkifOkButtonIsEnabled()}))},u.prototype._saveUserSelection=function(){var e={};this.contentDiv.querySelectorAll("[type=checkbox]").forEach((function(t){e[t.id]={checked:t.checked,indeterminate:t.indeterminate,disabled:t.disabled}})),localStorage.setItem(s.localStorageKeys.refineSelectionOptions,JSON.stringify(e))},u.prototype._updateSubcategorySelection=function(e){var t=this;void 0!==e.subcategory&&e.subcategory.forEach((function(i){t.contentDiv.querySelector("#"+i.id).checked=t.contentDiv.querySelector("#"+e.id).checked}))},u.prototype._updateRootCategorySelection=function(e){var t=this,i=t.contentDiv.querySelectorAll("[parentid="+e.id+"]:checked").length;i===e.subcategory.length?(t.contentDiv.querySelector("#"+e.id).checked=!0,t.contentDiv.querySelector("#"+e.id).indeterminate=!1):i>0?(t.contentDiv.querySelector("#"+e.id).indeterminate=!0,t.contentDiv.querySelector("#"+e.id).checked=!0):0===i&&(t.contentDiv.querySelector("#"+e.id).checked=!1,t.contentDiv.querySelector("#"+e.id).indeterminate=!1)},u.prototype._isNodeLeaf=function(e){if(!e.isVisible())return!1;if(e.isExpanded()&&e.options.children.length>0)for(var t=0;t<e.options.children.length;t++)if(e.options.children[t].options.physicalid&&e.options.children[t].isVisible())return!1;return!0},u.prototype._updateStructureRootCategory=function(){var e=this;0===e.contentDiv.querySelectorAll("[parentid=structureInstances]:checked").length?(e.contentDiv.querySelector("#structureInstances").checked=!0,e.contentDiv.querySelector("#structureInstances").indeterminate=!1):(e.contentDiv.querySelector("#structureInstances").checked=!0,e.contentDiv.querySelector("#structureInstances").indeterminate=!0)},u.prototype._disableStructureSubCategoriesCheckboxes=function(){var e=this,t=e.contentDiv.querySelector("#structureInstances").checked||e.contentDiv.querySelector("#structureInstances").indeterminate||!1;e.contentDiv.querySelectorAll("[parentid=structureInstances]").forEach((function(e){e.disabled=!t})),e.contentDiv.querySelectorAll("[parentid=structureInstances]:not([disabled]):checked").length>0&&(e.contentDiv.querySelector("#structureInstances").indeterminate=!0)},u.prototype._disableRefineByCategoryCheckboxes=function(e){this.contentDiv.querySelectorAll(".checkbox-refine-by-category, .checkbox-refine-by-subcategory").forEach((function(t){t.disabled=e})),e||this._disableStructureSubCategoriesCheckboxes()},u.prototype._checkifOkButtonIsEnabled=function(){var e=this;0===e.contentDiv.querySelectorAll("[type=checkbox]:not([disabled]):checked").length?e.dialog.buttons.Ok.disabled=!0:e.dialog.buttons.Ok.disabled=!1},u})),define("DS/CATFLCockpitWidget/components/ExportCSV/ExportCSV",["DS/DataGridView/DataGridView","DS/Windows/Dialog","DS/Controls/Button","DS/Windows/Panel","DS/Controls/ProgressBar","DS/Controls/ModalContainer","DS/Controls/Expander","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Handlebars/Handlebars","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/services/predicate.service","DS/CATFLCockpitWidget/utils/model.events.util","text!DS/CATFLCockpitWidget/components/ExportCSV/ExportCSV.html","text!DS/CATFLCockpitWidget/components/ExportCSV/PreviewFormat.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f,m,h,v){"use strict";var C=d.getFullConfig(),y={bodyModal:c.compile(m),bodyPreviewFormat:c.compile(h)},b=function(e,t,i){var n=this;n.root={id:e,name:t},n.modelInfo=i,n.container=widget.body,n.render(),n.availableAttributes=new s({useAsyncPreExpand:!0}),n.availableAttributes.addChild([new l({key:"Col0",ds6w:"ds6w:label",bo:!0,grid:{iconType:"object-reference",name:d.getNlsBasicAttributesBO("ds6w:label"),declaredIn:v.label_all_levels}}),new l({key:"Col1",ds6w:"ds6wg:revision",bo:!0,grid:{iconType:"object-reference",name:d.getNlsBasicAttributesBO("ds6wg:revision"),declaredIn:v.label_all_levels}}),new l({key:"Col2",ds6w:"ds6w:isLastRevision",bo:!0,grid:{iconType:"object-reference",name:d.getNlsBasicAttributesBO("ds6w:isLastRevision"),declaredIn:v.label_all_levels}}),new l({key:"Col3",ds6w:"ds6w:label",bo:!1,grid:{iconType:"object-instance",name:d.getNlsBasicAttributesBO("ds6w:label"),declaredIn:v.label_all_levels}}),new l({key:"Col4",ds6w:"ds6w:status",bo:!0,grid:{iconType:"object-reference",name:d.getNlsBasicAttributesBO("ds6w:status"),declaredIn:v.label_all_levels}}),new l({key:"Col5",ds6w:"ds6w:responsible",bo:!0,grid:{iconType:"object-reference",name:d.getNlsBasicAttributesBO("ds6w:responsible"),declaredIn:v.label_all_levels}}),new l({key:"Col6",ds6w:"ds6w:reserved",bo:!0,grid:{iconType:"object-reference",name:d.getNlsBasicAttributesBO("ds6w:reserved"),declaredIn:v.label_all_levels}}),new l({key:"Col7",ds6w:"ds6w:created",bo:!0,grid:{iconType:"object-reference",name:d.getNlsBasicAttributesBO("ds6w:created"),declaredIn:v.label_all_levels}}),new l({key:"Col8",ds6w:"ds6w:modified",bo:!0,grid:{iconType:"object-reference",name:d.getNlsBasicAttributesBO("ds6w:modified"),declaredIn:v.label_all_levels}}),new l({key:"Col9",ds6w:"ds6w:description",bo:!0,grid:{iconType:"object-reference",name:d.getNlsBasicAttributesBO("ds6w:description"),declaredIn:v.label_all_levels}}),new l({key:"Col10",ds6w:"ds6w:type",bo:!0,grid:{iconType:"object-reference",name:d.getNlsBasicAttributesBO("ds6w:type"),declaredIn:v.label_all_levels}}),new l({key:"Col11",ds6w:"ds6w:identifier",bo:!0,grid:{iconType:"object-reference",name:d.getNlsBasicAttributesBO("ds6w:identifier"),declaredIn:v.label_all_levels}}),new l({key:"Col12",ds6w:"ds6wg:architectureextension.v_architecturenumber",bo:!0,grid:{iconType:"object-reference",name:v.label_arch_no,declaredIn:v.label_all_levels}}),new l({key:"Col13",ds6w:"ds6w:reservedBy",bo:!0,grid:{iconType:"object-reference",name:d.getNlsBasicAttributesBO("ds6w:reservedBy"),declaredIn:v.label_all_levels}}),new l({key:"Col14",ds6w:"ds6w:reserved",bo:!1,grid:{iconType:"object-instance",name:d.getNlsBasicAttributesRel("ds6w:reserved"),declaredIn:v.label_all_levels}}),new l({key:"Col15",ds6w:"ds6w:reservedBy",bo:!1,grid:{iconType:"object-instance",name:d.getNlsBasicAttributesRel("ds6w:reservedBy"),declaredIn:v.label_all_levels}})]);var o=[],r=u.getUserCustomAttributes(),a=u.getUserCustomAttributes(!0);if(r&&o.push(...r),a&&o.push(...a),o&&o.length>0){var c={};g.getNLSPredicates(o).then((function(e){c=e||{}})).finally((function(){o.forEach((function(e,t){let i,o=c[e.curi]||e.nls||e.curi;if(e.dimension){var r=C.dimensions[e.dimension];e.manipulationUnit?(o=o+" ("+r.Units[e.manipulationUnit].NLSName+")",i={dimension:e.dimension,manipulationUnit:e.manipulationUnit,MKSUnit:r.MKSUnit}):o=o+" ("+r.Units[r.MKSUnit].NLSName+")"}n.availableAttributes.addChild(new l({key:"UsrCol"+t,ds6w:e.curi,bo:e.bo,UoM:i,grid:{iconType:e.bo?"object-reference":"object-instance",name:o,declaredIn:e.declaredIn}}))})),n.restorePreviousAttributesSelection()}))}else n.restorePreviousAttributesSelection()};return b.prototype.render=function(){var e=this,n=f.getFLWebModelEventsObj("flweb-model-events");e.modal=new t({title:v.action_export,content:y.bodyModal({NLS:v,defaultFileName:e.root.name}),width:580,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new i({label:v.action_export,emphasize:"primary",onClick:function(){e.launchExport(),e.modal.close()}}),Apply:new i({label:v.label_preview_format,emphasize:"secondary",onClick:function(){e.renderPreviewFormat()}}),Close:new i({label:v.cancel_button,emphasize:"secondary",onClick:function(){e.modal.close()}})}}),e.modal.addEventListener("close",(function(){u&&n.unsubscribe(u),p&&n.unsubscribe(p),e.modal.destroy()}));var o=e.modal.elements._contentDiv.querySelector("#export-all-levels"),r=e.modal.elements._contentDiv.querySelector("#input-nb-level-exported"),a=e.modal.elements._contentDiv.querySelector(".file-name-user-input"),s=e.modal.elements._contentDiv.querySelector(".info-exported-level"),l=e.modal.elements._contentDiv.querySelector(".checkbox-export-all-levels");o.addEventListener("click",(function(){o.checked?r.disabled=!0:r.disabled=!1}));var c=JSON.parse(localStorage.getItem(C.localStorageKeys.exportCSVOptions));null!==c&&(-1!==c.expandLevels&&(o.checked=!1,r.disabled=!1,r.value=c.expandLevels),c.addProposedSolutions||(e.modal.elements._contentDiv.querySelector("#export-proposed-solution").checked=!1),c.addSpecDocs||(e.modal.elements._contentDiv.querySelector("#export-specification-documents").checked=!1),c.addDiscRef||(e.modal.elements._contentDiv.querySelector("#export-discipline-references").checked=!1),c.addConfigData||(e.modal.elements._contentDiv.querySelector("#export-configuration-data").checked=!1)),e.modal.elements._contentDiv.querySelector(".fonticon-cog").addEventListener("click",(function(){e.renderAttributesSelector()})),a.addEventListener("input",(function(){0===a.value.length?(e.modal.buttons.Ok.disabled=!0,e.modal.buttons.Apply.disabled=!0):(e.modal.buttons.Ok.disabled=!1,e.modal.buttons.Apply.disabled=!1)})),r.addEventListener("change",(function(){var e=parseInt(r.value,10);isNaN(e)||e<0?r.value=0:r.value=e}));let d=function(){var e=widget.getValue("ngFilter");e&&e.length>0?(l.hidden=!0,s.hidden=!1):(l.hidden=!1,s.hidden=!0)},u=n.subscribe({event:"flweb-ngfilter-added"},d),p=n.subscribe({event:"flweb-ngfilter-removed"},d);d(),e.modal.show()},b.prototype.launchExport=function(){var e=this,t=e.modal.elements._contentDiv,i=t.querySelector("#export-all-levels"),s=t.querySelector("#input-nb-level-exported"),l=t.querySelector(".file-name-user-input").value+".csv",c={root_physicalid:e.root.id,exportSpecDoc:t.querySelector("#export-specification-documents").checked,exportProposedSolution:t.querySelector("#export-proposed-solution").checked,exportDisciplineReferences:t.querySelector("#export-discipline-references").checked,exportConfigurationData:t.querySelector("#export-configuration-data").checked,exportFileName:l};if(i.checked?c.expand_iter=-1:c.expand_iter=parseInt(s.value,10),widget.getValue("ngFilter")&&widget.getValue("ngFilter").length>0){var d=JSON.parse(widget.getValue("ngFilter"));c.ngFilterV2={filterTitle:d.filterTitle},d.CVQueryV2.filter?c.ngFilterV2.CVQueryV2=d.CVQueryV2:d.CVQueryV2.batch&&d.CVQueryV2.batch.expands&&1===d.CVQueryV2.batch.expands.length&&(c.ngFilterV2.CVQueryV2=d.CVQueryV2.batch.expands[0])}else if(e.modelInfo&&e.modelInfo.modelVersion&&e.modelInfo.modelVersion.physicalid){var g=widget.getValue("currentConfig").filterCompiledForm,f=e.modelInfo.modelVersion.name+" "+e.modelInfo.modelVersion.revision;if(e.modelInfo.pc&&e.modelInfo.pc.physicalid){var m=e.modelInfo.pc.label?e.modelInfo.pc.label:e.modelInfo.pc.name;m.startsWith("[")&&m.endsWith("]")&&(m=m.slice(1,m.length-1)),f=f+" "+m}c.configFilteringContext={filter_compiledform:g,filter_info:f}}var h=[];if(e.availableAttributes.getSelectedNodes().forEach((function(e){var t={key:e.options.key,bo:e.options.bo,ds6w:e.options.ds6w,display:e.options.grid.name};e.options.UoM&&(t.UoM=e.options.UoM),h.push(t)})),c.selectedColumns=h,localStorage.setItem(C.localStorageKeys.exportCSVOptions,JSON.stringify({expandLevels:c.expand_iter,addProposedSolutions:c.exportProposedSolution,addSpecDocs:c.exportSpecDoc,addDiscRef:c.exportDisciplineReferences,addConfigData:c.exportConfigurationData})),document.getElementById("progress-bar"))u.alertMessage("info",null,v.exportStructureProgress);else{e.progressBarContainer=UWA.createElement("div",{id:"progress-bar",class:"linear-container"});let t=new o({displayStyle:"lite",infiniteFlag:!0});r.createModal(e.progressBarContainer,t.elements.container);var y=new a({header:v.expanderProgressHeader,body:e.progressBarContainer,expandedFlag:!0});e.panel=new n({title:e.root.name,content:y.elements.container,modalFlag:!1,immersiveFrame:widget.immersiveFrame,width:100,closeButtonFlag:!1,position:{my:"bottom right",at:"bottom right",of:widget.immersiveFrame}}),p.post(C.webservices.exportCSV,JSON.stringify(c),0).then((function(t){e.panel.close(),r.removeModal(e.progressBarContainer),u.downloadFile(l,t,!0)})).catch((function(t){t&&t.errorResp&&(e.panel.close(),r.removeModal(e.progressBarContainer),u.alertMessage("error",null,t.errorResp.message))}))}},b.prototype.renderAttributesSelector=function(){var n=this;n.restorePreviousAttributesSelection(),n.dialog=new t({title:v.attributes_browser+" - "+v.label_select_attributes,height:500,width:700,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new i({label:v.save_button,emphasize:"primary",onClick:function(){var e=[];n.dgv.treeDocument.getSelectedNodes().forEach((function(t){e.push({ds6w:t.options.ds6w,bo:t.options.bo})})),localStorage.setItem(C.localStorageKeys.exportCSVSelectedColumns,JSON.stringify(e)),n.dialog.close()}}),Close:new i({label:v.cancel_button,emphasize:"secondary",onClick:function(){n.dialog.close()}})}}),n.dialog.addEventListener("close",(function(){n.dgv.getNodesXSO().unsubscribe(o),n.dgv.getNodesXSO().unsubscribe(r),n.dialog.destroy()})),n.dgv=new e({identifier:"LogicalProductDefinition_ExportCSV",height:"inherit",treeDocument:n.availableAttributes,selectionBehavior:{unselectAllOnEmptyArea:!1},columns:[{typeRepresentation:"icon",dataIndex:"iconType",width:40},{text:v.label_name,dataIndex:"name"},{text:v.label_declared_in,dataIndex:"declaredIn"}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!1,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t},getCellTooltip:function(e){return e.nodeModel&&0===e.columnID?{shortHelp:e.nodeModel.options.bo?v.label_declared_in_reference:v.label_declared_in_instance,updateModel:!1}:n.dgv.getCellDefaultTooltip(e)}}),n.dialog.elements._contentDiv.appendChild(n.dgv.getContent()),n.dgv.treeDocument.setFilterModel({name:{filterId:"stringRegexp"},declaredIn:{filterId:"stringRegexp"}});var o=n.dgv.getNodesXSO().onPostAdd(n.updateAttributesSelectorSaveButtonDisabledState.bind(n)),r=n.dgv.getNodesXSO().onPostRemove(n.updateAttributesSelectorSaveButtonDisabledState.bind(n))},b.prototype.restorePreviousAttributesSelection=function(){this.availableAttributes.unselectAll();var e=JSON.parse(localStorage.getItem(C.localStorageKeys.exportCSVSelectedColumns));null===e?this.availableAttributes.selectAll():this.availableAttributes.getAllDescendants().forEach((function(t){for(var i=0;i<e.length;i++)e[i].ds6w===t.options.ds6w&&e[i].bo===t.options.bo&&t.select()}))},b.prototype.updateAttributesSelectorSaveButtonDisabledState=function(){0===this.availableAttributes.getSelectedNodes().length?this.dialog.buttons.Ok.disabled=!0:this.dialog.buttons.Ok.disabled=!1},b.prototype.renderPreviewFormat=function(){var n=this,o=n.modal.elements._contentDiv,r=o.querySelector(".file-name-user-input").value,a={fileName:0===r.length?"":r+".csv",exportedBy:d.getUser("isFullName"),exportedOn:(new Date).toLocaleString("fr-FR",{timeZone:"UTC"}),exportSpecDocs:o.querySelector("#export-specification-documents").checked?v.label_yes:v.label_no,exportProposedSolutions:o.querySelector("#export-proposed-solution").checked?v.label_yes:v.label_no,exportDiscRef:o.querySelector("#export-discipline-references").checked?v.label_yes:v.label_no,exportConfigData:o.querySelector("#export-configuration-data").checked?v.label_yes:v.label_no},l=o.querySelector("#export-all-levels"),c=o.querySelector("#input-nb-level-exported");l.checked?a.expandLevels=v.label_all_levels:a.expandLevels=parseInt(c.value,10),widget.getValue("ngFilter")&&widget.getValue("ngFilter").length>0?(a.appliedConfiguration=JSON.parse(widget.getValue("ngFilter")).filterTitle,a.expandLevels=v.info_level_based_on_filter):n.modelInfo&&n.modelInfo.model&&n.modelInfo.model.physicalid?n.modelInfo.modelVersion&&n.modelInfo.modelVersion.physicalid?(a.appliedConfiguration=n.modelInfo.modelVersion.name+" "+n.modelInfo.modelVersion.revision+" ",n.modelInfo.pc&&n.modelInfo.pc.physicalid?a.appliedConfiguration+=n.modelInfo.pc.name:a.appliedConfiguration+=v.label_all):a.appliedConfiguration=v.label_all_models:a.appliedConfiguration=v.label_none,n.dialog=new t({title:v.label_preview,height:460,width:700,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,content:y.bodyPreviewFormat({NLS:v,infos:a}),buttons:{Ok:new i({label:v.action_export,emphasize:"primary",onClick:function(){n.launchExport(),n.dialog.close(),n.modal.hide()}}),Close:new i({label:v.cancel_button,emphasize:"secondary",onClick:function(){n.dialog.close()}})}}),n.dialog.addEventListener("close",(function(){n.dialog.destroy()})),n.dialog.elements.container.classList.add("flweb-cockpit-export-csv-preview-format");var u=[];if(n.restorePreviousAttributesSelection(),n.availableAttributes.getSelectedNodes().forEach((function(e){var t={text:e.options.grid.name,dataIndex:e.options.key};e.options.bo||(t.icon={iconName:"object-instance"}),u.push(t)})),n.modal.elements._contentDiv.querySelector("#export-configuration-data").checked){let e=[{name:v.label_config_ctx,key:"Col16"},{name:v.label_effectivity,key:"Col17"},{name:v.label_variant_option,key:"Col18"},{name:v.label_current_evolution,key:"Col19"},{name:v.label_projected_evolution,key:"Col20"}],t=[];e.forEach((e=>{t.push({text:e.name,dataIndex:e.key})})),u.push(...t)}n.dgv=new e({identifier:"LogicalProductDefinition_ExportCSV_PreviewFormat",height:"inherit",treeDocument:new s({useAsyncPreExpand:!0}),rowSelection:"none",columns:u,placeholder:v.label_preview_warning_values_filled_at_actual_export,defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(){return!1}}),n.dialog.elements._contentDiv.querySelector(".dgv-container").appendChild(n.dgv.getContent())},b})),define("DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumberView",["UWA/Core","UWA/Class/View","DS/UIKIT/Tooltip","DS/Controls/LineEditor","DS/WUXAutoComplete/AutoComplete","DS/Controls/Toggle","DS/UIKIT/Mask","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/architectureNumber.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d){"use strict";return t.extend({name:"architectureNumberView",tagName:"div",collection:null,toupdate:null,spinner:null,setCollection:function(e){return this.collection=e,this.columnNames=this.collection.columnNames,this.columnDetails=this.collection.columns,this.itemDetails=this.collection.rows,this},init:function(e){this.modelEvents=e.modelEvents,this._parent(e)},createTableComponent:function(t,i,n,o){var r=e.createElement(t,n);return o&&r.appendText(o),r.inject(i),r},createDynamicColHeader:function(e){var t=this,i={};t.columnNames.forEach((function(n){t.columnDetails[n].architectureIdColumn&&(i.class="archidcolumn"),t.createTableComponent("th",e,i,t.columnDetails[n].label)}))},createCheckBox:function(e,t,i){var n=new r({type:"checkbox",value:0,checkFlag:!0});n.addEventListener(t,i),n.inject(e)},createTableHeaderView:function(){var t,i=this,n=e.createElement("tr");return t=i.createTableComponent("th",n,{status:"ok",id:"archNo-th-checkbox"}),i.createCheckBox(t,"change",(function(e){i.toggleAllEvent(e,this,i.container)})),i.createTableComponent("th",n,{},"#"),i.createDynamicColHeader(n),this.collection.showRowLevelRecomputation&&i.createTableComponent("th",n,{},d.label_reEvaluate_ArchNo),i.createTableComponent("th",n,{},d.arch_no_header),i.collection.bEffectivityCol&&i.createTableComponent("th",n,{},d.label_current_evolution),n},createInActiveTableRow:function(t){var n,o,r,a,s=this,l="",c=s.columnNames,d=s.columnDetails;n=s.createTableComponent("tr",t.parent,t.elementProperty),t.fontIcon&&(o=s.createTableComponent("td",n,t.checkBoxCol.elementProperty),e.createElement("span",{class:t.checkBoxCol.fontIconClass}).inject(o),t.itemDetails.forbidSetANErrorMessages.forEach((function(e){l=l+e+"<br><br>"})),new i({target:o,body:l})),s.createTableComponent("td",n,{editable:!1,styles:{"background-color":"#f9f9f9"}},t.itemCount),c.forEach((function(e){r=d[e],a={id:r.key,name:r.label,architectureidcolumn:void 0!==r.architectureIdColumn&&r.architectureIdColumn,required:r.required,editable:!1,styles:{"background-color":"#f9f9f9"}},s.createTableComponent("td",n,a,t.itemDetails[e])})),s.collection.showRowLevelRecomputation&&(a={id:"ANRecompute",architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":"#f9f9f9"}},s.createTableComponent("td",n,a)),s.createTableComponent("td",n,{styles:{"background-color":"#f9f9f9"}},undefined).addClassName("archidcell"),s.addEffectivityColumnDetails(n,t.itemDetails,!0)},createTableBodyView:function(t){var i,r,a,s,l,u,p,g,f,m,h,v=this;let C=v.columnDetails;for(var y=v.itemDetails,b=t.getElement(".itemDetails"),_=0;_<y.length;_++)y[_].forbidSetAN&&Array.isArray(y[_].forbidSetANReasons)?(f="",m="",h=null,"REPARENT_BLANK_AN"===y[_].forbidSetANReasons[0]?(f="fonticon fonticon-checkbox-on",h={referenceID:y[_].referenceID,instanceIDs:y[_].instanceIDs,instanceID:null},g="onlyReparent"):(f="fonticon fonticon-status-ko",m="iconColor",h={referenceID:y[_].referenceID,instanceID:null,instanceIDs:null},g="ko"),v.createInActiveTableRow({itemDetails:y[_],parent:b,elementProperty:h,checkBox:!1,fontIcon:!0,itemCount:_+1,checkBoxCol:{elementProperty:{class:m,styles:{"background-color":"#f9f9f9"},status:g},fontIconClass:f}})):(i=v.createTableComponent("tr",t.getElement(".itemDetails"),{referenceID:y[_].referenceID,instanceIDs:y[_].instanceIDs,instanceID:y[_].instanceID}),r="",a="",p=v.createTableComponent("td",i,{status:"ok",id:"archNo-td-checkbox",styles:{"background-color":"#D5E8F2"}}),v.createCheckBox(p,"buttonclick",(function(e){v.toggleEvent(e,this,v.container)})),v.createTableComponent("td",i,{html:_+1,editable:!1,styles:{"background-color":"#D5E8F2"}}),v.columnNames.forEach((function(e){var t,p;if(s=C[e],l={id:s.key,name:s.label,architectureidcolumn:s.architectureIdColumn||!1,required:s.required,editable:s.editable,styles:{"background-color":"#D5E8F2"}},u=v.createTableComponent("td",i,l),s.editable)if("enum"===s.format){var g=s.range,f=s.rangeLabel,m=s.rangeTooltip,h="",b=[];h=""!==y[_][e]?y[_][e]:s.defaultValue?s.defaultValue:"";for(var w=0;w<g.length;w++)b.push({label:f?f[w]:g[w],value:g[w],description:m&&m[w]?m[w]:null});(t=new o({elementsTree:b,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1,value:h})).inject(u),p=t.getContent().getElement("input"),t.addEventListener("change",c.updateArchitectureID.bind(v,p,i,!1))}else t=new n({className:"form-control",placeholder:d.ph_enter+C[e].label,attributes:{autocomplete:"off",name:s.label},value:y[_][e],requiredFlag:s.required}),u.classList.add("architecture-number-line-editor"),t.inject(u),(p=t._myInput).addEventListener("keyup",c.updateArchitectureID.bind(v,p,i,!1)),p.addEventListener("keydown",(function(e){v.nextEditableCell(e),13===e.keyCode&&v.modelEvents.publish({event:"enter-key-pressed"})}));else u.setHTML(y[_][e]);C[e].architectureIdColumn&&(a="enum"===s.format?t.value?t.value:"":y[_][e],r+=a)})),v.collection.showRowLevelRecomputation&&(l={id:"ANRecompute",architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":"#D5E8F2",cursor:"pointer"}},u=v.createTableComponent("td",i,l),e.createElement("span",{class:"fonticon fonticon-compute"}).inject(u),u.addEventListener("click",(function(e){"ok"===e.currentTarget.closest("tr").getChildren()[0].getAttribute("status")&&c.executeRecompute({an_action:v.collection.AN_ACTION,rows:[e.currentTarget.closest("tr")],forReparent:v.collection.forReparent})}))),h={class:"archidcell",styles:{"background-color":"#D5E8F2"}},v.createTableComponent("td",i,h).appendText(r),v.addEffectivityColumnDetails(i,y[_],!1))},addEffectivityColumnDetails:function(t,i,n){let o=this,r=n?"#f9f9f9":"#D5E8F2";if(o.collection.bEffectivityCol){let n={},a={architectureIdColumn:!1,editable:!1,format:"string",required:!1,styles:{"background-color":r}};n.currentEvolution=e.extend(a,{key:"currentEvolution",label:d.label_current_evolution});let s=o.createTableComponent("td",t,n.currentEvolution),l=i.instanceIDs;if(l&&l.length>0){let e="";l.forEach((t=>{o.collection.instEffectivity[t]&&(e+=o.collection.instEffectivity[t].current)})),s.setHTML(e)}}},toggleAllEvent:function(e,t,i){var n=t.getParent(),o=n.getAttribute("status"),r=i.getElements("#archNo-td-checkbox"),a=!0;"ok"===o?(a=!1,n.setAttribute("status","ko")):n.setAttribute("status","ok");for(var s=0;s<r.length;s++){r[s].getParent().getChildren().forEach((function(e,t){var i=e.getElement(".wux-controls-checkbox"),n=e.getElement(".wux-ui-fa.wux-icon");a?(0==t&&(e.setAttribute("status","ok"),i.dsModel.checkFlag=!0,n.addClassName("wux-ui-fa-check")),e.setStyle("background-color","#D5E8F2"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!1)):(0==t&&(e.setAttribute("status","ko"),i.dsModel.checkFlag=!1,n.removeClassName("wux-ui-fa-check")),e.setStyle("background-color","hsl(0, 0%, 98%)"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!0))}))}},toggleEvent:function(e,t,i){var n=t.getParent(),o=n.getAttribute("status");"ok"===o?(n.getParent().getChildren().forEach((function(e){e.setStyle("background-color","hsl(0, 0%, 98%)"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!0)})),n.setAttribute("status","ko")):"ko"===o&&(n.getParent().getChildren().forEach((function(e){e.setStyle("background-color","#D5E8F2"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!1)})),n.setAttribute("status","ok"));for(var r=i.getElements("#archNo-td-checkbox"),a=i.getElements("#archNo-th-checkbox")[0].getParent().getChildren()[0],s=a.getElement(".wux-controls-checkbox"),l=a.getElement(".wux-ui-fa.wux-icon"),c=!0,d=0,u=0;u<r.length;u++)"ko"===r[u].getAttribute("status")&&c?c=!1:"ok"===r[u].getAttribute("status")&&d++;c?(s.dsModel.checkFlag=!0,l.removeClassName("wux-toggle-mixed-icon"),l.addClassName("wux-ui-fa-check")):!c&&d>0?(l.removeClassName("wux-ui-fa-check"),l.addClassName("wux-toggle-mixed-icon")):0===d&&(s.dsModel.checkFlag=!1,l.removeClassName("wux-toggle-mixed-icon"))},render:function(e){var t=this;t.container=e;var i=this.collection.columnNames,n=this.collection.columns,o=0,r=d.arch_no_identifier_message+(t.collection.showRowLevelRecomputation?d.arch_no_recompute_message:"");t.collection.forReparent&&(r+="<br>"+d.label_reparent_archNo_header),t.createTableComponent("p",e.getElement(".identifier-msg"),{html:r}),t.columnNames.forEach((function(e){t.columnDetails[e].architectureIdColumn&&o++})),t.createTableHeaderView(i,n,o).inject(e.getElement(".columnHeader")),t.createTableBodyView(e,o)},nextEditableCell:function(e){if(e.stopPropagation(),9==e.which){e.preventDefault();var t=e.currentTarget.closest("td"),i=t.closest("tr").getChildren(),n=!1;if(t.cellIndex<i.length-1)for(var o=t.cellIndex+1;o<i.length;o++)if("true"==i[o].getAttribute("editable")){i[o].getElement("input").focus(),n=!0;break}if(!n){var r=e.currentTarget.closest("tr").nextSibling;r&&r.getElement("[editable=true] div input").focus()}}}})})),define("DS/CATFLCockpitWidget/components/ExportCSV/ExportGridView.effectivity",["DS/Windows/Dialog","DS/Controls/Button","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/Controls/ProgressBar","DS/Controls/ModalContainer","DS/Controls/Expander","DS/Windows/Panel","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d){"use strict";var u=l.getFullConfig(),p=u.localStorageKeys;return{_showProgressBarforEffColumns:function(e){var t=this;t.progressBarContainer=UWA.createElement("div",{id:"exportgridview-progress-bar",class:"linear-container"});let i=new o({displayStyle:"lite",infiniteFlag:!0});r.createModal(t.progressBarContainer,i.elements.container);var n=new a({header:d.expanderProgressHeader,body:t.progressBarContainer,expandedFlag:!0});t.panel=new s({title:e,content:n.elements.container,modalFlag:!1,immersiveFrame:widget.immersiveFrame,width:100,closeButtonFlag:!1,position:{my:"bottom right",at:"bottom right",of:widget.immersiveFrame}})},_closeProgresBarForEffColumns(){this.panel.close(),r.removeModal(this.progressBarContainer)},_buildExportConfigDataDialog:function(i,n,o,r,a,s){var l=this,c=l._getExportContainer();l.dialog=new e({title:d.export_gridview_dialog_title,content:c,modalFlag:!0,immersiveFrame:widget.immersiveFrame,width:350,height:130,buttons:{Ok:new t({label:d.label_yes,emphasize:"primary",onClick:function(){l._loadDataWithEffColumns(i,n,o,r,a,s),l.dialog.close()}}),Cancel:new t({label:d.label_no,emphasize:"secondary",onClick:function(){l._checkEffColumns(i,n,o,s),l.dialog.close()}})}})},_getExportContainer:function(){var e=this,t=UWA.createElement("div",{html:d.export_gridview_dialog_header});return e.optsButtonGroup=new i({type:"checkbox"}),e.dontAskCheckbox=new n({type:"checkbox",label:d.export_gridview_checkbox,checkFlag:!1}),e.optsButtonGroup.addChild(e.dontAskCheckbox),e.optsButtonGroup.addEventListener("change",(function(){e.optsButtonGroup._getButtonList()[0].checkFlag})),e.optsButtonGroup.inject(t),t},_computeEffColumnsInfo(e,t,i){let n=this,o=l.getFullConfig().identifiers,r={},a={};e.treeDocument.getAllDescendants().forEach((e=>{r[e.options.physicalid]=e,e.options.instance_physicalid&&(a[e.options.instance_physicalid]=e)}));let s,c=[],d=[],u=[],p=e.treeDocument.getAllDescendants().length;for(let n=0;n<p;n++){let r=e.model[n];r&&o.type_act_logref===r.options.type&&(!i||r.options.grid.ConfigurationContext||r.options.linkInfo||u.push(r.options.physicalid),t&&r.options.instance_physicalid&&!r.options.grid.Effectivity&&(c.push(r.options.instance_physicalid),d.push(r.options.physicalid)))}switch(!0){case p>5e3&&p<=1e4:s=2;break;case p>1e4&&p<=15e3:s=3;break;case p>15e3:s=4;break;default:s=1}let g=[],f=[],m=Math.ceil(p/s);for(let t=0;t<s;t++){let i=t*m,o=u.slice(i,i+m),s=c.slice(i,i+m),l=d.slice(i,i+m);g.push(n.getConfigContextInfo(o,e,r)),f.push(n.getEffectivitiesInfo(s,l,e,a))}let h=[...g,...f];return Promise.all(h)},getConfigContextInfo(e,t,i){var n=this;let o;if(e.length>0){var r={relids:[],pids:e},a=u.gridview.additionalColumnsModules.cfgContext;a&&(o=new Promise((function(e,t){a.updateAttributes(r,(function(i){var n=UWA.is(i,"string")?JSON.parse(i):i;e(n),t("Error in Cfg_updateAttributes")}),n)})),o.then((function(n){let o=n?n.pids:{};t.treeDocument.withTransactionUpdate((function(){e.forEach((function(e){let t=i[e],n=o[e].ConfigurationContext;n&&(t.options.grid={...t.options.grid,ConfigurationContext:n})}))}))})).catch((e=>{console.error("Error getting cfgContext: ",e)})))}return o},getEffectivitiesInfo(e,t,i,n){var o=this;let r;if(e.length>0){var a={relids:e,pids:t},s=u.gridview.additionalColumnsModules.cfgEffectivty;s&&(r=new Promise((function(e,t){s.updateAttributes(a,(function(i){var n=UWA.is(i,"string")?JSON.parse(i):i;e(n),t("Error in Cfg_updateAttributes")}),o)})),r.then((function(t){let o=t?t.relids:{};i.treeDocument.withTransactionUpdate((function(){e.forEach((function(e){var t=n[e],i=o[e];i&&(i.VariantEffectivity.trim()||(i.VariantEffectivity=d.label_none),t.options.grid={...t.options.grid,...i})}))}))})).catch((e=>{console.error("Error getting cfgEffectivty: ",e)})))}return r},_loadDataWithEffColumns(e,t,i,n,o,r){let a=this;a.dontAskCheckbox.checkFlag&&(widget.setValue(p.exportConfigData,"export_gridview_pref_always"),c.alertMessage("success",null,"",d.export_gridview_success_msg));null===a._checkProgressElementifExists()&&(a._showProgressBarforEffColumns(e.treeDocument.getRoots()[0].options.label),a._computeEffColumnsInfo(t,n,o).then((()=>{a._closeProgresBarForEffColumns(),r(e,t,i,!0)})).catch((e=>{console.error("Error getting Configuration data: ",e)})))},_checkEffColumns(e,t,i,n){this.dontAskCheckbox.checkFlag&&(widget.setValue(p.exportConfigData,"export_gridview_pref_never"),c.alertMessage("success",null,"",d.export_gridview_success_msg)),this._removeEffColumns(e,t,i,n)},_removeEffColumns(e,t,i,n){const o=["ConfigurationContext","Effectivity","VariantEffectivity","CurrentEvolutionEffectivity","ProjectedEvolutionEffectivity"];t.columns=t.columns.filter((e=>!o.includes(e.dataIndex))),n(e,t,i,!1)},_checkProgressElementifExists:function(){return document.getElementById("exportgridview-progress-bar")?(c.alertMessage("info",null,d.exportGridViewProgress),-1):null}}})),define("DS/CATFLCockpitWidget/components/ContentListView/decorators/contentlistview.cues",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/ConvergenceCues/ConvergenceCues.export","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a){"use strict";return{addConvergenceCuesListeners:function(e){var t=this;t.contentListViewController=e,t.contentListViewController.modelEvents.subscribe({event:"content-list-view-validate-cues"},t.validateCuesForItems.bind(t,null,!1)),t.contentListViewController.modelEvents.subscribe({event:"content-list-view-clear-cues"},t.clearCuesForItems.bind(t)),t.contentListViewController.modelEvents.subscribe({event:"content-list-view-update-cues"},t.updateCuesForItems.bind(t)),t.contentListViewController.modelEvents.subscribe({event:"content-list-view-export-cues"},r.exportCuesForItems.bind(t))},validateCuesForItems:function(r,s){var l=this,c=!1;r?c=!0:r=l.contentListViewController.contentView.treeDocument.getSelectedNodes();var d,u,p=[];if(!s&&r.length<=0)t.alertMessage("error",null,a.error_cue_computation_noSelItems);else if(l.contentListViewController.selectedItemsForCues||(l.contentListViewController.selectedItemsForCues={}),l.contentListViewController._cueGlobalCount||(l.contentListViewController._cueGlobalCount={COMBINED:0,CRITICAL:0,ERROR:0,WARNING:0,INFO:0}),l.contentListViewController._cueComputedIds||(l.contentListViewController._cueComputedIds=[]),d=l.contentListViewController.contentView.treeDocument.getRoots()[0].options.physicalid,s||1!==r.length||r[0]._options.physicalid!==d){for(var g=!1,f=[],m=0;m<r.length;m++)r[m]._options.instance?(u=r[m]._options.instance.physicalid,p.push(u),l.contentListViewController.selectedItemsForCues[u]=r[m],f.push(r[m])):g||r[m]._options.physicalid===d||(g=!0);var h=n.confAllImplPathsOnNodes(f,!1,!1);if(p&&p.length>0){var v=l.contentListViewController.contentView.getContent();e.mask(v,a.msg_processing),o.validateVisualCues(p,h.payload).then((function(e){if(e){if(l.mapCueResponse(p,e),l.contentListViewController.selectedItemsForCues)for(var n in l.contentListViewController.selectedItemsForCues){var o=l.contentListViewController.selectedItemsForCues[n],r="",d=o._options.cueDetails;if(d&&d.cue.length<=0)o.setAttribute("cue",d.cue);else if(d&&l.contentListViewController._cueGlobalCount){for(var u in l.contentListViewController._cueGlobalCount){0!==r.length&&(r+="; "),r+=l.getNLSValueCueSeverity(u)+":"+l.contentListViewController._cueGlobalCount[u]}d.cueTooltip.indexOf(a.total)>=0&&(d.cueTooltip=d.cueTooltip.substring(0,d.cueTooltip.indexOf(a.total))),d.cueTooltip+=a.total+" "+r,o.setAttribute("cue",d.cue),o.setAttribute("cueTooltip",d.cueTooltip)}}s||t.alertMessage("success",null,a.msg_cue_computation_complete),c&&i.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-cues-report"})}})).catch((function(e){return t.displayError(e,null,null,a.msg_generic_error_get_failed),Promise.reject()})).finally((function(){e.unmask(v)}))}!s&&g&&t.alertMessage("warning",null,a.warn_cue_computation_otherTypes)}else t.alertMessage("error",null,a.error_cue_computation_root)},mapCueResponse:function(e,t){var i,n,o=this;e.forEach((function(e){var r=o.contentListViewController.selectedItemsForCues[e],s=t[e];if(i={COMBINED:0,CRITICAL:0,ERROR:0,WARNING:0,INFO:0},r&&s){n="COMBINED"===s.cueSeverity?"group":"CRITICAL"===s.cueSeverity?"alert":"ERROR"===s.cueSeverity?"status-ko":"WARNING"===s.cueSeverity?"attention":"INFO"===s.cueSeverity?"info":"status-ok",o.contentListViewController._cueComputedIds.indexOf(e)<0&&o.contentListViewController._cueComputedIds.push(e);var l="",c="-",d=s.cueCount?s.cueCount:s.cueRowCount;if(r._options.cueDetails){var u=r._options.cueDetails.cueCount;for(var p in u)u[p]>0&&o.contentListViewController._cueGlobalCount[p]>=u[p]&&(o.contentListViewController._cueGlobalCount[p]-=u[p])}if(d){for(var p in c="",d)i[p]=d[p],o.contentListViewController._cueGlobalCount[p]+=d[p];for(var g in i){var f=i[g];if(f>0)0!==c.length&&(c+="; "),c+=o.getNLSValueCueSeverity(g)+":"+f}l=a.row+" "+c+"\n"}r._options.cueDetails={cue:n,cueTooltip:l,cueCount:d}}}))},clearCuesForItems:function(){var e=this,i=e.contentListViewController.contentView.treeDocument.getSelectedNodes();if(i.length<=0)t.alertMessage("error",null,a.error_cue_clear_noSelItems);else if(e.contentListViewController._cueComputedIds&&0!==e.contentListViewController._cueComputedIds.length){for(var n=0;n<i.length;n++){if((d=i[n])._options.instance){var o=d._options.instance.physicalid,r=d._options.cueDetails?d._options.cueDetails.cueCount:null;if(r)for(var s in r)r[s]>0&&(e.contentListViewController._cueGlobalCount[s]-=r[s]);e.contentListViewController._cueComputedIds.indexOf(o)>=0&&e.contentListViewController._cueComputedIds.splice(e.contentListViewController._cueComputedIds.indexOf(o),1),delete e.contentListViewController.selectedItemsForCues[o];var l="";if(e.contentListViewController._cueGlobalCount)for(var c in e.contentListViewController._cueGlobalCount)0!==l.length&&(l+="; "),l+=c+":"+e.contentListViewController._cueGlobalCount[c];if(e.contentListViewController.selectedItemsForCues)for(var s in e.contentListViewController.selectedItemsForCues){var d,u=(d=e.contentListViewController.selectedItemsForCues[s])._options.cueDetails;if(u&&0!==l.length){var p=u.cueTooltip;p=p.substring(0,p.indexOf(a.total))+a.total+" "+l,u.cueTooltip=p,d.setAttribute("cueTooltip",p)}}i[n].setAttribute("cue",""),i[n].setAttribute("cueTooltip",""),delete i[n]._options.cueDetails}}0===e.contentListViewController._cueComputedIds.length&&(e.contentListViewController._cueGlobalCount=null),e.contentListViewController.modelEvents.publish({event:"close-properties-panel"}),t.alertMessage("success",null,a.msg_cue_clear_success)}else t.alertMessage("error",null,a.error_cue_clear_noCueComputation)},updateCuesForItems:function(e){var t=this,i=[];e&&e.length>0&&(e.forEach((function(e){var n=e.options.instance?e.options.instance.physicalid:null;t.contentListViewController._cueComputedIds&&n&&t.contentListViewController._cueComputedIds.indexOf(n)>=0&&i.push(e)})),t.validateCuesForItems(i,!0))},getNLSValueCueSeverity:function(e){var t="";return"WARNING"===e?t=a.cue_warning:"ERROR"===e?t=a.cue_error:"CRITICAL"===e?t=a.cue_critical:"INFO"===e?t=a.cue_info:"COMBINED"===e&&(t=a.cue_combined),t}}})),define("DS/CATFLCockpitWidget/components/DisciplineIterations/consolidateDefinition",["UWA/Core","DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/Controls/ComboBox","DS/DataGridView/DataGridView","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f){"use strict";var m=function(e){this.options=e};return m.prototype.render=function(){var e=this,t=e.getConsolidateOptionsContainer();e.dialog=new i({title:f.header_consolidate_log_defn,content:t,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new n({label:f.action_consolidate,emphasize:"primary",onClick:e._performCollectDefinitionOperation.bind(e)}),Cancel:new n({emphasize:"secondary",onClick:function(){e.dialog.close()}})}}),e.dialog.addEventListener("close",(function(){e.dialog.destroy()}))},m.prototype.getConsolidateOptionsContainer=function(){var t=this,i=e.createElement("div",{class:"consolidate-options-container"});return t.optsButtonGroup=new o({type:"checkbox"}),t.optsButtonGroup.addChild(new r({type:"checkbox",label:f.label_copy_spaces,checkFlag:!0})),t.optsButtonGroup.addChild(new r({type:"checkbox",label:f.label_remove_spaces,checkFlag:!0})),t.optsButtonGroup.addChild(new r({type:"checkbox",label:f.label_change_maturity_to,checkFlag:!1})),t.optsMaturity=new a({elementsList:[{label:f.maturityStates.FROZEN,value:"FROZEN"},{label:f.maturityStates.RELEASED,value:"RELEASED"}],enableSearchFlag:!1}),t.optsButtonGroup.addEventListener("change",(function(){var e=t.optsButtonGroup._getButtonList(),i=t.dialog.buttons.Ok,n=e.every((function(e){return!e.checkFlag}));i.disabled=!!n})),t.optsMaturity.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation()})),t.optsButtonGroup.inject(i),t.optsMaturity.inject(i.getElement(".wux-controls-abstract.wux-controls-toggle.wux-controls-checkbox:nth-child(3)")),i},m.prototype._performCollectDefinitionOperation=function(){var o=this;if(o.processing)l.alertMessage("info",null,f.info_process_in_progress);else{o.processing=!0,t.mask(o.dialog.content,f.msg_processing);var r={},a=[],s=o.options.selectedNodes;s.forEach((function(e){r[e.options.physicalid]=e,a.push(e.options.instance.physicalid)}));var p=u.confAllImplPathsOnNodes(s,!1,!1),g={copyAssignedDesignSpaces:o.optsButtonGroup.getButton(0).checkFlag,removePreviouslyAssignedDesignSpaces:o.optsButtonGroup.getButton(1).checkFlag,changeMaturity:o.optsButtonGroup.getButton(2).checkFlag};!0===g.changeMaturity&&(g.maturityStateSelected=o.optsMaturity._properties.currentValue.value);var m={consolidateLogicalDefinition:g,instanceIds:a,occurrenceInfo:p.payload,frozenStatesDB:["FROZEN","RELEASED"],frozenStatesNLS:[f.maturityStates.FROZEN,f.maturityStates.RELEASED]};d.consolidateLogicalDefinition(m).then((function(t){var a,s=t.rowsData;for(var l in s){var d=s[l];if(d.authoringStatus&&1==d.authoringStatus){a=!0;break}}a&&(c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:Object.keys(r),tagAsRecentlyAuthored:!0}}),c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-refLinks-by-id",data:Object.values(r)}));var u=[],p="check",m="wrong",h="status-noway",v=0;for(let e in s){let t=s[e];var C={},y=r[t.referenceId];C.title={value:y.options.label,tooltip:y.options.label},C.revision={value:y.options.grid.revision,tooltip:y.options.grid.revision},C.maturity={value:t.maturity,tooltip:t.maturity},C.instTitle={value:t.instanceTitle,tooltip:t.instanceTitle};var b={value:"",tooltip:""};if(t.status)if("processed"===t.status.toLowerCase())b.value=p,v++;else if("error"===t.status.toLowerCase()?b.value=m:b.value=h,t.errors&&t.errors.length>0){var _=t.errors.join("\r\n");b.tooltip=_}C.status=b;var w={released:"",frozen:"",inwork:"",tooltip:""};t.pilotingDisciplines&&(w.released=t.pilotingDisciplines.released.join("\r\n"),w.frozen=t.pilotingDisciplines.frozen.join("\r\n"),w.inwork=t.pilotingDisciplines.inwork.join("\r\n")),C.pilotingDisc=w;var D={value:"",tooltip:""};g.removePreviouslyAssignedDesignSpaces&&(t.spacesRemoved&&(D.value=t.spacesRemoved.join("\r\n")),C.removedSpaces=D);var S={value:"",tooltip:""};g.copyAssignedDesignSpaces&&(t.spacesAdded&&(S.value=t.spacesAdded.join("\r\n")),C.addedSpaces=S);var I={value:"",tooltip:""};g.changeMaturity&&(t.maturityMoved&&("moved"===t.maturityMoved.value.toLowerCase()?I.value=p:"notmoved"===t.maturityMoved.value.toLowerCase()?I.value=m:"moverestrictedfromopenness"===t.maturityMoved.value.toLowerCase()?I.value="status-ko":I.value=h,I.tooltip=t.maturityMoved.tooltip.join()),C.freezeLR=I),u.push(C)}var A=e.createElement("div",{class:"report-consolidation-container"});e.createElement("div",{html:"<em>"+f.replace(f.msg_consolidation_processed_report,{countOk:v,totalCount:u.length})+"<em>"}).inject(A);var F=e.createElement("div",{class:"report-consolidation-dgv"}).inject(A);o._createDataGridView({items:u,consolidateOptions:g}).inject(F);var k=new i({title:f.header_summary_consolidate_log_defn,height:500,width:1200,content:A,modalFlag:!0,resizableFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Close:new n({emphasize:"secondary",onClick:function(){k.close()}})}});k.addEventListener("close",(function(){k.destroy()}))})).catch((function(e){l.displayError(e,null,null,f.error_consolidate_definition)})).finally((function(){o.processing=!1,t.unmask(o.dialog.content),o.dialog.close()}))}},m.prototype._createDataGridView=function(e){var t=new p({useAsyncPreExpand:!0});t.prepareUpdate();var i=e.consolidateOptions;e.items.forEach((function(e){var n={label:e.title.value,grid:{revision:e.revision.value,maturity:e.maturity.value,instanceTitle:e.instTitle.value,status:e.status.value,pilotingDisc_released:e.pilotingDisc.released,pilotingDisc_frozen:e.pilotingDisc.frozen,pilotingDisc_inwork:e.pilotingDisc.inwork},item:e,editableFlag:!1};i.removePreviouslyAssignedDesignSpaces&&(n.grid.removedSpaces=e.removedSpaces.value),i.copyAssignedDesignSpaces&&(n.grid.addedSpaces=e.addedSpaces.value),i.changeMaturity&&(n.grid.freezeLR=e.freezeLR.value),t.addChild(new g(n))})),t.setFilterModel({label:{filterId:"stringRegexp"},revision:{filterId:"stringRegexp"},maturity:{filterId:"set"},instanceTitle:{filterId:"stringRegexp"},pilotingDisc_released:{filterId:"stringRegexp"},pilotingDisc_frozen:{filterId:"stringRegexp"},pilotingDisc_inwork:{filterId:"stringRegexp"},addedSpaces:{filterId:"stringRegexp"},removedSpaces:{filterId:"stringRegexp"}}),t.pushUpdate();var n=new s({identifier:"SystemArchitectureRelease_ConsolidateDefnReport",height:"inherit",treeDocument:t,columns:this._getDataGridViewColumns(i),rowSelection:"none",defaultColumnDef:{typeRepresentation:"string",width:"auto"},sortModel:[{dataIndex:"tree",sort:"asc"}],getCellTooltip:function(e){let t;return e.nodeModel&&(t=n.getColumnOrGroup(e.columnID)),!t||"status"!==t.dataIndex&&"freezeLR"!==t.dataIndex?n.getCellDefaultTooltip(e):{shortHelp:e.nodeModel.options.item[t.dataIndex].tooltip,updateModel:!1}},onContextualEvent:function(e){if(e.cellInfos){if(e.cellInfos&&-1===e.cellInfos.rowID){let t={firstColumnsVisibility:!1,columnsManagement:!1};return e.collectionView.buildDefaultContextualMenu(e,t)}return!1}}});return n.getContent()},m.prototype._getDataGridViewColumns=function(e){var t=[{text:f.label_title,dataIndex:"tree",alwaysVisibleFlag:!0,pinned:"left"},{text:f.label_revision,dataIndex:"revision",width:80,pinned:"left"},{text:f.label_maturity,dataIndex:"maturity",width:120,pinned:"left"},{text:f.label_instance_title,dataIndex:"instanceTitle",pinned:"left"},{text:f.label_piloting_disciplines,dataIndex:"pilotingDisc",children:[{dataIndex:"pilotingDisc_inwork",text:f.label_inwork,typeRepresentation:"textBlock",autoRowHeightFlag:!0},{dataIndex:"pilotingDisc_frozen",text:f.label_frozen,typeRepresentation:"textBlock",autoRowHeightFlag:!0},{dataIndex:"pilotingDisc_released",text:f.label_released,typeRepresentation:"textBlock",autoRowHeightFlag:!0}]},{text:f.label_consolidation_status,dataIndex:"status",alignment:"center",typeRepresentation:"icon",width:80}];if(e.copyAssignedDesignSpaces||e.removePreviouslyAssignedDesignSpaces){var i={text:f.label_design_spaces,dataIndex:"designSpaces",children:[]};e.copyAssignedDesignSpaces&&i.children.push({text:f.label_added,dataIndex:"addedSpaces",typeRepresentation:"textBlock",autoRowHeightFlag:!0}),e.removePreviouslyAssignedDesignSpaces&&i.children.push({text:f.label_removed,dataIndex:"removedSpaces",typeRepresentation:"textBlock",autoRowHeightFlag:!0}),t.push(i)}if(e.changeMaturity){const i="FROZEN"===e.maturityStateSelected?f.label_move_to_selected_state.replace("{selectedMaturity}",f.maturityStates.FROZEN):f.label_move_to_selected_state.replace("{selectedMaturity}",f.maturityStates.RELEASED);t.push({text:i,dataIndex:"freezeLR",alignment:"center",typeRepresentation:"icon",width:120})}return t},m})),define("DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumber",["UWA/Core","DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/CoreEvents/ModelEvents","DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumberView","DS/Handlebars/Handlebars4","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/architectureNumber.util","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumber.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f){return p=JSON.parse(p),{init:function(e,t){var i=this;return t?(i.forReparent=!0,i.newParentID=t.newParent.options.physicalid,i.reparentRefreshData={params:t.params,newParent:t.newParent,instArray:t.selectedNodes,resp:null}):i.forReparent=!1,this.modelEvents=new o,i.duplicateP2LWarningIDs={},i.createModal(e),i.pushSetArchView(e)},createModal:function(e){var o=this,r=a.compile(g),c=(o.forReparent?f.label_reparent_set_archNo:f.label_set_arch_no)+" - ";1===e.rows.length?c+=e.rows[0].title:c+=e.rows.length+" "+f.label_objects;var d={Cancel:new n({onClick:function(){o.modalWindow.destroy()}}),Ok:new n({label:o.forReparent?f.label_reparent:f.set_button,onClick:function(){t.mask(o.modalWindow.elements._contentDiv,f.msg_processing);for(var i=[],n=0,r=o.modalWindow.getContent().getElement(".itemDetails").getChildren("tr"),a=0;a<r.length;a++)("ko"===r[a].getChildren()[0].getAttribute("status")||r[a].getChildren()[0].hasClassName("iconColor"))&&n++;if(n===r.length)return s.alertMessage("error",null,f.log_ref_selection_error),void t.unmask(o.modalWindow.elements._contentDiv);var c,d={};for(let e=0;e<r.length;e++){var p,g=r[e],m={},h=g.getAttribute("referenceID"),v=g.querySelectorAll('[required = "true"]'),C=!1;if(!g.getChildren()[0].getAttribute("status")||"ko"===g.getChildren()[0].getAttribute("status")){o.reparentRefreshData&&o.reparentRefreshData.instArray.forEach((function(e,t,i){e.options.physicalid!==h||i.splice(t,1)}));continue}if("onlyReparent"===g.getChildren()[0].getAttribute("status")){c=Array.isArray(g.getAttribute("instanceIDs"))?g.getAttribute("instanceIDs"):[g.getAttribute("instanceIDs")],i.push({referenceID:h,instanceIDs:c});continue}for(var y=0;y<v.length;y++){let e=v[y];if("true"===e.getAttribute("editable"))if(""==e.getElement("input").value.trim()){e.getElement("input").scrollIntoView(),e.getElement("input").addClassName("errordiv"),s.alertMessage("error",null,f.req_field_error_header,e.getAttribute("name")+f.arch_number_required_field),C=!0;break}}if(C)break;if((p=g.getElement(".archidcell")?g.getElement(".archidcell").getHTML():g.querySelector('[architectureidcolumn = "true"]').getElement("input").value.trim())==g.getElement("#existing").getHTML()){t.unmask(o.modalWindow.elements._contentDiv),s.alertMessage("error",null,"",f.existing_architecture_number_error),g.getElement(".archidcell")?g.getElement(".archidcell").addClassName("errordiv"):g.querySelector('[architectureidcolumn = "true"]').addClassName("errordiv"),C=!0;break}if(u.checkifANcontainsInvalidChars(p)){t.unmask(o.modalWindow.elements._contentDiv),s.alertMessage("error",null,"",f.msg_set_arch_num_failed_invalid_char),g.getElement(".archidcell")?g.getElement(".archidcell").addClassName("errordiv"):g.querySelector('[architectureidcolumn = "true"]').addClassName("errordiv"),C=!0;break}d[h]=p;var b=null,_=null,w={};g.getElements("[architectureidcolumn=true]").forEach((e=>{if(b=e.getAttribute("id"),"true"===e.getAttribute("editable")){let t=e.getChildren()&&e.getChildren()[0];_=t.dsModel.value}else _=e.getHTML();w[b]=_}));let n=g.getAttribute("instanceIDs");n?m.instanceIDs=Array.isArray(n)?n:n.split(","):g.getAttribute("instanceID")&&(m.instanceID=g.getAttribute("instanceID")),m.referenceID=h,m.ArchitectureNumber=p,m.ArchitectureNumberTokens=w,i.push(m)}if(C)t.unmask(o.modalWindow.elements._contentDiv);else{var D=o.setPayload(i,d);D.AN_ACTION=e.AN_ACTION,o.removeCSS(),o.forReparent?l.setANandReparent(D).then((function(e){e=JSON.parse(e),o.setArchitectureNumber(e,d)})).catch((function(e){t.unmask(o.modalWindow.elements._contentDiv),s.displayError(e,null,null,f.error_set_archno)})):l.setArchitectureNumber(D).then((function(e){e=JSON.parse(e),o.setArchitectureNumber(e,d)})).catch((function(e){t.unmask(o.modalWindow.elements._contentDiv),s.displayError(e,null,null,f.error_set_archno)}))}}})};e.showBulkRecomputation&&(d.Apply=new n({label:f.label_reEvaluate_ArchNo,onClick:function(){u.executeRecompute({an_action:e.AN_ACTION,rows:o.modalWindow.getContent().getElement(".itemDetails").getChildren("tr"),forReparent:o.forReparent})}})),o.modalWindow=new i({title:c,content:r(),domId:"set-architecture-number",immersiveFrame:widget.immersiveFrame,width:900,height:400,resizableFlag:!0,modalFlag:!0,buttons:d}),o.modelEvents.subscribe({event:"enter-key-pressed"},(function(){d.Ok.onClick()}))},pushSetArchView:function(e){var t=this;return t._architectureNumberView=new r({modelEvents:t.modelEvents}),e.forReparent=t.forReparent,t._architectureNumberView.setCollection(e).render(t.modalWindow.getContent()),t.modalWindow},modalSubmit:function(){},setPayload:function(e,t){var i=this,n={},o=[];for(var r in i.duplicateP2LWarningIDs){i.duplicateP2LWarningIDs[r]===t[r]&&o.push(r)}return i.forReparent?(n.newParentID=i.newParentID,n.instances=e):n.architectureNumbers=e,n.ignoreP2LWarningIDs=o,i.duplicateP2LWarningIDs={},n},setCSS:function(e,t){var i=this;e.forEach((function(e){var n=i.modalWindow.getContent().getElement('.itemDetails tr[referenceID ="'+e+'"]'),o=n.getElement(".archidcell");if(t)if(o)o.addClassName(t),o.scrollIntoView();else{var r=n.querySelector('[architectureidcolumn = "true"]');r.addClassName(t),r.getElement("input").scrollIntoView()}else o||(o=n.querySelector('[architectureidcolumn = "true"]')),o.hasClassName("errordiv")&&o.removeClassName("errordiv")}))},removeCSS:function(){for(var e=this.modalWindow.getContent().getElement(".itemDetails").getElements("tr"),t=0;t<e.length;t++)for(var i=0;i<e[t].getChildren().length;i++)e[t].getChildren()[i].hasClassName("archidcell errordiv")&&e[t].getChildren()[i].removeClassName("errordiv")},setArchitectureNumber:function(e,i){var n=this,o=n.modalWindow.getContent().getElement(".itemDetails").getElements("tr");if(t.unmask(n.modalWindow.elements._contentDiv),e.status&&200!=e.status){var r,a=null,l=[],u=[],p=[],g=[],m=[],h=[];o.forEach((function(t){var o=t.getAttribute("referenceID");"NON_COMPLIANCE"===e[o]?m.push(o):"NOCSGROUP"==e[o]||"FROZEN_REV"==e[o]||"NO_MODIFY_ACCESS"==e[o]?l.push(o):"KO"==e[o]||"UNICITY_KO"==e[o]?u.push(o):"P2L_DUPLICATE_WARNING"==e[o]?(n.duplicateP2LWarningIDs[o]=i[o],p.push(o)):"UNICITY_OK"==e[o]?g.push(o):"INVALID_CHAR"==e[o]&&h.push(o)})),m.length>0?(a="errordiv",n.setCSS(m,a),n.duplicateP2LWarningIDs={},r={type:"error",message:f.msg_arch_number_non_compliance}):l.length>0?(a="errordiv",n.setCSS(l,a),n.duplicateP2LWarningIDs={},r={type:"error",message:f.msg_error_set_architecture_number_unselect_reference}):u.length>0?(a="errordiv",n.setCSS(u,a),n.duplicateP2LWarningIDs={},r={type:"error",message:f.arch_number_unique_error}):p.length>0?(a="errordiv",n.setCSS(p,a),r={type:"warning",message:f.msg_error_set_architecture_number_p2lwarning}):h.length>0?(a="errordiv",n.setCSS(h,a),r={type:"error",message:f.msg_set_arch_num_failed_invalid_char}):r={type:"error",message:f.msg_set_arch_num_failed},r&&(t.unmask(n.modalWindow.elements._contentDiv),s.alertMessage(r.type,null,"",r.message))}else{if(n.forReparent)n.reparentRefreshData.resp=e,d.refreshNodesOnReparent(n.reparentRefreshData),s.alertMessage("success",null,"",f.msg_reparent_setArch_success);else{var v=[];for(var C in e)i.hasOwnProperty(C)&&v.push(C);c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:v,tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:!0}});var y=widget.getValue("currentOpenedItem");y&&v.indexOf(y)>=0&&c.getFLWebModelEventsObj("flweb-model-events").publish({event:"idcard-refresh"}),s.alertMessage("success",null,"",f.set_arch_number_success)}e.postProcessWarningMessage&&s.alertMessage("warning",null,"",e.postProcessWarningMessage),n.modalWindow.destroy()}}}})),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment",["DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/ENOXEmptyContent/js/ENOXEmptyContent","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/document.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumber","DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f,m,h){"use strict";let v=o.getFullConfig(),C=v.identifiers;return{addExistingDoc:function(e,t){var i=this.addExistingDocAsInstance.bind(this,e,t);a.launchSearch({searchTitle:h.label_search_doc,allowedTypes:C.types_addExistingDoc,role:"",criteria:C.type_documents,bMultiSel:!0,in_apps_callback:i})},addExistingDocAsInstance:function(t,i,n){if(n){var a,s;e.mask(widget.body,h.msg_processing),i&&(a=C.rel_specification,s="specificationDocumentsCategory");var l=[];let d=o.getSecurityContext();d=d.split(".")[0];let p=d+"."+t.options.grid.organization+"."+t.options.grid.project;return n.forEach((function(e){var i=e.id?e.id:e.objectId;l.push(u.attachDocument(t.options.physicalid,i,a,p))})),Promise.all(l).then((function(){e.unmask(widget.body),r.alertMessage("success",null,h.msg_attach_doc_success),c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-documents-by-id",data:{nodes:[t],docType:s}})}),(function(t){e.unmask(widget.body),r.displayError(t,h.msg_add_item_error,null,h.replace(h.error_no_access,{errorOp:h.action_insert_existing+" "+h.label_document}))}))}},setArchitectureNumber:function(t,i){let n=!1;i&&i.newParent&&(n=!0);let o=document.body.querySelector(".fl-cockpit-content-list-container");e.mask(o,h.msg_loading);let a,s,l={};if(n){a={newParentID:i.newParent.options.physicalid};let e=[];t.forEach((function(t){e.push({instanceID:t.options.instance.physicalid,referenceID:t.options.physicalid})})),a.instances=e}else a=[],Array.isArray(t)?(s=[],t.forEach((function(e){let t=e.options.physicalid,i={referenceID:t};if(e.options.instance){let n=e.options.instance.physicalid;i.instanceID=n,s.push(n),l[t]?l[t].push(n):l[t]=[n]}a.push(i)}))):a.push({referenceID:t});let c=[];return n?c.push(d.getANProposalForReparent(a)):(c.push(d.getArchitectureNumberProposal(a)),s&&s.length>0&&c.push(g.getEffectivityInfo(s))),Promise.all(c).then((function(e){let o=JSON.parse(e[0]),r=e[1],a=!1,s={};if(n&&(i.selectedNodes=t),r){let e,t;for(let i in r)r.hasOwnProperty(i)&&(e=r[i],"YES"===e.hasEffectivity&&(t=e.content&&e.content.Evolution,t&&t.Current&&t.Projected&&(s[i]={current:t.Current.replace(/(\r\n|\n|\r)/gm," "),projected:t.Projected.replace(/(\r\n|\n|\r)/gm," ")},a||(a=!0))));o.bEffectivityCol=a,o.instEffectivity=s}f.init(o,i)})).catch((function(e){r.displayError(e,null,h.error_header,h.error_get_archno_proposal)})).finally((function(){e.unmask(o)}))},detachArchitectureReferenceExtension:function(t,i){e.mask(i,h.msg_processing);var n=this,o=[];return t.forEach((function(e){o.push(e.options.physicalid)})),d.detachArchitectureReferenceExtension(o,"VALIDATE_AND_REMOVE").then((function(a){var s=JSON.parse(a);if(s.requirePreprocess){var l=UWA.createElement("div",{styles:{"min-height":"100px","max-height":"210px","overflow-y":"auto"}});l.innerText=s.message,m.createWindow(h.action_remove_architecture_number,l,h.label_archNum_remove_confirm_preprocess,(function(){e.mask(i,h.msg_processing),d.detachArchitectureReferenceExtension(o,"PRE_PROCESS_AND_REMOVE").then((function(e){let i="success";(e=JSON.parse(e)).ignored&&(i="warning"),r.alertMessage(i,null,e.message),n.detachArchNumUpdateView(o,t)}),(function(e){r.displayError(e,null,h.error_header,h.error_rem_archno)})).finally((function(){e.unmask(i)}))}))}else r.alertMessage("success",null,s.message),n.detachArchNumUpdateView(o,t)})).catch((function(e){r.displayError(e,null,h.error_header,h.error_rem_archno)})).finally((function(){e.unmask(i)}))},detachArchNumUpdateView:function(e){var t=widget.getValue("currentOpenedItem");t&&e.indexOf(t)>=0&&c.getFLWebModelEventsObj("flweb-model-events").publish({event:"idcard-refresh"}),c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:e,tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:!1}})},openModalSolutionSelection:function(e){var o=this,s=new i({label:h.label_search,emphasize:"primary",onClick:function(){a.launchSearch({searchTitle:h.label_search_product,allowedTypes:C.type_act_physical,role:"",criteria:C.type_act_physical,bMultiSel:!1,in_apps_callback:function(t){o.updateSolutionID(t[0].id,l,d,e)}})}}),l=new n({sentences:[{type:"dom",DOMelement:s.getContent()},{type:"drop",text:h.msg_drop_to_open}]}),c=h.action_set_proposed_solution+" - ";1===e.length?c+=e[0].options.label:c=c+e.length+" "+h.label_objects;var d=new t({title:c,content:l._containerEmptyContent,width:580,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame});d.addEventListener("close",(function(){d.destroy()})),r.makeDroppable(d.elements._contentDiv,"",(function(t){null!==t&&p.getKindOfRFLP([t[0].objectId]).then((function(i){"P"===i[0]?o.updateSolutionID(t[0].objectId,l,d,e):r.alertMessage("error",null,h.error_dropped_item_not_physical)}))}))},detachDocuments:function(t){e.mask(widget.body,h.msg_processing);let i=widget.getValue("groupingEnabled"),n=[];var a=[],s=[],d=[];return t.forEach((function(e){var t=e.getParent().getParent();i&&!t.getID&&(t=l.getGroupNodeParent(t));var o=t.options.physicalid;n.push(o);var r="specificationDocumentsCategory"===e.getParent().options.type;r?d.push(e):s.push(e);var c=e.options.physicalid;a.push(u.removeDocument(o,c,r))})),Promise.all(a).then((function(){1===t.length?r.alertMessage("success",null,t[0].options.label+h.msg_detach_document):r.alertMessage("success",null,t.length+h.msg_detach_documents),s.length>0&&c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"remove-items-from-category",data:{nodes:s,categoryType:"attachedDocumentsCategory"}}),d.length>0&&c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"remove-items-from-category",data:{nodes:d,categoryType:"specificationDocumentsCategory"}}),n&&n.length>0&&n.forEach((e=>{o.SAXStorage().setItem(v.localStorageKeys.recentlyAuthored+e,Date.now())})),e.unmask(widget.body)}),(function(t){r.displayError(t,null,h.error_remove_item),e.unmask(widget.body)}))},detachSolution:function(e,t,i){var n,a=[];let s=widget.getValue("groupingEnabled");for(n in t)t.hasOwnProperty(n)&&a.push({refId:n,solIds:t[n]});return d.detachSolution(a).then((function(){var t=[];i.forEach((function(i){var n=i.options.physicalid,r=i.getParent();if(r){var a=r.getParent();if(s&&!a.getID&&(a=l.getGroupNodeParent(a)),s&&a.isRoot()){let e=r.getParent();r.getChildren().forEach((function(e){e.options.physicalid===n&&e.remove()})),r.getChildren()&&0!==r.getChildren().length||r.remove(),l.removeGroupNodesOnEmpty(e)}else{(e.getMappedNodesFromId(a.options.physicalid)||[a]).forEach((function(e){t.push(e);var i=e.options.instance?e.options.instance.physicalid:"",o=e.getNodesByRelId("proposedsolution"+i)[0];o.getChildren().forEach((function(e){e.options.physicalid===n&&e.remove()})),o.getChildren()&&0!==o.getChildren().length||o.remove()}))}o.SAXStorage().setItem(v.localStorageKeys.recentlyAuthored+a.options.physicalid,Date.now())}})),r.alertMessage("success",null,h.msg_remove_solution_success),t.length>0&&c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:t})})).catch((function(e){r.displayError(e,null,h.error_header,h.error_rem_prop_soln)}))},addExistingItem:function(e,t,i){require(["DS/CATFLCockpitWidget/utils/SAXTracker"],(function(e){e.trackCommandLaunched("createExistingLogRef-sax")}));var n,o=this.addExistingItemAsInstance.bind(this,e,t,i);n=C.type_act_logref,a.launchSearch({searchTitle:h.label_search_logref,allowedTypes:n,role:"",criteria:n,bMultiSel:!0,in_apps_callback:o})},addExistingItemAsInstance:function(t,i,n,o){e.mask(i,h.msg_processing);var a={instances:[]};if(o)for(var l=0;l<o.length;l++)a.instances.push({referencedID:o[l].id?o[l].id:o[l].objectId,attributes:{}});d.createLogItemInstanceNew(a,t.options.physicalid,!0).then((function(a){var l=[];if(o.forEach((function(e){l.push(e["ds6w:label"]+" "+e["ds6wg:revision"])})),a&&a.member){var c=n.getMappedNodesFromId(t.options.physicalid);c||(c=[t]),s.addChildrenToParent(n,c,a.member,!1),e.unmask(i),r.alertMessage("success",null,h.msg_header_add_success,h.msg_add_success+l.toString())}}),(function(t){e.unmask(i),r.displayError(t,null,h.error_header,h.msg_add_item_error)}))},updateSolutionID:function(e,t,i,n){var a=!1,s=!1;let l=o.getSecurityContext();l=l.split(".")[0];let u=[];return n.forEach((function(t){let i=[],n=l+"."+t.options.grid.organization+"."+t.options.grid.project;i.push({refId:t.options.physicalid,solIds:[e]}),u.push(d.updateSolutionIDAttributes(i,n))})),Promise.all(u).then((function(e){e.forEach((function(e){for(var t in e)if(e.hasOwnProperty(t)&&(e[t].ignoredAlreadyExist.length>0&&(a=!0),e[t].success.length>0&&(s=!0),s&&a))break;a&&r.alertMessage("error",null,h.msg_proposed_solution_ignored),s&&(r.alertMessage("success",null,h.msg_proposed_solution_added),c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:n}),c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-solutions-by-id",data:n}))}))})).catch((function(e){r.displayError(e,null,h.error_header,h.error_add_prop_soln)})).finally((function(){t.destroy(),i.destroy()}))}}})),define("DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.actions",["DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/CATFLCockpitWidget/components/AttributesManagement/AttributesManagement","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p){"use strict";var g=s.getFullConfig(),f=g.localStorageKeys;return{openAttributesManagementForProposedSolution:function(e){for(var t=[],i=0;i<e.length;i++)-1===t.indexOf(e[i].options.type)&&t.push(e[i].options.type);new n(!0,t,null)},replaceByLatestSolOrReq:function(t,i,n){e.mask(i.collectionView.getContent(),p.msg_processing);let o=n?"solutions":"requirements",a={},c={},u={},g=[];for(let e=0;e<=t.length-1;e++){let i=t[e],n=i.getID(),o=i.getParent().getParent(),r=o.getID();c[n]=i,a[r]=o,u[r]=Array.isArray(u[r])?u[r]:[],u[r].push(n)}for(let e in u)g.push({logId:e,nodeIds:u[e]});r.ReplaceByLatestSolOrReq({payload:g,type:o}).then((function(t){if(200!==t.status)return;let o,r=[],g=new Set,m={success:[],warning:[],error:[]};t.responseData.forEach((function(e){let t=Object.keys(e)[0],i=e[t],o=a[t],s=o.getLabel(),l=u[t];null==i.errorPnO?(["connect","disconnect"].forEach((function(e){i[e].forEach((function(t){g.add(o);let i=t.originalId?t.originalId:t,a=c[i],d=a.getLabel()+"-"+a.options.grid.revision,u=l.indexOf(i);u>=0&&l.splice(u,1),"connect"===e?r.push({logName:s,logId:o.getID(),oldNodeName:d,oldNodeId:a.getID(),newNodeId:t.reviseId}):m.success.push(p.replace(n?p.msg_latest_prop_succ2:p.msg_latest_req_succ2,{oldNodeName:d,logName:s}))}))})),l.length>0&&l.forEach((function(e){let t=o.getNodesById(e)[0],i=t.getLabel()+"-"+t.options.grid.revision;m.warning.push(p.replace(n?p.msg_latest_prop_warn:p.msg_latest_req_warn,{oldNodeName:i,logName:s}))}))):m.error.push(p.replace(n?p.msg_latest_prop_error:p.msg_latest_req_error,{logName:s}))})),o=g.size>0?d.addDBNavigate([...g],{treeDocument:i.collectionView.treeDocument,navigateTypes:n?["PROPOSED_SOLUTION"]:["IMPLEMENTING_LINK"]}):Promise.resolve(),o.then((function(){e.unmask(i.collectionView.getContent(),p.msg_processing),g.forEach((function(e){s.SAXStorage().setItem(f.recentlyAuthored+e.options.physicalid,Date.now())})),r.forEach((function(e){let t=a[e.logId].getNodesById(e.newNodeId)[0],i=t.getLabel()+"-"+t.options.grid.revision;m.success.unshift(p.replace(n?p.msg_latest_prop_succ1:p.msg_latest_req_succ1,{oldNodeName:e.oldNodeName,logName:e.logName,newNodeName:i}))})),l.createReportStatusPanel(n?p.replace_by_new_soln_report:p.replace_by_latest_req_report,{success:m.success,warning:m.warning,error:m.error})}))})).catch((function(t){e.unmask(i.collectionView.getContent()),l.displayError(t,null,null,p.error_repl_failed)}))},getNodeInfoForEffectivity:function(e,t){var i,n=[];return t.forEach((function(t){i=t.getParent();var o={context:e,physicalid:t.options.instance.physicalid,label:t.options.grid.instanceName||t.options.label,type:t.options.type,parent:{physicalid:i.options.physicalid,label:i.options.label,type:i.options.type},nodeModel:t};n.push(o)})),n},replaceByNewRevision:function(t,i,n){e.mask(i.collectionView.getContent(),p.msg_processing);for(var o=[],a=[],s=[],d=[],u=[],g=n?p.label_replace_new_branch_report:p.label_replace_new_rev_report,f=0;f<t.length;f++){if(!t[f].options.instance||!t[f].options.instance.physicalid)return e.unmask(i.collectionView.getContent()),void l.createReportStatusPanel(g,{error:[p.msg_remove_root]});a.push(t[f].options.physicalid),s.push(t[f].getParent().options.physicalid),o.push({replaceWith:n?"newBranch":"newRevision",instanceID:t[f].options.instance.physicalid}),u.push(t[f].options.instance.physicalid),d.push(t[f])}for(f=0;f<s.length;f++)if(a.includes(s[f]))return e.unmask(i.collectionView.getContent()),void l.createReportStatusPanel(g,{error:[p.msg_Replace_Parent_Child]});r.replaceWithNewRevision(o).then((function(t){let n=t,o=[];(n.member?n.member[0]:null)?c.refreshNodesOnReplace({replaceDetails:n.member,selectedNodes:d,instID:u}).then((function(){e.unmask(i.collectionView.getContent()),d.forEach((function(e){o.push(e.options.label)}));var t=o.map((e=>e+" "+p.msg_replace_success));l.createReportStatusPanel(g,{success:t})})):(e.unmask(i.collectionView.getContent()),l.createReportStatusPanel(g,{error:[n.message]}))})).catch((function(t){e.unmask(i.collectionView.getContent()),l.displayError(t,null,null,p.error_repl_failed)}))},reparentAction:function(e,t,i){let n=this,r=!0;for(let t=0;t<i.instances.length;t++)if(i.instances[t].getParent().options.physicalid!==e[0].options.physicalid){r=!1;break}r?l.alertMessage("warning",p.msg_error_reparent,"",p.msg_warning_reparent_same_parent):i.instances.every((function(e){return!e.options.grid.architectureNumber||""===e.options.grid.architectureNumber}))?n.showGenericConfirmWindow(e,t,i):g.adminStatus.ReparentEnforceSetAN?o.setArchitectureNumber(i.instances,{newParent:e[0],params:t}):n.showGenericConfirmWindow(e,t,i)},showGenericConfirmWindow:function(t,i,n){for(var o=0;o<n.instances.length;o++)if(t[0].options.physicalid===n.instances[o].options.physicalid)return void l.alertMessage("error",null,p.msg_reparent_cyclic_error);var a=n.nameList;let s=UWA.createElement("p",{html:p.msg_reparent_confirm+t[0].options.label+" : <br>"+a});return u.createWindow(p.label_reparent,s,p.label_reparent,(function(){e.mask(i.collectionView.getContent(),p.msg_processing);var o=[];n.instances.forEach((function(e){o.push({parentID:t[0].options.physicalid,instanceID:e.options.instance.physicalid,itemID:e.options.physicalid})})),r.reparentInstances(o).then((function(e){c.refreshNodesOnReparent({resp:e,params:i,newParent:t[0],instArray:n.instances})}),(function(t){e.unmask(i.collectionView.getContent()),l.displayError(t,null,null,p.error_reparent_failed)}))}))},checkInstanceCount:function(e,t){a.expandV2({forSynthesis:{IDs:e[0].options.physicalid,configFilter:t},synthType:"Flat"}).then((function(e){var t=null;e=e.slice(0,-2),(e=JSON.parse(e)).results&&(t=((t=e.results[0].synthesis.value)-1)/2)&&t>1e3&&l.alertMessage("info",null,p.replace(p.msg_expand_largeData_warning))}),(function(){l.alertMessage("error",null,"",p.msg_generic_error_get_failed)}))}}})),define("DS/CATFLCockpitWidget/services/DisplayConnectedDIFStructure.service",["DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/utils/common.util"],(function(e,t,i,n){"use strict";var o=t.getFullConfig(),r={primitives:[{navigate_to_rel:{id:1,rel_type:["VPLMrel_47_PLMConnection_47_V_Owner"]},navigate_to_sr:{id:2,mode:"last",filter:{role:["325"],semantics:["1"]}}}],patterns:{LAYOUT_OR_SHEET:[{id:1},{id:2}]},patternTypeFilters:{LAYOUT_OR_SHEET:{typesToReturn:["DIFLayout","DIFSheet"]}},attributes:["physicalid","logicalid","majorid","ds6w:type","ds6w:description","ds6w:label","ds6wg:revision","current","ds6w:status","ds6w:responsible","ds6w:created","ds6w:modified","ds6w:isLastRevision","ds6w:project","ds6w:organizationresponsible"],fileAttributes:["icon","thumbnail_2d"],flags:["returnMatches"],version:3,label:"$User-$ApplicationName-$Timestamp"};return{GetConnectedDIFs:function(e){for(var t=[],o=0;o<e.length;o++)t.push(e[o].options.physicalid);return r.input_physical_ids=t,i.navigate(r).then((function(e){return e})).catch((function(e){e&&e.errorResp&&n.alertMessage("error",null,e.errorResp.message)}))},GetExpandedDIFStructure:function(t){for(var i={batch:{expands:[]},outputs:{format:"entity_relation_occurrence",select_object:["physicalid","logicalid","majorid","ds6w:type","ds6w:description","ds6w:label","ds6w:identifier","ds6wg:revision","current","ds6w:status","ds6w:responsible","ds6w:created","ds6w:modified","ds6w:isLastRevision","ds6w:project","ds6w:organizationresponsible"],select_relation:["physicalid","ds6w:label","ds6w:type"]}},r=0;r<t.length;r++)i.batch.expands.push({label:"CATFLCockpit-ExecuteExpand",root:{physical_id:t[r]},filter:{all:1},graph:{descending_condition_relation:{uql:'flattenedtaxonomies:"reltypes/DIFSheetInstance" OR flattenedtaxonomies:"reltypes/DIFViewInstance"'}},aggregation_processors:[{truncate:{max_distance_from_prefix:3,prefix_filter:{prefix_path:[{physical_id_path:[t[r]]}]}}}]});var a=o.webservices.progressiveExpand+"?output_format=cvjson";return e.makeServiceCall(a,"POST",JSON.stringify(i),!0,null,{timeout:0}).then((function(e){return e})).catch((function(e){e&&e.errorResp&&n.alertMessage("error",null,e.errorResp.message)}))}}})),define("DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.actions",["UWA/Core","DS/UIKIT/Scroller","DS/Handlebars/Handlebars4","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCueActions.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f){"use strict";var m=JSON.parse(p);return{displayCuesActionsonInstance:function(e,t,i){var n=this;n.container=t.triptych._rightPanelContent,n.cueActionsInfo={},n.userPref=e,n.appContext=t,n.rowData=i,n.refresh(),n.container.getElementsByClassName("EditProp_MasterContain")[0].hide(),n.appContext.triptych.modelEvents.subscribe({event:"triptych-hide-panel"},(function(e){if("right"===e){var t=n.container.getElementsByClassName("EditProp_MasterContain");t&&t[0].isHidden()&&t[0].show()}})),n.appContext.triptych.modelEvents.publish({event:"triptych-show-panel",data:"right"})},getCuesActionlistContent:function(){var n=this,o=n.cuesContainer=e.createElement("div",{class:"ConvergenceCues_ActionsContainer"}),r=i.compile(g),a={};a.header=f.replace(f.header_cues_actions,{title:n.rowData.instParentTitle}),a.cueRows=n.getCuesRowListContent(n.cuesActionList),o.addContent(r(a));var s=o.getElement(".actionlist-container").remove(),l=o.getElement(".container-scroll");return new t({element:s}).inject(l),n.manageEvents(),n.subscribeToEvents(),o},getCuesRowListContent:function(t){var i=this,o=[];if(t){var r;i.cueMsgList={};var a,s=n.getWebappsAssetUrl("CATFLCockpitWidget","icons")+"/I_RFLPLMImplementConnection.png",l=widget.getValue("currentConfig"),c=!1;l&&l.modelVersion&&(l.modelVersion.current===m.state_act_Release||l.modelVersion.current===m.state_act_Obsolete)?c=!0:i.rowData.nodeModel.options.grid.maturity!==m.state_act_Released&&i.rowData.nodeModel.options.grid.maturity!==m.state_act_Obsolete||(c=!0),t.forEach((function(t){i.cueActionsInfo[t.id]=t;var n=t.msg,l={};n.indexOf("\n")>=0&&n.split("\n").forEach((function(e,t){0===t?n=e:n+=" <br> "+e}));if(t.itemsInfo){var d=[];t.itemsInfo.forEach((function(t,i){if(d.indexOf(t.itemPhysicalId)<0){d.push(t.itemPhysicalId),l[i]=t,t.displayText=t.itemTitle+" "+t.itemRevision;var o=e.createElement("div",{id:i,draggable:!0,class:"drag-text",html:' <span class="wux-ui-3ds wux-ui-3ds-lg wux-ui-3ds-drag-grip"></span> '+t.displayText+" "});let a=new RegExp(`(?:^|\\W)${t.displayText}(?:$|\\W)`,"g");var r=n.split(a);r.length>=0&&r.forEach((function(e,t){0===t?n=r[t]:n+=" "+o.outerHTML+" "+r[t]}))}}))}n=n.replace(" <br> ","<br>"),i.cueActionsInfo[t.id].cueLinks=l,a=t.icon&&t.icon.indexOf("https")>=0?t.icon:s,r={cueId:t.id,cueSeverity:t.severity.toUpperCase(),cueImg:a,cueTitle:t.title,cueSubtitle:n},m.cues_with_actions.indexOf(t.id)>=0&&!c&&(r.isLink="link"),o.push(r)}))}return o},manageEvents:function(){var e=this;e.cuesContainer.getElements(".drag-text").forEach((function(t){t.addEventListener("dragstart",(function(t){var i=t.target.getParent().getParent().getParent().id,n=e.cueActionsInfo[i].cueLinks[t.target.id],r={protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("appId"),widgetId:widget.id,data:{items:[{envId:o.getTenant(),serviceId:"3DSpace",contextId:"ctx::"+o.getSecurityContext(),objectId:n.itemPhysicalId,objectType:n.itemType,displayName:n.displayText}]}};t.dataTransfer.setData("Text",JSON.stringify(r))}))})),e.cuesContainer.getElements(".link").forEach((function(t){t.addEventListener("click",(function(t){var i=t.target.getParent().getParent().id;e.manageActionLinks(i,e.rowData)}))}))},subscribeToEvents:function(){s.getFLWebModelEventsObj("flweb-model-events");s.getFLWebModelEventsObj("flcockpit-content-list-view").subscribe({event:"refresh-cues-report"},this.refresh.bind(this))},manageActionLinks:function(e,t){"ENOXSolutionsCueNoSolution"===e?d.openModalSolutionSelection([t.nodeModel]):"ENOXSpaceAssignmentsCueNoAssignment"!==e&&"ENOXSpaceAssignmentsCueMultipleAssignments"!==e||("ENOXSpaceAssignmentsCueMultipleAssignments"!==e||t.nodeModel.options.assignedSpacesPID?new u(t.nodeModel):a.addAssignedSpacesAttribute([t.nodeModel]).then((()=>{new u(t.nodeModel)})))},refresh:function(){var e=this.container.getElementsByClassName("ConvergenceCues_ActionsContainer");e&&e[0]&&e[0].destroy(),this.getCuesReport()},getCuesReport:function(){var e=this,t=e.userPref.cues_state,i=Object.values(t),n=e.userPref.combined_state,o=e.rowData.nodeModel,r=!1;o.options.cueDetails&&"group"===o.options.cueDetails.cue&&(r=!0);var a=c.confAllImplPathsOnNodes([o],!1,!1);l.getCuesReportOnInstance(i,e.rowData.instanceID,a.payload).then((function(i){if(i){var o=i[e.rowData.instanceID],a=i.cueNLSInfo,s={};if(e.cuesActionList=[],o&&(o.forEach((function(i){s=t[i.cueId];var n=i.cueMessageInfo;e.cuesActionList.push({id:i.cueId,title:i.cueLabel,icon:i.cueIcon,msg:n?n.Message:i.cueMessage,severity:s?s.cueSeverity:"",itemsInfo:n?n.RelatedObjects:null})})),r&&n&&n.active)){var l="<b>"+f.label_operator+": "+f["label_operator_"+n.operator]+"</b>\n";for(var c in n.combinedCues)if(n.combinedCues.hasOwnProperty(c)){var d=n.combinedCues[c];l+=a[c]+" = "+f["val_"+d]+"\n"}var u={id:"combined_conv_state",title:f.header_combined_convg_cues,msg:l,severity:"COMBINED",itemsInfo:null};e.cuesActionList.splice(0,0,u)}var p=e.getCuesActionlistContent(),g=e.container.getElementsByClassName("ConvergenceCues_ActionsContainer");g&&g[0]&&g[0].destroy(),p.inject(e.container)}}))}}})),define("DS/CATFLCockpitWidget/components/ContentListView/decorators/contentlistview.dragdrop",["DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.actions","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/gridview.dnd.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/implementlink.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c){"use strict";var d=o.getFullConfig();return{addDragAndDropBehaviorToContentView:function(){var o=this;o.contentView.onDragStartCell=function(e){return e.dataTransfer.setData("Text",JSON.stringify(i.create3DXJsonFromDGVSelection(o.contentView.treeDocument.getSelectedNodes()))),!0},o.contentView.onDragStartRowHeader=function(e,t){return e.dataTransfer.setData("Text",JSON.stringify(i.create3DXJsonFromDGVSelection([t.nodeModel]))),!0},n.makeGridViewDroppable({contentView:o.contentView,acceptDrop:function(e,t){if(t.nodeModel&&widget.getValue("component-view")===d.localStorageKeys.structuredView){var i=null;if("middle"===t.dropPosition)i=t.nodeModel;else if("top"===t.dropPosition||"bottom"===t.dropPosition){if(t.nodeModel.isRoot())return!1;i=t.nodeModel.getParent()}if(!i||i&&(i.options.type.includes("Category")||!0===i.options.virtual||i.options.linkInfo))return!1;if(t.draggedNodes){for(var n=0;n<t.draggedNodes.length;n++)if(t.draggedNodes[n].isAscendantOf(i))return!1;return!0}return!0}return!1},onDropCallback:function(n,d){var u=null;"middle"===d.dropPosition?u=d.nodeModel:"top"!==d.dropPosition&&"bottom"!==d.dropPosition||(u=d.nodeModel.getParent());var p=n.dataTransfer?JSON.parse(n.dataTransfer.getData("Text")):null,g=d.droppedNodes;if(u&&g&&g.length>0){var f,m="";if(g.map((e=>e.isRoot()?void 0:e.getParent().getID())).every((e=>e===u.getID())))return void i.alertMessage("warning",c.msg_error_reparent,"",c.msg_warning_reparent_same_parent);for(var h=0;h<g.length;h++){if(g[h].isRoot())return void i.alertMessage("error",c.msg_error_reparent,"",c.msg_remove_root);if(!g[h].options.instance||!g[h].options.instance.physicalid)return void(g[h].options.linkInfo?i.alertMessage("error",c.msg_error_reparent,"",c.msg_error_reparent_impl_link):i.alertMessage("error",c.msg_error_reparent,"",c.msg_error_reparent_logical_instances));m=m+g[h].options.label+"<br>"}f={instances:g,nameList:m};var v={openFromToolbar:!1,collectionView:o.contentView};f&&e.reparentAction([u],v,f)}else if(u&&p){var C=p.data.items;C&&C.length&&s.getKindOfRFLP(C.map((e=>e.objectId))).then((function(e){if(n.altKey)if(C.length===e.length&&e.every((e=>"R"===e||"F"===e||"L"===e||"P"===e))){var s=[];C.forEach(((t,i)=>{var n={};"P"===e[i]?(n.implementing=t.objectId,n.implemented=u.options.physicalid):(n.implementing=u.options.physicalid,n.implemented=t.objectId),s.push(n)})),l.createScopeLinks(s).then((function(){r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-refLinks-by-id",data:[u]}),i.alertMessage("success","",c.msg_ref2ref_create_success)})).catch((function(e){i.displayError(e,null,null,c.error_create_refref_link)}))}else i.alertMessage("error",c.msg_invalid_type,c.msg_drop_invalid_type_RFLP);else if(C.length===e.length&&e.every((e=>"L"===e))){var d=[];let e="";C.forEach(((t,i)=>{d.push({id:t.objectId,"ds6w:label":t.displayName,"ds6wg:revision":""}),e=e+t.displayName+"<br>"}));let i=UWA.createElement("p",{html:c.msg_insert_intance_confirm+u.options.label+" : <br>"+e});a.createWindow(c.action_insert_instance,i,c.action_insert,(function(){t.addExistingItemAsInstance(u,o.contentViewContainer,o.contentView.treeDocument,d)}))}else i.alertMessage("error",c.msg_invalid_type,c.msg_drop_invalid_type_Logical)})).catch((function(){n.altKey?i.alertMessage("error",null,c.msg_error_drop_add_alt):i.alertMessage("error",null,c.msg_error_drop_add)}))}},getTextInvite:function(e,t,i){return i?t.draggedNodes?{text:c.msg_drop_to_reparent,icon:"plus"}:e.altKey?{text:c.msg_drop_to_create_link,icon:"plus"}:{text:c.msg_drop_to_add,icon:"plus"}:widget.getValue("component-view")!==d.localStorageKeys.structuredView?{text:c.error_action_unavailable_in_flattened_view,icon:"block"}:void 0}})}}})),define("DS/CATFLCockpitWidget/utils/DisplayConnectedDIFStructure.util",["DS/CATFLCockpitWidget/services/DisplayConnectedDIFStructure.service","DS/CATFLCockpitWidget/parser/index.parser","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.columns","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s){"use strict";var l=new Map,c={},d=n.getFullConfig(),u={DisplayConnectedDIFStructure:function(t){return r.getPredicateValues({"ds6w:type":["DIFView","DIFLayout","DIFSheet"]}).then((function(e){return c=e["ds6w:type"]})),e.GetConnectedDIFs(t).then((function(i){for(var n=[],r=0,a=0;a<t.length;a++)if(void 0!==i[t[a].options.physicalid]&&void 0!==i[t[a].options.physicalid].LAYOUT_OR_SHEET){for(var c=[],d=0;d<i[t[a].options.physicalid].LAYOUT_OR_SHEET.length;d++)n.push(i[t[a].options.physicalid].LAYOUT_OR_SHEET[d].physicalid),c.push(i[t[a].options.physicalid].LAYOUT_OR_SHEET[d].physicalid);l.set(t[a].options.physicalid,c)}else++r;if(0!==n.length)return e.GetExpandedDIFStructure(n).then((function(e){var i;i="string"==typeof e?JSON.parse(e):e;var{PathsIDWithLRef:n,mapDIFIdsAttr:a}=u._ExpandV2Parser(l,i);u._UpdateDIFOnNode(t,n,a),1===t.length?o.alertMessage("info",null,s.msg_diagrams_loaded_success_single):o.alertMessage("info",null,s.msg_diagrams_loading_success_multiple),r>0&&(1===r?o.alertMessage("warning",null,s.warn_DisplayConDIF_no_connected_diagram_single):o.alertMessage("warning",null,s.replace(s.warn_DisplayConDIF_no_connected_diagram_multiple,{count:r})))})).catch((function(e){e&&e.errorResp&&o.alertMessage("error",null,e.errorResp.message)}));1===t.length?o.alertMessage("warning",null,s.warn_DisplayConDIF_emptyConDIF_single):o.alertMessage("warning",null,s.warn_DisplayConDIF_emptyConDIF_multiple)})).catch((function(e){e&&e.errorResp&&o.alertMessage("error",null,e.errorResp.message)}))},_ExpandV2Parser:function(e,t){for(var i=[],n={},o=0;o<t.results.length;o++)void 0!==t.results[o].Path&&i.push(t.results[o].Path);for(let t=0;t<i.length;t++)for(const[n,o]of e)for(var r=Array.isArray(o)?o:[o],a=0;a<r.length;a++)i[t].includes(r[a])&&i[t].unshift(n);for(let e=0;e<t.results.length;e++)void 0!==t.results[e].resourceid&&(n[t.results[e].resourceid]=u._createDGVAttrToPredicatsAttrMap(t.results[e]));return{PathsIDWithLRef:i,mapDIFIdsAttr:n}},_UpdateDIFOnNode:function(e,t,n){for(var o=0;o<e.length;o++){var r=e[o].options.instance?e[o].options.instance.physicalid:"",a=e[o].getNodesByRelId("connectedDIF"+r)[0];if(a)a.empty(),u._computeConnectedDIFSTructureUnderDIFCategoryNode(e[o],t,a,n);else{for(var l=0;l<t.length;l++)if(t[l][0]===e[o].options.physicalid){(a=new i({label:s.label_diagrams,icons:[{iconName:"fl-diagrams"}],type:"DiagramsCategory",editableFlag:!1})).setRelationID("connectedDIF"+r),e[o].addChild(a),e[o].updateOptions(),a.updateOptions();break}u._computeConnectedDIFSTructureUnderDIFCategoryNode(e[o],t,a,n)}}},_createDGVAttrToPredicatsAttrMap:function(e){var t,i,r,a={},s={iconSize:{height:"16px",width:"16px"}};"DIFLayout"===e["ds6w:type"]?s.iconPath=n.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_VPMNavDifLayout.png":"DIFSheet"===e["ds6w:type"]?s.iconPath=n.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_VPMNavDifSheet.png":"DIFView"===e["ds6w:type"]&&(s.iconPath=n.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_VPMNavDifView.png"),a.physicalid=e.resourceid,a.label=e["ds6w:label"],a.icons=[s],a.type=e["ds6w:type"],a.description=e["ds6w:description"],a.virtual=!0,t=e["ds6w:created"]?o.formatDate(e["ds6w:created"]):"",i=e["ds6w:modified"]?o.formatDate(e["ds6w:modified"]):"",r=e.current?d.MAPPING_MATURITY[e.current]:"";var l={creationDate:t,description:e["ds6w:description"],isLastVersion:e["ds6w:isLastRevision"],maturity:r,revision:e["ds6wg:revision"],physicalid:e.resourceid,modificationDate:i,owner:e["ds6w:responsible"],type:c[e["ds6w:type"]],name:e["ds6w:identifier"],kindOfRFLP:"DIF",actualType:e["ds6w:type"],"ds6w:project":e["ds6w:project"],"ds6w:organizationResponsible":e["ds6w:organizationresponsible"]};return a.grid=l,a},_computeConnectedDIFSTructureUnderDIFCategoryNode:function(e,t,n,o){for(var r=[],a=0;a<t.length;a++)if(t[a][0]===e.options.physicalid){a>0?t[a-1][1]!==t[a][1]&&(r=[],u._attachRootDIFNodeToconnectedDIFCategory(r,o[t[a][1]],n)):u._attachRootDIFNodeToconnectedDIFCategory(r,o[t[a][1]],n);for(var s=r.length,l=3;l<t[a].length;l+=2)if(a>0){if(t[a][l]!==t[a-1][l]){let e=new i(o[t[a][l]]);r.push(e),3===l?r[0].addChild(r[s]):u._attachnode(r,r[s]),r[s].updateOptions(),s++}}else{let e=new i(o[t[a][l]]);r.push(e),3===l?r[0].addChild(r[s]):r[s-1].addChild(r[s]),r[s].updateOptions(),s++}}},_attachRootDIFNodeToconnectedDIFCategory:function(e,t,n){var o=new i(t);e.push(o),n.addChild(e[0]),e[0].updateOptions()},_attachnode:function(e,t){for(var i=e.length-1;i>=0;i--)if("DIFSheet"===e[i].options.type){e[i].addChild(t);break}}};return u})),define("DS/CATFLCockpitWidget/components/BulkEdition/BulkEditionDialog",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/DataGridView/DataGridView","DS/Windows/Dialog","DS/Controls/Button","DS/UIKIT/Mask","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/predicate.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g){"use strict";var f=c.getFullConfig();return{open:function(i,a,s){var u=this;u.item=i,u.collectionView=a,u.treeDocument=a.treeDocument,u.ctx=s,u.availableAttributes=new e({useAsyncPreExpand:!0}),u.availableAttributes.addChild([new t({ds6w:"ds6w:label",dataIndex:"title",selectable:"PLMEntity.V_Name",bo:!0,grid:{iconType:"object-reference",name:c.getNlsBasicAttributesBO("ds6w:label"),declaredIn:g.label_all_levels}}),new t({ds6w:"ds6w:description",dataIndex:"description",selectable:"PLMEntity.V_description",bo:!0,grid:{iconType:"object-reference",name:c.getNlsBasicAttributesBO("ds6w:description"),declaredIn:g.label_all_levels}})]),i.options.instance&&(u.availableAttributes.addChild(new t({ds6w:"ds6w:label",dataIndex:"instanceName",selectable:"PLMInstance.PLM_ExternalID",bo:!1,grid:{iconType:"object-instance",name:c.getNlsBasicAttributesBO("ds6w:label"),declaredIn:g.label_all_levels}}),1),u.availableAttributes.addChild(new t({ds6w:"ds6w:description",dataIndex:"description",selectable:"PLMInstance.V_description",bo:!1,grid:{iconType:"object-instance",name:c.getNlsBasicAttributesBO("ds6w:description"),declaredIn:g.label_all_levels}})));var p=d.getUserCustomAttributes();if(p){var f={};l.getNLSPredicates(p).then((function(e){f=e||{}})).finally((function(){p.forEach((function(e){!e.bo&&!i.options.instance||e.readOnly||(!e.declaredInArray||e.isOnExtension||e.isClassification||e.bo&&e.declaredInArray.includes(u.item.options.grid.actualType)||!e.bo&&e.declaredInArray.includes(u.item.options.grid.instance_actualType))&&u.availableAttributes.addChild(new t({ds6w:e.curi,selectable:e.selectable,bo:e.bo,dimension:e.dimension,manipulationUnit:e.manipulationUnit,rangeValues:e.rangeValues,grid:{iconType:e.bo?"object-reference":"object-instance",name:f[e.curi]||e.nls||e.curi,declaredIn:e.declaredIn},declaredInArray:e.declaredInArray,isOnExtension:e.isOnExtension,isClassification:e.isClassification,type:e.type}))}))}))}u.dialogDGV=new o({title:g.attributes_browser+" - "+g.label_select_attributes,height:500,width:700,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new r({label:g.action_copy,emphasize:"primary",disabled:!0,onClick:function(){u.ctx.dataCopied="attributes-copied",u.selectedAttributes=u.dgv.treeDocument.getSelectedNodes(),u.treeDocument.getSelectedNodes()[0].unselect(),u.tokenPostAdd=u.treeDocument.getXSO().onPostAdd(u._onXSOChanged.bind(u,u.item,u.treeDocument)),u.tokenPostRemove=u.treeDocument.getXSO().onPostRemove(u._onXSOChanged.bind(u,u.item,u.treeDocument)),d.alertMessage("success",null,g.msg_copy_attributes_success),u.dialogDGV.close()}}),Close:new r({emphasize:"secondary",onClick:function(){u.dialogDGV.close()}})}}),u.dgv=new n({identifier:"LogicalProductDefinition_CopyAttributes_AttributesSelector",height:"inherit",treeDocument:u.availableAttributes,selectionBehavior:{unselectAllOnEmptyArea:!1},columns:[{typeRepresentation:"icon",dataIndex:"iconType",width:40},{text:g.label_name,dataIndex:"name"},{text:g.label_declared_in,dataIndex:"declaredIn"}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!0,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t},getCellTooltip:function(e){return e.nodeModel&&0===e.columnID?{shortHelp:e.nodeModel.options.bo?g.label_declared_in_reference:g.label_declared_in_instance,updateModel:!1}:u.dgv.getCellDefaultTooltip(e)}}),u.dialogDGV.elements._contentDiv.appendChild(u.dgv.getContent()),u.dgv.treeDocument.setFilterModel({name:{filterId:"stringRegexp"},declaredIn:{filterId:"stringRegexp"}}),u.tokenPostAdd=u.dgv.treeDocument.getXSO().onPostAdd((function(){u.dialogDGV.buttons.Ok.disabled=!1})),u.tokenPostRemove=u.dgv.treeDocument.getXSO().onPostRemove((function(){0===u.dgv.treeDocument.getSelectedNodes().length&&(u.dialogDGV.buttons.Ok.disabled=!0)})),u.dialogDGV.addEventListener("close",(function(){u.dialogDGV.destroy()}))},_postSelectionCall:function(){var e=this;e.treeDocument.getSelectedNodes()[0].unselect(),e.tokenPostAdd=e.treeDocument.getXSO().onPostAdd(e._onXSOChanged.bind(e,e.item,e.treeDocument)),e.tokenPostRemove=e.treeDocument.getXSO().onPostRemove(e._onXSOChanged.bind(e,e.item,e.treeDocument))},submit:function(){var e=this;if(void 0!==e.selectedNodes&&0!==e.selectedNodes.length){a.mask(widget.body,g.msg_processing);var t,n=[],o=!1,r=!1,l={};e.selectedNodes.forEach((function(i){var a={},s={},c={objectLabel:i.options.label,instance_pid:i.options.instance?i.options.instance.physicalid:null,icons:[i.options.icons[0]],refAttributes:[],instAttributes:[]};l[i.options.physicalid]=c;for(var u=0;u<e.selectedAttributes.length;u++){var p=e.selectedAttributes[u].options.dataIndex||e.selectedAttributes[u].options.ds6w,g=!1,f=e.selectedAttributes[u].options.isOnExtension,m=e.selectedAttributes[u].options.isClassification;(!e.selectedAttributes[u].options.declaredInArray||f||m||e.selectedAttributes[u].options.bo&&e.selectedAttributes[u].options.declaredInArray.includes(i.options.grid.actualType)||!e.selectedAttributes[u].options.bo&&e.selectedAttributes[u].options.declaredInArray.includes(i.options.grid.instance_actualType))&&(g=!0),e.selectedAttributes[u].options.bo?c.refAttributes.push({name:e.selectedAttributes[u].options.grid.name,iconType:e.selectedAttributes[u].options.grid.iconType,copySuccessful:!1,isDeclaredIn:g,isOnExtension:f,isClassification:m,responsibleForError:void 0,bo:!0}):c.instAttributes.push({name:e.selectedAttributes[u].options.grid.name,iconType:e.selectedAttributes[u].options.grid.iconType,copySuccessful:!1,isDeclaredIn:g,isOnExtension:f,responsibleForError:void 0});var h=e.selectedAttributes[u].options.selectable;if(void 0===h.length){var v=null;(v=!e.selectedAttributes[u].options.bo&&i.options.instance?i.options.grid.instance_actualType:i.options.grid.actualType)&&(h=e.selectedAttributes[u].options.selectable[v])}if("title"===p)a[h]=e.item.options.label;else if("instanceName"===p)s[h]=e.item.options.grid.instanceName;else{let i=e.selectedAttributes[u].options.bo?p:"instance_"+p,n=Array.isArray(e.item.options.grid[i]),o={};if(e.selectedAttributes[u].options.manipulationUnit)o={unitName:e.selectedAttributes[u].options.manipulationUnit,dimensionType:e.selectedAttributes[u].options.dimension,value:e.item.options.grid[i]};else if("date"===e.selectedAttributes[u].options.type)if(void 0!==e.selectedAttributes[u].options.rangeValues)if(n){for(var C=[],y=0;y<e.item.options.grid[i].length;y++){let t=e.selectedAttributes[u].options.rangeValues.find((function(t){if(t.formatDateValue)return d.isDateEqual(t.value,e.item.options.grid[i][y])}));void 0!==t?C.push(t.value):C.push(e.item.options.grid[i][y])}o=C}else{let t=e.selectedAttributes[u].options.rangeValues.find((function(t){if(t.formatDateValue)return d.isDateEqual(t.value,e.item.options.grid[i])}));o=void 0!==t?t.value:e.item.options.grid[i]}else n?(t=[],t=e.item.options.grid[i].map((function(e){let t=d.formatDate(e);return t=t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+"@12:00:00:GMT",t}))):(t="",e.item.options.grid[i]&&(t=(t=d.formatDate(e.item.options.grid[i])).getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+"@12:00:00:GMT")),o=t;else o=e.item.options[i]?e.item.options[i]:e.item.options.grid[i];e.selectedAttributes[u].options.bo?a[h]=o:s[h]=o}}Object.keys(a).length>0&&(n.push({refID:i.options.physicalid,attributes:a}),o=!0),Object.keys(s).length>0&&i.options.instance&&(n.push({instID:i.options.instance.physicalid,attributes:s}),r=!0)})),s.updateAttribute(n).then((function(t){let n={};for(var a=0;a<t.length;a++)t[a].body.oldInstancePhysicalid?n[t[a].body.oldInstancePhysicalid]=t[a].body:n[t[a].body.physicalid]=t[a].body;for(var s={grid:{}},p={grid:{}},g=0;g<e.selectedAttributes.length;g++){var m=e.selectedAttributes[g].options.dataIndex||e.selectedAttributes[g].options.ds6w;"title"===m?s.label=e.item.options.label:e.selectedAttributes[g].options.bo?(e.selectedAttributes[g].options.manipulationUnit&&(s.grid[m+"_actual"]=e.item.options.grid[m+"_actual"]),e.item.options[m]&&(s[m]=e.item.options[m]),s.grid[m]=e.item.options.grid[m]):"instanceName"===m?p.grid[m]=e.item.options.grid[m]:(e.selectedAttributes[g].options.manipulationUnit&&(p.grid["instance_"+m+"_actual"]=e.item.options.grid["instance_"+m+"_actual"]),e.item.options["instance_"+m]&&(s["instance_"+m]=e.item.options["instance_"+m]),p.grid["instance_"+m]=e.item.options.grid["instance_"+m])}let h={},v=[],C=[],y=[];for(var b=0;b<e.selectedNodes.length;b++){var _,w,D,S,I=e.selectedNodes[b],A=!1,F=!1;let t=[],a=[];if(o){_=n[I.options.physicalid],D=_&&_.modified?d.formatDate(_.modified.value[0]):null;var k=new Date(I.options.grid.modificationDate);A=!(!D||!k)&&D.getTime()!==k.getTime()}if(r&&I.options.instance){w=n[I.options.instance.physicalid],S=w&&w.modified?d.formatDate(w.modified.value[0]):null;var E=I.options.instance?new Date(I.options.instance.modificationDate):null;F=!(!S||!E)&&S.getTime()!==E.getTime()}if(o&&A&&c.SAXStorage().setItem(f.localStorageKeys.recentlyAuthored+I.options.physicalid,Date.now()),r&&F&&c.SAXStorage().setItem(f.localStorageKeys.recentlyAuthoredStructure+I.getParent().options.physicalid,Date.now()),(e.treeDocument.getMappedNodesFromId(I.options.physicalid)||[I]).forEach((function(e){if(A&&(s.grid.modificationDate=D,e.updateOptions(JSON.parse(JSON.stringify(s))),l[I.options.physicalid].refAttributes.forEach((function(e){e.copySuccessful=!0}))),e.options.instance&&F)if(w&&w.oldInstancePhysicalid){let n=e.getParent(),o=new i({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,physicalid:e.options.physicalid,instance:{physicalid:w.physicalid},grid:{physicalid:e.options.physicalid},actualParent:e.options.actualParent,children:[]});o.setRelationID(w.physicalid),n.addChild(o,e._rowID),t.push(o),a.push(e),l[I.options.physicalid].instAttributes.forEach((function(e){e.copySuccessful=!0}))}else e.options.instance.physicalid===I.options.instance.physicalid&&(p.instance={modificationDate:S},e.updateOptions(JSON.parse(JSON.stringify(p))),l[I.options.physicalid].instAttributes.forEach((function(e){e.copySuccessful=!0})));function n(e,t){var i=!1;for(const[n,o]of Object.entries(t))if("grid"===n){for(const[t,n]of Object.entries(o))if(e.grid[t]!==n){i=!0;break}}else if("instance"!==n&&e[n]!==o){i=!0;break}return!i}o&&!A&&n(e.options,s)&&l[I.options.physicalid].refAttributes.forEach((function(e){e.equalValues=!0})),r&&e.options.instance&&!F&&n(e.options,p)&&l[I.options.physicalid].instAttributes.forEach((function(e){e.equalValues=!0}))})),t.length>0&&a.length>0){let e=n[I.options.instance.physicalid];h[e.oldInstancePhysicalid]=a,h[e.physicalid]=t,v.push(a[0].options.physicalid),y.push(I),C.push(I.getNextNode())}}if(C.length>0&&C.forEach((e=>{e.select()})),y.length>0&&y.forEach((e=>{e.unselect()})),Object.keys(h).length>0){let e=u.getFLWebModelEventsObj("flcockpit-content-list-view");e.publish({event:"refresh-nodes-by-id",data:{arrayOfPID:v,tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:!0}}),e.publish({event:"refresh-inst-by-id",data:{instIdMap:h,bInstance:!0,bEffectivity:!0}})}let x=e.collectionView.getGroupingOptions();x&&e.collectionView.groupRows(x),e._createSummaryPastDialog(l)})).catch((function(t){if(t&&t.error&&t.error.errorList){var i={};for(var n in t.error.errorList.forEach((e=>{i[e.physicalid]=e.errors||[]})),l){var o=l[n].refAttributes.concat(l[n].instAttributes);for(var r in o)void 0!==i[n]?(o[r].responsibleForError=!0,o[r].errorMsg=i[n].map((e=>e.message)).join(". ")):void 0!==i[l[n].instance_pid]?(o[r].responsibleForError=!0,o[r].errorMsg=i[l[n].instance_pid].map((e=>e.message)).join(" ")):o[r].responsibleForError=!1}e._createSummaryPastDialog(l)}else{var a=t&&t.errorResp&&t.errorResp.error?t.errorResp.error:"";d.displayError(t,g.error_copy_attributes_failed,null,a)}})).finally((function(){a.unmask(widget.body),setTimeout((function(){e._cleanAndDestroy()}),500)}))}else e._cleanAndDestroy()},_onXSOChanged:function(e,t){this.selectedNodes=t.getSelectedNodes().filter((function(t){return t.options.physicalid!==e.options.physicalid}))},_cleanAndDestroy:function(){var e=this;e.treeDocument.getXSO().unsubscribe(e.tokenPostAdd),e.treeDocument.getXSO().unsubscribe(e.tokenPostRemove),e.dialogDGV&&(e.dialogDGV.destroy(),e.dialogDGV=null)},_createSummaryPastDialog:function(i){var a=this;for(var s in a.treedocumentSummaryPaste=new e({useAsyncPreExpand:!0}),i){var l=i[s],c=new t({label:l.objectLabel,icons:l.icons});a.treedocumentSummaryPaste.addChild(c);var d=l.refAttributes.concat(l.instAttributes);for(var u in d){var p=d[u],f="";p.copySuccessful||(f=!0===p.responsibleForError?p.errorMsg?p.errorMsg:p.isDeclaredIn?p.isOnExtension?g.msg_copy_attribute_on_extension_failed:p.isClassification?g.msg_copy_attribute_classif_failed:g.msg_copy_attribute_failed_not_allowed:g.msg_copy_attribute_on_type_failed:!1===p.responsibleForError?g.msg_copy_all_attributes_failed:p.isDeclaredIn?p.equalValues?g.msg_copy_attribute_equal_values_failed:p.isOnExtension?g.msg_copy_attribute_on_extension_failed:p.isClassification?g.msg_copy_attribute_classif_failed:g.msg_copy_attribute_failed:g.msg_copy_attribute_on_type_failed),c.addChild(new t({label:p.name,icons:[p.iconType],grid:{copySuccessful:p.copySuccessful,message:f},bo:p.bo}))}}a.treedocumentSummaryPaste.expandAll();var m=new n({identifier:"LogicalProductDefinition_SummaryPasteAttributes",height:"inherit",treeDocument:a.treedocumentSummaryPaste,rowSelection:"none",columns:[{dataIndex:"tree",text:g.label_title,width:"30%"},{typeRepresentation:"boolean",text:g.label_copy_successful,dataIndex:"copySuccessful",width:95,getCellClassName:function(e){return e&&e.nodeModel?!0===e.nodeModel.options.grid.copySuccessful?"sax-is-copySuccessful-true":"sax-is-copySuccessful-false":null}},{text:g.label_information,dataIndex:"message"}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!1,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t}});a.dialogSummaryPaste=new o({title:g.title_summary_paste_attributes,height:500,width:1e3,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Apply:new r({label:g.action_export,emphasize:"secondary",onClick:function(){a._exportSummaryPastDialog(a.treedocumentSummaryPaste)}}),Close:new r({emphasize:"primary",onClick:function(){a.dialogSummaryPaste.close()}})}}),a.dialogSummaryPaste.addEventListener("close",(function(){a.dialogSummaryPaste.destroy()})),a.dialogSummaryPaste.elements._contentDiv.appendChild(m.getContent()),m.treeDocument.setFilterModel({label:{filterId:"stringRegexp"},copySuccessful:{filterId:"set",filterModel:[]},message:{filterId:"stringRegexp"}})},_exportSummaryPastDialog:function(i){var o=[{dataIndex:"objectName",text:g.label_title},{dataIndex:"attributeName",text:g.label_attribute_name},{typeRepresentation:"boolean",text:g.label_copy_successful,dataIndex:"copySuccessful"},{text:g.label_information,dataIndex:"message"}],r=new n({treeDocument:new e({useAsyncPreExpand:!0}),columns:o,defaultColumnDef:{width:"auto"}});r.treeDocument.empty(),r.treeDocument.prepareUpdate(),i&&i.getChildren()&&i.getChildren().forEach((e=>{var i=new t({label:"",grid:{objectName:e.options.label}});r.treeDocument.addChild(i),e.getChildren().forEach((e=>{var i=new t({grid:{attributeName:e.options.label+(e.options.bo?"":" "+g.label_instance),copySuccessful:e.options.grid.copySuccessful,message:e.options.grid.message}});r.treeDocument.addChild(i)}))})),r.treeDocument.expandAll(),r.treeDocument.pushUpdate();var a=r.getAsCSV(),s=g.action_export+"_"+g.title_summary_paste_attributes+".csv",l=new Date,u=c.getUser("isFullName");a=g.title_summary_paste_attributes+"\nFile Name,"+s+"\nExport Date Time,"+l+"\nExported By,"+u+"\n\n\n"+a,d.downloadFile(s,a,!0),d.alertMessage("success",null,g.msg_summary_paste_attributes_export_success)}}})),define("DS/CATFLCockpitWidget/components/ExportCSV/ExportGridView",["DS/DataGridView/DataGridView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CATFLCockpitWidget/components/ExportCSV/ExportGridView.effectivity","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a){"use strict";var s=o.getFullConfig().localStorageKeys;return{exportgridViewCSV:function(i){var o=[{text:a.label_export_row_order,dataIndex:"order",typeRepresentation:"number"},{text:a.label_export_level,dataIndex:"level"}];let l={},c=r.getUserCustomAttributes()||[],d=r.getUserCustomAttributes(!0)||[],u=c.concat(d);u&&u.forEach((function(e){e.isOnPhysicalProduct?l["physical_"+e.curi]=e:e.bo?l[e.curi]=e:l["instance_"+e.curi]=e}));var p=i.layout.getVisibleOrderedLeafColumns(),g=["cue","assignedSpaces","RevisionMaster","RevisionMode"];p.forEach((e=>{if(!g.includes(e.dataIndex)){let i=l[e.dataIndex];var t=e.text;i?i.bo||(t="("+a.label_export_instance+") "+t):"instance_description"!==e.dataIndex&&"instanceName"!==e.dataIndex&&"instance_isReserved"!==e.dataIndex&&"instance_reservedBy"!==e.dataIndex||(t="("+a.label_export_instance+") "+t),o.push({text:t,dataIndex:e.dataIndex,getCellValueForExport:function(t){if(t.nodeModel){var n=t.cellModel;if(void 0!==n){if("modificationDate"===e.dataIndex||"creationDate"===e.dataIndex)return r.displayDate(n,{timePrecision:"sec"});if(Array.isArray(n))return i&&"date"===i.type&&(n=n.map((e=>{if(e)return r.displayDate(e)}))),n.join(",");if(i&&"date"===i.type){if(n)return r.displayDate(n)}else if("customBoolean"===e.typeRepresentation||"boolean"===e.typeRepresentation)return n.toString()}}return t.cellModel}})}}));var f=new e({treeDocument:new t({useAsyncPreExpand:!0}),columns:o}),m=this._processTreeDocumentForExport(f,i);let h=!1,v=!1,C=["Effectivity","VariantEffectivity","CurrentEvolutionEffectivity","ProjectedEvolutionEffectivity"];if(f.columns.forEach((e=>{!h&&C.includes(e.dataIndex)&&(h=!0),["ConfigurationContext"].includes(e.dataIndex)&&(v=!0)})),h||v)if("export_gridview_pref_always"===widget.getValue(s.exportConfigData)){if(null!==n._checkProgressElementifExists())return;n._showProgressBarforEffColumns(i.treeDocument.getRoots()[0].options.label),n._computeEffColumnsInfo(f,h,v).then((()=>{n._closeProgresBarForEffColumns(),this._downloadCSVFile(i,f,m,!0)})).catch((e=>{console.error("Error getting Configuration data: ",e)}))}else"export_gridview_pref_ask"===widget.getValue(s.exportConfigData)?n._buildExportConfigDataDialog(i,f,m,h,v,this._downloadCSVFile.bind(this)):n._removeEffColumns(i,f,m,this._downloadCSVFile.bind(this));else this._downloadCSVFile(i,f,m,!1)},_addFilterInformation:function(e,t,i){var n="",o=i.treeDocument.getFilterManager().filterModel;function r(e,t,i){var n=e["condition"+i];return n?(1!==i&&(t=t+" "+e.operator),r(e,t=t+" "+n.type+(n.filter?' "'+n.filter+'"':""),i+1)):t}return t.columns.forEach((e=>{var t="",i=e.dataIndex;if("tree"===e.dataIndex&&(i="label"),o[i]&&o[i].filterModel&&Object.keys(o[i].filterModel).length>0){var a=o[i].filterModel;t='"'+(t=a.condition1?r(a,"",1):JSON.stringify(a)).replace(/\"/g,'""')+'"'}n=n+t+","})),e=n+"\n"+e},_addHeaderInformation:function(e,t,i,n,l){var c=r.displayDate(new Date,{timePrecision:"sec"});c=JSON.stringify(c);var d=o.getUser("isFullName"),u=a.label_none,p=widget.getValue("ngFilter"),g=widget.getValue("currentConfig");if(p&&p.length>0)u=JSON.parse(p).filterTitle;else if(g&&g.modelVersion&&g.modelVersion.physicalid){var f=g.modelVersion.name+" "+g.modelVersion.revision;if(g.pc&&g.pc.physicalid){var m=g.pc.label?g.pc.label:g.pc.name;m.startsWith("[")&&m.endsWith("]")&&(m=m.slice(1,m.length-1)),f=f+" "+m}u=f}var h=widget.getValue("component-view"),v="";"structured-view"===h?v=a.action_structured:"flattened-view"===h?v=a.replace(a.action_flattened,{levelCnt:parseInt(widget.getPreference(s.depthFlattenedView).value,10)}):"flattend-view-only-architecture-item"===h&&(v=a.replace(a.action_flattened_arch,{levelCnt:parseInt(widget.getPreference(s.depthFlattenedViewArchitectureItemOnly).value,10)}).replace(",",""));var C=widget.getValue("configurable_expand"),y=C.specDocs,b=C.proposedSolution,_=C.implementing&&"structured-view"===h;let w={noSpecificFilter:a.label_none,filterAllDisciplines:a.action_discipline_filter,filterPilotingDisciplines:a.action_piloting_discipline_filter,filterProposedSolutions:a.action_proposed_solutions_filter,filterDefaultStructure:a.action_default_structure_filter,alwaysShowCategories:a.action_show_categories_filter,alwaysHideCategories:a.action_hide_categories_filter};var D=w[n.options.currentSpecificFilterUI],S=w[n.options.currentStructureFilterUI];return e=a.label_export_gridview+"\n"+a.label_filename+","+t+"\n"+a.label_export_datetime_utcformat+","+c+"\n"+a.label_exported_by+","+d+"\n"+a.label_applied_current_view+","+v+"\n"+a.label_applied_current_structure_filter+","+S+"\n"+a.label_applied_product_configuration+","+u+"\n"+a.label_applied_current_specific_filter+","+D+"\n"+a.label_export_proposed_solutions+","+(b?a.label_yes:a.label_no)+"\n"+a.label_export_specification_documents+","+(y?a.label_yes:a.label_no)+"\n"+a.label_export_discipline_references+","+(_?a.label_yes:a.label_no)+"\n"+a.label_export_configuration_data+","+(l?a.label_yes:a.label_no)+"\n"+a.label_number_of_exported_items+","+i.nb_exported_objects+"\n"+a.label_number_of_exported_logical_instances_in_structure+","+i.nb_exported_log_instance+"\n"+a.label_number_of_exported_proposed_solutions+","+i.nb_exported_prop_sol+"\n"+a.label_number_of_exported_spec_docs+","+i.nb_exported_spec_doc+"\n"+a.label_number_of_exported_piloting_disc_ref+","+i.nb_exported_piloting_disc+"\n\n"+a.label_export_legend+"\n"+a.label_export_SPD+","+a.label_export_spec_doc+"\n"+a.label_export_SOL+","+a.label_export_prop_sol+"\n"+a.label_export_PDR+","+a.label_export_piloting_disc+"\n"+"\n\n"+e},_processTreeDocumentForExport:function(e,t){e.treeDocument.prepareUpdate();var n=1,o={nb_exported_objects:0,nb_exported_log_instance:0,nb_exported_prop_sol:0,nb_exported_spec_doc:0,nb_exported_piloting_disc:0};function r(t){if(t&&t.getChildren()){var i=[];t.getChildren().forEach((r=>{r.options.type.includes("Category")?function(t,i){if(t&&t.getChildren()&&!t.isFiltered()&&t.isVisible()){var r="",l=t.options.type,c=!!i.options.grid.architectureNumber;("specificationDocumentsCategory"===l||"proposedSolutionCategory"===l||"implementLinksCategory"===l&&c)&&t.getChildren().forEach((t=>{if(!t.isFiltered()&&t.isVisible()){if("implementLinksCategory"===l){var i=t.options.linkInfo,c="ref"===i.objType&&"implementing"===i.linkType,d="L"===t.options.grid.kindOfRFLP;if(!c||!d)return;r=a.label_export_PDR,o.nb_exported_piloting_disc++}else"specificationDocumentsCategory"===l?(r=a.label_export_SPD,o.nb_exported_spec_doc++):"proposedSolutionCategory"===l&&(r=a.label_export_SOL,o.nb_exported_prop_sol++);var u=s(t,r,n);n++,o.nb_exported_objects++,e.treeDocument.addChild(u)}}))}}(r,t):i.push(r)})),i.forEach((t=>function(t){if(!t.isFiltered()&&t.isVisible()){var i=t.getNodeDepth();i>0&&o.nb_exported_log_instance++,o.nb_exported_objects++;var a=s(t,i,n);n++,e.treeDocument.addChild(a),r(t)}}(t)))}}function s(e,t,n){var o=new i({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,linkInfo:e.options.linkInfo,grid:{level:t,order:n,...e.options.grid}});return Object.keys(o.options.grid).forEach((e=>{if(o.options.grid[e]){var t=e.indexOf("_actual");if(-1!==t&&e.endsWith("_actual")){const i=e.substring(0,t);i&&o.options.grid[i].length<=0&&(o.options.grid[i]=o.options.grid[e])}}})),o.options.grid.isReserved="TRUE"===e.options.isReserved?a.label_export_reserved:a.label_export_not_reserved,void 0===e.options.instance_isReserved?o.options.grid.instance_isReserved="":"TRUE"===e.options.instance_isReserved?o.options.grid.instance_isReserved=a.label_export_reserved:"FALSE"===e.options.instance_isReserved&&(o.options.grid.instance_isReserved=a.label_export_not_reserved),void 0!==e.options.instance&&void 0!==e.options.instance.physicalid&&(o.options.instance_physicalid=e.options.instance.physicalid),o}return r(t.treeDocument),e.treeDocument.pushUpdate(),o},_downloadCSVFile(e,t,i,n){var o=e.treeDocument.getRoots()[0].options.label+".csv",a=t.getAsCSV();a=this._addFilterInformation(a,t,e),a=this._addHeaderInformation(a,o,i,e,n),r.downloadFile(o,a,!0)}}})),define("DS/CATFLCockpitWidget/components/ImplementLinks/CATFLTraceabilityMatrixFilter",["DS/Controls/Button","DS/Controls/Toggle","DS/Controls/Expander","DS/Controls/LineEditor","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s){"use strict";var l=function(e,t){var i=this;i.wrapper=e,i.filterParams={options:{},allocation:{},references:{},instances:{},FilterNames:{}},i.render(t)};return l.prototype.render=function(t){var i=this;if(i.filterimmersiveFrame&&i.filterDialog)i.filterimmersiveFrame.show(),i.filterDialog.show();else{i.filterimmersiveFrame=new r({}),i.filterimmersiveFrame.inject(t);var n=i._createFilterContent();i.filterDialog=new o({immersiveFrame:i.filterimmersiveFrame,title:s.header_filters,content:n,resizableFlag:!0,autoCloseFlag:!1,buttons:{Ok:new e({label:s.apply_button,onClick:function(e){i.wrapper.trMatrix.applyFilter(i.filterParams)}}),Reset:new e({label:s.reset_button,onClick:function(e){i.resetMode=!0,i.filterDialog.content.remove(),i.filterDialog.content=i._createFilterContent(),i.resetMode=!1}})}}),i.filterDialog.addEventListener("close",(function(e){e.preventDefault(),e.stopPropagation(),i.filterDialog.hide(),i.filterimmersiveFrame.hide()}))}},l.prototype._createFilterContent=function(){var e=this,t=UWA.createElement("div",{class:"filter-trMatrix-container"});return e._createOptionsContent().inject(t),e._createAllocationContent().inject(t),e._createReferencesContent().inject(t),e._createInstancesContent().inject(t),e._createNamesContent().inject(t),t},l.prototype._createOptionsContent=function(){var e=this,n=new i({header:s.header_options,body:new UWA.Element("div"),style:"styled",expandedFlag:!0});e.filterParams.options.displayParents=!0;var o=new t({type:"checkbox",label:s.header_disp_parents,checkFlag:!0});return o.addEventListener("buttonclick",(function(t){e.filterParams.options.displayParents=t.dsModel.checkFlag})),o.inject(n.body),n},l.prototype._createAllocationContent=function(){var e=this,n=new i({header:s.header_allocation,body:new UWA.Element("div"),style:"styled",expandedFlag:!0});e.filterParams.allocation.allocated=!0;var o=new t({type:"checkbox",label:s.header_allocated,checkFlag:!0});o.addEventListener("buttonclick",(function(t){e.filterParams.allocation.allocated=t.dsModel.checkFlag})),o.inject(n.body),e.filterParams.allocation.notAllocated=!0;var r=new t({type:"checkbox",label:s.header_not_allocated,checkFlag:!0});return r.addEventListener("buttonclick",(function(t){e.filterParams.allocation.notAllocated=t.dsModel.checkFlag})),r.inject(n.body),n},l.prototype._createReferencesContent=function(){var e=new i({header:s.header_references,body:new UWA.Element("div"),style:"styled",expandedFlag:!0}),t=this.wrapper.typesMap.references;if(t){var n=Object.keys(t).sort((function(e,i){return t[e].name.toLowerCase()<t[i].name.toLowerCase()?-1:t[e].name.toLowerCase()>t[i].name.toLowerCase()?1:0})).reduce((function(e,i){return e[i]=t[i],e}),{});for(var o in n)this._declareType("references",e.body,o)}return e},l.prototype._createInstancesContent=function(){var e=new i({header:"Instances",body:new UWA.Element("div"),style:"styled",expandedFlag:!0}),t=this.wrapper.typesMap.instances;if(t)for(var n in t)t.hasOwnProperty(n)&&this._declareType("instances",e.body,n);return new UWA.Element("div")},l.prototype._createNamesContent=function(){var e=this,o=new i({header:s.header_names,body:new UWA.Element("div"),style:"styled",expandedFlag:!0});e.filterParams.FilterNames.FilterNamesString="",e.filterParams.FilterNames.FilterCheckToDo="";var r=new n({placeholder:s.ph_enter_text});r.addEventListener("change",(function(t){var i=t.dsModel.value,n=i?i.trim():"",o="";if(n.length>0){var r=n.startsWith("*"),a=n.endsWith("*");r&&(n=n.substring(1)),a&&(n=n.substring(0,n.length-1)),n.length>0&&(o=r&&!a?"endsWith":!r&&a?"startsWith":"includes")}e.filterParams.FilterNames.FilterNamesString=n,e.filterParams.FilterNames.FilterCheckToDo=o})),r.inject(o.body),e.filterParams.FilterNames.ApplyToRows=!0;var a=new t({type:"checkbox",label:s.header_app_to_rows,checkFlag:!0});a.addEventListener("buttonclick",(function(t){e.filterParams.FilterNames.ApplyToRows=t.dsModel.checkFlag})),a.inject(o.body),e.filterParams.FilterNames.ApplyToColumns=!0;var l=new t({type:"checkbox",label:s.header_app_to_cols,checkFlag:!0});return l.addEventListener("buttonclick",(function(t){e.filterParams.FilterNames.ApplyToColumns=t.dsModel.checkFlag})),l.inject(o.body),o},l.prototype._declareType=function(e,i,n){var o,r=this,a=r.wrapper.typesMap[e][n];r.types||(r.types={}),r.types.hasOwnProperty(n)?(o=r.types[n],r.resetMode&&(r.filterParams[e][n]=!0,o.el.checkFlag=!0),o.el.inject(i)):((o={}).el=new t({type:"checkbox",label:a.name,checkFlag:!0}),o.el.addEventListener("buttonclick",(function(t){r.filterParams[e][n]=t.dsModel.checkFlag})),r.filterParams[e][n]=!0,o.el.inject(i),this.types[n]=o)},l})),define("DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",["DS/CATFLWebMatrix/ExcelExporter","DS/CATFLCockpitWidget/components/ImplementLinks/CATFLTraceabilityMatrixFilter","DS/CATFLCockpitWidget/utils/common.util"],(function(e,t,i){"use strict";return{executeToolbarCmd:function(n){var o=n.id,r=n.toolbarCtx,a=r.wrapper,s=a.trMatrix;if("collapse_btn"===o){var l=1!==s.rows.length||s.rows[0].isVisible()?0:1;s.setExpandLevel(l),r.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=-1}else if("export_btn"===o){var c=e.createXML(s.generateExcelData({prefixes:{}}));i.downloadFile("TraceabilityMatrix.xml",c)}else if("switchMatrix_btn"===o){var d=!a.getOption("inverted");a.setOption("inverted",d),a.createMatrix(),r.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=-1,a.trMatrix.inject(a.trMatrixContainer)}else"filter_btn"===o&&(r.trMatrixFilter?r.trMatrixFilter.render():r.trMatrixFilter=new t(a,a.container))}}})),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.replace",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/services/logitem.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a){"use strict";var s=i.getFullConfig().identifiers;return{replaceByExisting:function(e,t,i,n,r){var l,c=this.replaceByExistingCallback.bind(this,e,t,i,n,r);l=s.type_act_logref,o.launchSearch({searchTitle:a.label_search_logref,allowedTypes:l,role:"",criteria:l,bMultiSel:!1,in_apps_callback:c})},replaceByExistingCallback:function(i,o,s,l,c,d){var u=c.getContent();e.mask(u,a.msg_processing),d&&1===d.length?r.replaceWithExistingRef(i,o,d[0].id?d[0].id:d[0].objectId,"otherReference").then((function(i){let o=[l.options.instance.physicalid];(i.member?i.member[0]:null)&&n.refreshNodesOnReplace({replaceDetails:i.member,selectedNodes:[l],instID:o}).then((function(){e.unmask(u),t.alertMessage("success",null,a.msg_replace_success)}))})).catch((function(i){e.unmask(u),t.displayError(i,null,null,a.error_repl_failed)})):t.alertMessage("error",null,a.msg_select_single_Logical)}}})),define("DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.factory",["DS/UIKIT/Mask","DS/CfgBaseUX/scripts/CfgData","DS/CATFLCockpitWidget/components/BulkEdition/BulkEditionDialog","DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow","DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.actions","DS/CATFLCockpitWidget/components/DisciplineIterations/consolidateDefinition","DS/CATFLCockpitWidget/components/DisciplineIterations/lastOutfittedState.compare","DS/CATFLCockpitWidget/components/RefineSelection/RefineSelection","DS/CATFLCockpitWidget/components/SpaceAssignment/Copy/SpaceAssignmentCopy","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.creation","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.replace","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.deletion","DS/CATFLCockpitWidget/components/ImplementLinks/implementLinks.controller","DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment","DS/CATFLCockpitWidget/components/ModelPCSelector/checkEffectivityConsistency","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/document.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller","DS/CATFLCockpitWidget/commands/RelatedObjectCmd","DS/CATFLCockpitWidget/utils/SAXTracker","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","DS/CATFLCockpitWidget/utils/DisplayConnectedDIFStructure.util"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f,m,h,v,C,y,b,_,w,D,S,I,A,F){"use strict";var k=y.getFullConfig(),E=function(e,t,i,n,o,r){var a={type:"PushItem",title:e};return r&&(a.icon=r),t&&(a.fonticon={family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-"+t}),i&&(a.action={callback:i.bind(T)}),n&&(a.state="disabled",o&&(a.tooltip=o)),a},x=function(e){var t=[];return e.forEach((function(e){var i=e.options.actualParent,n=e.options.instance;t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,relID:n&&n.physicalid?n.physicalid:"",instanceName:e.options.grid.instanceName,parent:{physicalid:i&&i.options?i.options.physicalid:""}})})),t},T={createAddToConfigurationRevisionMenu:function(e,t){return E(A.add_to_config_rev,"configuration-add",(function(){var i={items:o.getNodeInfoForEffectivity(t,e)};D.init("AddToConfigurationRevisionCmd",i)}))},createSpaceAssignmentMenu:function(e,t){return E(A.action_assign_space,"space-management",(function(){I.trackCommandLaunched("assignSpaces-sax"),e.options.assignedSpacesPID?new f(e):b.addAssignedSpacesAttribute([e]).then((()=>{new f(e)}))}),t,A.error_action_unavailable_in_release)},createCompareWithLastOutfitted:function(e,t){return E(A.compareWithLastOutfitted,"part-compare",(function(){var i=e[0].options.maturity;-1===i.indexOf("PRIVATE")&&-1===i.indexOf("IN_WORK")||C.alertMessage("warning",null,A.warn_incomplete_definition),new a({selectedNodes:e,view:t}).render()}))},createConsolidateLogicalDefinitionMenu:function(e,t){return E(A.header_consolidate_log_defn,"merge",(function(){I.trackCommandLaunched("consolidateLogicalDefinition-sax"),new r({selectedNodes:e,view:t.collectionView}).render()}))},createCompareMenu:function(e){return E(A.compare,"part-compare",(function(){var t=[];e.forEach((function(e){t.push({physicalid:e.options.physicalid,label:e.options.label})})),D.init("CompareCmd",t)}))},createCopyMenu:function(e,t,n){var o=E(A.action_copy,"copy");return o.submenu=[E(A.label_attributes,"attributes",(function(){I.trackCommandLaunched("copyAttributes-sax"),i.open(e[0],t.collectionView,n)})),E(A.label_space_assignment,"space-management",(function(){I.trackCommandLaunched("copySpaceAssignment-sax"),l.open(e[0],t.collectionView.treeDocument),n.dataCopied="spaces-copied"}))],o},createPasteCommand:function(e,t,n){return"attributes-copied"===t.dataCopied?E(A.label_paste_attributes,"paste",(function(){I.trackCommandLaunched("pasteAttributes-sax"),t.dataCopied=null,i.submit()}),n,A.error_action_unavailable_in_release):E(A.label_space_assignement_copy,"paste",(function(){I.trackCommandLaunched("pasteSpaceAssignment-sax"),t.dataCopied=null,l.validateAndSubmit()}),n,A.error_action_unavailable_in_release)},createCreateImplementLinkOccToOccMenu:function(e,t){return E(A.action_create_implrel_occ2occ,"convergence-state",(function(){I.trackCommandLaunched("createOccOccImplementRelation-sax"),g.manageOcc2OccImplRel({selectedNode:e[0]})}),t,A.error_action_unavailable_in_release)},createCreateImplementLinkRefToRefMenu:function(e,t){let i="structured-view"!==widget.getValue("component-view");return E(A.action_create_implrel_ref2ref,"convergence-state",(function(){I.trackCommandLaunched("createRefRefImplementRelation-sax"),g.manageRef2RefImplRel({selectedNode:e,isReleased:t})}),i,A.error_action_unavailable_in_flattened_view)},createDeleteImplementLinkMenu:function(e,t,i,o){return E(A.action_delete_impl_rel,"remove",(function(){I.trackCommandLaunched("deleteImplementRelation-sax");var o=A.label_delete_implementLink_header+" - ";1===e.length?o+=e[0].options.label:o+=e.length+" "+A.label_objects;var r=UWA.createElement("p",{html:A.msg_delete_manyimplementLink_confirmation});n.createWindow(o,r,A.action_delete,(function(){g.deleteImplRel({treeDocument:i.collectionView.treeDocument,rootNode:t,selectedNodes:e})}))}),o,A.error_action_unavailable_in_release)},createDetachMenu:function(t,i,o,r,a){var s=E(A.label_detach,"tree-delete",(function(){I.trackCommandLaunched("detachLogItem-sax");var a=UWA.createElement("div");UWA.createElement("p",{html:A.msg_detach_log_confirm}).inject(a),o&&UWA.createElement("div",{class:"warn-stable-with-archno",html:'<span class="wux-ui-3ds wux-ui-3ds-attention" style=""></span>'+A.warn_detach_item_with_archNo}).inject(a),!o&&r&&UWA.createElement("div",{class:"warn-stable-with-archno",html:'<span class="wux-ui-3ds wux-ui-3ds-attention" style=""></span>'+A.warn_detach_stable_item}).inject(a);var s=A.label_detach+" - ";1===t.length?s+=t[0].options.label:s=s+t.length+" "+A.label_objects,n.createWindow(s,a,A.label_detach,(function(){e.mask(i.collectionView.getContent(),A.msg_processing),p.deleteLogItemInstance(i)}))}));return"structured-view"!==widget.getValue("component-view")?(s.state="disabled",s.tooltip=A.error_action_unavailable_in_flattened_view):a&&(s.state="disabled",s.tooltip=A.error_action_unavailable_in_release),s},createDisplayMoreAttributesMenu:function(e,t,i){return E(A.action_display_more_attributes,"attributes-add",(function(){h.displayMoreAttributes(e,t,i)}))},createDocumentDownloadMenu:function(e){return E(A.action_download,"download",(function(){I.trackCommandLaunched("downloadSpecDoc-sax");var t=[];e.forEach((function(e){t.push(e.options.physicalid)})),v.downloadDocument(t).then((function(){C.alertMessage("success",null,A.msg_download_success)}))}))},createDocumentDetachMenu:function(e){return E(A.label_detach,"tree-delete",(function(){I.trackCommandLaunched("detachSpecDoc-sax"),c.detachDocuments(e)}))},createDuplicateMenu:function(e){return E(A.duplicate,"duplicate",(function(){var t=[];e.forEach((function(e){t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,current:e.options.grid.maturity,icons:e.options.icons})})),D.init("DuplicateCommand",t)}))},createEditConfigurationContextMenu:function(e){return E(A.action_edit_config_ctx,"3dproduct-pencil",(function(){var t=[];e.forEach((function(e){t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,owner:e.options.grid.owner,icons:e.options.icons})})),D.init("EditConfigurationContextCmd",t)}))},createSelectbyConfigurationCriteria:function(e){return E(A.action_select_config_critera,"configuration-effectivity",(function(){var t=[];e.forEach((function(e){t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,owner:e.options.grid.owner,icons:e.options.icons})})),t[0].treeData=e[0],D.init("SelectByConfigurationCriteriaCmd",t)}))},createVariantEffectivityMenu:function(e,i,n,r){var a=E(A.action_variant_effectivity,"variants-and-options",!1);return a.submenu=[],n||(r=!0),a.submenu.push(E(A.action_copy,"copy",(function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};D.init("CopyVariantEffectivityCmd",t)}),r),E(A.label_paste,"paste",(function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};D.init("PasteVariantEffectivityCmd",t)}),!t.isVariantEffAvailable),E(A.action_edit,"pencil",(function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};D.init("EditVariantEffectivityCmd",t)}),!1)),a},createEvolutionEffectivityMenu:function(e,i,n,r){var a=E(A.action_evolution_effectivity,"evolution-effectivity",!1);return a.submenu=[],n||(r=!0),a.submenu.push(E(A.action_copy,"copy",(function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};D.init("CopyEvolutionEffectivityCmd",t)}),r),E(A.label_paste,"paste",(function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};D.init("PasteEvolutionEffectivityCmd",t)}),!t.isEvolutionEffAvailable),E(A.action_edit,"pencil",(function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};D.init("EditEvolutionEffectivityCmd",t)}),r),E(A.action_extend_evolution,"evolution-effectivity-extension",(function(){var t={items:o.getNodeInfoForEffectivity(i,e)};e instanceof Array&&e.length>1e3&&C.alertMessage("warning",null,A.replace(A.msg_bulkOperation_limitReached,{limit:1e3})),D.init("ExtendEvolutionEffectivityCmd",t)}))),a},createCheckEffectivityConsistencyMenu:function(e,t){let i=widget.getValue(k.localStorageKeys.componentView)!==k.localStorageKeys.structuredView;var n=E(A.action_check_effectivity_consistency,"implementation-validation",null,i,A.error_action_unavailable_in_flattened_view);return n.submenu=[this.createOutfittingOrDisciplineMenu(e,t,A.action_outfitting,"outfitting",i),this.createOutfittingOrDisciplineMenu(e,t,A.action_discipline,"discipline",i)],n},createOutfittingOrDisciplineMenu:function(e,t,i,n,o){let r=E(i,null,(function(){new m({selectedNodes:e,params:t,action:n})})),a=widget.getValue("configurable_expand");return"outfitting"===n?o?(r.state="disabled",r.tooltip=A.error_action_unavailable_in_flattened_view):a&&!a.implementedBy&&(r.state="disabled",r.tooltip=A.error_action_unavailable_implBy_links):"discipline"===n&&(o?(r.state="disabled",r.tooltip=A.error_action_unavailable_in_flattened_view):a&&!a.implementing&&(r.state="disabled",r.tooltip=A.error_action_unavailable_impling_links)),r},createExpandMenu:function(e,t){let i,n,r=E(A.action_expand,"flow-tree-expand-down");return"structured-view"!==widget.getValue("component-view")&&(i=!0,n=A.error_action_unavailable_in_flattened_view),r.submenu=[E(A.action_expand_one_level,"flow-tree-child-1-expand-down",(function(){I.trackCommandLaunched("expandOneLevel-sax"),b.expandNodestoNLevel({level:"1",selectedNodes:t,params:e})})),E(A.action_expand_two_level,"flow-tree-child-1-3-expand-down",(function(){I.trackCommandLaunched("expandTwoLevel-sax"),t.length>1&&C.alertMessage("warning",null,A.msg_expandMultiLvl_multiSelect_warning),b.expandNodestoNLevel({level:"2",selectedNodes:t,params:e})}),i,n),E(A.action_expand_all,"flow-tree-expand-down",(function(){I.trackCommandLaunched("expandAll-sax");var i=null,n=widget.getValue("currentConfig");n&&n.filterCompiledForm&&(i=n.filterCompiledForm),1===t.length?o.checkInstanceCount(t,i):t.length>1&&C.alertMessage("warning",null,A.msg_expandMultiLvl_multiSelect_warning),b.expandNodestoNLevel({level:"-1",selectedNodes:t,params:e})}),i,n),E(A.action_collapse_all,"flow-tree-expand-up",(function(){I.trackCommandLaunched("collapseAll-sax"),t.forEach((function(e){e.collapseAll()}))}))],r},createInformationMenu:function(e,t,i){return E(A.action_information,"info",(function(){_.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-properties",data:{items:e,contentView:i,showPropertiesPanel:!0}})}))},createInsertMenu:function(e,t,i,n){let o=E(A.action_insert,"plus");return o.submenu=[E(A.label_log_ref,"logical",(function(){t.publish({event:"create-new-logical-item"})})),E(A.label_spec_document,"doc-add",(function(){I.trackCommandLaunched("insertNewSpecDocument-sax"),d.createDocument(e[0],!0)})),{type:"SeparatorItem"},E(A.label_existing_log_ref,"logical",(function(){c.addExistingItem(e[0],i.getContent(),i.treeDocument)})),E(A.label_existing_spec_document,"doc-insert",(function(){I.trackCommandLaunched("insertExistingSpecDocument-sax"),c.addExistingDoc(e[0],!0,i.getContent())}))],widget.getValue(k.localStorageKeys.componentView)!==k.localStorageKeys.structuredView?(o.state="disabled",o.tooltip=A.error_action_unavailable_in_flattened_view):n&&(o.state="disabled",o.tooltip=A.error_action_unavailable_in_release),o},createImplementLinkInformationMenu:function(e,t,i){return E(A.action_impLink_information,"info",(function(){I.trackCommandLaunched("implementRelationInformation-sax"),_.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-properties",data:{items:e,contentView:i,isImplLinkInfo:!0,showPropertiesPanel:!0}})}))},createMaturityMenu:function(e){return E(A.maturity,"collaborative-lifecycle-management",(function(){var t=[];e.forEach((function(e){var i={};i.physicalid=e.options.physicalid,i.label=e.options.label,t.push(i)})),D.init("MaturityCommand",t)}))},createMoveToMenu:function(e){return E(A.action_move_to,"move-to",(function(){var t=[];e.forEach((function(e){t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,owner:e.options.grid.owner,icons:e.options.icons})})),D.init("ChangeOwnerCommand",t)}))},createShareMenu:function(e){return E(A.action_share,"forward",(function(){var t=[];e.forEach((function(e){t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,owner:e.options.grid.owner,icons:e.options.icons})})),D.init("ShareCmd",t)}))},createOpenAttributesManagementForProposedSolutions:function(e){return E(A.attributes_management_proposed_solutions,"attributes",(function(){I.trackCommandLaunched("openAttributesManagementForProposedSolutions-sax"),o.openAttributesManagementForProposedSolution(e,!0)}))},createReplaceByNewProposedSolutions:function(e,t){return E(A.replace_by_new_soln,"replace-by-latest-version",(function(){I.trackCommandLaunched("replaceByNewProposedSolutions-sax"),o.replaceByLatestSolOrReq(e,t,!0)}))},createReplaceByLatestRequirements:function(e,t){return E(A.replace_by_latest_req,"replace-by-latest-version",(function(){I.trackCommandLaunched("replaceByByLatestRequirement-sax"),o.replaceByLatestSolOrReq(e,t,!1)}))},createOpenInSAXMenu:function(e){return E(A.action_open,"open",(function(){_.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:e[0].options.physicalid,itemType:e[0].getType()}})}))},createOpenWithMenu:function(e){var t;return e&&e.length>0&&((t=E(A.action_open_with,"open-menu-dot")).submenu=[],e.forEach((function(e){t.submenu.push(E(e.text,e.fonticon,e.handler,null,null,e.icon))}))),t},createRefineMenu:function(e,t){return E(A.action_refine_selection,"list-delete",(function(){new s(e,t)}))},createRelationsMenu:function(e){return E(A.relations,"object-related",(function(){S.execute("ENORIPE_AP",e)}))},createRemoveArchitectureNumberMenu:function(e,t,i){return E(A.action_remove_architecture_number,"remove",(function(){I.trackCommandLaunched("removeArchitectureNumber-sax"),c.detachArchitectureReferenceExtension(e,t)}),i,A.error_action_unavailable_in_release)},createRemoveProposedSolutionMenu:function(e,t,i){var n,o,r,a={};let s=widget.getValue("groupingEnabled");for(var l=0;l<t.length;l++)o=t[l].getParent().getParent(),s&&!o.getID&&(o=w.getGroupNodeParent(o)),r=o.options.physicalid,!i&&C.checkIfMaturityIsReleasedOrObsolete(o.options.maturity)&&(i=!0),(n=a[r]?a[r]:[]).push(t[l].options.physicalid),a[r]=n;var d=E(A.action_remove_proposed_solution,"remove",(function(){I.trackCommandLaunched("removeProposedSolution-sax"),c.detachSolution(e,a,t)}));return i&&(d.state="disabled",d.tooltip=A.error_action_unavailable_in_release),d},createReparentMenu:function(e,t,i,n){var r=E(A.action_reparent,"tree-reorder",null,n,A.error_action_unavailable_in_release);return r.submenu=[E(A.action_clear_reparent,"tree-reorder",(function(){I.trackCommandLaunched("reparentActionClearSelection-sax"),i.reparentInstances=null,C.alertMessage("success",null,A.msg_reparentCleared)})),E(A.action_newparent,"tree-reorder",(function(){I.trackCommandLaunched("reparentActionSetAsNewParent-sax"),o.reparentAction(e,t,i.reparentInstances),i.reparentInstances=null}))],r},createReplaceByMenu:function(e,t,i,n){let r;return r="structured-view"!==widget.getValue("component-view")?E(A.action_replace,"replace-by-existing",!1,!0,A.error_action_unavailable_in_flattened_view):E(A.action_replace,"replace-by-existing",!1,n,A.error_action_unavailable_in_release),r.submenu=[E(A.action_replace_new_rev,"flow-line-add",(function(){o.replaceByNewRevision(e,t)})),E(A.action_replace_new_branch,"flow-branch-add",(function(){o.replaceByNewRevision(e,t,!0)}))],1===e.length&&e[0].options.instance&&e[0].options.instance.physicalid&&r.submenu.push(E(A.action_replace_new_ref,"logical",(function(){i.publish({event:"create-new-logical-item",data:{isReplaceCall:!0}})})),E(A.action_replace_exist_ref,"replace-by-existing",(function(){var i=e[0].getParent().options.physicalid,n=e[0].options.instance.physicalid,o=e[0].getRoot().options.physicalid;u.replaceByExisting(i,n,o,e[0],t.collectionView)}))),r.submenu.push(E(A.action_replace_latest_rev,"replace-by-latest-version",(function(){D.init("ReplaceByLatestRevCmd",t.collectionView)})),E(A.action_replace_other_rev,"replace-by-revision",(function(){D.init("ReplaceByRevCmd",t.collectionView)})),E(A.label_replace_duplicate,"replace-by-duplicate",(function(){D.init("ReplaceByDuplicate",t.collectionView)}))),r},createRevisionsMenu:function(e){return E(A.revisions,"flow-branch-list",(function(){var t=[{physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,current:e.options.grid.maturity,icons:e.options.icons}];D.init("HistoryCommand",t)}))},createReserveMenu:function(e,t){return E(A.action_lock,"lock",(function(){D.init("ReserveCmd",x(e))}),t,A.error_action_unavailable_in_release)},createSelectToReparentMenu:function(e,t,i,n){return E(A.action_select_toreparent,"tree-reorder",(function(){I.trackCommandLaunched("selectToReparent-sax");var i="";if(e&&e.length>0){for(var n=0;n<e.length;n++){if(!e[n].options.instance||!e[n].options.instance.physicalid)return void C.alertMessage("error",null,"",A.msg_remove_root);i=i+e[n].options.label+"<br>"}t.reparentInstances={instances:e,nameList:i},C.alertMessage("success",null,A.msg_reparentSaved)}}),i,n)},createSetArchitectureNumberMenu:function(e,t){return E(A.set_architecture_number,"progress-3",(function(){I.trackCommandLaunched("setArchitectureNumber-sax"),c.setArchitectureNumber(e,!1)}),t,A.error_action_unavailable_in_release)},createSetProposedSolutionMenu:function(e,t){return E(A.action_set_proposed_solution,"3dproduct-add",(function(){I.trackCommandLaunched("setProposedSolution-sax"),c.openModalSolutionSelection(e)}),t,A.error_action_unavailable_in_release)},createUnreserveMenu:function(e){return E(A.action_unlock,"lock-open",(function(){D.init("UnreserveCmd",x(e))}),null,A.error_action_unavailable_in_release)},createDisplayConnectedDIFStructureMenu:function(e){return E(A.action_display_connected_DIF_structure,"display-layout-vertical-33",(function(){F.DisplayConnectedDIFStructure(e)}))},createFindWidgetLinkMenu:function(e){return E(A.action_find_widgetlink,"where-used",(function(){var t={selection:e};D.init("FindWidgetLinkCmd",t)}))},createCopyLink:function(e){return E(A.action_copy_link,"link",(function(){D.init("CopyLinkCmd",{selection:e})}))}};return T})),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.contextualmenu",["DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.factory","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/widgetlink.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o){"use strict";var r=i.getFullConfig(),a=r.identifiers,s=r.localStorageKeys;return{getMenu:function(l,c,d){var u=!1,p=this,g=!1,f=!1,m=!1,h=!1,v=!1,C=!1,y=l.collectionView.treeDocument.getRoots()[0],b=r.adminStatus,_=l.modelInfo;(_&&_.modelVersion&&(_.modelVersion.current===a.state_act_Release||_.modelVersion.current===a.state_act_Obsolete)||y&&t.checkIfMaturityIsReleasedOrObsolete(y.options.maturity))&&(g=!0);var w=l.collectionView.treeDocument.getSelectedNodes(),D=!1,S=!1,I=!1;if(w[0].isRoot()&&(S=!0),widget.getValue("xRevAttached")&&(I=!0),1===w.length&&(w[0].isRoot()&&(D=!0),w[0].options.linkInfo&&(m=!0),w[0].options.linkInfo&&"implementing"===w[0].options.linkInfo.linkType&&"ref"===w[0].options.linkInfo.objType&&(C=!0),h||!w[0].options.maturity||-1===w[0].options.maturity.indexOf(a.state_act_Frozen)&&-1===w[0].options.maturity.indexOf(a.state_act_Released.toUpperCase())||!w[0].options.grid.architectureNumber||""===w[0].options.grid.architectureNumber||(h=!0),!v&&b.ReparentEnforceSetAN&&w[0].options.grid.architectureNumber&&""!==w[0].options.grid.architectureNumber&&(v=!0)),w.length>1)for(var A=!1,F=!1,k=0;k<w.length&&(w[k].options.grid.kindOfRFLP!==w[0].options.grid.kindOfRFLP&&(u=!0),t.checkIfMaturityIsReleasedOrObsolete(w[k].options.maturity)&&(f=!0),!u||!f);k++)A||(w[k].options.linkInfo?(m=!0,F||("implementing"===w[k].options.linkInfo.linkType&&"ref"===w[k].options.linkInfo.objType?C=!0:(F=!0,C=!1))):(A=!0,m=!1)),h||!w[k].options.maturity||-1===w[k].options.maturity.indexOf(a.state_act_Frozen)&&-1===w[k].options.maturity.indexOf(a.state_act_Released.toUpperCase())||!w[k].options.grid.architectureNumber||""===w[k].options.grid.architectureNumber||(h=!0),!v&&b.ReparentEnforceSetAN&&w[k].options.grid.architectureNumber&&""!==w[k].options.grid.architectureNumber&&(v=!0);else f=t.checkIfMaturityIsReleasedOrObsolete(w[0].options.maturity);var E=e.createOpenWithMenu(d),x=e.createInformationMenu(w,c,l.collectionView),T=e.createRefineMenu(w,l.collectionView.treeDocument),L=e.createImplementLinkInformationMenu(w,c,l.collectionView),N=e.createExpandMenu(l,w),M=e.createReserveMenu(w,g),V=e.createUnreserveMenu(w),O=e.createMoveToMenu(w),R=e.createShareMenu(w),P=e.createDisplayConnectedDIFStructureMenu(w);if(u||w[0].options.type===a.type_requirement||w[0].options.type===a.type_act_functref||"R"===w[0].options.grid.kindOfRFLP||"F"===w[0].options.grid.kindOfRFLP){var W=[];if(w[0].options.type!==a.type_requirement&&w[0].options.type!==a.type_act_functref&&"R"!==w[0].options.grid.kindOfRFLP&&"F"!==w[0].options.grid.kindOfRFLP||(E&&(W.push(E),W.push({type:"SeparatorItem"})),w[0].options.type!==a.type_requirement&&"R"!==w[0].options.grid.kindOfRFLP||1!==w.length||!w[0].options.linkInfo||"ref"!==w[0].options.linkInfo.objType||W.push(e.createReplaceByLatestRequirements(w,l),{type:"SeparatorItem"}),1===w.length&&w[0].options.linkInfo&&"ref"===w[0].options.linkInfo.objType&&W.push(e.createCreateImplementLinkOccToOccMenu(w,g),{type:"SeparatorItem"})),w.length>1){W.push(T,{type:"SeparatorItem"});let t=function(){for(let e=0;e<=w.length-1;e++){let t=w[e];if(t.options.type===a.type_act_functref||"F"===t.options.grid.kindOfRFLP||t.options.type===a.type_act_physical||"P"===t.options.grid.kindOfRFLP||t.options.type===a.type_act_logref||"L"===t.options.grid.kindOfRFLP||t.options.linkInfo&&"ref"!==t.options.linkInfo.objType)return!1}return!0}();t&&W.push(e.createReplaceByLatestRequirements(w,l),{type:"SeparatorItem"})}return W.push(x),m&&W.push(L),m&&W.push({type:"SeparatorItem"},e.createDeleteImplementLinkMenu(w,y,l,g)),W}if(w[0].options.type===a.type_act_physical||"P"===w[0].options.grid.kindOfRFLP){var U=[];E&&U.push(E,{type:"SeparatorItem"}),w.length>1&&U.push(T),1===w.length&&w[0].options.linkInfo&&"ref"===w[0].options.linkInfo.objType&&U.push(e.createCreateImplementLinkOccToOccMenu(w)),m||U.push(e.createReplaceByNewProposedSolutions(w,l),{type:"SeparatorItem"},e.createOpenAttributesManagementForProposedSolutions(w),e.createDisplayMoreAttributesMenu(l.collectionView,w,!0));var B=function(){for(var e=0;e<w.length;e++)if("proposedSolutionCategory"!==w[e].getParent().options.type)return!1;return!0}();return B||U.push({type:"SeparatorItem"}),U.push(x),m&&U.push(L),B?U.push({type:"SeparatorItem"},e.createRemoveProposedSolutionMenu(l.collectionView.treeDocument,w,g||f)):m&&U.push({type:"SeparatorItem"},e.createDeleteImplementLinkMenu(w,y,l)),U}if(w[0].getParent().options.type===a.type_spec_document){var j=[];return E&&j.push(E,{type:"SeparatorItem"}),w.length>1&&j.push(T,{type:"SeparatorItem"}),j.push(O,R,{type:"SeparatorItem"},e.createDocumentDownloadMenu(w),x,{type:"SeparatorItem"},e.createDocumentDetachMenu(w)),j}if(w[0].options.type===a.type_act_logref||"L"===w[0].options.grid.kindOfRFLP){var G=[],J=null,q=p.reparentInstances;if(widget.getValue("component-view")!==s.structuredView)D||(J=e.createSelectToReparentMenu(w,null,!0,o.error_action_unavailable_in_flattened_view));else if(q&&q.instances.length>0&&1===w.length){var z=!1;(g||t.checkIfMaturityIsReleasedOrObsolete(w[0].options.maturity))&&(z=!0),J=e.createReparentMenu(w,l,p,z)}else J=q&&q.instances.length>0&&w.length>1||D?null:e.createSelectToReparentMenu(w,p,g,o.error_action_unavailable_in_release);1!==w.length||D||G.push(e.createOpenInSAXMenu(w)),E&&G.push(E),G.length>0&&G.push({type:"SeparatorItem"}),w.length>1&&G.push(T);for(var K=0;K<w.length;K++)if("implementLinksCategory"===w[K].getParent().options.type)return m&&G.push(e.createDisplayMoreAttributesMenu(l.collectionView,w)),1===w.length&&w[0].options.linkInfo&&"ref"===w[0].options.linkInfo.objType&&G.push({type:"SeparatorItem"},e.createCreateImplementLinkOccToOccMenu(w,g),{type:"SeparatorItem"}),C&&G.push(e.createMaturityMenu(w),{type:"SeparatorItem"},e.createMoveToMenu(w),R,{type:"SeparatorItem"}),G.push(x),m&&G.push(L),G.push({type:"SeparatorItem"}),m&&G.push(e.createDeleteImplementLinkMenu(w,y,l,g)),G;G.push(N,{type:"SeparatorItem"}),1===w.length&&G.push(e.createCopyMenu(w,l,p)),p.dataCopied&&G.push(e.createPasteCommand(w,p,g||f)),1===w.length&&G.push(e.createInsertMenu(w,c,l.collectionView,g||f)),G.push(e.createSetArchitectureNumberMenu(w,g||f));for(let t=0;t<w.length;t++)if(void 0!==w[t].options.grid.architectureNumber&&""!==w[t].options.grid.architectureNumber){G.push(e.createRemoveArchitectureNumberMenu(w,l.collectionView.getContent(),g||f));break}if(G.push(e.createSetProposedSolutionMenu(w,g||f)),G.push(e.createEditConfigurationContextMenu(w,l)),1!==w.length||I||G.push(e.createSelectbyConfigurationCriteria(w,l)),!D&&!S){b.ConfiguredRevisionEnabled&&G.push(e.createAddToConfigurationRevisionMenu(w,l));let t=w[0].getParent().getID();for(let e=1;e<w.length;e++)if(t!==w[e].getParent().getID()){t=null;break}t&&G.push(e.createVariantEffectivityMenu(w,l,1===w.length,!1)),G.push(e.createEvolutionEffectivityMenu(w,l,1===w.length,!1))}1===w.length&&(G.push(e.createSpaceAssignmentMenu(w[0],g||f)),G.push(e.createCreateImplementLinkRefToRefMenu(w[0],g||f))),D||S||G.push(e.createConsolidateLogicalDefinitionMenu(w,l)),D||G.push(e.createReplaceByMenu(w,l,c,g)),null!==J&&G.push(J),G.push({type:"SeparatorItem"}),1===w.length&&G.push(e.createRevisionsMenu(w[0])),G.push(e.createDuplicateMenu(w)),w.length<=2&&G.push(e.createCompareMenu(w)),b.FullCompareEnabled&&1===w.length&&!D&&G.push(e.createCompareWithLastOutfitted(w,l.collectionView)),G.push(e.createMaturityMenu(w),{type:"SeparatorItem"}),G.push(M,V,O,R,{type:"SeparatorItem"}),D||S||I||G.push(e.createCheckEffectivityConsistencyMenu(w,l)),G.push(P,e.createRelationsMenu(w[0]));var H=i.getWidgetLink();return 1===w.length&&H&&H.getLinked().length>0&&n.hasItemImplementLinks(w[0])&&G.push(e.createFindWidgetLinkMenu(w)),1===w.length&&G.push(e.createCopyLink(w)),G.push(x),D||S||G.push({type:"SeparatorItem"},e.createDetachMenu(w,l,v,h,g)),G}if("DIF"===w[0].options.grid.kindOfRFLP){let t=[e.createMaturityMenu(w),{type:"SeparatorItem"},O,R,{type:"SeparatorItem"},e.createRelationsMenu(w[0]),x];return E&&t.unshift(E),t}}}})),define("DS/CATFLCockpitWidget/components/LandingPage/referencesView",["DS/CoreEvents/ModelEvents","DS/CATFLCockpitWidget/utils/model.events.util","DS/PlatformAPI/PlatformAPI","DS/ENOXEmptyContent/js/ENOXEmptyContent","DS/ENOXPageToolBar/js/PageToolBar","DS/Tweakers/GeneratedToolbar","DS/Menu/Menu","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CollectionView/ResponsiveThumbnailsCollectionView","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.factory","DS/Controls/Button","DS/Controls/ModalContainer","DS/Controls/Loader","DS/CATFLCockpitWidget/components/CreateLogicalItemModal/CreateLogicalItemHelper","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/index.service","text!DS/CATFLCockpitWidget/assets/config/navigate.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f,m,h,v,C,y,b,_,w,D){"use strict";var S=c.getFullConfig(),I=S.identifiers;return{init:function(e){var i=this;let n=e.id,o=e.title;i.container=e.container,i.triptych=e.triptych,i.propertiesPanel=e.rightPanel,i.createContents(i.container),widget.setTitle(""),i.createToolbar(),i.createGeneratedToolbar(n),i.highlightWelcomePanelAction(n),i.setTitle(o),i.subscribeToEvents(),i.validateWorkUnder(),d.makeDroppable(i.container,D.msg_drop_to_open,(function(e){t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-drop-item",data:{item:e}})}));var r,a=widget.getValue("previouslyOpenedItems");return r=a?JSON.parse(a):null,i.itemView=i.getItemContent(n,r),i},createToolbar:function(){var t=this;t.modelEvents=new e;var i={withInformationButton:!0,withWelcomePanelButton:!0,modelEvents:t.modelEvents,parentContainer:t.headerContainer};t._pageToolBar=new o(i),t._pageToolBar.render().inject(t.headerContainer)},setTitle:function(e){this._pageToolBar.getBodyContent().innerHTML=e},subscribeToEvents:function(){var e=this;e.modelEvents.subscribe({event:"welcome-panel-collapse"},(function(){e.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"left"}),e.modelEvents.publish({event:"welcome-panel-collapsed"})})),e.modelEvents.subscribe({event:"welcome-panel-expand"},(function(){e.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"left"}),e.modelEvents.publish({event:"welcome-panel-expanded"})})),e.modelEvents.subscribe({event:"information-panel-open"},(function(){t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-properties",data:{items:e.treeDocument.getSelectedNodes(),contentView:e.collectionView}}),e.triptych.modelEvents.publish({event:"triptych-show-panel",data:"right"})})),e.modelEvents.subscribe({event:"information-panel-close"},(function(){e.triptych.modelEvents.publish({event:"triptych-hide-panel",data:"right"})})),e.modelEvents.subscribe({event:"triptych-panel-hidden"},(function(t){"right"===t&&e.triptych.modelEvents.publish({event:"information-panel-hidden",data:null})})),e.modelEvents.subscribe({event:"information-panel-hidden"},(function(){e.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"right"})})),e.triptych.modelEvents.subscribe({event:"triptych-panel-hidden"},(function(t){"right"===t&&e.triptych._container.getElement(".fonticon.fonticon-2x.fonticon-info")&&e.triptych._container.getElement(".fonticon.fonticon-2x.fonticon-info").classList.remove("selected")})),e.triptych.modelEvents.subscribe({event:"resizing-triptych-container"},(function(t){widget.getValue("currentView")&&"LandingPage"!==widget.getValue("currentView")||(t<550?e.triptych.modelEvents.publish({event:"triptych-hide-panel",data:"left"}):e.triptych.modelEvents.publish({event:"triptych-show-panel",data:"left"}))})),widget.subscribedToAuthoringInLanding||(i.subscribe("DS/PADUtils/PADCommandProxy/refresh",e.refreshCollectionViewOnItemUpdate.bind(e)),widget.subscribedToAuthoringInLanding=!0)},getItemContent:function(e,t){var i=this;let n=i.container.getElement(".fl-"+e+"-container .fl-view-container"),o={};i.recentsResponse=[],i.userContent=[],i.treeDocument=new s,i.collectionView=new u({displayedOptionalCellProperties:["contextualMenu"]}).inject(n);var r=JSON.parse(w);i.loader=new v,i.loader.on(D.msg_loading);try{h.createModal(n,i.loader.elements.container)}catch(e){console.log("Error: "+e)}if("recents"===e)if(t&&t.length>0){var a=[];a.push(_.fetch(t,r.basic.attributes,!0)),a.push(_.getRecentsContent()),Promise.all(a).then((function(e){if("Recents"!==widget.getValue("landingPage"))return;let r=e[0],a=e[1];r.forEach((function(e){let t=i.createNodeModel(e);t.options.customTooltip=i.getTooltip(t,e),o[t.getID()]=t})),a.forEach((function(e){let n=i.createNodeModel(e);n.options.customTooltip=i.getTooltip(n,e),t.includes(n.getID())&&(o[n.getID()]=n)}));let s=[];t.forEach((e=>{o[e]&&s.push(o[e])})),i.renderCollectionView(n,s),i.updateView(),i.sortUpdate(),i.loader.off(D.msg_loading),h.removeModal(n)}))}else i.createEmptyPage();else _.getUserContent().then((function(e){if("Recents"===widget.getValue("landingPage"))return;let t=[];e&&e.length>0?(e.forEach((function(e){let n=i.createNodeModel(e);n.options.customTooltip=i.getTooltip(n,e),t.push(n)})),i.renderCollectionView(n,t),i.updateView(),i.sortUpdate(),i.loader.off(D.msg_loading),h.removeModal(n)):i.createEmptyPage()}))},createNodeModel:function(e){var t,i,n,o;o=e.NLStype,e.type===I.type_act_advfilter?o=D.action_adv_filter:o||(o=S.mappingType[e.type]?S.mappingType[e.type].nlsName:e.type);let r=e.revision?e.revision:" ";return t=e.architectureNumber?e.architectureNumber:"",i=e.label+" - "+r,n=this.createTileSubtitle(e.maturity,o,e.owner,e.creationDate,e.modificationDate),new l({label:i,thumbnail:e.icon,subLabel:n,contextualMenu:["contextual menu"],emptyStatusbarVisibleFlag:!1,activeFlag:!1,physicalid:e.resourceid,name:e.name,type:e.type,grid:{type:o,revision:e.revision,owner:e.owner},icons:[{iconPath:e.type_icon_url,iconSize:{height:"16px",width:"16px"}}],nlsType:o,maturity:e.status,owner:e.owner,creationDate:e.creationDate,modificationDate:e.modificationDate,maturityState:e.maturity,archNo:t,customTooltip:""})},getTooltip:function(e,t){var i,n;let o=UWA.createElement("div",{class:"container-tile-tooltip"}),r=t.revision?t.revision:" ";if(e){i=D.label_title.bold()+": "+t.label+"\n",e.options.maturity.includes("EffectivityBased")||(i+=D.label_revision.bold()+": "+r+"\n"),i+=D.label_type.bold()+": "+e.options.nlsType+"\n",i+=D.label_maturity.bold()+": "+e.options.maturityState+"\n",i+=D.label_owner.bold()+": "+e.options.owner+"\n",o.addContent(i);let a=UWA.createElement("div",{class:"container-tile-tooltip-date"}).inject(o),s=D.label_creation_date.bold()+": ";a.addContent(s),d.addDateTimeAsTweaker(e.options.creationDate,a),a.addContent("\n");let l=UWA.createElement("div",{class:"container-tile-tooltip-date"}).inject(o),c=D.label_modification_date.bold()+": ";l.addContent(c),d.addDateTimeAsTweaker(e.options.modificationDate,l),l.addContent("\n"),e.getType()!==I.type_act_advfilter&&(n=D.label_arch_no.bold()+": "+e.options.archNo+"\n"),o.addContent(n)}return{shortHelp:o}},createTileSubtitle:function(e,t,i,n,o){let r=UWA.createElement("div",{class:"container-tile-subtitle"}),a=e+" | "+t+" | "+i+" | ";return r.appendText(a),d.addDateTimeAsTweaker(n,r),r.appendText(" | "),d.addDateTimeAsTweaker(o,r),r},selectedChange:function(){var e=this;t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-properties",data:{items:e.treeDocument.getSelectedNodes(),contentView:e.collectionView}}),e.viewGeneratedToolbar.elements.farContainer.querySelector(".wux-ui-style-smartIcon.arrow-icon.wux-tweaker-function-displaycount").addEventListener("click",(function(t){a.show(e.getMenuLanding(e.modelEvents),{input:"mouse",position:{x:t.pageX,y:t.pageY},submenu:"auto"})}));var i=e.collectionView.TreedocModel.getSelectedNodes().length;0===i?e.viewGeneratedToolbar.updateNodeModel("selectionMenu",{visibleFlag:!1}):e.viewGeneratedToolbar.updateNodeModel("selectionMenu",{visibleFlag:!0,count:i});let n=e.treeDocument.getSelectedNodes();var o=c.form3DXContent(n);c.setObjectOnCompass(o),c.launchCrossAppSelection(n)},openItem:function(e){let i=e.nodeModel||e.cellModel;t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:i.getID(),itemType:i.getType()}})},configureView:function(e){var t=this;e.useDragAndDrop=!0,e.allowUnsafeHTMLContent=!0,e.onDragStartCell=function(e){return e.dataTransfer.setData("Text",JSON.stringify(d.create3DXJsonFromDGVSelection(t.treeDocument.getSelectedNodes(),!1))),!1},e.onDragCell=function(e){return e.dataTransfer.setData("Text",JSON.stringify(d.create3DXJsonFromDGVSelection(t.treeDocument.getSelectedNodes(),!1))),!1},e.onCellDoubleClick(t.openItem.bind(t)),e.onSelectionAdd(t.selectedChange.bind(t,t.triptych,t.propertiesPanel)),e.onSelectionRemove(t.selectedChange.bind(t,t.triptych,t.propertiesPanel)),e.onContextualEvent={callback:function(e){var i=e.cellInfos.cellView.collectionView.TreedocModel.getSelectedNodes();return i.length>1?t.getMenuLanding(t.modelEvents,e):1===i.length?b.getTypeHierarchy(i[0].options.type).then((function(n){return d.getOpenWithCompatibleApps(i[0],n).then((function(i){return t.getMenuLanding(t.modelEvents,e,i)}))})):void 0}}},getMenuLanding:function(e,t,i){var n,o=this,r=[];if(1===(n=o.collectionView.TreedocModel.getSelectedNodes()).length)t&&r.push(f.createOpenInSAXMenu(n),f.createOpenWithMenu(i)),n[0].getType()===I.type_act_advfilter?r.push(f.createDuplicateMenu(n),f.createCompareMenu(n),f.createMaturityMenu(n),{type:"SeparatorItem"},f.createRelationsMenu(n[0]),f.createInformationMenu(n,e,o.collectionView)):r.push(f.createRevisionsMenu(n[0]),f.createDuplicateMenu(n),f.createCompareMenu(n),f.createMaturityMenu(n),{type:"SeparatorItem"},f.createReserveMenu(n),f.createUnreserveMenu(n),f.createMoveToMenu(n),f.createShareMenu(n),{type:"SeparatorItem"},f.createRelationsMenu(n[0]),f.createInformationMenu(n,e,o.collectionView));else{let t,i;for(let e=0;e<=n.length-1;e++){if(n[e].getType()===I.type_act_advfilter?t=!0:i=!0,t&&i)break}i&&!t?r.push(f.createDuplicateMenu(n),f.createCompareMenu(n),f.createMaturityMenu(n),{type:"SeparatorItem"},f.createReserveMenu(n),f.createUnreserveMenu(n),f.createMoveToMenu(n),f.createShareMenu(n),{type:"SeparatorItem"},f.createInformationMenu(n,e,o.collectionView)):r.push(f.createDuplicateMenu(n),f.createCompareMenu(n),f.createMaturityMenu(n),{type:"SeparatorItem"},f.createInformationMenu(n,e,o.collectionView))}return r},newLogRef:function(){require(["DS/CATFLCockpitWidget/utils/SAXTracker"],(function(e){e.trackCommandLaunched("createNewLogRef-sax")})),C.createNewLogicalItem({data:{selectedItem:null},treeDocument:this.thumbnailcollectionView?this.thumbnailcollectionView.TreedocModel:null,isRoot:!0})},createContents:function(e){var t=this;t.flHeaderContainer=UWA.createElement("div",{class:"fl-header-container"}).inject(e),t.headerContainer=UWA.createElement("div",{class:"header-container"}).inject(t.flHeaderContainer),UWA.createElement("div",{class:"toolbar-container"}).inject(t.flHeaderContainer),UWA.createElement("div",{class:"fl-view-container"}).inject(e)},highlightWelcomePanelAction:function(e){"recents"===e?document.body.querySelector("#action_recents").classList.value="activity-btn selected":document.body.querySelector("#action_my_references").classList.value="activity-btn selected"},createEmptyPage:function(){var e=this,i=e.container.getElement(".fl-view-container");i&&i.empty();var o=new m({domId:"addButton",label:D.label_start_with_new_reference_button,emphasize:"primary",type:"standard"}),r={sentences:[{type:"drop",text:D.label_drop_here_to_open},{type:"dom",DOMelement:o.getContent()}],orderedListType:"none"};e.emptyView=new n(r),e.emptyView.inject(i),e.loader&&(e.loader.off(D.msg_loading),h.removeModal(i)),o.addEventListener("buttonclick",(()=>{var n=t.createAppEventObject("flcockpit-content-list-view");e.newLogRef(n,i)}))},renderCollectionView:function(e,t){var i=this;0==t.length?i.createEmptyPage():t.length>0&&t.forEach((function(e){i.treeDocument.addRoot(e)}))},createGeneratedToolbar:function(e){var t=this;let i=UWA.createElement("div",{class:"landingPage-toolbar"}).inject(t.headerContainer);var n;n="recents"===e?widget.getValue("recentsCollectionView")?widget.getValue("recentsCollectionView"):"Thumbnails":widget.getValue("myReferencesCollectionView")?widget.getValue("myReferencesCollectionView"):"Thumbnails";let o={id:"selectionMenu",dataElements:{typeRepresentation:"functionMenuIconCount",tooltip:D.multi_select_btn,icon:{iconName:"select-on",fontIconFamily:1,fontIconSize:"2x"},count:1,position:"far",category:"1",visibleFlag:!1}},a={id:"sortToolbar",dataElements:{typeRepresentation:"icon",tooltip:D.sort_btn,value:"label1",possibleValues:[{value:"label1",label:D.label_title,icon:{iconName:"alpha-sorting-a-z",fontIconFamily:1,fontIconSize:"2x"}},{value:"label2",label:D.label_title,icon:{iconName:"alpha-sorting-z-a",fontIconFamily:1,fontIconSize:"2x"}},{value:"maturity",label:D.label_maturity,icon:{iconName:"alpha-sorting-a-z",fontIconFamily:1,fontIconSize:"2x"}},{value:"owner",label:D.label_owner,icon:{iconName:"alpha-sorting-a-z",fontIconFamily:1,fontIconSize:"2x"}},{value:"creationDate",label:D.label_creation_date,icon:{iconName:"date-sorting-1-31",fontIconFamily:1,fontIconSize:"2x"}},{value:"modificationDate",label:D.label_modification_date,icon:{iconName:"date-sorting-1-31",fontIconFamily:1,fontIconSize:"2x"}}],position:"far",category:"2"},onNodeUpdate:function(e){t.sortUpdate(e)}},s={id:"viewOptions",dataElements:{typeRepresentation:"icon",tooltip:D.switch_view,value:n,possibleValues:[{value:"SmallTiles",label:D.tile_view,icon:{iconName:"view-small-tile",fontIconFamily:1,fontIconSize:"2x"}},{value:"Thumbnails",label:D.thumbnail_view,icon:{iconName:"view-big-thb",fontIconFamily:1,fontIconSize:"2x"}},{value:"LargeTiles",label:D.large_tile_view,icon:{iconName:"view-big-tile",fontIconFamily:1,fontIconSize:"2x"}}],position:"far",category:"2"},onNodeUpdate:function(e){t.updateView(e)}};var l={entries:[o,{id:"searchField",dataElements:{typeRepresentation:"string",value:"",placeholder:D.label_search,allowResetToUndefinedByUIFlag:!0,position:"far",category:"2"},onNodeLiveUpdate:function(e,i){t.searchView(e,i)}},{id:"searchBtn",dataElements:{typeRepresentation:"functionIcon",tooltip:D.search_log_Refs,value:function(){t.openSearchField()},icon:{iconName:"search",fontIconFamily:1},position:"far",category:"2"}},s,a],useWebUITooltip:!0};t.toolbarTreeDocument=r.prototype.createTreeDocument(l),t.viewGeneratedToolbar=new r({overflowManagement:"dropdown",direction:"horizontal",items:t.toolbarTreeDocument}),t.viewGeneratedToolbar.inject(i),t.viewGeneratedToolbar.updateNodeModel("searchField",{visibleFlag:!1}),t.visibleFlag=!0},sortUpdate:function(e){var t,i,n=this;e?(t=e.getAttributeValue("data"),i="label2"===t?-1:1):(t="label1",i=1),n.treeDocument.prepareUpdate(),n.treeDocument._getTrueRoot().sortChildren({isRecursive:!0,sortFunction:function(e,n){return i*(e.getSortableAttributeValue(t)<n.getSortableAttributeValue(t)?-1:1)}}),n.treeDocument.pushUpdate()},updateView:function(e){var t,i,n,o=this;"Recents"===(n=widget.getValue("landingPage"))||void 0===n?(t=widget.getValue("recentsCollectionView")?widget.getValue("recentsCollectionView"):"Thumbnails",e&&(t=e.getAttributeValue("data")),i=o.container.querySelector(".fl-recents-container .fl-view-container"),widget.setValue("recentsCollectionView",t)):(t=widget.getValue("myReferencesCollectionView")?widget.getValue("myReferencesCollectionView"):"Thumbnails",e&&(t=e.getAttributeValue("data")),i=o.container.querySelector(".fl-myReferences-container .fl-view-container"),widget.setValue("myReferencesCollectionView",t)),i.empty(),o.collectionView="SmallTiles"===t?new p({displayedOptionalCellProperties:["contextualMenu"]}):"LargeTiles"===t?new g({displayedOptionalCellProperties:["contextualMenu"]}):new u({displayedOptionalCellProperties:["contextualMenu"]}),o.collectionView.inject(i),o.collectionView.loadApplicativeModel(o.treeDocument),o.configureView(o.collectionView)},searchView:function(e,t){this.treeDocument.search({match:function(e){if(t&&-1===e.nodeModel.options.label.indexOf(t))return e.nodeModel.hide(),!0;e.nodeModel.show()}})},openSearchField:function(){var e=this;e.viewGeneratedToolbar.updateNodeModel("searchField",{visibleFlag:e.visibleFlag}),e.visibleFlag=!e.visibleFlag},validateWorkUnder:function(){b.getUserPreferences(I.user_pref_workunder).then((function(e){e&&t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-manage-workUnder",data:{rez:e}})}))},refreshCollectionViewOnItemUpdate:function(e){var t,i=this,n=[];if("Recents"===widget.getValue("landingPage")){if(e.data.authored){if(e.data.authored.deleted){let n=widget.getValue("previouslyOpenedItems");n=n?JSON.parse(n):[],i.treeDocument.prepareUpdate(),e.data.authored.deleted.forEach((function(e){var o=i.treeDocument.getNodesById(e)[0];i.treeDocument.removeRoot(o),t=n.indexOf(e),n.splice(t,1)})),i.treeDocument.pushUpdate(),widget.setValue("previouslyOpenedItems",JSON.stringify(n))}e.data.authored.modified&&(e.data.authored.modified.forEach((function(e){e.key?n.push(e.physicalid):n.push(e)})),y.getObjectAttributes(n).then((function(e){var t=Object.keys(e);i.treeDocument.prepareUpdate();for(let l=0;l<t.length;l++){var n=t[l],o=e[n].attributes,r=o.label+" - "+o.grid.revision;o.grid.type=o.grid.type===I.type_act_advfilter?D.action_adv_filter:o.grid.type;var a=i.createTileSubtitle(o.grid.maturity,o.grid.type,o.grid.owner,o.grid.creationDate,o.grid.modificationDate),s=i.treeDocument.getNodesById(n)[0];s&&(s.options.label=r,s.options.subLabel=a,s.options.maturityState=o.grid.maturity,s.options.owner=o.grid.owner,s.options.creationDate=o.grid.creationDate,s.options.modificationDate=o.grid.modificationDate)}i.treeDocument.pushUpdate()})))}}else"LandingPage"!==widget.getValue("currentView")&&widget.getValue("currentView")||d.alertMessage("info",null,D.msg_authoring_my_logical_references)}}})),define("DS/CATFLCockpitWidget/components/ArchitectureNumber/monoInstantiationStatus",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/config.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n){"use strict";var o=i.getFullConfig();return{downloadStatus:function(i,r,a){var s=this;s.root={id:i},s.container=widget.body;var l=r+"_ArchitectureNumberUnicityInStructure.csv",c={root_physicalid:s.root.id,exportFileName:l};if(a&&a.modelVersion&&a.modelVersion.physicalid){var d=widget.getValue("currentConfig").filterCompiledForm,u=a.modelVersion.name+" "+a.modelVersion.revision;a.pc&&a.pc.physicalid&&(u=u+" "+a.pc.label),c.configFilteringContext={filter_compiledform:d,filter_info:u}}t.post(o.webservices.exportMonoInstantiationStatus,JSON.stringify(c),0).then((function(t){e.downloadFile(l,t,!0),e.alertMessage("success",null,n.msg_arch_unicity_export_success)})).catch((function(t){t&&t.errorResp&&e.alertMessage("error",null,t.errorResp.message)}))}}})),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.toolbar",["UWA/Core","DS/CATFLCockpitWidget/utils/model.events.util","DS/Tweakers/GeneratedToolbar","DS/Controls/TooltipModel","DS/Menu/Menu","DS/CATFLCockpitWidget/components/AttributesManagement/AttributesManagement","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.contextualmenu","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.configure.expand","DS/CATFLCockpitWidget/components/ExportCSV/ExportGridView","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/preferences.util","DS/CATFLCockpitWidget/utils/tooltip.util","DS/CATFLCockpitWidget/utils/SAXTracker","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f){"use strict";let m=d.getFullConfig(),h=m.localStorageKeys,v=m.identifiers,C=p.loadTooltips(["addaction","ngFilter","cuesStatus","attributesManagement","configureExpand","specificFilter","structureFilter","exportGrid","viewSelector"]);var y=function(e,t,i){this.container=e,this.gridView=t,this.modelEvents=i,this.createToolbarOptions(),this.render()};return y.prototype.createToolbarOptions=function(){var e,n=this;n.currentCompView=widget.getValue("component-view");var o=widget.getValue("modelAttached"),a=n.gridView.treeDocument.getRoots()[0],c=n.gridView.treeDocument.getSelectedNodes(),d=!1,u={openFromToolbar:!0,collectionView:n.gridView};o&&(u.bModelAttached=!0,u.modelInfo=widget.getValue("currentConfig")),o&&o.modelVersion&&(o.modelVersion.current===v.state_act_Release||o.modelVersion.current===v.state_act_Obsolete)?d=!0:(!a||a.options.grid.maturity!==v.state_act_Released&&a.options.grid.maturity!==v.state_act_Obsolete)&&(!c||1!==c.length||c[0].options.grid.maturity!==v.state_act_Released&&c[0].options.grid.maturity!==v.state_act_Obsolete)||(d=!0),n.currentCompView===h.structuredView?e="structuredView":n.currentCompView===h.flattenedView?e="flattenedView":n.currentCompView===h.flattenedViewOnlyArchitectureItem&&(e="flattenedViewOnlyArchitectureItem");let p={id:"selectionMenu",dataElements:{typeRepresentation:"functionMenuIconCount",tooltip:"Multiselect",value:{menu:n.getMenuItems()},icon:{iconName:"select-on",fontIconFamily:1},count:1,countLimit:-1,position:"far",category:"1",visibleFlag:!1}},m={id:"addaction",dataElements:{typeRepresentation:"functionMenuIcon",icon:{iconName:"plus",fontIconFamily:1,fontIconSize:"3x"},position:"far",category:"2"},children:[{id:"create-new-logical-ref",dataElements:{typeRepresentation:"PushItem",label:f.action_add_new,action:{callback:n.insertNewLogRef.bind(n,d)}},icon:{iconName:"plus",fontIconFamily:1,fontIconSize:"0.75x"}},{id:"create-existing-ref",dataElements:{typeRepresentation:"PushItem",label:f.action_add_existing,action:{callback:n.insertExistingLogRef.bind(n,d)}},icon:{iconName:"insert",fontIconFamily:1,fontIconSize:"0.75x"}}],disabled:"structured-view"!==n.currentCompView},C={id:"ngFilter",dataElements:{typeRepresentation:"functionIcon",value:function(){n.modelEvents.publish({event:"content-list-view-ngFilter-open"})},icon:{iconName:"filter",fontIconFamily:1,fontIconSize:"0.75x"},position:"far",category:"2",disabled:!0}},y={id:"cues-status",dataElements:{typeRepresentation:"functionMenuIcon",icon:{iconName:"dataflow-input-output",fontIconFamily:1},position:"far",category:"2",disabled:!0},children:[{id:"compute-cues",dataElements:{typeRepresentation:"PushItem",label:f.action_compute_cues,action:{callback:function(){g.trackCommandLaunched("computeConvergenceStates-sax"),n.modelEvents.publish({event:"content-list-view-validate-cues"})}},icon:{iconName:"compute",fontIconFamily:1,fontIconSize:"0.75x"}}},{id:"clear-cues",dataElements:{typeRepresentation:"PushItem",label:f.action_clear_cues,action:{callback:function(){g.trackCommandLaunched("clearConvergenceStates-sax"),n.modelEvents.publish({event:"content-list-view-clear-cues"})}},icon:{iconName:"clear",fontIconFamily:1,fontIconSize:"0.75x"}}},{id:"export-cues",dataElements:{typeRepresentation:"PushItem",label:f.action_export_cues,action:{callback:function(){g.trackCommandLaunched("exportConvergenceStates-sax"),n.modelEvents.publish({event:"content-list-view-export-cues"})}},icon:{iconName:"export",fontIconFamily:1,fontIconSize:"0.75x"}}}]},b={id:"attributes-management",dataElements:{typeRepresentation:"functionIcon",value:function(){new r},icon:{iconName:"attributes",fontIconFamily:1,fontIconSize:"3x"},position:"far",category:"2"}},_={id:"configure-expand",dataElements:{typeRepresentation:"functionIcon",value:function(){g.trackCommandLaunched("configureExpand-sax"),new s({}).render(n)},icon:{iconName:"flow-tree-expand-down-cog",fontIconFamily:1,fontIconSize:"0.75x"},position:"far",category:"2"}},w={id:"viewSwitcher",dataElements:{typeRepresentation:"icon",icon:{iconName:"tree-table",fontIconFamily:1},value:e,possibleValues:[{value:"structuredView",label:f.action_structured,icon:{iconName:"tree-table",fontIconFamily:1}},{value:"flattenedView",label:f.replace(f.action_flattened,{levelCnt:parseInt(widget.getPreference(h.depthFlattenedView).value,10)}),icon:{iconName:"table",fontIconFamily:1}},{value:"flattenedViewOnlyArchitectureItem",label:f.replace(f.action_flattened_arch,{levelCnt:parseInt(widget.getPreference(h.depthFlattenedViewArchitectureItemOnly).value,10)}),icon:{iconName:"table",fontIconFamily:1}}],position:"far",category:"3"},onNodeUpdate:function(e){n.viewSwitcherUpdate(e)}},D={id:"exportGrid",dataElements:{typeRepresentation:"functionIcon",value:function(){l.exportgridViewCSV(n.gridView)},icon:{iconName:"export-to-csv",fontIconFamily:1,fontIconSize:"3x"},position:"far",category:"2",disabled:widget.getValue("groupingEnabled")}};n.gridView.options.currentSpecificFilterUI="noSpecificFilter",n.gridView.options.currentStructureFilterUI=widget.getValue(h.structureFilter)||"filterDefaultStructure";var S={entries:[p,m,C,{id:"specificFilter",dataElements:{typeRepresentation:"icon",value:n.gridView.options.currentSpecificFilterUI,possibleValues:[{value:"noSpecificFilter",label:f.action_no_filter,icon:{iconName:"filter-add",fontIconFamily:1}},{value:"filterAllDisciplines",label:f.action_discipline_filter,icon:{iconName:"filter-add",fontIconFamily:1}},{value:"filterPilotingDisciplines",label:f.action_piloting_discipline_filter,icon:{iconName:"filter-add",fontIconFamily:1}},{value:"filterProposedSolutions",label:f.action_proposed_solutions_filter,icon:{iconName:"filter-add",fontIconFamily:1}}],position:"far",category:2,visibleFlag:!0,disabled:!0},onNodeUpdate:function(e){n.specificFilterFun(e)}},y,b,_,D,{id:"structureFilter",dataElements:{typeRepresentation:"icon",value:n.gridView.options.currentStructureFilterUI,possibleValues:[{value:"filterDefaultStructure",label:f.action_default_structure_filter,icon:{iconName:"flow-cascade",fontIconFamily:1}},{value:"alwaysShowCategories",label:f.action_show_categories_filter,icon:{iconName:"flow-children-eye",fontIconFamily:1}},{value:"alwaysHideCategories",label:f.action_hide_categories_filter,icon:{iconName:"flow-children-eye-off",fontIconFamily:1}}],position:"far",category:3,visibleFlag:!0,disabled:!0},onNodeUpdate:function(e){n.structureFilterFun(e)}},w],currentView:n.currentCompView,modelEvents:n.modelEvents,useWebUITooltip:!0};n.toolbarTreeDocument=i.prototype.createTreeDocument(S),n._setToolbarBtnTooltip("addaction","addaction"),n._setToolbarBtnTooltip("ngFilter","ngFilter"),n._setToolbarBtnTooltip("cues-status","cuesStatus"),n._setToolbarBtnTooltip("attributes-management","attributesManagement"),n._setToolbarBtnTooltip("configure-expand","configureExpand"),n._setToolbarBtnTooltip("specificFilter","specificFilter"),n._setToolbarBtnTooltip("structureFilter","structureFilter"),n._setToolbarBtnTooltip("exportGrid","exportGrid"),n._setToolbarBtnTooltip("viewSwitcher","viewSelector"),n.modelEvents.subscribe({event:"wux-generated-toolbar-multiselect-icon-update-count"},n.updateCountOfMultiSelect.bind(n)),n.modelEvents.subscribe({event:"content-list-view-refresh-complete"},n.enableDisableFilterCues.bind(n)),n.modelEvents.subscribe({event:"content-list-view-grouping-status-change"},n.enableDisableExportGrid.bind(n)),t.getFLWebModelEventsObj("flweb-model-events").subscribe({event:"flweb-ngfilter-applied"},n.resetFilters.bind(n))},y.prototype._setToolbarBtnTooltip=function(e,t){var i=this;C.then((function(n){t&&i.myGeneratedToolbar&&i.myGeneratedToolbar.updateNodeModel(e,{tooltip:n[t]})}))},y.prototype.insertNewLogRef=function(e){this.gridView.treeDocument.getSelectedNodes().length>0&&e?c.alertMessage("error",null,"",f.error_additem_in_release):this.modelEvents.publish({event:"create-new-logical-item"})},y.prototype.insertExistingLogRef=function(e){this.gridView.treeDocument.getSelectedNodes().length>0&&e?c.alertMessage("error",null,"",f.error_additem_in_release):this.modelEvents.publish({event:"content-view-add-existing-item"})},y.prototype.viewSwitcherUpdate=function(e){var t,i=this,n=e.getAttributeValue("data");e._options.disabled||("structuredView"===n?t="structured-view":"flattenedView"===n?t="flattened-view":"flattenedViewOnlyArchitectureItem"===n&&(t="flattend-view-only-architecture-item"),t!==i.currentCompView&&(widget.setValue(h.componentView,t),i.currentCompView=t,i.modelEvents.publish({event:"content-list-view-refresh"}),"structured-view"===t?i.myGeneratedToolbar.updateNodeModel("addaction",{disabled:!1}):i.myGeneratedToolbar.updateNodeModel("addaction",{disabled:!0}))),i.setConfigureExpandButtonActiveState()},y.prototype.updateCountOfMultiSelect=function(e){var t=this;if(t.multiSelEvt||(t.myGeneratedToolbar.elements.farContainer.querySelector(".wux-ui-style-smartIcon.arrow-icon.wux-tweaker-function-displaycount").addEventListener("click",(function(e){var i={openFromToolbar:!0,collectionView:t.gridView};widget.getValue("modelAttached")&&(i.bModelAttached=!0,i.modelInfo=widget.getValue("currentConfig")),o.show(a.getMenu(i,t.modelEvents),{input:"mouse",position:{x:e.pageX,y:e.pageY},submenu:"auto"})})),t.multiSelEvt=!0),0===e?t.myGeneratedToolbar.updateNodeModel("selectionMenu",{visibleFlag:!1}):t.myGeneratedToolbar.updateNodeModel("selectionMenu",{visibleFlag:!0,count:e}),"structured-view"!==widget.getValue(h.componentView)||e>1)t.myGeneratedToolbar.updateNodeModel("addaction",{disabled:!0});else if(1===e){let e=t.gridView.treeDocument.getSelectedNodes()[0];t.myGeneratedToolbar.updateNodeModel("addaction",{disabled:"L"!==e.options.grid.kindOfRFLP||"implementLinksCategory"===e.getParent().options.type})}else t.myGeneratedToolbar.updateNodeModel("addaction",{disabled:!1})},y.prototype.enableDisableFilterCues=function(){var e=this;e._firstRefreshComplete||(e.myGeneratedToolbar.updateNodeModel("ngFilter",{disabled:!1}),e.myGeneratedToolbar.updateNodeModel("cues-status",{disabled:!1}),e.myGeneratedToolbar.updateNodeModel("specificFilter",{disabled:!1}),e.myGeneratedToolbar.updateNodeModel("structureFilter",{disabled:!1}),e._firstRefreshComplete=!0),e.managePreviousFiltersApplied(!0),u.getUserCustomViews().then((function(t){t&&t.customViews&&e.gridView.getCustomViewsManager().setCustomViews(t.customViews,t.currentCustomViewIdentifier,!0)}))},y.prototype.setConfigureExpandButtonActiveState=function(e){let t=widget.getValue("component-view"),i=e||widget.getValue("configurable_expand"),n=this.myGeneratedToolbar.elements.farContainer.querySelector(".wux-button-icon-fi.wux-ui-genereatedicon-fi.wux-ui-3ds.wux-ui-3ds-flow-tree-expand-down-cog.wux-ui-3ds");t===h.structuredView&&Object.keys(i).length<6||t!==h.structuredView&&(!i.proposedSolution||!i.specDocs)?n.addClassName("active"):n.removeClassName("active")},y.prototype.specificFilterFun=function(e){var t=this;let i=widget.getValue("configurable_expand"),n=widget.getValue("component-view"),o=null;var r=e.getAttributeValue("data");if("noSpecificFilter"===r)t.activeIconSpecFilter(!1),o="noFilter",t.gridView.options.currentSpecificFilterUI=r,t._firstRefreshComplete&&!t.onlyUI&&t.gridView.options&&"filterDefaultStructure"!==t.gridView.options.currentStructureFilterUI&&t.selectToolbarItemInMenu("structureFilter","filterDefaultStructure",!0);else{if("filterAllDisciplines"===r){if("structured-view"!==n)return c.alertMessage("error",null,f.error_specific_filter_flattened_view),void t.selectToolbarItemInMenu("specificFilter",t.gridView.options.currentSpecificFilterUI,!0);if(!i.implementing||!i.isImplementing)return c.alertMessage("error",null,f.error_filter_missing_implementing_isImplementing),void t.selectToolbarItemInMenu("specificFilter",t.gridView.options.currentSpecificFilterUI,!0);o="Disciplines"}else if("filterPilotingDisciplines"===r){if("structured-view"!==n)return c.alertMessage("error",null,f.error_specific_filter_flattened_view),void t.selectToolbarItemInMenu("specificFilter",t.gridView.options.currentSpecificFilterUI,!0);if(!i.implementing)return c.alertMessage("error",null,f.error_filter_missing_implementing),void t.selectToolbarItemInMenu("specificFilter",t.gridView.options.currentSpecificFilterUI,!0);o="PilotingDisciplines"}else if("filterProposedSolutions"===r){if(!i.proposedSolution)return c.alertMessage("error",null,f.error_filter_missing_solutions),void t.selectToolbarItemInMenu("specificFilter",t.gridView.options.currentSpecificFilterUI,!0);o="ProposedSolutions"}t.activeIconSpecFilter(!0),t.gridView.options.currentSpecificFilterUI=r,!t.onlyUI&&t.gridView.options&&"alwaysShowCategories"!==t.gridView.options.currentStructureFilterUI&&t.selectToolbarItemInMenu("structureFilter","alwaysShowCategories",!0)}!t.onlyUI&&o&&t.modelEvents.publish({event:"content-list-view-apply-specific-filter",data:{filterName:o}}),t.onlyUI=!1},y.prototype.selectToolbarItemInMenu=function(e,t,i){let n=this.myGeneratedToolbar.getNodeModelByID(e);n&&(this.onlyUI=i,n.setAttribute("data",t))},y.prototype.activeIconSpecFilter=function(e){var t=this.myGeneratedToolbar.elements.farContainer.querySelector(".wux-button-icon-fi.wux-ui-genereatedicon-fi.wux-ui-3ds.wux-ui-3ds-filter-add.wux-ui-3ds-lg");t&&(e?t.addClassName("active"):t.removeClassName("active"))},y.prototype.structureFilterFun=function(e){var t=this;let i=null;if(!e._options.disabled){var n=e.getAttributeValue("data");"filterDefaultStructure"===n?i="noFilter":"alwaysShowCategories"===n?i="StructureShowingCategory":"alwaysHideCategories"===n&&(i="StructureHidingCategory"),t.gridView.options.currentStructureFilterUI=n,widget.setValue(h.structureFilter,n),!t.onlyUI&&i&&t.modelEvents.publish({event:"content-list-view-apply-specific-filter",data:{filterName:i,toFocus:!0}}),!t.onlyUI&&t.gridView.options&&"noSpecificFilter"!==t.gridView.options.currentSpecificFilterUI&&t.selectToolbarItemInMenu("specificFilter","noSpecificFilter",!0)}t.onlyUI=!1},y.prototype.render=function(){var e=this;e.container.empty(),e.myGeneratedToolbar=new i({overflowManagement:"dropdown",direction:"horizontal",items:e.toolbarTreeDocument}),e.myGeneratedToolbar.inject(e.container,"top"),setTimeout((function(){y.prototype.tooltipOfDisabled=function(){var t;t={title:"Structured View icon is disabled because group By is applied"},e.myGeneratedToolbar.updateNodeModel("viewSwitcher",{tooltip:t})}}),200)},y.prototype.getMenuItems=function(){if(this.gridView.treeDocument.getSelectedNodes().length<=0)return[]},y.prototype.enableDisableExportGrid=function(){widget.getValue("groupingEnabled")?this.myGeneratedToolbar.updateNodeModel("exportGrid",{disabled:!0}):this.myGeneratedToolbar.updateNodeModel("exportGrid",{disabled:!1})},y.prototype.resetFilters=function(){this.modelEvents.publish({event:"content-list-view-clearFilterModels"}),this.managePreviousFiltersApplied(!0)},y.prototype.managePreviousFiltersApplied=function(e){var t=this;if(t.gridView.options)if("noSpecificFilter"!==t.gridView.options.currentSpecificFilterUI)t.selectToolbarItemInMenu("specificFilter","noSpecificFilter");else if("filterDefaultStructure"!==t.gridView.options.currentStructureFilterUI)if(e){let e="noFilter";"alwaysShowCategories"===t.gridView.options.currentStructureFilterUI?e="StructureShowingCategory":"alwaysHideCategories"===t.gridView.options.currentStructureFilterUI&&(e="StructureHidingCategory"),t.modelEvents.publish({event:"content-list-view-apply-specific-filter",data:{filterName:e}})}else t.selectToolbarItemInMenu("structureFilter","filterDefaultStructure")},y})),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.controller",["UWA/Core","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/UIKIT/Mask","DS/DataGridView/DataGridView","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgData","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.toolbar","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.contextualmenu","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.columns","DS/CATFLCockpitWidget/components/ContentListView/decorators/contentlistview.dragdrop","DS/CATFLCockpitWidget/components/ContentListView/decorators/contentlistview.cues","DS/CATFLCockpitWidget/components/ContentListView/decorators/contentlistview.filterModel","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/preferences.util","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/mixins/CATFLBIFilter","DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/dimensions.service","DS/CATFLCockpitWidget/components/CreateLogicalItemModal/CreateLogicalItemHelper","DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment","DS/Utilities/Utils","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/widgetlink.util","DS/PlatformAPI/PlatformAPI","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f,m,h,v,C,y,b,_,w,D,S,I,A,F,k,E,x,T,L){"use strict";var N=A.getFullConfig(),M=N.identifiers;return{init:function(i){var n=this;n.modelEvents=h.createAppEventObject("flcockpit-content-list-view");var r=h.getFLWebModelEventsObj("flweb-model-events");r.subscribe({event:"allmod-selection-successful"},n.viewNonFilteredContent.bind(n)),r.subscribe({event:"mod-PC-selection-successful"},n.modelPCSelected.bind(n)),r.subscribe({event:"mod-selection-removed"},n.viewNonFilteredContent.bind(n));var a=e.createElement("div",{class:"fl-cockpit-toolbar-container"});return i.appendChild(a),n.contentViewContainer=document.createElement("div"),n.contentViewContainer.classList.add("fl-cockpit-data-grid-view-container"),n.contentView=new o({identifier:"SystemArchitectureRelease_ContentView",height:"inherit",treeDocument:new t({useAsyncPreExpand:!0}),selectionBehavior:{unselectAllOnEmptyArea:!1},showNodeKPIColorFlag:!0,rowDragEnabledFlag:!0,cellDragEnabledFlag:!0,defaultColumnDef:{typeRepresentation:"string",width:"auto"},rowGroupingOptions:{depth:1,hideGroupedColumns:!1},onContextualEvent:function(e){if(e.cellInfos){if(e.cellInfos&&-1===e.cellInfos.rowID)return e.collectionView.buildDefaultContextualMenu(e);widget.getValue("modelAttached")&&(e.bModelAttached=!0,e.modelInfo=widget.getValue("currentConfig")),e.cellInfos.nodeModel.isSelected()||(e.collectionView.treeDocument.unselectAll(),e.cellInfos.nodeModel.select());var t=e.collectionView.treeDocument.getSelectedNodes();return t.length>1?c.getMenu(e,n.modelEvents):1===t.length?_.getTypeHierarchy(t[0].options.grid.actualType).then((function(i){return F.getOpenWithCompatibleApps(t[0],i).then((function(t){return c.getMenu(e,n.modelEvents,t)}))})):void 0}},getCellTooltip:function(e){return e.nodeModel&&0===e.columnID&&e.nodeModel._options.grid.titleTooltip?{shortHelp:e.nodeModel._options.grid.titleTooltip,updateModel:!1}:e.nodeModel&&1===e.columnID&&e.nodeModel._options.grid.cueTooltip?{shortHelp:e.nodeModel._options.grid.cueTooltip,updateModel:!1}:e.nodeModel&&7===e.columnID&&e.nodeModel._options.grid.lockTooltipRef?{shortHelp:e.nodeModel._options.grid.lockTooltipRef,updateModel:!1}:e.nodeModel&&16===e.columnID&&e.nodeModel._options.grid.lockTooltipIns?{shortHelp:e.nodeModel._options.grid.lockTooltipIns,updateModel:!1}:n.contentView.getCellDefaultTooltip(e)}}),x.subscribeToFindEvent(n.contentView),u.getDataGridViewColumns(n.contentView).then((function(e){n.contentView.onDelayedModelDataRequest=I.debounce(n.getDelayedModelData.bind(n),200),n.contentView.columns=e,p.addDragAndDropBehaviorToContentView.call(n),g.addConvergenceCuesListeners(n),n.customViewsManager=n.contentView.getCustomViewsManager(),n.customViewsManager.onCustomViewsSave=n.onCustomViewsSave.bind(n),n.customViewsManager.showCustomViewsDialog(),n.customViewsManager._customViewsDialog.visibleFlag=!1,new l(a,n.contentView,n.modelEvents),n.setPADContext(),n.contentView.inject(n.contentViewContainer),i.appendChild(n.contentViewContainer),n.modelEvents.subscribe({event:"content-list-view-ngFilter-open"},(function(){N.disableIndexAcceleration?F.alertMessage("warning",null,L.warn_filter_only_indexed_mode):b.init("NGFilterCmd",{viewController:n})})),n.modelEvents.subscribe({event:"create-new-logical-item"},(function(e){require(["DS/CATFLCockpitWidget/utils/SAXTracker"],(function(e){e.trackCommandLaunched("createNewLogRef-sax")})),D.createNewLogicalItem({data:e,treeDocument:n.contentView.treeDocument})})),n.modelEvents.subscribe({event:"content-view-add-existing-item"},(function(){var e;e=0===n.contentView.treeDocument.getSelectedNodes().length?n.contentView.treeDocument.getRoots()[0]:n.contentView.treeDocument.getSelectedNodes()[0],d.addExistingItem(e,n.contentViewContainer,n.contentView.treeDocument)})),n.modelEvents.subscribe({event:"content-list-view-refresh"},(function(e){if(null!=e)n.refresh(e.itemID,e.expandFilterBinary);else{var t=widget.getValue("currentConfig");t&&t.filterCompiledForm?n.refresh(null,t.filterCompiledForm):n.refresh()}n.contentView.reapplySortModel()})),n.modelEvents.subscribe({event:"content-list-view-refresh-columns"},(function(e){u.getDataGridViewColumns(n.contentView).then((function(t){n.contentView.columns=t,n.contentView.layout.applyColumns(),e.refreshView&&n.modelEvents.publish({event:"content-list-view-refresh"})}))})),n.modelEvents.subscribe({event:"refresh-nodes-by-id"},k.refreshNodeDetails.bind(n)),n.modelEvents.subscribe({event:"refresh-inst-by-id"},k.refreshInstDetailsonNode.bind(n)),n.modelEvents.subscribe({event:"refresh-spaces-by-id"},k.refreshSpacesonNode.bind(n)),n.modelEvents.subscribe({event:"refresh-solutions-by-id"},k.refreshSolutionsonNode.bind(n)),n.modelEvents.subscribe({event:"refresh-documents-by-id"},k.refreshDocumentsOnNodes.bind(n)),n.modelEvents.subscribe({event:"refresh-refLinks-by-id"},k.refreshReferenceLinksOnNodes.bind(n)),n.modelEvents.subscribe({event:"remove-items-from-category"},k.removeItemsFromCatogry.bind(n)),n.modelEvents.subscribe({event:"refresh-items-on-replace"},k.refreshNodesOnReplace.bind(n)),n.contentView.addEventListener("click",n.manageClickInGridView.bind(n)),n.contentView.sortModel=[{dataIndex:"tree",sort:"asc"}],widget.subscribedToAuthoringInItemPage||(T.subscribe("DS/PADUtils/PADCommandProxy/refresh",n.refreshGridViewOnItemUpdate.bind(n)),widget.subscribedToAuthoringInItemPage=!0),widget.subscribeToClassAttr||(T.subscribe("ClassificationAttributeUpdate",n.updateClassIfAttrs.bind(n)),widget.subscribeToClassAttr=!0),T.subscribe("Lifecycle.Modification",(function(e){var t=JSON.parse(e);if(t&&t.Refresh&&t.Refresh.created&&t.Refresh.created.length>0){let e=[];for(var i=0;i<t.Refresh.created.length;i++)e.push(t.Refresh.created[i].sourceObjectId);n.refreshGridViewOnItemUpdate({data:{authored:{modified:e}}})}if(t&&t.Refresh&&t.Refresh.modified&&t.Refresh.modified.length>0){var o=null;if("function"==typeof s.getConfigurationRevisionDetails){let e=s.getConfigurationRevisionDetails().configurationRevision;e&&e.configRevision&&(o=e.configRevision[0].id)}if(o){let e=[];for(let i=0;i<t.Refresh.modified.length;i++)t.Refresh.modified[i].policy===M.policy_Configured_Baseline&&e.push(t.Refresh.modified[i].physicalid);if(e.indexOf(o)>=0){let e=widget.getValue("currentOpenedItem");n.catflBIFilter._biFilter.resetNGFilterUI({appId:widget.id,widgetId:widget.id,rootIds:[e]}),n.catflBIFilter._biFilter.removeRoot(e);let t={filterRootIds:[e],empty:!0,filterName:""};F.alertMessage("warning",null,L.warn_clear_filter_CRMaturity),n.catflBIFilter._biFilter.dispatchEvent("ApplyNGFilter",t)}}}}))})),n},setPADContext:function(){var e=this;require(["DS/PADUtils/PADContext"],(function(t){e.contentView.getEditMode=function(){return!0},e.contentView.getPADTreeDocument=function(){return e.contentView.getTreeDocument()},e.contentView.getSelectedNodes=function(){let t=C.getSelectedNodes();return t&&0!==t.length||(t=e.contentView.getTreeDocument().getSelectedNodes(),t&&0!==t.length||(t=[e.contentView.getTreeDocument().getRoots()[0]])),t},e.contentView.displayNotification=function(e){"error"===e.eventID||"warning"===e.eventID?F.alertMessage("error",null,e.msg||e):F.alertMessage("success",null,e.msg||e)},e.contentView.getSecurityContext=function(){return{SecurityContext:"ctx::"+A.getSecurityContext()}},e.contentView.getRoots=function(){return e.contentView.getTreeDocument().getRoots()},t.set(e.contentView)}))},onCustomViewsSave:function(e,t){let i=this.contentView.getCustomViewsManager(),n=!!i.getCurrentCustomView()&&i.getCurrentCustomView().groupingOptions;widget.setValue("groupingEnabled",!!n),v.saveUserCustomViews(e,t);let o=this.contentView.getTreeDocument().getRoots()[0];o&&!o._isExpanded&&(o.expand(),v.getUserCustomViews().then((function(e){e&&e.customViews&&i.setCustomViews(e.customViews,e.currentCustomViewIdentifier,!0)}))),this.modelEvents.publish({event:"content-list-view-grouping-status-change"})},manageClickInGridView:function(e,t){var i=this;if(t&&t.nodeModel&&t.columnID&&!(t.columnID<0)){var n="L"===t.nodeModel.options.grid.kindOfRFLP,o=t.nodeModel.getParent().options.type===M.type_spec_document,s="DIF"===t.nodeModel.options.grid.kindOfRFLP,l=t.nodeModel.options.virtual;if(n||o||s){var c=i.contentView.columns[t.columnID].dataIndex,u=e.target.className,p=widget.getValue("currentConfig"),g=i.contentView.treeDocument.getRoots()[0],f=!1;if(p&&p.modelVersion&&(p.modelVersion.current===M.state_act_Release||p.modelVersion.current===M.state_act_Obsolete)?f=!0:(!g||g.options.grid.maturity!==M.state_act_Released&&g.options.grid.maturity!==M.state_act_Obsolete)&&("VariantEffectivity"===c||t.nodeModel.options.grid.maturity!==M.state_act_Released&&t.nodeModel.options.grid.maturity!==M.state_act_Obsolete)||(f=!0),"cue"===c){if(M.clickable_cue_icons.some((function(e){return u.indexOf(e)>=0}))){var m=h.getFLWebModelEventsObj("flweb-model-events"),v={};v.rootID=i.contentView.treeDocument.getRoots()[0].options.physicalid,v.instanceID=t.nodeModel._options.instance.physicalid,v.instParentID=t.nodeModel._options.physicalid,v.instParentTitle=t.nodeModel._options.label+" "+t.nodeModel._options.grid.revision,v.nodeModel=t.nodeModel,m.publish({event:"flcockpit-convergence-cues-actions",data:v})}}else if("revision"===c&&n&&!l){var y=[{physicalid:t.nodeModel.options.physicalid,label:t.nodeModel.options.label,type:t.nodeModel.options.type,displayType:t.nodeModel.options.grid.type,revision:t.nodeModel.options.grid.revision,current:t.nodeModel.options.grid.maturity,icons:t.nodeModel.options.icons}];b.init("HistoryCommand",y)}else if("maturity"===c&&(!l||o||l&&n&&t.nodeModel.options.linkInfo&&"implementing"===t.nodeModel.options.linkInfo.linkType&&"ref"===t.nodeModel.options.linkInfo.objType||l&&s))b.init("MaturityCommand",[{physicalid:t.nodeModel.options.physicalid,label:t.nodeModel.options.label}]);else if("owner"===c&&(!l||o||l&&n&&t.nodeModel.options.linkInfo&&"implementing"===t.nodeModel.options.linkInfo.linkType&&"ref"===t.nodeModel.options.linkInfo.objType||l&&s))b.init("ChangeOwnerCommand",[{physicalid:t.nodeModel.options.physicalid,type:t.nodeModel.options.type,label:t.nodeModel.options.label,displayType:t.nodeModel.options.grid.type,revision:t.nodeModel.options.grid.revision,owner:t.nodeModel.options.grid.owner,icons:t.nodeModel.options.icons}]);else if(n&&!l&&"architectureNumber"===c){if(f)return void F.alertMessage("error",null,"",L.error_authOperations_in_release);d.setArchitectureNumber([t.nodeModel])}else if(n&&!l&&"assignedSpaces"===c){if(f)return void F.alertMessage("error",null,"",L.error_authOperations_in_release);new S(t.nodeModel)}else if(n&&!l&&N.gridview.additionalColumnsModules&&e.dsModel.layout.getColumnOptionValue(t.columnID,"isAdditionalColumn")){let n=e.dsModel.layout.getColumnOptionValue(t.columnID,"columnModule"),o=N.gridview.additionalColumnsModules[n]||{},s=o.getOnCellClickCB;if(s){var _=s.call(o,c);_&&("VariantEffectivity"===c?(t.nodeModel.options.grid["ds6w:label-Instance"]=t.nodeModel.options.grid.instanceName,window.cfgCmdWidgetData={_isDecouplingActivated:!0,_isConfigAvailable:!0},r.checkDecouplingActivation().then((function(e){e&&!1===e.isEditVariantEnabled?a.isEditVariantEnabled=!1:a.isEditVariantEnabled=!0})).catch((function(){a.isEditVariantEnabled=!0})).finally((function(){_(t)}))):(C.resetSelection(),i.contentView.getTreeDocument().unselectAll(),t.nodeModel.select(),t.nodeModel.getParent()&&!t.nodeModel.getParent()._isTrueRoot()&&(t.nodeModel.options.from=t.nodeModel.getParent().options.physicalid),_(t)))}}else if(n&&!l&&("isReserved"===c||"instance_isReserved"===c&&!t.nodeModel.isRoot())){let e=[],i=t.nodeModel.options.instance,n=t.nodeModel.options.actualParent;e.push({physicalid:t.nodeModel.options.physicalid,label:t.nodeModel.options.label,type:t.nodeModel.options.type,relID:i&&i.physicalid?i.physicalid:"",instanceName:t.nodeModel.options.grid.instanceName,parent:{physicalid:n&&n.options?n.options.physicalid:""}});let o="isReserved"===c?t.nodeModel.options.isReserved:t.nodeModel.options.instance_isReserved;return void(o&&"FALSE"!==o?b.init("UnreserveCmd",e):b.init("ReserveCmd",e))}}}},getDelayedModelData:function(t){let i,n,o,r,a,s=this,l=t.collectionView,c=l.treeDocument,d=l.layout.columns,u=widget.getValue("ngFilter");if(t.displayedColumnsIndexes.length>0){t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("assignedSpaces"))>=0&&(i=!0),(t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("Effectivity"))>=0||t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("VariantEffectivity"))>=0||t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("CurrentEvolutionEffectivity"))>=0||t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("ProjectedEvolutionEffectivity"))>=0)&&(n=!0),(t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("ConfigurationContext"))>=0||t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("RevisionMaster"))>=0||t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("RevisionMode"))>=0)&&(o=!0),t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("ConfigurationRevision"))>=0&&(a=!0,u&&u.length>0&&(r=!0));let f={},m=F.getUserCustomAttributes()||[],h=F.getUserCustomAttributes(!0)||[],v=m.concat(h);v&&v.forEach((function(e){e.isOnPhysicalProduct?f["physical_"+e.curi]=e:e.bo?f[e.curi]=e:f["instance_"+e.curi]=e}));let C=[],y=Object.keys(f),b={},_=[],D={};t.displayedColumnsIndexes.forEach((function(e){if(d[e]&&y.indexOf(d[e].dataIndex)>=0){let t=f[d[e].dataIndex],i=t.dimension+"_"+t.manipulationUnit;t.manipulationUnit&&t.manipulationUnit!==N.dimensions[t.dimension].MKSUnit?(C.push(d[e].dataIndex),b[i]||(b[i]=[]),b[i].push(d[e].dataIndex),D[i]={UnitFrom:N.dimensions[t.dimension].MKSUnit,UnitTo:t.manipulationUnit,Dimension:t.dimension,Values:[]}):t.manipulationUnit&&_.push(d[e].dataIndex)}}));let S=[],I=[],A={},k=[],x=[],T={},V={},O=[],R=[],P=[];for(let e=t.startNodeIndex;e<=t.endNodeIndex;e++){let t=l.model[e];if(t){M.type_act_logref===t.options.type&&(i&&!t.options.assignedSpacesPID&&R.push(t),(o&&!t.options.grid.ConfigurationContext&&!t.options.linkInfo||o&&!t.options.grid.RevisionMaster&&!t.options.linkInfo||o&&!t.options.grid.RevisionMode&&!t.options.linkInfo)&&O.push(t.options.physicalid),n&&t.options.instance&&!t.options.grid.Effectivity&&(S.push(t.options.instance.physicalid),I.push(t.options.physicalid),A[t.options.instance.physicalid]=t),r?(t.options.instance&&(T[t.options.physicalid]=t.options.instance.physicalid,k.push(t.options.instance.physicalid)),x.push(t.options.physicalid),V[t.options.physicalid]=t):a&&t.updateOptions({grid:{ConfigurationRevision:""}}));let e=!1;C.forEach((function(i){if((!t.options.grid[i]||t.options.grid[i].length<=0)&&t.options.grid[i+"_actual"]){let n=t.options.grid[i+"_actual"]||0;e=!0;let o=f[i],r=D[o.dimension+"_"+o.manipulationUnit];o.multiValuated||Array.isArray(n)?n.forEach((e=>{r.Values.indexOf(e)<0&&r.Values.push(e)})):r.Values.indexOf(n)<0&&r.Values.push(n)}})),e&&P.push(t),_.forEach((function(e){var i=t.options.grid[e+"_actual"];i&&t.setAttribute(e,i)}))}}let W=[];if(R.length>0&&W.push(E.addAssignedSpacesAttribute(R)),O.length>0){var p={relids:[],pids:O},g=N.gridview.additionalColumnsModules.cfgContext;g&&W.push(new Promise((function(t,i){g.updateAttributes(p,(function(n){var o=e.is(n,"string")?JSON.parse(n):n;t(o),i("Error in Cfg_updateAttributes")}),s)})).then((function(e){let t=e?e.pids:{};c.withTransactionUpdate((function(){O.forEach((function(e){c.getMappedNodesFromId(e).forEach((function(i){let n={grid:{ConfigurationContext:t[e].ConfigurationContext,RevisionMaster:t[e].RevisionMaster,RevisionMode:t[e].RevisionMode}};i.updateOptions(n)}))}))}))})))}if(S.length>0){let t={relids:S,pids:I},i=N.gridview.additionalColumnsModules.cfgEffectivty;i&&W.push(new Promise((function(n,o){i.updateAttributes(t,(function(t){var i=e.is(t,"string")?JSON.parse(t):t;n(i),o("Error in Cfg_updateAttributes")}),s)})).then((function(e){let t=e?e.relids:{};c.withTransactionUpdate((function(){S.forEach((function(e){var i=A[e],n=t[e];n&&(n.VariantEffectivity.trim()||(n.VariantEffectivity=L.label_none),i.updateOptions({grid:n}))}))}))})))}if(x.length>0||k.length>0){let t={pids:x,relids:k,pairs:T},i=N.gridview.additionalColumnsModules.ConfigurationRevision;i&&W.push(new Promise((function(n,o){i.updateAttributes(t,(function(t){var i=e.is(t,"string")?JSON.parse(t):t;n(i),o("Error in CfgRev_updateAttributes")}),s)})).then((function(e){let t=e?e.pids:{};Object.keys(t).length>0&&c.withTransactionUpdate((function(){x.forEach((function(e){var i=V[e],n=t[e]?t[e].ConfigurationRevision:"";i.updateOptions({grid:{ConfigurationRevision:n}})}))}))})))}if(C.length>0&&P.length>0){for(let e in D)if(D[e].Values.length<=0){delete D[e];let t=b[e];for(let e of t)C.splice(C.indexOf(e),1)}W.push(w.convertValues(Object.values(D)).then((function(t){let i={},n=Object.keys(D);t.Response&&(t.Response.forEach((function(t,o){let r={},a=e.is(t.ValuesToConvert,"string")?t.ValuesToConvert.split(";"):t.ValuesToConvert,s=e.is(t.ConvertedValues,"string")?t.ConvertedValues.split(";"):t.ConvertedValues;a.forEach((function(e,t){r[e]=s[t]})),i[n[o]]=r})),P.forEach((function(e){C.forEach((function(t){let n=f[t];if(e.options.grid[t+"_actual"])if(n.multiValuated||Array.isArray(e.options.grid[t+"_actual"])){var o=[];e.options.grid[t+"_actual"].forEach((e=>{let t=i[n.dimension+"_"+n.manipulationUnit][e];t&&o.push(t)})),o.length>0&&e.setAttribute(t,o)}else{let o=i[n.dimension+"_"+n.manipulationUnit][e.options.grid[t+"_actual"]];o&&e.setAttribute(t,o)}}))})))})))}W.length>0&&Promise.all(W)}},refreshGridViewOnItemUpdate:function(t){let n=this,o=[],r=[],a={},s=!1,l=!0;if(t.data.authored){let c=n.contentView.treeDocument.getRoots(),d=n.contentView.treeDocument.getSelectedNodes();if(c&&c.length>0){let u=c[0].options.physicalid;if(t.data.authored.deleted){let e=widget.getValue("previouslyOpenedItems"),i=widget.getValue("currentlyOpenedItems"),n=widget.getValue("currentlyClosedItems");if(e=e?JSON.parse(e):[],i=i?JSON.parse(i):[],n=n?JSON.parse(n):[],t.data.authored.deleted.forEach((function(t){let o=t,r=e.indexOf(o);r>=0&&e.splice(r,1);for(let e=0;e<=i.length+n.length-1;e++){let e=i.indexOf(o),t=n.indexOf(o);if(-1===e&&-1===t)break;e>=0&&i.splice(e,1),t>=0&&n.splice(t,1)}})),i.length>0&&i[i.length-1]===i[i.length-2]&&i.pop(),widget.setValue("previouslyOpenedItems",JSON.stringify(e)),widget.setValue("currentlyOpenedItems",JSON.stringify(i)),widget.setValue("currentlyClosedItems",JSON.stringify(n)),i.length>0){let e=i[i.length-1];h.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:e}})}else h.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"})}if(e.is(t.data.authored,"array")&&t.data.authored.length>0){let e,r=[],c=[];t.data.authored.forEach((t=>{if(t.previous&&t.modified!==t.previous){if(s=!0,e=n.contentView.treeDocument.getRoots()[0].getNodesByRelId(t.previous),e&&e.length>0){let s=[];n.contentView.treeDocument.prepareUpdate(),e.forEach((e=>{let n=e.getParent(),o=new i({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,physicalid:e.options.physicalid,instance:{physicalid:t.modified},grid:{physicalid:e.options.physicalid},actualParent:e.options.actualParent,children:[]});o.setRelationID(t.modified),n.addChild(o,e._rowID),s.push(o)})),n.contentView.treeDocument.pushUpdate(),a[t.previous]=e,a[t.modified]=s,o.push(e[0].options.physicalid),l=!1,d.forEach((e=>{e.options.instance.physicalid===t.previous&&(r.push(e.getNextNode()),c.push(e))}))}}else e=n.contentView.treeDocument.getRoots()[0].getNodesByRelId(t.modified),e&&e.length>0&&(a[t.modified]=e)})),r.length>0&&r.forEach((e=>{e.select()})),c.length>0&&c.forEach((e=>{e.unselect()}))}else t.data.authored.modified&&t.data.authored.modified.forEach((function(e){e===u&&h.getFLWebModelEventsObj("flweb-model-events").publish({event:"idcard-refresh"});let t=n.contentView.treeDocument.getMappedNodesFromId(e);t&&t.length>0?t.forEach((function(t){void 0===t.getParent()||t.getParent().options.type!==N.identifiers.type_attach_document&&t.getParent().options.type!==N.identifiers.type_spec_document?"DIFSheet"===t.options.type&&t.options.virtual||t.options.virtual||t.options.virtual?k.refreshConnectedDIFNode(t):o.push(e):r.push(t.getParent().getParent())})):(t=n.contentView.treeDocument.getRoots()[0].getNodesByRelId(e),t&&t.length>0&&(a[e]=t))}))}o.length>0&&n.modelEvents.publish({event:"refresh-nodes-by-id",data:{arrayOfPID:o,tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:l}}),r.length>0&&n.modelEvents.publish({event:"refresh-documents-by-id",data:{nodes:r}}),Object.keys(a).length>0&&n.modelEvents.publish({event:"refresh-inst-by-id",data:{instIdMap:a,bInstance:!0,bEffectivity:s}})}},refresh:function(e,t,i){var o=this;if(!e){if(void 0===o.contentView.treeDocument.getRoots()[0])return;e=o.contentView.treeDocument.getRoots()[0].options.physicalid}n.mask(o.contentView.getContent(),L.msg_loading),o.contentView.treeDocument.getXSO().empty(),o._cueGlobalCount=null,o.selectedItemsForCues={},m.getLogItemWithExpand(e,t).then(o.itemPageRefCallBack.bind(o,i))},itemPageRefCallBack:function(e,t){var i=this,o=widget.getValue("currentConfig");t.options.shouldBeSelected=function(e){return e.options.physicalid&&e.options.physicalid.length>0},i.contentView.treeDocument=t,i.contentView.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),i.configData&&i.contentView.treeDocument.setConfigurationContext(i.configData),n.unmask(i.contentView.getContent()),i.catflBIFilter?i.catflBIFilter.updateModel(i.contentView):i.catflBIFilter=new y({view:i.contentView}),setTimeout((function(){i.catflBIFilter.onSetTagsWithExpandSynthesis(),i.contentView.reapplySortModel()}),1e3),i.contentView.treeDocument.getXSO().onPostAdd(i._onXSOChanged.bind(i)),i.contentView.treeDocument.getXSO().onPostRemove(i._onXSOChanged.bind(i)),f.manageDefaultFilterModel.call(i);let r,a,s=i.contentView.treeDocument.getRoots()[0].getLabel(),l=widget.getValue("xRevAttached"),c=widget.getValue("xRevision"),d=widget.getValue("currentOpenedItem");if(a=A.getSecurityContext(),a=a?{SecurityContext:"ctx::"+a}:void 0,a&&i.catflBIFilter._biFilter.setDefaultSecurityContext(a.SecurityContext),o&&o.modelVersion&&o.model&&!widget.getValue("ngFilterSessionBuilt")){o.pc.physicalid?r={version:"0.2",persistentFilter:{identifier:o.pc.physicalid,type:"Product Configuration"}}:o.modelVersion&&(r={version:"0.1",volatileFilter:{version:"0.2",filterType:"Configuration Volatile Filter",filteringView:"Current",filteringMode:"150%",filterSelection:{model:{name:o.model.name,identifier:o.model.physicalid},criteria:[{treeSeries:{treeSeriesType:"Model Version",name:o.model.name,selections:[{single:{name:o.model.name,type:"Model Version",revision:o.modelVersion.revision}}]}}]}}});const e={rootID:d,specification:{title:"title",description:"My Filter description",referencedObject:{source:"3DSpace",type:M.type_act_logref,identifier:d,relativePath:N.webservices.createLogItem+d},filter:{combinationOfSpecification:"union",filterSpecifications:[{filterCriteria:[{criteriaType:"config",configurationFilterDefinition:r}]}]}},applyFilter:1,displayFilter:0};i.catflBIFilter._biFilter.resetNGFilterUI({appId:widget.id,widgetId:widget.id,rootIds:[d]}),i.catflBIFilter.setFilterSpec=!0,i.catflBIFilter._biFilter.setPublicFilterSpecification(e)}l&&c&&!widget.getValue("ngFilterSessionBuilt")&&(r={rootID:d,rootAlias:s,specification:{type:"NGFilter_ConfigDefined",data:{filterXML:'<CfgFilterExpression xs:schemaLocation = "urn:com:dassault_systemes:config CfgFilterExpression.xsd" xmlns:xs = "http://www.w3.org/2001/XMLSchema-instance" xmlns = "urn:com:dassault_systemes:config"><FilterSelection SelectionMode="Strict" SelectionView="Current"><XRevision><Single Revision = "'+c.xRevVer+'"/></XRevision></FilterSelection></CfgFilterExpression>',context:{model:{valueItem:l.physicalid,labelItem:[c.xRevVer],name:[c.xRevVer]}}}},applyFilter:1,displayFilter:0},i.catflBIFilter._biFilter.resetNGFilterUI({appId:widget.id,widgetId:widget.id,rootIds:[d]}),i.catflBIFilter.setFilterSpec=!0,i.catflBIFilter._biFilter.setFilterSpecification(r)),f.manageSpecificFilterModels.call(i),e&&i.selectNodesById(e),E.crRecTimeoutToCheckTreeDocExp(i.contentView.treeDocument,(function(){i.modelEvents.publish({event:"content-list-view-refresh-complete",data:{contentListView:i}})}))},modelPCSelected:function(e){"xRevisionElement"!==e.type&&(this.configData=e),this.refresh(e.itemID,e.filterCompiledForm)},viewNonFilteredContent:function(e){this.configData=null,this.refresh(e.itemID)},_onXSOChanged:function(){var e=this,t=e.contentView.treeDocument.getSelectedNodes();setTimeout((function(){h.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-properties",data:{items:e.contentView.treeDocument.getSelectedNodes(),contentView:e.contentView}}),e.modelEvents.publish({event:"wux-generated-toolbar-multiselect-icon-update-count",data:t.length})}));var i=A.form3DXContent(t);A.setObjectOnCompass(i),A.launchCrossAppSelection(t)},selectNodesById:function(e){var t=this.contentView.treeDocument.getRoots()[0];e.forEach((function(e){e===t.options.physicalid?t.select():t.getNodesById(e).length>0&&t.getNodesById(e)[0].select()}))},updateClassIfAttrs:function(e){var t,i,n,o;this.contentView&&(t=this.contentView.getTreeDocument().getNodesById(e.objectId)[0],i=t.options.grid),e.attributes&&e.attributes.forEach((function(e){for(o in i)-1!==o.indexOf(e.attributeName)&&((n={})[o]=e.attributeValue)})),n&&t.updateOptions({grid:n})}}})),define("DS/CATFLCockpitWidget/components/IDCard/decorators/idcard.dropdown-menu",["DS/CATFLCockpitWidget/components/ExportCSV/ExportCSV","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/components/ArchitectureNumber/monoInstantiationStatus","DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller","DS/CATFLCockpitWidget/commands/RelatedObjectCmd","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/SAXTracker","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l){"use strict";var c=r.getFullConfig();let d=c.identifiers,u=c.localStorageKeys;return{createIDCardDropdownMenu:function(r){let c=this,p=c.activeModelVersion?c.activeModelVersion:null,g=c.itemData,f=!1,m=widget.getValue("xRevAttached");(!p||p.current!==d.state_act_Release&&p.current!==d.state_act_Obsolete)&&(!g||g.attributes.grid.maturity!==d.state_act_Released&&g.attributes.grid.maturity!==d.state_act_Obsolete)||(f=!0);let h=widget.getValue("component-view"),v={name:"setArchNo",type:"PushItem",fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-progress-3"},title:l.set_architecture_number,action:{callback:function(){let e=r.itemData.physicalid;a.trackCommandLaunched("setArchitectureNumber-sax"),t.setArchitectureNumber(e)}},state:f?"disabled":"enabled"},C={name:"setConfigCtx",type:"PushItem",fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-3dproduct-pencil"},title:l.action_edit_config_ctx,action:{callback:function(){r.contentView&&r.contentView.getTreeDocument().unselectAll();let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label,i=[{context:c,physicalid:e,label:t,type:r.itemData.type}];n.init("EditConfigurationContextCmd",i)}}},y={name:"setConfigCriteria",type:"PushItem",fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-configuration-effectivity"},title:l.action_select_config_critera,action:{callback:function(){r.contentView&&r.contentView.getTreeDocument().unselectAll();let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label,i=r.contentView.getTreeDocument().getRoots()[0],o=[{context:c,physicalid:e,label:t,type:r.itemData.type,treeData:i}];n.init("SelectByConfigurationCriteriaCmd",o)}}},b={type:"SeparatorItem"},_={name:"revisions",type:"PushItem",title:l.revisions,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-flow-branch-list"},action:{callback:function(){var e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label;n.init("HistoryCommand",[{physicalid:e,label:t,type:r.itemData.type,displayType:r.itemData.attributes.grid.type,revision:r.itemData.attributes.grid.revision,current:r.itemData.attributes.grid.maturity,icons:r.itemData.attributes.grid.icons}])}}},w={name:"duplicate",type:"PushItem",title:l.duplicate,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-duplicate"},action:{callback:function(){let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label;n.init("DuplicateCommand",[{physicalid:e,type:r.itemData.type,label:t,displayType:r.itemData.attributes.grid.type,revision:r.itemData.attributes.grid.revision,current:r.itemData.attributes.grid.maturity,icons:r.itemData.attributes.icons}])}}},D={name:"compareWith",type:"PushItem",title:l.compare,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-part-compare"},action:{callback:function(){let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label;n.init("CompareCmd",[{physicalid:e,label:t}])}}},S={name:"maturity",type:"PushItem",title:l.maturity,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-collaborative-lifecycle-management"},action:{callback:function(){let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label;n.init("MaturityCommand",[{physicalid:e,label:t}])}}},I={name:"reserve",type:"PushItem",title:l.action_lock,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-lock"},action:{callback:function(){let e,t=r.itemData.physicalid;e=[],e.push({physicalid:t,relID:"",parent:{physicalid:""}}),n.init("ReserveCmd",e)}},state:f?"disabled":"enabled"},A={name:"unreserve",type:"PushItem",title:l.action_unlock,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-lock-open"},action:{callback:function(){let e,t=r.itemData.physicalid;e=[],e.push({physicalid:t,relID:"",parent:{physicalid:""}}),n.init("UnreserveCmd",e)}},state:f?"disabled":"enabled"},F={name:"moveTo",type:"PushItem",title:l.action_move_to,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-user-change"},action:{callback:function(){let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label;n.init("ChangeOwnerCommand",[{physicalid:e,type:r.itemData.type,label:t,displayType:r.itemData.attributes.grid.type,revision:r.itemData.attributes.grid.revision,owner:r.itemData.attributes.grid.owner,icons:r.itemData.attributes.icons}])}}},k={name:"share",type:"PushItem",title:l.action_share,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-forward"},action:{callback:function(){let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label;n.init("ShareCmd",[{physicalid:e,type:r.itemData.type,label:t,displayType:r.itemData.attributes.grid.type,revision:r.itemData.attributes.grid.revision,owner:r.itemData.attributes.grid.owner,icons:r.itemData.attributes.icons}])}}},E={name:"relatedObjs",type:"PushItem",title:l.relations,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-object-related"},action:{callback:function(){o.execute("ENORIPE_AP",new s(c.itemData.attributes))}}},x={name:"ANUnicity",type:"PushItem",title:l.action_architecture_number_unicity_effectivity,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-progress-3-ok"},action:{callback:function(){a.trackCommandLaunched("architectureNumberUnicityonEvolution-sax"),c.idcardModelEvents.publish({event:"check-unicity-AN"})}},state:widget.getValue("modelAttached")&&h!==u.flattenedView&&h!==u.flattenedViewOnlyArchitectureItem?"enabled":"disabled"},T={name:"exportStructure",type:"PushItem",title:l.action_export_structure,action:{callback:function(){let t=r.itemData.physicalid,i=r.itemData.label?r.itemData.label:r.itemData.attributes.label;a.trackCommandLaunched("exportStructure-sax"),new e(t,i,{model:c.activeModel,modelVersion:c.activeModelVersion,pc:c.activePC})}}},L={name:"monoInstant",type:"PushItem",title:l.action_mono_instantiation_status,action:{callback:function(){let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label;a.trackCommandLaunched("exportArcNumberUnicityInStructure-sax"),i.downloadStatus(e,t,{model:c.activeModel,modelVersion:c.activeModelVersion,pc:c.activePC})}}},N=[];N=m?[T]:[T,L];let M={type:"PushItem",title:l.action_export,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-export"},submenu:N},V={name:"customizeHeader",type:"PushItem",title:l.customize_header,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-cog"},action:{callback:function(){c.idcardModelEvents.publish({event:"open-idcard-manage-displayed-attributes"})}}},O=[];return O=m?[v,C,b,_,w,D,S,b,I,A,F,k,b,E,M,V]:[v,C,y,b,_,w,D,S,b,I,A,F,k,b,E,x,M,V],{content:O,callbacks:{onShow:function(){},onHide:function(){}}}},updateIDCardDropdownMenu:function(){let e=this,t=e.activeModelVersion?e.activeModelVersion:null,i=e.itemData,n=!1,o=widget.getValue("component-view");(!t||t.current!==d.state_act_Release&&t.current!==d.state_act_Obsolete)&&(!i||i.attributes.grid.maturity!==d.state_act_Released&&i.attributes.grid.maturity!==d.state_act_Obsolete)||(n=!0),e._dropdownMenu.content.forEach((e=>{"setArchNo"===e.name||"reserve"===e.name||"unreserve"===e.name?(e.state=n?"disabled":"enabled","disabled"===e.state?e.tooltip={shortHelp:l.tootlip_disabled_command_released_obsolete}:e.tooltip=null):"ANUnicity"===e.name&&(e.state=widget.getValue("modelAttached")&&o!==u.flattenedView&&o!==u.flattenedViewOnlyArchitectureItem?"enabled":"disabled","disabled"===e.state?e.tooltip={shortHelp:l.tootlip_disabled_command_unicity_AN}:e.tooltip=null)}))}}})),define("DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.combinedState",["UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Mask","DS/UIKIT/Iconbar","DS/UIKIT/Scroller","DS/UIKIT/Input/Button","DS/Controls/ButtonGroup","DS/Controls/Toggle","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.controller","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f,m){"use strict";return f=JSON.parse(f),{displayCombinedConvergenceView:function(e){var i=this,n=i.getCombinedConvDefCont(e),o=i.getCombinedConvFooterActions(e);i.combinedCuesModal=new t({className:"combined_convergence_definition",closable:!0,header:m.header_combined_convg_cues,body:n,footer:o}).inject(widget.body),i.combinedCuesModal.show()},getCombinedConvDefCont:function(t){var i,n,r=this,l=e.createElement("div",{class:"combined-conv-maincontainer"}),c=e.createElement("div",{class:"operator-container"}).inject(l);e.createElement("div",{class:"operator-label",html:m.label_operator}).inject(c),"or"===t.operator?(n=!0,i=!1):(i=!0,n=!1);var d=new a({type:"radio"}).inject(c);d.addChild(new s({type:"radio",label:m.label_operator_and,value:"and",checkFlag:i})),d.addChild(new s({type:"radio",label:m.label_operator_or,value:"or",checkFlag:n})),d.addEventListener("change",(function(e){r.submitButton.isDisabled()&&e.dsModel.value[0]!==t.operator&&r.submitButton.enable()}));var u=e.createElement("div",{class:"combined-conv-container"}).inject(l),p=e.createElement("div",{class:"ccs-header-container"}).inject(u);e.createElement("section",{class:"ccs-title",html:m.label_title}).inject(p),e.createElement("section",{class:"ccs-operation",html:m.label_contribution}).inject(p);var g=e.createElement("div",{class:"combined-cues-container"}).inject(u),f=e.createElement("div",{class:"cues-scroll-container"}).inject(g),h=e.createElement("div",{class:"cues-rowCont-container"}).inject(f);return r.getCuesRowListContent(t.cuesList,h),new o({element:f}).inject(g),l},getCombinedConvFooterActions:function(e){var t=this,i=[];return t.submitButton=new r({id:"combinedConvDefSubmit",value:m.save_button,className:"primary",disabled:!0,events:{onClick:t.onSubmitCombinedCuesDef.bind(t,e.callback)}}),t.cancelButton=new r({id:"combinedConvDefCancel",value:m.cancel_button,events:{onClick:function(){t.combinedCuesModal.destroy()}}}),i.push(t.submitButton),i.push(t.cancelButton),i},getCuesRowListContent:function(t,i){var n,o=this;t&&t.forEach((function(t){n=e.createElement("div",{class:"ccs-row-container",id:"ccs_"+t.id}).inject(i),e.createElement("img",{class:"ccs-icon hidden-xs",src:t.icon_url}).inject(n),e.createElement("section",{class:"ccs-title",html:t.title}).inject(n),t.combinedState||(t.combinedState="ignore"),new r({className:"btn_operation",name:t.combinedState,value:m["val_"+t.combinedState],dropdown:{items:[{name:"yes",text:m.val_yes},{name:"no",text:m.val_no},{name:"ignore",text:m.val_ignore}]},events:{onDropdownClick:function(e,t){this.getName()!==t.name&&(this.setName(t.name),this.setValue(t.text),o.submitButton.isDisabled()&&o.submitButton.enable())}}}).inject(n)}))},onSubmitCombinedCuesDef:function(e,t,i){var n,o,r=this,a={},s=r.combinedCuesModal.getContent().getElement(".wux-controls-buttongroup .wux-controls-toggle[checked]");s&&(r.combinedCuesModal.getContent().getElements(".ccs-row-container").forEach((function(e){"ignore"!==(o=e.getElement(".btn_operation").name)&&(n=e.id.substring(4),a[n]=o)})),e({operator:s.dsModel.value,combinedCues:a}),r.combinedCuesModal.destroy())}}})),define("DS/CATFLCockpitWidget/components/IDCard/idcard.controller",["DS/CoreEvents/ModelEvents","DS/ENOXIDCard/js/IDCard","DS/Controls/TooltipModel","DS/CATFLCockpitWidget/components/IDCard/decorators/idcard.database-icon","DS/CATFLCockpitWidget/components/IDCard/decorators/idcard.dropdown-menu","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/predicate.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/preferences.util","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f){"use strict";let m=d.getFullConfig();function h(e){return e.replace(/[^A-Z0-9_-]/gi,"_").replace(/[\.:]/gi,"_")}return{init:function(i,o,r,a,s,l,c){var d=this;return d.activeItem={},d.activeModel={},d.activeModelVersion={},d.activePC={},d.idcardModelEvents=new e,d.itemData=o.itemData,d.getClassificationAttributesOnItem(d.itemData).then((function(e){return o.classifiedData=e,d.createIDCardModel(o,a).then((function(e){d.idcardModel=e,d.subscribeToIdCardEvents(),d.subscribeToGlobalEvents();var o=new t({model:d.idcardModel});i.hasChildNodes()&&i.empty(),o.render().inject(i),o.attachResizeSensor(),d.idcard=o;let u="navigateBackward",p="navigateForward";return a?(d.enableActionOnNavigate(u),c&&d.updateTooltipOnNavigate(u,f.go_back_to+c.attributes.label)):d.disableActionOnNavigate(u),s?(d.enableActionOnNavigate(p),l&&d.updateTooltipOnNavigate(p,f.go_forward_to+l.attributes.label)):d.disableActionOnNavigate(p),n.addDatabaseIcon(d.idcard),d.retreiveSavedAttributesCustomHeaderView(),r.subscribe({event:"triptych-panel-visible"},(function(e){"right"===e&&o.toggleInformationIcon(!0)})),r.subscribe({event:"triptych-panel-hidden"},(function(e){"right"===e&&o.toggleInformationIcon(!1)})),d.parentContainer=i.parentElement,d.parentContainer.classList.add("flweb-cockpit-idcard-minified"),d}))}))},subscribeToIdCardEvents:function(){var e=this;e.idcardModelEvents.subscribe({event:"idcard-open-modelVersion-selector"},e.modVerNameClickHandler.bind(e)),e.idcardModelEvents.subscribe({event:"idcard-open-configuration-selector"},e.configurationClickHandler.bind(e)),e.idcardModelEvents.subscribe({event:"idcard-open-version-explorer"},e.versionHandler.bind(e)),e.idcardModelEvents.subscribe({event:"idcard-minified"},(function(){document.body.querySelector(".fl-cockpit-triptych-main-container").classList.add("flweb-cockpit-idcard-minified"),e.parentContainer.classList.add("flweb-cockpit-idcard-minified")})),e.idcardModelEvents.subscribe({event:"idcard-expanded"},(function(){document.body.querySelector(".fl-cockpit-triptych-main-container").classList.remove("flweb-cockpit-idcard-minified"),e.parentContainer.classList.remove("flweb-cockpit-idcard-minified")})),e.idcardModelEvents.subscribe({event:"idcard-attributes-clicked"},e.attributeClickHandler.bind(e,{id:e.itemData.physicalid,type:e.itemData.type,name:e.itemData.attributes.label})),e.idcardModelEvents.subscribe({event:"idcard-open-actions-menu"},(function(){o.updateIDCardDropdownMenu.call(e)})),e.idcardModelEvents.subscribe({event:"saved-displayedAttributes-idcard"},(function(e){var t={};for(var i of Object.keys(e.savedAttributes))t[i]={id:e.savedAttributes[i].attribute.id,displayWhenMinified:e.savedAttributes[i].attribute.displayWhenMinified,visibility:e.savedAttributes[i].visibility,order:e.savedAttributes[i].order};u.saveCustomHeaderView(t)}))},subscribeToGlobalEvents:function(){var e=this;if(!r.getSubscriptionList().includes("idCardController")){var t=r.getFLWebModelEventsObj("flweb-model-events");t.subscribe({event:"idcard-refresh"},e._refreshIDCardInformation.bind(e)),t.subscribe({event:"mod-PC-selection-successful"},e._updateIDCardOnConfigSelectionDone.bind(e)),t.subscribe({event:"allmod-selection-successful"},e._updateIDCardOnAllModelSelection.bind(e)),t.subscribe({event:"mod-selection-removed"},e._updateIDCardOnModelRemoved.bind(e)),t.subscribe({event:"flweb-ngfilter-added"},e.updateNGFilter.bind(e)),t.subscribe({event:"flweb-ngfilter-removed"},e.updateNGFilter.bind(e)),t.subscribe({event:"save-user-custom-attributes"},e.updateListAvailableAttributes.bind(e)),r.addToSubscriptionList("idCardController")}},createDataFullListAvailableAttributes:function(e,t){var i=this,n=e.attributes.grid.architectureNumber?e.attributes.grid.architectureNumber:f.label_none,o=(c.getUserCustomAttributes()||[]).filter((function(e){return e.bo})),r={};return l.getNLSPredicates(o).then((function(a){r=a||{};var s=[];return o.forEach((function(n){var o=i.parseValueIDCardData(n,e.attributes,t),a=h(n.curi);s.push({id:a,name:r[n.curi]||n.nls||n.curi,value:o,displayWhenMinified:!1,defaultVisibility:!1})})),[{id:"responsible",name:f.label_owner,value:e.attributes.grid.owner,displayWhenMinified:!0,type:"type-hyperlink",editable:!0,defaultVisibility:!0,icon:"wux-ui-3ds wux-ui-3ds-user",image:d.getUserImage(e.attributes.owner),defaultAttribute:!0},{id:"status",name:f.label_maturity,value:e.attributes.grid.maturity,displayWhenMinified:!0,editable:!0,defaultVisibility:!0,isMaturity:!0,defaultAttribute:!0},{id:"created",name:f.label_creation_date,value:c.formatDate(e.attributes.grid.creationDate),displayWhenMinified:!0,defaultVisibility:!0,defaultAttribute:!0,displayTime:!0},{id:"modified",name:f.label_modification_date,value:c.formatDate(e.attributes.grid.modificationDate),displayWhenMinified:!0,defaultVisibility:!0,defaultAttribute:!0,displayTime:!0},{id:"architectureNo",name:f.label_arch_no,value:n,type:"type-hyperlink",editable:!0,defaultVisibility:!0,defaultAttribute:!0}].concat(s)}))},createIDCardModel:function(e){var t=this,i=e.itemData,n=e.xRevisionData,r=e.classifiedData;t.setCurrentItem(i.physicalid,i.attributes.label,i.attributes.grid.revision),t._dropdownMenu=o.createIDCardDropdownMenu.call(t,e);var a=i.attributes.grid.description?i.attributes.grid.description:f.label_noDescription;return t.createDataFullListAvailableAttributes(i,r).then((function(o){return new UWA.Class.Model({minified:!0,id:i.physicalid,name:i.attributes.label,version:n&&n.length>0?f.label_x_rev:i.attributes.grid.revision,configuration:"",thumbnail:e.indexContent?.icon??d.getServiceURL("3DSpace")+"/snresources/images/icons/large/I_VPMNavLogical108x144.png",withHomeButton:!0,showBackButton:!1,withExpandCollapseButton:!0,withActionsButton:!0,withInformationButton:!0,withToggleMinifiedButton:!0,withGenericButton:!0,enableNavigation:!0,withDivider:!0,modelEvents:t.idcardModelEvents,freezones:['<p title="'+a+'">'+a+"</p>"],fullListAvailableAttributes:o,customEvents:{versionModelLabelClick:{event:"idcard-open-modelVersion-selector"}},dropdown:t._dropdownMenu,securityContext:"ctx::"+d.getSecurityContext(),immersiveFrame:widget.immersiveFrame})}))},updateIDCardData:function(e){e.forEach(function(e){var t=this,i=e.key,n=e.value,o=e.editable,r=e.image;if(e.isAttributeSet){for(var a=t.idcardModel.get("fullListAvailableAttributes"),s=[],l=0;l<a.length;l++)a[l].id!==i?s.push({id:a[l].id,name:a[l].name,value:a[l].value,editable:a[l].editable,type:a[l].type,displayWhenMinified:a[l].displayWhenMinified,defaultVisibility:a[l].defaultVisibility,icon:a[l].icon,image:a[l].image,isMaturity:a[l].isMaturity,defaultAttribute:a[l].defaultAttribute,displayTime:a[l].displayTime}):s.push({id:a[l].id,name:a[l].name,value:n,editable:o,type:e.type,displayWhenMinified:a[l].displayWhenMinified,defaultVisibility:a[l].defaultVisibility,icon:a[l].icon,image:r,isMaturity:a[l].isMaturity,defaultAttribute:a[l].defaultAttribute,displayTime:a[l].displayTime});t.idcardModel.set("fullListAvailableAttributes",s)}else t.idcardModel.set(i,n)}.bind(this))},_updateIDCardOnConfigSelectionDone:function(e){let t=this;if("xRevisionElement"===e.type){if(!widget.getValue("ngFilter")){t.updateIDCardData([{key:"version",value:e.xRevVer,isAttributeSet:!1}]),widget.setValue("xRevision",{xRevVerId:e.xRevVerId,xRevVer:e.xRevVer,xRevName:e.xRevName,filterCompiledForm:e.filterCompiledForm});let i={xRevTitle:widget.getValue("xRevAttached").name,...e};t.synchronizeConfigIDCardWithWorkUnder({xRev:i})}}else{c.alertMessage("success",null,f.attachedConfigurationUpdated);var i=f.label_all;e.pc&&(i=e.pc.label?e.pc.label:e.pc.name),t.updateIDCardData([{key:"version",value:"",isAttributeSet:!1},{key:"modelVersion",value:e.modelVer.name,isAttributeSet:!1},{key:"versionModel",value:e.modelVer.revision,isAttributeSet:!1},{key:"configuration",value:i,isAttributeSet:!1}]),t.setCurrentModel(e.model.physicalid,e.model.id,e.model.name,null,e.model.displayName),t.setCurrentModelVersion(e.modelVer.physicalid?e.modelVer.physicalid:e.modelVer.id,e.modelVer.name,e.modelVer.revision,e.modelVer.backEndName,e.modelVer.current),null!==e.pc?t.setCurrentPC(e.pc.physicalid,e.pc.name,e.pc.revision,i):t.setCurrentPC(null,null,null,f.label_all),widget.setValue("currentConfig",{model:t.activeModel,modelVersion:t.activeModelVersion,pc:t.activePC,filterCompiledForm:e.filterCompiledForm}),t.synchronizeConfigIDCardWithWorkUnder({model:t.activeModel,modelVersion:t.activeModelVersion})}},_updateIDCardOnAllModelSelection:function(){let e=this;widget.getValue("xRevAttached")?e._updateIDCardOnXRevision():(e.updateIDCardData([{key:"version",value:"",isAttributeSet:!1},{key:"modelVersion",value:f.label_all_models,isAttributeSet:!1},{key:"versionModel",value:"",isAttributeSet:!1},{key:"configuration",value:"",isAttributeSet:!1}]),e.setCurrentModel(null,null,null),e.setCurrentModelVersion(null,null,null,null),e.setCurrentPC(null,null,null,null),widget.setValue("currentConfig",null),widget.setValue("xRevision",null))},_updateIDCardOnXRevision:function(){var e=this;e.updateIDCardData([{key:"version",value:f.label_x_rev,isAttributeSet:!1},{key:"versionModel",value:"",isAttributeSet:!1},{key:"configuration",value:"",isAttributeSet:!1}]),e.setCurrentModel(null,null,null),e.setCurrentModelVersion(null,null,null,null),e.setCurrentPC(null,null,null,null),widget.setValue("currentConfig",null),widget.setValue("xRevision",null)},_updateIDCardOnModelRemoved:function(){var e=this;e.updateIDCardData([{key:"version",value:e.activeItem.revision?e.activeItem.revision:f.label_active_rev,isAttributeSet:!1},{key:"modelVersion",value:"",isAttributeSet:!1},{key:"versionModel",value:"",isAttributeSet:!1},{key:"configuration",value:"",isAttributeSet:!1}]),e.setCurrentModel(null,null,null),e.setCurrentModelVersion(null,null,null,null),e.setCurrentPC(null,null,null,null),widget.setValue("currentConfig",null),widget.setValue("modelAttached",null),c.alertMessage("success",null,f.attachedConfigurationRemoved)},attributeClickHandler:function(e,t){var i=this;if(t.attributeName===f.label_owner){var n={};n.physicalid=e.id,n.label=e.name,n.type=e.type,n.displayType=i.itemData.attributes.grid.type,n.revision=i.itemData.attributes.grid.revision,n.owner=i.itemData.attributes.grid.owner,n.icons=i.itemData.attributes.icons,g.init("ChangeOwnerCommand",[n])}else if(t.attributeName===f.label_arch_no){var o=e.id;p.setArchitectureNumber(o)}},modVerNameClickHandler:function(){var e=this,t=widget.getValue("modelAttached"),i=[],n={};t.forEach((function(e){e.id||(i.push(e.physicalid),n[e.physicalid]=e)})),i.length>0?s.getItemInfo(i).then((function(i){(i=i.member).forEach((function(e){e.objectid&&(n[e.physicalid].id=e.objectid)})),t=Object.values(n),require(["DS/CATFLCockpitWidget/components/ModelPCSelector/configurationSelector"],function(t){t.init("MODELVERSION",e.itemData.physicalid,widget.getValue("modelAttached"),e.activeModelVersion)}.bind(e))})):require(["DS/CATFLCockpitWidget/components/ModelPCSelector/configurationSelector"],function(t){t.init("MODELVERSION",e.itemData.physicalid,widget.getValue("modelAttached"),e.activeModelVersion)}.bind(e))},configurationClickHandler:function(){var e=this,t=widget.getValue("ngFilter");t&&t.length>0?r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-ngFilter-open"}):require(["DS/CATFLCockpitWidget/components/ModelPCSelector/configurationSelector"],function(t){t.init("PC",e.itemData.physicalid,e.activeModel,e.activeModelVersion,e.activePC,e.activeItem)}.bind(e))},versionHandler:function(){var e=this,t=e.itemData.physicalid,i=e.itemData.label?e.itemData.label:e.itemData.attributes.label;g.init("HistoryCommand",[{physicalid:t,label:i,type:e.itemData.type,displayType:e.itemData.attributes.grid.type,revision:e.itemData.attributes.grid.revision,current:e.itemData.attributes.grid.maturity,icons:e.itemData.attributes.grid.icons}])},updateNGFilter:function(e){var t=this,i="";e.filterName||e.filterTitle?(i=e.filterTitle?"["+e.filterTitle+"]":"["+e.filterName+"]",t.updateIDCardData([{key:"version",value:"",editable:!1,isAttributeSet:!1},{key:"modelVersion",value:"",isAttributeSet:!1},{key:"versionModel",value:"",isAttributeSet:!1},{key:"configuration",value:i,editable:!1,isAttributeSet:!1}])):widget.getValue("modelAttached")&&!t.activeModelVersion.physicalid?t._updateIDCardOnAllModelSelection():widget.getValue("xRevAttached")?t._updateIDCardOnXRevision():t.updateIDCardData([{key:"version",value:t.activeModelVersion.revision?"":t.activeItem.revision,isAttributeSet:!1},{key:"modelVersion",value:t.activeModelVersion.name?t.activeModelVersion.name:"",isAttributeSet:!1},{key:"versionModel",value:t.activeModelVersion.revision?t.activeModelVersion.revision:"",isAttributeSet:!1},{key:"configuration",value:t.activePC.label,isAttributeSet:!1}])},_refreshIDCardInformation:function(){var e=this;Promise.all([a.getLogItemAttributes(e.itemData.physicalid),e.getClassificationAttributesOnItem(e.itemData)]).then((function(t){var i=t[0],n=t[1],o=i[e.itemData.physicalid].attributes,r=o.grid.architectureNumber||f.label_none;e.idcard.container.getElement(".free-zone-0").setHTML("<p>"+(o.grid.description||f.label_noDescription)+"</p>");var a=c.getUserCustomAttributes()||[],s=[];a.forEach((t=>{var i=e.parseValueIDCardData(t,o,n);s.push({key:h(t.curi),value:i,editable:!1,isAttributeSet:!0})})),e.updateIDCardData([{key:"name",value:o.label,editable:!1,isAttributeSet:!1},{key:"responsible",value:o.grid.owner,editable:!0,isAttributeSet:!0,image:d.getUserImage(o.owner)},{key:"status",value:o.grid.maturity,editable:!0,isAttributeSet:!0},{key:"modified",value:c.formatDate(o.grid.modificationDate),editable:!1,isAttributeSet:!0},{key:"architectureNo",value:r,editable:!0,isAttributeSet:!0}].concat(s)),e.itemData.attributes.label=o.label,e.itemData.attributes.maturity=o.maturity,e.itemData.attributes.grid.maturity=o.grid.maturity,e.itemData.attributes.grid.owner=o.grid.owner,e.itemData.attributes.grid.description=o.grid.description,e.itemData.attributes.grid.modificationDate=o.grid.modificationDate,e.itemData.attributes.grid.architectureNumber=r}))},setCurrentItem:function(e,t,i){this.activeItem={physicalid:e,id:e,name:t,revision:i}},setCurrentModel:function(e,t,i,n,o){this.activeModel={physicalid:e||t,id:t,name:i,revision:n,displayName:o}},setCurrentModelVersion:function(e,t,i,n,o){this.activeModelVersion={physicalid:e,id:e,name:t,revision:i,backEndName:n,current:o}},setCurrentPC:function(e,t,i,n){this.activePC={physicalid:e,id:e,name:t,label:n,revision:i}},disableActionOnNavigate:function(e){let t=this.idcard.container.getElement("#"+e);!t||!t.classList||t.classList.contains("disabled")||t.classList.add("disabled")},enableActionOnNavigate:function(e){let t=this.idcard.container.getElement("#"+e);!(!t||!t.classList)&&t.classList.contains("disabled")&&t.classList.remove("disabled")},updateTooltipOnNavigate:function(e,t){let n=this.idcard.container.getElement("#"+e);n.tooltipInfos=new i({shortHelp:t}),n.setAttribute("title","")},updateListAvailableAttributes:function(){var e=this,t=this.idcardModel.get("fullListAvailableAttributes"),i=c.getUserCustomAttributes()||[],n=i.filter((function(e){var i=h(e.curi);return e.bo&&!t.some((e=>i===e.id))})),o=[];n.forEach((function(t){var i=h(t.curi);o.push({id:i,name:t.nls,value:void 0!==e.itemData.attributes.grid[t.curi]?e.itemData.attributes.grid[t.curi]:f.label_none,displayWhenMinified:!1,defaultVisibility:!1})}));var r=t.filter((function(e){return i.some((function(t){var i=h(t.curi);return e.id===i}))||!0===e.defaultAttribute})).concat(o);this.idcardModel.set("fullListAvailableAttributes",r)},retreiveSavedAttributesCustomHeaderView:function(){var e=c.getUserCustomHeaderView()||{};Object.keys(e).length&&this.idcard.IDCardDisplayedAttributes.setStatusForAttributes(e)},getClassificationAttributesOnItem:function(e){let t=c.getUserCustomAttributes()||[],i=!1;for(var n in t)if(t[n].isClassification){i=!0;break}return new Promise((function(t){i?a.getLogItemClassificationAttributes(e.physicalid).then((function(e){t(e)})).catch((function(){t({})})):t({})}))},parseValueIDCardData:function(e,t,i){var n=f.label_none;if(e.isClassification)void 0!==i[e.curi]&&(n=i[e.curi]);else if(void 0!==t.grid[e.curi]&&(n=t.grid[e.curi],e.dimension)){t.grid[e.curi+"_actual"]&&(n=t.grid[e.curi+"_actual"]);var o=m.dimensions[e.dimension],r=o.Units[o.MKSUnit].NLSName;n=Array.isArray(n)?n.map((e=>e+" "+r)):n+" "+r}var a=e.isSharedPredicateOnSameType||e.isSharedPredicate&&(e.isClassification||e.isOnExtension),s=e.multiValuated||a;if("date"===e.type)if(s){var l=[];l=(Array.isArray(n)?n:n.split(",")).map((function(e){return c.formatDate(e)})),n=l}else n=c.formatDate(n);else if(void 0!==e.rangeValues&&e.rangeValues.length>0&&"string"===e.type)if(s){let t=Array.isArray(n)?n:n.split(",");l=[];for(var d=0;d<t.length;d++){let i=e.rangeValues.find((function(e){return e.value===t[d]}));l.push(i?i.nlsValue:t[d])}n=l}else{let t=e.rangeValues.find((function(e){return e.value===n}));n=t?t.nlsValue:n}return n},synchronizeConfigIDCardWithWorkUnder:function(e){let t={config:e};g.init("SetWorkUnderEvolutionCommand",t)}}})),define("DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.checklist",["UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Mask","DS/UIKIT/Iconbar","DS/UIKIT/Scroller","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.controller","DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.combinedState","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f,m){"use strict";return f=JSON.parse(f),{displayCuesChecklist:function(e,i){var n=this;n.ccsConfiguration=i,n.allCuesChecked=!0;var o=n.getCuesChecklistContent(e),r=n.getCuesChecklistFooterActions();n.cuesModal=new t({className:"convergence_cues_checklist",closable:!0,header:m.header_convg_cues_checklist,body:o,footer:r,events:{onHide:function(){this.destroy()}}}).inject(widget.body),n.cuesModal.show()},getCuesChecklistContent:function(t){var i=e.createElement("div",{class:"cues-checklist-maincontainer"}),n=e.createElement("div",{class:"cues-checklist-container"}).inject(i),r=e.createElement("div",{class:"header-container"}).inject(n),a=e.createElement("div",{class:"checklist-container"}).inject(n),s=e.createElement("div",{class:"checklist-scroll-container"}).inject(a),l=e.createElement("div",{class:"checklist-rowCont-container"}).inject(s);return this.getCuesRowListContent(t,l,r),new o({element:s}).inject(a),i},getCuesChecklistFooterActions:function(){var e=this,t=[];return e.combinedConv=e.getCombinedConvergenceContainer(),t.push(e.combinedConv),e.submitButton=new r({id:"cuesChecklistSubmit",value:m.save_button,className:"primary",events:{onClick:e.onSubmitCuesChecklist.bind(e)},disabled:!0}),e.cancelButton=new r({id:"cuesChecklistCancel",value:m.cancel_button,events:{onClick:function(){e.cuesModal.destroy()}}}),t.push(e.submitButton),t.push(e.cancelButton),t},getCombinedConvergenceContainer:function(){var t=this,i=!1,n=e.createElement("div",{class:"combined-convergence-footer"});return t.ccsConfiguration&&t.ccsConfiguration.active&&(i=!0),t.confCombinedConvCB=new a({type:"checkbox",className:"primary",id:"cb_combined_conv",label:"",checked:i,events:{onChange:function(){this.isChecked()?t.confCombinedConvBtn.enable():t.confCombinedConvBtn.disable(),t.submitButton.isDisabled()&&t.submitButton.enable()}}}).inject(n),t.confCombinedConvBtn=new r({id:"combined-convergence-configure",class:"combined-convergence-configure",icon:"pencil",disabled:!i,events:{onClick:t._configureCombinedConvergence.bind(t)}}).inject(n),e.createElement("section",{class:"combined-convergence-label",html:m.action_combined_convergence}).inject(n),n},getCuesRowListContent:function(t,i,n){var o=this;let l=[];if(t){var d,u,p,g=s.getWebappsAssetUrl("CATFLCockpitWidget","icons"),f=e.createElement("div",{class:"cue-header-container"}).inject(n);e.createElement("section",{class:"cue-title",html:m.label_title}).inject(f),e.createElement("section",{class:"cue-severity",html:m.label_severity}).inject(f);var h=new a({type:"checkbox",className:"primary",id:"cb_select",label:"",checked:!1,events:{onChange:function(){this.isChecked()||!this.isChecked()&&h.getContent().classList.contains("mixed")?o._selectAllHandler.call(o,h):o._selectNoneHandler.call(o,h)}}}).inject(f);t.forEach((function(t){p=t.icon&&t.icon.indexOf("https")>=0?t.icon:g+"/I_RFLPLMImplementConnection.png",d=e.createElement("div",{class:"cue-row-container",id:t.id}).inject(i),e.createElement("img",{class:"cue-icon hidden-xs",src:p}).inject(d),e.createElement("section",{class:"cue-title",html:t.title}).inject(d),"CRITICAL"===t.severity?u=m.val_critical:"ERROR"===t.severity?u=m.val_error:"WARNING"===t.severity?u=m.val_warning:(t.severity="INFO",u=m.val_info),new r({className:"btn_severity "+t.severity.toUpperCase(),name:t.severity,value:u,dropdown:{items:[{name:"CRITICAL",text:m.val_critical},{name:"ERROR",text:m.val_error},{name:"WARNING",text:m.val_warning},{name:"INFO",text:m.val_info}]},events:{onDropdownClick:function(e,t){if(this.getName()!==t.name){this.setName(t.name),this.setValue(t.text);var i=this.getContent();"CRITICAL"===t.name?(i.addClassName("CRITICAL"),i.removeClassName("ERROR"),i.removeClassName("WARNING"),i.removeClassName("INFO")):"ERROR"===t.name?(i.addClassName("ERROR"),i.removeClassName("CRITICAL"),i.removeClassName("WARNING"),i.removeClassName("INFO")):"WARNING"===t.name?(i.addClassName("WARNING"),i.removeClassName("CRITICAL"),i.removeClassName("ERROR"),i.removeClassName("INFO")):(i.addClassName("INFO"),i.removeClassName("CRITICAL"),i.removeClassName("ERROR"),i.removeClassName("WARNING")),i.parentNode.getElement('input[type="checkbox"]').checked?o.submitButton.isDisabled()&&o.submitButton.enable():c.alertMessage("warning",null,m.warn_cue_unselected)}}}}).inject(d),new a({type:"checkbox",className:"primary",id:"cb_"+t.id,label:"",checked:t.checked,events:{onChange:function(){var e=o.cuesModal.getContent().getElements(".cue-row-container"),t=o.cuesModal.getContent().getElements(".cue-row-container input:checked");0===t.length?(h.setMixed(!1),h.uncheck(),o.allCuesChecked=!1):e.length===t.length?(o.allCuesChecked=!0,h.setMixed(!1),h.check()):(h.setMixed(!0),h.check()),o.submitButton.isDisabled()&&o.submitButton.enable(),t&&0===t.length&&(o.confCombinedConvCB.uncheck(),o.confCombinedConvBtn.disable(),o.ccsConfiguration={})}}}).inject(d),t.checked?l.push(t.id):o.allCuesChecked=!1})),o.allCuesChecked?h.check():l.length>0&&(h.check(),h.setMixed(!0))}},onSubmitCuesChecklist:function(){var e,t,i,n=this,o={},r={},a=[];n.cuesModal.getContent().getElements(".cue-row-container input:checked").forEach((function(r){h=r.id.substring(3),e=n.cuesModal.getContent().getElement("#"+h),i=e.getElement(".btn_severity"),t=i.name,o[h]={cueId:h,cueSeverity:t},a.push(h)})),r.cues_state=o;var s=n.cuesModal.getContent().getElement("#cb_combined_conv"),l=!1;if(s&&s.checked){if(Object.keys(o).length<=0)return void c.alertMessage("error","",m.error_cues_for_combination,"");var p=n.ccsConfiguration.combinedCues,g=[];if(a&&p){for(var h in p)if(a.indexOf(h)<0){var v=n.cuesModal.getContent().getElement("#"+h+" .cue-title");g.push(v.innerText)}if(g.length>0)return void c.alertMessage("error","",m.replace(m.error_combined_cues_missing,{missingCues:g.join()}),"")}l=!0}n.ccsConfiguration.active=l,r.combined_state=n.ccsConfiguration,u.setUserPreferences({name:f.user_pref_cues,value:JSON.stringify(r)}).then((function(){d.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-refresh"}),n.cuesModal.destroy(),c.alertMessage("success","",m.msg_cues_saved_success,"")}))},_selectAllHandler:function(e){var t=this,i=t.cuesModal.getContent().getElements(".cue-row-container input[type=checkbox]");i&&(i.forEach((function(e){e.checked=!0})),t.allCuesChecked=!0,e.setMixed(!1),e.check()),t.submitButton.isDisabled()&&t.submitButton.enable()},_selectNoneHandler:function(e){var t=this,i=t.cuesModal.getContent().getElements(".cue-row-container input[type=checkbox]");i&&(i.forEach((function(e){e.checked=!1})),t.allCuesChecked=!1,e.setMixed(!1),e.uncheck()),t.submitButton.isDisabled()&&t.submitButton.enable(),t.confCombinedConvCB.uncheck(),t.confCombinedConvBtn.disable(),t.ccsConfiguration={}},_configureCombinedConvergence:function(){var e,t,i=this,n=[],o=i.ccsConfiguration,r=o.operator,a=o.combinedCues||{},s=i.cuesModal.getContent().getElements(".cue-row-container input:checked");s&&0!==s.length?(s.forEach((function(o){e=o.id.substring(3);var r=i.cuesModal.getContent().getElement("#"+e);t=a[e],n.push({id:e,icon_url:r.getElement(".cue-icon").src,title:r.getElement(".cue-title").innerHTML,combinedState:t})})),g.displayCombinedConvergenceView({active:!0,operator:r,cuesList:n,callback:function(e){i.ccsConfiguration=e,i.submitButton.isDisabled()&&i.submitButton.enable()}})):c.alertMessage("error","",m.error_cues_for_combination,"")}}})),define("DS/CATFLCockpitWidget/components/LandingPage/itemPage",["DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.controller","DS/CATFLCockpitWidget/components/IDCard/idcard.controller","DS/CATFLCockpitWidget/components/ArchitectureNumber/checkArchitectureNumberUnicity","DS/CATFLCockpitWidget/utils/checkArchitectureNumberUnicity.util","DS/CATFLCockpitWidget/mixins/CATFLBIFilter","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/utils/xhr.util","text!DS/CATFLCockpitWidget/assets/config/navigate.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f){"use strict";var m=a.getFullConfig().identifiers;return{init:function(e,i,n,o){var s=this;if(s.container=i,s.triptych=n,s.propertiesPanel=o,s.contentListContainer=s.container.getElement(".fl-cockpit-content-list-container"),s.contentListView=t.init(s.contentListContainer),s.idcardContainer=s.container.getElement(".fl-cockpit-idcard-container"),widget.setValue("currentView","ItemPage"),e.itemPID){let t,i=widget.getValue("ngFilter"),n=e.itemPID;if(i&&i.length>0&&(t=JSON.parse(i)),t&&t.filterId||e.itemType===m.type_act_advfilter){s.contentListView.catflBIFilter?s.contentListView.catflBIFilter.updateModel(s.contentListView.contentView):s.contentListView.catflBIFilter=new r({view:s.contentListView.contentView}),delete s.itemId,n&&e.itemType!==m.type_act_advfilter&&s.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:n});let i={envId:a.getTenant(),serviceId:"3DSpace",contextId:"ctx::"+a.getSecurityContext(),objectId:t?t.filterId:e.itemPID,objectType:m.type_act_advfilter,i3dx:"",displayType:f.action_adv_filter};s.contentListView.catflBIFilter.retrieveFilterInfo(s,i)}else i&&(s.contentListView.catflBIFilter||(s.contentListView.catflBIFilter=new r({view:s.contentListView.contentView})),n&&s.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:n})),s.load(n,!1)}return s},load:function(t,i,n){var o=this,r={},a=[];if(""===t)return void s.alertMessage("error",null,f.error_non_existing_item);o.itemId=t,o.contentListView._cueComputedIds=null,n?widget.setValue("ngFilterSessionBuilt",!0):widget.setValue("ngFilterSessionBuilt",!1);var h=widget.getValue("currentlyClosedItems");o.currentlyClosedItems=h?JSON.parse(h):[],o.currentlyClosedItems.length>0&&o.currentlyClosedItems[o.currentlyClosedItems.length-1]===t&&o.currentlyClosedItems.pop();var v=widget.getValue("previouslyOpenedItems");if(o.previouslyOpenedItems=v?JSON.parse(v):[],!i&&o.previouslyOpenedItems[o.previouslyOpenedItems.length-1]!==t){let e=o.previouslyOpenedItems.indexOf(t);e>=0?o.previouslyOpenedItems.splice(e,1):o.previouslyOpenedItems.length===m.limit_recents&&o.previouslyOpenedItems.shift(),o.previouslyOpenedItems.push(t)}if(widget.getValue("currentlyOpenedItems")?o.currentlyOpenedItems=JSON.parse(widget.getValue("currentlyOpenedItems")):(o.currentlyOpenedItems=[],o.currentlyOpenedItems.push(t)),i||o.currentlyOpenedItems[o.currentlyOpenedItems.length-1]===t||(o.currentlyOpenedItems.length+o.currentlyClosedItems.length===m.limit_history&&o.currentlyOpenedItems.shift(),o.currentlyOpenedItems.push(t)),o.currentlyClosedItems.length>0)var C=o.currentlyClosedItems[o.currentlyClosedItems.length-1];if(o.currentlyOpenedItems.length>1)var y=o.currentlyOpenedItems[o.currentlyOpenedItems.length-2];widget.setValue("currentlyOpenedItems",JSON.stringify(o.currentlyOpenedItems)),widget.setValue("currentOpenedItem",o.itemId),widget.setValue("previouslyOpenedItems",JSON.stringify(o.previouslyOpenedItems)),widget.deleteValue("ngFilter");var b=[];b=C&&y?[y,t,C]:C?[t,C]:y?[y,t]:[t];let _=JSON.parse(g);a.push(d.getObjectAttributes(b)),a.push(c.getConfigContextInfo([t])),a.push(l.getUserPreferences(m.user_pref_openedItems_conf)),a.push(l.getUserPreferences(m.user_pref_workunder)),a.push(u.getRecentsContent()),a.push(u.fetch([t],_.basic.attributes,!0)),p.makeMultipleServiceCalls(a,!0).then((function(i){r.itemData=i[0][t],r.nextItemData=i[0][C],r.prevItemData=i[0][y];let n,a,l=[];i[1].contextInfo&&i[1].contextInfo.length>0&&i[1].contextInfo.forEach((function(e){let t=e.content.results[0].basicData;for(let e=t.length-1;e>=0;e--){let i=t[e];if("name"===i.name){n=i.value[0];break}}let i=e.content.results[0].data;if(i&&i.length>0)for(let e=i.length-1;e>=0;e--)if(i[e]&&"Marketing Name"===i[e].name){a=i[e].value[0];break}l.push({name:n,physicalid:e.modelPID,displayName:a})})),r.modelData=l,r.xRevisionData=i[1].xRevisionContent,r.usrPrfItemConf=i[2],r.usrPrfWorkUnder=i[3],r.indexContent=i[5][0]??i[4]?.find((e=>e.resourceid===t)),C&&y?(o.nextItemData=r.nextItemData,o.prevItemData=r.prevItemData):C?(o.nextItemData=r.nextItemData,o.prevItemData=null):y&&(o.prevItemData=r.prevItemData,o.nextItemData=null),r.usrPrfWorkUnder&&e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-manage-workUnder",data:{rez:r.usrPrfWorkUnder}}),s.cleanDragNDrop(o.contentListView.contentView.getContent()),widget.setTitle(r.itemData.attributes.label),r.modelData&&r.modelData.length>0?widget.setValue("modelAttached",r.modelData):(widget.setValue("modelAttached",null),widget.setValue("currentConfig",null)),r.xRevisionData&&r.xRevisionData.length>0?widget.setValue("xRevAttached",r.xRevisionData[0].xRevisionGraph):widget.deleteValue("xRevAttached"),o._createIdCard(r).then((function(){o.contentListContainer.getElementsByClassName("modelPCSelector").length&&(o.contentListContainer.getElementsByClassName("modelPCSelector")[0].destroy(),o.contentListContainer.getElementsByClassName("modal-overlay in")[0].destroy()),r.modelData&&r.modelData.length>0?o._loadItemWithConfigCtx(r.modelData,r.usrPrfItemConf):r.xRevisionData&&r.xRevisionData.length>0?o._loadItemWithXrevCtx(r.xRevisionData,r.usrPrfItemConf):o.contentListView.refresh(t)}))})).catch((function(){if(o.itemId&&o.contentListView&&o.contentListView.catflBIFilter&&o.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:o.itemId}),o.currentlyOpenedItems[o.currentlyOpenedItems.length-1]===o.itemId)if(o.previouslyOpenedItems.indexOf(o.itemId)>=0&&(o.previouslyOpenedItems=o.previouslyOpenedItems.filter((e=>e!==o.itemId))),o.currentlyOpenedItems.indexOf(o.itemId)>=0&&(o.currentlyOpenedItems=o.currentlyOpenedItems.filter((e=>e!==o.itemId))),widget.setValue("previouslyOpenedItems",JSON.stringify(o.previouslyOpenedItems)),widget.setValue("currentlyOpenedItems",JSON.stringify(o.previouslyOpenedItems)),0===o.currentlyOpenedItems.length)widget.deleteValue("currentOpenedItem"),o.itemId=null,e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"});else{let t=o.currentlyOpenedItems[o.currentlyOpenedItems.length-1];t&&e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:t}})}else widget.deleteValue("currentOpenedItem"),o.itemId=null,e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"})})),e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-properties",data:{items:o.contentListView.contentView.treeDocument.getSelectedNodes(),contentView:o.contentListView.contentView}})},_loadItemWithConfigCtx:function(t,i){var n=this,o=e.getFLWebModelEventsObj("flweb-model-events"),r=widget.getValue("currentConfig");i=i&&UWA.is(i,"string")?JSON.parse(i):i;var a=[];if(t.forEach((function(e){a.push(e.physicalid)})),i){var s,d,u,p=i[n.itemId];if(p&&(s=p.model,d=p.modelVersion,u=p.pc),!p||a.indexOf(s)<0)return void o.publish({event:"allmod-selection-successful",data:{itemID:n.itemId}});var g=[];s&&g.push(s),d&&g.push(d),u&&g.push(u),l.getItemInfo(g).then((function(e){var t,i,r;(e=e.member).forEach((function(e){e.type===m.type_model?((t={}).physicalid=e.physicalid,t.name=e.name,t.id=e.objectid,t.displayName=e.title):e.type===m.type_products?((i={}).physicalid=e.physicalid,i.backEndName=e.name,i.name=e.title,i.revision=e.revision,i.current=e.current):m.type_productConfiguration&&((r={}).physicalid=e.physicalid,r.name=e.title,r.filterCompiledForm=e.filterCompiledForm)})),r?r.filterCompiledForm?o.publish({event:"mod-PC-selection-successful",data:{itemID:n.itemId,model:t,modelVer:i,pc:r,filterCompiledForm:r.filterCompiledForm}}):c.createVolatileFilter({modelID:t.physicalid,modelName:t.name,modelVerName:i.backEndName,modelVerRev:i.revision}).then((function(e){o.publish({event:"mod-PC-selection-successful",data:{itemID:n.itemId,model:t,modelVer:i,pc:r,filterCompiledForm:e.filterBinaryForExpand}})})):c.createVolatileFilter({modelID:t.physicalid,modelName:t.name,modelVerName:i.backEndName,modelVerRev:i.revision}).then((function(e){o.publish({event:"mod-PC-selection-successful",data:{itemID:n.itemId,model:t,modelVer:i,pc:null,filterCompiledForm:e.filterBinaryForExpand}})}))}))}else{var f;r&&(f=r.model?r.model.physicalid:r.physicalid),(!r||f&&a.indexOf(f)<0)&&o.publish({event:"allmod-selection-successful",data:{itemID:n.itemId}})}},_loadItemWithXrevCtx:function(t,i){var n=this,o=e.getFLWebModelEventsObj("flweb-model-events"),r=t[0].xRevisionGraph,a=widget.getValue("xRevision");if(i=i&&UWA.is(i,"string")?JSON.parse(i):i){var s,l,d=i[n.itemId];if(!d)return void o.publish({event:"allmod-selection-successful",data:{itemID:n.itemId}});s=d.xRevVerId,l=d.xRevVer;s&&[].push(s),c.createVolatileFilter({modelID:r.physicalid,modelVerRev:l||a.xRevVer,type:"xRevisionElement"}).then((function(e){e&&e.filterBinaryForExpand?o.publish({event:"mod-PC-selection-successful",data:{itemID:widget.getValue("currentOpenedItem"),xRevAttachedId:r.physicalid,xRevVerId:s||a.xRevVerId,xRevVer:l||a.xRevVer,filterCompiledForm:e.filterBinaryForExpand,type:"xRevisionElement"}}):o.publish({event:"allmod-selection-successful",data:{itemID:n.itemId}})}))}else o.publish({event:"allmod-selection-successful",data:{itemID:n.itemId}})},_createIdCard:function(t){var r=this;return r.idcardContainer.innerHTML="",r.triptych.getMainPanelContainer().querySelector(".fl-cockpit-triptych-main-container").classList.remove("fl-cockpit-idcard-container-hidden"),t.contentView=r.contentListView.contentView,i.init(r.idcardContainer,t,r.triptych.modelEvents,r.currentlyOpenedItems&&r.currentlyOpenedItems.length>1,r.currentlyClosedItems&&r.currentlyClosedItems.length>0,r.nextItemData,r.prevItemData).then((function(t){r.idcard=t,t.idcardModelEvents.subscribe({event:"triptych-toggle-panel"},(function(){e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-properties",data:{items:r.contentListView.contentView.treeDocument.getSelectedNodes(),contentView:r.contentListView.contentView}}),r.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"right"})})),t.idcardModelEvents.subscribe({event:"welcome-panel-toggle"},(function(){r.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"left"})})),t.idcardModelEvents.subscribe({event:"navigate-backward"},(function(){if(r.currentlyOpenedItems.length>1){var e=r.currentlyOpenedItems.pop();r.currentlyClosedItems.push(e),r.navigate()}})),t.idcardModelEvents.subscribe({event:"navigate-forward"},(function(){if(r.currentlyClosedItems.length>0){var e=r.currentlyClosedItems.pop();r.currentlyOpenedItems.push(e),r.navigate()}})),t.idcardModelEvents.subscribe({event:"idcard-show-landing-page"},(function(){widget.deleteValue("currentOpenedItem"),widget.deleteValue("currentlyOpenedItems"),widget.deleteValue("currentlyClosedItems"),widget.setValue("currentView","LandingPage"),widget.deleteValue("ngFilter"),widget.subscribedToKeyDownUp&&(window.removeEventListener("keydown",r._manageKeyDownShortcutKey.bind(r)),window.removeEventListener("keyup",r._manageKeyUpShortcutKey.bind(r)),widget.subscribedToKeyDownUp=!1),r.itemId&&r.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:r.itemId}),r.itemId=null,r.currentlyOpenedItems=null,e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"})})),t.idcardModelEvents.subscribe({event:"check-unicity-AN"},(function(){if(1===widget.getValue("databaseModeActive"))s.alertMessage("warning",null,f.warn_check_an_duplication_only_indexed_mode);else{var e=r.contentListView.contentView.treeDocument.getRoots()[0],t=[];e&&(t=e.getChildren());var i;i=t.filter((function(e){return e.options.grid.architectureNumber&&!e.options.linkInfo&&"RFLVPMLogicalReference"===e.options.type&&e.options.instance})),o.updateEffectivityCompiledFormForNodes(t).then((function(){new n({refWithConfig:e,nodesToCheck:i})})).catch((function(){s.alertMessage("error",null,f.error_check_an_services_failed)}))}})),widget.subscribedToKeyDownUp||(window.addEventListener("keydown",r._manageKeyDownShortcutKey.bind(r)),window.addEventListener("keyup",r._manageKeyUpShortcutKey.bind(r)),widget.subscribedToKeyDownUp=!0),s.makeDroppable(r.idcardContainer.querySelector(".xapp-id-card-container"),f.msg_drop_to_open,r.manageIDCardDrop.bind(r))}))},_manageKeyDownShortcutKey:function(e){var t=this;"LandingPage"!==widget.getValue("currentView")&&(e.altKey&&"ArrowLeft"===e.key&&!t.altLeftPressed?(e.stopPropagation(),e.preventDefault(),t.idcard.idcardModelEvents.publish({event:"navigate-backward"}),t.altLeftPressed=!0):e.altKey&&"ArrowRight"===e.key&&!t.altRightPressed&&(e.stopPropagation(),e.preventDefault(),t.idcard.idcardModelEvents.publish({event:"navigate-forward"}),t.altRightPressed=!0))},_manageKeyUpShortcutKey:function(e){"LandingPage"!==widget.getValue("currentView")&&(e.altKey||"ArrowLeft"===e.key||"ArrowRight"===e.key)&&(e.stopPropagation(),e.preventDefault(),this.altRightPressed=this.altLeftPressed=!1)},manageIDCardDrop:function(t){e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-drop-item",data:{item:t,context:this}})},navigate:function(){var e=this;widget.setValue("previouslyOpenedItems",JSON.stringify(e.previouslyOpenedItems)),widget.setValue("currentlyOpenedItems",JSON.stringify(e.currentlyOpenedItems)),widget.setValue("currentlyClosedItems",JSON.stringify(e.currentlyClosedItems));var t=e.triptych.getMainPanelContainer().querySelector(".fl-cockpit-triptych-main-container");t.classList.add("fl-cockpit-idcard-container-hidden"),t.classList.add("flweb-cockpit-idcard-minified");var i=e.currentlyOpenedItems[e.currentlyOpenedItems.length-1];e.load(i,!0);var n=e.contentListView.contentView.treeDocument.getRoots()[0];n&&e.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:n.getID()})}}})),define("DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.controller",["UWA/Core","DS/UIKIT/Mask","DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.checklist","DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.actions","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l){"use strict";return l=JSON.parse(l),{init:function(e){var t=this;t.appContext=e,t.cuesChecklist=[];var i=a.getFLWebModelEventsObj("flweb-model-events");i.subscribe({event:"flcockpit-convergence-cues-checklist"},t.displayCuesChecklist.bind(t)),i.subscribe({event:"flcockpit-convergence-cues-actions"},t.displayCuesActionLinks.bind(t))},displayCuesChecklist:function(){var e=this;e.cuesChecklist.length>0?e.viewCuesChecklist():s.getVisualCues().then((function(t){t.cues.length>0&&(t.cues.forEach((function(t){e.cuesChecklist.push({id:t.cueId,title:t.cueLabel,icon:t.cueIcon})})),e.viewCuesChecklist())}))},viewCuesChecklist:function(){var e=this;s.getUserPreferences(l.user_pref_cues).then((function(t){if(t){var n=t.cues_state||t,o=t.combined_state||{};e.cuesChecklist.forEach((function(e){n.hasOwnProperty(e.id)?(e.checked=!0,e.severity=n[e.id].cueSeverity):(e.checked=!1,e.severity="INFO")}))}i.displayCuesChecklist(e.cuesChecklist,o)}))},displayCuesActionLinks:function(e){var t=this;s.getUserPreferences(l.user_pref_cues).then((function(i){i&&Object.keys(i).length>0&&n.displayCuesActionsonInstance(i,t.appContext,e)}))}}})),define("DS/CATFLCockpitWidget/components/WelcomePanel/welcomepanel.controller",["DS/CoreEvents/ModelEvents","DS/CATFLCockpitWidget/utils/model.events.util","DS/ENOXWelcomePanel/js/ENOXWelcomePanel","DS/CATFLCockpitWidget/components/LandingPage/referencesView","DS/CATFLCockpitWidget/utils/SAXTracker","text!DS/CATFLCockpitWidget/assets/config/welcomepanel.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a){"use strict";var s=JSON.parse(r),l=!1;return{init:function(r,c,d){l||this.mapNLSLabels();var u=new e,p={collapsed:!1,activities:s.activities,parentContainer:r,modelEvents:u};u.addEventListener("welcome-panel-action-selected",(function(e){if("action_new_logical_ref"===e.id){var i=document.body.getElement(".fl-cockpit-triptych-main-container"),r=t.getFLWebModelEventsObj("flcockpit-content-list-view");r||(r=t.createAppEventObject("flcockpit-content-list-view")),n.newLogRef(r,i)}else if("action_conf_convergence_cues"===e.id)o.trackCommandLaunched("manageConvergence-sax"),t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flcockpit-convergence-cues-checklist"});else if("action_my_references"===e.id){let e=(s=document.body.getElement(".fl-cockpit-triptych-main-container")).getElement(".fl-recents-container");e.empty(),e.hide();let t=s.getElement(".fl-itemPage-container");t&&(t.empty(),t.hide());let i=s.getElement(".fl-myReferences-container");i.show(),document.body.querySelector("#action_recents").classList.value="activity-btn",widget.setValue("currentView","LandingPage"),widget.setValue("landingPage","My References"),widget.deleteValue("currentlyOpenedItems"),widget.deleteValue("currentlyClosedItems"),widget.deleteValue("currentOpenedItem"),widget.deleteValue("ngFilter"),n.init({id:"myReferences",title:a.label_myReferences,container:i,triptych:c,rightPanel:d})}else if("action_recents"===e.id){var s;let e=(s=document.body.getElement(".fl-cockpit-triptych-main-container")).getElement(".fl-myReferences-container");e.empty(),e.hide();let t=s.getElement(".fl-itemPage-container");t&&(t.empty(),t.hide());let i=s.getElement(".fl-recents-container");i.show(),document.body.querySelector("#action_my_references").classList.value="activity-btn",widget.setValue("currentView","LandingPage"),widget.setValue("landingPage","Recents"),widget.deleteValue("currentlyOpenedItems"),widget.deleteValue("currentlyClosedItems"),widget.deleteValue("currentOpenedItem"),widget.deleteValue("ngFilter"),n.init({id:"recents",title:a.label_recents,container:i,triptych:c,rightPanel:d})}else"action_open"===e.id&&t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-open-welcomePanel"})})),new i(p).render()},mapNLSLabels:function(){s.activities&&s.activities.forEach((function(e){e.title=a[e.title],e.actions&&e.actions.forEach((function(e){e.text=a[e.text]}))})),l=!0}}})),define("DS/CATFLCockpitWidget/CATFLCockpitWidgetLandingPage",["DS/Windows/ImmersiveFrame","DS/WebUAUtils/WebUAUtils","DS/ENOXTriptych/js/ENOXTriptych","DS/PlatformAPI/PlatformAPI","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.effectivity","DS/CATFLCockpitWidget/components/PropertiesPanel/propertiespanel.controller","DS/CATFLCockpitWidget/components/WelcomePanel/welcomepanel.controller","DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.controller","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/LandingPage/referencesView","DS/CATFLCockpitWidget/components/LandingPage/itemPage","DS/CATFLCockpitWidget/mixins/CATFLBIFilter","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,f,m,h,v){var C=d.getFullConfig(),y=C.identifiers;return p.configureSearch(),{init:function(e){var t=this;u.clearSubscriptionList(),t.ctxItemPage=null;var i=u.createAppEventObject("flweb-model-events");t.setImmersiveFrame(e),t.setUAPanel(),t._initTriptychComponent(t.container),l.init(t),t.propertiesPanel=a.init(t.triptych),t.propertiesPanel.modelEvents.subscribe({event:"properties-panel-on-save"},(function(){widget.getValue("currentView")&&"LandingPage"!==widget.getValue("currentView")&&i.publish({event:"idcard-refresh"})})),t.welcomePanelController=s.init(t.triptych.getLeftPanelContent(),t.triptych,t.propertiesPanel),t.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"left"}),t.createLayoutContainers(t.triptychMainContainer),t.manageLandingPageEvents(i),widget.bSubscribedToCfgEvents||t.subscribeToCfgEvents();var n=widget.getValue("X3DContentId"),o=widget.getValue("previouslyOpenedItems");if(o&&(o=JSON.parse(o)),(!o||o.length<=0)&&n){var r=JSON.parse(n).data.items;if(r.length>1)c.alertMessage("error",null,v.error_open_several_obj),widget.deleteValue("X3DContentId"),u.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"});else{var p=r[0],m=p.objectId,C=p.objectType;if(p.envId=p.envId?p.envId:d.getTenant(),C&&""!==C)if(C===y.type_act_advfilter){t.ctxItemPage||t.loadItemPage({});var b=t.ctxItemPage;b.contentListView.catflBIFilter=new h({});var _=b.contentListView.contentView.treeDocument.getRoots()[0];_&&b.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:_.getID()}),b.contentListView.catflBIFilter.retrieveFilterInfo(b,p)}else g.getKindOfRFLP([m]).then((function(e){e&&"L"===e[0]?u.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:m,itemType:C}}):(c.alertMessage("error",v.msg_invalid_type,v.msg_open_invalid_type),widget.deleteValue("X3DContentId"),u.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"}))}));else g.getItemInfo([m]).then((function(e){(e=e.member).forEach((function(e){if(e.type===y.type_act_advfilter){t.ctxItemPage||t.loadItemPage({});var i=t.ctxItemPage;i.contentListView.catflBIFilter=new h({});var n=i.contentListView.contentView.treeDocument.getRoots()[0];n&&i.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:n.getID()}),i.contentListView.catflBIFilter.retrieveFilterInfo(i,e)}else g.getKindOfRFLP([m]).then((function(e){e&&"L"===e[0]?u.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:m,itemType:C}}):(c.alertMessage("error",v.msg_invalid_type,v.msg_open_invalid_type),widget.deleteValue("X3DContentId"),u.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"}))}))}))}))}}else if(widget.getValue("currentView")&&"LandingPage"!==widget.getValue("currentView")){var w=widget.getValue("currentOpenedItem");if(w){var D={itemPID:w};t.loadItemPage(D)}}else if("Recents"===widget.getValue("landingPage")||void 0===widget.getValue("landingPage")){widget.setValue("landingPage","Recents"),widget.deleteValue("currentlyOpenedItems");let e=v.label_recents,i="recents";t.triptychMainContainer.getElement(".fl-myReferences-container").hide(),f.init({id:i,title:e,container:t.triptychMainContainer.getElement(".fl-"+i+"-container"),triptych:t.triptych,rightPanel:t.propertiesPanel})}else if("My References"===widget.getValue("landingPage")){widget.deleteValue("currentlyOpenedItems");let e=v.label_myReferences,i="myReferences";t.triptychMainContainer.getElement(".fl-recents-container").hide(),f.init({id:i,title:e,container:t.triptychMainContainer.getElement(".fl-"+i+"-container"),triptych:t.triptych,rightPanel:t.propertiesPanel})}},manageLandingPageEvents:function(e){let t=this;e.subscribe({event:"flweb-load-landingPage"},(function(){widget.body.empty(),widget.setValue("currentView","LandingPage"),widget.deleteValue("ngFilter"),widget.deleteValue("currentOpenedItem"),widget.deleteValue("currentlyOpenedItems"),t.ctxItemPage=null,t.init(widget.body)})),e.subscribe({event:"flweb-load-item"},(function(e){"LandingPage"===widget.getValue("currentView")?(t.ctxItemPage=null,t.loadItemPage(e)):t.loadItemPage(e)})),e.subscribe({event:"flweb-drop-item"},(function(e){t.manageDrop(e)})),e.subscribe({event:"flweb-load-properties"},(function(e){e.showPropertiesPanel&&!t.triptych._isRightOpen&&(t.triptych.modelEvents.publish({event:"triptych-show-panel",data:"right"}),t.triptych._container.getElement(".fonticon.fonticon-2x.fonticon-info")&&t.triptychMainContainer.getElement(".fonticon.fonticon-2x.fonticon-info").classList.add("selected")),t.propertiesPanel.loadModel(e.items,e.isImplLinkInfo,e.contentView)})),e.subscribe({event:"flweb-open-welcomePanel"},(function(){t.openSearchPage()})),e.subscribe({event:"flweb-manage-workUnder"},(function(e){t.updateWorkUnder(e)})),e.subscribe({event:"allmod-selection-successful"},t.updateUserPrefOnItemConf.bind(t,"allmod-selection-successful")),e.subscribe({event:"mod-PC-selection-successful"},t.updateUserPrefOnItemConf.bind(t,"mod-PC-selection-successful")),e.subscribe({event:"mod-selection-removed"},t.updateUserPrefOnItemConf.bind(t,"mod-selection-removed"))},subscribeToCfgEvents:function(){let e=this;n.subscribe("cfgEditConfigurationContextModification_"+widget.id,r.modifiedEditCfgCtx.bind(e)),n.subscribe("cfgEffectivityModifications_"+widget.id,r.refreshEffectivityChanges.bind(e)),n.subscribe(o.myAuthkey,(function(t){var i=t.change,n={};n.type=y.workUnder_change,n.id=i.id,n.name=i.name,n.id&&e.updateUserPrefOnWorkUnder(n,"active")})),n.subscribe("sessionEff",(function(t){var i={};i.type=y.workUnder_evolution,Object.assign(i,t),(i.ACId||i.evolution.id)&&e.updateUserPrefOnWorkUnder(i,"active")})),n.subscribe("toggleActiveSE"+o.myAuthkey,(function(){e.updateUserPrefOnWorkUnder(null,"active")})),n.subscribe("toggleDeActiveSE"+o.myAuthkey,(function(){e.updateUserPrefOnWorkUnder(null,"deactive")})),n.subscribe("removeAuthCtxSessionEvent"+o.myAuthkey,(function(){e.updateUserPrefOnWorkUnder(null,"remove")})),n.subscribe("toggleActiveCA"+o.myAuthkey,(function(){e.updateUserPrefOnWorkUnder(null,"active")})),n.subscribe("toggleDeActiveCA"+o.myAuthkey,(function(){e.updateUserPrefOnWorkUnder(null,"deactive")})),n.subscribe("removeAuthCtxEvent"+o.myAuthkey,(function(){e.updateUserPrefOnWorkUnder(null,"remove")})),widget.bSubscribedToCfgEvents=!0},manageDrop:function(e){var t=this;let i=e.item,n=e.context,o=n?n.contentListView:void 0;var r=u.getFLWebModelEventsObj("flweb-model-events");if(i&&i.length>0&&i[0].envId!==d.getTenant()){if(!c.validateTenant(i[0]))return;widget.deleteValue("previouslyOpenedItems"),o&&o.catflBIFilter&&(o.catflBIFilter._biFilter._biFilter._tenantId=d.getTenant())}if(i&&i.length>0&&i[0].objectType===y.type_act_logref)u.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:i[0].objectId,itemType:i[0].objectType}});else if(i&&i.length>0&&i[0].objectType===y.type_act_advfilter){if(C.disableIndexAcceleration)return c.alertMessage("warning",null,v.warn_filter_only_indexed_mode),void r.publish({event:"flweb-drop-success"});var a=i[0];o||(n||(t.loadItemPage({}),n=t.ctxItemPage),o=n.contentListView,o.catflBIFilter?o.catflBIFilter.updateModel(o.contentView):o.catflBIFilter=new h({view:o.contentView}));var s=o.contentView.treeDocument.getRoots()[0];s&&o.catflBIFilter.removeRootFromFilterProxy({rootId2remove:s.getID()}),o.catflBIFilter.retrieveFilterInfo(n,a),t.updatePreviouslyOpenedItems(a),r.publish({event:"flweb-drop-success"})}else i&&i.length>0?g.getKindOfRFLP([i[0].objectId]).then((function(e){if(e&&"L"===e[0]){if(o&&o.catflBIFilter){var t=o.contentView.treeDocument.getRoots()[0];t&&o.catflBIFilter.removeRootFromFilterProxy({rootId2remove:t.getID()})}u.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:i[0].objectId,itemType:i[0].objectType}}),r.publish({event:"flweb-drop-success"})}else c.alertMessage("error",null,v.msg_drop_invalid_type)})).catch((function(e){c.displayError(e,null,null,v.msg_drop_invalid_type)})):c.alertMessage("error",null,v.msg_drop_invalid_type);var l=d.form3DXContent([]);d.setObjectOnCompass(l)},_initTriptychComponent:function(e){var t=this,n=u.createAppEventObject("flweb-triptych-model-events"),o={left:{resizable:!0,overMobile:!1,minWidth:300},right:{resizable:!0,overMobile:!1},container:e,withtransition:!0,modelEvents:n};t.triptychMainContainer=UWA.createElement("div"),t.triptychMainContainer.classList.add("fl-cockpit-triptych-main-container");var r=UWA.createElement("div");r.classList.add("fl-cockpit-triptych-right-container");var a=UWA.createElement("div");a.classList.add("fl-cockpit-triptych-left-container"),t._initCfgAuthoringContext(widget.immersiveFrame.elements.container),t.triptych=new i,t.triptych.init(o,a,t.triptychMainContainer,r),t.triptych.modelEvents=n},_initCfgAuthoringContext:function(e){const t=c.getUserWorkUnderShowPref()?"show":"hide";var i=c.getUserWorkUnderPositionPref();if(o.initialize2(e,widget.id,t,i,(function(e){console.warn(e)}),{isEditable:!0,isEvolution:!0,isChange:!0,isMovable:!0,resetDefault:!1}),i===y.workUnder_pos_freeValue){var n=widget.getValue("bubble-top"),r=widget.getValue("bubble-left"),a=e.querySelector("#BubbleContainer");a&&(n&&r&&a.setStyles({top:n,left:r}),c.setCfgAuthoringContextDragEvent(e))}},setImmersiveFrame:function(t){var i=UWA.createElement("div");i.classList.add("fl-cockpit-app-container"),this.container=i,widget.immersiveFrame=new e({}),widget.immersiveFrame.setContentInBackgroundLayer(i),widget.immersiveFrame.inject(t)},setUAPanel:function(){t.setPanelHelpMode({immersiveFrame:widget.immersiveFrame});let e=t.getCurrentUAPanel();e&&e.setImmersiveFrameContainer(widget.immersiveFrame);try{t.closePanelHelp()}catch(e){console.log("UA Panel already closed")}},createLayoutContainers:function(e){UWA.createElement("div",{class:"fl-recents-container"}).inject(e),UWA.createElement("div",{class:"fl-myReferences-container"}).inject(e),UWA.createElement("div",{class:"fl-itemPage-container"}).inject(e)},loadItemPage:function(e){var t=this,i=t.triptych.getMainPanelContainer().querySelector(".fl-cockpit-triptych-main-container");if(i.classList.add("fl-cockpit-idcard-container-hidden"),i.classList.add("flweb-cockpit-idcard-minified"),document.body.querySelector("#action_my_references").classList.value="activity-btn",document.body.querySelector("#action_recents").classList.value="activity-btn",t.ctxItemPage){if(t.ctxItemPage.contentListView&&t.ctxItemPage.contentListView.catflBIFilter){var n=t.ctxItemPage.contentListView.contentView.treeDocument.getRoots()[0];n&&t.ctxItemPage.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:n.getID()})}m.load(e.itemPID)}else{t.triptych.getLeftOpen()&&t.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"left"});let n=i.getElement(".fl-myReferences-container");n.empty(),n.hide();let o=i.getElement(".fl-recents-container");o.empty(),o.hide();let r=i.getElement(".fl-itemPage-container");r&&(UWA.createElement("div",{class:"fl-cockpit-idcard-container"}).inject(r),UWA.createElement("div",{class:"fl-cockpit-content-list-container"}).inject(r)),r.show(),t.ctxItemPage=m.init(e,r,t.triptych,t.propertiesPanel)}},updateUserPrefOnItemConf:function(e,t){g.getUserPreferences(y.user_pref_openedItems_conf).then((function(i){if(i){var n=UWA.is(i,"string")?JSON.parse(i):i,o=!1;if("allmod-selection-successful"===e||"mod-selection-removed"===e)n[t.itemID]&&(delete n[t.itemID],o=!0);else{if(!n[t.itemID]){if(Object.keys(n).length===y.limit_usrPref_openedItems_conf)delete n[Object.keys(n)[0]];n[t.itemID]={}}"xRevisionElement"===t.type?(n[t.itemID].xRevAttachedId=t.xRevAttachedId,n[t.itemID].xRevVerId=t.xRevVerId,n[t.itemID].xRevVer=t.xRevVer,o=!0):(n[t.itemID].model=t.model.physicalid,n[t.itemID].modelVersion=t.modelVer.physicalid,n[t.itemID].pc=t.pc?t.pc.physicalid:null,o=!0)}o&&g.setUserPreferences({name:y.user_pref_openedItems_conf,value:JSON.stringify(n)}).then((function(){}))}}))},updateUserPrefOnWorkUnder:function(e,t){e&&t?(e.status=t,g.setUserPreferences({name:y.user_pref_workunder,value:JSON.stringify(e)}).then((function(){}))):"active"===t||"deactive"===t?g.getUserPreferences(y.user_pref_workunder).then((function(e){if(e){var i=UWA.is(e,"string")?JSON.parse(e):e;i.status=t,g.setUserPreferences({name:y.user_pref_workunder,value:JSON.stringify(i)}).then((function(){}))}})):g.setUserPreferences({name:y.user_pref_workunder,value:null}).then((function(){}))},updateWorkUnder:function(e){if(e){var t=e.rez;if(t){var i=UWA.is(t,"string")?JSON.parse(t):t,n=()=>{"deactive"===i.status?o.deactivateBubble():o.activateBubble()};if(i.type===y.workUnder_change){let e={change:{id:i.id,name:i.name}};o.set(e,n)}else i.type===y.workUnder_evolution&&o.setEffectivity(i,n)}}},openSearchPage:function(){var e=this;let t=y.type_act_logref+","+y.type_act_advfilter;p.launchSearch({searchTitle:v.label_select_reference_to_open,allowedTypes:t,role:"",criteria:t,bMultiSel:!1,in_apps_callback:function(t){let i=t[0];if(i)if(i["ds6w:type_value"]===y.type_act_advfilter){if(C.disableIndexAcceleration)return void c.alertMessage("warning",null,v.warn_filter_only_indexed_mode);var n=e.ctxItemPage;n||(e.loadItemPage({}),(n=e.ctxItemPage).contentListView.catflBIFilter?n.contentListView.catflBIFilter.updateModel(n.contentListView.contentView):n.contentListView.catflBIFilter=new h({view:n.contentListView.contentView}));var o=n.contentListView.contentView.treeDocument.getRoots()[0];o&&n.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:o.getID()});var r={envId:d.getTenant(),serviceId:"3DSpace",contextId:"ctx::"+d.getSecurityContext(),objectId:i.resourceid,objectType:i["ds6w:type_value"],i3dx:"",displayType:i["ds6w:type"]};n.contentListView.catflBIFilter.retrieveFilterInfo(n,r),e.updatePreviouslyOpenedItems(r)}else u.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:i.resourceid,itemType:i["ds6w:type_value"]}})}})},updatePreviouslyOpenedItems:function(e){var t=widget.getValue("previouslyOpenedItems");let i=(t=t?JSON.parse(t):[]).indexOf(e.objectId);i>=0?t.splice(i,1):t.length===y.limit_recents&&t.shift(),t.push(e.objectId),t=JSON.stringify(t),widget.setValue("previouslyOpenedItems",t)}}})),define("DS/CATFLCockpitWidget/CATFLCockpitWidgetMain",["DS/CATFLCockpitWidget/CATFLCockpitWidgetLandingPage","DS/CATFLCockpitWidget/services/config.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/WUXAutoComplete/AutoComplete","DS/CATFLCockpitWidget/utils/preferences.util","DS/CATFLCockpitWidget/utils/widgetlink.util","DS/PlatformAPI/PlatformAPI","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","css!DS/CATFLCockpitWidget/CATFLCockpitWidget"],(function(e,t,i,n,o,r,a,s,l){"use strict";var c=i.getFullConfig(),d=c.localStorageKeys,u=c.identifiers;return{onLoad:function(){var n=widget.body;n.empty(),void 0===widget.getValue(d.componentView)&&widget.setValue(d.componentView,d.structuredView),void 0===widget.getValue(d.structureFilter)&&widget.setValue(d.structureFilter,"filterDefaultStructure"),widget.getValue("configurable_expand")||widget.setValue("configurable_expand",{refDocs:!0,specDocs:!0,proposedSolution:!0,implementedBy:!0,isImplementedBy:!0,implementing:!0,isImplementing:!0}),i.getPlatformServices().then((function(o){var s=[];s.push(i.retrieveCurrentUser()),s.push(i.retrieveCSRFToken()),s.push(r.getNSaveUserCustomAttributes()),s.push(r.getNSaveUserCustomAttributes(!0)),s.push(r.getCustomHeaderView());var c=a.linkWidget();if(s.push(c),i.refreshCSRFToken(),!1===o){var d=UWA.createElement("div",{styles:{height:"100%",width:"100%","font-size":"14px",display:"flex","flex-direction":"column"}}),u=UWA.createElement("div",{styles:{margin:"auto",width:"60%",padding:"10px"}}),p=UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-3x wux-ui-3ds-alert",styles:{height:"100%",float:"left","padding-right":"9px","padding-top":"5px",color:"#77797C"}}),g=UWA.createElement("div",{html:l.label_widgetError+"<br>"+l.label_noCredentialError,styles:{"font-size":"18px",color:"#77797C",height:"100%"}});return p.inject(u),g.inject(u),u.inject(d),d.inject(n),1}o.defaultValue||""==i.getSecurityContext()||(o.defaultValue=i.getSecurityContext()),r.buildPreferences({credentialList:o}).then((function(){Promise.all(s).then((function(){t.extendConfiguration(i.getFullConfig()).finally((function(){widget.body.empty(),e.init(widget.body)}))}))}))}))},onRefresh:function(){if(widget.body.empty(),widget.getPreference("xPref_3DEXPERIENCE_PLATFORM")&&widget.getPreference("xPref_3DEXPERIENCE_PLATFORM").value!==i.getTenant()){let e={},t=widget.getPreference("xPref_3DEXPERIENCE_PLATFORM").options;for(let i=0;i<t.length;i++)t[i].value===widget.getPreference("xPref_3DEXPERIENCE_PLATFORM").value&&(e.envId=t[i].value,e.displayName=t[i].label);n.validateTenant(e)&&(widget.deleteValue("currentOpenedItem"),widget.deleteValue("currentlyOpenedItems"),widget.setValue("currentView","LandingPage"),widget.deleteValue("ngFilter"),widget.setValue("previouslyOpenedItems",JSON.stringify([])),widget.setTitle(""))}e.init(widget.body),s.publish("NGFilter.RemoveConfigurationRevision_"+widget.id),enoviaServerFilterWidget&&(enoviaServerFilterWidget.tenant=i.getTenant())},endEdit:function(){r.setWorkUnderPreferences(),n.getUserWorkUnderPositionPref()===u.workUnder_pos_freeValue?n.setCfgAuthoringContextDragEvent():n.unsetCfgAuthoringContextDragEvent()}}}));