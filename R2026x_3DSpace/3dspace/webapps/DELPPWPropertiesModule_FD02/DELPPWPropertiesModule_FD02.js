define("DS/DELPPWPropertiesModule_FD02/PropertiesModule",["UWA/Core","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/constants/EditPropConstants","DS/DELWebInfrastructureControls/DELWebAddExtensionsWidget"],(function(e,t,n,o,i){"use strict";return{behaviors:["UXFactoryBehavior","SelectionBehavior","ModelBehavior","ResourceBehavior","DocumentBehavior"],creator:function(r,a,c,s,l,u){var d,p,m,g,f,D,E,S,R,C,P,y,h,v,b,F=[];return S=function(){var n,i,S,R,P,y,h,L=r.getElement(),x=a.getComponent("WUXDockAreaEnum"),I=a.getComponent("WUXFrameWindowsManager").getFrameWindow(r.getAppContext());e.is(I)&&(n=I.getImmersiveFrame(),e.is(n)&&(h={position:{at:"top right"},side:x.RightDockArea,currentDockArea:x.RightDockArea,title:l.getNLSValue("Cmd.DisplayProperties.Title"),minWidth:450,height:300,content:L,resizableFlag:!0,visibleFlag:!1,collapsibleFlag:!0,floatableFlag:!0,verticallyStretchableFlag:!0},e.is(p)&&(h.domId=p),(d=a.create("Panel",h)).close=function(){r.notify("toggleCmdCheckHeaderState",{cmdName:"DisplayProperties",cmdState:!1})},d.immersiveFrame=n,y=n.getDockingElement(d.currentDockArea),e.is(y)&&(y.collapseDockingZoneFlag=!1),m=new t({className:"DisplayPropertiesPanel",typeOfDisplay:o.ALL,selectionType:o.NO_SELECTION,displayType:o.STANDARD,readOnly:!1,extraNotif:!0,editMode:!1}),g=(g=s.get3DSpaceUrl()).endsWith("/")?g.substring(0,g.length-1):g,f=s.getTenant(),(D={}).selectedId=s.getReferenceId(F[0]),D.platformUrl=g,D.platformTenant=f,D.getSecurityContext=function(){return s.getSecurityContext()},D.getSelectedRefId=function(){return v()},D.addDocument=function(e,t){u.addDocument(t,{silent:!0}),u.addDocumentConnection(e,t.id,t.relName,{silent:!0}),r.notify("addDocumentConnections",[[e]]),r.notify("attachDocument",{})},D.deleteDocument=function(t,n,o){if(!e.is(o)){const e=u.getConnectedDocumentPIDs(t);Array.isArray(e)&&e.length>0&&(o=e.includes(`SpecificationDocument|${t}|${n}`)?"SpecificationDocument":"PLMDocConnection")}u.removeDocumentConnection(t,n,o),r.notify("attachDocument",{})},i=s.getReferenceModel(v()),e.is(i)&&"PRODUCT"!==i.get("PPRTYPE")&&m.addFacets([{require:"DS/DELPPWEnoDocuments_FD02/SpecificationsFacet",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"SpecificationDocuments",icon:"docs",text:l.getNLSValue("SpecificationsFacet.Specifications")},options:{appContext:D}},{require:"DS/DELPPWEnoDocuments_FD02/AttachmentsFacet",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"RelatedDocuments",icon:"attach",text:l.getNLSValue("AttachmentsFacet.Attachments")},options:{appContext:D}}]),E&&(R=m.controller.skeleton.getFacetContent("properties"),S=a.getComponent("Button"),R.editPropertiesUI.subscribeEvt("editionSwitched",(function(t){P=!1,1===c.getSelectedNodesCount()&&t&&(i=s.getReferenceModel(v()),e.is(i)&&"RESOURCE"===i.get("PPRTYPE")&&(P=!0)),P?b=new S({domId:"ManageResourceExtnBtn",label:l.getNLSValue("ResourceExtension.ManageCapacityResourceExtension"),onClick:C}).inject(widget.getElement(".TopButtonAdd"),"before"):e.is(b)&&b.remove()}))),m.inject(L)))},C=function(){s.webServiceGETRequest("resources/DELWebInfrastructure/v0/interface/getImmediateDerivative?Extensions=DELRmiResourceModel/DELCapacityRscAbstract","GET",(function(t){var n=t.security_ctx,o=null,a={serverName:"",serverUri:"",displayType:"editProp_standard",extraNotif:!1,context:null,events:{},tabId:"properties",eventThread:"CT27.properties",dialogTitle:l.getNLSValue("ResourceExtension.ManageCapacityResourceExtension"),jsonClassInterfaces:{interfaces:[]},multiSelect:!1,addOnReference:!1};e.is(t.Data)&&e.is(t.Data.DELCapacityRscAbstract)&&(t.Data.DELCapacityRscAbstract.forEach((e=>{a.jsonClassInterfaces.interfaces.push(e.name)})),m.controller&&m.controller.getModels&&(o=m.controller.getModels()[0])),a.addOnReference=s.isInstance(o.get("objectId")),new i(window.widget,this._parent,a,n,o,(function(){m.controller.onRefresh()}),(function(e){r.warn(e)}))}),(function(){console.warn(l.getNLSValue("ResourceExtension.ResourceExtensionFailure"))}))},R=function(){return c.getSelections().reduce((function(e,t){return e.concat(t)}),[])},v=function(){var e=R()[0];return s.getReferenceId(e)},P=function(){return R().map((function(e){return new n({tenant:s.getTenant(),service:"3DSpace",objectId:e})}))},y=function(){var t,n,o,i=!1;e.is(m)&&(E&&(1===c.getSelectedNodesCount()&&(n=s.getReferenceModel(v()),e.is(n)&&"RESOURCE"===n.get("PPRTYPE")&&(i=!0)),i?m.addFacets([{require:"DS/DELWebInfrastructureControls/DELWebResourceParameter/DELWebResourceParameterFacet",alwaysVisible:!0,services:["3DSpace"],facet:{name:"content_section_resource_parameter",text:l.getNLSValue("ResourceParameterFacet.ResourceParameters"),icon:"parameters"},options:{}}]):(o=m.elements.UI.getFacetContent("content_section_resource_parameter"),e.is(o)&&o.destroyComponent(),m.removeFacets(["content_section_resource_parameter"]))),t=P(),m.initDatas(t))},h=function(){y()},{listenTo:function(){return{select:h}},onStart:function(t){E=!!e.is(t.dispalyResourceParameterExtension)&&t.dispalyResourceParameterExtension,e.is(t.identifier)&&(p=t.identifier),S(),y(),e.is(d)&&d.show()},onStop:function(){F=[],e.is(d)&&(d.hide(),e.is(m)&&(m.destroyComponent(),m=null),d.destroy(),d=null)}}}}}));