define("DS/ENORouteMgmt/Model/RemoveRouteTaskConfirmationModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/WebappsUtils/WebappsUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i){"use strict";let n=new e,s=function(e){let t;return t=!e.taskDetails||e.taskAction.includes("showTaskRemove")&&1==e.canShowDeleteTask?{icon:"check wux-ui-3ds"}:{icon:"wrong wux-ui-3ds"},t};return{createModel:i=>{return a=i,n=new e,n.prepareUpdate(),a.forEach((function(e){e.Deleteicon=s(e);var i=new t({label:e.title,id:e.id,width:300,grid:{revision:e.revision,stateNLS:e.stateNLS,current:e.current,Deleteicon:e.Deleteicon},icons:[o.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTask16.png")]});n.addRoot(i)})),n.pushUpdate(),n;var a},getModel:()=>n}})),define("DS/ENORouteMgmt/Model/Utils/TaskModelUtils",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";let i=function(e){let t=e.taskDetails,o=[];return t?t.forEach(((e,t)=>{"true"==e.split("~")[1]&&o.push(e.split("~")[0])})):o.push("showTaskRemove"),o},n=function(e){let t={presentOrder:[]};return e.forEach((function(e){e.userGroupInfo&&e.userGroupAction&&(t.isPresent=!0,t.presentOrder.push(e.taskOrder))})),t},s=function(e){return new t({label:e})},a=function(e,t){e&&(e.options.grid.taskOrder&&(e.options.grid.taskOrder=String(parseInt(e.options.grid.taskOrder)+t)),a(e.getNextNode(),t))},r=function(e){let t={typeicon:"https://vdevpril249blr.dsone.3ds.com:443/3DSpace/snresources/images/icons/small/iconSmallInboxTask.gif",taskOrder:"1",parallelNodeProcessionRule:"All",validTaskData:!1,nodeType:"Route Task",type:"Route Node",templateTask:"No",routeTaskPriority:"Medium"};return e&&"Route Template"==e&&(t.chooseUsersFromUg="False"),t},l=function(e,o){let i={typeicon:"https://vdevpril249blr.dsone.3ds.com:443/3DSpace/snresources/images/icons/small/iconSmallInboxTask.gif",taskOrder:e.taskOrder,parallelNodeProcessionRule:e.taskAction,validTaskData:!1,nodeType:"Route Task",type:"Route Node",templateTask:"No",routeTaskPriority:"Medium"};return"Route Template"==o&&(i.chooseUsersFromUg="False",i.templateTask="Yes"),new t({label:i.title,grid:i})},d=function(e,t){if(e===t)return t;if(t.options.grid.taskOrder!=e.options.grid.taskOrder)throw"Could not find the deleted task node model to delete!";return d(e,t.getNextNode())};return{prepareTreeDocumentModel:(e,o)=>function(e,o){let a,l,d,u=s("Start");o.addRoot(u),0==e.length&&(e=[r(e.parentObjectType)]);let c=n(e);e.forEach((function(e){if(a&&a.taskOrder==e.taskOrder||(l=new t({label:""==e.parallelNodeProcessionRule?"All":e.parallelNodeProcessionRule,grid:{taskOrder:e.taskOrder}}),o.addRoot(l)),c.isPresent&&c.presentOrder.indexOf(e.taskOrder)>-1){if(l._isSplitTaskPresent=!0,o.options._isSplitTaskPresent||(o.options._isSplitTaskPresent=!0),d=void 0,l.getChildren())for(let t=0;t<l.getChildren().length;t++){let o=l.getChildren()[t];if(o.options.grid.userGroupInfo&&o.options.grid.userGroupInfo==e.userGroupInfo){d=o;break}}d||(d=new t({label:e.userGroupAction,grid:{taskOrder:e.taskOrder,userGroupInfo:e.userGroupInfo,nodeType:"UG Action Node"}}),l.addChild(d));let n=i(e);e.taskDetailsList=n,e.id&&(e.validTaskData=!0),e.nodeType="Route Task";let s=new t({grid:e});d.addChild(s)}else{let o=i(e);e.taskDetailsList=o,e.id&&(e.validTaskData=!0),e.nodeType="Route Task";let n=new t({grid:e});l.addChild(n)}a=e}));let p=o.getChildren();p&&p.forEach(((e,t)=>{let o=e.getChildren();o&&1==o.length&&(e.options.label="All",e.getChildren()[0].options.grid.parallelNodeProcessionRule="All")}));let m=s("Finish");o.addRoot(m)}(e,o),getTaskNodeModel:(e,o,i)=>function(e,o,i){"right"==o&&(i+=1),e.prepareUpdate();let n=e.getChildren()[i],s={};e.getChildren().length,s.taskOrder=String(i),s.taskAction="bottom"==o||"top"==o?n.options.label:"All";let r=e.options.routeInfoJSON.model?e.options.routeInfoJSON.model.Type:e.options.routeInfoJSON.Type,d=l(s,r);if(d._isNewlyAdded=!0,e._isTaskAdded=!0,n._isSplitTaskPresent&&("bottom"==o||"top"==o)){let e=new t({label:"All",grid:{taskOrder:String(i),nodeType:"Task Action Node"}});e.addChild(d),d=e}if("bottom"==o)n.addChild(d);else if("top"==o){let e=n.getChildren()[0];n.insertBefore(d,e)}else{let o=n,s=new t({label:"All",grid:{taskOrder:String(i),nodeType:"Task Action Node"}});s.addChild(d),e.insertBefore(s,o),a(o,1)}return e.pushUpdate(),d}(e,o,i),destroy:()=>destroy(),deleteTreeNodeModel:(e,t)=>function(e,t){let o=[],i=[];e.options.grid.graphNode&&o.push(e.options.grid.graphNode),i.push(e);let n=e.getParent(),s=e.getTreeDocument();if(s&&!s.options._isSplitTaskPresent){let t=e.getBrothers().length+1;1==t?(a(e.getNextNode(),-1),n.options.grid.graphNode&&o.push(n.options.grid.graphNode),n.remove()):(2==t&&o.push(n.options.grid.graphNode),e.remove())}else{let i=parseInt(e.options.grid.taskOrder);t||(t=s);let r=t.getChildren()[i];if(r)try{let t=d(e,r.getAllDescendants()[0]);0==e.getBrothers().length&&2==e.getParents().length?0==n.getBrothers().length&&1==n.getParents().length?(a(e.getNextNode(),-1),n.getParent().remove()):n.remove():0==e.getBrothers().length?(a(e.getNextNode(),-1),n.remove()):(e.remove(),t.remove())}catch(e){o=[],console.log(e)}}return{deletedGraphNodes:o,deletedTasks:i}}(e,t),getTasksDataForCreation:e=>function(e){let t,o=!1;return null==e?t:(t=[],e.getAllDescendants().forEach((e=>{if(e.tileView){let i=e.options.grid;i.validTaskData||i.id?t.push(i):o=!0}})),!o&&t)}(e),reOrderTreeNodeModels:(e,o,i)=>function(e,o,i){let n=parseInt(i.newOrder),s=parseInt(i.oldOrder),a=o,r=function(e,t){let o=!1;return e.getChildren()[t].getAllDescendants().forEach((function(e){e.getChildren()||e.options.grid.userGroupInfo&&e.options.grid.userGroupAction&&(o=!0)})),o}(e,n);if(e.options._isSplitTaskPresent)if(2==o.getParents().length)r?a=o.getParent():o.getParent().remove();else if(1==o.getParents().length&&r){let e=new t({label:"All",grid:{taskOrder:String(n),nodeType:"Task Action Node"}});e.addChild(a),a=e}if(e.getChildren()[n].getChildren())e.getChildren()[n].addChild(a);else{let o=e.getChildren()[n],i=new t({label:"All",grid:{taskOrder:String(n),nodeType:"Task Action Node"}});i.addChild(a),e.insertBefore(i,o)}return e.getChildren()[s]&&(e.getChildren()[s].getChildren()||e.getChildren()[s].remove()),e}(e,o,i),removeGraphNodesFromTree:e=>function(e){return e.getAllDescendants().forEach(((e,t)=>{e.options.grid.graphNode&&(e.options.grid.graphNode=void 0)})),e}(e),updateTaskAction:(e,t)=>function(e,t){return e.options.label=t,e.getChildren().forEach(((e,o)=>{let i=e.getChildren();i&&i.length>0?i.forEach(((e,o)=>{e.options.grid.parallelNodeProcessionRule=t})):e.options.grid.parallelNodeProcessionRule=t})),e}(e,t),getTasksDataForEdit:e=>function(e){let t,o=!1;return null==e?t:(t=[],e.getChildren().forEach(((e,i)=>{let n=e.getChildren();n&&n.length>0&&n.forEach(((e,i)=>{e.options.grid.validTaskData||e.options.grid.id?t.push(e.options.grid):(1==e.getBrothers().length+1?(a(e.getNextNode(),-1),e.getParent.remove()):e.remove(),o=!0)}))})),!o&&t)}(e)}})),define("DS/ENORouteMgmt/Utilities/Constants",["UWA/Class"],(function(e){"use strict";return e.singleton({WELCOMEPANEL_ID_CREATE_ROUTE:"new_route",WELCOMEPANEL_ID_CREATE_ROUTE_TEMPLATE:"new_route_template",WELCOMEPANEL_ID_ROUTES:"routes",WELCOMEPANEL_ID_ROUTE_TEMPLATES:"route_templates",EVENT_ROUTE_SUMMARY_DBLCLICK:"route-DataGrid-on-dblclick",DIALOG_EVENTS:{CREATE_TASK:"redraw-graph-create",OPEN_TASK_PANEL:"route-task-open-click",CLOSE_TASK_PANEL:"route-task-close-click",TOGGLE_ROUTE_BUTTONS:"initiate-route-toggle-dialogbuttons",TOGGLE_TEMPLATE_BUTTONS:"initiate-template-toggle-dialogbuttons",SAVE_AS_TEMPLATE_TOGGLE:"initiate-saveAsTemplate-toggle-dialogbuttons",REVISE_TEMPLATE_DIALOG:"initiate-reviseTemplate-toggle-dialogbuttons",ROUTE_BASE_PURPOSE_CHANGE:"initiateRoute-on-RouteBasePurposeSelection",TEMPLATE_CHANGE:"initiateRoute-on-TemplateSelection",CHOOSE_UG_CHANGE:"InitiateTemplate-on-chooseUGSelection",SCOPE_CHANGE:"initiateRoute-on-ScopeSelection",TASK_PANEL_CLOSE:"task-panel-close",TASK_CREATE_SAVE:"task-create-on-save",CLEAR_CONTENT_ON_CREATEANOTHER:"initiateRouteClearContent-on-createAnother",CLEAR_CONTENT_REVIEW_MODEL:"clearContentToReview-on-ContentRemoval",TASK_ASSOCIATED_CONTENT_UPDATE:"task-associated-content-update",SHOW_NO_ROUTE_PLACEHOLDER:"show-no-route-placeholder",HIDE_NO_ROUTE_PLACEHOLDER:"hide-no-route-placeholder",HIDE_NO_CONTENT_PLACEHOLDER:"hide-no-content-placeholder",SHOW_NO_CONTENT_PLACEHOLDER:"show-no-content-placeholder",HIDE_NO_IROUTE_PLACEHOLDER:"hide-no-iRoutecontent-placeholder",SHOW_NO_IROUTE_PLACEHOLDER:"show-no-iRoutecontent-placeholder"}})})),define("DS/ENORouteMgmt/Utilities/DragAndDrop",["UWA/Core","DS/DataDragAndDrop/DataDragAndDrop","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";let i={makeDroppable:function(o,i){let n=this;if(null!==o){n.dropInvite=o.getElement("#droppable"),n.dropInvite||(n.dropInvite=new e.createElement("div",{id:"droppable",class:"hidden"}).inject(o)),n.dropInvite.callback=i;let s={enter:n._manageOverAndEnterEvents.bind(n),over:n._manageOverAndEnterEvents.bind(n),drop:n._manageDropEvent.bind(n)};t.droppable(o,s)}},_manageOverAndEnterEvents:function(e,t){null==document.querySelector(".Route-Contentdrop-container")?this._addDroppableStyle(e):this._dropInviteContainer.show()},_removeDroppableStyle:function(){this._dropInviteContainer.hide(),this.dropInvite.removeClassName("droppable"),this.dropInvite.removeClassName("show"),this.dropInvite.addClassName("hidden")},_addDroppableStyle:function(t){this._dropInviteContainer=e.createElement("div",{class:"Route-Contentdrop-container"}),this._dropInviteContainer.inject(t),e.createElement("div",{class:"drop-zone add-content",html:{tag:"div",class:"dropzonemsg-container",html:[{tag:"span",class:"fonticon fonticon-plus fonticon-3x"},{tag:"p",class:"text-content",html:o.addContent}]}}).inject(this._dropInviteContainer),this.dropInvite.removeClassName("hidden"),this.dropInvite.addClassName("show"),this._dropInviteContainer.addEventListener("dragleave",this._manageleaveEvents.bind(this))},removeDropInvite:function(){this._dropInviteContainer.parentNode&&(this._dropInviteContainer.hide(),this._dropInviteContainer.parentNode.removeChild(this._dropInviteContainer))},_manageDropEvent:function(t,o){let i=this;if(""!==t&&null!=t)try{var n=(t=e.is(t,"string")?JSON.parse(t):t).data&&t.data.items?t.data.items:null;i.dropInvite.callback(n),i.dropInvite.removeClassName("droppable"),i.dropInvite.removeClassName("show"),i.dropInvite.addClassName("hidden"),this._dropInviteContainer.hide();let o=document.querySelector("#routeContentsContainer");o&&o.removeChild(this._dropInviteContainer)}catch(e){i.dropInvite.removeClassName("droppable"),i.dropInvite.removeClassName("show"),i.dropInvite.addClassName("hidden"),this._dropInviteContainer.hide();let t=document.querySelector("#routeContentsContainer");t&&t.removeChild(this._dropInviteContainer)}else{i.dropInvite.callback(arguments[2]),i.dropInvite.removeClassName("droppable"),i.dropInvite.removeClassName("show"),i.dropInvite.addClassName("hidden"),this._dropInviteContainer.hide();let e=document.querySelector("#routeContentsContainer");e&&e.removeChild(this._dropInviteContainer)}},_manageleaveEvents:function(e){e.stopPropagation(),e.preventDefault(),this._dropInviteContainer.hide()}};return i})),define("DS/ENORouteMgmt/Views/Form/TaskProperties",[],(function(){"use strict";var e={_taskProperties:void 0,_taskMemberProperties:void 0,memberContainer:void 0,_taskGraphModel:void 0,taskGraphModel:void 0,_routeInfo:void 0,data:void 0,container:void 0,mode:void 0,taskActionMode:void 0,taskEditMode:void 0,fieldViewOnly:void 0,inboxTaskFieldViewOnly:void 0,fieldRequired:void 0,_routeBasePurposeToken:void 0,_routeTemplateToken:void 0,_routeScopeToken:void 0,_routeContentToReviewRemovalToken:void 0,_routeContentToReviewAdditionToken:void 0,_taskChangeAssigneeToken:void 0,_taskGraphRedrawToken:void 0,_taskHeaderInfoClickToken:void 0,_taskPanelCloseToken:void 0,labelAttr:void 0,autoCompleteComponent:void 0,modelForAttachment:void 0,attachedDocuments:void 0,taskPropertiesFields:void 0,dueDateOptionPreviouslySelected:void 0,taskDueDate:void 0,taskMinDate:void 0,loadFor:void 0,taskPanelWrapper:void 0,titleSection:void 0,membersInfo:void 0,collabTaskModel:void 0,detailsPanelView:void 0,cbtCollection:void 0,collabTaskInfo:void 0};return{getTaskVaribles:()=>e,resetTaskVariables:()=>function(){for(let t in e)e[t]=void 0;return e}()}})),define("DS/ENORouteMgmt/Views/Graph/eGraphToolbar",["DS/egraph/utils"],(function(e){"use strict";var t,o={};function i(){}function n(){this.hovering=!0}function s(e){this.start=[e.touches[0].clientX,e.touches[0].clientY]}function a(e){return function(){var t,o;o=[this].concat(Array.prototype.slice.call(arguments)),this.state[e]&&(t=this.state[e].apply(this.state,o)),t&&(this.state=t)}}function r(e,t){this.tlb=e,this.elt=document.querySelector(t.query),this.mode=t.mode,this.id=t.id,this.cb=t.cb,this.sm=new o.ButtonStateMachine(this.elt),this.sm.onclick=this.push.bind(this,!1),this.sm.onpress=this.tlb.onBtnPress.bind(this.tlb,this),this.sm.onrelease=this.tlb.onBtnRelease.bind(this.tlb,this),this.keepHighlight=!1}function l(e){this.id=e,this.buttons=[],this.permSel=null,this.tempSel=null,this.highlighted=null}function d(e,t,o){r.call(this,e,t),this.group=o,t.selected&&this.group.select(this)}function u(e,t){var o;if(!t.group)throw new Error("missing group property on radio button");e.groups.hasOwnProperty(t.group)||(e.groups[t.group]=new l(t.group)),(o=e.groups[t.group]).buttons.push(this),d.call(this,e,t,o)}function c(e,t){d.call(this,e,t,new l("<flag-group>"))}function p(e,t){r.call(this,e,t),t.expand&&(this.expand=document.querySelector(t.expand),this.expandElt=document.createElement("div"),this.expandElt.className="expanded",this.expandElt.style.display="none",this.elt.appendChild(this.expandElt))}return i.prototype.mousedown=function(e,t){if(0===t.button)return t.preventDefault(),t.stopPropagation(),e.onpress(e.elt),new n},n.prototype.isHovering=function(e,t){var o;for(o=t.target;o;o=o.parentNode)if(o===e.elt)return!0;return!1},n.prototype.mouseover=function(e,t){this.hovering||(this.hovering=!0,e.onpress(e.elt))},n.prototype.mouseout=function(e,t){this.hovering&&(this.hovering=!1,e.onrelease(e.elt))},n.prototype.mouseup=function(e,t){if(0===t.button)return t.preventDefault(),t.stopPropagation(),e.onrelease(e.elt),this.isHovering(e,t)&&e.onclick(e.elt),new i},i.prototype.touchstart=function(e,t){if(1===t.touches.length)return t.preventDefault(),t.stopPropagation(),e.onpress(e.elt),new s(t)},s.prototype.touchstart=function(e,t){return new i},s.prototype.touchmove=function(e,t){return t.touches.length>1||Math.abs(t.touches[0].clientX-this.start[0])+Math.abs(t.touches[0].clientY-this.start[1])>30?(e.onrelease(e.elt),new i):(t.preventDefault(),void t.stopPropagation())},s.prototype.touchcancel=function(e,t){return e.onrelease(e.elt),new i},s.prototype.touchend=function(e,t){return e.onrelease(e.elt),e.onclick(e.elt),new i},o.ButtonStateMachine=function(e){this.elt=e,this.state=new i,this.buttons=0,this.boundMouseup=this.mouseup.bind(this),this.elt&&(this.elt.addEventListener("mousedown",this.mousedown.bind(this)),this.elt.addEventListener("mouseover",this.mouseover.bind(this)),this.elt.addEventListener("mouseout",this.mouseout.bind(this)),this.elt.addEventListener("touchstart",this.touchstart.bind(this)),this.elt.addEventListener("touchmove",this.touchmove.bind(this)),this.elt.addEventListener("touchend",this.touchend.bind(this)),this.elt.addEventListener("touchcancel",this.touchend.bind(this)))},o.ButtonStateMachine.prototype.onclick=function(e){},o.ButtonStateMachine.prototype.onpress=function(e){},o.ButtonStateMachine.prototype.onrelease=function(e){},o.ButtonStateMachine.prototype.mousedown_internal=a("mousedown"),o.ButtonStateMachine.prototype.mouseover=a("mouseover"),o.ButtonStateMachine.prototype.mouseout=a("mouseout"),o.ButtonStateMachine.prototype.mouseup_internal=a("mouseup"),o.ButtonStateMachine.prototype.touchstart=a("touchstart"),o.ButtonStateMachine.prototype.touchmove=a("touchmove"),o.ButtonStateMachine.prototype.touchend=a("touchend"),o.ButtonStateMachine.prototype.mousedown=function(e){0===this.buttons&&document.body.addEventListener("mouseup",this.boundMouseup),this.buttons|=1<<e.button,this.mousedown_internal.apply(this,arguments)},o.ButtonStateMachine.prototype.mouseup=function(e){this.buttons&=~(1<<e.button),0===this.buttons&&document.body.removeEventListener("mouseup",this.boundMouseup),this.mouseup_internal.apply(this,arguments)},r.prototype.push=function(){this.tlb.lastCheck&&this.tlb.lastCheck.unselect(),this.cb(this.id),this.tlb.defaultCheck&&this.tlb.defaultCheck.select()},r.prototype.highlight=function(t){t&&(this.keepHighlight=!0),e.classListAdd(this.elt,"selected")},r.prototype.unhighlight=function(t){t&&(this.keepHighlight=!1),this.keepHighlight||e.classListRemove(this.elt,"selected")},r.prototype.show=function(){e.classListRemove(this.elt,"hidden")},r.prototype.hide=function(){e.classListAdd(this.elt,"hidden")},Object.defineProperty(l.prototype,"sel",{get:function(){return this.tempSel||this.permSel},enumerable:!0,configurable:!0}),l.prototype.select=function(e,t){var o;t&&this.tempSel===e||!t&&this.permSel===e||(t?this.tempSel=e:this.permSel=e,(o=this.tempSel||this.permSel)!==this.highlighted&&(this.highlighted&&this.highlighted.unhighlight(!0),this.highlighted=o,this.highlighted&&this.highlighted.highlight(!0)))},l.prototype.toggle=function(e,t){(t?this.tempSel:this.permSel)===e?this.select(null,t):this.select(e,t)},e.inherit(d,r),d.prototype.isSelected=function(){return this.group.sel===this},d.prototype.push=function(e){this.group.select(this,e),this.cb(this.id)},e.inherit(u,d),e.inherit(c,d),c.prototype.push=function(e){this.group.toggle(this,e),this.cb(this.id)},e.inherit(p,r),p.prototype.push=function(){if(this.tlb.lastCheck){if(this.tlb.lastCheck===this)return this.tlb.lastCheck.unselect(),void(this.tlb.defaultCheck&&this.tlb.defaultCheck.select());this.tlb.lastCheck.unselect()}this.select()},p.prototype.select=function(){this.tlb.lastCheck=this,this.expand&&(this.expandElt.style.display="",e.classListAdd(this.expand,"display")),this.tlb.setPermanentHighlight(this),this.cb(this.id,!0)},p.prototype.unselect=function(){(this.tlb.lastCheck=this)&&(this.tlb.lastCheck=null),this.expand&&(this.expandElt.style.display="none",e.classListRemove(this.expand,"display")),this.tlb.setPermanentHighlight(null),this.cb(this.id,!1)},t={check:p,push:r,flag:c,radio:u},o.Toolbar=function(e){var o,i;for(this.lastCheck=null,this.permanentHighlight=null,this.highlight=null,this.buttons={},this.groups={},o=0,i=e.buttons.length;o<i;++o)this.buttons[e.buttons[o].id]=new t[e.buttons[o].mode](this,e.buttons[o]);this.defaultCheck=this.buttons[e.check],this.defaultCheck&&this.defaultCheck.select()},o.Toolbar.prototype.onBtnPress=function(e){this.highlight&&this.highlight.unhighlight(),this.highlight=e,e.highlight()},o.Toolbar.prototype.onBtnRelease=function(e){this.highlight===e&&(e.unhighlight(),this.highlight=this.permanentHighlight,this.highlight&&this.highlight.highlight())},o.Toolbar.prototype.setPermanentHighlight=function(e){this.permanentHighlight!==e&&(this.highlight===this.permanentHighlight&&this.highlight&&(this.highlight.unhighlight(),this.highlight=null),this.permanentHighlight=e,this.highlight||(this.highlight=e,this.highlight&&this.highlight.highlight()))},o})),define("DS/ENORouteMgmt/Config/InitiateRouteTabsConfig",["DS/Core/Core","UWA/Drivers/Alone","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";return[{label:o.infoPropertiesTab,id:"properties",isSelected:!0,icon:{iconName:"attributes",fontIconFamily:WUXManagedFontIcons.Font3DS,orientation:"horizontal"},content:t.createElement("div",{id:"iRoutePropertiesContainer",class:"route-properties-container"}),loader:"DS/ENORouteMgmt/Views/Loader/InitiateRoutePropertiesLoader"},{label:o.content,id:"content",icon:{iconName:"docs",fontIconFamily:WUXManagedFontIcons.Font3DS},allowClosableFlag:!1,content:t.createElement("div",{id:"iRouteContentsContainer",class:"iroute-contents-container"}),loader:"DS/ENORouteMgmt/Views/Loader/InitiateRouteContentsLoader"},{label:o.tasks,id:"tasks",icon:{iconName:"task-route",fontIconFamily:WUXManagedFontIcons.Font3DS},allowClosableFlag:!1,content:t.createElement("div",{id:"iRouteTasksContainer",class:"iroute-tasks-container"}),loader:"DS/ENORouteMgmt/Views/Loader/InitiateRouteTasksLoader"}]})),define("DS/ENORouteMgmt/Components/Wrappers/WrapperTileView",["DS/CollectionView/ResponsiveTilesCollectionView"],(function(e){"use strict";let t,o,i,n=function(t,n,s){return i=n||UWA.createElement("div",{id:"TileViewContainer",class:"tile-view-container hideView"}),s||(s=!1),o=new e({model:t,shouldCellAllowUnsafeHTMLContentAt:function(e,t){return["description","picture"].includes(t)},useDragAndDrop:s,displayedOptionalCellProperties:["description","contextualMenu"]}),o.getContent().style.top="50 px",o.inject(i),i};return t={build:(e,t,o)=>n(e,t,o),tileView:()=>o,getSelectedRows:()=>function(e){for(var t={},o=[],i=e.TreedocModel.getSelectedNodes(),n=0;n<i.length;n++)o.push(i[n].options.grid);return t.data=o,t}(o)},t})),define("DS/ENORouteMgmt/Config/ContentToReviewGridViewConfig",["i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e){"use strict";return[{text:e.title,dataIndex:"tree"}]})),define("DS/ENORouteMgmt/Components/Notifications",["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],(function(e,t){"use strict";let o=null,i=function(){o=e,t.setNotificationManager(o),t.setStackingPolicy(9)};return i.prototype.handler=function(){return document.getElementById("initiateRoute")?(t.inject(document.getElementById("RouteImmersiveFrame")),document.getElementById("initiateRoute").scrollIntoView()):document.getElementById("initiateTemplate")?(t.inject(document.getElementById("initiateTemplate")),document.getElementById("initiateTemplate").scrollIntoView()):document.getElementById("saveAsTemplate")?(t.inject(document.getElementById("saveAsTemplate")),document.getElementById("saveAsTemplate").scrollIntoView()):document.getElementById("assigneeWarning")?t.inject(document.getElementById("assigneeWarning")):document.getElementById("selectUsers")?t.inject(document.getElementById("selectUsers")):document.getElementsByClassName("wux-notification-screen").length>0||t.inject(document.body),o},i.prototype.notifview=function(){return t},i})),define("DS/ENORouteMgmt/Views/Form/FormElements",["DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Controls/DatePicker","DS/Controls/Editor","DS/WUXAutoComplete/AutoComplete"],(function(e,t,o,i,n,s){"use strict";return{createElement:(a,r,l)=>function(a,r,l){switch(l){case"lineEditor":return new e(r).inject(a);case"Editor":return new t(r).inject(a);case"DatePicker":return new n(r).inject(a);case"ComboBox":return new i(r).inject(a);case"Toggle":return new o(r).inject(a);case"AutoComplete":return new s(r).inject(a);default:return}}(a,r,l)}})),define("DS/ENORouteMgmt/Views/Dialogs/RouteLifeCycleDialogue",(function(){"use strict";return{lifeCycle:e=>{return t=e,void require(["DS/LifecycleCmd/MaturityCmd"],(function(e){var o=[],i=t.id;o.push({physicalid:i}),(new e).executeAsync(o).then((function(){}))}));var t}}})),define("DS/ENORouteMgmt/Config/RouteTabsConfig",["DS/Core/Core","UWA/Drivers/Alone","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";return[{label:o.tasks,id:"tasks",isSelected:!0,icon:{iconName:"task-route",fontIconFamily:WUXManagedFontIcons.Font3DS,orientation:"horizontal"},content:t.createElement("div",{id:"routeTasksContainer",class:"route-tasks-container"}),loader:"DS/ENORouteMgmt/Views/Loader/TaskGraphicalViewLoader"},{label:o.content,id:"content",icon:{iconName:"docs",fontIconFamily:WUXManagedFontIcons.Font3DS},allowClosableFlag:!1,content:t.createElement("div",{id:"routeContentsContainer",class:"route-contents-container"}),loader:"DS/ENORouteMgmt/Views/RouteContentsView"},{label:o.members,id:"members",icon:{iconName:"users",fontIconFamily:WUXManagedFontIcons.Font3DS},allowClosableFlag:!1,content:t.createElement("div",{id:"routeMembersContainer",class:"route-members-container"}),loader:"DS/ENORouteMgmt/Views/RouteMembersView"}]})),define("DS/ENORouteMgmt/Config/CollabTaskTabsConfig",["DS/Core/Core","UWA/Drivers/Alone","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";return[{label:o.infoPropertiesTab,id:"properties",isSelected:!0,icon:{iconName:"attributes",fontIconFamily:WUXManagedFontIcons.Font3DS},content:t.createElement("div",{id:"TaskPropertiesPanelContainer",class:"tasks-properties-panel-container"}),loader:"DS/ENORouteMgmt/Views/Loader/RouteTasksPropertiesLoader"},{label:o.members,id:"members",icon:{iconName:"users",fontIconFamily:WUXManagedFontIcons.Font3DS},allowClosableFlag:!1,content:t.createElement("div",{id:"TaskMemberContainer",class:"tasks-member-container"}),loader:"DS/ENORouteMgmt/Views/Loader/RouteTasksMembersLoader"},{label:o.comments,id:"comments",icon:{iconName:"comment",fontIconFamily:WUXManagedFontIcons.Font3DS},allowClosableFlag:!1,content:t.createElement("div",{id:"TaskCommentsContainer",class:"tasks-comments-container"}),loader:"DS/ENORouteMgmt/Views/Loader/RouteTasksCommentsLoader"},{label:o.history,id:"history",icon:{iconName:"navigation-history",fontIconFamily:WUXManagedFontIcons.Font3DS},allowClosableFlag:!1,content:t.createElement("div",{id:"TaskHistoryContainer",class:"tasks-history-container"}),loader:"DS/ENORouteMgmt/Views/Loader/RouteTasksHistoryLoader"}]})),define("DS/ENORouteMgmt/Views/Form/CreateTaskProperties",[],(function(){"use strict";var e={_taskProperties:void 0,_taskGraphModel:void 0,taskGraphModel:void 0,_routeInfo:void 0,data:void 0,container:void 0,mode:void 0,taskActionMode:void 0,taskEditMode:void 0,fieldViewOnly:void 0,inboxTaskFieldViewOnly:void 0,fieldRequired:void 0,_routeBasePurposeToken:void 0,_routeTemplateToken:void 0,_routeScopeToken:void 0,_routeContentToReviewRemovalToken:void 0,_routeContentToReviewAdditionToken:void 0,_taskChangeAssigneeToken:void 0,_taskGraphRedrawToken:void 0,_taskHeaderInfoClickToken:void 0,_taskPanelCloseToken:void 0,labelAttr:void 0,autoCompleteComponent:void 0,modelForAttachment:void 0,attachedDocuments:void 0,taskPropertiesFields:void 0,dueDateOptionPreviouslySelected:void 0,taskDueDate:void 0,taskMinDate:void 0,loadFor:void 0,taskPanelWrapper:void 0,titleSection:void 0};return{getTaskCreateVariables:()=>e,resetTaskCreateVariables:()=>function(){for(let t in e)e[t]=void 0;return e}()}})),define("DS/ENORouteMgmt/Utilities/DragAndDropOnTaskInputField",["UWA/Core","DS/DataDragAndDrop/DataDragAndDrop"],(function(e,t){"use strict";let o={makeDroppable:function(o,i,n){let s=this;if(null!==o){if(s.dropInvite=o.getElement("#droppable"),!s.dropInvite){let t;t=null!=n?"droppable_"+n:"droppable",s.dropInvite=new e.createElement("div",{id:t}).inject(o)}s.dropInvite.callback=i;let a={enter:s._manageDragEvents.bind(s),leave:s._manageDragEvents.bind(s),over:s._manageDragEvents.bind(s),drop:s._manageDropEvent.bind(s)};t.droppable(o,a)}},_manageDragEvents:function(e,t){let o=this;switch(t.type){case"dragenter":case"dragover":o._addDroppableStyle();break;case"dragleave":o._removeDroppableStyle()}return!0},_removeDroppableStyle:function(){let e=document.querySelector("#routeCreateContainer #InitiateTaskCreatePropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips");null==e&&(e=document.querySelector("#routes-right-panel #RouteTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips")),null!=e&&""!=e.style.border&&(e.style.border="")},_addDroppableStyle:function(){let e=document.querySelector("#routeCreateContainer #InitiateTaskCreatePropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips");null==e&&(e=document.querySelector("#routes-right-panel #RouteTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips")),null!=e&&""==e.style.border&&(e.style.border="2px dotted #368ec4")},_manageDropEvent:function(t,o){let i=this;if(""!==t&&null!=t)try{var n=(t=e.is(t,"string")?JSON.parse(t):t).data&&t.data.items?t.data.items:null;i.dropInvite.callback(n,o);let s=document.querySelector("#routeCreateContainer #InitiateTaskCreatePropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips");null==s&&(s=document.querySelector("#routes-right-panel #RouteTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips")),null!=s&&""!=s.style.border&&(s.style.border="")}catch(e){let t=document.querySelector("#routeCreateContainer #InitiateTaskCreatePropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips");null==t&&(t=document.querySelector("#routes-right-panel #RouteTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips")),null!=t&&""!=t.style.border&&(t.style.border="")}else{i.dropInvite.callback(arguments[2]);let e=document.querySelector("#routeCreateContainer #InitiateTaskCreatePropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips");null==e&&(e=document.querySelector("#routes-right-panel #RouteTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips")),null!=e&&""!=e.style.border&&(e.style.border="")}}};return o})),define("DS/ENORouteMgmt/Utilities/DragAndDropOnRouteTileView",["UWA/Core","DS/DataDragAndDrop/DataDragAndDrop","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";let i={makeDroppable:function(e,o,i){let n=this;if(n.blankSpace=i,null!==e){n.dropInvite=e,n.dropInvite.callback=o;let i={enter:n._manageEnterEvents.bind(n),drop:n._manageDropEvent.bind(n)};t.droppable(e,i)}},_manageEnterEvents:function(e,t){},_manageDropEvent:function(t,o){let i=this;if(""!==t&&null!=t)try{var n=(t=e.is(t,"string")?JSON.parse(t):t).data&&t.data.items?t.data.items:null;i.dropInvite.callback(n),o.hide(),i.blankSpace.show()}catch(e){o.hide(),i.blankSpace.show()}else i.dropInvite.callback(arguments[2]),o.hide(),i.blankSpace.show()}};return i})),define("DS/ENORouteMgmt/Utilities/DragAndDropOnRouteSummary",["UWA/Core","DS/DataDragAndDrop/DataDragAndDrop","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";let i={makeDroppable:function(e,o){let i=this;if(null!==e){i.dropInvite=e,i.dropInvite.callback=o;let n={enter:i._manageEnterEvents.bind(i),drop:i._manageDropEvent.bind(i)};t.droppable(e,n)}},_manageEnterEvents:function(e,t){t.shiftKey?e.children[0].children[0].hide():e.children[0].children[0].show()},_manageDropEvent:function(t,o,i,n){let s=this;if(""!==t&&null!=t)try{var a=(t=e.is(t,"string")?JSON.parse(t):t).data&&t.data.items?t.data.items:null;s.dropInvite.callback(a),o.hide()}catch(e){o.hide()}else s.dropInvite.callback(arguments[2]),o.hide()}};return i})),define("DS/ENORouteMgmt/Components/Wrappers/SplitViewWrapper",["DS/ENOXSplitView/js/ENOXSplitView","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";var o=e;return o.prototype.getLeftViewWrapper=function(){return UWA.extendElement(this.getLeft())},o.prototype.getRightViewWrapper=function(){return UWA.extendElement(this.getRight())},o.prototype.addRightPanelExpander=function(){if(null!=this._rightPanel){var e=UWA.createElement("div",{class:"splitview-close fonticon fonticon-expand-left",id:"splitview-close",title:t.homeRightPanelExpand,styles:{"font-size":"20px"}});e.inject(this._rightPanel);var o=this;e.onclick=function(e){o._hideSide("left"),o._rightPanel.classList.remove("right-container-mobile-view");var i=document.querySelector(".splitview-close.fonticon-expand-left");if(i)i.title=t.homeRightPanelCollapse,i.removeClassName("fonticon-expand-left"),i.addClassName("fonticon-expand-right");else{var n=document.querySelector(".splitview-close.fonticon-expand-right");n.title=t.homeRightPanelExpand,o._showSide("left"),(n=UWA.extendElement(n)).removeClassName("fonticon-expand-right"),n.addClassName("fonticon-expand-left")}}}},o})),define("DS/ENORouteMgmt/Utilities/IdCardUtil",["i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e){"use strict";let t=function(){var e=document.querySelector("#channel3");e&&(e.style.display="none")},o=function(){var e=document.querySelector("#channel3");e&&(e.style.display="")},i=function(){document.querySelector("#thumbnailSection").classList.add("id-card-thumbnail-remove");var e=document.querySelector("#infoSec"),t=document.querySelector("#routeHeaderContainer"),o=document.querySelector("#templateHeaderContainer");t&&t.className.indexOf("minimized")>-1||o&&o.className.indexOf("minimized")>-1?e.classList.add("id-info-section-align-minimized"):e.classList.add("id-info-section-align")},n=function(){document.querySelector("#thumbnailSection").classList.remove("id-card-thumbnail-remove");var e=document.querySelector("#infoSec"),t=document.querySelector("#routeHeaderContainer"),o=document.querySelector("#templateHeaderContainer");t&&t.className.indexOf("minimized")>-1||o&&o.className.indexOf("minimized")>-1?e.classList.remove("id-info-section-align-minimized"):e.classList.remove("id-info-section-align")},s=function(e){var s;e<850?t():o(),e<768?i():n(),e<500?(s=document.querySelector("#channel2"))&&(s.style.display="none"):function(){var e=document.querySelector("#channel2");e&&(e.style.display="")}(),e<175?function(){var e=document.querySelector("#channel1");e&&(e.style.display="none")}():function(){var e=document.querySelector("#channel1");e&&(e.style.display="")}()};return{infoIconActive:()=>{var e;(e=document.querySelector("#routeInfoIcon"))&&e.className.indexOf("fonticon-color-display")>-1&&(e.className=e.className.replace("fonticon-color-display","fonticon-color-active"))},infoIconInActive:()=>{var e;(e=document.querySelector("#routeInfoIcon"))&&e.className.indexOf("fonticon-color-active")>-1&&(e.className=e.className.replace("fonticon-color-active","fonticon-color-display"))},hideChannel3:()=>t(),showChannel3:()=>o(),infoIconIsActive:()=>document.querySelector("#routeInfoIcon").className.indexOf("fonticon-color-active")>-1,collapseIcon:t=>function(t){var o=document.querySelector("#routeHeaderContainer");if(t&&"template"==t&&(o=document.querySelector("#templateHeaderContainer")),o&&o.className.indexOf("minimized")>-1){var i=document.querySelector("#expandCollapse");i.className.indexOf("wux-ui-3ds-expand-up")>-1&&(i.className=i.className.replace("wux-ui-3ds-expand-up","wux-ui-3ds-expand-down"),i.title=e.idCardHeaderActionExpand)}}(t),hideThumbnail:()=>i(),showThumbnail:()=>n(),resizeIDCard:e=>s(e)}})),define("DS/ENORouteMgmt/Model/RemoveRouteContentConfirmationModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";let i=new e,n=function(e){let t;return t="FALSE"==e.canDeleteContent||"Attachment"==e.RelationValue?{icon:"wrong wux-ui-3ds"}:{icon:"check wux-ui-3ds"},t};return{createModel:o=>function(o){return i=new e,i.prepareUpdate(),o.forEach((function(e){e.Deleteicon=n(e);var o=new t({label:e.Title,width:300,grid:{id:e.id,Title:e.Title,Maturity:e.Maturity,TypeDisplay:e.TypeDisplay,Relation:e.Relation,Revision:e.Revision,Deleteicon:e.Deleteicon},icons:[e.typeicon]});i.addRoot(o)})),i.pushUpdate(),i}(o),getModel:()=>i}})),define("DS/ENORouteMgmt/Utilities/PlaceHolderDragAndDrop",["UWA/Core","DS/DataDragAndDrop/DataDragAndDrop","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";let i={makeDroppable:function(o,i){let n=this;if(null!==o){n.dropInvite=o.getElement("#droppable"),n.dropInvite||(n.dropInvite=new e.createElement("div",{id:"droppable",class:"hidden"}).inject(o)),n.dropInvite.callback=i;let s={enter:n._manageOverAndEnterEvents.bind(n),over:n._manageOverAndEnterEvents.bind(n),drop:n._manageDropEvent.bind(n)};t.droppable(o,s)}},_manageOverAndEnterEvents:function(e,t){null==document.querySelector(".Route-Placeholder-container")?this._addDroppableStyle(e):(this.dropInvite.removeClassName("hidden"),this.dropInvite.addClassName("show"),this._dropInviteContainer.show())},_addDroppableStyle:function(t){this._dropInviteContainer=e.createElement("div",{class:"Route-Placeholder-container"}),this._dropInviteContainer.inject(t),e.createElement("div",{class:"drop-zone add-content",html:{tag:"div",class:"dropzonemsg-container",html:[{tag:"span",class:"fonticon fonticon-open fonticon-3x"},{tag:"p",class:"text-content",html:o.Open}]}}).inject(this._dropInviteContainer),this.dropInvite.removeClassName("hidden"),this.dropInvite.addClassName("show"),this._dropInviteContainer.addEventListener("dragleave",this._manageleaveEvents.bind(this))},_manageDropEvent:function(t,o){let i=this;if(""!==t&&null!=t)try{this._dropInviteContainer.hide();var n=(t=e.is(t,"string")?JSON.parse(t):t).data&&t.data.items?t.data.items:null;i.dropInvite.callback(n),i.dropInvite.removeClassName("droppable"),i.dropInvite.removeClassName("show"),i.dropInvite.addClassName("hidden")}catch(e){this._dropInviteContainer.hide(),i.dropInvite.removeClassName("droppable"),i.dropInvite.removeClassName("show"),i.dropInvite.addClassName("hidden")}else this._dropInviteContainer.hide(),i.dropInvite.callback(arguments[2]),i.dropInvite.removeClassName("droppable"),i.dropInvite.removeClassName("show"),i.dropInvite.addClassName("hidden")},_manageleaveEvents:function(e){this.dropInvite.removeClassName("droppable"),this.dropInvite.removeClassName("show"),this.dropInvite.addClassName("hidden"),e.stopPropagation(),e.preventDefault(),this._dropInviteContainer.hide()}};return i})),define("DS/ENORouteMgmt/Commands/CommandAvailableOnSelect",["UWA/Core","UWA/Class","DS/PADUtils/PADContext"],(function(e,t,o){"use strict";return t.extend({init:function(e,t){this._parent(e,t),o.get()&&(this._check_select(),o.get().getPADTreeDocument().getXSO().onChange(this._check_select.bind(this)))},_check_select:function(){var e=o.get().getPADTreeDocument().getXSO().get(),t=e.length,i=!(!t||!0===this.options.cmd_selection_single&&1!==t);if(null!=this.isAvailable){var n=this;n.selectedObjects=e,i=this.isAvailable(e,(function(e,t){t==n.selectedObjects&&(e?n.enable():n.disable())}))}else!0===i?this.enable():this.disable()}})})),define("DS/ENORouteMgmt/Views/Form/CustomFieldUtils",[],(function(){"use strict";let e=function(e){return JSON.parse(e.viewConfig).attributeType};return{getFieldType:e=>function(e){let t=JSON.parse(e.viewConfig),o=t.attributeType;switch(t.type){case"text":return"Editor";case"number":case"real":return"real"===o&&e.units?"LineEditor with Unit":"LineEditor";case"date":return"DatePicker";case"select":return"ComboBox";case"checkbox":return"Toggle";default:return}}(e),isReadOnlyField:e=>function(e){return"true"!==JSON.parse(e.viewConfig).readWrite}(e),isMandatoryField:e=>function(e){return!0===e.mandatory}(e),getRangeElementsList:e=>function(e){let t=e.range.item,o=[];return t.forEach(((e,t)=>{let i={labelItem:e.display,valueItem:e.value};o.push(i)})),o}(e),isBooleanField:e=>function(e){return"checkbox"===JSON.parse(e.viewConfig).type}(e),isDateField:e=>function(e){return"date"===JSON.parse(e.viewConfig).type}(e),getMaxLength:t=>function(t){let o=JSON.parse(t.viewConfig);return"string"==e(t)?o.maxlength:0}(t),getAttributeType:t=>e(t),getDefaultUnit:e=>function(e){let t="";return e.units&&e.units.item.forEach((e=>{!0===e.default&&(e.display=e.display.replace("x","."),e.display=e.display.replace("_","/"),t=e)})),t}(e),isMultiValueField:e=>function(e){return!0===JSON.parse(e.viewConfig).multivalue}(e),isMultiLineValueField:e=>function(e){return!0===JSON.parse(e.viewConfig).multiline}(e)}})),define("DS/ENORouteMgmt/Utilities/DragAndDropOnRouteIDcard",["UWA/Core","DS/DataDragAndDrop/DataDragAndDrop"],(function(e,t){"use strict";let o={makeDroppable:function(o,i){let n=this;if(null!==o){n.dropInvite=o.getElement("#droppable"),n.dropInvite||(n.dropInvite=new e.createElement("div",{id:"droppable",class:"hidden"}).inject(o)),n.dropInvite.callback=i;let s={enter:n._manageDragEvents.bind(n),leave:n._manageDragEvents.bind(n),over:n._manageDragEvents.bind(n),drop:n._manageDropEvent.bind(n)};t.droppable(o,s)}},_manageDragEvents:function(e,t){let o=this;switch(t.type){case"dragenter":o._addDroppableStyle(e),e.setStyles({borderStyle:"solid",borderColor:"#368ec4",borderWidth:"1px"});break;case"dragleave":t.stopPropagation(),t.preventDefault(),e.setStyle("borderWidth","0px");var i=t.target.className;if("droppable show"==i){o._removeDroppableStyle();break}if(i=i.replaceAll(" ","."),e&&null!=e.querySelector("."+i)){var n=e.querySelector("#dataGridContentsDivToolbar");n&&null!=n.querySelector("."+i)&&o._removeDroppableStyle(),(n=e.querySelector(".create-iRouteContent-help"))&&null!=n.querySelector("."+i)&&o._removeDroppableStyle();break}o._removeDroppableStyle();break;case"dragover":o._addDroppableStyle(),e.setStyles({borderStyle:"solid",borderColor:"#368ec4",borderWidth:"1px"})}return!0},_removeDroppableStyle:function(){this.dropInvite.removeClassName("droppable"),this.dropInvite.removeClassName("show"),this.dropInvite.addClassName("hidden")},_addDroppableStyle:function(e){this.dropInvite.addClassName("droppable"),this.dropInvite.removeClassName("hidden"),this.dropInvite.addClassName("show")},_manageDropEvent:function(t,o){let i=this;if(""!==t&&null!=t)try{o.setStyle("borderWidth","0px");var n=(t=e.is(t,"string")?JSON.parse(t):t).data&&t.data.items?t.data.items:null;i.dropInvite.callback(n),i.dropInvite.removeClassName("droppable"),i.dropInvite.removeClassName("show"),i.dropInvite.addClassName("hidden")}catch(e){o.setStyle("borderWidth","0px"),i.dropInvite.removeClassName("droppable"),i.dropInvite.removeClassName("show"),i.dropInvite.addClassName("hidden")}else o.setStyle("borderWidth","0px"),i.dropInvite.callback(arguments[2]),i.dropInvite.removeClassName("droppable"),i.dropInvite.removeClassName("show"),i.dropInvite.addClassName("hidden")}};return o})),define("DS/ENORouteMgmt/Config/WelcomePanelActionsConfig",["DS/Core/Core","UWA/Drivers/Alone","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";return{routes:{id:"routes",content:"summary_page",loader:{module:"DS/ENORouteMgmt/Views/RouteSummaryView",func:"build"}},route_templates:{id:"route_templates",content:"summary_page",loader:{module:"DS/ENORouteTemplateMgmt/Views/TemplateSummaryView",func:"build"}},new_route:{id:"new_route",content:"dialog",loader:{module:"DS/ENORouteMgmt/Views/Dialogs/InitiateRouteDialog",func:"InitiateRouteDialog"}},new_route_template:{id:"new_route_template",content:"dialog",loader:{module:"DS/ENORouteTemplateMgmt/Views/Dialogs/InitiateTemplateDialog",func:"InitiateTemplateDialog"}}}})),define("DS/ENORouteMgmt/Utilities/CopyLinkContentAppId",["text!DS/ENORouteMgmt/assets/json/ContentAppListJson.json"],(function(e){"use strict";let t;var o=JSON.parse(e);let i=function(e){var t="";return Object.entries(o).forEach((([o,i])=>{for(let n=0;n<i.length;n++)e==i[n]&&(t=o)})),t};return t={getAppId:e=>i(e),isCopyLink:e=>function(e){return""==i(e)?"false":"true"}(e)},t})),define("DS/ENORouteMgmt/Config/RouteTaskTabsConfig",["DS/Core/Core","UWA/Drivers/Alone","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";return[{label:o.infoPropertiesTab,id:"properties",isSelected:!0,icon:{iconName:"attributes",fontIconFamily:WUXManagedFontIcons.Font3DS},content:t.createElement("div",{id:"TaskPropertiesPanelContainer",class:"tasks-properties-panel-container"}),loader:"DS/ENORouteMgmt/Views/Loader/RouteTasksPropertiesLoader"},{label:o.members,id:"members",icon:{iconName:"users",fontIconFamily:WUXManagedFontIcons.Font3DS},allowClosableFlag:!1,content:t.createElement("div",{id:"TaskMemberContainer",class:"tasks-member-container"}),loader:"DS/ENORouteMgmt/Views/Loader/RouteTasksMembersLoader"},{label:o.comments,id:"comments",icon:{iconName:"comment",fontIconFamily:WUXManagedFontIcons.Font3DS},allowClosableFlag:!1,content:t.createElement("div",{id:"TaskCommentsContainer",class:"tasks-comments-container"}),loader:"DS/ENORouteMgmt/Views/Loader/RouteTasksCommentsLoader"}]})),define("DS/ENORouteMgmt/Utilities/Utils",["DS/UIKIT/Alert","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";var o={formatDateString:function(e){var t,i;return o.isValidDate(e)?UWA.is(o.getCookie("swymlang"))&&UWA.is(window.Intl)?(t={weekday:"short",year:"numeric",month:"short",day:"2-digit"},i=new Intl.DateTimeFormat(o.getCookie("swymlang"),t).format(e)):i=e.toDateString():i="",i},isValidDate:function(e){return UWA.is(e,"date")&&!isNaN(e.getTime())},getLocaleDate:function(e,t){const i={weekday:"long",year:"numeric",month:"long",day:"numeric"};if(t){let t=o.getCookie("swymlang");return null!=t?e.toLocaleString(t,i):e.toLocaleString("en",i)}return e.toLocaleString("en",i)},getLocaleTime:function(e,t){const i={weekday:"long",year:"numeric",month:"long",day:"numeric"};if(t){let t=o.getCookie("swymlang");return null!=t?e.toLocaleTimeString(t,i):e.toLocaleTimeString("en",i)}return e.toLocaleTimeString("en",i)},getCookie:function(e){var t=("; "+document.cookie).split("; "+e+"=");if(t.length>=2)return t.pop().split(";").shift()},reloadFacetObjects:function(e,t){if(e)for(var o=0;o<e.length;o++)t.indexOf(e[o].reference)>-1&&("taskgraph"===e[o].reference?e[o].view&&(e[o].view.destroy(),e[o].view=null):e[o].view.reload())},encodeHTMLEntites:function(e){return e.toString().replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")},decodeHTMLEntites:function(e){return e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},initHelpSystem:function(e,t){require(["DS/TopBarProxy/TopBarProxy"],(function(i){if(!i[widget.id]){i[widget.id]=new i({id:widget.id});var n,s=!0;i[widget.id].setContent({help:[{label:t,onExecute:function(){if(s){var t=o.getCookie("swymlang")||"English";s=!1,n="http://help.3ds.com/HelpDS.aspx?P=11&L="+t+"&F="+e+"&contextscope=onpremise"}n?window.open(n,"_blank"):alert("The help system is not available. Please contact your system administrator.")}}]})}}))},getPrecondForContentSearch:function(){for(var e=widget.data.routeContentSearchTypes.split(","),t="flattenedtaxonomies:(",o=e.length,i=0;i<o;i++)t+='"types/'+e[i]+'"',i<o-1&&(t+=" OR "),i===o-1&&(t+=")");return t},strLength:function(e){for(var t=e.split(""),o=0,i=0;i<t.length;i++){var n=t[i],s=encodeURIComponent(n);1==s.length?o++:o+=s.split("%").length-1}return o},activateInfoIcon:function(e){if(e.getGridViewToolbar()){let t=e.getGridViewToolbar().getNodeModelByID("information");t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&t._associatedView.elements.container.querySelector(".wux-controls-button").setStyle("color","rgb(54, 142, 196)")}},inActivateInfoIcon:function(e){if(e.getGridViewToolbar()){let t=e.getGridViewToolbar().getNodeModelByID("information");t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&t._associatedView.elements.container.querySelector(".wux-controls-button").setStyle("color","rgb(61, 61, 61)")}},refreshRightPanel:function(e,t,o){if(widget.getValue("propWidgetOpen"))if(o){let t={};t.model=o,widget.routeMgmtMediator.publish("route-header-info-click",{model:t.model,info:e})}else if(t&&1==t.getSelectedRowsModel().data.length){let o={};o.model=t.getSelectedRowsModel().data[0].options.grid,widget.routeMgmtMediator.publish("route-header-info-click",{model:o.model,info:e})}else widget.routeMgmtMediator.publish("route-header-info-click",{info:e})},clearSummaryPage:function(){let e=document.querySelector(".widget-container"),t=e.children.length;for(let o=0;o<t;o++)e.children[0].remove()}};return o})),define("DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil",[],(function(){"use strict";let e,t,o,i,n,s,a;return{setRouteContentTypes:o=>function(o){e=o.data[0].dataelements.routeDnDContentTypes,t=o.data[0].dataelements.routeSearchContentTypes}(o),getRouteContentDnDTypes:()=>e,getRouteContentSearchTypes:()=>t,setTaskCustomFields:e=>function(e){o=e}(e),getTaskCustomFields:()=>o,setStateNLS:e=>function(e){s=e}(e),getStateNLS:()=>s,setStateTemplateNLS:e=>function(e){a=e}(e),getStateTemplateNLS:()=>a,setRouteCustomFields:e=>function(e){i=e}(e),getRouteCustomFields:()=>i,setRouteTemplateCustomFields:e=>function(e){n=e}(e),getRouteTemplateCustomFields:()=>n}})),define("DS/ENORouteMgmt/Model/RouteInfoHistoryModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/WebappsUtils/WebappsUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i){"use strict";let n=new e({useAsyncPreExpand:!0,shouldBeSelected:function(e){return!1}});return{getModel:e=>function(e){let s,a,r,l,d,u,c,p,m,g,f,h,w,v,S,k;return n.prepareUpdate(),e.forEach((function(e){for(s=e.state,a=s.length-1;a>=0;a--){r=e.Time[a],l=e.userName[a],"User Agent"==l&&(l="System Admin"),d=e.routeAction[a],"create"==d&&(d="action_create"),u=e.description[a],S=u.indexOf("with Comments:"),k=u.substring(0,S),S=k.indexOf("with electronic signature"),c=u.substring(u.indexOf("with Comments:")+14),p=u.match(/'(.*?)'/g),m="",g="",f="",h="";var T=!1;if("(Approve)"==d||"(Reject)"==d||"(None)"==d||"(Abstain)"==d||"(Review_Promote)"==d||"(Review_Demote)"==d){w=p[0],v=w.replace(/'/g,""),m=v.replace("Inbox Task",i.RouteTask).trim();try{var R=m.split(",")[0],y=m.split(",")[2].split("|")[1];m=R+" "+y}catch(e){T=!0}if(g=o.getWebappsAssetUrl("ENORouteMgmt","icons/48/I_RouteTask48.png"),f=i.historyComment+c.replace(/'/g,""),f.contains("Auto-Completed")&&(m.contains("|")&&(m=i.RouteTask+" '"+m.split("|")[1]+"'"),f=f.split(":")[2],f.contains("|")))try{var b=f.split("|")[1].split("has been Auto-Completed")[0],M=f.split("|")[2].split("is")[0].trim();f=i.replace(i.taskAutoCompleteComment,{tag1:b,tag2:M})}catch(e){}if(-1==S){let e="(Reject)"!=d&&"(Approve)"!=d||"System Admin"!=l?i[d]:i.autocompleted;h=i.replace(i.taskDescription,{tag1:m,tag2:e,tag3:l})}else S>0&&(h=i.replace(i.taskDescriptionESign,{tag1:m,tag2:i[d],tag3:l}))}else if("(Assignment)"==d){let e=c.split(","),t=(e[0].split(":"),e[1].split(":")),n=e[2].split(":"),s=e[3].split(":");e[4].split(":"),e[5].split(":"),g=o.getWebappsAssetUrl("ENORouteMgmt","icons/48/I_RouteTask48.png");let a=i.RouteTask+" "+t[1]+" "+n[1];h=i.replace(i.changeAssigneeDescription,{tag1:a,tag2:s[1]})}else if("change owner"==d){g=o.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_Route108x144.png");let e=u.split("|")[0],t=u.split("|")[1];h=i.replace(i.changeOwnerDescription,{tag1:t,tag2:e})}else"(Auto Complete)"==d?(g=o.getWebappsAssetUrl("ENORouteMgmt","icons/48/I_RouteTask48.png"),h=i.replace(i.markasComplete,{tag1:u})):"action_create_subroute"==d?(g=o.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_Route108x144.png"),h=i.replace(i.subRouteCreation,{tag1:u,tag2:l})):"action_disconnect_subroute"==d?(g=o.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_Route108x144.png"),h=i.replace(i.subRouteDisconnect,{tag1:u})):(g=o.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_Route108x144.png"),m=e.name,"(Stop)"!=d&&"(Finish)"!=d||"System Admin"!=l?"promote"==d&&"System Admin"==l?h=i.routePromoteDescription:"(Stop)"==d&&""!=u?(f=i.historyComment+u.replace(/'/g,""),h=i.replace(i.routeDescriptionDetail,{tag2:i[d],tag3:l})):h=i.replace(i.routeDescriptionDetail,{tag2:i[d],tag3:l}):h=i.replace(i.routeDescription,{tag2:i[d]}));var D=e.physicalid[a];T&&(S=0);var C=new t({label:h,subLabel:r,thumbnail:g,description:f,contextualMenu:S>0,data:D});n.addRoot(C)}})),n.pushUpdate(),n}(e),destroy:()=>{n=new e({useAsyncPreExpand:!0,shouldBeSelected:function(e){return!1}})}}})),define("DS/ENORouteMgmt/Config/Toolbar/InitiateRouteContentTabToolbarConfig",["i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e){let t;return t={writetoolbarDefination:t=>{return o={entries:[{id:"addExistingContent",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"plus",fontIconFamily:WUXManagedFontIcons.Font3DS}},action:{module:"DS/ENORouteMgmt/Views/Loader/InitiateRouteAddContentSearchLoader",func:"onSearchClick"},position:"far",category:"create",tooltip:e.addExistingContent},{id:"removeContent",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"remove",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{module:"DS/ENORouteMgmt/Views/InitiateRouteContentsView",func:"removeContents"}},position:"far",category:"action",tooltip:e.deleteContent}]},JSON.stringify(o);var o},destroy:function(){_dataGrid.destroy(),_container.destroy()}},t})),define("DS/ENORouteMgmt/EnoviaBootstrap",["UWA/Core","UWA/Class/Collection","UWA/Class/Listener","UWA/Utils","DS/ENORouteMgmt/Utilities/Utils","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/ENOXWidgetPreferences/js/ENOXWidgetPreferences","DS/WAFData/WAFData"],(function(e,t,o,i,n,s,a,r,l){"use strict";var d,u,c,p,m,g,f,h,w,v,S,k=!1,T=!1;return m={authenticateRequest:function(t,o,i){var s,a,r,d,p;if(u&&(s=u.getStorageWithUrl(t)),e.is(s)){t!==(d="url",(r=s)&&(p=r[d],e.is(p,"function")&&(p=p.call(r))),p)&&(o||(o={}),o.headers||(o.headers={}),o.headers["X-DS-CSRFTOKEN"]=c||"");var g=s.id;void 0!==widget.data.ids&&(g=m.getTenantValue()),(t=t+(-1===t.indexOf("?")?"?":"&")+"tenant="+g).includes("/bps/cspaces")||("ctx::undefined"!=i&&null!=i?t=t+"&SecurityContext="+encodeURIComponent(i):m.getSecurityContextValue()&&(t=t+"&SecurityContext="+encodeURIComponent(m.getSecurityContextValue())));const a=new Date;if(a){const e=a.getTimezoneOffset()/60;e&&(t=t+"&timezone="+e)}widget.debugMode&&(t+="&$debug=true"),n.getCookie("swymlang")&&(t=t+"&$language="+n.getCookie("swymlang"))}return"undefined"!=typeof widget&&widget&&widget.data&&(i?t=m.modifyURL(t,{securityContext:i,tenant:m.getTenantValue()}):widget.data.routeCredentials&&(t=m.modifyURL(t,widget.data.routeCredentials))),a=o.onComplete,o.onComplete=function(t,o,i){c=o["X-DS-CSRFTOKEN"],e.is(a,"function")&&a(t,o,i)},l.authenticatedRequest(t,o)},start:function(t){if(!k){t.frameENOVIA&&(T=!0),t=t?e.clone(t,!1):{},u=t.collection,function(e){if(d)return d;var t="com.ds."+e.id;(d=new i.InterCom.Socket(t)).subscribeServer("com.ds.compass",window.parent)}(t),g||a.getServiceUrl({serviceName:"3DSwym",onComplete:function(e){var t;if(g=e,(t=m.getTenantValue())&&g)for(var o=0;o<g.length;o++)if(t===g[o].platformId){f=g[o].url;break}},onFailure:function(e){g=[]}}),v||a.getServiceUrl({serviceName:"3DSearch",onComplete:function(e){var t;if(v=e,(t=m.getTenantValue())&&v)for(var o=0;o<v.length;o++)if(t===v[o].platformId){S=v[o].url;break}},onFailure:function(e){v=[]}}),function(){if(h)return h;var e=m.getTenantValue();a.getServiceUrl({serviceName:"3DSpace",platformId:e,onComplete:function(e){h="string"==typeof e?e:e&&e[0]?e[0].url:""},onFailure:function(){h=""}})}(),function(){if(w)return w;var e=m.getTenantValue();a.getServiceUrl({serviceName:"3DDashboard",platformId:e,onComplete:function(e){w="string"==typeof e?e:e&&e[0]?e[0].url:""},onFailure:function(){w=""}})}(),function(){var e=UWA.is(widget.getValue("X3DContentId"),"string")?JSON.parse(widget.getValue("X3DContentId")):null;if(null==widget.getValue("linkedContextTitle")&&(widget.setValue("approvalProcessIds",void 0),widget.setValue("approvalProcessType",void 0)),null==e&&"true"!=widget.getValue("isWidgetRefreshed")?e=widget.getValue("compassDataForContext"):widget.setValue("compassDataForContext",e),e&&e.data.items&&("Route"===e.data.items[0].objectType||"Route Template"===e.data.items[0].objectType||"Inbox Task"===e.data.items[0].objectType)){if(e.data.approvalObjectType)if("Inbox Task"===e.data.approvalObjectType)widget.data.contentId=e.data.items[0].objectId,widget.data.contentType=e.data.approvalObjectType,widget.data.taskId=e.data.items[0].objectId,widget.data.contextTitle=e.data.items[0].contextTitle,widget.data.contextId=e.data.items[0].contextId,widget.data.linkedContextTitle=e.data.items[0].linkedContextTitle;else{for(var t=[],o=0;o<e.data.items.length;o++)t.push(e.data.items[o].objectId);widget.data.approvalProcessIds=t,widget.data.approvalProcessType=e.data.approvalObjectType,widget.data.contextTitle=e.data.items[0].contextTitle,widget.data.contextId=e.data.items[0].contextId,widget.data.linkedContextTitle=e.data.items[0].linkedContextTitle}else widget.data.contentId=e.data.items[0].objectId,widget.data.contentType=e.data.items[0].objectType;"Inbox Task"===e.data.items[0].objectType&&(widget.data.taskId=e.data.items[0].objectId,widget.data.contextTitle=e.data.items[0].contextTitle,widget.data.contextId=e.data.items[0].contextId,widget.data.linkedContextTitle=e.data.items[0].linkedContextTitle),widget.setValue("routefilters",["owned","assigned","Define","In Process","Complete"]),widget.setValue("X3DContentId",null)}}();try{i.Client.Platform.windows&&require(["DS/MSFDocumentManagement/WidgetIntegration"],(function(e){widget.MSFDocumentClient=e,widget.MSFDocumentClient.ConnectWidgetWithMSF()}))}catch(e){console.error(e)}k=!0}},updateURLsOnEdit:function(e){let t=m.getTenantValue();var o=e.get(t);if(h=o._attributes.url,t&&g)for(var i=0;i<g.length;i++)if(t===g[i].platformId){f=g[i].url;break}},getLoginUser:function(){if("undefined"!=typeof dscef&&widget.getValue("native_user_info")&&1==widget.getValue("native_user_info").isNative)return widget.getValue("native_user_info").contextUser;var e=s.getUser();return e&&e.login?e.login:void 0},getLoginUserFullName:function(){var e=s.getUser();if(e&&e.login)return e.firstName+" "+e.lastName},getLoginUserEmail:function(){var e=s.getUser();if(e&&e.email)return e.email},getCompassSocket:function(){if(k)return d},getSyncOptions:function(){return T?{}:{ajax:l.authenticatedRequest}},getStorages:function(){if(k)return u},getStorage:function(){if(k)return p},get3DSpaceURL:function(){if(k)return h},getDashboardURL:function(){if(k)return w},getRouteServiceBaseURL:function(){if(k)return h+"/resources/v1/modeler/routes"},getRouteTemplateServiceBaseURL:function(){if(k)return h+"/resources/v1/modeler/routetemplates"},getCollabTaskServiceBaseURL:function(){if(k)return h+"/resources/v1/modeler/tasks"},getSNIconServiceBaseURL:function(){if(k)return h+"/snresources/images/icons/large"},getDocumentServiceBaseURL:function(){if(k)return h+"/resources/v1/modeler/documents"},get6WServiceBaseURL:function(){if(k)return h+"/resources/v3/e6w/service"},getSwymUrl:function(){if(f)return f},getSearchUrl:function(){if(S)return S},modifyURL:function(e,t){return t&&(t.tenant&&(e=e+(-1===e.indexOf("?")?"?":"&")+"tenant="+t.tenant),t.noSecurityContextForSearch||widget&&widget.data&&widget.data.noSecurityContextForSearch||t.securityContext&&(e=e+"&SecurityContext="+encodeURIComponent(t.securityContext)),n.getCookie("swymlang")&&(e=e+"&$language="+n.getCookie("swymlang"))),e},getTenantValue:function(){return widget.data.routeCredentials?widget.data.routeCredentials.tenant:widget.getValue("x3dPlatformId")},getSecurityContextValue:function(){var e="";if(widget.data.routeCredentials)e=widget.data.routeCredentials.securityContext;else{var t=r.getCredentialPreferenceKey();e="ctx::"+widget.getValue(t)}return e},getCSRFToken:function(){return new Promise((function(t,o){l.authenticatedRequest(h+"/resources/v1/application/E6WFoundation/CSRF",e.extend({method:"GET",onComplete:function(e){t(e)}}))}))},getCurrentLanguage:function(){return widget.lang}}})),define("DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView",["DS/DataGridView/DataGridView","DS/ENORouteMgmt/EnoviaBootstrap","DS/DataGridView/DataGridViewLayout","DS/Controls/Label","UWA/Drivers/Alone"],(function(e,t,o,i,n){"use strict";let s,a,r,l,d={rowsHeader:!1},u=function(e){return e=JSON.parse(e),r=a.setToolbar(JSON.stringify(e)),r},c=function(e){if(widget.getValue("wux-collectionView-dataGridView"))try{const t=JSON.parse(widget.getValue("wux-collectionView-dataGridView"))[e.identifier];t&&e.loadCustomViews(t.customViews,t.currentCustomViewId)}catch(e){console.log("error in fetching data grid persistence")}},p=function(){a.registerReusableCellContent({id:"_state_",buildContent:function(){let e=UWA.createElement("div");return UWA.createElement("span",{html:"",class:"route-state-title "}).inject(e),e.style.cursor="pointer",e}}),a.registerReusableCellContent({id:"_assignee_",buildContent:function(){new UWA.Element("div",{class:"members"}),new UWA.Element("div",{class:"assignee"});let e=UWA.createElement("div");return UWA.createElement("span",{html:"",class:"route-state-title "}).inject(e),e}}),a.registerReusableCellContent({id:"_owner_",buildContent:function(){var e=new UWA.Element("div",{id:"Route-Owner-responsible"}),o=new UWA.Element("div",{class:"assignee"});var i;return(null!=t.getSwymUrl()?UWA.createElement("img",{class:"userIcon"}):UWA.createElement("div",{html:"",class:"avatarIcon"})).inject(o),UWA.createElement("span",{class:"askRTOwnerDiv wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-user-clock",html:""}).inject(o).setStyle("display","none"),i="undefined"==typeof dscef?UWA.createElement("a",{class:"userName",html:""}):UWA.createElement("div",{class:"userName",html:""}),o.inject(e),i.inject(e),e}}),a.registerReusableCellContent({id:"_attachmentList_",buildContent:function(){var e=new UWA.Element("div",{id:"taskAttachmentGrid"}),t=new UWA.Element("div",{class:"attachmentList"}),o="";o=UWA.createElement("img",{class:"attachmentIcon"});var i=UWA.createElement("span",{class:"attachmentName",html:""}),n=UWA.createElement("div",{class:"attachmentRevisionDiv"});UWA.createElement("a",{class:"attachmentRevision",html:""}).inject(n);var s=UWA.createElement("div",{class:"",html:""});return o.inject(t),i.inject(t),n.inject(t),s.inject(t),t.inject(e),e}}),a.registerReusableCellContent({id:"_taskAssignee_",buildContent:function(){var e=new UWA.Element("div",{}),o=new UWA.Element("div",{class:"assignee"});(null!=t.getSwymUrl()?UWA.createElement("img",{class:"userIcon"}):UWA.createElement("div",{html:"",class:"avatarIcon"})).inject(o),UWA.createElement("img",{class:"userGroupIcon"}).inject(o).setStyle("display","none");var i=UWA.createElement("span",{class:"userName",html:""});return o.inject(e),i.inject(e),e}}),a.registerReusableCellContent({id:"_duedate_",buildContent:function(){let e=UWA.createElement("div",{class:"task-duedate-column"}),t=UWA.createElement("span",{html:"",class:"task-duedate-status wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attention"}).inject(e);t.setStyle("color","red"),t.setStyle("display","none");let o=UWA.createElement("span",{html:"",class:"task-duedate-status wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-clock"}).inject(e);return o.setStyle("color","orange"),o.setStyle("display","none"),new i({value:""}).inject(e),e}}),a.registerReusableCellContent({id:"_assignmentScope_",buildContent:function(){var e=new UWA.Element("div",{}),t=new UWA.Element("div",{class:"assignmentScope"}),o=UWA.createElement("a",{class:"userName",html:""});return t.inject(e),o.inject(e),e}}),a.registerReusableCellContent({id:"_appliesToGrid_",buildContent:function(){var e=new UWA.Element("div",{class:"similarTemplateRow"}),t=new UWA.Element("div",{class:"similarTemplateNameAndIconRow"}),o=UWA.createElement("img",{class:"similarAppliesToTemplateIcon"}),i=UWA.createElement("div",{class:"similarAppliesToTemplateTitle"}),n=(UWA.createElement("span",{}),UWA.createElement("div",{class:"similarTemplateDetails"}));return UWA.createElement("span",{}).inject(i),i.inject(t),n.inject(t),o.inject(e),t.inject(e),e}})};return s={build:(t,i,n,s,r)=>function(t,i,n,s,r){let m=35,g="multiple";if(r.identifier=r.identifier+"-"+widget.id,r&&1==r.showRowCount&&(d.rowsHeader=!0),r&&r.layoutOptions?(d=r.layoutOptions,delete r[d]):d={rowsHeader:!1},l={identifier:r.identifier,treeDocument:t,useWidgetPreferencesFlag:!0,columns:i,layout:new o(d),defaultColumnDef:{widthd:"auto",typeRepresentation:"string"},virtuallyLoadAllModelItems:!0,rowGroupingEnabledFlag:!1},r)for(let e in r)r.hasOwnProperty(e)&&(l[e]=r[e]);return a=new e(l),r.layoutOptions&&r.layoutOptions.cellHeight&&(m=r.layoutOptions.cellHeight),r.layoutOptions&&r.layoutOptions.rowSelection&&(g=r.layoutOptions.rowSelection),a.layout.cellHeight=m,a.rowSelection=g,a.cellSelection="none",a.getContent().style.top="50 px",n&&u(n),p(),c(a),a.inject(s),s}(t,i,n,s,r),confirmationDialogueBuild:(t,i,n,s,r)=>function(t,i,n,s,r){if(r.identifier=r.identifier+"-"+widget.id,r&&1==r.showRowCount&&(d.rowsHeader=!0),r&&r.layoutOptions?(d=r.layoutOptions,delete r[d]):d={rowsHeader:!1},l={identifier:r.identifier,treeDocument:t,useWidgetPreferencesFlag:!1,columns:i,layout:new o(d),defaultColumnDef:{widthd:"auto",typeRepresentation:"string"},virtuallyLoadAllModelItems:!0,rowGroupingEnabledFlag:!1},r)for(let e in r)r.hasOwnProperty(e)&&(l[e]=r[e]);return a=new e(l),a.layout.cellHeight=35,a.rowSelection="multiple",a.cellSelection="none",a.getContent().style.top="50 px",n&&u(n),p(),c(a),a.inject(s),s}(t,i,n,s,r),dataGridView:()=>a,destroy:function(){a.destroy(),undefined.destroy()},dataGridViewToolbar:()=>r,getSelectedRowsModel:e=>function(e){for(var t={},o=[],i=e.getSelectedNodes(),n=0;n<i.length;n++)o.push(i[n]);return t.data=o,t}(e),deleteRowModelByIndex:(e,t)=>function(e,t){var o=e.getNthRoot(t);o&&(e.prepareUpdate(),e.removeRoot(o),e.pushUpdate())}(e,t),deleteRowModelSelected:e=>function(e){let t=[];var o=e.getSelectedNodes();e.prepareUpdate();for(var i=0;i<o.length;i++)e.removeRoot(o[i]),t.push(o[i].options.id);return e.pushUpdate(),t}(e),deleteRowModelById:(e,t)=>function(e,t){for(var o=e.getChildren(),i=0;i<o.length;i++)o[i].options.id==t&&(e.prepareUpdate(),e.removeRoot(o[i]),e.pushUpdate())}(e,t),deleteRowModelByIds:(e,t)=>function(e,t){for(var o=e.getChildren(),i=[],n=0;n<o.length;n++)t.includes(o[n].options.id)&&i.push(o[n]);i.forEach((function(t){e.prepareUpdate(),e.removeRoot(t),e.pushUpdate()}))}(e,t),getRowModelById:(e,t)=>function(e,t){for(var o=e.getChildren(),i=0;i<o.length;i++)if(o[i].options.id==t)return o[i]}(e,t),getRowModelIndexById:(e,t)=>function(e,t){for(var o=e.getChildren(),i=0;i<o.length;i++)if(o[i].options.id==t)return i}(e,t),getRowModelByDescendantsId:(e,t)=>function(e,t){for(var o=e.getAllDescendants(),i=0;i<o.length;i++)if(o[i].options.id==t)return o[i]}(e,t)},s})),define("DS/ENORouteMgmt/Utilities/ParseJSONUtil",["UWA/Class","DS/ENORouteMgmt/Utilities/Utils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";var i=e.extend({parseResp:function(e){e.csrf&&(widget.data.csrf=e.csrf);let t=new Array;for(var o=e.data.length,i=0;i<o;i++){t[i]=e.data[i].dataelements,s(e.data[i],t[i]);let o=e.data[i].relateddata;if(o)for(let e in o)o.hasOwnProperty(e)&&(t[i][e]=n(o[e]))}return t},createCSRFForRequest:function(e){return void 0===e&&(e=widget.data.csrf),{csrf:e}},createDataForRequest:function(e,t){void 0===t&&(t=widget.data.csrf);var o={dataelements:e},i=new Array;return i.push(o),{csrf:t,data:i}},createDataForPromoteDemote:function(e,t,o){void 0===o&&(o=widget.data.csrf);var i={updateAction:t,dataelements:e},n=new Array;return n.push(i),{csrf:o,data:n}},createDatasForRequest:function(e,t,o){void 0===o&&(o=widget.data.csrf);for(var i=new Array,n=0;n<e.length;n++){var s={dataelements:e[n],id:t};i.push(s)}return{csrf:o,data:i}},createRemoveSubRouteForRequest:function(e,t,o,i){void 0===i&&(i=widget.data.csrf);for(var n=new Array,s=0;s<e.length;s++){var a={id:e[s],dataelements:{contextObjectId:t,contextObjectType:"Inbox Task",routeOwner:o[s]}};n.push(a)}return{csrf:i,data:n}},createDataWithIdForRequest:function(e,t){var o=[];void 0===t&&(t=widget.data.csrf);for(let t=0;t<e.length;t++){var i={id:e[t]};o.push(i)}return{csrf:t,data:o}},getParsedRouteTasks:function(e){var t={tasks:[]};return e.forEach((e=>{let o="";e.taskDueDate&&""!=e.taskDueDate&&(o=new Date(e.taskDueDate).toISOString()),t.tasks.push({dataelements:{allowDelegation:e.allowDelegation,assigneeId:e.assigneeId,assigneeSetDueDate:e.assigneeSetDueDate,instructions:e.instructions,parallelNodeProcessionRule:e.parallelNodeProcessionRule,taskAction:e.taskAction,taskOrder:e.taskOrder,taskDueDate:o,title:e.title,reviewTask:e.needsOwnerReview,dateOffsetFrom:e.dteOffsetFrom,dueDateOffset:e.dueaDateOffset,needsOwnerReview:e.needsOwnerReview,chooseUsersFromUg:e.chooseUsersFromUg}})})),t}});let n=function(e){let t=new Array;for(var o=e.length,i=0;i<o;i++)t[i]=e[i].dataelements,s(e[i],t[i]);return t},s=function(e,t){return"Group Proxy"!==e.dataelements.assigneeType&&"Group"!==e.dataelements.assigneeType||(t.assigneeTitle=e.dataelements.assigneeTitle),void 0===t.id&&(t.id=e.id),void 0===t.physicalid&&(t.physicalid=e.id),void 0===t.type&&(t.type=e.type),void 0===t.relId&&(t.relId=e.relId),t};return i})),define("DS/ENORouteMgmt/Utilities/DataFormatter",["DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";let o;return o={gridData:e=>function(e){var o=null==e.Type?e.type:e.Type;return{id:e.id,Name:e.name,Title:e.title,Maturity_State:e.stateNLS,state:e.state,Type:o,Route_Status:e.routeStatus,Activity_State:e.activityState,Description:e.description,Assignees:e.assignees,AssigneesDiv:e.assigneesdiv,Owner:e.ownerFullName,OwnerId:e.ownerId,revision:e.revision,UserName:e.owner,Actions:e.actions,Originated:e.originated,organization:e.organization,Modified:e.modified,OwnerFullName:e.ownerFullName,TypeIconLarge:e.typeiconLarge,TypeIconSmall:e.typeicon,Project:e.project,ProjectTitle:e.projectTitle,BasePurpose:e.routeBasePurpose,BasePurposeNLS:t[e.routeBasePurpose],DemoteOnRejection:e.DemoteOnRejection,DemoteOnRejectionNLS:t[e.DemoteOnRejection],TemplateName:e.sConnectedRTName,TemplateId:e.sConnectedRTId,TemplateRevision:e.sConnectedRTRevision,TemplateTitle:e.sConnectedRTTitle,Scope:e.attrScope,ScopeMembers:e.attrScopeMembers,DeleteAccess:e.deleteAccess,ownerFilter:e.owner,preserveTaskOwner:e.preserveTaskOwner,actualState:e.state,selectUsersFromUserGroup:e.selectUsersFromUserGroup,attRestrictMembers:e.attRestrictMembers,currentRouteNode:e.currentRouteNode,linkedRouteTemplate:e.linkedRouteTemplate,linkedRouteTemplateTitle:e.linkedRouteTemplateTitle,routeCompletionAction:e.routeCompletionAction,requiresEsign:e.requiresEsign,taskEditSetting:e.taskEditSetting,AutoStopOnRejection:e.AutoStopOnRejection,showAbstain:e.showAbstain,parentRouteTaskDueDate:e.parentRouteTaskDueDate,organizationTitle:e.organizationTitle,RestrictUserGroup:e.RestrictUserGroup}}(e),contentGridData:e=>function(e){return{id:e.id,Name:e["ds6w:identifier"],Title:e["ds6w:label"],Maturity:e["ds6w:status"],Type:e["ds6w:type"],Description:e["ds6w:description"],Owner:e.owner,Creation_Date:e["ds6w:created"],Modified_Date:e["ds6w:modified"],TypeIconLarge:e.preview_url}}(e),memberGridData:e=>function(e){return{id:e.id,Access:e.newAccess}}(e),taskGridData:o=>function(o){var i={id:o.id,type:o.type,projectTaskRelId:o.projectTaskRelId,originated:o.originated,originator:o.originator,taskRequirement:o.taskRequirement,allowDelegation:o.allowDelegation,assigneeSetDueDate:o.assigneeSetDueDate,dateOffsetFrom:o.dateOffsetFrom,dueDateOffset:o.dueDateOffset,reviewCommentsNeeded:o.reviewCommentsNeeded,needsOwnerReview:o.needsOwnerReview,reviewersComments:o.reviewersComments,title:o.title,comments:o.comments,taskAction:o.taskAction,taskActionNLS:"TRUE"==o.routeOwnerTask?t.assign:t[o.taskAction],instructions:o.instructions,taskDueDate:o.taskDueDate,approvalStatus:o.approvalStatus,name:o.name,current:o.current,currentNLS:o.stateNLS,modified:o.modified,revision:o.revision,taskOrder:o.taskOrder,parallelNodeProcessionRule:o.parallelNodeProcessionRule,assigneeId:o.assigneeId,assigneeTitle:o.assigneeTitle,assigneeType:o.assigneeType,assigneePID:o.assigneePID,taskAcceptLink:o.taskAcceptLink,taskAssignee:o.taskAssignee,taskassigneeState:o.assigneeState,taskAssigneeUsername:o.taskAssigneeUsername,taskDetails:o.taskDetails,typeicon:o.typeicon,awaiting_taskApprovalStatus:o.awaiting_taskApprovalStatus,chooseUsersFromUg:o.chooseUsersFromUg,routeOwnerTask:o.routeOwnerTask,routeOwnerUGChoice:o.routeOwnerUGChoice,routeOwnerUGName:o.routeOwnerUGName,routeOwnerUGTitle:o.routeOwnerUGTitle,routeOwnerUGUUID:o.routeOwnerUGUUID,isInitialTask:o.isInitialTask,templateTask:o.templateTask,taskEditSetting:o.taskEditSetting,attrTaskStatus:o.attrTaskStatus,taskAttachments:o.taskAttachments,routeContents:o.routeContents,userGroupAction:o.userGroupAction,userGroupInfo:o.userGroupInfo,taskSubRoutes:o.taskSubRoutes,userGroupUid:o.ugUUID,subRouteApprovalStatus:o.subRouteApprovalStatus,subRouteGridApprovalStatus:o.subRouteGridApprovalStatus,RouteTaskContentToReview:o.RouteTaskContentToReview,ContentToReviewIds:o.ContentToReviewIds,contentToReviewFieldInfo:o.contentToReviewFieldInfo,contentToReviewOrgFieldInfo:o.contentToReviewOrgFieldInfo,removeContentToReview:o.removeContentToReview,validTaskData:o.validTaskData,taskDetailsList:o.taskDetailsList,stateNLS:o.stateNLS,routeTaskPriorityNLS:o.routeTaskPriorityNLS,routeTaskPriority:o.routeTaskPriority,candidateAssignee:o.candidateAssignee};"Auto Complete"==o.approvalStatus&&(i.awaiting_taskApprovalStatus=t.completedByOwner);let n=e.getTaskCustomFields();return n&&n.forEach(((e,t)=>{if("extensions"!=e.name){let t=o[e.name];i[e.name]=t}})),i}(o),templateGridData:e=>function(e){return e.revision&&!isNaN(e.revision)&&(e.revision=parseInt(e.revision,10)),{id:e.id,Name:e.name,Title:e.title,Maturity_State:e.stateNLS,revision:e.revision,state:e.state,Type:e.type,Activity_State:e.routeStatus,Activity_StateNLS:null==t[e.routeStatus]?"":t[e.routeStatus],Description:e.description,Assignees:e.assignees,AssigneesDiv:e.assigneesdiv,Owner:e.ownerFullName,UserName:e.owner,Actions:e.actions,Originated:e.originated,organization:e.organization,Modified:e.modified,OwnerFullName:e.ownerFullName,OwnerId:e.ownerId,TypeIconLarge:e.typeiconLarge,TypeIconSmall:e.typeicon,Project:e.project,ProjectTitle:e.projectTitle,ProjectVisibility:e.projectVisibility,BasePurpose:e.routeBasePurpose,BasePurposeNLS:t[e.routeBasePurpose],DemoteOnRejection:e.DemoteOnRejection,DemoteOnRejectionNLS:t[e.DemoteOnRejectionNLS],TemplateName:e.sConnectedRTName,Scope:[e.attRestrictMembers],ScopeMembers:e.attrScopeMembers,DeleteAccess:e.deleteAccess,ownerFilter:e.owner,actualState:e.state,selectUsersFromUserGroup:e.selectUsersFromUserGroup,attRestrictMembers:e.attRestrictMembers,currentRouteNode:e.currentRouteNode,preserveTaskOwner:e.preserveTaskOwner,linkedRouteTemplate:e.linkedRouteTemplateTitle,linkedRouteTemplateId:e.linkedRouteTemplateId,completionAction:e.completionAction,reviseAccess:e.reviseAccess,sConnectedRouteId:e.sConnectedRouteId,routeCompletionAction:e.routeCompletionAction,organizationTitle:e.organizationTitle,applicableTo:e.applicableTo}}(e),getIdsForServicePayload:e=>function(e){var t=[];let o;for(var i=0;i<e.length;i++){var n={};n.id=e[i],t.push(n)}return o={data:t},o}(e)},o})),define("DS/ENORouteMgmt/Utilities/Search/SearchUtil",["UWA/Class","DS/UIKIT/Alert","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i){"use strict";let n=function(e){let t={precond:'flattenedtaxonomies:("types/Route Template") AND current:"Active" AND latestrevision:"TRUE" AND route_95_base_95_purpose:"Standard" AND route_95_template_95_valid:"TRUE"'};var o=[];return""!=e&&null!=e&&(r(e.data,o),t.resourceid_not_in=o),t},s=function(){var e="";return widget.data.routeCredentials&&widget.data.routeCredentials.securityContext?e=widget.data.routeCredentials.securityContext.split("ctx::")[1].split(".")[1]:widget.data.pad_security_ctx?e=widget.data.pad_security_ctx.split("ctx::")[1].split(".")[1]:widget.getPreference("organization")&&(e=widget.getPreference("organization").value),e},a=function(){return"newRouteDialog"==widget.getValue("currentDialog")?widget.getValue("routeOrgnization"):widget.getValue("templateOrgnization")};function r(e,t){t.push(e[0].id),""!=e[0].children&&r(e[0].children,t)}return{getRefinementToSnN:(e,t,n,s)=>function(e,t,n,s){var a={title:i[t],role:"",mode:"furtive",default_with_precond:!0,show_precond:!1,multiSel:n,idcard_activated:!1,select_result_max_idcard:!1,itemViewClickHandler:"",app_socket_id:e,widget_id:e,search_delegation:"3dsearch",default_search_criteria:"",source:["3dspace"],recent_search:{types:s}};return null!=o.getTenantValue()&&(a.tenant=o.getTenantValue()),a.global_actions=[{id:"incontextHelp",title:i["search.help"],icon:"fonticon fonticon-help",overflow:!1}],a}(e,t,n,s),getPrecondForContentSearch:(e,t,o)=>function(e,t,o){var i="flattenedtaxonomies:(",n=t.length;return t.forEach((function(e,t){i+='"types/'+e+'"',t<n-1&&(i+=" BOR "),t===n-1&&(i+=")")})),""!=e&&void 0!==e&&"Organization"!=e&&"All"!=e?i+=' AND route_95_content_95_scope:"'+e+'"':"Organization"==e&&(!0===widget.getValue("isDialogOpened")?o=a():null!=o&&""!=o||(o=s()),i+=' AND organization:"'+o+'"'),i}(e,t,o),getPrecondForRouteTemplateSearch:()=>'flattenedtaxonomies:("types/Route Template") AND current:"Active" AND latestrevision:"TRUE" AND route_95_template_95_valid:"TRUE"',getPrecondForScopeSearch:()=>'flattenedtaxonomies:"types/Workspace Vault" OR (flattenedtaxonomies:"types/Workspace" AND current:"Active") OR (flattenedtaxonomies:"types/Project Space" AND current:"Active") AND (identifier:(__QUERY__) OR label:(__QUERY__))',getPrecondForTaskMemberSearch:e=>function(e){let t={precond:'(flattenedtaxonomies:"types/Person" OR "types/Group") AND current:"active"'};if(!e.Scope)return t;if(e.ScopeMembers||(e.ScopeMembers=[""]),0==e.ScopeMembers.length&&(null!=e.ScopeMembers[0]&&null!=e.ScopeMembers[0]||(e.ScopeMembers=[""])),"OnPremise"==o.getTenantValue())"All"==e.Scope[0]?t.precond='(flattenedtaxonomies:"types/Person" OR "types/Group") AND current:"active"':"Organization"==e.Scope[0]?e.organization?t.precond='(flattenedtaxonomies:"types/Person" AND current:"active" AND member:"'+e.organization+'") OR (flattenedtaxonomies:"types/Group" AND current:"active")':!0===widget.getValue("isDialogOpened")?t.precond='(flattenedtaxonomies:"types/Person" AND current:"active" AND member:"'+a()+'") OR (flattenedtaxonomies:"types/Group" AND current:"active")':t.precond='(flattenedtaxonomies:"types/Person" AND current:"active" AND member:"'+s()+'") OR (flattenedtaxonomies:"types/Group" AND current:"active")':(t.precond='(flattenedtaxonomies:"types/Person" OR "types/Group") AND current:"active"',t.resourceid_in=e.ScopeMembers);else if("All"==e.Scope[0])t.precond='([ds6w:type]:(Group) AND [ds6w:status]:(Public)) OR (flattenedtaxonomies:"types/Person" AND current:"active")';else if("Organization"==e.Scope[0])e.organization?t.precond='([ds6w:type]:(Group) AND [ds6w:status]:(Public)) OR (flattenedtaxonomies:"types/Person" AND current:"active" AND member:"'+e.organization+'")':!0===widget.getValue("isDialogOpened")?t.precond='([ds6w:type]:(Group) AND [ds6w:status]:(Public)) OR (flattenedtaxonomies:"types/Person" AND current:"active" AND member:"'+a()+'")':t.precond='([ds6w:type]:(Group) AND [ds6w:status]:(Public)) OR (flattenedtaxonomies:"types/Person" AND current:"active" AND member:"'+s()+'")';else{for(var i="(",n=[],r=!1,l=0;l<e.ScopeMembers.length;l++)-1!=e.ScopeMembers[l].indexOf("uuid")?(r=!0,i=i+'uri:"'+e.ScopeMembers[l]+'" OR '):n.push(e.ScopeMembers[l]);r?(i=i.substring(0,i.length-4),i+=") ",t.precond="("+i+' AND [ds6w:type]:(Group) AND [ds6w:status]:(Public)) OR (flattenedtaxonomies:"types/Person" AND current:"active")'):t.precond='((uri:"-1") AND [ds6w:type]:(Group) AND [ds6w:status]:(Public)) OR (flattenedtaxonomies:"types/Person" AND current:"active")',t.resourceid_in=n}return t}(e),getPrecondForLinkTemplateEditSearch:e=>n(e),getPrecondForLinkTemplateSaveAsSearch:e=>function(e){let t={precond:'flattenedtaxonomies:("types/Route Template") AND current:"Active" AND latestrevision:"TRUE" AND route_95_base_95_purpose:"Standard" AND route_95_template_95_valid:"TRUE"'};return""!=e&&null!=e&&(t.resourceid_not_in=e),t}(e),getPrecondForRouteOwnerTaskAssignment:e=>function(e){let t={};return""!=e.options.grid.routeOwnerUGChoice&&null!=e.options.grid.routeOwnerUGChoice?t.precond='(flattenedtaxonomies:"types/Person" AND userrole="'+e.options.grid.routeOwnerUGName+'"  AND current:"active") ':""!=e.options.grid.candidateAssignee&&null!=e.options.grid.candidateAssignee?t.precond='(flattenedtaxonomies:"types/Person" AND userrole="'+e.options.grid.candidateAssignee+'"  AND current:"active") ':t.precond='(flattenedtaxonomies:"types/Person" AND current:"active") ',t}(e),getPrecondForLinkTemplateSearch:e=>'flattenedtaxonomies:("types/Route Template") AND current:"Active" AND latestrevision:"TRUE" AND route_95_base_95_purpose:"Standard" AND route_95_template_95_valid:"TRUE"',getPrecondForRouteOwnerAssignmentScope:e=>function(e){let t={};return"OnPremise"==o.getTenantValue()?t.precond='(flattenedtaxonomies:"types/Group")':t.precond="([ds6w:type]:(Group) AND [ds6w:status]:(Public))",t}(),getPrecondForDocumentSearch:()=>'( NOT (flattenedtaxonomies:"types/Person" OR flattenedtaxonomies:"types/Business Role" OR flattenedtaxonomies:"types/Security Context" OR flattenedtaxonomies:"types/Route" OR flattenedtaxonomies:"types/Route Template" OR flattenedtaxonomies:"types/Inbox Task"))',getPrecondForContextSearch:(e,t)=>{return i="flattenedtaxonomies:(",n=(o=t).length,o.forEach((function(e,t){i+='"types/'+e+'"',t<n-1&&(i+=" BOR "),t===n-1&&(i+=")")})),i;var o,i,n},getOrganizationFromCredentials:()=>a()}})),define("DS/ENORouteMgmt/Model/TaskModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Model/Utils/TaskModelUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i){"use strict";let n,s=[],a=function(){s=[],n=new e};return{getModel:e=>function(e){return s=[],n.prepareUpdate(),o.prepareTreeDocumentModel(e,n),n.pushUpdate(),n}(e),getTaskNodeModel:(e,t)=>function(e,t){return o.getTaskNodeModel(n,e,t)}(e,t),getTaskTreeDocument:()=>n,destroy:()=>(n?n.empty():a(),void(n.options._isTaskPanelOpened=!1)),deleteTreeNodeModel:e=>function(e){let t=o.deleteTreeNodeModel(e);return s=s.concat(t.deletedTasks),t.deletedGraphNodes}(e),getTasksDataForCreation:()=>o.getTasksDataForCreation(n),reOrderTreeNodeModels:(e,t)=>function(e,t){return o.reOrderTreeNodeModels(n,e,t)}(e,t),removeGraphNodesFromTree:e=>function(e){return o.removeGraphNodesFromTree(e)}(e),getTaskData:e=>function(e){let t=[];return e&&e.options.grid.validTaskData&&t.push(e.options.grid),t}(e),getTasksDataForEdit:()=>o.getTasksDataForEdit(n),getDeletedTasks:()=>s}})),define("DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils",["DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";let o=function(e,t,o,i){require(["DS/ENORouteMgmt/Model/InitiateRouteContentModel"],(function(i){e.id&&""!=e.id&&(e.RouteTargetState=t,e.RouteTargetState_NLS=o,e.TargetMaturityMenu={},e.TargetMaturityMenu.menu=n(e),i.getRowModelById(e.id).updateOptions({grid:e}))}))},i=function(e,o,i,n){require(["DS/ENORouteMgmt/Model/RouteContentModel","DS/ENORouteMgmt/Controller/RouteServicesController"],(function(e,a){let r=e.getModel().getSelectedNodes()[0].options.grid;if(r.id&&""!=r.id){r.RouteTargetState=o,r.RouteTargetState_NLS=i;let l=e.getModel().RouteId;r.setMaturityTarget=!0,a.updateRouteContentStateBlocking(r,l).then((function(o){if(o.success){var i=[];let o=e.getModel().getSelectedNodes()[0];r.TargetMaturityMenu={},r.TargetMaturityMenu.menu=s(r,n,e.getModel().routeModel.state,e.getModel().routeModel),o.updateOptions({grid:r}),widget.notify.handler().addNotif({level:"success",subtitle:t.successTargetMaturityUpdated,sticky:!0});var a={id:o.options.grid.id};i.push(a),widget.routeMgmtMediator.publish("route-content-updated",i)}})).catch((function(e){null!=e.internalError&&e.internalError.indexOf("#1600300")>=0&&e.internalError.indexOf(" Invalid object id")>0?widget.notify.handler().addNotif({level:"error",subtitle:t.ErrorInvalidObject,sticky:!0}):widget.notify.handler().addNotif({level:"error",subtitle:t.failedTargetMaturityUpdated,sticky:!0})}))}}))},n=function(e,t){var i=[],n=e.maturityTargetStates,s=e.RouteBaseState,a=e.RouteTargetState,r=!1,l="unselected";if(null!=n)for(let t=0;t<n.length;t++){var d=n[t].split("~");if(r=!!r||s==d[0]){for(var u=d[1].split(","),c=d[2].split(","),p=d[3].split(","),m=0;m<u.length;m++){l="selected"==l?"unselected":a==u[m]?"selected":"unselected";const t=p[m],n=u[m];var g={type:"CheckItem",title:t,title_actual:n,state:"TRUE"==c[m]?"enabled|"+l:"disabled|"+l,action:{callback:function(){o(e,n,t)}}};i.push(g)}break}}return i},s=function(e,t,o,n){if(d(e,n))return[];var s=[],a=e.maturityTargetStates,r=e.RouteBaseState,l=e.RouteTargetState,u=(e.current,!1),c="unselected";if(null!=a)for(let o=0;o<a.length;o++){var p=a[o].split("~");if(u=!!u||r==p[0]){for(var m=p[1].split(","),g=p[2].split(","),f=p[3].split(","),h=0;h<m.length;h++){c="selected"==c?"unselected":l==m[h]?"selected":"unselected";const o=f[h],n=m[h];var w={type:"CheckItem",title:o,title_actual:n,state:"TRUE"==g[h]?"enabled|"+c:"disabled|"+c,action:{callback:function(){e.RouteTargetState!=n&&i(0,n,o,t)}}};s.push(w)}break}}return s},a=function(e,t,o,i,a){if(d(e,a))return[];return"InitiateRoute"==t?n(e,o):s(e,o,i,a)},r=function(t){if(t){if("Completed"==t.actualState)return!1;if(t.UserName==e.getLoginUser())return!0;if(t.Assignees){var o=!1;return t.Assignees.forEach((function(t){t.contains("Person~"+e.getLoginUser()+"~")&&(o=!0)})),o}return!1}},l=function(e){if(e&&e.length>0){return e.find((e=>"enabled|selected"==e.state||"selected"==e.state)).title}},d=function(e,t){if(t&&!r(t))return!0;if(t&&""!==t.state&&"In Process"==t.state){var o=e.maturityBlockingStates,i=e.current,n=!0;if(o&&o.length>0)for(var s=0;s<o.length-1;s++){i==(a=o[s].split("~"))[3]&&("TRUE"!=a[2]&&"True"!=a[2]||(n=!1))}return n}o=e.maturityBlockingStates,n=!0,i=e.current;if(o&&o.length>0)for(s=0;s<o.length-1;s++){var a;if("TRUE"!=(a=o[s].split("~"))[2]&&"True"!=a[2]||(n=!1),t&&""!==t.state&&i==a[3]&&("FALSE"==a[2]||"false"==a[2])){n=!0;break}}return n};return{getTargetMenuForGrid:(e,o,i)=>function(e,o,i){if(!e.maturityTargetStates)return e.RouteTargetState_NLS?"  "+e.RouteTargetState_NLS:"  "+t.None;var n=a(e,o,"Grid",s,i);if(""==e.RouteTargetState&&"Ad Hoc"!=e.RouteBaseState){for(let t=0;t<e.maturityTargetStates.length;t++)if(e.maturityTargetStates[t].split("~")[0]==e.RouteBaseState)return e.RouteBaseState_NLS=e.maturityTargetStates[0].split("~")[3].split(",")[0],"  "+e.RouteBaseState_NLS}else{if(("RouteContent"!==o||r(i))&&n.length>1){var s="";return i&&i.state&&(s=i.state),{menu:n}}if(n.length<=1&&e.RouteTargetState_NLS)return"  "+e.RouteTargetState_NLS}}(e,o,i),isCellEditable:e=>function(e){if(e.nodeModel&&"string"==typeof e.nodeModel.options.grid.TargetMaturityMenu)return!1}(e),getCellTypeRepresentation:e=>function(e){return!e.nodeModel||null!=e.nodeModel.options.grid.TargetMaturityMenu&&null!=e.nodeModel.options.grid.TargetMaturityMenu.menu&&1!=e.nodeModel.options.grid.TargetMaturityMenu.menu.length&&0!=e.nodeModel.options.grid.TargetMaturityMenu.menu.length?"functionMenu":"string"}(e),compareTargetMaturityStates:(e,t)=>function(e,t){let o,i;return o=e.menu?l(e.menu):e.trim(),i=t.menu?l(t.menu):t.trim(),o.localeCompare(i)}(e,t),showTooltip:e=>function(e){if(e.nodeModel&&e.nodeModel.options.grid.RouteTargetState_NLS)return{shortHelp:e.nodeModel.options.grid.RouteTargetState_NLS,updateModel:!1}}(e),getRouteContentTargetMaturityMenu:(e,t,o,i)=>s(e,t,o,i),getInitiateRouteContentTargetMaturityMenu:e=>n(e),getTargetMaturityContextualMenu:(e,o,i,n)=>function(e,o,i,n){if(d(e,n))return[];if(null!=n&&"Complete"==n.state)return[];var s=[],r=a(e,o,"contextualMenu",i,n);return r.length<=1&&(r=[{type:"CheckItem",title:e.RouteTargetState_NLS,state:"disabled|selected",action:{callback:function(){}}}]),e.maturityTargetStates&&r.length>0&&s.push({name:t.targetMaturity,title:t.targetMaturity,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-target"},data:null,submenu:r}),s}(e,o,i,n)}})),define("DS/ENORouteMgmt/Utilities/RouteWidgetPersistency",["DS/ENORouteMgmt/Views/Form/TaskProperties"],(function(e){"use strict";let t={RouteSummaryPage:"GridView",TemplateSummaryPage:"GridView",RouteContentsPage:"GridView",RouteTasksPage:"GraphView",RouteMembersPage:"TileView"},o=function(e,o){let i="";switch(e){case"RouteSummaryPage":i=widget.getValue("RouteSummary-ShowView");break;case"TemplateSummaryPage":i=widget.getValue("TemplateSummary-ShowView");break;case"RouteTasksPage":i=widget.getValue("TasksTab-ShowView");break;case"RouteContentsPage":i=widget.getValue("ContentsTab-ShowView");break;case"RouteMembersPage":i=widget.getValue("MembersTab-ShowView")}if(void 0!==i&&""!==i||(i=function(e){let o="";for(var i of Object.keys(t))e===i&&(o=t[i]);return""===o&&(o="GridView"),o}(e)),i)return i===o?"selected":"unselected"};return{getViewPersistency:(e,t)=>o(e,t),getTabPersistency:e=>function(e){let t="";return 1!=widget.data.openTaskProperties&&null==widget.getValue("taskIdTobePersisted")&&null==widget.data.taskId||(widget.setValue("RouteTabs-ShowView",0),widget.setValue("TemplateTabs-ShowView",0)),t="RouteTabsPage"===e?widget.getValue("RouteTabs-ShowView"):widget.getValue("TemplateTabs-ShowView"),void 0!==t&&""!==t||(t=0),t}(e),getTaskTabPersistency:t=>function(t){let o="";"RouteTaskTabsPage"===t&&(o=widget.getValue("RouteTaskTabs-ShowView")),"ENOTASK_AP"==widget.getValue("appId")&&(o={detailsTab:0,membersTab:1,commentsTab:2,historyTab:3}[e.getTaskVaribles().collabTaskInfo.options.selectedTab]);return void 0!==o&&""!==o||(o=0),o}(t)}})),define("DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils",["DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";let i=function(e,i,n,a){require(["DS/ENORouteMgmt/Model/RouteContentModel","DS/ENORouteMgmt/Controller/RouteServicesController"],(function(e,r){let l=e.getModel().getSelectedNodes()[0].options.grid;if(l.id&&""!=l.id){l.RouteBaseState=i,l.RouteBaseState_NLS=n;var d=l.maturityTargetStates;if(null!=d)for(let e=0;e<d.length;e++){var u=d[e];if(u.split("~").length>3&&u.split("~")[0]==l.RouteBaseState)for(let e=0;e<u.split("~")[1].split(",").length;e++)if("TRUE"==u.split("~")[2].split(",")[e]){u.split("~")[1].split(",").length>1?(l.RouteTargetState=u.split("~")[1].split(",")[e],l.RouteTargetState_NLS=u.split("~")[3].split(",")[e]):(l.RouteTargetState=u.split("~")[1],l.RouteTargetState_NLS=u.split("~")[3]);break}}"Ad Hoc"==l.RouteBaseState&&(l.RouteTargetState="");let c=e.getModel().RouteId;r.updateRouteContentStateBlocking(l,c).then((function(i){if(i.success){var n=[];let d=e.getModel().getSelectedNodes()[0];l.BlockingMaturityMenu={},l.BlockingMaturityMenu.menu=s(l,"",e.getModel().routeModel.state,e.getModel().routeModel),l.TargetMaturityMenu={},l.TargetMaturityMenu.menu=t.getRouteContentTargetMaturityMenu(l,a,e.getModel().routeModel.state,e.getModel().routeModel),0==l.TargetMaturityMenu.menu.length?l.TargetMaturityMenu=o.None:1==l.TargetMaturityMenu.menu.length&&(l.TargetMaturityMenu=l.RouteTargetState_NLS),l.RouteTargetState=i.data[0].dataelements.RouteTargetState,l.RouteTargetState_NLS=i.data[0].dataelements.RouteTargetState_NLS,d.updateOptions({grid:l}),d.options.getAttributeValueForFiltering=function(e){switch(e){case"label":return l.Title;case"Name":return l.Name;case"TypeDisplay":return l.Type;case"Revision":return l.Revision;case"Maturity":return l.Maturity;case"BlockingMaturityMenu":return l.RouteBaseState_NLS;case"TargetMaturityMenu":return l.RouteTargetState_NLS;case"Owner":return l.Owner;case"Relation":return l.RelationValue;case"relatedToTaskTitles":return l.relatedToTaskTitles;default:return l[e]}},widget.notify.handler().addNotif({level:"success",subtitle:o.successStateBlockingUpdated,sticky:!0});var r={id:d.options.grid.id};n.push(r),widget.routeMgmtMediator.publish("route-content-updated",n)}})).catch((function(e){null!=e.internalError&&e.internalError.indexOf("#1600300")>=0&&e.internalError.indexOf(" Invalid object id")>0?widget.notify.handler().addNotif({level:"error",subtitle:o.ErrorInvalidObject,sticky:!0}):widget.notify.handler().addNotif({level:"error",subtitle:o.failedStateBlockingUpdated,sticky:!0})}))}}))},n=function(e,t){if(t&&!d(t))return!0;if(t&&""!==t.state&&"In Process"==t.state){var o=e.maturityBlockingStates,i=e.current,n=!0;if(o&&o.length>0)for(var s=0;s<o.length-1;s++){i==(a=o[s].split("~"))[3]&&("TRUE"!=a[2]&&"True"!=a[2]||(n=!1))}return n}o=e.maturityBlockingStates,n=!0,i=e.current;if(o&&o.length>0)for(s=0;s<o.length-1;s++){var a;if("TRUE"!=(a=o[s].split("~"))[2]&&"True"!=a[2]||(n=!1),t&&""!==t.state&&i==a[3]&&("FALSE"==a[2]||"false"==a[2])){n=!0;break}}return n},s=function(e,t,s,a){if(n(e,a))return[];var r=[{type:"CheckItem",title:o.None,state:"Ad Hoc"==e.RouteBaseState?"selected":"unselected",action:{callback:function(){"Ad Hoc"!=e.RouteBaseState&&i(0,"Ad Hoc",o.None,t)}}}],l=e.maturityBlockingStates,d=e.RouteBaseState,u=e.current,c=!1,p="unselected";return l.forEach((function(o){var n=o.split("~");c=!!c||u==n[3],p="selected"==p?"unselected":d==n[1]?"selected":"unselected",s&&"In Process"==s&&c&&u!==n[3]&&(c=!1);var a={type:"CheckItem",title:n[3],title_actual:n[1],state:c&&"TRUE"==n[2]?"enabled|"+p:"disabled|"+p,action:{callback:function(){e.RouteBaseState!=n[1]&&i(0,n[1],n[3],t)}}};r.push(a)})),r.pop(),r},a=function(e,i,n,s){require(["DS/ENORouteMgmt/Model/InitiateRouteContentModel"],(function(s){if(e.id&&""!=e.id){e.RouteBaseState=i,e.RouteBaseState_NLS=n;var a=e.maturityTargetStates;if(null!=a)for(let t=0;t<a.length;t++){var l=a[t];if(l.split("~").length>3&&l.split("~")[0]==e.RouteBaseState)for(let t=0;t<l.split("~")[1].split(",").length;t++)if("TRUE"==l.split("~")[2].split(",")[t]){l.split("~")[1].split(",").length>1?(e.RouteTargetState=l.split("~")[1].split(",")[t],e.RouteTargetState_NLS=l.split("~")[3].split(",")[t]):(e.RouteTargetState=l.split("~")[1],e.RouteTargetState_NLS=l.split("~")[3]);break}}e.BlockingMaturityMenu={},e.BlockingMaturityMenu.menu=r(e),e.TargetMaturityMenu={},e.TargetMaturityMenu.menu=t.getInitiateRouteContentTargetMaturityMenu(e);var d=s.getRowModelById(e.id);0==e.TargetMaturityMenu.menu.length?(e.TargetMaturityMenu=" "+o.None,e.RouteTargetState=""):e.TargetMaturityMenu.menu.length>0&&1==e.TargetMaturityMenu.menu.length&&(e.TargetMaturityMenu.menu=[],e.TargetMaturityMenu=" "+e.RouteTargetState_NLS),d.updateOptions({grid:e})}}))},r=function(e,t){var i=[{type:"CheckItem",title:o.None,state:"Ad Hoc"==e.RouteBaseState?"selected":"unselected",action:{callback:function(){a(e,"Ad Hoc",o.None)}}}],n=e.maturityBlockingStates,s=e.RouteBaseState,r=e.current,l=!1,d="unselected";return n.forEach((function(t){var o=t.split("~");l=!!l||r==o[1],d="selected"==d?"unselected":s==o[1]?"selected":"unselected";var n={type:"CheckItem",title:o[3],title_actual:o[1],state:l&&"TRUE"==o[2]?"enabled|"+d:"disabled|"+d,action:{callback:function(){a(e,o[1],o[3])}}};i.push(n)})),i.pop(),i},l=function(e,t,o,i,a){if(n(e,a))return[];return"InitiateRoute"==t?r(e,o):s(e,o,i,a)},d=function(t){if(t){if("Completed"==t.actualState)return!1;if(t.UserName==e.getLoginUser())return!0;if(t.Assignees){var o=!1;return t.Assignees.forEach((function(t){t.contains("Person~"+e.getLoginUser()+"~")&&(o=!0)})),o}return!1}},u=function(e){if(e&&e.length>0){return e.find((e=>"enabled|selected"==e.state||"selected"==e.state)).title}};return{getMaturityMenuForGrid:(e,t,o)=>function(e,t,o){if("RouteContent"===t&&!d(o)||n(e,o))return e.RouteBaseState_NLS?"  "+e.RouteBaseState_NLS:"";var i="";return o&&o.state&&(i=o.state),{menu:l(e,t,"Grid",i,o)}}(e,t,o),hideMaturityBlockCondition:(e,t)=>n(e,t),getBlockingMaturityContextualMenu:(e,t,i,s)=>function(e,t,i,s){if(n(e,s))return[];var a=[],r=l(e,t,"contextualMenu",i,s);return e.maturityBlockingStates&&r.length>0&&a.push({name:o.blockingMaturity,title:o.blockingMaturity,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-block"},data:null,submenu:r}),a}(e,t,i,s),isCellEditable:e=>function(e){return!!e.nodeModel&&!n(e.nodeModel.options.grid)}(e),isCellEditableOnCreatePage:e=>function(e){return!!e.nodeModel&&!n(e.nodeModel.options.grid)}(e),getCellTypeRepresentation:e=>function(e){return e.nodeModel&&(0==e.nodeModel.options.grid.isMaturityBlockingEditable||n(e.nodeModel.options.grid))?"string":"functionMenu"}(e),compareBlockingStates:(e,t)=>function(e,t){let o,i;return o=e.menu?u(e.menu):e.trim(),i=t.menu?u(t.menu):t.trim(),o.localeCompare(i)}(e,t),showTooltip:e=>function(e){if(e.nodeModel&&e.nodeModel.options.grid.RouteBaseState_NLS)return{shortHelp:e.nodeModel.options.grid.RouteBaseState_NLS,updateModel:!1}}(e)}})),define("DS/ENORouteMgmt/Utilities/RouteTaskPanelChangeUtils",["DS/ENORouteMgmt/Views/Form/TaskProperties"],(function(e){"use strict";let t,o;return t={updateTaskPanelFooter:t=>function(){let t=e.getTaskVaribles(),o=document.getElementById("RouteTaskPropertiesFooter");o&&(o.style.display="block","ENOTASK_AP"==widget.getValue("appId")&&(o.getChildren()[0].style.display="none",o.getChildren()[1].style.display="inline-flex",o.getChildren()[2].style.display="inline-flex",t.collabTaskModel.set("inboxTaskModified",!0)))}(),getTaskUpdateStatus:()=>o,setTaskUpdateStatus:e=>function(e){o=e}(e)},t})),define("DS/ENORouteMgmt/Components/Mediator",["DS/CoreEvents/ModelEvents","DS/ENORouteMgmt/Utilities/Constants"],(function(e,t){"use strict";var o=null,i=function(){o=new e};return i.prototype.publish=function(e,t){o.publish({event:e,data:t})},i.prototype.subscribe=function(e,t){return o.subscribe({event:e},t)},i.prototype.subscribeOnce=function(e,t){return o.subscribeOnce({event:e},t)},i.prototype.unsubscribe=function(e){o.unsubscribe(e)},i.prototype.getEventBroker=function(){return o},i.prototype.destroy=function(){o.destroy()},i.prototype.destroyAllButDialogEvents=function(){let e=t.DIALOG_EVENTS,o=widget.routeMgmtMediator.getEventBroker()._pubsub.topics;for(var i in o)if(o.hasOwnProperty(i)){let t=!0;for(let o in e)if(e.hasOwnProperty(o)&&e[o]===i.replaceAll("/","")){t=!1;break}let n=o[i];if(t)for(;n.length>0;){let e=n[0];e.token&&widget.routeMgmtMediator.unsubscribe(e.token)}}},i})),define("DS/ENORouteMgmt/Commands/RouteTaskApprovalProcess",["UWA/Core","DS/i3DXCompassPlatformServices/OpenWith","UWA/Class/Promise","DS/TransientWidget/TransientWidget","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s){"use strict";let a=function(e,o){return{id:s.approvalProcess,title:s.approvalProcess,icon:"route",type:"PushItem",multisel:!1,action:{callback:function(){!function(e,o){let s=r(e,o),a=(new t).set3DXContent(s);var l={X3DContentId:JSON.stringify({protocol:"3DXContent",source:a._content.source,data:a._content.data,inAppMode:!0,inAppOptions:{relationSet:"AutoModeProfile",localUID:widget.id}}),x3dPlatformId:n.getTenantValue()};i.showWidget("ENXROUT_AP","",l,{mode:"transient"})}(e,o)}}}},r=function(e,t){let o=[],i=d(e),n=e.taskTitleForSubRoute,s=e.taskIdForSubRoute;return"openSummaryPage"==t&&(i="Route"),"Inbox Task"==i?e.route.forEach((function(e){if(e.dataelements.approvalTaskId){let t=u(e,n,s);t.objectId=e.dataelements.approvalTaskId,o.push(t)}})):"hyperlink"==e.fromPage?e.route.forEach((function(e){e.dataelements.activityState.indexOf("Awaiting your")>-1&&o.push(u(e,n,s))})):e.route.forEach((function(e){o.push(u(e,n,s))})),l(i,o)},l=function(e,t){return{protocol:"3DXContent",version:"1.1",source:widget.getValue("appId")?widget.getValue("appId"):"ENXROUT_AP",widgetId:widget.id,data:{items:t,approvalObjectType:e}}},d=function(e){for(var t=[],o=0;o<e.route.length;o++)e.route[o].dataelements.approvalTaskId&&t.push(e.route[o].dataelements.id);return 1==t.length?"Inbox Task":"Route"},u=function(e,t,o){return{envId:n.getTenantValue()?n.getTenantValue():"OnPremise",serviceId:"3DSpace",contextId:n.getSecurityContextValue(),objectId:e.dataelements.id,objectType:"Route",contextTitle:t,contextId:o,displayName:e.dataelements.name,path:[{resourceid:e.dataelements.id,type:"Route"}]}};return{getOpenWithMenu:e=>a(e),getApprovalCommandMenu:(e,t)=>function(e,t){return a(e,t)}(e,t)}})),define("DS/ENORouteMgmt/Model/InitiateRouteTaskModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Model/Utils/TaskModelUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i){"use strict";let n,s=function(){n=new e,n.options._isTaskPanelOpened=!1};return{getModel:e=>function(e){return n.prepareUpdate(),o.prepareTreeDocumentModel(e,n),n.pushUpdate(),n}(e),getTaskNodeModel:(e,t)=>function(e,t){return o.getTaskNodeModel(n,e,t)}(e,t),getTaskTreeDocument:()=>n,destroy:e=>function(e){e?n=void 0:s()}(e),deleteTreeNodeModel:e=>function(e){return o.deleteTreeNodeModel(e,n).deletedGraphNodes}(e),getTasksDataForCreation:()=>o.getTasksDataForCreation(n),reOrderTreeNodeModels:(e,t)=>function(e,t){return o.reOrderTreeNodeModels(n,e,t)}(e,t),removeGraphNodesFromTree:e=>function(e){return o.removeGraphNodesFromTree(e)}(e),setTaskTreeDocument:e=>function(e){n=e}(e)}})),define("DS/ENORouteMgmt/Config/Toolbar/RouteSummaryToolbarConfig",["DS/ENORouteMgmt/Utilities/RouteWidgetPersistency","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){let i,n={menu:[{type:"CheckItem",title:o.tileView,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-small-tile"},action:{module:"DS/ENORouteMgmt/Views/ToggleViews",func:"doToggleView",argument:{view:"TileView",curPage:"RouteSummary"}},tooltip:o.tileView},{type:"CheckItem",title:o.gridView,state:"selected",fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-list"},action:{module:"DS/ENORouteMgmt/Views/ToggleViews",func:"doToggleView",argument:{view:"GridView",curPage:"RouteSummary"}},tooltip:o.gridView}]};let s=function(i){var s=function(e){var i={menu:[{type:"CheckItem",title:o.filterOwnedbyme,state:e.indexOf("owned")>-1?"selected":"unselected",id:"owned",action:{module:"DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",func:"changeOwnerFilter",argument:{type:"owner",filter:"owned"}},tooltip:o.filterOwnedbymeTooltip},{type:"CheckItem",title:o.filterAssignedtome,state:e.indexOf("assigned")>-1?"selected":"unselected",id:"assigned",action:{module:"DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",func:"changeOwnerFilter",argument:{type:"owner",filter:"assigned"}},tooltip:o.filterAssignedtomeTooltip},{type:"SeparatorItem",title:""}]},n=t.getStateNLS(),s={type:"CheckItem",state:e.indexOf("Define")>-1?"selected":"unselected",id:"draft",action:{module:"DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",func:"changeStateFilter",argument:{type:"state",filter:"draft"}},tooltip:o.filterDraftTooltip};n&&n.Define?s.title=n.Define:s.title=o.filterDraft,i.menu.push(s),s={type:"CheckItem",state:e.indexOf("In Process")>-1?"selected":"unselected",id:"todo",action:{module:"DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",func:"changeStateFilter",argument:{type:"state",filter:"todo"}},tooltip:o.filterTodoTooltip},n&&n.In_Process?s.title=n.In_Process:s.title=o.filterTodo,i.menu.push(s),s={type:"CheckItem",state:e.indexOf("Complete")>-1?"selected":"unselected",id:"completed",action:{module:"DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",func:"changeStateFilter",argument:{type:"state",filter:"completed"}},tooltip:o.filterCompletedTooltip},n&&n.Complete?s.title=n.Complete:s.title=o.filterCompleted;var a={type:"CheckItem",title:o.filterByObject,state:e.indexOf("filterbyobject")>-1?"selected":"unselected",id:"filterbyobject",action:{module:"DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",func:"renderObjectContextTitle",argument:{type:"filterbyobject",filter:"filterbyobject"}},tooltip:o.filterByObject};return i.menu.push(s),i.menu.push(a),i}(i),a=e.getViewPersistency("RouteSummaryPage","GridView"),r="selected"===a?"unselected":"selected";n.menu[1].state=a,n.menu[0].state=r;var l={entries:[{id:"filter",dataElements:{typeRepresentation:"filterdropdown",icon:{iconName:"list-filter",fontIconFamily:1},value:s},position:"far",action1:{module:"DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView",func:"launchFilter"},priority:1,category:"status",tooltip:o.filter,domId:"filterDropDownToolbar"},{id:"view",className:"routeViews",dataElements:{typeRepresentation:"viewdropdown",icon:{iconName:"selected"==a?"view-list":"view-small-tile",fontIconFamily:1},value:n},position:"far",tooltip:o.switchView,category:"action"},{id:"changeOwner",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"user-change",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{module:"DS/ENORouteMgmt/Views/Dialogs/RouteChangeOwnershipDialog",func:"routeChangeOwner"}},position:"far",category:"action",tooltip:o.changeOwner},{id:"deleteRoute",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"trash",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{module:"DS/ENORouteMgmt/Views/Dialogs/RemoveRoute",func:"removeConfirmation"}},position:"far",category:"action",tooltip:o.Delete},{id:"information",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"info",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{module:"DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",func:"openPropertiesView"}},position:"far",category:"action",tooltip:o.Information}],typeRepresentations:{sortingdropdown:{stdTemplate:"functionMenuIcon",semantics:{label:"action",icon:"sorting"}},filterdropdown:{stdTemplate:"functionMenuIcon",semantics:{label:"action",icon:"sorting"},position:"far",tooltip:{text:"Filter",position:"far"}},viewdropdown:{stdTemplate:"functionMenuIcon",semantics:{label:"action",icon:"sorting"},position:"far",tooltip:{text:"view",position:"far"}}}};return null!=widget.data.contextTitle&&""!=widget.data.contextTitle&&l.entries.unshift({id:"subRouteInfoToolBar",dataElements:{typeRepresentation:"string",value:widget.data.contextTitle,allowResetToUndefinedByUIFlag:!0,position:"far",category:"status",label:widget.data.contextTitle}},{id:"removeSubRoute",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"remove",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{module:"DS/ENORouteMgmt/Views/Dialogs/RemoveRoute",func:"removeSubRouteConfirmation"}},position:"far",category:"status",tooltip:o.remove,visibleFlag:!0}),JSON.stringify(l)};return i={writetoolbarDefination:e=>s(e),destroy:function(){_dataGrid.destroy(),_container.destroy()}},i})),define("DS/ENORouteMgmt/Views/Form/FormValidation",["DS/ENORouteMgmt/Views/Form/CustomFieldUtils","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";let i=function(t,i){return!e.isMandatoryField(t)||!(null==i||i.trim&&""==i.trim())||(widget.notify.handler().addNotif({level:"error",subtitle:o.mandatoryFieldRequired,sticky:!1}),!1)},n=function(t,i){let n=e.getMaxLength(t);if(0==n);else if(i.length>n){let e=o.replace(o.longerThanDefinedCharLengthError,{name:t.name,length:n});return widget.notify.handler().addNotif({level:"error",subtitle:e,sticky:!1}),!1}return!0},s=function(t,i){return!e.isMandatoryField(t)||!(null==i||i.trim&&""==i.trim()||i&&Array.isArray(i)&&0==i.length)||(widget.notify.handler().addNotif({level:"error",subtitle:o.mandatoryFieldRequired,sticky:!1}),!1)};return{validateCustomAttrInfo:(o,s)=>function(o,s){let a=t.getTaskCustomFields(),r=!0;if(a)for(let t=0;t<a.length;t++){let o=a[t];if("extensions"!=o.name&&s.elements[o.name])if(e.isMultiValueField(o)&&Array.isArray(s.elements[o.name])){for(let e=0;e<s.elements[o.name].length;e++){let t=s.elements[o.name][e].value;if(r=i(o,t),!r)break;if(r=n(o,t),!r)break}if(!r)break}else{let e=s.elements[o.name].value;if(r=i(o,e),!r)break;if(r=n(o,e),!r)break}}return r}(0,s),validateRouteCustomAttrInfo:(o,i,a)=>function(o,i,a){let r=t.getRouteCustomFields();"Template"==a&&(r=t.getRouteTemplateCustomFields());let l=!0;if(r)for(let t=0;t<r.length;t++){let o=r[t];if("extensions"!=o.name&&i[o.name])if(e.isMultiValueField(o)&&Array.isArray(i[o.name])){for(let e=0;e<i[o.name].length;e++){let t=i[o.name][e].value;if(l=s(o,t),!l)break;if(l=n(o,t),!l)break}if(!l)break}else{let e=i[o.name].value;if(l=s(o,e),!l){const e=i[o.name],t=document.querySelectorAll("#iRouteTabsContainer .wux-controls-tabBar-tabs .wux-controls-button")[0];t&&(t.click(),setTimeout((()=>{const t=document.querySelector("#iRouteTabsContainer .wux-ui-3ds-expand-right");t?(t.click(),e&&e.elements&&e.elements.inputField&&e.elements.inputField.focus()):e&&e.elements&&e.elements.inputField&&e.elements.inputField.focus()}),500))}if(!l)break;if(l=n(o,e),!l)break}}return l}(0,i,a)}})),define("DS/ENORouteMgmt/Views/Loader/ChangeTaskAssigneeChooser",["DS/Utilities/Dom","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/RouteTaskPanelChangeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s){"use strict";let a,r=function(e){var t;e&&(t=new o({label:e[0]["ds6w:label"],value:e[0].id,name:e[0]["ds6w:identifier"],type:e[0]["ds6w:type_value"]}),a.fields.taskAssigneeField.selectedItems=t)};return{launchAssigneeSearch:(e,o,n,s)=>function(e,o,n,s){var l=e.dsModel;a=n;var d=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],(function(e){var n=e.createSocket({socket_id:d}),a=["Person","User Group"],u="",c="";if(o.model&&"Route Template"==o.model.Type?(u=t.getRefinementToSnN(d,"searchAssignee",!1,a),c=t.getPrecondForTaskMemberSearch(o.model)):"TRUE"==s.options.grid.routeOwnerTask&&""!=s.options.grid.routeOwnerTask&&null!=s.options.grid.routeOwnerTask||"FALSE"==s.options.grid.routeOwnerTask&&null!=s.options.grid.routeOwnerUGChoice&&""!=s.options.grid.routeOwnerUGChoice?(a=["Person"],u=t.getRefinementToSnN(d,"searchAssignee",!1,a),c=t.getPrecondForRouteOwnerTaskAssignment(s)):"true"==o.model.RestrictUserGroup&&""!=s.options.grid.candidateAssignee&&null!=s.options.grid.candidateAssignee&&"Person"==s.options.grid.assigneeType?(u=t.getRefinementToSnN(d,"searchAssignee",!1,a),c=t.getPrecondForRouteOwnerTaskAssignment(s)):(u=t.getRefinementToSnN(d,"searchAssignee",!1,a),c=t.getPrecondForTaskMemberSearch(o.model)),"OnPremise"!=i.getTenantValue()&&(u.source=["3dspace","usersgroup"]),u.precond=c.precond,u.resourceid_in=c.resourceid_in,!UWA.is(n))throw new Error("Socket not initialized");n.dispatchEvent("RegisterContext",u),n.addListener("Selected_Objects_search",r.bind(l)),n.dispatchEvent("InContextSearch",u)}))}(e,o,n,s),populateAssigneeField:(e,t)=>function(e,t){a=e,r(t)}(e,t),getPrecondForChangeAssigneeSearch:(e,o)=>function(e,o){return e.model&&"Route Template"==e.model.Type?t.getPrecondForTaskMemberSearch(e.model):"TRUE"==o.options.grid.routeOwnerTask&&""!=o.options.grid.routeOwnerTask&&null!=o.options.grid.routeOwnerTask||"FALSE"==o.options.grid.routeOwnerTask&&null!=o.options.grid.routeOwnerUGChoice&&""!=o.options.grid.routeOwnerUGChoice||"true"==e.model.RestrictUserGroup&&""!=o.options.grid.candidateAssignee&&null!=o.options.grid.candidateAssignee&&"Person"==o.options.grid.assigneeType?t.getPrecondForRouteOwnerTaskAssignment(o):t.getPrecondForTaskMemberSearch(e.model)}(e,o),changeHandlerForChangeAssigneeSearch:e=>function(e){e.fields.taskAssigneeField.selectedItems&&e.fields.taskAssigneeField.selectedItems.options&&e.fields.taskAssigneeField._editor.elements.inputField.value==e.fields.taskAssigneeField.selectedItems.options.label&&(e.fields.assigneeId=e.fields.taskAssigneeField.selectedItems.options.value,"Person"==e.fields.taskAssigneeField.selectedItems.options.type?(e.fields.taskAssigneeUserName=e.fields.taskAssigneeField.selectedItems.options.name,e.fields.assigneeType=e.fields.taskAssigneeField.selectedItems.options.type):(e.fields.taskAssigneeUserName="",e.fields.assigneeType="Group"))}(e),changeHandlerForChangeMembersSearch:e=>function(e){n.updateTaskPanelFooter(),e.selectedItems&&e.selectedItems.options&&e._editor.elements.inputField.value==e.selectedItems.options.label&&(e.assigneeId=e.selectedItems.options.value,"Person"==e.selectedItems.options.type?(e.taskAssigneeUserName=e.selectedItems.options.name,e.assigneeType=e.selectedItems.options.type):(e.taskAssigneeUserName="",e.assigneeType="Group"))}(e)}})),define("DS/ENORouteMgmt/Utilities/RouteTaskResponseFormatter",["DS/ENORouteMgmt/Utilities/ParseJSONUtil"],(function(e){"use strict";let t;return t={getTaskReponse:t=>function(t){var o=JSON.parse(t);if(o.data.length>0){for(var i=o.data[0].relateddata.tasks,n=o.data[0].relateddata.contents,s=[],a=0;a<n.length;a++){var r=n[a],l={id:r.id,physicalid:r.id,type:r.type,relId:r.relId};Object.assign(r.dataelements,l),s.push(r.dataelements)}require(["DS/ENORouteMgmt/Model/ContentToReviewModel"],(function(e){e.destroy(),e.createModel(s)}));for(var d=[],u=0;u<i.length;u++){for(var c=i[u],p=c.relateddata.taskAttachments,m=[],g=[],f=0;f<p.length;f++){var h=p[f],w={id:h.id,physicalid:h.id,type:h.type,relId:h.relId};Object.assign(h.dataelements,w),m.push(h.dataelements)}var v=c.dataelements.ContentToReviewIds,S=[];if(""!=v&&null!=v)for(var k=0;k<s.length;k++)v.includes(s[k].physicalid)&&S.push(s[k]);var T=!1;if(null!=i[u].relateddata.subroutes){for(var R=i[u].relateddata.subroutes[0].relateddata.route,y=0;y<R.length;y++)g.push(R[y].dataelements);g.length>0&&(T=!0)}var b="";T&&(b=i[u].relateddata.subroutes[0].dataelements.TaskApprovalStatus);let e=[];for(let t=0;t<s.length;t++)(0==s[t].relatedToTaskIds.length||s[t].relatedToTaskIds.toString().includes(c.id))&&e.push(s[t]);var M={id:c.id,physicalid:c.id,type:c.type,relId:c.relId,taskAttachments:m,routeContents:e,taskSubRoutes:g,subRouteApprovalStatus:b,RouteTaskContentToReview:S};Object.assign(c.dataelements,M),d.push(c.dataelements)}return d}return(new e).parseResp(JSON.parse(t))}(t)},t})),define("DS/ENORouteMgmt/Services/RouteServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Utilities/RouteTaskResponseFormatter","DS/WAFData/WAFData"],(function(e,t,o,i,n,s){"use strict";let a,r,l,d,u,c,p,m,g,f,h,w,v,S,k,T,R,y,b,M;r=function(){return new t((function(e,t){let n=o.getRouteServiceBaseURL(),s=widget.getValue("routeStateFilter");s&&(n+=D(n)+"stateFilter="+s);let a=widget.getValue("ownershipFilter");a&&(n+=D(n)+"ownershipFilter="+a);let r=widget.getValue("objectLimit");r&&(n+=D(n)+"objectLimit="+r);let l={method:"GET",timeout:0,headers:{"Content-Type":"application/ds-json"},onComplete:function(t){e((new i).parseResp(JSON.parse(t)))},onFailure:function(e,o){t(o||e)}};o.authenticateRequest(n,l)}))};let D=function(e){return-1===e.indexOf("?")?"?":"&"};l=function(e,n){return new t((function(t,s){let a=o.getRouteServiceBaseURL()+"/"+e;"Route Template"===n&&(a=o.getRouteTemplateServiceBaseURL()+"/"+e);let r={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t((new i).parseResp(JSON.parse(e)))},onFailure:function(e,t){s(t||e)}};o.authenticateRequest(a,r)}))},v=function(e){return new t((function(t,i){null==e&&t(),o.getCSRFToken().then((function(o){e.csrf=JSON.parse(o).csrf,t()}))})).then((function(){return function(e){return new t((function(t,n){let s=o.getRouteServiceBaseURL()+"/ids?query=IncludeDataElements",a={method:"POST",headers:{"Content-Type":"application/ds-json"}};a.data=JSON.stringify(e),a.onComplete=function(e){t((new i).parseResp(JSON.parse(e)))},a.onFailure=function(e,t){t?(t="string"==typeof t?JSON.parse(t):t,n(t)):n(e)},o.authenticateRequest(s,a)}))}(e)}))},d=function(e){return new t((function(t,i){let n=o.getRouteServiceBaseURL()+"/"+e+"?$include=tasks,taskAttachments,contents,subroutes&$fields=all,!contents.maturityBlockingStates",s={method:"GET",timeout:0,headers:{"Content-Type":"application/ds-json"}};widget.data.routeCredentials&&(n=o.modifyURL(n,widget.data.routeCredentials)),s.onComplete=function(e){t(e)},s.onFailure=function(e,t){i(t||e)},o.authenticateRequest(n,s)}))},u=function(e){return new t((function(t,n){let s={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t((new i).parseResp(JSON.parse(e)))},onFailure:function(e,t){t?(t="string"==typeof t?JSON.parse(t):t,n(t)):n(e)}};o.authenticateRequest(e,s)}))},c=function(n,s){return new t((function(t,a){var r={};(r=e.extend(r,o.getSyncOptions(),!0)).method="PUT",r.type="json",r.timeout=0,r.headers={"Content-Type":"application/ds-json"},r.wait=!0,s||(s=(new i).createCSRFForRequest()),r.data=JSON.stringify(s),r.onComplete=function(e){t(e)},r.onFailure=function(e,t){a(t||e)},o.authenticateRequest(n,r)}))},p=function(n){return new t((function(t,s){var a=(new i).createDataWithIdForRequest(n),r={};(r=e.extend(r,o.getSyncOptions(),!0)).method="DELETE",r.type="json",r.timeout=0,r.headers={"Content-Type":"application/ds-json"},r.wait=!0,r.data=JSON.stringify(a),r.onComplete=function(e){t(e)},r.onFailure=function(e,t){s(t||e)},o.authenticateRequest(o.getRouteServiceBaseURL(),r)}))},m=function(e){return new t((function(t,i){let s=o.getRouteServiceBaseURL()+"/"+e+"?$include=tasks,taskAttachments,contents,subroutes&$fields=all,!contents.maturityBlockingStates",a={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t(n.getTaskReponse(e))},onFailure:function(e,t){i(t||e)}};o.authenticateRequest(s,a)}))},g=function(e){return new t((function(t,i){let n=o.getRouteServiceBaseURL()+"/"+e+"?$include=contents,attachments",s={method:"GET",timeout:0,headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t(e)},onFailure:function(e){i(e)}};o.authenticateRequest(n,s)}))},k=function(e){return new t((function(t,i){let n=o.getRouteServiceBaseURL()+"/"+e+"/contents?include=none&$fields=none",s={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){let o=JSON.parse(e);t(o)},onFailure:function(e){i(e)}};o.authenticateRequest(n,s)}))},y=function(e){return new t((function(t,i){let n=o.get3DSpaceURL()+"/resources/enong/dico/gettypeshierarchy",s={method:"POST",headers:{"Content-Type":"application/ds-json"}},a={types:[e.options.grid.Type]};s.data=JSON.stringify(a),s.onComplete=function(e){let o=JSON.parse(e);t(o)},s.onFailure=function(e){i(e)},o.authenticateRequest(n,s)}))},f=function(e){return new t((function(t,n){let s=o.getRouteServiceBaseURL()+"/"+e+"/members",a={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t((new i).parseResp(JSON.parse(e)))},onFailure:function(e){n(e)}};o.authenticateRequest(s,a)}))},h=function(e){return new t((function(t,n){let s=o.getRouteServiceBaseURL()+"/"+e+"/history",a={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t((new i).parseResp(JSON.parse(e)))},onFailure:function(e){n(e)}};o.authenticateRequest(s,a)}))},w=function(e,t,i,n,s,a,r,l){var d="";null!=(l=l||null)&&null!=l.isfederated&&1==l.isfederated&&(d=o.getSearchUrl()+e);null!=l&&null!=l.acceptType&&""!=l.acceptType&&l.acceptType;null!=l&&null!=l.encodeSecurityContext&&""!=l.encodeSecurityContext&&l.encodeSecurityContext;var u=(new Date).getTime(),c=o.getTenantValue();d=-1==d.indexOf("?")?d+"?tenant="+c+"&timestamp="+u:d+"&tenant="+c+"&timestamp="+u,a=a||function(){},r=r||function(){};var p={};p.method=t,p.timeout=12e7,null!=l&&null!=l.isSwymUrl&&0!=l.isSwymUrl||(p.type="json"),i&&(p.auth={passport_target:i}),s&&(p.data=s),p.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":"en"},p.onComplete=function(e){a(e)},p.onFailure=function(e,t){console.log("Error in calling url: "+d),console.log("Error Detail: "+e),console.log("Error Data: "+JSON.stringify(t)),r(e,t)},p.onTimeout=function(){console.log("Timedout for url: "+d),widget.body&&Mask.unmask(widget.body)},o.authenticateRequest(d,p)},S=function(e){return new t((function(t,i){null==e&&t(),o.getCSRFToken().then((function(o){e.csrf=JSON.parse(o).csrf,t()}))})).then((function(){return C(e)}))};const C=function(e){return new t((function(t,i){null!=e&&null!=e.data&&0!=e.data.length||t();let n=o.getRouteServiceBaseURL()+"/contentsApprovalStatus",s={method:"POST",headers:{"Content-Type":"application/json"}};s.data=JSON.stringify(e),s.onComplete=function(e){let o=JSON.parse(e);t(o)},s.onFailure=function(e,t,o){i()},o.authenticateRequest(n,s)}))};T=function(e,n,s){var a=(new i).createRemoveSubRouteForRequest(e,n,s);return new t((function(e,t){let n=o.getRouteServiceBaseURL()+"/contextobjectremove",s={method:"PUT",headers:{"Content-Type":"application/json"}};s.data=JSON.stringify(a),s.onComplete=function(t){e((new i).parseResp(JSON.parse(t)))},s.onFailure=function(e,o){o?(o="string"==typeof o?JSON.parse(o):o,t(o)):t(e)},o.authenticateRequest(n,s)}))};return R=function(e){return new t((function(t,n){let s=o.getRouteServiceBaseURL()+"/typeName?policy="+e,a={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t((new i).parseResp(JSON.parse(e)))},onFailure:function(e,t){n(t||e)}};o.authenticateRequest(s,a)}))},b=function(){return new t((function(e,t){let i=o.getRouteServiceBaseURL()+"?$definition=nodata",n={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(t){let o=JSON.parse(t).definitions.filter((function(e){return"bps.routeFields"==e.name})),i=o.length>0&&o[0].items.filter((function(e){return"bps.publicroute-fields"==e.name})),n=(i.length>0&&i[0].items).filter((function(e){return"route-custom-fields"==e.name}));e(n[0].items)},onFailure:function(e){t(e)}};o.authenticateRequest(i,n)}))},M=function(){return new t((function(e,t){let i=o.getRouteTemplateServiceBaseURL()+"?$definition=nodata",n={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(t){let o=JSON.parse(t).definitions.filter((function(e){return"bps.routeTemplateFields"==e.name})),i=o.length>0&&o[0].items.filter((function(e){return"bps.publicRouteTemplate-fields"==e.name})),n=(i.length>0&&i[0].items).filter((function(e){return"route-template-custom-fields"==e.name}));e(n[0].items)},onFailure:function(e){t(e)}};o.authenticateRequest(i,n)}))},a={fetchAllRoutes:()=>r(),fetchRouteById:(e,t)=>l(e,t),fetchRouteByIds:e=>v(e),fetchRouteAndTaskByRouteId:e=>d(e),stopRouteCheck:e=>u(e),updateState:(e,t)=>c(e,t),deleteRoute:e=>p(e),fetchRouteTasks:e=>m(e),fetchRouteContents:e=>g(e),getObjectTaxonomies:e=>y(e),fetchRouteContentIds:e=>k(e),fetchRouteMembers:e=>f(e),fetchRouteHistory:e=>h(e),saveAsTemplate:(e,n)=>function(e,n){return new t((function(t,s){let a={};const r="ctx::"+e.data[0].dataelements.ctx;a.method="POST",a.headers={"Content-Type":"application/ds-json"},a.data=JSON.stringify(e),a.onComplete=function(e){let o=(new i).parseResp(JSON.parse(e));t(o)},a.onFailure=function(e,t,o){s(JSON.parse(t))},o.authenticateRequest(n,a,r)}))}(e,n),getESignConfigSetting:()=>new t((function(e,t){let i=o.get3DSpaceURL()+"/resources/bps/requiresESign",n={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(t){e(JSON.parse(t))},onFailure:function(e){t(JSON.parse(e))}};o.authenticateRequest(i,n)})),fetchApprovalStatusForContent:e=>S(e),makeWSCall:(e,t,o,i,n,s,a,r)=>w(e,t,o,0,n,s,a,r),removeSubRoute:(e,t,o)=>T(e,t,o),fetchCredentials:e=>function(e){return new t((function(t,i){var n=o.getLoginUser();widget.setValue("currentDialog",e);let s,a=o.get3DSpaceURL()+"/resources/vplmte/getcreatectx?usr="+n+"&policy=Route",r=o.get3DSpaceURL()+"/resources/vplmte/getcreatectx?usr="+n+"&policy=Route Template";s="newTemplateDialog"===e?r:a;let l={method:"GET",headers:{"Content-Type":"application/ds-json",SecurityContext:o.getSecurityContextValue()},onComplete:function(e){let o=JSON.parse(e);widget.setValue("credentialResponseData",o),t(o)},onFailure:function(e){let t=JSON.parse(e);i(t)}};o.authenticateRequest(s,l)}))}(e),getTypeFromPolicy:e=>R(e),fetchRouteCustomFields:()=>b(),fetchRouteTemplateCustomFields:()=>M()},a})),define("DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete",["DS/WUXAutoComplete/AutoComplete","DS/ENORouteMgmt/Services/RouteServices","DS/ENORouteMgmt/EnoviaBootstrap","DS/TreeModel/TreeNodeModel","DS/TreeModel/TreeDocument","DS/TreeModel/BaseFilter","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a){var r,l;let d=function(e,i,n,s,a){var r="",l=[],d=[];e.precond&&(r=e.precond),e.resourceid_in&&(l=e.resourceid_in),e.resourceid_not_in&&(d=e.resourceid_not_in);var u;u="([ds6w:label]:(*"+i+"*) OR [ds6w:identifier]:(*"+i+"*)) AND ("+r+")";var c,p=o.getTenantValue(),m=((c={})["3dspace"]={SecurityContext:o.getSecurityContextValue()},c),g={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:identifier","ds6wg:fullname","ds6w:status"],select_file:["icon","thumbnail_2d"],query:u,order_by:"asc",order_field:"ds6w:label",nresults:1e3,start:"0",source:a,tenant:p,resourceid_in:l,resourceid_not_in:d,with_synthesis:!1,with_synthesis_attribute:!1};widget&&widget.data&&widget.data.routeCredentials&&widget.data.routeCredentials.noSecurityContextForSearch||widget&&widget.data&&widget.data.noSecurityContextForSearch||(g.login=m),g=JSON.stringify(g);var f={isfederated:!0};t.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",g,n,s,f)};return ENORouteAutoComplete={drawAutoCompleteComponent:t=>function(t){r=new n;var o=new e({elementsTree:function(e){if(!t.getValidation||t.getValidation())return new Promise((function(o,a){var u=function(e){r=new n,l=s.inherit({isDataFiltered:function(e){var t=e.getAttributeValue("name"),o=e.getAttributeValue("label");if(t&&o&&this.filterModel&&this.filterModel.text){var i=this.filterModel.text.toLowerCase();return!(t.toLowerCase().indexOf(i)>-1||o.toLowerCase().indexOf(i)>-1)}return!!(o&&this.filterModel&&this.filterModel.text)&&(i=this.filterModel.text.toLowerCase(),!(o.toLowerCase().indexOf(i)>-1))},isEmpty:function(){return void 0===this.filterModel.text}}),r.getFilterManager().registerFilter("myFilterID",l),e&&e.results&&Array.isArray(e.results)&&e.results.forEach((function(e){var t=new i;e.attributes.forEach((function(e){"ds6w:type"===e.name&&(t.options.type=e.value),"resourceid"===e.name&&(t.options.value=e.value),"ds6w:label"===e.name&&(t.options.label=e.value),"ds6w:identifier"===e.name&&(t.options.name=e.value,t.options.grid={name:t.options.name}),"ds6w:status"===e.name&&(t.options.status=e.value)})),r.addRoot(t)})),o(r)},c=function(e){a(e)},p=["3dspace"];t.source&&(p=t.source);var m=t.getPrecond();m instanceof Promise?m.then((t=>{d(t,e,u,c,p)}),(e=>{e.error&&widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1})})):d(m,e,u,c,p)}))},filterCB:function(e){r.setFilterModel({value:{filterId:"myFilterID",filterModel:{text:e}}})},multiSearchMode:t.isMultiSearchMode,placeholder:t.placeHolderValue,minLengthBeforeSearch:t.minLengthToType,allowFreeInputFlag:t.isFreeInputAllowed,keepSearchResultsFlag:t.toKeepSearchResultsFlag});return o.addEventListener("change",(function(e){t.getChangeHandler&&t.getChangeHandler()})),o.getContent().querySelector(".wux-ui-state-undefined").addEventListener("keyup",(function(e,t){13===e.keyCode&&e.stopPropagation()})),o}(t)},ENORouteAutoComplete})),define("DS/ENORouteMgmt/Components/TagNavigator",["TagNavigatorProxy/TagNavigatorProxy","DS/ENORouteMgmt/Services/RouteServices","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n){"use strict";var s,a,r,l=!0;let d=function(e){null==e&&(e=[]),s.setTags(null,e)},u=function(){var e={};return e["3dspace"]={SecurityContext:o.getSecurityContextValue()},e},c=function(e){var t=i.getStateNLS();if(null!=e)for(var o=0;o<e.length;o++)"ds6w:what/ds6w:status"==e[o].sixw&&("Route.Define"==e[o].object?t&&t.Define&&(e[o].dispValue=t.Define):"Route.In Process"==e[o].object?t&&t.In_Process&&(e[o].dispValue=t.In_Process):"Route.Complete"==e[o].object&&t&&t.Complete&&(e[o].dispValue=t.Complete))},p=function(e){var t=i.getStateTemplateNLS();if(null!=e)for(var o=0;o<e.length;o++)"ds6w:what/ds6w:status"==e[o].sixw&&("Route Template.Active"==e[o].object?t&&t.Active&&(e[o].dispValue=t.Active):"Route Template.Inactive"==e[o].object?t&&t.Inactive&&(e[o].dispValue=t.Inactive):"Route Template.Archive"==e[o].object&&t&&t.Inactive&&(e[o].dispValue=t.Archive))};return{setTaggerProxy:t=>function(t){var o={widgetId:widget.id,filteringMode:"FilteringOnServer"};return s&&r!=t&&(s.die(),s=e.createProxy(o)),r=t,l&&(s=e.createProxy(o),widget.addEvent("onSearch",(function(e){a=e,"Route"==r?widget.routeMgmtMediator.publish("route-search-within-data",e):widget.routeMgmtMediator.publish("template-search-within-data",e)})),widget.addEvent("onResetSearch",(function(){a=void 0,"Route"==r?widget.routeMgmtMediator.publish("route-reset-search-within-data"):widget.routeMgmtMediator.publish("template-reset-search-within-data")})),l=!1),s}(t),getTaggerVariable:()=>s,getSearchWithInTypedValue:()=>a,setTagsForSummaryPage:e=>d(e),getSearchResult:(e,i)=>{return n=e,s=i,new Promise((function(e,i){var l;null==n&&(n=[]),null==s&&(s=[]),l="Route"==r?'flattenedtaxonomies:"types/Route"':'flattenedtaxonomies:"types/Route Template"';var m="";m=a?"("+a+" AND "+l+")":l;var g=o.getTenantValue(),f=u(),h={refine:n,with_indexing_date:!0,with_nls:!0,with_synthesis_attribute:!1,label:"yus-1515078503005",locale:null!=widget&&null!=widget.lang?widget.lang:"en",select_predicate:[],select_file:["icon","thumbnail_2d"],query:m,order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:["3dspace"],tenant:g,resourceid_in:s};widget&&widget.data&&widget.data.routeCredentials&&widget.data.routeCredentials.noSecurityContextForSearch||widget&&widget.data&&widget.data.noSecurityContextForSearch||(h.login=f),h=JSON.stringify(h);var w={isfederated:!0};t.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",h,(function(t){var o=t.facets;"Route"==r?c(o):p(o),d(o),e(t)}),(function(e){i(e)}),w)}));var n,s}}})),define("DS/ENORouteMgmt/Views/Form/RouteTaskCommentsView",["DS/ENORouteMgmt/Views/Form/TaskProperties","DS/ENORouteMgmt/EnoviaBootstrap","DS/SocialToolbar/SocialToolbar"],(function(e,t,o){let i=e.getTaskVaribles();return{renderComments:function(e){this.elements=e;let n=i._taskGraphModel.options.grid.id,s=t.getSwymUrl();var a={protocol:"3DXContent",version:"",source:"",widgetId:"",data:{items:[{envId:t.getTenantValue(),serviceId:"3DSpace",objectId:n,objectType:i._taskGraphModel.options.grid.type,facet:"isSocial"}]}};let r="/#app:ENOLCMT_AP/content:X3DContentId="+encodeURIComponent(JSON.stringify(a));this.comments=new o({subjectURI:"pid:"+n,enableShare:!1,enableComment:!0,enableLike:!0,tenantId:t.getTenantValue(),commentProxyToken:{header:"X-DS-CSRFTOKEN"},serviceURL:t.get3DSpaceURL()+"/resources","3DSwymUrl":s,commentsNumberAtInit:8,enableUpload:!1,appForcedLinkUri:r}),this.comments.inject(this.elements.container)}}})),define("DS/ENORouteMgmt/Views/Loader/RouteTasksCommentsLoader",["DS/ENORouteMgmt/Views/Form/RouteTaskCommentsView"],(function(e){"use strict";let t={};return{init:function(e){this.showView()||(!function(){t.container=new UWA.Element("div",{html:"",id:"RouteTaskCommenntsTabBody",class:"route-initiate-task-comments-tab"}),t.container.inject(document.querySelector("#RouteTaskRightPanelContainer"));let e=document.querySelector("#RouteTaskRightPanelContainer"),o=document.querySelector("#RouteTaskPropertiesFooter");e.insertBefore(t.container,o)}(),this.render())},render:function(){this.elements=t,e.renderComments(t)},hideView:function(){document.querySelector("#RouteTaskCommenntsTabBody")&&document.querySelector("#RouteTaskCommenntsTabBody").getChildren().length>0&&(document.getElementById("RouteTaskCommenntsTabBody").style.display="none")},showView:function(){return!!(document.querySelector("#RouteTaskCommenntsTabBody")&&document.querySelector("#RouteTaskCommenntsTabBody").getChildren().length>0)&&(document.getElementById("RouteTaskCommenntsTabBody").style.display="block",!0)},destroy:function(){t={}}}})),define("DS/ENORouteMgmt/Views/Form/RouteTaskHistoryView",["DS/ENORouteMgmt/Views/Form/TaskProperties","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENXHistoryUX/View/HistoryFacet"],(function(e,t,o){let i=e.getTaskVaribles();return{renderHistory:function(e){this.elements=e;let n=i._taskGraphModel.options.grid.id;this.HistoryPanel=o.init({id:[n],facetLang:widget.lang,securityContext:t.getSecurityContextValue()},this.elements.container)}}})),define("DS/ENORouteMgmt/Views/Loader/RouteTasksHistoryLoader",["DS/ENORouteMgmt/Views/Form/RouteTaskHistoryView"],(function(e){"use strict";let t={};return{init:function(e){this.showView()||(!function(){t.container=new UWA.Element("div",{html:"",id:"RouteTaskHistoryTabBody",class:"route-initiate-task-history-tab"}),t.container.inject(document.querySelector("#RouteTaskRightPanelContainer"));let e=document.querySelector("#RouteTaskRightPanelContainer"),o=document.querySelector("#RouteTaskPropertiesFooter");e.insertBefore(t.container,o)}(),this.render())},render:function(){this.elements=t,e.renderHistory(t)},hideView:function(){document.querySelector("#RouteTaskHistoryTabBody")&&document.querySelector("#RouteTaskHistoryTabBody").getChildren().length>0&&(document.getElementById("RouteTaskHistoryTabBody").style.display="none")},showView:function(){return!!(document.querySelector("#RouteTaskHistoryTabBody")&&document.querySelector("#RouteTaskHistoryTabBody").getChildren().length>0)&&(document.getElementById("RouteTaskHistoryTabBody").style.display="block",!0)},destroy:function(){t={}}}})),define("DS/ENORouteMgmt/Config/RemoveContentGridViewConfig",["DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils","DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";return[{text:o.title,dataIndex:"tree",editableFlag:!1},{text:o.type,dataIndex:"TypeDisplay",editableFlag:!1},{text:o.revision,dataIndex:"Revision",editableFlag:!1},{text:o.IDcardMaturityState,dataIndex:"Maturity",editableFlag:!1},{text:o.relationType,dataIndex:"Relation",editableFlag:!1},{text:o.accessCheck,dataIndex:"Deleteicon",typeRepresentation:"user",editableFlag:!1}]})),define("DS/ENORouteMgmt/Services/RouteESignServices",["UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/WAFData/WAFData"],(function(e,t,o){"use strict";let i,n;return n=function(i,n){return new e((function(e,s){let a=t.get3DSpaceURL()+"/resources/v1/modeler/ESignRecord?ESignObjectRef="+i+"&ESignObjectServiceID="+n,r={method:"GET",timeout:0,headers:{"Content-Type":"application/ds-json"},onComplete:function(t){e(t)},onFailure:function(e,t){s(t||e)}};o.authenticatedRequest(a,r)}))},i={fetchESignDetails:(e,t)=>n(e,t)},i})),define("DS/ENORouteMgmt/Controller/RouteESignServicesController",["DS/ENORouteMgmt/Services/RouteESignServices","UWA/Promise"],(function(e,t){"use strict";let o;return o={fetchESignDetails:(o,i)=>new t((function(t,n){e.fetchESignDetails(o,i).then((e=>{t(e)}),(e=>{n(e)}))}))},o})),define("DS/ENORouteMgmt/Config/Toolbar/RouteContentsTabToolbarConfig",["DS/ENORouteMgmt/Utilities/RouteWidgetPersistency","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){let o,i={menu:[{type:"CheckItem",title:t.tileView,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-small-tile"},action:{module:"DS/ENORouteMgmt/Views/ToggleViews",func:"doToggleView",argument:{view:"TileView",curPage:"ContentsTab"}},tooltip:t.tileView},{type:"CheckItem",title:t.gridView,state:"selected",fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-list"},action:{module:"DS/ENORouteMgmt/Views/ToggleViews",func:"doToggleView",argument:{view:"GridView",curPage:"ContentsTab"}},tooltip:t.gridView}]};return o={writetoolbarDefination:o=>function(o){var n=o.routeModel.Actions.indexOf("add.contents")>=0,s=o.routeModel.actualState;let a={},r=[],l=e.getViewPersistency("RouteContentsPage","GridView"),d="selected"===l?"unselected":"selected";return i.menu[1].state=l,i.menu[0].state=d,"Complete"!=s&&n&&r.push({id:"createContent",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"plus",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{module:"DS/ENORouteMgmt/Actions/ContentActions",func:"onSearchClick"}},position:"far",category:"create",tooltip:t.addExistingContent}),r.push({id:"view",className:"contentViews",dataElements:{typeRepresentation:"sortingdropdown",icon:{iconName:"selected"==l?"view-list":"view-small-tile",fontIconFamily:1},value:i},position:"far",tooltip:t.switchView,category:"action"}),"Complete"!=s&&r.push({id:"removeContent",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"remove",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{module:"DS/ENORouteMgmt/Views/Dialogs/RemoveContent",func:"removeConfirmation"}},position:"far",category:"action",tooltip:t.deleteContent}),a.entries=r,JSON.stringify(a)}(o),destroy:function(){_dataGrid.destroy(),_container.destroy()}},o})),define("DS/ENORouteMgmt/Views/Loader/InitiateSaveAsTemplateLinkTemplateChooser",["DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/TreeModel/TreeNodeModel","DS/Controls/TooltipModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i){"use strict";let n,s=!1;var a=function(e,o){var i;o&&(i=new t({label:o[0]["ds6w:label"],value:o[0].id,status:o[0]["ds6w:status_value"],category:o[0]["ds6w:category"]}),n.fields.linkedTemplateField.selectedItems=i)};return{init:(t,o,i)=>function(t,o,i){n=o;var s,r=t.dsModel,l=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],(function(t){var o=t.createSocket({socket_id:l});s=null!=i&&""!=i&&"Revise Template"==n.fields.buttonGroupSA.value[0]?i.saveAsLtSearchRestictIds:"";var d=e.getRefinementToSnN(l,"linkTemplate",!1,["Route Template"]),u=e.getPrecondForLinkTemplateSaveAsSearch(s);if(d.precond=u.precond,""!=s&&(d.resourceid_not_in=u.resourceid_not_in),!UWA.is(o))throw new Error("Socket not initialized");o.dispatchEvent("RegisterContext",d),o.addListener("Selected_Objects_search",a.bind(r,"")),o.dispatchEvent("InContextSearch",d)}))}(t,o,i),destroy:()=>{n={}},getPrecondForLinkedTemplateSearch:(t,o)=>function(t,o){var i;return i=null!=t&&""!=t&&"Revise Template"==o.fields.buttonGroupSA.value[0]?t.saveAsLtSearchRestictIds:"",e.getPrecondForLinkTemplateSaveAsSearch(i)}(t,o),changeHandlerLinkedFortemplateField:e=>function(e){if(s)s=!1;else{if(e.fields.linkedTemplateField.selectedItems){let t=e.fields.linkedTemplateField.selectedItems.options.status;if("Released"!=t&&"Route Template.Active"!=t){let o;"Draft"==t||"Route Template.Inactive"==t?o=i.errorSelectedInactiveTemplate:"Archived"!=t&&"Route Template.Archive"!=t||(o=i.errorSelectedArchiveTemplate),widget.notify.handler().addNotif({level:"error",subtitle:o,sticky:!1}),s=!0,e.fields.linkedTemplateField.selectedItems=void 0}}if(e.fields.linkedTemplateField.selectedItems&&e.fields.linkedTemplateField.selectedItems.options){if(e.fields.linkedTemplateField._editor.elements.inputField.value==e.fields.linkedTemplateField.selectedItems.options.label){e.linkTemplateCompleteActionField.className="",e.demoteOnRejectionField.className="";let t=e.formFields.querySelector("#rcaForLinkedSaveAsTemplate"),n=e.formFields.querySelector("#demoteOnRejectionSaveAsTemplate");if(null!=t&&t.removeClassName("fonticon-chooser-scope-display"),null!=n&&n.removeClassName("fonticon-chooser-scope-display"),e.formFields.querySelectorAll(".initiate-Route-Field-Label-LinkedTemplate #linkTemplateCompleteActionField")[0]){e.formFields.querySelectorAll(".initiate-Route-Field-Label-LinkedTemplate #linkTemplateCompleteActionField")[0].innerText=i.replace(i.routeCompletionActionForSelectedTemplate,{tag1:e.fields.linkedTemplateField.selectedItems.options.label});let t=e.formFields.querySelectorAll(".initiate-Route-Field-Label-LinkedTemplate #linkTemplateCompleteActionField")[0].innerText;e.formFields.querySelectorAll(".initiate-Route-Field-Label-LinkedTemplate #linkTemplateCompleteActionField")[0].tooltipInfos=new o({shortHelp:t,allowUnsafeHTMLShortHelp:!0})}e.fields.linkedTemplateField.selectedItems.options.category&&e.fields.linkedTemplateField.selectedItems.options.category.includes("Promote Connected Object")?e.fields.routeCompletionAction.selectedIndex=1:e.fields.routeCompletionAction&&(e.fields.routeCompletionAction.selectedIndex=0)}}else{e.linkTemplateCompleteActionField.className="fonticon-chooser-scope-display",e.demoteOnRejectionField.className="fonticon-chooser-scope-display";let t=e.formFields.querySelector("#rcaForLinkedSaveAsTemplate"),o=e.formFields.querySelector("#demoteOnRejectionSaveAsTemplate");null!=t&&t.addClassName("fonticon-chooser-scope-display"),null!=o&&o.addClassName("fonticon-chooser-scope-display")}}}(e)}})),define("DS/ENORouteMgmt/Services/ContentServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/WAFData/WAFData"],(function(e,t,o,i,n){"use strict";let s,a,r,l,d,u,c;return a=function(n){return new t((function(t,s){let a=o.getDocumentServiceBaseURL()+"/"+n+"/files/DownloadTicket",r={};r=e.extend(r,o.getSyncOptions(),!0),r.data=JSON.stringify((new i).createDataForRequest({})),r.method="PUT",r.type="json",r.headers={"Content-Type":"application/ds-json"},r.onComplete=function(e){t(e)},r.onFailure=function(e){s(e)},o.authenticateRequest(a,r)}))},r=function(n,s){return new t((function(t,a){for(var r={},l=[],d=0;d<s.length;d++)(r={}).label=s[d]["ds6w:label"],r.modified=s[d]["ds6w:modified"],r.status=s[d]["ds6w:status"],l.push(r);var u=n.TreedocModel.RouteId,c=o.getRouteServiceBaseURL()+"/"+u+"/contents",p=new Array;for(d=0;d<s.length;d++){var m={id:s[d].id,updateAction:"CREATE"};p.push(m)}var g={csrf:widget.data.csrf,data:p},f={};(f=e.extend(f,o.getSyncOptions(),!0)).method="PUT",f.type="json",f.headers={"Content-Type":"application/ds-json"},f.data={csrf:widget.data.csrf},f.data=JSON.stringify(g),f.timeout=0,f.onComplete=function(e){let o=(new i).parseResp(e);t(o)},f.onFailure=function(e,t){a(t||e)},o.authenticateRequest(c,f)}))},l=function(n,s,a){return new t((function(t,r){let l=o.getRouteServiceBaseURL()+"/"+n+"/contents",d=new Array;s.forEach((function(e){let t={id:e,scopeId:a,updateAction:"CREATE"};d.push(t)}));var u={csrf:widget.data.csrf,data:d},c={};(c=e.extend(c,o.getSyncOptions(),!0)).method="PUT",c.type="json",c.headers={"Content-Type":"application/ds-json"},c.data=JSON.stringify(u),c.timeout=0,c.onComplete=function(e){let o=(new i).parseResp(e);t(o)},c.onFailure=function(e,t){r(t||e)},o.authenticateRequest(l,c)}))},d=function(i){return new t((function(t,n){let s=o.get6WServiceBaseURL()+"/bps.routeContents?&$fields=all,!image,!canDeleteContent",a=i.join(),r={};r=e.extend(r,o.getSyncOptions(),!0),r.method="POST",r.data="$ids="+a,r.headers={"Content-Type":"application/x-www-form-urlencoded"},r.onComplete=function(e){t(JSON.parse(e))},r.onFailure=function(e,t){n(t||e)},o.authenticateRequest(s,r)}))},u=function(i){return new t((function(t,n){let s=o.getRouteServiceBaseURL()+"/typeDerivatives",a={csrf:widget.data.csrf,data:i.map((function(e){return{type:e}}))},r={};r=e.extend(r,o.getSyncOptions(),!0),r.method="POST",r.type="json",r.headers={"Content-Type":"application/ds-json"},r.data=JSON.stringify(a),r.onComplete=function(e){if(e.success){let o={};e.data.forEach((e=>{i[e.type]=e.children.map((e=>e.type)),i[e.type]=i[e.type].filter((function(e){return e})),0==i[e.type].length&&i[e.type].push(e.type),o[e.type]=i[e.type]})),t(o)}},r.onFailure=function(e,t){n(t||e)},o.authenticateRequest(s,r)}))},c=function(i,n){return new t((function(t,s){var a=o.getRouteServiceBaseURL()+"/"+n+"/contents",r={id:i.id,RouteBaseState:i.RouteBaseState,relId:i.relId,policy:i.policy,RouteTargetState:i.RouteTargetState},l={};(l=e.extend(l,o.getSyncOptions(),!0)).method="PUT",l.type="json",l.headers={"Content-Type":"application/ds-json"};var d={csrf:widget.data.csrf,data:[{id:i.id,policy:i.policy,relId:i.relId,dataelements:r}]};l.data=JSON.stringify(d),l.onComplete=function(e){t(e)},l.onFailure=function(e,t){s(t||e)},o.authenticateRequest(a,l)}))},s={downloadRouteContent:e=>a(e),addExistingRouteContent:(e,t)=>r(e,t),addDraggedRouteContent:(e,t,o)=>l(e,t,o),getContentInfo:e=>d(e),fetchTypeDerivatives:e=>u(e),updateRouteContentStateBlocking:(e,t)=>c(e,t)},s})),define("DS/ENORouteMgmt/Services/RouteTemplateServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/WAFData/WAFData"],(function(e,t,o,i,n){"use strict";let s,a;return a=function(e){return new t((function(t,i){let n=o.getRouteTemplateServiceBaseURL()+"/"+e,s={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t(JSON.parse(e))},onFailure:function(e){i(e)}};o.authenticateRequest(n,s)}))},s={fetchRouteTemplateById:e=>a(e)},s})),define("DS/ENORouteMgmt/Views/InitiateRouteTabsView",["DS/Controls/TabBar","DS/ENORouteMgmt/Components/Mediator","DS/ENORouteMgmt/Config/InitiateRouteTabsConfig"],(function(e,t,o){"use strict";let i,n,s={},a={},r=function(e,t){this.container=e,a=t,u()},l=function(e){let t=e.options.value;if(void 0===t&&(t=e.dsModel.buttonGroup.value[0]),t!==n){var o=["properties","content","tasks"];s[o[t]].init(a),void 0!==n&&s[o[n]].hideView(),n=t}};r.prototype.init=function(){i=new e({displayStyle:"strip",showComboBoxFlag:!0,editableFlag:!1,multiSelFlag:!1,reindexFlag:!0,centeredFlag:!1,allowUnsafeHTMLOnTabButton:!0}),o.forEach((e=>{i.add(e)})),i.inject(this.container),d()};let d=function(){new Promise((function(e,t){let i=[];o.forEach(((e,t)=>{""!=e.loader&&(i[t]=new Promise((function(t,o){require([e.loader],(function(o){s[e.id]=o,t()}))})))})),Promise.all(i).then((()=>{e()}))})).then((function(){let e={options:{}};e.options.value=0,l(e),i.addEventListener("tabButtonClick",(function(e){l(e)})),i.addEventListener("change",(function(e){l(e)}))}),(function(){}))};r.prototype.destroy=function(){try{n=void 0,Object.keys(s).map((e=>{s[e].destroy()})),i.destroy(),a={},this.container.destroy()}catch(e){}},r.getModel=function(e){return s[e].getModel()},r.getPropertiesModel=function(){s.properties.getModel()},r.getContentModel=function(){s.contents.getModel()},r.getTasksModel=function(){s.tasks.getModel()};let u=function(){null==widget.routeMgmtMediator&&(widget.routeMgmtMediator=new t),widget.routeMgmtMediator.subscribe("initiateRoute-on-TemplateSelection",(function(e){e.template&&e.template.length>0&&e.template[0].id?(a.templateId=e.template[0].id,a.chooseUserFromGroup=e.chooseUserFromUG,a.taskEditSetting=e.template[0].taskEditSetting):(a.templateId="",a.chooseUserFromGroup="No",a.taskEditSetting="")})),widget.routeMgmtMediator.subscribe("initiateRoute-on-ScopeSelection",(function(e){a.scopeId=e.scopeId,a.scopePhyId=e.scopePhyId,a.ScopeMembers=e.ScopeMembers})),widget.routeMgmtMediator.subscribe("initiateRoute-on-RouteBasePurposeSelection",(function(e){e.basePurpose&&(a.routeBasePurpose=e.basePurpose)}))};return r})),define("DS/ENORouteMgmt/Views/ContentInfoPropWidget",["UWA/Class/View","UWA/Core","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","UWA/Class/Model","UWA/Drivers/Alone","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u){return{render:function(e,t){this.parentContainer=this.container;var n={typeOfDisplay:i.ALL,selectionType:i.NO_SELECTION,editMode:!1,readOnly:!1,context:{getSecurityContext:function(){return{SecurityContext:d.getSecurityContextValue()}}},extraNotif:!0,sourceAppId:"ENXROUT_AP",actions:[{name:"action_close_panel",text:u.infoCloseAction,icon:"close",handler:function(){widget.routeMgmtMediator.publish("route-content-preview-close")}}]};return this.EditPropWidget=new o(n),t.model.id&&this.loadModel(t.model.id,e),this},getPropModel:function(e){var t=[],o=new n({metatype:"businessobject",objectId:e.objectId,source:"3DSpace",tenant:d.getTenantValue()});return o.set("isTransient",!1),t.push(o),t},loadModel:function(e,t){var o=this.getPropModel({objectId:e});this.EditPropWidget.initDatas(o),this.EditPropWidget.elements.container.inject(t)}}})),define("DS/ENORouteMgmt/Config/Toolbar/RouteTasksTabToolbarConfig",["DS/ENORouteMgmt/Utilities/RouteWidgetPersistency","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){let o,i={menu:[{type:"CheckItem",title:t.titleGraphView,state:"selected",fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-flow-tree wux-ui-3ds-lg graph-icon-task-toolbar"},action:{module:"DS/ENORouteMgmt/Views/ToggleTaskViews",func:"doToggleView",argument:{view:"GraphView"}},tooltip:t.titleGraphView},{type:"CheckItem",title:t.gridView,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-list"},action:{module:"DS/ENORouteMgmt/Views/ToggleTaskViews",func:"doToggleView",argument:{view:"GridView"}},tooltip:t.gridView}]};return o={writetoolbarDefination:(o,n)=>function(o,n){let s=n.model.Actions.indexOf("selectusers.tasks")>=0&&"Define"==n.model.state,a=n.model.Actions.indexOf("add.tasks")>=0,r={},l=[],d=!1;n.model.taskEditSetting&&"Maintain Exact Task List"==n.model.taskEditSetting&&(d=!0);let u=!1,c=e.getViewPersistency("RouteTasksPage","GridView"),p="selected"===c?"unselected":"selected";return"Route Template"===n.model.Type&&"Active"===n.model.actualState&&n.model.Actions.indexOf("demote")>=0&&(u=!0),i.menu[1].state=c,i.menu[0].state=p,s&&l.push({id:"selectusers.tasks",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"users-group-ok",fontIconFamily:WUXManagedFontIcons.Font3DS}},action:{module:"DS/ENORouteMgmt/Views/Dialogs/ChooseUsersFromUserGroup",func:"showSeletUsers",argument:{routeId:o.RouteId}},position:"far",category:"create",tooltip:t.SelectAssigneeModalTitle}),(a||u)&&(d||l.push({id:"addRouteTask",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"plus",fontIconFamily:WUXManagedFontIcons.Font3DS}},action:{module:"DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphView",func:"addRouteTask"},position:"far",category:"create",tooltip:t.addTask}),l.push({id:"editTask",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"pencil",fontIconFamily:WUXManagedFontIcons.Font3DS}},action:{module:"DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphView",func:"switchView",argument:{view:"edit"}},position:"far",category:"create",tooltip:t.editMode}),d||l.push({id:"removeRouteTask",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"trash",fontIconFamily:WUXManagedFontIcons.Font3DS}},action:{module:"DS/ENORouteMgmt/Views/Dialogs/DeleteGridTaskDialog",func:"showConfirmationDialog"},position:"far",category:"create",tooltip:t.deleteTask})),l.push({id:"view",className:"routeViews",dataElements:{typeRepresentation:"taskViewDropDown",icon:{iconName:"selected"==c?"view-list":"flow-tree",fontIconFamily:1},value:i},position:"far",tooltip:t.switchView,category:"action"}),r.entries=l,r.typeRepresentations={taskViewDropDown:{stdTemplate:"functionMenuIcon",semantics:{label:"action",icon:"sorting"},position:"far",tooltip:{text:"view",position:"far"}}},JSON.stringify(r)}(o,n),destroy:function(){_dataGrid.destroy(),_container.destroy()}},o})),define("DS/ENORouteMgmt/Commands/InitialRoute_Widget",["UWA/Class","DS/ApplicationFrame/Command","DS/WidgetServices/WidgetServices","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/TransientWidget/TransientWidget","DS/ENORouteMgmt/EnoviaBootstrap"],(function(e,t,o,i,n,s){"use strict";var a=t.extend({defaultIsTransient:!1,extraNotif:!1,init:function(e,t){this._parent(e,t),require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"]),this.editProp=null,s.start({id:widget.id})},beginExecute:function(){},execute:function(e){this.routeName=e.routeName,this.routeId=e.routeId;var t=this;require(["DS/PADUtils/PADContext"],(function(e){var o=e.get();null==o&&(o=t.options.context),t.launchCreateRoute(o)}))},_launchTransientWidget:function(e,t){window.top.performance.mark("end_EP_SelectionTreatment"),window.top.performance.mark("start_EP_TransientLoaded"),e.showWidget("ENXROUT_AP","",t,{mode:"panel",height:800,width:750})},launchCreateRoute:function(e){var t=this;widget.setValue("index_mode",!1);var s=widget.getValue("index_mode"),a={context:e};i.getInstance(a).getSecurityContext();var r=[],l=[],d=e.model;if(d&&d.objectId||(r=e.getSelectedNodes()),r.length&&(console.dir("selected_nodes : "+r),r.forEach((function(e){var t=e&&"function"==typeof e.getInstID?e.getInstID():null;null!=t&&Array.isArray(t)&&(t=t.length>0?t[0]:null);var i=t?"relationship":"businessobject";t=(t=t||e.getID())||e.id;var n=e.metatype?e.metatype:i,s=e.source?e.source:null,a=e.tenant?e.tenant:null,r=e.type?e.type:null;if(t){var d={metatype:n,objectId:t};(a=a||o.getTenantID())&&(d.tenant=a),s&&(d.source=s),r&&(d.type=r),l.push(d)}}))),l.length>0){var u=t.defaultIsTransient;"function"==typeof e.isTransient&&(u=e.isTransient()),!1===u&&i.getSecurityContext({onSuccess:function(e){var o=window.top.document.body.getElementsByClassName("preview-container")[0],i=!1;if(o){var a=o.getElement(".moduleContent");if(a)a.className.indexOf("EditPropWidget")>=0&&(i=!0,o.show(),require(["DS/WidgetServices/commandProxy/CommandProxy"],(function(e){e.publishUpdate(l)})))}if(!1===i){var r={SelectedItem:l,isTransient:"true",loadData:!0,asynchronousRequest:"true",index_mode:widget.getValue("index_mode"),routeName:t.routeName,routeId:t.routeId};e&&e.SecurityContext&&(r.securityContext=e.SecurityContext),s&&(r.readOnly=!0),t._launchTransientWidget(n,r)}}})}else t._setError(e,UWA.i18n("no content selected"));t.end()},_setError:function(e,t){if("function"==typeof e.displayNotification){var o={eventID:"error",msg:t};e.displayNotification(o)}else alert(t)},endExecute:function(){}});return a})),define("DS/ENORouteMgmt/Services/RouteWidgetUtilServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/WAFData/WAFData"],(function(e,t,o,i){"use strict";let n,s,a,r;return s=function(){return new t((function(e,t){let i=o.get3DSpaceURL()+"/resources/bps/cspaces",n={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(t){var o=[],i=[],n=null,s=null,a=JSON.parse(t).cspaces;a&&0!==a.length||(a=[]);var r="",l=!0;if(a.forEach((function(e){var t=e.displayName.split(".");if(3===t.length&&l){var o=t[1];""==r&&(r=o),l=r==o}})),a.forEach((function(e){var t=e.displayName,i=e.displayName.split("."),a=e.name.split(".");3===i.length&&(t=i[2]+"  ",l||(t+=i[1]+"  "),t+=i[0]),o.push({label:t,value:e.name}),e.isDefault&&(n=e.name,s=a[1])})),null==n&&a.length>0){n=a[0].name;var d=a[0].name.split(".");s=d[1]}i.push({cspaces:o,defaultsc:n,defaultOrgName:s}),e(i)},onFailure:function(e,o){t(o)}};o.authenticateRequest(i,n)}))},a=function(){return new t((function(t,i){let n=o.getRouteServiceBaseURL()+"/supportedContentTypes",s={};s=e.extend(s,o.getSyncOptions(),!0),s.method="GET",s.type="json",s.headers={"Content-Type":"application/ds-json"},s.data={csrf:widget.data.csrf},s.onComplete=function(e){t(e)},s.onFailure=function(e){i(e)},o.authenticateRequest(n,s)}))},r=function(i){return new t((function(t,n){let s=o.get3DSpaceURL()+"/resources/bps/objectAccess",a={};a=e.extend(a,o.getSyncOptions(),!0),a.method="POST",a.data="oid_list="+i.toString(),a.headers={"Content-Type":"application/x-www-form-urlencoded"},a.onComplete=function(e){let o=JSON.parse(e);t(o)},a.onFailure=function(e,t,o){n(JSON.parse(t))},o.authenticateRequest(s,a)}))},n={fetchSecurityContext:()=>s(),fetchAllowedContentTypesForRoute:()=>a(),fetchStateBlockingConditions:e=>r(e)},n})),define("DS/ENORouteMgmt/Views/RouteTaskTabsView",["DS/Controls/TabBar","DS/ENORouteMgmt/Utilities/RouteWidgetPersistency","DS/ENORouteMgmt/Config/RouteTaskTabsConfig","DS/ENORouteMgmt/Views/Form/TaskProperties"],(function(e,t,o,i){"use strict";let n,s,a={},r={},l=function(e,t){this.container=e,r=t};var d=["properties","members","comments"];let u=function(e){let t=e.options.value;void 0===t&&(t=e.dsModel.buttonGroup.value[0]),t!==s&&(a[d[t]].init(r),void 0!==s&&a[d[s]].hideView(),s=t,widget.setValue("RouteTaskTabs-ShowView",t))};l.prototype.init=function(){n=new e({displayStyle:"strip",showComboBoxFlag:!0,editableFlag:!1,multiSelFlag:!1,reindexFlag:!0,centeredFlag:!1,allowUnsafeHTMLOnTabButton:!0}),o.forEach((e=>{let o=t.getTaskTabPersistency("RouteTaskTabsPage");e.id==d[o]?e.isSelected=!0:e.isSelected=!1,n.add(e)})),n.inject(this.container),c()};let c=function(){new Promise((function(e,t){let i=[];o.forEach(((e,t)=>{""!=e.loader&&(i[t]=new Promise((function(t,o){require([e.loader],(function(o){a[e.id]=o,t()}))})))})),Promise.all(i).then((()=>{e()}))})).then((function(){let e={options:{}},o=t.getTaskTabPersistency("RouteTaskTabsPage");e.options.value=o,s=void 0,a[d[0]].init(r),a[d[0]].hideView(),u(e),n.addEventListener("tabButtonClick",(function(e){u(e)})),n.addEventListener("change",(function(e){u(e)}))}),(function(){}))};return l.prototype.destroy=function(){try{s=void 0,Object.keys(a).map((e=>{a[e].destroy()})),n.destroy(),r={},this.container.destroy()}catch(e){}},l.getModel=function(e){return a[e].getModel()},l.getPropertiesModel=function(){a.properties.getModel()},l.getMembersModel=function(){a.members.getModel()},l.getCommentsModel=function(){a.comments.getModel()},l})),define("DS/ENORouteMgmt/Views/Loader/InitiateDocumentChooser",["DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/TreeModel/TreeNodeModel","DS/TreeModel/TreeDocument","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i){"use strict";let n;var s=function(e,o){for(var i=0;i<o.length;i++){var s,a=o[i];a&&(s=new t({label:a["ds6w:label"],value:a.id,name:a["ds6w:identifier"],type:a["ds6w:type"]}),"ENOTASK_AP"==widget.getValue("appId")&&s.options.icons.push(a.type_icon_url),null==n.selectedItems?n.selectedItems=s:n.selectedItems.push(s),n._applySelectedItems())}};return{init:(t,o,i)=>function(t,o,i){n=o;var a=[];null!=i&&(a=JSON.parse(JSON.stringify(i))),null!=n&&null!=n.selectedItems&&0!=n.selectedItems.length&&n.selectedItems.forEach((function(e){null==e.options.value.name&&a.push(e.options.value)}));var r=t.dsModel,l=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],(function(t){var o=t.createSocket({socket_id:l}),i=e.getRefinementToSnN(l,"addExistingAttachment",!0,["Document"]);if(i.precond=e.getPrecondForDocumentSearch(),i.resourceid_not_in=a,!UWA.is(o))throw new Error("Socket not initialized");o.dispatchEvent("RegisterContext",i),o.addListener("Selected_Objects_search",s.bind(r,"")),o.dispatchEvent("InContextSearch",i)}))}(t,o,i),populateAddExisiting:(e,t)=>function(e,t){let o=[],i=e.attachedDocuments;n=e.autoCompleteComponent;let a=[];null!=i&&(o=JSON.parse(JSON.stringify(i))),null!=n&&null!=n.selectedItems&&0!=n.selectedItems.length&&n.selectedItems.forEach((function(e){null==e.options.value.name&&o.push(e.options.value)}));for(var r=0;r<t.length;r++){var l=t[r];o.includes(l.id)||(o.push(l.id),a.push(l))}s("",a)}(e,t)}})),define("DS/ENORouteMgmt/Services/MemberServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Utilities/ParseJSONUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","DS/WAFData/WAFData"],(function(e,t,o,i,n,s,a){"use strict";let r,l;return l=function(e,s){return new t((function(t,a){var r,l=i.tileView(),d={};r=o.getRouteServiceBaseURL()+"/"+l.TreedocModel.RouteId+"/members/"+s;var u={id:s,newAccess:e};d.data=JSON.stringify((new n).createDataForRequest(u)),d.method="PUT",d.type="json",d.headers={"Content-Type":"application/ds-json"};var c=d;c.onComplete=function(e){t(e)},c.onFailure=function(e,t){a(t||e)},o.authenticateRequest(r,d)}))},r={changeAccess:(e,t)=>l(e,t)},r})),define("DS/ENORouteMgmt/Utilities/RouteDocumentUtils",["UWA/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/DocumentManagement/DocumentManagement"],(function(e,t,o){"use strict";return{getDocumentsData:function(i){return new e((function(e,n){o.getDocuments(i,{tenant:t.getTenantValue(),securityContext:decodeURIComponent(t.getSecurityContextValue()),tenantUrl:t.get3DSpaceURL(),additionalURLParams:"$fields=indexedTypeicon",onComplete:function(t){t.success&&Array.isArray(t.data)?e(t):n()},onFailure:function(e){console.log(e),n()}})}))},getCommands:function(e,o,i,n,s){var a=this,r=t.get3DSpaceURL(),l=t.getDashboardURL(),d=[n];a.getDocumentsData(d).then((function(n){var u=new o;u.subscribe({event:"docv2-show-notification"},(function(e){widget.notify.handler().addNotif({level:e.level,title:e.title,subtitle:e.subtitle,sticky:e.sticky,allowUnsafeHTML:e.allowUnsafeHTML,message:e.message})})),u.subscribe({event:"docv2-undoedit-complete"},(function(e){a.getDocumentsData(d).then((function(t){c=t.data[0],u.publish({event:"docv2-preview-reload-toolbar",data:{nodeModel:e.nodeModel}})}))})),u.subscribe({event:"docv2-edit-complete"},(function(e){a.getDocumentsData(d).then((function(t){c=t.data[0],u.publish({event:"docv2-preview-reload-toolbar",data:{nodeModel:e.nodeModel}})}))})),u.subscribe({event:"docv2-update-complete"},(function(e){a.getDocumentsData(d).then((function(t){c=t.data[0],u.publish({event:"docv2-preview-reload-toolbar",data:{nodeModel:e.nodeModel}}),u.publish({event:"docv2-preview-reload-viewer",data:{nodeModel:e.nodeModel}})}))}));var c=n.data[0],p={fetchSecurityContext:function(){return decodeURIComponent(t.getSecurityContextValue())},getSelectedNodes:function(){return[c]},getDocumentFromNodeModel:function(e){return e},platformUrls:{"3DSpace":r,"3DDashboard":l,platformId:t.getTenantValue()},events:u},m=new i(p),g=m.commands,f={entries:[g[e.PREVIEW],g[e.UPDATE],g[e.DOWNLOAD],g[e.EDIT],g[e.UNDO_EDIT],g[e.OFFICE_WEB_EDITION],g[e.LOCK_AND_DOWNLOAD],g[e.UNLOCK],g[e.UPDATE_AND_UNLOCK]]};"Document"==c.type&&f.entries.push(g[e.COPY_LINK]),m.getWebUXContextMenuItemsForCurrentSelection(f.entries,!1).then((e=>{s(e)}))})).catch((function(e){console.log("Error in RouteDocumentUtils "+e)}))}}})),define("DS/ENORouteMgmt/Services/RouteTaskServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/WAFData/WAFData","DS/ENORouteMgmt/Views/Form/TaskProperties","DS/ENORouteMgmt/Utilities/Utils"],(function(e,t,o,i,n,s,a){"use strict";let r,l,d;s.getTaskVaribles();d=function(n){return new t((function(t,s){l=o.getRouteServiceBaseURL();let a=l+"/"+n+"/tasks",r={};r=e.extend(r,o.getSyncOptions(),!0),r.method="GET",r.type="json",r.timeout=0,r.headers={"Content-Type":"application/ds-json"},r.onComplete=function(e){e.result=(new i).parseResp(e),t(e.result)},r.onFailure=function(e,t){s(t||e)},o.authenticateRequest(a,r)}))};let u=function(n,s){return new t((function(t,a){let r,l=n.routePropertiesInfo.id,d=n.options.grid.id,u=s.fields.taskAssigneeField.selectedItems.options.label,c=s.fields.descField.value,p=s.fields.assigneeId,m=n.options.grid.comments,g=o.getRouteServiceBaseURL()+"/"+l+"/tasks/"+d;if(r=n.options.grid.assigneeId,""==p)return void _alertFailure.add({message:NLS.errorTaskAssignee});if(r==p&&"TRUE"!=n.options.grid.routeOwnerTask)return void _alertFailure.add({message:NLS.taskNewAssignee});var f={};f="Inbox Task"==n.options.grid.type?{reAssignComments:c,routeId:l,taskId:d,newAssigneeId:p,newAssigneeType:s.fields.assigneeType,taskAssigneeName:u,taskAssigneeUserName:s.fields.taskAssigneeUserName,type:n.options.grid.type,isChangeAssignee:"true",routeTaskApprovalComments:m}:{routeId:l,taskId:d,newAssigneeId:p,newAssigneeType:s.fields.assigneeType,taskAssigneeName:u,taskAssigneeUserName:s.fields.taskAssigneeUserName,type:n.options.grid.type,isChangeAssignee:"true"},n.routePropertiesInfo&&"Route Template"==n.routePropertiesInfo.model.Type&&(g=o.getRouteTemplateServiceBaseURL()+"/"+l+"/tasks/"+d,"TRUE"==n.options.grid.routeOwnerTask&&(f.routeOwnerTask="FALSE",f.routeOwnerUGChoice=""));let h={};h=e.extend(h,o.getSyncOptions(),!0),h.method="PUT",h.type="json",h.timeout=0,h.headers={"Content-Type":"application/ds-json"};var w={};w=null!=n.csrf?(new i).createDataForRequest(f,n.csrf):(new i).createDataForRequest(f),h.data=JSON.stringify(w),h.onComplete=function(e){e.result=(new i).parseResp(e),t(e.result)},h.onFailure=function(e,t){a(t||e)},o.authenticateRequest(g,h)}))};let c=function(e,t){if(t.tenant&&(e=e+(-1===e.indexOf("?")?"?":"&")+"tenant="+t.tenant),t.securityContext){var o=t.securityContext;-1==t.securityContext.indexOf("ctx::")&&(o="ctx::"+o),e=e+(-1===e.indexOf("?")?"?":"&")+"SecurityContext="+encodeURIComponent(o)}return t.debugMode&&(e=e+(-1===e.indexOf("?")?"?":"&")+"$debug=true"),a.getCookie("swymlang")&&(e=e+(-1===e.indexOf("?")?"?":"&")+"$language="+a.getCookie("swymlang")),e};return r={fetch:e=>d(e),deleteTask:n=>function(n){return new t((function(t,s){let a=n.getTreeDocument().options.routeId;l=o.getRouteServiceBaseURL();let r=l+"/"+a+"/tasks/"+n.options.grid.relId,d={assigneeId:n.options.grid.assigneeId},u={};u=e.extend(u,o.getSyncOptions(),!0),u.method="DELETE",u.type="json",u.timeout=0,u.headers={"Content-Type":"application/ds-json"},u.data=JSON.stringify((new i).createDataForRequest(d)),u.onComplete=function(e){e.result=(new i).parseResp(e),t(e.result)},u.onFailure=function(e,t){s(t||e)},o.authenticateRequest(r,u)}))}(n),changeAssignee:(i,n)=>function(i,n){return new t((function(t,n){null==widget.data.csrf?require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],(function(n){n.getServiceUrl({serviceName:"3DSpace",platformId:o.getTenantValue(),onComplete:function(n){o.authenticateRequest(n+"/resources/v1/application/E6WFoundation/CSRF",e.extend({method:"GET",onComplete:function(e){i.csrf=JSON.parse(e).csrf,t()}}))}})})):t()})).then((function(){return u(i,n)}))}(i,n),updateTaskData:(i,n,s)=>function(i,n,s){return new t((function(t,a){var r={};(r=e.extend(r,o.getSyncOptions(),!0)).method=n,r.type="json",r.timeout=0,r.headers={"Content-Type":"application/ds-json"},r.wait=!0,r.data=JSON.stringify(i),r.onComplete=function(e){t(e)},r.onFailure=function(e,t){a(t||e)},o.authenticateRequest(s,r)}))}(i,n,s),updateReviewComment:(n,s)=>function(n,s){return new t((function(t,a){var r=o.getRouteServiceBaseURL()+"/"+s.id+"/tasks/"+n.model.id,l={taskOwnerReviewComments:n.model.reviewersComments,taskOwnerReviewAction:n.model.taskReviewButton},d={};(d=e.extend(d,o.getSyncOptions(),!0)).method="PUT",d.type="json",d.timeout=0,d.headers={"Content-Type":"application/ds-json"},d.wait=!0,d.data=JSON.stringify((new i).createDataForPromoteDemote(l,"REVISE")),d.onComplete=function(e){t(e)},d.onFailure=function(e,t){a(t||e)},o.authenticateRequest(r,d)}))}(n,s),getUserGroupPhysicalId:e=>function(e){return new t((function(t,i){let n=o.get3DSpaceURL()+"/resources/bps/uuids",s={method:"POST",headers:{"Content-Type":"application/json"}};s.data=JSON.stringify({phyIds:[e]}),s.onComplete=function(e){let o=JSON.parse(e);t(o)},s.onFailure=function(e,t,o){i(JSON.parse(t))},o.authenticateRequest(n,s)}))}(e),fetchTaskFields:()=>new t((function(e,t){let i=o.getRouteServiceBaseURL()+"?$definition=nodata",n={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(t){let o=JSON.parse(t).definitions.filter((function(e){return"tasks"==e.name})),i=o.length>0&&o[0].items.filter((function(e){return"bps.publicroutetask-fields"==e.name})),n=(i.length>0&&i[0].items).filter((function(e){return"task-custom-fields"==e.name}))[0].items;e(n)},onFailure:function(e){t(e)}};o.authenticateRequest(i,n)})),fetchTaskAttachments:(e,n)=>function(e,n){return new t((function(t,s){let a=o.getRouteServiceBaseURL()+"/"+e+"/tasks/"+n+"/taskAttachments",r={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t((new i).parseResp(JSON.parse(e)))},onFailure:function(e){s(e)}};o.authenticateRequest(a,r)}))}(e,n),assignAndStartFromUserGroup:(n,s,a,r,l,d)=>function(n,s,a,r,l,d){return new t((function(t,u){var p,m=(new i).createDatasForRequest(n,s,a),g={};(g=e.extend(g,o.getSyncOptions(),!0)).method="POST",g.type="json",g.timeout=0,g.headers={"Content-Type":"application/ds-json"},g.wait=!0,g.data=JSON.stringify(m),void 0!==o.getRouteServiceBaseURL()?(p=o.getRouteServiceBaseURL()+"/"+s+"/splitRouteNode",r&&(p=o.getRouteServiceBaseURL()+"/"+s+"/splitRouteNodeAndStart")):(p=d+"/splitRouteNode",r&&(p=d+"/splitRouteNodeAndStart")),g.onComplete=function(e){t(e)},g.onFailure=function(e){u(e)},p=c(p,l),o.authenticateRequest(p,g)}))}(n,s,a,r,l,d),fetchRouteTasksById:(i,n,s)=>function(i,n,s){return new t((function(t,a){var r;r=void 0!==o.getRouteServiceBaseURL()?o.getRouteServiceBaseURL()+"/"+i+"/tasks":n+"/tasks";var l={};(l=e.extend(l,o.getSyncOptions(),!0)).method="GET",l.type="json",l.timeout=0,l.headers={"Content-Type":"application/ds-json"},l.onComplete=function(e){t(e)},l.onFailure=function(e){a(e)},r=c(r,s),o.authenticateRequest(r,l)}))}(i,n,s)},r})),define("DS/ENORouteMgmt/Services/CollabTaskServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Views/Form/CustomFieldUtils","DS/WAFData/WAFData","DS/ENORouteMgmt/Views/Form/TaskProperties","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l){"use strict";let d,u,c,p,m,g,f,h;a.getTaskVaribles();u=function(n,s,a){return new t((function(t,s){var r=o.getCollabTaskServiceBaseURL()+"/"+n.model.id,l={routeTaskApprovalComments:n.model.comments};if(l=w(l,n),3==n.model.dueDateOptionSelected){var d=new Date(n.model.taskDueDate);d=d.toISOString(),l.routeTaskDueDate=d}"saveForLater"!=n.taskActionButtonsValue&&("Yes"==n.model.needsOwnerReview?l.state="Review":l.state="Complete"),"Approve"!=n.model.taskActionButton&&"Reject"!=n.model.taskActionButton&&"Abstain"!=n.model.taskActionButton||(l.routeTaskApprovalAction=n.model.taskActionButton,n.model.eSignRecordId&&Array.isArray(n.model.eSignRecordId)?l.eSignRecordId=n.model.eSignRecordId[0]:l.eSignRecordId=n.model.eSignRecordId);var u={};(u=e.extend(u,o.getSyncOptions(),!0)).method="POST",u.type="json",u.timeout=0,u.headers={"Content-Type":"application/ds-json"},u.wait=!0,l=(new i).createDataForRequest(l),"saveForLater"==n.taskActionButtonsValue&&0!=a.length&&(l.data[0].relateddata={references:a}),l.data[0].id=n.model.id,l.data[0].updateAction="MODIFY",n.model.assigneeIdNew&&(l.data[0].relateddata={assignees:[{id:n.model.assigneePID,updateAction:"DISCONNECT"},{id:n.model.assigneeIdNew,updateAction:"CONNECT"}]}),u.data=JSON.stringify(l),u.onComplete=function(e){t(e)},u.onFailure=function(e,t){s(t||e)},o.authenticateRequest(r,u)}))},h=function(n,s,a){return new t((function(t,s){var r=o.getCollabTaskServiceBaseURL()+"/"+n.model.id,l={routeTaskReviewerComments:n.model.reviewersComments};l=w(l,n);var d={};(d=e.extend(d,o.getSyncOptions(),!0)).method="PUT",d.type="json",d.timeout=0,d.headers={"Content-Type":"application/ds-json"},d.wait=!0,l=(new i).createDataForRequest(l),"saveForLater"==n.taskReviewButtonsValue&&0!=a.length&&(l.data[0].relateddata={references:a}),d.data=JSON.stringify(l),d.onComplete=function(e){t(e)},d.onFailure=function(e,t){s(t||e)},o.authenticateRequest(r,d)}))},g=function(e){var o={};return"Yes"==e.needsOwnerReview&&"Assigned"==e.currentState?(o.routeTaskApprovalComments=l.markAsCompleteComments,o.state="Review",o.routeTaskApprovalAction="Auto Complete",new t((function(i,n){f(e,o).then((s=>(o.routeTaskReviewerComments=l.markAsCompleteComments,o.state="Complete",o.routeTaskApprovalAction="Auto Complete",new t((function(t,i){f(e,o).then((e=>{t(e)}),(e=>{n(e)}))})).then((e=>{i(e)})).catch((e=>{n(e)})))),(e=>{n(e)}))}))):(o.routeTaskApprovalComments=l.markAsCompleteComments,o.state="Complete",o.routeTaskApprovalAction="Auto Complete",new t((function(t,i){f(e,o).then((e=>{t(e)}),(e=>{i(e)}))})))},f=function(n,s){return new t((function(t,a){var r=o.getCollabTaskServiceBaseURL()+"/"+n.id,l={};(l=e.extend(l,o.getSyncOptions(),!0)).method="PUT",l.type="json",l.timeout=0,l.headers={"Content-Type":"application/ds-json"},l.wait=!0,s=(new i).createDataForRequest(s),l.data=JSON.stringify(s),l.onComplete=function(e){t(e)},l.onFailure=function(e,t){a(t||e)},o.authenticateRequest(r,l)}))},c=function(n){return new t((function(t,s){var a=o.getCollabTaskServiceBaseURL(),r=[],l={updateAction:"DISCONNECT",id:n.model.assigneePID},d={updateAction:"CONNECT",dataelements:{name:o.getLoginUser()}};r.push(d),r.push(l);var u=(new i).createDataForRequest({});u.data[0].id=n.model.id,u.data[0].updateAction="MODIFY",u.data[0].relateddata={assignees:r},u=JSON.stringify(u);var c={};(c=e.extend(c,o.getSyncOptions(),!0)).method="POST",c.type="json",c.timeout=0,c.headers={"Content-Type":"application/ds-json"},c.wait=!0,c.data=u,c.onComplete=function(e){t(e)},c.onFailure=function(e,t){s(t||e)},o.authenticateRequest(a,c)}))},p=function(i){return new t((function(t,n){var s=o.getCollabTaskServiceBaseURL()+"/"+i,a={};(a=e.extend(a,o.getSyncOptions(),!0)).method="GET",a.type="json",a.timeout=0,a.headers={"Content-Type":"application/ds-json"},a.wait=!0,a.onComplete=function(e){e.data[0].relateddata&&e.data[0].relateddata.route.length>0?t(e.data[0].relateddata.route[0].id):n(e)},a.onFailure=function(e,t){n(t||e)},o.authenticateRequest(s,a)}))},m=function(n,s){return new t((function(t,a){if(0==s.length)t();else{var r=o.getCollabTaskServiceBaseURL()+"/"+n.model.id,l={},d={};(d=e.extend(d,o.getSyncOptions(),!0)).method="PUT",d.type="json",d.timeout=0,d.headers={"Content-Type":"application/ds-json"},d.wait=!0,(l=(new i).createDataForRequest(l)).data[0].relateddata={references:s},d.data=JSON.stringify(l),d.onComplete=function(e){t(e)},d.onFailure=function(e,t){a(t||e)},o.authenticateRequest(r,d)}}))};let w=function(e,t){let o=r.getTaskCustomFields();return o&&o.forEach(((o,i)=>{if("extensions"!=o.name){let i=t.model[o.name];if("object"==typeof i&&i.getDate)i=i.toISOString();else if(n.isDateField(o))if(Array.isArray(i)){for(var s=0;s<i.length;s++)if(i&&""!=i){let e=new Date(i[s]);i[s]=e.toISOString()}}else if(i&&""!=i){i=new Date(i).toISOString()}e[o.name]=i}})),e};return d={completeTask:e=>g(e),updateComment:(e,t,o)=>u(e,0,o),acceptTask:e=>c(e),updateTaskAttachment:(e,t)=>m(e,t),getRouteIdByTask:e=>p(e),updateReviewComment:(e,t,o)=>h(e,0,o)},d})),define("DS/ENORouteMgmt/Controller/CollabTaskServicesController",["DS/ENORouteMgmt/Services/CollabTaskServices","UWA/Promise"],(function(e,t){"use strict";let o;return o={updateComment:function(o,i,n){return new t((function(t,s){e.updateComment(o,i,n).then((e=>{t(e)}),(e=>{s(e)}))}))},completeTask:function(o){return new t((function(t,i){e.completeTask(o).then((e=>{t(e)}),(e=>{i(e)}))}))},acceptTask:function(o){return new t((function(t,i){e.acceptTask(o).then((e=>{t(e)}),(e=>{i(e)}))}))},getRouteIdByTask:function(o){return new t((function(t,i){e.getRouteIdByTask(o).then((e=>{t(e)}),(e=>{i(e)}))}))},updateTaskAttachment:function(o,i){return new t((function(t,n){e.updateTaskAttachment(o,i).then((e=>{t(e)}),(e=>{n(e)}))}))},updateReviewComment:function(o,i,n){return new t((function(t,s){e.updateReviewComment(o,i,n).then((e=>{t(e)}),(e=>{s(e)}))}))}},o})),define("DS/ENORouteMgmt/Services/InitiateRouteServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/WAFData/WAFData"],(function(e,t,o,i,n){"use strict";let s,a,r;a=function(n){return new t((function(t,i){null==n.csrf?require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],(function(i){i.getServiceUrl({serviceName:"3DSpace",platformId:o.getTenantValue(),onComplete:function(i){o.authenticateRequest(i+"/resources/v1/application/E6WFoundation/CSRF",e.extend({method:"GET",onComplete:function(e){n.csrf=JSON.parse(e).csrf,t()}}))}})})):t()})).then((function(){return function(e){return new t((function(t,n){let s=o.getRouteServiceBaseURL();const a="ctx::"+e.data[0].dataelements.ctx;let r={method:"POST",headers:{"Content-Type":"application/ds-json"}};"True"==e.data[0].dataelements.useTemplateTasks?s+="?$include=tasks":e.data[0].dataelements.useTemplateTasks="False",r.data=JSON.stringify(e),r.timeout=0,r.onComplete=function(e){let o=(new i).parseResp(JSON.parse(e)),n=JSON.parse(e);if(n.data[0].relateddata&&n.data[0].relateddata.tasks){let e=n.data[0].relateddata.tasks;for(let t of e)if("True"==t.dataelements.chooseUsersFromUg){o[0].actions.push("selectusers.tasks");break}let t=l(e);o[0].assignees=t}t(o)},r.onFailure=function(e,t,o){n(JSON.parse(t))},o.authenticateRequest(s,r,a)}))}(n)}))},r=function(n){return new t((function(t,i){null==n.csrf?require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],(function(i){i.getServiceUrl({serviceName:"3DSpace",platformId:o.getTenantValue(),onComplete:function(i){o.authenticateRequest(i+"/resources/v1/application/E6WFoundation/CSRF",e.extend({method:"GET",onComplete:function(e){n.csrf=JSON.parse(e).csrf,t()}}))}})})):t()})).then((function(){return function(e){return new t((function(t,n){let s=o.getRouteServiceBaseURL()+"?action=start";const a="ctx::"+e.data[0].dataelements.ctx;let r={method:"POST",headers:{"Content-Type":"application/ds-json"}};"True"==e.data[0].dataelements.useTemplateTasks?s+="&$include=tasks":e.data[0].dataelements.useTemplateTasks="False",r.data=JSON.stringify(e),r.timeout=0,r.onComplete=function(e){let o=(new i).parseResp(JSON.parse(e));t(o)},r.onFailure=function(e,t,o){n(JSON.parse(t))},o.authenticateRequest(s,r,a)}))}(n)}))};let l=function(e){let t=[];return e.forEach((function(e){if(t.indexOf(e.dataelements.taskAssignee)<0){let o="User Group";"Person"==e.dataelements.assigneeType&&(o=e.dataelements.assigneeType);let i=o+"~"+e.dataelements.taskAssigneeUsername+"~"+e.dataelements.taskAssignee;t.push(i)}})),t};return s={saveAsRoute:e=>a(e),createRoute:e=>r(e),getScopeInformation:e=>function(e){return new t((function(t,i){let n=o.get3DSpaceURL()+"/resources/bps/scopeMembers?oid="+e,s={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t(JSON.parse(e))},onFailure:function(e){i(JSON.parse(e))}};o.authenticateRequest(n,s)}))}(e)},s})),define("DS/ENORouteMgmt/Controller/RouteServicesController",["DS/ENORouteMgmt/Services/RouteServices","DS/ENORouteMgmt/Services/RouteTaskServices","DS/ENORouteMgmt/Services/InitiateRouteServices","DS/ENORouteMgmt/Services/ContentServices","DS/ENORouteMgmt/Services/MemberServices","DS/ENORouteMgmt/Services/RouteTemplateServices","DS/ENORouteMgmt/Services/RouteWidgetUtilServices","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","UWA/Promise","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d){"use strict";let u,c=function(e,t){500===t.statusCode?widget.notify.handler().addNotif({level:"error",subtitle:d.unexpectedError,sticky:!0}):e(t)};return u={fetchAllRoutes:function(){return new l((function(t,o){e.fetchAllRoutes().then((e=>{t(e)}),(e=>{c(o,e)}))}))},fetchRouteById:function(t,o){return new l((function(i,n){e.fetchRouteById(t,o).then((e=>{i(e)}),(e=>{c(n,e)}))}))},fetchRouteByIds:function(t){return new l((function(o,i){e.fetchRouteByIds(t).then((e=>{o(e)}),(e=>{i(e)}))}))},fetchRouteTemplateById:function(e){return new l((function(t,o){s.fetchRouteTemplateById(e).then((e=>{t(e)}),(e=>{c(o,e)}))}))},fetchRouteAndTaskByRouteId:function(t){let o=r.getTaskCustomFields();return u.fetchRouteCustomFields().then((e=>{r.setRouteCustomFields(e)}),(e=>{console.log("fetching custom task attribute defintion failed!!")})),o&&widget.data&&"ENXROUT_AP"==widget.data.appId?new l((function(o,i){e.fetchRouteAndTaskByRouteId(t).then((e=>{o(e)}),(e=>{c(i,e)}))})):new l((function(o,i){u.fetchTaskFields().then((n=>{r.setTaskCustomFields(n),e.fetchRouteAndTaskByRouteId(t).then((e=>{o(e)}),(e=>{c(i,e)}))}),(e=>{console.log("fetching custom task attribute defintion failed!!")}))}))},getScopeInformation:function(e){return new l((function(t,i){o.getScopeInformation(e).then((e=>{t(e)}),(e=>{c(i,e)}))}))},fetchSecurityContext:function(){return new l((function(e,t){a.fetchSecurityContext().then((t=>{e(t)}),(e=>{c(t,e)}))}))},fetchAllowedContentTypesForRoute:function(){return new l((function(e,t){a.fetchAllowedContentTypesForRoute().then((t=>{e(t)}),(e=>{c(t,e)}))}))},updateState:function(t,o){return new l((function(i,n){e.updateState(t,o).then((e=>{i(e)}),(e=>{c(n,e)}))}))},updateTaskData:function(e,o,i){return new l((function(n,s){t.updateTaskData(e,o,i).then((e=>{n(e)}),(e=>{s(e)}))}))},stopRouteCheck:function(t){return new l((function(o,i){e.stopRouteCheck(t).then((e=>{o(e)}),(e=>{i(e)}))}))},deleteRoute:function(t){return new l((function(o,i){e.deleteRoute(t).then((e=>{o(e)}),(e=>{c(i,e)}))}))},updateReviewComment:function(e,o){return new l((function(i,n){t.updateReviewComment(e,o).then((e=>{i(e)}),(e=>{c(n,e)}))}))},fetchRouteTasks:function(t){return new l((function(o,i){e.fetchRouteTasks(t).then((e=>{o(e)}),(e=>{c(i,e);let t=document.querySelector(".wux-controls-abstract.wux-controls-loader.wux-font-3dsregular");null!=t&&(t.style.display="none")}))}))},fetchRouteContents:function(t){return new l((function(o,i){e.fetchRouteContents(t).then((e=>{o(e)}),(e=>{c(i,e)}))}))},getObjectTaxonomies:function(t){return new l((function(o,i){e.getObjectTaxonomies(t).then((e=>{o(e)}),(e=>{c(i,e)}))}))},fetchRouteContentIds:function(t){return new l((function(o,i){e.fetchRouteContentIds(t).then((e=>{o(e)}),(e=>{c(i,e)}))}))},fetchRouteMembers:function(t){return new l((function(o,i){e.fetchRouteMembers(t).then((e=>{o(e)}),(e=>{c(i,e)}))}))},fetchRouteHistory:function(t){return new l((function(o,i){e.fetchRouteHistory(t).then((e=>{o(e)}),(e=>{c(i,e)}))}))},createRoute:function(e){return new l((function(t,i){o.createRoute(e).then((e=>{t(e)}),(e=>{c(i,e)}))}))},saveAsRoute:function(e){return new l((function(t,i){o.saveAsRoute(e).then((e=>{t(e)}),(e=>{c(i,e)}))}))},downloadRouteContent:function(e){return new l((function(t,o){i.downloadRouteContent(e).then((e=>{t(e)}),(e=>{c(o,e)}))}))},addExistingRouteContent:function(e,t){return new l((function(o,n){i.addExistingRouteContent(e,t).then((e=>{o(e)}),(e=>{n(e)}))}))},addDraggedRouteContent:function(e,t,o){return new l((function(n,s){i.addDraggedRouteContent(e,t,o).then((e=>{n(e)}),(e=>{c(s,e)}))}))},getContentInfo:function(e){return new l((function(t,o){i.getContentInfo(e).then((e=>{t(e)}),(e=>{c(o,e)}))}))},fetchTypeDerivatives:function(e){return new l((function(t,o){i.fetchTypeDerivatives(e).then((e=>{t(e)}),(e=>{c(o,e)}))}))},changeAccess:function(e,t){return new l((function(o,i){n.changeAccess(e,t).then((e=>{o(e)}),(e=>{i(e)}))}))},deleteTask:function(e){return new l((function(o,i){t.deleteTask(e).then((e=>{o(e)}),(e=>{c(i,e)}))}))},changeAssignee:function(e,o){return new l((function(i,n){t.changeAssignee(e,o).then((e=>{i(e)}),(e=>{c(n,e)}))}))},getUserGroupPhysicalId:function(e){return new l((function(o,i){t.getUserGroupPhysicalId(e).then((e=>{o(e)}),(e=>{c(i,e)}))}))},saveAsTemplate:function(t,o){return new l((function(i,n){e.saveAsTemplate(t,o).then((e=>{i(e)}),(e=>{c(n,e)}))}))},getESignConfigSetting:function(){return new l((function(t,o){e.getESignConfigSetting().then((e=>{t(e)}),(e=>{c(o,e)}))}))},fetchTaskFields:function(){return new l((function(e,o){t.fetchTaskFields().then((t=>{e(t)}),(e=>{c(o,e)}))}))},fetchStateBlockingConditions:function(e){return new l((function(t,o){a.fetchStateBlockingConditions(e).then((e=>{t(e)}),(e=>{c(o,e)}))}))},updateRouteContentStateBlocking:function(e,t){return new l((function(o,n){i.updateRouteContentStateBlocking(e,t).then((e=>{o(e)}),(e=>{n(e)}))}))},fetchTaskAttachments:function(e,o){return new l((function(i,n){t.fetchTaskAttachments(e,o).then((e=>{i(e)}),(e=>{c(n,e)}))}))},fetchApprovalStatusForContent:function(t){return new l((function(o,i){e.fetchApprovalStatusForContent(t).then((e=>{o(e)}),(e=>{i(e)}))}))},removeSubRoute:function(t,o,i){return new l((function(n,s){e.removeSubRoute(t,o,i).then((e=>{n(e)}),(e=>{c(s,e)}))}))},fetchCredentials:function(t){return new l((function(o,i){e.fetchCredentials(t).then((e=>{o(e)}),(e=>{i(e)}))}))},getTypeFromPolicy:function(t){return new l((function(o,i){e.getTypeFromPolicy(t).then((e=>{o(e)}),(e=>{c(i,e)}))}))},assignAndStartFromUserGroup:function(e,o,i,n,s,a){return new l((function(r,l){t.assignAndStartFromUserGroup(e,o,i,n,s,a).then((e=>{r(e)}),(e=>{c(l,e)}))}))},fetchRouteTasksById:function(e,o,i){return new l((function(n,s){t.fetchRouteTasksById(e,o,i).then((e=>{n(e)}),(e=>{c(s,e)}))}))},fetchRouteCustomFields:function(){return new l((function(t,o){e.fetchRouteCustomFields().then((e=>{t(e)}),(e=>{c(o,e)}))}))},fetchRouteTemplateCustomFields:function(){return new l((function(t,o){e.fetchRouteTemplateCustomFields().then((e=>{t(e)}),(e=>{c(o,e)}))}))}},u})),define("DS/ENORouteMgmt/Utilities/RouteViewUtils",["DS/ENORouteMgmt/EnoviaBootstrap","DS/Controls/TooltipModel","DS/Windows/Dialog","DS/i3DXRDFGroupViewer/js/GroupViewer","DS/Windows/ImmersiveFrame","DS/ENORouteMgmt/Controller/RouteServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a){"use strict";let r=function(e){let t,o;if(e)return e.contains("(")?(t=e.split("(")[0],o=e.split("(")[1],t=t.toLowerCase().replace(/ /g,""),a[t]+" ("+o):(e=e.toLowerCase().replace(/ /g,""),e=a[e])},l=function(e){let t="";if(e)return e.contains("Awaiting")?t="hourglass":"Approved"==e?t="thumbs-up":"Commented"==e?t="comment":"Stopped"==e?t="stop":"Rejected"==e?t="thumbs-down":"Notified"==e?t="notification-read":"Not Started"==e?t="play-flash-off":"Abstained"==e&&(t="ignore"),t},d=function(e,t){try{if("routeTaskPanel"==t){let t=document.querySelectorAll("#priorityDiv .wux-button-label"),o=document.querySelectorAll("#taskPriorityId")[0].getChildren()[0].hasClassName("width-added");if(t&&t.length>0)if(o)if(e>300&&e<350)t.forEach((e=>{e.parentElement.hasAttribute("checked")?(e.classList.remove("hideLabelBlock"),e.classList.add("showLabelBlock")):(e.classList.remove("showLabelBlock"),e.classList.add("hideLabelBlock"))}));else{e<350?t.forEach((e=>{e.classList.remove("showLabelBlock"),e.classList.add("fullHideLabelBlock")})):t.forEach((e=>{e.classList.add("showLabelBlock"),e.classList.remove("fullHideLabelBlock")}))}else if(e>500&&e<550)t.forEach((e=>{e.parentElement.hasAttribute("checked")?(e.classList.remove("hideLabelBlock"),e.classList.add("showLabelBlock")):(e.classList.remove("showLabelBlock"),e.classList.add("hideLabelBlock"))}));else{e<500?t.forEach((e=>{e.classList.remove("showLabelBlock"),e.classList.add("fullHideLabelBlock")})):t.forEach((e=>{e.classList.add("showLabelBlock"),e.classList.remove("fullHideLabelBlock")}))}}}catch(e){}},u=function(e,t){if("initiateRoute"===t||"initiateRouteTemplate"===t){let t=document.querySelectorAll(".initiate-Route-Field");if(e<400)for(let e=0;e<t.length;e++)document.querySelectorAll(".initiate-Route-Field")[e].addClassName("width-added"),document.querySelectorAll(".initiate-Route-Field-Label")[e].addClassName("width-added"),document.querySelectorAll(".initiate-Route-Field-Value")[e].addClassName("width-added");else for(let e=0;e<t.length;e++)document.querySelectorAll(".initiate-Route-Field")[e].removeClassName("width-added"),document.querySelectorAll(".initiate-Route-Field-Label")[e].removeClassName("width-added"),document.querySelectorAll(".initiate-Route-Field-Value")[e].removeClassName("width-added")}if("initiateRouteTemplate"===t||"routeTaskPanel"==t){let t=document.querySelectorAll(".initiate-Route-Field-LinkedTemplate");if(e<400)for(let e=0;e<t.length;e++)document.querySelectorAll(".initiate-Route-Field-LinkedTemplate")[e].addClassName("width-added"),document.querySelectorAll(".initiate-Route-Field-Label-LinkedTemplate")[e].addClassName("width-added"),document.querySelectorAll(".initiate-Route-Field-Value-LinkedTemplate")[e].addClassName("width-added");else for(let e=0;e<t.length;e++)document.querySelectorAll(".initiate-Route-Field-LinkedTemplate")[e].removeClassName("width-added"),document.querySelectorAll(".initiate-Route-Field-Label-LinkedTemplate")[e].removeClassName("width-added"),document.querySelectorAll(".initiate-Route-Field-Value-LinkedTemplate")[e].removeClassName("width-added")}if("initiateRouteTemplateAppliesTo"===t||"routeTemplateAppliesTo"==t){let t=document.querySelectorAll(".initiate-Template-AppliesTo-Field");if(e<400)for(let e=0;e<t.length;e++)document.querySelectorAll(".initiate-Template-AppliesTo-Field")[e].addClassName("width-added"),document.querySelectorAll(".initiate-Template-AppliesTo-Field-Label")[e].addClassName("width-added"),document.querySelectorAll(".initiate-Template-AppliesTo-Field-Value")[e].addClassName("width-added");else for(let e=0;e<t.length;e++)document.querySelectorAll(".initiate-Template-AppliesTo-Field")[e].removeClassName("width-added"),document.querySelectorAll(".initiate-Template-AppliesTo-Field-Label")[e].removeClassName("width-added"),document.querySelectorAll(".initiate-Template-AppliesTo-Field-Value")[e].removeClassName("width-added")}if("routeTaskPanel"==t){let t=document.querySelectorAll(".initiate-Task-Field");if(e<400){for(let e=0;e<t.length;e++)document.querySelectorAll(".initiate-Task-Field")[e].addClassName("width-added"),document.querySelectorAll(".initiate-Task-Field-Label")[e].addClassName("width-added"),document.querySelectorAll(".initiate-Task-Field-Value")[e].addClassName("width-added");null!=document.querySelector(".initiate-Task-Assignee-Field")&&(document.querySelector(".initiate-Task-Assignee-Field").addClassName("width-added"),document.querySelector(".initiate-Task-Assignee-Field-Label").addClassName("width-added"),document.querySelector(".initiate-Task-Assignee-Field-Value").addClassName("width-added"))}else{for(let e=0;e<t.length;e++)document.querySelectorAll(".initiate-Task-Field")[e].removeClassName("width-added"),document.querySelectorAll(".initiate-Task-Field-Label")[e].removeClassName("width-added"),document.querySelectorAll(".initiate-Task-Field-Value")[e].removeClassName("width-added");null!=document.querySelector(".initiate-Task-Assignee-Field.width-added")&&(document.querySelector(".initiate-Task-Assignee-Field.width-added").removeClassName("width-added"),document.querySelector(".initiate-Task-Assignee-Field-Label.width-added").removeClassName("width-added"),document.querySelector(".initiate-Task-Assignee-Field-Value.width-added").removeClassName("width-added"))}if(null!=document.querySelector("#RouteImmersiveFrame #InitiateTaskCreatePropertiesBody")&&document.querySelector("#RouteImmersiveFrame .right-container.with-left-border")&&document.querySelector("#RouteImmersiveFrame .right-container.with-left-border").clientWidth>0){let e=screen.width<450;document.querySelector("#RouteImmersiveFrame .right-container").clientWidth<215&&!e?(document.querySelector("#RouteImmersiveFrame .right-container").addClassName("width-Ulter"),document.querySelector("#RouteImmersiveFrame .left-container").addClassName("width-Ulter")):(document.querySelector("#RouteImmersiveFrame").clientWidth>560||e||null!=document.querySelector("#RouteImmersiveFrame .left-container")&&0==document.querySelector("#RouteImmersiveFrame .left-container").clientWidth)&&(document.querySelector("#RouteImmersiveFrame .right-container").removeClassName("width-Ulter"),document.querySelector("#RouteImmersiveFrame .left-container").removeClassName("width-Ulter"))}}};return{getRouteActivityState:e=>function(e){let t=e.Activity_State,o=r(t),i={icon:l(t),label:o};return t&&t.contains("your")?(i.func=function(e){widget.data.openTaskProperties=!0,widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:e.context.nodeModel.options.grid})},i.icon+=" awaiting-tasks"):i.func=void 0,i}(e),getRemoveRouteActivityState:e=>function(e){let t=e.Activity_State,o=r(t);return{icon:l(t),label:o}}(e),getRouteActivityStateNLS:e=>r(e),getRouteActivityStateIcon:e=>l(e),getRouteRevision:e=>function(e){return{label:e.revision,icon:" ",func:function(t){require(["DS/ENORouteMgmt/Actions/RouteActions"],(function(t){t.renderRevisionsDialog(e.id)}))}}}(e),getRemoveRouteRevision:e=>function(e){return{label:e.revision,icon:" "}}(e),getRouteActions:e=>function(e){var t=[];return e?(-1!==e.indexOf("edit.startroute")&&t.push(a.start),-1!==e.indexOf("edit.stoproute")&&t.push(a.stop),-1!==e.indexOf("edit.resumeroute")&&t.push(a.resume),-1!==e.indexOf("edit.restartroute")&&t.push(a.restart),t):t}(e),getRouteActionIcon:e=>function(e){let t={};if(e)return-1!==e.indexOf("edit.startroute")&&(t.name="status-change",t.color="orange"),-1!==e.indexOf("edit.stoproute")&&(t.name="stop",t.color="red"),t}(e),isRouteActionStart:e=>function(e){return-1!==e.indexOf("edit.startroute")}(e),getAvatarDetails:e=>function(e){var t={},o="NA",i="rgb( 245,100,163 )",n=[[7,139,250],[249,87,83],[111,188,75],[158,132,106],[170,75,178],[26,153,123],[245,100,163],[255,138,46]],s=e.replace(/  +/g," ").trim().split(" "),a=s[0].toUpperCase(),r=s[s.length-1].toUpperCase();if(null!=a[0]&&null!=r[0]){o=a[0]+r[0];var l=Math.ceil((a.charCodeAt(0)+r.charCodeAt(0))%n.length);i="rgb("+n[l][0]+","+n[l][1]+","+n[l][2]+")"}return t.name=e,t.avatarStr=o,t.avatarColor=i,t}(e),getDeleteAccess:e=>function(e){let t;return t="FALSE"==e.DeleteAccess||"Completed"==e.Maturity_State?{icon:"wrong wux-ui-3ds"}:{icon:"check wux-ui-3ds"},t}(e),getLockColumn:t=>function(t){let o;if("TRUE"===t.reserved){let i=e.getLoginUserFullName();if(t.reservedBy===i)o=UWA.createElement("div",{class:"fonticon fonticon-key reservations-key route-content-key",title:a.lockedByMe});else{let e=a.replace(a.lockedByUser,{tag1:t.reservedBy});o=UWA.createElement("div",{class:"fonticon fonticon-lock reservations-lock route-content-lock",title:e})}}else o=UWA.createElement("div",{class:"route-content-unlocked",title:a.unlocked});return o}(t),createNewElement:(e,t)=>function(e,t){return new UWA.Element("div",{class:e}).inject(t)}(e,t),createTooltipElement:(e,o,i)=>function(e,o,i){let n;return n=UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-info fonticon-display fonticon-color-display routeNameInfo",id:e}).inject(i),n.tooltipInfos=new t({shortHelp:o,allowUnsafeHTMLShortHelp:!0}),n}(e,o,i),getElementToolTip:e=>function(e){return new t({shortHelp:e,allowUnsafeHTMLShortHelp:!1})}(e),makeResponsiveCss:(e,t)=>function(e,t){const o=new ResizeObserver((t=>{console.log("called.......");for(const o of t){const{width:t,height:i}=o.contentRect;u(t,e),d(t,e)}})),i=document.querySelectorAll(t);for(let e=0;e<i.length;e++)i[e].clientWidth>0&&o.observe(i[e])}(e,t),launchPreviewGroupMembers:t=>function(t){let s=new n;s.inject(document.body);var r=e.getSecurityContextValue().split("::")[1],l={platformId:e.getTenantValue(),groupId:t,language:e.getCurrentLanguage()};if(null==e.getSwymUrl()&&(l.securityContext=r),i){var d=new i(l);new o({modalFlag:!0,width:500,height:600,minHeight:350,resizableFlag:!0,className:"group-viewer",title:a.groupMembers,content:d.render(),immersiveFrame:s}).show()}}(t),fetchCredentials:e=>function(e){return new Promise((function(t,o){s.fetchCredentials(e).then((e=>{t(e)}),(e=>{o(e)}))}))}(e)}})),define("DS/ENORouteMgmt/Views/RouteRelatedObjInfo",["DS/EditPropWidget/facets/Common/FacetsBase","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Utilities/RouteViewUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n){"use strict";let s,a,r,l;var d=e.extend({init:function(){this._parent.apply(this,arguments),this.elements.container=new UWA.Element("div",{id:"RelatedObjectFields",class:""})},updateFacet:function(){let e=this,i=e.getModel();if(1==i.isMergedModel())return;if(!i)return!1;let n=i.get("objectId");t.fetchRouteById(n).then((function(t){e.elements.container.setContent("");let i={};t&&t.length>0&&(i=o.gridData(t[0]));let n=p(i);n.routeTemplate.inject(e.elements.container),n.linkedRouteTemplate.inject(e.elements.container),n.routeScope.inject(e.elements.container),n.selectUsersFromUserGroup.inject(e.elements.container)}))},destroyComponent:function(){},onResize:function(){},onRefresh:function(){}});let u=function(e,t){return i.createNewElement(e,t)},c=function(e){return i.getElementToolTip(e)},p=function(e){i.makeResponsiveCss("initiateRoute","#RelatedObjectFields");let t={};t.routeTemplate=new UWA.Element("div",{class:"related-object-display"}),s=u("initiate-Route-Field",t.routeTemplate),a=u("initiate-Route-Field-Label",s),r=new UWA.Element("div").inject(s),r.style.width="2%",l=u("initiate-Route-Field-Value",s);let o=new UWA.Element("h5",{html:n.infoRelationTabTemplate+"&nbsp;:",class:"rel-obj-info-label"}).inject(a);o.tooltipInfos=c(n.infoRelationTabTemplate);let d=new UWA.Element("span",{html:e.TemplateTitle,class:"rel-obj-info-span"}).inject(l);d.addClassName("valueReadOnly"),d.tooltipInfos=c(e.TemplateTitle),t.linkedRouteTemplate=new UWA.Element("div",{class:"related-object-display"}),s=u("initiate-Route-Field",t.linkedRouteTemplate),a=u("initiate-Route-Field-Label",s),r=new UWA.Element("div").inject(s),r.style.width="2%",l=u("initiate-Route-Field-Value",s),o=new UWA.Element("h5",{html:n.linkedRouteTemplate+"&nbsp;:",class:"rel-obj-info-label"}).inject(a),o.tooltipInfos=c(n.linkedRouteTemplate);let p=new UWA.Element("span",{html:e.linkedRouteTemplateTitle,class:"rel-obj-info-span"}).inject(l);p.addClassName("valueReadOnly"),p.tooltipInfos=c(e.linkedRouteTemplateTitle),t.routeScope=new UWA.Element("div",{class:"related-object-display"}),s=u("initiate-Route-Field",t.routeScope),a=u("initiate-Route-Field-Label",s),r=new UWA.Element("div").inject(s),r.style.width="2%",l=u("initiate-Route-Field-Value",s),o=new UWA.Element("h5",{html:n.infoRelationTabScope+"&nbsp;:",class:"rel-obj-info-label"}).inject(a),o.tooltipInfos=c(n.infoRelationTabScope);let m=e.Scope[0];"All"!=e.Scope[0]&&"Organization"!=e.Scope[0]||(m=n[m]),new UWA.Element("span",{html:m,class:"rel-obj-info-span"}).inject(l).addClassName("valueReadOnly");var g=n.no;return e.selectUsersFromUserGroup&&"True"==e.selectUsersFromUserGroup&&(g=n.yes),t.selectUsersFromUserGroup=new UWA.Element("div",{class:"related-object-display"}),s=u("initiate-Route-Field",t.selectUsersFromUserGroup),a=u("initiate-Route-Field-Label",s),r=new UWA.Element("div").inject(s),r.style.width="2%",l=u("initiate-Route-Field-Value",s),new UWA.Element("h5",{html:n.ChooseUsersFromUG+"&nbsp;:",class:"rel-obj-info-label"}).inject(a).tooltipInfos=c(n.ChooseUsersFromUG),new UWA.Element("span",{html:g,class:"rel-obj-info-span"}).inject(l).addClassName("valueReadOnly"),t};return d})),define("DS/ENORouteMgmt/Model/RouteModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/EnoviaBootstrap","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/Components/TagNavigator","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l){"use strict";let d,u=new e,c=function(e,t,o,i){var n,s=l["state_"+e];return n=UWA.createElement("div",{class:"route-task-state-and-assignee"}),UWA.createElement("span",{html:s,class:"route-state-title "+e.toUpperCase().replace(/ /g,"")}).inject(n),"Stopped"==o&&UWA.createElement("span",{html:l[o],class:"route-state-status "+o.replace(/ /g,"")}).inject(n),t.setStyle("display","inline"),t.setStyle("padding-left","3px"),t.set({title:i}),t.inject(n),n.outerHTML},p=function(e,i){u.prepareUpdate();var r=new UWA.Element("div",{class:"members"}),d="",p=e.assignees;if(void 0!==p)for(var m=0;m<p.length;m++){let e=p[m].split("~"),t=e[0],o=e[1],i=e[2];if(""!=p[m]&&"Collab Space"!=t){var g=new UWA.Element("div",{class:"assignee"});let e="";if("Person"==t){let t;t="/api/user/getpicture/login/"+o+"/format/normal";let s=n.getSwymUrl()+t;if(d=d+i+",\n",null!=n.getSwymUrl())e=UWA.createElement("img",{class:"userIcon",src:s});else{var f=a.getAvatarDetails(i);e=UWA.createElement("div",{html:f.avatarStr,class:"avatarIcon"}),e.style.setProperty("background",f.avatarColor)}}"User Group"==t&&(d=d+i+",\n",e=UWA.createElement("img",{class:"userIcon",src:s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png")})),""!=e&&e.inject(g),g.inject(r)}}d=d.slice(0,-2),r.set({title:d}),e.assigneesdiv=r.outerHTML;var v=o.gridData(e);v.Activity_StateNLS=a.getRouteActivityState(v),v.revisionValue=a.getRouteRevision(v);var S=new t({label:e.title,id:e.id,width:300,grid:v,thumbnail:s.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_Route108x144.png"),subLabel:l[e.routeBasePurpose],description:c(e.state,r,e.routeStatus,d),icons:[s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_Route16.png")],contextualMenu:["My context menu"],customTooltip:w(v)});return S.options.getAttributeValueForFiltering=function(e){switch(e){case"label":return v.Title;case"Activity_StateNLS":return v.Activity_StateNLS.label;case"revisionValue":return v.revisionValue.label;case"AssigneesDiv":const t=v.Assignees.map((e=>e.split("~")[2]));return 0==t.length?"":t;default:return v[e]}},u.getXSO().add(S),u.addChild(S,0),u.unselectAll(),u.pushUpdate(),h(),void 0!==i&&0==i||widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:o.gridData(e)}),S},m=function(e){return i.getRowModelById(u,e)},g=function(e){0==f()&&widget.routeMgmtMediator.publish("show-no-route-placeholder",e)},f=function(){let e=0;return u.getChildren().forEach((t=>{t._isHidden||e++})),e},h=function(){0!=f()&&widget.routeMgmtMediator.publish("hide-no-route-placeholder")},w=function(e){return l.title+": "+e.Title+"\n"+l.name+": "+e.Name+"\n"+l.revision+": "+e.revision+"\n"+l.IDcardMaturityState+": "+e.Maturity_State+"\n"+l.routeBasePurpose+": "+e.BasePurposeNLS+"\n"+l.activity_state+": "+e.Activity_StateNLS.label+"\n"+l.IDcardOwner+": "+e.Owner},v=function(){widget.routeMgmtMediator.subscribe("route-DataGrid-on-dblclick",(function(e){d=e})),widget.routeMgmtMediator.subscribe("route-back-to-summary",(function(e){d=void 0,widget.setValue("routeIdToBePersisted",void 0)})),widget.routeMgmtMediator.subscribe("route-data-updated",(function(e){d={model:o.gridData(e)}})),u.subscribe({event:"filter"},(function(){setTimeout((function(){var e=[];u.__visibilityMap__&&u.__visibilityMap__.forEach(((t,o)=>{!0===t?e.push(o.options.id):o.unselect()})),r.getSearchResult({},e),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:u})}),1e3)}))};return{createModel:i=>function(i){return u=new e,u.prepareUpdate(),i.forEach((function(e){var i=new UWA.Element("div",{class:"members"}),r="",d=e.assignees;if(void 0!==d)for(var p=0;p<d.length;p++){let e=d[p].split("~"),t=e[0],o=e[1],l=e[2];if(""!=d[p]&&"Collab Space"!=t){var m=new UWA.Element("div",{class:"assignee"});let e="";if("Person"==t){let t;t="/api/user/getpicture/login/"+o+"/format/normal";let i=n.getSwymUrl()+t;if(r=r+l+",\n",null!=n.getSwymUrl())e=UWA.createElement("img",{class:"userIcon",src:i});else{var g=a.getAvatarDetails(l);e=UWA.createElement("div",{html:g.avatarStr,class:"avatarIcon"}),e.style.setProperty("background",g.avatarColor)}}"User Group"==t&&(r=r+l+",\n",e=UWA.createElement("img",{class:"userIcon",src:s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png")})),""!=e&&e.inject(m),m.inject(i)}}r=r.slice(0,-2),i.set({title:r}),e.assigneesdiv=i.outerHTML;var f=o.gridData(e);f.Activity_StateNLS=a.getRouteActivityState(f),f.revisionValue=a.getRouteRevision(f);var h=new t({label:e.title,id:e.id,width:300,grid:f,thumbnail:s.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_Route108x144.png"),subLabel:l[e.routeBasePurpose],description:c(e.state,i,e.routeStatus,r),icons:[s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_Route16.png")],contextualMenu:["My context menu"],shouldAcceptDrop:!0,customTooltip:w(f)});h.options.getAttributeValueForFiltering=function(e){switch(e){case"label":return f.Title;case"Activity_StateNLS":return f.Activity_StateNLS.label;case"revisionValue":return f.revisionValue.label;case"AssigneesDiv":const t=f.Assignees.map((e=>e.split("~")[2]));return 0==t.length?"":t;default:return f[e]}},u.addRoot(h)})),u.setFilterModel({label:{filterId:"stringRegexp"},Name:{filterId:"stringRegexp"},Maturity_State:{filterId:"set"},BasePurposeNLS:{filterId:"set"},Activity_StateNLS:{filterId:"set"},Description:{filterId:"stringRegexp"},revisionValue:{filterId:"set"},AssigneesDiv:{filterId:"set"},Owner:{filterId:"set"}}),u.pushUpdate(),v(),u}(i),appendRows:(e,t)=>p(e,t),updateRow:e=>function(e){var t=new UWA.Element("div",{class:"members"}),i="",r=e.assignees;if(void 0!==r)for(var d=0;d<r.length;d++){let e=r[d].split("~"),o=e[0],l=e[1],u=e[2];if(""!=r[d]&&"Collab Space"!=o){var p=new UWA.Element("div",{class:"assignee"});let e="";if("Person"==o){let t;t="/api/user/getpicture/login/"+l+"/format/normal";let o=n.getSwymUrl()+t;if(i=i+u+",\n",null!=n.getSwymUrl())e=UWA.createElement("img",{class:"userIcon",src:o});else{var g=a.getAvatarDetails(u);e=UWA.createElement("div",{html:g.avatarStr,class:"avatarIcon"}),e.style.setProperty("background",g.avatarColor)}}"User Group"==o&&(i=i+u+",\n",e=UWA.createElement("img",{class:"userIcon",src:s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png")})),""!=e&&e.inject(p),p.inject(t)}}if(i=i.slice(0,-2),t.set({title:i}),e.assigneesdiv=t.outerHTML,e.id&&""!=e.id){var f=m(e.id),h=o.gridData(e);h.Activity_StateNLS=a.getRouteActivityState(h),h.revisionValue=a.getRouteRevision(h),f.updateOptions({grid:h}),f.updateOptions({label:e.title,subLabel:l[e.routeBasePurpose],description:c(e.state,t,e.routeStatus,i),customTooltip:w(h)}),f.options.getAttributeValueForFiltering=function(e){switch(e){case"label":return h.Title;case"Activity_StateNLS":return h.Activity_StateNLS.label;case"revisionValue":return h.revisionValue.label;case"AssigneesDiv":const t=h.Assignees.map((e=>e.split("~")[2]));return 0==t.length?"":t;default:return h[e]}};let n=u.getFilterManager();["label","Maturity_State","Activity_StateNLS","Description","revisionValue","AssigneesDiv","Owner"].forEach((function(e){n.reapplyPropertyFilterModel(e)}))}}(e),getModel:()=>u,getSelectedRowsModel:()=>i.getSelectedRowsModel(u),getRowModelById:e=>m(e),getRowModelIndexById:e=>i.getRowModelIndexById(u,e),deleteRowModelByIndex:e=>function(e){i.deleteRowModelByIndex(u,e),g(u)}(e),deleteRowModelSelected:()=>function(){let e=i.deleteRowModelSelected(u);return g(u),e}(),deleteRowModelById:e=>function(e){i.deleteRowModelById(u,e),g(u)}(e),deleteRowModelByIds:e=>function(e){i.deleteRowModelByIds(u,e),g(u)}(e),destroy:()=>{u=new e},getOpenedRouteModel:()=>d,appendAllRows:e=>{return t=e,u.prepareUpdate(),t.forEach((e=>{var t=p(e,!1);u.addRoot(t)})),void u.pushUpdate();var t}}})),define("DS/ENORouteMgmt/Utilities/RouteRefreshUtils",["DS/ENORouteMgmt/Controller/RouteServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";return{refreshRouteData:function(o){let i,n="Route";i=o.id,o.model&&(n=o.model.Type),e.fetchRouteById(i,n).then((e=>{"Route Template"==e[0].type?widget.routeMgmtMediator.publish("template-data-updated",e[0]):widget.routeMgmtMediator.publish("route-data-updated",e[0])}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:t.infoRefreshError,sticky:!1})}))}}})),define("DS/ENORouteMgmt/Views/Dialogs/ChangeAssignee",["DS/WAFData/WAFData","DS/Windows/Dialog","DS/Controls/LineEditor","DS/Controls/Editor","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Utilities/RouteRefreshUtils","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Views/Loader/ChangeTaskAssigneeChooser","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Views/Form/TaskProperties","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,l,p,m,g){let f,h,w=m.getTaskVaribles(),v=function(e){let o=new n;o.inject(document.body);let a=new UWA.Element("div",{id:"assigneeWarning",class:""});f.formFields=new UWA.Element("div",{id:"changeAssigneeWarning",class:""});let l=e.options.grid.title;l=(l.length>40?l.substring(0,37)+"...":l)+" : "+("TRUE"==e.options.grid.routeOwnerTask?g.selectAssignee:g.changeAssignee),f.assigneeField=new UWA.Element("div",{id:"SearchAssigneeField",class:"fonticon-chooser-display"}),f.fields={},f.formFields.inject(a);let m=new UWA.Element("h5",{class:"required",text:g.taskAssignee}).inject(f.formFields);UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(m);var v={isMultiSearchMode:!1};v.placeHolderValue=g.typeToSearch,v.minLengthToType=3,v.isFreeInputAllowed=!1,v.toKeepSearchResultsFlag=!1,"OnPremise"!=p.getTenantValue()&&(v.source=["3dspace","usersgroup"]),v.getPrecond=function(){return d.getPrecondForChangeAssigneeSearch(h,e)},v.getChangeHandler=function(){return d.changeHandlerForChangeAssigneeSearch(f)},f.fields.taskAssigneeField=c.drawAutoCompleteComponent(v),f.fields.taskAssigneeField.inject(f.assigneeField),new UWA.Element("div",{html:"&nbsp;"}).inject(f.assigneeField),f.fields.taskAssigneeChooser=new s({icon:{iconName:"search"}}),f.fields.taskAssigneeChooser.inject(f.assigneeField),f.fields.taskAssigneeChooser.getContent().addEventListener("buttonclick",(function(){if("undefined"!=typeof dscef){let e={taskProperties:f,taskGraphModel:void 0,invokeFrom:"dialog"};widget.routeMgmtMediator.publish("launch-task-assignee-search",e)}else d.launchAssigneeSearch(event,h,f,e)})),f.assigneeField.inject(f.formFields),new UWA.Element("h5",{text:g.assigneecomments}).inject(f.formFields),f.fields.descField=new i({widthInCharNumber:51,nbRows:5,newLineMode:"enter"}),f.fields.descField.inject(f.formFields),new t({modalFlag:!0,width:500,height:300,title:l,content:a,domId:"RouteImmersiveFrame",immersiveFrame:o,buttons:{Ok:new s({disabled:!1,onClick:function(t){var o;t.dsModel.dialog;f.fields.taskAssigneeField.selectedItems&&f.fields.taskAssigneeField.selectedItems.options&&(o=f.fields.taskAssigneeField.selectedItems.options.value);var i=e.options.grid.assigneePID;if(null!=o)if(o.contains("uuid:")&&!i.contains("uuid:"))u.getUserGroupPhysicalId(o).then((i=>{o=i.ObjIds[0],e.options.grid.assigneeId!=o?("ENOTASK_AP"==widget.getValue("appId")&&null!=w.collabTaskModel&&w.collabTaskModel.preSave&&w.collabTaskModel.preSave(),u.changeAssignee(e,f).then((o=>{t.dsModel.dialog.close(),widget.notify.handler().addNotif({level:"success",subtitle:g.replace(g.successChangeTaskAssignee,{tag1:o[0].taskAssigneeName}),sticky:!0,allowUnsafeHTML:!1}),"ENOTASK_AP"==widget.getValue("appId")&&null!=w.collabTaskModel&&(w.collabTaskModel.set("inboxTaskModified",!1),w.collabTaskModel.postSave&&w.collabTaskModel.postSave("true","closePanel")),widget.routeMgmtMediator.publish("route-task-on-change-assignee",o[0]),r.refreshRouteData(e.routePropertiesInfo),widget.data.inboxTaskSelectedId=o[0].taskId,widget.routeMgmtMediator.publish("redraw-graph",e.options.grid)}),(e=>{if("ENOTASK_AP"==widget.getValue("appId")&&null!=w.collabTaskModel&&w.collabTaskModel.postSave&&w.collabTaskModel.postSave("false"),e&&e.error&&-1!=e.error.indexOf("System Error: #5000001:")){var t=e.error.replace("System Error: #5000001:","");widget.notify.handler().addNotif({level:"error",subtitle:t,sticky:!1})}else e&&e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:g.changeAssigneeError,sticky:!1})}))):widget.notify.handler().addNotif({level:"error",subtitle:g.taskNewAssignee,sticky:!0})}),(e=>{}));else{if(i==o&&"TRUE"!=e.options.grid.routeOwnerTask)return void widget.notify.handler().addNotif({level:"error",subtitle:g.taskNewAssignee,sticky:!0});"ENOTASK_AP"==widget.getValue("appId")&&null!=w.collabTaskModel&&w.collabTaskModel.preSave&&w.collabTaskModel.preSave(),u.changeAssignee(e,f).then((o=>{t.dsModel.dialog.close(),widget.notify.handler().addNotif({level:"success",subtitle:g.replace(g.successChangeTaskAssignee,{tag1:o[0].taskAssigneeName}),sticky:!0,allowUnsafeHTML:!1}),"ENOTASK_AP"==widget.getValue("appId")&&null!=w.collabTaskModel&&(w.collabTaskModel.set("inboxTaskModified",!1),w.collabTaskModel.postSave&&w.collabTaskModel.postSave("true","closePanel")),widget.routeMgmtMediator.publish("route-task-on-change-assignee",o[0]),r.refreshRouteData(e.routePropertiesInfo),widget.data.inboxTaskSelectedId=o[0].taskId,widget.routeMgmtMediator.publish("redraw-graph",e.options.grid)}),(e=>{if("ENOTASK_AP"==widget.getValue("appId")&&null!=w.collabTaskModel&&w.collabTaskModel.postSave&&w.collabTaskModel.postSave("false"),e&&e.error&&-1!=e.error.indexOf("System Error: #5000001:")){var t=e.error.replace("System Error: #5000001:","");widget.notify.handler().addNotif({level:"error",subtitle:t,sticky:!1})}else e&&e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:g.changeAssigneeError,sticky:!1})}))}else widget.notify.handler().addNotif({level:"error",subtitle:g.errorTaskAssignee,sticky:!0})}}),Cancel:new s({onClick:function(e){e.dsModel.dialog.close()}})}}).addEventListener("close",(function(e){try{o&&"undefined"!=typeof dscef?(o.elements.container.setStyle("height","1px"),o.elements.container.setStyle("width","1px")):o&&o.destroy()}catch(e){console.log("Error while destroying the change assignee dialog -immersive frame")}}))};return{changeAssignee:e=>function(e){h=e.routePropertiesInfo,f={},v(e)}(e)}})),define("DS/ENORouteMgmt/Views/Dialogs/InitiateChangeAssignee",["DS/ENORouteMgmt/Views/Dialogs/ChangeAssignee","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Components/Notifications","DS/ENORouteMgmt/Components/Mediator","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n){let s=function(e,t){return e.options={},e.options.grid={},e.options.grid.id=t.taskId,e.options.grid.title=t.taskTitle,e.options.grid.assigneePID=t.assigneePID,e.options.grid.routeOwnerTask=t.routeOwnerTask,e.options.grid.routeOwnerUGChoice=t.routeOwnerUGChoice,e.options.grid.routeOwnerUGName=t.routeOwnerUGName,e.options.grid.type=t.type,e},a=function(e,t){return e.routePropertiesInfo={},e.routePropertiesInfo.model={},e.routePropertiesInfo.id=t.routeId,e.routePropertiesInfo.model.Scope=t.Scope,e.routePropertiesInfo.model.ScopeMembers=t.ScopeMembers,e};return{init:r=>function(r){var l,d={};widget.notify=new o,t.start({id:widget.id}),widget.routeMgmtMediator=new i,r.collabspace&&r.collabstorage?(widget.data.routeCredentials={securityContext:r.collabspace,tenant:r.collabstorage},r.noSecurityContextForSearch&&(widget.data.routeCredentials.noSecurityContextForSearch=r.noSecurityContextForSearch)):widget.data.routeCredentials={securityContext:widget.getPreference("collabspace").value,tenant:widget.getPreference("collabstorage").value},widget&&widget.data&&widget.data.noSecurityContextForSearch&&(widget.data.routeCredentials.noSecurityContextForSearch=widget.data.noSecurityContextForSearch),null==r.taskId||""==r.taskId||null==r.taskTitle||""==r.taskTitle?l=n.taskErrorMessage:"TRUE"!=r.routeOwnerTask||null==r.routeOwnerUGChoice||""==r.routeOwnerUGChoice||null!=r.routeOwnerUGName&&""!=r.routeOwnerUGName?r.Scope&&3!=r.Scope.length&&(l=n.scopeError):l=n.userGroupErrorMessage,null==l?(d=s(d,r),d=a(d,r),e.changeAssignee(d)):widget.notify.handler().addNotif({level:"error",subtitle:l,sticky:!1})}(r)}})),define("DS/ENORouteMgmt/Views/Grid/RouteGridCustomColumns",["DS/Controls/Button","DS/Controls/TooltipModel","DS/ENORouteMgmt/EnoviaBootstrap","UWA/Drivers/Alone","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/Views/Dialogs/RouteLifeCycleDialogue","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Model/RouteModel","DS/WebappsUtils/WebappsUtils","DS/TransientWidget/TransientWidget","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d,u){"use strict";let c=function(e){let t="",i=e[0],s=e[1],a=e[2],r=e[3];if("Person"==i){let e;e="/api/user/getpicture/login/"+s+"/format/normal";let i=o.getSwymUrl()+e;var u=a+"\n";if(null!=o.getSwymUrl())t=UWA.createElement("img",{class:"userIcon",src:i,title:u,styles:{cursor:"pointer"}}),t.removeEvents(),t.addEvent("click",(function(e){d.showWidget("X3DPRFL_AP","",{login:s,url:o.getSwymUrl()+"?profile="+s},{mode:"panel",height:700,width:800})}));else{var c=n.getAvatarDetails(a);t=UWA.createElement("div",{html:c.avatarStr,class:"avatarIcon",title:u,styles:{cursor:"pointer"}}),t.removeEvents(),t.addEvent("click",(function(e){var t={_context:o.getSecurityContextValue(),_selection:[{getID:function(){return r}}],getSecurityContext:function(){return this._context},getSelectedNodes:function(){return this._selection},displayNotification:function(){}};require(["DS/LifecycleControls/EditPropDialog"],(function(e){(new e).launchProperties(t)}))})),t.style.setProperty("background",c.avatarColor)}}if("Group"===i||"User Group"===i||"Group Proxy"===i){u=a+"\n";let o=e[4];t=UWA.createElement("img",{class:"userIcon",src:l.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png"),title:u,styles:{cursor:"pointer"}}),t.removeEvents(),t.addEvent("click",(function(e){n.launchPreviewGroupMembers(o)}))}return t},p=function(e){var t=e.nodeModel.options.grid.Assignees,i=new UWA.Element("div",{id:"noassignee",class:"no-assignee-class",html:""});if(t.length>0){var n=function(e){var t=new UWA.Element("div",{class:"members"}),i=e;if(void 0!==i)for(var n=0;n<i.length;n++){let e=i[n].split("~"),s=e[0];o.getSwymUrl(),""!=i[n]&&"Collab Space"!=s&&new UWA.Element("div",{class:"assignee",html:c(e)}).inject(t)}return t}(t);e.cellView.setReusableContent(n)}else 0==t.length&&e.cellView.setReusableContent(i)};return{onRouteNodeStateCellRequest:e=>function(e){let t;if(!e.isHeader&&(t=e.cellView.collectionView.reuseCellContent("_state_"),t)){t.getChildren()[0].removeEvents();let o=e.nodeModel.options.grid.state;t.getChildren()[0].setHTML(e.nodeModel.options.grid.Maturity_State),t.getChildren()[0].setAttribute("class","route-state-title "+o.toUpperCase().replace(/ /g,"")),t.getChildren()[0].addEvent("click",(function(e){var t=r.getSelectedRowsModel(),o=a.gridData(t.data[0].options.grid);s.lifeCycle(o)})),e.cellView._setReusableContent(t)}}(e),onRemoveRouteNodeStateCellRequest:e=>function(e){let t;if(!e.isHeader&&(t=e.cellView.collectionView.reuseCellContent("_state_"),t)){let o=e.nodeModel.options.grid.state;t.getChildren()[0].setHTML(e.nodeModel.options.grid.Maturity_State),t.getChildren()[0].setAttribute("class","route-state-title "+o.toUpperCase().replace(/ /g,"")),t.setStyle("cursor","default"),e.cellView._setReusableContent(t)}}(e),onRouteNodeAssigneesCellRequest:e=>p(e),onRouteNodeActionCellRequest:e=>function(e){let o;e.isHeader||(o=e.cellView.collectionView.reuseCellContent("_actions_"),o&&require(["DS/ENORouteMgmt/Views/Menu/RouteContextualMenu"],(function(i){var n=[];n.push(e.nodeModel.options.grid.id),o.setHTML(i.routeGridCheveron(e.nodeModel.options.grid.Actions,n)),o.tooltipInfos=new t({shortHelp:u.actions,allowUnsafeHTMLShortHelp:!0}),o.setStyle(),e.cellView._setReusableContent(o)})))}(e),onRouteNodeOwnerCellRequest:e=>function(e){let t;if(!e.isHeader&&(t=e.cellView.collectionView.reuseCellContent("_owner_"),t)){t.removeEvents();var i=e.nodeModel.options.grid.OwnerFullName,s=e.nodeModel.options.grid.UserName,a=e.nodeModel.options.grid.OwnerId,r="/api/user/getpicture/login/"+s+"/format/normal",l=n.getAvatarDetails(i),u=o.getSwymUrl()+r;null!=o.getSwymUrl()?(t.getChildren()[0].getChildren()[0].src=u,t.setStyle("cursor","pointer"),t.addEvent("click",(function(e){d.showWidget("X3DPRFL_AP","",{login:s,url:o.getSwymUrl()+"?profile="+s},{mode:"panel",height:700,width:800})}))):(t.getChildren()[0].getChildren()[0].setHTML(l.avatarStr),t.getChildren()[0].getChildren()[0].setStyle("background",l.avatarColor),t.setStyle("cursor","pointer"),t.addEvent("click",(function(e){var t={_context:o.getSecurityContextValue(),_selection:[{getID:function(){return a}}],getSecurityContext:function(){return this._context},getSelectedNodes:function(){return this._selection},displayNotification:function(){}};require(["DS/LifecycleControls/EditPropDialog"],(function(e){(new e).launchProperties(t)}))}))),t.getChildren()[1].setText(i),e.cellView._setReusableContent(t)}}(e),onRouteContentOwnerByCellRequest:e=>function(e){if(!e.isHeader){var t=e.nodeModel.options.grid.Owner;if(null!=t&&""!=t){let u=e.cellView.collectionView.reuseCellContent("_owner_");if(u){u.removeEvents();var i=e.nodeModel.options.grid.ownerName,s=e.nodeModel.options.grid.ownerId;""==i&&(i=void 0);var a="/api/user/getpicture/login/"+i+"/format/normal",r=n.getAvatarDetails(t),l=o.getSwymUrl()+a;null!=o.getSwymUrl()?(u.getChildren()[0].getChildren()[0].src=l,u.setStyle("cursor","pointer"),u.addEvent("click",(function(e){d.showWidget("X3DPRFL_AP","",{login:i,url:o.getSwymUrl()+"?profile="+i},{mode:"panel",height:700,width:800})}))):(u.getChildren()[0].getChildren()[0].setHTML(r.avatarStr),u.getChildren()[0].getChildren()[0].setStyle("background",r.avatarColor),u.setStyle("cursor","pointer"),u.addEvent("click",(function(e){var t={_context:o.getSecurityContextValue(),_selection:[{getID:function(){return s}}],getSecurityContext:function(){return this._context},getSelectedNodes:function(){return this._selection},displayNotification:function(){}};require(["DS/LifecycleControls/EditPropDialog"],(function(e){(new e).launchProperties(t)}))}))),u.getChildren()[1].setText(t),e.cellView._setReusableContent(u)}}else{var u=new UWA.Element("div",{class:"temp"});e.cellView._setReusableContent(u)}}}(e),compareActivityStates:(e,t)=>function(e,t){let o,i;return o=e?e.trim():"",i=t?t.trim():"",o.localeCompare(i)}(e,t),compareRevision:(e,t)=>function(e,t){let o,i;return o=e?e.trim():"",i=t?t.trim():"",o.localeCompare(i)}(e,t),compareIsLatestRevision:(e,t)=>function(e,t){let o,i;return e=e&&"check wux-ui-3ds"===e.icon?"True":"False",t=t&&"check wux-ui-3ds"===t.icon?"True":"False",o=e?e.trim():"",i=t?t.trim():"",o.localeCompare(i)}(e,t)}})),define("DS/ENORouteMgmt/Views/Dialogs/DeleteTask",["DS/WAFData/WAFData","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Controller/RouteServicesController","DS/WebappsUtils/WebappsUtils","DS/Controls/ButtonGroup","DS/Controls/Toggle","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d){let u=function(e){let n=new o;var s,u;n.inject(document.body);var c="",p="";let m=new UWA.Element("div",{id:"content",class:""}),g=new UWA.Element("div",{id:"removeRouteWarning",class:""});if(g.inject(m),g.appendChild(UWA.createElement("div",{class:"warningicon",html:[{tag:"img",src:a.getWebappsAssetUrl("ENORouteMgmt","icons/32/MOM-Alerts.png")}]})),e.options.grid.id){let t=[];null==e.options.grid.title?t.push(d.taskTitlePlaceholder):t.push(e.options.grid.title),c=(c=d.removeTaskWarning).replace("{task}",t),g.appendChild(UWA.createElement("div",{class:"",html:c})),s=400,u="auto",p=(p=d.removeTaskHeaderSingle).replace("{count}",t),g.appendChild(UWA.createElement("div",{class:"",html:d.removeTaskWarningDetailSingle}))}new UWA.Element("div",{html:"&nbsp;"}).inject(g);var f=new r({type:"checkbox"});f.addChild(new l({type:"checkbox",label:d.removeRouteConfirmationButton,checkFlag:!1})),f.inject(g),f.addEventListener("buttonclick",(function(e){var t=e.dsModel.checkFlag;h.buttons.Ok.disabled=1!=t}));let h=new t({modalFlag:!0,width:s,height:u,title:p,content:g,domId:"RouteImmersiveFrame",immersiveFrame:n,buttons:{Ok:new i({label:d.ok,domId:"RemoveTaskButton",disabled:!0,onClick:function(t){widget.routeMgmtMediator.publish("delete-task-success",e),t.dsModel.dialog.close()}}),Cancel:new i({label:d.cancel,onClick:function(e){e.dsModel.dialog.close()}})}});h.addEventListener("close",(function(e){n&&(n.elements.container.setStyle("height","1px"),n.elements.container.setStyle("width","1px"))}))};return{deleteTask:e=>function(e){u(e)}(e)}})),define("DS/ENORouteMgmt/Actions/TaskActions",["DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/Utils","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n){"use strict";let s=function(e){let t=[];return e.getDeletedTasks().forEach((e=>{e.options.grid.validTaskData&&e.options.grid.id&&t.push(e.options.grid)})),t},a=function(e,t){let o="";e.taskDueDate&&""!=e.taskDueDate&&(o=new Date(e.taskDueDate));var i=d(e),n=e.removeContentToReview,s=n;if(i&&s)for(let e=0;e<s.length;e++)-1!=i.indexOf(s[e])&&(i=i.filter((t=>t!==s[e])),n=n.filter((t=>t!==s[e])));let a={dataelements:{allowDelegation:e.allowDelegation,assigneeSetDueDate:e.assigneeSetDueDate,instructions:e.instructions,parallelNodeProcessionRule:e.parallelNodeProcessionRule,taskAction:e.taskAction,taskOrder:e.taskOrder,taskDueDate:o,title:e.title,reviewTask:e.needsOwnerReview,dateOffsetFrom:e.dateOffsetFrom,dueDateOffset:e.dueDateOffset,needsOwnerReview:e.needsOwnerReview,assigneeId:e.assigneePID,contentToReviewIds:i,removeContentToReview:n,routeTaskPriority:e.routeTaskPriority}};return"Route Template"==t.model.Type&&(a.dataelements.routeOwnerTask=e.routeOwnerTask,a.dataelements.routeOwnerUGChoice=e.routeOwnerUGChoice,"TRUE"==a.dataelements.routeOwnerTask&&(a.dataelements.assigneeId="contextUser"),"True"==t.model.selectUsersFromUserGroup?"Group"!=e.assigneeType&&"Group Proxy"!=e.assigneeType||"TRUE"==e.routeOwnerTask?a.dataelements.chooseUsersFromUg="False":a.dataelements.chooseUsersFromUg=e.chooseUsersFromUg:a.dataelements.chooseUsersFromUg=t.model.selectUsersFromUserGroup),a=r(e,a),a},r=function(e,t){let o=i.getTaskCustomFields();return o&&o.forEach(((o,i)=>{"extensions"!=o.name&&(t.dataelements[o.name]=e[o.name])})),t},l=function(e,t,o){let i=[];return e.forEach((e=>{let t=a(e,o);e.id?(t.id=e.id,t.type=e.type):t.updateAction="CREATE",i.push(t)})),t.forEach((e=>{let t=a(e,o);e.id&&(t.updateAction="DELETE",t.id=e.id,t.type=e.type),i.push(t)})),{csrf:widget.data.csrf,data:i}},d=function(e){var t=[];return null!=e.contentToReviewFieldInfo&&0!=e.contentToReviewFieldInfo.length&&e.contentToReviewFieldInfo.forEach((function(e){t.push(e.id)})),t};return{updateTaskDetails:(o,i)=>function(o,i){return new Promise((function(a,r){let d=o.getTasksDataForCreation(),u=s(o),c=o.getTaskTreeDocument().options.isTaskUpdated;if(d&&(c||u.length>0)){let o=l(d,u,i),s="PUT",c="";c="Route Template"==i.model.Type?t.getRouteTemplateServiceBaseURL()+"/"+i.id+"/tasks":t.getRouteServiceBaseURL()+"/"+i.id+"/tasks",e.updateTaskData(o,s,c).then((e=>{a(e)}),(e=>{500==e.statusCode?null!=e.internalError&&-1!=e.internalError.indexOf("No modify access to relationship 'Route Node'")?widget.notify.handler().addNotif({level:"error",subtitle:n.errorNoAccess,sticky:!0}):widget.notify.handler().addNotif({level:"error",subtitle:n.unexpectedError,sticky:!0}):r(e)}))}else{let e={};!c&&d?(e.refresh=!0,e.message="Tasks are not modified"):e.message="Not valid tasks are present",r(e)}}))}(o,i),getTasksDatasForDelete:e=>s(e)}})),define("DS/ENORouteMgmt/Views/RouteInfoPropWidget",["DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n){return{getOptions:function(){let t=[e.FACET_PROPERTIES];return{typeOfDisplay:e.ALL,selectionType:e.NO_SELECTION,facets:t,editMode:!1,readOnly:!1,context:{getSecurityContext:function(){return{SecurityContext:i.getSecurityContextValue()}}},extraNotif:!0,disableAddExtensionButton:!0,actions:[{name:"action_close_panel",text:n.infoCloseAction,icon:"close",handler:function(){widget.routeMgmtMediator.publish("route-info-close-click",{info:"Route"})}}]}},getPropModel:function(e){var s=[],a=new t({metatype:"businessobject",objectId:e,source:"3DSpace",tenant:i.getTenantValue()});return a.set("isTransient",!1),a.addEvent("onSave",(function(t){o.fetchRouteById(e).then((e=>{e[0].requestFrom="editPropWidget",widget.routeMgmtMediator.publish("route-data-updated",e[0])}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:n.infoRefreshError,sticky:!1})}))})),s.push(a),s},addFacets:function(e,t){let o=this.getFacets(t);e.addFacets(o)},getFacets:function(e){return[{alwaysVisible:!0,require:"DS/ENORIPE_Relations/views/RelationsTab",facet:{name:"relations",text:n.relations_tab,icon:"object-related"}},{alwaysVisible:!0,require:"DS/ENORouteMgmt/Views/RouteRelatedObjInfo",options:{model:e.model},facet:{name:"options",text:n.infoRelationTab,icon:"cog"}},{alwaysCalled:!0,alwaysVisible:!0,visible:!0,require:"DS/ENORouteMgmt/Views/RouteHistory",options:{id:e.model.id},facet:{name:"history",text:n.infoHistoryTab,icon:"navigation-history"}},{alwaysVisible:!0,require:"DS/EditPropWidget/facets/SwymComments/SwymComments",facet:{name:"social",text:n.comments,icon:"comment"}}]}}})),define("DS/ENORouteMgmt/Commands/RouteOpenWith",["UWA/Core","UWA/Class","DS/i3DXCompassPlatformServices/OpenWith","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Controller/RouteServicesController","UWA/Class/Promise"],(function(e,t,o,i,n,s){"use strict";let a=function(t){return n.getObjectTaxonomies(t).then((function(n){let a=function(e,t){let o=e,n=[],s={envId:i.getTenantValue(),serviceId:"3DSpace",contextId:"",objectId:l(o,"id"),objectType:l(o,"Type"),displayName:l(o,"Title"),displayType:l(o,"Type"),facetName:"realized",path:[{resourceid:l(o,"id"),type:l(o,"Type")}],objectTaxonomies:d(o,t)};return n.push(s),{protocol:"3DXContent",version:"1.1",source:widget.getValue("appId"),widgetId:widget.id,data:{items:n}}}(t,n),u=new o;u.set3DXContent(a);let c=[];if(e.is(u.retrieveCompatibleApps,"function"))return new s((function(e,t){u.retrieveCompatibleApps((function(t){t.forEach((function(e){c.push(r(e,null))})),e(c)}),(function(){t(new Error("Error while getting Open with menus"))}))}))})).catch((function(e){console.log("Error"+e)}))},r=function(e,t){var o=e.icon?e.icon:e.fonticon;return{id:e.text,title:e.text,icon:{iconPath:o,className:e.className&&e.className.contains("app-widget")?"open-with-widget-icon":""},type:"PushItem",multisel:!1,action:{context:t,callback:e.handler}}},l=function(e,t){let o="";return e&&e.options.grid.id&&(o=e.options.grid[t]),o},d=function(e,t){var o=[];return e.options.grid.Type&&o.push(e.options.grid.Type),o=[...o,...t.types_hierarchies[0].hierarchy]};return{getOpenWithMenu:e=>a(e)}})),define("DS/ENORouteMgmt/Utilities/InitiatePropertiesCustomAttributeUtility",["DS/ENORouteMgmt/Views/Form/CustomFieldUtils","DS/ENORouteMgmt/Views/Form/FormElements","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/Controls/Button","DS/Controls/SelectionChipsEditor","DS/WUXAutoComplete/AutoComplete","DS/Controls/DatePicker","DS/ENORouteMgmt/Utilities/Utils","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d){"use strict";let u=function(t,o,i){let n=e.getFieldType(o);"Toggle"==n&&(n="ComboBox"),e.isReadOnlyField(o)&&(o.mandatory=!1);let s=e.isMandatoryField(o)?"required":"",a=new UWA.Element("h5",{class:s,text:o.label}).inject(t);a.tooltipInfos=R(o.label),s&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(a)},c=function(e,t,o,i){let n=t.value;p(e,t,n,o,i)},p=function(t,o,i,r){let l=e.getFieldType(o);"Toggle"==l&&(l="ComboBox");let u=e.isReadOnlyField(o),c=e.isMultiValueField(o);if(u)return void m(t,o,i,r);let p=o.value;if(c){if("DatePicker"==e.getFieldType(o)){var h=new a({allowMultipleValuesFlag:!0,timePickerFlag:!0,timePickerPrecision:"sec"}).inject(t);r.fields[o.name]=h}else o.range&&o.range.item.length>0?function(e,t,o,i){var n=new s({elementsTree:t.range.item,allowFreeInputFlag:!1,placeholder:d.selectValue}).inject(e);n.value=o,i.fields[t.name]=n}(t,o,p,r):function(e,t,o,i){var s=new n({value:o,uniqueValue:!0,placeholder:d.enterValue}).inject(e);i.fields[t.name]=s}(t,o,"",r)}else switch(l){case"Editor":f(t,o,i,r);break;case"LineEditor":g(t,o,i,r);break;case"DatePicker":S(t,o,i,r);break;case"Toggle":w(t,o,i,r);break;case"ComboBox":v(t,o,i,r);break;case"LineEditor with Unit":k(t,o,i,r);break;default:return}},m=function(t,o,i,n){if(e.isDateField(o)&&i&&""!=i){let e=new Date(i);i=r.getLocaleDate(e,!0)}if("LineEditor with Unit"==e.getFieldType(o)){i+=" "+e.getDefaultUnit(o).display}new UWA.Element("span",{text:i}).inject(t).tooltipInfos=R(i),n.fields[o.name]={value:i}},g=function(o,i,n,s){JSON.parse(i.viewConfig);let a="[0-9]+";"real"==e.getAttributeType(i)&&(a="[0-9]+|([0-9]+.[0-9]+)");let r={sizeInCharNumber:1,value:n,placeholder:d.enterInteger};r.pattern=a;let l=t.createElement(o,r,"lineEditor");T(s,i,l)},f=function(o,i,n,s){if(e.isMultiLineValueField(i)){let e={widthInCharNumber:32,nbRows:4,newLineMode:"enter",value:n,placeholder:d.enterValue},a=t.createElement(o,e,"Editor");T(s,i,a)}else h(o,i,n,s)},h=function(e,o,i,n){let s={value:i,placeholder:d.enterValue},a=t.createElement(e,s,"lineEditor");T(n,o,a)},w=function(e,o,i,n){let s=!1;"TRUE"==i&&(s=!0);let a={type:"checkbox",label:o.label,value:i,checkFlag:s};e.setStyle("padding-top","10px");let r=t.createElement(e,a,"Toggle");T(n,o,r)},v=function(o,i,n,s){let a={elementsList:e.getRangeElementsList(i),value:n,enableSearchFlag:!1,placeholder:d.selectValue},r=t.createElement(o,a,"ComboBox");T(s,i,r)},S=function(e,o,i,n){let s;""!=i&&(s=new Date(i));let a={value:s,allowUndefinedFlag:!0,timePickerFlag:!0,timePickerPrecision:"sec"},r=t.createElement(e,a,"DatePicker");T(n,o,r)},k=function(o,i,n,s){o.setStyle("display","flex");let a={value:n,pattern:"[0-9]+|([0-9]+.[0-9]+)",placeholder:d.enterNumber,sizeInCharNumber:17},r=t.createElement(o,a,"lineEditor"),l={placeholder:e.getDefaultUnit(i).display,disabled:!0,sizeInCharNumber:5};new UWA.Element("div",{html:"&nbsp;"}).inject(o),t.createElement(o,l,"lineEditor"),T(s,i,r)},T=function(t,o,i){if(e.isMultiValueField(o)&&t.fields[o.name]){if(!Array.isArray(t.fields[o.name])){let e=t.fields[o.name];t.fields[o.name]=[],t.fields[o.name].push(e)}t.fields[o.name].push(i)}else t.fields[o.name]=i},R=function(e){return o.getElementToolTip(e)},y=function(e,t){return o.createNewElement(e,t)};return{drawCustomFieldsLabel:(e,t,o)=>u(e,t),drawCustomFieldsInEditMode:(e,t,o)=>c(e,t,o),renderCustomAttributes:(e,t)=>function(e,t){let o,i,n,s,a=l.getRouteCustomFields(),r=e.advFormFields;"Template"==t&&(a=l.getRouteTemplateCustomFields(),r=e.formFields);let d,p,m,g=new UWA.Element("div",{id:"customAttributes",class:""}).inject(r);for(let e in a)if("extensions"!=a[e].name){let t=JSON.parse(a[e].viewConfig);a[e].value=t.defaultValue}a&&a.forEach(((t,a)=>{"extensions"!=t.name&&(d=new UWA.Element("div",{id:"customAttr_"+t.name,class:""}).inject(g),o=y("initiate-Route-Field",d),i=y("initiate-Route-Field-Label",o),n=new UWA.Element("div").inject(o),n.style.width="2%",s=y("initiate-Route-Field-Value",o),p=new UWA.Element("div",{id:"customAttr_label"}).inject(i),m=new UWA.Element("div",{id:"customAttr_Val"}).inject(s),u(p,t),c(m,t,e))}))}(e,t),addCustomAttrInfo:(t,o,i)=>function(t,o,i){let n=l.getRouteCustomFields();return"Template"==i&&(n=l.getRouteTemplateCustomFields()),n&&n.forEach(((i,n)=>{if("extensions"!=i.name&&0!=i.editable){let n=o[i.name].value;if("object"==typeof n&&n.getDate)n=n.toISOString();else if(e.isDateField(i))if(Array.isArray(n)){for(var s=0;s<n.length;s++)if(n&&""!=n){let e=new Date(n[s]);n[s]=e.toISOString()}}else n&&""!=n&&(n=new Date(n).toISOString());i.range?n&&n.length>0&&(t[i.name]=n):t[i.name]=n}})),t}(t,o,i)}})),define("DS/ENORouteMgmt/Model/TaskAssigneeModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/EnoviaBootstrap","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Utilities/RouteViewUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s){"use strict";let a=new e;return{createModel:o=>function(o){return a=new e,a.prepareUpdate(),o.forEach((function(e){var o=new t({label:e.assigneeTitle,id:e.assigneeId,width:300,grid:e});o._options.grid.id=e.assigneePID,o._options.grid.Type=e.assigneeType,o._options.grid.Title=e.assigneeTitle,o._options.grid.displayType=e.assigneeType,o._options.grid.ScopeMembers=e.Scope,a.addRoot(o)})),a.pushUpdate(),a}(o),onRouteNodeOwnerCellRequest:e=>function(e){let t;if(!e.isHeader&&(t=e.cellView.collectionView.reuseCellContent("_taskAssignee_"),t)){var s,a,r,l,d=e.nodeModel.options.grid.assigneeType,u=e.nodeModel.options.grid.fieldType;"Person"==d||"Originator"==u?(s=e.nodeModel.options.grid.assigneeTitle,a="/api/user/getpicture/login/"+e.nodeModel.options.grid.assigneeName+"/format/normal",r=n.getAvatarDetails(s),l=o.getSwymUrl()+a,null!=o.getSwymUrl()?t.getChildren()[0].getChildren()[0].src=l:(t.getChildren()[0].getChildren()[0].setHTML(r.avatarStr),t.getChildren()[0].getChildren()[0].setStyle("background",r.avatarColor))):"Group"!=d&&"Group Proxy"!=d||(t.getChildren()[0].getChildren()[0].style.display="none",s=e.nodeModel.options.grid.userGroupTitle,l=i.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png"),t.getChildren()[0].getChildren()[1].style.display="block",t.getChildren()[0].getChildren()[1].src=l),t.getChildren()[1].setText(s),t.setAttribute("title",s),t.setStyle("display","flex"),t.setStyle("min-width","20px"),t.setStyle("justify-content","center"),t.setStyle("align-items","center"),e.cellView._setReusableContent(t)}}(e),getModel:()=>a,destroy:()=>{a=new e}}})),define("DS/ENORouteMgmt/Views/Loader/InitiateRouteTemplateChooser",["DS/ENORouteMgmt/Controller/RouteServicesController","DS/Utilities/Dom","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/TreeModel/TreeNodeModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n){"use strict";let s,a=!1;var r=function(e,t){var o;t&&(o=new i({label:t[0]["ds6w:label"],value:t[0].id,status:t[0]["ds6w:status_value"],category:t[0]["ds6w:category"]}),s.fields.templateField.selectedItems=o)};let l=function(t,o){e.fetchRouteTemplateById(t[0].id).then((function(e){var n;t[0].createFromTemplate||(n=new i({label:e.data[0].dataelements.title,value:t[0].id,status:"Released"}),a=!0,o.fields.templateField.selectedItems=n),o.fields.descField.value=e.data[0].dataelements.description;var s=s="Standard"==e.data[0].dataelements.routeBasePurpose?0:"Approval"==e.data[0].dataelements.routeBasePurpose?1:2;if(o.fields.routePurpose.selectedIndex=s,s=s="Notify Route Owner"==e.data[0].dataelements.completionAction?0:1,o.fields.routeCompletionAction.selectedIndex=s,s=s="Immediate"==e.data[0].dataelements.AutoStopOnRejection?0:1,o.fields.routeAutoStopOnRejection.selectedIndex=s,!o.fields.scopeField.options.fromBookMarkEditor){s=s="All"==e.data[0].dataelements.attRestrictMembers?0:(e.data[0].dataelements.attRestrictMembers,1),o.fields.buttonGroupScope.selectIndex(s),o.fields.scopeField.selectedItems=void 0,o.routeScopeField.className="fonticon-chooser-scope-display";for(let e=0;e<o.fields.buttonGroupScope.getButtonCount();e++){let t=o.fields.buttonGroupScope.getButton(e);t.disabled=e!=s}}s=s="True"==e.data[0].dataelements.selectUsersFromUserGroup||"False"==e.data[0].dataelements.preserveTaskOwner?0:1,o.fields.buttonGroupUGA.selectIndex(s),"True"==e.data[0].dataelements.selectUsersFromUserGroup?(o.fields.buttonGroupUGA.hide(),o.advFormFields.querySelector("#PreserveTaskOwner").setStyle("display","none"),o.advFormFields.querySelector("#routeUserGroupAssignmentInfo").setStyle("display","none")):(o.fields.buttonGroupUGA.show(),o.advFormFields.querySelector("#PreserveTaskOwner").removeAttribute("style"),o.advFormFields.querySelector("#routeUserGroupAssignmentInfo").removeAttribute("style")),t[0].taskEditSetting=e.data[0].dataelements.taskEditSetting,widget.routeMgmtMediator.publish("initiateRoute-on-TemplateSelection",{template:t,chooseUserFromUG:e.data[0].dataelements.selectUsersFromUserGroup}),widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons"),o.fields.requiresEsign=e.data[0].dataelements.routeRequiresESign,widget.routeMgmtMediator.publish("initiateRoute-on-TemplateSelection",{template:t,chooseUserFromUG:e.data[0].dataelements.selectUsersFromUserGroup}),widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons")}))};return{init:(e,t)=>function(e,t){s=t;var i=e.dsModel,n=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],(function(e){var t=e.createSocket({socket_id:n}),s=o.getRefinementToSnN(n,"routeTemplate",!1,["Route Template"]);if(s.precond=o.getPrecondForRouteTemplateSearch(),!UWA.is(t))throw new Error("Socket not initialized");t.dispatchEvent("RegisterContext",s),t.addListener("Selected_Objects_search",r.bind(i,"")),t.dispatchEvent("InContextSearch",s)}))}(e,t),populateTemplate:(e,t)=>l(e,t),destroy:()=>{s={}},getPrecondForTemplateSearch:()=>{return(e={}).precond=o.getPrecondForRouteTemplateSearch(),e;var e},changeHandlerFortemplateField:e=>function(e){if(a)a=!1;else{if(e.fields.templateField.selectedItems){let t=e.fields.templateField.selectedItems.options.status;if("Released"!=t&&"Route Template.Active"!=t){let o;"Draft"==t||"Route Template.Inactive"==t?o=n.errorSelectedInactiveTemplate:"Archived"!=t&&"Route Template.Archive"!=t||(o=n.errorSelectedArchiveTemplate),widget.notify.handler().addNotif({level:"error",subtitle:o,sticky:!1}),a=!0,e.fields.templateField.selectedItems=void 0}}if(e.fields.templateField.selectedItems&&e.fields.templateField.selectedItems.options){if(e.fields.templateField._editor.elements.inputField.value==e.fields.templateField.selectedItems.options.label){var t=[],o={id:e.fields.templateField.selectedItems.options.value,createFromTemplate:!0};t.push(o),l(t,e),setTimeout((function(){var t=e.fields.templateField._editor.elements.inputField.value.length;e.fields.templateField._editor.elements.inputField.setSelectionRange(t,t),e.fields.templateField._editor.elements.inputField.focus()}),1e3)}}else{if(e.fields.descField.value="",e.fields.routePurpose.selectedIndex=0,e.fields.routeCompletionAction.selectedIndex=0,e.fields.routeAutoStopOnRejection.selectedIndex=0,e.fields.requiresEsign="False",e.fields.DemoteOnRejection.selectedIndex=0,e.fields.buttonGroupUGA.selectIndex(0),e.fields.buttonGroupUGA.show(),e.advFormFields.querySelector("#PreserveTaskOwner").removeAttribute("style"),e.advFormFields.querySelector("#routeUserGroupAssignmentInfo").removeAttribute("style"),widget.routeMgmtMediator.publish("initiateRoute-on-TemplateSelection",{template:""}),!e.fields.scopeField.options.fromBookMarkEditor){e.fields.buttonGroupScope.selectIndex(1),e.routeScopeField.className="fonticon-chooser-scope-display";for(let t=0;t<e.fields.buttonGroupScope.getButtonCount();t++){let o=e.fields.buttonGroupScope.getButton(t);o&&o.disabled&&(o.disabled=!1)}}widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons"),setTimeout((function(){e.fields.templateField._editor.elements.inputField.focus()}),1e3)}}}(e)}})),define("DS/ENORouteMgmt/Views/Dialogs/ChooseUsersFromUserGroup",["DS/WAFData/WAFData","UWA/Core","UWA/Controls/Abstract","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/Controls/ButtonGroup","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/Controls/Toggle","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/TreeModel/TreeNodeModel","DS/TreeModel/TreeDocument","DS/ENORouteMgmt/EnoviaBootstrap","DS/WUXAutoComplete/AutoComplete","DS/TreeModel/DataModelSet","DS/Logger/Logger","DS/Controls/ProgressBar","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CoreEvents/Events","DS/ENORouteMgmt/Utilities/Utils","DS/Controls/Loader","DS/WebappsUtils/WebappsUtils","DS/Controls/TooltipModel","DS/ENORouteMgmt/Controller/RouteServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h,w,v,S,k,T,R,y,b,M){"use strict";var D,C,E,A,O,I,N,U=0,_=new UWA.Element("div",{class:"data-grid-container",id:"selectUsers"}),F="ON_SPLIT_ROUTENODE";A=function(e,t){var o=this;o.isSaveForLater=!t;for(var i=o._model.getChildren(),n={},s=[],a=!0,r=!1,l=0;l<i.length;l++)(n=i[l].options.routeNode).assigneeId="",void 0!==n.selectedMembers&&n.selectedMembers.length>0?(r=!0,n.selectedMembers.forEach((function(e){n.assigneeId+=e+"~"})),n.assigneeId=n.assigneeId.substring(0,n.assigneeId.length-1)):a=!1,s.push(i[l].options.routeNode);if(!a&&t)N.addNotif({level:"error",subtitle:M.ErrorSelectAllAssignees,sticky:!0}),x();else if(r){var d=new w({shape:"circular",infiniteFlag:!0,emphasize:"success",statusFlag:!1,height:120});d.inject(e.dsModel.dialog.elements._contentDiv),d.elements.container.setStyle("margin-left","40%"),e.dsModel.dialog.elements._contentDiv.getChildren()[0].setStyle("opacity","0.3"),b.assignAndStartFromUserGroup(s,o.routeId,o.csrf,t,C,o.baseURL).then((t=>{"undefined"!=typeof widget&&void 0!==widget.routeMgmtMediator?(widget.routeMgmtMediator.publish(F),t.data[0].dataelements.id=t.data[0].id,widget.routeMgmtMediator.publish("route-data-updated",t.data[0].dataelements)):S.publish({event:F,data:{this:o,response:t}});var i="";i=o.isSaveForLater?M.TaskCreationsSuccess:M.SuccessTaskCreationAndStartRoute,P(),N.addNotif({level:"success",subtitle:i,sticky:!0}),e.dsModel.dialog.elements._contentDiv.getChildren()[0].setStyle("opacity","1"),o._immersiveFrame.destroy(),e.dsModel.dialog.close(),x()})).catch((t=>{S.publish({event:F,data:{this:o,response:t}});var i="";if(i=o.isSaveForLater?M.TaskAssignmentFailure:M.failureToStartRoute,t.error){d.destroy();var n=t.error;-1!=n.indexOf("Error: Assignee(s) are not selected for one or more Route Nodes")&&(n=M.ErrorSelectAllAssignees),e.dsModel.dialog.elements._contentDiv.getChildren()[0].setStyle("opacity","1"),N.addNotif({level:"error",subtitle:n,sticky:!0})}else o._immersiveFrame.destroy(),e.dsModel.dialog.close(),N.addNotif({level:"error",subtitle:i,sticky:!0});x()}))}else N.addNotif({level:"error",subtitle:M.ErrorSelectAssigneesForAssign,sticky:!0}),x()},E=o.extend({name:"chooseUsersFromUserGroup",_getTaskOrderDisplayValue:function(e){void 0===this.previousTaskOrder?(this.previousTaskOrder=e.dataelements.taskOrder,this.taskOrderDisplayValue=e.dataelements.taskOrder):this.previousTaskOrder===e.dataelements.taskOrder?this.taskOrderDisplayValue="":(this.taskOrderDisplayValue=e.dataelements.taskOrder,this.previousTaskOrder=e.dataelements.taskOrder)},_loadDocument:function(e){this.dataModelSet=new f;var t,o,i=new p({dataModelSet:this.dataModelSet});i.prepareUpdate();let n=[];e.data.forEach(function(e){"True"!==e.dataelements.chooseUsersFromUg||"Group"!==e.dataelements.assigneeType&&"Group Proxy"!==e.dataelements.assigneeType||(this._getTaskOrderDisplayValue(e),o={selectAssignee:[],title:e.dataelements.title,id:e.id,userGroupAction:e.dataelements.userGroupAction,seqLevel:e.dataelements.taskOrder,taskAssignee:e.dataelements.assigneeTitle,originatedUserGroup:e.dataelements.assigneePID,userGroupMembers:e.dataelements.ugMembers,_rowAutoComplete:"",label:this.taskOrderDisplayValue},n.push(o),t=c.createTreeNodeDataModel(this.dataModelSet,{label:this.taskOrderDisplayValue,grid:o,height:80,routeNode:{originatedUserGroup:e.dataelements.assigneePID,userGroupAction:e.dataelements.userGroupAction,candidateAssignee:e.dataelements.candidateAssignee,taskAssignee:e.dataelements.taskAssignee,routeNodeId:e.id,assigneeId:""}}),i.addRoot(t))}.bind(this)),i.pushUpdate(),this._model=i},_buildSelectUserDialog:function(e){let t=this;O=A.bind(t),D&&D.off(M.loading_label),this.csrf=e.csrf,this._model=new p({useAsyncPreExpand:!1}),this._loadDocument(e);var o=new UWA.Element("div",{class:"selectUser-data-grid-container",id:"selectUsers"}).inject(_);UWA.createElement("div",{html:M.SelectAssigneeModalLabel,class:"title-div"}).inject(o).tooltipInfos=new y({shortHelp:M.SelectAssigneeModalLabel,allowUnsafeHTMLShortHelp:!0});let i=this._model.getChildren();for(let e=0;e<i.length;e++){let y=UWA.createElement("div",{class:"selectUser-task--div"}).inject(o),D=UWA.createElement("div",{class:"selectUser-task-content-div"});if(""!=i[e].options.grid.label){var s=UWA.createElement("div",{class:"selectUser-task-order-div"});UWA.createElement("text",{html:M.taskOrder+" "+i[e].options.grid.label}).inject(s),s.inject(y),new UWA.Element("div",{html:'<hr style= "width:100%; height:1px; margin:5px 0 5px 0; display: "block"/>'}).inject(y)}D.inject(o);var a=UWA.createElement("div",{class:"selectUser-task-header-div"}).inject(D),r=UWA.createElement("div",{class:"selectUser-label-div"}),d=i[e].options.grid.title,u=i[e].options.grid.taskAssignee;UWA.createElement("label",{html:[UWA.createElement("span",{class:"taskIcon",html:[{tag:"img",src:R.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTask16.png")}]}),UWA.createElement("span",{class:"User-Group-Font",text:" "+d+" "}),UWA.createElement("span",{class:"selectUser-assignedTo",html:M.assignedTo+"&nbsp;"}),UWA.createElement("span",{class:"userGroupIcon",html:[{tag:"img",src:R.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_dsxaccess_Group.png")}]}),UWA.createElement("span",{class:"User-Group-Font",text:" "+u})],title:d+" "+M.assignedTo+" "+u}).inject(r),r.inject(a);var m,f,h=i[e].options.grid.userGroupMembers,w=new p({}),v=new Map;for(let e=0;e<h.length;e++){let t=h[e].split("~");t.length>2&&(f=t[0],m=t[1]+"("+t[2]+")"),v.set(m,f);var S=new c({label:m,value:f});w.addChild(S)}t._myAutoComplete=new g({allowFreeInputFlag:!1,multiSearchMode:!0,elementsTree:w,allowMultipleValuesFlag:!0,placeholder:M.typeToSearch}).inject(D),i[e].options.routeNode.customDataMembers=v,t._myAutoComplete.addEventListener("change",(function(o){var n=o.dsModel.value||void 0;void 0!==n&&n.length>0?t._dialog.buttons.Ok.disabled=!1:t._dialog.buttons.Ok.disabled=!0;let s=o.dsModel.elements.container.parentElement.querySelector(".selectUser-check-box-div");void 0!==n&&n.length>1?s.setStyle("display","block"):s.setStyle("display","none"),i[e].options.routeNode.selectedMembers=n})),t._myAutoComplete.getContent().querySelector(".wux-controls-lineEditor-lite").addEventListener("keydown",(function(e){e.stopPropagation()}));var k=UWA.createElement("div",{class:"selectUser-check-box-div"}),T="Any"!=i[e].options.routeNode.userGroupAction,b="All";"All"!=i[e].options.routeNode.userGroupAction&&(b=void 0,T=!1),t._myButtonGroup=new n({type:"checkbox"}).inject(k);var C=new l({type:"checkbox",label:M.AllMustApprove,value:b,checkFlag:T});t._myButtonGroup.addChild(C),t._myButtonGroup.addEventListener("change",(function(t){i[e].options.routeNode.userGroupAction=void 0===t.dsModel.value[0]?"Any":"All"})),void 0!==i[e].options.routeNode.selectedMembers&&i[e].options.routeNode.selectedMembers.length>1?k.setStyle("display","block"):k.setStyle("display","none"),t._myButtonGroup.inject(k),k.inject(D),UWA.createElement("div",{class:"selectUser-Space-div"}).inject(D)}document.querySelector("#RouteImmersiveFrameSelectUser").dispatchEvent(new Event("dimensionsChanged"))},_showSelectAssigneeModal:function(e){var t=this;t.routeId=void 0===e._modelKey?e.routeId:e._modelKey.id,void 0===e.url?require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],(function(e){e.getServiceUrl({serviceName:"3DSpace",platformId:m.getTenantValue(),onComplete:t._onCompleteCompassServices.bind(t)})})):t._fetchRouteTaskDetails(e)},_onCompleteCompassServices:function(e){var t=this;t.baseURL=e+"/resources/v1/modeler/routes/"+t.routeId,t._fetchRouteTaskDetails()},_fetchRouteTaskDetails:function(e){x();var t=this;void 0===t.baseURL&&(t.baseURL=void 0===e._modelKey?e.url:e._modelKey.url()),b.fetchRouteTasksById(t.routeId,t.baseURL,C).then((e=>{t._buildSelectUserDialog(e),U=0,D&&D.off(M.loading_label)})).catch((e=>{U=0,D&&D.off(M.loading_label)}))},show:function(e){1==++U?(null!=(D=new T({fadeDuration:0}).inject(_))&&D.on(M.loading_label),C=e,I=this,this._immersiveFrame=new a,this._immersiveFrame.inject(document.body),this._dialog=new s({title:M.SelectAssigneeModalTitle,modalFlag:!0,minWidth:300,maxHeight:750,width:600,resizableFlag:!0,content:_,domId:"RouteImmersiveFrameSelectUser",allowMaximizeFlag:!0,immersiveFrame:this._immersiveFrame,buttons:{Cancel:new r({label:M.cancel,allowUnsafeHTMLLabel:!0,onClick:function(e){e.dsModel.dialog.close()}}),Apply:new r({label:M.Assign,allowUnsafeHTMLLabel:!0,onClick:function(e){O(e,!1),"undefined"!=typeof widget&&widget.routeMgmtMediator.publish("route-task-close-click-view-mode")}}),Ok:new r({label:M.start,disabled:!0,allowUnsafeHTMLLabel:!0,onClick:function(e){O(e,!0),"undefined"!=typeof widget&&widget.routeMgmtMediator.publish("route-task-close-click-view-mode")}})}}),this._dialog.addEventListener("close",(function(e){U=0,S.publish({event:"ON_SPLIT_ROUTENODE_CANCEL"}),P(),I._immersiveFrame.destroy(),I._immersiveFrame=void 0,x()})),this._showSelectAssigneeModal(e)):N.addNotif({level:"warning",subtitle:M.dialogLoading,sticky:!0})}}),E.showSeletUsers=function(e){(new E).show(e)};let P=function(){N=d,u.removeLastNotificationDisplayed(N)},x=function(){"undefined"!=typeof widget&&widget.notify?N=widget.notify.handler():(N=d,u.setNotificationManager(N),void 0!==document.getElementById("RouteImmersiveFrameSelectUser")?u.inject(document.getElementById("RouteImmersiveFrameSelectUser")):void 0!==document.getElementById("pageContentDiv")&&u.inject(document.getElementById("pageContentDiv")),u.setStackingPolicy(9))};return E})),define("DS/ENORouteMgmt/Config/RouteContentsGridViewConfig",["DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils","DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils","DS/ENORouteMgmt/Views/Grid/RouteGridCustomColumns","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i){"use strict";return[{text:i.title,dataIndex:"tree"},{text:i.name,dataIndex:"Name"},{text:i.type,dataIndex:"TypeDisplay"},{text:i.revision,dataIndex:"Revision"},{text:i.isLatestRevision,dataIndex:"isLatestRevision",editableFlag:!1,allowUnsafeHTMLContent:!0,compareFunction:function(e,t){return o.compareIsLatestRevision(e,t)}},{text:i.IDcardMaturityState,dataIndex:"Maturity"},{text:i.blockingMaturity,dataIndex:"BlockingMaturityMenu",visibility:!0,editableFlag:!0,getCellSemantics:function(e){return{label:e.nodeModel.options.grid.RouteBaseState_NLS}},getCellEditableState:function(t){return e.isCellEditable(t)},getCellTypeRepresentation:function(t){return e.getCellTypeRepresentation(t)},compareFunction:function(t,o){return e.compareBlockingStates(t,o)},getCellTooltip:function(t){return e.showTooltip(t)}},{text:i.targetMaturity,dataIndex:"TargetMaturityMenu",visibility:!0,editableFlag:!0,getCellSemantics:function(e){return{label:e.nodeModel.options.grid.RouteTargetState_NLS}},getCellEditableState:function(e){return t.isCellEditable(e)},getCellTypeRepresentation:function(e){return t.getCellTypeRepresentation(e)},compareFunction:function(e,o){return t.compareTargetMaturityStates(e,o)},getCellTooltip:function(e){return t.showTooltip(e)}},{text:i.lock,dataIndex:"Locked",editableFlag:!1,width:75,allowUnsafeHTMLContent:!0},{text:i.description,dataIndex:"Description",visibility:!1,visibleFlag:!1},{text:i.lockedBy,dataIndex:"LockedBy",editableFlag:!1,visibility:!1,visibleFlag:!1},{text:i.IDcardOwner,dataIndex:"Owner",onCellRequest:o.onRouteContentOwnerByCellRequest},{text:i.relationType,dataIndex:"Relation"},{text:i.relatedTo,dataIndex:"relatedToTaskTitles"}]})),define("DS/ENORouteMgmt/Config/RouteSummaryGridViewConfig",["DS/ENORouteMgmt/Views/Grid/RouteGridCustomColumns","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";return[{text:t.title,dataIndex:"tree",editableFlag:!1,pinned:"left"},{text:t.name,dataIndex:"Name",editableFlag:!1},{text:t.IDcardMaturityState,dataIndex:"Maturity_State",editableFlag:!1,onCellRequest:e.onRouteNodeStateCellRequest},{text:t.routeBasePurpose,dataIndex:"BasePurposeNLS",editableFlag:!1},{text:t.activity_state,dataIndex:"Activity_StateNLS",typeRepresentation:"user",editableFlag:!1,compareFunction:function(t,o){return e.compareActivityStates(t,o)}},{text:t.description,dataIndex:"Description"},{text:t.revision,dataIndex:"revisionValue",typeRepresentation:"user",editableFlag:!1,compareFunction:function(t,o){return e.compareRevision(t,o)}},{text:t.taskassignees,dataIndex:"AssigneesDiv",editableFlag:!1,allowUnsafeHTMLContent:!0,onCellRequest:e.onRouteNodeAssigneesCellRequest},{text:t.IDcardOwner,dataIndex:"Owner",editableFlag:!1,onCellRequest:e.onRouteNodeOwnerCellRequest}]})),define("DS/ENORouteMgmt/Config/InitiateRouteContentsViewConfig",["DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils","DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils","DS/ENORouteMgmt/Views/Grid/RouteGridCustomColumns","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i){"use strict";return[{text:i.title,dataIndex:"tree",width:"150px",visibility:!0},{text:i.name,dataIndex:"Name",visibility:!1},{text:i.type,dataIndex:"Type",visibility:!0},{text:i.isLatestRevision,dataIndex:"isLatestRevision",editableFlag:!1,allowUnsafeHTMLContent:!0,visibility:!1,visibleFlag:!1,compareFunction:function(e,t){return o.compareIsLatestRevision(e,t)}},{text:i.IDcardMaturityState,dataIndex:"Maturity",visibility:!0},{text:i.blockingMaturity,dataIndex:"BlockingMaturityMenu",visibility:!0,editableFlag:!0,getCellSemantics:function(e){return{label:e.nodeModel.options.grid.RouteBaseState_NLS}},getCellEditableState:function(t){return e.isCellEditable(t)},getCellTypeRepresentation:function(t){return e.getCellTypeRepresentation(t)},compareFunction:function(t,o){return e.compareBlockingStates(t,o)},getCellTooltip:function(t){return e.showTooltip(t)}},{text:i.targetMaturity,dataIndex:"TargetMaturityMenu",visibility:!0,editableFlag:!0,typeRepresentation:"functionMenu",getCellSemantics:function(e){return{label:e.nodeModel.options.grid.RouteTargetState_NLS}},getCellEditableState:function(e){return t.isCellEditable(e)},getCellTypeRepresentation:function(e){return t.getCellTypeRepresentation(e)},compareFunction:function(e,o){return t.compareTargetMaturityStates(e,o)},getCellTooltip:function(e){return t.showTooltip(e)}},{text:i.lock,dataIndex:"Locked",editableFlag:!1,width:75,allowUnsafeHTMLContent:!0},{text:i.lockedBy,dataIndex:"LockedBy",editableFlag:!1,visibility:!1,visibleFlag:!1},{text:i.IDcardOwner,dataIndex:"Owner",visibility:!0},{text:i.modified,dataIndex:"Modified_Date",visibility:!1},{text:i.creationDate,dataIndex:"Creation_Date",visibility:!1},{text:i.relatedTo,dataIndex:"routeTask",visibility:!0}]})),define("DS/ENORouteMgmt/Config/Toolbar/RouteMembersTabToolbarConfig",["DS/ENORouteMgmt/Utilities/RouteWidgetPersistency","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){let o,i={menu:[{type:"CheckItem",title:t.tileView,state:"selected",fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-small-tile"},action:{module:"DS/ENORouteMgmt/Views/ToggleViews",func:"doToggleView",argument:{view:"TileView",curPage:"MembersTab"}},tooltip:t.tileView},{type:"CheckItem",title:t.gridView,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-list"},action:{module:"DS/ENORouteMgmt/Views/ToggleViews",func:"doToggleView",argument:{view:"GridView",curPage:"MembersTab"}},tooltip:t.gridView}]};return o={writetoolbarDefination:()=>function(){let o=e.getViewPersistency("RouteMembersPage","GridView"),n="selected"===o?"unselected":"selected";i.menu[1].state=o,i.menu[0].state=n;var s={entries:[{id:"view",className:"memberViews",dataElements:{typeRepresentation:"viewdropdown",icon:{iconName:"selected"==o?"view-list":"view-small-tile",fontIconFamily:1},value:i},position:"far",tooltip:t.switchView,category:"action"}]};return JSON.stringify(s)}(),destroy:function(){_dataGrid.destroy(),_container.destroy()}},o})),define("DS/ENORouteMgmt/Views/Loader/InitiateRouteAddContentSearchLoader",["DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i){let n,s=function(t,o,i,n,s,r){var l=s?s.split(","):"",d=e.getRefinementToSnN(i,"addContent",!0,l);if(d.precond=e.getPrecondForContentSearch(n,l),d.resourceid_not_in=r.getContentIDs(),!UWA.is(o))throw new Error("Socket not initialized");o.dispatchEvent("RegisterContext",d),o.addListener("Selected_Objects_search",a.bind(t,"")),o.dispatchEvent("InContextSearch",d)},a=function(e,o){let n=[],s=[];for(var a=0;a<o.length;a++){var r={};r.id=o[a].id,r.name=o[a]["ds6w:identifier"],r.stateNLS=o[a]["ds6w:status"],r.title=o[a]["ds6w:label"],r.type=o[a]["ds6w:type"],r.created=o[a]["ds6w:created"],r.modified=o[a]["ds6w:modified"],r.type_icon_url=o[a].type_icon_url,r.owner=o[a]["ds6w:responsible"],r.ownerName=o[a].owner,r.policy=o[a]["ds6w:policy"],r.state=o[a]["ds6w:status"],r.revision=o[a]["ds6wg:revision"],r.isLatestRevision=o[a]["ds6w:isLastRevision"],r.reserved=o[a]["ds6w:reserved_value"],r.reservedBy=o[a]["ds6w:reservedBy"],r.reservedByUserName=o[a].file_locked_by,s.push(r.id),n.push(r)}t.fetchStateBlockingConditions(s).then((e=>{for(var t=!1,o=!1,s=0;s<e.length;s++){let i=n.find((t=>t.id==e[s].physicalid));i.maturityBlockingStates=e[s].maturityBlockingStates,i.maturityTargetStates=e[s].maturityTargetStates,i.RouteBaseState=e[s].RouteBaseState,i.RouteBaseState_NLS=e[s].RouteBaseState_NLS,i.RouteTargetState=e[s].RouteTargetState,i.RouteTargetState_NLS=e[s].RouteTargetState_NLS,i.current=e[s].current,i.associatedto="Route","Ad Hoc"===e[s].RouteBaseState&&(t=!0),"true"===e[s].isOnceInstantiable&&(o=!0)}t&&o?widget.notify.handler().addNotif({level:"warning",title:i.adHocErrTitle,subtitle:i.adHocErrSubTitle,message:i.adHocErrDesc,sticky:!1}):t&&widget.notify.handler().addNotif({level:"warning",subtitle:i.stateBlockingInfoMsg,sticky:!1}),require(["DS/ENORouteMgmt/Model/InitiateRouteContentModel"],(function(e){e.appendRow(n)}))})).catch((e=>{console.log("failed "+e[0])}))};return n={onSearchClick:n=>{require(["DS/ENORouteMgmt/Model/InitiateRouteContentModel"],(function(n){n.getModel().contentIds;var a,r=n.getModel().scopeId;if(""==r||null==r)return void widget.notify.handler().addNotif({level:"error",subtitle:i.ScopeSelectMessage,sticky:!1});if(1==widget.getValue("isDialogOpened")&&null==e.getOrganizationFromCredentials())return widget.notify.handler().addNotif({level:"error",subtitle:i.selectOrganizationMessage,sticky:!0}),!1;var l=UWA.Utils.getUUID(),d=this;let u=o.getRouteContentSearchTypes();UWA.is(a)||require(["DS/SNInfraUX/SearchCom"],(function(e){a=e.createSocket({socket_id:l}),void 0===u?t.fetchAllowedContentTypesForRoute().then((e=>{u=e.data[0].dataelements.routeSearchContentTypes,s(d,a,l,r,u,n)}),(e=>{})):s(d,a,l,r,u,n)}))}))}},n})),define("DS/ENORouteMgmt/Views/Loader/InitiateRouteScopeChooser",["DS/Utilities/Dom","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Controller/RouteServicesController","DS/TreeModel/TreeNodeModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n){"use strict";let s;var a=function(e,t){var o;t&&(o=new i({label:t[0]["ds6w:label"],value:t[0].id}),s.fields.scopeField.selectedItems=o)};return{init:(e,o)=>function(e,o){var i=e.dsModel;s=o;var n=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],(function(e){var o=e.createSocket({socket_id:n}),s=t.getRefinementToSnN(n,"selectScope",!1,["Workspace Vault","Workspace","Personal Workspace","Project Space"]);if(s.precond=t.getPrecondForScopeSearch(),!UWA.is(o))throw new Error("Socket not initialized");o.dispatchEvent("RegisterContext",s),o.addListener("Selected_Objects_search",a.bind(i,"")),o.dispatchEvent("InContextSearch",s)}))}(e,o),destroy:()=>{s={}},getPrecondForScope:()=>{return(e={}).precond=t.getPrecondForScopeSearch(),e;var e},changeHandlerForScopeField:e=>function(e){e.fields.scopeField.options.fromBookMarkEditor||(e.fields.scopeField.selectedItems?e.fields.scopeField._editor.elements.inputField.value==e.fields.scopeField.selectedItems.options.label&&o.getScopeInformation(e.fields.scopeField.selectedItems.options.value).then((function(t){e.fields.scopeField.selectedItems.options.scopeId=t.id,e.fields.scopeField.selectedItems.options.ScopeMembers=t.ScopeMembers,widget.routeMgmtMediator.publish("initiateRoute-on-ScopeSelection",{scopeId:t.id,scopePhyId:e.fields.scopeField.selectedItems.options.value,ScopeMembers:t.ScopeMembers})})):widget.routeMgmtMediator.publish("initiateRoute-on-ScopeSelection",{scopeId:"",scopePhyId:""}))}(e)}})),define("DS/ENORouteMgmt/Model/RemoveRouteConfirmationModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Utilities/RouteViewUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n){"use strict";let s=new e;return{createModel:n=>function(n){return s=new e,s.prepareUpdate(),n.forEach((function(e){e.Activity_StateNLS=i.getRemoveRouteActivityState(e),e.revisionValue=i.getRemoveRouteRevision(e),e.Deleteicon=i.getDeleteAccess(e);var n=new t({label:e.Title,width:300,grid:{id:e.id,Title:e.Title,Maturity_State:e.Maturity_State,state:e.state,revisionValue:e.revisionValue,Activity_StateNLS:e.Activity_StateNLS,Deleteicon:e.Deleteicon},icons:[o.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_Route16.png")]});s.addRoot(n)})),s.pushUpdate(),s}(n),getModel:()=>s}})),define("DS/ENORouteMgmt/Views/Dialogs/StopRouteDemote",["DS/WAFData/WAFData","UWA/Core","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/Controls/Editor","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/ENORouteMgmt/Controller/RouteServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d){"use strict";let u,c,p={},m=function(e,t){require(["DS/ENORouteMgmt/Actions/RouteActions"],(function(o){o.stopRouteComments(e,t)})),c.close()},g=function(e,t,o){require(["DS/ENORouteMgmt/Actions/RouteActions"],(function(i){i.stopRouteWithDemoteConfirm(e,t,o)})),c.close()};return u={demoteConfirmation:(e,t,l)=>function(e,t,l){let u=new i;u.inject(document.body);var f=l;f=d.stopRoute+" : "+(f.length>40?f.substring(0,37)+"...":f);let h=new UWA.Element("div",{id:"stopConfirmation",class:""});if(p.formFields=new UWA.Element("div",{id:"stopComment",class:""}),p.fields={},new UWA.Element("p1",{text:d.RouteStopWarningDetails}).inject(p.formFields),p.formFields.inject(h),"true"==t){var w=new a({type:"checkbox"});w.addChild(new r({type:"checkbox",label:d.demoteConnectedObjects,checkFlag:!1})),w.inject(p.formFields);var v=!1;w.addEventListener("buttonclick",(function(e){v=e.dsModel.checkFlag}))}new UWA.Element("h5",{text:d.comments}).inject(p.formFields),p.fields.descField=new s({placeholder:d.enterComments,nbRows:5,newLineMode:"enter"}),p.fields.descField.inject(p.formFields),c=new o({modalFlag:!0,width:500,height:300,title:f,content:h,domId:"RouteImmersiveFrame",immersiveFrame:u,buttons:{Ok:new n({emphasize:"primary",label:d.stop,onClick:function(o){o.dsModel.dialog;let i=p.fields.descField.value;"true"==t?g(v,i,e):m(i,e)}}),Cancel:new n({onClick:function(e){e.dsModel.dialog.close()}})}})}(e,t,l)},u})),define("DS/ENORouteMgmt/Actions/RouteActions",["DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Views/Dialogs/ChooseUsersFromUserGroup","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Views/Dialogs/StopRouteDemote","DS/ENORouteMgmt/Utilities/ParseJSONUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a){"use strict";let r,l,d=function(o,i){let s=t.getRouteServiceBaseURL()+"/"+o+"?$fields=none,name&stopRouteCheck=true";e.stopRouteCheck(s).then((e=>{var t=e[0].isStateBased;n.demoteConfirmation(o,t,i)}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:a.FailureRouteStop,sticky:!1})}))},u=function(t,i,n,r,d){var u;if(m(),"stop"==d&&l){var c={StopCommentsValue:l};u=(new s).createDataForRequest(c)}e.updateState(i,u).then((o=>{widget.notify.handler().addNotif({level:"success",subtitle:n,sticky:!1}),e.fetchRouteById(t).then((e=>{g(),widget.routeMgmtMediator.publish("route-get-count-value",0),e[0].noTitleUpdate=!0,widget.routeMgmtMediator.publish("route-data-updated",e[0]),widget.routeMgmtMediator.publish("redraw-graph",e[0]),"resume"==d&&widget.routeMgmtMediator.publish("update-members-on-change-owner")}),(e=>{g(),widget.routeMgmtMediator.publish("route-get-count-value",0),e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:a.infoRefreshError,sticky:!1})}))}),(e=>{if(g(),widget.routeMgmtMediator.publish("route-get-count-value",0),e.error)if(-1!=e.error.indexOf(a.ErrorChooseUsers)){var i={routeId:t};new o.showSeletUsers(i)}else-1!=e.error.indexOf("No privilege for operation")?widget.notify.handler().addNotif({level:"error",subtitle:a.FailureRouteStop1,sticky:!1}):-1!=e.error.indexOf("Route cannot be started for future states of the associated type")||-1!=e.error.indexOf("Check trigger blocked event")?widget.notify.handler().addNotif({level:"error",subtitle:a.FailureRouteRestart1,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1});else widget.notify.handler().addNotif({level:"error",subtitle:r,sticky:!1})}))},c=function(t,i,n,s,r){m(),e.updateState(i).then((o=>{var i;i=o.data&&o.data[0]&&o.data[0].dataelements?o.data[0].dataelements.REVISED_ID:t,e.fetchRouteById(i).then((e=>{g(),"Define"==e[0].state?widget.notify.handler().addNotif({level:"warning",subtitle:a.inactiveUserRouteRestart,sticky:!1}):widget.notify.handler().addNotif({level:"success",subtitle:n,sticky:!1}),e[0].noTitleUpdate=!0;var o={};o.model=e[0];var i=!1;"idcard-ctxCommand"==r&&(i=!0),o.action=i,o.openRoute=i,widget.routeMgmtMediator.publish("route-summary-delete-row-by-ids",{model:t}),widget.routeMgmtMediator.publish("route-summary-append-rows",o),widget.routeMgmtMediator.publish("route-summary-refresh"),widget.routeMgmtMediator.publish("route-data-updated",e[0]),widget.routeMgmtMediator.publish("redraw-graph",e[0])}),(e=>{g(),e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:a.infoRefreshError,sticky:!1})}))}),(e=>{if(g(),widget.routeMgmtMediator.publish("route-get-count-value",0),e.error)if(-1!=e.error.indexOf(a.ErrorChooseUsers)){var i={routeId:t};new o.showSeletUsers(i)}else-1!=e.error.indexOf("No privilege for operation")?widget.notify.handler().addNotif({level:"error",subtitle:a.FailureRouteStop1,sticky:!1}):-1!=e.error.indexOf("Route cannot be started for future states of the associated type")||-1!=e.error.indexOf("Check trigger blocked event")?widget.notify.handler().addNotif({level:"error",subtitle:a.FailureRouteRestart1,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1});else widget.notify.handler().addNotif({level:"error",subtitle:s,sticky:!1})}))},p=function(e,t,o){const i=e.fields.ctx.findIndex((t=>{const o=t.split(".");return o[1]===e.fields.organization.value&&o[2]===e.fields.collaborativeSpace.value}));var n={type:"Route Template",collaborativeSpace:e.fields.collaborativeSpace.value,organization:e.fields.organization.value,ctx:e.fields.ctx[i],sConnectedRouteId:t.data[0].options.grid.id,description:e.fields.descField.value,attrAvailabilityType:"Organization",attrAvailabilityId:"",attRestrictMembers:e.fields.ScopeField.getText(),taskEditSetting:0==e.fields.routeTaskEdits.selectedIndex?"Modify/Delete Task List":1==e.fields.routeTaskEdits.selectedIndex?"Extend Task List":2==e.fields.routeTaskEdits.selectedIndex?"Modify Task List":"Maintain Exact Task List",preserveTaskOwner:"Retain"==e.fields.buttonGroupPTO.value[0]?"False":"True",AutoStopOnRejection:t.data[0].options.grid.AutoStopOnRejection,routeBasePurpose:t.data[0].options.grid.BasePurpose,completionAction:0==e.fields.completionAction.selectedIndex?"Notify Route Owner":"Promote Connected Object"};return widget.setValue("usedCollaborativeSpace",{prjtitle:e.fields.collaborativeSpace.label,prjname:e.fields.collaborativeSpace.value}),widget.setValue("usedOrganization",{orgtitle:e.fields.organization.label,orgname:e.fields.organization.value}),null!=e.fields.setPreserveTaskOwnerForTemplate&&0==e.fields.setPreserveTaskOwnerForTemplate.isHidden()&&(n.preserveTaskOwner="False"),(null!=o&&""!=o&&"Revise Template"!=e.fields.buttonGroupSA.value[0]||null==o||""==o)&&(n.title=e.fields.nameField.value,n.type="Route",n.selectUsersFromUserGroup="True"==e.fields.buttonGroupChooseUG.value[0]?"True":"False"),"Standard"==t.data[0].options.grid.BasePurpose&&null!=e.fields.linkedTemplateField.selectedItems&&(n.linkedRouteTemplateId=e.fields.linkedTemplateField.selectedItems.options.value,n.routeCompletionAction=e.fields.routeCompletionAction.value,n.DemoteOnRejection=e.fields.demoteOnRejection.value),e.fields.setNoForApprovalWithSign&&!e.fields.setNoForApprovalWithSign.isHidden()?n.routeRequiresESign="False":e.fields.approvalWithSign&&e.fields.approvalWithSign.visibleFlag?n.routeRequiresESign="True"==e.fields.approvalWithSign.value[0]?"True":"False":e.fields.setYesForApprovalWithSign&&!e.fields.setYesForApprovalWithSign.isHidden()?n.routeRequiresESign="True":n.routeRequiresESign="False",n},m=function(){require(["DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView"],(function(e){e.getDataGridInstance().displayModalLoader(a.operationInProgress)})),require(["DS/ENORouteMgmt/Views/Tile/RouteSummaryTileView"],(function(e){e.getTileViewInstance().displayModalLoader(a.operationInProgress)}))},g=function(){require(["DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView"],(function(e){e.getDataGridInstance().removeModalLoader(a.operationInProgress)})),require(["DS/ENORouteMgmt/Views/Tile/RouteSummaryTileView"],(function(e){e.getTileViewInstance().removeModalLoader(a.operationInProgress)}))};return r={startRoute:e=>function(e){u(e,t.getRouteServiceBaseURL()+"/"+e+"/start",a.routeStarted,a.failureToStartRoute,"start")}(e),stopRoute:(e,t)=>function(e,t){d(e,t)}(e,t),stopRouteComments:(e,o)=>function(e,o){l=e,u(o,t.getRouteServiceBaseURL()+"/"+o+"/stop?StopCommentsValue="+encodeURI(e),a.routeStopped,a.FailureRouteStop,"stop")}(e,o),stopRouteWithDemoteConfirm:(e,o,i)=>function(e,o,i){l=o,u(i,t.getRouteServiceBaseURL()+"/"+i+"/stop?demoteConnectedObject="+e+"&StopCommentsValue="+encodeURI(o),a.routeStopped,a.FailureRouteStop,"stop")}(e,o,i),resumeRoute:e=>function(e){u(e,t.getRouteServiceBaseURL()+"/"+e+"/resume",a.successRouteResume,a.FailureRouteResume,"resume")}(e),restartRoute:(e,o)=>function(e,o){c(e,t.getRouteServiceBaseURL()+"/"+e+"/restart",a.successRouteRestart,a.FailureRouteRestart,o)}(e,o),DeleteRoute:(t,o)=>function(t,o){e.deleteRoute(t).then((e=>{var o=a.successRemoveRoute;1==t.length&&(o=a.successRemoveRouteSingle),o=o.replace("{count}",t.length),widget.notify.handler().addNotif({level:"success",subtitle:o,sticky:!1}),widget.routeMgmtMediator.publish("route-summary-delete-row-by-ids",{model:t}),widget.routeMgmtMediator.publish("route-data-deleted",{model:t}),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:i.getModel()});let n=document.getElementsByClassName("wux-layouts-gridengine-poolcontainer-rel")[1].offsetHeight,s=document.getElementsByClassName("Route-tile-blank-space")[0];s&&(s.style.height=`calc(100% - ${n}px)`,s.style.width="100%")}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:a.errorRemove,sticky:!1})}))}(t),saveAsTemplate:(o,i)=>function(o,i){return new Promise((function(n,a){var r,l=i.data[0].options.grid.TemplateId,d=p(o,i,l),u=i.data[0].options.grid.id;d=(new s).createDataForRequest(d),r=null!=l&&""!=l&&"Revise Template"==o.fields.buttonGroupSA.value[0]?t.getRouteTemplateServiceBaseURL()+"/"+l+"/revise":t.getRouteServiceBaseURL()+"/"+u+"/savetemplate",e.saveAsTemplate(d,r).then((e=>n(e)),(e=>a(e)))}))}(o,i),refreshRouteObjectOnChangeOwner:(o,n)=>function(o,n){var s=[];let r;for(var l=0;l<o.data.length;l++)if(-1!=o.data[l].options.grid.Actions.indexOf("changeowner")){var d={};d.id=o.data[l].options.grid.id,s.push(d)}r={data:s},e.fetchRouteByIds(r).then((e=>{for(var o=[],s=t.getLoginUser(),a=widget.getValue("routefilters"),r=0;r<e.length;r++)if(e[r].owner==s||null!=e[r].assignees&&0!=e[r].assignees.length){if(e[r].assignees.length>0)for(var l=0;l<e[r].assignees.length;l++){if(e[r].owner==s||-1!=a.indexOf("assigned")&&e[r].assignees[l].split("~")[1]==s){"idCard"==n?(e[r].noTitleUpdate=!0,widget.routeMgmtMediator.publish("route-data-updated",e[r]),widget.routeMgmtMediator.publish("redraw-graph",e[r])):i.updateRow(e[r]);break}l==e[r].assignees.length-1&&o.push(e[r].id)}}else o.push(e[r].id);i.deleteRowModelByIds(o),widget.routeMgmtMediator.publish("route-summary-refresh"),"idCard"==n&&(e[0].owner&&(e[0].owner==s?widget.routeMgmtMediator.publish("show-edit-icon-in-tasks-tab"):o.length>0?widget.routeMgmtMediator.publish("route-task-close-click-view-mode"):(widget.routeMgmtMediator.publish("hide-edit-icon-in-tasks-tab"),widget.routeMgmtMediator.publish("hide-plus-icon-in-tasks-toolbar"),widget.routeMgmtMediator.publish("hide-remove-icon-in-tasks-toolbar"))),widget.routeMgmtMediator.publish("route-data-deleted",{model:o})),widget.routeMgmtMediator.publish("route-tag-data-updated"),widget.routeMgmtMediator.publish("update-members-on-change-owner")}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:a.infoRefreshError,sticky:!1})}))}(o,n),removeSubRoute:(t,o,n,s)=>function(t,o,n,s){e.removeSubRoute(t,o,n,"Route").then((e=>{var o=a.successRemoveSubRoute;1==t.length&&(o=a.successRemoveSubRouteSingle),o=o.replace("{count}",t.length),widget.notify.handler().addNotif({level:"success",subtitle:o,sticky:!1}),widget.routeMgmtMediator.publish("route-summary-delete-row-by-ids",{model:t}),widget.setValue("removedSubRoutes",t),widget.routeMgmtMediator.publish("route-data-deleted",{model:t}),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:i.getModel()})}),(e=>{e&&e.error&&e.error.indexOf("#1500028")>=0&&e.error.indexOf("No fromdisconnect access to object")>0?widget.notify.handler().addNotif({level:"error",subtitle:a.errorNoDissconnectAccessOnRoute,sticky:!1}):e&&e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:a.errorRemove,sticky:!1})}))}(t,o,n),renderRevisionsDialog:e=>function(e){require(["DS/LifecycleCmd/HistoryCmd"],(function(t){var o=[{options:{physicalid:e},getID:function(){return e}}];(t=new t({ID:"revisions_cmd_ID",context:{getSelectedNodes:()=>o}})).begin()}))}(e)},r})),define("DS/ENORouteMgmt/Views/Grid/TaskAttachmentsGridCustomColumn",["DS/ENORouteMgmt/Actions/RouteActions","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";return{onRouteNodeAttachmentCellRequest:t=>function(t){let o;if(!t.isHeader&&(o=t.cellView.collectionView.reuseCellContent("_attachmentList_"),o)){o.removeEvents();var i=t.nodeModel.options.grid.typeicon,n=t.nodeModel.options.grid.Title,s=t.nodeModel.options.grid.Revision,a=t.nodeModel.options.grid.id,r=t.nodeModel.options.grid.isLatestRevision;o.getChildren()[0].getChildren()[0].src=i,o.getChildren()[0].getChildren()[1].setText(n),o.getChildren()[0].getChildren()[2].getChildren()[0].setText(s),o.getChildren()[0].getChildren()[2].removeEvents(),o.getChildren()[0].getChildren()[2].setStyle("cursor","pointer"),o.getChildren()[0].getChildren()[2].addEvent("click",(function(t){e.renderRevisionsDialog(a)})),null==r?o.getChildren()[0].getChildren()[3].addClassName(" "):"TRUE"==r?o.getChildren()[0].getChildren()[3].addClassName("wux-ui-genereatedicon-fi wux-ui-3ds wux-ui-3ds-check wux-ui-3ds-lg"):o.getChildren()[0].getChildren()[3].addClassName("wux-ui-genereatedicon-fi wux-ui-3ds wux-ui-3ds-wrong wux-ui-3ds-lg"),t.cellView._setReusableContent(o)}}(t)}})),define("DS/ENORouteMgmt/Views/InitiateRoutePropertiesView",["DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/Accordeon","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Utilities/Dom","DS/ENORouteMgmt/Views/Loader/InitiateRouteTemplateChooser","DS/ENORouteMgmt/Views/Loader/InitiateRouteScopeChooser","DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/InitiatePropertiesCustomAttributeUtility","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h){"use strict";let w,v,S,k=function(r,p){let f,k,M,D,C;w.contentIds=p.contentIdsList,w.formFields=new UWA.Element("div",{id:"InitiateRoutePropertiesContainer",class:""}),w.advFormFields=new UWA.Element("div",{id:"InitiateRouteAdvancedContainer",class:"main-panel"}),w.routeTemplateField=new UWA.Element("div",{id:"SearchTemplatesField",class:"fonticon-chooser-display"}),w.routeScopeField=new UWA.Element("div",{id:"SeachScopeField",class:"fonticon-chooser-scope-display"}),w.fields={},w.formFields.inject(r),f=T("initiate-Route-Field",w.formFields),k=T("initiate-Route-Field-Label",f),k.addClassName("expand"),M=new UWA.Element("div").inject(f),M.style.width="2%",D=T("initiate-Route-Field-Value",f),D.addClassName("expand"),v=new UWA.Element("h5",{class:"required",text:h.title}).inject(k),v.tooltipInfos=y(h.title),C=new UWA.Element("div",{class:"asterisk-icon"}).inject(k),UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(C),w.fields.name=new e({pattern:"[^./#,\\[\\]\\$\\^@\\*\\?%:'\"\\\\<>;|]+",sizeInCharNumber:61}),w.fields.name.domId="Route_name",w.fields.name.inject(D),S=R("routeTitleInfo",h.initiateRouteOrTaskTitleHelp,k),w.fields.name.addEventListener("uncommittedChange",(function(e){widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons",{properties:w})})),f=T("initiate-Route-Field",w.formFields),f.setAttribute("id","initiateRouteFieldCollabSpace"),k=T("initiate-Route-Field-Label",f),k.addClassName("expand"),M=new UWA.Element("div").inject(f),M.style.width="2%",D=T("initiate-Route-Field-Value",f),D.addClassName("expand"),v=new UWA.Element("h5",{text:h.collaborativeSpace}).inject(k),v.tooltipInfos=y(h.collaborativeSpace),C=new UWA.Element("div",{class:"asterisk-icon"}).inject(k),UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(C);let E=[],A=[],O=widget.getValue("usedCollaborativeSpace");p.credentialResponseData.credentials.forEach((e=>{if(e.ctxtitle){E.some((t=>t.prjname===e.prjname))||E.push({prjtitle:e.prjtitle?e.prjtitle:e.prjname,prjname:e.prjname}),A.push(e.ctxname)}}));let I,N=m.getSecurityContextValue().split("ctx::")[1],U=p.credentialResponseData.credentials.findIndex((e=>e.ctxname===N));if(O){if(I=E.findIndex((e=>e.prjname===O.prjname)),I>-1){const[e]=E.splice(I,1);E.unshift(e)}}else if(U>-1){let e=E.findIndex((e=>e.prjname===N.split(".")[2]));const[t]=E.splice(e,1);E.unshift(t)}w.fields.collaborativeSpace=new a({disabled:!1,elementsList:E.map((function(e){return{label:e.prjtitle,value:e.prjname}})),enableSearchFlag:!1,placeholder:h.collaborativeSpacePlaceholder,reachablePlaceholderFlag:(void 0===O||-1==I)&&-1==U&&E.length>1}).inject(D),w.fields.ctx=A,w.fields.collaborativeSpace.domId="collaborativeSpace",1===E.length&&(w.fields.collaborativeSpace.disabled=!0),w.fields.collaborativeSpace.inject(D),S=R("collaborativeSpaceinfo",h.collaborativeSpaceInfo,k),f=T("initiate-Route-Field",w.formFields),f.setAttribute("id","initiateRouteFieldOrg"),k=T("initiate-Route-Field-Label",f),k.addClassName("expand"),M=new UWA.Element("div").inject(f),M.style.width="2%",D=T("initiate-Route-Field-Value",f),D.addClassName("expand"),v=new UWA.Element("h5",{text:h.Organization}).inject(k),v.tooltipInfos=y(h.Organization),C=new UWA.Element("div",{class:"asterisk-icon"}).inject(k),UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(C);let _,F=[],P=widget.getValue("usedOrganization");if(p.credentialResponseData.credentials.forEach((e=>{if(e.ctxtitle&&e.prjname===w.fields.collaborativeSpace.value){F.some((t=>t.orgname===e.orgname))||F.push({orgname:e.orgname,orgtitle:e.orgtitle})}})),P){if(_=F.findIndex((e=>e.orgname===P.orgname)),_>-1){const[e]=F.splice(_,1);F.unshift(e)}}else if(U>-1){let e=F.findIndex((e=>e.orgname===N.split(".")[1]));const[t]=F.splice(e,1);F.unshift(t)}w.fields.organization=new a({disabled:!1,elementsList:F.map((function(e){return{label:e.orgtitle,value:e.orgname}})),enableSearchFlag:!1,placeholder:h.orgPlaceholder,reachablePlaceholderFlag:(null==P||-1==_)&&-1==U&&F.length>1}).inject(D),F.length<2&&document.getElementById("initiateRouteFieldOrg").classList.add("hideInitiateRouteFieldOrg"),w.fields.collaborativeSpace.addEventListener("change",(function(){F=[],p.credentialResponseData.credentials.forEach((e=>{if(e.ctxname&&e.prjname===w.fields.collaborativeSpace.value){F.some((t=>t.orgname===e.orgname))||F.push({orgname:e.orgname,orgtitle:e.orgtitle})}})),F.length>1?(document.getElementById("initiateRouteFieldOrg").classList.remove("hideInitiateRouteFieldOrg"),w.fields.organization.disabled=!1):document.getElementById("initiateRouteFieldOrg").classList.add("hideInitiateRouteFieldOrg"),w.fields.organization.elementsList=F.map((function(e){return{label:e.orgtitle,value:e.orgname}})),w.fields.organization.selectedIndex=0,widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons",{properties:w})})),w.fields.organization.addEventListener("change",(function(){widget.routeMgmtMediator.publish("initiateRoute-on-ScopeSelection",{scopeId:w.fields.buttonGroupScope.value,scopePhyId:""}),widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons",{properties:w}),widget.setValue("routeOrgnization",w.fields.organization.value)})),widget.setValue("routeOrgnization",w.fields.organization.value),w.fields.organization.domId="organization",1==F.length&&null==P&&(w.fields.organization.disabled=!0),S=R("organizationInfo",h.organizationInfo,k),w.fields.organization.inject(D),f=T("initiate-Route-Field",w.formFields),k=T("initiate-Route-Field-Label",f),k.addClassName("expand"),M=new UWA.Element("div").inject(f),M.style.width="2%",D=T("initiate-Route-Field-Value",f),D.addClassName("expand"),v=new UWA.Element("h5",{text:h.routeTemplate}).inject(k),v.tooltipInfos=y(h.routeTemplate);var x={isMultiSearchMode:!1};x.placeHolderValue=h.typeToSearch,x.minLengthToType=3,x.isFreeInputAllowed=!1,x.toKeepSearchResultsFlag=!1,x.getPrecond=function(){return l.getPrecondForTemplateSearch()},x.getChangeHandler=function(){return l.changeHandlerFortemplateField(w)},w.fields.templateField=u.drawAutoCompleteComponent(x),w.fields.templateField.inject(w.routeTemplateField),new UWA.Element("div",{html:"&nbsp;"}).inject(w.routeTemplateField),w.fields.templateChooser=new n({icon:{iconName:"search"}}),w.fields.templateChooser.inject(w.routeTemplateField),w.fields.templateChooser.getContent().addEventListener("buttonclick",(function(){l.init(event,w)})),w.routeTemplateField.inject(D),S=R("routeTemplateSearchInfo",h.initiateRouteTemplateSearchHelp,k),f=T("initiate-Route-Field",w.formFields),k=T("initiate-Route-Field-Label",f),k.addClassName("expand"),M=new UWA.Element("div").inject(f),M.style.width="2%",D=T("initiate-Route-Field-Value",f),D.addClassName("expand"),v=new UWA.Element("h5",{text:h.description}).inject(k),v.tooltipInfos=y(h.description),v.style.marginTop="11px",w.fields.descField=new t({widthInCharNumber:61,nbRows:3,newLineMode:"enter"}),w.fields.descField.inject(D),w.fields.descField.domId="Route_description",f=T("initiate-Route-Field",w.advFormFields),k=T("initiate-Route-Field-Label",f),M=new UWA.Element("div").inject(f),M.style.width="2%",D=T("initiate-Route-Field-Value",f),v=new UWA.Element("h5",{class:"required",text:h.routeBasePurpose}).inject(k),v.tooltipInfos=y(h.routeBasePurpose),w.fields.routePurpose=new a({elementsList:[h.standard,h.Approval,h.Review],enableSearchFlag:!1}).inject(D),S=R("routeBasePurposeInfo",h.initiateRouteBasePurposeHelp,k),w.fields.routePurpose.addEventListener("change",(function(e){let t=e.dsModel.selectedIndex;t=t=0==t?"Standard":1==t?"Approval":"Review",widget.routeMgmtMediator.publish("initiateRoute-on-RouteBasePurposeSelection",{basePurpose:t})})),f=T("initiate-Route-Field",w.advFormFields),k=T("initiate-Route-Field-Label",f),M=new UWA.Element("div").inject(f),M.style.width="2%",D=T("initiate-Route-Field-Value",f),v=new UWA.Element("h5",{class:"required",text:h.routeCompletionAction}).inject(k),v.tooltipInfos=y(h.routeCompletionAction);var V=new UWA.Element("div",{id:"completeActionDiv",class:""}).inject(D);S=R("routeCompletionActionInfo",h.initiateRouteCompletionActionHelp,k),w.fields.routeCompletionAction=new a({elementsList:[h.notifyRouteOwner,h.promoteConnectedObject],enableSearchFlag:!1}),w.fields.routeCompletionAction.inject(V),f=T("initiate-Route-Field",w.advFormFields),f.setAttribute("id","demoteOnRejectionRoute"),k=T("initiate-Route-Field-Label",f),M=new UWA.Element("div").inject(f),M.style.width="2%",D=T("initiate-Route-Field-Value",f),v=new UWA.Element("h5",{class:"required",text:h.DemoteOnRejection}).inject(k),v.tooltipInfos=y(h.DemoteOnRejection),w.fields.DemoteOnRejection=new a({elementsList:[h.no,h.yes],enableSearchFlag:!1}),w.fields.DemoteOnRejection.inject(D),S=R("routeDemoteOnRejectionInfo",h.initiateRouteDemoteOnRejectionHelp,k),p&&p.inboxTaskId&&(w.inboxTaskId=p.inboxTaskId,f=T("initiate-Route-Field",w.advFormFields),k=T("initiate-Route-Field-Label",f),M=new UWA.Element("div").inject(f),M.style.width="2%",D=T("initiate-Route-Field-Value",f),v=new UWA.Element("h5",{class:"required",text:h.visibleToParent}).inject(k),v.tooltipInfos=y(h.visibleToParent),w.fields.visibleToParent=new a({elementsList:[h.no,h.yes],enableSearchFlag:!1}).inject(D),S=R("routeVisibleToParentInfo",h.initiateVisibleToParent,k)),f=T("initiate-Route-Field",w.advFormFields),f.setAttribute("id","autoStartOnRejectionRoute"),k=T("initiate-Route-Field-Label",f),M=new UWA.Element("div").inject(f),M.style.width="2%",D=T("initiate-Route-Field-Value",f),v=new UWA.Element("h5",{class:"required",text:h.routeAutoStopOnRejection}).inject(k),v.tooltipInfos=y(h.routeAutoStopOnRejection),w.fields.routeAutoStopOnRejection=new a({elementsList:[h.immediate,h.deferred],enableSearchFlag:!1}),w.fields.routeAutoStopOnRejection.inject(D),S=R("routeAutoStopOnRejectionInfo",h.initiateRouteAutoStopOnRejectionHelp,k),f=T("initiate-Route-Field",w.advFormFields),k=T("initiate-Route-Field-Label",f),M=new UWA.Element("div").inject(f),M.style.width="2%",D=T("initiate-Route-Field-Value",f),v=new UWA.Element("h5",{class:"required",text:h.routeScope}).inject(k),v.tooltipInfos=y(h.routeScope),w.fields.buttonGroupScope=new i({type:"radio"}),null!=p.scopeId&&null!=p.scopeId&&null!=p.scopePhyId&&null!=p.scopePhyId?w.fields.buttonGroupScope.addChild(new s({type:"radio",label:h.selectScope,value:"scope",checkFlag:!0})):(w.fields.buttonGroupScope.addChild(new s({type:"radio",label:h.scopeAll,value:"All"})),w.fields.buttonGroupScope.addChild(new s({type:"radio",label:h.scopeOrg,value:"Organization",checkFlag:!0})),w.fields.buttonGroupScope.addChild(new s({type:"radio",label:h.selectScope,value:"scope"}))),w.fields.buttonGroupScope.inject(D),S=R("routeScopeInfo",h.initiateRouteScopeHelp,k),w.fields.buttonGroupScope.addEventListener("change",(function(e){"scope"==e.dsModel.value?(w.routeScopeField.className="fonticon-chooser-display",w.fields.scopeField._editor.elements.inputField.focus(),widget.routeMgmtMediator.publish("initiateRoute-on-ScopeSelection",{scopeId:"",scopePhyId:""})):(w.fields.scopeField.selectedItems=void 0,widget.routeMgmtMediator.publish("initiateRoute-on-ScopeSelection",{scopeId:e.dsModel.value,scopePhyId:""}),w.routeScopeField.className="fonticon-chooser-scope-display")}));var W={isMultiSearchMode:!1};var L;(W.placeHolderValue=h.typeToSearch,W.minLengthToType=3,W.isFreeInputAllowed=!1,W.toKeepSearchResultsFlag=!1,W.getPrecond=function(){return d.getPrecondForScope()},W.getChangeHandler=function(){return d.changeHandlerForScopeField(w,p)},w.fields.scopeField=u.drawAutoCompleteComponent(W),w.fields.scopeField.inject(w.routeScopeField),new UWA.Element("div",{html:"&nbsp;"}).inject(w.routeScopeField),w.fields.scopeChooser=new n({icon:{iconName:"search"}}),w.fields.scopeChooser.getContent().addEventListener("buttonclick",(function(){d.init(event,w)})),null!=p.scopeId&&null!=p.scopeId&&null!=p.scopePhyId&&null!=p.scopePhyId)?(L=new c({label:p.scopeValue,value:p.scopePhyId,scopeId:p.scopeId,ScopeMembers:p.ScopeMembers}),w.fields.scopeField.options.fromBookMarkEditor=!0,w.fields.scopeField.selectedItems=L,w.routeScopeField.className="fonticon-chooser-display",w.fields.scopeField._editor.elements._clearFieldButton.hide(),w.fields.scopeField._editor.elements.inputField.disabled=!0):w.fields.scopeChooser.inject(w.routeScopeField);f=T("initiate-Route-Field",w.advFormFields),k=T("initiate-Route-Field-Label",f),M=new UWA.Element("div").inject(f),M.style.width="2%",D=T("initiate-Route-Field-Value",f),w.routeScopeField.inject(D),f=T("initiate-Route-Field",w.advFormFields),f.setAttribute("id","userGroupAssignmentRoute"),k=T("initiate-Route-Field-Label",f),M=new UWA.Element("div").inject(f),M.style.width="2%",D=T("initiate-Route-Field-Value",f),v=new UWA.Element("h5",{class:"required",id:"PreserveTaskOwner",text:h.PreserveTaskOwnerLabel}).inject(k),v.tooltipInfos=y(h.PreserveTaskOwnerLabel),w.fields.buttonGroupUGA=new i({type:"radio",class:"userGroupAssignment"});let j=new s({type:"radio",label:h.PreserveTaskOwnerSelect2,value:"Retain",checkFlag:!0});j.tooltipInfos=y(h.PreserveTaskOwnerSelect2);let B=new s({type:"radio",label:h.PreserveTaskOwnerSelect1,title:h.PreserveTaskOwnerSelect2,value:"Reset"});B.tooltipInfos=y(h.PreserveTaskOwnerSelect1),w.fields.buttonGroupUGA.addChild(j),w.fields.buttonGroupUGA.addChild(B),w.fields.buttonGroupUGA.inject(D),S=R("routeUserGroupAssignmentInfo",h.initiateRouteRevertUserGroupHelp,k);let G=new o({items:[{header:h.advancedOptions,content:w.advFormFields}],exclusive:!1,style:"filled-separate"});G.addEventListener("expand",(function(e){let t=document.querySelectorAll(".initiate-Route-Field-Label");if(0!=t.length)for(let e=0;e<t.length;e++)document.querySelectorAll(".initiate-Route-Field-Label")[e].removeClassName("expand"),document.querySelectorAll(".initiate-Route-Field-Value")[e].removeClassName("expand")})),G.addEventListener("collapse",(function(e){let t=document.querySelectorAll(".initiate-Route-Field-Label");if(0!=t.length)for(let e=0;e<t.length;e++)document.querySelectorAll(".initiate-Route-Field-Label")[e].addClassName("expand"),document.querySelectorAll(".initiate-Route-Field-Value")[e].addClassName("expand")})),new UWA.Element("h2",{text:"",id:"formFieldSpacing"}).inject(w.formFields),G.inject(w.formFields),p&&p.templateId&&(b(p.templateId),setTimeout((function(){w.fields.name.elements.inputField.focus()}),1e3)),w.fields.name.elements.inputField.focus(),g.renderCustomAttributes(w)},T=function(e,t){return p.createNewElement(e,t)},R=function(e,t,o){return p.createTooltipElement(e,t,o)},y=function(e){return p.getElementToolTip(e)},b=function(e){var t=[{id:e}];l.populateTemplate(t,w)};return{build:(e,t)=>function(e,t){w={},p.makeResponsiveCss("initiateRoute",".route-initiate-properties-container"),k(e,t)}(e,t),destroy:()=>{w={}},getProperties:()=>w}})),define("DS/ENORouteMgmt/Views/Loader/InitiateRoutePropertiesLoader",["DS/ENORouteMgmt/Views/InitiateRoutePropertiesView","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";let o={};return{init:function(t){this.showView()||(o.container=new UWA.Element("div",{html:"",id:"InitiateRouteFormView",class:"route-initiate-properties-container"}),o.container.inject(document.querySelector("#iRouteTabsContainer")),e.build(o.container,t))},hideView:function(){document.querySelector("#InitiateRouteFormView")&&document.querySelector("#InitiateRouteFormView").getChildren().length>0&&(document.getElementById("InitiateRouteFormView").style.display="none")},showView:function(){return!!(document.querySelector("#InitiateRouteFormView")&&document.querySelector("#InitiateRouteFormView").getChildren().length>0)&&(document.getElementById("InitiateRouteFormView").style.display="block",!0)},destroy:function(){e.destroy()},getModel:function(){return e.getProperties()}}})),define("DS/ENORouteMgmt/Config/TaskAttachmentsGridViewConfig",["DS/ENORouteMgmt/Views/Grid/TaskAttachmentsGridCustomColumn","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";return[{text:t.title,dataIndex:"tree",onCellRequest:e.onRouteNodeAttachmentCellRequest}]})),define("DS/ENORouteMgmt/Config/RouteTaskContentToReviewGridViewConfig",["DS/ENORouteMgmt/Views/Grid/TaskAttachmentsGridCustomColumn","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";return[{text:t.title,dataIndex:"tree",onCellRequest:e.onRouteNodeAttachmentCellRequest}]})),define("DS/ENORouteMgmt/Utilities/RouteLinkWidgetUtil",["DS/RouteWebAppUX/Utilities/RouteLinkWidget","DS/RouteWebAppUX/Utilities/CompassDataExchange","DS/RouteWebAppUX/Views/RouteActivityState","DS/ENORouteMgmt/Controller/RouteServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n){"use strict";let s,a,r=function(){a.subscribe("refresh-route-data",(function(e){widget.routeMgmtMediator.publish("route-RefreshData-linkWidget-published",e)})),a.subscribe("load-route-data",(function(e){let t,o=e.dropData.data,i=o.items,n=[];i.forEach((function(e){n.push(e.objectId),t=e.objectType})),1==i.length&&"Inbox Task"==o.approvalObjectType&&(widget.data.contentId=i[0].objectId,widget.data.contentType=o.approvalObjectType,widget.data.taskId=i[0].objectId,t=o.approvalObjectType),i.length>0&&(widget.data.linkedContextTitle=i[0].linkedContextTitle),widget.data.approvalProcessIds=n,widget.data.approvalProcessType=t,"route_templates"===widget.getValue("HomePage")?(widget.setValue("openSelected",!0),widget.routeMgmtMediator.publish("welcome-panel-load-subscribed-data",{id:"routes"})):widget.routeMgmtMediator.publish("route-data-linkWidget-published")})),widget.routeMgmtMediator.subscribe("route-data-updated",(function(e){l(e,!1)})),widget.routeMgmtMediator.subscribe("route-created",(function(e){null!=widget.data.fromContext&&""!=widget.data.fromContext||(widget.data.fromContext="createNewRoute"),l(e,!1)})),widget.routeMgmtMediator.subscribe("route-content-updated",(function(e){l(e,!0)}))},l=function(e,t){if(t){for(var o=[],n=0;n<e.length;n++){var s={};s.id=e[n].id,o.push(s)}d({data:o})}else i.fetchRouteContentIds(e.id).then((e=>{if(null!=e){for(var t=[],o=0;o<e.data.length;o++){var i={};i.id=e.data[o].id,t.push(i)}d({data:t})}}),(e=>{}))},d=function(e){i.fetchApprovalStatusForContent(e).then((e=>{var o;if(null!=e){o={};for(var i=0;i<e.data.length;i++){var n=t.createModel(e.data[i]),s=e.data[i].id;o[s]={},o[s].approvalStatus=n.model.Activity_State,o[s].approvalStatusModel=n,o[s].maturity=n.model.current,o[s].maturity_NLS=n.model.current_NLS}}a.publish("load-route-data",o)}),(e=>{}))};return s={subscribeEvents:()=>r(),init:()=>(a=e.init(widget,{appIds:["ENOWCHG_AP","ENXWDOC_AP","ENOFOL3_AP"],open:!0}),void r())},s})),define("DS/ENORouteMgmt/Views/InitiateSaveAsTemplateView",["DS/Controls/LineEditor","DS/WebappsUtils/WebappsUtils","DS/Controls/Editor","DS/Controls/Accordeon","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Utilities/Dom","DS/ENORouteMgmt/Views/Loader/InitiateSaveAsTemplateLinkTemplateChooser","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,p,g,f){let h,w,v,S,k,T,R=function(i,l,u,p,R){let A,O,I,N;if(k=p,w=u,v=l,S={},S.formFields=new UWA.Element("div",{id:"SaveAsTemplatePropertiesContainer",class:""}),S.fields={},S.formFields.inject(i),S.linkTemplateCompleteActionField=new UWA.Element("div",{id:"linkTemplateCompleteActionField",class:"fonticon-chooser-scope-display"}),S.demoteOnRejectionField=new UWA.Element("div",{id:"demoteOnRejectionField",class:"fonticon-chooser-scope-display"}),null!=l.data[0].options.grid.TemplateName&&"Archive"!=u.state){let e=t.getWebappsAssetUrl("ENORouteTemplateMgmt","icons/144/I_RouteTemplate108x144.png");var U=new UWA.Element("h5",{id:"SaveOptions",styles:{"font-weight":"normal"},html:[UWA.createElement("span",{html:f.SaveOptions+"&nbsp;"}),UWA.createElement("div",{class:"saveAsTemplate-title",styles:{"background-image":"url("+e+")"}}),UWA.createElement("span",{html:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"}),UWA.createElement("span",{text:w.title})]}).inject(S.formFields);let o=f.SaveOptions+" "+w.title;U.tooltipInfos=E(o),A=D("initiate-Route-Field",S.formFields),O=D("initiate-Route-Field-Label",A),I=new UWA.Element("div").inject(A),I.style.width="2%",N=D("initiate-Route-Field-Value",A);var _=f.ReviseTemplate;_=_+" "+w.title,S.fields.buttonGroupSA=new n({type:"radio"});var F=new a({type:"radio",label:_,value:"Revise Template",checkFlag:!0});F.tooltipInfos=E(_);var P=new a({type:"radio",label:f.SaveasNewTemplate,value:"Save as New Template"});P.tooltipInfos=E(f.SaveasNewTemplate),S.fields.buttonGroupSA.addChild(F),S.fields.buttonGroupSA.addChild(P),S.fields.buttonGroupSA.inject(N),S.fields.buttonGroupSA.addEventListener("change",(function(e){if("Save as New Template"==S.fields.buttonGroupSA.value){widget.routeMgmtMediator.publish("initiate-saveAsTemplate-toggle-dialogbuttons"),S.fields.buttonGroupChooseUG.selectIndex(0),S.fields.buttonGroupChooseUG.show(),S.fields.selectUsersFromUserGroupFortemplate.hide(),S.fields.setPreserveTaskOwnerForTemplate.hide(),S.fields.buttonGroupPTO.show(),S.fields.name.className="",null!=document.querySelector(".initiate-Route-Field-LinkedTemplate.fonticon-chooser-scope-display")&&document.querySelector(".initiate-Route-Field-LinkedTemplate.fonticon-chooser-scope-display").classList.remove("fonticon-chooser-scope-display"),"All"!=v.data[0].options.grid.Scope[0]&&"Organization"!=v.data[0].options.grid.Scope[0]&&S.fields.ScopeField.setText("All"),"Approval"!=v.data[0].options.grid.BasePurpose&&"Standard"!=v.data[0].options.grid.BasePurpose||M(),""==S.fields.nameField.elements.inputField.value&&setTimeout((function(){S.fields.nameField.elements.inputField.focus()}),1e3);const e=document.getElementById("initiateRouteFieldOrg");e&&(q.length>1?(e.classList.remove("hideInitiateRouteFieldOrg"),S.fields.organization.disabled=!1):e.classList.add("hideInitiateRouteFieldOrg")),S.fields.collaborativeSpace.elementsList=z,S.fields.organization.elementsList=J,S.fields.collaborativeSpace.disabled=!1,S.fields.organization.disabled=!1}else y(),S.fields.name.className="fonticon-chooser-scope-display",document.querySelector(".initiate-Route-Field-LinkedTemplate").addClassName("fonticon-chooser-scope-display"),setTimeout((function(){document.querySelector("#SaveAsTemplatePropertiesContainer #SaveOptions").scrollIntoView()}),1e3),X()}))}"Archive"==u.state&&(S.fields.buttonGroupSA={},S.fields.buttonGroupSA.value=["Save as New Template"]),S.fields.name=new UWA.Element("div",{id:"title",class:"fonticon-chooser-scope-display"}),A=D("initiate-Route-Field-LinkedTemplate",S.formFields),A.addClassName("fonticon-chooser-scope-display"),A.setAttribute("id","templateTitle"),O=D("initiate-Route-Field-Label-LinkedTemplate",A),I=new UWA.Element("div").inject(A),I.style.width="2%",N=D("initiate-Route-Field-Value-LinkedTemplate",A),h=new UWA.Element("h5",{id:"NameField",text:f.title}).inject(O),h.tooltipInfos=E(f.title),UWA.createElement("div",{id:"asterisk",class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(h),S.fields.nameField=new e({placeholder:"",pattern:"[^./#,\\[\\]\\$\\^@\\*\\?%:'\"\\\\<>;|]+",sizeInCharNumber:61}),S.fields.nameField.inject(N),S.fields.nameField.addEventListener("uncommittedChange",(function(e){widget.routeMgmtMediator.publish("initiate-saveAsTemplate-toggle-dialogbuttons")})),T=C("templateTitleInfo",f.initiateRouteSaveAsTemplateTitleHelp,O),S.fields.name.inject(S.formFields),A=D("initiate-Route-Field",S.formFields),O=D("initiate-Route-Field-Label",A),I=new UWA.Element("div").inject(A),I.style.width="2%",N=D("initiate-Route-Field-Value",A),h=new UWA.Element("h5",{text:f.collaborativeSpace}).inject(O),h.tooltipInfos=E(f.collaborativeSpace),UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(h);let x=[],V=[],W=widget.getValue("usedCollaborativeSpace");R.credentials.forEach((e=>{if(e.ctxtitle){x.some((t=>t.prjname===e.prjname))||x.push({prjtitle:e.prjtitle?e.prjtitle:e.prjname,prjname:e.prjname}),V.push(e.ctxname)}}));let L,j=g.getSecurityContextValue().split("ctx::")[1],B=R.credentials.findIndex((e=>e.ctxname===j));if(W){if(L=x.findIndex((e=>e.prjname===W.prjname)),L>-1){const[e]=x.splice(L,1);x.unshift(e)}}else if(B>-1){let e=x.findIndex((e=>e.prjname===j.split(".")[2]));const[t]=x.splice(e,1);x.unshift(t)}S.fields.collaborativeSpace=new r({disabled:!1,elementsList:x.map((function(e){return{label:e.prjtitle,value:e.prjname}})),enableSearchFlag:!1}).inject(N),S.fields.ctx=V,S.fields.collaborativeSpace.domId="collaborativeSpace",1===x.length&&(S.fields.collaborativeSpace.disabled=!0),S.fields.collaborativeSpace.inject(N),T=C("collaborativeSpaceinfo",f.collaborativeSpaceInfo,O),A=D("initiate-Route-Field",S.formFields),A.setAttribute("id","initiateRouteFieldOrg"),O=D("initiate-Route-Field-Label",A),I=new UWA.Element("div").inject(A),I.style.width="2%",N=D("initiate-Route-Field-Value",A),h=new UWA.Element("h5",{text:f.Organization}).inject(O),h.tooltipInfos=E(f.Organization),UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(h);let G,q=[],H=widget.getValue("usedOrganization");if(R.credentials.forEach((e=>{if(e.ctxtitle&&e.prjname===S.fields.collaborativeSpace.value){q.some((t=>t.orgname===e.orgname))||q.push({orgname:e.orgname,orgtitle:e.orgtitle})}})),H){if(G=q.findIndex((e=>e.orgname===H.orgname)),G>-1){const[e]=q.splice(G,1);q.unshift(e)}}else if(B>-1){let e=q.findIndex((e=>e.orgname===j.split(".")[1]));const[t]=q.splice(e,1);q.unshift(t)}S.fields.organization=new r({disabled:!1,elementsList:q.map((function(e){return{label:e.orgtitle,value:e.orgname}})),enableSearchFlag:!1}).inject(N),q.length<2&&A.classList.add("hideInitiateRouteFieldOrg"),S.fields.collaborativeSpace.addEventListener("change",(function(){q=[],R.credentials.forEach((e=>{if(e.ctxname&&e.prjname===S.fields.collaborativeSpace.value){q.some((t=>t.orgname===e.orgname))||q.push({orgname:e.orgname,orgtitle:e.orgtitle})}}));const e=document.getElementById("initiateRouteFieldOrg");e&&(q.length>1?(e.classList.remove("hideInitiateRouteFieldOrg"),S.fields.organization.disabled=!1):e.classList.add("hideInitiateRouteFieldOrg")),S.fields.organization.elementsList=q.map((function(e){return{label:e.orgtitle,value:e.orgname}})),S.fields.organization.selectedIndex=0,widget.routeMgmtMediator.publish("initiate-saveAsTemplate-toggle-dialogbuttons",{properties:S})})),S.fields.organization.addEventListener("change",(function(){widget.routeMgmtMediator.publish("initiate-saveAsTemplate-toggle-dialogbuttons",{properties:S}),widget.setValue("templateOrgnization",S.fields.organization.value)})),widget.setValue("templateOrgnization",S.fields.organization.value),S.fields.organization.domId="organization",1==q.length&&null==H&&(S.fields.organization.disabled=!0);const z=[...S.fields.collaborativeSpace.elementsList],J=[...S.fields.organization.elementsList];function X(){if(F&&F.checkFlag){if(R.credentials.some((e=>e.prjname===w.project&&e.orgname===w.organization))){const e=S.fields.collaborativeSpace.elementsList.findIndex((e=>e.value===w.project));S.fields.collaborativeSpace.selectedIndex=e;const t=S.fields.organization.elementsList.findIndex((e=>e.value===w.organization));S.fields.organization.selectedIndex=t}else S.fields.collaborativeSpace.elementsList=[],S.fields.organization.elementsList=[],S.fields.collaborativeSpace.placeholder="",S.fields.organization.placeholder="";document.getElementById("initiateRouteFieldOrg").classList.add("hideInitiateRouteFieldOrg"),S.fields.collaborativeSpace.disabled=!0,S.fields.organization.disabled=!0}}X(),T=C("organizationInfo",f.organizationInfo,O),S.fields.organization.inject(N),A=D("initiate-Route-Field",S.formFields),O=D("initiate-Route-Field-Label",A),I=new UWA.Element("div").inject(A),I.style.width="2%",N=D("initiate-Route-Field-Value",A),h=new UWA.Element("h5",{text:f.description}).inject(O),h.setAttribute("id","save_As_template_Description_label"),h.tooltipInfos=E(f.description),h.style.marginTop="11px",S.fields.descField=new o({widthInCharNumber:63,nbRows:3,newLineMode:"enter"}),S.fields.descField.inject(N),A=D("initiate-Route-Field",S.formFields),O=D("initiate-Route-Field-Label",A),I=new UWA.Element("div").inject(A),I.style.width="2%",N=D("initiate-Route-Field-Value",A),h=new UWA.Element("h5",{class:"required",text:f.routeCompletionAction}).inject(O),h.tooltipInfos=E(f.routeCompletionAction);var K=new UWA.Element("div",{id:"completeActionDiv",class:""}).inject(N);if(S.fields.completionAction=new r({elementsList:[f.notifyRouteOwner,f.promoteConnectedObject],enableSearchFlag:!1}),S.fields.completionAction.inject(K),T=C("templateCompletionInfo",f.initiateRouteCompletionActionHelp,O),"Promote Connected Object"==l.data[0].options.grid.routeCompletionAction?S.fields.completionAction.selectedIndex=1:S.fields.completionAction.selectedIndex=0,"Standard"==v.data[0].options.grid.BasePurpose){null!=w&&""!=w&&null==w.linkedRouteTemplate&&(w.linkedRouteTemplate="",w.linkedRouteTemplateId="");var Y="";null!=w&&""!=w&&""!=w.linkedRouteTemplate&&"Archive"!=w.linkedRouteTemplateState&&(Y=w.linkedRouteTemplateId,w.linkedRouteTemplate,S.linkTemplateCompleteActionField.className="",S.demoteOnRejectionField.className=""),S.fields.startRouteOnCompletionField=new UWA.Element("div",{id:"startRouteOnCompletionField"}),A=D("initiate-Route-Field",S.formFields),O=D("initiate-Route-Field-Label",A),I=new UWA.Element("div").inject(A),I.style.width="2%",N=D("initiate-Route-Field-Value",A),h=new UWA.Element("h5",{text:f.StartRouteOnCompletion}).inject(O),h.tooltipInfos=E(f.StartRouteOnCompletion);var $,Z=new UWA.Element("div",{id:"startRouteOnCompletionFieldChooser",class:"fonticon-chooser-display"}),Q={isMultiSearchMode:!1};if(Q.placeHolderValue=f.typeToSearch,Q.minLengthToType=3,Q.isFreeInputAllowed=!1,Q.toKeepSearchResultsFlag=!1,Q.getPrecond=function(){return d.getPrecondForLinkedTemplateSearch(w,S)},Q.getChangeHandler=function(){return d.changeHandlerLinkedFortemplateField(S)},S.fields.linkedTemplateField=c.drawAutoCompleteComponent(Q),S.fields.linkedTemplateField.inject(Z),new UWA.Element("div",{html:"&nbsp;"}).inject(Z),""!=w.linkedRouteTemplateId&&null!=w.linkedRouteTemplateId&&"Archive"!=w.linkedRouteTemplateState)$=new m({label:w.linkedRouteTemplateTitle,value:w.linkedRouteTemplateId,status:"Released"}),S.fields.linkedTemplateField.selectedItems=$;let e;S.fields.linkedTemplateField.options.linkedTemplateId="","Archive"==u.state&&(w=""),S.fields.templateChooser=new s({icon:{iconName:"search"}}),S.fields.templateChooser.inject(Z),S.fields.templateChooser.getContent().addEventListener("buttonclick",(function(e){d.init(e,S,w)})),Z.inject(N),T=C("linkTemplateInfo",f.initiateRouteSaveAsTemplateStartOnCompletionHelp,O),A.inject(S.formFields),A=D("initiate-Route-Field-LinkedTemplate",S.formFields),A.setAttribute("id","rcaForLinkedSaveAsTemplate"),O=D("initiate-Route-Field-Label-LinkedTemplate",A),I=new UWA.Element("div").inject(A),I.style.width="2%",N=D("initiate-Route-Field-Value-LinkedTemplate",A),""==Y&&A.classList.add("fonticon-chooser-scope-display"),new UWA.Element("h5",{class:"required",id:"linkTemplateCompleteActionField",text:f.replace(f.routeCompletionActionForSelectedTemplate,{tag1:w.linkedRouteTemplateTitle})}).inject(O);let t={};t.label=f.promoteConnectedObject,t.value="Promote Connected Object";let o,i={};i.label=f.notifyRouteOwner,i.value="Notify Route Owner",e=null!=w&&"Promote Connected Object"==w.routeCompletionAction?1:0,S.fields.routeCompletionAction=new r({elementsList:[i,t],enableSearchFlag:!1,selectedIndex:e}),S.fields.routeCompletionAction.inject(N),T=C("templateCompletionInfo",f.initiateRouteCompletionActionHelp,O),A.inject(S.formFields),A=D("initiate-Route-Field-LinkedTemplate",S.formFields),A.setAttribute("id","demoteOnRejectionSaveAsTemplate"),O=D("initiate-Route-Field-Label-LinkedTemplate",A),I=new UWA.Element("div").inject(A),I.style.width="2%",N=D("initiate-Route-Field-Value-LinkedTemplate",A),""==Y&&A.classList.add("fonticon-chooser-scope-display"),h=new UWA.Element("h5",{class:"required",id:"demoteOnRejection",text:f.DemoteOnRejection}).inject(O),h.tooltipInfos=E(f.DemoteOnRejection);let n={};n.label=f.no,n.value="No";let a={};a.label=f.yes,a.value="Yes",o="Yes"==w.DemoteOnRejection?1:0,S.fields.demoteOnRejection=new r({elementsList:[n,a],enableSearchFlag:!1,selectedIndex:o}),S.fields.demoteOnRejection.inject(N),T=C("templateDemoteOnRejectionInfo",f.initiateRouteDemoteOnRejectionHelp,O),A.inject(S.formFields)}A=D("initiate-Route-Field",S.formFields),O=D("initiate-Route-Field-Label",A),I=new UWA.Element("div").inject(A),I.style.width="2%",N=D("initiate-Route-Field-Value",A),h=new UWA.Element("h5",{id:"ScopeField",text:f.routeScope}).inject(O),h.tooltipInfos=E(f.routeScope),S.fields.ScopeField=new UWA.Element("span",{text:l.data[0].options.grid.Scope[0],class:"valueReadOnly",id:"routeScopeVisibleField"}),S.fields.ScopeField.style.width="100%",S.fields.ScopeField.inject(N),A=new UWA.Element("div",{class:"initiate-Route-Field"}).inject(S.formFields),A.setAttribute("id","RouteTaskedits"),O=new UWA.Element("div",{class:"initiate-Route-Field-Label"}).inject(A),I=new UWA.Element("div").inject(A),I.style.width="2%",N=new UWA.Element("div",{class:"initiate-Route-Field-Value"}).inject(A),h=new UWA.Element("h5",{text:f.routeTaskEdits}).inject(O),h.tooltipInfos=E(f.routeTaskEdits);let ee=0;""!=w&&(ee="Modify/Delete Task List"==v.data[0].options.grid.taskEditSetting?0:"Extend Task List"==v.data[0].options.grid.taskEditSetting?1:"Modify Task List"==v.data[0].options.grid.taskEditSetting?2:3),S.fields.routeTaskEdits=new r({elementsList:[f.ModifyDeleteTaskList,f.ExtendTaskList,f.ModifyTaskList,f.MaintainExactTaskList],enableSearchFlag:!1,selectedIndex:ee}),S.fields.routeTaskEdits.inject(N),T=C("routeEditSettingInfo",f.initiateRouteSaveAsTemplateTaskEditSettingHelp,O),A=D("initiate-Route-Field",S.formFields),O=D("initiate-Route-Field-Label",A),I=new UWA.Element("div").inject(A),I.style.width="2%",N=D("initiate-Route-Field-Value",A),h=new UWA.Element("h5",{id:"PreserveTaskOwner",text:f.PreserveTaskOwnerLabel}).inject(O),h.tooltipInfos=E(f.PreserveTaskOwnerLabel),S.fields.buttonGroupPTO=new n({type:"radio"}),S.fields.buttonGroupPTO.domId="selectUserFromUserGroupRadio";let te=new a({type:"radio",label:f.PreserveTaskOwnerSelect2,value:"Retain",checkFlag:!0});te.tooltipInfos=E(f.PreserveTaskOwnerSelect2);let oe,ie=new a({type:"radio",label:f.PreserveTaskOwnerSelect1,value:"Reset"});if(ie.tooltipInfos=E(f.PreserveTaskOwnerSelect1),S.fields.buttonGroupPTO.addChild(te),S.fields.buttonGroupPTO.addChild(ie),S.fields.buttonGroupPTO.inject(N),T=C("templateRevertUserInfo",f.initiateRouteSaveAsTemplateRevertUserGroupHelp,O),""!=w){oe=f.PreserveTaskOwnerSelect2;let e=new UWA.Element("span",{class:"setPreserveTaskOwner",html:oe}).inject(S.formFields).inject(N);e.tooltipInfos=E(oe),S.fields.setPreserveTaskOwnerForTemplate=e}var ne;A=D("initiate-Route-Field",S.formFields),O=D("initiate-Route-Field-Label",A),I=new UWA.Element("div").inject(A),I.style.width="2%",N=D("initiate-Route-Field-Value",A),h=new UWA.Element("h5",{id:"selectUsersFromUserGroup",text:f.ChooseUsersFromUG}).inject(O),h.tooltipInfos=E(f.ChooseUsersFromUG),S.fields.buttonGroupChooseUG=new n({type:"radio"}),S.fields.buttonGroupChooseUG.domId="selectUserGroup",S.fields.buttonGroupChooseUG.addChild(new a({type:"radio",label:f.no,value:"False",checkFlag:!0})),S.fields.buttonGroupChooseUG.addChild(new a({type:"radio",label:f.yes,value:"True"})),S.fields.buttonGroupChooseUG.inject(N),S.fields.buttonGroupChooseUG.addEventListener("change",(function(e){"True"==e.dsModel.value?(S.fields.buttonGroupPTO.selectIndex(0),S.fields.buttonGroupPTO.getButton(1).disabled=!0):S.fields.buttonGroupPTO.getButton(1).disabled=!1})),""!=w&&(ne="True"!=w.selectUsersFromUserGroup?f.no:f.yes,S.fields.selectUsersFromUserGroupFortemplate=new UWA.Element("span",{html:ne,class:"valueReadOnly"}).inject(N),S.fields.selectUsersFromUserGroupFortemplate.style.width="100%"),T=C("templateSelectUserInfo",f.initiateRouteSaveAsTemplateSelectUserHelp,O),"Approval"!=v.data[0].options.grid.BasePurpose&&"Standard"!=v.data[0].options.grid.BasePurpose||(A=D("initiate-Route-Field",S.formFields),O=D("initiate-Route-Field-Label",A),I=new UWA.Element("div").inject(A),I.style.width="2%",N=D("initiate-Route-Field-Value",A),A.setAttribute("id","approveWithSignatureField"),("None"!=k.routeESignConfigSetting||""!=w&&"True"==w.latestrouteRequiresESignValue&&"None"==k.routeESignConfigSetting)&&new UWA.Element("h5",{class:"required",id:"approvalWithSign",text:f.routeRequiresESign}).inject(O),"RouteSpecific"==k.routeESignConfigSetting?(S.fields.approvalWithSign=new n({type:"radio"}),S.fields.approvalWithSign.addChild(new a({type:"radio",label:f.no,value:"False",checkFlag:!0})),S.fields.approvalWithSign.addChild(new a({type:"radio",label:f.yes,value:"True"})),T=C("approvalEsignInfo",f.initiateRouteSaveAsTemplateEsignHelp,O),S.fields.approvalWithSign.inject(N)):""!=w&&"False"==w.latestrouteRequiresESignValue&&"All"==k.routeESignConfigSetting?(S.fields.setNoForApprovalWithSign=new UWA.Element("span",{html:f.no,class:"valueReadOnly"}).inject(N),S.fields.setYesForApprovalWithSign=new UWA.Element("span",{html:f.yes,class:"valueReadOnly"}).inject(N),S.fields.setYesForApprovalWithSign.hide()):("All"==k.routeESignConfigSetting||""!=w&&"True"==w.latestrouteRequiresESignValue&&"None"==k.routeESignConfigSetting)&&(S.fields.setYesForApprovalWithSign=new UWA.Element("span",{html:f.yes,class:"valueReadOnly"}).inject(N))),b();let se=document.querySelector("#SaveAsTemplatePropertiesContainer #SaveOptions");null!=se&&se.scrollIntoView()},y=function(){widget.routeMgmtMediator.publish("initiate-reviseTemplate-toggle-dialogbuttons"),S.fields.buttonGroupChooseUG.hide(),S.fields.selectUsersFromUserGroupFortemplate.show(),"True"==w.selectUsersFromUserGroup?(S.fields.setPreserveTaskOwnerForTemplate.show(),S.fields.buttonGroupPTO.hide()):(S.fields.buttonGroupPTO.show(),"True"==v.data[0].options.grid.preserveTaskOwner&&"True"!=w.selectUsersFromUserGroup?(S.fields.buttonGroupPTO.getButton(1).disabled=!1,S.fields.buttonGroupPTO.selectIndex(1)):(S.fields.buttonGroupPTO.selectIndex(0),S.fields.buttonGroupPTO.getButton(1).disabled=!1),S.fields.setPreserveTaskOwnerForTemplate.hide()),"All"!=v.data[0].options.grid.Scope[0]&&"Organization"!=v.data[0].options.grid.Scope[0]&&S.fields.ScopeField.setText(w.attRestrictMembers),"Approval"!=v.data[0].options.grid.BasePurpose&&"Standard"!=v.data[0].options.grid.BasePurpose||(""!=w&&"True"==w.latestrouteRequiresESignValue&&"None"==k.routeESignConfigSetting?(document.getElementById("approvalWithSign").style.display="block",S.fields.setYesForApprovalWithSign.show()):""!=w&&"False"==w.latestrouteRequiresESignValue&&"All"==k.routeESignConfigSetting&&(S.fields.setNoForApprovalWithSign.show(),S.fields.setYesForApprovalWithSign.hide()))},b=function(){""!=w?(S.fields.descField.value=w.description,y()):(S.fields.name.className="",null!=S.formFields.querySelector("#templateTitle")&&S.formFields.querySelector("#templateTitle").classList.remove("fonticon-chooser-scope-display"),"True"==v.data[0].options.grid.preserveTaskOwner&&S.fields.buttonGroupPTO.selectIndex(1),"All"!=v.data[0].options.grid.Scope[0]&&"Organization"!=v.data[0].options.grid.Scope[0]&&S.fields.ScopeField.setText("All"));var e=S.fields.nameField._myInput;null!=e&&(e.style.width="100%",e.style.resize="both",e.style.overflow="auto");var t=S.fields.descField._myInput;null!=t&&(t.style.width="100%",t.style.overflow="auto")},M=function(){""!=w&&"True"==w.latestrouteRequiresESignValue&&"None"==k.routeESignConfigSetting?(document.getElementById("approvalWithSign").style.display="none",S.fields.setYesForApprovalWithSign.hide()):""!=w&&"False"==w.latestrouteRequiresESignValue&&"All"==k.routeESignConfigSetting&&(S.fields.setNoForApprovalWithSign.hide(),S.fields.setYesForApprovalWithSign.show())},D=function(e,t){return p.createNewElement(e,t)},C=function(e,t,o){return p.createTooltipElement(e,t,o)},E=function(e){return p.getElementToolTip(e)},A={build:(e,t,o,i)=>function(e,t,o,i){var n="";null!=t.data[0].options.grid.TemplateName?u.fetchRouteTemplateById(t.data[0].options.grid.TemplateId).then((s=>{s.data[0].dataelements.id=s.data[0].id,""!=(n=s.data[0].dataelements).linkedRouteTemplateId&&null!=n.linkedRouteTemplateId?u.fetchRouteTemplateById(n.linkedRouteTemplateId).then((s=>{n.linkedRouteTemplateState=s.data[0].dataelements.state,R(e,t,n,o,i)}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:f.pageLoad,sticky:!1})})):R(e,t,n,o,i)}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:f.pageLoad,sticky:!1})})):R(e,t,n,o,i)}(e,t,o,i),destroy:()=>{S={}},getProperties:()=>S};return A})),define("DS/ENORouteMgmt/Views/Panels/RoutePropertiesPanel",["DS/EditPropWidget/EditPropWidget","DS/ENORouteMgmt/Views/RouteInfoPropWidget","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o){var i,n={init:function(t){let o=r(t);this.EditPropWidget=new e(o)},render:function(e,t){var o=this;i?o.renderUI(e,t):d().then((function(){o.renderUI(e,t)}))},renderUI:function(e,t){var o=this;o.EditPropWidget||(e.empty(),o.init(t)),a(o.EditPropWidget).then((function(i){let n=s(t);return i&&n!=i&&(e.empty(),o.init(t)),t.model&&t.model.id&&l(t).addFacets(o.EditPropWidget,t),o.loadModel(t,e),this}))},loadModel:function(e,t){let o=[];e.model&&e.model.id&&(o=l(e).getPropModel(e.model.id)),this.EditPropWidget.initDatas(o),this.EditPropWidget.elements.container.inject(t)},removeFacets:function(e){this.EditPropWidget.removeFacets(e)},destroyEditPropWidget:function(){this.EditPropWidget=void 0}};let s=function(e){let t=e.model&&e.model.Type;return null==t&&(t=e.info),t},a=function(e){return new Promise((function(t,o){let i,n=e.getListModel();if(n&&n.length>0){let e=n[0].getAllAttributes().type;e&&e.dbValues&&(i=e.dbValues.value,t(i))}t("")}))},r=function(e){return l(e).getOptions(e)},l=function(e){switch(e.model?e.model.Type:e){case"Route":default:return t;case"Route Template":return i}},d=function(){return new Promise((function(e,t){require(["DS/ENORouteTemplateMgmt/Views/TemplateInfoPropWidget"],(function(t){i=t,e()}))}))};return n})),define("DS/ENORouteMgmt/Views/Dialogs/InitiateSaveAsTemplateDialog",["DS/ENORouteMgmt/Actions/RouteActions","DS/ENORouteMgmt/Utilities/Utils","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/ENORouteMgmt/Views/InitiateSaveAsTemplateView","DS/ENORouteMgmt/Controller/RouteServicesController","DS/Controls/Button","DS/ENORouteMgmt/Utilities/RouteViewUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l){"use strict";let d,u,c,p=function(t){let s=new UWA.Element("div",{html:"",id:"saveAsTemplate"});d=new UWA.Element("div",{id:"dialogContainer",class:"template-facets-container"});r.fetchCredentials("newTemplateDialog").then((function(e){return n.build(d,t,c,e)})),d.inject(s);var p=t.data[0].options.grid.Title,f=new i;f.inject(document.body),u=new o({title:l.replace(l.SaveRouteasTemplate,{route:p}),modalFlag:!0,width:600,height:500,minWidth:290,minHeight:250,content:s,domId:"RouteImmersiveFrame",immersiveFrame:f,resizableFlag:!0,buttons:{Ok:new a({disabled:!0,domId:"okSaveAsButton",emphasize:"primary",label:l.SaveasTemplate,allowUnsafeHTMLLabel:!0,onClick:function(o){let i=n.getProperties();m(i,t)&&(o.dsModel.label=l.SavingTemplate,o.dsModel.disabled=!0,u.buttons.Cancel.disabled=!0,e.saveAsTemplate(i,t).then((e=>{if(e[0].name!=t.data[0].options.grid.TemplateName){var i={level:"success",subtitle:l.replace(l.createSuccess,{Template:e[0].title}),sticky:!1,allowUnsafeHTML:!1};o.dsModel.dialog.close(),widget.routeMgmtMediator.publish("route-summary-show-message",{message:i})}else{i={level:"success",subtitle:l.replace(l.reviseSuccess,{Template:e[0].title}),sticky:!1,allowUnsafeHTML:!1};o.dsModel.dialog.close(),widget.routeMgmtMediator.publish("route-summary-show-message",{message:i})}}),(e=>{o.dsModel.label=l.SaveasTemplate,o.dsModel.disabled=!1,u.buttons.Cancel.disabled=!1,e&&e.error.toLowerCase().indexOf("no create access")>-1?widget.notify.handler().addNotif({level:"error",title:l.errorCreateRouteForRoleTitle,subtitle:l.errorCreateRouteForRoleSubTitle,message:l.errorCreateRouteForRoleMsg,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1})})))}}),Cancel:new a({label:l.cancel,domId:"cancelButton",emphasize:"secondary",allowUnsafeHTMLLabel:!0,onClick:function(e){e.dsModel.dialog.close()}})}}),r.makeResponsiveCss("initiateRouteTemplate",".template-facets-container"),g(),u.addEventListener("close",(function(e){widget.notify.notifview().removeNotifications()}))},m=function(e,o){if(""==e.fields.name.className&&0==e.fields.nameField.disabled){if(t.strLength(e.fields.nameField.value)>127)return widget.notify.handler().addNotif({level:"error",subtitle:l.errorRouteNameFormat,sticky:!1}),!1;if(0==e.fields.nameField.disabled&&(""==e.fields.nameField.value||null==e.fields.nameField.value))return widget.notify.handler().addNotif({level:"error",subtitle:l.saveasErrorMessage,sticky:!1}),!1}return"Standard"!=o.data[0].options.grid.BasePurpose||!e.fields.linkedTemplateField.selectedItems||""==e.fields.linkedTemplateField.selectedItems.options.label||""!=e.fields.linkedTemplateField.selectedItems.options.value&&null!=e.fields.linkedTemplateField.selectedItems.options.value||(widget.notify.handler().addNotif({level:"error",subtitle:l.linkedTemplateSelectMessage,sticky:!1}),!1)},g=function(){widget.routeMgmtMediator.subscribe("initiate-saveAsTemplate-toggle-dialogbuttons",(function(){let e=n.getProperties();if(e&&e.formFields){var t=e.fields.nameField.elements.inputField.value,o=e.fields.collaborativeSpace.value,i=e.fields.organization.value;""!=t.trim()&&o&&""!=o.trim()&&i&&""!=i.trim()?u.buttons.Ok.disabled=!1:u.buttons.Ok.disabled=!0}})),widget.routeMgmtMediator.subscribe("initiate-reviseTemplate-toggle-dialogbuttons",(function(){let e=n.getProperties();e&&e.formFields&&(u.buttons.Ok.disabled=!1)}))};return{InitiateSaveAsTemplateDialog:e=>function(e){c={},s.getESignConfigSetting().then((function(t){c.routeESignConfigSetting=t.routeESignConfigSetting,p(e)}))}(e)}})),define("DS/ENORouteMgmt/Views/Dialogs/RouteChangeOwnershipDialog",["DS/ENORouteMgmt/Actions/RouteActions","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_TransferOwnershipCmd","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s){return{routeChangeOwner:(a,r)=>function(a,r){if(n.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Change Owner"}),void 0===a.data&&(a=t.getSelectedRowsModel()),a.data.length<1)widget.notify.handler().addNotif({level:"warning",subtitle:s.ErrorRouteChangeOwner,sticky:!1});else{var l=[];a.data.forEach((function(e){var t={getID:function(){return e.options.grid.id},getLabel:function(){return e.options.grid.Title}};l.push(t)}));var d={SecurityContext:o.getSecurityContextValue()},u=new i({ID:"ActionBar_TransferOwnershipCmd_",context:{getSecurityContext:function(){return d},getSelectedNodes:function(){return l}}});u.onEnd((function(t){var o=setInterval((function(){u.transferOwnershipPanel&&u.transferOwnershipPanel.addEvent&&(clearInterval(o),u.transferOwnershipPanel.addEvent("onClose",(function(){null!=event&&"readystatechange"!==event.type||e.refreshRouteObjectOnChangeOwner(a,r)})))}))}),200),u.begin()}}(a,r)}})),define("DS/ENORouteMgmt/Views/Graph/TaskCustomTileView",["DS/Utilities/Dom","DS/Controls/LineEditor","DS/Controls/ComboBox","DS/Controls/Toggle","DS/Controls/ResponsiveViewAdaptor","UWA/Core","DS/Utilities/Utils","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/ENORouteMgmt/EnoviaBootstrap","DS/Controls/TooltipModel","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/Commands/RouteTaskApprovalProcess","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g){"use strict";let f;return f=n.inherit({name:"RouteTaskCustomView",markForRecordFlag:!0,publishedProperties:{thumbnailWidth:{defaultValue:250,type:"integer",category:"Behavior"}},_applyProperties:function(e){this._parent(e),this.isDirty("thumbnailWidth")&&this._applyThumbnailWidth(e.thumbnailWidth)},_clearTileContent:function(e){e.assignee&&this.elements.descriptionAssignee.getChildren()&&this.elements.descriptionAssignee.getChildren().length>0&&this.elements.descriptionAssignee.getChildren()[0].setContent("")},buildView:function(){this.elements.container;this.elements.container=new s.Element("div",{class:"routemgmt-thumnailview"}),this.elements.container.setStyle("height","90px"),this.elements.container.setAttribute("has-icon","false"),this.elements.container.setAttribute("active-mode","false"),this.elements.container.titleLineNumber=1,this.elements.container.descriptionLineNumber=2,this.elements.highlightBorder=new s.Element("div",{class:"routemgmt-thumnailview-highlightborder"}).inject(this.elements.container),this.elements.activediv=new s.Element("div",{class:"routemgmt-thumnailview-activediv"}).inject(this.elements.container),this.elements.thumbnailtitleBar=s.createElement("div",{class:"routemgmt-tile-thumbnailtitleBar"}),this.elements.titleIcon=new s.Element("div",{class:"routemgmt-thumnailview-title-icon"}),s.createElement("div",{class:"content",html:[{tag:"img",src:c.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTask16.png")}]}).inject(this.elements.titleIcon),this.elements.titleIcon.inject(this.elements.thumbnailtitleBar);let t=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos);this.elements.thumbnailTitleText=e.createEllipsisText({allowUnsafeHTMLLabel:t,label:g.taskTitlePlaceholder,maxWidth:"auto",lineHeight:this._getTitleLineHeight(),nbLinesVisible:1}).inject(this.elements.thumbnailtitleBar),this.elements.checkbox=new s.Element("div",{class:"routemgmt-thumnailview-checkbox"}).inject(this.elements.thumbnailtitleBar),this.checkbox=this.elements.checkbox,this.elements.thumbnailtitleBar.inject(this.elements.container),this.elements.menu=new s.Element("div",{class:"routemgmt-tileview wux-controls-responsivetileview-menu"}).inject(this.elements.container),this.elements.menu.responsiveTileView=this,this.elements.menu.setAttribute("has-menu","false"),this.elements.maincontent=new s.Element("div",{class:"routemgmt-thumnailview-maincontent"}).inject(this.elements.container),this.elements.maincontent.setAttribute("has-menu","false"),this.elements.maincontent.setStyle("display","none"),this.elements.titlebar=new s.Element("div",{class:"routemgmt-thumnailview-titlebar"}).inject(this.elements.maincontent),this.elements.icon=new s.Element("div",{class:"routemgmt-thumnailview-icon"}).inject(this.elements.titlebar),this.elements.title=new s.Element("div",{class:"routemgmt-thumnailview-title"}).inject(this.elements.titlebar),this.elements.title.contentView=this,e.addEventOnElement(this,this.elements.title,"click",this._onTitleClick),this.elements.title.setAttribute("has-menu","false"),this.elements.title.setAttribute("has-icon","false"),this.elements.thumbnailsubtitleBar=s.createElement("div",{class:"routemgmt-tile-thumbnailsubtitleBar"}),this.elements.subtitle=new s.Element("div",{class:"routemgmt-thumnailview-subtitle",id:"approvalStatusGettingId"}).inject(this.elements.thumbnailsubtitleBar),this.elements.subtitleIcon=new s.Element("div",{class:"routemgmt-thumnailview-subtitle-icon"}),s.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x"}).inject(this.elements.subtitleIcon),this.elements.subtitleIcon.inject(this.elements.thumbnailsubtitleBar),this.elements.subtitle.setAttribute("has-subtitle","false"),this.elements.subtitle.setAttribute("has-menu","false"),this.elements.subtitle.inject(this.elements.thumbnailsubtitleBar),this.elements.thumbnailsubtitleBar.inject(this.elements.container),this.elements.mc_desc_separator=new s.Element("div",{class:"routemgmt-thumnailview-mc_desc_separator"}).inject(this.elements.container),this.elements.mc_desc_separator.setStyle("display","none"),this.elements.description=new s.Element("div",{class:"routemgmt-thumnailview-description"}).inject(this.elements.container),this.elements.priorityIcon=new s.Element("div",{class:"routemgmt-thumnailview-subtitle-icon priority"}),s.createElement("span",{class:"wux-tweakers-string-icon wux-ui-genereatedicon-fi wux-ui-3ds wux-ui-3ds-lg wux-ui-icon-round"}).inject(this.elements.priorityIcon),this.elements.priorityIcon.inject(this.elements.description),this.elements.dueDateStatusIcon=new s.Element("div",{class:"routemgmt-thumnailview-description-duedate-status"}).inject(this.elements.description),s.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x"}).inject(this.elements.dueDateStatusIcon),this.elements.dueDateStatusIcon.setStyle("display","none"),this.elements.descriptionDueDate=new s.Element("div",{class:"routemgmt-thumnailview-description-duedate"}).inject(this.elements.description),this.elements.descriptionDueDate.setStyle("display","none");p.getAvatarDetails("AdminUser VPLM");this.elements.ownerIcon=s.createElement("div",{class:"assignee task-assignee",html:[{tag:"img",class:"userIcon",src:""}]}),this.elements.ownerIcon.setStyle("display","none"),this.elements.descriptionAssignee=new s.Element("div",{class:"routemgmt-thumnailview-description-assignee"}),this.elements.assigneeIcon=new s.Element("div",{class:"routemgmt-thumnailview-assignee-icon"}),s.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-2x"}).inject(this.elements.assigneeIcon),this.elements.assigneeIcon.setStyle("display","none"),this.elements.assigneeIcon.inject(this.elements.descriptionAssignee),this.elements.ownerIcon.inject(this.elements.descriptionAssignee),this.elements.descriptionAssignee.inject(this.elements.description),this.elements.taskState=s.createElement("span",{html:"",class:""}),this.elements.descriptionState=new s.Element("div",{class:"routemgmt-thumnailview-description-state"}),this.elements.taskState.inject(this.elements.descriptionState),this.elements.descriptionState.inject(this.elements.description),this.elements.description.setAttribute("has-description","false"),this.elements.descriptionTemplateIcon=new s.Element("div",{class:"routemgmt-thumnailview-desc-template-icon"}),s.createElement("div",{class:"content",html:[{tag:"img",src:c.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTemplate16.png")}]}).inject(this.elements.descriptionTemplateIcon),this.elements.descriptionTemplateIcon.inject(this.elements.description),this.elements.descriptionRouteIcon=new s.Element("div",{class:"routemgmt-thumnailview-desc-route-icon"}),s.createElement("div",{class:"content",html:[{tag:"img",src:c.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_Route16.png")}]}).inject(this.elements.descriptionRouteIcon),this.elements.descriptionRouteIcon.inject(this.elements.description),this.elements.subroutes=new s.Element("div",{class:"routemgmt-thumnailview-subroutes-border",id:"taskSubRoutesBorder"}).inject(this.elements.container),this.elements.subroutes.style.display="none",this.elements.subRouteBar=s.createElement("div",{class:"routemgmt-tile-subRouteBar",id:"taskSubRouteDiv"}),this.elements.subRouteApprovalTitle=new s.Element("span",{class:"routemgmt-thumnailview-subRouteApprovalTitle"}).inject(this.elements.subRouteBar),this.elements.subRouteApprovalIcon=new s.Element("span",{class:"routemgmt-thumnailview-subtitle-subRouteApprovalIcon",id:"subRouteApproveStatusIcon"}),this.elements.activityIcon=s.createElement("span",{}),this.elements.activityIcon.inject(this.elements.subRouteApprovalIcon),this.elements.subRouteApprovalMainTitle=new s.Element("a",{class:"routemgmt-thumnailview-subRouteApprovalMainTitle",id:"subRouteApprovalInfo"}).inject(this.elements.subRouteApprovalTitle),this.elements.subRouteApprovalMainTitleNoLink=new s.Element("span",{class:"routemgmt-thumnailview-subRouteApprovalMainTitleNoLink",id:"subRouteApprovalInfoNoLink"}).inject(this.elements.subRouteApprovalTitle),this.elements.subRouteApprovalIcon.inject(this.elements.subRouteApprovalTitle),this.elements.subRouteApprovalMainTitle.inject(this.elements.subRouteApprovalTitle),this.elements.subRouteApprovalMainTitleNoLink.inject(this.elements.subRouteApprovalTitle),this.elements.subRouteApprovalTitle.inject(this.elements.subRouteBar),this.elements.subRouteApprovalMainTitle.style.display="none",this.elements.subRouteApprovalMainTitleNoLink.style.display="none",this.elements.subRouteBar.inject(this.elements.container),this.elements.subRouteBar.style.display="none",this.elements.picture=new s.Element("div",{class:"routemgmt-thumnailview-picture"}).inject(this.elements.container),this.elements.color=new s.Element("div",{class:"routemgmt-thumnailview-color"}).inject(this.elements.picture),this.elements.color.setAttribute("has-color","false"),this.elements.propertiesList=new s.Element("div",{class:"routemgmt-thumnailview-propertiesListContainer"}).inject(this.elements.container),this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.statusbar=new s.Element("div",{class:"routemgmt-thumnailview-statusbar"}).inject(this.elements.container),this.elements.statusbar.setAttribute("has-statusbar-content","false"),this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false"),this.elements.statusbaricons=[]},_applyDescription:function(e){this.elements.mc_desc_separator.style.display="none",this._parent()},_applyTitle:function(t){let o=this.title;if(o){let t=!!this.layoutingCollection&&this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos);this.elements.title.layoutDsModel=this.layoutingCollection,e.setContent(this.elements.thumbnailTitleText,o,t),this.elements.container.setAttribute("title",o)}else this.elements.container.setAttribute("title",g.taskTitlePlaceholder)},_applyCustomTooltip:function(e){},_applySubtitle:function(t){var o=this.subtitle;if(o.label){var i=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos);if(this.elements.subtitle.layoutDsModel=this.layoutingCollection,e.setContent(this.elements.subtitle,o.label,i),this.elements.subtitle.setStyle("color",o.color),this.elements.subtitle.setAttribute("has-subtitle","true"),this.elements.subtitleIcon.getChildren()&&this.elements.subtitleIcon.getChildren().length>0&&void 0!==o.icon)this.elements.subtitleIcon.getChildren()[0].addClassName(o.icon),this.elements.subtitleIcon.getChildren()[0].setStyle("color",o.color);else if(this.elements.subtitleIcon.getChildren()[0].setStyle("color",o.color),this.elements.subtitle.setStyle("margin-left","0px"),this.elements.subtitleIcon.getChildren().length>0){let e=this.elements.subtitleIcon.getChildren()[0].classList.length>2?this.elements.subtitleIcon.getChildren()[0].classList[2]:void 0;e&&this.elements.subtitleIcon.getChildren()[0].classList.remove(e)}}else if(this.elements.subtitle.setAttribute("has-subtitle","false"),this.elements.subtitleIcon.getChildren()&&this.elements.subtitleIcon.getChildren().length>0){let e=this.elements.subtitleIcon.getChildren()[0].classList.length>2?this.elements.subtitleIcon.getChildren()[0].classList[2]:void 0;e&&(this.elements.subtitleIcon.getChildren()[0].classList.remove(e),this.elements.subtitleIcon.getChildren()[0].setStyle("color",""))}},_setDescription:function(e,t){if(!e)return this.elements.description.setAttribute("has-description","false"),void(this.elements.realdescription="");this.elements.mc_desc_separator.style.display="none",this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.realdescription=e,1===t?this.elements.description.setAttribute("on-singleLine","true"):this.elements.description.setAttribute("on-singleLine","false");this._getDescriptionLineHeight();var o=this.elements.description.getAttribute("on-singleLine");if(this.elements.description=new s.Element("div",{class:"routemgmt-thumnailview-description"}),e.assignee&&(" "==e.assignee?this.clearAssignee():this.drawAssignee(e)),e.state&&this.setTaskState(e),this.drawSubroutes(e),e.templateTask?(this.elements.descriptionTemplateIcon.style.display="block",this.elements.descriptionTemplateIcon.title=e.templateTaskTooltip?e.templateTaskTooltip:"",this.elements.descriptionRouteIcon.style.display="none"):e.initialTask?(this.elements.descriptionRouteIcon.style.display="block",this.elements.descriptionRouteIcon.title=e.routeInitialTaskTooltip?e.routeInitialTaskTooltip:"",this.elements.descriptionTemplateIcon.style.display="none"):(this.elements.descriptionTemplateIcon.style.display="none",this.elements.descriptionRouteIcon.style.display="none"),e.dueDateStatus&&(""==e.dueDateStatus.icon?this.elements.dueDateStatusIcon.setStyle("display","none"):this.elements.dueDateStatusIcon.setStyle("display","block"),this.elements.dueDateStatusIcon.getChildren()[0].addClassName(e.dueDateStatus.icon),this.elements.dueDateStatusIcon.getChildren()[0].setStyle("color",e.dueDateStatus.color),this.elements.dueDateStatusIcon.title=e.dueDateStatus.tooltip),e.taskPriority){""==e.taskPriority.icon?this.elements.priorityIcon.setStyle("display","none"):this.elements.priorityIcon.setStyle("display","block");let t=this.elements.priorityIcon.getChildren()[0];t.classList&&(t.classList.remove("wux-ui-3ds-level-high"),t.classList.remove("wux-ui-3ds-alert"),t.classList.remove("wux-ui-3ds-level-medium"),t.classList.remove("wux-ui-3ds-level-low")),this.elements.priorityIcon.getChildren()[0].addClassName(e.taskPriority.icon),this.elements.priorityIcon.getChildren()[0].setStyle("color",e.taskPriority.emphasize),this.elements.priorityIcon.title=e.taskPriority.label}e.duedate&&" "!=e.duedate?(this.elements.descriptionDueDate.setStyle("display","block"),this.elements.descriptionDueDate.innerText=e.duedate,this.elements.descriptionDueDate.title=e.dateTooltip):(this.elements.descriptionDueDate.setStyle("display","none"),this.elements.descriptionDueDate.innerText="",this.elements.descriptionDueDate.title=""),this.elements.description.layoutDsModel=this.layoutingCollection,this.elements.description.setAttribute("has-description","true"),this.elements.description.setAttribute("on-singleLine",o)},setTaskState:function(e){if(this.elements.descriptionState.getChildren()&&this.elements.descriptionState.getChildren().length>0){let t="";"Draft"===e.state.trim()?t="route-task-state-title DEFINE":"Assigned"===e.state.trim()?t="route-task-state-title INPROCESS":"Review"===e.state.trim()?t="route-task-state-title INAPPROVAL":"Complete"===e.state.trim()&&(t="route-task-state-title COMPLETE"),this.elements.descriptionState.getChildren()[0].className=t,this.elements.descriptionState.getChildren()[0].setContent(e.stateNLS),this.elements.descriptionState.getChildren()[0].title=e.stateNLS}},drawSubroutes:function(e){if(null!=e&&null!=e.state&&"Draft"!=e.state.trim()&&"view"==e.graphCurrentType&&null!=e.taskSubRoutes&&e.taskSubRoutes.length>0){var t="";t=e.subRouteApprovalStatus;let s=p.getRouteActivityStateIcon(t),a=p.getRouteActivityStateNLS(t),r="";t.contains("your")?(this.elements.subRouteApprovalMainTitle.style.display="inline-block",r="true",this.elements.activityIcon.hasClassName("wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+s+" awaiting-tasks")||this.elements.activityIcon.addClassName("wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+s+" awaiting-tasks")):(r="false",this.elements.subRouteApprovalMainTitleNoLink.style.display="inline-block",this.elements.activityIcon.hasClassName("wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+s+" disable-link")||this.elements.activityIcon.addClassName("wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+s+" disable-link")),this.elements.subroutes.style.display="block",this.elements.subRouteBar.style.display="block";var o="true"==r?this.elements.subRouteApprovalMainTitle:this.elements.subRouteApprovalMainTitleNoLink;o.title=a,o.innerText=a;var i={};i.taskTitleForSubRoute=e.taskTitleForSubRoute,i.taskIdForSubRoute=e.taskIdForSubRoute,i.route=[];var n=e.taskSubRoutes;for(let e=0;e<n.length;e++)i.route.push({dataelements:{id:n[e].routeId,name:n[e].routeName,approvalTaskId:n[e].approvalTaskId,activityState:n[e].activityState}});"true"==r&&(i.fromPage="hyperlink",o.removeEvents(),o.addEvent("click",(function(e){m.getApprovalCommandMenu(i,"openInboxTask").action.callback()}))),this.elements.container.setStyle("height","95px")}else this.elements.container.setStyle("height","70px")},drawAssignee:function(e){let t="/api/user/getpicture/login/"+e.assigneeUserName+"/format/normal",o=d.getSwymUrl()+t;if("Ask Route Owner"==e.assigneeType)this.elements.assigneeIcon.getChildren()&&this.elements.assigneeIcon.getChildren().length>0&&(this.elements.assigneeIcon.getChildren()[0].addClassName(e.assigneeIcon),this.elements.assigneeIcon.style.display="block",this.elements.assigneeIcon.title=g.routeOwnerTask,this.elements.descriptionAssignee.querySelector(".avatarIcon")&&this.elements.descriptionAssignee.querySelector(".avatarIcon").setStyle("display","none"),this.elements.descriptionAssignee.querySelector(".userIcon")&&this.elements.descriptionAssignee.querySelector(".userIcon").setStyle("display","none"),this.elements.ownerIcon.setStyle("display","none"));else{if(this.elements.assigneeIcon.style.display="none","Person"==e.assigneeType){if(null!=d.getSwymUrl())this.elements.descriptionAssignee.querySelector(".userIcon")&&(this.elements.descriptionAssignee.querySelector(".userIcon").setStyle("display","block"),this.elements.descriptionAssignee.querySelector(".userIcon").src=o);else{let t=s.createElement("div",{class:"avatarIcon"}),o=p.getAvatarDetails(e.assignee),i=o.avatarStr;t.setContent(i),t.style.setProperty("background",o.avatarColor),this.elements.descriptionAssignee.getChildren()&&this.elements.descriptionAssignee.getChildren().length>0&&(this.elements.descriptionAssignee.querySelector(".userIcon")&&this.elements.descriptionAssignee.querySelector(".userIcon").setStyle("display","none"),this.elements.descriptionAssignee.querySelector(".avatarIcon")?(this.elements.descriptionAssignee.querySelector(".avatarIcon").setContent(i),this.elements.descriptionAssignee.querySelector(".avatarIcon").style.setProperty("background",o.avatarColor)):this.elements.descriptionAssignee.querySelector(".assignee")&&this.elements.descriptionAssignee.querySelector(".assignee").addContent(t)),this.elements.descriptionAssignee.querySelector(".avatarIcon").setStyle("display","block")}this.elements.descriptionAssignee.title=e.assignee}"Group"!=e.assigneeType&&"Group Proxy"!=e.assigneeType&&"User Group"!=e.assigneeType||this.elements.descriptionAssignee.querySelector(".userIcon")&&(this.elements.descriptionAssignee.querySelector(".avatarIcon")&&this.elements.descriptionAssignee.querySelector(".avatarIcon").setStyle("display","none"),this.elements.descriptionAssignee.querySelector(".userIcon").setStyle("display","block"),this.elements.descriptionAssignee.querySelector(".userIcon").src=c.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png"),this.elements.descriptionAssignee.title=e.assigneeTitle),this.elements.ownerIcon.setStyle("display","block")}},clearAssignee:function(){if(this.elements.descriptionAssignee){let e=this.elements.descriptionAssignee.querySelector(".avatarIcon");e&&e.setStyle("display","none"),this.elements.descriptionAssignee.querySelector(".userIcon")&&this.elements.descriptionAssignee.querySelector(".userIcon").setStyle("display","none")}},_getViewMinWidth:function(){return 150},_getViewMaxWidth:function(){return 420},_getViewWidth:function(){return this.thumbnailWidth},_getViewCssClassSuffix:function(){return"routemgmtTileView"},_applyThumbnailWidth:function(e){this._applyViewWidth(e)}}),f})),define("DS/ENORouteMgmt/Actions/InitiateRouteActions",["DS/ENORouteMgmt/Controller/RouteServicesController","DS/WAFData/WAFData","UWA/Core","DS/ENORouteMgmt/Utilities/Utils","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Utilities/InitiatePropertiesCustomAttributeUtility","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r){"use strict";let l,d=function(e){const t=e.fields.ctx.findIndex((t=>{const o=t.split(".");return o[1]===e.fields.organization.value&&o[2]===e.fields.collaborativeSpace.value}));var o={title:e.fields.name.value.trim(),description:e.fields.descField.value,collaborativeSpace:e.fields.collaborativeSpace.value,organization:e.fields.organization.value,ctx:e.fields.ctx[t],routeBasePurpose:0==e.fields.routePurpose.selectedIndex?"Standard":1==e.fields.routePurpose.selectedIndex?"Approval":"Review",routeCompletionAction:0==e.fields.routeCompletionAction.selectedIndex?"Notify Route Owner":"Promote Connected Object",AutoStopOnRejection:0==e.fields.routeAutoStopOnRejection.selectedIndex?"Immediate":"Deferred",DemoteOnRejection:0==e.fields.DemoteOnRejection.selectedIndex?"No":"Yes",preserveTaskOwner:"Retain"==e.fields.buttonGroupUGA.value[0]?"False":"True",attrScope:p(e),templateId:null!=e.fields.templateField.selectedItems?e.fields.templateField.selectedItems.options.value:void 0};return widget.setValue("usedCollaborativeSpace",{prjtitle:e.fields.collaborativeSpace.label,prjname:e.fields.collaborativeSpace.value}),widget.setValue("usedOrganization",{orgtitle:e.fields.organization.label,orgname:e.fields.organization.value}),null!=e.fields.templateField.selectedItems?o.requiresEsign=e.fields.requiresEsign:o.requiresEsign="False",null!=e.fields.visibleToParent&&(o.visibleToParent=0==e.fields.visibleToParent.selectedIndex?"No":"Yes"),a.addCustomAttrInfo(o,e.fields),o},u=function(e,t){var o="",i=[];if(e.getChildren().length>300&&e.getChildren().forEach((e=>{i.push(e.options.grid.id+"|"+e.getAttributeValue("RouteBaseState")+"|"+e.getAttributeValue("RouteTargetState"))})),i.length>0)return i;if(e.getChildren().length>0){if(e.getChildren().forEach((e=>{o=o+"~"+e.options.grid.id+"|"+e.getAttributeValue("RouteBaseState")+"|"+e.getAttributeValue("RouteTargetState")})),o.length>0)return o.substr(1,o.length)}else{if(e.contentIds)return"";if(null!=t.contentIds&&""!=t.contentIds)return t.contentIds}return""},c=function(e){var t={tasks:[]};return e.forEach((e=>{let o="";e.taskDueDate&&""!=e.taskDueDate&&(o=new Date(e.taskDueDate).toISOString()),"Person"==e.assigneeType&&(e.chooseUsersFromUg="False"),t.tasks.push({dataelements:{allowDelegation:e.allowDelegation,assigneeId:e.assigneeId,assigneeSetDueDate:e.assigneeSetDueDate,instructions:e.instructions,parallelNodeProcessionRule:e.parallelNodeProcessionRule,taskAction:e.taskAction,taskOrder:e.taskOrder,taskDueDate:o,title:e.title,reviewTask:e.needsOwnerReview,dateOffsetFrom:e.dateOffsetFrom,dueDateOffset:e.dueDateOffset,needsOwnerReview:e.needsOwnerReview,chooseUsersFromUg:e.chooseUsersFromUg,routeOwnerTask:e.routeOwnerTask,routeOwnerUGChoice:e.routeOwnerUGChoice,routeOwnerUGName:e.routeOwnerUGName,routeOwnerUGTitle:e.routeOwnerUGTitle,templateTask:e.templateTask,contentToReviewIds:m(e),routeTaskPriority:e.routeTaskPriority}})})),t},p=function(e){if(e.fields.buttonGroupScope){var t=e.fields.buttonGroupScope.value[0];return"scope"==t?e.fields.scopeField.selectedItems.options.value:t}if(e.fields.scopeField)return e.fields.scopeField.selectedItems.options.value},m=function(e,t){var o=[];return null!=e.contentToReviewFieldInfo&&0!=e.contentToReviewFieldInfo.length&&e.contentToReviewFieldInfo.forEach((function(e){o.push(e.id)})),o};return l={createRoute:(t,o,i)=>function(t,o,i){var n;return new Promise((function(a,r){var l=d(t);l.contentIds=u(o,t),t.inboxTaskId&&(l.inboxTaskId=t.inboxTaskId),l=(new s).createDataForRequest(l),null!=i?l.data[0].relateddata=c(i):null!=t.fields.templateField.selectedItems&&(l.data[0].dataelements.useTemplateTasks="True"),e.createRoute(l).then((e=>{n=e[0].id,a(e)}),(e=>r(e)))})).then((function(){return new Promise((function(t,o){e.fetchRouteById(n).then((e=>{t(e)}),(e=>o(e)))}))}))}(t,o,i),saveAsRoute:(t,o,i)=>function(t,o,i){return new Promise((function(n,a){var r=d(t);r.contentIds=u(o,t),t.inboxTaskId&&(r.inboxTaskId=t.inboxTaskId),r=(new s).createDataForRequest(r),null!=i?r.data[0].relateddata=c(i):null!=t.fields.templateField.selectedItems&&(r.data[0].dataelements.useTemplateTasks="True"),e.saveAsRoute(r).then((e=>n(e)),(e=>a(e)))}))}(t,o,i),refreshTemplateObjectOnRouteCreation:t=>function(t){e.fetchRouteTemplateById(t).then((e=>{e.data[0].dataelements.id=e.data[0].id,widget.routeMgmtMediator.publish("template-data-updated",e.data[0].dataelements),widget.routeMgmtMediator.publish("template-idcard-data-updated",e.data[0].dataelements)}))}(t)},l})),define("DS/ENORouteMgmt/Views/Dialogs/InitiateRouteDialog",["DS/ENORouteMgmt/Views/InitiateRouteTabsView","DS/ENORouteMgmt/Actions/InitiateRouteActions","DS/ENORouteMgmt/Utilities/Utils","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/ENORouteMgmt/Controller/RouteServicesController","DS/Controls/Button","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/Views/Form/FormValidation","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d,u){"use strict";let c,p,m,g,f={},h=function(o,l){if(l&&l.credentials.length<=1&&!l.credentials.some((e=>e.ctxname)))return void widget.notify.handler().addNotif({level:"error",title:u.errorCreateRouteForRoleTitle,subtitle:u.errorCreateRouteForRoleSubTitle,message:u.errorCreateRouteForRoleMsg,sticky:!1});let h=new UWA.Element("div",{html:"",id:"initiateRoute"});c=new UWA.Element("div",{id:"iRouteTabsContainer",class:"route-facets-container"}),f={},f.credentialResponseData=l,o&&o.contentIds&&(f.contentIds=o.contentIds,f.contentIdsList="",o.contentIds.forEach((e=>{f.contentIdsList=f.contentIdsList+"~"+e.id})),f.contentIdsList.length>0&&(f.contentIdsList=f.contentIdsList.substr(1,f.contentIdsList.length))),o&&o.folderDetails?(f.scopeId=o.folderDetails._options.mxid,f.scopePhyId=o.folderDetails.id,f.scopeValue=o.folderDetails._options.label,s.getScopeInformation(f.scopeId).then((function(e){f.ScopeMembers=e.ScopeMembers}))):f.scopeId="Organization",f.routeBasePurpose="Standard",f.DemoteOnRejection="No",f.chooseUserFromGroup="False",o&&o.templateId&&(f.templateId=o.templateId,f.Actions=o.Actions),m=!1,g=!1,new e(c,f).init(),c.inject(h);var T=new n;T.inject(document.body);let R=u.newRoute;o&&o.inboxTaskId&&(f.inboxTaskId=o.inboxTaskId,R=u.createSubRoute+o.inboxTaskTitle),o&&o.parentRouteTaskDueDate&&(f.parentRouteTaskDueDate=o.parentRouteTaskDueDate),p=new i({title:R,modalFlag:!0,checkboxInfos:{label:u.repeat,checkFlag:!1},width:600,height:500,minHeight:250,content:h,domId:"RouteImmersiveFrame",immersiveFrame:T,resizableFlag:!0,buttons:{Ok:new a({disabled:!0,domId:"okButton",emphasize:"primary",label:u.start,allowUnsafeHTMLLabel:!0,onClick:function(e){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Start"});let i=v();if(i.fields.buttonGroupScope&&"scope"==i.fields.buttonGroupScope.value&&null==i.fields.scopeField.selectedItems)return widget.notify.handler().addNotif({level:"error",subtitle:u.ScopeSelectMessage,sticky:!1}),void i.fields.scopeField._editor.elements.inputField.focus();!i.fields.templateField.selectedItems||""==i.fields.templateField.selectedItems.options.label||""!=i.fields.templateField.selectedItems.options.value&&null!=i.fields.templateField.selectedItems.options.value?d.validateRouteCustomAttrInfo(f,i.fields)&&(e.dsModel.label=u.buttonProgress,e.dsModel.disabled=!0,p.buttons.Apply.disabled=!0,p.buttons.Cancel.disabled=!0,t.createRoute(i,S(),k()).then((i=>{var n="";n=i[0].title.length>30?i[0].title.substring(0,27)+"...":i[0].title;var a={level:"success",subtitle:u.replace(u.successCreatedAndStarted,{tag1:n}),sticky:!1,allowUnsafeHTML:!1};if(o&&o.parentRouteId)e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag?(widget.routeMgmtMediator.publish("initiateRouteClearContent-on-createAnother"),e.dsModel.label=u.start,e.dsModel.disabled=!1,p.buttons.Apply.disabled=!1,p.buttons.Cancel.disabled=!1):e.dsModel.dialog.close(),s.fetchRouteById(o.parentRouteId).then((e=>{widget.routeMgmtMediator.publish("route-summary-show-message",{message:a}),widget.routeMgmtMediator.publish("route-data-updated",e[0]),widget.data.inboxTaskSelectedId=o.inboxTaskId,widget.routeMgmtMediator.publish("redraw-graph",e[0]),null!=widget.data.contextTitle&&""!=widget.data.contextTitle||null!=widget.data.linkedContextTitle&&""!=widget.data.linkedContextTitle||widget.routeMgmtMediator.publish("route-summary-append-rows",{model:i[0],openRoute:!1}),widget.data.fromContext="subRoute",widget.routeMgmtMediator.publish("route-created",i[0]),widget.data.fromContext="",widget.routeMgmtMediator.publish("refresh-homepage-after-route-created",{model:i[0],openRoute:!1})}),(e=>{}));else if(o&&o.templateId)e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag?(widget.routeMgmtMediator.publish("initiateRouteClearContent-on-createAnother"),e.dsModel.label=u.start,e.dsModel.disabled=!1,p.buttons.Apply.disabled=!1,p.buttons.Cancel.disabled=!1):e.dsModel.dialog.close(),widget.routeMgmtMediator.publish("template-new-route-show-message",{message:a}),"Complete"==i[0].state&&(a={level:"success",subtitle:u.routeCompletedSuccess,sticky:!1},widget.routeMgmtMediator.publish("template-new-route-show-message",{message:a})),o.Actions&&-1!=o.Actions.findIndex((e=>e.includes("demote")))&&t.refreshTemplateObjectOnRouteCreation(o.templateId);else{let t=!0;e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag&&(t=!1),widget.routeMgmtMediator.publish("route-summary-append-rows",{model:i[0],openRoute:t}),widget.routeMgmtMediator.publish("route-created",i[0]);let o=document.getElementsByClassName("wux-layouts-gridengine-poolcontainer-rel")[1].offsetHeight,n=document.getElementsByClassName("Route-tile-blank-space")[0];n&&(n.style.height=`calc(100% - ${o}px)`),e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag?(widget.routeMgmtMediator.publish("initiateRouteClearContent-on-createAnother"),e.dsModel.label=u.start,e.dsModel.disabled=!1,p.buttons.Apply.disabled=!1,p.buttons.Cancel.disabled=!1):e.dsModel.dialog.close(),widget.routeMgmtMediator.publish("route-summary-show-message",{message:a}),widget.routeMgmtMediator.publish("refresh-homepage-after-route-created",{model:i[0],openRoute:t}),"Complete"==i[0].state&&(a={level:"success",subtitle:u.routeCompletedSuccess,sticky:!1},widget.routeMgmtMediator.publish("route-summary-show-message",{message:a}))}widget.routeMgmtMediator.publish("route-deactivate-tag-data")}),(t=>{e.dsModel.label=u.start,e.dsModel.disabled=!1,p.buttons.Apply.disabled=!1,p.buttons.Cancel.disabled=!1,t&&t.error&&-1!=t.error.indexOf(u.ErrorChooseUsers)?widget.notify.handler().addNotif({level:"error",subtitle:u.UnresolvedTasksError,sticky:!1}):t&&t.error.toLowerCase().indexOf("no create access")>-1?widget.notify.handler().addNotif({level:"error",title:u.errorCreateRouteForRoleTitle,subtitle:u.errorCreateRouteForRoleSubTitle,message:u.errorCreateRouteForRoleMsg,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:t.error,sticky:!1})}))):widget.notify.handler().addNotif({level:"error",subtitle:u.TemplateSelectMessage,sticky:!1})}}),Apply:new a({disabled:!0,emphasize:"secondary",domId:"applyButton",label:u.saveAsDraft,allowUnsafeHTMLLabel:!0,onClick:function(e){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Save as Draft"});let i=v();if(i.fields.buttonGroupScope&&"scope"==i.fields.buttonGroupScope.value&&null==i.fields.scopeField.selectedItems)return widget.notify.handler().addNotif({level:"error",subtitle:u.ScopeSelectMessage,sticky:!1}),void i.fields.scopeField._editor.elements.inputField.focus();if(i.fields.templateField.selectedItems&&""!=i.fields.templateField.selectedItems.options.label&&(""==i.fields.templateField.selectedItems.options.value||null==i.fields.templateField.selectedItems.options.value))return void widget.notify.handler().addNotif({level:"error",subtitle:u.TemplateSelectMessage,sticky:!1});if(!d.validateRouteCustomAttrInfo(f,i.fields))return;let n=k();e.dsModel.label=u.buttonProgress,e.dsModel.disabled=!0,0==p.buttons.Ok.disabled&&(m=!0),p.buttons.Cancel.disabled=!0,p.buttons.Ok.disabled=!0,t.saveAsRoute(i,S(),n).then((i=>{var n="";n=i[0].title.length>30?i[0].title.substring(0,27)+"...":i[0].title;var a={level:"success",subtitle:u.replace(u.successCreate,{tag1:n}),sticky:!1,allowUnsafeHTML:!1};if(o&&o.parentRouteId)e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag?(widget.routeMgmtMediator.publish("initiateRouteClearContent-on-createAnother"),e.dsModel.label=u.saveAsDraft,e.dsModel.disabled=!1,p.buttons.Cancel.disabled=!1,null!=i[0].tasks&&(p.buttons.Ok.disabled=!1)):e.dsModel.dialog.close(),s.fetchRouteById(o.parentRouteId).then((e=>{widget.routeMgmtMediator.publish("route-summary-show-message",{message:a}),widget.routeMgmtMediator.publish("route-data-updated",e[0]),widget.data.inboxTaskSelectedId=o.inboxTaskId,widget.routeMgmtMediator.publish("redraw-graph",e[0]),null!=widget.data.contextTitle&&""!=widget.data.contextTitle||null!=widget.data.linkedContextTitle&&""!=widget.data.linkedContextTitle||widget.routeMgmtMediator.publish("route-summary-append-rows",{model:i[0],openRoute:!1}),widget.data.fromContext="subRoute",widget.routeMgmtMediator.publish("route-created",i[0]),widget.data.fromContext="",widget.routeMgmtMediator.publish("refresh-homepage-after-route-created",{model:i[0],openRoute:!1})}),(e=>{}));else if(o&&o.templateId)e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag?(widget.routeMgmtMediator.publish("initiateRouteClearContent-on-createAnother"),e.dsModel.label=u.saveAsDraft,e.dsModel.disabled=!1,p.buttons.Cancel.disabled=!1,null!=i[0].tasks&&(p.buttons.Ok.disabled=!1)):e.dsModel.dialog.close(),widget.routeMgmtMediator.publish("template-new-route-show-message",{message:a}),o.Actions&&-1!=o.Actions.findIndex((e=>e.includes("demote")))&&t.refreshTemplateObjectOnRouteCreation(o.templateId);else{let t=!0;e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag&&(t=!1),widget.routeMgmtMediator.publish("route-summary-append-rows",{model:i[0],openRoute:t}),widget.routeMgmtMediator.publish("route-created",i[0]);let o=document.getElementsByClassName("wux-layouts-gridengine-poolcontainer-rel")[1].offsetHeight,n=document.getElementsByClassName("Route-tile-blank-space")[0];n&&(n.style.height=`calc(100% - ${o}px)`),e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag?(widget.routeMgmtMediator.publish("initiateRouteClearContent-on-createAnother"),e.dsModel.label=u.saveAsDraft,e.dsModel.disabled=!1,p.buttons.Cancel.disabled=!1,null!=i[0].tasks&&(p.buttons.Ok.disabled=!1)):e.dsModel.dialog.close(),widget.routeMgmtMediator.publish("route-summary-show-message",{message:a}),widget.routeMgmtMediator.publish("refresh-homepage-after-route-created",{model:i[0],openRoute:t})}widget.routeMgmtMediator.publish("route-deactivate-tag-data")}),(t=>{e.dsModel.label=u.saveAsDraft,e.dsModel.disabled=!1,p.buttons.Cancel.disabled=!1,1==m&&(p.buttons.Ok.disabled=!1),t&&t.error.toLowerCase().indexOf("no create access")>-1?widget.notify.handler().addNotif({level:"error",title:u.errorCreateRouteForRoleTitle,subtitle:u.errorCreateRouteForRoleSubTitle,message:u.errorCreateRouteForRoleMsg,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:t.error,sticky:!1})}))}}),Cancel:new a({label:u.cancel,domId:"cancelButton",emphasize:"secondary",allowUnsafeHTMLLabel:!0,onClick:function(e){e.dsModel.dialog.close(),widget.setValue("isDialogOpened",!1)}})}}),w(),p.addEventListener("close",(function(t){widget.notify.notifview().removeNotifications(),new e(c).destroy(),widget.setValue("isDialogOpened",!1)})),p.addEventListener("resize",(function(e){document.getElementById("initiateRoute")&&(document.getElementById("initiateRoute").offsetWidth<400?e.dsModel.buttons.Cancel.hide():e.dsModel.buttons.Cancel.show())})),p.addEventListener("visibilityChange",(function(e){document.getElementById("initiateRoute")&&(document.getElementById("initiateRoute").offsetWidth<400?e.dsModel.buttons.Cancel.hide():e.dsModel.buttons.Cancel.show())}))},w=function(){widget.routeMgmtMediator.subscribe("initiate-route-toggle-dialogbuttons",(function(){let e=v(),t=k();if(e&&e.formFields){e.formFields.getChildren();var o=e.fields.name.elements.inputField.value,i=e.fields.collaborativeSpace.value,n=e.fields.organization.value;""!=o.trim()&&i&&""!=i.trim()&&n&&""!=n.trim()&&(Array.isArray(t)&&t.length>=0||void 0===t)?(p.buttons.Apply.disabled=!1,g=!0):(p.buttons.Apply.disabled=!0,g=!1),m=!!(t&&Array.isArray(t)&&t.length>0)||!(void 0!==t||!e.fields.templateField.selectedItems),p.buttons.Ok.disabled=!g||!m}}))},v=function(){return e.getModel("properties")},S=function(){return e.getModel("content")},k=function(){return e.getModel("tasks")};return{InitiateRouteDialog:e=>{return t=e,void l.fetchCredentials("newRouteDialog").then((function(e){h(t,e)}));var t},getDialog:()=>p}})),define("DS/ENORouteMgmt/Commands/InitiateRoute_Popup",["UWA/Core","UWA/Class","DS/ApplicationFrame/Command","DS/Core/Core","DS/UIKIT/Alert","DS/WAFData/WAFData","DS/PADUtils/PADSettingsMgt","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Commands/CommandAvailableOnSelect","DS/ENORouteMgmt/Views/Dialogs/InitiateRouteDialog","DS/UIKIT/Form","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/ENORouteMgmt/Components/Mediator","DS/ENORouteMgmt/Components/Notifications","DS/ENORouteMgmt/Commands/InitialRoute_Widget","DS/WidgetServices/WidgetServices","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h,w,v,S,k){"use strict";new n({className:"csg-alert",closable:!0,renderTo:document.body,visible:!0,autoHide:!0,hideDelay:5e3,messageClassName:"error"});var T,R=new n({className:"csg-alert",closable:!0,renderTo:document.body,visible:!0,autoHide:!0,messageClassName:"success"});let y;return t.extend(o,l,{init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!0}),widget.notify=new f,r.start({id:widget.id}),widget.routeMgmtMediator=new g},beginExecute:function(){this._frmWindow=this.getFrameWindow()},resumeExecute:function(){},launchCreateRouteModal:function(e){widget.body,T=e.getSelectedNodes();var t=[],o=[];T.length&&T.forEach((function(e){var i=e&&"function"==typeof e.getInstID?e.getInstID():null;if(null!=i&&Array.isArray(i)&&(i=i.length>0?i[0]:null),i=(i=i||e.getID())||e.id){var n={id:i,name:e._options.grid["ds6w:identifier"],title:e._options.label,stateNLS:e._options.grid["ds6w:status"],type:e._options.grid["ds6w:type"],description:e._options.grid["ds6w:description"],owner:e._options.grid["ds6w:responsible"],created:e._options.grid["ds6w:created"],modified:e._options.grid["ds6w:modified"],typeIcon:e._options.grid.thumbnail};t.push(n),o.push(n)}}));this.collection;var i=T&&T[0]?T[0]:{};if(void 0!==i.getType&&"Content"===i.getType())require(["DS/FolderEditor/Folder_CSO"],(function(e){var t={folderDetails:e.getCurrentFolder(),contentIds:o};v.fetchRouteCustomFields().then((e=>{S.setRouteCustomFields(e),d.InitiateRouteDialog(t)}),(e=>{d.InitiateRouteDialog(t),console.log("fetching custom route attribute defintion failed!!")}))}));else{var n={folderDetails:null,contentIds:o};v.fetchRouteCustomFields().then((e=>{S.setRouteCustomFields(e),d.InitiateRouteDialog(n)}),(e=>{d.InitiateRouteDialog(n),console.log("fetching custom route attribute defintion failed!!")}))}widget.routeMgmtMediator.subscribeOnce("route-created",(function(e){var t={};t.routeId=e.id,t.routeName=e.name,(new h).execute(t);var o="";o=t.routeName.length>30?t.routeName.substring(0,27)+"...":t.routeName,R.add({message:k.replace(k.successCreate,{tag1:o})})}));this.onResume((function(){})),this.onPause((function(){}))},execute:function(t){var o=this,i=widget.getValue("x3dPlatformId"),n=widget.getValue("xPref_CREDENTIAL")?"ctx::"+widget.getValue("xPref_CREDENTIAL"):"";n&&(widget.data.routeCredentials={securityContext:n,tenant:i}),require(["DS/PADUtils/PADContext"],(function(t){var i=t.get();null==i&&(i=o.options.context);var n,s=i.getSelectedNodes(),a=s&&s[0]?s[0]:{};if(a.getType?n=a.getType():a.options?n=a.options.type:a.object&&(n=a.object.type),"Folder"===n||"RootFolder"===n){let t=new c;t.inject(document.body);let o=new e.Element("div",{id:"invalidSelection",class:""});o.appendChild(e.createElement("div",{class:"",html:k.invalidSelection})),y=new p({modalFlag:!0,width:350,height:150,title:"",content:o,immersiveFrame:t,buttons:{Ok:new m({onClick:function(e){e.dsModel.dialog.close()}})}})}else o.launchCreateRouteModal(i)}))},endExecute:function(){}})})),define("DS/ENORouteMgmt/Config/TaskAssigneesGridViewConfig",["DS/ENORouteMgmt/Model/TaskAssigneeModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";return[{text:t.owner,dataIndex:"Tree",editableFlag:!1,onCellRequest:e.onRouteNodeOwnerCellRequest}]})),define("DS/ENORouteMgmt/Views/RouteTabsView",["DS/Controls/TabBar","DS/ENORouteMgmt/Config/RouteTabsConfig","DS/ENORouteMgmt/Utilities/RouteWidgetPersistency","DS/ENORouteMgmt/Model/RouteModel"],(function(e,t,o,i){"use strict";let n,s,a={},r={},l=function(e,t){r=t,this.container=e};var d=["tasks","content","members"];let u=function(e){let t=e.options.value;if(void 0===t&&(t=e.dsModel.buttonGroup.value[0]),t===s)return;let o=i.getOpenedRouteModel();if(r.model.state!=o.model.state){r=o;let e=document.getElementById("routeContentsContainer");null!=e&&e.parentNode.removeChild(e)}a[d[t]].init(r),void 0!==s&&a[d[s]].hideView(),s=t,widget.setValue("RouteTabs-ShowView",t)};l.prototype.init=function(){n=new e({displayStyle:"strip",showComboBoxFlag:!0,editableFlag:!1,multiSelFlag:!1,reindexFlag:!0,centeredFlag:!1,allowUnsafeHTMLOnTabButton:!0}),t.forEach((e=>{let t=o.getTabPersistency("RouteTabsPage");e.id==d[t]?e.isSelected=!0:e.isSelected=!1,n.add(e)})),n.inject(this.container),c()};let c=function(){new Promise((function(e,o){let i=[];t.forEach(((e,t)=>{""!=e.loader&&(i[t]=new Promise((function(t,o){require([e.loader],(function(o){a[e.id]=o,t()}))})))})),Promise.all(i).then((()=>{e()}))})).then((function(){let e={options:{}},t=o.getTabPersistency("RouteTabsPage");e.options.value=t,u(e),n.addEventListener("tabButtonClick",(function(e){u(e)})),n.addEventListener("change",(function(e){u(e)}))}),(function(){}))};return l.prototype.destroy=function(){try{s=void 0,Object.keys(a).map((e=>{a[e].destroy()})),null!=n&&n.destroy(),r={},this.container.destroy()}catch(e){}},l})),define("DS/ENORouteMgmt/Model/CollabStorageModel",["UWA/Core","UWA/Class/Model","DS/ENORouteMgmt/EnoviaBootstrap"],(function(e,t,o){"use strict";return t.extend({name:"collabstorage",defaults:{csrf:null,isInnovation:!1,displayName:"",url:""},url:function(){return this.get("url")},fetch:function(t){var i,n,s;n="url",(i=this)&&(s=i[n],e.is(s,"function")&&(s=s.call(i)));return t=t?e.clone(t,!1):{},e.extend(t,o.getSyncOptions(),!0),this._parent.call(this,t)},parse:function(t){var o=e.clone(t);return o.csrf=t.csrftoken,delete o.csrftoken,o.isInnovation=t.isinnovation,delete o.isinnovation,o}})})),define("DS/ENORouteMgmt/Views/Grid/RouteMembersGridCustomColumns",["DS/Controls/Button","DS/Controls/TooltipModel","UWA/Drivers/Alone","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/LifecycleControls/EditPropDialog","DS/WebappsUtils/WebappsUtils","DS/TransientWidget/TransientWidget","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l){"use strict";return{onMemberActionCellRequest:e=>function(e){require(["DS/ENORouteMgmt/Views/Menu/MemberContextualMenu"],(function(o){var i="";if(null==o.routeMemberGridCheveron(e.nodeModel.options.grid,s)){var n=new UWA.Element("div",{id:"noCheveron",class:"no-Cheveron-class",html:""});e.cellView._setReusableContent(n)}else{if(!e.isHeader){var s=[];s.push(e.nodeModel.options.grid.id),(i=new UWA.Element("div",{id:"cheveron",class:"cheveron-class",html:o.routeMemberGridCheveron(e.nodeModel.options.grid,s)})).tooltipInfos=new t({shortHelp:l.actions,allowUnsafeHTMLShortHelp:!0})}e.cellView._setReusableContent(i)}}))}(e),onMemberNodeNameCellRequest:e=>function(e){let o;if(!e.isHeader&&(o=e.cellView.collectionView.reuseCellContent("_owner_"),o)){var l;o.removeEvents();var d=e.nodeModel.options.grid.Type;let g=e.nodeModel.options.grid.id;var u=e.nodeModel.options.label,c=e.nodeModel.options.grid.userName,p="/api/user/getpicture/login/"+c+"/format/normal";if(null==u||""==u)return o.getChildren()[1].setHTML(""),o.querySelector(".avatarIcon")&&o.querySelector(".avatarIcon").setStyle("display","none"),o.querySelector(".userIcon")&&o.querySelector(".userIcon").setStyle("display","none"),void e.cellView._setReusableContent(o);var m=n.getAvatarDetails(u);let f=UWA.createElement("img",{class:"userIcon",src:""});if("Group"===d||"User Group"===d||"Group Proxy"===d){l=a.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png"),f.src=l;let t=e.nodeModel.options.grid.ugUUID;o.setStyle("cursor","pointer"),o.addEvent("click",(function(e){n.launchPreviewGroupMembers(t)}))}else"Person"==d&&(l=i.getSwymUrl()+p);e&&e.nodeModel&&e.nodeModel.options&&"memberParentTreeId"==e.nodeModel.options.id?o.querySelector(".assignee").style.display="none":o.querySelector(".assignee").style.display="","Person"==d?(o.querySelector(".userName").style.removeProperty("color"),o.querySelector(".userName").style.removeProperty("text-decoration"),null!=i.getSwymUrl()?o.querySelector(".userIcon")&&(o.querySelector(".userIcon").setStyle("display","block"),o.querySelector(".userIcon").src=l,o.setStyle("cursor","pointer"),o.addEvent("click",(function(e){r.showWidget("X3DPRFL_AP","",{login:c,url:i.getSwymUrl()+"?profile="+c},{mode:"panel",height:700,width:800})}))):(o.querySelector(".userIcon")&&o.querySelector(".userIcon").setStyle("display","none"),o.querySelector(".avatarIcon").setStyle("display","block"),o.setStyle("cursor","pointer"),o.addEvent("click",(function(e){var t={_context:i.getSecurityContextValue(),_selection:[{getID:function(){return g}}],getSecurityContext:function(){return this._context},getSelectedNodes:function(){return this._selection},displayNotification:function(){}};(new s).launchProperties(t)})),o.querySelector(".avatarIcon").setHTML(m.avatarStr),o.querySelector(".avatarIcon").setStyle("background",m.avatarColor),o.querySelector(".avatarIcon").setStyle("display","block"))):(o.querySelector(".userIcon")?o.querySelector(".userIcon").src=l:o.getChildren()[0].addContent(f),o.querySelector(".avatarIcon")&&o.querySelector(".avatarIcon").setStyle("display","none"),o.querySelector(".userIcon").setStyle("display","block")),o.getChildren()[1].setText(u),o.getChildren()[1].tooltipInfos=new t({shortHelp:u}),e.cellView._setReusableContent(o)}}(e)}})),define("DS/ENORouteMgmt/Utilities/RouteMemberModelFormatter",["DS/WebappsUtils/WebappsUtils","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n){"use strict";let s,a=function(e){return"Collab Space"==e.accessType?n.Collab_Space:"User Group"==e.accessType?n.UserGroup:n.Person},r=function(s,r,l){var d,u,c=s.userAccess,p=[];return p="Collab Space"===s.accessType||"true"===s.isRouteOwner||"true"!==s.isLoggedInUserRouteOwner||"Route Template"==r&&"Active"===l||"Route"==r&&("Complete"===l||"Archive"===l||"false"===s.canModifyMemberAccess||"Completed"===l||"Released"===l||"Archived"===l)?[]:["My Context Menu"],"User Group"===s.accessType?(d=e.getWebappsAssetUrl("ENORouteMgmt","icons/144/default-group.png"),e.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png"),u=s.fullname):(d=function(e,t){var n="/api/user/getpicture/login/"+t+"/format/normal",s=i.getSwymUrl()+n,a=(new UWA.Element("div",{}),new UWA.Element("div",{class:"assignee"}),"");if(null!=i.getSwymUrl())a=UWA.createElement("img",{class:"member-userIcon",src:s});else{var r=o.getAvatarDetails(e);(a=UWA.createElement("div",{html:r.avatarStr,title:e,class:"member-avatarIcon"})).style.setProperty("background",r.avatarColor)}return a}(s.fullname,s.userName),"user wux-ui-3ds",u=s.fullname),new t({label:u,width:300,grid:{id:s.id,Name:s.fullname,Type:s.accessType,TypeNLS:a(s),Access:s.userAccess,AccessNLS:n[s.userAccess],Actions:s.actions,ugUUID:s.ugUUID,userName:s.userName,isRouteOwner:s.isRouteOwner,isLoggedInUserRouteOwner:s.isLoggedInUserRouteOwner,canModifyMemberAccess:s.canModifyMemberAccess},id:s.id,thumbnail:d,subLabel:n[c],contextualMenu:p})};return s={getMembersTreeNodeModel:(e,t,o)=>r(e,t,o)},s})),define("DS/ENORouteMgmt/Model/RouteMemberModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/RouteMemberModelFormatter","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n){"use strict";let s=new e,a=new e,r=new e,l=function(e,t){e=e.filter((e=>"Collab Space"!=e.accessType));var o=t.model.Maturity_State,n=t.model.Type;null==n&&(n="Inactive"==o||"Active"==o?"Route Template":"Route");let s=e.filter((e=>{if("true"==e.isRouteOwner)return e}));return 0==s.length&&(s=[{Access:"Add Remove",userAccess:"role.addremove",accessType:"Person",name:t.model.UserName,fullname:t.model.OwnerFullName,userName:t.model.UserName}]),a.prepareUpdate(),s.forEach((function(e){let t=i.getMembersTreeNodeModel(e,n,o);a.addRoot(t)})),a.pushUpdate(),a},d=function(e,t){e=e.filter((e=>"Collab Space"!=e.accessType));var o=t.model.Maturity_State,n=t.model.Type;null==n&&(n="Inactive"==o||"Active"==o?"Route Template":"Route");let s=document.querySelectorAll("#routeMembersContainer #tileViewContainer .wux-controls-abstract.wux-controls-expander-placeholder")[1];return s&&(e.length>0?s.style.display="block":s.style.display="none"),r.prepareUpdate(),e.forEach((function(e){let t=i.getMembersTreeNodeModel(e,n,o);r.addRoot(t)})),r.pushUpdate(),r},u=function(e,t){var i="role."+t.model.Access.replace(" ","").toLowerCase(),s=o.getRowModelByDescendantsId(e,t.model.id),a=s.options.grid;a.Access=i,a.AccessNLS=n[i],s.updateOptions({grid:a}),s.updateOptions({subLabel:n[i]})};return{createModel:(e,o)=>function(e,o){l(e,o),d(e,o);let a=[];var r=o.model.Maturity_State,u=o.model.Type;null==u&&(u="Inactive"==r||"Active"==r?"Route Template":"Route"),s.prepareUpdate();let c={Access:"Add Remove",userAccess:"role.addremove",accessType:"Person",name:o.model.UserName,fullname:o.model.OwnerFullName,userName:o.model.UserName,id:o.model.OwnerId};e=e.filter((e=>"Collab Space"!=e.accessType)),a.push(c),a.push(e);for(let e=0;e<a.length;e++)if(0==e){let o=a[e];var p=new t({label:n.ownerRole,width:300,id:"memberParentTreeId",subLabel:n.ownerRole});let l=i.getMembersTreeNodeModel(o,u,r);p.addChild(l),s.addRoot(p)}else{let o=a[e];o.length>0&&(p=new t({label:n.owner+" ("+o.length+")",id:"memberParentTreeId",width:300,subLabel:n.ownerRole}));for(let e=0;e<o.length;e++){let t=o[e],n=i.getMembersTreeNodeModel(t,u,r);p.addChild(n)}s.addRoot(p)}return s.getRoots()[0].expand(),s.getRoots()[1]&&s.getRoots()[1].expand(),s.setFilterModel({label:{filterId:"set"},userName:{filterId:"set"},TypeNLS:{filterId:"set"},AccessNLS:{filterId:"set"}}),s.pushUpdate(),s}(e,o),getModel:()=>s,updateRow:e=>{var t;(t=e).model.id&&""!=t.model.id&&(u(s,t),u(r,t))},getOwnerTileModel:()=>a,getAssigneeTileModel:()=>r,destroy:()=>(s=new e,r=new e,void(a=new e))}})),define("DS/ENORouteMgmt/Config/RouteMembersGridViewConfig",["DS/ENORouteMgmt/Views/Grid/RouteMembersGridCustomColumns","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";return[{text:t.title,dataIndex:"tree",typeRepresentation:"user",onCellRequest:e.onMemberNodeNameCellRequest},{text:t.name,dataIndex:"userName"},{text:t.type,dataIndex:"TypeNLS"},{text:t.access,dataIndex:"AccessNLS"},{text:t.actions,dataIndex:"Action",editableFlag:!1,onCellRequest:e.onMemberActionCellRequest}]})),define("DS/ENORouteMgmt/Views/Grid/RouteMembersDataGridView",["DS/ENORouteMgmt/Config/RouteMembersGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Config/Toolbar/RouteMembersTabToolbarConfig"],(function(e,t,o){"use strict";return{build:i=>function(i){let n="Members-gridView-View hideView";"GridView"==widget.getValue("MembersTab-ShowView")&&(n="Members-gridView-View showView");var s=UWA.createElement("div",{id:"dataGridViewContainer",styles:{width:"100%",height:"calc(100% - 40px)",position:"relative"},class:n});let a=o.writetoolbarDefination();return t.build(i,e,a,s,{identifier:"RouteMembersDataGridView"})}(i),getGridViewToolbar:()=>t.dataGridViewToolbar()}})),define("DS/ENORouteMgmt/Actions/MemberActions",["UWA/Drivers/Alone","UWA/Core","DS/WAFData/WAFData","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Model/RouteMemberModel","DS/ENORouteMgmt/Controller/RouteServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l){"use strict";let d;return d={onChangeAccess:function(e,t){r.changeAccess(e,t).then((e=>{widget.routeMgmtMediator.publish("member-data-updated",{model:n.memberGridData(e.data[0].dataelements)}),widget.notify.handler().addNotif({level:"success",subtitle:l.successChangeAccess,sticky:!0})}),(e=>{e.error&&e.error.indexOf("#1500572")>=0&&e.error.indexOf("select policy does not exist")>0?widget.notify.handler().addNotif({level:"error",subtitle:l.ErrorInvalidObject,sticky:!0}):widget.notify.handler().addNotif({subtitle:l.errorChangeAccess})}))}},d})),define("DS/ENORouteMgmt/Utilities/CollabTasksResponseFormatter",["DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/EnoviaBootstrap"],(function(e,t,o,i){"use strict";let n;return n={getRouteTaskResponse:(e,i)=>function(e,i){var n,s,a,r;s=(new t).parseResp(JSON.parse(e)),e=JSON.parse(e);var l={};l.data=e.data[0].relateddata.tasks,n=(new t).parseResp(l);var d={};d.data=e.data[0].relateddata.contents,r=(new t).parseResp(d);var u=e.data[0].relateddata.tasks;for(let e=0;e<n.length;e++){if(n[e].id==i){var c=[],p=!1;if(null!=u[e].relateddata.subroutes){for(var m=u[e].relateddata.subroutes[0].relateddata.route,g=0;g<m.length;g++)c.push(m[g].dataelements);c.length>0&&(p=!0)}var f="";p&&(f=u[e].relateddata.subroutes[0].dataelements.TaskApprovalStatus);var h=n[e].ContentToReviewIds,w=[];if(""!=h&&null!=h)for(var v=0;v<r.length;v++)h.includes(r[v].physicalid)&&w.push(r[v]);let t=[];for(let o=0;o<r.length;o++)(0==r[o].relatedToTaskIds.length||r[o].relatedToTaskIds.toString().includes(n[e].id))&&t.push(r[o]);n[e].routeContents=t,n[e].RouteTaskContentToReview=w,n[e].taskSubRoutes=c,n[e].subRouteApprovalStatus=f}var S={};S.model=o.gridData(s[0]),a={id:S.model.id,scopeId:""==S.model.Scope[0]?""==S.model.Scope[1]?S.model.Scope[2]:S.model.Scope[1]:S.model.Scope[0],routeBasePurpose:S.model.BasePurpose,chooseUserFromGroup:S.model.chooseUserFromGroup,model:S.model}}let k;for(let e=0;e<n.length;e++)i==n[e].id&&(k=n[e]);return k.taskDetailsList=function(e){let t=e.taskDetails,o=[];return t?t.forEach(((e,t)=>{"true"==e.split("~")[1]&&o.push(e.split("~")[0])})):o.push("showTaskRemove"),o}(k),{model:{model:{routePropertiesInfo:a,options:{label:"",id:i,grid:k}},routePropertiesInfo:a}}}(e,i)},n})),define("DS/ENORouteMgmt/Views/Menu/MemberContextualMenu",["DS/Menu/Menu","DS/ENORouteMgmt/Actions/MemberActions","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Model/RouteMemberModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n){"use strict";let s,a=function(e,o,i){let s;var a=[];return-1!==e.indexOf("Read")&&(s="unselected","role.read"==i&&(s="selected"),a.push({name:n["role.read"],title:n["role.read"],type:"CheckItem",state:s,data:null,action:{callback:function(){t.onChangeAccess("Read",o)}}})),-1!==e.indexOf("Read Write")&&(s="unselected","role.readwrite"==i&&(s="selected"),a.push({name:n["role.readwrite"],title:n["role.readwrite"],type:"CheckItem",state:s,data:null,action:{callback:function(){t.onChangeAccess("Read Write",o)}}})),-1!==e.indexOf("Add")&&(s="unselected","role.add"==i&&(s="selected"),a.push({name:n["role.add"],title:n["role.add"],type:"CheckItem",state:s,data:null,action:{callback:function(){t.onChangeAccess("Add",o)}}})),-1!==e.indexOf("Remove")&&(s="unselected","role.remove"==i&&(s="selected"),a.push({name:n["role.remove"],title:n["role.remove"],type:"CheckItem",state:s,data:null,action:{callback:function(){t.onChangeAccess("Remove",o)}}})),-1!==e.indexOf("Add Remove")&&(s="unselected","role.addremove"==i&&(s="selected"),a.push({name:n["role.addremove"],title:n["role.addremove"],type:"CheckItem",state:s,data:null,action:{callback:function(){t.onChangeAccess("Add Remove",o)}}})),a};return s={memberContextualMenu:(e,t,o)=>a(e,t,o),membersGridRightClick:(t,o)=>function(t,o){var n=[],s=o.Access,r=o.id,l=i.getModel(),d=l.RouteState,u=l.Type;if(null==u&&(u="Inactive"==d||"Active"==d?"Route Template":"Route"),"Collab Space"!==o.Type&&"true"!==o.isRouteOwner&&"true"===o.isLoggedInUserRouteOwner&&("Route Template"!=u||"Active"!==d)&&("Route"!=u||"Complete"!==d&&"Archive"!==d&&"false"!==o.canModifyMemberAccess)){n=["Read","Read Write","Add","Remove","Add Remove"],t.preventDefault(),t.stopPropagation();var c=t.target.getBoundingClientRect(),p={position:{x:c.left,y:c.top+20}},m=[];m=m.concat(a(n,r,s)),e.show(m,p)}}(t,o),routeMemberGridCheveron:(t,o)=>function(t,o){var n=[],s=t.Access,r=i.getModel(),l=r.RouteState,d=r.Type;if(null==d&&(d="Inactive"==l||"Active"==l?"Route Template":"Route"),"Collab Space"!==t.Type&&"true"!==t.isRouteOwner&&"true"===t.isLoggedInUserRouteOwner&&("Route Template"!=d||"Active"!==l)&&("Route"!=d||"Complete"!==l&&"Archive"!==l&&"false"!==t.canModifyMemberAccess))return n=["Read","Read Write","Add","Remove","Add Remove"],UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-chevron-down ",events:{click:function(t){t.preventDefault(),t.stopPropagation();var i=t.target.getBoundingClientRect(),r={position:{x:i.left,y:i.top+20}},l=[];l=l.concat(a(n,o,s)),e.show(l,r)}}})}(t,o)},s})),define("DS/ENORouteMgmt/Config/RemoveRouteGridViewConfig",["DS/ENORouteMgmt/Views/Grid/RouteGridCustomColumns","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";return[{text:t.title,dataIndex:"tree",editableFlag:!1,pinned:"left"},{text:t.IDcardMaturityState,dataIndex:"Maturity_State",editableFlag:!1,onCellRequest:e.onRemoveRouteNodeStateCellRequest},{text:t.revision,dataIndex:"revisionValue",typeRepresentation:"user",editableFlag:!1},{text:t.activity_state,dataIndex:"Activity_StateNLS",typeRepresentation:"user",editableFlag:!1},{text:t.accessCheck,dataIndex:"Deleteicon",typeRepresentation:"user",editableFlag:!1}]})),define("DS/ENORouteMgmt/Collections/CollabStorageCollection",["UWA/Core","UWA/Utils","UWA/Class/Collection","DS/PlatformAPI/PlatformAPI","DS/ENORouteMgmt/Model/CollabStorageModel","DS/i3DXCompassServices/i3DXCompassServices","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],(function(e,t,o,i,n,s,a){"use strict";return o.extend({name:"collabstorages",model:n,fetch:function(e){var t=this,o=[];return new Promise((function(e,t){a.getGrantedRoles((function(t){t.forEach((function(e){"CSV"!==e.id&&"InternalDS"!==e.id||UWA.is(e.platforms,"array")&&(o=o.concat(e.platforms))})),e()}))})).then((function(){s.getPlatformServices({serviceName:"3DSpace",onComplete:function(i){o.length>0&&Object.keys(i).map((function(e){o.includes(i[e].platformId)&&t.add({id:i[e].platformId,displayName:i[e].displayName,url:i[e]["3DSpace"]})})),e&&e.onComplete&&e.onComplete(t)},onFailure:function(t){e&&e.onFailure&&e.onFailure(t)}})}))},getStorageWithUrl:function(o,i){i=e.clone(i||{},!1);var n,s=t.parseUrl(o).domain;i.domainStrict;if(n=function(o){var i,n,a;return t.parseUrl((i=o,n="url",i&&(a=i[n],e.is(a,"function")&&(a=a.call(i))),a)).domain===s},e.is(s))return this.find(n)}})})),define("DS/ENORouteMgmt/Components/Wrappers/WrapperLargeTileView",["DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/ENXESignature/ENXESignMgmtDetails","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Controller/RouteESignServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n){"use strict";let s,a,r=function(s,r){a=r||UWA.createElement("div",{id:"routeInfoHistoryContainer",class:""});var l=new e({model:s,displayedOptionalCellProperties:["description","contextualMenu"],selectionBehavior:{toggle:!1,unselectAllOnEmptyArea:!1,selectNodeModelOnCellSelection:!1,canMultiSelect:!1,canInteractiveMultiselectWithCheckboxClick:!1,enableShiftSelection:!1,enableFeedbackForActiveCell:!1},onContextualEvent:{callback:function(e){var s=[],a=e.cellInfos.cellModel.options.data.split("~")[3],r=e.cellInfos.cellModel.options.subLabel;return null==a||""==a||s.push({name:n.ESignRecord,title:n.ESignRecord,type:"PushItem",data:e,action:{callback:function(){i.fetchESignDetails(a,"3DSpace").then((e=>{var i=JSON.parse(e);if(i.data.length>1){var n="",s="";i.data.forEach((e=>{var t=new Date(r),o=new Date(e.dataelements.SignedTime),i=Math.abs(o-t)/1e3;""==n&&(n=i),""==s&&(s=e.id),i<n&&(n=i,s=e.id)}));let e={x3dPlatformId:o.getTenantValue(),ESignRecordId:s,onCloseCallback:()=>{}};t.init(e,null)}else{let e={x3dPlatformId:o.getTenantValue(),serviceID:"3DSpace ",refID:a,onCloseCallback:()=>{}};t.init(e,null)}}),(e=>{console.log(e)}))}}}),s}}});return l.getContent().style.top="50 px",l.inject(a),a};return s={build:(e,t)=>r(e,t),tileView:()=>{}},s})),define("DS/ENORouteMgmt/Utilities/RouteWidgetUtil",["UWA/Core","DS/ENORouteMgmt/Controller/RouteServicesController","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Collections/CollabStorageCollection","DS/WAFData/WAFData","DS/ENOXWidgetPreferences/js/ENOXWidgetPreferences","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d,u){"use strict";let c,p,m,g;var f,h;let w=function(){return new o((function(e,t){h=new s,widget.getValue("xPref_CREDENTIAL")&&(g="ctx::"+widget.getValue("xPref_CREDENTIAL"),console.log("previous cs is set:"+g)),i.start({id:widget.id,collection:h}),widget.addPreference({name:"id-card-view",type:"hidden",defaultValue:"false",label:"minimized_label"}),widget.addPreference({name:"objectLimit",type:"range",min:"10",max:"10000",label:"objectLimit",defaultValue:"200"}),r.addPlatformSelectionPreferenceToWidget({roles:["CSV","InternalDS"],mustHaveAll:!1}).then((function(){console.log("New Platform Preference"),r.addCredentialPreferenceToWidget().then((function(){console.log("New Credential"),new o((function(e,t){h.fetch({onComplete:function(t,o,i){var n,s;(n=widget.getValue("collabstorage"))&&(h.forEach((function(e){e.get("url")===n&&(s=e.id)})),s&&widget.setValue("x3dPlatformId",s),widget.setValue("collabstorage",null)),y.call(void 0,t),e()}})})).then((function(t){S(),k(),R(),T(),e()})).catch((e=>{}))})).catch((e=>{widget.notify.handler().addNotif({level:"error",subtitle:e.message,sticky:!1})}))})),v()}))},v=function(){widget.routeMgmtMediator.subscribe("route-widgetTitle-count-update",(function(e){!function(e){e.model.getChildren().forEach((e=>{e._isHidden}));var t=e.model.getNumberOfVisibleDescendants(),o=u.myRoutes,i="routes";e.model.getChildren().length>0&&(i="Route Template"===e.model.getChildren()[0].options.grid.Type?"route_templates":"routes");var n=document.getElementById("route_templates");("route_templates"===i||n&&n.className&&n.className.contains("selected"))&&(o=u.myTemplates);var s=o+" ("+t+")";widget.setTitle(s);let a={event:"ObjectCount"};a.objectType=i,a.value=t,d.sendRouteTrackerEvent(a)}(e)})),widget.routeMgmtMediator.subscribe("route-widgetTitle-update-withName",(function(e){f=e.model.Title;var t=e.model.Title;widget.setTitle(t)})),widget.routeMgmtMediator.subscribe("route-data-updated",(function(e){if(e.noTitleUpdate);else if(e.title!=f){var t=e.title;widget.setTitle(t)}})),widget.routeMgmtMediator.subscribe("template-data-updated",(function(e){if(e.noTitleUpdate);else if(e.title!=f){var t=e.title;widget.setTitle(t)}}))},S=function(){b("Route").then((function(e){l.setStateNLS(e)})).catch((e=>{})),b("Route Template").then((function(e){l.setStateTemplateNLS(e)})).catch((e=>{}))},k=function(){t.fetchTaskFields().then((e=>{l.setTaskCustomFields(e)}),(e=>{console.log("fetching custom task attribute defintion failed!!")}))},T=function(){t.fetchRouteTemplateCustomFields().then((e=>{e&&Array.isArray(e)&&e.sort(((e,t)=>e.name.localeCompare(t.name))),l.setRouteTemplateCustomFields(e)}),(e=>{console.log("fetching custom route template attribute defintion failed!!")}))},R=function(){t.fetchRouteCustomFields().then((e=>{e&&Array.isArray(e)&&e.sort(((e,t)=>e.name.localeCompare(t.name))),l.setRouteCustomFields(e)}),(e=>{console.log("fetching custom route attribute defintion failed!!")}))};function y(e,n){e&&(t.fetchAllowedContentTypesForRoute().then((e=>{l.setRouteContentTypes(e)}),(e=>{})),new o((function(e,o){null==g?t.fetchSecurityContext().then((t=>{t[0].cspaces,null==t[0].defaultsc&&u.NoAccessToCollabSpace;let o=t[0].defaultsc,i=o?o.replace("ctx::",""):"";null==i&&""==i||widget.setValue("xPref_CREDENTIAL",i),e()}),(e=>{var t=JSON.parse(e);t.error?widget.notify.handler().addNotif({level:"error",subtitle:t.error.message,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:u.infoRefreshError,sticky:!1}),o()})):e()})).then((e=>{widget.addPreference({name:"organization",type:"hidden",defaultValue:i.getSecurityContextValue().split("ctx::")[1].split(".")[1]})}),(e=>{console.log("Updating credentials failed!!")})))}function b(e){var t=i.get3DSpaceURL()+"/resources/bps/getTypeMaturity?type="+e;return new o((function(e,o){require(["DS/WAFData/WAFData"],(function(n){i.authenticateRequest(t,{headers:{Accept:"application/json","Content-Type":"application/ds-json"},method:"get",type:"json",onComplete:function(t){e(t)},onFailure:function(e){o(new Error("Could not fetch Type State Mapping NLS values"))}})}))}))}return p=function(e){},m=function(e){h&&i.updateURLsOnEdit(h),widget.setValue("organization",i.getSecurityContextValue().split("ctx::")[1].split(".")[1])},c={init:()=>w(),onEdit:e=>{},endEdit:e=>m(),registerWidgetTitleEvents:()=>v(),getTaskCustomFields:()=>k(),getRouteTemplateCustomFields:()=>T(),getRouteCustomFields:()=>R()},c})),define("DS/ENORouteMgmt/Views/Tile/RouteMembersTileView",["DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Views/Menu/MemberContextualMenu","DS/Controls/Expander","DS/Core/PointerEvents","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n){"use strict";let s;return{build:(t,i)=>function(t,i){s=i||new TreeDocument({useAsyncPreExpand:!0});let a="Members-tileView-View showView nonVisible";"GridView"==widget.getValue("MembersTab-ShowView")&&(a="Members-tileView-View hideView");var r=UWA.createElement("div",{id:"tileViewContainer",styles:{width:"100%",height:"calc(100% - 40px)",position:"relative"},class:a});let l=UWA.createElement("div",{id:"ownerTileViewContainer",styles:{width:"100%",position:"relative"},class:""}),d=UWA.createElement("div",{id:"assigneeTileViewContainer",styles:{width:"100%",position:"relative"},class:""}),u=e.build(t,l),c=e.tileView();c.onDragEnterBlank=function(e,t){return!1},c.onDragEnterCell=function(e,t){return!1},c.onDragOverBlank=function(e,t){return!1},c.onDragOverCell=function(e,t){return!1};let p=e.build(i,d);new o({body:u,header:n.ownerRole,expandedFlag:!0,style:"simple"}).inject(r);let m=i.getChildren(),g=new o({body:p,header:n.owner+" ("+m.length+")",expandedFlag:!0,style:"simple"});g.inject(r),widget.routeMgmtMediator.subscribe("member-update-assignee-count",(function(){g.header=n.owner+"("+i.getChildren().length+")"}));let f=e.tileView();return f.onDragEnterBlank=function(e,t){return!1},f.onDragEnterCell=function(e,t){return!1},f.onDragOverBlank=function(e,t){return!1},f.onDragOverCell=function(e,t){return!1},r}(t,i),contexualMenuCallback:()=>{e.tileView().onContextualEvent={callback:function(e){var o=[],i=[];if(e&&e.cellInfos&&e.cellInfos.cellModel){var n,a=s.RouteState;n="Inactive"==a||"Active"==a||"Draft"==a?"Route Template":"Route";var r=s.getSelectedNodes(),l=r[0].options.grid.Access;i="Collab Space"===r[0].options.grid.Type||"true"===r[0].options.grid.isRouteOwner||"true"!==r[0].options.grid.isLoggedInUserRouteOwner||"Route Template"==n&&"Active"===a||"Route"==n&&("Complete"===a||"Archive"===a||"false"===r[0].options.grid.canModifyMemberAccess)?[]:["Read","Read Write","Add","Remove","Add Remove"];var d=r[0]._options.grid.id;o=t.memberContextualMenu(i,d,l)}return o}}}}})),define("DS/ENORouteMgmt/Views/RouteMembersView",["DS/ENORouteMgmt/Views/Grid/RouteMembersDataGridView","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Views/Tile/RouteMembersTileView","DS/ENORouteMgmt/Model/RouteMemberModel","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Controller/RouteServicesController"],(function(e,t,o,i,n,s){"use strict";let a,r={},l=function(t){let n=e.build(i.getModel()),s=o.build(i.getOwnerTileModel(),i.getAssigneeTileModel());o.contexualMenuCallback(),g();let a=e.getGridViewToolbar(),r=UWA.createElement("div",{id:"dataGridMembersDivToolbar",class:"toolbar-container",styles:{width:"100%"}}).inject(t);a.inject(r),n.inject(t),s.inject(t),d();let l=document.querySelectorAll("#routeMembersContainer #tileViewContainer .wux-controls-abstract.wux-controls-expander-placeholder")[1],u=i.getAssigneeTileModel().getRoots();return l&&u&&u.length>0?l.style.display="block":l.style.display="none",t},d=function(){widget.routeMgmtMediator.subscribe("route-task-on-change-assignee",(function(){c()})),widget.routeMgmtMediator.subscribe("update-members-on-change-owner",(function(){c()})),widget.routeMgmtMediator.subscribe("route-task-on-save",(function(){c()})),widget.routeMgmtMediator.subscribe("ON_SPLIT_ROUTENODE",(function(){c()})),widget.routeMgmtMediator.subscribe("template-maturity-change",(function(){u()}))},u=function(){null!=a&&null!=a.model&&s.fetchRouteMembers(a.model.id).then((function(e){require(["DS/ENORouteTemplateMgmt/Model/RouteTemplateModel"],(function(t){let o=t.getRowModelById(a.model.id);if(o){let t=o.options.grid;i.getModel().removeRoots(),i.getOwnerTileModel().removeRoots(),i.getAssigneeTileModel().removeRoots(),p(e,{model:t})}}))}))},c=function(){a.model&&a.model.id&&s.fetchRouteMembers(a.model.id).then((function(e){if(widget.getValue("routeIdToBePersisted")){let t=n.getRowModelById(a.model.id);if(t){let o=t.options.grid;i.getModel().removeRoots(),i.getOwnerTileModel().removeRoots(),i.getAssigneeTileModel().removeRoots(),i.createModel(e,{model:o})}}else{require(["DS/ENORouteTemplateMgmt/Model/RouteTemplateModel"],(function(t){let o=t.getRowModelById(a.model.id);if(o){let t=o.options.grid;i.getModel().removeRoots(),i.getOwnerTileModel().removeRoots(),i.getAssigneeTileModel().removeRoots(),i.createModel(e,{model:t})}}))}widget.routeMgmtMediator.publish("member-update-assignee-count")}))},p=function(e,t){i.createModel(e,t),i.getModel().RouteId=t.model.id,i.getModel().RouteState=t.model.state,i.getModel().Type=t.model.Type,i.getOwnerTileModel().RouteId=t.model.id,i.getAssigneeTileModel().RouteId=t.model.id,i.getOwnerTileModel().RouteState=t.model.state,i.getAssigneeTileModel().RouteState=t.model.state},m=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&require(["DS/ENORouteMgmt/Views/Menu/MemberContextualMenu"],(function(o){o.membersGridRightClick(e,t.nodeModel.options.grid)}))},g=function(){t.dataGridView().addEventListener("contextmenu",m),widget.routeMgmtMediator.subscribe("member-data-updated",(function(e){i.updateRow(e)}))},f=function(){return null!=document.querySelector("#routeMembersContainer")&&(document.getElementById("routeMembersContainer").style.display="block",!0)};return{init:e=>function(e){if(a=e,!f()){let t=UWA.createElement("div",{id:"routeMembersContainer",class:"route-members-container"});t.inject(document.querySelector(".route-facets-container")),s.fetchRouteMembers(e.model.id).then((function(e){if(widget.getValue("routeIdToBePersisted")){let o=n.getRowModelById(a.model.id);if(o){let n=o.options.grid;i.destroy(),p(e,{model:n}),l(t)}}else require(["DS/ENORouteTemplateMgmt/Model/RouteTemplateModel"],(function(o){let n=o.getRowModelById(a.model.id);if(n){let o=n.options.grid;i.getModel().removeRoots(),i.getOwnerTileModel().removeRoots(),i.getAssigneeTileModel().removeRoots(),p(e,{model:o}),l(t)}}))}))}}(e),hideView:()=>{null!=document.getElementById("routeMembersContainer")&&(document.getElementById("routeMembersContainer").style.display="none")},destroy:()=>{r={},a={},i.destroy()}}})),define("DS/ENORouteMgmt/Views/CollabTaskTabsView",["DS/Controls/TabBar","DS/ENORouteMgmt/Utilities/RouteWidgetPersistency","DS/ENORouteMgmt/Config/CollabTaskTabsConfig","DS/ENORouteMgmt/Views/Form/TaskProperties"],(function(e,t,o,i){"use strict";let n,s,a={},r={},l=function(e,t){this.container=e,r=t};var d=["properties","members","comments","history"];let u=function(e){let t=e.options.value;if(void 0===t&&(t=e.dsModel.buttonGroup.value[0]),t!==s&&(a[d[t]].init(r),void 0!==s&&a[d[s]].hideView(),s=t,widget.setValue("RouteTaskTabs-ShowView",t),widget&&"ENOTASK_AP"==widget.getValue("appId"))){let e={0:"detailsTab",1:"membersTab",2:"commentsTab",3:"historyTab"};i.getTaskVaribles().collabTaskInfo.options.selectedTab=e[t]}};l.prototype.init=function(){n=new e({displayStyle:"strip",showComboBoxFlag:!0,editableFlag:!1,multiSelFlag:!1,reindexFlag:!0,centeredFlag:!1,allowUnsafeHTMLOnTabButton:!0}),o.forEach((e=>{let o=t.getTaskTabPersistency("RouteTaskTabsPage");e.id==d[o]?e.isSelected=!0:e.isSelected=!1,n.add(e)})),n.inject(this.container),c()};let c=function(){new Promise((function(e,t){let i=[];o.forEach(((e,t)=>{""!=e.loader&&(i[t]=new Promise((function(t,o){require([e.loader],(function(o){a[e.id]=o,t()}))})))})),Promise.all(i).then((()=>{e()}))})).then((function(){let e={options:{}},o=t.getTaskTabPersistency("RouteTaskTabsPage");e.options.value=o,s=void 0,a[d[0]].init(r),a[d[0]].hideView(),u(e),n.addEventListener("tabButtonClick",(function(e){u(e)})),n.addEventListener("change",(function(e){u(e)}))}),(function(){}))};return l.prototype.destroy=function(){try{s=void 0,Object.keys(a).map((e=>{a[e].destroy()})),n.destroy(),r={},this.container.destroy()}catch(e){}},l.getModel=function(e){return a[e].getModel()},l.getPropertiesModel=function(){a.properties.getModel()},l.getMembersModel=function(){a.members.getModel()},l.getCommentsModel=function(){a.comments.getModel()},l.getHistoryModel=function(){a.history.getModel()},l})),define("DS/ENORouteMgmt/Views/RouteHistory",["DS/EditPropWidget/facets/Common/FacetsBase","DS/ENORouteMgmt/Components/Wrappers/WrapperLargeTileView","DS/ENORouteMgmt/Model/RouteInfoHistoryModel","DS/ENORouteMgmt/Controller/RouteServicesController"],(function(e,t,o,i){"use strict";var n=e.extend({init:function(){widget.propWidgetHistoryOpen=!0,this._parent.apply(this,arguments);this.elements.container=UWA.createElement("div",{id:"routeHistory",class:"routeHistory"})},updateFacet:function(){let e=this.getModel();if(1==e.isMergedModel())return;if(!e)return!1;this.elements.container.setContent("");let t=e.get("objectId");i.fetchRouteHistory(t).then((function(e){o.destroy();let t=s(e),i=a(t);null!=i&&i.inject(document.querySelector(".routeHistory"))}))},destroyComponent:function(){},onResize:function(){},onRefresh:function(){this.updateFacet()}}),s=function(e){return o.getModel(e)};let a=function(e){let o=UWA.createElement("div",{id:"routeInfoHistoryContainer",class:""});return t.build(e,o)};return n})),define("DS/ENORouteMgmt/Views/Loader/InitiateRouteContentsLoader",["DS/ENORouteMgmt/Views/InitiateRouteContentsView","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";let o={};return{init:function(t){this.showView()||(o.container=new UWA.Element("div",{html:"",id:"InitiateRouteContentView",class:"route-initiate-contents-container"}),o.container.inject(document.querySelector("#iRouteTabsContainer")),e.build(o.container,t.contentIds,{scopeId:t.scopeId,scopePhyId:t.scopePhyId}))},hideView:function(){document.querySelector("#InitiateRouteContentView")&&document.querySelector("#InitiateRouteContentView").getChildren().length>0&&(document.getElementById("InitiateRouteContentView").style.display="none")},showView:function(){return!!(document.querySelector("#InitiateRouteContentView")&&document.querySelector("#InitiateRouteContentView").getChildren().length>0)&&(document.getElementById("InitiateRouteContentView").style.display="block",!0)},destroy:function(){o={},e.destroy()},getModel:function(){return e.getModel()}}})),define("DS/ENORouteMgmt/Views/Loader/RouteTasksMembersLoader",["DS/ENORouteMgmt/Views/Form/TaskProperties","DS/ENORouteMgmt/Views/Form/TaskMemberView","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";return{init:function(){if(!this.showView()){let o;!function(){let t;t=e.getTaskVaribles(),t._taskMemberProperties={},t._taskMemberProperties.elements={},t._taskMemberProperties.formBody=new UWA.Element("div",{id:"RouteTaskMemebersTabBody",class:"route-task-members-tab"}),t._taskMemberProperties.formBody.inject(document.querySelector("#RouteTaskRightPanelContainer"));let o=document.querySelector("#RouteTaskRightPanelContainer"),i=document.querySelector("#RouteTaskPropertiesFooter");o.insertBefore(t._taskMemberProperties.formBody,i)}(),o=e.getTaskVaribles(),t.build(o._taskMemberProperties.formBody,o.mode)}},hideView:function(){null!=document.getElementById("RouteImmersiveFrame")?document.querySelector("#RouteTaskCreateMemebersTabBody")&&document.querySelector("#RouteTaskCreateMemebersTabBody").getChildren().length>0&&(document.getElementById("RouteTaskCreateMemebersTabBody").style.display="none"):document.querySelector("#RouteTaskMemebersTabBody")&&document.querySelector("#RouteTaskMemebersTabBody").getChildren().length>0&&(document.getElementById("RouteTaskMemebersTabBody").style.display="none")},showView:function(){return null!=document.getElementById("RouteImmersiveFrame")?!!(document.querySelector("#RouteTaskCreateMemebersTabBody")&&document.querySelector("#RouteTaskCreateMemebersTabBody").getChildren().length>0)&&(document.getElementById("RouteTaskCreateMemebersTabBody").style.display="block",!0):!!(document.querySelector("#RouteTaskMemebersTabBody")&&document.querySelector("#RouteTaskMemebersTabBody").getChildren().length>0)&&(document.getElementById("RouteTaskMemebersTabBody").style.display="block",!0)},destroy:function(){_appInstance={}}}})),define("DS/ENORouteMgmt/Views/Loader/RouteTasksPropertiesLoader",["DS/ENORouteMgmt/Views/Form/TaskProperties","DS/ENORouteMgmt/Views/Form/RouteTaskPanelFields","DS/ENORouteMgmt/Utilities/TaskPanelSubscribeEvents","DS/ENORouteMgmt/Utilities/RouteViewUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n){"use strict";return{init:function(n){if(!this.showView()){let a,r=n.graphModel,l=n.loadFor;a=e.getTaskVaribles(),o.destroy(l,a),a._taskProperties.currentValue={},a.taskGraphModel=r,a._taskGraphModel=r.model.model,r.model.routePropertiesInfo.model?a._routeInfo=r.model.routePropertiesInfo.model:a._routeInfo=r.model.routePropertiesInfo,a.data={model:r.model.model.options.grid},"create"!=a.mode&&widget.setValue("taskIdTobePersisted",a.data.model.id);var s=a._taskProperties.formBody;if(a.taskPanelWrapper.appendChild(s),a._taskProperties.formHeader=new UWA.Element("span",{id:"InitiateTaskPropertiesHeader",class:"task-prop-header",styles:{float:"right"}}),"ENOTASK_AP"==widget.getValue("appId")){let e=document.getElementById("RouteTaskPanelTabsContainer");e.insertBefore(a._taskProperties.formHeader,e.children[0])}else a._taskProperties.formHeader.inject(a.titleSection);if(a._taskProperties.formFields=new UWA.Element("div",{id:"InitiateTaskPropertiesContainer",class:"task-prop-container"}),a._taskProperties.formFields.inject(a._taskProperties.formBody),a._taskProperties.formFooter=new UWA.Element("div",{id:"RouteTaskPropertiesFooter",class:"task-prop-footer"}),a._taskProperties.formFooter.inject(a.taskPanelWrapper),a._taskProperties.taskAssigneeField=new UWA.Element("div",{id:"SearchTaskAssigneeField",class:"fonticon-chooser-display"}),a._taskProperties.taskAssignmentScopeField=new UWA.Element("div",{id:"SearchTaskAssignmentScopeField",class:"fonticon-chooser-scope-display"}),a._taskProperties.dueDateDiv=new UWA.Element("div",{id:"dueDate",class:""}),a._taskProperties.dueDateDivOption1=new UWA.Element("div",{id:"dueDateOption1",class:"fonticon-chooser-display fit-content"}),a._taskProperties.dueDateDivOption2=new UWA.Element("div",{id:"dueDateOption2",class:"fonticon-chooser-display"}),a._taskProperties.dueDateDivOption3=new UWA.Element("div",{id:"dueDateOption3",class:"fonticon-chooser-display"}),t.renderEventsAndHeader(),t.renderTaskFields(),i.makeResponsiveCss("routeTaskPanel","#InitiateTaskPropertiesContainer"),o.subscribeToTaskEvents(a),a.taskPropertiesFields=a._taskProperties,"Inbox Task"!=a._taskGraphModel.options.grid.type&&null!=document.querySelector("#RouteTasksTabsContainer .wux-ui-3ds-comment"))document.querySelector("#RouteTasksTabsContainer .wux-ui-3ds-comment").parentElement.parentElement.setStyle("display","none");else{null!=document.querySelector("#RouteTasksTabsContainer .wux-ui-3ds-comment")&&document.querySelector("#RouteTasksTabsContainer .wux-ui-3ds-comment").parentElement.parentElement.setStyle("display","")}}},hideView:function(){document.querySelector("#RouteTaskPropertiesBody")&&document.querySelector("#RouteTaskPropertiesBody").getChildren().length>0&&(document.getElementById("RouteTaskPropertiesBody").style.display="none")},showView:function(){return!!(document.querySelector("#RouteTaskPropertiesBody")&&document.querySelector("#RouteTaskPropertiesBody").getChildren().length>0)&&(document.getElementById("RouteTaskPropertiesBody").style.display="block",!0)},destroy:function(){}}})),define("DS/ENORouteMgmt/Views/Loader/InitiateRouteTasksLoader",["DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphEditView","DS/ENORouteMgmt/Model/InitiateRouteTaskModel","DS/ENORouteMgmt/Views/Panels/CreateTaskRightPanelSplitView","DS/Windows/ImmersiveFrame","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n){"use strict";let s,a={};return{init:function(t){if(!this.showView()){!function(){a.container=new UWA.Element("div",{html:"",id:"CreateTaskContainer",class:"create-task-graph-container"}),a.container.inject(document.querySelector("#iRouteTabsContainer")),a.graphContainer=new UWA.Element("div",{html:"",id:"CreateTaskContainerGraph",class:""}).inject(a.container);let e=(new o).getSplitView(widget.routeMgmtMediator.getEventBroker());(new o).setSplitviewEvents(e),e.getLeftViewWrapper().appendChild(a.graphContainer),s=(new o).getTokens();let t=new i;t.setContentInBackgroundLayer(e.getContent()),t.reactToPointerEventsFlag=!1,t.inject(a.container)}(),e.build(a.graphContainer);let n="create";e.initTaskGraphView(t,n)}},hideView:function(){document.querySelector("#CreateTaskContainer")&&document.querySelector("#CreateTaskContainer").getChildren().length>0&&(document.getElementById("CreateTaskContainer").style.display="none")},showView:function(){return!!(document.querySelector("#CreateTaskContainer")&&document.querySelector("#CreateTaskContainer").getChildren().length>0)&&(document.getElementById("CreateTaskContainer").style.display="block",!0)},destroy:function(){a={},t.destroy(!0),s&&s.open&&widget.routeMgmtMediator.unsubscribe(s.open),s&&s.close&&widget.routeMgmtMediator.unsubscribe(s.close);try{e.destroy()}catch(e){}},getModel:function(){return t.getTasksDataForCreation()}}})),define("DS/ENORouteMgmt/Views/ToggleViews",["DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView","DS/ENORouteMgmt/Views/Grid/RouteContentsDataGridView","DS/ENORouteMgmt/Views/Grid/RouteMembersDataGridView","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i){"use strict";let n,s,a;return{doToggleView:function(r){switch(r.curPage){case"RouteSummary":n=".data-grid-container",s=".tile-view-container",a=e.getGridViewToolbar().getNodeModelByID("view");break;case"ContentsTab":n=".Contents-gridView-View",s=".Contents-tileView-View",a=t.getGridViewToolbar().getNodeModelByID("view");break;case"MembersTab":n=".Members-gridView-View",s=".Members-tileView-View",a=o.getGridViewToolbar().getNodeModelByID("view");break;default:Console.log("Incorrect arguments in config file.")}if("GridView"!==r.view&&"RouteSummary"===r.curPage&&0===e.getDataGridInstance().getModel().getRowModelLength()&&e.getDataGridInstance().getModel().getFilterViewManager().filterManager.isDataFiltered())widget.notify.handler().addNotif({level:"warning",subtitle:i.tileViewWarningDetails,sticky:!1});else if("GridView"!==r.view&&"ContentsTab"===r.curPage&&0===t.getDataGridInstance().getModel().getRowModelLength()&&t.getDataGridInstance().getModel().getFilterViewManager().filterManager.isDataFiltered())widget.notify.handler().addNotif({level:"warning",subtitle:i.tileViewContentWarningDetails,sticky:!1});else{if(widget.setValue(r.curPage+"-ShowView",r.view),"GridView"==r.view)a.options.grid.data.menu[1].state="selected",a.options.grid.data.menu[0].state="unselected",a&&"view-list"!=a.options.grid.semantics.icon.iconName&&a.updateOptions({grid:{semantics:{icon:{iconName:"view-list"}}}}),(l=document.querySelector(n))&&(l.removeClassName("hideView"),l.removeClassName("nonVisible"),l.addClassName("showView")),(d=document.querySelector(s))&&(d.removeClassName("showView"),d.addClassName("hideView"));else if("TileView"==r.view){var l,d;a.options.grid.data.menu[1].state="unselected",a.options.grid.data.menu[0].state="selected",a&&"view-small-tile"!=a.options.grid.semantics.icon.iconName&&a.updateOptions({grid:{semantics:{icon:{iconName:"view-small-tile"}}}}),(l=document.querySelector(n))&&(l.removeClassName("showView"),l.addClassName("hideView")),(d=document.querySelector(s))&&(d.removeClassName("hideView"),d.addClassName("showView"),setTimeout((function(){let e=document.getElementsByClassName("wux-layouts-gridengine-poolcontainer-rel")[1].offsetHeight,t=document.getElementsByClassName("Route-tile-blank-space")[0];t&&(t.style.height=`calc(100% - ${e}px)`)}),500))}}}}})),define("DS/ENORouteMgmt/Views/Loader/TaskGraphicalViewLoader",["UWA/Drivers/Alone","DS/ENORouteMgmt/Views/RouteTasksView","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphView","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Model/RouteTaskModel","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils","DS/Controls/Loader","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/egraph/views.css","css!DS/etree/syncviews.css","css!DS/etree/overviewui.css"],(function(e,t,o,i,n,s,a,r,l){"use strict";let d,u;return{init:function(i,n){if(!this.showView()){d={},n?d.container=n:(d.container=e.createElement("div",{id:"routeGraphTaskContainer",class:"route-graph-task-container"}),d.container.inject(document.querySelector(".route-facets-container")));var a=this;return a.showProgressBar(),new Promise((function(e,n){s.fetchRouteTasks(i.model.id).then((function(n){let s={id:i.model.id,scopeId:""==i.model.Scope[0]?""==i.model.Scope[1]?i.model.Scope[2]:i.model.Scope[1]:i.model.Scope[0],routeBasePurpose:i.model.BasePurpose,chooseUserFromGroup:i.model.chooseUserFromGroup,model:i.model};i&&"Route Template"==i.model.Type&&(n.parentObjectType="Route Template"),a.updateModels(n,s),t.destroyContainer(),t.build(s,d.container),o.destroy(),o.build(d.container),o.initTaskGraphView(s,"view"),e()}))})).then((()=>{a.hideProgressBar(),o.fitToWindowDefaultLoad()}))}},updateModels:function(e,t){t.model&&(e=a.updateTaskEditSettings(e,t.model.taskEditSetting)),i.destroy();let o=i.getModel(e);o.options.routeId=t.id,o.options.routeInfoJSON=t,o.options.responseLength=e.length,n.destroy(),n.createModel(t),n.getModel().RouteId=t.id},hideView:function(){null!=document.getElementById("routeGraphTaskContainer")&&(document.getElementById("routeGraphTaskContainer").style.display="none")},showView:function(){return null!=document.getElementById("routeGraphTaskContainer")&&(document.getElementById("routeGraphTaskContainer").style.display="block",!0)},showProgressBar:function(){var e=document.getElementById("routeGraphTaskContainer");null!=e&&(u=(new r).inject(e)),u.elements.container.setStyle("margin-top","10%"),u.elements.container.setStyle("margin-left","40%"),u.on(l.loading_label)},hideProgressBar:function(){u&&u.off(l.loading_label)},destroy:function(){d={}}}})),define("DS/ENORouteMgmt/ENORoutesWidgetInit",["UWA/Class","UWA/Class/Promise","UWA/Core","DS/ENORouteMgmt/Components/Mediator","DS/ENORouteMgmt/Components/Notifications","DS/ENORouteMgmt/Views/RouteHomeSplitView","DS/Windows/ImmersiveFrame","DS/ENORouteMgmt/Utilities/RouteWidgetUtil","DS/ENORouteMgmt/Views/RouteSummaryView","DS/ENORouteMgmt/Components/Wrappers/TriptychWrapper","DS/ENORouteMgmt/Views/Panels/WelcomePanel","DS/ENORouteMgmt/Components/RouteApplicationFrame","DS/ENORouteMgmt/Utilities/Utils","DS/ENORouteMgmt/Utilities/RouteLinkWidgetUtil","DS/ENORouteMgmt/Model/RouteModel","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g){"use strict";var f=null;return e.extend({name:"RouteManagement",onLoad:function(e){var t=this;widget.notify=new n,widget.routeMgmtMediator=new i,r.init().then((function(e){return t._initializeComponent({})})),m.init()},onRefresh:function(){var e=this;return new t((function(e,t){l.destroy(),null!=f&&f.destroy(),!0===widget.getValue("isDialogOpened")?widget.routeMgmtMediator.destroyAllButDialogEvents():(widget.routeMgmtMediator.destroy(),widget.routeMgmtMediator=new i),r.registerWidgetTitleEvents(),r.getTaskCustomFields(),widget.setValue("linkedContextTitle",void 0),widget.setValue("isWidgetRefreshed","true"),e()})).then((function(){return e._initializeComponent({})}))},onEdit:function(e){r.onEdit(e)},endEdit:function(e){r.endEdit(e)},_initializeComponent:function(e){var i,n=null,r={};let l="DS/ENORouteMgmt/Views/RouteSummaryView";return r.id="routes",("Route Template"==widget.data.contentType||"route_templates"===widget.getValue("HomePage"))&&(l="DS/ENORouteTemplateMgmt/Views/TemplateSummaryView",r.id="route_templates"),new t((function(e){require(["UWA/Core",l],(function(t,o){i=o,o.build().then((function(t){n=t,e()}))}))})).then((function(){return new t((function(e,t){let l=(new s).getSplitView(widget.routeMgmtMediator.getEventBroker());(new s).setSplitviewEvents(l),l.getLeftViewWrapper().appendChild(n),f=new a;let d=o.createElement("div",{id:"routes-main-div",styles:{height:"100%"}}),u=o.createElement("div",{id:"routes-wc-panel",styles:{height:"100%"}}).inject(d),m=o.createElement("div",{id:"routes-right-panel",styles:{height:"100%"}}),h=new c;h.init(widget.routeMgmtMediator.getEventBroker(),null,d,u,l.getContent(),m),h.setTooltipForExpandCollapse(),f.setContentInBackgroundLayer(d),f.reactToPointerEventsFlag=!1,f.inject(widget.body);document.getElementsByClassName("toolbar-container")[0].getDimensions().height;if(document.getElementsByClassName("widget-container")[0].getChildren()[0].setStyle("top","50px"),h.showWelcomePanel(),i.openSelected(),widget.getValue("propWidgetOpen")&&(i.activateInfoIcon(),null==widget.getValue("routeIdToBePersisted")&&null==widget.getValue("templateIdToBePersisted")))if(null!=widget.getValue("right-panel-peristed-id")){let e,t=widget.getValue("right-panel-peristed-id");if("Route"==t.type)e=g.getRowModelById(t.id),e&&e.select(!0);else if("Route Template"==t.type){require(["DS/ENORouteTemplateMgmt/Model/RouteTemplateModel"],(function(o){e=o.getRowModelById(t.id),e&&e.select(!0)}))}}else{let e="Routes";"route_templates"==r.id&&(e="Route Template"),p.refreshRightPanel(e)}widget.routeMgmtMediator.publish("route-welcome-panel-activity-selection",{id:r.id}),e()})).then((()=>{var e=document.querySelector("#dataGridDivToolbar .wux-controls-lineeditor .wux-controls-lineeditor-clearbutton");if(e){e.addEventListener("click",(function(){if(null!=widget.data.contextTitle&&""!=widget.data.contextTitle){widget.data.contextTitle="";widget.routeMgmtMediator.publish("welcome-panel-action-selected",{id:"routes"})}})),e.addEventListener("touchend",(function(){if(null!=widget.data.contextTitle&&""!=widget.data.contextTitle){widget.data.contextTitle="";widget.routeMgmtMediator.publish("welcome-panel-action-selected",{id:"routes"})}}));var t=document.querySelector("#dataGridDivToolbar .wux-controls-lineeditor.wux-controls-lineeditor-width > input.wux-ui-state-undefined");t.addEventListener("change",(function(){if(""==t.value){if(null!=widget.data.contextTitle&&""!=widget.data.contextTitle){widget.data.contextTitle="";widget.routeMgmtMediator.publish("welcome-panel-action-selected",{id:"routes"})}}else t.value=widget.data.contextTitle}))}(widget.getValue("routefilters").indexOf("filterbyobject")>-1||null!=widget.data.linkedContextTitle)&&widget.routeMgmtMediator.publish("load-filterbyobject-search")}))}))}})})),define("DS/ENORouteMgmt/Utilities/PlaceHolder",["DS/Controls/Button","DS/ENORouteMgmt/Views/Dialogs/InitiateRouteDialog","DS/ENORouteMgmt/Actions/ContentActions","DS/ENORouteMgmt/Views/Loader/InitiateRouteAddContentSearchLoader","DS/ENORouteMgmt/Utilities/PlaceHolderDragAndDrop","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s){"use strict";let a=function(e,o){let i=e.getElement(".no-routes-to-show-container");if(e.querySelector(".tile-view-container").setStyle("display","none"),e.querySelector(".data-grid-container").setStyle("display","none"),null!==i)return widget.routeMgmtMediator.publish("route-back-to-summary"),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:o}),i;var a=UWA.createElement("span",{class:"no-routes-to-show-filter-shortcut fonticon fonticon-list-filter",title:s.filter}),l=UWA.createElement("span",{class:"no-routes-to-show-create-shortcut fonticon fonticon-plus",title:s.newRoute}),d=UWA.createElement("div",{class:"no-routes-to-show-container",html:[UWA.createElement("div",{class:"no-routes-to-show",html:[UWA.createElement("div",{class:"pin",html:'<span class="fonticon fonticon-5x fonticon-route"></span>'}),UWA.createElement("span",{class:"no-routes-to-show-label",html:s.titles.placeholder.label}),UWA.createElement("div",{class:"no-routes-to-show-sub-container",html:UWA.createElement("span",{html:s.replace(s.titles.placeholder.sub,{filter:a.outerHTML,create:l.outerHTML})})})]})]});n.makeDroppable(d,r),d.getElement(".no-routes-to-show-filter-shortcut").addEventListener("click",(function(){document.querySelector(".widget-container").getElementsByClassName("wux-button-icon-fi wux-ui-genereatedicon-fi wux-ui-3ds wux-ui-3ds-list-filter wux-ui-3ds-lg")[0].click()})),d.getElement(".no-routes-to-show-create-shortcut").addEventListener("click",(function(){t.InitiateRouteDialog()})),e.appendChild(d),widget.routeMgmtMediator.publish("route-back-to-summary"),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:o})},r=function(e,t){require(["DS/ENORouteMgmt/Utilities/DragAndDropManager"],(function(t){t._onRoutesummaryDropManager(e)}))},l=function(e){let t=e.getElement(".no-routes-to-show-container");null!==t&&(e.querySelector(".tile-view-container").removeAttribute("style"),e.querySelector(".data-grid-container").removeAttribute("style"),t.destroy())},d=function(t,i){let n=t.getElement(".no-contents-to-show-container");if(t.querySelector(".Contents-tileView-View").setStyle("display","none"),t.querySelector(".Contents-gridView-View").setStyle("display","none"),null!==n)return t.querySelector(".no-contents-to-show-container").removeAttribute("style"),n;let a="";a=i?UWA.createElement("div",{class:"no-contents-to-show-container",html:[UWA.createElement("div",{class:"no-contents-to-show",html:[UWA.createElement("span",{class:"no-contents-to-show-label",html:s.emptyiRouteContentsLabelwithoutButton})]})]}):UWA.createElement("div",{class:"no-contents-to-show-container",html:[UWA.createElement("div",{class:"no-contents-to-show",html:[UWA.createElement("span",{class:"no-contents-to-show-label",html:s.emptyiRouteContentsLabel}),UWA.createElement("div",{class:"no-contents-to-show-sub-container",html:new e({disabled:!1,emphasize:"primary",label:s.addExistingContent,allowUnsafeHTMLLabel:!0,onClick:function(e){o.onSearchClick()}})})]})]}),t.appendChild(a)},u=function(e){null!==e.getElement(".no-contents-to-show-container")&&(e.querySelector(".Contents-tileView-View").removeAttribute("style"),e.querySelector(".Contents-gridView-View").removeAttribute("style"),e.querySelector(".no-contents-to-show-container").setStyle("display","none"))},c=function(t){let o=t.getElement(".no-icontents-to-show-container");if(t.querySelector(".iContents-gridView-View").setStyle("display","none"),null!==o)return t.querySelector(".no-icontents-to-show-container").removeAttribute("style"),o;let n=UWA.createElement("div",{class:"no-icontents-to-show-container",html:[UWA.createElement("div",{class:"no-icontents-to-show",html:[UWA.createElement("span",{class:"no-icontents-to-show-label",html:s.emptyiRouteContentsLabel}),UWA.createElement("div",{class:"no-icontents-to-show-sub-container",html:new e({disabled:!1,emphasize:"primary",label:s.addExistingContent,allowUnsafeHTMLLabel:!0,onClick:function(e){i.onSearchClick()}})})]})]});t.appendChild(n)},p=function(e){if(null===e)return;null!==e.getElement(".no-icontents-to-show-container")&&(e.querySelector(".iContents-gridView-View").removeAttribute("style"),e.querySelector(".no-icontents-to-show-container").setStyle("display","none"))},m=function(e){let t=e.querySelector(".generic-error-container");if(e.querySelector(".tile-view-container")&&e.querySelector(".tile-view-container").setStyle("display","none"),e.querySelector(".data-grid-container")&&e.querySelector(".data-grid-container").setStyle("display","none"),e.querySelector("#dataGridDivToolbar")&&e.querySelector("#dataGridDivToolbar").setStyle("display","none"),e.querySelector("#TemplatedataGridDivToolbar")&&e.querySelector("#TemplatedataGridDivToolbar").setStyle("display","none"),e.querySelector("#TemplatedataGridDivToolbar")&&e.querySelector("#TemplatedataGridDivToolbar").setStyle("display","none"),null===t){var o=UWA.createElement("div",{class:"generic-error-container",html:[UWA.createElement("div",{class:"generic-error",html:[UWA.createElement("span",{class:"generic-error-label",html:s.loading})]})]});e.appendChild(o)}else t.removeAttribute("style")};return{hideEmptyRoutePlaceholder:e=>l(e),showEmptyRoutePlaceholder:(e,t)=>a(e,t),hideEmptyContentPlaceholder:e=>u(e),showEmptyContentPlaceholder:(e,t)=>d(e,t),hideEmptyTasksPlaceholder:(e,t)=>function(e,t){let o=e.getElement(".no-tasks-to-show-container");if(null!==o){if(e.querySelector(".canvas").removeAttribute("style"),"createMode"!=t&&e.querySelector(".Tasks-gridView-View")){let t=e.querySelector(".Tasks-gridView-View");t.className.contains("showView")&&(t.addClassName("task-grid-container-edit-mode"),widget.routeMgmtMediator.publish("show-plus-icon-in-tasks-toolbar"),widget.routeMgmtMediator.publish("show-remove-icon-in-tasks-toolbar")),t.removeAttribute("style")}e.querySelector("#task-graph-toolbar")&&e.querySelector("#task-graph-toolbar").removeAttribute("style"),o.destroy(),"EditMode"==t&&e.setStyle("position","")}}(e,t),showEmptyTasksPlaceholder:(t,o)=>function(t,o){let i=t.getElement(".no-tasks-to-show-container");if("EditMode"==o&&t.setStyle("position","absolute"),t.querySelector(".canvas").setStyle("display","none"),"createMode"!=o&&t.querySelector(".Tasks-gridView-View")&&(t.querySelector(".Tasks-gridView-View").setStyle("display","none"),t.querySelector(".Tasks-gridView-View").removeClassName("task-grid-container-edit-mode")),t.querySelector("#task-graph-toolbar")&&t.querySelector("#task-graph-toolbar").setStyle("display","none"),null!==i)return i;let n=UWA.createElement("div",{class:"no-tasks-to-show-container "+o,html:[UWA.createElement("div",{class:"no-tasks-to-show",html:[UWA.createElement("span",{class:"no-tasks-to-show-label",html:s.emptyTaskLabel}),UWA.createElement("div",{class:"no-tasks-to-show-sub-container",html:new e({disabled:!1,emphasize:"primary",label:s.addTask,allowUnsafeHTMLLabel:!0,onClick:function(e){"createMode"==o?widget.routeMgmtMediator.publish("redraw-graph-create",{graphMode:o}):"EditMode"==o&&(widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:"view"}),widget.routeMgmtMediator.publish("redraw-graph-edit",{graphMode:o}))}})})]})]});t.appendChild(n)}(t,o),showEmptyInitiateRouteContentPlaceholder:e=>c(e),hideEmptyInitiateRouteContentPlaceholder:e=>p(e),showEmptyAppliesPlaceholder:(t,o)=>function(t,o){let i=t.getElement(".no-applies-to-show-container");if(null!==i)return t.querySelector(".no-applies-to-show-container").removeAttribute("style"),i;let n="";o?n=UWA.createElement("div",{class:"no-applies-to-show-container",html:[UWA.createElement("div",{class:"no-applies-to-show",html:[UWA.createElement("span",{class:"no-applies-to-show-label",html:"No applies to attached."})]})]}):(widget.routeMgmtMediator.publish("disable-edit-icon-in-AppliesTo-tab"),n=UWA.createElement("div",{class:"no-applies-to-show-container",html:[UWA.createElement("div",{class:"no-applies-to-show",html:[UWA.createElement("span",{class:"no-applies-to-show-label",html:"No applies to attached."}),UWA.createElement("div",{class:"no-applies-to-show-sub-container",html:new e({disabled:!1,emphasize:"primary",label:"Add applies to",allowUnsafeHTMLLabel:!0,onClick:function(e){widget.routeMgmtMediator.publish("redraw-AppliesTo-edit")}})})]})]})),t.appendChild(n)}(t,o),hideEmptyAppliesPlaceholder:()=>function(){let e=document.querySelector(".no-applies-to-show-container");null!=e&&e.destroy();let t=document.querySelector(".wux-controls-abstract.wux-layouts-form");null!=t&&t.destroy(),widget.routeMgmtMediator.publish("enable-edit-icon-in-AppliesTo-tab")}(),showeErrorPlaceholder:e=>m(e),hideeErrorPlaceholder:e=>function(e){let t=e.getElement(".generic-error-container");null!==t&&t.setStyle("display","none")}(e),registerListeners:()=>(widget.routeMgmtMediator.subscribe("show-no-route-placeholder",(function(e){a(document.querySelector(".widget-container"),e)})),widget.routeMgmtMediator.subscribe("hide-no-route-placeholder",(function(e){l(document.querySelector(".widget-container"))})),widget.routeMgmtMediator.subscribe("hide-no-content-placeholder",(function(e){u(document.querySelector(".route-contents-container"))})),widget.routeMgmtMediator.subscribe("show-no-content-placeholder",(function(e){d(document.querySelector(".route-contents-container"))})),widget.routeMgmtMediator.subscribe("hide-no-iRoutecontent-placeholder",(function(e){p(document.querySelector(".dataGrid-button-container"))})),widget.routeMgmtMediator.subscribe("show-no-iRoutecontent-placeholder",(function(e){c(document.querySelector(".dataGrid-button-container"))})),void widget.routeMgmtMediator.subscribe("show-generic-error-placeholder",(function(e){m(document.querySelector(".widget-container"))})))}})),define("DS/ENORouteMgmt/Model/InitiateRouteContentModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils","DS/ENORouteMgmt/Utilities/RouteViewUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r){"use strict";let l=new e,d=function(e){let t;return t="TRUE"==e.isLatestRevision||"true"==e.isLatestRevision?UWA.createElement("div",{class:"isLastRevisionTrue wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check",title:r.latestRevision}):"FALSE"==e.isLatestRevision||"false"==e.isLatestRevision?UWA.createElement("div",{class:"isLastRevisionFalse wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-wrong",title:r.notLatestRevision}):UWA.createElement("div",{class:" "}),t},u=function(e){return new t({label:e.title,id:e.id,width:300,dataIndex:"tree",grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,Creation_Date:e.created,Modified_Date:e.modified,Owner:e.owner,ownerName:e.ownerName,current:e.current,RouteBaseState:e.RouteBaseState,RouteBaseState_NLS:e.RouteBaseState_NLS,maturityBlockingStates:e.maturityBlockingStates,maturityTargetStates:e.maturityTargetStates,Locked:a.getLockColumn(e).outerHTML,LockedBy:e.reservedBy,reservedByUserName:e.reservedByUserName,RouteTargetState:e.RouteTargetState,RouteTargetState_NLS:e.RouteTargetState_NLS,BlockingMaturityMenu:o.getMaturityMenuForGrid(e,"InitiateRoute"),TargetMaturityMenu:s.getTargetMenuForGrid(e,"InitiateRoute"),routeTask:null!=e.routeTask?e.routeTask:r.allTasks,isLatestRevision:d(e).outerHTML,associatedto:null!=e.associatedto?e.associatedto:"Route"},icons:[e.type_icon_url]})},c=function(e){return new t({label:e.title,id:e.id,width:300,dataIndex:"tree",grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,Creation_Date:e.created,Modified_Date:e.modified,Owner:e.owner,ownerName:e.ownerName,current:e.current,RouteBaseState:e.RouteBaseState,RouteBaseState_NLS:e.RouteBaseState_NLS,maturityBlockingStates:e.maturityBlockingStates,maturityTargetStates:e.maturityTargetStates,Locked:a.getLockColumn(e).outerHTML,LockedBy:e.reservedBy,reservedByUserName:e.reservedByUserName,RouteTargetState:e.RouteTargetState,RouteTargetState_NLS:e.RouteTargetState_NLS,BlockingMaturityMenu:o.getMaturityMenuForGrid(e,"InitiateRoute"),TargetMaturityMenu:s.getTargetMenuForGrid(e,"InitiateRoute"),routeTask:null!=e.routeTask?e.routeTask:r.allTasks,isLatestRevision:d(e).outerHTML,associatedto:null!=e.associatedto?e.associatedto:"Route"},icons:[e.typeicon]})},p=function(){if(null!=l){for(var e=l.getChildren(),t=[],o=0;o<e.length;o++)t.push(e[o]._options.grid.id);return t}},m=function(e){return n.getRowModelById(l,e)},g=function(){widget.routeMgmtMediator.publish("task-associated-content-update")},f=function(e,t){l.prepareUpdate(),m(t).updateOptions({grid:{routeTask:e}}),l.pushUpdate()},h=function(){l.subscribe({event:"filter"},(function(){setTimeout((function(){l.__visibilityMap__&&l.__visibilityMap__.forEach(((e,t)=>{!1===e&&t.unselect()}))}),1e3)}))};return{createModel:e=>function(e){return l.prepareUpdate(),e&&e.forEach((function(e){var i=new t({label:e.name,width:300,dataIndex:"tree",grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,Creation_Date:e.created,Modified_Date:e.modified,Owner:e.owner,ownerName:e.ownerName,current:e.current,maturityBlockingStates:e.stateNLS,maturityTargetStates:e.maturityTargetStates,Locked:a.getLockColumn(e).outerHTML,LockedBy:e.reservedBy,reservedByUserName:e.reservedByUserName,RouteBaseState:e.RouteBaseState,RouteBaseState_NLS:e.RouteBaseState_NLS,RouteTargetState:e.RouteTargetState,RouteTargetState_NLS:e.RouteTargetState_NLS,BlockingMaturityMenu:o.getMaturityMenuForGrid(e,"InitiateRoute"),TargetMaturityMenu:s.getTargetMenuForGrid(e,"InitiateRoute"),routeTask:null!=e.routeTask?e.routeTask:r.allTasks,isLatestRevision:d(e).outerHTML,associatedto:"Route"},icons:[e.type_icon_url]});i.options.getAttributeValueForFiltering=function(t){switch(t){case"label":return e.title;case"Type":return e.type;case"isLatestRevision":return e.isLatestRevision;case"Maturity":return e.stateNLS;case"BlockingMaturityMenu":return e.RouteBaseState_NLS;case"TargetMaturityMenu":return e.RouteBaseState_NLS==r.stateBlockNone?e.RouteBaseState_NLS:e.RouteTargetState_NLS;case"Owner":return e.owner;case"routeTask":return e.routeTask;default:return e[t]}},l.addRoot(i)})),l.setFilterModel({label:{filterId:"stringRegexp"},Type:{filterId:"set"},isLatestRevision:{filterId:"set"},Maturity:{filterId:"set"},BlockingMaturityMenu:{filterId:"set"},TargetMaturityMenu:{filterId:"set"},Owner:{filterId:"set"},routeTask:{filterId:"set"}}),l.pushUpdate(),e&&g(),h(),l}(e),getModel:()=>l,appendRow:(e,t,o)=>function(e,t,o){var i=[];l.prepareUpdate(),e.forEach((function(e){let n;null==e.associatedto&&(e.associatedto=null==o?"Route":o),n=t?c(e):u(e);var s=e.id+"~"+e.title;i.push(s),n.options.getAttributeValueForFiltering=function(t){switch(t){case"label":return e.title;case"Type":return e.type;case"isLatestRevision":return e.isLatestRevision;case"Maturity":return e.stateNLS;case"BlockingMaturityMenu":return e.RouteBaseState_NLS;case"TargetMaturityMenu":return e.RouteBaseState_NLS==r.stateBlockNone?e.RouteBaseState_NLS:e.RouteTargetState_NLS;case"Owner":return e.owner;case"routeTask":return n.options.grid.routeTask;default:return e[t]}},l.addRoot(n)})),l.pushUpdate(),0!=l.getChildren().length&&widget.routeMgmtMediator.publish("hide-no-iRoutecontent-placeholder"),g()}(e,t,o),getContentIDs:()=>p(),getRouteContentIds:()=>function(){var e=[];if(null!=l)for(var t=l.getChildren(),o=0;o<t.length;o++)"Route"==t[o]._options.grid.associatedto&&e.push(t[o]._options.grid.id);return e}(),deleteSelectedRows:()=>function(){var e=l.getSelectedNodes(),t=[];l.prepareUpdate();for(var o=0;o<e.length;o++)l.removeRoot(e[o]),t.push(e[o].options.id);l.pushUpdate(),0==l.getChildren().length&&widget.routeMgmtMediator.publish("show-no-iRoutecontent-placeholder");var i=p();widget.routeMgmtMediator.publish("clearContentToReview-on-ContentRemoval",i),g()}(),deleteAllRows:()=>function(){l.prepareUpdate(),l.removeRoots(),l.pushUpdate(),0==l.getChildren().length&&widget.routeMgmtMediator.publish("show-no-iRoutecontent-placeholder");var e=p();widget.routeMgmtMediator.publish("clearContentToReview-on-ContentRemoval",e),g()}(),getSelectedRowsModel:()=>n.getSelectedRowsModel(l),destroy:()=>{l=new e},getRowModelById:e=>m(e),getRouteContentModel:()=>function(){if(null!=l){let o=new e;return o.prepareUpdate(),l.getChildren().forEach((function(e){if("Route"==e._options.grid.associatedto){var i=new t({label:e.options.grid.Title,width:300,dataIndex:"tree",grid:{id:e.options.id,Title:e.options.grid.Title,Name:e.options.grid.Name},icons:e.options.icons});o.addRoot(i)}})),o}}(),getRowContentByTaskId:t=>function(t){if(null!=l){let t=new e;for(var o=l.getChildren(),i=0;i<o.length;i++)"Route"==o[i]._options.grid.associatedto&&t.addRoot(root);return t}}(),updateRowModel:(e,t)=>function(e,t,o){l.prepareUpdate(),t.forEach((t=>{let i,n=m(t),s=n.options.grid.routeTask;o||(i=s==r.allTasks?e:n.options.grid.routeTask+","+e),n.updateOptions({grid:{routeTask:i}})})),l.pushUpdate()}(e,t),deleteRowModelById:e=>function(e){n.deleteRowModelById(l,e),0==l.getChildren().length&&widget.routeMgmtMediator.publish("show-no-iRoutecontent-placeholder")}(e),updateRelatedToForContents:()=>{require(["DS/ENORouteMgmt/Model/InitiateRouteTaskModel"],(function(e){var t=p();let o=[];e.getTaskTreeDocument().getAllDescendants().forEach((e=>{if(e.tileView){let t=e.options.grid;t.validTaskData&&o.push(t)}}));for(let e=0;e<t.length;e++){let i="";for(let n=0;n<o.length;n++){let s=o[n].contentToReviewFieldInfo;if(s&&s&&s.length>0)for(let a=0;a<s.length;a++){let r=s[a].id;t[e]==r&&(i=""==i?o[n].title:i+","+o[n].title)}}""!=i&&f(i,t[e])}}))},updateRelatedToTitle:(e,t)=>f(e,t)}})),define("DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Utilities/PlaceHolder","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s){"use strict";let a=new e;return{createModel:(e,o)=>function(e,o){return a.prepareUpdate(),e.forEach((function(e){var o=new t({label:e.title,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,Revision:e.revision,isLatestRevision:e.isLatestRevision,typeicon:[e.typeicon],canDeleteContent:e.canDeleteContent},thumbnail:e.image,subLabel:e.stateNLS,description:e.modified,contextualMenu:["My context menu"]});a.addRoot(o)})),a.pushUpdate(),a}(e),getModel:()=>a,getSelectedRowsModel:()=>o.getSelectedRowsModel(a),getContentIDs:()=>function(){if(null!=a){for(var e=a.getChildren(),t=[],o=0;o<e.length;o++)t.push(e[o]._options.grid.id);return t}}(),destroy:()=>{a=new e},appendRows:e=>{return o=e,a.prepareUpdate(),o.forEach((e=>{var o=new t({label:e["ds6w:label"],id:e.id,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,canDeleteContent:e.canDeleteContent},thumbnail:e.preview_url,subLabel:e["ds6w:status"],description:e["ds6w:modified"],contextualMenu:["My context menu"],icons:[e.type_icon_url]});a.addRoot(o)})),void a.pushUpdate();var o},deleteSelectedRows:()=>function(){var e=a.getSelectedNodes();a.prepareUpdate();for(var t=0;t<e.length;t++)a.removeRoot(e[t]);if(a.pushUpdate(),0==a.getChildren().length){var o=document.querySelector(".routeTaskContentToReview-gridView-View");o&&o.addClassName("hideView")}}()}})),define("DS/ENORouteMgmt/Model/TaskAttachmentModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Utilities/PlaceHolder","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s){"use strict";let a=new e,r=!1;return{createModel:(e,o)=>function(e,o){return a.prepareUpdate(),e.forEach((function(e){var o=new t({label:e.title,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Revision:e.revision,isLatestRevision:e.isLatestRevision,Type:e.type,image:e.image,typeicon:[e.typeicon],Maturity:e.stateNLS,canDeleteContent:e.canDeleteContent},thumbnail:e.image,subLabel:e.stateNLS,description:e.modified,contextualMenu:["My context menu"]});a.addRoot(o)})),a.pushUpdate(),a}(e),getModel:()=>a,getSelectedRowsModel:()=>o.getSelectedRowsModel(a),getContentIDs:()=>function(){if(null!=a){for(var e=a.getChildren(),t=[],o=0;o<e.length;o++)t.push(e[o]._options.grid.id);return t}}(),destroy:()=>{a=new e},appendRows:e=>{return o=e,a.prepareUpdate(),o.forEach((e=>{var o=new t({label:e["ds6w:label"],id:e.id,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,canDeleteContent:e.canDeleteContent},thumbnail:e.preview_url,subLabel:e["ds6w:status"],description:e["ds6w:modified"],contextualMenu:["My context menu"],icons:[e.type_icon_url]});a.addRoot(o)})),void a.pushUpdate();var o},deleteSelectedRows:()=>function(){var e=a.getSelectedNodes();a.prepareUpdate();for(var t=0;t<e.length;t++)a.removeRoot(e[t]);if(a.pushUpdate(),0==a.getChildren().length){var o=document.querySelector(".taskAttachments-gridView-View");o&&o.addClassName("hideView")}r=!0}(),getAttachmentRemovalStatus:e=>function(e){return"reset"==e&&(r=!1),r}(e)}})),define("DS/ENORouteMgmt/Views/Form/TaskViewUtil",["DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Controller/CollabTaskServicesController","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Utilities/RouteRefreshUtils","DS/ENORouteMgmt/Views/Form/FormValidation","DS/ENORouteMgmt/Views/Form/CustomFieldUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","DS/ENXESignature/Views/Dialogs/ESignatureAuthDialog","DS/DocumentManagement/DocumentManagement","DS/Windows/ImmersiveFrame","DS/ENORouteMgmt/Model/TaskAttachmentModel","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Utilities/Utils","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Model/InitiateRouteContentModel","DS/ENORouteMgmt/Controller/RouteESignServicesController","DS/ENORouteMgmt/Views/Form/TaskProperties","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","DS/Utilities/DateUtils","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h,w,v,S,k){"use strict";let T=!1,R=v.getTaskVaribles(),y={canUserEditTask:function(e){return"Complete"!=e.model.current},canUserEditAllFields:function(e){return"Inbox Task"!=e.model.type},canUserReview:function(e,t){return!(!C(e.model.taskDetails)||"Inbox Task"!=e.model.type||"Yes"!=e.model.needsOwnerReview||"Review"!=e.model.current||"Started"!=t.Route_Status)},canUserCompleteTask:function(e,t){return"Notify Only"!=e.model.taskAction&&"Assigned"==e.model.current&&"Inbox Task"==e.model.type&&"Started"==t.Route_Status&&null!=e.model.taskAssigneeUsername&&null!=i.getLoginUser()&&e.model.taskAssigneeUsername.toUpperCase()==i.getLoginUser().toUpperCase()},canLoadInViewMode:function(e,t){return"Route Template"!=t.Type&&null!=t.taskEditSetting&&"Modify/Delete Task List"!=t.taskEditSetting&&("Yes"==e.model.templateTask||"Yes"==e.model.isInitialTask&&null==t.templateTaskEditSetting)},isInboxTask:function(e){return"Inbox Task"==e.model.type},dueDateViewMode:function(e,t){var o="";if(e.model.assigneeSetDueDate&&"Yes"==e.model.assigneeSetDueDate)if(e.model.taskDueDate&&""!=e.model.taskDueDate){let t=new Date(e.model.taskDueDate);t=g.getLocaleTime(t,!0),o=t}else o=l.assigneeSetDueDate;else if(e.model.taskDueDate&&""!=e.model.taskDueDate){let t={datePrecision:"day",dateStyle:"full",timePrecision:"sec"};o=k.formatDateToString(new Date(e.model.taskDueDate),t)}else if(e.model.dueDateOffset&&""!=e.model.dueDateOffset){var i=l.dueDateTextStartsFrom;"1"==e.model.dueDateOffset&&(i=l.dueDateTextStartFrom),o=e.model.dueDateOffset+" "+i+" ",e.model.dateOffsetFrom&&"Task Create Date"==e.model.dateOffsetFrom?o+=l.dueDateFromPriorTask:o+=l.dueDateFromRouteStart}else o=t=g.getLocaleTime(t,!0);return o},expectedActionElemList:function(e,t){return"Approval"==e?[{labelItem:l.approve,valueItem:"Approve"}]:"Review"==e?[{labelItem:l.Comment,valueItem:"Comment"}]:[{labelItem:l.approve,valueItem:"Approve"},{labelItem:l.notifyOnly,valueItem:"Notify Only"},{labelItem:l.Comment,valueItem:"Comment"}]},canPerformTaskAction:function(e){for(var t=0;t<e.length;t++){if(e[t].indexOf("canPerformTaskAction")>-1)return"true"==e[t].split("~")[1]}return!1},taskReviewUpdate:function(e,i,n){var a=i.autoCompleteComponent,r=CKEDITOR.instances.ckeditorTaskReviewComment.getData().replace(/<br\s*[\/]?>/gi," ").replace(/[\n\r]/g," ").replace(/&nbsp;/g," ").replace(/\s+/g," "),d=CKEDITOR.instances.ckeditorTaskReviewComment.editable().getText();if("saveForLater"!=e.taskReviewButtonsValue){if(""==r.trim()||""==d.trim())return void widget.notify.handler().addNotif({level:"error",subtitle:l.errorTaskReviewComment,sticky:!1});e.model.taskReviewButton=i.elements.taskReviewButtons.value}e.model.reviewersComments=CKEDITOR.instances.ckeditorTaskReviewComment.getData();var u=l.successReviewTaskPromote,c=l.failReviewTask,p=l.failUpload,m=l.failAttachment;"demote"==e.model.taskReviewButton&&(u=l.successReviewTaskDemote);var g=[];let f=[],h=[],w=[];null!=a&&null!=a.selectedItems&&0!=a.selectedItems.length&&a.selectedItems.forEach((function(e){if(e.options.grid&&"upload"==e.options.grid.action)g.push(e.options.value);else{let t={};t.id=e.options.value,t.updateAction="CONNECT",f.push(t),h.push(e.options.value)}})),B(e,f,w),i.elements.taskReviewButtons.elements.container.dsModel.disabled=!0,i.elements.taskReviewButtons.actionOnClickFlag=!1,x(g,e.model.id).then((r=>{var l=r;null!=r&&0!=r.length&&r.forEach((function(e){let t={};t.id=e.data[0].id,t.updateAction="CONNECT",f.push(t)})),"saveForLater"==e.taskReviewButtonsValue?j(e,n,f,u,i,c,l,h,w):t.updateTaskAttachment(e,f).then((r=>{"ENOTASK_AP"==widget.getValue("appId")&&R.collabTaskModel.preSave&&R.collabTaskModel.preSave(),o.updateReviewComment(e,n,a).then((t=>{widget.notify.handler().addNotif({level:"success",subtitle:u,sticky:!1}),"ENOTASK_AP"==widget.getValue("appId")&&(R.collabTaskModel.set("inboxTaskModified",!1),R.collabTaskModel.postSave&&R.collabTaskModel.postSave("true")),s.refreshRouteData(n),widget.routeMgmtMediator.publish(i.closeEventName),widget.routeMgmtMediator.publish("task-action-on-save",e),f&&0!=f.length&&widget.routeMgmtMediator.publish("content-summary-update")}),(o=>{"ENOTASK_AP"==widget.getValue("appId")&&R.collabTaskModel.postSave&&R.collabTaskModel.postSave("false"),i.elements.taskReviewButtons.elements.container.dsModel.disabled=!1,i.elements.taskReviewButtons.actionOnClickFlag=!0,null!=l&&V(l),null!=h&&W(h,e.model.id),null!=w&&w.length>0&&t.updateTaskAttachment(e,w),o.error?widget.notify.handler().addNotif({level:"error",title:c,message:o.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:c,sticky:!1})}))}),(e=>{i.elements.taskReviewButtons.elements.container.dsModel.disabled=!1,i.elements.taskReviewButtons.actionOnClickFlag=!0,null!=l&&V(l),e.error?widget.notify.handler().addNotif({level:"error",title:m,message:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:m,sticky:!1})}))}),(e=>{i.elements.taskReviewButtons.elements.container.dsModel.disabled=!1,i.elements.taskReviewButtons.actionOnClickFlag=!0,e&&e.result&&V(e.result),e.error?widget.notify.handler().addNotif({level:"error",title:p,message:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:p,sticky:!1})}))},taskAccept:function(e,o,i){"ENOTASK_AP"==widget.getValue("appId")&&R.collabTaskModel.preSave&&R.collabTaskModel.preSave(),t.acceptTask(e).then((t=>{widget.notify.handler().addNotif({level:"success",message:l.acceptTaskSuccess,sticky:!1}),"ENOTASK_AP"==widget.getValue("appId")&&(R.collabTaskModel.set("inboxTaskModified",!1),R.collabTaskModel.postSave&&R.collabTaskModel.postSave("true")),s.refreshRouteData(o),m.getTaskTreeDocument().options._isTaskPanelOpened?widget.routeMgmtMediator.publish("redraw-graph",e.model):(widget.routeMgmtMediator.publish("task-action-on-save",e),widget.routeMgmtMediator.publish("route-task-on-change-assignee",e))}),(e=>{"ENOTASK_AP"==widget.getValue("appId")&&R.collabTaskModel.postSave&&R.collabTaskModel.postSave("true"),e.error?widget.notify.handler().addNotif({level:"error",message:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",message:l.acceptTaskError,sticky:!1})}))},taskActionUpdate:function(e,o,n,s){let r=v.getTaskVaribles();if(o.elements.taskApproveComments){var u=CKEDITOR.instances.ckeditorTaskComment.getData().replace(/<br\s*[\/]?>/gi," ").replace(/[\n\r]/g," ").replace(/&nbsp;/g," ").replace(/\s+/g," "),c=CKEDITOR.instances.ckeditorTaskComment.editable().getText();if("saveForLater"!=e.taskActionButtonsValue){if(""==u.trim()||""==c.trim())return void widget.notify.handler().addNotif({level:"error",subtitle:l.errorTaskComment,sticky:!1});e.model.taskActionButton=o.elements.taskActionButtons.value}e.model.comments=CKEDITOR.instances.ckeditorTaskComment.getData()}if(D(o)){if(3==o.elements.dueDateOptionSelected&&(e.model.taskDueDate=o.elements.taskActionDueDate.value),e.model.dueDateOptionSelected=o.elements.dueDateOptionSelected,a.validateCustomAttrInfo(e,o)){F(e,o);var p=l.taskSave,m=l.taskSaveError,g=l.failUpload,f=l.failAttachment;if("saveForLater"!=e.taskActionButtonsValue&&("Yes"==e.model.needsOwnerReview?(p=l.taskSentForReview,m=l.taskSentForReviewError):(p=l.taskCompleted,m=l.taskCompletedError)),"Approve"!=e.model.taskActionButton&&"Reject"!=e.model.taskActionButton&&"Abstain"!=e.model.taskActionButton||"True"!=n.requiresEsign||"saveForLater"==e.taskActionButtonsValue)T(e,n,o.autoCompleteComponent);else{var h,w;w=i.getTenantValue();var S=r.data.model.taskAssigneeUsername,k=e.model.taskActionButton;"Reject"==k&&(k="Disapprove"),h={eSignPolicyReference:"ESignConfigRoute",Username:S,x3dPlatformId:w,ObjectReference:e.model.id,ObjectActionType:k},d.init(h).subscribe("ESign-Authenticated",(function(t){console.log("ESign-Validated Success "+t.ESignRecordId);let i=t.ESignRecordId;e.model.eSignRecordId=i,T(e,n,o.autoCompleteComponent)}))}}}else o.elements.taskActionDueDate.elements.inputField.elements.inputField.focus();function T(e,i,n){var s=[];let a=[],r=[],l=[];null!=n&&null!=n.selectedItems&&0!=n.selectedItems.length&&n.selectedItems.forEach((function(e){if(e.options.grid&&"upload"==e.options.grid.action)s.push(e.options.value);else{let t={};t.id=e.options.value,t.updateAction="CONNECT",a.push(t),r.push(e.options.value)}})),B(e,a,l),o.elements.taskActionButtons&&(o.elements.taskActionButtons.elements.container.dsModel.disabled=!0,o.elements.taskActionButtons.actionOnClickFlag=!1),o.elements.save.disabled=!0,x(s,e.model.id).then((n=>{var s=n;null!=n&&0!=n.length&&n.forEach((function(e){let t={};t.id=e.data[0].id,t.updateAction="CONNECT",a.push(t)})),"saveForLater"==e.taskActionButtonsValue?L(e,i,a,p,o,m,s):t.updateTaskAttachment(e,a).then((t=>{L(e,i,a,p,o,m,s,r,l)}),(e=>{o.elements.taskActionButtons.elements.container.dsModel.disabled=!1,o.elements.taskActionButtons.actionOnClickFlag=!0,null!=s&&V(s),e.error?widget.notify.handler().addNotif({level:"error",title:f,message:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:f,sticky:!1})}))}),(e=>{o.elements.taskActionButtons&&(o.elements.taskActionButtons.elements.container.dsModel.disabled=!1,o.elements.taskActionButtons.actionOnClickFlag=!0),e&&e.result&&V(e.result),e.error?widget.notify.handler().addNotif({level:"error",title:g,message:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:g,sticky:!1})}))}},launchAssignmentScopeSearch:function(t,o,n,s){var a=t.dsModel,r=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],(function(t){var l=t.createSocket({socket_id:r}),d=e.getRefinementToSnN(r,"searchScopeAssignment",!1,["User Group"]);if("OnPremise"!=i.getTenantValue()){var u=["usersgroup"];d.source=u}else{u=["3dspace"];d.source=u}var c=e.getPrecondForRouteOwnerAssignmentScope(n);if(d.precond=c.precond,d.resourceid_in=c.resourceid_in,!UWA.is(l))throw new Error("Socket not initialized");l.dispatchEvent("RegisterContext",d),l.addListener("Selected_Objects_search",E.bind(a,o,s,n)),l.dispatchEvent("InContextSearch",d)}))},launchAssigneeSearch:(e,t,o,i)=>G(e,t,o,i),clearAssigneeFields:function(e){e.elements.assignee&&(e.elements.assignee.selectedItems=void 0),e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="none")},updateContentToReviewFieldOnContentRemoval:function(e,t){var o=[];if(null!=t&&e.contentToReviewField&&null!=e.contentToReviewField.selectedItems){for(var i=0;i<e.contentToReviewField.selectedItems.length;i++)-1!=t.indexOf(e.contentToReviewField.selectedItems[i].options.value)&&o.push(e.contentToReviewField.selectedItems[i]);e.contentToReviewField.selectedItems=o,e.contentToReviewField._applySelectedItems()}},changeHandlerForAssigneeField:function(e,t,o){var i=!1;T?T=!1:(e.elements.assignee.selectedItems&&e.elements.assignee.selectedItems.options?e.elements.assignee._editor.elements.inputField.value==e.elements.assignee.selectedItems.options.label&&("Person"==e.elements.assignee.selectedItems.options.type?t&&"Route Template"==t.Type?"True"!=t.chooseUserFromGroup&&"True"!=t.selectUsersFromUserGroup||e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="none",e.elements.chooseUsersFromUg.checkFlag=!1,null!=document.querySelector(".initiate-Task-Assignee-Field")&&document.querySelector(".initiate-Task-Assignee-Field").addClassName("disabled-field")):o.options.grid.chooseUsersFromUg&&"True"==o.options.grid.chooseUsersFromUg&&e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="none",null!=document.querySelector(".initiate-Task-Assignee-Field")&&document.querySelector(".initiate-Task-Assignee-Field").addClassName("disabled-field")):(e.elements.assignee.selectedItems.options.label.includes("(User Group)")||(e.elements.assignee.selectedItems.options.label=e.elements.assignee.selectedItems.options.label+"("+l.UserGroup+")",i=!0),t&&"Route Template"==t.Type?"True"!=t.chooseUserFromGroup&&"True"!=t.selectUsersFromUserGroup||e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="",e.elements.chooseUsersFromUg.checkFlag=!0,null!=document.querySelector(".initiate-Task-Assignee-Field.disabled-field")&&document.querySelector(".initiate-Task-Assignee-Field.disabled-field").removeClassName("disabled-field")):"True"!=t.chooseUserFromGroup&&"True"!=t.selectUsersFromUserGroup||!o.options.grid.chooseUsersFromUg||"True"==o.options.grid.chooseUsersFromUg&&e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="",null!=document.querySelector(".initiate-Task-Assignee-Field.disabled-field")&&document.querySelector(".initiate-Task-Assignee-Field.disabled-field").removeClassName("disabled-field"))),"Person"!=e.elements.assignee.selectedItems.options.type&&(e.elements.assignee.selectedItems.options.type="Group")):e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="none",null!=document.querySelector(".initiate-Task-Assignee-Field")&&document.querySelector(".initiate-Task-Assignee-Field").addClassName("disabled-field")),i&&(T=!0,e.elements.assignee._applySelectedItems()))},validationForAssigneeField:e=>z(e),updateInitiateRouteContentViewOnNodeRemoval:(e,t)=>H(e,t),taskDataSave:function(e,t,o,i,n){var s=!1;if("taskEditMode"==t&&!i.options.grid.graphNode){s=!0;let t=m.getTaskTreeDocument().getChildren();if(t)for(let o=1;o<t.length-1;o++){let n=t[o].getAllDescendants();if(n)for(let t=0;t<n.length;t++){n[t].options.grid;if(n[t]._id==i.options.graphNodeId){e={model:(i=n[t]).options.grid};break}}}}if(""==o.elements.title.value.trim())return widget.notify.handler().addNotif({level:"error",subtitle:l.errorTitle,sticky:!1}),void o.elements.title.elements.inputField.focus();if(""==o.elements.instruction.value.trim())return widget.notify.handler().addNotif({level:"error",subtitle:l.errorInstructions,sticky:!1}),void o.elements.instruction._myInput.focus();if(M(o,i,n)){if(!(null!=o.elements.assignee.selectedItems&&null!=o.elements.assignee.selectedItems.options.value||"Route Template"==n.Type&&o.elements.radioAssigneeRouteOwner.checked))return widget.notify.handler().addNotif({level:"error",subtitle:l.errorTaskAssignee,sticky:!1}),void o.elements.assignee._editor.elements.inputField.focus();if("Route Template"!=n.Type||!o.elements.radioAssigneeRouteOwner.checked||""==o.elements.assignmentScope.selectedItems||null==o.elements.assignmentScope.selectedItems||""==o.elements.assignmentScope.selectedItems.options.label||null==o.elements.assignmentScope.selectedItems.options.label||""!=o.elements.assignmentScope.selectedItems.options.value&&null!=o.elements.assignmentScope.selectedItems.options.value){if(!b(o,i,n))return o.elements.radioDueDateOption1.checked&&o.elements.radioDueDateOption1Date.elements.inputField._myInput.focus(),void(o.elements.radioDueDateOption2.checked&&o.elements.radioDueDateOption2DaysFrom.elements.inputField.focus());var r={};if(r.tasks=i,o.currentValue.order!=o.elements.order.value&&(r.orderInfo={orderUpdated:!0,oldOrder:o.currentValue.order,newOrder:o.elements.order.value}),o.elements.assignee.selectedItems&&o.elements.assignee.selectedItems.options.value&&o.currentValue.assigneeId!=o.elements.assignee.selectedItems.options.value&&(r.assignee={assigneeUpdated:!0,oldId:o.currentValue.assigneeId,newId:o.elements.assignee.selectedItems.options.value}),null==o.elements.routeTaskPriorityValue&&(o.elements.routeTaskPriorityValue="Medium"),"create"==t)I(e,o,n),widget.routeMgmtMediator.publish(o.closeEventName),widget.routeMgmtMediator.publish("task-create-on-save",r),"Route Template"==n.Type?widget.routeMgmtMediator.publish("initiate-template-toggle-dialogbuttons",{tasks:e}):(widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons",{tasks:e}),q(e));else if("taskEditMode"==t){if(I(e,o,n),!a.validateCustomAttrInfo(e,o))return;F(e,o),widget.routeMgmtMediator.publish(o.closeEventName),widget.routeMgmtMediator.publish("task-edit-on-save",r),s&&widget.routeMgmtMediator.publish("update-Route-Task-Model",r)}require(["DS/ENORouteMgmt/Model/RouteTaskModel"],(function(e){let t=e.getModel().getFilterManager();["taskOrder","label","revision","taskActionNLS"," taskActionNLS","currentNLS","awaiting_taskApprovalStatus","subRouteGridApprovalStatus","taskAssignee","comments","routeOwnerUGTitle","templateTask"].forEach((function(e){t.reapplyPropertyFilterModel(e)}))}))}else widget.notify.handler().addNotif({level:"error",subtitle:l.errorAssignmentScope,sticky:!1})}else o.elements.order.elements.inputField.focus()},enableDisableDueDateOptions:function(e,t){1==e?(t.elements.dueDateOptionSelected=1,t.elements.radioDueDateOption1Date.disabled=!1,t.elements.radioDueDateOption2DaysFrom.disabled=!0,t.elements.radioDueDateOption2ComboBox.disabled=!0,t.elements.radioDueDateOption3Text.disabled=!0):2==e?(t.elements.dueDateOptionSelected=2,t.elements.radioDueDateOption2DaysFrom.disabled=!1,t.elements.radioDueDateOption2ComboBox.disabled=!1,t.elements.radioDueDateOption1Date.disabled=!0,t.elements.radioDueDateOption3Text.disabled=!0):(t.elements.dueDateOptionSelected=3,t.elements.radioDueDateOption3Text.disabled=!1,t.elements.radioDueDateOption1Date.disabled=!0,t.elements.radioDueDateOption2DaysFrom.disabled=!0,t.elements.radioDueDateOption2ComboBox.disabled=!0)},dueDateOptionSelected:function(e){return N(e)},getApprovalStatusForTask:function(e,t){let o={};o.Route_Status=t,y.getApprovalStatusForTask1(e,o)},getApprovalStatusForTask1:function(e,t){let o,i,n;return null!=t&&(null!=t.Route_Status&&(i=t.Route_Status),null!=t.state&&(n=t.state)),null==i&&(i=e.routeStatus),"TRUE"==e.routeOwnerTask&&null!=i?"awaitingAssignment":("Inbox Task"===e.type?"Complete"===e.current?"Approve"===e.approvalStatus?o="approved":"Reject"===e.approvalStatus?o="rejected":"Abstain"===e.approvalStatus?o="abstained":"Comment"===e.taskAction?o="commented":"Notify Only"===e.taskAction?o="notificationSent":"Approve"===e.taskAction&&(o="completed"):o="Review"===e.current?"Stopped"===i?"RouteStopped":"awaitingReview":"Stopped"===i?"RouteStopped":"Comment"===e.taskAction?"awaitingComment":"awaitingApproval":"Route Node"===e.type&&"Complete"!=n&&"Draft"===e.current&&("Comment"===e.taskAction?o="tobecommented":"Notify Only"===e.taskAction?o="notificationtobesent":"Approve"===e.taskAction&&(o="tobeapproved")),o)},populateAssigneeField:function(e,t,o,i){O(e,t,o,i)},checkIsRouteOwner:function(e){return C(e)}},b=function(e,t,o){if(e.elements.radioDueDateOption1.checked){if(""==e.elements.radioDueDateOption1Date.value)return widget.notify.handler().addNotif({level:"error",subtitle:l.errorDueDate,sticky:!1}),!1;var i=new Date;if(Date.parse(e.elements.radioDueDateOption1Date.value.toGMTString())<=Date.parse(i.toGMTString()))return widget.notify.handler().addNotif({level:"error",subtitle:l.errorDueDate1,sticky:!1}),!1;for(var n=[],s=[],a=[],r=t.getTreeDocument().getChildren(),d=1;d<r.length-1;d++)for(var u=r[d].getChildren(),c=0;c<u.length;c++)u[c]._id!=t._id&&u[c].options.grid.taskDueDate&&""!=u[c].options.grid.taskDueDate&&(n.push(parseInt(u[c].options.grid.taskOrder)),s.push(u[c].options.grid.taskDueDate),a.push(u[c].options.grid.title));n.push(parseInt(e.elements.order.value)),s.push(e.elements.radioDueDateOption1Date.value),a.push(e.elements.title.value);for(var p=0;p<n.length-1;p+=1)for(var m=p+1;m<n.length;m+=1){var g=U(n[p],s[p],n[m],s[m]);if(1==g?h=l.replace(l.errorDueDateLesser,{tag1:a[p],tag2:n[p],tag3:a[m],tag4:n[m]}):2==g?h=l.replace(l.errorDueDateGreater,{tag1:a[p],tag2:n[p],tag3:a[m],tag4:n[m]}):3==g&&(h=l.errorDueDate2),0!=g)return widget.notify.handler().addNotif({level:"error",subtitle:h,sticky:!1}),!1}if(o.parentRouteTaskDueDate){var f=o.parentRouteTaskDueDate;for(m=0;m<n.length;m+=1){if(1==_(s[m],f))return h=l.replace(l.errorSubRouteTaskDueDateGreater,{tag1:a[m],tag2:n[m]}),widget.notify.handler().addNotif({level:"error",subtitle:h,sticky:!1}),!1}}}if(e.elements.radioDueDateOption2.checked){if(""==e.elements.radioDueDateOption2DaysFrom.value)return widget.notify.handler().addNotif({level:"error",subtitle:l.errorNdaysFromStart,sticky:!1}),!1;if(0==e.elements.radioDueDateOption2DaysFrom.value)return widget.notify.handler().addNotif({level:"error",subtitle:l.errorNdaysFromStart2,sticky:!1}),!1;if(e.elements.radioDueDateOption2DaysFrom.value>365)return widget.notify.handler().addNotif({level:"error",subtitle:l.errorMoreThan365,sticky:!1}),!1;if(o.parentRouteTaskDueDate){f=o.parentRouteTaskDueDate;var h,w=new Date,v=parseInt(e.elements.radioDueDateOption2DaysFrom.value),S=w.getTime()+24*v*60*60*1e3,k=new Date(S);f=o.parentRouteTaskDueDate;if(1==_(k,f))return h=l.replace(l.errorSubRouteTaskDueDateGreater,{tag1:e.elements.title.value,tag2:e.elements.order.value}),widget.notify.handler().addNotif({level:"error",subtitle:h,sticky:!1}),!1}}return!0},M=function(e,t,o){if(""==e.elements.order.value)return widget.notify.handler().addNotif({level:"error",subtitle:l.errorTaskOrder3,sticky:!1}),!1;if(parseInt(e.elements.order.value)<1){var i=l.replace(l.errorTaskOrder,{tag1:"1"});return widget.notify.handler().addNotif({level:"error",subtitle:i,sticky:!1}),e.elements.order.value="",!1}var n,s,a=isNaN(parseInt(o.currentRouteNode))?1:parseInt(o.currentRouteNode);if(parseInt(e.elements.order.value)<parseInt(a)){i=l.replace(l.errorCurrentTaskOrder,{tag1:o.currentRouteNode});return widget.notify.handler().addNotif({level:"error",subtitle:i,sticky:!1}),e.elements.order.value="",!1}for(var r=[],d=t.getTreeDocument().getChildren(),u=1;u<d.length-1;u++)for(var c=d[u].getChildren(),p=0;p<c.length;p++)c[p]._id!=t._id&&r.push(parseInt(c[p].options.grid.taskOrder));if(0==r.length&&1!=e.elements.order.value){i=l.replace(l.errorTaskOrder2,{tag1:e.elements.order.value-1,tag2:e.elements.order.value});return widget.notify.handler().addNotif({level:"error",title:l.errorTaskOrder1,subtitle:i,sticky:!1}),e.elements.order.value="",!1}r.push(parseInt(e.elements.order.value));for(var m=0;m<r.length-1;m++)for(var g=m+1;g<r.length;g++)if(r[g]<r[m]){var f=r[m];r[m]=r[g],r[g]=f}for(var h=0;h<r.length-1;h++){if(0==h&&1!=r[h]){n=1,s=r[h];break}if(r[h]!=r[h+1]&&r[h]+1!=r[h+1]){n=r[h]+1,s=r[h+1];break}}if(n>-1){var w=l.errorTaskOrder1,v=l.replace(l.errorTaskOrder2,{tag1:s-1,tag2:s});return widget.notify.handler().addNotif({level:"error",title:w,subtitle:v,sticky:!1}),e.elements.order.value="",!1}return!0},D=function(e){var t=e.elements.taskActionDueDate;if(3==e.elements.dueDateOptionSelected){if(""==t.value)return widget.notify.handler().addNotif({level:"error",subtitle:l.errorDueDate,sticky:!1}),!1;var o=new Date;if(Date.parse(t.value.toGMTString())<=Date.parse(o.toGMTString()))return widget.notify.handler().addNotif({level:"error",subtitle:l.errorDueDate3,sticky:!1}),!1}return!0},C=function(e){for(var t=0;t<e.length;t++){if(e[t].indexOf("isRouteOwner")>-1)return"true"==e[t].split("~")[1]}return!1},E=function(e,t,o,i){var n;i&&(n=new f({label:i[0]["ds6w:label"],value:i[0].id,name:i[0]["ds6w:identifier_value"]}),e.elements.assignmentScope.selectedItems=n)},A=function(e,t,o,i){var n;i&&(n=new f({label:i[0]["ds6w:label"],value:i[0].id,name:i[0]["ds6w:identifier"],type:i[0]["ds6w:type_value"]}),e.elements.assignee.selectedItems=n)},O=function(e,t,o,i){"Person"==i[0]["ds6w:type_value"]?(e.elements.assignee.value=i[0]["ds6w:label"].unescapeHTML(),o&&"Route Template"==o.Type?"True"!=o.chooseUserFromGroup&&"True"!=o.selectUsersFromUserGroup||e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="none",e.elements.chooseUsersFromUg.checkFlag=!1):t.options.grid.chooseUsersFromUg&&"True"==t.options.grid.chooseUsersFromUg&&e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="none")):(e.elements.assignee.value=i[0]["ds6w:label"].unescapeHTML()+"("+l.UserGroup+")",o&&"Route Template"==o.Type?"True"!=o.chooseUserFromGroup&&"True"!=o.selectUsersFromUserGroup||e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="",e.elements.chooseUsersFromUg.checkFlag=!0):"True"!=o.chooseUserFromGroup&&"True"!=o.selectUsersFromUserGroup||!t.options.grid.chooseUsersFromUg||"True"==t.options.grid.chooseUsersFromUg&&e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="")),e.elements.assignee.options.assigneeId=i[0].id,i[0]["ds6w:type_value"].includes("Person")?e.elements.assignee.options.assigneeType=i[0]["ds6w:type_value"].unescapeHTML():e.elements.assignee.options.assigneeType="Group",e.elements.assignee.options.taskAssigneeUsername=i[0]["ds6w:identifier_value"]},I=function(e,t,o){if(e.model.title=t.elements.title.value,e.model.taskAction=t.elements.expectedAction.value,e.model.taskOrder=t.elements.order.value,e.model.routeTaskPriority=t.elements.routeTaskPriorityValue,o&&"Route Template"==o.Type&&(e.model.routeOwnerTask=t.elements.radioAssigneeRouteOwner&&1==t.elements.radioAssigneeRouteOwner.checked?"TRUE":"FALSE",e.model.routeOwnerUGChoice=t.elements.assignmentScope.selectedItems&&t.elements.assignmentScope.selectedItems.options.value?t.elements.assignmentScope.selectedItems.options.value:"",e.model.routeOwnerUGName=t.elements.assignmentScope.selectedItems&&t.elements.assignmentScope.selectedItems.options.name?t.elements.assignmentScope.selectedItems.options.name:"",e.model.routeOwnerUGTitle=t.elements.assignmentScope.selectedItems&&t.elements.assignmentScope.selectedItems.options.label?t.elements.assignmentScope.selectedItems.options.label:"",e.model.chooseUsersFromUg=t.elements.chooseUsersFromUg&&1==t.elements.chooseUsersFromUg.checkFlag?"True":"False"),t.elements.needOwnerReview.checkFlag?e.model.needsOwnerReview="Yes":e.model.needsOwnerReview="No",e.model.instructions=t.elements.instruction.value,t.elements.assignee.selectedItems&&t.elements.assignee.selectedItems.options.label){let o=t.elements.assignee.selectedItems.options.label;if("Group"==t.elements.assignee.selectedItems.options.type&&o.contains("(")&&o.contains(")")){let e=o.lastIndexOf("(");o=o.slice(0,e)}e.model.taskAssignee=o,e.model.assigneeTitle=o}t.elements.assignee.selectedItems&&t.elements.assignee.selectedItems.options.value!=e.model.assigneeId&&(e.model.assigneeId=t.elements.assignee.selectedItems.options.value,e.model.assigneePID=t.elements.assignee.selectedItems.options.value),t.elements.assignee.selectedItems&&t.elements.assignee.selectedItems.options.type!=e.model.assigneeType&&(e.model.assigneeType=t.elements.assignee.selectedItems.options.type),t.elements.assignee.selectedItems&&t.elements.assignee.selectedItems.options.name&&(e.model.taskAssigneeUsername=t.elements.assignee.selectedItems.options.name),t.elements.allowDelegation.checkFlag?e.model.allowDelegation="TRUE":e.model.allowDelegation="FALSE",1==t.elements.dueDateOptionSelected?(e.model.taskDueDate=t.elements.radioDueDateOption1Date.value,e.model.dueDateOffset="",e.model.dateOffsetFrom="Route Start Date",e.model.assigneeSetDueDate="No"):2==t.elements.dueDateOptionSelected?(e.model.taskDueDate="",e.model.dueDateOffset=t.elements.radioDueDateOption2DaysFrom.value,e.model.dateOffsetFrom=t.elements.radioDueDateOption2ComboBox.value,e.model.assigneeSetDueDate="No"):("Inbox Task"==e.model.type&&""!=e.model.taskDueDate||(e.model.taskDueDate="",e.model.dueDateOffset="",e.model.dateOffsetFrom="Route Start Date"),e.model.assigneeSetDueDate="Yes"),null==e.model.current&&(e.model.current="Draft",e.model.stateNLS=l.Draft),o&&"Route Template"!=o.Type&&(t.contentToReviewField.selectedItems?(null!=e.model.contentToReviewFieldInfo?e.model.contentToReviewOrgFieldInfo=e.model.contentToReviewFieldInfo:e.model.contentToReviewOrgFieldInfo=[],e.model.contentToReviewFieldInfo=[],t.contentToReviewField.selectedItems.forEach((function(t){var o=t.options.grid;e.model.contentToReviewFieldInfo.push(o)}))):e.model.contentToReviewFieldInfo=[]),o&&"Route Template"!=o.Type&&t.removeContentToReview&&(e.model.removeContentToReview&&e.model.removeContentToReview.length>0?t.removeContentToReview.forEach((function(t){e.model.removeContentToReview.push(t)})):e.model.removeContentToReview=t.removeContentToReview),t.removeContentToReview=[],e.model.validTaskData=!0},N=function(e){return e.model.assigneeSetDueDate&&"Yes"==e.model.assigneeSetDueDate?3:e.model.taskDueDate&&""!=e.model.taskDueDate?1:e.model.dueDateOffset&&""!=e.model.dueDateOffset?2:1},U=function(e,t,o,i){var n=new Date(t),s=new Date(i);return""===t||""===i||e>o&&Date.parse(n.toGMTString())>=Date.parse(s.toGMTString())||e<o&&Date.parse(n.toGMTString())<=Date.parse(s.toGMTString())||e==o?0:e>o&&Date.parse(n.toGMTString())<Date.parse(s.toGMTString())?1:e<o&&Date.parse(n.toGMTString())>Date.parse(s.toGMTString())?2:3},_=function(e,t){var o;o="string"==typeof e?new Date(e):e;var i=new Date(t);return""===e||""===t?0:Date.parse(o.toGMTString())>Date.parse(i.toGMTString())?1:void 0},F=function(e,t){let o=S.getTaskCustomFields();o&&o.forEach(((o,i)=>{if("extensions"!=o.name){let i=t.elements[o.name];if(i){let t;Array.isArray(i)?(t=[],i.forEach(((e,i)=>{t.push(P(e,o))}))):t=P(i,o),e.model[o.name]=t}}}))},P=function(e,t){let o=e.value;if(Array.isArray(o)&&(o=e.value[0]),"object"==typeof o&&o.getDate)o=o.toISOString();else if(r.isDateField(t)&&o&&""!=o){o=new Date(o).toISOString()}return r.isBooleanField(t)&&(o=e.checkFlag?"TRUE":"FALSE"),o},x=function(e,t){var o=[],n=0;return new Promise((function(t,s){0==e.length&&t();for(var a=0;a<e.length;a++){var r={onFailure:function(e){e.result=o,s(e)},onComplete:function(e){n++,o.push(e),a==n&&t(o)}};r.tenant=i.getTenantValue(),r.securityContext=i.getSecurityContextValue(),r.tenantUrl=i.get3DSpaceURL();var l={fileName:e[a].name,fileInfo:{file:e[a]}};u.createDocument(l,r)}}))},V=function(e){var t=0;return new Promise((function(o,n){0==e.length&&o();for(var s=0;s<e.length;s++){var a={onFailure:function(e){n()},onComplete:function(e){t++,s==t&&o()}};a.tenant=i.getTenantValue(),a.securityContext=i.getSecurityContextValue(),a.tenantUrl=i.get3DSpaceURL(),u.deleteDocument(e[s].data[0].id,a)}}))},W=function(e,t){var o=0;return new Promise((function(n,s){0==e.length&&n();for(var a=0;a<e.length;a++){var r={onFailure:function(e){s()},onComplete:function(e){o++,a==o&&n()}};r.relInfo={parentId:t,parentRelName:"Reference Document",parentDirection:"from"},r.tenant=i.getTenantValue(),r.securityContext=i.getSecurityContextValue(),r.tenantUrl=i.get3DSpaceURL(),u.disconnectDocumentFromParent(e[a],r)}}))},L=function(e,o,i,n,a,r,l,d,u){"ENOTASK_AP"==widget.getValue("appId")&&R.collabTaskModel.preSave&&R.collabTaskModel.preSave(),t.updateComment(e,o,i).then((t=>{if(widget.notify.handler().addNotif({level:"success",subtitle:n,sticky:!1}),"ENOTASK_AP"==widget.getValue("appId")){"saveForLater"==e.taskActionButtonsValue&&(R._taskProperties.elements.taskActionButtons.elements.container.dsModel.disabled=!1,R._taskProperties.elements.taskActionButtons&&(R._taskProperties.elements.taskActionButtons.actionOnClickFlag=!0));let t=R._taskProperties.elements.save;t&&(t.disabled=!1),e&&e.model&&e.model.assigneeIdNew?R.collabTaskModel.postSave&&R.collabTaskModel.postSave("true","closePanel"):R.collabTaskModel.postSave&&R.collabTaskModel.postSave("true")}s.refreshRouteData(o),widget.routeMgmtMediator.publish(a.closeEventName),widget.routeMgmtMediator.publish("task-action-on-save",e),i&&0!=i.length&&widget.routeMgmtMediator.publish("content-summary-update")}),(o=>{if("ENOTASK_AP"==widget.getValue("appId")){"saveForLater"==e.taskActionButtonsValue&&(R._taskProperties.elements.taskActionButtons.elements.container.dsModel.disabled=!1,R._taskProperties.elements.taskActionButtons&&(R._taskProperties.elements.taskActionButtons.actionOnClickFlag=!0));let t=R._taskProperties.elements.save;t&&(t.disabled=!1),R.collabTaskModel.postSave&&R.collabTaskModel.postSave("false")}a.elements.taskActionButtons&&(a.elements.taskActionButtons.elements.container.dsModel.disabled=!1,a.elements.taskActionButtons.actionOnClickFlag=!0),null!=l&&V(l),null!=d&&W(d,e.model.id),null!=u&&u.length>0&&t.updateTaskAttachment(e,u),o.error?widget.notify.handler().addNotif({level:"error",title:r,message:o.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:r,sticky:!1})}))},j=function(e,o,i,n,a,r,d,u,c){"ENOTASK_AP"==widget.getValue("appId")&&R.collabTaskModel.preSave&&R.collabTaskModel.preSave(),t.updateReviewComment(e,o,i).then((t=>{if(widget.notify.handler().addNotif({level:"success",subtitle:l.taskSave,sticky:!1}),"ENOTASK_AP"==widget.getValue("appId")){R.collabTaskModel.set("inboxTaskModified",!1),"saveForLater"==e.taskReviewButtonsValue&&(R._taskProperties.elements.taskReviewButtons.elements.container.dsModel.disabled=!1,R._taskProperties.elements.taskReviewButtons&&(R._taskProperties.elements.taskReviewButtons.actionOnClickFlag=!0));let t=R._taskProperties.elements.save;t&&(t.disabled=!1),R.collabTaskModel.postSave&&R.collabTaskModel.postSave("true")}s.refreshRouteData(o),widget.routeMgmtMediator.publish(a.closeEventName),widget.routeMgmtMediator.publish("task-action-on-save",e),i&&0!=i.length&&widget.routeMgmtMediator.publish("content-summary-update")}),(o=>{if("ENOTASK_AP"==widget.getValue("appId")){"saveForLater"==e.taskReviewButtonsValue&&(R._taskProperties.elements.taskReviewButtons.elements.container.dsModel.disabled=!1,R._taskProperties.elements.taskReviewButtons&&(R._taskProperties.elements.taskReviewButtons.actionOnClickFlag=!0));let t=R._taskProperties.elements.save;t&&(t.disabled=!1),R.collabTaskModel.postSave&&R.collabTaskModel.postSave("false")}a.elements.taskReviewButtons.elements.container.dsModel.disabled=!1,a.elements.taskReviewButtons.actionOnClickFlag=!0,null!=d&&V(d),null!=u&&W(u,e.model.id),null!=c&&c.length>0&&t.updateTaskAttachment(e,c),o.error?widget.notify.handler().addNotif({level:"error",title:r,message:o.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:r,sticky:!1})}))},B=function(e,t,o){if(e.model.taskAttachments){let i=p.getContentIDs(),n=[];for(let t=0;t<e.model.taskAttachments.length;t++)n.push(e.model.taskAttachments[t].id);for(let e=0;e<n.length;e++)if(!i.includes(n[e])){let i={},s={};i.id=n[e],i.updateAction="DISCONNECT",t.push(i),s=JSON.parse(JSON.stringify(i)),s.updateAction="CONNECT",o.push(s)}}},G=function(t,o,n,s){if(z(n)){var a=t.dsModel,r=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],(function(t){var l=t.createSocket({socket_id:r}),d=e.getRefinementToSnN(r,"searchAssignee",!1,["Person","User Group"]);if("OnPremise"!=i.getTenantValue()){d.source=["3dspace","usersgroup"]}var u=e.getPrecondForTaskMemberSearch(n);if(d.precond=u.precond,d.resourceid_in=u.resourceid_in,!UWA.is(l))throw new Error("Socket not initialized");l.dispatchEvent("RegisterContext",d),l.addListener("Selected_Objects_search",A.bind(a,o,s,n)),l.dispatchEvent("InContextSearch",d)}))}},q=function(e){for(var t=[],i=h.getModel().getChildren(),n=[],s=[],a=0;a<i.length;a++)n.push(i[a]._options.grid.id),i[a]._options.grid.routeTask&&-1!=i[a]._options.grid.routeTask.indexOf(",")&&s.push(i[a]._options.grid.id);var r=[];if(null!=e.model.contentToReviewOrgFieldInfo&&e.model.contentToReviewOrgFieldInfo.length>0&&e.model.contentToReviewOrgFieldInfo.forEach((function(e){var t=e.id;-1==r.indexOf(t)&&r.push(t)})),e.model.contentToReviewFieldInfo){var d=[];e.model.contentToReviewFieldInfo.forEach((function(e){var o=e.id;d.push(o),-1==n.indexOf(o)&&t.push(o)}));for(var u=0;u<r.length;u++)s.indexOf(r[u])>-1?h.updateRelatedToForContents():-1==d.indexOf(r[u])&&h.deleteRowModelById(r[u]);t.length>0?o.fetchStateBlockingConditions(t).then((t=>{for(var o=!1,i=!1,n=0;n<t.length;n++){t[n].id=t[n].physicalid;let s=e.model.contentToReviewFieldInfo.find((e=>e.id==t[n].physicalid));t[n].created=s.created,t[n].modified=s.modified,t[n].name=s.name,t[n].owner=s.owner,t[n].ownerName=s.ownerName,t[n].policy=s.policy,t[n].revision=s.revision,t[n].state=s.state,t[n].stateNLS=t[n].current_NLS,t[n].title=s.title,t[n].type=s.type,t[n].type_icon_url=s.type_icon_url,t[n].associatedto="RouteTask",t[n].reserved=s.reserved,t[n].reservedBy=s.reservedBy,t[n].reservedByUserName=s.reservedByUserName,"Ad Hoc"===t[n].RouteBaseState&&(o=!0),"true"===t[n].isOnceInstantiable&&(i=!0)}o&&i?widget.notify.handler().addNotif({level:"warning",title:l.adHocErrTitle,subtitle:l.adHocErrSubTitle,message:l.adHocErrDesc,sticky:!1}):o&&widget.notify.handler().addNotif({level:"warning",subtitle:l.stateBlockingInfoMsg,sticky:!1}),h.appendRow(t,!1,"RouteTask"),h.updateRelatedToForContents()})).catch((e=>{console.log("failed "+e[0])})):h.updateRelatedToForContents()}},H=function(e,t){var o=h.getModel().getChildren(),i=[];if(e){var n=[];e.forEach((function(e){var t=e.id;n.push(t)}));for(var s=0;s<o.length;s++)if(-1!=n.indexOf(o[s]._options.grid.id)){var a=o[s]._options.grid.routeTask.split(",");if(1==a.length)i.push(o[s]._options.grid.id);else{const e=a.indexOf(t);a.splice(e,-1!==e?1:0),h.updateRelatedToTitle(a.join(),o[s]._options.grid.id)}}for(var r=0;r<i.length;r++)h.deleteRowModelById(i[r])}},z=function(t){if(null!=t.scopeId){if(!t.scopeId||""==t.scopeId)return widget.notify.handler().addNotif({level:"error",subtitle:l.ScopeSelectMessage,sticky:!1}),!1;if(t.scopeId){var o=[t.scopeId,"",""];t.Scope=o}}if(!t.Scope)return widget.notify.handler().addNotif({level:"error",subtitle:l.ScopeSelectMessage,sticky:!1}),!1;if(Array.isArray(t.Scope)&&""==t.Scope[0])return widget.notify.handler().addNotif({level:"error",subtitle:l.ScopeSelectMessage,sticky:!1}),!1;if(1==widget.getValue("isDialogOpened")){if(null==e.getOrganizationFromCredentials())return widget.notify.handler().addNotif({level:"error",subtitle:l.selectOrganizationMessage,sticky:!0}),!1}return!0};return y})),define("DS/ENORouteMgmt/Model/RouteContentModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d){"use strict";let u,c=new e,p=function(e){let t;return t="TRUE"==e.isLatestRevision||"true"==e.isLatestRevision?UWA.createElement("div",{class:"isLastRevisionTrue wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check",title:d.latestRevision}):"FALSE"==e.isLatestRevision||"false"==e.isLatestRevision?UWA.createElement("div",{class:"isLastRevisionFalse wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-wrong",title:d.notLatestRevision}):UWA.createElement("div",{class:" "}),t},m=function(e){let t="";return t+=e.typeNLS+" | "+e.revision+" | "+e.stateNLS,t},g=function(){c.subscribe({event:"filter"},(function(){setTimeout((function(){c.__visibilityMap__&&c.__visibilityMap__.forEach(((e,t)=>{!1===e&&t.unselect()}))}),1e3)}))};return{createModel:(e,o)=>function(e,o){return u=o,c.prepareUpdate(),e.forEach((function(e){var n=new t({label:e.title,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,TypeDisplay:e.typeNLS,Description:e.description,Owner:e.owner,ownerName:e.ownerName,ownerId:e.ownerId,Creation_Date:e.created,Modified_Date:e.modified,relatedToTaskTitles:e.relatedToTaskTitles,Relation:e.relation,RelationValue:e.relationValue,TypeIconLarge:e.image,relId:e.relId,policy:e.policy,current:e.current,RouteBaseState:e.RouteBaseState,RouteBaseState_NLS:e.RouteBaseState_NLS,RouteTargetState:e.RouteTargetState,RouteTargetState_NLS:e.RouteTargetState_NLS,maturityBlockingStates:e.maturityBlockingStates,Locked:r.getLockColumn(e).outerHTML,LockedBy:e.reservedBy,reservedByUserName:e.reservedByUserName,connectedTaskTitles:e.connectedaskTitles,maturityTargetStates:e.maturityTargetStates,isMaturityBlockingEditable:!i.hideMaturityBlockCondition(e,o),BlockingMaturityMenu:i.getMaturityMenuForGrid(e,"RouteContent",o),TargetMaturityMenu:a.getTargetMenuForGrid(e,"RouteContent",o),canDeleteContent:e.canDeleteContent,isLatestRevision:p(e).outerHTML,Revision:e.revision},thumbnail:e.image,subLabel:m(e),icons:[e.typeicon],description:e.modified,contextualMenu:["My context menu"]});null!=n.options.grid.relatedToTaskTitles&&0!=n.options.grid.relatedToTaskTitles.length||(n.options.grid.relatedToTaskTitles=d.allTasks),n.options.getAttributeValueForFiltering=function(t){switch(t){case"label":return e.title;case"Name":return e.name;case"TypeDisplay":return e.type;case"Revision":return e.revision;case"isLatestRevision":return e.isLatestRevision;case"Maturity":return e.stateNLS;case"BlockingMaturityMenu":return e.RouteBaseState_NLS;case"TargetMaturityMenu":return e.RouteTargetState_NLS;case"Owner":return e.owner;case"Relation":return e.relationValue;case"relatedToTaskTitles":return n.options.grid.relatedToTaskTitles;default:return e[t]}},c.addRoot(n)})),c.setFilterModel({label:{filterId:"stringRegexp"},Name:{filterId:"stringRegexp"},TypeDisplay:{filterId:"set"},Revision:{filterId:"set"},isLatestRevision:{filterId:"set"},Maturity:{filterId:"set"},BlockingMaturityMenu:{filterId:"set"},TargetMaturityMenu:{filterId:"set"},Owner:{filterId:"set"},Relation:{filterId:"set"},relatedToTaskTitles:{filterId:"set"}}),c.pushUpdate(),g(),c}(e,o),getModel:()=>c,getSelectedRowsModel:()=>o.getSelectedRowsModel(c),getContentIDs:()=>function(){if(null!=c){for(var e=c.getChildren(),t=[],o=0;o<e.length;o++)"Content to review"==e[o]._options.grid.RelationValue&&t.push(e[o]._options.grid.id);return t}}(),destroy:()=>{c=new e},appendRows:e=>{return o=e,c.prepareUpdate(),o.forEach((e=>{var n=new t({label:e.title,id:e.id,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,TypeDisplay:e.typeNLS,Description:e.description,Owner:e.owner,ownerName:e.ownerName,ownerId:e.ownerId,Creation_Date:e.created,Modified_Date:e.modified,Relation:d.contentToReview,RelationValue:"Content to review",TypeIconLarge:e.image,relId:e.relId,policy:e.policy,current:e.current,relatedToTaskTitles:e.relatedToTaskTitles,RouteBaseState:e.RouteBaseState,RouteBaseState_NLS:e.RouteBaseState_NLS,RouteTargetState:e.RouteTargetState,RouteTargetState_NLS:e.RouteTargetState_NLS,maturityBlockingStates:e.maturityBlockingStates,Locked:r.getLockColumn(e).outerHTML,LockedBy:e.reservedBy,reservedByUserName:e.reservedByUserName,maturityTargetStates:e.maturityTargetStates,connectedTaskTitles:e.connectedaskTitles,isMaturityBlockingEditable:!i.hideMaturityBlockCondition(e,u),BlockingMaturityMenu:i.getMaturityMenuForGrid(e,"RouteContent",u),TargetMaturityMenu:a.getTargetMenuForGrid(e,"RouteContent",u),canDeleteContent:e.canDeleteContent,isLatestRevision:p(o).outerHTML,Revision:e.revision},thumbnail:e.image,subLabel:m(e),description:e.modified,contextualMenu:["My context menu"],icons:[e.typeicon]});null!=n.options.grid.relatedToTaskTitles&&0!=n.options.grid.relatedToTaskTitles.length||(n.options.grid.relatedToTaskTitles=d.allTasks),n.options.getAttributeValueForFiltering=function(e){switch(e){case"label":return o[0].title;case"Name":return o[0].name;case"TypeDisplay":return o[0].type;case"Revision":return o[0].revision;case"isLatestRevision":return o[0].isLatestRevision;case"Maturity":return o[0].stateNLS;case"BlockingMaturityMenu":return o[0].RouteBaseState_NLS;case"TargetMaturityMenu":return o[0].RouteTargetState_NLS;case"Owner":return o[0].owner;case"Relation":return n.options.grid.RelationValue;case"relatedToTaskTitles":return n.options.grid.relatedToTaskTitles;default:return o[e]}},c.addRoot(n)})),c.pushUpdate(),void(0!=c.getChildren().length&&widget.routeMgmtMediator.publish("hide-no-content-placeholder"));var o},deleteRows:e=>{return t=e,(o=c.getNthRoot(t))&&(c.prepareUpdate(),c.removeRoot(o),c.pushUpdate()),void(0==c.getChildren().length&&widget.routeMgmtMediator.publish("show-no-content-placeholder"));var t,o},deleteSelectedRows:()=>function(){var e=[],t=c.getSelectedNodes();c.prepareUpdate();for(var o=0;o<t.length;o++)if("Content to review"==t[o].options.grid.RelationValue&&"true"==t[o].options.grid.canDeleteContent){c.removeRoot(t[o]);var i={id:t[o].options.grid.id};e.push(i)}c.pushUpdate(),0==c.getChildren().length&&widget.routeMgmtMediator.publish("show-no-content-placeholder"),widget.routeMgmtMediator.publish("route-content-updated",e),widget.routeMgmtMediator.publish("redraw-graph")}(),appendRowsFromDropData:e=>function(e){c.prepareUpdate(),e.forEach((e=>{let o=new t({label:e.title,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,TypeDisplay:e.typeNLS,Description:e.description,Owner:e.owner,ownerName:e.ownerName,ownerId:e.ownerId,Modified_Date:e.modified,Relation:d.contentToReview,RelationValue:"Content to review",current:e.current,relatedToTaskTitles:e.relatedToTaskTitles,RouteBaseState:e.RouteBaseState,RouteBaseState_NLS:e.RouteBaseState_NLS,maturityBlockingStates:e.maturityBlockingStates,maturityTargetStates:e.maturityTargetStates,Locked:r.getLockColumn(e).outerHTML,LockedBy:e.reservedBy,reservedByUserName:e.reservedByUserName,isMaturityBlockingEditable:!i.hideMaturityBlockCondition(e,u),BlockingMaturityMenu:i.getMaturityMenuForGrid(e,"RouteContent",u),TargetMaturityMenu:a.getTargetMenuForGrid(e,"RouteContent",u),RouteTargetState:e.RouteTargetState,RouteTargetState_NLS:e.RouteTargetState_NLS,Creation_Date:e.created,TypeIconLarge:e.image,canDeleteContent:e.canDeleteContent,relId:e.relId,policy:e.policy,isLatestRevision:p(e).outerHTML,Revision:e.revision},thumbnail:e.image,subLabel:m(e),icons:[e.typeicon],description:e.modified,contextualMenu:["My context menu"]});null!=o.options.grid.relatedToTaskTitles&&0!=o.options.grid.relatedToTaskTitles.length||(o.options.grid.relatedToTaskTitles=d.allTasks),o.options.getAttributeValueForFiltering=function(t){switch(t){case"label":return e.title;case"Name":return e.name;case"TypeDisplay":return e.type;case"Revision":return e.revision;case"isLatestRevision":return e.isLatestRevision;case"Maturity":return e.stateNLS;case"BlockingMaturityMenu":return e.RouteBaseState_NLS;case"TargetMaturityMenu":return e.RouteTargetState_NLS;case"Owner":return e.owner;case"Relation":return o.options.grid.RelationValue;case"relatedToTaskTitles":return o.options.grid.relatedToTaskTitles;default:return e[t]}},c.addRoot(o)})),c.pushUpdate(),0!=c.getChildren().length&&widget.routeMgmtMediator.publish("hide-no-content-placeholder")}(e)}})),define("DS/ENORouteMgmt/Utilities/DragAndDropManager",["UWA/Core","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Services/RouteServices","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/WAFData/WAFData","DS/ENORouteMgmt/Model/RouteContentModel","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Model/InitiateRouteContentModel","DS/ENORouteMgmt/Utilities/DragAndDrop","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Controller/CollabTaskServicesController","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g){"use strict";let f,h=function(e,o){let i=r.getRowModelById(e).attRestrictMembers;t.addDraggedRouteContent(e,o,i).then((function(t){widget.notify.handler().addNotif({level:"success",subtitle:g.successAddContent,sticky:!0});for(var o=!1,i=!1,n=0;n<t.length;n++)"Ad Hoc"===t[n].RouteBaseState&&(o=!0),"true"===t[n].isOnceInstantiable&&(i=!0);o&&i?widget.notify.handler().addNotif({level:"warning",title:g.adHocErrTitle,subtitle:g.adHocErrSubTitle,message:g.adHocErrDesc,sticky:!1}):o&&widget.notify.handler().addNotif({level:"warning",subtitle:g.stateBlockingInfoMsg,sticky:!1});let s=C();if(s){let o=s.id;e==o&&S(t,e)}d._removeDroppableStyle()}),(function(e){null!=e.internalError&&-1!=e.internalError.indexOf("A relationship of this type already exists")?widget.notify.handler().addNotif({level:"error",subtitle:g.errorAddExistingContent,sticky:!0}):null!=e.error&&-1!=e.error.indexOf("Error:")||null!=e.error&&-1!=e.internalError.indexOf("Failed to commit")?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!0}):widget.notify.handler().addNotif({level:"error",subtitle:g.ErrorAddContent,sticky:!0})}))},w=function(e){let t;if(e.dataTransfer){let o=function(e){for(var t,o=UWA.is(e.dataTransfer.types.indexOf,"function")?"indexOf":"contains",i="",n=["text/searchitems","text/plain","Text"],s=0;s<n.length&&""===i;s++){var a=e.dataTransfer.types[o](n[s]);(UWA.is(a,"number")&&a>=0||UWA.is(a,"boolean")&&!0===a)&&(i=n[s])}if(""===i)throw new Error("Unknown type in DnD");return t=e.dataTransfer.getData(i),JSON.parse(t)}(e);o.data&&o.data.items&&(t=o.data.items)}else if("object"==typeof e)t=e;else{let o=JSON.parse(e);o.data&&o.data.items&&(t=o.data.items)}return t},v=function(e,o,i,n){let s=n?n.split(","):"",a=w(e),r=R(a,i);if(y(o,i)){if(!r){let e=[];if(a.every((function(t){let o=t.objectType;if(s.indexOf(o)>-1){let o=t.objectId;return e.push(o),!0}return null==o?widget.notify.handler().addNotif({subtitle:g.replace(g.ErrorContentUndefined,{type:o}),level:"error"}):widget.notify.handler().addNotif({subtitle:g.replace(g.errorAddContentType,{type:o}),level:"error"}),!1})),e.length>0){let n=b(o,i);n?h(n,e):t.getContentInfo(e).then((function(t){S(t,n,e)}),(function(e){d._removeDroppableStyle()}))}}}else widget.notify.handler().addNotif({subtitle:g.noAddAccessError,level:"error"})},S=function(e,i,s){var r=[];null!=s?e.data.forEach((function(e){r.includes(e.id)||r.push(e.id)})):e.forEach((function(e){r.includes(e.id)||r.push(e.id)}));var d;d=u.getPrecondForDocumentSearch();var c=n.getTenantValue(),p=k(),m={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:what/ds6w:status/ds6w:reserved","ds6w:who/ds6w:responsible/ds6w:reservedBy","file_locked_by","description"],select_file:["icon","thumbnail_2d"],query:d,order_by:"asc",order_field:"ds6w:label",nresults:1e3,start:"0",source:["3dspace"],tenant:c,resourceid_in:r,resourceid_not_in:[],with_synthesis:!1,with_synthesis_attribute:!1};widget&&widget.data&&widget.data.routeCredentials&&widget.data.routeCredentials.noSecurityContextForSearch||widget&&widget.data&&widget.data.noSecurityContextForSearch||(m.login=p),m=JSON.stringify(m);var f={isfederated:!0};let h=[];o.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",m,(function(o){let n=!0;if(o&&o.results&&Array.isArray(o.results)){o.results.forEach((function(e){var t=e.attributes;let o={reserved:"",reservedBy:""};t.forEach((function(e){"resourceid"===e.name?o.id=e.value:"ds6w:reserved"===e.name?o.reserved=e.value:"ds6w:reservedBy"===e.name?o.reservedBy=e.value:"file_locked_by"===e.name?o.reservedByUserName=e.value:"description"===e.name&&(o.description=e.value)})),h.push(o)})),n=r.length==h.length}let d=[];if(null!=s)for(let t=0;t<e.data.length;t++)d.push(e.data[t]);else d=e;for(let t=0;t<d.length;t++)if(n)if(null!=s)for(let o=0;o<h.length;o++)e.data[t].id===h[o].id&&(e.data[t].reserved=h[o].reserved,e.data[t].reservedBy=h[o].reservedBy,e.data[t].reservedByUserName=h[o].reservedByUserName,e.data[t].description=h[o].description);else for(let o=0;o<h.length;o++)e[t].id===h[o].id&&(e[t].reserved=h[o].reserved,e[t].reservedBy=h[o].reservedBy,e[t].reservedByUserName=h[o].reservedByUserName,e[t].description=h[o].description);else null!=s?(e.data[t].reserved="",e.data[t].reservedBy="",e.data[t].reservedByUserNamr=""):(e[t].reserved="",e[t].reservedBy="",e[t].reservedByUserName="");null!=i?(a.appendRowsFromDropData(e),widget.routeMgmtMediator.publish("route-content-updated",e),widget.routeMgmtMediator.publish("redraw-graph")):t.fetchStateBlockingConditions(s).then((t=>{for(var o=!1,i=!1,n=0;n<t.length;n++){let s=e.data.find((e=>e.id==t[n].physicalid));s.maturityBlockingStates=t[n].maturityBlockingStates,s.maturityTargetStates=t[n].maturityTargetStates,s.RouteBaseState=t[n].RouteBaseState,s.RouteBaseState_NLS=t[n].RouteBaseState_NLS,s.RouteTargetState=t[n].RouteTargetState,s.RouteTargetState_NLS=t[n].RouteTargetState_NLS,s.current=t[n].current,s.type=s.typeNLS,"Ad Hoc"===t[n].RouteBaseState&&(o=!0),"true"===t[n].isOnceInstantiable&&(i=!0)}o&&i?widget.notify.handler().addNotif({level:"warning",title:g.adHocErrTitle,subtitle:g.adHocErrSubTitle,message:g.adHocErrDesc,sticky:!1}):o&&widget.notify.handler().addNotif({level:"warning",subtitle:g.stateBlockingInfoMsg,sticky:!1}),l.appendRow(e.data,!0)})).catch((e=>{console.log("failed "+e[0])}))}),(function(e){widget.notify.handler().addNotif({subtitle:g.noDataRetrieved,level:"error"})}),f)},k=function(){var e={};return e["3dspace"]={SecurityContext:n.getSecurityContextValue()},e},T=function(e,t){if(t)return!1;let o;return e&&e.nodeModel?"Complete"==e.nodeModel.options.grid.state&&(o=e.nodeModel.options.grid.state):o=D(),"Complete"===o&&(widget.notify.handler().addNotif({subtitle:g.errorCompletedRouteAddContent,level:"error"}),!0)},R=function(e,t){let o,i=!1;return t&&(o=l.getContentIDs(),e.every((function(e){let t=e.objectId;return!(o&&o.indexOf(t)>-1)||(widget.notify.handler().addNotif({subtitle:g.errorAddExistingContent,level:"error"}),i=!0,!1)}))),i},y=function(e,t){if(t)return!0;let o;o=e&&e.nodeModel?e.nodeModel.options.grid:C();let i=!1;return o.Actions&&o.Actions.indexOf("add.contents")>=0&&(i=!0),i},b=function(e,t){let o;return e?o=e.nodeModel.options.grid.id:t||(o=M()),o},M=function(){return C().id},D=function(){return C().state},C=function(){return f},E=function(e){return{envId:n.getTenantValue(),serviceId:"3DSpace",contextId:"",objectId:e.options.grid.id,objectType:e.options.grid.Type,displayName:e.options.grid.Title,displayType:e.options.grid.displayType}};return{init:e=>function(e){e&&e.model&&e.model.id&&(f=e.model)}(e),addContent:(e,t)=>h(e,t),onDropManager:(e,o,i)=>function(e,o,i){if(T(o,i))return;let n=m.getRouteContentDnDTypes();void 0===n?t.fetchAllowedContentTypesForRoute().then((t=>{n=t.data[0].dataelements.routeDnDContentTypes,v(e,o,i,n)}),(e=>{})):v(e,o,i,n)}(e,o,i),_onRoutesummaryDropManager:(e,o,i)=>function(e,o,i){let n=w(e);if(n.length>1)widget.notify.handler().addNotif({subtitle:g.multipleDropError,level:"error"});else switch(n[0].objectType){case"Route":n[0].objectId&&t.fetchRouteById(n[0].objectId).then((e=>{var t=c.gridData(e[0]);widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:t})}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:g.infoRefreshError,sticky:!1})}));break;case"Route Template":n[0].objectId&&t.fetchRouteTemplateById(n[0].objectId).then((e=>{var t=c.templateGridData(e.data[0].dataelements);t.id=e.data[0].id,t.Type=e.data[0].type,widget.routeMgmtMediator.publish("route-template-RouteDataGrid-on-drop",t)}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:g.infoRefreshError,sticky:!1})}));break;case"Inbox Task":widget.setValue("taskIdTobePersisted",n[0].objectId),p.getRouteIdByTask(n[0].objectId).then((e=>{t.fetchRouteById(e).then((e=>{var t=c.gridData(e[0]);widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:t})}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:g.infoRefreshError,sticky:!1})}))}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:g.infoRefreshError,sticky:!1})}));break;default:widget.notify.handler().addNotif({subtitle:g.replace(g.dropTypeNotSuported,{type:n[0].objectType}),level:"error"})}}(e),_onTemplatesummaryDropManager:(e,o,i)=>function(e,o,i){console.log("Droped");let n=w(e);if(n.length>1)widget.notify.handler().addNotif({subtitle:g.multipleDropError,level:"error"});else switch(n[0].objectType){case"Route":n[0].objectId&&t.fetchRouteById(n[0].objectId).then((e=>{r.createModel(e);var t=c.gridData(e[0]);widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:t})}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:g.infoRefreshError,sticky:!1})}));break;case"Route Template":n[0].objectId&&t.fetchRouteTemplateById(n[0].objectId).then((e=>{var t=c.templateGridData(e.data[0].dataelements);t.id=e.data[0].id,t.Type=e.data[0].type,widget.routeMgmtMediator.publish("route-template-DataGrid-on-drop",t)}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:g.infoRefreshError,sticky:!1})}));break;case"Inbox Task":widget.setValue("taskIdTobePersisted",n[0].objectId),p.getRouteIdByTask(n[0].objectId).then((e=>{t.fetchRouteById(e).then((e=>{r.createModel(e);var t=c.gridData(e[0]);widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:t})}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:g.infoRefreshError,sticky:!1})}))}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:g.infoRefreshError,sticky:!1})}));break;default:widget.notify.handler().addNotif({subtitle:g.replace(g.dropTypeNotSuported,{type:n[0].objectType}),level:"error"})}}(e),getContentForDrag:(e,t)=>function(e,t){let o=[];t.nodeModel.getTreeDocument().getSelectedNodes().length>1?t.nodeModel.getTreeDocument().getSelectedNodes().forEach((function(e){o.push(E(e))})):o.push(E(t.nodeModel));let i={protocol:"3DXContent",version:"1.1",source:widget.getValue("appId")?widget.getValue("appId"):"ENXROUT_AP",widgetId:widget.id,data:{items:o}};e.dataTransfer.setData("Text",JSON.stringify(i)),e.dataTransfer.effectAllowed="all"}(e,t)}})),define("DS/ENORouteMgmt/Utilities/TaskPanelSubscribeEvents",["DS/ENORouteMgmt/Views/Form/TaskViewUtil"],(function(e){"use strict";let t=function(e,t){t._routeBasePurposeToken&&widget.routeMgmtMediator.unsubscribe(t._routeBasePurposeToken),t._routeTemplateToken&&widget.routeMgmtMediator.unsubscribe(t._routeTemplateToken),t._routeScopeToken&&widget.routeMgmtMediator.unsubscribe(t._routeScopeToken),t._routeContentToReviewRemovalToken&&widget.routeMgmtMediator.unsubscribe(t._routeContentToReviewRemovalToken),t._routeContentToReviewAdditionToken&&widget.routeMgmtMediator.unsubscribe(t._routeContentToReviewAdditionToken),"create"!=t.mode&&(t._taskGraphRedrawToken&&widget.routeMgmtMediator.unsubscribe(t._taskGraphRedrawToken),t._taskHeaderInfoClickToken&&widget.routeMgmtMediator.unsubscribe(t._taskHeaderInfoClickToken)),t._taskPanelCloseToken&&widget.routeMgmtMediator.unsubscribe(t._taskPanelCloseToken)};return{subscribeToTaskEvents:o=>function(o){o._routeBasePurposeToken=widget.routeMgmtMediator.subscribe("initiateRoute-on-RouteBasePurposeSelection",(function(t){o._taskProperties.elements.expectedAction.elementsList=e.expectedActionElemList(t.basePurpose),"Route Template"==o._routeInfo.Type&&("Approval"==t.basePurpose?null!=o._taskProperties.routeOwnerTaskDiv&&(o._taskProperties.routeOwnerTaskDiv.style.display=""):"Review"==t.basePurpose?null!=o._taskProperties.routeOwnerTaskDiv&&(o._taskProperties.routeOwnerTaskDiv.style.display="none"):""==o._taskProperties.elements.expectedAction.value||"Approve"!=o._taskProperties.elements.expectedAction.value&&"Comment"!=o._taskProperties.elements.expectedAction.value?o._taskProperties.routeOwnerTaskDiv.style.display="none":o._taskProperties.routeOwnerTaskDiv.style.display="")})),o._routeTemplateToken=widget.routeMgmtMediator.subscribe("initiateRoute-on-TemplateSelection",(function(e){t(o.mode,o),widget.routeMgmtMediator.publish(o._taskProperties.closeEventName)})),o._routeTemplateToken=widget.routeMgmtMediator.subscribe("InitiateTemplate-on-chooseUGSelection",(function(e){"Route Template"==e.Type&&("True"==e.chooseUserFromUG&&(o._taskProperties.elements.assignee.selectedItems&&"Group"==o._taskProperties.elements.assignee.selectedItems.options.type||o._taskProperties.elements.assignee.selectedItems&&"Group Proxy"==o._taskProperties.elements.assignee.selectedItems.options.type)?o._taskProperties.chooseUsersFromUgDiv&&(o._taskProperties.chooseUsersFromUgDiv.style.display="",null!=document.querySelector(".initiate-Task-Assignee-Field.disabled-field")&&document.querySelector(".initiate-Task-Assignee-Field.disabled-field").removeClassName("disabled-field")):o._taskProperties.chooseUsersFromUgDiv&&(o._taskProperties.chooseUsersFromUgDiv.style.display="none",null!=document.querySelector(".initiate-Task-Assignee-Field")&&document.querySelector(".initiate-Task-Assignee-Field").addClassName("disabled-field")))})),o._routeScopeToken=widget.routeMgmtMediator.subscribe("initiateRoute-on-ScopeSelection",(function(t){e.clearAssigneeFields(o._taskProperties)})),o._routeContentToReviewRemovalToken=widget.routeMgmtMediator.subscribe("clearContentToReview-on-ContentRemoval",(function(t){e.updateContentToReviewFieldOnContentRemoval(o._taskProperties,t)})),"create"!=o.mode&&(o._taskGraphRedrawToken=widget.routeMgmtMediator.subscribe("redraw-graph",(function(e){t(o.mode,o),null!=e&&"Route"!=e.type&&"Route Template"!=e.type?e.id==widget.getValue("taskIdTobePersisted")&&(widget.routeMgmtMediator.publish("task-DataGrid-on-dblclick",{_id:e.id}),widget.routeMgmtMediator.publish(o._taskProperties.closeEventName)):widget.routeMgmtMediator.publish(o._taskProperties.closeEventName)})),o._taskHeaderInfoClickToken=widget.routeMgmtMediator.subscribe("route-header-info-click",(function(e){t(o.mode,o)}))),o._taskPanelCloseToken=widget.routeMgmtMediator.subscribe("task-panel-close",(function(e){t(o.mode,o),widget.routeMgmtMediator.publish(o._taskProperties.closeEventName)})),null!=o._taskProperties.elements.title.elements&&""==o._taskProperties.elements.title.elements.inputField.value.trim()&&setTimeout((function(){o._taskProperties.elements.title.elements.inputField.focus()}),1e3)}(o),destroy:(e,o)=>t(e,o)}})),define("DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView",["DS/ENORouteMgmt/Config/RouteSummaryGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/DragAndDropOnRouteSummary","DS/ENORouteMgmt/Utilities/DragAndDropManager","DS/ENORouteMgmt/Config/Toolbar/RouteSummaryToolbarConfig","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s){"use strict";let a,r,l={},d=function(e,t){i._onRoutesummaryDropManager(e)},u=function(){var e=widget.getValue("routefilters");return null==e?(widget.setValue("routefilters",["owned","assigned","Define","In Process"]),["owned","assigned","Define","In Process"]):e};return{build:c=>function(c){let p=widget.getValue("RouteSummary-ShowView"),m="data-grid-container showView nonVisible";p&&"TileView"==p&&(m="data-grid-container hideView");var g=UWA.createElement("div",{id:"dataGridViewContainer",class:m});let f=UWA.createElement("div",{class:"RTC-drop-container"});f.inject(g);let h=UWA.createElement("div",{class:"drop-zone add-content"}),w=UWA.createElement("div",{class:"dismiss-box",html:[{tag:"span",class:"fonticon fonticon-close fonticon-3x"},{tag:"span",class:"dismiss-box-content",html:s.dismiss}]});h.appendChild(w);let v=UWA.createElement("div",{class:"dropzonemsg-container",html:[{tag:"span",class:"fonticon fonticon-open fonticon-3x"},{tag:"p",class:"text-content",html:s.Open}]});h.appendChild(v),f.appendChild(h),o.makeDroppable(f,d),f.hide(),v.addEventListener("dragleave",(function(e){e.stopPropagation(),e.preventDefault()})),f.addEventListener("dragleave",(e=>{e.stopPropagation(),e.preventDefault(),f.hide()}));let S=n.writetoolbarDefination(u());1==UWA.Utils.Client.Features.touchEvents&&(l.showRowCount=!0),l.cellDragEnabledFlag=!0,l.identifier="RouteSummaryDataGridView";let k=t.build(c,e,S,g,l);return a=t.dataGridViewToolbar(),r=t.dataGridView(),r.onDragStartCell=function(e,t){return i.getContentForDrag(e,t),!0},r.onDragEndCell=function(e,t){e.target.removeClassName("wux-ui-state-activated wux-ui-state-highlighted")},r.onDragOverColumnHeader=function(e,t){f.show()},r.onDropCell=function(e,t){t.nodeModel.unhighlight(),i.onDropManager(e,t)},r.onDragOverCell=function(e,t){t.nodeModel.highlight(),e.preventDefault()},r.onDragEnterBlank=function(e,t){f.show()},r.onDragLeaveCell=function(e,t){t.nodeModel.unhighlight()},g.addEventListener("dragenter",(e=>{e.stopPropagation(),e.preventDefault(),e.shiftKey&&(f.show(),droppableElement.children[0].children[0].hide())})),g.addEventListener("dragleave",(e=>{let t=document.querySelector("#dataGridDivToolbar");t&&t.addEventListener("dragenter",(e=>{f.hide()}))})),k}(c),registerListners:()=>registerListners(),destroy:()=>{r&&r.destroy()},getGridViewToolbar:()=>a,getDataGridInstance:()=>r}})),define("DS/ENORouteMgmt/Model/ContentToReviewModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Utilities/PlaceHolder","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s){"use strict";let a=new e;return{createModel:(e,o)=>function(e,o){return a.prepareUpdate(),e.forEach((function(e){var o=new t({label:e.title,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Type:e.type,relatedToTaskIds:e.relatedToTaskIds,revision:e.revision},subLabel:e.stateNLS,icons:[e.typeicon],contextualMenu:["My context menu"]});""===e[0]&&(o._isHidden=!0),a.addRoot(o)})),a.pushUpdate(),a}(e),getModel:()=>a,getSelectedRowsModel:()=>o.getSelectedRowsModel(a),getContentIDs:()=>function(){if(null!=a){for(var e=a.getChildren(),t=[],o=0;o<e.length;o++)t.push(e[o]._options.grid.id);return t}}(),destroy:()=>{a=new e},appendRows:e=>function(e){a.prepareUpdate(),e.forEach((e=>{var o=new t({label:e.title,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Type:e.type},subLabel:e.stateNLS,icons:[e.typeicon],contextualMenu:["My context menu"]});a.addRoot(o)})),a.pushUpdate();var o=document.querySelector(".contentToReview-gridView-View");o.hasClassName("hideView")&&o.removeClassName("hideView")}(e)}})),define("DS/ENORouteMgmt/Utilities/Search/DndSearchUtil",["DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Model/InitiateRouteContentModel","DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Model/TaskAttachmentModel","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Services/RouteServices","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d){"use strict";let u=function(e){let t;if(e.dataTransfer){let o=function(e){for(var t,o={},i=UWA.is(e.dataTransfer.types.indexOf,"function")?"indexOf":"contains",n="",s=["text/searchitems","text/plain","Text"],a=0;a<s.length&&""===n;a++){var r=e.dataTransfer.types[i](s[a]);(UWA.is(r,"number")&&r>=0||UWA.is(r,"boolean")&&!0===r)&&(n=s[a])}return""===n?console.log("data format is not correct"):(t=e.dataTransfer.getData(n),o=JSON.parse(t)),o}(e);o.data&&o.data.items&&(t=o.data.items)}else if("object"==typeof e)t=e;else{let o=JSON.parse(e);o.data&&o.data.items&&(t=o.data.items)}return t},c=function(e,t,o,i){let n=[],s=[],a=[];if(null!=o){null!=i&&0!=i.length&&i.forEach((function(e){null==e.options.value.name&&n.push(e.options.value)})),s=e.concat(n);for(let e=0;e<t.length;e++){let o=t[e].objectId;s&&-1==s.indexOf(o)&&a.push(t[e])}}return a},p=function(e,i,s){let a=u(e);if(null!=a){let e=[],r=[],u=[],p=[];if("droppable_TaskViewContentAttachment"==s)r=n.getContentIDs(),e=c(r,a,s,i.autoCompleteComponent.selectedItems);else if("create"==i.mode)r=t.getRouteContentIds(),e=c(r,a,s,i.contentToReviewField.selectedItems);else{if(!(i.mode="taskEditMode"))return;r=o.getContentIDs(),e=c(r,a,s,i.contentToReviewField.selectedItems)}a.length>e.length&&widget.notify.handler().addNotif({subtitle:d.errorAddExistingContentInputField,level:"warning"}),e.length>0&&(u=function(e,t){let o={},i=[],n="",s=[];for(let o=0;o<e.length;o++){let a=e[o].displayType?e[o].displayType:e[o].objectType;if("droppable_TaskViewContentReview"==t||"droppable_TaskViewContentAttachment"==t){let r=l.getRouteContentDnDTypes();r=r?r.split(","):"";let d=["Person","Business Role","Security Context","Route","Route Template","Inbox Task"];r.includes(e[o].objectType)&&"droppable_TaskViewContentReview"==t||"droppable_TaskViewContentAttachment"==t&&!d.includes(e[o].objectType)?i.push(e[o]):""==n?(n=a,s.push(a)):-1==s.indexOf(a)&&(n=n+", "+a,s.push(a))}}return o.notSupportedTypeString=n,o.supportedData=i,o}(e,s)),e.length>u.supportedData.length&&widget.notify.handler().addNotif({subtitle:d.replace(d.typeNotSupported,{tag1:u.notSupportedTypeString}),level:"error"}),u.supportedData.length>0&&(p=u.supportedData),f(p,i,s)}},m=function(e,t,o){"#taskAssigneesId"==o?e.selectedItems=t:"droppable_TaskViewContentAttachment"==o?(null!=e.autoCompleteComponent.selectedItems?e.autoCompleteComponent.selectedItems.push(t):e.autoCompleteComponent.selectedItems=t,e.autoCompleteComponent._applySelectedItems()):(null!=e.contentToReviewField.selectedItems?e.contentToReviewField.selectedItems.push(t):e.contentToReviewField.selectedItems=t,e.contentToReviewField._applySelectedItems())},g=function(t){let o;if("create"==t.mode){let t=e.getSecurityContextValue().split(".");3==t.length&&(o=t[1])}else(t.mode="taskEditMode")&&(o=t.routeInfo.organization);return o},f=function(n,u,c){let p;var f,h,w,v="",S=[];for(let e=0;e<n.length;e++)S.push(n[e].objectId);var k,T=[],R=[],y=((k={})["3dspace"]={SecurityContext:e.getSecurityContextValue()},k),b=e.getTenantValue();h=(h=l.getRouteContentSearchTypes())?h.split(","):"","#taskAssigneesId"!=c&&(p=u.routeInfo,f=u.mode,null==(w=p.scopeId)&&(w="All"==p.Scope[0]||"Organization"==p.Scope[0]?p.Scope[0]:p.Scope[2]));var M={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_file:["icon","thumbnail_2d"],order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:["3dspace"],tenant:b,resourceid_in:S,with_synthesis:!1,with_synthesis_attribute:!1};if("#taskAssigneesId"==c)n[0].Scope=u.options.scope,n[0].ScopeMembers=u.options.ScopeMembers,v=s.getPrecondForTaskMemberSearch(n[0]),M.login=y,M.select_predicate=["ds6w:label","ds6w:type","ds6w:identifier","ds6w:responsible","ds6wg:fullname","owner","organization"],M.query=v.precond;else if("droppable_TaskViewContentReview"==c){if(v=s.getPrecondForContentSearch("All",h,""),"create"!=f){for(var D=o.getModel().getChildren(),C=0;C<D.length;C++)R.push(D[C]._options.grid.id)}if(T=R,"create"==f){var E=t.getRouteContentIds();for(C=0;C<E.length;C++)T.push(E[C])}null!=u.contentToReviewField&&null!=u.contentToReviewField.selectedItems&&0!=u.contentToReviewField.selectedItems.length&&u.contentToReviewField.selectedItems.forEach((function(e){T.push(e.options.value)})),M.login=y,M.select_predicate=["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname","ds6wg:revision","owner","organization","route_content_scope","ds6w:when/ds6w:created","ds6w:when/ds6w:modified","ds6w:what/ds6w:status/ds6w:reserved","ds6w:who/ds6w:responsible/ds6w:reservedBy","file_locked_by"],M.resourceid_not_in=T,M.query=v}else"droppable_TaskViewContentAttachment"==c&&(null!=u.attachedDocuments&&(T=JSON.parse(JSON.stringify(u.attachedDocuments))),null!=u.autoCompleteComponent&&null!=u.autoCompleteComponent.selectedItems&&0!=u.autoCompleteComponent.selectedItems.length&&u.autoCompleteComponent.selectedItems.forEach((function(e){null==e.options.value.name&&T.push(e.options.value)})),v=s.getPrecondForDocumentSearch(),M.login=y,M.select_predicate=["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname","organization","route_content_scope","ds6w:when/ds6w:created","ds6w:when/ds6w:modified","ds6w:what/ds6w:status/ds6w:reserved","ds6w:who/ds6w:reservedBy","file_locked_by","ipml_46_iconname"],M.resourceid_not_in=T,M.query=v);let A=[];var O,I={};let N;var U={isfederated:!0};M=JSON.stringify(M),a.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",M,(function(e){e&&e.results&&Array.isArray(e.results)&&((O=e.results).forEach((function(e){let t=[];var o=new i;e.attributes.forEach((function(e){"resourceid"===e.name?o.options.value=e.value:"ds6w:label"===e.name&&(o.options.label=e.value),"ENOTASK_AP"==widget.getValue("appId")&&"type_icon_url"===e.name&&o.options.icons.push(e.value),"droppable_TaskViewContentReview"==c&&("ds6w:what/ds6w:type"===e.name||"ds6w:type"===e.name?o.options.grid.type=e.value:"resourceid"===e.name?o.options.grid.id=e.value:"ds6w:label"===e.name?o.options.grid.title=e.value:"ds6w:identifier"===e.name?o.options.grid.name=e.value:"ds6w:what/ds6w:status"===e.name||"ds6w:status"===e.name?(o.options.grid.state=e.value,o.options.grid.stateNLS=e.value):"ds6w:when/ds6w:created"===e.name||"ds6w:created"===e.name?o.options.grid.created=e.value:"ds6w:when/ds6w:modified"===e.name||"ds6w:modified"===e.name?o.options.grid.modified=e.value:"type_icon_url"===e.name?o.options.grid.type_icon_url=e.value:"owner"===e.name?o.options.grid.ownerName=e.value:"ds6w:responsible"===e.name?o.options.grid.owner=e.value:"ds6w:what/ds6w:policy"===e.name||"ds6w:policy"===e.name?o.options.grid.policy=e.value:"ds6wg:revision"===e.name?o.options.grid.revision=e.value:"organization"===e.name?o.options.organization=e.value:"route_content_scope"===e.name?t.push(e.value):"ds6w:what/ds6w:status/ds6w:reserved"===e.name||"ds6w:reserved"===e.name?o.options.grid.reserved=e.value:"ds6w:who/ds6w:responsible/ds6w:reservedBy"===e.name||"ds6w:reservedBy"===e.name?o.options.grid.reservedBy=e.value:"file_locked_by"===e.name&&(o.options.grid.reservedByUserName=e.value))})),o.options.scopeId=t,A.push(o.options.value),I[o.options.value]=o})),N=n.length==O.length),"#taskAssigneesId"==c&&null==O?widget.notify.handler().addNotif({subtitle:d.outOfScopeError,level:"error"}):function(e,t,o,n,s,a,l){let u=[],c=[],p=[];for(let r=0;r<e.length;r++){let d=e[r].objectId;if(n.includes(d)){let e;if("droppable_TaskViewContentAttachment"==o||"droppable_TaskViewContentReview"==o&&"All"==a)e=s[d];else if("droppable_TaskViewContentReview"==o&&"Organization"==a){let o,i=s[d];o=g(t),o==i.options.organization?e=i:u.push(i)}else if("droppable_TaskViewContentReview"==o){let t=[],o=s[d];if(t=o.options.scopeId,t.length>0)for(let i=0;i<t.length;i++)a==t[i]&&(e=o);void 0===e&&c.push(o)}else"#taskAssigneesId"==o&&(e=s[d]);void 0!==e&&m(t,e,o)}else if("#taskAssigneesId"==o){var f=new i;for(let i=0;i<e.length;i++)f.options.value=e[i].objectId,f.options.label=e[i].displayName,f.options.grid.id=e[i].objectId,f.options.grid.title=e[i].displayName,f.options.grid.Type=e[i].objectType,m(t,f,o)}else"droppable_TaskViewContentAttachment"!=o&&"droppable_TaskViewContentReview"!=o||l||n.includes(d)||p.push(d)}p.length>0?r.getContentInfo(p).then((e=>{for(let s=0;s<e.data.length;s++){var n=new i;if(n.options.value=e.data[s].id,n.options.label=e.data[s].title,"droppable_TaskViewContentReview"==o&&(n.options.grid.id=e.data[s].id,n.options.grid.title=e.data[s].title,n.options.grid.name=e.data[s].name,n.options.grid.revision=e.data[s].revision,n.options.grid.owner=e.data[s].owner,n.options.grid.type_icon_url=e.data[s].typeicon),"droppable_TaskViewContentReview"==o&&"Organization"==a){let i;i=g(t),e.data[s].organization==i?m(t,n,o):u.push(e.data[s].id)}else"droppable_TaskViewContentAttachment"!=o&&"droppable_TaskViewContentReview"!=o||m(t,n,o)}u.length>0&&widget.notify.handler().addNotif({subtitle:d.errorInOrganization,level:"error"})})):(u.length>0&&widget.notify.handler().addNotif({subtitle:d.errorInOrganization,level:"error"}),c.length>0&&widget.notify.handler().addNotif({subtitle:d.errorInCotentScope,level:"error"}))}(n,u,c,A,I,w,N)}),(function(e){widget.notify.handler().addNotif({subtitle:d.noDataRetrieved,level:"error"})}),U)};return{getResultFromSearch:(e,t,o,i)=>p(e,t,o),manageMemberDragAndDrop:(e,t,o)=>function(e,t,o){let i,n=u(e),s=n[0].objectType,a=t;"#taskAssigneesId"==o&&("Person"==s||"Group"==s||"User Group"==s||"Group Proxy"==s?t.options.ScopeMembers&&Array.isArray(t.options.ScopeMembers)&&!t.options.ScopeMembers.includes(n[0].objectId)?widget.notify.handler().addNotif({subtitle:d.outOfScopeError,level:"error"}):i=n:widget.notify.handler().addNotif({subtitle:d.replace(d.typeNotSupported,{tag1:s}),level:"error"})),f(i,a,o)}(e,t,o)}})),define("DS/ENORouteMgmt/Views/Grid/RouteTasksGridCustomColumns",["DS/Controls/Button","DS/Controls/TooltipModel","DS/ENORouteMgmt/EnoviaBootstrap","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Views/Form/TaskViewUtil","UWA/Drivers/Alone","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/Views/Dialogs/RouteLifeCycleDialogue","DS/ENORouteMgmt/Utilities/DataFormatter","DS/LifecycleControls/EditPropDialog","DS/TransientWidget/TransientWidget","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d,u,c){"use strict";return{onRouteTaskStateCellRequest:e=>function(e){let t;if(!e.isHeader&&(t=e.cellView.collectionView.reuseCellContent("_state_"),t)){let o;t.getChildren()[0].removeEvents();let i=e.nodeModel.options.grid.current,n=e.nodeModel.options.grid.currentNLS;if(null==i)return t.getChildren()[0].setHTML(""),e.cellView._setReusableContent(t),void t.getChildren()[0].setAttribute("class","");"Draft"===i.trim()?o="DEFINE":"Assigned"===i.trim()?o="INPROCESS":"Review"===i.trim()?o="INAPPROVAL":"Complete"===i.trim()&&(o="COMPLETE"),t.getChildren()[0].setHTML(n),t.getChildren()[0].setAttribute("class","route-state-title "+o),t.getChildren()[0].addEvent("click",(function(e){require(["DS/ENORouteMgmt/Model/RouteTaskModel"],(function(e){var t=e.getSelectedRowsModel(),o=l.gridData(t.data[0].options.grid);"Draft"!=t.data[0].options.grid.current?r.lifeCycle(o):widget.notify.handler().addNotif({level:"warning",subtitle:c.maturityBadgeError,sticky:!1})}))})),e.cellView._setReusableContent(t)}}(e),onRemoveRouteTaskStateCellRequest:e=>function(e){let t;if(!e.isHeader&&(t=e.cellView.collectionView.reuseCellContent("_state_"),t)){let o;t.setStyle("cursor","default");let i=e.nodeModel.options.grid.current,n=e.nodeModel.options.grid.stateNLS;if(null==i)return t.getChildren()[0].setHTML(""),e.cellView._setReusableContent(t),void t.getChildren()[0].setAttribute("class","");"Draft"===i.trim()?o="DEFINE":"Assigned"===i.trim()?o="INPROCESS":"Review"===i.trim()?o="INAPPROVAL":"Complete"===i.trim()&&(o="COMPLETE"),t.getChildren()[0].setHTML(n),t.getChildren()[0].setAttribute("class","route-state-title "+o),e.cellView._setReusableContent(t)}}(e),onRouteTaskAssigneeCellRequest:e=>function(e){let t;if(!e.isHeader&&(t=e.cellView.collectionView.reuseCellContent("_owner_"),t)){t.removeEvents();let g=e.nodeModel.options.grid.routeOwnerTask,f=e.nodeModel.getTreeDocument().parentType;if(f&&"Route Template"==f&&"TRUE"==g)t.querySelector(".userIcon")&&t.querySelector(".userIcon").setStyle("display","none"),t.querySelector(".avatarIcon")&&t.querySelector(".avatarIcon").setStyle("display","none"),t.querySelector(".askRTOwnerDiv")&&(t.querySelector(".userName").setStyle("color","inherit"),t.querySelector(".userName").setStyle("text-decoration","none"),t.querySelector(".askRTOwnerDiv").setStyle("display","block")),t.getChildren()[1].setHTML(c.routeOwnerTask),e.cellView._setReusableContent(t);else{var n;t.querySelector(".askRTOwnerDiv")&&(t.querySelector(".askRTOwnerDiv").setStyle("display","none"),t.querySelector(".userName").style.removeProperty("color"),t.querySelector(".userName").style.removeProperty("text-decoration"));var s=e.nodeModel.options.grid.assigneeType;let c=e.nodeModel.options.grid.assigneePID;var r=e.nodeModel.options.grid.taskAssignee,l=e.nodeModel.options.grid.taskAssigneeUsername,p="/api/user/getpicture/login/"+l+"/format/normal";if(null==r||""==r)return t.getChildren()[1].setHTML(""),t.querySelector(".avatarIcon")&&t.querySelector(".avatarIcon").setStyle("display","none"),t.querySelector(".userIcon")&&t.querySelector(".userIcon").setStyle("display","none"),t.querySelector(".askRTOwnerDiv")&&(t.querySelector(".askRTOwnerDiv").setStyle("text-decoration","none"),t.querySelector(".askRTOwnerDiv").setStyle("display","block"),t.querySelector(".askRTOwnerDiv").setStyle("display","none")),void e.cellView._setReusableContent(t);var m=a.getAvatarDetails(r);let g=UWA.createElement("img",{class:"userIcon",src:""});if("Group"===s||"User Group"===s||"Group Proxy"===s){r=e.nodeModel.options.grid.assigneeTitle,n=i.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png"),g.src=n;let o=e.nodeModel.options.grid.userGroupUid;"undefined"==typeof dscef?(t.setStyle("cursor","pointer"),t.addEvent("click",(function(e){a.launchPreviewGroupMembers(o)}))):t.querySelector(".askRTOwnerDiv").setStyle("display","inline")}else n=o.getSwymUrl()+p;"Person"==s?null!=o.getSwymUrl()?t.querySelector(".userIcon")&&(t.querySelector(".userIcon").setStyle("display","block"),t.querySelector(".userIcon").src=n,"undefined"==typeof dscef?(t.setStyle("cursor","pointer"),t.addEvent("click",(function(e){u.showWidget("X3DPRFL_AP","",{login:l,url:o.getSwymUrl()+"?profile="+l},{mode:"panel",height:700,width:800})}))):t.querySelector(".askRTOwnerDiv").setStyle("display","inline")):(t.querySelector(".userIcon")&&t.querySelector(".userIcon").setStyle("display","none"),t.querySelector(".avatarIcon").setStyle("display","block"),"undefined"==typeof dscef?(t.setStyle("cursor","pointer"),t.addEvent("click",(function(e){var t={_context:o.getSecurityContextValue(),_selection:[{getID:function(){return c}}],getSecurityContext:function(){return this._context},getSelectedNodes:function(){return this._selection},displayNotification:function(){}};(new d).launchProperties(t)}))):t.querySelector(".askRTOwnerDiv").setStyle("display","inline"),t.querySelector(".avatarIcon").setHTML(m.avatarStr),t.querySelector(".avatarIcon").setStyle("background",m.avatarColor),t.querySelector(".avatarIcon").setStyle("display","block")):(t.querySelector(".userIcon")?t.querySelector(".userIcon").src=n:t.getChildren()[0].addContent(g),t.querySelector(".avatarIcon")&&t.querySelector(".avatarIcon").setStyle("display","none"),t.querySelector(".userIcon").setStyle("display","block")),t.getChildren()[1].setText(r),e.cellView._setReusableContent(t)}}}(e),onRouteTaskDueDateCellRequest:e=>function(e){let t;if(!e.isHeader&&(t=e.cellView.collectionView.reuseCellContent("_duedate_"),t)){let o=e.nodeModel.options.grid.taskDueDate;if(null==o)return t.getChildren()[0].setStyle("display","none"),t.getChildren()[1].setStyle("display","none"),t.getChildren()[2].setHTML(""),void e.cellView._setReusableContent(t);if("object"==typeof o){let t={};t.model=e.nodeModel.options.grid,o=n.dueDateViewMode(t,o)}else{o=new Date(o);let t={};t.model=e.nodeModel.options.grid,o=n.dueDateViewMode(t,o)}let i=e.nodeModel.options.grid.attrTaskStatus;"status-late"==i?(t.getChildren()[0].setStyle("display","block"),t.getChildren()[0].title=c.overdue,t.getChildren()[1].setStyle("display","none")):"status-due"==i?(t.getChildren()[1].setStyle("display","block"),t.getChildren()[1].title=c.soonToBeOverDue,t.getChildren()[0].setStyle("display","none")):(t.getChildren()[0].setStyle("display","none"),t.getChildren()[1].setStyle("display","none")),t.getChildren()[2].setHTML(o),e.cellView._setReusableContent(t)}}(e),getCellTypeRepresentation:e=>function(e){return e.nodeModel&&""!=e.nodeModel.options.grid.subRouteGridApprovalStatus?"user":"string"}(e),onRouteTaskAssignmentScopeCellRequest:e=>function(e){let t;if(!e.isHeader&&(t=e.cellView.collectionView.reuseCellContent("_assignmentScope_"),t)){t.removeEvents();var o=e.nodeModel.options.grid.routeOwnerUGTitle;if(null==o){var n=new UWA.Element("div",{id:"noassignee",class:"no-assignmentScope",html:""});e.cellView._setReusableContent(n)}else if("TRUE"==e.nodeModel.options.grid.routeOwnerTask){var s;let n=UWA.createElement("img",{class:"userIcon",src:""});s=i.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png"),n.src=s;let r=e.nodeModel.options.grid.routeOwnerUGUUID;t.setStyle("cursor","pointer"),t.addEvent("click",(function(e){a.launchPreviewGroupMembers(r)})),t.getChildren()[0].addContent(n),t.getChildren()[1].setText(o),e.cellView._setReusableContent(t)}}}(e)}})),define("DS/ENORouteMgmt/Views/Grid/RouteContentsDataGridView",["DS/ENORouteMgmt/Config/RouteContentsGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Config/Toolbar/RouteContentsTabToolbarConfig","DS/ENORouteMgmt/Utilities/DragAndDropManager"],(function(e,t,o,i){"use strict";let n,s,a={};return{build:r=>function(r){let l="Contents-gridView-View nonVisible showView",d=widget.getValue("ContentsTab-ShowView");d&&"GridView"!=d&&(l="Contents-gridView-View hideView");var u=UWA.createElement("div",{id:"dataGridViewContainer",class:l});let c=o.writetoolbarDefination(r);1==UWA.Utils.Client.Features.touchEvents&&(a.showRowCount=!0),a.cellDragEnabledFlag=!0,a.identifier="RouteContentsDataGridView";let p=t.build(r,e,c,u,a);return n=t.dataGridViewToolbar(),s=t.dataGridView(),s.onDragStartCell=function(e,t){return i.getContentForDrag(e,t),!0},s.onDragEndCell=function(e,t){e.target.removeClassName("wux-ui-state-activated wux-ui-state-highlighted")},p}(r),getGridViewToolbar:()=>n,getDataGridInstance:()=>s}})),define("DS/ENORouteMgmt/Views/Grid/TaskAssociatedContent",["DS/ENORouteMgmt/Config/ContentToReviewGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Model/InitiateRouteContentModel"],(function(e,t,o){"use strict";let i=0,n=function(n){let s=o.getRouteContentModel();i=s._numberOfNodesInDocument;let a={};a=null!=n?n:document.querySelector("#taskAssociatedContent-dataGridViewContainer");let r={cellDragEnabledFlag:!1,showRowBorderFlag:!0,showOutlineFlag:!0,showAlternateBackgroundFlag:!1};r.layoutOptions={rowsHeader:!1,columnsHeader:!1,rowSpacing:5,cellWidth:2},r.showContextualMenuColumnFlag=!1,r.identifier="TaskAssociatedContent";let l=t.build(s,e,!1,a,r),d=document.querySelector("#taskAssociatedContentDatagridViewId");return null!=d&&l.inject(d),l},s=function(){var e=document.querySelector("#taskAssociatedContent-dataGridViewContainer");let t=i;e&&(0==t?e.setStyle("display","none"):t<5?(e.setStyle("height",41*t+"px"),e.setStyle("display","block"),e.setStyle("position","relative")):(e.setStyle("height","200px"),e.setStyle("display","block"),e.setStyle("position","relative")))};return{build:()=>function(){let e=UWA.createElement("div",{id:"taskAssociatedContent-dataGridViewContainer",class:"taskAssociatedContent-dataGridViewContainerClass"});return n(e)}(),registerListners:()=>{widget.routeMgmtMediator.subscribe("task-associated-content-update",(function(){n(),s()}))},setContentDatagridHeight:()=>s()}})),define("DS/ENORouteMgmt/Actions/ContentActions",["UWA/Drivers/Alone","UWA/Core","DS/WAFData/WAFData","UWA/Utils","DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Model/RouteContentModel","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d){"use strict";let u;return u={onSearchClick:function(){var t,o,i=n.tileView();require(["DS/ENORouteMgmt/Model/RouteContentModel"],(function(n){var s=(a=n).getModel().routeModel.Scope,d=a.getModel().routeModel.organization;o="All"==s[0]||"Organization"==s[0]?s[0]:s[2];var c=e.Utils.getUUID(),p=this;e.is(t)||require(["DS/SNInfraUX/SearchCom"],(function(n){t=n.createSocket({socket_id:c});var s=l.getRouteContentSearchTypes(),m=s?s.split(","):"",g=r.getRefinementToSnN(c,"addContent",!0,m);if(g.precond=r.getPrecondForContentSearch(o,m,d),g.resourceid_not_in=a.getContentIDs(),g.select_predicate=["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:modified","ds6w:created","ds6wg:revision","ds6w:status","ds6w:responsible","owner","ds6w:responsibleUid","ds6wg:filesize","ds6w:i3dx","ds6w:project","ds6w:dataSource","ds6w:community","ds6w:originator","dsgeo:referential","ds6w:lastModifiedBy","ds6w:repository","dcterms:title","dcterms:description","owner_fullname"],!e.is(t))throw new Error("Socket not initialized");t.dispatchEvent("RegisterContext",g),t.addListener("Selected_Objects_search",u.selected_Objects_search.bind(p,i)),t.dispatchEvent("InContextSearch",g)}))}))},selected_Objects_search:function(e,t){s.addExistingRouteContent(e,t).then((function(e){widget.notify.handler().addNotif({level:"success",subtitle:d.successAddContent,sticky:!0});for(var o=!1,i=!1,n=0;n<e.length;n++)"Ad Hoc"===e[n].RouteBaseState&&(o=!0),"true"===e[n].isOnceInstantiable&&(i=!0);if(o&&i?widget.notify.handler().addNotif({level:"warning",title:d.adHocErrTitle,subtitle:d.adHocErrSubTitle,message:d.adHocErrDesc,sticky:!1}):o&&widget.notify.handler().addNotif({level:"warning",subtitle:d.stateBlockingInfoMsg,sticky:!1}),null!=t)for(let o=0;o<e.length;o++)e[o].reserved=t[o]["ds6w:reserved_value"],null!=t[o]["ds6w:reservedBy"]?e[o].reservedBy=t[o]["ds6w:reservedBy"]:e[o].reservedBy="",null!=t[o].file_locked_by?e[o].reservedByUserName=t[o].file_locked_by:e[o].reservedByUserName="",null!=t[o]["ds6w:description"]?e[o].description=t[o]["ds6w:description"]:e[o].description="";a.appendRows(e),widget.routeMgmtMediator.publish("route-content-updated",e),widget.routeMgmtMediator.publish("redraw-graph")}),(function(e){null!=e.internalError&&-1!=e.internalError.indexOf("A relationship of this type already exists")?widget.notify.handler().addNotif({level:"error",subtitle:d.errorAddExistingContent,sticky:!0}):e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!0}):widget.notify.handler().addNotif({level:"error",subtitle:d.ErrorAddContent,sticky:!0})}))},getPrecondForContentSearch:function(){for(var e=l.getRouteContentSearchTypes().split(","),t="flattenedtaxonomies:(",o=e.length,i=0;i<o;i++){t+='"types/'+e[i]+'"',i<o-1&&(t+=" OR "),i===o-1&&(t+=")")}return t}},u})),define("DS/ENORouteMgmt/Views/Form/TaskInEditMode",["DS/ENORouteMgmt/Views/Form/FormElements","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/ENORouteMgmt/Utilities/Utils","DS/Controls/Button","DS/ENORouteMgmt/Views/Form/CustomFieldUtils","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/Views/Form/TaskProperties","DS/Controls/ButtonGroup","DS/Controls/TooltipModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g){"use strict";let f,h,w,v,S,k=c.getTaskVaribles(),T=function(e,t,o,i,s){let a=n.isMultiValueField(t),r=o.model[t.name];a&&Array.isArray(r)?(s=0,0===r.length&&R(e,t,"",i,s),r.forEach(((o,n)=>{R(e,t,o,i,s),s+=1}))):R(e,t,r,i,s)},R=function(e,t,o,i,s){let a=n.getFieldType(t),r=n.isReadOnlyField(t),l=n.isMultiValueField(t);if(r)y(e,t,o,i);else{if(l){s||(s=0),e=new UWA.Element("div",{id:"row-"+s,class:"multiVal"}).inject(e)}switch(a){case"Editor":M(e,t,o,i);break;case"LineEditor":b(e,t,o,i);break;case"DatePicker":E(e,t,o,i);break;case"Toggle":D(e,t,o,i);break;case"ComboBox":C(e,t,o,i);break;case"LineEditor with Unit":A(e,t,o,i);break;default:return}if(l){let o=new UWA.Element("div",{id:"MultiVal_button",class:""}).inject(e);O(e,t,i,o),s&&I(e,t,i,o)}}},y=function(e,t,i,s){if(n.isDateField(t)&&i&&""!=i){let e=new Date(i);i=o.getLocaleDate(e,!0)}if("LineEditor with Unit"==n.getFieldType(t)){i+=" "+n.getDefaultUnit(t).display}new UWA.Element("span",{text:i}).inject(e).tooltipInfos=x(i),s.elements[t.name]={value:i}},b=function(t,o,i,s){JSON.parse(o.viewConfig);let a="[0-9]+";"real"==n.getAttributeType(o)&&(a="[0-9]+|([0-9]+.[0-9]+)");let r={sizeInCharNumber:1,value:i};r.pattern=a;let l=e.createElement(t,r,"lineEditor");N(s,o,l)},M=function(t,o,i,n){let s={pattern:"[^./#,\\[\\]\\$\\^@\\*\\?%:'\"\\\\<>]+",widthInCharNumber:32,nbRows:4,newLineMode:"enter",value:i},a=e.createElement(t,s,"Editor");N(n,o,a)},D=function(t,o,i,n){let s=!1;"TRUE"==i&&(s=!0);let a={type:"checkbox",label:o.label,value:i,checkFlag:s};t.setStyle("padding-top","10px");let r=e.createElement(t,a,"Toggle");N(n,o,r)},C=function(t,o,i,s){let a={elementsList:n.getRangeElementsList(o),value:i,enableSearchFlag:!1},r=e.createElement(t,a,"ComboBox");N(s,o,r)},E=function(t,o,i,n){let s={value:new Date(i),minValue:new Date(i),timePickerFlag:!0},a=e.createElement(t,s,"DatePicker");N(n,o,a)},A=function(t,o,i,s){t.setStyle("display","flex");let a={value:i,pattern:"[0-9]+|([0-9]+.[0-9]+)",sizeInCharNumber:17},r=e.createElement(t,a,"lineEditor"),l={placeholder:n.getDefaultUnit(o).display,disabled:!0,sizeInCharNumber:5};new UWA.Element("div",{html:"&nbsp;"}).inject(t),e.createElement(t,l,"lineEditor"),N(s,o,r)},O=function(e,t,o,n){let s=1,a=new i({icon:{iconName:"plus"}}).inject(n),r={model:{}};r.model[t.name]="",a.getContent().addEventListener("buttonclick",(function(){T(e.parentElement,t,r,o,s),s++}))},I=function(e,t,o,n){new i({icon:{iconName:"minus"}}).inject(n).getContent().addEventListener("buttonclick",(function(){let e=n.parentElement.id.split("-")[1];o.elements[t.name].splice(e,1),n.parentElement.destroy()}))},N=function(e,t,o){if(n.isMultiValueField(t)&&e.elements[t.name]){if(!Array.isArray(e.elements[t.name])){let o=e.elements[t.name];e.elements[t.name]=[],e.elements[t.name].push(o)}e.elements[t.name].push(o)}else e.elements[t.name]=o},U=function(e){var t=e.editable();t.attachListener(t,"mouseover",(function(e){var t=new CKEDITOR.dom.elementPath(e.data.getTarget(),this).contains("a");t&&t.$&&(t.$.style.cursor="pointer",t.$.style.textDecoration="underline")}),null,null,15),t.attachListener(t,"click",(function(e){var t=new CKEDITOR.dom.elementPath(e.data.getTarget(),this).contains("a");t&&2!=e.data.$.button&&window.open(t.getAttribute("href"))}),null,null,15)},_=function(){let e={element:"priority",type:"buttonToggle",placeholder:"place",required:!1,id:["Low","Medium","High","Urgent"]};e.value=[g.low,g.medium,g.high,g.urgent],e.emphasize=["success","info","medium-attention","high-attention"],e.icons=["level-low","level-medium","level-high","alert"];var t=function(e){var t=new p({type:"radio"}),o=[];let n={Low:0,Medium:1,High:2,Urgent:3}[k._taskGraphModel.options.grid.routeTaskPriority];return null==n&&(n=1),e.value.forEach((function(s,a){var r=new i({label:s,type:"radio",value:e.id[a],icon:{iconName:e.icons[a],fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},emphasize:e.emphasize[a],checkFlag:a===n});r.tooltipInfos=new m({shortHelp:s,allowUnsafeHTMLShortHelp:!0}),t.addEventListener("buttonclick",(function(e){k._taskProperties.elements.routeTaskPriorityValue=e.dsModel.value,u.makeResponsiveCss("routeTaskPanel","#InitiateTaskPropertiesContainer")})),o.push(r),t.addChild(r)})),t}(e);let o=UWA.createElement("div",{id:"priorityDiv",class:"create-task-properties-form-element-priority"});return t.inject(o),o},F=function(e,t){return u.createNewElement(e,t)},P=function(e,t,o){return u.createTooltipElement(e,t,o)},x=function(e){return u.getElementToolTip(e)};return{drawTitleInEditMode:(t,o,i,n)=>function(t,o,i,n){f=F("initiate-Task-Field",t),h=F("initiate-Task-Field-Label",f),w=new UWA.Element("div").inject(f),w.style.width="2%",v=F("initiate-Task-Field-Value",f);let s=new UWA.Element("h5",{class:n,text:g.title}).inject(h);s.tooltipInfos=x(g.title),n&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(s),o.model.title||(o.model.title="");let a={pattern:"[^./#,\\[\\]\\$\\^@\\*\\?%:'\"\\\\<>]+",sizeInCharNumber:30,value:o.model.title};i.elements.title=e.createElement(t,a,"lineEditor"),i.elements.title.inject(v),S=P("taskTitleInfo",g.initiateTaskTitleHelp,h)}(t,o,i,n),drawOrderInEditMode:(t,o,i,n)=>function(t,o,i,n){f=F("initiate-Task-Field",t),h=F("initiate-Task-Field-Label",f),w=new UWA.Element("div").inject(f),w.style.width="2%",v=F("initiate-Task-Field-Value",f);let s=new UWA.Element("h5",{class:n,text:g.taskOrder}).inject(h);s.tooltipInfos=x(g.taskOrder),n&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(s);let a={pattern:"[0-9]+",sizeInCharNumber:1,value:o.model.taskOrder};i.elements.order=e.createElement(v,a,"lineEditor"),S=P("taskOrder",g.initiateTaskOrder,h)}(t,o,i,n),drawAssigneeInEditMode:(e,o,n,s,u,c,p)=>function(e,o,n,s,u,c,p){f=F("initiate-Task-Field",e),h=F("initiate-Task-Field-Label",f),w=new UWA.Element("div").inject(f),w.style.width="2%",v=F("initiate-Task-Field-Value",f);let m=new UWA.Element("h5",{class:s,text:g.taskassignee}).inject(h);m.tooltipInfos=x(g.taskassignee),s&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(m);var k,T={};T.isMultiSearchMode=!1,T.placeHolderValue=g.searchTaskAssigneePlaceHolder,T.minLengthToType=3,T.isFreeInputAllowed=!1,"OnPremise"!=d.getTenantValue()&&(T.source=["3dspace","usersgroup"]),T.getPrecond=function(){return l.getPrecondForTaskMemberSearch(u)},T.getValidation=function(){return t.validationForAssigneeField(u)},T.getChangeHandler=function(){return t.changeHandlerForAssigneeField(n,u,c)},n.elements.assignee=r.drawAutoCompleteComponent(T),n.elements.assignee.inject(n.taskAssigneeField),new UWA.Element("div",{html:"&nbsp;"}).inject(n.taskAssigneeField),null!=p&&""!=p&&(k=new a({isSelected:!0,label:p,value:o.model.assigneeId,name:o.model.taskAssigneeUsername,type:o.model.assigneeType}),n.elements.assignee.selectedItems=k),n.elements.taskAssigneeChooser=new i({icon:{iconName:"search"}}),n.elements.taskAssigneeChooser.inject(n.taskAssigneeField),n.elements.taskAssigneeChooser.getContent().addEventListener("buttonclick",(function(){if("undefined"!=typeof dscef){let e={taskProperties:n,taskGraphModel:c,invokeFrom:"form",routeInfo:u};widget.routeMgmtMediator.publish("launch-task-assignee-search",e)}else t.launchAssigneeSearch(event,n,u,c)})),n.taskAssigneeField.inject(v),S=P("taskAssigneeSearchInfo",g.initiateTaskAssignee,h)}(e,o,n,s,u,c,p),drawCustomFieldsInEditMode:(e,t,o,i)=>T(e,t,o,i),drawLabelInEditMode:(e,t,o,i)=>function(e,t,o,i){let s=n.getFieldType(t),a=!0;if(n.isReadOnlyField(t)||"Toggle"!==s||(a=!1),a){let o=n.isMandatoryField(t)?"required":"",i=new UWA.Element("h5",{class:o,text:t.label}).inject(e);i.tooltipInfos=x(t.label),o&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(i)}}(e,t),drawTaskComments:(e,t)=>function(e,t){var o="../../ENORouteMgmt/assets/ckeditor/";CKEDITOR.plugins.addExternal("autogrow",o+"plugins/autogrow/","plugin.js"),CKEDITOR.plugins.addExternal("routecustmaximize",o+"plugins/maximize/","plugin.js"),e.replace("ckeditorTaskComment"),e.config.toolbar=[{name:"links",items:["Link","Unlink"]},{name:"tools",items:["Maximize"]}],e.config.title="",e.config.removeButtons="Cut,Copy,Paste,Undo,Redo,Anchor,Underline,Strike,Subscript,Superscript,|",e.config.removeDialogTabs="link:advanced;link:target",e.config.removePlugins="image,forms,elementspath,magicline,maximize",e.config.extraPlugins=["autogrow","routecustmaximize"],e.config.enterMode=e.ENTER_BR,e.config.uiColor="#ffffff",e.config.resize_enabled=!1,e.config.height=100,e.config.autoGrow_minHeight=100,e.config.startupFocus=!0,CKEDITOR.on("instanceReady",(function(e){if("Assigned"==k.data.model.current){CKEDITOR.instances.ckeditorTaskComment.setData(k.data.model.comments);let e=document.querySelector("#RouteTaskPropertiesBody .cke_button_icon.cke_button__maximize_icon");e&&e.classList.add("wux-ui-3ds","wux-ui-3ds-2x","wux-ui-3ds-resize-fullscreen");var t=CKEDITOR.instances.ckeditorTaskComment;t.on("contentDom",(function(){U(t)}))}})),CKEDITOR.on("dialogDefinition",(function(e){var t=e.data.name,o=e.data.definition;"link"==t&&o.getContents("info").get("linkType").items.splice(1,3)})),setTimeout((()=>{CKEDITOR.instances.ckeditorTaskComment.on("change",(function(){let e=document.getElementById("RouteTaskPropertiesFooter");!e||0!=widget.getValue("RouteTaskTabs-ShowView")&&1!=widget.getValue("RouteTaskTabs-ShowView")||(e.style.display="block","ENOTASK_AP"==widget.getValue("appId")&&(e.getChildren()[0].style.display="none",e.getChildren()[1].style.display="inline-flex",e.getChildren()[2].style.display="inline-flex",k.collabTaskModel.set("inboxTaskModified",!0)))}))}),1e3)}(e),drawTaskReviewComments:(e,t)=>function(e,t){var o="../../ENORouteMgmt/assets/ckeditor/";CKEDITOR.plugins.addExternal("autogrow",o+"plugins/autogrow/","plugin.js"),CKEDITOR.plugins.addExternal("routecustmaximize",o+"plugins/maximize/","plugin.js"),e.replace("ckeditorTaskReviewComment"),e.config.toolbar=[{name:"links",items:["Link","Unlink"]},{name:"tools",items:["Maximize"]}],e.config.title="",e.config.removeButtons="Cut,Copy,Paste,Undo,Redo,Anchor,Underline,Strike,Subscript,Superscript",e.config.removeDialogTabs="link:advanced;link:target",e.config.removePlugins="image,forms,elementspath,magicline,maximize",e.config.extraPlugins=["autogrow","routecustmaximize"],e.config.enterMode=e.ENTER_BR,e.config.uiColor="#ffffff",e.config.resize_enabled=!1,e.config.height=100,e.config.autoGrow_minHeight=100,e.config.autoGrow_onStartup=!1,e.config.startupFocus=!0,CKEDITOR.on("instanceReady",(function(e){if("Review"==k.data.model.current){CKEDITOR.instances.ckeditorTaskReviewComment.setData(k.data.model.reviewersComments);let e=document.querySelector("#RouteTaskPropertiesBody .cke_button_icon.cke_button__maximize_icon");e&&e.classList.add("wux-ui-3ds","wux-ui-3ds-2x","wux-ui-3ds-resize-fullscreen");var t=CKEDITOR.instances.ckeditorTaskReviewComment;t.on("contentDom",(function(){U(t)}))}})),CKEDITOR.on("dialogDefinition",(function(e){var t=e.data.name,o=e.data.definition;"link"==t&&o.getContents("info").get("linkType").items.splice(1,3)})),setTimeout((()=>{CKEDITOR.instances.ckeditorTaskReviewComment.on("change",(function(){let e=document.getElementById("RouteTaskPropertiesFooter");!e||0!=widget.getValue("RouteTaskTabs-ShowView")&&1!=widget.getValue("RouteTaskTabs-ShowView")||(e.style.display="block","ENOTASK_AP"==widget.getValue("appId")&&(e.getChildren()[0].style.display="none",e.getChildren()[1].style.display="inline-flex",e.getChildren()[2].style.display="inline-flex",k.collabTaskModel.set("inboxTaskModified",!0)))}))}),1e3)}(e),drawTaskPriorityInEditMode:()=>_()}})),define("DS/ENORouteMgmt/Views/Menu/TaskPanelContextualMenu",["DS/Controls/Button","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Views/Dialogs/ChangeAssignee","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","DS/ENORouteMgmt/Views/Form/TaskProperties","DS/ENORouteMgmt/Views/Form/CreateTaskProperties","DS/RouteWebAppUX/Views/Menu/AttachmentContextualMenuItems","DS/ENORouteMgmt/Utilities/RouteRefreshUtils","DS/ENORouteMgmt/Controller/CollabTaskServicesController","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/ENORouteMgmt/Views/Dialogs/DeleteTask","DS/ENORouteMgmt/Views/Dialogs/InitiateRouteDialog","DS/Menu/Menu","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h){"use strict";let w=function(e,t,o){let i=!1;"taskEditMode"!=t||e.options.grid.id||(i=!0),("create"==t||"showTaskRemove"===o&&"taskEditMode"==t)&&(i=!0);let n=v(e);if(i&&n)return!0},v=function(e){if(e.options){let t=e.options.grid.templateTask,o=e.options.grid.isInitialTask,i=e.options.grid.taskEditSetting;if("Yes"===t||"Yes"===o&&e.routePropertiesInfo&&null==e.routePropertiesInfo.model.templateTaskEditSetting)switch(i){case"Modify Task List":case"Extend Task List":case"Maintain Exact Task List":return!1;default:return!0}}return!0},S=function(e,t){null==e.getTreeDocument().options.graphType||"edit"!=e.getTreeDocument().options.graphType&&"create"!=e.getTreeDocument().options.graphType?require(["DS/ENORouteMgmt/Views/Dialogs/DeleteGridTaskDialog"],(function(e){e.showConfirmationDialog()})):require(["DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils"],(function(o){o.postDeleteAction(),!e.options.grid.id||"taskEditMode"!=t.mode&&"create"!=t.mode?widget.routeMgmtMediator.publish("delete-task-success",e):m.deleteTask(e)}))},k=function(t){var o={};o.id=t.routePropertiesInfo.id;var i={};i.id=t.options.grid.id,i.needsOwnerReview=t.options.grid.needsOwnerReview,i.currentState=t.options.grid.current;let n=new c;n.inject(document.body);let s=h.AutoCompleteTitle+t.options.grid.title;new p({modalFlag:!0,width:400,height:150,title:s,content:h.AutoCompleteContent,immersiveFrame:n,resizableFlag:!0,buttons:{Ok:new e({onClick:function(e){u.completeTask(i).then((e=>{d.refreshRouteData(o),widget.routeMgmtMediator.publish("redraw-graph",t.options.grid)}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",title:h.taskCompletedError,message:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:h.taskCompletedError,sticky:!1})})),e.dsModel.dialog.close()}}),Cancel:new e({label:h.cancel,onClick:function(e){e.dsModel.dialog.close()}})}})},T=function(e,t,o){let i=!1;"taskActionMode"==t&&(i=!0),e.routePropertiesInfo&&"Route Template"==e.routePropertiesInfo.model.Type&&"Inactive"!=e.routePropertiesInfo.model.actualState&&(i=!1);let n=function(e){if(e.options){let t=e.options.grid.templateTask,o=e.options.grid.isInitialTask,i=e.options.grid.taskEditSetting,n=e.options.grid.type,s=e.options.grid.routeOwnerTask;if("Yes"===t&&"TRUE"==s)return!0;if("Yes"===t&&"Route Node"==n)return"Modify/Delete Task List"==i||"Modify Task List"==i;if("Yes"===o&&"Route Node"==n&&e.routePropertiesInfo&&null==e.routePropertiesInfo.model.templateTaskEditSetting)return"Modify/Delete Task List"==i||"Modify Task List"==i}return!0}(e);return i=!(!i||!n),i},R=function(e){let t=0,o=0;if(1==e.length)return!1;for(let i=0;i<e.length-1;i++){let n=e[i].getAllDescendants();if(n.length>0)for(let e=0;e<n.length;e++){t++,"Auto Complete"==n[e]._options.grid.approvalStatus&&o++}}return o!=t-1};return{renderHeaderCheveronIcon:e=>function(e){UWA.createElement("div",{id:"taskViewPanelChevron",title:h.taskActions,class:"wux-ui-3ds wux-ui-3ds-3x wux-ui-3ds-chevron-down fonticon-display fonticon-color-display",styles:{"font-size":"20px",float:"right"},events:{click:function(a){var r=a.target.getBoundingClientRect(),d={position:{x:r.left+20,y:r.top+30}};let u=e._taskGraphModel;var c=[];let p=[];if(p=e.data.model.taskDetailsList,"create"==e.mode)p=[],p.push("showTaskRemove");else if(null==p){p=[];let t=e.data.model.taskDetails;if(null!=t)for(let e of t)p.push(e.split("~")[0]);else p.push("showTaskRemove")}null!=u.options.grid.taskSubRoutes&&u.options.grid.taskSubRoutes.length>0&&c.push({name:h.approvalProcess,title:h.approvalProcess,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-route"},data:null,action:{callback:function(){s.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Approval Process"});var e={route:[]},t=u.options.grid.taskSubRoutes;e.taskTitleForSubRoute=u.options.grid.title,e.taskIdForSubRoute=u.options.grid.id;for(let o=0;o<t.length;o++)e.route.push({dataelements:{id:t[o].routeId,name:t[o].routeName,approvalTaskId:t[o].approvalTaskId}});require(["DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils"],(function(t){t.openRouteTaskApprovalProcess(e)}))}}});let m=!1;if("taskActionMode"==e.mode&&"ENOTASK_AP"!=widget.getValue("appId")&&(m=R(t.getTaskTreeDocument().getChildren())),p.forEach(((t,o)=>{"ENOTASK_AP"!=widget.getValue("appId")&&"isRouteOwner"===t&&"Assigned"==u.options.grid.current&&"In Process"==u.routePropertiesInfo.model.state&&"taskActionMode"==e.mode&&"Stopped"!=u.routePropertiesInfo.model.Activity_State&&"Maintain Exact Task List"!=u.options.grid.taskEditSetting&&m&&("Extend Task List"!=u.options.grid.taskEditSetting||"Extend Task List"==u.options.grid.taskEditSetting&&"No"==u.options.grid.templateTask&&"No"==u.options.grid.isInitialTask)&&c.push({name:"MarkasComplete",title:h.markasCompleteTitle,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-status-change"},data:null,action:{callback:function(){s.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Mark as Complete"}),k(u)}}}),"showTaskRemove"===t&&w(u,e.mode,t)?c.push({type:"PushItem",title:h.Delete,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash"},action:{callback:function(t){s.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Delete"}),S(u,e)}}}):"canChangeAssignee"===t&&T(u,e.mode,t)&&c.push({type:"PushItem",title:"TRUE"==u.options.grid.routeOwnerTask?h.selectAssignee:h.changeAssignee,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-user-change"},action:{callback:function(e){"TRUE"==u.options.grid.routeOwnerTask?s.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Select Assignee"}):s.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Change Assignee"}),n.changeAssignee(u)}}})})),"true"==e._taskGraphModel.options.grid.taskAcceptLink&&"Assigned"==e._taskGraphModel.options.grid.current&&c.push({type:"PushItem",title:h.accepTask,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-user-ok"},action:{callback:function(t){s.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Accept Task"}),o.taskAccept({model:e._taskGraphModel.options.grid},e._taskGraphModel.routePropertiesInfo,"callFromMenu")}}}),"ENOTASK_AP"!=widget.getValue("appId")&&"Assigned"==e._taskGraphModel.options.grid.current&&e._taskGraphModel.options.grid.taskDetails&&o.canPerformTaskAction(e._taskGraphModel.options.grid.taskDetails)&&"taskActionMode"==e.mode&&i.getLoginUser()==e._taskGraphModel.options.grid.taskAssigneeUsername&&c.push({name:h.subRouteCommand,title:h.subRouteCommand,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-plus"},data:null,action:{callback:function(){s.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Create Subroute"});let t=e._taskGraphModel.options.grid.physicalid;null==t&&(t=e._taskGraphModel.options.grid.id);var o={inboxTaskId:t,parentRouteId:e._taskGraphModel.routePropertiesInfo.id,inboxTaskTitle:e._taskGraphModel.options.grid.title,parentRouteTaskDueDate:e._taskGraphModel.options.grid.taskDueDate};widget.setValue("isDialogOpened",!0),g.InitiateRouteDialog(o)}}}),"taskActionMode"==e.mode&&"Inbox Task"==e._taskGraphModel.options.grid.type){let t=e._taskGraphModel.options.grid,o=[{options:{grid:{Title:t.title,id:t.id,Type:t.type}}}];c=c.concat(l.getCopyLink(o))}(c=c.concat()).length>0&&f.show(c,d)}}}).inject(e._taskProperties.formHeader)}(e)}})),define("DS/ENORouteMgmt/Model/RouteInfoModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Utilities/PlaceHolder","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s){"use strict";let a=new e;return{createModel:(e,o)=>function(e,o){return a.prepareUpdate(),e.forEach((function(e){var o=new t({label:e.Title,width:300,grid:{id:e.id,Title:e.Title,Name:e.Name,Type:e.Type},subLabel:e.Title,icons:[e.TypeIconSmall],contextualMenu:["My context menu"]});""===e[0]&&(o._isHidden=!0),a.addRoot(o)})),a.pushUpdate(),a}(e),getModel:()=>a,getSelectedRowsModel:()=>o.getSelectedRowsModel(a),destroy:()=>{a=new e}}})),define("DS/ENORouteMgmt/Views/Dialogs/RemoveContent",["DS/WAFData/WAFData","UWA/Core","DS/ENORouteMgmt/EnoviaBootstrap","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Model/RouteContentModel","DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Views/Grid/RouteContentsDataGridView","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Config/RemoveContentGridViewConfig","DS/ENORouteMgmt/Model/RemoveRouteContentConfirmationModel","DS/Controls/ButtonGroup","DS/Controls/Toggle","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h){"use strict";let w,v,S={},k=function(e){if(void 0===e.data&&(e=r.getSelectedRowsModel()),e.data.length<1)return void widget.notify.handler().addNotif({level:"error",subtitle:h.ErrorContentRemoveSelection,sticky:!0});for(var t=[],o=[],a=[],u=[],g=[],f=[],w=0;w<e.data.length;w++)if(f.push(e.data[w].options.grid),f[w].typeicon=e.data[w].options.icons[0],"false"==e.data[w].options.grid.canDeleteContent||"Attachment"==e.data[w].options.grid.RelationValue){a.push(e.data[w].id),u.push(e.data[w].options.grid.Title);var k=l.tileView();g.push(k.TreedocModel.routeModel.Title)}else{t.push(e.data[w].options.grid.id),o.push(e.data[w].options.grid.Title);k=l.tileView();g.push(k.TreedocModel.routeModel.Title)}let R=new n;R.inject(document.body);let y=new UWA.Element("div",{id:"content",class:""}),b=new UWA.Element("div",{id:"removeContentWarning",class:""});b.inject(y),p[5].visibleFlag=!1;var M,D,C,E,A="",O="",I=!1;if(b.appendChild(UWA.createElement("div",{class:"warningicon",html:[{tag:"img",src:c.getWebappsAssetUrl("ENORouteMgmt","icons/32/MOM-Alerts.png")}]})),1==e.data.length)1==t.length?(M=400,D="auto",A=(A=h.removeContentHeaderSingle).replace("{count}",o),O=(O=(O=h.removeContentDetailSingle).replace("{content}",o)).replace("{route}",g),b.appendChild(UWA.createElement("div",{class:"",html:O}))):(I=!0,A=h.removeContentHeader2,O=(O=h.removeContentWarningDetailSingle).replace("{content}",u),b.appendChild(UWA.createElement("div",{class:"",html:O})));else{m.createModel(f);let e=m.getModel(),i=(C=e,E=UWA.createElement("div",{id:"removeRoute-dataGridViewContainer",class:"removeRoute-gridView-View"}),S.cellDragEnabledFlag=!1,S.showRowBorderFlag=!0,S.showOutlineFlag=!0,S.showAlternateBackgroundFlag=!0,S.layoutOptions={rowsHeader:!1,columnsHeader:!0,rowSpacing:5,cellWidth:2},S.showContextualMenuColumnFlag=!1,d.confirmationDialogueBuild(C,p,!1,E,S));M="auto",D="auto";let n=t.length+a.length;n<5?i.setStyle("height",50*n+"px"):i.setStyle("height","200px"),y.appendChild(i),a.length>0&&(p[5].visibleFlag=!0),0==t.length?(A=h.removeContentHeader2,b.appendChild(UWA.createElement("div",{class:"",html:h.removeContentWarningDetail})),new UWA.Element("div",{html:"&nbsp;"}).inject(b),new UWA.Element("div",{html:"&nbsp;"}).inject(b),I=!0):(A=1==t.length?(A=h.removeContentHeaderSingle).replace("{count}",o):(A=h.removeContentHeader).replace("{count}",t.length),O=(O=h.removeContentDetail).replace("{route}",g[0]),b.appendChild(UWA.createElement("div",{class:"",html:O})),new UWA.Element("div",{html:"&nbsp;"}).inject(b))}new UWA.Element("div",{html:"&nbsp;"}).inject(b),v=new i({modalFlag:!0,width:M,height:D,title:A,content:y,domId:"RouteImmersiveFrame",immersiveFrame:R,resizableFlag:!0,buttons:{Ok:new s({label:h.remove,domId:"RemoveContentButton",disabled:I,onClick:function(e){e.dsModel.dialog;T(t)}}),Cancel:new s({label:h.cancel,onClick:function(e){e.dsModel.dialog.close()}})}})},T=function(e){var i=(new a).createDataWithIdForRequest(e),n=l.tileView(),s=n.TreedocModel.RouteId,d=n.TreedocModel.routeModel.Title,u=o.getRouteServiceBaseURL()+"/"+s+"/contents",c={};(c=t.extend(c,o.getSyncOptions(),!0)).method="DELETE",c.type="json",c.timeout=0,c.headers={"Content-Type":"application/ds-json"},c.wait=!0,c.data=JSON.stringify(i),c.onComplete=function(t){widget.notify.handler().addNotif({level:"success",subtitle:h.successRemoveContent,sticky:!0}),r.deleteSelectedRows(),widget.routeMgmtMediator.publish("route-content-preview-delete",{model:{ids:e}})},c.onFailure=function(e,t,o){if(t.error){let e=t.error;t.internalError&&t.internalError.indexOf("#1500028")>=0&&t.internalError.indexOf("No todisconnect access to object")>0?e=h.errorNoDissconnectAccess:t.internalError&&t.internalError.indexOf("#1500219")>=0&&t.internalError.indexOf("Business object has no relationship 'Object Route'")>0&&(e=h.replace(h.errorRemovedContent,{tag1:d})),widget.notify.handler().addNotif({level:"error",subtitle:e,sticky:!0})}else widget.notify.handler().addNotif({level:"error",subtitle:h.errorRemoveContent,sticky:!0})},o.authenticateRequest(u,c),v.close()};return w={removeConfirmation:e=>k(e),getDialog:()=>v},w})),define("DS/ENORouteMgmt/Views/Menu/InitiateRouteContentContextualMenu",["DS/Menu/Menu","DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils","DS/ENORouteMgmt/Model/InitiateRouteContentModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i){"use strict";let n,s=function(){var e=[];return e.push({name:i.deleteContent,title:i.deleteContent,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove"},data:null,action:{callback:function(){require(["DS/ENORouteMgmt/Views/InitiateRouteContentsView"],(function(e){e.removeContents()}))}}}),e};return n={InitiateContentGridRightClick:(i,n)=>function(i,n){i.preventDefault(),i.stopPropagation();var a=i.target.getBoundingClientRect(),r={position:{x:a.left,y:a.top+20}},l=[];o.getSelectedRowsModel().data.length<2&&(l=l.concat(t.getBlockingMaturityContextualMenu(n,"InitiateRoute"))),l=l.concat(s()),e.show(l,r)}(i,n)},n})),define("DS/ENORouteMgmt/Config/RemoveTaskGridViewConfig",["DS/ENORouteMgmt/Views/Grid/RouteTasksGridCustomColumns","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";return[{text:t.title,dataIndex:"tree",pinned:"left",editableFlag:!1},{text:t.revision,dataIndex:"revision",editableFlag:!1},{text:t.IDcardMaturityState,dataIndex:"stateNLS",editableFlag:!1,onCellRequest:e.onRemoveRouteTaskStateCellRequest},{text:t.accessCheck,dataIndex:"Deleteicon",typeRepresentation:"user",editableFlag:!1}]})),define("DS/ENORouteMgmt/Config/RouteInfoGridViewConfig",["DS/ENORouteMgmt/Model/RouteInfoModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";return[{text:t.title,dataIndex:"tree",editableFlag:!1}]})),define("DS/ENORouteMgmt/Views/Grid/InitiateRouteContentsDataGridView",["DS/ENORouteMgmt/Config/InitiateRouteContentsViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Config/Toolbar/InitiateRouteContentTabToolbarConfig","DS/ENORouteMgmt/Utilities/DragAndDropManager"],(function(e,t,o,i){"use strict";let n,s={},a=function(){let o=t.dataGridView();for(let t=0;t<e.length;t++)o.layout.setColumnVisibleFlag(e[t].dataIndex,e[t].visibility)};return{build:r=>function(r){var l=UWA.createElement("div",{id:"dataGridViewContainer",class:"iContents-gridView-View showView"});let d=o.writetoolbarDefination();s.cellDragEnabledFlag=!0;let u=t.build(r,e,d,l,s);return a(),n=t.dataGridView(),n.onDragStartCell=function(e,t){return i.getContentForDrag(e,t),!0},n.onDragEndCell=function(e,t){e.target.removeClassName("wux-ui-state-activated wux-ui-state-highlighted")},u}(r),getGridViewToolbar:()=>t.dataGridViewToolbar()}})),define("DS/ENORouteMgmt/Config/RouteTasksGridViewConfig",["DS/ENORouteMgmt/Views/Grid/RouteTasksGridCustomColumns","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t){"use strict";return[{text:t.order,dataIndex:"taskOrder",pinned:"left",width:"50px"},{text:t.title,dataIndex:"tree",pinned:"left"},{text:t.revision,dataIndex:"revision",width:"70px"},{text:t.taskAction,dataIndex:"taskActionNLS",width:"110px"},{text:t.IDcardMaturityState,dataIndex:"currentNLS",width:"100px",onCellRequest:e.onRouteTaskStateCellRequest},{text:t.approvalStatus,dataIndex:"awaiting_taskApprovalStatus",width:"125px"},{text:t.priority,dataIndex:"routeTaskPriorityNLS",width:"125px",editableFlag:!1,typeRepresentation:"user"},{text:t.subRouteApprovalStatus,dataIndex:"subRouteGridApprovalStatus",width:"125px",getCellTypeRepresentation:function(t){return e.getCellTypeRepresentation(t)}},{text:t.searchTaskAssignee,dataIndex:"taskAssignee",editableFlag:!1,onCellRequest:e.onRouteTaskAssigneeCellRequest},{text:t.dueDateAndTime,dataIndex:"taskDueDate",onCellRequest:e.onRouteTaskDueDateCellRequest},{text:t.comments,dataIndex:"comments",width:"133px",allowUnsafeHTMLContent:!0}]})),define("DS/ENORouteMgmt/Views/Grid/RouteTasksDataGridView",["DS/ENORouteMgmt/Config/RouteTasksGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Config/Toolbar/RouteTasksTabToolbarConfig","DS/ENORouteMgmt/Views/Grid/RouteTasksGridCustomColumns","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n){"use strict";let s,a;return{build:(r,l)=>function(r,l){let d=widget.getValue("TasksTab-ShowView"),u="Tasks-gridView-View hideView";d&&"GridView"==d&&(u="Tasks-gridView-View showView");var c=UWA.createElement("div",{id:"dataGridViewContainer",class:u});let p=o.writetoolbarDefination(r,l);var m=e.slice(0,e.length);r.getChildren().forEach((e=>{"TRUE"==e.options.grid.routeOwnerTask&&"routeOwnerUGTitle"!=m[m.length-1].dataIndex&&m.push({text:n.assignmentScope,dataIndex:"routeOwnerUGTitle",onCellRequest:i.onRouteTaskAssignmentScopeCellRequest})})),l.model.TemplateId&&""!=l.model.TemplateId&&m.push({text:n.generatedFromTemplate,dataIndex:"templateTask"}),"Route Template"==l.model.Type&&(m=m.filter((function(e,t,o){if("revision"!=e.dataIndex&&"awaiting_taskApprovalStatus"!=e.dataIndex&&"comments"!=e.dataIndex&&"subRouteGridApprovalStatus"!=e.dataIndex)return e})),r.parentType="Route Template");let g=t.build(r,m,p,c,{identifier:"RouteTasksDataGridView"});return s=t.dataGridViewToolbar(),a=t.dataGridView(),g}(r,l),getGridViewToolbar:()=>s,getDataGridInstance:()=>a}})),define("DS/ENORouteMgmt/Views/ToggleTaskViews",["DS/ENORouteMgmt/Views/Grid/RouteTasksDataGridView","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o){"use strict";let i,n,s,a,r;return{doToggleView:function(l){let d={};if(d.initialValue=a=l.view,d.event="TaskView","GridView"==a?d.switchValue="Switch to Grid View":"GraphView"==a&&(d.switchValue="Switch to Graph View"),t.sendRouteTrackerEvent(d),s=e.getGridViewToolbar().getNodeModelByID("view"),i=".Tasks-gridView-View",n=".canvas",r="#task-graph-toolbar",e.getDataGridInstance().getModel().getFilterViewManager().filterManager.isDataFiltered()&&0==e.getDataGridInstance().getModel().getRowModelLength()&&"GridView"!=l.view)widget.notify.handler().addNotif({level:"warning",subtitle:o.tileViewTaskWarningDetails,sticky:!1});else if(widget.setValue("TasksTab-ShowView",l.view),"GridView"==l.view){s.options.grid.data.menu[1].state="selected",s.options.grid.data.menu[0].state="unselected",s&&"view-list"!=s.options.grid.semantics.icon.iconName&&s.updateOptions({grid:{semantics:{icon:{iconName:"view-list"}}}});let e=document.querySelector(i);e&&(e.removeClassName("hideView"),e.removeClassName("nonVisible"),e.addClassName("showView"));let t=document.querySelector(n);if(t){t.removeClassName("showView"),t.addClassName("hideView");let e=document.querySelector(r);e&&(e.removeClassName("showView"),e.addClassName("hideView"))}}else if("GraphView"==l.view){s.options.grid.data.menu[1].state="unselected",s.options.grid.data.menu[0].state="selected",s&&"view-small-tile"!=s.options.grid.semantics.icon.iconName&&s.updateOptions({grid:{semantics:{icon:{iconName:"flow-tree"}}}});let e=document.querySelector(i);e&&(e.removeClassName("showView"),e.addClassName("hideView"));let t=document.querySelector(n);if(t){t.removeClassName("hideView"),t.addClassName("showView");let e=document.querySelector(r);e&&(e.removeClassName("hideView"),e.addClassName("showView"))}let o=document.querySelector("#task-graph-toolbar"),a=document.querySelector(".no-tasks-to-show-container");o&&null==a&&o.show()}},getViewType:function(){return null==a?widget.getValue("TasksTab-ShowView"):a},resetViewType:function(){a=void 0}}})),define("DS/ENORouteMgmt/Model/RouteTaskModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/DataFormatter","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/Commands/RouteTaskApprovalProcess","DS/ENORouteMgmt/Views/ToggleTaskViews","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d,u,c){"use strict";let p=new e,m=function(e,t){let o=e.subRouteApprovalStatus,i=l.getRouteActivityStateNLS(o),n={icon:l.getRouteActivityStateIcon(o),label:i};return o&&o.contains("your")&&(n.func=function(o){t.taskTitleForSubRoute=e.title,t.taskIdForSubRoute=e.id,t.fromPage="hyperlink",d.getApprovalCommandMenu(t,"openInboxTask").action.callback()},n.icon+=" awaiting-tasks"),n},g=function(e){let t=e.routeTaskPriority,o=c[e.routeTaskPriority.toLowerCase()],i=function(e){return{Low:{icon:"level-low",emphasize:"success"},Medium:{icon:"level-medium",emphasize:"info"},High:{icon:"level-high",emphasize:"medium-attention"},Urgent:{icon:"alert",emphasize:"high-attention"}}[e]}(t);return{icon:i.icon,emphasize:i.emphasize,label:o}},f=function(e){return i.getRowModelById(p,e)},h=function(){p.subscribe({event:"filter"},(function(){setTimeout((function(){p.__visibilityMap__&&p.__visibilityMap__.forEach(((e,t)=>{!1===e&&t.unselect()}))}),1e3)}))};return{createModel:e=>function(e){p.prepareUpdate();let r=o.getTaskTreeDocument().getChildren();if(r)for(let o=1;o<r.length-1;o++){let i=r[o].getAllDescendants();if(i)for(let o=0;o<i.length;o++){let r=i[o].options.grid;if("UG Action Node"==r.nodeType||"Task Action Node"==r.nodeType)continue;let d={route:[]};if(null!=r.taskSubRoutes){let e=r.taskSubRoutes;for(let t=0;t<e.length;t++)d.route.push({dataelements:{id:e[t].routeId,name:e[t].routeName,approvalTaskId:e[t].approvalTaskId}})}let u=a.getApprovalStatusForTask1(r,e.model);r.awaiting_taskApprovalStatus=c[u],null!=r.subRouteApprovalStatus&&""!=r.subRouteApprovalStatus?r.subRouteGridApprovalStatus=m(r,d):r.subRouteGridApprovalStatus="",null!=r.routeTaskPriority&&""!=r.routeTaskPriority&&(r.routeTaskPriorityNLS=g(r));var l=new t({label:r.title,graphNodeId:i[o]._id,id:r.id,width:300,grid:n.taskGridData(r),icons:[s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTask16.png")]});l.options.getAttributeValueForFiltering=function(e){var t=n.taskGridData(r);switch(e){case"label":return t.title;case"taskAssignee":if("Person"===t.assigneeType)return"Route Template"==p.parentType&&"TRUE"==t.routeOwnerTask?c.routeOwnerTask:t.taskAssignee;if("Group"===t.assigneeType)return t.assigneeTitle;case"routeTaskPriorityNLS":return t.routeTaskPriorityNLS.label;default:return t[e]}},p.addRoot(l)}}return p.setFilterModel({taskOrder:{filterId:"set"},label:{filterId:"stringRegexp"},revision:{filterId:"set"},taskActionNLS:{filterId:"set"},currentNLS:{filterId:"set"},awaiting_taskApprovalStatus:{filterId:"set"},subRouteGridApprovalStatus:{filterId:"set"},taskAssignee:{filterId:"set"},comments:{filterId:"stringRegexp"},routeOwnerUGTitle:{filterId:"stringRegexp"},templateTask:{filterId:"set"},routeTaskPriorityNLS:{filterId:"set"}}),p.pushUpdate(),i.dataGridView()&&i.dataGridView().reapplySortModel(),h(),p}(e),updateModel:e=>function(e){p.prepareUpdate(),p.removeRoots();let r=o.getTaskTreeDocument().getChildren();if(r)for(let o=1;o<r.length-1;o++){let i=r[o].getAllDescendants();if(i)for(let o=0;o<i.length;o++){let r=i[o].options.grid;if("UG Action Node"==r.nodeType||"Task Action Node"==r.nodeType)continue;let d={route:[]};if(null!=r.taskSubRoutes){let e=r.taskSubRoutes;for(let t=0;t<e.length;t++)d.route.push({dataelements:{id:e[t].routeId,name:e[t].routeName,approvalTaskId:e[t].approvalTaskId,activityState:e[t].activityState}})}let u=a.getApprovalStatusForTask1(r,e.model);r.awaiting_taskApprovalStatus=c[u],null!=r.subRouteApprovalStatus&&""!=r.subRouteApprovalStatus?r.subRouteGridApprovalStatus=m(r,d):r.subRouteGridApprovalStatus="",null!=r.routeTaskPriority&&""!=r.routeTaskPriority&&(r.routeTaskPriorityNLS=g(r));var l=new t({label:r.title,graphNodeId:i[o]._id,id:r.id,width:300,grid:n.taskGridData(r),icons:[s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTask16.png")]});null==l.options.label&&(l.options.label=c.taskTitlePlaceholder),l.options.getAttributeValueForFiltering=function(e){var t=n.taskGridData(r);switch(e){case"label":return t.title;case"taskAssignee":if("Person"===t.assigneeType)return"Route Template"==p.parentType&&"TRUE"==t.routeOwnerTask?c.routeOwnerTask:t.taskAssignee;if("Group"===t.assigneeType)return t.assigneeTitle;case"routeTaskPriorityNLS":return t.routeTaskPriorityNLS.label;default:return t[e]}},p.addRoot(l)}}if(p.pushUpdate(),i.dataGridView()&&i.dataGridView().reapplySortModel(),null!=p&&null!=widget.data.inboxTaskSelectedId&&"GridView"==u.getViewType()){let e=p.getChildren();for(var d=0;d<e.length;d++)if(e[d].options.id==widget.data.inboxTaskSelectedId){e[d].select(!0),widget.data.inboxTaskSelectedId=void 0;break}}return p}(e),getModel:()=>p,getRowModelById:e=>f(e),getSelectedRowsModel:()=>i.getSelectedRowsModel(p),destroy:()=>{p=new e},appendRows:e=>{return o=e,p.prepareUpdate(),o.forEach((e=>{var o=new t({label:c.taskTitlePlaceholder,graphNodeId:e._id,id:e.options.grid.id,width:300,grid:n.taskGridData(e.options.grid),icons:[s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTask16.png")]});p.addRoot(o)})),void p.pushUpdate();var o},updateAssignee:e=>function(e){if(e.id&&""!=e.id){var t=e.taskAssigneeName,o=e.taskAssigneeUserName,i=f(e.taskId),n=i.options.grid;n.assigneeTitle=t,n.assigneeType=e.newAssigneeType,n.taskAssignee=t,n.taskAssigneeUsername=o,n.assigneePID=e.newAssigneeId,n.assigneeId=e.newAssigneeId,n.taskAcceptLink=e.taskAcceptLink,n.routeOwnerTask=e.routeOwnerTask,n.routeOwnerUGChoice=e.routeOwnerUGChoice,n.routeOwnerUGName=e.routeOwnerUGName,n.routeOwnerUGTitle=e.routeOwnerUGTitle,"TRUE"!=e.routeOwnerTask&&(n.taskActionNLS=c[n.taskAction],"Route Node"==e.type?n.awaiting_taskApprovalStatus=void 0:"Inbox Task"==e.type&&(n.awaiting_taskApprovalStatus=c[a.getApprovalStatusForTask(n,"Started")])),i.updateOptions({grid:n})}}(e),deleteRowModelById:e=>function(e){i.deleteRowModelById(p,e)}(e),getTaskGridPriority:e=>g(e)}})),define("DS/ENORouteMgmt/Views/InitiateRouteContentsView",["DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/Accordeon","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Utilities/Dom","DS/TreeModel/TreeDocument","DS/ENORouteMgmt/Model/InitiateRouteContentModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Views/Menu/InitiateRouteContentContextualMenu","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Views/Grid/InitiateRouteContentsDataGridView","DS/ENORouteMgmt/Utilities/DragAndDrop","DS/ENORouteMgmt/Utilities/DragAndDropManager","DS/ENORouteMgmt/Controller/RouteServicesController","DS/Controls/TooltipModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h,w,v){"use strict";let S,k=function(e,t){f.onDropManager(e,void 0,"initiate route content")},T=function(e){let t=function(){let e=UWA.createElement("div",{class:"create-iRouteContent-help-content",html:[UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-info fonticon-display fonticon-color-display"})]});return e.tooltipInfos=new w({shortHelp:v.initiateContentHelp,allowUnsafeHTMLShortHelp:!0}),UWA.createElement("div",{class:"create-iRouteContent-view",html:[UWA.createElement("div",{class:"create-iRouteContent-element initiate-routeContent-view-toolbar-help-group",html:[{tag:"div",class:"create-iRouteContent-toolbar-gridview-group"},{tag:"div",class:"create-iRouteContent-help",html:[e]}]})]})}().inject(e),o=m.build(S),i=m.getGridViewToolbar();y();let n=UWA.createElement("div",{id:"dataGridInitiateRouteDivToolbar",class:"initiateRoute-toolbar-container"}).inject(document.querySelector(".create-iRouteContent-toolbar-gridview-group"));i.inject(n);let s=UWA.createElement("div",{id:"idataGridButtonDiv",class:"dataGrid-button-container"}).inject(document.querySelector(".create-iRouteContent-toolbar-gridview-group"));o.inject(s),0==S.getChildren().length&&p.showEmptyInitiateRouteContentPlaceholder(document.querySelector(".dataGrid-button-container")),p.registerListeners(),M();t.querySelector(".create-iRouteContent-toolbar-gridview-group");g.makeDroppable(t,k)},R=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&c.InitiateContentGridRightClick(e,t.nodeModel.options.grid)},y=function(){u.dataGridView().addEventListener("contextmenu",R)},b=function(){return d.getModel()},M=function(){widget.routeMgmtMediator.subscribe("initiateRoute-on-ScopeSelection",(function(e){let t=b().contentIds;d.deleteAllRows(),function(e,t){b().scopeId=e.scopeId,b().scopePhyId=e.scopePhyId,b().contentIds=t}(e,t)})),widget.routeMgmtMediator.subscribe("initiateRouteClearContent-on-createAnother",(function(){d.getContentIDs().length>0&&d.deleteAllRows()}))};return{build:(e,t,o)=>function(e,t,o){if(t){let i=[];return t.forEach((e=>{i.push(e.id)})),new Promise((function(e,o){h.fetchStateBlockingConditions(i).then((o=>{for(var i=0;i<o.length;i++){let e=t.find((e=>e.id==o[i].physicalid));e.maturityBlockingStates=o[i].maturityBlockingStates,e.maturityTargetStates=o[i].maturityTargetStates,e.RouteBaseState=o[i].RouteBaseState,e.RouteBaseState_NLS=o[i].RouteBaseState_NLS,e.RouteTargetState=o[i].RouteTargetState,e.RouteTargetState_NLS=o[i].RouteTargetState_NLS,e.current=o[i].current}e()}))})).then((()=>{S=d.createModel(),S.contentIds=t,S.scopeId=o.scopeId,S.scopePhyId=o.scopePhyId,T(e),S=d.appendRow(t)}))}S=d.createModel(t),S.contentIds=t,S.scopeId=o.scopeId,S.scopePhyId=o.scopePhyId,T(e)}(e,t,o),destroy:()=>{d.destroy()},getModel:()=>b(),onSearchClick:()=>onSearchClick(),removeContents:()=>{d.getSelectedRowsModel().data.length<1?widget.notify.handler().addNotif({level:"error",subtitle:v.ErrorContentRemoveSelection,sticky:!0}):S=d.deleteSelectedRows()}}})),define("DS/ENORouteMgmt/Views/Loader/RouteContextObjectChooser",["DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i){"use strict";let n,s=!1;var a=function(e,o){var i;o&&(i=new t({label:o[0]["ds6w:label"],value:o[0].id,status:o[0]["ds6w:status"],category:o[0]["ds6w:category"]}),s=!0,n.selectedItems=i)};let r=function(e){if(null==e){widget.routeMgmtMediator.publish("welcome-panel-action-selected",{id:"routes"})}else require(["DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/RouteSummaryView","DS/ENORouteMgmt/Model/RouteModel"],(function(t,i,n){let s=function(e){var t=[];let o;for(var i=0;i<e.length;i++){var n={};n.id=e[i],t.push(n)}return o={data:t},o}([e]);return new Promise((function(e,a){t.fetchApprovalStatusForContent(s).then((e=>{let t=e.data[0].relateddata.route;if(0==t.length){var s=n.getModel();s.prepareUpdate(),s.removeRoots(),s.pushUpdate();let e=document.querySelector(".widget-container");null!=e&&(0==t.length?o.showEmptyRoutePlaceholder(e,s):o.hideEmptyRoutePlaceholder(e)),n.appendAllRows(t)}else{var a=[];let e,o=[];for(var r=0;r<t.length;r++){var l={};l.id=t[r].dataelements.id,a.push(l),o.push(t[r].dataelements.id)}e={data:a},widget.setValue("approvalProcessIds",o),widget.setValue("approvalProcessType","Route"),i.loadSubscribedData("summary-onchange"),n.getModel().setFilterModel({label:{filterId:"stringRegexp"},Name:{filterId:"stringRegexp"},Maturity_State:{filterId:"set"},BasePurposeNLS:{filterId:"set"},Activity_StateNLS:{filterId:"set"},Description:{filterId:"stringRegexp"},revisionValue:{filterId:"set"},AssigneesDiv:{filterId:"set"},Owner:{filterId:"set"}})}}),(t=>{widget.notify.handler().addNotif({level:"success",subtitle:NLS.errorMessage,sticky:!0}),e()}))}))}))};return{init:(t,o)=>function(t,o){n=o;var s=t.dsModel,r=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],(function(t){var o=t.createSocket({socket_id:r});let n=i.getRouteContentSearchTypes();var l=n?n.split(","):"",d=e.getRefinementToSnN(r,"searchObjects",!1,l);if(d.precond=e.getPrecondForContextSearch("is_95_rel_95_objectroute",l),!UWA.is(o))throw new Error("Socket not initialized");o.dispatchEvent("RegisterContext",d),o.addListener("Selected_Objects_search",a.bind(s,"")),o.dispatchEvent("InContextSearch",d)}))}(t,o),filterByObjectOnChange:e=>function(e){var t=e.dsModel.value;null!=t?widget.setValue("linkedContextTitle",e.dsModel.selectedItems.options.label):(widget.setValue("linkedContextTitle",void 0),widget.setValue("isWidgetRefreshed","true")),r(t),s&&(s=!1)}(e),loadSelectedContextRoutes:e=>r(e)}})),define("DS/ENORouteMgmt/Views/Menu/ContentContextualMenuItems",["DS/ENORouteMgmt/Views/Dialogs/RemoveContent","DS/ENORouteMgmt/Commands/RouteOpenWith","DS/UIKIT/Input/Text","DS/UIKIT/Input/Button","DS/UIKIT/Dropdown","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/CopyLinkContentAppId","DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete","DS/ENORouteMgmt/Views/Loader/ChangeTaskAssigneeChooser","DS/ENORouteMgmt/Views/Form/TaskProperties","DS/EditPropWidget/constants/EditPropConstants","DS/ENORouteMgmt/Utilities/RouteTaskPanelChangeUtils","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/Utilities/DragAndDropOnTaskInputField","DS/ENORouteMgmt/Utilities/Search/DndSearchUtil","DS/TransientWidget/TransientWidget","DS/LifecycleControls/EditPropDialog","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h,w){"use strict";let v,S=d.getTaskVaribles(),k=function(t,o){var i=[];return t&&i.push({name:w.deleteContent,title:w.deleteContent,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove"},data:null,action:{callback:function(){e.removeConfirmation(o)}}}),i},T=function(e,t){if("taskAssigneesId"==t.getParent().id)t="#taskAssigneesId",g.manageMemberDragAndDrop(e,v,t);else if("droppable_TaskViewContentAttachment"==t.getChildren()[0].id){let o=S._taskProperties;t="droppable_TaskViewContentAttachment",o.routeInfo=S._routeInfo,g.getResultFromSearch(e,o,t)}},R=function(e,t){var o=[];return e&&o.push({name:w.deleteContent,title:w.deleteContent,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove"},data:null,action:{callback:function(){t()}}}),o},y=function(e,t,o){var i=[];return e&&i.push({name:w.deleteContent,title:w.deleteContent,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove"},data:null,action:{callback:function(){t(o)}}}),i},b={addPreviewCommand:(e,t)=>function(e,t){let o=e.Preview,i={name:o.name,title:o.title,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x fonticon-"+o.fonticon},action:{callback:o.handler}};return t.push(i),t}(e,t),addDownloadCommand:(e,t)=>function(e,t){let o=e.Download,i={name:o.name,title:o.title,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x fonticon-"+o.fonticon},action:{callback:o.handler}};return t.push(i),t}(e,t),deleteMenu:e=>function(e){var t=!0;return e.data.forEach((e=>{"false"==e._options.grid.canDeleteContent&&(t=!1)})),k(t,e)}(e),deleteMenuForTile:e=>function(e){var t=!0;return e.forEach((e=>{"false"==e.canDeleteContent&&(t=!1)})),k(t,e)}(e),previewMenu:e=>function(e){var t=[];return t.push({name:w.contentPreview,title:w.contentPreview,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-info"},data:null,action:{callback:function(){widget.routeMgmtMediator.publish("route-content-preview-click",{model:{id:e}})}}}),t}(e),getOpenWithMenu:e=>function(e){let o=[];return new Promise((function(i,n){t.getOpenWithMenu(e).then((e=>{e&&e.length>0&&o.push({id:"OpenWith",type:"PushItem",title:w.openWith,icon:"open-menu-dot wux-ui-3ds",submenu:e}),i(o)}),(e=>{i(o)}))}))}(e),addUpdateOrEditCommand:(e,t,o)=>function(e,t,o){let i=e.Edit;if(i){let e={name:i.name,title:i.title,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x fonticon-"+i.fonticon},action:{callback:i.handler}};t.push(e)}let n=e.Update;if(n){let e={name:n.name,title:n.title,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x fonticon-"+n.fonticon},action:{callback:n.handler}};t.push(e)}let s=e.UndoEdit;if(s){let e={name:s.name,title:s.title,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x fonticon-"+s.fonticon},action:{callback:s.handler}};t.push(e)}return t}(e,t),deleteMenuForAttachments:(e,t)=>function(e,t){var o=!0;return e.forEach((e=>{"false"==e.canDeleteContent&&(o=!1)})),R(o,t)}(e,t),deleteMenuForRouteTaskContentToReview:(e,t,o)=>function(e,t,o){var i=!0;return e.forEach((e=>{"false"==e.canDeleteContent&&(i=!1)})),y(i,t,o)}(e,t,o),informationPanelCommand:(e,t,o)=>function(e,t,o){var i=[];return"Person"==t?i.push({name:w.viewProfile,title:w.viewProfile,type:"PushItem",fonticon:{content:"fonticon fonticon-eye"},data:null,action:{callback:function(){if(null!=s.getSwymUrl())f.showWidget("X3DPRFL_AP","",{login:o,url:s.getSwymUrl()+"?profile="+o},{mode:"panel",height:700,width:800});else{var t={_context:s.getSecurityContextValue(),_selection:[{getID:function(){return e}}],getSecurityContext:function(){return this._context},getSelectedNodes:function(){return this._selection},displayNotification:function(){}};require(["DS/LifecycleControls/EditPropDialog"],(function(e){(new e).launchProperties(t)}))}}}}):"Group"!==t&&"User Group"!==t&&"Group Proxy"!==t||i.push({name:w.showMembers,title:w.showMembers,type:"PushItem",fonticon:{content:"fonticon fonticon-users-group"},data:null,action:{callback:function(){p.launchPreviewGroupMembers(e)}}}),i}(e,t,o),addRoutePropertiesCommand:e=>function(e){var t=[];return t.push({name:w.infoPropertiesTab,title:w.infoPropertiesTab,type:"PushItem",fonticon:{content:"fonticon fonticon-attributes"},data:null,action:{callback:function(){var t={_context:s.getSecurityContextValue(),_selection:[{getID:function(){return e}}],getSecurityContext:function(){return this._context},getSelectedNodes:function(){return this._selection},displayNotification:function(){}};require(["DS/LifecycleControls/EditPropDialog"],(function(e){(new e).launchProperties(t)}))}}}),t}(e),getAssigneeRemoveCtxMenu:(e,t)=>{return(o=[]).push({name:w.deleteContent,title:w.deleteContent,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove"},data:null,action:{callback:function(){let e=document.createElement("div"),t=document.getElementById("taskAssigneesId");t.parent=e;var o={isMultiSearchMode:!1};o.placeHolderValue=w.searchAssignee,o.minLengthToType=3,o.isFreeInputAllowed=!1,o.toKeepSearchResultsFlag=!1,"OnPremise"!=s.getTenantValue()&&(o.source=["3dspace","usersgroup"]),o.getPrecond=function(){return l.getPrecondForChangeAssigneeSearch(S.taskGraphModel.model.routePropertiesInfo,S.taskGraphModel.model.model)},o.getChangeHandler=function(){return l.changeHandlerForChangeMembersSearch(v)},v=r.drawAutoCompleteComponent(o),v.options.scope=S._routeInfo.Scope,v.options.ScopeMembers=S._routeInfo.ScopeMembers,t.empty(),v.inject(t),S.membersInfo=v,c.updateTaskPanelFooter();let i=v.elements.container;m.makeDroppable(i,T)}}}),o;var o},collabTaskInformationMenu:e=>function(e){var t=[];return t.push({name:w.contentPreview,title:w.contentPreview,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-info"},data:null,action:{callback:function(){var t={_context:s.getSecurityContextValue(),_selection:[{getID:function(){return e}}],getSecurityContext:function(){return this._context},getSelectedNodes:function(){return this._selection},displayNotification:function(){}};(new h).launchProperties(t)}}}),t}(e)};return b})),define("DS/ENORouteMgmt/Views/Menu/ContentContextualMenu",["DS/Menu/Menu","DS/ENORouteMgmt/Actions/ContentActions","DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils","DS/ENORouteMgmt/Views/Dialogs/RemoveContent","DS/ENORouteMgmt/Model/RouteContentModel","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Commands/RouteOpenWith","DS/ENORouteMgmt/Views/Menu/ContentContextualMenuItems","DS/ENORouteMgmt/Utilities/RouteDocumentUtils","DS/ENORouteMgmt/Utilities/CopyLinkContentAppId","DS/RouteWebAppUX/Views/Menu/AttachmentContextualMenuItems","DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils","DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel","DS/ENORouteMgmt/Views/Form/TaskProperties","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g){"use strict";let f,h,w,v,S=[],k=function(e,t,o,i,n){var s=[];h&&l.getCommands(w,v,h,t,(function(t){-1!==e.indexOf("Preview")&&-1!==e.indexOf("Download")&&(s=t),i(s)}),n)},T=function(t,o,i,n,s,a){let l=m.getTaskVaribles();i.preventDefault(),i.stopPropagation();let c=i.target.getBoundingClientRect(),p={position:{x:c.left,y:c.top+20}},g=[],f=[];g.push(t[0].options.grid);let h=t[0].options.grid.assigneeType,w=t[0].options.grid.assigneeName;if(1===t.length){f=f.concat(r.informationPanelCommand(n,h,w)),"Assignee"==t[0].options.grid.fieldType&&"Person"===h&&R(l,"view")&&l.data.model.taskDetailsList.includes("canChangeAssignee")&&(f=f.concat(r.getAssigneeRemoveCtxMenu(t,o)));var v=g[0].Type;"true"==d.isCopyLink(v)&&(f=f.concat(u.getCopyLink(t))),e.show(f,p)}},R=function(e,t){let o=!1;"view"==t&&(o=!0),e._routeInfo&&"Route Template"==e._routeInfo.Type&&"Inactive"!=e._routeInfo.actualState&&(o=!1);let i=y(e);return o=!(!o||!i),o},y=function(e){if(e.data){let t=e.data.model.templateTask,o=e.data.model.isInitialTask,i=e.data.model.taskEditSetting,n=e.data.model.type,s=e.data.model.routeOwnerTask;if("Yes"===t&&"TRUE"==s)return!0;if("Yes"===t&&"Route Node"==n)return"Modify/Delete Task List"==i||"Modify Task List"==i;if("Yes"===o&&"Route Node"==n&&e._routeInfo&&null==e._routeInfo.templateTaskEditSetting)return"Modify/Delete Task List"==i||"Modify Task List"==i}return!0},b=function(t,o,i,n,s,a){i.preventDefault(),i.stopPropagation();let l=i.target.getBoundingClientRect(),c={position:{x:l.left,y:l.top+20}},p=[],m=[];if(p.push(t[0].options.grid),1===t.length){m=m.concat(r.addRoutePropertiesCommand(n));var g=p[0].Type;"true"==d.isCopyLink(g)&&(m=m.concat(u.getCopyLink(t))),r.getOpenWithMenu(o).then((function(t){m=m.concat(t),e.show(m,c)}))}},M=function(t,o,i,n,s,a,l){i.preventDefault(),i.stopPropagation();let c=i.target.getBoundingClientRect(),p={position:{x:c.left,y:c.top+20}},m=[],g=[],f=["Remove","Download","Preview"];if(m.push(t[0].options.grid),1===t.length){"ENXROUT_AP"==widget.getValue("appId")?g=g.concat(r.previewMenu(n)):"ENOTASK_AP"==widget.getValue("appId")&&(g=g.concat(r.collabTaskInformationMenu(n)));var w=m[0].Type;"true"==d.isCopyLink(w)&&(g=g.concat(u.getCopyLink(t))),r.getOpenWithMenu(o).then((function(t){g=g.concat(t),h?k(f,n,0,(function(t){g=g.concat(t),s||(g=g.concat(r.deleteMenuForAttachments(m,a))),e.show(g,p)}),l):(s||(g=g.concat(r.deleteMenuForAttachments(m,a))),e.show(g,p))}))}else s||(g=g.concat(r.deleteMenuForAttachments(m,a))),e.show(g,p)},D=function(t,o,i,n,s,a,l){i.preventDefault(),i.stopPropagation();let c=i.target.getBoundingClientRect(),p={position:{x:c.left,y:c.top+20}},m=[],g=[],f=[];if(m.push(t[0].options.grid),1===t.length){"ENXROUT_AP"==widget.getValue("appId")&&(g=g.concat(r.previewMenu(n)));var w=m[0].Type;"true"==d.isCopyLink(w)&&(g=g.concat(u.getCopyLink(t))),r.getOpenWithMenu(o).then((function(t){g=g.concat(t),h?(("Document"==w||S.includes(w))&&(f=["Download","Preview"]),k(f,n,0,(function(t){g=g.concat(t),e.show(g,p)}),l)):e.show(g,p)}))}},C=function(t,o,i,n,s,a,l,c){i.preventDefault(),i.stopPropagation();let p=i.target.getBoundingClientRect(),m={position:{x:p.left,y:p.top+20}},g=[],f=[],w=[];if(g.push(t[0].options.grid),1===t.length){"ENXROUT_AP"==widget.getValue("appId")?f=f.concat(r.previewMenu(n)):"ENOTASK_AP"==widget.getValue("appId")&&(f=f.concat(r.collabTaskInformationMenu(n)));var v=g[0].Type;"true"==d.isCopyLink(v)&&(f=f.concat(u.getCopyLink(t))),r.getOpenWithMenu(o).then((function(t){f=f.concat(t),h?(("Document"==v||S.includes(v))&&(w=["Download","Preview"]),k(w,n,0,(function(t){f=f.concat(t),!s&&g[0].canDeleteContent&&(f=f.concat(r.deleteMenuForRouteTaskContentToReview(g,a,c))),e.show(f,m)}),l)):(s||(f=f.concat(r.deleteMenuForRouteTaskContentToReview(g,a,c))),e.show(f,m))}))}else s||(f=f.concat(r.deleteMenuForRouteTaskContentToReview(g,a,c))),e.show(f,m)};return f={contentContextualMenu:(e,t,o)=>k(e,t),contentsGridRightClick:(t,i,s,a)=>function(t,i,s,a){t.preventDefault(),t.stopPropagation();var l=t.target.getBoundingClientRect(),p={position:{x:l.left,y:l.top+20}},m=n.getSelectedRowsModel(),g=[],f=[];1===m.data.length?(g=g.concat(r.previewMenu(i.id)),"true"==d.isCopyLink(i.Type)&&(g=g.concat(u.getCopyLink(m.data))),g=(g=g.concat(o.getBlockingMaturityContextualMenu(i,"RouteContent",s,a))).concat(c.getTargetMaturityContextualMenu(i,"RouteContent",s,a)),r.getOpenWithMenu(m.data[0]).then((function(t){g=g.concat(t),h?(("Document"==i.Type||S.includes(i.Type))&&(f=["Download","Preview"]),k(f,i.id,0,(function(t){g=(g=g.concat(t)).concat(r.deleteMenu(m)),e.show(g,p)}))):(g=g.concat(r.deleteMenu(m)),e.show(g,p))}))):(g=g.concat(r.deleteMenu(m)),e.show(g,p))}(t,i,s,a),isDocumentManagementInstalled:()=>{require(["DS/DocumentCommands/DocumentCommandsV2","DS/DocumentCommands/TypeDerivativesCache","DS/DocumentCommands/Constants","DS/CoreEvents/ModelEvents"],(function(e,t,o,i){h=e,w=o,v=i;let n=["Document"];t.getTypeDerivatives(n,(function(e){S=e[n[0]]}),s.get3DSpaceURL())}),(function(e){widget.notify.handler().addNotif({level:"error",subtitle:g.documentManagementNotInstalled,sticky:!1})}))},tileContextualMenu:(t,i,n)=>function(t,i,n){let s=t.data.event;s.preventDefault(),s.stopPropagation();var a=s.target.getBoundingClientRect(),l={position:{x:a.left,y:a.top+20}},p=[],m=[],g=[],f=t.cellInfos.nodeModel?t.cellInfos.nodeModel:t.cellInfos.cellModel;if(t&&t.cellInfos&&t.cellInfos.cellModel){var w=i.getSelectedNodes(),v=w[0].options.grid.Type;if(g.push(w[0].options.grid),m="Document"==v||S.includes(v)?["Remove","Download","Preview"]:["Remove"],1===w.length){var T=w[0]._options.grid.id;p=p.concat(r.previewMenu(T));var R=g[0].Type;"true"==d.isCopyLink(R)&&(p=p.concat(u.getCopyLink(w)));var y="",b="";i&&i.routeModel&&(y=i.routeModel.state,b=i.routeModel),p=(p=p.concat(o.getBlockingMaturityContextualMenu(w[0]._options.grid,"RouteContent",y,b))).concat(c.getTargetMaturityContextualMenu(w[0]._options.grid,"RouteContent",y,b)),r.getOpenWithMenu(f).then((function(t){p=p.concat(t),h?k(m,T,0,(function(t){p=(p=p.concat(t)).concat(r.deleteMenuForTile(g)),e.show(p,l)}),n):(p=p.concat(r.deleteMenuForTile(g)),e.show(p,l))}))}else p=p.concat(r.deleteMenuForTile(g)),e.show(p,l)}}(t,i,n),taskAttachmentContextualMenu:(e,t,o,i,n)=>function(e,t,o,i,n){let s=e.data.event,a=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(e&&e.cellInfos&&e.cellInfos.cellModel){let e=t.getTreeDocument().getSelectedNodes(),r=e[0]._options.grid.id;M(e,a,s,r,o,i,n)}}(e,t,o,i,n),taskAttachmentGridRightClick:(e,t,o,i)=>function(e,t,o,i){let s=n.getSelectedRowsModel();s.length>0&&M(s,s.data[0],e,t.id,o,i)}(e,t,o,i),taskContentToReviewContextualMenu:(e,t,o,i,n)=>function(e,t,o,i,n){let s=e.data.event,a=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(e&&e.cellInfos&&e.cellInfos.cellModel){let e=t.getTreeDocument().getSelectedNodes(),r=e[0]._options.grid.id;D(e,a,s,r,o,i,n)}}(e,t,o,i,n),routeTaskContentToReviewContextualMenu:(e,t,o,i,n,s)=>function(e,t,o,i,n,s){let a=e.data.event,r=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(e&&e.cellInfos&&e.cellInfos.cellModel){let e=t.getTreeDocument().getSelectedNodes(),l=e[0]._options.grid.id;C(e,r,a,l,o,i,n,s)}}(e,t,o,i,n,s),routeTaskContentToReviewGridRightClick:(e,t,o,i,n)=>function(e,t,o,i,n){let s=p.getSelectedRowsModel();s.length>0&&C(s,s.data[0],e,t.id,o,i,n)}(e,t,o,i,n),taskAssigneeContextualMenu:(e,t,o,i)=>function(e,t,o,i){let n=e.data.event,s=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(e&&e.cellInfos){let e=t.getTreeDocument().getSelectedNodes(),a="",r=e[0]._options.grid.assigneeType;a="Group"===r||"User Group"===r||"Group Proxy"===r?e[0]._options.grid.ugUUID:e[0]._options.grid.assigneePID,T(e,s,n,a,o,i)}}(e,t,o,i),taskAssigneeGridRightClick:(e,t,o)=>function(e,t,o,i){let n=t.getTreeDocument().getSelectedNodes(),s="";if(n[0]){let a=n[0]._options.grid.assigneeType;s="Group"===a||"User Group"===a||"Group Proxy"===a?n[0]._options.grid.ugUUID:n[0]._options.grid.assigneePID,T(n,t,e,s,o,i)}}(e,t,o),routeInfoContextualMenu:(e,t,o,i)=>function(e,t,o,i){let n=e.data.event,s=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(e&&e.cellInfos&&e.cellInfos.cellModel){let e=t.getTreeDocument().getSelectedNodes(),a=e[0]._options.grid.id;b(e,s,n,a,o,i)}}(e,t,o,i)},f})),define("DS/ENORouteMgmt/Views/Loader/InitiateDocumentContentToReviewChooser",["DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/TreeModel/TreeNodeModel","DS/TreeModel/TreeDocument","DS/ENORouteMgmt/Model/InitiateRouteContentModel","DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a){"use strict";let r;var l=function(e,o){for(var i=0;i<o.length;i++){var n,s=o[i];s&&((n=new t({label:s["ds6w:label"],value:s.id})).options.grid.id=s.id,n.options.grid.name=s["ds6w:identifier"],n.options.grid.stateNLS=s["ds6w:status"],n.options.grid.title=s["ds6w:label"],n.options.grid.type=s["ds6w:type"],n.options.grid.created=s["ds6w:created"],n.options.grid.modified=s["ds6w:modified"],n.options.grid.type_icon_url=s.type_icon_url,n.options.grid.owner=s["ds6w:responsible"],n.options.grid.ownerName=s.owner,n.options.grid.policy=s["ds6w:policy"],n.options.grid.state=s["ds6w:status"],n.options.grid.revision=s["ds6wg:revision"],n.options.grid.reserved=s["ds6w:reserved_value"],n.options.grid.reservedBy=s["ds6w:reservedBy"],n.options.grid.reservedByUserName=s.file_locked_by,null==r.selectedItems?r.selectedItems=n:r.selectedItems.push(n),r._applySelectedItems())}};return{init:(t,o,a,d,u)=>function(t,o,a,d,u){r=o;var c=[],p=[];if("create"!=d)for(var m=n.getModel().getChildren(),g=0;g<m.length;g++)p.push(m[g]._options.grid.id);if(c=p,"create"==d){var f=i.getRouteContentIds();for(g=0;g<f.length;g++)c.push(f[g])}null!=r&&null!=r.selectedItems&&0!=r.selectedItems.length&&r.selectedItems.forEach((function(e){c.push(e.options.value)}));var h=t.dsModel;let w=s.getRouteContentSearchTypes();var v=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],(function(t){var o=t.createSocket({socket_id:v}),i=w?w.split(","):"",n=u.scopeId;null==n&&(n="All"==u.Scope[0]||"Organization"==u.Scope[0]?u.Scope[0]:u.Scope[2]);var s=e.getRefinementToSnN(v,"addContent",!0,i);if(s.precond=e.getPrecondForContentSearch(n,i,u.organization),s.resourceid_not_in=c,!UWA.is(o))throw new Error("Socket not initialized");o.dispatchEvent("RegisterContext",s),o.addListener("Selected_Objects_search",l.bind(h,"")),o.dispatchEvent("InContextSearch",s)}))}(t,o,0,d,u),populateAddExisiting:(e,t)=>function(e,t){let o=[],i=e.attachedDocuments;r=e.autoCompleteComponent;let n=[];null!=i&&(o=JSON.parse(JSON.stringify(i))),null!=r&&null!=r.selectedItems&&0!=r.selectedItems.length&&r.selectedItems.forEach((function(e){null==e.options.value.name&&o.push(e.options.value)}));for(var s=0;s<t.length;s++){var a=t[s];o.includes(a.id)||(o.push(a.id),n.push(a))}l("",n)}(e,t)}})),define("DS/ENORouteMgmt/Views/Grid/TaskAttachmentsDataGridView",["DS/ENORouteMgmt/Config/TaskAttachmentsGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Views/Menu/ContentContextualMenu","DS/ENORouteMgmt/Model/TaskAttachmentModel","DS/ENORouteMgmt/Utilities/RouteTaskPanelChangeUtils","DS/ENORouteMgmt/Utilities/DragAndDropManager"],(function(e,t,o,i,n,s){"use strict";let a,r={},l=!1,d=function(i,n){l=!!n;var d=UWA.createElement("div",{id:"taskAttachments-dataGridViewContainer",class:"taskAttachments-gridView-View"});r.cellDragEnabledFlag=!0,r.showRowBorderFlag=!0,r.showOutlineFlag=!0,r.showAlternateBackgroundFlag=!1;r.layoutOptions={rowsHeader:!1,columnsHeader:!1,rowSpacing:5,cellWidth:2},r.showContextualMenuColumnFlag=!0,r.onContextualEvent=function(e){e&&e.cellInfos&&o.taskAttachmentContextualMenu(e,e.cellInfos.nodeModel,l,p,(function(e){console.log("asd")}))};let u=t.build(i,e,!1,d,r);return a=t.dataGridView(),a.onDragStartCell=function(e,t){return s.getContentForDrag(e,t),!0},c(),require(["DS/ENORouteMgmt/Views/Menu/ContentContextualMenu"],(function(e){e.isDocumentManagementInstalled()})),u},u=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&require(["DS/ENORouteMgmt/Views/Menu/ContentContextualMenu"],(function(o){o.taskAttachmentGridRightClick(e,t.nodeModel.options.grid,l,p)}))},c=function(){t.dataGridView().addEventListener("contextmenu",u),widget.routeMgmtMediator.subscribeOnce("triptych-resized",(function(e){m()})),widget.routeMgmtMediator.subscribeOnce("task-attachment-height-update",(function(e){m()}))},p=function(){i.deleteSelectedRows(),m(),n.updateTaskPanelFooter()},m=function(){var e=document.querySelector("#taskAttachments-dataGridViewContainer");let t=a.getRowModelLength();e&&("ENOTASK_AP"==widget.getValue("appId")?e.setStyle("height",46*t+"px"):t<5?e.setStyle("height",41*t+"px"):e.setStyle("height","200px"))},g={build:(e,t)=>d(e,t)};return g})),define("DS/ENORouteMgmt/Views/Grid/RouteTaskContentToReviewDataGridView",["DS/ENORouteMgmt/Config/RouteTaskContentToReviewGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Views/Menu/ContentContextualMenu","DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel","DS/ENORouteMgmt/Utilities/DragAndDropManager"],(function(e,t,o,i,n){"use strict";let s,a,r={},l=!1,d=function(i,d,u){l=!!d,a=u;var m=UWA.createElement("div",{id:"routeTaskContentToReview-dataGridViewContainer",class:"routeTaskContentToReview-gridView-View"});r.cellDragEnabledFlag=!0,r.showRowBorderFlag=!0,r.showOutlineFlag=!0,r.showAlternateBackgroundFlag=!1;r.layoutOptions={rowsHeader:!1,columnsHeader:!1,rowSpacing:5,cellWidth:2},r.showContextualMenuColumnFlag=!0,r.onContextualEvent=function(e){e&&e.cellInfos&&o.routeTaskContentToReviewContextualMenu(e,e.cellInfos.nodeModel,l,p,(function(e){console.log("asd")}),u)};let g=t.build(i,e,!1,m,r);return s=t.dataGridView(),s.onDragStartCell=function(e,t){return n.getContentForDrag(e,t),!0},c(),require(["DS/ENORouteMgmt/Views/Menu/ContentContextualMenu"],(function(e){e.isDocumentManagementInstalled()})),g},u=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&require(["DS/ENORouteMgmt/Views/Menu/ContentContextualMenu"],(function(o){o.routeTaskContentToReviewGridRightClick(e,t.nodeModel.options.grid,l,p)}))},c=function(){t.dataGridView().addEventListener("contextmenu",u),widget.routeMgmtMediator.subscribeOnce("triptych-resized",(function(e){m()})),widget.routeMgmtMediator.subscribe("task-content-height-update",(function(){m()}))},p=function(){var e=i.getSelectedRowsModel();i.deleteSelectedRows(),null==a.removeContentToReview&&(a.removeContentToReview=[]);for(var t=0;t<e.data.length;t++)a.removeContentToReview.push(e.data[t].options.grid.id);m()},m=function(){var e=document.querySelector("#routeTaskContentToReview-dataGridViewContainer");let t=s.getRowModelLength();e&&("ENOTASK_AP"==widget.getValue("appId")?e.setStyle("height",46*t+"px"):t<5?e.setStyle("height",41*t+"px"):e.setStyle("height","200px"))},g={build:(e,t,o)=>d(e,t,o)};return g})),define("DS/ENORouteMgmt/Views/Grid/RouteInfoDataGridView",["DS/ENORouteMgmt/Config/RouteInfoGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Views/Menu/ContentContextualMenu"],(function(e,t,o){"use strict";let i={};return{build:n=>function(n){var s=UWA.createElement("div",{id:"routeInfo-dataGridViewContainer",class:"routeInfo-gridView-View"});return i.cellDragEnabledFlag=!1,i.showRowBorderFlag=!1,i.showOutlineFlag=!0,i.showAlternateBackgroundFlag=!1,i.layoutOptions={rowsHeader:!1,columnsHeader:!1,rowSpacing:5,cellWidth:2},i.showContextualMenuColumnFlag=!0,i.onContextualEvent=function(e){e&&e.cellInfos&&o.routeInfoContextualMenu(e,e.cellInfos.nodeModel,!0,(function(e){console.log("asd")}))},t.build(n,e,!1,s,i)}(n)}})),define("DS/ENORouteMgmt/Views/Form/TaskInViewMode",["DS/ENORouteMgmt/Views/Form/CustomFieldUtils","DS/ENORouteMgmt/Utilities/Utils","DS/WUXAutoComplete/AutoComplete","DS/UIKIT/Input/File","DS/ENORouteMgmt/Views/Loader/InitiateDocumentChooser","DS/TreeModel/TreeNodeModel","DS/TreeModel/TreeDocument","DS/ENORouteMgmt/Services/RouteServices","DS/ENORouteMgmt/Model/TaskAttachmentModel","DS/ENORouteMgmt/Views/Grid/TaskAttachmentsDataGridView","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Model/ContentToReviewModel","DS/ENORouteMgmt/Views/Grid/RouteTaskContentToReviewDataGridView","DS/ENORouteMgmt/Model/InitiateRouteContentModel","DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel","DS/ENORouteMgmt/Views/Loader/InitiateDocumentContentToReviewChooser","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/Controls/Button","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/Model/RouteInfoModel","DS/ENORouteMgmt/Views/Grid/RouteInfoDataGridView","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","DS/Utilities/DateUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h,w,v,S,k,T,R,y,b,M){"use strict";let D,C,E,A,O,I,N=function(e,t,o){o||(o="");let i=new UWA.Element("h5",{class:o,text:t.label}).inject(e);return i.tooltipInfos=x(t.label),i},U=function(e){if(e&&""!=e){let t={datePrecision:"day",dateStyle:"full",timePrecision:"sec"};e=b.formatDateToString(new Date(e),t)}return e},_=function(e){return new i({input:!1,multiple:!0,buttonText:"",buttonClassName:"fonticon fonticon-upload",events:{onChange:function(t){for(var o=0;o<t.target.files.length;o++){var i;i=new s({label:t.target.files[o].name,value:t.target.files[o],grid:{action:"upload"}}),"ENOTASK_AP"==widget.getValue("appId")&&i.options.icons.push(R.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_Document16.png")),i.options.value.options="",null==e.selectedItems?e.selectedItems=i:e.selectedItems.push(i),e._applySelectedItems()}D.elements.input.title=M.upload}}})},F=function(e,t){return S.createNewElement(e,t)},P=function(e,t,o){return S.createTooltipElement(e,t,o)},x=function(e){return S.getElementToolTip(e)};return{drawTitleInViewMode:(e,t,o)=>function(e,t,o){C=F("initiate-Task-Field",e),E=F("initiate-Task-Field-Label",C),A=new UWA.Element("div").inject(C),A.style.width="2%",O=F("initiate-Task-Field-Value",C),new UWA.Element("h5",{class:"",text:M.title}).inject(E).tooltipInfos=x(M.title),new UWA.Element("div",{text:t.model.title,class:"valueReadOnly"}).inject(O).tooltipInfos=x(t.model.title),o.elements.title={value:t.model.title}}(e,t,o),drawOrderInViewMode:(e,t,o)=>function(e,t,o){C=F("initiate-Task-Field",e),E=F("initiate-Task-Field-Label",C),A=new UWA.Element("div").inject(C),A.style.width="2%",O=F("initiate-Task-Field-Value",C);let i=new UWA.Element("h5",{class:"",text:M.taskOrder}).inject(E);i.tooltipInfos=x(M.taskOrder),i=new UWA.Element("div",{text:t.model.taskOrder,class:"valueReadOnly"}).inject(O),i.tooltipInfos=x(t.model.taskOrder),o.elements.order={value:t.model.taskOrder}}(e,t,o),drawAssigneeInViewMode:(e,t,o,i)=>function(e,t,o,i){C=F("initiate-Task-Field",e),E=F("initiate-Task-Field-Label",C),A=new UWA.Element("div").inject(C),A.style.width="2%",O=F("initiate-Task-Field-Value",C);let n=new UWA.Element("h5",{class:"",text:M.taskassignee}).inject(E);var a;n.tooltipInfos=x(M.taskassignee),n=new UWA.Element("span",{text:i,class:"valueReadOnly"}).inject(O),n.tooltipInfos=x(i),null!=i&&""!=i&&(a=new s({label:i,value:t.model.assigneeId,name:t.model.taskAssigneeUsername,type:t.model.assigneeType}),o.elements.assignee={selectedItems:a})}(e,t,o,i),drawCustomFieldsInViewMode:(t,o,i,n)=>function(t,o,i,n){e.getFieldType(o);let s=i.model[o.name];if(e.isDateField(o))if(e.isMultiValueField(o)){let e=[];for(let t=0;t<s.length;t++)e.push(U(s[t]));s=e}else s=U(s);"LineEditor with Unit"==e.getFieldType(o)&&(s+=" "+e.getDefaultUnit(o).display);new UWA.Element("span",{text:s,class:"valueReadOnly"}).inject(t).tooltipInfos=x(s),n.elements[o.name]={value:s}}(t,o,i,n),drawLabelInViewMode:(e,t,o)=>N(e,t,o),drawListOfAttachments:(e,t,o)=>function(e,t,o){var i=new UWA.Element("div",{id:"taskAttachmentsId",class:""});if(C=F("initiate-Task-Field",i),E=F("initiate-Task-Field-Label",C),A=new UWA.Element("div").inject(C),A.style.width="2%",O=F("initiate-Task-Field-Value",C),o){var n={};n.label=M.attachments,N(E,n,"attachmentHeader")}if(e.model.taskAttachments&&e.model.taskAttachments.length>0){l.destroy(),l.createModel(e.model.taskAttachments),l.getModel().RouteId=t.id;let i=l.getModel();d.build(i,o).inject(O)}else o&&new UWA.Element("span",{text:M.noAttachments}).inject(O);return i}(e,t,o),drawListOfRouteTaskContentToReviews:(e,t,o,i)=>function(e,t,o,i){let n=F("initiate-Task-Field",i.formFields),s=F("initiate-Task-Field-Label",n);new UWA.Element("div").inject(n).style.width="2%";let a=F("initiate-Task-Field-Value",n);if(new UWA.Element("div",{id:"routeTaskContentToReviewId",class:""}).inject(n),o){var r={};r.label=M.contentToReview,N(s,r,"contentToReviewHeader")}if(e.model.RouteTaskContentToReview&&e.model.RouteTaskContentToReview.length>0){if(g.destroy(),e.model.routeContents&&e.model.routeContents.length>0){let t=e.model.routeContents,o=e.model.RouteTaskContentToReview,i=[];for(let e=0;e<t.length;e++){let n=!1;for(let i=0;i<o.length;i++)t[e].id==o[i].id&&(n=!0);n||i.push(t[e])}e.model.RouteTaskContentToReview=o.concat(i)}g.createModel(e.model.RouteTaskContentToReview),g.getModel().RouteId=t.id;let n=g.getModel();if(e.model.removeContentToReview&&e.model.removeContentToReview.length>0&&null!=n){n.prepareUpdate();for(var l=n.getChildren(),d=0;d<l.length;d++)-1!=e.model.removeContentToReview.indexOf(l[d]._options.grid.id)&&(n.removeRoot(d),d--);n.pushUpdate()}n&&n.getChildren().length>0&&p.build(n,o,i).inject(a)}else o&&new UWA.Element("span",{text:M.noAttachments}).inject(a);return n}(e,t,o,i),renderAttachmentField:(e,t)=>function(e,t){var o=new UWA.Element("div",{class:"attachmentField"}).inject(t),i={};i.label=M.attachments;var n=N(o,i,"attachmentHeader");I=P("taskAttachmentInfo",M.taskAttachmentInfo,n);var s=new UWA.Element("div",{class:"attachmentButton"}).inject(o);D=_(e.autoCompleteComponent),D.elements.input.title=M.upload,D.inject(s)}(e,t),getAutoComponent:e=>function(e){return new o({multiSearchMode:!0,elementsTree:function(t){return new Promise((function(o,i){var n=[];null!=e.attachedDocuments&&(n=JSON.parse(JSON.stringify(e.attachedDocuments))),null!=e.autoCompleteComponent&&null!=e.autoCompleteComponent.selectedItems&&0!=e.autoCompleteComponent.selectedItems.length&&e.autoCompleteComponent.selectedItems.forEach((function(e){null==e.options.value.name&&n.push(e.options.value)})),u.getSecurityContextValue();var s={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname","ipml_46_iconname"],select_file:["icon","thumbnail_2d"],query:"("+t+' AND NOT (flattenedtaxonomies:"types/Person" OR flattenedtaxonomies:"types/Business Role" OR flattenedtaxonomies:"types/Security Context" OR flattenedtaxonomies:"types/Route" OR flattenedtaxonomies:"types/Route Template" OR flattenedtaxonomies:"types/Inbox Task"))',order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:u.getTenantValue(),resourceid_not_in:n};s=JSON.stringify(s);var a={isfederated:!0};r.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",s,(function(e){var t=[];e&&e.results&&Array.isArray(e.results)&&e.results.forEach((function(e){var o={};e.attributes.forEach((function(e){"ds6w:what/ds6w:type"===e.name&&(o.type=e.value),"resourceid"===e.name&&(o.value=e.value),"ds6w:label"===e.name&&(o.label=e.value),"ds6w:identifier"===e.name&&(o.name=e.value),"ENOTASK_AP"==widget.getValue("appId")&&"type_icon_url"===e.name&&(o.icon=e.value)})),o.data=o,t.push(o)})),o(t)}),(function(e){i(e)}),a)}))},placeholder:M.typeToDropAndSearch,minLengthBeforeSearch:3,allowFreeInputFlag:!1})}(e),renderRouteTaskContentToReviewField:(e,t,o,i)=>function(e,t,o,i){var n=new UWA.Element("div",{class:"contentToReviewField"});n.inject(i);var s=new UWA.Element("div",{class:"contentToReviewFieldLabel"}).inject(n),a={};return a.label=M.contentToReview,N(s,a,"contentToReviewHeader").tooltipInfos=x(M.contentToReview),I=P("taskContentToReviewInfo",M.initiateTaskContentToReview,s),i}(0,0,0,i),getRouteTaskContentToReviewField:(e,t,i,n)=>function(e,t,i,n){return new o({multiSearchMode:!0,elementsTree:function(o){if(w.validationForAssigneeField(t))return new Promise((function(n,l){var d=[],c=[];if("create"!=i)for(var p=g.getModel().getChildren(),f=0;f<p.length;f++)c.push(p[f]._options.grid.id);if(d=c,"create"==i){var w=m.getRouteContentIds();for(f=0;f<w.length;f++)d.push(w[f])}null!=e.contentToReviewField&&null!=e.contentToReviewField.selectedItems&&0!=e.contentToReviewField.selectedItems.length&&e.contentToReviewField.selectedItems.forEach((function(e){d.push(e.options.value)}));var v={};v["3dspace"]={SecurityContext:u.getSecurityContextValue()};var S="",k=y.getRouteContentSearchTypes();k=k?k.split(","):"";var T=t.scopeId;null==T&&(T="All"==t.Scope[0]||"Organization"==t.Scope[0]?t.Scope[0]:t.Scope[2]),S=h.getPrecondForContentSearch(T,k,""),""!=o&&(S="(([ds6w:label]:(*"+o+"*) OR [ds6w:identifier]:(*"+o+"*)) AND "+S+")");var R={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",login:v,select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname","ds6wg:revision","owner","file_locked_by","type_icon_url"],select_file:["icon","thumbnail_2d"],query:S,order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:["3dspace"],tenant:u.getTenantValue(),resourceid_not_in:d};R=JSON.stringify(R);var b={isfederated:!0};r.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",R,(function(e){var t=new a;e&&e.results&&Array.isArray(e.results)&&e.results.forEach((function(e){var o=new s;e.attributes.forEach((function(e){"ENOTASK_AP"==widget.getValue("appId")&&"type_icon_url"===e.name&&(o.options.icon=e.value,o.options.grid.icon=e.value),"ds6w:what/ds6w:type"===e.name?o.options.grid.type=e.value:"resourceid"===e.name?(o.options.value=e.value,o.options.grid.id=e.value):"ds6w:label"===e.name?(o.options.label=e.value,o.options.grid.title=e.value):"ds6w:identifier"===e.name?o.options.grid.name=e.value:"ds6w:what/ds6w:status"===e.name?(o.options.grid.state=e.value,o.options.grid.stateNLS=e.value):"ds6w:when/ds6w:created"===e.name?o.options.grid.created=e.value:"ds6w:when/ds6w:modified"===e.name?o.options.grid.modified=e.value:"type_icon_url"===e.name?o.options.grid.type_icon_url=e.value:"ds6w:who/ds6w:responsible"===e.name?o.options.grid.owner=e.value:"owner"===e.name?o.options.grid.ownerName=e.value:"ds6w:what/ds6w:policy"===e.name?o.options.grid.policy=e.value:"ds6wg:revision"===e.name?o.options.grid.revision=e.value:"ds6w:what/ds6w:status/ds6w:reserved"===e.name?o.options.grid.reserved=e.value:"ds6w:who/ds6w:responsible/ds6w:reservedBy"===e.name?o.options.grid.reservedBy=e.value:"file_locked_by"==e.name&&(o.options.grid.reservedByUserName=e.value)})),t.addRoot(o)})),n(t)}),(function(e){l(e)}),b)}))},placeholder:M.typeToDropAndSearch,minLengthBeforeSearch:3,allowFreeInputFlag:!1,keepSearchResultsFlag:!1})}(e,t,i),drawRouteContentsInTaskViewMode:(e,t,o,i,n)=>function(e,t,o,i,n){var s=new UWA.Element("div",{id:"routeTaskContentToReviewId",class:""});if(C=F("initiate-Task-Field",s),E=F("initiate-Task-Field-Label",C),A=new UWA.Element("div").inject(C),A.style.width="2%",O=F("initiate-Task-Field-Value",C),i){var a={};a.label=M.contentToReview,N(s,a,"contentToReviewHeader").inject(E)}g.destroy(),g.createModel(e.model.routeContents),g.getModel().RouteId=o.id;let r=g.getModel();if(r&&r.getChildren().length>0){let e=p.build(r,i,t);null!=n?e.inject(n):e.inject(O)}return C}(e,t,o,i,n),drawAttachmentSearchExistingButton:e=>function(e){let t=new v({displayStyle:"lite",label:"lite displayStyle",icon:{iconName:"search",fontIconFamily:WUXManagedFontIcons.Font3DS},showLabelFlag:!1});return t.addEventListener("click",(function(t){if("undefined"!=typeof dscef){let t=[],o=e.attachedDocuments,i=e.autoCompleteComponent;null!=o&&(t=JSON.parse(JSON.stringify(o))),null!=i&&null!=i.selectedItems&&0!=i.selectedItems.length&&i.selectedItems.forEach((function(e){null==e.options.value.name&&t.push(e.options.value)}));let n={taskProperties:e,alreadyAttachedDocs:t,invokeFrom:"form"};widget.routeMgmtMediator.publish("launch-add-attachment-search",n)}else n.init(t,e.autoCompleteComponent,e.attachedDocuments)})),t}(e),drawContentToReviewSearchButton:(e,t,o)=>function(e,t,o){let i=new v({icon:{iconName:"search"}});return i.addEventListener("click",(function(i){w.validationForAssigneeField(o)&&f.init(i,e.contentToReviewField,e.attachedContentsToReview,t,o)})),i}(e,t,o),drawRouteInfoDataGrid:(e,t,o)=>function(e,t,o){var i=new UWA.Element("div",{id:"routeTemplateInfoId",class:""});let n="Route"==t.Type?M.routeName:M.templateName;N(i,{label:n},"routeTemplateInfo"),k.destroy(),k.createModel([t]);let s=k.getModel();s&&s.getChildren().length>0&&T.build(s).inject(i);return i}(0,t)}})),define("DS/ENORouteMgmt/Views/Form/RouteTaskPanelFields",["DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Controls/DatePicker","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/ENORouteMgmt/Views/Form/TaskInViewMode","DS/ENORouteMgmt/Views/Form/TaskInEditMode","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Model/ContentToReviewModel","DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel","DS/ENORouteMgmt/Views/Grid/TaskAssociatedContent","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","DS/ENORouteMgmt/Utilities/TaskPanelSubscribeEvents","DS/ENORouteMgmt/Views/Form/TaskProperties","DS/WebappsUtils/WebappsUtils","DS/Controls/Accordeon","DS/ENORouteMgmt/Utilities/Utils","DS/RouteWebAppUX/Views/Menu/AttachmentContextualMenuItems","DS/Menu/Menu","DS/ENORouteMgmt/Views/Menu/TaskPanelContextualMenu","DS/ENORouteMgmt/Utilities/DragAndDropOnTaskInputField","DS/ENORouteMgmt/Utilities/Search/DndSearchUtil","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Utilities/RouteRefreshUtils","DS/ENORouteMgmt/Utilities/RouteTaskPanelChangeUtils","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","DS/Utilities/DateUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h,w,v,S,k,T,R,y,b,M,D,C,E,A,O,I,N,U,_){"use strict";let F,P,x,V,W,L=S.getTaskVaribles(),j=function(){L.taskActionMode=!1,L.taskEditMode=!1,L.fieldViewOnly=!1,L.inboxTaskFieldViewOnly=!1,L.fieldRequired="required",L._taskProperties.closeEventName="route-task-close-click","taskActionMode"==L.mode?(L.fieldViewOnly=!0,L.taskActionMode=!0,L.fieldRequired="",L._taskProperties.closeEventName="route-task-close-click-view-mode"):"taskEditMode"==L.mode&&(L._taskProperties.closeEventName="route-task-close-click-edit-mode",L.taskEditMode=!0,"Auto Complete"==L.data.model.approvalStatus?(L.inboxTaskFieldViewOnly=!0,L.fieldViewOnly=!0):l.canUserEditTask(L.data)?(L.fieldViewOnly=!1,l.canUserEditAllFields(L.data)?L.inboxTaskFieldViewOnly=!1:L.inboxTaskFieldViewOnly=!0):(L.fieldViewOnly=!0,L.fieldRequired="")),UWA.createElement("div",{id:"taskViewPanelClose",title:_.taskFormCloseTooltip,class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-close fonticon-display fonticon-color-display",styles:{"font-size":"20px",float:"right"},events:{click:function(e){widget.routeMgmtMediator.publish(L._taskProperties.closeEventName),v.destroy(L.mode,L)}}}).inject(L._taskProperties.formHeader),"taskActionMode"==L.mode&&"HRL1"==L.data.model.taskAcceptLink&&UWA.createElement("div",{title:_.taskFormAcceptTaskTooltip,class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-user-ok fonticon-display fonticon-color-display",styles:{"font-size":"20px",float:"right"},events:{click:function(e){l.taskAccept(L.data,L._routeInfo,"callFromPanel")}}}).inject(L._taskProperties.formHeader),("Route"==L._routeInfo.Type&&"taskActionMode"==L.mode&&("Complete"!=L._routeInfo.state&&("Inbox Task"==L._taskGraphModel.options.grid.type||"Inbox Task"!=L._taskGraphModel.options.grid.type&&("No"==L._taskGraphModel.options.grid.templateTask||"Yes"==L._taskGraphModel.options.grid.templateTask&&"Maintain Exact Task List"!=L._taskGraphModel.options.grid.taskEditSetting&&"Extend Task List"!=L._taskGraphModel.options.grid.taskEditSetting))||"Complete"==L._routeInfo.state&&"Route Node"!=L._taskGraphModel.options.grid.type)||"taskEditMode"==L.mode&&"Inbox Task"!=L._taskGraphModel.options.grid.type&&("No"==L._taskGraphModel.options.grid.templateTask||"Yes"==L._taskGraphModel.options.grid.templateTask&&"Modify/Delete Task List"==L._taskGraphModel.options.grid.taskEditSetting)||"Route Template"==L._routeInfo.Type&&"Inactive"==L._routeInfo.state)&&M.renderHeaderCheveronIcon(L)},B=function(e,t){if(L.fieldViewOnly||L.inboxTaskFieldViewOnly)!function(e){var t="";"TRUE"==L.data.model.routeOwnerTask?t=_.assign:"Approve"==L.data.model.taskAction?t=_.approve:"Notify Only"==L.data.model.taskAction?t=_.notifyOnly:"Comment"==L.data.model.taskAction&&(t=_.Comment),new UWA.Element("span",{text:t,class:"valueReadOnly"}).inject(e).tooltipInfos=se(t),L._taskProperties.elements.expectedAction={value:L.data.model.taskAction}}(e);else{L._routeInfo.BasePurpose&&(L._routeInfo.routeBasePurpose=L._routeInfo.BasePurpose);var o=l.expectedActionElemList(L._routeInfo.routeBasePurpose,L.data.model.routeOwnerTask);L._taskProperties.elements.expectedAction=new n({elementsList:o,value:t,enableSearchFlag:!1}).inject(e),"Route Template"==L._routeInfo.Type&&L._taskProperties.elements.expectedAction.addEventListener("change",(function(e){let t=e.dsModel.selectedIndex;t=t=0==t?"Approve":1==t?"Notify Only":"Comment","Approve"==t||"Comment"==t?(1==L._taskProperties.elements.radioAssigneeChooser.checked&&(L._taskProperties.elements.taskAssigneeChooser.disabled=!1,L._taskProperties.elements.assignee._editor.elements.inputField.disabled=!1),L._taskProperties.elements.radioAssigneeRouteOwner.disabled=!1,1==L._taskProperties.elements.radioAssigneeRouteOwner.checked&&(L._taskProperties.taskAssignmentScopeField.className="fonticon-chooser-display",L._taskProperties.formFields.querySelector("#assignmentScopeLabel").show())):(L._taskProperties.elements.radioAssigneeChooser.checked=!0,L._taskProperties.elements.taskAssigneeChooser.disabled=!1,L._taskProperties.elements.assignee._editor.elements.inputField.disabled=!1,L._taskProperties.elements.radioAssigneeRouteOwner.disabled=!0,L._taskProperties.elements.assignmentScope.selectedItems=void 0,L._taskProperties.taskAssignmentScopeField.className="fonticon-chooser-scope-display",L._taskProperties.formFields.querySelector("#assignmentScopeLabel").hide())}))}},G=function(){let e=new UWA.Element("div",{class:"initiate-Task-Field"}).inject(L._taskProperties.formFields);e.setAttribute("id","contentToreviewAutoComplete");let t=new UWA.Element("div",{class:"initiate-Task-Field-Label"}).inject(e);new UWA.Element("div").inject(e).style.width="2%";let o=new UWA.Element("div",{class:"initiate-Task-Field-Value"}).inject(e);L._taskProperties.contentToReviewField=d.getRouteTaskContentToReviewField(L._taskProperties,L._routeInfo,L.mode,L.data),t=d.renderRouteTaskContentToReviewField(L._taskProperties,L.mode,L._routeInfo,t),L._taskProperties.contentToReviewField.inject(o),new UWA.Element("div",{html:"&nbsp;"}).inject(o);var i=new UWA.Element("div",{class:"contentToReviewButton"}).inject(o);d.drawContentToReviewSearchButton(L._taskProperties,L.mode,L._routeInfo).inject(i),L.data.model.contentToReviewFieldInfo&&0!=L.data.model.contentToReviewFieldInfo.length&&L.data.model.contentToReviewFieldInfo.forEach((function(e){var t=new r({label:e.title,value:e.id});t.options.grid=e,null==L._taskProperties.contentToReviewField.selectedItems?L._taskProperties.contentToReviewField.selectedItems=t:L._taskProperties.contentToReviewField.selectedItems.push(t),L._taskProperties.contentToReviewField._applySelectedItems()})),"create"!=L.mode&&function(e){if("Review"==L.data.model.current){L._taskProperties.contentToReviewField.elements.container.hide(),L._taskProperties.formFields.querySelector(".contentToReviewButton").hide();var t,o=g.getModel(),i=!1;if(null!=o){t=o.getChildren();for(var n=0;n<t.length;n++)if(null==t[n].options.grid.relatedToTaskIds||0==t[n].options.grid.relatedToTaskIds.length){i=!0;break}}i||null!=L.data.model.RouteTaskContentToReview&&L.data.model.RouteTaskContentToReview.length>0?Z(e):L._taskProperties.formFields.querySelector(".contentToReviewField").hide()}else Z()}(o)},q=function(){F=ie("initiate-Task-Field",L._taskProperties.formFields),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F);new UWA.Element("div",{id:"assigneeId",class:""}).inject(F);if(L.inboxTaskFieldViewOnly){new UWA.Element("h5",{class:"",text:_.taskassignee}).inject(P).tooltipInfos=se(_.taskassignee)}else L.labelAttr=new UWA.Element("h5",{class:L.fieldRequired,text:_.taskassignee}).inject(P),L.labelAttr.tooltipInfos=se(_.taskassignee),L.fieldRequired&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(L.labelAttr);null==L.data.model.taskAssignee&&(L.data.model.taskAssignee=""),null==L.data.model.assigneeTitle&&(L.data.model.assigneeTitle="");var e=L.data.model.taskAssignee;if(L.data.model.assigneeType&&(e="Person"==L.data.model.assigneeType?L.data.model.taskAssignee:L.data.model.assigneeTitle),L._taskProperties.currentValue.assigneeId=L.data.model.assigneePID,L.fieldViewOnly||L.inboxTaskFieldViewOnly)!function(e,t){var o;if("TRUE"==L.data.model.routeOwnerTask&&(e=_.routeOwnerTask),new UWA.Element("span",{text:e,class:"valueReadOnly"}).inject(t).tooltipInfos=se(_.assigneeDisplayValue),null!=e&&""!=e&&(o=new r({label:e,value:L.data.model.assigneeId,name:L.data.model.taskAssigneeUsername,type:L.data.model.assigneeType}),L._taskProperties.elements.assignee={selectedItems:o}),"TRUE"==L.data.model.routeOwnerTask&&""!=L.data.model.routeOwnerUGChoice){var i=new UWA.Element("div",{id:"assignmentScopeId",class:""}).inject(L._taskProperties.formFields);L.labelAttr=new UWA.Element("h5",{class:L.fieldRequired,text:_.routeOwnerTaskAssignmentScope}).inject(i),L.labelAttr.tooltipInfos=se(_.routeOwnerTaskAssignmentScope),new UWA.Element("span",{text:L.data.model.routeOwnerUGTitle}).inject(i).tooltipInfos=se(L.data.model.routeOwnerUGTitle)}}(e,V);else{var t=!0;"TRUE"==L.data.model.routeOwnerTask&&(t=!1);let d=new UWA.Element("div").inject(V);d.style.width="100%",d.style.marginTop="3px",L._taskProperties.radioAssigneeChooserDiv=new UWA.Element("div",{id:"radioAssigneeChooserDiv",class:"fonticon-chooser-display fit-content"}).inject(d),L._taskProperties.elements.radioAssigneeChooser=new UWA.Element("input",{type:"radio",name:"AssigneeOption",value:"1",checked:t,class:"cursor-pointer"}),L._taskProperties.elements.radioAssigneeChooser.inject(L._taskProperties.radioAssigneeChooserDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.radioAssigneeChooserDiv),W=ne("taskAssigneeInfo",_.initiateTaskAssignee,P),L._taskProperties.radioAssigneeRouteOwnerTaskDiv=new UWA.Element("div",{id:"radioAssigneeRouteOwnerTask",class:"fonticon-chooser-display fit-content"}).inject(d);let u=ie("initiate-Route-Field-LinkedTemplate",L._taskProperties.taskAssignmentScopeField),g=ie("initiate-Route-Field-Label-LinkedTemplate",u);new UWA.Element("div").inject(u).style.width="2%",L._taskProperties.taskAssignmentScopeField.inject(L._taskProperties.formFields),L._taskProperties.elements.radioAssigneeRouteOwner=new UWA.Element("input",{type:"radio",name:"AssigneeOption",value:"2",checked:!t,class:"cursor-pointer"}),L._taskProperties.elements.radioAssigneeRouteOwner.inject(L._taskProperties.radioAssigneeRouteOwnerTaskDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.radioAssigneeRouteOwnerTaskDiv);var i,n={};if(n.isMultiSearchMode=!1,n.placeHolderValue=_.searchTaskAssigneePlaceHolder,n.minLengthToType=3,n.isFreeInputAllowed=!1,n.toKeepSearchResultsFlag=!1,"OnPremise"!=c.getTenantValue()&&(n.source=["3dspace","usersgroup"]),n.getPrecond=function(){return m.getPrecondForTaskMemberSearch(L._routeInfo)},n.getValidation=function(){return l.validationForAssigneeField(L._routeInfo)},n.getChangeHandler=function(){return l.changeHandlerForAssigneeField(L._taskProperties,L._routeInfo,L._taskGraphModel)},L._taskProperties.elements.assignee=p.drawAutoCompleteComponent(n),t){if(L._taskProperties.elements.assignee._editor.elements.inputField.disabled=!1,null!=e&&""!=e)i=new r({label:e,value:L.data.model.assigneeId,name:L.data.model.taskAssigneeUsername,type:L.data.model.assigneeType}),L._taskProperties.elements.assignee.selectedItems=i}else L._taskProperties.elements.assignee.selectedItems=void 0,L._taskProperties.elements.assignee._editor.elements.inputField.disabled=!0;L._taskProperties.elements.assignee.inject(L._taskProperties.radioAssigneeChooserDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.radioAssigneeChooserDiv),L._taskProperties.elements.taskAssigneeChooser=new o({icon:{iconName:"search"},disabled:!t}),L._taskProperties.elements.taskAssigneeChooser.inject(L._taskProperties.radioAssigneeChooserDiv),L._taskProperties.elements.taskAssigneeChooser.getContent().addEventListener("buttonclick",(function(){l.launchAssigneeSearch(event,L._taskProperties,L._routeInfo,L._taskGraphModel)})),L._taskProperties.taskAssigneeField.inject(L._taskProperties.radioAssigneeChooserDiv),L._taskProperties.routeOwnerTaskDiv=new UWA.Element("div",{id:"routeOwnerTaskId",class:""}).inject(L._taskProperties.radioAssigneeRouteOwnerTaskDiv);let f=UWA.createElement("span",{class:"task-days-from-text",text:_.routeOwnerTask});f.tooltipInfos=se(_.routeOwnerTask),new UWA.Element("div",{id:"routeOwnerTaskTextDiv",html:[f]}).inject(L._taskProperties.radioAssigneeRouteOwnerTaskDiv),""==L._taskProperties.elements.expectedAction.value||"Approve"!=L._taskProperties.elements.expectedAction.value&&"Comment"!=L._taskProperties.elements.expectedAction.value?(L._taskProperties.routeOwnerTaskDiv.style.display="none",L._taskProperties.elements.radioAssigneeRouteOwner.disabled=!0):L._taskProperties.routeOwnerTaskDiv.style.display="";var s,a={};if(a.isMultiSearchMode=!1,a.placeHolderValue=_.searchPlaceHolderAssignmentScope,a.minLengthToType=3,a.isFreeInputAllowed=!1,a.toKeepSearchResultsFlag=!1,"OnPremise"!=c.getTenantValue()&&(a.source=["usersgroup"]),a.getPrecond=function(){return m.getPrecondForRouteOwnerAssignmentScope(L._routeInfo)},L._taskProperties.elements.assignmentScope=p.drawAutoCompleteComponent(a),null!=L.data.model.routeOwnerUGTitle&&""!=L.data.model.routeOwnerUGTitle&&null!=L.data.model.routeOwnerUGChoice&&""!=L.data.model.routeOwnerUGChoice&&null!=L.data.model.routeOwnerUGName&&""!=L.data.model.routeOwnerUGName)s=new r({label:L.data.model.routeOwnerUGTitle,value:L.data.model.routeOwnerUGChoice,name:L.data.model.routeOwnerUGName}),L._taskProperties.elements.assignmentScope.selectedItems=s;let h=ie("initiate-Route-Field-Value-LinkedTemplate",u);new UWA.Element("h5",{class:"",id:"assignmentScopeLabel",text:"     "+_.routeOwnerTaskAssignmentScope}).inject(g).tooltipInfos=se(_.routeOwnerTaskAssignmentScope),L._taskProperties.elements.assignmentScope.inject(h),new UWA.Element("div",{html:"&nbsp;"}).inject(h),L._taskProperties.elements.assignmentScopeChooser=new o({icon:{iconName:"search"}}),L._taskProperties.elements.assignmentScopeChooser.inject(h),W=ne("taskAssignmentScopeInfo",_.taskAssignmentScopeInfo,g),L._taskProperties.elements.assignmentScopeChooser.getContent().addEventListener("buttonclick",(function(){l.launchAssignmentScopeSearch(event,L._taskProperties,L._routeInfo,L._taskGraphModel)})),t?L._taskProperties.formFields.querySelector("#assignmentScopeLabel").hide():(L._taskProperties.taskAssignmentScopeField.className="fonticon-chooser-display",L._taskProperties.formFields.querySelector("#assignmentScopeLabel").show()),L._taskProperties.elements.radioAssigneeChooser.onclick=function(e){L._taskProperties.routeOwnerTaskDiv.style.display="none",L._taskProperties.elements.taskAssigneeChooser.disabled=!1,L._taskProperties.elements.assignee._editor.elements.inputField.disabled=!1,L._taskProperties.taskAssignmentScopeField.className="fonticon-chooser-scope-display",L._taskProperties.formFields.querySelector("#assignmentScopeLabel").hide(),L._taskProperties.elements.assignmentScope.selectedItems=void 0},L._taskProperties.elements.radioAssigneeRouteOwner.onclick=function(e){L._taskProperties.routeOwnerTaskDiv.style.display="",L._taskProperties.elements.taskAssigneeChooser.disabled=!0,L._taskProperties.elements.assignee._editor.elements.inputField.disabled=!0,L._taskProperties.taskAssignmentScopeField.className="fonticon-chooser-display",L._taskProperties.formFields.querySelector("#assignmentScopeLabel").show(),L._taskProperties.elements.assignee.selectedItems=void 0,L._taskProperties.elements.assignmentScope._editor.elements.inputField.focus()}}},H=function(){"taskEditMode"!=L.mode&&"Route Node"!=L.data.model.type||("Route Template"==L._routeInfo.Type?q():function(){if("TRUE"==L.data.model.routeOwnerTask){var e=new UWA.Element("div",{id:"assigneeId",class:""}).inject(L._taskProperties.formFields);F=ie("initiate-Task-Field",e),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F);let a=new UWA.Element("h5",{class:"",text:_.taskassignee}).inject(P);var t;a.tooltipInfos=se(_.taskassignee),"create"==L.mode?(s=c.getLoginUserFullName(),t=c.getLoginUser()):(s=L.data.model.taskAssignee,t=L.data.model.taskAssigneeUsername),a=new UWA.Element("span",{text:s}).inject(V),a.tooltipInfos=se(s);var o,i="contextUser";if(L.taskGraphModel.model.routePropertiesInfo.model&&(i=L.data.model.assigneeId),null!=s&&""!=s&&(o=new r({label:s,value:i,name:t,type:"Person",class:".initiate-Route-Field.width-added .valueReadOnly"}),L._taskProperties.elements.assignee={selectedItems:o}),""!=L.data.model.routeOwnerUGChoice&&null!=L.data.model.routeOwnerUGChoice&&L.data.model.routeOwnerUGChoice.length>0){var n=new UWA.Element("div",{id:"routeOwnerUserGroupId",class:""}).inject(L._taskProperties.formFields);let e=new UWA.Element("h5",{text:_.assignmentScope}).inject(n);e.tooltipInfos=se(_.assignmentScope),W=ne("taskAssignmentScopeAssigneeInfo",_.initiateTaskAssignee,P),e=new UWA.Element("span",{text:L.data.model.routeOwnerUGTitle}).inject(n),e.tooltipInfos=se(L.data.model.routeOwnerUGTitle)}}else{e=new UWA.Element("div",{id:"assigneeId",class:""}).inject(L._taskProperties.formFields),null==L.data.model.taskAssignee&&(L.data.model.taskAssignee=""),null==L.data.model.assigneeTitle&&(L.data.model.assigneeTitle="");var s=L.data.model.taskAssignee;L.data.model.assigneeType&&(s="Person"==L.data.model.assigneeType?L.data.model.taskAssignee:L.data.model.assigneeTitle),L._taskProperties.currentValue.assigneeId=L.data.model.assigneePID,L.fieldViewOnly||L.inboxTaskFieldViewOnly||l.canLoadInViewMode(L.data,L._routeInfo)&&"Modify Task List"!=L._routeInfo.taskEditSetting?d.drawAssigneeInViewMode(e,L.data,L._taskProperties,s):u.drawAssigneeInEditMode(e,L.data,L._taskProperties,L.fieldRequired,L._routeInfo,L._taskGraphModel,s)}}())},z=function(){var t=new UWA.Element("div",{id:"dueDateId",class:""}).inject(L._taskProperties.formFields);F=ie("initiate-Task-Field",t),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F);let o=new UWA.Element("div").inject(V);o.style.width="100%",L.labelAttr=new UWA.Element("h5",{class:L.fieldRequired,text:_.dueDateAndTime}).inject(P),L.labelAttr.tooltipInfos=se(_.dueDateAndTime),L.fieldRequired&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(L.labelAttr),o=function(e){return L._taskProperties.elements.radioDueDateOption1=new UWA.Element("input",{type:"radio",name:"dueDate",value:"1",checked:!0,class:"cursor-pointer"}),L._taskProperties.elements.radioDueDateOption1.inject(L._taskProperties.dueDateDivOption1),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.dueDateDivOption1),L._taskProperties.elements.dueDateOptionSelected=1,L._taskProperties.elements.radioDueDateOption1.onclick=function(){l.enableDisableDueDateOptions(L._taskProperties.elements.radioDueDateOption1.value,L._taskProperties)},new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.dueDateDivOption1),(L.taskDueDate-L.taskMinDate)/864e5<0&&(L.taskMinDate=L.taskDueDate),L._taskProperties.elements.radioDueDateOption1Date=new s({value:new Date(L.taskDueDate),minValue:new Date(L.taskMinDate),timePickerFlag:!0}),L._taskProperties.elements.radioDueDateOption1Date.inject(L._taskProperties.dueDateDivOption1),L._taskProperties.dueDateDivOption1.inject(L._taskProperties.dueDateDiv),"Route Template"==L._routeInfo.Type&&(L._taskProperties.dueDateDivOption1.style.display="none",1==L.dueDateOptionPreviouslySelected&&(L.dueDateOptionPreviouslySelected=3),L._taskProperties.radioAssigneeChooserDiv.querySelector("#SearchTaskAssigneeField").style.width="0%"),L._taskProperties.dueDateDiv.inject(e),e}(o),o=function(t){var o=!1;return 2==L.dueDateOptionPreviouslySelected&&(o=!0),L._taskProperties.elements.radioDueDateOption2=new UWA.Element("input",{type:"radio",name:"dueDate",value:"2",checked:o,class:"cursor-pointer"}).inject(t),L._taskProperties.elements.radioDueDateOption2.inject(L._taskProperties.dueDateDivOption2),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.dueDateDivOption2),L._taskProperties.elements.radioDueDateOption2.onclick=function(){l.enableDisableDueDateOptions(L._taskProperties.elements.radioDueDateOption2.value,L._taskProperties)},new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.dueDateDivOption2),L.data.model.dueDateOffset||(L.data.model.dueDateOffset=""),L._taskProperties.elements.radioDueDateOption2DaysFrom=new e({pattern:"[0-9]+",sizeInCharNumber:1,disabled:!0,value:L.data.model.dueDateOffset}),L._taskProperties.elements.radioDueDateOption2DaysFrom.inject(L._taskProperties.dueDateDivOption2),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.dueDateDivOption2),new UWA.Element("div",{html:[UWA.createElement("span",{class:"task-days-from-text",text:_.dueDateTextStartsFrom})]}).inject(L._taskProperties.dueDateDivOption2).style.marginTop="7px",new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.dueDateDivOption2),L._taskProperties.elements.radioDueDateOption2ComboBox=new n({elementsList:[{labelItem:_.dueDateFromRouteStart,valueItem:"Route Start Date"},{labelItem:_.dueDateFromPriorTask,valueItem:"Task Create Date"}],value:L.data.model.dateOffsetFrom,enableSearchFlag:!1,disabled:!0}),L._taskProperties.elements.radioDueDateOption2ComboBox.addEventListener("change",(function(e){0==L._taskProperties.elements.radioDueDateOption2ComboBox._lastValidatedSelectedIndex?L._taskProperties.elements.radioDueDateOption2ComboBox.tooltipInfos=se(_.dueDateFromRouteStart):1==L._taskProperties.elements.radioDueDateOption2ComboBox._lastValidatedSelectedIndex&&(L._taskProperties.elements.radioDueDateOption2ComboBox.tooltipInfos=se(_.dueDateFromPriorTask))})),L._taskProperties.elements.radioDueDateOption2ComboBox.tooltipInfos=se(_.dueDateFromRouteStart),L._taskProperties.elements.radioDueDateOption2ComboBox.inject(L._taskProperties.dueDateDivOption2),L._taskProperties.dueDateDivOption2.inject(L._taskProperties.dueDateDiv),L._taskProperties.dueDateDiv.inject(t),t}(o),o=function(e){var t=!1;return 3==L.dueDateOptionPreviouslySelected&&(t=!0),L._taskProperties.elements.radioDueDateOption3=new UWA.Element("input",{type:"radio",name:"dueDate",value:"3",checked:t,class:"cursor-pointer"}).inject(e),L._taskProperties.elements.radioDueDateOption3.inject(L._taskProperties.dueDateDivOption3),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.dueDateDivOption3),L._taskProperties.elements.radioDueDateOption3.onclick=function(){l.enableDisableDueDateOptions(L._taskProperties.elements.radioDueDateOption3.value,L._taskProperties)},new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.dueDateDivOption3),L._taskProperties.elements.radioDueDateOption3Text=new UWA.Element("span",{html:_.assigneeSetDueDate}).inject(L._taskProperties.dueDateDivOption3),L._taskProperties.elements.radioDueDateOption3Text.tooltipInfos=se(_.assigneeSetDueDate),L._taskProperties.dueDateDivOption3.inject(L._taskProperties.dueDateDiv),L._taskProperties.dueDateDiv.inject(L._taskProperties.formFields),L._taskProperties.dueDateDiv.inject(e),e}(o),W="none"==L._taskProperties.dueDateDivOption1.style.display?ne("taskDueDateInfo",_.initiateTemplateTaskDueDate,P):ne("taskDueDateInfo",_.initiateTaskDueDate,P),L.dueDateOptionPreviouslySelected&&l.enableDisableDueDateOptions(L.dueDateOptionPreviouslySelected,L._taskProperties)},J=function(){if(L.taskActionMode&&l.canUserCompleteTask(L.data,L._routeInfo)){var e=new a;"Approve"==L.data.model.taskAction&&l.canPerformTaskAction(L.data.model.taskDetails)&&function(e){var t=new r({label:_.taskApprove,grid:{valueItem:"Approve"},icons:[{iconName:"thumbs-up",color:"green"}]}),o=new r({label:_.taskReject,grid:{valueItem:"Reject"},icons:[{iconName:"thumbs-down"}]}),i=new r({label:_.taskAbstain,grid:{valueItem:"Abstain"},icons:[{iconName:"ignore"}]});e.addRoot(t),e.addRoot(o),"true"==L._routeInfo.showAbstain&&e.addRoot(i)}(e),"Comment"==L.data.model.taskAction&&function(e){var t=new r({label:_.taskComplete,grid:{valueItem:"Complete"},icons:[{iconName:"thumbs-up"}]});e.addRoot(t)}(e),function(e){L._taskProperties.taskActionButtonDiv=new UWA.Element("div",{id:"taskActionButtonDiv",class:"task-action-button-allign"}),L._taskProperties.elements.taskActionButtons=new n({enableSearchFlag:!1,actionOnClickFlag:!0,elementsTree:e}),L._taskProperties.elements.taskActionButtons.inject(L._taskProperties.taskActionButtonDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.taskActionButtonDiv),L._taskProperties.taskActionButtonDiv.inject(L._taskProperties.formHeader),L._taskProperties.elements.taskActionButtons.getContent().addEventListener("click",(function(){"saveForLater"==L._taskProperties.elements.taskActionButtons.value?w.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Save for later"}):w.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - "+L._taskProperties.elements.taskActionButtons.value}),l.taskActionUpdate(L.data,L._taskProperties,L._routeInfo,L.membersInfo)}))}(e),L.titleSection.classList.add("task-command-section")}},X=function(){if(F=ie("initiate-Task-Field",L._taskProperties.formFields),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F),V.setAttribute("id","dueDateIdCompleteTask"),L._taskProperties.elements.dueDateOptionSelected=L.dueDateOptionPreviouslySelected,3==L._taskProperties.elements.dueDateOptionSelected){let e=new UWA.Element("h5",{class:"required",text:_.dueDateAndTime}).inject(P);e.tooltipInfos=se(_.dueDateAndTime),(L.taskDueDate-L.taskMinDate)/864e5<0&&(L.taskMinDate=L.taskDueDate),UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(e),L._taskProperties.elements.taskActionDueDate=new s({value:new Date(L.taskDueDate),minValue:new Date(L.taskMinDate),timePickerFlag:!0}).inject(V),L._taskProperties.elements.taskActionDueDate.addEventListener("change",(function(){I.updateTaskPanelFooter(),widget.routeMgmtMediator.publish("task-due-date-changed",!0)})),W=ne("taskCompletionCommentInfo",_.initiateCompletionTaskDueDate,P)}else{let t=new UWA.Element("h5",{class:"",text:_.dueDateAndTime}).inject(P);t.tooltipInfos=se(_.dueDateAndTime);var e=l.dueDateViewMode(L.data,L.taskDueDate);t=new UWA.Element("span",{text:e,class:"valueReadOnly"}).inject(V),t.tooltipInfos=se(e)}},K=function(){var e=new UWA.Element("div",{id:"dueDateIdReviewTask",class:""}).inject(L._taskProperties.formFields);F=ie("initiate-Task-Field",e),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F);let t=new UWA.Element("h5",{class:"",text:_.dueDateAndTime}).inject(P);t.tooltipInfos=se(_.dueDateAndTime);var o=l.dueDateViewMode(L.data,L.taskDueDate);t=new UWA.Element("span",{text:o}).inject(V),t.tooltipInfos=se(o),F=ie("initiate-Task-Field",L._taskProperties.formFields),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F),t=new UWA.Element("h5",{class:"",text:_.collabTaskAddComment}).inject(P),t.tooltipInfos=se(_.collabTaskAddComment),L.data.model.comments||(L.data.model.comments=""),new UWA.Element("span",{html:L.data.model.comments}).inject(V),F=ie("initiate-Task-Field cke-comments-container",L._taskProperties.formFields),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F);let i=new UWA.Element("h5",{class:"required",text:_.reviewComments}).inject(P);if(i.tooltipInfos=se(_.reviewComments),UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(i),"ENOTASK_AP"==widget.getValue("appId")){let e=UWA.createElement("h5",{class:"comment-task-title",text:L._taskProperties.elements.title.value,title:L._taskProperties.elements.title.value}).inject(P),t=UWA.createElement("h5",{class:"comment-task-title-separator",text:" : "}).inject(P);P.insertBefore(t,P.children[0]),P.insertBefore(e,P.children[0])}L.data.model.reviewersComments||(L.data.model.reviewersComments=""),W=ne("taskReviewCommentInfo",_.taskReviewCommentInfo,P),L._taskProperties.elements.taskReviewersComments=new UWA.Element("textarea",{name:"ckeditorTaskReviewComment"}),require(["DS/CKEditor/CKEditor"],(function(e){u.drawTaskReviewComments(e,L.data.model.reviewersComments)})),L._taskProperties.elements.taskReviewersComments.inject(V),F=ie("initiate-Task-Field",L._taskProperties.formFields),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F);let s=new UWA.Element("div",{id:"RouteTasksAttachmentsDiv"});L._taskProperties.autoCompleteComponent=d.getAutoComponent(L._taskProperties);let c=d.drawAttachmentSearchExistingButton(L._taskProperties);c.elements.container.addClassName("attachmentSearchBtn"),d.renderAttachmentField(L._taskProperties,P),c.inject(s),L._taskProperties.autoCompleteComponent.inject(V),new UWA.Element("div",{html:"&nbsp;"}).inject(V),s.inject(V);var p=new a;!function(e){var t=new r({label:_.taskReviewAccept,grid:{valueItem:"promote"},icons:[{iconName:"check"}]});e.addRoot(t);var o=new r({label:_.taskReviewReject,grid:{valueItem:"demote"},icons:[{iconName:"thumbs-down"}]});e.addRoot(o)}(p),function(e){L._taskProperties.taskReviewButtonDiv=new UWA.Element("div",{id:"taskReviewButtonDiv",class:"task-action-button-allign"}),L._taskProperties.elements.taskReviewButtons=new n({enableSearchFlag:!1,actionOnClickFlag:!0,elementsTree:e}),L._taskProperties.elements.taskReviewButtons.inject(L._taskProperties.taskReviewButtonDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.taskReviewButtonDiv),L._taskProperties.taskReviewButtonDiv.inject(L._taskProperties.formHeader),L._taskProperties.elements.taskReviewButtons.getContent().addEventListener("click",(function(){L.data.taskReviewButtonsValue=void 0,"promote"==L._taskProperties.elements.taskReviewButtons.value?w.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Accept"}):"demote"==L._taskProperties.elements.taskReviewButtons.value&&w.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Reject"}),l.taskReviewUpdate(L.data,L._taskProperties,L._routeInfo)})),L.titleSection.classList.add("task-command-section")}(p),"ENOTASK_AP"==widget.getValue("appId")&&(L._taskProperties.formFooter.style.display="none")},Y=function(){L.taskActionMode&&l.canUserCompleteTask(L.data,L._routeInfo)?function(){if(L.data.model.reviewersComments&&""!=L.data.model.reviewersComments){var e=new UWA.Element("div",{id:"commentId",class:""}).inject(L._taskProperties.formFields);F=ie("initiate-Task-Field cke-comments-container",e),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F);let t=new UWA.Element("h5",{class:"",text:_.reviewComments}).inject(P);t.tooltipInfos=se(_.reviewComments),t=new UWA.Element("span",{html:L.data.model.reviewersComments}).inject(V),t.tooltipInfos=se(L.data.model.reviewersComments)}F=ie("initiate-Task-Field cke-comments-container",L._taskProperties.formFields),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F);let t=new UWA.Element("h5",{class:"required",text:_.collabTaskAddComment}).inject(P);if(t.tooltipInfos=se(_.collabTaskAddComment),UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(t),"ENOTASK_AP"==widget.getValue("appId")){let e=UWA.createElement("h5",{class:"comment-task-title",text:L._taskProperties.elements.title.value,title:L._taskProperties.elements.title.value}).inject(P),t=UWA.createElement("h5",{class:"comment-task-title-separator",text:" : "}).inject(P);P.insertBefore(t,P.children[0]),P.insertBefore(e,P.children[0])}L.data.model.comments||(L.data.model.comments=""),W=ne("taskCommentInfo",_.taskCommentInfo,P),L._taskProperties.elements.taskApproveComments=new UWA.Element("textarea",{name:"ckeditorTaskComment"}),require(["DS/CKEditor/CKEditor"],(function(e){u.drawTaskComments(e,L.data.model.comments)})),L._taskProperties.elements.taskApproveComments.inject(V),F=ie("initiate-Task-Field",L._taskProperties.formFields),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F);let o=new UWA.Element("div",{id:"RouteTasksAttachmentsDiv"});L._taskProperties.autoCompleteComponent=d.getAutoComponent(L._taskProperties);let i=d.drawAttachmentSearchExistingButton(L._taskProperties);i.elements.container.addClassName("attachmentSearchBtn"),d.renderAttachmentField(L._taskProperties,P),i.inject(o),L._taskProperties.autoCompleteComponent.inject(V),new UWA.Element("div",{html:"&nbsp;"}).inject(V),o.inject(V)}():L.taskActionMode&&l.canUserReview(L.data,L._routeInfo)?K():L.fieldViewOnly&&function(){var e=new UWA.Element("div",{id:"dueDateViewOnlyId",class:""}).inject(L._taskProperties.formFields);F=ie("initiate-Task-Field",e),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F);let t=new UWA.Element("h5",{class:"",text:_.dueDateAndTime}).inject(P);t.tooltipInfos=se(_.dueDateAndTime);var o=l.dueDateViewMode(L.data,L.taskDueDate);if(t=new UWA.Element("span",{text:o,class:"valueReadOnly"}).inject(V),t.tooltipInfos=se(o),L.data.model.comments&&""!=L.data.model.comments){var i=new UWA.Element("div",{id:"commentId",class:""}).inject(L._taskProperties.formFields);F=ie("initiate-Task-Field",i),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F),new UWA.Element("h5",{class:"",text:_.collabTaskAddComment}).inject(P).tooltipInfos=se(_.collabTaskAddComment),new UWA.Element("span",{html:L.data.model.comments,class:"valueReadOnly"}).inject(V)}if(L.data.model.reviewersComments&&""!=L.data.model.reviewersComments){var n=new UWA.Element("div",{id:"commentId",class:""}).inject(L._taskProperties.formFields);F=ie("initiate-Task-Field",n),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F),new UWA.Element("h5",{class:"",text:_.reviewComments}).inject(P).tooltipInfos=se(_.reviewComments),new UWA.Element("span",{html:L.data.model.reviewersComments,class:"valueReadOnly"}).inject(V)}L._taskProperties.formFooter.style.display="none"}()},$=function(){return!(!L.taskActionMode||!l.canUserReview(L.data,L._routeInfo))||!(!L.taskActionMode||!l.canUserCompleteTask(L.data,L._routeInfo))},Z=function(e){if(f.destroy(),L.data.model.RouteTaskContentToReview&&L.data.model.RouteTaskContentToReview.length>0){L.data.model.routeContents.forEach((function(e){e.relatedToTaskIds&&0==e.relatedToTaskIds.length&&(e.canDeleteContent=!1)})),"Review"==L.data.model.current&&L.data.model.RouteTaskContentToReview.forEach((function(e){e.canDeleteContent=!1})),d.drawListOfRouteTaskContentToReviews(L.data,L._routeInfo,L.fieldViewOnly,L._taskProperties).inject(L._taskProperties.formFields),L._taskProperties.attachedContentsToReview=[],L.data.model.RouteTaskContentToReview.forEach((function(e){L._taskProperties.attachedContentsToReview.push(e.id)}))}else{if(null==L.data.model.routeContents){let e=g.getModel().getChildren();if(e.length>0){let t=[];for(let o=0;o<e.length;o++)if(null==e[o].options.grid.relatedToTaskIds||e[o].options.grid.relatedToTaskIds&&0==e[o].options.grid.relatedToTaskIds.length){let i={};i.typeicon=e[o].options.icons[0],i.id=e[o].options.grid.id,i.title=e[o].options.grid.Title,i.name=e[o].options.grid.Name,i.type=e[o].options.grid.Type,i.revision=e[o].options.grid.revision,i.canDeleteContent=!1,t.push(i)}L.data.model.routeContents=t}}if(L.data.model.routeContents&&L.data.model.routeContents.length>0){L.data.model.routeContents.forEach((function(e){e.canDeleteContent=!1})),d.drawRouteContentsInTaskViewMode(L.data,L._taskProperties,L._routeInfo,L.fieldViewOnly,e).inject(L._taskProperties.formFields)}}},Q=function(){var e;L._taskProperties.moreSectionFormFields=new UWA.Element("div",{id:"RouteTasksMoreSection",class:"main-panel"}),e=new UWA.Element("div",{id:"taskOrganizationId",class:""}).inject(L._taskProperties.moreSectionFormFields),F=ie("initiate-Task-Field",e),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F),new UWA.Element("h5",{class:"",text:_.Organization}).inject(P).tooltipInfos=se(_.Organization),new UWA.Element("span",{text:L._routeInfo.organizationTitle,class:"valueReadOnly"}).inject(V).tooltipInfos=se(L._routeInfo.organizationTitle),function(){var e=new Date;if(L.data.model.originated){e=new Date(L.data.model.originated);var t=new UWA.Element("div",{id:"taskCreatedDateId",class:""}).inject(L._taskProperties.moreSectionFormFields);F=ie("initiate-Task-Field",t),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F),new UWA.Element("h5",{class:"",text:_.createdDate}).inject(P).tooltipInfos=se(_.createdDate);let i={datePrecision:"day",dateStyle:"full",timePrecision:"sec"};var o=U.formatDateToString(new Date(e),i);new UWA.Element("span",{text:o,class:"valueReadOnly"}).inject(V).tooltipInfos=se(o)}}(),function(){var e=new Date;if(L.data.model.modified){e=new Date(L.data.model.modified);var t=new UWA.Element("div",{id:"taskModifiedDateId",class:""}).inject(L._taskProperties.moreSectionFormFields);F=ie("initiate-Task-Field",t),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F),new UWA.Element("h5",{class:"",text:_.modifiedDate}).inject(P).tooltipInfos=se(_.modifiedDate);let i={datePrecision:"day",dateStyle:"full",timePrecision:"sec"};var o=U.formatDateToString(new Date(e),i);new UWA.Element("span",{text:o,class:"valueReadOnly"}).inject(V).tooltipInfos=se(o)}}();let t=new T({items:[{header:_.more,content:L._taskProperties.moreSectionFormFields}],exclusive:!1,style:"filled-separate"});new UWA.Element("h5",{text:""}).inject(L._taskProperties.formFields),t.inject(L._taskProperties.formFields)},ee=function(){var e=new UWA.Element("div",{id:"taskPriorityId",class:""}).inject(L._taskProperties.formFields);F=ie("initiate-Task-Field",e),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F),new UWA.Element("h5",{class:"",text:_.priority}).inject(P).tooltipInfos=se(_.priority);let t=function(e){if(L.fieldViewOnly){let e=_.medium;L.data.model.routeTaskPriority&&(e=L.data.model.routeTaskPriority.label?L.data.model.routeTaskPriority.label:_[L.data.model.routeTaskPriority.toLowerCase()]);let t=new UWA.Element("div",{text:e,class:"valueReadOnly"}).inject(V);return t.tooltipInfos=se(e),t}return W=ne("priorityTitleInfo",_.priorityTitleInfo,e),u.drawTaskPriorityInEditMode()}(P);t.inject(V)},te=function(){var e,n;"Complete"!=L.data.model.current&&"ENOTASK_AP"==widget.getValue("appId")&&(UWA.createElement("span",{class:"required-label-routes fonticon fonticon-asterisk-alt collabtask-asterisk"}).inject(L._taskProperties.formFields),new UWA.Element("span",{class:"indicate-required",text:_.indicateRequiredFields}).inject(L._taskProperties.formFields)),e=new UWA.Element("div",{id:"titleId",class:""}).inject(L._taskProperties.formFields),L.fieldViewOnly||L.inboxTaskFieldViewOnly||l.canLoadInViewMode(L.data,L._routeInfo)?d.drawTitleInViewMode(e,L.data,L._taskProperties):u.drawTitleInEditMode(e,L.data,L._taskProperties,L.fieldRequired),function(){var e=new UWA.Element("div",{id:"expectedActionId",class:""}).inject(L._taskProperties.formFields);F=ie("initiate-Task-Field",e),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F);var t="Comment";L.data.model.taskAction&&""!=L.data.model.taskAction&&(t=L.data.model.taskAction),L.inboxTaskFieldViewOnly?new UWA.Element("h5",{class:"",text:_.taskAction}).inject(P).tooltipInfos=se(_.taskAction):(L.labelAttr=new UWA.Element("h5",{class:L.fieldRequired,text:_.taskAction}).inject(P),L.labelAttr.tooltipInfos=se(_.taskAction));L.fieldViewOnly||L.inboxTaskFieldViewOnly||(W=ne("taskExpectedActionInfo",_.initiateTaskExpectedAction,P)),B(V,t)}(),ee(),function(){var e=new UWA.Element("div",{id:"instructionId",class:""}).inject(L._taskProperties.formFields);let o=new UWA.Element("div",{class:"initiate-Task-Field"}).inject(e),i=new UWA.Element("div",{class:"initiate-Task-Field-Label"}).inject(o);new UWA.Element("div").inject(o).style.width="2%";let n=new UWA.Element("div",{class:"initiate-Task-Field-Value"}).inject(o);L.labelAttr=new UWA.Element("h5",{class:L.fieldRequired,text:_.instructions}).inject(i),L.labelAttr.tooltipInfos=se(_.instructions),L.fieldRequired&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(L.labelAttr),L.fieldViewOnly?new UWA.Element("div",{text:L.data.model.instructions,class:"valueReadOnly"}).inject(n).tooltipInfos=se(L.data.model.instructions):(L.data.model.instructions||(L.data.model.instructions=""),L._taskProperties.elements.instruction=new t({pattern:"[^./#,\\[\\]\\$\\^@\\*\\?%:'\"\\\\<>]+",widthInCharNumber:30,nbRows:4,newLineMode:"enter",resizableFlag:"vertical",value:L.data.model.instructions}).inject(n),W=ne("taskInstructionInfo",_.initiateTaskInstructions,i))}(),"ENOTASK_AP"==widget.getValue("appId")&&d.drawRouteInfoDataGrid(L.data,L._routeInfo,L.fieldViewOnly,L._taskProperties).inject(L._taskProperties.formFields),L.fieldViewOnly&&"Route Template"!=L._routeInfo.Type&&Z(),function(){F=ie("initiate-Task-Field",L._taskProperties.formFields),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F),new UWA.Element("div",{id:"needOwnerReviewId",class:""}).inject(F);var e=!1;if("Yes"==L.data.model.needsOwnerReview&&(e=!0),L.fieldViewOnly){var t=_.taskNeedOwnerReviewNo;e&&(t=_.taskNeedOwnerReviewYes);let o=new UWA.Element("h5",{text:_.needsOwnerReview}).inject(P);o.tooltipInfos=se(_.needsOwnerReview),o=new UWA.Element("span",{text:t,class:"valueReadOnly"}).inject(V),o.tooltipInfos=se(_.needsOwnerReviewDisp)}else L._taskProperties.elements.needOwnerReview=new i({type:"checkbox",label:_.needsOwnerReview,value:e,checkFlag:e}).inject(V),L._taskProperties.elements.needOwnerReview.tooltipInfos=se(_.needsOwnerReview)}(),L.fieldViewOnly||"Route Template"==L._routeInfo.Type||G(),"ENOTASK_AP"!=widget.getValue("appId")&&function(){L._taskProperties.currentValue.order=L.data.model.taskOrder;var e=new UWA.Element("div",{id:"taskOrderId",class:""}).inject(L._taskProperties.formFields);L.fieldViewOnly||L.inboxTaskFieldViewOnly||L.data.model.userGroupInfo&&""!=L.data.model.userGroupInfo||l.canLoadInViewMode(L.data,L._routeInfo)&&"Modify Task List"!=L._routeInfo.taskEditSetting?d.drawOrderInViewMode(e,L.data,L._taskProperties):u.drawOrderInEditMode(e,L.data,L._taskProperties,L.fieldRequired)}(),H(),!L.data.model.chooseUsersFromUg||"True"!=L.data.model.chooseUsersFromUg&&"False"!=L.data.model.chooseUsersFromUg||(F=ie("initiate-Task-Assignee-Field",L._taskProperties.formFields),P=ie("initiate-Task-Assignee-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Assignee-Field-Value",F),L._taskProperties.chooseUsersFromUgDiv=new UWA.Element("div",{id:"chooseUsersFromUgId",class:""}).inject(V),"Route Template"==L._routeInfo.Type&&L.data.model.chooseUsersFromUg,L._taskProperties.elements.chooseUsersFromUg=new i({type:"checkbox",label:_.ChooseUsersFromUG,value:L.data.model.chooseUsersFromUg,checkFlag:!0,disabled:"Route Template"!=L._routeInfo.Type}).inject(V),"Route Template"==L._routeInfo.Type?"Group"!=L.data.model.assigneeType&&"Group Proxy"!=L.data.model.assigneeType||"True"!=L._routeInfo.chooseUserFromGroup&&"True"!=L._routeInfo.selectUsersFromUserGroup?(L._taskProperties.chooseUsersFromUgDiv.style.display="none",L._taskProperties.formFields.querySelector(".initiate-Task-Assignee-Field").addClassName("disabled-field")):(L._taskProperties.chooseUsersFromUgDiv.style.display="",L._taskProperties.elements.chooseUsersFromUg.checkFlag="False"!=L.data.model.chooseUsersFromUg,(L.fieldViewOnly||L.inboxTaskFieldViewOnly)&&(L._taskProperties.elements.chooseUsersFromUg.disabled=!0)):"False"!=L.data.model.chooseUsersFromUg&&"Person"!=L.data.model.assigneeType||(L._taskProperties.chooseUsersFromUgDiv.style.display="none",L._taskProperties.formFields.querySelector(".initiate-Task-Assignee-Field").addClassName("disabled-field"))),"ENOTASK_AP"!=widget.getValue("appId")&&function(){F=ie("initiate-Task-Field",L._taskProperties.formFields),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F),V.setAttribute("id","allowDelegationId");var e=!1;if(null==L.data.model.allowDelegation&&null!=localStorage.getItem(c.getLoginUser()+"_allowDelegation")?e="true"==localStorage.getItem(c.getLoginUser()+"_allowDelegation"):"TRUE"==L.data.model.allowDelegation&&(e=!0),L.fieldViewOnly){var t=_.taskAllowDelegationNo;e&&(t=_.taskAllowDelegationYes);let o=new UWA.Element("h5",{text:_.allowDelegation}).inject(P);o.tooltipInfos=se(_.allowDelegation),o=new UWA.Element("span",{text:t,class:"valueReadOnly"}).inject(V),o.tooltipInfos=se(t)}else L._taskProperties.elements.allowDelegation=new i({type:"checkbox",label:_.allowDelegation,value:e,checkFlag:e}).inject(V),L._taskProperties.elements.allowDelegation.tooltipInfos=se(_.allowDelegation),L._taskProperties.elements.allowDelegation.addEventListener("change",(function(e){localStorage.setItem(c.getLoginUser()+"_allowDelegation",!e.dsModel.value)}))}(),null!=L._taskGraphModel.options.grid.stateNLS&&(n=new UWA.Element("div",{id:"taskMaturityId",class:""}).inject(L._taskProperties.formFields),F=ie("initiate-Task-Field",n),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F),new UWA.Element("h5",{class:"",text:_.IDcardMaturityState}).inject(P).tooltipInfos=se(_.IDcardMaturityState),new UWA.Element("span",{text:L._taskGraphModel.options.grid.stateNLS,class:"valueReadOnly"}).inject(V).tooltipInfos=se(L._taskGraphModel.options.grid.stateNLS)),function(){var e=new Date;L.taskDueDate=e,L.taskDueDate.setDate(e.getDate()+1);var t=new Date;L.taskMinDate=t,L.taskMinDate.setDate(t.getDate()-1),L.data.model.taskDueDate&&(L.taskDueDate=new Date(L.data.model.taskDueDate));var o=l.dueDateOptionSelected(L.data);L.dueDateOptionPreviouslySelected=o,L.fieldViewOnly||z(),L.taskActionMode&&l.canUserCompleteTask(L.data,L._routeInfo)&&X()}(),Y(),"create"==L.mode||"taskEditMode"==L.mode?(L._taskProperties.saveButton=new UWA.Element("div",{id:"saveButtonId",class:"task-save-float"}).inject(L._taskProperties.formFooter),L._taskProperties.elements.save=new o({label:_.apply,emphasize:"primary"}).inject(L._taskProperties.saveButton),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.saveButton),L._taskProperties.elements.save.getContent().addEventListener("buttonclick",(function(){l.taskDataSave(L.data,L.mode,L._taskProperties,L._taskGraphModel,L._routeInfo)}))):(L.mode="taskActionMode")&&("ENOTASK_AP"==widget.getValue("appId")?(L._taskProperties.closeButton=new UWA.Element("div",{id:"closeButton",class:"task-save-float"}).inject(L._taskProperties.formFooter),L._taskProperties.elements.close=new o({label:_.close,emphasize:"secondary"}).inject(L._taskProperties.closeButton),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.closeButton),L._taskProperties.elements.close.getContent().addEventListener("buttonclick",(function(){})),L._taskProperties.cancelButton=new UWA.Element("div",{id:"cancelButton",class:"task-save-float"}).inject(L._taskProperties.formFooter),L._taskProperties.elements.cancel=new o({label:_.cancel,emphasize:"secondary"}).inject(L._taskProperties.cancelButton),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.cancelButton),L._taskProperties.elements.cancel.getContent().addEventListener("buttonclick",(function(){widget.routeMgmtMediator.publish(L._taskProperties.closeEventName)})),L._taskProperties.saveButton=new UWA.Element("div",{id:"saveButtonId",class:"task-save-float"}).inject(L._taskProperties.formFooter),L._taskProperties.elements.save=new o({label:_.save,emphasize:"primary"}).inject(L._taskProperties.saveButton),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.saveButton),L._taskProperties.elements.save.getContent().addEventListener("buttonclick",(function(){if("Review"==L.data.model.current)L.data.taskReviewButtonsValue="saveForLater",l.taskReviewUpdate(L.data,L._taskProperties,L._routeInfo);else{if(L.membersInfo){if(!L.membersInfo._properties.selectedItems||!L.membersInfo._properties.selectedItems.value)return void widget.notify.handler().addNotif({level:"error",subtitle:_.errorTaskAssignee,sticky:!0});L.data.model.assigneeIdNew=L.membersInfo._properties.selectedItems.value.options.value,L.data.model.taskAssigneeNew=L.membersInfo._properties.selectedItems.value.options.label,L.data.model.taskAssigneeUsernameNew=L.membersInfo._properties.selectedItems.value.options.name,L.data.model.assigneeTypeNew=L.membersInfo._properties.selectedItems.value.options.type}L.data.taskActionButtonsValue="saveForLater",l.taskActionUpdate(L.data,L._taskProperties,L._routeInfo,L.membersInfo)}})),L._taskProperties.saveButton.style.display="none"):(L._taskProperties.cancelButton=new UWA.Element("div",{id:"cancelButtonId",class:"task-save-float"}).inject(L._taskProperties.formFooter),L._taskProperties.elements.cancel=new o({label:_.cancel,emphasize:"secondary"}).inject(L._taskProperties.cancelButton),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.cancelButton),L._taskProperties.elements.cancel.getContent().addEventListener("buttonclick",(function(){widget.routeMgmtMediator.publish(L._taskProperties.closeEventName)})),L._taskProperties.saveButton=new UWA.Element("div",{id:"saveButtonId",class:"task-save-float"}).inject(L._taskProperties.formFooter),L._taskProperties.elements.save=new o({label:_.save,emphasize:"primary"}).inject(L._taskProperties.saveButton),new UWA.Element("div",{html:"&nbsp;"}).inject(L._taskProperties.saveButton),L._taskProperties.elements.save.getContent().addEventListener("buttonclick",(function(){if("Review"==L.data.model.current)L.data.taskReviewButtonsValue="saveForLater",l.taskReviewUpdate(L.data,L._taskProperties,L._routeInfo);else{if(L.membersInfo){if(!L.membersInfo._properties.selectedItems||!L.membersInfo._properties.selectedItems.value)return void widget.notify.handler().addNotif({level:"error",subtitle:_.errorTaskAssignee,sticky:!0});L.data.model.assigneeIdNew=L.membersInfo._properties.selectedItems.value.options.value,L.data.model.taskAssigneeNew=L.membersInfo._properties.selectedItems.value.options.label,L.data.model.taskAssigneeUsernameNew=L.membersInfo._properties.selectedItems.value.options.name,L.data.model.assigneeTypeNew=L.membersInfo._properties.selectedItems.value.options.type}L.data.taskActionButtonsValue="saveForLater",l.taskActionUpdate(L.data,L._taskProperties,L._routeInfo,L.membersInfo)}})))),J(),function(){let e=!$(L.data,L.taskActionMode,L._routeInfo);L.data.model.taskAttachments&&L.data.model.taskAttachments.length>0&&(d.drawListOfAttachments(L.data,L._routeInfo,e).inject(L._taskProperties.formFields),L._taskProperties.attachedDocuments=[],L.data.model.taskAttachments.forEach((function(e){L._taskProperties.attachedDocuments.push(e.id)})))}(),"Complete"==L.data.model.current&&"ENOTASK_AP"==widget.getValue("appId")&&"Approve"==L._taskGraphModel.options.grid.taskAction&&function(){var e=new UWA.Element("div",{id:"renderPerformedTaskAction",class:""}).inject(L._taskProperties.formFields);F=ie("initiate-Task-Field",e),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F),new UWA.Element("h5",{class:"",text:_.approvalStatus}).inject(P).tooltipInfos=se(_.approvalStatus);let t=l.getApprovalStatusForTask1(L._taskGraphModel.options.grid,L._routeInfo);t=_[t],new UWA.Element("span",{text:t,class:"valueReadOnly"}).inject(V).tooltipInfos=se(t)}(),function(){var e=new UWA.Element("div",{id:"taskCollaborativeSpaceId",class:""}).inject(L._taskProperties.formFields);F=ie("initiate-Task-Field",e),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F),new UWA.Element("h5",{class:"",text:_.IDcardCollSpace}).inject(P).tooltipInfos=se(_.IDcardCollSpace);let t=L._routeInfo.ProjectTitle;t||(t=L._routeInfo.Project),new UWA.Element("span",{text:t,class:"valueReadOnly"}).inject(V).tooltipInfos=se(t)}(),function(){if("create"!=L.mode&&l.isInboxTask(L.data)){let e,t,o,i=new UWA.Element("div",{id:"customAttributes",class:""}).inject(L._taskProperties.formFields),n=N.getTaskCustomFields();n&&n.forEach(((n,s)=>{"extensions"!=n.name&&(e=new UWA.Element("div",{id:"customAttr_"+n.name,class:""}).inject(i),F=ie("initiate-Task-Field",e),P=ie("initiate-Task-Field-Label",F),x=new UWA.Element("div").inject(F),x.style.width="2%",V=ie("initiate-Task-Field-Value",F),t=new UWA.Element("div",{id:"customAttr_label"}).inject(P),o=new UWA.Element("div",{id:"customAttr_Val"}).inject(V),L.data.model.hasOwnProperty(n.name)&&(L.taskActionMode&&l.canUserCompleteTask(L.data,L._routeInfo)||L.taskEditMode&&l.canUserEditTask(L.data)&&l.isInboxTask(L.data)?(u.drawLabelInEditMode(t,n,L.data,L._taskProperties),u.drawCustomFieldsInEditMode(o,n,L.data,L._taskProperties)):(d.drawLabelInViewMode(t,n),d.drawCustomFieldsInViewMode(o,n,L.data,L._taskProperties)),o.addEventListener("change",(function(){I.updateTaskPanelFooter()}))))}))}}(),"Inbox Task"!=L.data.model.type&&1!=L.data.model.validTaskData||Q(),"ENOTASK_AP"==widget.getValue("appId")&&require(["DS/E6WCommonApps/Views/UserTagsView","DS/E6WCommonUI/Views/TextAreaView","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,o){var i,n;L._taskProperties.userTagsSection=new UWA.Element("div",{id:"RouteTasksUserTagsSection",class:"main-panel"}),L._userTagsView||(L._userTagsView=new t((n=UWA.merge(e.getUserTagsFieldBasicConfig(L.collabTaskModel),i),{i18n:o,isPropertyPanel:!0,model:L.collabTaskModel,config:n})),L._userTagsView.inject(L._taskProperties.formFields)),L._userTagsView.render().inject(L._taskProperties.userTagsSection);let s=new T({items:[{header:"User tags",content:L._taskProperties.userTagsSection}],exclusive:!1,style:"filled-separate"});new UWA.Element("h5",{text:""}).inject(L._taskProperties.formFields),s.inject(L._taskProperties.formFields)})),null!=L._taskProperties.elements.title.elements&&""==L._taskProperties.elements.title.elements.inputField.value.trim()&&setTimeout((function(){L._taskProperties.elements.title.elements.inputField.focus()}),1e3),widget.routeMgmtMediator.publish("task-content-height-update"),widget.routeMgmtMediator.publish("task-attachment-height-update"),L._taskProperties.autoCompleteComponent&&L._taskProperties.autoCompleteComponent.elements.container.addEventListener("change",(function(){I.updateTaskPanelFooter()}));let s=L._taskProperties.formFields.querySelector(".wux-ui-state-undefined.wux-controls-lineEditor-lite");null!=s&&("taskActionMode"==L.mode?D.makeDroppable(s,oe,"TaskViewContentAttachment"):D.makeDroppable(s,oe,"TaskViewContentReview"));document.getElementById("InitiateTaskPropertiesContainer")},oe=function(e,t){let o=L._taskProperties;o.mode=L.mode,o.routeInfo=L._routeInfo;let i;null!=t.querySelector("#droppable_TaskViewContentReview")?i="droppable_TaskViewContentReview":null!=t.querySelector("#droppable_TaskViewContentAttachment")&&(i="droppable_TaskViewContentAttachment"),null!=i&&C.getResultFromSearch(e,o,i,{})},ie=function(e,t){return E.createNewElement(e,t)},ne=function(e,t,o){return E.createTooltipElement(e,t,o)},se=function(e){return E.getElementToolTip(e)};return{renderEventsAndHeader:()=>j(),renderTaskFields:()=>te(),ondropTaskView:(e,t)=>{oe(e,t)}}})),define("DS/ENORouteMgmt/Views/Grid/TaskAssigneesDataGridView",["DS/ENORouteMgmt/Config/TaskAssigneesGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/DragAndDropManager","DS/ENORouteMgmt/Views/Menu/ContentContextualMenu"],(function(e,t,o,i){"use strict";let n,s={},a=function(){t.dataGridView().addEventListener("contextmenu",r)},r=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&i.taskAssigneeGridRightClick(e,t.nodeModel,!0)};return{build:r=>function(r){var l=UWA.createElement("div",{id:"taskAssignees-dataGridViewContainer",class:"taskAssignees-gridView-View"});s.cellDragEnabledFlag=!0,s.showRowBorderFlag=!1,s.showOutlineFlag=!0,s.showAlternateBackgroundFlag=!1,s.layoutOptions={rowsHeader:!1,columnsHeader:!1,rowSpacing:5,cellWidth:2},s.showContextualMenuColumnFlag=!0,s.onContextualEvent=function(e){e&&e.cellInfos&&i.taskAssigneeContextualMenu(e,e.cellInfos.nodeModel,!0,(function(e){}))};let d=t.build(r,e,!1,l,s);return n=t.dataGridView(),n.onDragStartCell=function(e,t){return o.getContentForDrag(e,t),!0},n.onDragEndCell=function(e,t){e.target.removeClassName("wux-ui-state-activated wux-ui-state-highlighted")},a(),d}(r)}})),define("DS/ENORouteMgmt/Views/Tile/RouteContentsTileView",["DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Views/Menu/ContentContextualMenu","DS/Core/PointerEvents","DS/ENORouteMgmt/Utilities/DragAndDropManager"],(function(e,t,o,i){"use strict";let n,s=function(){let t=e.tileView();t.onDragStartCell=function(e,t){i.getContentForDrag(e,t)},t.onDragEndCell=function(e,t){e.target.removeClassName("wux-ui-state-activated wux-ui-state-highlighted")},t.onDragEnterBlankDefault=function(e){},t.onDragEnterBlank=function(e){}};return{build:t=>function(t){n=t||new TreeDocument({useAsyncPreExpand:!0});let o=widget.getValue("ContentsTab-ShowView"),i="Contents-tileView-View hideView";o&&"TileView"==o&&(i="Contents-tileView-View showView");var a=UWA.createElement("div",{id:"tileViewContainer",class:i});let r=e.build(t,a,!0);return s(),r}(t),contexualMenuCallback:()=>function(){let o=e.tileView();o.onContextualEvent={callback:function(e){t.tileContextualMenu(e,n,(function(e){if("Update"==e.action){let e=n.getSelectedNodes();e.length>0&&o.lastSelectedNode.setAttribute("thumbnail",e[0].options.icons[0])}}))}}}()}})),define("DS/ENORouteMgmt/Views/RouteContentsView",["DS/ENORouteMgmt/Views/Grid/RouteContentsDataGridView","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Views/Tile/RouteContentsTileView","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Model/RouteContentModel","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Controller/RouteServicesController","DS/Core/PointerEvents","DS/ENORouteMgmt/Utilities/DragAndDrop","DS/ENORouteMgmt/Utilities/DragAndDropManager","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Services/RouteServices","DS/Controls/ProgressBar","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f){"use strict";let h,w;h=function(e,t){c.onDropManager(e)};let v=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&require(["DS/ENORouteMgmt/Views/Menu/ContentContextualMenu"],(function(o){var i=a.getModel().routeModel.state;o.contentsGridRightClick(e,t.nodeModel.options.grid,i,a.getModel().routeModel)}))},S=function(){let e=t.dataGridView();e.addEventListener(d.POINTERHIT,k),e.addEventListener("contextmenu",v),o.tileView().addEventListener(d.POINTERHIT,k),T()},k=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.multipleHitCount&&(t.nodeModel.select(!0),widget.routeMgmtMediator.publish("route-content-preview-click",{model:{id:t.nodeModel.options.grid.id}}))},T=function(){widget.routeMgmtMediator.subscribe("content-summary-append-rows",(function(e){a.appendRows(e)})),widget.routeMgmtMediator.subscribe("content-summary-delete-rows",(function(e){a.deleteRows(e)})),widget.routeMgmtMediator.subscribe("content-summary-delete-selected-rows",(function(){a.deleteSelectedRows()})),widget.routeMgmtMediator.subscribe("content-summary-update",(function(){R()})),widget.routeMgmtMediator.subscribe("route-data-updated",(function(e){a.getModel().routeModel=s.gridData(e),R()}))},R=function(){l.fetchRouteContents(a.getModel().RouteId).then((function(e){y(e,undefined,undefined,"ContentToReview")}))},y=function(t,o,s,l){var d=[],u=function(e){let t=[];return a.getModel(),(e=JSON.parse(e)).data[0].relateddata.contents.forEach((function(e){e.dataelements.id=e.id,e.dataelements.physicalid=e.id,e.dataelements.relId=e.relId,e.dataelements.type=e.type,e.dataelements.relation=f.contentToReview,e.dataelements.relationValue="Content to review",t.push(e.dataelements)})),e.data[0].relateddata.attachments.forEach((function(e){var o=[],i=e.dataelements.sConnectedTaskInformation;null!=i&&0!=i.length&&i.forEach((function(e){o.push(e.split("~")[1])})),e.dataelements.id=e.id,e.dataelements.physicalid=e.id,e.dataelements.relId=e.relId,e.dataelements.type=e.type,e.dataelements.relatedToTaskTitles=o,e.dataelements.relation=f.attachment,e.dataelements.relationValue="Attachment",t.push(e.dataelements)})),t}(t);u.forEach((function(e){d.includes(e.id)||d.push(e.id)}));var c;c=p.getPrecondForDocumentSearch();var g=n.getTenantValue(),h=b(),w={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:what/ds6w:status/ds6w:reserved","ds6w:who/ds6w:responsible/ds6w:reservedBy","file_locked_by","description"],select_file:["icon","thumbnail_2d"],query:c,order_by:"asc",order_field:"ds6w:label",nresults:1e3,start:"0",source:["3dspace"],tenant:g,resourceid_in:d,resourceid_not_in:[],with_synthesis:!1,with_synthesis_attribute:!1};widget&&widget.data&&widget.data.routeCredentials&&widget.data.routeCredentials.noSecurityContextForSearch||widget&&widget.data&&widget.data.noSecurityContextForSearch||(w.login=h),w=JSON.stringify(w);var v={isfederated:!0};let k=[];m.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",w,(function(t){let n=!0;if(t&&t.results&&Array.isArray(t.results)){t.results.forEach((function(e){var t=e.attributes;let o={reserved:"",reservedBy:"",reservedByUserName:""};t.forEach((function(e){"resourceid"===e.name&&(o.id=e.value),"ds6w:reserved"===e.name?o.reserved=e.value:"ds6w:reservedBy"===e.name?o.reservedBy=e.value:"file_locked_by"===e.name?o.reservedByUserName=e.value:"description"===e.name&&(o.description=e.value)})),k.push(o)})),n=d.length==k.length}for(let e=0;e<u.length;e++)if(n)for(let t=0;t<k.length;t++)u[e].id===k[t].id&&(u[e].reserved=k[t].reserved,u[e].reservedBy=k[t].reservedBy,u[e].reservedByUserName=k[t].reservedByUserName,u[e].description=k[t].description);else u[e].reserved="",u[e].reservedBy="",u[e].reservedByUserName="",u[e].description="";var c,p;"ContentToReview"==l?(a.getModel().removeRoots(),a.createModel(u,a.getModel().routeModel),0!=a.getModel().getChildren().length?widget.routeMgmtMediator.publish("hide-no-content-placeholder"):widget.routeMgmtMediator.publish("show-no-content-placeholder")):(a.destroy(),c=u,p=o.model,a.createModel(c,p),a.getModel().RouteId=p.id,a.getModel().routeModel=p,function(t,o){let n=a.getModel(),s=e.build(n),l=i.build(n);i.contexualMenuCallback(),S();let d=e.getGridViewToolbar(),u=UWA.createElement("div",{id:"dataGridContentsDivToolbar",class:"toolbar-container",styles:{width:"100%"}}).inject(o);d.inject(u),l.inject(o),s.inject(o);var c=!0;t.model.Actions.indexOf("add.contents")>=0&&"Complete"!=t.model.actualState&&(c=!1),0==n.getChildren().length&&r.showEmptyContentPlaceholder(o,c),r.registerListeners()}(o,s),D())}),(function(e){widget.notify.handler().addNotif({subtitle:f.noDataRetrieved,level:"error"})}),v)},b=function(){var e={};return e["3dspace"]={SecurityContext:n.getSecurityContextValue()},e},M=function(){let e=document.querySelector(".route-contents-container");w=new g({shape:"circular",infiniteFlag:!0,emphasize:"info",statusFlag:!1,height:60}),w.inject(e),w.elements.container.setStyle("margin-left","40%"),w.elements.container.setStyle("margin-top","10%")},D=function(){w.destroy()},C=function(){return null!=document.querySelector("#routeContentsContainer")&&(document.getElementById("routeContentsContainer").style.display="block",!0)};return{init:e=>function(e){if(!C()){let t=UWA.createElement("div",{id:"routeContentsContainer",class:"route-contents-container"});t.inject(document.querySelector(".route-facets-container")),u.makeDroppable(t,h),M(),l.fetchRouteContents(e.model.id).then((function(o){y(o,e,t)})),c.init(e),require(["DS/ENORouteMgmt/Views/Menu/ContentContextualMenu"],(function(e){e.isDocumentManagementInstalled()}))}}(e),hideView:()=>{null!=document.getElementById("routeContentsContainer")&&(document.getElementById("routeContentsContainer").style.display="none")},getModel:()=>a.getModel(),destroy:()=>{a.destroy()}}})),define("DS/ENORouteMgmt/Views/Dialogs/RemoveRoute",["DS/WAFData/WAFData","UWA/Core","DS/ENORouteMgmt/EnoviaBootstrap","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView","DS/ENORouteMgmt/Actions/RouteActions","DS/WebappsUtils/WebappsUtils","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/ENORouteMgmt/Config/RemoveRouteGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Model/RemoveRouteConfirmationModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h,w){"use strict";let v,S,k={},T=function(e){var t=UWA.createElement("div",{id:"removeRoute-dataGridViewContainer",class:"removeRoute-gridView-View"});k.cellDragEnabledFlag=!1,k.showRowBorderFlag=!0,k.showOutlineFlag=!0,k.showAlternateBackgroundFlag=!0;return k.layoutOptions={rowsHeader:!1,columnsHeader:!0,rowSpacing:5,cellWidth:2},k.showContextualMenuColumnFlag=!1,f.confirmationDialogueBuild(e,g,!1,t,k)},R=function(e,t){d.DeleteRoute(e,t),S.close()},y=function(e,t,o){d.removeSubRoute(e,t,o),S.close()};return v={removeConfirmation:(e,t)=>function(e,t){if(c.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Delete"}),void 0===e.data&&(e=r.getSelectedRowsModel()),e.data.length<1)return void widget.notify.handler().addNotif({level:"warning",subtitle:w.ErrorRouteRemoveSelection,sticky:!1});var o=[],a=[],l=[],d=[];let f=[];for(var v=0;v<e.data.length;v++)f.push(e.data[v].options.grid),"FALSE"==e.data[v].options.grid.DeleteAccess?(l.push(e.data[v].options.grid.id),d.push(e.data[v].options.grid.Title)):(o.push(e.data[v].options.grid.id),a.push(e.data[v].options.grid.Title));let k=new n;k.inject(document.body);let y=new UWA.Element("div",{id:"content",class:""}),b=new UWA.Element("div",{id:"removeRouteWarning",class:""});b.inject(y),g[4].visibleFlag=!1;var M,D,C="",E=!0,A="",O=!1;if(b.appendChild(UWA.createElement("div",{class:"warningicon",html:[{tag:"img",src:u.getWebappsAssetUrl("ENORouteMgmt","icons/32/MOM-Alerts.png")}]})),1==e.data.length)1==o.length?(O=!0,A=(A=w.removeRouteWarning).replace("{route}",a),b.appendChild(UWA.createElement("div",{class:"",text:A})),M=400,D="auto",C=(C=w.removeRouteHeaderSingle).replace("{count}",a),b.appendChild(UWA.createElement("div",{class:"",html:w.removeRouteWarningDetailSingle}))):(A="In Process"==e.data[0].options.grid.state&&"FALSE"==e.data[0].options.grid.DeleteAccess?w.removeRouteWarningDetail3Single:w.removeRouteWarningDetail2Single,C=w.removeRouteHeader2,A=A.replace("{route}",d),b.appendChild(UWA.createElement("div",{class:"",html:A})));else{h.createModel(f);let e=h.getModel(),t=T(e);M="auto",D="auto";let i=o.length+l.length;i<5?t.setStyle("height",50*i+"px"):t.setStyle("height","200px"),y.appendChild(t),l.length>0&&(g[4].visibleFlag=!0),0==o.length?(C=w.removeRouteHeader2,b.appendChild(UWA.createElement("div",{class:"",html:w.removeRouteWarningDetail2})),new UWA.Element("div",{html:"&nbsp;"}).inject(b),new UWA.Element("div",{html:"&nbsp;"}).inject(b),E=!0):(C=1==o.length?(C=w.removeRouteHeaderSingle).replace("{count}",a):(C=w.removeRouteHeader).replace("{count}",o.length),O=!0,b.appendChild(UWA.createElement("div",{class:"",html:w.removeRouteWarning2})),b.appendChild(UWA.createElement("div",{class:"",html:w.removeRouteWarningDetailSingle})))}if(1==O){new UWA.Element("div",{html:"&nbsp;"}).inject(b);var I=new p({type:"checkbox"});I.addChild(new m({type:"checkbox",label:w.removeRouteConfirmationButton,checkFlag:!1})),I.inject(b),I.addEventListener("buttonclick",(function(e){var t=e.dsModel.checkFlag;S.buttons.Ok.disabled=1!=t}))}S=new i({modalFlag:!0,width:M,height:D,title:C,content:y,domId:"RouteImmersiveFrame",immersiveFrame:k,resizableFlag:!0,buttons:{Ok:new s({label:w.Delete,domId:"RemoveRouteButton",disabled:E,onClick:function(e){e.dsModel.dialog,R(o,t)}}),Cancel:new s({onClick:function(e){e.dsModel.dialog.close()}})}})}(e,t),removeSubRouteConfirmation:e=>function(e){c.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Delete Subroute"});var t=widget.data.contextId,a=widget.data.contextTitle;if(void 0===e.data&&(e=r.getSelectedRowsModel()),e.data.length<1)return void widget.notify.handler().addNotif({level:"warning",subtitle:w.ErrorSubRouteRemoveSelection,sticky:!1});for(var l=[],d=[],p=[],m=[],f=[],v=[],k=0;k<e.data.length;k++)m.push(e.data[k].options.grid),e.data[k].options.grid.UserName!=o.getLoginUser()?(p.push(e.data[k].options.grid.id),v.push(e.data[k].options.grid.Title)):(l.push(e.data[k].options.grid.id),d.push(e.data[k].options.grid.UserName),f.push(e.data[k].options.grid.Title));let R=new n;R.inject(document.body);let b=new UWA.Element("div",{id:"content",class:""}),M=new UWA.Element("div",{id:"removeRouteWarning",class:""});M.inject(b),g[4].visibleFlag=!1;var D,C,E="",A=!1,O="";if(M.appendChild(UWA.createElement("div",{class:"warningicon",html:[{tag:"img",src:u.getWebappsAssetUrl("ENORouteMgmt","icons/32/MOM-Alerts.png")}]})),1==e.data.length)1==l.length?(D=400,C="auto",E=(E=w.removeSubRouteHeaderSingle).replace("{count}",f),O=(O=(O=w.removeSubRouteWarningDetailSingle).replace("{Route}",f)).replace("{Task}",a),M.appendChild(UWA.createElement("div",{class:"",html:O}))):(A=!0,E=w.removeSubRouteHeader2,O=(O=w.removeSubRouteWarningDetail2Single).replace("{route}",v),M.appendChild(UWA.createElement("div",{class:"",html:O})));else{h.createModel(m);let e=h.getModel(),t=T(e);D=800,C="auto";let o=l.length+p.length;o<5?t.setStyle("height",50*o+"px"):t.setStyle("height","200px"),b.appendChild(t),p.length>0&&(g[4].visibleFlag=!0),0==l.length?(E=(E=w.removeSubRouteHeader).replace("{count}",l.length),M.appendChild(UWA.createElement("div",{class:"",html:w.removeSubRouteWarningDetail})),new UWA.Element("div",{html:"&nbsp;"}).inject(M),new UWA.Element("div",{html:"&nbsp;"}).inject(M),A=!0):(E=1==l.length?(E=w.removeSubRouteHeaderSingle).replace("{count}",f):(E=w.removeSubRouteHeader).replace("{count}",l.length),O=(O=w.removeSubRouteWarningDetail).replace("{Task}",a),M.appendChild(UWA.createElement("div",{class:"",html:O})),new UWA.Element("div",{html:"&nbsp;"}).inject(M),new UWA.Element("div",{html:"&nbsp;"}).inject(M))}S=new i({modalFlag:!0,width:D,height:C,title:E,content:b,domId:"RouteImmersiveFrame",immersiveFrame:R,buttons:{Ok:new s({label:w.remove,domId:"RemoveSubRouteButton",disabled:A,onClick:function(e){e.dsModel.dialog,y(l,t,d)}}),Cancel:new s({onClick:function(e){e.dsModel.dialog.close()}})}})}(e)},v})),define("DS/ENORouteMgmt/Views/Menu/RouteContextualMenu",["DS/Menu/Menu","DS/ENORouteMgmt/Views/Dialogs/RemoveRoute","DS/ENORouteMgmt/Actions/RouteActions","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Views/Dialogs/InitiateSaveAsTemplateDialog","DS/ENORouteMgmt/Views/Dialogs/RouteChangeOwnershipDialog","DS/RouteWebAppUX/Views/Menu/AttachmentContextualMenuItems","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l){"use strict";let d,u=function(e,o){let i=!0;1===e.data.length&&"TRUE"!=e.data[0].options.grid.DeleteAccess&&(i=!1);var n=[];return i&&n.push({name:l.Delete,title:l.Delete,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash"},data:null,action:{callback:function(){t.removeConfirmation(e,o)}}}),n},c=function(e){var t=[];return-1!==e.data[0].options.grid.Actions.indexOf("saveAs")&&t.push({name:l.SaveasTemplate,title:l.SaveasTemplate,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-template-add"},data:null,action:{callback:function(){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Save as Template"}),n.InitiateSaveAsTemplateDialog(e)}}}),t},p=function(e){var t=[];return t.push({name:l.revisions,title:l.revisions,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-branch-list"},data:null,action:{callback:function(){o.renderRevisionsDialog(e.data[0].options.grid.id)}}}),t},m=function(e){var t=[];return t.push({name:l.Open,title:l.Open,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open"},data:null,action:{callback:function(){widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:e})}}}),t},g=function(e,t){var o=[];return o.push({name:l.changeOwner,title:l.changeOwner,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-user-change"},data:null,action:{callback:function(){s.routeChangeOwner(e,t)}}}),o},f=function(e,t,i,n){var s=[];return e?(-1!==e.indexOf("edit.startroute")&&s.push({name:l.start,title:l.start,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-status-change"},data:null,action:{callback:function(){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Start"}),o.startRoute(t)}}}),-1!==e.indexOf("edit.stoproute")&&s.push({name:l.stop,title:l.stop,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-stop"},data:null,action:{callback:function(){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Stop"}),o.stopRoute(t,i)}}}),-1!==e.indexOf("edit.resumeroute")&&s.push({name:l.resume,title:l.resume,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-resume"},data:null,action:{callback:function(){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Resume"}),o.resumeRoute(t)}}}),-1!==e.indexOf("edit.restartroute")&&s.push({name:l.restart,title:l.restart,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reset"},data:null,action:{callback:function(){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Restart"}),o.restartRoute(t,n)}}}),s):s},h=function(e){var o=[];return o.push({name:l.remove,title:l.remove,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove"},data:null,action:{callback:function(){t.removeSubRouteConfirmation(e)}}}),o};return d={routeIdCardCheveron:t=>function(t){return UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-3x wux-ui-3ds-chevron-down fonticon-display fonticon-color-display",title:l.idCardHeaderActionRouteAction,styles:{"padding-top":"0px"},events:{click:function(o){var i=o.target.getBoundingClientRect(),n={position:{x:i.left,y:i.top+20}},s=u(t,!0);s=(s=s.concat(p(t))).concat(c(t)),-1!=t.data[0].options.grid.Actions.indexOf("changeowner")&&(s=s.concat(g(t,"idCard"))),s=s.concat(a.getCopyLink(t.data)),e.show(s,n)}}})}(t),routeIdCardStateCheveron:(t,o,i)=>function(t,o,i){return t?-1===t.findIndex((e=>e.includes("edit.")))?"":UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-chevron-down ",title:l.idCardHeaderRouteActivityState,styles:{"font-size":"18px","line-height":"24px"},events:{click:function(n){var s=n.target.getBoundingClientRect(),a={position:{x:s.left,y:s.top+20}},r=f(t,o,i,"idcard-ctxCommand");e.show(r,a)}}}):""}(t,o,i),routeGridCheveron:(t,o)=>function(t,o){return UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-chevron-down ",events:{click:function(n){n.preventDefault(),n.stopPropagation();var s=n.target.getBoundingClientRect(),a={position:{x:s.left,y:s.top+20}},r=i.getSelectedRowsModel(),l=[];if(1===r.data.length){l=l.concat(m(r.data[0].options.grid));var d=r.data[0].options.grid.Title;l=(l=l.concat(f(t,o,d,"summarypage-ctxCommand"))).concat(p(r))}l=l.concat(u(r,!1)),null!=widget.data.contextTitle&&""!=widget.data.contextTitle&&(l=l.concat(h(r))),e.show(l,a)}}})}(t,o),routeTileCheveron:(e,t)=>function(e,t){var o=i.getSelectedRowsModel(),n=[];if(1===o.data.length){n=n.concat(m(o.data[0].options.grid));var s=o.data[0].options.grid.Title;n=(n=n.concat(f(e,t,s,"summarypage-ctxCommand"))).concat(p(o)),-1!=o.data[0].options.grid.Actions.indexOf("changeowner")&&(n=n.concat(g(o,"summaryPage"))),n=n.concat(a.getCopyLink(o.data))}return o.data.length>1&&(n=n.concat(g(o,"summaryPage"))),n=n.concat(u(o,!1)),null!=widget.data.contextTitle&&""!=widget.data.contextTitle&&(n=n.concat(h(o))),n}(e,t),routeMaturityStateMenus:(e,t,o,i)=>f(e,t,o,i),routeGridRightClick:(t,o)=>function(t,o){t.preventDefault(),t.stopPropagation();var n=t.target.getBoundingClientRect(),s={position:{x:n.left,y:n.top+20}},r=i.getSelectedRowsModel(),l=[];1===r.data.length&&(l=(l=(l=l.concat(m(o))).concat(f(o.Actions,o.id,o.Title,"summarypage-ctxCommand"))).concat(p(r)),-1!=o.Actions.indexOf("changeowner")&&(l=l.concat(g(r,"summaryPage"))),l=l.concat(a.getCopyLink(r.data))),r.data.length>1&&(l=l.concat(g(r,"summaryPage"))),l=l.concat(u(r,!1)),null!=widget.data.contextTitle&&""!=widget.data.contextTitle&&(l=l.concat(h(r))),e.show(l,s)}(t,o)},d})),define("DS/ENORouteMgmt/Views/Form/InitiateTaskPanelFields",["DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Controls/DatePicker","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/ENORouteMgmt/Views/Form/TaskInViewMode","DS/ENORouteMgmt/Views/Form/TaskInEditMode","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Model/ContentToReviewModel","DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel","DS/ENORouteMgmt/Views/Grid/TaskAssociatedContent","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","DS/ENORouteMgmt/Utilities/TaskPanelSubscribeEvents","DS/ENORouteMgmt/Views/Form/CreateTaskProperties","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Utilities/DragAndDropOnTaskInputField","DS/ENORouteMgmt/Utilities/Search/DndSearchUtil","DS/ENORouteMgmt/Views/Menu/TaskPanelContextualMenu","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/Controls/ButtonGroup","DS/Controls/TooltipModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h,w,v,S,k,T,R,y,b,M,D,C){"use strict";let E,A,O,I,N,U=S.getTaskCreateVariables(),_=function(){U.taskActionMode=!1,U.taskEditMode=!1,U.fieldViewOnly=!1,U.inboxTaskFieldViewOnly=!1,U.fieldRequired="required",U._taskProperties.closeEventName="route-task-close-click",UWA.createElement("div",{id:"taskViewPanelClose",title:C.taskFormCloseTooltip,class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-close fonticon-display fonticon-color-display",styles:{"font-size":"14px",float:"right"},events:{click:function(e){widget.routeMgmtMediator.publish(U._taskProperties.closeEventName),v.destroy(U.mode,U)}}}).inject(U._taskProperties.formHeader),"taskActionMode"==U.mode&&"HRL1"==U.data.model.taskAcceptLink&&UWA.createElement("div",{title:C.taskFormAcceptTaskTooltip,class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-user-ok fonticon-display fonticon-color-display",styles:{"font-size":"20px",float:"right"},events:{click:function(e){l.taskAccept(U.data,U._routeInfo,"callFromPanel")}}}).inject(U._taskProperties.formHeader),("Route Template"==U._routeInfo.Type||null==U._routeInfo.Type&&("No"==U._taskGraphModel.options.grid.templateTask||"Yes"==U._taskGraphModel.options.grid.templateTask&&"Modify/Delete Task List"==U._taskGraphModel.options.grid.taskEditSetting))&&y.renderHeaderCheveronIcon(U)},F=function(e,t){U._routeInfo.BasePurpose&&(U._routeInfo.routeBasePurpose=U._routeInfo.BasePurpose);var o=l.expectedActionElemList(U._routeInfo.routeBasePurpose,U.data.model.routeOwnerTask);U._taskProperties.elements.expectedAction=new n({elementsList:o,value:t,enableSearchFlag:!1}).inject(e),"Route Template"==U._routeInfo.Type&&U._taskProperties.elements.expectedAction.addEventListener("change",(function(e){let t=e.dsModel.selectedIndex;t=t=0==t?"Approve":1==t?"Notify Only":"Comment","Approve"==t||"Comment"==t?(1==U._taskProperties.elements.radioAssigneeChooser.checked&&(U._taskProperties.elements.taskAssigneeChooser.disabled=!1,U._taskProperties.elements.assignee._editor.elements.inputField.disabled=!1),U._taskProperties.elements.radioAssigneeRouteOwner.disabled=!1,1==U._taskProperties.elements.radioAssigneeRouteOwner.checked&&(U._taskProperties.taskAssignmentScopeField.className="fonticon-chooser-display",U._taskProperties.formFields.querySelector("#assignmentScopeLabel").show())):(U._taskProperties.elements.radioAssigneeChooser.checked=!0,U._taskProperties.elements.taskAssigneeChooser.disabled=!1,U._taskProperties.elements.assignee._editor.elements.inputField.disabled=!1,U._taskProperties.elements.radioAssigneeRouteOwner.disabled=!0,U._taskProperties.elements.assignmentScope.selectedItems=void 0,U._taskProperties.taskAssignmentScopeField.className="fonticon-chooser-scope-display",U._taskProperties.formFields.querySelector("#assignmentScopeLabel").hide())}))},P=function(){E=B("initiate-Task-Field",U._taskProperties.formFields),E.setAttribute("id","contentToreviewAutoComplete"),A=B("initiate-Task-Field-Label",E),O=new UWA.Element("div").inject(E),O.style.width="2%",I=B("initiate-Task-Field-Value",E),U._taskProperties.contentToReviewField=d.getRouteTaskContentToReviewField(U._taskProperties,U._routeInfo,U.mode,U.data,I),A=d.renderRouteTaskContentToReviewField(U._taskProperties,U.mode,U._routeInfo,A),U._taskProperties.contentToReviewField.inject(I),new UWA.Element("div",{html:"&nbsp;"}).inject(I);var e=new UWA.Element("div",{class:"contentToReviewButton"}).inject(I);d.drawContentToReviewSearchButton(U._taskProperties,U.mode,U._routeInfo).inject(e),U.data.model.contentToReviewFieldInfo&&0!=U.data.model.contentToReviewFieldInfo.length&&U.data.model.contentToReviewFieldInfo.forEach((function(e){var t=new r({label:e.title,value:e.id});t.options.grid=e,null==U._taskProperties.contentToReviewField.selectedItems?U._taskProperties.contentToReviewField.selectedItems=t:U._taskProperties.contentToReviewField.selectedItems.push(t),U._taskProperties.contentToReviewField._applySelectedItems()}))},x=function(){"Route Template"==U._routeInfo.Type?function(){E=B("initiate-Task-Field",U._taskProperties.formFields),A=B("initiate-Task-Field-Label",E),O=new UWA.Element("div").inject(E),O.style.width="2%",I=B("initiate-Task-Field-Value",E);let e=new UWA.Element("div").inject(I);e.style.width="100%";var t=new UWA.Element("div",{id:"assigneeId",class:""}).inject(A);U.inboxTaskFieldViewOnly?new UWA.Element("h5",{class:"",text:C.taskassignee}).inject(t).tooltipInfos=q(C.taskassignee):(U.labelAttr=new UWA.Element("h5",{class:U.fieldRequired,text:C.taskassignee}).inject(t),U.labelAttr.tooltipInfos=q(C.taskassignee),U.fieldRequired&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(U.labelAttr));null==U.data.model.taskAssignee&&(U.data.model.taskAssignee=""),null==U.data.model.assigneeTitle&&(U.data.model.assigneeTitle="");var i=U.data.model.taskAssignee;U.data.model.assigneeType&&(i="Person"==U.data.model.assigneeType?U.data.model.taskAssignee:U.data.model.assigneeTitle),U._taskProperties.currentValue.assigneeId=U.data.model.assigneePID;var n=!0;"TRUE"==U.data.model.routeOwnerTask&&(n=!1),U._taskProperties.radioAssigneeChooserDiv=new UWA.Element("div",{id:"radioAssigneeChooserDiv",class:"fonticon-chooser-display fit-content"}).inject(e),U._taskProperties.elements.radioAssigneeChooser=new UWA.Element("input",{type:"radio",name:"AssigneeOption",value:"1",checked:n,class:"cursor-pointer"}),U._taskProperties.elements.radioAssigneeChooser.inject(U._taskProperties.radioAssigneeChooserDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(U._taskProperties.radioAssigneeChooserDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(U._taskProperties.radioAssigneeChooserDiv),N=G("taskAssigneeInfo",C.initiateTaskAssignee,A),U._taskProperties.radioAssigneeRouteOwnerTaskDiv=new UWA.Element("div",{id:"radioAssigneeRouteOwnerTask",class:"fonticon-chooser-display fit-content"}).inject(e);let s=B("initiate-Route-Field-LinkedTemplate",U._taskProperties.taskAssignmentScopeField),a=B("initiate-Route-Field-Label-LinkedTemplate",s);new UWA.Element("div").inject(s).style.width="2%",U._taskProperties.taskAssignmentScopeField.inject(U._taskProperties.formFields),U._taskProperties.elements.radioAssigneeRouteOwner=new UWA.Element("input",{type:"radio",name:"AssigneeOption",value:"2",checked:!n,class:"cursor-pointer"}),U._taskProperties.elements.radioAssigneeRouteOwner.inject(U._taskProperties.radioAssigneeRouteOwnerTaskDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(U._taskProperties.radioAssigneeRouteOwnerTaskDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(U._taskProperties.radioAssigneeRouteOwnerTaskDiv);var d,u={};u.isMultiSearchMode=!1,u.placeHolderValue=C.searchTaskAssigneePlaceHolder,u.minLengthToType=3,u.isFreeInputAllowed=!1,u.toKeepSearchResultsFlag=!1,"OnPremise"!=c.getTenantValue()&&(u.source=["3dspace","usersgroup"]),u.getPrecond=function(){return m.getPrecondForTaskMemberSearch(U._routeInfo)},u.getValidation=function(){return l.validationForAssigneeField(U._routeInfo)},u.getChangeHandler=function(){return l.changeHandlerForAssigneeField(U._taskProperties,U._routeInfo,U._taskGraphModel)},U._taskProperties.elements.assignee=p.drawAutoCompleteComponent(u),n?(U._taskProperties.elements.assignee._editor.elements.inputField.disabled=!1,null!=i&&""!=i&&(d=new r({label:i,value:U.data.model.assigneeId,name:U.data.model.taskAssigneeUsername,type:U.data.model.assigneeType}),U._taskProperties.elements.assignee.selectedItems=d)):(U._taskProperties.elements.assignee.selectedItems=void 0,U._taskProperties.elements.assignee._editor.elements.inputField.disabled=!0),U._taskProperties.elements.assignee.inject(U._taskProperties.radioAssigneeChooserDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(U._taskProperties.radioAssigneeChooserDiv),U._taskProperties.elements.taskAssigneeChooser=new o({icon:{iconName:"search"},disabled:!n}),U._taskProperties.elements.taskAssigneeChooser.inject(U._taskProperties.radioAssigneeChooserDiv),U._taskProperties.elements.taskAssigneeChooser.getContent().addEventListener("buttonclick",(function(){l.launchAssigneeSearch(event,U._taskProperties,U._routeInfo,U._taskGraphModel)})),U._taskProperties.taskAssigneeField.inject(U._taskProperties.radioAssigneeChooserDiv),U._taskProperties.routeOwnerTaskDiv=new UWA.Element("div",{id:"routeOwnerTaskId",class:""}).inject(U._taskProperties.radioAssigneeRouteOwnerTaskDiv);let g=UWA.createElement("span",{class:"task-days-from-text",text:C.routeOwnerTask});g.tooltipInfos=q(C.routeOwnerTask),new UWA.Element("div",{id:"routeOwnerTaskTextDiv",html:[g]}).inject(U._taskProperties.radioAssigneeRouteOwnerTaskDiv),""==U._taskProperties.elements.expectedAction.value||"Approve"!=U._taskProperties.elements.expectedAction.value&&"Comment"!=U._taskProperties.elements.expectedAction.value?(U._taskProperties.routeOwnerTaskDiv.style.display="none",U._taskProperties.elements.radioAssigneeRouteOwner.disabled=!0):U._taskProperties.routeOwnerTaskDiv.style.display="";var f,h={};h.isMultiSearchMode=!1,h.placeHolderValue=C.searchPlaceHolderAssignmentScope,h.minLengthToType=3,h.isFreeInputAllowed=!1,h.toKeepSearchResultsFlag=!1,"OnPremise"!=c.getTenantValue()&&(h.source=["usersgroup"]),h.getPrecond=function(){return m.getPrecondForRouteOwnerAssignmentScope(U._routeInfo)},U._taskProperties.elements.assignmentScope=p.drawAutoCompleteComponent(h),null!=U.data.model.routeOwnerUGTitle&&""!=U.data.model.routeOwnerUGTitle&&null!=U.data.model.routeOwnerUGChoice&&""!=U.data.model.routeOwnerUGChoice&&null!=U.data.model.routeOwnerUGName&&""!=U.data.model.routeOwnerUGName&&(f=new r({label:U.data.model.routeOwnerUGTitle,value:U.data.model.routeOwnerUGChoice,name:U.data.model.routeOwnerUGName}),U._taskProperties.elements.assignmentScope.selectedItems=f);let w=B("initiate-Route-Field-Value-LinkedTemplate",s);new UWA.Element("h5",{class:"",id:"assignmentScopeLabel",text:"     "+C.routeOwnerTaskAssignmentScope}).inject(a).tooltipInfos=q(C.routeOwnerTaskAssignmentScope),U._taskProperties.elements.assignmentScope.inject(w),new UWA.Element("div",{html:"&nbsp;"}).inject(w),U._taskProperties.elements.assignmentScopeChooser=new o({icon:{iconName:"search"}}),U._taskProperties.elements.assignmentScopeChooser.inject(w),N=G("taskAssignmentScopeInfo",C.taskAssignmentScopeInfo,a),U._taskProperties.elements.assignmentScopeChooser.getContent().addEventListener("buttonclick",(function(){l.launchAssignmentScopeSearch(event,U._taskProperties,U._routeInfo,U._taskGraphModel)})),n?U._taskProperties.formFields.querySelector("#assignmentScopeLabel").hide():(U._taskProperties.taskAssignmentScopeField.className="fonticon-chooser-display",U._taskProperties.formFields.querySelector("#assignmentScopeLabel").show()),U._taskProperties.elements.radioAssigneeChooser.onclick=function(e){U._taskProperties.routeOwnerTaskDiv.style.display="none",U._taskProperties.elements.taskAssigneeChooser.disabled=!1,U._taskProperties.elements.assignee._editor.elements.inputField.disabled=!1,U._taskProperties.taskAssignmentScopeField.className="fonticon-chooser-scope-display",U._taskProperties.formFields.querySelector("#assignmentScopeLabel").hide(),U._taskProperties.elements.assignmentScope.selectedItems=void 0},U._taskProperties.elements.radioAssigneeRouteOwner.onclick=function(e){U._taskProperties.routeOwnerTaskDiv.style.display="",U._taskProperties.elements.taskAssigneeChooser.disabled=!0,U._taskProperties.elements.assignee._editor.elements.inputField.disabled=!0,U._taskProperties.taskAssignmentScopeField.className="fonticon-chooser-display",U._taskProperties.formFields.querySelector("#assignmentScopeLabel").show(),U._taskProperties.elements.assignee.selectedItems=void 0,U._taskProperties.elements.assignmentScope._editor.elements.inputField.focus()}}():function(){if("TRUE"==U.data.model.routeOwnerTask){var e=new UWA.Element("div",{id:"assigneeId",class:""}).inject(U._taskProperties.formFields);E=B("initiate-Task-Field",e),A=B("initiate-Task-Field-Label",E),O=new UWA.Element("div").inject(E),O.style.width="2%",I=B("initiate-Task-Field-Value",E);let a=new UWA.Element("h5",{class:"",text:C.taskassignee}).inject(A);var t;a.tooltipInfos=q(C.taskassignee),"create"==U.mode?(s=c.getLoginUserFullName(),t=c.getLoginUser()):(s=U.data.model.taskAssignee,t=U.data.model.taskAssigneeUsername),a=new UWA.Element("span",{text:s}).inject(I),a.tooltipInfos=q(C.assigneeDisplayValue);var o,i="contextUser";if(U.taskGraphModel.model.routePropertiesInfo.model&&(i=U.data.model.assigneeId),null!=s&&""!=s&&(o=new r({label:s,value:i,name:t,type:"Person"}),U._taskProperties.elements.assignee={selectedItems:o}),""!=U.data.model.routeOwnerUGChoice&&null!=U.data.model.routeOwnerUGChoice&&U.data.model.routeOwnerUGChoice.length>0){var n=new UWA.Element("div",{id:"routeOwnerUserGroupId",class:""}).inject(U._taskProperties.formFields);let e=new UWA.Element("h5",{text:C.assignmentScope}).inject(n);e.tooltipInfos=q(C.assignmentScope),N=G("taskAssignmentScopeAssigneeInfo",C.initiateTaskAssignee,A),e=new UWA.Element("span",{text:U.data.model.routeOwnerUGTitle}).inject(n),e.tooltipInfos=q(U.data.model.routeOwnerUGTitle)}}else{e=new UWA.Element("div",{id:"assigneeId",class:""}).inject(U._taskProperties.formFields),null==U.data.model.taskAssignee&&(U.data.model.taskAssignee=""),null==U.data.model.assigneeTitle&&(U.data.model.assigneeTitle="");var s=U.data.model.taskAssignee;U.data.model.assigneeType&&(s="Person"==U.data.model.assigneeType?U.data.model.taskAssignee:U.data.model.assigneeTitle),U._taskProperties.currentValue.assigneeId=U.data.model.assigneePID,U.fieldViewOnly||U.inboxTaskFieldViewOnly||l.canLoadInViewMode(U.data,U._routeInfo)&&"Modify Task List"!=U._routeInfo.taskEditSetting?d.drawAssigneeInViewMode(e,U.data,U._taskProperties,s):u.drawAssigneeInEditMode(e,U.data,U._taskProperties,U.fieldRequired,U._routeInfo,U._taskGraphModel,s)}}()},V=function(){var t=new UWA.Element("div",{id:"dueDateId",class:""}).inject(U._taskProperties.formFields);E=B("initiate-Task-Field",t),A=B("initiate-Task-Field-Label",E),O=new UWA.Element("div").inject(E),O.style.width="2%",I=B("initiate-Task-Field-Value",E);let o=new UWA.Element("div").inject(I);o.style.width="100%",U.labelAttr=new UWA.Element("h5",{class:U.fieldRequired,text:C.dueDateAndTime}).inject(A),U.labelAttr.tooltipInfos=q(C.dueDateAndTime),U.fieldRequired&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(U.labelAttr),o=function(e){return U._taskProperties.elements.radioDueDateOption1=new UWA.Element("input",{type:"radio",name:"dueDate",value:"1",checked:!0,class:"cursor-pointer"}),U._taskProperties.elements.radioDueDateOption1.inject(U._taskProperties.dueDateDivOption1),new UWA.Element("div",{html:"&nbsp;"}).inject(U._taskProperties.dueDateDivOption1),U._taskProperties.elements.dueDateOptionSelected=1,U._taskProperties.elements.radioDueDateOption1.onclick=function(){l.enableDisableDueDateOptions(U._taskProperties.elements.radioDueDateOption1.value,U._taskProperties)},new UWA.Element("div",{html:"&nbsp;"}).inject(U._taskProperties.dueDateDivOption1),(U.taskDueDate-U.taskMinDate)/864e5<0&&(U.taskMinDate=U.taskDueDate),U._taskProperties.elements.radioDueDateOption1Date=new s({value:new Date(U.taskDueDate),minValue:new Date(U.taskMinDate),timePickerFlag:!0}),U._taskProperties.elements.radioDueDateOption1Date.inject(U._taskProperties.dueDateDivOption1),U._taskProperties.dueDateDivOption1.inject(U._taskProperties.dueDateDiv),"Route Template"==U._routeInfo.Type&&(U._taskProperties.dueDateDivOption1.style.display="none",1==U.dueDateOptionPreviouslySelected&&(U.dueDateOptionPreviouslySelected=3),U._taskProperties.radioAssigneeChooserDiv.querySelector("#SearchTaskAssigneeField").style.width="0%"),U._taskProperties.dueDateDiv.inject(e),e}(o),o=function(t){var o=!1;return 2==U.dueDateOptionPreviouslySelected&&(o=!0),U._taskProperties.elements.radioDueDateOption2=new UWA.Element("input",{type:"radio",name:"dueDate",value:"2",checked:o,class:"cursor-pointer"}).inject(t),U._taskProperties.elements.radioDueDateOption2.inject(U._taskProperties.dueDateDivOption2),new UWA.Element("div",{html:"&nbsp;"}).inject(U._taskProperties.dueDateDivOption2),U._taskProperties.elements.radioDueDateOption2.onclick=function(){l.enableDisableDueDateOptions(U._taskProperties.elements.radioDueDateOption2.value,U._taskProperties)},new UWA.Element("div",{html:"&nbsp;"}).inject(U._taskProperties.dueDateDivOption2),U.data.model.dueDateOffset||(U.data.model.dueDateOffset=""),U._taskProperties.elements.radioDueDateOption2DaysFrom=new e({pattern:"[0-9]+",sizeInCharNumber:1,disabled:!0,value:U.data.model.dueDateOffset}),U._taskProperties.elements.radioDueDateOption2DaysFrom.inject(U._taskProperties.dueDateDivOption2),new UWA.Element("div",{html:"&nbsp;"}).inject(U._taskProperties.dueDateDivOption2),new UWA.Element("div",{html:[UWA.createElement("span",{class:"task-days-from-text",text:C.dueDateTextStartsFrom})]}).inject(U._taskProperties.dueDateDivOption2).style.marginTop="7px",new UWA.Element("div",{html:"&nbsp;"}).inject(U._taskProperties.dueDateDivOption2),U._taskProperties.elements.radioDueDateOption2ComboBox=new n({elementsList:[{labelItem:C.dueDateFromRouteStart,valueItem:"Route Start Date"},{labelItem:C.dueDateFromPriorTask,valueItem:"Task Create Date"}],value:U.data.model.dateOffsetFrom,enableSearchFlag:!1,disabled:!0}),U._taskProperties.elements.radioDueDateOption2ComboBox.addEventListener("change",(function(e){0==U._taskProperties.elements.radioDueDateOption2ComboBox._lastValidatedSelectedIndex?U._taskProperties.elements.radioDueDateOption2ComboBox.tooltipInfos=q(C.dueDateFromRouteStart):1==U._taskProperties.elements.radioDueDateOption2ComboBox._lastValidatedSelectedIndex&&(U._taskProperties.elements.radioDueDateOption2ComboBox.tooltipInfos=q(C.dueDateFromPriorTask))})),U._taskProperties.elements.radioDueDateOption2ComboBox.tooltipInfos=q(C.dueDateFromRouteStart),U._taskProperties.elements.radioDueDateOption2ComboBox.inject(U._taskProperties.dueDateDivOption2),U._taskProperties.dueDateDivOption2.inject(U._taskProperties.dueDateDiv),U._taskProperties.dueDateDiv.inject(t),t}(o),o=function(e){var t=!1;3==U.dueDateOptionPreviouslySelected&&(t=!0),U._taskProperties.elements.radioDueDateOption3=new UWA.Element("input",{type:"radio",name:"dueDate",value:"3",checked:t,class:"cursor-pointer"}).inject(e),U._taskProperties.elements.radioDueDateOption3.inject(U._taskProperties.dueDateDivOption3),new UWA.Element("div",{html:"&nbsp;"}).inject(U._taskProperties.dueDateDivOption3),U._taskProperties.elements.radioDueDateOption3.onclick=function(){l.enableDisableDueDateOptions(U._taskProperties.elements.radioDueDateOption3.value,U._taskProperties)},new UWA.Element("div",{html:"&nbsp;"}).inject(U._taskProperties.dueDateDivOption3);let o=new UWA.Element("span",{html:C.assigneeSetDueDate}).inject(U._taskProperties.dueDateDivOption3);return o.tooltipInfos=q(C.assigneeSetDueDate),U._taskProperties.elements.radioDueDateOption3Text=o,o.style.marginTop="2px",U._taskProperties.dueDateDivOption3.inject(U._taskProperties.dueDateDiv),U._taskProperties.dueDateDiv.inject(e),e}(o),N="none"==U._taskProperties.dueDateDivOption1.style.display?G("taskDueDateInfo",C.initiateTemplateTaskDueDate,A):G("taskDueDateInfo",C.initiateTaskDueDate,A),U.dueDateOptionPreviouslySelected&&l.enableDisableDueDateOptions(U.dueDateOptionPreviouslySelected,U._taskProperties)},W=function(){let e={element:"priority",type:"buttonToggle",placeholder:"place",required:!1,id:["Low","Medium","High","Urgent"]};e.value=[C.low,C.medium,C.high,C.urgent],e.label=["Low","Medium","High","Urgent"],e.emphasize=["success","info","medium-attention","high-attention"],e.icons=["level-low","level-medium","level-high","alert"];var t=function(e){var t=new M({type:"radio"}),i=[];let n={Low:0,Medium:1,High:2,Urgent:3}[U._taskGraphModel.options.grid.routeTaskPriority];return null==n&&(n=1),e.value.forEach((function(s,a){var r=new o({label:s,type:"radio",value:e.id[a],icon:{iconName:e.icons[a],fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},emphasize:e.emphasize[a],checkFlag:a===n});r.tooltipInfos=new D({shortHelp:s,allowUnsafeHTMLShortHelp:!0}),t.addEventListener("buttonclick",(function(e){U._taskProperties.elements.routeTaskPriorityValue=e.dsModel.value,b.makeResponsiveCss("routeTaskPanel","#InitiateTaskPropertiesContainer")})),i.push(r),t.addChild(r)})),t}(e);return U._taskProperties.elements.routeTaskPriorityGroup=UWA.createElement("div",{id:"priorityDiv",class:"create-task-properties-form-element-priority"}),t.inject(U._taskProperties.elements.routeTaskPriorityGroup),U._taskProperties.elements.routeTaskPriorityGroup},L=function(){var e,n;e=new UWA.Element("div",{id:"titleId",class:""}).inject(U._taskProperties.formFields),U.fieldViewOnly||U.inboxTaskFieldViewOnly||l.canLoadInViewMode(U.data,U._routeInfo)?d.drawTitleInViewMode(e,U.data,U._taskProperties):u.drawTitleInEditMode(e,U.data,U._taskProperties,U.fieldRequired),function(){var e=new UWA.Element("div",{id:"expectedActionId",class:""}).inject(U._taskProperties.formFields);E=B("initiate-Task-Field",e),A=B("initiate-Task-Field-Label",E),O=new UWA.Element("div").inject(E),O.style.width="2%",I=B("initiate-Task-Field-Value",E);var t="Comment";U.data.model.taskAction&&""!=U.data.model.taskAction&&(t=U.data.model.taskAction),U.inboxTaskFieldViewOnly?new UWA.Element("h5",{class:"",text:C.taskActiontitle}).inject(A).tooltipInfos=q(C.taskActiontitle):(U.labelAttr=new UWA.Element("h5",{class:U.fieldRequired,text:C.taskAction}).inject(A),U.labelAttr.tooltipInfos=q(C.taskAction));U.fieldViewOnly||U.inboxTaskFieldViewOnly||(N=G("taskExpectedActionInfo",C.initiateTaskExpectedAction,A)),F(I,t)}(),U._taskProperties.elements.routeTaskPriority=new UWA.Element("div",{id:"taskPriorityId",class:""}).inject(U._taskProperties.formFields),E=B("initiate-Task-Field",U._taskProperties.elements.routeTaskPriority),A=B("initiate-Task-Field-Label",E),O=new UWA.Element("div").inject(E),O.style.width="2%",I=B("initiate-Task-Field-Value",E),new UWA.Element("h5",{class:"",text:C.priority}).inject(A).tooltipInfos=q(C.priority),N=G("priorityTitleInfo",C.priorityTitleInfo,A),W().inject(I),function(){E=B("initiate-Task-Field",U._taskProperties.formFields),A=B("initiate-Task-Field-Label",E),O=new UWA.Element("div").inject(E),O.style.width="2%",I=B("initiate-Task-Field-Value",E);var e=new UWA.Element("div",{id:"needOwnerReviewId",class:""}).inject(I),t=!1;"Yes"==U.data.model.needsOwnerReview&&(t=!0),U._taskProperties.elements.needOwnerReview=new i({type:"checkbox",label:C.needsOwnerReview,value:t,checkFlag:t}).inject(e),U._taskProperties.elements.needOwnerReview.tooltipInfos=q(C.needsOwnerReview)}(),U.fieldViewOnly||"Route Template"==U._routeInfo.Type||P(),E=B("initiate-Task-Field",U._taskProperties.formFields),A=B("initiate-Task-Field-Label",E),O=new UWA.Element("div").inject(E),O.style.width="2%",I=B("initiate-Task-Field-Value",E),function(e){if("create"==U.mode){let t=new UWA.Element("div",{id:"taskAssociatedContentDatagridViewId",class:""}).inject(e);h.build().inject(t),h.registerListners(),h.setContentDatagridHeight()}}(I),n=new UWA.Element("div",{id:"instructionId",class:""}).inject(U._taskProperties.formFields),E=B("initiate-Task-Field",n),A=B("initiate-Task-Field-Label",E),O=new UWA.Element("div").inject(E),O.style.width="2%",I=B("initiate-Task-Field-Value",E),U.labelAttr=new UWA.Element("h5",{class:U.fieldRequired,text:C.instructions}).inject(A),U.labelAttr.tooltipInfos=q(C.instructions),U.fieldRequired&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(U.labelAttr),U.data.model.instructions||(U.data.model.instructions=""),U._taskProperties.elements.instruction=new t({pattern:"[^./#,\\[\\]\\$\\^@\\*\\?%:'\"\\\\<>]+",widthInCharNumber:30,nbRows:4,newLineMode:"enter",resizableFlag:"vertical",value:U.data.model.instructions}).inject(I),N=G("taskInstructionInfo",C.initiateTaskInstructions,A),function(){U._taskProperties.currentValue.order=U.data.model.taskOrder;var e=new UWA.Element("div",{id:"taskOrderId",class:""}).inject(U._taskProperties.formFields);U.fieldViewOnly||U.inboxTaskFieldViewOnly||U.data.model.userGroupInfo&&""!=U.data.model.userGroupInfo||l.canLoadInViewMode(U.data,U._routeInfo)&&"Modify Task List"!=U._routeInfo.taskEditSetting?d.drawOrderInViewMode(e,U.data,U._taskProperties):u.drawOrderInEditMode(e,U.data,U._taskProperties,U.fieldRequired)}(),x(),!U.data.model.chooseUsersFromUg||"True"!=U.data.model.chooseUsersFromUg&&"False"!=U.data.model.chooseUsersFromUg||(E=B("initiate-Task-Assignee-Field",U._taskProperties.formFields),A=B("initiate-Task-Assignee-Field-Label",E),O=new UWA.Element("div").inject(E),O.style.width="2%",I=B("initiate-Task-Assignee-Field-Value",E),U._taskProperties.chooseUsersFromUgDiv=new UWA.Element("div",{id:"chooseUsersFromUgId",class:""}).inject(I),"Route Template"==U._routeInfo.Type&&U.data.model.chooseUsersFromUg,U._taskProperties.elements.chooseUsersFromUg=new i({type:"checkbox",label:C.ChooseUsersFromUG,value:U.data.model.chooseUsersFromUg,checkFlag:!0,disabled:"Route Template"!=U._routeInfo.Type}).inject(I),"Route Template"==U._routeInfo.Type?"Group"!=U.data.model.assigneeType&&"Group Proxy"!=U.data.model.assigneeType||"True"!=U._routeInfo.chooseUserFromGroup&&"True"!=U._routeInfo.selectUsersFromUserGroup?(U._taskProperties.chooseUsersFromUgDiv.style.display="none",U._taskProperties.formFields.querySelector(".initiate-Task-Assignee-Field").addClassName("disabled-field")):(U._taskProperties.chooseUsersFromUgDiv.style.display="",U._taskProperties.elements.chooseUsersFromUg.checkFlag="False"!=U.data.model.chooseUsersFromUg,(U.fieldViewOnly||U.inboxTaskFieldViewOnly)&&(U._taskProperties.elements.chooseUsersFromUg.disabled=!0)):"False"!=U.data.model.chooseUsersFromUg&&"Person"!=U.data.model.assigneeType||(U._taskProperties.chooseUsersFromUgDiv.style.display="none",U._taskProperties.formFields.querySelector(".initiate-Task-Assignee-Field").addClassName("disabled-field"))),function(){E=B("initiate-Task-Field",U._taskProperties.formFields),A=B("initiate-Task-Field-Label",E),O=new UWA.Element("div").inject(E),O.style.width="2%",I=B("initiate-Task-Field-Value",E),I.setAttribute("id","allowDelegationId");var e=!1;if(null==U.data.model.allowDelegation&&null!=localStorage.getItem(c.getLoginUser()+"_allowDelegation")?e="true"==localStorage.getItem(c.getLoginUser()+"_allowDelegation"):"TRUE"==U.data.model.allowDelegation&&(e=!0),U.fieldViewOnly){var t=C.taskAllowDelegationNo;e&&(t=C.taskAllowDelegationYes);let o=new UWA.Element("h5",{text:C.allowDelegation}).inject(A);o.tooltipInfos=q(C.allowDelegation),o=new UWA.Element("span",{text:t}).inject(I),o.tooltipInfos=q(C.allowDelegationDisp)}else U._taskProperties.elements.allowDelegation=new i({type:"checkbox",label:C.allowDelegation,value:e,checkFlag:e}).inject(I),U._taskProperties.elements.allowDelegation.tooltipInfos=q(C.allowDelegation),U._taskProperties.elements.allowDelegation.addEventListener("change",(function(e){localStorage.setItem(c.getLoginUser()+"_allowDelegation",!e.dsModel.value)}))}(),function(){var e=new Date;U.taskDueDate=e,U.taskDueDate.setDate(e.getDate()+1);var t=new Date;U.taskMinDate=t,U.taskMinDate.setDate(t.getDate()-1),U.data.model.taskDueDate&&(U.taskDueDate=new Date(U.data.model.taskDueDate));var o=l.dueDateOptionSelected(U.data);U.dueDateOptionPreviouslySelected=o,U.fieldViewOnly||V()}(),"create"!=U.mode&&"taskEditMode"!=U.mode||(U._taskProperties.saveButton=new UWA.Element("div",{id:"saveButtonId",class:"task-save-float"}).inject(U._taskProperties.formFooter),U._taskProperties.elements.save=new o({label:C.apply,emphasize:"primary"}).inject(U._taskProperties.saveButton),new UWA.Element("div",{html:"&nbsp;"}).inject(U._taskProperties.saveButton),U._taskProperties.elements.save.getContent().addEventListener("buttonclick",(function(){l.taskDataSave(U.data,U.mode,U._taskProperties,U._taskGraphModel,U._routeInfo)}))),null!=U._taskProperties.elements.title.elements&&""==U._taskProperties.elements.title.elements.inputField.value.trim()&&setTimeout((function(){U._taskProperties.elements.title.elements.inputField.focus()}),1e3),widget.routeMgmtMediator.publish("task-content-height-update");let s=U._taskProperties.formFields.querySelector(".wux-ui-state-undefined.wux-controls-lineEditor-lite");null!=s&&("taskActionMode"==U.mode?T.makeDroppable(s,j,"TaskViewContentAttachment"):T.makeDroppable(s,j,"TaskViewContentReview"))},j=function(e,t){let o=U._taskProperties;o.mode=U.mode,o.routeInfo=U._routeInfo;let i;null!=t.querySelector("#droppable_TaskViewContentReview")?i="droppable_TaskViewContentReview":null!=t.querySelector("#droppable_TaskViewContentAttachment")&&(i="droppable_TaskViewContentAttachment"),null!=i&&R.getResultFromSearch(e,o,i,{})},B=function(e,t){return b.createNewElement(e,t)},G=function(e,t,o){return b.createTooltipElement(e,t,o)},q=function(e){return b.getElementToolTip(e)};return{renderEventsAndHeader:()=>_(),renderTaskFields:()=>L(),ondropTaskView:(e,t)=>{j(e,t)}}})),define("DS/ENORouteMgmt/Views/Form/TaskView",["DS/ENORouteMgmt/Views/Form/TaskProperties","DS/ENORouteMgmt/Views/Form/CreateTaskProperties","DS/ENORouteMgmt/Views/Form/RouteTaskPanelFields","DS/ENORouteMgmt/Views/Form/InitiateTaskPanelFields","DS/ENORouteMgmt/Utilities/TaskPanelSubscribeEvents","DS/ENORouteMgmt/Views/RouteTaskTabsView","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Views/CollabTaskTabsView","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l){"use strict";let d,u=function(s,a,r){let l;"create"==r?(l=t.getTaskCreateVariables(),d=i):(l=e.getTaskVaribles(),d=o),n.destroy(r,l),l._taskProperties.currentValue={},l.taskGraphModel=a,l._taskGraphModel=a.model.model,a.model.routePropertiesInfo.model?l._routeInfo=a.model.routePropertiesInfo.model:l._routeInfo=a.model.routePropertiesInfo,l.data={model:a.model.model.options.grid},"create"!=l.mode&&widget.setValue("taskIdTobePersisted",l.data.model.id);var u=l._taskProperties.formBody;l.taskPanelWrapper.appendChild(u),l._taskProperties.formHeader=new UWA.Element("span",{id:"InitiateTaskPropertiesHeader",class:"task-prop-header"}),l._taskProperties.formHeader.inject(l.titleSection),l._taskProperties.formFields=new UWA.Element("div",{id:"InitiateTaskPropertiesContainer",class:"task-prop-container"}),l._taskProperties.formFields.inject(l._taskProperties.formBody),l._taskProperties.formFooter=new UWA.Element("div",{id:"InitiateTaskPropertiesFooter",class:"task-prop-footer"}),l._taskProperties.formFooter.inject(l.taskPanelWrapper),l._taskProperties.taskAssigneeField=new UWA.Element("div",{id:"SearchTaskAssigneeField",class:"fonticon-chooser-display"}),l._taskProperties.taskAssignmentScopeField=new UWA.Element("div",{id:"SearchTaskAssignmentScopeField",class:"fonticon-chooser-scope-display"}),l._taskProperties.dueDateDiv=new UWA.Element("div",{id:"dueDate",class:""}),l._taskProperties.dueDateDivOption1=new UWA.Element("div",{id:"dueDateOption1",class:"fonticon-chooser-display fit-content"}),l._taskProperties.dueDateDivOption2=new UWA.Element("div",{id:"dueDateOption2",class:"fonticon-chooser-display"}),l._taskProperties.dueDateDivOption3=new UWA.Element("div",{id:"dueDateOption3",class:"fonticon-chooser-display"}),d.renderEventsAndHeader(),d.renderTaskFields(),n.subscribeToTaskEvents(l),l.taskPropertiesFields=l._taskProperties};return{build:(e,t,o)=>u(0,t,o),destroy:(e,t)=>function(e,t){n.destroy(e,t)}(e,t),getTaskPropertyFields:()=>e.getTaskVaribles().taskPropertiesFields,renderTaskRightPanel:(o,i,n,d)=>function(o,i,n,d){let c,p,m,g="";if(g=""==i.model.model.options.grid.title||null==i.model.model.options.grid.title?l.taskTitlePlaceholder:i.model.model.options.grid.title,"create"==n){p=new UWA.Element("div",{html:"",id:"InitiateTaskPanelContainer"}),c=new UWA.Element("div",{id:"iRouteTasksContainer",class:"tasks-facets-container"}),t.resetTaskCreateVariables(),m=t.getTaskCreateVariables(),m._taskProperties={},m._taskProperties.elements={},m.mode=n,m.container=o,m.data=i;var f=o;m.taskPanelWrapper=new UWA.Element("div",{id:"InitiateTaskRightPanelContainer",class:"task-prop-panel"}),f.appendChild(m.taskPanelWrapper),m.titleSection=UWA.createElement("div",{id:"InitiateTaskRightPanelTitleSection"}),m._taskProperties.formBody=new UWA.Element("div",{id:"InitiateTaskCreatePropertiesBody",class:"task-prop-body"}),m.taskTitleDiv=new UWA.Element("span",{id:"InitiateTaskRightPanelTitle",class:"task-prop-title",text:g,title:g}),m._taskProperties.formBody.inject(m.container)}else{p=new UWA.Element("div",{html:"",id:"RouteTaskPanelTabsContainer"}),c=new UWA.Element("div",{id:"RouteTasksTabsContainer",class:"tasks-facets-container"}),e.resetTaskVariables(),m=e.getTaskVaribles(),d&&(m.collabTaskModel=d.cbtModel,m.cbtCollection=d.collection,m.collabTaskInfo=d,m.collabTaskModel.set("inboxTaskModified",!1)),m._taskProperties={},m._taskProperties.elements={},m.mode=n,m.container=o,m.data=i,f=o,m.taskPanelWrapper=new UWA.Element("div",{id:"RouteTaskRightPanelContainer",class:"task-prop-panel"}),f.appendChild(m.taskPanelWrapper),m.titleSection=UWA.createElement("div",{id:"RouteTaskRightPanelTitleSection",class:"task-title-section"});let t="RouteTaskRightPanelTitle";"taskEditMode"==n&&(t+="Edit"),m.taskTitleDiv=new UWA.Element("span",{id:t,title:g,class:"task-prop-title",text:g}),m._taskProperties.formBody=new UWA.Element("div",{id:"RouteTaskPropertiesBody",class:"task-prop-body"}),m._taskProperties.formBody.inject(m.container)}if(UWA.createElement("span",{class:"taskIcon",html:[{tag:"img",src:a.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTask16.png")}]}).inject(m.titleSection),m.taskTitleDiv.inject(m.titleSection),m.taskPanelWrapper.appendChild(m.titleSection),"create"==n)u(m.container,m.data,m.mode);else if("taskActionMode"==n&&"Route Node"!=m.data.model.model.options.grid.type){let e={loadFor:n,graphModel:m.data};"ENOTASK_AP"==widget.getValue("appId")?new r(c,e).init():new s(c,e).init()}else u(m.container,m.data,m.mode);c.inject(p),p.inject(m.taskPanelWrapper)}(o,i,n,d)}})),define("DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils",["i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","DS/egraph/core","DS/egraph/views","DS/egraph/iact","DS/egraph/utils","DS/Controls/ResponsiveTileView","DS/Controls/ComboBox","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Model/InitiateRouteTaskModel","DS/ENORouteMgmt/Views/Dialogs/ChangeAssignee","DS/ENORouteMgmt/Views/Dialogs/DeleteTask","DS/ENORouteMgmt/Actions/TaskActions","DS/ENORouteMgmt/Views/Graph/TaskCustomTileView","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/Utilities/Dom","DS/ENORouteMgmt/Model/Utils/TaskModelUtils","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/Controls/TooltipModel","DS/ENORouteMgmt/Model/RouteTaskModel","DS/ENORouteMgmt/Controller/CollabTaskServicesController","DS/ENORouteMgmt/Utilities/RouteRefreshUtils","DS/ENORouteMgmt/Views/Dialogs/InitiateRouteDialog","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/ENORouteMgmt/Commands/RouteTaskApprovalProcess","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Model/TaskAttachmentModel","DS/RouteWebAppUX/Views/Menu/AttachmentContextualMenuItems","DS/ENORouteMgmt/Views/Form/TaskView","DS/ENORouteMgmt/Utilities/RouteTaskPanelChangeUtils","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","DS/Utilities/DateUtils"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h,w,v,S,k,T,R,y,b,M,D,C,E,A,O,I,N,U,_,F){"use strict";const P="terminating node";let x,V,W,L,j,B,G,q,H=[],z=[],J={x_initialPos:-132,y_initialPos:150,y_pos_diff_odd:120,y_pos_even:53,y_initialPos_node:120},X={height:80,width:250},K={view:55,create:62,edit:62},Y={height:25},$={width:30,width_diff:15},Z=50,Q=50,ee=120,te=function(e){return e.options.grid.title||e.options.grid.name},oe=function(t){let o;t.routePropertiesInfo.model&&(o=t.routePropertiesInfo.model);let i=v.getApprovalStatusForTask1(t.options.grid,o),n={};if(i)if("Auto Complete"==t.options.grid.approvalStatus)n.label=e.completedByOwner,n.color="grey";else{n.label=e[i];let t=function(e){let t,o;return"awaitingApproval"==e||"awaitingReview"==e||"awaitingComment"==e||"awaitingAssignment"==e?t="wux-ui-3ds-hourglass":"approved"==e?(t="wux-ui-3ds-thumbs-up",o="green"):"notificationSent"==e?(t="wux-ui-3ds-notification-read",o="green"):"abstained"==e?t="wux-ui-3ds-ignore":"rejected"==e?(t="wux-ui-3ds-thumbs-down",o="red"):"RouteStopped"==e?(t="wux-ui-3ds-stop",o="red"):"commented"==e?(t="wux-ui-3ds-comment",o="green"):"tobeapproved"!=e&&"tobecommented"!=e&&"notificationtobesent"!=e||(o="grey"),{icon:t,color:o}}(i);n.icon=t.icon,n.color=t.color}return n},ie=function(t){let o,i={},n=t.routePropertiesInfo.model?t.routePropertiesInfo.model.Type:t.routePropertiesInfo.Type,s=t.routePropertiesInfo.model?t.routePropertiesInfo.model:t.routePropertiesInfo,a={datePrecision:"day",dateStyle:"full",timePrecision:"sec"};if("Complete"==t.options.grid.current){o=t.options.grid.taskActualCompletionDate;let n=F.formatDateToString(new Date(o),a);i.dateTooltip=e.completionDate+": "+n}else{o=t.options.grid.taskDueDate;let n=F.formatDateToString(new Date(o),a);i.dateTooltip=e.taskDueDate+": "+n}if("object"==typeof o?o=o.toLocaleDateString():o&&"string"==typeof o&&(o=new Date(o).toLocaleDateString()),t.options.grid.taskAssignee&&(i.assignee=t.options.grid.taskAssignee),t.options.grid.current&&(i.state=t.options.grid.current,i.stateNLS=t.options.grid.stateNLS),"Route Template"==n&&"TRUE"==t.options.grid.routeOwnerTask?(i.assignee="Ask Route Owner",i.assigneeType="Ask Route Owner",i.assigneeIcon="wux-ui-3ds-user-clock"):(t.options.grid.taskAssigneeUsername&&(i.assigneeUserName=t.options.grid.taskAssigneeUsername),t.options.grid.assigneeType&&(i.assigneeType=t.options.grid.assigneeType),t.options.grid.assigneeTitle&&(i.assigneeTitle=t.options.grid.assigneeTitle)),o&&(i.duedate=o),t.options.grid.attrTaskStatus){let o=function(t){let o,i,n;switch(t){case"status-late":o="wux-ui-3ds-attention",n=e.overdue,i="red";break;case"status-due":o="wux-ui-3ds-clock",i="orange",n=e.soonToBeOverDue;break;default:o="",i="",n=""}return{icon:o,color:i,tooltip:n}}(t.options.grid.attrTaskStatus);o&&(i.dueDateStatus=o)}if("Route Template"==n||"Yes"!==t.options.grid.isInitialTask||s.sConnectedRTId||(i.initialTask=!0,i.routeInitialTaskTooltip=e.routeInitialTaskTooltip),"Route Template"!=n&&"Yes"===t.options.grid.templateTask&&(i.templateTask=!0,i.templateTaskTooltip=e.templateTaskTooltip),t.options.grid.routeTaskPriority){let e=k.getTaskGridPriority(t.options.grid);e.icon="wux-ui-3ds-"+e.icon,i.taskPriority=e}return i.graphCurrentType=t.graphCurrentType,i.taskSubRoutes=t.options.grid.taskSubRoutes,i.subRouteApprovalStatus=t.options.grid.subRouteApprovalStatus,i.taskTitleForSubRoute=t.options.grid.title,i.taskIdForSubRoute=t.options.grid.id,i},ne=function(t,o){let i;if("Start"==o.title)i=g.generateIcon({iconName:"flag",fontIconFamily:WUXManagedFontIcons.Font3DS}),i.title=e[o.title];else{i=new UWA.createElement("div",{class:"finish-node"}),g.generateIcon({iconName:"flag-finish",fontIconFamily:WUXManagedFontIcons.Font3DS}).inject(i).title=e[o.title];let t=o.model.getTreeDocument().options.routeInfoJSON.model;if(t&&"Route Template"===t.Type);else if("view"==o.model.getTreeDocument().options.graphType){let e=new UWA.createElement("span",{class:"finish-info wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-help"}),o=se(t);e.tooltipInfos=new S({shortHelp:o,allowUnsafeHTMLShortHelp:!0}),i.appendChild(e)}}let n={};return n.content=i,n.type=P,o.model&&(n.model=ae(o)),n},se=function(t){let o,i="",n="";return i="Notify Route Owner"==t.routeCompletionAction?e.routeComletionActionNotify:e.routeComletionActionPromote,t.linkedRouteTemplate&&(o=e.replace(e.routeCompletionActionLinkRT,{tag1:t.linkedRouteTemplate})),n=e.replace(e.finishNodeHelpTooltip,{tag1:i,tag2:o}),n},ae=function(e){let t={options:{}};return t.options.grid={},t.options.grid.taskOrder=parseInt(e.model.options.grid.taskOrder)+1,t},re=function(e,t){this.node=e,this.title=String(t.title),t.model&&(this.model=ae(t))},le=function(t,o){let i="Any"==t.title?0:1,n=new a({elementsList:[e.taskAnyOption,e.taskAllOption],label:e[t.title],placeholder:e[t.title],enableSearchFlag:!1,selectedIndex:i});return n.elements.mainElement.style.minWidth="35px",Pe()||/chrome|chromium|crio/i.test(navigator.userAgent)&&n.addEventListener("click",(e=>{e.target.getElementsByClassName("wux-controls-combobox-icon")[0].click()})),n.addEventListener("change",(function(e){let t=0==e.dsModel.selectedIndex?"Any":"All";f.updateTaskAction(o,t),o.getTreeDocument().options.isTaskUpdated=!0})),n},de=function(e){e.highlight(),"view"==q&&ge(e,"select")},ue=function(e){e.unhighlight(),"view"==q&&ge(e,"deSelect")},ce=function(e){let t=e.getTreeDocument().options.graphType;if(e.options.grid.id&&"create"!=t){let t=e.options.grid.taskDetailsList;return t.push("open"),t}return["open","showTaskRemove"]},pe=function(e,t){Te(t),de(e),t._isHighlighted=!0},me=function(e,t){let o=!0;if(Pe()&&0==e.detail&&(o=!1),o){let e=t.getOption("taskModel");e.getTreeDocument().options._isTaskPanelOpened||(t.isHighlighted()?(ue(t),e._isHighlighted=!1):(Te(e),de(t),e._isHighlighted=!0))}},ge=function(e,t){let o=e.options.taskModel.options.grid.id,i=k.getModel().getChildren();for(var n=0;n<i.length;n++){let e=i[n].options.id;if(null!=e&&null!=o&&e==o){"select"==t?i[n].select(!0):i[n].unselect(!0);break}}},fe="",he=!1,we=function(t){fe=at();let o=t.getOption("taskModel"),i=o.getTreeDocument(),n=i.options.graphType;if("view"!=n)if(i.options._isTaskPanelOpened)widget.notify.handler().addNotif({level:"error",subtitle:e.taskErrorOnEdit,sticky:!1});else{pe(t,o),o._isTaskPanelOpened=!0,i.options._isTaskPanelOpened=!0;let e=i.options.graphType,n={};n.model=o,n.routePropertiesInfo=i.options.routeInfoJSON;let s=Ce(e,"open");widget.routeMgmtMediator.publish(s,{model:n}),widget.routeMgmtMediator.publish("task-content-height-update"),Oe(t,o),Ee(t,o)}else{widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",(function(){O.getAttachmentRemovalStatus("reset"),fe="",he=!1,ve(he)})),widget.routeMgmtMediator.subscribe("route-task-close-click-edit-mode",(function(){O.getAttachmentRemovalStatus("reset"),fe="",he=!1,ve(he)})),widget.routeMgmtMediator.subscribe("task-due-date-changed",(function(e){he=!!e,ve(he)}));let s=A.getTaskTreeDocument().getChildren(),a=O.getAttachmentRemovalStatus(),r=document.querySelector("#InitiateTaskPropertiesContainer .cke-comments-container"),l=N.getTaskPropertyFields(),d=!1;if("view"==n&&""!=fe)for(let n=1;n<s.length-1;n++){let u=s[n].getAllDescendants();if(u)for(let n=0;n<u.length;n++){let s=u[n].options.grid;if(s.id==fe){let n="";n="Review"==s.current?null!=s.reviewersComments||null!=s.reviewersComments?s.reviewersComments.trim():"":null!=s.comments||null!=s.comments?s.comments.trim():"";let u="";null!=r&&("Review"==s.current&&null!=CKEDITOR.instances&&null!=CKEDITOR.instances.ckeditorTaskReviewComment?u=CKEDITOR.instances.ckeditorTaskReviewComment.getData():null!=CKEDITOR.instances&&null!=CKEDITOR.instances.ckeditorTaskComment&&(u=CKEDITOR.instances.ckeditorTaskComment.getData()));let c="";if(null!=l&&l.autoCompleteComponent){let e=l.autoCompleteComponent.selectedItems;c=e&&e.length>0?"attachmentsAdded":""}if(null!=r&&n!=u||""!=c||a||Se()){d=!0;let n=new b;n.inject(document.body);let s=o.options.grid.id==fe;new M({modalFlag:!0,width:350,height:150,title:e.openTask,content:s?e.reopenSelectedTask:e.unsavedTaskChanges,immersiveFrame:n,buttons:{Ok:new D({disabled:!1,onClick:function(e){e.dsModel.dialog.close(),pe(t,o),o._isTaskPanelOpened=!0,i.options._isTaskPanelOpened=!0;let n=i.options.graphType,s={};s.model=o,s.routePropertiesInfo=i.options.routeInfoJSON;let a=Ce(n,"open");widget.routeMgmtMediator.publish(a,{model:s}),widget.routeMgmtMediator.publish("task-content-height-update"),Oe(t,o),Ee(t,o),fe=o.options.grid.id,O.getAttachmentRemovalStatus("reset"),he=!1,ve(he)}}),Cancel:new D({onClick:function(e){e.dsModel.dialog.close()}})}})}}}}if(!d){pe(t,o),o._isTaskPanelOpened=!0,i.options._isTaskPanelOpened=!0;let e=i.options.graphType,n={};n.model=o,n.routePropertiesInfo=i.options.routeInfoJSON;let s=Ce(e,"open");widget.routeMgmtMediator.publish(s,{model:n}),widget.routeMgmtMediator.publish("task-content-height-update"),Oe(t,o),Ee(t,o),fe=o.options.grid.id,he=!1,ve(he)}}},ve=function(e){he=e},Se=function(){return he},ke=function(e){fe="",e.routePropertiesInfo=e.getTreeDocument().options.routeInfoJSON,e.graphCurrentType=q;let t=new p({picture:e.options.grid.typeicon,title:te(e),contextualMenu:ce(e),onContextMenuBuildCallback:Me,icon:"",tileWidth:"250px"}),o=oe(e);o&&(t.subtitle=o),t.description=ie(e),t.setOption("taskSequenceInAnOrder",e.options.grid.taskSequenceInAnOrder),t.setOption("taskModel",e),function(e){let t=e.getOption("taskModel");t.getTreeDocument()._isTaskAdded?t._isNewlyAdded?(pe(e,t),t._isNewlyAdded=!1):(t._isHighlighted=!1,ue(e)):t._isHighlighted?de(e):(ue(e),t._isHighlighted=!1)}(t),t.addEventListener("click",(function(e){me(e,t)}));let i=!1;return t.addEventListener("touchstart",(function(e){if(e.stopPropagation(),!i)return i=!0,setTimeout((function(){i=!1,me(e,t)}),300),!1;setTimeout((function(){we(t)}),300)})),t.addEventListener("dblclick",(function(e){we(t)})),e.tileView=t,t},Te=function(e){document.querySelectorAll(".routemgmt-thumnailview.wux-ui-state-highlighted").forEach((function(e){e.classList.remove("wux-ui-state-highlighted")}));let t=e.getTreeDocument();t&&t.getAllDescendants().forEach(((e,t)=>{e._isHighlighted&&(e._isHighlighted=!1),e.tileView&&e.tileView.unhighlight()}))},Re=function(e,t,o){let i=!1;"edit"!=t||e.options.grid.id||(i=!0),("create"==t||"showTaskRemove"===o&&"edit"==t)&&(i=!0);let n=nt(e);if(i&&n)return!0},ye=function(e,t){let o=t.getTreeDocument().options.graphType;Ne(),e.taskPanelOpened&&widget.routeMgmtMediator.publish("route-task-close-click"),t.options.grid.id&&"edit"==o?u.deleteTask(t):widget.routeMgmtMediator.publish("delete-task-success",t)},be=function(e,t){d.changeAssignee(t)},Me=function(t){let o=this,i=o.getOption("taskModel"),n=i.getTreeDocument().options.graphType,s=!1;"create"!=n&&(s=rt(A.getTaskTreeDocument().getChildren()));let a={};a.model=i,a.routePropertiesInfo=i.getTreeDocument().options.routeInfoJSON;var r=[];if(r.push({name:e.Open,title:e.Open,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open"},data:null,action:{callback:function(){!function(e){we(e)}(o)}}}),"view"==n&&null!=i.options.grid.taskSubRoutes&&i.options.grid.taskSubRoutes.length>0&&r.push({name:e.approvalProcess,title:e.approvalProcess,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-route"},data:null,action:{callback:function(){_.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Approval Process"});var e={route:[]},t=i.options.grid.taskSubRoutes;e.taskTitleForSubRoute=i.options.grid.title,e.taskIdForSubRoute=i.options.grid.id;for(let o=0;o<t.length;o++)e.route.push({dataelements:{id:t[o].routeId,name:t[o].routeName,approvalTaskId:t[o].approvalTaskId}});De(e)}}}),t.forEach(((t,a)=>{"isRouteOwner"===t&&"Assigned"==i.options.grid.current&&"In Process"==i.routePropertiesInfo.model.state&&"view"==n&&"Stopped"!=i.routePropertiesInfo.model.Activity_State&&"Maintain Exact Task List"!=i.options.grid.taskEditSetting&&s&&("Extend Task List"!=i.options.grid.taskEditSetting||"Extend Task List"==i.options.grid.taskEditSetting&&"No"==i.options.grid.templateTask&&"No"==i.options.grid.isInitialTask)&&r.push({name:"MarkasComplete",title:e.markasCompleteTitle,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-status-change"},data:null,action:{callback:function(){_.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Mark as Complete"}),function(t){var o={};o.id=t.routePropertiesInfo.id;var i={};i.id=t.options.grid.id,i.needsOwnerReview=t.options.grid.needsOwnerReview,i.currentState=t.options.grid.current;let n=new b;n.inject(document.body);let s=e.AutoCompleteTitle+t.options.grid.title;new M({modalFlag:!0,width:400,height:150,title:s,content:e.AutoCompleteContent,immersiveFrame:n,resizableFlag:!0,buttons:{Ok:new D({onClick:function(n){T.completeTask(i).then((e=>{R.refreshRouteData(o),widget.routeMgmtMediator.publish("task-action-on-save",t)}),(t=>{t.error?widget.notify.handler().addNotif({level:"error",title:e.taskCompletedError,message:t.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:e.taskCompletedError,sticky:!1})})),n.dsModel.dialog.close()}}),Cancel:new D({label:e.cancel,onClick:function(e){e.dsModel.dialog.close()}})}})}(i)}}}),"showTaskRemove"===t&&Re(i,n,t)?r.push({type:"PushItem",title:e.Delete,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash"},action:{callback:function(e){_.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Delete"}),ye(o,i)}}}):"canChangeAssignee"===t&&function(e,t,o){let i=!1;if("view"==t&&(i=!0),e.routePropertiesInfo&&"Route Template"==e.routePropertiesInfo.model.Type&&"Inactive"!=e.routePropertiesInfo.model.actualState&&(i=!1),"Inactive"==e.options.grid.assigneeState)i=!0;else{let t=st(e);i=!(!i||!t)}return i}(i,n)&&r.push({type:"PushItem",title:"TRUE"==i.options.grid.routeOwnerTask?e.selectAssignee:e.changeAssignee,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-user-change"},action:{callback:function(e){"TRUE"==i.options.grid.routeOwnerTask?_.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Select Assignee"}):_.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Change Assignee"}),be(0,i)}}})})),"true"==a.model.options.grid.taskAcceptLink&&"Assigned"==a.model.options.grid.current&&"view"==n&&r.push({type:"PushItem",title:e.accepTask,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-user-ok"},action:{callback:function(e){_.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Accept Task"}),function(e,t,o){v.taskAccept({model:o.model.options.grid},o.routePropertiesInfo,"callFromMenu")}(0,0,a)}}}),"view"==n&&"Assigned"==a.model.options.grid.current&&a.model.options.grid.taskDetails&&v.canPerformTaskAction(a.model.options.grid.taskDetails)){w.getLoginUser()==a.model.options.grid.taskAssigneeUsername&&r.push({name:e.subRouteCommand,title:e.subRouteCommand,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-plus"},data:null,action:{callback:function(){_.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Create Subroute"});var e={inboxTaskId:a.model.options.grid.physicalid,parentRouteId:a.routePropertiesInfo.id,inboxTaskTitle:a.model.options.grid.title,parentRouteTaskDueDate:a.model.options.grid.taskDueDate};widget.setValue("isDialogOpened",!0),y.InitiateRouteDialog(e)}}})}if("view"==n&&"Inbox Task"==a.model.options.grid.type){let e=i.options.grid,t=[{options:{grid:{Title:e.title,id:e.id,Type:e.type}}}];r=r.concat(I.getCopyLink(t))}return r},De=function(e){C.getApprovalCommandMenu(e,"openSummaryPage").action.callback()},Ce=function(e,t){let o;return"create"==e?o="route-task-"+t+"-click":"view"==e?o="route-task-"+t+"-click-view-mode":"edit"==e&&(o="route-task-"+t+"-click-edit-mode"),o},Ee=function(e,t){let o=t.getTreeDocument().options.graphType,i=Ce(o,"close");widget.routeMgmtMediator.subscribeOnce(i,(function(e){G=!1,t._isTaskPanelOpened=!1,t.getTreeDocument().options._isTaskPanelOpened=!1,widget.setValue("taskIdTobePersisted",void 0)}))},Ae=function(e){let t=r.getTaskTreeDocument().getAllDescendants();for(let o=0;o<t.length;o++){let i=t[o];if(i.options.grid&&i.options.grid.id&&i.options.grid.id==e)return i}},Oe=function(e,t){let o=t.getTreeDocument().options.graphType,i=function(e){let t;return"create"==e?t="task-create-on-save":"edit"==e&&(t="task-edit-on-save"),t}(o),n=Ie(t);widget.routeMgmtMediator.subscribeOnce(i,(function(i){if(i.orderInfo&&i.orderInfo.orderUpdated){let e=n.reOrderTreeNodeModels(t,i.orderInfo);Je(e),widget.routeMgmtMediator.publish("redraw-graph-"+o,{taskTreeDocument:e})}"create"==o&&widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons"),"edit"==o&&t.options.grid.validTaskData&&(t.getTreeDocument().options.isTaskUpdated=!0),function(e,t){let o=oe(t);o&&(e.subtitle=o);let i=te(t);e.title=i,e.description=ie(t)}(e,t)}))},Ie=function(e){let t,o=e.getTreeDocument().options.graphType;return"create"==o?t=l:"view"!=o&&"edit"!=o||(t=r),t},Ne=function(){widget.routeMgmtMediator.subscribeOnce("delete-task-success",(function(e){let t,o=Ie(e),i=o.getTaskTreeDocument(),n=i.options.graphType;o.getTaskTreeDocument().options._isTaskPanelOpened&&("create"==n?widget.routeMgmtMediator.publish("route-task-close-click"):widget.routeMgmtMediator.publish("route-task-close-click-edit-mode")),e.getParent()&&(t=e.getParent().options.grid.graphNode);let s=o.deleteTreeNodeModel(e);if("edit"==n&&(k.updateModel(i.options.routeInfoJSON),k.getModel().RouteId=i.options.routeInfoJSON.id),2==i.getChildren().length){let e=".create-task-graph-container",t={};"edit"==n?(t.graphMode="EditMode",e=".route-graph-task-container",0==c.getTasksDatasForDelete(o).length&&(widget.routeMgmtMediator.publish("disable-edit-icon-in-tasks-tab"),Ue())):"create"==n&&(t.graphMode="createMode"),m.showEmptyTasksPlaceholder(document.querySelector(e),t.graphMode)}else i.options._isSplitTaskPresent?widget.routeMgmtMediator.publish("redraw-graph-"+n,{taskTreeDocument:i}):s.length>0&&Fe(e,i,s,t);"create"==n&&(widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons"),e.options.grid.contentToReviewFieldInfo&&e.options.grid.contentToReviewFieldInfo.length>0&&v.updateInitiateRouteContentViewOnNodeRemoval(e.options.grid.contentToReviewFieldInfo,e.options.grid.title))}))},Ue=function(){let e=document.querySelector("#routeGraphTaskContainer");e.querySelector("#footer_view")&&e.querySelector("#footer_view").destroy(),e.querySelector("#footer_edit")&&e.querySelector("#footer_edit").destroy()},_e=function(e){j="create"===e.options.graphType?W:L},Fe=function(e,t,o,i){_e(t);let n,s=parseInt(e.options.grid.taskOrder),a=0;j.selection.first;o.forEach(((e,t)=>{a=e.actualLeft<a||!a?e.actualLeft:a,n=e.actualTop<n||!n?e.actualTop:n,j.removeNode(e)}));t.getChildren()[s-1].options.grid.graphNode;i&&(a=i.actualLeft,n=i.actualTop),Le(j,t,s,{currX:a,currY:n},{operation:"delete"}),$e(t)},Pe=function(){return UWA.Utils.Client.Features.touchEvents},xe=function(e){return{"01":"bottom",10:"right","0-1":"top","-10":"left"}[e]},Ve=function(e,t,o,i,n){let s,a,r=t.getChildren();if(r.length>=2){let s=t.getAttributeValue("graphNode"),a=o;s?(j.removeNode(s),a=s.actualLeft,i=!1):o+=K[n]+Q,s=je(a,J.y_initialPos,{title:t.options.label,model:t}),We(e,s),t.setAttribute("graphNode",s)}s=r.length%2==0?J.y_pos_even-(X.height+Z)*(parseInt(r.length/2)-1):J.y_initialPos_node-(X.height+Z)*parseInt(r.length/2),a=X.height+Z,Ke(r,o,s,a,!0),o+=X.width+Q,i&&(o+=4);let l={};return l.xPos=o,l.moveNextOrderTasks=i,l},We=function(e,t){e.addNode?e.addNode(t):e.parent&&e.parent.addNode&&e.parent.addNode(t)},Le=function(e,t,o,i,n){Je(t);let s,a=i.currX,r=i.currY,l=J,d=t.options.graphType,u=t.getChildren().length;for(let i=o;i<u;i++){let u=t.getChildren()[i];if(n.isTaskAddedToSameOrder&&i==o){let t=Ve(e,u,a,!0,d);if(a=t.xPos,t.moveNextOrderTasks)continue;break}let c=u.getChildren();if(i==o&&"create"==n.operation){Xe(c[0],0,1,a,l.y_initialPos_node,l.y_pos_diff_odd,!0),a+=X.width+Q;continue}c&&c.length<2&&"delete"==n.operation&&u.getAttributeValue("graphNode")&&u.setAttribute("graphNode",void 0);let p=u.getAttributeValue("graphNode");if(p)try{j.removeNode(p)}catch(e){console.log(e)}if(c&&c.length>=2)p=je(a,J.y_initialPos,{title:u.options.label,model:u}),a+=K[d]+Q,We(e,p),u.setAttribute("graphNode",p),r=c.length%2==0?l.y_pos_even-(X.height+Z)*(parseInt(c.length/2)-1):l.y_initialPos_node-(X.height+Z)*parseInt(c.length/2),s=X.height+Z,Ke(c,a,r,s,!0,!0),a+=X.width+Q;else if(c&&1==c.length)Xe(c[0],0,1,a,l.y_initialPos_node,l.y_pos_diff_odd,!0,!0),a+=X.width+Q;else{let t;"Finish"==u.options.label&&(t=u.getPreviousNode(),u.getPreviousBrother().getChildren()&&u.getPreviousBrother().getChildren().length>1&&(a+=$.width_diff)),p=je(a,J.y_initialPos,{title:u.options.label,model:t}),a+=K.width+Q,We(e,p),u.setAttribute("graphNode",p)}}},je=function(e,o,i){let n,s,a=30,r=25,l=0,d=0,u=i.model&&i.model.getTreeDocument?i.model.getTreeDocument().options.graphType:"view";if(n=new t.Node,n.views.main=new x,"Start"==i.title||"Finish"==i.title?(n.data=new ne(n,i),a=30):"Any"==i.title||"All"==i.title?("create"==u||"edit"==u)&&i.model&&0==i.model.getParents().length?(n.data={title:i.title,content:le(i,i.model),model:i.model},a=62):(n.data=new re(n,i),a=55):i.title||(n.data={content:ke(i),model:i},r="Assigned"==n.data.model.options.grid.current&&"view"==q?105:80,a=250,l=1,d=3.3),n.multiset("left",e,"top",o,"width",a,"height",r),n.views.overview=!0,i.options&&(s=i.options.grid.taskSequenceInAnOrder),i.model&&i.model.options.grid&&(s=i.model.options.grid.taskSequenceInAnOrder),"Finish"==i.title){let e=i.model.getAllDescendants(),t=He(e);s=t.isEditableTaskPresent&&t.taskCount>1?-2:2}if("Start"!=i.title)if(n.data.in1=Be(t.BorderCstr.LEFT,l),n.appendConnector(n.data.in1),i.title)n.data.in1.showPlusIcon=-2==s,"Finish"==i.title?n.data.in1.showArrow=!0:n.data.in1.showArrow=-2!=s,"Any"!=i.title&&"All"!=i.title||(n.data.in1.showArrow=!1);else{n.data.in2=Be(t.BorderCstr.TOP,d),n.appendConnector(n.data.in2);const e=[1,0,3,4];n.data.in2.showPlusIcon=e.includes(s),n.data.in1.showPlusIcon=0==s,n.data.in1.showArrow=0!=s}if("Finish"!=i.title&&(n.data.out2=Be(t.BorderCstr.RIGHT,l),n.appendConnector(n.data.out2),!i.title)){n.data.out1=Be(t.BorderCstr.BOTTOM,d),n.appendConnector(n.data.out1);const e=[-1,0,3,4];n.data.out1.showPlusIcon=e.includes(s),n.data.out2.showPlusIcon=0==s||3==s}return n},Be=function(e,o){var i,n;return n=10+30*o,(i=new t.Connector).views.main=new V(e,0,!1),i.multiset(["cstr","attach"],e,["cstr","offset"],n),i},Ge=function(e,i,n){var s;(s=new t.Edge).views.main=new o.SVGEdgeView,n&&s.set("geometry",new t.StairGeometry);return j.addEdge(e,i,s,{autoPairSelection:!0}),s},qe=function(e){let t=!0,o=0;return e.forEach(((e,i)=>{if(e.options&&"Route Task"==e.options.grid.nodeType&&(o++,t&&(e.options.grid.taskDetailsList&&-1==e.options.grid.taskDetailsList.indexOf("showEditTask")&&(t=!1),e.options.grid.validTaskData||(t=!0),e.options.grid.id||(t=!0),"Inbox Task"==e.options.grid.type&&(t=!1),e.getTreeDocument()&&e.getTreeDocument().options.routeInfoJSON))){let o=e.getTreeDocument().options.routeInfoJSON;"Route Template"===(o.model?o.model.Type:o.Type)||(o.templateId&&""!=o.templateId&&(t=it(e)&&"Route Node"===e.options.grid.type),("Yes"==e.options.grid.templateTask||"No"==e.options.grid.templateTask&&e.options.grid.taskEditSetting&&"Maintain Exact Task List"==e.options.grid.taskEditSetting)&&(t=it(e)&&"Route Node"===e.options.grid.type))}})),{hasEditAccess:t,taskCount:o}},He=function(e,t){let o=!1,i=0;return e.forEach(((e,t)=>{if(i++,e.options&&"Route Task"==e.options.grid.nodeType){if(o)return;if(e.options.grid.taskDetailsList&&e.options.grid.taskDetailsList.indexOf("showEditTask")>-1&&(o=!0),e.options.grid.validTaskData||(o=!0),e.options.grid.id||(o=!0),e.getTreeDocument()&&e.getTreeDocument().options.routeInfoJSON){let t=e.getTreeDocument().options.routeInfoJSON;"Route Template"===(t.model?t.model.Type:t.Type)||(t.templateId&&""!=t.templateId&&(o=it(e)),("Yes"==e.options.grid.templateTask||"No"==e.options.grid.templateTask&&e.options.grid.taskEditSetting&&"Maintain Exact Task List"==e.options.grid.taskEditSetting)&&(o=it(e)))}}})),{isEditableTaskPresent:o,taskCount:i}},ze=function(e,t){let o=!0,i=e.getTreeDocument().options.routeInfoJSON.taskEditSetting;return e.getTreeDocument().options.routeInfoJSON.model&&(i=e.getTreeDocument().options.routeInfoJSON.model.taskEditSetting),"Extend Task List"===i&&t.forEach(((e,t)=>{e.options&&"Route Task"==e.options.grid.nodeType&&o&&("Yes"==e.options.grid.templateTask||"No"==e.options.grid.templateTask&&"Yes"==e.options.grid.isInitialTask)&&(o=!1)})),o},Je=function(e){let t,o,i;e.getChildren().forEach((e=>{let n,s=e.getAllDescendants(),a=qe(s),r=0,l=a.taskCount,d=He(s).isEditableTaskPresent,u=function(e){let t=!0,o=e.getAllDescendants();return t=ze(e,o),t}(e),c=function(e){let t=!0;if(e.getNextBrother()){let o=e.getNextBrother().getAllDescendants();t=ze(e,o)}return t}(e);if(0!=s.length&&(i=s[0].options.grid.parallelNodeProcessionRule),s.forEach(((e,n)=>{e.options&&"Route Task"==e.options.grid.nodeType?(r++,e.options.grid.parallelNodeProcessionRule!=i&&(e.options.grid.parallelNodeProcessionRule=i),d?(1==r&&r==l?"Inbox Task"==e.options.grid.type?(o=3,u||c||(o=4)):(o=0,u||(o=3),u||c||(o=4)):o=1==r&&r<l?1:r==l?-1:2,void 0!==t&&(0!=t&&3!=t||0!=o||(o=3))):o=2,e.options.grid.taskSequenceInAnOrder=o,t=o):(e.options&&"UG Action Node"==e.options.grid.nodeType||e.options&&"Maintain Exact Task List"==e.options.grid.taskEditSetting)&&(e.options.grid.taskSequenceInAnOrder=2)})),e.getPreviousBrother()){let t=e.getPreviousBrother().getAllDescendants();n=qe(t)}a.hasEditAccess?n&&1==n.taskCount?e.options.grid.taskSequenceInAnOrder=2:n&&a.hasEditAccess&&n.taskCount>1&&u||n&&a.hasEditAccess&&a.taskCount>1&&u||a.hasEditAccess&&n&&0==n.taskCount&&u?e.options.grid.taskSequenceInAnOrder=-2:e.options.grid.taskSequenceInAnOrder=2:e.options.grid.taskSequenceInAnOrder=2}))},Xe=function(e,t,o,i,n,s,a,r){if(a){let t=e.getAttributeValue("graphNode");t&&j.removeNode(t)}let l=je(i,n+s*t,e);e.setAttribute("graphNode",l),j.insertNodeBefore(l,null)},Ke=function(e,t,o,i,n,s){let a=e.length;e.forEach(((e,r)=>{Xe(e,r,a,t,o,i,n,s)}))},Ye=function(e){_e(e),Je(e);let t,o=J,i=o.x_initialPos,n=o.y_initialPos,s=e.options.graphType;i=ee;let a={xPos:i,yPos:n,y_pos_diff:t};e.getChildren().forEach((e=>{let i=a.xPos;if(e._isSplitTaskPresent){let r=e.getChildren();if(r.length>1){let t=je(i,o.y_initialPos,{title:e.options.label,model:e});i+=K[s]+Q,j.insertNodeBefore(t,null),e.setAttribute("graphNode",t)}let l=e.getAllDescendants().length-r.length;n=l%2==0?o.y_pos_even-(X.height+Z)*(parseInt(l/2)-1):o.y_initialPos_node-(X.height+Z)*parseInt(l/2);let d=0;e.getChildren().forEach((e=>{let o=e.getChildren(),s=o.length;if(s>1){d=n+[X.height*parseInt(s)+Z*parseInt(s-1)]/2,d-=s%2==0?Y.height/2-5:Y.height/2-2;let t=je(i,d,{title:e.options.label,model:e});j.insertNodeBefore(t,null),e.setAttribute("graphNode",t)}t=X.height+Z,Ke(o,i+80,n,t),n+=(X.height+Z)*o.length})),i+=X.width+Q+80,a={xPos:i,yPos:n,y_pos_diff:t}}else a=function(e,t,o,i){q=o;let n=J,s=t.xPos,a=t.yPos,r=t.y_pos_diff,l=e.getChildren();if(l&&l.length>1){(function(e){let t=!1;return 2!=e.options.grid.taskSequenceInAnOrder&&"view"!=e.getTreeDocument().options.graphType||(t=!0),t&&e.getPreviousBrother().getChildren()&&1==e.getPreviousBrother().getChildren().length||t&&"Start"==e.getPreviousBrother().options.label||(t=!1),t})(e)&&(s-=25);let t=je(s,n.y_initialPos,{title:e.options.label,model:e});s+=K[o]+Q,j.insertNodeBefore(t,null),e.setAttribute("graphNode",t),a=l.length%2==0?n.y_pos_even-(X.height+Z)*(parseInt(l.length/2)-1):n.y_initialPos_node-(X.height+Z)*parseInt(l.length/2),r=X.height+Z,Ke(l,s,a,r),s+=X.width+Q}else if(l){a=n.y_initialPos_node;let e=je(s,a,l[0]);l[0].setAttribute("graphNode",e),j.insertNodeBefore(e,null),s+=X.width+Q}else{let t;"Finish"==e.options.label&&(t=e.getPreviousNode(),e.getPreviousBrother().getChildren()&&e.getPreviousBrother().getChildren().length>1&&(s+=$.width_diff));let o=je(s,n.y_initialPos,{title:e.options.label,model:t});e.setAttribute("graphNode",o),j.insertNodeBefore(o,null),s+=$.width+Q}return{xPos:s,yPos:a,y_pos_diff:r}}(e,a,s)})),$e(e)},$e=function(e,t,o){e.getChildren().forEach((e=>{let t=e.getAttributeValue("graphNode");if(!t&&(t=e.getChildren()[0].getAttributeValue("graphNode"),!t&&e.getChildren()[0].hasChildren())){let o=e.getChildren()[0];t=o.getChildren()[0].getAttributeValue("graphNode")}if(t){let o=function(e){let t=[];if(e.getPreviousBrother()){let o=e.getPreviousBrother().getAllDescendants();0==o.length&&t.push(e.getPreviousBrother()),o.forEach((e=>{e.tileView&&t.push(e)}))}return t}(e);o.forEach((e=>{let o=e.getAttributeValue("graphNode");Ge(o.data.out2,t.data.in1,!0)})),e.hasChildren()&&e.getChildren().forEach(((e,o)=>{if(e.hasChildren()){let o=e.getAttributeValue("graphNode");o&&Ge(o.data.out2,t.data.in1,!0),e.getChildren().forEach((e=>{let i=e.getAttributeValue("graphNode");Ge(o?o.data.out2:t.data.out2,i.data.in1,!0)}))}else{let o=e.getAttributeValue("graphNode");Ge(t.data.out2,o.data.in1,!0)}}))}}))},Ze=function(t,o){t&&("Review"==o.basePurpose?t.options.grid.taskAction="Comment":"Approval"==o.basePurpose&&(t.options.grid.taskAction="Approve"),Ze(t.getNextNode(),o),function(t){let o={},i=document.querySelectorAll("#approvalStatusGettingId");for(let n=0;n<i.length;n++)"Approval"==t.basePurpose?o=e.tobeapproved:"Review"==t.basePurpose&&(o=e.tobecommented),0!=Object.keys(o).length&&(i[n].innerHTML=o)}(o))},Qe=function(e,t){if(!e)return;let o;if(e.routePropertiesInfo&&(o=e.routePropertiesInfo.model?e.routePropertiesInfo.model.Type:e.routePropertiesInfo.Type),e.options.grid)if("Route Template"===o&&"TRUE"===e.options.grid.routeOwnerTask);else if(e.options.grid.assigneeId="",e.options.grid.assigneePID="",e.options.grid.assigneeTitle="",e.options.grid.assigneeType="",e.options.grid.taskAssignee="",e.options.grid.taskAssigneeUsername="",e.options.grid.validTaskData=!1,e.tileView){let t=ie(e);t.assignee=" ",e.tileView.description=t}Qe(e.getNextNode(),t)},et=function(e,t){if(e){if(e.options.grid&&e.options.grid.contentToReviewFieldInfo){for(var o=[],i=0;i<e.options.grid.contentToReviewFieldInfo.length;i++)-1!=t.indexOf(e.options.grid.contentToReviewFieldInfo[i].id)&&o.push(e.options.grid.contentToReviewFieldInfo[i]);e.options.grid.contentToReviewFieldInfo=o}et(e.getNextNode(),t)}},tt=function(){let e;widget.routeMgmtMediator.subscribe("route-task-open-click-view-mode",(function(t){e=r.getTaskTreeDocument(),e.options._isTaskPanelOpened=!0})),widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",(function(t){e=r.getTaskTreeDocument(),e.options._isTaskPanelOpened=!1}));let t=widget.routeMgmtMediator.subscribe("route-task-on-change-assignee",(function(e){let t=Ae(e.id);t&&t.options&&(t.options.grid.assignee="",t.options.grid.assigneePID=e.newAssigneeId,t.options.grid.assigneeId=e.newAssigneeId,t.options.grid.taskAssignee=e.taskAssigneeName,t.options.grid.taskAssigneeUsername=e.taskAssigneeUserName,t.options.grid.taskAcceptLink=e.taskAcceptLink,t.options.grid.assigneeType=e.newAssigneeType,t.options.grid.assigneeTitle=e.taskAssigneeName,t.options.grid.routeOwnerTask=e.routeOwnerTask,t.options.grid.routeOwnerUGChoice=e.routeOwnerUGChoice,t.options.grid.routeOwnerUGName=e.routeOwnerUGName,t.options.grid.routeOwnerUGTitle=e.routeOwnerUGTitle,t.tileView&&(t.tileView.subtitle=oe(t),t.tileView.description=ie(t)))}));return z.push(t),z},ot=function(e,t){let o,i,s,a,r=new n.BoundingRect,l=e.nodes.first;for(;l;)(null==o||o>l.left)&&(o=l.left),(null==i||i<l.left+l.width)&&(i=l.left+l.width),(null==s||s>l.top)&&(s=l.top),(null==a||a<l.top+l.height)&&(a=l.top+l.height),l=l.next;r.xmin=o,r.xmax=i,r.ymin=s,r.ymax=a;let d=document.querySelector("#"+t);if(d){let e=d.querySelector(".egraph_views_domroot").offsetWidth,t=d.querySelector(".egraph_views_domroot").offsetHeight;j.views.main.setSize(e,t)}!function(e,t,o,i){let s=e.views.main.getSize();if(s[0]<=0&&s[1]<=0)return!1;let a=e.views.main.vpt,r={padding:25,minSize:50,horizontal:0,vertical:0,aliasing:0,defaultVpt:a};o&&(r.minScale=a[2],r.maxScale=a[2]),i&&(r.maxScale=1);let l=n.reframeViewpoint(e.views.main.getSize(),t,r);e.views.main.setViewpoint(l,!0)}(e,r,!1,!0)},it=function(e){if(e.options){let t=e.options.grid.templateTask,o=e.options.grid.taskEditSetting,i=e.options.grid.taskDetailsList,n=(e.options.grid.type,e.options.grid.isInitialTask);if(("Yes"===t||"Yes"===n&&e.routePropertiesInfo&&null==e.routePropertiesInfo.model.templateTaskEditSetting)&&"Maintain Exact Task List"===o)return!1;if("No"===t&&"Maintain Exact Task List"===o)return!1;if(i&&-1==i.indexOf("showEditTask")&&"create"!=e.getTreeDocument().options.graphType)return!1}return!0},nt=function(e){if(e.options){let t=e.options.grid.templateTask,o=e.options.grid.isInitialTask,i=e.options.grid.taskEditSetting;if("Yes"===t||"Yes"===o&&e.routePropertiesInfo&&null==e.routePropertiesInfo.model.templateTaskEditSetting)switch(i){case"Modify Task List":case"Extend Task List":case"Maintain Exact Task List":return!1;default:return!0}}return!0},st=function(e){if(e.options){let t=e.options.grid.templateTask,o=e.options.grid.isInitialTask,i=e.options.grid.taskEditSetting,n=e.options.grid.type,s=e.options.grid.routeOwnerTask;if("Yes"===t&&"TRUE"==s)return!0;if("Yes"===t&&"Route Node"==n)return"Modify/Delete Task List"==i||"Modify Task List"==i;if("Yes"===o&&"Route Node"==n&&e.routePropertiesInfo&&null==e.routePropertiesInfo.model.templateTaskEditSetting)return"Modify/Delete Task List"==i||"Modify Task List"==i}return!0},at=function(){return fe},rt=function(e){let t=0,o=0;if(1==e.length)return!1;for(let i=1;i<e.length-1;i++){let n=e[i].getAllDescendants();if(n.length>0)for(let e=0;e<n.length;e++){t++,"Auto Complete"==n[e]._options.grid.approvalStatus&&o++}}return o!=t-1},lt={init:(e,t,o,i,n)=>{"create"==i?W=o:L=o,V=t,x=e,G=!1},createGraphNodes:e=>{return"create"==(t=e).options.graphType&&(B=t),void Ye(t);var t},drawGraphNode:(e,t,o)=>function(e,t,o){let i="#templates";document.querySelector("#templates_create")&&(i="#templates_create");let n=document.querySelector(i+" > .mixnode").cloneNode(!0),s="task-"+t+"-view";n.classList.add(s);let a=new UWA.Element("div",{class:"wux-control-inline-container",styles:{"vertical-align":"bottom"}});return"dropdown"==t&&(Pe()?(a.setStyle("width","75px"),a.setStyle("margin","-8px 0px 0 0px")):a.setStyle("width","62px")),"tile"==t&&a.setStyle("width","250px"),e.inject(a),t===P&&(n.title=e.title),a.inject(n),n}(e,t),insertNewNode:(e,t,o)=>function(e,t,o){_e(o);let i=e.node,n=i.actualLeft,s=i.actualTop,a=xe(String(e.anormx)+String(e.anormy)),r=parseInt(t.options.grid.taskOrder),l=j,d=(l.data&&l.data.refType,i.actualLeft,i.actualTop);switch(a){case"bottom":s+=100,d-=100;break;case"top":s-=100,d+=100}"right"==a||"left"==a?("right"==a&&(n+=X.width+Q),Le(l,o,r,{currX:n,currY:s},{operation:"create",isTaskAddedToSameOrder:!1}),$e(o)):(Le(l,o,r,{currX:n,currY:s},{operation:"create",isTaskAddedToSameOrder:!0}),$e(o)),o._isTaskAdded=!1}(e,t,o),getConnectorPostion:()=>xe(xyCords),isTaskPanelOpened:e=>function(e){if(e&&e.getTreeDocument){let t=e.getTreeDocument();if(t&&t.options._isTaskPanelOpened)return!0}return!1}(e),registerEventsForCreateGraph:()=>function(){let e=widget.routeMgmtMediator.subscribe("initiateRoute-on-RouteBasePurposeSelection",(function(e){if(e.basePurpose&&B.getChildren().length>=3){let t=B.getChildren()[1].getChildren()[0];Ze(t,e)}}));return H.push(e),e=widget.routeMgmtMediator.subscribe("initiateRoute-on-ScopeSelection",(function(e){if(B.getChildren().length>=3){let t=B.getChildren()[1].getChildren()[0];Qe(t,e),widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons")}B.options.routeInfoJSON.scopeId=e.scopeId,B.options.routeInfoJSON.ScopeMembers=e.ScopeMembers})),H.push(e),e=widget.routeMgmtMediator.subscribe("clearContentToReview-on-ContentRemoval",(function(e){if(B.getChildren().length>=3){let t=B.getChildren()[1].getChildren()[0];et(t,e)}})),H.push(e),H}(),onDoubleClickOfTaskTile:e=>we(e),registerEventsForViewMode:()=>tt(),setZoomOptionsOnGraph:e=>function(e){e.setZoomOpts({min:.6,max:1.5})}(e),changeTransformOfSvg:(e,t,o)=>function(e,t,o){let i=!1;if(-1!=navigator.userAgent.indexOf("Firefox")&&(i=!0),o.data.title&&("Any"==o.data.title||o.data.title),e.startsWith("translate")){let n=e.indexOf(" matrix")-1,s=e.substring(n,e.length),a=e.substring(10,n).split(" "),r=parseInt(a[0]),l=parseInt(a[1]),d=r,u=l,c=r,p=l;return"top"==t?(r-=10,l-=5,d-=7,u-=14):"bottom"==t?(r+=10,l-=5,d-=8,u+=6):"left"==t?("terminating node"==o.data.type?(r-=17,c-=10):c-=13,l+=10,r-=5,d=r-18,p-=1):"right"==t&&(r+=5,l-=10,d+=8,u+=2),i&&(p+=8,u+=8),{rect:"translate("+r+" "+l+s,text:"translate("+d+" "+u+") matrix(1 0 0 1 0 0)",arrow:"translate("+c+" "+p+") matrix(1 0 0 1 0 0)"}}}(e,t,o),fitToWindow:(e,t)=>ot(e,t),createToolbarContainer:t=>function(t){let o=new UWA.Element("div",{class:"main-rt-task-toolbar rt-task-toolbar",id:"task-graph-toolbar"}),i=widget.getValue("TasksTab-ShowView");i&&"GridView"==i&&(o.removeClassName("showView"),o.addClassName("hideView"));let n=new UWA.Element("div",{class:"wux-controls-button wux-ui-style-icon icon fitToWindow right",title:e.fitToWindow}).inject(o);new UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-arrow-double-combo"}).inject(n),o.inject(t)}(t),isTouchDevice:()=>Pe(),onDeleteContextualMenuClick:(e,t)=>ye(e,t),onChangeAssigneeContextualMenuClick:(e,t)=>be(0,t),getFinishNodeHelpTooltip:e=>se(e),showPlusIconBasedOnRTE:e=>it(e),updateTaskEditSettings:(e,t)=>function(e,t){return e.forEach((function(e){e.taskEditSetting=t})),e}(e,t),fitToWindowDefaultLoad:(e,t)=>function(e,t){let o,i,s,a,r=new n.BoundingRect,l=e.nodes.first;for(;l;)(null==o||o>l.left)&&(o=l.left),(null==i||i<l.left+l.width)&&(i=l.left+l.width),(null==s||s>l.top)&&(s=l.top),(null==a||a<l.top+l.height)&&(a=l.top+l.height),l=l.next;r.xmin=o,r.xmax=i,r.ymin=s,r.ymax=a;let d=document.querySelector("#"+t);if(d){let e=d.querySelector(".egraph_views_domroot").offsetWidth,t=d.querySelector(".egraph_views_domroot").offsetHeight;0!=e&&0!=t||(e=widget.body.offsetWidth,t=widget.body.offsetHeight-195),j.views.main.setSize(e,t)}let u=e.views.main.vpt,c={padding:75,minSize:50,horizontal:-1,vertical:0,aliasing:0,defaultVpt:u};c.minScale=u[2],c.maxScale=u[2];let p=n.reframeViewpoint(e.views.main.getSize(),r,c);return e.views.main.setViewpoint(p,!0),!0}(e,t),updateRouteTaskModel:e=>function(e){let t=e.tasks.getTreeDocument().options.graphType,o=Ie(e.tasks);if(e.orderInfo&&e.orderInfo.orderUpdated){let i=o.reOrderTreeNodeModels(e.tasks,e.orderInfo);Je(i),widget.routeMgmtMediator.publish("redraw-graph-"+t,{taskTreeDocument:i})}else widget.routeMgmtMediator.publish("update-task-model");if("edit"==t&&e.tasks.options.grid.validTaskData&&(e.tasks.getTreeDocument().options.isTaskUpdated=!0),e&&e.tasks._id){let t=k.getModel();if(null!=t){let o=t.getChildren();for(var i=0;i<o.length;i++)if(o[i].options.graphNodeId==e.tasks._id){o[i].select(!0);break}}}}(e),canShowDeleteTask:(e,t,o)=>Re(e,t,o),postGridDeleteAction:e=>function(e){let t;e.getParent()&&(t=e.getParent().options.grid.graphNode);let o=Ie(e),i=o.deleteTreeNodeModel(e),n=o.getTaskTreeDocument(),s=n.options.graphType;if(2==n.getChildren().length){let e=".create-task-graph-container",t={};"edit"==s&&(t.graphMode="EditMode",e=".route-graph-task-container",0==c.getTasksDatasForDelete(o).length&&(widget.routeMgmtMediator.publish("disable-edit-icon-in-tasks-tab"),Ue())),m.showEmptyTasksPlaceholder(document.querySelector(e),t.graphMode)}else n.options._isSplitTaskPresent?widget.routeMgmtMediator.publish("redraw-graph-"+s,{taskTreeDocument:n}):i.length>0&&Fe(e,n,i,t)}(e),openRouteTaskApprovalProcess:e=>De(e),getPreviouslyOpenedTaskId:()=>at(),setPreviouslyOpenedTaskId:e=>function(e){""!=e&&(fe=e)}(e),setUpdatedDueDate:e=>ve(e),getUpdatedDueDate:()=>Se(),postDeleteAction:()=>Ne()};return lt})),define("DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphView",["DS/WAFData/WAFData","DS/ENORouteMgmt/Utilities/ParseJSONUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","DS/egraph/core","DS/egraph/views","DS/egraph/iact","DS/egraph/utils","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Actions/TaskActions","DS/ENORouteMgmt/Views/ToggleTaskViews","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Utilities/RouteRefreshUtils","DS/Controls/Button","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/ENORouteMgmt/Views/Graph/eGraphToolbar","DS/ENORouteMgmt/Model/RouteTaskModel","DS/Controls/Loader","DS/ENORouteMgmt/Views/Grid/RouteTasksDataGridView","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","css!DS/UIKIT/UIKIT.css","css!DS/egraph/views.css","css!DS/egraph/views_default.css","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h,w,v,S,k,T,R,y){"use strict";let b,M,D,C,E,A,O,I=[],N=0,U=function(e,t){let o="showView",i=widget.getValue("TasksTab-ShowView");("GridView"==m.getViewType()||i&&"GridView"===i)&&(o="hideView");let n=new UWA.Element("div",{id:"templates",display:"none"}).inject(e);new UWA.Element("div",{class:"mixnode"}).inject(n);var s=new UWA.Element("div",{class:"canvas "+o,id:"graph_canvas_"+t});s.inject(e),s.addEventListener(void 0!==document.body.onwheel?"wheel":"mousewheel",(function(e){var t=document.querySelector(".wux-controls-combobox-popup");t&&(t.style.display="none");var o=document.querySelector(".wux-menu-container");o&&(o.style.display="none")}),!0),new UWA.Element("div",{class:"taskEdit_footer ShowView",id:"footer_"+t}).inject(e),l.createToolbarContainer(e),E=e.id,s.addEventListener("click",(function(){document.querySelector(".wux-menu")&&(document.querySelector(".wux-menu").style.display="none")}))},_=function(e,t,r,c){function p(){n.HTMLNodeView.call(this)}a.inherit(p,n.HTMLNodeView),p.prototype.buildNodeElement=function(e){if(e.data.content){if("Any"==e.data.title||"All"==e.data.title){let t=e.data.content;return l.drawGraphNode(t,"dropdown")}if("terminating node"==e.data.type){let t=e.data.content;return l.drawGraphNode(t,"terminating-node")}{let t=e.data.content,o={width:"300px"};return l.drawGraphNode(t,"tile",o)}}var t=document.querySelector("#templates > .mixnode").cloneNode(!0);return t.appendChild(document.createTextNode(o[e.data.title])),t.className="mixnode task-action-node-view",t};var g=new i.BoundsGeometry;function f(){n.HTMLNodeView.call(this)}function w(e,t,o){this.side=e,this.nodeIndex=t,this.events=o,n.SVGConnView.call(this)}function v(e){return{"01":"bottom",10:"right","0-1":"top","-10":"left"}[e]}g.paddingTop=80,a.inherit(f,n.HTMLNodeView),f.prototype.buildNodeElement=function(e){var t=document.querySelector(e.collapsed?"#templates > .collapsed-group":"#templates > .expanded-group").cloneNode(!0);return t.appendChild(document.createTextNode("Any one of the task can be completed to move the next step")),t},a.inherit(w,n.SVGConnView),w.prototype.buildConnElement=function(e){n.SVGConnView.prototype.buildConnElement.call(this,e);let t=document.createElementNS(O,"rect");return t.setAttribute("width",21),t.setAttribute("height",21),t.setAttribute("class","rectConnnector"),t},w.prototype.onmodifyDisplay=function(t,i,s){let a="view"!=b,r=!1;a=(!t.node.data.title||"Any"==t.node.data.title||"All"==t.node.data.title)&&"view"!=b&&arguments[0].showPlusIcon;let u=v(String(t.anormx)+String(t.anormy));(arguments[0].showArrow||"left"==u&&"view"==b)&&("Any"==t.node.data.title||"All"==t.node.data.title||(r=!0)),n.SVGConnView.prototype.onmodifyDisplay.apply(this,arguments);var c=this.display.elt;let p=c.getAttribute("transform"),m=l.changeTransformOfSvg(p,u,t.node);if(!c.nextElementSibling){if(m&&(c.setAttribute("transform",m.rect),p=m.text),a){let g=document.createElementNS(O,"text");g.setAttribute("class","plusConnector"),g.setAttribute("transform",p),g.setAttribute("alignment-baseline","middle"),g.textContent="+";let f=document.createElementNS(O,"title");function h(i){if(i.stopImmediatePropagation(),l.isTaskPanelOpened(t.node.data.model))widget.notify.handler().addNotif({level:"error",subtitle:o.taskErrorOnAdd,sticky:!1});else{let o=v(String(t.anormx)+String(t.anormy)),i=parseInt(t.node.data.model.options.grid.taskOrder),n=d.getTaskNodeModel(o,i),s=n.getTreeDocument();s.options._isSplitTaskPresent?(j(),U(D,s.options.graphType),_(e,s.options.graphType,!1,s)):l.insertNewNode(t,n,s),widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons")}}f.textContent=o.addTask,g.appendChild(f),this.prevEvent,g.addEventListener("click",(function(e){h(e)})),g.addEventListener("touchstart",(function(e){e.preventDefault(),h(e)})),this.display.elt.parentNode.appendChild(g)}else c.setAttribute("display","none");if(r){let w=document.createElementNS(O,"text");w.setAttribute("class","arrowConnector"),w.setAttribute("transform",m?m.arrow:p),w.setAttribute("alignment-baseline","central"),w.textContent=">",new UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-chevron-right"}).inject(w),this.display.elt.parentNode.appendChild(w)}}};var T,R,O="http://www.w3.org/2000/svg";T=new i.EGraph,A=T;new S.Toolbar({buttons:[{id:"fitToWindow",query:"#"+E+" .main-rt-task-toolbar .fitToWindow",mode:"push",cb:function(){l.fitToWindow(T,E)}}]});function N(e){e.collapsed||e.geometry.recenterGroup(e),e.set("collapsed",!e.collapsed)}if(T.addView("main",new n.HTMLGraphView(document.querySelector("#graph_canvas_"+t))),(R=new s.StateMachine(T,null,null,T.views.main)).rootState.newDragForElement=(R.rootState.newDragForElement,function(e,t,o){if(t.type===i.Type.GROUP&&"expand-btn"===o)return new s.SubEltClickDrag(t,o,N.bind(void 0,t))}),T.addListener("update",(function(e){if(T.selection.last&&T.selection.last.data){T.selection.last.data.content.elements.container.click()}})),l.setZoomOptionsOnGraph(T),function(){T.updateLock();try{c?(B(M),I.concat(l.registerEventsForViewMode()),l.init(p,w,T,b,M),c.options.graphType=b,l.createGraphNodes(c),k.updateModel(c.options.routeInfoJSON),k.getModel().RouteId=c.options.routeInfoJSON.id):r?("GridView"!=m.getViewType()?F():x(!0),L().then((function(){V(p,w,T,b,M),"view"==b&&setTimeout((function(){ee()}),100),"GridView"!=m.getViewType()?P():x(!1)}))):V(p,w,T,b,M)}finally{let e=m.getViewType(),t={event:"TaskView"};if(t.initialValue=null==e?"GraphView":e,y.sendRouteTrackerEvent(t),"GridView"==e){let e=document.querySelector("#task-graph-toolbar");e&&e.hide()}T.updateUnlock()}}(),"edit"==t){let e={view:"edit"},t=new UWA.Element("div",{id:"footer-buttons",class:"footer-buttons"}).inject(document.querySelector(".taskEdit_footer"));new h({disabled:!1,label:o.save,domId:"graph_save",emphasize:"primary",onClick:function(t){t.dsModel.label=o.SavingTask,t.dsModel.disabled=!0,document.querySelector("#graph_cancel").dsModel.disabled=!0;var i=t.dsModel;q(e,i)}}).inject(t),new h({label:o.cancel,domId:"graph_cancel",emphasize:"secondary",onClick:function(t){t.dsModel;D.getElement(".no-tasks-to-show-container")&&u.hideEmptyTasksPlaceholder(D,"EditMode"),C="view",H(e)}}).inject(t)}},F=function(){if(N++,1==N){var e=document.getElementById("routeGraphTaskContainer"),t=document.getElementById("viewTaskContainerExternal");null!=e?O=(new T).inject(e):null!=t&&(O=(new T).inject(t)),O.elements.container.setStyle("margin-left","40%"),O.elements.container.setStyle("margin-top","10%"),O.on(o.loading_label)}},P=function(){O&&O.off(o.loading_label),N=0},x=function(e){let t=R.getDataGridInstance();e?t.displayModalLoader(o.loading_label):t.removeModalLoader(o.loading_label)},V=function(e,t,o,i,n){B(n),I.concat(l.registerEventsForViewMode()),l.init(e,t,o,i,n);let s=d.getTaskTreeDocument();s.options.graphType=i,"edit"==i&&(s.options.isTaskUpdated=!1),new Promise((function(e,t){l.createGraphNodes(s),e()})).then((function(){let e=!1;if(k.updateModel(s.options.routeInfoJSON),widget.data.taskId){for(var t=s.getAllDescendants(),o=0;o<t.length;o++)if(t[o].options.grid.id&&t[o].options.grid.id==widget.data.taskId){l.onDoubleClickOfTaskTile(s.getAllDescendants()[o].tileView),e=!0;break}widget.data.taskId=void 0}if(widget.data.inboxTaskSelectedId&&"GridView"!=m.getViewType())for(t=s.getAllDescendants(),o=0;o<t.length;o++)if(t[o].options.grid.id&&t[o].options.grid.id==widget.data.inboxTaskSelectedId){s.getAllDescendants()[o].tileView.highlight(),widget.data.inboxTaskSelectedId=void 0;break}widget.data.openTaskProperties&&(widget.data.openTaskProperties=!1,z(),e=!0),"view"==i&&0==s.options.responseLength&&(u.showEmptyTasksPlaceholder(document.querySelector(".route-graph-task-container"),"EditMode"),widget.routeMgmtMediator.publish("disable-edit-icon-in-tasks-tab")),"edit"==i&&0==s.options.responseLength&&u.showEmptyTasksPlaceholder(document.querySelector(".route-graph-task-container"),"EditMode"),k.getModel().RouteId=s.options.routeInfoJSON.id;let n=widget.getValue("taskIdTobePersisted");null!=n&&0==e&&W(n)}))},W=function(e){let t=d.getTaskTreeDocument().getAllDescendants(),o="";for(var i=0;i<t.length;i++){let n=t[i];null!=n.options.grid.id&&n.options.grid.id==e&&(o=n)}"GridView"==widget.getValue("TasksTab-ShowView")?widget.routeMgmtMediator.publish("task-DataGrid-on-dblclick",{_id:e}):l.onDoubleClickOfTaskTile(o.tileView)},L=function(e){return new Promise((function(e,t){r.fetchRouteTasks(M.id).then((function(t){t=l.updateTaskEditSettings(t,M.model.taskEditSetting),d.destroy();let o=d.getModel(t);o.options.routeId=M.model.id,o.options.routeInfoJSON=M,o.options.responseLength=t.length,e()}))}))},j=function(){document.querySelector("#templates")&&document.querySelector("#templates").destroy(),document.querySelector("#footer_view")&&document.querySelector("#footer_view").destroy(),document.querySelector("#footer_edit")&&document.querySelector("#footer_edit").destroy(),document.querySelector("#graph_canvas_view")&&document.querySelector("#graph_canvas_view").destroy(),document.querySelector("#graph_canvas_edit")&&document.querySelector("#graph_canvas_edit").destroy(),document.querySelector("#routeGraphTaskContainer #task-graph-toolbar")&&document.querySelector("#routeGraphTaskContainer #task-graph-toolbar").destroy(),document.querySelector("#viewTaskContainerExternal #task-graph-toolbar")&&document.querySelector("#viewTaskContainerExternal #task-graph-toolbar").destroy(),I.forEach(((e,t)=>{widget.routeMgmtMediator.unsubscribe(e)}))},B=function(e){let t=widget.routeMgmtMediator.subscribe("redraw-graph-edit",(function(t){if(t.taskTreeDocument){j(),U(D,"edit");let o=d.removeGraphNodesFromTree(t.taskTreeDocument);_(e,o.options.graphType,!1,o)}else{let e=".create-task-graph-container";"EditMode"==t.graphMode&&(b="edit",e=".route-graph-task-container"),u.hideEmptyTasksPlaceholder(document.querySelector(e),t.graphMode);let o=d.getTaskTreeDocument();if(t.type="edit",o.options.graphType=t.type,C=t.type,j(),U(D,t.type),o&&o.getChildren().length<3){let e=d.getTaskNodeModel("right",0);_(M,t.type,!1,e.getTreeDocument())}else _(M,t.type,!1,o)}"GridView"==m.getViewType()&&widget.routeMgmtMediator.publish("task-DataGrid-on-dblclick")}));I.push(t),t=widget.routeMgmtMediator.subscribe("redraw-graph",(function(e){if(e&&"Active"==e.state&&d.getTaskTreeDocument().options&&"edit"==d.getTaskTreeDocument().options.graphType){let e={view:"view"};widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:"edit"}),H(e,!1);let t=".route-graph-task-container";if(u.hideEmptyTasksPlaceholder(document.querySelector(t),"view"),"GridView"==m.getViewType()){let e=document.querySelector("#task-graph-toolbar");e&&e.hide()}}else G()})),I.push(t),t=widget.routeMgmtMediator.subscribe("task-action-on-save",(function(e){G()})),I.push(t),t=widget.routeMgmtMediator.subscribe("task-action-on-cancel",(function(e){G()})),I.push(t),widget.routeMgmtMediator.subscribe("route-data-updated",(function(e){if(e=g.gridData(e),d.getTaskTreeDocument().options.routeInfoJSON.model=e,M.model=e,d.getTaskTreeDocument().options.routeInfoJSON.routeBasePurpose=e.BasePurpose,M.routeBasePurpose=e.BasePurpose,D.querySelector(".finish-info")){let t=l.getFinishNodeHelpTooltip(e);D.querySelector(".finish-info").tooltipInfos.shortHelp=t}})),widget.routeMgmtMediator.subscribe("template-data-updated",(function(e){e=g.templateGridData(e),d.getTaskTreeDocument().options.routeInfoJSON.model=e,M.model=e,d.getTaskTreeDocument().options.routeInfoJSON.routeBasePurpose=e.BasePurpose,M.routeBasePurpose=e.BasePurpose})),t=widget.routeMgmtMediator.subscribe("ON_SPLIT_ROUTENODE",(function(){G()})),I.push(t),t=widget.routeMgmtMediator.subscribe("OPEN-TASK-PROPERTIES",(function(){z()})),I.push(t),t=widget.routeMgmtMediator.subscribe("update-task-model",(function(e){var t=d.getTaskTreeDocument();j(),U(D,t.options.graphType),_(t.options.routeInfoJSON,t.options.graphType,!1,t)})),I.push(t)},G=function(){var e=document.getElementById("routeGraphTaskContainer"),t=document.getElementById("viewTaskContainerExternal");if(null!=e||null!=t){c.getLoginUser()!=M.model.ownerFilter&&"edit"==d.getTaskTreeDocument().options.graphType&&(d.getTaskTreeDocument().options.graphType="view",widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:"edit"}));let e=d.getTaskTreeDocument().options.graphType;j(),U(D,e),_(M,e,!0)}},q=function(e,t){p.updateTaskDetails(d,M).then((t=>{widget.notify.handler().addNotif({level:"success",message:o.successEditTask,sticky:!1}),widget.routeMgmtMediator.publish("route-task-on-save"),widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:C}),H(e),f.refreshRouteData(M)}),(i=>{t.disabled=!1,document.querySelector("#graph_cancel").dsModel.disabled=!1,t.label=o.save,i.refresh?(widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:C}),H(e)):i.error?widget.notify.handler().addNotif({level:"error",message:i.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",message:o.allTaskNotValidatedErrorForEdit,sticky:!1})}))},H=function(e,t){let o,i=document.querySelector(".Tasks-gridView-View");document.querySelector(".canvas");if(j(),"view"==C?("GridView"==m.getViewType()&&(widget.routeMgmtMediator.publish("show-plus-icon-in-tasks-toolbar"),widget.routeMgmtMediator.publish("show-remove-icon-in-tasks-toolbar"),i.addClassName("task-grid-container-edit-mode")),e.view="edit",C="edit"):("GridView"==m.getViewType()&&(widget.routeMgmtMediator.publish("hide-plus-icon-in-tasks-toolbar"),widget.routeMgmtMediator.publish("hide-remove-icon-in-tasks-toolbar"),i.removeClassName("task-grid-container-edit-mode")),e.view="view",C="view"),U(D,e.view),"GridView"==m.getViewType()){let e=document.querySelector("#task-graph-toolbar");e&&e.hide()}b=e.view,t?(o=d.getTaskTreeDocument(),_(M,e.view,!1,o)):_(M,e.view,!0),widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode")},z=function(){let e=d.getTaskTreeDocument(),t=e.getAllDescendants(),o=[];for(var i=0;i<t.length;i++){let n=t[i];Z(n,e)&&(Y(n)&&X(n)||K(n)&&$(n,e))&&o.push(n)}o=J(o),l.onDoubleClickOfTaskTile(o[0].tileView)},J=function(e){return e.sort((function(e,t){return null!=e.options.grid.taskDueDate&&""!=e.options.grid.taskDueDate||null!=t.options.grid.taskDueDate&&""!=t.options.grid.taskDueDate?null==e.options.grid.taskDueDate||""==e.options.grid.taskDueDate?1:null==t.options.grid.taskDueDate||""==t.options.grid.taskDueDate?-1:new Date(e.options.grid.taskDueDate)-new Date(t.options.grid.taskDueDate):0})),e},X=function(e){return"Assigned"==e.options.grid.current},K=function(e){return"Review"==e.options.grid.current},Y=function(e){return e.options.grid.taskAssigneeUsername==c.getLoginUser()},$=function(e,t){return(t.options&&t.options.routeInfoJSON&&t.options.routeInfoJSON.model?t.options.routeInfoJSON.model.UserName:"")==c.getLoginUser()},Z=function(e,t){let o=Q(t);if(K(e)&&o.contains("Review"))return!0;if(X(e)){if("Comment"==e.options.grid.taskAction&&o.contains("Comment"))return!0;if("Approve"==e.options.grid.taskAction&&o.contains("Approval"))return!0}return!1},Q=function(e){return e.options&&e.options.routeInfoJSON&&e.options.routeInfoJSON.model?e.options.routeInfoJSON.model.Activity_State:""},ee=function(){l.fitToWindowDefaultLoad(A,E)};return{build:e=>(D=e,m.resetViewType(),U(e,"view")),initTaskGraphView:(e,t)=>(C=t,b=t,M=e,_(e,t,!1)),switchView:e=>function(e){let t=d.getTasksDataForCreation(),i=d.getTaskTreeDocument().options.isTaskUpdated,n=p.getTasksDatasForDelete(d);n.length>0&&(i=!0);let s=D.getElement(".no-tasks-to-show-container"),a={};if("edit"==C)if(!i&&t||null==i||s&&0==n.length)a.refresh=!0,a.message="Tasks are not modified",widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:C}),H(e);else{let t=new v;t.inject(document.body),new w({modalFlag:!0,width:350,height:150,title:o.switchToViewMode,content:o.switchToViewModeConfirmation,immersiveFrame:t,buttons:{Ok:new h({disabled:!1,onClick:function(t){t.dsModel,t.dsModel.dialog.close(),n&&D.getElement(".no-tasks-to-show-container")&&u.hideEmptyTasksPlaceholder(D,"EditMode"),widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:C}),H(e)}}),Cancel:new h({onClick:function(e){e.dsModel.dialog.close()}})}})}else widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:C}),H(e);k.getModel().setFilterModel({taskOrder:{filterId:"set"},label:{filterId:"stringRegexp"},revision:{filterId:"set"},taskActionNLS:{filterId:"set"},currentNLS:{filterId:"set"},awaiting_taskApprovalStatus:{filterId:"set"},subRouteGridApprovalStatus:{filterId:"set"},taskAssignee:{filterId:"set"},comments:{filterId:"stringRegexp"},routeOwnerUGTitle:{filterId:"stringRegexp"},templateTask:{filterId:"set"},routeTaskPriorityNLS:{filterId:"set"}}),widget.setValue("taskIdTobePersisted",void 0)}(e),destroy:()=>j(),fitToWindowDefaultLoad:()=>ee(),addRouteTask:()=>function(){if(k.getModel().options&&k.getModel().options._isTaskPanelOpened)widget.notify.handler().addNotif({level:"error",subtitle:o.taskErrorOnAdd,sticky:!1});else if(null!=document.querySelector(".no-tasks-to-show-container"))widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:"view"}),widget.routeMgmtMediator.publish("redraw-graph-edit",{graphMode:"EditMode"});else{var e=d.getTaskTreeDocument();let o=e.getChildren().length-2;var t=d.getTaskNodeModel("right",o);j(),U(D,e.options.graphType),_(e.options.routeInfoJSON,e.options.graphType,!1,e),widget.routeMgmtMediator.publish("task-DataGrid-on-dblclick",t)}}()}})),define("DS/ENORouteMgmt/Views/Panels/RouteTaskPanel",["DS/ENORouteMgmt/Views/Form/TaskView","DS/ENORouteMgmt/Utilities/CollabTasksResponseFormatter","DS/ENORouteMgmt/Components/Mediator","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Components/Notifications","DS/ENORouteMgmt/EnoviaBootstrap"],(function(e,t,o,i,n,s){"use strict";return{init:(a,r,l,d)=>function(a,r,l,d){if("ENOTASK_AP"==widget.getValue("appId")){let u="";u=r.cbtModel._attributes.routeTaskRouteId?r.cbtModel._attributes.routeTaskRouteId:r.cbtModel._rowObjects[0].relateddata.route[0].id;let c=r.cbtModel.id,p=r;return p.options=d,s.start({id:widget.id}),widget.data.routeCredentials={securityContext:r.cbtModel.securityContext,tenant:r.cbtModel.tenant},widget.data.csrf=r.cbtModel.csrf,widget.routeMgmtMediator=new o,widget.notify=new n,new Promise((function(o,n){i.fetchRouteAndTaskByRouteId(u).then((i=>{d.loadingPanel&&d.loadingPanel.off();let n=t.getRouteTaskResponse(i,c);e.renderTaskRightPanel(a,n,l,p),o()}),(e=>{d.loadingPanel&&d.loadingPanel.off(),e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:NLS.errorFetchingRoute,sticky:!1})}))}))}e.renderTaskRightPanel(a,r,l)}(a,r,l,d)}})),define("DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphEditView",["DS/WAFData/WAFData","DS/ENORouteMgmt/Utilities/ParseJSONUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","DS/egraph/core","DS/egraph/views","DS/egraph/iact","DS/egraph/utils","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils","DS/ENORouteMgmt/Model/InitiateRouteTaskModel","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Views/Graph/eGraphToolbar","DS/ENORouteMgmt/EnoviaBootstrap","css!DS/UIKIT/UIKIT.css","css!DS/egraph/views.css","css!DS/egraph/views_default.css","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p){"use strict";let m,g,f,h,w,v,S=[],k="http://www.w3.org/2000/svg",T=function(e){let t=new UWA.Element("div",{id:"templates_create",display:"none"}).inject(e);new UWA.Element("div",{class:"mixnode"}).inject(t);var o=new UWA.Element("div",{class:"canvas",id:"graph_canvas_create"});o.inject(e),o.addEventListener(void 0!==document.body.onwheel?"wheel":"mousewheel",(function(e){var t=document.querySelector(".wux-controls-combobox-popup");t&&(t.style.display="none");var o=document.querySelector(".wux-menu-container");o&&(o.style.display="none")}),!0),l.createToolbarContainer(e),h=e.id,o.addEventListener("click",(function(){document.querySelector(".wux-menu")&&(document.querySelector(".wux-menu").style.display="none")}))},R=function(e,t){function p(){n.HTMLNodeView.call(this)}a.inherit(p,n.HTMLNodeView),p.prototype.buildNodeElement=function(e){if(e.data.content){if("Any"==e.data.title||"All"==e.data.title){let t=e.data.content;return l.drawGraphNode(t,"dropdown")}if("terminating node"==e.data.type){let t=e.data.content;return l.drawGraphNode(t,"terminating-node")}{let t=e.data.content,o={width:"300px"};return l.drawGraphNode(t,"tile",o)}}var t=document.querySelector("#templates_create > .mixnode").cloneNode(!0);return t.appendChild(document.createTextNode(o[e.data.title])),t};var C=new i.BoundsGeometry;function E(){n.HTMLNodeView.call(this)}function A(e,t,o){this.side=e,this.nodeIndex=t,this.events=o,n.SVGConnView.call(this)}function O(e){return{"01":"bottom",10:"right","0-1":"top","-10":"left"}[e]}function I(e){e.collapsed||e.geometry.recenterGroup(e),e.set("collapsed",!e.collapsed)}C.paddingTop=80,a.inherit(E,n.HTMLNodeView),E.prototype.buildNodeElement=function(e){var t=document.querySelector(e.collapsed?"#templates_create > .collapsed-group":"#templates_create > .expanded-group").cloneNode(!0);return t.appendChild(document.createTextNode("Any one of the task can be completed to move the next step")),t},a.inherit(A,n.SVGConnView),A.prototype.buildConnElement=function(e){n.SVGConnView.prototype.buildConnElement.call(this,e);let t=document.createElementNS(k,"rect");return t.setAttribute("width",21),t.setAttribute("height",21),t.setAttribute("class","rectConnnector"),t},A.prototype.onmodifyDisplay=function(t,i,s){let a="view"!=m,r=!1;a=(!t.node.data.title||"Any"==t.node.data.title||"All"==t.node.data.title||"Finish"==t.node.data.title)&&"view"!=m&&arguments[0].showPlusIcon,arguments[0].showArrow&&(r=!0);let u=O(String(t.anormx)+String(t.anormy));n.SVGConnView.prototype.onmodifyDisplay.apply(this,arguments);let c=this.display.elt,p=c.getAttribute("transform"),g=l.changeTransformOfSvg(p,u,t.node);if(!c.nextElementSibling){if(g&&(c.setAttribute("transform",g.rect),p=g.text),a){let w=document.createElementNS(k,"text");w.setAttribute("class","plusConnector"),w.setAttribute("transform",p),w.setAttribute("alignment-baseline","middle"),w.textContent="+";let v=document.createElementNS(k,"title");v.textContent=o.addTask,w.appendChild(v),this.prevEvent,w.addEventListener("click",(function(e){h(e)})),w.addEventListener("touchstart",(function(e){e.preventDefault(),h(e)})),this.display.elt.parentNode.appendChild(w)}else c.setAttribute("display","none");function h(i){if(i.stopImmediatePropagation(),l.isTaskPanelOpened(t.node.data.model))widget.notify.handler().addNotif({level:"error",subtitle:o.taskErrorOnAdd,sticky:!1});else{let o=O(String(t.anormx)+String(t.anormy)),i=parseInt(t.node.data.model.options.grid.taskOrder),n=d.getTaskNodeModel(o,i),s=n.getTreeDocument();s.options._isSplitTaskPresent?(D(),T(f),R(e,s)):l.insertNewNode(t,n,s),widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons")}}if(r){let S=document.createElementNS(k,"text");S.setAttribute("class","arrowConnector"),S.setAttribute("transform",g?g.arrow:p),S.setAttribute("alignment-baseline","central"),S.textContent=">",this.display.elt.parentNode.appendChild(S)}}},w=new i.EGraph,w.addView("main",new n.HTMLGraphView(document.querySelector("#graph_canvas_create")));new c.Toolbar({buttons:[{id:"fitToWindow",query:"#"+h+" .main-rt-task-toolbar .fitToWindow",mode:"push",cb:function(){l.fitToWindow(w,h)}}]});w.addListener("update",(function(e){if(w.selection.last&&w.selection.last.data){w.selection.last.data.content.elements.container.click()}})),v=new s.StateMachine(w,null,null,w.views.main),v.rootState.newDragForElement=(v.rootState.newDragForElement,function(e,t,o){if(t.type===i.Type.GROUP&&"expand-btn"===o)return new s.SubEltClickDrag(t,o,I.bind(void 0,t))}),l.setZoomOptionsOnGraph(w),function(){w.updateLock();try{t?(M(e,w),l.init(p,A,w,m,g),S.concat(l.registerEventsForCreateGraph()),l.createGraphNodes(t)):r.fetchRouteTasks(e.id).then((function(t){if(M(e,w),e.createTask||t.length>0){l.init(p,A,w,m,g),S.concat(l.registerEventsForCreateGraph()),d.destroy(),t=y(t),e.id&&""!=e.id&&(t=b(t)),e.taskEditSetting&&(t=l.updateTaskEditSettings(t,e.taskEditSetting)),"Route Template"==e.Type&&(t.parentObjectType="Route Template");let o=d.getModel(t);o.options.routeId=e.id,o.options.routeInfoJSON=e,o.options.graphType=m,o.options._isSplitTaskPresent?(D(),T(f),R(e,o)):l.createGraphNodes(o),widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons")}else u.showEmptyTasksPlaceholder(document.querySelector(".create-task-graph-container"),"createMode");widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons")}))}finally{w.updateUnlock()}}()},y=function(e){return e.forEach(((e,t)=>{if(e.routeOwnerTask&&"TRUE"==e.routeOwnerTask){let t=p.getLoginUserFullName();e.taskAssignee=t,e.assigneeId="contextUser"}})),e},b=function(e){return e.forEach((function(e){e.templateTask="Yes"})),e},M=function(e,t){let o=widget.routeMgmtMediator.subscribe("redraw-graph-create",(function(t){if(t.taskTreeDocument){D();let o=d.removeGraphNodesFromTree(t.taskTreeDocument);T(f),R(e,o)}else{let o=".create-task-graph-container";"EditMode"==t.graphMode&&(o=".route-graph-task-container"),u.hideEmptyTasksPlaceholder(document.querySelector(o),t.graphMode),D(),e.createTask=!0,e||((e={}).id=""),T(f),R(e)}}));S.push(o),o=widget.routeMgmtMediator.subscribe("initiateRoute-on-TemplateSelection",(function(t){if(d.destroy(!0),t.template&&t.template.length>0&&t.template[0].id){if(f){let o=".create-task-graph-container";u.hideEmptyTasksPlaceholder(document.querySelector(o),"EditMode"),D(),T(f),null==e&&(e={}),e.id=t.template[0].id,R(e)}}else f&&(D(),T(f),e.id="",e.templateId="",R(e));e.createTask=!1})),S.push(o)},D=function(){let e=document.querySelector("#"+h);e.querySelector("#templates_create")&&e.querySelector("#templates_create").destroy(),e.querySelector("#graph_canvas_create")&&e.querySelector("#graph_canvas_create").destroy(),e.querySelector("#task-graph-toolbar")&&e.querySelector("#task-graph-toolbar").destroy(),S.forEach(((e,t)=>{widget.routeMgmtMediator.unsubscribe(e)}))};return{build:e=>(f=e,T(e)),initTaskGraphView:(e,t)=>(S.forEach(((e,t)=>{widget.routeMgmtMediator.unsubscribe(e)})),m=t,g=e,""==e&&(m="create"),e.templateId&&!e.id&&(e.id=e.templateId),null==e.id&&(e.id=""),R(e)),destroy:()=>{D()}}})),define("DS/ENORouteMgmt/Views/RouteTasksView",["DS/ENORouteMgmt/Views/Grid/RouteTasksDataGridView","DS/ENORouteMgmt/Config/Toolbar/RouteSummaryToolbarConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Model/RouteTaskModel","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Views/ToggleTaskViews","DS/ENORouteMgmt/Controller/RouteServicesController","DS/Utilities/Array","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Model/Utils/TaskModelUtils","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphEditView","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphView","DS/Core/PointerEvents","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g){"use strict";let f,h,w=[],v=function(t,o){let n=UWA.createElement("div",{id:"dataGridTasksDivToolbar",class:"toolbar-container",styles:{width:"100%"}}).inject(t),s=i.getModel(),a=e.build(s,o);return e.getGridViewToolbar().inject(n),a.inject(t),V(i.getModel()),W(i.getModel(),o),L(),j(),b(),t},S=function(e,t){if(t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.multipleHitCount){let e={};e.model=t.nodeModel,e.model.routePropertiesInfo=f,e.routePropertiesInfo=f,require(["DS/ENORouteMgmt/Views/Menu/TaskContextualMenu"],(function(t){t.onDoubleClickOfTaskGrid(e)}))}},k=function(e,t){let o={};-1!=t.rowID&&(o.model=t.nodeModel,o.model.routePropertiesInfo=f,o.routePropertiesInfo=f,t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&require(["DS/ENORouteMgmt/Views/Menu/TaskContextualMenu"],(function(t){t.taskGridRightClick(e,o)})))},T=function(e){y(e,"select")},R=function(e){y(e,"deSelect")},y=function(e,t){let o=e.options.grid.id,i=l.getTaskTreeDocument();if("view"==i.options.graphType)for(var n=i.getAllDescendants(),s=0;s<n.length;s++){let e=n[s].options.grid.id;if(null!=e&&null!=o){let n=i.getAllDescendants()[s];null!=n.tileView&&e==o&&("select"===t?n.tileView.highlight():n.tileView.unhighlight())}}},b=function(){let e=o.dataGridView();e.addEventListener(m.POINTERHIT,S),e.addEventListener("contextmenu",k),e.getTreeDocument().getXSO().onAdd(T),e.getTreeDocument().getXSO().onRemove(R),M()},M=function(){D();let e=widget.routeMgmtMediator.subscribe("route-task-on-change-assignee",(function(e){i.updateAssignee(e)}));w.push(e),e=widget.routeMgmtMediator.subscribe("task-action-on-save",(function(){P()})),w.push(e),w.push(e),e=widget.routeMgmtMediator.subscribe("redraw-graph",(function(){x()})),w.push(e),e=widget.routeMgmtMediator.subscribe("route-task-on-save",(function(){P()})),w.push(e),e=widget.routeMgmtMediator.subscribe("ON_SPLIT_ROUTENODE",(function(){P("splitTask")})),w.push(e),e=widget.routeMgmtMediator.subscribe("disable-switch-view-and-add-save-icon",(function(e){F(e.curView)})),w.push(e),e=widget.routeMgmtMediator.subscribe("disable-edit-icon-in-tasks-tab",(function(){E()})),e=widget.routeMgmtMediator.subscribe("show-edit-icon-in-tasks-tab",(function(){A()})),e=widget.routeMgmtMediator.subscribe("hide-edit-icon-in-tasks-tab",(function(){O()})),w.push(e),e=widget.routeMgmtMediator.subscribe("route-task-open-click-view-mode",(function(e){C(!0)})),w.push(e),e=widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",(function(e){C(!1)})),w.push(e),e=widget.routeMgmtMediator.subscribe("show-plus-icon-in-tasks-toolbar",(function(){I()})),w.push(e),e=widget.routeMgmtMediator.subscribe("hide-plus-icon-in-tasks-toolbar",(function(){N()})),w.push(e),e=widget.routeMgmtMediator.subscribe("update-Route-Task-Model",(function(e){u.updateRouteTaskModel(e)})),w.push(e),e=widget.routeMgmtMediator.subscribe("show-remove-icon-in-tasks-toolbar",(function(){U()})),w.push(e),e=widget.routeMgmtMediator.subscribe("hide-remove-icon-in-tasks-toolbar",(function(){_()})),w.push(e),e=widget.routeMgmtMediator.subscribe("task-DataGrid-on-dblclick",(function(e){let t=i.getModel();if(widget.getValue("taskIdTobePersisted")){if(e&&e._id&&null!=t){let i=t.getChildren();for(var o=0;o<i.length;o++)if(i[o].options.id==e._id){let e={};i[o].select(!0),e.model=i[o],e.model.routePropertiesInfo=f,e.routePropertiesInfo=f,require(["DS/ENORouteMgmt/Views/Menu/TaskContextualMenu"],(function(t){t.onDoubleClickOfTaskGrid(e)}));break}}}else if(e&&e._id){if(null!=t){let i=t.getChildren();for(o=0;o<i.length;o++)if(i[o].options.graphNodeId==e._id){let e={};i[o].select(!0),e.model=i[o],e.model.routePropertiesInfo=f,e.routePropertiesInfo=f,require(["DS/ENORouteMgmt/Views/Menu/TaskContextualMenu"],(function(t){t.onDoubleClickOfTaskGrid(e)}));break}}}else if(null!=t&&1==t.getChildren().length){let e={};t.getChildren()[0].select(!0),e.model=t.getChildren()[0],e.model.routePropertiesInfo=f,e.routePropertiesInfo=f,require(["DS/ENORouteMgmt/Views/Menu/TaskContextualMenu"],(function(t){t.onDoubleClickOfTaskGrid(e)}))}})),w.push(e)},D=function(){w.forEach(((e,t)=>{widget.routeMgmtMediator.unsubscribe(e)})),w=[]},C=function(t){e.getDataGridInstance().getTreeDocument().options._isTaskPanelOpened=t},E=function(){let t=e.getGridViewToolbar().getNodeModelByID("editTask"),o=e.getGridViewToolbar().getNodeModelByID("view");t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&(t._associatedView.elements.container.querySelector(".wux-controls-button").removeAttribute("style"),t._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.disabled=!0),o&&o._associatedView.elements.container.querySelector(".wux-controls-button")&&(o._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.disabled=!1)},A=function(){let t=e.getGridViewToolbar().getNodeModelByID("editTask");t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&(t._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.visibleFlag=!0,null!=document.querySelector("#dataGridTasksDivToolbar .wux-controls-toolbar-category-separator")&&document.querySelector("#dataGridTasksDivToolbar .wux-controls-toolbar-category-separator").show())},O=function(){let t=e.getGridViewToolbar().getNodeModelByID("editTask");t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&(t._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.visibleFlag=!1,null!=document.querySelector("#dataGridTasksDivToolbar .wux-controls-toolbar-category-separator")&&document.querySelector("#dataGridTasksDivToolbar .wux-controls-toolbar-category-separator").hide())},I=function(){let t=e.getGridViewToolbar().getNodeModelByID("addRouteTask"),o=i.getModel(),n=!0;if(0==o.getChildren().length||"GraphView"==s.getViewType())n=!1;else if(o.getChildren().length>=0){var a=o.getChildren()[0];a&&a.options.grid&&a.options.grid.taskEditSetting&&"Maintain Exact Task List"==a.options.grid.taskEditSetting&&(n=!1)}n&&t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&(0==t.options.visibleFlag&&t.updateOptions({visibleFlag:!0}),t._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.visibleFlag=!0)},N=function(){let t=e.getGridViewToolbar().getNodeModelByID("addRouteTask");t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&(t._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.visibleFlag=!1)},U=function(){let t=e.getGridViewToolbar().getNodeModelByID("removeRouteTask"),o=i.getModel(),n=!0;if(0==o.getChildren().length||"GraphView"==s.getViewType())n=!1;else if(o.getChildren().length>=0){var a=o.getChildren()[0];a&&a.options.grid&&a.options.grid.taskEditSetting&&"Maintain Exact Task List"==a.options.grid.taskEditSetting&&(n=!1)}n&&t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&(0==t.options.visibleFlag&&t.updateOptions({visibleFlag:!0}),t._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.visibleFlag=!0)},_=function(){let t=e.getGridViewToolbar().getNodeModelByID("removeRouteTask");t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&(t._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.visibleFlag=!1)},F=function(t){let o=e.getGridViewToolbar().getNodeModelByID("view"),i=e.getGridViewToolbar().getNodeModelByID("editTask");i._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.disabled=!1,"view"==t?(i._associatedView.elements.container.querySelector(".wux-controls-button").setStyle("color","rgb(54, 142, 196)"),o._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.disabled=!0):(i._associatedView.elements.container.querySelector(".wux-controls-button").removeAttribute("style"),o._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.disabled=!1)},P=function(e){f.model&&f.model.id&&a.fetchRouteTasks(f.model.id).then((function(t){i.getModel().removeRoots(),i.createModel(f),e&&"splitTask"==e&&V(i.getModel()),W(i.getModel())}))},x=function(e){f.model&&f.model.id&&a.fetchRouteTasks(f.model.id).then((function(t){e&&"splitTask"==e&&V(i.getModel()),W(i.getModel())}))},V=function(t){var o=!0;for(let e of t.getChildren())if("True"==e._options.grid.chooseUsersFromUg){o=!1;break}if(o){var i=e.getGridViewToolbar().getNodeModelByID("selectusers.tasks");i&&i.updateOptions({visibleFlag:!1})}},W=function(t,o){let i=!0,n=!0;for(let e of t.getChildren())if("Complete"!=e._options.grid.current){i=!1;break}var s;(t.getChildren().length>0&&i&&(n=!1),n)?(s=e.getGridViewToolbar().getNodeModelByID("editTask"))&&s.updateOptions({visibleFlag:!0}):(s=e.getGridViewToolbar().getNodeModelByID("editTask"))&&s.updateOptions({visibleFlag:!1});o&&"Route Template"==o.model.Type&&"Active"===o.model.actualState&&o.model.Actions.indexOf("demote")>=0&&((s=e.getGridViewToolbar().getNodeModelByID("editTask"))&&(s.updateOptions({visibleFlag:!1}),document.querySelector("#dataGridTasksDivToolbar .wux-controls-toolbar-category-separator").hide()))},L=function(){var t=e.getGridViewToolbar().getNodeModelByID("addRouteTask");t&&t.updateOptions({visibleFlag:!1})},j=function(){var t=e.getGridViewToolbar().getNodeModelByID("removeRouteTask");t&&t.updateOptions({visibleFlag:!1})};return{build:(e,t)=>(h=t,function(e,t){f=e,v(t,f)}(e,t)),addorRemoveRouteEventListeners:()=>addorRemoveRouteEventListeners(),destroy:()=>{i.destroy(),D()},getModel:()=>getSummaryModel(),destroyContainer:()=>(document.querySelector("#dataGridTasksDivToolbar")&&document.querySelector("#dataGridTasksDivToolbar").destroy(),void(document.querySelector(".Tasks-gridView-View")&&document.querySelector(".Tasks-gridView-View").destroy()))}})),define("DS/ENORouteMgmt/Views/Dialogs/DeleteGridTaskDialog",["DS/WAFData/WAFData","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Model/RouteTaskModel","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils","DS/WebappsUtils/WebappsUtils","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/ENORouteMgmt/Config/RemoveTaskGridViewConfig","DS/ENORouteMgmt/Model/RemoveRouteTaskConfirmationModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g){"use strict";let f,h={},w=function(){let e=n.getTaskTreeDocument();if(f=s.getSelectedRowsModel(),f.data.length<1)return void widget.notify.handler().addNotif({level:"warning",subtitle:g.ErrorTaskRemoveSelection,sticky:!1});let a=[],w=e.options.graphType,v=e.getAllDescendants();for(let e=0;e<f.data.length;e++)for(let t=0;e<v.length;t++){let o=v[t];if(o._id==f.data[e].options.graphNodeId){a.push(o);break}}var S=[],k=[];let T=[],R=[],y=[];for(let e=0;e<a.length;e++){let t=[];T.push(a[e].options.grid),T[e].taskAction=t,T[e].canShowDeleteTask=r.canShowDeleteTask(a[e],w,"showTaskRemove"),a[e].options.grid.taskDetails&&a[e].options.grid.taskDetails.forEach(((e,o)=>{"true"==e.split("~")[1]&&t.push(e.split("~")[0])})),!a[e].options.grid.taskDetails||t.includes("showTaskRemove")&&r.canShowDeleteTask(a[e],w,"showTaskRemove")?(S.push(a[e]),null==a[e].options.grid.title?R.push(g.taskTitlePlaceholder):R.push(a[e].options.grid.title)):(null==a[e].options.grid.title?y.push(g.taskTitlePlaceholder):y.push(a[e].options.grid.title),k.push(a[e]))}let b=new o;b.inject(document.body);let M=new UWA.Element("div",{id:"content",class:""}),D=new UWA.Element("div",{id:"removeGridTaskWarning",class:""});D.inject(M),c[3].visibleFlag=!1;var C,E,A,O,I="",N="",U=!1,_=!0;if(D.appendChild(UWA.createElement("div",{class:"warningicon",html:[{tag:"img",src:l.getWebappsAssetUrl("ENORouteMgmt","icons/32/MOM-Alerts.png")}]})),1==a.length)1==S.length?(U=!0,N=(N=g.removeTaskWarning).replace("{task}",R),D.appendChild(UWA.createElement("div",{class:"",text:N})),C=400,E="auto",I=(I=g.removeTaskHeaderSingle).replace("{count}",R),D.appendChild(UWA.createElement("div",{class:"",html:g.removeTaskWarningDetailSingle}))):(_=!0,I=g.removeTaskHeader2,N=(N=g.removeTaskWarningDetail2Single).replace("{task}",y),D.appendChild(UWA.createElement("div",{class:"",html:N})));else{p.createModel(T);let e=p.getModel(),t=(A=e,O=UWA.createElement("div",{id:"removeRoute-dataGridViewContainer",class:"removeRoute-gridView-View"}),h.cellDragEnabledFlag=!1,h.showRowBorderFlag=!0,h.showOutlineFlag=!0,h.showAlternateBackgroundFlag=!0,h.layoutOptions={rowsHeader:!1,columnsHeader:!0,rowSpacing:5,cellWidth:2},h.showContextualMenuColumnFlag=!1,m.confirmationDialogueBuild(A,c,!1,O,h));C="auto",E="auto";let o=S.length+k.length;o<5?t.setStyle("height",50*o+"px"):t.setStyle("height","200px"),M.appendChild(t),k.length>0&&(c[3].visibleFlag=!0),0==S.length?(I=g.removeTaskHeader2,D.appendChild(UWA.createElement("div",{class:"",html:g.removeTaskWarningDetail2})),new UWA.Element("div",{html:"&nbsp;"}).inject(D),new UWA.Element("div",{html:"&nbsp;"}).inject(D),_=!0):(I=1==S.length?(I=g.removeTaskHeaderSingle).replace("{count}",R):(I=g.removeTaskHeader).replace("{count}",S.length),U=!0,D.appendChild(UWA.createElement("div",{class:"",html:g.removeTaskWarning2})),D.appendChild(UWA.createElement("div",{class:"",html:g.removeTaskWarningDetail})))}if(1==U){new UWA.Element("div",{html:"&nbsp;"}).inject(D);var F=new d({type:"checkbox"});F.addChild(new u({type:"checkbox",label:g.removeRouteConfirmationButton,checkFlag:!1})),F.inject(D),F.addEventListener("buttonclick",(function(e){var t=e.dsModel.checkFlag;P.buttons.Ok.disabled=1!=t}))}let P=new t({modalFlag:!0,width:C,height:E,title:I,content:M,domId:"RouteImmersiveFrame",resizableFlag:!0,immersiveFrame:b,buttons:{Ok:new i({label:g.ok,domId:"RemoveTaskButton",disabled:_,onClick:function(e){S.length>0&&s.getModel().options._isTaskPanelOpened&&widget.routeMgmtMediator.publish("route-task-close-click-edit-mode");for(let e=0;e<S.length;e++)r.postGridDeleteAction(S[e]);let t=n.getTaskTreeDocument();s.updateModel(t.options.routeInfoJSON),s.getModel().RouteId=t.options.routeInfoJSON.id,e.dsModel.dialog.close()}}),Cancel:new i({label:g.cancel,onClick:function(e){e.dsModel.dialog.close()}})}});P.addEventListener("close",(function(e){b&&(b.elements.container.setStyle("height","1px"),b.elements.container.setStyle("width","1px"))}))};return{showConfirmationDialog:()=>w()}})),define("DS/ENORouteMgmt/Views/Panels/CreateTaskRightPanelSplitView",["DS/ENORouteMgmt/Components/Wrappers/SplitViewWrapper","DS/ENORouteMgmt/Views/Panels/RouteTaskPanel","DS/ENORouteMgmt/Utilities/RouteViewUtils"],(function(e,t,o){"use strict";var i,n,s=function(){};return s.prototype.getSplitView=function(t){var o=new e;let i=screen.width<450;var n={modelEvents:t,withtransition:!1,withoverflowhidden:!1,params:{leftWidth:1==i?10:50,rightWidth:35,leftMinWidth:1==i?85:40,leftVisible:!0,rightVisible:!1},rightMaximizer:!1,leftMaximizer:!1,resizable:!0};return o.init(n),o},s.prototype.setSplitviewEvents=function(e){var s,a=e,r=a.getRightViewWrapper();i=widget.routeMgmtMediator.subscribe("route-task-open-click",(function(e){s&&s.destroy(),(s=new UWA.Element("div",{id:"routeCreateContainer",styles:{height:"100%"}})).inject(r),t.init(s,e,"create"),a._showSide("right"),o.makeResponsiveCss("routeTaskPanel","#InitiateTaskPropertiesContainer")})),n=widget.routeMgmtMediator.subscribe("route-task-close-click",(function(e){null!=document.querySelector("#RouteImmersiveFrame #InitiateTaskCreatePropertiesBody")&&null!=document.querySelector("#RouteImmersiveFrame .right-container")&&(document.querySelector("#RouteImmersiveFrame .right-container").removeClassName("width-Ulter"),document.querySelector("#RouteImmersiveFrame .left-container").removeClassName("width-Ulter")),a._rightVisible&&a._hideSide("right")}))},s.prototype.getTokens=function(){return{open:i,close:n}},s})),define("DS/ENORouteMgmt/Views/TaskInfoEdit",["DS/ENORouteMgmt/Views/Panels/RouteTaskPanel"],(function(e){"use strict";return{init:(t,o,i)=>function(t,o,i){e.init(t,o,i)}(t,o,i)}})),define("DS/ENORouteMgmt/Views/RightPanelInfoView",["DS/ENORouteMgmt/Views/RouteInfoPropWidget","DS/ENORouteMgmt/Views/TaskInfoEdit","DS/ENORouteMgmt/Views/ContentInfoPropWidget","DS/ENORouteMgmt/Views/Panels/RoutePropertiesPanel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n){"use strict";let s;var a=function(e){this.container=e,s=new UWA.Element("div",{id:"routeInfoDisplayContainer",styles:{height:"100%"}})};return a.prototype.init=function(e,a){if(e.info&&e.model){let t={type:e.info,id:e.model.id};widget.setValue("right-panel-peristed-id",t)}s.empty(),"routeInfo"==a?i.render(s,e):"taskActionMode"==a||"taskEditMode"==a?t.init(s,e,a):"contentPreview"==a?o.render(s,e):"emptyInfo"==a&&function(){let e=UWA.createElement("div",{class:"route-information-no-selection-placeholder",html:[UWA.createElement("div",{class:"no-info-to-show",html:[UWA.createElement("div",{class:"pin",html:'<span class="fonticon fonticon-5x fonticon-info"></span>'}),UWA.createElement("span",{class:"no-info-to-show-label",html:n.NoInfoPlaceholder})]})]});s.appendChild(e)}(),this.container.appendChild(s)},a.prototype.destroy=function(){this.container.destroy()},a.prototype.destroyEditPropWidget=function(){i.destroyEditPropWidget()},a})),define("DS/ENORouteMgmt/Views/Menu/TaskContextualMenu",["DS/Menu/Menu","DS/ENORouteMgmt/Model/RouteTaskModel","DS/ENORouteMgmt/Views/Dialogs/DeleteTask","DS/ENORouteMgmt/Views/Dialogs/ChangeAssignee","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils","DS/ENORouteMgmt/Views/Dialogs/DeleteGridTaskDialog","DS/ENORouteMgmt/Controller/CollabTaskServicesController","DS/ENORouteMgmt/Utilities/RouteRefreshUtils","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Views/Dialogs/InitiateRouteDialog","DS/ENORouteMgmt/Model/TaskAttachmentModel","DS/ENORouteMgmt/Views/Form/TaskView","DS/RouteWebAppUX/Views/Menu/AttachmentContextualMenuItems","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","DS/ENORouteMgmt/Utilities/RouteTaskPanelChangeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h,w,v,S,k){"use strict";let T,R,y=function(e,t,o,l){R=t.model;let d=U(s.getTaskTreeDocument().getChildren());var u=[];let c=l.options.graphType;if("view"==c&&null!=t.model.options.grid.taskSubRoutes&&t.model.options.grid.taskSubRoutes.length>0&&u.push({name:k.approvalProcess,title:k.approvalProcess,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-route"},data:null,action:{callback:function(){v.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Approval Process"}),R.route=[];var e=t.model.options.grid.taskSubRoutes;for(let t=0;t<e.length;t++)R.route.push({dataelements:{id:e[t].routeId,name:e[t].routeName,approvalTaskId:e[t].approvalTaskId}});R.taskTitleForSubRoute=R.options.grid.title,R.taskIdForSubRoute=R.options.grid.id,a.openRouteTaskApprovalProcess(R)}}}),e.forEach(((e,n)=>{"isRouteOwner"===e&&"Assigned"==R.options.grid.current&&"In Process"==t.routePropertiesInfo.model.state&&"view"==c&&"Stopped"!=t.routePropertiesInfo.model.Activity_State&&"Maintain Exact Task List"!=R.options.grid.taskEditSetting&&d&&("Extend Task List"!=R.options.grid.taskEditSetting||"Extend Task List"==R.options.grid.taskEditSetting&&"No"==R.options.grid.templateTask&&"No"==R.options.grid.isInitialTask)&&u.push({name:"MarkasComplete",title:k.markasCompleteTitle,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-status-change"},data:null,action:{callback:function(){v.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Mark as Complete"}),b(t)}}}),"showTaskRemove"===e&&(o.data.length>1||a.canShowDeleteTask(R,c,e))?u.push({type:"PushItem",title:k.Delete,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash"},action:{callback:function(){v.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Delete"}),r.showConfirmationDialog()}}}):"canChangeAssignee"===e&&I(R,c,e)&&u.push({type:"PushItem",title:"TRUE"==t.model.options.grid.routeOwnerTask?k.selectAssignee:k.changeAssignee,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-user-change"},action:{callback:function(e){"TRUE"==t.model.options.grid.routeOwnerTask?v.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Select Assignee"}):v.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Change Assignee"}),i.changeAssignee(R)}}})})),"view"==c&&"Assigned"==R.options.grid.current&&R.options.grid.taskDetails&&n.canPerformTaskAction(R.options.grid.taskDetails)){m.getLoginUser()==R.options.grid.taskAssigneeUsername&&u.push({name:k.subRouteCommand,title:k.subRouteCommand,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-plus"},data:null,action:{callback:function(){v.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Create Subroute"});var e={inboxTaskId:R.options.grid.id,parentRouteId:R.routePropertiesInfo.id,inboxTaskTitle:R.options.grid.title,parentRouteTaskDueDate:R.options.grid.taskDueDate};widget.setValue("isDialogOpened",!0),g.InitiateRouteDialog(e)}}})}if("true"==R.options.grid.taskAcceptLink&&"Assigned"==R.options.grid.current&&"view"==c&&u.push({type:"PushItem",title:k.accepTask,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-user-ok"},action:{callback:function(e){v.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Accept Task"}),n.taskAccept({model:R.options.grid},R.routePropertiesInfo,"callFromMenu")}}}),"view"==c&&"Inbox Task"==R.options.grid.type){let e=o.data[0]._options.grid,t=[{options:{grid:{Title:e.title,id:e.id,Type:e.type}}}];u=u.concat(w.getCopyLink(t))}return u},b=function(e){var t={};t.id=e.routePropertiesInfo.id;var o={};o.id=e.model.options.grid.id,o.needsOwnerReview=e.model.options.grid.needsOwnerReview,o.currentState=e.model.options.grid.current;let i=new u;i.inject(document.body);let n=k.AutoCompleteTitle+e.model.options.grid.title;new c({modalFlag:!0,width:400,height:150,title:n,content:k.AutoCompleteContent,immersiveFrame:i,resizableFlag:!0,buttons:{Ok:new p({onClick:function(i){l.completeTask(o).then((o=>{d.refreshRouteData(t),widget.routeMgmtMediator.publish("task-action-on-save",e)}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",title:k.taskCompletedError,message:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:k.taskCompletedError,sticky:!1})})),i.dsModel.dialog.close()}}),Cancel:new p({label:k.cancel,onClick:function(e){e.dsModel.dialog.close()}})}})},M=function(e){var t=[];return t.push({name:k.Open,title:k.Open,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open"},data:null,action:{callback:function(){E(e)}}}),t},D="",C=!1,E=function(e){D=a.getPreviouslyOpenedTaskId(),R=e.model;let t=R.getTreeDocument();0==t.options._isTaskPanelOpened&&(D="");let o=s.getTaskTreeDocument().options.graphType;if("view"!=o)if(t.options._isTaskPanelOpened)widget.notify.handler().addNotif({level:"error",subtitle:k.taskErrorOnEdit,sticky:!1});else{t.options._isTaskPanelOpened=!0,R._isTaskPanelOpened=!0;let i=O(o,"open");widget.routeMgmtMediator.publish(i,{model:e}),widget.routeMgmtMediator.publish("task-content-height-update"),A(R)}else{widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",(function(){f.getAttachmentRemovalStatus("reset"),D="",C=!1,a.setUpdatedDueDate(C)})),widget.routeMgmtMediator.subscribe("route-task-close-click-edit-mode",(function(){f.getAttachmentRemovalStatus("reset"),D="",C=!1,a.setUpdatedDueDate(C)})),widget.routeMgmtMediator.subscribe("task-due-date-changed",(function(e){C=!!e,a.setUpdatedDueDate(C)}));let i=s.getTaskTreeDocument().getChildren(),n=f.getAttachmentRemovalStatus(),r=document.querySelector("#InitiateTaskPropertiesContainer .cke-comments-container"),l=h.getTaskPropertyFields(),d=!1;if("view"==o&&""!=D)for(let s=1;s<i.length-1;s++){let m=i[s].getAllDescendants();if(m)for(let i=0;i<m.length;i++){let s=m[i].options.grid;if(s.id==D){let i="";i="Review"==s.current?null!=s.reviewersComments||null!=s.reviewersComments?s.reviewersComments.trim():"":null!=s.comments||null!=s.comments?s.comments.trim():"";let m="";null!=r&&("Review"==s.current&&null!=CKEDITOR.instances&&null!=CKEDITOR.instances.ckeditorTaskReviewComment?m=CKEDITOR.instances.ckeditorTaskReviewComment.getData():null!=CKEDITOR.instances&&null!=CKEDITOR.instances.ckeditorTaskComment&&(m=CKEDITOR.instances.ckeditorTaskComment.getData()));let g="";if(null!=l&&l.autoCompleteComponent){let e=l.autoCompleteComponent.selectedItems;g=e&&e.length>0?"attachmentsAdded":""}if(null!=r&&i!=m||""!=g||n||a.getUpdatedDueDate()){d=!0;let i=new u;i.inject(document.body);let n=R.options.grid.id==D;new c({modalFlag:!0,width:400,height:150,title:k.openTask,content:n?k.reopenSelectedTask:k.unsavedTaskChanges,immersiveFrame:i,buttons:{Ok:new p({disabled:!1,onClick:function(i){i.dsModel;i.dsModel.dialog.close(),t.options._isTaskPanelOpened=!0,R._isTaskPanelOpened=!0;let n=O(o,"open");widget.routeMgmtMediator.publish(n,{model:e}),widget.routeMgmtMediator.publish("task-content-height-update"),A(R),a.setPreviouslyOpenedTaskId(R.options.grid.id),f.getAttachmentRemovalStatus("reset"),C=!1,a.setUpdatedDueDate(C)}}),Cancel:new p({onClick:function(e){e.dsModel.dialog.close()}})}})}}}}if(!d){t.options&&(t.options._isTaskPanelOpened=!0),R._isTaskPanelOpened=!0;let i=O(o,"open");widget.routeMgmtMediator.publish(i,{model:e}),widget.routeMgmtMediator.publish("task-content-height-update"),A(R),a.setPreviouslyOpenedTaskId(R.options.grid.id),C=!1,a.setUpdatedDueDate(C)}}},A=function(e){let t=s.getTaskTreeDocument().options.graphType,o=O(t,"close");widget.routeMgmtMediator.subscribeOnce(o,(function(t){e._isTaskPanelOpened=!1,null!=e.getTreeDocument()&&(e.getTreeDocument().options._isTaskPanelOpened=!1),widget.setValue("taskIdTobePersisted",void 0)}))},O=function(e,t){let o;return"create"==e?o="route-task-"+t+"-click":"view"==e?o="route-task-"+t+"-click-view-mode":"edit"==e&&(o="route-task-"+t+"-click-edit-mode"),o},I=function(e,t,o){let i=!1;if("view"==t&&(i=!0),e.routePropertiesInfo&&"Route Template"==e.routePropertiesInfo.model.Type&&"Inactive"!=e.routePropertiesInfo.model.actualState&&(i=!1),"Inactive"==e.options.grid.taskassigneeState)i=!0;else{let t=N(e);i=!(!i||!t)}return i},N=function(e){if(e.options){let t=e.options.grid.templateTask,o=e.options.grid.isInitialTask,i=e.options.grid.taskEditSetting,n=e.options.grid.type,s=e.options.grid.routeOwnerTask;if("Yes"===t&&"TRUE"==s)return!0;if("Yes"===t&&"Route Node"==n)return"Modify/Delete Task List"==i||"Modify Task List"==i;if("Yes"===o&&"Route Node"==n&&e.routePropertiesInfo&&null==e.routePropertiesInfo.model.templateTaskEditSetting)return"Modify/Delete Task List"==i||"Modify Task List"==i}return!0},U=function(e){let t=0,o=0;if(1==e.length)return!1;for(let i=1;i<e.length-1;i++){let n=e[i].getAllDescendants();if(n.length>0)for(let e=0;e<n.length;e++){t++,"Auto Complete"==n[e]._options.grid.approvalStatus&&o++}}return o!=t-1};return T={onDoubleClickOfTaskGrid:e=>E(e),taskGridRightClick:(o,i)=>function(o,i){let n=[],a=s.getTaskTreeDocument();o.preventDefault(),o.stopPropagation();var r=o.target.getBoundingClientRect(),l={position:{x:r.left,y:r.top+20}},d=t.getSelectedRowsModel(),u=[];if(1===d.data.length){let e=i.model.options.grid.taskDetails;e?e.forEach(((e,t)=>{"true"==e.split("~")[1]&&n.push(e.split("~")[0])})):n.push("showTaskRemove"),u=(u=u.concat(M(i))).concat(y(n,i,d,a))}if(d.data.length>1){let e=!1;i.routePropertiesInfo.model.taskEditSetting&&"Maintain Exact Task List"==i.routePropertiesInfo.model.taskEditSetting&&(e=!0),"edit"!=a.options.graphType||e||(n.push("showTaskRemove"),u=u.concat(y(n,i,d,a)))}e.show(u,l)}(o,i)},T})),define("DS/ENORouteMgmt/Views/Panels/RouteTaskPanelSplitView",["DS/ENORouteMgmt/Components/Wrappers/SplitViewWrapper","DS/ENORouteMgmt/Views/RightPanelInfoView"],(function(e,t){"use strict";var o=function(){};return o.prototype.getSplitView=function(t){var o=new e,i={modelEvents:t,withtransition:!1,withoverflowhidden:!1,params:{leftWidth:50,rightWidth:35,leftMinWidth:25,leftVisible:!0,rightVisible:!1},rightMaximizer:!1,leftMaximizer:!1,resizable:!0};return o.init(i),o},o.prototype.setSplitviewEvents=function(e){var o=e;let i=o.getRightViewWrapper(),n=new t(i);widget.routeMgmtMediator.subscribe("route-task-open-click-view-mode",(function(e){n.init(e,"taskActionMode"),widget.setValue("propWidgetOpen",!1),o._showSide("right")})),widget.routeMgmtMediator.subscribe("route-task-open-click-edit-mode",(function(e){n.init(e,"taskEditMode"),widget.setValue("propWidgetOpen",!1),o._showSide("right")})),widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",(function(e){o._rightVisible&&o._hideSide("right")})),widget.routeMgmtMediator.subscribe("route-task-close-click-edit-mode",(function(e){o._rightVisible&&o._hideSide("right")}))},o})),define("DS/ENORouteMgmt/Commands/RouteTaskView",["DS/ENORouteMgmt/Views/Panels/RouteTaskPanelSplitView","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphView","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Model/RouteTaskModel","DS/ENORouteMgmt/Views/RouteTasksView","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Components/Mediator","DS/ENORouteMgmt/Components/Notifications","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f,h){"use strict";let w={},v=function(e,i){var n,l,d,u;return new Promise((function(c,p){t.fetchRouteAndTaskByRouteId(e.id).then((t=>{l=(new a).parseResp(JSON.parse(t)),t=JSON.parse(t);var p={};p.data=t.data[0].relateddata.tasks,n=(new a).parseResp(p);var m={};m.data=t.data[0].relateddata.contents,u=(new a).parseResp(m);var g=t.data[0].relateddata.tasks;for(let e=0;e<n.length;e++){var f=[],h=!1;if(null!=g[e].relateddata.subroutes){for(var v=g[e].relateddata.subroutes[0].relateddata.route,k=0;k<v.length;k++)f.push(v[k].dataelements);f.length>0&&(h=!0)}var R="";h&&(R=g[e].relateddata.subroutes[0].dataelements.TaskApprovalStatus);var y=n[e].ContentToReviewIds,b=[];if(""!=y&&null!=y)for(var M=0;M<u.length;M++)y.includes(u[M].physicalid)&&b.push(u[M]);let t=[];for(let o=0;o<u.length;o++)(0==u[o].relatedToTaskIds.length||u[o].relatedToTaskIds.toString().includes(n[e].id))&&t.push(u[o]);n[e].routeContents=t,n[e].RouteTaskContentToReview=b,n[e].taskSubRoutes=f,n[e].subRouteApprovalStatus=R}var D={};D.model=r.gridData(l[0]);d={id:D.model.id,scopeId:""==D.model.Scope[0]?""==D.model.Scope[1]?D.model.Scope[2]:D.model.Scope[1]:D.model.Scope[0],routeBasePurpose:D.model.BasePurpose,chooseUserFromGroup:D.model.chooseUserFromGroup,model:D.model},T(e,w.container,i),S(n,d),s.destroyContainer(),s.build(d,w.graphContainer),o.destroy(),o.build(w.graphContainer),o.initTaskGraphView(d,"view"),c()}),(e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:h.errorFetchingRoute,sticky:!1})}))})).then((()=>{o.fitToWindowDefaultLoad()}))},S=function(e,t){t.model&&(e=f.updateTaskEditSettings(e,t.model.taskEditSetting)),i.destroy();let o=i.getModel(e);o.options.routeId=t.id,o.options.routeInfoJSON=t,o.options.responseLength=e.length,n.destroy(),n.createModel(t),n.getModel().RouteId=t.id},k=function(){let t=(new e).getSplitView(widget.routeMgmtMediator.getEventBroker());(new e).setSplitviewEvents(t),t.getLeftViewWrapper().appendChild(w.graphContainer);let o=new p;o.setContentInBackgroundLayer(t.getContent()),o.reactToPointerEventsFlag=!1,o.inject(w.container)},T=function(e,t,o){if("dialog"==e.renderType){k();let e=new p;e.inject(document.body);var i=h.taskPanelOpenWithHeader;new c({modalFlag:!0,width:1e3,height:1e3,title:i,content:t,immersiveFrame:e,resizableFlag:!0,buttons:{Cancel:new m({onClick:function(e){e.dsModel.dialog.close()}})}})}else"container"==e.renderType?o.appendChild(t):"containerWithSplitView"==e.renderType&&(k(),o.appendChild(t))};return{init:(e,o)=>function(e,o){widget.notify=new u,l.start({id:widget.id}),widget.routeMgmtMediator=new d,widget.data.routeCredentials={securityContext:e.securityContext,tenant:e.tenant},w.container=new UWA.Element("div",{html:"",id:"viewTaskContainerExternal",class:"task-graph-container-external"}),w.graphContainer=new UWA.Element("div",{html:"",id:"viewTaskContainerGraphExternal",class:""}).inject(w.container),t.fetchAllowedContentTypesForRoute().then((t=>{g.setRouteContentTypes(t),v(e,o)}),(t=>{v(e,o)}))}(e,o)}})),define("DS/ENORouteMgmt/Views/Form/RouteTasksMembersInViewMode",["DS/ENORouteMgmt/Views/Form/TaskProperties","DS/ENORouteMgmt/Model/TaskAssigneeModel","DS/ENORouteMgmt/Views/Grid/TaskAssigneesDataGridView","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/ENORouteMgmt/Views/Dialogs/ChangeAssignee","DS/ENORouteMgmt/Views/Menu/TaskContextualMenu","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l){"use strict";let d=e.getTaskVaribles(),u=function(e,t,o){return o||(o=""),new UWA.Element("h5",{class:o,text:t.label}).inject(e)},c=function(){var e=new UWA.Element("div",{class:"assigneeField"}).inject(d._taskMemberProperties.formFields),a={};a.label=l.taskassignee;u(e,a,"assigneeHeader");var c=new UWA.Element("div",{class:"assignToSelfItemButton"}).inject(e);r.getLoginUser();var m;p(d,"view")&&d.data.model.taskDetailsList.includes("canChangeAssignee")&&((m=UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-user-change",id:"changeAssignee",title:"TRUE"==d.data.model.routeOwnerTask?l.selectAssignee:l.changeAssignee})).addEventListener("click",(function(e){i.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Accept Task"}),s.changeAssignee(d._taskGraphModel)})),m).inject(c);if("true"==d._taskGraphModel.options.grid.taskAcceptLink){var g=function(){var e=UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-user-ok",id:"assignToSelf",title:l.accepTask});return e.addEventListener("click",(function(e){i.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Accept Task"}),n.taskAccept({model:d._taskGraphModel.options.grid},d._routeInfo,"callFromMenu")})),e}();g.inject(c)}if("TRUE"==d.data.model.routeOwnerTask&&"Route Template"==d._routeInfo.Type){new UWA.Element("span",{text:l.routeOwnerTask}).inject(d._taskMemberProperties.formFields)}else{(function(e){var i=new UWA.Element("div",{id:e,class:""});let n=[{assigneeTitle:d.data.model.taskAssignee,userGroupTitle:d.data.model.assigneeTitle,assigneeId:d.data.model.assigneeId,assigneeName:d.data.model.taskAssigneeUsername,assigneeType:d.data.model.assigneeType,assigneePID:d.data.model.assigneePID,ugUUID:d.data.model.ugUUID,Scope:d._routeInfo.Scope,fieldType:"Assignee"}];t.destroy(),t.createModel(n);let s=t.getModel();return o.build(s).inject(i),i})("taskAssigneesId").inject(d._taskMemberProperties.formFields)}},p=function(e,t){let o=!1;"view"==t&&(o=!0),e._routeInfo&&"Route Template"==e._routeInfo.Type&&"Inactive"!=e._routeInfo.actualState&&(o=!1);let i=m(e);return o=!(!o||!i),o},m=function(e){if(e.data){let t=e.data.model.templateTask,o=e.data.model.isInitialTask,i=e.data.model.taskEditSetting,n=e.data.model.type,s=e.data.model.routeOwnerTask;if("Yes"===t&&"TRUE"==s)return!0;if("Yes"===t&&"Route Node"==n)return"Modify/Delete Task List"==i||"Modify Task List"==i;if("Yes"===o&&"Route Node"==n&&e._routeInfo&&null==e._routeInfo.templateTaskEditSetting)return"Modify/Delete Task List"==i||"Modify Task List"==i}return!0},g=function(){var e=new UWA.Element("div",{class:"originatorField"}).inject(d._taskMemberProperties.formFields),i={};i.label=l.originator;u(e,i,"originatorHeader");if(null==d.data.model.originator){new UWA.Element("h5",{class:"Originator details",text:"--"}).inject(d._taskMemberProperties.formFields)}else{(function(){var e=new UWA.Element("div",{id:"taskOriginatorId",class:""});let i=[{assigneeTitle:d.data.model.originator,assigneePID:d.data.model.originatorPhId,assigneeId:d.data.model.assigneeId,assigneeName:d.data.model.originatorFullName,Scope:d._routeInfo.Scope,assigneeType:"Person",fieldType:"Originator"}];t.destroy(),t.createModel(i);let n=t.getModel();return o.build(n).inject(e),e})(d.data,d._routeInfo).inject(d._taskMemberProperties.formFields)}},f=function(){var e=new UWA.Element("div",{class:"OwnerField"}).inject(d._taskMemberProperties.formFields),i={};i.label=l.ownerProperties;u(e,i,"ownerHeader");var n=d.data.model.assigneeType;if("Group"===n||"User Group"===n||"Group Proxy"===n){new UWA.Element("h5",{class:"OwnerDetails",text:"--"}).inject(d._taskMemberProperties.formFields)}else{(function(e){var i=new UWA.Element("div",{id:e,class:""});let n=[{assigneeTitle:d.data.model.taskAssignee,userGroupTitle:d.data.model.assigneeTitle,assigneeId:d.data.model.assigneeId,assigneeName:d.data.model.taskAssigneeUsername,assigneeType:d.data.model.assigneeType,assigneePID:d.data.model.assigneePID,Scope:d._routeInfo.Scope,fieldType:"Owner"}];t.destroy(),t.createModel(n);let s=t.getModel();return o.build(s).inject(i),i})("taskOwnerId").inject(d._taskMemberProperties.formFields)}};return{drawLabelInViewMode:(e,t,o)=>u(e,t,o),renderMemberTabFields:()=>(d._taskMemberProperties.formFields=new UWA.Element("div",{id:"TaskMemberPropertiesContainer",class:"task-prop-container"}),c(),g(),void f())}})),define("DS/ENORouteMgmt/Views/RouteHeaderView",["DS/ENORouteMgmt/Views/Menu/RouteContextualMenu","DS/WebappsUtils/WebappsUtils","DS/ResizeSensor/js/ResizeSensor","DS/ENORouteMgmt/Utilities/IdCardUtil","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/Actions/RouteActions","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","DS/ENORouteMgmt/Views/Dialogs/RouteLifeCycleDialogue","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/EnoviaBootstrap","DS/LifecycleControls/EditPropDialog","DS/TransientWidget/TransientWidget","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p){"use strict";let m;var g=function(e){this.container=e};g.prototype.resizeSensor=function(){new o(m,(function(){i.resizeIDCard(m.offsetWidth)}))},g.prototype.resizeIDCard=function(){i.resizeIDCard(m.offsetWidth)},g.prototype.init=function(o,i){m=new UWA.Element("div",{id:"routeIdCard",class:""}),this.container.appendChild(m);var n=new UWA.Element("div",{id:"infoAndThumbnailSec",class:"id-card-info-and-thumbnail-section"});m.appendChild(n);UWA.createElement("div",{id:"routeHome",class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-home fonticon-display fonticon-color-display",title:p.home,styles:{"font-size":"20px"},events:{click:function(e){S()}}}).inject(n);var s=new UWA.Element("div",{id:"thumbnailSection",class:"id-card-thumbnail-section",html:[UWA.createElement("div",{class:"id-card-thumbnail",styles:{"background-image":"url("+t.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_Route108x144.png")+")"}})]});n.appendChild(s);var r=new UWA.Element("div",{id:"infoSec",class:"id-card-info-section no-bottom-border"});n.appendChild(r);var l=new UWA.Element("div",{id:"infoHeaderSec",class:"id-card-header-section"});r.appendChild(l);var g=new UWA.Element("div",{id:"infoHeaderSecTitle",class:"id-card-title-section"});l.appendChild(g),UWA.createElement("h4",{title:o.model.Title,text:o.model.Title}).inject(g);var k=new UWA.Element("div",{id:"infoHeaderSecAction",class:"id-card-actions-section"});l.appendChild(k);let T=widget.getValue("routeIdCardPersistency"),R="wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-expand-down fonticon-display fonticon-color-display",y=p.idCardHeaderActionExpand;T&&"maximized"==T&&(R="wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-expand-up fonticon-display fonticon-color-display",y=p.idCardHeaderActionCollapse),UWA.createElement("div",{id:"expandCollapse",class:R,title:y,styles:{"font-size":"20px"},events:{click:function(e){f()}}}).inject(k);var b={},M=[],D={options:{}};D.options.grid=o.model;let C=o.model.OwnerId;M.push(D),b.data=M,("Complete"!=M[0].options.grid.state&&o.model.Actions.indexOf("delete")>-1||o.model.Actions.indexOf("saveAs")>-1||o.model.Actions.indexOf("changeowner")>-1)&&e.routeIdCardCheveron(b).inject(k);var E="fonticon-color-display";i&&(E="fonticon-color-active"),UWA.createElement("div",{id:"routeInfoIcon",title:p.idCardHeaderActionInfo,class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-info fonticon-display "+E+" ",styles:{"font-size":"20px"},events:{click:function(e){a.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Properties"}),widget.getValue("propWidgetOpen")?widget.routeMgmtMediator.publish("route-info-close-click",{info:"Route"}):widget.routeMgmtMediator.publish("route-header-info-click",{model:o.model,info:"Route"})}}}).inject(k);var A=new UWA.Element("div",{id:"infoDetailedSec",class:"id-card-detailed-info-section"});r.appendChild(A);var O=new UWA.Element("div",{id:"channel1",class:"properties-channel"});A.appendChild(O),v(o).inject(O);var I=UWA.createElement("div",{html:[UWA.createElement("label",{html:p.IDcardOwner+"&nbsp;:&nbsp;",class:""}),UWA.createElement("a",{html:o.model.OwnerFullName,class:""})]});null!=d.getSwymUrl()?(I.getChildren()[1].setStyle("cursor","pointer"),I.removeEvents(),I.addEvent("click",(function(e){c.showWidget("X3DPRFL_AP","",{login:o.model.UserName,url:d.getSwymUrl()+"?profile="+o.model.UserName},{mode:"panel",height:700,width:800})}))):(I.getChildren()[1].setStyle("cursor","pointer"),I.removeEvents(),I.addEvent("click",(function(e){var t={_context:d.getSecurityContextValue(),_selection:[{getID:function(){return C}}],getSecurityContext:function(){return this._context},getSelectedNodes:function(){return this._selection},displayNotification:function(){}};(new u).launchProperties(t)}))),I.inject(O);var N=o.model.ProjectTitle;N||(N=o.model.Project),UWA.createElement("div",{html:[UWA.createElement("label",{html:p.IDcardCollSpace+"&nbsp;:&nbsp;",class:""}),UWA.createElement("span",{html:N,class:""})]}).inject(O);var U=new UWA.Element("div",{id:"channel2",class:"properties-channel"});A.appendChild(U),UWA.createElement("div",{html:[UWA.createElement("label",{html:p.revision+"&nbsp;:&nbsp;",class:""}),UWA.createElement("span",{html:w(o.model.id,o.model.revision),class:""})]}).inject(U);var _=new Date(o.model.Modified);UWA.createElement("div",{html:[UWA.createElement("label",{html:p.IDcardModified+"&nbsp;:&nbsp;",class:""}),UWA.createElement("span",{html:_.toGMTString().parseRelativeTime(),class:""})]}).inject(U);var F=o.model.TemplateTitle;null!=F&&o.model.TemplateTitle.length>30&&(F=o.model.TemplateTitle.substring(0,27)+"..."),UWA.createElement("div",{html:[UWA.createElement("label",{html:p.routeTemplate+"&nbsp;:&nbsp;",class:""}),UWA.createElement("span",{html:F,title:o.model.TemplateTitle,class:""}),UWA.createElement("span",{html:"&nbsp;",class:""}),UWA.createElement("span",{html:h(o.model.TemplateId,o.model.TemplateRevision),class:""})]}).inject(U);var P=new UWA.Element("div",{id:"channel3",class:"properties-channel"});A.appendChild(P),UWA.createElement("div",{class:"id-card-description",html:[UWA.createElement("span",{text:o.model.Description,title:o.model.Description,class:""})]}).inject(P)},g.prototype.destroyContainer=function(){this.container.destroy()},g.prototype.destroyContent=function(){m.destroy()};let f=function(){var e=document.querySelector("#expandCollapse"),t=document.querySelector("#routeHeaderContainer");document.querySelector("#graph_canvas_view");let o=document.querySelector(".route-graph-task-container");if(e.className.indexOf("wux-ui-3ds-expand-up")>-1){if(e.className=e.className.replace("wux-ui-3ds-expand-up","wux-ui-3ds-expand-down"),t.classList.add("minimized"),e.title=p.idCardHeaderActionExpand,(i=document.querySelector("#thumbnailSection"))&&i.className.indexOf("id-card-thumbnail-remove")>-1)(n=document.querySelector("#infoSec")).classList.remove("id-info-section-align"),n.classList.add("id-info-section-align-minimized");null!=o&&o.setStyle("height","calc(100% - 96px)"),widget.setValue("routeIdCardPersistency","minimized")}else{var i,n;if(e.className=e.className.replace("wux-ui-3ds-expand-down","wux-ui-3ds-expand-up"),t.classList.remove("minimized"),e.title=p.idCardHeaderActionCollapse,(i=document.querySelector("#thumbnailSection"))&&i.className.indexOf("id-card-thumbnail-remove")>-1)(n=document.querySelector("#infoSec")).classList.remove("id-info-section-align-minimized"),n.classList.add("id-info-section-align");null!=o&&o.style.removeProperty("height"),widget.setValue("routeIdCardPersistency","maximized")}},h=function(e,t){if(null!=e&&""!=e){var o=UWA.createElement("a");return o.set({title:p.revision,text:t,phyId:e,revision:t,class:"cursorPointer",events:{click:function(){s.renderRevisionsDialog(this.getAttribute("phyid"))}}}),o}},w=function(e,t){if(null!=e&&""!=e){var o=UWA.createElement("a");return o.set({title:p.revision,text:t,phyId:e,revision:t,class:"cursorPointer",events:{click:function(){s.renderRevisionsDialog(this.getAttribute("phyid"))}}}),o}},v=function(t){let o=UWA.createElement("div",{class:"maturity-state-container"});UWA.createElement("label",{class:"ms-label",html:p.IDcardMaturityState+"&nbsp;:"}).inject(o);var i=l.gridData(t.model);UWA.createElement("span",{class:"route-state-title "+t.model.state.toUpperCase().replace(/ /g,""),html:"&nbsp;"+t.model.Maturity_State+"&nbsp;",events:{click:function(){r.lifeCycle(i)}},styles:{cursor:"pointer",margin:"0 5px 0 5px"}}).inject(o);if(t.model.state&&"In Process"==t.model.state){let e=UWA.createElement("div",{class:"activity-state-container"}).inject(o),i=n.getRouteActivityStateIcon(t.model.Activity_State),s=UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+i}).inject(e),a=n.getRouteActivityStateNLS(t.model.Activity_State);if(t.model.Activity_State&&t.model.Activity_State.contains("your")){let o;if(t.model.Activity_State.contains("(")){const e=a.split("(");a=e[0],o="("+e[1]}s.addClassName("awaiting-tasks");UWA.createElement("a",{class:"rt-activity-state",html:"&nbsp;"+a,title:a,events:{click:function(e){widget.routeMgmtMediator.publish("OPEN-TASK-PROPERTIES",{info:"Route"})}},styles:{cursor:"pointer"}}).inject(e);if(o){UWA.createElement("a",{class:"rt-activity-state-counter",html:"&nbsp;"+o+"&nbsp;",title:a,events:{click:function(e){widget.routeMgmtMediator.publish("OPEN-TASK-PROPERTIES",{info:"Route"})}},styles:{cursor:"pointer"}}).inject(e)}}else{UWA.createElement("span",{class:"rt-activity-state",html:"&nbsp;"+a+"&nbsp;",title:a}).inject(e)}}let a=n.getRouteActions(t.model.Actions);if(n.isRouteActionStart(t.model.Actions)){let e=n.getRouteActionIcon(t.model.Actions);UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+e.name,styles:{color:e.color}}).inject(o);var d=0;UWA.createElement("a",{class:"",html:"&nbsp;"+a[0]+"&nbsp;",events:{click:function(e){widget.routeMgmtMediator.subscribeOnce("route-get-count-value",(function(e){d=e})),++d>1&&widget.notify.handler().addNotif({level:"error",subtitle:p.routeStartOperation,sticky:!1}),1==d&&s.startRoute(t.model.id)}},styles:{"font-weight":"bold",cursor:"pointer"}}).inject(o)}else{UWA.createElement("span",{html:e.routeIdCardStateCheveron(t.model.Actions,t.model.id,t.model.Title)}).inject(o)}return o},S=function(){if(widget.routeMgmtMediator.publish("route-back-to-summary"),widget.routeMgmtMediator.publish("route-tag-data-updated"),widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"),require(["DS/ENORouteMgmt/Model/RouteModel"],(function(e){widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:e.getModel()})})),widget.setValue("openedRouteId",void 0),widget.setValue("taskIdTobePersisted",void 0),widget.setValue("routeIdToBePersisted",void 0),null!=widget.data.contextTitle&&""!=widget.data.contextTitle&&null!=widget.data.fromContext&&"createNewRoute"==widget.data.fromContext){var e={id:"routes"};widget.routeMgmtMediator.publish("welcome-panel-action-selected",e)}else if(null!=widget.data.linkedContextTitle&&""!=widget.data.linkedContextTitle&&null!=widget.data.fromContext&&"createNewRoute"==widget.data.fromContext){e={id:"routes"};widget.routeMgmtMediator.publish("welcome-panel-action-selected",e)}};return g})),define("DS/ENORouteMgmt/Views/Form/TaskMemberView",["DS/ENORouteMgmt/Views/Form/TaskProperties","DS/ENORouteMgmt/Views/Form/RouteTasksMembersInViewMode","DS/ENORouteMgmt/Utilities/TaskPanelSubscribeEvents","css!DS/ENORouteMgmt/ENORouteMgmt.css"],(function(e,t,o){"use strict";let i=function(i,n){let s;s=e.getTaskVaribles(),o.destroy(n,s),t.renderMemberTabFields(),s._taskMemberProperties.formFields.inject(s._taskMemberProperties.formBody),o.subscribeToTaskEvents(s)};return{build:(e,t,o)=>{i(e,t)},destroy:(e,t)=>function(e,t){o.destroy(e,t)}(e,t),getTaskPropertyFields:()=>e.getTaskVaribles().taskMemberFields}})),define("DS/ENORouteMgmt/Views/RouteIDCardView",["DS/ENORouteMgmt/Views/RouteHeaderView","DS/ENORouteMgmt/Views/RouteTabsView","DS/ENORouteMgmt/Utilities/IdCardUtil","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Views/RouteHistory","DS/ENORouteMgmt/Utilities/DragAndDropOnRouteIDcard","DS/ENORouteMgmt/Utilities/DragAndDropManager"],(function(e,t,o,i,n,s,a){"use strict";let r,l,d,u,c;var p=function(e){this.rightPanel=e,r=new UWA.Element("div",{id:"routeHeaderContainer",class:"route-header-container"}),s.makeDroppable(r,m);let t=widget.getValue("routeIdCardPersistency");t&&"maximized"==t?r.addClassName("maximized"):r.addClassName("minimized"),l=new UWA.Element("div",{id:"routeFacetsContainer",class:"route-facets-container"})};let m=function(e,t){a._onRoutesummaryDropManager(e)};return p.prototype.init=function(n){var s=n.model.id;widget.setValue("routeIdToBePersisted",s),new e(r).destroyContainer(),new t(l).destroy(),u&&widget.routeMgmtMediator.unsubscribe(u),c&&widget.routeMgmtMediator.unsubscribe(c);new e(r).init(n,!1),d=n.model.id,new t(l,n).init(),this.rightPanel.appendChild(r),this.rightPanel.appendChild(l),new e(r).resizeSensor(),u=widget.routeMgmtMediator.subscribe("route-data-updated",(function(t){var n={model:i.gridData(t)};if(n.model.id==d){var s=o.infoIconIsActive();let i=new e(r);i.destroyContent(),i.init(n,s),i.resizeSensor(),i.resizeIDCard(),widget.propWidgetOpen&&(t.requestFrom&&"editPropWidget"==t.requestFrom||widget.routeMgmtMediator.publish("route-header-info-click",{model:n.model,info:"Route"}))}})),c=widget.routeMgmtMediator.subscribe("route-data-deleted",(function(e){e.model.includes(d)&&require(["DS/ENORouteMgmt/Views/RouteSummaryView"],(function(e){e.backToRouteSummary()}))}))},p.prototype.destroy=function(){this.rightPanel.destroy()},p})),define("DS/ENORouteMgmt/Views/Tile/RouteSummaryTileView",["DS/WAFData/WAFData","UWA/Core","DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Views/Menu/RouteContextualMenu","DS/WebappsUtils/WebappsUtils","DS/Core/PointerEvents","DS/ENORouteMgmt/Utilities/DragAndDropManager","DS/ENORouteMgmt/Utilities/DragAndDropOnRouteTileView","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l){"use strict";let d,u,c=function(e,t){let i=o.tileView();i.onDragStartCell=function(e,t){a.getContentForDrag(e,t)},i.onDragEndCell=function(e,t){e.target.removeClassName("wux-ui-state-activated wux-ui-state-highlighted")},i.onDropCell=function(e,t){a.onDropManager(e,t)},t.addEventListener("dragenter",(o=>{o.stopPropagation(),o.preventDefault(),t.hide(),e.show()})),t.addEventListener("dragover",(o=>{o.stopPropagation(),o.preventDefault(),t.hide(),e.show()})),t.addEventListener("draleave",(o=>{o.stopPropagation(),o.preventDefault(),t.show(),e.hide()}))},p=function(e,t){a._onRoutesummaryDropManager(e)};return{build:e=>function(e){u=e||new TreeDocument({useAsyncPreExpand:!0});let i=widget.getValue("RouteSummary-ShowView"),n="tile-view-container hideView";i&&"TileView"==i&&(n="tile-view-container showView"),d=t.createElement("div",{id:"TileViewContainer",class:n});let s=t.createElement("div",{class:"RTC-Tiledrop-container"});s.inject(d);let a=t.createElement("div",{class:"drop-zone add-content"}),m=t.createElement("div",{class:"dismiss-box",html:[{tag:"span",class:"fonticon fonticon-close fonticon-3x"},{tag:"span",class:"dismiss-box-content",html:l.dismiss}]});a.appendChild(m);let g=t.createElement("div",{class:"dropzonemsg-container",html:[{tag:"span",class:"fonticon fonticon-open fonticon-3x"},{tag:"p",class:"text-content",html:l.Open}]});a.appendChild(g);let f=t.createElement("div",{class:"Route-tile-blank-space"}).inject(d);s.appendChild(a),r.makeDroppable(s,p,f),s.hide(),g.addEventListener("dragleave",(function(e){e.stopPropagation(),e.preventDefault()})),s.addEventListener("dragleave",(e=>{e.stopPropagation(),e.preventDefault(),f.show(),s.hide()})),s.addEventListener("dragenter",(e=>{e.stopPropagation(),e.preventDefault(),e.shiftKey?s.children[0].children[0].hide():s.children[0].children[0].show()}));let h=o.build(u,d,!0),w=o.tileView();return w.onDragEnterBlank=function(e,t){return!1},w.onDragOverBlank=function(e,t){return!1},setTimeout((function(){if(d.querySelector(".wux-layouts-gridengine-poolcontainer-rel")){let e=d.querySelector(".wux-layouts-gridengine-poolcontainer-rel").offsetHeight;const t=new ResizeObserver((e=>{e.forEach((e=>{let t=d.querySelector(".wux-layouts-gridengine-poolcontainer-rel").offsetHeight;f.style.height=`calc(100% - ${t}px)`,f.style.width="100%"}))}));t.observe(d),f.style.height=`calc(100% - ${e}px)`,f.style.width="100%",c(s,f)}}),500),d.addEventListener("dragenter",(e=>{e.stopPropagation(),e.preventDefault(),e.shiftKey&&(f.hide(),s.show(),s.children[0].children[0].hide())})),h}(e),contexualMenuCallback:()=>{o.tileView().onContextualEvent={callback:function(e){var t=[];if(e&&e.cellInfos&&e.cellInfos.cellModel){var o=u.getSelectedNodes(),n=o[0].options.grid.Actions,s=o[0]._options.grid.id;t=i.routeTileCheveron(n,s)}return t}}},destroy:()=>{!function(){let e=o.tileView();e&&e.destroy()}()},getTileViewInstance:()=>o.tileView()}})),define("DS/ENORouteMgmt/Views/RouteSummaryView",["DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Views/Tile/RouteSummaryTileView","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Services/RouteServices","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Controller/CollabTaskServicesController","DS/Utilities/Array","DS/Core/PointerEvents","DS/ENORouteMgmt/Utilities/Utils","DS/ENORouteMgmt/Components/TagNavigator","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d,u,c,p,m,g,f){"use strict";let h=[],w=function(e){a.createModel(e);let t=M();return s.getSecurityContextValue()?l.hideeErrorPlaceholder(t):(b(t),widget.notify.handler().addNotif({title:f.errorCreateRouteForRoleTitle,subtitle:f.errorCreateRouteForRoleSubTitle,message:f.errorCreateRouteForRoleMsg,level:"warning",sticky:!1})),t},v=function(e){b(document.querySelector(".widget-container"));var t="";try{t=JSON.parse(e)}catch(e){}t.error?widget.notify.handler().addNotif({level:"error",subtitle:t.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:f.infoRefreshError,sticky:!1})},S=function(){let e;return void 0!==widget.data.ids&&(e=widget.data.ids),widget.data.contentId&&(e=widget.data.contentId),widget.data.routeId&&(e=widget.data.routeId),e},k=function(){return widget.data.approvalProcessIds},T=function(){return widget.data.approvalProcessType},R=function(){widget.data.approvalProcessIds=void 0,widget.data.approvalProcessType=void 0,widget.data.contentId=void 0},y=function(){void 0!==widget.data.ids&&(widget.data.ids=void 0),widget.data.contentId&&(widget.data.contentId=void 0),widget.data.routeId&&(widget.data.routeId=void 0),widget.data.approvalProcessIds&&(widget.data.approvalProcessIds=void 0),widget.data.approvalProcessType&&(widget.data.approvalProcessType=void 0)};function b(e){e||(e=new UWA.Element("div",{class:"widget-container"})).inject(widget.body),l.hideEmptyRoutePlaceholder(e),l.showeErrorPlaceholder(e)}let M=function(t){widget.setValue("HomePage","routes");var o=a.getModel();let i=e.build(o),s=n.build(o);n.contexualMenuCallback(),B();let r,d=e.getGridViewToolbar(),u=document.querySelector(".widget-container");r=u||new UWA.Element("div",{class:"widget-container"});let c=UWA.createElement("div",{id:"dataGridDivToolbar",class:"toolbar-container"}).inject(r);d.inject(c),i.inject(r),s.inject(r);var p=[];if(0==o.getChildren().length)l.showEmptyRoutePlaceholder(r,o);else{o.prepareUpdate();var m=0;o.getChildren().forEach((e=>{e._isHidden&&m++,p.push(e.options.id)})),o.pushUpdate(),m==o.getChildren().length&&l.showEmptyRoutePlaceholder(r,o)}return widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:o}),l.registerListeners(),p.length>1e3&&widget.notify.handler().addNotif({message:f.taggerWarning,level:"warning",sticky:!1}),_(p),widget.getValue("openSelected")&&(H(),widget.setValue("openSelected",void 0)),r},D=function(){let e=U(),t="";e.indexOf("Define")>-1&&(t+="Define,"),e.indexOf("In Process")>-1&&(t+="In_Process,"),e.indexOf("Complete")>-1&&(t+="Complete,"),""==t||(t=t.slice(0,-1)),widget.setValue("routeStateFilter",t)},C=function(){let e=U(),t="";e.indexOf("assigned")>-1&&(t+="Assigned,"),e.indexOf("owned")>-1&&(t+="Owned,"),""==t||(t=t.slice(0,-1)),widget.setValue("ownershipFilter",t)},E=function(t){let o=e.getDataGridInstance(),i=n.getTileViewInstance();t?(o.displayModalLoader(f.loadingRoutesMessage),i.displayModalLoader(f.loadingRoutesMessage)):(o.removeModalLoader(f.loadingRoutesMessage),i.removeModalLoader(f.loadingRoutesMessage))},A=function(e){var t=a.getModel(),o=g.getTaggerVariable(),i=g.getSearchWithInTypedValue();t.prepareUpdate(),c.optimizedForEach(t.getChildren(),(function(t){null==i&&0==Object.keys(o.getCurrentFilter().allfilters).length||e.includes(t.options.id)?t.show():t.hide()}));t.getChildren().forEach((e=>{e._isHidden&&0})),t.pushUpdate();let n=document.getElementsByClassName("wux-layouts-gridengine-poolcontainer-rel")[1].offsetHeight,s=document.getElementsByClassName("Route-tile-blank-space")[0];s&&(s.style.height=`calc(100% - ${n}px)`),document.querySelector(".right-container")&&"0px"==document.querySelector(".right-container").getStyle("width")&&widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:t})},O=function(e){var t=s.getLoginUser();if(e)(E(!0),D(),C(),new Promise((function(e,t){d.fetchAllRoutes().then((t=>{E(!1);var o=a.getModel();o.prepareUpdate(),o.removeRoots(),o.pushUpdate();let i=document.querySelector(".widget-container");null!=i&&(0==t.length?l.showEmptyRoutePlaceholder(i,o):l.hideEmptyRoutePlaceholder(i)),a.appendAllRows(t),H(),e(t)}),(e=>{_dataGridView.removeModalLoader()}))}))).then((e=>{let t=a.getModel(),o=t.getFilterManager();["label","Name","Maturity_State","BasePurposeNLS","Activity_StateNLS","Description","revisionValue","AssigneesDiv","Owner"].forEach((function(e){o.reapplyPropertyFilterModel(e)})),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:t}),widget.routeMgmtMediator.publish("route-tag-data-updated");let i=document.getElementsByClassName("wux-layouts-gridengine-poolcontainer-rel")[1].offsetHeight,n=document.getElementsByClassName("Route-tile-blank-space")[0];n&&(n.style.height=`calc(100% - ${i}px)`)}),(e=>{v(e)}));else{var o=U(),i=a.getModel();let e=i.getSelectedNodes();i.prepareUpdate(),c.optimizedForEach(i.getChildren(),(function(e){(o.indexOf("assigned")>=0&&o.indexOf("owned")>=0||o.indexOf("owned")>=0&&e.options.grid.ownerFilter==t||o.indexOf("assigned")>=0&&e.options.grid.Assignees&&e.options.grid.Assignees.toString().indexOf("Person~"+t+"~")>=0)&&o.indexOf(e.options.grid.actualState)>=0?e.show():e.hide()}));var n=0;i.getChildren().forEach((e=>{e._isHidden&&n++})),i.pushUpdate();var r=[];i.__visibilityMap__&&i.__visibilityMap__.forEach(((e,t)=>{!1===e&&r.push(t.options.id)})),e&&1==e.length&&(e[0]._isHidden||r.includes(e[0]._options.id))&&F(),(0==e.length||document.querySelector(".right-container")&&"0px"==document.querySelector(".right-container").getStyle("width"))&&widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:i});let s=document.querySelector(".widget-container");null!=s&&(i.getChildren().length==n?l.showEmptyRoutePlaceholder(s,i):l.hideEmptyRoutePlaceholder(s)),widget.routeMgmtMediator.publish("route-tag-data-updated")}m.refreshRightPanel("Route",a)},I=function(o){let i=k(),n=T();"routes"===widget.getValue("HomePage")&&(null==widget.getValue("openedRouteId")&&null==a.getOpenedRouteModel()||(widget.routeMgmtMediator.publish("route-back-to-summary"),widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"),widget.setValue("openedRouteId",void 0)));let s=e.getGridViewToolbar().getNodeModelByID("filter");if(s&&(s=s.options.grid.data.menu,widget.setValue("routefilters",["owned","assigned","Define","In Process","Complete","filterbyobject"]),s.forEach((function(e){"unselected"==e.state&&(e.state="selected")}))),"Route"==n){let e=t.getIdsForServicePayload(i);return E(!0),new Promise((function(t,i){d.fetchRouteByIds(e).then((e=>{E(!1);var i=a.getModel();i.prepareUpdate(),i.removeRoots(),i.pushUpdate();let n=document.querySelector(".widget-container");null!=n&&(0==e.length?l.showEmptyRoutePlaceholder(n,i):l.hideEmptyRoutePlaceholder(n)),a.appendAllRows(e),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:a.getModel()}),widget.routeMgmtMediator.publish("route-tag-data-updated"),H(),R(),null!=widget.data.linkedContextTitle&&""!=widget.data.linkedContextTitle&&"summary-onchange"!=o&&widget.routeMgmtMediator.publish("load-filterbyobject-search"),t(e)}),(e=>{_dataGridView.removeModalLoader(),i()}))}))}if("Inbox Task"==n)return E(!0),new Promise((function(e,t){u.getRouteIdByTask(i[0]).then((t=>{widget.data.contentId=t,d.fetchRouteById(t).then((t=>{D(),C(),E(!1);var i=a.getModel();i.prepareUpdate(),i.removeRoots(),i.pushUpdate(),E(!1);let n=document.querySelector(".widget-container");null!=n&&(0==t.length?l.showEmptyRoutePlaceholder(n,i):l.hideEmptyRoutePlaceholder(n)),a.appendAllRows(t),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:a.getModel()}),null!=widget.data.linkedContextTitle&&""!=widget.data.linkedContextTitle&&"summary-onchange"!=o&&widget.routeMgmtMediator.publish("load-filterbyobject-search"),H(),R(),e(t)}),(e=>{v(e)}))}),(e=>{v(e)}))}));{let e=t.getIdsForServicePayload(i);return new Promise((function(o,i){d.fetchApprovalStatusForContent(e).then((e=>{let o=e.data[0].relateddata.route;var i=[];let n;for(var s=0;s<o.length;s++){var r={};r.id=o[s].dataelements.id,i.push(r)}return n=t.getIdsForServicePayload(i),new Promise((function(e,t){d.fetchRouteByIds(n).then((t=>{D(),C(),E(!1);var o=a.getModel();o.prepareUpdate(),o.removeRoots(),o.pushUpdate();let i=document.querySelector(".widget-container");null!=i&&(0==t.length?l.showEmptyRoutePlaceholder(i,o):l.hideEmptyRoutePlaceholder(i)),a.appendAllRows(t),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:a.getModel()}),widget.routeMgmtMediator.publish("route-tag-data-updated"),H(),R(),e(t)}),(e=>{_dataGridView.removeModalLoader()}))}))}),(e=>{widget.routeWebAppNotify.handler().addNotif({level:"error",subtitle:f.errorMessage,sticky:!0}),o()}))}))}},N=function(e,t){var o=[];g.getSearchResult(e,t).then((t=>{if(t.results)for(var i=0;i<t.results.length;i++)o.push(t.results[i].attributes[0].value);A(o),t.infos&&t.infos.nmatches>1e3&&g.getSearchResult(e,o)}))},U=function(){var e=widget.getValue("routefilters");return S()?(widget.setValue("routefilters",["owned","assigned","Define","In Process","Complete"]),["owned","assigned","Define","In Process","Complete"]):null==e?(widget.setValue("routefilters",["owned","assigned","Define","In Process"]),["owned","assigned","Define","In Process"]):e},_=function(e){var t=g.setTaggerProxy("Route");t.addEvent("onFilterChange",(function(e){var t=W(),o=g.getSearchWithInTypedValue(),i=g.getTaggerVariable().getCurrentFilter();t.length>1e3&&null==o&&(t=t.slice(0,1e3)),N(i.allfilters,t)}));var o=t.getCurrentFilter().allfilters;if(0==e.length)g.setTagsForSummaryPage([]);else{e.length>1e3&&(e=e.slice(0,1e3));var i=g.getSearchWithInTypedValue(),n=[];g.getSearchResult(o,e).then((e=>{if(e.results)for(var o=0;o<e.results.length;o++)n.push(e.results[o].attributes[0].value);(null!=i||Object.keys(t.getCurrentFilter().allfilters).length>0)&&A(n)}))}},F=function(){widget.routeMgmtMediator.publish("route-back-to-summary"),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:a.getModel()}),widget.setValue("openedRouteId",void 0)},P=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid?2==e.multipleHitCount?(t.nodeModel.select(!0),widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:t.nodeModel.options.grid})):e.ctrlKey||e.shiftKey||m.refreshRightPanel("Route",a,t.nodeModel.options.grid):m.refreshRightPanel("Route",a)},x=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.multipleHitCount&&(t.nodeModel.select(!0),widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:t.nodeModel.options.grid}))},V=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&(require(["DS/ENORouteMgmt/Views/Menu/RouteContextualMenu"],(function(o){o.routeGridRightClick(e,t.nodeModel.options.grid)})),m.refreshRightPanel("Route",a,t.nodeModel.options.grid))},W=function(){var e=a.getModel(),t=[];return e.getChildren().forEach((e=>{t.push(e.options.id)})),t},L=function(e,t){m.refreshRightPanel("Route",a)},j=function(e,t){m.refreshRightPanel("Route",a),widget.setValue("right-panel-peristed-id",void 0)},B=function(){let e=o.dataGridView();e.addEventListener(p.POINTERHIT,P),e.addEventListener("contextmenu",V),i.tileView().addEventListener(p.POINTERHIT,x),e.getTreeDocument().getXSO().onAdd(L),e.getTreeDocument().getXSO().onRemove(j),G()},G=function(){q();let t=widget.routeMgmtMediator.subscribe("route-summary-append-rows",(function(t){let o=a.appendRows(t.model,t.openRoute);e.getDataGridInstance().ensureNodeModelVisible(o,!0),o.select(),m.refreshRightPanel("Route",a)}));h.push(t),t=widget.routeMgmtMediator.subscribe("route-summary-show-message",(function(e){widget.notify.handler().addNotif(e.message)})),h.push(t),t=widget.routeMgmtMediator.subscribe("route-template-RouteDataGrid-on-drop",(function(e){require(["DS/ENORouteTemplateMgmt/Views/TemplateSummaryView"],(function(t){t.onSummaryPageDblClick(e)}))})),h.push(t),t=widget.routeMgmtMediator.subscribe("route-summary-delete-rows",(function(e){a.deleteRowModelByIndex(e),m.refreshRightPanel("Route",a),widget.routeMgmtMediator.publish("route-tag-data-updated")})),h.push(t),t=widget.routeMgmtMediator.subscribe("route-summary-delete-row-by-ids",(function(e){e.model.length>0&&a.deleteRowModelByIds(e.model),m.refreshRightPanel("Route",a),widget.routeMgmtMediator.publish("route-tag-data-updated")})),h.push(t),t=widget.routeMgmtMediator.subscribe("route-summary-delete-selected-rows",(function(){a.deleteRowModelSelected(),m.refreshRightPanel("Route",a),widget.routeMgmtMediator.publish("route-tag-data-updated")})),h.push(t),t=widget.routeMgmtMediator.subscribe("route-data-updated",(function(e){a.updateRow(e),O()})),h.push(t),t=widget.routeMgmtMediator.subscribe("route-data-linkWidget-published",(function(){I()})),h.push(t),t=widget.routeMgmtMediator.subscribe("route-RefreshData-linkWidget-published",(function(e){J(e)})),h.push(t),t=widget.routeMgmtMediator.subscribe("route-summary-refresh",(function(){O()})),h.push(t),t=widget.routeMgmtMediator.subscribe("route-tag-data-updated",(function(e){var t=W(),o=g.getTaggerVariable(),i=o.getCurrentFilter();t.length>1e3&&(t=t.slice(0,1e3)),t.length>0?N(i.allfilters,t):g.setTagsForSummaryPage([]),o.activate()})),h.push(t),t=widget.routeMgmtMediator.subscribe("route-deactivate-tag-data",(function(e){var t=g.getTaggerVariable();t&&t.deactivate()})),h.push(t),t=widget.routeMgmtMediator.subscribe("route-search-within-data",(function(e){var t=W(),o=g.getTaggerVariable().getCurrentFilter();N(o.allfilters,t)})),h.push(t),t=widget.routeMgmtMediator.subscribe("route-reset-search-within-data",(function(e){var t=W(),o=g.getTaggerVariable().getCurrentFilter();t.length>1e3&&(t=t.slice(0,1e3)),N(o.allfilters,t)})),h.push(t),t=widget.routeMgmtMediator.subscribe("filter-by-object-resize",(function(){setTimeout((()=>{try{if(widget.getValue("routefilters").indexOf("filterbyobject")>-1&&"routes"==widget.getValue("HomePage")){let t=e.getGridViewToolbar().getContent(),o=t.getDocument(),i=o.querySelector("#routes-main-div #dataGridDivToolbar"),n=o.getElementById("contextObjectSearch"),s=1==t.hasAttribute("touch-mode")?"85px":"60px";if(null!=n&&null!=i&&i.clientWidth>0){let e=i.getChildren()[0].getElementsByClassName("wux-controls-toolbar-farContainer")[0];i.clientWidth<420?(n.inject(i),n.style.width="100%",i.style.height=s):(e.insertBefore(n,e.children[0]),n.style.width="250px",i.style.height="41px")}}}catch(e){}}),300)})),h.push(t)},q=function(){h.forEach(((e,t)=>{widget.routeMgmtMediator.unsubscribe(e)})),h=[]},H=function(){let e=S(),t=k();if(!e&&widget.getValue("openedRouteId")&&(e=widget.getValue("openedRouteId"),widget.setValue("openedRouteId",void 0)),null==e&&(e=widget.getValue("routeIdToBePersisted")),e){y();let t=a.getRowModelById(e);t?(t.select(!0),widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:t.options.grid})):F()}else t&&y()},z=function(e,t){d.fetchRouteByIds(e).then((e=>{let o=w(e);D(),C(),t(o)}),(e=>{v(e)}))},J=function(e){d.fetchRouteById(e.routeId).then((e=>{widget.routeMgmtMediator.publish("route-data-updated",e[0]),widget.routeMgmtMediator.publish("redraw-graph",e[0])}),(e=>{}))};return{build:()=>function(){let e=S(),o=k(),i=T();if(e)return"Inbox Task"==widget.data.contentType?new Promise((function(t,o){u.getRouteIdByTask(e).then((e=>{widget.data.contentId=e,d.fetchRouteById(e).then((e=>{let o=w(e);t(o)}),(e=>{v(e)}))}),(e=>{v(e)}))})):new Promise((function(t,o){d.fetchRouteById(e).then((e=>{let o=w(e);t(o)}),(e=>{v(e)}))}));if(o){if("Route"==i){let e=t.getIdsForServicePayload(o);return new Promise((function(t,o){z(e,t)}))}{let e=t.getIdsForServicePayload(o);return new Promise((function(t,o){d.fetchApprovalStatusForContent(e).then((e=>{let o=e.data[0].relateddata.route;var i=[];let n;for(var s=0;s<o.length;s++){var a={};a.id=o[s].dataelements.id,i.push(a)}n={data:i},z(n,t)}),(e=>{widget.routeWebAppNotify.handler().addNotif({level:"error",subtitle:f.errorMessage,sticky:!0}),t()}))}))}}return D(),C(),new Promise((function(e,t){d.fetchAllRoutes().then((t=>{a.destroy();let o=w(t);e(o)}),(e=>{v(e)}))}))}(),getFilterPreferences:()=>U(),updateFilterPreferences:(e,t)=>function(e,t){var o=[...widget.getValue("routefilters")];const i=o.indexOf(e);t?i<=-1&&o.push(e):i>-1&&o.splice(i,1),widget.setValue("routefilters",o)}(e,t),destroyAndRedrawwithFilters:()=>{O(!0)},destroy:()=>{a.destroy(),e.destroy(),n.destroy(),q()},backToRouteSummary:()=>F(),getModel:()=>getSummaryModel(),openSelected:()=>H(),activateInfoIcon:()=>{m.activateInfoIcon(e)},inActivateInfoIcon:()=>{m.inActivateInfoIcon(e)},loadSubscribedData:e=>{I(e)}}})),define("DS/ENORouteMgmt/Views/RightPanelSplitView",["DS/ENORouteMgmt/Components/Wrappers/SplitViewWrapper","DS/ENORouteMgmt/Views/RightPanelInfoView","DS/ENORouteMgmt/Utilities/IdCardUtil"],(function(e,t,o){"use strict";var i=function(){};return i.prototype.getSplitView=function(t){var o=new e,i={modelEvents:t,withtransition:!1,withoverflowhidden:!1,params:{leftWidth:65,rightWidth:75,leftMinWidth:25,leftVisible:!0,rightVisible:!1},rightMaximizer:!1,leftMaximizer:!1,resizable:!0};return o.init(i),o},i.prototype.setSplitviewEvents=function(e){var i=e;let n=i.getRightViewWrapper(),s=new t(n);widget.routeMgmtMediator.subscribe("route-header-info-click",(function(e){widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"),o.infoIconActive(),s.init(e,"routeInfo"),i._showSide("right"),widget.propWidgetOpen=!0})),widget.routeMgmtMediator.subscribe("route-info-close-click",(function(e){i._rightVisible&&(o.infoIconInActive(),i._hideSide("right"),widget.propWidgetOpen=!1)})),widget.routeMgmtMediator.subscribe("route-task-open-click-view-mode",(function(e){o.infoIconInActive(),s.init(e,"taskActionMode"),widget.propWidgetOpen=!1,i._showSide("right")})),widget.routeMgmtMediator.subscribe("route-task-open-click-edit-mode",(function(e){o.infoIconInActive(),s.init(e,"taskEditMode"),widget.propWidgetOpen=!1,i._showSide("right")})),widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",(function(e){i._rightVisible&&i._hideSide("right")})),widget.routeMgmtMediator.subscribe("route-task-close-click-edit-mode",(function(e){i._rightVisible&&i._hideSide("right")})),widget.routeMgmtMediator.subscribe("route-content-preview-click",(function(e){o.infoIconInActive(),widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"),s.init(e,"contentPreview"),widget.propWidgetOpen=!1,widget.contentPreviewId=e.model.id,i._showSide("right")})),widget.routeMgmtMediator.subscribe("route-content-preview-delete",(function(e){i._rightVisible&&e.model.ids.includes(widget.contentPreviewId)&&i._hideSide("right")})),widget.routeMgmtMediator.subscribe("route-content-preview-close",(function(e){i._rightVisible&&i._hideSide("right")}))},i})),define("DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",["DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView","DS/ENORouteMgmt/Views/RouteSummaryView","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/Controls/Button","DS/ENORouteMgmt/Views/Loader/RouteContextObjectChooser","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","DS/ENORouteMgmt/Utilities/EnoWidgetDataUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d){"use strict";var u=Object.create(null);u.currentView="Grid",u.previousView="Grid";var c=function(o,i){if(null!=widget.data.contextTitle&&""!=widget.data.contextTitle){widget.data.contextTitle="";widget.routeMgmtMediator.publish("welcome-panel-action-selected",{id:"routes"})}var n=e.getGridViewToolbar().getNodeModelByID("filter"),s=!0;if("filterbyobject"==o.type&&("selected"==n.options.grid.data.menu[6].state&&"selected"!=o.state?(n.options.grid.data.menu[6].state="unselected",s=!1):n.options.grid.data.menu[6].state="selected",t.updateFilterPreferences(o.filter,s)),"owner"==o.type)"owned"==o.filter?"selected"==n.options.grid.data.menu[0].state?(n.options.grid.data.menu[0].state="unselected",s=!1):n.options.grid.data.menu[0].state="selected":"assigned"==o.filter&&("selected"==n.options.grid.data.menu[1].state?(n.options.grid.data.menu[1].state="unselected",s=!1):n.options.grid.data.menu[1].state="selected"),t.updateFilterPreferences(o.filter,s),t.destroyAndRedrawwithFilters(),n&&"list-ok"!=n.options.grid.semantics.icon.iconName&&n.updateOptions({label:"list-ok"});else if("state"==o.type){n=e.getGridViewToolbar().getNodeModelByID("filter"),s=!0;"completed"==o.filter?("selected"==n.options.grid.data.menu[5].state?(n.options.grid.data.menu[5].state="unselected",s=!1):n.options.grid.data.menu[5].state="selected",o.filter="Complete"):"todo"==o.filter?("selected"==n.options.grid.data.menu[4].state?(n.options.grid.data.menu[4].state="unselected",s=!1):n.options.grid.data.menu[4].state="selected",o.filter="In Process"):"draft"==o.filter&&("selected"==n.options.grid.data.menu[3].state?(n.options.grid.data.menu[3].state="unselected",s=!1):n.options.grid.data.menu[3].state="selected",o.filter="Define"),t.updateFilterPreferences(o.filter,s),t.destroyAndRedrawwithFilters(),n&&"list-delete"!=n.options.grid.semantics.icon.iconName&&n.updateOptions({label:"list-delete"})}"filterbyobject"!=o.type&&widget.getValue("routefilters").indexOf("filterbyobject")>-1&&(widget.setValue("linkedContextTitle",void 0),widget.setValue("compassDataForContext",null),widget.setValue("isWidgetRefreshed","true"),g())},p="",m="";let g=function(t){var o=widget.data.linkedContextTitle;null==t&&(t={type:"filterbyobject",state:"selected",filter:"filterbyobject"}),c(t);var r=e.getGridViewToolbar().getContent().getDocument(),u=r.getElementById("contextObjectSearch");null!=u&&u.remove(),u=UWA.createElement("div",{class:"filter-context",id:"contextObjectSearch"});let g=new s({displayStyle:"lite",label:"lite displayStyle",icon:{iconName:"search",fontIconFamily:WUXManagedFontIcons.Font3DS},showLabelFlag:!1});var h={isMultiSearchMode:!1};h.placeHolderValue=d.searchForRouteContent,h.minLengthToType=3,h.isFreeInputAllowed=!1,h.toKeepSearchResultsFlag=!1;var w=l.getRouteContentSearchTypes(),v=w?w.split(","):"";if(h.getPrecond=function(){var e={};return e.precond=n.getPrecondForContextSearch("is_95_rel_95_objectroute",v),e},m=i.drawAutoCompleteComponent(h),o&&(p=o,m.value=o),m.addEventListener("change",(function(e){a.filterByObjectOnChange(e),p=widget.data.linkedContextTitle})),m.inject(u),g.inject(u),g.getContent().addEventListener("buttonclick",(function(e){a.init(e,m)})),f(r,u),"unselected"==e.getGridViewToolbar().getNodeModelByID("filter").options.grid.data.menu[6].state){null!=p&&""!=p&&(a.loadSelectedContextRoutes(),p=""),u.empty(),e.getGridViewToolbar().getContent().parentElement.setStyle("height","41px")}},f=function(e,t){if(widget.getValue("routefilters").indexOf("filterbyobject")>-1){let i=null==e.getElementById("contextObjectSearch")?t:e.getElementById("contextObjectSearch"),n=e.querySelector("#routes-main-div #dataGridDivToolbar");if(null!=n&&n.getChildren().length>0){var o=n.getChildren()[0].getElementsByClassName("wux-controls-toolbar-farContainer")[0];let e=i,t=e.parentElement;null!=o&&(null!=t&&t.contains(e)&&(e=t.removeChild(e)),o.insertBefore(e,o.children[0]))}}widget.routeMgmtMediator.publish("filter-by-object-resize")};return{changeOwnerFilter:e=>function(e){c(e)}(e),changeStateFilter:e=>function(e){c(e)}(e),openPropertiesView:e=>function(e){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Properties"});let t=o.getSelectedRowsModel();if(1==t.data.length){let e=t.data[0].options.grid;t.model=e}widget.getValue("propWidgetOpen")?widget.routeMgmtMediator.publish("route-info-close-click",{info:"Route"}):widget.routeMgmtMediator.publish("route-header-info-click",{model:t.model,info:"Route"})}(),renderObjectContextTitle:e=>g(e)}})),define("DS/ENORouteMgmt/Views/Panels/WelcomePanel",["DS/Controls/Abstract","DS/ENORouteMgmt/Utilities/Constants","DS/ENORouteMgmt/Config/WelcomePanelActionsConfig","DS/ENORouteMgmt/Utilities/DataFormatter","DS/Controls/ProgressBar","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Utilities/Utils","DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l,d){"use strict";let u,c,p=!0;return e.extend({activities:[{id:"list",title:d.AccessYourWork,actions:[{id:t.WELCOMEPANEL_ID_ROUTES,text:d.routes,className:"wcpanel-routes",fonticon:"route",isDefault:void 0===widget.getValue("HomePage")||"routes"===widget.getValue("HomePage")},{id:t.WELCOMEPANEL_ID_ROUTE_TEMPLATES,text:d.templates,className:"wcpanel-routes-templates",fonticon:"template",isDefault:"route_templates"===widget.getValue("HomePage")}]},{id:"creation",title:d.StartNewActivity,actions:[{id:t.WELCOMEPANEL_ID_CREATE_ROUTE,text:d.newRoute,fonticon:"plus",className:"action-new",isNotHighlightable:"true"},{id:t.WELCOMEPANEL_ID_CREATE_ROUTE_TEMPLATE,text:d.newRouteTemplate,fonticon:"template-add",className:"action-new",isNotHighlightable:"true"}]}],init:function(e){this.wPanelOptions={collapsed:!1,title:d.AppHeader,subtitle:"",activities:this.activities,parentContainer:e.leftContainer,selectedItem:t.WELCOMEPANEL_ID_ROUTES,withTogglableButton:!0,modelEvents:e.modelEvents};let i=o.routes,n=o.route_templates;require([i.loader.module],(function(e){u=e})),require([n.loader.module],(function(e){c=e}))},getWPanelOptions:function(){return this.wPanelOptions},registerEvents:function(){let e=this;widget.routeMgmtMediator.subscribe("welcome-panel-action-selected",(function(t){if(p){"routes"==t.id&&null!=widget.data.contextTitle&&""!=widget.data.contextTitle?widget.data.contextTitle="":"routes"==t.id&&null!=widget.data.linkedContextTitle&&""!=widget.data.linkedContextTitle&&(widget.setValue("linkedContextTitle",void 0),widget.setValue("compassDataForContext",null),widget.setValue("isWidgetRefreshed","true")),p=!1;let i=o[t.id],n={};"routes"==i.id?n.value="Routes":"route_templates"==i.id?n.value="Templates":"new_route"==i.id?n.value="New Route":"new_route_template"==i.id&&(n.value="New Template"),n.event="WelcomePanel",l.sendRouteTrackerEvent(n),"summary_page"==i.content?(widget.setValue("HomePage",i.id),widget.routeMgmtMediator.publish("route-welcome-panel-activity-selection",{id:i.id}),a.clearSummaryPage(),e.showProgressBar(),document.querySelector(".widget-container"),e.loadSummaryPages(i)):(widget.setValue("isDialogOpened",!0),e.loadDialogPages(i))}})),widget.routeMgmtMediator.subscribe("load-filterbyobject-search",(function(e){setTimeout((()=>{r.renderObjectContextTitle(e)}),200)})),widget.routeMgmtMediator.subscribe("welcome-panel-load-subscribed-data",(function(t){if(p){p=!1;let i=o[t.id];"summary_page"==i.content&&(widget.setValue("HomePage",i.id),widget.routeMgmtMediator.publish("route-welcome-panel-activity-selection",{id:i.id}),a.clearSummaryPage(),e.showProgressBar(),document.querySelector(".widget-container"),widget.routeMgmtMediator.publish("template-back-to-summary"),widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"),"routes"===i.id&&u[i.loader.func]().then((function(t){e.hideProgressBar(),p=!0,e.activateInfoIcon(u)})))}})),widget.routeMgmtMediator.subscribe("welcome_note_icon_event",(function(e){console.log(e)})),widget.routeMgmtMediator.subscribe("welcome-panel-toggle",(function(e){console.log(e)})),widget.routeMgmtMediator.subscribe("welcome-panel-collapse",(function(e){console.log(e)})),widget.routeMgmtMediator.subscribe("welcome-panel-expand",(function(e){console.log(e)})),widget.routeMgmtMediator.subscribe("refresh-homepage-after-route-created",(function(t){var i=document.querySelector("#RouteImmersiveFrame .wux-controls-checkbox > div.wux-toggle-icon-placeholder");if(null!=widget.data.contextTitle&&""!=widget.data.contextTitle){if(null!=i&&i.hasClassName("wux-ui-fa-check")){t={id:"routes"};widget.routeMgmtMediator.publish("welcome-panel-action-selected",t)}}else if(null!=i&&i.hasClassName("wux-ui-fa-check")&&null!=widget.data.linkedContextTitle&&""!=widget.data.linkedContextTitle){widget.setValue("linkedContextTitle",void 0),widget.setValue("compassDataForContext",null);t={id:"routes"};widget.routeMgmtMediator.publish("welcome-panel-action-selected",t)}if("route_templates"===widget.getValue("HomePage")){a.clearSummaryPage();let i=o.routes;e.loadSummaryPageAndOpenSelected(i,t.model,t.openRoute),widget.routeMgmtMediator.publish("route-welcome-panel-activity-selection",{id:"routes"})}})),widget.routeMgmtMediator.subscribe("refresh-homepage-after-template-created",(function(t){if(void 0===widget.getValue("HomePage")||"routes"===widget.getValue("HomePage")){a.clearSummaryPage();let i=o.route_templates;e.loadSummaryPageAndOpenSelected(i,t),widget.routeMgmtMediator.publish("route-welcome-panel-activity-selection",{id:"route_templates"})}}))},loadDialogPages:function(e){require([e.loader.module],(function(t){t[e.loader.func](),p=!0,widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode")}))},loadSummaryPages:function(e){let t=this,o="Route";"routes"===e.id?u[e.loader.func]().then((function(e){let o=widget.getValue("routefilters");o&&o.indexOf("filterbyobject")>-1&&widget.routeMgmtMediator.publish("load-filterbyobject-search"),t.hideProgressBar(),p=!0,widget.routeMgmtMediator.publish("route-back-to-summary"),t.activateInfoIcon(u);var i=document.querySelector("#dataGridDivToolbar .wux-controls-lineeditor .wux-controls-lineeditor-clearbutton");i&&i.addEventListener("click",(function(){if(null!=widget.data.contextTitle&&""!=widget.data.contextTitle){widget.data.contextTitle="";var e={id:"routes"};widget.routeMgmtMediator.publish("welcome-panel-action-selected",e)}else{widget.setValue("linkedContextTitle",void 0);e={id:"routes"};widget.routeMgmtMediator.publish("welcome-panel-action-selected",e)}}))})):"route_templates"===e.id&&(o="Route Template",c[e.loader.func]().then((function(e){t.hideProgressBar(),p=!0,widget.routeMgmtMediator.publish("template-back-to-summary"),t.activateInfoIcon(c)}))),widget.getValue("propWidgetOpen")&&widget.routeMgmtMediator.publish("route-header-info-click",{info:o}),widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode")},loadSummaryPageAndOpenSelected:function(e,t,o){require([e.loader.module],(function(n){"routes"===e.id?u[e.loader.func]().then((function(e){let n=s.getRowModelById(t.id);n&&n.select(!0),0==o||widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:i.gridData(t)})})):"route_templates"===e.id&&c[e.loader.func]().then((function(e){widget.routeMgmtMediator.publish("initialize-IDCard-on-dblClick",{model:i.templateGridData(t.data)})}))}))},showProgressBar:function(){let e=document.querySelector(".widget-container");this.progressbar7=new n({shape:"circular",infiniteFlag:!0,emphasize:"info",statusFlag:!1,height:60}),this.progressbar7.inject(e),this.progressbar7.elements.container.setStyle("margin-left","40%"),this.progressbar7.elements.container.setStyle("margin-top","20%")},hideProgressBar:function(){this.progressbar7.destroy()},activateInfoIcon:function(e){widget.getValue("propWidgetOpen")&&e.activateInfoIcon()}})})),define("DS/ENORouteMgmt/Components/Wrappers/TriptychWrapper",["DS/ENOXTriptych/js/ENOXTriptych","DS/ENORouteMgmt/Views/Panels/WelcomePanel"],(function(e,t){"use strict";var o=function(){};return o.prototype.init=function(o,i,n,s,a){this._left=n,this._main=s,this._right=a,this._applicationChannel=o,this._triptych=new e;let r=widget.getValue("route-right-panel-width"),l={left:{resizable:!0,originalSize:300,minWidth:300,originalState:"open",overMobile:!0,withClose:!1},right:{resizable:!0,minWidth:290,originalSize:null==r?400:r,originalState:"close",overMobile:!0,withClose:!1},borderLeft:!1,container:i,withtransition:!0,modelEvents:this._applicationChannel},d={};d.modelEvents=this._applicationChannel,d.leftContainer=n,this._routesWCPanel=new t(d);let u=this._routesWCPanel.getWPanelOptions();this._routesWCPanel.registerEvents(),this._triptych.init(l,n,s,a,u),this._right.addEvent("resize",(function(){let e=this.clientWidth;widget.setValue("route-right-panel-width",e)})),this.registerRouteEvents()},o.prototype.inject=function(e){this._triptych.inject(e)},o.prototype._getTriptych=function(){return this._triptych},o.prototype.getLeftPanelContainer=function(){return this._left},o.prototype.getLeftPanelContainerTriptych=function(){return this._triptych._leftPanelContent},o.prototype.getRightPanelContainer=function(){return this._right},o.prototype.getMainPanelContainer=function(){return this._main},o.prototype.registerRouteEvents=function(){let e=this;widget.routeMgmtMediator.subscribe("route-welcome-panel-activity-selection",(function(t){e._routesWCPanel.wPanelOptions.parentContainer.getElements(".activity-btn.selected").forEach((e=>{e.removeClassName("selected")})),t.id&&(e._routesWCPanel.wPanelOptions.parentContainer.getElement(".activity-btn#"+t.id).addClassName("selected"),e._routesWCPanel.wPanelOptions.selectedItem=t.id)}))},o})),define("DS/ENORouteMgmt/Views/RouteHomeSplitView",["DS/ENORouteMgmt/Components/Wrappers/SplitViewWrapper","DS/ENORouteMgmt/Views/RouteIDCardView","DS/ENORouteMgmt/Views/RightPanelSplitView","DS/ENORouteMgmt/Utilities/IdCardUtil"],(function(e,t,o,i){"use strict";var n,s=function(){};return s.prototype.getSplitView=function(t){var o={modelEvents:t,withtransition:!1,withoverflowhidden:!1,params:{leftWidth:25,rightWidth:75,leftMinWidth:25,leftVisible:!0,rightVisible:!1},rightMaximizer:!1,leftMaximizer:!1,resizable:!0};return(n=new e).init(o),n},s.prototype.setSplitviewEvents=function(e){var o=e;let n=o.getRightViewWrapper();widget.routeMgmtMediator.subscribe("route-DataGrid-on-dblclick",(function(e){widget.routeMgmtMediator.publish("route-deactivate-tag-data"),o.getRightViewWrapper().innerHTML="",new t(n).init(e),o._showSide("right"),o._hideLeft(),i.collapseIcon(),widget.getValue("propWidgetOpen")?i.infoIconActive():(widget.routeMgmtMediator.publish("route-task-close-click-view-mode",{model:e.model}),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode",{model:e.model})),widget.routeMgmtMediator.publish("route-widgetTitle-update-withName",{model:e.model})})),widget.routeMgmtMediator.subscribe("route-template-DataGrid-on-dblclick",(function(e){widget.routeMgmtMediator.publish("template-deactivate-tag-data"),o._showSide("right"),o._hideLeft(),widget.getValue("propWidgetOpen")?i.infoIconActive():(widget.routeMgmtMediator.publish("route-task-close-click-view-mode",{model:e.model}),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode",{model:e.model})),widget.routeMgmtMediator.publish("route-widgetTitle-update-withName",{model:e.model})})),widget.routeMgmtMediator.subscribe("route-back-to-summary",(function(e){widget.routeMgmtMediator.publish("route-triptych-show-toggle-button"),o._leftVisible||o._showSide("left"),o._rightVisible&&o._hideSide("right")})),widget.routeMgmtMediator.subscribe("template-back-to-summary",(function(e){widget.routeMgmtMediator.publish("route-triptych-show-toggle-button"),o._leftVisible||o._showSide("left"),o._rightVisible&&o._hideSide("right")}))},s.prototype.getExistingHomeSplitView=function(){return n},s.prototype.getExistingRightViewWrapper=function(){return n.getRightViewWrapper()},s})),define("DS/ENORouteMgmt/Components/RouteApplicationFrame",["DS/Core/Core","DS/ENORouteMgmt/Components/Wrappers/TriptychWrapper","DS/ENORouteMgmt/Utilities/Constants","DS/ENORouteMgmt/Utilities/IdCardUtil","DS/ENORouteMgmt/Views/RightPanelInfoView","DS/ENORouteMgmt/Views/RouteSummaryView","DS/Controls/TooltipModel","DS/ENORouteMgmt/Utilities/RouteViewUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],(function(e,t,o,i,n,s,a,r,l){"use strict";var d,u=function(){};return u.prototype.init=function(e,t,o,i,n,s){this._applicationChannel=widget.routeMgmtMediator.getEventBroker(),this._leftContent=i,this._middleContent=n,this._rightContent=s,this._mainContainer=o,this._initDom(),this._loadTemplateView()},u.prototype._loadTemplateView=function(){require(["DS/ENORouteTemplateMgmt/Views/TemplateSummaryView"],(function(e){d=e}))},u.prototype._initDom=function(){this._content=document.createElement("div"),this._content.classList.add("route-panel"),this._mainContainer.classList.add("route-content"),this._content.appendChild(this._mainContainer),this._triptychWrapper=new t,this._triptychWrapper.init(widget.routeMgmtMediator.getEventBroker(),this._mainContainer,this._leftContent,this._middleContent,this._rightContent),this._middleContainer=document.createElement("div"),this._middleContainer.classList.add("route-content-wrapper"),this._applicationContent=document.createElement("div"),this._applicationContent.classList.add("route-content-wrapper"),this._middleContainer.appendChild(this._applicationContent),this._middleContent&&this._middleContent._container&&this._applicationContent.appendChild(this._middleContent._container),this._subscribeEvents(),this._subscribeRightPanelEvents(),this.__mobileBreakpoint=this._triptychWrapper._triptych.__mobileBreakpoint},u.prototype._subscribeRightPanelEvents=function(){this._listRightPanelSubscription=[];var e=this;let t=new n(e._rightContent);t.destroyEditPropWidget();let o=e._triptychWrapper._getTriptych();e._listRightPanelSubscription.push(e._applicationChannel.subscribe({event:"route-header-info-click"},(function(o){if(e._content.clientWidth<e.__mobileBreakpoint){if(widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"),o&&"Route Template"===o.info)if(null==d){require(["DS/ENORouteTemplateMgmt/Views/TemplateSummaryView"],(function(e){(d=e).activateInfoIcon()}))}else d.activateInfoIcon();else o&&"Route"===o.info&&s.activateInfoIcon();i.infoIconActive(),t.init(o,"routeInfo"),e._applicationChannel.publish({event:"triptych-show-panel",data:"right"}),widget.setValue("propWidgetOpen",!0)}}))),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-info-close-click",(function(t){o._isRightOpen&&(t&&"Route Template"===t.info?d.inActivateInfoIcon():s.inActivateInfoIcon(),i.infoIconInActive(),e._applicationChannel.publish({event:"triptych-hide-panel",data:"right"}),widget.setValue("propWidgetOpen",!1))}))),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-task-open-click-view-mode",(function(o){i.infoIconInActive(),s.inActivateInfoIcon(),d.inActivateInfoIcon(),t.init(o,"taskActionMode"),widget.setValue("propWidgetOpen",!1),e._applicationChannel.publish({event:"triptych-show-panel",data:"right"}),null!=document.querySelector("#InitiateTaskPropertiesContainer")&&r.makeResponsiveCss("routeTaskPanel","#InitiateTaskPropertiesContainer")}))),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-task-open-click-edit-mode",(function(o){i.infoIconInActive(),s.inActivateInfoIcon(),d.inActivateInfoIcon(),t.init(o,"taskEditMode"),widget.setValue("propWidgetOpen",!1),e._applicationChannel.publish({event:"triptych-show-panel",data:"right"}),r.makeResponsiveCss("routeTaskPanel","#InitiateTaskPropertiesContainer")}))),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",(function(t){o._isRightOpen&&!widget.getValue("propWidgetOpen")&&e._applicationChannel.publish({event:"triptych-hide-panel",data:"right"})}))),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-DataGrid-on-dblclick",(function(t){e._isDetailsPageOpened=!0,o._isLeftOpen&&e._applicationChannel.publish({event:"triptych-hide-panel",data:"left"}),widget.routeMgmtMediator.publish("route-triptych-hide-toggle-button")}))),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-template-DataGrid-on-dblclick",(function(t){e._isDetailsPageOpened=!0,o._isLeftOpen&&e._applicationChannel.publish({event:"triptych-hide-panel",data:"left"}),widget.routeMgmtMediator.publish("route-triptych-hide-toggle-button")}))),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-task-close-click-edit-mode",(function(t){o._isRightOpen&&!widget.getValue("propWidgetOpen")&&e._applicationChannel.publish({event:"triptych-hide-panel",data:"right"})}))),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-content-preview-click",(function(o){i.infoIconInActive(),s.inActivateInfoIcon(),d.inActivateInfoIcon(),widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"),t.init(o,"contentPreview"),widget.setValue("propWidgetOpen",!1),widget.contentPreviewId=o.model.id,e._applicationChannel.publish({event:"triptych-show-panel",data:"right"})}))),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-content-preview-delete",(function(t){o._isRightOpen&&t.model.ids.includes(widget.contentPreviewId)&&e._applicationChannel.publish({event:"triptych-hide-panel",data:"right"})}))),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-content-preview-close",(function(t){o._isRightOpen&&e._applicationChannel.publish({event:"triptych-hide-panel",data:"right"})}))),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-back-to-summary",(function(t){e._isDetailsPageOpened=!1}))),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("template-back-to-summary",(function(t){e._isDetailsPageOpened=!1})))},u.prototype._subscribeEvents=function(){this._listSubscription=[];var e=this;widget.body.addEvent("resize",(function(){widget.routeMgmtMediator.publish("filter-by-object-resize")})),e._listSubscription.push(e._applicationChannel.subscribe({event:"triptych-show-panel"},(function(t){e._content.clientWidth<e.__mobileBreakpoint&&e._mainContainer.classList.add("full-height")}))),e._listSubscription.push(e._applicationChannel.subscribe({event:"triptych-panel-hide-started"},(function(t){e._content.clientWidth<e.__mobileBreakpoint&&("left"===t?widget.setValue("propWidgetOpen",!1):widget.data.propWidgetOpen&&("routes"==widget.data.HomePage?s.inActivateInfoIcon():d.inActivateInfoIcon(),(widget.getValue("routeIdToBePersisted")||widget.getValue("templateIdToBePersisted"))&&i.infoIconInActive(),widget.setValue("propWidgetOpen",!1)),e._mainContainer.classList.remove("full-height")),e._applicationChannel.publish({event:"model-conflict-panel-closed"})}))),e._listSubscription.push(e._applicationChannel.subscribe({event:"triptych-entering-mobile"},(function(){e._mainContainer.classList.remove("full-height")}))),e._listSubscription.push(e._applicationChannel.subscribe({event:"triptych-resized"},(function(t){if("right"===t.side)t.width;"left"===t.side&&e._isDetailsPageOpened&&e._applicationChannel.publish({event:"triptych-hide-panel",data:"left"}),widget.routeMgmtMediator.publish("filter-by-object-resize")}))),e._listSubscription.push(e._applicationChannel.subscribe({event:"triptych-leaving-mobile"},(function(){e._mainContainer.classList.remove("full-height")}))),e._listSubscription.push(e._applicationChannel.subscribe({event:"route-triptych-hide-toggle-button"},(function(){e._mainContainer.querySelector(".triptych-wp-toggle-btn").classList.add("route-toggle-hide")}))),e._listSubscription.push(e._applicationChannel.subscribe({event:"route-triptych-show-toggle-button"},(function(){e._mainContainer.querySelector(".triptych-wp-toggle-btn").classList.remove("route-toggle-hide"),e._applicationChannel.publish({event:"triptych-show-panel",data:"left"})}))),e._listSubscription.push(e._applicationChannel.subscribe({event:"welcome-panel-collapsed"},(function(){let t=e._mainContainer.querySelector(".triptych-wp-toggle-btn");t&&(t.tooltipInfos=new a({shortHelp:l.homeRightPanelExpand,allowUnsafeHTMLShortHelp:!0}))}))),e._listSubscription.push(e._applicationChannel.subscribe({event:"welcome-panel-expanded"},(function(){let t=e._mainContainer.querySelector(".triptych-wp-toggle-btn");t&&(t.tooltipInfos=new a({shortHelp:l.homeRightPanelCollapse,allowUnsafeHTMLShortHelp:!0}))}))),e._listSubscription.push(e._applicationChannel.subscribe({event:"triptych-clicked-overlay"},(function(t){if("left"==t){let t=e._mainContainer.querySelector(".triptych-wp-toggle-btn");t&&(t.tooltipInfos=new a({shortHelp:l.homeRightPanelExpand,allowUnsafeHTMLShortHelp:!0}))}"right"==t&&(widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"))})))},u.prototype.inject=function(e){e.appendChild(this._content)},u.prototype.destroy=function(){this._content=null},u.prototype.setTooltipForExpandCollapse=function(){let e=this._mainContainer.querySelector(".triptych-wp-toggle-btn");e&&(e.tooltipInfos=new a({shortHelp:l.homeRightPanelCollapse,allowUnsafeHTMLShortHelp:!0}))},u.prototype.showWelcomePanel=function(){this._triptychWrapper._getTriptych()._isLeftOpen||this._applicationChannel.publish({event:"triptych-show-panel",data:"left"}),this._applicationChannel.publish({event:"triptych-set-size",data:{size:300,side:"left"}})},u}));