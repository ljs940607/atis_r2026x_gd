define("DS/E6WCommonApps/Collections/ConstraintsPseudoCollection",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","UWA/Class/Collection"],(function(e,t,n,s,i){"use strict";var o=t.extend(n,s,{_iterateOverWorkscopes:function(e,t){if(e instanceof i)return e.some((e=>this._iterateOverWorkscopes(e,t)));t.call(this,e),e.getWorkscopes().forEach((e=>this._iterateOverWorkscopes(e,t))),e.getReferenceWorkscopes().forEach((e=>this._iterateOverWorkscopes(e,t)))},_onCollectionEvent:function(e,t,n,s,i){if(!this.requestReset){switch(e){case"onReset":var o=this;this.requestReset=window.requestAnimationFrame((function(){delete o.requestReset,o.dispatchEvent(e,[t,o,s])})),this._handleConstraintResetForWorkscope(t,n,i);break;case"onAdd":return void this.add(t,i,s);case"onRemove":return void this.remove(t,i,s)}this.dispatchEvent(e,[t,this,s])}},_handleConstraintResetForWorkscope:function(t,n,s){var i,a,r=[],l=e.is(n.previousModels,"array")?n.previousModels.slice():[];for(t.forEach((function(e){var t=l.indexOf(e);-1===t?r.push(e):l.splice(t,1)})),i=0;i<r.length;i++)a=r[i],this.add(a,s);for(i=0;i<l.length;i++)a=l[i],o.parentProjectIsDisplayed(a)||this.remove(a,s)},_listenToWorkscopeConstraints:function(e){var t=e.getOwnConstraints();this.listenTo(t,"onAnyEvent",(function(t,n,s,i){this._onCollectionEvent(t,n,s,i,e)})),this._addConstraintsFromWorkscope(e)},_startListeningToWorkscope:function(e){this._listenToWorkscopeConstraints(e);var t=e.getWorkscopes(),n={onAdd:this._onAddWorkscope,onReset:this._onResetWorkscope,onRemove:this._onRemoveWorkscope};this.listenTo(t,n),this.listenTo(e.getReferenceWorkscopes(),n)},_stopListeningToWorkscope:function(e){var t=e.getWorkscopes();this.stopListening(t),this.stopListening(e.getOwnConstraints())},_onAddWorkscope:function(e){this._iterateOverWorkscopes(e,this._startListeningToWorkscope),this._iterateOverWorkscopes(e,(function(e){this._addConstraintsFromWorkscope(e)}))},_addConstraintsFromWorkscope:function(e){var t=e.getOwnConstraints(),n=this;t.forEach((function(t){t.dispatchEvent("onAdd",[t,n]),n.add(t,e)}))},_listenToWorkscopeAndAddConstraintsToMap:function(e){if(e instanceof t.Model){this._startListeningToWorkscope(e);var n=this;e.getOwnConstraints().forEach((function(t){n.add(t,e,{silent:!0})}))}},_onResetWorkscope:function(e,t){if(0!==e.length||0!==t.previousModels.length){this._constraintMap.clear(),this._constraintParentMap.clear(),this._constraintIDMap.clear(),this.stopListening();var n=this;this._iterateOverWorkscopes(this.model,(function(e){n._listenToWorkscopeAndAddConstraintsToMap(e)})),this.dispatchEvent("onReset",[this])}},_onRemoveWorkscope:function(e){var t=this;this._iterateOverWorkscopes(e,this._stopListeningToWorkscope),this._iterateOverWorkscopes(e,(function(n){n.getOwnConstraints().forEach((function(n){n.dispatchEvent("onRemove",[n,t]),t.remove(n,e)}))}));var n=e.hasViewAccess()&&e.getParent();n&&n.hasViewAccess()&&n.getOwnConstraints().forEach((function(n){t.add(n,e,{silent:!0})}))},init:function(e){this.model=e,this._constraintMap=new Map,this._constraintIDMap=new Map,this._constraintParentMap=new Map,Object.defineProperty(this,"id",{get:function(){return(this.model.id||this.model.getUri())+":allConstraints"}}),Object.defineProperty(this,"length",{get:function(){return this._constraintMap.size}});var t=this;if(this._iterateOverWorkscopes(this.model,(function(e){t._listenToWorkscopeAndAddConstraintsToMap(e)})),this.model instanceof i){var n={onAdd:this._onAddWorkscope,onRemove:this._onRemoveWorkscope,onReset:this._onResetWorkscope};this.listenTo(this.model,n)}},first:function(){return this.at(0)},get:function(e){return this._constraintIDMap.get(e)||this._constraintIDMap.get(e.id)},add:function(e,t,n){var s=this._constraintParentMap.get(e.cid)?this._constraintParentMap.get(e.cid):new Set,i=0===s.size,o=i&&(!n||!n.silent);s.add(t.id),i&&this._constraintMap.set(e.cid,e),i&&this._constraintParentMap.set(e.cid,s),e.id&&this._constraintIDMap.set(e.id,e),o&&this.dispatchEvent("onAdd",[e,this,n])},remove:function(e,t,n){var s=this._constraintParentMap.get(e.cid);s&&(s.delete(t.id),0===s.size&&this._constraintMap.delete(e.cid),0===s.size&&this._constraintIDMap.delete(e.id),!(0!==s.size||n&&n.silent)&&this.dispatchEvent("onRemove",[e,this,n]))},at:function(e){var t,n=0;if(!(e>this._constraintMap.size-1)){if(this._constraintMap.values){for(var s=this._constraintMap.values(),i=s.next();!i.done&&n<e;)i=s.next(),n++;return i.value}return this._constraintMap.forEach((function(s){n===e&&(t=s),n++})),t}},forEach:function(e,t){var n=0;this._constraintMap.forEach((function(s){e.call(t,s,n),n++}))},destroy:function(){window.cancelAnimationFrame(this.requestReset),this.stopListening(),delete this.model,delete this.requestReset,this._constraintMap.clear(),this._constraintParentMap.clear(),this._constraintIDMap.clear(),delete this._constraintMap,delete this._constraintParentMap,delete this._constraintIDMap},contains:function(e){return Boolean(this._constraintIDMap.get(e.id))}});return o.parentProjectIsDisplayed=function(e){let t=e.getPredecessor(),n=t&&t.hasViewAccess()&&t.getParent();return t&&n&&n.hasViewAccess()&&n.hasDataForMask("dsplan:MVMask.WorkPackage.ScheduleView")},o})),define("DS/E6WCommonApps/Models/Document/CollabspaceDocument",["UWA/Core","UWA/Class"],(function(e,t){"use strict";return t.extend({data:{title:null,fileName:null,file:null,icon:null,id:null,type:null,document:null,fileData:null,serviceId:"3DSpace"},init:function(t,n){var s=e.clone(t||{},!1);this.set("document",s.documents[0]),this.set("fileData",this.get("document").relateddata.files[0]),this._setupDocument(s,n)},_setupDocument:function(t,n){var s=e.clone(t||{},!1);this.set("type",s.type),this.set("title",this.get("document").dataelements.title),this.set("fileName",this.get("fileData").dataelements.title),this.set("file",this._getCurrentFile(n)),this.set("icon",this.get("document").dataelements.image),this.set("id",this.get("document").id),this.set("type",this.get("document").type),this.set("serviceId","3DSpace")},_getCurrentFile:function(e){for(let t=0;t<e.length;t++){const n=e[t];if(n.name.contains(this.get("fileName")))return n}},get:function(e){if(this.data[e])return this.data[e]},set:function(e,t){this.data[e]=t}})})),define("DS/E6WCommonApps/Models/ChildModelMixin",[],(function(){"use strict";return{hasAccessFromParent:function(){let e=this.getParent();if(e&&(e._accessModify||"function"==typeof e.canModify&&e.canModify()))return!0}}})),define("DS/E6WCommonApps/SubscribeUtil",["DS/E6WCommonUI/SubscribeUtilBase","DS/DocumentManagement/DocumentManagement","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s){"use strict";return e.i18n=function(){return s.get.bind(s)},e.getMessage=function(t){var i=t&&e.i18n(t.reason);return t.args&&(i=s.replace(i,n.escapeHTML(t.args))),i},Object.defineProperty(e,"events",{get:function(){return t.events}}),e})),define("DS/E6WCommonApps/Models/AssigneeMixin",["UWA/Core","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager"],(function(e,t,n){"use strict";return{hasPermissionToAssignToSelf:function(){let e=!this.isComplete()&&(this.get("canEdit")||this._isUserACandidateAssigneeOrPartOfUserGroup());return e||(e="TRUE"===this.get("canClaimTask")),e},canAssignToSelf:function(e){return this.hasPermissionToAssignToSelf()&&!this.isAssignedToCurrentUser(e)},isAssignedToCurrentUser:function(n){var s=!1,i=n||this.get(this.ASSIGNEESATTR)||this.get("dsxplan:hasAssignee");if(i)for(var o=0;o<i.length;o++){var a=i.at?i.at(o):i[o],r=a&&e.is(a.get,"function")&&a.get("dsaccess:accountName")||a&&a["dsaccess:accountName"];if(t.isLoggedInUser(r)){s=!0;break}}return s},_isUserACandidateAssigneeOrPartOfUserGroup:function(){if(this._membersChecked)return this._isUserACandidateAssignee;var e=this.get("dsxplan:hasCandidateAssignee"),t=this,s=!1;const i=[];return e&&e.some((function(e){if("pno:Person"===e.getObjectType()){var o=e.get("dsaccess:accountName");i.push(o),i.includes(n.getContextUser())&&(s=!0)}else"foaf:Group"===e.getObjectType()&&(s=e.includesCurrentUser(t));return s})),s}}})),define("DS/E6WCommonApps/SubscriptionUtils",["DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t){"use strict";const n={subscriptionsFetched:{},isUserSubscribedTo:function(t){n.subscriptionsFetched[t.id]||(n.subscriptionsFetched[t.id]=!0,e.request(e.expandUrl("invoke/dsplan:isUserSubscribingNotif"),{method:"POST",type:"json",data:JSON.stringify([t.get("@id")]),onComplete:function(e){t.set("_xplanSubscribed",e["@value"])}}))},toggleUserSubscription:function(n){e.request(e.expandUrl("invoke/dsplan:toggleUserNotifSubscription"),{method:"POST",type:"json",data:JSON.stringify([n.get("@id")]),onComplete:function(e){n.set("_xplanSubscribed",e["@value"]),t.trackPageEvent({eventCategory:"ProjectSubscription",eventAction:"toggleUserSubscription",eventLabel:"Subscribe-Or-Unsubscribe",eventValue:n.get("_xplanSubscribed")})}})}};return n})),define("DS/E6WCommonApps/Models/CalendarModel",["UWA/Core","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/Collections/ResultCollection","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s){"use strict";var i="dsplan:MVMask.Calendar.Basic",o="/classes/dsplan:Calendar",a="dsplan:timezoneOffset",r="dsplan:representativeCities",l=t.extend({_uwaClassName:"CalendarModel",hasViewAccess:function(){return!0},timeOffsetToUTCString:function(){var e,t=this.get(a)/60;return!isNaN(t)||Math.abs(t)>24?(e=t>=0?"UTC+":"UTC",e+=t):(e="Invalid Calendar timeOffset: "+t,console.error("Invalid time offset: "+t)),e},getDateInWorkscopeCalendarTimeZone:function(e){var t=this.get(l.OFFSET_ATTR)+e.getTimezoneOffset();return new Date(e.getTime()+60*t*1e3)},getDropdownDisplayValue:function(){var e,t=this.get(r).replace(/ /g,"").replace(/,/g,"_");return this.timeOffsetToUTCString()+" "+(e="E6WCommonApps.Calendar."+t,s.get(e))}}),d=n.extend({_uwaClassName:"CalendarCollection",comparator:function(e,t){return parseInt(e.get(a))-parseInt(t.get(a))},getUri:function(){return o},getMask:function(){return i}});return l.calendarCollection=new d(void 0,{detailsMask:i,defaultModel:l}),l.fetchCalendars=function(t){var n=e.clone(t||{},!1),s=n.onComplete;n.onComplete=function(){l._calendarsFetched=!0,e.is(s,"function")&&s()},n.reset=!0,l.calendarCollection.fetch(n)},l.haveCalendarsBeenFetched=function(){return Boolean(l._calendarsFetched)},l.getCalendarsForDropdown=function(){var e=[];return l.calendarCollection.forEach((function(t){e.push({actualValue:t.id,displayValue:t.getDropdownDisplayValue&&t.getDropdownDisplayValue()})})),e},l.getCalendarClosestToUserTimeZone=function(){if(!l._closestCalendar){var e=(n=new Date(2018,0,1,0,0,0,0),s=n.toUTCString(),(n-new Date(s.substring(0,s.lastIndexOf(" ")-1)))/36e5),t=25;l.calendarCollection.forEach((function(n){var s=parseInt(n.get(a))/60-e;!isNaN(s)&&Math.abs(s)<t&&(t=Math.abs(s),l._closestCalendar=n)}))}var n,s;return l._closestCalendar},l.OFFSET_ATTR=a,l.CITIES_ATTR=r,l.LOAD_ALL_CALENDARS_URL=o,l})),define("DS/E6WCommonApps/Utils/ForwardEvents",[],(function(){"use strict";var e={forwardEvents:function(e,t){const n={};var s=this;t.forEach((e=>{n[e]=function(){s.dispatchEvent(e,Object.values(arguments))}})),this.listenTo(e,n)}};return e})),define("DS/E6WCommonApps/ColorUtil",[],(function(){"use strict";var e={rgbToHex:function(e){var t=Number(e).toString(16);return t.length<2&&(t="0"+t),t},parseColor:function(e){return{red:Number.parseInt(e.slice(1,3),16),green:Number.parseInt(e.slice(3,5),16),blue:Number.parseInt(e.slice(5,7),16)}},squareColorObject:function(e){return{red:Math.floor(e.red*e.red/255),green:Math.floor(e.green*e.green/255),blue:Math.floor(e.blue*e.blue/255)}},colorObjectToHex:function(t){return`#${e.rgbToHex(t.red)}${e.rgbToHex(t.green)}${e.rgbToHex(t.blue)}`},getHighlightColorForTaggedObject:function(t){const n=e.parseColor(t),s=e.squareColorObject(n);return e.colorObjectToHex(s)}};return e})),define("DS/E6WCommonApps/E6WDropdownMenu",["DS/UIKIT/DropdownMenu"],(function(e){"use strict";const t=e.extend({init:function(e){this._parent.apply(this,arguments),this._addSubMenuListeners(e.items)},_addSubMenuListeners:function(e){e.forEach((e=>{if(e.items&&(this._addSubMenuListeners(e.items),e.events)){const t=this._getMenuFromItem(e.items[0].id);Object.entries(e.events).forEach((([e,n])=>t.addEvent(e,(()=>n(t,this)))))}}))}});return t})),define("DS/E6WCommonApps/DateUtils",[],(function(){"use strict";return{_toISOStringIgnoringUTC:function(e){return e.getFullYear()+"-"+this._pad(e.getMonth()+1)+"-"+this._pad(e.getDate())+"T"+this._pad(e.getHours())+":"+this._pad(e.getMinutes())+":"+this._pad(e.getSeconds())+"."+String((e.getMilliseconds()/1e3).toFixed(3)).slice(2,5)},_pad:function(e){var t=String(e);return 1===t.length&&(t="0"+t),t}}})),define("DS/E6WCommonApps/Constants",["i18n!DS/E6WCommonApps/assets/nls/TimelineNLS"],(function(e){"use strict";var t=e.get.bind(e);return{MONTH_LONG_NAMES:[t("January"),t("February"),t("March"),t("April"),t("May"),t("June"),t("July"),t("August"),t("September"),t("October"),t("November"),t("December")],MONTH_SHORT_NAMES:[t("Jan"),t("Feb"),t("Mar"),t("Apr"),t("May"),t("Jun"),t("Jul"),t("Aug"),t("Sep"),t("Oct"),t("Nov"),t("Dec")],DAY_LONG_NAMES:[t("Sunday"),t("Monday"),t("Tuesday"),t("Wednesday"),t("Thursday"),t("Friday"),t("Saturday")],DAY_SHORT_NAMES:[t("Sun"),t("Mon"),t("Tue"),t("Wed"),t("Thu"),t("Fri"),t("Sat")],NCAPSULATOR_BUFFER:18,DIVIDER_WIDTH:8}})),define("DS/E6WCommonApps/Views/ProgressBarPopupView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/FoundationBaseView","DS/DocumentManagement/DocumentManagement","DS/Controls/Accordeon","DS/Controls/ProgressBar","text!DS/E6WCommonApps/assets/templates/popover.html.handlebars","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r){"use strict";var l=function(e){return r.get(e)},d={error:"error",fail:"error",info:"info",warning:"warning"},c=t.compile(a),p=n.extend({_uwaClassName:"ProgressBarPopupView",id:function(){return"progressBar_"+this.cid},domEvents:{"click .minimize-btn":"toggleMinimizedMaximized","click .cancel-btn":"cancel"},setup:function(t){var n=e.clone(t||{},!1);this._activityElementObj={},this._progressBarObj={},this._isHidden=!0,this._error={},this._warning={};var i={onActivityStart:this.addActivityView,onActivityProgress:this.updateActivityView,onActivityComplete:this.removeActivityView,onActivityFailure:this.removeActivityView};n.additionalEventProducer&&this.listenTo(n.additionalEventProducer,i);var o=s.events;this.listenTo(o,i),this._activityCount=0},render:function(){return this.container.setHTML(c({title:l("E6WCommonApps.ProgressBar.Title")})),this._parent.apply(this,arguments),this.container.toggleClassName("hidden",this._isHidden),this},toggleMinimizedMaximized:function(){var e=this.getPopupOver(),t=e.getElement(".minimize-btn"),n=t.hasClassName("fonticon-down-open");t.toggleClassName("fonticon-down-open",!n),t.toggleClassName("fonticon-up-open",n),e.toggleClassName("minimized")},cancel:function(){this.close()},getPopupOver:function(){return this.getElement(".popover")},getPopupOverBody:function(){return this.getElement(".popover-body")},updateActivityView:function(t){var n=e.clone(t||{},!1),s=n.activity,i=s.name+"_"+s.id,o=this._activityElementObj[i];if(o){var a=this._progressBarObj[i],r=o.getElement(".process-log"),c=o.getElement(".status");c.setText(l("E6WCommonApps.ProgressBar.Processing")),o.addClassName("processing");var p=Math.ceil(100*t.loaded/t.total);if(n.log&&isNaN(p)&&(p=a.value||0),isNaN(p)||"fail"===n.type?(o.removeClassName("processing"),c.setText(l("E6WCommonApps.ProgressBar.Failure"))):a.value=p,"error"===n.type||"fail"===n.type){var u=this._error[i]||[];u.push(n.log),this._error[i]=u}if("warning"===n.type){var h=this._warning[i]||[];h.push(n.log),this._warning[i]=h}if(n.log)o.removeClassName("no-log"),e.createElement("li",{class:d[n.type],html:n.log}).inject(r)}},removeActivityView:function(e){var t=e.name+"_"+e.id,n=this.getPopupOverBody(),s=this._activityElementObj[t],i=this._progressBarObj[t],o=this;if(this._activityCount--,0===this._activityCount&&0===Object.keys(this._error).length&&0===Object.keys(this._warning).length)this._hideTimeout=setTimeout((function(){o.close()}),1e3);else if(this._error[t]||this._warning[t])if(this._error[t])this._error[t]&&(i.emphasize="high-attention");else{s.removeClassName("processing"),s.getElement(".status").setText(l("E6WCommonApps.ProgressBar.Completed"))}else n.removeChild(s),delete this._activityElementObj[t],delete this._progressBarObj[t]},addActivityView:function(t,n){var s=e.clone(n||{},!1);this.show(),this._activityCount++,t.id=t.id?t.id:(new Date).getTime();var i=this.createActivityView(t,s);this.getPopupOverBody().appendChild(i),this._activityElementObj[t.name+"_"+t.id]=i,s.infiniteFlag&&this.updateActivityView({activity:t,loaded:1,total:1})},createActivityView:function(t,n){var s=e.clone(n||{},!1),a=s.update?l("E6WCommonApps.ProgressBar.Updating"):l("E6WCommonApps.ProgressBar.Pending"),r=e.createElement("div",{id:t.name+"_"+t.id,class:"task-view no-log"}),d=new i({items:[{id:t.id,header:t.name,content:new e.Element("ul",{class:"process-log"})}],style:"simple"}).getContent(),c=d.getElement(".wux-controls-expander-header"),p=new o(e.merge({value:0,statusFlag:!1},s)).inject(c);return this._progressBarObj[t.name+"_"+t.id]=p,e.createElement("div",{class:"status",text:a}).inject(c),d.inject(r),r},destroy:function(){this._parent(),this._hideTimeout&&clearTimeout(this._hideTimeout)},show:function(){this._isHidden=!1,this.container.toggleClassName("hidden",this._isHidden)},hide:function(){this._isHidden=!0,this.container.toggleClassName("hidden",this._isHidden)},close:function(){this.hide(),this._error={},this._warning={},this._activityElementObj=[],this._progressBarObj=[],this._activityCount=0,this.getPopupOverBody().empty()}});return p})),define("DS/E6WCommonApps/Views/LinkLauncherUtils",["UWA/Core","UWA/Promise","DS/RDFFoundation/SecurityContextUtils","DS/RDFFoundation/MemberUtils","DS/E6WCommonUI/Views/ObjectCardView","DS/E6WCommonUI/PlatformManager","DS/TransientWidget/TransientWidget","DS/E6WCommonUI/WidgetUtils","DS/PlatformAPI/PlatformAPI","UWA/Class/Collection","DS/E6WCommonAppsLightbox/Views/Lightbox","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p){"use strict";var u=["VPMReference","Drawing","XCADModelRepReference","SLDPRT",".SLDPRT","SLDASM",".SLDASM","SLDDRW",".SLDDRW"],h=["VPMReference","VPMRepReference","Drawing","XCADNonPSBaseRepReference","CATPart",".CATPart","CATProduct",".CATProduct","CATShape",".CATShape","CATDrawing",".CATDrawing","CATAnalysis",".CATAnalysis","CATAnalysisResults",".CATAnalysisResults","CATAnalysisComputation",".CATAnalysisComputation","CATProcess",".CATProcess","CATMaterial",".CATMaterial"],m=["person","pno:person","Simulation","Simulation Template","DriveFolder"],T="Project Space",E=["Project Management","Route","SystemModel","Workspace Vault"],g=function(e){return p.get(e)},A={showPreview:function(e){var t=e&&e.get("parentTypes");if(t&&t.length&&t.find((e=>E.includes(e))))return!1;var n=e&&e.get("type"),s=e&&e.serviceHosting;return("3DSpace"===s||"3DDrive"===s)&&!m.includes(n)},launchProperties:function(e,t){var n=t&&t.model,s=n&&n.serviceHosting,i=n&&n.tenant,o=n&&n.physicalId||e,a={model:{objectId:o,tenant:i,source:s}};switch(n.sourceName&&(a.model.sourceName=n.sourceName),s){case"3dspace":case"3DSpace":break;case"3DDrive":a.model.sourceName="drive";break;default:a.model.sourceName=n.sourceName,a.model.source="fedsearch",a.model.objectId=n.fedSearchIdQuery,a.model["ds6w:type"]=n.get("ds6w:type")||n.get("dsxplan:jsType")}let l=!0;if(A.showPreview(n)){sessionStorage.setItem(r.getSessionId(),widget.getView().type),widget.dispatchEvent("onViewRequest",{type:"fullscreen"});var d=this;l=A.getPropertiesElement(a.model),l.then((function(e){var s={inode:n,properties:e,actions:[d.getDownloadButton&&d.getDownloadButton(t)],config3dPlay:A.get3DPlayOptions(n)};if(!A.lightbox){const e=c.init(s);widget.body.prepend(e),A.lightbox=e}A.lightbox.toggleVisibility(!0),A.lightbox.animationFrameId=window.requestAnimationFrame((function(){A.lightbox.refresh(s)}))}))}else require(["DS/LifecycleControls/EditPropDialog"],(function(e){new e({ID:"propFor"+o}).launchProperties(a)}));return l},get3DPlayOptions:function(t){const s={contextId:n.getDefaultSecurityContext(),physicalid:t.get("physicalId"),serverurl:o.getServiceUrl(t.serviceHosting),tenant:t.get("tenant")||o.getTenant()};return"3DDrive"===t.serviceHosting?e.extend(s,{provider:"FILE",filename:t.get("preview_url"),format:t.get("fileExtension")}):e.extend(s,{provider:"EV6",dtype:t.get("type"),requiredAuth:"passport"}),{asset:s}},getPropertiesElement:function(e){return new t((function(t,n){require(["DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/EditPropWidget"],(function(n,s,i){var o=new n(e),a=new i({className:"editTaskProperties",setEditButton:!1,readOnly:!0,typeOfDisplay:s.ONLY_EDIT_PROPERTIES,selectionType:s.NO_SELECTION,multiselection:!1,collapseTabs:!1,context:widget,actions:[]});a.initDatas([o]),t(a.elements.container.elements)}),(function(e){n(e)}))}))},polymorphicOpenMenuItem:function(t,n,s,i){var o=e.clone(t||{},!1),a=this._getAddInMode(),r=i.normalizedGet(i.model,i._config.name);r=e.is(r,"array")?r[o.index||0]:r instanceof d?r.at(o.index||0):r;var l;if(!((l=this._isDPMProject(i,r))||r.getObjectType&&"Project"===r.getObjectType())){if(o.isProjectOrPlan=l,o.model=r,o.isProject=false,o.isURL="dsplan:url"===i.normalizedGet(r,"dsxplan:jsType")||"URL"===i.normalizedGet(r,"type"),o.isURL){let e=i.normalizedGet(r,"dsplan:linkURL")||i.normalizedGet(r,"linkURL");o.handler=this.urlLinkHandler.bind(this,e)}return"solidworks"===a&&this.isSolidWorksFile(o.model)||"catiav5"===a&&this._isCatiaFile(o.model)?this.getAddInOpenMenuItem(o,n,s,i):this.getWebAppOpenMenuItem(o,n,s,i)}},urlLinkHandler:function(e){e.toLowerCase().startsWith("http://")||e.toLowerCase().startsWith("https://")||(e="http://"+e),window.open(e,"_blank")},_isDPMProject:function(e,t){var n=t.get("parentTypes");return e.normalizedGet(t,"type")===T||n&&n.includes(T)},openInApp:function(e){var t=e.getLaunchOptions(),n=t.appId;delete t.appId,a.showWidget(n,"",t)},getRedirectUrl:function(e){return`${window.enoviaServer["3dplan"]}/dsplan/redirectlink/${encodeURIComponent(e)}`},getDashboardUrl:function(e,t){return t=t||widget.getValue("appId"),window.enoviaServer["3DDashboard"]+"#app:"+t+"/content:ids="+encodeURIComponent(e)},getAddInOpenMenuItem:function(e,t,n){var s=this._getAddInMode(),i="solidworks"===s&&this.isSolidWorksFile(e.model)||"catiav5"===s&&this._isCatiaFile(e.model);return{className:t+(i?"":" disabled"),text:g("E6WCommonUI.Label.Open"),fonticon:"open",handler:function(){return i&&l.publish("webinwin:web:notification",JSON.stringify({operation:"open/setObject",operationVersion:"1.0",content:[{phid:e.model.get("physicalId")}]})),n.apply(this,arguments)}}},getWebAppOpenMenuItem:function(e){var t;return(e.isProjectOrPlan||e.isURL)&&(t={id:"open",text:e.isURL?g("E6WCommonUI.Label.OpenLink"):g("E6WCommonUI.Label.Open"),fonticon:"open",handler:e.handler}),t},isSolidWorksFile:function(e){var t=e.get("type"),n=e.get("busType");return-1!==u.indexOf(t)||-1!==u.indexOf(n)},_isCatiaFile:function(e){var t=e.get("type"),n=e.get("busType");return-1!==h.indexOf(t)||-1!==h.indexOf(n)},_getAddInMode:function(){return widget.getValue("addinmode")}};return A})),define("DS/E6WCommonApps/CommonAppsHandlebarsHelper",["DS/E6WCommonUI/CommonUIHandlebarsHelper"],(function(e){"use strict";return e})),define("DS/E6WCommonApps/Utils/ModalManager",["UWA/Core","DS/Windows/Dialog","DS/UIKIT/SuperModal"],(function(e,t,n){"use strict";const s={getSuperModal:function(n){return this._modal.dialog=s=>{if(n)return this._origDialog.call(this._modal,s);const i=e.clone(s||{},!1);i.content=i.content||i.body,i.buttons&&(i.customButtonsDefinition=i.buttons.map((e=>({label:e.value,emphasize:e.className,onClick:()=>e.action(o),disabled:e.disabled})))),i.buttons=i.webUXButtons;const o=new t({...this._getDefaultWebUXDialogOptions(),...i});return o.getContent().addClassName("eno-dialog"),o.elements._contentDiv.addClassName("modal-body"),o},this._modal},initSuperModal:function(e){return this._modal=new n({renderTo:e,className:"eno-common-apps-modal"}),this._origDialog=this._modal.dialog,this._modal},cleanupModals:function(){this._modal&&this._modal.modals.current&&this._modal.modals.current.destroy()},getCurrentContent:function(){return s.getCurrentModal().getContent()},getCurrentModal:function(){return s._modal.modals.current},_getDefaultWebUXDialogOptions:function(){return{resizableFlag:!1,modalFlag:!0,width:400}}};return s})),define("DS/E6WCommonApps/Utils/3DSpaceUtils",["DS/Foundation2/FoundationV2Data","DS/RDFFoundation/Models/ComponentProxyModel","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/UIHelper"],(function(e,t,n,s){"use strict";const i={fetchParentTypesWithCallback:function(e,t){if("3DSpace"!==(e.serviceHosting||"3DSpace")||e.get("parentTypes"))t();else{var n=s.getParentTypesFromMap(e.get("type"));n?(e.set("parentTypes",n,{silent:!0}),t()):i.fetchParentTypes(e,{onComplete:function(){t()}})}},fetchParentTypes:function(n,i){var o=n.id;if(n instanceof t&&(o=o.replace("dscom:3DSpace_",""),n.isCSLOnly()))return void(i&&i.onComplete&&i.onComplete());var a={url:"/resources/v3/e6w/service/ParentTypes/"+o,type:"GET",callback:function(e){if(e&&!e.error&&e.data||i&&i.onComplete&&i.onComplete.apply(n,arguments),e&&e.data&&e.data[0]){var t=e.data[0].parentTypes;n.set("parentTypes",t,{silent:!0}),s.addToParentTypesMap(n.get("type"),t),i&&i.onComplete&&i.onComplete.apply(n,arguments)}},dataType:"json",headers:{"content-type":"application/json"}};const r=enoviaServer.space;n.get("_isFromSourcing")&&(enoviaServer.setTempUrl(n._origSourceUrl),enoviaServer._tempBaseUrl=n._origSourceUrl,enoviaServer.space=void 0),e.ajaxRequest(a),"function"==typeof enoviaServer.setTempUrl&&enoviaServer.setTempUrl(),enoviaServer.space=r},loadSubTypes:function(t){return new Promise(((s,o)=>{n.isServiceDataLoaded()?n.getServiceUrl("3DSpace",!0)?e.ajaxRequest({url:`/resources/v3/e6w/service/TypeDerivatives?typePattern=${t}`,type:"POST",dataType:"json",callback:function(e){e.success?s(e.data[0].derivatives):o(e.error)}}):o("No access to 3dspace"):n.addEventOnce("serviceDataLoaded",(()=>i.loadSubTypes(t).then((e=>{s(e)})).catch((e=>o(e)))))}))}};return i})),define("DS/E6WCommonApps/PreferenceUtils",[],(function(){"use strict";return{get:function(e){return widget.getValue(e)},set:function(e,t){widget.setValue(e,t)},parse:function(e){return e?JSON.parse(e):e}}})),define("DS/E6WCommonApps/Models/E6WCommonAppsConstants",["UWA/Core","DS/E6WCommonUI/E6WCommonUIConstants"],(function(e,t){"use strict";var n={TASK:"Task",TASK_RDF_TYPE:"dsplan:Task",URL_RDF_TYPE:"dsplan:url",ENDDATE_ATTR:"dsplan:estimatedEndDate",DSLC_ENDDATE_ATTR:"dsxplan:estimatedEndDate",STARTDATE_ATTR:"dsplan:estimatedStartDate",DSLC_STARTDATE_ATTR:"dsxplan:estimatedStartDate",ESTIMATED_DATE_ATTR:"dsplan:estimatedDate",SUGGESTED_DATE_ATTR:"dsplan:suggestedDate",RESOLUTION_ATTR:"dsplan:resolution",TASK_VOCABULARY_ATTR:"dsplan:hasTaskVocabulary",DATE_INTERVAL_MIN_ATTR:"dsplan:dateIntervalMin",DATE_INTERVAL_MAX_ATTR:"dsplan:dateIntervalMax",ACTUAL_START_DATE:"dsplan:actualStartDate",ACTUAL_END_DATE:"dsplan:actualEndDate",BASELINE_ESTIMATED_DURATION:"dsplan:baselineEstimatedDuration",BASELINE_ACTUAL_DURATION:"dsplan:baselineActualDuration",BASELINE_ESTIMATED_START_DATE:"dsplan:baselineEstimatedStartDate",BASELINE_ESTIMATED_END_DATE:"dsplan:baselineEstimatedEndDate",BASELINE_ACTUAL_START_DATE:"dsplan:baselineActualStartDate",BASELINE_ACTUAL_END_DATE:"dsplan:baselineActualEndDate",DSLC_ACTUAL_START_DATE:"dsxplan:actualStartDate",DSLC_ACTUAL_END_DATE:"dsxplan:actualEndDate",ACTUAL_DELIVERABLE_ATTR:"dsplan:actualDeliverable",ATTACHMENT_ATTR:"dsplan:hasAttachment",ASSIGNEE_ATTR:"dsplan:hasAssignee",ASSIGNEE_ATTR_DSLC:"dsxplan:hasAssignee",DSLC_SCENARIOS_ATTR:"dsxplan:hasExperiment",DEPENDENCIES:"dependencies",USER_DEFINED_DATES_ATTR:"dsplan:userDefinedDates",SCHEDULE_ELEMENT_COLOR:"dsplan:scheduleElementColor",USER_DEFINED_START_DATE_ATTR:"dsplan:userDefinedStart",USER_DEFINED_END_DATE_ATTR:"dsxplan:userDefinedEnd",CHILDREN_ATTR:"dsplan:hasWorkDecomposition",SUBPROJECT_ATTR_DSLC:"dsxplan:hasWorkDecomposition",OBJECT:"Object",COMPLETE_PERCENT_ATTR:"dsplan:percentageCompletion",SEQUENCE_ORDER_ATTR:"dsplan:sequenceOrder",SEQUENCE_ORDER_ATTR_DSLC:"dsxplan:sequenceOrder",CALENDAR_ATTR:"dsxplan:scheduleCalendar",WORK_CONTEXT_ATTR:"dsxplan:hasWorkContext",WORK_CONTEXT:"dsplan:hasWorkContext",RESTRICT_ASSIGNEE_ATTR:"dsxplan:restrictAssigneeAccess",RESTRICT_ASSIGNEE_ATTR_SERVER:"dsplan:restrictAssigneeAccess",STORY_POINTS:"dsplan:storyPoints",RESPONSE_ATTR:"dsplan:response",RICH_TEXT_FIELD:"dsplan:RichTextField",TASK_RELATION_ATTR:"dsplan:hasTask",TASK_RELATION_ATTR_DSLC:"dsxplan:hasTask",MILESTONE_RELATION_ATTR:"dsplan:hasMilestone",GATE_RELATION_ATTR:"dsplan:hasGate",MILESTONE_RELATION_ATTR_DSLC:"dsxplan:hasMilestone",GATE_RELATION_ATTR_DSLC:"dsxplan:hasGate",DURATION:"dsplan:duration",DURATION_RANGE:"dsplan:durationRange",DURATION_MIN:"dsplan:durationIntervalMin",DURATION_MAX:"dsplan:durationIntervalMax",DURATION_SUGGESTED:"dsplan:suggestedDuration",DURATION_ESTIMATED:"dsplan:estimatedDuration",DURATION_ESTIMATED_RANGE:"dsplan:estimatedDurationRange",DURATION_ACTUAL_RANGE:"dsplan:actualDurationRange",DURATION_ACTUAL:"dsplan:actualDuration",DEFAULT_END_HOUR:16,TITLE_ATTR:"title",ACCUMULATED_STORY_POINTS:"dsplan:accumulatedStoryPoints",ITERATION_CAPACITY:"dsplan:iterationCapacity",UNIQUE_OBJECT_ID_ATTR:"dsxplan:enterpriseIdentificationNumber",IMAGE_TILE_ATTR:"image_tile",INV_DSLC_TITLE_ATTR:"dskern:label",DSLC_DESCRIPTION_ATTR:"dsxplan:comment",SUBTASK_ATTR_DSLC:"dsxplan:hasSubtask",SUBTASK_ATTR:"dsplan:hasSubtask",PARENT_ATTR:"dsxplan:workscopeParent",HAS_PARENT_ATTR:"dsplan:hasParent",PARENT_HAS_SWYM_COMMUNITY:"dsplan:hasCommunity",PARENT_HAS_LEAN_BOARD:"dsxplan:hasLeanBoard",LASTUPDATED_ATTR:"dspol:modificationDate",CREATION_DATE_ATTR:"dspol:creationDate",WORKSCOPE_PARENT_ATTR:"dsxplan:workDecompositionParent",PARENT_REFERENCE_PROJECT_ATTR:"dsxplan:parentReferenceProject",CREATED_FROM_ATTR:"dsxplan:createdFrom",REFERENCE_PROJECT_ATTR:"dsxplan:hasReferenceProject",TASK_PARENT_ATTR:"dsxplan:taskParent",COMMON_TASK_PARENT_ATTR:"commonTaskParent",WORKSCOPE_PARENT_ALL_ATTR:"dsplan:workscopeParentForAll",MILESTONE_PARENT_ATTR:"dsxplan:workscopeParentForMilestone",GATE_PARENT_ATTR:"dsxplan:workscopeParentForGate",HAS_CHECKLIST_ATTR:"dsplan:hasChecklistItem",CHECKLIST_PARENT_ATTR:"dsplan:checklistParent",SCENARIOS_PARENT_ATTR:"dsplan:experimentParent",TASK_REQUIREMENT_ATTR:"taskRequirement",TASK_COMPLETION_TYPE_ATTR:"taskCompletionType",IS_MANDATORY_ATTR:"dsplan:isMandatory",DSLC_DURATION_RANGE:"dsxplan:durationRange",DSLC_DURATION_MIN:"dsxplan:durationIntervalMin",DSLC_DURATION_MAX:"dsxplan:durationIntervalMax",DSLC_DURATION_ESTIMATED:"dsxplan:estimatedDuration",PRIORITY_ATTR:"dsplan:hasPriority",RESOLUTION_BLANK:"dsxplan:Blank",RESOLUTION_GO:"dsxplan:Go",RESOLUTION_KILL:"dsxplan:Kill",RESOLUTION_HOLD:"dsxplan:Hold",RESOLUTION_RECYCLE:"dsxplan:Recycle",RESOLUTION_CONDITIONAL_GO:"dsxplan:ConditionalGo",STATE_OPEN:"dsxplan:Open",STATE_IN_PROGRESS:"dsxplan:InProgress",STATE_DONE:"dsxplan:Done",STATE_ATTR:"dscom:hasMaturity",TSK_STATE_ATTR:"state",STATE_DRAFT:"dsxplan:Draft",STATE_ON_HOLD:"dsxplan:OnHold",STATE_PUBLISHED:"dsxplan:Published",PUBLISHED_MATURITY_VALUE:"Published",BASELINE_STATE_OPEN:"Open",BASELINE_STATE_IN_PROGRESS:"InProgress",BASELINE_STATE_DONE:"Done",MILESTONE_SUBTYPE_EXTERNAL:"External",DSLC_STATE_ATTR:"dsxplan:hasMaturity",DSLC_PRIORITY_ATTR:"dsxplan:hasPriority",attributeImpactingSolve:{"dsplan:durationIntervalMin":!0,"dsplan:durationIntervalMax":!0,"dsplan:startDateIntervalMin":!0,"dsplan:startDateIntervalMax":!0,"dsplan:estimatedStartDate":!0,"dsplan:endDateIntervalMin":!0,"dsplan:endDateIntervalMax":!0,"dsplan:estimatedEndDate":!0,"dsplan:hasAssignee":!0,"dsplan:actualStartDate":!0,"dsplan:actualEndDate":!0,"dscom:hasMaturity":!0,"dsplan:userDefinedDates":!0,"dsplan:userDefinedStart":!0,"dsplan:userDefinedEnd":!0,"dsxplan:workscopeParent":!0,"dsxplan:taskParent":!0,"dsxplan:scheduleCalendar":!0},attributeImpactingSubTaskSolve:{"dsplan:actualStartDate":!0,"dsplan:actualEndDate":!0,"dscom:hasMaturity":!0,"dsxplan:taskParent":!0},PROGRAM:"Program",PROGRAM_RDF_TYPE:"dsplan:Program",PROJECT:"Project",XPROJECT:"Enterprise Project",TYPE_AGILE_PROJECT:"AgileProject",TYPE_XPROJECT:"xProject",PROJECT_RDF_TYPE:"dsplan:Project",XPROJECT_RDF_TYPE:"dsplan:xProject",AGILE_PROJECT_RDF_TYPE:"dsplan:AgileProject",DELETED_PROJECT_RDF_TYPE:"dsplan:DeletedProject",ACTUAL_DATES_STRATEGY_ATTR:"dsplan:actualDatesStrategy",SCHEDULING_FROM_STRATEGY_ATTR:"dsplan:schedulingFromStrategy",PLANNED_DATES_STRATEGY:"Keep Planned Dates",CURRENT_DATES_STRATEGY:"Use Current Dates",STARTDATE_SCHEDULINGFROM_STRATEGY_USING_ACTUALS:"Start Date using actual dates",STARTDATE_SCHEDULINGFROM_STRATEGY_USING_PLANNED:"Start Date using planned dates",CURRENTDATE_SCHEDULINGFROM_STRATEGY:"Current Date",ENDDATE_SCHEDULINGFROM_STRATEGY_USING_ACTUALS:"End Date using actual dates",ENDDATE_SCHEDULINGFROM_STRATEGY_USING_PLANNED:"End Date using planned dates",PROJECT_TYPE:"dsplan:projectType",ASSOCIATED_KANBANS:"associatedKanbans",WORKPACKAGE:"WorkPackage",WORKPACKAGE_RDF_TYPE:"dsplan:WorkPackage",CONSTRAINT_RELATION_ATTR:"dsplan:hasConstraint",SHOW_SCHEDULE_HIGHLIGHTS:"_showScheduleHighlight",AUTOSOLVE_OFF:1,AUTOSOLVE_ON:2,ACTUAL_TYPE_ATTR:"dsplan:actualType",TYPE_ATTR:"@type",DESCRIPTION_ATTR:"subtitle",FONTICON_ATTR:"fonticon",KPI_RELATION_ATTR:"dsplan:hasSpecification",MILESTONE_VOCABULARY_ATTR:"dsplan:hasMilestoneVocabulary",MILESTONE_RDF_TYPE:"dsplan:Milestone",MILESTONE_RDF_TYPE_DSLC:"dsxplan:Milestone",GATE_RDF_TYPE:"dsplan:Gate",GATE_RDF_TYPE_DSLC:"dsxplan:Gate",MILESTONE_VOCABULARY_TYPE:"dsxplan:vocabularyType",MILESTONE:"Milestone",GATE:"Gate",OWNER_ATTR:"dskern:owner",CONTENT_REPOSITORY:"dsxplan:hasContentRepository",RISK_REPOSITORY:"dsplan:hasCollaborativeSpace",BOOKMARK_FOR_FILE_REPOSITORY:"dsplan:hasBookmark",REQUEST_TYPE_ADD:"addOperation",REQUEST_TYPE_REPLACE:"resetOperation",REQUEST_TYPE_REMOVE:"removeOperation",REQUEST_TYPE_PREVIEW:"previewOperation",REQUEST_TYPE_PROFILE:"viewProfileOperation",REQUEST_TYPE_EDIT:"editOperation",REQUEST_TYPE_ASSIGN:"assignOperation",REQUEST_TYPE_DELETE:"deleteOperation",NO_SOLVER_ERROR:"dsxplan:NoSolverError",PARENT_CHILD_ERROR:"ParentChildError",STARTMS_TRANSIENT_CONSTRAINT_ERROR:"startmsTransientConstraintError",ENDMS_TRANSIENT_CONSTRAINT_ERROR:"endmsTransientConstraintError",STARTENDMS_TRANSIENT_CONSTRAINT_ERROR:"startmsendmsTransientConstraintError",RESOURCE_AFFECTATION:"ResourceAffectation",RESPONSIBILITY_LEADER:"dsplan:Leader",RESPONSIBILITY_VIEWER:"dsplan:Viewer",RESPONSIBILITY_AUTHOR:"dsplan:Author",APP_3DPLAN:"ENXPLAN_AP",APP_TSK:"ENOTASK_AP",APP_RELATIONS:"ENORIPE_AP",TODO_STATE_COLOR:"#488EB8",IN_PROGRESS_STATE_COLOR:"#005686",DONE_STATE_COLOR:"#B5B6BA",DROP_CLASS_NAME:"drag-over",STATE_FOR_DISPLAY_ATTR:"stateForDisplay",PRIORITY_DISPLAY:"priority",DUE_DATE_CATEGORY:"dueDateCategory",COOWNERATTR:"co-owners",PERCENT_COMPLETE:"percentComplete",SIMULATION_TYPE:"Simulation",SIMULATION_TEMPLATE_TYPE:"Simulation Template",PAST_DUE:"PAST_DUE",NO_DATE:"NO_DATE",DUE_TODAY:"DUE_TODAY",DUE_TOMORROW:"DUE_TOMORROW",DUE_THIS_WEEK:"DUE_THIS_WEEK",DUE_FUTURE:"DUE_FUTURE",EXPLICIT_TAGS_DATA:"explicitTagsData",TAGS_DATA:"tagsData",USER_TAGS:"userTags",TEAM_MEMBERS:"team_members",GOVERNING_PROCESS:"governingProcess",ALL_LEVEL_TASKS:"allLevelTasks",FIRST_LEVEL_TASKS:"firstLevelTasks",LEVEL_PREF:"taskLevelPref",NONRDF_ATTACHMENT_ATTR:"references",NONRDF_DELIVERABLE_ATTR:"deliverables",SCHEDULE_ERROR_ATTR:"dsplan:hasScheduleError",DEPENDENCY_FILTER_TYPE:"dependencyType",DEPENDENCY_FILTER_STATUS:"dependencyStatus",DEPENDENCY_FILTER_SOURCE:"dependencySource",DEPENDENCY_FILTER_SUBPROJECTS:"subprojectDependencies",DEPENDENCY_FILTER_ALL:"all",DEPENDENCY_TYPE_ENFORCED:"enforced",DEPENDENCY_TYPE_FLEXIBLE:"flexible",DEPENDENCY_STATUS_BROKEN:"broken",DEPENDENCY_STATUS_WARNING:"warning",DEPENDENCY_STATUS_OK:"OK",DEPENDENCY_SOURCE_EXTERNAL:"external",DEPENDENCY_SOURCE_INTERNAL:"internal",SCOPEATTR:"scopes",DPMPROJECTATTR:"DPMProject",BUSINESS_METHOD_TEMPLATE:"businessMethodTemplate",BUSINESS_METHOD_SNAPSHOTDATE:"snapshotDate",DUPLICATE_TASK:"duplicate",SPLIT_TASK:"split",ADD_AS_REFERENCE:"reference",ADD_AS_SUBPROJECT:"subproject",ACTIVE:"Active",COMPLETE:"Complete",TASK_TABLE:"table",ONE_DAY:864e5,DEFAULT_COLOR:"#488EB8",REMINDER_DAYS:"dsxplan:reminderDays",PREVIEW:"Preview",SHOW_CONTEXT_FILTER:"showContextFilter",GET_FIRST_LEVEL_LEAF_TASKS_URL:"invoke/dsxplan:getFirstLevelLeafTasks?$mask=dsplan:MVMask.Task.CollaborativeTask.Basic",COMMUNITIY_TASKS_URL:"invoke/dsxplan:getCommunityTasks?$mask=dsplan:MVMask.Task.CollaborativeTask.Basic",RICH_TEXT_DESCRIPTION:"richTextDescription",DISABLE_NAVIGATION:"disableNavigation",HIDE_ID_CARD_HEADER:"hideIdCardHeader",COLUMN_IN_PROGRESS:"In Progress",BACKLOG_SETTING:"dsxplan:backlogSetting",BACKLOG_QUERY:"dsxplan:backlogQuery",BACKLOG_AUTOMATIC:"automatic",BACKLOG_MANUAL:"manual",PRE_LOAD_WORK_CONTEXTS:"preLoadWorkContexts",POST_LOAD_WORK_CONTEXTS:"postLoadWorkContexts",UPDATE_ALL_CHECKBOX_DISPLAY_EVENT:"updateAllCheckboxDisplay",SELECT_ALL_SCHEDULE_ELEMENTS_EVENT:"selectAllScheduleElements",UNSELECT_ALL_SCHEDULE_ELEMENTS_EVENT:"unSelectAllScheduleElements",UPDATE_CREATE_NEW_ICON:"updateCreateNewIcon",UPDATE_INFORMATION_ICON:"updateInfoIcon",UPDATE_MULTI_SELECT_COUNT:"updateMultiSelectCount",CLOSE_PROPERTY_PANEL:"closePropertyPanel",ON_FETCH_COUNT_CHANGED:"onFetchCountChanged",CONSTRAINT_TYPE:"constraintType",CONSTRAINT_DATE:"constraintDate",BUTTON_ID_NEW_PROJECT:"project",BUTTON_ID_EXISTING_PROJECT:"existingProject",BUTTON_ID_NEW_TASK:"task",BUTTON_ID_NEW_SUBTASK:"subTaskCreate",BUTTON_ID_NEW_MILESTONE:"milestone",BUTTON_ID_NEW_GATE:"gate",BUTTON_ID_NEW_DEPENDENCY:"dependency",BUTTON_ID_NEW_BASELINE:"baseline",BUTTON_ID_NEW_SCENARIO:"scenario"};return e.merge(n,t),n})),define("DS/E6WCommonApps/CSRFUtil",["UWA/Core","DS/DocumentManagement/DocumentFoundationAjax","DS/ENOProjectMgmtModels/Models/CSRFDataModel"],(function(e,t,n){"use strict";var s={getCsrf:function(e){var n={url:"/resources/v1/application/E6WFoundation/CSRF",type:"get",dataType:"json",callback:function(t){t&&t.csrf&&e(t.csrf)},headers:{"content-type":"application/json"}};return t.ajaxRequest(n)},setCSRF:function(e){n.prototype.setCSRF(e)},checkAndSetCSRF:function(t,i){let o=e.clone(t||{},!1),a=n.prototype.getCSRF();a.value?(o.csrf=a,i(o)):s.getCsrf((e=>{n.prototype.setCSRF(e.value),o.csrf=e,i(o)}))}};return s})),define("DS/E6WCommonApps/SharedWidgetUwaUtils",["UWA/Core","UWA/Class","UWA/Array","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],(function(e,t,n,s,i,o){"use strict";var a={processStorages:function(t,n,s){var o=e.clone(s||{},!1),r=widget.getValue("x3dPlatformId"),l=r&&t.find((function(e){return e.platformId.toUpperCase()===r.toUpperCase()}));l&&(l["3DSpace"]||l[o.additionalStorage])?(enoviaServer.storageUrl=l.url,enoviaServer.tenant=l.platformId,enoviaServer.swym=l["3DSwym"],enoviaServer.searchUrl=l["3DSearch"],enoviaServer.tenantDisplayName=l.displayName,e.extend(enoviaServer,l),i.setInvalidTenant(),widget.setValue("x3dPlatformId",enoviaServer.tenant)):(i.setInvalidTenant(r),a.showTenantError())},onRefresh:function(){var e=window.parent.document.getElementById("frame-"+widget.id);e.src=e.src},showTenantError:function(){if(widget.alerter){var e=o.get("E6WCommonUI.Warning.TenantNotAvailable");s.displayError(o.replace(e,{TENANT:i.getInvalidTenant()}))}},setStoragesPrefs:function(e,t,n,s){var i=[];t.forEach((function(e){n===e.platformId&&(enoviaServer.storageUrl=e.url,enoviaServer.tenant=e.platformId),i.push({label:e.displayName,value:e.platformId})})),e.addPreference({name:"collabstorage",type:"list",defaultValue:enoviaServer.tenant,options:i,label:WidgetConstants.str.CollaborativeStorages,onchange:"onStorageChange"}),"false"!==s.toLowerCase()&&e.addPreference({name:"collabspace",type:"list",defaultValue:"",options:[{label:"",value:""}],label:WidgetConstants.str.CollaborativeSpaces})}};return a})),define("DS/E6WCommonApps/Views/SignaturePopup",["UWA/Core","UWA/Class/Listener","DS/UIKIT/SuperModal","DS/UIKIT/Input/Password","DS/UIKIT/Input/Text","DS/UIKIT/Input/Toggle","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r){"use strict";var l=function(e){return r.get(e)},d=n.extend({init:function(n){var s=e.clone(n||{},!1);s.className="eno-common-apps-modal",this._parent(s),this._initializeOptionsForDialog(s),this._listener=new t,this.dialog(this._createDialog()),this._setFocusToFirstField(),this._setDisabledClassOnSignButton(!0)},_initializeOptionsForDialog:function(t){this.container=e.createElement("div"),this._callback=t.callback},_setFocusToFirstField:function(){a.isIpad()||a.isAndroid()||this.container.getElement("[id='username']").focus()},destroy:function(){this.destroyed||(this.dispatchEvent("onDestroy",[this]),this._listener&&(this._listener.stopListening(),delete this._listener),this._modalRef&&(this._modalRef.destroy(),delete this._modalRef),this._parent.apply(this,arguments),this.destroyed=!0)},modalFactory:function(){var e=this;return this._modalRef=this._parent.apply(this,arguments),this._listener.listenTo(this,"onHide",(function(){e.destroy()})),this._modalRef},getBody:function(){return this._modalRef&&this._modalRef.getBody()},_getTitle:function(){return this._dialogTitle||l("E6WCommonApps.Signature.Title")},_setDisabledClassOnSignButton:function(e){var t=document.getElementsByClassName("modal")[0];t&&t.getElement(".btn-create").toggleClassName("disabled",e)},_validate:function(){var e=function(e){return!e||e.trim&&!e.trim().length},t=e(this.usernameField.getValue())||e(this.passwordField.getValue())||!this.toggleField.isChecked();this._setDisabledClassOnSignButton(t)},_createDialog:function(){var t=this;e.createElement("p",{html:l("E6WCommonApps.Signature.Instructions")}).inject(this.container),e.createElement("label",{text:l("E6WCommonApps.Signature.Label.Id")}).inject(this.container);this.usernameField=new i({id:"username",label:l("E6WCommonApps.Signature.Label.Id"),placeholder:l("E6WCommonApps.Signature.Placeholder.UserName"),events:{onChange:function(e){t._validate()}}}).inject(this.container);e.createElement("label").inject(this.container);return this.passwordField=new s({id:"password",placeholder:l("E6WCommonApps.Signature.Placeholder.Password"),events:{onChange:function(e){t._validate()}}}).inject(this.container),this.toggleField=new o({id:"readAndUnderstands",type:"checkbox",label:l("E6WCommonApps.Signature.ReadAndUnderstands"),checked:!1,events:{onChange:function(e){t._validate()}}}).inject(this.container),{body:this.container,title:this._getTitle(),buttons:[{className:"primary btn-create",value:l("E6WCommonApps.Signature.Label.OK"),action:function(){t.save()}},{className:"default",value:l("E6WCommonApps.Signature.Label.Cancel"),action:function(){t.destroy()}}]}},save:function(){this.destroy(),this._callback&&this._callback({username:this.usernameField.getValue(),password:this.passwordField.getValue()})}});return d})),define("DS/E6WCommonApps/Views/RichTextEditorConfig",["DS/E6WCommonUI/PlatformManager","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t){"use strict";var n=function(e){return t.get(e)},s={},i={paragraphStyle:{command:"paragraphCommand",toolbar:"paragraph",label:n("E6WCommonApps.Label.Paragraph"),style:"p",type:"style"},h1Style:{command:"h1Command",toolbar:"paragraph",label:n("E6WCommonApps.Label.Heading1"),style:"h1",type:"style"},h2Style:{command:"h2Command",toolbar:"paragraph",label:n("E6WCommonApps.Label.Heading2"),style:"h2",type:"style"},BulletedListStyle:{command:"BulletedListCommand",toolbar:"paragraph",ckCommand:"bulletedlist",label:n("E6WCommonApps.Label.InsertRemoveBulletedList"),style:"ul",type:"command"},NumberedListStyle:{command:"NumberedListCommand",ckCommand:"numberedlist",toolbar:"paragraph",label:n("E6WCommonApps.Label.InsertRemoveNumberedList"),style:"ol",type:"command"},BlockquoteStyle:{command:"BlockquoteCommand",toolbar:"paragraph",ckCommand:"blockquote",label:n("E6WCommonApps.Label.BlockQuote"),style:"blockquote",type:"command"}};return s.getConfig=function(t){var n="../../E6WCommonApps/assets/ckeditor/";CKEDITOR.plugins.addExternal("autogrow",n+"plugins/autogrow/","plugin.js"),CKEDITOR.plugins.addExternal("custmaximize",n+"plugins/maximize/","plugin.js"),CKEDITOR.plugins.addExternal("custtoolbar",n+"plugins/toolbar/","plugin.js"),CKEDITOR.plugins.addExternal("imageresize",n+"plugins/imageresize/","plugin.js"),CKEDITOR.plugins.addExternal("highlight",n+"plugins/highlight/","plugin.js"),function(){for(let e in i)i.hasOwnProperty(e)&&!CKEDITOR.plugins.registered[e]&&CKEDITOR.plugins.add(e,{init:function(e){var t=this.name;e.addCommand(i[t].command,{contextSensitive:!0,exec:function(e,n){if(!n)for(let n in e.toolbar)if(e.toolbar.hasOwnProperty(n)&&e.toolbar[n].hasOwnProperty("name")&&e.toolbar[n].hasOwnProperty("items")&&"paragraph"===e.toolbar[n].name){let s=e.toolbar[n].items;for(let n in s)s.hasOwnProperty(n)&&s[n].hasOwnProperty("type")&&"button"===s[n].type&&s[n].getState()===CKEDITOR.TRISTATE_ON&&s[n].command!==i[t].command&&e.execCommand(s[n].command,!0)}const s=this.state===CKEDITOR.TRISTATE_ON?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_ON;"command"===i[t].type?e.execCommand(i[t].ckCommand):e[this.state===CKEDITOR.TRISTATE_ON?"removeStyle":"applyStyle"](new CKEDITOR.style({element:i[t].style})),this.setState(s)},refresh:function(e,n){if(n&&n.block){var s=n.block.getName();"p"!==s&&"li"!==s||(s=n.block.getParent().getName()),this.setState(s===i[t].style?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}}}),e.ui.addButton(i[t].command,{label:i[t].label,command:i[t].command,toolbar:i[t].toolbar})}})}();var s=["custtoolbar","autogrow","custmaximize","imageresize","customlink","pastefromword","h1Style","h2Style","paragraphStyle","BulletedListStyle","NumberedListStyle","BlockquoteStyle"],o=["BulletedListCommand","NumberedListCommand","BlockquoteCommand","formattedCommand","Table","-"];t.richTextField&&(CKEDITOR.plugins.addExternal("base64image",n+"plugins/base64image/","plugin.js"),s.push("base64image"),o.push("base64image")),t.isRoute||s.push("quicktable");var a=[{name:"basicstyles",groups:["paragraph","cleanup"],items:["Undo","Redo","-","paragraphCommand","h1Command","h2Command","-"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike"]},{name:"format",items:o},"/",{name:"paragraph",items:["Outdent","Indent","-","Highlight"]},{name:"links",items:["RemoveFormat","Link","Unlink"]},{name:"styles",items:["TextColor","BGColor"]}];return t.isRoute&&(a=[{name:"links",items:["Link","Unlink"]}]),{extraPlugins:s,allowedContent:!0,startupFocus:!1,resize_enabled:!1,language:"undefined"!=typeof widget&&e.getCurrentLanguage()||"en",toolbar:a,height:"100px",toolbarStartupExpanded:!1,toolbarCanCollapse:!t.isRoute,autoGrow_minHeight:100,autoGrow_onStartup:!1,removeButtons:t.isRoute?"Source,Save,Cut,Undo,Find,SelectAll,NewPage,Preview,Print,PasteFromWord,PasteText,Paste,Copy,Redo,Templates,Replace,Checkbox,Form,Scayt,Radio,TextField,Textarea,Select,Button,ImageButton,HiddenField,CopyFormatting,Subscript,Superscript,NumberedList,BulletedList,Blockquote,Indent,Outdent,CreateDiv,JustifyLeft,JustifyCenter,JustifyRight,JustifyBlock,Language,BidiRtl,BidiLtr,Anchor,Image,Flash,Table,HorizontalRule,Smiley,SpecialChar,PageBreak,Iframe,FontSize,Font,Format,Styles,Maximize,ShowBlocks,BGColor,TextColor,About":"",removeDialogTabs:"image:advanced;link:advanced",removePlugins:"customlink,maximize,image,elementspath,about,a11yhelp,dialogadvtab,bidi,templates,newpage,exportpdf,pagebreak,scayt,wsc,forms,div,flash,smiley,save,print,preview",linkShowTargetTab:!1,disableNativeSpellChecker:!1}},s})),define("DS/E6WCommonApps/Models/Document/DriveDocument",["UWA/Core","UWA/Class"],(function(e,t){"use strict";return t.extend({data:{title:null,fileName:null,file:null,icon:null,id:null,type:null,document:null,fileData:null,serviceId:"3DDrive"},init:function(t,n){var s=e.clone(t||{},!1);this._setupDocument(s,n)},_setupDocument:function(t,n){var s=e.clone(t||{},!1);this.set("title",s.title),this.set("icon",s.icon),this.set("id",s.id),this.set("type",s.type),this.set("file",n),this.set("type",s.type),this.set("fileName",n?n.name:s.title)},get:function(e){if(this.data[e])return this.data[e]},set:function(e,t){this.data[e]=t}})})),define("DS/E6WCommonApps/Views/DocumentFileChooserPopup",["UWA/Core","UWA/Class/Listener","DS/UIKIT/SuperModal","DS/UIKIT/Input/File","DS/UIKIT/Input/Text","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],(function(e,t,n,s,i,o,a,r){"use strict";var l=function(e){var t=r.get(e);return t===e&&(t=a.get(e)),t};return n.extend({init:function(n){var s=e.clone(n||{},!1);s.className="eno-common-apps-modal",this._parent(s),this._initializeDialogOptions(s),this._listener=new t,this.dialog(this._createDialog(s))},_initializeDialogOptions:function(t){this.container=e.createElement("div")},_createDialog:function(t){var n=this;n.docModel=t.docModel.contentModel||t.docModel,n.fileInfo={},this.fileField=new s({id:"fileSelect",multiple:!1,label:l("E6WCommonUI.Label.File"),placeholder:l("E6WCommonUI.Label.FileChooser"),buttonClassName:"primary",events:{onChange:function(e){n.fileInfo.file=e.target.files}}}).inject(this.container);e.createElement("label",{text:l("E6WCommonApps.Command.Comments")}).inject(this.container);return this.commentsField=new i({id:"filecomments",label:l("E6WCommonApps.Command.Comments"),placeholder:l("E6WCommonApps.Command.Comments"),events:{onChange:function(e){n.fileInfo.comment=e.target.value}}}).inject(this.container),{body:this.container,title:l("E6WCommonUI.Label.Update"),buttons:[{className:"primary btn-create",value:l("E6WCommonUI.Label.Update"),action:function(e){e.hide(),o.updateDocumentConfirmation(n.fileInfo.file,n.docModel,t.updateDocumentCallback,n.fileInfo.comment)}},{className:"default",value:l("E6WCommonUI.Label.Cancel"),action:function(e){e.hide()}}]}}})})),define("DS/E6WCommonApps/Models/NoAccessModel",["DS/RDFFoundation/Models/NoAccessModel"],(function(e){"use strict";return e})),define("DS/E6WCommonApps/Models/RollUpModel",["DS/RDFFoundation/Models/ResultModel"],(function(e){"use strict";return e.extend({isDSLC:function(){return!0},dslcMapping:{"dsplan:estimatedEndDate":"dsxplan:estimatedEndDate","dsplan:estimatedStartDate":"dsxplan:estimatedStartDate","dsplan:accumulatedStoryPoints":"dsxplan:accumulatedStoryPoints"},_propertyDictionary:{"dsplan:isRolledUpInfoFor":{inverseProperty:"dsplan:hasRolledUpInfo"}},hasViewAccess:()=>!0})})),define("DS/E6WCommonApps/Models/SolverModelMixin",[],(function(){"use strict";return{setup:function(){this._previous.apply(this,arguments),this.listenTo(this,"onChange:solveCounter",(function(){var e=this.getParent&&this.getParent();e&&(e.solveCounter+=this.solveCounter-this.prevSolveCounter)}))},prevSolveCounterDef:{get:function(){return this.previousAttributes().solveCounter||0}},solveCounterDef:{get:function(){return this.get("solveCounter")||0},set:function(e){this.set("solveCounter",e)}}}})),define("DS/E6WCommonApps/Views/ConfirmDialog",["UWA/Core","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/TooltipModel","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],(function(e,t,n,s,i,o,a){return{i18n:function(e){var t=a.get(e);return t===e&&(t=o.get(e)),t},render:function(o){let a=e.clone(o||{},!1);var r=a.model,l=a.onCancel,d=a.onSave,c=a.callback,p=new t({useBackgroundFlag:!0}),u=r.get("title")||r.model.getObjectType&&r.model.getObjectType();p.inject(document.body);var h={Save:new s({domId:"saveCancelBtn",onClick:function(e){d&&d(),E.close(),c&&c()}}),Abort:new s({domId:"dontCancelBtn",label:this.i18n("E6WCommonApps.Command.DontSave"),onClick:function(e){l&&l(),E.close(),c&&c()}}),Cancel:new s({domId:"cancelBtn",onClick:function(t){E.close(),e.is(a.onAbortCancel,"function")&&(a.onAbortCancel(),c&&c())}})},m=e.createElement("p",{text:this.i18n("E6WCommonApps.Warning.saveCancel")}),T=e.createElement("p",{text:this.i18n("E6WCommonApps.Warning.confirmSave")}),E=new n({immersiveFrame:p,width:500,title:this.i18n("E6WCommonApps.Command.Save")+' "'+u+'"',content:[m,T],modalFlag:!0,buttons:h}),g=E.getAbsolutePosition();g.y=90,E.setAbsolutePosition(g),E.elements._titleP.tooltipInfos=new i({shortHelp:u})}}})),define("DS/E6WCommonApps/WeekIterator",["UWA/Class","UWA/Core","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/TimelineIteratorMixin","i18n!DS/E6WCommonApps/assets/nls/TimelineNLS"],(function(e,t,n,s,i){"use strict";var o=s.SCALE,a=864e5,r=30*a,l=12*r,d=function(e){return i.get(e)},c=e.extend({init:function(e){this.current=new Date,this._start=new Date,this._end=new Date,this._dateline=e.dateline,this.scale=o.DAY,this.increment=1},setDateRange:function(e,t){this._start=void 0!==e?new Date(e.getTime()):new Date,this._end=void 0!==t?new Date(t.getTime()):new Date;var n=this.getRange();this.scale=o.YEAR,this.increment=1e3,1e4*l>n&&(this.scale=o.YEAR,this.increment=100),5e3*l>n&&(this.scale=o.YEAR,this.increment=50),1e3*l>n&&(this.scale=o.YEAR,this.increment=10),500*l>n&&(this.scale=o.YEAR,this.increment=5),100*l>n&&(this.scale=o.YEAR,this.increment=1),50*l>n&&(this.scale=o.MONTH,this.increment=6),20*l>n&&(this.scale=o.MONTH,this.increment=3),10*l>n&&(this.scale=o.MONTH,this.increment=2),7*l>n&&(this.scale=o.MONTH,this.increment=1),4*l>n&&(this.scale=o.DAY,this.increment=1),2*l>n&&(this.scale=o.DAY,this.increment=1),l>n&&(this.scale=o.DAY,this.increment=1),4*r>n&&(this.scale=o.DAY,this.increment=1),r>n&&(this.scale=o.HOUR,this.increment=12),15*a>n&&(this.scale=o.HOUR,this.increment=6),7*a>n&&(this.scale=o.HOUR,this.increment=3),5*a>n&&(this.scale=o.HOUR,this.increment=1)},getNextWeekStartDate:function(e){let n=t.clone(this.current,!0);for(e&&(this.current=e),this.next();!this.isWeek(this.current);)this.next();let s=this.current;return this.current=n,s},isWeek:function(){return this.scale===o.HOUR&&0===this.current.getHours()&&this.current.getDate()===this.getStartDateOfWeek(this.current)||this.scale===o.DAY&&this.current.getDate()===this.getStartDateOfWeek(this.current)},isScaleHourOrDay:function(){return this.scale===o.HOUR||this.scale===o.DAY},isScaleMonthOrYear:function(){return this.scale===o.MONTH||this.scale===o.YEAR},getWeekNumber:e=>n.getWeekNumber(e||this.current),getStartDateOfWeek:function(e){var t=new Date(e),n=t.getDay()||7;return 1!==n&&t.setHours(-24*(n-1)),t.getDate()},getLabelWeek:function(e){return void 0===e&&(e=this.current),d("Timeline.Label.WeekLabel").replace("{NUMBER}",this.getWeekNumber(e))},getZoomLabel:function(){return d("Timeline.Label.ZoomInLabel")}});return c.implement(s),c.OLD_WIDTH_CONST=11400,c.SCALE=o,c.YEAR=l,c.MONTH=r,c.DAY=a,c})),define("DS/E6WCommonApps/MultiEdit/MultiEditMenuUtil",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonApps/assets/nls/CollaborativeTasksNLS"],(function(e,t,n,s,i,o){"use strict";var a=function(e){var t=s.get(e);return t===e&&(t=i.get(e)),t===e&&(t=o.get(e)),t};return{checkIsMenuDisabled:function(t){let s,i=this,o=e.clone(t||{},!1),a=!1;this.isAssignToSelfDisabled=!1,this.isMarkAsCompleteDisabled=!1,this.isDuplicateDisabled=!1,this.isDeleteDisabled=!1,this.hideDuplicateMenu=!1,this.hasRouteTask=!1,o.selectedModels.forEach((function(t){if((o.assignToSelfItemAccess&&!o.assignToSelfItemAccess(t)||t.isWedo&&t.isWedo())&&(i.isAssignToSelfDisabled=!0),t.isComplete&&!t.isComplete()?s=!0:a=!0,t.hasFetchedAccessData()){let s=e.is(t.isRouteTask,"function")&&t.isRouteTask();i.hasRouteTask=i.hasRouteTask?i.hasRouteTask:s,o.completeItemAccess&&!o.completeItemAccess(t)&&o.reOpenItemAccess&&!o.reOpenItemAccess(t)&&(i.isMarkAsCompleteDisabled=!0),s||e.is(t.isProjectTask,"function")&&t.isProjectTask()?i.hideDuplicateMenu=!0:o.duplicateItemAccess&&o.duplicateItemAccess(t)&&(i.isDuplicateDisabled=!0),(s||o.deleteItemAccess&&!o.deleteItemAccess(t)||e.is(t.isIteropTask,"function")&&t.isIteropTask())&&(i.isDeleteDisabled=!0),!i.isDeleteDisabled&&(i.isDeleteDisabled=t&&n.isWedoTask(t.get("dsxplan:jsType")))}})),this.isComplete=!s&&a,!this.isMarkAsCompleteDisabled&&s&&a&&(this.isMarkAsCompleteDisabled=!0)},assignToSelf:function(e,s){let i=this,o=t.getBatchGenerator();o.requests=[],e.forEach((function(e){let t=e.isRDFTask&&e.isRDFTask()||e.isGate&&e.isGate()||e.isMilestone&&e.isMilestone();t||(i.modelToBeSaved=i.modelToBeSaved?i.modelToBeSaved:e),s(e,{multiEdit:!0,isRDF:t,batchGenerator:o}),n.trackPageEvent({eventCategory:"taskMenu",eventAction:"assignToSelf",eventLabel:"model",eventValue:e})})),i.modelToBeSaved&&i.modelToBeSaved.collection.save(),o&&o.sendBatch({onComplete:()=>{var e=a("emxCollaborativeTasks.Label.SuccessfullyAssignedToSelf");n.displaySuccess(e)},onFailure:()=>{var e=a("emxCollaborativeTasks.Error.FailAssignToSelf");n.displayError(e)}})},pinMenu:function(e,s){let i=t.getBatchGenerator();e.forEach((function(e){s(e,{batchGenerator:i})})),i.sendBatch({onComplete:()=>n.displaySuccess(a("E6WCommonApps.Alert.MassEditSuccessPinned")),onFailure:()=>n.displayError(a("E6WCommonApps.Error.MassEditFailedPinned"))})},updateState:function(e,s){let i=t.getBatchGenerator();i.requests=[];let o=[];if(e.forEach((function(e){let t=e.isRDFTask&&e.isRDFTask();s(e,{multiEdit:!0,batchGenerator:t?i:void 0,promises:t?void 0:o})})),this.modelToBeSaved&&this.modelToBeSaved.collection.save(),o.length>0&&Promise.all(o).then((()=>{o.iState&&this.displayStateChangeMessage(o.iState)}),(()=>{n.displayWarning(a("E6WCommonApps.Error.MassActionFailed"))})),i){let e={onComplete:()=>{}};0===o.length&&i.requests.length>0&&(e.onComplete=()=>{i.iState&&this.displayStateChangeMessage(i.iState)}),e.onFailure=()=>{n.displayWarning(a("E6WCommonApps.Error.MassActionFailed"))},i.requests.length>0&&i.sendBatch(e)}},massStateUpdate:function(t){var n=e.clone(t||{},!1);let s=this,i=n.callbackOptions;var o={patch:!0};i&&i.promises?(i.promises.iState=n.iState,i.promises.push(new Promise((function(e,t){o.onComplete=function(){e()},o.onFailure=function(){t()},o.delayedSave=!0,n.model&&n.model.save(n.attrs,o)}))),s.modelToBeSaved=s.modelToBeSaved?s.modelToBeSaved:n.model):(i.batchGenerator&&(o.onComplete=()=>{},o.ajax=i.batchGenerator.ajax,i.batchGenerator.iState=n.iState),n.model&&n.model.save(n.attrs,o))},displayStateChangeMessage:function(e){var t=a("emxCollaborativeTasks.Label.SuccessfullyChangedAttribute");t=(t=t.replace("%ATTRIBUTE_NAME%",a("emxCollaborativeTasks.Command.View.state"))).replace("%ATTRIBUTE_VALUE%",e.displayValue),n.displaySuccess(t)},isSelectionValid:function(e,t){return t=t||{},e&&e.length>20?(t.displayWarning&&n.displayWarning(a("E6WCommonUI.Label.LimitMultiSelectActions")),!1):!this.hasRouteTask||(t.displayWarning&&n.displayWarning(a("E6WCommonUI.Label.RouteTaskMultiActionsNotSupported")),!1)}}})),define("DS/E6WCommonApps/Views/LifecycleMenu",["DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i){"use strict";const o=i.get.bind(i),a=[{id:s.STATE_DRAFT,cssSuffix:"draft",labelAfter:o("E6WCommonApps.Label.SaveAsDraft"),tooltipAfter:o("E6WCommonApps.Label.Tooltip.SaveAsDraft")},{id:s.STATE_OPEN,cssSuffix:"todo",labelBefore:o("E6WCommonApps.Label.Start"),labelAfter:o("E6WCommonApps.Label.Restart"),tooltipBefore:o("E6WCommonApps.Label.Tooltip.Start"),tooltipAfter:o("E6WCommonApps.Label.Tooltip.Restart")},{id:s.STATE_IN_PROGRESS,cssSuffix:"inwork",labelBefore:o("E6WCommonApps.Label.BeginWork"),labelAfter:o("E6WCommonApps.Label.BackToInWork"),tooltipBefore:o("E6WCommonApps.Label.Tooltip.BeginWork"),tooltipAfter:o("E6WCommonApps.Label.Tooltip.BackToInWork")},{id:s.STATE_ON_HOLD,cssSuffix:"onhold",labelBefore:o("E6WCommonApps.Label.PutOnHold"),labelAfter:o("E6WCommonApps.Label.PutOnHold"),tooltipBefore:o("E6WCommonApps.Label.Tooltip.PutOnHold"),tooltipAfter:o("E6WCommonApps.Label.Tooltip.PutOnHold")},{id:s.STATE_DONE,cssSuffix:"completed",labelBefore:o("E6WCommonApps.Label.MarkAsComplete"),tooltipBefore:o("E6WCommonApps.Label.Tooltip.MarkAsComplete")}],r=[{id:s.STATE_DRAFT,cssSuffix:"draft",labelAfter:o("E6WCommonApps.Label.SaveAsDraft"),tooltipAfter:o("E6WCommonApps.Label.Tooltip.TemplateDraft")},{id:s.STATE_PUBLISHED,cssSuffix:"published",labelBefore:o("E6WCommonApps.Label.Published"),tooltipBefore:o("E6WCommonApps.Label.Tooltip.Publish")}],l={_buildItem:function(n,i,o){return{type:"PushItem",title:o?i.labelBefore:i.labelAfter,fonticon:{content:`fonticon fonticon-status-change maturity-state-${i.cssSuffix}${o?"":" demote"}`,family:"DSFontIcon"},tooltip:{title:o?i.labelBefore:i.labelAfter,shortHelp:o?i.tooltipBefore:i.tooltipAfter,allowUnsafeHTMLShortHelp:!0},action:{callback:()=>{n.set([s.STATE_ATTR],e.getObjectForAdding(t,i.id)),n.save()}}}},findProjectStateIndexAndBuildMenu:function(e,t,n){const i=e.findIndex((e=>(t.get(s.STATE_ATTR).id||t.get(s.STATE_ATTR))===e.id));e.forEach(((e,s)=>{if(i!==s){const o=l._buildItem(t,e,i<s);o&&n.push(o)}}))},build:function(e){const t=[];return n.isTemplate(e)?this.findProjectStateIndexAndBuildMenu(r,e,t):this.findProjectStateIndexAndBuildMenu(a,e,t),t}};return l})),define("DS/E6WCommonApps/TaggerChipColorMixin",["UWA/Core","UWA/Class/Listener","DS/E6WCommonApps/ColorUtil","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonApps/assets/nls/CollaborativeTasksNLS"],(function(e,t,n,s,i,o){"use strict";var a=function(e){var t=o.get(e);return t===e&&(t=i.get(e)),t},r="tag-color",l="tag-color-chip",d={_stopListeningToTaggerEvents:function(){this.stopListening&&this.stopListening(void 0,"onChangeTaggerColoring")},addTaggerChipColorChangeEvents:function(t){var n=e.clone(t||{},!1).model||this.model;this._stopListeningToTaggerEvents(),this.listenTo(n,"onChangeTaggerColoring",(function(){this.colorTaggerChip(t)}))},addTaggerChipColorChangeEventsForMilestoneGroupView:function(){var e=this;this._stopListeningToTaggerEvents(),this.options.milestoneCollection.forEach((function(t){let n=t.rdfModel||t;e.listenTo(n,"onChangeTaggerColoring",(function(){var s={container:e.getBody().getElement('li[milestone-id="'+t.id+'"]'),model:n};e.colorTaggerChip.apply(s)}))}))},colorTaggerChip:function(t){var s=e.clone(t||{},!1).model||this.model,i=this.container;let o=this.getChipColor(s);if(o){i.style.setProperty("--te-fill",o),this.milestoneRect?.style.setProperty("fill",o);const e=n.getHighlightColorForTaggedObject(o);i.style.setProperty("--te-highlight",e),i.toggleClassName&&i.toggleClassName(r,!0)||i.classList.add(r)}else i.removeClassName&&i.removeClassName(r)||i.classList.remove(r),this.milestoneRect?.style.removeProperty("fill"),i.style.removeProperty("--te-fill"),i.style.removeProperty("--te-highlight")},getChipColor:function(e){return e.tagColor||e.get("dsplan:scheduleElementColor")},getTaggerChipElement:function(){return e.createElement("span",{class:l})},getMilestoneTaggerChipElement:function(){var e=this.createSVGElement("svg",{class:l,width:8,height:16,x:0,y:2,viewBox:"0 0 8 16"});return this.createSVGElement("path",{class:"badge",d:"M6,16H2c-1.1,0-2-0.9-2-2V2c0-1.1,0.9-2,2-2h4c1.1,0,2,0.9,2,2v12C8,15.1,7.1,16,6,16z"}).inject(e,"top"),e},setTaggerColorMap:function(e){var t={"ds6w:why/ds6w:priority":[{object:a("E6WCommonApps.Label.Low"),type:"string",color:"#57b847"},{object:a("E6WCommonApps.Label.Medium"),type:"string",color:"#00b8de"},{object:a("E6WCommonApps.Label.High"),type:"string",color:"#e87b00"},{object:a("E6WCommonApps.Label.Urgent"),type:"string",color:"#ea4f37"}],"ds6w:what/ds6w:status":[{object:a("emxCollaborativeTasks.Label.ToDo"),type:"string",color:s.TODO_STATE_COLOR},{object:"Project Task.Assign",type:"string",color:s.TODO_STATE_COLOR},{object:"ds6w:status.task_open",type:"string",color:s.TODO_STATE_COLOR},{object:"Project Task.Create",type:"string",color:s.TODO_STATE_COLOR},{object:"dsxplan:Open",type:"string",color:s.TODO_STATE_COLOR},{object:a("emxCollaborativeTasks.Label.InWork"),type:"string",color:s.IN_PROGRESS_STATE_COLOR},{object:"Project Task.Active",type:"string",color:s.IN_PROGRESS_STATE_COLOR},{object:"Project Task.Review",type:"string",color:s.IN_PROGRESS_STATE_COLOR},{object:"ds6w:status.task_inprogress",type:"string",color:s.IN_PROGRESS_STATE_COLOR},{object:a("emxCollaborativeTasks.Label.Completed"),type:"string",color:s.DONE_STATE_COLOR},{object:"dsxplan:InProgress",type:"string",color:s.IN_PROGRESS_STATE_COLOR},{object:"Project Task.Complete",type:"string",color:s.DONE_STATE_COLOR},{object:"ds6w:status.task_done",type:"string",color:s.DONE_STATE_COLOR},{object:"dsxplan:Done",type:"string",color:s.DONE_STATE_COLOR}]};e.setColorMap(t)}};return d.TAG_COLOR_CLASS=r,d.TAG_COLOR_CHIP_CLASS=l,d})),define("DS/E6WCommonApps/Views/StoryPointsView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/NumberView","DS/E6WCommonApps/Models/E6WCommonAppsConstants","text!DS/E6WCommonUI/assets/templates/storyPoints.html.handlebars"],(function(e,t,n,s,i){"use strict";var o=t.compile(i),a=n.extend({_uwaClassName:"StoryPointsView",tagName:"div",name:"E6WCommonApps.StoryPointsView",setup:function(){this.model&&this.model.addEvent&&this._config.name&&this.listenTo(this.model,"onChange:"+this._config.name,(function(){this._toggleStoryPointsAttention()})),this._parent.apply(this,arguments)},render:function(){var e=this._parent.apply(this,arguments);return this._toggleStoryPointsAttention(),e},getDataOptions:function(){const e=this._parent.apply(this,arguments);return this._config.accPointsName&&e.attributes.push(this._config.accPointsName),e},_toggleStoryPointsAttention:function(){var e=this.container.getElement(".input-group.accumulated-story-points .input-element");this.model&&this.model.get(s.ACCUMULATED_STORY_POINTS)>this.model.get(s.ITERATION_CAPACITY)?e.toggleClassName("has-error",!0):e.toggleClassName("has-error",!1)}});return a.prototype.compiledTemplate=o,a})),define("DS/E6WCommonApps/Views/ProcessImageView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/ObjectView","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/E6WCommonAppsConstants","text!DS/E6WCommonUI/assets/templates/imageUpload.html.handlebars","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a){"use strict";var r=a.get.bind(a),l=n.extend({compiledTemplate:t.compile(o),_uwaClassName:"E6WCommonUIProcessImageView",tagName:"div",name:"E6WCommonUI.ProcessImageView",domEvents:{"click .ds-drop-target-overlay":"_openFileExplorer","click .plan-image-clear":"_removeImage"},render:function(){this._parent.apply(this,arguments),this.container.getElement(".plan-image-clear").toggleClassName("disabled",void 0===this.model.get(this._config.name))},handleDrop:function(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault();var n=e.Event.getElement(t);n.removeClassName(i.DROP_CLASS_NAME);var o=t.dataTransfer.files,a=r("E6WCommonApps.Error.GenericNotSupported");if(this.canReadWrite()){if(o&&o.length)return void this._processImage(n,o);var l=s.getDataTransferJSON(t.dataTransfer);if(a=r("E6WCommonApps.Error.ObjectPreviewNotAvailable"),l&&l.data&&l.data.items&&l.data.items.length>0){var d=l.data.items[0];if(d.displayPreview)return void this._processObjectPreview(n,d.displayPreview)}}s.displayError(a)},_processImage:function(t,n){if(n&&!n[0].type.contains("image"))s.displayError(r("E6WCommonUI.Error.UnsupportedFileType"));else{var i=this,o=this._config,a=e.clone(this._options||{},!1),l=t.getElement("img");n&&n.length&&s.processDroppedImage(n,l,(function(e){e&&i.model&&i.model.set(o.name,e,a)}))}},_processObjectPreview:function(t,n){var i=this,o=this._config,a=e.clone(this._options||{},!1),l=t.getElement("img");s.processDroppedObjectPreview(n,l,(function(e){e?i.model&&i.model.set(o.name,e,a):s.displayError(r("E6WCommonApps.Error.ObjectPreviewNotAvailable"))}))},_openFileExplorer:function(){var e=this.container.getElement(".plan-image-clear");if(event.target!==e&&event.target.parentElement!==e){var t=this;s.openFileExplorer({callback:function(e){var n=t.container.getElement(".form-control");t._processImage(n,e)},accept:"image/*"})}},_removeImage:function(){this.model&&this.model.set(this._config.name,void 0)}});return l})),define("DS/E6WCommonApps/ScheduleConstants",["UWA/Core","UWA/Utils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],(function(e,t,n,s){"use strict";var i={PROGRAM_MANAGER_LABEL:"Program Manager",PROJECT_MANAGER_LABEL:"Project Manager",WORKPACKAGE_MANAGER_LABEL:"Work Package Manager",MILESTONE:"Milestone",GATE:"Gate",ACTUAL_DATE:"dsplan:actualDate",GATE_RESOLUTION:"dsplan:resolution",CONSTRAINT:"Constraint",IMAGE_ATTR:"image",THUMBNAIL_ATTR:"dsplan:hasThumbnail",OWNER_FIRSTNAME_ATTR:"foaf:givenName",OWNER_LASTNAME_ATTR:"foaf:familyName",RDF_TYPE:n.RDF_TYPE,ACTUAL_TYPE_ATTR:n.ACTUAL_TYPE_ATTR,REQUIRES_SKILL_ATTR:"dsplan:requiresSkill",SCHEDULE_UPDATE_STATUS_ATTR:"dsplan:ScheduleUpdateStatus",PERSON_ID_ATTR:"ds6w:identifier",PLAN_TO_ADD:"addPlan",TYPE_TEMPLATE:"dsbase:Template",DEFAULT_PROJECT_TEMPLATE:"TeamProject",CUSTOMER_EXTENSION:"dsbase:customerExtension",SAVE_AS_TEMPLATE:"SaveAsTemplate",CREATE_PROJECT:"Create",CREATE_PROJECT_FROM_PROJECT:"CreateFromProject",CREATE_PROJECT_FROM_TEMPLATE:"CreateFromTemplate",CREATE_PROJECT_FROM_CUSTOMER_EXTENSION:"CreateProjectFromCustomerExtension",CREATE_PROJECT_FROM_PROJECT_OR_TEMPLATE:"CreateProjectFromProjectOrTemplate",TOOLBAR_ID_TASKS:"taskViewToolbar",TOOLBAR_ID_SCHEDULE:"scheduleToolbar",TOOLBAR_ID_DEPENDENCIES:"dependenciesToolbar",TOOLBAR_ID_MEMBERS:"memberViewToolbar",TOOLBAR_ID_CONTENT:"contentViewToolbar",TOOLBAR_ID_RISKS:"riskViewToolbar",TOOLBAR_ID_BACKLOG:"backlogToolbar",TOOLBAR_ID_RESOURCE:"resourceViewToolbar",SCHEDULING_STRATEGY_ATTR:"dsplan:schedulingStrategy",SCHEDULING_STRATEGY_LABEL:"Scheduling Strategy",RESOURCE_LEVELING_STRATEGY:"Resource Levelling",TEMPORAL_SCHEDULING_STRATEGY:"Temporal Scheduling",RESOURCE_AUTOMATED_ALLOCATION_STRATEGY:"Resource Automated Allocation",RESOURCE_AUTOMATED_ALLOCATION_STRATEGY_LABEL:"Auto Resource Allocation",PROPERTY_PANEL_ACTIVE:"active",PROPERTY_PANEL_CLASS:"slide-in-panel right ds-dialog property-panel",CAN_READ:"dsplan:canRead",CAN_MODIFY:"dsplan:canModify",CAN_DELETE:"dsplan:canDelete",TASK_TYPE:"taskType",CREATED:"Created",ADDED:"Added",RESTORED:"Restored",DELETED:"Deleted",REMOVED:"Removed",MODIFIED:"Modified",TRANSITIONED:"Transitioned",REPEAT_CREATE_TASK:"repeatCreateTask",REPEAT_CREATE_OBJ:"repeatCreateObject",TASK_COLLAB_SPACE:"taskCollabSpace",COLLAB_SPACE:"collabSpace",COLLAB_SPACE_NAME:"collabSpaceName",TASK_ORGANIZATION:"taskOrganization",STANDALONE_TASK:"standaloneTask",SIMPLE_TASK:"simpleTask",XPP_TASK:"xppTask",DPM_TASK:"dpmTask",SCHEDULE_RELATION_ATTR:"dsplan:hasSchedule",SCHEDULE_RDF_TYPE:"dsplan:Schedule",TASK_HEIGHT:22,MIN_CART_HEIGHT:38,ANIMATION_DURATION:500,SUMMARY_FACET:"summary",SCHEDULE_FACET:"schedule",DEPENDENCIES_FACET:"dependencies",TASK_FACET:"tasks",MEMBER_FACET:"team",CONTENT_FACET:"content",RISK_FACET:"risk",BACKLOG_FACET:"backlog",RESOURCE_FACET:"resource",TEAM_LEADERS:"team_leaders",TEAM_MEMBERS:"team_members",HAS_SWYM_COMMUNITY:"dsxplan:hasCommunity",DSLC_TITLE_ATTR:"dsxplan:label",LOAD_MORE:"loadMoreProjectsPlease",DEACTIVATE_WIDGET_FILTER_EVENT:"deactivate3DWidgetFilter",ACTIVATE_WIDGET_FILTER_EVENT:"activate3DWidgetFilter",TAGGER_FILTER_CRITERIA:"tagger",TAGS_DATA:"tagsData",SEARCH_FILTER_CRITERIA:"search",WIDGET_FILTER_CRITERIA:"3dwidgetFilter",CRITICAL_PATH_FILTERS:"criticalPathFilters",AI_EXECUTION_FILTERS:"aiExecutionFilters",UPDATE_ROW_ARROWS:"updateRowArrows",EOD_TIMEOFFSET:612e5,ROLLED_UP_INFO_ATTR:"dsxplan:hasRolledUpInfo",CREATE_LU_BUTTON_ID:"create-logical-user",TASK_DRAG_HANDLE_WIDTH:16,TASK_DRAG_HANDLE_HEIGHT:24,TASK_DRAG_HANDLE_OFFSET:2,TITLE_OFFSET_CONSTRAINT:7,CONSTRAINT_CIRCLE_RADIUS:t.Client.Features.touchEvents?8:6.5,TASK_CONSTRAINT_OFFSET_Y:8,CONSTRAINT_OFFSET:3,STYLE_EXPANSION:"expansion",STYLE_COMPRESSION_LOW:"compression-low",STYLE_COMPRESSION_HIGH:"compression-high",MIN_COMPRESSION_DECORATION_WIDTH:18,POLYGON_COMPRESSION_LOW_RIGHT:["89.775,64.57 125.893,1.993 111.332,1.993 75.203,64.57 111.332,125.899 125.893,125.899"],POLYGON_COMPRESSION_HIGH_RIGHT:["89.775,64.51 125.893,1.933 111.332,1.933 75.203,64.51 111.332,125.838 125.893,125.838","60.63,64.51 96.748,1.933 82.187,1.933 46.058,64.51 82.187,125.838 96.748,125.838"],POLYGON_EXPANSION_RIGHT:["111.324,63.392 75.907,125.953 90.463,125.953 125.893,63.392 90.463,2.047 75.907,2.047"],POLYGON_OFFSET_Y:5,POLYGON_OFFSET_X:2,ITERATION_REORDER:"iterationReorder",PROJECT_TYPES:["dsplan:Project","dsplan:xProject","dsplan:ProjectPlanningTemplate","dsplan:AgileProject"],NEW_ROW_CSS:"new",HIDE_TREE:"hide-tree",SHOW_TREE:"show-tree"};return i.POLYGON_SCALING_FACTOR=(i.TASK_HEIGHT-4)/128,i.POLYGON_WIDTH=128*i.POLYGON_SCALING_FACTOR,i.TASK_DRAG_HANDLE_FULL_WIDTH=i.TASK_DRAG_HANDLE_WIDTH+i.TASK_DRAG_HANDLE_OFFSET,e.merge(i,s),i})),define("DS/E6WCommonApps/Views/CreateDialogTabMixin",["UWA/Core","UWA/Class/Listener","UWA/Element","UWA/Class/Events","DS/Controls/TabBar","DS/Controls/ComboBox","DS/WAFData/WAFData","DS/RDFFoundation/CustomExtensionUtils","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/ScheduleConstants","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u){"use strict";var h=function(e){var t=u.get(e);return t===e&&(t=p.get(e)),t};return{_setupTabBar:function(){this.tabBar=new i({displayStyle:"strip"}),this.tabBar.add({label:h("E6WCommonApps.Command.Properties"),icon:{iconName:"attributes",fontIconFamily:WUXManagedFontIcons.Font3DS},showTitleFlag:!1,isSelected:!0}),this.tabBar.add({label:h("E6WCommonUI.Label.AttributeExtensions"),icon:{iconName:"properties",fontIconFamily:WUXManagedFontIcons.Font3DS},showTitleFlag:!1}),this.tabBar.addEventListener("tabButtonClick",(()=>{this._updateFormDisplay()})),this._dialogTabContainer=this.container.getElement("#dialogTab"),this._propertiesForm=this.container.getElement("#propertiesContainer"),this._extendedAttributesContainer=this.container.getElement("#extendedAttributesContainer"),this._extendedAttributes=this.container.getElement("#extensionAttributes"),this.tabBar.inject(this._dialogTabContainer,"top"),this._templateComboBox=new o({elementsList:[],selectedIndex:0,enableSearchFlag:!1}),this._templateComboBox.addEventListener("change",(()=>{this.charEditor&&this.charEditor.destroy(),this.charEditor=void 0,""===this._templateComboBox.value?(this._extendedAttributes.innerHTML="",this.tabBar&&this.tabBar.getButtonFromValue(1).elements.container.classList.remove("has-error")):this._refreshCharacteristicEditorView()})),this._templateComboBox.inject(this.container.getElement("#extensionSelector"))},_updateFormDisplay:function(){if(this._tabSelected=0!==this.tabBar.value[0],this._propertiesForm.toggleClassName("hide",this._tabSelected),this._extendedAttributesContainer.toggleClassName("hide",!this._tabSelected),!this._extendedAttributesContainer.classList.contains("hide")){var e=this._detailsView&&this._detailsView.model||this._detailsViewCreateTask&&this._detailsViewCreateTask.model,t=e.get("@type")||e["dsplan:actualType"]||e[c.TASK_TYPE];t===c.XPP_TASK&&(t="dsplan:Task");let n=[...new Set(r.getExtensionsForTaxonomy(t))];n.splice(0,0,{value:"",label:h("E6WCommonUI.Label.SelectExtension")}),this._updateExtensionsField(n)}},_updateExtensionsField:function(e){this._extendedAttributes&&e&&e.length&&(this._templateComboBox.elementsList=e)},_refreshCharacteristicEditorView:function(){this._extendedAttributes&&(this._extendedAttributes.innerHTML="",""!==this._templateComboBox.value&&this._loadCustomAttributesView())},_loadCustomAttributesView:function(){var e=this,n=this._templateComboBox&&this._templateComboBox.value,s={rdfServerURL:l.getServiceUrl("3dplan")+"/",resourceURI:n,platformId:l.getTenant(),customization:{editMode:!0,onChangeSensitive:!1,display:{title:!1,subtitle:!1,switchMode:!1,scroller:!1,buttons:!1,switchLanguage:!1,characteristics:{tooltip:!0}},getInfos:function(){var e={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","Accept-Language":widget.lang};return new Promise((function(t,s){a.authenticatedRequest(l.getServiceUrl("3dplan")+"/resources/v1/templates/"+n+"/parameters",{method:"GET",headers:e,type:"json",onComplete:function(e){var n={},s=["dskern:nlsLabel","dskern:nlsComment"];Object.keys(e).forEach((function(t){s.includes(t)?delete e[t]:(e[t].ReadOnly=!1,n[t]=e[t].value)})),t({characteristics:n,schema:{characteristics:e}})},onFailure:function(e,t,n){s(n)},timeout:3e5})}))}},events:{onValueChange:function(){var t=e.charEditor.elements.form,n=!0;t.unvalidate(),t.getAllInputInstances().forEach((function(e){e.validateForForm()||(n=!1)})),e.charEditor.dispatchEvent("areCustomAttributesValid",[n])},onFinishRender:()=>this.dispatchEvent("onFinishRender")}};d.loadJSDependency("DS/dsbaseUIControls/CharacteristicsView").then((n=>{e.charEditor=new n(s),e.charEditor.inject(e._extendedAttributes),e._listener=new t,e._listener.listenTo(e.charEditor,"areCustomAttributesValid",(function(t){t&&e.tabBar?e.tabBar&&e.tabBar.getButtonFromValue(1).elements.container.classList.remove("has-error"):e.tabBar&&e.tabBar.getButtonFromValue(1).elements.container.classList.add("has-error")}))})).catch((e=>{"scripterror"===e.requireType&&console.error(e.message)}))}}})),define("DS/E6WCommonApps/SmartSchedulerUtils",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ComponentProxyModel","DS/RDFFoundation/SecurityContextUtils","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonApps/Utils/3DSpaceUtils","DS/Foundation2/Models/FoundationV2Model","DS/E6WCommonApps/Views/LinkLauncherUtils","DS/E6WCommonApps/Views/DocumentFileChooserPopup","DS/E6WCommonApps/ScheduleConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h){"use strict";var m="dsxplan:isEnforced";const T="bookmarkButton";var E=function(e){var t=p.get(e);return t===e&&(t=u.get(e)),t},g={getCompletedTaskFilter:function(){var e="all",t=widget.getValue(g.COMPLETED_TASK_PREF_NAME);if(t&&"all"!==t){var n=new Date;n.setDate(n.getDate()-t),e=n.toISOString()}return e},setCompletedTaskFilter:function(e){widget.setValue(g.COMPLETED_TASK_PREF_NAME,e)},getCompletedTasksFilterPref:function(e){return{name:g.COMPLETED_TASK_PREF_NAME,type:"list",defaultValue:e,options:[{label:E("E6WCommonApps.Label.CompletedTasksLast10Days"),value:10},{label:E("E6WCommonApps.Label.CompletedTasksLast30Days"),value:30},{label:E("E6WCommonApps.Label.CompletedTasksLast60Days"),value:60},{label:E("E6WCommonApps.Label.CompletedTasksAllDays"),value:"all"}],label:E("E6WCommonApps.Label.CompletedTasksDisplayPref")}},getDropDownMenuItems:function(e,t){var n=Boolean(this._config.readWrite),s=this.normalizedGet(this.model,this._config.name),i="Project"===this.normalizedGet(s,"type"),o=g.getManagementView(),a=[o?g.getOpenMenuConfig(s,o):g.getPreviewMenuConfig(s,i),g.getDetachMenuConfig.call(this,n,t)];if(s){var r=g.getPropertiesMenuConfig.call(this,t);a.splice(0,0,r)}return a},getCalendarDropDownMenuItems:function(e,t,n){return[g.getCalendarPreviewMenuConfig(t.model||n,this),this.getRemoveItemButton(t)]},getPreviewMenuConfig:function(e){return{text:E("E6WCommonApps.Label.Open"),fonticon:"open",name:"preview-button",className:e.hasViewAccess&&!e.hasViewAccess()?" disabled":"",handler:function(){l.openInApp(e)}}},getCalendarPreviewMenuConfig:function(e,t){return{text:E("E6WCommonApps.Label.Preview"),fonticon:"eye",name:"calendar-preview-button",className:e.hasViewAccess&&!e.hasViewAccess()?" disabled":"",handler:function(){var n=this;i.loadJSDependency("DS/ENOProjectMgmtCommonComponents/views/CalendarPopup").then((function(s){let i={model:e,calendarId:e.get("physicalId")};const o=new s(n,i);o.render(),t.addChildView(o)})).catch((e=>{"scripterror"===e.requireType&&console.error(e.message)}))}}},getDetachMenuConfig:function(e,t){var n=this;return{text:E("E6WCommonApps.Label.Detach"),fonticon:"link-off",name:"detach-button",className:n.normalizedGet(n.model,"canEdit")&&e?"":" hidden",handler:function(){var e=n._config.name;if("commonTaskParent"===e){var s=p.replace(E("E6WCommonApps.Alert.TaskDetach"),{OBJECT_NAME:n.model.get("title")});i.displayWarning(s)}n.model.remove(e,t.index,t.options)}}},getOpenMenuConfig:function(e,n){const s=n||g.getManagementView();var i=s&&s.currentModel===e;return{text:E("E6WCommonApps.Label.Open"),fonticon:"open",name:"open-project-button",className:e.hasViewAccess&&!e.hasViewAccess()||i?"disabled":"",handler:function(){s.collection.add(e),s.skel.setRoute("/projects/"+t.removeBracketLongURI(e.id)+"/"+s._getFacetToOpenOnLoad(e)+"/")}}},getPropertiesMenuConfig:function(e){var t=this;return{text:E("E6WCommonApps.Command.Properties"),fonticon:"attributes",handler:function(){t.objectClick(e.event)},name:"propertiesButton"}},getDividerConfig:function(){return{className:"divider"}},getEditMenuConfig:function(t){var n=e.clone(t||{},!1),s=n.model&&n.model.cid;return{id:s?"infoButton_"+s:"infoButton",text:E("E6WCommonApps.Label.Information"),fonticon:"info",multiEditSameTypes:!0,handler:function(){e.is(n.editHandler,"function")&&n.editHandler.apply(this,arguments)}}},getFlexibleConfig:function(e){var t=e.canEnforce()||!e.hasFetchedAccessData(),n=e.get(m);return void 0===n&&(n=!0),{text:E("E6WCommonApps.Label.flexible"),fonticon:"dependency",className:t?"":"disabled",selectable:!0,selected:!n,handler:function(){var t=E(n?"E6WCommonApps.Alert.ConstraintNotEnforced":"E6WCommonApps.Alert.ConstraintEnforced"),s={};s[m]=!n,e.save(s,{onComplete:function(){i.displaySuccess(t),i.trackPageEvent({eventCategory:"contraint-enforced",eventLabel:"new_enforced_attribute",eventValue:s[m]})},onFailure:function(){i.displayError(E("E6WCommonApps.Error.ConstraintEnforceFailed"))}})}}},getDeleteMenuConfig:function(t,n,s={}){const i=!(t.canDelete(!0)||!t.hasFetchedAccessData())||e.is(t,"isGhost")&&t.isGhost()||s.isShadowMilestoneGate;return{id:`deleteButton_${t.cid}`,multiEditDifferentTypes:!0,multiEditSameTypes:!0,text:E("E6WCommonApps.Label.Delete"),fonticon:"trash",className:i?"disabled":"",disabled:i,handler:n}},getRemoveReferenceConfig:function(e,t){const n=e.canRemove();return{text:E("E6WCommonUI.Label.Remove"),fonticon:"remove",className:n?"":"disabled",handler:function(){e.removeReferenceFromParent({onComplete:function(){i.displaySuccess(E("E6WCommonApps.Alert.RemoveReferenceProjectSuccessful"))},onFailure:function(){i.displayError(E("E6WCommonApps.Alert.RemoveReferenceProjectFailed"))},parent:t})}}},getPinMenuConfig:function(t,n,s={}){const i=t.isFixed(),o=t.canModify(!0)||!t.hasFetchedAccessData(),a="Milestone"===t.getObjectType()&&t.isStartOrEndMilestone(),r=s.isShadowMilestoneGate||!1,l=e.is(t,"isGhost")&&t.isGhost()||r;return{text:E(i?"E6WCommonApps.Label.Unpin":"E6WCommonApps.Label.Pin"),fonticon:i?"pin-off":"pin",className:!o||t.isComplete()||a||l?"disabled":"",handler:n}},getBookmarkURLMenuConfig:function(e){return{id:T,text:E("E6WCommonApps.Label.CopyBookmark"),title:E("E6WCommonApps.Label.CopyBookmark"),fonticon:"link",handler:function(){var t="",n=e.get("physicalId")||e.id;if(e instanceof r)t=l.getDashboardUrl(n);else{let s=e.get(h.UNIQUE_OBJECT_ID_ATTR);s&&(n=s),t=l.getRedirectUrl(n)}i.copyTextToClipboard(t),i.displaySuccess(E("E6WCommonApps.Alert.BookmarkCopied"))}}},getSaveAsTemplateMenuConfig:function(e){var t=this,n=e&&e.isAgile(),s=g.getManagementView();return{id:"saveAsTemplateButton",text:E("E6WCommonApps.Label.SaveAsTemplate"),fonticon:"template",disabled:n||o.isXppViewer(),handler:function(){t.popup&&t.popup.destroy(),t.popup=s.createNewWorkScope(void 0,{selectedModel:e,createFrom:"SaveAsTemplate"})}}},createFromTemplate:function(e){var t=this,n=e&&e.isAgile(),s=g.getManagementView();return{id:"createFromTemplate",text:E("E6WCommonApps.Label.CreateProjectFromTemplate"),fonticon:"template",disabled:n||i.isTemplate(e)&&e.get("state")!==c.PUBLISHED_MATURITY_VALUE,handler:function(){t.popup&&t.popup.destroy(),t.popup=s.createNewWorkScope(void 0,{prefillWithTemplate:e,createFrom:c.CREATE_PROJECT_FROM_TEMPLATE})}}},getDocumentServiceDropDownMenuItems:function(e,t){require(["DS/DocumentCommands/ENOXDocumentCommands"],(n=>{var i=e.get("dscom:Tenant")||enoviaServer.tenant,o=enoviaServer["3DSpace"],a=enoviaServer["3DDashboard"],r=e.get("type")||e.get("@type"),l=s.getDefaultSecurityContext(),d={document:{id:e.get("physicalId"),contextId:l,serviceId:"3DSpace",envId:i,index:1,data:{id:e.get("physicalId"),title:e.get("title")},type:r},platformUrls:{"3DSpace":o,"3DDashboard":a}};d.document.filesCallback=function(n){e._actionsData=n,t(n)};var c=new n;c.init(d);var p=window.enoviaServer&&window.enoviaServer.space;c.render(),(window.enoviaServer&&window.enoviaServer.space)!==p&&(window.enoviaServer.space=p)}))},getDocumentTypeDropDownMenuItems:function(e,t,s){var i=this.options?this.options.docMenuItems:t,o=t.model||s,l=this.getDropDownMenuItems(e,t);if(o instanceof r||o instanceof n&&"3DSpace"===o.serviceHosting&&!o.isDeleted()){var d=g.updateMenuItemsWithDocumentCommands.bind(this,i,l,o);a.fetchParentTypesWithCallback(o,d)}return l},updateMenuItemsWithDocumentCommands:function(e,t,n){var s=n.get("parentTypes");if(s&&s.includes("DOCUMENTS")){var i=t.findIndex((e=>"documentUpdateButton"===e.id)),a=i>0;if(o.isXppViewer()){var r=t.find((e=>"documentUpdateButton"===e.id));a=a&&!(r.className.includes("disabled")||r.className.includes("hidden"))}var l=function(e){i=e.findIndex((e=>"documentUpdateButton"===e.id)),a&&e.splice(i,1)};if(a)if(e.Edit)l(t),t.splice(1,0,e.Edit);else if(e.UndoEdit){if(e.Update){r=t[i];l(t),t.splice(1,0,r)}t.splice(2,0,e.UndoEdit)}e.Preview&&t.find(((n,s)=>{n.name===h.PREVIEW&&(t[s]=e.Preview)}))}return t},createDocumentUpdateModal:function(e,t){this.fileChooserModal=new d({renderTo:widget.body,docModel:e,updateDocumentCallback:t})},findIndex:function(e,t,n){return(e=e&&e.length&&(e.findIndex?e:e.toArray()))&&e.findIndex((e=>e[t]===n))},getManagementView:function(){return this._mgmtView},getPropertyPanelWidth:function(){let e=0;return this._mgmtView&&this._mgmtView.isPropertyPanelOpen&&this._mgmtView.isPropertyPanelOpen()&&(e=this._mgmtView._detailPanel.container.getSize().width),e},getCurrentModel:function(){return this._mgmtView&&this._mgmtView.currentModel},setManagementView:function(e){this._mgmtView=e},COMPLETION_DATE_TASK_FILTER_ATTR:"fromCompletionDate",COMPLETED_TASK_PREF_NAME:"completedTasksDisplayPref",COMPLETED_TASK_FILTER_ALL_DAYS:"all",COMPLETED_TASK_FILTER_30_DAYS:"30"};return g.BOOKMARK_BUTTON=T,g})),define("DS/E6WCommonApps/Checklist/ChecklistItemCollection",["UWA/Core","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],(function(e,t,n){"use strict";return t.extend({_uwaClassName:"ChecklistItemCollection",sync:Function.prototype,getModelsToRemove:function(e){return this.filter((function(t){return!e[t.id]&&!t.keepWhenUpdating}))},getSequenceOrder:function(e){return e.get(n.SEQUENCE_ORDER_ATTR)},comparator:function(e,t){var s=e.get(n.SEQUENCE_ORDER_ATTR_DSLC),i=t.get(n.SEQUENCE_ORDER_ATTR_DSLC);if(void 0!==s&&void 0!==i)return s-i}})})),define("DS/E6WCommonApps/Models/TeamMemberResponsibilityModel",["UWA/Core","UWA/Class/Model","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/MemberUtils","DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/Models/UsersGroupRDFModel","DS/RDFFoundation/Models/LogicalUserModel","DS/RDFFoundation/Models/ResultModel","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l,d){"use strict";var c=d.get.bind(d),p={"dsplan:Viewer":0,"dsplan:Author":1,"dsplan:Leader":2},u=l.extend({_uwaClassName:"TeamMemberResponsibilityModel",idAttribute:"@id",dragDisabled:!0,hasViewAccess:function(){return!0},setup:function(e){this._parent.apply(this,arguments),e.memberPersonModel&&this.listenTo(e.memberPersonModel,"onAnyEvent",(function(e){var t=Array.prototype.slice.call(arguments,1);this.dispatchEvent(e,t)})),e.assignedUserModel&&this.listenTo(e.assignedUserModel,"onAnyEvent",(function(e){var t=Array.prototype.slice.call(arguments,1);this.dispatchEvent(e,t)}))},parse:function(t,n){var s=e.clone(t||{},!1);return this._parent(s,n)},getActualPerson:function(){return this.get("memberPersonModel")instanceof r?this.get("assignedUserModel"):this.get("memberPersonModel")},get:function(e){var t=this._parent.apply(this,arguments);switch(e){case"name":case"userName":return this.get("memberPersonModel")instanceof r?this.get("assignedUserModel")?this.get("assignedUserModel")instanceof o?this.get("assignedUserModel").get("nameAndAccount"):this.get("assignedUserModel").fullName:"":this.get("memberPersonModel")instanceof o?this.get("memberPersonModel").get("nameAndAccount"):this.get("memberPersonModel").fullName;case"nameAndAccount":return this.get("memberPersonModel")instanceof o?this.get("memberPersonModel").get("nameAndAccount"):this.get("title");case"title":return this.get("memberPersonModel")instanceof r?this.get("memberPersonModel").get("name"):this.get("memberPersonModel").fullName;case"type":return this.get("memberPersonModel").getObjectType();case"image":return this.get("memberPersonModel").get("image");case"businessRole":return this.get("memberPersonModel")instanceof r?this.get("memberPersonModel").get("businessRole"):"";case"isBusinessRoleInactive":return this.get("memberPersonModel")instanceof r?this.get("memberPersonModel").get("isBusinessRoleInactive"):"";case"skills":return this.get("memberPersonModel")instanceof r?this.get("memberPersonModel").get("skills"):"";case"personRDFId":case"physicalId":return this.get("memberPersonModel").id;case"dsaccess:accountName":return this.get("memberPersonModel").get("dsaccess:accountName");case"responsibility":return this.getHighestResponsibility();case"responsibilityNLS":return this.getResponsibilityNLS();case"roleAndResponsibilityNLS":return this.getRoleAndResponsibilityNLS();case"projectRoleAndResponsibilityNLS":return this.getRoleAndResponsibilityNLS({excludeBusinessRole:!0});case"userProfileName":return this.get("memberPersonModel")instanceof r?this.get("memberPersonModel").get("name"):""}return t},canBeRemoved:function(e){return!(this.get("memberPersonModel")instanceof r)||"team_members"!==e},setIsOwner:function(e){this.isOwner=e},setIsAssignee:function(e){this.isAssignee=e},getResponsibilityNLS:function(){var e=this.get("responsibility");if(e){var t=s.splitUri(e)[1];return i.isPendingUser(this.get("memberPersonModel"))?c("E6WCommonApps.Label.ResponsibilityDisplayPending."+t):c("E6WCommonApps.Label."+t)}return""},getRoleAndResponsibilityNLS:function(t){let n=e.clone(t||{},!1),s=[];this.get("isAssignee")&&s.push(c("E6WCommonApps.Label.ProjectManager")),this.get("isOwner")&&s.push(c("E6WCommonApps.Label.Owner"));let i=this.get("businessRole");!n.excludeBusinessRole&&i&&s.push(i),s.push(this.getResponsibilityNLS());let o=s.findIndex((e=>""===e));return o>0&&s.splice(o,1),s.join(", ")},isAssignedLogicalUser:function(){return!!this.get("linkedLogicalUser")},toJSON:function(e){var t=this._parent.apply(this,arguments);t.responsibilityNLS=this.get("responsibilityNLS"),t.roleAndResponsibilityNLS=this.get("roleAndResponsibilityNLS"),t.projectRoleAndResponsibilityNLS=this.get("projectRoleAndResponsibilityNLS");let n=e&&e.ancestors||{},s=this.get("memberPersonModel");t.businessRole=this.get("businessRole"),t.isBusinessRoleInactive=this.get("isBusinessRoleInactive"),t.skills=this.get("skills"),n[s.id]?delete t.memberPersonModel:t.memberPersonModel=s.toJSON(e);let i=this.get("parentWorkscopeModel");return i&&!n[i.id]?t.parentWorkscopeModel=i.toJSON(e):delete t.parentWorkscopeModel,t.title=this.get("nameAndAccount"),t.userName=this.get("userName"),t.image=this.get("image"),t.linkedLogicalUser=this.get("linkedLogicalUser"),t.userProfileName=this.get("userProfileName"),t.physicalId=this.get("physicalId"),t},getHighestResponsibility:function(){for(var e=this.get("allResponsibilitiesArray"),t=e[0],n=p[t],s=1;s<e.length;s++){var i=e[s],o=p[i];o>n&&(n=o,t=i)}return t},getTaggerURI:function(){var e=this.get("physicalId")||this.id;return this.isRDF&&(e=this.getTagPrefix()+s.conditionalShortToLongURI(e)),e},isUnassignedLogicalUserMember:function(){return this.get("memberPersonModel")&&this.get("memberPersonModel")instanceof r&&!this.get("assignedUserModel")},isLogicalUserMember:function(){return this.get("memberPersonModel")&&this.get("memberPersonModel")instanceof r},canShowProperties:function(){var e=this.isLogicalUserMember(),t=this.get("memberPersonModel")&&this.get("memberPersonModel")instanceof a;return!e&&!t||this.get("memberPersonModel").canShowProperties()},getTransferObject:function(){return this.get("memberPersonModel").getTransferObject()}});return u.processRawData=function(e,t){for(var o=[],a=Object.keys(e),l=a.length,d=0;d<l;d++){var c=a[d],p=e[c],h=p&&p.member;if(h){let e=h[0]["dsplan:jsType"];var m;"foaf:Person"===e&&(e="pno:Person",(m=h[0]["dsaccess:accountName"])&&i.addUserUIdToMap(i.addIamToURI(m),s.removeBracketLongURI(c)));let a=[];if(h[0].logicalUsers)for(let e=0;e<h[0].logicalUsers.member.length;e++){let t=h[0].logicalUsers.member[e],o=t["@id"],l=s.getObjectById(o);if(!l){let e={mask:i.getPersonMask(),attrs:{workforceRequestId:t["dsplan:requestId"],title:t.title,"dsxplan:jsType":n.LOGICAL_USER_TYPE}};l=s.getObjectForAdding(r,o,e)}a.push(l)}var T=[],E=function(n,i,o){let a=n[0].title,r=u.getAllResponsibilitiesArray(n);return{"@id":s.removeBracketLongURI(i),id:s.removeBracketLongURI(i),type:e,allResponsibilitiesArray:r,parentWorkscopeModel:t,title:a,workforceRequestId:n[0].requestId,assignedUserData:o}};if(e===n.LOGICAL_USER_TYPE)T.push(E(h,c));else{var g=u.getAllResponsibilitiesArray(p.member);let n=g.indexOf("dsplan:Admin");if(-1!==n&&g.splice(n,1),!g.length)continue;let s={id:c,type:e,allResponsibilitiesArray:g,parentWorkscopeModel:t,accountName:m};if(T.push(s),a.length)for(let e=0;e<a.length;e++){let t=h[0].logicalUsers.member[e],n=t["@id"];T.push(E([t],n,s))}}T.forEach((function(e){o.push(u.getMemberObj(e))}))}}return o},u.getAllResponsibilitiesArray=function(e){for(var t=[],n=0;n<e.length;n++){var s=e[n].responsibility?e[n].responsibility:e[n]["dsplan:logicalResponsibility"]["@id"];t.push(s)}return t},u.getMemberObjFromUser=function(e){return{"@id":u.getInstanceId(e.memberPersonModel.id,e.parentWorkscopeModel.id),allResponsibilitiesArray:[n.RESPONSIBILITY_AUTHOR],memberPersonModel:e.memberPersonModel,parentWorkscopeModel:e.parentWorkscopeModel}},u.getMemberObj=function(t){var l;let d={attrs:{"dsxplan:jsType":t.type}};var c,p;d.mask=i.getPersonMask(),d.attrs["dsxplan:jsType"]=t.type,"pno:Person"===t.type?(l=o,d.attrs["dsaccess:accountName"]=t.accountName):t.type===n.LOGICAL_USER_TYPE?(l=r,d.attrs.type=t.type,d.attrs.title=t.title,d.attrs.workforceRequestId=t.workforceRequestId,c=s.getObjectById(t.id)):(l=a,d.attrs["dsaccess:accountName"]=t.accountName),c?(c.set(d.attrs),p=c):(!d.attrs["dsaccess:accountName"]&&t.assignedUserData&&(d.attrs["dsaccess:accountName"]=t.assignedUserData.accountName),p=s.getObjectForAdding(l,t.id,d));var h=t.allResponsibilitiesArray;h&&e.is(h,"string")&&(h=[h]);var m={allResponsibilitiesArray:h,memberPersonModel:p,parentWorkscopeModel:t.parentWorkscopeModel,isOwner:t.parentWorkscopeModel.get(n.OWNER_ATTR)===p,isAssignee:t.parentWorkscopeModel.get(n.ASSIGNEE_ATTR).contains(p)};return t.assignedUserData&&(d.attrs["dsaccess:accountName"]=t.assignedUserData.accountName,m.assignedUserModel=s.getObjectForAdding(o,t.assignedUserData.id,d)),t.linkedLogicalUser?(m.linkedLogicalUser=t.linkedLogicalUser,m["@id"]=u.getInstanceId(t.id,t.parentWorkscopeModel.id,t.linkedLogicalUser.id)):m["@id"]=u.getInstanceId(t.id,t.parentWorkscopeModel.id),m},u.getInstanceId=function(e,t,n){let i;return i=s.getObjectIDFromUserMap(e)?s.getObjectIDFromUserMap(e)+"_"+t:e+"_"+t,n&&(i=i+"_"+n),i},Object.defineProperty(u.prototype,"fetching",{get:function(){return this.get("memberPersonModel").fetching},set:function(e){return this.get("memberPersonModel").fetching=e,e}}),Object.defineProperty(u.prototype,"tagsData",{get:function(){return this.get("memberPersonModel").tagsData}}),Object.defineProperty(u.prototype,"serviceId",{get:function(){return this.get("memberPersonModel").serviceId}}),Object.defineProperty(u.prototype,"fullName",{get:function(){return this.get("name")}}),Object.defineProperty(u.prototype,"serviceHosting",{get:function(){if(this.getActualPerson())return this.getActualPerson().serviceId}}),Object.defineProperty(u.prototype,"physicalId",{get:function(){if(this.getActualPerson())return this.getActualPerson().get("physicalId")}}),Object.defineProperty(u.prototype,"fedSearchIdQuery",{get:function(){if(this.getActualPerson())return this.getActualPerson().idAttributeForFederatedSearch+':"'+this.getActualPerson().getIdForFederatedSearch()+'"'}}),Object.defineProperty(u.prototype,"sourceName",{get:function(){if(this.getActualPerson())return this.getActualPerson().sourceName}}),Object.defineProperty(u.prototype,"ds6w:type",{get:function(){if(this.getActualPerson())return this.getActualPerson().get("ds6w:type")}}),Object.defineProperty(u.prototype,"tenant",{get:function(){if(this.getActualPerson())return this.getActualPerson().tenant}}),u})),define("DS/E6WCommonApps/Views/E6WObjectCardView",["UWA/Core","DS/E6WCommonUI/Views/ObjectCardView","DS/E6WCommonApps/Views/LinkLauncherUtils","DS/E6WCommonApps/SmartSchedulerUtils","DS/E6WCommonApps/Utils/3DSpaceUtils","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/E6WCommonUIConstants","DS/Foundation2/Models/FoundationV2Model","DS/RDFFoundation/Models/ComponentProxyModel","DS/E6WCommonApps/Models/TeamMemberResponsibilityModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/TransientWidget/TransientWidget","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m){"use strict";let T=e=>"Group"!==e.get("type")&&e instanceof l||e instanceof d&&"3DSpace"===e.serviceHosting&&!e.isDeleted();var E=function(e){return!e||!e.hasViewAccess||e.hasViewAccess()},g=function(e){var t=h.get(e);return t===e&&(t=m.get(e)),t},A=[p.WORKSCOPE_PARENT_ATTR,p.PARENT_ATTR,p.COMMON_TASK_PARENT_ATTR],C=t.extend({_uwaClassName:"E6WObjectCardView",getPropertiesButton:function(t){var n=this._parent.apply(this,arguments);return e.extend(n,C.getPropertiesButtonInfo(t.model)),n},getRemoveItemButton:function(t){var n=e.clone(t||{},!1).model;if(n){var i=!1,o=n.getObjectType&&n.getObjectType();if(E(n)&&("Project"!==o&&"Enterprise Project"!==o||-1===A.indexOf(this._config.name)?"Task"===o&&"commonTaskParent"===this._config.name&&(i=!0):i=!0,i))return s.getDetachMenuConfig.call(this,Boolean(this._config.readWrite),t)}var a=this._parent.apply(this,arguments);let r=this._config.disableRemove||n&&!n.canBeRemoved(this._config.name);r=this._config.name===p.TEAM_MEMBERS&&n.get("isOwner")?"true":r;let l=null===a.className&&"scope"===t.options.config.name;var d;return a.className=null===a.className&&(l||(d=this.model.model)&&(d.canModify?d.canModify(!0):d.get("canEdit")))&&!r?"":"disabled",a=this.addClassNamesToButton(a)},createMenuButtons:function(t){const n=e.clone(t||{},!1);n.zIndex=1050;var s=n.model;if(s)if(T(s)){var o=this._parent.bind(this,n);i.fetchParentTypesWithCallback(s,o)}else this._parent(n);else this._parent(n)},createAndShowContextMenu:function(e){e.preventDefault(),this._createDropDownMenu(e)},addOpenAndOpenWith:function(e){var t=n.polymorphicOpenMenuItem(e,"openAppInCompass",(function(e){this.selectModelInCompass(e.model)}),this);t&&this.dropdownMenu.addItem(t),this._config.noOpenWith||"person"===this._config.type||this.addOpenWith(e.model)},getUpdateButton:function(e){var t=this._parent.apply(this,arguments),n=e.model&&e.model.get("files"),s=this.normalizedGet(this.model,"canEdit"),i=(!n||n&&"object"==typeof n&&1===n.length)&&s;return t.className=null===t.className&&i?"":"disabled",t=this.addClassNamesToButton(t)},getDownloadButton:function(e){var t=this._parent.apply(this,arguments);return t.className=null===t.className&&E(e.model)?"":"disabled",t=this.addClassNamesToButton(t)},getGroupViewerContainer:function(){if("ENOTASK_AP"===widget.getValue("appId"))return this._parentView._parentView._parentView.container;var e=s.getManagementView();return e&&e.container},addClassNamesToButton:function(e){return e.className+=e.className&&e.className.contains("disabled")&&"propertiesButton"!==e.name?" hidden":"",e},getDropDownMenuItems:function(t,i){var o=e.clone(i||{},!1),r=o.model,l=!!r&&n.isSolidWorksFile(r);o.documentUpdateHandler=s.createDocumentUpdateModal;var d=r&&this.normalizedGet(r,"dsxplan:jsType");o.isUrl="dsplan:url"===d||"URL"===this.normalizedGet(r,"type");var c=this._parent(t&&!l,o);if(r&&E(r)){var u,h=r.getObjectType&&("Project"===r.getObjectType()||"Enterprise Project"===r.getObjectType()),m=r.getObjectType&&"swym:Community"===r.getObjectType(),T="3dportfolio"===r.serviceHosting,A=c.findIndex((function(e){return"detach-button"===e.name})),C=s.getManagementView(),_=widget.getValue("appId");h&&(_===p.APP_3DPLAN||a.isXppViewer())?((u=C?s.getOpenMenuConfig(r,C):s.getPreviewMenuConfig(r,h)).text=g("E6WCommonApps.Label.SetAsRoot"),u.fonticon="tree-view-root"):(m||T)&&(u=s.getPreviewMenuConfig(r,h)),u&&(-1===A?c.push(u):c.splice(A,0,u))}return c},_showDropDownMenu:function(e){this._parent(e,!0)},_addDropDownMenuListener:function(e){for(var t=this,n=this.getElements(".fonticon-down-open"),s=n.length,i=0;i<s;i++){var o=n[i];this.model.get("_isSourcingTask")&&"route"===o.getAttribute("data-field-name")?o.addClassName("hide"):o.getClosest("button").addEvent("click",(function(e){t._createDropDownMenu(e)}))}},_createDropDownMenu:function(t){var n=this,a=e.Event.getElement(t);this._lastDropdownEvent=t;var r=a.getClosest(".object-card").getAttribute("data-id"),l=function(e){n.createMenu(t,{target:a}),n.dropdownMenu&&o.showAndUpdateContextualDropdownMenuPosition(n.dropdownMenu,t,!0),n.listenToOnce(n._parentView,"onScroll",(()=>{n.dropdownMenu&&n.dropdownMenu.hide()})),["onDeleteAccessChanged","onModifyAccessChanged"].forEach((function(t){n.listenTo(e,t,n._rebuildDropdownMenu.bind(n))}))};if(r){var d=n.getActiveModel(r);T(d)?i.fetchParentTypesWithCallback(d,(function(){var i=d.get("parentTypes");if(i&&i.includes("DOCUMENTS")){s.getDocumentServiceDropDownMenuItems(d,(function(e){n.options.docMenuItems=e,l(d)})),n.dropdownMenu&&n.dropdownMenu.destroy(),n.createDropdownMenu({target:e.Event.getElement(t),items:[{text:g("E6WCommonUI.Info.LoadingData")}]}),o.showAndUpdateContextualDropdownMenuPosition(n.dropdownMenu,t,!0)}else l(d)})):l(d)}else l(this.model)},_rebuildDropdownMenu:function(){this.dropdownMenu&&(this.dropdownMenu.destroy(),this.dropdownMenu=null),this._lastDropdownEvent&&this._createDropDownMenu(this._lastDropdownEvent)},_submodelCallback:function(){this._parent.apply(this,arguments);var e={config:this._config},t=this.model;this.model.dispatchEvent("onChange",[t,e])},destroy:function(){o.destroyOpenWith(this),this._parent.apply(this,arguments)},validateDroppedObject:function(e){e.serviceId,e.objectType,this._config.name;let t=this._config.validateDroppedObject;if(t){let n=t(e,this._config);if(n)return n}return this._parent.apply(this,arguments)}});return C.getPropertiesButtonInfo=function(e){return n.showPreview(e)?{text:g("E6WCommonApps.Label.Preview"),name:p.PREVIEW,fonticon:"eye"}:{text:g("E6WCommonUI.Label.Properties"),fonticon:"attributes"}},C})),define("DS/E6WCommonApps/Models/BaselineModel",["UWA/Core","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],(function(e,t,n,s){"use strict";const i=["start","end","actualStart","actualEnd"],o="Open",a="Done",r="Task",l="Milestone",d="Gate";var c=t.extend({init:function(t,n){const s=e.clone(t||{},!1);s.forceDslc=!0,this._parent(s,n)},loadFCSFile:function(t){let s=e.clone(t||{});this._modelMap||(this._loading=!0,n.downloadFCSFile(this.id,{onComplete:e=>{this._parseFCSFile(e),s.onComplete&&t.onComplete(),this._loading=!1},onFailure:()=>{this._loading=!1,s.onFailure&&s.onFailure()}}))},_parseFCSFile:function(t){let s=JSON.parse(t);this._modelMap={},s.elements.forEach((t=>{let s=e.clone(t||{},!1);i.forEach((e=>{s[e]&&(s[e]=new Date(s[e]))})),this._modelMap[n.removeBracketLongURI(t.id)]=s}))},isLoading:function(){return this._loading},hasLoadedFCSData:function(){return Boolean(this._modelMap)},getDataForModel:function(e){if(this.hasLoadedFCSData())return this.getDataForId(e.id)},getDataForId:function(t){let n=this._modelMap?this._modelMap[t]:"";if(n){let t=e.clone(n);return n.type===r&&n.state!==o||n.type===d&&n.state===a||n.type===l&&n.state===a?t.start=n.actualStart:t.start=n.start,t.end=n.state===a?n.actualEnd:n.end,t}},getChangedModels:function(e){var t=[];return e.forEach((e=>{const s=this.getDataForId(e);if(this._modelMap&&!this._modelMap[e])-1===t.indexOf(e)&&t.push(e);else{const i=n.getObjectById(e);!s||s.type!==r&&s.type!==l&&s.type!==d||this.filterScheduleElements(s,i,t,e)}})),t},filterScheduleElements:function(e,t,n,s){if(t&&e){var i=!1;i=this.areSameDescription(t,e);const o=t.getStartDate(),a=e.start,r=t.getEndDate(),l=e.end;!i&&o&&a&&(i=!this.areSameDate(o,a)),!i&&r&&l&&(i=!this.areSameDate(r,l)),i&&-1===n.indexOf(s)&&n.push(s)}},areSameDescription:function(e,t){var n=e.get(s.DSLC_DESCRIPTION_ATTR);n=n||"";var i=t.description;return n!==(i=i||"")},areSameDate:function(e,t){var n=!1;let s=new Date(e).getTime(),i=new Date(t).getTime();return Math.abs(s-i)<18e4&&(n=!0),n},hasViewAccess:()=>!0});return c.COMPLETE=a,c.OPEN=o,c.TASK=r,c})),define("DS/E6WCommonApps/Preferences",["UWA/Core","UWA/Class/Events","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/UserPreferences","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonApps/PreferenceUtils","DS/E6WCommonApps/Models/BaselineModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/SmartSchedulerUtils"],(function(e,t,n,s,i,o,a,r,l,d){"use strict";const c=function(e,t,n){if(t!==n){const s=E[e.replace(g._currentProjectId,"")];g.dispatchEvent(`onChange:${s}`,[t,n])}};var p=a.get,u=function(e,t){const n=p(e);a.set(e,t),c(e,n,t)},h=a.parse;const m="projectChanged",T={DATE_RANGE:"timeline-daterange1",DATE_RANGE_RESOURCE:"timeline-daterange1-resource",DIVIDER:"timeline-divider",DIVIDER_RESOURCE:"timeline-divider-resource",FONT_SIZE:"timeline-fontsize",ZOOM:"timeline-zoom",EXPAND_LIST:"timeline-expand-list",SCROLL_TOP:"timeline-scroll-top",TIME_MACHINE:"timeline-time-machine",LEFT_MARGIN:"timeline-left-margin1",SHOW_TIME_MACHINE:"show-time-machine",SHOW_ACTIONBAR:"show-action-bar",SHOW_CONSTRAINTS:"show-constraints",SHOW_COMPRESSION:"show-compression",SHOW_ACTUAL_DATES:"show-actual-dates",HIDE_WEEKLABEL:"hide-weeklabel",EXPAND_IDS:"expand-ids",RESOURCE_EXPAND_IDS:"resource-expand-ids",COLLAPSED_IDS:"collapsed-ids",HIDE_TASKS:"hide-tasks",USE_FTS_ON_SCHEDULE_TAB:"useFTSonScheduleTab",SHOW_SUMMARY_TIMELINE:"show-summary-timeline",SCHEDULETAB_MULTI_SELECT_MODE:"schedule-multi-select-mode",SHOW_BASELINES:"show-baselines",SHOW_PROGRESSLINES:"show-progresslines",ACTIVE_BASELINE:"active-baseline",SCHEDULE_TAGGER_FILTER:"scheduleTaggerFilter",RESOURCE_TAGGER_FILTER:"resourceTaggerFilter",HIGHLIGHT_CRITCIAL_PATH:"highlightCriticalPath",EXEC_ASSIST:"execAssistant",FILTER_CRITCIAL_PATH:"filterCriticalPath",HIDE_ASSIGNEES:"hideAssignees",WORK_HOURS:"workHours",ENABLE_CALENDAR:"enableCalendar",RESOURCE_INCLUDE_SUBPROJECTS:"includeSubprojectsResource",RESOURCE_INCLUDE_OTHER:"includeOtherProjectsResource",FILTERED_ITERATIONS:"filteredIterations",ROADMAP_PREFS:"roadmapPrefs",ITERATION_VIEW:"iterationView",ITERATION_VIEW_EXPANDED:"iterationViewExpanded",IGNORE_DELAY_FACTORS:"ignoreDelayFactors",TREE_STATE:"tree-state",TREE_STATE_RESOURCE:"tree-state-resource",GRID_DIVIDER_POSITION:"grid-divider-position"},E={};var g=new(t.extend({POSTFIX:"",PREF_KEYS:T,setCurrentProject:function(t){if(this.PREF_KEYS=e.clone(T,!0),Object.keys(this.PREF_KEYS).forEach((function(e){this[e]=this[e]+t,E[T[e]]=e}),this.PREF_KEYS),void 0===this.useFTSonScheduleTab()){this.setUseFTSonScheduleTab(!1)}void 0===h(p(this.PREF_KEYS.EXPAND_IDS))&&this.setExpandIds([t]),void 0===h(p(this.PREF_KEYS.RESOURCE_EXPAND_IDS))&&this.setResourceExpandIds([t]),o.isXppViewer()&&void 0===h(p(this.PREF_KEYS.SHOW_CONSTRAINTS))&&this.setShowConstraints(!1);const n=this._currentProjectId!==t;this._currentProjectId=t,n&&this.dispatchEvent(m)},getCurrentProject:function(){return"ScenarioModel"===n.getObjectById(this._currentProjectId)?._uwaClassName?n.getObjectById(this._currentProjectId).get(l.SCENARIOS_PARENT_ATTR):n.getObjectById(this._currentProjectId)},getDateRange:function(){return this.isResourceFacet()?h(p(this.PREF_KEYS.DATE_RANGE_RESOURCE)):h(p(this.PREF_KEYS.DATE_RANGE))},setDateRange:function(e){this.isResourceFacet()&&u(this.PREF_KEYS.DATE_RANGE_RESOURCE,JSON.stringify(e)),u(this.PREF_KEYS.DATE_RANGE,JSON.stringify(e))},isResourceFacet:function(){return(widget.getValue("selectedProgramAndFilter")||"").contains("resource")},isScheduleFacet:function(){return(widget.getValue("selectedProgramAndFilter")||"").contains("schedule")},getDividerPositionAsTimelinePercentage:function(){return this.isResourceFacet()?h(p(this.PREF_KEYS.DIVIDER_RESOURCE)):h(p(this.PREF_KEYS.DIVIDER))},setDividerPositionAsTimelinePercentage:function(e){this.isResourceFacet()?u(this.PREF_KEYS.DIVIDER_RESOURCE,JSON.stringify(e)):u(this.PREF_KEYS.DIVIDER,JSON.stringify(e))},getFontSize:function(){return h(p(this.PREF_KEYS.FONT_SIZE))},setFontSize:function(e){u(this.PREF_KEYS.FONT_SIZE,JSON.stringify(e))},getTreeState:function(){return this.isResourceFacet()?h(p(this.PREF_KEYS.TREE_STATE_RESOURCE)):h(p(this.PREF_KEYS.TREE_STATE))},setTreeState:function(e){this.isResourceFacet()?u(this.PREF_KEYS.TREE_STATE_RESOURCE,JSON.stringify(e)):u(this.PREF_KEYS.TREE_STATE,JSON.stringify(e))},getZoomLevel:function(){return h(p(this.PREF_KEYS.ZOOM))},setZoomLevel:function(e){u(this.PREF_KEYS.ZOOM,JSON.stringify(e))},getExpandList:function(){return h(p(this.PREF_KEYS.EXPAND_LIST))},setExpandList:function(e){u(this.PREF_KEYS.EXPAND_LIST,JSON.stringify(e))},getScrollTop:function(){return h(p(this.PREF_KEYS.SCROLL_TOP))},setScrollTop:function(e){u(this.PREF_KEYS.SCROLL_TOP,JSON.stringify(e))},getTimeMachineRange:function(){return h(p(this.PREF_KEYS.TIME_MACHINE))},setTimeMachineRange:function(e){u(this.PREF_KEYS.TIME_MACHINE,JSON.stringify(e))},getShowTimeMachine:function(){return h(p(this.PREF_KEYS.SHOW_TIME_MACHINE))},setShowTimeMachine:function(e){u(this.PREF_KEYS.SHOW_TIME_MACHINE,JSON.stringify(!0===e))},getShowActionBar:function(){return h(p(this.PREF_KEYS.SHOW_ACTIONBAR))},setShowActionBar:function(e){u(this.PREF_KEYS.SHOW_ACTIONBAR,JSON.stringify(!0===e))},getShowConstraints:function(e){return!e&&!1!==h(p(this.PREF_KEYS.SHOW_CONSTRAINTS))},setShowConstraints:function(e){u(this.PREF_KEYS.SHOW_CONSTRAINTS,JSON.stringify(!0===e))},getShowCompression:function(){return!this.isResourceFacet()&&!1!==h(p(this.PREF_KEYS.SHOW_COMPRESSION))},setShowCompression:function(e){u(this.PREF_KEYS.SHOW_COMPRESSION,JSON.stringify(!0===e))},getShowActualDates:function(){if(this.isResourceFacet())return!1;var e=h(p(this.PREF_KEYS.SHOW_ACTUAL_DATES));return Boolean(e)},getHideWeekLabel:function(){return!1!==s.get(s.HIDE_WEEK)},setHideWeekLabel:function(e){const t=this.getHideWeekLabel();s.set(s.HIDE_WEEK,Boolean(e)),c(g.PREF_KEYS.HIDE_WEEKLABEL,t,e)},setExpandIds:function(e){u(this.PREF_KEYS.EXPAND_IDS,JSON.stringify(e))},getExpandIds:function(){return h(p(this.PREF_KEYS.EXPAND_IDS))||[]},setIgnoredDelayFactors:function(e){u(this.PREF_KEYS.IGNORE_DELAY_FACTORS,JSON.stringify(e))},getIgnoredDelayFactors:function(){return h(p(this.PREF_KEYS.IGNORE_DELAY_FACTORS))||["description","attachments","deliverables"]},setResourceExpandIds:function(e){u(this.PREF_KEYS.RESOURCE_EXPAND_IDS,JSON.stringify(e))},getResourceExpandIds:function(){return h(p(this.PREF_KEYS.RESOURCE_EXPAND_IDS))||[]},setCollapsedIds:function(e){u(this.PREF_KEYS.COLLAPSED_IDS,JSON.stringify(e))},getCollapsedIds:function(){return h(p(this.PREF_KEYS.COLLAPSED_IDS))||[]},setHideTasks:function(e){u(this.PREF_KEYS.HIDE_TASKS,JSON.stringify(!0===e))},getHideTasks:function(){var e=h(p(this.PREF_KEYS.HIDE_TASKS));return void 0===e&&(e=!1),e},getHighlightCriticalPath:function(){return!this.isResourceFacet()&&(h(p(this.PREF_KEYS.HIGHLIGHT_CRITCIAL_PATH))||!1)},setHighlightCriticalPath:function(e){u(this.PREF_KEYS.HIGHLIGHT_CRITCIAL_PATH,JSON.stringify(e))},getExecutionAssisstant:function(){return!this.isResourceFacet()&&(h(p(this.PREF_KEYS.EXEC_ASSIST))||!1)},setExecutionAssisstant:function(e){u(this.PREF_KEYS.EXEC_ASSIST,JSON.stringify(e))},getCriticalPathFilters:function(){return!this.isResourceFacet()&&(h(p(this.PREF_KEYS.FILTER_CRITCIAL_PATH))||!1)},setCriticalPathFilters:function(e){u(this.PREF_KEYS.FILTER_CRITCIAL_PATH,JSON.stringify(e))},setWorkHours:function(e){u(this.PREF_KEYS.WORK_HOURS,e)},getWorkHours:function(){return h(p(this.PREF_KEYS.WORK_HOURS))||8},useFTSonScheduleTab:function(){return h(p(this.PREF_KEYS.USE_FTS_ON_SCHEDULE_TAB))},setUseFTSonScheduleTab:function(e){u(this.PREF_KEYS.USE_FTS_ON_SCHEDULE_TAB,JSON.stringify(e)),this.dispatchEvent("onChange:"+T.USE_FTS_ON_SCHEDULE_TAB)},getShowSummaryTimeline:function(){return h(p(this.PREF_KEYS.SHOW_SUMMARY_TIMELINE))},setShowSummaryTimeline:function(e){u(this.PREF_KEYS.SHOW_SUMMARY_TIMELINE,JSON.stringify(e))},toggleScheduleTabMultiSelectMode:function(e){if(!0===e)this[this.PREF_KEYS.SCHEDULETAB_MULTI_SELECT_MODE]=!0;else if(!1===e)this[this.PREF_KEYS.SCHEDULETAB_MULTI_SELECT_MODE]=!1;else{var t=this.getScheduleTabMultiSelectMode();this[this.PREF_KEYS.SCHEDULETAB_MULTI_SELECT_MODE]=!t}return this[this.PREF_KEYS.SCHEDULETAB_MULTI_SELECT_MODE]},getScheduleTabMultiSelectMode:function(){return!this.isResourceFacet()&&(this.isScheduleFacet()&&this[this.PREF_KEYS.SCHEDULETAB_MULTI_SELECT_MODE])},setShowBaselines:function(e){u(this.PREF_KEYS.SHOW_BASELINES,JSON.stringify(e))},getShowBaselines:function(){return!this.isResourceFacet()&&h(p(this.PREF_KEYS.SHOW_BASELINES))},setShowProgresslines:function(e){u(this.PREF_KEYS.SHOW_PROGRESSLINES,JSON.stringify(e))},getShowProgresslines:function(){return!this.isResourceFacet()&&h(p(this.PREF_KEYS.SHOW_PROGRESSLINES))},setActiveBaselineModel:function(e){let t=e?e.id:void 0;u(this.PREF_KEYS.ACTIVE_BASELINE,JSON.stringify(t))},getActiveBaselineModel:function(){let e=h(p(this.PREF_KEYS.ACTIVE_BASELINE));if(e)return n.getObjectForAdding(r,e,{})},getBaselineDataForModelToRender:function(e){const t=g.getActiveBaselineModel(),n=t&&t.getDataForModel(e);return g.getShowBaselines()?n:void 0},getBaselineFormattedDate:function(e,t){let n=this.getBaselineDataForModelToRender(t);if(n)return i.getIntlDateFormat(n[e])},setTaggerFilters:function(e){this.isResourceFacet()?this[this.PREF_KEYS.RESOURCE_TAGGER_FILTER]=e:this[this.PREF_KEYS.SCHEDULE_TAGGER_FILTER]=e},getTaggerFilters:function(){return this.isResourceFacet()?this[this.PREF_KEYS.RESOURCE_TAGGER_FILTER]:this[this.PREF_KEYS.SCHEDULE_TAGGER_FILTER]},showScheduleElement:function(e){var t=this.getTaggerFilters();const s=!t||t[e];return this.isResourceFacet()?s:s&&(!this.getHideTasks()||!i.isTask(n.getObjectById(e)?.getObjectType()))},showScheduleElementModel:function(e){return!(this.getHideTasks()&&i.isTask(e.getObjectType()))&&this.showScheduleElement(e.id)},getHideAssignees:function(){return h(p(this.PREF_KEYS.HIDE_ASSIGNEES))},setHideAssignees:function(e){u(this.PREF_KEYS.HIDE_ASSIGNEES,JSON.stringify(!0===e))},isCalendarEnabled:function(){return window.widget&&window.widget.getValue("enableCalendar")},validateCurrentProject:function(){try{const e=d.getManagementView().currentModel||d.getManagementView().collection.first();e&&this._currentProjectId!==e.id&&this.setCurrentProject(e.id)}catch(e){console.error(e)}},set:function(e,t){this.validateCurrentProject(),u(this.PREF_KEYS[e],t)},get:function(e){this.validateCurrentProject();const t=p(this.PREF_KEYS[e]);return void 0!==t?t:g.DEFAULT_VALUES[e]},formatDate:function(e){return e&&e.setHours(0,0,0,0),i.DATE_FORMAT.format(e)+this.getWeekNumber(e)},getWeekNumber:s.getWeekNumber}));return g.KEYS=T,Object.keys(g.KEYS).forEach((e=>g[e]=e)),g.DEFAULT_VALUES={[g.RESOURCE_INCLUDE_SUBPROJECTS]:!0},g.PROJECT_CHANGED=m,g})),define("DS/E6WCommonApps/Models/MultiSelectToolbarMixin",["UWA/Core","DS/UIKIT/Tooltip","DS/UIKIT/DropdownMenu","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Preferences"],(function(e,t,n,s,i){"use strict";return{toggleMultiSelectModeBtn:function(e,t){!0===t?(e.toggleClassName("fonticon-select-off",!1),e.toggleClassName("fonticon-select-on",!0)):!1===t?(e.toggleClassName("fonticon-select-on",!1),e.toggleClassName("fonticon-select-off",!0)):(e.toggleClassName("fonticon-select-off"),e.toggleClassName("fonticon-select-on"))},getMultiSelectModeToolbarEle:function(){let n=this._multiSelectMode?"fonticon-select-on":"fonticon-select-off";var i=e.createElement("span",{class:"fonticon "+n+" item-select",id:"MultiSelect"});i.set({events:{click:this.onMultiSelectClick.bind(this)}});return{button:i,tooltip:new t({target:i,body:s.i18n("E6WCommonUI.Label.MultiSelect"),position:"bottom"})}},getSelectedCardsCountToolbarEle:function(){let t=this._selectedModels&&this._selectedModels.length||"";return e.createElement("a",{class:"fonticon selected-cards-count item-select",id:"SelectedCardsCount",html:t})},getMultiSelectDropDownMenu:function(e,t){return new n({target:e.target,items:this.getMenuItems(t),events:{onClick:this.onMultiSelectionDropDownClick.bind(this)}})},onMultiSelectionDropDownClick:function(e,t){"SelectAll"===t.id?this.onSelectAll():"UnselectAll"===t.id?this.onUnselectAll():"multiSelect"===t.id?this.onMultiSelectClick(e):"EditSelected"===t.id&&this.editSelected()}}})),define("DS/E6WCommonApps/Models/AddTaskMixin",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Preferences","DS/RDFFoundation/RDFUtils"],(function(e,t,n,s){"use strict";var i="dsxplan:usesCalendar",o={addTask:function(n,s){var i=e.clone(n||{},!1),o=this.getDefaultTaskAttributes(),a="RDFTaskModel"===this._uwaClassName?"dsxplan:hasSubtask":"dsxplan:hasTask";o[t.SEQUENCE_ORDER_ATTR]=this._getDefaultSequenceOrderForAttribute(a);var r=i[t.DURATION_MIN];e.is(r,"number")&&(i[t.DURATION_MIN]=this.getDurationString(r));var l=i[t.DURATION_MAX];e.is(l,"number")&&(i[t.DURATION_MAX]=this.getDurationString(l)),e.extend(o,i);var d=e.clone(s||{},!1);d._defaultModel=undefined;var c=d.isToBacklog?"dsplan:hasBacklogTask":this.TASK_RELATION_ATTR;return this._addScheduleElement(c,o,d)},getDefaultTaskAttributes:function(){var e=new Date,n={};return n["@type"]=t.TASK_RDF_TYPE,n["dsxplan:jsType"]="dsplan:Task",n[t.TITLE_ATTR]="Task",n[t.DURATION_MIN]=this.getDurationString(1),n[t.DURATION_MAX]=this.getDurationString(1),n[t.STARTDATE_ATTR]=e,n[t.ENDDATE_ATTR]=new Date(e.getTime()+864e5),n[t.COMPLETE_PERCENT_ATTR]=0,n[t.PRIORITY_ATTR]={"@id":"dsxplan:Medium"},n},getDurationString:function(e){var t=n.getWorkHours();return s.millisecondsToXsdDayTimeDuration(parseFloat(e)*t*60*60*1e3)},_addScheduleElement:function(n,s,o){var a=e.clone(s||{},!1),r=window.enoviaServer&&enoviaServer.useFD01CodeFor3DPlan?"Open":{"@id":"dsxplan:Open"};a[t.DESCRIPTION_ATTR]=a[t.DESCRIPTION_ATTR]||"",a[t.STATE_ATTR]=a[t.STATE_ATTR]||r,a[t.CONTENT_REPOSITORY]=a[t.CONTENT_REPOSITORY]||this.get(t.CONTENT_REPOSITORY),a[i]=this.get(i),this.isDSLC()&&(n=this.dslcMapping[n]);var l=this.addModelToAttributeWithCollection(n,a,o);return this._registerAsElementParent(l,n),l},_getDefaultSequenceOrderForAttribute:function(e){var t=Math.random(),n=o.RapidRDFModelRegistry?o.RapidRDFModelRegistry.getRapidModelByURI(this.id):void 0,s=n||this;if(s.getRDFModel()&&s.getRDFModel().hasFetchedAttribute(e))return this.computeAndReturnCorrectSequenceNumber(t,s.getRDFModel(),e)},computeAndReturnCorrectSequenceNumber:function(e,n,s){var i=n.get(s).last();return i&&(void 0===(e=i.get(t.SEQUENCE_ORDER_ATTR_DSLC))&&(e=0,i.rdfModel&&(e=i.rdfModel.get(t.SEQUENCE_ORDER_ATTR_DSLC))),e+=Math.random()),e},getDefaultSequenceOrderForReference:function(){var e=0;if(this.get("dsplan:referenceConfig")){var n=JSON.parse(this.get("dsplan:referenceConfig")),s=Object.values(n);e=s.length?Math.max(s):0}var i=this.get(t.CHILDREN_ATTR),o=0;i.size()&&(o=i.last().get(t.SEQUENCE_ORDER_ATTR_DSLC));var a=Math.max(parseFloat(e),parseFloat(o));return void 0===a&&(a=0),a+=Math.random()}};return o})),define("DS/E6WCommonApps/E6WNonWorkingDayIterator",["UWA/Core","UWA/Class/Events","DS/E6WCommonApps/Constants","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Preferences","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/DateUtils","text!DS/E6WCommonApps/assets/CalendarData.json"],(function(e,t,n,s,i,o,a,r){"use strict";return t.extend({init:function(t){const n=e.clone(t||{},!1);this._workingHours={},this._avgWorkingHours=0,this._totalWorkHours=0,this._recurringNonWorkingDays=[],this._staticHolidayEvents={},this._variableHolidayEvents={},this._variableHolidayDates=[],this._weeklyHolidays={},this._dailyHolidays=[],this._hasCalendar=!1,this._rootProjectId=t&&t.rootProject&&t.rootProject.id,this._dateline&&this._dateline.listenToOnParseCalendarData(),t.loadCalendar&&this.getCalendarData(n.ajax),t.loadDefaultCalendar&&this._parseCalendarData(null),t.rootProject&&!t.loadCalendar&&this._parseFromProjectNWD()},_parseFromProjectNWD:function(){if(this._rootProjectId){const e=o.getObjectById(this._rootProjectId);this._parseCalendarData(e.getNonWorkingDayIterator()._rawCalendarData,{silent:!0})}},_isCalendarHoliday:function(e,t){if(e){let s=new Date(t).getMonth();if(!this._hasCalendar)return"Yearly"!==e.relelements.Frequency||n.MONTH_LONG_NAMES.indexOf(e.relelements["Month Of Year"])===s;if("Yearly"===e.frequency&&n.MONTH_LONG_NAMES.indexOf(e.monthOfYear)!==s)return!1;if(t>=e.startDate&&t<=e.endDate)return!0}return!1},_isHoliday:function(e){const t=a._toISOStringIgnoringUTC(e);var s=!1;if(this._dailyHolidays.forEach((e=>{e.startDate&&e.endDate&&t.substring(0,10)>=e.startDate.substring(0,10)&&t.substring(0,10)<=e.endDate.substring(0,10)&&(s=!0)})),s)return!0;if(0!==Object.keys(this._weeklyHolidays).length){const s=this._weeklyHolidays[n.DAY_SHORT_NAMES[e.getDay()]];if(s&&0!==s.length){var i=!1;return s.forEach((e=>{t>=e.startDate&&t<=e.endDate&&(i=!0)})),i}}var o=String(e.getDate()),r=String(e.getMonth());if(0!==Object.keys(this._staticHolidayEvents).length){var l=this._staticHolidayEvents[`${o}-${r}`]?this._staticHolidayEvents[`${o}-${r}`]:this._staticHolidayEvents[`${o}-00`];if(this._isCalendarHoliday(l,t))return!0}if(0!==Object.keys(this._variableHolidayEvents).length){var d=`${["First","Second","Third","Fourth","Last"][Math.ceil(o/7)-1]}`,c=`${d}-${n.DAY_LONG_NAMES[e.getDay()]}`;if("Fourth"===d&&!this._variableHolidayEvents[c]){let t=new Date(e);t.setDate(t.getDate()+7),t.getMonth()!==e.getMonth()&&(c=c.replace("Fourth","Last"))}const s=this._variableHolidayEvents[c];if(this._isCalendarHoliday(s,t))return!0}return!1},isNWD:function(e){return-1!==this._recurringNonWorkingDays.indexOf(e.getDay())},countWorkingDays:function(e,t){var n=new Date(e.getTime());let s=0;for(;n.getTime()<=t.getTime();){this._isHoliday(n)||this.isNWD(n)||s++;var i=new Date(n);i.setDate(n.getDate()+1),n=i}return s},getTimeFromWorkingHours:function(e){var t=e.split(/[-,]+/),n=Object.create(null);n.hours=parseInt(t[0].slice(0,2)),n.minutes=parseInt(t[0].slice(2,4)),n.totalMinutes=60*n.hours+n.minutes;var s=Object.create(null);s.hours=parseInt(t[t.length-1].slice(0,2)),s.minutes=parseInt(t[t.length-1].slice(2,4)),s.totalMinutes=60*s.hours+s.minutes;let i={start:n,end:s};if(t.length>2){var o=Object.create(null);o.hours=parseInt(t[1].slice(0,2)),o.minutes=parseInt(t[1].slice(2,4)),o.totalMinutes=60*o.hours+o.minutes,i.endMorning=o;var a=Object.create(null);a.hours=parseInt(t[2].slice(0,2)),a.minutes=parseInt(t[2].slice(2,4)),a.seconds=0,a.totalMinutes=60*a.hours+a.minutes,i.startAfternoon=a,i.recessDuration=a.totalMinutes-o.totalMinutes}return i},getCalendarData:function(e){var t=this;const n=o.expandUrl("invoke/dsplan:getScheduleCalendar");(e||o.request)(n,{method:"POST",headers:{"Content-Type":"application/json"},type:"json",data:JSON.stringify({ProjectList:this._rootProjectId?[this._rootProjectId]:[]}),onComplete:function(e){t._parseCalendarData(e["@value"])},onFailure:function(){t._parseCalendarData(null)}})},_addHoliday:function(e){if("Daily"===e.frequency)return void this._dailyHolidays.push(e);if("Weekly"===e.frequency&&e.daysOfWeek)return void e.daysOfWeek.split(",").forEach((t=>{this._weeklyHolidays[t]?this._weeklyHolidays[t].push(e):""!==t&&(this._weeklyHolidays[t]=[e])}));const t=e.dayOfMonth||e.relelements["Day Of Month"];if("0"!==t)if("Monthly"===e.frequency)this._staticHolidayEvents[`${t}-00`]=e;else{const i=e.monthOfYear||e.relelements["Month Of Year"];var s=n.MONTH_LONG_NAMES.indexOf(i);this._staticHolidayEvents[`${t}-${s}`]=e}else{const t=e.weekOfMonth||e.relelements["Week Of Month"],n=e.dayOfWeek||e.relelements["Day Of Week"];this._variableHolidayEvents[`${t}-${n}`]=e}},_parseCalendarData:function(e,t){const n={...t||{}};var a,l=this;if(this._rawCalendarData=e,e){l._hasCalendar=!0;let t=(a=e[Object.keys(e)[0]].data.member[0]).workweek.member;for(const e in t)if("Non Working"===t[e].workdayType)l._recurringNonWorkingDays.push(Number(e));else{let n=l.getTimeFromWorkingHours(t[e].workingHours),s=n.end.totalMinutes-n.start.totalMinutes;n.recessDuration&&(s-=n.recessDuration),l._totalWorkHours+=s,l._workingHours[Number(e)]=n}l._avgWorkingHours=l._totalWorkHours?l._totalWorkHours/60/Object.keys(this._workingHours).length:0,i.setWorkHours(l._avgWorkingHours);let n=a.exceptions.member;for(const e in n){const t=n[e];"Non Working"===t.exceptionType&&l._addHoliday(t)}}else{(a=JSON.parse(r).data[0].relateddata.events).forEach((function(e){var t=e.relelements["Event Type"],n=e.relelements["Calendar Exception Type"];if("Work Week"===t&&"Non Working"===n)l._recurringNonWorkingDays.push(Number(e.relelements["Day Of Week"]));else if("Exception"===t&&"Non Working"===n)l._addHoliday(e);else if("Work Week"===t&&"Working"===n){let t=l.getTimeFromWorkingHours(e.relelements.workingHours),n=t.end.totalMinutes-t.start.totalMinutes;t.recessDuration&&(n-=t.recessDuration),l._avgWorkingHours=n,l._workingHours[Number(e.relelements["Day Of Week"])]=t}})),l._avgWorkingHours=s.WORKING_HOURS_IN_A_DAY,i.setWorkHours(s.WORKING_HOURS_IN_A_DAY)}if(this._rootProjectId&&!n.silent){let e=o.getObjectById(this._rootProjectId);e&&e.dispatchEvent("onChange:dsxplan:scheduleCalendar",[this])}!n.silent&&this._dateline&&this._dateline.dispatchEvent("onParse")},getDaysAsString:function(e){return o.millisecondsToXsdDayTimeDuration(e*this.getWorkingHoursInMilliseconds())},getWorkDayLength:function(){return this._avgWorkingHours||i.getWorkHours()},getWorkingHoursInMilliseconds:function(){return 60*this.getWorkDayLength()*60*1e3}})})),define("DS/E6WCommonApps/E6WDefaultCalendarInstance",["UWA/Core","UWA/Class","DS/E6WCommonApps/E6WNonWorkingDayIterator"],(function(e,t,n){"use strict";return t.extend({init:function(){this.instance=null},getInstance:function(){return null==this.instance&&(this.instance=new n({loadDefaultCalendar:!0}),this.instance.constructor=null),this.instance}})})),define("DS/E6WCommonApps/Models/TaskModelMixin",["UWA/Core","UWA/Promise","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/FeatureFlagUtils","DS/PlatformAPI/PlatformAPI","DS/E6WCommonApps/Models/AssigneeMixin","DS/E6WCommonApps/Utils/3DSpaceUtils","DS/E6WCommonApps/E6WDefaultCalendarInstance","UWA/Utils","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/CollaborativeTasksNLS"],(function(e,t,n,s,i,o,a,r,l,d,c){"use strict";var p="DUE_TOMORROW",u="DUE_TODAY",h="NO_DATE",m="PAST_DUE",T="DUE_THIS_WEEK",E="DUE_FUTURE",g=function(e,t,n){var s=new Date(n);return e<t?s.setHours(s.getHours()+1):s.setHours(24),s},A={OWNERATTR:"ownerInfo",DPMPROJECTATTR:"DPMProject",ASSIGNEESATTR:"assignees",REFERENCEATTR:"references",SCOPESATTR:"scopes",DUEDATECATEGORY:d.DUE_DATE_CATEGORY,DUEDATEATTR:"dueDate",ACTUALSTARTDATEATTR:"actualStartDate",_categories:["PAST_DUE","NO_DATE","DUE_TODAY","DUE_TOMORROW","DUE_THIS_WEEK","DUE_FUTURE"],isComplete:function(){return"Complete"===this.get("state")},_onRequest:function(e){this.nbInFlightRequests++,1===this.nbInFlightRequests&&this.dispatchEvent("onChange:nbInFlightRequests",[this,e])},_onCompleteRequest:function(e){this.nbInFlightRequests--,this.nbInFlightRequests=this.nbInFlightRequests<0?0:this.nbInFlightRequests,0===this.nbInFlightRequests&&this.dispatchEvent("onChange:nbInFlightRequests",[this,e])},add:function(t,n,s){var i=e.clone(s||{},!1),o=i.onFailure,a=i.onComplete,r=this;i.onComplete=function(){r._onCompleteRequest(),a&&a.apply(this,arguments)},i.onFailure=function(){r._onCompleteRequest(),o&&o.apply(this,arguments)};var l,d=n.split(",").map((function(e){return e.trim()}));return(l=this.addObjects(d,t))&&l.length&&(this._onRequest(),l[0].save(void 0,i)),l},addSelfAssignToInWorkMessage:function(){var t=n.setHelper.apply(this,arguments).options||{},s=t.onComplete,i=this.get("title");e.extend(t,{onComplete:function(){s.apply(this,arguments);var e,t=(e="emxCollaborativeTasks.Label.InWorkTaskSelfAssigned",c.get(e));t=t.replace("%TASK_TITLE%",i),n.displaySuccess(t)}})},remove:function(t,n,s){var i=this.removeObject(t,n),o=e.clone(s||{}),a=o.onFailure,r=o.onComplete,l=this;return o.onComplete=function(e,t,n){l._onCompleteRequest(n),r&&r.apply(this,arguments)},o.onFailure=function(e,t,n){l._onCompleteRequest(n),a&&a.apply(this,arguments)},i&&(this._onRequest(),i.save(void 0,o)),i},fetchDeliverableParentTypes:function(e){const s=function(){const t=n.parentTypesMap[this.get("type")];t&&-1!==t.indexOf("VPMReference")&&e.push(this.get("physicalId"))},i=[];return(()=>{const e=this.getDeliverables();if(e&&e.length>0){const o={};e.forEach((function(e){const t=e.get("type");n.parentTypesMap[t]?s.call(e):o[t]=e}));Object.values(o).forEach((function(e){i.push(new t((function(t,n){a.fetchParentTypes(e,{onComplete:function(){s.call(this),t()},onFailure:n})})))}))}return t.all(i)})()},markDeliverablesOn3DNavigate:function(){var e=[];let t={metadata:{ignoreFromSameWidgetId:!1,appid:widget&&widget.getValue("appId"),originUid:this.id,originWidgetId:widget&&widget.id,timestamp:Date.now(),uid:l.getUUID()},data:{intent:"focus",referenceIds:e}},n=t;n.data.intent="select",this.fetchDeliverableParentTypes(e).then((function(){e.length&&(i.publish("DS/PADUtils/PADCommandProxy/focus",t),i.publish("DS/PADUtils/PADCommandProxy/select",n))}))},getMappedAttribute:function(e){return this.rdfCollabTaskInverseMapping&&this.rdfCollabTaskInverseMapping[e]||e},removeAssigneeByIndex:function(e){return this.removeObject(this.ASSIGNEESATTR,e)},addReferencesById:function(e){return this.addObjects(e,this.REFERENCEATTR)},sync:function(e,t,s){var i=Array.prototype.slice.call(arguments,0),o=s.onFailure,a=s.onComplete,r=this;s.onFailure=function(e,t,n){r._onCompleteRequest(n),n&&(n.response=t),o&&o.apply(this,arguments)},s.onComplete=function(e,t,s){r._onCompleteRequest(s),a&&a.apply(this,arguments),t&&207===t.statusCode&&n.displayWarning(t.info.replace("-","").trim())},r._onRequest(s),this._parent.apply(this,i)},dueDateCategory:function(t){var n=void 0===t?this.get("dueDate"):t,s="NO_DATE";if(n=e.is(n,"string")?parseInt(n,10):n,(n=e.is(n,"number")||n instanceof Date?new Date(n):n)instanceof Date)if(isNaN(n))s=h;else{n.setHours(0,0,0,0);var i=new Date;i.setHours(0,0,0,0);var o=n-i;if(o<0)s=m;else if(0===o)s=u;else{var a=new Date(i);if(a.setDate(a.getDate()+1),n.getTime()===a.getTime())s=p;else s=(o=n-this.dateHelper.getLastDayofThisWeek())<0?T:E}}return s},dueDateCategory2DueDate:function(e){var t,n=this.dateHelper;switch(e){case p:t=n.getTomorrow();break;case u:t=n.getToday();break;case h:t=new Date(NaN);break;case m:t=n.getPast();break;case T:t=n.getLastDayofThisWeek();break;case E:t=n.getFuture()}return t},dateHelper:{ONE_DAY:864e5,THIRTY_DAYS:2592e6,getLocaleDate:function(e){return e.toLocaleDateString()},getToday:function(){var e=new Date;return e.setHours(23,59,59,999),e},getTomorrow:function(){var e=new Date((new Date).getTime()+this.ONE_DAY);return e.setHours(23,59,59,999),e},getFuture:function(){var e=new Date((new Date).getTime()+this.THIRTY_DAYS);return e.setHours(23,59,59,999),e},getPast:function(){var e=new Date((new Date).getTime()-this.ONE_DAY);return e.setHours(23,59,59,999),e},getLastDayofThisWeek:function(){var e=new Date;e.setHours(23,59,59,999);var t=(e.getDay()+6)%7;return e.setDate(e.getDate()-t+4),e}},isAtRisk:function(){if(this.isProjectTask())return"behindSchedule"===this.get("status");var e=this.isComplete(),t=this.get(this.DUEDATEATTR);if(e||!t)return!1;var n=!1,s=this.getStartDate(),i=s instanceof Date?s.getTime():Date.parse(s),o=this.getPercentComplete();let a=this.nonWorkingDayIterator?this.nonWorkingDayIterator:r.prototype.getInstance();if(i&&o>=0){var l=new Date(i+(t.getTime()-i)*(o/100));n=new Date>g(this.getDuration(),a.getWorkingHoursInMilliseconds(),l)}return n},isLate:function(){if(this.isProjectTask())return"late"===this.get("status");var e=this.isComplete(),t=this.get(this.DUEDATEATTR);if(e||!t)return!1;let n=this.nonWorkingDayIterator?this.nonWorkingDayIterator:r.prototype.getInstance();var s=g(this.getDuration(),n.getWorkingHoursInMilliseconds(),t);return new Date>s},getDuration:function(){var e=this.getDefinedDuration();let t=this.nonWorkingDayIterator?this.nonWorkingDayIterator:r.prototype.getInstance();var n=t&&t.getWorkDayLength()+2;return(isNaN(e)?n:e)*t.getWorkingHoursInMilliseconds()},THRESHOLD:36e5};return e.extend(A,o),A})),define("DS/E6WCommonApps/Collections/ProjectTeamCollection",["UWA/Core","DS/RDFFoundation/Collections/ResultCollection","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper","DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/Models/LogicalUserModel","DS/E6WCommonApps/Models/TeamMemberResponsibilityModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/SubscribeUtil","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l,d){"use strict";var c=function(e){return d.get(e)},p="personRDFId",u={resetOperation:c("E6WCommonApps.Member.ProgressBar.ModifyOperation"),addOperation:c("E6WCommonApps.Member.ProgressBar.AddOperation"),removeOperation:c("E6WCommonApps.Member.ProgressBar.RemoveOperation")},h=function(e){e.data[e.action]=e.data[e.action]||[];var t=function(e){var t=e.data[e.action].detect((function(t){return t.responsibility===e.role}));return t||(t=t||{responsibility:e.role,persons:[],groups:[]},e.data[e.action].push(t)),t}(e);"pno:Person"===e.type||e.type===r.LOGICAL_USER_TYPE?-1===t.persons.indexOf(e.id)&&t.persons.push(e.id):-1===t.groups.indexOf(e.id)&&t.groups.push(e.id)},m=t.extend({_uwaClassName:"ProjectTeamCollection",model:a,setup:function(t,n){var s=e.clone(n||{},!1);s["@mask"]="dsplan:MVMask.Person.Complex",this._workscope=s.workscope,this._uri=s.uri,this._workscope&&!s.noListeners&&this._addCollectionListeners(),this._parent(t,s)},_addCollectionListeners:function(){var e=this._workscope.getCollectionAttribute(r.ASSIGNEE_ATTR);this.listenTo(e,"onAdd",this._onAssigneeAddedToParentWorkscopeCollection),this.listenTo(this,"onRemove",(function(e){this._removeMemberFromParentWorkscope.apply(this,arguments),e.destroy({noServer:!0})})),this.listenTo(this,"onAdd",(function(){this._dispatchTimeout=this._dispatchTimeout||setTimeout((()=>{this._workscope.dispatchEvent("onChange:"+r.TEAM_MEMBERS),this._dispatchTimeout=null}))}))},_onAssigneeAddedToParentWorkscopeCollection:function(e){if(!(e instanceof o)&&!this.get(a.getInstanceId(e.id,this._workscope.id))){var t={id:e.id,type:e.getObjectType(),allResponsibilitiesArray:r.RESPONSIBILITY_LEADER};this.addMember(t,{dontShowProgress:!0})}},isUserAssignedToMultipleLogicalUsers:function(e){let t=0;return this.forEach((function(n){n.get("memberPersonModel").getObjectType()===r.LOGICAL_USER_TYPE&&n.get("assignedUserModel")===e&&(t+=1)})),t>1},_removeMemberFromParentWorkscope:function(e,t,n){n&&!n.dontRemoveParentWorkscope&&this._workscope.removeObject(r.ASSIGNEE_ATTR,e.get("memberPersonModel"),n)},fetch:function(t){var n=e.clone(t||{},!1);if(!n.dontFetch){var s=[this._workscope.id];return n.searchStr&&s.push(n.searchStr),n.data=JSON.stringify(s),this._parent(n)}},getUri:function(){return this._uri||"/invoke/dsxplan:getResourceSharing"},parse:function(e){return a.processRawData(e,this._workscope)},getResponsibilityModelForMember:function(e){return this.find((function(t){if(t.get("memberPersonModel")===e)return t}))},onSaveComplete:function(e){var t=this,n=[],s=[];e.forEach((function(e){var t=e.memberModel;t&&(e.requestType===r.REQUEST_TYPE_ADD?n[t.id]="":e.requestType===r.REQUEST_TYPE_REPLACE&&(s[t.id]=""))})),e.forEach((function(e){var i=e.memberModel;if(i){var o,a=e.requestType;a===r.REQUEST_TYPE_ADD?o=c("E6WCommonApps.Label.AddMember"):a===r.REQUEST_TYPE_REMOVE?(o=c("E6WCommonApps.Label.RemoveMember"),e.options&&e.options.isLoggedInUser&&t._destroyModelAndSetNewRoute(t._workscope)):a===r.REQUEST_TYPE_REPLACE&&(o=c("E6WCommonApps.Label.ReplaceMember")),i.get("title")?t._showAlertAndRemoveProgress(n,s,e,o):i.addEventOnce("onSync",(function(){t._showAlertAndRemoveProgress(n,s,e,o)}))}}))},onSaveFailure:function(e,t,i){var o=this;e.forEach((function(e){o.rollbackMemberChanges(e),o._workscope.dispatchEvent("onChange:"+r.TEAM_MEMBERS);var t,a=i&&i.msg;a?(t=n.splitUri(a)[1].trim(),i.error||(t=n.splitUri(JSON.parse(a).msg)[1].trim()),"E6WCommonApps.Error.ownerRefused"===t&&(t=d.replace(c(t),{MEMBER_NAME:e.memberModel.get("title")})),s.displayError(c(t))):s.displayError(c("E6WCommonApps.Error.SaveFailed"));e.memberModel.dispatchEvent("removeProgress")}))},onSaveTimeout:function(e){e.forEach((function(e){e.memberModel.dispatchEvent("removeProgress")}))},save:function(t,s){s=s||{};var i=function(t){var n={};return t.forEach((function(t){n[t.requestType]=n[t.requestType]||[];var s=t.memberModel.get("type"),i=t.memberModel.get(p),o={data:n,id:i,action:t.requestType,type:s};t.requestType===r.REQUEST_TYPE_REMOVE?t.memberModel.get("allResponsibilitiesArray").forEach((function(t){h(e.extend(o,{role:t}))})):h(e.extend(o,{role:t.memberModel.get("responsibility")}))})),Object.keys(n).forEach((function(e){n[e].forEach((function(e){e.persons&&(e.persons=JSON.stringify(e.persons)),e.groups&&(e.groups=JSON.stringify(e.groups))}))})),n}(t),a=Object.keys(i),d={};let c=function(){for(var e of a){var t=u[e],n=l.subscribeActivity(t);d[e]=n,l.startActivity(t,n)}};var m;1===t.length?t[0].memberModel.get("memberPersonModel")instanceof o||c():t.length>1&&c();m=0===Object.keys(d).length?JSON.stringify([i,this._workscope.id]):JSON.stringify([i,this._workscope.id,{identifier:d}]);var T=this;let E;E=s.onComplete?function(){T.onSaveComplete(t),s.onComplete()}:this.onSaveComplete.bind(this,t);(s.ajax||n.request)(n.expandUrl("/invoke/dsxplan:shareResources","v0"),{method:"POST",type:"json",data:m,headers:{"Content-Type":"application/json"},onComplete:E,onFailure:this.onSaveFailure.bind(this,t),onTimeout:this.onSaveTimeout.bind(this,t)})},addMember:function(t,n){var s=e.clone(n||{},!1);s.dontRegisterChange=!0,e.extend(t,{parentWorkscopeModel:this._workscope});var i=a.getMemberObj(t),o=this.add(i,s),l=r.REQUEST_TYPE_ADD;return!s.rollBackFlag&&!s.dontShowProgress&&o.dispatchEvent("addProgress"),{memberModel:o,requestType:l}},resetMember:function(t,n,s){var i=e.clone(s||{},!1);e.is(n,"string")&&(n=[n]);var o=r.REQUEST_TYPE_REPLACE,a=t.get("allResponsibilitiesArray");return t.set("allResponsibilitiesArray",n),!i.rollBackFlag&&t.dispatchEvent("addProgress"),{memberModel:t,requestType:o,oldResponsibilitiesArray:a}},removeMember:function(t,n){var s=e.clone(n||{},!1);s.dontRegisterChange=!0;var i=r.REQUEST_TYPE_REMOVE,o=t.get("allResponsibilitiesArray");return this.remove(t,s),{memberModel:t,requestType:i,oldResponsibilitiesArray:o,options:s}},rollbackMemberChanges:function(e){var t=e.memberModel.get(p),n=e.requestType;if(n===r.REQUEST_TYPE_ADD)this.removeMember(e.memberModel);else if(n===r.REQUEST_TYPE_REMOVE){var s={id:t,type:e.memberModel.get("type"),allResponsibilitiesArray:e.oldResponsibilitiesArray};this.addMember(s,{rollBackFlag:!0})}else this.resetMember(e.memberModel,e.oldResponsibilitiesArray,{rollBackFlag:!0})},_destroyModelAndSetNewRoute:function(e,t){var n=t&&s.getNewRouteIndexFromManagmentView(e,t);e.destroy({noServer:!0}),t&&t.setRoute(n)},_showAlertAndRemoveProgress:function(e,t,n,i){var o=n.memberModel,a=d.replace(i,{MEMBER_NAME:s.escapeHTML(o.get("title")),ROLE:o.getResponsibilityNLS()}),l=Object.keys(e).length,p=Object.keys(t).length;n.requestType===r.REQUEST_TYPE_REMOVE||Object.keys(e).length+Object.keys(t).length===1?s.displaySuccess(a,{noEscape:!0}):(n.requestType===r.REQUEST_TYPE_ADD?e[n.memberModel.id]=a:t[n.memberModel.id]=a,(a=function(){var n,i="",o="";for(var a in e){if(!(n=e[a]))return"";i&&(i+=",<br>"),i+=n}for(var a in t){if(!(n=t[a]))return"";o&&(o+=",<br>"),o+=s.escapeHTML(n)}return n="",i&&(l>1||p>=1)&&(i="<p>"+c("E6WCommonApps.Label.AddMembers")+i+"</p>"),n=i,o&&(l>=1||p>1)&&(o="<p>"+c("E6WCommonApps.Label.ReplaceMembers")+o+"</p>"),o&&(n+=o),n}())&&s.displaySuccess(a,{noEscape:!0})),o.dispatchEvent("removeProgress")},comparator:function(e){let t=e.get("memberPersonModel");return t&&t.getObjectType()===r.LOGICAL_USER_TYPE?t.get("title"):t.get("name")}});return m})),define("DS/E6WCommonApps/Models/TaskValidator",["UWA/Core","UWA/Class","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/ScheduleConstants","i18n!DS/E6WCommonApps/assets/nls/CollaborativeTasksNLS","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o){"use strict";var a=function(e){var t=i.get(e);return t===e&&(t=o.get(e)),t};return t.extend({_uwaClassName:"TaskValidator",_attributesGet:function(e,t){var n;return e&&(n=e[t]),n||this.get(t)},_validateDuration:function(e,t){var s=!0,i=this._attributesGet(e,n.DURATION),o=this._attributesGet(e,n.DURATION_RANGE);return(i<0||o<0||(void 0===i||void 0===o)||i-o<0||isNaN(i)||isNaN(o)||i>=1e6)&&(t.fields.push(n.DURATION),t.fields.push(n.DURATION_RANGE),t.fields.push(n.DURATION_MIN),t.fields.push(n.DURATION_MAX),s=!1),s},_validateActualDates:function(e,t){var s=!0,i=this._attributesGet(e,n.STATE_ATTR);i=i&&i["@id"]?i["@id"]:i;var o="";if(!i)return!0;if(this.model.get(n.RESTRICT_ASSIGNEE_ATTR))return!0;const r=(n,i)=>{let r=this._attributesGet(e,n);r=r&&r.actualValue?r.actualValue:r,r?r>new Date&&(o=(o=a("E6WCommonApps.Error.Validation.DateIsLater").replace("{DATE1}",i)).replace("{DATE2}",a("E6WCommonApps.Label.CurrentDate"))):o=a("E6WCommonApps.Error.Validation.DateCantBeEmpty").replace("{DATE}",i),o&&(t.fields.push(n),t.messages[n]=o,s=!1)};if(i!==n.STATE_OPEN&&r(n.ACTUAL_START_DATE,a("E6WCommonApps.Label.ActualStart")),i===n.STATE_DONE&&r(n.ACTUAL_END_DATE,a("E6WCommonApps.Label.ActualEnd")),e[n.USER_DEFINED_END_DATE_ATTR]){let i=this._attributesGet(e,n.ACTUAL_START_DATE);var l=this.getEndDate();i>(l=l&&l.actualValue?l.actualValue:l)&&(t.fields.push(n.ENDDATE_ATTR),t.fields.push(n.ACTUAL_START_DATE),o=(o=a("E6WCommonApps.Error.Validation.DateIsLater").replace("{DATE1}",a("E6WCommonApps.Label.ActualStart"))).replace("{DATE2}",a("E6WCommonApps.Label.PlannedEnd")),t.messages[n.ENDDATE_ATTR]=o,t.messages[n.ACTUAL_START_DATE]=o,s=!1)}return s},_validateEstimatedDates:function(e,t){var s=this.getStartDate(e);s=s&&s.actualValue||s;var i=this.getEndDate(e);i=i&&i.actualValue||i;var o=this._validateStartDate(s,e,t),a=this._validateEndDate(i,e,t);return s>i&&!this.isStartOrEndDateAutomatic(e)?(t.fields.push(this.isStarted(e)?n.ACTUAL_START_DATE:n.STARTDATE_ATTR),t.fields.push(this.isComplete(e)?n.ACTUAL_END_DATE:n.ENDDATE_ATTR),!1):o&&a},_validateDateConstraints:function(e,t){var n,s,i=this.getAttr(e,"START_DATE_MIN_ATTR"),o=this.getAttr(e,"START_DATE_MAX_ATTR"),a=this.getAttr(e,"END_DATE_MIN_ATTR"),r=this.getAttr(e,"END_DATE_MAX_ATTR");return i&&(i=i&&i.actualValue||i),o&&(o=o&&o.actualValue||o),a&&(a=a&&a.actualValue||a),r&&(r=r&&r.actualValue||r),this.isStartDateFixed()&&(n=(n=this.getAttr(e,"STARTDATE_ATTR"))&&n.actualValue||n),this.isEndDateFixed()&&(s=(s=this.getAttr(e,"ENDDATE_ATTR"))&&s.actualValue||s),o&&a&&a>o||o&&r&&o>r||i&&r&&i>r||i&&a&&i>a||s&&o&&o>s?(t.fields.push("dateConstraints"),!1):!(n&&r&&n>r)||(t.fields.push("dateConstraints"),!1)},_validateStartDate:function(e,t,s){return!(this.isStartDateFixed(t)&&(!e||isNaN(e.getTime&&e.getTime())))||(s.fields.push(this.isStarted(t)?n.ACTUAL_START_DATE:n.STARTDATE_ATTR),!1)},_validateEndDate:function(e,t,s){return!(this.isEndDateFixed(t)&&(!e||isNaN(e.getTime&&e.getTime())))||(s.fields.push(this.isComplete(t)?n.ACTUAL_END_DATE:n.ENDDATE_ATTR),!1)},validate:function(e){var t={fields:[],messages:{}};t.fields.pushFunc=t.fields.push,t.fields.push=function(e){-1===this.indexOf(e)&&this.pushFunc(e)};var i=!0;if(this._attributesGet(e,s.TASK_TYPE)!==s.SIMPLE_TASK){i=this._validateDuration(e,t);var o=this._validateActualDates(e,t);i=i&&o,o=this._validateEstimatedDates(e,t),i=i&&o,o=this._validateDateConstraints(e,t),i=i&&o}var a=this._attributesGet(e,n.TITLE_ATTR);null==a&&(a=this._attributesGet(e,n.DSLC_TITLE_ATTR)),a&&a.trim().length||(t.fields.push(n.TITLE_ATTR),i=!1);var r=this._validateCredentials(e,t);if(!(i=i&&r))return t},_validateCredentials:function(e,t){var n=this._attributesGet(e,s.TASK_COLLAB_SPACE),i=this._attributesGet(e,s.TASK_ORGANIZATION);if(!n&&!i)return!0;var o=!0;return n&&n instanceof Array&&n[0]&&!n[0].actualValue&&(t.fields.push(s.TASK_COLLAB_SPACE),o=!1),i&&i instanceof Array&&i[0]&&!i[0].actualValue&&(t.fields.push(s.TASK_ORGANIZATION),o=!1),o},getStartDate:function(t){var s;return s=(s=this.isStarted(t)&&this._attributesGet(t,n.ACTUAL_START_DATE)||this._attributesGet(t,n.STARTDATE_ATTR))&&e.is(s,"string")?new Date(s):s},getEndDate:function(t){var s;return s=(s=this.isComplete(t)&&this._attributesGet(t,n.ACTUAL_END_DATE)||this._attributesGet(t,n.ENDDATE_ATTR))&&e.is(s,"string")?new Date(s):s},isComplete:function(e){return this._attributesGet(e,n.STATE_ATTR)===n.STATE_DONE},isStarted:function(e){return this.isComplete(e)||this._attributesGet(e,n.STATE_ATTR)===n.STATE_IN_PROGRESS},isFixed:function(e){return this._attributesGet(e,n.USER_DEFINED_DATES_ATTR)||this.isStartDateFixed(e)||this.isEndDateFixed(e)},isStartDateFixed:function(e){return this._attributesGet(e,n.USER_DEFINED_START_DATE_ATTR)},isEndDateFixed:function(e){return this._attributesGet(e,n.USER_DEFINED_END_DATE_ATTR)},getAttr:function(e,t){return this._attributesGet(e,n[t])},isStartDateAutomatic:function(e){return!this.isStartDateFixed(e)&&!this.isStarted(e)},isEndDateAutomatic:function(e){return!this.isEndDateFixed(e)&&!this.isComplete(e)},isStartOrEndDateAutomatic:function(e){return this.isStartDateAutomatic(e)||this.isEndDateAutomatic(e)}})})),define("DS/E6WCommonApps/Views/E6WDateViewMixin",["DS/E6WCommonApps/Preferences"],(function(e){"use strict";return{_setupUIKITDatePickers:function(){e.getHideWeekLabel()||(this._config.showWeekNumbers=!0),this._parent.apply(this,arguments)},_appendWeekNumbers:function(t){t&&t.value&&!e.getHideWeekLabel()&&(t.elements.inputField.value+=e.getWeekNumber(t.value))}}})),define("DS/E6WCommonApps/Checklist/ChecklistParentModelMixin",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/RDFFoundation/RDFUtils"],(function(e,t,n){"use strict";var s={syncPatch:function(e,n){let s=this.getChangedAttributesSinceLastSave().includes(t.HAS_CHECKLIST_ATTR);const i=this.get(t.HAS_CHECKLIST_ATTR),o=i&&i.some((e=>e.getChangedAttributesSinceLastSave().length>0));if(s||o){let e=this.syncPatchChecklist.apply(this,arguments);return this._changedAttributesSinceLastSave={},e}return this._parent.apply(this,arguments)},getCreateOperations:function(e){const t=this;let n={};if(e._added.length>0){n.op="create";let s=[];e._added.forEach((function(e){let n=t.getRelatedModelCompactJson(e);delete n["dsxplan:jsType"],delete n["dsplan:checklistParent"],n["@id"]&&delete n["@id"],n["@href"]&&delete n["@href"],n["@mask"]&&delete n["@mask"],s.push(n)})),n.data=s}return n},getRemoveOperations:function(e){let t={};if(e._removed.length>0){t.op="delete";let n=[];e._removed.forEach((function(e){n.push(e.id)})),t.data=n}return t},getModifyOperations:function(e){let t=e.toArray().filter((function(t){return t.getChangedAttributesSinceLastSave().length>0&&!e._added.includes(t)})),n={};if(t.length>0){n.op="modify";let e=[];t.forEach((function(t){let n=[],s=t.getChangedAttributesSinceLastSave(),i={};s.forEach((e=>{let n=t.dataForRendering({attributes:[e]});i[e]=n[e].actualValue?n[e].actualValue:n[e]})),t._changedAttributesSinceLastSave={},n.push(i),n.push(t.get("@id")),e.push(n)})),n.data=e}return n},syncPatchChecklist:function(s,i){var o=[],a=this._changedAttributesSinceLastSave;this._changedAttributesSinceLastSave={};var r,l={},d=t.HAS_CHECKLIST_ATTR,c=s[d];let p=this.getCreateOperations(c),u=this.getModifyOperations(c),h=this.getRemoveOperations(c);if(c.resetFlags(),p.data&&o.push(p),u.data&&o.push(u),h.data&&o.push(h),o.length||(i&&i.onComplete&&i.onComplete({}),r={cancel:function(){}}),!r){i.attrs=i.noStringify||this.isDSLC()?o:JSON.stringify(o);var m=e.clone(i||{},!1),T=i.onFailure;i.onFailure=function(e){T&&T(e),this.dispatchEvent("onError",[this,e,m]),this.rollbackChanges(a,l,s)}.bind(this)}if(!r&&this.isDSLC()){var E=i.mask||this.getMask();i.url=n.expandUrl("/invoke/dsxplan:updateChecklist"+(E?"?$mask="+E:"")),i.data=JSON.stringify([i.attrs,this.id]),i.method="POST"}return r}};return s})),define("DS/E6WCommonApps/Views/E6WDateView",["DS/E6WCommonUI/Views/DateView","DS/E6WCommonApps/Views/E6WDateViewMixin"],(function(e,t){"use strict";return e.extend(t)})),define("DS/E6WCommonApps/Collections/TasksSplitCollection",["UWA/Core","UWA/Class/Collection","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],(function(e,t,n){"use strict";var s=function(e){return e&&e.actualValue||e},i="state",o=n.DUE_DATE_CATEGORY,a=t.extend({_uwaClassName:"XTaskSplitCollection",model:{},fetch:function(){},complete:function(){this._parentCollection.complete.apply(this._parentCollection,arguments)},setup:function(e,t){var n=Array.prototype.slice.call(arguments,0);this._filterAttr=t.filterAttr,this._valueForFiltering=t.valueForFiltering,this._parentCollection=t.parentCollection;var s="onChange:"+this._filterAttr,i={onAdd:this._onParentAdd,onRemove:this._onParentRemove,onReset:this._onParentReset,onComplete:()=>this.dispatchEvent("onComplete")};i[s]=this._onAttrChange,this._filterAttr!==o&&"priority"!==this._filterAttr||(i["onChange:state"]=this._onAttrChange),this.listenTo(this._parentCollection,i),this._parent.apply(this,n),Object.defineProperty(this,"completing",{get:()=>this._parentCollection.completing})},_onParentAdd:function(t,n,i){if(n===this._parentCollection){var o=s(t.get(this._filterAttr)),a=s(this._valueForFiltering),r=e.clone(i||{},!1);r.at=0,r.parse=!1,i&&i.parse&&(r.fromServer=!0),o===a&&this._canIncludeModel(t)&&this.add(t,r)}else this.stopListening(n,"onAdd")},_onParentRemove:function(e,t){t===this._parentCollection?this.remove(e):this.stopListening(t,"onRemove")},_onParentReset:function(e){if(e===this._parentCollection){var t=e.tasksWithAttrValue(this._valueForFiltering,this._filterAttr);this.reset(t)}else this.stopListening(e,"onReset")},_onAttrChange:function(e,t,n){s(e.get(this._filterAttr))===s(this._valueForFiltering)&&this._canIncludeModel(e)?(this.add(e,{at:0}),n.at=0):this.remove(e,n)},_canIncludeModel:function(e){var t;return this._filterAttr===n.DUE_DATE_CATEGORY&&(t=s(e.get(i))),"priority"===this._filterAttr&&(t=s(e.get("stateForDisplay"))),!("Complete"===t||"Done"===t)},dataForRendering:function(){var t={};if(this._filterAttr===i)if("string"===e.typeOf(this._valueForFiltering)){var n={actualValue:this._valueForFiltering,displayValue:this._valueForFiltering};t.state=n}else t.state=this._valueForFiltering;if(this._filterAttr===o){var s=this._valueForFiltering;s.displayValue||(s.displayValue=s.actualValue),t.dueDate=s}return t.collabSpace=this.collabSpace,t.extid=this.extid,t.filteredByAttr=this._filterAttr,t.filteredByValue=this._valueForFiltering,t.filteredCount=this.size(),t},getSaveAttributes:function(){var e={},t=s(this._valueForFiltering);return e[this._filterAttr]=t,e}});return a})),define("DS/E6WCommonApps/Views/E6WCustomUomView",["UWA/Core","DS/E6WCommonUI/Views/UomView","DS/E6WCommonApps/Preferences","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o){"use strict";var a=t.extend({_uwaClassName:"E6WCustomUomView",isValidInput:function(){return!0},earlyInputCheck:function(e){return!this.matchesPattern(e)||isNaN(e)&&this._config.name===i.DURATION},_postTreatmentNumber:function(e){if("dsxplan:lag"!==this._config.name)try{let t=s.wrapError((()=>{this?.model?.model?.getWorkDayLength&&this?.model?.model?.getWorkDayLength()}))||n.getWorkHours();const i=e&&e.data&&e.data[this._config.name]||this.normalizedGet(this.model,this._config.name),o=e&&e.data&&e.data[this._config.toleranceName]||this.normalizedGet(this.model,this._config.toleranceName);i<1?(this._parent.call(this,{data:{[this._config.name]:i*t,[this._config.toleranceName]:o*t}}),this._select&&(this._select.selectedIndex=1)):this._parent.call(this,e)}catch(e){console.error(e),this._parent.apply(this,arguments)}}});return a})),define("DS/E6WCommonApps/Views/E6WStartStopView",["DS/E6WCommonUI/Views/StartStopView","DS/E6WCommonApps/Views/E6WDateViewMixin"],(function(e,t){"use strict";return e.extend(t)})),define("DS/E6WCommonApps/Views/WorkscopeStartStopView",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Views/E6WStartStopView"],(function(e,t,n){"use strict";var s=n.extend({dateDataEntry:function(e){e.dsModel&&e.dsModel.value&&e.dsModel.value.setHours(0,0,0,0),this._parent(e)},render:function(){if(this._parent.apply(this,arguments),this.model&&this._config.name===t.START_DATE_MIN_ATTR){let i=this.model.get(t.SCHEDULING_FROM_STRATEGY_ATTR);var n;if(i===t.ENDDATE_SCHEDULINGFROM_STRATEGY_USING_ACTUALS||i===t.ENDDATE_SCHEDULINGFROM_STRATEGY_USING_PLANNED?n=this.container.getElement(".stop label span"):i!==t.STARTDATE_SCHEDULINGFROM_STRATEGY_USING_ACTUALS&&i!==t.STARTDATE_SCHEDULINGFROM_STRATEGY_USING_PLANNED||(n=this.container.getElement(".start label span")),n){var s=e.createElement("span",{class:"required-field-indicator",text:"*"});n.insertBefore(s,n.getElement(".label-icons"))}}return this}});return s})),define("DS/E6WCommonApps/MultiEdit/E6WMultiEditFieldView",["DS/E6WCommonUI/MultiEdit/MultiEditFieldView","DS/E6WCommonApps/Views/E6WDateView"],(function(e,t){var n=e.extend({_uwaClassName:"E6WMultiEditFieldView",fetchView:function(e,n){const s={...n,_parentMultiFiedView:this};return"date"===e?new t(s):this._parent.apply(this,arguments)}});return n})),define("DS/E6WCommonApps/Models/ScheduleElementCloneModel",["DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/CSRFUtil","DS/E6WCommonUI/PlatformManager","DS/RDFFoundation/MemberUtils","DS/RDFFoundation/Models/CloneModelForRepository","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r){"use strict";var l=r.get.bind(r),d=o.extend({i18n:l,buildBatchWithPreprocessedObjects:function(){var t=this._parent.apply(this,arguments);return(this.localRelatedData.toConstraints||this.localRelatedData.fromConstraints)&&(t=t||e.getBatchGenerator(),this._processAddedConstraints(t),this._processRemovedConstraints(t)),delete this.localRelatedData.toConstraints,delete this.localRelatedData.fromConstraints,t},getIsActualDatesChanged:function(){return this.localAttributes.hasOwnProperty(a.ACTUAL_START_DATE)||this.localAttributes.hasOwnProperty(a.ACTUAL_END_DATE)},checkAndSetCSRF:function(e,t){n.checkAndSetCSRF(e,t)},_processAddedConstraints:function(e){var n=this,s=function(e){return"add"===e.operation},i=function(s,i){s.updateBackpointers({silent:!0}),s.updateParentWorkscopes(),s.save(void 0,{ajax:e.ajax,onComplete:function(){t.displaySuccess(n.i18n("E6WCommonApps.Label.SuccessfulSave"))},onFailure:function(e,t){n._onConstraintFailure(i,t.message,s),s.destroy({noServer:!0})}})};this.localRelatedData.toConstraints&&this.localRelatedData.toConstraints.filter(s).forEach((function(e){i(e.value,"toConstraints")})),this.localRelatedData.fromConstraints&&this.localRelatedData.fromConstraints.filter(s).forEach((function(e){i(e.value,"fromConstraints")}))},_processRemovedConstraints:function(e){var n=this;this.localRelatedData.toConstraints&&this.localRelatedData.toConstraints.forEach((function(s){"remove"===s.operation&&n.model.removeObject("toConstraints",s.value,{silentOnChange:!0,ajax:e.ajax,onComplete:function(){t.displaySuccess(n.i18n("E6WCommonApps.Label.SuccessfulSave"))},onFailure:n._onConstraintFailure.bind(n,"toConstraints","E6WCommonApps.Error.ConstraintNotRemoved")})})),this.localRelatedData.fromConstraints&&this.localRelatedData.fromConstraints.forEach((function(t){"remove"===t.operation&&n.model.removeObject("fromConstraints",t.value,{silentOnChange:!0,ajax:e.ajax,onFailure:n._onConstraintFailure.bind(n,"fromConstraints","E6WCommonApps.Error.ConstraintNotRemoved")})}))},_onConstraintFailure:function(e,n,s){var i,o=("toConstraints"===e?s.getPredecessor():s.getSuccessor()).get("dsxplan:label");"E6WCommonApps.Error.ConstraintNotCreated"!==n&&"E6WCommonApps.Error.ConstraintNotRemoved"!==n||(i=r.replace(r.get(n),{OBJECT_NAME:o}),t.displayError(i)),this._fireRelationshipChangeEvents(e,{})},getModelForAssigneeTypeahead:function(){return this},assignToSelf:function(e){this.add(e.config.name,i.addUUIDToURI(s.getContextUserUid()),e)}});return d})),define("DS/E6WCommonApps/Models/AssigneeTypeAhead",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","UWA/Class/Listener","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Collections/ProjectTeamCollection","DS/E6WCommonUI/Models/BulkModel","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],(function(e,t,n,s,i,o,a){"use strict";var r=function(e){return a.get(e)};var l={callback:function(t,n,s,i){var o=e.clone(i||{},!1).model;return n.length>0&&n.length<3?l._buildTypeAhead([],o,t,n,s):l._callback(o,t,n,s)},noResultsMessageCallback:function(e){return e.length>0&&e.length<3?r("E6WCommonUI.Label.Type3Characters"):r("emxFoundation.Label.NoResultsFound")},_callback:function(e,t,i,a){var r,d,c=function(e){return e.fetching},p=e.model,u=p instanceof o;return u||(d=function(e){return"WorkscopeModel"===e._uwaClassName?e:e.getParent()}(p)),!u&&d&&d.hasViewAccess()?((r=l.getTeamMembersForTypeAhead(e.model))&&0===r.length&&r.fetch({onlyIfNeeded:!0,onComplete:function(s){if(s.some(c)){var o=new n;o.listenTo(s,"onFetchDone",(function(){s.some(c)||(l._buildTypeAhead(s,e,t,i,a),o.stopListening())}))}else s,l._buildTypeAhead(s,e,t,i,a)}}),r.fetching?{cancel:function(){}}:l._buildTypeAhead(r,e,t,i,a)):s.typeAheadCallback.call(this,t,i,a)},getTeamMembersForTypeAhead:function(e){var t=e.get("teamMembersForTypeAhead");return t||(t=new i(void 0,{workscope:e,uri:"/invoke/dsxplan:getProjectMembers"}),e.setCollection("teamMembersForTypeAhead",t)),t},_buildTypeAhead:function(n,i,o,a,r){var l={cancel:function(){}},d=i.get("dsxplan:hasAssignee");d=d||[];var c=function(n,r){var l=[];d=d||[];var c=i.getModelForAssigneeTypeahead(),p=c.get(t.CANDIDATE_ASSIGNEE_ATTR);p&&p.forEach((function(e){e.getObjectType()!==t.USER_GROUP_TYPE&&-1===d.indexOf(e)&&l.push({value:e.id,label:e.getFullName(),image:e.get("image"),login:e.get("ds6w:identifier"),sourceid:s.sourceFromService(e.serviceHosting)})}));const u=l.reduce(((t,n)=>e.merge(t,{[n.value]:!0})),{});let h=function(e){let t=[];for(let n=0;n<e.length;n++){let s=e[n];s.get("assignedUserModel")||t.some((function(e){return e.get("memberPersonModel")===s.get("memberPersonModel")}))||t.push(s)}return t}(n);return h.forEach((function(e){if(function(e,n,s,i,o){var a,r=s.get("memberPersonModel"),l=r.getObjectType();if("pno:Person"===l||i.name===t.CANDIDATE_ASSIGNEE_ATTR&&"foaf:Group"===l||i.name!==t.CANDIDATE_ASSIGNEE_ATTR&&l===t.LOGICAL_USER_TYPE){var d="WorkscopeModel"===e._uwaClassName;a=-1===n.indexOf(s)&&s.id,"foaf:Group"===l&&(a=!!r.getFullName()&&a),d&&(a=a&&s.get("responsibility")===t.RESPONSIBILITY_LEADER),o[r.id]&&(a=!1)}return a}(c,d,e,o,u)){var n=e.get("memberPersonModel");let i;if(n.getObjectType()===t.LOGICAL_USER_TYPE&&n.get("title")){let e=n.get("title").toLowerCase();i=new RegExp(`\\b${a.toLowerCase()}`,"i").test(e)}else i=n.get("title")&&n.get("title").toLowerCase().startsWith(a.toLowerCase());n.getObjectType()!==t.LOGICAL_USER_TYPE||r&&!i?r||l.push({value:n.id,label:n.getFullName(),image:n.get("image"),login:n.get("dsaccess:accountName"),sourceid:s.sourceFromService(n.serviceHosting)}):l.push({value:n.id,label:n.get("title"),image:n.get("image"),sourceid:"3dplan"})}})),l};let p;if(a.length<3){m=[],(h=n)&&!h.isEmpty()&&h.forEach((function(e){e.get("responsibility")!==t.RESPONSIBILITY_VIEWER&&m.push(e)})),p=m;let e=c(p);r(e)}else{var u={};p=n.toArray(),n.forEach((function(e){var t=e.get("memberPersonModel");u[t.id]=!0}));l=s.typeAheadCallback.call(this,o,a,(function(e,t){var n=[],s=[];e.forEach((function(e){u[e.resourceUid]?n.push(e):s.push(e)}));var i=c(p,!0),o=n.concat(s).concat(i);r(o,t)}))}var h,m;return l}};return l})),define("DS/E6WCommonApps/Views/CommentsView",["DS/PlatformAPI/PlatformAPI","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/SocialToolbarVue/SocialToolbarVueUWAView","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],(function(e,t,n,s,i){"use strict";return{loadComments:function(o){let a,r;a={platformId:enoviaServer.tenant,subjectUri:o.id,atInit:{nbCommentsToLoad:8},urls:{service:n.getServiceUrl("3dplan",!0)+"/dsplan",registry:e.getApplicationConfiguration("app.urls.registry")},disableFeatures:{disableShare:!0}};const l=o.model||o;return t.isTask(l.getObjectType&&l.getObjectType())&&(a.appForcedLinkUri=`/#app:${i.APP_TSK}/content:id=${o.id}&propertyPanelTab=commentsTab`),r=new s,r._optionsFromXPP={props:a},o.isRDF||(a.urls.service=window.enoviaServer.computeUrl("/resources"),a.subjectUri="pid:"+o.id,a.urls.serviceCSRF={name:"X-DS-CSRFTOKEN"}),r}}})),define("DS/E6WCommonApps/GoverningProcess/GoverningProcessFieldsView",["UWA/Core","DS/E6WCommonApps/Views/E6WObjectCardView","DS/RDFFoundation/BusinessProcessUtils","DS/TransientWidget/TransientWidget","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],(function(e,t,n,s,i){"use strict";var o=function(e){return i.get(e)};return t.extend({_uwaClassName:"GoverningProcessFieldsView",needProcessInstanceDropDownButton:function(){if("dsplan:hasProcessInstance"===this._config.name)return!0},needPropertiesButton:function(){return!1},disableRemoveButton:function(e){let t=this.model.model.currentUserIsLeader&&this.model.model.currentUserIsLeader();("dsplan:hasProcessModel"===this._config.name&&this.model.get("dsplan:hasProcessInstance")||!t)&&(e.className="disabled")},getMenuItems:function(e){let t="dsplan:hasProcessModel"===this._config.name&&this.model.get("_hasProcessModelButNoInstance"),s=this.needProcessInstanceDropDownButton(e);var i=[];t&&i.push(n.getStartProcessButtonConfig(e.options)),s&&(i.push(this.getOpenIteropInformationButtonConfig(e)),i.push(this.getOpenIteropTaskButtonConfig(e))),i.push(this.getRemoveItemButton(e));var o=i.findIndex((e=>"remove-button"===e.name));return-1!==o&&this.disableRemoveButton(i[o]),i},getOpenIteropTaskButtonConfig:function(e){return{text:o("E6WCommonUI.Label.OpenIteropTask"),fonticon:"logout",handler:function(){n.openIteropTask(e,"bpa:Task")},name:"openIteropItemButton"}},getOpenIteropInformationButtonConfig:function(e){return{text:o("E6WCommonUI.Label.OpenIteropInformation"),fonticon:"info",handler:function(){n.openIteropInformation(e,"bpa:Process")},name:"openIteropInformationButton"}},removeItemButtonHandler:function(t){var n=this;if("dsplan:hasProcessInstance"===this._config.name){var s=this._parentView._parentView._parentView.modal;e.extend(s.options,{okButtonText:o("E6WCommonUI.Label.Remove"),koButtonText:o("E6WCommonUI.Label.Cancel")}),s.confirm(o("E6WCommonUI.Warning.RemoveProcessInstance").replace("{GPI title}",t.model.get("title")),o("E6WCommonUI.Command.RemoveProcessInstance"),(function(e){e&&n.model.remove(n._config.name,t.index,t.options)}))}else n.model.remove(n._config.name,t.index,t.options)},getRemoveItemButton:function(e){return{text:o("E6WCommonUI.Label.Remove"),name:"remove-button",fonticon:"remove",handler:this.removeItemButtonHandler.bind(this,e)}}})})),define("DS/E6WCommonApps/Views/DateConstraintView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/E6WHandlebarsHelpers","DS/Controls/ComboBox","DS/E6WCommonUI/Views/DateView","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Preferences","text!DS/E6WCommonApps/assets/templates/dateconstraints.html.handlebars","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p){"use strict";var u=n.compile(l),h=function(e){return c.get(e)},m={},T={start:{datepicker:"#datepicker-constraint-start",select:"#select-constraint-start",constraintPickerVal:"startDateConstraintLimit"},end:{datepicker:"#datepicker-constraint-end",select:"#select-constraint-end",constraintPickerVal:"endDateConstraintLimit"}},E=o.extend({_uwaClassName:"DateConstraintView",tagName:"div",compiledTemplate:u,className:"details-display-shared-view ddv-field form-group",id:function(){return"DateConstraintView_"+this.cid},setup:function(){this.startDateConstraintLimit=null,this.endDateConstraintLimit=null,this.elementsList=[],this._config.showWeekNumbers=!0,this._parent.apply(this,arguments),m=this._config.constraintValues,Object.keys(m).map((e=>{this.elementsList.push({value:e,label:m[e].label,icon:m[e].icon})})),this.listenTo(this.model,"onChange:"+m.fixed.startFixedField,this.render),this._config&&this._config.isEndDateEnabled&&this.listenTo(this.model,"onChange:"+m.fixed.endFixedField,this.render)},_getInputDate:function(){let e=this._parent.apply(this,arguments);return e.options.showWeekNumbers=this._config.showWeekNumbers,arguments[0]&&arguments[0].hasClassName("start")?this.startDatePicker=e:this.endDatePicker=e,e},render:function(e){s.i18n=h,this._parent.apply(this,arguments);let t=this._config;return t.canEditStartDate&&this.canEditDate()&&(this.startDateConstraintSelect=this.createSelectElement(this.getElement(T.start.select)),this.startConstraintDatePicker=this.startDatePicker),t&&t.isEndDateEnabled&&t.canEditEndDate&&this.canEditDate()&&(this.endDateConstraintSelect=this.createSelectElement(this.getElement(T.end.select)),this.endConstraintDatePicker=this.endDatePicker),this._postTreatmentSelect(this.canEditDate()),t.canEditStartDate&&this.canEditDate()&&(this.startDateConstraintSelect&&this.startDateConstraintSelect.addEventListener("change",this.constraintChanged.bind(this)),this.startConstraintDatePicker&&this.startConstraintDatePicker.addEventListener("change",this.constraintDateChanged.bind(this))),t.canEditEndDate&&this.canEditDate()&&t&&t.isEndDateEnabled&&(this.endDateConstraintSelect&&this.endDateConstraintSelect.addEventListener("change",this.constraintChanged.bind(this)),this.endConstraintDatePicker&&this.endConstraintDatePicker.addEventListener("change",this.constraintDateChanged.bind(this))),this._appendWeekNumbers(this.startDatePicker),this._appendWeekNumbers(this.endDatePicker),this},template:function(){var e=arguments[0].data;return e&&(e=this.setEditFlagOnFields(e)),arguments[0].data=e,this._parent.apply(this,arguments)},canEditDate:function(){var e=this.model.get(d.RESTRICT_ASSIGNEE_ATTR);return this.model.get("canEdit")&&!e},setEditFlagOnFields:function(t){var n=!0;return this._config.hasOwnProperty("canEditStartDate")&&(n=e.is(this._config.canEditStartDate,"function")?this._config.canEditStartDate(this.model):this._config.canEditStartDate),t.canEditStartDate=n&&this.canEditDate(),n=!0,this._config.hasOwnProperty("canEditEndDate")&&(n=e.is(this._config.canEditEndDate,"function")?this._config.canEditEndDate(this.model):this._config.canEditEndDate),t.canEditEndDate=n&&this.canEditDate(),t},_postTreatmentSelect:function(e){var t=function(e,t,n){var s={};let i;Object.keys(m).map((e=>{s[e]=m[e][t]}));var o,a=function(e,n){return e?(i=Object.keys(m).filter((e=>m[e][t]===n)),{selectVal:i[0],pickerVal:e}):null},l=e.normalizedGet(e.model,s.noEarlier),d=e.normalizedGet(e.model,s.noLater),c=e.normalizedGet(e.model,s.fixed);let p=m.fixed[t+"FixedField"]&&e.normalizedGet(e.model,m.fixed[t+"FixedField"]);(o=l?a(l,s.noEarlier):d?a(d,s.noLater):p&&"FALSE"!==p&&"UNDEFINED"!==p&&c?a(c,s.fixed):{selectVal:"none",pickerVal:""})&&(n?(o.pickerVal&&e[t+"ConstraintDatePicker"]&&(e[t+"ConstraintDatePicker"].fireOnlyFromUIInteractionFlag=!0,e[t+"ConstraintDatePicker"].value=o.pickerVal.actualValue,e[t+"ConstraintDatePicker"].fireOnlyFromUIInteractionFlag=!1),e[t+"DateConstraintSelect"].value=o.selectVal,e[t+"DateConstraintLimit"]=o.selectVal,e.toggleDateConstraint(t+"ConstraintDatePicker",{value:o.selectVal})):(T[t].datepicker&&o.pickerVal&&e.getElement(T[t].datepicker).setText(o.pickerVal.displayValue+r.getWeekNumber(o.pickerVal.actualValue)),T[t].select&&e.getElement(T[t].select).setText(m[o.selectVal].label)))};t(this,"start",e&&this._config.canEditStartDate),this._config&&this._config.isEndDateEnabled&&t(this,"end",e&&this._config.canEditEndDate)},createSelectElement:function(e){var t=new i({enableSearchFlag:!1,actionOnClickFlag:!1,elementsList:this.elementsList});return t.inject(e,"top"),t},constraintChanged:function(t){var n=t.dsModel&&t.dsModel.value,s=this.elementsList.detect((function(e){return e.value===n}));if(s){var i=e.Event.getElement(t);let n=this.getConstraintType(i);this.toggleDateConstraint(n+"ConstraintDatePicker",s),this[n+"DateConstraintLimit"]=s.value;let o=T[n].constraintPickerVal,a=m[this[n+"DateConstraintLimit"]][n],r=this.getDateValue(this[n+"ConstraintDatePicker"],null,n);this.setValueOnModel(r,o,n,a)}},constraintDateChanged:function(t){var n=e.Event.getElement(t);let s=this.getConstraintType(n);var i=this.getDateValue(null,t,s);let o=T[s].constraintPickerVal,a=m[this[o]][s];this.setValueOnModel(i,o,s,a)},getDateValue:function(t,n,s){var i=t||e.Event.getElement(n),o=t?i.value:n.dsModel.value,a=o;if(""!==o){var r=new Date(o);if(o&&this.model.nonWorkingDayIterator){var l=this.model.nonWorkingDayIterator._workingHours[o.getDay()];l||(l={start:{hours:8,minutes:0,totalMinutes:480},end:{hours:16,minutes:0,totalMinutes:960}}),r.setHours(l[s].hours,0,0,0)}a=r.getTime()}return isNaN(a)?"":{actualValue:a}},setValueOnModel:function(e,t,n,s){if(e){if("noEarlier"===this[t]||"noLater"===this[t]){let i="noEarlier"===this[t]?m.noLater[n]:m.noEarlier[n];this.normalizedSet(this.model,{name:i,validate:!0},null),s&&this.normalizedSet(this.model,{name:s,validate:!0},e),m.fixed[n+"FixedField"]&&s&&this.normalizedSet(this.model,{name:m.fixed[n+"FixedField"]},!1)}else m.noLater&&this.normalizedSet(this.model,{name:m.noLater[n]},null),m.noEarlier&&this.normalizedSet(this.model,{name:m.noEarlier[n]},null),s=m.fixed[n],this[t]&&this.normalizedSet(this.model,{name:m.fixed[n]},e),m.fixed[n+"FixedField"]&&s&&this.normalizedSet(this.model,{name:m.fixed[n+"FixedField"],validate:!0},"none"!==this[t]);this._parentView&&this._parentView._updateGroupTitle()}},getConstraintType:function(e){let t=e.parentElement;return t&&t.id.contains("start")?"start":"end"},toggleDateConstraint:function(e,t){this[e]&&("none"===t.value?this[e].hide():this[e].show())},enableRefreshView:()=>!1,destroy:function(){this._parent.apply(this,arguments)}});return E})),define("DS/E6WCommonApps/Views/RichTextEditorView",["DS/E6WCommonUI/Views/TextAreaView","UWA/Core","UWA/Element","DS/Handlebars/Handlebars4","text!DS/E6WCommonApps/assets/templates/richtexteditor.html.handlebars","DS/CKEditor/CKEditor","DS/E6WCommonApps/Views/RichTextEditorConfig","DS/RDFFoundation/Models/ComponentProxyModel","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l,d){"use strict";var c="drag-over",p=function(e){return d.get(e)},u=e.extend({_uwaClassName:"RichTextEditorView",className:"RTEditor-container details-display-shared-view ddv-field form-group",compiledTemplate:s.compile(i),domEvents:{"click .expandEditor":"toggleMinimizedMaximized"},setup:function(){this._config.title=this.model?this.model.get(this._config.titleAttribute):"",this._parent.apply(this,arguments),this._initializing=!1},enableRefreshView:()=>!1,render:function(){return this.instance||this._parent.apply(this,arguments),this.container.getElement(".actions").hide(),this.editorInstanceName="editor_"+this._config.name+"_"+this.cid,this.updateData(),this},_renderEditor:function(e){if(this._initializing=!1,this.container&&!this.editorInitInterval){var t=function(e){this.editorInitialize?this.container&&this.container.getElement(".ck-editor")&&(this.createTextAreaField(),this.destroyEditor(),this.setupEditor(a.getConfig(this._config),e),this.updateEditorData(e),clearInterval(this.editorInitInterval),delete this.editorInitInterval):this.editorInitialize=!0}.bind(this);this.editorInitInterval=window.setInterval((()=>t(e)),10)}},createTextAreaField:function(){let e=Math.random().toString(16).slice(2);this._textField=new n("div",{id:`editor_${this._config.name}_${this.cid}_${e}`,name:`editor_${this._config.name}_${this.cid}_${e}`,style:"display:none"}),this._textField.inject(this.container.getElement(".ck-editor")),this.editorInstanceName=`editor_${this._config.name}_${this.cid}_${e}`},updateData:function(){const e=this.model,t=this.container,n=this._config,s=n.richTextField;if(e&&t)try{const t=this.normalizedGet(e,"richTextDescription");s&&t?(!t.fetching&&this.updateEditorData(e.get("richTextDescription")),this.listenTo(e,"onChange:richTextDescription",(e=>{this.updateEditorDataIfValid(e,"richTextDescription")})),"richTextDescription"!==s&&this.listenTo(e,`onChange:${s}`,(e=>{this.updateEditorDataIfValid(e,s)}))):this.updateEditorData(this.normalizedGet(e,n.name))}catch(e){console.log("Panel Closed")}},updateEditorDataIfValid:function(e,t){const n=e.get(t);(n&&!n.fetching||null==n)&&this.updateEditorData(n)},updateEditorData:function(e){const t=this.container.getElement("#"+this.editorInstanceName);if(this.instance&&t){t.value=e&&null!=e?e:"";try{this.instance.getData()!==e&&this.instance.setData&&this.instance.setData(e,{noSnapshot:!0})}catch(e){}}else this._renderEditor(e)},setupEditor:function(e,t){if(this.container&&this.container.getElement("#"+this.editorInstanceName)&&!this.instance&&!this._initializing)try{this._initializing=!0;var n=this;o.addCss("html{cursor:auto;}::-webkit-scrollbar {width: 6px;height: 6px;} ::-webkit-scrollbar-track { background: #f1f1f1;} ::-webkit-scrollbar-thumb {background: #888;border-radius: 0.25em; } ::-webkit-scrollbar-thumb:hover { background: #555; } a { cursor : pointer} "),this.instance=o.replace(this.container.getElement("#"+this.editorInstanceName),e),this.instance&&(this.instance.on("instanceReady",(function(e){n._initializing=!1,n.container.getElement(".actions").show(),n._createToolbar(this),n._handleEmoji();try{e.editor.setReadOnly(!(n.normalizedGet(n.model,"canEdit")&&n._config.readWrite))}catch(e){console.log(e)}})),this.instance.on("paste",(function(e){var t=e.data.dataValue;try{n.checkForImg(e.data.dataValue)}catch(e){console.log(e)}try{(t=JSON.parse(t)).protocol&&t.data.items&&t.data.items.length>0&&(e.data.imageLoaded||(e.data.dataValue=""))}catch(e){}e.data&&e.data.imageLoaded&&(e.data.dataValue=e.data.imageLoaded)})),this.instance.once("contentDom",(function(){var e=n.instance.editable();e.attachListener(n.instance.document,"dragover",(function(e){n.handleDragOver(e)})),e.attachListener(n.instance.document,"dragenter",(function(e){n.handleDragOver(e)})),e.attachListener(n.instance.document,"drop",(function(e){let t=e.data.$.dataTransfer,s=n.container.getElement("#hidden_img"),i=function(t){n.container.getElement("#hidden_img").src=t,e.dataValue='<img src="'+t+'" />',e.imageLoaded='<img src="'+t+'" />',e.type="text",e.method="drop",n.instance.fire("paste",e)};if(t.types&&-1!==t.types.indexOf("Files")){let n=t.files[0];if(n.type.match("image.*")){if(FileReader){let e=new FileReader;e.onload=e=>{s.onload=()=>{l.scaleImage(s,n.name,n.type,i,{maxWidth:1200,maxHeight:1200,maxByteSize:25e4}),s.onload=null},s.src=e.target.result},e.onerror=function(){},e.onabort=function(){},e.readAsDataURL(n)}e.data.preventDefault(!0)}}else{var o=t.getData("text/plain");if(o)try{o=JSON.parse(o);const{protocol:e,data:{items:t}}=o;if(e&&t){const e=t[0];if(1===t.length&&e){if(e.displayPreview)s.src=e.displayPreview;else{e.id=r.computeURI(e);var a=r.getNewProxyModel(l.getObjectDataFromDropSearchOrTypeAhead({dropObj:e}));a&&a.indexModel&&n.listenTo(a.indexModel,"onChange",(function(){const e=a.get("image");s.src=e,n.createBase64Img(s,i)}))}n.createBase64Img(s,i)}}}catch(e){}}n.handleDragLeave(e)})),e.attachListener(n.instance.document,"dragend",(function(e){n.handleDragLeave(e)})),e.attachListener(n.instance.document,"dragleave",(function(e){n.handleDragLeave(e)})),e.attachListener(e,"click",(function(e){var t=new CKEDITOR.dom.elementPath(e.data.getTarget(),this).contains("a");t&&2!==e.data.$.button&&window.open(t.getAttribute("href"),"_blank")}),null,null,15)})))}catch(e){this._initializing=!1,this._renderEditor(t),console.log(e)}this.instance&&(this.instance.setActiveFilter(!1),this._registerEvents()),o.on("dialogDefinition",(function(e){var t=e.data.name,n=e.data.definition;"link"===t&&n.getContents("info").get("linkType").items.splice(1,1)}))},checkForImg:function(e){if(!e)return e;const t=e.match(/<img [^>]*src="[^"]*"[^>]*>/gm);return t&&t.length>0&&t.forEach((e=>{this.container.getElement("#hidden_div").innerHTML=e;const t=this.container.getElement("#hidden_div img");t&&t.src&&this.createBase64Img(t.src,(e=>{this.updateEditorImagesToBase64(t.src,e)}))})),e},updateEditorImagesToBase64:function(e,t){try{this.instance.setData(this.instance.getData().htmlDecode().replace(e,t))}catch(e){console.log(e)}},_createToolbar:function(e){if(e.ui){var t=e.ui.space("toolbar_collapser");if(t&&t.getPrevious()){var n=t.getPrevious();if(null!=n){n.addClass("iterate_tbx_hidden"),n.isVisible()||n.show(),t.getFirst().setText(""),t.addClass("cke_toolbox_collapser_min"),t.setAttribute("title",p("E6WCommonApps.Label.Expand")),this.switchVisibilityAfter1stRow(n,!1);var s=e.ui.space("contents");e.fire("resize",{outerHeight:e.container.$.offsetHeight,contentsHeight:s.$.offsetHeight,outerWidth:e.container.$.offsetWidth})}}}return!1},_registerEvents:function(){var e=this;this.instance.on("change",(function(){e._checkIfChangeNeeded()&&e.onCKEInputDataEvent()}))},convertUrltoBase64:function(e,t){var n=new Image;n.setAttribute("crossorigin","anonymous"),n.onload=function(){t(n)},n.src=e.src?e.src:e},createBase64Img:function(e,t){this.convertUrltoBase64(e,(function(e){l.scaleImage(e,null,null,t,{maxWidth:1200,maxHeight:1200,maxByteSize:25e4})}))},_checkIfChangeNeeded:function(){return this.instance&&this.normalizedGet(this.model,this._config.name)!==this.instance.getData()},onCKEInputDataEvent:function(){null!==this.container&&this.normalizedSet(this.model,this._config,this.instance.getData())},_postTreatmentTextArea:()=>{},switchVisibilityAfter1stRow:function(e,t){if(void 0!==e)for(var n=!0,s=e.getChildren(),i=s.count(),o=0;o<i;o++){var a=s.getItem(o);(n=n&&!(a.is("span")&&a.hasClass("cke_toolbar_break")))||(t?a.show():a.hide())}},_handleEmoji:function(){var e=this,t=this.instance&&this.instance.editable();t&&t.attachListener(t,"input",(function(){e.instance.fire("change")}))},handleDragLeave:function(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.container.removeClassName(c)},handleDragOver:function(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.normalizedGet(this.model,"canEdit")&&this._config.readWrite&&this.container.addClassName(c)},destroy:function(){this.editorInitInterval&&clearInterval(this.editorInitInterval),delete this.editorInitInterval,this.destroyEditor(),this._parent.apply(this,arguments)},destroyEditor:function(){var e=this.instance;if(e){switch(e.status){case"destroyed":break;case"ready":case"unloaded":e.removeAllListeners(),e.destroy(),delete e.mode;break;default:e.once("instanceReady",(function(){e.removeAllListeners(),e.destroy()}))}try{o.remove(this.editorInstanceName)}catch(e){console.log(e)}delete this.instance}},toggleMinimizedMaximized:function(e){if(e.target&&(e.target.hasClassName("fonticon-resize-fullscreen")||e.target.hasClassName("fonticon-resize-fullscreen-off"))){var t=this.container.getElement(".expandEditor > span"),n=t.hasClassName("fonticon-resize-fullscreen");this.instance&&(t.toggleClassName("fonticon-resize-fullscreen-off",n),t.toggleClassName("fonticon-resize-fullscreen",!n),this.instance.execCommand("maximize"),this.container.getElement(".expandEditor").setAttribute("title",t.hasClassName("fonticon-resize-fullscreen")?p("E6WCommonApps.Label.Expand"):p("E6WCommonApps.Label.Collapse")))}},getTextValue:function(){var e=this.instance&&this.instance.getData();return e=e&&e.replace(/^(?=\n)$|^\s*|\s*$|\n\n+/gm,"")},getViewAllHeight:function(){return this._parent()+10},getDesiredHeight:function(){return this._parent()+10},getFocusDesiredHeight:function(){return this._parent()+10}});return u})),define("DS/E6WCommonApps/Models/Document/DocumentObject",["UWA/Core","UWA/Class","DS/E6WCommonApps/Models/Document/DriveDocument","DS/E6WCommonApps/Models/Document/CollabspaceDocument"],(function(e,t,n,s){"use strict";var i=[".gif",".jpg",".png",".gif",".jpeg",".3dxml",".cgr",".pdf",".bpm",".psd",".ai"];return t.extend({init:function(t,i,o){var a=e.clone(t||{},!1);this.type=o,this.model="drive"===o?new n(a,i):new s(a,i)},_isImageFile:function(){var e,t=this.model.get("fileName").lastIndexOf(".");if(-1!==t){var n=this.model.get("fileName").substring(t);e=-1!==i.indexOf(n.toLowerCase())}return e},_createImageBlob:function(){try{return window.URL.createObjectURL(this.model.get("file"))}catch(e){return null}},get:function(e){return"image"===e?this.getImage():this.model.get(e)},getImage:function(){return this._isImageFile(this.model.file)?this._createImageBlob():this.model.get("icon")?this.model.get("icon"):this.model.get("image")}})})),define("DS/E6WCommonApps/Models/FileManagementMixin",["UWA/Core","DS/DocumentManagement/DocumentManagement","DS/DocumentManagement/DriveDocumentManagement","DS/DocumentCreateNew/CreateNew","DS/RDFFoundation/SecurityContextUtils","DS/Foundation/FoundationAjax","DS/E6WCommonUI/UIHelper","DS/RDFFoundation/Models/CollabspaceRepositoryModel","DS/RDFFoundation/Models/ComponentProxyModel","DS/RDFFoundation/Models/DriveRepositoryProxyModel","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ObjectProxyUtil","DS/E6WCommonUI/PlatformManager","DS/Windows/ImmersiveFrame","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/NoAccessModel","DS/E6WCommonApps/Models/Document/DocumentObject","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,E,g,A){"use strict";var C=function(e){return g.get(e)},_={_normalizedRepo:function(e){var t=this.getRepositoryModelConstructor(e),n=c.getObjectForAdding(t,e);return n.hasViewAccess()?n:new T},uploadFiles:function(e,t,n){if(this.getDriveRepositoryId(n))for(let s=0;s<e.length;s++)this.uploadFileToDrive(e[s],t,n);else this.uploadFile(e,t,n)},getRepositoryModelConstructor:function(e){return e.startsWith(d.ID_PREFIX)?d:r},uploadFile:function(t,n,i){var o=this;this._validateBeforeUpload(),this._fileUploadCount=this._fileUploadCount?this._fileUploadCount+1:1;var a,r=e.clone(i||{},!1);r.fieldName=n;try{a=this._getCreateDocumentOptions(r)}catch(e){return void o.onFileUploadFailureMessage(r,e.message)}a.onDocumentUpload=function(e){let n=new E(e,t);o.onFileUploadComplete(n,r)},a.onError=function(n){n&&e.merge(r,{errorMsg:n.error||n.message}),o._onFileUploadFailure(t,r)};var l=new h;l.reactToPointerEventsFlag=!1,l.inject(widget.body),a.immersiveFrame=l;var d=this.get("dsplan:hasBookmark");d&&(a.parentId=d.get("physicalId"),a.parentRelName="Vaulted Objects");try{new s(a).create(t)}catch(e){console.log(e)}},documentGetTypeInfoOptions:function(t){var n=e.clone(t||{},!1);return n.csrf=this.csrf,n.tenant=u.getTenant(),n.tenantUrl=u.getServiceUrl("3DSpace",!0),n},_getCreateDocumentOptions:function(t){var n=this.documentGetTypeInfoOptions(t);if(e.is(this.isRDFTask,"function")&&!this.isRDFTask()){n.parentId=this.id,n.parentRelName="deliverables"===n.fieldName?"Task Deliverable":"Reference Document";let e=i.fetchSecurityContextByRepo(this.get("project"));n.securityContext=e?e.actualValue:null}else{let e=this.get(m.CONTENT_REPOSITORY)&&i.fetchSecurityContextByRepo(this.get(m.CONTENT_REPOSITORY).id);n.securityContext=e?e.actualValue:null}n.securityContext||(n.securityContext=i.getDefaultSecurityContext()),n.onCancel=Function.prototype;var s=this._validateFileUploadRepositoryAccess(n);if(s)throw n.onFailure&&n.onFailure(s),new Error(s);var o=this.getDriveRepositoryId(n);return o&&(n.tenantUrl=u.getServiceUrl("3DDrive")),n.driveFolderId=o,n.onCancel=Function.prototype,n},uploadFileToDrive:function(n,s,i){var o,a=this,r=e.clone(i||{},!1);r.fieldName=s;try{o=this._getCreateDocumentOptions(i)}catch(e){return}let l=r.cloneModel,d=l?l.get(m.CONTENT_REPOSITORY):this.get(m.CONTENT_REPOSITORY);var c={fileInfo:{file:n},relInfo:o.relInfo,collabspace:!o.driveFolderId&&(o.collabspaceId||d.id),driveFolderId:o.driveFolderId};o.onComplete=function(e){let t=new E(e,n,"drive");a.onFileUploadComplete(t,r)},o.onFailure=function(t){var s=t&&t.error;s&&e.merge(r,{errorMsg:s}),a._onFileUploadFailure(n,r)},t.createDocument(c,o)},_validateBeforeUpload:function(){if(!this.id)throw new Error("Invalid object, cannot upload file on a model not saved yet")},_validateFileUploadRepositoryAccess:function(t){var n,s=e.clone(t||{},!1);let o=s.cloneModel,a=o?o.get(m.CONTENT_REPOSITORY):this.get(m.CONTENT_REPOSITORY);var r=s.driveFolderProxyId||s.collabspaceId;!r&&a&&(r=a.id),r?r&&r.startsWith(d.ID_PREFIX)?(a=c.getObjectById(r),a&&!a.hasViewAccess()&&(n=C("E6WCommonApps.Error.NoContentRepositoryAccess"))):i.hasAccessToContentRepository(r)||0===i.getUsersContentRepositories().length&&(n=C("E6WCommonApps.Error.NoContentRepositoryAndNoneAvailable")):0===i.getUsersContentRepositories().length&&(n=C("E6WCommonApps.Error.NoContentRepositoryAndNoneAvailable"));var l=this.get("dsplan:hasBookmark");return l&&!l.hasViewAccess()&&(n=A.get("E6WCommonUI.Error.noAccessOnBookmark")),n},getDriveRepositoryId:function(t){var n,s=e.clone(t||{},!1);let i=s.cloneModel;var o=s?s.driveFolderProxyId:null,a=i?i.get(m.CONTENT_REPOSITORY):this.get(m.CONTENT_REPOSITORY);return o||(o=a&&a.id),o&&o.startsWith(d.ID_PREFIX)&&(n=(a=c.getObjectById(o))&&a.get("physicalId")),n},_onFileUploadFailure:function(t,n){this._fileUploadCount--;var s=e.clone(n||{},!1);s.file=t;var i=s.errorMsg||null;e.is(n.onFailure,"function")&&n.onFailure(s,i),this.onFileUploadFailureMessage(s,i)},isUploadingFiles:function(){return Boolean(this._fileUploadCount)},updateDocument:function(s,i,o){var r=i.get("dscom:ServiceHosting"),l=i.get("physicalId"),d=i.get("dscom:Tenant");"3DDrive"===r&&(s=n.getNewBlobFileWithOldName(s,i));var c={id:l,fileInfo:{file:s,comments:o}};t.modifyDocument(c,{tenant:d,serviceId:r,tenantUrl:window.enoviaServer[r],onComplete:function(t,n){var o=e.clone(n||{},!1);if(o.proxyModel=i,_._updateModificationDate(t,o),"3DDrive"!==r){var l=s.name.substring(0,s.name.lastIndexOf("."));l!==i.get("title")&&i.set("title",l)}a.displaySuccess(C("E6WCommonApps.Alert.UpdateSucess"))},onFailure:function(e){e.internalError?a.displayError(e.internalError):a.displayError(C("E6WCommonApps.Alert.UpdateFail"))}})},_addFile:function(t,n,s){var i=e.clone(s||{},!1);let o=this;if(n.isThumbnail)o.uploadThumbnail(n.input,t,{fileWrapper:n.value});else{var a,r,l={fieldName:t,fileName:n.input.FileName};e.merge(l,i),n.input instanceof window.File&&(l.fileName=n.input.name),a=this.onFileUploadComplete.bind(this),r=this.onFileUploadFailure.bind(this),e.is(this.uploadFiles,"function")&&this.uploadFiles([n.input],t,e.merge({fileWrapper:n.value,onComplete:a,onFailure:r,fieldName:t},i))}},_updateModificationDate:function(e,t){if(e){var n=e.modified;"3DSpace"===t.serviceId&&(n=e.data[0].relateddata.files[0].dataelements.modified);var s=p.getDate(n);t.proxyModel.set("modified",s)}},buildBatchWithPreprocessedObjects:function(e){var t=e&&e.batch,n=e&&e.attributesToBeUpdated||{},s=Object.keys(n);if(s.length){var i=e.onFailure;t=t||c.getBatchGenerator();for(var o=0;o<s.length;o++)for(var a=s[o],r=0;r<n[a].length;r++){var d=n[a][r];d instanceof l!=!1&&(delete d.collection,d.save(void 0,{ajax:t.ajax,newTransaction:!0,onFailure:i}))}}return t},saveModelAfterFileUpload:function(t,n){var s=e.clone(t||{},!1),i=s.onFailure;s.onFailure=function(e,t){t&&401===t["@code"]?a.displayError(A.get("E6WCommonUI.Error.noAccessOnObject")):t&&t.message&&a.displayError(C(t.message)),i&&i(arguments)},n?(s.changed=!0,s.ajax=n.ajax,s.newTransaction=!0,this.save(void 0,s),delete(s=e.clone(s||{},!1)).ajax,delete s.onComplete,delete s.onFailure,n.sendBatch(s)):this.save(void 0,s)},onFileUploadCompleteMessage:function(e){var t=C("emxFoundation.Label.FileUploadSuccess");t=t.replace("%FILE_NAME%",e.fileName),a.displaySuccess(t)},onFileUploadComplete:function(t,n){this._fileUploadCount--,e.merge(n,this._options||{});var s=n.fieldName,i={};if(e.is(this.isRDFTask,"function")&&!this.isRDFTask()){let e=t.get("document"),n=t.get("file");e.dataelements.hasfiles="TRUE",t._isImageFile()&&!n.FileName&&(e.dataelements.image=window.URL.createObjectURL(n)),i.fileName=t.get("title"),this.updateRelatedObjectWithNewEntry(e,s),this.onFileUploadCompleteMessage(i)}else{var o={id:t.get("id"),title:t.get("title"),serviceId:t.get("serviceId"),tenant:window.enoviaServer.tenant,image:t.get("image")},a=l.getNewProxyModel(o);if(a.forceAccess=!0,a["@type"]=t.get("type"),n&&n.config&&n.config.singleObjectOnly){var r=this.get(s);r&&r.length&&this.removeObject(s,r._models[0],n),this.set(s,a)}else this.addObjects([a],s,void 0,{silentOnChange:!0,at:0,values:[a]});i.attributesToBeUpdated=i.attributesToBeUpdated||{};var d=i.attributesToBeUpdated[s]||[];d.push(a),i.attributesToBeUpdated[s]=d;var c=this.buildBatchWithPreprocessedObjects(i);i.fileName=t.get("title");var p=this.get("dsplan:hasBookmark");p&&(i.relInfo={parentDirection:"From",parentId:p.get("physicalId"),parentRelName:"Vaulted Objects"});var u=this;i.onComplete=function(){u.onFileUploadCompleteMessage(i),u.dispatchEvent("onChange:"+s,[u,n])},this.saveModelAfterFileUpload(i,c)}},onFileUploadFailure:function(t,n){e.merge(t,this._options),this._parent.apply(this,arguments)},onFileUploadFailureMessage:function(e,t){e&&e.model?e.model.dispatchEvent("onChange:"+e.fieldName,[e.model]):this&&this.dispatchEvent&&this.dispatchEvent("onChange:"+e.fieldName,[this]);var n=t;n||(n=(n=C("emxFoundation.Error.FileUploadFailed")).replace("%FILE_NAME%",e.fileName)),a.displayError(n)}};return _})),define("DS/E6WCommonApps/GoverningProcess/GoverningProcessAccordionView",["UWA/Core","DS/E6WCommonApps/GoverningProcess/GoverningProcessFieldsView","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/RDFFoundation/BusinessProcessUtils","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o){"use strict";var a=n.extend({_uwaClassName:"GoverningProcessAccordionView",tagName:"div",className:"form-section accordion details-display-shared-view ddv-field form-group",domEvents:{"click .form-section-title":"_onGoverningProcessLabelClicked"},id:function(){return"GoverningProcessAccordionView_"+this.cid},setup:function(){this._parent.apply(this,arguments),this._setupGroupElements()},_setupGroupElements:function(){this._titleElem=e.createElement("div",{class:"form-section-title",html:o.get("E6WCommonApps.Label.GoverningProcessModel")}),this._fieldContainer=e.createElement("div",{class:"form-section-body"})},render:function(){return this._processModelView&&(this._processModelView.removeAutoCompleteFromDOM(),this._processInstanceView.removeAutoCompleteFromDOM()),this.container.empty(!0),this._titleElem.inject(this.container),this._fieldContainer.inject(this.container),this._expanded&&this._drawGoverningProcessFields(),this},_drawGoverningProcessFields:function(){this._processModelView||this._processInstanceView||this._setupProcessObjectViews(),this._fieldContainer.empty(!0),this._processModelView.render().inject(this._fieldContainer),this._processInstanceView.render().inject(this._fieldContainer)},_onGoverningProcessLabelClicked:function(e){this._expanded=void 0!==e?e:!this._expanded,this.render()},_setupProcessObjectViews:function(){var n=this,a=function(t){var s=e.merge({attributeToDisplay:"title",type:"object",singleObjectOnly:!0},t);return{i18n:o,isPropertyPanel:!0,model:n.model,config:s}};let r=require("DS/E6WCommonApps/Utils/ScenariosUtils");const l=r&&r.inScenario();this._processModelView=new t(a({readWrite:!n.model.model.get(i.GOVERNING_PROCESS_INSTANCE_ATTR)&&!l&&!0,name:i.GOVERNING_PROCESS_MODEL_ATTR,label:o.get("E6WCommonApps.Label.GoverningProcessModel"),placeHolder:o.get("E6WCommonApps.Label.ObjectPlaceHolder"),minLengthBeforeAutocomplete:0,typeAheadCallback:s.typeAheadCallback,customTooltips:[{iconClass:"info",tooltipTitle:o.get("E6WCommonApps.Label.GoverningProcessModel"),tooltipBody:o.get("E6WCommonApps.Label.Tooltip.GoverningProcessModel")}]})),this._processInstanceView=new t(a({readWrite:!1,name:i.GOVERNING_PROCESS_INSTANCE_ATTR,label:o.get("E6WCommonApps.Label.GoverningProcessInstance"),customTooltips:[{iconClass:"info",tooltipTitle:o.get("E6WCommonApps.Label.GoverningProcessInstance"),tooltipBody:o.get("E6WCommonApps.Label.Tooltip.GoverningProcessInstance")}]})),this.addChildView(this._processModelView),this.addChildView(this._processInstanceView)}});return a})),define("DS/E6WCommonApps/Models/HistoryViewConstants",["DS/E6WCommonApps/ScheduleConstants","DS/E6WCommonUI/UIHelper"],(function(e,t){"use strict";const n="http://www.3ds.com/RDF/Corpus/",s=`${n}Plan/`,i=`${n}Kernel/`,o=`${n}xPlan/`,a={HAS_ATTACHMENT:`${s}hasAttachment`,ACTUAL_DELIVERABLE:`${s}actualDeliverable`,HAS_WORK_CONTEXT:`${s}hasWorkContext`,HAS_CONTENT_REPOSITORY:`${s}hasContentRepository`,HAS_BOOKMARK:`${s}hasBookmark`,SCHEDULE_CALENDAR:`${s}scheduleCalendar`,HAS_COMMUNITY:`${s}hasCommunity`,HAS_LEAN_BOARD:`${s}hasLeanBoard`,HAS_BASELINE:`${s}hasBaseline`,HAS_ASSIGNEE:`${s}hasAssignee`,HAS_CANDIDATE_ASSIGNEE:`${s}hasCandidateAssignee`,OWNER:`${i}owner`,HAS_NOTIF_SUBSCRIBER:`${s}hasNotifSubscriber`,HAS_NOTIF_UNSUBSCRIBER:`${s}hasNotifUnsubscriber`,LOGICAL_ASSIGNEE:`${s}logicalAssignee`,LOGICAL_MEMBER:`${s}logicalMember`,SCHEDULING_STRATEGY:`${s}schedulingStrategy`,ACTUAL_DATES_STRATEGY:`${s}actualDatesStrategy`,SCHEDULING_FROM_STRATEGY:`${s}schedulingFromStrategy`,NLS_LABEL:`${i}nlsLabel`,COMMENT:`${s}comment`,HAS_THUMBNAIL:`${s}hasThumbnail`,HAS_WORK_DECOMPOSITION:`${s}hasWorkDecomposition`,HAS_PROJECT:`${s}hasProject`,HAS_TASK:`${s}hasTask`,HAS_SUB_TASK:`${s}hasSubtask`,HAS_MILESTONE:`${s}hasMilestone`,HAS_GATE:`${s}hasGate`,HAS_REFERENCE_PROJECT:`${s}hasReferenceProject`,PROJECT_TYPE:`${s}projectType`,HAS_EXPERIMENT:`${s}hasExperiment`,JS_TYPE:`${s}jsType`,HAS_MATURITY:`${`${n}com/`}hasMaturity`,HAS_PRIORITY:`${s}hasPriority`,VOCABULARY_TYPE:`${s}vocabularyType`,ACTUAL_START_DATE:`${s}actualStartDate`,ACTUAL_END_DATE:`${s}actualEndDate`,ESTIMATED_END_DATE:`${s}estimatedEndDate`,ESTIMATED_START_DATE:`${s}estimatedStartDate`,SUGGESTED_DATE:`${s}suggestedDate`,ESTIMATED_DATE:`${s}estimatedDate`,START_DATE_INTERVAL_MIN:`${s}startDateIntervalMin`,DATE_INTERVAL_MIN:`${s}dateIntervalMin`,DATE_INTERVAL_MAX:`${s}dateIntervalMax`,START_DATE_INTERVAL_MAX:`${s}startDateIntervalMax`,END_DATE_INTERVAL_MIN:`${s}endDateIntervalMin`,END_DATE_INTERVAL_MAX:`${s}endDateIntervalMax`,ESTIMATED_DURATION:`${s}estimatedDuration`,DURATION_INTERVAL_MIN:`${s}durationIntervalMin`,DURATION_INTERVAL_MAX:`${s}durationIntervalMax`,USES_CALENDAR:`${s}usesCalendar`,SEQUENCE_ORDER:`${s}sequenceOrder`,PERCENTAGE_COMPLETION:`${s}percentageCompletion`,USER_DEFINED_END:`${s}userDefinedEnd`,USER_DEFINED_START:`${s}userDefinedStart`,REMINDER_DAYS:`${s}reminderDays`,HAS_CHECKLIST_ITEM:`${s}hasChecklistItem`,USER_DEFINED_DATES:`${s}userDefinedDates`,LAG:`${o}lag`,DEPENDENCY_TO:`${o}to`,IS_ENFORCED:`${o}isEnforced`,DEPENDENCY_FROM:`${o}from`,CONSTRAINT_TYPE:`${o}constraintType`,ITERATION_CAPACITY:`${s}iterationCapacity`,HAS_PROCESS_MODEL:`${s}hasProcessModel`,HAS_PROCESS_INSTANCE:`${s}hasProcessInstance`,ENTERPRISE_ID_NO:`${s}enterpriseIdentificationNumber`,HAS_BACKLOG_TASK:`${s}hasBacklogTask`,BACKLOG_QUERY:`${s}backlogQuery`,GATE_RESOLUTION:`${s}resolution`},r={[e.ADDED]:e.REMOVED,[e.REMOVED]:e.ADDED},l={OBJECT_TYPE_FIELDS:[a.HAS_ATTACHMENT,a.ACTUAL_DELIVERABLE,a.HAS_WORK_CONTEXT,a.HAS_CONTENT_REPOSITORY,a.HAS_BOOKMARK,a.SCHEDULE_CALENDAR,a.HAS_COMMUNITY,a.HAS_LEAN_BOARD],ASSIGNEE_TYPE_FIELDS:[a.HAS_ASSIGNEE,a.HAS_CANDIDATE_ASSIGNEE,a.OWNER,a.HAS_NOTIF_SUBSCRIBER,a.HAS_NOTIF_UNSUBSCRIBER],USER_GROUP_FIELDS:[a.LOGICAL_ASSIGNEE,a.LOGICAL_MEMBER],OBJECT_CREATION_DELETION_FIELDS:[a.HAS_MILESTONE,a.HAS_TASK,a.HAS_SUB_TASK,a.HAS_BACKLOG_TASK,a.HAS_REFERENCE_PROJECT,a.HAS_WORK_DECOMPOSITION,a.HAS_PROJECT,a.HAS_GATE,a.HAS_ATTACHMENT,a.ACTUAL_DELIVERABLE,a.HAS_WORK_CONTEXT,a.JS_TYPE,a.ENTERPRISE_ID_NO,a.HAS_EXPERIMENT,"dsplan:Project","dsplan:Task","dsplan:Milestone","dsplan:Gate","dsplan:AgileProject","dsplan:xProject"],DATE_FIELDS:[a.ACTUAL_START_DATE,a.ACTUAL_END_DATE,a.ESTIMATED_END_DATE,a.ESTIMATED_START_DATE,a.SUGGESTED_DATE,a.ESTIMATED_DATE,a.DATE_INTERVAL_MIN,a.DATE_INTERVAL_MAX,a.START_DATE_INTERVAL_MIN,a.START_DATE_INTERVAL_MAX,a.END_DATE_INTERVAL_MIN,a.END_DATE_INTERVAL_MAX],DURATION_FIELDS:[a.ESTIMATED_DURATION,a.DURATION_INTERVAL_MIN,a.DURATION_INTERVAL_MAX],IGNORED_FIELDS:[a.NLS_LABEL]};return{NO_ACCESS:"NO ACCESS",SUBSCRIBER_ACTION_MAP:r,FIELDS:a,FIELD_NLS_MAP:n=>{n=n||{};const o=t.isProject(n.objectType);return{[a.HAS_ATTACHMENT]:"E6WCommonApps.Label.Attachments",[a.ACTUAL_DELIVERABLE]:"E6WCommonApps.Label.Deliverables",[a.HAS_WORK_CONTEXT]:"E6WCommonApps.Label.ContributesTo",[`${s}restrictAssigneeAccess`]:"xPlan.Label.RestrictAssigneeAccess",[a.HAS_THUMBNAIL]:"xPlan.Label.Thumbnail",[`${s}hasCollaborativeSpace`]:"E6WCommonApps.Label.CollaborativeSpaceForRisk",[a.HAS_CONTENT_REPOSITORY]:"E6WCommonApps.Label.CollaborativeSpace",[a.HAS_BOOKMARK]:"E6WCommonApps.Label.BookmarkForRepository",[a.SCHEDULE_CALENDAR]:"E6WCommonApps.Label.Calendar",[a.HAS_COMMUNITY]:"E6WCommonApps.Label.Community",[a.HAS_LEAN_BOARD]:"E6WCommonApps.Label.LeanBoard",[a.HAS_BASELINE]:"xPlan.Label.Baseline",[a.HAS_ASSIGNEE]:o?"E6WCommonApps.Label.ProjectManager":"E6WCommonApps.Label.Assignees",[a.HAS_CANDIDATE_ASSIGNEE]:"E6WCommonApps.Label.CandidateAssignees",[a.OWNER]:"E6WCommonApps.Label.Owner",[a.HAS_NOTIF_SUBSCRIBER]:"E6WCommonApps.Label.Subscriber",[a.HAS_NOTIF_UNSUBSCRIBER]:"E6WCommonApps.Label.UnSubscriber",[a.LOGICAL_ASSIGNEE]:"E6WCommonApps.Label.Assignees",[a.LOGICAL_MEMBER]:"E6WCommonApps.Member.MemberType.Member",[a.SCHEDULING_STRATEGY]:"xPlan.Label.SchedulingStrategy",[a.ACTUAL_DATES_STRATEGY]:"xPlan.Label.ActualDatesStrategy",[a.SCHEDULING_FROM_STRATEGY]:"xPlan.Label.SchedulingFromStrategy",[a.NLS_LABEL]:"E6WCommonApps.Label.Title",[`${i}label`]:"E6WCommonApps.Label.Title",[a.COMMENT]:"E6WCommonApps.Label.Description",[`${i}comment`]:"E6WCommonApps.Label.Description",[a.HAS_PROJECT]:"E6WCommonApps.Type.Project",[a.HAS_WORK_DECOMPOSITION]:"E6WCommonApps.Label.SubProject",[a.HAS_BACKLOG_TASK]:"E6WCommonApps.Label.Backlog",[a.HAS_TASK]:"E6WCommonApps.Type.Task",[a.HAS_GATE]:"E6WCommonApps.Type.Gate",[a.HAS_SUB_TASK]:"E6WCommonApps.History.SubTask",[a.HAS_MILESTONE]:"E6WCommonApps.Type.Milestone",[a.HAS_REFERENCE_PROJECT]:"xPlan.Label.ReferenceProjects",[a.PROJECT_TYPE]:"xPlan.Label.ProjectType",[a.HAS_EXPERIMENT]:"E6WCommonApps.History.Scenario",[a.JS_TYPE]:"E6WCommonApps.Type.Project",[a.HAS_MATURITY]:"E6WCommonApps.Label.MaturityState",[a.HAS_PRIORITY]:"E6WCommonApps.Label.Priority",[`${s}actualDate`]:"xPlan.Label.ActualDate",[a.ACTUAL_START_DATE]:"E6WCommonApps.Label.ActualStart",[a.ACTUAL_END_DATE]:"E6WCommonApps.Label.ActualEnd",[a.ESTIMATED_END_DATE]:"E6WCommonApps.Label.PlannedEnd",[a.ESTIMATED_START_DATE]:"E6WCommonApps.Label.PlannedStart",[a.SUGGESTED_DATE]:"xPlan.Label.SuggestedDate",[a.ESTIMATED_DATE]:"xPlan.Label.EstimatedDate",[a.DATE_INTERVAL_MIN]:"E6WCommonApps.History.DateConstraintNoEarlierThan",[a.DATE_INTERVAL_MAX]:"E6WCommonApps.History.DateConstraintNoLaterThan",[a.START_DATE_INTERVAL_MIN]:o?"xPlan.Label.StartDate":"E6WCommonApps.History.StartDateConstraintNoEarlierThan",[a.START_DATE_INTERVAL_MAX]:"E6WCommonApps.History.StartDateConstraintNoLaterThan",[a.END_DATE_INTERVAL_MIN]:"E6WCommonApps.History.EndDateConstraintNoEarlierThan",[a.END_DATE_INTERVAL_MAX]:o?"xPlan.Label.EndDate":"E6WCommonApps.History.EndDateConstraintNoLaterThan",[a.ESTIMATED_DURATION]:"E6WCommonApps.Label.Duration",[a.DURATION_INTERVAL_MIN]:"E6WCommonApps.History.MinDurationInterval",[a.DURATION_INTERVAL_MAX]:"E6WCommonApps.History.MaxDurationInterval",[a.USES_CALENDAR]:"E6WCommonApps.Label.Timezone",[a.SEQUENCE_ORDER]:"E6WCommonApps.History.SequenceOrder",[a.PERCENTAGE_COMPLETION]:"E6WCommonApps.Label.Percent",[a.USER_DEFINED_END]:"E6WCommonApps.History.UserDefinedEnd",[a.USER_DEFINED_START]:"E6WCommonApps.History.UserDefinedStart",[a.REMINDER_DAYS]:"E6WCommonApps.Label.TaskReminder",[a.HAS_CHECKLIST_ITEM]:"E6WCommonApps.Label.ChecklistItem",[a.USER_DEFINED_DATES]:"E6WCommonApps.History.UserDefinedDates",[a.VOCABULARY_TYPE]:"xPlan.Label.Type",[a.LAG]:"xPlan.Label.LeadLag",[a.DEPENDENCY_TO]:"xPlan.Label.DependencyTo",[a.IS_ENFORCED]:"xPlan.Dependencies.Filter.Enforced",[a.DEPENDENCY_FROM]:"xPlan.Label.DependencyFrom",[a.CONSTRAINT_TYPE]:"xPlan.Dependencies.Type",[a.ITERATION_CAPACITY]:"E6WCommonApps.Label.iterationCapacity",[a.HAS_PROCESS_MODEL]:"E6WCommonApps.Label.GoverningProcessModel",[a.HAS_PROCESS_INSTANCE]:"E6WCommonApps.Label.GoverningProcessInstance",[a.GATE_RESOLUTION]:"xPlan.Label.Resolution",[e.ADDED]:"E6WCommonApps.Label.Added",[e.RESTORED]:"E6WCommonApps.Label.Restored",[e.MODIFIED]:"E6WCommonApps.Label.LastUpdated",[e.REMOVED]:"E6WCommonApps.Label.Removed",[e.DELETED]:"E6WCommonApps.Label.Deleted",[e.CREATED]:"E6WCommonApps.Label.Created",[e.TRANSITIONED]:"E6WCommonApps.Label.Transitioned","dsplan:xProject":"E6WCommonApps.Type.Project","dsplan:Project":"E6WCommonApps.Type.Project","dsplan:AgileProject":"E6WCommonApps.Type.Project","dsplan:Task":"E6WCommonApps.Type.Task","dsplan:Milestone":"E6WCommonApps.Type.Milestone","dsplan:Gate":"E6WCommonApps.Type.Gate",[a.BACKLOG_QUERY]:"E6WCommonApps.Label.BacklogQuery"}},USES_CALENDAR:a.USES_CALENDAR,DURATION_FIELDS:l.DURATION_FIELDS,DATE_FIELDS:l.DATE_FIELDS,PROJECT_TYPE_FIELD:a.PROJECT_TYPE,HAS_REFERENCE_PROJECT:a.HAS_REFERENCE_PROJECT,HAS_GATE_FIELD:a.HAS_GATE,HAS_MILESTONE_FIELD:a.HAS_MILESTONE,HAS_TASK_FIELD:a.HAS_TASK,HAS_SUB_TASK_FIELD:a.HAS_SUB_TASK,OBJECT_CREATION_DELETION_FIELDS:l.OBJECT_CREATION_DELETION_FIELDS,HAS_WORK_DECOMPOSITION_FIELD:a.HAS_WORK_DECOMPOSITION,DESCRIPTION_TYPE_FIELD:a.COMMENT,HAS_THUMBNAIL_FIELD:a.HAS_THUMBNAIL,IGNORED_FIELDS:l.IGNORED_FIELDS,SCHEDULING_STRATEGY_FIELD:a.SCHEDULING_STRATEGY,USER_GROUP_FIELDS:l.USER_GROUP_FIELDS,ASSIGNEE_TYPE_FIELDS:l.ASSIGNEE_TYPE_FIELDS,BASELINE_FIELD:a.HAS_BASELINE,OBJECT_TYPE_FIELDS:l.OBJECT_TYPE_FIELDS}})),define("DS/E6WCommonApps/ConstraintsUtil",["DS/E6WCommonUI/Views/DateView","DS/E6WCommonUI/Views/SelectView","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s){"use strict";var i=[{actualValue:"As Soon As Possible",displayValue:s.get("E6WCommonApps.Label.AsSoonAsPossible")},{actualValue:"As Late As Possible",displayValue:s.get("E6WCommonApps.Label.AsLateAsPossible")},{actualValue:"Finish No Earlier Than",displayValue:s.get("E6WCommonApps.Label.FinishNoEarlierThan")},{actualValue:"Finish No Later Than",displayValue:s.get("E6WCommonApps.Label.FinishNoLaterThan")},{actualValue:"Must Finish On",displayValue:s.get("E6WCommonApps.Label.MustFinishOn")},{actualValue:"Must Start On",displayValue:s.get("E6WCommonApps.Label.MustStartOn")},{actualValue:"Start No Earlier Than",displayValue:s.get("E6WCommonApps.Label.StartNoEarlierThan")},{actualValue:"Start No Later Than",displayValue:s.get("E6WCommonApps.Label.StartNoLaterThan")}];return{createConstraintTypeDateView:function(t){return new e({model:t,config:{name:n.CONSTRAINT_DATE,readWrite:!1,label:s.get("E6WCommonApps.Label.ConstraintDate"),type:"date",validate:!0,showWeekNumbers:!0}})},createConstraintTypeView:function(e){return new t({model:e,config:{name:n.CONSTRAINT_TYPE,readWrite:!1,label:s.get("E6WCommonApps.Label.ConstraintType"),type:"select",values:i,validate:!0}})}}})),define("DS/E6WCommonApps/Views/TaskDurationEstimatedRangeStartStop",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonUI/Views/StartStopView"],(function(e,t,n){"use strict";var s=n.extend({setup:function(){this._parent.apply(this,arguments),this.model&&(this.listenTo(this.model,"onChange:"+t.ACTUAL_START_DATE,this.render),this.listenTo(this.model,"onChange:"+t.ACTUAL_END_DATE,this.render))},render:function(){return this._parent.apply(this,arguments),this}});return s})),define("DS/E6WCommonApps/Collections/ScenarioModelCollection",["UWA/Core","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],(function(e,t,n){"use strict";return t.extend({_uwaClassName:"ScenarioModelCollection",comparator:function(e,t){var s=n.CREATION_DATE_ATTR,i=e.get(s),o=t.get(s),a=i?Date.parse(i):0;return(o?Date.parse(o):0)-a}})})),define("DS/E6WCommonApps/MultiEdit/E6WMultiDetailsDisplayView",["DS/E6WCommonUI/MultiEdit/MultiDetailsDisplayView","DS/E6WCommonApps/MultiEdit/E6WMultiEditFieldView"],(function(e,t){return e.extend({_uwaClassName:"E6WMultiDetailsDisplayView",getMultiEditFieldView:function(e){return new t(e)}})})),define("DS/E6WCommonApps/Resource/AssignedTasksCollection",["DS/RDFFoundation/Collections/ResultCollection","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Preferences"],(function(e,t,n){"use strict";var s=e.extend({_uwaClassName:"AssignedTasksCollection",init:function(e,t){const s={...t||{}};this._parent.apply(this,arguments),s.external?this.listenTo(n,`onChange:${n.RESOURCE_INCLUDE_OTHER}`,(()=>this.reset())):this.listenTo(n,`onChange:${n.RESOURCE_INCLUDE_SUBPROJECTS}`,(()=>this.reset())),this.listenTo(n,n.PROJECT_CHANGED,this.reset)},comparator:function(e,t){var n=new Date(e.getStartDate()).getTime(),s=new Date(t.getStartDate()).getTime();return isNaN(n)||isNaN(s)?0:n-s}});return s})),define("DS/E6WCommonApps/Utils/ResourceWorkloadUtil",["UWA/Core","UWA/Class/Events","UWA/Class/Listener","DS/Controls/Button","DS/Windows/ImmersiveFrame","DS/UIKIT/Tooltip","DS/Handlebars/Handlebars4","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/SmartSchedulerUtils","DS/E6WCommonApps/Utils/ModalManager","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/ScheduleConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","text!DS/E6WCommonApps/assets/templates/resourceWorkloadHeader.html.handlebars","text!DS/E6WCommonApps/assets/templates/resourceWorkloadContent.html.handlebars"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m){"use strict";var T=function(e){return u.get(e)},E=a.compile(h),g=a.compile(m),A=require.toUrl(p.DEFAULT_PROFILE_IMG_PATH);const C="previousButton";var _=t.extend(n,{init:function(){this._parent.apply(this,arguments),this._tooltips=[]},onShowResourceClicked:function(t){var n=e.clone(t||{},!1);this._resourceWorkloadDialog?(this._resourceWorkloadDialog&&this._resourceWorkloadDialog.close(),this._destroyDialogAndToggleCheck()):(this._fetchSubProjects(n),this.toggleCheckIcon=n.callback)},_fetchSubProjects:function(t){var n=e.clone(t||{},!1);n.rootProjectModel&&n.rootProjectModel.fetch({mask:"dsplan:MVMask.Project.Backlog",onlyIfNeeded:!0,onComplete:e=>{this._openResourceWorkloadDialog(),this.subProjects=e.get(c.CHILDREN_ATTR)&&e.get(c.CHILDREN_ATTR)._models,this.subProjects&&this.subProjects.length>0?(this.currentIndex=0,this._getResourceWorkloadData(this.subProjects[this.currentIndex])):this._updateResourceWorkloadDialog()},onFailure:()=>{r.displayError(T("E6WCommonApps.Error.FailedToOpenResourceWorkloadDialog")),this._destroyDialogAndToggleCheck()}})},_getResourceWorkloadData:function(){let e=this.subProjects&&this.subProjects[this.currentIndex],t={Unassigned:{name:T("E6WCommonApps.Label.Unassigned"),image:A,noOfIssues:0,storyPoints:0}};e&&new Promise((n=>{e&&e.fetch({mask:"dsplan:MVMask.Project.IterationTasks",onlyIfNeeded:!0,onComplete:e=>{this._addModelListeners(e);let s=e._models&&e.get(c.TASK_RELATION_ATTR)&&e.get(c.TASK_RELATION_ATTR)._models;s&&s.length&&s.forEach((e=>{if(this._addModelListeners(e),e.get(c.WORK_CONTEXT)){let n=e.get(c.STORY_POINTS)?parseFloat(e.get(c.STORY_POINTS)):0,s=e.get(c.ASSIGNEE_ATTR);s&&s.length?(n/=s.length,s.forEach((e=>{this._updateAssigneePointsMap({assigneePointsMap:t,assignee:e,storyPoints:n})}))):this._updateAssigneePointsMap({assigneePointsMap:t,storyPoints:n})}})),n()}})})).then((()=>{this._updateResourceWorkloadDialog({subProject:e,assigneePointsMap:t})}))},_updateAssigneePointsMap:function(t){var n=e.clone(t||{},!1);let s=n.assignee||{},i=s.id||"Unassigned";n.assigneePointsMap[i]?(n.assigneePointsMap[i].storyPoints+=n.storyPoints,n.assigneePointsMap[i].noOfIssues+=1):n.assigneePointsMap[i]={name:s.get("title"),image:s.get("image"),noOfIssues:1,storyPoints:n.storyPoints}},_openResourceWorkloadDialog:function(){var e=new i({useBackgroundFlag:!0});e.inject(document.body),this._resourceWorkloadDialog=d.getSuperModal().dialog({immersiveFrame:e,width:"380",domId:"resourceWorkloadDialog",title:T("E6WCommonApps.Label.ResourceWorkload"),modalFlag:!1,resizableFlag:!0,position:{my:"center",at:"top"}}),this._addDialogListners(),r.trackPageEvent({eventCategory:"open-resource-workload-dialog"})},_updateResourceWorkloadDialog:function(t){var n=e.clone(t||{},!1);if(this._resourceWorkloadDialog){let e={};if(this.subProjects[this.currentIndex]){let t=n.subProject;e.data=n.assigneePointsMap,e.modelTitle=t.get(c.TITLE_ATTR),e.modelIcon=t.getIconURL&&t.getIconURL(),e.colData=[T("E6WCommonApps.Label.Assignee"),T("E6WCommonApps.Label.StoryTasks"),T("E6WCommonApps.Label.TaskPoints")],Object.values(e.data).forEach((e=>{e.storyPoints=Number.isInteger(e.storyPoints)?e.storyPoints:e.storyPoints.toFixed(2)})),this._resourceWorkloadDialog.header=E(e),this._addNavigationButtons()}else e.emptyMessage=T("E6WCommonApps.Label.EmptyResourceWorkload");this._resourceWorkloadDialog.content=g(e)}},_addDialogListners:function(){this._resourceWorkloadDialog&&this._resourceWorkloadDialog.addEventListener("close",(()=>{this._destroyDialogAndToggleCheck(),r.trackPageEvent({eventCategory:"close-resource-workload-dialog"})})),this.listenTo(l.getManagementView().skel,"onRouteChange",(e=>{e&&e.split("/").filter((e=>e)).length<4&&this._resourceWorkloadDialog&&this._resourceWorkloadDialog.close()}))},_addModelListeners:function(e){this.stopListening(e),this.listenToOnce(e,"onSync",(()=>{this.updateTimeout=this.updateTimeout||setTimeout((()=>{this.updateTimeout=void 0,this._resourceWorkloadDialog&&this._getResourceWorkloadData()}),500)}))},_addNavigationButtons:function(){this.previousBtn&&this.previousBtn.destroy(),this.nextBtn&&this.nextBtn.destroy(),this.previousBtn=this._createNavButton(C),this.nextBtn=this._createNavButton("nextButton")},_createNavButton:function(e){let t=e===C,n=new s({domId:e,icon:{iconName:t?"foncticon fonticon-left-open":"foncticon fonticon-right-open",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},disabled:t?0===this.currentIndex:this.currentIndex===this.subProjects.length-1,onClick:()=>{this.currentIndex=t?this.currentIndex-1:this.currentIndex+1,this._getResourceWorkloadData()}});return n.inject(this._resourceWorkloadDialog.getContent().getElement("#"+e)),this._tooltips.push(new o({target:n.getContent(),body:T(t?"E6WCommonApps.Label.Previous":"E6WCommonApps.Label.Next")})),n},_destroyDialogAndToggleCheck:function(){this._resourceWorkloadDialog=void 0,this.toggleCheckIcon(),this.stopListening()}});return _._instance=_._instance||new _,_._instance})),define("DS/E6WCommonApps/DisplayPreferencesUtil",["UWA/Core","DS/UIKIT/DropdownMenu","DS/E6WCommonApps/Utils/ResourceWorkloadUtil","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s){"use strict";const i="onToggleResourceWorkload",o="resourceWorkload",a={createDisplayMenuDropdown:function(e,n){var s={className:"display-menu",target:n.getElement("#displayPreferences"),items:e};return new t(s)},toggleCheckIcon:function(t){var n=e.clone(t||{},!1),s=n.flag?"check":" ";n.displayMenu&&n.displayMenu.updateItem({id:n.id,fonticon:s})},toggleResourceWorkload:function(){a.resourceWorkloadFlag=!a.resourceWorkloadFlag,a.toggleCheckIcon({id:"resourceWorkload",flag:a.resourceWorkloadFlag,displayMenu:this.displayMenu}),n.dispatchEvent(i)},getResourceWorkloadMenu:function(){return this.stopListening(n,i),this.listenTo(n,i,(()=>{a.toggleCheckIcon({id:o,flag:a.resourceWorkloadFlag,displayMenu:this.displayMenu})})),{id:o,text:(e="E6WCommonApps.Label.ResourceWorkload",s.get(e)),handler:()=>{a.toggleResourceWorkload.call(this),n.onShowResourceClicked({rootProjectModel:this.model,callback:a.toggleResourceWorkload.bind(this)})},fonticon:a.resourceWorkloadFlag?"check":" "};var e}};return a})),define("DS/E6WCommonApps/Resource/UnassignedPlaceholderModel",["DS/RDFFoundation/Models/PersonRDFModel","DS/E6WCommonApps/ScheduleConstants","DS/RDFFoundation/RDFUtils","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s){"use strict";const i="unassignedPlaceholderId";var o=require.toUrl(t.DEFAULT_PROFILE_IMG_PATH),a=e.extend({_uwaClassName:"UnassignedPlaceholderModel",setup:function(e){let t=this._parent.apply(this,arguments);return this.parentProject=e.parentProject,this.id=i+"_"+e.parentProject.id,this.uri=i+"_"+e.parentProject.id,this.listenTo(this.parentProject.getCollectionAttribute("dsplan:hasTasksForResource"),"onChange:dsxplan:hasAssignee",(e=>{0===e.getAssignees().length?(this.get("dsplan:hasAssignedTasks").add(e,{sort:!1}),this._sortTimeout=this._sortTimeout||setTimeout((()=>{this.get("dsplan:hasAssignedTasks").sort(),this._sortTimeout=null}))):this.get("dsplan:hasAssignedTasks").remove(e)})),n.addObjectToMap(this.id,this),t},get:function(e){var t,n=this._parent.apply(this,arguments);switch(e){case"name":return t="E6WCommonApps.Resource.Unassigned",s.get(t);case"image":case"miniImage":return o;default:return n}},sync:Function.prototype});return a.ID_PREFIX=i,a})),define("DS/E6WCommonApps/Checklist/ChecklistItemView",["UWA/Core","DS/UIKIT/Tooltip","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/E6WCommonUI/Views/DetailsDisplayView","DS/E6WCommonUI/Models/CloneModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a){"use strict";var r=function(e){return a.get(e)},l=n.extend({_uwaClassName:"CheckListItemView",tagName:"div",className:"form-section accordion details-display-shared-view ddv-field",domEvents:{"click .fonticon-up":"_onUpArrowClicked","click .fonticon-down":"_onDownArrowClicked","click .fonticon-trash":"_onDeleteItem","click .form-section-title":"_onCheckListLabelClicked"},id:function(){return"CheckListItem_"+this.cid},setup:function(e){this._parent.apply(this,arguments),this._expanded=Boolean(e.config&&e.config.expand),this.cloneModel=e.cloneModel||new i(e.model),e.model.cloneModel=this.cloneModel,this.container.setAttribute("data-field-index",1),this._expanded&&this.container.classList.add("expanded"),this._setupGroupElements()},render:function(){this.container.empty();var e=this.model,n=e&&e.get("dsxplan:label");return this._titleElem.inject(this.container),this._fieldContainer.inject(this.container),n||this._titleSpanContainer.classList.add("empty-title"),this._titleSpanContainer.setText(n||r("E6WCommonApps.Label.ChecklistItem")),this.model?.get(o.IS_MANDATORY_ATTR)&&this._requiredFieldIndicator.inject(this._titleContainer),this._titleContainer.inject(this._titleElem),this._accordionToolbar.inject(this._titleElem),this._downArrowElem.inject(this._accordionToolbar),this._upArrowElem.inject(this._accordionToolbar),this._trashElem.inject(this._accordionToolbar),this._tooltips=[],this._tooltips.push(new t({target:this._titleContainer,body:n})),this._expanded&&this._drawChecklistItemFields(),this},_drawChecklistItemFields:function(){this._detailsDisplayView||(this._detailsDisplayView=new s(this.cloneModel),this.addChildView(this._detailsDisplayView),this._detailsDisplayView.setConfig(l.getChecklistDetailsConfig.call(this))),this._detailsDisplayView.inject(this._fieldContainer),this._detailsDisplayView.render(),this.accordionTitleAndRequiredFlagListeners()},accordionTitleAndRequiredFlagListeners:function(){var e=this._detailsDisplayView.getChildViewBasedOnConfig(this._detailsDisplayView._config[1]),t=e&&e.container.getElement("textarea,input");t&&t.addEventListener("blur",(()=>{var e=this.model&&this.model.get("dsxplan:label");this._titleSpanContainer.setText(e)})),this.listenTo(this.cloneModel,"onChange:dsplan:isMandatory",(()=>{this._titleContainer.getChildren().includes(this._requiredFieldIndicator)?this._titleContainer.removeChild(this._requiredFieldIndicator):this._requiredFieldIndicator.inject(this._titleContainer)}))},_setupGroupElements:function(){let t=this.model.collection,n=t.indexOf(this.model);this._isFirst=0===n,this._isLast=n===t.length-1,this._trashElem=e.createElement("span",{class:"fonticon fonticon-trash"}),this._accordionToolbar=e.createElement("div",{class:"accordion-toolbar"}),this._titleContainer=e.createElement("div",{class:"title-container"}),this._titleSpanContainer=e.createElement("span",{class:"title"}),this._titleSpanContainer.inject(this._titleContainer),this._upArrowElem=e.createElement("span",{class:"fonticon fonticon-up"}),this._downArrowElem=e.createElement("span",{class:"fonticon fonticon-down"}),this._titleElem=e.createElement("div",{class:"form-section-title"}),this._fieldContainer=e.createElement("div",{class:"form-section-body"}),this._requiredFieldIndicator=e.createElement("span",{class:"required-field-indicator",html:"*"})},toggleExpanded:function(){this._expanded=!this._expanded,this.dispatchEvent("onToggleExpandCollapse",[this.model,this._expanded]),this.render()},_onCheckListLabelClicked:function(){if(this.toggleExpanded(),this._expanded){var e=this;this._animationFrameForScroll=requestAnimationFrame((function(){e._parentView._parentView.dispatchScrollToElementEvent(e.container),delete e._animationFrameForScroll}))}},_onDeleteItem:function(e){e.stopPropagation(),this.dispatchEvent("onDeleteChecklistItem",this.model)},insertChecklistBefore:function(e,t){var n=this.getSequenceOrderForObject({parentModel:e,collection:e.get(o.HAS_CHECKLIST_ATTR),currentModel:t,placement:"before"});this._insertChecklistWithSequenceOrder(e,t,n)},insertChecklistAfter:function(e,t){var n=this.getSequenceOrderForObject({parentModel:e,collection:e.get(o.HAS_CHECKLIST_ATTR),currentModel:t,placement:"after"});this._insertChecklistWithSequenceOrder(e,t,n)},_insertChecklistWithSequenceOrder:function(t,n,s){if(t.get(o.HAS_CHECKLIST_ATTR).contains(n)&&e.is(s,"array")){n.set(o.SEQUENCE_ORDER_ATTR_DSLC,s[0]);let e=t.get(o.HAS_CHECKLIST_ATTR);e&&e.at(s[2]).set(o.SEQUENCE_ORDER_ATTR_DSLC,s[1]),e&&e.sort()}},getSequenceOrderForObject:function(e){var t=e.placement||"after",n=e.collection.indexOf(e.currentModel),s=e.currentModel.get(o.SEQUENCE_ORDER_ATTR_DSLC);if(0===n&&"after"!==t)return s-1-Math.random();if(n===e.collection.length-1&&"after"===t)return s+1+Math.random();var i="after"===t?n+1:n-1;return[e.collection.at(i).get(o.SEQUENCE_ORDER_ATTR_DSLC),s,i]},_onUpArrowClicked:function(e){if(e.stopPropagation(),!this._isFirst){var t=this.model.getParent();this.insertChecklistBefore(t,this.model)}},_onDownArrowClicked:function(e){if(e.stopPropagation(),!this._isLast){var t=this.model.getParent();this.insertChecklistAfter(t,this.model)}},destroy:function(){void 0!==this._animationFrameForScroll&&(cancelAnimationFrame(this._animationFrameForScroll),delete this._animationFrameForScroll),this._tooltips&&this._tooltips.forEach((function(e){e.destroy()})),this._parent.apply(this,arguments)}});return l.getChecklistDetailsConfig=function(){return[{readWrite:!(this._parentView?.model?.model?.hasSubtasks&&this._parentView.model.model.hasSubtasks()),useBoolean:!0,name:o.IS_MANDATORY_ATTR,label:r("E6WCommonApps.Label.Required"),type:"checkbox"},{readWrite:!0,name:"dsxplan:label",label:r("E6WCommonApps.Label.Item"),type:"text",maxLength:128,required:!0,hideRequiredLegend:!0,removeCarriageReturns:!0,validate:!0},{readWrite:!0,name:"dsxplan:comment",label:r("E6WCommonApps.Label.Description"),type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:6}]},l})),define("DS/E6WCommonApps/Collections/MemberResponsibilityCollection",["UWA/Core","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonApps/Models/TeamMemberResponsibilityModel"],(function(e,t,n){"use strict";return t.extend({_uwaClassName:"MemberResponsibilityCollection",model:n,mask:"dsplan:MVMask.Person.Complex",setup:function(t,n){var s=e.clone(n||{},!1);this._workscope=s.workscope,this._parent(t,s)},parse:function(e){return n.processRawData(e,this._workscope)}})})),define("DS/E6WCommonApps/FileUploadRepositoryUtil",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/DocumentManagement/DriveDocumentManagement","DS/RDFFoundation/SecurityContextUtils","DS/E6WCommonUI/UIHelper","DS/RDFFoundation/Models/CollabspaceRepositoryModel","DS/RDFFoundation/Models/DriveRepositoryProxyModel","DS/E6WCommonUI/Views/ObjectCardView","DS/RDFFoundation/FederatedSearchUtil","DS/E6WCommonApps/Views/LinkLauncherUtils","DS/E6WCommonApps/Views/E6WObjectCardView","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u){"use strict";var h=u.get.bind(u),m={fileUploadRepositoryTypeAheadCallback:function(n,s,i,o){var r=[],l=e.clone(o||{},!1);l.attribute=n.name,s.length>1&&n.searchSource&&n.searchSource.length>0?(r=m.getFiltered3DSpaceFileUploadRepository(s,l),t.typeAheadCallback(n,s,(function(e,n){if(e&&e.length>0)for(var s=0;s<e.length;s++){var o=a.ID_PREFIX+e[s].value;e[s].value=o,t.getObjectForAdding(a,o),r.push(e[s])}i(r,n)}),o)):i(m.getFiltered3DSpaceFileUploadRepository(s,l))},getFiltered3DSpaceFileUploadRepository:function(e,n){for(var i=new RegExp(e,"i"),a=[],r=s.getContentRepositoryValuesForDetailDisplay(n.model.model,n)(),l=0;l<r.length;l++){var d=r[l].actualValue,c=t.getObjectForAdding(o,d,{attrs:r[l]});c.get("title").match(i)&&a.push({id:c.id,label:c.get("title"),image:c.get("image"),model:c})}return a},repositoryDropHandler:function(e,n,s){if(s.objectView.validateDroppedObjects(e))return!1;var o=i.getDataTransferJSON(e);if(o&&o.data.items){var r=o.data.items[0];if("3DDrive"===r.serviceId){var l=a.ID_PREFIX+r.objectId;return o.data.items[0].objectId=l,t.getObjectForAdding(a,l),s.objectView.processDropData(o),!0}}return!1},getRepositoryFieldConfig:function(e){return{readWrite:!e,name:p.CONTENT_REPOSITORY,label:h("E6WCommonApps.Label.CollaborativeSpace"),attributeToDisplay:"title",imageAttribute:"image",searchTitle:h("E6WCommonApps.Label.SearchForUploadRepository"),type:"object",customView:c,minLengthBeforeAutocomplete:0,singleObjectOnly:!0,typeAheadCallback:m.fileUploadRepositoryTypeAheadCallback,dropHandler:m.repositoryDropHandler,placeHolder:h("E6WCommonApps.Label.ObjectPlaceHolder"),validateSameTenant:!0,linkCallback:d.launchProperties,searchSource:l.filterSearchSources(["drive"]),excludeSearchTypes:{drive:["DriveFile"]},noOpenWith:!0,customTooltips:[{iconClass:"info",tooltipTitle:h("E6WCommonApps.Label.CollaborativeSpace"),tooltipBody:h("E6WCommonApps.Label.Tooltip.CollaborativeSpace")}]}},getCollaborativeSpaceForRiskConfig:function(e){return{readWrite:e.canShare(),name:p.RISK_REPOSITORY,label:h("E6WCommonApps.Label.CollaborativeSpaceForRisk"),attributeToDisplay:"title",imageAttribute:"image",type:"object",isThumbnail:!0,disableRemove:!0,customView:c,minLengthBeforeAutocomplete:0,singleObjectOnly:!0,typeAheadCallback:m.fileUploadRepositoryTypeAheadCallback,placeHolder:h("E6WCommonApps.Label.TypeAheadOnlyPlaceHolder"),validateSameTenant:!0,linkCallback:d.launchProperties,noOpenWith:!0,noAction:!0}},getBookmarkForRepositoryFieldConfig:function(e){return{readWrite:!e,name:p.BOOKMARK_FOR_FILE_REPOSITORY,attributeToDisplay:"title",imageAttribute:"image",singleObjectOnly:!0,label:h("E6WCommonApps.Label.BookmarkForRepository"),searchTitle:h("E6WCommonApps.Label.SearchForBookmark"),type:"object",customView:c,typeAheadCallback:t.typeAheadCallback,minLengthBeforeAutocomplete:2,linkCallback:d.launchProperties,placeHolder:h("E6WCommonApps.Label.ObjectPlaceHolder"),searchSourceTypes:{"3dspace":["Workspace","Workspace Vault"]},searchSource:["3dspace"],customTooltips:[{iconClass:"info",tooltipTitle:h("E6WCommonApps.Label.BookmarkForRepository"),tooltipBody:h("E6WCommonApps.Label.Tooltip.BookmarkForRepository")}]}}};return m})),define("DS/E6WCommonApps/Views/FixedStartStopView",["UWA/Core","DS/E6WCommonApps/Views/E6WStartStopView"],(function(e,t){"use strict";var n=t.extend({setup:function(){this._parent.apply(this,arguments),this.model&&(this.listenTo(this.model,"onValidationSuccess",(function(){for(var e=this.container.getElements(".has-error"),t=0;t<e.length;t++)e[t].toggleClassName("has-error",!1)})),this.listenTo(this.model,"onChange:"+this._config.name,this.render),this.listenTo(this.model,"onChange:"+this._config.endDateAttribute,this.render),this.listenTo(this.model,"onChange:"+this._config.isStartDateManualAttribute,this.render),this.listenTo(this.model,"onChange:"+this._config.isEndDateManualAttribute,this.render),this.listenTo(this.model,"onChange:"+this._config.startMinConstraint,this.render),this.listenTo(this.model,"onChange:"+this._config.startMaxConstraint,this.render),this.listenTo(this.model,"onChange:"+this._config.endMinConstraint,this.render),this.listenTo(this.model,"onChange:"+this._config.endMaxConstraint,this.render))},dateDataEntry:function(e){const t=e.target.closest(".input-group").hasClassName("start"),n=e.target.closest(".input-group").hasClassName("stop");this._parent(e),t&&this._config.canEditStartConstraint?this.setFixed(this.model.get(this._config.name),!0):n&&this._config.canEditEndConstraint&&this.setFixed(this.model.get(this._config.endDateAttribute),!1)},setFixed:function(t,n){var s=e.clone(this._config,!1),i=n?s.isStartDateManualAttribute:s.isEndDateManualAttribute;this.normalizedSet(this.model,{name:i,validate:!0},void 0!==t.actualValue?Boolean(t.actualValue):Boolean(t)),this.generateTitle()},generateBadgeAndInsert:function(e,t){this.getElement("."+e+" label span .fonticon")||this.getElement("."+e+" label span")&&(this.getElement("."+e+" label span").innerHTML+='  <span class="fonticon fonticon-'+t+'"></span>')},generateTitle:function(){var e=this,t=Boolean(this.model.isStartDateFixed()),n=Boolean(this.model.isEndDateFixed());let s=this._config,i=function(t){return e.getElement("."+t+" label span .fonticon")};t&&s.isStartDateManualAttribute?this.generateBadgeAndInsert("start","pin"):s.startMinConstraint&&this.model.get(s.startMinConstraint)?this.generateBadgeAndInsert("start","move-to-start"):s.startMaxConstraint&&this.model.get(s.startMaxConstraint)?this.generateBadgeAndInsert("start","move-to-end"):i("start")&&i("start").remove(),n&&s.isEndDateManualAttribute?this.generateBadgeAndInsert("stop","pin"):s.endMinConstraint&&this.model.get(s.endMinConstraint)?this.generateBadgeAndInsert("stop","move-to-start"):s.endMaxConstraint&&this.model.get(s.endMaxConstraint)?this.generateBadgeAndInsert("stop","move-to-end"):i("stop")&&i("stop").remove()},render:function(){this._parent.apply(this,arguments),this.generateTitle();let e=this._config.readWrite;return e||(e=!1),this._config.doNotShowStop&&this.container.getElement(".stop")&&this.container.getElement(".stop").destroy(),this.moveLabelPosition("top"),this}});return n})),define("DS/E6WCommonApps/Models/ModificationModel",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/PersonRDFModel","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l){"use strict";var d=l.get.bind(l),c="dsplan:modifies",p="dsplan:performedBy",u="dsplan:modificationType",h="dsplan:forProject",m="dsplan:relatedObject",T="created",E="commentAdded",g="completed",A="contentAdded",C="contentRemoved",_="memberAdded",f="memberRemoved",D="elementRemoved",S="projectCreated",R="projectChanged",y="reopened",v="taskDuplicated",M="taskSplit",I={};I[T]=d("E6WCommonApps.Modification.ElementAdded"),I[E]=d("E6WCommonApps.Modification.CommentAdded"),I[A]=d("E6WCommonApps.Modification.ContentAdded"),I[C]=d("E6WCommonApps.Modification.ContentRemoved"),I[_]=d("E6WCommonApps.Modification.MemberAdded"),I[f]=d("E6WCommonApps.Modification.MemberRemoved"),I[D]=d("E6WCommonApps.Modification.ElementRemoved"),I[S]=d("E6WCommonApps.Modification.ProjectAdded"),I[R]=d("E6WCommonApps.Modification.ProjectChanged"),I[g]=d("E6WCommonApps.Modification.ElementCompleted"),I[y]=d("E6WCommonApps.Modification.ElementReopened"),I[v]=d("E6WCommonApps.Modification.TaskDuplicated"),I[M]=d("E6WCommonApps.Modification.TaskSplit");var b=new t({title:""});b.getObjectType=function(){return"Object"};var O=[A,C,_,f],N=s.extend({_uwaClassName:"ModificationModel",_relations:[{key:"modifications",relatedCollection:n}],buildText:function(){var e=this.get(u),t=I[e];return l.replace(t,this._getNlsValuesToReplace())},_getNlsValuesToReplace:function(){var e=this.getModifiedObject(),t=this.getRelatedObject(),n=function(e){return"<strong>"+(e?a.escapeHTML(e):e)+"</strong>"},s={USER:n(this.getModifier().fullName)};switch(this.get(u)){case T:case g:case E:case y:case v:case M:s.TYPE=d("E6WCommonApps.Type."+e.getObjectType()),s.TITLE=n(e.get("title"));break;case A:case C:s.TYPE=d("E6WCommonApps.Type."+e.getObjectType()),s.TITLE=n(e.get("title")),s.CONTENT=n(t.get("title"));break;case _:case f:s.MEMBER=n(t.fullName);break;case S:s.TITLE=n(e.get("title"));break;case R:s.TITLE=n(e.get("title")),s.NEW_PROJECT_TYPE=d(e.getProjectTypeNLS()),s.ORIGINAL_PROJECT_TYPE=d("E6WCommonApps.Type.TeamProject")}return s},get:function(e){switch(e){case"image":return this.getImage();case"text":return this.buildText();case"timeStamp":return this.getDate().strftime("%H:%M");default:return this._parent.apply(this,arguments)}},getProject:function(){return this.get(h)},getModifiedObject:function(){var e=this.get(c);return e&&e.getObjectType()?e:b},getModifier:function(){return this.get(p)},getDate:function(){return new Date(this.get("dspol:creationDate"))},getRelatedObject:function(){return this.get(m)},getImage:function(){var e=this.getModifier()&&this.getModifier().get("image");if(-1!==O.indexOf(this.get(u))){var t=this.getRelatedObject();e=t&&t.get("image")}return e},hasViewAccess:()=>!0});return N.TYPE=u,N.MODIFIES=c,N.MODIFICATIONS="modifications",N.FOR_PROJECT=h,N.PERFORMED_BY=p,N.RELATED_OBJECT=m,N.TYPE_CREATED=T,N.TYPE_COMMENT=E,N.TYPE_CONTENT_ADDED=A,N.TYPE_CONTENT_REMOVED=C,N.TYPE_MEMBER_ADDED=_,N.TYPE_MEMBER_REMOVED=f,N.TYPE_COMPLETED=g,N.TYPE_ELEMENT_REMOVED=D,N.TYPE_PROJECT_CREATED=S,N.TYPE_PROJECT_CHANGED=R,N.TYPE_HIDDEN="hidden",N.TYPE_REOPENED=y,N.TYPE_TASK_DUPLICATED=v,N.TYPE_TASK_SPLIT=M,N})),define("DS/E6WCommonApps/Models/GroupedModificationModel",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/RequestUtils","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonApps/Models/ModificationModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a){"use strict";var r=i.MODIFICATIONS,l=i.TYPE,d="dsplan:groupedModificationsCount",c="dsplan:Modification.Basic",p={};p[i.TYPE_CREATED]="E6WCommonApps.Modification.ElementsAdded",p[i.TYPE_COMMENT]="E6WCommonApps.Modification.CommentsAdded",p[i.TYPE_CONTENT_ADDED]="E6WCommonApps.Modification.ContentsAdded",p[i.TYPE_CONTENT_REMOVED]="E6WCommonApps.Modification.ContentsRemoved",p[i.TYPE_MEMBER_ADDED]="E6WCommonApps.Modification.MembersAdded",p[i.TYPE_COMPLETED]="E6WCommonApps.Modification.ElementsCompletedOrReopened",p[i.TYPE_REOPENED]="E6WCommonApps.Modification.ElementsCompletedOrReopened",p[i.TYPE_MEMBER_REMOVED]="E6WCommonApps.Modification.MembersRemoved",p[i.TYPE_ELEMENT_REMOVED]="E6WCommonApps.Modification.ElementsRemoved",p[i.TYPE_PROJECT_CREATED]="E6WCommonApps.Modification.ProjectsAdded",p[i.TYPE_PROJECT_CHANGED]="E6WCommonApps.Modification.ProjectsChanged",p[i.TYPE_TASK_DUPLICATED]="E6WCommonApps.Modification.TaskDuplicatedOrSplit",p[i.TYPE_TASK_SPLIT]="E6WCommonApps.Modification.TaskDuplicatedOrSplit";var u=s.extend({_uwaClassName:"GroupedModificationCollection",init:function(t,n){var s=e.clone(n||{},!1);s.defaultModel=i,this._parent(t,s),this._groupId=n.groupId},fetch:function(t){var n=e.clone(t||{},!1);return n.data=JSON.stringify([this._groupId]),n.method="POST",this._parent(n)},update:function(){var e=this.remove;this.remove=Function.prototype,this._parent.apply(this,arguments),this.remove=e},url:function(){var e=t.expandUrl("/invoke/dsxplan:expandModification","v1");return n.addQueryParams(e,[{name:"$mask",value:c}])}}),h=i.extend({_uwaClassName:"GroupedModificationModel",_relations:[{key:r,relatedCollection:u}],setup:function(){this._parent.apply(this,arguments),this._createCollection(r,void 0,{groupId:this.get("dsplan:groupId")}),this.listenTo(this.getProject(),"onDestroy",(function(){this.destroy({noServer:!0})}))},buildGroupedText:function(){var e=p[this.get(l)]||this.get(l),t=".UnknownAmount",n="";return this.get(d)&&(t=1===(n=this.get(d).getTotalRecords())?".Singular":".Plural"),0!==this.get(r).length&&(t=1===(n=this.get(r).length)?".Singular":".Plural"),e+=t,a.replace(a.get(e),{COUNT:n})+" "},buildText:function(){var e="";return this.hasDataForMask(c)&&(e=this._parent()),e},get:function(e){switch(e){case"projectImage":return this.getProject().get(o.IMAGE_TILE_ATTR);case"groupedText":return this.buildGroupedText();case"project":return this.getProject().get("title");case"modified":return new Date(this.get("dspol:modificationDate")).strftime("%H:%M");default:return this._parent.apply(this,arguments)}},fetchRelatedModificationsIfNeeded:function(){var e=this.get(r);0===e.length&&e.fetch()}});return h.MODIFICATIONS=r,h.MODIFICATION_COUNT_COLLECTION=d,h})),define("DS/E6WCommonApps/Views/DetailedToggleView",["UWA/Core","DS/Handlebars/Handlebars4","DS/Controls/Toggle","DS/Controls/ButtonGroup","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/E6WCommonApps/Models/E6WCommonAppsConstants","text!DS/E6WCommonApps/assets/templates/detailedToggle.html.handlebars"],(function(e,t,n,s,i,o,a){"use strict";var r=t.compile(a);return i.extend({_uwaClassName:"DetailedToggleView",tagName:"div",render:function(e){const t=this;t._checklistAccess=e&&e.checklistAccess?e.checklistAccess:this._checklistAccess,this.container.empty(!0);let i={title:t.model.get(t._config.titleAttribute),description:t.model.get(t._config.descriptionAttribute),required:t.model.get(o.IS_MANDATORY_ATTR)};var a=this.normalizedGet(this.model,this._config.name);if(this.canReadWrite()&&this.normalizedGet(this.model,"canEdit")&&this._checklistAccess){if(this.container.setHTML(r(i)),this._buttonGroup=new s({type:this._config.toggleType}),this._config&&this._config.values&&this._config.values.length)for(var l=0;l<this._config.values.length;l++){let e=this._config.values[l];this._buttonGroup.addChild(new n({type:this._config.toggleType,value:e.actualValue,label:e.displayValue,checkFlag:a&&a===e.actualValue}))}var d=this.container.getElement(".eno-toggle-grid");this._buttonGroup&&this._buttonGroup.addEventListener("change",(function(){var e=t._config,n=t._buttonGroup.value,s=e.values.detect((function(e){return e.actualValue===n[0]}));t.model.model.set(e.name,s.actualValue)})),this._buttonGroup.inject(d)}else a&&(i.readonlyvalue=a,this.container.setHTML(r(i)));return this}})})),define("DS/E6WCommonApps/Views/UserTagsView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/E6WCommonUI/Views/TextAreaView","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i){"use strict";var o=t.extend({_uwaClassName:"UserTagsView",tagName:"div",className:"form-section accordion details-display-shared-view ddv-field form-group",domEvents:{"click .form-section-title":"_onUserTagsLabelClicked"},id:function(){return"UserTags_"+this.cid},setup:function(){this._parent.apply(this,arguments),this._userTagsi18n=i.get("E6WCommonApps.Label.UserTags"),this._labelElem=e.createElement("label",{class:"top-label"}),this.container.setAttribute("data-field-index",1),this._setupGroupElements()},render:function(){return this.container.empty(!0),this._titleElem.inject(this.container),this._fieldContainer.inject(this.container),this._expanded&&this._drawTags(),this},toggleExpanded:function(e){this._expanded=void 0!==e?e:!this._expanded,this.render()},_drawTags:function(){this._userTagsView||this._setupUserTagsViews(),this._fieldContainer.empty(!0),this._userTagsView.render().inject(this._fieldContainer)},_onUserTagsLabelClicked:function(){if(this.toggleExpanded(),this._expanded){var e=this;this._animationFrameForScroll=requestAnimationFrame((function(){e._parentView.dispatchScrollToElementEvent(e.container),delete e._animationFrameForScroll}))}},_setupGroupElements:function(){this._titleElem=e.createElement("div",{class:"form-section-title",html:this._userTagsi18n}),this._fieldContainer=e.createElement("div",{class:"form-section-body"})},_setupUserTagsViews:function(){var t,s,a=this;this._userTagsView=new n((s=e.merge(o.getUserTagsFieldBasicConfig(a.model),t),{i18n:i,isPropertyPanel:!0,model:a.model,config:s})),this.addChildView(this._userTagsView),this.listenTo(this._parentView,"onScroll",(()=>{this.dispatchEvent("onScroll")}))},destroy:function(){void 0!==this._animationFrameForScroll&&(cancelAnimationFrame(this._animationFrameForScroll),delete this._animationFrameForScroll),this._parent.apply(this,arguments)}});return o.getUserTagsFieldBasicConfig=function(){return{type:"textarea",readWrite:!1,name:s.TAGS_DATA}},o})),define("DS/E6WCommonApps/Views/CommonPropertiesConfig",["DS/RDFFoundation/RDFUtils","DS/RDFFoundation/FederatedSearchUtil","DS/E6WCommonUI/Models/DropValidator","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/MultiEdit/MultiObjectCardView","DS/E6WCommonApps/Views/E6WObjectCardView","DS/E6WCommonApps/Views/UserTagsView","DS/E6WCommonApps/GoverningProcess/GoverningProcessAccordionView","DS/E6WCommonApps/Views/LinkLauncherUtils","DS/E6WCommonApps/SmartSchedulerUtils","DS/E6WCommonApps/Models/AssigneeTypeAhead","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Views/RichTextEditorView","DS/E6WCommonApps/Views/E6WDateView","DS/RDFFoundation/BusinessProcessUtils","DS/RDFFoundation/Models/NoAccessModel","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,E,g){"use strict";const A=g.get.bind(g),C={deliverablesSources:()=>{let e=t.filterSearchSources(["swym","3dspace","drive","geovia","3dportfolio","bioexperiment","materials"]);return e.push("3DAnalytics"),e},attachmentSources:()=>{let e=t.filterSearchSources(["swym","3dspace","drive","geovia","3dportfolio","3dplan","bioexperiment","materials"]);return e.push("3DAnalytics"),e},deliverableDropValidator:function(e,t){let n=e.serviceId,s=e.objectType;if("dsplan:url"!==s&&("3dplan"===n||"swym:WeDo"===s))return E.replace(E.get("E6WCommonUI.Alert.FailedToAttachProjectPlanningObjects"))},getWorkContextField:function(){return{readWrite:!0,name:p.WORK_CONTEXT_ATTR,attributeToDisplay:"title",imageAttribute:"image",label:A("E6WCommonApps.Label.ContributesTo"),searchTitle:A("E6WCommonApps.Label.SearchForContext"),type:"object",showRevisionDetails:!0,customView:o,typeAheadCallback:e.typeAheadCallback,minLengthBeforeAutocomplete:2,allowFileManagement:!0,linkCallback:l.launchProperties,placeHolder:A("E6WCommonApps.Label.ObjectPlaceHolder"),searchSource:t.filterSearchSources(["swym","3dspace","drive","geovia","3dportfolio","3dplan"]),excludeSearchTypes:{"3dspace":["Person","Security Context"],swym:["pno:Person","swym:WeDo"]},validateSameTenant:!0,getDropDownMenuItems:d.getDocumentTypeDropDownMenuItems}},assigneeFieldConfig:function(e,a){return{readWrite:!a,name:p.ASSIGNEE_ATTR,attributeToDisplay:"nameAndAccount",imageAttribute:"image",label:A("E6WCommonApps.Label.Assignees"),searchSourceTypes:{swym:["pno:Person"]},dropTypes:n.RDF_ASSIGNEE_DROP_TYPES,mask:"dsplan:MVMask.Person.Complex",typeAheadCallback:c.callback,type:"person",customView:o,multiCustomView:i,agoraMode:!0,with_synthesis_attribute:!1,searchSource:t.filterSearchSources(["swym"]),dropHandler:n.hasInvalidDroppedObject,linkCallback:l.launchProperties,minLengthBeforeAutocomplete:0,placeHolder:A("E6WCommonApps.Label.ObjectPlaceHolder"),validateSameTenant:!0,addMembers:!0,searchTitle:A("E6WCommonApps.Label.assigneeSearchTitle"),customButtons:[s.assignToSelfButtonConfig()],noResultsMessageCallback:c.noResultsMessageCallback}},getOwnerFieldConfig:function(){return{name:p.OWNER_ATTR,attributeToDisplay:"nameAndAccount",imageAttribute:"image",label:A("E6WCommonApps.Label.Owner"),searchSourceTypes:{swym:["pno:Person"]},customView:o,multiCustomView:i,type:"person",searchSource:t.filterSearchSources(["swym"]),linkCallback:l.launchProperties,validateSameTenant:!0,typeAheadCallback:e.typeAheadCallback,singleObjectOnly:!0,disableRemove:!0,excludePendingUser:!0}},getTagsFieldConfig:function(){return{name:p.USER_TAGS,customView:a}},getGoverningProcessObjectsFieldConfig:function(){return{name:p.GOVERNING_PROCESS,customView:r}},getMaturityStateFieldConfig:function(e,t){var n=function(){return!(!e||!e.get(p.GOVERNING_PROCESS_INSTANCE_ATTR))},i=function(){return s.wrapError((()=>{const t=e.getParent(),n=e.get(p.OWNER_ATTR)&&e.get(p.OWNER_ATTR).get("dsaccess:accountName"),i=n&&s.isLoggedInUser(n),o="dsxplan:Done"===e.get(p.STATE_ATTR),a=e.canModify&&e.canModify(!0)||e.model&&e.model.canModify&&e.model.canModify(!0);return!(i||!o||!a||!(t instanceof T||t&&!t.canModify(!0)))}))};switch(e.get("dsxplan:jsType")){case"dsplan:Project":o=e.get("dsplan:isTemplate")?A("E6WCommonApps.Label.Tooltip.ProjectTemplateMaturityState"):A("E6WCommonApps.Label.Tooltip.ProjectMaturityState");break;case"dsplan:Task":o=A("E6WCommonApps.Label.Tooltip.TaskMaturityState");break;case"dsplan:Milestone":o=A("E6WCommonApps.Label.Tooltip.MilestoneMaturityState");break;case"dsplan:Gate":o=A("E6WCommonApps.Label.Tooltip.GateMaturityState");break;default:o=""}var o,a=n()||i(),r=[{iconClass:"info",tooltipTitle:A("E6WCommonApps.Label.MaturityState"),tooltipBody:o}];if(a){var l=n()&&A("E6WCommonApps.Label.MaturityStateToolTipBody"),d=i()&&A("E6WCommonApps.Label.MaturityStateToolTipBodyforRestictedObjects");l&&d?o=l.concat("\n\n",d):l?o=l:d&&(o=d),r[0].tooltipBody=r[0].tooltipBody.concat("\n\n",o)}return{readWrite:void 0===t||!t,name:p.STATE_ATTR,label:A("E6WCommonApps.Label.MaturityState"),type:"select",validate:!0,disable:a,customTooltips:r}},getTitleFieldConfig:function(){return{name:p.TITLE_ATTR,label:A("E6WCommonApps.Label.Title"),type:"text",maxLength:128,required:!0,removeCarriageReturns:!0,validate:!0,readWrite:!0}},getDescriptionFieldConfig:function(){return{readWrite:!0,name:p.DESCRIPTION_ATTR,titleAttribute:p.TITLE_ATTR,label:A("E6WCommonApps.Label.Description"),type:"RichText",richTextField:"dsplan:RichTextField",customView:u,numberOfDisplayLines:3,numberOfEditableLines:3}},getCommonAttachmentFieldConfig:function(){return{readWrite:!0,name:p.ATTACHMENT_ATTR,showRevisionDetails:!0,attributeToDisplay:"title",imageAttribute:"image",label:A("E6WCommonApps.Label.Attachments"),searchTitle:A("E6WCommonApps.Label.SearchForAttachments"),type:"object",customView:o,typeAheadCallback:e.typeAheadCallback,linkCallback:l.launchProperties,allowFileManagement:!0,allowUrlLink:!0,dropTypes:{"3dplan":["dsplan:url"]},placeHolder:A("E6WCommonApps.Label.ObjectPlaceHolder"),searchSource:C.attachmentSources(),excludeSearchTypes:{"3dspace":["Person","Security Context","Business Role"],swym:["pno:Person"]},validateSameTenant:!0,getDropDownMenuItems:d.getDocumentTypeDropDownMenuItems}},getCreationConfig:function(){return{name:p.CREATION_DATE_ATTR,label:A("E6WCommonApps.Label.Created"),type:"date"}},getModifiedConfig:function(){return{name:p.LASTUPDATED_ATTR,label:A("E6WCommonApps.Label.LastUpdated"),type:"date"}}};return C})),define("DS/E6WCommonApps/SimpleDialogFactory",["UWA/Class/Model","DS/E6WCommonUI/Models/CloneModel","DS/E6WCommonUI/Views/DetailsDisplayView","DS/E6WCommonApps/Views/CommonPropertiesConfig","DS/E6WCommonApps/Utils/ModalManager","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],(function(e,t,n,s,i,o,a){"use strict";const r=function(e){var t=e;return t===e&&(t=a.get(e)),t};return{build:function(a){const{project:l,dialogTitle:d,dialogModel:c,onCreate:p,primaryLabel:u,noDescription:h}=a,m=new t(new e({canEdit:!0,projectTitle:l.get("title"),[o.TITLE_ATTR]:c?c.get(o.TITLE_ATTR):""}));m.validate=e=>!(e.title&&e.title.trim());const T=new n({model:m});let E=[{readWrite:!1,label:r("E6WCommonUI.Label.Project"),type:"text",name:"projectTitle"},s.getTitleFieldConfig()];h||E.push({...s.getDescriptionFieldConfig(),customView:void 0,type:"textarea"}),T.setConfig(E);const g=()=>{T.destroy(),A.close()},A=i.getSuperModal().dialog({resizableFlag:!0,title:d,content:T.render(),customButtonsDefinition:[{label:u||r("E6WCommonUI.Label.Create"),emphasize:"primary",onClick:()=>{p(T.model),g()},role:"validate",disabled:!0},{label:r("E6WCommonUI.Label.Cancel"),onClick:g,role:"escape"}]}),C=()=>{A._customButtons[0].disabled=!(m.get("title")&&m.get("title").trim())};return T.listenTo(m,"onValidationSuccess",C),T.listenTo(m,"onValidationFailure",C),A}}})),define("DS/E6WCommonApps/Utils/ScenariosUtils",["UWA/Core","DS/E6WCommonApps/SimpleDialogFactory","DS/E6WCommonApps/Utils/ModalManager","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/SmartSchedulerUtils","DS/E6WCommonApps/SubscribeUtil","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/UIHelper","DS/Handlebars/Handlebars4","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u){"use strict";const h=new Map([[s.STATE_ATTR,void 0],[s.CREATION_DATE_ATTR,void 0],[s.LASTUPDATED_ATTR,void 0],[s.ATTACHMENT_ATTR,void 0],[s.ACTUAL_DELIVERABLE_ATTR,void 0],[s.CONTENT_REPOSITORY,void 0],[s.BOOKMARK_FOR_FILE_REPOSITORY,void 0],[s.OWNER_ATTR,void 0]]),m=new Map([["dsxplan:isEnforced",void 0]]),T={"dsplan:Project":new Map([[s.WORK_CONTEXT_ATTR,void 0],[s.WORKSCOPE_PARENT_ATTR,void 0],["dsplan:schedulingStrategy",void 0],["dsxplan:hasBaseline",void 0],[s.ACTUAL_DATES_STRATEGY_ATTR,void 0],[s.SCHEDULING_FROM_STRATEGY_ATTR,void 0],[s.RISK_REPOSITORY,void 0],["dsxplan:usesCalendar",void 0],[s.RESTRICT_ASSIGNEE_ATTR,void 0],[s.OWNER_RESPONSIBILITY_ATTR,void 0],[s.ASSIGNEE_RESPONSIBILITIES_ATTR,void 0],["team_members",void 0],[s.CALENDAR_ATTR,void 0]]),"dsplan:Task":new Map([[s.COMPLETE_PERCENT_ATTR,void 0],[s.COMMON_TASK_PARENT_ATTR,void 0],[s.ACTUAL_START_DATE,void 0],[s.ACTUAL_END_DATE,void 0],[s.CANDIDATE_ASSIGNEE_ATTR,void 0]]),"dsplan:Milestone":new Map([["dsplan:actualDate",void 0],[s.ESTIMATED_DATE_ATTR,void 0],[s.MILESTONE_PARENT_ATTR,void 0],["dsxplan:vocabularyType",void 0]]),"dsplan:Gate":new Map([["dsplan:actualDate",void 0],[s.ESTIMATED_DATE_ATTR,void 0],[s.GATE_PARENT_ATTR,void 0],[s.RESOLUTION_ATTR,void 0]]),"swym:WeDo":new Map([[s.COMPLETE_PERCENT_ATTR,void 0],[s.ACTUAL_START_DATE,void 0],[s.ACTUAL_END_DATE,void 0],[s.COMMON_TASK_PARENT_ATTR,void 0]]),"dsplan:TemporalConstraint":m,"dsplan:ControlledTemporalConstraint":m};var E=function(e){var t=p.get(e);return t===e&&(t=u.get(e)),t};function g(e){t.build({project:e.model,dialogModel:e.dialogModel,dialogTitle:e.title,primaryLabel:e.primaryLabel,onCreate:t=>e.primaryAction(t),noDescription:!0})}const A={displayCreateScenarioDialog:function(e,t){g({title:E("E6WCommonApps.Label.NewScenario"),model:e,primaryAction:n=>{A._createScenario({parentProject:e,title:n.get(s.TITLE_ATTR),onSuccess:t})}})},_createScenario:function(t){var n=t.parentProject;const i=[{label:t.title,projectId:n.id}];a.request(`${l.getServiceUrl("3dplan",!1)}/v1/invoke/dsxplan:createExperiment?$mask=dsplan:MVMask.Experiment.Basic`,{method:"POST",type:"json",headers:{"Content-Type":"application/json"},data:JSON.stringify(i),onComplete:i=>{var o=n.getCollectionAttribute(s.DSLC_SCENARIOS_ATTR);let a=r.mergeOrCreateObject(i);o.add(a,{dontRegisterChange:!0}),a.dispatchEvent("onChange"),e.is(t.onSuccess,"function")&&t.onSuccess(a)},onFailure:()=>{d.displayError(E("E6WCommonApps.Error.ScenarioCreationFailed"))}})},displayEditScenarioDialog:function(e){const t=e.get(s.SCENARIOS_PARENT_ATTR);g({title:E("E6WCommonApps.Label.RenameScenario"),model:e.get(s.SCENARIOS_PARENT_ATTR),dialogModel:e,primaryLabel:E("E6WCommonUI.Label.Save"),primaryAction:n=>{var i=e.get("@id"),o=t?t.get("@id"):null,r=[[{id:i,attributes:{label:n.get(s.TITLE_ATTR)}}],o];a.request(l.getServiceUrl("3dplan",!1)+"/v1/invoke/dsxplan:updateExperimentAttributes?$mask=dsplan:MVMask.Experiment.Basic",{method:"POST",type:"json",headers:{"Content-Type":"application/json"},data:JSON.stringify(r),onComplete:function(t){t.member&&t.member.length&&(e.set(t.member[0]),e.dispatchEvent("onChange"))},onFailure:function(){d.displayError(E("E6WCommonApps.Error.ScenarioUpdateFailed"))}})}})},deleteScenarioHandler:function(t){var i=t.get(s.SCENARIOS_PARENT_ATTR),o=i?i.get("@id"):null,r=t.get(s.DSLC_TITLE_ATTR)||"";if(o){var p=e.createElement("div"),h=u.replace(E("E6WCommonApps.Confirm.DeleteScenario"),{NAME:c.Utils.escapeExpression(r)});e.createElement("p",{html:h}).inject(p),n.getSuperModal().dialog({body:p,title:E("E6WCommonApps.Label.DeleteScenario"),buttons:[{className:"primary danger",value:E("E6WCommonUI.Label.Delete"),action:function(e){var n=[[t.get("@id")],o];a.request(l.getServiceUrl("3dplan",!1)+"/v1/invoke/dsxplan:deleteExperiments?$mask=dsplan:MVMask.WorkPackage.Experiments",{method:"POST",type:"json",headers:{"Content-Type":"application/json"},data:JSON.stringify(n),onComplete:function(){t.destroy({noServer:!0})},onFailure:function(){d.displayError(E("E6WCommonApps.Error.ScenarioDeleteFailed"))}}),e.hide()}},{value:E("E6WCommonApps.Command.Cancel"),action:function(e){e.hide()}}]})}},getManagementView:function(){return this._mgmtView},setManagementView:function(e){this._mgmtView=e},updateScenarioAttributes:function(e,t){e.map((e=>{(h.has(e.name)||T[t]&&T[t].has(e.name))&&(e.readWrite=!1)}))},pushAllChangesToProject:function(e){let t=o.subscribeActivity(E("xPlan.Label.PushingChangesToProject"),{start:!0,infiniteFlag:!0});a.invokeAsLRT("dsxplan:mergeExperiment",{method:"POST",type:"json",headers:{"Content-Type":"application/json"},data:{experimentId:e.experimentId,projectId:e.projectId,identifier:t},onComplete:function(){e.onComplete();const t=E("E6WCommonApps.Alert.ScenarioPushSuccess");d.displaySuccess(t)},onFailure:function(){o.processMessage({name:E("xPlan.Label.PushingChangesToProject"),id:t},{type:o.MESSAGE_FAIL})}})},getScenarioJSON:function(){if(A.inScenario()){return i.getCurrentModel().getScenarioJSON()}},inScenario:function(){let e=i.getCurrentModel();if(e)return"ScenarioModel"===e._uwaClassName},isRootProjectInScenario:function(e){return this.inScenario()&&i.getCurrentModel().get(s.SCENARIOS_PARENT_ATTR)===e},getScenarioId:function(){if(A.inScenario()){return i.getCurrentModel().id}},fetchScenarioJSON:function(e){if(A.inScenario()){i.getCurrentModel().fetchJSON(e)}},applyScenarioChanges:function(){A.inScenario()&&i.getCurrentModel().applyScenarioChanges()},isNewInScenario:function(e){if(A.inScenario())return i.getCurrentModel().isNewInScenario(e)},disableScenarioCreation:function(e){return e.currentUserIsLeader&&!e.currentUserIsLeader()||e.isComplete&&e.isComplete()}};return r.ScenariosUtils=A,A})),define("DS/E6WCommonApps/Utils/RapidUtils",["UWA/Class/Events","UWA/Class/Listener","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Utils/ScenariosUtils"],(function(e,t,n,s,i,o){"use strict";const a={tasksWithSubtasks:{},dispatcher:new e,listener:new t,rapidServerResponseToRDF:function(e,t){const i={"dsplan:enterpriseIdentificationNumber":t["dsplan:enterpriseIdentificationNumber"],"@id":t.uri,"dsplan:comment":t.description,"dsxplan:label":t.name,"dsplan:estimatedDate":t.estimatedDate,"dsplan:actualDate":t.actualDate,"dsplan:userDefinedDates":"true"===t.fixed,"dsxplan:hasMaturity":t.maturity?{"@id":t.maturity.replace(/.*xPlan\//i,"dsxplan:")}:void 0,"dspol:ceStamp":t.ceStamp,"dsplan:suggestedDate":t.suggestedDate,"dsxplan:vocabularyType":t.vocabularyType,"@etag":t["dspol:ceStamp"],"dsplan:actualEndDate":t.actualEndDate,"dsplan:actualStartDate":t.actualStartDate,"dsxplan:jsType":t["dsxplan:jsType"]||t["dsplan:jsType"],"dsplan:durationIntervalMax":t.durationIntervalMax,"dsplan:durationIntervalMin":t.durationIntervalMin,"dsplan:startDateIntervalMin":t.startDateIntervalMin,"dsplan:startDateIntervalMax":t.startDateIntervalMax,"dsplan:endDateIntervalMin":t.endDateIntervalMin,"dsplan:endDateIntervalMax":t.endDateIntervalMax,"dsplan:dateIntervalMin":t.dateIntervalMin,"dsplan:dateIntervalMax":t.dateIntervalMax,"dsplan:estimatedDuration":t.estimatedDuration,"dsplan:estimatedEndDate":t.estimatedEndDate,"dsplan:estimatedStartDate":t.estimatedStartDate,"dsplan:userDefinedEnd":"true"===t.fixedEnd,"dsplan:userDefinedStart":"true"===t.fixedStart,"dsplan:percentageCompletion":t.percentage?parseFloat(t.percentage):void 0,"dsplan:hasPriority":t.priority?{"@id":t.priority}:void 0,"dsxplan:sequenceOrder":t.sequenceOrder?parseFloat(t.sequenceOrder):void 0,"dsxplan:hasAssignee":t.assignees?a.parseRapidCollectionToRDF(e,"dsxplan:hasAssignee",t.assignees):void 0,"dsplan:hasScheduleError":t.scheduleError||t.error,"dsxplan:hasConstraint":t.constraints?a.parseRapidCollectionToRDF(e,"dsxplan:hasConstraint",t.constraints):void 0,"dsxplan:to":t.to,"dsxplan:from":t.from,"dsxplan:constraintType":t.type,"dsxplan:isEnforced":t.isEnforced,"dsplan:resolution":t.resolution,"dskern:owner":t.owner?n.getObjectForAdding(s,t.owner,{}):void 0,"dsxplan:lag":t.lag,"dsxplan:customExtensionName":t["dsxplan:customExtensionName"],"dsplan:scheduleElementColor":t.scheduleElementColor,subtitle:t.subtitle,"dsplan:projectType":t.projectType,"dsplan:isTemplate":t.isTemplate,"dsplan:referenceConfig":t.referenceConfig,"dsplan:hasThumbnail":t.thumbnail};t.parent&&(i["dsxplan:workscopeParent"]=n.getObjectById(t.parent));return Object.keys(i).forEach((e=>{null==i[e]&&delete i[e]})),a.tasksWithSubtasks[t.uri]=t.hasSubtasks,i},hasSubtasks:function(e){return e.getSubtasks().length>0||a.tasksWithSubtasks[e.id]},createRapidProxy:function(e){return{getRDFModel:()=>e,rdfModel:e,id:e.id}},fetchTasks:function(e,t){e.fetching=!0,e.fetchingMask("dsplan:MVMask.Task.Complex.All"),n.request(n.expandUrl("/invoke/dsxplan:getSubTasks"),{method:"POST",data:JSON.stringify([n.jsonURIToSparqlURI(e.id),100,-1]),onComplete:s=>{e.doneFetchingMask("dsplan:MVMask.Task.Complex.All"),e.addMask("dsplan:MVMask.Task.Complex.All");const r=JSON.parse(s)["@value"],l=JSON.parse(r),d=[];a.bindSubtasks(e);for(let t=0;t<l.tasks.length;t++){const s=l.tasks[t],o=a.rapidServerResponseToRDF(e.id,s);o["dsxplan:taskParent"]={"@id":e.id};const r=i.mergeOrCreateObject(o);e.getSubtasks().add(r,{dontRegisterChange:!0,silent:!0}),s.constraints&&s.constraints.forEach((e=>{d.push(n.getObjectById(e.uri))}))}d.forEach((e=>e.updateParentWorkscopes({forceDispatchEvent:!0}))),l.tasks.length>0&&(a.tasksWithSubtasks[e.id]=!0),e.fetching=!1,e.dispatchEvent("onChange:dsxplan:hasSubtask",[e,!0]),e.getSubtasks().dispatchEvent("loaded"),a.dispatcher.dispatchEvent("refreshTagger",[e.getAllSubTasks()]),t&&t.onComplete&&t.onComplete(),o.applyScenarioChanges()},onFailure:()=>{e.doneFetchingMask("dsplan:MVMask.Task.Complex.All"),e.fetching=!1,t&&t.onFailure&&t.onFailure()}})},bindSubtasks:function(e){const t=e.getSubtasks();a.listener.stopListening(e),a.listener.stopListening(t);const n=(t,n)=>{a.tasksWithSubtasks[e.id]=e.hasSubtasks(),a.dispatcher.dispatchEvent(n,[t,e])};a.listener.listenTo(t,{onAdd:e=>n(e,a.events.subTaskAdded),onRemove:e=>n(e,a.events.subTaskRemoved),loaded:e=>n(e,a.events.loaded)}),a.listener.listenToOnce(e,{onDestroy:()=>a.listener.stopListening(e.getSubtasks())})},parseRapidCollectionToRDF:function(e,t,n){let s=n;return n[0]&&n[0].uri&&(s=n.map((e=>a.rapidServerResponseToRDF(e.uri,e)))),{"@type":"Collection","@href":`/resources/${e}/${t}`,"@id":`${e}/${t}`,member:s}},events:{destroyed:"destroyed",loaded:"loaded",expanded:"expanded",subTaskRemoved:"subTaskRemoved",subTasksLoaded:"subTasksLoaded",subTaskAdded:"subTaskAdded"}};return a})),define("DS/E6WCommonApps/AgileProjectUtils",["UWA/Core","DS/i3DXCompassPlatformServices/OpenWith","DS/RDFFoundation/FederatedSearchUtil","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ComponentProxyModel","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Utils/3DSpaceUtils","DS/E6WCommonApps/Views/E6WObjectCardView","DS/E6WCommonApps/SimpleDialogFactory","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p){"use strict";const u=function(e){var t=e;return t===e&&(t=p.get(e)),t},h={[r.RESPONSIBILITY_LEADER]:"Owner",[r.RESPONSIBILITY_AUTHOR]:"Contributor",[r.RESPONSIBILITY_VIEWER]:"Member"},m={_openWithInst:new t,contextSearchSourceTypes:{swym:["Idea","Post","Question","Wiki","WikitreePage","Wikitree","swym:WikitreePage","swym:Wikitree","swym:Question","swym:Idea","swym:Post","question","post","idea","wiki"],"3dspace":["Requirement","Requirement Specification","Document","Issue","URL","Change Action","Change Request"],drive:["DriveFile"]},getContextSearchSources:function(){return n.filterSearchSources(Object.keys(m.contextSearchSourceTypes))},getContextTypes:function(){const e=[];return Object.values(m.contextSearchSourceTypes).forEach((t=>{e.push(...t)})),e},updateTaskParent:function(e,t,n,s,i){s?(e.set(r.SEQUENCE_ORDER_ATTR,n.getSequenceOrderForLastChild("dsplan:hasTask"),i),e.set("dsxplan:backlogParent",n,i)):e.set("dsxplan:workscopeParent",n,i)},addTaskForWorkContext:function(t,n,s){const i=e.clone(s||{},!1),o=t.addTask({},i);return o.set(r.WORK_CONTEXT_ATTR,n),o.set(r.TITLE_ATTR,n.get("title")),i.sequenceOrder&&o.set("dsplan:sequenceOrder",i.sequenceOrder),i.batch&&o.save(void 0,{ajax:i.batch.ajax}),o},getOpenWith:function(e){return{id:"Open_With",type:"PushItem",title:u("E6WCommonUI.Label.OpenWith"),fonticon:{content:"wux-ui-3ds wux-ui-3ds-open-menu-dot",family:"DSFontIcon"},submenu:async()=>new Promise((t=>{const n=[];l.fetchParentTypesWithCallback(e,(()=>{m._openWithInst.set3DXContent(e.getTransferObject()).retrieveCompatibleApps((function(e){e.length>0&&e.forEach((function(e){n.push({name:e.text,type:"PushItem",title:e.text,icon:e.icon,action:{callback:function(t){e.handler.call(t)}}})})),t(n)}))}))}))}},isExistingWorkContext:function(e){s.request(s.expandUrl("invoke/dsxplan:isExistingWorkContext"),{method:"POST",headers:{"Content-Type":"application/json"},type:"json",data:JSON.stringify({projectId:e.projectId,contextIds:e.contextIds,excludeBacklog:e.excludeBacklog}),onComplete:e.onComplete,onFailure:e.onFailure})},isWorkContextType:function(e){for(const t in m.contextSearchSourceTypes)if(Object.hasOwnProperty.call(m.contextSearchSourceTypes,t)&&m.contextSearchSourceTypes[t].includes(e))return!0},getAssociatedKanbanFieldConfig:function(e){return{readWrite:Boolean(o.getServiceUrl("3dlifecycle",!0)),name:r.ASSOCIATED_KANBANS,attributeToDisplay:"title",imageAttribute:"image",label:u("E6WCommonUI.Label.AssociatedKanbanBoards"),type:"object",customView:d,typeAheadCallback:Function.prototype,placeHolder:u("E6WCommonUI.Label.ClickToAddKanbanBoard"),placeHolderOnly:!0,activationCallback:(t,n)=>n&&c.build({project:e,dialogTitle:u("E6WCommonUI.Label.NewKanbanBoard"),onCreate:t=>{m._createKanbanBoard({project:e,title:t.get("title"),description:t.get("subtitle")})}}),disableRemove:!0,dropHandler:()=>!0,addExistingTooltip:u("E6WCommonUI.Label.CreateNew"),minLengthBeforeAutocomplete:1e3}},_createKanbanBoard:function(e){s.request(`${o.getServiceUrl("3dlifecycle",!1)}/resources/v1/modeler/kanban/boards?tenant=${o.getTenant()}`,{method:"POST",type:"json",headers:{"Content-Type":"application/json",Securitycontext:"ctx::Kanban User.Company Name.Kanban_PRJ"},data:JSON.stringify({title:e.title,type:"Maturity",description:e.description,query:{type:"Project",Proxy_Id:s.shortToLongURI(e.project.id),label:e.project.get("title")}}),onComplete:t=>{e.project.addKanbanBoard({title:t.title,id:t.id}),m._addProjectUsersToKanbanBoard(e.project,t.id)},onFailure:()=>{a.displayError(u("E6WCommonUI.Error.KanbanBoardCreationFailed"))}})},_addProjectUsersToKanbanBoard:function(e,t){const n={user:[],userGroup:[]};e.getTeamMembers().forEach((e=>{let t,i={};switch(e.get("type")){case r.USER_GROUP_TYPE:t=n.userGroup,i.name=e.get("title"),i.UUID=s.shortToLongURI(e.get("physicalId"));break;case r.PERSON_TYPE:t=n.user,i.name=e.get("dsaccess:accountName")}t.push({action:"add",role:h[e.getHighestResponsibility()],...i})})),s.request(`${o.getServiceUrl("3dlifecycle",!1)}/resources/v1/modeler/kanban/boards/${t}?tenant=${o.getTenant()}`,{method:"PATCH",type:"json",headers:{"Content-Type":"application/json",Securitycontext:"ctx::Kanban User.Company Name.Kanban_PRJ"},data:JSON.stringify(n),onComplete:e=>"success"!==e.status&&a.displayError(u("E6WCommonUI.Error.KanbanBoardUsersFailed")),onFailure:()=>a.displayError(u("E6WCommonUI.Error.KanbanBoardUsersFailed"))})}};return m})),define("DS/E6WCommonApps/XTaskScope",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/UserPreferences","DS/Foundation/WidgetUwaUtils","DS/Foundation/WidgetAPIs","DS/Foundation2/FoundationV2Data","DS/E6WCommonUI/PlatformManager","DS/E6WCommonApps/ScheduleConstants","DS/E6WCommonApps/AgileProjectUtils"],(function(e,t,n,s,i,o,a,r,l){"use strict";var d="scopeId_18x",c={getCollection:function(){return this._collection},setCollection:function(e){this._collection=e},isScopeRDF:function(){return!this._initialized&&this.initialize(),this._scopeIsRDF},isScopeSwym:function(){return!this._initialized&&this.initialize(),this._scopeIsSwym},getTSKTaskType:function(){var e=c.getObjectData(),t=!1,s=n.getSpecificPreference(r.TASK_TYPE);return c.isAgileWorkContext()&&(t=!e.isSwym),this.getScopeType()?this.isScopeRDF()?t?r.DPM_TASK:r.XPP_TASK:(e&&e.type,r.DPM_TASK):a.getServiceUrl("3dplan",!0)?s||r.STANDALONE_TASK:r.SIMPLE_TASK},getScopeId:function(){return!this._initialized&&this.initialize(),this._scopeId},getScope:function(){return t.getObjectById(this.getScopeId())},getScopeType:function(){return!this._initialized&&this.initialize(),this._scopeType},getObjectData:function(){return!this._initialized&&this.initialize(),this._objectData},initialize:function(){if("undefined"!=typeof widget){var e=widget.getValue(d);if(void 0===e){var t=widget.getValue("scopeId"),n={};if(t){var s="~~";-1===t.indexOf("~~")&&(s=":");var i=t.split(s);n={id:i[1],type:i[0],isRDF:Boolean(widget.getValue("scopeIsRDF")),isSwym:Boolean(widget.getValue("scopeIsSwym"))},this.setScopeData(n),widget.deleteValue("scopeIsRDF"),widget.deleteValue("scopeIsSwym"),widget.deleteValue("scopeId")}else this.removeScopeData();return}(e=JSON.parse(e))&&e.id?(e.localOnly=!0,this.setScopeData(e)):this.removeScopeData()}},setScopeData:function(t){var n=e.clone(t||{},!1);if(!n.id||!n.type||void 0===n.isRDF)throw new Error("id, type, and isRDF must be passed in an options object to setScopeData");var s={id:n.id,type:n.type,objectData:n.objectData,isRDF:Boolean(n.isRDF),isSwym:Boolean(n.isSwym)};n.localOnly||widget.setValue(d,JSON.stringify(s)),window.enoviaServer&&window.enoviaServer.preferences&&(window.enoviaServer.preferences.scopeId=s.id,window.enoviaServer.preferences.scopeType=s.type,window.enoviaServer.preferences.scopeObjectData=s.objectData),this._scopeId=s.id,this._scopeType=s.type,this._objectData=s.objectData,this._scopeIsRDF=s.isRDF,this._scopeIsSwym=s.isSwym,this._widgetScopeId=s.id,this._widgetScopeType=s.type,this._widgetScopeIsRDF=s.isRDF,this._widgetScopeIsSwym=s.isSwym,this._initialized=!0,n.hasOwnProperty(n.collection)&&this.setCollection(n.collection)},removeScopeData:function(){widget.setValue(d,JSON.stringify({id:void 0,type:void 0,isRDF:void 0,isSwym:void 0})),this._widgetScopeId=void 0,this._widgetScopeType=void 0,this._widgetScopeIsRDF=void 0,this._widgetScopeIsSwym=void 0,this.removeUserScopeData()},removeUserScopeData:function(){this._scopeId=void 0,this._scopeType=void 0,this._objectData=void 0,this._scopeIsRDF=void 0,this._scopeIsSwym=void 0,this._initialized=!0,this._collection=void 0,window.enoviaServer&&window.enoviaServer.preferences&&(delete window.enoviaServer.preferences.scopeId,delete window.enoviaServer.preferences.scopeType,delete window.enoviaServer.preferences.scopeIsRDF,delete window.enoviaServer.preferences.scopeIsSwym,delete window.enoviaServer.preferences.scopeObjectData)},resetLocalScopeData:function(){delete this._widgetScopeId,delete this._widgetScopeType,delete this._widgetScopeIsRDF,delete this._widgetScopeIsSwym,delete this._initialized,this._collection=void 0},getFilter:function(){return widget.getValue("currentTaskFilter")||"all"},setFilter:function(e){widget.setValue("currentTaskFilter",e)},setScopeToInvalid:function(e){this._isInvalidScope=e},isInvalidScope:function(){return this._isInvalidScope},isAgileWorkContext:function(){if(this._objectData)return l.isWorkContextType(this._objectData.type)},FILTER_ASSIGNED:"assigned",FILTER_OWNED:"owned",FILTER_ALL:"all",FILTER_CANDIDATE_ASSIGNEE:"candidateAssignee"};return c.PREF=d,c})),define("DS/E6WCommonApps/TaskUtils",["DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/XTaskScope","DS/E6WCommonApps/ScheduleConstants","DS/RDFFoundation/Models/ComponentProxyModel","DS/E6WCommonUI/TopBarSearchDispatcher"],(function(e,t,n,s,i){"use strict";var o={useFTS:function(){var t=widget.getValue(e.LEVEL_PREF)===e.ALL_LEVEL_TASKS,n=Boolean(i.getSearchString());return t||n},comparator:function(e,t){var n=e.get("dsxplan:sequenceOrder"),s=t.get("dsxplan:sequenceOrder");return void 0!==n&&void 0!==s&&n!==s?n-s:new Date(e.getStartDate()||e.get("dspol:creationDate")).getTime()-new Date(t.getStartDate()||t.get("dspol:creationDate")).getTime()},_addObjects:function(e){let t=[],n=UWA.clone(e||{},!1),i=[],o=n?.objectsArr;for(let e=0;e<o.length;e++){const n=o[e];var a={id:n.id,title:n.title,serviceId:n.serviceId,tenant:n.tenant,image:n.image},r=s.getOrCreateProxy(a);r.forceAccess=!0,r["@type"]=n.type,i.push(new Promise(((e,t)=>{r.save(void 0,{onComplete:()=>{e()},onFailure:()=>{t()}})}))),t.push(r)}Promise.all(i).then((()=>{n.model.addObjects&&n.model.addObjects(t,n.attr,void 0,{silentOnChange:!0,at:0,values:t}),n.model.save(void 0,{onComplete:()=>{n.resolve&&n.resolve()},onFailure:()=>{n.reject&&n.reject()}})}),(()=>{n.reject&&n.reject()}))},createTask:function(s,i,o,a){let r,l=UWA.clone(a||{},!1),d=l.context,c=t.getObjectData(),p=!1;t.isAgileWorkContext()&&(p=t.isAgileWorkContext()&&!c.isSwym);let u={onComplete:function(){arguments[2]=l,l.onCompleteCallback&&l.onCompleteCallback.apply(d,arguments)}};if(l.onFailureCallback&&(u.onFailure=function(){l.onFailureCallback.apply(d,[arguments])}),t.isScopeRDF()&&!p||!t.getScopeType()&&o===n.STANDALONE_TASK){let t;i&&(u.createDescription=i),l.rdfTasksCollection&&(t=l.rdfTasksCollection);let c={};if(o===n.XPP_TASK&&d&&d.charEditor&&d.charEditor.getFormValues()){if(!d.charEditor.elements.form.validateForm().isValid)return void d.tabBar.getButtonFromValue(1).elements.container.classList.add("has-error");c.extensionID=d._templateComboBox.value;let e=d.charEditor.getFormValues(),t={};Object.keys(e).forEach((function(n){t[n]=e[n].value})),c.instanceParams=t}if(Object.keys(c).length>0&&(u.extensionAttrs=c),l.attachments||l.deliverables){var h=this;u.onComplete=function(t){let n=[];l.attachments&&n.push(new Promise(((n,s)=>{h._addObjects({objectsArr:l.attachments,attr:e.ATTACHMENT_ATTR,model:t,resolve:n,reject:s})}))),l.deliverables&&n.push(new Promise(((n,s)=>{h._addObjects({objectsArr:l.deliverables,attr:e.ACTUAL_DELIVERABLE_ATTR,model:t,resolve:n,reject:s})}))),Promise.all(n).then((()=>{arguments[2]=l,l.onCompleteCallback&&l.onCompleteCallback.apply(d,arguments)}),(e=>{l.onFailureCallback&&l.onFailureCallback(e)}))}}u.ignoreDictionary=!(widget&&("ENOTASK_AP"===widget.getValue("appId")||"ENXPLAN_AP"===widget.getValue("appId"))),r=t.addNewTask(s,a&&l.scope,u)}else{let e,t=1,n=0;l.tasksCollection&&(e=l.tasksCollection);let o=e.allDueDates()[t],a={title:s,description:i,state:e.allStates()[n].actualValue,dueDateCategory:o};if(i&&(a.description=i),r=e.addNewTask(a),r.completed=!0,u.urlParam="$fields=deliverablesInheritance,isAssigneeAccessRestricted,calculateDuration,revision,custom,references.description,deliverables.description",u.at=0,l.attachments)for(let e=0;e<l.attachments.length;e++){const t=l.attachments[e];r.addReferencesById(t.id||t.physicalId)}if(l.deliverables)for(let e=0;e<l.deliverables.length;e++){const t=l.deliverables[e];r.addObjects(t.id||t.physicalId,"deliverables")}if(l.scopes&&r.addObjects(l.scopes,"scopes"),l.assignees)for(let e=0;e<l.assignees.length;e++){const t=l.assignees[e];r.addObjects(t,"assignees")}r.save(null,u)}return l.onExecuteCreateTask&&l.onExecuteCreateTask.apply(d,[r]),r}};return o})),define("DS/E6WCommonApps/TreeDocument/TreeNodeUtil",["DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/Collections/ResultCollection","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/TaskUtils","DS/E6WCommonApps/Utils/RapidUtils","DS/E6WCommonApps/Preferences","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r){"use strict";const l="endDataWithWeek",d="correspondingModel";var c="column-text-color",p=10,u=function(e){return r.get(e)},h={title:"title",uniqueObjectId:"uniqueObjectId",description:"description",context:"context",project:"project",maturity:"maturity",priority:"priority",percent:"percent",routeContent:"contents",routeTaskAction:"routeTaskAction",routeTaskInstructions:"routeTaskInstructions",estimatedStartDate:"estimatedStartDate",estimatedFinishDate:"estimatedFinishDate",estimatedDuration:"estimatedDuration",attachments:"references",deliverables:"deliverables",community:"community",actualStartDate:"actualStartDate",actualFinishDate:"actualFinishDate",created:"created",modified:"modified",assignees:"assignees",owner:"owner",auditModifiedBy:"auditModifiedBy",auditType:"auditType",auditAction:"auditAction",auditDetails:"auditDetails",auditObjectName:"auditObjectName"},m={[h.title]:"dsplan:MVMask.Task.Title",[h.uniqueObjectId]:"dsplan:MVMask.Task.UniqueObjectId",[h.description]:"dsplan:MVMask.Task.Description",[h.project]:"dsplan:MVMask.Task.Project",[h.maturity]:"dsplan:MVMask.Task.Maturity",[h.priority]:"dsplan:MVMask.Task.Priority",[h.percent]:"dsplan:MVMask.Task.Percent",[h.estimatedStartDate]:"dsplan:MVMask.Task.PlannedStart",[h.estimatedFinishDate]:"dsplan:MVMask.Task.PlannedEnd",[h.estimatedDuration]:"dsplan:MVMask.Task.EstimatedDuration",[h.attachments]:"dsplan:MVMask.Task.Attachments",[h.deliverables]:"dsplan:MVMask.Task.Deliverables",[h.community]:"dsplan:MVMask.Task.Community",[h.actualStartDate]:"dsplan:MVMask.Task.ActualStart",[h.actualFinishDate]:"dsplan:MVMask.Task.ActualEnd",[h.created]:"dsplan:MVMask.Task.Created",[h.modified]:"dsplan:MVMask.Task.Modified",[h.assignees]:"dsplan:MVMask.Task.Assignees",[h.owner]:"dsplan:MVMask.Task.Owner"},T={[s.DSLC_TITLE_ATTR]:h.title,[s.UNIQUE_OBJECT_ID_ATTR]:h.uniqueObjectId,[s.DESCRIPTION_ATTR]:h.description,[s.COMMON_TASK_PARENT_ATTR]:h.project,[s.TASK_PARENT_ATTR]:h.project,[s.PARENT_ATTR]:h.project,[s.DSLC_STATE_ATTR]:h.maturity,[s.DSLC_PRIORITY_ATTR]:h.priority,[s.COMPLETE_PERCENT_ATTR]:h.percent,[s.STARTDATE_ATTR]:h.estimatedStartDate,[s.ENDDATE_ATTR]:h.estimatedFinishDate,[s.DSLC_DURATION_ESTIMATED]:h.estimatedDuration,[s.ATTACHMENT_ATTR]:h.attachments,[s.ACTUAL_DELIVERABLE_ATTR]:h.deliverables,[s.PARENT_HAS_SWYM_COMMUNITY]:h.community,[s.ACTUAL_START_DATE]:h.actualStartDate,[s.ACTUAL_END_DATE]:h.actualFinishDate,[s.CREATION_DATE_ATTR]:h.created,[s.LASTUPDATED_ATTR]:h.modified,"dsxplan:hasAssignee":h.assignees,[s.OWNER_ATTR]:h.owner,[s.STORY_POINTS]:s.STORY_POINTS,[s.DSLC_DESCRIPTION_ATTR]:h.description,[s.SUGGESTED_DATE_ATTR]:h.estimatedFinishDate,[s.SEQUENCE_ORDER_ATTR]:"sequenceOrder",isWedo:"isWedo",icon:"icon",richTextDescription:"richTextDescription",hasChildren:"hasChildren"},E={title:h.title,uniqueObjectId:h.uniqueObjectId,description:h.description,context:h.context,DPMProject:h.project,scopes:h.context,contents:h.routeContent,routeTaskAction:h.routeTaskAction,routeTaskInstructions:h.routeTaskInstructions,state:h.maturity,percentComplete:h.percent,estimatedStartDate:h.estimatedStartDate,dueDate:h.estimatedFinishDate,routeTaskDueDate:h.estimatedFinishDate,estimatedDuration:h.estimatedDuration,estimatedDurationInputValue:h.estimatedDuration,estimatedDurationInputUnit:h.estimatedDuration,references:h.attachments,deliverables:h.deliverables,actualStartDate:h.actualStartDate,actualFinishDate:h.actualFinishDate,originated:h.created,modified:h.modified,assignees:h.assignees,ownerInfo:h.owner},g=[s.DSLC_DURATION_ESTIMATED,s.DSLC_DURATION_MIN,s.DSLC_DURATION_MAX,"estimatedDuration","estimatedDurationInputValue","estimatedDurationInputUnit"],A=[s.DSLC_STATE_ATTR,"state"],C=[s.DSLC_DESCRIPTION_ATTR,"subtitle"],_=["dsxplan:hasAssignee","assignees"],f=[s.OWNER_ATTR,"ownerInfo"],D=function(e){return e%1==0?Math.round(e):e},S=function(e){if(e.isRouteTask()){var t=e.dataForRendering({attributes:"cardTitle"}).cardTitle;return t&&t.split("|")[1]}return""},R=function(e){var t;if(e.isRDFTask()){var n;let r=e.getStartAndFinishDates();if((o.hasSubtasks(e)||e.hasSubtasks())&&r){var i=r.start,a=r.finish;let t=e.getNonWorkingDayIterator();n=t&&t.countWorkingDays(i,a)}else n=(t=e.get(s.DURATION_ESTIMATED))?e.getEstimatedDuration():e.getSuggestedDuration();return n+" "+u("E6WCommonApps.Label.Days")+" +/- "+e.getSuggestedOffset()}t=e.get("estimatedDuration");var r=e.get("estimatedDurationInputValue"),l=e.get("estimatedDurationInputUnit");return"d"===l?D(t)+" "+u("E6WCommonApps.Label.Days"):"h"===l?D(r)+" "+u("E6WCommonApps.Label.Hours"):"w"===l?D(r)+" "+u("E6WCommonApps.Label.Weeks"):"mon"===l?D(r)+" "+u("E6WCommonApps.Label.Months"):void 0},y=function(e){switch(e){case"Create":case"Draft":return u("E6WCommonApps.Label.Preliminary");case"Open":case"Assign":return u("E6WCommonApps.Label.ToDo");case"InProgress":case"Active":return u("E6WCommonApps.Label.InWork");case"Review":return u("E6WCommonApps.Label.InApproval");case"OnHold":return u("E6WCommonApps.Label.OnHold");case"Done":case"Complete":return u("E6WCommonApps.Label.Completed");case"Published":return u("E6WCommonApps.Label.Published");default:return""}},v=function(e,t){var n=e.nodeModel.getAttributeValue(t);return a.getHideWeekLabel()||isNaN(new Date(n))?n:a.formatDate(new Date(n))},M=function(e){let t={};return e.cellModel===u("E6WCommonApps.Label.Medium")&&(t.icon="fonticon fonticon-medium priority-for-grid"),e.cellModel===u("E6WCommonApps.Label.Low")?t.icon="fonticon fonticon-low":e.cellModel===u("E6WCommonApps.Label.High")?t.icon="fonticon fonticon-high":e.cellModel===u("E6WCommonApps.Label.Urgent")&&(t.icon="fonticon fonticon-alert"),t},I=function(e){return e?e.replaceAll("</p>\n\n<p>","<br/>").replace(/<img .*?>/g,"<span class='fonticon fonticon-picture'></span>").replaceAll("\n",""):""},b=function(e){if(e){var t=e.dataForRendering();return t.get?t.get("title"):t.title}return""},O=function(e){return"TaskModel"!==e._uwaClassName||e.isProjectTask()?e.get(s.PERCENT_COMPLETE):" "},N=function(e,t){return(e=e?new Date(e):new Date("10/10/200"))-(t=t?new Date(t):new Date("10/10/200"))},P={COLUMN_DATA_INDICES:h,RDF_TO_TREE_NODE:T,ER_TO_TREE_NODE:E,DURATION_ATTRS:g,DESCRIPTION_ATTRS:C,STATE_ATTRS:A,addListenersOnTreeNode:function(e){var t,n,i=e.getAttributeValue(d);if(i.isRDFTask()?(t=Object.keys(T),n=T):(t=Object.keys(E),n=E),t.forEach((t=>{i.addEvent("onChange:"+t,(function(i,o){var a;a=-1!==g.indexOf(t)?R(i):-1!==A.indexOf(t)?y(i.get("state")):-1!==C.indexOf(t)?I(o):t===s.DSLC_PRIORITY_ATTR?i.getPriorityValueNLSString():i.isRouteTask()&&"contents"===t?S(i):t==s.PARENT_HAS_SWYM_COMMUNITY?b(o):t==s.PERCENT_COMPLETE?O(i):-1!==f.indexOf(t)?P.getOwnerForRow(i,i.get(t)):-1!==_.indexOf(t)?P.getAssigneesOnUpdate(i,i.get(t)):i.get(t),e.setAttribute(n[t],a)}))})),i.isRDFTask()){var o=i.get("dsxplan:hasAssignee");o&&i.listenTo(o,"onAccessSetOfGroup",(function(t){e.setAttribute(h.assignees,t.get("ds6w:label"))}))}else i.addEvent("onDestroy",(function(){e.remove(),e.destroy()}))},getMasksForFetchingRDFTaskDetails:function(e){return m[e]},getDisplayLabelForDuration:R,dateFieldsCompareFunc:N,priorityCellSemantics:M,getDisplayLabelForState:y,getDisplayLabelForPriority:function(e){if(e)return e.id&&(e=e.id),e.startsWith&&e.startsWith("dsxplan:")&&(e=e.substring(8)),u("Urgent"===e?"E6WCommonApps.Label.Urgent":"High"===e?"E6WCommonApps.Label.High":"Low"===e?"E6WCommonApps.Label.Low":"E6WCommonApps.Label.Medium")},getDisplayLabelForRouteContent:S,getDisplayLabelForDescription:I,getDisplayLabelForCommunity:b,getDisplayLabelForPercent:O,getOwnerForRow:function(e,t){var s=function(){if(t){let e=t.relationshipName?t[0]:t;return e?.get&&{name:e.get("nameAndAccount")||e.get("name"),image:e.get("image")}}t instanceof n&&e.listenTo(t,"onSync",(()=>{e.dispatchEvent("onChange:updateOwner",[e])}))}();return s?{label:s.name||s.displayName||u("E6WCommonApps.Label.AnonymousUser"),icon:s.image}:{}},getClassForState:function(e){return e===u("E6WCommonApps.Label.Preliminary")?"maturity-state-draft":e===u("E6WCommonApps.Label.ToDo")?"maturity-state-todo":e===u("E6WCommonApps.Label.InWork")?"maturity-state-inwork":e===u("E6WCommonApps.Label.InReview")?"maturity-state-review":e===u("E6WCommonApps.Label.OnHold")?"maturity-state-onhold":e===u("E6WCommonApps.Label.Completed")?"maturity-state-completed":e===u("E6WCommonApps.Label.Published")?"maturity-state-published":""},RDF_MODEL:d,comparator:function(e,t){const n=e.getAttributeValue(d),o=t.getAttributeValue(d),a=n.getObjectType(),r=o.getObjectType(),l=e=>"Milestone"===e||"Gate"===e,c=l(r),p=e=>e===s.TASK,u=e=>"Project"===e;if(l(a))return c?n.getStartDate()-o.getStartDate():-1;if(c)return 1;if(p(a)){if(c)return 1;if(p(r))return i.comparator(n,o)}return u(a)?u(r)?e.getAttributeValue("sequenceOrder")-t.getAttributeValue("sequenceOrder"):1:u(r)?-1:e.getAttributeValue("sequenceOrder")-t.getAttributeValue("sequenceOrder")},getAssigneesOnUpdate:function(i,o){var a=function(){var s=[];if(o instanceof e)s.push(o);else if(o instanceof t&&o.getModels()[0]instanceof n&&!(o.getModels()[0]instanceof e))s=o.getModels();else if(o&&o.getModels)s=o.getModels();else if(o&&o.relationshipName&&o&&o.length)for(let e=0;e<o.length;e++)s.push(o[e]);return s}(),r=[];return a.forEach((function(e){e&&e.get("name")?r.push({label:e.get&&(e.get("nameAndAccount")||e.get("name")),icon:e.get&&e.get("image")}):i&&e&&e.getObjectType()===s.LOGICAL_USER_TYPE&&(e.fetch({mask:"dsplan:MVMask.Person.Complex",onlyIfNeeded:!0}),e.addEventOnce("onChange:"+s.TITLE_ATTR,(()=>i.dispatchEvent("onChange:"+s.ASSIGNEE_ATTR_DSLC,[e]))))})),1==a.length?r[0]:0!=a.length?r:void 0},COMMON_CSS_CLASS_FOR_GRID_COLUMNS:c,MIN_WIDTH_OF_EACH_COLUMN:p,titleColumn:{text:u("E6WCommonApps.Label.Title"),dataIndex:"tree",typeRepresentation:"string",editableFlag:!1,minWidth:p,sortableFlag:!1,editionPolicy:"EditionOnDoubleClick",getCellSemantics:function(e){return{icon:e.nodeModel.getAttributeValue("icon")}},getCellClassName:function(e){var t=P.COMMON_CSS_CLASS_FOR_GRID_COLUMNS+" grid-title-cell ";return e.nodeModel&&e.nodeModel.getAttributeValue("isReferenceProject")?t+"reference-project":t}},priorityColumn:{text:u("E6WCommonApps.Label.Priority"),dataIndex:h.priority,editableFlag:!1,typeRepresentation:"string",className:c,minWidth:p,sortableFlag:!1,editionPolicy:"EditionOnDoubleClick",getCellSemantics:M},stateColumn:{text:u("E6WCommonApps.Label.MaturityState"),dataIndex:h.maturity,editableFlag:!1,typeRepresentation:"enumString",className:c,minWidth:p,sortableFlag:!1,editionPolicy:"EditionOnDoubleClick",getCellSemantics:function(){return{possibleValues:[u("E6WCommonApps.Label.Preliminary"),u("E6WCommonApps.Label.ToDo"),u("E6WCommonApps.Label.InWork"),u("E6WCommonApps.Label.OnHold"),u("E6WCommonApps.Label.Completed"),u("E6WCommonApps.Label.Published")]}},getCellClassName:function(e){return P.getClassForState(e.cellModel)}},percentCompleteColumn:{text:u("E6WCommonApps.Label.Percent"),dataIndex:h.percent,editableFlag:!1,typeRepresentation:"number",className:c,minWidth:p,sortableFlag:!1},assigneesColumn:{text:u("E6WCommonApps.Label.Assignees"),dataIndex:"assignees",editableFlag:!1,typeRepresentation:"detailedUser",minWidth:p,sortableFlag:!1,editionPolicy:"EditionOnDoubleClick",getCellClassName:function(e){return c+" grid-assignee-cell "+(e.nodeModel&&e.nodeModel.getAttributeValue("@id")&&e.nodeModel.getAttributeValue("@id").replace(":","").split("-").join(""))}},descriptionColumn:{text:u("E6WCommonApps.Label.Description"),dataIndex:h.description,typeRepresentation:"string",editableFlag:!1,sortableFlag:!1,visibleFlag:!0,className:"grid-description-cell",allowUnsafeHTMLContent:!0},ownerColumn:{text:u("E6WCommonApps.Label.Owner"),dataIndex:h.owner,editableFlag:!1,typeRepresentation:"detailedUser",minWidth:p,sortableFlag:!1,editionPolicy:"EditionOnDoubleClick",getCellClassName:function(e){return c+" grid-owner-cell "+(e.nodeModel&&e.nodeModel.getAttributeValue("@id")&&e.nodeModel.getAttributeValue("@id").replace(":","").split("-").join(""))}},actualStartColumn:{text:u("E6WCommonApps.Label.ActualStart"),dataIndex:h.actualStartDate,getCellTypeRepresentation:()=>a.getHideWeekLabel()?"date":"string",editableFlag:!1,sortableFlag:!1,compareFunction:N,className:l,getCellValue:function(e){return v.call(this,e,h.actualStartDate)}},actualEndColumn:{text:u("E6WCommonApps.Label.ActualEnd"),dataIndex:h.actualFinishDate,getCellTypeRepresentation:()=>a.getHideWeekLabel()?"date":"string",editableFlag:!1,sortableFlag:!1,compareFunction:N,className:l,getCellValue:function(e){return v.call(this,e,h.actualFinishDate)}},durationColumn:{text:u("E6WCommonApps.Label.Duration"),dataIndex:h.estimatedDuration,typeRepresentation:"string",editableFlag:!1,sortableFlag:!1,compareFunction:function(e,t){let n=0;try{if(!e)return-1;if(!t)return 1;n=parseFloat(e.split(" ")[0])-parseFloat(t.split(" ")[0])}catch(e){console.error(e)}return n}},plannedStartColumn:{text:u("E6WCommonApps.Label.PlannedStart"),dataIndex:h.estimatedStartDate,getCellTypeRepresentation:()=>a.getHideWeekLabel()?"date":"string",editableFlag:!1,sortableFlag:!1,compareFunction:N,className:l,getCellValue:function(e){return v.call(this,e,h.estimatedStartDate)}},plannedEndColumn:{text:u("E6WCommonApps.Label.PlannedEnd"),dataIndex:h.estimatedFinishDate,getCellTypeRepresentation:()=>a.getHideWeekLabel()?"date":"string",editableFlag:!1,sortableFlag:!1,compareFunction:N,className:l,getCellValue:function(e){return v.call(this,e,h.estimatedFinishDate)}}};return P})),define("DS/E6WCommonApps/TreeDocument/E6WTreeNodeModel",["UWA/Core","UWA/Class/Listener","DS/E6WCommonUI/UIHelper","DS/TreeModel/TreeNodeModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/TreeDocument/TreeNodeUtil"],(function(e,t,n,s,i,o){"use strict";const a=function(n){this._childrenToAdd=[],this.rdfModel=n.grid&&n.grid.correspondingModel;const i=e.clone(n,!1);if(this.rdfModel&&(Object.entries(o.RDF_TO_TREE_NODE).forEach((([e,t])=>{i.grid[t]=i.grid[t]||this.getTreeNodeValueForRdfAttribute(e)})),i.label=i.grid.title,i.icon=i.grid.icon),s.call(this,i),this.listener=new t,!n._isTrueRoot){if(!this.rdfModel)throw new Error("No associated rdf model!");this.addRdfModelListeners(),this._addRdfChildrenTimeout=setTimeout((()=>{this._addRdfChildrenTimeout=void 0,this.getTreeDocument()&&(this.getTreeDocument().prepareUpdate(),this.addExistingRdfChildren(),this.getTreeDocument().pushUpdate())}),0)}};return(a.prototype=Object.create(s.prototype,{constructor:{value:a}})).addRdfModelListeners=function(){this.listener.listenTo(this.rdfModel,"onDestroy",(()=>{this.remove(),this.destroy()})),this.listener.listenTo(this.rdfModel,"onAnyEvent",(e=>{const t=/onChange:(.*)/.exec(e);t&&this.onRdfModelAttributeChange(t[1])})),this.listener.listenTo(this.rdfModel,{"onChange:updateOwner":()=>this.onRdfModelAttributeChange("dskern:owner")})},a.prototype.remove=function(){this.getParent().isDestroyed()?console.warn("Cannot remove this node because its parent node is destroyed"):s.prototype.remove.apply(this,arguments)},a.prototype.onRdfModelAttributeChange=function(e){const t=o.RDF_TO_TREE_NODE[e];t&&(this.setAttribute(t,this.getTreeNodeValueForRdfAttribute(e)),e===i.DSLC_TITLE_ATTR&&this.setLabel(this.getTreeNodeValueForRdfAttribute(e)),this.acceptChangesDelayed())},a.prototype.getTreeNodeValueForRdfAttribute=function(e){switch(e){case i.DSLC_DESCRIPTION_ATTR:return o.getDisplayLabelForDescription(this.rdfModel.get(i.DSLC_DESCRIPTION_ATTR));case"dsxplan:hasMaturity":return o.getDisplayLabelForState(this.rdfModel.get("state"));case"dsxplan:hasAssignee":return o.getAssigneesOnUpdate(this.rdfModel,this.rdfModel.get("dsxplan:hasAssignee"));case"dskern:owner":return o.getOwnerForRow(this.rdfModel,this.rdfModel.get(i.OWNER_ATTR));case"icon":return this.rdfModel.getDefaultImage?this.rdfModel.getDefaultImage():this.rdfModel.get("image");default:return this.rdfModel.get(e)}},a.prototype.acceptChangesDelayed=function(){this._acceptChangesTimeout&&clearTimeout(this._acceptChangesTimeout),this._acceptChangesTimeout=setTimeout((()=>{this.acceptChanges()}),100)},a.prototype.sortChildren=function(){!this._sortTimeout&&(this._sortTimeout=setTimeout((()=>{this._sortTimeout=void 0,s.prototype.sortChildren.call(this,{sortFunction:o.comparator})}),a.SORT_TIMEOUT))},a.prototype._addChild=function(e,t,i){return n.wrapError((()=>{const n=i||{},a=i&&i.treeDocument?i.treeDocument:this.getTreeDocument(),r=a.options.nodeModelClass;let l=e;if(e instanceof s){const t=a.getTreeNodeModelFromRdfModel(e.rdfModel);if(t&&t!==e)throw new Error("Attempting to add duplicate TreeNodeModel to the document");l=e}else{const t=e&&e.grid&&e.grid[o.RDF_MODEL];a.getTreeNodeModelFromRdfModel&&(!n.allowDuplicates&&a.getTreeNodeModelFromRdfModel(t)?l=a.getTreeNodeModelFromRdfModel(t):a.options.nodeModelClass=this.getTreeDocument().getTreeNodeModelConstructor(t))}const d=s.prototype._addChild.call(this,l,t,i);if(a.options.nodeModelClass=r,!this.getTreeDocument().shouldBeExpanded)return d;const c=this.getTreeDocument().shouldBeExpanded(this)?"expanded":"collapsed";return this.getState()!==c&&this.setState({state:c}),d}))},a.prototype.addChild=function(){const e=s.prototype.addChild.apply(this,arguments);return this.sortChildren(),e},a.prototype.addExistingRdfChildren=Function.prototype,a.prototype.addRdfChild=function(e){this._addTimeout=this._addTimeout||setTimeout((()=>{this._addTimeout=void 0,this.addChild(this._childrenToAdd),this._childrenToAdd=[]}),0),this._childrenToAdd.push(e.getTreeNodeModelData())},a.prototype.hasChild=()=>!1,a.prototype.removeRdfChild=function(e){this.getChildren()&&this.getChildren().includes(this.getTreeDocument().getTreeNodeModelFromRdfModel(e))&&this.removeChild(this.getTreeDocument().getTreeNodeModelFromRdfModel(e))},a.prototype.destroy=function(){this._addRdfChildrenTimeout&&clearTimeout(this._addRdfChildrenTimeout),this._addRdfChildrenTimeout=void 0,this._sortTimeout&&clearTimeout(this._sortTimeout),this._sortTimeout=void 0,this.listener.stopListening(),this._modelEvents.publish({event:"onDestroy"}),s.prototype.destroy.apply(this,arguments)},a.prototype._privateExpand=function(){0===this.__expandAllCounter&&s.prototype._privateExpand.apply(this,arguments)},a.ADD_CHILD_TIMEOUT=0,a.ACCEPT_CHANGE_DELAY=100,a.SORT_TIMEOUT=200,a})),define("DS/E6WCommonApps/TreeDocument/BacklogTreeNodeModel",["DS/E6WCommonApps/TreeDocument/E6WTreeNodeModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],(function(e,t){"use strict";const n=function(){Object.defineProperty(this,"agileProject",{get:()=>this.rdfModel.get(t.WORKSCOPE_PARENT_ATTR)}),e.apply(this,arguments)};return(n.prototype=Object.create(e.prototype,{constructor:{value:n}})).addRdfModelListeners=function(){this.listener.listenTo(this.agileProject.getBacklogTasks(),"onAdd",(e=>{this.agileProject.isAutomaticBacklog()||e.get(t.WORK_CONTEXT_ATTR)&&this.addRdfChild(e)})),this.listener.listenTo(this.agileProject.getBacklogTasks(),"onRemove",(e=>this.removeRdfChild(e))),this.listener.listenTo(this.agileProject.getBacklogTasks(),"onChange:dsplan:sequenceOrder",(()=>this.sortChildren())),this.listener.listenTo(this.agileProject.getBacklogTasks(),`onChange:${t.WORK_CONTEXT_ATTR}`,((e,t)=>{t?this.addRdfChild(e):this.removeRdfChild(e)}))},n.prototype.addExistingRdfChildren=function(){this.agileProject.get(t.BACKLOG_SETTING)!==t.BACKLOG_AUTOMATIC&&this.agileProject.getBacklogTasks().forEach((e=>e.get(t.WORK_CONTEXT_ATTR)&&this.addRdfChild(e)))},n})),define("DS/E6WCommonApps/TreeDocument/BacklogWorkscopeTreeNodeModel",["DS/E6WCommonApps/TreeDocument/E6WTreeNodeModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],(function(e,t){"use strict";const n=function(){e.apply(this,arguments)};return(n.prototype=Object.create(e.prototype,{constructor:{value:n}})).addRdfModelListeners=function(){e.prototype.addRdfModelListeners.apply(this,arguments),this.listener.listenTo(this.rdfModel.getTasks(),"onAdd",(e=>e.get(t.WORK_CONTEXT_ATTR)&&this.addRdfChild(e))),this.listener.listenTo(this.rdfModel.getTasks(),"onRemove",(e=>this.removeRdfChild(e))),this.listener.listenTo(this.rdfModel.getTasks(),"onChange:dsplan:sequenceOrder",(()=>this.sortChildren())),this.listener.listenTo(this.rdfModel.getTasks(),`onChange:${t.WORK_CONTEXT_ATTR}`,((e,t)=>{t?this.addRdfChild(e):this.removeRdfChild(e)}))},n.prototype.addExistingRdfChildren=function(){this.rdfModel.getTasks().forEach((e=>e.get(t.WORK_CONTEXT_ATTR)&&this.addRdfChild(e)))},n})),define("DS/E6WCommonApps/Models/TaskTreeNodeModel",["DS/E6WCommonApps/TreeDocument/E6WTreeNodeModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/TreeDocument/TreeNodeUtil","DS/E6WCommonApps/Utils/RapidUtils"],(function(e,t,n,s){"use strict";const i=function(){this._uwaClassName="TaskTreeNodeModel",e.apply(this,arguments)};return(i.prototype=Object.create(e.prototype,{constructor:{value:i}})).getTreeNodeValueForRdfAttribute=function(i){switch(i){case t.TASK_PARENT_ATTR:case t.COMMON_TASK_PARENT_ATTR:case t.PARENT_ATTR:return this.rdfModel.getParentAsLabel();case t.COMPLETE_PERCENT_ATTR:return this.rdfModel.getPercentComplete();case t.DSLC_DURATION_ESTIMATED:return n.getDisplayLabelForDuration(this.rdfModel);case t.ATTACHMENT_ATTR:return this.rdfModel.getAttachments().getModels();case t.ACTUAL_DELIVERABLE_ATTR:return this.rdfModel.getDeliverables().getModels();case t.PARENT_HAS_SWYM_COMMUNITY:return n.getDisplayLabelForCommunity(this.rdfModel.get(t.PARENT_HAS_SWYM_COMMUNITY));case"isWedo":return this.rdfModel.isWedo();case"icon":return this.rdfModel.getIconURL();case"dsxplan:hasPriority":return this.rdfModel.getPriorityValueNLSString();case"hasChildren":return s.hasSubtasks(this.rdfModel)}return e.prototype.getTreeNodeValueForRdfAttribute.apply(this,arguments)},i.prototype.hasChild=function(){return s.hasSubtasks(this.rdfModel)},i.prototype.addRdfModelListeners=function(){e.prototype.addRdfModelListeners.apply(this,arguments),this.listener.listenTo(this.rdfModel.getSubtasks(),"onAdd",(e=>this.addRdfChild(e))),this.listener.listenTo(this.rdfModel.getSubtasks(),"onRemove",(e=>this.removeRdfChild(e))),this.listener.listenTo(this.rdfModel.getSubtasks(),"onChange:dsplan:sequenceOrder",(()=>this.sortChildren())),this.listener.listenTo(this.rdfModel,`onChange:${t.DSLC_DURATION_MIN}`,(()=>this.onRdfModelAttributeChange(t.DSLC_DURATION_ESTIMATED))),this.listener.listenTo(this.rdfModel,`onChange:${t.DSLC_DURATION_MAX}`,(()=>this.onRdfModelAttributeChange(t.DSLC_DURATION_ESTIMATED))),this.listener.listenTo(this.rdfModel,`onChange:${t.DSLC_STARTDATE_ATTR}`,(()=>this.onRdfModelAttributeChange(t.DSLC_DURATION_ESTIMATED))),this.listener.listenTo(this.rdfModel,`onChange:${t.DSLC_ENDDATE_ATTR}`,(()=>this.onRdfModelAttributeChange(t.DSLC_DURATION_ESTIMATED)))},i.prototype.addExistingRdfChildren=function(){this.rdfModel.getSubtasks().forEach((e=>this.addRdfChild(e)))},i})),define("DS/E6WCommonApps/TreeDocument/BacklogTaskTreeNodeModel",["DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/TaskTreeNodeModel","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n){"use strict";t=t||require("DS/E6WCommonApps/Models/TaskTreeNodeModel");const s=function(){t.apply(this,arguments),this._updateWorkContextListener()};return(s.prototype=Object.create(t.prototype,{constructor:{value:s}})).getTreeNodeValueForRdfAttribute=function(s){const i=this.rdfModel.get(e.WORK_CONTEXT_ATTR);if(s===e.DSLC_TITLE_ATTR){let e=this.rdfModel.get("title");return i&&(i.hasViewAccess()&&i.get("title")?(e=i.get("title"),i.get("dsxplan:hasContributingElements")&&i.get("dsxplan:hasContributingElements").length>1&&(e+=` (${this.rdfModel.get("title")})`)):i.hasViewAccess()||(e=`${o="E6WCommonApps.Label.NoAccess",n.get(o)} (${this.rdfModel.get("title")})`)),e}if("icon"===s&&i){if(!i.hasViewAccess())return require.toUrl("DS/RDFFoundation/assets/img/NoAccess.png");if(i.get("image"))return i.get("image")}var o;return t.prototype.getTreeNodeValueForRdfAttribute.apply(this,arguments)},s.prototype.addRdfModelListeners=function(){t.prototype.addRdfModelListeners.apply(this,arguments),this.listener.listenTo(this.rdfModel,`onChange:${e.WORK_CONTEXT_ATTR}`,(()=>{this._updateWorkContextListener(),this.onRdfModelAttributeChange(e.DSLC_TITLE_ATTR),this.onRdfModelAttributeChange("icon")}))},s.prototype._updateWorkContextListener=function(){const t=this.rdfModel.previous(e.WORK_CONTEXT_ATTR);t&&(this.listener.stopListening(t),this.listener.stopListening(t.getCollectionAttribute("dsxplan:hasContributingElements")),this.onRdfModelAttributeChange("icon")),this.rdfModel.get(e.WORK_CONTEXT_ATTR)&&(this.listener.listenTo(this.rdfModel.get(e.WORK_CONTEXT_ATTR).getCollectionAttribute("dsxplan:hasContributingElements"),{onAdd:()=>this.onRdfModelAttributeChange(e.DSLC_TITLE_ATTR),onRemove:()=>this.onRdfModelAttributeChange(e.DSLC_TITLE_ATTR)}),this.listener.listenTo(this.rdfModel.get(e.WORK_CONTEXT_ATTR),{"onChange:image":()=>this.onRdfModelAttributeChange("icon"),onModelAccessChanged:()=>{this.onRdfModelAttributeChange(e.DSLC_TITLE_ATTR),this.onRdfModelAttributeChange("icon")}}))},s.prototype.addChild=Function.prototype,s})),define("DS/E6WCommonApps/Models/WorkscopeTreeNodeModel",["DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/TreeDocument/E6WTreeNodeModel"],(function(e,t){"use strict";const n=function(e){const n={...e},s=e.grid&&e.grid.correspondingModel;n.children=s&&s.isExpandable()?[]:void 0,this._uwaClassName="WorkscopeTreeNodeModel",t.call(this,n)};return(n.prototype=Object.create(t.prototype,{constructor:{value:n}})).addRdfModelListeners=function(){t.prototype.addRdfModelListeners.apply(this,arguments),[this.rdfModel.getTasks(),this.rdfModel.getWorkscopes(),this.rdfModel.getReferenceWorkscopes()].forEach((e=>{this.listener.listenTo(e,"onAdd",(e=>this.addRdfChild(e))),this.listener.listenTo(e,"onRemove",(e=>this.removeRdfChild(e))),this.listener.listenTo(e,"onChange:dsplan:sequenceOrder",(()=>this.sortChildren()))})),this.listener.listenTo(this.rdfModel,"onChange:dsplan:referenceConfig",(()=>{try{var e=JSON.parse(this.rdfModel.get("dsplan:referenceConfig")||{});this.getTreeDocument().prepareUpdate();for(const t in e)if(Object.hasOwn(e,t)){const n=this.getChildren()?.find((e=>e.rdfModel.id));n&&n.setAttribute("sequenceOrder",e[t])}this.sortChildren(),this.getTreeDocument().pushUpdate()}catch(e){console.error(e)}}));const e=()=>{this._milestoneChangeTimeout||(this._milestoneChangeTimeout=setTimeout((()=>{this._milestoneChangeTimeout=void 0,this.getModelEvents().publish({event:"onGateOrMilestoneChanged",data:this})}),0))};[this.rdfModel.getMilestones(),this.rdfModel.getGates()].forEach((t=>{this.listener.listenTo(t,{onAdd:e,onRemove:e})}))},n.prototype.hasChild=function(){var e=this.rdfModel.hasTasks()&&this.rdfModel.getTasks().length,t=this.rdfModel.getReferenceWorkscopes()&&this.rdfModel.getReferenceWorkscopes().length,n=this.rdfModel.hasChildWorkscopes();return!!(e||t||n||this.options.grid.hasChildren)},n.prototype._addChild=function(e,n,s){const i={...e||{}},o={...s||{}},a=this.rdfModel.getReferenceWorkscopes().contains(e.rdfModel);if(i.grid={...i.grid,isReferenceProject:a,sequenceOrder:a?this.rdfModel.getReferenceSequenceOrder(e.rdfModel):i.grid.sequenceOrder},o.allowDuplicates=a,!(a&&this.getChildren()&&this.getChildren().find((t=>t.rdfModel.id===e.rdfModel.id))))return t.prototype._addChild.call(this,i,n,o)},n.prototype.getTreeNodeValueForRdfAttribute=function(n){if(n===e.SEQUENCE_ORDER_ATTR)if(this.options&&this.getAttributeValue("isReferenceProject"))return this.getParent().rdfModel.getReferenceSequenceOrder(this.rdfModel);return t.prototype.getTreeNodeValueForRdfAttribute.apply(this,arguments)},n.prototype.addExistingRdfChildren=function(){this.rdfModel.getTasks().forEach((e=>this.addRdfChild(e))),this.rdfModel.getWorkscopes().forEach((e=>this.addRdfChild(e))),this.rdfModel.getReferenceWorkscopes().forEach((e=>this.addRdfChild(e)))},n.prototype.destroy=function(){this._milestoneChangeTimeout&&clearTimeout(this._milestoneChangeTimeout),this._milestoneChangeTimeout=void 0,t.prototype.destroy.call(this,arguments)},n})),define("DS/E6WCommonApps/TreeDocument/WorkscopeTreeNodeModelWithMilestones",["DS/E6WCommonApps/Models/WorkscopeTreeNodeModel"],(function(e){"use strict";const t=function(){this._uwaClassName="WorkscopeTreeNodeModelWithMilestones",e.apply(this,arguments)};return(t.prototype=Object.create(e.prototype,{constructor:{value:t}})).addRdfModelListeners=function(){e.prototype.addRdfModelListeners.apply(this,arguments),[this.rdfModel.getMilestones(),this.rdfModel.getGates(),this.rdfModel.getShadowMilestones(),this.rdfModel.getShadowGates()].forEach((e=>{this.listener.listenTo(e,"onAdd",(e=>this.addRdfChild(e))),this.listener.listenTo(e,"onRemove",(e=>this.removeRdfChild(e)))}))},t.prototype.addExistingRdfChildren=function(){e.prototype.addExistingRdfChildren.apply(this,arguments),this.rdfModel.getMilestones().forEach((e=>this.addRdfChild(e))),this.rdfModel.getGates().forEach((e=>this.addRdfChild(e))),this.rdfModel.getShadowMilestones().forEach((e=>this.addRdfChild(e))),this.rdfModel.getShadowGates().forEach((e=>this.addRdfChild(e)))},t})),define("DS/E6WCommonApps/Models/XPPModel",["UWA/Core","DS/E6WCommonApps/Utils/ScenariosUtils","DS/E6WCommonApps/SmartSchedulerUtils","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/Models/NoAccessModel","DS/RDFFoundation/Models/RDFFoundationConstants","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper"],(function(e,t,n,s,i,o,a,r){"use strict";var l=s.extend({_uwaClassName:"XPPModel",sourceName:"3dplan",_propertyDictionary:{richTextDescription:{volatility:!0},_xplanSubscribed:{volatility:!0},"dsxplan:jsType":{volatility:!0}},getTransferObject:function(t){var n=e.clone(t||{},!1);return n.i3dx=r.i3dx(this),this._parent(n)},get:function(e){if(this._fieldBeingFetched=this._fieldBeingFetched||{},this._fieldFetched=this._fieldFetched||{},this.fetching&&this._fieldBeingFetched[e])return{fetching:!0};switch(e){case"richTextDescription":if(this._fieldFetched[e]&&this.get("dsplan:RichTextField")===this._fieldFetched[e].identifier)return this._fieldFetched[e].value;var t=this.get("dsplan:RichTextField");if(t)return this.fetching=!0,this._fieldBeingFetched[e]=!0,a.downloadFCSFile(t,{onComplete:n=>{this.fetchComplete(e,"richTextDescription",n,{identifier:t}),this.listenTo(this,"onChange:dsplan:RichTextField",(function(){this.dispatchEvent("onChange:richTextDescription",[this]),this.set("richTextDescription",null)}))},onFailure:()=>{this.fetching=!1,this.set(e,null),this._fieldFetched.richTextDescription={value:null,identifier:t},delete this._fieldBeingFetched[e],this.set("dsplan:RichTextField",null),this.dispatchEvent("onChange:richTextDescription",[null])}}),{fetching:!0};break;case"_xplanSubscribed":{const t=this._parent.apply(this,arguments);return null==t&&(this.fetching=!0,this._fieldBeingFetched[e]=!0,setTimeout((()=>{a.request(a.expandUrl("invoke/dsplan:isUserSubscribingNotif"),{method:"POST",type:"json",data:JSON.stringify([this.get("@id")]),onComplete:t=>{this.fetchComplete(e,"_xplanSubscribed",t["@value"])}})}),0)),t}case"state":var n=this.get("dsxplan:hasMaturity"),s=n&&(n["@id"]||n.get&&n.get("@id"));return s&&s.substring(8)}return this._parent.apply(this,arguments)},parse:function(e,s){return e&&e["@value"]&&(e=r.wrapError((()=>{const t=JSON.parse(e["@value"]);return t.isNewFromExperiment?t:t.newObjectId?{"@id":t.newObjectId,"@href":a.hrefFromId(t.newObjectId)}:void(t.experimentJSON?n.getCurrentModel().setScenarioJSON(t.experimentJSON):t.rootProjectId&&n.getCurrentModel().setScenarioJSON(t))}),(()=>{}))),t&&t.inScenario()&&(e=this.parseScenario(e)),this._parent(e,s)},_prepareOptionsForScenario:function(e){return t&&t.inScenario()&&(e.activeExperimentId=t.getScenarioId()),e},_prepareDataForCreate:function(){let e=this._parent.apply(this,arguments),t=e[2]||{},n=this._prepareOptionsForScenario(t);return Object.keys(n).length>0&&e.push(this._prepareOptionsForScenario(t)),e},_prepareOptionsForPatch:function(){let e=this._parent.apply(this,arguments);return e=this._prepareOptionsForScenario(e),e},_prepareDataForDelete:function(){let e=this._parent.apply(this,arguments),t=e[2]||{};return e.push(this._prepareOptionsForScenario(t)),e},fetchComplete:function(e,t,n,s){this.fetching=!1;var i={value:n};s&&s.identifier&&(i={value:n,identifier:s.identifier}),this._fieldFetched[t]=i,delete this._fieldBeingFetched[e],this.set(t,n),s&&s.onlyValue?this.dispatchEvent("onChange:"+t,[n]):this.dispatchEvent("onChange:"+t,[this])},toJSON:function(){return this.hasViewAccess()?this._parent.apply(this,arguments):(new i).toJSON()},fetch:function(e){return t&&t.isNewInScenario(this.id)?(e&&e.onComplete&&e.onComplete(),void this.dispatchEvent("onSync")):this._parent.apply(this,arguments)},parseScenario:function(e){const n=e&&e["@id"]||this.id;e=e?this._mapDslcAttributes(e):{};const i=t=>e[t]?t:e[this.dslcMapping[t]]?this.dslcMapping[t]:this.dslcMapping[t]||t;const o=(e,t)=>{const i=[];l[n].add[t].forEach((e=>{if(l[e]&&l[e].isNewFromExperiment)a.getObjectById(e)&&i.push(a.getObjectById(e));else if(l[e]){let t=s.mergeOrCreateObject({"@id":e,"dsxplan:jsType":l[e]["dsplan:jsType"]});t.fetch(),i.push(t)}else a.getObjectById(e)&&i.push(a.getObjectById(e))})),this.getCollectionAttribute(e).add(i,{fromServer:!0,forceDispatchEvent:!0})},r=(e,t)=>{const s=l[n].remove[t];this.get(e).remove(s,{fromServer:!0})};let l=t&&t.getScenarioJSON();if(l){if(l.objectIds&&l.objectIds.includes(n))try{Object.keys(l[n].modify).forEach((t=>function(t,s){l[n].modify[s]?e[t]=l[n].modify[s]:e[t]=void 0,t.includes("scheduleCalendar")&&(e[t]["dsxplan:jsType"]="dscom:ComponentProxy")}(this.dslcMapping[t]||t,t))),setTimeout((()=>{Object.keys(l[n].add).forEach((e=>o(i(e),e))),Object.keys(l[n].remove).forEach((e=>r(i(e),e)))}),0)}catch(e){}this.removeModifiedInverseAttrs(e)}return e},removeModifiedInverseAttrs:function(e){const n=t.getScenarioJSON(),s=e&&e["@id"]||this.id;n&&n._removedRelationships&&n._removedRelationships[s]&&Object.keys(e).forEach((t=>{const i=this.getPropertyInverse(t)&&this.getPropertyInverse(t).name;n._removedRelationships[s][i]&&delete e[t]}))},getStartingFacet:function(){return"tasks"}});return l})),define("DS/E6WCommonApps/TreeDocument/TreeModelMixin",["DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/TreeDocument/TreeNodeUtil","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/TreeDocument/E6WTreeNodeModel"],(function(e,t,n,s,i){"use strict";return{getTreeNodeModelData:function(){const e=this.createNodeData();return{label:e.title,grid:e,icons:e.icons,children:e.hasChildren?[]:null,rdfModel:this}},createNodeData:function(){let i;return i=this.get(s.OWNER_ATTR)instanceof t?this.get(s.OWNER_ATTR):e.getObjectById(this.get(s.OWNER_ATTR)),{"@id":this.id,tree:this.get("title"),uniqueObjectId:this.get(s.UNIQUE_OBJECT_ID_ATTR),[n.RDF_MODEL]:this,sequenceOrder:this.get(s.SEQUENCE_ORDER_ATTR),"dsxplan:jsType":this.get("dsxplan:jsType"),maturity:n.getDisplayLabelForState(this.get("state")),priority:n.getDisplayLabelForPriority(this.get("dsplan:hasPriority")),owner:n.getOwnerForRow(this,i),assignees:n.getAssigneesOnUpdate(this,this.get(s.ASSIGNEE_ATTR)),icon:this.get("image"),correspondingModel:this}},getTreeNodeModel:function(){return this._treeNodeModel?this._treeNodeModel.show():this._treeNodeModel=new i({grid:{correspondingModel:this}}),this._treeNodeModel}}})),define("DS/E6WCommonApps/Agile/AgileProjectMixin",["UWA/Core","DS/RDFFoundation/ProjectTypeUtils","DS/RDFFoundation/FederatedSearchUtil","DS/RDFFoundation/Models/ComponentProxyModel","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/Search","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/AgileProjectUtils","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l,d,c){"use strict";const p=d.PRE_LOAD_WORK_CONTEXTS,u=d.POST_LOAD_WORK_CONTEXTS,h={isAgile:function(){return(this.get(d.PROJECT_TYPE)||this.get(d.JS_TYPE_ATTR))===t.AGILE_PROJECT},getOrCreateBacklogTaskForWorkContext:function(t,n,s){const i=e.clone(s||{},!1);this.loadManualWorkContexts({onComplete:()=>{t.getCollectionAttribute("dsxplan:hasContributingElements").find((e=>e.get("dsxplan:backlogParent")===this))||(t.save(void 0,{ajax:n.ajax}),l.addTaskForWorkContext(this,t,{isToBacklog:!0,silent:!0})),i.onComplete&&i.onComplete()},onFailure:i.onFailure})},loadWorkContexts:function(t){const i=e.clone(t||{},!1);if(this._setupListeners(),this.dispatchEvent(p),i.onComplete=e=>{this.dispatchEvent(u,[e]),t&&t.onComplete&&t.onComplete(e)},i.onFailure=()=>{this.dispatchEvent(u,[]),t&&t.onFailure&&t.onFailure()},this.isAutomaticBacklog())if(this.useCachedBacklog)i.onComplete&&i.onComplete(this._cachedBacklog);else{const e=JSON.parse(this.get(d.BACKLOG_QUERY)).selected_query;n.sendRequest({nresults:100,query:e,onComplete:e=>{const t=(e=e.results||[]).map((e=>s.getOrCreateFromFedSearchResult(e))).filter((e=>e));l.isExistingWorkContext({projectId:this.id,contextIds:t.map((e=>e.id)),excludeBacklog:!0,onComplete:e=>{const n=t.filter((t=>!e[t.id]));this._cachedBacklog=n,i.onComplete&&i.onComplete(n)},onFailure:()=>i.onComplete&&i.onComplete(t)})},onFailure:i.onFailure,sources:l.getContextSearchSources(),specific_source_parameter:o.computeSourceParameters({searchSourceTypes:l.contextSearchSourceTypes},e),with_synthesis_attribute:!0})}else this.loadManualWorkContexts(i)},_scheduleLoadWorkContexts:function(){this._loadWorkContextTimeout=this._loadWorkContextTimeout||setTimeout((()=>{this._loadWorkContextTimeout=void 0,this.loadWorkContexts()}),0)},_setupListeners:function(){if(this._listenersInit)return;const e={[`onChange:${d.BACKLOG_SETTING}`]:this._scheduleLoadWorkContexts,[`onChange:${d.BACKLOG_QUERY}`]:this._scheduleLoadWorkContexts};this.listenTo(this,e),this.listenTo(this.getBacklogTasks(),"onAdd",this._loadWorkContextsIfAutomaticBacklog),this._listenersInit=!0},_loadWorkContextsIfAutomaticBacklog:function(){this.isAutomaticBacklog()&&this.loadWorkContexts()},loadManualWorkContexts:function(t){const n=e.clone(t||{},!1);this.fetch({mask:this.isAgile()?"dsplan:MVMask.Project.BacklogTasks":"dsplan:MVMask.Project.IterationTasks",onlyIfNeeded:!0,onComplete:()=>{if(n.onComplete){const e={};(this.isAgile()?this.getBacklogTasks():this.getTasks()).forEach((t=>{const n=t.get(d.WORK_CONTEXT_ATTR);n&&(e[n.id]=n)})),n.onComplete(Object.values(e))}},onFailure:n.onFailure,ajax:n.ajax})},isAutomaticBacklog:function(){return this.get(d.BACKLOG_SETTING)===d.BACKLOG_AUTOMATIC},_getOrCreateKanbanBoard:function(e){const t={serviceId:"3dlifecycle","dscom:ServiceHosting":"3dlifecycle",id:`${e.id}`,"@id":`dscom:3dlifecycle_${e.id}`,image:`${a.getServiceUrl("3dlifecycle",!1)}/snresources/images/icons/large/KanbanBoard128x128.png?tenant=${a.getTenant()}`,title:e.title,type:"Kanban"};return i.getObjectById(s.computeURI(t))||new s(t,{noFetch:!0})},addKanbanBoard:function(e){this.getCollectionAttribute(d.ASSOCIATED_KANBANS).add(this._getOrCreateKanbanBoard(e),{dontRegisterChange:!0}).dispatchEvent("onChange")},loadAssociatedKanbanBoards:function(){const e=a.getServiceUrl("3dlifecycle",!0);this.isAgile()&&e&&i.request(`${e}/resources/v1/modeler/kanban/boards/searchByProjectId?tenant=${a.getTenant()}&projectId=${i.shortToLongURI(this.id)}`,{type:"json",headers:{"Content-Type":"application/json",Securitycontext:"ctx::Kanban User.Company Name.Kanban_PRJ"},onComplete:e=>{if("success"===e.status){const t=e.results.filter((e=>e.id)).map(this._getOrCreateKanbanBoard);this.getCollectionAttribute(d.ASSOCIATED_KANBANS).reset(t),t[0]&&t[0].dispatchEvent("onChange")}},onFailure:()=>{return r.displayError(((t=e="E6WCommonApps.Label.LoadKanbanBoardsFailed")===e&&(t=c.get(e)),t));var e,t}})},LOAD_WORK_CONTEXT_TIMEOUT:0};return h})),define("DS/E6WCommonApps/Views/HistoryGridViewConfig",["DS/E6WCommonApps/TreeDocument/TreeNodeUtil","DS/E6WCommonUI/UIHelper","DS/Controls/TooltipModel","DS/RDFFoundation/Models/ResultModel","DS/Handlebars/Handlebars4","DS/E6WCommonApps/ScheduleConstants","i18n!DS/E6WCommonApps/assets/nls/CollaborativeTasksNLS","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","text!DS/E6WCommonApps/assets/templates/historyDetailsField.html.handlebars"],(function(e,t,n,s,i,o,a,r,l){"use strict";var d=function(e){var t=a.get(e);return t===e&&(t=r.get(e)),t},c=i.compile(l),p={auditDetails:"auditDetails"},u={};u[o.CREATED]="plus fonticon fonticon-plus",u[o.ADDED]="plus fonticon fonticon-plus",u[o.RESTORED]="plus fonticon fonticon-plus",u[o.REMOVED]="remove fonticon fonticon-remove",u[o.DELETED]="trash fonticon fonticon-trash",u[o.MODIFIED]="pencil fonticon fonticon-pencil",u[o.TRANSITIONED]="scene-transition fonticon fonticon-scene-transition";var h=function(t,s){var i=t.getAttributeValue(e.COLUMN_DATA_INDICES.auditDetails),o=t.getAttributeValue(e.COLUMN_DATA_INDICES.auditModifiedBy),a=t.getAttributeValue(e.COLUMN_DATA_INDICES.auditAction),r=this.reuseCellContent(p.auditDetails);r.empty();var l={};if(o&&(l.fullName=o.fullName,l.image=window.enoviaServer.swym+"/api/user/getpicture/login/"+o.accountName),a&&(l.actionIcon=u[a.nonTranslated],l.actionIconTooltip=a.translated),i){let e=i.historyView._generateHistoryDescription(i.changeObj,i.options);l.description=e}r.setHTML(c(l)),s._setReusableContent(r),s.tooltipInfos=new n({title:`${l.fullName} ${l.actionIconTooltip}`,shortHelp:l.description})};return{columns:[{text:d("E6WCommonApps.Label.AuditHistoryDate"),dataIndex:"tree",editableFlag:!1,width:150,visibleFlag:!0,className:"grid-title-cell",getCellSemantics:function(){return{icon:"bpa fonticon fonticon-bpa "}},getCellValue:function(e){if(e.nodeModel){var n=e.nodeModel.getAttributeValue("date"),s=new Date(n);return e.nodeModel.isRoot()?t.DATE_FORMAT.format(s):t.TIME_SECONDS_FORMAT.format(s)}},compareFunction:function(e,t){return new Date(e)-new Date(t)}},{text:d("E6WCommonApps.Label.AuditHistoryObject"),dataIndex:e.COLUMN_DATA_INDICES.auditObjectName,width:150,getCellValue:function(t){if(t&&t.nodeModel){var n=t.nodeModel,i=n.getAttributeValue(e.COLUMN_DATA_INDICES.auditObjectName),o=n.getAttributeValue(e.COLUMN_DATA_INDICES.auditDetails);if(i&&o){var a="dsxplan:label",r=o.historyView,l=o.changeObj,d=o.options,c=l&&l.changedProperty,p=null;if(r&&"function"==typeof r._fetchModelData&&(p=r._fetchModelData(i,a,c,"dsplan:MVMask.History.Basic",s,d)),p){var u=p.get(a),h=p.get("dskern:nlsLabel");return u||h||i}return i}}}},{text:d("E6WCommonApps.Label.AuditHistoryDetails"),dataIndex:e.COLUMN_DATA_INDICES.auditDetails,sortableFlag:!1,className:"grid-cell-audit-description",autoRowHeightFlag:!0,customContentId:p.auditDetails,onCellRequest:function(e){e.nodeModel&&e.cellView&&h.call(this,e.nodeModel,e.cellView)}}],reusableComponentIDs:p,lengthOfEachCharacter:10}})),define("DS/E6WCommonApps/Resource/ResourceEventsMixin",["DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Utils/RapidUtils","DS/E6WCommonApps/Preferences"],(function(e,t,n){"use strict";const s={setup:function(){this._parent.apply(this,arguments),this.internalTasksMap={}},getTasksForResource:function(){return this.getCollectionAttribute("dsplan:hasTasksForResource")},fetchForResourceFacet:function(s){this.fetching=!0;let i=s&&s.batchGenerator;this.getTeamMembers(),this.getTeamMembers().fetch({ajax:i.ajax}),i.ajax(e.expandUrl("invoke/dsxplan:getResourceLoading?$mask=dsplan:MVMask.Task.Resource"),{method:"POST",headers:{"Content-Type":"application/json"},type:"json",data:JSON.stringify([this.id,{includeSubProjects:n.get(n.RESOURCE_INCLUDE_SUBPROJECTS)}]),onComplete:e=>{this.internalTasksMap={},this.getTasksForResource().reset(e,{parse:!0});let n=[];this.getTasksForResource().forEach((e=>{this.internalTasksMap[e.id]=!0,e.hasSubtasks()||n.push(e)})),this.unassignedPlaceholderModel.getCollectionAttribute("dsplan:hasAssignedTasks").reset(this.getUnassignedTasks()),this.fetching=!1,window.requestAnimationFrame((()=>{let e=n.concat(this.getTaskAssigneesForResource()).concat(this);t.dispatcher.dispatchEvent("resetResourceTagger",[e],!0)}))},onFailure:()=>this.fetching=!1}),i.sendBatch()}};return s})),define("DS/E6WCommonApps/Views/ObjectIDPanelUtil",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/TreeDocument/TreeNodeUtil","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s){"use strict";var i=s.get.bind(s);return{getObjectIDFieldConfig:function(e){return{readWrite:e,name:t.UNIQUE_OBJECT_ID_ATTR,label:i("E6WCommonApps.Label.UniqueObjectId"),type:"text",maxLength:128,validate:!0,customTooltips:[{iconClass:"info",tooltipTitle:i("E6WCommonApps.Label.UniqueObjectId"),tooltipBody:i("E6WCommonApps.Label.Tooltip.UniqueObjectId")}],neverEditable:!0}},getObjectIDFieldForTableConfig:function(e){return{text:i("E6WCommonApps.Label.UniqueObjectId"),dataIndex:n.COLUMN_DATA_INDICES.uniqueObjectId,typeRepresentation:"string",editableFlag:e,sortableFlag:!1,visibleFlag:!0,className:"grid-title-cell",compareFunction:function(e,t){let n=e<t?-1:1;try{if(!e)return-1;if(!t)return 1;const n=e.indexOf("-"),s=t.indexOf("-"),i=e.substring(0,n),o=t.substring(0,s);return i===o?parseInt(e.substring(n+1))-parseInt(t.substring(s+1)):i-o}catch(e){console.error(e)}return n}}}}})),define("DS/E6WCommonApps/Models/IteropTaskModel",["UWA/Core","UWA/Class/Model","DS/RDFFoundation/RDFUtils","DS/TreeModel/TreeNodeModel","DS/E6WCommonApps/TreeDocument/TreeNodeUtil","DS/E6WCommonUI/UIHelper","UWA/Ajax","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/TaskModelMixin"],(function(e,t,n,s,i,o,a,r,l){"use strict";var d={3:"Low",2:"Medium",1:"High",0:"Urgent"},c=t.extend({_uwaClassName:"IteropModel",getParentAsLabel:function(){},getPriorityValue:function(e){return d[e]},isRDFTask:function(){return!1},getObjectType:function(){return"Task"},dataForRendering:function(e){return e&&(e.dataForRendering=!0),this.toJSON.apply(this,arguments)},hasFetchedAccessData:function(){return!0},canAssignToSelf:function(){return!0},isProjectTask:function(){return!1},subscriptionsEnabled:function(){return!1},isComplete:function(){return!1},hasExternalPanel:function(){return!1},isRouteTask:function(){return!1},canDelete:function(){return!1},isLate:function(){return!1},isAtRisk:function(){return!1},isReadyToStart:function(){return!1},isLeanTask:function(){return!1},isIteropTask:function(){return!0},getCustomFields:function(){},getState:function(){return this.get("state")},getStartDate:function(){return this._startDate},isStarted:function(){var e=this.get("dscom:hasMaturity"),t=e&&(e.id||e["@id"]);return"dsxplan:Done"===t||"dsxplan:InProgress"===t},toJSON:function(e){var t=this._parent.apply(this,arguments);e&&e.dataForRendering&&(t.card_icon=this.get("card_icon"),t.date=new Date(this.get("creation")),void 0!==t.percentComplete&&(t.percentComplete=parseInt(t.percentComplete).toString()));for(var n=Object.keys(t),s=n.length,i=0;i<s;i++){var a=n[i],r=t[a];r instanceof Date&&(t[a]=r=o.dateForJSON(r,"UTC",l.dateHelper,e))}return t},set:function(){var t=o.setHelper.apply(this,arguments),n=e.clone(t.attrs||{},!1),s=t.options;return this._parent(n,s)},get:function(e){switch(e){case r.DESCRIPTION_ATTR:return i.getDisplayLabelForDescription(this.get("description"));case"card_icon":return this.getFonticonValue();case"endDate":return this.get("date")}return this._parent.apply(this,arguments)},getDeliverables:function(){return[]},getReferences:function(){return[]},getFonticonValue:function(){return require.toUrl("DS/E6WCommonApps/assets/img/I_BusinessProcessTask_16.png")},createNodeData:function(){var e={title:this.get("title"),description:i.getDisplayLabelForDescription(this.get("description")),maturity:i.getDisplayLabelForState(this.get("state")),priority:this.get("priority"),attachments:this.getReferences(),deliverables:this.getDeliverables(),created:this.get("creation"),[i.RDF_MODEL]:this};return e.icon=this.getFonticonValue(),e},getTreeNodeModel:function(){if(this._treeNodeModel)this._treeNodeModel.show();else{var e=this.createNodeData();this._treeNodeModel=new s({label:e.title,grid:e}),i.addListenersOnTreeNode(this._treeNodeModel)}return this._treeNodeModel},markDeliverablesOn3DNavigate:Function.prototype});return c})),define("DS/E6WCommonApps/CustomAttributeMixin",["UWA/Core","UWA/Class/Listener","UWA/Element","UWA/Class/Events","DS/RDFFoundation/CustomExtensionUtils","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/TreeDocument/TreeNodeUtil"],(function(e,t,n,s,i,o,a){"use strict";var r=[];const l={};var d,c={"xsd:string":"string","dsbase:Hyperlink":"url","foaf:Person":"user"};return{fetchCustomAttributes:function(e){var t=this;return new Promise(((n,s)=>{o.request(o.expandUrl("/invoke/dsxplan:getCustomAttributesInBulk"),{method:"POST",type:"json",data:JSON.stringify([e]),onComplete:e=>{var s=t,r=t.treeDocument;r.prepareUpdate();for(var d=0;d<e.ObjectsWithCustomAttributes.member.length;d++){var p=Object.keys(e.ObjectsWithCustomAttributes.member[d]);Object.values(e.ObjectsWithCustomAttributes.member[d]).forEach((function(e){const t=e.extension.columnValue;l[t]=l[t]||{},Object.entries(e).forEach((([e,n])=>{var r=n.columnType;a.RDF_TO_TREE_NODE[e]=e;var d=o.getObjectById(p),u=n.isList,h=n.columnValue;if(u&&n.columnValue.member&&(h=n.columnValue.member),"extension"!==e&&d.set(e,h,{dontRegisterChange:!0}),"extension"!==e&&!s.getColumnOrGroup(e)){var m=c[r]||"string",T={text:n.columnLabel,dataIndex:e,typeRepresentation:m,editableFlag:!1,className:a.COMMON_CSS_CLASS_FOR_GRID_COLUMNS,minWidth:a.MIN_WIDTH_OF_EACH_COLUMN,sortableFlag:!1,editionPolicy:"EditionOnDoubleClick",visibleFlag:!1};"url"===m?T.getCellValue=function(t){if(t.nodeModel&&t.nodeModel.getAttributeValue(e))return{label:t.nodeModel.getAttributeValue(e).label,url:t.nodeModel.getAttributeValue(e).url}}:"user"===m&&(T.getCellValue=function(t){if(t.nodeModel&&t.nodeModel.getAttributeValue(e))return{label:t.nodeModel.getAttributeValue(e).fullName}}),u&&(T.columngetCellSemantics=function(e){return{allowMultipleValuesFlag:!0}}),s&&"TasksTableView"===s.identifier&&(T.sortableFlag=!0),s.addColumnOrGroup(T),i.customAttrCols.push(T),l[t][e]=!0}}))}))}r.pushUpdate(),n()},onFailure:e=>{s(e)}})}))},processQueue:async function(){clearTimeout(d);for(;r.length>0;){const e=r.splice(0,250).map((function(e){return"<"+e+">"}));await this.fetchCustomAttributes(e)}d=r.length>0?setTimeout(this.processQueue.bind(this),500):null},startProcessing:function(){d||(d=setTimeout(this.processQueue.bind(this),500))},_addToQueue:function(t){var n=o.getObjectById(t);t&&!i.customAttrsMap[t]?(r.push(t),i.customAttrsMap[t]=!0):n&&setTimeout((()=>{var t=this.gridView||this.lTreeDocument&&this.lTreeDocument.gridView||this;const s=n.get("dsxplan:customExtensionName");if(s&&l[s]){Object.keys(l[s]).forEach((n=>{let s=i.customAttrCols.find((e=>e.dataIndex===n));var o=e.clone(s||{},!1);"TasksTableView"===t.identifier?o.sortableFlag=!0:o.sortableFlag=!1,t.getColumnOrGroup(o.dataIndex)||t.addColumnOrGroup(o)}))}}),0),this.startProcessing()}}})),define("DS/E6WCommonApps/Views/E6WDataGridView",["UWA/Core","UWA/Class/Listener","DS/DataGridView/DataGridView","DS/E6WCommonApps/CustomAttributeMixin","DS/E6WCommonApps/Preferences","DS/E6WCommonApps/TreeDocument/TreeNodeUtil"],(function(e,t,n,s,i,o){"use strict";const a=n.extend({init:function(e){var t=this;if(!e.identifier)throw new Error("identifier must be passed so that widget preferences can be used");this._parent({useWidgetPreferencesFlag:!0,...e}),this.getResuableComponentForAssignee(),this.getResuableComponentForDescription(),this.treeDocument.subscribe({event:"select"},(e=>{e.stopPropagation(),!this._doingDnD&&this.dispatchEvent("onSelect",[e.data.nodeModel.rdfModel])})),this.treeDocument.subscribe({event:"unselect"},(e=>{e.stopPropagation(),this.dispatchEvent("onUnselect",[e.data.nodeModel.rdfModel])})),this.getContent().classList.add("common-grid-view"),this.listenTo(i,`onChange:${i.HIDE_WEEKLABEL}`,(()=>{t.updateWeekNumberColumns()}))},_getReusableComponentBase:function(t,n){this.registerReusableCellContent({id:t,buildContent:function(){return e.createElement("div",{class:n})}})},_processDragAndDropCallbacks:function(e){"dragstart"===e.type?this._doingDnD=!0:"dragend"!==e.type&&"drop"!==e.type||(this._doingDnD=!1),this._parent.apply(this,arguments)},getResuableComponentForAssignee:function(){this._getReusableComponentBase("assigneesContent","grid-users-list")},getResuableComponentForDescription:function(){this._getReusableComponentBase("descriptionContent","grid-description-view")},initialize:function(){this._destroyed||this._parent.apply(this,arguments)},_initialize:function(){this._destroyed||this._parent.apply(this,arguments)},destroy:function(){this._destroyed=!0,this.stopListening(),this._parent.apply(this,arguments)},updateWeekNumberColumns:function(){this.columns&&this.columns.forEach((e=>{e.compareFunction===o.dateFieldsCompareFunc&&this.updateColumnView&&this.updateColumnView(e.dataIndex,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}))}});return a.implement(s),a.implement(t),a})),define("DS/E6WCommonApps/Models/MilestoneTreeNodeModel",["DS/E6WCommonApps/TreeDocument/E6WTreeNodeModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],(function(e,t){"use strict";const n=function(){this._uwaClassName="MilestoneTreeNodeModel",e.apply(this,arguments)};return(n.prototype=Object.create(e.prototype,{constructor:{value:n}})).getTreeNodeValueForRdfAttribute=function(n){return n===t.SUGGESTED_DATE_ATTR?this.rdfModel.getSuggestedDateWithWeekLabels():e.prototype.getTreeNodeValueForRdfAttribute.apply(this,arguments)},n.prototype.addRdfModelListeners=function(){e.prototype.addRdfModelListeners.apply(this,arguments),this.listener.listenTo(this.rdfModel,`onChange:${t.SUGGESTED_DATE_ATTR}`,(()=>this.onRdfModelAttributeChange(t.DSLC_DURATION_ESTIMATED)))},n})),define("DS/E6WCommonApps/MultiEdit/E6WMultiStartStopView",["DS/E6WCommonUI/MultiEdit/MultiStartStopView","DS/E6WCommonApps/MultiEdit/E6WMultiEditFieldView"],(function(e,t){return e.extend({_uwaClassName:"E6WMultiDetailsDisplayView",getMultiEditFieldView:function(e){return new t(e)}})})),define("DS/E6WCommonApps/Models/InvokeSolver",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Utils/ScenariosUtils","DS/E6WCommonUI/UIHelper"],(function(e,t,n,s){"use strict";var i=t.createRequestQueue(1);return i.solve=function(o,a,r){var l=o&&o.additionalElementsToSolve||[];a&&l.unshift(a);var d=o&&o.additionalParentElementsToSolve||[];r&&d.unshift(r);var c={};c[o&&o.listName||"ScheduleElementList"]=l,c.ParentScheduleElementList=d,n.inScenario()&&(c.experimentId=n.getScenarioId()),c=[c];var p=t.getPendingRequests(i),u=new Set;p.forEach((function(e){var t=JSON.parse(e.options.data)[0];t.ParentScheduleElementList&&t.ParentScheduleElementList.forEach((e=>u.add(e))),t.ProjectList&&t.ProjectList.forEach((e=>u.add(e)))}));var h=c[0],m=!1;if(h.ParentScheduleElementList)for(let e of h.ParentScheduleElementList)if(!u.has(e)){m=!0;break}if(h.ProjectList)for(let e of h.ProjectList)if(!u.has(e)){m=!0;break}if(m){var T=e.clone(o||{},!1);if(n&&n.inScenario()){var E=T.onComplete;T.onComplete=function(){return n.fetchScenarioJSON(),E&&E.apply(this,arguments)}}T.onFailure=function(){return widget.alerter?s.displayWarning(s.i18n("SolverFailed")):console.log("Solver failed. Likely no solution found"),o&&e.is(o.onFailure,"function")&&o.onFailure.apply(this,arguments)},T.queue=i,T.data=c,t.invokeAsLRT("dsmf:xplan.Scheduler.JSONScheduleObjects?$mask=dsplan:MVMask.ScheduleElements.Complex",T)}else o&&o.onCancel&&o.onCancel()},i})),define("DS/E6WCommonApps/Utils/RestrictUtils",["DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],(function(e,t){"use strict";const n=new Map([[t.COMMON_TASK_PARENT_ATTR,void 0],[t.WORKSCOPE_PARENT_ATTR,void 0],[t.MILESTONE_PARENT_ATTR,void 0],[t.GATE_PARENT_ATTR,void 0]]);return{isAttributeRestricted:function(n,s){if(n.isComplete()){const i=e.RESTRICTED_PROPERTIES[n.get("dsplan:jsType")];let o=s;if(t.dslcMapping[s]&&(o=t.dslcMapping[s]),Array.isArray(i)&&i.includes(o))return!0}return!1},shouldRestrictChildCreation:function(e,t){return!!e.isComplete()&&t.some((t=>!e.canModify(!1,t)))},updateRestrictedAttributes:function(e,t){e.map((e=>{if(n.has(e.name)){const n=t.get(e.name);n&&"function"==typeof n.canModify&&this.isAttributeRestricted(n,t.getParentInverseProperty())&&(e.readWrite=!1)}else"function"!=typeof t.canModify||t.canModify(void 0,e.name)||(e.readWrite=!1)}))}}})),define("DS/E6WCommonApps/Models/AccessModel",["UWA/Core","DS/RDFFoundation/Models/ComponentProxyModel","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Models/XPPModel","DS/E6WCommonApps/SmartSchedulerUtils","DS/E6WCommonApps/Utils/ScenariosUtils","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/TreeDocument/TreeModelMixin","DS/E6WCommonApps/Utils/RestrictUtils","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/UIHelper","DS/RDFFoundation/MemberUtils"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u){"use strict";var h,m="invoke/dsxplan:checkOperationOnResourceClone",T="dsaccess:Operation.Shareable.Modify",E="dsaccess:Operation.Shareable.Delete",g=s.extend({_uwaClassName:"AccessModel",sourceName:"3dplan",setup:function(){this._parent.apply(this,arguments),this.listenTo(this,`onChange:${r.ASSIGNEE_ATTR}`,(()=>{let e=this.isCurrentUserAssignee();(!this.canModify()&&e||this.canModify()&&!e)&&this.refreshAccessData()}))},isCurrentUserAssignee:function(){return this.get(r.ASSIGNEE_ATTR)&&this.get(r.ASSIGNEE_ATTR).some((e=>e.get("dsaccess:accountName")&&e.get("dsaccess:accountName").includes(c.getContextUser())))},parse:function(){var e=this._parent.apply(this,arguments);return this.handleRepositoryAttributes(e,"dsxplan:hasContentRepository"),this.handleRepositoryAttributes(e,"dsplan:hasCollaborativeSpace"),e},handleRepositoryAttributes:function(t,n){var s=t[n]||this.get(n);if(s&&e.is(s,"string")){var i=this._normalizedRepo(s);this._models[n]=i,t[n]=i}},get:function(e){return"canEdit"===e?this.canModify(!0):"deleteAccess"===e?this.canDelete(!0):"source"===e?"3dplan":this._parent.apply(this,arguments)},isDSLC:function(e){var t=e||this._attributes;return!(!t||!t["dsxplan:jsType"]&&!t["@type"])},_prepareDataForClone:function(e){let t=this._parent.apply(this,arguments),n=e.activityIdToSubscribe,s=e.idToDuplicate;return n&&t.push(n),s&&t.push(Boolean(this.get("dsplan:isTemplate")||e.parentModelIsTemplate)),t},syncCreate:function(e,t){this._parent.apply(this,arguments),this._syncCreateDSLC(e,t)},hasAccessFromParent:Function.prototype,getParentInverseProperty:Function.prototype,canModify:function(e,t){return!this.hasFetchedAccessData()&&e&&h.requestFetch(this),!!this._hasAccessInScenario()||!c.isXppViewer()&&((!t||!d.isAttributeRestricted(this,t))&&(!!this.hasAccessFromParent()||Boolean(this._accessModify)))},_hasAccessInScenario:function(){return o?.inScenario()&&o.getScenarioJSON()?.rootProjectId!==this.id},canDelete:function(e){return!!this._hasAccessInScenario()||!c.isXppViewer()&&(!this.hasFetchedAccessData()&&e&&h.requestFetch(this),Boolean(this._accessDelete))},canShare:function(){return!!this._hasAccessInScenario()||!c.isXppViewer()&&(p.isModelOwnerTheLoggedInUser(this)||Boolean(this._accessShare))},fetchAccess:function(e){o.inScenario()&&o.getScenarioJSON().rootProjectId!==this.id||this.hasFetchedAccessData()||h.requestFetch(this,e)},refreshAccessData:function(e){this.hasFetchedAccessData()&&h.requestFetch(this,e)},getAccessBatch:function(t){var n,s=this;(n=t&&t.batchBuilder?t.batchBuilder:a.getBatchGenerator({ignoreDictionary:t&&t.ignoreDictionary})).ajax(a.expandUrl(m),{method:"POST",onComplete:function(n){return s.setModifyAccess(n["@value"]),t&&e.is(t.onComplete,"function")&&t.onComplete.apply(this,arguments)},onFailure:function(){return t&&e.is(t.onFailure,"function")&&t.onFailure.apply(this,arguments)},onTimeout:t&&t.onFailure,headers:{"Content-Type":"application/json"},data:JSON.stringify([this.id,T]),type:"json"}),n.ajax(a.expandUrl(m),{method:"POST",onComplete:function(n){return s.setDeleteAccess(n["@value"]),t&&e.is(t.onComplete,"function")&&t.onComplete.apply(this,arguments)},onFailure:function(){return t&&e.is(t.onFailure,"function")&&t.onFailure.apply(this,arguments)},onTimeout:t&&t.onFailure,headers:{"Content-Type":"application/json"},data:JSON.stringify([this.id,E]),type:"json"});var i=n.sendBatch;return n.sendBatch=function(t){var n=e.clone(t||{},!1);s.fetchingAccessRights=!0,n.onComplete=function(){delete s.fetchingAccessRights,t&&t.onComplete&&t.onComplete()},n.onFailure=function(){delete s.fetchingAccessRights,t&&t.onFailure&&t.onFailure()},i.call(this,n)},n},hasFetchedAccessData:function(){return!!this._hasAccessInScenario()||(!!c.isXppViewer()||Boolean(void 0!==this._accessModify&&void 0!==this._accessDelete))},hasFetchedModifyData:function(){return Boolean(void 0!==this._accessModify)},setAccess:function(t,n){var s=e.clone(n||{},!1),i=s.silent;s.silent=!0;var o=this._accessModify,a=this._accessDelete,r=this._accessShare;this.setModifyAccess(t,s),this.setDeleteAccess(t,s),this.setShareAccess(t,s),i||(a!==t&&this.dispatchEvent("onDeleteAccessChanged"),o!==t&&this.dispatchEvent("onModifyAccessChanged",[this]),r!==t&&this.dispatchEvent("onShareAccessChanged"))},setModifyAccess:function(t,n){var s=e.clone(n||{},!1);this._accessModify!==t&&(this._accessModify=t,!s.silent&&this.dispatchEvent("onModifyAccessChanged",[this]))},setDeleteAccess:function(t,n){var s=e.clone(n||{},!1);this._accessDelete!==t&&(this._accessDelete=t,!s.silent&&this.dispatchEvent("onDeleteAccessChanged"))},setShareAccess:function(t,n){var s=e.clone(n||{},!1);this._accessShare!==t&&(this._accessShare=t,!s.silent&&this.dispatchEvent("onShareAccessChanged"))},clearAccess:function(e){this.setDeleteAccess(void 0,e),this.setModifyAccess(void 0,e),this.setShareAccess(void 0,e)},onShareNotification:function(e,t){var n,s=t&&t.agentList,i=!1,o=t&&Object.keys(t)[0];if(!s&&"dsplan:hasAssignee"===o){var r=t["dsplan:hasAssignee"]["@id"];s=[r],(n=a.getObjectById(r))&&"foaf:Group"===n.get("dsxplan:jsType")&&(i=!0)}(s=s.map((function(e){if(e)return a.removeBracketLongURI(e)})))&&(s.includes(u.addUUIDToURI(c.getContextUserUid()))||i)&&(this.refreshAccessData(),this.fetch({mask:"dsplan:MVMask.ScheduleElements.Basic",ajax:e.ajax,onComplete:function(e,t){t["dsxplan:jsType"]?"dsplan:Task"===t["dsxplan:jsType"]&&"dsplan:hasAssignee"===o&&e.unset("dsxplan:hasAssignee"):(e.dispatchEvent("liveUpdateAccessRevoked"),e.destroy({noServer:!0,fromNotification:!0}))},onFailure:function(e){e.dispatchEvent("liveUpdateAccessRevoked"),e.destroy({noServer:!0,fromNotification:!0})},onTimeout:function(){}}))},getRelatedModelCompactJson:function(e,n){return"dsxplan:hasContentRepository"===n&&e instanceof t?e.id:this._parent.apply(this,arguments)},currentUserIsLeader:function(){return this.canShare()},isComplete:function(){var e=this.get(r.STATE_ATTR);return window.enoviaServer&&window.enoviaServer.useFD01CodeFor3DPlan?"Done"===e:(e&&(e.id||e["@id"]||e))===r.STATE_DONE},getMaturityState:function(){var e=this.get(r.DSLC_STATE_ATTR),t=e&&(e["@id"]||e.get&&e.get("@id"));return t&&t.substring(8)}}),A={cancel:function(){this.model.fetchingAccessRights=!1,this.fetching?(delete this._onComplete,delete this.queue.fetching[this.model.id]):delete this.queue.toBeFetched[this.model.id]},onComplete:function(){this._onComplete&&this._onComplete.apply(this,arguments),delete this.queue.fetching[this.model.id],delete this.model.fetchingAccessRights},onFailure:function(){this._onFailure&&this._onFailure.apply(this,arguments),delete this.queue.fetching[this.model.id],delete this.model.fetchingAccessRights}},C=function(){this.onComplete=A.onComplete.bind(this),this.onFailure=A.onFailure.bind(this),this.cancel=A.cancel.bind(this)};return h={fetchAccess:function(){delete this.fetchTimeout;var t=this.toBeFetched;this.toBeFetched={};var n=Object.keys(t),s=n.length;if(!s)return{cancel:function(){}};for(var i=a.getBatchGenerator(),o=0;o<s;o++){var r=n[o],l=t[r];l.fetching=!0,this.fetching[r]=l;var d=l.model;i.addRequestsFromBatch(d.getAccessBatch(e.extend(l,{ignoreDictionary:!0})))}return i.sendBatch()},requestFetch:function(t,n){if(!t.id)return t.setAccess(!0),{cancel:function(){}};if(t.fetchingAccessRights)return{cancel:function(){}};t.fetchingAccessRights=!0;var s=e.clone(n||{},!1),i=this,o=i.toBeFetched[t.id]||i.fetching[t.id];return o||((o=new C).model=t,o._onComplete=s.onComplete,o._onFailure=s.onFailure,o.queue=i,i.toBeFetched[t.id]=o,i.fetchTimeout||(i.fetchTimeout=setTimeout(i.fetchAccess.bind(i),i.TIMEOUT_LENGTH)),Object.keys(i.toBeFetched).length>=g.MAX_FETCH_COUNT&&(clearTimeout(i.fetchTimeout),delete i.fetchTimeout,i.fetchAccess()),o)},resetQueue:function(){this.toBeFetched={},this.fetching={},clearTimeout(this.fetchTimeout),delete this.fetchTimeout}},g.implement(l),h.toBeFetched={},h.fetching={},h.TIMEOUT_LENGTH=97,g.AccessModelQueue=h,g.DELETE_DATA=E,g.MODIFY_DATA=T,g.ACCESS_URL=m,g.SHARE_DATA="dsaccess:Operation.Shareable.Share",Object.defineProperty(g,"MAX_FETCH_COUNT",{get:function(){return g._maxFetchCountGet()}}),g._maxFetchCountGet=function(){return 20},g.AccessModelQueue=h,g})),define("DS/E6WCommonApps/Models/ConstraintModel",["UWA/Core","DS/E6WCommonApps/Models/XPPModel","DS/E6WCommonApps/Models/NoAccessModel","DS/E6WCommonApps/Models/AccessModel","DS/E6WCommonApps/Utils/ScenariosUtils","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l){"use strict";var d="dsxplan:constraintType",c="relationship",p="dsxplan:from",u="dsxplan:to",h="dsxplan:isEnforced",m="dsxplan:lag",T="dsxplan:deleteTemporalConstraint",E="dsxplan:createTemporalConstraint",g="dsxplan:modifyTemporalConstraint",A="status",C="fromStatus",_="toStatus",f="fromDate",D="toDate",S="fromStatusImage",R="toStatusImage",y="leadLagTime",v=function(e){return l.get(e)},M=a.dslcMapping,I=t.extend({_uwaClassName:"ConstraintModel",liveUpdateCreateMask:"dsplan:MVMask.Constraint.Complex",init:function(t,n){const s=e.clone(t||{},!1);s["dsplan:jsType"]=s["dsplan:jsType"]||s["dsxplan:jsType"]||0==s["dsxplan:isEnforced"]?"dsplan:ControlledTemporalConstraint":"dsplan:TemporalConstraint",this._parent(s,n)},setup:function(t,n){var s=e.clone(n||{},!1);this._parent.apply(this,arguments),s.dontUpdateConstrainedScheduleElements||this.updatePointers(s),this.hasAccessListeners=!1},updatePointers:function(e){this.updateBackpointers(),this.updateParentWorkscopes({silent:e&&e.silent})},save:function(t,n){var s=this,i=e.clone(n||{},!1),o=Array.prototype.slice.call(arguments,0);o[1]=i;var a=this.getPredecessor(),r=this.getSuccessor();if(a&&a.shouldWeSolve({assumeChanges:!0})){var l=i.onComplete;i.onComplete=function(){if(s.get(I.ENFORCE_ATTR)||t&&void 0!==t[I.ENFORCE_ATTR]){var n={};if(r){var i=r.getParent();n.additionalElementsToSolve=[r.id],n.additionalParentElementsToSolve=[i&&i.id]}a.solve(n)}e.is(l,"function")&&l.apply(this,arguments)}}return this._parent.apply(this,o)},destroy:function(t){var n=this,s=this.getPredecessor(),i=this.getSuccessor();this.stopListening(s),this.stopListening(i);var o=e.clone(t||{},!1),a=Array.prototype.slice.call(arguments,0);if(a[0]=o,!o.fromNotification&&s&&s.shouldWeSolve({assumeChanges:!0})){var r=o.onComplete;o.onComplete=function(t){if(!t.isNew()){var o=n.get(I.ENFORCE_ATTR);if(e.is(o)&&o){var a=i.getParent(),l=i&&{additionalElementsToSolve:[i.id],additionalParentElementsToSolve:[a&&a.id]};s.solve(l)}n.removeFromScheduleElements(),e.is(r,"function")&&r.apply(this,arguments)}}}this._parent.apply(this,a)},getLeadLagTime:function(e){return e=void 0!==e?o.xsdDayTimeDurationToMilliseconds(e)/(60*a.WORKING_HOURS_IN_A_DAY*60*1e3):0,String(e)},isCompleted:function(){return this.get(p).isCompleted&&this.get(p).isCompleted()&&this.get(u).isCompleted&&this.get(u).isCompleted()},get:function(e){return"canEdit"===e?this.canModify(!0):this._parent.apply(this,arguments)},getObjectType:function(){return"Constraint"},toJSON:function(t){var n=e.clone(t||{},!1),s=this._parent.apply(this,arguments);return n.dataForRendering&&(s=e.merge(s,this.dataForRendering({excludeCanEdit:t.excludeCanEdit}))),s},getErrorStatus:function(){var e=this.get(a.SCHEDULE_ERROR_ATTR);return e?"function"==typeof e.get&&("Warning"===e.id||e.id.contains("SolverWarning"))||"string"==typeof e&&"Warning"===o.longToShortURI(e)?a.DEPENDENCY_STATUS_WARNING:"function"==typeof e.get&&e.id!==a.NO_SOLVER_ERROR||"string"==typeof e&&o.longToShortURI(e)!==a.NO_SOLVER_ERROR?a.DEPENDENCY_STATUS_BROKEN:a.DEPENDENCY_STATUS_OK:a.DEPENDENCY_STATUS_OK},getDateForRendering:function(e){return r.getIntlDateFormat(e).displayValue},dataForRendering:function(t){var s,i=this.get(p),o=this.get(u),l=this.get(m),T={type:this.get(d),subtitle:this.get("subtitle"),physicalId:this.get("physicalId")||this.cid,enforcedType:this.get(h)?a.DEPENDENCY_TYPE_ENFORCED:a.DEPENDENCY_TYPE_FLEXIBLE};if(t&&t.excludeCanEdit||(T.canEdit=this.get("canEdit")),T[I.DAYS_STRING]=r.getDaysStringForDate(l),i instanceof I.ScheduleElementModel){let t,n="",s=i.get(a.PARENT_ATTR);s&&(t=s.get("@id"),n=s.get(a.DSLC_TITLE_ATTR)),T=e.extend(T,{predecessor:{id:i.get("@href"),ref:i.get("@id"),title:i.get("title")},predecessorTitle:i.get("title"),predecessorImage:i.getIconURL(),predecessorParent:n,predecessorParentId:t}),i.get(a.DSLC_STATE_ATTR)&&(T[C]=i.get(a.DSLC_STATE_ATTR).get("title")),i.get(f)&&(T[f]=this.getDateForRendering(i.get(f)))}else s=new n,(T=e.extend(T,{predecessorTitle:s.get("dsxplan:label"),predecessorImage:s.get("image")}))[C]=s.get("dsxplan:label"),T[f]=s.get("dsxplan:label"),T[S]=s.get("image");if(o instanceof I.ScheduleElementModel){let t,n="",s=o.get(a.PARENT_ATTR);s&&(t=s.get("@id"),n=s.get(a.DSLC_TITLE_ATTR)),T=e.extend(T,{successor:{id:o.get("@href"),ref:o.get("@id"),title:o.get("title")},successorTitle:o.get("title"),successorImage:o.getIconURL(),successorParent:n,successorParentId:t}),o.get(a.DSLC_STATE_ATTR)&&(T[_]=o.get(a.DSLC_STATE_ATTR).get("title")),o.get(D)&&(T[D]=this.getDateForRendering(o.get(D)))}else s=new n,(T=e.extend(T,{successorTitle:s.get("dsxplan:label"),successorImage:s.get("image")}))[_]=s.get("dsxplan:label"),T[D]=s.get("dsxplan:label"),T[R]=s.get("image");T[y]=this.getLeadLagTime(this.get(m)),T[A]=this.getErrorStatus();let E=this.get(d),g="";return I.TYPES_DISPLAY_MAPPING.forEach((function(e){e.actualValue===E&&(g=e.displayValue)})),T[c]=g,T},_getFullEndPoint:function(e){var t,n=this.get(e);return n instanceof I.ScheduleElementModel&&(t=n),t},getSuccessor:function(){return this._getFullEndPoint(u)},getPredecessor:function(){return this._getFullEndPoint(p)},getType:function(){return this.get(d)},updateBackpointers:function(e){var t=this,n=this.getPredecessor();n&&n.addPredecessorConstraint&&(n.addPredecessorConstraint(this,e),this.stopListening(n),this.listenTo(n,"onModifyAccessChanged",(function(){t.dispatchEvent("onModifyAccessChanged")})),this.listenTo(n,"onDeleteAccessChanged",(function(){t.dispatchEvent("onDeleteAccessChanged")})));var s=this.getSuccessor();s&&s.addSuccessorConstraint&&s.addSuccessorConstraint(this,e)},removeFromScheduleElements:function(){var e=this.getPredecessor(),t=this.getSuccessor();e&&e.removePredecessorConstraint&&e.removePredecessorConstraint(this),t&&t.removeSuccessorConstraint&&t.removeSuccessorConstraint(this)},appendExperimentData(e){let t=this._prepareOptionsForScenario({});Object.keys(t).length>0&&e.push(t)},syncDelete:function(e){this._parent.apply(this,arguments),e.url=o.expandUrl("invoke/"+T);let t=[this.id];this.appendExperimentData(t),e.data=JSON.stringify(t),e.method="POST"},syncCreate:function(e,t){t.noStringify=!0,this._parent(e,t);let n=[t.attrs];this.appendExperimentData(n),t.data=JSON.stringify(n),t.url=o.expandUrl("invoke/"+E),t.method="POST"},syncPatch:function(e,t){if(t.noStringify=!0,this._parent(e,t),!t.attrs)return{cancel:function(){}};{t.url=o.expandUrl("invoke/"+g);let e=[t.attrs,this.id];this.appendExperimentData(e),t.data=JSON.stringify(e),t.method="POST"}},canModify:function(e){var t=!1,n=this.getPredecessor(),s=this.getSuccessor(),i=this.hasFetchedAccessData();if(s&&n){!this.hasAccessListeners&&this.listenToAccessChanged(s,n);var o=s.hasViewAccess()&&n.hasViewAccess(),a=n.canModify(!0)||s.canModify(!0);t=o&&a}return!i&&e&&this.fetchAccessData(),!i||t},hasFetchedAccessData:function(){var e=this.getPredecessor(),t=this.getSuccessor();return e&&t&&e.hasFetchedAccessData()&&t.hasFetchedAccessData()},fetchAccessData:function(e){var t=this.getPredecessor(),n=this.getSuccessor();t&&s.AccessModelQueue.requestFetch(t,e),n&&s.AccessModelQueue.requestFetch(n,e)},getPropertyMask:function(){return"dsplan:MVMask.Constraint.Complex"},fetchForProperty:function(t){let n=e.clone(t||{},!1);var s={mask:this.getPropertyMask&&this.getPropertyMask(),dontUpdateMask:!0,onlyIfNeeded:!0};n.batchBuilder&&(s.ajax=n.batchBuilder.ajax),this.fetch(s)},listenToAccessChanged:function(e,t){this.hasAccessListeners=!0;var n={onModifyAccessChanged:function(){this.dispatchEvent("onModifyAccessChanged",[this])}.bind(this),onDeleteAccessChanged:function(){this.dispatchEvent("onDeleteAccessChanged",[this])}.bind(this)};this.listenTo(e,n),this.listenTo(t,n)},canDelete:function(){return this.canModify(!0)},canEnforce:function(){return!i.inScenario()&&this.canModify(!0)},updateParentWorkscopes:function(t){var n=e.clone(t||{},!1),s=n.fromParent||this.getParentWorkscope(this.getPredecessor()),i=n.toParent||this.getParentWorkscope(this.getSuccessor());s&&s.hasViewAccess()&&s&&s.addModelToAttributeWithCollection(a.CONSTRAINT_RELATION_ATTR,this,t),!i||!i.hasViewAccess()||s&&s.id===i.id||i.addModelToAttributeWithCollection(a.CONSTRAINT_RELATION_ATTR,this,t),n.dontRetryParents||s&&i||setTimeout((()=>{this.updateParentWorkscopes(e.merge(n,{dontRetryParents:!0,forceDispatchEvent:!0}))}),0)},getParentWorkscope:function(e){var t=e&&e.hasViewAccess()&&e.getParent();return e&&e.hasViewAccess()&&(t=e.getProjectParent(e)),t},getParentPath:function(){return""},getWorkDayLength:function(){return 8},getThreshold:function(e,t,n){if(e&&"flexible"===e.enforcedType){var s=new Date(t.get("toDate")||t.get("fromDate")),i=new Date(n.get("toDate")||n.get("fromDate"));return t.nonWorkingDayIterator||t.setupNonWorkingDayIterator&&t.setupNonWorkingDayIterator(),s>i?t.nonWorkingDayIterator.countWorkingDays(i,s):t.nonWorkingDayIterator.countWorkingDays(s,i)}},processLiveUpdateCreation:function(e){var t=o.getObjectById(e["@parentFromId"]),n=o.getObjectById(e["@fromId"]),s=o.getObjectById(e["@parentToId"]),i=o.getObjectById(e["@toId"]);(t&&t.hasFetchedAttribute(a.CONSTRAINT_RELATION_ATTR)||s&&s.hasFetchedAttribute(a.CONSTRAINT_RELATION_ATTR)||i&&i.hasFetchedAttribute("dsplan:taskHasConstraint")||n&&n.hasFetchedAttribute("dsplan:taskHasConstraint"))&&this.fetch({mask:this.liveUpdateCreateMask,onComplete:function(e){e.updateBackpointers(),e.updateParentWorkscopes({fromParent:t,toParent:s})}})},_parseNestedModelsAndCollections:function(e){var t,n,s=e["dsplan:hasScheduleError"];return s&&s.member&&(n=(t=s).member,t["dsxplan:jsType"]||n||(t["dsxplan:jsType"]="dsxplan:ScheduleError"),n&&n.forEach((function(e){e["dsxplan:jsType"]||(e["dsxplan:jsType"]="dsxplan:ScheduleError")}))),this._parent.apply(this,arguments)},unsetModelFromKey:function(e,t,n){null==t&&void 0!==this.get(e)&&this.unset(e,{dontRegisterChange:!0})}});return I.shouldCreateOnLiveUpdate=function(e){var t=o.getObjectById(e["@parentFromId"]),n=o.getObjectById(e["@fromId"]),s=o.getObjectById(e["@parentToId"]),i=o.getObjectById(e["@toId"]);return t||n||s||i},I.prototype.dslcMapping=M,I.PREDECESSOR_ATTR=p,I.SUCCESSOR_ATTR=u,I.TYPE_ATTR=d,I.CONSTRAINT_TYPE_ATTR=c,I.ENFORCE_ATTR=h,I.LAG_ATTR=m,I.TYPE_FINISH_TO_START="Before",I.TYPE_START_TO_START="SS",I.TYPE_FINISH_TO_FINISH="FF",I.TYPE_START_TO_FINISH="SF",I.CONSTRAINT_RDF_TYPE="dsplan:TemporalConstraint",I.CONSTRAINT_FLEXIBLE_RDF_TYPE="dsplan:ControlledTemporalConstraint",I.DELETE_URL=T,I.CREATE_URL=E,I.MODIFY_URL=g,I.ENFORCED_TYPE="enforcedType",I.ERROR_STATUS=A,I.FROM="from",I.TO="to",I.FROM_DATE=f,I.TO_DATE=D,I.FROM_MATURITY=C,I.TO_MATURITY=_,I.FROM_MATURITY_IMAGE=S,I.TO_MATURITY_IMAGE=R,I.DAYS_STRING="daysString",I.LEAD_LAG_TIME=y,I.THRESHOLD="threshold",I.TYPES_DISPLAY_MAPPING=[{actualValue:I.TYPE_START_TO_START,displayValue:v("E6WCommonApps.Label.StartToStart")},{actualValue:I.TYPE_FINISH_TO_START,displayValue:v("E6WCommonApps.Label.FinishToStart")},{actualValue:I.TYPE_FINISH_TO_FINISH,displayValue:v("E6WCommonApps.Label.FinishToFinish")},{actualValue:I.TYPE_START_TO_FINISH,displayValue:v("E6WCommonApps.Label.StartToFinish")}],I})),define("DS/E6WCommonApps/Models/ScheduleElementModel",["UWA/Core","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonApps/Models/AccessModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/ConstraintModel","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/MemberUtils","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/Models/BulkModel","DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/Collections/CollectionTaggerHelper","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/InvokeSolver","DS/E6WCommonApps/Models/AssigneeMixin","DS/E6WCommonApps/Models/SolverModelMixin","DS/E6WCommonApps/Models/ChildModelMixin","DS/E6WCommonApps/Models/NoAccessModel","DS/E6WCommonApps/Checklist/ChecklistParentModelMixin","DS/E6WCommonApps/Utils/ScenariosUtils","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonApps/assets/nls/CollaborativeTasksNLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,E,g,A,C,_){"use strict";var f=function(e){var t=C.get(e);return t===e&&(t=_.get(e)),t},D={"dsxplan:Open":"To Do","dsxplan:InProgress":"In Work","dsxplan:Done":"Completed"},S={parentMask:"dsplan:MVMask.ScheduleElements.Basic",_uwaClassName:"ScheduleElementModel",_propertyDictionary:{subscribed:{volatility:!0},solveCounter:{volatility:!0},toConstraints:{volatility:!0},fromConstraints:{volatility:!0}},onChangeState:Function.prototype,addPredecessorConstraint:function(t,n){var s=e.clone(n||{},!1);this.addModelToAttributeWithCollection("fromConstraints",t,n),this._changing||(this._changed={}),!s.silent&&this._fireRelationshipChangeEvents("fromConstraints")},addSuccessorConstraint:function(t,n){var s=e.clone(n||{});this.addModelToAttributeWithCollection("toConstraints",t,n),this._changing||(this._changed={}),!s.silent&&this._fireRelationshipChangeEvents("toConstraints")},removePredecessorConstraint:function(e){this.get("fromConstraints").remove(e),this._fireRelationshipChangeEvents("fromConstraints")},removeSuccessorConstraint:function(e){this.get("toConstraints").remove(e),this._fireRelationshipChangeEvents("toConstraints")},getParent:function(){return o.getObjectById(this.parentId)},getProjectParent:Function.prototype,getStateForDisplayValue:function(e){return D[e["@id"]||e.id||e]},isCompleted:function(){return this.get(s.DSLC_STATE_ATTR).id===s.STATE_DONE},getValidTypes:function(e){var t=[],n=this.getParent();if(n){var s=n.get(e);if(s){var i=s.get("dsxplan:vocabularyTerms")||s.get("dsplan:vocabularyTerms");if(i){for(var o=0;o<i.length;o++){var a=i.at(o),r="E6WCommonApps.Type."+a.id.substring(a.id.indexOf(":")+1);t.push({actualValue:a.id,displayValue:f(r)})}return t}}}return t},setup:function(){return this.setCollection("toConstraints",new t),this.setCollection("fromConstraints",new t),this.listenTo(this,"onChange:"+s.STATE_ATTR,(function(e,t){this.onChangeState.apply(this,arguments);var n=t&&(t["@id"]||t.id);c.dispatcher.dispatchEvent("refreshTagger",[e,"ds6w:what/ds6w:status",f("emxCollaborativeTasks.Label."+D[n])])})),this._parent.apply(this,arguments)},addAssigneesById:function(e){var t=o.getObjectForAdding(d,e,{mask:a.getPersonMask(),attrs:{"dsaccess:accountName":a.addIamToURI(r.getContextUser())}});return this.addObjects([t],"dsxplan:hasAssignee")},assignToSelf:function(t){var n=this,s=e.clone(t||{},!1);if(r.getContextUserUid()){this.addAssigneesById(a.addUUIDToURI(r.getContextUserUid()));let e={patch:!0};s.multiEdit?(e.ajax=s.batchGenerator&&s.batchGenerator.ajax,e.onComplete=function(){n.dispatchEvent("onChange:"+n.ASSIGNEESATTR)}):(e.onComplete=function(){n.dispatchEvent("onChange:"+n.ASSIGNEESATTR);var e=f("emxCollaborativeTasks.Label.SuccessfullyAssignedToSelf");p.displaySuccess(e)},e.onFailure=function(){var e=f("emxCollaborativeTasks.Error.FailAssignToSelf");p.displayError(e)}),this.save(null,e)}},canDelete:function(){return!(!this.getParent()||!this.getParent()._accessDelete||r.isXppViewer())||this._parent.apply(this,arguments)},canShare:function(){return!(!this.getParent()||!this.getParent().canShare()||r.isXppViewer())||this._parent.apply(this,arguments)},sync:function(t,n,s){if("update"===t||"patch"===t){var i=e.clone(s||{},!1);if(i.hasOwnProperty("solve")||(i.solve=this.shouldWeSolve(i)),i.solve){var o=this;i.onComplete=function(){var t=s&&e.is(s.onComplete,"function")&&s.onComplete.apply(this,arguments);return!i.isMassEdit&&o.solve(),t};var a=Array.prototype.slice.call(arguments,0);return a[2]=i,this._parent.apply(this,a)}}return this._parent.apply(this,arguments)},isAttributeImpactingSolve:function(e,t){var n=e;return this.isDSLC()&&this.inverseDslcMapping&&(n=this.inverseDslcMapping[n]||n),t&&t.dontSolveSubTask?this.attributeImpactingSubTaskSolve&&this.attributeImpactingSubTaskSolve[n]:this.attributeImpactingSolve&&this.attributeImpactingSolve[n]},shouldWeSolve:function(t){var n=e.clone(t||{},!1),i=this.getChangedAttributesSinceLastSave();let o=this.getParent();if(o&&p.isTask(o.getObjectType())&&(n.dontSolveSubTask=!0,i.some((e=>this.isAttributeImpactingSolve(e,n)))))return!1;if(n.fromNotification)return!1;if(i.some(this.isAttributeImpactingSolve.bind(this))||n.assumeChanges){for(var a=this.getParent();a&&a.hasViewAccess();a=a.getParent()){if(a.autosolve===s.AUTOSOLVE_OFF)return S.dispatcher.dispatchEvent("solveNeeded",[this]),!1;if(a.autosolve===s.AUTOSOLVE_ON)return!0}return!0}return!1},solve:function(t){var n=this;this.solveCounter++;var s=e.clone(t||{},!1),i=s.onComplete;s.onComplete=function(e){n.solveCounter--;for(var t=e&&e.member||[],a=0;a<t.length;a++)A.inScenario()&&A.isNewInScenario(t[a]["@id"])||o.getExistingAndMerge(t[a],{animate:!0,keepPanelOpen:s.keepPanelOpen});return i&&i.apply(this,arguments)};var a=s.onFailure;s.onFailure=function(){return n.solveCounter--,a&&a.apply(this,arguments)},s.onCancel=function(){n.solveCounter--};var r=e.is(this.getParent,"function")&&this.getParent(),l=r&&r.id;u.solve(s,this.id,l)},getDurationAttributeAsDays:Function.prototype,getFromConstraints:function(){return this.get("fromConstraints")},getToConstraints:function(){return this.get("toConstraints")},removeObject:function(e,t,n){t instanceof i?t.destroy(n):this._parent.apply(this,arguments)},getIconURL:function(){return""},getSiblingCollection:function(){var n=this.get(s.COMMON_TASK_PARENT_ATTR),i=new t;return n&&(i=e.is(n.getTasks,"function")&&n.getTasks()||e.is(n.getSubtasks,"function")&&n.getSubtasks()),i},checkForCircularOrDuplicateDependency:function(e,t){var n,s=this.getFromConstraints().find((function(t){return t.getSuccessor()&&t.getSuccessor().id===e.id})),o=this.getToConstraints().find((function(t){return t.getPredecessor()&&t.getPredecessor().id===e.id}));return{hasCircularDependency:!!(n=s||o),isDuplicateDependency:n&&n.get(i.TYPE_ATTR)===t&&n.getPredecessor()&&n.getPredecessor().id===e.id&&n.getSuccessor()&&n.getSuccessor().id===this.id}},isVersion:function(){return!0},get:function(e){var t,n=this._parent.apply(this,arguments),i=!1;return e===s.COMMON_TASK_PARENT_ATTR&&!n&&this.hasFetchedAttribute(e)&&(i=!0,t=this.isStandaloneTask&&this.isStandaloneTask()),!i||t||p.isWedoTask(this.get(s.JS_TYPE_ATTR))||(n=new E),n},getI3dx:function(){return p.i3dx(this)},_parseNestedModelsAndCollections:function(e){var t,n,s=e["dsplan:hasScheduleError"];return s&&(n=(t=s).member,t["dsxplan:jsType"]||n||(t["dsxplan:jsType"]="dsxplan:ScheduleError"),n&&n.forEach((function(e){e["dsxplan:jsType"]||(e["dsxplan:jsType"]="dsxplan:ScheduleError")}))),this._parent.apply(this,arguments)},destroy:function(e){this._parent(e),this.getFromConstraints().forEach((function(e){e.get("dsxplan:to").removeSuccessorConstraint(e)})),this.getToConstraints().forEach((function(e){e.get("dsxplan:from").removePredecessorConstraint(e)}))},syncDelete:function(e){var t=this.getParent();this._parent.apply(this,arguments);var n=e.onComplete;e.onComplete=function(){n&&n.apply(this,arguments),t&&t.solve()}}};return S._propertyDictionary["dsplan:actualType"]={volatility:!0},(S=n.extend(S,m,g,h,T)).dispatcher=new e.Class.Events,Object.defineProperty(S.prototype,"solveCounter",m.solveCounterDef),Object.defineProperty(S.prototype,"prevSolveCounter",m.prevSolveCounterDef),Object.defineProperty(l.prototype,"solveCounter",m.solveCounterDef),Object.defineProperty(l.prototype,"prevSolveCounter",m.prevSolveCounterDef),S.SOLVER_URI="dsmf:xplan.Scheduler.JSONScheduleObjects?$mask=dsplan:MVMask.ScheduleElements.Complex",i.ScheduleElementModel=S,S})),define("DS/E6WCommonApps/Models/MilestoneModel",["UWA/Core","UWA/Utils","UWA/Class/Collection","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Checklist/ChecklistItemCollection","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/FileManagementMixin","DS/E6WCommonApps/Models/ScheduleElementModel","DS/E6WCommonApps/E6WDefaultCalendarInstance","DS/E6WCommonApps/Preferences","DS/E6WCommonApps/WeekIterator"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u){"use strict";var h="dsplan:actualDate",m=(r.HAS_CHECKLIST_ATTR,r.dslcMapping),T=s.inverseMapping(m),E=new Intl.DateTimeFormat("en-us",{month:"short",year:"numeric",day:"numeric"}),g=d.extend({attributeImpactingSolve:{"dsplan:dateIntervalMin":!0,"dsplan:dateIntervalMax":!0,"dsplan:estimatedDate":!0,"dsplan:suggestedDate":!0,"dscom:hasMaturity":!0,"dsplan:userDefinedDates":!0,"dsplan:vocabularyType":!0},_uwaClassName:"MilestoneModel",_propertyDictionary:{explicitTagsData:{volatility:!0},_xplanSubscribed:{volatility:!0},"dsxplan:workscopeParent":{inverseProperty:"dsxplan:hasMilestone",inversePropertyIsCollection:!0},"dsxplan:workscopeParentForMilestone":{inverseProperty:"dsxplan:hasMilestone",inversePropertyIsCollection:!0},"dsplan:workscopeParentForAll":{volatility:!0},dateConstraints:{volatility:!0},"dsplan:hasChecklistItem":{inverseProperty:r.CHECKLIST_PARENT_ATTR}},_relations:[{key:"dsplan:hasChecklistItem",relatedCollection:o}],writeMask:"dsplan:MVMask.Milestone.Property",liveUpdateCreateMask:"dsplan:MVMask.Milestone.Complex",getAttachments:function(){return this.getCollectionAttribute(r.ATTACHMENT_ATTR,{"@mask":"dsplan:MVMask.Milestone.Property"})},init:function(t,n){const s=e.clone(t||{},!1);s["dsplan:jsType"]=s["dsplan:jsType"]||s["dsxplan:jsType"]||"dsplan:Milestone",this._parent(s,n)},setupNonWorkingDayIterator:function(){if(this.id){var e=this.getProjectParent();e&&e.getNonWorkingDayIterator?this.nonWorkingDayIterator=e.getNonWorkingDayIterator():this.nonWorkingDayIterator=c.prototype.getInstance()}},getNonWorkingDayIterator:function(){return this.nonWorkingDayIterator},getEndDate:function(){return this.getStartDate()},setup:function(){this._parent.apply(this,arguments),this.getAttachments(),this._shadowParents=new n},save:function(){var e=a.setHelper.apply(this,arguments).options;return this.isGhost()?(e&&e.onFailure&&e.onFailure(this,{msg:"Error: xPlan.Error.NoModifyDPMMilestone","@code":401}),this.rollbackChanges(),!1):this._parent.apply(this,arguments)},validate_:function(e){var t,n={fields:[]},s=this,i=!0,o=function(t){var n;return e&&(n=e[t]),n||s.get(t)},a=Date(o.call(this,g.STARTDATE_ATTR)),l=Date(o.call(this,g.DATE_MIN_ATTR)),d=Date(o.call(this,g.DATE_MAX_ATTR)),c=o.call(this,r.SUGGESTED_DATE_ATTR),p=o.call(this,h),u=o.call(this,r.STATE_ATTR);c||(n.fields.push(r.SUGGESTED_DATE_ATTR),i=!1),g.prototype._validateDateBoundaries(a,l,d,n)||(i=!1),g.prototype._validateSuggestedDate(c,n)||(i=!1),g.prototype._validateActualDate(p,u,n)||(i=!1),g.prototype._validateActualDate(p,u,n)||(i=!1);var m=o(r.TITLE_ATTR);return null==m&&(m=o(r.DSLC_TITLE_ATTR)),m&&m.trim().length||(n.fields.push(r.TITLE_ATTR),i=!1),i||(t=n),t},_validateActualDate:function(e,t,n){var s=!0;if(e&&t!==r.STATE_OPEN){e&&e.actualValue&&(e=e.actualValue);var i=new Date;t=t&&t["@id"]?t["@id"]:t,e>i&&t!==r.STATE_OPEN&&(n.fields.push(h),s=!1),e instanceof Date||(e=new Date(e),a.isValidDate(e)||(n.fields.push(h),s=!1))}return s},_validateSuggestedDate:function(e,t){var n=!0;return e&&e.actualValue&&(e=e.actualValue),e instanceof Date||(e=new Date(e),a.isValidDate(e)||(t.fields.push(r.SUGGESTED_DATE_ATTR),n=!1)),n},_validateDateBoundaries:function(e,t,n,s){var i=!0;return t>n&&(s.fields.push(g.DATE_MIN_ATTR),s.fields.push(g.DATE_MAX_ATTR),i=!1),(e>n||e<t)&&(s.fields.push(g.STARTDATE_ATTR),e>n&&-1===s.fields.indexOf(g.DATE_MAX_ATTR)&&s.fields.push(g.DATE_MAX_ATTR),e<t&&-1===s.fields.indexOf(g.DATE_MIN_ATTR)&&s.fields.push(g.DATE_MIN_ATTR),i=!1),i},getObjectType:function(){return"Milestone"},getValidTypes:function(){var e=this.isDSLC()?"dsxplan:hasMilestoneVocabulary":r.MILESTONE_VOCABULARY_ATTR;return this._parent(e)},get:function(e,t){var n=this._parent.apply(this,arguments);switch(e){case"dsplan:estimatedDate":case"dsplan:suggestedDate":case h:case"dsplan:dateIntervalMin":case"dsplan:dateIntervalMax":t&&t.rawValue||n&&void 0!==n&&(n=new Date(n));break;case"dsplan:actualType":case"dsxplan:actualType":t&&t.rawValue||(n=n?{actualValue:n.id,displayValue:n.get("title")}:null);break;case"dsxplan:vocabularyType":n||(n="dsplan:Milestone");break;case"title":n=n||this.get("dsxplan:label");break;case"canEdit":n=!this.isGhost()&&n;break;case"image":n=n||this.getImage(this._parent.apply(this,arguments));break;case"_hasProcessModelButNoInstance":return this.get(r.GOVERNING_PROCESS_MODEL_ATTR)&&!this.get(r.GOVERNING_PROCESS_INSTANCE_ATTR)}return n},getStartDate:function(){return this.isComplete()&&this.get(h)?this.get(h):this.get(g.STARTDATE_ATTR)},getImage:function(e){return e||(e=this.getDefaultImage()),e&&!t.isAbsoluteUrl(e)?require.toUrl("E6WCommonApps/assets/img/I_Milestone_22.png"):e},getDefaultImage:function(){var e;if((this.get("dsxplan:jsType")||this.get("@type"))&&(e=require.toUrl("E6WCommonApps/assets/img/iconSmallMilestone.png")),e)return e},setStartDate:function(e,t){var n,s,i,o,a,r=new Date(this.getStartDate());this._setDateAttribute(g.STARTDATE_ATTR,e,t),this._setDateAttribute(g.SUGGESTEDDATE_ATTR,e,t),t&&(t.updateRestrictionWithStartDate&&(n=e-r,s=[],o=this.get(g.DATE_MIN_ATTR),a=this.get(g.DATE_MAX_ATTR),o&&(o=o.getTime(),o+=n,this.setDateIntervalMin(new Date(o),{silent:!0}),s.push("onChange:"+g.DATE_MIN_ATTR),i=!0),a&&(a=a.getTime(),a+=n,this.setDateIntervalMax(new Date(a),{silent:!0}),s.push("onChange:"+g.DATE_MAX_ATTR),i=!0),i&&this.dispatchEvent("onChange:minAndMax",[s])),t.updateRestrictionIfExceeded&&(s=[],(o=this.get(g.DATE_MIN_ATTR))&&(o-e>0&&o-r<=0)&&(this.setDateIntervalMin(e,{silent:!0}),s.push("onChange:"+g.DATE_MIN_ATTR),i=!0),(a=this.get(g.DATE_MAX_ATTR))&&(e-a>0&&r-a<=0)&&(this.setDateIntervalMax(e,{silent:!0}),s.push("onChange:"+g.DATE_MAX_ATTR),i=!0),i&&this.dispatchEvent("onChange:minAndMax",s)))},setDateInterval:i.prototype._setDateAttribute,setDateIntervalMin:function(t,n){var s=e.clone(n||{},!1),i=this.getDateIntervalMin(),o=this.getDateIntervalMax();this.setDateInterval(g.DATE_MIN_ATTR,t,s);var a=new Date(this.getStartDate());t-a>0&&i-a<=0&&(s.updateRestrictionIfExceeded=!0,this.setStartDate(t,s)),t-o>0&&(delete s.updateRestrictionIfExceeded,this.setDateIntervalMax(t,s))},setDateIntervalMax:function(t,n){var s=e.clone(n||{},!1),i=this.getDateIntervalMax(),o=this.getDateIntervalMin();this.setDateInterval(g.DATE_MAX_ATTR,t,s);var a=new Date(this.getStartDate());a-t>0&&a-i<=0&&(s.updateRestrictionIfExceeded=!0,this.setStartDate(t,s)),o-t>0&&(delete s.updateRestrictionIfExceeded,this.setDateIntervalMin(t,s))},getDateIntervalMin:function(){return this.get(g.DATE_MIN_ATTR)},getDateIntervalMax:function(){return this.get(g.DATE_MAX_ATTR)},isFixed:function(){return this.get(g.FIXED_DATE)},hasDateConstraint:function(){return Boolean(this.getDateIntervalMin()||this.getDateIntervalMax())},isComplete:function(){var e=this.get(r.STATE_ATTR);return(e&&(e.id||e["@id"]))===r.STATE_DONE},isStarted:function(){return this.isInWork()},isMilestone:function(){return!0},isGate:function(){return!1},isInWork:function(){var e=this.get(r.STATE_ATTR);return(e&&(e.id||e["@id"]))===r.STATE_IN_PROGRESS},isStartOrEndMilestone:function(){return this.get(r.MILESTONE_VOCABULARY_TYPE)&&("dsxnpi:MilestoneLaunched"===this.get(r.MILESTONE_VOCABULARY_TYPE)||"dsxnpi:MilestoneClosed"===this.get(r.MILESTONE_VOCABULARY_TYPE))},canModify:function(){return!this.isGhost()&&this._parent.apply(this,arguments)},canDelete:function(){if(this.isGhost())return!1;return!(this.isComplete&&this.isComplete())&&this._parent.apply(this,arguments)},getIconURL:function(){return require.toUrl("DS/E6WCommonApps/assets/img/iconSmallMilestone.png")},getPropertyMask:function(){return"dsplan:MVMask.Milestone.Property"},getParentWorkscope:function(){return this.getProjectParent()},getParentInverseProperty:function(){return this._propertyDictionary[r.PARENT_ATTR].inverseProperty},getProjectParent:function(){return this.getParent()},getParent:function(){return this._parent.apply(this,arguments)||this.get(r.WORKSCOPE_PARENT_ALL_ATTR)},fetchForProperty:function(t){let n=e.clone(t||{},!1);var s={mask:this.getPropertyMask&&this.getPropertyMask(),dontUpdateMask:!0,onlyIfNeeded:!0};n.batchBuilder&&(s.ajax=n.batchBuilder.ajax),this.fetch(s),this.fetchWorkscopeCalendar()},fetchWorkscopeCalendar:function(t){this.getParent().fetch({mask:"dsplan:MVMask.WorkPackage.CalendarOnly",onlyIfNeeded:!0,onComplete:function(){e.is(t,"function")&&t()}})},fetchWorkscopeStrategies:function(t){this.getParent().fetch({mask:"dsplan:MVMask.WorkPackage.StrategiesOnly",onlyIfNeeded:!0,onComplete:function(){e.is(t,"function")&&t()}})},isGhost:function(){return"dsxnpi:MilestoneExternal"===this.get("dsxplan:vocabularyType")},addShadowParent:function(e){this._shadowParents.add(e)},removeShadowParent:function(e){this._shadowParents.remove(e)},getShadowParents:function(){return this._shadowParents},processLiveUpdateCreation:function(e){this._parent.apply(this,arguments),this.parentId||(this.parentId=e["@parentId"])},getAssignees:function(){return this.getCollectionAttribute(r.ASSIGNEE_ATTR,{detailsMask:"dsplan:MVMask.Person.Complex"})},createNodeData:function(){let t=this._parent.apply(this,arguments);return e.merge(t,{sequenceOrder:0,nodeType:"milestone"}),t},getSuggestedDateWithWeekLabels:function(){const e=this.get("dsxplan:suggestedDate");if(!p.getHideWeekLabel()&&e){var t=new Date(e),n=E.format(t);return n=n+" (W"+new u({dateline:t}).getWeekNumber(t)+"-"+t.getDay()+")"}return e}});return g.STARTDATE_ATTR="dsplan:estimatedDate",g.SUGGESTEDDATE_ATTR="dsplan:suggestedDate",g.DATE_MIN_ATTR="dsplan:dateIntervalMin",g.DATE_MAX_ATTR="dsplan:dateIntervalMax",g.FIXED_DATE="dsplan:userDefinedDates",g.STATE_ATTR="dscom:hasMaturity",g.ACTUAL_DATE=h,g.prototype.dslcMapping=m,g.prototype.inverseDslcMapping=T,g.implement(l),g})),define("DS/E6WCommonApps/Models/GateModel",["UWA/Core","UWA/Utils","UWA/Class/Collection","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/TreeDocument/TreeNodeUtil","DS/E6WCommonApps/Models/MilestoneModel"],(function(e,t,n,s,i,o,a,r){"use strict";a.COLUMN_DATA_INDICES;var l=o.dslcMapping,d=s.inverseMapping(l),c=r.extend({attributeImpactingSolve:{"dsplan:dateIntervalMin":!0,"dsplan:dateIntervalMax":!0,"dsplan:estimatedDate":!0,"dsplan:suggestedDate":!0,"dscom:hasMaturity":!0,"dsplan:userDefinedDates":!0,"dsxplan:vocabularyType":!0},_uwaClassName:"GateModel",_propertyDictionary:{explicitTagsData:{volatility:!0},_xplanSubscribed:{volatility:!0},"dsxplan:workscopeParent":{inverseProperty:"dsxplan:hasGate",inversePropertyIsCollection:!0},"dsxplan:workscopeParentForGate":{inverseProperty:"dsxplan:hasGate",inversePropertyIsCollection:!0},dateConstraints:{volatility:!0},"dsplan:workscopeParentForAll":{volatility:!0}},writeMask:"dsplan:MVMask.Gate.Property",liveUpdateCreateMask:"dsplan:MVMask.Milestone.Complex",getAttachments:function(){return this.getCollectionAttribute(o.ATTACHMENT_ATTR,{"@mask":"dsplan:MVMask.Gate.Property"})},getPropertyMask:function(){return"dsplan:MVMask.Gate.Property"},setup:function(){this._parent.apply(this,arguments),this.getAttachments(),this._shadowParents=new n},save:function(){var e=i.setHelper.apply(this,arguments).options;return this.isGhost()?(e&&e.onFailure&&e.onFailure(this,{msg:"Error: xPlan.Error.NoModifyDPMGate","@code":401}),this.rollbackChanges(),!1):this._parent.apply(this,arguments)},validate_:function(){return this._parent.apply(this,arguments)},getObjectType:function(){return"Gate"},isGate:function(){return!0},isMilestone:function(){return!1},getDefaultImage:function(){var e;if((this.get("dsxplan:jsType")||this.get("@type"))&&(e=require.toUrl("E6WCommonApps/assets/img/iconSmallGate.png")),e)return e},get:function(e){var t=Array.prototype.slice.call(arguments,0);t[0]=e;var n=this._parent.apply(this,t),s=this._propertyDictionary[e];if(s&&s.date){return n?new Date(n):void 0}switch(e){case"card_icon":n=require.toUrl("DS/E6WCommonApps/assets/img/I_Gate_16.png");break;case"dsxplan:vocabularyType":n="dsplan:Gate"}return n},getValidTypes:function(){var e=this.isDSLC()?"dsxplan:hasMilestoneVocabulary":o.MILESTONE_VOCABULARY_ATTR;return this._parent(e)},getIconURL:function(){return require.toUrl("DS/E6WCommonApps/assets/img/I_Gate_22.png")},createNodeData:function(){let t=this._parent.apply(this,arguments);return e.merge(t,{resolution:this.get("dsplan:resolution")}),t.icon=this.getDefaultImage(),t.nodeType="gate",t}});return c.prototype.dslcMapping=l,c.prototype.inverseDslcMapping=d,c})),define("DS/E6WCommonApps/Checklist/ChecklistItemModel",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/AccessModel","DS/E6WCommonApps/Models/ChildModelMixin"],(function(e,t,n,s){"use strict";var i={_uwaClassName:"ChecklistItemModel",_propertyDictionary:{"dsplan:checklistParent":{volatility:!0}},get:function(e){var t=this._parent.apply(this,arguments);return"title"===e?this.get("dsxplan:label"):t},getTransferObject:function(n){var s=e.clone(n||{},!1);return s.sequenceOrder=this.get(t.SEQUENCE_ORDER_ATTR_DSLC),s.description=this.get(t.DSLC_DESCRIPTION_ATTR),this._parent(s)},getParent:function(){return this.get(t.CHECKLIST_PARENT_ATTR)},_addToModelOrCollectionProperty:function(){var t=e.clone(arguments[1]||{},!1);t.silent=!0,this._parent.apply(this,[arguments[0],t])},_removeFromModelOrCollectionProperty:function(){var t=e.clone(arguments[1]||{},!1);t.silent=!0,this._parent.apply(this,[arguments[0],t])},getSequenceOrder:function(){let e=Math.random();var n=this.getParent&&this.getParent();if(n&&n.hasFetchedAttribute(t.HAS_CHECKLIST_ATTR))return this.computeAndReturnCorrectSequenceOrder(e,n,t.HAS_CHECKLIST_ATTR)},computeAndReturnCorrectSequenceOrder:function(e,n,s){var i=n.get(s).last();return i&&(void 0===(e=i.get(t.SEQUENCE_ORDER_ATTR_DSLC))&&(e=0,i.rdfModel&&(e=i.rdfModel.get(t.SEQUENCE_ORDER_ATTR_DSLC))),e+=Math.random()),e},compactJson:function(){var e=this._parent.apply(this,arguments),n=this.getSequenceOrder();return e[t.SEQUENCE_ORDER_ATTR_DSLC]=n,e}};return i=n.extend(i,s)})),define("DS/E6WCommonApps/Checklist/ChecklistView",["UWA/Core","DS/UIKIT/Tooltip","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/E6WHandlebarsHelpers","DS/Controls/Button","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/Models/CloneModel","DS/PlatformAPI/PlatformAPI","DS/E6WCommonApps/Views/DetailedToggleView","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Checklist/ChecklistItemView","DS/E6WCommonApps/Checklist/ChecklistItemModel","DS/E6WCommonApps/Checklist/ChecklistItemCollection","DS/E6WCommonApps/Models/ScheduleElementModel","DS/RDFFoundation/RDFUtils","text!DS/E6WCommonApps/assets/templates/checklist.html.handlebars","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,E,g,A){"use strict";var C=s.compile(E),_=function(e){return g.get(e)},f="No Answer",D=n.extend({_uwaClassName:"ChecklistView",tagName:"div",className:"details-display ddv-view checklist-panel",id:function(){return"ChecklistView_"+this.cid},setup:function(){this._editMode=!1;var e=window.widget.getValue("appId")+".copy";l.subscribe(e,(function(e){widget.setValue("copiedData",e)})),this._parent.apply(this,arguments),this.listenTo(this.model.model.getCollectionAttribute("dsplan:hasChecklistItem"),"onSort",this.render)},render:function(e){this.stopListening(this._parentView,"onScroll"),this.isModelScheduleElement()&&this.getParentProject()&&this.stopListening(this.getParentProject(),"onModifyAccessChanged"),this.listenTo(this._parentView,"onScroll",(()=>{this.dispatchEvent("onScroll")})),this.container.empty(!0);let t=this._getToolbar();t&&t.destroy(),this._createChecklistAccess=this.createChecklistAccess();let n=this._hasItems();var s=i.i18n;if(i.i18n=_,this.container.setHTML(C({hasItems:n,allowCreation:this._createChecklistAccess})),this.isModelScheduleElement()&&this.getParentProject()&&this.listenTo(this.getParentProject(),"onModifyAccessChanged",this.render),this.listenToOnce(this.model.model,"onSync",this.render),i.i18n=s,this.checklistItemViews=[],this.expandedModels=new Set,this._drawActionButtons(),n)this._editMode?(this._setupChecklistItemViews(e),this.updateRequiredLegend(this.anyExpandedModels())):(this._setupChecklistReadOnlyViews(),this.updateRequiredLegend(!1));else{this.updateRequiredLegend(!1),this._parentView._parentView.getElement(".body").classList.add("eno-empty-set");const e=this.container.getElement("#emptyCreateButton");e&&e.addEventListener("click",this.addChecklistItem.bind(this))}return this},hasModifyAccess:function(){return e.is(this.model.model.canModify,"function")&&this.model.model.canModify(!1,"dsplan:hasChecklistItem")},isModelScheduleElement:function(){return this.model.model instanceof m},createChecklistAccess:function(){let e;return!!this.hasModifyAccess()&&(!this.isModelScheduleElement()||(e=this.getParentProject(),!e||e.canModify(!0)))},getParentProject:function(){return this.model.model.getProjectParent(this.model.model)||this.model.model._nearestProjectParent},validate:function(){let e=!1;const t=this.model.get(c.HAS_CHECKLIST_ATTR);return t&&t.forEach((t=>{t.get("dsxplan:label")||(e=!0)})),e},refreshView:function(e){this._dispatchValidationEvent(),this.render(e)},_dispatchValidationEvent:function(){this.validate&&(this.validationError=this.validate(),this.validationError?this.model.dispatchEvent("onValidationFailure"):this.model.dispatchEvent("onValidationSuccess"))},anyExpandedModels:function(){return this.expandedModels.size>0},_addChecklistItemView:function(e,t){let n=this.model.getOrCreateChildCloneModel(e,"dsplan:hasChecklistItem"),s=new p(this.buildItemViewOptions({model:e,cloneModel:n,expand:this.expandedModels.has(e)||!e.id}));e.id||this.expandedModels.add(e),this.listenTo(s,"onToggleExpandCollapse",((e,t)=>{t?this.expandedModels.add(e):this.expandedModels.has(e)&&this.expandedModels.delete(e),this.updateRequiredLegend(this.anyExpandedModels())})),this.listenTo(e,"onChange:dsxplan:label",this._dispatchValidationEvent),this.listenTo(s,"onDeleteChecklistItem",this.removeChecklistItem),this.addChildView(s),this.checklistItemViews.push(s),this.listenTo(this._parentView,"onScroll",(()=>{this.dispatchEvent("onScroll")})),s.render().inject(this.container)},_setupChecklistReadOnlyViews:function(){var e=this,t=[{actualValue:"Yes",displayValue:_("E6WCommonApps.Label.Yes")},{actualValue:"No",displayValue:_("E6WCommonApps.Label.No")},{actualValue:f,displayValue:_("E6WCommonApps.Label.NoAnswer")}];const n=this.model.get(c.HAS_CHECKLIST_ATTR);n&&n.forEach((n=>{let s=e.model.getOrCreateChildCloneModel(n,"dsplan:hasChecklistItem"),i=new d({i18n:g,isPropertyPanel:!0,config:{titleAttribute:"dsxplan:label",descriptionAttribute:"dsxplan:comment",name:"dsplan:response",readWrite:!0,type:"toggle",toggleType:"radio",values:t},model:{model:s}.model});e.addChildView(i),e.listenTo(this._parentView,"onScroll",(()=>{e.dispatchEvent("onScroll")})),i.render({checklistAccess:this.hasModifyAccess()}).inject(this.container)}))},_getToolbar:function(){return this._parentView&&this._parentView._parentView.getElement(".body-toolbar")},_hasItems:function(){const e=this.model.get("dsplan:hasChecklistItem");return e&&e.length>0},_drawActionButtons:function(){const n={displayStyle:"lite",label:"lite displayStyle",showLabelFlag:!1,icon:{fontIconFamily:WUXManagedFontIcons.Font3DS}},s=function(t,s,i,a,r){const l={icon:{iconName:t},domId:s};return i&&(l.checkFlag=!0),l.disabled=Boolean(a),l.visibleFlag=Boolean(r),new o(e.extend(l,n,!0))};let i=this._editMode,a=this._getToolbar();if(!a){let n=this._hasItems();a=e.createElement("div",{class:"body-toolbar"});const o=s("plus","addChecklistItem",!1,!i,this._createChecklistAccess),r=s("pencil","switchEditMode",i,!1,this._createChecklistAccess),l=s("copy","copyChecklist",!1,!i||!n,this._createChecklistAccess),d=s("paste","pasteChecklist",!1,!i,this._createChecklistAccess),c=s("trash","deleteChecklist",!1,!i||!n,this._createChecklistAccess);a.inject(this._parentView._parentView.getElement(".body"),"before");let p=e.createElement("span");this.requiredLegendLabel=e.createElement("div",{class:"required-field-label"}),this.requiredLegendIndicator=e.createElement("span",{class:"required-field-indicator",text:"*"}),this.requiredLegendLabel.inject(a),this.requiredLegendIndicator.inject(this.requiredLegendLabel),this.requiredLegendLabel.appendText(A.get("emxFoundation.Label.RequiredFieldLegend")),p.inject(a),o.inject(p),r.inject(p),l.inject(p),d.inject(p),c.inject(p),o.addEventListener("buttonclick",this.addChecklistItem.bind(this)),r.addEventListener("buttonclick",this.switchEditMode.bind(this)),l.addEventListener("buttonclick",this.copyChecklist.bind(this)),d.addEventListener("buttonclick",this.pasteChecklist.bind(this)),c.addEventListener("buttonclick",this.deleteChecklist.bind(this)),this._buttonTooltips=[],this._buttonTooltips.push(new t({target:o.elements.container,body:_("E6WCommonApps.Label.NewChecklistItem")})),this._buttonTooltips.push(new t({target:r.elements.container,body:_("E6WCommonApps.Label.EditChecklist")})),this._buttonTooltips.push(new t({target:l.elements.container,body:_("E6WCommonApps.Label.CopyChecklist")})),this._buttonTooltips.push(new t({target:d.elements.container,body:_("E6WCommonApps.Label.PasteChecklist")})),this._buttonTooltips.push(new t({target:c.elements.container,body:_("E6WCommonApps.Label.DeleteAllChecklistItems")}))}},updateRequiredLegend:function(e){e?this.requiredLegendLabel.removeClassName("required-field-hidden"):this.requiredLegendLabel.addClassName("required-field-hidden")},buildItemViewOptions:function(t){var n=e.merge({name:"checklistItem",readWrite:!1},t);return{i18n:g,isPropertyPanel:!0,config:n,model:t.model}},_setupChecklistItemViews:function(e){var t=this;(this.model.get("dsplan:hasChecklistItem")||new h).forEach((n=>{t._addChecklistItemView(n,e)}))},addChecklistItem:function(){this._editMode||this._actualSwitchEditMode();let e=new u({"dsxplan:jsType":"dsplan:ChecklistItem","dsplan:response":f});this.model.add("dsplan:hasChecklistItem",e)},removeChecklistItem:function(e){let t=this.model.get("dsplan:hasChecklistItem").indexOf(e);this.expandedModels.has(e)&&this.expandedModels.delete(e),this.model.remove("dsplan:hasChecklistItem",t)},_actualSwitchEditMode:function(){this._editMode?this._editMode=!this._editMode:this._editMode=!0,this.render()},switchEditMode:function(){const e=this;this.model.modificationsPending?this._parentView._parentView.modal.confirm(this.i18n("E6WCommonApps.Warning.PendingChanges"),this.i18n("E6WCommonApps.Command.CancelChanges"),(function(t){t&&(e.model.cancel(),e._actualSwitchEditMode())})):e._actualSwitchEditMode()},_getCopyOfModel:function(e){let t=[c.DSLC_TITLE_ATTR,c.DSLC_DESCRIPTION_ATTR,c.JS_TYPE_ATTR,c.SEQUENCE_ORDER_ATTR_DSLC,c.IS_MANDATORY_ATTR],n={};return t.forEach((function(t){n[t]=e._attributes[t]})),n[c.RESPONSE_ATTR]=f,new u(n)},copyChecklist:function(){const e=this.model.get(c.HAS_CHECKLIST_ATTR);var t,n,s=e.length&&e.at(0).getTransferObject();for(let n=1;n<e.length;n++)t=e.at(n).getTransferObject(),s&&s.data.items.push(t.data.items[0]);n=window.widget.getValue("appId")+".copy",l.publish(n,s),a.displayInfo(_("E6WCommonApps.Alert.ChecklistCopied"))},pasteChecklist:function(){const e=widget.getValue("copiedData"),t=e&&e.data&&e.data.items;for(let e=0;e<t.length;e++){let n=T.getObjectById(t[e].objectId);if(n){const e=this._getCopyOfModel(n);this.model.add("dsplan:hasChecklistItem",e)}else{const n=new u({"dsxplan:jsType":t[e].objectType,"dsxplan:label":t[e].displayName,"dsxplan:sequenceOrder":t[e].sequenceOrder,"dsplan:response":f,"dsxplan:comment":t[e].description});this.model.add("dsplan:hasChecklistItem",n)}}this.model.save({mask:"dsplan:MVMask.WorkPackage.Property"})},deleteChecklist:function(){this.model.removeAll("dsplan:hasChecklistItem")},destroy:function(){void 0!==this._animationFrameForScroll&&(cancelAnimationFrame(this._animationFrameForScroll),delete this._animationFrameForScroll),this._buttonTooltips&&this._buttonTooltips.forEach((function(e){e.destroy()})),this._parent.apply(this,arguments)}});return D})),define("DS/E6WCommonApps/LiveUpdateUtils",["UWA/Core","UWA/Class/Events","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/MaskUtils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],(function(e,t,n,s,i,o){"use strict";var a=new t,r=new WeakMap,l=new WeakMap;function d(e,t){try{var s=n.getObjectById(t["@id"]),i=t.data;s&&s.onShareNotification(e,i),a.dispatchEvent("onShareNotification",t)}catch(e){console.error(e)}}function c(e,t){try{var s=n.getObjectById(t["@id"]),i=t.data;s&&s.onShareNotification(e,i),a.dispatchEvent("onUnShareNotification",t)}catch(e){console.error(e)}}function p(e){try{var t=n.getObjectById(e["@id"]);t&&t.get("dsxplan:jsType")!==o.DELETED_PROJECT_RDF_TYPE&&(t.dispatchEvent("onDeleteNotification"),t.destroy({onFailure:Function.prototype,noServer:!0,fromNotification:!0})),a.dispatchEvent("onDeleteNotification",e)}catch(e){console.error(e)}}function u(t){try{var s=function(){var s=n.getModelConstructor(t);if((s.shouldCreateOnLiveUpdate||i.shouldCreateOnLiveUpdate)(t)){var o=e.clone(t,!1);delete o["@parentId"],n.getObjectForAdding(s,t["@id"],{attrs:o}).processLiveUpdateCreation(t)}a.dispatchEvent("onCreateNotification",t)},r=n.getObjectById(t["@id"]);r?r.get("dsxplan:jsType")===o.DELETED_PROJECT_RDF_TYPE&&(r.destroy({onFailure:Function.prototype,noServer:!0,fromNotification:!0}),s()):s()}catch(e){console.error(e)}}function h(e){try{n.getExistingAndMerge(e);var t=n.getObjectById(e["@id"]);t&&!e.hasOwnProperty("dsxplan:estimatedEndDate")&&t.unset("dsxplan:estimatedEndDate"),t&&!e.hasOwnProperty("dsxplan:estimatedStartDate")&&t.unset("dsxplan:estimatedStartDate"),t&&!e.hasOwnProperty("dsxplan:accumulatedStoryPoints")&&t.unset("dsxplan:accumulatedStoryPoints")}catch(e){console.error(e)}}return a.attributeTimestampMap=r,a.ignoreLiveUpdateMap=l,a.shouldBeUpdated=function(e,t,n){return!a.attributeTimestampMap.get(e)||!a.attributeTimestampMap.get(e)[t]||n>a.attributeTimestampMap.get(e)[t]},a.updateAttributeTimestamps=function(e,t,n){if(t){Object.keys(t).forEach((t=>{e.isDSLC()&&e.dslcMapping[t]&&(t=e.dslcMapping[t]),a.attributeTimestampMap.get(e)||a.attributeTimestampMap.set(e,{}),a.attributeTimestampMap.get(e)[t]=n}))}},a.addToIgnoreLiveUpdateMap=function(e){l.set(e,!0)},a.resetObjectMap=function(){a.ignoreLiveUpdateMap={}},a.updateFunc=function(t){var i=this;let r=function(e,t){var n=e.id;(i.uniqueMap||(i.uniqueMap={}),i.uniqueMap[n])||(i.uniqueMap[n]=n,d=!0,(t?s.getMinMaskArray(e.getMasks(),{attributes:t}):s.getMinMaskArray(e.getMasks())).forEach((function(t){var n=i.masksToFetch[t]||[];n.push(e.id),i.masksToFetch[t]=n})))};var d=!1,c=n.getObjectById(t["@id"]);if(!c||!l.get(c)){if(c&&t.data){let e=Object.keys(t.data),n={"@etag":t.ceStamp},s=[];e.forEach((function(e){if("operation"===e)return;let i=o.dslcMapping[e]||e;"object"==typeof t.data[e]?s.push(i):t.timeStamp&&a.shouldBeUpdated(c,i,t.timeStamp)&&(n[i]=t.data[e])}));const i=c.parse(n);c.save(i,{noServer:!0,fromNotification:!0,dontRegisterChange:!0}),a.updateAttributeTimestamps(c,n,t.timeStamp),0!==Object.keys(s).length&&r(c,s)}else(c&&c.get("@etag")!==t.ceStamp||c&&e.is(c.hasSubtasks,"function")&&c.hasSubtasks())&&r(c);return d}l.delete(c)},a.onNotification=function(e){this._notifQueue.push(e),this._notifTimeout||(this._notifTimeout=setTimeout((function(e){delete e._notifTimeout,a.handlenotifications(e._notifQueue)}),2e3,this))},a.handlenotifications=function(e){var t=Object.create(null),s=Object.create(null),i=[],o=n.getBatchGenerator(),r=d.bind(void 0,o),l=c.bind(void 0,o);const m=e.reduce(((e,t)=>(t.updated&&e.push(...t.updated),e)),[]);a.dispatchEvent("onUpdateNotification",[m]);const T=[];for(;e.length;){var E=e.shift();try{E&&E.deleted&&E.deleted.forEach(p),E&&E.shared&&E.shared.forEach(r),E&&E.unshared&&E.unshared.forEach(l),E&&E.updated&&i.splice.apply(i,[1,0].concat(E.updated.filter(a.updateFunc,{masksToFetch:t,uniqueMap:s}))),E&&E.created&&E.created.forEach((e=>{u(e),T.push(e)})),E&&E.updatedRollUp&&E.updatedRollUp.forEach(h)}catch(e){console.error(e)}}if(a.dispatchEvent("onAllCreateNotification",[T]),i.length)for(var g=Object.keys(t),A=g.length,C=0;C<A;C++){var _=g[C],f=t[_];n.complete(void 0,f,{batchGenerator:o,mask:_,animate:!0})}for(;o.requests.length>50;){var D=o.requests.splice(0,50),S=n.getBatchGenerator();S.requests=D,S.sendBatch({waitOnInFlightRequests:!0})}o.sendBatch({waitOnInFlightRequests:!0})},a.NOTIFICATION_PROCESSING_DELAY=2e3,a})),define("DS/E6WCommonApps/Models/RDFTaskModel",["UWA/Core","UWA/Array","UWA/Class/Collection","DS/Foundation2/FoundationV2Data","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/Collections/ResultCollection","DS/RDFFoundation/Collections/UserCollection","DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/MaskUtils","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/MemberUtils","DS/RDFFoundation/Collections/CollectionTaggerHelper","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonApps/Models/ScheduleElementModel","DS/E6WCommonApps/Models/TaskModelMixin","DS/E6WCommonApps/Models/FileManagementMixin","DS/E6WCommonApps/XTaskScope","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/E6WDefaultCalendarInstance","DS/E6WCommonApps/Models/AddTaskMixin","DS/E6WCommonApps/Models/NoAccessModel","DS/E6WCommonApps/Models/CalendarModel","DS/E6WCommonApps/LiveUpdateUtils","DS/E6WCommonApps/TaskUtils","DS/E6WCommonApps/Preferences","DS/E6WCommonApps/Models/TaskTreeNodeModel","DS/E6WCommonApps/Checklist/ChecklistItemCollection","DS/E6WCommonApps/Utils/RapidUtils","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonApps/assets/nls/CollaborativeTasksNLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,E,g,A,C,_,f,D,S,R,y,v,M,I,b,O){"use strict";var N=function(e){var t=b.get(e);return t===e&&(t=O.get(e)),t===e&&(t=s.getWidgetConstant.apply(this,arguments)),t},P=A.dslcMapping;delete P["dspol:modificationDate"];var W=d.inverseMapping(P),F=function(e){e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)},k="state",L="priority",U="dsplan:estimatedEndDate",w=A.STATE_FOR_DISPLAY_ATTR,x="dsplan:MVMask.Task.Property",V=A.REMINDER_DAYS,j=A.SUBTASK_ATTR,B=(A.HAS_CHECKLIST_ATTR,{"dsxplan:Open":"To Do","dsxplan:InProgress":"In Progress","dsxplan:Done":"Done"}),H={"dsxplan:Low":"Low","dsxplan:Medium":"Medium","dsxplan:High":"High","dsxplan:Urgent":"Urgent"},G={Low:N("E6WCommonApps.Label.Low"),Medium:N("E6WCommonApps.Label.Medium"),High:N("E6WCommonApps.Label.High"),Urgent:N("E6WCommonApps.Label.Urgent")},Y={Low:"dsxplan:Low",Medium:"dsxplan:Medium",High:"dsxplan:High",Urgent:"dsxplan:Urgent"},K={"To Do":"dsxplan:Open","In Progress":"dsxplan:InProgress",Done:"dsxplan:Done"},J={"dsxplan:Open":"Assign","dsxplan:InProgress":"Active","dsxplan:Done":"Complete"},q={Create:"dsxplan:Open",Assign:"dsxplan:Open",Active:"dsxplan:InProgress",Review:"dsxplan:InProgress",Complete:"dsxplan:Done"},X={Open:"To Do","In Progress":"In Progress",Done:"Done"},$={"To Do":"Open","In Progress":"In Progress",Done:"Done"},z={Open:"Assign","In Progress":"Active",Done:"Complete"},Q={Create:"Open",Assign:"Open",Active:"In Progress",Review:"In Progress",Complete:"Done"},Z={"dsplan:hasAssignee":T.ASSIGNEESATTR,"dskern:owner":T.OWNERATTR,"dsplan:actualStartDate":"actualStartDate","dspol:modificationDate":"modified","dsplan:hasAttachment":"references","dsplan:actualDeliverable":"deliverables","dsplan:percentageCompletion":"percentComplete"};Z[U]=T.DUEDATEATTR;var ee=d.inverseMapping(Z),te={"dsxplan:estimatedEndDate":{format:"UTC",itemType:"field",name:"dsxplan:estimatedEndDate"},"dsxplan:modificationDate":{format:"UTC",itemType:"field",name:"dsxplan:modificationDate"}},ne="DS/E6WCommonApps/assets/img/I_ProjectPlanningTask_22.png",se="DS/E6WCommonApps/assets/img/I_WeDoTask_22.png",ie=m.extend({writeMask:"dsplan:MVMask.Task.Complex",liveUpdateCreateMask:"dsplan:MVMask.Task.CollaborativeTasks.Complex",TASK_RELATION_ATTR:j,_propertyDictionary:{solveCounter:{volatility:!0},toConstraints:{volatility:!0},fromConstraints:{volatility:!0},dueDateCategory:{volatility:!0},dueDate:{date:!0},modified:{date:!0},actualStartDate:{date:!0},_xplanSubscribed:{volatility:!0},dateConstraints:{volatility:!0},"dsxplan:workscopeParent":{inverseProperty:"dsxplan:hasTask",inversePropertyIsCollection:!0},"dsxplan:taskParent":{inverseProperty:"dsxplan:hasSubtask",inversePropertyIsCollection:!0},"dsxplan:backlogParent":{inverseProperty:"dsplan:hasBacklogTask",inversePropertyIsCollection:!0},"dsxplan:hasScheduleError":{volatility:!0},"dsplan:hasScheduleError":{volatility:!0},hasFiles:{volatility:!0},atRisk:{volatility:!0},readyToStart:{volatility:!0},late:{volatility:!0},compressionLevel:{volatility:!0},_tagData:{volatility:!0},explicitTagsData:{volatility:!0},"dsplan:workscopeParentForAll":{volatility:!0},"dsxplan:hasWorkContext":{inverseProperty:"dsxplan:hasContributingElements",inversePropertyIsCollection:!0},"dsplan:hasChecklistItem":{inverseProperty:A.CHECKLIST_PARENT_ATTR},"dsxplan:hasAssignee":{inverseProperty:A.ASSIGNED_TASK_ATTR,inversePropertyIsCollection:!0}},idAttribute:"@id",_uwaClassName:"RDFTaskModel",_relations:[{key:"rdf:type",relatedCollection:o},{key:"dsxplan:hasAssignee",relatedCollection:a},{key:"dsplan:hasChecklistItem",relatedCollection:M}],_collectionConstructor:o,init:function(t,n){const s=e.clone(t||{},!1);s["dsplan:jsType"]=s["dsplan:jsType"]||s["dsxplan:jsType"]||"dsplan:Task",this._parent(s,n)},getObjectType:function(){return A.TASK},getTreeNodeModel:function(){return this._treeNodeModel?this._treeNodeModel.show():this._treeNodeModel=new v({grid:{correspondingModel:this}}),this._treeNodeModel},getParent:function(){var e=this.get(A.COMMON_TASK_PARENT_ATTR);if(e&&"dsplan:DummyProject"!==e.id)return e},getParentWorkscope:function(){return this.getProjectParent(this)},getProjectParent:function(){const e=this.getParent&&this.getParent();return e?u.isProject(e.get(A.PROJECT_TYPE))||"WorkscopeModel"===e._uwaClassName?e:e&&e.getProjectParent?e.getProjectParent():void 0:this._nearestProjectParent},getTagPrefix:function(){return this.hasWeDoTagData()?d.WEDO_TAGGER_URI_PREFIX:d.TAGGER_URI_PREFIX},getAttachments:function(){return this.getCollectionAttribute(A.ATTACHMENT_ATTR,{"@mask":"dsplan:MVMask.Task.Property"})},getDeliverables:function(){return this.getCollectionAttribute(A.ACTUAL_DELIVERABLE_ATTR,{"@mask":"dsplan:MVMask.Task.Property"})},setup:function(){var t=this;this.nbInFlightRequests=0,this._parent.apply(this,arguments);var n={};n["onChange:"+A.ACTUAL_START_DATE]=this._clearStartDateCachedValue,n["onChange:"+A.STARTDATE_ATTR]=this._clearStartDateCachedValue,n["onChange:"+A.STATE_ATTR]=this._clearStartDateCachedValue;var s=this.getParent();s&&this.listenTo(s,"onChange:title",(function(){this.dispatchEvent("onChange",[this])})),this.listenTo(this,n),this.listenTo(this,"onReset",this._filterDatabyScope),this.listenTo(this,"onChange:"+this.ASSIGNEESATTR,(function(){this._filterDatabyScope()})),this.listenTo(this,"onChange:"+A.OWNER_ATTR,(function(){this._filterDatabyScope()})),this.listenTo(this,"onChange:"+A.PRIORITY_ATTR,(function(t,n,s){var i=e.clone(s||{},!1),o=n&&H[n["@id"]||n.id];!i.silent&&t.dispatchEvent("onChange:"+L,[t,o,i]),p.dispatcher.dispatchEvent("refreshTagger",[t,"ds6w:why/ds6w:priority",N("E6WCommonApps.Label."+o)])})),Object.keys(Z).forEach((function(e){t.listenTo(t,"onChange:"+e,(function(t,n,s){s&&s.silent||t.dispatchEvent("onChange:"+Z[e],arguments)}))})),this.listenTo(this,"onChange:"+this.DUEDATEATTR,(function(e,t,n){var s=new Date(this.previousAttributes()["dsxplan:estimatedEndDate"]),i=this.dueDateCategory(s),o=this.dueDateCategory(t);n.silent||i===o||e.dispatchEvent("onChange:"+this.DUEDATECATEGORY,arguments)}));var i=function(){var e=this.get(A.ACTUAL_DELIVERABLE_ATTR),t=e?e.length:0,n=this.get(A.ATTACHMENT_ATTR),s=t+(n?n.length:0)>0;s!==this.get("hasFiles")&&this.set("hasFiles",s)};this.getAttachments(),this.getDeliverables(),this.listenTo(this,"onChange:"+A.ACTUAL_DELIVERABLE_ATTR,i),this.listenTo(this,"onChange:"+A.ATTACHMENT_ATTR,i),this.listenTo(this,"onChange:"+A.PARENT_ATTR,(function(e,t){this===e?t||(this.parentId=void 0,this.parentConstructor=void 0):console.error("invalid onChange parent to be checked")})),this.getSubtasks(),Object.defineProperty(this,"nonWorkingDayIterator",{get:()=>this.getProjectParent()?this.getProjectParent().getNonWorkingDayIterator():C.prototype.getInstance()})},getNonWorkingDayIterator:function(){return this.nonWorkingDayIterator},getDefaultImage:function(){return this.isWedo()?require.toUrl(se):require.toUrl(ne)},onChangeState:function(e,t,n){var s,i;window.enoviaServer&&enoviaServer.useFD01CodeFor3DPlan?(s=X[t],i=z[t]):(s=t&&B[t["@id"]||t.id],i=J[t]);var o=A.STATE_ATTR;this.isDSLC()&&(o=this.dslcMapping[A.STATE_ATTR]),B[this.previousAttributes()[o]]===s||n.silent||(this.dispatchEvent("onChange:"+w,[e,s,n]),this.dispatchEvent("onChange:"+k,[e,i,n]))},addNewCollectionData:function(e){const t="dsxplan:hasSubtask"===e&&!this._collections[e],n=this._parent.apply(this,arguments);return t&&(Object.defineProperty(n,"loaded",{get:()=>this.hasDataForMask("dsplan:MVMask.Task.Complex.All",{checkFetching:!0})||this.hasDataForMask("dsplan:MVMask.Task.Apollo")}),Object.defineProperty(n,"models",{get:()=>n.toArray()}),n.load=e=>I.fetchTasks(this,e),n.getSize=()=>n.length,n.getSequenceOrder=e=>e.get(A.SEQUENCE_ORDER_ATTR),n.comparator=(e,t)=>R.comparator(e,t)),n},getSubtasks:function(){var e=this.getCollectionAttribute(j,{mask:"dsplan:MVMask.Task.Complex",detailsMask:"dsplan:MVMask.Task.Basic"});const t=function(){const t=[];return e&&e.length&&e.forEach(((e,n)=>{t.push(...e.getToConstraints().toArray())})),t}();return t&&t.length>0&&t.forEach(((e,t)=>{e.updateParentWorkscopes({forceDispatchEvent:!0})})),e},getAllTaskModels:function(){return[this,...this.getAllSubTasks()]},getAllSubTasks:function(){let e=[];return this.getSubtasks().forEach((t=>{e=[...e,t,...t.getAllSubTasks()]})),e},getSiblingCollection:function(){var t=this.get(A.COMMON_TASK_PARENT_ATTR),n=new o;return t&&(n=e.is(t.getTasks,"function")&&t.getTasks()||e.is(t.getSubtasks,"function")&&t.getSubtasks()),n},hasSubtasks:function(){var e=this.getSubtasks();return Boolean(e.length||e.hasMoreItems())},updateReadyToStart:function(){this.set("readyToStart",this.isReadyToStart())},updateAtRisk:function(){this.set("atRisk",this.isAtRisk())},updateLate:function(){this.set("late",this.isLate())},updateCompressionLevel:function(){this.set("compressionLevel",this.getCompressionLevel())},calculateAndSetUpListenersForVisualAttributesIfNeeded:function(){void 0===this.get("readyToStart")&&(this.updateReadyToStart(),this.listenTo(this,"onChange:"+A.STATE_ATTR,this.updateReadyToStart),this.listenTo(this,"onChange:"+A.STARTDATE_ATTR,this.updateReadyToStart)),void 0===this.get("atRisk")&&(this.updateAtRisk(),this.listenTo(this,"onChange:"+k,this.updateAtRisk),this.listenTo(this,"onChange:"+this.DUEDATEATTR,this.updateAtRisk),this.listenTo(this,"onChange:"+A.ACTUAL_START_DATE,this.updateAtRisk),this.listenTo(this,"onChange:"+A.STARTDATE_ATTR,this.updateAtRisk),this.listenTo(this,"onChange:"+A.COMPLETE_PERCENT_ATTR,this.updateAtRisk),this.listenTo(this,"onChange:"+A.DURATION_MIN,this.updateAtRisk),this.listenTo(this,"onChange:"+A.DURATION_MAX,this.updateAtRisk)),void 0===this.get("late")&&(this.updateLate(),this.listenTo(this,"onChange:"+k,this.updateLate),this.listenTo(this,"onChange:"+this.DUEDATEATTR,this.updateLate),this.listenTo(this,"onChange:"+A.DURATION_MIN,this.updateLate),this.listenTo(this,"onChange:"+A.DURATION_MAX,this.updateLate)),void 0===this.get("compressionLevel")&&(this.updateCompressionLevel(),this.listenTo(this,"onChange:"+A.DURATION_MIN,this.updateCompressionLevel),this.listenTo(this,"onChange:"+A.DURATION_MAX,this.updateCompressionLevel),this.listenTo(this,"onChange:"+A.DURATION_ESTIMATED,this.updateCompressionLevel))},isProjectTask:function(){return!1},isRouteTask:function(){return!1},hasExternalPanel:function(){return!1},isRDFTask:function(){return!0},isIteropTask:function(){return!1},isWedo:function(){return Boolean(u.isWedoTask(this.get("dsxplan:jsType"))||this.get(A.PARENT_HAS_SWYM_COMMUNITY))},getFonticonValue:function(){return"fonticon-plan-task"},hasWeDoTagData:function(){return!!this.tagsData&&this.tagsData.filter((e=>"ds6w:what/ds6w:type"===e.sixw&&"swym:WeDo"===e.object)).length>0},dataForRendering:function(){var e=this._parent.apply(this,arguments);return e.name=this.get(A.DSLC_TITLE_ATTR),e.image=this.get("dsplan:hasThumbnail")||this.get("image"),e.physicalId=this.get("physicalId"),e.percentComplete||(e.percentComplete=0),e},createNodeData:function(){let t=this._parent.apply(this,arguments);return e.merge(t,{icon:this.isWedo()?require.toUrl(se):require.toUrl(ne),nodeType:"task",hasChildren:I.hasSubtasks(this)||this.hasSubtasks()}),t},isLeanTask:function(){return Boolean(this.get(A.PARENT_HAS_LEAN_BOARD))},isStandaloneTask:function(){return Boolean(!this.get(A.HAS_PARENT_ATTR))},subscriptionsEnabled:function(){return!1},getCustomFields:function(){},isInCurrentScope:function(){if(this.noFilter)return!0;var e=g.getScope(),t=g.getCollection();if(g._scopeType&&g._scopeType.indexOf("swym")>-1||g.isAgileWorkContext())return!0;if(g.isScopeRDF()&&!e.ownsOrContainsTask(this,t))return!1;if("all"===g.getFilter()&&g.isScopeRDF())return!0;if("candidateAssignee"===g.getFilter())return!0;var n=this._isOwnedByOrAssignedToCurrentUser();return!(g.getScopeId()||!n)||!(!g.isScopeRDF()&&!g.isAgileWorkContext()||!n)},_hasWorkscopeParent:function(){let e=this.get("dsxplan:workscopeParent");return!!e&&"dsplan:DummyProject"!==e.id},_isAssignedToCurrentUser:function(){var e,n,s=this.hasFetchedAttribute("dsxplan:hasAssignee");if(s){var i=this.getAssignees().toArray().map((function(e){if("foaf:Person"===e.get("dsxplan:jsType"))return e.get("dsaccess:accountName",{noMapping:!0});"foaf:Group"===e.get("dsxplan:jsType")&&(n=!0)}));e=t.detect(i,(function(e){return e&&e.toUpperCase()===window.enoviaServer.user.toUpperCase()}))}return Boolean(!s||e)||n},_isOwnedByCurrentUser:function(){var e,t=this.hasFetchedAttribute(A.OWNER_ATTR);if(t){var n=this.get(A.OWNER_ATTR);if(n){var s=n.get("dsaccess:accountName");e=u.isLoggedInUser(s)}}return Boolean(!t||e||this.isNew())},_isOwnedByOrAssignedToCurrentUser:function(){return this._isOwnedByCurrentUser()||this._isAssignedToCurrentUser()},_filterDatabyScope:function(t){var n=this;g.getCollection()&&!g.isScopeRDF()&&e.Utils.setImmediate((function(){var e=g.getCollection();e&&!n.isInCurrentScope()&&e.remove(n,{dontRegisterChange:!0}),"function"==typeof t&&t()}))},getValidTypes:function(){var e=this.isDSLC()?"dsxplan:hasTaskVocabulary":A.TASK_VOCABULARY_ATTR;return this._parent(e)},get:function(e){var t=Array.prototype.slice.call(arguments,0),n=ee[e]||e;t[0]=n;var s=this._parent.apply(this,t),i=this._propertyDictionary[e];if(i&&i.date){return s?new Date(s):void 0}if(!s&&"dsplan:hasAssignee"===n){var o=_.RapidRDFModelRegistry?_.RapidRDFModelRegistry.getRapidModelByURI(this.id):void 0;if(!o)return s;if(s=s||[],o&&o.assigneeIds&&o.assigneeIds.length)for(var a=o.assigneeIds,l=a.length,p=0;p<l;p++){var m=d.getObjectForAdding(r,a[p],{mask:c.getPersonMask(),attrs:{"dsaccess:accountName":c.addIamToURI(h.getContextUser())}});s.push(m)}}return n===e&&(s=this._getAttributeValue(e,s)),"source"===n&&u.isWedoTask(this.get(A.JS_TYPE_ATTR))&&(s="swym"),"card_icon"===n&&(s=this.isWedo()?require.toUrl("DS/E6WCommonApps/assets/img/I_WeDoTask_16.png"):require.toUrl("DS/E6WCommonApps/assets/img/I_ProjectPlanningTask_16.png")),"endDate"===n&&(s=this.getEndDate()),s},getParentInverseProperty:function(){const e=this.get(A.PARENT_ATTR)?A.PARENT_ATTR:A.TASK_PARENT_ATTR;return this._propertyDictionary[e].inverseProperty},_getParentProjectOrTask:function(e){var t=this.get(A.PARENT_ATTR),n=this.get(A.TASK_PARENT_ATTR);return n||(t||(!this.hasFetchedAttribute(A.PARENT_ATTR)&&!this.hasFetchedAttribute(A.TASK_PARENT_ATTR)||this.isStandaloneTask()||this.get("dsxplan:backlogParent")?e:new f))},_getAttributeValue:function(e,t){switch(e){case"image":return this.getIconURL();case"dsplan:actualType":case"dsxplan:actualType":var n=t;return n?{actualValue:t.id,displayValue:n.get("title")}:null;case"dsxplan:vocabularyType":t||(t="dsplan:Task");break;case k:var s=this.get(A.STATE_ATTR);return s&&(t=window.enoviaServer&&enoviaServer.useFD01CodeFor3DPlan?z[s]:J[s["@id"]||s.id||s]),t;case w:var i=this.get(A.STATE_ATTR);return this.getStateForDisplayValue(i);case this.DUEDATECATEGORY:return this.dueDateCategory(this.get(this.DUEDATEATTR));case this.REFERENCEATTR:case"deliverables":return[];case A.PARENT_ATTR:const e=t||m.prototype.getParent.call(this);return e instanceof ie?void 0:e;case A.COMMON_TASK_PARENT_ATTR:return this._getParentProjectOrTask(t);case L:return this.getPriorityValue();case"_hasProcessModelButNoInstance":return this.get(A.GOVERNING_PROCESS_MODEL_ATTR)&&!this.get(A.GOVERNING_PROCESS_INSTANCE_ATTR)}return t},getStateForDisplayValue:function(e){let t;return e&&(t=enoviaServer.useFD01CodeFor3DPlan?X[e]:B[e["@id"]||e.id||e]),t},getPriorityValue:function(){var e=this.get(A.PRIORITY_ATTR);return H[e&&e.id]},getPriorityValueNLSString:function(){return G[this.getPriorityValue()]},getFieldDef:function(e){return te[e]},addObjects:function(e,t){var n=Array.prototype.slice.call(arguments,0);return n[1]=this.rdfCollabTaskInverseMapping[t]||t,this._parent.apply(this,n)},set:function(){var t=u.setHelper.apply(this,arguments),n=e.clone(t.attrs||{},!1),s=e.clone(t.options||{},!1);if(n){n.hasOwnProperty(k)&&(n[A.STATE_ATTR]=enoviaServer.useFD01CodeFor3DPlan?Q[n[k]]:d.getObjectForAdding(i,q[n[k]]),delete n[k]),n.hasOwnProperty(w)&&(n[A.STATE_ATTR]=enoviaServer.useFD01CodeFor3DPlan?$[n[w]]:d.getObjectForAdding(i,K[n[w]]),delete n[w]),n.hasOwnProperty(this.DUEDATECATEGORY)&&(n[this.DUEDATEATTR]=this.dueDateCategory2DueDate(n[this.DUEDATECATEGORY]),delete n[this.DUEDATECATEGORY]),n.hasOwnProperty(this.DUEDATEATTR)&&this._processDueDate(n),!n[A.STATE_ATTR]||"dsxplan:InProgress"!==n[A.STATE_ATTR].id&&"dsxplan:Done"!==n[A.STATE_ATTR].id||(s.dontAdjustDates=!0),n.hasOwnProperty(V)&&n[V]&&(n[V]=parseInt(n[V])),s.parse||s.dontAdjustDates||this._adjustStartAndEndDates(n,s),n.hasOwnProperty(A.DSLC_TITLE_ATTR)&&void 0!==n[A.DSLC_TITLE_ATTR]&&(n[A.DSLC_TITLE_ATTR]=n[A.DSLC_TITLE_ATTR].substring(0,128)),n.hasOwnProperty(L)&&(n[A.PRIORITY_ATTR]=d.getObjectForAdding(i,Y[n[L]]),delete n[L]),n.hasOwnProperty(A.SEQUENCE_ORDER_ATTR)&&(!isNaN(n[A.SEQUENCE_ORDER_ATTR])&&n[A.SEQUENCE_ORDER_ATTR]||delete n[A.SEQUENCE_ORDER_ATTR]);var o={dontRegisterChange:!0};if(n.hasOwnProperty("dsxplan:backlogParent")&&(this.getParent()&&this.getParent().getTasks&&this.getParent().getTasks().remove(this,o),this._parent("dsxplan:workscopeParent",void 0,o)),n.hasOwnProperty(A.PARENT_ATTR)){const e=this.get("dsxplan:backlogParent");e&&(this._parent("dsxplan:backlogParent",void 0,o),e.getBacklogTasks().remove(this,o))}return this._parent(n,s)}return this._parent.apply(this,arguments)},_processDueDate:function(t){var n=t[this.DUEDATEATTR];if(delete t[this.DUEDATEATTR],n=(n=e.is(n,"string")?parseInt(n,10):n)instanceof Date?n:new Date(n),t[U]=n,!this.isStarted()){var s=new Date(this._attributes["dsxplan:estimatedEndDate"]).getTime()-new Date(this._attributes["dsxplan:estimatedStartDate"]).getTime(),i=new Date(n).getTime()-s;t["dsplan:estimatedStartDate"]=new Date(i)}var o=!isNaN(n);t[A.USER_DEFINED_START_DATE_ATTR]=o,t[A.USER_DEFINED_END_DATE_ATTR]=o},_adjustStartAndEndDates:function(t,n){var s=this,i=e.clone(n||{},!1);i.attrs=t;var o=function(e,n,o,a){var r=t[e],l=t[n];if(r||l){var d=r||s.getStartDate(),c=l||s.getEndDate(),p=s._getDatesWithAdjustedHours(r,l,d,c,o,a,i);(i.adjustStartDate||r||p.end<new Date(d))&&(t[e]=p.start.toISOString()),(i.adjustEndDate||(l&&!s.isStandaloneTask()||p.start>new Date(c))&&!s.isInProgress())&&(t[n]=p.end.toISOString())}},a=this.isStartDateFixed(t[A.USER_DEFINED_START_DATE_ATTR]),r=this.isEndDateFixed(t[A.USER_DEFINED_END_DATE_ATTR]);if(t[A.STARTDATE_ATTR]||t[A.ENDDATE_ATTR]){o(A.STARTDATE_ATTR,A.ENDDATE_ATTR,a,r);let e=this.getParent&&this.getParent()&&this.getParent().id;(a||this.get(A.ACTUAL_START_DATE))&&r&&this.calculateAndSetDuration(e,{startDate:t[A.STARTDATE_ATTR],endDate:t[A.ENDDATE_ATTR]})}(t[A.ACTUAL_START_DATE]||t[A.ACTUAL_END_DATE])&&o(A.ACTUAL_START_DATE,A.ACTUAL_END_DATE,a,r)},_getDatesWithAdjustedHours:function(e,t,n,s,i,o,a){var r;return n&&s?(r={start:new Date(n),end:new Date(s)},this.adjustDatesBasedOnDuration(r,i,o,a)):r={start:new Date(e),end:new Date(t)},r},toJSON:function(t){var n,s=e.clone(t||{},!1);if(s.attributes&&s.dataForRendering){n=Object.create(null);for(var i=e.clone(s.attributes,!1),o=i.length,a=0;a<o;a++){var r=i[a],l=ee[r];n[r]=!0,l&&(n[l]=!0,i.push(l))}s.attributes=i}var d=this._parent(s);if(s.dataForRendering||delete d.dueDateCategory,s.dataForRendering){var c=!n,p=this,h=function(e){if(c||n[e]){var t=p.get(e);t&&(d[e]=t)}};if(c||n[A.PARENT_ATTR]){var m=this.get(A.PARENT_ATTR);if(m){var T=s.ancestors;T||(s.ancestors=T={}),T[m.id]=!0,d[A.PARENT_ATTR]=m.toJSON(s)}}h(k),h(this.DUEDATEATTR),h(this.DUEDATECATEGORY),h("modified"),h("actualStartDate"),h("canEdit"),h(L),d.image=this.get("dsplan:hasThumbnail")||this.get("image"),d.id=this.id,Object.keys(ee).forEach((e=>{(c||n[e])&&(d[e]=d[ee[e]])})),h(w),d.date=new Date(this.getEndDate())}for(var E=Object.keys(d),g=E.length,C=0;C<g;C++){var _=E[C],f=d[_];f instanceof Date&&(d[_]=f=u.dateForJSON(f,"UTC",this.dateHelper,t))}return d.physicalId=this.get("physicalId"),d},getWorkDayLength:function(){return u.wrapError((()=>this.nonWorkingDayIterator?.getWorkDayLength()),(()=>y.getWorkHours()))},getCreationDate:function(){return this.get(A.CREATION_DATE_ATTR)},getEarliestStartDate:function(){const e=this.get(A.ACTUAL_START_DATE),t=this.get(A.STARTDATE_ATTR);return e<t?e:t},getLatestEndDate:function(){const e=this.get(A.ACTUAL_END_DATE),t=this.get(A.ENDDATE_ATTR);return e>t?e:t},getStartAndFinishDates:function(t){let n=e.clone(t||{},!1);const s=n.useEarliestAndLatestForTasks?this.getEarliestStartDate():this.getStartDate(n),i=n.useEarliestAndLatestForTasks?this.getLatestEndDate():this.getEndDate(n);return{start:new Date(s),finish:new Date(i)}},getStartDateAttr:function(t){return e.clone(t||{},!1).planned||!this.isStarted()?ie.STARTDATE_ATTR:A.ACTUAL_START_DATE},getStartDate:function(){var e=this.getStartDateAttr();return this._changing&&this.hasChanged(e)&&this._clearStartDateCachedValue(),this._startDate||(this._startDate=this.get(e)),this._startDate},setStartDate:function(e,t){this.isStarted()&&e>new Date||this._setDateAttribute(this.getStartDateAttr(),e,t)},_clearStartDateCachedValue:function(){delete this._startDate},getEndDateAttribute:function(){return this.isComplete()?A.ACTUAL_END_DATE:ie.ENDDATE_ATTR},getEndDate:function(){return this.get(this.getEndDateAttribute())},setEndDate:function(e,t){this.isComplete()&&e>new Date||this._setDateAttribute(this.getEndDateAttribute(),e,t)},getPercentComplete:function(){return this.get("dsplan:percentageCompletion")||0},getDurationMinAsDays:function(){return this.getDurationAttributeAsDays(A.DURATION_MIN)},getDurationMaxAsDays:function(){return this.getDurationAttributeAsDays(A.DURATION_MAX)},getDurationAttributeAsDays:function(e){var t=this.get(e)||1;return t=t&&this.getDaysAsUnit(t)},getSuggestedDuration:function(){var e=this.getDurationMinAsDays(),t=this.getDurationMaxAsDays();return void 0===e?t:void 0===t?e:(e+t)/2},getSuggestedOffset:function(){var e=this.getDurationMinAsDays(),t=this.getDurationMaxAsDays();return void 0===e||void 0===t?0:(t-e)/2},getEstimatedDuration:function(){var e=this.get(A.DURATION_ESTIMATED);return e&&(e=this.getDaysAsUnit(e)),e},getAssignees:function(t){return this.getCollectionAttribute(A.ASSIGNEE_ATTR,e.merge({detailsMask:"dsplan:MVMask.Person.Complex"},t||{}))},isStoryTask:function(){return d.isStoryTask(this)},isStarted:function(){var e=this.get(A.STATE_ATTR);if(window.enoviaServer&&enoviaServer.useFD01CodeFor3DPlan)return"Done"===e||"In Progress"===e;var t=e&&(e.id||e["@id"]||e);return t===A.STATE_DONE||t===A.STATE_IN_PROGRESS},isInProgress:function(){var e=this.get(A.STATE_ATTR);return window.enoviaServer&&enoviaServer.useFD01CodeFor3DPlan?"In Progress"===e:(e&&(e.id||e["@id"]||e))===A.STATE_IN_PROGRESS},isFixed:function(){return this.isStartDateFixed()||this.isEndDateFixed()},hasDateConstraint:function(){return this.isStartDateConstraint()||this.isEndDateConstraint()},isStartDateConstraint:function(){return Boolean(this.get(A.START_DATE_MIN_ATTR)||this.get(A.START_DATE_MAX_ATTR))},isEndDateConstraint:function(){return Boolean(this.get(A.END_DATE_MIN_ATTR)||this.get(A.END_DATE_MAX_ATTR))},isStartDateFixed:function(e){return Boolean(e)||this.get(A.USER_DEFINED_START_DATE_ATTR)},isEndDateFixed:function(e){return Boolean(e)||this.get(A.USER_DEFINED_END_DATE_ATTR)},getPropertyMask:function(){return x},fetchForProperty:function(t){let n=e.clone(t||{},!1);var s=this;let i;var o;i=this.hasFetchedAccessData()?n.batchBuilder||d.getBatchGenerator():n.batchBuilder?this.getAccessBatch({batchBuilder:n.batchBuilder}):this.getAccessBatch(),o=i.ajax,s.isWedo()?s.fetch({method:"POST",type:"json",ajax:o,url:d.expandUrl("invoke/dsxplan:fetchWedo")+"?$mask="+s.getPropertyMask(),data:JSON.stringify([s.id])}):s.fetch({ajax:o,mask:s.getPropertyMask&&s.getPropertyMask(),onlyIfNeeded:!0});const a=this.getProjectParent(this.getParent());a&&a.fetch({mask:"dsplan:MVMask.WorkPackage.CalendarOnly",onlyIfNeeded:!0,ajax:i.ajax}),this.getParent()&&!e.is(this.getParent()._accessModify)&&this.getParent().getAccessBatch&&this.getParent().getAccessBatch({batchBuilder:i}),this._nearestProjectParent||d.request(d.expandUrl("invoke/dsxplan:getNearestProject")+"?$mask=dsplan:MVMask.WorkPackage.Property",{method:"POST",type:"json",data:JSON.stringify([d.shortToLongURI(this.id)]),onComplete:e=>{let t=JSON.parse(e["@value"]);if(t["@id"]=d.removeBracketLongURI(t["@id"]),t["dsxplan:jsType"]=t["dsxplan:jsType"]||t["dsplan:jsType"],this._nearestProjectParent=d.getExistingAndMerge(t,{parse:!0}),!this._nearestProjectParent){const t=d.getModelConstructor(e);t&&(this._nearestProjectParent=new t(e,{parse:!0}))}}}),n.batchBuilder||i.sendBatch()},getCompressionLevel:function(){var e=0;if(!this.isComplete()&&!I.hasSubtasks(this)){var t=this.getSuggestedDuration(),n=this.getEstimatedDuration(),s=this.getSuggestedOffset();n&&n>t?e=-1:n&&n<t&&(e=n<t-s/2?2:1)}return e},getCollectionAttributeBasedOnModel:function(e){if(e instanceof ie)return"dsxplan:hasSubtask"},getIconURL:function(){return this.isWedo()?require.toUrl(se):require.toUrl(ne)},_getStartOfWorkDay:function(e){return e?this._getUTCStartOrEndInMinutes(e):this._getUTCStartOrEndInMinutes(8)},_getEndOfWorkDay:function(e){return e?this._getUTCStartOrEndInMinutes(e):this._getUTCStartOrEndInMinutes(16)},_getUTCStartOrEndInMinutes:function(e){var t=this.getProjectParent(this.getParent()),n=t&&t.getTimezone();return n?60*e-n.get(D.OFFSET_ATTR):60*e+240},getWorkingHoursInMilliseconds:function(){return 60*this.getWorkDayLength()*60*1e3},getErrorAssigneeIds:function(){var e=this.get("dsplan:hasScheduleError"),t=[];if(e){var s=function(e){if(e.get("@id")!==A.NO_SOLVER_ERROR){var n=e.get("dsplan:errorObject");n&&n.get&&t.push(n.get("@id"))}};e instanceof n?e.forEach(s):s(e)}return t},getDaysAsUnit:function(e){var t=d.xsdDayTimeDurationToMilliseconds(e)/this.getWorkingHoursInMilliseconds();return Math.round(100*t)/100},getDefinedDuration:function(){var e=this.getSuggestedDuration();return e||this.getEstimatedDuration()},handleUnsetActualStartDate:function(e){var t=this.isDSLC()?"dsxplan:hasMaturity":"dscom:hasMaturity",n=e&&"To Do"===e[w];(n=n||"To Do"===(e&&e[t]||this.changedAttributes()[t]))&&this.get(A.ACTUAL_START_DATE)&&this.unset(A.ACTUAL_START_DATE,{silent:!0})},handleUnsetParent:function(e){if(e){var t=this.getParent(),n=t&&t.getObjectType();if(n&&n!==A.TASK&&-1!==e.indexOf(A.TASK_PARENT_ATTR)&&-1===e.indexOf(A.PARENT_ATTR)&&this.unset(A.PARENT_ATTR),!this.get(A.PARENT_ATTR)&&!this.get(A.TASK_PARENT_ATTR)){var s=this.get("toConstraints");if(s&&s.length)s.toArray().forEach((e=>{e.destroy({noServer:!0})}));var i=this.get("fromConstraints");if(i&&i.length)i.toArray().forEach((e=>{e.destroy({noServer:!0})}))}}},handleSelfAssignToInWorkTask:function(){var e=u.setHelper.apply(this,arguments).attrs||{},t=this.get(this.ASSIGNEESATTR),n=!t||0===t.length,s=e.state,i=e.stateForDisplay,o=e["dscom:hasMaturity"]&&e["dscom:hasMaturity"].id,a=e["dsplan:percentageCompletion"],r="Active"===s||"In Progress"===i||"dsxplan:InProgress"===o,l="Active"!==this.get("state")&&a>0&&a<100,d=this.isComplete&&this.isComplete();n&&(r||l)&&!d&&(this.addAssigneesById(c.addUUIDToURI(h.getContextUserUid())),this.addSelfAssignToInWorkMessage.apply(this,arguments))},save:function(){var e,t=u.setHelper.apply(this,arguments).attrs||{},n=this.getCombinedAttributes(t);n.forEach((e=>{"dsxplan:hasAttachment"!==e&&"dsxplan:actualDeliverable"!==e||this.markDeliverablesOn3DNavigate()})),this.handleUnsetActualStartDate(t),this.handleUnsetParent(n),this.handleSelfAssignToInWorkTask.apply(this,arguments),u.isWedoTask(this.get("dsxplan:jsType"))&&(e=-1!==n.indexOf(A.PARENT_ATTR)),e&&(arguments[1].mask="dsplan:MVMask.Task.Property",arguments[1].onComplete=function(e){e.getParent()&&u.displaySuccess(N("E6WCommonApps.Alert.WedoAdded"))}),t.hasOwnProperty(A.DURATION_ESTIMATED)&&S.addToIgnoreLiveUpdateMap(this),this._parent.apply(this,arguments)},isAttributeImpactingSolve:function(e,t){var n=this._parent.apply(this,arguments);if(!n&&"dsxplan:percentageCompletion"===e){var s=this.get(A.STATE_ATTR),i=this.get(A.COMPLETE_PERCENT_ATTR);if(s&&(s.id===A.STATE_OPEN&&i>0||s.id===A.STATE_IN_PROGRESS&&0===i))return!0}return n},parse:function(t){var n=this.getParent();const s=this.hasFetchedAttribute(A.PARENT_ATTR)&&this.hasFetchedAttribute(A.TASK_PARENT_ATTR);var i=this._parent.apply(this,arguments);if(t&&e.is(t,"object")){var o=t["@mask"],a=l.getMask(o)||{};s&&void 0===n&&(a[A.PARENT_ATTR]&&!t[A.PARENT_ATTR]&&this.dispatchEvent("onChange:"+A.PARENT_ATTR,[this]),a[A.TASK_PARENT_ATTR]&&!t[A.TASK_PARENT_ATTR]&&this.dispatchEvent("onChange:"+A.TASK_PARENT_ATTR,[this]))}return i},adjustDatesBasedOnDuration:function(t,n,s,i){var o=e.clone(i||{},!1);const a=o.attrs;F(t.start),F(t.end);var r=(this.getDefinedDuration()||1)-1;o.resized||(n&&!s?(t.end=new Date(t.start),t.end.setDate(t.start.getDate()+r)):this.get(A.DSLC_ACTUAL_START_DATE)||!s||n?o.fromDragHandler&&s&&n&&(t.start=new Date(t.end),t.start.setDate(t.end.getDate()-r)):(t.start=new Date(t.end),t.start.setDate(t.end.getDate()-r)));var l,d=t.start;this.nonWorkingDayIterator&&(l=this.nonWorkingDayIterator._workingHours[d.getDay()]&&this.nonWorkingDayIterator._workingHours[d.getDay()].start.hours);var c=this._getStartOfWorkDay(l);t.start=new Date(Date.UTC(d.getFullYear(),d.getMonth(),d.getDate(),0,c,0));var p,u=t.end;this.nonWorkingDayIterator&&(p=this.nonWorkingDayIterator._workingHours[u.getDay()]&&this.nonWorkingDayIterator._workingHours[u.getDay()].end.hours);var h=this._getEndOfWorkDay(p);const m=a["dscom:hasMaturity"];(this.isComplete()&&!m||m&&m.id===A.STATE_DONE)&&u>new Date&&(u=new Date),t.end=new Date(Date.UTC(u.getFullYear(),u.getMonth(),u.getDate(),0,h,0))},canDelete:function(){if(u.isWedoTask(this.get(A.JS_TYPE_ATTR)))return!1;return!(this.isComplete&&this.isComplete())&&this._parent.apply(this,arguments)},isReadyToStart:function(){var e=this.get("dsxplan:hasMaturity");if(e&&"dsxplan:Open"===e.id){var t=this.get("dsxplan:estimatedStartDate");return new Date(t)-T.THRESHOLD>Date.now()}return!1},getParentAsLabel:function(){var e,t=this.getParent&&this.getParent();if(t&&this.isRDFTask()){var n=t.get("title");if(n||(n=this.get("_workscopeParent")),n){let s=N("E6WCommonApps.Label.Parent");t instanceof f||(s=u.isProject(t.get("dsxplan:jsType"))?N("emxCollaborativeTasks.Label.Project"):N("emxCollaborativeTasks.Label.ParentTask")),e={key:s,value:n}}}else this.isWedo&&this.isWedo()?e={key:N("E6WCommonApps.Label.Community"),value:this.get(A.PARENT_HAS_SWYM_COMMUNITY)&&this.get(A.PARENT_HAS_SWYM_COMMUNITY).get("title")}:this.get("_workscopeParent")&&(e={key:N("emxCollaborativeTasks.Label.Project"),value:this.get("_workscopeParent")});return e},getTransferObject:function(t){var n=this.getDragType(),s=e.clone(t||{},!1);return u.isWedoTask(n)&&(s.serviceId="swym"),this._parent(s)},_registerAsElementParent:function(e){e.parentId=this.id||this.cid,e.parentConstructor=this.constructor,e.set(A.TASK_PARENT_ATTR,this,{fromServer:!0,dontRegisterChange:!0})},_getDefaultSequenceOrderForAttribute:function(e){var t=Math.random();if(this.hasFetchedAttribute(e)){var n=this.get(e).last();n&&(void 0===(t=n.get(A.SEQUENCE_ORDER_ATTR_DSLC))&&(t=0),t+=Math.random())}return t},calculateAndSetDuration:function(t,n){var s=this,i=e.clone(n||{},!1),o=i.startDate||this.getStartDate(),a=i.endDate||this.getEndDate();i.onComplete=function(t){t&&t["@value"]&&s._setDurationOnModel(t["@value"]),i.dontSave||s.save(void 0,{onFailure:function(){u.displayError(N("E6WCommonApps.Error.SaveFailed"))}}),n&&n.onComplete&&e.is(n.onComplete,"function")&&n.onComplete.apply(this,arguments)},i.onFailure=function(){u.displayError(N("E6WCommonApps.Error.SaveFailed"))},i.data={project:t||this.getParent&&this.getParent()&&this.getParent().id,startDate:new Date(o).toISOString(),endDate:new Date(a).toISOString()},d.invokeAsLRT("dsmf:xplan.Scheduler.calculateTaskDuration",i)},_setDurationOnModel:function(e){var t=this.getDaysAsUnit(e),n=(this.getDaysAsUnit(this.get(A.DURATION_MAX))-this.getDaysAsUnit(this.get(A.DURATION_MIN)))/2;Math.abs(n)>t&&(n=t);var s=t+n,i=t-n;this.set(A.DURATION_ESTIMATED,e),this.set(A.DURATION_MIN,this.nonWorkingDayIterator.getDaysAsString(i)),this.set(A.DURATION_MAX,this.nonWorkingDayIterator.getDaysAsString(s))},parsePruneModel:function(e){this.get(A.TASK_PARENT_ATTR)&&"dsxplan:workscopeParent"===e||this._parent.apply(this,arguments)},getRDFModel:function(){return this},parseNestedCollection:function(e,t,n,s){"dsxplan:hasWorkContext"===n?(s.member&&s.member.length>0&&this.parseNestedModel(e,t,n,s.member[0]),s.member&&1===s.member.length||console.log(`Expected task to have exactly 1 member in dsxplan:hasWorkContext, but it had ${s.member&&s.member.length}`)):this._parent.apply(this,arguments)},shouldWeSolve:function(){return!(!this.get(A.PARENT_ATTR)&&(this.isWedo()||this.isLeanTask()))&&(!this.get("dsxplan:backlogParent")&&this._parent.apply(this,arguments))},getProjectActualDatesStrategy:function(){const e=this.getProjectParent(this);if(e)return e.get(A.ACTUAL_DATES_STRATEGY_ATTR)},callMarkDeliverables:function(){this.get("dsxplan:actualDeliverable")&&this.get("dsxplan:actualDeliverable").getModels().length>0&&this.markDeliverablesOn3DNavigate()},processMarkingDeliverables:function(){var e=this;u.isTask(this.getObjectType())&&(this.hasDataForMask("dsplan:MVMask.Task.Deliverables")?this.callMarkDeliverables():this.fetch({mask:"dsplan:MVMask.Task.Deliverables",onlyIfNeeded:!1,onComplete:function(){e.callMarkDeliverables()}}))}});return ie.implement(T,{fetchDeliverableParentTypes:function(e){if(!this.hasFetchedAttribute("dsxplan:hasAttachment")){const t=this._previous.bind(this,e);return new Promise(((e,n)=>{this.fetch({mask:"dsplan:MVMask.Task.ScheduleView",onComplete:function(){t().then((()=>{e()}))},onFailure:n})}))}return this._previous(e)},canAssignToSelf:function(){return!this.hasFetchedAccessData()||this._previous.apply(this,arguments)},fetchForScheduleFacet:function(e){const t=this.getSubtasks(e);!t.loading&&t.load(e)},getScheduleHeight:()=>ie.getTaskNodeHeight()-1}),ie.implement(E,_),ie.PersonRDFModel=r,ie.STARTDATE_ATTR="dsplan:estimatedStartDate",ie.ENDDATE_ATTR="dsplan:estimatedEndDate",ie.STATE_ATTR=A.STATE_ATTR,ie.getTaskNodeHeight=()=>y.getShowActualDates()?ie.TASK_NODE_HEIGHT_WITH_ACTUALS:ie.TASK_NODE_HEIGHT,ie.prototype.dslcMapping=P,ie.prototype.inverseDslcMapping=W,ie.prototype.attributeImpactingSolve=A.attributeImpactingSolve,ie.prototype.attributeImpactingSubTaskSolve=A.attributeImpactingSubTaskSolve,ie.prototype.rdfCollabTaskMapping=Z,ie.prototype.rdfCollabTaskInverseMapping=ee,Object.defineProperty(ie.prototype,"completed",{get:function(){var e=this.collection&&this.collection.getDetailsMask&&this.collection.getDetailsMask()||"dsplan:MVMask.Task.CollaborativeTasks.Complex";return this.hasDataForMask(e)&&!this.fetching}}),Object.defineProperty(ie.prototype,"extid",{get:function(){return this.cid}}),Object.defineProperty(ie.prototype,"fixed",{get:function(){return this.isFixed()}}),Object.defineProperty(ie.prototype,"fedSearchIdQuery",{get:function(){if(this.id)return this.isWedo()?'resourceid:"'+d.removeBracketLongURI(this.id)+'"':'uri:"'+d.shortToLongURI(this.id)+'"'}}),ie.ATTS={PARENT:A.PARENT_ATTR,TASK_PARENT:A.TASK_PARENT_ATTR},ie.PROPERTY_MASK=x,ie.DEFAULT_ICON=ne,ie.TASK_NODE_HEIGHT=30,ie.TASK_NODE_HEIGHT_WITH_ACTUALS=40,ie})),define("DS/E6WCommonApps/DuplicateItemUtils",["UWA/Core","DS/RDFFoundation/SecurityContextUtils","DS/E6WCommonUI/UIHelper","DS/UIKIT/Input/Toggle","DS/E6WCommonApps/Models/ConstraintModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/NoAccessModel","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/AddTaskMixin","DS/E6WCommonApps/XTaskScope","DS/E6WCommonApps/SubscribeUtil","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h){"use strict";var m=function(e){var t=u.get(e);return t===e&&(t=h.get(e)),t},T={_getDuplicateTaskModalBody:function(t){let n=t&&t.isMultiEdit;var i=e.createElement("div");return this._radio1=new s({id:"duplicateTask",name:"radio1",value:o.DUPLICATE_TASK,className:"primary",label:m(n?"E6WCommonApps.Label.CreateDuplicateTasks":"E6WCommonApps.Label.CreateDuplicateTask"),checked:!0}).inject(i),this._radio2=new s({id:"splitTask",name:"radio1",value:o.SPLIT_TASK,label:m(n?"E6WCommonApps.Label.SplitMultipleTask":"E6WCommonApps.Label.SplitTask"),className:"primary"}).inject(i),i},getAssigneeList:function(e){var t=[];return e.getAssignees&&e.getAssignees().length&&(t=e.getAssignees()),t},duplicateItem:function(t){var s=this,i=e.clone(t||{},!1),a=i.model,r=i.parentView,l=i.modal||r&&r.getSuperModal(),d=a&&a.get("title");let c,p=i.selectedModels?m("E6WCommonApps.Label.CreateDuplicateTasks"):h.replace(m("E6WCommonApps.Label.CreateDuplicateTask"),{NAME:n.escapeHTML(d)}),u=!1;if(i.selectedModels){let e=s.getAssigneeModelMap({selectedModels:i.selectedModels});c=e.assigneeModelMap,u=e.hasMultipleAssignees}else c=i.getAssignees&&i.getAssignees(a)||s.getAssigneeList(a),u=this.hasMultipleAssignees(c);let E={lModel:a,parentView:r,selectedModels:i.selectedModels,lAssigneeList:c,...i};u?l.dialog({body:T._getDuplicateTaskModalBody({isMultiEdit:i.selectedModels}),title:p,buttons:[{id:"duplicateBtn",className:"primary",value:m("E6WCommonUI.Label.Duplicate"),action:function(e){var t;s._radio1.isChecked()?t=s._radio1.getValue():s._radio2.isChecked()&&(t=s._radio2.getValue()),E.toggleValue=t,s.createDuplicate(E),e.hide()}},{id:"duplicateCancelBtn",className:"default",value:m("E6WCommonApps.Command.Cancel"),action:function(e){e.hide()}}]}):(E.toggleValue=o.DUPLICATE_TASK,s.createDuplicate(E))},createDuplicate:function(t){let n=this,s=e.clone(t||{},!1);s.selectedModels?n.createDuplicateForSelectedModels({toggleValue:s.toggleValue,selectedModels:s.selectedModels,assigneeModelMap:s.lAssigneeList}):T._createDuplicateTask(s.lModel,s.parentView,{toggleValue:s.toggleValue,assigneeList:s.lAssigneeList,...s})},hasMultipleAssignees:function(e){return e&&(e.length>1||1===e.length&&"foaf:Group"===e.at(0).get("dsxplan:jsType"))},getAssigneeModelMap:function(t){let n=this,s=e.clone(t||{},!1).selectedModels,i=new Map,o=!1;return s&&s.forEach((function(e){let t=e.getAssignees&&e.getAssignees();i.set(e,t),!o&&n.hasMultipleAssignees(t)&&(o=!0)})),{assigneeModelMap:i,hasMultipleAssignees:o}},createDuplicateForSelectedModels:function(t){let s=e.clone(t||{},!1),i=s.selectedModels,r=a.getBatchGenerator();r.iOptions=t,i&&i.forEach((function(e){let n=s.assigneeModelMap.get(e);s.toggleValue=n.length>0?t.toggleValue:o.DUPLICATE_TASK,T._createDuplicateTask(e,s.parentView,{assigneeList:n,isMultiEdit:!0,batchGenerator:r,...s})})),r.sendBatch({onComplete:()=>{let e=(r.iOptions&&r.iOptions.toggleValue)===o.DUPLICATE_TASK?m("E6WCommonApps.Label.TasksDuplicateSuccess"):m("E6WCommonApps.Label.TasksSplitSuccess");n.displaySuccess(e)},onFailure:()=>{let e=(r.iOptions&&r.iOptions.toggleValue)===o.DUPLICATE_TASK?m("E6WCommonApps.Error.TasksDuplicateFailed"):m("E6WCommonApps.Error.TasksSplitFailed");n.displaySuccess(e)}})},getDurationString:function(e){return a.millisecondsToXsdDayTimeDuration(8*parseFloat(e)*60*60*1e3)},_getDefaultDupTaskAttributes:function(e){var t=d.getDefaultTaskAttributes();return t[o.TITLE_ATTR]=e.get("title"),t[o.DESCRIPTION_ATTR]=e.get("subtitle"),t[o.DSLC_DESCRIPTION_ATTR]=e.get("dsxplan:comment"),t[o.RICH_TEXT_DESCRIPTION]=e.get("richTextDescription"),t[o.RICH_TEXT_FIELD]=e.get("dsplan:RichTextField"),t[o.DURATION_MIN]=this.getDurationString(e.getDurationMinAsDays()),t[o.DURATION_MAX]=this.getDurationString(e.getDurationMaxAsDays()),t[o.STARTDATE_ATTR]=new Date(e.getStartDate()),t[o.ENDDATE_ATTR]=new Date(e.getEndDate()),t[o.STATE_ATTR]={"@id":"dsxplan:Open"},t},_addDummyModelToCollection:function(e,t,n){t&&t.add&&t.add(e,{dontRegisterChange:!0}),n&&n.add&&n.add(e)},_createDummyModel:function(e,t){var n=this._getDefaultDupTaskAttributes(e);let s;return s=t.addTask?t.addTask(n,{parse:!0,dontRegisterChange:!0}):new l(n,{parse:!0,dontRegisterChange:!0}),s},_handleConstraintsForDuplicateTask:function(e){var t=function(e){e.updateParentWorkscopes({forceDispatchEvent:!0})};e.forEach((e=>{e.getToConstraints().forEach((e=>t(e))),e.getFromConstraints().forEach((e=>t(e)))}))},_createDuplicateTask:function(s,i,l){var d=e.clone(l||{},!1),u=d.toggleValue?d.toggleValue:"duplicate",h=d.assigneeList?d.assigneeList:[],T=a.expandUrl("invoke/dsxplan:createDuplicateTask?$mask=dsplan:MVMask.Task.Property","v1"),E=e.is(s.getParent,"function")&&s.getParent();if(E instanceof r)return n.displayError(m("E6WCommonApps.Error.NoModifyAccessOnParent"));if(!s.get("dsxplan:jsType"))return n.displayError(m("E6WCommonApps.Error.StandaloneTaskDuplicateFailed"));var g=s.getSiblingCollection(),A=E&&E.get("dsxplan:hasLeafTasks");t.isTSKContext()&&c.getCollection()&&(g=c.getCollection());var C=[];if(u===o.SPLIT_TASK)for(let e=0;e<h.length;e++){let e=this._createDummyModel(s,g);this._addDummyModelToCollection(e,g,A),C.push(e)}else{let e=this._createDummyModel(s,g);this._addDummyModelToCollection(e,g,A),C.push(e)}o.SPLIT_TASK;let _=p.subscribeActivity(m("E6WCommonUI.Label.SavingChanges"),{start:!0}),f={method:"POST",type:"json",data:JSON.stringify([{taskId:s.get("@id"),option:u,identifier:_}]),headers:{"Content-Type":"application/json"},onComplete:e=>{e.member?(this.onCompleteHandler(e,s,C,d),d.onDupTaskComplete&&d.onDupTaskComplete(C),d.onDupTaskComplete?d.onDupTaskComplete(C):!t.isTSKContext()&&this._handleConstraintsForDuplicateTask(C),s.solve(),n.trackPageEvent({eventCategory:"taskMenu",eventAction:"duplicateItem",eventLabel:"NewModelList",eventValue:C})):this.onFailedHandler(e,void 0,C)},onFailure:(e,t)=>{this.onFailedHandler(e,t,C)}};d.isMultiEdit?d.batchGenerator&&d.batchGenerator.ajax(T,f):a.request(T,f)},onCompleteHandler:function(e,t,s,i){let o=i&&i.isMultiEdit;var a,r=s.length<=1?m("E6WCommonApps.Label.TaskDuplicateSuccess"):m("E6WCommonApps.Label.TaskSplitSuccess");!o&&n.displaySuccess(r),s.forEach(((t,n)=>{a=t._mapDslcAttributes(e.member[n]),a=t.parse(a),i.parse=!0,i.noServer=!0,t.set(a,i),t._updateInverseProperties()}))},onFailedHandler:function(e,t,s){s.forEach((e=>{e.destroy({noServer:!0})}));var i=t&&t.message;i||(i=m("E6WCommonApps.Error.TaskDuplicateFailed")),n.displayError(m(i))}};return T})),define("DS/E6WCommonApps/Collections/IteropTasksCollection",["UWA/Core","UWA/Class","UWA/Class/Collection","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/IteropTaskModel","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Collections/TasksSplitCollection","DS/WAFData/WAFData","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","DS/E6WCommonUI/PlatformManager"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m){"use strict";var T="stateForDisplay",E=function(e){return e&&e.actualValue||e},g={3:"Low",2:"Medium",1:"High",0:"Urgent"},A=s.extend({model:a,_uwaClassName:"IteropTasksCollection",setAttrToSplitBy:function(e){this._attrToSplitBy=e},_doneCompleting:function(){if(this.completing=!1,this.toComplete&&this.toComplete.length){var e=this.toComplete;delete this.toComplete,this.complete(e)}},complete:function(t,n){e.clone(n||{},!1);var s=t.filter((function(t){return t instanceof a||e.is(t,"string")})).map((function(e){return e.id||e}));if(s.length)if(this.completing)this.toComplete||(this.toComplete=[]),Array.prototype.push.apply(this.toComplete,s);else{this._doneCompleting.bind(this);this.completing=!0}},setup:function(t,n){var s=Array.prototype.slice.call(arguments,0);this._TasksByAttr={},this._attrToSplitBy=T,this.extid="allTasks";var i=e.clone(n,!1);s[1]=i,this._parent.apply(this,s)},fetchIteropToken:function(e,t){var n=this,s=m.getServiceUrl("3DPassport"),i=m.getServiceUrl("businessprocess")+"/api/v2/auth/cas",o=s+"/login?service="+encodeURIComponent(i),a=p.authenticatedRequest,r=Date.now(),l={headers:{"Accept-Language":"en","content-type":"application/json",Accept:"application/json"},method:"GET",onComplete:function(s){try{var o=JSON.parse(s).access_token,l={headers:{"Accept-Language":"en","content-type":"application/json",Accept:"application/json"},data:"",method:"POST",onComplete:function(s){try{var i=JSON.parse(s).token;n.iteropBearerToken=i,n.tokenExpirationDate=r+18e5,e.call(n,t)}catch(e){t&&t.onFailure&&t.onFailure(s)}},onFailure:function(e){console.log(e),t&&t.onFailure&&t.onFailure(e)},url:i=i+"?ticket="+o};a(i,l)}catch(e){t&&t.onFailure&&t.onFailure(s)}},onFailure:function(e){console.log(e),t&&t.onFailure&&t.onFailure(e)},url:o};a(o,l)},getPriorityValue:function(e){let t=2;return 5==e?t=0:e<3?t=3:e>3&&(t=1),g[t]},tasksWithAttrValue:function(e,t){var n=this,s=t||this._attrToSplitBy,o=E(e);return this.filter((function(e){var t=E(e.get(T)),a=E(e.get(s)),r=E(e.get("dsxplan:label"));r=r?r.toLowerCase():"";var l=!n._search||i.match(n._search,r);return(s!==d.DUE_DATE_CATEGORY&&"priority"!==s||"Complete"!==t)&&(a===o&&l)}))},tasksWithAttrValueCollection:function(e,t){if(void 0===e)throw new Error("Invalid attribute value passed.");var n=t||this._attrToSplitBy,s=E(e),i=this._TasksByAttr[n];if(!i||!i[s]){var o=this.tasksWithAttrValue(e,n),a={filterAttr:n,valueForFiltering:e,parentCollection:this},r=new A.TasksSplitCollection(o,a);r.extid="tasks-"+n+"-"+s,i||(this._TasksByAttr[n]=i={}),i[s]=r}return i[s]},fetch:function(t){if(m.getServiceUrl("businessprocess",!0)){var n=e.clone(t||{},!1);void 0!==this.iteropBearerToken&&Date.now()<this.tokenExpirationDate?this.fetchCurrentIteropTasks(n):this.fetchIteropToken(this.fetchCurrentIteropTasks,n)}else t.onFailure&&t.onFailure()},fetchCurrentIteropTasks:function(e){var t=this,n=t.iteropBearerToken,s=(p.authenticatedRequest,p.proxifiedRequest),i=m.getServiceUrl("businessprocess")+"/api/v2/runtime/tasks",o={headers:{"Accept-Language":"en",Authorization:"Bearer "+n,Accept:"application/json"},method:"GET",onComplete:function(n){try{for(var s=JSON.parse(n),i=0;i<s.length;i++)0!==s[i].priority&&t.add(t.buildIteropModel(s[i]))}catch(t){return void(e&&e.onFailure&&e.onFailure())}e&&e.onComplete&&e.onComplete.apply(this,arguments)},onFailure:function(n){if(console.log(n),401==n.code&&void 0!==n.message&&n.message.startWith("Expired token"))try{t.fetchIteropToken(t.fetchCurrentIteropTasks)}catch(n){e&&e.onFailure&&e.onFailure()}else e&&e.onFailure&&e.onFailure()},url:i};s(i,o)},buildIteropModel:function(e){return new a({"@id":e.id,id:e.id,title:e.name.htmlDecode(),"dscom:hasMaturity":{"@id":"dsxplan:Open"},"dsxplan:label":e.name,stateForDisplay:"To Do",state:"Assign",references:[],deliverables:[],priority:this.getPriorityValue(e.priority),"dsxplan:jsType":"iteropTask",date:i.getIntlDateTimeFormat(e.startDate),creation:e.startDate,process:e.process,processName:e.process.name,processIdentificator:e.process.identificator,description:e.description,percentComplete:0,dueDateCategory:"NO_DATE"})},add:function(e){var t=this._parent.apply(this,arguments);return t&&(t,t instanceof a&&[t]),t}});return A.TasksSplitCollection=c.extend({model:a}),A})),define("DS/E6WCommonApps/Collections/RDFTasksCollection",["UWA/Core","UWA/Class/Collection","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/AddTaskMixin","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/Models/ComponentProxyModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/XTaskScope","DS/E6WCommonApps/TaskUtils","DS/RDFFoundation/Models/PersonRDFModel","DS/E6WCommonApps/SmartSchedulerUtils","DS/E6WCommonApps/Collections/TasksSplitCollection","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,E){"use strict";var g=Function.prototype,A="state",C=function(e){return e&&e.actualValue||e},_=n.extend({_uwaClassName:"RDFWorkscopeCollection"}),f=n.extend({model:i,_relations:{key:"scopes",relatedCollection:_},_uwaClassName:"RDFTasksCollection",comparator:function(e,t){return p.comparator(e,t)},_completeModelsInQueue:function(){let e=this.toComplete&&Object.keys(this.toComplete);if(e&&e.length){var t=this.toComplete;delete this.toComplete;let n=[],s=[];e.forEach((e=>{t[e].onlyIfNeeded?n.push(e):s.push(e)})),this.complete(n,{onlyIfNeeded:!0}),this.complete(s)}},complete:function(t,n){var s=e.clone(n||{},!1),i=t.filter((function(t){return t instanceof r||e.is(t,"string")})).map((function(e){return e.id||e}));if(i.length)if(!this.completing||n&&n.mask){var o=this;this.completing=!0,a.complete(this.model,i,{mask:n&&n.mask||this.getDetailsMask(),checkCommunity:c.isScopeSwym()&&c.getScopeId(),onComplete:function(){o.completing=!1,o._completeModelsInQueue(),n&&n.onComplete&&n.onComplete(),o.dispatchEvent("onComplete")},onlyIfNeeded:s.onlyIfNeeded,attrs:{forceDslc:!0}})}else{this.toComplete||(this.toComplete={});for(let e of i)this.toComplete[e]||(this.toComplete[e]=n)}},setAttrToSplitBy:function(e){this._attrToSplitBy=e},setIdForCreateChild:function(e){this._createChildId=e},getIdForCreateChildDSLC:function(){return this._createChildId?this._createChildId:this._parent.apply(this,arguments)},createStandaloneRDFTask:function(t){var n=e.clone(t||{},!1),s=o.getDefaultTaskAttributes();e.extend(s,n);return s[d.STATE_ATTR]={"@id":"dsxplan:Open"},new i(s)},addNewTask:function(t,n,i){var o,a=e.clone(i||{},!1);if(widget){var r={title:t,subtitle:a.createDescription,"dsxplan:durationIntervalMin":"PT86400S","dsxplan:durationIntervalMax":"PT86400S"};a&&a.extensionAttrs&&(r["dsbase:extension"]=a.extensionAttrs);var l=n||this.parentModel;o=l&&e.is(l.addTask,"function")?l.addTask(r):this.createStandaloneRDFTask(r);var d="/invoke/dsxplan:getTasks"===this.getUri()?this.currentScopeCollection:this;(!l||!e.is(l.addTask,"function")||d&&d!==l.getTasks())&&(this.add(o),o.keepWhenUpdating=!0),o.save(null,{onFailure:function(){var e,t;s.displayError((e="E6WCommonApps.Error.FailedToCreateTask",(t=E.get(e))===e&&(t=T.get(e)),t)),i&&i.onFailure&&i.onFailure.apply(this,arguments)},onComplete:function(e){e.solve(),i&&i.onComplete&&i.onComplete.apply(this,arguments)},at:0,ignoreDictionary:i&&i.ignoreDictionary})}return o},setup:function(t,n){var s=Array.prototype.slice.call(arguments,0);this._TasksByAttr={},this._attrToSplitBy=A,this.extid="allTasks";var i=e.clone(n,!1);this.parentModel=i.parentModel,s[1]=i,this._parent.apply(this,s)},setSearch:function(e){this._search=e.toLowerCase(),this._cleanupSubCollections()},resetSearch:function(){delete this._search,this._cleanupSubCollections()},getSearch:function(){return this._search},tasksWithAttrValue:function(e,t){var n=this,i=t||this._attrToSplitBy,o=C(e);return this.filter((function(e){var t=C(e.get(A)),a=C(e.get(i)),r=C(e.get("dsxplan:label"));r=r?r.toLowerCase():"";let l=C(e.get("dsxplan:enterpriseIdentificationNumber"));var c=!n._search||(s.match(n._search,r)||s.match(n._search,l));return(i!==d.DUE_DATE_CATEGORY&&"priority"!==i||"Complete"!==t)&&(a===o&&c)}))},tasksWithAttrValueCollection:function(e,t){if(void 0===e)throw new Error("Invalid attribute value passed.");var n=t||this._attrToSplitBy,s=C(e),i=this._TasksByAttr[n];if(!i||!i[s]){var o=this.tasksWithAttrValue(e,n),a={filterAttr:n,valueForFiltering:e,parentCollection:this},r=new f.TasksSplitCollection(o,a);r.extid="tasks-"+n+"-"+s,i||(this._TasksByAttr[n]=i={}),i[s]=r}return i[s]},_cleanupSubCollections:function(){var e=Object.prototype.hasOwnProperty;for(var t in this._TasksByAttr)e.call(this._TasksByAttr,t)&&this._cleanupSubCollectionForAttr(t)},_cleanupSubCollectionForAttr:function(e){var t=Object.prototype.hasOwnProperty,n=this._TasksByAttr[e];for(var s in n){if(t.call(n,s))n[s].stopListening(),delete n[s]}},scopesTypesForSearch:function(){return[]},scopesTypes:function(){return[]},projectTypesForSearch:function(){if(a.typeDictionary&&a.typeDictionary.typeHierarchy)return a.typeDictionary.typeHierarchy["dsplan:WorkPackage"]},projectTypes:function(){if(a.typeDictionary&&a.typeDictionary.typeHierarchy)return a.typeDictionary.typeHierarchy["dsplan:WorkPackage"]},reset:function(e,t){var n=Array.prototype.slice.call(arguments,0);if(c.isScopeRDF()&&t&&t.parse){var s={};try{s.member=e["dsxplan:hasTask"].member,s["@href"]="/classes/dsplan:Task",s["@id"]="dsplan:Task",s["@mask"]="dsplan:MVMask.Task.CollaborativeTask.Basic",s["@type"]="Collection",s.totalItems=s.member.length,n[0]=s}catch(e){}}this._parent.apply(this,n)},_scopeCollectionAdd:function(t,n,s){var i=e.clone(s||{},!1);i.parse=!1,this.add(t,i)},_scopeCollectionRemove:function(t,n,s){e.clone(s||{},!1).parse=!1,this.remove(t,s)},_scopeCollectionReset:function(e){var t=e.toArray();this.reset(t)},fetch:function(s){var i=this,o={cancel:g,noFetch:!0},r=e.clone(s||{},!1);if(r.dontFetch)return o;const p=c.isScopeRDF()||c.isAgileWorkContext();if(c.getScopeId()&&!p)return this.reset(void 0,r),o;var u={onAdd:this._scopeCollectionAdd,onRemove:this._scopeCollectionRemove,onReset:this._scopeCollectionReset};if(this.stopListening(void 0,u),p&&r.reset||r.skipReset){if(c.isAgileWorkContext()||r.skipReset){let e=[{filter:c.getFilter(),fromCompletionDate:h.getCompletedTaskFilter(),hasWorkContext:{"@id":a.shortToLongURI(l.computeURI(c.getObjectData()))}}];return this.fetchLeafTaskCollection(e,(function(e){e.member=e.member||[],i.updateScopeListener(new n(e,{parse:!0}),u)}),r)}if(c.isScopeSwym()){let e=[{filter:c.getFilter(),fromCompletionDate:h.getCompletedTaskFilter(),communityId:c.getScopeId()}];return r.url=d.COMMUNITIY_TASKS_URL,this.fetchLeafTaskCollection(e,(function(e){e.member=e.member||[],i.updateScopeListener(new n(e,{parse:!0}),u)}),r)}var m=a.hasLoadedDictionary()?{}:{newTransaction:!0,onFailure:function(){i.dispatchEvent("onFailToFindScope"),this.fetching=!1},attrs:{forceDslc:!0}};m.onComplete=()=>{r.onComplete&&r.onComplete(),this.fetching=!1},this.fetching=!0;var T=a.getObjectForAdding(f.RDFWorkscopeModel,c.getScopeId(),m).getTaskCollectionForFilter(c.getFilter(),m);return i.updateScopeListener(T,u),o}if(r.reset){var E={fromCompletionDate:h.getCompletedTaskFilter()};!1===window.widget.getValue("showProjectTasks")&&(E.standAloneTasks=!0),e.merge(r,{method:"POST",data:JSON.stringify([c.getFilter(),E]),headers:{"Content-Type":"application/json"}})}return r.url?(r.reset=!0,t.prototype.fetch.call(this,r)):(r.onComplete=function(){i._completeModelsInQueue(),s&&s.onComplete&&s.onComplete.apply(this,arguments)},r.onFailure=function(){i._completeModelsInQueue(),s&&s.onFailure&&s.onFailure()},this._parent(r))},fetchLeafTaskCollection:function(t,n,s){let i=e.clone(s||{},!1),o=s.url?s.url:d.GET_FIRST_LEVEL_LEAF_TASKS_URL;return this.fetching=!0,a.request(a.expandUrl(o),{method:"POST",type:"json",data:JSON.stringify(t),headers:{"Content-Type":"application/json"},onComplete:e=>{this.fetching=!1,n&&n(e),i.onComplete&&i.onComplete()},onFailure:()=>{this.fetching=!1,i.onFailure&&i.onFailure()},onTimeout:i.onTimeout})},updateScopeListener:function(e,t){this.listenTo(e,t),this.currentScopeCollection=e,this.reset(e.toArray())},getRelatedObject:function(e,t){var n=new u(a.createPlaceholder(t));return n.fetch({mask:"dsplan:MVMask.Person.Complex"}),n},add:function(e){var t,n=this,s=this._parent.apply(this,arguments);if(s){t=s,s instanceof i&&(t=[s]);for(var o=0;o<t.length;o++){var a=t[o];n.stopListening(a,"onChange:"+d.SEQUENCE_ORDER_ATTR),n.listenTo(a,"onChange:"+d.SEQUENCE_ORDER_ATTR,n.sort)}}return e&&this._dispatchModelEvent(t,"onRapidAdd"),s},remove:function(e){var t=this._parent.apply(this,arguments);return e&&this._dispatchModelEvent(e,"onRapidRemove"),t},_dispatchModelEvent:function(e,t){var n=this;e&&e.forEach?e.forEach((function(e){n.dispatchEvent(t,[e])})):e&&this.dispatchEvent(t,[e])}});return f.TasksSplitCollection=m.extend({model:i,_uwaClassName:"RDFTasksSplitCollection",setup:function(){var e=this._parent.apply(this,arguments);return this.listenTo(this._parentCollection,"onTaskCollectionFetchComplete",(function(){this.dispatchEvent("onTaskCollectionFetchComplete")})),e},add:function(t){var n=Array.prototype.slice.call(arguments,0);if(e.is(t,"array"))n[0]=t.filter((function(e){return e.isInCurrentScope&&e.isInCurrentScope()}));else if(t.isInCurrentScope&&!t.isInCurrentScope())return!1;return this._parent.apply(this,n)},comparator:function(e,t){var n=e.get("dsplan:sequenceOrder"),s=t.get("dsplan:sequenceOrder");if(void 0!==n&&void 0!==s)return n-s;var i=new Date(e.getStartDate()),o=new Date(t.getStartDate());return i.getTime()-o.getTime()}}),f})),define("DS/E6WCommonApps/Resource/ResourceModelMixin",["DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Resource/AssignedTasksCollection","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Preferences","DS/E6WCommonUI/E6WCommonUIConstants"],(function(e,t,n,s,i){"use strict";var o=i.ASSIGNED_TASK_ATTR,a={_propertyDictionary:{ASSIGNED_TASK_ATTR:{volatility:!0}},_relations:[{key:o,relatedCollection:t}],isResource:!0,getAssignedTasksCollection:function(e){const t={...e||{}};return this.getCollectionAttribute(o,{mask:"dsplan:MVMask.Person.Complex",detailsMask:"dsplan:MVMask.Task.Basic",defaultModel:n,...t})},getFilteredTasks:function(e){const t={...e||{}},n=s.getCurrentProject();return this.getAssignedTasksCollection().filter((e=>{if(!e.hasSubtasks())return t.external?!n.internalTasksMap[e.id]:n.internalTasksMap[e.id]}))},hasChildren:function(){return this.getFilteredTasks().length>0},getExternalTaskModel:function(){const t=a.ExternalTaskNodeModel;return e.getObjectForAdding(t,t.PREFIX+this.id,{attrs:{[t.ASSIGNEE]:this}})}};return a})),define("DS/E6WCommonApps/Resource/ExternalTaskNodeModel",["DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Resource/ResourceModelMixin","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Preferences","DS/E6WCommonApps/Utils/ForwardEvents","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r){"use strict";const l="externalTaskAssignee",d="dsplan:MVMask.Person.AssignedTasks",c=e.extend({setup:function(){this._parent.apply(this,arguments),this.listenTo(o,`onChange:${o.RESOURCE_INCLUDE_OTHER}`,(()=>{const e=this.get(l);this.getAssignedTasksCollection().remove(this.getFilteredTasks()),e&&e.removeMask(d)})),this.get(l)&&(Object.defineProperty(this,"fetching",{get:()=>this.get(l).fetching}),this.forwardEvents(this.get(l),["onFetchCountChanged"]))},get:function(e){switch(e){case"isExternalTaskModel":return!0;case"name":return r.get("E6WCommonApps.Label.ExternalTasks");case"miniImage":return require.toUrl("DS/E6WCommonApps/assets/img/I_ExternalTasks.png")}return this._parent.apply(this,arguments)},fetch:function(){const e=this.get(l);e&&c.scheduleComplete(e.id,{onComplete:t=>{e.addMask(d);const s=t["dsplan:externalTasks"];s&&(s.member=s.member.filter((e=>n.isTask(e["dsxplan:jsType"]))),this.getAssignedTasksCollection().reset(s,{parse:!0}))},onFailure:()=>this.getAssignedTasksCollection().reset()})}});return c.idsToComplete={},c.scheduleComplete=function(e,n){c.idsToComplete[e]=n,c._completeTimeout=c._completeTimeout||setTimeout((()=>{c._completeTimeout=void 0,t.complete(i,Object.keys(c.idsToComplete),{onlyIfNeeded:!0,mask:d,individualCallbacks:c.idsToComplete}),c.idsToComplete={}}),340)},c.implement(s,a,{hasChildren:()=>!0,getAssignedTasksCollection:function(e){const t={...e||{}};return this._parent({...t,external:!0})},getFilteredTasks:function(e){const t={...e||{}};return this._parent({...t,external:!0})}}),s.ExternalTaskNodeModel=c,c.ASSIGNEE=l,c.PREFIX="external_task_",c.COMPLETE_TIMEOUT=340,c.ASSIGNED_TASK_MASK=d,c})),define("DS/E6WCommonApps/Utils/BootstrapUtils",["DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/Models/LogicalUserModel","DS/E6WCommonApps/Resource/ResourceModelMixin"],(function(e,t,n){"use strict";return{commonInit:function(){e.implement(n),t.implement(n)}}})),define("DS/E6WCommonApps/ReparentingUtils",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/RDFTaskModel"],(function(e,t,n){"use strict";var s={checkParentHierarchyForId:function(e){var s,i,o,a,r=t.getBatchGenerator(),l=JSON.stringify([e.parentId,e.childId]);r.ajax(t.expandUrl("/invoke/dsxplan:checkIfChildIsAlreadyInAncestor"),{method:"POST",type:"json",data:l,headers:{"Content-Type":"application/json"},onComplete:function(e){s=e.value||e["@value"]}}),o=e.type===n?"dsplan:MVMask.Task.CollaborativeTask.siblings":"dsplan:MVMask.WorkPackage.Drop";var d=(a=t.getObjectForAdding(e.type,e.childId,void 0)).getParent&&a.getParent();d?i=d.id===e.parentId:a.fetch({mask:o,ajax:r.ajax,onlyIfNeeded:!0,onComplete:function(t){var n=t&&t.getParent();i=Boolean(n&&n.id===e.parentId)}}),r.sendBatch({onComplete:function(){e.onComplete({value:s||i,parentName:d&&d.get("title"),childName:a&&a.get("title")})}})}};return s})),define("DS/E6WCommonApps/Collections/RDFLeafTasksCollection",["UWA/Core","DS/E6WCommonApps/Collections/RDFTasksCollection","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/SmartSchedulerUtils"],(function(e,t,n,s,i){"use strict";var o=t.extend({_uwaClassName:"RDFLeafTasksCollection",setup:function(t,n){var s=e.clone(n||{},!1);s["@mask"]="dsplan:MVMask.Task.CollaborativeTask.Basic",s.detailsMask="dsplan:MVMask.Task.Complex",s["@href"]="invoke/dsxplan:getFirstLevelLeafTasks",this.ownerFilter=s.ownerFilter,this.trackNextFetch=s.trackNextFetch,this._parent(t,s)},_trackFetch:function(e){var t=Date.now()-e;s.trackPageEvent({eventCategory:"taskView",eventAction:"Open",eventLabel:"loadTasks",eventValue:t,persDim:{pd2:this.ownerFilter},persVal:{pv4:t}})},fetch:function(t){var s=this,o=e.clone(t||{},!1),a=i.getCompletedTaskFilter(),r=[{versionURI:this.parentModel.id,openTask:o.taskIdToOpen?o.taskIdToOpen:null,filter:this.ownerFilter,fromCompletionDate:a}],l=Date.now();return o.data=JSON.stringify(r),this.reset(),o.onComplete=function(){function e(e,t){!t&&e&&s.remove(e)}s.forEach((t=>{s.listenTo(t,"onChange:"+n.TASK_PARENT_ATTR,e),s.listenTo(t,"onChange:"+n.PARENT_ATTR,e)})),s.cacheCollection(),s.dispatchEvent("onTaskCollectionFetchComplete"),t&&t.onComplete&&t.onComplete.apply(s,arguments),s.trackNextFetch&&(s._trackFetch(l),delete s.trackNextFetch)},this._parent(o)},add:function(e,t){const n={...t||{},dontRegisterChange:!0};return this._parent(e,n)}});return o})),define("DS/E6WCommonApps/Collections/HasConstraintsCollection",["UWA/Core","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonApps/Models/ConstraintModel"],(function(e,t,n){"use strict";var s=t.extend({_uwaClassName:"HasConstraintCollection",setup:function(){this._parent.apply(this,arguments),this.setDetailsMask("dsplan:MVMask.Constraint.Complex")},getUri:function(e){return e&&e.forNewObject&&s.computedProperty?"/classes/"+n.CONSTRAINT_RDF_TYPE:this._parent.apply(this,arguments)}});return s.computedProperty=!0,s})),define("DS/E6WCommonApps/Models/WorkscopeModel",["UWA/Core","UWA/Class/Collection","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Collections/ResultCollection","DS/RDFFoundation/Collections/UserCollection","DS/E6WCommonApps/Checklist/ChecklistItemCollection","DS/RDFFoundation/ProjectTypeUtils","DS/RDFFoundation/Models/LogicalUserModel","DS/E6WCommonApps/Collections/ProjectTeamCollection","DS/E6WCommonApps/Collections/MemberResponsibilityCollection","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/ScheduleConstants","DS/E6WCommonApps/Models/ScheduleElementModel","DS/E6WCommonApps/Collections/ConstraintsPseudoCollection","DS/E6WCommonApps/Models/ConstraintModel","DS/E6WCommonApps/Collections/RDFTasksCollection","DS/E6WCommonApps/Collections/HasConstraintsCollection","DS/E6WCommonApps/Collections/ScenarioModelCollection","DS/E6WCommonApps/Models/SolverModelMixin","DS/E6WCommonApps/Models/CalendarModel","DS/E6WCommonApps/Models/AccessModel","DS/E6WCommonApps/Models/FileManagementMixin","DS/E6WCommonApps/Models/MilestoneModel","DS/E6WCommonApps/Models/GateModel","DS/E6WCommonApps/Models/AddTaskMixin","DS/E6WCommonApps/Resource/ResourceEventsMixin","DS/E6WCommonApps/Models/NoAccessModel","DS/E6WCommonApps/Models/TeamMemberResponsibilityModel","DS/E6WCommonApps/Checklist/ChecklistParentModelMixin","DS/E6WCommonApps/ReparentingUtils","DS/E6WCommonApps/Collections/RDFLeafTasksCollection","DS/E6WCommonApps/E6WNonWorkingDayIterator","DS/E6WCommonApps/Agile/AgileProjectMixin","DS/E6WCommonApps/Resource/UnassignedPlaceholderModel","DS/E6WCommonApps/Preferences","DS/E6WCommonApps/Utils/ScenariosUtils","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/Models/DropValidator","DS/E6WCommonUI/PlatformManager","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,E,g,A,C,_,f,D,S,R,y,v,M,I,b,O,N,P,W,F,k,L,U,w,x,V){"use strict";var j=function(e){var t=V.get(e);return t===e&&(t=x.get(e)),t},B=p.TASK_RELATION_ATTR,H=(p.TASK_RELATION_ATTR_DSLC,"dsplan:hasBacklogTask"),G=p.MILESTONE_RELATION_ATTR,Y=p.GATE_RELATION_ATTR,K=p.CONSTRAINT_RELATION_ATTR,J=p.RESTRICT_ASSIGNEE_ATTR,q=p.RESTRICT_ASSIGNEE_ATTR_SERVER,X="dsxplan:usesCalendar",$=p.TEAM_MEMBERS,z="dsplan:hasThumbnail",Q="dsxplan:hasRolledUpInfo",Z="dsxplan:hasBaseline",ee={"dsplan:schedulingStrategy":!0,"dsxplan:schedulingStrategy":!0,"dsplan:schedulingFromStrategy":!0,"dsplan:startDateIntervalMin":!0,"dsxplan:startDateIntervalMin":!0,"dsplan:endDateIntervalMax":!0,"dsxplan:endDateIntervalMax":!0,"dsxplan:usesCalendar":!0,"dsxplan:scheduleCalendar":!0};const te="rollupStart",ne="rollupEnd";var se={all:{attribute:"dsxplan:hasLeafTasks",parentMask:"dsplan:MVMask.WorkPackage.Complex"},owned:{attribute:"dsplan:ownedTasks",parentMask:"dsplan:MVMask.WorkPackage.CollaborativeTasks.owned"},assigned:{attribute:"dsplan:assignedTasks",parentMask:"dsplan:MVMask.WorkPackage.CollaborativeTasks.assigned"},assignedToMyGroups:{attribute:"dsplan:assignedToMyGroupTasks"},candidateAssignee:{attribute:"dsxplan:candidateAssigneeTasks"}},ie=_.extend({TASK_RELATION_ATTR:B,liveUpdateCreateMask:"dsplan:MVMask.WorkPackage.Collapsed",dslcMapping:p.dslcMapping,_propertyDictionary:{team_members:{volatility:!0},ownerResponsibilityModel:{volatility:!0},assigneeResponsibilityModels:{volatility:!0},teamMembersForTypeAhead:{volatility:!0},thumbnail:{volatility:!0},solveCounter:{volatility:!0},"dsxplan:hasConstraint":{volatility:!0},"dsplan:hasConstraint":{volatility:!0},"dsxplan:workDecompositionParent":{inverseProperty:"dsxplan:hasWorkDecomposition",inversePropertyIsCollection:!0},"dsxplan:hasWorkDecomposition":{inverseProperty:p.WORKSCOPE_PARENT_ATTR},"dsxplan:hasReferenceProject":{inverseProperty:p.PARENT_REFERENCE_PROJECT_ATTR,inversePropertyIsCollection:!0},"dsxplan:parentReferenceProject":{inverseProperty:p.REFERENCE_PROJECT_ATTR,inversePropertyIsCollection:!0,volatility:!0},unassignedTasks:{volatility:!0},"dsxplan:hasTask":{inverseProperty:"dsxplan:workscopeParent"},"dsxplan:hasMilestone":{inverseProperty:"dsxplan:workscopeParentForMilestone"},"dsxplan:hasGate":{inverseProperty:"dsxplan:workscopeParentForGate"},[H]:{inverseProperty:"dsxplan:backlogParent",volatility:!0},"dsplan:hasRolledUpInfo":{inverseProperty:"dsplan:isRolledUpInfoFor"},"dsplan:hasParent":{volatility:!0},explicitTagsData:{volatility:!0},_xplanSubscribed:{volatility:!0},"dsplan:accessedDate":{volatility:!0},"dsplan:isFavorite":{volatility:!0},"dsxplan:hasWorkContext":{inverseProperty:"dsxplan:hasContributingElements",inversePropertyIsCollection:!0},"dsplan:hasChecklistItem":{inverseProperty:p.CHECKLIST_PARENT_ATTR},[p.DSLC_SCENARIOS_ATTR]:{inverseProperty:p.SCENARIOS_PARENT_ATTR},"dsplan:hasTasksForResource":{volatility:!0}},_relations:[{key:p.CHILDREN_ATTR},{key:"dsxplan:hasWorkDecomposition"},{key:p.PARENT_REFERENCE_PROJECT_ATTR},{key:p.REFERENCE_PROJECT_ATTR},{key:"dsplan:hasProcessInstance"},{key:"dsplan:hasProcessModel"},{key:B,relatedCollection:T},{key:"dsxplan:hasLeafTasks",relatedCollection:O,volatility:!0},{key:"dsxplan:hasAttachment",relatedCollection:s},{key:"dsxplan:hasWorkContext",relatedCollection:s},{key:"dsxplan:actualDeliverable",relatedCollection:s},{key:p.DSLC_SCENARIOS_ATTR,relatedCollection:g},{key:"dsplan:assignedToMyGroupTasks",relatedCollection:O},{key:"dsxplan:candidateAssigneeTasks",relatedCollection:O},{key:"dsxplan:hasTask",relatedCollection:T},{key:"dsxplan:hasBacklogTask",relatedCollection:T},{key:"dsplan:hasTasksForResource",relatedCollection:T},{key:"dsplan:assignedTasks",relatedCollection:O},{key:"dsplan:ownedTasks",relatedCollection:O},{key:K,relatedCollection:E},{key:"dsxplan:hasConstraint",relatedCollection:E},{key:"dsxplan:hasMilestone",relatedCollection:s},{key:"dsxplan:hasGate",relatedCollection:s},{key:"dsxplan:hasAssignee",relatedCollection:i},{key:Z,relatedCollection:s},{key:"dsplan:hasChecklistItem",relatedCollection:o},{key:"unassignedTasks",relatedCollection:s}],_uwaClassName:"WorkscopeModel",parentMask:"dsplan:MVMask.WorkPackage.Complex",mask:"dsplan:MVMask.WorkPackage.Basic",writeMask:"dsplan:MVMask.WorkPackage.Complex",init:function(t,n){const s=e.clone(t||{},!1);s["dsplan:jsType"]=s["dsplan:jsType"]||s["dsxplan:jsType"]||"dsplan:Project",this._parent(s,n)},syncWithDPMIfNeeded:function(){n.request(n.expandUrl("invoke/dsplan:syncWithDPMIfNeeded"),{method:"POST",type:"json",data:JSON.stringify([this.compactJson()]),headers:{"Content-Type":"application/json"},onComplete:()=>{this.getMilestones().fetch()}})},isFavorite:function(){return this.get("dsplan:isFavorite")},getImage:function(e){return e||(e=this.getDefaultImage()),e&&-1===e.indexOf("http://")&&-1===e.indexOf("https://")&&-1===e.indexOf("E6WCommonApps")?require.toUrl("E6WCommonApps/assets/img/"+e):e},getAllWorkContexts:function(){var e=[];return this.getCollectionAttribute("dsxplan:hasBacklogTask").forEach((t=>{var n=t.get("dsxplan:hasWorkContext");n&&e.push(n)})),this.getCollectionAttribute("dsxplan:hasWorkDecomposition").forEach((t=>{t.get("dsxplan:hasTask").forEach((t=>{var n=t.get("dsxplan:hasWorkContext");n&&e.push(n)}))})),e},getIconURL:function(){return this.getDefaultImage()},getDefaultImage:function(t){let n=e.clone(t||{},!1);return n.isTemplate=this.get("dsplan:isTemplate"),a.getDefaultProjectImage(this.get(p.PROJECT_TYPE),n)},getAllMilestoneTaskandGateModels:function(){let e=[...this.getGates().toArray(),...this.getShadowGates().toArray()],t=[...[...this.getMilestones().toArray(),...this.getShadowMilestones().toArray()],...e];return this.getTasks().forEach((e=>{let n=e?.getAllTaskModels&&e?.getAllTaskModels()||[];t=[...t,...n]})),this.getWorkscopes().forEach((e=>t=t.concat(e.getAllMilestoneTaskandGateModels()))),t},solve:function(t){var n=e.clone(t||{},!1);return n.listName="ProjectList",u.prototype.solve.call(this,n)},sync:function(t,n,s){var i=e.clone(s||{},!1);if("update"===t&&(i.hasOwnProperty("solve")||(i.solve=this.shouldWeSolve(i)),i.solve)){var o=this;i.onComplete=function(){var t=s&&e.is(s.onComplete,"function")&&s.onComplete.apply(this,arguments);return!i.isMassEdit&&o.solve(),t};var a=Array.prototype.slice.call(arguments,0);return a[2]=i,this._parent.apply(this,a)}return this._parent.apply(this,arguments)},syncCreate:function(e,t){var n=Array.prototype.slice.call(arguments,0),s=n[1],i=this;i.beingCreatedOnServer=!0;var o=t.onFailure,a=t.onComplete,r=t.onTimeout;s.onComplete=function(){i.beingCreatedOnServer=!1,a&&a.apply(this,arguments)},s.onFailure=function(e,t,n){i.beingCreatedOnServer=!1,n&&(n.response=t),o&&o.apply(this,arguments)},s.onTimeout=function(e,t,n){i.beingCreatedOnServer=!1,n&&(n.response=t),r&&r.apply(this,arguments)},this._parent.apply(this,n)},shouldWeSolve:function(e){var t;if(this.getChangedAttributesSinceLastSave().some(this.isAttributeImpactingSolve.bind(this))||e.assumeChanges){for(t=this.getParent();t;t=t.getParent()){if(t.autosolve===p.AUTOSOLVE_OFF)return u.dispatcher.dispatchEvent("solveNeeded",[this]),!1;if(t.autosolve===p.AUTOSOLVE_ON)return!0}if(!t){if(this.autosolve===p.AUTOSOLVE_OFF)return u.dispatcher.dispatchEvent("solveNeeded",[this]),!1;if(this.autosolve===p.AUTOSOLVE_ON)return!0}return!0}return!1},_registerAsElementParent:function(e,t,n){var s=this.id;"dsplan:hasBacklogTask"!==t&&"dsxplan:hasBacklogTask"!==t?(e.parentId=s||this.cid,e.parentConstructor=this.constructor,e instanceof ie&&s&&e.set(p.WORKSCOPE_PARENT_ATTR,this,{...n,dontRegisterChange:!0})):e.set("dsxplan:backlogParent",this,{...n,dontRegisterChange:!0})},onAtIdChange:function(){this._parent.apply(this,arguments),this.getCollectionAttribute(p.CHILDREN_ATTR).forEach(this._registerAsElementParent,this),this.getTasks().forEach(this._registerAsElementParent,this),this.getMilestones().forEach(this._registerAsElementParent,this),this.getGates().forEach(this._registerAsElementParent,this)},updateThumbnailImage:function(e){var t=e||this.get(z);this.thumbnail=t},canRemove:function(){return!w.isXppViewer()},hasParent:function(){return Boolean(this.get(p.HAS_PARENT_ATTR))},getNonWorkingDayIterator:function(e){return this.nonWorkingDayIterator||(this.nonWorkingDayIterator=new N({rootProject:{id:this.id},loadCalendar:!0,ajax:e})),this.nonWorkingDayIterator},_listenToModel:function(){var e={"onChange:title":function(){this.dispatchEvent("onChange:name",arguments)}};e["onChange:"+p.WORKSCOPE_PARENT_ATTR]=function(e,t){this===e?t||(this.parentId=void 0,this.parentConstructor=void 0):console.error("invalid onChange parent to be checked")},e["onChange:dsplan:hasThumbnail"]=()=>this.updateThumbnailImage(),e.onSync=function(){this._setAndSaveSequenceOrders(this.getTasks()),this._setAndSaveSequenceOrders(this.getWorkscopes())},e["onChange:"+p.WORK_CONTEXT_ATTR]=this._onContextChanged,e["onChange:"+p.OWNER_ATTR]=this.setOwnerResponsibilityModel,e["onChange:"+p.ASSIGNEE_ATTR]=this.setAssigneeResponsibilityModel,e["onChange:"+p.TEAM_MEMBERS]=function(){this.setOwnerResponsibilityModel(),this.setAssigneeResponsibilityModel()},this.listenTo(this,e)},_onContextRemoved:function(e){var t;(t=e&&e instanceof ie?e:e["@id"]&&n.getObjectById(e["@id"]))&&t instanceof ie&&(this.stopListening(t.getMilestones()),t.getMilestones().forEach((e=>{e.removeShadowParent(this)})),this.stopListening(t.getGates()),t.getGates().forEach((e=>{e.removeShadowParent(this)})))},_onContextAdded:function(e){e&&e instanceof ie&&(e.getMilestones().forEach((e=>{e.addShadowParent(this)})),this.listenTo(e.getMilestones(),{onAdd:e=>{e.addShadowParent(this)},onRemove:e=>{e.removeShadowParent(this)}}),e.getGates().forEach((e=>{e.addShadowParent(this)})),this.listenTo(e.getGates(),{onAdd:e=>{e.addShadowParent(this)},onRemove:e=>{e.removeShadowParent(this)}}))},_onContextChanged:function(){let e=this.previousAttributes()[p.WORK_CONTEXT_ATTR];e&&("Collection"===e["@type"]||e.values)&&(e=e.member||e.values),e&&e.forEach((e=>this._onContextRemoved(e)));let t=this.get(p.WORK_CONTEXT_ATTR);t&&("Collection"===t["@type"]||t.values)&&(t=t.member||t.values),t&&t.forEach((e=>this._onContextAdded(e)))},_listenToChildrenCollections:function(){for(var e=[this.getWorkscopes(),this.getTasks(),this.getMilestones(),this.getGates()],t=0;t<e.length;t++){var n=e[t];this.listenTo(n,{onAdd:this._registerAsElementParent,onReset:this._registerAsParentOfEachElement})}this.listenTo(this.getTasks(),"onSync",(function(){this._setAndSaveSequenceOrders(this.getTasks())})),this.listenTo(this.getWorkscopes(),"onSync",(function(){this._setAndSaveSequenceOrders(this.getWorkscopes())})),this.listenTo(this.get(p.WORK_CONTEXT_ATTR),{onAdd:e=>this._onContextAdded(e),onRemove:e=>this._onContextRemoved(e)})},_registerAsParentOfEachElement:function(e){e.forEach(this._registerAsElementParent,this)},_registerAsParentOfAllChildrenModels:function(){this.getWorkscopes().forEach(this._registerAsElementParent,this),this.getTasks().forEach(this._registerAsElementParent,this),this.getMilestones().forEach(this._registerAsElementParent,this),this.getGates().forEach(this._registerAsElementParent,this)},getParent:function(){return n.getObjectById(this.parentId)||this.get(p.WORKSCOPE_PARENT_ATTR)},getParentInverseProperty:function(){return this._propertyDictionary[p.WORKSCOPE_PARENT_ATTR].inverseProperty},getTimezone:function(){return this.get(X)},getObjectTypeLabel:function(e){return e===p.PROGRAM_RDF_TYPE||"dsxplan:Program"===e||"dsxplan:ProgramVersion"===e?p.PROGRAM:e===p.PROJECT_RDF_TYPE?p.PROJECT:e===p.XPROJECT_RDF_TYPE?p.XPROJECT:e===p.WORKPACKAGE_RDF_TYPE||"dsxplan:WorkPackage"===e||"dsxplan:WorkPackageVersion"===e?p.WORKPACKAGE:p.OBJECT},getObjectType:function(){var e=this.get("dsxplan:jsType")||this.get("dsxplan:actualType")||this.get(p.ACTUAL_TYPE_ATTR)||this.get(p.TYPE_ATTR);if(e){var t=e.id||e;return this.getObjectTypeLabel(t)}return p.OBJECT},getProjectTypeNLS:function(){var e=this.get(p.PROJECT_TYPE);if(e){if(e===p.PROJECT_RDF_TYPE)return x.get("E6WCommonApps.Type.TeamProject");if(e===p.XPROJECT_RDF_TYPE)return x.get("E6WCommonApps.Type.EnterpriseProject")}},get:function(e){var t=this._parent.apply(this,arguments);switch(e){case p.SHOW_SCHEDULE_HIGHLIGHTS:return this.isAgile()||this.isXProject();case"image":var n=this.get(z);return n||this.getImage(this._parent.apply(this,arguments));case p.IMAGE_TILE_ATTR:return this.get(z)||this.getDefaultImage({imageType:p.IMAGE_TILE_ATTR});case p.IMAGE_THUMBNAIL_ATTR:return this.get(z)||this.getDefaultImage({imageType:p.IMAGE_THUMBNAIL_ATTR});case"type":return this.getObjectType();case"name":return this._parent("title");case"description":return this.get(p.DESCRIPTION_ATTR);case"ds6w:type":return this.get(p.PROJECT_TYPE);case p.SCHEDULING_FROM_STRATEGY_ATTR:return t||(t=p.CURRENTDATE_SCHEDULINGFROM_STRATEGY),t;case p.WORKSCOPE_PARENT_ATTR:return!t&&this.hasParent()&&(t=new v),t;case te:return this.getStartDate();case ne:return this.getEndDate();case"dsplan:accumulatedStoryPoints":return this.getAccumulatedStoryPoints();case p.WORK_CONTEXT_ATTR:return t||this.addNewCollectionData(e);case"_isIteration":return this.getParent()&&this.getParent().isAgile();case"_isXProject":return this.isXProject();case"_hasProcessModelButNoInstance":return this.get(p.GOVERNING_PROCESS_MODEL_ATTR)&&!this.get(p.GOVERNING_PROCESS_INSTANCE_ATTR);default:return t}},getTeamMembers:function(){var e=this.get($);return e||(e=new l(void 0,{workscope:this,"@mask":"dsplan:MVMask.WorkPackage.Property"}),this.setCollection($,e)),e},getUnassignedLogicalUsers:function(){var e=[];let t=this.get($);if(t){e=t.filter((e=>e.isUnassignedLogicalUserMember())).map((e=>e.get("memberPersonModel")))}return e},setOwnerResponsibilityModel:function(){var e=this.get($);if(e){let t=e.getResponsibilityModelForMember(this.get(p.OWNER_ATTR));t&&(t.set("isOwner",!0),this.set(p.OWNER_RESPONSIBILITY_ATTR,t))}},setAssigneeResponsibilityModel:function(){var e=this.get($);if(e){let t=this.get(p.ASSIGNEE_ATTR).map((function(t){let n=e.getResponsibilityModelForMember(t);return n||(n=new M({memberPersonModel:t,assignedPersonModel:t,allResponsibilitiesArray:[]})),n})),n=new d;t.forEach((function(e){e.set("isAssignee",!0)})),n.add(t),this.setCollection(p.ASSIGNEE_RESPONSIBILITIES_ATTR,n),this.dispatchEvent("onChange:"+p.ASSIGNEE_RESPONSIBILITIES_ATTR)}},dataForRendering:function(t){var n,s=e.clone(t||{},!1);if(s.attributes){n=Object.create(null);for(var i=s.attributes,o=i.length,a=0;a<o;a++){var r=i[a];n[r]=!0}s.attributes=i}var l=!n,d=this._parent.apply(this,arguments),c=this;return d.autosolve=this.autosolve!==p.AUTOSOLVE_OFF,d.name=this.get(p.DSLC_TITLE_ATTR),d.image=this.get("dsplan:hasThumbnail")||this.get("image"),d.physicalId=this.get("physicalId"),this.get(p.OWNER_RESPONSIBILITY_ATTR)&&(d.ownerResponsibilityModel=this.get(p.OWNER_RESPONSIBILITY_ATTR).toJSON()),this.get(p.ASSIGNEE_RESPONSIBILITIES_ATTR)&&(d.assigneeResponsibilityModels=this.get(p.ASSIGNEE_RESPONSIBILITIES_ATTR).map((function(e){return e.toJSON()}))),this.get(p.TEAM_MEMBERS)&&(d.team_members=this.get(p.TEAM_MEMBERS).map((function(e){return e.toJSON()}))),function(s){if(l||n[s]){var i=c.get(s);i&&(e.is(i.dataForRendering,"function")&&(i=i.dataForRendering(t)),d[s]=i)}}(this.get(p.WORKSCOPE_PARENT_ATTR)),d},toJSON:function(){let e=this._parent.apply(this,arguments);return e.isFavorite=e["dsplan:isFavorite"],e},getWorkscopes:function(){return this.getCollectionAttribute(p.CHILDREN_ATTR)},getReferenceWorkscopes:function(){return this.getCollectionAttribute(p.REFERENCE_PROJECT_ATTR)},getReferenceSequenceOrder:function(e){return JSON.parse(this.get("dsplan:referenceConfig")||"{}")[e.id]||e.get(ie.SEQUENCE_ORDER_ATTR)},getConstraints:function(){return this._allConstraints=this._allConstraints||new h(this),this._allConstraints},getPropertyMask:function(){return"dsplan:MVMask.WorkPackage.Property"},getUnassignedPlaceholderModel:function(){return this.unassignedPlaceholderModel},fetchForProperty:function(t){let s=e.clone(t||{},!1);var i=this;const o=s.batchBuilder||n.getBatchGenerator();C.haveCalendarsBeenFetched()||C.fetchCalendars({ajax:o.ajax});var a={mask:this.getPropertyMask&&this.getPropertyMask(),dontUpdateMask:!0,ajax:o.ajax,onlyIfNeeded:!0};this.getTeamMembers().fetch({ajax:o.ajax,onComplete:function(){i.setOwnerResponsibilityModel(),i.setAssigneeResponsibilityModel()}}),this.fetch(a),s.fromMassEdit||o.sendBatch(),this.loadAssociatedKanbanBoards()},destroy:function(){this.getWorkscopes().reset([],{silent:!1}),this._parent.apply(this,arguments)},getMilestoneTypes:function(){return this._getTypes(p.MILESTONE_VOCABULARY_ATTR)},getTaskTypes:function(){return this._getTypes(p.TASK_VOCABULARY_ATTR)},getDSLCTaskTypes:function(){return this._getTypes("dsxplan:hasTaskVocabulary")},getDSLCMilestoneTypes:function(){return this._getTypes("dsxplan:hasMilestoneVocabulary")},_getTypes:function(e){var t=[],n=this,s=function(){for(var t=n.get(e);!t&&n&&n.hasViewAccess();)(n=n.getParent())&&(t=n.get(e));return t}();if(s){var i=s.get("dsplan:vocabularyTerms");if(i)for(var o=0;o<i.length;o++){var a=i.at(o),r="E6WCommonApps.Type."+a.id.substring(a.id.indexOf(":")+1);t.push({actualValue:a.id,displayValue:j(r)})}}return t},createChildWorkscope:function(t,n){var s=this._getDefaultChildWorkscopeAttributes();e.extend(s,t);var i=this._getChildWorkscopeType(s[p.TYPE_ATTR]),o=p.CHILDREN_ATTR.replace("dsplan","dsxplan");s[p.TYPE_ATTR]=i;var a=e.clone(n||{},!1);a._defaultModel=ie;var r=this.addModelToAttributeWithCollection(o,s,a);return this._registerAsElementParent(r),r},_getChildWorkscopeType:function(e){return e||(e="Program"===this.getObjectType()?p.PROJECT_RDF_TYPE:p.WORKPACKAGE_RDF_TYPE),e},getStartAndFinishDates:function(){var e={},t=function(t){isNaN(t.start)||e.start&&!(t.start<e.start)||(e.start=t.start),isNaN(t.end)||e.finish&&!(t.end>e.finish)||(e.finish=t.end)};this.getMilestones().forEach((function(e){var n=new Date(e.getStartDate());t({start:n,end:n})})),this.getGates().forEach((function(e){var n=new Date(e.getStartDate());t({start:n,end:n})}));var n=this.getRollupDates();return n&&t(n),e},getRollupDates:function(){var e=this.get(Q);if(e)return{start:e.get("dsxplan:estimatedStartDate")&&new Date(e.get("dsxplan:estimatedStartDate")),end:e.get("dsxplan:estimatedEndDate")&&new Date(e.get("dsxplan:estimatedEndDate"))}},isAttributeImpactingSolve:function(e){return ee[e]},getAssignees:function(){return this.getCollectionAttribute(p.ASSIGNEE_ATTR,{detailsMask:"dsplan:MVMask.Person.Complex"})},save:function(){var t=L.setHelper.apply(this,arguments),n=t.attrs||{};n=this.handleRestrictAssigneeAccess(n);var s=t.options,i=e.clone(s||{},!1),o=this.getCombinedAttributes(n);if(i.onComplete=this._getCallbackThatWillFetchTeamMembersOnCompleteIfNeeded(o,s),!i.forceSequenceOrder&&this._hasNewWorkscopeParentAttributeWithoutNewSequenceOrderAttribute(o)){var a=this._calculateNewSequenceOrderFromParentThenSave(n,s);if(a)return a}var r=i.onFailure;return i.onFailure=function(e,t){403===t["@code"]&&t.message&&(L.displayError(j(t.message)),t.msgDisplayed=!0),r&&r.apply(this,arguments)},this._parent(n,i)},restore:function(e){n.request(n.expandUrl("/invoke/dsxplan:restore"),{method:"POST",type:"json",data:JSON.stringify([this.id]),headers:{"Content-Type":"application/json"},onComplete:e&&e.onComplete,onFailure:e&&e.onFailure,onTimeout:e&&e.onTimeout})},_hasNewWorkscopeParentAttributeWithoutNewSequenceOrderAttribute:function(e){var t=-1!==e.indexOf(p.WORKSCOPE_PARENT_ATTR),n=this.isDSLC()?this.dslcMapping[p.SEQUENCE_ORDER_ATTR]:p.SEQUENCE_ORDER_ATTR,s=-1!==e.indexOf(n);return t&&!s},_calculateNewSequenceOrderFromParentThenSave:function(t,n){var s=t[p.WORKSCOPE_PARENT_ATTR]||this.get(p.WORKSCOPE_PARENT_ATTR),i=this;return s&&s.fetch({onlyIfNeeded:!0,mask:"dsplan:MVMask.WorkPackage.Collapsed",onComplete:function(){var o=e.clone(t||{},!1),a=e.clone(n||{},!1);o[i.isDSLC()?i.dslcMapping[p.SEQUENCE_ORDER_ATTR]:p.SEQUENCE_ORDER_ATTR]=s.getWorkscopes().getTotalRecords()+Math.random(),delete a.ajax,i.save(o,a)}})},_getCallbackThatWillFetchTeamMembersOnCompleteIfNeeded:function(e,t){var n=t&&t.onComplete;if(e.some((function(e){return p.dslcMapping[p.ASSIGNEE_ATTR]===e}))){var s=this;n=function(){var e=s.get($);e&&e.fetch(),t&&t.onComplete&&t.onComplete.apply(this,arguments)}}return n},getMilestoneById:function(e){var t;return this.getMilestones().some((function(n){return n.id===e&&(t=n,!0)})),t},getMilestones:function(){return this.getCollectionAttribute(G,{"@mask":"dsplan:MVMask.WorkPackage.MilestonesOnly"})},getGates:function(){return this.getCollectionAttribute(Y,{"@mask":"dsplan:MVMask.WorkPackage.MilestonesOnly"})},getShadowMilestones:function(){const t=this.get(p.WORK_CONTEXT_ATTR),n=t&&t.first();return n&&n.getMilestones?n.getMilestones():new e.Class.Collection},getShadowGates:function(){const t=this.get(p.WORK_CONTEXT_ATTR),n=t&&t.first();return n&&n.getGates?n.getGates():new e.Class.Collection},getTaskById:function(e){return this.getTasks().get(e)},getTasks:function(){return this.getCollectionAttribute(B,{"@mask":"dsplan:MVMask.WorkPackage.CollaborativeTasks.all",detailsMask:"dsplan:MVMask.Task.Complex"})},getTaskAssigneesForResource:function(){let e=new Set;return this.getTasksForResource().filter((e=>!e.hasSubtasks())).forEach((t=>{const n=t.getAssignees({noCreate:!0});n&&n.forEach((t=>e.add(t)))})),this.getUnassignedLogicalUsers().forEach((t=>{e.add(t)})),Array.from(e)},getUnassignedTasks:function(){return this.getTasksForResource().filter((e=>{const t=e.getAssignees({noCreate:!0});return!t||0===t.size()}))},getSortedTaskAssignees:function(){return this.getTaskAssigneesForResource().sort((function(e,t){let n=e.get("name"),s=t.get("name");return n>s?1:s>n?-1:0}))},getBacklogTasks:function(){return this.getCollectionAttribute(H,{"@mask":"dsplan:MVMask.Project.BacklogTasks",detailsMask:"dsplan:MVMask.Task.Complex"})},getAttachments:function(){return this.getCollectionAttribute(p.ATTACHMENT_ATTR,{"@mask":"dsplan:MVMask.WorkPackage.Property"})},getDeliverables:function(){return this.getCollectionAttribute(p.ACTUAL_DELIVERABLE_ATTR,{"@mask":"dsplan:MVMask.WorkPackage.Property"})},getBaselines:function(){return this.getCollectionAttribute(Z,{"@mask":"dsplan:MVMask.WorkPackage.Baselines"})},getBaselinesForComboBox:function(){return this.getBaselines().toArray().map((e=>({label:e.get("dsxplan:label"),icon:"stop",value:e.id})))},getTaskCollectionForFilter:function(t,n){var s=e.clone(n||{},!1),i=se[t];return this.getCollectionAttribute(i.attribute,{ownerFilter:t,onComplete:s.onComplete})},getOwnConstraints:function(){return this.getCollectionAttribute(K,{"@mask":"dsplan:MVMask.WorkPackage.ScheduleView"})},addConstraint:function(t,n){var s,i=e.clone(n||{},!1);return i._defaultModel=m,t[m.PREDECESSOR_ATTR].id!==t[m.SUCCESSOR_ATTR].id&&(s=this.addModelToAttributeWithCollection(K,t,i)),s},addMilestone:function(t){var n=e.clone(t||{},!1),s=n[p.SUGGESTED_DATE_ATTR]||new Date,i=n[p.ESTIMATED_DATE_ATTR]||new Date(s);return n["@type"]=n["@type"]||p.MILESTONE_RDF_TYPE,n["dsxplan:jsType"]=n["dsxplan:jsType"]||p.MILESTONE_RDF_TYPE,n[p.TITLE_ATTR]=n[p.TITLE_ATTR]||"Milestone",n[p.SUGGESTED_DATE_ATTR]=s,n[p.ESTIMATED_DATE_ATTR]=i,this._addScheduleElement(G,n)},addGate:function(t){var n=e.clone(t||{},!1),s=n[p.SUGGESTED_DATE_ATTR]||new Date,i=n[p.ESTIMATED_DATE_ATTR]||new Date(s);return n["@type"]=n["@type"]||p.GATE_RDF_TYPE,n["dsxplan:jsType"]=n["dsxplan:jsType"]||p.GATE_RDF_TYPE,n[p.TITLE_ATTR]=n[p.TITLE_ATTR]||"Gate",n[p.SUGGESTED_DATE_ATTR]=s,n[p.ESTIMATED_DATE_ATTR]=i,this._addScheduleElement(Y,n)},addChildWorkscopeAndSave:function(t,s){var i=this,o=e.clone(s||{},!1);e.extend(o,{parentId:this.id,childId:t.id,type:ie,onComplete:function(e){if(e.value||e["@value"]){var o=x.replace(L.i18n("E6WCommonUI.Alert.ChildIsAlreadyInParentStructure"),{PARENT_NAME:i.get("title"),CHILD_NAME:t.get("title")});L.displayError(o),s&&s.onFailure&&s.onFailure(void 0,void 0,{dontShowFailureMessage:!0})}else i.addValidatedChildWorkscopeAndSave(n.getObjectById(t.id),s)}}),b.checkParentHierarchyForId(o)},addValidatedChildWorkscopeAndSave:function(t,n){var s=e.clone(n||{},!1).sequenceOrder||this._getDefaultSequenceOrderForAttribute(p.CHILDREN_ATTR),i={};i[this.isDSLC()?"dsxplan:sequenceOrder":p.SEQUENCE_ORDER_ATTR]=s,i[p.WORKSCOPE_PARENT_ATTR]=this,t.save(i,{onComplete:n.onComplete,onFailure:n.onFailure,mask:"dsplan:MVMask.WorkPackage.Collapsed"})},updateReferenceSequenceOrder:function(e,t){let n=this.get("dsplan:referenceConfig"),s=n?JSON.parse(n):{};s[e]=t,this.set("dsplan:referenceConfig",JSON.stringify(s))},addValidatedReferenceWorkscopeAndSave:function(e,t){var n=this.getDefaultSequenceOrderForReference();this.updateReferenceSequenceOrder(e.get("@id"),n),this.addModelToAttributeWithCollection(p.REFERENCE_PROJECT_ATTR,e),this.save({},{onComplete:t.onComplete,onFailure:t.onFailure,mask:"dsplan:MVMask.WorkPackage.Collapsed"})},removeReferenceFromParent:function(e){let t=e&&e.parent;t&&t.getRDFModel&&(t=t.getRDFModel());let n=this.get(p.PARENT_REFERENCE_PROJECT_ATTR);if(t||n.size()>0){let s=t||n.at(0);s.removeObject(p.REFERENCE_PROJECT_ATTR,this),this.parentId=void 0,s.save(void 0,{onComplete:function(){s.dispatchEvent("onRemoveReference"),e.onComplete&&e.onComplete()},onFailure:e.onFailure,mask:"dsplan:MVMask.WorkPackage.Collapsed"})}},add:function(e,t,n){if(e===p.CHILDREN_ATTR)throw new Error("Use addChildWorkscopeAndSave method instead");return[this.addModelToAttributeWithCollection(e,t,n)]},isReferenceProject:function(e){let t=this.get("dsplan:referenceConfig"),n=t?JSON.parse(t):{};return Object.keys(n).indexOf(e)>-1},isVersion:function(){return!0},getDurationString:function(e){return n.millisecondsToXsdDayTimeDuration(8*parseFloat(e)*60*60*1e3)},_onRequest:function(){this.fetching=!0},_onCompleteRequest:function(){this.fetching=!1},_getDefaultChildWorkscopeAttributes:function(){var e={};return e[p.TITLE_ATTR]="Child WS",e[p.DESCRIPTION_ATTR]="",e[p.STATE_ATTR]="dsxplan:Open",e["dsxplan:jsType"]="dsplan:Project",e[p.SEQUENCE_ORDER_ATTR]=this._getDefaultSequenceOrderForAttribute(p.CHILDREN_ATTR),e},insertChildWorkscopeAtTop:function(e,t){var n=this.getSequenceOrderForNewFirstChild("dsxplan:hasWorkDecomposition");this._insertChildWorkscopeWithSequenceOrder(e,n,t)},insertChildWorkscopeBefore:function(e,t){var n=this.getSequenceOrderForObject({model:e,collection:this.getWorkscopes(),referenceModel:t.referenceModel,placement:"before"});this._insertChildWorkscopeWithSequenceOrder(e,n,t)},insertChildWorkscopeAfter:function(e,t){var n=this.getSequenceOrderForObject({model:e,collection:this.getWorkscopes(),referenceModel:t.referenceModel,placement:"after"});this._insertChildWorkscopeWithSequenceOrder(e,n,t)},insertChildWorkscopeAtBottom:function(e,t){var n=this;this.fetch({mask:"dsplan:MVMask.WorkPackage.Expanded",onlyIfNeeded:!0,onComplete:function(){var s=n.getSequenceOrderForLastChild("dsplan:hasWorkDecomposition");n._insertChildWorkscopeWithSequenceOrder(e,s,t)}})},_insertChildWorkscopeWithSequenceOrder:function(t,n,s){var i=e.clone(s,!1);this.getWorkscopes().contains(t)?(t.set(p.SEQUENCE_ORDER_ATTR,n),t.save(void 0,{onComplete:i&&i.onComplete,onFailure:i&&i.onFailure})):this.addChildWorkscopeAndSave(t,{sequenceOrder:n,onComplete:i&&i.onComplete,onFailure:i&&i.onFailure})},getSequenceOrderForObject:function(e){var t=e.placement||"after",n=e.collection.indexOf(e.referenceModel),s=e.referenceModel.get(p.SEQUENCE_ORDER_ATTR);if(0===n&&"after"!==t)return s-1-Math.random();if(n===e.collection.length-1&&"after"===t)return s+1+Math.random();var i="after"===t?n+1:n-1,o=e.collection.at(i).get(p.SEQUENCE_ORDER_ATTR);return(s+o)/2+(Math.random()-.5)*(s-o)/2},getSequenceOrderForNewFirstChild:function(e){var t=this.get(e);return 0===t.length?Math.random():t.first().get(p.SEQUENCE_ORDER_ATTR)-1-Math.random()},getSequenceOrderForLastChild:function(e){var t=this.get(e);return 0===t.length?Math.random():t.last().get(p.SEQUENCE_ORDER_ATTR)+1+Math.random()},_setAndSaveSequenceOrders:function(){},getCollectionAttributeBasedOnModel:function(e){return e instanceof m?"dsxplan:hasConstraint":e instanceof S?"dsxplan:hasGate":e instanceof D?"dsxplan:hasMilestone":e instanceof c?"dsxplan:hasTask":e instanceof ie?"dsxplan:hasWorkDecomposition":void 0},onShareNotification:function(e){this._parent.apply(this,arguments),this.getTeamMembers().length>0&&this.getTeamMembers().fetch({ajax:e.ajax,remove:!0,forceFetch:!0,onFailure:function(){this.destroy({noServer:!0})}.bind(this)})},onCollectionRollback:function(e){"dsxplan:hasAssignee"===e&&this.getTeamMembers().length>0&&this.getTeamMembers().fetch({reset:!0})},isExpandable:function(){const e=!this.isNew()&&ie._RapidRDFModelRegistry.getOrCreateFromRDFModel(this);return e&&e.isExpandable()},fetchForScheduleFacet:function(e){const t=!this.isNew()&&ie._RapidRDFModelRegistry.getOrCreateFromRDFModel(this);if(t){const s=n.getBatchGenerator(),i={ajax:s.ajax};t.getWorkscopes(i),(!e||!e.noTasks)&&t.getTasks(!1,i),s.sendBatch(e)}},hasChildWorkscopes:function(){var e=this.getWorkscopes();return Boolean(e.length||e.hasMoreItems())},hasTasks:function(){var e=this.getTasks();return Boolean(e.length||e.hasMoreItems())},ownsOrContainsTask:function(e,t){var n=this,s=t&&t._models;return!!["dsplan:ownedTasks","dsplan:assignedTasks","dsxplan:hasLeafTasks","dsxplan:candidateAssigneeTasks"].find((function(t){return(t=n.get(t))&&-1!==t.indexOf(e)}))||(s?s.includes(e):-1!==this.getTasks().indexOf(e))},_parseNestedModelsAndCollections:function(e){var t=e["dsxplan:hasTaskVocabulary"],n=e["dsxplan:hasMilestoneVocabulary"];function s(e){e["dsxplan:jsType"]||(e["dsxplan:jsType"]="dsxplan:Vocabulary");var t=e["dsplan:vocabularyTerms"];t&&t.member.forEach((function(e){e["dsxplan:jsType"]||(e["dsxplan:jsType"]="dsxplan:VocabTerm")}))}return t&&s(t),n&&s(n),this._parent.apply(this,arguments)},canShare:function(){return w.isXppViewer()?this._parent.apply(this,arguments):(void 0===this._accessShare&&_.AccessModelQueue.requestFetch(this),Boolean(this._accessShare))},exportToCSV:function(t){var s=e.clone(t||{},!1);s.data=this.id,n.invokeAsLRT("dsxplan:downloadCSV",s)},getAccessBatch:function(t){var s=this,i=this._parent.apply(this,arguments);return i.ajax(n.expandUrl(_.ACCESS_URL),{method:"POST",onComplete:function(n){return s.setShareAccess(n["@value"]),t&&e.is(t.onComplete,"function")&&t.onComplete.apply(this,arguments)},onFailure:function(){return t&&e.is(t.onFailure,"function")&&t.onFailure.apply(this,arguments)},onTimeout:t&&t.onFailure,headers:{"Content-Type":"application/json"},data:JSON.stringify([this.id,_.SHARE_DATA]),type:"json"}),i},handleDeleteFailure:function(e){var t=e.onTimeout,n=this;e.onTimeout=function(){delete n._collectionsRemovedFrom,t&&t.apply(n,arguments)},this._parent(e)},parse:function(e,t){var n;this.dispatchEvent("onParseStart");try{n=this.handleIsFavoriteAndAccessedDate(e),n=this.handleRestrictAssigneeAccess(e),n=this._parent(n,t)}finally{this.dispatchEvent("onParseEnd")}return n},handleRestrictAssigneeAccess:function(e){if(e&&e.hasOwnProperty(q)&&(e[J]=e[q],delete e[q]),e&&e[J]){let t=e[J];e[J]=t&&"boolean"==typeof t?t?"TRUE":"FALSE":"TRUE"===t}return e},handleIsFavoriteAndAccessedDate:function(e){if(e){let t=e["dsxplan:projectAccess"];t&&(e["dsplan:accessedDate"]=t["dsplan:accessedDate"],e["dsplan:isFavorite"]=t["dsplan:isFavorite"],delete e["dsxplan:projectAccess"])}return e},unset:function(e){e===p.WORKSCOPE_PARENT_ATTR&&this.unset(p.HAS_PARENT_ATTR),this._parent.apply(this,arguments)},isXProject:function(){return"dsplan:xProject"===(this.get(p.PROJECT_TYPE)||this.get("@type")||this.get(p.JS_TYPE_ATTR))},getDragType:function(){var e=this.get(p.PROJECT_TYPE);return e||(e=this._parent.apply(this,arguments)),e=this.get("dsplan:isTemplate")?"dsplan:ProjectPlanningTemplate":e},set:function(){var t=L.setHelper.apply(this,arguments),n=e.clone(t.attrs||{},!1),s=e.clone(t.options||{},!1);return this.isXProject()&&!s.dontRegisterChange&&delete n[p.PROJECT_TYPE],this._parent(n,s)},addAsRecent:function(e){var t=this;let s=[n.jsonURIToSparqlURI(this.id)];e&&(s.push(!0),this.set("dsplan:isFavorite",!0)),this.adding=!0;let i=t.getObjectType()+(t.get("dsplan:isTemplate")?" "+j("E6WCommonApps.Label.TemplateName"):"");n.request(n.expandUrl("invoke/dsxplan:addToRecentProjects?mask=dsplan:MVMask.WorkPackage.Favorite"),{method:"POST",type:"json",data:JSON.stringify(s),headers:{"Content-Type":"application/json"},onComplete:function(n){t.adding=!1,t.set("dsplan:accessedDate",n.accessedDate),e&&L.displaySuccess(j("E6WCommonApps.Alert.AddToFavoritesSuccess").replace("{PROJECT_NAME}",t.get("title")).replace("{TYPE}",i))},onFailure:function(){t.adding=!1,e&&(t.set("dsplan:isFavorite",!1),L.displayError(j("E6WCommonApps.Alert.AddToFavoritesFailure").replace("{PROJECT_NAME}",t.get("title")).replace("{TYPE}",i)))}})},removeFromFavorites:function(){var e=this;this.set("dsplan:isFavorite",!1);let t=e.getObjectType()+(e.get("dsplan:isTemplate")?" "+j("E6WCommonApps.Label.TemplateName"):"");n.request(n.expandUrl("invoke/dsxplan:removeFromFavorites?mask=dsplan:MVMask.WorkPackage.Favorite"),{method:"POST",type:"json",data:JSON.stringify(n.jsonURIToSparqlURI(this.id)),headers:{"Content-Type":"application/json"},onComplete:function(){L.displaySuccess(j("E6WCommonApps.Alert.RemoveFromFavoritesSuccess").replace("{PROJECT_NAME}",e.get("title")).replace("{TYPE}",t))},onFailure:function(){e.set("dsplan:isFavorite",!0),L.displayError(j("E6WCommonApps.Alert.RemoveFromFavoritesFailure").replace("{PROJECT_NAME}",e.get("title")).replace("{TYPE}",t))}})},getStartDate:function(){const e=this.getRollupDates();return e?e.start:void 0},getEndDate:function(){const e=this.getRollupDates();return e?e.end:void 0},getAccumulatedStoryPoints:function(){var e=this.get(Q);if(e){var t=e.get("dsxplan:accumulatedStoryPoints");return t||0}},checkFeatureAccess:{scheduleHighlight:function(){},addingSubTasks:function(){},risk:function(){}},getNonAgileWorkscopes:function(){return this.getWorkscopes().filter((e=>!e.isAgile()))},getRDFModel:function(){return this},createNodeData:function(){let t=this._parent.apply(this,arguments);return e.merge(t,{nodeType:"workscope"}),t},getStartingFacet:function(){return this.isAgile()?p.BACKLOG_FACET:p.TASK_FACET},hasMilestonesOrGates:function(){return 0!==this.getGates().length||0!==this.getMilestones().length},getScheduleHeight:function(){return this.hasMilestonesOrGates()?ie.WORKSCOPE_MILESTONE_NODE_HEIGHT-1:ie.NODE_HEIGHT_NO_MILESTONES-1},canDelete:function(){return!k.isRootProjectInScenario(this)&&this._parent.apply(this,arguments)},resetRecursive:function(){this._parent.apply(this,arguments),this._allConstraints&&this._allConstraints.destroy(),this._allConstraints=void 0}},I);ie.SEQUENCE_ORDER_ATTR="dsplan:sequenceOrder",Object.defineProperty(ie.prototype,"beingCreatedOnServer",{get:function(){return this._beingCreatedOnServer},set:function(e){var t=this._beingCreatedOnServer;this._beingCreatedOnServer=e,t!==this._beingCreatedOnServer&&this.dispatchEvent("onChange:beingCreatedOnServer")}}),Object.defineProperty(ie.prototype,"solveCounter",A.solveCounterDef),Object.defineProperty(ie.prototype,"prevSolveCounter",A.prevSolveCounterDef),ie.KPI_URI="dsmf:xplan.xPlanKPI.getKPIsForUpcomingMilestone?$mask=dsplan:MVMask.KeyPerformanceIndicator.Complex";var oe=ie.prototype.dslcMapping,ae=n.inverseMapping(oe);return ie.prototype.inverseDslcMapping=ae,ie.TIMEZONE_ATTR=X,ie.implement(f,R,P,y,A,{setup:function(){this._beingCreatedOnServer=!1,this._listenToModel(),this._listenToChildrenCollections(),this._registerAsParentOfAllChildrenModels(),this._previous.apply(this,arguments),this.updateThumbnailImage(),this.isNew()&&(this.mask="dsplan:MVMask.WorkPackage.Complex"),this.getCollectionAttribute(p.CONSTRAINT_RELATION_ATTR,void 0,{}),this.getAttachments(),this.getDeliverables(),this.getBaselines(),this.getBacklogTasks(),this.workscopeId="WorkscopeModel"+parseInt(1e4*Math.random()),this.unassignedPlaceholderModel=new W({parentProject:this})}}),ie.processDropData=function(e,t){var s=this&&this.id,i=L.getDataTransferJSON(e),o=!1;return i.data&&i.data.items.forEach((function(e){var i=U.validateDroppedObject(e,t);i||s!==n.removeBracketLongURI(e.objectId)||(i=L.i18n("E6WCommonUI.Alert.PlanOwnChild")),i&&(L.displayError(i),o=!0)})),o},ie.sanitizeTermForSearch=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},ie.NODE_HEIGHT_NO_MILESTONES=34,ie.WORKSCOPE_MILESTONE_NODE_HEIGHT=46,ie.MILESTONE_RELATION_ATTR=G,ie.TASK_RELATION_ATTR=B,ie.TEAM_MEMBERS=$,ie.ROLLUP_START=te,ie.ROLLUP_END=ne,ie._RapidRDFModelRegistry={getOrCreateFromRDFModel:Function.prototype},ie})),define("DS/E6WCommonApps/DeleteUtil",["UWA/Core","DS/E6WCommonUI/UIHelper","DS/UIKIT/Input/Toggle","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/Models/ConstraintModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Utils/ModalManager","DS/RDFFoundation/RDFUtils","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","DS/Handlebars/Handlebars4"],(function(e,t,n,s,i,o,a,r,l,d){"use strict";var c=function(e){return l.get(e)},p={_getDeleteModalBody:function(t,s,i,o){var a=e.clone(o||{},!1),r=a.selectedModels,p=a.areAllSelectedModelsProjects,u=e.createElement("div"),h=s?"E6WCommonApps.Label.AreYouSureDeleteProject":"E6WCommonApps.Label.AreYouSureDelete";let m;return h=i?"E6WCommonApps.Label.AreYouSureConstraint":h,m=r?c(p?"E6WCommonApps.Label.AreYouSureDeleteSelectedProjects":"E6WCommonApps.Label.AreYouSureDeleteSelectedTasks"):l.replace(c(h),{NAME:d.Utils.escapeExpression(t)}),e.createElement("p",{html:m}).inject(u),(s||p)&&(this._deleteCheckBox=new n({type:"checkbox",label:c("E6WCommonApps.Label.DeleteSubprojects"),checked:!1,className:"primary"}).inject(u)),u},deleteItem:function(n){var o=e.clone(n||{},!1),r=o.model,d=o.parentView,u=o.modal||d&&d.getSuperModal()||a.getSuperModal(!0),h=r&&r.get("title"),m=r instanceof s,T=r instanceof i,E=T?"E6WCommonApps.Label.ConfirmDeleteConstraint":"E6WCommonApps.Label.ConfirmDelete",g=o.selectedModels?c("E6WCommonApps.Label.ConfirmDeleteSelectedTask"):l.replace(c(E),{NAME:t.escapeHTML(h)});u.dialog({body:p._getDeleteModalBody(h,m,T,n),title:g,buttons:[{className:"primary",value:c("E6WCommonApps.Label.Delete"),action:function(t){o.selectedModels?p.deleteSelectedItems({selectedModels:o.selectedModels,parentView:o.parentView}):(o.isStructureDelete=m&&p._deleteCheckBox.isChecked(),p._destroyModelAndSetNewRoute(r,d,{isProject:m,isStructureDelete:m&&p._deleteCheckBox.isChecked()})),t.hide(),e.is(o.callback,"function")&&o.callback.apply(this,arguments)}},{value:c("E6WCommonApps.Command.Cancel"),action:function(e){e.hide()}}]})},deleteSelectedItems:function(e){let n=e&&e.selectedModels;if(n){let s=r.getBatchGenerator();s.requests=[],s.iOptions=e,n.forEach((function(e){e.destroy({ajax:s.ajax}),t.trackPageEvent({scope:window.widget&&window.widget.getValue("appId"),eventCategory:"taskMenu",eventAction:"delete",eventLabel:"model",eventValue:e})})),s.sendBatch({onComplete:()=>{t.displaySuccess(c("E6WCommonApps.Alert.AllSelectedItemsDeleted"));let e=s.iOptions&&s.iOptions.parentView&&(s.iOptions.parentView._parentView||s.iOptions.parentView);e&&e.clearSelectedCards&&e.clearSelectedCards()},onFailure:function(e){var n;n=e&&e.message&&c(e.message)!==e.message?c(e.message):l.replace(c("E6WCommonApps.Error.FailedToDeleteSelectedItems")),t.displayError(n)}})}},_destroyModelAndSetNewRoute:function(e,n,i){var o=i.isProject;s.justDeletedProjectID=e.get("@id"),setTimeout((function(){delete s.justDeletedProjectID}),1e4),e.destroy({onComplete:function(){var s=l.replace(c("E6WCommonApps.Alert.ObjectDeleted"),{OBJECT_NAME:c("E6WCommonApps.Type."+e.getObjectType())});if(t.displaySuccess(s),n)if("function"==typeof n.closePropertyPanel)n.closePropertyPanel();else{var i=n._parentView&&n._parentView.detailsPanelManager;if(i&&"function"==typeof i.getExternalDetailsPanel){var o=i.getExternalDetailsPanel();o&&"function"==typeof o.close&&o.close()}}n&&n._parentView&&n._parentView.clearSelectedCards&&n._parentView.clearSelectedCards()},onFailure:function(n,s){var i;i=s&&s.message&&c(s.message)!==s.message?c(s.message):l.replace(c("E6WCommonApps.Error.FailedToDeleteObject"),{OBJECT_NAME:c("E6WCommonApps.Type."+e.getObjectType())}),t.displayError(i)},onTimeout:function(){o&&t.displaySuccess(c("E6WCommonApps.Label.ProjectDeleted"))},isStructureDelete:i.isStructureDelete})},restoreItem:function(e){var n=e.collection;n&&n.remove(e),e.restore({onComplete:function(){t.displaySuccess(c("E6WCommonApps.Alert.ProjectRestored"))},onFailure:function(){t.displayError(c("E6WCommonApps.Alert.RestoreFailed")),n.add(e)},onTimeout:function(){t.displaySuccess(c("E6WCommonApps.Alert.ProjectRestored"))}})}};return p})),define("DS/E6WCommonApps/TreeDocument/E6WTreeDocument",["UWA/Core","DS/TreeModel/TreeDocument","DS/E6WCommonApps/TreeDocument/E6WTreeNodeModel","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/Models/WorkscopeTreeNodeModel","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/TaskTreeNodeModel","DS/E6WCommonApps/Models/MilestoneModel","DS/E6WCommonApps/Models/MilestoneTreeNodeModel"],(function(e,t,n,s,i,o,a,r,l){"use strict";const d=function(s){this._pushUpdateTimeoutCount=0,this._isExpandedCallback=s&&s.isExpanded;let i={nodeModelClass:n};e.merge(i,s),t.call(this,i),this._modelMap=new WeakMap,this.addEventListener("addChild",(e=>this.registerModel(e.data.nodeModel))),this.addEventListener("removeChild",(e=>this.unregisterModel(e.data.nodeModel)))};return(d.prototype=Object.create(t.prototype,{constructor:{value:d}})).registerModel=function(e){if(!e._isTrueRoot()){const t=this._modelMap.get(e.rdfModel);if(t&&t!==e)throw new Error("Registering duplicate tree node model");this._modelMap.set(e.rdfModel,e)}},d.prototype.unregisterModel=function(e){e._isTrueRoot()||this._modelMap.delete(e.rdfModel)},d.prototype.getTreeNodeModelFromRdfModel=function(e){return this._modelMap.get(e)},d.prototype.shouldBeExpanded=function(e){return!!e._isTrueRoot()||(!this._isExpandedCallback||this._isExpandedCallback(e))},d.prototype.pushUpdateDelayed=function(){this._pushUpdateTimeout=this._pushUpdateTimeout||setTimeout((()=>{for(let e=0;e<this._pushUpdateTimeoutCount;e++)this.pushUpdate();this._pushUpdateTimeoutCount=0}),0),this._pushUpdateTimeoutCount++},d.prototype.destroy=function(){this._pushUpdateTimeout&&clearTimeout(this._pushUpdateTimeout),this._pushUpdateTimeout=void 0,t.prototype.destroy.apply(this,arguments)},d.prototype.getTreeNodeModelConstructor=function(e){return e instanceof s?i:e instanceof o?a:e instanceof r?l:n},d})),define("DS/E6WCommonApps/Models/ScenarioModel",["UWA/Core","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/GateModel","DS/E6WCommonApps/Models/MilestoneModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonUI/PlatformManager","DS/RDFFoundation/RDFUtils"],(function(e,t,n,s,i,o,a,r,l){"use strict";const d="dsplan:MVMask.Task.ScheduleView";var c=n.extend({_uwaClassName:"ScenarioModel",isXProject:function(){return!0},canModify:function(){return!0},canDelete:function(){return!0},getImage:function(){return require.toUrl("DS/XPlanApp/assets/img/I_Scenario_22.png")},getScenarioJSON:function(){return this.scenarioJSON||{}},_fixLongURIs:function(e,t){e[t]=e[t].map(l.longToShortURI)},setScenarioJSON:function(e){if(this.scenarioJSON=e,this.scenarioJSON._removedRelationships={},this.scenarioJSON&&this.scenarioJSON.objectIds)for(const e of this.scenarioJSON.objectIds)this.scenarioJSON[e]&&(this.scenarioJSON[e].remove&&Object.keys(this.scenarioJSON[e].remove).forEach((t=>{this.scenarioJSON[e].remove[t].forEach((e=>{const n=a.dslcMapping[t]||t;this.scenarioJSON._removedRelationships[e]=this.scenarioJSON._removedRelationships[e]||{},this.scenarioJSON._removedRelationships[e][n]=!0}))})),this.scenarioJSON[e].add&&Object.keys(this.scenarioJSON[e].add).forEach((t=>this._fixLongURIs(this.scenarioJSON[e].add,t))),this.scenarioJSON[e]["dsxplan:jsType"]=this.scenarioJSON[e]["dsxplan:jsType"]||this.scenarioJSON[e]["dsplan:jsType"],delete this.scenarioJSON[e]["dsplan:jsType"],this.scenarioJSON[e].isNewFromExperiment||(this.scenarioJSON[e].modify=this.scenarioJSON[e].modify||{...this.scenarioJSON[e]},this.scenarioJSON[e].add=this.scenarioJSON[e].add||{},this.scenarioJSON[e].remove=this.scenarioJSON[e].remove||{}));this._fetchDBObjectsThatArentModels()},_fetchDBObjectsThatArentModels:function(){const t=new Set,n=e=>{l.getObjectById(e)||this.scenarioJSON.newObjectIds[e]||t.add(e)};this.scenarioJSON&&this.scenarioJSON.newObjectIds&&Object.keys(this.scenarioJSON.newObjectIds).forEach((t=>{const s=this.scenarioJSON[t];Object.entries(s).forEach((([t,i])=>{e.is(i,"array")&&(this._fixLongURIs(s,t),s[t].forEach(n))}))})),this.scenarioJSON&&this.scenarioJSON.objectIds&&this.scenarioJSON.objectIds.forEach((e=>{n(e),this.scenarioJSON[e].add&&Object.entries(this.scenarioJSON[e].add).forEach((([e,t])=>t.forEach(n)))})),l.complete(void 0,[...t],{mask:d,onlyIfNeeded:!0,onComplete:()=>this.applyScenarioChanges()})},get:function(e){return e===a.IMAGE_THUMBNAIL_ATTR?require.toUrl("DS/XPlanApp/assets/img/I_Scenario_Thumbnail.png"):this._parent.apply(this,arguments)},addAsRecent:Function.prototype,fetchJSON:function(e){let t=(e||{}).onComplete;const n=r.getServiceUrl("3dplan",!0)+`/resources/v1/3dplan/experiment?experimentId=${encodeURIComponent(this.id)}`;l.request(n,{method:"GET",type:"json",headers:{"Content-Type":"application/json"},onComplete:e=>{this.setScenarioJSON(e),this.applyScenarioChanges(),t&&t.apply(this,arguments)}})},_createRDFModelFromNewObjectJSON:function(n){const s={...this.scenarioJSON[n]};Object.entries(s).forEach((([t,n])=>{e.is(n,"array")&&delete s[t]})),s["dsxplan:from"]&&(s["dsxplan:from"]["dsxplan:jsType"]=s["dsxplan:from"]["dsxplan:jsType"]||s["dsxplan:from"]["dsplan:jsType"]),s["dsxplan:to"]&&(s["dsxplan:to"]["dsxplan:jsType"]=s["dsxplan:to"]["dsxplan:jsType"]||s["dsxplan:to"]["dsplan:jsType"]),!s["@id"]&&(s["@id"]=n),!s["dsxplan:jsType"]&&(s["dsxplan:jsType"]=s["dsplan:jsType"]),delete s["dsplan:jsType"],s[a.HAS_PARENT_ATTR]=!0,s["@href"]=l.hrefFromId(n);t.mergeOrCreateObject(s).addMask(d)},_applyNewObjectRelationships:function(){Object.keys(this.scenarioJSON.newObjectIds).forEach((t=>{Object.entries(this.scenarioJSON[t]).forEach((([n,s])=>{if(e.is(s,"array")){const e=s.map((e=>l.getObjectById(e))).filter((e=>e));l.getObjectById(t)&&l.getObjectById(t).getCollectionAttribute(n).add(e,{dontRegisterChange:!0})}}))}))},applyScenarioChanges:function(){this._changeTimeout=this._changeTimeout||setTimeout((()=>{this.scenarioJSON&&this.scenarioJSON.newObjectIds&&(Object.keys(this.scenarioJSON.newObjectIds).forEach((e=>this._createRDFModelFromNewObjectJSON(e))),this._applyNewObjectRelationships()),this.scenarioJSON&&this.scenarioJSON.objectIds&&this.scenarioJSON.objectIds.forEach((e=>{const t=l.getObjectById(e);t&&t.set(t.parse({}),{noServer:!0})})),this.scenarioJSON&&this.scenarioJSON.deletedObjectIds&&Object.keys(this.scenarioJSON.deletedObjectIds).forEach((e=>{const t=l.getObjectById(e);t&&t.destroy({noServer:!0})})),setTimeout((()=>{this.scenarioJSON&&this.scenarioJSON.newObjectIds&&Object.keys(this.scenarioJSON.newObjectIds).forEach((e=>{const t=l.getObjectById(e);t&&"ConstraintModel"===t._uwaClassName&&t.updateParentWorkscopes()}))}),0),this._changeTimeout=void 0}),100)},isNewInScenario:function(e){return Boolean(this.scenarioJSON&&this.scenarioJSON.newObjectIds&&this.scenarioJSON[e]?.isNewFromExperiment)}});return c.CHANGE_TIMEOUT=100,c})),define("DS/E6WCommonApps/E6WCommonAppsTypeDictionary",["UWA/Core","DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/Models/UsersGroupRDFModel","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ComponentProxyModel","DS/RDFFoundation/Models/URLModel","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/Models/LogicalUserModel","DS/E6WCommonApps/Models/ConstraintModel","DS/E6WCommonApps/Models/ScenarioModel","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/MilestoneModel","DS/E6WCommonApps/Models/GateModel","DS/E6WCommonApps/Models/CalendarModel","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/Models/RollUpModel","DS/E6WCommonApps/Models/BaselineModel","DS/E6WCommonApps/Checklist/ChecklistItemModel","DS/E6WCommonApps/TreeDocument/TreeModelMixin"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,E,g,A){"use strict";return e.merge(s.typeDictionary,{mapping:[{key:"dsplan:Project",type:m},{key:"dsplan:xProject",type:m},{key:"dsxplan:WorkPackageVersion",type:m},{key:"dsplan:WorkPackage",type:m},{key:"dsxplan:WorkPackage",type:m},{key:"dsplan:Task",type:c},{key:"dsxplan:Task",type:c},{key:"dsxplan:TaskVersion",type:c},{key:"dsplan:Milestone",type:p},{key:"dsxplan:Milestone",type:p},{key:"dsxplan:MilestoneVersion",type:p},{key:"dsplan:Gate",type:u},{key:"dsxplan:Gate",type:u},{key:"dsxplan:GateVersion",type:u},{key:"dsplan:TemporalConstraint",type:l},{key:"dsxplan:TemporalConstraint",type:l},{key:"dsplan:ControlledTemporalConstraint",type:l},{key:"dsxplan:ControlledTemporalConstraint",type:l},{key:"foaf:Person",type:t},{key:"foaf:Group",type:n},{key:"dsplan:LogicalUser",type:r},{key:"dscom:ComponentProxy",type:i},{key:"dsplan:url",type:o},{key:"Person",type:t},{key:"dsplan:Calendar",type:h},{key:"swym:WeDo",type:c},{key:"dsplan:RolledUpInfo",type:T},{key:"dsplan:Baseline",type:E},{key:"dsplan:ProjectPlanningTemplate",type:m},{key:"dsplan:AgileProject",type:m},{key:"dsplan:ChecklistItem",type:g},{key:"dsplan:Experiment",type:d}],masksStrength:{"dsplan:MVMask.Task.CollaborativeTask.siblings":2,"dsplan:MVMask.WorkPackage.Basic":15,"dsplan:MVMask.WorkPackage.Collapsed":27,"dsplan:MVMask.WorkPackage.Expanded":32,"dsplan:MVMask.WorkPackage.Complex":111,"dsplan:MVMask.Task.Property":235,"dsplan:MVMask.Task.Basic":42,"dsplan:MVMask.Task.Complex":53,"dsplan:MVMask.Task.CollaborativeTasks.Complex":57}}),i.implement(A),s.typeDictionary})),define("DS/E6WCommonApps/Collections/PaginatedTasksCollection",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/RequestUtils","DS/E6WCommonApps/XTaskScope","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/TaskModelMixin","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Collections/RDFTasksCollection","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u){"use strict";var h=["dsplan:estimatedEndDate","dsplan:hasPriority","dscom:hasMaturity","dsplan:actualEndDate"],m=["dsplan:estimatedEndDate","dsplan:sequenceOrder"],T={stateForDisplay:"dscom:hasMaturity",priority:"dsplan:hasPriority"};T[d.DUE_DATE_CATEGORY]=d.DUE_DATE_CATEGORY;var E={"To Do":"dsxplan:Open","In Progress":"dsxplan:InProgress",Done:"dsxplan:Done",Low:"dsxplan:Low",Medium:"dsxplan:Medium",High:"dsxplan:High",Urgent:"dsxplan:Urgent"},g={id:"blankModel",isBlank:!0,isNew:function(){return!1},dataForRendering:function(){return{}},calculateAndSetUpListenersForVisualAttributesIfNeeded:Function.prototype,get:Function.prototype},A=l.dateHelper,C=new n,_=t.extend({_uwaClassName:"PaginatedTasksCollection",init:function(e,t){this._parent.apply(this,arguments),this.setup(e,t)},setup:function(e,t){this._view=t.view,this._filterAttr=T[t.view],this._filterAttrNLS=t.attrNLSValue,this.actualValueForFiltering=E[t.attrValue]?E[t.attrValue]:t.attrValue,this._valueForFiltering={actualValue:t.attrValue,displayValue:t.attrNLSValue},this._filterValue=t.attrValue,this.initialLoad=!0,this.parentModel=t.parentModel,this._models=[],Object.defineProperty(this,"fetching",{get:()=>this._fetching,set:e=>{this._fetching=e,this.dispatchEvent(d.ON_FETCH_COUNT_CHANGED)}}),this.loadedRanges=[],this.fetching=null,this.nextFetching=null},url:function(){var e=i.expandUrl("/invoke/dsxplan:getProjectTasks");return e=e.replace("3DPLAN","3drdfindex")},readyToFetch:function(e){return this.hasContextUserBeenSet()||(_._isSettingUserContext||_.loginToRDFIndexVM(),this.listenTo(C,"onLogin",(function(){this.fetch(e)}))),this.hasContextUserBeenSet()},fetch:function(t){if(this.readyToFetch(t)){var n=e.clone(t||{},!1);n.limit=n.limit||_.LIMIT,n.offset=e.is(n.offset)?n.offset:0,this.fetching&&this.fetching.offset===n.offset&&this.fetching.limit===n.limit||(this.fetching?this.nextFetching=n:(this.fetching=n,n.model=this.parentModel,this.currentFetchRequest=i.request(this.url(),this.buildFetchOptions(n))))}},buildFetchOptions:function(e){var t={id:this.parentModel.id,limit:e.limit,includeCount:e.includeCount,attrs:h,offset:e.offset,sortKeys:m,filterAttrs:[],jsType:e.jsType};this._view===d.DUE_DATE_CATEGORY?t.filterAttrs=t.filterAttrs.concat(this.getDateFilters(this.actualValueForFiltering)):t.filterAttrs.push({name:this._filterAttr,value:this.actualValueForFiltering,comparator:"="}),"priority"!==this._view&&this._view!==d.DUE_DATE_CATEGORY||t.filterAttrs.push({name:"dscom:hasMaturity",value:"dsxplan:Done",comparator:"!="}),this._addOwnerAndAssigneeFilterIfNeeded(t.filterAttrs),this._addJSType(t);var n={method:"POST",type:"json",at:e.offset,data:JSON.stringify(t),fromServer:!0,onComplete:t=>{this.currentFetchRequest=void 0,e.onComplete&&e.onComplete(t)},onFailure:t=>{this.currentFetchRequest=void 0,e.onFailure&&e.onFailure(t)},headers:{"Content-Type":"application/json"}};if(!e.noSet){var s=this;n.onComplete=function(t){this.currentFetchRequest=void 0,s.set(t.items.member,{at:e.offset,totalItems:t.totalItems}),e.onComplete&&e.onComplete()},n.onFailure=t=>{this.currentFetchRequest=void 0,e.onFailure&&e.onFailure(t)}}return n},_addOwnerAndAssigneeFilterIfNeeded:function(e){var t=a.getFilter();t===a.FILTER_ASSIGNED?e.push({name:"dsplan:hasAssignee",value:u.getContextUserUid(),comparator:"="}):t===a.FILTER_OWNED&&e.push({name:"dskern:owner",value:u.getContextUserUid(),comparator:"="})},_addJSType:function(e){if(e.jsType){for(var t=JSON.parse(e.jsType),n=0;n<t.length;n++)e.filterAttrs.push({name:"dsplan:jsType",value:' "'+t[n]+'" ',comparator:"="});delete e.jsType}},cancelCurrentRequest:function(){this.currentFetchRequest&&this.currentFetchRequest.cancel()},indexOf:function(e){return this._models.indexOf(e)},find:function(e){return this._models.find(e)},add:function(e,t){var n,s;if(s=t&&void 0!==t.position?{position:t.position,blank:!1}:this.findInsertable(e),this.loadedRanges.length>0&&(this.loadedRanges.forEach((function(e){e.start=s.position<=e.start?e.start+1:e.start,e.end=s.position<=e.end?e.end+1:e.end})),n=s.position),n&&0!==n||(n=0,this.updateLoadedRanges({start:0,end:1})),e=s.blank?g:e,this._models.splice(n,0,e),t&&t.replace){var i=this.indexOf(g);-1!==i&&this._models.splice(i,1)}return this.dispatchEvent(_.Events.SizeEvent,[this._models.length]),this.dispatchEvent("onAdd",e),this._listenToModel(e),n},_listenToModel:function(e){function t(e,t){!t&&e&&this.remove(e)}this.listenTo(e,"onAnyEvent",(function(e,t,n,s){this.dispatchEvent(e,[t,n,s])})),this.listenTo(e,"onChange:"+d.TASK_PARENT_ATTR,t),this.listenTo(e,"onChange:"+d.PARENT_ATTR,t),this.listenTo(e,"onDestroy",this.remove)},comparator:function(e,t){var n=Date.parse(e.getEndDate()),s=Date.parse(t.getEndDate());return this.actualValueForFiltering===d.STATE_DONE?s-n:n!==s?n-s:e.get(d.SEQUENCE_ORDER_ATTR)-t.get(d.SEQUENCE_ORDER_ATTR)},findInsertable:function(e){var t={position:-1,blank:!0};if(e.isNew())t.position=0,t.blank=!1;else if(this.loadedRanges.length>0)e:for(var n=0;n<this.loadedRanges.length;n++){var s=this.loadedRanges[n],i=this.comparator(e,this.at(s.start))<=0;if(!i&&this.comparator(e,this.at(s.end-1))<=0){t.blank=!1;for(var o=s.start;o<s.end;o++){if(!(this.comparator(e,this.at(o))<=0)){t.position++;break e}t.position=o}}else if(i&&-1===t.position){0===s.start?(t.blank=!1,t.position=0):t.position=s.start-1;break e}}return-1===t.position&&(t.blank=!1,t.position=this._models.length),t},at:function(e){return this._models[e]},getSelection:function(e,t){return this._models.slice(e,t)},contains:function(e){return this._models.includes(e)},reset:function(){var e=this;this._models.forEach((t=>{e.stopListening(t)})),this._models=[],this.loadedRanges=[],this.dispatchEvent(_.Events.SizeEvent,[0])},remove:function(e){var t=this.indexOf(e),n=-1;return this.loadedRanges.forEach((function(e,s){e.start=t<=e.start&&0!==e.start?e.start-1:e.start,e.end=t<=e.end?e.end-1:e.end,e.start===e.end&&(n=s)})),-1!==n&&this.loadedRanges.splice(n,1),-1!==t&&this._models.splice(t,1),this.stopListening(e),this.dispatchEvent(_.Events.SizeEvent,[this._models.length]),this.dispatchEvent("onRemove",[e,this,{index:t}]),e},get:function(){},size:function(){return this._models.length},set:function(e,t){t.totalItems&&0===this._models.length&&(this._models=Array.apply(null,Array(t.totalItems)).map((function(){return g})));for(var n=e.length,s=0;s<n;s++){var o=s+t.at,a=e[s],l=i.getExistingAndMerge(a);l||(l=new r(a,{parse:!0,mask:"dsplan:MVMask.Task.Basic"})),this._models[o]=l,this._listenToModel(l)}this.updateLoadedRanges({start:t.at,end:t.at+n}),this.dispatchEvent(_.Events.ModelsAdded,[t.at,n]),this.fetching=null,this.nextFetching&&(this.fetch(this.nextFetching),this.nextFetching=null)},updateLoadedRanges:function(e){if(e.start!==e.end){var t,n,s=this.loadedRanges.length;for(t=0;t<this.loadedRanges.length;t++)if(n=this.loadedRanges[t],e.start<n.start){s=t;break}this.loadedRanges.splice(s,0,e);for(var i=[],o=1;o<this.loadedRanges.length;){var a=this.loadedRanges[o-1];for(t=o++;t<this.loadedRanges.length;t++){n=this.loadedRanges[t];var r=a.start<=n.start&&a.end>=n.start,l=a.start<=n.end&&a.end>=n.end;r&&l?i.push(n):r?(a.end=n.end,i.push(n)):l&&(e.start=n.start,i.push(n))}this.loadedRanges=this.loadedRanges.filter((function(e){return!i.includes(e)}))}}},getMissingDataInRange:function(e,t,n){var s,i;void 0===n&&(n=!1),n?(s=e-t,i=e):(s=e,i=e+t),s=s>0?s:0,i=i<this._models.length?i:this._models.length;for(var o,a,r={},l=0;l<this.loadedRanges.length;l++){var d=this.loadedRanges[l],c=d.start<=s&&d.end>=s,p=d.start<=i&&d.end>=i,u=d.end>i;if(c&&p){r=null;break}if(c){o=d.end;break}if(p){a=d.start;break}if(u)break}return o?r.start=o:a&&(r.end=a),r},dataForRendering:function(){var e={},t={actualValue:this.actualValueForFiltering,displayValue:this._filterAttrNLS};return e.state=t,e.collabSpace=this.collabSpace,e.extid=this.extid,e.filteredByAttr=this._filterAttr,e.filteredByValue={actualValue:this._valueForFiltering,displayValue:this._filterAttrNLS},e.filteredCount=this.size(),e},getSaveAttributes:function(){var e,t={},n=(e=this._filterValue)&&e.actualValue||e;return t[this._view]=n,t},getMask:function(){return"dsplan:MVMask.Task.CollaborativeTasks.Complex"},getDateFilters:function(e){var t,n=[];switch(e){case"PAST_DUE":t={name:"dsplan:estimatedEndDate",value:p.getIntlDateFormat(A.getPast()).actualValue,comparator:"<"},n.push(t);break;case"DUE_TODAY":this.addBetweenDates(n,A.getPast(),A.getToday());break;case"DUE_TOMORROW":this.addBetweenDates(n,A.getToday(),A.getTomorrow());break;case"DUE_THIS_WEEK":this.addBetweenDates(n,A.getTomorrow(),A.getLastDayofThisWeek());break;case"DUE_FUTURE":t={name:"dsplan:estimatedEndDate",value:p.getIntlDateFormat(A.getLastDayofThisWeek()).actualValue,comparator:">"},n.push(t)}return n},addBetweenDates:function(e,t,n){var s={name:"dsplan:estimatedEndDate",value:p.getIntlDateFormat(t).actualValue,comparator:">"},i={name:"dsplan:estimatedEndDate",value:p.getIntlDateFormat(n).actualValue,comparator:"<"};e.push(s),e.push(i)},destroy:function(){this.stopListening()},hasContextUserBeenSet:function(){return _._hasContextUserBeenSet},forEach:function(e){this._models.forEach((t=>{t!==g&&e(t)}))}});return _.loginToRDFIndexVM=function(){_._isSettingUserContext=!0,i.request(i.expandUrl("resources/dsplan:Task","v1",{rdfIndex:!0}),{ignoreDictionary:!0,method:"GET",data:{},onComplete:function(){_._isSettingUserContext=void 0,_.setContextUserSet(!0),C.dispatchEvent("onLogin")},onFailure:function(){_._isSettingUserContext=void 0,_.setContextUserSet(!0),C.dispatchEvent("onLogin")}})},_.setContextUserSet=function(e){_._hasContextUserBeenSet=e},Object.defineProperty(_.prototype,"length",{get:function(){return this._models.length}}),_.implement(n,s),_.Events={SizeEvent:"sizeEvent",ModelsAdded:"modelsAdded"},_.ATTRIBUTE_MAP=T,_.LIMIT=300,_.INITIAL=30,_.TASK_ATTRS=h,_.BLANK_MODEL=g,_.SORT_KEYS=m,_.loginListener=C,_})),define("DS/E6WCommonApps/Collections/FTSTaskPseudoCollection",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/ApolloUtils","DS/RDFFoundation/Models/PersonRDFModel","DS/E6WCommonApps/XTaskScope","DS/E6WCommonApps/Models/TaskModelMixin","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Collections/PaginatedTasksCollection","DS/E6WCommonApps/SmartSchedulerUtils","DS/E6WCommonUI/TopBarSearchDispatcher","DS/E6WCommonUI/PlatformManager"],(function(e,t,n,s,i,o,a,r,l,d,c){"use strict";var p={};p[a.STATE_FOR_DISPLAY_ATTR]="custom_ProjectTasksByMaturity",p[a.PRIORITY_DISPLAY]="custom_ProjectTasksByPriority",p[a.DUE_DATE_CATEGORY]="custom_ProjectTasksByDate",p[a.TASK_TABLE]="custom_ProjectTaskIdsUpdate";var u={};u[a.STATE_FOR_DISPLAY_ATTR]="state",u[a.PRIORITY_DISPLAY]="priority";var h={[i.FILTER_ASSIGNED]:"assigneeFilter",[i.FILTER_OWNED]:"ownerFilter",[i.FILTER_CANDIDATE_ASSIGNEE]:"candidateAssignee"},m=o.dateHelper,T=r.extend({_uwaClassName:"FTSTaskPseudoCollection",setup:function(e,t){this._parent.apply(this,arguments),this._getAdditionalFetchOptions=t.getAdditionalFetchOptions},url:function(){return n.getServiceUrl()},readyToFetch:()=>!0,buildFetchOptions:function(n){const s=this._getAdditionalFetchOptions?this._getAdditionalFetchOptions():{};let i=T.getCommonParameters(e.merge(s,n));i=i.concat([{key:"limit",value:JSON.stringify(n.limit)},{key:"offset",value:JSON.stringify(n.offset)},{key:"includeCount",value:JSON.stringify(Boolean(n.includeCount))}]),this._view===a.DUE_DATE_CATEGORY?i=i.concat(this.getDateFilters()):this._view!==a.TASK_TABLE&&i.push({key:u[this._view],value:JSON.stringify(t.shortToLongURI(this.actualValueForFiltering))});var o=this;return{data:JSON.stringify({data_query_name:p[this._view],parameters:i}),method:"POST",fromServer:!0,headers:{"Content-Type":"application/json"},onComplete:function(e){try{o.parse(n,e),n.onComplete&&n.onComplete()}catch(e){console.error(e),n.onFailure&&n.onFailure(),T.setWorkingCorrectly(!1)}},onFailure:n.onFailure,onTimeout:n.onTimeout}},parse:function(e,t){var s,i,o=JSON.parse(t),a=o.body.outputs.tasks?o.body.outputs.tasks.views.tasks.data:o.body.outputs.structure.views.structure.data,r=e.includeCount&&o.body.outputs.count?o.body.outputs.count.views.count.data:o.body.outputs.tasks.views.tasks.data.length;a?(s=(i=n.parse(a)).models,r-=i.deletedModelsFound):s=[],this.set(s,{at:e.offset,totalItems:r})},getDateFilters:function(){var e=[];switch(this.actualValueForFiltering){case"PAST_DUE":e.push({key:"end",value:JSON.stringify(m.getPast().toISOString())});break;case"DUE_TODAY":this.addBetweenDates(e,m.getPast(),m.getToday());break;case"DUE_TOMORROW":this.addBetweenDates(e,m.getToday(),m.getTomorrow());break;case"DUE_THIS_WEEK":this.addBetweenDates(e,m.getTomorrow(),m.getLastDayofThisWeek());break;case"DUE_FUTURE":e.push({key:"start",value:JSON.stringify(m.getLastDayofThisWeek().toISOString())})}return e},addBetweenDates:function(e,t,n){var s={key:"start",value:JSON.stringify(t.toISOString())},i={key:"end",value:JSON.stringify(n.toISOString())};e.push(s),e.push(i)},hasContextUserBeenSet:function(){return!0},toArray:function(){return[...this._models]}});return T.addOwnerAndAssigneeFilterIfNeeded=function(e){var n,s,o=i.getFilter();if(o in h){var a=h[o];n=e.find((function(e){return e.key===a})),s="candidateAssignee"===a?JSON.stringify(!0):JSON.stringify([t.getCurrentUserName()]),n?n.value=s:e.push({key:a,value:s})}},T.addSearchTermAsParameter=function(e){var t=d.getSearchStringConvertedToRegex();t&&e.push({key:"searchTerm",value:JSON.stringify(t)})},T.getCommonParameters=function(n){var s=c.getTenant().toLowerCase(),i=[{key:"parentID",value:n.model&&JSON.stringify(t.shortToLongURI(n.model.id))},{key:"lang",value:JSON.stringify(c.getCurrentLanguage())},{key:"tenant",value:e.is(s,"string")?s:JSON.stringify("tenant")}],o=l.getCompletedTaskFilter();return""!==o&&o!==l.COMPLETED_TASK_FILTER_ALL_DAYS&&i.push({key:"fromCompletionDate",value:JSON.stringify(o)}),n.tagFilters&&(i=i.concat(n.tagFilters)),n.workContexts&&n.workContexts.length&&(i=i.concat({key:"workContextsFilter",value:JSON.stringify(n.workContexts)})),widget.getValue(a.LEVEL_PREF)===a.FIRST_LEVEL_TASKS&&i.push({key:"firstLevelOnly",value:JSON.stringify(!0)}),T.addSearchTermAsParameter(i),T.addOwnerAndAssigneeFilterIfNeeded(i),i},T._isWorkingCorrectly=!0,T.setWorkingCorrectly=function(e){T._isWorkingCorrectly=e},T.isWorkingCorrectly=function(){return Boolean(T._isWorkingCorrectly)},T})),define("DS/E6WCommonApps/Views/HistoryGridView",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","DS/Foundation2/FoundationV2Data","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/ProjectTypeUtils","DS/RDFFoundation/Models/ComponentProxyModel","DS/RDFFoundation/Models/LogicalUserModel","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Models/CalendarModel","DS/RDFFoundation/Models/MemberModel","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/BaselineModel","DS/E6WCommonApps/Models/MilestoneModel","DS/E6WCommonApps/Models/ScenarioModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/HistoryViewConstants","DS/E6WCommonApps/ScheduleConstants","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewPaginationManager","DS/CollectionView/CollectionViewStatusBar","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/TreeDocument/TreeNodeUtil","DS/E6WCommonApps/Views/HistoryGridViewConfig","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonApps/assets/nls/CollaborativeTasksNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","text!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS_en.json","text!DS/E6WCommonUI/assets/nls/E6WCommonUINLS_en.json"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,E,g,A,C,_,f,D,S,R,y,v,M,I,b,O,N,P){"use strict";const W=JSON.parse(P),F=JSON.parse(N);var k;function L(t){var n=t.getAttributeValue(v.COLUMN_DATA_INDICES.auditDetails),s=t.getAttributeValue(v.COLUMN_DATA_INDICES.auditAction),i=t.getAttributeValue(v.COLUMN_DATA_INDICES.auditModifiedBy);if(n&&n.historyView&&e.is(n.historyView._generateHistoryDescription,"function")){var o=n.historyView._generateHistoryDescription(n.changeObj,n.options);let e="",t="";return i&&(e=`${i.fullName}`),s&&(t=s.translated),(o=`${o} ${e} ${t}`)||""}return""}function U(e){e&&!e.startsWith("<")&&(e="<"+e);const t=document.createElement("div");t.innerHTML=e;const n=t.getElementsByTagName("script"),s=t.getElementsByTagName("style");for(;n.length>0;)n[0].parentNode.removeChild(n[0]);for(;s.length>0;)s[0].parentNode.removeChild(s[0]);let i=t.textContent||t.innerText||"";return i=i.replace(/\u00A0/g," ").replace(/\s+/g," ").trim(),i}function w(e){return e===A.TEMPORAL_SCHEDULING_STRATEGY?"Time Only":"Time and Resource"}function x(e){const t=R.getIntlDateTimeFormat(e);return t?t.displayValue:e}function V(e,t){const n=o.xsdDayTimeDurationToMilliseconds(e)/(60*t*60*1e3);if(null==n)return e;return`${n} ${this.i18n(n<=1?"E6WCommonApps.Label.Day":"E6WCommonApps.Label.Days")}`}function j(e){return/^<?uuid:[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}>?$/.test(e)}t.extend({}).implement(n);var B=C.extend({_uwaClassName:"HistoryGridView",tagName:"span",createTreeDocument:function(){return new D},callRegisterReusableCellContent:function(t){t.forEach((t=>{this.registerReusableCellContent({id:t.id,buildContent:t.buildContent||function(){return e.createElement("div",{class:t.className})},getTweakerPadding:function(){return M.lengthOfEachCharacter}})}))},setupResuableComponents:function(){this.callRegisterReusableCellContent([{id:M.reusableComponentIDs.auditDetails,className:"grid-object grid-member"}])},createNLSMap:function(e){const t=new Map;for(const n of e)for(const[e,s]of Object.entries(n))t.has(s)||t.set(s,e);return t},getNLSKey:function(e,t,n){return(n=n||{}).isValue&&t.has(e)&&(e=t.get(e)),e},i18n:function(e,t){if(!this.nlsMap){const e=[W,F];this.nlsMap=this.createNLSMap(e)}e=this.getNLSKey(e,this.nlsMap,t);var n=b.get(e);return n===e&&(n=I.get(e)),n===e&&(n=O.get(e)),n},createNodeData:function(e){try{var t={};return t.date=e.date||null,t[v.COLUMN_DATA_INDICES.auditModifiedBy]=e.modifiedBy||null,e.details&&"object"==typeof e.details.changeObj?t[v.COLUMN_DATA_INDICES.auditAction]=e.details.changeObj.action||null:t[v.COLUMN_DATA_INDICES.auditAction]=null,t[v.COLUMN_DATA_INDICES.auditType]=e.changetype||null,t[v.COLUMN_DATA_INDICES.auditDetails]=e.details||{},t[v.COLUMN_DATA_INDICES.auditObjectName]=e.details.resourceId,t}catch(e){return console.error("Error creating node data:",e),{}}},_mapRDFDataToS3Format:function(e){var t=[],n=e.rootObject&&e.rootObject.id,s=e.historyEntries&&e.historyEntries.member;return Array.isArray(s)&&s.length>0&&(t=s.map((function(e){return{actorId:e.user||{}||"",changeType:e.changetype,changes:e.changes&&e.changes.member?e.changes.member:[],entryDate:e.date,resourceId:e.objectId,resourceType:e.objectClass,userAction:e.action,rootResourceId:n}}))),t},_getGridViewData:function(e){e=e||{};var t=this._mapRDFDataToS3Format(e.rdfDataResponse)||[],n=[];Array.isArray(e.s3BucketResponse)&&e.s3BucketResponse.forEach((e=>{Array.isArray(e.historyEntries)&&n.push(...e.historyEntries)}));var s=[...t,...n];e.includeChildren||(s=s.filter((e=>e.resourceId===this.options.model.id||e.rootResourceId===this.options.model.id&&"Deleted"===e.userAction))),s.forEach((e=>{const t=e.userAction;(e.changes||[]).forEach((e=>{const{changedProperty:n,newValue:s}=e,i=t===A.ADDED||t===A.CREATED||t===A.RESTORED;g.OBJECT_CREATION_DELETION_FIELDS.includes(n)&&i&&s&&(this.valuePropertyMap[s]=n)}))}));var i={};return s.forEach((t=>{var n=t.entryDate,s=new Date(n),o=R.DATE_FORMAT_EN.format(s),a=i[o],r=this._formatHistoryChangeDetails(n,t.changeType,t.userAction,t.actorId,t.changes,t.resourceId,t.resourceType,e);a?a.push(...r):i[o]=r})),Object.keys(i).forEach((e=>{i[e].sort(((e,t)=>{if(e.date===t.date){return(e.details.changeObj.action.nonTranslated===A.CREATED?1:0)-(t.details.changeObj.action.nonTranslated===A.CREATED?1:0)}return new Date(e.date)-new Date(t.date)}))})),i},_fetchModelData:function(e,t,n,s,i,a){var l=!1;if(["<uuid:","uuid:","dscom:","dsplan:","dsxplan:","iam:","dskern:Person","dsxnpi:"].every((t=>!e||!e.startsWith(t)||(l=!0,!1))),!l||!a.fetchModelFromServer)return;let d;if(d=o.getObjectById(e),d){const e=d.get(t)||d.get("dskern:nlsLabel"),i=d.fetching||d.hasUsedMask(s)||d.getMask()===s,o=g.OBJECT_CREATION_DELETION_FIELDS.includes(n),a=d.get(A.UNIQUE_OBJECT_ID_ATTR);if(e||i){if(!o)return d;if(a||i)return d}}return i===r?this.createPromise(((t,n)=>{d=o.getObjectForAdding(i,e,{attrs:{"@type":"dscom:ComponentProxy"},mask:s,onComplete:()=>{this.updateColumnView(v.COLUMN_DATA_INDICES.auditDetails,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),t()},onFailure:()=>{n()}})})):this.createPromise(((t,n)=>{d=o.getObjectForAdding(i,e,{mask:s,onComplete:()=>{this.updateColumnView(v.COLUMN_DATA_INDICES.auditDetails,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),this.updateColumnView(v.COLUMN_DATA_INDICES.auditObjectName,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),t()},onFailure:()=>{n()}})})),d},_isCustomAttribute:function(t){var n=this.options.model&&e.is(this.options.model.get,"function")&&this.options.model.get("customAttributes");return!!n&&[...new Set(Object.keys(JSON.parse(n)).map((e=>e.split(":")?e.split(":")[0]:"")))].some((e=>t.includes(e)))},_getDateFixedOrUnfixedDescription:function(e,t){return("string"==typeof t?"true"===t.toLowerCase():"boolean"==typeof t?t:!!t)?I.replace(this.i18n("E6WCommonApps.History.DateFixed"),{FIELD:this.i18n(e)}):I.replace(this.i18n("E6WCommonApps.History.DateUnFixed"),{FIELD:this.i18n(e)})},_createTranslatedDescription:function(e){const t=e.changedProperty;let n,s=this.fieldNlsMap[t],i=e.description,o=e.newValue,a=e.oldValue;if([g.DESCRIPTION_TYPE_FIELD,g.HAS_THUMBNAIL_FIELD].includes(t)&&(o=o&&U(o),a=a&&U(a)),s){switch(e.action&&e.action.nonTranslated){case A.ADDED:n=!o||o.includes("DSToken")||j(o)?I.replace(this.i18n("E6WCommonApps.History.ObjectAddedDescriptionEmptyValue"),{FIELD:this.i18n(s)}):t===g.FIELDS.HAS_BACKLOG_TASK?I.replace(this.i18n("E6WCommonApps.History.BacklogAddedDescription"),{FIELD:this.i18n(s),VALUE:this.i18n(o,{isValue:!0})}):t===g.FIELDS.HAS_NOTIF_SUBSCRIBER?I.replace(this.i18n("E6WCommonApps.History.SubsriberEnabledDescription"),{VALUE:this.i18n(o,{isValue:!0})}):t===g.FIELDS.USER_DEFINED_START||t===g.FIELDS.USER_DEFINED_END||t===g.FIELDS.USER_DEFINED_DATES?this._getDateFixedOrUnfixedDescription(s,o):g.OBJECT_CREATION_DELETION_FIELDS.includes(t)?I.replace(this.i18n("E6WCommonApps.History.ObjectAddedDescription"),{FIELD:this.i18n(s),VALUE:this.i18n(o,{isValue:!0})}):I.replace(this.i18n("E6WCommonApps.History.SetDescription"),{FIELD:this.i18n(s),VALUE:this.i18n(o,{isValue:!0})});break;case A.RESTORED:n=!o||o.includes("DSToken")||j(o)?I.replace(this.i18n("E6WCommonApps.History.RestoredDescriptionEmptyValue"),{FIELD:this.i18n(s)}):I.replace(this.i18n("E6WCommonApps.History.RestoredDescription"),{FIELD:this.i18n(s),VALUE:this.i18n(o,{isValue:!0})});break;case A.CREATED:n=!o||o.includes("DSToken")||j(o)?I.replace(this.i18n("E6WCommonApps.History.CreatedDescriptionEmptyValue"),{FIELD:this.i18n(s)}):I.replace(this.i18n("E6WCommonApps.History.CreatedDescription"),{FIELD:this.i18n(s),VALUE:this.i18n(o,{isValue:!0})});break;case A.MODIFIED:if(g.FIELDS.SEQUENCE_ORDER===t){var r=this.options.model.get("dsxplan:jsType"),l=this.options.model.get("dsxplan:label"),d=this.options.model.get(A.UNIQUE_OBJECT_ID_ATTR);n=I.replace(this.i18n("E6WCommonApps.History.ReorderedDescription"),{ELEMENT_TYPE:this.i18n(this.fieldNlsMap[r]),VALUE:this.i18n(l,{isValue:!0}),ENTERPRISE_ID_NO:this.i18n(d,{isValue:!0})})}else n=t===g.FIELDS.USER_DEFINED_START||t===g.FIELDS.USER_DEFINED_END||t===g.FIELDS.USER_DEFINED_DATES?this._getDateFixedOrUnfixedDescription(s,o):o||a?I.replace(this.i18n("E6WCommonApps.History.ModifiedDescription"),{FIELD:this.i18n(s),OLD_VALUE:this.i18n(a,{isValue:!0}),NEW_VALUE:this.i18n(o,{isValue:!0})}):I.replace(this.i18n("E6WCommonApps.History.UpdatedDescription"),{FIELD:this.i18n(s)});break;case A.TRANSITIONED:n=I.replace(this.i18n("E6WCommonApps.History.TransitionedDescription"),{FIELD:this.i18n(s),OLD_VALUE:this.i18n(a,{isValue:!0}),NEW_VALUE:this.i18n(o,{isValue:!0})});break;case A.DELETED:n=!a||a.includes("DSToken")||j(a)?I.replace(this.i18n("E6WCommonApps.History.DeletedDescriptionEmptyValue"),{FIELD:this.i18n(s)}):I.replace(this.i18n("E6WCommonApps.History.DeletedDescription"),{FIELD:this.i18n(s),VALUE:this.i18n(a,{isValue:!0})});break;case A.REMOVED:n=!a||a.includes("DSToken")||j(a)?I.replace(this.i18n("E6WCommonApps.History.RemovedDescriptionEmptyValue"),{FIELD:this.i18n(s)}):t===g.FIELDS.HAS_NOTIF_SUBSCRIBER?I.replace(this.i18n("E6WCommonApps.History.SubsriberDisabledDescription"),{VALUE:this.i18n(a,{isValue:!0})}):I.replace(this.i18n("E6WCommonApps.History.RemovedDescription"),{FIELD:this.i18n(s),VALUE:this.i18n(a,{isValue:!0})});break;default:n=i}}else n=i;return n=n.replace(/[<>]/g,""),n},_generateHistoryDescription:function(t,n){var s=e.clone(t||{},!1);const i=s.changedProperty;let o=s.newValue,a=s.oldValue;if(g.OBJECT_TYPE_FIELDS.includes(i))this._fetchDetailedDescription(s,"title","dsplan:MVMask.ComponentProxy.Complex",r,n);else if(g.ASSIGNEE_TYPE_FIELDS.includes(i)||this._isCustomAttribute(i))this._fetchDetailedDescription(s,"name","dsplan:MVMask.Person.Complex",p,n);else if(g.USER_GROUP_FIELDS.includes(i))this._fetchDetailedDescription(s,"name","dsplan:MVMask.Person.Complex",l,n);else if(g.HAS_WORK_DECOMPOSITION_FIELD===i)this._fetchDetailedDescription(s,"name","dsplan:MVMask.WorkPackage.Property",y,n);else if([g.HAS_TASK_FIELD,g.HAS_SUB_TASK_FIELD,g.FIELDS.HAS_BACKLOG_TASK].includes(i))this._fetchDetailedDescription(s,"title","dsplan:MVMask.Task.CollaborativeTask.Basic",u,n);else if([g.HAS_MILESTONE_FIELD,g.HAS_GATE_FIELD].includes(i))this._fetchDetailedDescription(s,"title","dsplan:MVMask.Milestone.Property",m,n);else if(g.BASELINE_FIELD===i)this._fetchDetailedDescription(s,"dsxplan:label","dsplan:MVMask.Baseline.Basic",h,n);else if(g.FIELDS.HAS_EXPERIMENT===i)this._fetchDetailedDescription(s,"dsxplan:label","dsplan:MVMask.Experiment.Basic",T,n);else if(g.HAS_REFERENCE_PROJECT===i)this._fetchDetailedDescription(s,"name","dsplan:MVMask.WorkPackage.Complex",y,n);else if(g.USES_CALENDAR===i)this._fetchDetailedDescription(s,"dsplan:representativeCities","dsplan:MVMask.Calendar.Basic",c,n);else if(g.SCHEDULING_STRATEGY_FIELD===i)a&&(s.oldValue=w(a)),o&&(s.newValue=w(o));else if(g.DATE_FIELDS.includes(i))a&&(s.oldValue=x(a)),o&&(s.newValue=x(o));else if(g.DURATION_FIELDS.includes(i)){const t=e.is(this.options.model.getWorkDayLength,"function")?this.options.model.getWorkDayLength():E.WORKING_HOURS_IN_A_DAY;a&&(s.oldValue=V.call(this,a,t)),o&&(s.newValue=V.call(this,o,t))}else this._fetchDetailedDescription(s,"dsxplan:label","dsplan:MVMask.History.Basic",d,n);return this._createTranslatedDescription(s)},_formatHistoryChangeDetails:function(e,t,n,s,i,o,a,r){let l={};try{if("object"==typeof s&&null!==s)l.fullName=`${s.firstName||""} ${s.lastName||""}`.trim(),l.accountName=s.accountName||"";else{const e=this._fetchModelData(s,"name","","dsplan:MVMask.Person.Complex",p,r);e&&(l.fullName=e.getFullName()||s||"",l.accountName=e.get("accountName")||s||"")}return(i=i.filter((e=>{if(!e||"object"!=typeof e)return!1;const t=g.IGNORED_FIELDS.includes(e.changedProperty),s=e.newValue&&e.newValue.includes("DSToken")||e.oldValue&&e.oldValue.includes("DSToken"),i=g.OBJECT_CREATION_DELETION_FIELDS.includes(e.changedProperty),o=[A.REMOVED,A.DELETED].includes(n),r=i&&o&&e.oldValue&&this.valuePropertyMap[e.oldValue]!==e.changedProperty,l=g.FIELDS.SEQUENCE_ORDER===e.changedProperty&&n===A.ADDED,d=g.FIELDS.JS_TYPE===e.changedProperty&&n===A.ADDED,c=g.FIELDS.JS_TYPE===e.changedProperty&&"dsplan:Task"===a;return!(s||r||l||d||c||t)}))).map((s=>{try{if(s.action={translated:this.i18n(this.fieldNlsMap[n])||n,nonTranslated:n},s.changedProperty===g.FIELDS.HAS_NOTIF_UNSUBSCRIBER)s.changedProperty=g.FIELDS.HAS_NOTIF_SUBSCRIBER,s.action={translated:this.i18n(this.fieldNlsMap[g.SUBSCRIBER_ACTION_MAP[n]])||n,nonTranslated:g.SUBSCRIBER_ACTION_MAP[n]},s.action.nonTranslated===A.ADDED?s.newValue=s.newValue||s.oldValue:s.action.nonTranslated===A.REMOVED&&(s.oldValue=s.oldValue||s.newValue);else if(s.changedProperty===g.FIELDS.ENTERPRISE_ID_NO)s.action={translated:this.i18n(this.fieldNlsMap[A.CREATED])||A.CREATED,nonTranslated:A.CREATED},s.changedProperty=a,s.newValue=o;else if(s.changedProperty===g.FIELDS.JS_TYPE){if(s.action.nonTranslated===A.MODIFIED){const e=["dsplan:DeletedProject","dsplan:DeletedTask","dsplan:DeletedMilestone","dsplan:DeletedGate"],t=t=>e.includes(t);t(s.newValue)?(s.action={translated:this.i18n(this.fieldNlsMap[A.DELETED])||A.DELETED,nonTranslated:A.DELETED},s.oldValue=o):t(s.oldValue)&&(s.action={translated:this.i18n(this.fieldNlsMap[A.RESTORED])||A.RESTORED,nonTranslated:A.RESTORED},s.newValue=o);const n={"dsplan:DeletedProject":g.FIELDS.HAS_PROJECT,"dsplan:DeletedTask":g.FIELDS.HAS_TASK,"dsplan:DeletedMilestone":g.FIELDS.HAS_MILESTONE,"dsplan:DeletedGate":g.FIELDS.HAS_GATE};n[s.newValue]?s.changedProperty=n[s.newValue]:n[s.oldValue]&&(s.changedProperty=n[s.oldValue])}}else s.changedProperty===g.FIELDS.BACKLOG_QUERY&&(s.newValue&&(s.newValue=JSON.parse(s.newValue).selected_query),s.oldValue&&(s.oldValue=JSON.parse(s.oldValue).selected_query));return{date:e,modifiedBy:l,changetype:t,details:{changeObj:s,resourceId:o,options:r,historyView:this}}}catch(e){return console.error("Error processing individual change:",e,s),null}})).filter(Boolean)}catch(e){return console.error("Error formatting history change details:",e),[]}},_fetchDetailedDescription:function(e,t,n,s,i){let o,a=e.action&&e.action.nonTranslated;const r=e.changedProperty,l=a=>{const l=e[a];if(o=this._fetchModelData(l,t,r,n,s,i),o){let n=o.get(t)||o.get("dskern:nlsLabel");const s=g.OBJECT_CREATION_DELETION_FIELDS.includes(r)?o.get(A.UNIQUE_OBJECT_ID_ATTR):null;n&&(r===g.USES_CALENDAR&&(n=o.getDropdownDisplayValue()),e[a]=s?`${n} (${s})`:n)}};[A.ADDED,A.CREATED,A.RESTORED].includes(a)?l("newValue"):[A.REMOVED,A.DELETED].includes(a)?l("oldValue"):a===A.MODIFIED&&(l("oldValue"),l("newValue"))},_handleAddAuditHistory:function(){for(var e in(k=this.createTreeDocument()).prepareUpdate(),this._historyData)if(this._historyData.hasOwnProperty(e)){for(var t=this._historyData[e],n={date:e},s=new S({label:n.date,grid:n}),i=0;i<t.length;i++){let e=t[i];var o=this.createNodeData(e);s.addChild({label:o.date,grid:o,getAttributeValueForFiltering:function(e){return e===v.COLUMN_DATA_INDICES.auditDetails?L(this):this.getAttributeValue(e)}})}k.addChild(s)}k.expandAll(),k.pushUpdate()},_addFilterModel:function(){k&&k.setFilterModel({[v.COLUMN_DATA_INDICES.auditDetails]:{filterId:"string",filterOptions:{allowRegexp:!0}}})},exportToCsvHandler:function(){R.displayInfo(this.i18n("E6WCommonApps.Label.ExportStarted"));var e=this._getWholeHistoryDataAsCsv();Promise.allSettled(this.promises).then((()=>{e=this._getWholeHistoryDataAsCsv(),R.saveBlobToFile(e,this.options.model),R.displaySuccess(this.i18n("E6WCommonApps.Label.ExportDone"))})).catch((e=>{console.error("This will not be called as allSettled handles all rejections",e)}))},_getWholeHistoryDataAsCsv:function(){try{var e=`${this.i18n("E6WCommonApps.Label.AuditHistoryDate")},${this.i18n("E6WCommonApps.Label.AuditHistoryAction")},${this.i18n("E6WCommonApps.Label.AuditHistoryDetails")},${this.i18n("E6WCommonApps.Label.AuditHistoryModifiedBy")}\n`,t=[];for(var n in this._historyData)if(this._historyData.hasOwnProperty(n)){var s=this._historyData[n];Array.isArray(s)&&(t=t.concat(s))}return t.sort((function(e,t){return new Date(t.date)-new Date(e.date)})),e+t.map((e=>{try{var t="";e.details&&e.details.changeObj&&e.details.changeObj.action&&"string"==typeof e.details.changeObj.action.nonTranslated&&(t=this._generateHistoryDescription(e.details.changeObj,e.details.options||{}));var n=e.date||"",s=e.details&&e.details.changeObj&&e.details.changeObj.action&&e.details.changeObj.action.translated?e.details.changeObj.action.translated:"",i=e.modifiedBy&&e.modifiedBy.fullName?e.modifiedBy.fullName:"";return`${n},${s},${o=t,"string"==typeof o&&((o=o.replace(/"/g,'""')).includes(",")||o.includes('"')||o.includes("\n"))&&(o=`"${o}"`),o},${i}`}catch(t){return console.error("Error processing history entry:",t,e),"Error processing entry"}var o})).join("\n")}catch(e){return console.error("Error generating history CSV:",e),`${this.i18n("E6WCommonApps.Label.AuditHistoryDate")},${this.i18n("E6WCommonApps.Label.AuditHistoryAction")},${this.i18n("E6WCommonApps.Label.AuditHistoryDetails")},${this.i18n("E6WCommonApps.Label.AuditHistoryModifiedBy")}\nError generating history data`}},createPromise:function(e){this.promiseCount++;const t=new Promise(e);return t.finally((()=>{this.promiseCount--,this.promises.delete(t)})),this.promises.add(t),t},executingPromises:function(){return this.promiseCount>0},init:function(t){this.promiseCount=0,this.promises=new Set,this.options=t,this.valuePropertyMap={},this.fieldNlsMap=g.FIELD_NLS_MAP({objectType:this.options.model.get("dsxplan:jsType")}),this._historyData=this._getGridViewData(t),this._handleAddAuditHistory(),this._addFilterModel();var n=e.clone(M.columns||{},!1);this.options.includeChildren||(n=n.filter((function(e){return e.dataIndex!==v.COLUMN_DATA_INDICES.auditObjectName}))),this._parent({identifier:"HistoryGridView",treeDocument:k,placeholder:this.i18n("E6WCommonApps.History.NoHistoryFound"),columns:n,rowSelection:"none",cellSelection:"none",showRowIndexFlag:!1,showSelectionCheckBoxesFlag:!1,cellActivationFeedback:"none",paginationManager:new _({pageSize:30,nodeDepth:-1,currentPage:1}),layoutOptions:{useLastColumnWidthAutoFlag:!0,rowsHeader:!1}}),this.sortModel=[{dataIndex:"tree",sort:"desc"}],this.buildStatusBar([{type:f.STATUS.PAGINATION,position:"center"}]),this.setupResuableComponents(),this.onPostUpdateViewOnce((()=>{var e=this.elements.statusBar.elements.container;e.hasAttribute("touch-mode")&&e.removeAttribute("touch-mode"),e.getElements("[touch-mode]").forEach((e=>e.removeAttribute("touch-mode")))}))}});return B.implement(s),B.implement(n),B})),define("DS/E6WCommonApps/Models/RDFTaskCloneModel",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonApps/Models/ScheduleElementCloneModel","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/ReparentingUtils","DS/E6WCommonApps/Preferences","DS/RDFFoundation/MemberUtils","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/TaskValidator","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u){"use strict";var h=function(e){return u.get(e)},m=i.extend(p,{_uwaClassName:"RDFTaskCloneModel",getWorkDayLength:function(){return this.model.getWorkDayLength&&this.model.getWorkDayLength()},_updateRanges:function(e,n,s){var i=this.get(t.DURATION),o=this.get(t.DURATION_RANGE),a=s&&s.settingDuration,r=s&&s.settingRange;!a&&i!==e&&this.dispatchEvent("onChange:"+t.DURATION,[this,i]),!r&&o!==n&&this.dispatchEvent("onChange:"+t.DURATION_RANGE,[this,o]),this.validationError=this.validate(this.toJSON()),this.validationError?this.dispatchEvent("onValidationFailure"):this.dispatchEvent("onValidationSuccess")},init:function(){this._parent.apply(this,arguments);var e={};e["onChange:"+t.DURATION_MAX]=e["onChange:"+t.DURATION_MIN]=function(e,t,n){this._updateRanges(void 0,void 0,n)},this.listenTo(this,e)},toJSON:function(){var e=this._parent.apply(this,arguments);return e[t.DURATION]=this.get(t.DURATION),e[t.DURATION_RANGE]=this.get(t.DURATION_RANGE),e[t.DURATION_ESTIMATED]=this.get(t.DURATION_ESTIMATED),e[t.START_DATE_MAX_ATTR]=this.get(t.START_DATE_MAX_ATTR),e[t.START_DATE_MIN_ATTR]=this.get(t.START_DATE_MIN_ATTR),e[t.END_DATE_MAX_ATTR]=this.get(t.END_DATE_MAX_ATTR),e[t.END_DATE_MIN_ATTR]=this.get(t.END_DATE_MIN_ATTR),e},dataForRendering:function(e){var s=this._parent.apply(this,arguments);s[t.DURATION]=this.get(t.DURATION),s[t.DURATION_RANGE]=this.get(t.DURATION_RANGE),s[t.DURATION_ESTIMATED]=this.get(t.DURATION_ESTIMATED),s[t.DURATION_ESTIMATED_RANGE]=this.get(t.DURATION_ESTIMATED_RANGE),s[t.DURATION_ACTUAL]=this.get(t.DURATION_ACTUAL),s[t.ESTIMATED_DATE_ATTR]=this.get(t.ESTIMATED_DATE_ATTR),s[t.STARTDATE_ATTR]=this.get(t.STARTDATE_ATTR),s[t.ENDDATE_ATTR]=this.get(t.ENDDATE_ATTR),s[t.START_DATE_MIN_ATTR]=this.get(t.START_DATE_MIN_ATTR),s[t.START_DATE_MAX_ATTR]=this.get(t.START_DATE_MAX_ATTR),s[t.END_DATE_MIN_ATTR]=this.get(t.END_DATE_MIN_ATTR),s[t.END_DATE_MAX_ATTR]=this.get(t.END_DATE_MAX_ATTR),s[t.ACTUAL_START_DATE]=this.get(t.ACTUAL_START_DATE),s[t.ACTUAL_END_DATE]=this.get(t.ACTUAL_END_DATE),s[t.BASELINE_ESTIMATED_START_DATE]=this.get(t.BASELINE_ESTIMATED_START_DATE),s[t.BASELINE_ESTIMATED_END_DATE]=this.get(t.BASELINE_ESTIMATED_END_DATE),s[t.BASELINE_ACTUAL_START_DATE]=this.get(t.BASELINE_ACTUAL_START_DATE),s[t.BASELINE_ACTUAL_END_DATE]=this.get(t.BASELINE_ACTUAL_END_DATE),s[t.CREATION_DATE_ATTR]=this.get(t.CREATION_DATE_ATTR),s[t.LASTUPDATED_ATTR]=this.get(t.LASTUPDATED_ATTR);var i=s[t.COMMON_TASK_PARENT_ATTR];if(i&&"dsplan:DummyProject"===i.physicalId)s[t.COMMON_TASK_PARENT_ATTR]=[];else if(e.attributes.includes(t.COMMON_TASK_PARENT_ATTR)){var o=this.get(t.COMMON_TASK_PARENT_ATTR);o&&"dsplan:DummyProject"!==o.id&&(s[t.COMMON_TASK_PARENT_ATTR]=[o.toJSON(e)]),n.removeFromArray(e.attributes,t.COMMON_TASK_PARENT_ATTR)}return e.attributes&&e.attributes.forEach((e=>{s[e]||(s[e]=this.get(e),"object"==typeof s[e]&&(s[e]=this.get(e),this.get(e)&&this.get(e).dataForRendering&&(s[e]=this.get(e).dataForRendering())))})),s},get:function(s){switch(s){case t.DURATION:return this.getDuration();case t.DURATION_ACTUAL:return this.getFormattedActualDuration();case t.DURATION_ESTIMATED:if(this.model.getDefinedDuration)return this.model.getDefinedDuration();case t.DURATION_RANGE:return this.getDurationOffset();case t.DURATION_ESTIMATED_RANGE:return this.getDurationRangeFormat(this.getDuration(),this.getDurationOffset());case t.BASELINE_ESTIMATED_START_DATE:return r.getBaselineFormattedDate("start",this.model);case t.BASELINE_ESTIMATED_END_DATE:return r.getBaselineFormattedDate("end",this.model);case t.BASELINE_ACTUAL_START_DATE:return r.getBaselineFormattedDate("actualStart",this.model);case t.BASELINE_ACTUAL_END_DATE:return r.getBaselineFormattedDate("actualEnd",this.model);case t.BASELINE_ESTIMATED_DURATION:return this.getFormattedBaselineDuration("estimated");case t.BASELINE_ACTUAL_DURATION:return this.getFormattedBaselineDuration("actual")}var i=this._parent.apply(this,arguments);if(i)switch(s){case t.ESTIMATED_DATE_ATTR:case t.ENDDATE_ATTR:case t.STARTDATE_ATTR:case t.ACTUAL_START_DATE:case t.ACTUAL_END_DATE:case t.START_DATE_MIN_ATTR:case t.START_DATE_MAX_ATTR:case t.END_DATE_MIN_ATTR:case t.END_DATE_MAX_ATTR:i=n.getIntlDateFormat(i);break;case t.CREATION_DATE_ATTR:case t.LASTUPDATED_ATTR:i=n.getIntlDateTimeFormat(i);break;case t.DURATION_ESTIMATED:case t.DURATION_MIN:case t.DURATION_MAX:i=c.xsdDayTimeDurationToMilliseconds(i)/(60*this.getWorkDayLength()*60*1e3);break;case t.STATE_ATTR:return e.is(i,"object")&&!enoviaServer.useFD01CodeFor3DPlan?i.id:i}return i},getFormattedActualDuration:function(){var e=this.get(t.ACTUAL_START_DATE),n=this.get(t.ACTUAL_END_DATE);return this.formatDuration(e,n)},formatDuration:function(e,t){if(e&&t){var n=t.actualValue.getTime()-e.actualValue.getTime(),s=(this.model.nonWorkingDayIterator&&this.model.nonWorkingDayIterator.countWorkingDays(e.actualValue,t.actualValue)||Math.round(n/c.MS_DAY))+" "+h("E6WCommonApps.Label.Days");return{actualValue:s,displayValue:s}}},getDurationRangeFormat:function(e,t){let n;if(e<1){const s=this.model.getWorkDayLength();n=`${e*s} ${h("E6WCommonApps.Label.Hours")} ${h("E6WCommonApps.Label.PlusMinusOffset")} ${t*s}`}else n=`${e} ${h("E6WCommonApps.Label.Days")} ${h("E6WCommonApps.Label.PlusMinusOffset")} ${t}`;return{actualValue:n,displayValue:n}},getFormattedBaselineDuration:function(e){var t=r.getBaselineFormattedDate("actualStart",this.model),n=r.getBaselineFormattedDate("actualEnd",this.model);return"estimated"===e&&(t=r.getBaselineFormattedDate("start",this.model),n=r.getBaselineFormattedDate("end",this.model)),this.formatDuration(t,n)},getDurationOffset:function(){if(this.model.get("dsxplan:hasSubtask")&&this.model.get("dsxplan:hasSubtask").length>0){let e=this.model.getSubtasks(),t=0;return e._models.forEach((e=>{t=e.getSuggestedOffset&&e.getSuggestedOffset()>t?e.getSuggestedOffset():t})),t}var e=i.prototype.get.call(this,t.DURATION_RANGE);if(void 0===e||isNaN(e)){var n=this.get(t.DURATION_MIN),s=this.get(t.DURATION_MAX);void 0!==n&&void 0!==s||(e=0),e=(s-n)/2}return isNaN(e)?0:e},getDuration:function(){if(this.model.get("dsxplan:hasSubtask")&&this.model.get("dsxplan:hasSubtask").length>0&&this.getEndDate()&&this.getStartDate()){return this.model.nonWorkingDayIterator&&this.model.nonWorkingDayIterator.countWorkingDays(this.getStartDate().actualValue,this.getEndDate().actualValue)}var e=i.prototype.get.call(this,t.DURATION);if(void 0===e){var n=this.get(t.DURATION_MIN),s=this.get(t.DURATION_MAX);e=void 0===n?s:void 0===s?n:(n+s)/2}if(e<1e6)return e;if(void 0===e&&this.model&&this.model.getDaysAsUnit&&this.model.getDurationString){let e=this.model.getDaysAsUnit(this.model.getDurationString(1));var o=this.getStartDate&&this.getStartDate(),a=this.getEndDate&&this.getEndDate();return o&&o.actualValue&&a&&a.actualValue&&(e=this.model.nonWorkingDayIterator&&this.model.nonWorkingDayIterator.countWorkingDays(o.actualValue,a.actualValue)),e}},_setDuration:function(n,s,i){var o,a,r;o=!1;var l=s,d=e.clone(i||{},!1),c=d&&d.whisper;c&&delete d.silent;var p,u=d&&d.silent;if(n===t.DURATION_MIN||n===t.DURATION_MAX){var h=this.get(t.DURATION),m=this.get(t.DURATION_RANGE);l=this.model.nonWorkingDayIterator&&this.model.nonWorkingDayIterator.getDaysAsString(s),this.cleanupLocalAttributes(),o=d.parent.call(this,n,l,d);var T=d.settingDuration;!d.settingRange&&!T&&this._updateRanges(h,m,d),o={handled:!0,returnValue:o}}else n===t.DURATION?(e.is(s,"string")&&(l=parseFloat(s,10)),r=this.get(t.DURATION_RANGE),a=l,d.settingDuration=!0,p=d.validate,d.validate=!1,o=this._setComputedMinAndMaxVal(a,r,d),d.validate=p,d.parent&&d.parent.call(this,n,l,d),u||c||this.dispatchEvent("onChange:"+t.DURATION,[this,l,d]),o={handled:!0,returnValue:o}):n===t.DURATION_RANGE&&(e.is(s,"string")&&(l=parseFloat(s,10)),a=this.get(t.DURATION),r=l,d.settingRange=!0,p=d.validate,d.validate=!1,o=this._setComputedMinAndMaxVal(a,r,d),d.validate=p,d.parent&&d.parent.call(this,n,l,d),u||c||this.dispatchEvent("onChange:"+t.DURATION_RANGE,[this,l,d]),o={handled:!0,returnValue:o});return o},setActualStartDate:function(e){if(this.isPlannedDateStrategy()){var n=this.get(t.STARTDATE_ATTR);if(n){var s=new Date(n.actualValue),i=new Date,o=s<i?n:i;return void this.set(t.ACTUAL_START_DATE,o,e)}}this.set(t.ACTUAL_START_DATE,new Date,e)},setActualEndDate:function(e){if(this.isPlannedDateStrategy()){var s=this.get(t.ENDDATE_ATTR);if(s){const i=new Date,o=s.actualValue?s.actualValue:s,a=new Date(Math.min(o.getTime(),i.getTime())),r=n.getIntlDateFormat(a);return void this.set(t.ACTUAL_END_DATE,r,e)}}this.set(t.ACTUAL_END_DATE,new Date,e)},isPlannedDateStrategy:function(){const e=this.model.getProjectActualDatesStrategy();return Boolean(e&&e.toString()===t.PLANNED_DATES_STRATEGY)},add:function(s,i,r){var l,d;if(s===t.COMMON_TASK_PARENT_ATTR&&(r&&(r.isObject=!(i instanceof e.Class.Model||i instanceof FileList||i instanceof File)),(l=this.getDetailedObjectToBeAdded(s,i,r))&&(d=l.getObjectType()),d&&d===t.TASK)){if(c.removeBracketLongURI(i)===c.removeBracketLongURI(this.model.id))return void n.displayError(n.i18n("E6WCommonUI.Alert.PlanOwnChild"));if(l.isStandaloneTask&&l.isStandaloneTask())return void n.displayError(n.i18n("E6WCommonUI.Alert.StandAloneTasksAsParents"))}var p=this._parent.apply(this,arguments),h=Array.prototype.slice.call(arguments,0);if(s===t.COMMON_TASK_PARENT_ATTR&&d&&d!==t.OBJECT){if(d===t.TASK){var m=this,T={};T.parentId=i,T.childId=this.model.id,T.type=o,T.onComplete=function(e){if(e["@value"]||e.value){var i=h[2].dropObj,o=r.detailedObjects,a=o?o[0].label:i.displayName,l=u.replace(n.i18n("E6WCommonUI.Alert.ChildIsAlreadyInParentStructure"),{PARENT_NAME:a,CHILD_NAME:m.model.get("title")});n.displayError(l),m.set(s)}else m.remove(t.PARENT_ATTR,void 0,r),m.add(t.TASK_PARENT_ATTR,m.id,r)},a.checkParentHierarchyForId(T)}d!==t.PROJECT&&d!==t.XPROJECT||(this.remove(t.TASK_PARENT_ATTR,void 0,r),this.add(t.PARENT_ATTR,l.id,r))}return p},remove:function(e,n,s){if(e===t.COMMON_TASK_PARENT_ATTR){var i=this.get(e);if(i){var o=i.getObjectType()===t.TASK?t.TASK_PARENT_ATTR:t.PARENT_ATTR;this.remove(o,i.id,s)}}this._parent(e,n,s)},isProjectTask:function(){return this.model.isProjectTask()},isStandaloneTask:function(){return Boolean(!this.get(t.HAS_PARENT_ATTR))},set:function(n,s,i){var o=s,a=e.clone(i||{},!1);a.parent=this._parent;var r,l=this._setDuration(n,s,a);if(delete a.parent,l.handled)return l.returnValue;if(((r=n)===t.ENDDATE_ATTR||r===t.STARTDATE_ATTR||r===t.ACTUAL_START_DATE||r===t.ACTUAL_END_DATE||r===t.START_DATE_MIN_ATTR||r===t.START_DATE_MAX_ATTR||r===t.END_DATE_MIN_ATTR||r===t.END_DATE_MAX_ATTR)&&o&&o.actualValue&&(o=new Date(o.actualValue),n===t.ENDDATE_ATTR)){let e=o.getDay();o.setHours(0,0,0,0);let n=this.model.nonWorkingDayIterator._workingHours,s=n[e]&&n[e].end.totalMinutes||60*t.DEFAULT_END_HOUR;o=new Date(o.getTime()+6e4*s)}(n===t.STATE_ATTR&&!enoviaServer.useFD01CodeFor3DPlan||n===t.PRIORITY_ATTR)&&(o=o&&o.actualValue?o.actualValue:o)&&(o=c.getObjectForAdding(d,o));const p=(e,t)=>e===t||e&&e.actualValue===t||e&&e.id===t;if(n===t.STATE_ATTR)if(p(s,t.STATE_IN_PROGRESS)){const e=this.get(t.COMPLETE_PERCENT_ATTR);(e<10||100===e)&&!a.doNotSetPercentComplete&&this.set(t.COMPLETE_PERCENT_ATTR,i&&i.completePercent||(100===e?90:10),{doNotSetState:!0}),this.localAttributes[t.ACTUAL_END_DATE]&&delete this.localAttributes[t.ACTUAL_END_DATE],void 0===this.get(t.ACTUAL_START_DATE)&&this.setActualStartDate(a)}else p(s,t.STATE_OPEN)?(a.doNotSetPercentComplete||this.set(t.COMPLETE_PERCENT_ATTR,0,{doNotSetState:!0}),[t.ACTUAL_START_DATE,t.ACTUAL_END_DATE].forEach((e=>{this.localAttributes[e]&&delete this.localAttributes[e]}))):p(s,t.STATE_DONE)&&(a.doNotSetPercentComplete||100===this.get(t.COMPLETE_PERCENT_ATTR)||this.set(t.COMPLETE_PERCENT_ATTR,100,{doNotSetState:!0}),this.get(t.ACTUAL_START_DATE)||this.setActualStartDate(a),this.get(t.ACTUAL_END_DATE)||this.setActualEndDate(a));n===t.STATE_ATTR&&this.get(t.RESTRICT_ASSIGNEE_ATTR)&&(this.localAttributes[t.ACTUAL_START_DATE]&&delete this.localAttributes[t.ACTUAL_START_DATE],this.localAttributes[t.ACTUAL_END_DATE]&&delete this.localAttributes[t.ACTUAL_END_DATE]);var u=this._parent(n,o,a);if(n===t.COMPLETE_PERCENT_ATTR&&!a.doNotSetState){const e=s;let n;n=0===e?t.STATE_OPEN:100===e?t.STATE_DONE:t.STATE_IN_PROGRESS;this.get(t.STATE_ATTR)!==n&&(this.set(t.STATE_ATTR,{actualValue:n},{validate:!0,doNotSetPercentComplete:!0}),this.get(t.RESTRICT_ASSIGNEE_ATTR)&&(this.localAttributes[t.ACTUAL_START_DATE]&&delete this.localAttributes[t.ACTUAL_START_DATE],this.localAttributes[t.ACTUAL_END_DATE]&&delete this.localAttributes[t.ACTUAL_END_DATE]))}return n!==t.USER_DEFINED_START_DATE_ATTR&&n!==t.USER_DEFINED_END_DATE_ATTR||(n===t.USER_DEFINED_START_DATE_ATTR&&o?(this.get(t.START_DATE_MAX_ATTR)&&this.set(t.START_DATE_MAX_ATTR,null),this.get(t.START_DATE_MIN_ATTR)&&this.set(t.START_DATE_MIN_ATTR,null)):n===t.USER_DEFINED_END_DATE_ATTR&&o&&(this.get(t.END_DATE_MAX_ATTR)&&this.set(t.END_DATE_MAX_ATTR,null),this.get(t.END_DATE_MIN_ATTR)&&this.set(t.END_DATE_MIN_ATTR,null)),o!==this.get(n)&&this.dispatchEvent("onChange:"+n,[this,o,a])),u},_setComputedMinAndMaxVal:function(n,s,i){var o=i&&i.silent;s=!isNaN(s)&&parseFloat(s)||0,n=!isNaN(n)&&parseFloat(n)||0;var a=e.clone(i||{},!1),r=n-s,l=n+s,d=this.modificationsPending;this.modificationsPending=!0,o||d===this.modificationsPending||this.dispatchEvent("onChange:modificationsPending",[this]);var c=a.validate;a.validate=!1;var p=!isNaN(r)&&this.set(t.DURATION_MIN,r,a),u=!isNaN(l)&&this.set(t.DURATION_MAX,l,a);a.validate=c;var h,m,T=new Date(this.getStartDate()&&(this.getStartDate().actualValue||this.getStartDate()));if(this.isEndDateFixed()){if(!this.isStarted()&&!this.isStartDateFixed()){var E=this.get(t.ENDDATE_ATTR);E=E&&(E.actualValue||E),(T=new Date(E)).setDate(T.getDate()-(l+r)/2),h=T,m=t.STARTDATE_ATTR}}else{let e=(l+r)/2;m=t.ENDDATE_ATTR,h=this.calculateEndDate(T,e,i)}return this.set(m,h,a),a.whisper&&(delete a.detailsDisplayViewDebounce,this.dispatchEvent("onChange:"+m,[this,h,a])),this.set(t.DURATION_ESTIMATED,this.nonWorkingDayIterator&&this.nonWorkingDayIterator.getDaysAsString(n),a),p&&u},calculateEndDate:function(e,t){let n=new Date(e);if(this.model.nonWorkingDayIterator&&(this.model.nonWorkingDayIterator._isHoliday(n)||this.model.nonWorkingDayIterator.isNWD(n)))for(;this.model.nonWorkingDayIterator._isHoliday(n)||this.model.nonWorkingDayIterator.isNWD(n);)n.setDate(n.getDate()+1);let s=0;if(!isNaN(t))if(this.model.nonWorkingDayIterator&&t<=30)for(;s<t-1;)n.setDate(n.getDate()+1),this.model.nonWorkingDayIterator._recurringNonWorkingDays.includes(n.getDay())||this.model.nonWorkingDayIterator._isHoliday(n)||this.model.nonWorkingDayIterator.isNWD(n)||s++;else{let e=this.model.nonWorkingDayIterator?this.model.nonWorkingDayIterator._recurringNonWorkingDays.length:2,s=Math.floor(t/(7-e))*e;n.setDate(n.getDate()+(t+s-1)),0===n.getDay()&&n.setDate(n.getDate()-2)}return n},cleanupLocalAttributes:function(){delete this.localAttributes[t.DURATION],delete this.localAttributes[t.DURATION_RANGE],delete this.localAttributes[t.COMMON_TASK_PARENT_ATTR],delete this.localRelatedData[t.COMMON_TASK_PARENT_ATTR]},save:function(t){this.cleanupLocalAttributes();var n=Array.prototype.slice.call(arguments,0),s=e.clone(t||{},!1);return n[0]=s,s.animate=!0,this._parent.apply(this,n)},isWedo:function(){return Boolean(this.get(t.PARENT_HAS_SWYM_COMMUNITY))},isLeanTask:function(){return Boolean(this.get(t.PARENT_HAS_LEAN_BOARD))},getParent:function(){return this.model.getParent()}});return m})),define("DS/E6WCommonApps/Models/ScheduleElementPopupModel",["UWA/Core","UWA/Class/Events","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/ScheduleConstants","DS/E6WCommonApps/Models/MilestoneModel","DS/E6WCommonApps/Models/GateModel","DS/E6WCommonApps/Models/RDFTaskCloneModel","DS/E6WCommonApps/Models/RDFTaskModel","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonApps/Models/TaskValidator","DS/E6WCommonApps/Models/ConstraintModel","DS/E6WCommonApps/Models/WorkscopeModel","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h){"use strict";var m=h.get.bind(h),T=t.extend(c,a,{_uwaClassName:"ScheduleElementPopupModel",init:function(t){this._parent.apply(this,arguments);var n=e.clone(t||{},!1);if(this.model=n.model,this.assigneeModel=n.assigneeModel,this.type=n.elementType,this._detailsView=n._detailsView,this[s.TITLE_ATTR]="",this[s.DESCRIPTION_ATTR]="",this.parent=n.model&&e.is(n.model.get,"function")&&n.model.get(s.TITLE_ATTR),this.canEdit=!0,this.listenTo(this,"onChange:"+s.ASSIGNEE_ATTR,this.handleAssigneeField),this.listenTo(this,"onChange:"+p.TYPE_ATTR,this.handleAssigneeField),n.elementType===s.MILESTONE||n.elementType===s.GATE){var i=Date.now(),o=new Date(i);o.setHours(0,0,0,0);var a=o.getTime()+s.EOD_TIMEOFFSET,r=new Date(a);this[s.SUGGESTED_DATE_ATTR]={actualValue:r},this[s.USER_DEFINED_DATES_ATTR]=!0,n.elementType===s.MILESTONE?this[s.ACTUAL_TYPE_ATTR]=s.MILESTONE_RDF_TYPE:n.elementType===s.GATE&&(this[s.ACTUAL_TYPE_ATTR]=s.GATE_RDF_TYPE)}else n.elementType===s.TASK?(this[s.ACTUAL_TYPE_ATTR]=s.TASK_RDF_TYPE,this[s.DURATION_MIN]=1,this[s.DURATION_MAX]=1,this[s.DURATION]="1",this[s.DURATION_RANGE]="0",this[s.ASSIGNEE_ATTR]=this.assigneeModel,n.taskTab&&(2===n.noOfClicks?this[s.REPEAT_CREATE_TASK]=!0:this[s.REPEAT_CREATE_TASK]=!1),l.serverHasDSLC()&&(this[s.ACTUAL_TYPE_ATTR]="dsplan:Task")):n.elementType===s.CONSTRAINT&&(this[p.LAG_ATTR]="0",this[p.TYPE_ATTR]={actualValue:p.TYPE_FINISH_TO_START,displayValue:m("E6WCommonApps.Label.FinishToStart")},this[p.ENFORCE_ATTR]=!0)},_clearTaskFields:function(){this[s.TITLE_ATTR]="",this[s.DESCRIPTION_ATTR]="",this[s.DURATION_MIN]=1,this[s.DURATION_MAX]=1,this[s.DURATION]="1",this[s.DURATION_RANGE]="0",delete this[s.ASSIGNEE_ATTR],delete this[s.STARTDATE_ATTR],delete this[s.USER_DEFINED_START_DATE_ATTR],delete this[s.ENDDATE_ATTR],delete this[s.USER_DEFINED_END_DATE_ATTR],delete this[p.SUCCESSOR_ATTR],delete this[p.PREDECESSOR_ATTR],delete this[p.CONSTRAINT_TYPE_ATTR],this.localRelatedData={}},_getTaskIconURL:function(){return require.toUrl("DS/E6WCommonApps/assets/img/iconSmallTask.png")},_getMilestoneIconURL:function(){return require.toUrl("DS/E6WCommonApps/assets/img/iconSmallMilestone.png")},add:function(e,t,s){if(e!==p.PREDECESSOR_ATTR&&e!==p.SUCCESSOR_ATTR||!s)return this._parent.apply(this,arguments);var o,a=s.detailedObjects,d=s.dropObj,c=d?d.objectId:a[0].id;o=d?d.objectType:a[0].model?a[0].model.getObjectType():a[0]["ds6w:type"];var u=n.isTaskAnyType(o)?r:i,h=l.getObjectForAdding(u,c,{mask:"dsplan:MVMask.WorkPackage.Basic"});d?(d.image?h.image=d.image:n.isTaskAnyType(d.objectType)?h.image=this._getTaskIconURL():h.image=this._getMilestoneIconURL(),h.label=d.displayName):a[0]["ds6w:created"]?(h.image=a[0].preview_url,h.label=a[0]["ds6w:label"]):(h.image=a[0].image,h.label=a[0].label),this[e]=h,this.dispatchEvent("onChange:"+e),this._setDisabledClassOnCreateButton()},remove:function(e,t,n){this[e].at?this[e].remove(this[e].at(t)):delete this[e],this.dispatchEvent("onChange:"+e,[this,n]),t>-1&&this.localRelatedData[e]&&this.localRelatedData[e].splice(t,1),this._setDisabledClassOnCreateButton()},set:function(t,n,i){var o=n,a=e.clone(i||{},!1);if(a&&a.whisper&&delete a.silent,"dsplan:suggestedDate"===t)o&&o.actualValue&&(o.actualValue+=s.EOD_TIMEOFFSET);else if(t===p.ENFORCE_ATTR)n&&(this["dsxplan:lag"]=Math.abs(this["dsxplan:lag"])),o=!n;else if(t===s.TASK_TYPE)o=n.actualValue?n.actualValue:"";else if(t===s.COLLAB_SPACE)this[s.TASK_COLLAB_SPACE]&&(o=n.actualValue[0].value,this[s.COLLAB_SPACE_NAME]=n.displayValue,this._updateOrganizationDropdownOptions(n.actualValue),window.enoviaServer&&(window.enoviaServer.space=this._getAssignedCollabSpaceOrganization(n.actualValue[0].value)));else if(t===s.TASK_COLLAB_SPACE){if(this[s.TASK_COLLAB_SPACE]){var r=this[s.TASK_COLLAB_SPACE].filter((e=>e.displayValue!==n.displayValue));r.unshift(n),o=r,this[s.COLLAB_SPACE]=this._getAssignedCollabSpaceOrganization(n.actualValue[0].value),this._updateOrganizationDropdownOptions(n.actualValue),window.enoviaServer&&(window.enoviaServer.space=this._getAssignedCollabSpaceOrganization(n.actualValue[0].value))}}else if(t===s.TASK_ORGANIZATION&&this[s.TASK_ORGANIZATION]){var l=this[s.TASK_ORGANIZATION].filter((e=>e.displayValue!==n.displayValue));l.unshift(n),o=l,window.enoviaServer&&(window.enoviaServer.space=this._getAssignedCollabSpaceOrganization(n.actualValue))}this[t]=o,this.setTaskAttr(t,n,a),t!==p.ENFORCE_ATTR&&t!==s.TASK_TYPE&&t!==s.TASK_COLLAB_SPACE&&t!==s.CUSTOMER_EXTENSION&&t!==s.COLLAB_SPACE||this.dispatchEvent("onChange:"+t),a.validate&&this.validate&&(this.validationError=this.validate(this,a),!a.silent&&this.validationError?this.dispatchEvent("onValidationFailure"):this.dispatchEvent("onValidationSuccess")),this._setDisabledClassOnCreateButton()},_getAssignedCollabSpaceOrganization:function(e){var t=e.find((e=>e.includes("Leader"))),n=e.find((e=>e.includes("Admin"))),s=e.find((e=>e.includes("Reader")))||e.find((e=>e.includes("Viewer")));return t||n||s||e[0]},_updateOrganizationDropdownOptions:function(e){var t=e.map((e=>({actualValue:e.value,displayValue:e.name})));this[s.TASK_ORGANIZATION]=t},_setDisabledClassOnCreateButton:function(){var e=this[s.TITLE_ATTR],t=this[p.PREDECESSOR_ATTR],n=this[p.SUCCESSOR_ATTR];if(this.type===s.CONSTRAINT)this.createButton.toggleClassName("disabled",Boolean(!(t&&n&&t.id!==n.id)));else{this.createAndOpenButton&&this.createAndOpenButton.toggleClassName("disabled",Boolean(!e||!e.trim().length||this.validationError));let t=Boolean(!e||!e.trim().length||this.validationError);this.createButton&&this.createButton.toggleClassName("disabled",t),this.createButton&&!t&&!t&&this.createButton.removeAttribute("disabled")}},setTaskAttr:function(e,t,i){if(e===s.DURATION||e===s.DURATION_RANGE){var o=parseFloat(this.get(s.DURATION)),a=parseFloat(this.get(s.DURATION_RANGE));this[s.DURATION_MIN]=o-a,this[s.DURATION_MAX]=o+a;this._setDuration(e,t,i)}var r;"startStop"===i.type&&(t=t&&new Date(t.actualValue)||"",this[e]={actualValue:t},e===s.STARTDATE_ATTR?(r=s.USER_DEFINED_START_DATE_ATTR,n.isIpad()||n.isAndroid()||this.dispatchEvent("onChange:"+s.STARTDATE_ATTR)):e===s.ENDDATE_ATTR&&(r=s.USER_DEFINED_END_DATE_ATTR,n.isIpad()||n.isAndroid()||this.dispatchEvent("onChange:"+s.ENDDATE_ATTR)),this[r]=n.isValidDate(t))},get:function(e){return this[e]},getModelForAssigneeTypeahead:function(){return this},validate:function(){var e;switch(this.type){case s.TASK:e=c.prototype.validate.apply(this,arguments);break;case s.MILESTONE:e=i.prototype.validate_.apply(this,arguments)}return e},dataForRendering:function(){var e=this._parent.apply(this,arguments);return n.setHelper.apply(this,arguments).attrs.attributes.forEach(function(t){if(t!==s.ASSIGNEE_ATTR)t===p.ENFORCE_ATTR?(void 0===this[t]&&(this[t]=!0),e[t]=!this[t]):e[t]=this[t];else{var n=[],i=this[t];if(i)for(var o=i.length,a=0;a<o;a++)n.push(i.at(a).dataForRendering());e[t]=n}}.bind(this)),e},handleAssigneeField:function(e,t){var n=e[s.ASSIGNEE_ATTR];if(n||(n=new d),"add"===t.operation){var i=t.added;n.add(i,{at:0})}if("remove"===t.operation){var o=t.removed;n.remove(o)}e[s.ASSIGNEE_ATTR]=n}});return T})),define("DS/E6WCommonApps/Views/PropertyPanel",["UWA/Core","UWA/Class/Model","DS/UIKIT/Scroller","DS/Controls/TooltipModel","DS/Controls/Toggle","DS/Utilities/TouchUtils","DS/WAFData/WAFData","DS/E6WCommonApps/Views/CommentsView","DS/Handlebars/Handlebars4","DS/UIKIT/SuperModal","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/SecurityContextUtils","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DetailsDisplayView","DS/E6WCommonUI/Views/E6WHandlebarsHelpers","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/TagUtils","DS/E6WCommonApps/SubscriptionUtils","DS/E6WCommonApps/Views/HistoryGridView","DS/E6WCommonApps/ScheduleConstants","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Utils/ScenariosUtils","text!DS/E6WCommonApps/assets/templates/propertypanel.html.handlebars","text!DS/E6WCommonApps/assets/templates/viewCustomAttributes.html.handlebars","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","DS/E6WCommonApps/Views/ConfirmDialog"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,E,g,A,C,_,f,D,S,R,y,v,M){"use strict";var I="commentsTab",b="detailsTab",O="membersTab",N="classificationTab",P="characteristicsEditorViewTab",W="historyTab",F="scenariosTab",k="checklistTab",L=l.compile(S),U=l.compile(R);function w({tabId:e,shouldShow:t,isSelected:n,onFallback:s}){const i=e.startsWith("#")?e:`#${e}`,o=this.container.getElement(i);o&&(o.style.display=t?"inline-block":"none",!t&&n&&("function"==typeof s?s():"string"==typeof s&&"function"==typeof this._setSelectedTab&&this._setSelectedTab(s)))}function x(e,t,n={}){this._selectedTab!==e&&("function"==typeof n.beforeSetTab&&n.beforeSetTab.call(this),this.destroyToolbarElementAndRemoveExtraClassInBody(),this._setSelectedTab(e),this.refreshDropDownMenu(),"function"==typeof n.afterSetTab&&n.afterSetTab.call(this),"function"==typeof t&&t.call(this))}var V=u.extend({i18n:function(e){var t=v.get(e);return t===e&&(t=y.get(e)),t},propertyComponentFields:{},_uwaClassName:"E6WCommonUIPropertyPanel",tagName:"div",className:"property-panel",name:"E6WCommonUI.PropertyPanel",domEvents:{"click #cancelButton":"cancel","click #commentsTab":"onCommentsTabClicked","click #detailsTab":"onDetailsTabClicked","click #membersTab":"onMembersTabClicked","click #classificationTab":"onClassificationTabClicked","click #characteristicsEditorViewTab":"onCharacteristicsEditorViewTabClicked","click #historyTab":"onHistoryTabClicked","click #checklistTab":"onChecklistTabClicked","click #scenariosTab":"onScenariosTabClicked","click #closeButton":"close","click #saveButton":"save","dragover  .panel-tab":"handleDragOver","dragleave  .panel-tab":"handleDragLeave","click #openMenuButton":"openMenu","click #openSubButtonPropertPanel":"openSubButtonPropertPanel"},id:function(){return"e6WCommonUIPropertyPanel"+this.cid},handleDragLeave:function(){this._dragOverTimeout&&clearTimeout(this._dragOverTimeout),delete this._dragOverTimeout},openMenu:function(){this._dropDownMenu&&0==this._dropDownMenu.isVisible&&this._dropDownMenu.show()},openSubButtonPropertPanel:function(){A.toggleUserSubscription(this.model)},handleDragOver:function(t){var n=this;return this._dragOverTimeout||(this._dragOverTimeout=setTimeout((function(){t.preventDefault&&t.preventDefault(),t.dataTransfer&&(t.dataTransfer.dropEffect="copy");var s=e.Event.getElement(t);s.getElement(".panel-tab")||(s=s.getClosest(".panel-tab")),"detailsTab"===s.id?n.onDetailsTabClicked():"membersTab"===s.id?n.onMembersTabClicked():"commentsTab"===s.id?n.onCommentsTabClicked():"historyTab"===s.id?n.onHistoryTabClicked():"checklistTab"===s.id&&n.onChecklistTabClicked()}),1e3)),!1},createDetailsDisplayView:function(e){this._detailsView=new h(e)},setup:function(t){var n=e.clone(t||{},!1),s=n.alertMessageContainer||this.container;this._parent.apply(this,arguments),this.modal=new d({className:"eno-common-apps-modal",renderTo:s,okButtonText:this.i18n("E6WCommonApps.Command.Yes"),koButtonText:this.i18n("E6WCommonApps.Command.No")});var i=this.cloneModelForDetailDisplayView();i&&(i.validationError=e.is(i.validate,"function")&&i.validate(i.toJSON()));var a=e.clone(t.detailsViewParameters||{},!1);a.model=i,a.context=t.context,a.i18n=this.i18n,a.tenant=window.enoviaServer&&window.enoviaServer.tenant,a.isPropertyPanel=!0,a.isShadowMilestoneGate=n.isShadowMilestoneGate,a.postChildViewRender=function(){o.getTouchMode()&&this.container.toggleAttribute("touch-mode",!0)},this.createDetailsDisplayView(a),this.addChildView(this._detailsView),this.buttonConfig=n.buttons||[],this._selectedTab=b,this.model&&(n.force=!0,this.resetModel(this.model,n),this.listenTo(this._detailsView.model,"onChange:modificationsPending",this.setSaveState)),this.listenTo(this._detailsView,"scrollToElement",this.scrollToElement)},createCommonLibrary:function(e){T.loadJSDependency("DS/ENOProjectMgmtCommonComponents/components/CommonInitializer").then((t=>{T.fixDisplayMessageMethod(),V.commonInitializerLibrary=new t({isComponent:!0,loadClassification:!0,isLibraryInstalled:e,securityContext:window.enoviaServer.space})})).catch((e=>{"scripterror"===e.requireType&&console.error(e.message)}))},onFieldValueChange:function(){this._onFieldValueChangeTimeout=this._onFieldValueChangeTimeout||setTimeout((()=>{this._onFieldValueChange(),this._onFieldValueChangeTimeout=void 0}),0)},_onFieldValueChange:function(){var e=this._scroller&&this._scroller.getInnerElement().scrollTop,t=this._scroller&&this._scroller.getInnerElement().scrollLeft;this._detailsView.setConfig(this.getConfig()),this._smartRender(),this._scroller&&this._scroller.scrollTo(t,e)},updateCommonInitializerLibrary:function(){V.commonInitializerLibrary&&V.commonInitializerLibrary.initializeComponent&&V.commonInitializerLibrary.initializeComponent({isComponent:!0,loadClassification:!1,securityContext:window.enoviaServer.space})},setupAdditionalTabs:function(){var e=this.container.getElement("#commentsTab"),t=this.container.getElement("#classificationTab"),n=this.container.getElement("#characteristicsEditorViewTab"),s=this.container.getElement("#historyTab"),i=this.container.getElement("#checklistTab");this.addChildView(T.createTooltip(e,this.i18n("E6WCommonApps.Command.Comments"))),this.addChildView(T.createTooltip(t,this.i18n("E6WCommonApps.Command.Classification"))),this.addChildView(T.createTooltip(n,this.i18n("E6WCommonApps.Command.Extension"))),this.addChildView(T.createTooltip(s,this.i18n("E6WCommonApps.Command.AuditHistory"))),this.addChildView(T.createTooltip(i,this.i18n("E6WCommonApps.Command.Checklist")))},render:function(t){var n=e.clone(t||{},!1);if(!this.model)return this;this.container.setHTML(this.template()),this._initButtons(this.buttonConfig);var s=e.merge({},n,{fromRender:!0});this._renderBodyContent(s);var i=this.container.getElement("#detailsTab"),a=this.container.getElement("#membersTab");return this.addChildView(T.createTooltip(i,this.i18n("E6WCommonApps.Command.Properties"))),this.addChildView(T.createTooltip(a,this.i18n("E6WCommonApps.Command.Members"))),this.setupAdditionalTabs(),o.getTouchMode()&&this.container.toggleAttribute("touch-mode",!0),this},_removeTabs:function(){this._detailsView.remove(),this._commentsView&&this._commentsView.remove(),this.auditHistoryView&&this.auditHistoryView.remove(),this._charEditor&&this._charEditor.remove()},injectScroller:function(){this._scrollerElement=e.createElement("div",{id:"detailsPanelScroller",styles:{"-webkit-user-select":"text"}}),this._scrollerElement.inject(this.container.getElement("#detailsPanelFrame"))},_handleCommentsTabContainer:function(e){const t=!(void 0!==this.model.isIteropTask&&this.model.isIteropTask()||this.model.get("_isSourcingTask"))&&!D.inScenario();w.call(this,{tabId:"#commentsTab",shouldShow:t,isSelected:this._selectedTab===I,onFallback:b}),this._selectedTab===I&&(e.remove(),this._commentsView&&this._commentsView._optionsFromXPP&&(this._initCommentsView(),this._commentsView.render(this._commentsView._optionsFromXPP)),this._commentsView.inject(this._scrollerElement))},_handleClassificationTabContainer:function(e){const t=this.validTypesForClassificationTab(e)&&!this.model.isRDF;w.call(this,{tabId:"#classificationTab",shouldShow:t,isSelected:this._selectedTab===N,onFallback:b})},_handleHistoryTabContainer:function(e){const t=T.isTask(e)&&!this.model.isRDF,n=this.model.get("policy")&&!this.model.get("_isSourcingTask"),s=this.model.isRDF&&!T.isConstraint(e),i=D.inScenario(),o=(t||n||s)&&!i;w.call(this,{tabId:"#historyTab",shouldShow:o,isSelected:this._selectedTab===W,onFallback:this.onDetailsTabClicked.bind(this)})},_handleScenariosTabContainer:function(){const e=T.isProject(this.model.get("dsxplan:jsType"))&&this.model.isXProject()&&!D.inScenario();w.call(this,{tabId:F,shouldShow:e,isSelected:this._selectedTab===F,onFallback:this.onDetailsTabClicked.bind(this)})},_handleCharacteristicsTabContainer:function(){const e=this.model.get("dsxplan:customExtensionName")&&!D.inScenario();w.call(this,{tabId:"#characteristicsEditorViewTab",shouldShow:!!e,isSelected:this._selectedTab===P,onFallback:b})},_handleChecklistTabContainer:function(e,t){const n=this.validTypesForChecklistTab(e)&&!t&&!D.inScenario();w.call(this,{tabId:"#checklistTab",shouldShow:n,isSelected:this._selectedTab===k,onFallback:this.onDetailsTabClicked.bind(this)})},_handleAdditionalTabContainers:function(e,t,n){this._handleCommentsTabContainer(e),this._handleClassificationTabContainer(t),this._handleCharacteristicsTabContainer(),this._handleHistoryTabContainer(t),this._handleScenariosTabContainer(),this._handleChecklistTabContainer(t,n)},_clearExistingBodyContent:function(){this._detailsView.remove(),this.container.getElement("#detailsPanelFrame").empty(),this._scrollerElement&&this._scrollerElement.destroy()},_renderBodyContent:function(t){var n=e.clone(t||{},!1);if(this.model.fetchingHistory&&this._selectedTab===W&&!n.fromRender)return;this._removeTabs(),this._clearExistingBodyContent(),this.injectScroller(),this._setSelectedTab(n.selectedTab||this._selectedTab);var s=this._detailsView.render({boundingElement:this._scrollerElement}).container;s.inject(this._scrollerElement);var i=this.model.get("dsxplan:jsType")||this.model.get("dsplan:jsType")||this.model.get("type");let o="dsxnpi:MilestoneExternal"===this.model.get("dsxplan:vocabularyType");this._handleAdditionalTabContainers(s,i,o);var a=this,r=function(){if(a.container){if(a._scrollerTimeout&&clearTimeout(a._scrollerTimeout),delete a._scrollerTimeout,a._selectedTab===k)"none"===a.container.getElement("#checklistTab").style.display&&(a._selectedTab=b);if(a._selectedTab!==b&&a._selectedTab!==O&&a._selectedTab!==k||!a._detailsView){var e=a.validTypesForClassificationTab(i);if(a._selectedTab===I)!a._commentsView&&a._initCommentsView(),a._setScrollerContent(a._commentsView);else if(a._selectedTab===N&&e&&!a.model.isRDF)!a._classificationFacet&&a.renderClassificationView();else if(a._selectedTab===P){!a._charEditor&&a._initCharacteristicsView();var t=a.getCustomExtensionContainer();a._charEditor.inject(t),a._setScrollerContent(t)}else a._selectedTab===W?(!a.auditHistoryView||!a.auditHistoryView.container)&&a._resetHistoryTab():a._selectedTab===F&&(a._detailsView.setConfig(a.getConfig({scenariosTab:!0})),a._setScrollerContent(a._detailsView.render().container))}else a._detailsView.container.offsetWidth?a._setScrollerContent(a._detailsView):a._scrollerTimeout=setTimeout(r,10)}};r()},showLoadingMessage:function(){this._scrollerElement&&T.showLoadingMessage(this._scrollerElement)},hideLoadingMessage:function(){T.hideLoadingMessage(this._scrollerElement)},validTypesForClassificationTab:function(e){return["dsplan:Task","swym:WeDo","Task","Gate","Milestone","Phase"].includes(e)},validTypesForChecklistTab:function(e){return["dsplan:Task","dsplan:Project","dsplan:Milestone","dsplan:Gate"].includes(e)},cancel:function(t){var n=e.clone(t||{},!1),s=this,i=function(){n.keepPanelOpen||s.close(),e.is(n.onCancel,"function")&&n.onCancel(),s.dispatchEvent("onCancel")};this._detailsView&&this._detailsView.model&&this._detailsView.model.modificationsPending?this.model.destroying?(T.displayInfo(this.model.get("title")+" "+this.i18n("E6WCommonApps.Error.HasBeenDeleted")),this._detailsView.model.cancel(),i()):(n.model=this._detailsView.model,n.onSave=()=>{s.save()||this._detailsView.model.save()},n.onCancel=()=>{this._detailsView&&this._detailsView.model.cancel()},n.callback=i,M.render(n,s)):i()},getIsActualDatesChanged:function(e){return e.localAttributes.hasOwnProperty(f.ACTUAL_START_DATE)||e.localAttributes.hasOwnProperty(f.ACTUAL_END_DATE)},_setupStoryTaskListeners:function(){this.model.getObjectType&&T.isTask(this.model.getObjectType())&&this._addStoryTaskListeners()},save:function(){var t=this,n=this._detailsView._config,s=n&&e.clone(n.options||{},!1);t.model.isSavePending=!0;var i=this.model,o=this._detailsView.model,a=function(){o.urlUpdated=!1,t._detailsView.model.save({mask:i.getPropertyMask&&i.getPropertyMask(),onComplete:function(){delete i.isSavePending,i.dispatchEvent("saveCompleted"),s&&e.is(s.onComplete,"function")&&s.onComplete.apply(t,arguments)},onFailure:function(){s&&e.is(s.onFailure,"function")&&s.onFailure.apply(t,arguments)}})};if("dsplan:Task"===i.getObjectType()&&"function"==typeof o.getIsActualDatesChanged&&o.getIsActualDatesChanged(o)){var r=i.getProjectParent(i).id;i.calculateAndSetDuration(r,{startDate:o.getStartDate().actualValue,endDate:o.getEndDate().actualValue,dontSave:!0,onComplete:function(){o._isUrlAttached(t._detailsView.model)||a()}})}else{var l=t._charEditor&&t._charEditor.elements.form.getModifiedValues();l&&(o.localAttributes.modifiedExtensionValues=l,Object.entries(l).forEach((([e,t])=>{i.set(e,t,{dontRegisterChange:!0})}))),o._isUrlAttached(t._detailsView.model)||a()}},resetModel:function(t,n){var s=e.clone(n||{},!1),i=s.force;t&&t.fetchForProperty&&t.fetchForProperty(),t&&this.getTagInfoForModel(t),!i&&this.isSameModel(t,this.model)||(this._detailsView.model&&this.stopListening(this._detailsView.model),(i||this._detailsView)&&this.resetDetailsDisplayView(t,n,s),this._initCommentsView(),this._addModelEvents(),this.setSaveState(),!s.noRender&&this._smartRender(n),t.isValid()?this.enableSaveButton():this.disableSaveButton(),this._handlePeopleTabDisplay(n),this._updateStateOfAssignToSelfButton(),this._resetHistoryTab(),this._resetCharacteristicsTab(),this._setupStoryTaskListeners())},resetDetailsDisplayView:function(t,n,s){var i=this._detailsView.model;this.model&&t.constructor!==this.model.constructor&&this._detailsView.setConfig([]),this.model=t;var o=this.cloneModelForDetailDisplayView();o.validationError=e.is(o.validate,"function")&&o.validate(o.toJSON());let a=n?!n.force:void 0;this._detailsView.resetModel(o,a,{noRender:!0,isShadowMilestoneGate:s.isShadowMilestoneGate}),this.config=this.getConfig(n),this._detailsView.setConfig(this.getConfig(n)),i&&i.destroy()},isSameModel:function(e,t){return e===t},getTagInfoForModel:function(e){g.getTagInfo(e)},_resetHistoryTab:function(){this._selectedTab===W&&(this._cleanupAuditHistoryToolbar(),this._includeChildrenToggleState=!1,this._fetchAuditHistoryData({onComplete:(e,t)=>{this.initAuditHistoryView(e,t)},onFailure:function(){this.initAuditHistoryView({},[])}}))},_resetCharacteristicsTab:function(){this._selectedTab===P&&(this._charEditor&&this._charEditor.remove(),this._initCharacteristicsView())},_addStoryTaskListeners:function(){let e=Boolean(c.isStoryTask(this._detailsView.model)&&this._detailsView.model.get(_.WORK_CONTEXT_ATTR));const t=()=>{this._storyTaskTimeout=this._storyTaskTimeout||setTimeout((()=>{this._storyTaskTimeout=void 0;const t=Boolean(c.isStoryTask(this._detailsView.model)&&this._detailsView.model.get(_.WORK_CONTEXT_ATTR));e!==t&&(e=t,this.onFieldValueChange())}),0)};this.listenTo(this._detailsView.model,`onChange:${_.PARENT_ATTR}`,t),this.listenTo(this._detailsView.model,`onChange:${_.WORK_CONTEXT_ATTR}`,t)},getDropDownMenu:Function.prototype,renderClassificationView:function(){var e=this;T.loadJSDependency("DS/ClassificationsFacet/ClassificationFacet").then((n=>{e._classificationFacet=new n({isBookmark:!1,isLibrary:{definitionPurpose:!0,categorizationPurpose:!0},isExternal:!0,onDestroyCallback:Function.prototype,securityContext:"ctx::"+WidgetUwaUtils.getContext()}),e._setScrollerContent(e._classificationFacet.elements.container),e._classificationFacet.updateFacetExternal(new t({objectId:e.model.id}))})).catch((e=>{"scripterror"===e.requireType&&console.error(e.message)}))},onDeleteAccessChange:function(){this._detailsView.setConfig(this.getConfig({isShadowMilestoneGate:this.isShadowMilestoneGate})),this._smartRender(),this._updateStateOfDeleteButton()},getManagementView:function(){return this.managementView},_addModelEvents:function(){var e={"onChange:modificationsPending":this.setSaveState,onValidationFailure:this.disableSaveButton,onValidationSuccess:this.enableSaveButton,onChange:function(e,t){if(t&&t.config&&("dsplan:hasAssignee"===t.config.name||"assignees"===t.config.name)){var n=e.get(t.config.name);this._updateStateOfAssignToSelfButton(n)}}};this.listenTo(this._detailsView.model,e);var t={"onChange:dsxplan:hasAssignee":this._updateActionButtonsState,onChange:function(e,t){t&&"assignees"===t.relationshipChanged&&this._updateActionButtonsState()},onModifyAccessChanged:this.onFieldValueChange,onDeleteAccessChanged:this.onDeleteAccessChange,onDestroy:this.close};this.listenTo(this.model,t),this.listenTo(this._detailsView.model,"onChange:"+f.CONTENT_REPOSITORY,this.onFieldValueChange),this.listenTo(this.model,"onChange:"+f.MILESTONE_VOCABULARY_TYPE,this.onFieldValueChange),this.listenTo(this._detailsView.model,"onChange:"+f.MILESTONE_VOCABULARY_TYPE,this.onFieldValueChange),this.listenTo(this._detailsView.model,"onChange:dsxplan:customExtensionName",this.onFieldValueChange),this.listenTo(this._detailsView.model,"onUrlFailure",this.onFieldValueChange),this.listenTo(this._detailsView.model,"onUrlUpdate",this.save),this.listenTo(this.model,"onChange:"+f.USER_DEFINED_START_DATE_ATTR,this.onFieldValueChange),this.listenTo(this.model,"onChange:"+f.USER_DEFINED_END_DATE_ATTR,this.onFieldValueChange),this.listenTo(this._detailsView.model,"onChange:routeTaskApprovalComments",(()=>{"Approve"===this._detailsView.model.get("routeTaskAction")&&this.onFieldValueChange()})),this.listenTo(this._detailsView.model,"onChange:"+f.STATE_ATTR,this.onFieldValueChange),this.listenTo(this._detailsView.model,"onChange:dsxplan:isEnforced",this.onFieldValueChange),this.listenTo(this._detailsView.model,"onChange:"+f.GOVERNING_PROCESS_INSTANCE_ATTR,this.onFieldValueChange)},_updateActionButtonsState:function(e){this._updateStateOfAssignToSelfButton(),this._updateStateOfDuplicateButton(e),this._updateStateOfDeleteButton(e),this._handlePeopleTabDisplay(e)},_updateStateOfAssignToSelfButton:function(e){var t=this.getElement("#assignToSelfItem");t&&(this.model&&!this.model.canAssignToSelf(e)?t.toggleClassName("disabled",!0):t.toggleClassName("disabled",!1))},_updateStateOfDuplicateButton:function(t){var n=this._dropDownMenu;n&&(t&&t.isSummaryTask||e.is(this.model.canModify,"function")&&!this.model.canModify(!0)?n.disableItem(this.i18n("E6WCommonUI.Label.Duplicate")):n.enableItem(this.i18n("E6WCommonUI.Label.Duplicate")))},_updateStateOfDeleteButton:function(e){var t=this._dropDownMenu;t&&(e&&e.isShadowMilestone||this.isShadowMilestone||this.model&&(this.model.isRouteTask&&this.model.isRouteTask()||!this.model.canDelete(!0))?t.disableItem(this.i18n("E6WCommonApps.Label.Delete")):t.enableItem(this.i18n("E6WCommonApps.Label.Delete")))},getChecklistConfig:function(){throw new Error("In PropertyPanel getChecklistConfig, this should be implemented in subclass.")},_handlePeopleTabDisplay:function(t){var n=e.clone(t||{},!1);n.isShadowMilestoneGate=t&&t.isShadowMilestoneGate||this.isShadowMilestoneGate;var s=this.getPersonConfig(this.getOriginalConfig(n)),i=this.container.getElement("#membersTab");n.isShadowMilestoneGate&&i&&(i.style.display="none"),i&&(0===s.length?(i.style.display="none",this._selectedTab===O&&this._setSelectedTab(b)):i.style.display="inline-block")},_smartRender:function(e){0!==this.container.childElementCount?this._renderBodyContent(e):this.render(e)},disableSaveButton:function(){var e=this.container.getElement("#saveButton");e&&e.setAttribute("disabled","disabled")},enableSaveButton:function(){var e=this._detailsView.isModelValid()&&this.container.getElement("#saveButton");e&&e.removeAttribute("disabled")},showOrHideBookmarkForRepositoryField:function(e){let t=this._detailsView&&this._detailsView.model;if(t){var n=t.get(f.CONTENT_REPOSITORY)||t.get("dsplan:hasContentRepository");if(!n||"3DDrive"===n.serviceHosting){var s=e.findIndex((function(e){return e.name===f.BOOKMARK_FOR_FILE_REPOSITORY}));-1!==s&&e.splice(s,1)}}},template:function(t){var n=e.clone(t||{},!1).data;n={panelTabs:[{id:"detailsTab",iconClass:"fonticon fonticon-attributes"},{id:"checklistTab",iconClass:"fonticon fonticon-list-ok"},{id:"scenariosTab",iconClass:"wux-ui-3ds-project-scenario wux-ui-3ds"},{id:"characteristicsEditorViewTab",iconClass:"fonticon fonticon-properties"},{id:"membersTab",iconClass:"fonticon fonticon-users"},{id:"commentsTab",iconClass:"fonticon fonticon-comment"},{id:"classificationTab",iconClass:"fonticon fonticon-library-class"},{id:"historyTab",iconClass:"fonticon fonticon-navigation-history"}]};var s=m.i18n;m.i18n=this.i18n;var i=L(n);return m.i18n=s,i},selectTab:function(e){e===I&&this.onCommentsTabClicked()},destroyToolbarElementAndRemoveExtraClassInBody:function(){const e=this.container.getElement(".body-toolbar");e&&e.destroy(),this.container.getElement(".body").classList.remove("eno-empty-set")},getSelectedTab:function(){return this._selectedTab},getExportHistoryDropdownMenuItem:function(){return{id:"exportHistoryToCSV",text:this.i18n("E6WCommonApps.Label.ExportHistoryToCSV"),fonticon:"export",handler:()=>{this.auditHistoryView&&this.auditHistoryView.exportToCsvHandler()}}},refreshDropDownMenu:function(){this._dropDownMenu&&this._dropDownMenu.destroy(),this._dropDownMenu=this.getDropDownMenu()},onChecklistTabClicked:function(){x.call(this,k,(function(){this._scrollerElement&&this._scrollerElement.empty(),this._detailsView.setConfig(this.getConfig()),this._setScrollerContent(this._detailsView.render().container)}))},onCommentsTabClicked:function(){x.call(this,I,(function(){this._commentsView&&this._commentsView._optionsFromXPP&&(this._initCommentsView(),this._commentsView.render(this._commentsView._optionsFromXPP)),this._setScrollerContent(this._commentsView)}))},onMembersTabClicked:function(){x.call(this,O,(function(){this._detailsView.setConfig(this.getConfig()),this._setScrollerContent(this._detailsView.render().container),this._updateStateOfAssignToSelfButton()}))},onDetailsTabClicked:function(){x.call(this,b,(function(){this._detailsView.setConfig(this.getConfig({isShadowMilestoneGate:this.isShadowMilestoneGate})),this._setScrollerContent(this._detailsView.render().container)}))},onClassificationTabClicked:function(){x.call(this,N,(function(){this._scrollerElement&&this._scrollerElement.empty(),this.renderClassificationView()}))},onCharacteristicsEditorViewTabClicked:function(){x.call(this,P,(function(){if(this._scrollerElement&&this._scrollerElement.empty(),void 0===this._charEditor||this._charEditor&&!this._charEditor.hasModifiedValues())this._charEditor&&this._charEditor.remove(),this._initCharacteristicsView();else{var e=this.getCustomExtensionContainer();this._charEditor.inject(e),this._setScrollerContent(e)}}))},onHistoryTabClicked:function(){x.call(this,W,(function(){if(this._scrollerElement&&this._scrollerElement.empty(),this.model.isRDF)this._includeChildrenToggleState=!1,this._fetchAuditHistoryData({onComplete:(e,t)=>{this.initAuditHistoryView(e,t)},onFailure:function(){this.initAuditHistoryView({},[])}});else{var e=this;T.loadJSDependency("DS/ENXHistoryUX/View/HistoryFacet").then((t=>{e.auditHistoryView=t.init({id:[e.model.id],facetLang:widget.lang,securityContext:p.getDefaultSecurityContext()},this._scrollerElement)})).catch((e=>{"scripterror"===e.requireType&&console.error(e.message)}))}}))},onScenariosTabClicked:function(){x.call(this,V.SCENARIOS_TAB,(function(){this._detailsView.setConfig(this.getConfig({scenariosTab:!0})),this._setScrollerContent(this._detailsView.render().container)}))},_initCharacteristicsView:function(){var e=this;let t=!T.isProject(e.model.get(f.PROJECT_TYPE))&&e.model.get(f.RESTRICT_ASSIGNEE_ATTR);T.loadJSDependency("DS/dsbaseUIControls/CharacteristicsView").then((n=>{var s={rdfServerURL:E.getServiceUrl("3dplan")+"/",resourceURI:e.model.get("@id"),platformId:E.getTenant(),customization:{editMode:e.model.get("canEdit")&&!t,display:{title:!1,subtitle:!1,switchMode:!1,scroller:!1,switchLanguage:!1},constraintsPosition:"right",getInfos:function(){var t=a.authenticatedRequest,n={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","Accept-Language":widget.lang};return new Promise((function(s,i){t(E.getServiceUrl("3dplan")+"/resources/v1/template-instances/"+e.model.get("@id")+"?denyCharac=dskern:owner,dspol:creationDate,dspol:modificationDate,dskern:nlsLabel,dskern:nlsComment",{method:"GET",headers:n,type:"json",onComplete:function(e){s(e)},onFailure:function(e,t,n){i(n)},timeout:3e5})}))}},events:{onValueChange:function(){var t=e._charEditor.elements.form,n=!0;t.unvalidate(),t.getAllInputInstances().forEach((function(e){e.validateForForm()||(n=!1)})),e._charEditor.hasModifiedValues()&&n&&(e._detailsView.model.modificationsPending=!0,e._detailsView.model.dispatchEvent("onChange:modificationsPending",[e._detailsView.model]),e.enableSaveButton())}}};e._charEditor=new n(s);var i=this.getCustomExtensionContainer();e._charEditor.inject(i),e._setScrollerContent(i)})).catch((e=>{"scripterror"===e.requireType&&console.error(e.message)}))},getCustomExtensionContainer:function(){var t=m.i18n;m.i18n=this.i18n;var n=U({extension:this.model.get("dsxplan:customExtensionName")});return m.i18n=t,e.createElement("div",{html:n})},_disableTabFocusOnElements:function(){this._setTabIndexOnFocusableElements(-1)},_enableTabFocusOnElements:function(){this._setTabIndexOnFocusableElements(0)},_setTabIndexOnFocusableElements:function(e){var t=-1===e?0:-1;this.container&&this.container.getElements("input").concat(this.container.getElements("a")).concat(this.container.getElements("link")).concat(this.container.getElements("select")).concat(this.container.getElements("textarea")).concat(this.container.getElements("button")).concat(this.container.getElements(".autocomplete-searchbox")).concat(this.container.getElements("[tabIndex='"+t+"']")).forEach((function(t){t.setAttribute("tabIndex",e)}))},close:function(){this._disableTabFocusOnElements(),this.dispatchEvent("onClose")},open:function(){this._enableTabFocusOnElements(),this.dispatchEvent("onOpen",[this.getContent()])},getConfig:function(e){return this.handleMembersChecklistConfig(e)},handleMembersChecklistConfig:function(e){if(V.DEACTIVATE_MEMBERS_TAB)return e;var t=this.getPersonConfig(e),n=e.filter((e=>"person"!==e.type&&e.name!==f.REMINDER_DAYS));if(this._selectedTab===O)return t.options=e.options,t;if(this._selectedTab===W){var s=[];return s.options=e.options,s}return this._selectedTab===k?this.getChecklistConfig():(n.options=e.options,n)},getPersonConfig:function(e){return e.filter((e=>"person"===e.type||e.name===f.REMINDER_DAYS))},setSaveState:function(){this.container.toggleClassName("save-needed",this.saveNeeded())},saveNeeded:function(){return Boolean(this._detailsView.model.modificationsPending)},cloneModelForDetailDisplayView:function(){throw new Error("In PropertyPanel cloneModelForDetailDisplayView, this should be implemented in subclass.")},getOriginalConfig:function(){throw new Error("In PropertyPanel getOriginalConfig, this should be implemented in subclass.")},destroy:function(){this._onFieldValueChangeTimeout&&clearTimeout(this._onFieldValueChangeTimeout),this._onFieldValueChangeTimeout=void 0,this._parent(),delete this._detailsView,this._dropDownMenu&&this._dropDownMenu.destroy(),this._commentsView&&this._commentsView.destroy(),delete this._commentsView,this._charEditor&&this._charEditor.remove(),delete this._charEditor,this.modal&&this.modal.destroy(),delete this.modal;var e=this._detailsView&&this._detailsView.model;e&&e.destroy(),this._scrollerElement&&this._scrollerElement.destroy(),delete this._scrollerElement,this._scroller&&this._scroller.destroy(),delete this._scroller,delete this.buttonConfig,this._scrollerTimeout&&clearTimeout(this._scrollerTimeout),delete this._scrollerTimeout,this._storyTaskTimeout&&clearTimeout(this._storyTaskTimeout),this._storyTaskTimeout=void 0},_fetchAuditHistoryData:function(t){var n=e.clone(t||{},!1);if(!this.model.fetchingHistory){this._currentAuditHistoryRequest&&this._currentAuditHistoryRequest.cancel(),this.showLoadingMessage&&this.showLoadingMessage();var s={};s.includeChildren=n.includeChildren||!!this._includeChildrenToggleState,s.includeChildren&&(s.identifier=n.identifier||this.startHistoryLoadingActivity()),this._currentAuditHistoryRequest=this.model.fetchAuditHistoryData({...s,onComplete:({s3History:t,rdfHistory:s})=>{this.hideLoadingMessage&&this.hideLoadingMessage(),e.is(n.onComplete,"function")&&n.onComplete.call(this,s,t)},onFailure:t=>{this.hideLoadingMessage&&this.hideLoadingMessage(),e.is(n.onFailure,"function")&&n.onFailure.call(this,t)}}),this.model.fetch({mask:"dsplan:MVMask.WorkPackage.Collapsed",onComplete:()=>{const e=e=>{const t=this.model.get(e);return t&&t.hasChildItems()},t=e("dsxplan:hasTask")||e("dsxplan:hasSubtask")||e("dsxplan:hasMilestone")||e("dsxplan:hasReferenceProject")||e("dsplan:hasWorkDecomposition")||e("dsxplan:hasGate")||e("dsxplan:hasBacklogTask");this._includeChildrenToggleDisabled=!t,this._includeChildrenToggle&&(this._includeChildrenToggle.disabled=this._includeChildrenToggleDisabled,this._includeChildrenToggleDisabled&&(this._includeChildrenToggle.checkFlag=!1,this._includeChildrenToggleState=!1))}})}},_cleanupAuditHistoryToolbar:function(){this._includeChildrenToggle&&(this._includeChildrenToggle.destroy(),this._includeChildrenToggle=null),this._historyToolbarElement&&(this._historyToolbarElement.destroy(),this._historyToolbarElement=null)},_createAuditHistoryToolbar:function(){var t=this,n=e.createElement("div",{class:"body-toolbar"});this._historyToolbarElement=n,this._includeChildrenToggle=new i({type:"switch",label:this.i18n("E6WCommonApps.Label.IncludeChildren")||"Include Child Items",checkFlag:!!this._includeChildrenToggleState,disabled:!!this._includeChildrenToggleDisabled,tooltipInfos:new s({title:this.i18n("E6WCommonApps.Label.IncludeChildren"),shortHelp:this.i18n("E6WCommonApps.Label.IncludeChildrenTooltip")||"Show audit history for child items as well"})}),this._includeChildrenToggle.elements.container.addClassName("include-children-toggle"),this._includeChildrenToggle.addEventListener("change",(function(e){if(t._includeChildrenToggleState=e.dsModel.checkFlag,t._includeChildrenToggleState){var n=t.i18n("E6WCommonApps.Warning.IncludeChildrenArchiveOnly")||'When "Include Child Items" is enabled, history is retrieved only from archive and does not contain recent 4 hours of data.';T.displayWarning(n)}t.auditHistoryView&&(t.auditHistoryView.destroy(),t.auditHistoryView=null),t.showLoadingMessage&&t.showLoadingMessage(),t._fetchAuditHistoryData({onComplete:function(e,n){t.hideLoadingMessage&&t.hideLoadingMessage(),t.initAuditHistoryView(e,n)},onFailure:function(e){t.hideLoadingMessage&&t.hideLoadingMessage(),T.displayError.call(t,e)}})})),this._includeChildrenToggle.inject(n),n.inject(this.getElement("#detailsPanelFrame"),"before")},initAuditHistoryView:function(e,t){if(this._selectedTab===W){this.hideLoadingMessage(),this.auditHistoryView&&this.auditHistoryView.elements&&this.auditHistoryView.elements.container&&(this.auditHistoryView.elements.container.remove(),this.auditHistoryView=null),this._cleanupAuditHistoryToolbar(),this.auditHistoryView=this.createHistoryViewInstance(e,t),this._setScrollerContent(this.auditHistoryView);T.isProject(this.model.get("dsxplan:jsType"))&&this._createAuditHistoryToolbar()}},createHistoryViewInstance:function(e,t){return new C({rdfDataResponse:e,s3BucketResponse:t,model:this.model,includeChildren:this._includeChildrenToggleState,fetchModelFromServer:!0})},_setSelectedTab:function(e){this._selectedTab=e,this.container.getElements(".panel-tab").forEach((function(t){t.toggleClassName("selected",t.id===e)}))},_initCommentsView:function(){this._commentsView&&this._commentsView.destroy(),this._commentsView=r.loadComments(this.model)},_setScrollerContent:function(e){this._scroller&&(this._scroller.destroy(),this._scrollerElement.empty()),e.inject(this._scrollerElement),this._scroller=new n({element:this._scrollerElement}).inject(this.getElement("#detailsPanelFrame")),this.getElement(".scroller-content").addEventListener("scroll",(()=>{this._detailsView.handleParentScroll()}))},_initButtons:function(t){var n=this.container.getElement(".panel-actions");if(t&&n){n.empty();var s=this,i=0;t.forEach((function(t){var o;o=t.content?e.createElement("div",{class:"panel-action",id:t.id,"data-title":t.title,html:t.content}):e.createElement("div",{class:"panel-action icon-only-button",html:{tag:"button",id:t.id||s.cid+"Button"+i,class:"btn","data-title":t.title,disabled:t.disabled,html:{tag:"span",class:"fonticon fonticon-"+(t.fonticon||"info")}}}),s.addChildView(T.createTooltip(o,t.title)),o.inject(n),i+=1}))}},getCloneModel:function(){return this._detailsView&&this._detailsView.model},getFieldViewByName:function(e){return this._detailsView.getFieldViewByName(e)},scrollToElement:function(e){this._scroller.scrollToElement(e)}});return V.COMMENTS_TAB=I,V.HISTORY_TAB=W,V.SCENARIOS_TAB=F,V.MEMBERS_TAB=O,V.DETAILS_TAB=b,V.DEACTIVATE_MEMBERS_TAB=!1,V.DRAGOVER_DELAY=1e3,V})),define("DS/E6WCommonApps/MultiEdit/MultiPropertyPanel",["UWA/Core","DS/UIKIT/SuperModal","DS/E6WCommonApps/MultiEdit/E6WMultiDetailsDisplayView","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Views/PropertyPanel","DS/E6WCommonApps/Models/ScheduleElementModel"],(function(e,t,n,s,i,o){"use strict";var a=i.extend({_uwaClassName:"MultiPropertyPanel",DisplayView:n,setupAdditionalTabs:Function.prototype,createDetailsDisplayView:function(e){this._detailsView=new n(e)},resetConfigAndRender:function(){this._detailsView.setConfig(this.getConfig({isShadowMilestoneGate:this.isShadowMilestoneGate})),this.render()},save:function(){this.model.models.map((e=>{const t=e.get("team_members");t&&this.listenTo(t,"onSync",this.resetConfigAndRender)})),this.listenTo(this.model,"saveCompleted",this.resetConfigAndRender),this.listenTo(this.model,"massEditFailed",this.resetConfigAndRender),this.listenTo(this.model,"massEditSuccedded",this.solve),this._parent.apply(this,arguments)},solve:function(){var t={};return this.model.isProject()&&(t.listName="ProjectList"),t=e.merge(t,this.model.getSolveOptions()),o.prototype.solve.call(this.model,t)},_removeTabs:function(){this._detailsView.remove()},_handleAdditionalTabContainers:function(){this.container.getElement("#commentsTab").style.display="none",this.container.getElement("#classificationTab").style.display="none",this.container.getElement("#characteristicsEditorViewTab").style.display="none",this.container.getElement("#historyTab").style.display="none",this.container.getElement("#checklistTab").style.display="none",this.container.getElement("#scenariosTab").style.display="none"},_updateStateOfAssignToSelfButton:Function.prototype,getIsActualDatesChanged:Function.prototype,_updateStateOfDeleteButton:Function.prototype,isSameModel:function(e,t){return"function"==typeof e.hasSameModels?e.hasSameModels(t):e===t},disableSaveButton:function(){var e=this.container.getElement("#saveButton");e&&e.setAttribute("disabled","disabled")},getTagInfoForModel:Function.prototype,_initCommentsView:Function.prototype,_resetHistoryTab:Function.prototype,_resetCharacteristicsTab:Function.prototype,_setupStoryTaskListeners:Function.prototype,_initCharacteristicsView:Function.prototype});return a})),define("DS/E6WCommonApps/Models/ConstraintCloneModel",["UWA/Core","DS/E6WCommonUI/Models/CloneModel","DS/E6WCommonApps/Models/ConstraintModel","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],(function(e,t,n,s,i){"use strict";var o=t.extend({init:function(){this._parent.apply(this,arguments),this.setup()},setup:function(){this.listenTo(this,"onChange:"+n.LAG_ATTR,(function(){this.renameLagField()}))},renameLagField:function(){!this.getIsEnforcedValue()&&this.get(n.LAG_ATTR)<0&&this.set(n.LAG_ATTR,Math.abs(this.get(n.LAG_ATTR)))},dataForRendering:function(){var e=this._parent();e[n.TYPE_ATTR]=this.get(n.TYPE_ATTR);var t=this.get(n.PREDECESSOR_ATTR);e[n.PREDECESSOR_ATTR]=t&&{title:t.get(i.TITLE_ATTR)};var s=this.get(n.SUCCESSOR_ATTR);return e[n.SUCCESSOR_ATTR]=s&&{title:s.get(i.TITLE_ATTR)},e[n.LAG_ATTR]=this.get(n.LAG_ATTR),e[n.ENFORCE_ATTR]=this.getIsEnforcedValue()?"FALSE":"TRUE",e},getIsEnforcedValue:function(){var e=this.get(n.ENFORCE_ATTR);return void 0===e||e},get:function(e){var t=this._parent.apply(this,arguments);return e===n.PREDECESSOR_ATTR||e===n.SUCCESSOR_ATTR||e===n.LAG_ATTR&&(t=void 0!==t?s.xsdDayTimeDurationToMilliseconds(t)/(60*this.getWorkDayLength()*60*1e3):0),t},set:function(e,t){var s=t;e===n.LAG_ATTR?(!this.getIsEnforcedValue()&&Number(t)<0&&(t=Math.abs(t)),s=this.getDurationString(t)):e===n.TYPE_ATTR?s=t.actualValue?t.actualValue:s:e===n.ENFORCE_ATTR&&(s="FALSE"===t);var i=this._parent(e,s,{whisper:!0});return e!==n.TYPE_ATTR&&e!==n.ENFORCE_ATTR||(this.dispatchEvent("onChange:"+e),e===n.ENFORCE_ATTR&&this.renameLagField()),i},getWorkDayLength:function(){return this.model.getWorkDayLength()},getDurationString:function(e){var t=this.model.getWorkDayLength();return s.millisecondsToXsdDayTimeDuration(e*(60*t*60*1e3))}});return n.prototype.getClone=function(e,t){return new o(e,t)},o})),define("DS/E6WCommonApps/Views/ConstraintFieldView",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonUI/Views/ObjectCardView","DS/E6WCommonUI/Views/DetailsDisplayView","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonApps/Models/ConstraintModel","DS/E6WCommonApps/Models/ConstraintCloneModel","DS/E6WCommonApps/Models/ScheduleElementModel","DS/E6WCommonApps/Utils/3DSpaceUtils","DS/E6WCommonApps/Views/LinkLauncherUtils","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/Preferences","DS/E6WCommonApps/Views/E6WCustomUomView","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,E){"use strict";var g=[{name:r.TYPE_ATTR,label:T.get("E6WCommonApps.Label.Type"),type:"select",values:[{actualValue:r.TYPE_START_TO_START,displayValue:T.get("E6WCommonApps.Label.StartToStart")},{actualValue:r.TYPE_FINISH_TO_START,displayValue:T.get("E6WCommonApps.Label.FinishToStart")},{actualValue:r.TYPE_FINISH_TO_FINISH,displayValue:T.get("E6WCommonApps.Label.FinishToFinish")}]},{name:r.LAG_ATTR,label:T.get("E6WCommonApps.Label.LeadLag"),type:"uom",customView:m,uomValues:[T.get("E6WCommonApps.Label.Days"),T.get("E6WCommonApps.Label.Hours")],minimumValue:"0",maximumValue:"999999999",conversionTable:[1,24],customTooltips:[{iconClass:"info",tooltipTitle:T.get("E6WCommonApps.Label.LeadLag"),tooltipBody:T.get("E6WCommonApps.Label.Tooltip.LeadLag")}]}],A=s.extend({_uwaClassName:"ConstraintFieldView",setup:function(){this._parent.apply(this,arguments),this._config.dropHandler=this.onDrop.bind(this)},getDataOptions:function(){var e=this._parent.apply(this,arguments);return e.level=2,e.attributes.push(r.PREDECESSOR_ATTR,r.SUCCESSOR_ATTR),e},createMenuButtons:function(e){var t=this;this.dropdownMenu&&(this.dropdownMenu.destroy(),delete this.dropdownMenu),this.createDropdownMenu({target:e.target,items:[]}),this.addOpenWith(this.getModelFromCard(e.target)),this.getDropDownMenuItems(e.model.get("type"),e).forEach((function(e){t.dropdownMenu.addItem(e)})),this.listenToOnce(this._parentView,"onScroll",(()=>{this.dropdownMenu.hide()}))},getDropDownMenuItems:function(e,t){var s,i=this,o=t.model,r=this.getPropertiesButton(t),l=this.getRemoveItemButton(t),d=o.canModify&&!o.canModify(!0);r.disabled=d,l.disabled=o.canDelete&&!o.canDelete(!0),s=a.isXppViewer()?!t.model.id:!t.model.id||d;var c={text:T.get("E6WCommonApps.Label.ToggleConstraintProperties"),fonticon:"doc-text",handler:function(){i._onConstraintDropdownSelected(t.event.target.getParent("li"))},disabled:s};return t.model instanceof n?[r,c,l]:[r]},_onConstraintDropdownSelected:function(e){var n=t.getObjectById(e.getAttribute("data-id"));this._selectedConstraint===n?(this._hideDetailsDisplay(),delete this._selectedConstraint):(this._setupDetailsDisplay(n),this._detailsDisplayContainer.inject(e,"after"),this._selectedConstraint=n)},_hideDetailsDisplay:function(){this._detailsDisplayContainer&&this._detailsDisplayContainer.remove()},_setupDetailsDisplay:function(t){this._detailsDisplayView||(this._detailsDisplayView=new i,this.addChildView(this._detailsDisplayView),this._detailsDisplayView.setConfig(g),this._detailsDisplayContainer=e.createElement("li",{class:"nested-properties",styles:{height:"152px","background-color":"rgb(240, 240, 240)",border:"1px solid rgb(161, 161, 161)"}}),this._detailsDisplayView.inject(this._detailsDisplayContainer)),this._detailsDisplayView.resetModel(new l(t)),this._detailsDisplayView.render()},getExistingObjs:function(){var e=[];return this.normalizedGet(this.model,"toConstraints").forEach((function(t){t.getPredecessor()&&e.push({id:t.getPredecessor().id})})),this.normalizedGet(this.model,"fromConstraints").forEach((function(t){t.getSuccessor()&&e.push({id:t.getSuccessor().id})})),e},getModelFromFullTextSearch:function(e){var n=t.getObjectById(e.id),s=this;if(!n){var i=e["ds6w:type_value"]||e["ds6w:type"];(n=new(t.getModelConstructor({"@type":i}))(t.createPlaceholder(t.removeBracketLongURI(e.id),"",i,{forceDslc:!0}))).addEventOnce("onSync",(function(){s.model.dispatchEvent("onChange:"+s._config.name)})),n.fetch({mask:"dsplan:MVMask.Task.Basic"})}return n},_modelCanBeUsedAsDependency:function(e){var t;if(e instanceof d)if(e.id===this.model.model.id)t=T.replace(T.get("E6WCommonUI.Alert.CantBeConstrainedToItself"),{OBJECT_NAME:e.get("title")});else{var n=this.normalizedGet(this.model,"toConstraints").some((function(t){return t.getPredecessor()&&t.getPredecessor().id===e.id}));(n=n||this.normalizedGet(this.model,"fromConstraints").some((function(t){return t.getSuccessor()&&t.getSuccessor().id===e.id})))&&(t=T.replace(T.get("E6WCommonUI.Alert.AlreadyHasConstraint"),{OBJECT_THIS:this.model.get("title"),OBJECT_THAT:e.get("title")}))}else t=T.get("E6WCommonUI.Alert.CanOnlyConstrainTasksAndMilestones");return t&&o.displayWarning(t),void 0===t},modelAdd:function(e,t,n){var s=this,i=[];n.detailedObjects.forEach((function(t){if(!t.model&&t["ds6w:type"]&&(t.model=s.getModelFromFullTextSearch(t)),s._modelCanBeUsedAsDependency(t.model)){var n=t.model,o={};o[r.TYPE_ATTR]=r.TYPE_FINISH_TO_START,o[r.PREDECESSOR_ATTR]="fromConstraints"===e?s.model.model:n,o[r.SUCCESSOR_ATTR]="fromConstraints"===e?n:s.model.model,o[r.ENFORCE_ATTR]=!0,i.push(new r(o,{mask:"dsplan:MVMask.TempConstraint.Complex",dontUpdateConstrainedScheduleElements:!0}))}})),i.length>0&&this.model.add(this._config.name,i,n)},getModelFromCard:function(){var e=this._parent.apply(this,arguments);return e instanceof r?"fromConstraints"===this._config.name?e.getSuccessor():e.getPredecessor():e},onDrop:function(e){if(this.validateDroppedObjects(e))return!0;var t=o.getDataTransferJSON(e);if(t){for(var n=[],s=0;s<t.data.items.length;s++){var i=t.data.items[s],a=i.objectType;n.push({id:i.objectId,"ds6w:type":a})}this.modelAdd(this._config.name,[],{detailedObjects:n})}return!0},getActiveModel:function(e){var t=this._parent.apply(this,arguments);t||this.normalizedGet(this.model,this._config.name).some((function(n){return n.cid===e&&(t=n),n.cid===e}));return t},objectClick:function(e){var t=this.getModelFromCard(e.target);c.fetchParentTypesWithCallback(t,(function(){p.launchProperties(t.id,{model:t})}))}}),C=function(e,t,n,s,i){var o=new RegExp(e,"i"),a=this.model.model,r=function(){var r=[];if(e.length<2&&(n||t))n?r=n(i):(r=t(),i(r));else{var l=[];if(s)l=s();else{var d=a.getParent();d&&(l=d.getTasks())}l.forEach((function(e){e.get("title")&&e.get("title").match(o)&&r.push(e)})),i(r)}};if(s&&e.length>=2)r();else{var l=a&&a.getParent();if(l&&l.hasViewAccess()){var d=a.getSiblingCollection&&a.getSiblingCollection();if(d?.length)return void r()}a.fetch({mask:"dsplan:MVMask.Task.CollaborativeTask.siblings",onComplete:r,onFailure:r})}},_=function(e){var t={};return t.value=e.id,t.label=e.get("dsxplan:label"),t.model=e,t.image=e.getIconURL(),t};return A.typeAheadCallback=function(e,n,s,i){var o=e.modelId,a=e.getVisibleModels,r="ENXPLAN_AP"===widget.getValue("appId")&&A.getAllModels.bind(this),l=e.getModelsToFilter;C.call(this,s,a,r,l,(function(e){t.getBatchGenerator();var n=[];function s(e){var t=e.isComplete&&e.isComplete();return o!==e.id&&e.isRDF&&!t}!function(e){for(var t=0;t<e.length;t++){var i=e[t];s(i)&&n.push(_(i))}}(e),i(n)}))},A.getAllModels=function(e){let t=h.getCurrentProject();if(t){let n=u._RapidRDFModelRegistry.getOrCreateFromRDFModel(t);if(n&&n.hasFetchedCustomProjectStructure){let n=t?.getAllMilestoneTaskandGateModels();e(n)}else n&&n.fetchProjectStructure({onComplete:()=>{let n=t.getAllMilestoneTaskandGateModels();e(n)}})}},A.getObjectTooltip=function(t){var n=e.clone(t,!1);let s;if(n.model){let e=n.model.getParentWorkscope(),t=e?.get("title");n.model.isGhost&&n.model.isGhost()&&(t=e?.get("ds6w:context")),s=`${n.model.get("title")}\n${E.get("E6WCommonUI.Label.Project")}: ${t}`}return s},A})),define("DS/E6WCommonApps/Views/DependencyGroupView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/E6WCommonApps/Views/ConstraintFieldView","DS/E6WCommonApps/Views/DateConstraintView","DS/E6WCommonApps/ConstraintsUtil","DS/E6WCommonApps/Views/LinkLauncherUtils","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r){"use strict";var l=t.extend({_uwaClassName:"DependencyGroupView",tagName:"div",className:"form-section accordion details-display-shared-view ddv-field form-group",domEvents:{"click .form-section-title":"_onGroupLabelClicked"},id:function(){return"DependencyGroup_"+this.cid},setup:function(t){this._parent.apply(this,arguments),this._dependencyi18n=r.get("E6WCommonApps.Label.ConstraintsAndDependencies"),this._labelElem=e.createElement("label",{class:"top-label"}),this.container.setAttribute("data-field-index",1),this._setupGroupElements(),this._updateGroupTitle(),this._getVisibleModels=t.config.getVisibleModels,this._getModelsToFilter=t.config.getModelsToFilter,this.model&&this._listenToConstraints()},render:function(){return this._toConstraintView&&(this._toConstraintView.removeAutoCompleteFromDOM(),this._fromConstraintView.removeAutoCompleteFromDOM()),this.container.empty(!0),this._titleElem.inject(this.container),this._fieldContainer.inject(this.container),this._updateGroupTitle(),this.getExpanded()&&this._drawConstraints(),this},resetModel:function(e){this._parent.apply(this,arguments),this._updateGroupTitle(),this._listenToConstraints(),this._fromConstraintView&&(this._fromConstraintView.resetModel(e),this._toConstraintView.resetModel(e))},toggleExpanded:function(){this.container.hasClassName("expanded")?this.removeExpanded():this.setExpanded(),this.render()},_getGroupTitle:function(){var e=this._dependencyi18n;if(this.model){var t=this.model.get("toConstraints")||this.model.get("predecessors"),n=t?t.length:0,s=this.model.get("fromConstraints")||this.model.get("successors"),i=(s?s.length:0)+n;let o=this.model;(o.get(a.START_DATE_MIN_ATTR)||o.get(a.START_DATE_MAX_ATTR)||o.get(a.USER_DEFINED_START_DATE_ATTR))&&(i+=1),(o.get(a.END_DATE_MIN_ATTR)||o.get(a.END_DATE_MAX_ATTR)||o.get(a.USER_DEFINED_END_DATE_ATTR))&&(i+=1),(o.get(a.DATE_INTERVAL_MAX_ATTR)||o.get(a.DATE_INTERVAL_MIN_ATTR)||o.get(a.USER_DEFINED_DATES_ATTR)&&"FALSE"!==o.get(a.USER_DEFINED_DATES_ATTR)&&"UNDEFINED"!==o.get(a.USER_DEFINED_DATES_ATTR))&&(i+=1),e+=" ("+i+")"}return e},_updateGroupTitle:function(){this._titleElem.setText(this._getGroupTitle())},_drawConstraints:function(){this._fromConstraintView||this._setupConstraintViews(),this._fieldContainer.empty(!0),this._constraintType&&this._constraintType.render().inject(this._fieldContainer),this._constraintDate&&this._constraintDate.render().inject(this._fieldContainer),this._constraintsDateView&&this._constraintsDateView.render().inject(this._fieldContainer),this._toConstraintView&&this._toConstraintView.render().inject(this._fieldContainer),this._fromConstraintView&&this._fromConstraintView.render().inject(this._fieldContainer)},_listenToConstraints:function(){var e=this._updateGroupTitle.bind(this),t={"onChange:toConstraints":e,"onChange:fromConstraints":e};this.listenTo(this.model,t)},_onGroupLabelClicked:function(){if(this.toggleExpanded(),this.getExpanded()){var e=this;this._animationFrameForScroll=requestAnimationFrame((function(){e._parentView.dispatchScrollToElementEvent(e.container),delete e._animationFrameForScroll}))}},_setupGroupElements:function(){this._titleElem=e.createElement("div",{class:"form-section-title",html:this._getGroupTitle()}),this._fieldContainer=e.createElement("div",{class:"form-section-body"})},_setupConstraintViews:function(){var t=this,s=l.isModelProjectTask(t.model);l.isModelProjectTask(t.model)||this.createConstraintDateView();var o=t.model.get(a.COMMON_TASK_PARENT_ATTR),d=Boolean(o)||o&&"dsplan:DummyProject"!==o.id;if(l.isModelRDFTask(t.model)&&d||!l.isModelRDFTask(t.model)){var c=n.typeAheadCallback.bind(this,{modelId:t.model.id,getVisibleModels:t._getVisibleModels,getModelsToFilter:t._getModelsToFilter}),p=function(n){var s=e.merge(l.getConstraintFieldBasicConfig(t.model),n);return{i18n:r,isPropertyPanel:!0,model:t.model,config:e.merge(s,{typeAheadCallback:c})}},u=s?"successors":"fromConstraints",h=s?"predecessors":"toConstraints",m=s?"typeicon":"successorImage",T=s?"typeicon":"predecessorImage",E=s?"title":"successorTitle",g=s?"title":"predecessorTitle";this._fromConstraintView=new n(p({name:u,label:r.get("E6WCommonApps.Label.Successor"),searchTitle:r.get("E6WCommonApps.Label.Successor"),attributeToDisplay:E,imageAttribute:m,customTooltips:[{iconClass:"info",tooltipTitle:r.get("E6WCommonApps.Label.Successor"),tooltipBody:r.get("E6WCommonApps.Label.Tooltip.Successor")}],getObjectTooltip:n.getObjectTooltip})),this._toConstraintView=new n(p({name:h,label:r.get("E6WCommonApps.Label.Predecessor"),searchTitle:r.get("E6WCommonApps.Label.Predecessor"),attributeToDisplay:g,imageAttribute:T,customTooltips:[{iconClass:"info",tooltipTitle:r.get("E6WCommonApps.Label.Predecessor"),tooltipBody:r.get("E6WCommonApps.Label.Tooltip.Predecessor")}],getObjectTooltip:n.getObjectTooltip})),this.addChildView(this._fromConstraintView),this.addChildView(this._toConstraintView),!l.isModelRDFTask(t.model)&&t.model.get(a.CONSTRAINT_TYPE)&&(this._constraintType=i.createConstraintTypeView(t.model),this.addChildView(this._constraintType),this._constraintDate=i.createConstraintTypeDateView(t.model),this.addChildView(this._constraintDate))}this.listenTo(this._parentView,"onScroll",(()=>{this.dispatchEvent("onScroll")}))},createConstraintDateView:function(){var e=this;let t=l.isModelRDFTask(e.model),n="Milestone"===e.model.model.getObjectType()||"Gate"===e.model.model.getObjectType(),i={none:{start:"",end:"",type:"",label:r.get("E6WCommonApps.Label.None")},fixed:{start:n?a.SUGGESTED_DATE_ATTR:a.STARTDATE_ATTR,end:a.ENDDATE_ATTR,label:r.get("E6WCommonApps.Label.Fixed"),startFixedField:n?a.USER_DEFINED_DATES_ATTR:a.USER_DEFINED_START_DATE_ATTR,endFixedField:a.USER_DEFINED_END_DATE_ATTR,icon:{iconName:"pin",fontIconFamily:WUXManagedFontIcons.Font3DS}},noEarlier:{start:n?a.DATE_INTERVAL_MIN_ATTR:a.START_DATE_MIN_ATTR,end:a.END_DATE_MIN_ATTR,label:r.get("E6WCommonApps.Label.NoEarlierThan"),icon:{iconName:"move-to-start",fontIconFamily:WUXManagedFontIcons.Font3DS}},noLater:{start:n?a.DATE_INTERVAL_MAX_ATTR:a.START_DATE_MAX_ATTR,end:a.END_DATE_MAX_ATTR,label:r.get("E6WCommonApps.Label.NoLaterThan"),icon:{iconName:"move-to-end",fontIconFamily:WUXManagedFontIcons.Font3DS}}};this.model&&this.model.isStandaloneTask&&this.model.isStandaloneTask()&&(delete i.noEarlier,delete i.noLater);var o=e.model.isComplete(),d=r.get("E6WCommonApps.Label.Tooltip.StartDateConstraint");!i.noEarlier&&(d=r.replace(d,{CONSTRAINTS:""})),i.noEarlier&&(d=r.replace(d,{CONSTRAINTS:r.get("E6WCommonApps.Label.Tooltip.StartDateConstraintStandaloneTask")}));var c=r.get("E6WCommonApps.Label.Tooltip.EndDateConstraint");!i.noEarlier&&(c=r.replace(c,{CONSTRAINTS:""})),i.noEarlier&&(c=r.replace(c,{CONSTRAINTS:r.get("E6WCommonApps.Label.Tooltip.EndDateConstraintStandaloneTask")}));var p=[{iconClass:"info",tooltipTitle:r.get("E6WCommonApps.Label.StartDateConstraint"),tooltipBody:d},{iconClass:"info",tooltipTitle:r.get("E6WCommonApps.Label.EndDateConstraint"),tooltipBody:c}];this._constraintsDateView=new s({model:e.model,config:{name:"dateConstraints",readWrite:!e.model.get(a.RESTRICT_ASSIGNEE_ATTR),startDateLabel:t?r.get("E6WCommonApps.Label.StartDateConstraint"):r.get("E6WCommonApps.Label.SuggestedDateConstraint"),endDateLabel:t?r.get("E6WCommonApps.Label.EndDateConstraint"):"",isEndDateEnabled:t,canEditStartDate:t?!e.model.isStarted()&&!o:!o,canEditEndDate:!o,type:"startStop",constraintValues:i,customTooltips:t?p:[{iconClass:"info",tooltipTitle:r.get("E6WCommonApps.Label.SuggestedDateConstraint"),tooltipBody:r.get("E6WCommonApps.Label.Tooltip.SuggestedDateConstraint")}],showWeekNumbers:!0}}),this.addChildView(this._constraintsDateView)},enableRefreshView:()=>!1,destroy:function(){void 0!==this._animationFrameForScroll&&(cancelAnimationFrame(this._animationFrameForScroll),delete this._animationFrameForScroll),this._parent.apply(this,arguments)}});return l.isModelProjectTask=function(e){return e&&e.isProjectTask&&e.isProjectTask()},l.isModelRDFTask=function(e){return e&&e.model&&e.model.isRDFTask&&e.model.isRDFTask()},l.getConstraintFieldBasicConfig=function(e){let t=e.get(a.RESTRICT_ASSIGNEE_ATTR);return{type:"object",readWrite:!l.isModelProjectTask(e)&&!t,minLengthBeforeAutocomplete:0,validateSameTenant:!0,searchSourceTypes:{"3dplan":["dsplan:Task","dsplan:Milestone"],swym:["swym:WeDo"]},searchSource:["3dplan","swym"],linkCallback:o.launchProperties,noOpenWith:!0}},l})),define("DS/E6WCommonApps/Views/RDFTaskDetailsPanelConfig",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/FederatedSearchUtil","DS/RDFFoundation/Models/ComponentProxyModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/AgileProjectUtils","DS/E6WCommonApps/Views/LinkLauncherUtils","DS/E6WCommonApps/SmartSchedulerUtils","DS/E6WCommonApps/Views/DependencyGroupView","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/Views/FixedStartStopView","DS/E6WCommonApps/Views/TaskDurationEstimatedRangeStartStop","DS/E6WCommonUI/Views/PriorityView","DS/E6WCommonUI/MultiEdit/MultiPriorityView","DS/E6WCommonApps/MultiEdit/E6WMultiStartStopView","DS/E6WCommonApps/FileUploadRepositoryUtil","DS/E6WCommonApps/Models/NoAccessModel","DS/E6WCommonApps/Views/E6WObjectCardView","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/MultiEdit/MultiObjectCardView","DS/E6WCommonApps/Views/E6WCustomUomView","DS/E6WCommonApps/Preferences","DS/E6WCommonApps/Views/CommonPropertiesConfig","DS/E6WCommonApps/Views/ObjectIDPanelUtil","DS/E6WCommonApps/Utils/RapidUtils","DS/E6WCommonApps/Utils/ModalManager","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],(function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,E,g,A,C,_,f,D,S,R,y,v,M){"use strict";var I=function(e){return M.get(e)},b={};function O(e,t){let n=t.isStarted&&t.isStarted(),s=t.isEndDateFixed();return!e&&!(t.isStartDateFixed()&&s&&!n||s&&n)}return b.config=function(n,d){var p=n.isComplete(),E=n.isStarted(),C=n.get(i.COMMON_TASK_PARENT_ATTR),_=A.isWedoTask(n.get(i.JS_TYPE_ATTR)),f=(Boolean(C)||C&&C.id,D.getActiveBaselineModel()),M=y.hasSubtasks(n.model||n),O=n.get(i.RESTRICT_ASSIGNEE_ATTR),N=t.isStoryTask(n);var P=[{...S.getTitleFieldConfig(),readWrite:!O},R.getObjectIDFieldConfig(!1),{...S.getDescriptionFieldConfig(),readWrite:!O},b.parentFieldConfig(n,O),{readWrite:!O,name:i.PRIORITY_ATTR,label:I("E6WCommonApps.Label.Priority"),multiCustomView:h,customView:u},S.getMaturityStateFieldConfig(n,M)];if(N&&(P.push(e.extend(S.getWorkContextField(),{singleObjectOnly:!0,searchSource:o.getContextSearchSources(),searchSourceTypes:o.contextSearchSourceTypes,customAdd:function(e,n,a){var r=this,l=this.model.model.getParent().getParent(),d=n.dropObj&&n.dropObj.displayName||n.detailedObjects&&(n.detailedObjects[0].displayName||n.detailedObjects[0].label);let c=n.dropObj||n.detailedObjects&&n.detailedObjects[0];const p=t.getBatchGenerator();let u;const h={};var m;h.onComplete=function(t){t&&t[u.id]?v.getSuperModal(!0).confirm(I("E6WCommonApps.Warning.WorkContextAlreadyExists").replace("{object title}",A.escapeHTML(d)),I("E6WCommonApps.Command.WorkContextAlreadyExists"),(function(t){t&&r.model.add(i.WORK_CONTEXT_ATTR,e,n)})):r.model.add(i.WORK_CONTEXT_ATTR,e,n)},h.onFailure=function(){A.displayError(I("E6WCommonApps.Error.SaveFailed"))},a?(m=a)&&r.model&&r.model.model&&r.model.model.uploadFiles?r.model.model.uploadFiles(m,n.config.name,{config:n.config,cloneModel:r.model}):m&&r._addToModel(m):(u=s.getOrCreateProxy(c,p),o.isExistingWorkContext({projectId:l.id,contextIds:[u.id],...h}))},customTooltips:[{iconClass:"info",tooltipTitle:I("E6WCommonApps.Label.ContributesTo"),tooltipBody:I("E6WCommonApps.Label.Tooltip.ContributesToTask")}]})),n.get(i.WORK_CONTEXT_ATTR)&&P.push({readWrite:!O,name:i.STORY_POINTS,label:I("E6WCommonApps.Label.StoryPoints"),type:"number",minimumValue:"0",maximumFractionDigits:15,validate:!0,allowEmpty:!0,tooltipTitle:I("E6WCommonApps.Label.SetStoryPoints"),tooltipBody:I("E6WCommonApps.Label.StoryPointsTooltip")})),P.push({readWrite:!M,name:i.COMPLETE_PERCENT_ATTR,label:I("E6WCommonApps.Label.Percent"),type:"range",step:5,percents:!0,validate:!0},{readWrite:!O,name:E||p?i.ACTUAL_START_DATE:i.STARTDATE_ATTR,startDateLabel:I(E||p?"E6WCommonApps.Label.ActualStart":"E6WCommonApps.Label.PlannedStart"),canEditStartDate:function(e){return!M||M&&!e.isStarted()},canEditStartConstraint:!E&&!p,canEditEndConstraint:!p,endDateAttribute:p?i.ACTUAL_END_DATE:i.ENDDATE_ATTR,endDateLabel:I(p?"E6WCommonApps.Label.ActualEnd":"E6WCommonApps.Label.PlannedEnd"),isStartDateManualAttribute:i.USER_DEFINED_START_DATE_ATTR,isEndDateManualAttribute:i.USER_DEFINED_END_DATE_ATTR,canEditEndDate:function(e){return!M||M&&!e.isComplete()},type:"startStop",labelPosition:"top",startMinConstraint:!p&&i.START_DATE_MIN_ATTR,startMaxConstraint:!p&&i.START_DATE_MAX_ATTR,endMinConstraint:!p&&i.END_DATE_MIN_ATTR,endMaxConstraint:!p&&i.END_DATE_MAX_ATTR,customView:c,multiCustomView:m,validate:!0},b.durationFieldConfig(p,O,d,n),b.assigneeFieldConfig(n,O),b.candidateAssigneeFieldConfig(n,O),{readWrite:!0,name:i.REMINDER_DAYS,label:I("E6WCommonApps.Label.TaskReminder"),type:"number",minimumValue:"0",maximumValue:"999999999",validate:!0,integerOnly:!0}),P.push(b.attachmentFieldConfig,{readWrite:!0,name:i.ACTUAL_DELIVERABLE_ATTR,attributeToDisplay:"title",imageAttribute:"image",showRevisionDetails:!0,label:I("E6WCommonApps.Label.Deliverables"),searchTitle:I("E6WCommonApps.Label.SearchForDeliverables"),type:"object",customView:g,typeAheadCallback:t.typeAheadCallback,linkCallback:a.launchProperties,allowFileManagement:!0,allowUrlLink:!0,dropTypes:{"3dplan":["dsplan:url"]},placeHolder:I("E6WCommonApps.Label.ObjectPlaceHolder"),searchSource:S.deliverablesSources(),excludeSearchTypes:{"3dspace":["Person","Security Context","Business Role"],swym:["pno:Person","swym:WeDo"]},validateSameTenant:!0,limit:100,getDropDownMenuItems:r.getDocumentTypeDropDownMenuItems,validateDroppedObject:S.deliverableDropValidator},{...S.getOwnerFieldConfig(),readWrite:function(){let e=n&&n.canDelete&&n.canDelete(!0)||n.model&&n.model.canDelete(!0);return Boolean(!_&&(A.isModelOwnerTheLoggedInUser(n)||e))}(),searchTitle:I("E6WCommonApps.Label.ownerSearchTitle")},S.getCreationConfig(),S.getModifiedConfig(),T.getRepositoryFieldConfig(O),T.getBookmarkForRepositoryFieldConfig(O),{name:"dependencies",customView:l},S.getGoverningProcessObjectsFieldConfig(),S.getTagsFieldConfig()),_){var W=P.findIndex((e=>e.name===i.REMINDER_DAYS));P.splice(W,1)}const F=(n.model||n).getParentWorkscope()||(n.model||n)._nearestProjectParent;if(_||F&&!F.isXProject()&&!n.get(i.GOVERNING_PROCESS_MODEL_ATTR)&&!n.get(i.GOVERNING_PROCESS_INSTANCE_ATTR)){const e=P.findIndex((e=>e.name===i.GOVERNING_PROCESS));P.splice(e,1)}var k=P.findIndex((e=>e.name===i.COMPLETE_PERCENT_ATTR));if(E&&!p?(P.splice(k+1,1,{readWrite:!O,name:i.STARTDATE_ATTR,startDateLabel:I("E6WCommonApps.Label.PlannedStart"),canEditStartDate:!1,canEditStartConstraint:!E&&!p&&!M,canEditEndConstraint:!p&&!M,endDateAttribute:i.ENDDATE_ATTR,endDateLabel:I("E6WCommonApps.Label.PlannedEnd"),isStartDateManualAttribute:i.USER_DEFINED_START_DATE_ATTR,isEndDateManualAttribute:i.USER_DEFINED_END_DATE_ATTR,canEditEndDate:function(){return!M},type:"startStop",labelPosition:"top",startMinConstraint:i.START_DATE_MIN_ATTR,startMaxConstraint:i.START_DATE_MAX_ATTR,endMinConstraint:i.END_DATE_MIN_ATTR,endMaxConstraint:i.END_DATE_MAX_ATTR,customView:c,multiCustomView:m,validate:!0}),P.splice(k+2,0,{readWrite:!O,name:i.ACTUAL_START_DATE,startDateLabel:I("E6WCommonApps.Label.ActualStart"),canEditStartDate:function(){return!M},type:"startStop",labelPosition:"top",customView:c,doNotShowStop:!0,multiCustomView:m,disableMultiEdit:!0,validate:!0})):p&&P.splice(k+1,0,{readWrite:!1,name:i.STARTDATE_ATTR,customView:c,startDateLabel:I("E6WCommonApps.Label.PlannedStart"),endDateAttribute:i.ENDDATE_ATTR,startMinConstraint:i.START_DATE_MIN_ATTR,startMaxConstraint:i.START_DATE_MAX_ATTR,endMinConstraint:i.END_DATE_MIN_ATTR,endMaxConstraint:i.END_DATE_MAX_ATTR,isStartDateManualAttribute:i.USER_DEFINED_START_DATE_ATTR,isEndDateManualAttribute:i.USER_DEFINED_END_DATE_ATTR,endDateLabel:I("E6WCommonApps.Label.PlannedEnd"),type:"startStop",disableMultiEdit:!0,labelPosition:"top"}),_?P.splice(3,0,{name:i.PARENT_HAS_SWYM_COMMUNITY,label:I("E6WCommonApps.Label.Community"),imageAttribute:"image",type:"object",customView:g,attributeToDisplay:"title",linkCallback:a.launchProperties,validateSameTenant:!0}):n.isLeanTask()&&P.splice(3,0,{name:i.PARENT_HAS_LEAN_BOARD,label:I("E6WCommonApps.Label.LeanBoard"),imageAttribute:"image",type:"object",customView:g,attributeToDisplay:"title",linkCallback:a.launchProperties,validateSameTenant:!0}),f&&D.getShowBaselines()){var L=f.getDataForModel(n);if(L){var U=L.state===i.BASELINE_STATE_IN_PROGRESS,w=L.state===i.BASELINE_STATE_DONE,x=P.findIndex((e=>e.name===i.DURATION_ESTIMATED_RANGE||e.name===i.DURATION));P.splice(x+1,0,{readWrite:!1,name:U||w?i.BASELINE_ACTUAL_START_DATE:i.BASELINE_ESTIMATED_START_DATE,startDateLabel:I(U||w?"E6WCommonApps.Label.BaselineActualStart":"E6WCommonApps.Label.BaselinePlannedStart"),endDateAttribute:w?i.BASELINE_ACTUAL_END_DATE:i.BASELINE_ESTIMATED_END_DATE,endDateLabel:I(w?"E6WCommonApps.Label.BaselineActualEnd":"E6WCommonApps.Label.BaselinePlannedEnd"),type:"startStop",labelPosition:"top"})}}return P},b.options={onFailure:function(e,t,n){if(t&&(t.msg||t.message)){var s=t.msg.replace("Error: ","");-1!==t.msg.indexOf("{")&&(t=JSON.parse(t.msg.trim())),t.message&&(s=t.message);var i=s.split("|");if(i.length>1){if("xPlan.Error.invalidReparenting"===(s=i[0])){var o=A.i18n("E6WCommonUI.Alert.ReparentingFailed");A.displayError(o)}}else"E6WCommonApps.Error.notALeader"===s?e.isStandaloneTask()?A.displayError(I("E6WCommonApps.Error.parentProjectChangeRefusedStandaloneTask")):A.displayError(I("E6WCommonApps.Error.parentProjectChangeRefused")):"xPlan.Error.InvalidParentChildConstraint"===s?A.displayError(I("E6WCommonApps.Error.InvalidParentChildConstraint")):A.displayError(I(s))}else"E6WCommonApps.Error.NoWedoModifyAccess"===t?A.displayError(I(t)):n&&n.isMassEdit||A.displayError(I("E6WCommonApps.Error.SaveFailed"))}},b.assigneeFieldConfig=function(e,t){var n=S.assigneeFieldConfig(e,t);return A.isWedoTask(e.get(i.JS_TYPE_ATTR))&&delete n.readWrite,n},b.candidateAssigneeFieldConfig=function(t,s){return e.extend(b.assigneeFieldConfig(t,s),{name:i.CANDIDATE_ASSIGNEE_ATTR,label:I("E6WCommonApps.Label.CandidateAssignees"),searchSourceTypes:{swym:["pno:Person"],usersgroup:["foaf:Group"]},searchSource:n.filterSearchSources(["swym","usersgroup"]),dropTypes:{swym:[i.PERSON_TYPE],usersgroup:[i.USER_GROUP_TYPE],"3dspace":["Person","Group Proxy","Group"]},searchTitle:I("E6WCommonApps.Label.candidateAssigneeSearchTitle"),customButtons:[]})},b.durationFieldConfig=function(e,t,n,s){var o={readWrite:!1,name:i.DURATION_ESTIMATED_RANGE,startDateLabel:I("E6WCommonApps.Label.Duration"),type:"startStop",customView:p,labelPosition:"top"};const a=s.get("dsxplan:hasSubtask")||[];return!e&&(a.length>0||a.moreItems)?o:!e||n&&n.multiSelect?{readWrite:O(t,s),name:i.DURATION,fieldLabel:I("E6WCommonApps.Label.Duration"),type:"uom",customView:f,uomValues:[I("E6WCommonApps.Label.Days"),I("E6WCommonApps.Label.Hours")],minimumValue:"0",maximumValue:"3652",toleranceName:i.DURATION_RANGE,toleranceLabel:I("E6WCommonApps.Label.PlusMinusOffset"),conversionTable:[1,8],validate:!0,customTooltips:[{iconClass:"info",tooltipTitle:I("E6WCommonApps.Label.Duration"),tooltipBody:I("E6WCommonApps.Label.Tooltip.Duration")}]}:(o.endDateAttribute=i.DURATION_ACTUAL,o.endDateLabel=I("E6WCommonApps.Label.ActualDuration"),o)},b.parentFieldConfig=function(e,n){return{readWrite:!(e.get(i.COMMON_TASK_PARENT_ATTR)instanceof E)&&!n&&C.isXPPAuthorized(),name:i.COMMON_TASK_PARENT_ATTR,attributeToDisplay:"title",imageAttribute:"image",singleObjectOnly:!0,label:I("E6WCommonApps.Label.Parent"),typeAheadCallback:t.typeAheadCallback,minLengthBeforeAutocomplete:2,type:"object",disableRemove:!0,customView:g,searchSourceTypes:{"3dplan":["dsplan:Project","dsplan:Task","dsplan:xProject"]},searchSource:["3dplan"],searchTitle:I("E6WCommonApps.Label.Parent"),placeHolder:I("E6WCommonApps.Label.ObjectPlaceHolder"),dropHandler:d.processDropData,linkCallback:a.launchProperties,validateSameTenant:!0}},Object.defineProperty(b,"attachmentFieldConfig",{get:function(){return e.merge(S.getCommonAttachmentFieldConfig(),{showRevisionDetails:!0,searchSourceTypes:{"3dplan":["dsplan:Project","dsplan:Task","dsplan:Milestone","dsplan:xProject","dsplan:AgileProject"]},limit:100})}}),b}));