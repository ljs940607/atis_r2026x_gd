define("DS/DELPPWProcessModelBehaviors/CapableResourceLinkBehaviour",["UWA/Core"],(function(e){"use strict";return{plugins:["DatabasePlugin","DicoPlugin","ResourcePlugin"],creator:function(t,n,i,o,r){const a="CapableResourcesStructureLink",s="DELAsmProcessCanUseCnx",c="SecondaryCandidateResourceLink",l="DELAssetsStructureLink",u="AllocatedResourceLink";var d,g,f,m,I;return m=function(t,i,o,r){o=o||{},n.info(i,r),n.notify("stopProgress",t),e.is(o.onComplete,"function")&&o.onComplete.call(null,i)},I=function(t,i,o,r,a){r=r||{},e.is(o,"string")&&(i+="\n"+o),n.warn(i,a),n.debug(i),n.notify("stopProgress",t),e.is(r.onFailure,"function")&&r.onFailure.call(null,i)},d=function(t){var n=t.get("PID"),o=t.get("type"),r=t.get("DELAsmProcessCanUseCnx.V_IsPreferred"),a=t.get("from"),c=t.get("to"),l=t.get("DELLmiEstimatedTime.V_EstimatedTime"),u=t.get("DELAsmProcessCanUseCnx.V_CapableRscGroupIndex"),d=i.getReference(a),g=i.getReference(c),f=e.is(d)?d.get("type"):null,m=e.is(g)?g.get("type"):null,I=e.is(d)?d.get("PLMEntity.V_Name"):null,p=e.is(g)?g.get("PLMEntity.V_Name"):null,L=e.is(t.get("ResourceUsage"))?t.get("ResourceUsage"):null,P=e.is(L)?i.getInstance(L):null,S=e.is(P)?P.get("PLMInstance.PLM_ExternalID"):"";return{connPID:n,isPreferred:o===s?r:"",fromPID:a,toPID:c,estimatedTime:l,capableRscGroupIndex:u,fromType:f,toType:m,fromName:I,toName:p,resourceUsage:S,resourceUsagePID:L}},g=function(e){var t=[];return i.getImpacted(e,!1,{relationTypes:[s]}).forEach((function(e){t.push(d(e))})),t},f=function(t,n,o){var r,a,s,c,l,u,d,g,f=!1;return r=e.is(o)?i.getInstance(o):null,a=e.is(r)?r.get("isAggregatedBy"):null,s=i.getReference(t),c=e.is(a)?i.getReference(a):null,l=i.getReference(n),u=s.get("PPRTYPE"),d=e.is(c)?c.get("PPRTYPE"):null,g=l.get("PPRTYPE"),"OPERATION"===u&&"SYSTEM"===d&&"RESOURCE"===g&&(f=!0),f},{listenTo:function(){return{updateImpactedInfoOnModel:this.onUpdateImpactedInfoOnModel,instanceRemoved:this.onRemoveInstance}},onStart:function(){},onStop:function(){},checkType:function(e,t){return i.getReference(e).get("PPRTYPE")===t},onRemoveInstance:function(t){(t=Array.isArray(t)?t:[t]).forEach((function(t){let n=i.getReferenceModelFromInstance(t),o=n.get("PPRTYPE"),r=n.get("PID");if("RESOURCE"===o){i.getImpacted(r,!1,{relationTypes:[s,c]}).forEach((function(t){let n=t.get("ResourceUsage");e.is(n)&&t.unset("ResourceUsage")}))}}))},checkParentType:function(e,t){var n=i.getInstance(e).get("isAggregatedBy");return i.getReference(n).get("PPRTYPE")===t},onUpdateImpactedInfoOnModel:function(t){var o,r=t||{};e.is(r.PrimaryRscLinksInfo)&&(o=r.PrimaryRscLinksInfo,Object.keys(o).forEach((function(e){let t=i.getConnection(e);Object.keys(o[e]).forEach((function(n){t.set(n,o[e][n],{silent:!0})}))})),n.notify("updateImpactedInfoMCRUI",r))},getCapableRscStructureLinkOfAncestor:function(e){var t,n,o=[],r={relationTypes:[a]};for(t=e.length-2;t>=0&&1!==(o=i.getImpacted(e[t],!1,r)).length;t--);return e.length>0&&1!==o.length&&(n=i.getInstance(e[0]).get("isAggregatedBy"),o=i.getImpacted(n,!1,r)),1===o.length?o[0]:null},getPathTillUpperAssetStructure:function(t){var n,o,r,a=[],s=!1,c={relationTypes:[l]};for(n=t.length-1;n>=0;n--)if(o=i.getInstance(t[n]),e.is(o)&&(r=o.get("isAggregatedBy"),i.getImpacted(r,!1,c).length>0)){s=!0,a=t.slice(n);break}return s||(a=t),a},canCreatePrimaryCapableRscLink:function(t){var n,a,c,l,u,d,g,m,I,p,L,P=s,S=!0,E={};return n=t.fromSideRefPID,a=t.toSideRefPID,c=t.fromSideInstPID,l=t.toSideInstPID,u=t.fromSideAbsPath,d=t.toSideRootRefPID,I=i.getReferenceModel(n),o.isAKindOf(I,"DELLmiHeaderWorkPlanReference")||o.isAKindOf(I,"DELLmiServiceHeaderWorkPlanReference")?(S=!1,L=r.getNLSValue("CapableResourceLinkBehaviour.canCreatePrimaryCapableRscLinkError.ProcessIsHeaderWP")):i.hasConnection({from:n,to:a,type:s})&&(S=!1,L=r.getNLSValue("CapableResourceLinkBehaviour.canCreatePrimaryCapableRscLinkError.LinkAlreadyExists")),E={canCreateLink:S},S?(E.data=e.merge({type:P,displayText:r.getNLSValue(P,null,"CreateLink"),buttonIdentifier:r.getNLSValue(P,null,"CreateLink")},e.clone(t)),f(n,a,c)&&(g=this.getCapableRscStructureLinkOfAncestor(u),p={resourceAreaID:m=e.is(g)?g.get("to"):null,rscInstPID:e.is(m)&&m===d?l:null,operationRIRPath:e.is(m)?i.transformToRIROccurrencePath(u).toString():null},e.is(E.data.connectionParams)?E.data.connectionParams=e.merge(E.data.connectionParams,p):E.data.connectionParams=p)):E.errorMessage=L,E},canCreateSecondaryCapableRscLink:function(t){var n,o,a,s,l,u,m,I,p=c,L=[],P={};return P={canCreateLink:!1,data:[]},n=t.fromSideRefPID,o=t.toSideRefPID,a=t.fromSideInstPID,s=t.fromSideAbsPath,m=f(n,o,a),l=this.getCapableRscStructureLinkOfAncestor(s),u=e.is(l)?l.get("to"):null,e.is(t.connectionParams)&&e.is(t.connectionParams.primaryResourceLinkPID)?(I=i.getConnection(t.connectionParams.primaryResourceLinkPID),L.push(d(I))):L=g(n),L.forEach((function(n){var a,c;o!==n.toPID&&(c={primaryResourceLinkPID:n.connPID},m&&(c=e.merge(c,{resourceAreaID:u,operationRIRPath:e.is(u)?i.transformToRIROccurrencePath(s).toString():null})),a=e.merge({type:p,displayText:r.getNLSValue(p,{primaryResource:i.getDisplayName(i.getReference(n.toPID))},"CreateLink"),connectionParams:c,buttonIdentifier:n.connPID},e.clone(t)),P.data.push(a),P.canCreateLink||(P.canCreateLink=!0))})),P},canCreateCapableResourcesStructureLink:function(e){var t,n,s=!0;return n=i.getReferenceModel(e),["DELLmiWorkPlanSystemReference","DELLmiQtyControlProcessReference","DELLmiServiceWorkPlanSystemReference","DELLmiGeneralSystemReference","DELLmiHeaderWorkPlanReference","DELLmiServiceWorkPlanOperationalReference","DELLmiServiceWorkPlanRectifyingReference","DELLmiServiceWorkPlanSupportingTaskReference"].some((e=>o.isAKindOf(n,e)))&&i.getImpacted(e,!0,{relationTypes:[a]}).length>0&&(s=!1,t=r.getNLSValue("CreateLink.CapableResourcesStructureLink.Failure",{linkType:r.getNLSValue("CapableResourcesStructureLink"),target:n.get("PLMEntity.V_Name")})),s&&o.isAKindOf(n,"DELLmiGeneralSystemReference")&&i.getImpacted(e,!0,{relationTypes:["HistorizationLinkRefRef"]}).length>0&&(s=!1,t=r.getNLSValue("CreateLink.CapableResourcesStructureLink.HasOriginateLink",{linkType:r.getNLSValue("CapableResourcesStructureLink"),target:n.get("PLMEntity.V_Name")})),{canCreateLink:s,errorMessage:t}},canCreatePreassignedWorkcenterLink:function(t){var n,a,s,c,l,d=u,g=!0,f={};if(e.is(t.fromSideAbsPath)&&e.is(t.toSideRefPID))if(n=t.toSideRefPID,c=t.fromSideAbsPath,s=t.fromSideAbsPath[t.fromSideAbsPath.length-1],a=i.getInstance(s),l=i.getReferenceModel(n),o.isAKindOf(a,"DELLmiHeaderOperationInstance")&&o.isAKindOf(l,"WorkCenter")){g=!i.findConnections({to:n,type:u}).some((t=>e.equals(t.get("from"),c)))}else g=!1;else g=!1;return f={canCreateLink:g},g?f.data=e.merge({type:d,displayText:r.getNLSValue(d,null,"CreateLink"),buttonIdentifier:r.getNLSValue(d,null,"CreateLink"),linkExistsInfoMessage:undefined},e.clone(t)):f.errorMessage=undefined,f},canCreateAssetsStructureLink:function(t){var n,a,s,c,u,d,g=l,f=!0,m={};return n=t.fromSideRefPID,a=t.toSideRefPID,s=i.getReferenceModel(n),c=i.getReferenceModel(a),["DELLmiHeaderWorkPlanReference","DELLmiServiceHeaderWorkPlanReference","DELLmiWorkPlanSystemReference","DELLmiServiceWorkPlanSystemReference","DELLmiServiceWorkPlanOperationalReference","DELLmiServiceWorkPlanRectifyingReference","DELLmiServiceWorkPlanSupportingTaskReference"].some((e=>o.isAKindOf(s,e)))&&o.isAKindOf(c,"Organizational")&&!o.isAKindOf(c,"WorkCenter")?i.hasConnection({from:n,to:a,type:l})?(f=!1,u=r.getNLSValue("CapableResourceLinkBehaviour.canCreateAssetsStructureLink.LinkAlreadyExists")):i.hasConnection({from:n,type:l})?(f=!0,d=r.getNLSValue(g,null,"CreateLink")+" "+r.getNLSValue("AuthorLinks.LinkExistsReplace")):f=!0:f=!1,m={canCreateLink:f},f?m.data=e.merge({type:g,displayText:r.getNLSValue(g,null,"CreateLink"),buttonIdentifier:r.getNLSValue(g,null,"CreateLink"),linkExistsInfoMessage:d},e.clone(t)):m.errorMessage=u,m},createConnection:function(t,o,a,d){var g,f,m,I,p,L,P,S;switch(o=o||{},m=(t=t||{}).fromSideRefPID,I=t.toSideRefPID,p=t.type,L={linkType:p,target:m,source:I},P=function(t,o){var r;e.is(o.instancesAndReferences,"array")&&o.instancesAndReferences.forEach((function(t){var n,o=t.attributesValue;o.hasOwnProperty("isInstanceOf")&&(n=i.getInstance(o.PID),e.is(n)||i.addInstance(t))})),t.get("type")!==s&&t.get("type")!==c||(r={linkPID:t.get("PID")},n.notify("updateResourceUsage",r)),e.is(o.deletedConnections,"array")&&o.deletedConnections.length>0&&o.deletedConnections.forEach((function(e){i.removeConnection(e)})),e.is(a,"function")&&a(L)},S=function(){e.is(d,"function")&&d(L)},t.type){case s:f=this.canCreatePrimaryCapableRscLink(t);break;case c:f=this.canCreateSecondaryCapableRscLink(t),Array.isArray(f.data)&&f.data.length>=1&&(f.data=f.data[0]);break;case l:f=this.canCreateAssetsStructureLink(t);break;case u:f=this.canCreatePreassignedWorkcenterLink(t),m=this.getPathTillUpperAssetStructure(t.fromSideAbsPath).toString();break;default:f={canCreateLink:!1,errorMessage:r.getNLSValue("CapableResourceLinkBehaviour.createConnectionError.InvalidInputs")}}f.canCreateLink?(o=o||{},g={onFailure:S,onTimeout:S,onCancel:S,onComplete:P},i.createConnection({IDFrom:m,IDTo:I,type:p,connectionParams:f.data.connectionParams},e.merge(g,o))):(L.errorMessage=f.errorMessage,S())},createCapableResourceStructureLink:function(t,o){var s,c,l,u={},d=function(e,t,n){return r.getNLSValue(e,{linkType:r.getNLSValue("CapableResourcesStructureLink"),target:t,source:n})};o=o||{},c={onFailure:function(){var e=i.getReferenceModel(t),n=i.getDisplayName(e);I(u,d("CreateLink.CapableResourcesStructureLink.Failure",n,null),null,o,l)},onComplete:function(e){var t=i.getReferenceModel(e.get("from")),n=i.getReferenceModel(e.get("to")),r=i.getDisplayName(t),a=i.getDisplayName(n);m(u,d("CreateLink.CapableResourcesStructureLink.Success",r,a),o,l)}},s={type:a,IDFrom:t};let g=this.canCreateCapableResourcesStructureLink(t);g.canCreateLink?(n.notify("startProgress",u),l=n.log(r.getNLSValue("CreateLink.LogMessage")),i.createConnection(s,e.merge(c,o))):e.is(g.errorMessage)&&n.warn(g.errorMessage)},packConnInfo:function(e){return d(e)},getPrimaryResourceLinksInfo:function(e){return g(e)},getImpactedObjects:function(t,n,o,r,d){var g=[],f=d||{},m=!e.is(f.isComputeIndirectConnectedObject)||f.isComputeIndirectConnectedObject;return e.is(r)&&(r=Array.isArray(r)?r:[r]).forEach((function(o){var r,d,f,I,p=o.get("type"),L=o.get("PID"),P=o.get("from"),S=o.get("to");switch(p){case a:case l:I=P===t?S:P,g.push(I);break;case u:I=P===n?S:P,g.push(I);break;case s:d=S,I=(r=P)===t?d:r,g.push(I),m&&i.getImpacted(L,!1,{relationTypes:[c]}).forEach((function(e){var t=e.get("to");g.push(t)}));break;case c:f=i.getConnection(P),e.is(f)&&(r=f.get("from"),g.push(r),m&&(d=f.get("to"),g.push(d)));break;default:console.log("Invalid Type")}})),g},getConnectedObjects:function(t,o,r,d,g){var f=[],m=g||{},I=!e.is(m.isComputeIndirectConnectedObject)||m.isComputeIndirectConnectedObject;return e.is(d)&&(d=Array.isArray(d)?d:[d]).forEach((function(r){var d,g,m,p,L,P=r.get("type"),S=r.get("PID"),E=r.get("from"),O=r.get("to");switch(P){case a:case l:L=E===t?O:E,f.push({ctxPath:[],objectPID:L});break;case u:d=Array.isArray(E)?E[E.length-1]:E,L=o===d?O:d,f.push({ctxPath:[],objectPID:L});break;case s:d=E,g=O,m=r.get("ResourceUsage"),L=d===t?e.is(m)?m:g:d,f.push({ctxPath:[],objectPID:L}),I&&i.getImpacted(S,!1,{relationTypes:[c]}).forEach((function(t){var n=t.get("to"),i=t.get("ResourceUsage");L=e.is(i)?i:n,f.push({ctxPath:[],objectPID:L})}));break;case c:p=i.getConnection(E),e.is(p)&&(d=p.get("from"),f.push({ctxPath:[],objectPID:d}),I&&(g=p.get("to"),m=p.get("ResourceUsage"),L=e.is(m)?m:g,f.push({ctxPath:[],objectPID:L})));break;default:n.debug("Invalid Type")}})),f},getIsPreferred:function(e){return e.get("DELAsmProcessCanUseCnx.V_IsPreferred")}}}}})),define("DS/DELPPWProcessModelBehaviors/OperationTimeBehavior",["UWA/Core"],(function(e){"use strict";return{plugins:["TreeViewPlugin","DicoPlugin","DatabasePlugin","ResourcePlugin","AttributePlugin","WebServicePlugin"],creator:function(t,n,i,o,r,a,s,c){var l,u,d,g,f,m,I,p,L,P,S,E,O,R,T,h,C,N,A=null,D="DELLmiOperationReference.V_TimeMode",y="DELLmiOperationReference.V_EstimatedTime",v="DELLmiEstimatedTime.V_EstimatedTime",V="DELLmiOperationReference.V_MeasuredTime",k=["DELLmiHeaderOperationReference.V_UseGanttTimeSolver","DELLmiGeneralOperationReference.V_UseGanttTimeSolver"],M="V_OperationTime",b="FetchInProgress",F={};return l=function(){var e,t={},n={},i="DELLmiOperationReference."+M;e={Name:"V_OperationTime",NLS:a.getNLSValue("Attribute."+i),Type:"Double",Protection:3,MultiValuated:"No",HasRangeDefined:"No",DefaultValue:"",MaxLength:256,Magnitude:"TIME",ManipulationUnit:"",MultiLine:"No",UIAccess:"",HasDefault:"No"},n[i]=e.NLS,t[i]=e,a.addNlsJSON(n),s.addAttributeInfo(t)},d=function(t){var n=null,i=r.getReference(t);if(e.is(i)){let e=i.get(D);if(null!==e){let t=o.getAttributeInfo(D);n=s.getAuthorizedValue(t,null,e)}}return n},u=function(t){var o,r;return e.is(A)||(e.is(t)&&t.dataIndex===M?A=t.visibleFlag:(o=i.getViewColumnPreferences(n.getId()),r=e.is(o)?o.Columns.Column:[],A=r.some((function(e){return e.dataIndex===M&&!e.isHidden})))),A},g=function(t,n,i){return c.webServiceRequest({url:"dsmfg/private/V0/invoke/MfgProcess/fetchOperationTime",method:"POST",headers:c.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),data:e.Json.encode({rirPaths:t}),context:this,onFailure:i,onTimeout:i,onCancel:i,onComplete:function(t){var i,o={};if(e.is(t))for(i in t)Object.hasOwnProperty.call(t,i)&&(F[i]=t[i],o[i]={},o[i][M]=F[i]);n(o)}})},f=function(e){var t=n.getBehavior("WUXNodeModelBehavior"),i=[],o={};u()&&(e instanceof Set&&(e=Array.from(e)),(e=Array.isArray(e)?e:[e]).length>0&&(e.forEach((function(e){var n=t.getNodeModel(e);null!==n&&n.forEach((function(e){var t=e.getRIRpath().toString();i.push(t),o[t]={},o[t][M]=b}))})),n.notify("updateNodes",o),g(i,(function(e){n.notify("updateNodes",e)}),(function(){n.notify("unsetNodeAttr",[i,M])}))))},m=function(t){var i=[],o={};return u()&&Array.isArray(t)&&(t.forEach((function(t){var n=r.getReference(t[t.length-1]);r.isOperation(n)&&(t=t.toString(),o[t]={},e.is(F[t])?o[t][M]=F[t]:(i.push(t),o[t][M]=b))})),i.length>0&&g(i,(function(e){n.notify("updateNodes",e)}),(function(){n.notify("unsetNodeAttr",[i,M])}))),o},I=function t(n,i,o){var a=[];(e.is(i)?[i]:r.getParentInstancesFromCollection(n)).forEach((function(n){var i=r.getAggregatingReferenceModelFromInstance(n),s=i.get("PID");if(-1===a.indexOf(s)){if(r.isOperation(i)){let n=T(i.keys());e.is(n)&&"TRUE"===i.get(n)&&(t(s,null,o),o.add(s))}a.push(s)}}))},p=function e(t,n){r.getInstancesFromCollection(t).forEach((function(t){var i=t.get("isInstanceOf");"3"===d(i)&&n.add(i),e(i,n)}))},L=function(t){var n=new Set;u()&&((t=e.is(t,"array")?t:[t]).forEach((function(e){var t,i=e.get("PID");r.isOperation(e)&&(t=e.changedAttributes(),(Object.hasOwnProperty.call(t,D)||Object.hasOwnProperty.call(t,y)||Object.hasOwnProperty.call(t,V)||h(Object.keys(t)))&&(I(i,null,n),n.add(i)))})),f(n))},P=function(t){var n=new Set;u()&&((t=e.is(t,"array")?t:[t]).forEach((function(e){var t=e.changedAttributes(),i=e.get("type");if("DELAsmProcessCanUseCnx"===i){let i=e.get("from");(Object.hasOwnProperty.call(t,v)||Object.hasOwnProperty.call(t,"DELAsmProcessCanUseCnx.V_IsPreferred"))&&(I(i,null,n),n.add(i),p(i,n))}if("PrimaryResourceLinkDetail"===i){let i=e.get("from"),o=Array.isArray(i)?i[i.length-1]:i;Object.hasOwnProperty.call(t,v)&&"3"===d(o)&&(I(o,null,n),n.add(o))}})),f(n))},E=function(t){var n=new Set;u()&&((t=e.is(t,"array")?t:[t]).forEach((function(e){if("DELAsmProcessCanUseCnx"===e.get("type")){let t=e.get("from");I(t,null,n),n.add(t),p(t,n)}})),f(n))},S=function(t){var n=new Set;u()&&((t=e.is(t,"array")?t:[t]).forEach((function(e){I(null,e,n)})),f(n))},O=function(t){var n,i;if(u()&&e.is(t)&&(n=t.newParentPID,i=r.getReference(n),r.isOperation(i))){let t=T(i.keys());e.is(t)&&"TRUE"===i.get(t)&&f(n)}},R=function(t){var i,o,a,s=n.getBehavior("WUXNodeModelBehavior"),c=e.is(A)?A:null;A=null,c!==(i=u(t))&&(i?e.is(s)&&(o=(o=s.getVisibleNodesInViewport().map((e=>e.getReferencePID()))).filter((e=>r.isOperation(e))),f(o)):(a=[],r.getAllReferences().forEach((function(e){if(r.isOperation(e)){let t=s.getNodeModel(e.get("PID"));null!==t&&t.forEach((function(e){var t=e.getRIRpath().toString();F.hasOwnProperty(t)&&a.push(t)}))}})),a.length>0&&n.notify("unsetNodeAttr",[a,M]),C()))},T=function(e){var t;if(Array.isArray(e)&&Array.isArray(k))for(let n=0;n<k.length;n++)if(-1!==e.indexOf(k[n])){t=k[n];break}return t},h=function(t){var n=!1,i=T(t);return e.is(i)&&(n=!0),n},C=function(){u()&&(F={})},N=function(){var e=n.getBehavior("WUXNodeModelBehavior").getSelectedNodes();u()&&e.forEach((function(e){let t=e.getRIRpath().toString();if(F.hasOwnProperty(t)){delete F[t],Object.keys(F).forEach((function(e){e.startsWith(t)&&delete F[e]}))}}))},{listenTo:function(){return{referenceChanged:L,connectionChanged:P,instanceAdded:S,instanceRemoved:S,connectionRemoved:E,reparent:O,TreeViewColumnVisibleStateChange:R,refreshOperationTime:f,refreshAll:C,RefreshCmd:N}},onStart:function(){var e;e={boAttrName:[D,y,V],roAttrName:[],otherAttrName:[]},k.forEach((function(t){e.boAttrName.push(t)})),l(),r.setSelectPredicate(n.getId(),e)},onStop:function(){},isColumnVisible:function(){return u()},getUpdateOptionsForVisibleNodes:function(e){return m(e)}}}}})),define("DS/DELPPWProcessModelBehaviors/MfgProcessBehavior",["UWA/Core"],(function(e){"use strict";return{plugins:["MfgProcessPlugin","ResourcePlugin","BIPlugin","DatabasePlugin","ProcessImplementPlugin","DicoPlugin"],creator:function(t,n,i,o,r,a,s,c){var l,u;t.getLogger();return l=function(t){var n,i,o,r=[];return Array.isArray(t)?(n=t[t.length-1],i=a.getReferenceModel(n),0===(r=s.getScopeLinks(i.get("PID"))).length&&(o=s.findInstanceWhoseParentIsScoped(t),e.is(o,"object")&&(r=o.scopeLinks))):r=s.getScopeLinks(t),r},u=function(e){var t=[];return e.forEach((function(e){var n=e.get("to");t.push(n)})),t},{webservice:function(t,s,c,l){var u,d,g,f,m={noTimeout:!0},I=!1,p={silentMode:!0,updateItem:!0};n.notify("startProgress",m),e.is(c)&&e.is(c.logMessage)&&(d=n.log(c.logMessage)),(s=s||{}).product&&(s.product.referencePID,s.product.OccPath),s.mfgItem&&(s.mfgItem.referencePID,s.mfgItem.instancePID),f=function(t){var i,o,r=[];t.instancesAndReferences.forEach((function(t){i=t.attributesValue,!!e.is(i.isInstanceOf)&&(o=a.getInstance(i.PID),n.notify("instanceAdded",[o,p]))})),t.connections.forEach((function(e){r.push(a.getConnection(e.PID))})),r.length>0&&n.notify("connectionAdded",[r])},"rerouteLink"===t&&(u="POST",g=e.Json.encode(c),(c=e.merge(c,{appenedURL:"ExecuteSuggestedActions"})).onComplete=function(t,i,o){f(o),e.is(l)&&l(o),I&&n.notify("toggleCmdCheckHeaderState",{cmdName:"BIEssentialsCmd",cmdState:!0}),n.notify("stopProgress",m)}),c.onFailure=function(t){var i=c.logMessage+" "+o.getNLSValue("failed");e.is(t)&&(i=i+". "+t.message),n.warn(i,d),n.notify("stopProgress",m),e.is(l)&&l(),I&&n.notify("toggleCmdCheckHeaderState",{cmdName:"BIEssentialsCmd",cmdState:!0})},(I=r.getBICmdState())&&n.notify("toggleCmdCheckHeaderState",{cmdName:"BIEssentialsCmd",cmdState:!1}),i.webserviceAndProcessing(u,g,c)},isInstPossible:function(t){var n,i,o,r,a,d,g=t.parent,f=t.child,m=e.is(t.targetAbsPath)?t.targetAbsPath:null,I=!0;return e.is(m)&&c.isAKindOf(f,"DELLmiHeaderOperationReference")&&(n=Array.isArray(m)&&m.length>0?m:g.get("PID"),i=f.get("PID"),r=s.getPartialScopeLinks(i),Array.isArray(r)&&r.length>0&&(I=!1,o=l(n),r.length===o.length&&(a=u(o),d=u(r),I=a.every((function(e){return d.indexOf(e)>=0}))))),I},getBrokenMfgProcessStatus:function(e,t){r.getBrokenMfgProcessStatus(e,t)},generateIndustryRecipeFromFBOM:function(t){const r=o.getNLSValue("GenerateRecipeFromFBOM.Start"),a=o.getNLSValue("GenerateRecipeFromFBOM.Success"),s=o.getNLSValue("GenerateRecipeFromFBOM.Failure"),c=n.log(r);var l={noTimeout:!0},u={pid:t.PID},d={url:"dsmfg/private/V0/invoke/MfgProcess/Recipe/FBOMBasedCreate",onComplete:function(){n.notify("stopProgress",l),n.info(a,c)},onFailure:function(e){n.notify("stopProgress",l),n.warn(s,c)}};n.notify("startProgress",l),u=e.Json.encode(u),i.webserviceAndProcessing("POST",u,d)}}}}})),define("DS/DELPPWProcessModelBehaviors/ProductFlowLinkBehavior",["UWA/Core"],(function(e){"use strict";return{plugins:["DatabasePlugin","DicoPlugin","WebServicePlugin","ResourcePlugin","AttributePlugin","UXComponentsPlugin"],creator:function(t,n,i,o,r,a,s,c){const l=Object.freeze({GOOD:"",QUANTITYDISTRIBUTION:"DELLmiTimeConstraintQuantityDistribution",ALTERNATIVE:"DELLmiTimeConstraintAlternative",FAILED:"DELLmiTimeConstraintFailed",SCRAPPED:"DELLmiTimeConstraintScrapped"});var u,d,g,f,m,I,p,L,P,S,E,O,R,T,h,C,N,A,D,y="V_X2DPos",v="V_Y2DPos",V="DELLmiTimeConstraintCategoryAbstractCusto.flowType",k="DELLmiTimeConstraintCnx.V_MaterialNeed",M="DELLmiHeaderOperationInstance.V_DistributionRule",b="DELLmiTimeConstraintCnx.V_DependencyType",F="DELArrowDisplayExt.V_ArrowStartPosition",_="DELArrowDisplayExt.V_ArrowEndPosition",B=["DELLmiTimeConstraintCnx","DELLmiMaterialPathCnxCust","LinearProductFlowCnx"],U={DELLmiTimeConstraintQuantityDistribution:"QuantityDistribution",DELLmiTimeConstraintAlternative:"Alternative",DELLmiTimeConstraintFailed:"Failed",DELLmiTimeConstraintScrapped:"Scrapped"},x=!1,w=[V,"DELLmiTimeConstraintAlternative.V_ExecutionReturnCode","DELLmiTimeConstraintFailed.V_ExecutionReturnCode","DELLmiTimeConstraintScrapped.V_ExecutionReturnCode","DELLmiTimeConstraintCategoryAbstract.V_ExecutionReturnCode","DELLmiTCOverlapQtyCusto.isOverlapExist","DELLmiTCOverlapQtyCusto.overlapMagnitude"],G=c.getComponent("Button"),Y=null;return T=function(e){var t,n,i=e.get(V);return"NULL"!==i&&(t=o.getAttributeInfo(V),(n=s.getAuthorizedValueIndex(t,null,i))&&(i=s.getAuthorizedValueDB(t,n))),i},P=function(t,n){var o=[],r=function(n){var a,s,c,l,u=n[n.length-1],d=i.getImpacted(u,!1,{relationTypes:B});for(m=!1,I=!1,c=0;c<d.length&&(a=d[c],l=T(a),!0!==m);c++)if("DELLmiTimeConstraintFailed"===l&&(m=!1),e.equals(a.get("from"),n)){if(e.equals(a.get("to"),t)){m=!0,"Good"===l&&(I=!0);break}if(s=a.get("to"),o.includes(s))break;o.push(s),r(s)}};r(n)},L=function(t,n){var o;return P(t,n),o=t[t.length-1],!!i.getImpacted(o,!1,{relationTypes:B}).some((function(i){return e.equals(i.get("from"),t)&&e.equals(i.get("to"),n)}))},p=function(t,n){var o,r,a,s,c,l,u={},d={},g=!1;if(e.is(t,"array")&&e.is(n,"array")){for(o=t.length-1;o>=0;o--){for(a=t[o],r=i.getInstance(a).get("isAggregatedBy"),s=n.length-1;s>=0;s--)if(c=n[s],e.is(d[c])?l=d[c]:(l=i.getInstance(c).get("isAggregatedBy"),d[c]=l),r===l&&a!==c){g=!0;break}if(g)break}u.fromPath=t.slice(o),u.toPath=n.slice(s)}return u},S=function(t,n){var i,r={Name:n,Type:"String",Protection:2,MultiValuated:"No",HasRangeDefined:"No",DefaultValue:"",MaxLength:256,Magnitude:"",ManipulationUnit:"",MultiLine:"No",UIAccess:"",HasDefault:"Yes"};switch(n){case"flowType":(i=e.clone(r)).NLS=a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory"),i.AuthorizedValues=[{Name:"",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Good")},{Name:"DELLmiTimeConstraintQuantityDistribution",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.QuantityDistribution")},{Name:"DELLmiTimeConstraintFailed",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Failed")},{Name:"DELLmiTimeConstraintAlternative",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Alternative")},{Name:"DELLmiTimeConstraintScrapped",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Scrapped")}],i.HasRangeDefined="Yes",i.DefaultValue=a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Good");break;case"V_ExecutionReturnCode":switch(i=o.getAttributeInfo(n),(i=e.is(i)?e.clone(i):e.clone(r)).FullName=t+"."+n,i.HasRangeDefined="Yes",i.AuthorizedValues=[],t){case"DELLmiTimeConstraintFailed":i.AuthorizedValues=[{Name:"RCFail203",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.203")},{Name:"RCFail204",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.204")}],i.DefaultValue=a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.203");break;case"DELLmiTimeConstraintAlternative":i.AuthorizedValues=[{Name:"RCAlter201",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.201")},{Name:"RCAlter202",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.202")}],i.DefaultValue=a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.201");break;case"DELLmiTimeConstraintScrapped":i.AuthorizedValues=[{Name:"RCScrap205",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.205")},{Name:"RCScrap206",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.206")}],i.DefaultValue=a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.205");break;case"DELLmiTimeConstraintCategoryAbstract":i.AuthorizedValues=[{Name:"RCAlter201",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.201")},{Name:"RCAlter202",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.202")},{Name:"RCFail203",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.203")},{Name:"RCFail204",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.204")},{Name:"RCScrap205",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.205")},{Name:"RCScrap206",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.206")}],i.DefaultValue=a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.205")}break;case"isOverlapExist":(i=e.clone(r)).DefaultValue="false",i.Type="Boolean",i.NLS=a.getNLSValue("DELLmiTimeConstraintCnx.Overlap");break;case"overlapMagnitude":(i=e.clone(r)).NLS=a.getNLSValue("DELLmiTimeConstraintCnx.Overlap.Magnitude"),i.AuthorizedValues=[{Name:"DELLmiTCOverlapQty_Weight",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.Overlap.Magnitude.Weight")},{Name:"DELLmiTCOverlapQty_Volume",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.Overlap.Magnitude.Volume")},{Name:"DELLmiTCOverlapQty_Length",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.Overlap.Magnitude.Length")},{Name:"DELLmiTCOverlapQty_Area",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.Overlap.Magnitude.Area")},{Name:"DELLmiTCOverlapQty_Each",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.Overlap.Magnitude.Each")}],i.HasRangeDefined="Yes",i.DefaultValue=a.getNLSValue("DELLmiTimeConstraintCnx.Overlap.Magnitude.Each")}return i},O=function(e){var t=e.get("from"),n=t[t.length-1],r=i.getInstance(n),c=r.get("type"),u=!1,d=!1,g=[{Name:"DELLmiTimeConstraintFailed",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Failed")},{Name:"DELLmiTimeConstraintAlternative",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Alternative")},{Name:"DELLmiTimeConstraintScrapped",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Scrapped")}];if(o.isAKindOf(c,"DELLmiHeaderOperationInstance")){let t=r.get(M),n=o.getAttributeInfo(M),i=s.getAuthorizedValue(n,null,t),a=e.get(V),c=e.get(k),g=o.getAttributeInfo(V),f=s.getAuthorizedValue(g,null,a);if("NotDefined"===i)switch(f){case l.GOOD:case l.FAILED:case l.ALTERNATIVE:case l.SCRAPPED:u=!0;break;case l.QUANTITYDISTRIBUTION:u=!0,d=!0}else switch(f){case l.GOOD:"TRUE"===c&&(u=!0),d=!0;break;case l.FAILED:case l.ALTERNATIVE:case l.SCRAPPED:case l.QUANTITYDISTRIBUTION:d=!0}}else u=!0;return u&&g.unshift({Name:"",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Good")}),d&&g.unshift({Name:"DELLmiTimeConstraintQuantityDistribution",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.QuantityDistribution")}),g},E=function(){var e={},t={};w.forEach((function(n){var i,o;i=n.split("."),o=S(i[0],i[1]),t[n]=o.NLS,e[n]=o})),a.addNlsJSON(t),s.addAttributeInfo(e),x=!0},R=function(t){var n,i,r,a=t.get(V);return e.is(a)&&""!==a&&(U[a]?n=a:(i=o.getAttributeInfo(w[0]),r=s.getAuthorizedValueIndex(i,null,a),e.is(r)&&(n=s.getAuthorizedValueDB(i,r)))),n},h=function(t){var o,r,s=new Map,c={};t.forEach((function(t){var n,o,a,c=t.x,l=t.y;n=i.getInstance(t.instancePID),o=i.getReferenceModelFromInstance(n).get("PPRTYPE"),r=[(a="OPERATION"===o?"DELLmiOperationInstance.":"SYSTEM"===o?"DELLmiProductionSystemInstance.":"")+y,a+v],e.is(n)&&(c===Number(n.get(a+y))&&l===Number(n.get(a+v))||s.set(t.instancePID,{[a+y]:c,[a+v]:l}))})),s.size>0&&(o={data:Object.fromEntries(s),onFailure:function(){n.notify("stopProgress",c),n.warn(a.getNLSValue("ProductFlowLinkBehavior.TilePosition.SaveFailed"))},onComplete:function(){n.notify("stopProgress",c),n.info(a.getNLSValue("ProductFlowLinkBehavior.TilePosition.SaveSuccess"))}},n.notify("startProgress",c),i.updateInstances(r,o))},C=function(t,o,r){var s,c,l={},u={};e.is(o.anchorPositionValues,"object")&&Object.assign(l,o.anchorPositionValues),e.is(o.flowType)&&(c=Object.keys(U).find((e=>U[e]===o.flowType)),l[V]=c),s={data:l,onFailure:function(t){var i=a.getNLSValue("ProductFlowLinkBehavior.updateConnectionAttributes.UpdateFailed");e.is(t)&&e.is(t.message,"string")&&(i+="\n"+t.message),n.warn(i),n.notify("stopProgress",u)},onComplete:function(){var i,s={linkPID:t};for(i in o)o.hasOwnProperty(i)&&(s[i]=o[i]);e.is(r.refreshNodeLinks)&&r.refreshNodeLinks&&n.notify("refreshNodeLinks",s),n.info(a.getNLSValue("ProductFlowLinkBehavior.updateConnectionAttributes.UpdateSuccess")),n.notify("stopProgress",u)}},n.notify("startProgress",u),i.updateConnection(t,s)},N=function(t){return new Promise((function(o,r){var s={},c=function(){n.notify("stopProgress",s),n.warn(a.getNLSValue("EditAttributeUI.retrieveDataFailure")),r()};if(!e.is(t))return n.debug("object is not available."),void r();n.notify("startProgress",s),i.fetchAttributes(t,{onComplete:function(){n.notify("stopProgress",s),o()},onFailure:c,onTimeout:c})}))},D=function(t){var n,i=null,o=null,r=u.getComponent("ComboBox"),s=["North","South","East","West"],c=[],l=[],d=u.createElement("div",{class:"section-container"}),m=u.createElement("div",{class:"start-position-content",styles:{display:"flex","align-items":"center",margin:"20px"}}),I=u.createElement("div",{class:"end-position-content",styles:{display:"flex","align-items":"center",margin:"20px"}});for(new e.Element("span",{text:a.getNLSValue("ProductFlowLinkBehavior.editAnchorPositionsDialog.StartPosition.Title"),styles:{width:"45%"}}).inject(m),new e.Element("span",{text:a.getNLSValue("ProductFlowLinkBehavior.editAnchorPositionsDialog.EndPosition.Title"),styles:{width:"45%"}}).inject(I),n=0;n<s.length;n++)c.push({label:a.getNLSValue("ProductFlowLinkBehavior.editAnchorPositionsDialog."+s[n]),value:s[n]}),l.push({label:a.getNLSValue("ProductFlowLinkBehavior.editAnchorPositionsDialog."+s[n]),value:s[n]});return t.get(F)&&t.get(_)&&(i=s.findIndex((function(e){return"Default"===t.get(F)?"East"===e:e===t.get(F)})),o=s.findIndex((function(e){return"Default"===t.get(_)?"West"===e:e===t.get(_)}))),g=new r({elementsList:c,enableSearchFlag:!1,actionOnClickFlag:!1,selectedIndex:null!==i?i:2}).inject(m),f=new r({elementsList:l,enableSearchFlag:!1,actionOnClickFlag:!1,selectedIndex:null!==o?o:3}).inject(I),m.inject(d),I.inject(d),d},A=function(t){var n={},i=a.getNLSValue("LinksUI.EditAnchorPositions");e.is(u)&&(d=u.createElement("div",{class:"EditAnchorPositions-Dialog"}),(Y=u.create("Dialog",{domId:"EditAnchorPositionsUI-Dialog",title:i,content:d,resizableFlag:!0,modalFlag:!0,width:280,minWidth:260,height:190,minHeight:180,buttons:{Cancel:new G({onClick:function(){Y.close()}}),Ok:new G({disabled:!1,emphasize:"primary",onClick:function(){n={"DELArrowDisplayExt.V_ArrowStartPosition":g.value,"DELArrowDisplayExt.V_ArrowEndPosition":f.value},e.is(t,"function")&&t(n)}})}})).close=function(){this.destroy(),e.is(d)&&d.destroy(),Y=null})},{listenTo:function(){},onStart:function(){u=n.getBehavior("UXFactoryBehavior"),x||E()},onStop:function(){},canCreateProductFlowLink:function(t,n){var r,s,c,l,u,d,g,f,m=!0,I={};return d=function(){var t=!1,n=l.toString(),i=u.toString();return l.length>0&&u.length>0&&0!==n.indexOf(i)&&0!==i.indexOf(n)&&(r=p(l,u),t=e.is(r)&&Array.isArray(r.fromPath)&&r.fromPath.length>0&&Array.isArray(r.toPath)&&r.toPath.length>0),t},g=function(){var e,t,n;return e=i.getInstance(l[l.length-1]),t=i.getReference(e.get("isAggregatedBy")),n=i.getSequencingModeAttrName(t),"Linear"===t.get(n)},f=function(t,n){const r=i.getInstance(t),a=i.getInstance(n);return!(!e.is(r)||!e.is(a))&&(o.isAKindOf(r.get("type"),"DELLmiHeaderWorkPlanInstance")||o.isAKindOf(a.get("type"),"DELLmiHeaderWorkPlanInstance"))},t=t||{},e.is(t.fromSideAbsPath)&&e.is(t.toSideAbsPath)?(l=t.fromSideAbsPath,u=t.toSideAbsPath,s=a.getNLSValue(n),d()?g()?(m=!1,c=a.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.ParentisInLinearSeqMode",{linkType:s})):L(r.fromPath,r.toPath)?(m=!1,c=a.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.ExistOrLoop",{linkType:s})):f(l,u)&&(m=!1,c=a.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.FromOrToHeaderWorkPlan",{linkType:s})):(m=!1,c=a.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.NoCommonParent",{linkType:s}))):(m=!1,c=a.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.InsufficentInfo")),I={canCreateLink:m},m?I.data=e.merge({type:n,fromSideOccPath:e.is(r,"object")?r.fromPath:null,toSideOccPath:e.is(r,"object")?r.toPath:null,displayText:e.is(s)?s:null,buttonIdentifier:e.is(s)?s:null},e.clone(t)):I.errorMessage=c,I},createProductFlowLink:function(t,n,o,r){var a,s,c,u,d=function(){e.is(r,"function")&&r(u)};n=n||{},s=(t=t||{}).fromSideOccPath[t.fromSideOccPath.length-1],c=t.toSideOccPath[t.toSideOccPath.length-1],u={linkType:t.type,target:s,source:c},a=this.canCreateProductFlowLink(t,t.type),e.is(t.startAnchorId)&&e.is(t.endAnchorId)&&(n.startAnchorId=t.startAnchorId,n.endAnchorId=t.endAnchorId),e.is(m)&&m&&(n.flowType=U[l.FAILED]),a.canCreateLink?i.createConnection({IDFrom:t.fromSideOccPath.toString(),IDTo:t.toSideOccPath.toString(),type:t.type},e.merge({onFailure:d,onTimeout:d,onCancel:d,onComplete:function(n){var a,s={[V]:l.FAILED};e.is(t.isFromPERTView)&&t.isFromPERTView||!e.is(m)||!m?e.is(o,"function")&&o(u):(a={data:s,onComplete:function(){e.is(o,"function")&&o(u)},onFailure:function(){e.is(r,"function")&&r(u)}},i.updateConnection(n.id,a))}},n)):(u.errorMessage=a.errorMessage,d())},getProductFlowRelationTypes:function(){return B},getProductFlowRelationTypeByTypes:function(e,t){var n,i=o.getPossibleRelations(e,t,"write");return(n=i.indexOf(B[0]))>-1?i[n]:void 0},getDynamicAuthorizedListFlowType:function(e){return O(e)},getLinkInfo:function(t){var n,i,r,c,l,u,d,g,f,m={NLS:null,type:null,subType:null,iconName:null,flowType:null,reasonCode:null,description:null,isProductFlow:!1};return n=t.get("type"),i=t.get("PLMEntity.V_description"),c=o.getAttributeInfo(b),"TRUE"===t.get(k)?(m.isProductFlow=!0,r=n+"_ProductFlow",d=R(t),"Good"!==(g=e.is(d)?U[d]:"Good")&&(f=t.get("DELLmiTimeConstraintCategoryAbstract.V_ExecutionReturnCode"))):(l=t.get(b),u=s.getAuthorizedValueIndex(c,null,l),r=n+"_"+s.getAuthorizedValueDB(c,u)),m.NLS=a.getNLSValue(r),m.type=n,m.description=i,m.subType=r,m.iconName=r,m.flowType=g,m.reasonCode=f,m},validateProductFlowCategory:function(t,n){var o,r,a,s,c,u=!0;return s=Object.keys(n).find((e=>e.includes(V))),e.is(s)&&e.is(n[s])&&n[s]===l.GOOD&&(o=i.getConnection(t),e.is(o)&&(r=o.get("from"),a=o.get("to"),P(r,a),I&&m&&(c=Object.keys(U).find((e=>U[e]===o.get(s))),e.is(c)&&(u=!1,n[s]=c)))),[n,u]},saveTilePositions:function(e){h(e)},editAnchorPositions:function(t){var o,r=i.getConnection(t),s=e.is(r)?r.get("type"):null;e.is(r)&&s===B[0]?N(r).then((function(){o=D(r),A((function(e){null!==e?C(t,{anchorPositionValues:e},{refreshNodeLinks:!0}):n.warn(a.getNLSValue("EditAnchorPositionsUI.ConfigAttrNotAvilaibleOnObject")),Y.close()})),o.inject(d)})):n.warn(a.getNLSValue("EditAnchorPositionsUI.LinkNotAvailable"))},updateConnectionAttributes:function(e,t,n){C(e,t,n)},addToCollection:function(e){i.addToCollections(e)}}}}})),define("DS/DELPPWProcessModelBehaviors/ProcessImplementBehaviorBase",["UWA/Core","UWA/Class/Promise"],(function(e,t){"use strict";return function(n,i,o,r,a,s,c,l,u){const d="ProcessImplementLink";var g,f,m,I,p=function(t,n,o,r){var s=e.is(t)?a.getNLSValue(t):n;i.info(s,o),r&&r(s)},L=function(t,n,o,r,s){var c=e.is(t)?a.getNLSValue(t):o;e.is(n,"string")&&n.length>0&&(c=n),i.warn(c,r),s&&s(c)};return g=function(e,t,n,o,r,c){var l,u,g={},f=a.getNLSValue("ImplementBehavior.CreateScope.LogMessage"),m=a.getNLSValue("ImplementBehavior.CreateScope.Success"),P=a.getNLSValue("ImplementBehavior.CreateScope.Failed"),S=i.log(f),E=function(e){p(e,m,S,r),i.notify("linkCreated",g)},O=function(e,t){L(e,t,P,S,c)};l=s.canCreateScopeLink({fromSideRefPID:e,toSideRefPID:t,fromSideAbsPath:n,toSideAbsPath:o});const R=i.getPreferenceValue("copyModelProductToItemUponSL");l.canCreateLink?s.getScopeLinkType()===d?s.createScopeLink(e,t,{onComplete:E,onFailure:O,copyModelProductToItemUponSL:R}):(u=I(n)).hasImplementLink?O(null,a.getNLSValue("ImplementBehavior.Validation.ImplLinkExists",{obj1:u.implementingName,obj2:u.implementedName})):s.createScopeLink(e,t,{onComplete:E,onFailure:O,copyModelProductToItemUponSL:R}):O(null,l.errorMessage)},f=function(t,n,r,c){var u,g,f,m,P,S,E,O,R=[],T=a.getNLSValue("ImplementBehavior.CreateScope.LogMessage"),h=a.getNLSValue("ImplementBehavior.CreateScope.Success"),C=a.getNLSValue("ImplementBehavior.CreateScope.Failed"),N=i.log(T),A=function(t,n){p(t,h,N,r),e.is(n)&&(n.connections.forEach((function(e){R.push(e.toJSON())})),i.notify("createImplementLink",R))},D=function(e,t){L(e,t,C,N,c)};if(e.is(t,"array")&&t.length>0&&e.is(n,"array")&&n.length>0){g=t[t.length-1],u=o.getReferenceIdFromInstance(g),m=n[n.length-1],f=o.getReferenceIdFromInstance(m),O=s.canCreateScopeLink({fromSideRefPID:u,toSideRefPID:f,fromSideInstPID:g,toSideInstPID:m,fromSideAbsPath:t,toSideAbsPath:n});const e=i.getPreferenceValue("copyModelProductToItemUponSL");if(O.canCreateLink)if(s.getScopeLinkType()===d)s.createScopeLink(u,f,{onComplete:A,onFailure:D,copyModelProductToItemUponSL:e});else if(s.validateIfScoped(t,n))(E=I(t,n)).hasImplementLink?E.withSameProduct?s.createScopeLink(u,f,{onComplete:A,onFailure:D,copyModelProductToItemUponSL:e,implementLinks:E.implementLinks}):D(null,a.getNLSValue("ImplementBehavior.Validation.ImplLinkExists",{obj1:E.implementingName,obj2:E.implementedName})):(P=s.getPathToPartialOrFullScope(t,n),S=s.getImplementingPathsToPartialOrFullScope(t),s.createScopeAndImplementLink(u,S,f,P,{onComplete:A,onFailure:D,copyModelProductToItemUponSL:e}));else{if(i.getPreferenceValue("skipVaidationIfScopedCheck")&&l.isAKindOf(undefined,"Provide"))return void s.createScopeLink(u,f,{onComplete:A,onFailure:D,copyModelProductToItemUponSL:e});D(null,a.getNLSValue("ImplementBehavior.Validation.ScopeNotValid"))}else D(null,O.errorMessage)}else i.debug("Input parameters are invalid."),D()},I=function(t,n){var i,r,a,c,l,u,d,g=!1,f=!1,m=null,I=null;return i=e.is(t,"array")&&t.length>0?s.getImplLinksOfImplementing(t):null,e.is(i,"array")&&i.length>0&&(g=!0,e.is(n)&&!0===(f=i.some((function(t){const i=e.is(n,"array")&&n.length>0?n[n.length-1]:n;return e.equals(t.get("to"),[i])})))&&(d=i),c=(u=i[0]).getAttribute("from"),l=o.getReferenceModel(c),e.is(l)&&(I=l.get("PLMEntity.V_Name")),r=u.getAttribute("to"),a=o.getReferenceModel(r),e.is(a)&&(m=a.get("PLMEntity.V_Name"))),{hasImplementLink:g,withSameProduct:f,implementingName:I,implementedName:m,implementLinks:d}},m=function(n,i,r,a){var c,l,u;return e.is(n,"array")&&n.length>0&&s.isUnderScope(n)&&e.is(r,"array")&&r.length>0?(l=n,u=r,c=new t((function(e,t){f(l,u,e,t)}))):c=function(e,n,i,r){return new t((function(t,a){var s=o.isReference(e)?e:o.getReferenceIdFromInstance(e),c=o.isReference(n)?n:o.getReferenceIdFromInstance(n);g(s,c,i,r,t,a)}))}(i,a,n,r),c},{onStart:function(){},isScoped:function(e){return s.isScoped(e)},isPartialScoped:function(e){return s.isPartialScoped(e)},getPartialScopeLinkType:function(){return s.getPartialScopeLinkType()},getScopeLinkType:function(){return s.getScopeLinkType()},getImplementLinkType:function(){return s.getImplementLinkType()},getScopeLinksOfImplemented:function(e){return s.getScopeLinksOfImplemented(e)},getPartialScopeLinks:function(e){return s.getPartialScopeLinks(e)},getPathToScope:function(e){return s.getPathToScope(e)},findInstanceWhoseParentIsScoped:function(e){return s.findInstanceWhoseParentIsScoped(e)},createScopeLink:function(n){var r,a={},s=[];return e.is(n,"array")&&n.length>0?(i.notify("startProgress",a),s=n.map((function(e){return m(e.implementingAbsPath,e.implementingPID,e.implementedAbsPath,e.implementedPID,e.isPartialScope)})),r=t.allSettled(s).then((function(){var r,s=u.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),c=[],d=o.isReference(n[0].implementingPID)?n[0].implementingPID:o.getReferenceIdFromInstance(n[0].implementingPID),g=o.isReference(n[0].implementedPID)?n[0].implementedPID:o.getReferenceIdFromInstance(n[0].implementedPID);r=o.getReferenceModel(d),l.isAKindOf(r.get("type"),"Provide")||l.isAKindOf(r.get("type"),"DELServicePartReference")?o.getCurrentStates([g],s,(function(n){e.is(n)&&"RELEASED"===n.get(g)?((widget.getValue("isReleaseMaturitySynced")||i.getPreferenceValue("isReleaseSyncXENEnabled")&&widget.getValue("fromXen"))&&c.push(new t((function(e,t){o.syncMaturity([r],s,widget.getValue("isChangeRequiredSynced")||i.getPreferenceValue("isReleaseSyncXENEnabled")&&widget.getValue("fromXen"),e,t)}))),t.all(c).then((function(){var e=[];e.onComplete=function(){i.notify("referenceChanged",r),i.notify("stopProgress",a)},e.onFailure=function(){i.notify("referenceChanged",r),i.notify("stopProgress",a)},e.forceDBMode=!0,o.fetchRoot(r.get("PID"),e)}))):i.notify("stopProgress",a)})):(i.notify("referenceChanged",r),i.notify("stopProgress",a))}))):(i.debug("Input parameters are invalid."),r=t.reject("ImplementBehavior.Validation.InvalidInput")),r},createImplementLink:function(t,n,r,c){var l,u,d,g,f=a.getNLSValue("ImplementBehavior.Validation.ScopeNotValid"),m=function(t,n){var i=e.is(t)?a.getNLSValue(t):null;e.is(n)&&(i=n),u.errorMessage=i,c(u)};if(u={linkType:t.type,target:o.getReferenceModel(t.implementingAbsPath[t.implementingAbsPath.length-1]).get("PID"),source:o.getReferenceModel(t.implementedAbsPath[t.implementedAbsPath.length-1]).get("PID")},e.is(t.fromSideAbsPath)&&e.is(t.fromSideAbsPath)||(t.fromSideAbsPath=t.implementingAbsPath,t.toSideAbsPath=t.implementedAbsPath),e.is(t.fromSideRefPID)||(t.fromSideRefPID=t.implementingPID),s.canCreateImplementLink(t).canCreateLink){let n=s.isPartialScoped(t.fromSideRefPID)?[t.fromSideRefPID]:t.implementingAbsPath,o=t.implementedAbsPath;d=(l=s.getPathsToScope(n,o)).implementingPathToScope,g=l.implementedPathToScope,e.is(d)&&e.is(g)?s.createImplementLink(d,g,{connectionParams:t.connectionParams,onComplete:function(e,t){i.notify("createImplementLink",t.toJSON()),r(u)},onFailure:m}):m(null,f)}else m(null,f)},deleteScopeLink:function(n){var o,r,c={},l=[],u=e.is(n,"array")?n:[n],d=a.getNLSValue(this.getScopeLinkType()),g=a.getNLSValue("DeleteLink.LogMessage",{linkType:d}),f=a.getNLSValue("DeleteLink.Success",{linkType:d}),m=a.getNLSValue("DeleteLink.Failure",{linkType:d});return u.length>0?(i.notify("startProgress",c),u.forEach((function(n){r=s.getScopeLinksOfImplementing(n),e.is(r)&&r.length>0&&(l=r.map((function(e){return new t((function(t,n){!function(e,t,n){var o=i.log(g);s.deleteScopeLink(e,{onComplete:function(e,n){p(e,f,o,t),i.notify("linkDeleted",[n.deletedConnections])},onFailure:function(e,t){L(e,t,m,o,n)}})}(e.get("PID"),t,n)}))})))})),o=t.allSettled(l).then((function(){i.notify("stopProgress",c)}))):(i.debug("Unable to delete scope links as input parameters are invalid."),o=t.reject("ImplementBehavior.Validation.InvalidInput")),o}}}})),define("DS/DELPPWProcessModelBehaviors/BuildUpBehavior",["UWA/Core"],(function(e){"use strict";return{plugins:["DicoPlugin","UXComponentsPlugin","DatabasePlugin","ResourcePlugin","DELPXPSessionPlugin","ModelObserverPlugin","AttributePlugin"],creator:function(t,n,i,o,r,a,s,c,l){const u={TYPE:"type",PID:"PID",V_NAME:"PLMEntity.V_Name",ISAGGREGATEDBY:"isAggregatedBy",ISINSTANCEOF:"isInstanceOf",PLMEXTERNALID:"PLMInstance.PLM_ExternalID",FROM:"from",TO:"to",V_USAGE:"PLMEntity.V_usage",V_MATERIALNEED:"DELLmiTimeConstraintCnx.V_MaterialNeed",V_TREEORDER:"V_TreeOrder",V_SYMBOLICID:"SymbolicID.V_SymbolicID",V_ISPOSITIONING:"DELLmiIsPositioning.V_IsPositioning",V_ISPREFERRED:"DELAsmProcessCanUseCnx.V_IsPreferred",V_ISRESERVED:"DELAsmProcessCanUseCnx.V_IsReservedFromFirstStep",V_REFPOSITION:"DELLmiReferencePosition.V_ReferencePosition",V_POSITIONSPEC:"DELLmiPositionMngt.V_PositioningSpec",V_AVAILABILITYMODEONPRIMARYDETAIL:"PrimaryResourceLinkDetail.V_AvailabilityMode",V_AVAILABILITYMODEONSECDETAIL:"SecondaryResourceLinkDetail.V_AvailabilityMode",APPLICABILITYMODE:"ApplicabilityMode",BU_POSITIONING:"BuildUpPositioning",RES_POSITIONING:"ResourcePositioning",MATRIXTRANSLATIONUNIT:"MatrixTranslationUnit",MATRIXSTORAGEORDER:"MatrixStorageOrder",REFPOSITIONMODE:"ReferencePositionMode",RELBU_POSVER:"RelativePositionVersionBuildUp",RELRES_POSVER:"RelativePositionVersionRsc",FAKETFMATRIX:["1.0","0.0","0.0","0.0","1.0","0.0","0.0","0.0","1.0","0.0","0.0","0.0"],SEQMODE_SYS:"DELLmiPPRSystemReference.V_SequencingMode",SEQMODE_HOP:"DELLmiHeaderOperationReference.V_SequencingMode",SEQMODE_GOP:"DELLmiGeneralOperationReference.V_SequencingMode",SEQMODE_HWP:"DELLmiPPRHeaderProcessReferenceAbstract.V_SequencingMode",METER:"METER"},d="type",g="pid",f="name",m="duration",I="from",p="to",L="role",P="symbolicid",S="isReserved",E="isPositioning",O="resourcePositioning",R="buildupPositioning",T="referencePosition",h="referencePositionMode",C="availabilityMode",N="applicabilityMode",A="isOwnedBy",D="transformationMatrix",y="matrixTranslationUnit",v="materialNeed",V="treeOrder",k="isInstanceOf",M="sequencingmode",b="ds6w:kind",F="relativePositionVersionBuildUp",_="relativePositionVersionRsc",B="DELLmiTimeConstraintCnx",U="ProcessImplementLink",x="PartialProcessImplementLink",w="ProcessImplementLinkOcc",G="DELAsmProcessCanUseCnx",Y="SecondaryCandidateResourceLink",j="PrimaryResourceLinkDetail",W="SecondaryResourceLinkDetail",Q="MfgProductionPlanning",X="DELLmiTimeConstraintScrapped",H="DELLmiTimeConstraintFailed",z="DELLmiTimeConstraintAlternative",q="Scrapped",J="Failed",K="Alternative";var Z,$,ee,te,ne,ie,oe,re,ae,se,ce,le,ue,de,ge,fe={},me=(t.getLogger(),n.getAppContext()),Ie=o.getComponent("WUXCommandsManager"),pe=[],Le=[],Pe=[],Se=[];let Ee,Oe,Re,Te,he,Ce,Ne,Ae=[],De=0,ye=null;Ne=function(e){Ee={SYSTEM:{add:e.createOperationReference,update:e.updateOperationReference,remove:e.deleteOperationReference},OPERATION:{add:e.createOperationReference,update:e.updateOperationReference,remove:e.deleteOperationReference},PROCESS:{add:e.createMfgItemReference,update:e.updateMfgItemReference,remove:e.deleteMfgItemReference},RESOURCE:{add:null,update:null,remove:null},SystemInstance:{add:e.createOperationInstance,update:e.updateOperationInstance,remove:e.deleteOperationInstance},OperationInstance:{add:e.createOperationInstance,update:e.updateOperationInstance,remove:e.deleteOperationInstance},DELFmiFunctionIdentifiedInstance:{add:e.createMfgItemInstance,update:e.updateMfgItemInstance,remove:e.deleteMfgItemInstance},VPMInstance:{add:null,update:null,remove:null},ProductImplementLink:{add:null,update:null,remove:null},ProductImplementLinkOcc:{add:null,update:null,remove:null},ProcessImplementLink:{add:e.createScopeLink,update:e.updateScopeLink,remove:e.deleteScopeLink},ProcessImplementLinkOcc:{add:e.createImplementLink,update:e.updateImplementLink,remove:e.deleteImplementLink},PartialProcessImplementLink:{add:e.createScopeLink,update:e.updateScopeLink,remove:e.deleteScopeLink},CapableResourcesStructureLink:{add:null,update:null,remove:null},DELAsmProcessCanUseCnx:{add:null,update:null,remove:null},SecondaryCandidateResourceLink:{add:null,update:null,remove:null},PrimaryResourceLinkDetail:{add:null,update:null,remove:null},SecondaryResourceLinkDetail:{add:null,update:null,remove:null},DELLmiTimeConstraintCnx:{add:e.createTimeConstraint,update:e.updateTimeConstraint,remove:e.deleteTimeConstraint},LinearProductFlowCnx:{add:null,update:null,remove:null},HistorizationLinkRefRef:{add:null,update:null,remove:null},MfgProcessAlternate:{add:null,update:null,remove:null}}},Re=function(t,n){var i,o;if(i={apiToCall:e.is(t.PPRTYPE)&&e.is(Ee[t.PPRTYPE])?Ee[t.PPRTYPE][n]:null,info:{pid:t.PID,type:t.type}},"SYSTEM"!==t.PPRTYPE&&"OPERATION"!==t.PPRTYPE||(i.info.duration=600),i.info.type=t.type,(o=r.getSequencingModeAttrName(t.PID))&&e.is(t[o])){let e,n,r,a;e=t[o],n=l.getAttributeInfo(o),r=n.AuthorizedValues.findIndex((t=>t.NLS===e)),a=l.getAuthorizedValueDB(n,r),i.info[M]=a}return i},Te=function(t,n){var i,o;return(i={apiToCall:Ee.OperationInstance[n],info:{pid:t.PID}}).info.isOwnedBy=t.isAggregatedBy,i.info.isInstanceOf=t.isInstanceOf,i.info.type=t.type,"DELFmiFunctionIdentifiedInstance"!==t.type&&"VPMInstance"!==t.type||(i.info[D]=u.FAKETFMATRIX),t.type.contains("OperationInstance")||t.type.contains("SystemInstance")?i.info[V]=Number(t[u.V_TREEORDER]):i.apiToCall=e.is(Ee[o])?Ee[o][n]:null,i},he=function(t,n){var i,o={apiToCall:e.is(Ee[t[u.TYPE]])?Ee[t[u.TYPE]][n]:null,info:{pid:t[u.PID]}};switch(e.is(t[u.FROM])&&(o.info=e.extend(o.info,{from:Array.isArray(t[u.FROM])?t[u.FROM]:[t[u.FROM]]})),e.is(t[u.TO])&&(o.info=e.extend(o.info,{to:Array.isArray(t[u.TO])?t[u.TO]:[t[u.TO]]})),t.type){case"ProcessImplementLink":case"PartialProcessImplementLink":o.info=e.extend(o.info,{type:"MfgProductionPlanning"});break;case"ProcessImplementLinkOcc":o.info=e.extend(o.info,{type:"MfgProductionPlanning"}),"NULL"!==t[u.V_USAGE]&&(o.info[L]=t[u.V_USAGE]),i=r.getConnection(t.PID),e.is(i)?(o.info[A]=ge(i.get(u.FROM)[0]),le(i.get(u.TO),n)):(o.info[A]=ge(o.info[u.FROM][0]),le(o.info[u.TO],n));break;case"DELAsmProcessCanUseCnx":o.info=e.extend(o.info,{isReserved:"TRUE"===t["DELAsmProcessCanUseCnx.V_IsReservedFromFirstStep"],type:"PrimaryCapableRscLink"});break;case"SecondaryCandidateResourceLink":o.info=e.extend(o.info,{type:"SecondaryCapableRscLink"});break;case"PrimaryResourceLinkDetail":o.info=e.extend(o.info,{availabilitymode:t[u.V_AVAILABILITYMODEONPRIMARYDETAIL],from:t.from[t.from.length-1],type:"PrimaryCapableRscLinkDetail"}),delete o.info.to;break;case"SecondaryResourceLinkDetail":o.info=e.extend(o.info,{availabilitymode:t[u.V_AVAILABILITYMODEONSECDETAIL],from:t.from[t.from.length-1],type:"SecondaryCapableRscLinkDetail"}),delete o.info.to;break;case"DELLmiTimeConstraintCnx":if(o.info=e.extend(o.info,{materialNeed:t[u.V_MATERIALNEED],type:t[u.TYPE]}),e.is(t[u.PRODUCTFLOWTYPE]))switch(t[u.PRODUCTFLOWTYPE]){case q:o.info[b]=X;break;case J:o.info[b]=H;break;case K:o.info[b]=z}e.is(t[u.FROM])&&e.is(t[u.TO])&&(o.info[A]=de(t[u.FROM],t[u.TO]));break;case"LinearProductFlowCnx":let a,s=[],c={},f=de(t[u.FROM],t[u.TO]),I=r.getReference(f);if(s=s.concat(t[u.FROM]),s=s.concat(t[u.TO]),"add"===n&&(a=r.getSequencingModeAttrName(f),a&&e.is(I.get(a)))){let e,t,n,i;e=I.get(a),t=l.getAttributeInfo(a),n=t.AuthorizedValues.findIndex((t=>t.NLS===e)),i=l.getAuthorizedValueDB(t,n),c[g]=f,c[d]=I.get(u.TYPE),c[M]=i,c[m]=600,$.updateOperationReference.call($,c)}s.forEach((function(e){let t=r.getInstance(e);c={pid:e,isOwnedBy:t.get(u.ISAGGREGATEDBY),isInstanceOf:t.get(u.ISINSTANCEOF),type:t.get(u.TYPE),treeOrder:t.get(u.V_TREEORDER)},c[g]=e,c[A]=t.get(u.ISAGGREGATEDBY),c[k]=t.get(u.ISINSTANCEOF),c[d]=t.get(u.TYPE),c[V]=t.get(u.V_TREEORDER),$.updateOperationInstance.call($,c)}))}return o},Ce=function(t,n){var i,o;if(i={apiToCall:null,info:t.PID},o=t.type,t.type.contains("OperationInstance")||t.type.contains("SystemInstance"))o="OperationInstance",Z=t.PID;else if("SYSTEM"===t.PPRTYPE||"OPERATION"===t.PPRTYPE||"PROCESS"===t.PPRTYPE||"RESOURCE"===t.PPRTYPE)o=t.PPRTYPE;else if("ProcessImplementLinkOcc"===t.type)le(t[u.TO],n);else if("LinearProductFlowCnx"===t.type&&"remove"===n){let n,i={},o=de(t[u.FROM],t[u.TO]),a=r.getReference(o);if(n=r.getSequencingModeAttrName(o),n&&e.is(a.get(n))){let e,t,r,s;e=a.get(n),t=l.getAttributeInfo(n),r=t.AuthorizedValues.findIndex((t=>t.NLS===e)),s=l.getAuthorizedValueDB(t,r),i={pid:o,type:a.get(u.TYPE),sequencingmode:s,duration:600},$.updateOperationReference.call($,i)}}return i.apiToCall=Ee[o][n],i};let ve={references:{add:Re,update:Re,remove:Ce},instances:{add:Te,update:Te,remove:Ce},connections:{add:he,update:he,remove:Ce}};return Oe=function(t){var n=t||{};Object.keys(n).forEach((function(t){Object.keys(n[t]).forEach((function(i){n[t][i]=Array.isArray(n[t][i])?n[t][i]:[n[t][i]],n[t][i].forEach((function(n){if(e.is(ve[t][i])){let o=ve[t][i](n,i);e.is(o.apiToCall)&&e.is(o.info)&&e.is($)&&o.apiToCall.call($,o.info)}}))}))}))},ue=function(e,t){var n,i;return[n,i]=e.length>t.length?[e,t]:[t,e],i.every((e=>n.includes(e)))},le=function(n,i){var o,a,s,c,l,u,d=!1,g=!1,f=[];if(u=t.getBehavior("MANUFACTURING","WUXNodeModelBehavior"),e.is(u)||(u=t.getBehavior("SBOM","WUXNodeModelBehavior")),e.is(n))if(o=r.transformToRIROccurrencePath(n),f=u.getChildren(o[o.length-1]),"add"===i)if(Le.length>0)if(Pe.push(o),0===f.length){for(a=0;a<Le.length;a++)if(e.equals(Le[a],o)){Le.splice(a,1);break}}else f.length>0&&f.forEach((function(t){for(g=!1,a=0;a<Pe.length;a++)if(ue(Pe[a],[t])){g=!0;break}g||(s=r.getReferenceIdFromInstance(t),c=u.getNodeModel(s),Array.isArray(c)&&c.forEach((function(n){if(-1!==(l=r.transformToRIROccurrencePath(n.getAbsolutePath())).indexOf(t))for(a=0;a<Le.length;a++)if(e.equals(Le[a],l)){Le.splice(a,1);break}})))}));else Pe.push(o);else if("remove"===i)if(Pe.length>0){for(a=0;a<Pe.length;a++)if(e.equals(Pe[a],o)){Pe.splice(a,1);break}if(0===f.length){for(a=0;a<Pe.length;a++)if(ue(Pe[a],o)){d=!0;break}d?Le.splice(a,1):Le.push(o)}else f.length>0&&f.forEach((function(e){for(g=!1,a=0;a<Pe.length;a++)if(ue(Pe[a],[e])){g=!0;break}g||(s=r.getReferenceIdFromInstance(e),c=u.getNodeModel(s),Array.isArray(c)&&c.forEach((function(t){-1!==(l=r.transformToRIROccurrencePath(t.getAbsolutePath())).indexOf(e)&&Le.push(l)})))}))}else Le.push(o)},de=function(t,n){var i,o,a,s,c,l,u,d={},g=!1;if(e.is(t,"array")&&e.is(n,"array"))for(o=t.length-1;o>=0;o--){for(s=t[o],a=r.getInstance(s).get("isAggregatedBy"),c=n.length-1;c>=0;c--)if(l=n[c],e.is(d[l])?u=d[l]:(u=r.getInstance(l).get("isAggregatedBy"),d[l]=u),a===u&&s!==l){g=!0,i=a;break}if(g)break}return i},ge=function(e){var t;return t=r.getInstance(e),r.getAggregatingReferenceModelFromInstance(t).get("PID")},ee=function n(i,o,a,s,c,l,m){var I,p,L=[],P={};I=t.getBehavior("MANUFACTURING","WUXNodeModelBehavior"),e.is(I)||(I=t.getBehavior("SBOM","WUXNodeModelBehavior")),-1===l.indexOf(o.id)&&(P[g]=o.id,P[d]=o.get(u.TYPE),P[f]=o.get(u.V_NAME),s.push(P),l.push(o.id)),o.id!==i.scopedMfgItemPID&&r.findInstances({isInstanceOf:o.id}).forEach((function(t){var n={};-1===m.indexOf(t.id)&&(n[g]=t.id,n[A]=t.get(u.ISAGGREGATEDBY),n[k]=t.get(u.ISINSTANCEOF),n[d]=t.get(u.TYPE),n[f]=t.get(u.PLMEXTERNALID),n[D]=e.is(t.get("matrixtxt"))?t.get("matrixtxt").split(","):u.FAKETFMATRIX,c.push(n),m.push(t.id))})),(p=e.is(a)?r.getFilteredInstancesFromCollection(o.id,a):r.findInstances({isAggregatedBy:o.id})).length>0?p.forEach((function(e){r.findReferences({PID:e.get(u.ISINSTANCEOF)}).forEach((function(e){n(i,e,a,s,c,l,m)}))})):(L=I.getNodeModel(o.id),Array.isArray(L)&&L.forEach((function(t){let n,i=!1,o=r.transformToRIROccurrencePath(t.getAbsolutePath());for(n=0;n<pe.length;n++)if(e.equals(pe[n],o)){i=!0;break}i||pe.push(o)})))},te=function(t,n,i,o,a,s){var c,I,p={};if(c=function t(n,i,o,a,s,c){r.findInstances({isAggregatedBy:i.id}).forEach((function(i){r.findReferences({PID:i.get(u.ISINSTANCEOF)}).forEach((function(i){var p={};if(r.isOperation(i.id)||r.isSystem(i.id)){if(-1===s.indexOf(i.id)){if(s.push(i.id),p[g]=i.id,p[d]=i.get(u.TYPE),p[f]=i.get(u.V_NAME),I=r.getSequencingModeAttrName(i.id),e.is(I)){let e,t,n,o;e=i.get(I),t=l.getAttributeInfo(I),n=t.AuthorizedValues.findIndex((t=>t.NLS===e)),o=l.getAuthorizedValueDB(t,n),p[M]=o}e.is(i.get("DELLmiOperationReference.V_EstimatedTime"))&&(p[m]=parseFloat(i.get("DELLmiOperationReference.V_EstimatedTime"))),o.push(p)}r.findInstances({isInstanceOf:i.id}).forEach((function(e){var t={};-1===c.indexOf(e.id)&&(c.push(e.id),t[g]=e.id,t[d]=e.get(u.TYPE),t[A]=e.get(u.ISAGGREGATEDBY),t[k]=e.get(u.ISINSTANCEOF),t[f]=e.get(u.PLMEXTERNALID),t[V]=Number(e.get(u.V_TREEORDER)),a.push(t))})),t(n,i,o,a,s,c)}}))}))},(r.isOperation(n.id)||r.isSystem(n.id))&&-1===a.indexOf(n.id)){if(a.push(n.id),p[g]=n.id,p[d]=n.get(u.TYPE),p[f]=n.get(u.V_NAME),I=r.getSequencingModeAttrName(n.id),e.is(I)){let e,t,i,o;e=n.get(I),t=l.getAttributeInfo(I),i=t.AuthorizedValues.findIndex((t=>t.NLS===e)),o=l.getAuthorizedValueDB(t,i),p[M]=o}e.is(n.get("DELLmiOperationReference.V_EstimatedTime"))&&(p[m]=parseFloat(n.get("DELLmiOperationReference.V_EstimatedTime"))),i.push(p)}c(t,n,i,o,a,s)},ne=function t(n,i,o,a,s,c){var l={};i.isResource()&&(-1===s.indexOf(i.id)&&(l[g]=i.id,l[d]=i.get(u.TYPE),l[f]=i.get(u.V_NAME),o.push(l),s.push(i.id)),i.id!==n.resourceItemPID&&r.findInstances({isInstanceOf:i.id}).forEach((function(t){var n={};-1===c.indexOf(t.id)&&(n[g]=t.id,n[d]=t.get(u.TYPE),n[k]=t.get(u.ISINSTANCEOF),n[A]=t.get(u.ISAGGREGATEDBY),n[D]=e.is(t.get("matrixtxt"))?t.get("matrixtxt").split(","):u.FAKETFMATRIX,e.is(t.get(u.V_SYMBOLICID))&&(n[P]=t.get(u.V_SYMBOLICID)),a.push(n),c.push(t.id))})),r.findInstances({isAggregatedBy:i.id}).forEach((function(e){r.findReferences({PID:e.get(u.ISINSTANCEOF)}).forEach((function(e){t(n,e,o,a,s,c)}))})))},ie=function(n,i,o,a,s,c,l,f,m,V){var k,M,Z,$=[],ee=[],te=[],ne=[],ie=[],oe=[],re=[],ae=[];return k=e.is(i)?i.id:null,e.is(s)?s.id:null,M=e.is(f)?f.id:null,Z=t.getBehavior("MANUFACTURING","WUXNodeModelBehavior"),e.is(Z)||(Z=t.getBehavior("SBOM","WUXNodeModelBehavior")),(ee=r.findConnections({type:B})).forEach((function(t){var i,o,s,c,l,f={},m=!1;if(-1===n.indexOf(t.id)&&((a.indexOf(t.getAttribute(u.TO))>-1||a.indexOf(t.getAttribute(u.FROM))>-1)&&(m=!0),!0===m&&(1===(o=r.findInstances({PID:t.getAttribute(u.FROM)})).length&&((o=o[0]).get(u.ISAGGREGATEDBY)!==k?1===r.findInstances({isInstanceOf:o.get(u.ISAGGREGATEDBY)}).length&&(c=[r.findInstances({isInstanceOf:o.get(u.ISAGGREGATEDBY)},1)[0].id,o.id]):c=[o.id]),1===(i=r.findInstances({PID:t.getAttribute(u.TO)})).length&&((i=i[0]).get(u.ISAGGREGATEDBY)!==k?null!==(l=r.findInstances({isInstanceOf:i.get(u.ISAGGREGATEDBY)},1))&&(s=[l[0].id,i.id]):s=[i.id]),a.indexOf(c[c.length-1])>-1&&a.indexOf(s[s.length-1])>-1))){if(f[g]=t.id,f[I]=c,f[p]=s,f[d]=t.get(u.TYPE),f[v]=e.is(t.get(u.V_MATERIALNEED))?t.get(u.V_MATERIALNEED):"FALSE",f[A]=de(c,s),e.is(t.get(u.PRODUCTFLOWTYPE)))switch(t.get(u.PRODUCTFLOWTYPE)){case q:f[b]=X;break;case J:f[b]=H;break;case K:f[b]=z}$.push(f),n.push(t.id)}})),(ee=(ee=r.findConnections({type:U})).concat(r.findConnections({type:x}))).forEach((function(t){var i={};o.indexOf(t.get(u.FROM))>-1&&c.indexOf(t.get(u.TO))>-1&&-1===n.indexOf(t.id)&&(i[g]=t.id,i[d]=Q,i[I]=e.is(t.get(u.FROM),"array")?t.get(u.FROM):[t.get(u.FROM)],i[p]=e.is(t.get(u.TO),"array")?t.get(u.TO):[t.get(u.TO)],i[A]="",$.push(i),n.push(t.id))})),ee=r.findConnections({type:w}),Le=[...pe],ee.forEach((function(t){var i,o,s,c=[],f={};-1===n.indexOf(t.id)&&(i=t.get(u.FROM)[t.get(u.FROM).length-1],a.indexOf(i)>-1&&(o=t.get(u.TO)[t.get(u.TO).length-1],l.indexOf(o)>-1&&(f[g]=t.id,f[d]=Q,f[I]=e.is(t.get(u.FROM),"array")?t.get(u.FROM):[t.get(u.FROM)],f[p]=e.is(t.get(u.TO),"array")?t.get(u.TO):[t.get(u.TO)],f[A]=ge(t.get(u.FROM)[0]),e.is(t.get(u.V_USAGE))&&"NULL"!==t.get(u.V_USAGE)&&(f[L]=t.get(u.V_USAGE)),$.push(f),n.push(t.id),s=r.getReferenceIdFromInstance(o),c=Z.getNodeModel(s),Array.isArray(c)&&c.forEach((function(t){let n,i=!1,a=!1,s=r.transformToRIROccurrencePath(t.getAbsolutePath());if(-1!==s.indexOf(o)){for(Pe.push(s),n=0;n<pe.length;n++){if(e.equals(pe[n],s)){i=!0;break}if(ue(pe[n],s)){a=!0;break}}if(i){for(n=0;n<Le.length;n++)if(e.equals(Le[n],s)){Le.splice(n,1);break}}else if(a)for(n=0;n<Le.length;n++)ue(Le[n],s)&&(Le.splice(n,1),n--)}})))))})),m.length>0&&(Se=[...m],(ee=r.findConnections({type:G})).forEach((function(t){var n={},i=-1;if("TRUE"===t.get(u.V_ISPREFERRED)&&o.indexOf(t.get(u.FROM))>-1&&(i=m.indexOf(t.get(u.TO)))>-1){if(n[g]=t.id,n[d]=t.get(u.TYPE),n[I]=[t.get(u.FROM)],n[A]=t.get(u.FROM),n[S]="TRUE"===t.get(u.V_ISRESERVED),n[C]="Undefined",n[E]=e.is(t.get(u.V_ISPOSITIONING))?[t.get(u.V_ISPOSITIONING)]:[],n[T]=e.is(t.get(u.V_REFPOSITION))?[t.get(u.V_REFPOSITION)]:"Undefined",e.is(t.get(u.V_SYMBOLICID))&&(n[P]=t.get(u.V_SYMBOLICID)),n[R]={},n[R][y]="",n[R][D]=[],n[O]={},n[O][y]="",n[O][D]=[],n[N]="Undefined",n[h]="Unknown",n[F]="Undefined",n[_]="Undefined",e.is(t.get(u.V_POSITIONSPEC))){let i=e.Json.decode(t.get(u.V_POSITIONSPEC));e.is(i[u.BU_POSITIONING])&&(n[R][y]=i[u.BU_POSITIONING][u.MATRIXTRANSLATIONUNIT]||"",delete i[u.BU_POSITIONING][u.MATRIXTRANSLATIONUNIT],delete i[u.BU_POSITIONING][u.MATRIXSTORAGEORDER],n[R][D]=Object.values(i[u.BU_POSITIONING]).map((t=>e.Json.encode(t)))),e.is(i[u.RES_POSITIONING])&&(n[O][y]=i[u.RES_POSITIONING][u.MATRIXTRANSLATIONUNIT]||"",delete i[u.RES_POSITIONING][u.MATRIXTRANSLATIONUNIT],delete i[u.RES_POSITIONING][u.MATRIXSTORAGEORDER],n[O][D]=Object.values(i[u.RES_POSITIONING]).map((t=>e.Json.encode(t)))),n[N]=e.is(i[u.APPLICABILITYMODE])?i[u.APPLICABILITYMODE]:"Undefined",n[h]=e.is(i[u.REFPOSITIONMODE])?i[u.REFPOSITIONMODE]:"Unknown",n[F]=e.is(i[u.RELBU_POSVER])?i[u.RELBU_POSVER]:"Undefined",n[_]=e.is(i[u.RELRES_POSVER])?i[u.RELRES_POSVER]:"Undefined"}(i=Se.indexOf(t.get(u.TO)))>-1&&Se.splice(i,1),(i=Se.indexOf(M))>-1&&Se.splice(i,1),te.push(n[g]),ne.push(n[P]),ie.push(n),$.push(n)}})),(ee=r.findConnections({type:Y})).forEach((function(t){var n={},i=-1,o=t.get(u.FROM),r=t.get(u.TO);if(te.indexOf(o)>-1&&(i=m.indexOf(r))>-1){n[g]=t.id,n[d]=t.get(u.TYPE);for(let e=0;e<ie.length;e++)if(o===ie[e][g]){n[I]=ie[e][I],n[A]=ie[e][A];break}if(n[C]="Undefined",n[E]=e.is(t.get(u.V_ISPOSITIONING))?[t.get(u.V_ISPOSITIONING)]:[],n[T]=e.is(t.get(u.V_REFPOSITION))?[t.get(u.V_REFPOSITION)]:"Undefined",e.is(t.get(u.V_SYMBOLICID))&&(n[P]=t.get(u.V_SYMBOLICID)),n[R]={},n[R][y]="",n[R][D]=[],n[O]={},n[O][y]="",n[O][D]=[],n[N]="Undefined",n[h]="Unknown",n[F]="Undefined",n[_]="Undefined",e.is(t.get(u.V_POSITIONSPEC))){n[R]={},n[O]={};let i=e.Json.decode(t.get(u.V_POSITIONSPEC));e.is(i[u.BU_POSITIONING])?(n[R][y]=i[u.BU_POSITIONING][u.MATRIXTRANSLATIONUNIT]||"",delete i[u.BU_POSITIONING][u.MATRIXTRANSLATIONUNIT],delete i[u.BU_POSITIONING][u.MATRIXSTORAGEORDER],n[R][D]=Object.values(i[u.BU_POSITIONING]).map((t=>e.Json.encode(t)))):(n[R][y]="",n[R][D]=[]),e.is(i[u.RES_POSITIONING])?(n[O][y]=i[u.RES_POSITIONING][u.MATRIXTRANSLATIONUNIT]||"",delete i[u.RES_POSITIONING][u.MATRIXTRANSLATIONUNIT],delete i[u.RES_POSITIONING][u.MATRIXSTORAGEORDER],n[O][D]=Object.values(i[u.RES_POSITIONING]).map((t=>e.Json.encode(t)))):(n[O][y]="",n[O][D]=[]),n[N]=e.is(i[u.APPLICABILITYMODE])&&i[u.APPLICABILITYMODE]?i[u.APPLICABILITYMODE]:"Undefined",n[h]=e.is(i[u.REFPOSITIONMODE])?i[u.REFPOSITIONMODE]:"Unknown",n[F]=e.is(i[u.RELBU_POSVER])?i[u.RELBU_POSVER]:"Undefined",n[_]=e.is(i[u.RELRES_POSVER])?i[u.RELRES_POSVER]:"Undefined"}(i=Se.indexOf(t.get(u.TO)))>-1&&Se.splice(i,1),oe.push(t.id),re.push(n[P]),ae.push(n),$.push(n)}})),(ee=r.findConnections({type:j})).forEach((function(t){var n={},i=t.get(u.FROM);t.get(u.TO);if(ne.indexOf(t.get(u.V_ISPOSITIONING))>-1&&o.indexOf(i)>-1){if(n[g]=t.id,n[d]=t.get(u.TYPE),n[I]=[t.get(u.FROM)],n[A]=t.get(u.FROM),n[C]=t.get(u.V_AVAILABILITYMODEONPRIMARYDETAIL),n[E]=e.is(t.get(u.V_ISPOSITIONING))?[t.get(u.V_ISPOSITIONING)]:[],n[T]=e.is(t.get(u.V_REFPOSITION))?[t.get(u.V_REFPOSITION)]:"Undefined",e.is(t.get(u.V_SYMBOLICID))&&(n[P]=t.get(u.V_SYMBOLICID)),e.is(t.get(u.V_POSITIONSPEC))){n[R]={},n[O]={};let i=e.Json.decode(t.get(u.V_POSITIONSPEC));e.is(i[u.BU_POSITIONING])?(n[R][y]=i[u.BU_POSITIONING][u.MATRIXTRANSLATIONUNIT],delete i[u.BU_POSITIONING][u.MATRIXTRANSLATIONUNIT],delete i[u.BU_POSITIONING][u.MATRIXSTORAGEORDER],n[R][D]=Object.values(i[u.BU_POSITIONING]).map((t=>e.Json.encode(t)))):(n[R][y]="",n[R][D]=[]),e.is(i[u.RES_POSITIONING])?(n[O][y]=i[u.RES_POSITIONING][u.MATRIXTRANSLATIONUNIT],delete i[u.RES_POSITIONING][u.MATRIXTRANSLATIONUNIT],delete i[u.RES_POSITIONING][u.MATRIXSTORAGEORDER],n[O][D]=Object.values(i[u.RES_POSITIONING]).map((t=>e.Json.encode(t)))):(n[O][y]="",n[O][D]=[]),n[N]=e.is(i[u.APPLICABILITYMODE])?i[u.APPLICABILITYMODE]:"Undefined",n[h]=e.is(i[u.REFPOSITIONMODE])?i[u.REFPOSITIONMODE]:"Unknown",n[F]=e.is(i[u.RELBU_POSVER])?i[u.RELBU_POSVER]:"Undefined",n[_]=e.is(i[u.RELRES_POSVER])?i[u.RELRES_POSVER]:"Undefined"}$.push(n)}})),(ee=r.findConnections({type:W})).forEach((function(t){var n={},i=t.get(u.FROM);t.get(u.TO);if(re.indexOf(t.get(u.V_ISPOSITIONING))>-1&&o.indexOf(i)>-1){if(n[g]=t.id,n[d]=t.get(u.TYPE),n[I]=[t.get(u.FROM)],n[A]=t.get(u.FROM),n[C]=t.get(u.V_AVAILABILITYMODEONSECDETAIL),n[E]=e.is(t.get(u.V_ISPOSITIONING))?[t.get(u.V_ISPOSITIONING)]:[],n[T]=e.is(t.get(u.V_REFPOSITION))?[t.get(u.V_REFPOSITION)]:"Undefined",e.is(t.get(u.V_SYMBOLICID))&&(n[P]=t.get(u.V_SYMBOLICID)),e.is(t.get(u.V_POSITIONSPEC))){n[R]={},n[O]={};let i=e.Json.decode(t.get(u.V_POSITIONSPEC));e.is(i[u.BU_POSITIONING])?(n[R][y]=i[u.BU_POSITIONING][u.MATRIXTRANSLATIONUNIT],delete i[u.BU_POSITIONING][u.MATRIXTRANSLATIONUNIT],delete i[u.BU_POSITIONING][u.MATRIXSTORAGEORDER],n[R][D]=Object.values(i[u.BU_POSITIONING]).map((t=>e.Json.encode(t)))):(n[R][y]="",n[R][D]=[]),e.is(i[u.RES_POSITIONING])?(n[O][y]=i[u.RES_POSITIONING][u.MATRIXTRANSLATIONUNIT],delete i[u.RES_POSITIONING][u.MATRIXTRANSLATIONUNIT],delete i[u.RES_POSITIONING][u.MATRIXSTORAGEORDER],n[O][D]=Object.values(i[u.RES_POSITIONING]).map((t=>e.Json.encode(t)))):(n[O][y]="",n[O][D]=[]),n[N]=e.is(i[u.APPLICABILITYMODE])?i[u.APPLICABILITYMODE]:"Undefined",n[h]=e.is(i[u.REFPOSITIONMODE])?i[u.REFPOSITIONMODE]:"Unknown",n[F]=e.is(i[u.RELBU_POSVER])?i[u.RELBU_POSVER]:"Undefined",n[_]=e.is(i[u.RELRES_POSVER])?i[u.RELRES_POSVER]:"Undefined"}$.push(n)}}))),$},oe=function(t){var i,o,s,c,l=n.getBehavior("RootsBehavior"),u=[],d=[],g=[],f=[],m=[],I=[],p=[],L=[],P=[],S=[],E=[],O=[],R=[];try{return i=r.getReference(t.sysPID),o=r.getReference(t.scopedMfgItemPID),s=r.getReference(t.resourceItemPID),c=l.getRootFilter(o.id),c=e.is(c)?c.originalFilterQuery:null,ee(t,o,c,g,f,u,d),g.length<=1&&a.getNLSValue("BuildUp.Error.NoMBOM"),f.length<=1&&a.getNLSValue("BuildUp.Error.NoMBOM"),te(t,i,p,L,m,I),p.length<=1&&a.getNLSValue("BuildUp.Error.NoOperations"),L.length<=1&&a.getNLSValue("BuildUp.Error.NoOperations"),!r.isAuthoringMode()&&e.is(s)?ne(t,s,E,O,P,S):Se=e.is(s)?[s.id]:[],R=ie([],i,m,I,o,u,d,s,P),{version:"2.0",mfgItemReferences:g,mfgItemInstances:f,mfgOperationReferences:p,mfgOperationInstances:L,mfgResourceReferences:E,mfgResourceInstances:O,connections:R}}catch(e){console.error(e.stack),console.error(e.message)}},re=function(e,t){var i=this;return new Promise((function(o,r){var a,c={},l=null;n.notify("startProgress",c),s.connectBuildUpSession(e.sysPID,e.scopedMfgItemPID).then((function(u){Le=[],pe=[],Pe=[],se=u.initBuildupModelers,ce=u.processBuildUpAPI,a=oe(e),se.load(JSON.stringify(a)).then((function(){l=s.retriveSessionIdForSelected(e.sysPID,e.scopedMfgItemPID),n.notify("stopProgress",c),i.startEventListener(),ce.subscribeToBuildUpResultChange((function(e){console.log(e),t(Z),Z=null})),o([l,Se])}),(function(){n.notify("stopProgress",c),ae.call(i),r([l])}))}),(function(){n.notify("stopProgress",c),ae.call(i),r([l])}))}))},ae=function(){se=ce=$=void 0,Le=[],pe=[],Pe=[],De=0,e.is(this)&&this.stopEventListener(),Ae=[]},{onStart:function(t){fe=e.extend(t,fe)},onStop:function(){this.resetAllSessions()},isAuthoringMode:function(){return r.isAuthoringMode()},getBuildUpCmd:function(){return Ie.getCommandCheckHeader("BuildUpReviewModeCmd",me)},initBuildUpSession:function(e,t){return re.call(this,e,t)},retriveActiveSession:function(){return{session:s.retriveActiveSession()}},retriveActiveSessionId:function(){return s.retriveActiveSessionId()},resetActiveSession:function(){e.is(this)?ae.call(this):ae(),s.resetActiveSession()},resetAllSessions:function(){e.is(this)?ae.call(this):ae(),s.resetAllSessions()},getContextItemRIRPaths:function(){return Le},databasePlugin:r,delPXPSessionPlugin:s,startEventListener:function(){var n=s.retriveActiveSession();e.is(n)&&null!==n&&(Ae.push(t.addExternalListener("startProgress",this.onStartProgress)),Ae.push(t.addExternalListener("stopProgress",this.onStopProgress)))},stopEventListener:function(){for(let e=0;e<Ae.length;e++)t.removeExternalListener(Ae[e])},onStartProgress:function(){De++,1===De&&(ye=c.subscribeToModelChanges(Oe),e.is(se)&&($=se.createPXPTransaction(),Ne($)))},onStopProgress:function(){De--,0===De&&(c.unSubscribeToModelChanges(ye),e.is(se)&&se.commitTransaction($).then((e=>{console.log(e)})).catch((e=>{console.log(e)})))}}}}})),define("DS/DELPPWProcessModelBehaviors/ProcessImplementBehavior",["UWA/Core","UWA/Class/Promise","DS/DELPPWProcessModelBehaviors/ProcessImplementBehaviorBase","text!DS/DELPPWProcessModelBehaviors/assets/json/NonModelAttributeInfo.json"],(function(e,t,n,i){"use strict";return{plugins:["DatabasePlugin","AttributePlugin","ResourcePlugin","ProcessImplementPlugin","MfgItemPlugin","DicoPlugin","WebServicePlugin"],creator:function(t,o,r,a,s,c,l,u,d){const g=["DELFmiContQuantity_Area.V_ContQuantity","DELFmiContQuantity_Length.V_ContQuantity","DELFmiContQuantity_Mass.V_ContQuantity","DELFmiContQuantity_Volume.V_ContQuantity","DELLmiUsageQuantity_Ratio.V_UsageQuantityRatio"];let f=new n(t,o,r,a,s,c,l,u,d);return e.extend(f,{onStart:function(){var t=e.Json.decode(i);for(let e in t)"MfgProductionPlanning.V_usage"===e?t[e].NLS=s.getNLSValue("ImplementBehavior.ImplementLink.Role"):"MfgProductionPlanning.V_DimensionType"===e?(t[e].NLS=s.getNLSValue("ImplementBehavior.ImplementLink.DimensionType"),t[e].AuthorizedValues=[{Name:"Ratio",NLS:s.getNLSValue("ImplementBehavior.ImplementLink.Ratio")},{Name:"Dimension",NLS:s.getNLSValue("ImplementBehavior.ImplementLink.Dimension")}]):"MfgProductionPlanning.usagePoint"===e?t[e].NLS=s.getNLSValue("ImplementBehavior.ImplementLink.UsagePoint"):"MfgProductionPlanning.V_Action"===e?t[e].NLS=s.getNLSValue("ImplementBehavior.ImplementLink.Action"):"DELLmiRichText.V_RichText"===e?t[e].NLS=s.getNLSValue("ImplementBehavior.ImplementLink.RichText"):"MfgProductionPlanning.V_CustoRole"===e&&(t[e].NLS=s.getNLSValue("ImplementBehavior.Instance.ServiceProcessRole"));a.addAttributeInfo(t),u.addTypeExtnCustomInterface("ProcessImplementLinkOcc","MfgProductionPlanning")},isImplementLinkValidForOccPath:function(e,t,n){return c.isImplementLinkValidForOccPath(e,t,n)},getRoleFromModelOrComputed:function(e){return c.getRoleFromModelOrComputed(e)},getOotbRoleFromCustoRole:function(e){return c.getOotbRoleFromCustoRole(e)},getCustoRoleFromNLS:function(e){return c.getCustoRoleFromNLS(e)},getRefQuantityAttribute:function(e){return c.getRefQuantityAttribute(e)},getQuantityInfoFromConnection:function(e){return c.getQuantityInfoFromConnection(e)},getQuantityInfoFromModel:function(e){return c.getQuantityInfoFromModel(e)},getQuantityAttributeFromModel:function(e){return c.getQuantityAttributeFromModel(e)},getActionsFromConnection:function(e){return c.getActionsFromConnection(e)},getImpactedObjects:function(t,n,i,o){var r=[];return e.is(c.getImpactedObjects)&&(r=c.getImpactedObjects(t,n,i,o)),r},getConnectedObjects:function(t,n,i,o){var r=[];return e.is(c.getConnectedObjects)&&(r=c.getConnectedObjects(t,n,i,o)),r},findUpperScopeLinks:function(e){return c.findUpperScopeLinks(e)},findUpperPartialScopeLinks:function(e){return c.findUpperPartialScopeLinks(e)},validateTotalQtyConsumed:function(t,n,i){var a,l,u,f,m,I,p,L,P={};L=function(t){var n=!1;return e.is(t)&&(n="Add"===t||"Add"===(t=c.getOotbRoleFromCustoRole(t))),n},n=n||{},u=Object.keys(n);let S=c.getRoleFromModelOrComputed(t);if(I=e.is(S.usage)?S.usage:null,u.forEach((function(e){g.some((function(t){var i=!1;return e===t&&(i=!0,f=n[t]),i})),"MfgProductionPlanning.V_usage"===e&&(m=n[e])})),e.is(m)||(m=I),p=c.getQuantityConsumedInfo(t),e.is(f)&&L(m)&&e.is(p.qtyConsumedInfo)){let n=p.InstanceQtyAttrFullName,u=c.getQuantityAttributeFromModel(t),g="";e.is(u)&&L(I)&&(g=u.value),a={instQty:p.instQty,inputQty:f,linkQty:g,totalQtyConsumed:p.totalConsumedQty,attrFullName:n},l={url:"dsmfg/private/V0/MfgElement/connection/validateTotalQtyConsumed",method:"POST",data:e.Json.encode(a),context:self,onComplete:function(n){if(o.notify("stopProgress",P),e.is(n)&&e.is(n.OverConsumedValue)){let e=r.getConnection(t).get("to"),o=r.getReferenceModel(e[e.length-1]),a=n.Dimension,c=n.OverConsumedValue.split(" "),l=n.InstanceQty.split(" "),u=c[1];c[1]=l[1]=s.getNLSForUnit(a,u);let d={OverConsumedValue:c.join(" "),InstanceQtyValue:l.join(" "),itemName:o.get("PLMEntity.V_Name")};i(d)}else i()},onFailure:function(){o.notify("stopProgress",P),i()}},o.notify("startProgress",P),d.webServiceRequest(l)}else i()}})}}}));