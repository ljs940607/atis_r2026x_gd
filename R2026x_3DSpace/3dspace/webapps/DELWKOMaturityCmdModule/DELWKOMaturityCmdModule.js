define("DS/DELWKOMaturityCmdModule/DELWKOMaturityToastMessage",["UWA/Class","DS/Controls/Button","DS/DELPPWWebServices_FD02/WebserviceUtils"],(function(t,e,n){"use strict";return t.extend({contentToastView:null,contentView:null,init:function(t){this.contentToastView=UWA.createElement("div",{id:"toastMessage"}).inject(t)},onClose:function(){var t=this;t.contentToastView&&(t.contentToastView.className=t.contentToastView.className.replace("show",""))},buildToastMessage:function(t,i){var o=this;o.contentToastView.getChildren().length&&o.contentToastView.removeChild(o.contentToastView.getChildren()[0]),o.contentView=UWA.createElement("div");var a=document.createElement("img"),s="",r="";0===t?(s="I_Info",r="#f1f3f4"):1===t?(s="I_Warning",r="#ffe893"):2===t?(s="I_Error",r="#fff0ee"):3===t&&(s="I_Success",r="#edf6eb"),a.setAttribute("src",n.get3DSpaceUrl()+"/webapps/ParameterizationSkeleton/assets/icons/"+s+".png"),o.contentView.setStyles({"background-color":r}),o.contentView.setHTML(i),o.contentView.prepend(a);var l=new e({displayStyle:"icon",icon:{iconName:"close",fontIconFamily:WUXManagedFontIcons.Font3DS},iconSize:"0.5",onClick:function(){o.onClose.call(o)}});return l.elements.container.setStyles({"border-style":"none"}),o.contentView.appendChild(l.elements.container),o.contentView.inject(o.contentToastView),o.contentToastView},showToastMessage:function(t,e){var n=this;n.buildToastMessage(t,e),""===n.contentToastView.className&&(n.contentToastView.className="show",setTimeout((function(){n.contentToastView.className=n.contentToastView.className.replace("show","")}),4e3))}})})),define("DS/DELWKOMaturityCmdModule/DELWKOMaturityModalWidget",["UWA/Class","DS/UIKIT/Modal","DS/Controls/Button","DS/DELWKOMaturityCmdModule/DELWKOMaturityToastMessage","i18n!DS/DELWKOMaturityCmdModule/assets/nls/DELWKOMaturityModalWidget","css!UIKIT/UIKIT.css","css!DS/DELWKOMaturityCmdModule/assets/css/DELWKOMaturityModalView.css","css!DS/DELWKOMaturityCmdModule/assets/css/DELWKOMaturityToastMessage.css"],(function(t,e,n,i,o){"use strict";const a=Object.freeze({OK:1,OKCANCEL:2,OKCLOSE:3,CLOSE:4});return t.extend({init:function(t){this.options=t},destroyModal:function(){this.modal.destroy()},buildModal:function(){var t=this,a=UWA.createElement("div");a.class="contentModalView",t.options.content.inject(a),t.ToastMessage=new i(a),t.ToastMessage.contentToastView.setStyles({border:"1px solid black",position:"absolute","z-index":"1",bottom:"50px",width:"80%","margin-left":"10%"});var s=UWA.createElement("div");s.class="footView",s.setStyles({display:"flex","align-items":"baseline","flex-flow":"row",width:"100%","margin-left":"40%"}),t.buildButtonsFooter(s),this.modal=new e({className:"NotifModal",closable:!0,visible:!0,header:t.options.title,body:a,footer:s,events:{onHide:function(){UWA.is(t.options.CancelButtonClick)&&t.options.CancelButtonClick(),UWA.is(t.options.CloseButtonClick)&&t.options.CloseButtonClick(),t.destroyModal()}}}).inject(document.body),this.modal.elements.content.setStyle("width","650px");var r=new UWA.Element("div");return r.inject(s),new n({displayStyle:"icon",icon:{iconName:"help",fontIconFamily:WUXManagedFontIcons.Font3DS},iconSize:"0.5",onClick:function(){t.ToastMessage.showToastMessage(0,t.options.info)}}).inject(r).elements.container.setAttribute("title",o.Help),this},buildButtonsFooter:function(t){var e,i=this;if(i.options.modalView===a.OK||i.options.modalView===a.OKCLOSE||i.options.modalView===a.OKCANCEL){var s=new n({type:"standard",label:o.OK,displayStyle:"normal",onClick:function(t){void 0===i.options.OKButtonClick()&&i.modal.destroy()}});s.elements.container.setAttribute("title",o.OK),s.elements.container.setStyles({"text-align":"center"}),s.elements.container.style["background-color"]="#368EC4",s.elements.text.style.color="white",s.inject(t)}i.options.modalView===a.OKCLOSE&&((e=new n({type:"standard",label:o.Close,displayStyle:"normal",onClick:function(t){i.options.CancelButtonClick(),i.modal.destroy()}})).elements.container.setAttribute("title",o.Close),e.elements.container.setStyles({display:"inline-block","margin-left":"5px","text-align":"center"}),e.inject(t));if(i.options.modalView===a.OKCANCEL){var r=new n({type:"standard",label:o.Cancel,displayStyle:"normal",onClick:function(t){i.options.CancelButtonClick(),i.modal.destroy()}});r.elements.container.setAttribute("title",o.Cancel),r.elements.container.setStyles({display:"inline-block","margin-left":"5px","text-align":"center"}),r.inject(t)}i.options.modalView===a.CLOSE&&((e=new n({type:"standard",label:o.Close,displayStyle:"normal",onClick:function(t){i.options.CloseButtonClick(),i.modal.destroy()}})).elements.container.setAttribute("title",o.Close),e.elements.container.setStyles({display:"inline-block","margin-left":"5px","text-align":"center"}),e.inject(t))}})})),define("DS/DELWKOMaturityCmdModule/DELWKOMaturityCmdUI",["UWA/Core","UWA/Class","DS/UIKIT/Mask","UWA/Class/Promise","DS/WAFData/WAFData","DS/Controls/Label","DS/Controls/ComboBox","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/DELWKOMaturityCmdModule/DELWKOMaturityModalWidget","DS/DELWKONavigationServices/DELWKONavigateUtil","DS/DELPPWResourceServices_FD02/ResourceUtils","DS/DELWKOModelServices/DELWKOCollectionUtilsCloud","DS/DELWKODicoServices/DELWKODicoUtils","i18n!DS/DELWKOMaturityCmdModule/assets/nls/DELWKOMaturityCmdUI","i18n!DS/DELWKOMaturityCmdModule/assets/nls/DELWKOMaturityGrid","i18n!DS/DELWKOApp/assets/nls/NLS","css!DS/DELWKOMaturityCmdModule/assets/css/DELWKOMaturityCmdUI.css"],(function(t,e,n,i,o,a,s,r,l,c,d,u,m,g,f,h,p,v){"use strict";return function(e,a,s,g,w,C,E){var D=[],b=void 0,y=void 0,S=void 0,A=void 0,M=function(e){var n=t.createElement("div",{class:"egraph-toolbar"});n.inject(e,"top");var i=m.getIconURLFromKey("Refresh"),o=t.createElement("img",{src:i,class:"MaturityBar refresh-btn"});o.addEvent("click",(function(){for(var t=document.getElementsByClassName("lcm-maturity-content")[0],e=t.childNodes;e.length>0;){var n=e[e.length-1];t.removeChild(n),e=t.childNodes}O(t)})),o.inject(n)},L=function(e,s){if(t.is(e)&&t.is(s)){n.mask(A);var r=[],l=function(e,n){var o=!1;return new i((function(i,s){var r=widget.getBool("updateActualTime");if(t.is(r)&&!0===r){var l="DELLmiUPRSystemReference";t.is(e)&&"EXECHEADER"===e.get("PPRTYPE")&&(l="DELLmiOperationUPRReference");var c=new Map;if(t.is(e)&&"STEP"!=e.get("PPRTYPE")){if("start_execution"===n){var d=e.get(l+".V_ActualStartDate");t.is(d)||c.set(l+".V_ActualStartDate",C.getFormattedDate(new Date,!0))}if("complete_execution"===n){var u=e.get(l+".V_ActualEndDate");t.is(u)||c.set(l+".V_ActualEndDate",C.getFormattedDate(new Date,!0)),t.is(e)&&"EXECHEADER"===e.get("PPRTYPE")&&c.set(e.getQuantityExtension()+".V_CompletedQuantity",e.get(e.getQuantityExtension()+".V_InitialQuantity"))}}var m=[];for(var[g,f]of c.entries()){var h=E.getAttributeInfo(g);C.isDate(h)&&(f=new Date(f).toISOString());var p={instOrRef:"reference"};p.dataIndex=g,p.objectToBeModified=e,p.attributeInfo=h,p.attributeName=h.FullName,p.newValue=f,m.push(p)}if(t.is(m)&&m.length>0){o=!0;var v=a.getBehavior("ModelBehavior");t.is(v)&&v.updateModelAttribute_v2(e.get("PID"),m,{popupMessage:!1,onComplete:function(){i(o)}})}else i(o)}else i(o)}))}(e,s);r.push(l),t.Promise.all(r).then((function(i){var r=!1;t.is(i)&&i.length>0&&(r=i[0]);var l=e.url("no_mask")+"/transition/"+s;o.authenticatedRequest(l,{headers:e.getHeaders(),method:"POST",onComplete:function(i){n.unmask(A);for(var o=A.childNodes;o.length>0;){var s=o[o.length-1];A.removeChild(s),o=A.childNodes}O(A);i=t.Json.decode(i);var r={};r.current=f.getStatesNlsFromDico(i.state),t.is(e)&&"WORKORDER"===e.get("PPRTYPE")&&(r.rejectReason=void 0);var l={};l.data=r,l.forceUpdate=!0,u.options.collectionUtils.updateRef_v2(e.get("PID"),l);var c=u.options.collectionUtils.getInstancesFromCollection(e.get("PID"));t.is(c)&&c.length>0&&c.forEach((t=>{var e=u.options.collectionUtils.getReferenceFromCollection(t.get("isInstanceOf"));u.options.collectionUtils.getAttributesFromReference(e,{onComplete:function(t){var n={};n.current=f.getStatesNlsFromDico(t.state);var i={};i.data=n,i.forceUpdate=!0,u.options.collectionUtils.updateRef_v2(e.get("PID"),i)}})})),a.info(h.Success),a.notify("authoringMode")},onFailure:function(i,o){t.is(r)&&!0===r&&function(e,n){if(t.is(e)&&t.is(n)){var i=widget.getBool("updateActualTime");if(t.is(i)&&!0===i){var o="DELLmiUPRSystemReference";t.is(e)&&"EXECHEADER"===e.get("PPRTYPE")&&(o="DELLmiOperationUPRReference");var s=new Map;"start_execution"===n&&s.set(o+".V_ActualStartDate",null),"complete_execution"===n&&(s.set(o+".V_ActualEndDate",null),t.is(e)&&"EXECHEADER"===e.get("PPRTYPE")&&s.set(e.getQuantityExtension()+".V_CompletedQuantity",0));var r=[];for(var[l,c]of s.entries()){var d=E.getAttributeInfo(l),u={instOrRef:"reference"};u.dataIndex=l,u.objectToBeModified=e,u.attributeInfo=d,u.attributeName=d.FullName,u.newValue=c,r.push(u)}if(t.is(r)&&r.length>0){var m=a.getBehavior("ModelBehavior");t.is(m)&&m.updateModelAttribute_v2(e.get("PID"),r,{popupMessage:!1,onComplete:function(){}})}}}}(e,s),n.unmask(A),o=t.Json.decode(o),a.warn(h.Fail+" : "+o.message),t.is(b.toggleCmdId)&&a.notify("toggleCmdCheckHeaderState",{cmdName:b.toggleCmdId,cmdState:!1})}})}))}},O=function(e){var n=[];D.forEach((t=>{var e=W(t);n.push(e)})),t.Promise.all(n).then((function(n){t.is(n)&&n.length>0&&(1===n.length?R(n[0],e):I(n,e))}))},W=function(e){return new i((function(n,i){if(t.is(e)){var s=e.url("no_mask")+"/transition";o.authenticatedRequest(s,{method:"GET",onComplete:function(i){var o=t.Json.decode(i);o.PID=e.get("PID"),t.is(o)&&n(o)},onFailure:function(){a.warn(h.Fail),i()}})}}))},T=function(){t.is(b.toggleCmdId)&&a.notify("toggleCmdCheckHeaderState",{cmdName:b.toggleCmdId,cmdState:!1})},x=function(){y.getTreeDocument().getAllDescendants().forEach((t=>{var e=t.options.data,n=e.model;e.transitions.forEach((t=>{var i=t.event,o=t.nextState;f.getStatesNlsFromDico(o)===e.nextState&&(A=document.getElementsByClassName("lcm-maturity-content")[0],L(n,i))})),delete y.getTypeRepresentationFactory().typeReps[n.get("PID").toString()]}))},N=function(e,n){if(t.is(n)){n.srcElement.textContent;D.forEach((t=>{L(t,e)}))}},k=function(e,n){A=n;var i=t.createElement("div",{class:"lcm-svg-container"});i.inject(n);var o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("id","svgCanvas"),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("xmlns:state","http://www.lc.com/state"),i.appendChild(o);var a=document.createElementNS("http://www.w3.org/2000/svg","defs");o.appendChild(a);var s=document.createElementNS("http://www.w3.org/2000/svg","marker");s.setAttribute("id","down"),s.setAttribute("orient","-90"),s.setAttribute("markerWidth","10"),s.setAttribute("markerHeight","8"),s.setAttribute("refX","9"),s.setAttribute("refY","4"),a.appendChild(s);var r=document.createElementNS("http://www.w3.org/2000/svg","marker");r.setAttribute("id","up"),r.setAttribute("orient","90"),r.setAttribute("markerWidth","10"),r.setAttribute("markerHeight","8"),r.setAttribute("refX","9"),r.setAttribute("refY","4"),a.appendChild(r);var l=document.createElementNS("http://www.w3.org/2000/svg","marker");l.setAttribute("id","right"),l.setAttribute("markerWidth","10"),l.setAttribute("markerHeight","8"),l.setAttribute("refX","9"),l.setAttribute("refY","4"),a.appendChild(l);var c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d","M 3 1 L 10 4 L 3 7"),s.appendChild(c);var d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d","M 3 1 L 10 4 L 3 7"),r.appendChild(d);var u=document.createElementNS("http://www.w3.org/2000/svg","path");u.setAttribute("d","M 3 1 L 10 4 L 3 7"),l.appendChild(u);var m=e;if(t.is(m)){var g=0,h=m.currentState;m.div.offsetLeft,m.div.offsetTop,m.div.getBoundingClientRect();m.transitions.forEach((t=>{if(h===t.nextState){var e=(a=m.div).getBoundingClientRect(),n=a.offsetLeft,i=a.offsetTop;(s=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("marker-end","url(#up)"),s.setAttribute("d","M "+n+" "+(i+e.height/2)+" L "+(n-e.width/4)+" "+(i+e.height/2)+" L "+(n-e.width/4)+" "+(i-e.height/2)+" L "+(n+e.width/4)+" "+(i-e.height/2)+" L "+(n+e.width/4)+" "+i+" M "+(n+e.width/4)+" "+i+" Z"),s.setAttribute("fill","none"),s.setAttribute("stroke","gray"),o.appendChild(s),(r=document.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("class","transitionText"),r.setAttribute("fill","dodgerblue"),r.setAttribute("font-family","Arial"),r.setAttribute("font-size","16px"),r.setAttribute("text-anchor","start"),r.setAttribute("x",n-50),r.setAttribute("y",e.height-20),r.textContent=">> "+f.getTransitionsNlsFromDico(t.event),r.onclick=N.bind(null,t.event),o.appendChild(r)}else{e=(a=t.currentdiv).getBoundingClientRect(),n=a.offsetLeft,i=a.offsetTop;var a,s,r,l=t.div,c=l.getBoundingClientRect(),d=l.offsetLeft,u=l.offsetTop;if(0===g)(s=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("marker-end","url(#right)"),s.setAttribute("d","M "+(n+e.width)+" "+(i+e.height/2)+" L "+d+" "+(u+c.height/2)+" M "+d+" "+(u+c.height/2)+" Z"),s.setAttribute("fill","none"),s.setAttribute("stroke","gray"),o.appendChild(s),(r=document.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("class","transitionText"),r.setAttribute("fill","dodgerblue"),r.setAttribute("font-family","Arial"),r.setAttribute("font-size","16px"),r.setAttribute("text-anchor","start"),r.setAttribute("x",n+e.width),r.setAttribute("y",c.height),r.textContent=">> "+f.getTransitionsNlsFromDico(t.event),r.onclick=N.bind(null,t.event),o.appendChild(r);else(s=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("marker-end","url(#down)"),s.setAttribute("d","M "+(n+e.width/2)+" "+i+" L "+(n+e.width/2)+" "+(u+c.height+c.height/2)+" L "+(d+c.width/2)+" "+(u+c.height+c.height/2)+" L "+(d+c.width/2)+" "+(u+c.height)+" M "+(d+c.width/2)+" "+(u+c.height)+" Z"),s.setAttribute("fill","none"),s.setAttribute("stroke","gray"),o.appendChild(s),(r=document.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("class","transitionText"),r.setAttribute("fill","dodgerblue"),r.setAttribute("font-family","Arial"),r.setAttribute("font-size","16px"),r.setAttribute("text-anchor","start"),r.setAttribute("x",n+e.width+u),r.setAttribute("y",u+c.height+c.height/2+15),r.textContent=">> "+f.getTransitionsNlsFromDico(t.event),r.onclick=N.bind(null,t.event),o.appendChild(r)}t.event;g++}))}},K=function(e){"title"===e.dataIndex&&(e.getCellSemantics=function(e){var n=e.nodeModel;if(t.is(n)){var i=n.options.data;if(t.is(i)){var o=i.model;return{icon:m.getIconURLFromKey(o.get("type"))}}}}),"nextState"===e.dataIndex?(e.width="150",e.alignment="center",e.editableFlag=!0,e.getCellTypeRepresentation=function(e){var n=e.nodeModel;if(t.is(n)){var i=n.options.data;if(t.is(i))return i.model.get("PID")}}):e.typeRepresentation="string"},I=function(e,n){n.style.overflow="clip",n.style["overflow-y"]="auto";for(var i=new r,o=[{id:"title",nls:p.title},{id:"type",nls:p.type},{id:"currentState",nls:p.current},{id:"nextState",nls:p.next}],a=[],s=o.length,u=0;u<s;u++){var m={editableFlag:!1,sortableFlag:!0,resizableFlag:!0};m.dataIndex=o[u].id,m.text=o[u].nls,K(m),a.push(m)}y=new c({identifier:"DELWKOMaturityCmdUI",treeDocument:i,columns:a}),V(e),i.prepareUpdate();var g=0;if(D.forEach((t=>{var n={};n.title=t.get("V_Name"),n.type=v["Type."+t.get("type")],n.currentState=t.get("current"),n.nextState="";var o={};(o=Object.assign(n,{})).model=t,o.transitions=e[g].transitions;var a=new l({grid:n,data:o});i.addChild(a),g++})),i.pushUpdate(),y.getContent().style.top=null,y.getContent().style.bottom=null,y.getContent().style.height="300px",y.getContent().style.position="relative",y.inject(n),!t.is(S)){var f={};f.content=n,f.modalView=2,f.title=h.title,f.info=h.info,f.OKButtonClick=x,f.CancelButtonClick=T,(S=new d(f)).buildModal()}},V=function(t){var e={};t.forEach((t=>{var n={None:""};t.transitions.forEach((t=>{n[f.getStatesNlsFromDico(t.nextState)]=f.getStatesNlsFromDico(t.nextState)})),e[t.PID.toString()]={stdTemplate:"enumCombo",semantics:{possibleValues:n,valueType:"enumString"}}})),e=Object.assign(e,{}),y.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(e))},R=function(e,n){var i=t.createElement("div",{class:"lcm-state-container"});i.inject(n);var o=e;if(t.is(o)){var a=o.currentState,s=t.createElement("span",{class:"lcm-state-text",html:f.getStatesNlsFromDico(a)}),r=t.createElement("div",{class:"lcm-state-base lcm-state-current lcm-state",styles:{backgroundColor:f.getStatesNlsFromDico(a+".color.active")}});if(o.div=r,s.inject(r),r.inject(i),o.transitions.forEach((e=>{var n=e.event,o=e.nextState;if(a!=o){t.createElement("div",{class:"lcm-state-connector"}).inject(i);var s=t.createElement("span",{class:"lcm-state-text",html:f.getStatesNlsFromDico(o)}),l=t.createElement("div",{class:"lcm-state-base lcm-state-transitionable lcm-state",styles:{backgroundColor:f.getStatesNlsFromDico(o+".color.inactive")}});l.setData("evtValue",n),l.addEventListener("click",(function(n){var i=n.target.getParent();if(t.is(i)){var o=i.getData("evtValue");t.is(o)&&D.forEach((t=>{L(t,e.event)}))}})),e.currentdiv=r,e.div=l,s.inject(l),l.inject(i)}})),!t.is(S)){var l={};l.content=n.getParent(),l.modalView=4,l.title=h.title+" - "+D[0].get("V_Name"),l.info=h.info,l.CloseButtonClick=F,(S=new d(l)).buildModal()}k(e,n)}},F=function(){t.is(b.toggleCmdId)&&a.notify("toggleCmdCheckHeaderState",{cmdName:b.toggleCmdId,cmdState:!1})};return{initDatas:function(e){!function(e){b=e,D=e.refModels;var n=t.createElement("div",{class:"modal-view-content"}),i=t.createElement("div",{class:"lcm-maturity-content"});i.style.height="160px",i.inject(n),M(n),O(i)}(e)}}}})),define("DS/DELWKOMaturityCmdModule/DELWKOMaturityCmdModule",["UWA/Core","DS/DELWKOMaturityCmdModule/DELWKOMaturityCmdUI","DS/DELWKOModelServices/DELWKOCollectionUtilsCloud"],(function(t,e,n){"use strict";return{behaviors:["UXFactoryBehavior","ModelBehavior","ResourceBehavior","SelectionBehavior","EditAttributeBehavior","LinkBehavior","ProductFlowLinkBehavior","RootsBehavior"],creator:function(e,i,o,a,s,r,l,c,d){return{name:"DELWKOMaturityCmdModule",onStart:function(e,o){!function(e){var o=[];s.getSelections().forEach((e=>{e.forEach((e=>{var i=n.getReferenceFromCollection(e);if(!t.is(i)){var a=n.getInstanceFromCollection(e);t.is(a)&&(i=n.getReferenceModelFromInstance(a))}t.is(i)&&o.push(i)}))})),e.refModels=o,i.create("DELWKOMaturityCmdUI").initDatas(e)}(e),o()},onStop:function(){}}}}}));