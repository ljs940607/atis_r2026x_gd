define("DS/XSRCommonComponents/utils/OpenWithMenuProvider",["UWA/Class","UWA/Promise","DS/i3DXCompassPlatformServices/OpenWith","DS/XSRCommonComponents/utils/RequestUtil","DS/XSRCommonComponents/utils/Constants","DS/XSRCommonComponents/utils/TypeUtils","DS/XSRCommonComponents/utils/Utils"],(function(t,e,i,n,o,s,a){"use strict";return t.singleton({init:function(t){this.option=t},getOpenWithMenu:function(t){var n=[],s=new i;return new e(((e,i)=>{s.set3DXContent(this._buildContent(t.data)).retrieveCompatibleApps((function(t){t.forEach((function(t){t.name!=o.XSR_APP_ID&&n.push({type:"PushItem",title:t.text,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+t.fonticon,family:WUXManagedFontIcons.Font3DS},action:{callback:t.handler}})})),e(n)}))}))},_buildContent:function(t){var e={protocol:"3DXContent",version:"2.1",source:"ENOSPEC_AP",widgetId:widget.id,data:{items:[{envId:n.getPlatformId(),contextId:widget.getValue("Current_security_credentials")}]}};if(t.isRDFObject&&t.isRDFObject())e.data.items[0].serviceId=t.getRDFObjectOrigin(),e.data.items[0].objectId=t.getRDFID(),e.data.items[0].i3dx=t.geti3dxValue(),e.data.items[0].objectType=t.getRDFOpenWithType();else{var i=t.getTypeActualName?t.getTypeActualName():t[0].getAttributeValue("ds6wg:type_value"),c=[];if(s.isTechnicalSpecification(i)||a.isDocument(i))for(var u=a.getTechSpecTypeHierarchy(),m=0;m<u.length;m++){if(i===Object.keys(u[m])[0])c=Object.values(u[m])[0].split(",")}else c=a.isMEIItem(t)?[o.TYPE_VPMREFERENCE,o.MEI_INTERFACE]:[o.TYPE_VPMREFERENCE];e.data.items[0].serviceId=o.SERVICE_3DSPACE_NAME,e.data.items[0].objectId=t.getID?t.getID():t[0].getAttributeValue("id"),e.data.items[0].objectTaxonomies=c,e.data.items[0].objectType=i}return e}})}));