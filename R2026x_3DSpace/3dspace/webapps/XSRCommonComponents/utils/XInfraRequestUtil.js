define("DS/XSRCommonComponents/utils/XInfraRequestUtil",["UWA/Class/Model","UWA/Promise","DS/XSRCommonComponents/utils/RequestUtil","DS/XSRCommonComponents/utils/TypeUtils","DS/XSRCommonComponents/utils/TypeServicesUtil","DS/XSRCommonComponents/utils/Constants"],(function(e,t,n,s,r,i){"use strict";return e.extend({setup:function(e){this.id=e.id,this.securityContext=e.securityContext,this.xInfraAppVersion="v1",this.corpus="dsspec"},urlForInvoke:function(){return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.uriType+"/"+this.corpus+":"+this.id},urlForClasses:function(){return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.corpus+":"+this.id},urlForGet:function(e){var t=s.getKeyMapping(e);return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.corpus+":"+t+"/"+this.id},urlForGetSubTypes:function(e){if(this.id="getRawMaterialSubTypes")return i.RM_BASE_URL+"Raw_Material/getRawMaterialSubTypes";var t=s.getKeyMapping(e);return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.corpus+":"+t+"/"+this.id},urlForUpdate:function(e){var t=s.getKeyMapping(e);return"resources/"+this.xInfraAppVersion+"/modeler/"+this.corpus+"/"+this.corpus+":"+t+"/"+this.id},invoke:function(e){var s;this.uriType="invoke",s=e&&e.data?JSON.stringify(e.data):'{"dummy" : "dummy"}';var r=e&&e.mask?this.urlForInvoke()+"?$mask="+this.corpus+":"+e.mask:this.urlForInvoke();return new t((function(e,t){n.send3DSpaceRequest(r,"POST",{type:"json",headers:{"Content-type":"application/json"},data:s},(function(t){var n=t;t&&"string"==typeof t&&(n=JSON.parse(t),e(n)),e(n)}),t)}))},create:function(e){this.uriType="classes";var s=e&&e.data?JSON.stringify(e.data):"",r=e&&e.mask?this.urlForClasses()+"?$mask="+this.corpus+":"+e.mask:this.urlForClasses(),i={"Content-type":"application/json"};return this.securityContext&&(i.SecurityContext=this.securityContext),new t((function(e,t){n.send3DSpaceRequest(r,"POST",{type:"json",headers:i,data:s},(function(t){var n=t;t&&"string"==typeof t&&(n=JSON.parse(t),e(n)),e(n)}),t)}))},get:function(e){this.uriType="resources";var r=e&&e.typeName?e.typeName:"";return this.keyMappingForGetUpdate(e).then((i=>{var o=e&&e.mask?i+"?$mask="+this.corpus+":"+e.mask:i;return s.isFormulatedProduct(r)&&(o+="&$fields=dsspec:hasRecipe"),new t((function(e,t){n.send3DSpaceRequest(o,"GET",{type:"json",headers:{"Content-type":"application/json"}},e,t)}))}))},getSubtypes:function(e){var s=e&&e.typeName?e.typeName:"",r=this.urlForGetSubTypes(s);return new t((function(e,t){n.send3DSpaceRequest(r,"GET",{type:"json",headers:{"Content-type":"application/json"}},e,t)}))},getAllSubtypes:function(e){var s={};return s.prdType=e,new t((function(e,t){n.send3DSpaceRequest(i.TYPES_BASE_URL+"dsspec:getSubTypes","POST",{type:"json",headers:{"Content-type":"application/json"},data:JSON.stringify(s)},e,t)}))},getInstanceTypeData:function(e){return new t((function(t,s){n.send3DSpaceRequest(i.TYPES_BASE_URL+"dsspec:getInstanceAttributes","POST",{type:"json",headers:{"Content-type":"application/json"},data:JSON.stringify(e)},t,s)}))},saveBOMConfiguration:function(e,s){return new t((function(t,r){e[0].columnsVisibleFlag.tab=s,n.send3DSpaceRequest("resources/v1/modeler/specmanagement/admin/bom-configuration/","POST",{type:"json",headers:{"Content-type":"application/json"},data:e[0].columnsVisibleFlag?JSON.stringify(e[0].columnsVisibleFlag):""},t,r)}))},getBOMConfiguration:function(e){return new t((function(t,s){n.send3DSpaceRequest("resources/v1/modeler/specmanagement/admin/bom-configuration?tab="+e,"GET",{type:"json",headers:{"Content-type":"application/json"}},t,s)}))},getAttributes:function(e){return new t((function(t,s){n.send3DSpaceRequest("resources/v1/modeler/dsspec/invoke/dsspec:getCustomAttributes","POST",{type:"json",headers:{"Content-type":"application/json"},data:JSON.stringify(e)},t,s)}))},getDetails:function(e){let s=(new Date).getTime();return new t((function(t,r){n.send3DSpaceRequest(i.GET_UPDATE_DETAILS_URL+"read?tenant="+n.getPlatformId()+"&_="+s+"xrequestedwith=xmlhttprequest","POST",{type:"json",headers:{"Content-type":"application/json"},data:JSON.stringify(e)},t,r)}))},getAdminSavedConfiguration:function(e){var s=e,r=i.ADMIN_BASE_URL+"Config/AdminConfiguration/"+s;return new t((function(e,t){n.send3DSpaceRequest(r,"GET",{type:"json",headers:{"Content-type":"application/json"}},e,t)}))},update:function(e){this.uriType="resources";var s=e&&e.data?JSON.stringify(e.data):"",r=e&&e.typeActualName?e.typeActualName:e.typeName,i=e&&e.mask?this.urlForUpdate(r)+"?$mask="+this.corpus+":"+e.mask:this.urlForUpdate(r);return new t((function(e,t){n.send3DSpaceRequest(i,"PATCH",{type:"json",headers:{"Content-type":"application/json"},data:s},e,t)}))},keyMappingForGetUpdate:function(e){var n=this;return new t(((t,i)=>{var o=s.getKeyMapping(e.typeActual||e.typeName),a="resources/"+n.xInfraAppVersion+"/modeler/"+n.corpus+"/"+n.corpus+":"+o+"/"+n.id;"notfound"==o?(console.log(e.typeActual),(new r).isValidItemToOpen(e.typeActual||e.typeName).then((r=>{if(r.isValidType){var i={objectType:e.typeActual,displayType:e.typeName};r.isRawM?s.addToRawMaterial([i]):r.isDocument?s.addToDocuments([i]):s.addToPhysicalProduct([i]),a="resources/"+n.xInfraAppVersion+"/modeler/"+n.corpus+"/"+n.corpus+":PhysicalProduct/"+n.id,t(a)}}))):"Drawing"==o?(a="resources/"+n.xInfraAppVersion+"/modeler/dsdrw/dsdrw:Drawing/"+n.id,t(a)):t(a)}))}})}));