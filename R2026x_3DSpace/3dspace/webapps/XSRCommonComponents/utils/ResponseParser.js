define("DS/XSRCommonComponents/utils/ResponseParser",["UWA/Core"],(function(e){return{attributesParser:function(e,s){if(!Array.isArray(e))throw new Error("Ouups ! invalid input");for(var r={},a=e,t=0;t<a.length;t++){var i=a[t],n=i.name;switch(i.format&&"ds6w_facet"===i.format&&(n=i.name.split("/").pop()),s&&n.startsWith("ds6w")&&Array.isArray(s.classes)&&s.properties&&(-1===s.classes.indexOf(n)&&s.classes.push(n),Array.isArray(s.withNlsProp)&&-1!==s.withNlsProp.indexOf(n)&&(s.properties[n]||(s.properties[n]=[]),-1===s.properties[n].indexOf(i.value)&&s.properties[n].push(i.value))),n){case"resourceid":r.resourceid=i.value,r.physicalid=i.value;break;case"type_icon_url":r.icons||(r.icons=[]),r.icons.push(i.value);break;case"preview_url":case"thumbnail_2d":r.thumbnail=i.value;break;case"ds6w:type":r["ds6w:type"]=i.value,r["ds6w:type_value"]=i.value;break;case"ds6w:status":r["ds6w:status_value"]=i.value,r["ds6w:status"]=i.value;break;case"ds6w:isLastRevision":r.isLastVersion="boolean"==typeof i.value?i.value:"TRUE"===i.value.toUpperCase(),r["ds6w:isLastRevision"]=r.isLastVersion;break;case"bo.PLMReference.v_versionid":r.versionid=i.value;break;default:r[n]=i.value}}return r},parseFetchResult:function(e,s){var r=e.results||[],a=[],t=this,i=null;return s&&(i={withNlsProp:s,classes:[],properties:{}}),r.forEach((function(e){0===e.attributes.length||e.sort&&"#DELETE#"===e.sort.sortType?a.push({deleted:!0}):a.push(t.attributesParser(e.attributes,i))})),{results:a,nlsTracker:i}},cleanExpandParsedData:function(e){if(e){if(e.root=void 0,e.nodes){for(var s in e.nodes)e.nodes.hasOwnProperty(s)&&(e.nodes[s]=void 0);e.nodes=void 0}if(e.iconsSet&&(e.iconsSet=void 0),Array.isArray(e.paths)){for(var r=0;r<e.paths.length;r++)e.paths[r]=void 0;e.paths=void 0}e=void 0}},parseAndBuildIRPCStructure:function(e,s){var r=this.parseExpandResult(e,s);if(!r||!r.nodes||!Array.isArray(r.paths))throw new Error("Ouups ! invalid input");r.iconsSet=r.iconsSet||[];for(var a=0;a<r.iconsSet.length;a++)for(var t=r.iconsSet[a],i=0;i<t.did.length;i++){var n=t.did[i],o=r.nodes[n];o.icons&&Array.isArray(o.icons)||(o.icons=[]),o.icons.push(t.icon),o.thumbnail||(o.thumbnail=t.thumbnail_2d)}return r.paths.forEach((function(e){var s=e.length;if(1===Math.abs(s%2))for(var a=0;a<e.length;a++){var t=r.nodes[e[a]],i=a+1<s?r.nodes[e[a+1]]:null;if(0===Math.abs(a%2)){if(t.children||(t.children=[]),i){for(var n=!1,o=0;o<t.children.length;o++)if(t.children[o].did===i.did){n=!0;break}n||t.children.push(i)}}else i&&(t.instanceOf=i)}else console.error("incomplete path")})),r.root=r.paths.length>=1&&r.paths[0].length>=1?r.nodes[r.paths[0][0]]:null,r},parseExpandResult:function(s,r){if(!s||!Array.isArray(s))throw new Error("Ouups ! invalid input");var a={nodes:{},root:null,paths:[],nlsTracker:{withNlsProp:r,classes:[],properties:{}},iconsSet:[]},t=this;return s.forEach((function(s){if(s.hasOwnProperty("attributes")){var r=t.attributesParser(s.attributes,a.nlsTracker);e.is(r.did)&&(a.nodes[r.did]=r)}else s.hasOwnProperty("path")?a.paths.push(s.path):s.hasOwnProperty("icon__default_thumbnail_2d")&&(a.iconsSet=s.icon__default_thumbnail_2d)})),a}}}));