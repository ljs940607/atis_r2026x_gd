define("DS/XSRCommonComponents/createform/util/TableFormGridCol",["DS/XSRCommonComponents/utils/Constants","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Controls/ComboBox","DS/Controls/Toggle","DS/Controls/LineEditor","DS/XSRCommonComponents/utils/TypeUtils","i18n!DS/XSRCommonComponents/assets/nls/XSRCommonComponents","css!DS/XSRCommonComponents/createform/view/TableForm.css"],(function(e,t,n,o,l,i,a,d){"use strict";return class{constructor(e){this.isMBMF=e.isMBMF,this.parentTitle=e.parentTitle,this.dataCount=e.dataCount}getCols(){let e=this,t=[{dataIndex:"tree",text:d.label_Title,pinned:"left",editableFlag:!1},{dataIndex:"ContextualMenuColumn",text:d.label_Action,pinned:"left",hasCellValue:e=>!0},{dataIndex:"uomupdated",text:d.label_Quantity,width:350,typeRepresentation:"UWAObject",editableFlag:!1,allowUnsafeHTMLContent:!1,autoRowHeightFlag:!1,exportFlag:!0,visibleFlag:!0,editionPolicy:"EditionOnOver",getCellValue:e.getCellValue_uom,getCellTooltip:e.getCellTooltip_uom.bind(this)},{dataIndex:"type",text:d.label_Type,editableFlag:!1},{dataIndex:"referenceName",text:d.label_ReferenceName,editableFlag:!0,typeRepresentation:"string",editionPolicy:"EditionOnOver",width:105,value:""},{dataIndex:"connectCM",icon:"product-made-from-part",typeRepresentation:"independantBoolean",editionPolicy:"EditionInPlace",width:40,editableFlag:!0,getCellTooltip:e.getCellTooltip_connectCM.bind(this),getCellSemantics:e.getCellSemantics_connectCM},{dataIndex:"revision",text:d.label_RevisionsExplore,editableFlag:!1,width:60},{dataIndex:"current",text:d.label_Current,editableFlag:!1,width:90}],n=[];return t.forEach((e=>{n.push(e)})),n}getToolbar(){let e=this;return{entries:[{id:"delete",dataElements:{typeRepresentation:"functionIcon",icon:e.getJsonValues("delete","icon","toolbar"),tooltip:e.getJsonValues("delete","tooltip","toolbar"),position:"far",category:"separate"}},{id:"duplicate",dataElements:{typeRepresentation:"functionIcon",icon:e.getJsonValues("duplicate","icon","toolbar"),tooltip:e.getJsonValues("duplicate","tooltip","toolbar"),position:"far",category:"integrate"}}]}}getMenuItems(e,t){let n=this,o=[],l={type:"PushItem",title:d.label_Remove,icon:n.getJsonValues("delete","icon","menu"),tooltip:n.getJsonValues("delete","tooltip","menu"),action:{callback:n.deleteCallBack.bind(t)}},i={type:"PushItem",title:d.label_Duplicate,icon:n.getJsonValues("duplicate","icon","menu"),tooltip:n.getJsonValues("duplicate","tooltip","menu"),action:{callback:n.duplicateCallBack.bind(t)}};return Array.isArray(e)||(e=[e]),e.forEach((e=>{switch(e){case"delete":o.push(l);break;case"duplicate":o.push(i)}})),o}getJsonValues(e,t,n){let o={};switch(e){case"delete":switch(t){case"tooltip":"toolbar"===n||null==n?(o.title=d.label_Remove,o.shortHelp=d.text_DeleteSelected):"menu"===n&&(o=d.text_DeleteSelected);break;case"icon":o.iconName="trash",o.fontIconFamily=1}break;case"duplicate":switch(t){case"tooltip":"toolbar"===n||null==n?(o.title=d.label_Duplicate,o.shortHelp=d.text_DuplicateSelected):"menu"===n&&(o=d.text_DuplicateSelected);break;case"icon":o.iconName="duplicate",o.fontIconFamily=1}}return o}contextualEvent(e){let t=this,n=[];return e&&e.collectionView&&e.cellInfos&&n.push(...t.getMenuItems(["delete","duplicate"],e.cellInfos)),n}getCellTooltip_connectCM(e){let t=this,n=!!e.nodeModel&&e.nodeModel,o={};if(n){let e=n.options.grid;e.canConnectCM?(o.title=d.text_connectCM+" "+e.coreMaterial[0].V_Name,o.shortHelp=d.replace(d.get("text_connectCMFromTo"),{modeTitle:e.title,parentTitle:t.parentTitle})):(o.title=d.text_cannotConnectCM,o.shortHelp=e.connectCM_Msg)}else o.shortHelp=d.text_connectCMTo+t.parentTitle;return o}getCellTooltip_uom(e){return""}getCellSemantics_connectCM(e){let t=!!e.nodeModel&&e.nodeModel;return!!t&&{disabled:!t.options.grid.canConnectCM}}deleteCallBack(){let e=this.manager.getTreeDocument();e.prepareUpdate();let t=e.getNthRoot(this.rowID);e.removeRoot(t),e.pushUpdate(2)}duplicateCallBack(){let e=this,t=e.manager.getTreeDocument();t.prepareUpdate();let o=t.options.dataModelSet,l=e.nodeModel.options.grid.copy,i=n.createTreeNodeDataModel(o,{label:l.title,grid:l});e.nodeModel.getParent().addRoot(i,e.nodeModel._getLocalID()+1),t.pushUpdate(1);let a=i._getRowID();e.manager.insertRowCallback(i,a,e),e.manager.ensureNodeModelVisible(i,!0),e.manager.flashEffectOnNodeModel("ui-modified",i)}getCellValue_uom(t){console.log("calling UOM cont");var n=t.nodeModel,s=UWA.createElement("div",{class:"uom-container","data-cellInfos":t}),r=!0,c=[],p=new Map;if(n&&"EA"===n.options.grid.unitDB)r=!1,c.push(n.options.grid.unitDB);else{var u=n.options.grid._dimensionDB,g=Object.entries(a.getUOMUnits(u));g&&g.forEach((function(e){c.push(e[1]),p.set(e[1],e[0])}))}var m=n.options.grid.quantity||"",C=n.options.grid.unit,h=n.options.grid.asRequired,b=-1;null!=C&&(b=c.indexOf(C));var M=UWA.createElement("div").inject(s),x=UWA.createElement("xsr-grid-rectangular-width").inject(M);if(n&&n.getAttributeValue("dimensionDB")===e.RECTANGULAR_DIMENSION){(w=new l({label:d.label_AsNeeded,type:"switch",checkFlag:h})).getContent().addClassName("xsr-grid-rectangular-inline"),w.getContent().addClassName("xsr-grid-wux-inline-fix"),w.addEventListener("buttonclick",(function(e){var t=e.dsModel.checkFlag;n.options.grid.asRequired=t,n.updateOptions({grid:n.options.grid})}));var v=r?"([0-9]*[.])?[0-9]+":"[0-9]+",f=new i({placeholder:d.Length,value:n.options.grid.quantityLength,pattern:v}).inject(x);UWA.createElement("span",{class:"xsr-rectangular-dimension-cross",html:"âœ–"}).inject(x);var _=new i({placeholder:d.Width,value:n.options.grid.quantityWidth,pattern:v}).inject(x),y=new o({elementsList:c,selectedIndex:b,placeholder:d.placeholder_dropdown}).inject(M);w.inject(M),y.getContent().addClassName("xsr-grid-combobox"),f.getContent().addClassName("xsr-grid-lengtheditor"),_.getContent().addClassName("xsr-grid-widtheditor"),f.addEventListener("change",(function(e){let t=""===e.dsModel.value?"":e.dsModel.value;n.options.grid.quantityLength=t,n.updateOptions({grid:n.options.grid})})),_.addEventListener("change",(function(e){let t=""===e.dsModel.value?"":e.dsModel.value;n.options.grid.quantityWidth=t,n.updateOptions({grid:n.options.grid})})),y.addEventListener("change",(function(e){let t=e.dsModel.value;null!=t&&(n.options.grid.unit=t,n.options.grid.unitDB=p.get(t),n.updateOptions({grid:n.options.grid}))})),r||(y.destroy(),w.destroy(),f.destroy(),_.destroy())}else{var w;(w=new l({label:d.label_AsNeeded,type:"switch",checkFlag:h})).getContent().addClassName("xsr-grid-wux-inline"),w.getContent().addClassName("xsr-grid-wux-inline-fix"),w.addEventListener("buttonclick",(function(e){var t=e.dsModel.checkFlag;n.options.grid.asRequired=t,n.updateOptions({grid:n.options.grid})}));v=r?"([0-9]*[.])?[0-9]+":"[0-9]+";var D=new i({placeholder:d.placeholder_Quantity,value:m,pattern:v}).inject(M);y=new o({elementsList:c,selectedIndex:b,placeholder:d.placeholder_dropdown}).inject(M);w.inject(M),y.getContent().addClassName("xsr-grid-combobox"),D.getContent().addClassName("xsr-grid-lineeditor"),D.addEventListener("change",(function(e){let t=""===e.dsModel.value?"":e.dsModel.value;n.options.grid.quantity=t,n.updateOptions({grid:n.options.grid})})),y.addEventListener("change",(function(e){let t=e.dsModel.value;null!=t&&(n.options.grid.unit=t,n.options.grid.unitDB=p.get(t),n.updateOptions({grid:n.options.grid}))})),r||(y.destroy(),w.destroy(),D.destroy())}return s}}}));