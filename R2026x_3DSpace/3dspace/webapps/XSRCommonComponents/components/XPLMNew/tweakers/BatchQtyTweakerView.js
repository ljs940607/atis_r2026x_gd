define("DS/XSRCommonComponents/components/XPLMNew/tweakers/BatchQtyTweakerView",["UWA/Controls/Abstract","DS/WUXAutoComplete/AutoComplete","DS/Controls/LineEditor","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/XSRCommonComponents/utils/TypeUtils","i18n!DS/XSRCommonComponents/assets/nls/XSRCommonComponents"],(function(e,t,a,o,i,n,r){"use strict";return e.extend({init:function(e){this._parent(e),this.tweakerCtx=e.tweakerCtx;var t=this.tweakerCtx.data.value;t&&(this.previousValue=t.split(" "))},_buildReferenceBatchQty:function(){var e=UWA.createElement("div",{id:"xsr-refqty-tweaker-create"});e.setStyle("display","flex");var i=this.previousValue?this.previousValue[0]:"",n=new a({domId:"xsr-line-editor-qty-tweaker",placeholder:r.placeholder_Quantity,displayClearFieldButtonFlag:!1,pattern:"(?!0+$)(?![0.]+$)([+]?[0-9]*[0-9,.]+$)"});n.elements.container.setStyle("width","50%"),n.value=i;var l=this;n.addEventListener("change",(function(e){e.stopPropagation(),e.preventDefault(),l.valueUpdated()})),n.inject(e),this.qtyField=n;var s=new o,d=this.previousValue?this.previousValue[1]:"",u=new t({domId:"xsr-auto-complete-uom-tweaker",placeholder:r.placeholder_UOM,multiSearchMode:!1,elementsTree:s,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!0,keepSearchResultsFlag:!1});l=this;return u.addEventListener("change",(function(e){e.stopPropagation(),e.preventDefault();var t=e.dsModel.value;l.dimNodesArr.indexOf(t)>=0?u.value=void 0:l.valueUpdated()})),u.elements.container.setStyle("width","50%"),u.elements.container.setStyle("padding-left","5px"),u.inject(e),this.uomField=u,this._loadBatchUnitOfMeasurements(u),this.uomField.value=d,e},updateTooltip:function(e){this.tweakerCtx._tooltip=e},valueUpdated:function(){let e=this.qtyField.value,t=this.uomField.value;if(e&&t){var a=e+" "+t;this.updateTooltip(e+" "+this.uomField.selectedItems.getLabel()),this.tweakerCtx._dispatchChange(a,!0)}else this.updateTooltip(),this.tweakerCtx._dispatchChange(void 0,!1)},_loadBatchUnitOfMeasurements:function(e){var t=this,a=e.elementsTree;t.dimNodesArr=[],t.uomObj={},a.prepareUpdate();var o=n.getFPDimensions();Object.entries(o).forEach((([e,o])=>{t.dimNodesArr.push(e);let i=t.createNode(o,e);a.addRoot(i);var r=n.getUOMUnits(e),l=Object.fromEntries(Object.entries(r).sort((([,e],[,t])=>e.localeCompare(t))));Object.keys(l).forEach((function(a){var o=t.isNonNlsLabel(l[a])?a:l[a],n=a+":"+e,r=t.createNode(o,n);i.addChild(r),t.uomObj[a]=n}))})),a.expandAll(),a.pushUpdate(),e.elementsTree=a},isNonNlsLabel:function(e){return!!e.includes("emxFramework.")},createNode:function(e,t,a){return new i({label:e,value:t,grid:a||{}})}})}));