define("DS/XSRCommonComponents/facets/template/ReleaseSnapshotFacet",["DS/ENONewWidget/ENONew/View/Facet/ENONewFacetBase","DS/XSRCommonComponents/facets/template/ReleaseSnapshotFacetView","DS/XSRCommonComponents/utils/XInfraRequestUtil","UWA/Class/Options","UWA/Class/Events","css!DS/XSRCommonComponents/facets/template/template.css"],(function(e,t,n,i,o){"use strict";return e.extend(i,o,{name:"releaseSnapshotFacet",securityContext:null,init:function(e){var n=this;this._parent(e),this.elements.container=UWA.createElement("div",{class:"xsr-plmnew-mastercontainer",id:"ReleaseSnapshot"}),this.listenToPublishedInfo((function(e,t){if("currentSecurityContext"===e){let e=t.value;n.securityContext=e}else if("currentObjectType"===e){let e=t.value,i=n.templateView.selectedType,o=n.templateView.templateField.value;n.templateView.loadTemplate(e),i===e&&o&&(n.templateView.templateField.value=o)}}));var i=function(){};setTimeout((function(){var o=n.fetchInfo("currentObjectType")?n.fetchInfo("currentObjectType").value:e.type;n.securityContext=n.fetchInfo("currentSecurityContext")?n.fetchInfo("currentSecurityContext").value:e.securityContext,n.templateView=new t({type:o,onViewChange:i}),n.templateView.build().inject(n.elements.container)}),0)},getUI:function(e){return this.elements.container},plmNewContextProvider(){return this.securityContext},postCreation(e){let t=e[0].identifier,n=this.templateView.getSelectedTemplate();if(t&&n)return this.createSpecReport(t,n)},createSpecReport(e,t){var i={data:{itemPid:e,template:t}},o=new n({id:"SpecificationReport",securityContext:this.plmNewContextProvider()});return new Promise((function(e,t){o.create(i).then((function(t){e({name:"releaseSnapshotFacet"})})).catch((function(t){var n={errors:[{errorCode:"ENONEW_FACETS_POSTCREATION",errorMessages:t.message}]};e(n)}))}))},destroy(){this.options.onDestroyCallback&&this.options.onDestroyCallback(this.options.tabId),this._parent()}})}));