define("DS/ENOXArchitectureCommon/utils/group.util",[],(function(){"use strict";return{getGroupNodeParent:function(e){let t=this,i=e.getParent();return i.getID?i:t.getGroupNodeParent(i)},removeGroupNodesOnEmpty:function(e){let t=this,i=e.getParent();return e.getChildren()&&0!==e.getChildren().length||e.remove(),i.getID?void 0:t.removeGroupNodesOnEmpty(i)}}})),define("DS/ENOXArchitectureCommon/utils/config.util",["UWA/Core","UWA/Class/Promise","UWA/Utils/InterCom","DS/WAFData/WAFData","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","text!DS/ENOXArchitectureCommon/assets/config/webservices.conf.json","text!DS/ENOXArchitectureCommon/assets/config/masks.conf.json","text!DS/ENOXArchitectureCommon/assets/config/localStorage.keys.json","text!DS/ENOXArchitectureCommon/assets/config/identifiers.conf.json"],(function(e,t,i,n,o,r,s,a,l,c,d){"use strict";var u={nlsBasicAttributesBO:{},nlsBasicAttributesRel:{},identifiers:JSON.parse(d),masks:JSON.parse(l),localStorageKeys:JSON.parse(c),webservices:JSON.parse(a),mappingType:{}};return u.mappingType[u.identifiers.type_act_logref]={nlsName:u.identifiers.type_logicalref,icon:"I_VPMNavLogical.png"},u.mappingType[u.identifiers.type_act_loginstance]={nlsName:u.identifiers.rel_logicalInstance},u.mappingType[u.identifiers.type_document]={icon:"I_TextDoc22x22.png"},u.mappingType[u.identifiers.type_requirement]={icon:"iconReqTypeRequirement.png"},u.mappingType[u.identifiers.type_act_functref]={icon:"I_VPMNavFunction.png"},u.mappingType[u.identifiers.type_act_physical]={icon:"I_VPMNavProduct.png"},{getEntry:function(e){return u[e]},getFullConfig:function(){return u},getPlatformServices:function(){var i=this;return new t((function(t,n){r.getPlatformServices({onComplete:function(n){var o={};e.is(n,"array")&&n.length>0&&n.forEach((function(e){o[e.platformId]=e})),i._platformServices=o,i.retrieveSecurityContext().then((function(e){t(e)}))},onFailure:n})}))},retrieveSecurityContext:function(){var i=this,o=null;return new t((function(t,r){var s=i.getServiceURL("3DSpace")+u.webservices.pnoCredential+"&tenant="+i.getTenant();n.authenticatedRequest(s,{method:"GET",type:"json",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(n){e.is(n.collabspaces,"array")&&0===n.collabspaces.length&&t(!1),o=i.credentialDataParser(n),t(o)},onFailure:r,onTimeout:r})}))},getServiceURL:function(e){var t=this.getTenant();if(this._platformServices)return this._platformServices[t][e]},getTenant:function(){var t=this;return e.is(t._tenant)||(t._tenant=widget.getValue("x3dPlatformId")),t._tenant},getNlsBasicAttributesBO:function(e){return u.nlsBasicAttributesBO[e]||e},getNlsBasicAttributesRel:function(e){return u.nlsBasicAttributesRel[e]||e},credentialDataParser:function(e){var t,i,n,o=" â— ",r=this;r._theListSC=[],r._theListSC_NLS=[],r.returnList=[],r._SCPreferredDB=null;var s=e.preferredcredentials;if(s.collabspace&&s.role&&s.organization){var a=s.collabspace,l=s.role,c=s.organization;t=a.name,i=l.name,n=c.name,r._SCPreferredDB=i+"."+n+"."+t}var d=e.collabspaces;if(d&&d.length>0){for(var u=!1,p=void 0,m=0;m<d.length;m++){for(var f=(v=d[m]).couples||[],g=0;g<f.length;g++){var h=f[g];if(void 0===p&&(p=h.organization.name),p!==h.organization.name){u=!0;break}}if(u)break}for(m=0;m<d.length;m++){var v,y=(v=d[m]).name,b=v.title;for(f=v.couples,g=0;g<f.length;g++){var C=f[g],I=C.organization,S=C.role,N=I.name,D=I.title,O=S.name,_=S.nls,E=O+"."+N+"."+y,A=u?b+o+D+o+_:b+o+_;r._theListSC.push(E),r._theListSC_NLS.push(A),r.returnList.push({label:A,value:E})}}}return{optionList:r.returnList,defaultValue:r._SCPreferredDB}},retrieveCurrentUser:function(){var e=this;return new t((function(t,i){if(e._user&&e._user.id)return t(e._user);r.getUser({onComplete:function(i){e._user={id:i.id,email:i.email,firstName:i.firstname,lastName:i.lastname},t(e._user)},onFailure:i})}))},getSecurityContext:function(){var e=widget.getPreference(u.localStorageKeys.credentials),t=widget.getValue("widgetSecCtxPref"),i=this;return e&&e.value?i._securityContext=e.value:i._securityContext=t&&null!=t?t:null,i._securityContext},switchPlatform:function(e){return!(!e||!e instanceof String)&&(widget.setValue("x3dPlatformId",e),this._tenant=e,!0)},getUser:function(e){var t=this,i="";if(t._user)return"isFullName"===e?i=t._user.firstName+" "+t._user.lastName:"isTrigram"===e?i=t._user.id:i},form3DXContent:function(e){return{protocol:"3DXContent",version:"1.1",source:widget.getValue("appId"),widgetId:widget.id,data:{items:this.getItemDetailsToShare(e)}}},getItemDetailsToShare:function(e){var t=this,i=[],n=t.getSecurityContext();return e.forEach((function(e){i.push({envId:t.getTenant(),serviceId:"3DSpace",contextId:n,objectId:e.getID(),objectType:e.options.grid.actualType||e.options.type,displayName:e.getLabel(),facetName:"realized",path:[{resourceid:e.getID(),type:e.getType()}]})})),i},setObjectOnCompass:function(t){var n=this,o=e.is(widget)&&widget.id?"flcockpitcompassSocket_"+widget.id:"flcockpitcompassSocket";n.flcockpitIntercom||(n.flcockpitIntercom=new i.Socket(o),n.flcockpitIntercom.subscribeServer("com.ds.compass",window.parent)),0==t.data.items.length?(n.flcockpitIntercom.dispatchEvent("onResetObject",{}),n.flcockpitIntercom.dispatchEvent("onResetX3DContent",{},o)):(n.flcockpitIntercom.dispatchEvent("onSetObject",t.data.items[0]),n.flcockpitIntercom.dispatchEvent("onSetX3DContent",t,o))},launchCrossAppSelection:function(e){var t={attributes:e.reduce((function(e,t){return e[t.getID()]={type:t.getType(),label:t.getLabel()},e}),{}),paths:e.map((function(e){return e.getOccurencePath()})),version:"1.1"},i={metadata:{uid:Math.random(),originUid:Math.random(),timestamp:Date.now(),appid:widget.getValue("appId")+"_"+widget.id,originWidgetId:widget.id},data:t};o.publish("DS/PADUtils/PADCommandProxy/select",i)},getTypeIconUrl:function(e){let t,i,n=this,o=u.mappingType[e];return o.custo?(i=u.mappingType.iconsCommonImagePath.substring(u.mappingType.iconsCommonImagePath.indexOf("enovia")+6),t=n.getServiceURL("3DSpace")+i+o.icon):t=n.getServiceURL("3DSpace")+"/snresources/images/icons/small/"+o.icon,{iconPath:t,iconSize:{width:"16px",height:"16px"}}},retrieveCSRFToken:function(){var e=this;return new t((function(t,i){var o=e.getServiceURL("3DSpace")+u.webservices.getCSRFToken+"?tenant="+e.getTenant();n.authenticatedRequest(o,{method:"GET",type:"json",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(i){e.csrfToken=i.csrf.value,t()},onFailure:i,onTimeout:i})}))},refreshCSRFToken:function(){var e=this;setTimeout((function(){e.retrieveCSRFToken(),e.refreshCSRFToken()}),9e5)},getCSRFToken:function(){return this.csrfToken},XArchStorage:function(){return{setItem(e,t){localStorage.setItem(e,t),widget.setValue(e,t)},getItem:e=>widget.getValue(e)||localStorage.getItem(e)||null}},get3DswymUrl:function(){return this.getServiceURL("3DSwym")},getUserImage:function(e){return this.get3DswymUrl()&&e?this.get3DswymUrl()+"/api/user/getpicture/login/"+e+"/format/normal":null},cleanRecentlyAuthoredItemsInLocalStorage:function(){var e=1e3*parseInt(widget.getPreference(u.localStorageKeys.timeoutIndex).value,10);let t=this;for(var i=localStorage.length-1;i>=0;i--){var n=localStorage.key(i);-1!==n.indexOf(u.localStorageKeys.recentlyAuthored)&&Date.now()-JSON.parse(t.XArchStorage().getItem(n),10)>e&&localStorage.removeItem(n)}},setAuthIDforWIW:function(e,t){this.AuthIDForWIW={workunder:e,value:t}},getAuthorizedWorkUnder:function(e){var t={},i=s.get();if(e){let e="DS-Configuration-Authoring-Context",i=null;this.AuthIDForWIW&&this.AuthIDForWIW.value&&("evolution"===this.AuthIDForWIW.workunder?i="pid:"+this.AuthIDForWIW.value:(e="DS-Change-Authoring-Context",i=this.AuthIDForWIW.value),t[e]=i)}else if(i&&i&&i.AuthoringContextHeader)for(var n in i.AuthoringContextHeader)t[n]=i.AuthoringContextHeader[n];return t}}})),define("DS/ENOXArchitectureCommon/utils/modelObj.util",["UWA/Class/Model"],(function(e){"use strict";var t=e.extend({setup:function(e){this._parent(e),this.options={grid:{"ds6w:type":e.displayType,"ds6wg:revision":e.revision,"ds6wg:responsible":e.owner},icons:e.icons}},getID:function(){return this.get("physicalid")},getLabel:function(){return this.get("label")},getType:function(){return this.get("type")},getDisplayName:function(){return this.get("label")},getParent:function(){return this.get("parent")?new t(this.get("parent")):null},getRelationID:function(){return this.get("relID")}});return t})),define("DS/ENOXArchitectureCommon/model/TreeNodeModel",["DS/TreeModel/TreeNodeModel","DS/WebappsUtils/WebappsUtils"],(function(e,t){"use strict";function i(t){this.options={grid:{},color:"rgba(0, 0, 0, 0)",isUIActive:!1,relationid:"",physicalid:"",type:"",basetype:"",relationtype:"",virtual:!1},this.options.grid.active_color="rgba(0, 0, 0, 0)",this.options.grid.bi_color="rgba(0, 0, 0, 0)",this.options=UWA.extend(this.options,t),e.call(this,this.options)}function n(e){e._getFilterInfo||(e._getFilterInfo=i.prototype._getFilterInfo.bind(e),e._getChildrenFilterInfo=i.prototype._getChildrenFilterInfo.bind(e),e._removeChildrenFilterInfo=i.prototype._removeChildrenFilterInfo.bind(e),e.filterInChild=i.prototype.filterInChild.bind(e),e.filterOutChild=i.prototype.filterOutChild.bind(e))}return i.prototype=Object.create(e.prototype),i.prototype.getRealPath=function(){var e=this.getPath();return e.length>0&&e[0].isVirtual()&&e.shift(),e},i.prototype.isVirtual=function(){return this.options.virtual},i.prototype.getAttribute=function(e){return"ds6w:label-Instance"===e&&(e="instanceName"),this.getAttributeValue(e)},i.prototype.getType=function(){return this.options.type},i.prototype.getBaseType=function(){return this.options.basetype},i.prototype.getRelationType=function(){return this.options.relationtype},i.prototype.getGroups=function(){let e;return e=this.options.merged?this.options.grp:UWA.Utils.splat(this.options.grp),e},i.prototype.setID=function(e){this.options.physicalid=e},i.prototype.getID=function(){return this.options.physicalid},i.prototype.getReferenceID=function(){return this.options.physicalid},i.prototype.getRelationID=function(){return this.options.relationid},i.prototype.setRelationID=function(e,t){this.options.relationid=e,this.options.relationtype=t},i.prototype.addChild=function(e,t){if(!Array.isArray(e)){var i=this.getTreeDocument();if(i&&e.options.physicalid&&e.options.physicalid.length>0){var n=i.getRoots()[0];0==Object.keys(i.mappedNodesToIds).length&&n.options.physicalid.length>0&&(i.mappedNodesToIds[n.options.physicalid]=[n]),i.mappedNodesToIds[e.options.physicalid]||(i.mappedNodesToIds[e.options.physicalid]=[]),i.mappedNodesToIds[e.options.physicalid].push(e)}return this._addChild(e,t)}},i.prototype.removeChild=function(t){if(!Array.isArray(t)){var i=this.getTreeDocument();if(i&&t.options.physicalid&&t.options.physicalid.length>0){var n=i.mappedNodesToIds[t.options.physicalid];if(n){for(var o=n.length-1;o>=0;o--){n[o]._id===t._id&&n.splice(o,1)}n.length<=0&&delete i.mappedNodesToIds[t.options.physicalid]}}return Object.create(e.prototype).removeChild.call(this,t)}},i.prototype.getNodesById=function(e){var t={listOfFoundNodes:[]};return this._groupingOptions?this.getChildrenFromGroupById(e,t):this._getNodesById(e,t),t.listOfFoundNodes},i.prototype.getChildrenFromGroupById=function(e,t){this.getChildren().forEach(((n,o)=>{n.getID?n._getNodesById(e,t):i.prototype.getChildrenFromGroupById.call(n,e,t)}))},i.prototype._getNodesById=function(e,t){var i=!1;if(this.getID()===e)t.listOfFoundNodes.push(this),i=!0;else{var n=this.getChildren();if(n)for(var o=0;n&&o<n.length;o++)i=n[o]._getNodesById(e,t)||i}return i},i.prototype.getNodesByRelId=function(e){var t={listOfFoundNodes:[],foundId:void 0};return this._groupingOptions?this.getChildrenFromGroupByRelId(e,t):this._getNodesByRelId(e,t),t.listOfFoundNodes},i.prototype.getChildrenFromGroupByRelId=function(e,t){this.getChildren().forEach(((n,o)=>{n.getID?n._getNodesByRelId(e,t):i.prototype.getChildrenFromGroupByRelId.call(n,e,t)}))},i.prototype._getNodesByRelId=function(e,t){var i=this.options.relationid,n=this.getID();if(i===e)t.listOfFoundNodes.push(this),t.foundId=n;else if(n!==t.foundId){var o=this.getChildren();if(o)for(var r=0;r<o.length;r++)o[r]._getNodesByRelId(e,t)}},i.prototype.getOccurencePath=function(e){UWA.is(e,"function")&&e(this);var t=this.options.actualParent||this.getParent();if(this.isRoot()||this.isVirtual()||!t)return[this.options.physicalid];var i=t.getOccurencePath(e);return i.push(this.options.instance.physicalid),i.push(this.options.physicalid),i},i.prototype.setActive=function(e){this.updateOptions({isUIActive:e})},i.prototype.isActive=function(){return this.options.isUIActive},i.prototype.setColor=function(e){this.updateOptions({color:e,grid:{active_color:e}})},i.prototype._removeFilterInfo=function(){delete this.options._filterInfo},i.prototype._removeChildrenFilterInfo=function(){delete this.options._childrenFilterInfo},i.prototype._getFilterInfo=function(e){return!this.options._filterInfo&&Boolean(e)&&(this.options._filterInfo={}),this.options._filterInfo},i.prototype._getChildrenFilterInfo=function(e){return!this.options._childrenFilterInfo&&Boolean(e)&&(this.options._childrenFilterInfo={}),this.options._childrenFilterInfo},i.prototype.filterOut=function(){var e=this.isRoot()?this.getTreeDocument():this.getParent();null!==e&&(n(e),e.filterOutChild(this))},i.prototype.filterIn=function(e){var t=this._getFilterInfo();if(t&&t.parentBeforeFiltering){var i=t.parentBeforeFiltering;n(i),i.filterInChild(this)}if(Boolean(e)){var o,r=this._getChildrenFilterInfo();(o=r&&r.childrenBeforeFiltering?r.childrenBeforeFiltering:this.getChildren())&&o.forEach((function(t){t.filterIn(e)}))}},i.prototype.filterOutChild=function(e){var t=this.getChildren();if(t.indexOf(e)<0)throw"Not a child";var i=this._getChildrenFilterInfo(!0);if(!i.childrenBeforeFiltering){i.childrenBeforeFiltering=t&&t.length>0?t.slice(0):[];UWA.is(this._expandState)&&(i.expandStateBeforeFiltering={noExpandState:"noChildren",expandingState:"expanding",partiallyExpandedState:"partiallyExpanded",collapseState:"expanded",expandState:"collapsed"}[this._expandState])}e._getFilterInfo(!0).parentBeforeFiltering=this,UWA.is(this.removeChild,"function")?this.removeChild(e):this.removeRoot(e,!0,!0),UWA.is(this.setState,"function")&&this.setState({state:i.expandStateBeforeFiltering}),i.filteredOutChildren||(i.filteredOutChildren=[]),i.filteredOutChildren.push(e)},i.prototype.filterInChild=function(e){var t=this._getChildrenFilterInfo();if(t){var i=t.childrenBeforeFiltering;if(i){var n=i.indexOf(e);if(n>=0){var o=e._getFilterInfo();if(o&&o.parentBeforeFiltering===this){var r,s=this.getChildren();if(s)for(var a=0;a<s.length;a++){var l=s[a];if(i.indexOf(l)>n){r=l;break}}delete o.parentBeforeFiltering,void 0!==e.options.isRootAttached?!0===e.options.isRootAttached&&this.insertBefore(e,r):this.insertBefore(e,r),UWA.is(this.setState,"function")&&this.setState({state:t.expandStateBeforeFiltering}),e._removeFilterInfo();var c=t.filteredOutChildren.indexOf(e);t.filteredOutChildren.splice(c,1),0===t.filteredOutChildren.length&&this._removeChildrenFilterInfo()}}}}},i.prototype.isDescendantOf=function(e){var t;if(t=e instanceof i?e.getID():e,this.getID()===t)return!0;if(!this.isRoot()){var n=this.getParent();if(n)return n.isDescendantOf(t)}return!1},i})),define("DS/ENOXArchitectureCommon/utils/gridview.dnd.util",[],(function(){"use strict";return{makeGridViewDroppable:function(e){var t=this,i=e.container,n=i.getElement("#drop-insert-instance");n||(n=new UWA.createElement("div",{id:"drop-insert-instance",class:"hidden"}).inject(i)),e.contentView.onDragEnterCell=t._onDragEnterGridView.bind(t,e.acceptDrop,e.getTextInvite),e.contentView.onDragEnterRowHeader=t._onDragEnterGridView.bind(t,e.acceptDrop,e.getTextInvite),e.contentView.onDragLeaveCell=t._onDragLeaveGridView.bind(t),e.contentView.onDragLeaveRowHeader=t._onDragLeaveGridView.bind(t),e.contentView.onDropCell=t._onDropGridView.bind(t,e.onDropCallback),e.contentView.onDropRowHeader=t._onDropGridView.bind(t,e.onDropCallback),e.contentView.onDragOverCell=t._onDragOverGridView.bind(t,e.acceptDrop,e.getTextInvite),e.contentView.onDragOverRowHeader=t._onDragOverGridView.bind(t,e.acceptDrop,e.getTextInvite)},_manageDisplayDropInviteGridView:function(e,t){var i=widget.body.querySelector(".xarch-common-dgv-container").getElement("#drop-insert-instance");i&&(e?(t.icon&&t.text&&(i.innerHTML="<i class='wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-"+t.icon+"'></i><h5 class='font-3dsregular insert'>"+t.text+"</h5>"),i.removeClassName("hidden"),i.addClassName("show")):(i.removeClassName("show"),i.addClassName("hidden")))},_onDragOverGridView:function(e,t,i,n){var o=e(i,n),r=t?t(i,n,o):void 0;return r&&this._manageDisplayDropInviteGridView(!0,r),!!o&&(i.preventDefault(),!0)},_onDragEnterGridView:function(e,t,i,n){var o=e(i,n),r=t?t(i,n,o):void 0;return r&&this._manageDisplayDropInviteGridView(!0,r),!0},_onDragLeaveGridView:function(){return this._manageDisplayDropInviteGridView(),!0},_onDropGridView:function(e,t,i){return this._manageDisplayDropInviteGridView(),e(t,i),!1}}})),define("DS/ENOXArchitectureCommon/utils/search.util",["UWA/Core","UWA/Utils/InterCom","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i){"use strict";var n={initialize:function(){this.socketName="search_socket_"+(new Date).getTime(),this.socket=new t.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var e=this.options();return this.socket.dispatchEvent("RegisterContext",e),this},options:function(t,i,n,o,r,s,a){var l={};return l.title=t,l.mode="furtive",l.app_socket_id=this.socketName,l.widget_id=widget.id,l.default_with_precond=!0,l.show_precond=!1,l.idcard_activated=!1,l.multiSel=!!e.is(r)&&r,l.role=n,i&&(l.precond="",(i=i.split(",")).forEach((function(e,t){0!==t&&(l.precond+=" OR "),l.precond+='flattenedtaxonomies:"types/'+e+'"'}))),l.recent_search={types:i},s&&(l.precond?l.precond="( "+l.precond+") AND "+s:l.precond=s),a&&a.length>0&&(l.columns=a),l},destroy:function(){var e={};e.widget_id=widget.id,this.socket.dispatchEvent("unregisterSearchContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.disconnect(),delete this.socket},activate:function(e,t,i,n,o,r,s,a){var l=this.options(e,t,i,n,o,s,a);this.callback=r,this.socket.dispatchEvent("RegisterContext",l),this.socket.dispatchEvent("InContextSearch",l)},isAvailable:function(){return e.is(this.socket)},configureSearch:function(e){this.isAvailable()||this.initialize(e)},launchSearch:function(e){var t=e.searchTitle||i.title.search;this.activate(t,e.allowedTypes,e.role||"",e.criteria,e.bMultiSel,(function(t){e.in_apps_callback(t)}),e.additionalQuery,e.selectable)},objectsSelected:function(e){var t,i,n=[];if(this.callback){for(t=0,i=e.length;t<i;t++)n.push(e[t]);this.callback(n)}}};return n.initialize(),n})),define("DS/ENOXArchitectureCommon/utils/model.events.util",["UWA/Core","DS/CoreEvents/ModelEvents"],(function(e,t){"use strict";var i={},n=[];return{createAppEventObject:function(e){return i[e]=new t,i[e]},subscribeEvent:function(){},getFLWebModelEventsObj:function(e){return i[e]},publishEvent:function(e){this.getFLWebModelEventsObj(e.userAction).publish({event:e.eventName,data:e.eventData}),this.cleanSubscriptionAndUserAction(e)},cleanSubscriptionAndUserAction:function(e){this.getFLWebModelEventsObj(e.userAction).unsubscribe({event:e.eventName})},deleteAppEventObject:function(e){delete i[e]},addToSubscriptionList:function(e){n.push(e)},getSubscriptionList:function(){return n},removeFromSubscriptionList:function(e){n=n.filter((function(t){return t!==e}))},clearSubscriptionList:function(){n=[]}}})),define("DS/ENOXArchitectureCommon/components/ConfirmationWindow/ConfirmationWindow",["DS/Windows/Dialog","DS/Controls/Button","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i){return{createWindow:function(n,o,r,s,a){var l=new e({title:n,content:o,width:500,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new t({label:r||i.label_submit,emphasize:"primary",onClick:function(){s(),l.close()}}),Close:new t({label:i.cancel_button,emphasize:"secondary",onClick:function(){a&&"function"==typeof a&&a(),l.close()}})}});return l.addEventListener("close",(function(){l.destroy()})),l}}})),define("DS/ENOXArchitectureCommon/utils/common.util",["UWA/Core","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","UWA/Controls/Drag","DS/Windows/Panel","DS/Controls/Tab","DS/Controls/ComboBox","DS/Utilities/KeyboardUtils","DS/ENOXArchitectureCommon/utils/model.events.util","DS/DataDragAndDrop/DataDragAndDrop","DS/ENOXArchitectureCommon/utils/config.util","DS/i3DXCompassPlatformServices/OpenWith"],(function(e,t,i,n,o,r,s,a,l,c,d,u){"use strict";let p,m=d.getFullConfig(),f=m.localStorageKeys,g=t;i.setNotificationManager(g),i.setStackingPolicy(17),require(["DS/ENOXArchitectureCommon/utils/gridview.util.extended"],(function(e){p=e}));var h={alertMessage:function(e,t,i,n){i=i?i.replace(/(\r\n|\n|\r)/gm,"<br>"):"",n=n?n.replace(/(\r\n|\n|\r)/gm,"<br>"):"",g.addNotif({level:e,title:t,subtitle:i,message:n,sticky:!1})},displayError:function(t,i,n,o){var r=o;t.errorResp&&t.errorResp.message&&500!==t.errorResp.status?r=t.errorResp.message:e.is(t.error,"string")&&(r=t.error),n=n?n.replace(/(\r\n|\n|\r)/gm,"<br>"):"",r=r?r.replace(/(\r\n|\n|\r)/gm,"<br>"):"",h.alertMessage("error",i,n,r)},create3DXJsonFromDGVSelection:function(e,t){var i,n=[];t=void 0===t||t;let o=widget.getValue("ngFilter");if(o&&(o=JSON.parse(o)),1===e.length&&e[0].isRoot()&&o&&o.filterId)i={contextId:"ctx::"+d.getSecurityContext(),displayName:o.filterTitle,displayType:m.identifiers.type_advfilter,objectId:o.filterId,objectType:m.identifiers.type_act_advfilter,envId:d.getTenant(),serviceId:"3DSpace"},n.push(i);else for(var r=0;r<e.length;r++){if(i={contextId:"ctx::"+d.getSecurityContext(),displayName:e[r].options.label,displayType:e[r].options.grid.actualType||e[r].options.type,objectId:e[r].options.physicalid,objectType:e[r].options.grid.actualType||e[r].options.type,envId:d.getTenant(),serviceId:"3DSpace"},t){var s=e[r].getParent().options.physicalid;void 0!==s&&s.length>0&&(i.path=this._createPathFor3DXContent(e[r]))}n.push(i)}return{protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("appId"),widgetId:widget.id,data:{items:n}}},_createPathFor3DXContent:function(e){for(var t=[],i=e;void 0!==i.options.physicalid;)t.push({resourceid:i.options.physicalid,type:m.identifiers.type_act_logref}),i.options.instance&&i.options.instance.physicalid&&t.push({resourceid:i.options.instance.physicalid,type:m.identifiers.type_act_loginstance}),i=i.getParent();return t.reverse()},debounce:function(e,t,i){var n;return function(){var o=this,r=arguments,s=i&&!n;clearTimeout(n),n=setTimeout((function(){n=null,i||e.apply(o,r)}),t),s&&e.apply(o,r)}},formatDate:function(e){return e instanceof Date?e:(e.indexOf("@")>=0&&(e=e.replace("@"," ")),e.indexOf(":GMT")>=0&&(e=e.replace(":GMT"," GMT")),new Date(e))},displayDate:function(e){return e instanceof Date?e.toLocaleString():new Date(e).toLocaleString()},isDateEqual:function(e,t){if(e===t)return!0;if(e&&t){var i=h.formatDate(e),n=h.formatDate(t);return i.setHours(0,0,0),n.setHours(0,0,0),i.getTime()===n.getTime()}return!1},checkIfRecentlyAuthored:function(e,t){var i,n=parseInt(widget.getPreference(f.timeoutIndex).value,10);i=t?f.recentlyAuthoredStructure:f.recentlyAuthored;var o=d.XArchStorage().getItem(i+e);if(null!==o){if(Date.now()-parseInt(o,10)<1e3*n)return!0;localStorage.removeItem(i+e)}return!1},checkIfMaturityIsReleasedOrObsolete:function(e){return null!=e&&(-1!==e.indexOf("RELEASED")||-1!==e.indexOf("OBSOLETE"))},setAuthoringMode:function(e){var t=widget.getValue("xArch_items_mode");if(t||(t={}),!e){var i=widget.getValue("previouslyOpenedItems");void 0!==i&&(e=(i=JSON.parse(i))[i.length-1])}e&&(t[e]=Date.now()),widget.setValue("xArch_items_mode",t)},isItemAuthored:function(){var e,t=widget.getValue("xArch_items_mode"),i=parseInt(widget.getPreference(f.timeoutIndex).value,10),n=widget.getValue("previouslyOpenedItems");if(void 0!==n&&(e=(n=JSON.parse(n))[n.length-1]),t&&t[e]){var o=t[e];if(null!==o){if(Date.now()-parseInt(o,10)<1e3*i)return!0;delete t[e]}}return!1},getOpenWithCompatibleApps:function(t,i){if(t){var n=d.form3DXContent([t]);i&&(n.data.items[0].objectTaxonomies=i,n.data.items[0].objectTaxonomies.push(t.options.grid.actualType||t.options.type));var o=new u;return o.set3DXContent(n,!1),e.is(o.retrieveCompatibleApps,"function")?new Promise((function(t){e.is(o.retrieveCompatibleApps,"function")?o.retrieveCompatibleApps((function(e){t(e)})):t([])})):void 0}},formObjForEditProp:function(e,t){var i=[];if(0===e.length){if(widget.getValue("currentView")&&"LandingPage"!==widget.getValue("currentView")){var n=widget.getValue("currentOpenedItem");i.push({physicalid:n,rootPID:n,metatype:"businessobject"})}}else e.forEach((function(e){e.options.instance&&e.options.instance.physicalid?i.push({physicalid:e.options.instance.physicalid,childPID:e.options.physicalid,rootPID:e.getRoot().options.physicalid,metatype:"relationship"}):e.options.linkInfo&&e.options.linkInfo.objType&&t?i.push({physicalid:e.options.linkInfo.implementId,rootPID:e.getRoot().options.physicalid,metatype:"businessobject"}):e.options.physicalid&&i.push({physicalid:e.options.physicalid,rootPID:e.getRoot().options.physicalid,metatype:"businessobject"})}));return i},downloadFile:function(e,t,i){var n="text/plain;charset=utf-8";if(i&&(t="\ufeff"+t),window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(new Blob([t],{type:n}),e);else if(document.queryCommandSupported("SaveAs")){var o=document.createElement("iframe");o.setAttribute("style","display:none;"),document.body.appendChild(o),o.contentWindow.document.open("text/html","replace"),o.contentWindow.document.write(t),o.contentWindow.document.close(),o.contentWindow.focus(),o.contentWindow.document.execCommand("SaveAs",!0,e),document.body.removeChild(o)}else{var r,s=window.document.createElement("a");"download"in s?(r=URL.createObjectURL(new Blob([t],{type:n})),s.setAttribute("download",e)):(r="data:"+n+","+encodeURIComponent(t),s.setAttribute("target","_blank"),s.setAttribute("download",e)),s.href=r,s.setAttribute("style","display:none;"),document.body.appendChild(s),setTimeout((function(){if(s.click)s.click();else if(document.createEvent){var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0),s.dispatchEvent(e)}document.body.removeChild(s)}),0)}},getBasicAttributesCURI:function(){if(m.appConfigurations&&m.appConfigurations.services)return m.appConfigurations.services.getBasicAttributesCURI&&m.appConfigurations.services.getBasicAttributesCURI()},getAdditionalAttributesCURI:function(){var e={bo:[],rel:[]};if(m.appConfigurations&&m.appConfigurations.services){var t=m.appConfigurations.services.getAdditionalAttributes&&m.appConfigurations.services.getAdditionalAttributes();t&&t.forEach((function(t){t.bo&&!e.bo.includes(t.curi)?e.bo.push(t.curi):t.bo||e.rel.includes(t.curi)||e.rel.push(t.curi)}))}return e},getAdditionalAttributes:function(){if(m.appConfigurations&&m.appConfigurations.services)return m.appConfigurations.services.getAdditionalAttributes&&m.appConfigurations.services.getAdditionalAttributes()},getUserCustomAttributes:function(e){return e?m.userAdditionalAttributesForPhysicalProduct:m.userAdditionalAttributes},getUserCustomAttributesCURI:function(){var e={bo:[],rel:[]},t=h.getUserCustomAttributes();return t&&t.forEach((function(t){t.bo&&!e.bo.includes(t.curi)?e.bo.push(t.curi):t.bo||e.rel.includes(t.curi)||e.rel.push(t.curi)})),e},createBatchServiceReqExecution:function(e,t,i,n,o){var r=e.length,s=this;if(0===r)return;n||(s.occNodesToExpand={});let a=widget.getValue(f.componentView);var c=Math.ceil(r/50),d=widget.getValue("currentConfig"),u=null;d&&d.filterCompiledForm&&(u=d.filterCompiledForm);let m=[];for(var g,h,v=0;v<c;v++)if(g=50*v,h=e.slice(g,g+50),m.push(p.getExpandServicesForBatchCalls(h,u,n,t,i)),h.forEach((function(e){e.options.noIndexOrDBExpand=!0,e.options.hasBeenExpanded=!0,n||("-1"===t?e.options.dontExpandAllLvl=!0:"2"===t&&(e.options.dontExpandTwoLvl=!0))})),n&&o&&a===f.structuredView){s.occNodesToExpand||(s.occNodesToExpand={});let e=[];h.forEach((function(t){let i=t.options.actualParent;i.options.implementLinks&&e.push(i.options.physicalid);let n=s.occNodesToExpand[i.options.physicalid]||[];n.push(t),s.occNodesToExpand[i.options.physicalid]=n})),s.actionPendingNodes||(s.actionPendingNodes={}),s.actionPendingNodes[o.options.physicalid]||(s.actionPendingNodes[o.options.physicalid]={node:o,level:t}),e.length>0&&l.getFLWebModelEventsObj("xarch-dgv-events").publish({event:"content-list-view-referenceLinks-loaded",data:e})}return Promise.all(m)},expandNodesBasedonLevel:function(){let e=this;for(let t in e.actionPendingNodes){let i=e.actionPendingNodes[t].level,n=e.actionPendingNodes[t].node;"-1"===i?n.expandAll():"2"===i&&n.expandNLevels({numberOfLevelsToExpand:"2"}),delete e.actionPendingNodes[t]}},sortNodesIntoDBandIndex:function(e,t){let i,n={},o=[],r=[];return e&&e.length>0&&e.forEach((function(e){if(t){if(i=h.checkIfRecentlyAuthored(e.options.physicalid,!0),!i){let t=e.getOccurencePath();for(let e=0;e<t.length;e+=2)if(h.checkIfRecentlyAuthored(t[e],!0)){i=!0;break}}}else i=h.checkIfRecentlyAuthored(e.options.physicalid);i?o.push(e):r.push(e)})),n.databaseNodes=o,n.indexNodes=r,n},createMapSelectableForAdditionalAttr:function(){var e={},t=this.getAdditionalAttributes();return t&&t.forEach((function(t){t.selectable&&t.selectable.length?Array.isArray(t.selectable)?t.selectable.forEach((function(i){e[i.toLowerCase()]=t})):e[t.selectable.toLowerCase()]=t:Object.values(t.selectable).flat().forEach((function(i){e[i.toLowerCase()]=t}))})),e},getNLSValueFromRangeValuesAttribute:function(e,t,i,n){if(void 0!==e.rangeValues&&i[t]&&("string"===e.type||"date"===e.type))if(n&&(n[t]=i[t]),e.multiValuated){if(i[t]=Array.isArray(i[t])?i[t]:i[t].split(","),n&&(Array.isArray(i[t])?n[t]=i[t].slice():n[t]=i[t]),"string"===e.type)for(let n=0;n<i[t].length;n++){let o=e.rangeValues.find((function(e){return e.value===i[t][n]}));o&&(i[t][n]=o.nlsValue)}else if("date"===e.type)for(let n=0;n<i[t].length;n++){let o=e.rangeValues.find((function(e){return h.isDateEqual(e.value,i[t][n])}));o&&(i[t][n]=o.formatDateValue)}}else if("string"===e.type){let n=e.rangeValues.find((function(e){return e.value===i[t]}));n&&(i[t]=n.nlsValue)}else if("date"===e.type){let n=e.rangeValues.find((function(e){return h.isDateEqual(e.value,i[t])}));n&&(i[t]=n.formatDateValue)}}};return h})),define("DS/ENOXArchitectureCommon/utils/xhr.util",["DS/WAFData/WAFData","DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/common.util","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i,n){"use strict";var o=t.getFullConfig(),r=o.webservices.getCSRFToken;return{get:function(e,t,i){return this.makeServiceCall(e,"GET",null,null,null,t)},post:function(e,t,i,n){return this.customTimeout=i,this.makeServiceCall(e,"POST",t,null,null,n)},patch:function(e,t){return this.makeServiceCall(e,"PATCH",t)},put:function(e,i,n,o){var r,s,a="PUT";return r=n?{method:a,headers:n,data:i||null}:this.generateFetchOptions(a,!0,!0,!0,!1,i),s=o&&o.targetService?o.targetService:"3DSpace",r.targetService=s,e=t.getServiceURL(s)+e,this.buildAjaxCall(e,r,a)},makeServiceCall:function(e,i,n,o,r,s){var a,l,c,d,u;a=!s||"boolean"!=typeof s.accept||s.accept,l=!s||"boolean"!=typeof s.content||s.content,c=!s||"boolean"!=typeof s.secCtx||s.secCtx,d=!s||"boolean"!=typeof s.authoringCtx||s.authoringCtx,s&&"number"==typeof s.timeout&&(this.customTimeout=s.timeout);var p=r?this.generateFetchOptions("POST",!1,!0,!0,!0,n):this.generateFetchOptions(i,a,l,c,d,n),m="",f=!1;return window.location.href.indexOf("createLogicalReferencesFromDiagram.html")>-1||window.location.href.indexOf("setArchitectureNumberOnPSpool.html")>-1?(m=window.location.href.substring(0,window.location.href.indexOf("/webapps")),f=!0):(u=s&&s.targetService?s.targetService:r?"3DSearch":"3DSpace",m=t.getServiceURL(u)),(p=r?this.generateFetchOptions("POST",!1,!0,!0,!0,n):this.generateFetchOptions(i,a,l,c,d,n,f)).targetService=u,s&&s.responseType&&(p.responseType=s.responseType),e=r?t.getServiceURL("3DSearch")+"/search":m+e,this.buildAjaxCall(e,p,i,o)},makeMultipleServiceCalls:function(e,t){var i=this;if(t)return UWA.Promise.all(e);var n=e.map((function(e){return i.makeServiceCall(e.url,e.method,e.data,e.noCSRF,e.isIndexCall)}));return UWA.Promise.all(n)},generateFetchOptions:function(e,i,n,o,r,s,a){var l={};l["Accept-Language"]=widget.lang,i&&(l.Accept="application/json"),n&&(l["Content-Type"]="application/json"),o&&(l.SecurityContext=t.getSecurityContext());var c=t.getAuthorizedWorkUnder(a);return r&&c&&"GET"!==e&&Object.assign(l,c),{method:e,headers:l,data:s||null}},buildAjaxCall:function(e,i,n,o){var s=this;return o||"POST"!==n&&"PATCH"!==n&&"DELETE"!==n?s.createPromiseFunction(e,i):window.location.href.indexOf("createLogicalReferencesFromDiagram.html")>-1||window.location.href.indexOf("setArchitectureNumberOnPSpool.html")>-1?s.get(r).then((function(t){return i.headers.ENO_CSRF_TOKEN=JSON.parse(t).csrf.value,s.get("/resources/pno/person/getsecuritycontext").then((function(t){return i.headers.SecurityContext=JSON.parse(t).SecurityContext,s.createPromiseFunction(e,i)}))})):(i.headers.ENO_CSRF_TOKEN=t.getCSRFToken(),s.createPromiseFunction(e,i))},createPromiseFunction:function(r,s){var a=this;return new Promise((function(l,c){Number.isInteger(a.customTimeout)&&(s.timeout=a.customTimeout),s.onComplete=l,s.onFailure=function(e,t,i){try{t=JSON.parse(t)}catch(e){t={}}c({error:e,errorResp:t})},s.onTimeout=function(e){i.alertMessage("error","",n.error.request_timed_out),c({error:e})},o.identifiers.tenant_based_services.indexOf(s.targetService)>=0&&(r.indexOf("?")>=0?r+="&tenant="+t.getTenant():r+="?tenant="+t.getTenant()),e.authenticatedRequest(r,s)}))}}})),define("DS/ENOXArchitectureCommon/services/common.service",["DS/ENOXArchitectureCommon/utils/xhr.util","DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/common.util","text!DS/ENOXArchitectureCommon/assets/config/identifiers.conf.json","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i,n,o){"use strict";var r=t.getFullConfig();n=JSON.parse(n);return{getPnO:function(t){return e.get(r.webservices.pno+t).then((function(e){return JSON.parse(e)}))},getItemInfo:function(t){var i=r.webservices.getItemInfo+r.webservices.getConfigInfoMask;return e.post(i,JSON.stringify(t),0).then((function(e){return JSON.parse(e)}))},getKindOfRFLP:function(t){var i=r.webservices.getItemInfo+r.webservices.isKindOfFetchField;return e.post(i,JSON.stringify(t)).then((function(e){var t=[];return e&&(e=UWA.is(e,"string")?JSON.parse(e):e).member&&e.member[0]&&e.member[0].kindOfRFLP&&e.member.forEach((function(e){t.push(e.kindOfRFLP)})),t}))},getParameterizationSetting:function(t){var n=r.webservices.getParameterizationSetting;return e.post(n,JSON.stringify(t)).then((function(e){return JSON.parse(e)})).catch((function(e){return i.displayError(e,null,null,o.error.generic_get_failed),Promise.reject()}))},getTypeSchemaDetails:function(t){var n=r.webservices.getTypeSchemaDetails;return e.post(n,JSON.stringify(t)).then((function(e){return JSON.parse(e)})).catch((function(e){return i.displayError(e,null,null,o.error.generic_get_failed),Promise.reject()}))},getExtensionsForClass:function(t){return e.post(r.webservices.getExtensionsForClass,JSON.stringify({class:t})).then((function(e){return JSON.parse(e).results})).catch((function(e){return i.displayError(e,null,null," NLS.error_get_extensions"),[]}))},getPredicateValues:function(e){return this.getNlsOfPropertiesValues(e)},getTypeHierarchy:function(t){let i;return r._typeHierarchies||(r._typeHierarchies={}),r._typeHierarchies[t]&&(i=r._typeHierarchies[t]),new Promise((function(n){if(i)return void n(i);let o={types:[t]};var s=r.webservices.getTypeHierarchy;return e.post(s,JSON.stringify(o)).then((function(e){e=JSON.parse(e),r._typeHierarchies[e.types_hierarchies[0].type]=e.types_hierarchies[0].hierarchy,n(e.types_hierarchies[0].hierarchy)})).catch((function(){n([])}))}))},getNlsOfPropertiesValues:function(t){return e.post(r.webservices.predicateValue,JSON.stringify(t)).then((function(e){return JSON.parse(e)}))},getClassPredicates:function(t){return e.post(r.webservices.getClassPredicates,t).then((function(e){var t=JSON.parse(e);if(!t)return t;var i=[];return t.classPredicates&&t.classPredicates.forEach((function(e){var t={classInfo:{},properties:[]};e.className&&(t.classInfo={curi:e.className,uri:"http://www.3ds.com/vocabularies/"+e.className.replace(":","/")}),e.vocabularyPredicateInfo&&e.vocabularyPredicateInfo.forEach((function(e){var i={curi:e.uri,uri:"http://www.3ds.com/vocabularies/"+e.uri.replace(":","/"),label:e.nlsName,description:e.nlsName,dataType:e.range.dataTypes[0],dimension:e.dimension,manipulationUnit:e.manipulationUnit,originCuri:"ds6wg:"+e.name};e.rangeValues&&e.rangeValues.literalInfo&&(i.rangeValues=e.rangeValues.literalInfo),e.nature&&(i.nature=e.nature),e.selectable&&(i.selectable=e.selectable),e.userAccess&&(i.userAccess=e.userAccess),t.properties.push(i)})),i.push(t)})),i}))}}})),define("DS/ENOXArchitectureCommon/services/authoring.service",["DS/ENOXArchitectureCommon/utils/xhr.util","DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/common.util","text!DS/ENOXArchitectureCommon/assets/config/identifiers.conf.json","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i,n,o){"use strict";var r=t.getFullConfig();return n=JSON.parse(n),{updateAttribute:function(t){var n=[],s=r.webservices.updateAttributes;return t instanceof Array&&t.length>1e3&&i.alertMessage("warning",null,o.replace(o.warning.bulkOperation_limit_reached,{limit:1e3})),t.forEach((function(e){var t={method:"PATCH",body:[],queryParams:{select:["physicalid","modified"]}};for(var i in e.instID?t.path="model/rel/"+e.instID:t.path="model/bus/"+e.refID,e.attributes)e.attributes.hasOwnProperty(i)&&(e.attributes[i]&&e.attributes[i].unitName&&e.attributes[i].dimensionType?t.body.push({op:"replace",path:i,value:e.attributes[i].value,unitName:e.attributes[i].unitName,dimensionType:e.attributes[i].dimensionType}):t.body.push({op:"replace",path:i,value:e.attributes[i]}),t.queryParams.select.push("attribute["+i+"]"));n.push(t)})),e.makeServiceCall(s,"PUT",JSON.stringify({requests:n})).then((function(e){var t=JSON.parse(e).results;if(t){var i=[];for(var n in t)0!==t[n].body.errors.length&&i.push({physicalid:t[n].body.physicalid,errors:t[n].body.errors});return 0!==i.length?Promise.reject({error:{message:o.error.no_modification_possible,errorList:i}}):t}return Promise.reject()}))}}})),define("DS/ENOXArchitectureCommon/services/config.service",["DS/SearchDictionaryAccess/SearchDictionaryAccessAPI","DS/ENOXArchitectureCommon/utils/xhr.util","DS/ENOXArchitectureCommon/services/common.service"],(function(e,t,i){"use strict";var n={PRIVATE:"Private",IN_WORK:"In Work",FROZEN:"Frozen",RELEASED:"Released",OBSOLETE:"Obsolete"};return{extendConfiguration:function(e){var t=this;let i=[t._getSubTypesMetaData(e),t._getBasicAttributesProperties(e),t._getNlsMaturityValues(e)];return Promise.all(i)},_getNlsMaturityValues:function(e){return i.getNlsOfPropertiesValues({"ds6w:status":["PRIVATE","IN_WORK","FROZEN","RELEASED","OBSOLETE"]}).then((function(t){var i=t["ds6w:status"];for(var n in e.MAPPING_MATURITY={},i)i.hasOwnProperty(n)&&(e.MAPPING_MATURITY[n]=i[n])})).catch((function(){e.MAPPING_MATURITY=n}))},getNLSOfKeyValues:function(e){return i.getNlsOfPropertiesValues(e).then((function(e){if(e)return e})).catch((function(){console.warn("FedDictionaryAccessAPI.getNlsOfPropertiesValues failed for"+e)}))},_getBasicAttributesProperties:function(t){let i=t.identifiers.index_services.select_bo.filter((function(e){return e.startsWith("ds6w")&&"ds6wg:EXC_PROTECTION_EXISTS"!==e})),n=t.identifiers.index_services.select_rel.filter((function(e){return e.startsWith("ds6w")})),o=[];return[{predicatesList:i,configNlsKey:"nlsBasicAttributesBO"},{predicatesList:n,configNlsKey:"nlsBasicAttributesRel"}].forEach((function(i){o.push(new Promise((function(n,o){e.get6wResourcesInfo(i.predicatesList.join(","),{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(e){t[i.configNlsKey]={};for(let n=0;n<e.length;n++)t[i.configNlsKey][e[n].curi]=e[n].label;n()},onFailure:function(){o()}})})))})),Promise.all(o)},_getSubTypesMetaData:function(e){return e.logicalRefSubTypes=[],t.post(e.webservices.dsfl_getSubTypesMetaData,JSON.stringify([e.identifiers.type_act_logref]),0).then((function(t){e.logicalRefSubTypes=JSON.parse(t).Types,e.logicalRefSubTypes.forEach((function(t){void 0===e.mappingType[t.Name]&&(e.mappingType[t.Name]={nlsName:t.NLS,icon:t.IconName,custo:"True"===t.Custo})})),e.mappingType.iconsPath=JSON.parse(t).iconsPath,e.mappingType.iconsCommonImagePath=JSON.parse(t).iconsCommonImagePath})).catch((function(e){}))}}})),define("DS/ENOXArchitectureCommon/parser/index.parser",["DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/config.util","WebappsUtils/WebappsUtils","DS/ENOXArchitectureCommon/services/config.service","text!DS/ENOXArchitectureCommon/assets/config/mapping.conf.json"],(function(e,t,i,n,o){"use strict";var r=JSON.parse(o),s=t.getFullConfig(),a=s.identifiers,l={attributes:function(t){let i=this,n=[],o=e.getAdditionalAttributes(),a=[],l=[],c=[];return o&&o.forEach((function(e){e.manipulationUnit&&a.push(e.curi),e.multiValuated&&l.push(e.curi),(e.isSharedPredicateOnSameType||e.isSharedPredicate&&(e.isClassification||e.isOnExtension))&&c.push(e.curi)})),t&&t.forEach((function(t){let d,u,p={};for(d in t)if(u=r[d],"ds6w:label"===d)p.label=t[d];else if("ds6wg:revision"===d)p.revision=t[d];else if("ds6w:islastrevision"===d)p.isLastVersion="TRUE"===t[d].toUpperCase();else if("ds6w:status"===d)p.status=t[d],p[u]=s.MAPPING_MATURITY[t[d].split(".")[1]]||t.current;else if("ds6w:responsible"===d)p.owner=t[d];else if("ds6w:reserved"===d)p.isReserved=t[d];else if("ds6w:created"===d||"ds6w:modified"===d)p[u]=e.formatDate(t[d]);else if("ds6w:description"===d)p.description=t[d];else if("ds6w:type"===d){let e=s.mappingType[t[d]];e&&e.nlsName&&(p[u]=e.nlsName),p.actualType=t[d]}else if("type_icon_url"===d)p.icons={iconPath:t[d],iconSize:{height:"16px",width:"16px"}};else if("ds6w:identifier"===d)p[u]=t[d];else if("ds6wg:architectureextension.v_architecturenumber"===d)p[u]=t[d];else if("taxonomies"===d){let e,n=t[d];if(Array.isArray(n))for(var m=0;m<n.length&&(e=i.getKindOfRFLPFromTaxonomy(n[m]),null===e);m++);else e=i.getKindOfRFLPFromTaxonomy(n);p.kindOfRFLP=e,p[d]=t[d]}else(l.indexOf(d)>=0||c.indexOf(d)>=0)&&!Array.isArray(t[d])&&(t[d]=t[d]?[t[d]]:[]),a.indexOf(d)>=0?(p[d+"_actual"]=t[d],p[d]=""):p[d]=t[d];o&&o.forEach((function(t){e.getNLSValueFromRangeValuesAttribute(t,t.curi,p)})),"R"===p.kindOfRFLP&&(p.isLastVersion=void 0),n.push(p)})),n},parseDataToNodeFormat:function(e){let t=e.data,i=[];return t.forEach((function(t){let n={physicalid:t.physicalid,label:t.label,type:t.actualType||t.type,icons:[t.icons],children:void 0};e.virtual&&(n.virtual=e.virtual),n.grid=JSON.parse(JSON.stringify(t)),i.push(n)})),i},getKindOfRFLPFromTaxonomy:function(e){return e.indexOf(a.type_usecase)>=0||e.indexOf(a.type_requirement)>=0||e.indexOf(a.type_reqSpec)>=0||e.indexOf(a.type_reqGroup)>=0?"R":e.indexOf(a.type_act_functref)>=0?"F":e.indexOf(a.type_act_logref)>=0?"L":e.indexOf(a.type_act_physical)>=0?"P":null},progressiveExpandParser:function(t){let i=this;if(!t.results)return null;let o={},r={},s=[],l=[];if(t){let c=t.results||[],d=e.getAdditionalAttributes(),u=[],p=[],m=[],f={},g={};d&&d.forEach((function(e){e.manipulationUnit&&u.push(e.curi),e.multiValuated&&p.push(e.curi),(e.isSharedPredicateOnSameType||e.isSharedPredicate&&(e.isClassification||e.isOnExtension))&&m.push(e.curi)}));for(let e=0;e<c.length;e++){let t,n=c[e];n.taxonomies?(-1!==n.taxonomies.indexOf(a.type_act_logref)?t=i.parseProgressiveExpandItemAttr(n,u,p,m,f,g):-1!==n.taxonomies.indexOf(a.type_act_loginstance)&&(t=i.parseProgressiveExpandInstAttr(n,u,p,m,f,g)),t&&(r[t.resourceid]={attributes:t})):n.Path&&s.push(n.Path)}l.push(n.getNLSOfKeyValues(f).then((function(e){for(let t of Object.keys(g)){if(!r[t])continue;let i=r[t].attributes,n=g[t];for(let t in n){let o=e[t]?e[t][n[t]]:void 0;o&&(i.grid[t]=o)}}}))),o.map=r,o.paths=s}return Promise.all(l).then((function(){return o}))},parseProgressiveExpandItemAttr:function(n,o,l,c,d,u){if(n){let f=t.getUser("isTrigram"),g=t.getUser("isFullName"),h={grid:{}};for(let i in n){let f=r[i];if("taxonomies"===i)h.type=a.type_act_logref,h.grid.kindOfRFLP="L",h.grid[i]=n[i];else if("physicalid"===i||"logicalid"===i||"majorid"===i||"resourceid"===i)h[i]=n[i],h.grid[i]=n[i];else if("ds6w:label"===i)h.label=n[i];else if("ds6w:type"===i){var p=s.mappingType[n[i]];p?(h.grid[f]=p.nlsName,h.icons=p.icon?[t.getTypeIconUrl(n[i])]:[t.getTypeIconUrl(a.type_act_logref)]):(h.grid[f]=n[i],h.icons=[t.getTypeIconUrl(a.type_act_logref)]),h.grid.actualType=n[i]}else if("ds6w:status"===i)h[f]=n[i],h.grid[f]=s.MAPPING_MATURITY[n[i].split(".")[1]];else if("ds6w:created"===i||"ds6w:modified"===i)h.grid[f]=e.formatDate(n[i]);else if("ds6w:islastrevision"===i)h.grid.isLastVersion="TRUE"===n[i].toUpperCase();else if("ds6w:reserved"===i)h.grid.isReserved=n[i];else if("ds6w:reservedBy"===i)h.grid.reservedBy=n[i]?n[i]:"";else if("ds6wg:EXC_PROTECTION_EXISTS"===i)h.grid.isIPProtected="TRUE"===n[i];else if("ro.plminstance.v_effectivitycompiledform"===i)h[f]=n[i];else{var m=f||i;if(l.indexOf(m)>=0||c.indexOf(m)>=0)o.indexOf(m)>=0?(h.grid[m+"_actual"]=[],n[i]&&(h.grid[m+"_actual"]=n[i].split(","))):h.grid[m]=n[i].split(",");else if(o.indexOf(m)>=0)h.grid[m+"_actual"]=n[i],h.grid[m]="";else if("ds6w:organizationResponsible"===m){let e=n[m];d[m]||(d[m]=[]),d[m].indexOf(e)<0&&d[m].push(e),u[h.resourceid]||(u[h.resourceid]={}),u[h.resourceid][m]=e,h.grid[m]=n[i]}else h.grid[m]=n[i]}}if(h.type===a.type_act_logref){h.grid.isIPProtected||(h.grid.isIPProtected=!1),h.grid.isReservedByOther=!1,"FALSE"===h.grid.isReserved?(h.isReserved=h.grid.isReserved,h.grid.isReserved=i.getWebappsAssetUrl("ENOXArchitectureCommon","icons/I_CheckIn.png")):h.grid.reservedBy===f||h.grid.reservedBy===g?(h.isReserved=h.grid.isReserved,h.grid.isReserved=i.getWebappsAssetUrl("ENOXArchitectureCommon","icons/I_lock.png")):(h.isReserved=h.grid.isReserved,h.grid.isReserved=i.getWebappsAssetUrl("ENOXArchitectureCommon","icons/I_ReservedByOthers.png"),h.grid.isReservedByOther=!0);let t=e.getAdditionalAttributes();t&&t.forEach((function(t){t.bo&&(void 0===h.grid[t.curi]&&(l.indexOf(t.curi)>=0||c.indexOf(t.curi)>=0?h.grid[t.curi]=[]:h.grid[t.curi]=""),e.getNLSValueFromRangeValuesAttribute(t,t.curi,h.grid,h))})),h.grid.description=h.grid.description||"",h.grid.architectureNumber=h.grid.architectureNumber||""}return h.physicalid||(h.physicalid=h.resourceid),h}},parseProgressiveExpandInstAttr:function(t,i,n,o,l,c){if(t){let p={grid:{}};for(let e in t){let m=r[e];if("taxonomies"===e)p.type=a.type_act_loginstance;else if("physicalid"===e||"logicalid"===e||"majorid"===e||"resourceid"===e)p[e]=t[e],p.grid[e]=t[e];else if("from"===e||"to"===e)p[e]=t[e];else if("ds6w:label"===e)p.label=t[e];else if("ds6w:description"===e)p.description=t[e];else if("ds6w:type"===e){var d=s.mappingType[t[e]];p.grid[m]=d?d.nlsName:t[e],p.grid.actualType=t[e]}else{var u=m||e;if(n.indexOf(u)>=0||o.indexOf(u)>=0)i.indexOf(u)>=0?(p.grid[u+"_actual"]=[],t[e]&&(p.grid[u+"_actual"]=t[e].split(","))):p.grid[u]=t[e].split(",");else if(i.indexOf(u)>=0)p.grid[u+"_actual"]=t[e],p.grid[u]="";else if("ds6w:organizationResponsible"===u){let i=t[u];l[u]||(l[u]=[]),l[u].indexOf(i)<0&&l[u].push(i),c[p.resourceid]||(c[p.resourceid]={}),c[p.resourceid][u]=i,p.grid[u]=t[e]}else p.grid[u]=t[e]}}let m=e.getAdditionalAttributes();return m&&m.forEach((function(t){t.bo||(void 0===p.grid[t.curi]&&(n.indexOf(t.curi)>=0||o.indexOf(t.curi)>=0?p.grid[t.curi]=[]:p.grid[t.curi]=""),e.getNLSValueFromRangeValuesAttribute(t,t.curi,p.grid,p))})),p.description=p.description||"",p.physicalid||(p.physicalid=p.resourceid),p}}};return l})),define("DS/ENOXArchitectureCommon/services/index.service",["DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/xhr.util","DS/ENOXArchitectureCommon/parser/index.parser","text!DS/ENOXArchitectureCommon/assets/config/expandv2.conf.json"],(function(e,t,i,n,o){"use strict";var r=t.getFullConfig(),s=r.identifiers,a=(r.localStorageKeys,JSON.parse(o));return{expandV2:function(e){var t=r.webservices.progressiveExpand;return"Flat"===e.synthType&&(a.withConfigFilter_FlatSynth_Json.batch.expands[0].label="SAX_FlatSynthWithCfg_"+Date.now(),a.withConfigFilter_FlatSynth_Json.batch.expands[0].root.physical_id=e.forSynthesis.IDs,e.forSynthesis.configFilter?(a.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.config_filter=e.forSynthesis.configFilter,a.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.all&&delete a.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.all):(a.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.all=1,a.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.config_filter&&delete a.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.config_filter)),i.makeServiceCall(t,"POST",JSON.stringify(a.withConfigFilter_FlatSynth_Json),!0,null,{timeout:0})},navigate:function(o){o.attributes=o.attributes.concat(e.getUserCustomAttributesCURI().bo);let s=r.webservices.navigateService+"?SecurityContext="+t.getSecurityContext();return i.makeServiceCall(s,"POST",JSON.stringify(o),!0,null,{timeout:0}).then((function(e){if((e=e&&UWA.is(e,"string")?JSON.parse(e):e)&&e.infos&&"OK"===e.infos.status){let t,i=e.result,o={};return i.forEach((function(e){let i={};i.input_object=n.attributes([e.input_object]);let r=e.outputs;for(t in r)r.hasOwnProperty(t)&&(i[t]=n.attributes(r[t]));o[e.input_object.physicalid]=i})),o}}))},progressiveExpand:function(o,s){let a=this,l={},c=[],d=o.expandLevel||1,u=o.FBIProxy||o.filterBI;if(u&&o.groupingFilter){var p={groupingIntent:o.groupingFilter};p.root_path_physicalid=o.pathIds[0],l=u.getExpandSpec(p.root_path_physicalid[0],p).batch}else{for(let e in o.rootWithPaths){let t={label:"ENOXArchitectureCommon-ExecuteExpand-"+e,root:{physical_id:e}};o.filter?(t.filter=o.filter,o.aggregation_processors&&(t.aggregation_processors=o.aggregation_processors)):(t.filter=a.getFiterQueryForProgExp(e,o.rootWithPaths,o.configFilter),t.graph=a.getGraphQueryForProgExp(),-1!==d&&(t.aggregation_processors=a.getAggProcForProgExp(e,o.rootWithPaths,d))),c.push(t)}l.expands=c}var m={};let f=e.getBasicAttributesCURI();var g=f&&f.select_bo?f.select_bo:r.identifiers.index_services.select_bo.slice(),h=f&&f.select_rel?f.select_rel:r.identifiers.index_services.select_rel.slice(),v=e.getAdditionalAttributesCURI();g=g.concat(v.bo),h=h.concat(v.rel),m.select_object=g,m.select_relation=h,m.format="entity_relation_occurrence";let y={batch:l,outputs:m};var b=r.webservices.progressiveExpand+"?output_format=cvjson&SecurityContext="+t.getSecurityContext();return i.makeServiceCall(b,"POST",JSON.stringify(y),!0,null,{timeout:0}).then((e=>(e=UWA.is(e,"string")?JSON.parse(e):e,n.progressiveExpandParser(e,s))))},getFiterQueryForProgExp:function(e,t,i){let n=this,o='(flattenedtaxonomies:"reltypes/'+s.type_act_loginstance+'")',r=[];return t[e].length>0&&r.push(n.createOrFilterForPaths(t[e])),i&&r.push({config_filter:i}),r.push({and:{filters:[{sequence_filter:n.getSequenceFilter(o)}]}}),{and:{filters:r}}},createOrFilterForPaths:function(e){let t=this,i=[];for(let n=0;n<e.length;n++)i.push(t.getPrefixFilter(e[n]));return{or:{filters:i}}},getPrefixFilter:function(e){return{prefix_filter:{prefix_path:[{physical_id_path:e}]}}},getSequenceFilter:function(e){return{sequence:[{uql:e}]}},getGraphQueryForProgExp:function(){let e={};return e.descending_condition_relation={uql:'flattenedtaxonomies:"reltypes/'+s.type_act_loginstance+'"'},e.descending_condition_object={uql:'(flattenedtaxonomies:"types/'+s.type_act_logref+'")'},e},getAggProcForProgExp:function(e,t,i){let n=[],o=this.createOrFilterForPaths(t[e]);return o.max_distance_from_prefix=i.toString(),n.push({truncate:o}),n}}})),define("DS/ENOXArchitectureCommon/utils/contextManager.util",["UWA/Class","DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/config.util"],(function(e,t,i){"use strict";return e.singleton({_selectedItems:[],getContext:function(e){return this.treeDocument=e,this.elements={container:widget.body},this.displayNotification=function(e){"error"===e.eventID||"warning"===e.eventID?t.alertMessage("error",null,e.msg||e):t.alertMessage("success",null,e.msg||e)},this},init:function(e){this.options={widget:widget},this._parent(e)},addSelection:function(e){var t=this;UWA.is(e,"array")?e.forEach((function(e){t._selectedItems.push(e)})):(e.object="",this._selectedItems.push(e))},getSelectedNodes:function(){return this._selectedItems},resetSelection:function(){this._selectedItems=[],this.isIndexMode=null},getSecurityContext:function(){return{SecurityContext:"ctx::"+i.getSecurityContext()}}})})),define("DS/ENOXArchitectureCommon/components/GenericCommands/command.controller",["DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/contextManager.util","DS/ENOXArchitectureCommon/utils/modelObj.util"],(function(e,t,i){"use strict";return{init:function(e,t){e&&this._generateCommand(e,t)},_generateCommand:function(n,o){var r,s,a=this;switch(t.resetSelection(),n){case"HistoryCommand":!o.context&&o.attributes?(o.attributes.forEach((function(e){r=new i(e),t.addSelection(r)})),s=t.getContext()):s=o.context.treeDocument,require(["DS/LifecycleCmd/HistoryCmd","css!DS/egraph/views.css"],(function(e){a.historyCmd&&a.historyCmd.historyDlg||(a.historyCmd=new e({context:s,ID:"HistoryHdr"}),a._beginCommand(a.historyCmd))}));break;case"DuplicateCommand":require(["DS/LifecycleCmd/DuplicateCmd"],(function(e){a.duplicateCmd=new e({context:o.context.treeDocument,ID:"DuplicateHdr"}),a._beginCommand(a.duplicateCmd)}));break;case"MaturityCommand":!o.context&&o.attributes?(o.attributes.forEach((function(e){r=new i(e),t.addSelection(r)})),s=t.getContext()):s=o.context.treeDocument,require(["DS/LifecycleCmd/MaturityCmd","css!DS/egraph/views.css"],(function(e){a.maturityCmd=new e({context:s,ID:"MaturityHdr"}),a._beginCommand(a.maturityCmd)}));break;case"ChangeOwnerCommand":!o.context&&o.attributes?(o.attributes.forEach((function(e){r=new i(e),t.addSelection(r)})),s=t.getContext()):s=o.context.treeDocument,require(["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeOwnerCmd"],(function(e){a.changeOwnerCmd=new e({context:s,ID:"ActionBar_ChangeOwner"}),a._beginCommand(a.changeOwnerCmd)}));break;case"CompareCmd":require(["DS/CompareCmd/CompareCmd"],(function(t){o.context.treeDocument.getSecurityContext=function(){return{SecurityContext:"ctx::"+e.getSecurityContext()}},a.compareCmd=new t({context:o.context.treeDocument,ID:"CompareHdr"}),a._beginCommand(a.compareCmd)}));break;case"ShareCmd":require(["DS/ENOCollabSharingCmds/commands/AccessRightCmd/ActionBar_AccessRightCmd"],(function(t){o.context.treeDocument.getSecurityContext=function(){return{SecurityContext:"ctx::"+e.getSecurityContext()}},a.shareCmd=new t({context:o.context.treeDocument,ID:"ActionBar_AccessRightCmd"}),a._beginCommand(a.shareCmd)}));break;case"ReserveCmd":require(["DS/ENOCollabSharingCmds/commands/ReserveCmd/ActionBar_ReserveCmd"],(function(e){a.reserveHdr=new e({context:o.context.treeDocument,ID:"ReserveHdr"}),a._beginCommand(a.reserveHdr)}));break;case"UnreserveCmd":require(["DS/ENOCollabSharingCmds/commands/UnreserveCmd/ActionBar_UnreserveCmd"],(function(e){a.unreserveHdr=new e({context:o.context.treeDocument,ID:"UnreserveHdr"}),a._beginCommand(a.unreserveHdr)}))}},_beginCommand:function(e){e.begin()}}})),define("DS/ENOXArchitectureCommon/components/Edition/CopyPasteDialog",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENOXArchitectureCommon/model/TreeNodeModel","DS/DataGridView/DataGridView","DS/Windows/Dialog","DS/Controls/Button","DS/UIKIT/Mask","DS/ENOXArchitectureCommon/services/authoring.service","DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/model.events.util","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i,n,o,r,s,a,l,c,d,u){"use strict";var p=l.getFullConfig();return{open:function(i,s){var a=this;a.item=i,a.collectionView=s,a.treeDocument=s.treeDocument,a.availableAttributes=new e({useAsyncPreExpand:!0}),a.availableAttributes.addChild([new t({ds6w:"ds6w:label",dataIndex:"title",selectable:"PLMEntity.V_Name",bo:!0,grid:{iconType:"object-reference",name:l.getNlsBasicAttributesBO("ds6w:label"),declaredIn:u.label.all}}),new t({ds6w:"ds6w:description",dataIndex:"description",selectable:"PLMEntity.V_description",bo:!0,grid:{iconType:"object-reference",name:l.getNlsBasicAttributesBO("ds6w:description"),declaredIn:u.label.all}})]),i.options.instance&&(a.availableAttributes.addChild(new t({ds6w:"ds6w:label",dataIndex:"instanceName",selectable:"PLMInstance.PLM_ExternalID",bo:!1,grid:{iconType:"object-instance",name:l.getNlsBasicAttributesBO("ds6w:label"),declaredIn:u.label.all}}),1),a.availableAttributes.addChild(new t({ds6w:"ds6w:description",dataIndex:"description",selectable:"PLMInstance.V_description",bo:!1,grid:{iconType:"object-instance",name:l.getNlsBasicAttributesBO("ds6w:description"),declaredIn:u.label.all}})));var d=c.getAdditionalAttributes();d&&d.forEach((function(e){!e.bo&&!i.options.instance||e.readOnly||(!e.declaredInArray||e.isOnExtension||e.isClassification||e.bo&&e.declaredInArray.includes(a.item.options.grid.actualType)||!e.bo&&e.declaredInArray.includes(a.item.options.grid.instance_actualType))&&a.availableAttributes.addChild(new t({ds6w:e.curi,selectable:e.selectable,bo:e.bo,dimension:e.dimension,manipulationUnit:e.manipulationUnit,rangeValues:e.rangeValues,grid:{iconType:e.bo?"object-reference":"object-instance",name:e.nls||e.curi,declaredIn:e.declaredIn},declaredInArray:e.declaredInArray,isOnExtension:e.isOnExtension,isClassification:e.isClassification,type:e.type}))})),a.dialogDGV=new o({title:u.label.copy_attributes+" - "+u.label.select,height:500,width:700,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new r({label:u.action.copy,emphasize:"primary",disabled:!0,onClick:function(){a.selectedAttributes=a.dgv.treeDocument.getSelectedNodes(),a.treeDocument.getSelectedNodes()[0].unselect(),a.tokenPostAdd=a.treeDocument.getXSO().onPostAdd(a._onXSOChanged.bind(a,a.item,a.treeDocument)),a.tokenPostRemove=a.treeDocument.getXSO().onPostRemove(a._onXSOChanged.bind(a,a.item,a.treeDocument)),c.alertMessage("success",null,u.success.copy_attributes),a.dialogDGV.close()}}),Close:new r({emphasize:"secondary",onClick:function(){a.dialogDGV.close()}})}}),a.dgv=new n({identifier:"ENOXArchCommon_CopyAttributes_AttributesSelector",height:"inherit",treeDocument:a.availableAttributes,selectionBehavior:{unselectAllOnEmptyArea:!1},columns:[{typeRepresentation:"icon",dataIndex:"iconType",width:40},{text:u.label.name,dataIndex:"name"},{text:u.label.declared_in,dataIndex:"declaredIn"}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!1,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t},getCellTooltip:function(e){return e.nodeModel&&0===e.columnID?{shortHelp:e.nodeModel.options.bo?u.label_declared_in_reference:u.label_declared_in_instance,updateModel:!1}:a.dgv.getCellDefaultTooltip(e)}}),a.dialogDGV.elements._contentDiv.appendChild(a.dgv.getContent()),a.dgv.treeDocument.setFilterModel({name:{filterId:"stringRegexp"},declaredIn:{filterId:"stringRegexp"}}),a.tokenPostAdd=a.dgv.treeDocument.getXSO().onPostAdd((function(){a.dialogDGV.buttons.Ok.disabled=!1})),a.tokenPostRemove=a.dgv.treeDocument.getXSO().onPostRemove((function(){0===a.dgv.treeDocument.getSelectedNodes().length&&(a.dialogDGV.buttons.Ok.disabled=!0)})),a.dialogDGV.addEventListener("close",(function(){a.dialogDGV.destroy()}))},_postSelectionCall:function(){var e=this;e.treeDocument.getSelectedNodes()[0].unselect(),e.tokenPostAdd=e.treeDocument.getXSO().onPostAdd(e._onXSOChanged.bind(e,e.item,e.treeDocument)),e.tokenPostRemove=e.treeDocument.getXSO().onPostRemove(e._onXSOChanged.bind(e,e.item,e.treeDocument))},submit:function(){var e=this;if(void 0!==e.selectedNodes&&0!==e.selectedNodes.length){s.mask(widget.body,u.message.processing);var t,n=[],o=!1,r=!1,m={};e.selectedNodes.forEach((function(i){var s={},a={},l={objectLabel:i.options.label,instance_pid:i.options.instance?i.options.instance.physicalid:null,icons:[i.options.icons[0]],refAttributes:[],instAttributes:[]};m[i.options.physicalid]=l;for(var d=0;d<e.selectedAttributes.length;d++){var u=e.selectedAttributes[d].options.dataIndex||e.selectedAttributes[d].options.ds6w,p=!1,f=e.selectedAttributes[d].options.isOnExtension,g=e.selectedAttributes[d].options.isClassification;(!e.selectedAttributes[d].options.declaredInArray||f||g||e.selectedAttributes[d].options.bo&&e.selectedAttributes[d].options.declaredInArray.includes(i.options.grid.actualType)||!e.selectedAttributes[d].options.bo&&e.selectedAttributes[d].options.declaredInArray.includes(i.options.grid.instance_actualType))&&(p=!0),e.selectedAttributes[d].options.bo?l.refAttributes.push({name:e.selectedAttributes[d].options.grid.name,iconType:e.selectedAttributes[d].options.grid.iconType,copySuccessful:!1,isDeclaredIn:p,isOnExtension:f,isClassification:g,responsibleForError:void 0,bo:!0}):l.instAttributes.push({name:e.selectedAttributes[d].options.grid.name,iconType:e.selectedAttributes[d].options.grid.iconType,copySuccessful:!1,isDeclaredIn:p,isOnExtension:f,responsibleForError:void 0});var h=e.selectedAttributes[d].options.selectable;if(void 0===h.length){var v=null;(v=!e.selectedAttributes[d].options.bo&&i.options.instance?i.options.grid.instance_actualType:i.options.grid.actualType)&&(h=e.selectedAttributes[d].options.selectable[v])}if("title"===u)s[h]=e.item.options.label;else if("instanceName"===u)a[h]=e.item.options.grid.instanceName;else{let i=e.selectedAttributes[d].options.bo?u:"instance_"+u,n=Array.isArray(e.item.options.grid[i]),o={};if(e.selectedAttributes[d].options.manipulationUnit)o={unitName:e.selectedAttributes[d].options.manipulationUnit,dimensionType:e.selectedAttributes[d].options.dimension,value:e.item.options.grid[i]};else if("date"===e.selectedAttributes[d].options.type)if(void 0!==e.selectedAttributes[d].options.rangeValues)if(n){for(var y=[],b=0;b<e.item.options.grid[i].length;b++){let t=e.selectedAttributes[d].options.rangeValues.find((function(t){if(t.formatDateValue)return c.isDateEqual(t.value,e.item.options.grid[i][b])}));void 0!==t?y.push(t.value):y.push(e.item.options.grid[i][b])}o=y}else{let t=e.selectedAttributes[d].options.rangeValues.find((function(t){if(t.formatDateValue)return c.isDateEqual(t.value,e.item.options.grid[i])}));o=void 0!==t?t.value:e.item.options.grid[i]}else n?(t=[],t=e.item.options.grid[i].map((function(e){let t=c.formatDate(e);return t=t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+"@12:00:00:GMT",t}))):(t="",e.item.options.grid[i]&&(t=(t=c.formatDate(e.item.options.grid[i])).getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+"@12:00:00:GMT")),o=t;else o=e.item.options.grid[i];e.selectedAttributes[d].options.bo?s[h]=o:a[h]=o}}Object.keys(s).length>0&&(n.push({refID:i.options.physicalid,attributes:s}),o=!0),Object.keys(a).length>0&&i.options.instance&&(n.push({instID:i.options.instance.physicalid,attributes:a}),r=!0)})),a.updateAttribute(n).then((function(t){let n={};for(var s=0;s<t.length;s++)t[s].body.oldInstancePhysicalid?n[t[s].body.oldInstancePhysicalid]=t[s].body:n[t[s].body.physicalid]=t[s].body;for(var a={grid:{}},u={grid:{}},f=0;f<e.selectedAttributes.length;f++){var g=e.selectedAttributes[f].options.dataIndex||e.selectedAttributes[f].options.ds6w;"title"===g?a.label=e.item.options.label:e.selectedAttributes[f].options.bo?(e.selectedAttributes[f].options.manipulationUnit&&(a.grid[g+"_actual"]=e.item.options.grid[g+"_actual"]),a.grid[g]=e.item.options.grid[g]):"instanceName"===g?u.grid[g]=e.item.options.grid[g]:(e.selectedAttributes[f].options.manipulationUnit&&(u.grid["instance_"+g+"_actual"]=e.item.options.grid["instance_"+g+"_actual"]),u.grid["instance_"+g]=e.item.options.grid["instance_"+g])}let h={},v=[],y=[],b=[];for(var C=0;C<e.selectedNodes.length;C++){var I,S,N,D,O=e.selectedNodes[C],_=!1,E=!1;let t=[],s=[];if(o){I=n[O.options.physicalid],N=I&&I.modified?c.formatDate(I.modified.value[0]):null;var A=new Date(O.options.grid.modificationDate);_=!(!N||!A)&&N.getTime()!==A.getTime()}if(r&&O.options.instance){S=n[O.options.instance.physicalid],D=S&&S.modified?c.formatDate(S.modified.value[0]):null;var w=O.options.instance?new Date(O.options.instance.modificationDate):null;E=!(!D||!w)&&D.getTime()!==w.getTime()}if(o&&_&&l.XArchStorage().setItem(p.localStorageKeys.recentlyAuthored+O.options.physicalid,Date.now()),r&&E&&l.XArchStorage().setItem(p.localStorageKeys.recentlyAuthoredStructure+O.getParent().options.physicalid,Date.now()),(e.treeDocument.getMappedNodesFromId(O.options.physicalid)||[O]).forEach((function(e){if(_&&(a.grid.modificationDate=N,e.updateOptions(JSON.parse(JSON.stringify(a))),m[O.options.physicalid].refAttributes.forEach((function(e){e.copySuccessful=!0}))),e.options.instance&&E)if(S&&S.oldInstancePhysicalid){let n=e.getParent(),o=new i({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,physicalid:e.options.physicalid,instance:{physicalid:S.physicalid},grid:{physicalid:e.options.physicalid},actualParent:e.options.actualParent,children:[]});o.setRelationID(S.physicalid),n.addChild(o,e._rowID),t.push(o),s.push(e),m[O.options.physicalid].instAttributes.forEach((function(e){e.copySuccessful=!0}))}else e.options.instance.physicalid===O.options.instance.physicalid&&(u.instance={modificationDate:D},e.updateOptions(JSON.parse(JSON.stringify(u))),m[O.options.physicalid].instAttributes.forEach((function(e){e.copySuccessful=!0})));function n(e,t){var i=!1;for(const[n,o]of Object.entries(t))if("grid"===n){for(const[t,n]of Object.entries(o))if(e.grid[t]!==n){i=!0;break}}else if("instance"!==n&&e[n]!==o){i=!0;break}return!i}o&&!_&&n(e.options,a)&&m[O.options.physicalid].refAttributes.forEach((function(e){e.equalValues=!0})),r&&e.options.instance&&!E&&n(e.options,u)&&m[O.options.physicalid].instAttributes.forEach((function(e){e.equalValues=!0}))})),t.length>0&&s.length>0){let e=n[O.options.instance.physicalid];h[e.oldInstancePhysicalid]=s,h[e.physicalid]=t,v.push(s[0].options.physicalid),b.push(O),y.push(O.getNextNode())}}if(y.length>0&&y.forEach((e=>{e.select()})),b.length>0&&b.forEach((e=>{e.unselect()})),Object.keys(h).length>0){let e=d.getFLWebModelEventsObj("xarch-dgv-events");e.publish({event:"xarch-dgv-refresh-nodes",data:{arrayOfPID:v,tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:!0}}),e.publish({event:"xarch-dgv-refresh-instances",data:{instIdMap:h,bInstance:!0,bEffectivity:!0}})}let x=e.collectionView.getGroupingOptions();x&&e.collectionView.groupRows(x),e._createSummaryPastDialog(m)})).catch((function(t){if(t&&t.error&&t.error.errorList){var i={};for(var n in t.error.errorList.forEach((e=>{i[e.physicalid]=e.errors||[]})),m)if(m.hasOwnProperty(n)){var o=m[n].refAttributes.concat(m[n].instAttributes);for(var r in o)void 0!==i[n]?(o[r].responsibleForError=!0,o[r].errorMsg=i[n].map((e=>e.message)).join(". ")):void 0!==i[m[n].instance_pid]?(o[r].responsibleForError=!0,o[r].errorMsg=i[m[n].instance_pid].map((e=>e.message)).join(" ")):o[r].responsibleForError=!1}e._createSummaryPastDialog(m)}else{var s=t&&t.errorResp&&t.errorResp.error?t.errorResp.error:"";c.displayError(t,u.error.copy_attributes_failed,null,s)}})).finally((function(){s.unmask(widget.body),setTimeout((function(){e._cleanAndDestroy()}),500)}))}else e._cleanAndDestroy()},_onXSOChanged:function(e,t){this.selectedNodes=t.getSelectedNodes().filter((function(t){return t.options.physicalid!==e.options.physicalid}))},_cleanAndDestroy:function(){var e=this;e.treeDocument.getXSO().unsubscribe(e.tokenPostAdd),e.treeDocument.getXSO().unsubscribe(e.tokenPostRemove),e.dialogDGV&&(e.dialogDGV.destroy(),e.dialogDGV=null)},_createSummaryPastDialog:function(i){var s=this;for(var a in s.treedocumentSummaryPaste=new e({useAsyncPreExpand:!0}),i)if(i.hasOwnProperty(a)){var l=i[a],c=new t({label:l.objectLabel,icons:l.icons});s.treedocumentSummaryPaste.addChild(c);var d=l.refAttributes.concat(l.instAttributes);for(var p in d)if(d.hasOwnProperty(p)){var m=d[p],f="";m.copySuccessful||(f=!0===m.responsibleForError?m.errorMsg?m.errorMsg:m.isDeclaredIn?m.isOnExtension?u.error.copy_attribute_on_extension_failed:m.isClassification?u.error.copy_attribute_classif_failed:u.error.copy_attribute_failed_not_allowed:u.error.copy_attribute_on_type_failed:!1===m.responsibleForError?u.error.copy_all_attributes_failed:m.isDeclaredIn?m.equalValues?u.error.copy_attribute_equal_values_failed:m.isOnExtension?u.error.copy_attribute_on_extension_failed:m.isClassification?u.error.copy_attribute_classif_failed:u.error.copy_attribute_failed:u.error.copy_attribute_on_type_failed),c.addChild(new t({label:m.name,icons:[m.iconType],grid:{copySuccessful:m.copySuccessful,message:f},bo:m.bo}))}}s.treedocumentSummaryPaste.expandAll();var g=new n({identifier:"ENOXArchCommon_SummaryPasteAttributes",height:"inherit",treeDocument:s.treedocumentSummaryPaste,rowSelection:"none",columns:[{dataIndex:"tree",text:u.label.title,width:"30%"},{typeRepresentation:"boolean",text:u.label.copy_successful,dataIndex:"copySuccessful",width:95,getCellClassName:function(e){return e&&e.nodeModel?!0===e.nodeModel.options.grid.copySuccessful?"sax-is-copySuccessful-true":"sax-is-copySuccessful-false":null}},{text:u.label.information,dataIndex:"message"}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!1,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t}});s.dialogSummaryPaste=new o({title:u.title.summary_paste_attributes,height:500,width:1e3,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Apply:new r({label:u.action.export,emphasize:"secondary",onClick:function(){s._exportSummaryPastDialog(s.treedocumentSummaryPaste)}}),Close:new r({emphasize:"primary",onClick:function(){s.dialogSummaryPaste.close()}})}}),s.dialogSummaryPaste.addEventListener("close",(function(){s.dialogSummaryPaste.destroy()})),s.dialogSummaryPaste.elements._contentDiv.appendChild(g.getContent()),g.treeDocument.setFilterModel({label:{filterId:"stringRegexp"},copySuccessful:{filterId:"set",filterModel:[]},message:{filterId:"stringRegexp"}})},_exportSummaryPastDialog:function(i){var o=[{dataIndex:"objectName",text:u.label.title},{dataIndex:"attributeName",text:u.label.attribute_name},{typeRepresentation:"boolean",text:u.label.copy_successful,dataIndex:"copySuccessful"},{text:u.label.information,dataIndex:"message"}],r=new n({treeDocument:new e({useAsyncPreExpand:!0}),columns:o,defaultColumnDef:{width:"auto"}});r.treeDocument.empty(),r.treeDocument.prepareUpdate(),i&&i.getChildren()&&i.getChildren().forEach((e=>{var i=new t({label:"",grid:{objectName:e.options.label}});r.treeDocument.addChild(i),e.getChildren().forEach((e=>{var i=new t({grid:{attributeName:e.options.label+(e.options.bo?"":" "+u.label.instance),copySuccessful:e.options.grid.copySuccessful,message:e.options.grid.message}});r.treeDocument.addChild(i)}))})),r.treeDocument.expandAll(),r.treeDocument.pushUpdate();var s=r.getAsCSV(),a=u.action.export+"_"+u.title.summary_paste_attributes+".csv",d=new Date,p=l.getUser("isFullName");s=u.title.summary_paste_attributes+"\nFile Name,"+a+"\nExport Date Time,"+d+"\nExported By,"+p+"\n\n\n"+s,c.downloadFile(a,s,!0),c.alertMessage("success",null,u.success.summary_paste_attributes_export)}}})),define("DS/ENOXArchitectureCommon/components/GenericCommands/RelationsCmd",["UWA/Utils/InterCom","DS/ENOXArchitectureCommon/utils/config.util"],(function(e,t){"use strict";return{execute:function(i,n){var o=t.form3DXContent([n]),r=new e.Socket("compassPageSocket");r.subscribeServer("com.ds.compass",window.parent),r.dispatchEvent("onSetX3DContent",o,"compassPageSocket"),o.appId=i,r.dispatchEvent("onLaunchApp",o,"compassPageSocket")}}})),define("DS/ENOXArchitectureCommon/components/ContentListView/decorators/contentlistview.dragdrop",["DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/gridview.dnd.util","DS/ENOXArchitectureCommon/utils/config.util"],(function(e,t,i){"use strict";var n=i.getFullConfig();return{addDragAndDropBehaviorToContentView:function(){let i=this;if(i.contentView.onDragStartCell=function(t){return t.dataTransfer.setData("Text",JSON.stringify(e.create3DXJsonFromDGVSelection(i.contentView.treeDocument.getSelectedNodes()))),!0},i.contentView.onDragStartRowHeader=function(t,i){return t.dataTransfer.setData("Text",JSON.stringify(e.create3DXJsonFromDGVSelection([i.nodeModel]))),!0},n.appConfigurations.dnd&&n.appConfigurations.dnd.getDnDCustomization){let e=n.appConfigurations.dnd.getDnDCustomization();t.makeGridViewDroppable({container:i.contentViewContainer,contentView:i.contentView,acceptDrop:e.acceptDrop,onDropCallback:e.onDropCallback,getTextInvite:e.getTextInvite})}}}}));var map={};define("DS/ENOXArchitectureCommon/utils/pno.util",["DS/ENOXArchitectureCommon/services/common.service"],(function(e){return{getFullName:function(t){return void 0===map[t]&&(map[t]=e.getPnO(t)),map[t].then((function(e){return e.firstname+" "+e.lastname}))}}})),define("DS/ENOXArchitectureCommon/parser/modeler.parser",["DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/pno.util","WebappsUtils/WebappsUtils","text!DS/ENOXArchitectureCommon/assets/config/mapping.conf.json"],(function(e,t,i,n,o){"use strict";var r=JSON.parse(o),s=t.getFullConfig();return{attributes:function(t){let i=[],n={};if(n=e.createMapSelectableForAdditionalAttr(),t){if(!Array.isArray(t)&&("string"==typeof t||"object"==typeof t&&!t.member))return t;(t=t.member||t).forEach((function(t){let o,s,a={};for(o in t)if(s=r[o],"id"===o)a.physicalid=t[o];else if("title"===o)a.label=t[o];else if("revision"===o)a.revision=t[o];else if("isLastVersion"===o)a.isLastVersion="TRUE"===t[o];else if("state"===o)a.status=t[o],a.maturity=t[o];else if("owner"===o)a.owner=t[o];else if("ds6w:reserved"===o)a.isReserved=t[o];else if("created"===o)a.creationDate=e.formatDate(t[o]);else if("modified"===o)a.modificationDate=e.formatDate(t[o]);else if("description"===o)a.description=t[o];else if("type"===o)a.type=t.typeNLS||t[o],a.actualType=t.typeDB||t[o];else if("type_icon_url"===o)a.icons={iconPath:t[o],iconSize:{height:"16px",width:"16px"}};else if("name"===o)a.name=t[o];else if("architectureNumber"===o)a.architectureNumber=t[o];else{var l=n[o.toLowerCase()];if(l){if(l.multiValuated){var c=[];t[o]&&(c=t[o].split(/\u0007/)),a[l.curi]=c}else a[l.curi]=t[o]||"";l.manipulationUnit&&(a[l.curi+"_actual"]=a[l.curi],a[l.curi]=""),e.getNLSValueFromRangeValuesAttribute(l,l.curi,a)}else a[o]=t[o]}i.push(a)}))}return i},parseDBSpaceData:function(e){let t=[];return e.forEach((function(e){let i={physicalid:e.objPhysicalId,label:e.objLabel,revision:e.objRevision,type:e.objType,connectionId:e.ownerPhysicalId,connectionType:e.ownerType};t.push(i)})),t},defaultInstanceParser:function(t,i){var n,o={};let r={};n=e.createMapSelectableForAdditionalAttr(),t.forEach((function(t){var i={grid:{}};if(t.attributes&&t.attributes.length)for(var s=0;s<t.attributes.length;s++){var a=t.attributes[s].name,l=t.attributes[s].value;if("PLMInstance.PLM_ExternalID"===a)i.grid.instanceName=l;else if("PLMInstance.V_description"===a)i.grid.instance_description=l;else if("modified"===a)i.instance={modificationDate:e.formatDate(l)};else{var c=n[a.toLowerCase()];if(c&&!c.bo){if(void 0!==i.grid["instance_"+c.curi]||void 0!==i.grid["instance_"+c.curi+"_actual"]){var d="instance_"+c.curi;if(c.manipulationUnit&&(d="instance_"+c.curi+"_actual",i.grid["instance_"+c.curi]=[]),Array.isArray(i.grid[d])||(i.grid[d]=i.grid[d]?[i.grid[d]]:[]),l)if(c.multiValuated||l.indexOf("")>=0){var u=[];l&&(u=l.split(/\u0007/)),i.grid[d]=i.grid[d].concat(u)}else i.grid[d].push(l)}else{if(c.multiValuated||l.indexOf("")>=0){u=[];l&&(u=l.split(/\u0007/)),i.grid["instance_"+c.curi]=u}else i.grid["instance_"+c.curi]=l||"";c.manipulationUnit&&(i.grid["instance_"+c.curi+"_actual"]=i.grid["instance_"+c.curi],c.multiValuated?i.grid["instance_"+c.curi]=[]:i.grid["instance_"+c.curi]="")}e.getNLSValueFromRangeValuesAttribute(c,"instance_"+c.curi,i.grid,i)}}}t.attributes=i,o[t.uuid]=t,r[t.physicalid]=t.uuid}));let s={};return i.forEach((function(e){s[e]={map:o,rootUuid:r[e]}})),s},defaultExpandParser:function(i,o){var r,a={};let l={};r=e.createMapSelectableForAdditionalAttr(),i.forEach((function(i){var o={physicalid:i.physicalid,resourceid:i.physicalid,type:s.identifiers.type_act_logref,grid:{architectureNumber:"",kindOfRFLP:"L"}},c=s.mappingType[i.type];c&&c.nlsName?o.grid.type=c.nlsName:o.grid.type=i.type,c&&c.icon?o.icons=[t.getTypeIconUrl(i.type)]:o.icons=[t.getTypeIconUrl(s.identifiers.type_act_logref)],o.grid.actualType=i.type;let d={};if(i.attributes&&i.attributes.length){for(var u=0;u<i.attributes.length;u++){var p=i.attributes[u].name,m=i.attributes[u].value;if("PLMEntity.V_Name"===p||"Title"===p)o.label=m;else if("name"===p)o.grid.name=m;else if("PLMEntity.V_description"===p)o.grid.description=m||"";else if("revision"===p)o.grid.revision=m;else if("current"===p)o.maturity=m;else if("current_NLS"===p)o.grid.maturity=m;else if("owner"===p)o.owner=m;else if("owner_NLS"===p)o.grid.owner=m;else if("originated"===p)o.grid.creationDate=e.formatDate(m);else if("modified"===p)o.grid.modificationDate=e.formatDate(m);else if("reserved"===p)o.grid.isReserved=m;else if("reserved_NLS"===p)o.grid["ds6w:reservedBy"]=m||"";else if("PLMReference.V_isLastVersion"===p)o.grid.isLastVersion="TRUE"===m;else if("ArchitectureExtension.V_ArchitectureNumber"===p)o.grid.architectureNumber=m;else if("policy_NLS"===p||"organization_NLS"===p)d[p]=m;else{var f=r[p.toLowerCase()];if(f){if(void 0!==o.grid[f.curi]||void 0!==o.grid[f.curi+"_actual"]){var g=f.curi;if(f.manipulationUnit&&(g=f.curi+"_actual",o.grid[f.curi]=[]),Array.isArray(o.grid[g])||(o.grid[g]=o.grid[g]?[o.grid[g]]:[]),m)if(f.multiValuated||m&&m.indexOf("")>=0){var h=[];m&&(h=m.split(/\u0007/)),o.grid[g]=o.grid[g].concat(h)}else o.grid[g].push(m)}else{if(f.multiValuated||(m&&m.indexOf(""))>=0){h=[];m&&(h=m.split(/\u0007/)),o.grid[f.curi]=h}else o.grid[f.curi]=m||"";f.manipulationUnit&&(o.grid[f.curi+"_actual"]=o.grid[f.curi],f.multiValuated?o.grid[f.curi]=[]:o.grid[f.curi]="")}e.getNLSValueFromRangeValuesAttribute(f,f.curi,o.grid,o)}}}var v=t.getUser("isTrigram"),y=t.getUser("isFullName");o.type===s.identifiers.type_act_logref&&("FALSE"===o.grid.isReserved?(o.isReserved=o.grid.isReserved,o.grid.isReserved=n.getWebappsAssetUrl("ENOXArchitectureCommon","icons/I_CheckIn.png")):o.grid.reservedBy===v||o.grid.reservedBy===y?(o.isReserved=o.grid.isReserved,o.grid.isReserved=n.getWebappsAssetUrl("ENOXArchitectureCommon","icons/I_lock.png")):(o.isReserved=o.grid.isReserved,o.grid.isReserved=n.getWebappsAssetUrl("ENOXArchitectureCommon","icons/I_ReservedByOthers.png")))}o.grid.owner||(o.grid.owner=o.owner),o.grid.maturity||(o.grid.maturity=o.maturity),o.grid["ds6w:organizationResponsible"]&&d.organization_NLS&&(o.grid["ds6w:organizationResponsible"]=d.organization_NLS),o.grid["ds6w:policy"]&&d.policy_NLS&&(o.grid["ds6w:policy"]=d.policy_NLS),i.attributes=o,a[i.uuid]=i,l[i.physicalid]=i.uuid}));let c={};return o.forEach((function(e){c[e]={map:a,rootUuid:l[e]}})),Promise.resolve(c)}}})),define("DS/ENOXArchitectureCommon/services/modeler.service",["DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/xhr.util","DS/ENOXArchitectureCommon/utils/group.util","DS/ENOXArchitectureCommon/parser/modeler.parser","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i,n,o,r){"use strict";var s=t.getFullConfig();var a={expand:function(t){var n=s.webservices.dsfl_getLogItem+"structure?addNLSValues=true",a=t.depth?t.depth:"0",l=o.defaultExpandParser,c=t.parser?t.parser:l,d=t.options,u={physicalids:t.itemIDs,depthLevel:a,filterExpression:t.configFilter};return i.post(n,JSON.stringify(u),0).then((function(e){return c(JSON.parse(e).rootObjects,t.itemIDs,d)})).catch((function(t){var i=t.error.message.slice(t.error.message.indexOf("ResponseCode")),n=r.error.get_structure;i&&i.indexOf("404")>=0&&(n=r.error.get_structure_media),e.displayError(t,null,null,n)}))},getAttributes:function(t){var n=s.webservices.dsfl_getLogItem+t.itemID+"/attributes?addNLSValues=true",a=t.parser?t.parser:o.defaultExpandParser;return i.get(n).then((function(e){return a(JSON.parse(e).rootObjects,[t.itemID]).then((function(e){if(e&&e[t.itemID]){var i=e[t.itemID];return i.map[i.rootUuid]}}))})).catch((function(t){var i=t.error.message.slice(t.error.message.indexOf("ResponseCode")),n=r.error.get_logitem;i&&i.indexOf("404")>=0&&(n=r.error.get_logitem_media),e.displayError(t,null,null,n)}))},getInstanceAttributes:function(t){var n=s.webservices.dsfl_getLogItem+t.parentID+"/dslog:LogInstance/"+t.instID+"/attributes",a=t.parser?t.parser:o.defaultInstanceParser;return i.get(n).then((function(e){let i=a(JSON.parse(e).rootObjects,[t.instID]);if(i&&i[t.instID]){var n=i[t.instID];return n.map[n.rootUuid]}})).catch((function(t){var i=t.error.message.slice(t.error.message.indexOf("ResponseCode")),n=r.error.get_logitem;i&&i.indexOf("404")>=0&&(n=r.error.get_logitem_media),e.displayError(t,null,null,n)}))},getObjectAttributes:function(t,n,a){var l=s.webservices.dsfl_getObjectAttributes;return i.post(l,JSON.stringify({physicalids:t}),0).then((function(e){if(n){var i=o.defaultInstanceParser(JSON.parse(e).rootObjects,t);for(var r in i)i.hasOwnProperty(r)&&(i[r]=i[r].map[i[r].rootUuid]);return i}return o.defaultExpandParser(JSON.parse(e).rootObjects,t,a).then((function(e){for(var t in e)e.hasOwnProperty(t)&&(e[t]=e[t].map[e[t].rootUuid]);return e}))})).catch((function(t){e.displayError(t,null,null,r.error.get_logitem)}))},defaultCRSParser:function(t){return{physicalid:t.id,label:t.title,type:t.type,grid:{kindOfRFLP:t.kindOfRFLP,revision:t.revision,description:t.description,name:t.name,type:t.typeNLS||t.type,actualType:t.type,creationDate:e.formatDate(t.created),modificationDate:e.formatDate(t.modified),maturity:t.state,owner:t.owner,architectureNumber:t.architectureNumber}}},refreshTreeNodeModel:function(i,n,o,r){let l,c=this,d={},u=[];o&&(l=o.getGroupingOptions());let p=e.getAdditionalAttributes();p&&p.forEach((function(e){e.manipulationUnit&&e.manipulationUnit!==s.dimensions[e.dimension].MKSUnit?d[e.curi]=e:e.manipulationUnit&&u.push(e.curi)}));let m=[];return a.getObjectAttributes(Object.keys(i),null,r).then((function(e){for(var r in e)if(e.hasOwnProperty(r)){let o=e[r],a=i[r];n&&t.XArchStorage().setItem(s.localStorageKeys.recentlyAuthored+r,Date.now()),o.attributes&&o.attributes.grid&&("#DENIED!"===o.attributes.grid.owner?a.forEach((function(e){e.getParent().removeChild(e)})):m.push(c._convertValuesAndUpdateNodes(a,o,d,u)))}return Promise.all(m).then((()=>{l&&o.groupRows(l)}))}))},refreshInstanceNodeModel:function(i,o,r){let l=this,c={},d=[],u=e.getAdditionalAttributes();return u&&u.forEach((function(e){e.bo||(e.manipulationUnit&&e.manipulationUnit!==s.dimensions[e.dimension].MKSUnit?c[e.curi]=e:e.manipulationUnit&&d.push(e.curi))})),a.getObjectAttributes(Object.keys(i),!0,r).then((function(e){for(var r in e)if(e.hasOwnProperty(r)){var a=e[r],u=i[r];let p=u[0].getParent();widget.getValue("groupingEnabled")&&!p.getID&&(p=n.getGroupNodeParent(p));let m=p.options.physicalid;o&&t.XArchStorage().setItem(s.localStorageKeys.recentlyAuthored+m,Date.now()),a.attributes&&a.attributes.grid&&l._convertValuesAndUpdateNodes(u,a,c,d)}}))},_convertValuesAndUpdateNodes:function(e,t,i,n){let o=[],r=[];for(let e in i)if(i.hasOwnProperty(e)){let n=i[e];if(n.bo||(e="instance_"+e),(""===t.attributes.grid[e]||t.attributes.grid[e]&&0===t.attributes.grid[e].length)&&t.attributes.grid[e+"_actual"]){let i;n.multiValuated||Array.isArray(t.attributes.grid[e+"_actual"])?(i=t.attributes.grid[e+"_actual"],0===i.length?(i=0,i=[i.toString()]):i.map((e=>e.toString()))):(i=+t.attributes.grid[e+"_actual"]||0,i=[i.toString()]),o.push({UnitFrom:s.dimensions[n.dimension].MKSUnit,UnitTo:n.manipulationUnit,Dimension:n.dimension,Values:i}),r.push(e)}}return n.forEach((function(e){let i=t.attributes.grid[e+"_actual"];i&&(t.attributes.grid[e]=i)})),o.length>0?DimensionsService.convertValues(o).then((function(i){i.Response&&(r.forEach((function(e,n){i.Response[n].ConvertedValues&&(t.attributes.grid[e]=UWA.is(i.Response[n].ConvertedValues,"string")?i.Response[n].ConvertedValues.split(";")[0]:i.Response[n].ConvertedValues)})),e.forEach((function(e){e.updateOptions(t.attributes)})))})):(e.forEach((function(e){e.updateOptions(t.attributes)})),Promise.resolve())},navigate:function(t){let n=s.webservices.getItems+s.webservices.keyFieldForService;t.fields&&(n+=t.fields.join());let a=t.payload;return i.post(n,JSON.stringify(a),0).then((function(e){e=e&&UWA.is(e,"string")?JSON.parse(e):e;let t={};if(e.member&&e.member.length>0){e.member.forEach((function(e,i){let n,r={};e.outputs;for(n in e)r[n]=o.attributes(e[n]);t[a[i]]=r}))}return t}),(function(t){e.displayError(t,null,null,r.error.generic_get_failed)}))}};return a})),define("DS/ENOXArchitectureCommon/model/TreeDocument",["UWA/Core","DS/TreeModel/TreeDocument","DS/ENOXArchitectureCommon/services/modeler.service","DS/ENOXArchitectureCommon/services/index.service","DS/ENOXArchitectureCommon/utils/common.util","text!DS/ENOXArchitectureCommon/assets/config/identifiers.conf.json"],(function(e,t,i,n,o,r){"use strict";JSON.parse(r);return t.extend({isMain:!1,_activeNode:null,defaultOptions:{shouldAcceptDrop:function(e){return!0}},init:function(t){this.mappedNodesToIds={},t=e.extend(e.clone(this.defaultOptions),t),this._parent(t),t.isMain&&(this.isMain=t.isMain)},updateTags:function(){this.isMain&&this.getModelEvents().publish({event:"setPathTags",context:this})},onRootAdded:function(){this.isMain&&this.getModelEvents().publish({event:"onRootAdded",context:this})},setActiveNode:function(e){null!==this._activeNode&&(this._activeNode.setActive(!1),this._activeNode.setColor("rgba(0, 0, 0, 0)")),this._activeNode=e,this._activeNode.setActive(!0),this._activeNode.setColor("rgba(54,142,196, 0.8)")},getActiveNode:function(e){return this._activeNode},empty:function(){this.mappedNodesToIds={},this._getTrueRoot().empty(),this._numberOfNodesInDocument=0,this._parent()},getRealRoots:function(t){var i=[],n=this.getRoots(t);if(null!=n&&n.forEach((function(e){if(e.isVirtual()){var t=e.getChildren();t&&t.length>0&&(i=i.concat(t))}else i.push(e)})),Boolean(t)&&e.is(this._getChildrenFilterInfo,"function")){var o=this._getChildrenFilterInfo();if(o&&e.is(o.childrenBeforeFiltering,"array")){var r=i;i=o.childrenBeforeFiltering.slice(0),r.forEach((function(e){i.indexOf(e)<0&&i.push(e)}))}}return i},getRoots:function(t){var i=this._parent();if(Boolean(t)&&e.is(this._getChildrenFilterInfo,"function")){var n=this._getChildrenFilterInfo();if(n&&e.is(n.childrenBeforeFiltering,"array")){var o=i;i=n.childrenBeforeFiltering.slice(0),o.forEach((function(e){i.indexOf(e)<0&&i.push(e)}))}}return i},removeRoot:function(t,i,n){var o=this;o._doNotBroadcastSelect=!0;var r=o.hasOwnProperty("detachedRoots")?o.detachedRoots.indexOf(t):-1;if(r>=0)o.detachedRoots.splice(r,1);else{if(o.getRealRoots().indexOf(t)>=0)t.getParent().removeChild(t);if((!e.is(n,"boolean")||!n)&&e.is(o._getChildrenFilterInfo,"function")){var s=o._getChildrenFilterInfo();if(s&&e.is(s.childrenBeforeFiltering,"array")){var a=s.childrenBeforeFiltering.indexOf(t);a>=0&&s.childrenBeforeFiltering.splice(a,1)}if(s&&e.is(s.filteredOutChildren,"array")){var l=s.filteredOutChildren.indexOf(t);l>=0&&s.filteredOutChildren.splice(l,1)}}}if(o._doNotBroadcastSelect=!1,!e.is(i,"boolean")||!i){var c=this.getRealRoots().length;e.is(this.detachedRoots,"array")&&(c+=this.detachedRoots.length),this.getModelEvents().publish({event:"onRemoveRoot",data:{pid:t.getID(),remainingRoots:c}});var d=null;this.getRealRoots().length>0?d=this.getRealRoots()[0]:e.is(this.detachedRoots,"array")&&this.detachedRoots.length>0&&(d=this.detachedRoots[0]),this.getModelEvents().publish({event:"onRootAdded",data:{isremove:!0,added_node:d,nb_root:c}})}},getNodesByIDPath:function(e){function t(e,i,n,o){if(e.getID()===i[n])if(n===i.length-1)o.push(e);else{var r=e.getChildren();r&&r.length>0&&(n+=1,r.forEach((function(e){t(e,i,n,o)})))}}var i=[];return this.getRealRoots().forEach((function(n){t(n,e,0,i)})),i},getNodesById:function(e){var t=[];return this.getRoots().forEach((function(i){var n=i.getNodesById(e);t=t.concat(n)})),t},getMappedNodesFromId:function(e){return this.mappedNodesToIds&&this.mappedNodesToIds[e]?this.mappedNodesToIds[e]:this.getNodesById(e)},searchRootById:function(e){var t,i=this.getRoots(!0);this.hasOwnProperty("detachedRoots")&&(i=i.concat(this.detachedRoots));for(var n=0;n<i.length;n++)if(i[n].options.physicalid===e){t=i[n];break}return t},applyFilter:function(e,t){for(var r=this,s=[],a=o.checkIfRecentlyAuthored(e.filterRootIds[0],!0),l=0;l<e.filterRootIds.length;l++){var c=r.searchRootById(e.filterRootIds[l]);c&&(c.options.CVQuery=e.CVQuery,s.push(c))}if(e.empty){if(e.filterRootIds&&1===e.filterRootIds.length){var d=e.filterRootIds[0],u={},p=r.getConfigurationContext();if(p&&p.filterCompiledForm&&(u.configFilter=p.filterCompiledForm),a)u.itemIDs=[d],i.expand(u).then((function(e){e=e?e[s[0].options.physicalid]:{},r.onExpandComplete(s,t,a,e)}));else{let e={};e[d]=[[d]],n.progressiveExpand({rootWithPaths:e,configFilter:u.configFilter}).then(r.onExpandComplete.bind(r,s,t,a))}}}else if(e.CVQueryV2){let i={};i[d=e.filterRootIds[0]]=[[d]];let o=e.CVQueryV2.filter,l=e.CVQueryV2.aggregation_processors;e.CVQueryV2.batch&&e.CVQueryV2.batch.expands[0]&&(o||(o=e.CVQueryV2.batch.expands[0].filter),l||(l=e.CVQueryV2.batch.expands[0].aggregation_processors)),n.progressiveExpand({rootWithPaths:i,filter:o,aggregation_processors:l}).then(r.onExpandComplete.bind(r,s,t,a))}},onExpandComplete:function(e,t,i,n){var o=this;try{o.prepareUpdate();var r=!1;if(n&&n.map&&0!==Object.keys(n.map).length&&(i||n.paths&&0!==n.paths.length)||(r=!0),r)e.forEach((function(e){let t=e.getChildren();for(let i=t.length-1;i>=0;i--)t[i].getID()&&e.removeChild(t[i]);e.expand()})),t({response:null,recentlyAuthored:i});else n.srcFromNGFilter=!0,t({treedocument:o,root_nodes:e,response:n,expand_level:-1,selectPathLeaf:!1,recentlyAuthored:i})}catch(e){console.error("error in filtering",e)}finally{o.pushUpdate()}},setConfigurationContext:function(e){this._configurationContext={model:e.model,modelVersion:e.modelVer,pc:e.pc,filterCompiledForm:e.filterCompiledForm}},getConfigurationContext:function(){return this._configurationContext?this._configurationContext:null},addToMappedNodes:function(e){var t=this;t.mappedNodesToIds[e.options.physicalid]?t.mappedNodesToIds[e.options.physicalid].push(e):t.mappedNodesToIds[e.options.physicalid]=[e]},removeFromMappedNodes:function(e){var t=this;if(t.mappedNodesToIds[e.options.physicalid]){for(var i=t.mappedNodesToIds[e.options.physicalid],n=i.length-1;n>=0;n--){i[n]._id===e._id&&i.splice(n,1)}i.length<=0&&delete t.mappedNodesToIds[e.options.physicalid]}}})})),define("DS/ENOXArchitectureCommon/utils/gridview.util",["DS/UIKIT/Mask","DS/ENOXArchitectureCommon/model/TreeDocument","DS/ENOXArchitectureCommon/model/TreeNodeModel","DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/model.events.util","DS/ENOXArchitectureCommon/services/common.service","DS/ENOXArchitectureCommon/services/index.service","DS/ENOXArchitectureCommon/services/modeler.service","DS/ENOXArchitectureCommon/parser/index.parser","DS/ENOXArchitectureCommon/parser/modeler.parser","text!DS/ENOXArchitectureCommon/assets/config/navigate.conf.json","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i,n,o,r,s,a,l,c,d,u,p){"use strict";var m=o.getFullConfig(),f=m.identifiers,g=m.localStorageKeys,h=JSON.parse(u),v={createTreeDocumentFromIndexResponse:function(e,i,o,r){var s,a,c,d,u=this,p={},m=[];if(!e)return;var h=e.map,v=e.paths,y=!1,b={},C=widget.getValue(g.componentView),I=widget.getValue("ngFilter"),S=I&&I.length>0;let N;if(C===g.flattenedView?N=widget.getPreference(g.depthFlattenedView).value:C===g.flattenedViewOnlyArchitectureItem&&(N=widget.getPreference(g.depthFlattenedViewArchitectureItemOnly).value),i||(y=!0,i=new t({useAsyncPreExpand:!0}),this._addExpandCollapseBehaviors(i,r,!1)),!y&&o||(1!==v[0].length||h[v[0][0]].attributes.grid||(h[v[0][0]].attributes.noIndexOrDBExpand=!0,h[v[0][0]].attributes.physicalid=h[v[0][0]].physicalid,h[v[0][0]].attributes.grid={physicalid:h[v[0][0]].physicalid}),o=u._addLogItemIndexResponse(i,null,h[v[0][0]]),0===Object.keys(i.mappedNodesToIds).length&&o.options.physicalid.length>0&&(i.mappedNodesToIds[o.options.physicalid]=[o])),1===v.length&&1===v[0].length)return i.getRoots()[0].expand(),i;let D={};i.getRoots()[0].getAllDescendants().forEach((function(e){e.options.type===f.type_act_logref&&e.options.instance&&(D[e.options.instance.physicalid]||(D[e.options.instance.physicalid]=[]),D[e.options.instance.physicalid].push(e))}));var O,_=o;let E;b[v[0][0]]=i.getRoots()[0];for(var A=0;A<v.length;A++)for(var w=1;w<v[A].length;w+=2)if(s=h[v[A][w]],a=h[v[A][w+1]],s&&a&&(a.attributes.type!==f.type_act_logref||C!==g.flattenedViewOnlyArchitectureItem||0!==a.attributes.grid.architectureNumber.length)){if(C===g.structuredView||s.alreadyAdded||(s.alreadyAdded=!0),(S||C!==g.structuredView&&w<v[A].length-2)&&(a.attributes.noIndexOrDBExpand=!0),d=v[A].slice(0,w).join("|"),_=C===g.structuredView?E!==d&&b[d]?b[d]:o:Math.floor(d.split("|").length/2)<N?o:b[d],O=E!==d&&b[d]?b[d]:groupParent||o,D){let e=D[s.attributes.physicalid],t=O.getOccurencePath();if(e&&t){let i;t.push(s.attributes.physicalid,a.attributes.physicalid);let n=JSON.stringify(t);for(let t=0;t<e.length;t++)if(JSON.stringify(e[t].getOccurencePath())===n){i=!0,b[d=v[A].slice(0,w+2).join("|")]=e[t];break}if(i)continue}}if(!n.checkIfRecentlyAuthored(O.options.physicalid,!0)&&a.attributes.type===f.type_act_logref){var x=a.attributes.physicalid;if(n.checkIfRecentlyAuthored(x,!0)){var R={};s&&(R.pid=s.attributes.physicalid,R.visualCue=s.attributes.visualCue,R.name=s.attributes.label),m.push(l.expand({itemIDs:[x],depth:"1",configFilter:r}).then(u.addStructureToChild.bind(u,x,_,R,D)));break}b[d=v[A].slice(0,w+2).join("|")]?c=b[d]:(c=u._addLogItemIndexResponse(_,s,a,O),b[d]=c,c.options.type===f.type_act_logref&&c.options.instance&&(D[c.options.instance.physicalid]||(D[c.options.instance.physicalid]=[]),D[c.options.instance.physicalid].push(c)),n.checkIfRecentlyAuthored(x)&&(void 0===p[x]&&(p[x]=[]),p[x].push(c)))}}return n.checkIfRecentlyAuthored(o.options.physicalid)&&(p[o.options.physicalid]=[o]),Object.keys(p).length>0&&m.push(l.refreshTreeNodeModel(p),!1),Promise.all(m).finally((function(){o.options.noIndexOrDBExpand=!0,i&&!i.getRoots()[0].options.hasBeenExpanded&&i.getRoots()[0].expand()})),i},addStructureToChild:function(e,t,i,n,o){let r=o[e],s=r.map[r.rootUuid];this._addLogItemDslogModelerResponse(t,s,r.map,i,null,n)},createTreeDocumentFromDslogModelerResponse:function(e,i){i||(i=new t({useAsyncPreExpand:!0})),this._addLogItemDslogModelerResponse(i,e.map[e.rootUuid],e.map);var n=i.getRoots()[0];return 0===Object.keys(i.mappedNodesToIds).length&&n.options.physicalid.length>0&&(i.mappedNodesToIds[n.options.physicalid]=[n]),this._addExpandCollapseBehaviors(i,null,!0),i.getRoots()[0].expand(),i},_addLogItemIndexResponse:function(e,t,n,o){var r=JSON.parse(JSON.stringify(n));if(null!==t)for(var s in r.attributes.instance={physicalid:t.attributes.physicalid,visualCue:t.attributes.visualCue,effectivitycompiledform:t.attributes.effectivitycompiledform,modificationDate:t.attributes.grid.modificationDate},r.attributes.grid.instanceName=t.attributes.label,r.attributes.grid.instance_description=t.attributes.description,t.attributes.grid)t.attributes.grid.hasOwnProperty(s)&&(r.attributes.grid["instance_"+s]=t.attributes.grid[s]),t.attributes.hasOwnProperty(s)&&(r.attributes["instance_"+s]=t.attributes[s]);r.attributes.children=[];var a=e.addChild(new i(r.attributes));return t&&a.setRelationID(t.attributes.physicalid),o&&(a.options.actualParent=o),a},_addLogItemDslogModelerResponse:function(e,t,n,o,r,s){var a=this,l=r||0;!r&&e.options.actualDepth&&(l=e.options.actualDepth+1);var c,d,u=JSON.parse(JSON.stringify(t)),p=widget.getValue(g.componentView),m=!0;p===g.flattenedView?c=widget.getPreference(g.depthFlattenedView).value:p===g.flattenedViewOnlyArchitectureItem&&(c=widget.getPreference(g.depthFlattenedViewArchitectureItemOnly).value,e.getRoot&&0===u.attributes.grid.architectureNumber.length&&(m=!1,d=e));var h=!1;if(s&&void 0!==o){let t=s[o.pid],i=e.getOccurencePath();if(t&&i){i.push(o.pid,u.attributes.physicalid);let e=JSON.stringify(i);for(let i=0;i<t.length;i++)if(JSON.stringify(t[i].getOccurencePath())===e){h=!0,d=t[i];break}}}!h&&m&&(u.attributes.children=[],d=new i(u.attributes),o&&d.setRelationID(o.pid),d.options.actualParent=e,d.options.actualDepth=l,p!==g.structuredView&&void 0!==e.getRoot&&l<=parseInt(c,10)?e.getRoot().addChild(d):e.addChild(d),o&&(d.options.instance={physicalid:o.pid,visualCue:o.visualCue,modificationDate:o.modificationDate},d.options.grid.instanceName=o.name,d.options.grid.cue="",d.options.grid.instance_actualType=o.actualType,d.options.grid.instance_description=o.description||"",d.options.grid=Object.assign(d.options.grid,o.customAttributes),d.options=Object.assign(d.options,o.customAttributesInternalValues)),s&&o&&d.options.type===f.type_act_logref&&d.options.instance&&(s[d.options.instance.physicalid]||(s[d.options.instance.physicalid]=[]),s[d.options.instance.physicalid].push(d))),u.instances&&(d.options.noIndexOrDBExpand=!0,++l,u.instances.forEach((function(e){var t=a._getInstDetailsFromModelerResp(e);a._addLogItemDslogModelerResponse(d,n[e.toUuid],n,t,l,s)})))},_getInstDetailsFromModelerResp:function(e){if(!e)return;var t,i,o={},r={};let s,a;i=n.createMapSelectableForAdditionalAttr();for(var l={pid:e.physicalid,visualCue:e.visualCue,customAttributes:o,customAttributesInternalValues:r,actualType:e.type},c=0;c<e.attributes.length;c++)if("PLMInstance.PLM_ExternalID"===e.attributes[c].name)l.name=e.attributes[c].value;else if("PLMInstance.V_description"===e.attributes[c].name)l.description=e.attributes[c].value;else if("modified"===e.attributes[c].name)l.modificationDate=n.formatDate(e.attributes[c].value);else if("owner_NLS"===e.attributes[c].name)t=e.attributes[c].value;else if("reserved_NLS"===e.attributes[c].name)s=e.attributes[c].value;else if("organization_NLS"===e.attributes[c].name)a=e.attributes[c].value;else{var d=i[e.attributes[c].name.toLowerCase()];if(d){if(void 0!==o["instance_"+d.curi]||void 0!==o["instance_"+d.curi+"_actual"]){var u="instance_"+d.curi;if(d.manipulationUnit&&(u="instance_"+d.curi+"_actual",o["instance_"+d.curi]=[]),Array.isArray(o[u])||(o[u]=o[u]?[o[u]]:[]),e.attributes[c].value)if(d.multiValuated||e.attributes[c].value&&e.attributes[c].value.indexOf("")>=0){var p=[];e.attributes[c].value&&(p=e.attributes[c].value.split(/\u0007/)),o[u]=o[u].concat(p)}else o[u].push(e.attributes[c].value)}else{if(d.multiValuated||e.attributes[c].value&&e.attributes[c].value.indexOf("")>=0){p=[];e.attributes[c].value&&(p=e.attributes[c].value.split(/\u0007/)),o["instance_"+d.curi]=p}else o["instance_"+d.curi]=e.attributes[c].value||"";d.manipulationUnit&&(o["instance_"+d.curi+"_actual"]=o["instance_"+d.curi],d.multiValuated?o["instance_"+d.curi]=[]:o["instance_"+d.curi]="")}n.getNLSValueFromRangeValuesAttribute(d,"instance_"+d.curi,o,r)}}return o["instance_ds6w:responsible"]=t,o["instance_ds6w:reservedBy"]&&s&&(o["instance_ds6w:reservedBy"]=s),o["instance_ds6w:organizationResponsible"]&&a&&(o["instance_ds6w:organizationResponsible"]=a),l.customAttributes=o,l.customAttributesInternalValues=r,l},_createCategoryNode:function(e,t){return e.addChild(new i(t))},_addExpandCollapseBehaviors:function(e){e.onPreExpand((function(t){t.target.options.hasBeenExpanded||t.target.options.type!==f.type_act_logref?t.target.preExpandDone():v.expandNodestoNLevel({level:"1",selectedNodes:[t.target],params:{collectionView:{getContent:function(){return widget.body},treeDocument:e},onPreExpand:!0}})})),e.onPostExpand((function(){this.getModelEvents().publish({event:"colorizeNodesFromTagger"})}))},crRecTimeoutToCheckTreeDocExp:function(e,t){var i=this;e&&(e.isExpanding()?setTimeout((function(){i.crRecTimeoutToCheckTreeDocExp(e,t)}),200):t())},addDBExpandCallBack:function(e,t,i,n){var o=this;i.map[i.rootUuid]&&!i.map[i.rootUuid].instances||(n&&!t&&(t={},n.getRoots()[0].getAllDescendants().forEach((function(e){e.options.type===f.type_act_logref&&e.options.instance&&(t[e.options.instance.physicalid]||(t[e.options.instance.physicalid]=[]),t[e.options.instance.physicalid].push(e))}))),i.map[i.rootUuid].instances.forEach((function(n){var r=o._getInstDetailsFromModelerResp(n);o._addLogItemDslogModelerResponse(e,i.map[n.toUuid],i.map,r,null,t)})))},addDBNavigate:function(e,t){let i,n=this,o=(widget.getValue(g.componentView),[]),s=[];for(i=e.length-1;i>=0;i--){var a=e[i];a.options.physicalid&&(a.isRoot()||a.options.instance&&a.options.instance.physicalid)?o.indexOf(a.options.physicalid)<0&&o.push(a.options.physicalid):e.splice(i,1)}let c=!0,u=!0,p=!0,m=!0,f=!0;if(t&&t.navigateTypes){let e=t.navigateTypes;widget.getValue("configurable_expand");c=e.indexOf("ZONE")>=0||!1,u=e.indexOf("SPECIFICATION_DOCUMENT")>=0||!1,p=e.indexOf("PROPOSED_SOLUTION")>=0||!1,m=e.indexOf("IMPLEMENTEDBY_LINK")>=0||!1,f=e.indexOf("IMPLEMENTING_LINK")>=0||!1}if(c&&s.push("dsmvlog:Reference.SPPConnection.Details"),u&&s.push("dsmvlog:Reference.SpecificationDocument.Details"),p&&s.push("dsmvlog:Reference.ProposedSolution.Details"),m&&s.push("dsmvlog:Reference.ImplementLink.ImplementedBy.Details"),f&&s.push("dsmvlog:Reference.ImplementLink.Implementing.Details"),!(s.length<=0))return l.navigate({payload:o,fields:s}).then((function(i){let o=[],a=[],l=!1;return e.forEach((function(e){let r=i[e.options.physicalid];if(r){let i,o=[e];for(i in t&&t.treeDocument&&(o=t.treeDocument.getMappedNodesFromId(e.options.physicalid)),0===Object.keys(r).length&&c?r.SPPConnections=[]:1===Object.keys(r).length&&u&&1===s.length&&(r.specificationDocument=[]),m&&!r["Implemented by"]&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implemented=!1),f&&!r.Implementing&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implementing=!1),l||!f&&!m||(l=!0),r)if("proposedsolution"===i);else if("Implementing"===i){let e={objType:"ref",linkType:"implementing"};o.forEach((function(o){a.push(n.updateLinksOnNode(e,o,r[i],t))}))}else if("Implemented by"===i){let e={objType:"ref",linkType:"implemented"};o.forEach((function(o){a.push(n.updateLinksOnNode(e,o,r[i],t))}))}else if("specificationDocument"===i);else if("SPPConnections"===i){var p=d.parseDBSpaceData(r[i]);o.forEach((function(e){n.updateSpacesOnNode(e,p)}))}}e.options.instance&&o.push(e.options.physicalid)})),l&&o.length>0&&r.getFLWebModelEventsObj("xarch-dgv-events").publish({event:"content-list-view-referenceLinks-loaded",data:o}),Promise.all(a)}))},addIndexNavigate:function(e,t){let i,n=this,o=(widget.getValue(g.componentView),Object.assign({},h.basic));for(o.input_physical_ids=[],i=e.length-1;i>=0;i--){var s=e[i];s.options.physicalid&&(s.isRoot()||s.options.instance&&s.options.instance.physicalid)?o.input_physical_ids.push(s.options.physicalid):e.splice(i,1)}if(0===o.input_physical_ids.length)return;o.label="navigate_rel_logref",o.primitives=[],o.patterns={},o.patternTypeFilters={};let l=h[f.type_act_logref],d=!0,u=!0,p=!0,m=!0,v=!0;widget.getValue("configurable_expand");if(t&&t.navigateTypes){let e=t.navigateTypes;d=e.indexOf("ZONE")>=0||!1,u=e.indexOf("SPECIFICATION_DOCUMENT")>=0||!1,p=e.indexOf("PROPOSED_SOLUTION")>=0||!1,m=e.indexOf("IMPLEMENTEDBY_LINK")>=0||!1,v=e.indexOf("IMPLEMENTING_LINK")>=0||!1}return d&&(o.primitives.push(l.ZONE.primitives),o.patterns.ZONE=l.ZONE.patterns),u&&(o.primitives.push(l.SPECIFICATION_DOCUMENT.primitives),o.patterns.SPECIFICATION_DOCUMENT=l.SPECIFICATION_DOCUMENT.patterns),p&&(o.primitives.push(l.PROPOSED_SOLUTION.primitives),o.patterns.PROPOSED_SOLUTION=l.PROPOSED_SOLUTION.patterns),m&&(o.primitives.push(l.IMPLEMENTEDBY_LINK.primitives),o.patterns.IMPLEMENTEDBY_LINK=l.IMPLEMENTEDBY_LINK.patterns,o.patternTypeFilters.IMPLEMENTEDBY_LINK=l.IMPLEMENTEDBY_LINK.patternTypeFilters),v&&(o.primitives.push(l.IMPLEMENTING_LINK.primitives),o.patterns.IMPLEMENTING_LINK=l.IMPLEMENTING_LINK.patterns,o.patternTypeFilters.IMPLEMENTING_LINK=l.IMPLEMENTING_LINK.patternTypeFilters),o.primitives.length<=0?void 0:a.navigate(o).then((function(i){let o=[],s=[],a=!1;return e.forEach((function(e){let r=i[e.options.physicalid];if(r){let i;for(i in d&&!r.ZONE&&(r.ZONE=[]),m&&!r.IMPLEMENTEDBY_LINK&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implemented=!1),v&&!r.IMPLEMENTING_LINK&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implementing=!1),a||!v&&!m||(a=!0),r)if("PROPOSED_SOLUTION"===i);else if("IMPLEMENTING_LINK"===i){let o={objType:"ref",linkType:"implementing"},a=n.formImplLinksFromNavigatedData(r[i]);a=c.attributes(a),s.push(n.updateLinksOnNode(o,e,a,t))}else if("IMPLEMENTEDBY_LINK"===i){let o={objType:"ref",linkType:"implemented"},a=n.formImplLinksFromNavigatedData(r[i]);a=c.attributes(a),s.push(n.updateLinksOnNode(o,e,a,t))}}e.options.instance&&o.push(e.options.physicalid)})),a&&o.length>0&&r.getFLWebModelEventsObj("xarch-dgv-events").publish({event:"content-list-view-referenceLinks-loaded",data:o}),Promise.all(s)}))},formImplLinksFromNavigatedData:function(e){let t=[];return e&&e.length>0&&e.forEach((function(e){let i=e.elements[0];i.implementlink={id:e.owner.physicalid},t.push(i)})),t},validateNLSTypesForItems:function(e){let t=[],i=[];if(e.forEach((function(e){e.type||(t.indexOf(e.actualType)<0&&t.push(e.actualType),i.push(e))})),t.length>0){let e={"ds6w:type":t};return s.getPredicateValues(e).then((function(e){if(e){let t,n=e["ds6w:type"];for(t in i.forEach((function(e){!e.type&&n[e.actualType]&&(e.type=n[e.actualType])})),n)n.hasOwnProperty(t)&&(m.mappingType[t]||(m.mappingType[t]={}),m.mappingType[t].nlsName=n[t])}}))}return Promise.resolve()},updateLinksOnNode:function(e,t,n,r){let s=this,a=t.options.instance?t.options.instance.physicalid:"",l=e.linkType+e.objType,d=p.label[l],u=t.getNodesByRelId(l+a)[0];if(n&&!(n.length<=0))return u?u.removeChildren():(u=s._createCategoryNode(t,{label:d,type:"implementLinksCategory",icons:[{iconName:"forward"}],editableFlag:!1}),u.setRelationID(l+a),t.addChild(u),t.updateOptions()),"ref"===e.objType&&(t.options.implementLinks||(t.options.implementLinks={}),n&&n.length>0?t.options.implementLinks[e.linkType]=!0:t.options.implementLinks[e.linkType]=!1),s.validateNLSTypesForItems(n).then((function(){c.parseDataToNodeFormat({virtual:!0,data:n}).forEach((function(n){n.linkInfo=JSON.parse(JSON.stringify(e));let r=n.implementlink||n.grid.implementlink;n.linkInfo.implementId=r?r.id:null;let s=n.implementLinkContext||n.grid.implementLinkContext;s||"ref"!==e.objType||("implementing"===e.linkType?(s=p.label.implementingref+": "+t.options.label+" "+t.options.grid.revision+"::",s+=p.label.implementedref+": "+n.label+" "+n.grid.revision):(s=p.label.implementingref+": "+n.label+" "+n.grid.revision+"::",s+=p.label.implementedref+": "+t.options.label+" "+t.options.grid.revision)),s&&(s=s.split("::"),n.grid.titleTooltip="",s.forEach((function(e){n.grid.titleTooltip+=e+"\n"})),n.grid.titleTooltip=n.grid.titleTooltip.substr(0,n.grid.titleTooltip.length-1)),n.icons[0]||("R"===n.grid.kindOfRFLP?n.icons=[o.getTypeIconUrl(f.type_requirement)]:"F"===n.grid.kindOfRFLP?n.icons=[o.getTypeIconUrl(f.type_act_functref)]:"L"===n.grid.kindOfRFLP?n.icons=[o.getTypeIconUrl(f.type_act_logref)]:"P"===n.grid.kindOfRFLP&&(n.icons=[o.getTypeIconUrl(f.type_act_physical)])),u.addChild(new i(n))})),r&&r.bExpand&&u.expand()}));u&&t.removeChild(u)},updateSpacesOnNode:function(e,t){if(!t||t.length<=0)e.options.assignedSpacesPID=[],e.updateOptions({grid:{assignedSpaces:""}});else{var i={assignedSpacesPID:[],grid:{assignedSpaces:""}};e.options.grid.assignedSpaces="";for(var n=0;n<t.length;n++)i.assignedSpacesPID.push({obj:t[n].physicalid,owner:t[n].connectionId}),i.grid.assignedSpaces+=t[n].label+", ";i.grid.assignedSpaces=i.grid.assignedSpaces.slice(0,-2),e.updateOptions(i)}},manageImplementLinkResp:function(e,t,i,n){var o,r=this,s=e.options.instance?e.options.instance.physicalid:"";("ref"===t&&(e.options.implementLinks||(e.options.implementLinks={})),i)&&(i.implementing||n.keepNodes||(o=e.getNodesByRelId("implementing"+t+s)[0])&&o.remove(),i.implemented||n.keepNodes||(o=e.getNodesByRelId("implemented"+t+s)[0])&&o.remove(),["implementing","implemented"].forEach((function(o){if(i[o]){var a=p.label[o+t],l=e.getNodesByRelId(o+t+s)[0];l?n.keepNodes||l.removeChildren():(l=r._createCategoryNode(e,{label:a,type:"implementLinksCategory",icons:[{iconName:"forward"}]})).setRelationID(o+t+s);var c=i[o]&&i[o].member?i[o].member:i[o];"ref"===t&&(c&&c.length>0?e.options.implementLinks[o]=!0:e.options.implementLinks[o]=!1);var d={objType:t,linkType:o};r._parseImplementLinksAndAddToNode(c,d,l),n&&n.bExpand&&l.expand()}})))},_parseImplementLinksAndAddToNode:function(e,t,n){var r=!1;"inst"===t.objType&&(r=!0),e.forEach((function(e){var s,a,c;let d=e.implementlink;if(r&&(e=e.reference&&e.reference.member?e.reference.member[0]:e.reference),"R"===e.kindOfRFLP)s=f.type_requirement,a=[o.getTypeIconUrl(s)];else if("F"===e.kindOfRFLP)s=f.type_act_functref,a=[o.getTypeIconUrl(s)];else if("L"===e.kindOfRFLP)s=f.type_act_logref,a=[o.getTypeIconUrl(s)];else{if("P"!==e.kindOfRFLP)return;s=f.type_act_physical,a=[o.getTypeIconUrl(s)]}var u=l.defaultCRSParser(e);u.type=s,u.icons=a,u.grid.isLastVersion="TRUE"===e.isLastVersion,u.virtual=!0,u.linkInfo=JSON.parse(JSON.stringify(t)),u.linkInfo.implementId=d?d.id:null,(c=d?d.implementLinkContext:null)&&(c=c.split("::"),u.grid.titleTooltip="",c.forEach((function(e){u.grid.titleTooltip+=e+"\n"})),u.grid.titleTooltip=u.grid.titleTooltip.substr(0,u.grid.titleTooltip.length-1)),n.addChild(new i(u)),n.updateOptions()})),null===n.getChildren()&&n.getParent().removeChild(n)},expandNodestoNLevel:function(t){let i=t.level,o=t.params.collectionView.treeDocument.getRoots()[0],r=t.selectedNodes,s=[];for(var a=0;a<r.length;a++){let e,t=r[a];if("1"===i?e=!t.options.hasBeenExpanded:"2"===i?t.options.dontExpandTwoLvl?e=!1:t.options.hasBeenExpanded?t.getChildren().forEach((function(t){t.options.type===f.type_act_logref&&t.options.instance&&(t.options.hasBeenExpanded||(e=!0))})):e=!0:"-1"===i&&(t.options.dontExpandAllLvl?e=!1:t.options.hasBeenExpanded?(t.getAllDescendants().forEach((function(t){t.options.type===f.type_act_logref&&t.options.instance&&(t.options.hasBeenExpanded||(e=!0))})),e||(e=!1)):e=!0),e){if(t.options.physicalid===o.options.physicalid&&"-1"===i){s=[t];break}s.push(t)}else"-1"===i?t.expandAll():t.expandNLevels({numberOfLevelsToExpand:i})}if(s.length>0){var l=i||"-1";t.params.collectionView.treeDocument.prepareUpdate(),n.createBatchServiceReqExecution(s,l,t.params).then((function(){t.params.collectionView.treeDocument.reapplyFilterModel(),s&&s.forEach((function(e){"-1"===l?e.expandAll():"2"===l?e.expandNLevels({numberOfLevelsToExpand:l}):t.params.onPreExpand?e.preExpandDone():e.expandNLevels({numberOfLevelsToExpand:l})})),t.params.collectionView.treeDocument.pushUpdate(),e.unmask(t.params.collectionView.getContent())}))}}};return v})),define("DS/ENOXArchitectureCommon/utils/gridview.util.extended",["DS/UIKIT/Mask","DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/gridview.util","DS/ENOXArchitectureCommon/services/index.service","DS/ENOXArchitectureCommon/services/modeler.service"],(function(e,t,i,n,o,r){"use strict";let s=i.getFullConfig(),a=s.identifiers,l=s.localStorageKeys;return{expandNFetchOtherNodes:function(i,n,o){var r;if("-1"===o){if(0===(r=n.getAllDescendants().filter((function(e){return!(e.options.type!==a.type_act_logref||!e.options.instance)&&!e.options.hasBeenExpanded}))).length)return void n.expandAll()}else if(0===(r=n.getChildren().filter((function(e){return!(e.options.type!==a.type_act_logref||!e.options.instance)&&!e.options.hasBeenExpanded}))).length)return void n.expandNLevels({numberOfLevelsToExpand:o});return e.mask(i.collectionView.getContent()),n.expand(),t.createBatchServiceReqExecution(r,o,i,!0,n)},getExpandServicesForBatchCalls:function(e,i,o,r,a){let c=this,d=[],u=s.disableIndexAcceleration,p=widget.getValue(l.componentView),m=!1;if(!o){let n=[];if(e.forEach((function(e){("1"!==r||"1"===r&&!e.options.noIndexOrDBExpand)&&n.push(e)})),u)d.push(c.addDBExpandForBatch(n,i,r,a));else{var f=t.sortNodesIntoDBandIndex(n,!0);f.indexNodes.length>0&&d.push(c.addIndexExpandForBatch(f.indexNodes,i,r,a)),f.databaseNodes.length>0&&d.push(c.addDBExpandForBatch(f.databaseNodes,i,r,a))}p===l.structuredView&&("2"!==r&&"-1"!==r||(m=!0),d.push(c.addOccImplementLinksToNodesInBatch(e,null,null,{bExpand:m})))}let g=[],h=[];if(u)g=e;else{let i=t.sortNodesIntoDBandIndex(e,!1);g=i.databaseNodes,h=i.indexNodes}let v=["SPECIFICATION_DOCUMENT","PROPOSED_SOLUTION","REFERENCE_DOCUMENT","IMPLEMENTING_LINK","IMPLEMENTEDBY_LINK"];return o||"2"!==r&&"-1"!==r||(m=!0),g.length>0&&d.push(n.addDBNavigate(g,{navigateTypes:v,bExpand:m})),h.length>0&&d.push(n.addIndexNavigate(h,{navigateTypes:v,bExpand:m})),Promise.all(d)},addIndexExpandForBatch:function(e,t,i,r){let s,a=this,l=[],c={},d={},u=widget.getValue("ngFilter");if(u&&u.length>0){if("1"!==i){let t=[];return e.forEach((function(e){t.push(a.expandNFetchOtherNodes(r,e,i))})),Promise.all(t)}return Promise.resolve()}return e.forEach((function(e){if(s||(s=e.getTreeDocument()),"1"!==i||"1"===i&&!e.options.noIndexOrDBExpand){l.push(e.options.physicalid);let t=e.getOccurencePath();c[t[0]]?c[t[0]].push(t):c[t[0]]=[t],d[e.options.physicalid]=e}})),l.length<=0?Promise.resolve():o.progressiveExpand({rootWithPaths:c,configFilter:t,expandLevel:parseInt(i)}).then((function(o){n.createTreeDocumentFromIndexResponse(o,s,s.getRoots()[0],t);let l=[];return e.forEach((function(e){"1"!==i&&l.push(a.expandNFetchOtherNodes(r,e,i))})),Promise.all(l)}))},addDBExpandForBatch:function(e,t,i,o){let s=this;0;let a,l=[],c={},d=widget.getValue("ngFilter");if(d&&d.length>0){if("1"!==i){let t=[];return e.forEach((function(e){t.push(s.expandNFetchOtherNodes(o,e,i))})),Promise.all(t)}return Promise.resolve()}return e.forEach((function(e){a||(a=e.getTreeDocument()),("1"!==i||"1"===i&&!e.options.noIndexOrDBExpand)&&(l.push(e.options.physicalid),c[e.options.physicalid]=e)})),l.length<=0?Promise.resolve():r.expand({itemIDs:l,depth:"-1"===i?"0":i,configFilter:t}).then((function(t){let r=[];return e.forEach((function(e){let l=e.options.physicalid;n.addDBExpandCallBack(e,null,t[l],a),"1"!==i&&r.push(s.expandNFetchOtherNodes(o,e,i))})),Promise.all(r)}))},addOccImplementLinksToNodesInBatch:function(e,t,i,o){for(var r={},s=0;s<e.length;s++)e[s].isRoot()||(r[e[s].options.instance.physicalid]=e[s]);return widget.getValue(l.componentView)!==l.structuredView?Promise.resolve():ImplementLinkService.getInstanceImplementLinks(e,!0).then((function(e){e&&((o=o||{}).keepNodes=!0,t&&t.prepareUpdate(),e.forEach((function(e){n.manageImplementLinkResp(e.node,"inst",e,o)})),t&&t.pushUpdate()),i&&i()}))}}})),define("DS/ENOXArchitectureCommon/services/logitem.service",["DS/ENOXArchitectureCommon/utils/xhr.util","DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/gridview.util","DS/ENOXArchitectureCommon/services/index.service","DS/ENOXArchitectureCommon/services/modeler.service","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i,n,o,r,s){"use strict";var a=i.getFullConfig(),l=(a.identifiers,a.localStorageKeys);var c={getCustomField:function(i){var n="",o="";null!=i&&(n=i.options.physicalid,o=i.options.label+" "+i.options.grid.revision);var r=a.webservices.dsfl_getCustomFields;return e.post(r,JSON.stringify({parentID:n}),0).then((function(e){return JSON.parse(e)})).catch((function(e){var i=s.replace(s.error.get_customFields,{title:o});return e.errorResp&&e.errorResp.message&&500!==e.errorResp.status?i+=e.errorResp.message:UWA.is(e.error,"string")&&(i+=e.error),t.alertMessage("error",null,i),Promise.reject()}))},getSubTypes:function(){return e.post(a.webservices.dslog_getSubTypes,JSON.stringify([a.identifiers.type_act_logref]),0).then((function(e){return JSON.parse(e)}))},createLogItem:function(n){var o=a.webservices.createLogItem;return e.post(o,JSON.stringify(n)).then((function(e){var n=JSON.parse(e).member[0];return i.XArchStorage().setItem(l.recentlyAuthoredStructure+n.id,Date.now()),t.setAuthoringMode(n.id),n})).catch((function(e){t.displayError(e,null,null,s.error.create_item)}))},createLogItemInstanceNew:function(n,o){var r=a.webservices.createLogItemInstanceNew+o+"/dslog:LogInstancePRIVATE";return e.post(r,JSON.stringify(n)).then((function(e){i.XArchStorage().setItem(l.recentlyAuthoredStructure+o,Date.now());var n=(e=JSON.parse(e)).member&&e.member[0]?e.member[0].reference:null;return n&&i.XArchStorage().setItem(l.recentlyAuthoredStructure+n,Date.now()),t.setAuthoringMode(),e}))},getLogItemWithExpand:function(e,r,s){var a=this;if(t.checkIfRecentlyAuthored(e,!0))return a._expandFromModeler(e,r);let c={};c[e]=[[e]];let d={rootWithPaths:c};var u=widget.getValue("NGFilter");if(u&&u.length>0){var p=JSON.parse(u);d.filter=p.CVQueryV2.filter,d.aggregation_processors=p.CVQueryV2.aggregation_processors,p.CVQueryV2.batch&&p.CVQueryV2.batch.expands[0]&&(d.filter||(d.filter=p.CVQueryV2.batch.expands[0].filter),d.aggregation_processors||(d.aggregation_processors=p.CVQueryV2.batch.expands[0].aggregation_processors))}else d.configFilter=r;return o.progressiveExpand(d).then((function(t){if(null===t)return i.XArchStorage().setItem(l.recentlyAuthoredStructure+e,Date.now()),a._expandFromModeler(e,r);let o=!1;0===t.paths.length&&(t.paths.push([e]),t.map[e]={physicalid:e,attributes:{physicalid:e}},o=!0);let s=n.createTreeDocumentFromIndexResponse(t);if(o){let e=s.getRoots()[0];var c={},d=[];return c[e.options.physicalid]=[e],d.push(a.refreshTreeNodeModel(c,!1)),Promise.all(d).then((()=>(e.expand(),s)))}return s}))},_expandFromModeler:function(e,t){widget.getValue("component-view");return r.expand({itemIDs:[e],depth:"1",configFilter:t}).then((function(t){return n.createTreeDocumentFromDslogModelerResponse(t[e])}))},refreshTreeNodeModel:function(e,t,i,n){return r.refreshTreeNodeModel(e,t,i,n)},refreshInstanceNodeModel:function(e,t){return r.refreshInstanceNodeModel(e,t)},checkInstanceCount:function(e,i){o.expandV2({forSynthesis:{IDs:e[0].options.physicalid,configFilter:i},synthType:"Flat"}).then((function(e){var i=null;e=e.slice(0,-2),(e=JSON.parse(e)).results&&(i=((i=e.results[0].synthesis.value)-1)/2)&&i>1e3&&t.alertMessage("warning",null,s.replace(s.warning.expand_largeData_warning))}),(function(){t.alertMessage("error",null,"",s.error.generic_get_failed)}))},createImplementLinks:function(t){var i=a.webservices.createScopeLinks;return e.post(i,JSON.stringify(t)).then((function(e){return e}))},deleteImplementLinks:function(t){var i=a.webservices.deleteImplementLinks;return e.post(i,JSON.stringify(t)).then((function(e){return e}))},deleteLogItemInstance:function(i,n){n instanceof Array&&n.length>20&&t.alertMessage("warning",null,s.replace(s.message.bulkOperation_limitReached,{limit:20}));var o="/resources/v1/modeler/dslog/dslog:LogItemPRIVATE/"+i+"/dslog:LogInstancePRIVATE/DELETE";return e.post(o,JSON.stringify(n),0).then((function(e){return t.setAuthoringMode(),JSON.parse(e)}))},reparentInstances:function(i){var n=a.webservices.reparentInstances+a.webservices.getLogInstMask;return i instanceof Array&&i.length>5&&t.alertMessage("warning",null,s.replace(s.msg_bulkOperation_limitReached,{limit:5})),e.post(n,JSON.stringify(i),0).then((function(e){return t.setAuthoringMode(),e}))}};return c})),define("DS/ENOXArchitectureCommon/utils/refresh.util",["DS/ENOXArchitectureCommon/model/TreeNodeModel","DS/ENOXArchitectureCommon/services/logitem.service","DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/model.events.util","DS/ENOXArchitectureCommon/utils/gridview.util"],(function(e,t,i,n,o){"use strict";var r=i.getFullConfig(),s=r.localStorageKeys;return{addChildrenToParent:function(t,o,r,a){var l={},c=[];a=a||!1,t.prepareUpdate(),o.forEach((function(t){r.forEach((function(n){var o=new e({hasBeenExpanded:!1,noIndexOrDBExpand:!1,physicalid:n.reference,instance:{physicalid:n.id},grid:{physicalid:n.reference,instanceName:n.name,instance_description:""},actualParent:t,children:[]});n.id&&o.setRelationID(n.id),t.addChild(o),c.indexOf(t.options.physicalid)<0&&(c.push(t.options.physicalid),i.XArchStorage().setItem(s.recentlyAuthoredStructure+t.options.physicalid,Date.now())),Object.keys(l).indexOf(n.reference)<0&&(l[n.reference]=[o])}))})),t.pushUpdate(),n.getFLWebModelEventsObj("xarch-dgv-events").publish({event:"xarch-dgv-refresh-nodes",data:{itemIdMap:l,tagAsRecentlyAuthored:a}})},refreshNodeDetails:function(e){var i=this,n=e.itemIdMap,o=e.tagAsRecentlyAuthored;let r={};i.configurations.services&&(i.configurations.services.getBasicAttributesCURI&&(r.basicAttributesCURI=i.configurations.services.getBasicAttributesCURI()),i.configurations.services.getAdditionalAttributesCURI&&(r.additionalAttributesCURI=i.configurations.services.getAdditionalAttributesCURI()),i.configurations.services.getAdditionalAttributes&&(r.getAdditionalAttributes=i.configurations.services.getAdditionalAttributes));var s=[];n&&(s.push(t.refreshTreeNodeModel(n,o,i.contentView,r)),Promise.all(s))},refreshInstDetailsonNode:function(e){let i,n=this,o=[],s={},a=Object.keys(e.instIdMap),l=[],c={};if(n.configurations.services&&(n.configurations.services.getBasicAttributesCURI&&(c.basicAttributesCURI=n.configurations.services.getBasicAttributesCURI()),n.configurations.services.getAdditionalAttributesCURI&&(c.additionalAttributesCURI=n.configurations.services.getAdditionalAttributesCURI()),n.configurations.services.getAdditionalAttributes&&(c.getAdditionalAttributes=n.configurations.services.getAdditionalAttributes)),a.forEach((function(t){i=e.instIdMap[t],i&&i instanceof Array||(i=n.contentView.treeDocument.getRoots()[0].getNodesByRelId(t)),l.push(i[0].options.physicalid),s[t]=i||[]})),e.bInstance&&o.push(t.refreshInstanceNodeModel(s,!0,c)),e.bEffectivity){var d={relids:a,pids:l},u=r.gridview.additionalColumnsModules.cfgEffectivty;u&&o.push(new Promise((function(e,t){u.updateAttributes(d,(function(i){var n=UWA.is(i,"string")?JSON.parse(i):i;e(n),t("Error in Cfg_updateAttributes")}),n)})).then((function(e){let t=e?e.relids:{};n.contentView.treeDocument.withTransactionUpdate((function(){a.forEach((function(e){var i=s[e],n=t[e];n&&(n.VariantEffectivity.trim()||(n.VariantEffectivity="None"),i.forEach((e=>{e.updateOptions({grid:n})})))}))}))})))}Promise.all(o).then((()=>{let e=n.contentView.getGroupingOptions();e&&n.contentView.groupRows(e)}))},refreshNodesOnReparent:function(e){var t=e.resp,n=e.params,o=e.newParent,r=e.instArray;t=t&&UWA.is(t,"string")?JSON.parse(t):t;var a=n.collectionView.treeDocument.getMappedNodesFromId(o.options.physicalid),l=t&&t.member?t.member:[];r.forEach((function(e,t){i.XArchStorage().setItem(s.recentlyAuthoredStructure+e.getParent().options.physicalid,Date.now());var o=n.collectionView.treeDocument.getMappedNodesFromId(e.options.physicalid)||[e];for(t=o.length-1;t>=0;t--){var r=o[t];if(r.options.instance.physicalid===e.options.instance.physicalid){var a=r.getParent();a.removeChild(r),a.expand()}}})),this.addChildrenToParent(n.collectionView.treeDocument,a,l,!0)},refreshReferenceLinksOnNodes:function(e){e&&(e.forEach((function(e){i.XArchStorage().setItem(s.recentlyAuthored+e.options.physicalid,Date.now())})),o.addDBNavigate(e,{navigateTypes:["IMPLEMENTEDBY_LINK","IMPLEMENTING_LINK"],treeDocument:this.contentView.treeDocument}))}}})),define("DS/ENOXArchitectureCommon/components/LogicalReference/Creation/logRef.actions.creation",["DS/UIKIT/Mask","DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/refresh.util","DS/ENOXArchitectureCommon/services/logitem.service","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i,n,o){"use strict";return{createNewItemReference:function(e,i,r){var s={items:[{attributes:{}}]};return""!==e.trim()&&(s.items[0].attributes.title=e),i&&(s.items[0].type=i),Object.keys(r).length>0&&(s.items[0].CustomFields=r),n.createLogItem(s).then((function(i){if(i)return t.alertMessage("success",null,o.success.create,e+o.success.msg_create),i}))},createNewItemInstance:function(e,i,r,s,a){var l=s;l||(l="dslog:LogItemPRIVATE");var c={instances:[{attributes:{},referencedItem:{type:l,attributes:{}}}]};return Object.keys(a).length>0&&(c.instances[0].referencedItem.CustomFields=JSON.parse(JSON.stringify(a))),""!==r.trim()&&(c.instances[0].referencedItem.attributes.title=r),n.createLogItemInstanceNew(c,e).then((function(e){return 0===r.length&&c.name&&c.name.length>0&&(r=c.name.slice(0,-2)),r.length>0?t.alertMessage("success",null,o.success.create,r+o.success.msg_create):t.alertMessage("success",null,o.success.create,o.create_log_ref),e}),(function(e){t.displayError(e,null,o.error.creation,o.error.add_item)}))},addExistingItemAsInstance:function(r,s,a,l){e.mask(s,o.message.processing);var c={instances:[]};if(l)for(var d=0;d<l.length;d++)c.instances.push({referencedID:l[d].id?l[d].id:l[d].objectId,attributes:{}});n.createLogItemInstanceNew(c,r.options.physicalid).then((function(e){var n=[];if(l.forEach((function(e){n.push(e["ds6w:label"]+" "+e["ds6wg:revision"])})),e&&e.member){var s=a.getMappedNodesFromId(r.options.physicalid);s||(s=[r]),i.addChildrenToParent(a,s,e.member,!1),t.alertMessage("success",null,o.success.add,o.success.msg_add+n.toString())}}),(function(e){t.displayError(e,null,o.error.header,o.error.add_item)})),e.unmask(s)}}})),define("DS/ENOXArchitectureCommon/components/ContentListView/contentlistview.columns",["DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/group.util","DS/ENOXArchitectureCommon/services/authoring.service","DS/ENOXArchitectureCommon/utils/model.events.util","DS/ENOXArchitectureCommon/model/TreeNodeModel","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i,n,o,r,s){var a=e.getFullConfig(),l=a.identifiers,c=a.localStorageKeys;return{getDataGridViewColumns:async function(e,t){this.contentView=e;var i=e.invalidateLayout.bind(e);let n;t.configurations&&(n=t.configurations.column);var o=this.getBaseColumns(i,n);return n&&n.addAdditionalColumns&&await n.addAdditionalColumns(o,i),o},getBaseColumns:function(t,i){var n=this;let o=[],r=i&&!i.default?i.base:[];var a=[{value:!0,icon:{iconName:"check",fontIconFamily:1,className:"archCommon-is-last-version-true"}},{value:!1,icon:{iconName:"close",fontIconFamily:1,className:"archCommon-is-last-version-false"}}];return r.indexOf("label")<0&&o.push({text:e.getNlsBasicAttributesBO("ds6w:label"),dataIndex:"tree",editableFlag:!0,sortableFlag:!0,alwaysVisibleFlag:!0,pinned:"left",width:300,setCellValue:n._defaultSetCellValue.bind(n,t,"title"),getCellEditableState:n._defaultGetCellEditableState}),r.indexOf("revision")<0&&o.push({text:e.getNlsBasicAttributesBO("ds6wg:revision"),dataIndex:"revision",getCellTypeRepresentation:n._getCellTypeRepresentation.bind(null,"revision"),hyperlinkTarget:"_self",getCellValue:n._defaultGetCellValueForClickableColumn.bind(n,"revision"),getCellGroupingKey:n._getCellGroupingKey.bind(n,"revision")}),r.indexOf("isLastVersion")<0&&o.push({text:e.getNlsBasicAttributesBO("ds6w:isLastRevision"),dataIndex:"isLastVersion",typeRepresentation:"customBoolean",width:95,getCellSemantics:function(){return{possibleValues:a}},getCellGroupingKey:n._getCellGroupingKey.bind(n,"isLastVersion")}),r.indexOf("instanceName")<0&&o.push({text:e.getNlsBasicAttributesBO("ds6w:label"),icon:{iconName:"object-instance"},dataIndex:"instanceName",editableFlag:!0,setCellValue:n._defaultSetCellValue.bind(n,t,"instanceName"),getCellEditableState:n._defaultGetCellEditableState,getCellGroupingKey:n._getCellGroupingKey.bind(n,"instanceName")}),r.indexOf("maturity")<0&&o.push({text:e.getNlsBasicAttributesBO("ds6w:status"),dataIndex:"maturity",getCellTypeRepresentation:n._getCellTypeRepresentation.bind(null,"maturity"),hyperlinkTarget:"_self",getCellValue:n._defaultGetCellValueForClickableColumn.bind(n,"maturity"),getCellGroupingKey:n._getCellGroupingKey.bind(n,"maturity")}),r.indexOf("owner")<0&&o.push({text:e.getNlsBasicAttributesBO("ds6w:responsible"),dataIndex:"owner",typeRepresentation:"url",getCellTypeRepresentation:n._getCellTypeRepresentation.bind(null,"owner"),hyperlinkTarget:"_self",getCellValue:n._defaultGetCellValueForClickableColumn.bind(n,"owner"),getCellGroupingKey:n._getCellGroupingKey.bind(n,"owner")}),r.indexOf("isReserved")<0&&o.push({text:e.getNlsBasicAttributesBO("ds6w:reserved"),dataIndex:"isReserved",alignment:"center",typeRepresentation:"image",width:95,getCellGroupingKey:n._getCellGroupingKey.bind(n,"isReserved")}),r.indexOf("modificationDate")<0&&o.push({text:e.getNlsBasicAttributesBO("ds6w:modified"),dataIndex:"modificationDate",getCellValue:n._defaultGetCellValueForDate.bind(n,"modificationDate")}),r.indexOf("description")<0&&o.push({text:e.getNlsBasicAttributesBO("ds6w:description"),dataIndex:"description",editableFlag:!0,setCellValue:n._defaultSetCellValue.bind(n,t,"description"),getCellEditableState:n._defaultGetCellEditableState,typeRepresentation:"multilineString",editionPolicy:"EditionOnClick"}),r.indexOf("instanceDescription")<0&&o.push({text:e.getNlsBasicAttributesBO("ds6w:description"),icon:{iconName:"object-instance"},dataIndex:"instance_description",setCellValue:n._defaultSetCellValue.bind(n,t,"instance_description"),visibleFlag:!1,editableFlag:!0,typeRepresentation:"multilineString",editionPolicy:"EditionOnClick"}),r.indexOf("type")<0&&o.push({text:e.getNlsBasicAttributesBO("ds6w:type"),dataIndex:"type"}),r.indexOf("name")<0&&o.push({text:e.getNlsBasicAttributesBO("ds6w:identifier"),dataIndex:"name"}),r.indexOf("creationDate")<0&&o.push({text:e.getNlsBasicAttributesBO("ds6w:created"),dataIndex:"creationDate",getCellValue:n._defaultGetCellValueForDate.bind(n,"creationDate")}),r.indexOf("isIPProtected")<0&&o.push({text:s.title.IPProtection,dataIndex:"isIPProtected",typeRepresentation:"boolean",visibleFlag:!1,width:95,getCellGroupingKey:n._getCellGroupingKey.bind(n,"isIPProtected")}),o},_getCellTypeRepresentation:function(e,t){return t.nodeModel?(t.nodeModel.options.type!==l.type_act_logref||t.nodeModel.options.virtual)&&("maturity"!==e&&"owner"!==e||t.nodeModel.options.type!==l.type_act_logref||!t.nodeModel.options.linkInfo||"implementing"!==t.nodeModel.options.linkInfo.linkType||"ref"!==t.nodeModel.options.linkInfo.objType)&&("maturity"!==e&&"owner"!==e||!(t.nodeModel.getParent()&&t.nodeModel.getParent().options.type===l.type_spec_document||"DIF"===t.nodeModel.options.grid.kindOfRFLP))?"string":"url":"string"},_defaultGetCellEditableState:function(e){return!(!e.nodeModel||e.nodeModel.options.type!==l.type_act_logref||e.nodeModel.options.virtual)&&!(t.checkIfMaturityIsReleasedOrObsolete(e.nodeModel.options.maturity)||e.nodeModel.options.grid&&e.nodeModel.options.grid.isReservedByOther)},_defaultGetCellValueForClickableColumn:function(e,t){var i=t.nodeModel.options.physicalid,n=s.label.none;(!i||i.length<=0)&&(n="");var o=t.nodeModel.options.grid[e]||n;return"url"===this._getCellTypeRepresentation(e,t)?{label:o}:o},_defaultSetCellValue:function(a,l,d,u){var p=this,m="instanceName"===l||"instance_description"===l;if("title"===l&&(0===u.length||u.length>70)){if(0===u.length)t.alertMessage("error",null,s.error.mandatory_field_title);else if(u.length>70){let e=s.replace(s.error.too_long_field_title,{fieldName:s.labels.title,maxLength:70});t.alertMessage("error",null,e)}a({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}else{var f;if("instanceName"===l){let e=80;if(u.length>e){let i=s.replace(s.error.too_long_field_title,{fieldName:s.labels.instance_title,maxLength:e});return t.alertMessage("error",null,i),void a({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}f=n.updateAttribute([{refID:d.nodeModel.options.physicalid,instID:d.nodeModel.options.instance.physicalid,attributes:{"PLMInstance.PLM_ExternalID":u}}])}else if("instance_description"===l)f=n.updateAttribute([{refID:d.nodeModel.options.physicalid,instID:d.nodeModel.options.instance.physicalid,attributes:{"PLMInstance.V_description":u}}]);else{var g={};"title"===l?g["PLMEntity.V_Name"]=u:"description"===l?g["PLMEntity.V_description"]=u:g[l]=u,f=n.updateAttribute([{refID:d.nodeModel.options.physicalid,attributes:g}])}p.contentView.displayModalLoader(s.message.processing),f.then((function(n){let s=n&&n[0]&&n[0].body,f=[],g=[];var h=n[0].body.modified?t.formatDate(s.modified.value[0]):null;if((p.contentView.treeDocument.getMappedNodesFromId(d.nodeModel.options.physicalid)||[d.nodeModel]).forEach((function(e){if("title"===l)e.options.label=u,e.options.grid.modificationDate=h;else if(m)if(s.oldInstancePhysicalid){let t=e.getParent(),i=new r({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,physicalid:e.options.physicalid,instance:{physicalid:s.physicalid},grid:{physicalid:e.options.physicalid},actualParent:e.options.actualParent,children:[]});i.setRelationID(s.physicalid),t.addChild(i,e._rowID),f.push(i),g.push(e)}else e.options.instance&&e.options.instance.physicalid===d.nodeModel.options.instance.physicalid&&(e.options.grid[l]=u,e.options.instance.modificationDate=h);else e.options.grid[l]=u,e.options.grid.modificationDate=h})),m){if(f.length>0&&g.length>0){d.nodeModel.unselect(),d.nodeModel.getNextNode().select();let e={};e[s.oldInstancePhysicalid]=g,e[s.physicalid]=f;let t=o.getFLWebModelEventsObj("xarch-dgv-events");t.publish({event:"xarch-dgv-refresh-nodes",data:{arrayOfPID:[g[0].options.physicalid],tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:!0}}),t.publish({event:"xarch-dgv-refresh-instances",data:{instIdMap:e,bInstance:!0,bEffectivity:!0}})}let t=widget.getValue("groupingEnabled"),n=d.nodeModel.getParent();t&&!n.getID&&(n=i.getGroupNodeParent(n)),e.XArchStorage().setItem(c.recentlyAuthoredStructure+n.getID(),Date.now())}else e.XArchStorage().setItem(c.recentlyAuthored+d.nodeModel.getID(),Date.now());a({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0});let v=p.contentView.getGroupingOptions();v&&p.contentView.groupRows(v)})).catch((function(){a({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),t.displayError({},s.error.no_modification_possible,null,s.error.no_modification_possible)})).finally((function(){p.contentView.removeModalLoader(s.message.processing)}))}},_defaultGetCellValueForDate:function(e,i){if(i&&i.nodeModel&&i.nodeModel.options.grid[e])return t.displayDate(i.nodeModel.options.grid[e])},_getCellGroupingKey:function(e,t){let i=this;if(t.nodeModel&&t.columnID){let n=i.contentView.getColumnOrGroup(t.columnID).typeRepresentation,o=t.nodeModel.options.grid[e];if("customBoolean"===n)return o?s.label.true:s.label.false;if("image"===n&&"isReserved"===e){return"TRUE"===t.nodeModel.options[e]?s.label.true:s.label.false}return t.nodeModel.options.grid[e]}}}})),define("DS/ENOXArchitectureCommon/components/LogicalReference/ImplementLinks/implementLinks.controller",["DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/model.events.util","DS/ENOXArchitectureCommon/services/common.service","DS/ENOXArchitectureCommon/services/logitem.service","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i,n,o){"use strict";return{createReferenceLinks:function(r,s){var a,l=[],c=[];s.forEach((function(e){c.push(e.id)})),i.getKindOfRFLP(c).then((function(i){i&&i.length>0&&(i.forEach((function(e,t){a={},"P"===e?(a.implementing=c[t],a.implemented=r.options.physicalid):(a.implementing=r.options.physicalid,a.implemented=c[t]),l.push(a)})),n.createImplementLinks(l).then((function(){t.getFLWebModelEventsObj("xarch-dgv-events").publish({event:"xarch-dgv-creation-refLinks-success",data:[r]}),e.alertMessage("success","",o.success.msg_create_ref2ref)})).catch((function(t){e.displayError(t,null,null,o.error.create_refref_link)})))}),(function(t){e.displayError(t,null,o.error.create_refref_link)}))},deleteImplementRelation:function(t){var i,r=t.selectedNodes,s=[];r.forEach((function(e){(i=e.options.linkInfo)&&s.push(i.implementId)})),s.length>0&&n.deleteImplementLinks(s).then((function(){var n,s=[];r.forEach((function(e){i=e.options.linkInfo;var o=e.getParent().getParent();(n=t.treeDocument.getMappedNodesFromId(o.options.physicalid))||(n=[o]),n.forEach((function(e){s.push(e);var t=e.options.instance?e.options.instance.physicalid:"",n=e.getNodesByRelId(i.linkType+i.objType+t)[0];n&&(n.getChildren().forEach((function(e){e.options.linkInfo.implementId===i.implementId&&e.remove()})),n.getChildren()&&0!==n.getChildren().length||n.remove()),e.expand()}))})),e.alertMessage("success","",o.success.msg_delete_link_success)})).catch((function(t){e.displayError(t,null,null,o.error.error_delete_link)}))}}})),define("DS/ENOXArchitectureCommon/components/LogicalReference/Creation/logRef.createPanel",["UWA/Core","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/WUXAutoComplete/AutoComplete","DS/Controls/Button","DS/Controls/LineEditor","DS/Controls/SpinBox","DS/Controls/Toggle","DS/UIKIT/Mask","DS/ENOXArchitectureCommon/components/LogicalReference/Creation/logRef.actions.creation","DS/ENOXArchitectureCommon/services/logitem.service","DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/refresh.util","DS/ENOXArchitectureCommon/utils/model.events.util","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon","i18n!DS/ENOXArchitectureCommon/assets/nls/LogicalReferenceNLS"],(function(e,t,i,n,o,r,s,a,l,c,d,u,p,m,f,g,h,v,y){"use strict";var b=f.getFullConfig(),C=b.localStorageKeys,I=b.identifiers;return{createFieldRowDiv:function(t,i,n,o,r){var s=e.createElement("div",{class:t});i&&s.setStyles(i);var a=e.createElement("label",{html:n}),l=e.createElement("div",{class:"field-container"});return a.inject(l),l.inject(s),o.addClassName("elem-container"),o.inject(s),s},formatSubTypeList:function(e){var t=this;if(t.logRefSubTypes=f.getFullConfig().logicalRefSubTypes,t.logRefSubTypes&&t.logRefSubTypes.length<1&&(t.showSubtype=!1),t.logRefSubTypesCurated=[],t.showSubtype&&e){var i=null,n=null,o=null;for(var i in e){o=!1;for(var r=0;r<t.logRefSubTypes.length;r++)if(i===(n=t.logRefSubTypes[r]).Name){t.logRefSubTypesCurated.push(n),o=!0;break}o||t.logRefSubTypesCurated.push({NLS:i,Name:i,Package:e[i],PackageName:e[i],Parent:I.type_act_logref})}t.logRefSubTypesCurated.sort((function(e,t){return e.NLS.toLowerCase()<t.NLS.toLowerCase()?1:e.NLS.toLowerCase()>t.NLS.toLowerCase()?-1:0})),t.logRefSubTypesCurated.sort((function(e,t){return e.PackageName.toLowerCase()<t.PackageName.toLowerCase()?1:e.PackageName.toLowerCase()>t.PackageName.toLowerCase()?-1:0})),t.logRefSubTypesCurated.reverse()}},createAutocomplete:function(){var e=this,t=null,i=null,s=null;let a=!1,l=!1,c=localStorage.getItem("prevSelSubType");var d=new n({shouldBeSelected:function(e){return!e.options.isPackage}}),u=null;d.prepareUpdate();for(var p=null,m=0;m<e.logRefSubTypesCurated.length;m++)"True"!==(p=e.logRefSubTypesCurated[m]).Abstract&&(!(i=p.PackageName)||null!==t&&t===i||(null!==s&&(d.addRoot(s),s.expandAll()),s=new o({label:i,value:p.Package,isPackage:!0}),t=i),u=p.IconName?f.getTypeIconUrl(p.Name).iconPath:f.getTypeIconUrl(I.type_act_logref).iconPath,s.addChild(new o({label:p.NLS,icons:[u],isPackage:!1,value:p.Name})),p.Name===c?l=!0:p.Name===I.type_act_logref&&(a=!0));null!==s&&(d.addRoot(s),s.expandAll()),d.pushUpdate();var g=new r({elementsTree:d,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1});return g.getContent().addClassName("basicFieldAttribute"),g.addEventListener("change",e.manageEmptyField.bind(e,g,!0)),g.value=e.getPreviousSelectedSubType(c,l,a),g},getPreviousSelectedSubType:function(e,t,i){if(t)return e;if(i)return I.type_act_logref;let n="";for(var o=0;o<this.logRefSubTypesCurated.length;o++){let e=this.logRefSubTypesCurated[o];if("True"!==e.Abstract){n=e.Name;break}}return n},createCustomFields:function(t,i){var n,o,s,d=this,u=null;t.forEach((function(t){var p,m={};if(u=i[t],n=u.format,o=void 0!==u.editable&&!u.editable,p=null,s=null,null,"string"==n||"number"==n||"enum"==n||"boolean"==n){switch(n){case"string":(p=new a({placeholder:v.ph.title,value:void 0===u.value?void 0===u.defaultValue?"":u.defaultValue:u.value,disabled:o,selectAllOnFocus:!0,displayClearFieldButtonFlag:!0})).getContent().getElement("input").addClassName("customFieldAttribute"),m.type="textBox",m.required=u.required,p.addEventListener("change",d.manageEmptyField.bind(d,p,m.required));break;case"enum":var f=u.range,g=u.rangeLabel,h="";h=u.value?u.value:u.defaultValue?u.defaultValue:"";for(var y=[],b=0;b<f.length;b++)y.push({label:void 0!==g?g[b]:f[b],value:f[b]});(p=new r({elementsTree:y,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1,disabled:o})).value=h,m.type="dropDown",m.required=u.required,p.addEventListener("change",d.manageEmptyField.bind(d,p,m.required));break;case"number":h="";u.defaultValue&&(h=u.defaultValue),u.value&&(h=u.value),p=new l({value:h,maxValue:1e7,stepValue:1,disabled:o}),m.type="numberBox",m.required=u.required,p.addEventListener("change",d.manageEmptyField.bind(d,p,m.required));break;case"boolean":p=new c({type:"switch",disabled:o,checkFlag:void 0===u.value?void 0!==u.defaultValue&&u.defaultValue:u.value}),m.type="checkBox",m.required=u.required;break;default:return}s=e.createElement("div",{class:"custom-field-container"}),m.element=p,m.label=u.label,m.key=t,p.inject(s),p.getContent().addClassName("customFieldAttribute"),d.createFieldRowDiv("customFieldRow",null,u.label,s,null).inject(d.logRefCreateForm),d._inputElemList.push(m)}}))},createFooter:function(){var e=null,t=null,i=null,n={};if(null===this.rootID)e=v.action.create_and_open,t="btn-create-and-close";else if(this.isReplaceCall)e=v.action.create_and_replace,t="btn-replace-and-close";else{e=v.action.create,i=v.action.create_and_close,t="btn-create";var o=new s({label:i});o.getContent().classList.add("btn-create-and-close")}var r=new s({label:e});r.getContent().classList.add(t);var a=new s({label:v.action.close,onClick:function(e){document.getElementById("create-logicalref-immersiveFrame").destroy()}});return a.getContent().classList.add("btn-close"),n={Cancel:a,Ok:r},null!=i&&o&&(n.Apply=o),n},createTitleField:function(){var t,i=this,n=new a({placeholder:v.ph.title,selectAllOnFocus:!0,sizeInCharNumber:70,displayClearFieldButtonFlag:!0});n.getContent().getElement("input").addClassName("basicFieldAttribute"),t={type:"textBoxNameField",required:!1,element:n},i._inputElemList.push(t);var o=e.createElement("div",{class:"title-box"});n.inject(o),i.createFieldRowDiv("titleFieldRow",null,v.label.title,o,null).inject(i.logRefCreateForm)},createTypeField:function(){var t=this,i=t.createAutocomplete(),n={type:"dropDownTypeField",required:!1,element:i,label:v.label.type};t._inputElemList.push(n);var o=e.createElement("div",{class:"item-type-selector"});i.inject(o),t.createFieldRowDiv("typeFieldRow",null,v.label.type,o,null).inject(t.logRefCreateForm)},create:function(n,o,r,s,a,l,c){var d=this;d._inputElemList=[],d.showSubtype=a,d.isReplaceCall=s,d.modelEventsContentListView=h.getFLWebModelEventsObj("xarch-dgv-events"),d.parentID=o?o.options.physicalid:null,d.rootID=o?o.getRoot().options.physicalid:null,d.parentItem=o,o&&d.isReplaceCall&&(d.replaceRefId=o.getParent().options.physicalid,d.replaceInsId=o.options.instance.physicalid,d.replaceRootId=o.getRoot().options.physicalid);var u=d.createFooter(),p=new t({domId:"create-logicalref-immersiveFrame"});null!=n&&p.inject(n),d.logRefCreateForm=e.createElement("div",{class:"logRef-create-form"}),d.modal=new i({title:y.action.add_new,content:d.logRefCreateForm,domId:"create-logicalref-dialog",immersiveFrame:p,width:450,resizableFlag:!0,buttons:u,modalFlag:!0}),d.modal.close=function(){document.getElementById("create-logicalref-immersiveFrame").destroy()},d.createTitleField(),d.showSubtype&&(d.formatSubTypeList(l),d.createTypeField());var m=r.fieldNames,f=r.fields;for(var g in m&&d.createCustomFields(m,f),d.modal.buttons){var v=d.modal.buttons[g];null===d.rootID||d.isReplaceCall||v.getContent().hasClassName("btn-create")&&(v.onClick=function(){d._createReferenceItem(!1,c)}),d.isReplaceCall?v.getContent().hasClassName("btn-replace-and-close")&&(v.onClick=function(){d._createReferenceItem(!0,c)}):v.getContent().hasClassName("btn-create-and-close")&&(v.onClick=function(){d._createReferenceItem(!0,c)})}return d.modal},_createReferenceItem:function(e,t){for(var i,n,o,r,s,a=this,l={},c=0;c<a._inputElemList.length;c++)if("textBoxNameField"===(r=a._inputElemList[c]).type)i=r.element.value.trim();else if("dropDownTypeField"===r.type){if(!r.element.value||""==r.element.value)return m.alertMessage("error",null,v.error.req_field,v.replace(v.error.req_field_subtitle,{field:r.label})),r.element.getContent().getElement("input").addClassName("error-empty-field"),void r.element.getContent().focus();n=r.element.value,localStorage.setItem("prevSelSubType",n)}else{if("checkBox"===r.type)o=r.element.checkFlag;else if(o=r.element.value,r.required&&(!o||""==r.element.value))return m.alertMessage("error",null,v.error.req_field,v.replace(v.error.req_field_subtitle,{field:r.label})),r.element.getContent().getElement("input").addClassName("error-empty-field"),void r.element.getContent().focus();l[r.key]=o}d.mask(a.modal.elements._contentDiv,v.message.creating),a.isReplaceCall&&a.replaceRefId&&a.replaceInsId||(s=null===a.rootID?u.createNewItemReference(i,n,l):u.createNewItemInstance(a.parentID,a.rootID,i,n,l)),s.then((function(i){if(d.unmask(a.modal.elements._contentDiv),null!==a.rootID||a.isReplaceCall)if(a.isReplaceCall&&a.replaceRootId)if(document.getElementById("create-logicalref-immersiveFrame").destroy(),200==i.status||i.member){var n=i.member?i.member[0]:null,o=[],r={};if(n){f.XArchStorage().setItem(C.recentlyAuthoredStructure+a.replaceRefId,Date.now());var s=a.parentItem.options.instance.physicalid;(u=t.getMappedNodesFromId(a.parentItem.options.physicalid))||(u=[selectedNode]);for(var l=u.length-1;l>=0;l--){var c=u[l];c.options.instance.physicalid===s&&(t.removeFromMappedNodes(c),c.removeChildren(),c.collapse(),c.updateOptions({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,configContexts:void 0,physicalid:n.reference,instance:{physicalid:n.id},grid:{instanceName:n.name,physicalid:n.reference,hasEffectivity:void 0,configCtx:void 0}}),c.setRelationID(n.id),t.addToMappedNodes(c))}o.push(n.reference),r[n.id]=a.parentItem,h.getFLWebModelEventsObj("xarch-dgv-events").publish({event:"xarch-dgv-refresh-nodes",data:{arrayOfPID:o,tagAsRecentlyAuthored:!0}}),h.getFLWebModelEventsObj("xarch-dgv-events").publish({event:"xarch-dgv-refresh-instances",data:{instIdMap:r,bInstance:!0,bEffectivity:!0}})}m.alertMessage("success",null,"",v.success.replace)}else m.alertMessage("error",null,"",i.message);else{var u;if(e&&document.getElementById("create-logicalref-immersiveFrame").destroy(),i&&i.member)(u=t.getMappedNodesFromId(a.parentItem.options.physicalid))||(u=[a.parentItem]),g.addChildrenToParent(t,u,i.member,!0)}else document.getElementById("create-logicalref-immersiveFrame").destroy(),h.getFLWebModelEventsObj("xarch-common-events").publish({event:"flweb-load-item",data:{itemPID:i.id?i.id:i.physicalid}})}),(function(e){document.getElementById("create-logicalref-immersiveFrame").destroy(),m.displayError(e,null,null,v.error.create_item)}))},manageEmptyField:function(e,t){t&&(e.value&&e.value.length>0?e.getContent().getElement("input").removeClassName("error-empty-field"):e.getContent().getElement("input").addClassName("error-empty-field"))}}})),define("DS/ENOXArchitectureCommon/mixins/CATFLBIFilter",["UWA/Class","UWA/Class/Events","DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/gridview.util","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i,n,o){"use strict";return{addEventsOnBiFilter:function(e,t){this.biFilter=e,this.model=t,this.biFilter&&this.model&&this.biFilter.addEvent("ApplyNGFilter",this.onApplyNGFilter,this)},onApplyNGFilter:function(e){var t=this;null!==e&&t.model.applyFilter(e,t.processNGFilter.bind(t,e))},processNGFilter:function(e,t){t.response?(t.recentlyAuthored&&!e.empty&&i.alertMessage("warning",null,o.warning.indexed_data_filtered),t.treedocument.empty(),t.treedocument.hasBeenExpanded=!0,t.recentlyAuthored&&e.empty?n.createTreeDocumentFromDslogModelerResponse(t.response,t.treedocument):n.createTreeDocumentFromIndexResponse(t.response,t.treedocument)):i.alertMessage("info",null,o.info.no_match_in_filter)},onSetTagsWithExpandSynthesis:function(){if(this.biFilter&&this.model&&this.model.getRealRoots()[0]){var e=this;this.biFilter.setSynthesisMode("flat"),setTimeout((function(){var t=e.model.getRealRoots()[0],i=t?t.getID():null;e.biFilter.setTagsWithExpandSynthesis&&i&&e.biFilter.setTagsWithExpandSynthesis([i],{type_filter_rel:["RFLVPMLogicalInstance","RFLPLMFunctionalInstance"]})}))}}}})),define("DS/ENOXArchitectureCommon/components/ContentListView/ContextualMenu/contextualmenu.factory",["DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/gridview.util","DS/ENOXArchitectureCommon/components/GenericCommands/command.controller","DS/ENOXArchitectureCommon/components/GenericCommands/RelationsCmd","DS/ENOXArchitectureCommon/services/logitem.service","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i,n,o,r){"use strict";var s=function(e,t,i,n,o,r,s){var l={type:"PushItem",title:e};return r&&(l.icon=r),t&&(l.fonticon={family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-"+t}),i&&(l.action={callback:i.bind(a)}),n&&(l.state="disabled",o&&(l.tooltip=o)),s&&(l.id=s),l},a={defaultMenu:{expand:"oneLevel"},createMenuItem:function(e){return s(e.title,e.fonticon,e.callback,e.disabled,e.tooltip,e.icon,e.subMenuId)},createCollapseAllMenu:function(e){return s(r.action.collapse_all,"flow-tree-expand-up",(function(){e.forEach((function(e){e.collapseAll()}))}))},createCompareMenu:function(e){return s(r.action.compare,"part-compare",(function(){var t={context:e};i.init("CompareCmd",t)}))},createDuplicateMenu:function(e){return s(r.action.duplicate,"duplicate",(function(){var t={context:e};i.init("DuplicateCommand",t)}))},createExpandMenu:function(i,n){var l,c,d=s(r.action.expand_one_level,"flow-tree-expand-down");return d.submenu=[s(r.action.expand_one_level,"flow-tree-child-1-expand-down",(function(){this.defaultMenu.expand="oneLevel",t.expandNodestoNLevel({level:"1",selectedNodes:n,params:i})}),null,null,null,"oneLevel"),s(r.action.expand_two_level,"flow-tree-expand-down-cog",(function(){this.defaultMenu.expand="twoLevel";var o=widget.getValue("currentConfig");o&&o.filterCompiledForm&&o.filterCompiledForm,n.length>1&&e.alertMessage("warning",null,r.warning.expand_multiLvl_multiSelect),t.expandNodestoNLevel({level:"2",selectedNodes:n,params:i})}),l,c,null,"twoLevel"),s(r.action.expand_all,"flow-tree-expand-down",(function(){this.defaultMenu.expand="allLevel";var s=null,a=widget.getValue("currentConfig");a&&a.filterCompiledForm&&(s=a.filterCompiledForm),1===n.length?o.checkInstanceCount(n,s):n.length>1&&e.alertMessage("warning",null,r.warning.expand_multiLvl_multiSelect),t.expandNodestoNLevel({level:"-1",selectedNodes:n,params:i})}),l,c,null,"allLevel")],function(e,t){let i=null,n=!0;for(let o=0;o<e.submenu.length;o++){let r=e.submenu[o];r.id===a.defaultMenu[t]&&(e.title=r.title,"disabled"!==r.state?r.state="selected":n=!1,r.fonticon&&(e.fonticon=r.fonticon),"disabled"===e.state?r.state="disabled":e.action=r.action),r.type="RadioItem",null===i&&"disabled"!==r.state&&(i=o)}if("disabled"!==e.state&&!n&&null!==i){let t=e.submenu[i];e.title=t.title,e.action=t.action,t.fonticon&&(e.fonticon=t.fonticon),t.state="selected"}}(d,"expand"),d},createInformationMenu:function(e,t,i,n){return s(r.action.information,"info",(function(){i.publish({event:"xarch-information-cmd",data:{items:t,contentView:e}})}))},createMaturityMenu:function(e){return s(r.action.maturity,"collaborative-lifecycle-management",(function(){var t={context:e};i.init("MaturityCommand",t)}))},createMoveToMenu:function(e){return s(r.action.move_to,"move-to",(function(){var t={context:e};i.init("ChangeOwnerCommand",t)}))},createShareMenu:function(e){return s(r.action.share,"forward",(function(){var t={context:e};i.init("ShareCmd",t)}))},createOpenWithMenu:function(e){var t;return e&&e.length>0&&((t=s(r.action.open_with,"open-menu-dot")).submenu=[],e.forEach((function(e){t.submenu.push(s(e.text,e.fonticon,e.handler,null,null,e.icon))}))),t},createRelationsMenu:function(e){return s(r.action.relations,"object-related",(function(){n.execute("ENORIPE_AP",e)}))},createRevisionsMenu:function(e){return s(r.action.revisions,"flow-branch-list",(function(){var t={context:e};i.init("HistoryCommand",t)}))},createReserveMenu:function(e,t){return s(r.action.lock,"lock",(function(){var t={context:e};i.init("ReserveCmd",t)}),t,r.error.action_unavailable_in_release)},createUnreserveMenu:function(e){return s(r.action.unlock,"lock-open",(function(){var t={context:e};i.init("UnreserveCmd",t)}),null,r.error.action_unavailable_in_release)}};return a})),define("DS/ENOXArchitectureCommon/components/ContentListView/contentlistview.actions",["DS/UIKIT/Mask","DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/group.util","DS/ENOXArchitectureCommon/services/logitem.service","DS/ENOXArchitectureCommon/utils/config.util","text!DS/ENOXArchitectureCommon/assets/config/localStorage.keys.json","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i,n,o,r,s){"use strict";var a=JSON.parse(r);return{deleteLogItemInstance:function(r){var l=this,c=r.contentView.getContent(),d=r.contentView.treeDocument.getSelectedNodes();e.mask(c,s.message.processing);let u=widget.getValue("groupingEnabled");var p={},m={};d.forEach((function(e){var t=e.options.instance.physicalid,n=e.getParent();u&&!n.getID&&(n=i.getGroupNodeParent(n));let o=n.options.physicalid;void 0===p[o]&&(p[o]=[],m[o]=[]),p[o].push(t),m[o].push(e)}));var f=[],g={success:[],failure:[],errorMessages:[]};for(var h in p)o.XArchStorage().setItem(a.recentlyAuthoredStructure+h,Date.now()),p.hasOwnProperty(h)&&f.push(n.deleteLogItemInstance(h,p[h]).then(l.updateViewOnDelete.bind(l,r.contentView.treeDocument,m[h],"success",g)).catch(l.updateViewOnDelete.bind(l,r.contentView.treeDocument,m[h],"failure",g)));Promise.all(f).finally((function(){if(g&&g.success.length>0){let e=r.contentView.getGroupingOptions();e&&r.contentView.groupRows(e),t.alertMessage("success",null,s.success.inst_detach+g.success.toString())}if(g&&g.failure.length>0){let e=g.failure.toString();if(g.errorMessages&&Object.keys(g.errorMessages).length>0){e+="<br><br>"+s.title.error_details;for(let t in g.errorMessages)e+="<br><b>"+g.errorMessages[t].toString()+"</b><br>",t.indexOf("\n\n")>=0&&(t=t.split("\n\n")[1]),e+=t}t.alertMessage("error",null,null,s.error.inst_detach+e)}e.unmask(c)}))},updateViewOnDelete:function(e,t,n,r,s){let l=widget.getValue("groupingEnabled"),c=t[0].getParent();l&&!c.getID&&(c=i.getGroupNodeParent(c));let d=c.options.physicalid;"success"===n?(r.success.push(c.options.label),l&&c.isRoot()?t.forEach((function(e){let t=e.getParent();t.getChildren().forEach((function(t){t.options.instance&&t.options.instance.physicalid===e.options.instance.physicalid&&t.remove()})),i.removeGroupNodesOnEmpty(t)})):t.forEach((function(t){let i;i=e.getMappedNodesFromId(d),i.forEach((function(e){e.getChildren().forEach((function(e){e.options.instance&&e.options.instance.physicalid===t.options.instance.physicalid&&e.remove()})),e.expand()}))})),o.XArchStorage().setItem(a.recentlyAuthoredStructure+d,Date.now())):(s.errorResp&&s.errorResp.message&&(Object.keys(r.errorMessages).indexOf(s.errorResp.message)<0?r.errorMessages[s.errorResp.message]=[c.options.label]:r.errorMessages[s.errorResp.message].push(c.options.label)),r.failure.push(c.options.label))}}})),define("DS/ENOXArchitectureCommon/components/LogicalReference/logicalReference.controller",["DS/UIKIT/Mask","DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/search.util","DS/ENOXArchitectureCommon/utils/refresh.util","DS/ENOXArchitectureCommon/components/LogicalReference/Creation/logRef.actions.creation","DS/ENOXArchitectureCommon/components/LogicalReference/Creation/logRef.createPanel","DS/ENOXArchitectureCommon/components/Edition/CopyPasteDialog","DS/ENOXArchitectureCommon/components/ConfirmationWindow/ConfirmationWindow","DS/ENOXArchitectureCommon/components/ContentListView/contentlistview.actions","DS/ENOXArchitectureCommon/components/LogicalReference/ImplementLinks/implementLinks.controller","DS/ENOXArchitectureCommon/services/logitem.service","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon","i18n!DS/ENOXArchitectureCommon/assets/nls/LogicalReferenceNLS"],(function(e,t,i,n,o,r,s,a,l,c,d,u,p){"use strict";return{openCmdCreateLogicalReference:function(e){let i;e&&e.selectedItem?i=e.selectedItem:1===e.contentView.treeDocument.getSelectedNodes().length&&(i=e.contentView.treeDocument.getSelectedNodes()[0]);var n=[];n.push(d.getCustomField(i)),e.showSubtype&&n.push(d.getSubTypes(i.options.grid.actualType)),Promise.all(n).then((function(n){let o=n[0],s=n[1]||null;e.showSubtype&&(!s||Object.keys(s).length<=0)&&t.alertMessage("info",null,u.warn_instantiation_not_allowed),r.create(e.container,i,o,e.isReplaceCall,e.showSubtype,s,e.contentView.treeDocument)}),(function(e){t.displayError(e)}))},openCmdExistingLogicalReference:function(e){let t=e.contentView.treeDocument.getSelectedNodes()[0];var n=o.addExistingItemAsInstance.bind(this,t,e.container,e.contentView.treeDocument);i.launchSearch({searchTitle:e.search_title,allowedTypes:e.allowedTypes,role:"",criteria:e.allowedTypes,bMultiSel:!0,in_apps_callback:n})},openCmdCopyAttributes:function(e){let t=e.contentView.treeDocument.getSelectedNodes()[0];s.open(t,e.contentView)},openCmdPasteAttributes:function(e){s.submit()},openCmdDetachLogicalReference:function(t){let i=t.contentView.treeDocument.getSelectedNodes(),n=UWA.createElement("div");UWA.createElement("p",{html:p.message.confirm_detach_instance}).inject(n),t.subMsgElement&&t.subMsgElement.inject(n);let o=u.action.detach+" - ";1===i.length?o+=i[0].options.label:o=o+i.length+" "+u.label.objects,a.createWindow(o,n,u.action.detach,(function(){e.mask(t.contentView.getContent(),u.message.processing),l.deleteLogItemInstance(t)}))},openCmdCreateImplementRelation:function(e){var t=e.types;let n=e.contentView.treeDocument.getSelectedNodes()[0];i.launchSearch({allowedTypes:t,role:e.role?e.role:"",criteria:t,bMultiSel:!!e.multiSel&&e.multisel,in_apps_callback:c.createReferenceLinks.bind(null,n)})},openCmdDeleteImplementRelation:function(e){let t=e.contentView.treeDocument.getSelectedNodes();c.deleteImplementRelation({selectedNodes:t,treeDocument:e.contentView.treeDocument})},openCmdReparent:function(i){let o=i.params,r=i.infoInstToReparent,s=i.parentNode;for(var l=0;l<r.instances.length;l++)if(s.options.physicalid===r.instances[l].options.physicalid)return void t.alertMessage("error",null,p.error.reparent_cyclic);let c=UWA.createElement("p",{html:p.message.confirm_reparent+s.options.label+" ? <br>"+r.nameList});a.createWindow(u.action.reparent,c,u.action.reparent,(function(){e.mask(i.params.collectionView.getContent(),u.message.processing);var a=[];r.instances.forEach((function(e){a.push({parentID:s.options.physicalid,instanceID:e.options.instance.physicalid,itemID:e.options.physicalid})})),d.reparentInstances(a).then((function(i){n.refreshNodesOnReparent({resp:i,params:o,newParent:s,instArray:r.instances}),e.unmask(o.collectionView.getContent()),t.alertMessage("success",null,p.success.reparent)}),(function(i){e.unmask(o.collectionView.getContent()),t.displayError(i,null,null,p.error.reparent_failed)}))}))}}})),define("DS/ENOXArchitectureCommon/components/ContentListView/contentlistview.contextualmenu",["DS/ENOXArchitectureCommon/components/ContentListView/ContextualMenu/contextualmenu.factory","DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/config.util"],(function(e,t,i){"use strict";var n=i.getFullConfig().identifiers;return{getMenu:function(i,o,r,s){var a=!1,l=!1,c=!1,d=!1,u=!1,p=i.collectionView.treeDocument.getRoots()[0];s=s||[];var m=i.modelInfo;(m&&m.modelVersion&&(m.modelVersion.current===n.state_act_Release||m.modelVersion.current===n.state_act_Obsolete)||p&&t.checkIfMaturityIsReleasedOrObsolete(p.options.maturity))&&(c=!0);var f=i.collectionView.treeDocument.getSelectedNodes();if(1===f.length&&(f[0].options.linkInfo&&(d=!0,u=!0),f[0].options.type!==n.type_act_logref&&"L"!==f[0].options.grid.kindOfRFLP||(l=!0)),f.length>1){for(var g=!1,h=0;h<f.length;h++)f[h].options.grid.kindOfRFLP!==f[0].options.grid.kindOfRFLP&&(a=!0),f[h].options.linkInfo&&(u=!0),g||(f[h].options.linkInfo?d=!0:(g=!0,d=!1));(!a&&f[0].options.type===n.type_act_logref||"L"===f[0].options.grid.kindOfRFLP)&&(l=!0)}var v=e.createOpenWithMenu(r),y=e.createExpandMenu(i,f),b=e.createCollapseAllMenu(f),C=e.createReserveMenu(i.collectionView,c),I=e.createUnreserveMenu(i.collectionView),S=e.createMoveToMenu(i.collectionView),N=e.createShareMenu(i.collectionView),D=e.createMaturityMenu(i.collectionView),O=e.createRevisionsMenu(i.collectionView),_=e.createDuplicateMenu(i.collectionView),E=e.createCompareMenu(i.collectionView),A=e.createRelationsMenu(f[0]),w=e.createInformationMenu(i.collectionView,f,o);let x={type:"SeparatorItem"},R=[];return d?(v&&s.indexOf("openwith")<0&&R.push(v,x),l&&(s.indexOf("maturity")<0&&R.push(D),s.indexOf("maturity")>0&&R.push(x),s.indexOf("moveto")<0&&R.push(S),s.indexOf("share")<0&&R.push(N),(s.indexOf("moveto")>0||s.indexOf("share")>0)&&R.push(x)),s.indexOf("information")<0&&R.push(w)):(v&&s.indexOf("openwith")<0&&R.push(v,x),a||(u||(s.indexOf("expand")<0&&R.push(y),s.indexOf("collapse")<0&&R.push(b),(s.indexOf("expand")>0||s.indexOf("collapse")>0)&&R.push(x),1==f.length&&(s.indexOf("revisions")<0&&R.push(O),s.indexOf("duplicate")<0&&R.push(_)),s.indexOf("compare")<0&&R.push(E)),s.indexOf("maturity")<0&&R.push(D),(s.indexOf("revisions")>0||s.indexOf("duplicate")>0||s.indexOf("compare")>0||s.indexOf("maturity")>0)&&R.push(x),u||(s.indexOf("reserve")<0&&R.push(C),s.indexOf("unreserve")<0&&R.push(I)),s.indexOf("moveto")<0&&R.push(S),s.indexOf("share")<0&&R.push(N),(s.indexOf("reserve")>0||s.indexOf("unreserve")>0||s.indexOf("moveto")>0||s.indexOf("share")>0)&&R.push(x),1==f.length&&s.indexOf("relations")<0&&R.push(A)),s.indexOf("information")<0&&R.push(w)),R}}})),define("DS/ENOXArchitectureCommon/components/ContentListView/contentlistview",["UWA/Core","DS/ENOXArchitectureCommon/model/TreeDocument","DS/ENOXArchitectureCommon/model/TreeNodeModel","DS/UIKIT/Mask","DS/DataGridView/DataGridView","DS/ENOXArchitectureCommon/components/ContentListView/contentlistview.contextualmenu","DS/ENOXArchitectureCommon/components/ContentListView/contentlistview.columns","DS/ENOXArchitectureCommon/components/ContentListView/decorators/contentlistview.dragdrop","DS/ENOXArchitectureCommon/services/logitem.service","DS/ENOXArchitectureCommon/utils/model.events.util","DS/ENOXArchitectureCommon/components/GenericCommands/command.controller","DS/ENOXArchitectureCommon/services/common.service","DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/utils/common.util","DS/ENOXArchitectureCommon/utils/refresh.util","DS/ENOXArchitectureCommon/utils/gridview.util","DS/ENOXArchitectureCommon/mixins/CATFLBIFilter","DS/PlatformAPI/PlatformAPI","i18n!DS/ENOXArchitectureCommon/assets/nls/ENOXArchitectureCommon"],(function(e,t,i,n,o,r,s,a,l,c,d,u,p,m,f,g,h,v,y){"use strict";var b=p.getFullConfig();return{init:function(i){var n=this;let r=i&&i.configurations?i.configurations:void 0;return n.configurations=r,n.modelEvents=c.createAppEventObject("xarch-dgv-events"),n.contentViewContainer=e.createElement("div",{class:"xarch-common-dgv-container",html:""}),n.contentView=new o({identifier:"ENOXArchitectureCommon_ContentView",height:"inherit",treeDocument:new t({useAsyncPreExpand:!0}),selectionBehavior:{unselectAllOnEmptyArea:!1},showNodeKPIColorFlag:!0,rowDragEnabledFlag:!0,cellDragEnabledFlag:!0,defaultColumnDef:{typeRepresentation:"string",width:"auto"},rowGroupingOptions:{depth:1,hideGroupedColumns:!1},onContextualEvent:n.showContextualMenu.bind(n,r)}),n.contentView.getCellTooltip=n.contentView.getCellDefaultTooltip,r&&r.cell&&r.cell.getCustomCellTooltip&&(n.contentView.getCellTooltip=r.cell.getCustomCellTooltip.bind(n,n.contentView)),n.manageContentViewEvents(),s.getDataGridViewColumns(n.contentView,i).then((function(e){n.contentView.columns=e,a.addDragAndDropBehaviorToContentView.call(n),n.customViewsManager=n.contentView.getCustomViewsManager(),n.customViewsManager.showCustomViewsDialog(),n.customViewsManager._customViewsDialog.visibleFlag=!1,n.contentView.inject(n.contentViewContainer),i.container.appendChild(n.contentViewContainer),n.contentView.addEventListener("click",n.manageClickInGridView.bind(n)),n.contentView.sortModel=[{dataIndex:"tree",sort:"asc"}],v.subscribe("DS/PADUtils/PADCommandProxy/refresh",n.refreshGridViewOnItemUpdate.bind(n)),v.subscribe("Lifecycle.Modification",(function(e){var t=JSON.parse(e);if(t&&t.Refresh&&t.Refresh.created&&t.Refresh.created.length>0){for(var i=[],o=0;o<t.Refresh.created.length;o++)i.push(t.Refresh.created[o].sourceObjectId);n.refreshGridViewOnItemUpdate({data:{authored:{modified:i}}})}}))})),n},showContextualMenu:async function(e,t){let i,n=this,o=e&&e.contextualMenu?e.contextualMenu:void 0,s=o&&o.addAdditionalCommands?o.addAdditionalCommands:void 0,a=o&&o.removeCommands?o.removeCommands:[];if(t.contentListView=n,t.cellInfos){if(t.cellInfos&&-1===t.cellInfos.rowID)return t.collectionView.buildDefaultContextualMenu(t);t.cellInfos.nodeModel.isSelected()||(t.collectionView.treeDocument.unselectAll(),t.cellInfos.nodeModel.select());var l=t.collectionView.treeDocument.getSelectedNodes();return l.length>1?(i=r.getMenu(t,n.modelEvents,null,a),s?await s(i,t):i):1===l.length?await u.getTypeHierarchy(l[0].options.grid.actualType).then((function(e){return m.getOpenWithCompatibleApps(l[0],e).then((function(e){return i=r.getMenu(t,n.modelEvents,e,a),s?s(i,t):i}))})):void 0}},manageContentViewEvents:function(){let e=this;e.modelEvents.subscribe({event:"xarch-dgv-refresh"},(function(t){e.refresh(t),e.contentView.reapplySortModel()})),e.modelEvents.subscribe({event:"xarch-dgv-refresh-nodes"},f.refreshNodeDetails.bind(e)),e.modelEvents.subscribe({event:"xarch-dgv-refresh-instances"},f.refreshInstDetailsonNode.bind(e)),e.modelEvents.subscribe({event:"xarch-dgv-creation-refLinks-success"},f.refreshReferenceLinksOnNodes.bind(e))},manageClickInGridView:function(e,t){if(t&&t.nodeModel&&t.columnID&&!(t.columnID<0)){var i=this.contentView.columns[t.columnID].dataIndex;if("revision"===i){var n=[{physicalid:t.nodeModel.options.physicalid,label:t.nodeModel.options.label,type:t.nodeModel.options.type,displayType:t.nodeModel.options.grid.type,revision:t.nodeModel.options.grid.revision,current:t.nodeModel.options.grid.maturity,icons:t.nodeModel.options.icons}];d.init("HistoryCommand",{attributes:n})}else if("maturity"===i){n=[{physicalid:t.nodeModel.options.physicalid,label:t.nodeModel.options.label}];d.init("MaturityCommand",{attributes:n})}else if("owner"===i){n=[{physicalid:t.nodeModel.options.physicalid,type:t.nodeModel.options.type,label:t.nodeModel.options.label,displayType:t.nodeModel.options.grid.type,revision:t.nodeModel.options.grid.revision,owner:t.nodeModel.options.grid.owner,icons:t.nodeModel.options.icons}];d.init("ChangeOwnerCommand",{attributes:n})}else this.modelEvents.publish({event:"xarch-dgv-column-click",data:{event:e,dataIndex:i,cellInfos:t}})}},refreshGridViewOnItemUpdate:function(t){let i=this,n={},o={};if(t.data.authored){let r=i.contentView.treeDocument.getRoots();i.contentView.treeDocument.getSelectedNodes();if(r&&r.length>0){r[0].options.physicalid;t.data.authored.deleted&&(t.data.authored.deleted.forEach((function(e){i.contentView.treeDocument.getMappedNodesFromId(e).forEach((function(e){e.getParent().removeChild(e)}))})),i.modelEvents.publish({event:"xarch-dgv-PADCmdProxy-refresh",data:{authored:{deleted:t.data.authored.deleted}}})),e.is(t.data.authored,"array")&&t.data.authored.length>0||t.data.authored.modified&&t.data.authored.modified.forEach((function(e){let t=i.contentView.treeDocument.getMappedNodesFromId(e);t&&t.length>0?t.forEach((function(i){n[e]=t})):(t=i.contentView.treeDocument.getRoots()[0].getNodesByRelId(e),t&&t.length>0&&(o[e]=t))}))}Object.keys(n).length>0&&i.modelEvents.publish({event:"xarch-dgv-refresh-nodes",data:{itemIdMap:n,tagAsRecentlyAuthored:!0}}),Object.keys(o).length>0&&i.modelEvents.publish({event:"xarch-dgv-refresh-instances",data:{instIdMap:o,bInstance:!0,bEffectivity:false}})}},refresh:function(e){var t=this;let i,o,r;if(e)i=e.itemId,o=e.configurationFilter,r=e.selectedItemIds;else{if(void 0===t.contentView.treeDocument.getRoots()[0])return void m.alertMessage("error","Please send the root id to be loaded in view");i=t.contentView.treeDocument.getRoots()[0].options.physicalid}n.mask(t.contentView.getContent(),y.message.loading),t.contentView.treeDocument.getXSO().empty(),l.getLogItemWithExpand(i,o).then(t.itemPageRefCallBack.bind(t,r))},itemPageRefCallBack:function(e,t){var i=this;t.options.shouldBeSelected=function(e){return e.options.physicalid&&e.options.physicalid.length>0},i.contentView.treeDocument=t,i.contentView.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),i.configData&&i.contentView.treeDocument.setConfigurationContext(i.configData),n.unmask(i.contentView.getContent()),i.contentView.treeDocument.getXSO().onPostAdd(i._onXSOChanged.bind(i)),i.contentView.treeDocument.getXSO().onPostRemove(i._onXSOChanged.bind(i));var o={revision:{filterId:"stringRegexp"},isLastVersion:{filterId:"set"},instanceName:{filterId:"stringRegexp"},owner:{filterId:"stringRegexp"},modificationDate:{filterId:"stringRegexp"},description:{filterId:"stringRegexp"},type:{filterId:"stringRegexp"},name:{filterId:"stringRegexp"},creationDate:{filterId:"stringRegexp"},architectureNumber:{filterId:"stringRegexp"},instance_description:{filterId:"stringRegexp"}};i.contentView.columns.forEach((function(e){e.isCustomAttribute&&("integer"===e.typeRepresentation?o[e.dataIndex]={filterId:"number"}:o[e.dataIndex]={filterId:"stringRegexp"})})),o.maturity={filterId:"set",filterModel:Object.values(b.MAPPING_MATURITY)},i.contentView.treeDocument.setFilterModel(o),e&&i.selectNodesById(e),g.crRecTimeoutToCheckTreeDocExp(i.contentView.treeDocument,(function(){i.modelEvents.publish({event:"content-list-view-refresh-complete",data:{contentListView:i}})}))},_onXSOChanged:function(){var e,t=this,i=t.contentView.treeDocument.getSelectedNodes();e=m.formObjForEditProp(i),setTimeout((function(){t.modelEvents.publish({event:"selected-item-changed",data:e})}));var n=p.form3DXContent(i);p.setObjectOnCompass(n),p.launchCrossAppSelection(i)},selectNodesById:function(e){var t=this.contentView.treeDocument.getRoots()[0];e.forEach((function(e){e===t.options.physicalid?t.select():t.getNodesById(e).length>0&&t.getNodesById(e)[0].select()}))},addBiFilterEventOnGridview:function(e){e&&this.contentView.treeDocument&&h.addEventsOnBiFilter(e,this.contentView.treeDocument)}}})),define("DS/ENOXArchitectureCommon/ENOXArchitectureCommon",["UWA/Core","UWA/Class/Promise","DS/ENOXArchitectureCommon/services/config.service","DS/ENOXArchitectureCommon/utils/model.events.util","DS/ENOXArchitectureCommon/utils/config.util","DS/ENOXArchitectureCommon/components/ContentListView/contentlistview","css!DS/ENOXArchitectureCommon/ENOXArchitectureCommon"],(function(e,t,i,n,o,r){"use strict";return{initialize:function(){n.clearSubscriptionList();n.createAppEventObject("xarch-common-events");return o.getPlatformServices().then((()=>{let e=[i.extendConfiguration(o.getFullConfig()),o.retrieveCSRFToken(),o.retrieveCurrentUser()];return t.all(e).then((()=>{o.refreshCSRFToken()}))}))},initializeContentListView:function(e){return o.getFullConfig().appConfigurations=e.configurations,r.init(e)}}}));