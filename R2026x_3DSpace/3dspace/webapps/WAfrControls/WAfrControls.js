define("DS/WAfrControls/mod_SmallViewportActionBarFlyout",["DS/Core/PointerEvents","DS/Controls/Button"],(function(e,t){"use strict";throw new Error("DS/WAfrControls/mod_SmallViewportActionBarFlyout is deprecated.")})),define("DS/WAfrControls/WAfrContextualBar",["UWA/Core","UWA/Controls/Abstract","DS/CoreEvents/Events","DS/Selection/CSOManager","DS/Controls/Toolbar"],(function(e,t,i,o,n){"use strict";return t.singleton({defaultOptions:{subscribersOptions:[],executionContext:null,viewer:null,uiFrame:null,Xposition:null,Yposition:null,hideWithDistance:!0,Xoffset:45,Yoffset:-45,samePosition:!1,withContextMenu:!1},init:function(t){this._parent(t);var i=this;this.elements.container=new e.Element("div",{class:"wux-afr-contextual-bar"});var o=new e.Element("div",{styles:{width:"32px",height:"32px",backgroundColor:"blue"}}),r=new e.Element("div",{styles:{width:"32px",height:"32px",backgroundColor:"green"}}),s=new e.Element("div",{styles:{width:"32px",height:"32px",backgroundColor:"pink"}}),a=new e.Element("div",{styles:{width:"32px",height:"32px",backgroundColor:"white"}});i._row1=new n({direction:"horizontal"}),i._row1.add("element",{element:o,position:"near"}),i._row2=new n({direction:"horizontal"}),i._row2.add("element",{element:r,position:"near"}),i._row2.add("element",{element:s,position:"near"}),i._row2.add("element",{element:a,position:"near"}),i._row3=new n({direction:"horizontal"}),i._row3.getContent().inject(i.elements.container),i._row2.getContent().inject(i.elements.container),i._row1.getContent().inject(i.elements.container),i._isShown=!1,i._opacityLocalListener=null,i._opacityListener=null},clearRows:function(){return new Promise((e=>{var t=this;t._row1.clear(),t._row2.clear(),t._row3.clear()}))},isShown:function(){return this._isShown},show:function(t){var i=this;if(t&&(i.options=e.extend(e.clone(i.defaultOptions),t)),i._hideForMultiselection)return i.hide(),void(i._clicWhenHideForMultiselection=!0);i.elements.container.setStyles({opacity:1}),this.clearRows();var n={};n.XmousePosition=i.options.Xposition,n.YmousePosition=i.options.Yposition,n.XmousePositionWithDevPxRatio=i.options.Xposition*window.devicePixelRatio,n.YmousePositionWithDevPxRatio=i.options.Yposition*window.devicePixelRatio,
//! IR-1184937-3DEXPERIENCER2024x
//! Contextual bar isn’t displayed at the right location when left panel opened
void 0!==i.options.viewerX&&(n.XmousePosition=i.options.viewerX,n.YmousePosition=i.options.viewerY,n.XmousePositionWithDevPxRatio=i.options.viewerX*window.devicePixelRatio,n.YmousePositionWithDevPxRatio=i.options.viewerY*window.devicePixelRatio),n.withContextMenu=i.options.withContextMenu;var r=i.options.subscribersOptions,s=0,a=o.get();const l=[];for(s=0;s<r.length;s++){var p=i.options.subscribersOptions[s],d=p.onContextualBarReady.call(i,a,n),c=p.executionContext;let e;void 0===c?(c=i.options.executionContext,e=t.uiComponent):e=c.getComponent("Afr_UIComponent");var u=c.getComponent("AFR_HandlerComponent"),h=u._private,v=h._radioHdlrMap,m=h._chkHdlrMap,f=u.getLeafHandlerMaps(),g=f.actionHandlers,b=f.commandHandlers;d&&(void 0!==d.WAfrCtxBarRow1&&l.push(i._fillRow({row:i._row1,model:d.WAfrCtxBarRow1.model,cmdHandlersList:b,radioHandlersList:v,checkHandlersList:m,actionHandlersList:g,uiComponent:e})),void 0!==d.WAfrCtxBarRow2&&l.push(i._fillRow({row:i._row2,model:d.WAfrCtxBarRow2.model,cmdHandlersList:b,radioHandlersList:v,checkHandlersList:m,actionHandlersList:g,uiComponent:e})),void 0!==d.WAfrCtxBarRow3&&l.push(i._fillRow({row:i._row3,model:d.WAfrCtxBarRow3.model,cmdHandlersList:b,radioHandlersList:v,checkHandlersList:m,actionHandlersList:g,uiComponent:e})))}Promise.all(l).then((e=>{let o=!1,n=0,r=e.length;for(;n<r&&(e[n]||!o);)o=o||e[n],n++;if(o){if(i.elements.container.inject(t.uiFrame),!0!==i.options.samePosition){let e=i.getContent().getBoundingClientRect();void 0!==t.rectCtxMenuInfo&&(t.y<=e.height-2*t.Yoffset?(i.options.Yposition=i.options.Yposition+i.options.rectCtxMenuInfo.height-2*i.options.Yoffset+e.height,i.options.y=i.options.y+i.options.rectCtxMenuInfo.height-2*i.options.Yoffset+e.height):t.y>t.rectCtxMenuInfo.y&&(i.options.Yposition=i.options.Yposition-i.options.rectCtxMenuInfo.height+i.options.Yoffset,i.options.y=i.options.y-i.options.rectCtxMenuInfo.height+i.options.Yoffset));var s=0;s=t.uiFrame.getDimensions().outerWidth<i.options.Xposition+e.width+i.options.Xoffset?i.options.Xposition-e.width-i.options.Xoffset:i.options.Xposition+i.options.Xoffset;var a=0;a=i.options.Yposition>e.height-i.options.Yoffset?i.options.Yposition-e.height+i.options.Yoffset:i.options.Yposition-i.options.Yoffset,i.elements.container.setStyles({position:"absolute",top:a,left:s}),void 0!==i.options.rectCtxMenuInfo&&(e=i.getContent().getBoundingClientRect(),i.options.x>i.options.rectCtxMenuInfo.x&&i.options.x<=e.x&&(i.options.x=i.options.x-e.width,i.options.Xposition=i.options.Xposition-e.width,s=t.uiFrame.getDimensions().outerWidth<i.options.Xposition+e.width+i.options.Xoffset?i.options.Xposition-e.width-i.options.Xoffset:i.options.Xposition+i.options.Xoffset,i.elements.container.setStyles({top:a,left:s})))}i._isShown=!0,i._isOnBar=!1,i._setBehaviors()}}))},hide:function(){var e=this;e.elements.container&&e.elements.container.remove(),e._isShown&&i.publish({event:"/WUX/AFR/ctxBarHidden"}),e._isShown=!1,e.clearRows()},_setBehaviors:function(){var e,t,o,n=this;n._opacityLocalListenerEnter&&n.elements.container.removeEventListener("mouseenter",n._opacityLocalListenerEnter),n._opacityLocalListenerEnter=function(e){n._isOnBar=!0},n.elements.container.addEventListener("mouseenter",n._opacityLocalListenerEnter),n._opacityLocalListenerLeave&&n.elements.container.removeEventListener("mouseleave",n._opacityLocalListenerLeave),n._opacityLocalListenerLeave=function(e){n._isOnBar=!1,n.options.Xposition=e.clientX,n.options.Yposition=e.clientY},n.elements.container.addEventListener("mouseleave",n._opacityLocalListenerLeave),n._opacityListener&&document.removeEventListener("mousemove",n._opacityListener),n._opacityListener=function(r){if(void 0===e&&(e=n.elements.container.getDimensions()),void 0===t&&(t=n.elements.container.getBoundingClientRect().left),void 0===o&&(o=n.elements.container.getBoundingClientRect().bottom),n._isShown&&n.options.hideWithDistance){var s,a=0,l={posElement:{x:t,y:o},posMouse:{x:r.clientX,y:r.clientY},dim:{height:e.height,width:e.width}};(s=n._calculateDistanceFromMouse(l))>=0&&s<=50||n._isOnBar?a=1:s>50&&s<200?a=1-s/200:(a=0,n.elements.container.hasClassName("wux-ui-state-active")||n.elements.container.remove(),n._isShown=!1,i.publish({event:"/WUX/AFR/WAfr_hideContextBarEvt"})),n.elements.container.setStyles({opacity:a})}},document.addEventListener("mousemove",n._opacityListener),n._multiselectionStart&&document.removeEventListener("keydown",n._multiselectionStart),n._multiselectionStart=function(e){17===e.keyCode&&n._isShown&&(e.preventDefault(),document.removeEventListener("keydown",n._multiselectionStart),document.addEventListener("keyup",n._multiselectionStop),n.elements.container.setStyles({opacity:0}),n._isShown=!1,n._hideForMultiselection=!0,n._clicWhenHideForMultiselection=!1)},document.addEventListener("keydown",n._multiselectionStart),n._multiselectionStop&&document.removeEventListener("keyup",n._multiselectionStop),n._multiselectionStop=function(e){if(17===e.keyCode&&!n._isShown&&n._hideForMultiselection)if(e.preventDefault(),document.addEventListener("keydown",n._multiselectionStart),document.removeEventListener("keyup",n._multiselectionStop),n._hideForMultiselection=!1,n._clicWhenHideForMultiselection)n.show(n.options);else{if(n.elements.container.setStyles({opacity:1}),n.options.withContextMenu){n.elements.container.setStyles({top:n.options.Yposition-n.elements.container.getDimensions().outerHeight-45,left:n.options.Xposition+45});var t=n.options.context;void 0===t&&n.options.subscribersOptions.length>=1&&(t=n.options.subscribersOptions[0].context);var i={frameWindow:FrameWindowsManager.getFrameWindow(t),bar:n.elements.container,YmousePosition:n.options.Yposition,XmousePosition:n.options.Xposition};n._adjustPosition(i),n.options.hideWithDistance=!0}n._isShown=!0}},document.addEventListener("keyup",n._multiselectionStop),null!==n.options.eventCallback&&void 0!==n.options.eventCallback&&n.options.eventCallback()},_calculateDistanceFromMouse:function(e){var t=e.posElement,i=e.posMouse,o=e.dim,n=0,r=0;return i.y>=t.y?r=i.y-t.y:i.y<=t.y-o.height&&(r=t.y-o.height-i.y),i.x<=t.x?n=t.x-i.x:i.x>=t.x+o.width&&(n=i.x-(t.x+o.width)),Math.sqrt(n*n+r*r)},_fillRow:function(t){let i=t.row,o=t.model,n=!1,r=Promise.resolve(n);if(void 0!==o&&0!==o.length&&void 0!==i){let s=0,a=t.uiComponent;if(void 0===a)return!1;for(s=0;s<o.length;s++){let l,p=o[s];if("handler"===p.type){if(l=void 0!==t.cmdHandlersList[p.identifier]||void 0!==t.actionHandlersList[p.identifier]?a.createDefaultHandlerRepresentation({id:p.identifier,handlerTrigger:"AfrContextBar"}):void 0!==t.radioHandlersList[p.identifier]?a.createRadioHandlerRepresentation({id:p.identifier,handlerTrigger:"AfrContextBar"}):a.createCheckHandlerRepresentation({id:p.identifier,handlerTrigger:"AfrContextBar"}),void 0!==l){n=!0;let t=new e.Element("div",{});t.style.display="inline-block",t.style.verticalAlign="middle",s>0&&(t.style.marginLeft="4px"),r=l.then((function(e){void 0!==e&&t.addContent(e),i.add("element",{element:t,position:"near"})}),(e=>{if("Impossible to generate the view for"!==e.message)throw new Error(e)})).then((()=>Promise.resolve(n)))}}else"group"===p.type||p.type}}return r}})})),define("DS/WAfrControls/WAfrContextualMenu",["UWA/Controls/Abstract","DS/Menu/Menu","DS/WAfrHandlers/mod_HandlerComponent","DS/WAfrTweakers/TweakerUtilities","DS/WAfrUtils/mod_Performances"],(function(e,t,i,o,n){"use strict";return e.singleton({init:function(e){this._parent(e);this._factory={WAfrDefaultHandlerItem:"_createHandlerModel",WAfrCheckHandlerItem:"_createCheckHandlerModel",WAfrRadioHandlerItem:"_createRadioHandlerModel"}},show:function(e){let t=this._buildMenuContent(e);return{ctxMenuDimPos:this._display(t,e),menuContent:t}},hide:function(){t.hide()},_display:function(e,i){let o;if(e.length>0){let n={position:{x:i.x,y:i.y}};o=t.show(e,n)}return o},_createHandlerModel:function(e,t){if("string"!=typeof e)throw new TypeError("i_handlerId should be of type string.");if(""===e)throw new TypeError("i_handlerId should not be an empty string.");if(null==t)throw new TypeError("i_handlerCpt can't be undefined or null.");if("object"!=typeof t)throw new TypeError("i_handlerCpt must be of type Object");let i={type:"PushItem"},n=t.getLeafHandlerMaps();if(null==n)throw new Error("Can't find the leaf handlers map.");let r=n.actionHandlers;if(null==r)throw new Error("Can't find the action handlers map.");let s,a=n.commandHandlers;if(null==a)throw new Error("Can't find the command handlers map.");if(void 0!==r[e]?s=r[e]:void 0!==a[e]&&(s=a[e]),void 0===s)throw new Error("The handler "+e+" can't be found either in action or command handlers.");return i.title=s.getI18n().title,i.icon=o.computeIconPath({value:s.getIcon().uri}),i.tooltip=s.getI18n().shortHelp,!1===s.isExecutable()&&(i.state="disabled"),i.action={callback:function(){t.executeHandler({id:e,args:{handlerTrigger:t._private._handlerTrigger}})}},i},_createCheckOrRadioHandlerModel_internal:function(e,t){let i={type:"CheckItem"},n=!0===e.getState()?e.getCheckHandler():e.getUncheckHandler();n||(n=!0===e.getState()?e.getUncheckHandler():e.getCheckHandler()),i.title=n.getI18n().title,i.icon=o.computeIconPath({value:n.getIcon().uri}),i.tooltip=n.getI18n().shortHelp;let r=[];return!0===e.getState()&&r.push("selected"),!1===e.isExecutable()&&r.push("disabled"),r.length>0&&(i.state=r.join("|")),i},_createCheckHandlerModel:function(e,t){if("string"!=typeof e)throw new TypeError("i_handlerId should be of type string.");if(""===e)throw new TypeError("i_handlerId should not be an empty string.");if(null==t)throw new TypeError("i_handlerCpt can't be undefined or null.");if("object"!=typeof t)throw new TypeError("i_handlerCpt must be of type Object");if(!t.hasOwnProperty("_private"))throw new TypeError("i_handlerCpt should have an attribute called _private");let i,o=t.getCheckHandlerMap();if(void 0!==o[e]&&(i=o[e]),void 0===i)throw new Error("The handler "+e+" can't be found in check handlers.");let n=this._createCheckOrRadioHandlerModel_internal(i,t);return n.action={callback:function(){t.toggleCheck({id:e})}},n},_createRadioItemModel:function(e,t,i,o,n){if("string"!=typeof e)throw new TypeError("i_handlerId should be of type string.");if(""===e)throw new TypeError("i_handlerId should not be an empty string.");if(null==i)throw new TypeError("i_handlerCpt can't be undefined or null.");if("object"!=typeof i)throw new TypeError("i_handlerCpt must be of type Object");if(!i.hasOwnProperty("_private"))throw new TypeError("i_handlerCpt should have an attribute called _private");if("string"!=typeof o)throw new TypeError("i_radioGroupId should be of type string.");if(""===o)throw new TypeError("i_radioGroupId should not be an empty string.");let r=this._createCheckOrRadioHandlerModel_internal(t,i);return n||(r.action={callback:function(){i.toggleRadioItemState({radioId:o,id:e})}}),r},_createRadioHandlerModel:function(e,t){if("string"!=typeof e)throw new TypeError("i_handlerId should be of type string.");if(""===e)throw new TypeError("i_handlerId should not be an empty string.");if(null==t)throw new TypeError("i_handlerCpt can't be undefined or null.");if("object"!=typeof t)throw new TypeError("i_handlerCpt must be of type Object");if(!t.hasOwnProperty("_private"))throw new TypeError("i_handlerCpt should have an attribute called _private");if("object"!=typeof t._private)throw new TypeError("i_handlerCpt._private should be of type Object");if(!t._private.hasOwnProperty("_radioHdlrMap"))throw new TypeError("i_handlerCpt._private should have an attribute called _radioHdlrMap");if("object"!=typeof t._private._radioHdlrMap)throw new TypeError("i_handlerCpt._private._radioHdlrMap should be of type Object");let i,n=t.getRadioHandlerMap();if(void 0!==n[e]&&(i=n[e]),void 0===i)throw new Error("The handler "+e+" can't be found in radio handlers.");let r={};if(!1!==i.isUnselectAuthorized())throw new TypeError("RadioHandler of type ZERO not yet supported in contextual menu.");{let n=i.getElements(),s=0,a=[];for(s=0;s<n.length;s++){let o=n[s],r=this._createRadioItemModel(o.getId(),o,t,e,o.getId()===i.getSelectedItemId());a.push(r)}let l=i.getSelectedItem(),p=!0===l.getState()?l.getCheckHandler():l.getUncheckHandler(),d=p.isExecutable()?"enabled":"disabled";r={type:"PushItem",title:p.getI18n().title,icon:o.computeIconPath({value:p.getIcon().uri}),state:d,submenu:a,action:{callback:function(){}}}}return r},_createContextMenuItem:function(e,t){if(null==e)throw new TypeError("i_customerMenuItem can't be undefined or null.");if("object"!=typeof e)throw new TypeError("i_customerMenuItem must be of type Object");if(!e.hasOwnProperty("type"))throw new TypeError("i_customerMenuItem should have an attribute called type");let i;if(this._factory.hasOwnProperty(e.type)){if(!e.hasOwnProperty("handlerId"))throw new TypeError("i_customerMenuItem should have an attribute called handlerId");let o=this._factory[e.type];t._private._handlerTrigger="AfrContextualMenu",i=this[o](e.handlerId,t)}else if(i=e,e.hasOwnProperty("submenu")){let o=[],n=0;for(n=0;n<e.submenu.length;n++){let i=this._createContextMenuItem(e.submenu[n],t);o=o.concat(i)}i.submenu=o}return i},_convertToMenuOptions:function(e,t){if(null==e)throw new TypeError("i_clientData can't be undefined or null.");if(!Array.isArray(e))throw new TypeError("i_clientData should be of type Array.");let i=0,o=[];for(i=0;i<e.length;i++){let n=e[i],r=this._createContextMenuItem(n,t);o.push(r)}return o},_buildMenuContent:function(e){if(null==e)throw new TypeError("i_contextMenuData can't be undefined or null.");if("object"!=typeof e)throw new TypeError("i_contextMenuData should be of type object.");if(!e.hasOwnProperty("executionContext"))throw new TypeError("i_contextMenuData should have a property called executionContext.");if("object"!=typeof e.executionContext)throw new TypeError("i_contextMenuData should have a property called executionContext of type object.");if(!e.hasOwnProperty("subscribersOptions"))throw new TypeError("i_contextMenuData should have a property called subscribersOptions.");if(!Array.isArray(e.subscribersOptions))throw new TypeError("i_contextMenuData should have a property called subscribersOptions of type Array.");let t=[];if(e.subscribersOptions.length>0){let o=e.executionContext.getComponent(i.DEFAULT_COMPONENT_NAME);if(null==o)throw Error("Can't get the Handler Component from the given execution context.");let r=0,s=new n.Performances,a={};for(a.XmousePosition=e.Xposition,a.YmousePosition=e.Yposition,a.XmousePositionWithDevPxRatio=e.Xposition*window.devicePixelRatio,a.YmousePositionWithDevPxRatio=e.Yposition*window.devicePixelRatio,
//! IR-1184944-3DEXPERIENCER2024x
//! Context menu isn’t open at all when left side panel is open
void 0!==e.viewerX&&(a.XmousePosition=e.viewerX,a.YmousePosition=e.viewerY,a.XmousePositionWithDevPxRatio=e.viewerX*window.devicePixelRatio,a.YmousePositionWithDevPxRatio=e.viewerY*window.devicePixelRatio),r=0;r<e.subscribersOptions.length;r++){let i=e.subscribersOptions[r],n=s.start("Actor "+i.subscriberId),l=i.onContextualMenuReady.call(this,a);s.stop(n),null!==l&&(t=t.concat(this._convertToMenuOptions(l,o)))}}return t}})})),define("DS/WAfrControls/TaskProgressBar",["DS/Controls/Abstract","DS/Controls/Button","DS/Controls/ProgressBar","DS/Core/TooltipModel","i18n!DS/WAfrControls/assets/nls/controls","css!DS/UIKIT/UIKIT.css","css!DS/WAfrUI/wafr.css"],(function(e,t,i,o,n){"use strict";function r(e,t){let i=0,o=t-1;for(let t=0;t<o;++t)i+=e[t].weight;return i}return e.inherit({name:"taskProgressBar",publishedProperties:{value:{defaultValue:1,type:"number"},steps:{defaultValue:null,type:"array"},title:{defaultValue:null,type:"string"},simulateProgressInStep:{defaultValue:!1,type:"boolean"},fullBarForEachStep:{defaultValue:!1,type:"boolean"},closeButtonTooltipText:{defaultValue:null,type:"string"},hasCloseButton:{defaultValue:!1,type:"boolean"},modelEventsComponent:{defaultValue:null,type:"object"}},_taskProgressBarClass:"wafr-controls-taskprogressbar",_preBuildView(e){let s="string"==typeof e.title?e.title:"",a=this.elements,l=e.steps;if(!e.fullBarForEachStep){if(100!==l.reduce(((e,t)=>isNaN(e)?e.weight+t.weight:e+t.weight)))throw new Error("DS/WAfrControls/TaskProgressBar - items' weight sum must be equal to 100")}let p=e.value;p||(p=this.publishedProperties.value.defaultValue);let d=document.createElement("div");d.classList.add(this._taskProgressBarClass);var c;d.innerHTML=`\n                    <div class='wafr-controls-taskprogressbar-titlewrapper'>${c=s,c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}</div>\n                    <div class='wafr-controls-taskprogressbar-progressbarwrapper'></div>\n                    <div class='wafr-controls-taskprogressbar-stepcounterwrapper'>${p} / ${l.length}</div>\n                    <div class='wafr-controls-taskprogressbar-steplabelwrapper'>${l[p-1].text}</div>\n                `,a.container=d,a._titleWrapper=d.getElementsByClassName("wafr-controls-taskprogressbar-titlewrapper")[0],s||(a._titleWrapper.style.display="none"),a._progressBarWrapper=d.getElementsByClassName("wafr-controls-taskprogressbar-progressbarwrapper")[0],a._stepCounterWrapper=d.getElementsByClassName("wafr-controls-taskprogressbar-stepcounterwrapper")[0],a._stepLabelWrapper=d.getElementsByClassName("wafr-controls-taskprogressbar-steplabelwrapper")[0];let u=new i({value:e.fullBarForEachStep?0:r(l,p),statusFlag:!1});if(a._progressBar=u,a._progressBarWrapper.appendChild(u.getContent()),e.hasCloseButton){let i=new t({displayStyle:"lite",icon:{iconName:"close",fontIconFamily:WUXManagedFontIcons.Font3DS}}),r=e.modelEventsComponent;r&&"function"==typeof r.publish&&i.getContent().addEventListener("buttonclick",function(e){let t={currentStep:this.value,totalStepCount:this.steps.length,startTime:this._progressStartTime,closeTime:Date.now(),barProgressRate:this.elements._progressBar.value};r.publish({event:"EVT_TaskProgressBarCloseButtonClick",data:t})}.bind(this));let s=n.get("NLS_TaskProgressBarCloseButtonDefaultTooltip");"string"==typeof e.closeButtonTooltipText&&(s=e.closeButtonTooltipText),i.tooltipInfos=new o({shortHelp:s}),a._closeButton=i,a._progressBarWrapper.appendChild(i.getContent())}this._progressStartTime=Date.now(),this._updateBarProgress(l,p,e.simulateProgressInStep,e.fullBarForEachStep)},_applyValue:function(e){let t=this.steps,i=this.value,o=t.length,n=this.elements,r=this.title;i>o||i<=0?(this.value=e,console.error(`DS/WAfrControls/TaskProgressBar - value must be in the range [1-${o}]`)):this._completeStep(e).then(function(e){n._stepCounterWrapper.textContent=`${i} / ${o}`,n._stepLabelWrapper.textContent=`${t[i-1].text}`,n._titleWrapper.textContent=`${r}`,this._updateBarProgress(t,i,this.simulateProgressInStep,this.fullBarForEachStep)}.bind(this))},_updateBarProgress:function(e,t,i,o){(async function(){const n=o?0:r(e,t);if(this.elements._progressBar.value=n,i){const i=300,r=e[t-1];let s=81;if(r){let e=r.estimatedTime;!isNaN(e)&&e>=0&&(s=e/i)}let a=1-Math.pow(.1,1/s),l=0,p=0;const d=(o?100:r.weight)-1,c=function(e){return new Promise(function(t){this._barRefreshTimeout=setTimeout(t,e)}.bind(this))}.bind(this);for(await c(i);p<s&&!this._skipCurrentStep;++p)l+=(1-l)*a,this.elements._progressBar.value=n+l*d,await c(i);for(;!this._skipCurrentStep;++p)a=1-1/(1+a),l+=(1-l)*a,this.elements._progressBar.value=n+l*d,await c(i)}}).call(this)},_completeStep:function(e){if(clearTimeout(this._barRefreshTimeout),this._skipCurrentStep=!0,this.modelEventsComponent){let t={currentStep:e,totalStepCount:this.steps.length,startTime:this._progressStartTime,lastStepChangeTime:Date.now()};this.modelEventsComponent.publish({event:"EVT_TaskProgressBarCompleteStep",data:t})}return delete this._completedStepPromise,this._completedStepPromise=new Promise(function(t){this.elements._progressBar.value=this.fullBarForEachStep?100:r(this.steps,e)+this.steps[e-1].weight,this._skipCurrentStep=!1,this._barRefreshTimeout=setTimeout((()=>t()),300)}.bind(this)),this._completedStepPromise},handleEvents:function(){},complete:function(){return this._completeStep(this.steps.length)}})})),define("DS/WAfrControls/WAfrUIControl",["css!DS/WAfrControls/wafruicontrols.css"],(function(){"use strict";const e="wafr-ui-control-hidden",t="wafr-ui-control-enable",i="wafr-ui-control-touch";function o(e){let t=this.callback;if(!this.control.disableFlag)return t(e)}class n{constructor(e){if(this.constructor===n)throw new TypeError('Abstract class "WAfrUIControl" cannot be instantiated directly.');this._private=Object.create(null),this._initialize(e),this._buildView(e),this._configureEvents(e)}getSupportedEvents(){return[]}isSupportedEvent(e){return this.getSupportedEvents().includes(e)}addListener(e,t){if(!this.isSupportedEvent(e))throw new Error(`${e} is not a supported type.`);let i=this._private.eventSubscriptions,n=this.getDom();if(!n)throw new Error('No HTMLElement associated to this "WAfrUIControl". Cannot add a listener.');let r=o.bind({callback:t,control:this});i.push({dom:n,type:e,callback:t,callbackWrapper:r}),n.addEventListener(e,r)}_addListener(e,t,i){let n=this._private.eventSubscriptions,r=o.bind({callback:i,control:this});n.push({dom:e,type:t,callback:i,callbackWrapper:r}),e.addEventListener(t,i)}removeListener(e,t){if(!this.isSupportedEvent(e))throw new Error(`${e} is not a supported type.`);let i=this._private.eventSubscriptions,o=i.length,n=this.getDom();if(!n)throw new Error('No HTMLElement associated to this "WAfrUIControl". Cannot remove the listener.');let r=0,s=null,a=!1;for(;!a&&r<o;)s=i[r],s.callback===t&&s.type===e&&s.dom===n&&(s.dom.removeEventListener(s.type,s.callbackWrapper),i.splice(r,1),a=!0),++r}_removeListener(e,t,i){let o=this._private.eventSubscriptions,n=o.length,r=0,s=null,a=!1;for(;!a&&r<n;)s=o[r],s.callback===i&&s.type===t&&s.dom===e&&(s.dom.removeEventListener(s.type,s.callbackWrapper),o.splice(r,1),a=!0),++r}set visibleFlag(t){if("boolean"!=typeof t)throw new TypeError("visibleFlag must be a boolean.");let i=this.getDom();if(!i)throw new Error('No HTMLElement associated to this "WAfrUIControl". Cannot set the visibleFlag');t?i.classList.remove(e):i.classList.add(e),this._private.visibleFlag=t}get visibleFlag(){return this._private.visibleFlag}show(){this.visibleFlag=!0}hide(){this.visibleFlag=!1}set disableFlag(e){if("boolean"!=typeof e)throw new TypeError("disableFlag must be a boolean.");let i=this.getDom();if(!i)throw new Error('No HTMLElement associated to this "WAfrUIControl". Cannot set the disableFlag');e?i.classList.remove(t):i.classList.add(t),this._private.disableFlag=e}get disableFlag(){return this._private.disableFlag}enable(){this.disableFlag=!1}disable(){this.disableFlag=!0}set touchFlag(e){if("boolean"!=typeof e)throw new TypeError("touchFlag must be a boolean.");let t=this.getDom();if(!t)throw new Error('No HTMLElement associated to this "WAfrUIControl". Cannot set the touchFlag');e?t.classList.add(i):t.classList.remove(i),this._private.touchFlag=e}get touchFlag(){let e=this._private.touchFlag;return e}_initialize(e){this._private.visibleFlag=!e||(void 0===e.visibleFlag||e.visibleFlag),this._private.disableFlag=!!e&&(void 0!==e.disableFlag&&e.disableFlag),this._private.touchFlag=e&&void 0!==e.touchFlag?e.touchFlag:void 0}_buildView(){let o=document.createElement("div");o.classList.add("wafr-ui-control"),this.visibleFlag||o.classList.add(e),this.disableFlag||o.classList.add(t),this.touchFlag&&o.classList.add(i),this._private.dom=o}getDom(){return this._private.dom}_configureEvents(){this._private.eventSubscriptions=[]}clean(){let e=this._private.eventSubscriptions;for(let t of e)t.dom.removeEventListener(t.type,t.callback);let t=this._private.dom;t.parentNode&&t.parentNode.removeChild(t)}destroy(){this.clean(),delete this._private.eventSubscriptions,delete this._private.dom,delete this._private.visibleFlag,delete this._private.disableFlag,delete this._private.touchFlag,delete this._private}}return n})),define("DS/WAfrControls/WAfrFlyout",["UWA/Core","UWA/Event","DS/Controls/Abstract","DS/Controls/Button","DS/WebappsUtils/WebappsUtils","DS/Controls/Popup","text!DS/WAfrTweakers/assets/WAfrTypeRepresentations.json","text!DS/WAfrTweakers/assets/WAfrTypeTemplates.json","DS/Tweakers/TypeRepresentationFactory","DS/Utilities/Dom","DS/Core/TooltipModel"],(function(e,t,i,o,n,r,s,a,l,p,d){"use strict";var c=i.inherit({name:"wafrflyout",publishedProperties:{actionOnClickFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},currentValue:{defaultValue:void 0,type:"object",category:"Appearance",advancedSetter:!0},elementsList:{defaultValue:[],type:"array",category:"Model"},modifiablePresenterFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},orientation:{defaultValue:"top",type:"string",category:"Behavior"},popupVisibleFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},selfManagedPresenter:{defaultValue:!0,type:"boolean",category:"Behavior"},showLabelFlag:{defaultValue:!1,type:"boolean"}},addElement:function(e){var t=this,i=e.element;void 0!==t.elementsList&&t.elementsList.push(i),t._updatePopupContentView()},addElements:function(e){var t=this,i=e.elementsList;void 0!==t.elementsList&&void 0!==i&&i.forEach((function(e){t.elementsList.push(e)})),t._updatePopupContentView()},buildView:function(){this._parent(),this.elements.container.addClassName("wafr-dropdown-container"),void 0===this._typeRepFactory&&(this._typeRepFactory=new l,this._typeRepFactory.registerTypeRepresentations(s),this._typeRepFactory.registerTypeTemplates(a))},getElement:function(e){var t,i=e.identifier;return this.elementsList.forEach((function(e){e.identifier===i&&(t=e)})),t},getElementsList:function(){return this.elementsList},handleEvents:function(){var e=this;void 0!==e.elements.arrowButton&&e.elements.arrowButton.addEventListener("click",(function(t){t.stopPropagation(),!0!==e.disabled&&e.togglePopup()})),void 0!==e.elements.dropDownPopup&&e.elements.dropDownPopup.addEventListener("change",(function(t){if(!0===e.selfManagedPresenter){var i,o=t.dsModel;e.elementsList.forEach((function(e){o===e.view&&(i=e)})),void 0!==i&&(e.currentValue=i)}e.hidePopup()})),void 0!==e.elements.presenterButton&&e.elements.presenterButton.addEventListener("click",(function(t){if(!1===e.actionOnClickFlag&&(t.stopPropagation(),!0!==e.disabled&&e.togglePopup()),!0===e.actionOnClickFlag&&"check"===e.elements.presenterButton.type&&void 0!==e.currentValue&&!0!==e.disabled){var i=void 0!==e.currentValue.identifier?e.currentValue:e.getElement({identifier:e.currentValue}),o=void 0!==e.currentValuePresenterLink?e.currentValuePresenterLink:i.presenterLink;(void 0!==i.tweakerType?i.view.elements.internalView:i.view)[o.checkFlag]=e.elements.presenterButton.checkFlag}e.fire("presenterClick")}))},hidePopup:function(){var e=this;!0===e.popupVisibleFlag&&(e.popupVisibleFlag=!1,void 0!==e.elements.dropDownPopup&&(e.elements.dropDownPopup.hide(),e._updateDocumentEvents()),e._updateTriggerButton())},showPopup:function(){var e=this;!1===e.popupVisibleFlag&&(e.popupVisibleFlag=!0,void 0!==e.elements.dropDownPopup&&(e.elements.dropDownPopup.show(),e._updateDocumentEvents()),e._updateTriggerButton())},togglePopup:function(){!0===this.popupVisibleFlag?this.hidePopup():this.showPopup()},setPresenterRessources:function(e){var t=this;!1===t.modifiablePresenterFlag&&void 0!==e&&void 0!==t.elements&&void 0!==t.elements.presenterButton&&(void 0!==e.title&&(t.elements.presenterButton.label=e.title,t.elements.presenterButton.showLabelFlag=t.touchMode),void 0!==e.tootlipInfos&&(t.elements.presenterButton.tootlipInfos=e.tootlipInfos),void 0!==e.icon&&(t.elements.presenterButton.icon=e.icon))},_applyTouchMode:function(){var e=this;if(e._parent(),void 0!==e.elements.presenterButton&&(e.elements.presenterButton.touchMode=e.touchMode,e.elements.presenterButton&&void 0!==e.currentValue&&!1!==e.modifiablePresenterFlag&&!0===e.touchMode)){var t=e.currentValue;if(void 0===t)return;var i=void 0!==e.currentValuePresenterLink?e.currentValuePresenterLink:t.presenterLink,o=void 0!==t.tweakerType?t.view.elements.internalView:t.view;void 0!==i.title&&(e.elements.presenterButton.label=" ",e.showLabelFlag?(e.elements.presenterButton.label=p.createEllipsisText({label:o[i.title],nbLinesVisible:2,maxWidth:"67px",lineHeight:14,allowUnsafeHTMLLabel:!1}),e.elements.presenterButton.elements.text.setContent(e.elements.presenterButton.label)):e.elements.presenterButton.label=o[i.title])}void 0!==e.elements.arrowButton&&(e.elements.arrowButton.touchMode=e.touchMode)},_applyShowLabelFlag:function(){var e=this;if(e._parent(),void 0!==e.elements.presenterButton&&(e.elements.presenterButton.showLabelFlag=e.showLabelFlag,e.elements.presenterButton&&void 0!==e.currentValue&&!1!==e.modifiablePresenterFlag&&!0===e.showLabelFlag)){var t=e.currentValue;if(void 0===t)return;var i=void 0!==e.currentValuePresenterLink?e.currentValuePresenterLink:t.presenterLink,o=void 0!==t.tweakerType?t.view.elements.internalView:t.view;void 0!==i.title&&(e.elements.presenterButton.label=" ",e.elements.presenterButton.label=p.createEllipsisText({label:o[i.title],nbLinesVisible:2,maxWidth:"67px",lineHeight:14,allowUnsafeHTMLLabel:!1}),e.elements.presenterButton.elements.text.setContent(e.elements.presenterButton.label))}void 0!==e.elements.arrowButton&&(e.elements.arrowButton.showLabelFlag=e.showLabelFlag,!0===e.showLabelFlag?e.elements.arrowButton.elements.container.setAttributeNode(document.createAttribute("showlabel")):e.elements.arrowButton.elements.container.removeAttribute("showlabel"))},_applyActionOnClickFlag:function(){var e=this;void 0===e.elements.presenterButton&&(this.actionOnClickFlag?e._buildSplitFlyout():e._buildUnifiedFlyout())},_applyOrientation:function(){var e=this;if(void 0!==e.elements&&void 0!==e.elements.arrowButton){if(e.elements.arrowButton){var t=n.getWebappsBaseUrl();"top"===e.orientation?(t+="WAfrControls/assets/icons/arrow-t.png",e.elements.arrowButton.icon=t):"bottom"===e.orientation&&(t+="WAfrControls/assets/icons/arrow-b.png",e.elements.arrowButton.icon=t)}e.elements.dropDownPopup&&(e.elements.dropDownPopup.orientation=e.orientation,"top"===e.orientation?e.elements.dropDownPopup.offset={x:0,y:-4}:"bottom"===e.orientation&&(e.elements.dropDownPopup.offset={x:0,y:4}))}},_applyPopupVisibleFlag:function(){this.popupVisibleFlag?this.showPopup():this.hidePopup()},_applyProperties:function(e){this._parent(e),this.isDirty("orientation")&&this._applyOrientation(),this.isDirty("actionOnClickFlag")&&this._applyActionOnClickFlag(),this.isDirty("popupVisibleFlag")&&this._applyPopupVisibleFlag()},_buildPopup:function(){var e=this,t={target:e.elements.container,position:e.orientation,offset:"top"===e.orientation?{x:0,y:-4}:{x:0,y:4},alignment:"left",constraint:"screen",visibleFlag:!1,overlap:!1,arrowBoxFlag:!1,trigger:"",autoHide:!0};e.elements.dropDownPopup=new r(t),e.elements.dropDownPopup.getContent().addClassName("WAfrPageObjectUseOnly-WAfr-dropdown-popup")},_buildSplitFlyout:function(){var e=this;this.elements.presenterButton=new o({touchMode:e.touchMode,displayStyle:"icon",showLabelFlag:e.showLabelFlag}),this.elements.presenterButton.inject(this.elements.container),this.elements.presenterButton.getContent().addClassName("wafr-dropdown-presenterButtonSplit");var t=n.getWebappsBaseUrl();"top"===e.orientation?t+="WAfrControls/assets/icons/arrow-t.png":"bottom"===e.orientation&&(t+="WAfrControls/assets/icons/arrow-b.png"),this.elements.arrowButton=new o({touchMode:e.touchMode,preferredWidth:11,minWidth:11,displayStyle:"icon",icon:t}),this.elements.arrowButton.inject(this.elements.container),this.elements.arrowButton.getContent().addClassName("wafr-dropdown-arrow")},_buildUnifiedFlyout:function(){this.elements.presenterButton=new o({touchMode:this.touchMode,displayStyle:"icon",showLabelFlag:this.showLabelFlag}),this.elements.presenterButton.inject(this.elements.container)},_postBuildView:function(){this._buildPopup()},_postEditCurrentValue:function(){var e,t,i,o=this;if(void 0===o.currentValue.identifier&&(o.currentValue=o.getElement({identifier:o.currentValue})),this.elements.presenterButton&&void 0!==o.currentValue&&!0===o.modifiablePresenterFlag){var n=o.currentValue;if(void 0===n)return;var r=void 0!==o.currentValuePresenterLink?o.currentValuePresenterLink:n.presenterLink,s=void 0!==n.tweakerType?n.view.elements.internalView:n.view,a=r.type,l=r.icon,c=r.tooltipInfos,u=r.checkFlag,h=r.title;this.elements.presenterButton.type=s[a],this.elements.presenterButton.icon=s[l];var v={position:"top",mouseRelativePosition:!1,allowUnsafeHTMLShortHelp:!0,allowUnsafeHTMLLongHelp:!0};e={source:s.tooltipInfos,target:v},t=e.source,i=e.target,void 0!==t&&void 0!==i&&(void 0!==t.title&&(i.title=t.title),void 0!==t.shortHelp&&(i.shortHelp=t.shortHelp),void 0!==t.longHelp&&(i.longHelp=t.longHelp),void 0!==t.shortHelpImage&&(i.shortHelpImage=t.shortHelpImage),void 0!==t.longHelpImage&&(i.longHelpImage=t.longHelpImage),void 0!==t.shortHelpImageDimension&&(i.shortHelpImageDimension=t.shortHelpImageDimension),void 0!==t.longHelpImageDimension&&(i.longHelpImageDimension=t.longHelpImageDimension),void 0!==t.moreHelpCB&&(i.moreHelpCB=t.moreHelpCB)),this.elements.presenterButton.tooltipInfos=new d(v),s[c]&&(s[c].position="right"),this.elements.presenterButton.checkFlag=s[u],void 0!==h&&(this.elements.presenterButton.label=p.createEllipsisText({label:s[r.title],nbLinesVisible:2,maxWidth:"67px",lineHeight:14,allowUnsafeHTMLLabel:!1}),o.elements.presenterButton.elements.text&&o.elements.presenterButton.elements.text.setContent(o.elements.presenterButton.label))}o.fire("change")},_updateDocumentEvents:function(){var e=this;function t(){e.hidePopup()}!0===e.popupVisibleFlag?document.body.addEventListener("click",t):document.body.removeEventListener("click",t)},_updatePopupContentView:function(){var t=this,i=t.elements.dropDownPopup,o=new e.Element("div",{});t.elementsList.forEach((function(i){var n=new e.Element("div",{});o.addContent(n),n.addContent(i.view),void 0!==t.currentValue&&null!==t.currentValue||(t.currentValue=i)})),i.setBody(o)},_updateTriggerButton:function(){var e=this,t=e.popupVisibleFlag;!1===e.actionOnClickFlag&&void 0!==e.elements.presenterButton&&"check"===e.elements.presenterButton.type?e.elements.presenterButton.checkFlag=t:!0===e.actionOnClickFlag&&void 0!==e.elements.arrowButton&&(e.elements.arrowButton.checkFlag=t)},_applyDisabled:function(){var e=this;this._parent(),void 0!==e.elementsList&&e.elementsList.forEach((function(t){void 0!==t&&void 0!==t.view&&(t.view.disabled=e.disabled)})),void 0!==e.elements&&void 0!==e.elements.presenterButton&&(e.elements.presenterButton.disabled=e.disabled)}});return Object.defineProperty(c.prototype,"label",{get:function(){return this.elements.presenterButton.label},set:function(e){throw new Error("Impossible to set the label from this API")}}),Object.defineProperty(c.prototype,"icon",{get:function(){return this.elements.presenterButton.icon},set:function(e){throw new Error("Impossible to set the icon from this API")}}),c})),define("DS/WAfrControls/WAfrUIExpander",["DS/WAfrControls/WAfrUIControl"],(function(e){"use strict";const t="wafr-ui-control-expander-expanded",i="wafr-ui-control-expander-collapsed",o={horizontal:"wafr-ui-control-expander-horizontal",vertical:"wafr-ui-control-expander-vertical"},n={expanded:"wafr-ui-control-expander-button-expanded",collapsed:"wafr-ui-control-expander-button-collapsed"};function r(e){return Boolean(void 0!==o[e])}return class extends e{constructor(e){super(e)}_initialize(e){if(super._initialize(e),this._private.orientation="horizontal",this._private.expandedFlag=!1,e){if(void 0!==e.orientation&&(this._private.orientation=e.orientation),!r(this._private.orientation))throw new Error(`Unsupported display style ${e.orientation} for "WAfrUIExpander"`);if(void 0!==e.expandedFlag){if("boolean"!=typeof e.expandedFlag)throw new TypeError("expandedFlag must be a boolean.");this._private.expandedFlag=e.expandedFlag}}}_updateButtonStyle(e){let t=this._private.expanderButtonContainer;e?(t.classList.remove(n.collapsed),t.classList.add(n.expanded)):(t.classList.remove(n.expanded),t.classList.add(n.collapsed))}_buildView(e){super._buildView(e);let r=this.getDom();r.classList.add(o[this._private.orientation]);let s=document.createElement("div");r.appendChild(s),this._private.expanderButtonContainer=s,this.expandedFlag?(s.classList.remove(n.collapsed),s.classList.add(n.expanded)):(s.classList.remove(n.expanded),s.classList.add(n.collapsed));let a=document.createElement("div");a.classList.add("wafr-ui-control-expander-item-container"),r.appendChild(a),this._private.itemContainer=a,this.expandedFlag?(r.classList.remove(i),r.classList.add(t),a.style.display="flex"):(r.classList.remove(t),r.classList.add(i),a.style.display="none")}appendContent(e){this._private.itemContainer.appendChild(e)}static addItem(e,t){e.lastChild.appendChild(t)}getSupportedEvents(){let e=super.getSupportedEvents()||[];return e.push("collapse"),e.push("expand"),e}_configureEvents(e){super._configureEvents(e);let t=this.getDom(),i=this._private.expanderButtonContainer;this._privateExpanderClick=()=>{this.expandedFlag=!this.expandedFlag,function(e,t){let i=new CustomEvent(!0===t?"expand":"collapse",{});e.dispatchEvent(i)}(t,this.expandedFlag)},super._addListener(i,"click",this._privateExpanderClick)}get orientation(){return this._private.orientation}set orientation(e){if(!r(e))throw new Error(`Unsupported display style ${e} for "WAfrUIExpander"`);let t=this.getDom();this._private.orientation=e,"horizontal"===e?(t.classList.remove(o.vertical),t.classList.add(o.horizontal)):(t.classList.remove(n.horizontal),t.classList.add(n.vertical))}get expandedFlag(){return this._private.expandedFlag}set expandedFlag(e){this._private.expandedFlag=e,this._updateButtonStyle(e);let o=this._private.itemContainer;!0===this._private.expandedFlag?o.style.display="flex":o.style.display="none";let n=this.getDom();e?(n.classList.remove(i),n.classList.add(t)):(n.classList.remove(t),n.classList.add(i))}expand(){this.expandedFlag=!0}collapse(){this.expandedFlag=!1}destroy(){delete this._private.orientation,delete this._private.expandedFlag,delete this._private.itemContainer,super.destroy()}}})),define("DS/WAfrControls/WAfrUIButton",["DS/WAfrControls/WAfrUIControl"],(function(e){"use strict";const t="wafr-ui-control-button-active",i="wafr-ui-control-button-show-label",o={default:"wafr-ui-control-button-default",dropdown:"wafr-ui-control-button-dropdown"};function n(e){return Boolean(void 0!==o[e])}return class extends e{constructor(e){super(e),e&&e.label&&e.icon&&e.icon.src||console.debug("[DEBUG][WAfrUIButton] An instance was created with at least one parameter set to null (label, icon, icon.src)")}getSupportedEvents(){let e=super.getSupportedEvents()||[];return e.push("click"),e}_initialize(e){super._initialize(e),this._private.checkFlag=!!e&&(void 0!==e.checkFlag&&e.checkFlag),this._private.showLabelFlag=!!e&&(void 0!==e.showLabelFlag&&e.showLabelFlag),this._private.label=e&&void 0!==e.label?e.label:"",this._private.icon=e&&void 0!==e.icon?e.icon:{src:""},this._private.tooltip=e?e.tooltip:void 0;let t=e&&void 0!==e.displayStyle?e.displayStyle:"default";if(!n(t))throw new Error(`Unsupported display style ${t} for "WAfrUIButton"`);this._private.displayStyle=t}_buildView(e){super._buildView(e);let n=this._private.icon.src,r=this._private.icon.srcset,s=this.getDom();s.classList.add("wafr-ui-control-button"),s.classList.add(o[this._private.displayStyle]);let a=document.createDocumentFragment();this.checkFlag&&s.classList.add(t),this.showLabelFlag&&s.classList.add(i);let l=document.createElement("img");l.setAttribute("src",n),r&&l.setAttribute("srcset",r);let p=document.createElement("div");p.classList.add("wafr-ui-control-button-label");let d=this._private.label;this.showLabelFlag&&d&&(p.textContent=d),this._private.labelDomWrapper=p,this._private.imgDom=l,a.appendChild(l),a.appendChild(p),s.appendChild(a),this._private.tooltip&&(s.tooltipInfos=this._private.tooltip)}set checkFlag(e){if("boolean"!=typeof e)throw new TypeError("value must be a boolean");let i=this.getDom();this._private.checkFlag=e,e?i.classList.add(t):i.classList.remove(t)}get checkFlag(){return this._private.checkFlag}set showLabelFlag(e){if("boolean"!=typeof e)throw new TypeError("value must be a boolean");let t=this.getDom();if(this._private.showLabelFlag!==e){this._private.showLabelFlag=e;let o=this._private.labelDomWrapper;""===o.innerHTML&&(o.textContent=this.label),e?t.classList.add(i):t.classList.remove(i)}}get showLabelFlag(){return this._private.showLabelFlag}set label(e){if("string"!=typeof e)throw new TypeError("value must be a string");if(this._private.label!==e){this._private.label=e,this._private.labelDomWrapper.textContent=e}}get label(){return this._private.label}set displayStyle(e){if(!n(e))throw new Error(`Unsupported display style ${e} for "WAfrUIButton"`);let t=this._private.displayStyle;if(t!==e){let i=this.getDom();i.classList.remove(o[t]),i.classList.add(o[e]),this._private.displayStyle=e}}get displayStyle(){return this._private.displayStyle}get icon(){return this._private.icon}set icon(e){if(void 0===e||void 0===e.src)throw new Error("Missing icon src value");e&&e.src||console.debug("[DEBUG][WAfrUIButton] set icon called without icon)");let t=this._private.imgDom,i=e.src,o=e.srcset;t.setAttribute("src",i),o&&t.setAttribute("srcset",o),this._private.icon=e}set tooltip(e){let t=this.getDom();this._private.tooltip=e,t.tooltipInfos=e}get tooltip(){return this._private.tooltip}destroy(){delete this._private.checkFlag,delete this._private.showLabelFlag,delete this._private.label,delete this._private.tooltip,super.destroy()}}})),define("DS/WAfrControls/WAfrUIFlyoutPresenter",["DS/WAfrControls/WAfrUIControl","DS/WAfrControls/WAfrUIButton"],(function(e,t){"use strict";function i(e){let t=e._private.presenterClickCallbacks,i=e._private.expandButtonClickCallbacks;if(e.touchFlag){for(let i of t)e._private.button.removeListener(i.type,i.callback);for(let t of i)e._private.button.removeListener(t.type,t.callback),e._private.button.addListener(t.type,t.callback)}else{for(let i of t)e._private.button.removeListener(i.type,i.callback),e._private.button.addListener(i.type,i.callback);for(let t of i)e._private.button.removeListener(t.type,t.callback)}}return class extends e{constructor(e){super(e)}_initialize(e){super._initialize(e),this._private.presenterClickCallbacks=[],this._private.expandButtonClickCallbacks=[]}getSupportedEvents(){let e=super.getSupportedEvents()||[];return e.push("click"),e.push("expandclick"),e}_buildView(e){super._buildView(e);let i=this.getDom();i.classList.add("wafr-ui-control-flyout-presenter");let o=document.createDocumentFragment(),n=document.createElement("div");n.classList.add("wafr-ui-control-flyout-expand-button","wafr-dropdown-arrow"),o.appendChild(n);let r=new t({label:e&&e.label?e.label:"",icon:e&&e.icon?e.icon:{src:""},showLabelFlag:!(!e||void 0===e.showLabelFlag)&&e.showLabelFlag,displayStyle:"default",tooltip:e&&e.tooltip?e.tooltip:void 0,touchFlag:!(!e||void 0===e.touchFlag)&&e.touchFlag,checkFlag:!(!e||void 0===e.checkFlag)&&e.checkFlag,disableFlag:!(!e||void 0===e.disableFlag)&&e.disableFlag});o.appendChild(r.getDom()),this._private.expandButton=n,this._private.popup=null,i.appendChild(o),this._private.button=r}set showLabelFlag(e){this._private.button&&(this._private.button.showLabelFlag=e)}get showLabelFlag(){return this._private.button.showLabelFlag}set checkFlag(e){this._private.button&&(this._private.button.checkFlag=e)}get checkFlag(){return this._private.button.checkFlag}set label(e){this._private.button&&(this._private.button.label=e)}get label(){return this._private.button.label}set icon(e){this._private.button&&(this._private.button.icon=e)}get icon(){return this._private.button.icon}set disableFlag(e){super.disableFlag=e,this._private.button&&(this._private.button.disableFlag=e)}get disableFlag(){return this._private.disableFlag}set touchFlag(e){e!==super.touchFlag&&(super.touchFlag=e,this._private.button&&(this._private.button.touchFlag=e),i(this))}get touchFlag(){return this._private.touchFlag}set tooltip(e){this._private.button.tooltip=e}get tooltip(){return this._private.button.tooltip}addListener(e,t){if(!this.isSupportedEvent(e))throw new Error(`${e} is not a supported type.`);"click"===e?(this._private.presenterClickCallbacks.push({type:e,callback:t}),this.touchFlag||this._private.button.addListener(e,t),i(this)):"expandclick"===e?(this._private.expandButtonClickCallbacks.push({type:"click",callback:t}),this.touchFlag||this._addListener(this._private.expandButton,"click",t),i(this)):super.addListener(e,t)}removeListener(e,t){if(!this.isSupportedEvent(e))throw new Error(`${e} is not a supported type.`);"click"===e?(this._private.button.removeListener(e,t),this._private.presenterClickCallbacks=this._private.presenterClickCallbacks.filter((i=>i.type!==e&&i.callback!==t))):"expandclick"===e?(this._removeListener(this._private.expandButton,"click",t),this.touchFlag&&this._private.button.removeListener("click",t),this._private.expandButtonClickCallbacks=this._private.expandButtonClickCallbacks.filter((e=>"click"!==e.type&&e.callback!==t))):super.removeListener(e,t)}clean(){super.clean();let e=this._private.presenterClickCallbacks,t=this._private.expandButtonClickCallbacks;e.splice(0,e.length),t.splice(0,t.length)}destroy(){this._private.expandButton;delete this._private.expandButton,super.destroy()}}})),define("DS/WAfrControls/WAfrUIFlyout",["DS/WAfrControls/WAfrUIControl","DS/WAfrControls/WAfrUIButton","DS/WAfrControls/WAfrUIFlyoutPresenter"],(function(e,t,i){"use strict";const o="wafr-ui-control-flyout-show-label";function n(e,t){return function(){!function(e,t){let i=new CustomEvent("change",{detail:{itemClicked:t}});e.dispatchEvent(i)}(e,t)}}function r(e,o){const n=o.itemsConfiguration,r=o.presenterItemId,s=e.getDom(),a=e._private.itemsDomWrapper;let l=document.createDocumentFragment(),p=[],d=null;for(let i of n)i.tooltip&&"right"!==i.tooltip.position&&(i.tooltip.position="right"),d={id:i.id,handlerTrigger:"AfrActionBar",button:new t({label:i.label,icon:i.icon,showLabelFlag:e._private.showItemsLabelFlag,displayStyle:"dropdown",tooltip:i.tooltip,checkFlag:Boolean(i.checkFlag),disableFlag:void 0!==i.disableFlag&&i.disableFlag})},p.push(d),l.appendChild(d.button.getDom());e._private.items=p,a.appendChild(l);let c,u=p.find((e=>e.id===r));if(!u)throw new Error(`Cannot find the item with the id ${r} in ${p}`);u.button.tooltip&&(c=u.button.tooltip.clone(),c.position="top");let h={id:u.id,button:new i({label:u.button.label,icon:u.button.icon,showLabelFlag:e._private.showLabelFlag,displayStyle:"default",tooltip:c,touchFlag:e.touchFlag,checkFlag:Boolean(u.button.checkFlag),disableFlag:u.button.disableFlag})};e._private.presenter=h,e._private.presenterItemId=h.id,s.appendChild(h.button.getDom())}return class extends e{constructor(e){if(!(e&&e.itemsConfiguration&&Array.isArray(e.itemsConfiguration)&&0!==e.itemsConfiguration.length&&e.presenterItemId))throw new Error('Missing "options.itemsConfiguration" parameter');super(e)}getSupportedEvents(){let e=super.getSupportedEvents()||[];return e.push("change"),e}_initialize(e){if(super._initialize(e),this._private.isExpanded=!1,!Array.isArray(e.itemsConfiguration))throw new TypeError("options.itemsConfiguration must be an array");let t=e.itemsConfiguration;for(let e of t)if(!e.id&&!e.label)throw new Error("Missing parameter");this._private.presenterItemId=e.presenterItemId,this._private.showLabelFlag=!!e&&(void 0!==e.showLabelFlag&&e.showLabelFlag),this._private.showItemsLabelFlag=!e||(void 0===e.showItemsLabelFlag||e.showItemsLabelFlag)}_buildView(e){super._buildView(e);let t=this.getDom();t.classList.add("wafr-ui-control-flyout"),this._private.showLabelFlag&&t.classList.add(o);let i=document.createElement("div");i.classList.add("wafr-ui-control-flyout-popup"),i.classList.add("WAfrPageObjectUseOnly-WAfr-dropdown-popup"),this._private.itemsDomWrapper=i,r(this,{itemsConfiguration:e.itemsConfiguration,presenterItemId:this._private.presenterItemId})}_configureEvents(e){super._configureEvents(e);let t=this._private.items,i=this._private.presenter,o=this.getDom(),r=new WeakMap;for(let e=0,i=t.length;e<i;++e){let i=t[e],s=n(o,i.id);r.set(i,s),i.button.addListener("click",s)}let s=n(o,this._private.presenterItemId);r.set(i,s),i.button.addListener("click",s),this._private.onClickCallbackMap=r;this._private.onExpandButtonCallback=e=>{e.stopPropagation();performance.now();if(this._private.isExpanded)this._private.popup.hide(),this._private.isExpanded=!1;else{let e=Promise.resolve();this._private.presenterButtonTooltip=i.button.tooltip,this._private.presenter.button.tooltip=null,this._private.popup||(e=new Promise(((e,t)=>{require(["DS/Controls/Popup"],(t=>{performance.now();const i=new t({target:this.getDom(),trigger:"",usePaddingFlag:!1,position:"top",constraint:"screen"});i.setBody(this._private.itemsDomWrapper),this._private.popup=i;this._private.onDocumentClick=e=>{e.target!==this._private.expandButton&&e.target!==this.getDom()&&(i.hide(),this._private.isExpanded=!1)},this._addListener(document,"click",this._private.onDocumentClick);return this._private.onPopupHide=e=>{this._private.isExpanded=!1,this._private.presenter.button.tooltip||(this._private.presenter.button.tooltip=this._private.presenterButtonTooltip)},this._addListener(i.getContent(),"hide",this._private.onPopupHide),e()}),t)}))),e.then((()=>{this._private.popup.show(),this._private.isExpanded=!0}))}},this._private.presenter.button.addListener("expandclick",this._private.onExpandButtonCallback);this._private.onCollapseButtonCallback=()=>{this._private.popup&&this._private.popup.hide()},this._addListener(this._private.presenter.button.getDom(),"collapse",this._private.onCollapseButtonCallback)}set showItemsLabelFlag(e){if("boolean"!=typeof e)throw new TypeError("value must be a boolean");if(this._private.showItemsLabelFlag!==e){this._private.showItemsLabelFlag=e;let t=this._private.items;for(let i of t)i.button.showLabelFlag=e}}get showItemsLabelFlag(){return this._private.showItemsLabelFlag}set showLabelFlag(e){if(e!==this._private.showLabelFlag){this._private.presenter.button.showLabelFlag=e,this._private.showLabelFlag=e;let t=this.getDom();e?t.classList.add(o):t.classList.remove(o)}}get showLabelFlag(){return this._private.showLabelFlag}set presenterItemId(e){if(this._private.presenterItemId!==e){let t=this._private.items.find((t=>t.id===e));if(!t)throw new Error(`Cannot find the item with the id ${e} in ${this._private.items}`);let i,o=this._private.onClickCallbackMap,r=this._private.presenter,s=this.getDom(),a=o.get(r),l=n(s,t.id),p=r.button;p.removeListener("click",a),o.delete(r),r.id=e,p.icon=t.button.icon,p.label=t.button.label,p.checkFlag=t.button.checkFlag,p.disableFlag=t.button.disableFlag,p.tooltip&&p.tooltip.destroy(),t.button.tooltip&&(i=t.button.tooltip.clone(),i.position="top"),p.tooltip=i,o.set(r,l),p.addListener("click",l),this._private.presenterItemId=e}}get presenterItemId(){return this._private.presenterItemId}set disableFlag(e){super.disableFlag=e;let t=this._private.items,i=this._private.presenter;for(let i of t)i.button.disableFlag=e;i.button.disableFlag=e}get disableFlag(){return super.disableFlag}set touchFlag(e){super.touchFlag!==e&&(super.touchFlag=e,this._private.presenter.button.touchFlag=e)}get touchFlag(){return super.touchFlag}setItemCheckFlag(e,t,i){let o=this._private.items;if(i=i||!1,t&&i)for(let t of o)t.id===e?t.button.checkFlag=!0:t.button.checkFlag=!1;else{o.find((t=>t.id===e)).button.checkFlag=t}this.presenterItemId===e&&(this._private.presenter.button.checkFlag=t)}getItemCheckFlag(e){return this._private.items.find((t=>t.id===e)).button.checkFlag}setItemTooltip(e,t){let i=this._private.items.find((t=>t.id===e));if("right"!==t.position&&(t.position="right"),i.button.tooltip&&i.button.tooltip.destroy(),i.button.tooltip=t,e===this.presenterItemId){let e;t&&(e=t.clone(),e.position="top"),this._private.presenter.button.tooltip&&this._private.presenter.button.tooltip.destroy(),this._private.presenter.button.tooltip=e}}setItems(e,t){const i=this.getDom();let o=this._private.items,s=null,a=this._private.onClickCallbackMap;if(o){for(let e in o)s=o[e],s.button.destroy(),a.delete(s);delete this._private.items}let l=this._private.presenter;if(l&&(a.delete(l),l.button.destroy(),delete this._private.presenter),r(this,{itemsConfiguration:t,presenterItemId:e}),!this._private.presenter||!this._private.items)throw new Error("presenter and items must be created by the createView function");o=this._private.items;for(let e=0,t=o.length;e<t;++e){let t=o[e],r=n(i,t.id);a.set(t,r),t.button.addListener("click",r)}l=this._private.presenter;let p=n(i,this._private.presenterItemId);a.set(l,p),l.button.addListener("click",p),l.button.addListener("expandclick",this._private.onExpandButtonCallback)}setItemConfiguration(e,t){let i=this._private.items.find((t=>t.id===e)).button;const{label:o,icon:n,tooltip:r,checkFlag:s,disableFlag:a}=t;if(void 0!==o&&(i.label=o),void 0!==n&&(i.icon=n),void 0!==s&&(i.checkFlag=s),void 0!==a&&(i.disableFlag=a),void 0!==r){let e;i.tooltip&&i.tooltip.destroy(),r&&(e=r.clone(),e.position="right"),i.tooltip=e}if(e===this.presenterItemId){const e=this._private.presenter.button;if(void 0!==o&&(e.label=o),void 0!==n&&(e.icon=n),void 0!==s&&(e.checkFlag=s),void 0!==a&&(e.disableFlag=a),void 0!==r){let t;e.tooltip&&e.tooltip.destroy(),r&&(t=r.clone(),t.position="top"),e.tooltip=t}}}clean(){super.clean();let e=this._private.onClickCallbackMap,t=this._private.items,i=null;for(let o in t)i=t[o],i.button.removeListener("click",e.get(i)),e.delete(i);t.splice(0,t.length);let o=this._private.presenter;e.delete(o)}destroy(){let e=this._private.presenter;e&&e.button&&e.button.destroy(),delete this._private.presenter,delete this._private.checkFlag,delete this._private.showLabelFlag,delete this._private.label,super.destroy()}}})),define("DS/WAfrControls/WAfrUISmallViewportActionBarFlyout",["DS/WAfrControls/WAfrUIFlyout","DS/WAfrControls/WAfrUIControl"],(function(e,t){"use strict";function i(e,t){return function(){!function(e,t){let i=new CustomEvent("change",{detail:{itemClicked:t}});e.dispatchEvent(i)}(e,t)}}function o(){this.collapse()}function n(e){let t=e.getDom();const i=new CustomEvent("expandstate",{detail:{value:e.isFlyoutExpanded()}});t.dispatchEvent(i)}function r(e){let t=null;t=e?e.target:this._private.presenter.button.getDom();let i=t.getElementsByTagName("img");if(i&&i.length>0){let e=this._private.backButtonContent;e.childElementCount>1&&e.removeChild(e.firstChild);let t=i[0].cloneNode();e.insertBefore(t,e.firstChild)}}return class extends e{getSupportedEvents(){let e=super.getSupportedEvents()||[];return e.push("change"),e.push("expandstate"),e}_buildView(e){super._buildView(e),this._private.itemsDomWrapper.classList=["afr-mab-flyout-item-container"];const t=this._private.items;for(let e of t)e.button.displayStyle="default",e.button.showLabelFlag=!1;let i=document.createElement("div");i.setAttributeNode(document.createAttribute("close")),this._private.isExpanded=!1,i.classList.add("afr-mab-flyout-expanded-container");let o=document.createElement("div");o.classList.add("afr-mab-flyout-back-button"),this._private.backButton=o;let n=document.createElement("div");n.classList.add("wux-ui-3ds"),n.classList.add("wux-ui-3ds-reply");let r=document.createElement("div");r.classList.add("afr-mab-flyout-back-container"),this._private.backButtonContent=r,r.appendChild(n),o.appendChild(r),i.appendChild(o),i.appendChild(this._private.itemsDomWrapper),this._private.expandedContainer=i}_configureEvents(e){t.prototype._configureEvents.call(this,e);const n=this._private.items;let s=r.bind(this);this._private.bound_onItemClick=s;for(let e of n)this._addListener(e.button.getDom(),"click",s);let a=o.bind(this);this._private.bound_onBackClick=a,this._addListener(this._private.backButton,"click",a);let l=this._private.presenter,p=this.getDom(),d=new WeakMap;for(let e=0,t=n.length;e<t;++e){let t=n[e],o=i(p,t.id);d.set(t,o),t.button.addListener("click",o)}let c=i(p,this._private.presenterItemId);d.set(l,c),l.button.addListener("click",c),this._private.onClickCallbackMap=d;this._private.onExpandButtonCallback=e=>{e.stopPropagation(),this._private.isExpanded?this.collapse():this.expand()},this._private.presenter.button.addListener("expandclick",this._private.onExpandButtonCallback);this._private.onCollapseButtonCallback=()=>{console.log("collapse"),this.collapse()},this._addListener(this._private.presenter.button.getDom(),"collapse",this._private.onCollapseButtonCallback)}setExpandedContainerParent(e){let t=this._private.expandedContainer;this._private._expandedContainerParent&&!t.attributes.close&&this._private._expandedContainerParent.removeChild(t),this._private._expandedContainerParent=e,t.attributes.close||this._private._expandedContainerParent.appendChild(t)}isFlyoutExpanded(){return this._private.isExpanded}collapse(){if(this.isFlyoutExpanded()){let e=this._private.expandedContainer;e.setAttributeNode(document.createAttribute("close")),this._private._expandedContainerParent&&this._private._expandedContainerParent.removeChild(e),this._private.isExpanded=!1,n(this)}}expand(){if(!this.isFlyoutExpanded()){let e=this._private.expandedContainer;e.removeAttribute("close"),this._private._expandedContainerParent&&this._private._expandedContainerParent.appendChild(e),this._private.bound_onItemClick(),this._private.isExpanded=!0,n(this)}}}}));