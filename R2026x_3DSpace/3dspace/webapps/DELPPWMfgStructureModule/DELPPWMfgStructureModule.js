define("DS/DELPPWMfgStructureModule/BatchMapping",[],(function(){"use strict";return{"Compute Resulting Product of Item":"DELPRDBatchComputeResultingProduct"}})),define("DS/DELPPWMfgStructureModule/JobStatusUI",["UWA/Core","DS/DELPPWMfgStructureModule/BatchMapping"],(function(e,t){"use strict";const n="CREATED",o="SUBMITTED",i="IN_PROGRESS",r="COMPLETED",a="FAILED",s="MBOMCreate",l="SBOMCreate",u="MBOMUpdate",c="SBOMUpdate",d=function(t){return e.is(t,"string")&&0===t.length},m=function(e){return new Date(e)},g=function(e,t){return e>t?1:e===t?0:-1},p=function(e){let t;switch(e.toUpperCase()){case r:t="status-ok";break;case a:t="remove";break;case i:t="compute";break;case n:t="new-create";break;case o:t="publish";break;default:t=""}return{iconName:t,fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"}};return function(f,I,S,h,b){const C=[{text:S.getNLSValue("JobStatusUI.Column.Action"),description:S.getNLSValue("JobStatusUI.Column.Action"),dataIndex:"tree",width:"9.5%"},{text:S.getNLSValue("JobStatusUI.Column.ContextObject"),description:S.getNLSValue("JobStatusUI.Column.ContextObject"),dataIndex:"contextObject",width:"20%",getCellSemantics:function(e){return{icon:e.nodeModel.options.mfgIconPath}},getCellValue:function(e){return e.nodeModel.options.contextObject}},{text:S.getNLSValue("JobStatusUI.Column.Status"),description:S.getNLSValue("JobStatusUI.Column.Status"),dataIndex:"status",width:"10%",getCellSemantics:function(e){const t=e.nodeModel.options.status;return{icon:p(t)}}},{text:S.getNLSValue("JobStatusUI.Column.Started"),description:S.getNLSValue("JobStatusUI.Column.Started"),dataIndex:"started",width:"13.5%",typeRepresentation:"datetime",alignment:"near",compareFunction:function(e,t){return g(e,t)},getCellValueForSort:function(e){return Number(e.options.startedDateTime)}},{text:S.getNLSValue("JobStatusUI.Column.Ended"),description:S.getNLSValue("JobStatusUI.Column.Ended"),dataIndex:"ended",width:"13.5%",typeRepresentation:"datetime",alignment:"near",hasCellValue:function(e){let t;switch(e.nodeModel.options.status){case n:case i:case o:t=!1;break;default:t=!0}return t},compareFunction:function(e,t){return g(e,t)},getCellValueForSort:function(e){const t=e.options.endedDateTime;return d(t)?0:Number(t)}},{text:S.getNLSValue("JobStatusUI.Column.Details"),description:S.getNLSValue("JobStatusUI.Column.Details"),dataIndex:"details"},{text:S.getNLSValue("JobStatusUI.Column.RemoteMachine"),description:S.getNLSValue("JobStatusUI.Column.RemoteMachine"),dataIndex:"remoteMachine"},{text:S.getNLSValue("JobStatusUI.Column.ReturnCode"),description:S.getNLSValue("JobStatusUI.Column.ReturnCode"),dataIndex:"returnCode"}];let M,L,N,w,P,U;const R=function(n){if(-1===n.columnID)return this.getCellDefaultTooltip(n);let o="";const{dataIndex:i,description:r}=this.getColumnOrGroup(n.columnID);if(-1===n.rowID)return e.is(r)&&(o=r),{longHelp:o};const a=n.nodeModel,s="tree"===i?a.getLabel():a.getAttributeValue(i);if(e.is(s))switch(i){case"tree":case"contextObject":case"owner":case"started":case"ended":case"status":case"details":case"remoteMachine":o=s;break;case"returnCode":o=function(n){const o=n.options,i=o.operation;if(e.owns(t,i)){const n=t[i],r=o.returnCode;if(!e.is(r))return"";if(0===r){const e=`${n}.BatchOK`;return S.getNLSValue(e)}const a=`${n}.RC${r}`,s=S.getNLSValue(a);return s!==a?s:S.getNLSValue("BatchFail",{returnCode:r})}return""}(a)}return{longHelp:o}},y=function(n){const o=`JobStatusUI.Action.${n}`;let i;const r=S.getNLSValue(o);if(r!==o)i=r;else if(e.owns(t,n)){const e=`${t[n]}.Title`,o=S.getNLSValue(e);i=o!==e?o:n}else i=n;return i},D=function(t){let n;return n=(t.status===r||t.status===a)&&e.is(t.returnCode)?t.returnCode:"",n},V=function(){return M.getSelectedNodes()},v=function(t,n){let o;switch(n){case s:case l:o=function(t){const n=t.options,o=n.status.toUpperCase()===a;if(o){const t=n.mfgId,i=JSON.parse(n.payload),{rawXMLPhantomNodeConfig:r,rawXMLLinkAuthoringConfig:a}=h.getRawXMLsRequired4CreateMBOM();return{isJobInFailedState:o,details:{payload:{...i,xmlPhantomNodeConfig:e.is(r,"string")?r:null,xmlLinkAuthoringConfig:e.is(a,"string")?a:null},mfgId:t,correlationId:n.correlationId}}}return{isJobInFailedState:o,details:null}}(t);break;case u:case c:o=function(t){const n=t.options,o=n.status.toUpperCase()===a;if(o){const t=n.mfgId,i=JSON.parse(n.payload),{rawXMLPhantomNodeConfig:r,rawXMLExpandNodeConfig:a,rawXMLLinkAuthoringConfig:s}=h.getRawXMLsRequired4UpdateMBOM();return{isJobInFailedState:o,details:{payload:{...i,xmlPhantomNodeConfig:e.is(r,"string")?r:null,xmlExpandNodeConfig:e.is(a,"string")?a:null,xmlLinkAuthoringConfig:e.is(s,"string")?s:null},mfgId:t,correlationId:n.correlationId}}}return{isJobInFailedState:o,details:null}}(t);break;default:o=null}return o},x=function(e){const t=function(e){return new Promise(((t,n)=>{const o={noTimeout:!0};f.notify("startProgress",o);const i=e.map((e=>h.refreshMBOMJob(e)));Promise.allSettled(i).then((e=>{const n=e.filter((e=>"fulfilled"===e.status));if(!(n.length>0))throw new Error("refresh failed");{const e=n.map((e=>e.value));f.notify("stopProgress",o),f.notify(S.getNLSValue("JobStatusUI.jobRefresh.Refresh.Success")),t(e)}})).catch((e=>{f.notify("stopProgress",o),f.info(S.getNLSValue("JobStatusUI.jobRefresh.Refresh.Fail")),n([])}))}))}(e);return t},O=function(t,n,o,i){let r;switch(t){case s:case l:r=function(t,n,o){return new Promise((function(i,r){if(0===b.getInstancesFromCollection(n).length){const n={noTimeout:!0};f.notify("startProgress",n),h.createMBOMOnResubmit(t,o).then((e=>{f.info(S.getNLSValue("CreateMfgItemStructure.jobSubmit.Success")),f.notify("stopProgress",n),i()})).catch((t=>{e.is(t)&&e.owns(t,"message")&&"MfgItem_has_children"===t.message?f.warn(S.getNLSValue("JobStatusUI.jobSubmit.Resubmit")):f.warn(S.getNLSValue("CreateMfgItemStructure.jobSubmit.Fail")),f.notify("stopProgress",n),r()}))}else f.warn(S.getNLSValue("JobStatusUI.jobSubmit.Resubmit")),r()}))}(n,i,o);break;case u:case c:r=function(e,t){return new Promise(((n,o)=>{const i={noTimeout:!0};f.notify("startProgress",i),h.updateMBOMOnResubmit(e,t).then((e=>{f.info(S.getNLSValue("UpdateMfgItemStructure.jobSubmit.Success")),f.notify("stopProgress",i),n()})).catch((e=>{f.warn(S.getNLSValue("UpdateMfgItemStructure.jobSubmit.Fail")),f.notify("stopProgress",i),o()}))}))}(n,o);break;default:r=Promise.reject()}return r},F=function(t){const r=Array.isArray(t)?t:[t];!function(e,t,n){1===e.length?n(e[0].options)&&!0===t.disabled&&(t.disabled=!1):!1===t.disabled&&(t.disabled=!0)}(r,U,(t=>(!e.is(t.remoteMachine)||""===t.remoteMachine)&&t.status.toUpperCase()===a)),function(e,t,n){e.length>0&&e.every((e=>{const t=e.options;return n(t)}))?!0===t.disabled&&(t.disabled=!1):!1===t.disabled&&(t.disabled=!0)}(r,P,(e=>{const t=e.status.toUpperCase();return t===n||t===i||t===o}))},B=function(e,t){const n=t.status,o=d(t.ended)?"":m(Number(t.ended)),i=t.details;let r={...e};r.grid={...r.grid,status:S.getNLSValue(`JobStatusUI.Status.${n}`),ended:o,details:i,returnCode:D(t)};const a=t.returnCode;return r={...r,status:n,endedDateTime:o,returnCode:a},r},J=function(e){b.withMutexLock((()=>function(e){return new Promise(((t,n)=>{const o=e.filter((e=>!e.options.computedRefType));if(o.length>0){const e=o.reduce(((e,t)=>{const n=t.options.mfgId;return e.has(n)?e.get(n).push(t):e.set(n,[t]),e}),new Map),i=Array.from(e.keys());h.getReferenceTypes(i).then((n=>{M.withTransactionUpdate((()=>{e.entries().forEach((([e,t])=>{const o=n[e];t.forEach((e=>{const t=e.options;t.computedRefType=!0,t.mfgIconPath=S.getIconURLFromKey(o),e.updateOptions(t)}))}))})),t()})).catch((e=>{f.log("getReferenceTypes failed with error: "+e),n(e)}))}else t()}))}(e))).catch((function(e){f.log("updating icon based on refType failed with error: "+e)}))};return{display:function(t){w=t;const n=t();e.is(n.then,"function")&&n.then((t=>{let n=e.createElement("div",{class:"JobStatus-content-container"});const{panel:o,treeDocument:i}=function(t){const n=I.getComponent("WUXFrameWindowsManager").getFrameWindow(f.getAppContext()).getImmersiveFrame(),o=I.getComponent("Button");let i=e.createElement("div");i.className="job-status-header",i.setAttribute("id","job-status-header"),i.setStyles({left:"10px",position:"relative",width:"fit-content"});let s=e.createElement("div");s.className="header-base",s.setStyles({display:"flex","align-items":"center",height:"25px"}),P=new o({domId:"RefreshButton",label:S.getNLSValue("JobStatusUI.Refresh"),icon:{iconName:"refresh",fontIconSize:"1x"},disabled:!0,onClick:()=>{const t=V();if(t.filter((e=>e.options.status.toUpperCase()===r||e.options.status.toUpperCase()===a)).length>0)return void f.info(S.getNLSValue("JobStatusUI.jobRefresh.Refresh.Unsupported"));const n=Array.isArray(t)?t.map((e=>e.options.correlationId)):[];if(n.length>0){const o=S.getNLSValue("View.WaitMessage");P.disabled=!0,N.displayModalLoader(o,(()=>{x(n).then((t=>{const n=V();n.forEach((n=>{const o=n.options,i=t.find((e=>e.correlationId===o.correlationId));if(e.is(i)){const e=B(o,i);n.updateOptions(e)}})),F(n),N.removeModalLoader(o)})).catch((()=>{F(t),N.removeModalLoader(o)}))}))}}}),U=new o({domId:"ResubmitButton",label:S.getNLSValue("JobStatusUI.Resubmit"),icon:{iconName:"reset",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},disabled:!0,onClick:()=>{const t=V();if(Array.isArray(t)&&1===t.length){const n=t[0],o=n.options.operation,i=v(n,o);if(e.is(i)&&i.isJobInFailedState&&e.is(i.details)){const{payload:t,mfgId:r,correlationId:a}=i.details;U.disabled=!0;const s=S.getNLSValue("View.WaitMessage");N.displayModalLoader(s,(()=>{O(o,t,a,r).then((()=>{x([a]).then((t=>{const o=n.options,i=t.find((e=>e.correlationId===o.correlationId));if(e.is(i)){const e=B(o,i);n.updateOptions(e),F(n),N.removeModalLoader(s)}})).catch((()=>{F(n),N.removeModalLoader(s)}))})).catch((()=>{F(n),N.removeModalLoader(s)}))}))}}}}),P.inject(s),U.inject(s),i.setContent(s);const l=I.create("Panel",{header:i,title:S.getNLSValue("JobStatusUI.Title"),icon:S.getIconURLFromKey("DELJobStatus"),domId:"DELJobStatus",immersiveFrame:n,content:t,width:1100,height:250,position:{my:"center",at:"center"},resizableFlag:!0,closeButtonFlag:!0,useBordersFlag:!0,visibleFlag:!1,collapsibleFlag:!0,verticallyStretchableFlag:!0});l.close=()=>l.hide();const u=I.getComponent("TreeDocument"),c=I.getComponent("DataGridView"),d=I.getComponent("Paginator"),m=I.getComponent("PaginatorStatusBar"),g=new u;g.getXSO().onChange((()=>{const e=g.getSelectedNodes();F(e)})),N=new c({treeDocument:g,columns:C,getCellTooltip:R}),N.onDelayedModelDataRequest=t=>{const n=t.collectionView,{startNodeIndex:o,endNodeIndex:i}=t;if(o>=0&&i>=0){let t=[];for(let r=o;r<=i;r++){const o=n.model[r];e.is(o)&&t.push(o)}t.length>0&&J(t)}};const p=new d({pageSize:10,nodeDepth:0,currentPage:1});return N.paginationManager=p,N.buildStatusBar([{type:m.STATUS.PAGINATION,position:"far"}]),N.sortModel=[{dataIndex:"started",sort:"desc"}],N.getContent().inject(t),{panel:l,treeDocument:g}}(n);L=o,M=i,function(e,t){const n=I.getComponent("TreeNodeModel"),o=t.map((e=>{const t=m(Number(e.started)),o=d(e.ended)?"":m(Number(e.ended));return new n({label:y(e.operation),grid:{contextObject:e.contextObject,owner:e.owner,started:t,ended:o,status:S.getNLSValue(`JobStatusUI.Status.${e.status}`),details:e.details,remoteMachine:e.remoteMachine,returnCode:D(e)},payload:e.payload,operation:e.operation,mfgId:e.mfgId,mfgIconPath:null,computedRefType:!1,contextObject:e.contextObject,correlationId:e.correlationId,status:e.status,startedDateTime:e.started,endedDateTime:e.ended,remoteMachine:e.remoteMachine,returnCode:e.returnCode})}));e.withTransactionUpdate((()=>{o.forEach((t=>e.addRoot(t)))}))}(i,t),o.show()}))},destroy:function(){e.is(M)&&(M.empty(),M=null),e.is(w)&&(w=null),e.is(L)&&(L.destroy(),L=null)}}}})),define("DS/DELPPWMfgStructureModule/MfgStructureModule",["UWA/Core","DS/DELPPWMfgStructureModule/JobStatusUI"],(function(e,t){"use strict";return{behaviors:["UXFactoryBehavior","MfgItemUXBehavor","ResourceBehavior","ModelBehavior","WUXNodeModelBehavior","TreeListViewBehavior","ProductImplementBehavior","SelectionBehavior","MfgItemBehavior","ViewBehavior","RootsBehavior"],creator:function(n,o,i,r,a,s,l,u,c,d,m,g){var p,f,I,S,h,b,C,M,L,N,w,P,U,R,y,D,V,v,x="UpdateMfgItemStructure",O=null,F={},B=null,J=null;f=function(t,n){if(F={},!e.is(t))throw new Error("Command ID is null");F.cmdId=t,F.onOKCallBack=n,F.onCancelCallback=w},b=function(){e.is(O)&&(O.isVisible()&&O.destroyUI(),O=void 0)},C=function(e){var t=!0,n=m.getActiveView();return!1===e.changed.isSelected&&e.sourceId!==n&&(t=!1),t},h=function(){var t,n,o,i,r={},s=[],l=!1;return t=O.getImplementingID(),i=O.getImplementedIDs()[0],e.is(t)&&(n=a.getReferenceId(t),(o=u.getScopeLinksOfImplementing(n)).length>0&&(r.id=o[0].get("to"),s.push(r),e.is(i)?a.getReferenceId(i)!==r.id&&(O.updateImplemented(s),l=!0):(O.updateImplemented(s),l=!0))),l},S=function(){var t=c.getSelectionsWithPaths()[1][0],n=e.is(t)?t.id:null,o=a.getReferenceModel(n),i=a.getInstance(n),r=!1;return e.is(o)&&(o.isProcess()||o.isService()||o.isConstruction())&&(r=a.checkForContextualImplementLink(o,i)),r},I=function(e){var t,n;!0===e.bUpdateImplemented?(O.updateImplemented(e.selNodes),t="ImplementUI.ImplementedSelectionNotAllowed",n="error"):!0===e.bUpdateImplementing&&(O.updateImplementing(e.selNodes),t="ImplementUI.ImplementedSelectionChanged",n="info"),!0===h()&&O.showMessages(r.getNLSValue(t),n)},M=function(t){if(F={},!e.is(t))throw new Error("Command ID is null");F.cmdId=t,F.moduleOptions=p,F.onOKCallBack=U,F.onCancelCallback=w},L=function(e,t){B.updateImplementingLabel(e),a.getMajorRevisions(t,(function(e){B.updateImplementedRevnList(t,e,!1)}))},N=function(){e.is(B)&&(B.isVisible()&&B.destroyUI(),B=void 0)};const T=function(){e.is(J)&&(J.destroy(),J=null)};return P=function(t){var o,s,l,c,m,p,f,I,S,h={};if(e.is(t)){if(o=a.getReferenceModel(t.implementingId),s=a.getReferenceModel(t.implementedIDs[0]),l=a.getInstance(t.implementingId),c=a.getInstance(t.implementedIDs[0]),S=t.implementingId,e.is(t.implementingPaths[0])&&e.is(t.implementingPaths[0][0])){S=a.getInstance(t.implementingPaths[0][0]).get("isAggregatedBy")}l&&c&&u.isImplementLinkPossible(t.implementingPaths[0],t.implementedPaths[0])&&(m=l.get("PID"),p=u.getPathToScope(t.implementedPaths[0])),f=a.getDisplayName(o),I=a.getDisplayName(s),h.scopeCreation=t.scopeCreation,h.prefix=t.mfgItemPrefix,h.logMessage=r.getNLSValue("CreateMfgItemStructure.LogMessage",{mbom:f,ebom:I}),h.computeResultReport=!!e.is(t.resultReportMode)&&"no_report"!==t.resultReportMode,h.isOpennessComputationRequired=!e.is(t.skipOpenness,"boolean")||!t.skipOpenness;const C=g.getCompatibleConfigurationFilters([s.id]);if(!e.is(C)||null===C)return void n.warn(r.getNLSValue("Error.NoConfigurationFiltersExists.Failure"));d.webservice("Create",{product:{referencePID:s.get("PID"),OccPath:p,productConfigFilter:C[s.id]},mfgItem:{referencePID:o.get("PID"),instancePID:m,topRootMfgItemPID:S}},h,(function(n){var o;n=n||{},e.is(n.resultReport)&&(e.is(t.resultReportMode)&&(o=t.resultReportMode),i.createMfgItemCreateReportUI({report:n.resultReport,mode:o}))})),b()}},U=function(t){var n,o,i={};if(e.is(t)){if(n=a.getDisplayName(a.getReferenceModel(t.implementingId)),i.backgroundJobFlag=!!d.isUpdateMBOMv2(),i.scopeCreation=t.scopeCreation,i.prefix=t.mfgItemPrefix,i.logMessage=r.getNLSValue("UpdateMfgItemStructure.LogMessage",{mbom:n}),i.updateIntermediateScopedAssemblies=t.updateIntermediateScopedAssemblies,o=t.implementingId,e.is(t.implementingPaths[0])&&e.is(t.implementingPaths[0][0])){o=a.getInstance(t.implementingPaths[0][0]).get("isAggregatedBy")}d.webservice("Update",{product:{referencePID:t.implementedId,productConfigFilter:v[t.implementedId]},mfgItem:{referencePID:t.implementingId,processConfigFilter:V[t.implementingId],topRootMfgItemPID:o}},i),N()}},w=function(){b(),N()},R=function(){w(),f("CreateMfgItemStructure",P),F.cmdTitle="Dialog.CreateMfgItemStructure.Title",F.implementingSection=!0,F.implementedSection=!0,F.optionsSection=!0,F.scopeOption="ComboBox",F.mfgItemPrefix=!0,F.mfgItemResultReport=!d.isCreateMBOMv2(),F.skipOpennessOption=!!d.isCreateMBOMv2(),F.multiSelectionOfImplementing=!1,F.multiSelectionOfImplemented=!1,O=i.createImplementUI(F),!0!==S()?I(O.getSelectionsWithPaths()):O.showMessages(r.getNLSValue("CreateMfgItemStructure.CILUnSupported"),"error")},y=function(){e.is(J)&&T(),(J=new t(n,o,r,d,a)).display((()=>d.getJobStatuses()))},D=function(){var t,o,s,l,d,m=c.getSelectionsWithPaths()[1][0],p=m.id,f=a.getReferenceModel(p);if(w(),!e.is(f))return void n.debug(x+": Reference Model not found for pid:"+p);if(!0===S())return void n.warn(r.getNLSValue("UpdateMfgItemStructure.CILUnSupported"));if(s=f.get("PID"),(t=u.getScopeLinksOfImplementing(s)).length<=0)return void n.warn(r.getNLSValue("Error.NoProductScopeExists.Title"));if(o=t[0].get("to"),e.is(m.path,"array")&&m.path.length>0){const e=m.path[0];d=a.getInstance(e).get("isAggregatedBy");const t=u.getScopeLinksOfImplementing(d);if(0===t.length)return void n.warn(r.getNLSValue("Error.NoProductScopeExists.Title"));l=t[0].get("to")}else l=o,d=s;const I=g.getCompatibleConfigurationFilters([d]),h=g.getCompatibleConfigurationFilters([l]);e.is(I)&&e.is(h)?(V={...I},v={...h},M(x),F.cmdTitle="Dialog.UpdateMfgItemStructure.Title",F.implementedRevTreeListCSSStyle="implementedSection-container-withChkBox",F.optionsSection=!0,F.scopeOption="ComboBox",F.mfgItemPrefix=!0,F.defaultHeight="430",F.modalFlag=!0,(B=i.createImplementedRevChooserUI(F)).updateImplementing(),L(s,o)):n.warn(r.getNLSValue("BI.Computation.IncompatibleFilter"))},{listenTo:function(){return{select:this.onSelect,CreateMfgItemStructure:R,DELJobStatus:y,UpdateMfgItemStructure:D}},onStart:function(e){p=e},onStop:function(){b(),N(),T()},onSelect:function(t){if(e.is(O)&&O.isVisible()&&e.is(t)){if(!1===C(t))return;if(!0===S())return void O.showMessages(r.getNLSValue("CreateMfgItemStructure.CILUnSupported"),"error");e.is(t.changed)&&I(O.getSelectionsWithPaths())}}}}}}));