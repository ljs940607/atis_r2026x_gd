define("DS/Form/FormUtils",["require","exports"],(function(e,t){"use strict";return function(){function e(){}return e.isFormModelParentItem=function(e){return!!e.children},e.isFormModelLeafItem=function(e){return!e.children},e}()})),define("DS/Form/typings/types",[],(()=>{})),define("DS/Form/PrivateFormUtils",["require","exports","UWA/Core","DS/Utilities/Dom","DS/Utilities/Utils","DS/Form/FormUtils","DS/Handlebars/Handlebars","text!DS/Form/assets/templates/formField.htm","text!DS/Form/assets/templates/formSection.htm","i18n!DS/Form/assets/nls/translation","DS/Tweakers/TypeRepresentationFactory","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel"],(function(e,t,i,o,n,r,a,l,s,d,u,c,p){"use strict";var h=["_"],v=Object.freeze({compact:0,large:350}),f={FIELD:a.compile(l),SECTION:a.compile(s)},m=new u,y="globalFormInformation",g={info:"info",warning:"attention",error:"error",success:"check"};function b(e){if(e)return e.icon?e.icon:g[e.emphasize]}function _(e,t,i,o){var n=t.getLabel(),r=w.getLabelContainerFromFormCell(e),a=w.getTweakerContainerFromFormCell(e),l=t.getAttributeValue(i);r&&r.setAttribute(o,n&&l?"true":"false"),a&&a.setAttribute(o,!n&&l?"true":"false")}var w=function(){function e(){}return e.getTypeRepresentationFactory=function(){return m},e.getTweakerFromRowID=function(t,i){var o=t._getViewAt(i);if(o){var n=o.getReusableContent();if(n)return e.getTweakerFromFormCell(n)}},e.getTweakerFromFormCell=function(e){var t,i=e.querySelector(".form-tweaker");if(null===(t=null==i?void 0:i.children)||void 0===t?void 0:t.length)return i.children[0].dsModel},e.getLabelFromFormCell=function(e){return e.querySelector(".form-label")},e.setLabelInFormCell=function(t,o){var n=e.getLabelFromFormCell(t);if(n){var r=o.getLabel();if(r){if(r=i.String.escapeHTML(r))for(var a=0;a<h.length;a++)r=r.replaceAll(h[a],h[a]+"<wbr>");n.innerHTML=r}var l=e.isSection(o),s=e.getLabelContainerFromFormCell(t);!l&&s&&s.setAttribute("labelVisibility",r?"true":"false")}},e.getInvalidIconsFromFormCell=function(e){return e.querySelectorAll(".invalid-icon")},e.getLabelContainerFromFormCell=function(e){return e.querySelector(".label-container")},e.getRequiredIconsFromFormCell=function(e){return e.querySelectorAll(".wux-required-icon")},e.getHelpTextFromFormCell=function(e){return e.querySelector(".wux-help-text")},e.getTweakerContainerFromFormCell=function(e){return e.querySelector(".tweaker-container")},e.getSectionLabelFromFormCell=function(e){var t=e.querySelector(".section-label");if(t)return t},e.updateSectionStyle=function(e,t){var i=t.getAttributeValue("style")||"default",o=e.querySelector(".section");o&&o.setAttribute("sectionStyle",i)},e.updateRequired=function(t,i){_(t,i,"requiredFlag","requiredIconVisibility"),e.getRequiredIconsFromFormCell(t).forEach((function(e){var t=i.getAttributeValue("requiredTooltip")||{shortHelp:d.requiredTooltip};e.tooltipInfos=t}))},e.updateInfoIcons=function(e,t){var i=e.querySelectorAll(".wux-info-icon");if(i&&i.length>0){_(e,t,"moreInformation","infoIconVisibility");var o=t.getAttributeValue("moreInformation");i.forEach((function(e){e.tooltipInfos=o}))}},e.updateHelpText=function(t,i){var o=e.getHelpTextFromFormCell(t),n=i.getAttributeValue("helpText");o.textContent=n},e.updateValidityIcons=function(t,i,n){var r=i._computeInvalidityStatus(n),a=e.getLabelContainerFromFormCell(t),l=e.getTweakerContainerFromFormCell(t);a.setAttribute("invalidStatusVisibility",r.shouldDisplay.toString()),l.setAttribute("invalidStatusVisibility",r.shouldDisplay.toString()),t.querySelectorAll(".wux-form-validity-icon").forEach((function(t){if(0===t.childElementCount){if(!r.shouldDisplay)return;t.appendChild(o.generateValidityIcon({state:r.invalidState?"invalid":"valid",getValidityReason:function(){return i._computeInvalidityStatus(n).invalidState?e.getInvalidStateConsideringRequiredFlagOnly(n)?"required":"format":"fixed"},tooltipInfos:r.invalidState?n.getAttributeValue("invalidTooltip"):void 0}))}else{var a=t.children[0];a.setValidityIconState(r.shouldDisplay?r.invalidState?"invalid":"valid":"none"),a.tooltipInfos=r.invalidState?n.getAttributeValue("invalidTooltip"):void 0}}))},e.pushLockTweakerToGenerate=function(e,t){t?V(e):C(e)},e.generateTweakerForForm=function(t,n,r){if(n&&r.parentHTMLElement&&!e.isSection(n)){V(t);var a=n.options.grid;a._liveValue=i.clone(a.value);var l=!(!r||!t.readOnly)||!!a.readOnly&&a.readOnly,s=i.clone(a.semantics)||{};t.disabled&&(s.disabled=!0),n.getAttributeValue("tooltipInfos")&&(s.tooltipInfos=n.getAttributeValue("tooltipInfos"));var d=t._getCurrentTouchMode();m.generateView(a.value,{typePath:a.typeRepresentation,semantics:s,touchMode:d,context:a.context?a.context:"inlinedTemplate",readOnly:l,onViewCreated:function(e){if(void 0!==e&&!n.isDestroyed()){D(n,e,d);var i=r.parentHTMLElement.classList.contains("form-tweaker")?r.parentHTMLElement:r.parentHTMLElement.querySelector(".form-tweaker");i&&o.setContent(i,e.getContent()),setTimeout((function(){t._updateInvalidStateFromTweaker(n,e.validState)}),0)}C(t),r&&r.onViewCreated&&r.onViewCreated.call(t)}})}},e.createFormCellView=function(t,i,n){if(i&&n.parentHTMLElement)if(e.isSection(i)){var r=i.isExpanded()?"expanded":"collapsed",a=f.SECTION({label:i.getLabel(),state:r,style:i.getAttributeValue("style")});o.setContent(n.parentHTMLElement,a,!0),i.getAttributeValue("tooltipInfos")&&(e.getSectionLabelFromFormCell(n.parentHTMLElement).tooltipInfos=i.getAttributeValue("tooltipInfos")),n&&n.onViewCreated&&n.onViewCreated.call(t)}else{var l=i.getLabel(),s=i.getAttributeValue("requiredFlag");a=f.FIELD({label:l,labelVisibility:Boolean(l),requiredVisibleOnLabel:Boolean(l&&s),requiredVisibleOnTweaker:Boolean(!l&&s),invalidStatusVisibility:!1,infoIconVisibility:Boolean(i.getAttributeValue("moreInformation")),helpText:i.getAttributeValue("helpText")});o.setContent(n.parentHTMLElement,a,!0),e.setLabelInFormCell(n.parentHTMLElement,i),e.updateValidityIcons(n.parentHTMLElement,t,i),e.updateInfoIcons(n.parentHTMLElement,i),e.updateRequired(n.parentHTMLElement,i),e.generateTweakerForForm(t,i,n)}},e.updateTweakerProperties=function(e,t,o){var r,a=t.getAttributeValue("typeRepresentation"),l=t.getAttributeValue("semantics"),s=l?i.clone(l,!1):{},d=o.touchMode?o.touchMode:t.getAttributeValue("touchMode")||!1;s.touchMode=d,s.readOnly=o.readOnly?o.readOnly:t.getAttributeValue("readOnly")||!1,s.disabled=o.disabled?o.disabled:(null===(r=t.getAttributeValue("semantics"))||void 0===r?void 0:r.disabled)||!1,s.value=t.getAttributeValue("value"),t.getAttributeValue("tooltipInfos")&&(s.tooltipInfos=t.getAttributeValue("tooltipInfos")),e.disableEvents(),n.setTweakerProperties(e,s,a,m),e&&e.elements&&e.elements.container&&(e.enableEvents(),D(t,e,d),!1===t.getAttributeValue("visibleFlag")?t.isHidden()||t.hide():t.isHidden()&&t.show())},e.isSection=function(e){var t=e.getChildren();return null!=t},e.getSizeMap=function(){return v},e.createFormModelFromJSArray=function(t,i){var o=new c;return e.completeNodeModelFromJSArray(o._getTrueRoot(),t),F(o,i&&i.globalInformation),o},e.getIdFromNodeModel=function(e){return e.getAttributeValue("id")},e.getNodeModelWithId=function(t,i){var o;return i.processDescendants({onlyVisibleNodes:!1,processNode:function(i){var n=i.nodeModel;if(e.getIdFromNodeModel(n)===t)return o=n,{stopProcessing:!0}}}),o},e.updateGlobalInformation=function(e,t){if(e){var i=e.getRoots(),o=i.length>0?i[0]:void 0;o&&o.getAttributeValue("id")===y?t?(o.setAttribute("value",t.text),o.setAttribute("semantics",{emphasize:t.emphasize,icon:b(t)})):(o.remove(),o.destroy()):F(e,t)}},e.completeNodeModelFromJSArray=function(t,i,o){if(void 0===o&&(o="last"),Array.isArray(i))for(var n=i.length,a=0;a<n;a++){var l=i["first"===o||"after"===o?n-1-a:a],s={label:l.label,grid:{id:l.id,visibleFlag:l.visibleFlag,tooltipInfos:l.tooltip},children:null};r.isFormModelParentItem(l)?(Object.assign(s.grid,{style:l.style}),s.children=[]):r.isFormModelLeafItem(l)&&Object.assign(s.grid,{context:l.context,height:l.height,readOnly:l.readOnly,semantics:Object.assign({alignment:"near"},l.semantics),typeRepresentation:l.typeRepresentation,value:l.value,_liveValue:l.value,requiredFlag:l.requiredFlag,requiredTooltip:l.requiredTooltip,invalidFlag:l.invalidFlag,invalidTooltip:l.invalidTooltip,moreInformation:l.moreInformation,helpText:l.helpText,onNodeUpdate:l.onNodeUpdate,onNodeLiveUpdate:l.onNodeLiveUpdate});var d=new p(s);switch(o){case"first":if(t._isTrueRoot()){var u=t.getChildren();if(u.length>0&&u[0].getAttributeValue("id")===y){t.addChild(d,1);break}}t.addChild(d,0);break;case"last":t.addChild(d);break;case"before":t.getParent().insertBefore(d,t);break;case"after":t.getParent().insertAfter(d,t)}r.isFormModelParentItem(l)&&(e.completeNodeModelFromJSArray(d,l.children),!1!==l.expandedFlag&&d.expand()),!1===l.visibleFlag&&d.hide()}},e.getModelItem=function(t,i){if(!i){for(var o=t.getRoots(),n=[],r=0;r<o.length;r++)n.push(A(t,o[r]));return n}var a=e.getNodeModelWithId(i,t);if(a)return A(t,a)},e.getInvalidStateConsideringRequiredFlagOnly=function(e){var t=!1;if(void 0===e.getAttributeValue("invalidFlag")&&e.getAttributeValue("requiredFlag")){var i=e.getAttributeValue("_liveValue");t=null==i||""===i||Array.isArray(i)&&!i.length}return t},e}();function V(e){e._tweakerToGenerateCount?e._tweakerToGenerateCount++:e._tweakerToGenerateCount=1}function C(e){void 0===e._tweakerToGenerateCount||e._tweakerToGenerateCount<=0?window.console.warn("Too many tweakers removed"):(e._tweakerToGenerateCount--,0===e._tweakerToGenerateCount&&e._onAllCellsRendered&&e._onAllCellsRendered())}function D(e,t,i){if(e.options.grid.hasOwnProperty("height")){var o,n=e.getAttributeValue("height");delete e.options.grid.height,o=void 0!==n&&"object"==typeof n?n[i?"touch":"mouse"]:n,t.setHeight(o)||("number"==typeof o?t.getContent().setStyle("height",o+"px"):t.getContent().getStyle("height")&&t.getContent().setStyle("height",""))}}function F(e,t){t&&e.addRoot(new p({grid:{id:y,typeRepresentation:"multilineString",context:"stdTemplate",readOnly:!0,value:t.text,semantics:{emphasize:t.emphasize,icon:b(t)}}}),0)}function A(e,t){var i={id:w.getIdFromNodeModel(t),label:t.getLabel(),visibleFlag:!t.isHidden(),tooltip:t.getAttributeValue("tooltipInfos")};if(w.isSection(t)){var o=i;o.style=t.getAttributeValue("style"),o.expandedFlag=t.isExpanded();for(var n=[],r=t.getChildren(),a=0;a<r.length;a++)n.push(w.getModelItem(e,r[a].getAttributeValue("id")));o.children=n}else{var l=i;l.typeRepresentation=t.getAttributeValue("typeRepresentation"),l.value=t.getAttributeValue("value"),l.requiredFlag=t.getAttributeValue("requiredFlag"),l.requiredTooltip=t.getAttributeValue("requiredTooltip"),l.invalidFlag=t.getAttributeValue("invalidFlag"),l.invalidState=l.invalidFlag||!t.__tweakerValidState||w.getInvalidStateConsideringRequiredFlagOnly(t),l.invalidTooltip=t.getAttributeValue("invalidTooltip"),l.moreInformation=t.getAttributeValue("moreInformation"),l.helpText=t.getAttributeValue("helpText"),l.semantics=t.getAttributeValue("semantics"),l.readOnly=t.getAttributeValue("readOnly"),l.context=t.getAttributeValue("context")}return i}return w}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/Form/FormCollectionViewLayout",["require","exports","DS/CollectionView/layouts/CollectionViewListLayout","DS/Form/PrivateFormUtils","DS/Core/WebUXComponents"],(function(e,t,i,o,n){"use strict";var r=function(e){function t(t){return t||(t={}),t.getRowHeightFunction=function(e){var t=this.collectionView.model[e];if(this.isSectionAt(e))return 30;if("stdTemplate"===t.getAttributeValue("context")){var i=o.getTweakerFromRowID(this.collectionView,e);return i?i.getContent().offsetHeight:60}return this.rowMaxHeight},e.call(this,t)||this}return __extends(t,e),t.prototype.isSectionAt=function(e){var t=!1;if(e<this.collectionView.model.length){var i=this.collectionView.model[e];i&&i.hasChildren()&&i.isRoot()&&(t=!0)}return t},t.prototype._invalidate=function(t){var i=this.rowMaxHeight;switch(this.getLayoutDensity()){case"compact":this.rowMaxHeight=52;break;case"large":this.rowMaxHeight=30}return!0!==t&&(this.rowMaxHeight!==i?(t||(t={}),t.updateCellContent=!0,t.updateCellLayout=!0,this._resetComputedRows()):t&&t.updateCellContent&&this._resetComputedRows()),e.prototype._invalidate.call(this,t)},t.prototype.getLayoutDensity=function(){if(this.collectionView){var e,t=this.collectionView.getViewportDimensions(),i=o.getSizeMap();for(var n in i){if(!(t.width>=i[n]))break;e=n}return e}return"large"},t.prototype.getLayoutStylesForCellAt=function(t){var i=e.prototype.getLayoutStylesForCellAt.call(this,t);delete i.lineHeight;var o=this.collectionView.model[t];if(o){var n=o.getNodeDepth();n>0&&(i.paddingLeft=20*n+"px")}return i},t}(i);return n.addClass(r,"FormCollectionViewLayout"),r}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/Form/FormCollectionView",["require","exports","DS/Core/WebUXComponents","DS/Utilities/Dom","DS/Utilities/WUXUWAUtils","DS/CollectionView/CollectionView","DS/Form/FormCollectionViewLayout","DS/Form/PrivateFormUtils","DS/CollectionView/typings/types"],(function(e,t,i,o,n,r,a,l){"use strict";var s=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var o=this;return t[0].showBackgroundFlag=!1,t[0].layout=new a({rowMaxHeight:36,columnMaxWidth:"100%",layoutMargins:{marginTop:5,marginBottom:5,marginLeft:5,marginRight:5}}),(o=e.apply(this,t)||this)._inOnAllCellsRendered=!1,o._resetRowHeightsOnAllCellsRenderedFlag=!0,n.extendingClassFlag,o}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{treeDocument:{defaultValue:void 0,type:"DS/TreeModel/TreeDocument",category:"Appearance"},readOnly:{defaultValue:!1,type:"boolean",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-layouts-formcollectionview")},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("treeDocument")&&this._applyTreeDocument(t.treeDocument),this.isDirty("readOnly")&&this._applyReadOnly(t.readOnly)},t.prototype._applyTreeDocument=function(e){if(this.treeDocument){var t=this;this.treeDocument.flattenTreeDocument({onUpdate:function(e){t.model!==e.flattenedTreeDocument?t.model=e.flattenedTreeDocument:t.invalidateLayout({freePool:!0})}}),this._resetRowHeightsOnAllCellsRendered()}},t.prototype._applyReadOnly=function(e){this.layout.isValid()&&this.invalidateLayout({freePool:!0})},t.prototype.initialize=function(){e.prototype.initialize.call(this),this._manageCellRequests()},t.prototype.handleEvents=function(){e.prototype.handleEvents.call(this);var t=this;o.addEventOnElement(this,this,"click",(function(e,i){if(i&&i.cellModel){var o=i.cellModel;t.layout.isSectionAt(i.cellID)&&"expander"===o.getAttributeValue("style")&&(o.isExpanded()?o.collapse():o.expand())}})),o.addEventOnElement(this,this,"change",(function(e,i){if(t._isCurrentlyCalledFromUIInteraction()&&i&&i.nodeModel&&i.cellView){var o=i.cellView.getReusableContent();if(o){var n=l.getTweakerFromFormCell(o);t.setModelAt(i.cellID,n.value)}}})),o.addEventOnElement(this,this,"dimensionsChanged",(function(e,i){i&&i.nodeModel&&t.layout.resetRowHeight(i.cellID)}))},t.prototype.setModelAt=function(e,t){var i=this.getNodeModelAt(e);i&&i.setAttribute("value",t)},t.prototype._manageCellRequests=function(){this.onCellRequest((function(e){var t=e.cellModel;t&&e.cellView&&e.cellView.getContent&&l.createFormCellView(this,t,{parentHTMLElement:e.cellView.getContent(),onViewCreated:function(t){var i=e.cellView.getContent();i&&i.children&&i.children.length>0?e.cellView.setReusableContent(e.cellView.getContent().children[0]):e.cellView.setReusableContent(null)}})}))},t.prototype._endRendering=function(t){e.prototype._endRendering.call(this,t),this._onAllCellsRendered()},t.prototype.getLayoutDensity=function(){return this.layout.getLayoutDensity()},t.prototype._onAllCellsRendered=function(){this._inOnAllCellsRendered||!this.isInitialized()||this._isRendering()||(this._inOnAllCellsRendered=!0,this._resetRowHeightsOnAllCellsRenderedFlag&&(this._resetRowHeightsOnAllCellsRenderedFlag=!1,this.layout.resetRowHeights()),this._inOnAllCellsRendered=!1,this.fire("allCellsRendered"))},t.prototype._resetRowHeightsOnAllCellsRendered=function(){this._resetRowHeightsOnAllCellsRenderedFlag=!0},t}(r);return i.addClass(s,"formCollectionView"),s}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/Form/FormLayout",["require","exports","DS/Core/WebUXComponents","DS/Controls/Abstract","DS/Utilities/Dom","DS/CoreEvents/ModelEvents","DS/CoreBase/WebUXGlobalEnums","DS/TreeModel/ModelUtils","DS/Form/PrivateFormUtils"],(function(e,t,i,o,n,r,a,l,s){"use strict";var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isInsertedInDom=!1,t._updateViewInProgress=!1,t.__updateViewLock=0,t._hasBeenValidatedOnce=!1,t._modelEvents=new r({target:t}),t}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{treeDocument:{defaultValue:null,type:"DS/TreeModel/TreeDocument"},readOnly:{defaultValue:!1,type:"Boolean",category:"Appearance"},invalidDisplayPolicy:{readOnly:!0,defaultValue:a.InvalidDisplayPolicy.OnValidate,type:"WUX.InvalidDisplayPolicy",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){e.prototype.destroy.call(this),b.call(this,this.treeDocument)},t.prototype.subscribe=function(e,t){return this._modelEvents.subscribe(e,t)},t.prototype.unsubscribe=function(e){return this._modelEvents.unsubscribe(e)},t.prototype.buildView=function(){var t=this;e.prototype.buildView.call(this),this.elements.container.addClassName("wux-layouts-form-view wux-layouts-form-layout"),n.addResizeObserver(this,this.getContent(),(function(){t&&t.elements&&t.elements.container&&t.getContent().setAttribute("density",t._getLayoutDensity())})),this._treeDocumentSubscription=[]},t.prototype.handleEvents=function(){var t=this;e.prototype.handleEvents.call(this);var i=this;n.addEventOnElement(this,this,"click",(function(e){if(function(e,t){var i=n.firstParentWithClassUntilRoot(t.target,"section",e.elements.container);if(i&&"expander"===i.getAttribute("sectionStyle"))return!0;return!1}(i,e)){var t=f(i,e);t&&(t.isExpanded()?t.collapse():t.expand())}})),n.addEventOnElement(this,this,"change",(function(e){var i=f(t,e);if(i){i.__shouldDisplayInvalidState=!0;var o=e.dsModel.value;i.options.grid._liveValue=o,i.getAttributeValue("value")!==o&&i.setAttribute("value",o)}})),n.addEventOnElement(this,this,"liveChange",(function(e){var i=f(t,e);if(i){var o=i.getAttributeValue("_liveValue"),n=t._getNodeInvalidState(i),r=!1,a=e.dsModel.value;i.options.grid._liveValue=a;var l=t._computeInvalidityStatus(i);if(i.__forceInvalidStateDisplay=l.shouldDisplay,n!==l.invalidState&&(n=l.invalidState,r=!0),i.getAttributeValue("requiredFlag")&&void 0===i.getAttributeValue("invalidFlag"))(void 0===o||""===o||Array.isArray(o)&&!o.length)!==(void 0===a||""===a||Array.isArray(a)&&!a.length)&&h(t,i,{data:{attributes:{invalidFlag:i.getAttributeValue("invalidFlag")}}});r&&t._modelEvents.publish({event:"invalidityChange",data:l.invalidState,context:t}),t._modelEvents.publish({event:"nodeLiveUpdate",data:{nodeModel:i,value:a,oldLiveValue:o,oldValue:i.getAttributeValue("value")},context:t})}})),n.addEventOnElement(this,this,"preEdit",(function(e){var i=f(t,e);if(i){var o=t._computeInvalidityStatus(i);i.__forceInvalidStateDisplay=o.shouldDisplay,i.__shouldDisplayInvalidState=!1}})),n.addEventOnElement(this,this,"postEdit",(function(e){var i=f(t,e);i&&(i.__forceInvalidStateDisplay=!1,i.__shouldDisplayInvalidState=!0,h(t,i,{data:{attributes:{invalidFlag:i.getAttributeValue("invalidFlag")}}}))})),n.addEventOnElement(this,this,"validStateChange",(function(e){var i=f(t,e);i&&t._updateInvalidStateFromTweaker(i,e.dsModel.validState)})),n.onNodeRendered(this.getContent(),(function(){i._isInsertedInDom||(i._isInsertedInDom=!0,i._createView())})),this._addTreeDocumentSubscriptions(this.treeDocument)},t.prototype._applyProperties=function(t){this.__pushUpdateViewLock(!0),this.isDirty("disabled")&&this._applyReadOnly(),e.prototype._applyProperties.call(this,t),this.isDirty("treeDocument")&&this._applyTreeDocument(t.treeDocument),this.isDirty("readOnly")&&this._applyReadOnly(),this.__pushUpdateViewLock(!1)},t.prototype._applyReadOnly=function(){this._updateView()},t.prototype._applyDisabled=function(){this._updateView()},t.prototype._applyTouchMode=function(){e.prototype._applyTouchMode.call(this),this._updateView()},t.prototype._applyTreeDocument=function(e){var t;e&&!e.isDestroyed()&&(b.call(this,e),t=this,e.processDescendants({onlyVisibleNodes:!1,processNode:function(e){v(t,e.nodeModel)}})),this.treeDocument&&this._createView(),this._manageCss()},t.prototype._updateView=function(){return!(this.__isUpdateViewLocked()||!this.treeDocument||!this._isInsertedInDom)&&(this.__completeUpdateView(),!0)},t.prototype.__completeUpdateView=function(){var e=this;this._updateViewInProgress=!0,this.treeDocument.processDescendants({onlyVisibleNodes:!0,processNode:function(t){var i=t.nodeModel;h(e,i)}}),this._updateViewInProgress=!1},t.prototype.__pushUpdateViewLock=function(e){this.__updateViewLock=this.__updateViewLock+(e?1:-1),0===this.__updateViewLock&&this._updateView()},t.prototype.__isUpdateViewLocked=function(){return 0!==this.__updateViewLock},t.prototype._addTreeDocumentSubscriptions=function(e){var t=this;e&&(this._onNodeModelUpdateSubscribed||(this._onNodeModelUpdateSubscribed=!0,this._treeDocumentSubscription.push(e.onNodeModelUpdate((function(e){var i,o,n,r,a,l;if(!t._updateViewInProgress){var s=e.target;if(s){var d=s.getAttributeValue("expandedFlag");void 0!==d&&d!==s.isExpanded()&&(d?s.expand():s.collapse()),(null===(o=null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.attributes)||void 0===o?void 0:o.hasOwnProperty("value"))&&(s.options.grid._liveValue=e.data.attributes.value),t._isInsertedInDom&&h(t,s,e);var u=!1,c=void 0;if(e.data&&e.data.attributes&&e.data.attributes.hasOwnProperty("invalidFlag")){var p=(b=e.data.previousAttributes&&e.data.previousAttributes.hasOwnProperty("invalidFlag")?e.data.previousAttributes.invalidFlag:void 0)||!1===s.__tweakerValidState,v=e.data.attributes.invalidFlag||!1===s.__tweakerValidState;p!==v&&(u=!0,c=v)}if((!u||!c)&&(null===(r=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.attributes)||void 0===r?void 0:r.hasOwnProperty("requiredFlag")))(void 0===(g=s.getAttributeValue("value"))||""===g||Array.isArray(g)&&!g.length)&&(u=!0,c=Boolean(e.data.attributes.requiredFlag));if((!u||!c)&&(null===(l=null===(a=null==e?void 0:e.data)||void 0===a?void 0:a.attributes)||void 0===l?void 0:l.hasOwnProperty("value"))&&s.getAttributeValue("requiredFlag")){var f=void 0===(b=e.data.previousAttributes&&e.data.previousAttributes.hasOwnProperty("value")?e.data.previousAttributes.value:void 0)||""===b||Array.isArray(b)&&!b.length,m=e.data.attributes.value,y=void 0===m||""===m||Array.isArray(m)&&!m.length;f!==y&&(u=!0,c=y)}if(u&&t._modelEvents.publish({event:"invalidityChange",data:c,context:t}),e.data&&e.data.attributes&&e.data.attributes.hasOwnProperty("value")){var g=e.data.attributes.value,b=e.data.previousAttributes&&e.data.previousAttributes.hasOwnProperty("value")?e.data.previousAttributes.value:void 0;t._modelEvents.publish({event:"nodeUpdate",data:{nodeModel:s,value:g,oldValue:b},context:t})}}}})))),this._isInsertedInDom&&(this._treeDocumentSubscription.push(e.addEventListener("addChild",(function(e){var i=e.data.nodeModel;i&&(p(t,i),i.processDescendants({treeTraversalOrder:"preOrder",processNode:function(e){p(t,e.nodeModel)}}))}))),this._treeDocumentSubscription.push(e.addEventListener("removeChild",(function(e){var i=e.data.nodeModel;i&&(v(t,i),i.processDescendants({processNode:function(e){v(t,e.nodeModel)}}))}))),this._treeDocumentSubscription.push(e.addEventListener("collapse",y.bind(this))),this._treeDocumentSubscription.push(e.addEventListener("expand",y.bind(this))),this._treeDocumentSubscription.push(e.addEventListener("hide",g.bind(this))),this._treeDocumentSubscription.push(e.addEventListener("show",g.bind(this)))))},t.prototype._createView=function(){var e=this;this._isInsertedInDom&&(s.pushLockTweakerToGenerate(this,!0),this.treeDocument.processDescendants({onlyVisibleNodes:!0,processNode:function(t){var i=t.nodeModel,o=u(e,i);e.elements.container.appendChild(o)}}),this._addTreeDocumentSubscriptions(this.treeDocument),s.pushLockTweakerToGenerate(this,!1))},t.prototype._getLayoutDensity=function(){return this.getContent().offsetWidth<s.getSizeMap().large?"compact":"large"},t.prototype._getNodeInvalidState=function(e){var t=e.getAttributeValue("invalidFlag"),i=s.getInvalidStateConsideringRequiredFlagOnly(e);return t||!1===e.__tweakerValidState||i},t.prototype._onAllCellsRendered=function(){this.fire("allCellsRendered")},t.prototype._setValidateClicked=function(e){var t=this;this.invalidDisplayPolicy!==a.InvalidDisplayPolicy.OnValidate&&this.invalidDisplayPolicy!==a.InvalidDisplayPolicy.OnInput||(this._hasBeenValidatedOnce=e,this.treeDocument.processDescendants({onlyVisibleNodes:!1,processNode:function(e){var i=e.nodeModel;i.__shouldDisplayInvalidState=t._getNodeInvalidState(i)}}),this._updateView())},t.prototype._updateInvalidStateFromTweaker=function(e,t){if(e&&e.options){var i=t,o=e.__tweakerValidState,n=e.getAttributeValue("invalidFlag");e.__tweakerValidState=i;var r=n||!1===i;(n||!1===o)!==r&&(h(this,e,{data:{attributes:{invalidFlag:n}}}),this._modelEvents.publish({event:"invalidityChange",data:r,context:this}))}},t.prototype._computeInvalidityStatus=function(e){if(!e)return{invalidState:!0,shouldDisplay:!1};var t=this._getNodeInvalidState(e);return this.invalidDisplayPolicy===a.InvalidDisplayPolicy.Never?{invalidState:t,shouldDisplay:!1}:e.__forceInvalidStateDisplay?{invalidState:t,shouldDisplay:!0}:this.invalidDisplayPolicy!==a.InvalidDisplayPolicy.OnValidate||this._hasBeenValidatedOnce?this.invalidDisplayPolicy===a.InvalidDisplayPolicy.OnValidate||this.invalidDisplayPolicy===a.InvalidDisplayPolicy.OnInput?{invalidState:t,shouldDisplay:Boolean(t&&e.__shouldDisplayInvalidState)}:this.invalidDisplayPolicy===a.InvalidDisplayPolicy.Always?{invalidState:t,shouldDisplay:t}:void 0:{invalidState:t,shouldDisplay:!1}},t.prototype._manageCss=function(){0===l.getTreeDocumentDepth(this.treeDocument)?this.getContent().addClassName("wux-form-flatform"):this.getContent().removeClassName("wux-form-flatform")},t}(o);function u(e,t){var i=document.createElement("div");i.classList.add("wux-form-cell"),i.setAttribute("form-id",s.getIdFromNodeModel(t));var o=c(t);o&&i.setAttribute("typeRepresentation",o),s.createFormCellView(e,t,{parentHTMLElement:i});var n=t.getNodeDepth();return i.style.paddingLeft=n?(7*n).toString()+"px":"",i}function c(e){return e.getAttributeValue("typeRepresentation")}function p(e,t){if(t.isVisible()){for(var i=u(e,t),o=void 0,n=t;!o&&(n=n.getNextVisibleNode());)o=m(e,s.getIdFromNodeModel(n));o?e.getContent().insertBefore(i,o):e.getContent().appendChild(i)}}function h(e,t,i){if(t)if(t.isVisible()){var o=m(e,s.getIdFromNodeModel(t));if(o){var n=void 0;i&&(n=Object.assign({},i.data.attributes));var r=s.isSection(t),a=s.getLabelContainerFromFormCell(o),l=null==n?void 0:n.hasOwnProperty("label");if(n&&!l||(s.setLabelInFormCell(o,t),n&&delete n.label),r)return void s.updateSectionStyle(o,t);var d=null==n?void 0:n.hasOwnProperty("requiredFlag");if((!n||l||d||n.hasOwnProperty("requiredTooltip"))&&(s.updateRequired(o,t),n&&(delete n.requiredFlag,delete n.requiredTooltip)),!n||n.hasOwnProperty("invalidFlag")||n.hasOwnProperty("invalidTooltip")||l||d||n.hasOwnProperty("value")){var u=e._computeInvalidityStatus(t);t.__shouldDisplayInvalidState=u.invalidState&&u.shouldDisplay,s.updateValidityIcons(o,e,t),n&&(delete n.invalidFlag,delete n.invalidTooltip)}if(n&&!n.hasOwnProperty("moreInformation")||a&&s.updateInfoIcons(o,t),n&&!n.hasOwnProperty("helpText")||s.updateHelpText(o,t),!n||Object.keys(n).length>0){var h=s.getTweakerFromFormCell(o);if(h)if(function(e){return e.getAttribute("typeRepresentation")||void 0}(o)!==c(t)){var f=h.getContent().parentElement;h&&h.destroy(),s.generateTweakerForForm(e,t,{parentHTMLElement:f}),o.setAttribute("typeRepresentation",c(t))}else s.updateTweakerProperties(h,t,{readOnly:e.readOnly,disabled:e.disabled,touchMode:e._getCurrentTouchMode()})}}else p(e,t)}else v(e,t)}function v(e,t){if(t){var i=m(e,s.getIdFromNodeModel(t));if(i){var o=s.getTweakerFromFormCell(i);o&&o.destroy(),i.remove()}}}function f(e,t){var i=n.firstParentWithClassUntilRoot(t.target,"wux-form-cell",e.elements.container);if(i){var o=i.getAttribute("form-id");if(void 0!==o)return s.getNodeModelWithId(o,e.treeDocument)}}function m(e,t){return e.getContent().getElement('.wux-form-cell[form-id="'+t+'"]')}function y(e){var t=this;if(e&&e.target){var i=e.target,o=e.target.isExpanded(),n=s.getIdFromNodeModel(i);!function(e,t){var i=e.getElementsByClassName("section-expander");i&&1===i.length&&i[0].setAttribute("state",t?"expanded":"collapsed")}(m(this,n),o),i.processDescendants({processNode:function(e){if(e&&e.nodeModel){var i=s.getIdFromNodeModel(e.nodeModel);if(i!==n){var r=m(t,i);r?(r.style.display=o?"":"none",h(t,e.nodeModel)):p(t,e.nodeModel)}}}})}}function g(e){if(e&&e.target){var t=this,i=e.target;h(t,i),i.processDescendants({processNode:function(e){e&&e.nodeModel&&h(t,e.nodeModel)}})}}function b(e){for(var t=this._treeDocumentSubscription.length-1;t>=0;t--)e.unsubscribe(this._treeDocumentSubscription[t]);this._onNodeModelUpdateSubscribed=!1}return i.addClass(d,"formLayout"),d}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/Form/Form",["require","exports","DS/Form/FormLayout","DS/Form/PrivateFormUtils","DS/Form/FormUtils","DS/Core/WebUXComponents","DS/Controls/Abstract","DS/Controls/Button","DS/Utilities/Dom","DS/Utilities/Utils","DS/CoreBase/WebUXGlobalEnums","DS/Utilities/TreeUtils"],(function(e,t,i,o,n,r,a,l,s,d,u,c){"use strict";var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{model:{defaultValue:void 0,type:"Array<WUX.FormModelItem>",category:"Appearance"},buttons:{defaultValue:void 0,type:"Array<Object>",category:"Appearance"},readOnly:{defaultValue:!1,type:"boolean",category:"Appearance"},globalInformation:{defaultValue:void 0,type:"Object",category:"Appearance"},onModelUpdate:{defaultValue:void 0,noNeedToApplyFlag:!0,type:"function",category:"Behavior"},onModelLiveUpdate:{defaultValue:void 0,noNeedToApplyFlag:!0,type:"function",category:"Behavior"},activateButtonsIfActionPerformed:{defaultValue:!0,type:"boolean",category:"Behavior"},usePaddingFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},invalidDisplayPolicy:{readOnly:!0,defaultValue:u.InvalidDisplayPolicy.OnValidate,type:"WUX.InvalidDisplayPolicy",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.getModelItem=function(e){return o.getModelItem(this._getTreeDocument(),e)},t.prototype.getCompleteModel=function(){return o.getModelItem(this._getTreeDocument())},t.prototype.traverseLeafItems=function(e){var t=this.getCompleteModel();c.processTreeIterative("root",{getChildrenFunction:function(e){return"root"===e?t:e.children?e.children:void 0}},(function(t){n.isFormModelLeafItem(t)&&e.callback(t)}))},t.prototype.updateModelItem=function(e,t){var i=o.getNodeModelWithId(e,this._getTreeDocument());i&&(t.hasOwnProperty("id")&&(window.console.warn("The id property cannot be modified on nodemodel with label: "+i.getLabel()),delete t.id),t.hasOwnProperty("label")&&(i.setLabel(t.label),delete t.label),i.updateOptions({grid:t}),t&&t.hasOwnProperty("visibleFlag")&&(t.visibleFlag&&i.isHidden()?i.show():t.visibleFlag||i.isHidden()||i.hide()))},t.prototype.updateButton=function(e,t){var i=this.elements._bottomArea.children,o=i.length>e?i[e].dsModel:void 0;o=v(t,{button:o,parentElement:this.elements._bottomArea});var n=t.role;n&&n===window.WUXCustomButtonRoleEnum.Validate?this._validationButton=o:n&&n===window.WUXCustomButtonRoleEnum.Escape&&(this._escapeButton=o)},t.prototype.addModelItem=function(e,t,i){if(void 0===t&&(t=void 0),void 0===i&&(i="last"),t||"before"!==i&&"after"!==i){var n=this._getTreeDocument(),r=null;if(r=t?o.getNodeModelWithId(t,n):n._getTrueRoot()){var a=Array.isArray(e)?e:[e];o.completeNodeModelFromJSArray(r,a,i)}}else window.console.warn("No parent item specified when trying to add new items 'before' or 'after'")},t.prototype.removeModelItem=function(e){var t=this;(Array.isArray(e)?e:[e]).forEach((function(e){var i=o.getNodeModelWithId(e,t._getTreeDocument());i&&i.remove()}))},Object.defineProperty(t.prototype,"invalidState",{get:function(){return this._invalidState},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-layouts-form"),this.elements._formViewContainer=document.createElement("div"),this.elements._formViewContainer.classList.add("wux-form-formViewContainer"),this.elements.container.appendChild(this.elements._formViewContainer)},t.prototype._postBuildView=function(){var e=this;this.elements._formView=new i({treeDocument:this._getTreeDocument(),readOnly:this.readOnly,disabled:this.disabled,touchMode:this.touchMode,invalidDisplayPolicy:this.invalidDisplayPolicy});var t=function(){var t=!1;if(e._treeDocument=e._getTreeDocument(),e._treeDocument){var i=e._getView();e._treeDocument.processDescendants({processNode:function(e){var o=i._getNodeInvalidState(e.nodeModel);return t||(t=o),{stopProcessing:o}}})}return t};this.elements._formView.subscribe({event:"invalidityChange"},(function(i){var o=i.data;!o&&e._invalidState&&(o=t()),e._invalidState=o})),this._invalidState=t();var o=function(t,i,o){if(i||o){var n=t.nodeModel.getAttributeValue("id"),r=t.value,a=t.oldValue;if("function"==typeof i)i.call(e,{id:n,value:r,oldValue:a});else if("object"==typeof i&&i.func&&i.module){var l=i.argument||{};d.isPlainObject(l)&&(l.id=n,l.value=r,l.oldValue=a),d.attachSimpleCallback(i.module,i.func,i.argument)}o&&"function"==typeof o&&o.call(e,{id:n,value:r,oldValue:a})}};this.elements._formView.subscribe({event:"nodeUpdate"},(function(t){o(t.data,t.data.nodeModel.getAttributeValue("onNodeUpdate"),e.onModelUpdate)})),this.elements._formView.subscribe({event:"nodeLiveUpdate"},(function(t){o(t.data,t.data.nodeModel.getAttributeValue("onNodeLiveUpdate"),e.onModelLiveUpdate)})),this.elements._formView.inject(this.elements._formViewContainer)},t.prototype.handleEvents=function(){var e=this;s.addEventOnElement(this,this.elements._formViewContainer,"keydown",(function(t){if(e.activateButtonsIfActionPerformed||!t.actionPerformed){var i=null;switch(t.code){case"Enter":i=e._validationButton;break;case"Escape":i=e._escapeButton}i&&i.elements.button.click()}}))},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("model")&&this._applyModel(t.model),this.isDirty("buttons")&&this._applyButtons(t.buttons),this.isDirty("readOnly")&&this._applyReadOnly(t.readOnly),this.isDirty("globalInformation")&&!this.isDirty("model")&&this._applyGlobalInformation(t.globalInformation),this.isDirty("usePaddingFlag")&&this._applyUsePaddingFlag(t.usePaddingFlag)},t.prototype._applyModel=function(e){var t=this._treeDocument;this._treeDocument=void 0,this._treeDocument=this._getTreeDocument();var i=this._getView();i&&(i.treeDocument=this._treeDocument),t&&t.destroy()},t.prototype._applyButtons=function(e){if(this._removeButtonCallbacks(),Array.isArray(this.buttons)){this.elements._bottomArea||(this.elements._bottomArea=document.createElement("div"),this.elements._bottomArea.classList.add("wux-form-bottomArea"),this.getContent().appendChild(this.elements._bottomArea));var t=this.elements._bottomArea.children;this._validationButton=void 0,this._escapeButton=void 0;for(var i=0;i<this.buttons.length;i++){var o=t.length>i?t[i].dsModel:void 0,n=this.buttons[i];o=v(n,{button:o,parentElement:this.elements._bottomArea});var r=n.role;r&&r===window.WUXCustomButtonRoleEnum.Validate?this._validationButton=o:r&&r===window.WUXCustomButtonRoleEnum.Escape&&(this._escapeButton=o)}h(this.elements._bottomArea,this.buttons.length)}else h(this.elements._bottomArea,0),this.buttons&&(this._validationButton=this.buttons.Validate,this._escapeButton=this.buttons.Escape);this._setButtonCallbacks()},t.prototype._applyReadOnly=function(e){this._getView()&&(this._getView().readOnly=this.readOnly)},t.prototype._applyDisabled=function(e){this._getView()&&(this._getView().disabled=this.disabled)},t.prototype._applyTouchMode=function(t){e.prototype._applyTouchMode.call(this,t),this._getView()&&(this._getView().touchMode=this.touchMode)},t.prototype._applyGlobalInformation=function(e){o.updateGlobalInformation(this._treeDocument,this.globalInformation)},t.prototype._applyUsePaddingFlag=function(e){this.usePaddingFlag?this.getContent().setAttributeNode(document.createAttribute("use-padding")):this.getContent().removeAttribute("use-padding")},t.prototype._getView=function(){return this.elements._formView},t.prototype._getTreeDocument=function(){return this._treeDocument?this._treeDocument:o.createFormModelFromJSArray(this.model,{globalInformation:this.globalInformation})},t.prototype._removeButtonCallbacks=function(){this._validationButton&&this._validationClickedToken&&(this._getView()&&this._getView()._setValidateClicked(!1),s.removeEventOnElement(this,this._validationButton.getContent(),"buttonclick",this._validationClickedToken))},t.prototype._setButtonCallbacks=function(){var e=this;this._validationButton&&(this._validationClickedToken=s.addEventOnElement(this,this._validationButton,"buttonclick",(function(t){e._getView()&&e._getView()._setValidateClicked(!0)})))},t}(a);function h(e,t){if(e){var i=e.children;if(i.length>t)for(var o=i.length-1;o>=t;o--)i[o].dsModel.remove(),i[o].dsModel.destroy()}}function v(e,t){var i=t&&t.button?t.button:void 0;return i?i.setProperties(e):(i=new l(e),t&&t.parentElement&&i.inject(t.parentElement)),i}return r.addClass(p,"form"),p}));