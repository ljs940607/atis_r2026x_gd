define("DS/DMUExperienceAPI/DMUExperienceImporterAPI",["UWA/Class","DS/DMUBaseUIControllers/DMUReviewContextInitializer","DS/DMUBaseExperience/EXPImportServices","DS/DMUBaseUIServices/DMUSlidePreferences","DS/DMUBaseExperience/EXPUtils","DS/DMUMeasurable/DMUToolsSceneGraph","DS/DMUBaseUIControllers/DMUSlidesController","DS/DMUBaseExperience/DMUContextManager","DS/DMUBaseUIControllers/DMUSceneDisplayController"],(function(e,t,n,r,i,o,a,s,l){"use strict";return e.extend({init:function(e){var c,u=e||{},d=u.context,g=this;d&&u.markupsLinkedTo3DXmlModels&&(c=d.getViewer().getIdPathMatcher(),o.initIdPathMatcher(d.getViewer())),this.importModel=async function(o){if(d&&o&&(o.json||o.markupStream)){o.json&&window.console.warn('============ DMUExperienceImporterAPI.importModel - "json" is a DEPRECATED attribute. Please use "markupStream" instead ============'),g.removeModel();var s=await t.createReviewContext({context:d});if(o.rootIds&&o.rootIds.length){const e=l.giveDMUSceneDisplayController({context:d});e&&e.setRootIds(o.rootIds)}var c="boolean"!=typeof e.bDisplayNominal||e.bDisplayNominal,u="boolean"!=typeof e.bDisplayInWork||e.bDisplayInWork,p="boolean"!=typeof e.displayDMUSlidePanel||e.displayDMUSlidePanel;r.setSlidePreferences({context:d.getFrameWindow(),preferences:{displayNominal:c,displayInWork:u,panelTitle:e.thumbnailListTitle,displaySlidePanel:p,beforeApplySlideCB:e.beforeApplySlideCB,afterApplySlideCB:e.afterApplySlideCB}});var D=o.markupStream?JSON.parse(i.cleanJSONString(o.markupStream)):o.json;if(s&&D.Model){var M=new n({viewer:d.getViewer(),experience:s,appType:"3dPlay"});M.importDataModel(D,(function(t){if(M.postImport(),s.setCurrentSessionMarkup(t[0].getMarkupContent?t[0].getMarkupContent():t[0]),s.setReadOnly(!0),s.getCurrentSessionMarkup()){var n=a.giveDMUSlidesController({context:d.getFrameWindow()});if(n){var i=s.getCurrentSessionMarkup().getSlides();if(i&&i.length){if(o.slideUUIDs&&o.slideUUIDs.length)for(var l=o.slideUUIDs.slice(),u=c?1:0;u<i.length&&l.length;u++)i[u].getAttribute("bInWork")||(i[u].setAttribute("sUuid",l[0]),n.updateSlide(i[u],{uuid:l[0]}),l.splice(0,1));o.doNotDisplayFirstSlide||i[0]&&n.setActiveSlide(i[0]),p&&!e.thumbnailListTitle&&r.setSlidePreferences({context:d.getFrameWindow(),preferences:{panelTitle:s.getCurrentSessionMarkup().getAttribute("sName")}})}}}o.onModelLoadedCB&&o.onModelLoadedCB({uuidMappingTable:M.getUUIDMappingTable()})}))}}},this.removeModel=function(){d&&(r.removeSlidePreferences({context:d.getFrameWindow()}),s.removeReviewContext({context:d}))},this.destroyDMUImporter=function(){u.markupsLinkedTo3DXmlModels&&d&&d.getViewer().setIdPathMatcher(c)}}})})),define("DS/DMUExperienceAPI/DMUOptionsManager",["DS/DMUBaseExperience/DMUContextManager","DS/DMUBaseUIControllers/DMUReviewContextInitializer"].concat(["DS/CATWebUXComponents/DMUCommandsManager"]),(function(e,t,n){"use strict";var r={setDMUUnit:async function(n){if(n.context&&n.parameter){var i=e.getReviewContext(n);if(i||(i=await t.createReviewContext(n)),i){var o=r.getDMUUnit(n);i.getDMUPreferenceRepository().setPreference(n.parameter,n.unit),o!==r.getDMUUnit(n)&&(i.getCurrentSessionMarkup()&&i.getCurrentSessionMarkup().refreshNode(),i.getTransientReviewBag()&&i.getTransientReviewBag().refreshNode(),n.context.getViewer().render())}}},getDMUUnit:function(t){if(t.context&&t.parameter){var n=e.getReviewContext(t);return n?n.getDMUPreferenceRepository().getPreference(t.parameter):void 0}},setCommandMode:function(e){if(e.context&&e.cmdHeader){var t=n.getCommand(e.cmdHeader,e.context.getCommandContext());t&&t.setCommandMode(e.mode)}}};return r})),define("DS/DMUExperienceAPI/DMUWebDesignReviewMarkerServices",["DS/DMUBaseExperience/DMUContextManager","DS/Selection/CSOManager","DS/Selection/HSOManager"],(function(e,t,n){"use strict";return{selectDMUObjects:function(n){if(n&&n.context&&n.uuids&&n.uuids.length){var r=e.getReviewContext(n);if(r){var i=r.getCurrentSessionMarkup();if(i){var o=[],a=[i];a=a.concat(i.getOccurrenceOverloaders());var s=i.getSlides();s.forEach((function(e){a=a.concat(e.getDMUObjects())})),(s=i.getFormats()).forEach((function(e){a=a.concat(e.getDMUObjects())})),a.forEach((function(e){e&&e.getPathElement&&e.getAttribute&&-1!==n.uuids.indexOf(e.getAttribute("sUuid"))&&o.push({pathElement:e.getPathElement()})})),o.length&&t.add(o)}}}},getSelectedDMUObjectIDs:function(n){if(n&&n.context){var r=[],i=e.getReviewContext(n);if(i){var o=i.getCurrentSessionMarkup();if(o)t.get().forEach((function(e){var t=o.getDMUObjectFromPathElement(e.pathElement);t&&t.getAttribute("sUuid")&&r.push(t.getAttribute("sUuid"))}))}return r}},highlightDMUObjects:function(t){if(t&&t.context&&t.uuids&&t.uuids.length){var r=e.getReviewContext(t);if(r){var i=r.getCurrentSessionMarkup();if(i){var o=[],a=[i];a=a.concat(i.getOccurrenceOverloaders());var s=i.getSlides();s.forEach((function(e){a=a.concat(e.getDMUObjects())})),(s=i.getFormats()).forEach((function(e){a=a.concat(e.getDMUObjects())})),a.forEach((function(e){e&&e.getPathElement&&e.getAttribute&&-1!==t.uuids.indexOf(e.getAttribute("sUuid"))&&o.push({pathElement:e.getPathElement()})})),o.length&&n.add(o)}}}},getHighlightedDMUObjectIDs:function(t){if(t&&t.context){var r=[],i=e.getReviewContext(t);if(i){var o=i.getCurrentSessionMarkup();if(o)n.get().forEach((function(e){var t=o.getDMUObjectFromPathElement(e.pathElement);t&&t.getAttribute("sUuid")&&r.push(t.getAttribute("sUuid"))}))}return r}},getDMUObjectIDsFromPathElements:function(t){if(t&&t.context&&t.pathElements){var n=[],r=e.getReviewContext(t);if(r){var i=r.getCurrentSessionMarkup();i&&t.pathElements.forEach((function(e){var t=i.getDMUObjectFromPathElement(e);t&&t.getAttribute("sUuid")&&n.push(t.getAttribute("sUuid"))}))}return n}}}})),define("DS/DMUExperienceAPI/DMUExperienceAPI",[],(function(){})),define("DS/DMUExperienceAPI/DMUWebDesignReviewSlideServices",["DS/DMUBaseExperience/DMUContextManager","DS/DMUBaseUIControllers/DMUSlidesController"],(function(e,t){"use strict";return{applySlide:function(n){if(n&&n.context&&n.uuid){var r=e.getReviewContext(n);if(r){var i=r.getCurrentSessionMarkup();if(i){for(var o=null,a=i.getSlides(),s=0;s<a.length;s++)if("Nominal"!==n.uuid&&a[s].getAttribute("sUuid")===n.uuid||"Nominal"===n.uuid&&!a[s].getAttribute("sUuid")){o=a[s];break}var l=t.giveDMUSlidesController({context:n.context.getFrameWindow()});l?l.setActiveSlide(o,{duration:n.duration,afterSlideActivationCB:n.onSlideActivated}):t.setActiveSlide({context:n.context,slide:o,duration:n.duration,onSlideActivated:n.onSlideActivated})}}}},getSlidesDefinition:function(t){var n=[];if(!t||!t.context)return n;var r=e.getReviewContext(t);if(r){var i=r.getCurrentSessionMarkup();if(i)for(var o=i.getSlides(),a=0;a<o.length;a++)n.push({name:o[a].getAttribute("sName"),uuid:o[a].getAttribute("sUuid"),preview:o[a].getPreview(),inWork:o[a].getAttribute("bInWork")})}return n}}}));