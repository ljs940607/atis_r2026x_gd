define("DS/MPFTcContractComponent/NdaAcceptanceModal",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle","DS/MPFServices/ObjectService","DS/MPFTCContractModel/TCContractModel","DS/MPFTcDocumentModel/TcDocumentModel","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent"],(function(t,e,n,o,c,i,s,r,a,l){"use strict";const h=Object.freeze({NDA_ACCEPTED:"ndaAccepted",NDA_CANCELED:"ndaCanceled"}),u=e.extend({className:"mpf-nda-acceptance-modal",setup:function(t={}){s.requiredOfPrototype(t.ndaContract,r,"options.ndaContract must be a TCContractModel"),s.requiredOfPrototype(t.ndaDocument,a,"options.ndaDocument must be a TcDocumentModel"),this.ndaContract=t.ndaContract,this.ndaDocument=t.ndaDocument,this.toggle=this._createAcceptToogle(),this.acceptButton=this._createAcceptButton(),this.cancelButton=this._createCancelButton(),this.modal=this._createModal(this.toggle,this.acceptButton,this.cancelButton)},render:function(){return this.container.setContent(this.modal),this},show:function(){this.modal.show()},hide:function(){this.modal.hide()},_createAcceptToogle:function(){return new i({className:"primary nda-acceptance-toggle",type:"checkbox",label:l.get("ndaToggleLabel"),events:{onChange:this._updateAcceptButtonState.bind(this)}})},_createAcceptButton:function(){return new c({className:"primary",value:l.get("accept"),disabled:!0,events:{onClick:this._onClickAccept.bind(this)}})},_createCancelButton:function(){return new c({value:l.get("cancel"),events:{onClick:this._onClickCancel.bind(this)}})},_createModal:function(e,n,c){return new o({closable:!1,header:t.createElement("h4",{text:l.get("ndaAcceptance")}),body:[t.createElement("div",{text:l.get("ndaExplanation")}),t.createElement("a",{text:l.get("ndaDownloadLink"),href:this.ndaDocument.getDocUrl(),target:"_blank"}),e],footer:[n,c]})},_updateAcceptButtonState:function(){this.toggle.isChecked()?this.acceptButton.enable():this.acceptButton.disable()},_onClickAccept:function(){const t={};return t[r.FIELDS.CURRENT_STATE]=r.STATUS.inEffect,n.mask(this.modal.getBody()),this.ndaContract.savePromise(t,{patch:!0}).then((()=>{this.dispatchEvent(h.NDA_ACCEPTED),this.hide()})).finally((()=>{n.unmask(this.modal.getBody())}))},_onClickCancel:function(){this.dispatchEvent(h.NDA_CANCELED),this.modal.hide()},destroy:function(){this.ndaDocument=null,this.ndaContract=null,this.toggle=null,this.acceptButton=null,this.cancelButton=null,this.modal=null,this._parent(),this.container=null}});return u.Events=h,u})),define("DS/MPFTcContractComponent/TermsOfUseOrderList",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFTcDocumentModel/TCDocumentFactory","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],(function(t,e,n,o,c){"use strict";return e.extend({className:"mpf-terms-order-list",setup:function(t={}){this._parent(t),n.requiredOfPrototype(t.tcDocumentFactory,o,"options.tcDocumentFactory must be a TCDocumentFactory"),this.sellerView=!0===t.sellerView,this.tcDocumentFactory=t.tcDocumentFactory,this.model=this.sellerView?this.tcDocumentFactory.createModel(o.Types.DS_SELLERS):this.tcDocumentFactory.createModel(o.Types.DS_BUYERS)},render:function(){return this._getLink().then((t=>{this.container.setContent(t)})),this},_getLink:function(){let e;return e=this.sellerView?c.get("dsTermsOfUseSellersOrderList"):c.get("dsTermsOfUseBuyersOrderList"),this.model.fetchPromise().then((function(n){return t.createElement("a",{target:"_blank",href:n.getDocUrl(),html:e})}))}})})),define("DS/MPFTcContractComponent/SellerSalesConditionsOrder",["UWA/Core","UWA/String","UWA/Class/View","DS/UIKIT/Badge","DS/UIKIT/Mask","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFTCContractModel/TCContractFactory","DS/MPFTcDocumentModel/TCDocumentFactory","DS/MPFTcDocumentModel/TcDocumentModel","DS/MPFTCContractModel/TCContractModel","DS/MPFShopModel/ShopModel","DS/MPFBiddingContractQuoteNoteComponent/BiddingContractSection","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],(function(t,e,n,o,c,i,s,r,a,l,h,u,d,m){"use strict";return d.extend({setup:function(t={}){t.additionalClassName="mpf-order-info-row",this._checkPrototypes(t),this._parent(t),this.sellerView=!0===t.sellerView,this.shop=t.shop,this.tcContractFactory=t.tcContractFactory,this.tcDocumentFactory=t.tcDocumentFactory,this.salesContract=t.salesContract,this.salesDocument=t.salesDocument,this.service=t.service||s.MAKE},createTitle:function(){return this.sellerView?m.get("yourSalesConditions"):e.format(m.get("salesConditionsLabName"),this.shop.getName())},createLink:function(){if(t.is(this.salesDocument))return t.createElement("a",{target:"_blank",href:this.salesDocument.getDocUrl(),text:m.get("download")})},createBody:function(){return this.sellerView?t.is(this.salesContract)&&!this.salesContract.isNew()?this.salesContract.getCurrentState()===h.STATUS.draft?new o({closable:!0,content:m.get("alreadyUploaded"),events:{onClose:this._onCloseBadge.bind(this)}}):new o({closable:!1,content:m.get("specificUploaded")}):t.is(this.salesDocument)?e.format(m.get("salesConditionsLab"),this.shop.getName()):m.get("noSpecificSalesConditions"):t.is(this.salesContract)&&!this.salesContract.isNew()?m.get("specificConditions"):e.format(m.get("salesConditionsLab"),this.shop.getName())},_onCloseBadge:function(){if(this.salesContract.getCurrentState()===h.STATUS.draft)return c.mask(this.container),this.salesContract.savePromise({[h.FIELDS.CURRENT_STATE]:h.STATUS.archived},{patch:!0}).then(this._getLabSalesConditions.bind(this)).then(c.unmask.bind(c,this.container))},_getLabSalesConditions:function(){if(this.salesContract=this.tcContractFactory.createModel(r.Types.CUSTOM_TC_SELLER),t.is(this.shop.getService(this.service)["contract-documents"][0]))return this.salesDocument=this.tcDocumentFactory.createModel(a.Types.DOCUMENTS,{id:this.shop.getService(this.service)["contract-documents"][0].id}),this.salesDocument.fetchPromise().then(this.render.bind(this));delete this.salesDocument,this.render()},_checkPrototypes:function(e){i.requiredOfPrototype(e.shop,u,"options.shop must be a ShopModel"),i.requiredOfPrototype(e.tcContractFactory,r,"options.tcContractFactory must be a TCContractFactory"),i.requiredOfPrototype(e.tcDocumentFactory,a,"options.tcDocumentFactory must be a TCDocumentFactory"),i.requiredOfPrototype(e.salesDocument,l,"options.salesDocument must be a TCDocumentModel"),t.is(e.salesContract)&&i.requiredOfPrototype(e.salesContract,h,"options.salesContract must be a TCContractModel")}})})),define("DS/MPFTcContractComponent/SalesConditionsBuyerPayment",["UWA/Core","UWA/Class/View","DS/UIKIT/Input/Toggle","DS/MPFServices/ObjectService","DS/MPFShopModel/ShopModel","DS/MPFTCContractModel/TCContractModel","DS/MPFTcDocumentModel/TCDocumentFactory","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],(function(t,e,n,o,c,i,s,r){"use strict";const a=Object.freeze({CHECKED:"checked",UNCHECKED:"unchecked"}),l=e.extend({className:"mpf-tc-contract-payment",setup:function(t={}){this._checkPrototypes(t),this._parent(t),this.shopModel=t.shopModel,this.tcDocumentFactory=t.tcDocumentFactory,this.tcContract=t.tcContract,this.tcDocument=this.tcDocumentFactory.createModel(s.Types.DOCUMENTS,{id:this.tcContract.getDocumentID()}),this.checkbox=this._createCheckbox()},render:function(){return this._getLink().then((e=>{this.container.setContent([this.checkbox,t.createElement("div",{class:"labelTerms",html:[r.get("agree")+"&nbsp;",e,"&nbsp;"+r.get("provided")+"&nbsp;",this.shopModel.getName()]})])})).catch((t=>console.error(t))),this},_createCheckbox:function(){const t=this;return new n({type:"checkbox",label:"",className:"mpf-entry mpf-toggle primary",events:{onChange:function(){this.isChecked()?t.dispatchEvent(a.CHECKED):t.dispatchEvent(a.UNCHECKED)}}})},_getLink:function(){return this.tcDocument.fetchPromise().then((function(e){return t.createElement("a",{href:e.getDocUrl(),target:"_blank",html:r.get("salesConditions")})}))},isChecked:function(){return this.checkbox.isChecked()},signContract:function(){const t={};if(this.isChecked())return t[i.FIELDS.CURRENT_STATE]=i.STATUS.inEffect,this.tcContract.savePromise(t,{patch:!0})},_checkPrototypes:function(t){o.requiredOfPrototype(t.shopModel,c,"options.shopModel must be a ShopModel"),o.requiredOfPrototype(t.tcDocumentFactory,s,"options.tcDocumentFactory must be a TCDocumentFactory"),o.requiredOfPrototype(t.tcContract,i,"options.tcContract must be a TCContractModel")}});return l.Events=a,l})),define("DS/MPFTcContractComponent/AddNdaComponent",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/UIKIT/Alert","DS/UIKIT/Input/File","DS/MPFUtils/FormatUtils","DS/MPFServices/ObjectService","DS/MPFTCContractModel/TCContractFactory","DS/MPFTCContractModel/TCContractModel","DS/MPFTcDocumentModel/TcDocumentModel","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent"],((t,e,n,o,c,i,s,r,a,l,h)=>{"use strict";const u=31457280,d=["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/pdf"];return e.extend({className:"mpf-add-nda-component",setup(t){s.requiredOfPrototype(t.ndaDocument,l,"options.ndaDocument must be a TcDocumentModel"),s.requiredOfPrototype(t.tcContractFactory,r,"options.tcContractFactory must be a TCContractFactory"),this.ndaDocument=t.ndaDocument,this.tcContractFactory=t.tcContractFactory,this.buyerId=t.buyerId,this.shopId=t.shopId,this.buttonOnly=!0===t.buttonOnly,this.ndaFile=null,this.ndaContract=null,this.addNdaButton=this._createAddNdaButton(),this.alert=this._createAlert()},render(){return this.buttonOnly?this.container.setContent([this.alert,this.addNdaButton]):this.container.setContent([this.alert,t.createElement("div",{class:"mpf-nda-container",html:[this.addNdaButton,this.ndaFile?{tag:"span",class:"mpf-nda-filename",text:this.ndaFile.name}:""]}),t.createElement("div",{class:"mpf-nda-info",html:h.get("ndaInfo")})]),this},async save(){if(this.ndaFile&&this.ndaDocument.getDocID()){if(this._validate().isValid){n.mask(this.container);try{this.ndaContract=this.tcContractFactory.createModel(r.Types.EXISTING_DOCUMENT,{supplierID:this.buyerId,consumerID:this.shopId,documentType:a.DOCUMENT_TYPES.NDA,documentID:this.ndaDocument.getDocID()}),await this.ndaContract.savePromise(),n.unmask(this.container)}catch(t){console.error(t);const e=h.get("uploadError");n.unmask(this.container),this.alert.add({className:"error",message:e}).show()}}}},destroy(){this.alert.destroy(),this.addNdaButton.destroy(),this.alert=null,this.addNdaButton=null,this.ndaFile=null,this.buyerId=null,this.shopId=null,this.ndaDocument=null,this.ndaContract=null,this.tcContractFactory=null,this._parent(),this.container=null},_validate(){let t="";if(this.ndaFile){this.ndaFile.size>u&&(t=h.get("fileExceedsMaxSize",{size:i.getReadableFileSize(u)}));const e=this.ndaFile.type.indexOf("image")>-1;!e&&d.includes(this.ndaFile.type)||(t=e?h.get("imageCantBeUploadedNDA"):h.get("fileFormatNotSupported"))}return{isValid:0===t.length,message:t}},async _uploadFile(t){this.ndaFile=t.target.files[0];const e=this._validate();if(e.isValid){n.mask(this.container);try{await this.ndaDocument.saveDocument({file:this.ndaFile},{type:l.DocumentTypes.NDA}),this.render(),n.unmask(this.container)}catch(t){console.error(t);const e=h.get("uploadError");this.ndaFile=null,n.unmask(this.container),this.alert.add({className:"error",message:e}).show()}}else this.ndaFile=null,this.alert.add({className:"error",message:e.message}).show()},_createAddNdaButton(){const t=new c({buttonText:h.get("addNda"),className:"mpf-nda-input",input:!1,name:"NDA",events:{onChange:this._uploadFile.bind(this)},attributes:{title:h.get("addNda")}});return this._addIcon("attributes-add",t),t},_addIcon(e,n){t.createElement("span",{class:"fonticon fonticon-"+e}).inject(n.elements.button,"top")},_createAlert:()=>new o({visible:!1,autoHide:!0,hideDelay:3e3})})})),define("DS/MPFTcContractComponent/TermsOfUseOrder",["UWA/Core","UWA/String","UWA/Promise","UWA/Class/View","DS/UIKIT/Input/Toggle","DS/MPFServices/ObjectService","DS/MPFPersonModel/PersonModel","DS/MPFTcDocumentModel/TcDocumentModel","DS/MPFTCContractModel/TCContractModel","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],(function(t,e,n,o,c,i,s,r,a,l){"use strict";return o.extend({className:"mpf-terms-order",setup:function(t={}){this._parent(t),i.requiredOfPrototype(t.tcDocument,r,"options.tcDocument must be a TCDocumentModel"),i.requiredOfPrototype(t.privacyPolicyDocument,r,"options.privacyPolicyDocument must be a TCDocumentModel"),i.requiredOfPrototype(t.tcContract,a,"options.tcContract must be a TCContractModel"),i.requiredOfPrototype(t.privacyPolicyContract,a,"options.privacyPolicyContract must be a TCContractModel"),this.checkbox=this._createCheckbox(t),this.privacyPolicyDocument=t.privacyPolicyDocument,this.tcDocument=t.tcDocument,this.privacyPolicyContract=t.privacyPolicyContract,this.tcContract=t.tcContract},render:function(){const n=this._getLinks();return this.container.setContent([this.checkbox,t.createElement("div",{class:"labelTerms",html:[e.format(l.get("buyerTermsOrderLabelUpdate"),n[0].outerHTML,n[1].outerHTML),'&nbsp;<span class="mpf-required">*</span>']})]),this.dispatchEvent("onRender"),this},_createCheckbox:function(t){return new c({type:"checkbox",label:"",className:"mpf-entry mpf-toggle primary",checked:!0===t.isInitializedChecked,events:{onChange:t.callback}})},_getLinks:function(){return[t.createElement("a",{target:"_blank",href:this.tcDocument.getDocUrl(),html:l.get("termsOfUseLabel")}),t.createElement("a",{target:"_blank",href:this.privacyPolicyDocument.getDocUrl(),html:l.get("privacyPolicyLabel")})]},isChecked:function(){return this.checkbox.isChecked()},createContract:function(){if(this.isChecked())return n.all([this._signTcContract(),this._signDataPrivacyContract()])},_signDataPrivacyContract:function(){const t={};return this.privacyPolicyContract.getCurrentState()===a.STATUS.draft?(t[a.FIELDS.CURRENT_STATE]=a.STATUS.inEffect,this.privacyPolicyContract.savePromise(t,{patch:!0})):n.resolve()},_signTcContract:function(){const t={};return this.tcContract.getCurrentState()===a.STATUS.draft?(t[a.FIELDS.CURRENT_STATE]=a.STATUS.inEffect,this.tcContract.savePromise(t,{patch:!0})):n.resolve()},destroy:function(){this.checkbox=null,this.privacyPolicyDocument=null,this.tcDocument=null,this.tcContract=null,this.privacyPolicyContract=null,this._parent(),this.container=null}})})),define("DS/MPFTcContractComponent/TcMarketplaceOperator",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/UIKIT/Input/File","DS/UIKIT/Alert","DS/UIKIT/Mask","DS/MPFTcDocumentModel/TCDocumentFactory","DS/MPFTcDocumentModel/TcDocumentModel","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],(function(t,e,n,o,c,i,s,r,a){"use strict";const l=Object.freeze({LOADING:"loading",LOADED:"loaded"}),h=e.extend({className:"mpf-submit-operator",setup:function(t={}){this._parent(t),n.requiredOfPrototype(t.tcDocumentFactory,s,"options.tcDocumentFactory must be a TCDocumentFactory"),this.tcDocumentFactory=t.tcDocumentFactory,this.type=t.type,this.model=this.tcDocumentFactory.createModel(this.type),this.alert=this._createAlert(),this.title=this._createTitle(),this.conditions=this._createConditions(),this.iconContainer=this._createIconContainer(),this.state=l.LOADING},render:function(){const t=[this.alert,this.title,this.conditions];return this.state===l.LOADING?(t.push(this._createLoadingPanel()),this._initLoading()):(this.input=this._createInput(),t.push(this.iconContainer),t.push(this.input)),this.container.setContent(t),this},_createConditions:function(){return t.createElement("div",{class:"mpf-conditions",text:a.get(this.type+"MarketplaceUpload")})},_createTitle:function(){return t.createElement("div",{class:"mpf-title",text:a.get(this.type+"TCMarketplace")})},_initLoading:function(){const t=this;this.model.fetchPromise().finally((function(){t.state=l.LOADED,t.render()}))},_createAlert:function(){return new c({messsageClassName:"error",icon:!0,closable:!0,visible:!1,maximumVisibleMessage:1})},_createIconContainer:function(){return t.createElement("div",{class:"mpf-icon-container"})},_createLoadingPanel:function(){const e=t.createElement("div",{class:"mpf-loading-panel"});return i.mask(e),e},_createInput:function(){const t=this.model.getDocName()?this.model.getDocName():a.get(this.type+"Placeholder");return new o({input:!0,buttonBefore:!1,placeholder:t,buttonClassName:"btn-default mpf-upload",buttonText:a.get("uploadDocument"),events:{onChange:this._onFileChange.bind(this)}})},_onFileChange:function(){const t={};t.file=this.input.getContent().getElements("input")[1].files[0],t.file.size<=55e6?(i.mask(this.container),this.model=this.tcDocumentFactory.createModel(this.type),this.model.saveDocument(t).then((t=>(t.setState(r.States.PUBLISHED),t.id=t.getDocID(),t.savePromise(null,{patch:!0})))).then(this._displayFonticon.bind(this,"check")).catch(this._displayFonticon.bind(this,"cancel")).finally(i.unmask.bind(i,this.container))):(this._displayAlert(),this._displayFonticon("cancel"))},_displayFonticon:function(t){this.iconContainer.empty(),this.iconContainer.addContent([{tag:"span",class:"fonticon fonticon-"+t}])},_displayAlert:function(){this.alert.add({className:"error",message:a.get("maximumSize")}).show()}});return h.States=l,h})),define("DS/MPFTcContractComponent/TermsOfUseSubmitLabPage",["UWA/Core","UWA/String","UWA/Class/View","UWA/Promise","DS/MPFUtils/FormatUtils","DS/MPFDataProxy/MarketplaceConnector","DS/MPFModelFactory/MPFFactoriesV2","DS/UIKIT/Input/File","DS/UIKIT/Popover","DS/UIKIT/Mask","DS/UIKIT/Alert","DS/MPFServices/ObjectService","DS/MPFTCContractModel/TCDocumentModel","DS/MPFTcDocumentModel/TCDocumentFactory","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],(function(t,e,n,o,c,i,s,r,a,l,h,u,d,m,C){"use strict";const p=["application/x-abiword","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.oasis.opendocument.text","application/pdf","application/rtf"];const D=n.extend({className:"mpf-submit-lab",setup:function(t={}){u.requiredOfPrototype(t.shopServiceDocumentModel,d,"options.shopServiceDocumentModel must be a TCDocumentModel"),this.serviceTerm=t.serviceTerm||C.get("lab"),this.shopServiceDocumentModel=t.shopServiceDocumentModel,this.maxFileSize=t.maxFileSize,this.alert=this._createAlert(),this.input=this._createInput()},render:function(){const n=t.createElement("span",{class:"fonticon fonticon-help custom"}),o=new a({body:C.get("specificFormats"),position:"right",target:n,trigger:"hover focus"}),c=t.createElement("div",{class:"title",html:[C.get("uploadTerms"),n]}),i=t.createElement("div",{class:"salesConditions",text:e.format(C.get("salesConditionsProviders"),this.serviceTerm)});return this.container.setContent([this.alert,c,i,this.input,o]),this},destroy:function(){this.shopServiceDocumentModel=null,this._parent(),this.container=null},_onFileChange:function(t){const e={};e.file=t.target.files[0],e.file&&(p.includes(e.file.type)?this.maxFileSize&&e.file.size>this.maxFileSize?(this._displayFonticon("error"),this.alert.add({className:"error",message:C.get("fileExceedsMaxSize",{size:c.getReadableFileSize(this.maxFileSize)})}).show()):(l.mask(this.container),this.shopServiceDocumentModel.saveDocument(e).then(this.render.bind(this)).then(this._displayFonticon.bind(this,"check")).catch(this._displayAlertError.bind(this)).finally(l.unmask.bind(l,this.container))):(this._displayFonticon("error"),this.alert.add({className:"error",message:C.get("specificFormats")}).show()))},_createAlert:function(){return new h({closable:!0,visible:!1,autoHide:!0})},_createInput:function(){return new r({input:!0,buttonBefore:!1,placeholder:t.is(this.shopServiceDocumentModel.getDocName())?this.shopServiceDocumentModel.getDocName():C.get("salesConditionsUpload"),buttonClassName:"btn-default mpf-upload",buttonText:C.get("uploadDocument"),events:{onChange:this._onFileChange.bind(this)}})},_displayAlertError:function(){this._displayFonticon("error"),this.alert.add({className:"error",message:C.get("uploadError")}).show()},_displayFonticon:function(e){const n=this.getContent().getElement(".salesConditions"),o=this.getContent().getElement(".salesConditions + .fonticon");let c;o&&(o.outerHTML=""),"check"===e&&(c=t.createElement("span",{class:"fonticon fonticon-check custom"})),"error"===e&&(c=t.createElement("span",{class:"fonticon fonticon-cancel custom"})),c.inject(n,"after")}});return D.fromShopServiceId=function(e,n){let c;return u.requiredOfType(e,"string","First argument must be a string representing the shop service ID"),n=n||{},i.fetchPromise(n).then((function(t){return s.getInstance(t).getFactory(s.Types.TC_DOCUMENT)})).then((function(n){return t.is(e)?(c=n.createModel(m.Types.SELLER_BUYER,{shopServicesID:e}),c.fetchPromise()):o.resolve(n.createModel(m.Types.SELLER_BUYER))})).then((function(){const e=t.merge({shopServiceDocumentModel:c},n);return new D(e)}))},D})),define("DS/MPFTcContractComponent/TermsOfUseSeller",["UWA/Core","UWA/String","UWA/Class/View","UWA/Promise","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle","DS/UIKIT/Mask","DS/MPFServices/ObjectService","DS/MPFPersonModel/PersonModel","DS/MPFTcDocumentModel/TcDocumentModel","DS/MPFTCContractModel/TCContractModel","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],(function(t,e,n,o,c,i,s,r,a,l,h,u,d){"use strict";return n.extend({setup:function(t={}){this._parent(t),a.requiredOfPrototype(t.seller,l,"options.seller must be a PersonModel"),a.requiredOfPrototype(t.tcDocument,h,"options.tcDocument must be a TcDocumentModel"),a.requiredOfPrototype(t.privacyPolicyDocument,h,"options.privacyPolicyDocument must be a TcDocumentModel"),a.requiredOfPrototype(t.tcContract,u,"options.tcContract must be a TCContractModel"),a.requiredOfPrototype(t.privacyPolicyContract,u,"options.privacyPolicyContract must be a TCContractModel"),this.seller=t.seller,this.tcDocument=t.tcDocument,this.privacyPolicyDocument=t.privacyPolicyDocument,this.tcContract=t.tcContract,this.privacyPolicyContract=t.privacyPolicyContract,this.button=this._createButton(),this.checkbox=this._createCheckbox(),this.modal=this._createModal()},render:function(t){return this.modal.inject(t),this},show:function(){this.modal.show()},isChecked:function(){return this.checkbox.isChecked()},_clickOk:function(){return r.mask(this.modal.getBody()),o.all([this._signDataPrivacyContract(),this._signTcContract()]).finally((()=>{this.modal.hide(),r.unmask(this.modal.getBody())}))},_getTcLink:function(){return t.createElement("a",{target:"_blank",href:this.tcDocument.getDocUrl(),html:d.get("termsOfUseLabel")})},_getPrivacyPolicyLink:function(){return t.createElement("a",{target:"_blank",href:this.privacyPolicyDocument.getDocUrl(),html:d.get("privacyPolicyLabel")})},_signTcContract:function(){const t={};return this.tcContract.getCurrentState()===u.STATUS.draft?(t[u.FIELDS.CURRENT_STATE]=u.STATUS.inEffect,this.tcContract.savePromise(t,{patch:!0})):o.resolve()},_signDataPrivacyContract:function(){const t={};return this.privacyPolicyContract.getCurrentState()===u.STATUS.draft?(t[u.FIELDS.CURRENT_STATE]=u.STATUS.inEffect,this.privacyPolicyContract.savePromise(t,{patch:!0})):o.resolve()},_createButton:function(){return new i({className:"primary",value:d.get("ok"),disabled:!0,events:{onClick:this._clickOk.bind(this)}})},_createCheckbox:function(){const t=this;return new s({type:"checkbox",label:" ",className:"mpf-entry mpf-toggle primary",events:{onChange:function(){this.isChecked()?t.button.enable():t.button.disable()}}})},_createModal:function(){const n=t.createElement("h4",{text:d.get("termsOfUseAcceptance")}),o=[this.checkbox,t.createElement("div",{class:"labelTerms",html:e.format(d.get("sellerTermsOfUseLabel"),this._getTcLink().outerHTML,this._getPrivacyPolicyLink().outerHTML)})];return new c({visible:!0,closable:!1,className:"mpf-tc-contract-modal",header:n,body:o,footer:this.button})}})})),define("DS/MPFTcContractComponent/SellerSalesConditionsShowroom",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFTcDocumentModel/TCDocumentFactory","i18n!DS/MPFTcContractComponent/assets/nls/TcContractComponent","css!DS/MPFTcContractComponent/MPFTcContractComponent"],(function(t,e,n,o,c){"use strict";return e.extend({className:"mpf-seller-sales-conditions-showroom",setup:function(t={}){n.requiredOfPrototype(t.tcDocumentFactory,o,"options.tcDocumentFactory must be a TCDocumentFactory"),this._parent(t),this.tcDocumentFactory=t.tcDocumentFactory,this.tcDocument=this.tcDocumentFactory.createModel("documents",this.model.get("shopServices")["contract-documents"][0])},render:function(){return this._getLink().then((e=>{this.container.setContent(t.createElement("h3",{html:[this.model.get("shopName")+"&nbsp;",e]}))})),this},_getLink:function(){return this.tcDocument.fetchPromise().then((function(e){return t.createElement("a",{href:e.get("docUrl"),target:"_blank",html:c.get("salesConditions")})}))}})})),define("DS/MPFTcContractComponent/AddNdaComponentFactory",["DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFBuyer/BuyerType","DS/MPFConnector/MarketplaceConnector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFPersonModel/PersonFactory","DS/MPFTcDocumentModel/TCDocumentFactory","DS/MPFTcContractComponent/AddNdaComponent"],((t,e,n,o,c,i,s,r)=>{"use strict";return class{static async createComponent({shopId:e,service:a,buttonOnly:l=!1}={}){t.requiredOfType(e,"string","options.shopId must be a string"),t.requiredOfType(a,"string","options.service must be a string (see DS/MPFServices/MarketplaceServices)");const h=await o.fetchPromise({service:a}),u=c.getInstance(h),[d,m,C]=await u.getFactories([c.Types.PERSON,c.Types.TC_CONTRACT,c.Types.TC_DOCUMENT]),p=d.createModel(i.Types.ME);await p.fetchPromise();const D=C.createModel(s.Types.NEW_NDA);return new r({ndaDocument:D,tcContractFactory:m,buyerId:p.getBuyerType()===n.COMPANY?p.getCompanyId():p.get("id"),shopId:e,buttonOnly:l})}}})),define("DS/MPFTcContractComponent/TermsOfUseOrderFactory",["UWA/Core","UWA/Class","UWA/Promise","DS/MPFConnector/Connector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFTCContractModel/TCContractFactory","DS/MPFTcDocumentModel/TCDocumentFactory","DS/MPFPersonModel/PersonFactory","DS/MPFServices/ObjectService","DS/MPFTCContractModel/TCContractModel","DS/MPFTcContractComponent/TermsOfUseOrder"],(function(t,e,n,o,c,i,s,r,a,l,h){"use strict";return e.extend({init:function(t={}){a.requiredOfPrototype(t.connector,o,"options.connector must be a Connector"),this.connector=t.connector,this.container=t.container,this.callback=t.callback,this.buyer=t.buyer,this.isInitializedChecked=t.isInitializedChecked,this.factories=c.getInstance(this.connector)},displayTermsOfUse:function(){return this._initFactories().then(this._fetchBuyer.bind(this)).then(this._getContracts.bind(this)).then(this._getPrivacyPolicyContract.bind(this)).then(this._getBuyersTcContract.bind(this)).then(this._buildTermsOfUse.bind(this))},_initFactories:function(){const t=this;return n.all([this.factories.getFactory(c.Types.TC_CONTRACT),this.factories.getFactory(c.Types.TC_DOCUMENT),this.factories.getFactory(c.Types.PERSON)]).then((function(e){t.tcContractFactory=e[0],t.tcDocumentFactory=e[1],t.personFactory=e[2]}))},_fetchBuyer:function(){return t.is(this.buyer)?n.resolve():(this.buyer=this.personFactory.createModel(r.Types.ME),this.buyer.fetchPromise())},_getContracts:function(){return this.contracts=this.tcContractFactory.createCollection(i.Types.TERMS_AND_CONDITIONS),this.contracts.fetchPromise({type:[l.TcTypes.DS_BUYER,l.TcTypes.DATA_PRIVACY]})},_getPrivacyPolicyContract:function(){this.privacyPolicyContract=this._getContract(l.DOCUMENT_TYPES.DATA_PRIVACY)},_getBuyersTcContract:function(){this.buyersTcContract=this._getContract(l.DOCUMENT_TYPES.DS_BUYERS)},_getContract:function(e){const n=this._getBuyerId();let o=this.contracts.find((function(t){return t.getDocumentType()===e&&t.getCurrentState()===l.STATUS.inEffect}));return t.is(o)||(o=this.contracts.find((function(t){return t.getDocumentType()===e&&t.getCurrentState()===l.STATUS.draft&&t.getConsumerID()===n}))),o},_getBuyerId:function(){return"company"===this.buyer.getBuyerType()?this.buyer.getCompanyId():this.buyer.getID()},_getDocuments:function(){return this.tcDocument=this.tcDocumentFactory.createModel(s.Types.DS_BUYERS),this.privacyPolicyDocument=this.tcDocumentFactory.createModel(s.Types.PRIVACY_POLICY),n.all([this.tcDocument.fetchPromise(),this.privacyPolicyDocument.fetchPromise()])},_isContractsNeedToBeSigned:function(){return this.privacyPolicyContract.getCurrentState()===l.STATUS.draft||this.buyersTcContract.getCurrentState()===l.STATUS.draft},isChecked:function(){return!t.is(this.termsOfUseOrder)||this.termsOfUseOrder.isChecked()},createContract:function(){if(t.is(this.termsOfUseOrder))return this.termsOfUseOrder.createContract()},_getAttributes:function(){const t={};return t.callback=this.callback,t.buyer=this.buyer,t.tcDocument=this.tcDocument,t.privacyPolicyDocument=this.privacyPolicyDocument,t.tcContract=this.buyersTcContract,t.privacyPolicyContract=this.privacyPolicyContract,t.isInitializedChecked=this.isInitializedChecked,t},_buildTermsOfUse:function(){const e=this;if(this._isContractsNeedToBeSigned())return this._getDocuments().then((function(){if(t.is(e.tcDocument.getDocID())&&t.is(e.privacyPolicyDocument.getDocID()))return e.termsOfUseOrder=new h(e._getAttributes()),t.is(e.container)&&e.container.setContent(e.termsOfUseOrder.render()),e.termsOfUseOrder}))}})})),define("DS/MPFTcContractComponent/NdaAcceptanceModalFactory",["UWA/Class","UWA/Core","UWA/Promise","DS/MPFConnector/MarketplaceConnector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFTCContractModel/TCContractFactory","DS/MPFTcDocumentModel/TCDocumentFactory","DS/MPFPersonModel/PersonFactory","DS/MPFTCContractModel/TCContractModel","DS/MPFTcContractComponent/NdaAcceptanceModal"],(function(t,e,n,o,c,i,s,r,a,l){"use strict";return t.extend({init:function(t={}){this.service=t.service,this.cartId=t.cartId},getNdaModal:function(){return o.fetchPromise({service:this.service}).then(this._initFactories.bind(this)).then(this._fetchNdaContract.bind(this)).then(this._fetchNdaDocument.bind(this)).then(this._initNdaModal.bind(this))},_initFactories:function(t){return this.factories=c.getInstance(t),n.all([this.factories.getFactory(c.Types.TC_CONTRACT),this.factories.getFactory(c.Types.TC_DOCUMENT)]).then((t=>{this.tcContractFactory=t[0],this.tcDocumentFactory=t[1]}))},_fetchNdaContract:function(){return this.ndaContract=this.tcContractFactory.createModel(i.Types.NDA),this.ndaContract.setParentResourceId(this.cartId),this.ndaContract.fetchPromise()},_fetchNdaDocument:function(){const t=!this.ndaContract.isNew(),e=t&&this.ndaContract.getCurrentState()===a.STATUS.inEffect;if(t&&!e)return this.ndaDocument=this.tcDocumentFactory.createModel(s.Types.DOCUMENTS,{id:this.ndaContract.getDocumentID()}),this.ndaDocument.fetchPromise()},_initNdaModal:function(){if(e.is(this.ndaDocument))return new l({ndaContract:this.ndaContract,ndaDocument:this.ndaDocument,tcContractFactory:this.tcContractFactory})}})})),define("DS/MPFTcContractComponent/TermsOfUseSellerFactory",["UWA/Core","UWA/Class","UWA/Promise","DS/MPFConnector/Connector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFTCContractModel/TCContractFactory","DS/MPFTcDocumentModel/TCDocumentFactory","DS/MPFPersonModel/PersonFactory","DS/MPFServices/ObjectService","DS/MPFTCContractModel/TCContractModel","DS/MPFTcContractComponent/TermsOfUseSeller"],(function(t,e,n,o,c,i,s,r,a,l,h){"use strict";return e.extend({init:function(t={}){a.requiredOfPrototype(t.connector,o,"options.connector must be a Connector"),this.connector=t.connector,this.factories=c.getInstance(this.connector)},displayTermsOfUse:function(){return this._initFactories().then(this._getSeller.bind(this)).then(this._getContracts.bind(this)).then(this._getPrivacyPolicyContract.bind(this)).then(this._getSellersTcContract.bind(this)).then(this._getDocumentsAndBuildTermsOfUseModal.bind(this))},_initFactories:function(){return n.all([this.factories.getFactory(c.Types.TC_CONTRACT),this.factories.getFactory(c.Types.TC_DOCUMENT),this.factories.getFactory(c.Types.PERSON)]).then((t=>{this.tcContractFactory=t[0],this.tcDocumentFactory=t[1],this.personFactory=t[2]}))},_getSeller:function(){return this.seller=this.personFactory.createModel(r.Types.ME),this.seller.fetchPromise()},_getContracts:function(){return this.contracts=this.tcContractFactory.createCollection(i.Types.TERMS_AND_CONDITIONS),this.contracts.fetchPromise({type:[l.TcTypes.DS_SELLER,l.TcTypes.DATA_PRIVACY]})},_getPrivacyPolicyContract:function(){this.privacyPolicyContract=this._getContract(l.DOCUMENT_TYPES.DATA_PRIVACY)},_getSellersTcContract:function(){this.sellersTcContract=this._getContract(l.DOCUMENT_TYPES.DS_SELLERS)},_getContract:function(e){let n;const o=this._getSellerId();return n=this.contracts.find((function(t){return t.getDocumentType()===e&&t.getCurrentState()===l.STATUS.inEffect})),t.is(n)||(n=this.contracts.find((function(t){return t.getDocumentType()===e&&t.getCurrentState()===l.STATUS.draft&&t.getConsumerID()===o}))),n},_getSellerId:function(){return"company"===this.seller.getBuyerType()?this.seller.getCompanyId():this.seller.getID()},_getDocuments:function(){return this.tcDocument=this.tcDocumentFactory.createModel(s.Types.DS_SELLERS),this.privacyPolicyDocument=this.tcDocumentFactory.createModel(s.Types.PRIVACY_POLICY),n.all([this.tcDocument.fetchPromise(),this.privacyPolicyDocument.fetchPromise()])},_getAttributes:function(){const t={};return t.seller=this.seller,t.tcDocument=this.tcDocument,t.privacyPolicyDocument=this.privacyPolicyDocument,t.tcContract=this.sellersTcContract,t.privacyPolicyContract=this.privacyPolicyContract,t},_isContractsNeedToBeSigned:function(){return this.privacyPolicyContract.getCurrentState()===l.STATUS.draft||this.sellersTcContract.getCurrentState()===l.STATUS.draft},_getDocumentsAndBuildTermsOfUseModal:function(){const e=this;let n;if(this._isContractsNeedToBeSigned())return this._getDocuments().then((function(){if(n=t.is(e.tcDocument.getDocID())&&t.is(e.privacyPolicyDocument.getDocID()),n)return new h(e._getAttributes()).render(document.body)}))}})}));