define("DS/DELPPWProcessValidationModule/worker/rule11_HeaderOperationResourceTypes",[],(function(){"use strict";return function(){const e=["ControlDevice","IndustrialMachine","LogicController","NCMachine","Robot","Sensor","ToolDevice"];var o={};self.onmessage=function(e){if(e&&e.data)switch(e.data.type){case"config":if(e.data.config&&(o=Object.assign(o,e.data.config),(e.data.config.sec_context||e.data.config.security_ctx)&&(self.sec_context=e.data.config.sec_context||e.data.config.security_ctx),e.data.config.COMPASS_CONFIG&&(self.COMPASS_CONFIG=Object.clone?Object.clone(e.data.config.COMPASS_CONFIG):e.data.config.COMPASS_CONFIG),e.data.config.require_config)){if(e.data.config.require_config.baseUrl)importScripts(e.data.config.require_config.baseUrl+"/AmdLoader/AmdLoader.js");else{const e=(self.location+"").replace(/\/[^/]+$/,"/").replace(/:444\/$/,"");var r=null;e.indexOf("blob:")>-1&&(r=e.replace(/^blob:/,"")),importScripts(r+"/3DSpace/webapps/AmdLoader/AmdLoader.js")}self.require&&self.require.config(e.data.config.require_config)}break;case"start":e.data.options&&e.data.options.workplan&&e.data.options.workplan.physicalid&&t(e.data.options);break;default:self.postMessage({type:"error",msg:"Invalid event type = "+e.data.type})}else self.postMessage({type:"error",msg:"Invalid event data"})};var t=function(t){var r={rule11_HeaderOperationResourceTypes:{result:"pass"}};self.require(["DS/DELWebInfrastructureControls/UWAUtils","DS/DELPPWProcessValidationModule/DELWebProcessValidationModel","DS/DELWebInfrastructureControls/DELWebIndexAuthoringMgmt"],(function(a,s,i){a.log("Inside rule11_HeaderOperationResourceTypes require"),o&&(o.objAllServices&&s.updatePlatformServicesCache(o.objAllServices),o.navigateOn&&("Database"===o.navigateOn?i.setDatabase():i.setIndex()));var n=t.workplan;s.getAllDescendantsForWorkplan({physicalid:n.physicalid||n.id,Depth:2}).then((function(o){if(o&&!a.Object.isEmptyObject(o)){var t=r.rule11_HeaderOperationResourceTypes,i=[];a.each(o,(function(o,r){!r||r.ReferencePhysicalid||r.ReferenceOXID||r.plmObjectType&&(r.plmObjectTypeInternal||r.plmObjectType).toLowerCase().indexOf("operation")<0||i.push(new Promise((function(o,i){var n={},c=[];c.push(new Promise((function(e,o){s.getPrimaryCapableResources(r).then((function(o){o&&!a.Object.isEmptyObject(o)&&a.each(o,(function(e,o){o&&o.physicalid&&(n[o.physicalid]=o)})),e(o)}),o)}))),c.push(new Promise((function(e,o){s.getSecondaryCapableResources(r).then((function(o){o&&!a.Object.isEmptyObject(o)&&a.each(o,(function(e,o){o&&o.physicalid&&(n[o.physicalid]=o)})),e(o)}),o)}))),Promise.all(c).then((function(){var c=[];n&&!a.Object.isEmptyObject(n)&&a.each(n,(function(o,a){c.push(new Promise((function(o,i){s.getResource(a).then((function(a){(!a||!a.V_discipline||e.indexOf(a.V_discipline)<0)&&(t.result="warning",t.messages||(t.messages={}),t.messages["Primary and Secondary resource linked to header operation must be of a specified type."]||(t.messages["Primary and Secondary resource linked to header operation must be of a specified type."]={long:"For every Header Operation that exists below a Work Plan, that Header Operation must have at Primary or Secondary Resource to be only of the types: Control Equipment, Industrial Machine, Logic Controller, NC Machine, Robot, Sensor, Tool Equipment.",fixes:["Remove the Primary or Secondary resource which is not of above allowed types.","Change the type of Primary or Secondary resource attached to the Header Operation."]}),t.issues||(t.issues=[]),t.issues.push({short:"Primary and Secondary resource linked to header operation must be of a specified type.",operation:r,resource:a})),o(a)}),i)})))})),Promise.all(c).then((function(){o()}),i)}),i)})))})),Promise.all(i).then((function(){self.postMessage({type:"complete",result:r})}),(function(e){self.postMessage({type:"error",msg:"Unable to retrieve primary resources for child header operations",objError:e})}))}else self.postMessage({type:"complete",result:r})}),(function(e){self.postMessage({type:"error",msg:"Unable to retrieve child header operations",objError:e})}))}))}}}));