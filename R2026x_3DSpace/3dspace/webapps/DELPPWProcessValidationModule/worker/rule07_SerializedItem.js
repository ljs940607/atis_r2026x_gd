define("DS/DELPPWProcessValidationModule/worker/rule07_SerializedItem",[],(function(){"use strict";return function(){var e={};self.onmessage=function(s){if(s&&s.data)switch(s.data.type){case"config":if(s.data.config&&(e=Object.assign(e,s.data.config),(s.data.config.sec_context||s.data.config.security_ctx)&&(self.sec_context=s.data.config.sec_context||s.data.config.security_ctx),s.data.config.COMPASS_CONFIG&&(self.COMPASS_CONFIG=Object.clone?Object.clone(s.data.config.COMPASS_CONFIG):s.data.config.COMPASS_CONFIG),s.data.config.require_config)){if(s.data.config.require_config.baseUrl)importScripts(s.data.config.require_config.baseUrl+"/AmdLoader/AmdLoader.js");else{const e=(self.location+"").replace(/\/[^/]+$/,"/").replace(/:444\/$/,"");var r=null;e.indexOf("blob:")>-1&&(r=e.replace(/^blob:/,"")),importScripts(r+"/3DSpace/webapps/AmdLoader/AmdLoader.js")}self.require&&self.require.config(s.data.config.require_config)}break;case"start":s.data.options&&s.data.options.workplan&&s.data.options.workplan.physicalid&&t(s.data.options);break;default:self.postMessage({type:"error",msg:"Invalid event type = "+s.data.type})}else self.postMessage({type:"error",msg:"Invalid event data"})};var t=function(t){var s={rule07_SerializedItem:{result:"pass"}};self.require(["DS/DELWebInfrastructureControls/UWAUtils","DS/DELPPWProcessValidationModule/DELWebProcessValidationModel","DS/DELWebInfrastructureControls/DELWebIndexAuthoringMgmt"],(function(r,i,o){r.log("Inside rule07_SerializedItem require"),e&&(e.objAllServices&&i.updatePlatformServicesCache(e.objAllServices),e.navigateOn&&("Database"===e.navigateOn?o.setDatabase():o.setIndex())),i.getProducedItemsForMfgProcess(t.workplan).then((function(e){var o=s.rule07_SerializedItem;if(!e||e.length<=0)return o.result="blocking",o.messages||(o.messages={}),o.messages["Missing Produced Item."]||(o.messages["Missing Produced Item."]={long:"The Work Plan must have a Produced Item.",fixes:["Add a scoped Item to this Work Plan."]}),o.issues||(o.issues=[]),o.issues.push({short:"Missing Produced Item.",workplan:t.workplan}),self.postMessage({type:"complete",result:s}),!1;var a=[];r.each(e,(function(e,s){s&&s.itemRef&&s.itemRef.identifier&&a.push(new Promise((function(e,a){i.getProducedItem({physicalid:s.itemRef.identifier,Minimum:["V_SerialNumberRequired"]}).then((function(s){s&&!r.Object.isEmptyObject(s)?(s.V_SerialNumberRequired&&"TRUE"===s.V_SerialNumberRequired.toString().toUpperCase()||(o.result="blocking",o.messages||(o.messages={}),o.messages["Produced Item does not have Serialized Item extension attribute."]||(o.messages["Produced Item does not have Serialized Item extension attribute."]={long:'The Produced Item must have the extension attribute "Is Serial Number Required" set to TRUE.',fixes:["Add the DELAsmUnitRefRequired extension to the Produced Item.",'Set the "Is Serial Number Required" attribute from the extension to TRUE.']}),o.issues||(o.issues=[]),o.issues.push({short:"Produced Item does not have Serialized Item extension attribute.",item:s,workplan:t.workplan})),e(s)):a(new Error("unable to locate Produced Item Reference"))}),a)})))})),Promise.all(a).then((function(){self.postMessage({type:"complete",result:s})}),(function(e){self.postMessage({type:"error",msg:"Unable to retrieve primary resources for child header operations",objError:e})}))}),(function(e){self.postMessage({type:"error",msg:"Error",objError:e})}))}))}}}));