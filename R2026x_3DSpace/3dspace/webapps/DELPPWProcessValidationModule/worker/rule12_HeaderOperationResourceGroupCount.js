define("DS/DELPPWProcessValidationModule/worker/rule12_HeaderOperationResourceGroupCount",[],(function(){"use strict";return function(){var e={};self.onmessage=function(r){if(r&&r.data)switch(r.data.type){case"config":if(r.data.config&&(e=Object.assign(e,r.data.config),(r.data.config.sec_context||r.data.config.security_ctx)&&(self.sec_context=r.data.config.sec_context||r.data.config.security_ctx),r.data.config.COMPASS_CONFIG&&(self.COMPASS_CONFIG=Object.clone?Object.clone(r.data.config.COMPASS_CONFIG):r.data.config.COMPASS_CONFIG),r.data.config.require_config)){if(r.data.config.require_config.baseUrl)importScripts(r.data.config.require_config.baseUrl+"/AmdLoader/AmdLoader.js");else{const e=(self.location+"").replace(/\/[^/]+$/,"/").replace(/:444\/$/,"");var a=null;e.indexOf("blob:")>-1&&(a=e.replace(/^blob:/,"")),importScripts(a+"/3DSpace/webapps/AmdLoader/AmdLoader.js")}self.require&&self.require.config(r.data.config.require_config)}break;case"start":r.data.options&&r.data.options.workplan&&r.data.options.workplan.physicalid&&o(r.data.options);break;default:self.postMessage({type:"error",msg:"Invalid event type = "+r.data.type})}else self.postMessage({type:"error",msg:"Invalid event data"})};var o=function(o){var r={rule12_HeaderOperationResourceGroupCount:{result:"pass"}};self.require(["DS/DELWebInfrastructureControls/UWAUtils","DS/DELPPWProcessValidationModule/DELWebProcessValidationModel","DS/DELWebInfrastructureControls/DELWebIndexAuthoringMgmt"],(function(a,t,s){a.log("Inside rule12_HeaderOperationResourceGroupCount require"),e&&(e.objAllServices&&t.updatePlatformServicesCache(e.objAllServices),e.navigateOn&&("Database"===e.navigateOn?s.setDatabase():s.setIndex()));var n=o.workplan;t.getAllDescendantsForWorkplan({physicalid:n.physicalid||n.id,Depth:1}).then((function(e){if(e&&!a.Object.isEmptyObject(e)){var o=r.rule12_HeaderOperationResourceGroupCount,s=[];a.each(e,(function(e,r){!r||r.ReferencePhysicalid||r.ReferenceOXID||r.plmObjectType&&(r.plmObjectTypeInternal||r.plmObjectType).toLowerCase().indexOf("operation")<0||r.plmObjectType&&(r.plmObjectTypeInternal||r.plmObjectType).toLowerCase().indexOf("header")<0||s.push(new Promise((function(e,s){var n=[],i=null;n.push(new Promise((function(e,s){t.getPrimaryCapableResources(Object.assign({blnIncludeConnection:!0},r)).then((function(t){t&&!a.Object.isEmptyObject(t)&&a.each(t,(function(e,a){if(a&&a.physicalid&&a.connection&&"capableRscGroupIndex"in a.connection)if(null===i)i=a.connection.capableRscGroupIndex;else if(i!==a.connection.capableRscGroupIndex)return o.result="blocking",o.messages||(o.messages={}),o.messages["Multiple Primary Resource Groups."]||(o.messages["Multiple Primary Resource Groups."]={long:"There can be only one group of Primary Capable Resources defined on a Header Operation.",fixes:["Remove the Primary Capable Resources belonging to all but one of the groups.","Update all Primary Capable Resource to be in the same group."]}),o.issues||(o.issues=[]),o.issues.push({short:"Multiple Primary Resource Groups.",operation:r,resource:a}),!1;return!0})),e(t)}),s)}))),Promise.all(n).then(e,s)})))})),Promise.all(s).then((function(){self.postMessage({type:"complete",result:r})}),(function(e){self.postMessage({type:"error",msg:"Unable to retrieve primary resources for child header operations",objError:e})}))}else self.postMessage({type:"complete",result:r})}),(function(e){self.postMessage({type:"error",msg:"Unable to retrieve child header operations",objError:e})}))}))}}}));