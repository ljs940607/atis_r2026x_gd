define("DS/TagNavigatorWidget/ParentModule",[],(function(){"use strict";var e;return{getParentModule:(e={},function(t,i){if(e[t])e[t]&&i(e[t]);else if(console.log("TagNavigatorProxyPrivate#getParentModule - trying to load the module"),function(){var e;try{top.document,e=!0}catch(t){e=!1}return e}())try{console.log("isParentAccessible: true, require from top window"),top.require([t],(function(a){console.log("require from top window SUCCEEDED"),e[t]=a,i(a)}))}catch(a){try{console.log("require from top window FAILED - retry on parent of current window.");let a=require;window.parent!=top?(a=window.parent.require,console.log("using require from parent of current window")):console.log("using require from current window"),a([t],(function(a){console.log("require SUCCEEDED"),e[t]=a,i(a)}))}catch(e){console.log("require from parent of current window FAILED !!, no further attempt"),i(null)}}})}})),define("DS/TagNavigatorWidget/WidgetUtils",["UWA/Core","UWA/Class","UWA/Promise","DS/WAFData/WAFData"],(function(e,t,i,a){"use strict";return t.singleton({_service_url_promises:{},getServiceURL:function(e){if(UWA.is(e,"object")&&e.serviceId&&e.platformId){let t=e.serviceId+"__"+e.platformId,a=this._service_url_promises[t];return a||(this._service_url_promises[t]=a=new i((function(t){require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],(function(i){i.getServiceUrl({serviceName:e.serviceId,platformId:e.platformId,onComplete:function(e){t(e)},onFailure:function(){t()}})}))}))),a}}})})),define("DS/TagNavigatorWidget/SavedTagsWidget",["UWA/Core","UWA/Class","DS/TagNavigatorWidget/ParentModule","DS/TagNavigator/simplified/savedTags/views/SavedTagsWidgetListView","DS/TagNavigator/TaggerNLS","DS/UIKIT/Mask","DS/UIKIT/Scroller","DS/MessageBus/MessageBus"],(function(e,t,i,a,s,d,g,r){"use strict";return t.extend({init:function(e){let t=this;this.taggerWidget=e.taggerWidget;let a=!1;this.taggerWidget.widget.getValue("widgetDropped")||(this.taggerWidget.updateWidgetPreferences({savedTagsIds:this.taggerWidget.widget.getValue("savedTagsIds"),savedTagsLabel:this.taggerWidget.widget.getValue("savedTagsLabel"),widgetDropped:!0}),a=!0,r.publish({channel:"TaggerTrackerApi",topic:"hit",data:{category:"SavedTagsWidget",action:"onSavedTagWidgetDrop"}})),this.savedTagsIds=Array.isArray(this.taggerWidget.widget.getValue("savedTagsIds"))?[...this.taggerWidget.widget.getValue("savedTagsIds")]:[this.taggerWidget.widget.getValue("savedTagsIds")],this.widgetId=this.taggerWidget.widget.id,i.getParentModule("DS/TagNavigator/TagNavigator",(function(e){let i;t._navImpl=e.view.observedNavImpl,t._navImpl.registerTagWidget(t.taggerWidget.widget.id,"Saved_Tag_Widget"),t.tenantId||(t.tenantId=t._navImpl.getCurrentTenantId()),a&&(i=t.taggerWidget.widget.getValue("savedTagsLabel")),t.createWidgetView(i)}))},onRedrawView:function(e={}){e&&"toggleProxyFocus"!==e.event&&this.savedTagsListView&&this.savedTagsListView.redraw(e)},onLoad:function(){this.setWidgetTitle(),this._navImpl&&this.createWidgetView(),this.onRedrawView()},onRefresh:function(){this.onRedrawView()},endEdit:function(){this.setWidgetTitle()},setWidgetTitle:function(){let t=this.taggerWidget.widget.getPreference("title");e.is(t)&&e.is(t.value)&&""!==t.value?this.taggerWidget.widget.setTitle(t.value):this.taggerWidget.widget.setTitle(s.getText("savedTagsWidget-title"))},onSearch:function(e){let t={searchString:e};this.savedTagsListView.redraw(t)},createWidgetView:function(t){let i=e.createElement("div",{class:"saved-tags-list-wrapper"});this.savedTagsListView=new a({platformId:this.tenantId,ids:this.savedTagsIds,_navImpl:this._navImpl,widgetId:this.widgetId,savedTagLabel:t}).render().inject(i),this.taggerScroller=new g({element:i}).inject(this.taggerWidget.widget.body),this.savedTagsListView.addEvent("onSavedTagRemove",this._onSavedTagRemoval.bind(this)),this.savedTagsListView.addEvent("onSavedTagAdd",this._onSavedTagAdd.bind(this)),d.unmask(this.taggerWidget.widget.body)},_onSavedTagRemoval:function(e){let t=this.savedTagsIds.indexOf(e);t>-1&&this.savedTagsIds.splice(t,1),this.taggerWidget.updateWidgetPreferences({savedTagsIds:this.savedTagsIds}),0===this.savedTagsIds.length&&this.savedTagsListView.renderEmptyView()},_onSavedTagAdd:function(e){this.savedTagsIds.push(e),this.taggerWidget.updateWidgetPreferences({savedTagsIds:this.savedTagsIds})}})})),define("DS/TagNavigatorWidget/TaggerWidget",["UWA/Core","UWA/Class","UWA/Class/Debug","DS/UIKIT/Mask","DS/TagNavigatorWidget/ParentModule","DS/TagNavigator/Predicate","DS/TagNavigator/TagWidget/PredicateView","DS/MessageBus/MessageBus","DS/TagNavigator/TaggerNLS","DS/TagNavigator/TaggerTrackerApi","DS/TagNavigatorWidget/SavedTagsWidget","css!DS/UWA2/assets/css/inline.css","css!DS/UIKIT/UIKIT.css","css!DS/TagNavigatorWidget/TagNavigatorWidget.css"],(function(e,t,i,a,s,d,g,r,n,o,c){"use strict";return t.extend(i,{init:function(e){let t=this;if(this._parent(e),this.widget=e.widget,a.mask(this.widget.body),this.widget.lang&&n.setCurrentLanguage(this.widget.lang.substr(0,2)),this.widget.addEvent("endEdit",this.endEdit.bind(this)),o.set(),this.savedTagsIds=this.widget.getValue("savedTagsIds"),this.savedTagsIds)this.savedTagsWidget=new c({taggerWidget:this});else{if(!this.widget.getValue("widgetDropped")){this.updateWidgetPreferences({predicateLineage:this.widget.data.predicateLineage,predicateId:this.widget.data.predicateId,predicateType:this.widget.data.type,contextId:this.widget.data.contextId,sort:this.widget.data.sort,currentViewMode:this.widget.data.currentViewMode,widgetDropped:!0});let e={pd1:this.widget.data.predicateId,pd2:this.widget.data.currentViewMode};try{r.publish({channel:"TaggerTrackerApi",topic:"hit",data:{category:"6WTagsWidget",action:"onTagWidgetDrop",persDim:e}})}catch(e){console.log("Message bus publish did not work!!")}}this.predicateLineage=this.widget.getValue("predicateLineage"),this.predicateId=this.widget.getValue("predicateId"),this.predicateType=this.widget.getValue("predicateType"),s.getParentModule("DS/TagNavigator/TagNavigator",(function(e){t._navImpl=e.view.observedNavImpl,t._navImpl.registerTagWidget(t.widget.id,"Tag_Widget"),t.tenantId||(t.tenantId=t._navImpl.getCurrentTenantId()),t.createWidgetView()}))}s.getParentModule("DS/MessageBus/MessageBus",(function(e){e.subscribe({channel:"TagWidgetInterface",topic:"redraw",callback:t.onRedrawView.bind(t)}),e.subscribe({channel:"TagWidgetInterface",topic:"laoding",callback:t.addLoader.bind(t)}),e.subscribe({channel:"TagWidgetInterface",topic:"InfoMessageEvent",callback:t.sendInfoMessageEvent.bind(t)})})),this.widget.body.empty()},endEdit:function(){this.savedTagsWidget?this.savedTagsWidget.endEdit():this.setWidgetTitle()},onLoad:function(){this.widget.addPreference({name:"title",type:"text",label:n.getText("6WTags_widget_Title"),defaultValue:""}),this.widget.addPreference({name:"x3dTitleShowAppName",type:"boolean",label:n.getText("6WTags_widget_display_app_title"),defaultValue:!0}),this.savedTagsWidget?this.savedTagsWidget.onLoad():(a.mask(this.widget.body),this.predicateModel=new d({sixw:this.predicateLineage,type:this.widget.data.type}),d.ensureDefaultPredicates(),this.setWidgetTitle(),this._navImpl&&this.createPredicateView())},setWidgetTitle:function(){let t=this,i=this.widget.getPreference("title");if(e.is(i)&&e.is(i.value)&&""!==i.value)this.widget.setTitle(i.value);else{let e;e=this.predicateModel.is6WRoot()?n.getText("user-tags"):this.predicateModel.displayName();let i=this.predicateModel.get6WRootFather().id().replace("ds6w:",""),s=d.getRootWDisplayName(i,!1);var a=this.predicateId.split(":");a.length>1&&e==this.predicateId?this.getElementNLS().then((function(e){if(e.vocabularyElementNLSInfo){let i=e.vocabularyElementNLSInfo;i.length&&i.forEach((e=>{e.uri&&e.nlsName&&(t.widget.setTitle(s+" - "+e.nlsName),t.predicateModel.setDisplayName(e.nlsName))}))}})).catch((()=>{t.widget.setTitle(s+" - "+a[1])})):this.widget.setTitle(s+" - "+e)}},onRefresh:function(){this.savedTagsWidget?this.savedTagsWidget.onRefresh():this.onRedrawView()},onSearch:function(e){this.savedTagsWidget?this.savedTagsWidget.onSearch(e):this.predicateView.onSearchEvent(e)},onResetSearch:function(){this.savedTagsWidget?this.savedTagsWidget.onSearch():this.predicateView.onSearchEvent()},createWidgetView:function(){this.predicateId?(this.createPredicateView(),this.updateWidgetPreferences({contextId:this._navImpl.id()})):a.unmask(this.widget.body)},updateWidgetPreferences:function(t){if(e.is(t,"object"))for(var i in t)if("tagExpansion"==i){this.widget.getValue(i)||this.widget.setValue(i,{});let e=this.widget.getValue(i),a=t[i];for(let t in a)e[t]=a[t]}else if("savedTagsIds"==i)if(Array.isArray(t[i]))this.widget.setValue(i,t[i]);else{let e=[];t[i]&&e.push(t[i]),this.widget.setValue(i,e)}else this.widget.setValue(i,t[i])},onRedrawView:function(e){let t=e&&e.event;if(this.savedTagsWidget)a.unmask(this.widget.body),this.savedTagsWidget.onRedrawView(e);else if(this._navImpl&&(a.unmask(this.widget.body),this.predicateView)){let i=!0;if("COLORIZE"==t)if(this.predicateLineage===e.predicateLineage)this.predicateView.colorizeTags(!1,i),this.predicateView.predicateHeader.updateColorizeOptions();else{if(this.predicateLineage!==e.predToUncolorize)return;this.predicateView.colorizeTags(!0,i),this.predicateView.predicateHeader.updateColorizeOptions()}else if("UNCOLORIZE"==t){if(this.predicateLineage!==e.predicateLineage)return;this.predicateView.colorizeTags(!0,i),this.predicateView.predicateHeader.updateColorizeOptions()}else{let e=this.widget.getValue("tagExpansion");this.predicateView.updateTagExpansion(e),this.predicateView.redrawPredicateView()}}},createPredicateView:function(){if(this.predicateModel&&this._navImpl){let e=this.widget.getValue("currentViewMode"),t=this.widget.getValue("sort"),i=this.widget.getValue("tagExpansion");this.predicateView=new g({navImpl:this._navImpl,predicate:this.predicateModel,viewMode:e,sort:t,tagsExpand:i,withScroll:!0,withNoTags:!0}).render().inject(this.widget.body),this.predicateView.addEvent("preferenceChange",this.updateWidgetPreferences.bind(this)),this.onRedrawView()}},addLoader:function(){a.mask(this.widget.body)},onRemove:function(){this._navImpl.deregisterTagWidget(this.widget.id)},getElementNLS:function(){let e=this,t=this.predicateId;return new Promise((function(i,a){require([["DS","FedDictionaryAccess","FedDictionaryAccessAPI"].join("/")],(function(s){var d;(d={tenantId:e.tenantId,lang:e.widget.lang}).onComplete=function(e){i(e)},d.onFailure=function(){a()},s.getResourcesInfo(t,d)}))}))},destroy:function(){this._navImpl.deregisterTagWidget(this.widget.id)},sendInfoMessageEvent:function(e){let t;UWA.is(e,"object")&&Object.keys(e).length&&(t=e),this.predicateView&&this.predicateView.showNewMessageOnView(t)}})}));