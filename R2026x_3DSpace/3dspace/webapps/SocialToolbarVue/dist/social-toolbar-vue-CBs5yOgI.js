var sp=Object.defineProperty;var ap=(ie,O,n)=>O in ie?sp(ie,O,{enumerable:!0,configurable:!0,writable:!0,value:n}):ie[O]=n;var Ye=(ie,O,n)=>ap(ie,typeof O!="symbol"?O+"":O,n);define("DS/SocialToolbarVue/social-toolbar-vue-CBs5yOgI",["require","exports","DS/SocialToolbarVue/vue","DS/SocialToolbarVue/VUEKIT"],function(ie,O,n,ke){"use strict";var vr,yr;class gs extends Error{constructor(o,s,a){const r=o.status||o.status===0?o.status:"",i=o.statusText||"",c=`${r} ${i}`.trim(),l=c?`status code ${c}`:"an unknown error";super(`Request failed with ${l}: ${s.method} ${s.url}`);Ye(this,"response");Ye(this,"request");Ye(this,"options");this.name="HTTPError",this.response=o,this.request=s,this.options=a}}class ws extends Error{constructor(o){super(`Request timed out: ${o.method} ${o.url}`);Ye(this,"request");this.name="TimeoutError",this.request=o}}const bs=(()=>{let e=!1,t=!1;const o=typeof globalThis.ReadableStream=="function",s=typeof globalThis.Request=="function";if(o&&s)try{t=new globalThis.Request("https://empty.invalid",{body:new globalThis.ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type")}catch(a){if(a instanceof Error&&a.message==="unsupported BodyInit type")return!1;throw a}return e&&!t})(),gr=typeof globalThis.AbortController=="function",wr=typeof globalThis.AbortSignal=="function"&&typeof globalThis.AbortSignal.any=="function",br=typeof globalThis.ReadableStream=="function",_r=typeof globalThis.FormData=="function",_s=["get","post","put","patch","head","delete"],kr={json:"application/json",text:"text/*",formData:"multipart/form-data",arrayBuffer:"*/*",blob:"*/*"},ho=2147483647,Cr=new TextEncoder().encode("------WebKitFormBoundaryaxpyiPgbbPti10Rw").length,ks=Symbol("stop"),Er={json:!0,parseJson:!0,stringifyJson:!0,searchParams:!0,prefixUrl:!0,retry:!0,timeout:!0,hooks:!0,throwHttpErrors:!0,onDownloadProgress:!0,onUploadProgress:!0,fetch:!0},Sr={method:!0,headers:!0,body:!0,mode:!0,credentials:!0,cache:!0,redirect:!0,referrer:!0,referrerPolicy:!0,integrity:!0,keepalive:!0,signal:!0,window:!0,dispatcher:!0,duplex:!0,priority:!0},Ar=e=>{if(!e)return 0;if(e instanceof FormData){let t=0;for(const[o,s]of e)t+=Cr,t+=new TextEncoder().encode(`Content-Disposition: form-data; name="${o}"`).length,t+=typeof s=="string"?new TextEncoder().encode(s).length:s.size;return t}if(e instanceof Blob)return e.size;if(e instanceof ArrayBuffer)return e.byteLength;if(typeof e=="string")return new TextEncoder().encode(e).length;if(e instanceof URLSearchParams)return new TextEncoder().encode(e.toString()).length;if("byteLength"in e)return e.byteLength;if(typeof e=="object"&&e!==null)try{const t=JSON.stringify(e);return new TextEncoder().encode(t).length}catch{return 0}return 0},Rr=(e,t)=>{const o=Number(e.headers.get("content-length"))||0;let s=0;return e.status===204?(t&&t({percent:1,totalBytes:o,transferredBytes:s},new Uint8Array),new Response(null,{status:e.status,statusText:e.statusText,headers:e.headers})):new Response(new ReadableStream({async start(a){const r=e.body.getReader();t&&t({percent:0,transferredBytes:0,totalBytes:o},new Uint8Array);async function i(){const{done:c,value:l}=await r.read();if(c){a.close();return}if(t){s+=l.byteLength;const d=o===0?0:s/o;t({percent:d,transferredBytes:s,totalBytes:o},l)}a.enqueue(l),await i()}await i()}}),{status:e.status,statusText:e.statusText,headers:e.headers})},Ur=(e,t)=>{const o=Ar(e.body);let s=0;return new Request(e,{duplex:"half",body:new ReadableStream({async start(a){const r=e.body instanceof ReadableStream?e.body.getReader():new Response("").body.getReader();async function i(){const{done:c,value:l}=await r.read();if(c){t&&t({percent:1,transferredBytes:s,totalBytes:Math.max(o,s)},new Uint8Array),a.close();return}s+=l.byteLength;let d=o===0?0:s/o;(o<s||d===1)&&(d=.99),t&&t({percent:Number(d.toFixed(2)),transferredBytes:s,totalBytes:o},l),a.enqueue(l),await i()}await i()}})})},Yt=e=>e!==null&&typeof e=="object",gn=(...e)=>{for(const t of e)if((!Yt(t)||Array.isArray(t))&&t!==void 0)throw new TypeError("The `options` argument must be an object");return vo({},...e)},Cs=(e={},t={})=>{const o=new globalThis.Headers(e),s=t instanceof globalThis.Headers,a=new globalThis.Headers(t);for(const[r,i]of a.entries())s&&i==="undefined"||i===void 0?o.delete(r):o.set(r,i);return o};function wn(e,t,o){return Object.hasOwn(t,o)&&t[o]===void 0?[]:vo(e[o]??[],t[o]??[])}const Es=(e={},t={})=>({beforeRequest:wn(e,t,"beforeRequest"),beforeRetry:wn(e,t,"beforeRetry"),afterResponse:wn(e,t,"afterResponse"),beforeError:wn(e,t,"beforeError")}),vo=(...e)=>{let t={},o={},s={};for(const a of e)if(Array.isArray(a))Array.isArray(t)||(t=[]),t=[...t,...a];else if(Yt(a)){for(let[r,i]of Object.entries(a))Yt(i)&&r in t&&(i=vo(t[r],i)),t={...t,[r]:i};Yt(a.hooks)&&(s=Es(s,a.hooks),t.hooks=s),Yt(a.headers)&&(o=Cs(o,a.headers),t.headers=o)}return t},Mr=e=>_s.includes(e)?e.toUpperCase():e,Ss={limit:2,methods:["get","put","head","delete","options","trace"],statusCodes:[408,413,429,500,502,503,504],afterStatusCodes:[413,429,503],maxRetryAfter:Number.POSITIVE_INFINITY,backoffLimit:Number.POSITIVE_INFINITY,delay:e=>.3*2**(e-1)*1e3},Tr=(e={})=>{if(typeof e=="number")return{...Ss,limit:e};if(e.methods&&!Array.isArray(e.methods))throw new Error("retry.methods must be an array");if(e.statusCodes&&!Array.isArray(e.statusCodes))throw new Error("retry.statusCodes must be an array");return{...Ss,...e}};async function Pr(e,t,o,s){return new Promise((a,r)=>{const i=setTimeout(()=>{o&&o.abort(),r(new ws(e))},s.timeout);s.fetch(e,t).then(a).catch(r).then(()=>{clearTimeout(i)})})}async function Ir(e,{signal:t}){return new Promise((o,s)=>{t&&(t.throwIfAborted(),t.addEventListener("abort",a,{once:!0}));function a(){clearTimeout(r),s(t.reason)}const r=setTimeout(()=>{t==null||t.removeEventListener("abort",a),o()},e)})}const Nr=(e,t)=>{const o={};for(const s in t)!(s in Sr)&&!(s in Er)&&!(s in e)&&(o[s]=t[s]);return o};class bn{constructor(t,o={}){Ye(this,"request");Ye(this,"abortController");Ye(this,"_retryCount",0);Ye(this,"_input");Ye(this,"_options");var s,a;if(this._input=t,this._options={...o,headers:Cs(this._input.headers,o.headers),hooks:Es({beforeRequest:[],beforeRetry:[],beforeError:[],afterResponse:[]},o.hooks),method:Mr(o.method??this._input.method??"GET"),prefixUrl:String(o.prefixUrl||""),retry:Tr(o.retry),throwHttpErrors:o.throwHttpErrors!==!1,timeout:o.timeout??1e4,fetch:o.fetch??globalThis.fetch.bind(globalThis)},typeof this._input!="string"&&!(this._input instanceof URL||this._input instanceof globalThis.Request))throw new TypeError("`input` must be a string, URL, or Request");if(this._options.prefixUrl&&typeof this._input=="string"){if(this._input.startsWith("/"))throw new Error("`input` must not begin with a slash when using `prefixUrl`");this._options.prefixUrl.endsWith("/")||(this._options.prefixUrl+="/"),this._input=this._options.prefixUrl+this._input}if(gr&&wr){const r=this._options.signal??this._input.signal;this.abortController=new globalThis.AbortController,this._options.signal=r?AbortSignal.any([r,this.abortController.signal]):this.abortController.signal}if(bs&&(this._options.duplex="half"),this._options.json!==void 0&&(this._options.body=((a=(s=this._options).stringifyJson)==null?void 0:a.call(s,this._options.json))??JSON.stringify(this._options.json),this._options.headers.set("content-type",this._options.headers.get("content-type")??"application/json")),this.request=new globalThis.Request(this._input,this._options),this._options.searchParams){const i="?"+(typeof this._options.searchParams=="string"?this._options.searchParams.replace(/^\?/,""):new URLSearchParams(this._options.searchParams).toString()),c=this.request.url.replace(/(?:\?.*?)?(?=#|$)/,i);(_r&&this._options.body instanceof globalThis.FormData||this._options.body instanceof URLSearchParams)&&!(this._options.headers&&this._options.headers["content-type"])&&this.request.headers.delete("content-type"),this.request=new globalThis.Request(new globalThis.Request(c,{...this.request}),this._options)}if(this._options.onUploadProgress){if(typeof this._options.onUploadProgress!="function")throw new TypeError("The `onUploadProgress` option must be a function");if(!bs)throw new Error("Request streams are not supported in your environment. The `duplex` option for `Request` is not available.");this.request.body&&(this.request=Ur(this.request,this._options.onUploadProgress))}}static create(t,o){const s=new bn(t,o),a=async()=>{if(typeof s._options.timeout=="number"&&s._options.timeout>ho)throw new RangeError(`The \`timeout\` option cannot be greater than ${ho}`);await Promise.resolve();let c=await s._fetch();for(const l of s._options.hooks.afterResponse){const d=await l(s.request,s._options,s._decorateResponse(c.clone()));d instanceof globalThis.Response&&(c=d)}if(s._decorateResponse(c),!c.ok&&s._options.throwHttpErrors){let l=new gs(c,s.request,s._options);for(const d of s._options.hooks.beforeError)l=await d(l);throw l}if(s._options.onDownloadProgress){if(typeof s._options.onDownloadProgress!="function")throw new TypeError("The `onDownloadProgress` option must be a function");if(!br)throw new Error("Streams are not supported in your environment. `ReadableStream` is missing.");return Rr(c.clone(),s._options.onDownloadProgress)}return c},i=(s._options.retry.methods.includes(s.request.method.toLowerCase())?s._retry(a):a()).finally(async()=>{var c;s.request.bodyUsed||await((c=s.request.body)==null?void 0:c.cancel())});for(const[c,l]of Object.entries(kr))i[c]=async()=>{s.request.headers.set("accept",s.request.headers.get("accept")||l);const d=await i;if(c==="json"){if(d.status===204||(await d.clone().arrayBuffer()).byteLength===0)return"";if(o.parseJson)return o.parseJson(await d.text())}return d[c]()};return i}_calculateRetryDelay(t){if(this._retryCount++,this._retryCount>this._options.retry.limit||t instanceof ws)throw t;if(t instanceof gs){if(!this._options.retry.statusCodes.includes(t.response.status))throw t;const s=t.response.headers.get("Retry-After")??t.response.headers.get("RateLimit-Reset")??t.response.headers.get("X-RateLimit-Reset")??t.response.headers.get("X-Rate-Limit-Reset");if(s&&this._options.retry.afterStatusCodes.includes(t.response.status)){let a=Number(s)*1e3;Number.isNaN(a)?a=Date.parse(s)-Date.now():a>=Date.parse("2024-01-01")&&(a-=Date.now());const r=this._options.retry.maxRetryAfter??a;return a<r?a:r}if(t.response.status===413)throw t}const o=this._options.retry.delay(this._retryCount);return Math.min(this._options.retry.backoffLimit,o)}_decorateResponse(t){return this._options.parseJson&&(t.json=async()=>this._options.parseJson(await t.text())),t}async _retry(t){try{return await t()}catch(o){const s=Math.min(this._calculateRetryDelay(o),ho);if(this._retryCount<1)throw o;await Ir(s,{signal:this._options.signal});for(const a of this._options.hooks.beforeRetry)if(await a({request:this.request,options:this._options,error:o,retryCount:this._retryCount})===ks)return;return this._retry(t)}}async _fetch(){for(const s of this._options.hooks.beforeRequest){const a=await s(this.request,this._options);if(a instanceof Request){this.request=a;break}if(a instanceof Response)return a}const t=Nr(this.request,this._options),o=this.request;return this.request=o.clone(),this._options.timeout===!1?this._options.fetch(o,t):Pr(o,t,this.abortController,this._options)}}/*! MIT License Â© Sindre Sorhus */const yo=e=>{const t=(o,s)=>bn.create(o,gn(e,s));for(const o of _s)t[o]=(s,a)=>bn.create(s,gn(e,a,{method:o}));return t.create=o=>yo(gn(o)),t.extend=o=>(typeof o=="function"&&(o=o(e??{})),yo(gn(e,o))),t.stop=ks,t},As=yo(),go=n.ref("");function Rs(e){go.value=e}function Xe(){if(!go.value)throw new Error("Registry URL is not defined");return go.value}const wo=n.ref("");function Us(e){wo.value=e}function V(){if(!wo.value)throw new Error("Platform ID is not defined");return wo.value}var Br=Object.defineProperty,Dr=(e,t,o)=>t in e?Br(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Be=(e,t,o)=>Dr(e,typeof t!="symbol"?t+"":t,o);const _n=["trace","debug","log","info","warn","error"];function Lr(){return typeof window>"u"?!1:window.sessionStorage.getItem("DSY_SWYM_DEBUG")||!1}function xr(){return typeof window>"u"?!1:window.localStorage.getItem("logger-debug")||!1}function Or(){return typeof window>"u"?!1:new URL(window.location.href).searchParams.has("debug")}function bo(e){return typeof e=="string"?_n.includes(e)?e:e!=="false":e}function Ms(e){return typeof e=="boolean"?e?0:_n.length:_n.indexOf(e)}class Fr{constructor(){Be(this,"logLevelIndex",Ms(!1)),Be(this,"_log",(o,...s)=>{const a=this._getScope(o),r=this.emojis[o],i=this.styles[o];this._shouldLog(o)&&console[o](`${r} %c[${a}]`,i,...s)}),Be(this,"emojis",{trace:"ðŸ§µ",debug:"ðŸ› ï¸",log:"ðŸ“‹",info:"ðŸ“¢",warn:"ðŸš§",error:"ðŸ”¥"}),Be(this,"styles",{trace:"",debug:"color: white; background: #3d3d3d;",log:"color: black; background: #D5E8F2;",info:"color: black; background: #EDF6EB;",warn:"background: transparent;",error:"background: transparent;"}),Be(this,"_getScope",o=>`LOGGER ${o.toUpperCase().padEnd(5," ")}`),Be(this,"log",this._log.bind(this,"log")),Be(this,"info",this._log.bind(this,"info")),Be(this,"warn",this._log.bind(this,"warn")),Be(this,"debug",this._log.bind(this,"debug")),Be(this,"error",this._log.bind(this,"error")),Be(this,"trace",this._log.bind(this,"trace"));const t=bo(Or())||bo(xr())||bo(Lr());this.logLevelIndex=Ms(t)}_shouldLog(t){return _n.indexOf(t)>=this.logLevelIndex}}const $=new Fr,jr="AmdLoader/AmdLoader.js",Vr="bust=NO_CACHE_ID";let kn;const _o=[],Ts=[];function Ps(e){_o.push(e)}async function Wr(){const e={DS:"."};let t={paths:{...e}},o=Promise.resolve({});for(;_o.length;)o=o.then(_o.pop());try{t=await o}catch(s){$.error("[RequireJS] Failed to load config:",s)}return t.paths={...t.paths,...e},t.urlArgs||(t.urlArgs=Vr),t}async function Gr(){let e=Promise.resolve(void 0);for(;Ts.length;)e=e.then(Ts.pop());try{await e}catch(t){$.error('[RequireJS] Failed to run "after require setup" hooks:',t)}}function Hr(e){if(!window.require)throw new Error("window.require is not initialiazed");window.require.config(e),$.debug("[RequireJS] Set config:",e)}async function zr(e){if(typeof window.require=="function")return;const t=document.createElement("script"),o=new Promise((s,a)=>{t.onload=s,t.onerror=a});t.src=`${e.baseUrl??""}${jr}?${e.urlArgs}`,$.debug("[RequireJS] Download AMDLoader script: ",t.src),document.head.appendChild(t),await o}async function Kr(){if(kn)return kn;let e,t;kn=new Promise((o,s)=>{e=o,t=s}),$.debug("[RequireJS] init");try{const o=await Wr();await zr(o),await Hr(o),await Gr(),e==null||e()}catch{t==null||t()}return kn}async function ko(e,t=!1){return await Kr(),new Promise((o,s)=>{var a,r;(r=(a=t&&window.top?window.top:window).require)==null||r.call(a,e,(...i)=>o(i),s)})}async function ue(e,t=!1){return(await ko([e],t))[0]}async function Is(e,t){if(!t)return Is(e,V());if(!globalThis.document)return Yr(e,t);const o=Xe();return await(await ue("DS/i3DXCompassPlatformServices/i3DXCompassRegistryClient")).getServicesByPlatform({platforms:Array.isArray(t)?[...t]:[t],services:e,config:{url:o}})}async function Yr(e,t){const o=Xe();return await As.get(`${o}/api/v1/platform/service/instance`,{searchParams:{serviceId:e.join(","),platformId:Array.isArray(t)?t.join(","):t}}).json()}async function Je(e,t){var o,s,a;if(!t)return Je(e,V());const r=await Is([e],t);return r.length&&((a=(s=(o=r[0])==null?void 0:o.services)==null?void 0:s.find(i=>i.id.toLowerCase()===e.toLowerCase()))==null?void 0:a.url)||""}var Z=(e=>(e.AIAI="AIAssistantInfra",e.ANALYTICS="3danalytics",e.COMMENT="3DComment",e.COMPASS="3DCompass",e.DASHBOARD="3DDashboard",e.DRIVE="3DDrive",e.LEAN="3dlean",e.LLMINFERENCE="LLMINFERENCE",e.MEDICOLLAB="MedicalCollaboration",e.MESSAGING="3DMessaging",e.ODE="OfficeDocumentEditor",e.ORGANIZATION="3DOrganization",e.PASSPORT="3DPassport",e.RTCOEDIT="RTCoedit",e.SEARCH="3DSearch",e.SOCIAL_MEDIA="SocialMedia",e.SPACE="3DSpace",e.SWYM="3DSwym",e.TAGGER="6WTAG",e.USERS_GROUP="UsersGroup",e))(Z||{});async function Xr(e,{redirectToPassportLogin:t}={redirectToPassportLogin:!0}){const o=await Je(Z.PASSPORT);if(window.location.href.startsWith(o))return;const s=new URL(`${o}/logout`),a=window.location.href;if(t){const r=new URL(`${o}/login`);r.searchParams.set("service",a),s.searchParams.set("redirect",btoa(r.toString()))}else s.searchParams.set("service",a);window.location.href=s.toString()}const Jr=["ERROR_ACCESS_FORBIDDEN_LICENSE_EXPIRED","ERROR_ACCESS_FORBIDDEN_LICENSE_FULLY_CONSUMED","ERROR_LICENSING_EXTENSION_KO","ERROR_ACCESS_NO_LICENSE","ERROR_ACCESS_FORBIDDEN_NO_LICENSE"],Qr="GLOBAL_ERROR_EVENT",Zr="invalid_grant",qr=400;function Xt(e,t){return async(o,s,a)=>{if(a.status!==qr)return;const r=await a.json();if(r.error!==Zr)return;const{access_token:i}=await t(r.x3ds_auth_url,{handlePassportExpiredError:s.handlePassportExpiredError,headers:{"X-Request-Id":""}}).json(),c=new URL(o.url).searchParams;return c.set("ticket",i),s.json&&delete s.body,e(o.url,{...s,searchParams:c})}}const $r="invalid_client",ei=401,ti=async(e,t,o)=>{t.handlePassportExpiredError===!1||o.status!==ei||(await o.json()).error!==$r||Xr()},Ns=403,ni="ERROR_ACCESS_FORBIDDEN_NOT_ACTIVE";async function Bs(e){var t,o;let s,a;try{const{response:r}=e,c=((t=r.headers.get("content-type"))==null?void 0:t.includes("application/json"))?await r.clone().json():null;s=(o=e.response)==null?void 0:o.status,a=c==null?void 0:c.errorcode}catch{}return{errorCode:a,errorStatus:s}}const Co=async e=>{const{errorCode:t,errorStatus:o}=await Bs(e);if(o!==Ns||t!==ni)return e;const s=window.btoa(window.location.href).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,""),a=V(),i=`${await Je(Z.COMPASS,a)}/resources/AppsMngtSynchro/api/v1?service=3DSWYM&url=${s}&platform=${a}`;return window.location.href=i,e},Eo=async e=>{const{errorCode:t,errorStatus:o}=await Bs(e);return o!==Ns||!t||!Jr.includes(t)||window.postMessage({event:Qr,payload:{code:t,status:o}}),e},Bt="X-Request-ID",oi=e=>{e.headers.has(Bt)||e.headers.append(Bt,crypto.randomUUID()),e.headers.get(Bt)||e.headers.delete(Bt)},Ds=e=>{e.headers.has(Bt)&&e.headers.delete(Bt)},je=As.extend({credentials:"include",redirect:"error",headers:{"x-requested-with":"XMLHttpRequest","content-type":"application/json;charset=UTF-8"},timeout:25e3,hooks:{beforeRequest:[oi],afterResponse:[ti]}}),Dt=new Map,si=5e3;function ai(e,t){return e.then(o=>(t.keepCacheOnSuccess||(t.timeMs?setTimeout(()=>{$.debug(`[decorator cache] [${t.key}] cache timeout`),Dt.delete(t.key)},t.timeMs):($.debug(`[decorator cache] [${t.key}] cache timeout`),Dt.delete(t.key))),$.debug(`[decorator cache] [${t.key}] promise succeeded`),o)).catch(o=>{throw t.keepCacheOnError||($.debug(`[decorator cache] [${t.key}] promise failed, clean the cache`),Dt.delete(t.key)),o})}function Qe(e,t,o=si){if(!Dt.get(e)||!o){$.debug(`[decorator cache] [${e}] cache missing, create it`);const s=ai(t(),{key:e,timeMs:o});Dt.set(e,s)}return $.debug(`[decorator cache] [${e}] cache exists`),Dt.get(e)}const Ls=new Map;function Cn(e,t){return Qe(`csrf-${e}`,()=>t("/api/session/info").json().then(o=>o.csrfToken),1)}async function En(e){return e.status!==403?!1:(await e.clone().json()).errorcode==="ERROR_ACCESS_FORBIDDEN_CSRF_KO"}const xs="x-ds-iam-csrftoken";async function ri(e,t){return(await t("/api/authenticated/user/fields")).headers.get(xs)}async function ii(e){return e.status!==403?!1:await e.clone().text()==="The CSRF token cannot be validated"}const Os="x-ds-csrftoken";async function ci(e,t){return(await t("/resources/3ddrive/v1/bos/DSROOT")).headers.get(Os)}async function li(e){return e.status===403}const Sn={[Z.PASSPORT]:{header:xs,fetch:ri,checkIsCsrfError:ii},[Z.DRIVE]:{header:Os,fetch:ci,checkIsCsrfError:li},[Z.SPACE]:{header:"x-ds-csrftoken",fetch:void 0,checkIsCsrfError:void 0},[Z.SWYM]:{header:"x-ds-swym-csrftoken",fetch:Cn,checkIsCsrfError:En},[Z.COMMENT]:{header:"x-ds-swym-csrftoken",fetch:Cn,checkIsCsrfError:En},[Z.SEARCH]:{header:"x-ds-swym-csrftoken",fetch:Cn,checkIsCsrfError:En},[Z.MEDICOLLAB]:{header:"x-ds-swym-csrftoken",fetch:Cn,checkIsCsrfError:En}};function Fs(e,t){Ls.set(e,t||sessionStorage.getItem(`${e}_csrf`)||""),t&&sessionStorage.setItem(`${e}_csrf`,t)}function js(e){return async(t,o)=>{const s=Ls.get(e);if(!s)return;const a=Sn[e].header;t.headers.set(a,s),o.headers.set(a,s)}}function ui(e,t){if(t.status<300){const o=t.headers.get(Sn[e].header);o&&Fs(e,o)}}async function di(e,t){var o,s;try{const a=await((s=(o=Sn[e]).fetch)==null?void 0:s.call(o,e,t));a&&Fs(e,a)}catch(a){$.error(`Failed to fetch CSRF for ${e}`,a)}}function An(e,t){return async(o,s,a)=>{var r,i;if(ui(e,a),!await((i=(r=Sn[e]).checkIsCsrfError)==null?void 0:i.call(r,a)))return;await di(e,t),s.json&&delete s.body;const{Preferences:l}=await new Promise((u,m)=>ie(["./index-_eT7bnZb"],u,m)),{CommonRequest:d}=await new Promise((u,m)=>ie(["./index-DPHuAIED"],u,m));if(l.isNativeApp()&&d.checkHasProxyPath(o.url)){const m=new URL(o.url).searchParams.get("url");if(m)return t(m,s)}return t(o,s)}}async function mi(e,t){const o=await Je(e)||t;if(!o)throw new Error(`Failed to get URL for ${e}`);return new Request(o).url}function Rn(e,t=""){return async(o,s)=>{const{CommonRequest:a}=await new Promise((u,m)=>ie(["./index-DPHuAIED"],u,m)),{Preferences:r}=await new Promise((u,m)=>ie(["./index-_eT7bnZb"],u,m));if(a.checkHasProxyPath(o.url))return;const i=await mi(e,t);if(o.url.startsWith(i))return r.isNativeApp()?await a.request(o.url,{...s,proxy:"passport"},o):void 0;const c=new URL(o.url),l=`${i}${c.pathname}${c.search}`.replace(/([^:]\/)\/+/g,"$1"),d=new Request(l,s);return r.isNativeApp()?await a.request(l,{...s,proxy:"passport"},d):d}}function So(e,t="i18n!DS/SwymVueComponents/assets/nls/",o){const s=n.ref({}),a=new Promise(async i=>{try{const c=await ue(`${t}${e}`);s.value=Object.assign(n.unref(s),c)}catch{$.error(`[TRANSLATION] Error loading nls ${t}${e}`)}i(s.value)});function r(i,c={}){if(!i)return"";let l=n.unref(s)[i];return Object.entries(c).forEach(([d,u])=>{l=l==null?void 0:l.replace(`{${d}}`,u)}),l||i}return{i18n:s,$i18n:r,promise:a}}function yt(e){return n.getCurrentScope()?(n.onScopeDispose(e),!0):!1}function fi(e,t){return n.unref(e)}function ce(e){return typeof e=="function"?e():n.unref(e)}function pi(e){if(!n.isRef(e))return n.reactive(e);const t=new Proxy({},{get(o,s,a){return n.unref(Reflect.get(e.value,s,a))},set(o,s,a){return n.isRef(e.value[s])&&!n.isRef(a)?e.value[s].value=a:e.value[s]=a,!0},deleteProperty(o,s){return Reflect.deleteProperty(e.value,s)},has(o,s){return Reflect.has(e.value,s)},ownKeys(){return Object.keys(e.value)},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}}});return n.reactive(t)}const Un=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const hi=e=>e!=null,vi=Object.prototype.toString,yi=e=>vi.call(e)==="[object Object]",rt=()=>{};function Vs(e,t){function o(...s){return new Promise((a,r)=>{Promise.resolve(e(()=>t.apply(this,s),{fn:t,thisArg:this,args:s})).then(a).catch(r)})}return o}function gi(e,t={}){let o,s,a=rt;const r=c=>{clearTimeout(c),a(),a=rt};return c=>{const l=ce(e),d=ce(t.maxWait);return o&&r(o),l<=0||d!==void 0&&d<=0?(s&&(r(s),s=null),Promise.resolve(c())):new Promise((u,m)=>{a=t.rejectOnCancel?m:u,d&&!s&&(s=setTimeout(()=>{o&&r(o),s=null,u(c())},d)),o=setTimeout(()=>{s&&r(s),s=null,u(c())},l)})}}function wi(...e){let t=0,o,s=!0,a=rt,r,i,c,l,d;!n.isRef(e[0])&&typeof e[0]=="object"?{delay:i,trailing:c=!0,leading:l=!0,rejectOnCancel:d=!1}=e[0]:[i,c=!0,l=!0,d=!1]=e;const u=()=>{o&&(clearTimeout(o),o=void 0,a(),a=rt)};return p=>{const f=ce(i),v=Date.now()-t,g=()=>r=p();return u(),f<=0?(t=Date.now(),g()):(v>f&&(l||!s)?(t=Date.now(),g()):c&&(r=new Promise((y,w)=>{a=d?w:y,o=setTimeout(()=>{t=Date.now(),s=!0,y(g()),u()},Math.max(0,f-v))})),!l&&!o&&(o=setTimeout(()=>s=!0,f)),s=!1,r)}}function bi(e,t){var o;if(typeof e=="number")return e+t;const s=((o=e.match(/^-?\d+\.?\d*/))==null?void 0:o[0])||"",a=e.slice(s.length),r=Number.parseFloat(s)+t;return Number.isNaN(r)?e:r+a}function Ws(e){return n.getCurrentInstance()}function Gs(...e){if(e.length!==1)return n.toRef(...e);const t=e[0];return typeof t=="function"?n.readonly(n.customRef(()=>({get:t,set:rt}))):n.ref(t)}function Ao(e,t=200,o={}){return Vs(gi(t,o),e)}function _i(e,t=200,o=!1,s=!0,a=!1){return Vs(wi(t,o,s,a),e)}function Ro(e,t){Ws()&&n.onBeforeUnmount(e,t)}function ki(e,t=!0,o){Ws()?n.onMounted(e,o):t?e():n.nextTick(e)}function Ci(e=0,t={}){let o=n.unref(e);const s=n.ref(e),{max:a=Number.POSITIVE_INFINITY,min:r=Number.NEGATIVE_INFINITY}=t,i=(m=1)=>s.value=Math.max(Math.min(a,s.value+m),r),c=(m=1)=>s.value=Math.min(Math.max(r,s.value-m),a),l=()=>s.value,d=m=>s.value=Math.max(r,Math.min(a,m));return{count:s,inc:i,dec:c,get:l,set:d,reset:(m=o)=>(o=m,d(m))}}function Ei(e,t=1e3,o={}){const{immediate:s=!0,immediateCallback:a=!1}=o;let r=null;const i=n.ref(!1);function c(){r&&(clearInterval(r),r=null)}function l(){i.value=!1,c()}function d(){const u=ce(t);u<=0||(i.value=!0,a&&e(),c(),r=setInterval(e,u))}if(s&&Un&&d(),n.isRef(t)||typeof t=="function"){const u=n.watch(t,()=>{i.value&&Un&&d()});yt(u)}return yt(l),{isActive:i,pause:l,resume:d}}function Si(e=!1,t={}){const{truthyValue:o=!0,falsyValue:s=!1}=t,a=n.isRef(e),r=n.ref(e);function i(c){if(arguments.length)return r.value=c,r.value;{const l=ce(o);return r.value=r.value===l?ce(s):l,r.value}}return a?i:[r,i]}function Ai(e,t,o){const s=n.watch(e,(...a)=>(n.nextTick(()=>s()),t(...a)),o);return s}function Ve(e,t,o){const s=n.watch(e,(a,r,i)=>{a&&(o!=null&&o.once&&n.nextTick(()=>s()),t(a,r,i))},{...o,once:!1});return s}function Ze(e,t,o){let s;n.isRef(o)?s={evaluating:o}:s={};const{lazy:a=!1,evaluating:r=void 0,shallow:i=!0,onError:c=rt}=s,l=n.ref(!a),d=i?n.shallowRef(t):n.ref(t);let u=0;return n.watchEffect(async m=>{if(!l.value)return;u++;const p=u;let f=!1;r&&Promise.resolve().then(()=>{r.value=!0});try{const v=await e(g=>{m(()=>{r&&(r.value=!1),f||g()})});p===u&&(d.value=v)}catch(v){c(v)}finally{r&&p===u&&(r.value=!1),f=!0}}),a?n.computed(()=>(l.value=!0,d.value)):d}function Te(e){var t;const o=ce(e);return(t=o==null?void 0:o.$el)!=null?t:o}const Pe=Un?window:void 0,Ri=Un?window.document:void 0;function de(...e){let t,o,s,a;if(typeof e[0]=="string"||Array.isArray(e[0])?([o,s,a]=e,t=Pe):[t,o,s,a]=e,!t)return rt;Array.isArray(o)||(o=[o]),Array.isArray(s)||(s=[s]);const r=[],i=()=>{r.forEach(u=>u()),r.length=0},c=(u,m,p,f)=>(u.addEventListener(m,p,f),()=>u.removeEventListener(m,p,f)),l=n.watch(()=>[Te(t),ce(a)],([u,m])=>{if(i(),!u)return;const p=yi(m)?{...m}:m;r.push(...o.flatMap(f=>s.map(v=>c(u,f,v,p))))},{immediate:!0,flush:"post"}),d=()=>{l(),i()};return yt(d),d}function Ui(){const e=n.ref(!1),t=n.getCurrentInstance();return t&&n.onMounted(()=>{e.value=!0},t),e}function Uo(e){const t=Ui();return n.computed(()=>(t.value,!!e()))}function Hs(e,t,o={}){const{window:s=Pe,...a}=o;let r;const i=Uo(()=>s&&"MutationObserver"in s),c=()=>{r&&(r.disconnect(),r=void 0)},l=n.computed(()=>{const p=ce(e),f=(Array.isArray(p)?p:[p]).map(Te).filter(hi);return new Set(f)}),d=n.watch(()=>l.value,p=>{c(),i.value&&p.size&&(r=new MutationObserver(t),p.forEach(f=>r.observe(f,a)))},{immediate:!0,flush:"post"}),u=()=>r==null?void 0:r.takeRecords(),m=()=>{d(),c()};return yt(m),{isSupported:i,stop:m,takeRecords:u}}function Mi(e={}){var t;const{window:o=Pe,deep:s=!0,triggerOnRemoval:a=!1}=e,r=(t=e.document)!=null?t:o==null?void 0:o.document,i=()=>{var d;let u=r==null?void 0:r.activeElement;if(s)for(;u!=null&&u.shadowRoot;)u=(d=u==null?void 0:u.shadowRoot)==null?void 0:d.activeElement;return u},c=n.ref(),l=()=>{c.value=i()};return o&&(de(o,"blur",d=>{d.relatedTarget===null&&l()},!0),de(o,"focus",l,!0)),a&&Hs(r,d=>{d.filter(u=>u.removedNodes.length).map(u=>Array.from(u.removedNodes)).flat().forEach(u=>{u===c.value&&l()})},{childList:!0,subtree:!0}),l(),c}function Ti(e,t={}){const{immediate:o=!0,fpsLimit:s=void 0,window:a=Pe}=t,r=n.ref(!1),i=s?1e3/s:null;let c=0,l=null;function d(p){if(!r.value||!a)return;c||(c=p);const f=p-c;if(i&&f<i){l=a.requestAnimationFrame(d);return}c=p,e({delta:f,timestamp:p}),l=a.requestAnimationFrame(d)}function u(){!r.value&&a&&(r.value=!0,c=0,l=a.requestAnimationFrame(d))}function m(){r.value=!1,l!=null&&a&&(a.cancelAnimationFrame(l),l=null)}return o&&u(),yt(m),{isActive:n.readonly(r),pause:m,resume:u}}function Jt(e,t={}){const{window:o=Pe}=t,s=Uo(()=>o&&"matchMedia"in o&&typeof o.matchMedia=="function");let a;const r=n.ref(!1),i=d=>{r.value=d.matches},c=()=>{a&&("removeEventListener"in a?a.removeEventListener("change",i):a.removeListener(i))},l=n.watchEffect(()=>{s.value&&(c(),a=o.matchMedia(ce(e)),"addEventListener"in a?a.addEventListener("change",i):a.addListener(i),r.value=a.matches)});return yt(()=>{l(),c(),a=void 0}),r}function zs(e,t={}){function o(u,m){let p=ce(e[ce(u)]);return m!=null&&(p=bi(p,m)),typeof p=="number"&&(p=`${p}px`),p}const{window:s=Pe,strategy:a="min-width"}=t;function r(u){return s?s.matchMedia(u).matches:!1}const i=u=>Jt(()=>`(min-width: ${o(u)})`,t),c=u=>Jt(()=>`(max-width: ${o(u)})`,t),l=Object.keys(e).reduce((u,m)=>(Object.defineProperty(u,m,{get:()=>a==="min-width"?i(m):c(m),enumerable:!0,configurable:!0}),u),{});function d(){const u=Object.keys(e).map(m=>[m,i(m)]);return n.computed(()=>u.filter(([,m])=>m.value).map(([m])=>m))}return Object.assign(l,{greaterOrEqual:i,smallerOrEqual:c,greater(u){return Jt(()=>`(min-width: ${o(u,.1)})`,t)},smaller(u){return Jt(()=>`(max-width: ${o(u,-.1)})`,t)},between(u,m){return Jt(()=>`(min-width: ${o(u)}) and (max-width: ${o(m,-.1)})`,t)},isGreater(u){return r(`(min-width: ${o(u,.1)})`)},isGreaterOrEqual(u){return r(`(min-width: ${o(u)})`)},isSmaller(u){return r(`(max-width: ${o(u,-.1)})`)},isSmallerOrEqual(u){return r(`(max-width: ${o(u)})`)},isInBetween(u,m){return r(`(min-width: ${o(u)}) and (max-width: ${o(m,-.1)})`)},current:d,active(){const u=d();return n.computed(()=>u.value.length===0?"":u.value.at(-1))}})}function Pi(e,t,o={}){const{window:s=Pe,...a}=o;let r;const i=Uo(()=>s&&"ResizeObserver"in s),c=()=>{r&&(r.disconnect(),r=void 0)},l=n.computed(()=>{const m=ce(e);return Array.isArray(m)?m.map(p=>Te(p)):[Te(m)]}),d=n.watch(l,m=>{if(c(),i.value&&s){r=new ResizeObserver(t);for(const p of m)p&&r.observe(p,a)}},{immediate:!0,flush:"post"}),u=()=>{c(),d()};return yt(u),{isSupported:i,stop:u}}function Ii(e,t={}){const{delayEnter:o=0,delayLeave:s=0,window:a=Pe}=t,r=n.ref(!1);let i;const c=l=>{const d=l?o:s;i&&(clearTimeout(i),i=void 0),d?i=setTimeout(()=>r.value=l,d):r.value=l};return a&&(de(e,"mouseenter",()=>c(!0),{passive:!0}),de(e,"mouseleave",()=>c(!1),{passive:!0})),r}function Ks(e,t={width:0,height:0},o={}){const{window:s=Pe,box:a="content-box"}=o,r=n.computed(()=>{var m,p;return(p=(m=Te(e))==null?void 0:m.namespaceURI)==null?void 0:p.includes("svg")}),i=n.ref(t.width),c=n.ref(t.height),{stop:l}=Pi(e,([m])=>{const p=a==="border-box"?m.borderBoxSize:a==="content-box"?m.contentBoxSize:m.devicePixelContentBoxSize;if(s&&r.value){const f=Te(e);if(f){const v=f.getBoundingClientRect();i.value=v.width,c.value=v.height}}else if(p){const f=Array.isArray(p)?p:[p];i.value=f.reduce((v,{inlineSize:g})=>v+g,0),c.value=f.reduce((v,{blockSize:g})=>v+g,0)}else i.value=m.contentRect.width,c.value=m.contentRect.height},o);ki(()=>{const m=Te(e);m&&(i.value="offsetWidth"in m?m.offsetWidth:t.width,c.value="offsetHeight"in m?m.offsetHeight:t.height)});const d=n.watch(()=>Te(e),m=>{i.value=m?t.width:0,c.value=m?t.height:0});function u(){l(),d()}return{width:i,height:c,stop:u}}const Qt=new Map;function Ys(e){const t=n.getCurrentScope();function o(c){var l;const d=Qt.get(e)||new Set;d.add(c),Qt.set(e,d);const u=()=>a(c);return(l=t==null?void 0:t.cleanups)==null||l.push(u),u}function s(c){function l(...d){a(l),c(...d)}return o(l)}function a(c){const l=Qt.get(e);l&&(l.delete(c),l.size||r())}function r(){Qt.delete(e)}function i(c,l){var d;(d=Qt.get(e))==null||d.forEach(u=>u(c,l))}return{on:o,once:s,off:a,emit:i,reset:r}}function Ni(e,t={}){const o=Mi(t),s=n.computed(()=>Te(e));return{focused:n.computed(()=>s.value&&o.value?s.value.contains(o.value):!1)}}const Bi={ctrl:"control",command:"meta",cmd:"meta",option:"alt",up:"arrowup",down:"arrowdown",left:"arrowleft",right:"arrowright"};function Di(e={}){const{reactive:t=!1,target:o=Pe,aliasMap:s=Bi,passive:a=!0,onEventFired:r=rt}=e,i=n.reactive(new Set),c={toJSON(){return{}},current:i},l=t?n.reactive(c):c,d=new Set,u=new Set;function m(g,y){g in l&&(t?l[g]=y:l[g].value=y)}function p(){i.clear();for(const g of u)m(g,!1)}function f(g,y){var w,R;const S=(w=g.key)==null?void 0:w.toLowerCase(),b=[(R=g.code)==null?void 0:R.toLowerCase(),S].filter(Boolean);S&&(y?i.add(S):i.delete(S));for(const _ of b)u.add(_),m(_,y);S==="meta"&&!y?(d.forEach(_=>{i.delete(_),m(_,!1)}),d.clear()):typeof g.getModifierState=="function"&&g.getModifierState("Meta")&&y&&[...i,...b].forEach(_=>d.add(_))}de(o,"keydown",g=>(f(g,!0),r(g)),{passive:a}),de(o,"keyup",g=>(f(g,!1),r(g)),{passive:a}),de("blur",p,{passive:!0}),de("focus",p,{passive:!0});const v=new Proxy(l,{get(g,y,w){if(typeof y!="string")return Reflect.get(g,y,w);if(y=y.toLowerCase(),y in s&&(y=s[y]),!(y in l))if(/[+_-]/.test(y)){const S=y.split(/[+_-]/g).map(T=>T.trim());l[y]=n.computed(()=>S.every(T=>ce(v[T])))}else l[y]=n.ref(!1);const R=Reflect.get(g,y,w);return t?ce(R):R}});return v}const Li={page:e=>[e.pageX,e.pageY],client:e=>[e.clientX,e.clientY],screen:e=>[e.screenX,e.screenY],movement:e=>e instanceof Touch?null:[e.movementX,e.movementY]};function xi(e={}){const{type:t="page",touch:o=!0,resetOnTouchEnds:s=!1,initialValue:a={x:0,y:0},window:r=Pe,target:i=r,scroll:c=!0,eventFilter:l}=e;let d=null;const u=n.ref(a.x),m=n.ref(a.y),p=n.ref(null),f=typeof t=="function"?t:Li[t],v=b=>{const _=f(b);d=b,_&&([u.value,m.value]=_,p.value="mouse")},g=b=>{if(b.touches.length>0){const _=f(b.touches[0]);_&&([u.value,m.value]=_,p.value="touch")}},y=()=>{if(!d||!r)return;const b=f(d);d instanceof MouseEvent&&b&&(u.value=b[0]+r.scrollX,m.value=b[1]+r.scrollY)},w=()=>{u.value=a.x,m.value=a.y},R=l?b=>l(()=>v(b),{}):b=>v(b),S=l?b=>l(()=>g(b),{}):b=>g(b),T=l?()=>l(()=>y(),{}):()=>y();if(i){const b={passive:!0};de(i,["mousemove","dragover"],R,b),o&&t!=="movement"&&(de(i,["touchstart","touchmove"],S,b),s&&de(i,"touchend",w,b)),c&&t==="page"&&de(r,"scroll",T,{passive:!0})}return{x:u,y:m,sourceType:p}}function Oi(e,t={}){const{handleOutside:o=!0,window:s=Pe}=t,a=t.type||"page",{x:r,y:i,sourceType:c}=xi(t),l=n.ref(e??(s==null?void 0:s.document.body)),d=n.ref(0),u=n.ref(0),m=n.ref(0),p=n.ref(0),f=n.ref(0),v=n.ref(0),g=n.ref(!0);let y=()=>{};return s&&(y=n.watch([l,r,i],()=>{const w=Te(l);if(!w||!(w instanceof HTMLElement))return;const{left:R,top:S,width:T,height:b}=w.getBoundingClientRect();m.value=R+(a==="page"?s.pageXOffset:0),p.value=S+(a==="page"?s.pageYOffset:0),f.value=b,v.value=T;const _=r.value-m.value,N=i.value-p.value;g.value=T===0||b===0||_<0||N<0||_>T||N>b,(o||!g.value)&&(d.value=_,u.value=N)},{immediate:!0}),de(document,"mouseleave",()=>{g.value=!0})),{x:r,y:i,sourceType:c,elementX:d,elementY:u,elementPositionX:m,elementPositionY:p,elementHeight:f,elementWidth:v,isOutside:g,stop:y}}function Fi(e={}){const{controls:t=!1,interval:o="requestAnimationFrame"}=e,s=n.ref(new Date),a=()=>s.value=new Date,r=o==="requestAnimationFrame"?Ti(a,{immediate:!0}):Ei(a,o,{immediate:!0});return t?{now:s,...r}:s}const ji=[{max:6e4,value:1e3,name:"second"},{max:276e4,value:6e4,name:"minute"},{max:72e6,value:36e5,name:"hour"},{max:5184e5,value:864e5,name:"day"},{max:24192e5,value:6048e5,name:"week"},{max:28512e6,value:2592e6,name:"month"},{max:Number.POSITIVE_INFINITY,value:31536e6,name:"year"}],Vi={justNow:"just now",past:e=>e.match(/\d/)?`${e} ago`:e,future:e=>e.match(/\d/)?`in ${e}`:e,month:(e,t)=>e===1?t?"last month":"next month":`${e} month${e>1?"s":""}`,year:(e,t)=>e===1?t?"last year":"next year":`${e} year${e>1?"s":""}`,day:(e,t)=>e===1?t?"yesterday":"tomorrow":`${e} day${e>1?"s":""}`,week:(e,t)=>e===1?t?"last week":"next week":`${e} week${e>1?"s":""}`,hour:e=>`${e} hour${e>1?"s":""}`,minute:e=>`${e} minute${e>1?"s":""}`,second:e=>`${e} second${e>1?"s":""}`,invalid:""};function Wi(e){return e.toISOString().slice(0,10)}function Gi(e,t={},o=Date.now()){var s;const{max:a,messages:r=Vi,fullDateFormatter:i=Wi,units:c=ji,showSecond:l=!1,rounding:d="round"}=t,u=typeof d=="number"?y=>+y.toFixed(d):Math[d],m=+o-+e,p=Math.abs(m);function f(y,w){return u(Math.abs(y)/w.value)}function v(y,w){const R=f(y,w),S=y>0,T=g(w.name,R,S);return g(S?"past":"future",T,S)}function g(y,w,R){const S=r[y];return typeof S=="function"?S(w,R):S.replace("{0}",w.toString())}if(p<6e4&&!l)return r.justNow;if(typeof a=="number"&&p>a)return i(new Date(e));if(typeof a=="string"){const y=(s=c.find(w=>w.name===a))==null?void 0:s.max;if(y&&p>y)return i(new Date(e))}for(const[y,w]of c.entries()){if(f(m,w)<=0&&c[y-1])return v(m,c[y-1]);if(p<w.max)return v(m,w)}return r.invalid}function Hi(e=null,t={}){var o,s,a;const{document:r=Ri,restoreOnUnmount:i=m=>m}=t,c=(o=r==null?void 0:r.title)!=null?o:"",l=Gs((s=e??(r==null?void 0:r.title))!=null?s:null),d=e&&typeof e=="function";function u(m){if(!("titleTemplate"in t))return m;const p=t.titleTemplate||"%s";return typeof p=="function"?p(m):ce(p).replace(/%s/g,m)}return n.watch(l,(m,p)=>{m!==p&&r&&(r.title=u(typeof m=="string"?m:""))},{immediate:!0}),t.observe&&!t.titleTemplate&&r&&!d&&Hs((a=r.head)==null?void 0:a.querySelector("title"),()=>{r&&r.title!==l.value&&(l.value=u(r.title))},{childList:!0}),Ro(()=>{if(i){const m=i(c,l.value||"");m!=null&&r&&(r.title=m)}}),l}const zi="i18n!DS/SocialToolbarVue/assets/nls/";function ae(e){return So(e,zi)}function gt(e,t){return(o,s)=>{var r;if(["future","past"].includes(e))return o==null?void 0:o.toString();const a=e+(s?"Past":"Future");return(r=t[a])==null?void 0:r.replace("{0}",(o==null?void 0:o.toString())||"")}}function Ki(e,t={}){const{controls:o=!1,updateInterval:s=3e4}=t,{i18n:a}=ae("time-ago"),{now:r,...i}=Fi({interval:s,controls:!0}),c=n.computed(()=>{const l=n.unref(a),d={second:gt("second",l),minute:gt("minute",l),hour:gt("hour",l),day:gt("day",l),week:gt("week",l),month:gt("month",l),year:gt("year",l),future:m=>m,past:m=>m,invalid:l.invalid,justNow:l.justNow},u=ce(e);return u?Gi(new Date(u),{...t,messages:d},ce(r)):""});return o?{timeAgo:c,...i}:c}class Yi{constructor(){return this.appSettings=null,this}setAppPreferences(t){this.appSettings=t}allowODECreationFeature(){return this.appSettings&&this.appSettings.allowODECreationFeature?this.appSettings.allowODECreationFeature:!1}allowODEViewerFeature(){return this.appSettings&&this.appSettings.allowODEViewerFeature?this.appSettings.allowODEViewerFeature:!1}allowODECollabFeature(){return this.appSettings&&this.appSettings.allowODECollabFeature?this.appSettings.allowODECollabFeature:!1}activateNativeWindowBar(){return this.appSettings&&this.appSettings.activateNativeWindowBar?this.appSettings.activateNativeWindowBar:!1}hasMultiWindowsSupport(){return this.appSettings&&this.appSettings.hasMultiWindowsSupport?this.appSettings.hasMultiWindowsSupport:!1}disableTopbarLogout(){return this.appSettings&&this.appSettings.disableTopbarLogout?this.appSettings.disableTopbarLogout:!1}hideMePreferenceLanguage(){return this.appSettings&&this.appSettings.hideMePreferenceLanguage?this.appSettings.hideMePreferenceLanguage:!1}}const Xs=new Yi,Zt=5*1e3;class qt{constructor(){this.set=(t,o)=>new Promise((s,a)=>{const r=setTimeout(()=>{o===void 0?s(null):a(o),this.clear(r)},t);this.ids.push(r)}),this.wrap=(t,o,s)=>Promise.race([t,this.set(o,s)]),this.clear=(...t)=>{this.ids=this.ids.filter(o=>t.includes(o)?(clearTimeout(o),!1):!0)},this.ids=[]}}const $t=(e,t,o)=>new Promise((s,a)=>{(!window||!window.nsWebViewInterface)&&a("No webview interface found!"),window.nsWebViewInterface.emit(e,o),window.nsWebViewInterface.once(t,r=>{s(r)})});class en{constructor(){return this}static emitEventToNativeApp(t,o){try{window&&window.electron&&window.electron.ipcRenderer?window.electron.ipcRenderer.send(t,o):window&&window.nsWebViewInterface&&window.nsWebViewInterface.emit(t,o)}catch(s){console.log(`Failed with reason: ${s}`)}}static async invokeEventToNativeApp(t,o){if(window&&window.electron&&window.electron.ipcRenderer)return await window.electron.ipcRenderer.invoke(t,o);throw new Error("Method not supported!")}static listenEventFromNativeApp(t,o){try{window&&window.electron&&window.electron.ipcRenderer?window.electron.ipcRenderer.on(t,(s,a)=>o(a)):window&&window.nsWebViewInterface&&window.nsWebViewInterface.on(t,s=>o(s))}catch(s){console.log(`Failed with reason: ${s}`)}}static listenOnceEventFromNativeApp(t,o){try{window&&window.electron&&window.electron.ipcRenderer?window.electron.ipcRenderer.once(t,(s,a)=>o(a)):window&&window.nsWebViewInterface&&window.nsWebViewInterface.once(t,s=>o(s))}catch(s){console.log(`Failed with reason: ${s}`)}}static async getAppPreferences(){let t=null;try{if(window&&window.electron)t=await window.electron.getAppPreferences();else if(window&&window.nsWebViewInterface){const o=new qt;try{const s=await o.wrap($t("PreferencesReq:getAppPreferences","PreferencesRes:getAppPreferences",{}),Zt,"Fetch timeout!");return Promise.resolve(s)}catch(s){return console.log(`Failed with reason: ${s}`),o.clear(...o.ids),Promise.reject(s)}}}catch(o){return Promise.reject(o)}return Promise.resolve(t)}static async getSelectedPlatform(){let t=null;try{if(window&&window.electron)t=await window.electron.getPairedPlatform();else if(window&&window.nsWebViewInterface){const o=new qt;try{const s=await o.wrap($t("PreferencesReq:getSelectedPlatform","PreferencesRes:getSelectedPlatform",{}),Zt,"Fetch timeout!");return Promise.resolve(s)}catch(s){return console.log(`Failed with reason: ${s}`),o.clear(...o.ids),Promise.reject(s)}}}catch(o){return Promise.reject(o)}return Promise.resolve(t)}static async getTrackerData(){let t={};try{if(window&&window.electron)t=await window.electron.getTrackerData();else if(window&&window.nsWebViewInterface){const o=new qt;try{const s=await o.wrap($t("PreferencesReq:getTrackerData","PreferencesRes:getTrackerData",{}),Zt,"Fetch timeout!");return Promise.resolve(s)}catch(s){return console.log(`Failed with reason: ${s}`),o.clear(...o.ids),Promise.reject(s)}}}catch(o){return Promise.reject(o)}return Promise.resolve(t)}static async getGDPRPreferences(){let t={};try{if(window&&window.electron)t=await window.electron.getGDPRPreferences();else if(window&&window.nsWebViewInterface){const o=new qt;try{const s=await o.wrap($t("PreferencesReq:getGDPRPreferences","PreferencesRes:getGDPRPreferences",{}),Zt,"Fetch timeout!");return Promise.resolve(s)}catch(s){return console.log(`Failed with reason: ${s}`),o.clear(...o.ids),Promise.reject(s)}}}catch(o){return Promise.reject(o)}return Promise.resolve(t)}static async getCasTicket(t){let o=null;try{if(window&&window.electron)o=await window.electron.getCasTicket(t);else if(window&&window.nsWebViewInterface){const s=new qt;try{const a=Date.now(),r=await s.wrap($t("get-cas-ticket-service","get-cas-ticket-service-response"+a,{service:t,timestamp:a}),Zt,"Fetch timeout!");o=r&&r.casTicket}catch(a){return console.log(`Failed with reason: ${a}`),s.clear(...s.ids),Promise.reject(a)}}}catch(s){return Promise.reject(s)}return Promise.resolve(o)}}class Ae{constructor(){}static setAppProperties(t){t&&(t.appVersion&&typeof t.appVersion<"u"&&(this._appVersion=t.appVersion),this._appProperties=t)}static getAppProperties(){return this._appProperties}static setAppPreferences(t){Xs.setAppPreferences(t)}static isNativeApp(){return window&&typeof window.electron<"u"?!0:!!(window&&window.nsWebViewInterface)}static isMobileApp(){return window&&window.nsWebViewInterface&&!window.electron}static isDesktopApp(){return window&&window.electron}static isNativeSameDomain(t){return window&&window.location&&window.location.hostname===t.hostname}static getNativeAppRequireConfig(){if(this.isNativeApp())return window&&window.nsWAP&&window.nsWAP.appVersion&&typeof window.nsWAP.appVersion<"u"&&(this._appVersion=window.nsWAP.appVersion),{dsEnv:{env:"MOBILE"},proxies:{ajax:`${window.location.origin}/_api/proxy/ajax`,passport:`${window.location.origin}/_api/proxy/passport`},requirePaths:{WAP:`${window.location.origin}/wap/${this._appVersion}`,WAP2:`${window.location.origin}/WapInterface/${this._appVersion}`}}}static async getAppPairingPlatform(){return await en.getSelectedPlatform()}static async getTrackerData(){return await en.getTrackerData()}static async getGDPRPreferences(){return await en.getGDPRPreferences()}static async getCasTicket(t){return await en.getCasTicket(t)}static async intializeNativeAppPreferences(){try{const t=await en.getAppPreferences();t&&(this.setAppProperties(t.appProperties),this.setAppPreferences(t.appFeatureActivation)),console.log("intializeNativeAppPreferences",t)}catch(t){console.log("intializeNativeAppPreferences error",t)}return Promise.resolve()}}Ae._appVersion="1.0";function Xi(e){return e.split(";").map(t=>t.split("=")).reduce((t,[o,s])=>(t[decodeURIComponent(o==null?void 0:o.trim())]=decodeURIComponent(s==null?void 0:s.trim()),t),{})}const Mo=Ae.isNativeApp()?`${window.location.origin}/`:((vr=window.dsDefaultWebappsBaseUrl)==null?void 0:vr.replace("webapps/",""))||`${window.location.origin}/`,Ji=Ae.isNativeApp()?`${Mo}webapps/`:window.dsDefaultWebappsBaseUrl||`${Mo}webapps/`,Qi=Mo+"uwp/",it=((yr=Xi(window.document.cookie))==null?void 0:yr.swymlang)||"en",We=Symbol("SocialToolbarProvidesKey"),wt="[STC]";class U extends Error{constructor(t,o){super(`${wt} ${t}`,o)}}const Zi=n.defineComponent({__name:"a-date-text",props:{date:{},format:{default:"since"}},setup(e){const t=e,o=n.inject(We);if(!o)throw new U("Empty SocialToolbarProvide");const{stcMainElRef:s}=o,a=n.computed(()=>t.date),{timeAgo:r,pause:i,resume:c}=Ki(a,{controls:!0}),l=n.computed(()=>{let d;return t.format==="long"?d=a.value.toLocaleString(it,{dateStyle:"short",timeStyle:"short"}):t.format==="time"?d=a.value.toLocaleTimeString(it,{hour:"2-digit",minute:"2-digit"}):t.format==="date"?d=a.value.toLocaleDateString(it):d=r.value,d});return n.watch(()=>t.format,(d,u)=>{d!=="since"?i():u&&u!=="since"&&c()},{immediate:!0}),(d,u)=>{const m=n.resolveDirective("tooltip");return n.withDirectives((n.openBlock(),n.createElementBlock("span",null,[n.createTextVNode(n.toDisplayString(l.value),1)])),[[m,{attach:n.unref(s),text:a.value.toLocaleString(n.unref(it))}]])}}}),qi={"2xs":"300px",xs:"380px",tiny:"465px",sm:"640px",md:"768px","2md":"960px",lg:"1024px",xl:"1280px","2xl":"1536px","3xl":"1920px"},Js=(()=>{const e={};for(const[t,o]of Object.entries(qi))e[t]=Number.parseInt(o,10);return Object.freeze(e)})();function $i(){const e=document.createElement("div");document.head.appendChild(e);const t=window.getComputedStyle(e).backgroundColor;return document.head.removeChild(e),t}function Qs(e){const t=$i(),o=window.getComputedStyle(e).backgroundColor;return o!==t?o:e.parentElement?Qs(e.parentElement):t}function ec(){var e;try{return(e=globalThis==null?void 0:globalThis.document)==null?void 0:e.cookie.split(";").map(t=>t.split("=")).reduce((t,[o,s])=>(t[decodeURIComponent(o==null?void 0:o.trim())]=decodeURIComponent(s==null?void 0:s.trim()),t),{})}catch{return{}}}const ct=1e4,To=void 0;function Zs(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function Po(){const e=navigator.userAgent.toLowerCase();return/iphone|ipad/i.test(e)||/safari/.test(e)&&!/chrome/.test(e)&&Zs()}function tc(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||Po()}function nc(e){const t=e.style.overflow;(!t||t==="visible")&&(e.style.overflow="hidden");const o=e.clientWidth<e.scrollWidth||e.clientHeight<e.scrollHeight;return e.style.overflow=t,o}const qs=n.ref(""),oc=n.ref("");Hi(qs),n.readonly(qs),n.readonly(oc);const P={log:(...e)=>$.log(wt,...e),info:(...e)=>$.info(wt,...e),warn:(...e)=>$.warn(wt,...e),debug:(...e)=>$.debug(wt,...e),error:(...e)=>$.error(wt,...e),trace:(...e)=>$.trace(wt,...e)};function $s(e){return e.replace(/\/+$/,"")}let tn="",nn,ea,Mn;function sc(e){tn=$s(e.trim())}function ac(e){nn=e}function rc(e){ea={...e}}function ta(){return{...ea}}function na(e){Mn=e}function oa(){var e;return((e=V())==null?void 0:e.toLowerCase())==="onpremise"}function sa(e,t){function o(s){let a=$s(s.trim());if(oa()){const r="resources/AppsMngtRegistry";a.includes(r)||(a=`${a}/${r}`)}return a}try{Xe();return}catch{}if(!e)throw new U("Registry url is required");Rs(o(e))}async function aa(){try{Xe();return}catch{}let e;try{e=await ue("DS/PlatformAPI/PlatformAPI")}catch(o){P.error("Failed to load PlatformAPI",o);return}let t=e.getApplicationConfiguration("app.urls.registry");if(!t&&oa()&&(t=e.getApplicationConfiguration("app.urls.myapps")),!t){P.warn("Fetched registry url is empty");return}sa(t)}function ic(e,t){try{V();return}catch{}if(!e)throw new U("Platform id is required");Us(e)}async function on(e,t){try{Xe()}catch{try{await aa(),Xe()}catch(s){throw P.error(s),new U(`Registry URL is not defined. Not able to get service url for ${e} service`)}}return Je(e,t)}class oe{static removeDotSegments(t){const o=[];function s(a){a==="/.."?o.pop():o.push(a)}return t.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^/]*/g,s),o.join("").replace(/^\//,t.charAt(0)==="/"?"/":"")}static buildUrl(t,o){const s=window.location&&window.location.protocol?window.location.protocol:"http:";if(t=String(t),o=String(o),!oe.isAbsoluteUrl(t))throw new Error("First argument should be a absolute url.");t.substring(0,2)==="//"&&(t=s+t);let a,r,i="";const c=String(t).split("://"),l=c[0],d=c[1],u=d.split("/"),m=u[0];if(o.substring(0,2)==="//")t=l+":"+o;else if(o.split("://").length>1)t=o;else if(o.substring(0,1)==="/")t=l+"://"+m+o;else{for(a=1,r=u.length-1;a<r;a++)i+="/"+u[a];t=l+"://"+m+oe.removeDotSegments(i+"/"+o)}return t}static parseUrl(t){const o=["source","subprotocol","protocol","authority","user","password","domain","port","path","directoryPath","fileName","query","anchor"],s=new RegExp("^(?:(?:(?:([^#.:]+):)?([^#.:]+):)?//)?((?:([^:/]+)(?::([^/]*?))?@)?([^:/?#]*)(?::(\\d*))?)?((/(?:[^?#](?![^?#/]*\\.[^?#/.]+(?:[\\?#]|$)))*/?)?([^?#/]*))?(?:\\?([^#]*))?(?:#(.*))?");let a;const r=s.exec(t),i={};for(a=0;a<o.length;a++)i[o[a]]=r[a]||"";return i.subprotocol&&(i.source=i.source.substr(i.subprotocol.length+1)),i.port||(i.port=i.protocol==="https"?"443":"80"),i.directoryPath&&i.directoryPath.length>0&&(i.directoryPath=i.directoryPath.replace(/\/?$/,"/")),i.domain=i.domain.toLocaleLowerCase(),i.protocol=i.protocol.toLocaleLowerCase(),i}static composeUrl(t){let o="";return t.protocol&&(o=t.protocol+"://",t.subprotocol&&(o=t.subprotocol+":"+o)),t.domain?(o+=t.domain,t.port&&(t.protocol!=="http"||parseInt(t.port,10)!==80)&&(t.protocol!=="https"||parseInt(t.port,10)!==443)&&(o+=":"+t.port)):t.authority&&(o+=t.authority),t.path&&(o+=t.path),t.query&&(o+="?"+t.query),t.anchor&&(o+="#"+t.anchor),o}static matchUrl(t,o){let s,a,r=!1;const i=oe.isAbsoluteUrl(t),c=oe.isAbsoluteUrl(o);return!i&&!c?r=!0:(i?c||(o=oe.buildUrl(t,o)):t=oe.buildUrl(o,t),s=oe.parseUrl(t),a=oe.parseUrl(o),r=["domain","protocol","port"].every(function(l){return s[l]===a[l]||l==="protocol"&&(s[l]===""||a[l]==="")})),r}static isAbsoluteUrl(t){return/^((https?|ftp|file):)?\/\//.test(t)}static toQueryString(t,o){let s,a,r,i;if(oe.is(t,"string"))i=t;else if(oe.is(t.toQueryString,"function"))i=t.toQueryString();else{i=[];for(s in t)t.hasOwnProperty(s)&&(a=t[s],o&&(s=o+"["+oe.capitalize(s)+"]"),oe.is(a)&&(oe.is(a,"object")||oe.is(a,"array")?r=oe.toQueryString(a,s):oe.is(a,"function")||(r=oe.encodeUrl(s)+"="+oe.encodeUrl(a))),r&&i.push(r),r=void 0);i=i.join("&")}return i}static is(t,o){return t&&o?typeof t===o:t?typeof t<"u":!1}static encodeUrl(t){return encodeURIComponent(t).replace(/\./g,"%2e")}static capitalize(t,o="-"){const s=t.split(o);for(let a=0;a<s.length;a++)s[a]=s[a][0].toUpperCase()+s[a].substr(1);return s.join(o)}}class De{constructor(){}static get proxies(){const t=Ae.getNativeAppRequireConfig();if(t&&t.proxies)return t.proxies;const o=window.UWA&&window.UWA.hosts||{},a=o.exposition+"/proxy/",r=o.proxies||{};return Object.assign(Object.assign({},r),{ajax:a+"ajax",resolve:a+"resolve",xml:a+"xml",spreadsheet:a+"spreadsheet",soap:a+"soap",feed:a+"feed",icon:a+"icon",richIcon:a+"richIcon",rss:a+"feed"})}static normalizeRequestHeaders(t){const o={};return t.headers.forEach((s,a)=>{o[a]=s}),o}static checkHasProxyPath(t){if(Ae.isNativeApp()){const o=Ae.getNativeAppRequireConfig();if(o&&o.proxies){for(const s in o.proxies)if(t.startsWith(o.proxies[s]))return!0}}return!1}static async request(t,o,s){if(!t)throw new Error("Bad or missing url argument.");if(!Ae.isNativeApp()||oe.matchUrl(t,window.location))return s;o=o||{};let a;const r=window.location,i="ajax",c=o;c.headers&&!c.normalizedHeaders&&(c.normalizedHeaders=De.normalizeRequestHeaders(s)),c.proxy?t=De.proxifyUrl(t,c):oe.matchUrl(t,r)===!1&&De.allowCrossOriginRequest===!1&&(t=De.proxifyUrl(t,Object.assign(Object.assign({},c),{proxy:i})));const l=["GET","HEAD"].includes(s.method)?void 0:await s.blob();return c.body=l,a=new Request(t,c),a}static proxifyUrl(t,o){if(!t)throw new Error("Bad or missing url argument.");let s;const a=[],r=o.proxy,i=oe.toQueryString,c=De.proxies;if(r&&c[r]){if(!Ae.isNativeApp()||oe.matchUrl(t,window.location)||(s=c[r],t.indexOf(s)===0))return t;if(t.startsWith("https://")&&t.indexOf(":443")>-1&&(t=t.replace(":443","")),o.body&&o.method&&o.method.toUpperCase()==="GET"&&(t+=(t.indexOf("?")>-1?"&":"?")+i(o.body),console.log("DEBUG test proxification handle get",t)),typeof o.proxy=="object"&&a.push(i(o.proxy)),o.normalizedHeaders?a.push(i(o.normalizedHeaders,"headers")):o.headers&&a.push(i(o.headers,"headers")),o.method&&a.push(i({method:o.method})),a.push(i({url:t})),t=s+"?"+a.join("&"),t.length>4096)throw console.log("Error proxify url too long",t),new Error("Proxified url is more than 4096 characters, that is the limit for most of the browsers.")}else throw new Error("Invalid proxy");return t}static deproxifyUrl(t){try{const o=new URL(t);if(De.checkHasProxyPath(t)&&o.searchParams.has("url"))return o.searchParams.get("url")}catch(o){console.error("Deproxify URL error",o)}return t}}De.allowCrossOriginRequest=!1;function Tn(e){try{return De.proxifyUrl(e,{proxy:"passport"})}catch(t){return P.error(e,t),e}}const cc=["src"],lc=n.defineComponent({__name:"a-media-user",props:{login:{default:void 0},hashKey:{default:void 0},hidePresence:{type:Boolean},mode:{default:""},fingerprint:{default:void 0}},setup(e){const t=e,o=n.toRef(t,"login"),s=n.toRef(t,"hashKey"),a=Ze(async()=>await on(Z.SWYM),""),r={tiny:"tiny",medium:"medium",compact:"small",small:"smedium",big:"big","2xl":"bigger","3xl":"blarge","":"medium"},i={tiny:"tiny",medium:"medium",compact:"small",small:"smalldium",big:"big","2xl":"bigger","3xl":"blarge","":"medium"},c=n.computed(()=>{if(!a.value||!(o.value||s.value))return"";let v="/api/user/getpicture/";return o.value?v+=`login/${o.value}`:s.value&&(v+=`hash_key/${s.value}`),t.fingerprint&&(v+=`/fingerprint/${t.fingerprint}`),Tn(`${a.value}${v}`)}),l=n.ref(!1),d=n.computed(()=>l.value?i:r),u=n.useTemplateRef("userPictureEl"),m=n.shallowRef(),p=Ve(()=>a.value?u.value:void 0,async v=>{var g;if(t.hidePresence||!o.value)return p();try{const[y,w]=await ko(["DS/RTVueUserPresenceAPI/RTVueUserPresenceAPI","vuejs"]),R=w.extend(y);m.value=new R({propsData:{login:o.value,tenant:V(),swymUrl:a.value}}),m.value.$mount(),(g=v.parentElement)==null||g.replaceChild(m.value.$el,v),m.value.$el.classList.add(d.value[t.mode])}catch(y){P.error(y)}}),f=Ve(o,v=>{m.value&&(m.value.login=v)});return n.onBeforeUnmount(()=>{p(),f(),m.value&&m.value.$destroy()}),(v,g)=>c.value?(n.openBlock(),n.createElementBlock("img",{key:0,ref:"userPictureEl",class:"stc_media-user",src:c.value},null,8,cc)):n.createCommentVNode("",!0)}}),pe=(e,t)=>{const o=e.__vccOpts||e;for(const[s,a]of t)o[s]=a;return o},uc=pe(lc,[["__scopeId","data-v-c08974af"]]);zs(Js).smaller("sm");const dc={props:{size:{type:String,default:()=>""}}},ra={props:{color:{type:String,default:()=>"default"}}},mc=/^on[^a-z]/,fc=e=>mc.test(e),ia=(e,t)=>{const o={};for(const s in e)fc(s)&&(o[t?s[2].toLowerCase()+s.slice(3):s]=e[s]);return o},pc={name:"vu-icon",mixins:[ra,dc],data:()=>({getListenersFromAttrs:ia}),props:{icon:{required:!0,type:String},withinText:{default:!0,type:Boolean}}};function hc(e,t,o,s,a,r){return n.openBlock(),n.createElementBlock("span",n.mergeProps({class:["vu-icon fonticon",[o.withinText?"fonticon-within-text":"",`fonticon-${o.icon}`,`${e.color}`,`${e.size}`]]},n.toHandlers(e.getListenersFromAttrs(e.$attrs),!0)),null,16)}const vc=pe(pc,[["render",hc],["__scopeId","data-v-b2db80fd"]]),yc=(e,t)=>{const o=e.__vccOpts||e;for(const[s,a]of t)o[s]=a;return o},gc={name:"vu-btn",mixins:[{props:{loading:{type:Boolean,default:()=>!1}}},{props:{active:{type:Boolean,default:()=>!1}}},ra,{props:{modelValue:{type:[Object,String,Number,Array,Boolean,Date],default:()=>""},label:{type:String,default:()=>""},type:{type:String,default:()=>"text"},helper:{type:String,default:()=>""},placeholder:{type:String,default:()=>""},options:{type:Array,default:()=>[]}},emits:["update:modelValue"],computed:{value:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}}},{props:{disabled:{type:Boolean,default:()=>!1}}}],props:{large:{type:Boolean,default:()=>!1},small:{type:Boolean,default:()=>!1},block:{type:Boolean,default:()=>!1},icon:{type:String,required:!1}},data:()=>({getListenersFromAttrs:ia}),components:{VuIcon:vc},computed:{classes(){return[`btn btn-${this.color}`,{"btn-sm":this.small,"btn-lg":this.large,"btn-block":this.block,active:this.active}]}}},wc=["disabled"];function bc(e,t,o,s,a,r){const i=n.resolveComponent("VuIcon"),c=n.resolveDirective("mask");return n.withDirectives((n.openBlock(),n.createElementBlock("button",n.mergeProps({type:"button",disabled:e.disabled},n.toHandlers(e.getListenersFromAttrs(e.$attrs),!0),{class:r.classes}),[o.icon?(n.openBlock(),n.createBlock(i,{key:0,icon:o.icon,color:"inherit"},null,8,["icon"])):n.createCommentVNode("",!0),n.renderSlot(e.$slots,"default",{},void 0,!0)],16,wc)),[[c,e.loading]])}const _c=pe(gc,[["render",bc],["__scopeId","data-v-07fed842"]]);var ca;(ca=ec())!=null&&ca.swymlang,n.ref(),n.ref();function kc(e,t){try{return De.proxifyUrl(e,{proxy:"passport",...t})}catch(o){return $.error(e,o),e}}var Re=(e=>(e.TINY="tiny",e.SMALL="small",e.SMALLDIUM="smalldium",e.SMEDIUM="smedium",e.MEDIUM="medium",e.NORMAL="normal",e.BIG="big",e.BIGGER="bigger",e.BLARGE="blarge",e.LARGE="large",e))(Re||{});const Cc={key:1,class:"user-picture"},Ec=["src"],Sc=n.defineComponent({__name:"user-picture",props:{login:{},hashKey:{},fingerprint:{},hidePresence:{type:Boolean},size:{default:Re.MEDIUM}},setup(e){const t=e,o=n.toRef(t,"login"),s=n.computed(()=>t.size),a=n.toRef(t,"hashKey"),r=Ze(()=>Je(Z.SWYM)),i=n.computed(()=>{if(r.value){let f="/api/user/getpicture/";return o.value?f+=`login/${o.value}`:a.value&&(f+=`hash_key/${a.value}`),t.fingerprint&&(f+=`fingerprint/${t.fingerprint}`),kc(`${r.value}${f}`)}else return}),c=n.computed(()=>({"size-[19px] text-3xs":t.size===Re.TINY,"size-[25px] text-xs":t.size===Re.SMALL,"size-[32px] text-sm":t.size===Re.SMALLDIUM,"size-[34px] text-sm":t.size===Re.SMEDIUM,"size-[38px] text-base":t.size===Re.MEDIUM,"size-[40px] text-lg":t.size===Re.NORMAL,"size-[84px] text-2xl":t.size===Re.BIG,"size-[104px] text-4xl":t.size===Re.BIGGER,"size-[120px] text-6xl":t.size===Re.BLARGE,"size-[125px] text-8xl":t.size===Re.LARGE})),l=n.useTemplateRef("containerEl"),d=n.shallowRef(),u=Ve(l,async f=>{var v;if(!o.value)return u();try{const[g,y]=await ko(["DS/RTVueUserPresenceAPI/RTVueUserPresenceAPI","vuejs"]),w=y.extend(g);d.value=new w({propsData:{login:o.value,tenantId:V(),swymUrl:r.value}}),d.value.$mount(),(v=f.parentElement)==null||v.replaceChild(d.value.$el,f),d.value.$el.classList.add(s.value),p(t.hidePresence)}catch{}}),m=Ve(o,f=>{d.value&&(d.value.login=f)});n.watch(()=>s.value,async(f,v)=>{var g,y;const w=(y=(g=d.value)==null?void 0:g.$el)==null?void 0:y.classList;w&&(w.remove(v),w.add(f))});function p(f){const v=d.value.$el.querySelector(".vu-up-aureole");f&&!(v!=null&&v.classList.contains("hidden"))?v==null||v.classList.add("hidden"):!f&&(v!=null&&v.classList.contains("hidden"))&&(v==null||v.classList.remove("hidden"))}return n.watch(()=>t.hidePresence,f=>p(f)),n.onBeforeUnmount(()=>{u(),m(),d.value&&d.value.$destroy()}),(f,v)=>f.$slots["custom-picture"]?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(["custom-picture",c.value])},[n.renderSlot(f.$slots,"custom-picture",{class:"size-full"})],2)):(n.openBlock(),n.createElementBlock("div",Cc,[n.createElementVNode("img",{ref:"containerEl",class:"max-w-full max-h-full rounded-full",src:i.value},null,8,Ec)]))}});[...Array(256).keys()].map(e=>e.toString(16).padStart(2,"0"));const Ac=Symbol("ASeeMoreInjectKey"),la="inherit",Rc=yc(n.defineComponent({__name:"a-see-more",props:{bgColorBtns:{default:void 0},boldBtns:{type:Boolean,default:!1},bottomFadeColor:{default:void 0},btnsClass:{},disabled:{type:Boolean,default:!1},forceShowSeeMoreBtn:{type:Boolean,default:!1},lineHeightBtns:{default:void 0},maxHeight:{default:"3rem"},preventDefaultSeeMoreBtnBehavior:{type:Boolean,default:!1}},emits:["clickSeeLessBtn","clickSeeMoreBtn"],setup(e,{emit:t}){const o=e,s=t,a=n.inject(Ac,void 0),{$i18n:r}=So("a-see-more"),i=n.useTemplateRef("seeMoreContentCtn"),c=n.computed(()=>n.unref(a==null?void 0:a.disabled)||o.disabled),l=n.computed(()=>o.bottomFadeColor??o.bgColorBtns??la),d=n.ref(o.forceShowSeeMoreBtn),u=n.ref(!1),m=n.ref(o.forceShowSeeMoreBtn),{width:p,height:f}=Ks(i),v=Ao(S,200);n.watch([p,f],()=>v()),n.watch(()=>o.forceShowSeeMoreBtn,()=>{o.forceShowSeeMoreBtn&&(d.value=!0,m.value=!0,u.value=!1),S()});const g=n.computed(()=>{let T=l.value;return i.value&&(!T||T===la)&&(T=Qs(i.value)),{"--bottom-fade-bg-color":T}}),y=n.computed(()=>u.value?"100%":o.maxHeight);function w(){if(u.value&&s("clickSeeLessBtn"),m.value&&s("clickSeeMoreBtn"),o.preventDefaultSeeMoreBtnBehavior){u.value=!1,m.value=!0;return}u.value=!u.value,m.value=!m.value}function R(){c.value||o.forceShowSeeMoreBtn||u.value||!i.value||(d.value=nc(i.value),m.value=d.value,m.value&&(u.value=!1))}function S(){R()}return n.onMounted(()=>{S()}),(T,b)=>c.value?n.renderSlot(T.$slots,"default",{key:0},void 0,!0):(n.openBlock(),n.createElementBlock("div",n.mergeProps({key:1},T.$attrs,{class:"see-more-cmp"}),[n.createElementVNode("div",{ref:"seeMoreContentCtn",class:"see-more-cmp_content-ctn",style:n.normalizeStyle({"max-height":y.value})},[n.renderSlot(T.$slots,"default",{},void 0,!0),d.value&&!u.value?(n.openBlock(),n.createElementBlock("div",{key:0,class:"see-more-cmp_bottom-fade",style:n.normalizeStyle(g.value)},null,4)):n.createCommentVNode("",!0)],4),d.value?(n.openBlock(),n.createElementBlock("div",{key:0,class:n.normalizeClass(["see-more-cmp_see-more-btn-ctn",[{"see-more-cmp_show-see-less-btn":u.value,"see-more-cmp_show-see-more-btn":m.value,"see-more-cmp_bold-btn":o.boldBtns}]])},[n.createVNode(_c,{class:n.normalizeClass(["see-more-cmp_see-more-btn",o.btnsClass]),color:"link",style:n.normalizeStyle(o.lineHeightBtns?`line-height: ${o.lineHeightBtns};`:""),onClick:n.withModifiers(w,["stop"])},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(u.value?n.unref(r)("seeLessBtn"):n.unref(r)("seeMoreBtn")),1)]),_:1},8,["class","style"])],2)):n.createCommentVNode("",!0)],16))}}),[["__scopeId","data-v-1e62f294"]]);var Uc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ua(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Mc(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var o=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};o.prototype=t.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var a=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(o,s,a.get?a:{enumerable:!0,get:function(){return e[s]}})}),o}function bt(e,t){var o,s;if(typeof t=="function")s=t(e),s!==void 0&&(e=s);else if(Array.isArray(t))for(o=0;o<t.length;o++)s=t[o](e),s!==void 0&&(e=s);return e}function Tc(e,t){return e[0]==="-"&&Array.isArray(t)&&/^-\d+$/.test(e)?t.length+parseInt(e,10):e}function Pc(e){return/^\d+$/.test(e)}function Pn(e){return Object.prototype.toString.call(e)==="[object Object]"}function sn(e){return Object(e)===e}function In(e){return Object.keys(e).length===0}var Ic=["__proto__","prototype","constructor"],Nc=function(e){return Ic.indexOf(e)===-1};function Nn(e,t){e.indexOf("[")>=0&&(e=e.replace(/\[/g,t).replace(/]/g,""));var o=e.split(t),s=o.filter(Nc);if(s.length!==o.length)throw Error("Refusing to update blacklisted property "+e);return o}var da=Object.prototype.hasOwnProperty;function K(e,t,o,s){if(!(this instanceof K))return new K(e,t,o,s);typeof t>"u"&&(t=!1),typeof o>"u"&&(o=!0),typeof s>"u"&&(s=!0),this.separator=e||".",this.override=t,this.useArray=o,this.useBrackets=s,this.keepArray=!1,this.cleanup=[]}var Lt=new K(".",!1,!0,!0);function Le(e){return function(){return Lt[e].apply(Lt,arguments)}}K.prototype._fill=function(e,t,o,s){var a=e.shift();if(e.length>0){if(t[a]=t[a]||(this.useArray&&Pc(e[0])?[]:{}),!sn(t[a]))if(this.override)t[a]={};else{if(!(sn(o)&&In(o)))throw new Error("Trying to redefine `"+a+"` which is a "+typeof t[a]);return}this._fill(e,t[a],o,s)}else{if(!this.override&&sn(t[a])&&!In(t[a])){if(!(sn(o)&&In(o)))throw new Error("Trying to redefine non-empty obj['"+a+"']");return}t[a]=bt(o,s)}},K.prototype.object=function(e,t){var o=this;return Object.keys(e).forEach(function(s){var a=t===void 0?null:t[s],r=Nn(s,o.separator).join(o.separator);r.indexOf(o.separator)!==-1?(o._fill(r.split(o.separator),e,e[s],a),delete e[s]):e[s]=bt(e[s],a)}),e},K.prototype.str=function(e,t,o,s){var a=Nn(e,this.separator).join(this.separator);return e.indexOf(this.separator)!==-1?this._fill(a.split(this.separator),o,t,s):o[e]=bt(t,s),o},K.prototype.pick=function(e,t,o,s){var a,r,i,c,l;for(r=Nn(e,this.separator),a=0;a<r.length;a++)if(c=Tc(r[a],t),t&&typeof t=="object"&&c in t){if(a===r.length-1)return o?(i=t[c],s&&Array.isArray(t)?t.splice(c,1):delete t[c],Array.isArray(t)&&(l=r.slice(0,-1).join("."),this.cleanup.indexOf(l)===-1&&this.cleanup.push(l)),i):t[c];t=t[c]}else return;return o&&Array.isArray(t)&&(t=t.filter(function(d){return d!==void 0})),t},K.prototype.delete=function(e,t){return this.remove(e,t,!0)},K.prototype.remove=function(e,t,o){var s;if(this.cleanup=[],Array.isArray(e)){for(s=0;s<e.length;s++)this.pick(e[s],t,!0,o);return o||this._cleanup(t),t}else return this.pick(e,t,!0,o)},K.prototype._cleanup=function(e){var t,o,s,a;if(this.cleanup.length){for(o=0;o<this.cleanup.length;o++)s=this.cleanup[o].split("."),a=s.splice(0,-1).join("."),t=a?this.pick(a,e):e,t=t[s[0]].filter(function(r){return r!==void 0}),this.set(this.cleanup[o],t,e);this.cleanup=[]}},K.prototype.del=K.prototype.remove,K.prototype.move=function(e,t,o,s,a){return typeof s=="function"||Array.isArray(s)?this.set(t,bt(this.pick(e,o,!0),s),o,a):(a=s,this.set(t,this.pick(e,o,!0),o,a)),o},K.prototype.transfer=function(e,t,o,s,a,r){return typeof a=="function"||Array.isArray(a)?this.set(t,bt(this.pick(e,o,!0),a),s,r):(r=a,this.set(t,this.pick(e,o,!0),s,r)),s},K.prototype.copy=function(e,t,o,s,a,r){return typeof a=="function"||Array.isArray(a)?this.set(t,bt(JSON.parse(JSON.stringify(this.pick(e,o,!1))),a),s,r):(r=a,this.set(t,this.pick(e,o,!1),s,r)),s},K.prototype.set=function(e,t,o,s){var a,r,i,c;if(typeof t>"u")return o;for(i=Nn(e,this.separator),a=0;a<i.length;a++){if(c=i[a],a===i.length-1)if(s&&Pn(t)&&Pn(o[c]))for(r in t)da.call(t,r)&&(o[c][r]=t[r]);else if(s&&Array.isArray(o[c])&&Array.isArray(t))for(var l=0;l<t.length;l++)o[i[a]].push(t[l]);else o[c]=t;else(!da.call(o,c)||!Pn(o[c])&&!Array.isArray(o[c]))&&(/^\d+$/.test(i[a+1])?o[c]=[]:o[c]={});o=o[c]}return o},K.prototype.transform=function(e,t,o){return t=t||{},o=o||{},Object.keys(e).forEach((function(s){this.set(e[s],this.pick(s,t),o)}).bind(this)),o},K.prototype.dot=function(e,t,o){t=t||{},o=o||[];var s=Array.isArray(e);return Object.keys(e).forEach((function(a){var r=s&&this.useBrackets?"["+a+"]":a;if(sn(e[a])&&(Pn(e[a])&&!In(e[a])||Array.isArray(e[a])&&!this.keepArray&&e[a].length!==0))if(s&&this.useBrackets){var i=o[o.length-1]||"";return this.dot(e[a],t,o.slice(0,-1).concat(i+r))}else return this.dot(e[a],t,o.concat(r));else s&&this.useBrackets?t[o.join(this.separator).concat("["+a+"]")]=e[a]:t[o.concat(r).join(this.separator)]=e[a]}).bind(this)),t},K.pick=Le("pick"),K.move=Le("move"),K.transfer=Le("transfer"),K.transform=Le("transform"),K.copy=Le("copy"),K.object=Le("object"),K.str=Le("str"),K.set=Le("set"),K.delete=Le("delete"),K.del=K.remove=Le("remove"),K.dot=Le("dot"),["override","overwrite"].forEach(function(e){Object.defineProperty(K,e,{get:function(){return Lt.override},set:function(t){Lt.override=!!t}})}),["useArray","keepArray","useBrackets"].forEach(function(e){Object.defineProperty(K,e,{get:function(){return Lt[e]},set:function(t){Lt[e]=t}})}),K._process=bt;var Bc=K;const Dc=ua(Bc),xt="[SRUT]",lt={log:(...e)=>$.log(xt,...e),info:(...e)=>$.info(xt,...e),warn:(...e)=>$.warn(xt,...e),debug:(...e)=>$.debug(xt,...e),error:(...e)=>$.error(xt,...e),trace:(...e)=>$.trace(xt,...e)},Lc={key:0,class:"srut_presence flex-row flex items-center justify-start pb-2.5 gap-1 text-sm"},xc={class:"srut_presence-string"},Oc=n.defineComponent({__name:"a-user-presence",props:{userLogin:{}},setup(e){const t=n.toRef(e,"userLogin"),o=Ze(async()=>await Je(Z.SWYM),""),s=n.useTemplateRef("userPresence"),a=n.shallowRef();async function r(){try{const i=await ue("DS/RTVueUserPresenceAPI/RTVueUserPresenceAPI");a.value=i.vue3cmp}catch(i){lt.error(i)}}return n.watch(t,async i=>{i&&await r()},{immediate:!0}),(i,c)=>{const l=n.resolveComponent("vu-icon");return n.openBlock(),n.createElementBlock(n.Fragment,null,[n.withDirectives((n.openBlock(),n.createBlock(n.resolveDynamicComponent(a.value),{ref_key:"userPresence",ref:s,login:t.value,"swym-url":n.unref(o),"tenant-id":n.unref(V)()},null,8,["login","swym-url","tenant-id"])),[[n.vShow,!1]]),n.unref(s)?(n.openBlock(),n.createElementBlock("div",Lc,[n.createVNode(l,{class:n.normalizeClass(["srut_presence-icon fonticon ml-0",n.unref(s).fonticon]),icon:" userPresence.fonticon",style:n.normalizeStyle(`color:${n.unref(s).color}`)},null,8,["class","style"]),n.createElementVNode("span",xc,n.toDisplayString(n.unref(s).presenceString),1)])):n.createCommentVNode("",!0)],64)}}}),Fc="i18n!DS/SocialRichUserTooltip/assets/nls/";function Bn(e){return So(e,Fc)}const jc=1e4,Vc=2**31-1,Wc=Vc,Gc=[["subject6wuri","subject_uri"],["uri","subject_uri"]];function Io(e){return Gc.forEach(([t,o])=>{Dc.move(t,o,e.result)}),e}function Hc(e){return e.replace(/\/+$/,"")}function Dn(){var e;return((e=V())==null?void 0:e.toLowerCase())==="onpremise"}function ma(e,t){function o(s){let a=Hc(s.trim());if(Dn()){const r="resources/AppsMngtRegistry";a.includes(r)||(a=`${a}/${r}`)}return a}try{Xe();return}catch{}if(!e)throw new Error("Registry url is required");Rs(o(e))}async function zc(){try{Xe();return}catch{}let e;try{e=await ue("DS/PlatformAPI/PlatformAPI")}catch(o){lt.error("Failed to load PlatformAPI",o);return}let t=e.getApplicationConfiguration("app.urls.registry");if(!t&&Dn()&&(t=e.getApplicationConfiguration("app.urls.myapps")),!t){lt.warn("Fetched registry url is empty");return}ma(t)}function Kc(e,t){try{V();return}catch{}if(!e)throw new Error("Platform id is required");Us(e)}const Yc=async e=>{var t;const{response:o}=e,s=(t=o.headers.get("content-type"))!=null&&t.includes("application/json")?await o.clone().json():null;if(s)if(s.errorcode){const a=e;return a.errorcode=`${s.errorcode}`,a.errorid=`${s.errorid}`,a.errormsg=`${s.errormsg}`,a}else e.data=s;return e},ut=je.extend({hooks:{beforeRequest:[js(Z.SWYM),Rn(Z.SWYM)],afterResponse:[(...e)=>An(Z.SWYM,ut)(...e),(...e)=>Xt(ut,je)(...e)],beforeError:[Co,Eo,Yc]}});function Xc(){try{return Qe("current-user",()=>ut.get("/api/user/getcurrent").json(),6e4)}catch{throw new Error("Error fetching current user")}}function Jc(e){try{return Qe(`user-login-${e}`,()=>ut.post("/api/user/find",{json:{params:{login:e}}}).json(),6e4)}catch{throw new Error("Error fetching user by login")}}function Qc(e){try{return Qe(`user-invitation-status-${e}`,()=>ut.post("/api/network/getinvitationstatus",{json:{params:{hash_key:e}}}).json(),2e4)}catch{throw new Error("Error getting invitation status")}}function Zc(e){try{return ut.post("/api/notification/send",{json:{params:{do:"invite",message:e.message,recipient_hash:e.recipient_hash,type:"Network"}}}).json()}catch{throw new Error("Error adding user to network")}}async function qc(e,t){try{return ut.post("/api/directmessages",{json:{users:e,...t?{topic:t}:void 0}}).json().then(Io).catch(o=>{if(o.response.status===409)return Io(o.data);throw new Error(o)})}catch{throw new Error("Error creating Swym conversation")}}async function $c(e){try{return ut.get(`/api/directmessages/private/?login=${e}&unhide=true`).json().then(Io)}catch{throw new Error("Error getting Swym conversation")}}async function fa(e){const t=(await $c(e.userLogin)).result;if(t)return t;{const o=[e.connectedUserLogin,e.userLogin];return Dn()?(await qc(o)).result:await(await ue("DS/RTConvAPI/RTConvAPI")).getConv({logins:o,platformId:e.platformId})}}async function el(e,t){const o=await ue("DS/RTAudioVideoAPI/RTAudioVideoAPI"),s=await fa(t);o.startCall({topic:s==null?void 0:s.topic,type:e,logins:s==null?void 0:s.users.map(a=>a.login).filter(a=>a!==t.connectedUserLogin),dmId:s==null?void 0:s.id,subjectUri:s.subject_uri})}const pa=n.ref(),Ln=n.readonly(pa);async function tl(){try{const e=(await Xc()).result;pa.value=e}catch(e){lt.error("Fail to retrieve current user.",e)}}function No(e="",t=""){return`${e} ${t}`.trim()}function nl(e){return!!e&&!!e.login&&!!e.first_name&&!!e.last_name&&!!e.hash_key}const ol=n.defineComponent({__name:"modal-add-user-to-network",props:{displayName:{},hashKey:{},showModal:{type:Boolean}},emits:["close"],setup(e,{emit:t}){const o=e,s=t,{$i18n:a}=Bn("rich-user-tooltip"),r=n.computed(()=>{var c,l;return a("messageModalAddNetwork",{connected_user:No((c=Ln.value)==null?void 0:c.first_name,(l=Ln.value)==null?void 0:l.last_name)})});async function i(){(await Zc({recipient_hash:o.hashKey,message:r.value})).result.success?ke.message.create({text:a("successAddToNetwork"),color:"success",timeout:jc}):ke.message.create({text:a("errorMessageModalNetwork"),color:"error",timeout:Wc}),s("close")}return(c,l)=>{const d=n.resolveComponent("vu-textarea"),u=n.resolveComponent("vu-btn"),m=n.resolveComponent("vu-modal");return n.openBlock(),n.createBlock(m,{class:"srut_modal-add-user","no-mobile":!0,show:c.showModal,"show-cancel-icon":"",title:n.unref(a)("titleModalAddToNetwork",{user:o.displayName}),onClose:l[2]||(l[2]=p=>s("close")),onConfirm:i},{"modal-body":n.withCtx(()=>[n.createVNode(d,{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=p=>r.value=p),label:n.unref(a)("labelMessageModalNetwork")},null,8,["modelValue","label"])]),"modal-footer":n.withCtx(()=>[n.createVNode(u,{color:"primary",onClick:i},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(n.unref(a)("primaryButtonModalNetwork")),1)]),_:1}),n.createVNode(u,{onClick:l[1]||(l[1]=p=>s("close"))},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(n.unref(a)("cancelButtonModalNetwork")),1)]),_:1})]),_:1},8,["show","title"])}}});var an=(e=>(e[e.NotInNetwork=0]="NotInNetwork",e[e.InvitationSentPending=1]="InvitationSentPending",e[e.InNetwork=2]="InNetwork",e))(an||{});const sl={class:"srut_actions mr-4 pb-1.5"},al={class:"srut_collaborate ml-auto gap-1"},rl=n.defineComponent({__name:"m-actions",props:{userLogin:{},firstName:{},hashKey:{},lastName:{},disableDefaultNavigation:{type:Boolean,default:!0}},emits:["goToConversation","isModalOpen","hideRichUserTooltipCmp"],setup(e,{emit:t}){var o;const s=e,a=t,{$i18n:r}=Bn("rich-user-tooltip"),i=n.ref(!1),c={connectedUserLogin:(o=Ln.value)==null?void 0:o.login,userLogin:s.userLogin,platformId:V()},l=n.ref(),d=n.computed(()=>l.value===an.InvitationSentPending);n.watch(()=>s.hashKey,async(g,y)=>{if(g&&g!==y)try{if(s.hashKey){const w=(await Qc(s.hashKey)).result,R=w.user_in_network,S=w.connected_user_to_user;R===1?l.value=an.InNetwork:S==="new"?l.value=an.InvitationSentPending:l.value=an.NotInNetwork}}catch(w){lt.error(w)}},{immediate:!0});async function u(g){if(s.disableDefaultNavigation)a("goToConversation",g);else{const y=`${await Je(Z.SWYM)}/dm/${g}`;window.open(y,"_blank")}}function m(g){i.value=g,a("isModalOpen",g)}async function p(){const g=await fa(c);u(g.subject_uri)}const f=!Dn();async function v(g,y){a("hideRichUserTooltipCmp"),await el(g,y)}return(g,y)=>{const w=n.resolveComponent("vu-icon-btn"),R=n.resolveDirective("tooltip");return n.openBlock(),n.createElementBlock("div",sl,[n.withDirectives(n.createVNode(w,{class:n.normalizeClass({"vu-icon-btn cursor-default":d.value,"srut_add-to-network-btn":!d.value}),disabled:d.value,icon:"user-add",onClick:y[0]||(y[0]=S=>m(!0))},null,8,["class","disabled"]),[[R,d.value?n.unref(r)("invitationSent"):n.unref(r)("addToMyNetwork"),void 0,{bottom:!0}]]),n.createElementVNode("div",al,[n.withDirectives(n.createVNode(w,{class:"srut_conversation",icon:"chat-alt",onClick:p},null,512),[[R,n.unref(r)("startAConversation"),void 0,{bottom:!0}]]),f?n.withDirectives((n.openBlock(),n.createBlock(w,{key:0,class:"srut_audio-call",icon:"phone",onClick:y[1]||(y[1]=S=>v("audio",c))},null,512)),[[R,n.unref(r)("startAVoiceCall"),void 0,{bottom:!0}]]):n.createCommentVNode("",!0),f?n.withDirectives((n.openBlock(),n.createBlock(w,{key:1,class:"srut_video-call",icon:"videocamera",onClick:y[2]||(y[2]=S=>v("video",c))},null,512)),[[R,n.unref(r)("startAVideoCall"),void 0,{bottom:!0}]]):n.createCommentVNode("",!0),f?n.withDirectives((n.openBlock(),n.createBlock(w,{key:2,class:"srut_screen-share",icon:"monitor",onClick:y[3]||(y[3]=S=>v("screen",c))},null,512)),[[R,n.unref(r)("startAScreenShare"),void 0,{bottom:!0}]]):n.createCommentVNode("",!0),(n.openBlock(),n.createBlock(n.Teleport,{to:"body"},[n.createVNode(ol,{"display-name":n.unref(No)(g.firstName,g.lastName),"hash-key":g.hashKey,"show-modal":i.value,onClose:y[4]||(y[4]=S=>m(!1))},null,8,["display-name","hash-key","show-modal"])]))])])}}}),ha=(e,t)=>{const o=e.__vccOpts||e;for(const[s,a]of t)o[s]=a;return o},il=ha(rl,[["__scopeId","data-v-5bfd2706"]]),cl={class:"srut_header"},ll={class:"srut_info-container px-2.5 py-2"},ul={class:"srut_login m-0 py-0.5"},dl={class:"srut_profile-picture p-2.5"},ml={class:"srut_presence-company-and-country px-2.5 pt-2 pb-3"},fl={key:0,class:"flex flex-row gap-1.5 items-center"},pl={key:0,class:"srut_company line-clamp-1 overflow-hidden text-ellipsis break-all font-bold text-xs text-grey-8"},hl={key:1,class:"srut_external font-bold text-xs text-orange-1"},vl={key:1,class:"srut_country"},yl={class:"srut_country-flag w-3.5 items-center justify-center"},gl={class:"srut_country-name line-clamp-1 overflow-hidden text-ellipsis break-all text-xs py-1 text-grey-8"},wl=n.defineComponent({__name:"m-rich-user-tooltip-body",props:{company:{},countryCode:{},firstName:{},hashKey:{},isExternalUser:{type:Boolean},lastName:{},login:{},onTooltip:{type:Boolean,default:!1},disableDefaultNavigation:{type:Boolean},disableActionsPanel:{type:Boolean}},emits:["update:modalOpened","update:onTooltip","goToConversation","goToProfile","hideRchUserTooltipCmp"],setup(e,{emit:t}){const o=e,s=t,{$i18n:a}=Bn("rich-user-tooltip"),{$i18n:r}=Bn("country-iso2-code"),i=n.defineAsyncComponent(()=>new Promise((m,p)=>ie(["./country-flag.esm-CKE0nO_6"],m,p))),c=n.computed(()=>{var m;return((m=Ln.value)==null?void 0:m.login)===o.login}),l=n.ref(!1);function d(){l.value||s("update:onTooltip",!1)}function u(){s("update:onTooltip",!0)}return n.watch(l,()=>{l.value?s("update:modalOpened",!0):s("update:onTooltip",!1)}),(m,p)=>{const f=n.resolveDirective("tooltip");return n.openBlock(),n.createElementBlock("div",{class:"srut_body",onMouseenter:u,onMouseleave:d},[n.createElementVNode("div",cl,[n.createElementVNode("div",ll,[n.withDirectives((n.openBlock(),n.createElementBlock("a",{class:"srut_username m-0 py-0.5",onClick:p[0]||(p[0]=v=>s("goToProfile"))},[n.createTextVNode(n.toDisplayString(n.unref(No)(m.firstName,m.lastName)),1)])),[[f,n.unref(a)("viewProfile"),void 0,{top:!0}]]),n.createElementVNode("p",ul,n.toDisplayString(m.login.toUpperCase()),1)])]),n.createElementVNode("div",dl,[n.withDirectives((n.openBlock(),n.createElementBlock("div",{class:"srut_avatar-wrapper relative ring-2 ring-white rounded-full cursor-pointer",onClick:p[1]||(p[1]=v=>s("goToProfile"))},[n.createVNode(n.unref(Sc),{"hide-presence":"",login:m.login,size:n.unref(Re).BIG},null,8,["login","size"])])),[[f,n.unref(a)("viewProfile"),void 0,{top:!0}]])]),n.createElementVNode("div",ml,[n.createVNode(Oc,{"user-login":m.login},null,8,["user-login"]),m.company||m.isExternalUser?(n.openBlock(),n.createElementBlock("div",fl,[m.company?(n.openBlock(),n.createElementBlock("span",pl,n.toDisplayString(m.company),1)):n.createCommentVNode("",!0),m.isExternalUser?(n.openBlock(),n.createElementBlock("span",hl,n.toDisplayString(n.unref(a)("external")),1)):n.createCommentVNode("",!0)])):n.createCommentVNode("",!0),m.countryCode?(n.openBlock(),n.createElementBlock("div",vl,[n.createElementVNode("div",yl,[n.createVNode(n.unref(i),{country:m.countryCode,rounded:"",size:"small"},null,8,["country"])]),n.createElementVNode("span",gl,n.toDisplayString(n.unref(r)(m.countryCode)),1)])):n.createCommentVNode("",!0)]),!c.value&&!m.disableActionsPanel?(n.openBlock(),n.createBlock(il,{key:0,"disable-default-navigation":m.disableDefaultNavigation,"first-name":m.firstName,"hash-key":m.hashKey,"last-name":m.lastName,"user-login":m.login,onGoToConversation:p[2]||(p[2]=v=>s("goToConversation",v)),onHideRichUserTooltipCmp:p[3]||(p[3]=v=>s("hideRchUserTooltipCmp")),onIsModalOpen:p[4]||(p[4]=v=>l.value=v)},null,8,["disable-default-navigation","first-name","hash-key","last-name","user-login"])):n.createCommentVNode("",!0)],32)}}}),bl=ha(wl,[["__scopeId","data-v-73e9c35d"]]);function _l(e){return e.split(";").map(t=>t.split("=")).reduce((t,[o,s])=>(t[decodeURIComponent(o==null?void 0:o.trim())]=decodeURIComponent(s==null?void 0:s.trim()),t),{})}var va;const Bo=Ae.isNativeApp()?`${window.location.origin}/`:((va=window.dsDefaultWebappsBaseUrl)==null?void 0:va.replace("webapps/",""))||`${window.location.origin}/`,kl=Ae.isNativeApp()?`${Bo}webapps/`:window.dsDefaultWebappsBaseUrl||`${Bo}webapps/`,Cl="uwp/",El=Bo+Cl;var ya;const Sl=((ya=_l(window.document.cookie))==null?void 0:ya.swymlang)||"en";async function Al(){const e={DS:".",vuejs:"./vuejs/2.6.10/vue.min","vu-kit":"./vuekit/vu-kit.umd",vuex:"./vuex/3.1.1/vuex.min"},t=Ae.getNativeAppRequireConfig();return t&&Object.assign(e,t.requirePaths),window.require?window.require&&window.widget?{paths:e}:{}:{baseUrl:kl,waitSeconds:60,paths:{...e,ds:`${El}resources/0/0/wp/script`,"DS/UWPClientCode/UWA":"UWA2/js",UWA:"UWA2/js",vendors:"vendors"},config:{i18n:{locale:Sl},"DS/Logger/Logger":{disableLog:!0}},skipDataMain:!0}}function Rl(){Ps(async e=>({...e,...await Al()}))}const Ul="1.5.1",Ml=n.defineComponent({__name:"t-rich-user-tooltip",props:{disabled:{type:Boolean},disableDefaultNavigation:{type:Boolean,default:!0},disableActionsPanel:{type:Boolean},parentElement:{},platformId:{},show:{type:Boolean},userLogin:{},urls:{}},emits:["update:onTooltip","goToConversation","goToProfile"],setup(e,{emit:t}){const o=e,s=t;Rl();const a=n.ref(!1),r=n.ref(!1);async function i(){if(o.disableDefaultNavigation)r.value=!1,s("goToProfile");else{const f=`${await Je(Z.SWYM)}/home?profile=${o.userLogin}`;window.open(f,"_blank")}}function c(f){r.value=!1,s("goToConversation",f)}const l=n.ref();function d(f){l.value=Te(f)}const u=n.ref({first_name:"",hash_key:"",last_name:"",login:o.userLogin}),m=n.computed(()=>{var f;return((f=u.value)==null?void 0:f.tenant_user_status)==="1"});function p({props:f}){function v(){Kc(f.platformId);const y=f.urls;y!=null&&y.registryUrl?ma(y.registryUrl):zc()}function g(){tl()}v(),g()}return Ve(()=>o.show&&!o.disabled,async()=>{a.value=!1;try{if(!o.userLogin)return;const f=await Jc(o.userLogin);f.result.hash_key&&(u.value.hash_key=f.result.hash_key),f.result.first_name&&(u.value.first_name=f.result.first_name),f.result.last_name&&(u.value.last_name=f.result.last_name),f.result.company&&(u.value.company=f.result.company),f.result.tenant_user_status&&(u.value.tenant_user_status=f.result.tenant_user_status),f.result.country_code&&(u.value.country_code=f.result.country_code)}catch(f){lt.error(f)}},{immediate:!0}),n.onBeforeMount(()=>{lt.debug("version",Ul),lt.debug("props",o),p({props:o})}),(f,v)=>{const g=n.resolveComponent("vu-popover");return f.disabled&&!f.parentElement?n.renderSlot(f.$slots,"default",{key:0,setRef:d}):f.disabled&&f.parentElement?(n.openBlock(),n.createBlock(n.resolveDynamicComponent(f.parentElement),{key:1})):(n.openBlock(),n.createBlock(g,{key:2,animate:"",arrow:"",class:"rich-user-tooltip","content-class":["srut_popover",{hidden:a.value}],show:(f.show||r.value)&&n.unref(nl)(u.value),side:"bottom",type:"popover"},{body:n.withCtx(()=>{var y,w,R,S,T,b,_;return[(y=u.value)!=null&&y.login?(n.openBlock(),n.createBlock(bl,{key:0,company:(w=u.value)==null?void 0:w.company,"country-code":(R=u.value)==null?void 0:R.country_code,"disable-actions-panel":f.disableActionsPanel,"disable-default-navigation":f.disableDefaultNavigation,"first-name":(S=u.value)==null?void 0:S.first_name,"hash-key":(T=u.value)==null?void 0:T.hash_key,"is-external-user":m.value,"last-name":(b=u.value)==null?void 0:b.last_name,login:(_=u.value)==null?void 0:_.login,onGoToConversation:v[0]||(v[0]=N=>c(N)),onGoToProfile:i,onHideRchUserTooltipCmp:v[1]||(v[1]=N=>r.value=!1),"onUpdate:modalOpened":v[2]||(v[2]=N=>a.value=!0),"onUpdate:onTooltip":v[3]||(v[3]=N=>r.value=N)},null,8,["company","country-code","disable-actions-panel","disable-default-navigation","first-name","hash-key","is-external-user","last-name","login"])):n.createCommentVNode("",!0)]}),default:n.withCtx(()=>[f.parentElement?(n.openBlock(),n.createBlock(n.resolveDynamicComponent(f.parentElement),{key:0})):n.renderSlot(f.$slots,"default",{key:1,setRef:d})]),_:3},8,["content-class","show"]))}}}),Do=n.defineComponent({__name:"a-rich-user-tooltip",props:{userLogin:{},disabled:{type:Boolean,default:!1}},emits:["close","goToProfile"],setup(e,{emit:t}){const o=e,s=t,a=n.ref(!1),r=n.ref(),i=n.computed(()=>r.value),c=Ii(i,{delayEnter:700,delayLeave:100});function l(p){r.value=Te(p)}const d=Ze(async()=>await on(Z.SWYM),"");async function u(p){const f=`${d.value}/dm/${p}`;window.open(f,"_blank")}function m(){s("goToProfile",o.userLogin),s("close")}return(p,f)=>o.disabled?n.renderSlot(p.$slots,"default",{key:1,setRef:l}):(n.openBlock(),n.createBlock(n.unref(Ml),{key:0,"on-tooltip":a.value,"onUpdate:onTooltip":f[0]||(f[0]=v=>a.value=v),"disable-actions-panel":!n.unref(d),"disable-default-navigation":"","platform-id":n.unref(V)(),show:n.unref(c),urls:{registryUrl:n.unref(Xe)()},"user-login":p.userLogin,onGoToConversation:u,onGoToProfile:m},{default:n.withCtx(()=>[n.renderSlot(p.$slots,"default",{setRef:l})]),_:3},8,["on-tooltip","disable-actions-panel","platform-id","show","urls","user-login"]))}});var Lo=(e=>(e.Time="time",e))(Lo||{}),xn=(e=>(e.Reverse="reverse_time",e.Time="time",e))(xn||{}),_t=(e=>(e[e.Employee=0]="Employee",e[e.Contractor=1]="Contractor",e[e.Guest=2]="Guest",e))(_t||{}),ga=(e=>(e.Active="active",e))(ga||{}),xo=(e=>(e.ModeratedByAuthor="moderatedByAuthor",e.NotModerated="notModerated",e))(xo||{});const Tl=async e=>{var a;const{response:t}=e,s=((a=t.headers.get("content-type"))==null?void 0:a.includes("application/json"))?await t.clone().json():null;if(s)if(s.errorcode){const r=e;return r.errorcode=`${s.errorcode}`,r.errorid=`${s.errorid}`,r.errormsg=`${s.errormsg}`,r}else e.data=s;return e},On=je.extend({hooks:{beforeRequest:[js(Z.SWYM),Rn(Z.SWYM)],afterResponse:[(...e)=>An(Z.SWYM,On)(...e),(...e)=>Xt(On,je)(...e)],beforeError:[Co,Eo,Tl]}});function Pl(e){return On.post("/api/user/find",{json:{params:{login:e}},tracker:{category:"CurrentUserRequest",label:"getUserByLogin",pd:{crud:"read"}}}).json()}function Fn(e="",t=""){return`${e} ${t}`.trim()}function rn(e){return e.displayName||Fn(e.firstName,e.lastName)}async function Il(e){const t=(await Pl(e)).result;return rn({firstName:t.first_name,lastName:t.last_name})}function wa(e){return!!(e&&e.login&&(e.firstName&&e.lastName||e.displayName))}const Nl={class:"stc_user-picture-and-date_user-ctn"},Bl={class:"stc_user-picture-and-date_user-name-and-date-ctn"},Dl=["data-guest","data-login"],Ll={class:"stc_user-picture-and-date_full-name"},xl={key:0,class:"stc_user-picture-and-date_guest-stamp"},Oo=pe(n.defineComponent({__name:"user-picture-and-date",props:{date:{default:void 0},dateFormat:{default:"since"},disableRichUserTooltip:{type:Boolean},hidePresence:{type:Boolean,default:!1},mode:{default:""},user:{default:()=>({})}},emits:["clickOnUserName","clickOnUserPicture"],setup(e,{emit:t}){const o=e,s=t,a=n.inject(We);if(!a)throw new U("Empty SocialToolbarProvide");const{stcMainElRef:r}=a,{$i18n:i}=ae("social-toolbar"),{user:c}=n.toRefs(o),l=Ze(async()=>{const{firstName:u,lastName:m,login:p}=c.value;return u&&m?rn(c.value):p?await Il(p):""},""),d=n.computed(()=>c.value.status===_t.Guest);return(u,m)=>{const p=n.resolveDirective("tooltip");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["stc_user-picture-and-date_main-ctn",{"stc_mode-small":o.mode==="small","stc_mode-compact":o.mode==="compact","stc_guest-user":d.value}])},[n.createVNode(Do,{disabled:o.disableRichUserTooltip,"user-login":n.unref(c).login||""},{default:n.withCtx(({setRef:f})=>[n.withDirectives((n.openBlock(),n.createElementBlock("div",{ref:v=>f(v),class:"stc_user-picture-and-date_user-picture-ctn",onClick:m[0]||(m[0]=n.withModifiers(v=>!d.value&&s("clickOnUserPicture"),["stop"]))},[n.createVNode(uc,{class:"stc_user-picture-and-date_user-picture","hide-presence":o.hidePresence,login:n.unref(c).login,mode:o.mode},null,8,["hide-presence","login","mode"])])),[[p,o.disableRichUserTooltip?{attach:n.unref(r),text:n.unref(l)}:void 0]])]),_:1},8,["disabled","user-login"]),n.createElementVNode("div",Nl,[n.createElementVNode("div",Bl,[n.createVNode(Do,{disabled:o.disableRichUserTooltip,"user-login":n.unref(c).login||""},{default:n.withCtx(({setRef:f})=>[n.withDirectives((n.openBlock(),n.createElementBlock("a",{ref:v=>f(v),class:"stc_user-picture-and-date_full-name-wrapper","data-guest":d.value,"data-login":n.unref(c).login,onClick:m[1]||(m[1]=n.withModifiers(v=>!d.value&&s("clickOnUserName"),["stop"]))},[n.createElementVNode("span",Ll,n.toDisplayString(n.unref(l)),1),d.value?(n.openBlock(),n.createElementBlock("span",xl," ("+n.toDisplayString(n.unref(i)("guestAuthorStamp"))+") ",1)):n.createCommentVNode("",!0)],8,Dl)),[[p,o.disableRichUserTooltip?{attach:n.unref(r),text:n.unref(l)}:void 0]])]),_:1},8,["disabled","user-login"]),o.date?(n.openBlock(),n.createBlock(Zi,{key:0,class:"stc_user-picture-and-date_date","data-date":o.date.getTime(),date:o.date,format:o.dateFormat},null,8,["data-date","date","format"])):n.createCommentVNode("",!0)]),n.renderSlot(u.$slots,"default",{},void 0,!0)])],2)}}}),[["__scopeId","data-v-12f7e45f"]]);var Ot=(e=>(e.MobileDevice="app.config.mobile_device",e))(Ot||{}),L=(e=>(e.AddMedia="app.feature.add_media",e.Comment="app.feature.comment",e.CommentLike="app.feature.comment_like",e.DisplayMedia="app.feature.display_media",e.Like="app.feature.like",e.Reply="app.feature.reply",e.RichUserTooltip="app.feature.rich_user_tooltip",e.SeeMore="app.feature.see_more",e.Share="app.feature.share",e.ShowMediaOnClick="app.feature.show_media_on_click",e.ShowUserProfile="app.feature.show_user_profile",e.ShowUsersGroupProfile="app.feature.show_users_group_profile",e.UserMention="app.feature.user_mention",e.UserMentionAnonymization="app.feature.user_mention_anonymization",e))(L||{});const jn=n.ref(),xe=n.reactive({}),Ol={disableAddMedia:!1,disableComment:!1,disableCommentLike:!1,disableDisplayMedia:!1,disableLike:!1,disableReply:!1,disableRichUserTooltip:!1,disableSeeMore:!1,disableShare:!1,disableShowMediaOnClick:!1,disableShowUserProfile:!1,disableShowUsersGroupProfile:!1,disableUserMention:!1,disableUserMentionAnonymisation:!1},Fl={disableAddMedia:L.AddMedia,disableComment:L.Comment,disableCommentLike:L.CommentLike,disableDisplayMedia:L.DisplayMedia,disableLike:L.Like,disableReply:L.Reply,disableRichUserTooltip:L.RichUserTooltip,disableSeeMore:L.SeeMore,disableShare:L.Share,disableShowMediaOnClick:L.ShowMediaOnClick,disableShowUserProfile:L.ShowUserProfile,disableShowUsersGroupProfile:L.ShowUsersGroupProfile,disableUserMention:L.UserMention,disableUserMentionAnonymisation:L.UserMentionAnonymization};function jl(e){Object.entries(e).forEach(([t,o])=>{const a=Fl[t];xe[a]=!o})}function Ft(e,t){xe[e]=typeof t=="boolean"?t:!xe[e]}function Vl(){const e=!!jn.value&&!!xe[L.AddMedia]&&!!xe[L.DisplayMedia];Ft(L.AddMedia,e)}function Wl(){const e=!!jn.value&&!!xe[L.DisplayMedia];Ft(L.DisplayMedia,e)}async function Gl(){const e=[{key:L.DisplayMedia,initial:!!xe[L.DisplayMedia],initFn:Wl},{key:L.AddMedia,initial:!!xe[L.AddMedia],initFn:Vl}];if(jn.value!==void 0){e.forEach(({initFn:o})=>o());return}e.forEach(({key:o})=>Ft(o,!1));const t=await on(Z.SOCIAL_MEDIA);jn.value=!!t,t?e.forEach(({key:o,initial:s})=>Ft(o,s)):P.debug("Social-Media service not available"),e.forEach(({initFn:o})=>o())}function Hl(){const e=!xe[Ot.MobileDevice]&&!!xe[L.RichUserTooltip];Ft(L.RichUserTooltip,e)}async function ba(e){const t=Zs()&&(tc()||Po());Ft(Ot.MobileDevice,t),jl(Object.assign(Ol,e)),await Promise.allSettled([Gl().catch(o=>P.error(o)),Hl()])}function se(e){return n.computed(()=>xe[n.unref(e)])}let W="",Vn="";function zl(e){W=e}function Kl(e){var t;if(e){Vn=e;return}try{Vn=((t=globalThis.widget)==null?void 0:t.getValue("appId"))||""}catch(o){P.error("Missing appId props.",o),Vn=""}}function _a(e,t){const o={...e};return Object.keys(e).forEach(s=>{const a=e[s],r=t?t(a):a;r===void 0?delete o[s]:o[s]=r}),o}function Yl(e){let t;if(typeof e=="string")t=e;else if(typeof e=="number"||typeof e=="boolean")t=`${e}`;else if(typeof e=="object")try{t=JSON.stringify(e)}catch(o){P.warn("Fail to getSafePDValue of:",e,o)}return t}function Xl(e){const t={};return t.pd1=e.component,t.pd2=e.commentUri,t.pd3=e.commentKind,t.pd4=e.mediaType,t.pd5=e.mediaUri,t}function Jl(e){const t={};return t.pd1=e.api,t.pd2=e.method,t.pd3=e.crud,t.pd10=e.xRequestId,e.responseError&&(t.pd11=e.responseError),t}function Ql(e){const t={};return t.pv4=e.responseStatusCode,t.pv12=e.time,e.nbElements&&(t.pv5=e.nbElements),t}function Zl(e){let t={};return typeof e=="object"&&("component"in e&&e.component?t=Xl(e):"api"in e&&e.api?t=Jl(e):P.warn("Unknown format",e)),t}function ql(e){let t={};return typeof e=="object"&&("responseStatusCode"in e?t=Ql(e):P.warn("Unknown format",e)),t}function $l(){return{}}const eu=globalThis==null?void 0:globalThis.location.search.includes("debuglog=tracker");function qe(e){function t(){return{pd20:W}}function o(a,r){const{category:i,label:c,event:l,pd:d,pv:u}=r;return{eventCategory:`SocialToolbarVue.${i}`,eventAction:l,eventLabel:c,appID:Vn,tenant:V(),persDim:_a({...Zl({component:a,...d}),...t()},Yl),persVal:_a({...ql(u),...$l()})}}async function s(a){try{const r=await ue("DS/WebTrackerUsage/TrackerAPI"),i=o(e,a);eu&&P.debug("trackPageEvent",i),r.trackPageEvent(i)}catch(r){P.error("Error in trackPageEvent",r)}}return{trackPageEvent:s}}const tu=10,nu=200;function ka({fetch:e,merge:t,resolve:o,options:s}){let a=[],r;const i=async()=>{if(r&&clearTimeout(r),r=void 0,!a.length)return;const c=a.slice();a=[];let l;try{l=await e(t(c.map(d=>d[0])))}catch(d){c.forEach(u=>u[2](d));return}c.forEach(d=>o([l,d]))};return s!=null&&s.sendBeforeUnload&&window.addEventListener("beforeunload",i),c=>new Promise((l,d)=>{s!=null&&s.sanitizer&&(a=s==null?void 0:s.sanitizer(a,[c,l,d])),a.push([c,l,d]),a.length===((s==null?void 0:s.limit)??tu)?i():r||(r=setTimeout(i,(s==null?void 0:s.throttle)??nu))})}const Ca="_STC_CURRENT_SERVICE_ID_",he={header:"",token:void 0,fetch:Sa,checkIsCsrfError:du};function Wn(e){const t=`${Ca}@${he.header}@csrf`;he.token=e||sessionStorage.getItem(t)||"",e&&sessionStorage.setItem(t,e)}function ou(){return async(e,t)=>{const o=he.token,s=he.header;!s||!o||(e.headers.set(s,o),t.headers.set(s,o))}}const su=20;let Ea=0;function au(){const e=Ea;return e>=su?!0:(Ea=e+1,!1)}function ru(e){return async(t,o,s)=>{var l,d;if(s.status<300){const u=he.header;if(u){const m=s.headers.get(u);m&&Wn(m)}}const a=await((l=he.checkIsCsrfError)==null?void 0:l.call(he,s));if(!a||a&&au())return;const r=await((d=he.fetch)==null?void 0:d.call(he,e));r&&Wn(r),o.json&&delete o.body;const{Preferences:i}=await new Promise((u,m)=>ie(["./index-_eT7bnZb"],u,m)),{CommonRequest:c}=await new Promise((u,m)=>ie(["./index-DPHuAIED"],u,m));if(i.isNativeApp()&&c.checkHasProxyPath(t.url)){const m=new URL(t.url).searchParams.get("url");if(m)return e(m,o)}return e(t,o)}}function iu(e,t){if(!e&&t)throw new U("Empty service CSRF name for current service");e&&(he.header=e),t&&Wn(t)}function cu(){return he.header?!!he.token:!0}function lu(){return{[he.header]:he.token}}function Sa(e){return Qe(`csrf-${Ca}`,()=>e("/commentproxy/session/info").json().then(t=>t.csrfToken),1)}async function uu(){cu()||Wn(await Sa(ne))}async function du(e){return e.status===403}function mu(){return async(e,t)=>{const{CommonRequest:o}=await new Promise((l,d)=>ie(["./index-DPHuAIED"],l,d)),{Preferences:s}=await new Promise((l,d)=>ie(["./index-_eT7bnZb"],l,d));if(o.checkHasProxyPath(e.url))return;const a=new Request(tn).url;if(e.url.startsWith(a))return s.isNativeApp()?await o.request(e.url,{...t,proxy:"passport"},e):void 0;const r=new URL(e.url),i=`${a}${r.pathname}${r.search}`.replace(/([^:]\/)\/+/g,"$1"),c=new Request(i,t);return s.isNativeApp()?await o.request(i,{...t,proxy:"passport"},c):c}}const fu=async e=>{var a;const{response:t}=e,s=((a=t.headers.get("content-type"))==null?void 0:a.includes("application/json"))?await t.clone().json():null;return s&&(e.data=s),e};function pu(){return async(e,t)=>{const o=ta();if(o)for(const s in o){const a=o[s];e.headers.set(s,a),t.headers.set(s,a)}}}function hu(){return[pu(),ou(),mu()]}const ne=je.extend({hooks:{beforeRequest:hu(),afterResponse:[(...e)=>ru(ne)(...e),(...e)=>Xt(ne,je)(...e)],beforeError:[Co,Eo,fu]}});function Aa(e){return!e||e.startsWith("0000")?new Date:!e.includes("T")&&!e.endsWith("Z")?new Date(`${e.split(" ").join("T")}Z`):new Date(e)}function Fo(e){const{author:t,creationDate:o}=e;return{...e,author:Wo(t),creationDate:new Date(o)}}function jo(e){const{author:t,creationDate:o,currentUserEndorse:s,modificationDate:a}=e;return{...e,author:Wo(t),creationDate:Aa(o),currentUserEndorse:s?Fo(s):void 0,modificationDate:Aa(a)}}function Vo(e){return(e||[]).map(t=>jo(t))}function Wo(e){return{displayName:Fn(e.firstName,e.lastName),firstName:e.firstName,lastName:e.lastName,login:e.login,status:e.status}}function vu(e){let t;return e&&(t={displayName:Fn(e.firstname,e.lastname),firstName:e.firstname,lastName:e.lastname,login:e.id}),{info:t,isAdmin:e==null?void 0:e.admin,isGuest:!1}}async function yu(){try{const e=await ue("DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices");return new Promise(t=>{e.getUser({platformId:V(),onComplete(o){t(vu(o))},onFailure(){t({isAdmin:!1,isGuest:!0})}})})}catch(e){throw P.error(e),new U("Fail to fetch current user from Compass")}}const Go=je.extend({hooks:{beforeRequest:[Ds,Rn(Z.PASSPORT)],afterResponse:[(...e)=>An(Z.PASSPORT,Go)(...e),(...e)=>Xt(Go,je)(...e)]}});function gu(e){const t=e.fields;return{displayName:Fn(t.firstName,t.lastName),firstName:t.firstName,lastName:t.lastName,login:t.username,status:_t.Guest}}async function wu(){return await Go.get("/api/authenticated/user/me",{tracker:{category:"CurrentUserRequest",label:"fetchUserFromPassport",pd:{crud:"read"}}}).then(e=>e.json().then(t=>gu(t)))}const Gn=n.ref({}),kt=n.readonly(Gn),Ho=n.ref(!1);n.readonly(Ho);const Hn=n.ref(!1),zn=n.readonly(Hn),Kn=n.ref(!1),Yn=n.readonly(Kn);let zo=!1;const Ra=n.ref(!1),Ua=n.readonly(Ra);function bu(e){Kn.value=e,zo=!0}function Ma(e){Ra.value=e}async function _u({user:e,isGuest:t}){t&&(Hn.value=!0),e&&(zn.value&&(e.status=_t.Guest),Gn.value=e);try{const o=await yu();if(Ho.value=!!o.isAdmin,Hn.value=t||!!o.isGuest,wa(o.info)){const s=o.info;zn.value&&(s.status=_t.Guest),Gn.value={...kt.value,...s}}else throw new U("Empty user info from 3DCompass services")}catch(o){const s=await wu();Ho.value=!1,Hn.value=!0,wa(s)?(s.status=_t.Guest,Gn.value=s):P.error("Fail to retrieve current user.",o)}}async function ku(){if(zo)return Yn.value;try{Kn.value=(await xu({subjectUri:W})).result}catch(e){P.error(e),Kn.value=!1}return zo=!0,Yn.value}const Ta=n.ref("en"),Cu=n.readonly(Ta);function Eu(e){var t;Ta.value=e||((t=window.widget)==null?void 0:t.lang)||"en"}function Pa(e){const t=e.get("X-3DComment-Has-Moderation-Rights");return typeof t=="string"?t==="true":void 0}function Ia(e){const t=e.get("X-3DComment-Has-Guest-Access");return typeof t=="string"?t==="true":void 0}async function Su({subjectUri:e,subjectUris:t,page:o=0,limit:s=8,sort:a=Lo.Time,order:r=xn.Reverse,trackerLabel:i}){return ne.get(`/commentproxy/subjects/${t??e}/contributions`,{searchParams:{tenant:V(),page_number:o,page_size:s,sort_by:a,order_by:r},tracker:{category:"SubjectRequest",label:i,pd:{crud:"read"}}}).then(c=>c.json().then(l=>{const d={};function u(f,{subjectUri:v,subjectUris:g}){return typeof v=="string"?!Object.hasOwn(f,v):g&&g.length===1?!Object.hasOwn(f,g[0]):!1}function m({target:f,subjectUri:v,contribution:g}){const y={...g,comments:Vo(g.comments)};f[v]=y}if(u(l.result,{subjectUri:e,subjectUris:t})){const f=Array.isArray(t)?t[0]:e,v=l.result;m({target:d,subjectUri:f,contribution:v})}else{const f=l.result;(Array.isArray(t)?t:e.split(",")).forEach(g=>{const y=f[g];m({target:d,subjectUri:g,contribution:y})})}const p={hasModerationRights:Pa(c.headers),hasGuestAccess:Ia(c.headers),subjectUris:d};return{...l,result:p}}))}const Na=ka({fetch:Su,merge:e=>{const t=e.map(o=>o.subjectUri||"");return{...e.pop(),subjectUris:t}},resolve:([e,[t,o]])=>{o(e)}});function Au(e){return Qe(`get-comments-mutualized-${e.subjectUri}`,()=>Na({...e,trackerLabel:"getComments"}),1)}function Ru({subjectUri:e}){return Qe(`get-comments-stats-mutualized-${e}`,()=>Na({subjectUri:e,limit:0,trackerLabel:"getCommentsStats"}),1)}async function Uu({subjectUri:e,offset:t,pageNumber:o=0,totalPages:s=1,totalEntries:a=1,limit:r=10,order:i=xn.Time}){return ne.get(`/commentproxy/subjects/${e}/comments`,{searchParams:{tenant:V(),page_size:r,offset:t,order_by:i,page_number:o,total_pages:s,total_entries:a},tracker:{category:"SubjectRequest",label:"getCommentsFromOffset",pd:{crud:"read"}}}).json().then(c=>({...c,result:Vo(c.result)}))}async function Mu({commentUri:e,subjectUri:t,page:o=0,offset:s=0,limit:a=8,sort:r=Lo.Time,order:i=xn.Reverse}){return ne.get(`/commentproxy/subjects/${t}/comments/${e}`,{searchParams:{tenant:V(),page_number:o,offset:s,page_size:a,sort_by:r,order_by:i},tracker:{category:"CommentRequest",label:"getReplies",pd:{crud:"read",commentUri:e,commentKind:"comment"}}}).then(c=>c.json().then(l=>{const d={hasModerationRights:Pa(c.headers),hasGuestAccess:Ia(c.headers),replies:Vo(l.result)};return{...c,result:d}}))}async function Ba({subjectUri:e,page:t=0,limit:o=8}){return ne.get(`/commentproxy/subjects/${e}/comments/users`,{searchParams:{tenant:V(),page_number:t,page_size:o},tracker:{category:"SubjectRequest",label:"getUsersWhoComment",pd:{crud:"read"}}}).json().then(s=>s)}async function Da({subjectUri:e,page:t=0,limit:o=8}){return ne.get(`/commentproxy/subjects/${e}/endorses/users`,{searchParams:{tenant:V(),page_number:t,page_size:o},tracker:{category:"SubjectRequest",label:"getUsersWhoLike",pd:{crud:"read"}}}).json().then(s=>s)}async function La({commentUri:e,subjectUri:t,page:o=0,limit:s=8,trackerCommentKind:a}){return ne.get(`/commentproxy/subjects/${t}/comments/${e}/endorses/users`,{searchParams:{tenant:V(),page_number:o,page_size:s},tracker:{category:"CommentRequest",label:"getUsersWhoLike",pd:{crud:"read",commentUri:e,commentKind:a}}}).json().then(r=>r)}async function Tu({subjectUri:e}){const t={appForcedLinkUri:nn,author:{displayName:kt.value.displayName||""}};return t.appForcedLinkUri||delete t.appForcedLinkUri,ne.post(`/commentproxy/subjects/${e}/endorses/me`,{json:t,searchParams:{tenant:V()},tracker:{category:"SubjectRequest",label:"like",pd:{crud:"create"}}}).json().then(o=>({...o,result:Fo(o.result)}))}async function Pu({endorseUri:e,subjectUri:t}){return ne.delete(`/commentproxy/subjects/${t}/endorses/${e}`,{searchParams:{tenant:V()},tracker:{category:"SubjectRequest",label:"unlike",pd:{crud:"delete"}}}).json().then(o=>o)}async function Iu({commentUri:e,subjectUri:t,trackerCommentKind:o}){const s={appForcedLinkUri:nn,author:{displayName:kt.value.displayName||""}};return s.appForcedLinkUri||delete s.appForcedLinkUri,ne.post(`/commentproxy/subjects/${t}/comments/${e}/endorses/me`,{json:s,searchParams:{tenant:V()},tracker:{category:"CommentRequest",label:"like",pd:{crud:"create",commentUri:e,commentKind:o}}}).json().then(a=>({...a,result:Fo(a.result)}))}async function Nu({endorseUri:e,commentUri:t,subjectUri:o,trackerCommentKind:s}){return ne.delete(`/commentproxy/subjects/${o}/comments/${t}/endorses/${e}`,{searchParams:{tenant:V()},tracker:{category:"CommentRequest",label:"unlike",pd:{crud:"delete",commentUri:t,commentKind:s}}}).json().then(a=>a)}async function Bu({richMessage:e,subjectUri:t,parentCommentUri:o}){const s={appForcedLinkUri:nn,author:{displayName:kt.value.displayName||""},parentCommentUri:o,richMessage:e};return s.appForcedLinkUri||delete s.appForcedLinkUri,ne.post(`/commentproxy/subjects/${encodeURIComponent(t)}/comments`,{json:s,searchParams:{tenant:V()},tracker:{category:"SubjectRequest",label:"addComment",pd:{crud:"create"}}}).json().then(a=>({...a,result:jo(a.result)}))}async function Du({richMessage:e,subjectUri:t,commentUri:o,parentCommentUri:s,trackerCommentKind:a}){const r={appForcedLinkUri:nn,parentCommentUri:s,richMessage:e,commentUri:o};return r.appForcedLinkUri||delete r.appForcedLinkUri,ne.put(`/commentproxy/subjects/${t}/comments/${o}`,{json:r,searchParams:{tenant:V()},tracker:{category:"CommentRequest",label:"edit",pd:{crud:"update",commentUri:o,commentKind:a}}}).json().then(i=>({...i,result:jo(i.result)}))}async function Lu({subjectUri:e,commentUri:t,trackerCommentKind:o}){return ne.delete(`/commentproxy/subjects/${e}/comments/${t}`,{searchParams:{tenant:V()},tracker:{category:"CommentRequest",label:"remove",pd:{crud:"delete",commentUri:t,commentKind:o}}}).then()}async function xu({subjectUri:e}){return Qe(`moderation-rights-${e}`,()=>ne.get(`/commentproxy/subjects/${e}/moderationrights`,{searchParams:{tenant:V()},tracker:{category:"SubjectRequest",label:"hasModerationRights",pd:{crud:"read"}}}).json(),6e4*5)}function Ou({author:e,parentCommentUri:t,richMessage:o}){return{accessState:ga.Active,author:e,commentUri:"",creationDate:new Date,nbEndorses:0,nbReplies:0,modificationDate:new Date,moderationState:xo.NotModerated,parentCommentUri:t,subjectUri:"",richMessage:o,_acl:{update:{access:!0},delete:{access:!0},forward:{access:!1}}}}const Fu={class:"stc_modal-users-list_list-ctn"},Xn=10,ju=pe(n.defineComponent({__name:"modal-users-list",props:{usersWho:{},commentUri:{default:void 0},trackerOpts:{}},emits:["close","clickOnUser"],setup(e,{emit:t}){const o=e,s=t,a={like:"usersWhoLikedModalTitle",comment:"usersWhoCommentedModalTitle"},r=n.inject(We);if(!r)throw new U("Empty SocialToolbarProvide");const{trackPageEvent:i}=qe("modal-users-list"),{$i18n:c}=ae("social-toolbar"),l=se(L.RichUserTooltip),d=n.ref(-1),u=n.computed(()=>o.commentUri||W),m=n.ref(!0),p=n.useTemplateRef("scrollerCmp"),f=n.ref([]);async function v(){var w;d.value+=1;let y;if(o.usersWho==="like"&&(o.commentUri?y=(await La({subjectUri:W,commentUri:o.commentUri,limit:Xn,page:d.value,trackerCommentKind:o.trackerOpts.commentKind})).result:y=(await Da({subjectUri:W,limit:Xn,page:d.value})).result),o.usersWho==="comment"&&(y=(await Ba({subjectUri:W,limit:Xn,page:d.value})).result),!y)throw new U("No users found");f.value.push(...y),y.length<Xn&&(m.value=!1),(w=p.value)==null||w.stopLoading()}function g(y){y.login&&s("clickOnUser",y.login),s("close"),i({category:o.trackerOpts.category,label:o.usersWho==="comment"?"clickOnWhoCommentUser":"clickOnWhoLikeUser",event:"click",pd:{commentUri:o.commentUri,commentKind:o.trackerOpts.commentKind}})}return(y,w)=>{const R=n.resolveComponent("vu-scroller"),S=n.resolveComponent("vu-modal");return n.openBlock(),n.createBlock(n.Teleport,{to:"body"},[n.createVNode(S,{class:"stc_modal-users-list_main-ctn","no-mobile":!0,show:"","show-cancel-icon":"",title:n.unref(c)(a[y.usersWho]),onClose:w[0]||(w[0]=T=>s("close")),onConfirm:w[1]||(w[1]=T=>s("close"))},{"modal-body":n.withCtx(()=>[n.createVNode(R,{ref:"scrollerCmp",class:"stc_modal-users-list_scroller",infinite:m.value,style:n.normalizeStyle({"font-size":n.unref(r).stcFontSize.value}),onLoading:v},{default:n.withCtx(()=>[n.createElementVNode("div",Fu,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(f.value,T=>(n.openBlock(),n.createBlock(Oo,{key:`who-commented-or-liked-modal-${u.value}-${T.login}`,"disable-rich-user-tooltip":!n.unref(l),user:T,onClickOnUserName:b=>g(T),onClickOnUserPicture:b=>g(T)},null,8,["disable-rich-user-tooltip","user","onClickOnUserName","onClickOnUserPicture"]))),128))])]),_:1},8,["infinite","style"])]),"modal-footer":n.withCtx(()=>w[2]||(w[2]=[n.createElementVNode("span",null,null,-1)])),_:1},8,["title"])])}}}),[["__scopeId","data-v-cb5c8641"]]),Vu={key:0,class:"stc_actions-toolbar_action-ctn"},Wu={key:1},Gu={key:0},Hu={key:1,class:"stc_actions-toolbar_action-ctn"},zu={key:1},Ku={key:0},Yu={key:2,class:"stc_actions-toolbar_action-ctn"},xa=pe(n.defineComponent({__name:"m-actions-toolbar",props:{alignCenter:{type:Boolean,default:!1},commentUri:{default:void 0},depth:{default:0},disableComment:{type:Boolean,default:!1},disableLike:{type:Boolean,default:!1},disableShare:{type:Boolean,default:!1},extraBtns:{default:()=>[]},isLiked:{type:Boolean,default:!1},dataSavingToggleLike:{},trackerOpts:{},mode:{default:"large"},nbComments:{default:0},nbLikes:{default:0},reactType:{default:"comment"},showCommentCounter:{type:Boolean,default:!0},hideLabels:{type:Boolean,default:!1},statsViewed:{default:0}},emits:["clickOnCommentBtn","clickOnExtraBtn","clickOnLikeBtn","clickOnShareBtn"],setup(e,{emit:t}){const o=e,s=t,a=n.inject(We);if(!a)throw new U("Empty SocialToolbarProvide");const{onClickUser:r}=a,{trackPageEvent:i}=qe("m-actions-toolbar"),{$i18n:c}=ae("social-toolbar"),l={comment:()=>c("commentActionLabel"),answer:()=>c("answerActionLabel")},d=n.ref(),u=n.computed(()=>!!(o.showCommentCounter&&o.depth<2)),m=n.computed(()=>!!(o.nbComments&&o.depth<1)),p=n.ref(!1),f=n.ref([]),v=n.computed(()=>l[o.reactType]());Ve(p,async()=>{f.value.length||(f.value=(await Ba({subjectUri:W})).result)});const g=n.computed(()=>!!o.nbLikes),y=n.ref(!1),w=n.ref([]);function R(){g.value&&(y.value=!0,i({category:o.trackerOpts.category,label:"showWhoLikePopover",event:"hover",pd:{commentUri:o.commentUri,commentKind:o.trackerOpts.commentKind}}))}function S(){g.value&&(d.value="like",i({category:o.trackerOpts.category,label:"showWhoLikeModal",event:"click",pd:{commentUri:o.commentUri,commentKind:o.trackerOpts.commentKind}}))}function T(){m.value&&(p.value=!0,i({category:o.trackerOpts.category,label:"showWhoCommentPopover",event:"hover",pd:{commentUri:o.commentUri,commentKind:o.trackerOpts.commentKind}}))}function b(){m.value&&(d.value="comment",i({category:o.trackerOpts.category,label:"showWhoCommentModal",event:"click",pd:{commentUri:o.commentUri,commentKind:o.trackerOpts.commentKind}}))}function _(){s("clickOnLikeBtn"),i({category:o.trackerOpts.category,label:"clickOnLikeBtn",event:"click",pd:{commentUri:o.commentUri,commentKind:o.trackerOpts.commentKind}})}function N(){s("clickOnCommentBtn"),i({category:o.trackerOpts.category,label:o.commentUri?"clickOnReplyBtn":"clickOnCommentBtn",event:"click",pd:{commentUri:o.commentUri,commentKind:o.trackerOpts.commentKind}})}function j(){s("clickOnShareBtn"),i({category:o.trackerOpts.category,label:"clickOnShareBtn",event:"click",pd:{commentUri:o.commentUri,commentKind:o.trackerOpts.commentKind}})}function Y(M){s("clickOnExtraBtn",M),i({category:o.trackerOpts.category,label:"clickOnExtraBtn",event:"click",pd:{commentUri:o.commentUri,commentKind:o.trackerOpts.commentKind}})}return Ve(y,async()=>{w.value.length||(o.commentUri?w.value=(await La({subjectUri:W,commentUri:o.commentUri,trackerCommentKind:o.trackerOpts.commentKind})).result:w.value=(await Da({subjectUri:W})).result)}),(M,Q)=>{const k=n.resolveComponent("vu-icon-link"),x=n.resolveComponent("vu-spinner"),J=n.resolveComponent("vu-popover");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["stc_actions-toolbar_main-ctn",{"stc_align-center":M.alignCenter,"stc_mode-large":M.mode==="large","stc_mode-compact":M.mode==="compact","stc_hide-labels":M.hideLabels}])},[n.createElementVNode("div",{class:n.normalizeClass(["stc_actions-toolbar_actions-ctn",{"stc_depth-root":M.depth===0,"stc_depth-child":M.depth>0}])},[M.disableLike?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",Vu,[n.createVNode(k,{active:M.isLiked,class:n.normalizeClass(["stc_actions-toolbar_action-btn stc_actions-toolbar_like-btn",{"stc_actions-toolbar_is-liked":M.isLiked}]),"data-saving":M.dataSavingToggleLike,icon:"thumbs-up",label:M.hideLabels?"":M.isLiked?n.unref(c)("unlikeActionLabel"):n.unref(c)("likeActionLabel"),onClick:n.withModifiers(_,["stop"])},null,8,["active","class","data-saving","label"]),n.createVNode(J,{show:y.value,"onUpdate:show":Q[0]||(Q[0]=B=>y.value=B),arrow:"",class:"stc_actions-toolbar_action-counter-wrapper",type:"tooltip",onMouseenter:R,onMouseleave:Q[1]||(Q[1]=()=>{g.value&&(y.value=!1)})},{body:n.withCtx(()=>[w.value.length?(n.openBlock(),n.createElementBlock("div",Wu,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(w.value,B=>(n.openBlock(),n.createElementBlock("div",{key:`who-commented-${B.login}`},n.toDisplayString(n.unref(rn)(B)),1))),128)),M.nbLikes>w.value.length?(n.openBlock(),n.createElementBlock("div",Gu,n.toDisplayString(n.unref(c)("andMoreUsersWhoTooltip")),1)):n.createCommentVNode("",!0)])):(n.openBlock(),n.createBlock(x,{key:0}))]),default:n.withCtx(()=>[n.createElementVNode("span",{class:n.normalizeClass(["stc_actions-toolbar_action-counter stc_actions-toolbar_like-counter",{stc_clickable:!!g.value}]),onClick:n.withModifiers(S,["stop"])},n.toDisplayString(M.nbLikes),3)]),_:1},8,["show"])])),M.disableComment?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",Hu,[n.createVNode(k,{class:"stc_actions-toolbar_action-btn stc_actions-toolbar_comment-btn",icon:"comment",label:M.depth?n.unref(c)("replyActionLabel"):M.hideLabels?"":v.value,onClick:n.withModifiers(N,["stop"])},null,8,["label"]),u.value?(n.openBlock(),n.createBlock(J,{key:0,show:p.value,"onUpdate:show":Q[2]||(Q[2]=B=>p.value=B),arrow:"",class:"stc_actions-toolbar_action-counter-wrapper",type:"tooltip",onMouseenter:T,onMouseleave:Q[3]||(Q[3]=()=>{m.value&&(p.value=!1)})},{body:n.withCtx(()=>[f.value.length?(n.openBlock(),n.createElementBlock("div",zu,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(f.value,B=>(n.openBlock(),n.createElementBlock("div",{key:`who-commented-${B.login}`},n.toDisplayString(n.unref(rn)(B)),1))),128)),f.value.length>=8?(n.openBlock(),n.createElementBlock("div",Ku,n.toDisplayString(n.unref(c)("andMoreUsersWhoTooltip")),1)):n.createCommentVNode("",!0)])):(n.openBlock(),n.createBlock(x,{key:0}))]),default:n.withCtx(()=>[o.showCommentCounter?(n.openBlock(),n.createElementBlock("span",{key:0,class:n.normalizeClass(["stc_actions-toolbar_action-counter stc_actions-toolbar_comment-counter",{stc_clickable:m.value}]),onClick:n.withModifiers(b,["stop"])},n.toDisplayString(M.nbComments),3)):n.createCommentVNode("",!0)]),_:1},8,["show"])):n.createCommentVNode("",!0)])),M.disableShare?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",Yu,[n.createVNode(k,{class:"stc_actions-toolbar_action-btn stc_actions-toolbar_share-btn",icon:"forward",label:M.hideLabels?"":n.unref(c)("shareActionLabel"),onClick:n.withModifiers(j,["stop"])},null,8,["label"]),Q[6]||(Q[6]=n.createElementVNode("span",{class:"stc_actions-toolbar_action-counter"},null,-1))])),(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(M.extraBtns,B=>(n.openBlock(),n.createElementBlock("div",{key:`extra-btn_${B.id}`,class:"stc_actions-toolbar_action-ctn stc_actions-toolbar_extra-action-ctn"},[n.createVNode(k,{class:n.normalizeClass(["stc_actions-toolbar_action-btn stc_actions-toolbar_extra-action-btn",B.classes]),icon:B.fonticon,label:M.hideLabels?"":B.label,onClick:n.withModifiers(ye=>Y(B),["stop"])},null,8,["class","icon","label","onClick"]),Q[7]||(Q[7]=n.createElementVNode("span",{class:"stc_actions-toolbar_action-counter"},null,-1))]))),128))],2),n.renderSlot(M.$slots,"prepend",{},void 0,!0),d.value?(n.openBlock(),n.createBlock(ju,{key:0,"comment-uri":M.commentUri,"tracker-opts":M.trackerOpts,"users-who":d.value,onClickOnUser:Q[4]||(Q[4]=B=>n.unref(r)({userLogin:B})),onClose:Q[5]||(Q[5]=B=>d.value=void 0)},null,8,["comment-uri","tracker-opts","users-who"])):n.createCommentVNode("",!0)],2)}}}),[["__scopeId","data-v-8ae8d48d"]]),Oa="SocialToolbarVue",Xu="-";function Ju(e,t={}){const o=t.separator||Xu,a=[t.prefix?Oa+o+t.prefix:Oa];return t.id&&a.push(t.id),a.push(e),a.join(o)}var Ko=(e=>(e.QuerySelector="span.marker",e.ClassName="marker",e.CKEditorSelector="mark",e.CKEditorTagName="MARK",e))(Ko||{}),Yo=(e=>(e.QuerySelector="pre",e.TagName="PRE",e))(Yo||{}),cn=(e=>(e.QuerySelector="a.sum-user-link.sm-link",e.Attribute="data-login",e))(cn||{}),Jn=(e=>(e.QuerySelector="a.sum-user-link.sm-link",e.Attribute="data-users-group-uri",e))(Jn||{}),Fa=(e=>(e.QuerySelector="a.s6m-tag-link.sm-link",e.Attribute="data-predicate",e))(Fa||{}),Xo=(e=>(e.QuerySelector="span.special-character",e.Attribute="data-emoji-unicode",e))(Xo||{}),Qn=(e=>(e.QuerySelector="a.preview-link",e.TagName="A",e.ClassName="preview-link",e))(Qn||{}),ja=(e=>(e.QuerySelector="br",e.TagName="BR",e))(ja||{});const Va="stc_ck-mentions-item";var le=(e=>(e.Group="group",e.Person="person",e))(le||{});const Jo=je.extend({hooks:{beforeRequest:[Ds,Rn(Z.SEARCH)],afterResponse:[(...e)=>An(Z.SEARCH,Jo)(...e),(...e)=>Xt(Jo,je)(...e)]}});function Wa(e){return e.split(":")[1]}function Qu(e){const t={contentType:le.Person,format:"",previewUrl:"",resourceId:"",sourceId:""};return e.forEach(o=>{switch(o.name){case"resourceid":t.resourceId=o.value,t.login=Wa(o.value);break;case"type_icon_url":t.typeIconUrl=o.value;break;case"preview_url":t.previewUrl=Tn(o.value);break;case"ds6w:label":t.fullName=o.value;break;case"ds6w:type":t.contentType=Wa(o.value).toLowerCase();break;case"sourceid":t.sourceId=o.value,t.format=o.format;break}}),t.contentType===le.Group&&delete t.login,t}function Zu(e){return e.results?e.results.map(o=>Qu(o.attributes)):[]}function Ga(e){return e.replace(/\\/g,"\\\\").replace(/([-.*+?^$()[\]{}|])/g,"\\$1")}async function qu(){if(typeof Mn!="boolean")try{na(!!await on(Z.USERS_GROUP))}catch{na(!1)}}async function Ha({query:e,limit:t=20,usersgroup:o=!0,trackerOpts:s}){const a=kt.value.login||"";o&&await qu();const r=["swym"],i={swym:{additional_query:`AND personOrGroup:(${e})`,agoraMode:!0}},c=["ds6w:label","ds6w:type"];o&&Mn&&(r.push("usersgroup"),i.usersgroup={additional_query:`AND ([ds6w:label]:"${Ga(e)}" OR [ds6w:label]:(${Ga(e)}*))`});const l={nresults:t,query:`[ds6w:type]:("pno:Person"${Mn?' OR "foaf:Group"':""})`,source:r,specific_source_parameter:i,select_predicate:c,label:`SocialUserMention-${a}-${Date.now()}`,locale:it,start:0,with_synthesis:!1,with_synthesis_attribute:!1,tenant:V()},d=await Qe(`search-user-info-${e}`,()=>Jo.post("/search",{json:l,tracker:{category:"CommentRequest",label:"searchUser",pd:{crud:"read",commentUri:s.commentUri,commentKind:s.commentKind}}}).json(),6e4);return{total:d.infos.nhits,results:Zu(d)}}const $u=ka({fetch:Ha,merge:e=>{const t=new Set(e.map(s=>s.query)),o=Array.from(t).map(s=>`"${s}"`).join(" OR ");return{...e.pop(),query:o}},resolve([e,[t,o]]){o(e)},options:{throttle:300,limit:10}});async function ed(e){return $u({...e,usersgroup:!1})}const za=new Map;async function td({login:e,trackerOpts:t}){const o=Ya(e);if(o)return o;const s=await rd({login:e,trackerOpts:t});return Ka({login:e,name:s}),s}function Ka({login:e,name:t}){za.set(e,t)}function Ya(e){return za.get(e)}function Xa(e=""){return new DOMParser().parseFromString(e||"","text/html")}function nd(e){const o=Xa().createElement("div");return o.innerHTML=e,o}const $e="@",et="data-login",tt="data-users-group-uri",Oe="data-content-type",Ge="data-type",ln=["sum-user-link","sm-link"],od="Anonymous User";function Zn(e){return e.startsWith($e)||(e=$e+e),e}function qn(e){return e=e.trim(),e.startsWith($e)||(e=$e+e),e}function Ct(e){return e.toLowerCase()}function $n(e){return e=e.trim(),e.startsWith($e)&&(e=e.substring($e.length)),e}function sd(e){const t=Xa(e),o=Array.from(t.querySelectorAll(cn.QuerySelector),a=>({userLogin:a.getAttribute(cn.Attribute)||void 0,displayName:$n(a.textContent||"")})),s=Array.from(t.querySelectorAll(Jn.QuerySelector),a=>({usersGroupId:a.getAttribute(Jn.Attribute)||void 0,displayName:$n(a.textContent||"")}));return o.concat(s).filter(a=>a.userLogin||a.usersGroupId)}function ad(e){e=$n(e);const t=e.indexOf($e);return e.indexOf(" ")===-1&&/^[^a-z]*$/.test(e)?e:e.substring(t+1).split(" ").filter(a=>a).map(a=>a[0]).map(a=>a.toUpperCase()).join("")}async function rd({login:e,trackerOpts:t}){try{const{results:o}=await ed({query:e,trackerOpts:t}),s=o.find(a=>a.login===e);return!s||!s.fullName?(P.info(`User uid:"${e}" not found in search results. Most likely the user does not exist.`),od):s.fullName}catch(o){throw P.error(`Error trying to search user uid:"${e}".`),o}}function id(e){return e.map(t=>({...t,id:Zn(t.resourceId),text:qn(t.fullName||t.resourceId)}))}async function cd({query:e,limit:t,trackerOpts:o}){if(!e)return[];const s=(await Ha({query:e,limit:t,trackerOpts:o})).results;return s.forEach(a=>a.login&&a.fullName&&Ka({login:a.login,name:a.fullName})),id(s)}const ld=e=>{const t=document.createElement("div"),o=document.createElement("img"),s=document.createElement("span");t.appendChild(o),t.appendChild(s);const a=e.contentType===le.Group;return t.classList.add(Va,"smu-mention-user-item"),t.id=`mention-user-${a?e.resourceId:e.login}`,o.src=e.previewUrl,s.textContent=e.fullName||e.login||e.resourceId,t.title=e.fullName||e.login||e.resourceId,t},ud={isUserMentionModel(e){return e.id.startsWith($e)},userMentionCreateElement({model:e,priority:t,writer:o}){const s=e.contentType,a=s===le.Group;return o.createAttributeElement("a",{class:"sum-user-link sm-link",[Ge]:e.format,[Oe]:s,contenteditable:!1,...a?{[tt]:e.resourceId}:{[et]:e.login}},{priority:t,id:a?e.resourceId:e.login})}},dd={isUserMentionElement(e){if(e.name!=="span"&&e.name!=="a")return null;const t=[et];return t.every(s=>e.hasAttribute(s))?{name:!0,attributes:t}:null},isUsersGroupMentionElement(e){if(e.name!=="span"&&e.name!=="a")return null;const t=[tt];return t.every(s=>e.hasAttribute(s))?{name:!0,attributes:t}:null},getUserMentionModel(e){const t=e,o=t.getAttribute(et),s=o;if(!s)throw new U("Missing user id");return{contentType:Ct(t.getAttribute(Oe)||le.Person),format:t.getAttribute(Ge)||"internal",id:Zn(s),login:o,resourceId:s}},getUsersGroupMentionModel(e){const t=e,o=t.getAttribute(tt);if(!o)throw new U("Missing users-group id");return{contentType:Ct(t.getAttribute(Oe)||le.Group),format:t.getAttribute(Ge)||"internal",id:Zn(o),resourceId:o}}},eo={parseUserMention(e,t){e.replaceWith(eo._createMentionUser({text:t,login:e.getAttribute(et),contentType:Ct(e.getAttribute(Oe)||le.Person),type:e.getAttribute(Ge)}))},parseUserGroupMention(e,t){e.replaceWith(eo._createMentionUserGroup({text:t,usersGroupId:e.getAttribute(tt),contentType:Ct(e.getAttribute(Oe)||le.Group),type:e.getAttribute(Ge)}))},_createMentionUser({text:e,login:t,contentType:o,type:s}){const a=document.createElement("span");return a.className="mention",a.setAttribute(et,t),a.setAttribute(Oe,o),a.setAttribute(Ge,s),a.innerHTML=qn(Ya(t)||e),a},_createMentionUserGroup({text:e,usersGroupId:t,contentType:o,type:s}){const a=document.createElement("span");return a.className="mention",a.setAttribute(Oe,o),a.setAttribute(Ge,s),a.setAttribute(tt,t),a.innerHTML=e,a}},to={parseUserMention({element:e,shouldAnonymize:t}){e.replaceWith(to._createUserMentionElement({element:e,shouldAnonymize:t}))},parseUserGroupMention(e){e.replaceWith(to._createUserGroupMentionElement(e))},_createUserMentionElement({element:e,shouldAnonymize:t=!0}){const o=document.createElement("a"),s=e.dataset;o.classList.add(...ln),o.setAttribute(et,s.login||""),o.setAttribute(Oe,Ct(s.contentType||le.Person)),o.setAttribute(Ge,s.type||"");const a=s.fullName||s.originalText||e.innerHTML;return o.innerHTML=qn(t?ad(a):a),o},_createUserGroupMentionElement(e){const t=document.createElement("a");return t.classList.add(...ln),t.setAttribute(tt,e.dataset.usersGroupUri),t.setAttribute(Oe,Ct(e.dataset.contentType||le.Group)),t.setAttribute(Ge,e.dataset.type),t.innerHTML=e.innerHTML,t}},md=/background-color:hsl\(\s*(\d+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%\s*\)/gi;function fd(e){const t=document.createElement("div"),o=e.replaceAll(md,s=>s.split(" ").join(""));return t.innerHTML=o,t}function pd(e,t="mark"){const o=document.createElement("mark");return o.classList.add(...t.split(" ")),o.innerHTML=e,o}function hd(e){const t=document.createElement("pre"),o=document.createElement("code");return t.appendChild(o),o.innerHTML=e,t}function vd(e,t){const o=document.createElement("span");return o.className="special-character",o.setAttribute("data-emoji-unicode",t),o.setAttribute("contenteditable","false"),o.innerHTML=e,o}function yd(e){var t;if(((t=e.parentElement)==null?void 0:t.tagName)==="TD"){const o=document.createElement("p");return o.appendChild(document.createElement("br")),o}return document.createElement("br")}function He(e,t,o={}){const s=document.createElement(e);return s.classList.add(t),Object.keys(o).forEach(a=>{s[a]=o[a]}),s}function gd(e,t,o,s,a){const r=He("div","external-preview-link");if(r.setAttribute("data-prefs",a),r.setAttribute("data-url",e),s){if(!(a==="1"||a==="3")){const d=He("div","external-preview-link-thumbnail"),u=He("img","external-preview-link-image",{src:s});d.append(u);const m=He("span","external-preview-type");m.classList.add("fonticon"),m.classList.add("fonticon-globe"),d.append(m),r.append(d)}}else{const d=He("span","external-preview-link-thumbnail-placeholder");d.classList.add("fonticon"),d.classList.add("fonticon-globe"),r.append(d)}const i=He("div","external-preview-link-content"),c=He("span","external-preview-link-delete");c.classList.add("fonticon"),c.classList.add("fonticon-wrong"),i.append(c);const l=He("h2","external-preview-link-heading",{textContent:t});if(i.append(l),!(a==="2"||a==="3")){const d=He("p","external-preview-link-description",{textContent:o});i.append(d)}return r.append(i),r}async function wd(e){const t=await Rd(e),o=He("iframe","youtube-preview-link",{height:t.height,width:t.width,src:t.src,title:t.title});return o.setAttribute("data-url",e),o}function bd(e,t){e.classList.remove("marker"),e.replaceWith(pd(t,e.className||void 0))}function _d(e,t){e.replaceWith(hd(t))}function kd(e,t){const o=e.getAttribute("data-emoji-unicode");e.replaceWith(vd(t,o))}function Cd(e){e.replaceWith(yd(e))}async function Ed(e){const t=e.getAttribute("href"),o=e.getAttribute("data-title"),s=e.getAttribute("data-desc"),a=e.getAttribute("data-img")==="null"?null:e.getAttribute("data-img"),r=e.getAttribute("data-prefs");let i=e.getAttribute("data-type")||"";i&&i.startsWith("media:")&&(i=i.split(":")[0]);let c;return Ad(t)?c=await wd(t):Ja(t)?c=gd(t,o,s,a,r):c=e,e.replaceWith(c)}async function Sd(e){e.className.includes(Ko.ClassName)&&bd(e,e.innerHTML),e.tagName===Yo.TagName&&_d(e,e.innerHTML),e.tagName===ja.TagName&&Cd(e),e.hasAttribute(cn.Attribute)&&eo.parseUserMention(e,e.innerHTML),e.hasAttribute(Jn.Attribute)&&eo.parseUserGroupMention(e,e.innerHTML),e.hasAttribute(Xo.Attribute)&&kd(e,e.innerHTML),e.tagName===Qn.TagName&&e.className.includes(Qn.ClassName)&&await Ed(e)}function Ja(e){try{const t=new URL(e);return!/3dexperience\.3ds\.com|3dx-staging.3ds.com$/.test(t.hostname)}catch{return!1}}function Ad(e){const t=["www.youtube.com","youtube.com","youtu.be"];if(!e)return!1;try{const o=new URL(e);return Ja(e)&&t.includes(o.hostname)}catch{return!1}}async function Rd(e){try{const t=await On.get("/uwp/api/proxy/ajax",{searchParams:{type:"json",method:"GET",url:`https://www.youtube.com/oembed?url=${e}&format=json`}});if(t.status===200){const o=await t.json(),s=document.createElement("div");s.innerHTML=o.html;const a=s.firstElementChild;return{...o,src:a==null?void 0:a.getAttribute("src"),height:280,width:500}}else return{}}catch{return{}}}async function Ud(e){const t=fd(e),o=`
    ${Ko.QuerySelector},
    ${Yo.QuerySelector},
    ${cn.QuerySelector},
    ${Fa.QuerySelector},
    ${Xo.QuerySelector},
    ${Qn.QuerySelector}
  `,a=[...t.querySelectorAll(o)].map(async r=>Sd(r));return await Promise.all(a),{message:t}}async function Md(e){const{message:t}=await Ud(e);return{htmlModel:t.innerHTML}}function Qo(e){return Ze(async()=>await Md(n.unref(e)))}const Td=se(L.UserMentionAnonymization);function no(e,t){for(;e.childNodes.length>0;)t.appendChild(e.childNodes[0])}function Pd(e){var o;let t;return e.tagName==="IMG"?t=e.getAttribute("data-media-id"):t=(o=e.querySelector("img"))==null?void 0:o.getAttribute("data-media-id"),t&&t!=="undefined"?t:""}function Id(e){return e.classList.contains("image_resized")?"small":"large"}function Nd(e){return e.classList.contains("image-style-align-center")?"center":e.classList.contains("image-style-align-left")?"left":e.classList.contains("image-style-align-right")?"right":e.tagName==="IMG"?"inline":"center"}function Bd(e,t){const o=document.createElement("div");o.className="responsive-table";const s=e.getElementsByTagName("table")[0];t.width?s.style.width=t.width:s.style.width||(s.style.width="100%");const a=e.querySelector(":scope > figcaption");if(a){const r=document.createElement("caption");r.innerHTML=a.innerHTML,a.remove(),s.prepend(r)}return s.setAttribute("align",e.style.float||"center"),no(e,o),o}function Dd(e,t,o,s){var l;const a=document.createElement("figure"),r=document.createElement("a"),i=document.createElement("img");i.setAttribute("src",""),t&&i.setAttribute("data-media-id",t),!t&&e.getAttribute("src")&&i.setAttribute("src",e.getAttribute("src"));const c=(l=e.querySelector(":scope > a"))==null?void 0:l.getAttribute("href");if(c&&r.setAttribute("href",c),(e.getAttribute("data-content-thumbnail")||e.querySelector("img[data-content-thumbnail]"))&&i.setAttribute("data-content-thumbnail","true"),e.querySelector("figcaption"))return a.setAttribute("data-position",s),a.setAttribute("data-size",o),c?(r.appendChild(i),a.appendChild(r)):a.appendChild(i),a.appendChild(e.querySelector("figcaption")),a;{i.setAttribute("data-position",s),i.setAttribute("data-size",o);let d=i;return c&&(r.append(i),d=r),d}}function Ld(e){const t=document.createElement("span");return t.className=`marker ${e.className}`,no(e,t),t}function xd(e){const t=document.createElement("pre"),o=e.querySelector("code");return no(o||e,t),t}function Od(e){const t=e.style;e.replaceWith(Bd(e,t))}function Qa(e){const t=Id(e),o=Nd(e),s=Pd(e);return e.replaceWith(Dd(e,s.split(":").pop(),t,o))}function Fd(e){e.replaceWith(Ld(e))}function jd(e){e.replaceWith(xd(e))}function Vd(e){const t=e.getAttribute("data-url"),o=e.getAttribute("data-prefs"),s=e.querySelector(".external-preview-link-heading"),a=s&&s.textContent||"",r=e.querySelector(".external-preview-link-description"),i=r&&r.textContent||"",c=e.querySelector(".external-preview-link-image"),l=c&&c.src||"",d=e.querySelector(".external-preview-link-content");d&&d.remove();const u=document.createElement("a");return u.classList.add("preview-link"),u.href=t,u.setAttribute("data-title",a),u.setAttribute("data-desc",i),u.setAttribute("data-img",l),u.setAttribute("data-prefs",o||""),u.innerHTML="&nbsp;",e.replaceWith(u)}function Wd(e){const t=e.getAttribute("data-url"),o=e.getAttribute("data-prefs"),s=e.querySelector(".internal-preview-type"),a=s&&s.getAttribute("data-type")||"",r=s&&s.getAttribute("data-subtype")||"",i=e.querySelector(".internal-preview-link-content");i&&i.remove();const c=document.createElement("a");return c.classList.add("preview-link"),c.href=t,c.setAttribute("data-title","&nbsp;"),c.setAttribute("data-desc","&nbsp;"),c.setAttribute("data-img","&nbsp;"),c.setAttribute("data-prefs",o||""),c.setAttribute("data-type",r?`${a}:${r}`:a),c.innerHTML="&nbsp;",e.replaceWith(c)}function Gd(e){const t=e.getAttribute("data-url")||"#",o=document.createElement("a");return o.classList.add("preview-link"),o.href=t,o.innerHTML="&nbsp;",e.replaceWith(o)}function Hd(e){e.tagName==="FIGURE"&&e.className==="table"&&Od(e),e.tagName==="FIGURE"&&e.className!=="table"&&Qa(e),e.tagName==="IMG"&&Qa(e),e.tagName==="MARK"&&Fd(e),e.tagName==="PRE"&&jd(e),(e.tagName==="SPAN"||e.tagName==="A")&&e.hasAttribute("data-login")&&to.parseUserMention({element:e,shouldAnonymize:Td.value}),e.tagName==="SPAN"&&e.hasAttribute("data-users-group-uri")&&to.parseUserGroupMention(e),e.tagName==="DIV"&&e.className.includes("external-preview-link")&&Vd(e),e.tagName==="DIV"&&e.className.includes("internal-preview-link")&&Wd(e),e.tagName==="IFRAME"&&e.className.includes("youtube-preview-link")&&Gd(e)}function zd(e){const t=nd(e);return t.querySelectorAll(`
    pre,
    figure,
    img,
    mark,
    div.external-preview-link,
    div.internal-preview-link,
    iframe.youtube-preview-link,
    div.widget-preview-container,
    span[data-login],
    span[data-users-group-uri],
    span.s6m-tag-link.sm-link[data-predicate],
    a[data-type]
  `).forEach(Hd),t}function Kd(e){return zd(e).innerHTML}function Za(e){return{reversedHtml:n.computed(()=>Kd(e.value))}}const Yd="application/ckeditor5-dragging-uid";function Xd(e){var t;return!!((t=e.dataTransfer)!=null&&t.types.includes(Yd))}function qa({target:e,onDrop:t,disabled:o}){const s=n.ref(!1);let a=0;function r(){a=0,s.value=!1}function i(c){return fi(o)||Xd(c)}return de(e,"dragenter",c=>{if(i(c)){r();return}c.preventDefault(),a+=1,s.value=!0}),de(e,"dragover",c=>{if(i(c)){r();return}c.preventDefault()}),de(e,"dragleave",c=>{if(i(c)){r();return}c.preventDefault(),a-=1,a===0&&r()}),de(e,"drop",c=>{var l;if(i(c)){r();return}c.preventDefault(),t==null||t({event:c,files:Array.from(((l=c.dataTransfer)==null?void 0:l.files)||[])}),r()}),{isOverDropZone:s,resetDropZoneOver:r}}const Jd={class:"stc_drop-zone_icon-ctn"},Qd={class:"stc_drop-zone_text"},Zd=pe(n.defineComponent({__name:"a-drop-zone",props:{noBorder:{type:Boolean,default:!1}},setup(e){const{$i18n:t}=ae("social-toolbar"),o=n.useTemplateRef("dropzoneEl"),{isOverDropZone:s}=qa({target:o});return(a,r)=>{const i=n.resolveComponent("vu-icon");return n.openBlock(),n.createElementBlock("div",{ref:"dropzoneEl",class:n.normalizeClass(["stc_drop-zone_main-ctn",{"stc_is-over-drop-zone":n.unref(s),"stc_border-drop-zone":!a.noBorder}])},[n.createElementVNode("div",Jd,[n.createVNode(i,{class:"stc_drop-zone_icon",icon:"drag-drop"}),n.createElementVNode("span",Qd,n.toDisplayString(n.unref(t)("dropFilesHere")),1)])],2)}}}),[["__scopeId","data-v-46b17cdf"]]),$a="stc-notif-bus";var er=(e=>(e.MediaProcessing="media_processing",e))(er||{}),Zo=(e=>(e.Processed="PROCESSED",e.ProcessedError="PROCESSING_ERROR",e))(Zo||{});function qd({mediaUri:e}){const t=Ys($a);function o(s){return t.on((a,r)=>{a===er.MediaProcessing&&r&&r.uri===n.unref(e)&&s(r.action)})}return{listenMediaProcessing:o}}var G=(e=>(e.AnimatedPicture="animatedPicture",e.Annotation="annotation",e.Document="document",e.Drawing="drawing",e.HomeByMe="homebyme",e.Model3D="3d_model",e.Misc="misc",e.Picture="picture",e.Simulation="simulationMedia",e.Sketch="sketch",e.Sound="sound",e.Story="story",e.Video="video",e.Whiteboard="whiteboard",e.Unknown="unknown",e))(G||{}),ze=(e=>(e.Comment="3dcomment",e.SocialMedia="social-media",e))(ze||{}),qo=(e=>(e.Large="l_thumb",e.Medium="m_thumb",e.Small="s_thumb",e))(qo||{}),oo=(e=>(e.NON_PROCESSED="non-processed",e.READY_TO_PROCESS="ready-to-process",e.PROCESSED="processed",e.ERROR="error",e))(oo||{});async function $d(e){var o;let t=Number.NaN;try{const s=await e.clone().json(),a=s==null?void 0:s.nb_result;t=typeof a=="number"?a:Number.parseInt(a||""),!t&&Array.isArray(s.result)&&(t=s.result.length);const r=s;!t&&((o=r.infos)!=null&&o.nhits)&&Array.isArray(r.results)&&(t=r.infos.nresults)}catch(s){P.error(s)}return t}const em=async(e,t,o)=>{if(!o.status||o.status<400)return;const s=t.tracker,a=await $d(o);qe("").trackPageEvent({category:(s==null?void 0:s.category)||"HTTPRequest",event:"httprequest",label:(s==null?void 0:s.label)||"httprequest",pd:{...(s==null?void 0:s.pd)||{},api:e.url,method:e.method,responseStatusCode:o.status,responseError:o.status>=400?o.statusText:void 0,xRequestId:e.headers.get("X-Request-ID")},pv:{time:t.timeout||0,responseStatusCode:o.status,...Number.isNaN(a)?{}:{nbElements:a}}})};function tr({url:e,method:t,timeout:o,tracker:s,response:a,error:r}){r=typeof r=="string"||!r?new U(r||"unknown error"):r;const i={url:e,method:t,headers:new Map},c={status:Number.NaN,statusText:""};try{r.message&&(c.statusText=r.message),!a&&r.message.includes("timeout")&&(c.status=408),r.message.includes("ResponseCode")&&r.message.split('"').reverse().find(l=>{const d=Number.parseInt(l,10);if(d>=300)return c.status=d,d}),em(i,{tracker:s,timeout:o},c)}catch(l){P.error(l)}}async function tm({subjectUri:e,annotationUri:t}){const o=`/commentproxy/subjects/${e}/media/${t}/type/original`;return ne.get(o,{searchParams:{tenant:V()},tracker:{category:"MediaRequest",label:"getAnnotationFile",pd:{crud:"read",mediaType:G.Annotation,mediaUri:t}}}).blob()}async function nm({annotation:e,onProgress:t,subjectUri:o}){const s=new FormData,{screenshot:a}=e,r=a.type;if(r==="image/png")s.append("altFile",a,"annotation_thumbnail.png");else if(r==="image/jpeg")s.append("altFile",a,"annotation_thumbnail.jpg");else throw new U("Annotation thumbnail can only be a png or jpg");s.append("userFile",e.annotation,"annotation.3dplayannotation");let i;await Promise.all([(async()=>{i=await ue("DS/WAFData/WAFData")})(),uu()]);const c=await new Promise((l,d)=>{const m=`${tn}/commentproxy/subjects/${o}/media?tenant=${V()}`;i.authenticatedRequest(m,{responseType:"json",headers:{...lu(),...ta()},type:"json",method:"POST",data:s,timeout:9e4,onUploadProgress:p=>{if(typeof t!="function")return;const f=Math.round(p.loaded*100/p.total);t(f)},onComplete:l,onFailure:async(p,f)=>{P.error(p,f),tr({url:m,method:"POST",timeout:9e4,tracker:{category:"MediaRequest",label:"uploadAnnotation",pd:{crud:"create",mediaType:G.Annotation}},response:f,error:p});const v=new U(typeof p=="string"?p:"Unknown error");d(v)}})});return{...c,result:c.result.mediaUri}}function nr({subjectUri:e,annotationUri:t,relativeUrl:o=!1}){return`${o?"":tn}/commentproxy/subjects/${e}/media/${t}/type/thumb/key/original?tenant=${V()}`}async function om({subjectUri:e,annotationUri:t}){return ne.get(nr({subjectUri:e,annotationUri:t,relativeUrl:!0}),{searchParams:{tenant:V()},tracker:{category:"MediaRequest",label:"getAnnotationThumbnailFile",pd:{crud:"read",mediaType:G.Annotation,mediaUri:t}}}).blob()}async function or({annotationUri:e,subjectUri:t}){return ne.delete(`/commentproxy/subjects/${t}/media/${e}`,{searchParams:{tenant:V()},tracker:{category:"MediaRequest",label:"removeAnnotation",pd:{crud:"delete",mediaType:G.Annotation,mediaUri:e}}}).then()}function Et(e){return e?(e||[]).map(t=>({alias:t.alias,format:t.format,transientUrl:t.transient_url})):void 0}function sr(e){const{subject6wuri:t,title:o,play:s,media_type:a,preview:r,status:i,author:c,size:l,orig_name:d,width:u,height:m,ratio:p}=e;return{mediaUri:t,type:a,source:ze.SocialMedia,title:o,originalName:d,processing:i,downloadOriginalUrl:s.download_original_url.transient_url_as_attachment,extension:s.download_original_url.format,view:Et(s.view),subtitles:Et(s.subtitles),chapters:Et(s.chapters),avStreams:Et(s.av_streams),threeDStreams:Et(s["3d_streams"]),docStreams:Et(s.doc_streams),preview:Et(r.thumbnails),author:Wo({firstName:c.first_name,lastName:c.last_name,login:c.login,status:_t.Employee}),size:l,width:u,height:m,ratio:p}}function sm(e){const{subject6wuri:t,ticketsInfo:o}=e;return{mediaUri:t,ticket:o[0].exportString,uploadUrl:o[0].actionURL}}async function am({subjectUri:e,trackerMediaType:t}){return ne.post(`/commentproxy/subjects/${e}/richmedia`,{json:{},tracker:{category:"MediaRequest",label:"createEmptyMedia",pd:{crud:"create",mediaType:t}}}).json().then(o=>({...o,result:sm(o.result)}))}async function rm({url:e,ticket:t,media:o,onProgress:s,abortSignal:a,trackerMediaType:r}){const c=new FormData;c.append("__fcs__jobTicket",t),c.append("file_0",o,o.name),c.append("__fcs__doneWithFile","true");const l=await ue("DS/WAFData/WAFData");return new Promise((d,u)=>{const p=l.request(e,{responseType:"text",type:"text",method:"POST",data:c,timeout:432e5,onUploadProgress:v=>{const g=Math.round(v.loaded*100/v.total);s==null||s(g)},onComplete:v=>{f(),d(v)},onFailure(v,g){const y=typeof v=="string"||!v?new U(v||"unknown error"):v;y.response=g,tr({url:e,method:"POST",timeout:432e5,tracker:{category:"MediaRequest",label:"uploadMedia",pd:{crud:"create",mediaType:r}},response:g,error:y}),f(),u(y)},onCancel(){f(),u(a==null?void 0:a.reason)}});function f(){a==null||a.removeEventListener("abort",p.cancel)}a==null||a.addEventListener("abort",p.cancel)})}async function im({subjectUri:e,mediaUri:t,receipt:o,trackerMediaType:s}){return ne.put(`/commentproxy/subjects/${e}/richmedia/${t}`,{json:{receipts:[o]},tracker:{category:"MediaRequest",label:"createMediaThroughService",pd:{crud:"update",mediaType:s,mediaUri:t}}}).json()}async function cm({subjectUri:e,media:t,onProgress:o,abortSignal:s,trackerMediaType:a}){let r=!1;function i(){r=!0}function c(){s==null||s.removeEventListener("abort",i)}s==null||s.addEventListener("abort",i);const{mediaUri:l,ticket:d,uploadUrl:u}=(await am({subjectUri:e,trackerMediaType:a})).result;if(r){c();return}const m=await rm({url:u,ticket:d,media:t,onProgress:o,abortSignal:s,trackerMediaType:a});if(r){c();return}return im({subjectUri:e,mediaUri:l,receipt:m,trackerMediaType:a}).then(p=>({...p,result:sr(p.result)}))}async function lm({subjectUri:e,mediaUri:t}){return ne.get(`/commentproxy/subjects/${e}/richmedia/${t}/info`,{tracker:{category:"MediaRequest",label:"fetchMedia",pd:{crud:"read",mediaUri:t}}}).json().then(o=>({...o,result:sr(o.result)}))}async function um({subjectUri:e,mediaUri:t,hardDelete:o=!1,trackerMediaType:s}){return ne.delete(`/commentproxy/subjects/${e}/richmedia/${t}`,{searchParams:{hard_delete:o},tracker:{category:"MediaRequest",label:"removeMedia",pd:{crud:"delete",mediaType:s,mediaUri:t}}}).then()}async function dm({subjectUri:e,mediaUri:t,trackerMediaType:o}){return ne.post(`/commentproxy/subjects/${e}/richmedia/${t}/restartprocessing`,{json:{},tracker:{category:"MediaRequest",label:"restartMediaProcessing",pd:{crud:"create",mediaType:o,mediaUri:t}}}).then()}function mm({subjectUri:e,mediaUri:t,thumbSize:o,cacheBust:s}){let a="";return s&&(a=typeof s=="string"?`?v=${s}`:`?v=${Date.now()}`),`${tn}/commentproxy/subjects/${e}/richmedia/${t}/stream/alias/${o}${a}`}function fm(){return{mediaUri:"",type:G.Picture,source:ze.SocialMedia,title:"",processing:oo.READY_TO_PROCESS,downloadOriginalUrl:"",author:{}}}const $o=new Map;function jt(e){return!!e.annotationUri}function so(e){return!!e.annotation}function Ke(e){return!!e.file}function ao(e){const t=e;return!!(t.mediaUri&&!t.author)}function es(e){const t=e;return!!(t.mediaUri&&t.author)}function pm(e){if(!Number.isNaN(e)){let t=e,o=0;const s=[];for(s[0]="b",s[1]="Kb",s[2]="Mb",s[3]="Gb",s[4]="Tb",s[5]="Pb",s[6]="Eb",s[7]="Zb",s[7]="Yb";t>1;)e=t,t/=1024,o++;return e!==t&&(o-=1),`${Math.round(e)} ${s[o]}`}return""}function hm({width:e,height:t,ratio:o}){return`${e}x${t} (${o})`}function ts(e){const t={[G.Picture]:["jpeg","bmp","webp","jpg","svg","png","tiff","tif","gif"],[G.Document]:["mpp","vsd","dotx","pptx","rtf","xps","iterop","doc","odt","ods","odp","potx","pdf","xls","txt","ott","otp","ppt","pps","xlsx","docx","vsdx","xlsm","ppsx","zip","csv","mdzip","xltx"],[G.Model3D]:["zae","glb","vrml","kmz","stlb","stla","igs","blend","reality","smg","step","iges","dae","u3d","dsxm","3ds","ply","sdm","wrml","obj","usdz","sldasm","str","off","wrl","vrl","stp","stl","stpz","prj","sldprt","3dxml"],[G.Drawing]:["dwg","slddrw"],[G.Video]:["mp4","mkv","webm","mpeg","wmv","avi","mov","flv","m4v","mpg","rm"],[G.Sound]:["ra","aac","m4a","ogg","wma","wav","mp3"],[G.Simulation]:["3dsim"],[G.Story]:["3dsto"],[G.Sketch]:["3dskt"],[G.Whiteboard]:["3dwb"],[G.HomeByMe]:["3dhbmprj"]};let o;e instanceof File?o=e:o=e.file;const s=o.name.split(".").at(-1);if(s){let a=G.Unknown;for(const[r,i]of Object.entries(t))i.includes(s)&&(a=r);return a}else return G.Unknown}const un="data-source",St="data-media-type",ro="data-uri",ns="data-related-media-uri",vm="3DXContent";function ym(e){let t;try{const o=JSON.parse((e==null?void 0:e.getData("text"))||"{}");(o==null?void 0:o.protocol)===vm&&(t=o)}catch{}return t}const gm={key:0,class:"stc_media-item_remove-btn-ctn stc_media-item_btn-ctn"},wm={key:1,class:"stc_media-item_retry-btn-ctn stc_media-item_btn-ctn"},bm=["src"],_m={key:3,class:"stc_media-item_title"},km={key:4,class:"stc_media-item_upload-progress-ctn"},Cm=n.defineComponent({__name:"m-media-item",props:{item:{},thumbSize:{default:qo.Medium},clickable:{type:Boolean,default:!1},removable:{type:Boolean,default:!1},showBorder:{type:Boolean,default:!1}},emits:["click","remove","retry"],setup(e,{emit:t}){const o=e,s=t;let a;const{trackPageEvent:r}=qe("m-media-item"),i=n.computed(()=>{const k=o.item;return ao(k)||es(k)?k.mediaUri:void 0}),c=qd({mediaUri:i}),l=n.ref(""),d=n.ref(""),u=n.ref({}),m=n.computed(()=>ao(o.item)?o.item:void 0),p=n.computed(()=>es(o.item)?o.item:void 0),f=n.computed(()=>Ke(o.item)?o.item:void 0),v=n.computed(()=>jt(o.item)?o.item:void 0),g=n.computed(()=>so(o.item)?o.item:void 0),y=n.computed(()=>{const k=o.item;return Ke(k)?!!k.uploading:!1}),w=n.computed(()=>{const k=o.item;return Ke(k)?!!k.uploadError:!1}),R=n.computed(()=>{const k=o.item;return Ke(k)?!!k.uploaded:!1}),S=n.computed(()=>{const k=o.item;return Ke(k)?k.uploadProgress??0:0});async function T({type:k,size:x}){a||(a=await ue("DS/WebappsUtils/WebappsUtils"));const B=`media-default-thumb/${x===qo.Large?"xl":"l"}_thumb_default_${k}.png`;return a.getWebappsAssetUrl("SocialToolbarVue",B)}function b({item:k,cacheBust:x}){return Tn(mm({subjectUri:W,mediaUri:k.mediaUri,thumbSize:o.thumbSize,cacheBust:x}))}async function _(k){const x=k.type;let J="",B="";if(x.startsWith("image"))J=window.URL.createObjectURL(k);else{let ye=G.Document;x.startsWith("audio")?ye=G.Sound:x.startsWith("video")?ye=G.Video:x||k.name.toLowerCase().endsWith(".slddrw")&&(ye=G.Drawing),J=await T({type:ye,size:o.thumbSize}),B=k.name}return{url:J,title:B}}async function N(){const k=o.item;if(d.value="",u.value={},so(k))l.value=window.URL.createObjectURL(k.annotation.screenshot);else if(jt(k))l.value=Tn(nr({subjectUri:W,annotationUri:k.annotationUri})),u.value={[St]:G.Annotation,[un]:ze.Comment,[ns]:k.relatedMediaUri};else if(Ke(k)){const{url:x,title:J}=await _(k.file);l.value=x,d.value=J}else if(ao(k)){const x=$o.get(k.mediaUri);if(x){const{url:J}=await _(x.file);l.value=J}else l.value=b({item:k});u.value={[St]:k.type,[un]:ze.SocialMedia}}else P.error("Unexpected item type:",k)}function j(){var J;let k,x;if(m.value||p.value){const B=m.value||p.value;k=B.type,x=B.mediaUri}else if(v.value||g.value)k=G.Annotation,x=(J=v.value)==null?void 0:J.annotationUri;else if(f.value){const B=f.value.mediaItemFull;k=(B==null?void 0:B.type)||ts(f.value),x=B==null?void 0:B.mediaUri}else throw new U("Media not valid");return{mediaType:k,mediaUri:x}}function Y(){s("remove"),r({category:"Media",label:"clickOnRemoveBtn",event:"click",pd:j()})}function M(){s("retry"),r({category:"Media",label:"clickOnRetryBtn",event:"click",pd:j()})}function Q(){s("click"),r({category:"Media",label:"clickOnThumbnail",event:"click",pd:j()})}return n.watch(()=>o.item,N,{immediate:!0}),n.watch(()=>{if(Ke(o.item))return o.item.mediaItemFull},N,{immediate:!0}),Ro(()=>{window.URL.revokeObjectURL(l.value)}),Ro(c.listenMediaProcessing(k=>{const x=o.item;!ao(x)&&!es(x)||(k===Zo.Processed||k===Zo.ProcessedError)&&(l.value=b({item:x,cacheBust:!0}))})),(k,x)=>{const J=n.resolveComponent("vu-icon-btn"),B=n.resolveDirective("mask");return n.withDirectives((n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["stc_media-item_main-ctn",{"stc_show-border":k.showBorder,stc_uploading:y.value,"stc_upload-error":w.value,stc_uploaded:R.value}])},[k.removable?(n.openBlock(),n.createElementBlock("div",gm,[n.createVNode(J,{class:"stc_media-item_remove-btn stc_media-item_btn",icon:"close",onClick:Y})])):n.createCommentVNode("",!0),w.value?(n.openBlock(),n.createElementBlock("div",wm,[n.createVNode(J,{class:"stc_media-item_retry-btn stc_media-item_btn",icon:"reload",onClick:M})])):n.createCommentVNode("",!0),l.value?(n.openBlock(),n.createElementBlock("img",n.mergeProps({key:2,class:["stc_media-item_img",{stc_clickable:k.clickable}],src:l.value},u.value,{onClick:x[0]||(x[0]=ye=>k.clickable&&Q())}),null,16,bm)):n.createCommentVNode("",!0),d.value?(n.openBlock(),n.createElementBlock("div",_m,n.toDisplayString(d.value),1)):n.createCommentVNode("",!0),y.value?(n.openBlock(),n.createElementBlock("div",km,[n.createElementVNode("div",{class:"stc_media-item_upload-progress",style:n.normalizeStyle(`width: ${S.value}%`)},null,4)])):n.createCommentVNode("",!0)],2)),[[B,!l.value]])}}}),ar=pe(Cm,[["__scopeId","data-v-6fe40f7f"]]),Ce="stc_msg-namespace";function dn({subjectUri:e}){const{trackPageEvent:t}=qe("media-actions"),{$i18n:o,promise:s}=ae("social-toolbar");function a(c){window.open(c.downloadOriginalUrl,"_self")}async function r({media:c,silent:l}){await s;try{const d=c.mediaUri,u=c.type;return await um({mediaUri:d,subjectUri:e,hardDelete:!0,trackerMediaType:u}),l||(ke.message.create({color:"success",text:o("deleteMediaSuccessMsg"),timeout:To,target:Ce}),t({category:"Media",label:"remove",event:"click",pd:{mediaType:u,mediaUri:d}})),!0}catch(d){return P.error(d),l||ke.message.create({color:"error",text:o("deleteMediaFailureMsg"),timeout:To,target:Ce}),!1}}async function i({media:c}){await s;try{await dm({subjectUri:e,mediaUri:c.mediaUri,trackerMediaType:c.type}),ke.message.create({color:"success",text:o("restartMediaProcessSuccessMsg"),timeout:ct,target:Ce})}catch(l){P.error(l),ke.message.create({color:"error",text:o("restartMediaProcessFailureMsg"),timeout:To,target:Ce})}}return{download:a,remove:r,restartProcessing:i}}const rr=`img[${St}]`;function os(e){const t=document.createElement("div"),o=[];return t.innerHTML=e,t.querySelectorAll(rr).forEach(s=>{if(s.getAttribute(St)===G.Annotation){const a=s.getAttribute(ro);a&&o.push({annotationUri:a,relatedMediaUri:s.getAttribute(ns)||void 0})}}),o}function ss(e){const t=document.createElement("div"),o=[];return t.innerHTML=e,t.querySelectorAll(rr).forEach(s=>{if(s.getAttribute(un)===ze.SocialMedia){const a=s.getAttribute(ro);a&&o.push({mediaUri:a,type:s.getAttribute(St)||"",source:ze.SocialMedia})}}),o}async function as(e){return new Promise(t=>{setTimeout(t,e)})}async function At({fn:e,maxTry:t=100,pollInterval:o=50}){let s=0;if(Number.isNaN(t)||t<=0)throw new U("[tryUntilSuccess] maxTry must be a positive number");const a=async()=>{try{return await e({tryIndex:s,abort:()=>{throw s=t,new U("[tryUntilSuccess] abort by fn")}})}catch(r){if(s++,s>=t)throw r;return await as(o),a()}};return a()}const Em={class:"stc_comment-input_right-ctn",tabindex:"-1"},Sm={key:0,class:"stc_comment-input_medias-ctn"},ir="stc_comment-input_main-ctn",rs=pe(n.defineComponent({__name:"m-comment-input",props:{disabled:{type:Boolean,default:!1},focusAtStart:{type:Boolean,default:!1},placeholder:{default:void 0},storageKey:{default:void 0},trackerOpts:{},value:{default:void 0}},emits:["pressEscapeKey","submit","toggleToolbar","input","focus","blur"],setup(e,{expose:t,emit:o}){const s=e,a=o,r=n.inject(We);if(!r)throw new U("Empty SocialToolbarProvide");const{stcMainElRef:i}=r,{trackPageEvent:c}=qe("m-comment-input"),{$i18n:l}=ae("social-toolbar"),d=se(Ot.MobileDevice),u=se(L.AddMedia),m=se(L.UserMention),p=s.storageKey?Ju(s.storageKey,{id:W}):void 0;function f(h){const E=os(h),I=ss(h);return{annotations:E,medias:I}}let v=(()=>{if(s.value)return Qo(n.toRef(s,"value"));if(p){const h=localStorage.getItem(p);if(h)return Qo(n.ref(h))}})();const g=n.useTemplateRef("commentInputMainCtnEl"),y=n.useTemplateRef("ckeditorWrapperInlineCmp"),w=n.ref(!1),R=n.ref(!1),S=n.ref(!1),T=n.computed(()=>!(d.value||S.value)),b=n.ref(""),_=n.computed({get:()=>b.value,set:h=>{b.value=h}}),N=n.reactive(new Map),j=n.ref([]),Y=n.ref([]);function M(h){for(let E=0;E<h.length;E++){const I=h[E],X=crypto.randomUUID(),q={file:I,id:X};N.set(X,q)}}function Q(){const h=document.createElement("input");h.type="file",h.multiple=!0,h.onchange=E=>{const I=E.target;if(!I||!I.files)throw new U("Fail to read the input file");M(I.files)},h.click()}async function k(){const h=dn({subjectUri:W});return Promise.allSettled(Y.value.map(E=>h.remove({media:E,silent:!0})))}function x(h){Y.value.push(h),j.value=j.value.filter(E=>E!==h)}async function J({mediaFile:h,silentError:E=!1,reason:I}){const X=h.mediaItemFull;if(X){if(h.uploading=!0,h.uploadProgress=50,!await dn({subjectUri:W}).remove({media:X,silent:!0})){const vt="Fail to remove media";if(P.error(vt),h.uploading=!1,h.uploadProgress=0,!E)throw new U(vt)}h.uploading=!1,h.uploadProgress=100,$o.delete(X.mediaUri)}else h.uploadAbortController&&h.uploadAbortController.abort(I);N.delete(h.id)}function B({silentError:h=!0}={}){for(const E of N.values())J({mediaFile:E,silentError:h})}function ye({mediaUri:h,mediaType:E,source:I}){return`<img ${ro}="${h}" ${St}="${E}" ${un}="${I}" />`}async function Ie(h){if(h.uploading)return h.uploadPromise;const E=h.file;h.uploading=!0,h.uploaded=!1,h.uploadError=!1,h.uploadProgress=0;let I=new AbortController;return h.uploadAbortController=I,h.uploadPromise=cm({subjectUri:W,media:E,onProgress(X){h.uploadProgress=X},abortSignal:I.signal,trackerMediaType:ts(E)}).then(X=>{if(!X)return;const{result:q}=X;h.uploading=!1,h.uploaded=!0,h.mediaItemFull=q,h.uploadAbortController=I=void 0,$o.set(q.mediaUri,h),c({category:"Media",label:"add",event:"click",pd:{mediaType:q.type,mediaUri:q.mediaUri}})}).catch(X=>{var q,te;if(P.error(X),h.uploading=!1,h.uploaded=!1,h.uploadError=!0,h.uploadAbortController=I=void 0,X!==0)throw ke.message.create({text:l("uploadMediaFailureMsg"),color:"error",timeout:ct,target:Ce}),c({category:"Media",label:"uploadFailure",event:"click",pd:{mediaType:((q=h.mediaItemFull)==null?void 0:q.type)||ts(h),mediaUri:(te=h.mediaItemFull)==null?void 0:te.mediaUri}}),new U("Fail to upload media")})}function Mt(){return Array.from(N.values()).map(async h=>{let E=h.mediaItemFull;if(h.uploadError)throw ke.message.create({text:l("uploadMediaFailureMsg"),color:"error",timeout:ct,target:Ce}),new U("Some file(s) has not been uploaded correctly");if(E||(await(h.uploading?h.uploadPromise:Ie(h)),E=h.mediaItemFull),!E)throw new U("Empty uploaded media item")})}function nt(){B()}n.watch(()=>N.size,(h,E)=>{for(const I of N.values())!I.mediaItemFull&&!I.uploadError&&Ie(I);E===0&&h>=1?window.addEventListener("beforeunload",nt):E>=1&&h===0&&window.removeEventListener("beforeunload",nt)});const Ee=n.ref([]),Se=n.ref([]),Ue=n.ref([]);function we(h){Ue.value.push(h),Se.value=Se.value.filter(E=>E!==h)}async function ot(){return Promise.allSettled(Ue.value.map(h=>or({annotationUri:h.annotationUri,subjectUri:W}).then(()=>{c({category:"Media",label:"remove",event:"click",pd:{mediaType:G.Annotation,mediaUri:h.annotationUri}})}).catch(E=>{P.error(E)})))}function A(h){Ee.value=Ee.value.filter(E=>E!==h)}function H({annotationUri:h,relatedMediaUri:E}){return`<img ${ro}="${h}" ${St}="${G.Annotation}" ${E?`${ns}="${E}"`:""} ${un}="${ze.Comment}" />`}async function be(){const h=Ee.value[0],E=h.annotation;try{const I=h.relatedMediaUri,X=(await nm({annotation:E,subjectUri:W})).result;return c({category:"Media",label:"add",event:"click",pd:{mediaType:G.Annotation}}),H({annotationUri:X,relatedMediaUri:I})}catch(I){throw P.error(I),c({category:"Media",label:"uploadFailure",event:"click",pd:{mediaType:G.Annotation}}),new U("Fail to upload annotation")}}const Ne=n.computed(()=>[].concat(Se.value,u.value?j.value:[],Ee.value,Array.from(N.values())).map(h=>{let E="";return jt(h)?E=`annotation-item-${h.annotationUri}`:Ke(h)?E=`media-file-${h.id}`:so(h)?E=`annotation-raw-item-${h.annotation.annotation.size}`:E=`media-item-${h.mediaUri}`,{item:h,key:E}}));function dt(h){jt(h)?we(h):so(h)?A(h):Ke(h)?J({mediaFile:h,reason:0}):x(h)}const ee=n.computed(()=>!!Ne.value.length),_e=n.computed(()=>_.value.length===0||_.value==="<p></p>"),ge=n.computed(()=>_e.value&&!ee.value),Me=n.computed(()=>w.value||!ge.value||S.value),{isOverDropZone:Tt,resetDropZoneOver:Ht}=qa({target:g,onDrop:re,disabled:n.computed(()=>!u.value)});function Pt(){_.value="<p></p>",Se.value=[],Ee.value=[],N.clear(),j.value=[],Y.value=[],p&&localStorage.removeItem(p)}function uo(h){return h}function fn({richMessage:h,annotations:E,appendContent:I}){if(h){const q=h;_.value=I?`${_.value}${_.value?"<br>":""}${q}`:q}const X=E==null?void 0:E[0];X&&(Ee.value=[X])}function pn(){if(p)if(_e.value)localStorage.removeItem(p);else{const h=Za(_).reversedHtml.value;localStorage.setItem(p,h)}}async function zt(){if(R.value)return;if(ge.value){Pt();return}R.value=!0;let h="";const E=[];try{const I=Za(_);Y.value.length&&E.push(k().then(()=>{Y.value=[]})),Ue.value.length&&E.push(ot().then(()=>{Ue.value=[]})),Se.value.length&&(h=Se.value.reduce((q,{annotationUri:te,relatedMediaUri:vt})=>q+H({annotationUri:te,relatedMediaUri:vt}),h)),j.value.length&&(h=j.value.reduce((q,{mediaUri:te,type:vt,source:C})=>q+ye({mediaUri:te,mediaType:vt,source:C}),h)),Ee.value.length&&E.push(be().then(q=>h=h+q)),N.size&&E.push(Promise.all(Mt()).then(()=>{h=Array.from(N.values()).reduce((q,{mediaItemFull:te})=>q+(te?ye({mediaUri:te.mediaUri,mediaType:te.type,source:ze.SocialMedia}):""),h)})),await Promise.all(E);const X=sd(I.reversedHtml.value);a("submit",{richMessage:I.reversedHtml.value+h,mentionedUsers:X}),X.forEach(q=>{let te="mentionUser";q.usersGroupId&&(te="mentionUsersGroup"),c({category:"CommentInput",label:te,event:"click"})}),Pt(),R.value=!1,S.value=!1}catch(I){P.error(I),R.value=!1}}async function mt(h){if(h){const{target:I}=h;if(I&&!I.classList.contains(ir))return}await(await At({fn:()=>{const I=y.value;if(!I)throw new U("Empty ckeditor cmp");return I}})).focusEditor()}async function hn(){Me.value&&(S.value=!S.value,mt(),a("toggleToolbar",{isShown:S.value}),c({category:"CommentInput",label:S.value?"showFormatting":"hideFormatting",event:"click"}))}function vn(h){a("input",h)}function ft({dataTransfer:h}){if(Ht(),u.value&&h.files.length){M(h.files);return}}function It(h){yn(),a("blur",h)}function D(h){yn(),a("focus",h)}function F(){zt(),c({category:"CommentInput",label:"publishWithEnterKey",event:"input"})}function me(){zt(),c({category:"CommentInput",label:"clickOnSendBtn",event:"click"}),c({category:"CommentInput",label:"publishWithSendBtn",event:"click"})}function pt(){Q(),c({category:"CommentInput",label:"clickOnUploadMediaBtn",event:"click"})}function ht(){hn(),c({category:"CommentInput",label:"clickOnFormatingBtn",event:"click"})}function re({files:h}){!u.value||h.length===0||M(h)}const{focused:Nt}=Ni(g),{isOutside:ps}=Oi(g);function yn(){const h=n.unref(Nt),E=n.unref(ps);h&&(w.value=!0),!h&&E&&(w.value=!1)}n.watch(()=>v&&v.value,h=>{if(h){b.value=h.htmlModel;const{annotations:E,medias:I}=f(b.value),X=E[0];Se.value=X?[X]:[],j.value=I}}),n.watch(()=>s.value,()=>{s.value&&(v=Qo(n.toRef(s,"value")))}),n.watch(Nt,yn),n.onBeforeUnmount(()=>{pn(),B()});const{height:hs}=Ks(g),mo=n.computed(()=>ee.value||S.value||hs.value>42);t({ckeditorWrapperInlineCmpRef:y,clearMessage:Pt,setMessage:fn,setFocus:mt});const vs=n.defineAsyncComponent(()=>new Promise((h,E)=>ie(["./ckeditor-wrapper-inline-Dg-qxzLi"],h,E)));return(h,E)=>{const I=n.resolveComponent("vu-icon-btn"),X=n.resolveDirective("tooltip"),q=n.resolveDirective("mask");return n.withDirectives((n.openBlock(),n.createElementBlock("div",{ref:"commentInputMainCtnEl",class:n.normalizeClass(["print:!hidden",[ir,{stc_disabled:h.disabled,"stc_is-publishing":R.value,"stc_hide-toolbar":!S.value,"stc_has-focus":n.unref(Nt),"stc_show-right-btns":Me.value,"stc_show-right-btns-in-new-line":ee.value||S.value,"stc_is-empty":ge.value,"stc_has-any-medias":ee.value,"stc_pointy-border":mo.value,"stc_is-over-drop-zone":n.unref(Tt)}]]),onClick:mt},[n.createVNode(n.unref(vs),{ref:"ckeditorWrapperInlineCmp",modelValue:_.value,"onUpdate:modelValue":E[0]||(E[0]=te=>_.value=te),class:"stc_comment-input_text-input-cmp","disable-user-mention":!n.unref(m),disabled:h.disabled,"focus-at-start":s.focusAtStart,placeholder:s.placeholder,"show-toolbar":S.value,"submit-with-enter-key":T.value,"tracker-opts":s.trackerOpts,onBlur:It,onFocus:D,onKeydown:vn,onPaste:ft,onPressEscapeKey:E[1]||(E[1]=te=>a("pressEscapeKey")),onSubmit:F},null,8,["modelValue","disable-user-mention","disabled","focus-at-start","placeholder","show-toolbar","submit-with-enter-key","tracker-opts"]),n.unref(u)&&n.unref(Tt)?(n.openBlock(),n.createBlock(Zd,{key:0,class:"stc_comment-input_drop-zone","no-border":""})):n.createCommentVNode("",!0),n.createElementVNode("div",Em,[ee.value?(n.openBlock(),n.createElementBlock("div",Sm,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(Ne.value,te=>(n.openBlock(),n.createBlock(ar,{key:te.key,class:"stc_comment-input_media-item-cmp",item:te.item,removable:"","show-border":"",onRemove:vt=>dt(te.item),onRetry:()=>{n.unref(Ke)(te.item)&&Ie(te.item)}},null,8,["item","onRemove","onRetry"]))),128))])):n.createCommentVNode("",!0),n.createElementVNode("div",{class:"stc_comment-input_right-btns-ctn",onClick:mt},[n.withDirectives(n.createVNode(I,{active:S.value,class:"stc_comment-intput_formatting-btn stc_comment-input_right-btn",disabled:!Me.value,icon:"text",onClick:ht},null,8,["active","disabled"]),[[X,{attach:n.unref(i),text:n.unref(l)("formattingBtnTooltip")}]]),n.unref(u)?n.withDirectives((n.openBlock(),n.createBlock(I,{key:0,class:"stc_comment-input_add-media-btn stc_comment-input_right-btn",disabled:!Me.value,icon:"upload",onClick:pt},null,8,["disabled"])),[[X,{attach:n.unref(i),text:n.unref(l)("addMediaBtnTooltip")}]]):n.createCommentVNode("",!0),n.withDirectives(n.createVNode(I,{class:"stc_comment-input_submit-btn stc_comment-input_right-btn",disabled:!Me.value||ge.value,icon:"send",onClick:E[2]||(E[2]=te=>!ge.value&&me())},null,8,["disabled"]),[[X,{attach:n.unref(i),text:n.unref(l)("submitBtnTooltip")}]])])])],2)),[[q,R.value]])}}}),[["__scopeId","data-v-a519e6d4"]]),Am={ref:"groupContainerEl",class:"stc_modal-users-group-viewer_group-wrapper"},Rm=pe(n.defineComponent({__name:"modal-users-group-viewer",props:{title:{default:void 0},usersGroupId:{}},emits:["close"],setup(e,{emit:t}){const o=e,s=t,{$i18n:a}=ae("social-toolbar"),r=n.useTemplateRef("groupContainerEl");return n.onMounted(async()=>{const i=await ue("DS/i3DXRDFGroupViewer/js/GroupViewer"),c=new i({language:it,groupId:o.usersGroupId,platformId:V()});if(!r.value)throw new U("GroupContainerEl not rendered yet");c.render().inject(r.value)}),(i,c)=>{const l=n.resolveComponent("vu-modal");return n.openBlock(),n.createBlock(n.Teleport,{to:"body"},[n.createVNode(l,{class:"stc_modal-users-group-viewer_main-ctn","no-mobile":!0,show:"","show-cancel-icon":"",title:i.title||n.unref(a)("usersGroupViewerModalTitle"),onClose:c[0]||(c[0]=d=>s("close")),onConfirm:c[1]||(c[1]=d=>s("close"))},{"modal-body":n.withCtx(()=>[n.createElementVNode("div",Am,null,512)]),"modal-footer":n.withCtx(()=>c[2]||(c[2]=[n.createElementVNode("span",null,null,-1)])),_:1},8,["title"])])}}}),[["__scopeId","data-v-6d79f6bf"]]);function Um({className:e="",onCancel:t}){return n.defineAsyncComponent(async()=>{const{$i18n:o,promise:s}=ae("social-toolbar");return await s,{template:o("pressEscOrClickHereToCancel",{"<a>":`<a href="#" class="${e}" @click.prevent="clickCancel">`,"</a>":"</a>"}),methods:{clickCancel:t}}})}var ve=(e=>(e.Picture="media-picture",e.Video="video-player",e.Media3D="media-3dplay-player",e))(ve||{});async function is(e){const t=await ue("DS/3DPlaySupport/AssetSupport");return new Promise(o=>{t.checkSupport({provider:"FILE",type:e},{},s=>{o(s)})})}async function Mm(e){var s;const{extension:t}=e;return await is(t||"")||e.processing===oo.PROCESSED&&((s=e.docStreams)==null?void 0:s.find(r=>r.format==="pdf"))?ve.Media3D:ve.Picture}async function Tm(e){var s;const{extension:t}=e;return await is(t||"")||e.processing===oo.PROCESSED&&((s=e.threeDStreams)==null?void 0:s.find(r=>r.format==="3dxml"))?ve.Media3D:ve.Picture}function Pm(){return ve.Picture}function Im(){return ve.Video}function Nm(e){var o,s;let t;return e.type===G.Model3D?t=(o=e.threeDStreams)==null?void 0:o.find(a=>a.format==="3dxml"):e.type===G.Document&&(t=(s=e.docStreams)==null?void 0:s.find(a=>a.format==="pdf")),t}async function Bm(e){const t=await is(e.extension||"");let o="",s="";if(t)o=e.downloadOriginalUrl,s=e.extension||"";else{const a=Nm(e);a?(o=a.transientUrl,s=a.format):P.error("No stream found")}return{url:o,fileExtension:s}}async function Dm(e){const{url:t,fileExtension:o}=await Bm(e);return{input:{asset:{filename:t,format:o,provider:"FILE",withCredentials:!0,proxyurl:"none",requiredAuth:null,requestsOptions:{proxy:"none"}},usage:"3DSwYm"},options:{topBar:{id:""},loading:"autoplay",activeState:!0,callbacks:{}}}}function Lm(e){var o,s,a,r;return{url:((s=(o=e.view)==null?void 0:o.find(i=>i.alias==="o1"))==null?void 0:s.transientUrl)||((r=(a=e.preview)==null?void 0:a.find(i=>i.alias==="l"))==null?void 0:r.transientUrl)||""}}var cs=(e=>(e.CAPTIONS="captions",e.CHAPTERS="chapters",e))(cs||{});function xm(e){var s,a;const t=((s=e.subtitles)==null?void 0:s.map(r=>({src:r.transientUrl,label:r.alias,kind:cs.CAPTIONS})))||[],o=((a=e.chapters)==null?void 0:a.map(r=>({src:r.transientUrl,label:r.alias,kind:cs.CHAPTERS})))||[];return[...t,...o]}function Om(e){const t=e.avStreams;return t?t.map(o=>({tag:"source",src:o.transientUrl,label:o.alias,res:o.alias,type:`video/${o.format}`})):[]}function Fm(e){return{autoplay:!0,controls:!0,loop:!1,muted:!1,playbackRates:[.25,.5,1,1.25,1.5,2],controlBar:{fullscreenToggle:!0,pictureInPictureToggle:!1,volumePanel:{inline:!1}},tracks:[...xm(e)],sources:[...Om(e)]}}const jm={[ve.Picture]:n.defineAsyncComponent(()=>new Promise((e,t)=>ie(["./picture-player-BYwWBr1M"],e,t))),[ve.Video]:n.defineAsyncComponent(()=>new Promise((e,t)=>ie(["./video-player-Cc47_-WB"],e,t))),[ve.Media3D]:n.defineAsyncComponent(()=>new Promise((e,t)=>ie(["./media-3dplay-player-LGnDJIi_"],e,t)))},Vm={[ve.Picture]:Lm,[ve.Video]:Fm,[ve.Media3D]:Dm},ls={[G.Picture]:Pm,[G.Video]:Im,[G.Document]:Mm,[G.Model3D]:Tm};async function Wm(e){var o;return await Promise.resolve((o=ls[e.type])==null?void 0:o.call(ls,e))||ve.Picture}async function Gm(e){const t=await Wm(e),o=jm[t],s=await Vm[t](e);return{component:o,config:s}}function Hm(e){const t=Ze(()=>Gm(n.unref(e)),{component:void 0,config:void 0});return n.toRefs(pi(t))}const zm=n.defineComponent({__name:"media-player",props:{media:{}},setup(e){const t=e,{media:o}=n.toRefs(t),{config:s,component:a}=Hm(o);return(r,i)=>n.unref(a)&&n.unref(s)?(n.openBlock(),n.createBlock(n.resolveDynamicComponent(n.unref(a)),{key:0,config:n.unref(s)},null,8,["config"])):n.createCommentVNode("",!0)}});function Km(e){const{$i18n:t}=ae("social-toolbar"),o=n.computed(()=>pm(n.unref(e).size||0)),s=n.computed(()=>{const{width:a,height:r,ratio:i}=n.unref(e);return a&&r&&i?hm({width:a,height:r,ratio:i}):t("analysisInProgressMsg")});return{size:o,resolution:s}}const Ym={class:"stc_media-properties_ctn"},Xm={class:"stc_media-properties_property-label"},Jm={class:"stc_media-properties_property"},Qm={class:"stc_media-properties_property-label"},Zm={class:"stc_media-properties_property"},qm={class:"stc_media-properties_property-label"},$m={class:"stc_media-properties_file-details_ctn"},ef={class:"stc_media-properties_file-details_label"},tf={class:"stc_media-properties_file-details_property"},nf={class:"stc_media-properties_file-details_label"},of={class:"stc_media-properties_file-details_property"},sf={class:"stc_media-properties_file-details_label"},af={class:"stc_media-properties_file-details_property"},rf=pe(n.defineComponent({__name:"media-properties",props:{media:{}},setup(e){const t=e,{$i18n:o}=ae("social-toolbar"),s=se(L.RichUserTooltip),{media:a}=n.toRefs(t),{size:r,resolution:i}=Km(a);return(c,l)=>(n.openBlock(),n.createElementBlock("div",Ym,[n.createElementVNode("label",Xm,n.toDisplayString(n.unref(o)("titleLabelMediaProperties")),1),n.createElementVNode("div",Jm,n.toDisplayString(n.unref(a).title),1),n.createElementVNode("label",Qm,n.toDisplayString(n.unref(o)("authorLabelMediaProperties")),1),n.createElementVNode("div",Zm,[n.createVNode(Oo,{"disable-rich-user-tooltip":!n.unref(s),user:{login:n.unref(a).author.login}},null,8,["disable-rich-user-tooltip","user"])]),n.createElementVNode("label",qm,n.toDisplayString(n.unref(o)("fileDetailsLabelMediaProperties")),1),n.createElementVNode("div",$m,[n.createElementVNode("span",ef,n.toDisplayString(n.unref(o)("fileNameFileDetailsLabelMediaProperties")),1),n.createElementVNode("span",tf,n.toDisplayString(n.unref(a).originalName),1),n.createElementVNode("span",nf,n.toDisplayString(n.unref(o)("resolutionFileDetailsLabelMediaProperties")),1),n.createElementVNode("span",of,n.toDisplayString(n.unref(i)),1),n.createElementVNode("span",sf,n.toDisplayString(n.unref(o)("sizeFileDetailsLabelMediaProperties")),1),n.createElementVNode("span",af,n.toDisplayString(n.unref(r)),1)])]))}}),[["__scopeId","data-v-b27b94f8"]]);var us=(e=>(e.Information="information",e))(us||{});function cf({media:e,subjectUri:t,callbacks:o}){const{$i18n:s}=ae("social-toolbar"),a=dn({subjectUri:t});return{actions:n.computed(()=>{const i=[];return i.push(n.reactive({name:"information",label:s("informationMediaLightboxPanel"),fonticon:"topbar-info",selected:!1,handler:()=>{var c;(c=o==null?void 0:o.onInformationClick)==null||c.call(o)}}),{name:"download",label:s("downloadDDMenuItem"),fonticon:"download",handler:()=>a.download(n.unref(e))}),i})}}function lf({media:e,subjectUri:t}){const{$i18n:o}=ae("social-toolbar"),s=dn({subjectUri:t});return{actions:n.computed(()=>{const r=[];return r.push({name:"restart-processing",label:o("restartProcessingDDMenuItem"),fonticon:"refresh",handler:async()=>{s.restartProcessing({media:n.unref(e)})}}),r})}}function uf({mediaUris:e,index:t}){const o=n.unref(t),s=n.ref(o),a=n.computed(()=>n.unref(e).length>1),r=n.computed(()=>n.unref(e)[s.value]);function i(){if(!a.value)return;const l=++s.value,d=n.unref(e).length;s.value=(l%d+d)%d}function c(){if(!a.value)return;const l=--s.value,d=n.unref(e).length;s.value=(l%d+d)%d}return{currentMediaUri:r,hasMultipleMedia:a,next:i,previous:c}}function df(){const e=n.ref([]);e.value.push({name:us.Information,title:"Information",show:!1,toggle(){this.show=!this.show}});function t(o){return e.value.find(s=>s.name===o)}return{panels:e,getPanel:t}}const mf=n.defineComponent({__name:"t-media-lightbox",props:{uris:{},index:{default:0}},emits:["close"],setup(e,{emit:t}){const o=e,s=t,{$i18n:a}=ae("social-toolbar"),{currentMediaUri:r,hasMultipleMedia:i,next:c,previous:l}=uf({mediaUris:o.uris,index:o.index}),d=Ze(async()=>(await lm({subjectUri:W,mediaUri:r.value})).result,fm()),{panels:u}=df(),{actions:m}=cf({media:d,subjectUri:W,callbacks:{onInformationClick:()=>{const v=u.value.find(y=>y.name===us.Information);v==null||v.toggle();const g=m.value.find(y=>y.name==="information");(g==null?void 0:g.selected)!==void 0&&(g.selected=!g.selected)}}}),{actions:p}=lf({media:d,subjectUri:W}),f=n.computed(()=>[{name:"previous",label:a("previousMediaLightboxAction"),fonticon:"chevron-left",handler:l,hidden:!i.value},{name:"next",label:a("nextMediaLightboxAction"),fonticon:"chevron-right",handler:c,hidden:!i.value}]);return(v,g)=>{const y=n.resolveComponent("vu-lightbox");return n.openBlock(),n.createBlock(y,{"disable-compass":"","menu-actions":n.unref(p),panels:n.unref(u),"primary-actions":n.unref(m),"side-actions":f.value,title:n.unref(d).title,onClose:g[0]||(g[0]=w=>s("close"))},{"lightbox-content":n.withCtx(()=>[(n.openBlock(),n.createBlock(zm,{key:n.unref(d).mediaUri,media:n.unref(d)},null,8,["media"]))]),"lightbox-panel-information":n.withCtx(()=>[n.createVNode(rf,{media:n.unref(d)},null,8,["media"])]),_:1},8,["menu-actions","panels","primary-actions","side-actions","title"])}}}),ff=["data-content-type","data-login"],pf=["data-content-type","data-users-group-uri"],hf=n.defineComponent({__name:"a-rich-message-user-mention",props:{disableRichUserTooltip:{type:Boolean},forceUseStaticName:{type:Boolean,default:!1},staticName:{},trackerOpts:{},uid:{},userType:{}},emits:["click"],setup(e,{emit:t}){const o=e,s=t,a=n.inject(We);if(!a)throw new U("Empty SocialToolbarProvide");const{stcMainElRef:r,onClickUser:i}=a,c=se(L.RichUserTooltip),l=n.computed(()=>!c.value||o.disableRichUserTooltip),d=Ze(async()=>{let m=o.staticName;if(o.forceUseStaticName||o.userType===le.Group)m=o.staticName;else try{m=await td({login:o.uid,trackerOpts:o.trackerOpts})}catch{m=o.staticName}return $n(m)},o.staticName),u=n.computed(()=>qn(d.value));return(m,p)=>{const f=n.resolveDirective("tooltip");return m.userType===n.unref(le).Person?(n.openBlock(),n.createBlock(Do,{key:0,disabled:l.value,"user-login":o.uid,onGoToProfile:p[1]||(p[1]=v=>n.unref(i)({userLogin:v}))},{default:n.withCtx(({setRef:v})=>[n.withDirectives((n.openBlock(),n.createElementBlock("a",{ref:g=>v(g),class:n.normalizeClass(["clickable",n.unref(ln)]),"data-content-type":n.unref(le).Person,"data-login":m.uid,onClick:p[0]||(p[0]=n.withModifiers(g=>s("click",{userLogin:m.uid}),["prevent"]))},[n.createTextVNode(n.toDisplayString(u.value),1)],10,ff)),[[f,l.value?{attach:n.unref(r),text:n.unref(d)}:void 0]])]),_:1},8,["disabled","user-login"])):n.withDirectives((n.openBlock(),n.createElementBlock("a",{key:1,class:n.normalizeClass(["clickable",n.unref(ln)]),"data-content-type":n.unref(le).Group,"data-users-group-uri":m.uid,onClick:p[2]||(p[2]=n.withModifiers(v=>{s("click",{usersGroupId:m.uid})},["prevent"]))},[n.createTextVNode(n.toDisplayString(u.value),1)],10,pf)),[[f,n.unref(d)?{attach:n.unref(r),text:n.unref(d)}:void 0]])}}}),vf={class:"stc_comment-item-rich-message_main-ctn"},yf=pe(n.defineComponent({__name:"m-comment-item-rich-message",props:{commentItem:{}},setup(e){const t=e,o=n.inject(We);if(!o)throw new U("Empty SocialToolbarProvide");const{onClickUser:s}=o,a=n.computed(()=>t.commentItem.richMessage||"<div></div>"),r=n.reactive(new Map);function i(d=""){const u=new DOMParser().parseFromString(d,"text/html");return[...u.querySelectorAll(`a[${et}]`),...u.querySelectorAll(`a[${tt}]`)].forEach(m=>{const p=crypto.randomUUID(),f=m.getAttribute(et),v=m.getAttribute(tt),g=f||v;if(!g){P.error("Missing mandatory attribute on the user-mention element:",m);return}const y=Ct(m.getAttribute(Oe)||"")||(f?le.Person:le.Group);r.set(p,{staticName:m.innerHTML,trackerOpts:{commentUri:t.commentItem.commentUri,commentKind:t.commentItem.parentCommentUri?"reply":"comment"},uid:g,userType:y});const w=u.createElement("slot");w.setAttribute("name",p),w.innerHTML=m.innerHTML,m.replaceWith(w)}),u.body.innerHTML}function c(d=""){const u=new DOMParser().parseFromString(d,"text/html");return u.querySelectorAll('a:not([data-type="internal"])').forEach(m=>{m.setAttribute("target","_blank")}),u.body.innerHTML}const l=n.shallowRef();return n.watch([a],()=>{const u=[i,c].reduce((m,p)=>p(m),a.value);l.value=n.defineAsyncComponent(async()=>({template:u}))},{immediate:!0}),(d,u)=>(n.openBlock(),n.createElementBlock("div",vf,[n.createVNode(n.unref(l),null,n.createSlots({_:2},[n.renderList(r,([m,p])=>({name:m,fn:n.withCtx(()=>[n.createVNode(hf,n.mergeProps(p,{onClick:u[0]||(u[0]=f=>n.unref(s)({userLogin:f.userLogin,usersGroupId:f.usersGroupId}))}),null,16)])}))]),1024)]))}}),[["__scopeId","data-v-fc2c67db"]]),gf={key:0,class:"stc_comment-item-content_ddmenu-ctn"},wf={class:"stc_comment-item-content_message-ctn"},bf={key:1,class:"stc_comment-item-content_medias-ctn"},_f=["data-date"],cr=1.375,kf=5,Cf=pe(n.defineComponent({__name:"m-comment-item-content",props:{comment:{}},emits:["remove","edit","clickOnAuthor"],setup(e,{emit:t}){const o=e,s=t,a=n.inject(We);if(!a)throw new U("Empty SocialToolbarProvide");const{onClickMedia:r,onClickUser:i,stcMainElRef:c}=a,l=zs(Js).smaller("lg"),{trackPageEvent:d}=qe("m-comment-item-content"),{$i18n:u,promise:m}=ae("social-toolbar"),p=n.ref(!1);m.then(()=>p.value=!0);const f=se(Ot.MobileDevice),v=se(L.SeeMore),g=se(L.ShowMediaOnClick),y=se(L.DisplayMedia),w=se(L.RichUserTooltip),R=n.ref(!1),S=n.computed(()=>!!o.comment.parentCommentUri),T=n.computed(()=>o.comment.richMessage),b=n.computed(()=>{var H;const A=document.createElement("div");return A.innerHTML=T.value,!!((H=A.textContent)!=null&&H.trim())}),_=n.computed(()=>o.comment.moderationState!==xo.NotModerated),N=n.ref(!1),j=n.ref(0),Y=n.computed(()=>{var A;return kt.value.login===((A=o.comment.author)==null?void 0:A.login)}),M=n.computed(()=>{var A,H;return!!((H=(A=o.comment._acl)==null?void 0:A.update)!=null&&H.access)||Yn.value||Y.value}),Q=n.computed(()=>{var A,H;return!!((H=(A=o.comment._acl)==null?void 0:A.delete)!=null&&H.access)||Yn.value||Y.value}),k=n.computed(()=>{const A=[];return M.value&&A.push({text:u("editDDMenuItem"),fonticon:"pencil",class:"stc_comment-item-content_edit-ddmenu-item stc_comment-item-content_ddmenu-item",handler(){s("edit")}}),Q.value&&A.push({text:u("deleteDDMenuItem"),fonticon:"trash",class:"stc_comment-item-content_delete-ddmenu-item stc_comment-item-content_ddmenu-item",handler(){s("remove")}}),A});function x(){const A=o.comment.author;A!=null&&A.login&&i({userLogin:A.login}),d({category:"Comment",label:"clickOnAuthor",event:"click",pd:{commentUri:o.comment.commentUri,commentKind:S.value?"reply":"comment"}})}function J(A){d({category:"Comment",label:A,event:"click",pd:{commentUri:o.comment.commentUri,commentKind:S.value?"reply":"comment"}})}const B=n.computed(()=>ss(T.value)),ye=n.computed(()=>B.value.map(A=>A.mediaUri));function Ie(A){const H=A.mediaUri,be={subjectUri:W,mediaUri:H,type:A.type,source:A.source};r(be),g.value&&(j.value=B.value.findIndex(Ne=>Ne===A),N.value=!0)}const Mt=n.computed(()=>os(T.value));async function nt(A){const H=A.annotationUri,be={subjectUri:W,annotationUri:H,relatedMediaUri:A.relatedMediaUri||W,annotation:{annotation:await tm({subjectUri:W,annotationUri:H}),screenshot:await om({subjectUri:W,annotationUri:H})},source:ze.Comment};r(be)}const Ee=n.computed(()=>[].concat(Mt.value,y.value?B.value:[]).map(A=>{let H="";return jt(A)?H=A.annotationUri:H=A.mediaUri,{item:A,key:H}}));function Se(A){let H,be;jt(A)?(nt(A),be=G.Annotation,H=A.annotationUri):(Ie(A),be=A.type,H=A.mediaUri),d({category:"Media",label:"open",event:"click",pd:{mediaType:be,mediaUri:H}})}function Ue(){R.value=!0,d({category:"Comment",label:"showDDMenu",event:"click",pd:{commentUri:o.comment.commentUri,commentKind:S.value?"reply":"comment"}})}function we(){R.value=!1,d({category:"Comment",label:"hideDDMenu",event:"click",pd:{commentUri:o.comment.commentUri,commentKind:S.value?"reply":"comment"}})}function ot(){d({category:"Comment",label:"clickOnDDMenuItem",event:"click",pd:{commentUri:o.comment.commentUri,commentKind:S.value?"reply":"comment"}})}return(A,H)=>{const be=n.resolveComponent("vu-icon-btn"),Ne=n.resolveComponent("vu-dropdownmenu"),dt=n.resolveDirective("tooltip");return n.openBlock(),n.createBlock(Oo,{class:n.normalizeClass(["stc_comment-item-content_main-ctn",{"stc_is-mobile-device":n.unref(f),"stc_ddmenu-shown":R.value}]),date:A.comment.creationDate,"date-format":"since","disable-rich-user-tooltip":!n.unref(w),user:A.comment.author,onClickOnUserName:x,onClickOnUserPicture:x},{default:n.withCtx(()=>[n.createElementVNode("div",{class:n.normalizeClass(["stc_comment-item-content_main-inner-ctn stc_type-comment",{"stc_is-edited":_.value,"stc_has-rich-message-text":b.value}])},[k.value.length?(n.openBlock(),n.createElementBlock("div",gf,[n.createVNode(Ne,{items:k.value,overlay:n.unref(l),position:"bottom-right",onClickItem:ot,onClose:we,"onUpdate:show":Ue},{default:n.withCtx(()=>[n.withDirectives(n.createVNode(be,{class:"stc_comment-item-content_ddmenu-btn",icon:"chevron-down"},null,512),[[dt,n.unref(f)?void 0:{attach:n.unref(c),text:n.unref(u)("openCommentDDMenu")}]])]),_:1},8,["items","overlay"])])):n.createCommentVNode("",!0),n.createElementVNode("div",wf,[b.value?(n.openBlock(),n.createBlock(n.unref(Rc),{key:0,"bottom-fade-color":"var(--color-grey-1)","btns-class":"text-2sm",class:"stc_comment-item-content_rich-message-ctn",disabled:!n.unref(v),"line-height-btns":`${cr}em`,"max-height":`${kf*cr}em`,onClickSeeLessBtn:H[0]||(H[0]=ee=>J("showLess")),onClickSeeMoreBtn:H[1]||(H[1]=ee=>J("showMore"))},{default:n.withCtx(()=>[n.createVNode(yf,{class:"stc_comment-item-content_rich-message-cmp","comment-item":A.comment},null,8,["comment-item"])]),_:1},8,["disabled","line-height-btns","max-height"])):n.createCommentVNode("",!0),Ee.value.length?(n.openBlock(),n.createElementBlock("div",bf,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(Ee.value,ee=>(n.openBlock(),n.createBlock(ar,{key:ee.key,class:"stc_comment-item-content_media-item-cmp",clickable:"",item:ee.item,"show-border":"",onClick:_e=>Se(ee.item)},null,8,["item","onClick"]))),128))])):n.createCommentVNode("",!0),_.value?n.withDirectives((n.openBlock(),n.createElementBlock("div",{key:2,class:"stc_comment-item-content_edited-stamp","data-date":A.comment.modificationDate.getTime()},[n.createTextVNode(n.toDisplayString(n.unref(u)("editedStamp")),1)],8,_f)),[[dt,{attach:n.unref(c),text:A.comment.modificationDate.toLocaleString(n.unref(it))}]]):n.createCommentVNode("",!0)])],2),(n.openBlock(),n.createBlock(n.Teleport,{to:"body"},[N.value?(n.openBlock(),n.createBlock(mf,{key:0,index:j.value,uris:ye.value,onClose:H[2]||(H[2]=ee=>N.value=!1)},null,8,["index","uris"])):n.createCommentVNode("",!0)]))]),_:1},8,["class","date","disable-rich-user-tooltip","user"])}}}),[["__scopeId","data-v-26677751"]]),Fe=n.reactive([]),Vt=n.ref(0),io=n.computed(()=>Vt.value),mn=n.computed(()=>Fe.length),co=new Map;function Rt(e,t){if(t)return ds(t,e);const o=Fe.find(s=>s.commentUri===e);if(!o)throw new U(`Comment "${e}" not found`);return o}function Ut(e){let t=co.get(e);return t||(t=n.reactive([]),co.set(e,t)),t}function ds(e,t){const s=Ut(e).find(a=>a.commentUri===t);if(!s)throw new U(`Reply "${e} - ${t}" not found`);return s}function lr(){Fe.splice(0),co.clear()}function Ef(e){Ut(e).splice(0)}async function Sf({parentCommentUri:e,richMessage:t}){const o=!!e,s=o?Ut(e):Fe;let a;o?(a=Rt(e),a.nbReplies+=1):Vt.value+=1;const r=Ou({author:kt.value,richMessage:t});s.push(r);try{const i=(await Bu({richMessage:t,subjectUri:W,parentCommentUri:e})).result;return s.splice(s.length-1,1,i),i}catch(i){const c=`Fail to add comment to: "${e??W}".`;throw P.error(c,i),o&&a&&(a.nbReplies-=1),o||(Vt.value-=1),s.pop(),new U(c)}}async function Af({comment:e,richMessage:t}){const o=e.commentUri,s=e.parentCommentUri,a=!!s,r=a?Ut(s):Fe;try{const i=(await Du({richMessage:t,subjectUri:W,commentUri:o,parentCommentUri:s,trackerCommentKind:a?"reply":"comment"})).result,c=r.findIndex(l=>l.commentUri===i.commentUri);return c>-1&&r.splice(c,1,i),i}catch(i){const c=`Fail to edit comment "${o}"`;throw P.error(c,i),new U(c)}}async function Rf({comment:e}){const t=e.parentCommentUri,o=!!t,s=o?Ut(t):Fe,a=W,r=e.commentUri;let i;o?(i=Rt(t),i.nbReplies-=1):Vt.value-=1;try{await Lu({subjectUri:a,commentUri:r,trackerCommentKind:o?"reply":"comment"})}catch(l){const d=`Fail to remove comment: ${r}`;throw P.error(d,l),o&&i&&(i.nbReplies+=1),o||(Vt.value+=1),new U(d)}o||co.delete(r);const c=s.findIndex(l=>l.commentUri===r);c>-1&&s.splice(c,1),Pf(e)}async function Uf({commentUri:e,parentCommentUri:t}){const o=Rt(e,t);if(!o.currentUserEndorse){o.nbEndorses+=1;try{const s=(await Iu({subjectUri:W,commentUri:o.commentUri,trackerCommentKind:t?"reply":"comment"})).result;o.currentUserEndorse=s}catch(s){const a=`Fail to like comment: ${e}`;throw P.error(a,s),o.nbEndorses-=1,new U(a)}}}async function Mf({commentUri:e,parentCommentUri:t}){var a;const o=Rt(e,t),s=(a=o.currentUserEndorse)==null?void 0:a.endorseUri;if(s){o.nbEndorses-=1;try{await Nu({subjectUri:W,commentUri:o.commentUri,endorseUri:s,trackerCommentKind:o.parentCommentUri?"reply":"comment"}),o.currentUserEndorse=void 0}catch(r){const i=`Fail to unlike comment: ${e}`;throw P.error(i,r),o.nbEndorses+=1,new U(i)}}}async function Tf({limit:e=0}={}){const t=W,o=e<=0;try{const a=(await(o?Ru:Au)({subjectUri:t,limit:e})).result;typeof a.hasModerationRights=="boolean"?bu(a.hasModerationRights):ku(),typeof a.hasGuestAccess=="boolean"&&Ma(a.hasGuestAccess);const r=a.subjectUris[t];if(!r)throw new U("Empty response");return Vt.value=r.nbComments,lr(),Fe.push(...r.comments),r}catch(s){throw P.error(s),new U(`Fail to fetch comments of "${t}"`)}}async function ur({limit:e,offset:t,checkIfCommentsAlreadyExist:o}={}){const s=W;try{let a=(await Uu({subjectUri:s,limit:e,offset:t??Fe.length})).result;o&&(a=a.filter(r=>!Fe.find(i=>i.commentUri===r.commentUri))),Fe.unshift(...a.reverse())}catch(a){const r=`Fail to fetch previous comments of "${s}".`;throw P.error(r,a),new U(r)}}async function dr({commentUri:e,limit:t,offset:o,checkIfRepliesAlreadyExist:s}){if(!(!Rt(e).nbReplies||!t))try{let r=(await Mu({subjectUri:W,commentUri:e,limit:t,offset:o})).result.replies;const i=Ut(e);o?(s&&(r=r.filter(c=>!i.find(l=>l.commentUri===c.commentUri))),i.unshift(...r)):(Ef(e),i.push(...r))}catch(r){const i=`Fail to fetch replies of "${e}"`;throw P.error(i,r),new U(i)}}async function Pf(e){const t=[],o=W,s=ss(e.richMessage);if(s.length){const r=dn({subjectUri:o});t.push(Promise.allSettled(s.map(i=>r.remove({media:i,silent:!0}))))}const a=os(e.richMessage);a.length&&t.push(Promise.allSettled(a.map(r=>or({annotationUri:r.annotationUri,subjectUri:o}).catch(i=>{P.error(i)})))),await Promise.allSettled(t)}function mr(){const{$i18n:e,promise:t}=ae("social-toolbar");async function o({parentCommentUri:u,richMessage:m}){try{return await Sf({parentCommentUri:u,richMessage:m})}catch(p){throw await t,ke.message.create({text:e(u?"addReplyFailureMsg":"addCommentFailureMsg"),color:"error",timeout:ct,target:Ce}),p}}async function s({comment:u,richMessage:m}){try{return await Af({comment:u,richMessage:m})}catch(p){const f=!!u.parentCommentUri;throw await t,ke.message.create({text:e("editCommentFailureMsg"),color:"error",timeout:ct,target:Ce}),p}}async function a({comment:u}){const m=!!u.parentCommentUri;let p="deleteCommentConfirmModalTitle",f="deleteCommentConfirmModalMsg",v="deleteCommentSuccessMsg",g="deleteCommentFailureMsg";m&&(p="deleteCommentConfirmModalTitle",f="deleteReplyConfirmModalMsg",v="deleteReplySuccessMsg",g="deleteReplyFailureMsg"),await t;let y=!1;try{y=await ke.modal.confirm({title:e(p),message:e(f),noMobile:!se(Ot.MobileDevice).value})}catch{}if(!y)return!1;try{await Rf({comment:u}),ke.message.create({text:e(v),color:"success",timeout:ct,target:Ce})}catch(w){throw ke.message.create({text:e(g),color:"error",timeout:ct,target:Ce}),w}return!0}async function r({commentUri:u,parentCommentUri:m}){try{await Uf({commentUri:u,parentCommentUri:m})}catch(p){throw p}}async function i({commentUri:u,parentCommentUri:m}){try{await Mf({commentUri:u,parentCommentUri:m})}catch(p){throw p}}async function c({limit:u=0}={}){try{return await Tf({limit:u})}catch(m){throw m}}async function l({commentUri:u,limit:m=0,offset:p}){try{await dr({commentUri:u,limit:m,offset:p})}catch(f){throw f}}async function d({limit:u=0}={}){try{await ur({limit:u})}catch(m){throw m}}return{add:o,edit:s,remove:a,like:r,unlike:i,fetchInitialComments:c,fetchPreviousComments:d,fetchReplies:l}}function fr(){const e=mr();async function t(s){return e.like({commentUri:s.commentUri})}async function o(s){return e.unlike({commentUri:s.commentUri})}return{comments:Fe,addComment:e.add,editComment:e.edit,removeComment:e.remove,likeComment:t,unlikeComment:o,fetchInitialComments:e.fetchInitialComments,fetchPreviousComments:e.fetchPreviousComments}}function If({comment:e}){const t=mr(),o=n.computed(()=>e.value.commentUri),s=n.computed(()=>e.value.parentCommentUri);async function a(u){const m=s.value||o.value;return await t.add({parentCommentUri:m,richMessage:u})}async function r({reply:u,richMessage:m}){return await t.edit({comment:u,richMessage:m})}async function i(u){await t.remove({comment:u})}async function c(u){return t.like({commentUri:u.commentUri,parentCommentUri:u.parentCommentUri})}async function l(u){return t.unlike({commentUri:u.commentUri,parentCommentUri:u.parentCommentUri})}async function d({limit:u,offset:m}){if(!(!e.value.nbReplies||!u))return t.fetchReplies({commentUri:o.value,limit:u,offset:m})}return{replies:Ut(e.value.commentUri),addReply:a,editReply:r,removeReply:i,likeReply:c,unlikeReply:l,fetchReplies:d}}function pr(e){const t=e.parentElement;if(!t)throw new U("Element has no parent");return t===document.body||t.offsetHeight<t.scrollHeight||t.offsetWidth<t.scrollWidth?t:pr(t)}async function Wt({el:e,waitNextTick:t=!0,waitTime:o}){o&&await as(o),t&&await n.nextTick();const s=pr(e),a=window.getComputedStyle(s,null),r=Number.parseInt(a.getPropertyValue("border-top-width"),10),i=Number.parseInt(a.getPropertyValue("border-left-width"),10),c=e.offsetTop-s.offsetTop<s.scrollTop,l=e.offsetTop-s.offsetTop+e.clientHeight-r,d=s.scrollTop+s.clientHeight,u=l>d,m=e.offsetLeft-s.offsetLeft<s.scrollLeft,p=e.offsetLeft-s.offsetLeft+e.clientWidth-i,f=s.scrollLeft+s.clientWidth,v=p>f;(c||u||m||v)&&e.scrollIntoView({block:"end",inline:"nearest"})}const Nf={class:"stc_comment-item_main-ctn"},Bf={key:1,ref:"editCommentInputCtnEl",class:"stc_comment-item_edit-input-ctn"},Df={class:"stc_comment-item_edit-input-hint"},Lf={key:2,class:"stc_comment-item_replies-ctn"},xf={key:0,class:"stc_comment-item_load-previous-replies-ctn"},Of={key:0,class:"stc_comment-item_load-previous-replies-loading-ctn"},Ff={key:1,class:"stc_comment-item_replies-list-ctn"},jf={key:3,ref:"addReplyInputCtnEl",class:"stc_comment-item_add-reply-input-ctn"},Vf=10,Wf=pe(n.defineComponent({__name:"o-comment-item",props:{comment:{},hideToolbar:{type:Boolean,default:!1},depth:{},inEdition:{type:Boolean,default:!1}},emits:["addReply","editReply","removeReply","toggleLikeReply","removeComment","toggleLikeComment","clickOnReplyBtn","submit","cancel","submitEditComment","submitEditReply"],setup(e,{emit:t}){const o=e,s=t,a=n.inject(We);if(!a)throw new U("Empty SocialToolbarProvide");const{setActiveCommentInput:r}=a,{trackPageEvent:i}=qe("o-comment-item"),{$i18n:c,promise:l}=ae("social-toolbar"),d=n.ref(!1);l.then(()=>d.value=!0);const u=se(L.CommentLike),m=se(L.Reply),p=se(L.UserMention),f=n.toRef(o,"comment"),{likeComment:v,unlikeComment:g}=fr(),{replies:y,addReply:w,editReply:R,removeReply:S,likeReply:T,unlikeReply:b,fetchReplies:_}=If({comment:f}),{escape:N}=Di(),j=n.computed(()=>f.value.commentUri),Y=n.computed(()=>!!f.value.parentCommentUri),M=n.ref(!!f.value.currentUserEndorse),Q=n.ref(f.value.nbEndorses),k=n.computed(()=>f.value.nbReplies),x=n.computed(()=>y.length),J=n.ref(!1),B=n.computed(()=>!o.hideToolbar),ye=n.computed(()=>m.value&&J.value&&d.value&&!Y.value),Ie=n.computed(()=>m.value&&k.value>0&&x.value<k.value),Mt=n.computed(()=>m.value&&!Y.value&&x.value>0),nt=n.useTemplateRef("editCommentInputCtnEl"),Ee=n.useTemplateRef("editCommentInputCmp"),Se=n.useTemplateRef("addReplyInputCtnEl"),Ue=n.useTemplateRef("addCommentReplyInputCmp"),we=n.ref(!1),ot=n.ref(o.inEdition||!1),A=n.computed({get:()=>ot.value,set:D=>{ot.value=D}});async function H(D){var me,pt,ht;if(Y.value){s("clickOnReplyBtn",f.value);return}if(await l,J.value=!0,await n.nextTick(),await(await At({fn:()=>{const re=Ue.value;if(!re)throw new U("Empty add comment input cmp");return re}})).setFocus(),Wt({el:Se.value}),(me=Ue.value)==null||me.clearMessage(),D&&p.value){const re=D.author;re&&((ht=(pt=Ue.value)==null?void 0:pt.ckeditorWrapperInlineCmpRef)==null||ht.insertMention(re))}}function be(){ft({trackerOpts:{label:"cancelEditWithCancelBtn"}})}function Ne(){ft({trackerOpts:{label:"cancelEditWithEscapeKey",event:"input"}})}async function dt(D){Y.value?s("submitEditReply",D):s("submitEditComment",D),ft({noTracking:!0})}async function ee(){Y.value?s("removeReply",f.value):s("removeComment",f.value)}let _e,ge=!1;const Me=n.ref(M.value?"likeSaved":"unlikeSaved"),Tt=Ao(async()=>{const D=!!f.value.currentUserEndorse;if(_e){ge=!0;return}const F=f.value;M.value&&!D?_e=Ht():!M.value&&D&&(_e=Pt()),_e==null||_e.then(()=>{_e=void 0,ge&&(ge=!1,Tt()),Y.value?s("toggleLikeReply",F):s("toggleLikeComment",F)})},200);async function Ht(){Me.value="likeSaving";const D=f.value;try{Y.value?await T(D):await v(D),Me.value="likeSaved"}catch{}}async function Pt(){Me.value="unlikeSaving";const D=f.value;try{Y.value?await b(D):await g(D),Me.value="unlikeSaved"}catch{}}async function uo(){M.value?(Q.value-=1,M.value=!1):(Q.value+=1,M.value=!0),Tt()}async function fn({nbReplies:D,trackerOpts:F}){await vn(D),i({category:"CommentsList",label:F.label,event:"click",pd:{commentUri:f.value.commentUri,commentKind:"comment"}})}async function pn(D){try{const F=await R(D);s("editReply",{reply:F,mentionedUsers:D.mentionedUsers}),i({category:"Comment",label:"edit",event:"click",pd:{commentUri:F.commentUri,commentKind:"reply"}})}catch{}}async function zt({richMessage:D,mentionedUsers:F}){try{const me=await w(D);s("addReply",{reply:me,mentionedUsers:F}),i({category:"Comment",label:"addReply",event:"click",pd:{commentUri:f.value.commentUri,commentKind:"comment"}})}catch{}}async function mt(D){try{await S(D),s("removeReply",D),i({category:"Comment",label:"remove",event:"click",pd:{commentUri:f.value.commentUri,commentKind:"reply"}})}catch{}}async function hn(D){const me=D.currentUserEndorse?"unlike":"like";s("toggleLikeReply",D),i({category:"Comment",label:me,event:"click",pd:{commentUri:D.commentUri,commentKind:"reply"}})}async function vn(D=Vf){we.value=!0;try{await _({limit:D,offset:x.value})}catch{}we.value=!1}function ft({noTracking:D,trackerOpts:F}={}){if(A.value&&(A.value=!1,!D)){const me={commentUri:f.value.commentUri,commentKind:Y.value?"reply":"comment"};F&&i({category:"Comment",label:F.label,event:F.event||"click",pd:me}),i({category:"Comment",label:"cancelEdit",event:"click",pd:me})}}const It=Um({onCancel:be,className:"stc_comment-item_cancel-edit-btn"});return n.watch(()=>o.inEdition,(D,F)=>{!D&&F?ft({noTracking:!0}):A.value=D}),Ve(N,Ne),(D,F)=>{const me=n.resolveComponent("vu-spinner"),pt=n.resolveComponent("vu-btn"),ht=n.resolveComponent("OCommentItem",!0);return n.openBlock(),n.createElementBlock("div",Nf,[A.value?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock(n.Fragment,{key:0},[n.createVNode(Cf,{comment:f.value,onEdit:F[0]||(F[0]=re=>A.value=!0),onRemove:ee},null,8,["comment"]),B.value?(n.openBlock(),n.createBlock(xa,{key:0,class:"stc_comment-item_actions-toolbar","comment-uri":f.value.commentUri,"data-saving-toggle-like":Me.value,depth:D.depth+1,"disable-comment":!n.unref(m),"disable-like":!n.unref(u),"disable-share":"","is-liked":M.value,mode:"large","nb-comments":k.value,"nb-likes":Q.value,"show-label":"","tracker-opts":{category:"Comment",commentKind:Y.value?"reply":"comment"},onClickOnCommentBtn:H,onClickOnLikeBtn:uo},null,8,["comment-uri","data-saving-toggle-like","depth","disable-comment","disable-like","is-liked","nb-comments","nb-likes","tracker-opts"])):n.createCommentVNode("",!0)],64)),A.value?(n.openBlock(),n.createElementBlock("div",Bf,[n.createVNode(rs,{ref:"editCommentInputCmp",class:"stc_comment-item_edit-comment-input","focus-at-start":"","tracker-opts":{commentUri:j.value,commentKind:"comment"},value:f.value.richMessage,onFocus:F[1]||(F[1]=re=>n.unref(r)(Ee.value)),onPressEscapeKey:Ne,onSubmit:dt,onToggleToolbar:F[2]||(F[2]=re=>n.unref(Wt)({el:nt.value}))},null,8,["tracker-opts","value"]),n.createElementVNode("div",Df,[n.createVNode(n.unref(It))])],512)):n.createCommentVNode("",!0),k.value?(n.openBlock(),n.createElementBlock("div",Lf,[Ie.value?(n.openBlock(),n.createElementBlock("div",xf,[we.value?(n.openBlock(),n.createElementBlock("div",Of,[n.createVNode(me)])):(n.openBlock(),n.createBlock(pt,{key:1,class:"stc_comment-item_load-previous-replies-btn",color:"link",onClick:F[3]||(F[3]=re=>fn({nbReplies:5,trackerOpts:{label:x.value>0&&x.value<k.value?"showMoreCommentReplies":"showCommentReplies"}}))},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(x.value>0&&x.value<k.value?n.unref(c)("showMoreRepliesBtn"):n.unref(c)("showRepliesBtn")),1)]),_:1}))])):n.createCommentVNode("",!0),Mt.value?(n.openBlock(),n.createElementBlock("div",Ff,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(n.unref(y),re=>(n.openBlock(),n.createBlock(ht,{key:re.commentUri,class:"stc_reply-item",comment:re,"data-id":re.commentUri,depth:D.depth+1,onClickOnReplyBtn:H,onRemoveReply:mt,onSubmitEditReply:Nt=>pn({...Nt,reply:re}),onToggleLikeReply:hn},null,8,["comment","data-id","depth","onSubmitEditReply"]))),128))])):n.createCommentVNode("",!0)])):n.createCommentVNode("",!0),ye.value?(n.openBlock(),n.createElementBlock("div",jf,[n.createVNode(rs,{ref:"addCommentReplyInputCmp",class:"stc_comment-item_comment-reply-input",placeholder:n.unref(c)("writeAReplyInputPlaceholder"),"storage-key":`${j.value}:newReply`,"tracker-opts":{commentUri:j.value,commentKind:"reply"},onFocus:F[4]||(F[4]=re=>n.unref(r)(Ue.value)),onPressEscapeKey:Ne,onSubmit:zt,onToggleToolbar:F[5]||(F[5]=re=>n.unref(Wt)({el:Se.value}))},null,8,["placeholder","storage-key","tracker-opts"])],512)):n.createCommentVNode("",!0)])}}}),[["__scopeId","data-v-940713cc"]]);function Gf({commentToHighlight:e}){const{$i18n:t,promise:o}=ae("social-toolbar"),s=n.ref(),a=n.ref(),r=n.ref(!1),i=n.ref(!1),c=n.ref(!1),l=n.ref(!1),d=n.ref(Promise.resolve());function u(){s.value=void 0,a.value=void 0,r.value=!1,i.value=!1}function m(){r.value=!1,i.value=!1}async function p(b){return At({fn:({abort:_})=>{if(l.value)throw _(),new Error("abort");const N=document.querySelector(`.stc_comment-item_main-ctn[data-id='${b}'] .stc_comment-item-content_main-inner-ctn`);if(!N)throw new U(`Comment element not found with uri: "${b}"`);return N},maxTry:50,pollInterval:50})}async function f(b){b.classList.add("stc_highlight-message-animation"),await as(5e3),b.classList.remove("stc_highlight-message-animation")}async function v({uri:b}){const _=await p(b);await Wt({el:_,waitTime:100}),f(_)}async function g({commentUri:b}){if(l.value)return;try{s.value=Rt(b);return}catch{}const _=50;await At({fn:async({tryIndex:N,abort:j})=>{if(l.value)return j();await ur({limit:_,offset:_*N,checkIfCommentsAlreadyExist:!0}),s.value=Rt(b)},maxTry:Math.ceil(io.value/_),pollInterval:0})}async function y({commentUri:b,replyUri:_}){if(!s.value)throw new Error("COMMENT_NOT_EXIST");try{a.value=ds(b,_);return}catch{}const N=s.value.nbReplies,j=50;await At({fn:async({tryIndex:Y,abort:M})=>{if(l.value)return M();await dr({commentUri:b,limit:j,offset:j*Y,checkIfRepliesAlreadyExist:!0}),a.value=ds(b,_)},maxTry:Math.ceil(N/j),pollInterval:0})}async function w({commentUri:b,replyUri:_}){try{await g({commentUri:b}),_&&await y({commentUri:b,replyUri:_})}catch(N){if(l.value)return;throw P.error(N),s.value||S("COMMENT_NOT_EXIST"),_&&!a.value&&S("REPLY_NOT_EXIST"),N}}async function R({commentUri:b,replyUri:_}){r.value=!0;try{await w({commentUri:b,replyUri:_})}catch{m();return}if(l.value){m();return}try{await v({uri:_||b}),i.value=!0}catch(N){P.error(N),S(b&&!_?"COMMENT_NOT_EXIST":"REPLY_NOT_EXIST"),m();return}if(l.value){m();return}i.value=!0,r.value=!1}async function S(b){await o;let _="";b==="COMMENT_NOT_EXIST"&&(_=t("commentNotExistMsg")),b==="REPLY_NOT_EXIST"&&(_=t("replyNotExistMsg")),ke.message.create({text:_,color:"error",timeout:ct,target:Ce})}async function T(){const{commentUri:b,replyUri:_}=n.unref(e)||{};if(u(),!(!b||l.value||!c.value))return l.value=!0,await d.value,l.value=!1,d.value=R({commentUri:b,replyUri:_}),d.value}return Ve(l,u),Ve(c,T),n.watch(e,async(b,_)=>{!b||!b.replyUri&&b.commentUri===(_==null?void 0:_.commentUri)||b.replyUri&&b.replyUri===(_==null?void 0:_.replyUri)||T()},{immediate:!0}),{stop:l,canStart:c,startPromise:n.computed(()=>d.value),isDone:n.computed(()=>i.value),isRunning:n.computed(()=>r.value)}}const hr=500;async function Hf(){const e={vuejs:"./vuejs/2.6.10/vue.min","vu-kit":"./vuekit/vu-kit.umd",vuex:"./vuex/3.1.1/vuex.min",Vuetify:"./vuetify-2.7.1/dist/vuetify.min"},t=Ae.getNativeAppRequireConfig();return t&&Object.assign(e,t.requirePaths),window.require?window.require&&window.widget?{paths:e}:{}:{baseUrl:Ji,waitSeconds:30,paths:{...e,ds:`${Qi}resources/0/0/wp/script`,"DS/UWPClientCode/UWA":"UWA2/js",UWA:"UWA2/js",vendors:"vendors"},shim:{"DS/PlatformAPI/PlatformAPI":["DS/UWPClientCode/PublicAPI"]},config:{i18n:{locale:it},"DS/Logger/Logger":{disableLog:!0}},skipDataMain:!0}}function zf(){Ps(async e=>({...e,...await Hf()}))}const Kf="2.3.1";function Yf(e){return{event:e.event,action:e.action,uri:e.uri,requestId:e["X-Request-ID"]}}let lo,Gt,ms="",fs="";async function Xf(){Gt=Ys($a);try{lo=await ue("DS/PlatformAPI/PlatformAPI",!0)}catch(e){P.error("Fail to subscribe to 3DNotification:",e);return}ms=fs=`subject_${W}`,lo.publish("volatileSubscription.notif.ds.com",{action:"subscribe",subscriptionId:ms,platformId:V()}),lo.subscribe(fs,e=>{try{const t=Yf(e);Gt.emit(t.event,t)}catch{P.error("Fail to parse 3DNotification data"),P.error(`3DNotif:<${fs}>`,e)}})}function Jf(){Gt==null||Gt.reset(),Gt=void 0;try{lo.publish("volatileSubscription.notif.ds.com",{action:"unsubscribe",subscriptionId:ms,platformId:V()})}catch{}}const Qf={key:2,class:"stc_social-toolbar_actions-toolbar-separator"},Zf={key:3,class:"stc_social-toolbar_load-previous-ctn"},qf={key:0,class:"stc_social-toolbar_loading-ctn"},$f={key:4,class:"stc_social-toolbar_comments-list-ctn"},ep={key:5,ref:"commentInputCtnEl",class:"stc_social-toolbar_comment-input-ctn"},tp=10,np=pe(n.defineComponent({__name:"t-social-toolbar",props:{alignCenterActionsToolbar:{type:Boolean},appForcedLinkUri:{default:void 0},appId:{},atInit:{default:()=>({})},commentToScrollTo:{default:void 0},currentUser:{},disableFeatures:{default:()=>({})},extraActionsBtns:{default:void 0},hasGuestAccess:{type:Boolean},hideActionsToolbar:{type:Boolean,default:!1},hideActionsToolbarLabels:{type:Boolean,default:!1},hideSeparator:{type:Boolean,default:!1},isCurrentUserGuest:{type:Boolean},lang:{default:void 0},legacyOptions:{default:void 0},platformId:{},subjectUri:{},urls:{}},emits:["clickOnLikeBtn","clickOnCommentBtn","clickOnShareBtn","clickOnExtraActionBtn","clickOnMedia","toggleLikeSubject","clickOnUser","addComment","editComment","removeComment","toggleLikeComment","loadInitialComments"],setup(e,{expose:t,emit:o}){const s=e,a=o;zf();const{trackPageEvent:r}=qe("t-social-toolbar"),{$i18n:i,promise:c}=ae("social-toolbar"),l=n.ref(!1);c.then(()=>l.value=!0);const d=se(L.Comment),u=se(L.Like),m=se(L.Share),p=se(L.ShowUserProfile),f=se(L.ShowUsersGroupProfile),{comments:v,addComment:g,editComment:y,removeComment:w,fetchInitialComments:R,fetchPreviousComments:S}=fr(),T=n.useTemplateRef("stcMainEl"),b=n.useTemplateRef("commentInputCtnEl"),_=n.ref(""),N=n.ref(0),j=n.ref(!1),Y=n.ref(0),M=n.computed(()=>({...s.atInit,hideCommentInput:s.atInit.hideCommentInput??!1,hideCommentsList:s.atInit.hideCommentsList??!1,focusCommentInput:s.atInit.focusCommentInput??!1,nbCommentsToLoad:s.atInit.nbCommentsToLoad??2})),Q=n.useTemplateRef("commentInputCmp"),k=n.ref(),x=n.computed(()=>!zn.value||zn.value&&Ua.value),J=n.ref(!1),B=n.computed(()=>x.value&&!J.value),ye=n.ref(!!M.value.hideCommentInput),Ie=n.ref(!!M.value.hideCommentsList),Mt=n.computed(()=>!s.hideActionsToolbar),nt=n.computed(()=>d.value&&!s.hideSeparator),Ee=n.computed(()=>d.value&&!Ie.value&&mn.value<io.value),Se=n.computed(()=>d.value&&!Ie.value&&!!mn.value),Ue=n.computed(()=>d.value&&!ye.value&&l.value),we=n.ref(!0),ot=n.ref(!1);async function A(){if(J.value)return;const[C,z]=await At({fn:()=>{const fe=Q.value,Kt=b.value;if(!fe||!Kt)throw new U("Empty comment input cmp");return[fe,Kt]}});await C.setFocus(),Wt({el:z})}async function H(C=tp){we.value=!0;try{await S({limit:C})}catch{}we.value=!1}async function be({richMessage:C,mentionedUsers:z}){const fe=await g({richMessage:C});a("addComment",{subjectUri:s.subjectUri,comment:n.toRaw(fe),mentionedUsers:z,isReply:!1}),r({category:"Subject",label:"addComment",event:"click"})}async function Ne(C){try{const z=await y(C);a("editComment",{subjectUri:s.subjectUri,comment:n.toRaw(z),mentionedUsers:C.mentionedUsers,isReply:!1}),r({category:"Comment",label:"edit",event:"click",pd:{commentUri:z.commentUri,commentKind:"comment"}})}catch{}}async function dt(C){await w({comment:C})&&(a("removeComment",{subjectUri:s.subjectUri,comment:n.toRaw(C),isReply:!1}),r({category:"Comment",label:"remove",event:"click",pd:{commentUri:C.commentUri,commentKind:"comment"}}))}let ee,_e=!1;const ge=n.ref(j.value?"likeSaved":"unlikeSaved");function Me(C){const fe=C.currentUserEndorse?"like":"unlike";a("toggleLikeComment",{subjectUri:s.subjectUri,comment:n.toRaw(C),isReply:!1,action:fe}),r({category:"Comment",label:fe,event:"click",pd:{commentUri:C.commentUri,commentKind:"comment"}})}function Tt(C){const fe=C.currentUserEndorse?"like":"unlike";a("toggleLikeComment",{subjectUri:s.subjectUri,comment:n.toRaw(C),isReply:!0,action:fe})}const Ht=Ao(async()=>{if(ee){_e=!0;return}j.value&&!k.value?ee=uo():!j.value&&k.value&&(ee=fn()),ee==null||ee.then(()=>{ee=void 0,_e&&(_e=!1,Ht())})},200);async function Pt(){j.value?(Y.value-=1,j.value=!1):(Y.value+=1,j.value=!0),Ht()}async function uo(){if(ee&&await ee,!k.value)try{ge.value="likeSaving";const C=(await Tu({subjectUri:s.subjectUri})).result;k.value=C.endorseUri,ge.value="likeSaved",a("toggleLikeSubject",{subjectUri:s.subjectUri,action:"like"}),r({category:"Subject",label:"like",event:"click"})}catch{Y.value-=1,j.value=!1}}async function fn(){if(ee&&await ee,!!k.value)try{ge.value="unlikeSaving",await Pu({subjectUri:s.subjectUri,endorseUri:k.value}),k.value=void 0,ge.value="unlikeSaved",a("toggleLikeSubject",{subjectUri:s.subjectUri,action:"unlike"}),r({category:"Subject",label:"unlike",event:"click"})}catch{Y.value+=1,j.value=!0}}function pn(){Pt(),a("clickOnLikeBtn",{subjectUri:s.subjectUri})}function zt(){Ie.value=!1,ye.value=!1,A(),a("clickOnCommentBtn",{subjectUri:s.subjectUri})}function mt(C){a("clickOnExtraActionBtn",{subjectUri:s.subjectUri,btn:n.toRaw(C)})}function hn(){a("clickOnShareBtn",{subjectUri:s.subjectUri})}async function vn(C){await H(),r({category:"CommentsList",label:C.label,event:"click"})}async function ft(C){if(!p.value)return;const z="X3DPRFL_AP";try{(await ue("DS/TransientWidget/TransientWidget")).showWidget(z,"",{login:C,url:await on(Z.SWYM)})}catch(fe){P.error(fe)}}const It=n.ref(!1),D={usersGroupId:""};async function F(C){f.value&&(D.usersGroupId=C,It.value=!0)}async function me({userLogin:C,usersGroupId:z}){a("clickOnUser",{subjectUri:s.subjectUri,userLogin:C,usersGroupId:z}),C?ft(C):z&&F(z)}function pt({reply:C,mentionedUsers:z}){a("addComment",{subjectUri:s.subjectUri,comment:n.toRaw(C),mentionedUsers:z,isReply:!0})}function ht({reply:C,mentionedUsers:z}){a("editComment",{subjectUri:s.subjectUri,comment:n.toRaw(C),mentionedUsers:z,isReply:!0})}function re(C){a("removeComment",{subjectUri:s.subjectUri,comment:n.toRaw(C),isReply:!0})}function Nt(C){a("clickOnMedia",n.toRaw(C))}const{canStart:ps,startPromise:yn,isRunning:hs}=Gf({commentToHighlight:n.computed(()=>s.commentToScrollTo)});async function mo(){var C;J.value=!1,we.value=!0;try{const z=await R({limit:M.value.nbCommentsToLoad});Y.value=z.nbEndorses,k.value=(C=z.currentUserEndorse)==null?void 0:C.endorseUri,j.value=!!k.value,ge.value=j.value?"likeSaved":"unlikeSaved"}catch{J.value=!0,we.value=!1;return}we.value=!1,ot.value=!0,a("loadInitialComments",{subjectUri:s.subjectUri})}function vs({isShown:C}){b.value&&Wt({el:b.value,waitTime:C?void 0:hr})}async function h({props:C}){function z(){zl(C.subjectUri),Kl(C.appId)}async function fe(){var fo,po;ic(C.platformId),ac(C.appForcedLinkUri);const st=C.urls;st.registry?sa(st.registry):await aa(),sc(st.service),iu((fo=st.serviceCSRF)==null?void 0:fo.name,(po=st.serviceCSRF)==null?void 0:po.token),st.customHeaders&&rc(st.customHeaders)}function Kt(){Eu(C.lang),Ma(!!C.hasGuestAccess),_u({user:{...C.currentUser},isGuest:C.isCurrentUserGuest})}z(),await fe(),Kt()}async function E(){await mo(),ps.value=!0,s.commentToScrollTo?await yn.value:M.value.focusCommentInput&&!M.value.hideCommentInput&&await A()}n.watch(()=>s.subjectUri,async(C,z)=>{C!==z&&(await h({props:s}),await mo())}),n.watch(()=>s.disableFeatures,()=>ba(s.disableFeatures)),Ai(()=>T.value,C=>{if(!C)throw new U("Empty stcMainEl");_.value=getComputedStyle(C).getPropertyValue("font-size")}),n.onBeforeMount(async()=>{P.debug("version",Kf),P.debug("props",s),await h({props:s}),ba(s.disableFeatures),Xf()}),n.onMounted(E),n.onUnmounted(()=>{Jf(),lr()});const I=n.ref();function X(C){I.value=C||void 0}function q(C){if(r({category:"ExposedFunction",label:"setActiveCommentInputContent",event:"use"}),I.value||X(Q.value),!I.value)throw new U("No active comment input found");I.value.setMessage(C)}const te={onClickMedia:Nt,onClickUser:me,setActiveCommentInput:X,stcFontSize:_,stcMainElRef:T};return n.provide(We,te),t({setActiveCommentInputContent:q}),(C,z)=>{const fe=n.resolveComponent("vu-message"),Kt=n.resolveComponent("vu-spinner"),st=n.resolveComponent("vu-btn"),fo=n.resolveComponent("vu-message-container"),po=n.resolveComponent("vu-modal-container"),op=n.resolveDirective("mask");return n.openBlock(),n.createElementBlock(n.Fragment,null,[B.value?n.withDirectives((n.openBlock(),n.createElementBlock("div",n.mergeProps({key:0},C.$attrs,{key:C.subjectUri,ref:"stcMainEl",class:["stc_stc-main",{"stc_no-separator":!nt.value,"stc_is-first-fetch-comments-done":ot.value,"stc_is-loading":we.value}]}),[n.unref(Ua)?(n.openBlock(),n.createBlock(fe,{key:0,animate:!1,class:"stc_social-toolbar_has-guest-access-msg",closable:!1,color:"primary",show:!0,target:n.unref(Ce),text:n.unref(i)("guestHasAccessMsg"),timeout:0},null,8,["target","text"])):n.createCommentVNode("",!0),Mt.value?(n.openBlock(),n.createBlock(xa,{key:1,"align-center":C.alignCenterActionsToolbar,class:"stc_social-toolbar_actions-toolbar","data-saving-toggle-like":ge.value,depth:N.value,"disable-comment":!n.unref(d),"disable-like":!n.unref(u),"disable-share":!n.unref(m),"extra-btns":s.extraActionsBtns,"hide-labels":s.hideActionsToolbarLabels,"is-liked":j.value,"nb-comments":n.unref(io),"nb-likes":Y.value,"tracker-opts":{category:"Subject"},onClickOnCommentBtn:zt,onClickOnExtraBtn:mt,onClickOnLikeBtn:pn,onClickOnShareBtn:hn},null,8,["align-center","data-saving-toggle-like","depth","disable-comment","disable-like","disable-share","extra-btns","hide-labels","is-liked","nb-comments","nb-likes"])):n.createCommentVNode("",!0),nt.value?(n.openBlock(),n.createElementBlock("div",Qf)):n.createCommentVNode("",!0),Ee.value?(n.openBlock(),n.createElementBlock("div",Zf,[we.value?(n.openBlock(),n.createElementBlock("div",qf,[n.createVNode(Kt)])):(n.openBlock(),n.createElementBlock(n.Fragment,{key:1},[n.unref(mn)<n.unref(io)?(n.openBlock(),n.createBlock(st,{key:0,class:"stc_social-toolbar_load-previous-btn",color:"link",onClick:z[0]||(z[0]=at=>vn({label:n.unref(mn)?"showPreviousComments":"showComments"}))},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(n.unref(mn)?n.unref(i)("showPreviousCommentsBtn"):n.unref(i)("showCommentsBtn")),1)]),_:1})):n.createCommentVNode("",!0)],64))])):n.createCommentVNode("",!0),Se.value?(n.openBlock(),n.createElementBlock("div",$f,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(n.unref(v),at=>(n.openBlock(),n.createBlock(Wf,{key:at.commentUri,class:"stc_comment-item",comment:at,"data-id":at.commentUri,depth:0,onAddReply:pt,onClickOnAuthor:me,onEditReply:ht,onRemoveComment:ys=>dt(at),onRemoveReply:re,onSubmitEditComment:ys=>Ne({...ys,comment:at}),onToggleLikeComment:ys=>Me(at),onToggleLikeReply:Tt},null,8,["comment","data-id","onRemoveComment","onSubmitEditComment","onToggleLikeComment"]))),128))])):n.createCommentVNode("",!0),Ue.value?(n.openBlock(),n.createElementBlock("div",ep,[n.createVNode(rs,{ref:"commentInputCmp",class:"stc_social-toolbar_comment-input",placeholder:n.unref(i)("writeACommentInputPlaceholder"),"storage-key":"newComment","tracker-opts":{commentKind:"comment"},onFocus:z[1]||(z[1]=at=>X(Q.value)),onSubmit:be,onToggleToolbar:vs},null,8,["placeholder"])],512)):n.createCommentVNode("",!0),It.value?(n.openBlock(),n.createBlock(Rm,{key:6,"users-group-id":D.usersGroupId,onClose:z[2]||(z[2]=at=>It.value=!1)},null,8,["users-group-id"])):n.createCommentVNode("",!0)],16)),[[op,n.unref(hs)]]):n.createCommentVNode("",!0),J.value&&x.value?(n.openBlock(),n.createBlock(fe,{key:1,animate:!1,class:"stc_social-toolbar_service-not-available-msg",closable:!1,color:"primary",show:!0,target:n.unref(Ce),text:n.unref(i)("commentServiceNotAvailableMsg"),timeout:0},null,8,["target","text"])):n.createCommentVNode("",!0),B.value?(n.openBlock(),n.createBlock(fo,{key:2,class:"stc_social-toolbar_msg-ctn",namespace:n.unref(Ce)},null,8,["namespace"])):n.createCommentVNode("",!0),(n.openBlock(),n.createBlock(n.Teleport,{to:"body"},[n.createVNode(po)]))],64)}}}),[["__scopeId","data-v-aba7fd07"]]);O.AppFeaturePreference=Xs,O.CommonRequest=De,O.DATA_CONTENT_TYPE_KEY=Oe,O.DATA_LOGIN_KEY=et,O.DATA_TYPE_KEY=Ge,O.DATA_USERS_GROUP_URI_KEY=tt,O.Preferences=Ae,O.STCError=U,O.STC_CK_MENTIONS_ITEM_CLASS=Va,O.SocialToolbar=np,O.TOGGLE_TOOLBAR_TRANSITION_TIME=hr,O.USER_MENTION_CLASSES=ln,O.USER_MENTION_MARKER=$e,O.UserType=le,O._export_sfc=pe,O.checkIsIphoneOrIpadDevice=Po,O.ckeditorDowncast=ud,O.ckeditorUpcast=dd,O.commonjsGlobal=Uc,O.customUserMentionRenderer=ld,O.get3DXContentFromDataTransfer=ym,O.getAugmentedNamespace=Mc,O.getDefaultExportFromCjs=ua,O.getUserDisplayName=rn,O.lang=Cu,O.normalizeUserMentionId=Zn,O.requirejsOne=ue,O.searchMentionedUsers=cd,O.toRef=Gs,O.tryUntilSuccess=At,O.useCounter=Ci,O.useThrottleFn=_i,O.useToggle=Si,O.useTranslations=ae});
//# sourceMappingURL=social-toolbar-vue-CBs5yOgI.js.map
