define("DS/VisualizationUI/CSIViewer",["DS/Visualization/WebGLV6Viewer","DS/Visualization/ViewManager","DS/SceneGraphOverrides/CSIOverrideManager","DS/Visualization/ThreeJS_DS","DS/Visualization/Filters/ZModeFilter"],(function(e,i,t,s,n){"use strict";var a=e.extend({init:function(e){return localStorage.setItem("__WEBVISU_PDSFX_UV_CHECK__",!1),e=e||{},window.newMaterialInheritance=!0,e.GASFaceMaterialsAsPBR=!0,e.visuFaceMaterialsAsPBR=!0,this._parent(e),this.viewManager=new i(this),this._csiViewModelManager=e&&e.CSIViewModelManager?e.CSIViewModelManager:null,this._csiOverrideManager=new t(this),this._scissorOutlineNodes=null,this._onMissingStaticLookCB=null,this._perfoStartToken=null,this._perfoEndToken=null,this},setCSIViewModelManager:function(e){this._csiViewModelManager=e},setOnMissingStaticLookCB:function(e){this._onMissingStaticLookCB=e},swapVisibleSpace:function(){if(e.prototype.swapVisibleSpace.call(this),!this.visibleSpace&&this._csiViewModelManager){var i=this;this._csiViewModelManager.forceSend3DNoShowData({onAnswer:function(){i.render()}})}},forceZDisplay:function(e){e&&!this.renderer.renderer._GlobalZModeFilter?(this.renderer.renderer._GlobalZModeFilter=new n(!0),this.renderer.resetGSSOCache()):!e&&this.renderer.renderer._GlobalZModeFilter&&(this.renderer.renderer._GlobalZModeFilter=null,this.renderer.resetGSSOCache())},onVisuAnswer:function(e){return this.viewManager.onVisuAnswer(e)},setStaticMaterial:function(e,i){console.warn("setStaticMaterial method is deprecated. Use setStaticLook instead."),this.viewManager.setStaticMaterial(e,i)},setStaticLook:function(e,i){this.viewManager.setStaticLook(e,i)},setDefaultMaterials:function(e){this.viewManager.setDefaultMaterials(e)},setAlternativeEditDisplay:function(e){this.viewManager.setTemporaryBodies(e)},empty:function(e,i){this._parent(e,i),this.viewManager.clear()},updatePlaneOnViewMessage:function(e){this.viewManager.updatePlaneOnViewMessage(e)},_getCSIOverrideManager:function(){return this._csiOverrideManager},getVisuContextViewMode:function(){var e=this.getVisuShadingMode();if(!e||!s.__ViewModeType__||!s.__ViewAppearanceMap__)return null;for(var i=this.getCustomMaterialModeParameters(),t={mask:s.__ViewModeType__.VIEW_APPEARANCE,appearanceName:null,shininess:i.shininess,opacity:i.opacity,color:i.color.toArray(),useObjectColor:i.colorFromGAS},n=this.renderer.renderer._defaultAppearanceType,a=Object.keys(s.__ViewAppearanceMap__),r=0;r<a.length;r++)if(s.__ViewAppearanceMap__[a[r]]===n){t.appearanceName=a[r];break}return t.appearanceName?(e.includes("Wireframe")?t.mask|=s.__ViewModeType__.VIEW_EDGE:e.includes("Illustration")?t.mask|=s.__ViewModeType__.VIEW_HRD:(t.mask|=s.__ViewModeType__.VIEW_MESH,this.getMaterialMode()&&(t.mask|=s.__ViewModeType__.VIEW_MATERIAL),e.includes("Edges")&&(t.mask|=s.__ViewModeType__.VIEW_EDGE,e.includes("NoSmoothEdges")?t.mask|=s.__ViewModeType__.VIEW_WITHOUT_SMOOTH_EDGE:e.includes("HalfSmoothEdges")&&(t.mask|=s.__ViewModeType__.VIEW_WITH_HALF_SMOOTH_EDGE),e.includes("HiddenEdges")&&(t.mask|=s.__ViewModeType__.VIEW_HIDDEN_EDGE))),this.getAxisFilter()||(t.mask|=s.__ViewModeType__.VIEW_WITHOUT_AXIS),this.getPointsFilter()||(t.mask|=s.__ViewModeType__.VIEW_WITHOUT_POINTS),this.getLinesFilter()||(t.mask|=s.__ViewModeType__.VIEW_WITHOUT_WIRES),this.getVerticesFilter()||(t.mask|=s.__ViewModeType__.VIEW_WITHOUT_VERTEX),this._getVisuOutlineMode()&&(t.mask|=s.__ViewModeType__.VIEW_OUTLINE),this.getSmallCurvatureEdgesFilter()||(t.mask|=s.__ViewModeType__.VIEW_WITHOUT_SMALL_CURVATURE_STEP_EDGE),t):null},onVisuContextViewModeModified:function(e){if(e){var i=[];return i.push(this.onAxisFilterChange(e)),i.push(this.onPlanesFilterChange(e)),i.push(this.onLinesFilterChange(e)),i.push(this.onPointsFilterChange(e)),i.push(this.onVerticesFilterChange(e)),i.push(this.onVisuAppearanceModeChange(e)),i.push(this.onCustomMaterialModeParametersChange(e)),i.push(this._onVisuOutlineModeChange(e)),i.push(this.onVisuShadingModeChange(e)),i}},_refreshPLMViewMode:function(e){return this._csiOverrideManager.refreshPLMViewMode(e)},_updatePLMViewMode:function(e,i){return this._csiOverrideManager.updatePLMViewMode(e,i)},_setViewpointPLMViewMode:function(e,i){this._csiOverrideManager.setViewpointPLMViewMode(e,i)},_setNodePLMViewMode:function(e,i,t){this._csiOverrideManager.setNodePLMViewMode(e,i,t)},_setOutlineNode:function(e,i,t){if(i||this._scissorOutlineNodes){this._scissorOutlineNodes||(this._scissorOutlineNodes=new WeakMap);var s=this._scissorOutlineNodes.get(e);s&&e.removeChild(s),i?(t&&e.addChild(t),this._scissorOutlineNodes.set(e,t)):this._scissorOutlineNodes.delete(e)}},dispose:function(){this.viewManager.dispose(),this.unsubscribe(this._perfoStartToken),this._perfoStartToken=null,this.unsubscribe(this._perfoEndToken),this._perfoEndToken=null,this._parent()}});return UWA.namespace("THREEDS/CSIViewer",a)}));