define("DS/ENO3DUtils/utils/ENO3DLandingPage",["DS/PADServices/views/LandingPage","DS/PADUtils/PADSettingsMgt"],(function(e,t){"use strict";function i(t){e.call(this,t),this._ec=t.executionContext}return i.prototype=Object.create(e.prototype),i.prototype._buildDOM=function(){e.prototype._buildDOM.call(this)},i.prototype.setViewer=function(i,n){!0===t.getSetting("eno3dview_dom_viewer_outside_immersiveframe")&&e.prototype.setViewer.call(this,i,n),this.initDiv?this.initDiv.viewer=!0:this.initDiv={viewer:!0},t.getSetting("eno3dview_dom_viewer_outside_immersiveframe")||e.prototype.setViewer.call(this,i,n)},i})),define("DS/ENO3DUtils/ENO3DBaseComponent",["DS/WAfrUIStandardComponents/UIFrame"],(function(e){"use strict";function t(e={}){this._DEBUG="true"===e.DEBUG,this._eventTokens=[],this._isComponentInitialized=!1}return t.prototype.destroyParent=function(){return new Promise((e=>{for(let e=this._eventTokens.length-1;e>=0;--e)this.unsubscribe(this._eventTokens[e]);delete this._DEBUG,delete this._eventTokens,delete this._isComponentInitialized,e()}))},t.prototype.getComponentFromIdentifier=function(e){try{return this.getExecutionContext().getComponent(e)}catch(e){return null}},t.prototype.getModelEvent=function(){return this.getComponentFromIdentifier(WAfrStandardComponentKey.ModelEvents)},t.prototype.getWafrUIFrame=function(){return this.getComponentFromIdentifier(e.DEFAULT_COMPONENT_NAME)},t.prototype.getWafrUIComponent=function(){return this.getComponentFromIdentifier(WAfrStandardComponentKey.UIComponent)},t.prototype.getCommandHandler=function(){return this.getComponentFromIdentifier(WAfrStandardComponentKey.HandlerComponent)},t.prototype.subscribe=function(e,t,i=!1){const n=this.getModelEvent().subscribe(e,t);return!0===i&&this._eventTokens.push(n),n},t.prototype.unsubscribe=function(e){const t=this.getModelEvent();t&&t.unsubscribe(e),this._eventTokens.filter(((t,i,n)=>t===e&&(n.splice(i,1),!0)))},t.prototype.publish=function(e){this.getModelEvent().publish(e)},t.prototype.loadText=function(e){return new Promise(((t,i)=>{this.loadSource(`text!${e}`).then(t).catch(i)}))},t.prototype.loadJSON=function(e){return new Promise(((t,i)=>{this.loadSource(`text!${e}`).then((e=>t(JSON.parse(e)))).catch(i)}))},t.prototype.loadNls=function(e){return new Promise(((t,i)=>{this.loadSource(`i18n!${e}`).then(t).catch(i)}))},t.prototype.loadSource=function(e){return new Promise(((t,i)=>{require([e],t,i)}))},t.prototype.enableCmd=function(e){if(!0!==this.getExecutionContext().getComponent(WAfrStandardComponentKey.HandlerComponent).hasHandler(e))return console.log(`Handler ID ${e} is not defined in app WebAFR definition file.`),Promise.resolve();try{return this.getCommandHandler().enableHandler(e)}catch(e){return Promise.reject(e)}},t.prototype.disableCmd=function(e){if(!0!==this.getExecutionContext().getComponent(WAfrStandardComponentKey.HandlerComponent).hasHandler(e))return console.log(`Handler ID ${e} is not defined in app WebAFR definition file.`),Promise.resolve();try{return this.getCommandHandler().disableHandler(e)}catch(e){return Promise.reject(e)}},t.prototype.enableCheck=function(e){if(!0!==this.getExecutionContext().getComponent(WAfrStandardComponentKey.HandlerComponent).hasCheckHandler(e))return console.log(`Check Handler ID ${e} is not defined in app WebAFR definition file.`),Promise.resolve();try{return this.getCommandHandler().enableCheck(e)}catch(e){return Promise.reject(e)}},t.prototype.disableCheck=function(e){if(!0!==this.getExecutionContext().getComponent(WAfrStandardComponentKey.HandlerComponent).hasCheckHandler(e))return console.log(`Check Handler ID ${e} is not defined in app WebAFR definition file.`),Promise.resolve();try{return this.getCommandHandler().disableCheck(e)}catch(e){return Promise.reject(e)}},t.prototype._executeCommand=function(e){return!0===this.getExecutionContext().getComponent(WAfrStandardComponentKey.HandlerComponent).hasHandler(e.handlerId)?this.getCommandHandler().executeHandler({id:e.handlerId,args:e.args}).then((t=>{t.getReturnValue&&"SUCCEEDED"!==t.getReturnValue().internalValue&&console.warn(t.getError(),t.getDescription(),t.getReturnValue(),e)})).catch((e=>Promise.reject(e))):(console.log(`Handler ID ${e.handlerId} is not defined in app WebAFR definition file.`),Promise.resolve())},t.prototype._setCheckState=function(e){return!0===this.getExecutionContext().getComponent(WAfrStandardComponentKey.HandlerComponent).hasCheckHandler(e.checkId)?!0===this.getCommandHandler().isCheckExecutable(e.checkId)?this.getCommandHandler().setCheckState({id:e.checkId,state:e.state}):Promise.resolve():(console.log(`Check Handler ID ${e.checkId} is not defined in app WebAFR definition file.`),Promise.resolve())},t})),define("DS/ENO3DUtils/mixins/ENO3DWidgetEventManager",["DS/PADUtils/PADSettingsMgt"],(function(e){"use strict";function t(){}return t.prototype._initWidgetEvents=function(){return this._DEBUG&&console.log("ENO3DWidgetEventManager._initWidgetEvents called"),new Promise(((t,i)=>{this.getModelEvent()?(widget.addEvent("onRefresh",this._onRefresh.bind(this)),widget.addEvent("onSearch",this._onSearch.bind(this)),widget.addEvent("endEdit",e.updateWidgetPreferences.bind(e)),widget.addEvent("endEdit",this._onEndEdit.bind(this)),widget.addEvent("onViewChange",this._onViewChanged.bind(this)),widget.addEvent("onResize",this._onWidgetResized.bind(this)),t()):i("Empty or undefined model events")}))},t.prototype._subscribeModelEvents=function(){return this._DEBUG&&console.log("ENO3DWidgetEventManager._subscribeModelEvents called"),new Promise(((e,t)=>{this.getModelEvent()?(this.subscribe({event:"onRootAdded"},this._onRootAdded.bind(this)),this.subscribe({event:"onEndRootRemoved"},this._onEndRootRemoved.bind(this)),e()):t("Empty or undefined model events")}))},t.prototype._onRefresh=function(e){this._DEBUG&&console.log("ENO3DWidgetEventManager._onRefresh called");require(["DS/PADServices/utils/GlobalModelEvents","DS/Utilities/Utils","i18n!DS/ENOCockpitV2/assets/nls/ENOCockpitV2.json"],((t,i,n)=>{t.publish({event:"ENO3DView/BlockUX",data:n.refreshInProgress}),this.__debounceRefresh=this.__debounceRefresh?this.__debounceRefresh:i.debounce((()=>{this.getViewer().refresh(e),t.publish({event:"ENO3DView/UnblockUX"})}),1e3),this.__debounceRefresh()}))},t.prototype._onSearch=function(e){this._DEBUG&&console.log("ENO3DWidgetEventManager._onSearch called with",e),this.getViewer().search({searchQuery:e})},t.prototype._onEndEdit=function(t){this._DEBUG&&console.log("ENO3DWidgetEventManager._onEndEdit called with",t),this.loadSource("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext").then((i=>{if(t&&!1===t.submitted){let t="top-right";t=sessionStorage.getItem("changeControlPosition3DNavigation")?sessionStorage.getItem("changeControlPosition3DNavigation"):e.getSetting("changeControlPosition"),!1===widget.getBool("changeControlActivation")?i.hide():i.show()}})).catch((e=>{console.error(e)}))},t.prototype._onViewChanged=function(e){this._DEBUG&&console.log("ENO3DWidgetEventManager._onViewChanged called with",e),this.getExecutionContext().getComponent("Viewer").onViewChanged(e.type)},t.prototype._onWidgetResized=function(e){this._DEBUG&&console.log("ENO3DWidgetEventManager._onWidgetResized called with",e),this.publish({event:"onWidgetResize"})},t.prototype._onRootAdded=function(){this._DEBUG&&console.log("ENO3DWidgetEventManager._onRootAdded called"),this.updateTitle()},t.prototype._onEndRootRemoved=function(){this._DEBUG&&console.log("ENO3DWidgetEventManager._onEndRootRemoved called"),this.updateTitle()},t})),define("DS/ENO3DUtils/ENO3DContextMenuComponent",["DS/ENO3DUtils/ENO3DBaseComponent","DS/ENOPAD3DViewer/utils/PAD3DViewerModelServices","DS/WebappsUtils/WebappsUtils","DS/PADServices/utils/GlobalUtils","DS/PADServices/utils/SGIUtils","DS/Selection/CSOManager"],(function(e,t,i,n,o,s){"use strict";function r(t){e.call(this,t),this._identifiers={view:t.viewIdentifier},this._contextConfigPath=t.ctxOptions,this._nlsAMDPath=t.nlsAMDPath,this._contextConfig=[],this._nls=null,this._nlsAMDPromises=[],this._wafrContextContainer=null,this._isContextBarVisible=!1,this._view=null,this._widget=null}return r.prototype=Object.create(e.prototype),r.prototype.initialize=function(){return this._DEBUG&&console.log("ENO3DContextMenuComponent.initialize called"),new Promise(function(e,t){this._identifiers.view&&this._contextConfigPath||t("Invalid parameters sent from .wafrapp file"),!0===this._isComponentInitialized?e():(this._view=this.getComponentFromIdentifier(this._identifiers.view),this._widget=widget,this._loadConfigurationFromFile().then(this._loadContextNLS.bind(this)).then(this._updateCommandState.bind(this)).then(this._setWafrContextBar.bind(this)).then(this._contextReady.bind(this)).then(e).catch(function(e){this._DEBUG&&console.error("ENO3DContextMenuComponent.initialize failed to init"+e),this.destroy(),t(new Error(e))}.bind(this)))}.bind(this))},r.prototype.clean=function(){return this._DEBUG&&console.log("ENO3DContextMenuComponent.clean called"),new Promise((function(e){e()}))},r.prototype.destroy=function(){return this._DEBUG&&console.log("ENO3DContextMenuComponent.destroy called"),new Promise((function(e){e()}))},r.prototype._loadConfigurationFromFile=function(){this._DEBUG&&console.log("ENO3DContextMenuComponent._loadConfigurationFromFile called");const e=[];return new Promise(((t,i)=>{for(let t=0;t<this._contextConfigPath.length;++t)e.push(new Promise((e=>{this.loadText(this._contextConfigPath[t]).then((t=>{try{this._contextConfig.push(JSON.parse(t)),e()}catch(e){this._DEBUG&&console.error("ENO3DContextMenuComponent._loadConfigurationFromFile failed to load configuration"+e),i(e)}})).catch(i)})));Promise.all(e).then(t).catch(i)}))},r.prototype._loadContextNLS=function(){return new Promise(((e,t)=>{this.loadNls(this._nlsAMDPath).then((t=>{this._nls=t,e()})).catch(t)}))},r.prototype._updateCommandState=function(){this._view.getController()._isLargeDataSelected()?(this.disableCmd("ENO3DOpenAppCmd"),this.disableCmd("OpenWithCatiaAction"),this.disableCmd("OpenWithFinderAction"),this.disableCmd("OpenWithMarkupAction")):(this.enableCmd("ENO3DOpenAppCmd"),this.enableCmd("OpenWithCatiaAction"),this.enableCmd("OpenWithFinderAction"),this.enableCmd("OpenWithMarkupAction")),!0===o.supplementalModeActivated?this.disableCmd("ActionBar_Attributes"):this.enableCmd("ActionBar_Attributes");for(let e=0;e<this._contextConfig.length;++e)for(let t=0;t<this._contextConfig[e].ContextMenu.onEmptiness.length;++t){const i=this._contextConfig[e].ContextMenu.onEmptiness[t];if(i.submenu)for(let e=0;e<i.submenu.length;++e)i.submenu[e].state=void 0,i.submenu[e].handlerId===`Visu${this._view.getViewer().getVisuEnv()}Cmd`&&(i.submenu[e].state="selected")}return s.get().length>0&&this._view._areValidPaths(s.get())?this._view.getController()._isLargeDataSelected()?(this.disableCmd("ENO3DOpenAppCmd"),this.disableCmd("OpenWithCatiaAction"),this.disableCmd("OpenWithFinderAction"),this.disableCmd("OpenWithMarkupAction")):(this.enableCmd("ENO3DOpenAppCmd"),this.enableCmd("OpenWithCatiaAction"),this.enableCmd("OpenWithFinderAction"),this.enableCmd("OpenWithMarkupAction")):(this.disableCmd("ENO3DOpenAppCmd"),this.disableCmd("OpenWithCatiaAction"),this.disableCmd("OpenWithFinderAction"),this.disableCmd("OpenWithMarkupAction")),this._updateCommandsForGeometryQuality()},r.prototype._updateCommandsForGeometryQuality=function(){var e=s.get(),i=e.length,n=this._view._getAllLeavesForGeometryQuality(e,2);const o={optimized:void 0,high:void 0};if(this.enableCmd("OptimizedQualityCmd"),this.enableCmd("HighQualityCmd"),0===n.length)return o.optimized="disabled",o.high="disabled",this.disableCmd("OptimizedQualityCmd"),this.disableCmd("HighQualityCmd"),o;if(this._view._isGeometryQualityAvailable("optimized"))if(0===i)o.optimized=!0;else if(1===i){if(1===n.length)if(a=this._view.getController().getNode({id:n[0]})){var r=t.getLoadedStream(a,this._view);o.optimized="thumbnail"===r?"selected":void 0}else o.optimized=void 0,this.disableCmd("OptimizedQualityCmd");else o.optimized=void 0}else o.optimized=void 0;else o.optimized=void 0,this.disableCmd("OptimizedQualityCmd");if(this._view._isGeometryQualityAvailable("high"))if(0===i)o.high=!0;else if(1===i){var a;if(1===n.length)if(a=this._view.getController().getNode({id:n[0]})){r=t.getLoadedStream(a,this._view);o.high="cgr"===r?"selected":void 0}else this.disableCmd("HighQualityCmd"),o.high=void 0;else o.high=void 0}else o.high=void 0;else o.high=void 0,this.disableCmd("HighQualityCmd");return o},r.prototype._contextReady=function(){return this._DEBUG&&console.log("ENO3DContextMenuComponent._contextReady called"),new Promise((e=>{this.getExecutionContext().setContext("ContextReady",!0),this._isComponentInitialized=!0,e()}))},r.prototype._prepareContextMenu=function(e,t,o){this._DEBUG&&console.log("ENO3DContextMenuComponent._prepareContextMenu called");const r=this._updateCommandState();var a=[],l=[];if(!0===(0===t.length))l=e.ContextMenu.onEmptiness;else{if(!(s.get().length>0&&this._view._areValidPaths(s.get())))return[];l=e.ContextMenu.onGeometry}for(var d=0;d<l.length;++d){var p=l[d];let e=[];var h=!1;if(p.submenu){let t="ambience"===p.identifier;if(n.isCEFCtx()&&"openwith"===p.identifier)h=!0;else for(let n=0;n<p.submenu.length;++n)if("SeparatorItem"===p.submenu[n].type)e.push({type:p.submenu[n].type});else{let o=p.submenu[n].state;"quality"===p.identifier&&(o=this._view.getController().isAdaptativeLoadingGranted()?"OptimizedQualityCmd"===p.submenu[n].handlerId?r.optimized:r.high:"disabled"),e.push({type:p.submenu[n].type,title:this._nls[p.submenu[n].handlerId],handlerId:p.submenu[n].handlerId,icon:p.submenu[n].iconPath?i.getWebappsAssetUrl(p.submenu[n].module,p.submenu[n].iconPath):void 0,state:o,action:{this:this,callback:function(e,t,i){if("CheckItem"===e[t].type&&(e[t].state="selected"===e[t].state?void 0:"selected"),!0===i){for(let t=0;t<e.length;++t)e[t].state=void 0;e[t].state="selected"}-1!==e[t].handlerId.indexOf("Chk")?this._setCheckState({checkId:e[t].handlerId,state:!0}):this._executeCommand({handlerId:e[t].handlerId})}.bind(this,p.submenu,n,t)}})}}else n.isCEFCtx()||"OpenInCADWebInWinAction"!==p.handlerId||(h=!0);if(!h){const t={title:e.length>0?this._nls[p.identifier]:null,type:p.type,handlerId:e.length>0?null:p.handlerId,state:e.length>0?!0===this._view.getViewer().get360Mode()&&"ambience"===p.identifier?"disabled":null:p.state,action:e.length>0?null:{this:this,callback:function(e){e&&this._executeCommand({handlerId:e})}.bind(this,p.handlerId)}};e.length>0&&(t.submenu=e),a.push(t)}}return a},r.prototype._prepareContextBar=function(e,t,i){if(!0===(0===t.length))return[];if(1===s.get().length&&this._view._areValidPaths(s.get())){this._view.getController().getRoots();let t=!1;return 2===s.get()[0].pathElement.externalPath.length&&(t=!0),!0===t?{WAfrCtxBarRow1:{model:[e.ContextBar.WAfrCtxBarRow1.model[1]]}}:{WAfrCtxBarRow1:{model:[e.ContextBar.WAfrCtxBarRow1.model[0]]}}}return[]},r.prototype._setWafrContextBar=function(){return this._DEBUG&&console.log("ENO3DContextMenuComponent._setWafrContextBar called"),new Promise(((e,t)=>{var i=this.getWafrUIComponent();this._wafrContextContainer=i.getContextualUIComponentManager();for(let e=0;e<this._contextConfig.length;++e){const t={subscriberId:`ENO3DContextualBar-${e}`,merge:!0,onContextualMenuReady:function(e,t){return this._prepareContextMenu(e,this.getPickedPath(t),t)}.bind(this,this._contextConfig[e]),onContextualBarReady:function(e,t,i){return this._prepareContextBar(e,this.getPickedPath(i),i)}.bind(this,this._contextConfig[e])};this._wafrContextContainer.register(t)}e()}))},r.prototype.getPickedPath=function(e){return this._view.get3DViewer().pick({xPix:e.XmousePositionWithDevPxRatio,yPix:e.YmousePositionWithDevPxRatio},"mesh",!0).path},r.prototype.setContextBarVisibility=function(e){this._DEBUG&&console.log("ENO3DContextMenuComponent.setContextBarVisibility called");var t=this._wafrContextContainer.getContextualBar();!0===e?(this._isContextBarVisible=!0,t.show()):(this._isContextBarVisible=!1,t.hide())},r.prototype.canBeParallelized=function(){return!1},r})),define("DS/ENO3DUtils/ENO3DNavigateAppDefinitionComponent",["i18n!DS/ENO3DUtils/assets/nls/ENO3DUtils.json","DS/ENO3DUtils/ENO3DBaseComponent","DS/ENO3DUtils/mixins/ENO3DWidgetEventManager","DS/ENOXInterWdgCom/LinkManager","DS/PADUtils/PADSettingsMgt","DS/MePreferencesClientAPI/MePreferencesClientAPI","DS/PlatformAPI/PlatformAPI"],(function(e,t,i,n,o,s,r){"use strict";function a(e={}){t.call(this,e),this._appTitle=e.appTitle,this._appOptionsFiltePath=e.appConfigPath||"DS/ENOCockpitV2/assets/json/ENO3DViewerInfraOptions.json",this._identifiers={view:e.viewIdentifier},this._options=null,this._widgetProxy=null}return a.prototype=Object.create(t.prototype),a.prototype=Object.assign(a.prototype,i.prototype),a.prototype.initialize=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent.initialize called"),new Promise(((e,t)=>{if(!0===this._isComponentInitialized){const i=this.getExecutionContext().getSourceApp();-1!==["ENXDISC_AP","ENXDISC_RealAssets"].indexOf(i.getId())?e():(this._DEBUG&&console.error("ENO3DNavigateAppDefinitionComponent.initialize\n\tReusing the context of ENO3DNavigateAppDefinitionComponent is forbidden"),t("Reusing the context of ENO3DNavigateAppDefinitionComponent is forbidden"))}else this._initWidget().then(this._loadAppOptions.bind(this)).then(this._assignAppOptions.bind(this)).then(this._handleMePreferences.bind(this)).then(this._initWidgetEvents.bind(this)).then(this._subscribeModelEvents.bind(this)).then(this._initLinkManager.bind(this)).then(this._initSharedSettings.bind(this)).then(this._mergePreferences.bind(this)).then(this._widgetReady.bind(this)).then(e).catch((e=>{this._DEBUG&&console.error("ENO3DNavigateAppDefinitionComponent.initialize\n\tFatal error during initialization",e),t("Fatal error during initialization")}))}))},a.prototype.clean=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent.clean called"),new Promise((e=>e()))},a.prototype.destroy=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent.destroy called"),new Promise((e=>{delete this._appTitle,delete this._appOptions,delete this._identifiers,delete this._options,delete this._widgetProxy,this.destroyParent().then(e)}))},a.prototype.canBeParallelized=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent.canBeParallelized called"),!1},a.prototype._initWidget=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent._initWidget called"),new Promise(((e,t)=>{try{this._widgetProxy=this.getExecutionContext().getComponent("AFR_WidgetProxyComponent"),this._widgetProxy=this._widgetProxy||widget,this._widgetProxy.setTitleHeader&&this._widgetProxy.setTitleHeader({brand:this._widgetProxy.getValue("brand"),appTitle:this._appTitle,title:""}),e()}catch(e){t(e)}}))},a.prototype._loadAppOptions=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent._loadAppOptions called"),new Promise(((e,t)=>{this.loadJSON(this._appOptionsFiltePath).then(e).catch(t)}))},a.prototype._assignAppOptions=function(e){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent._assignAppOptions called with",e),new Promise((async(t,i)=>{try{if(this._options=e,this._widgetProxy.setValue("tenantAware",!0),null===o.app_context||void 0===o.app_context){await o.setApp(e,"eno3dviewerinfra",!1,!0),o.setSetting("enopad3dviewer_staticMappingSupportActivated",!0);let t="en";this._widgetProxy.getLanguage&&void 0!==this._widgetProxy.getLanguage()?t=this._widgetProxy.getLanguage():null===this._widgetProxy.lang&&void 0===this._widgetProxy.lang||(t=this._widgetProxy.lang),o.setSetting("lang",t)}t()}catch(e){i(e)}}))},a.prototype._handleMePreferences=function(t){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent._handleMePreferences called with",t),new Promise((async(t,i)=>{s.readPreferences([{Repository:"VisualizationRepository",PreferenceNames:["Gravity"]},{Repository:"FrameGeneral",PreferenceNames:["ProjectionType"]},{Repository:"ENO3DViewRepository",PreferenceNames:["DisplayLoadingBoxes","LoadingBoxesColor","3DSelectionLevel","DisplayWorkUnder","WorkUnderPosition","WelcomePageStartup","ReloadLastSession","RetrieveInstanceTags","DisplayRobot"]}]).then(function(i){if(i&&i.repositories&&i.repositories.length){if(i.repositories[0].preferences&&"VisualizationRepository"===i.repositories[1].name){const e="true"===i.repositories[0].preferences[0].value;widget.setValue("ENO3DView_initMePref_lockZ",e),i.repositories[0].preferences&&1!==i.repositories[0].preferences.length&&console.warn("EON3DView : MePreferencesClientAPI.readPreferences, VisualizationRepository didn't returned all 1 expected preferences")}if(i.repositories[1]&&"FrameGeneral"===i.repositories[1].name){const e="Parallel"===i.repositories[1].preferences[0].value?1:0;widget.setValue("ENO3DView_initMePref_projectionType",e),i.repositories[1].preferences&&1!==i.repositories[1].preferences.length&&console.warn("EON3DView : MePreferencesClientAPI.readPreferences, FrameGeneral didn't returned all 1 expected preferences")}i.repositories[2]&&"ENO3DViewRepository"===i.repositories[2].name&&(this._updateENO3DViewRepositorySettings(i.repositories[2].preferences),i.repositories[2].preferences&&9!==i.repositories[2].preferences.length&&console.warn("EON3DView : MePreferencesClientAPI.readPreferences, ENO3DViewRepository didn't returned all 9 expected preferences")),t()}else{console.warn("MePreference service returned value",i),this._setDefaultPreferenceValues();const n=this.getExecutionContext().getComponent("Viewer");n&&n.displayNotification({eventID:"warning",title:e.mePreferenceLoadingFailureTitle,subtitle:e.mePreferenceLoadingFailureSubtitle,msg:e.mePreferenceLoadingFailureDescritption}),t()}}.bind(this)).catch((i=>{console.warn("MePreference service error message",i);const n=this.getExecutionContext().getComponent("Viewer");this._setDefaultPreferenceValues(),n&&n.displayNotification({eventID:"warning",title:e.mePreferenceLoadingFailureTitle,subtitle:e.mePreferenceLoadingFailureSubtitle,msg:e.mePreferenceLoadingFailureDescritption}),t()})),r.subscribe("com.ds.mep:onPrefUpdate",function(e){if(3===e.length&&e[1].preferences){const t=JSON.parse(e[1].preferences);for(let e=0;e<t.repositories.length;++e)if("VisualizationRepository"===t.repositories[e].name||"FrameGeneral"===t.repositories[e].name){const i=t.repositories[e].preferences;for(let e=0;e<i.length;++e){if("Gravity"===i[e].name&&this.getViewer()&&this.getViewer().getViewer()&&this.getViewer().getViewer().currentViewpoint){const t="true"===i[e].value;this.getViewer().getViewer().currentViewpoint.control.lockZ=t}if("ProjectionType"===i[e].name){const t="Parallel"===i[e].value?1:0;this.getViewer().getViewer().currentViewpoint.setProjectionType(t)}}}else"ENO3DViewRepository"===t.repositories[e].name&&this._updateENO3DViewRepositorySettings(t.repositories[e].preferences)}}.bind(this))}))},a.prototype._updateENO3DViewRepositorySettings=function(e){for(let t=0;t<e.length;++t)switch(e[t].name){case"DisplayLoadingBoxes":o.setSetting("enopad3dviewer_displayCandidateQueue",e[t].value);break;case"LoadingBoxesColor":o.setSetting("enopad3dviewer_displayCandidateQueue_color",e[t].value);break;case"3DSelectionLevel":o.setSetting("enopad3dviewer_selectionFilter",e[t].value);break;case"DisplayWorkUnder":o.setSetting("changeControlActivation","string"==typeof e[t].value?"true"===e[t].value:e[t].value),widget.setValue("changeControlActivation","string"==typeof e[t].value?"true"===e[t].value:e[t].value);break;case"WorkUnderPosition":const i={LL:"bottom-left",LR:"bottom-right",UL:"top-left",UR:"top-right"};o.setSetting("changeControlPosition",i[e[t].value]),widget.setValue("changeControlPosition",e[t].value);break;case"WelcomePageStartup":o.setSetting("showWelcomePanel","string"==typeof e[t].value?"true"===e[t].value:e[t].value),widget.setValue("showWelcomePanel","string"==typeof e[t].value?"true"===e[t].value:e[t].value);break;case"ReloadLastSession":o.setSetting("autoreload","string"==typeof e[t].value?"true"===e[t].value:e[t].value),widget.setValue("autoreload","string"==typeof e[t].value?"true"===e[t].value:e[t].value);break;case"RetrieveInstanceTags":o.setSetting("synthesisModeOnInstance","string"==typeof e[t].value?"true"===e[t].value:e[t].value),widget.setValue("synthesisModeOnInstance","string"==typeof e[t].value?"true"===e[t].value:e[t].value);break;case"DisplayRobot":o.getLayout_options("frmWindow_opts").robotVisibility="string"==typeof e[t].value?"true"===e[t].value:e[t].value,this.publish({event:"toggleDisplayRobot",data:{active:"string"==typeof e[t].value?"true"===e[t].value:e[t].value}})}},a.prototype._setDefaultPreferenceValues=function(){o.setSetting("enopad3dviewer_displayCandidateQueue","ALWAYS"),o.setSetting("enopad3dviewer_displayCandidateQueue_color","GREY"),o.setSetting("enopad3dviewer_selectionFilter","PRODUCT"),o.setSetting("changeControlActivation",!0),o.setSetting("changeControlPosition","bottom-left"),o.setSetting("showWelcomePanel",!0),o.setSetting("autoreload",!1),o.setSetting("synthesisModeOnInstance",!0),o.getLayout_options("frmWindow_opts").robotVisibility=!0,widget.setValue("changeControlActivation",!0),widget.setValue("changeControlPosition","bottom-left"),widget.setValue("showWelcomePanel",!0),widget.setValue("autoreload",!1),widget.setValue("synthesisModeOnInstance",!0)},a.prototype._initLinkManager=function(e){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent._initLinkManager called with",e),new Promise(((t,i)=>{o.getSetting("widgetLink_options")?n.initializeWidgetLink(widget,o.getSetting("widgetLink_options")).then((()=>t(e))).catch(i):t()}))},a.prototype._initSharedSettings=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent._initSharedSettings called"),new Promise(((e,t)=>{this.loadSource("DS/PADUtils/PADSharedSettings").then((async t=>{await t.addAsyncSharedSettings(widget,["x3dPlatformId","pad_security_ctx","pgpFromServer","activateSGI","enopad3dviewer_flexibleAssemblySupportActivated"]),e()})).catch(t)}))},a.prototype._mergePreferences=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent._mergePreferences called"),new Promise((e=>{this._widgetProxy.mergePreferences&&(this._widgetProxy.mergePreferences(o.getWidgetPreferences()),o.updateWidgetPreferences()),e()}))},a.prototype._widgetReady=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent._widgetReady called"),new Promise((e=>{this.getExecutionContext().setContext("WidgetReady",!0),this._isComponentInitialized=!0,e()}))},a.prototype.updateTitle=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent.updateTitle called"),new Promise(((e,t)=>{this.getViewer().getContentName().then((t=>{this._widgetProxy.setTitle&&this._widgetProxy.setTitle(t.contentName),e()})).catch((e=>{this._widgetProxy.setTitle&&this._widgetProxy.setTitle(e.contentName),t()}))}))},a.prototype.getSessionWidget=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent.getSessionWidget called"),"undefined"!=typeof widget?widget:null},a.prototype.getWidgetDOM=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent.getWidgetDOM called"),this._widgetProxy.view.elements.container||widget.body.firstChild},a.prototype.getOptions=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent.getOptions called"),this._options},a.prototype.getViewer=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent.getViewer called"),this.getComponentFromIdentifier(this._identifiers.view)},a.prototype.getAppTitle=function(){return this._DEBUG&&console.log("ENO3DNavigateAppDefinitionComponent.getOptions called"),this._appTitle},a})),define("DS/ENO3DUtils/ENO3DLandingPageComponent",["DS/ENO3DUtils/ENO3DBaseComponent","DS/PADServices/utils/GlobalModelEvents"],(function(e,t){"use strict";function i(t){e.call(this,t),this._options=t,this._identifiers={widget:t.widgetIdentifier},this._landingPage=null}return i.prototype=Object.create(e.prototype),i.prototype.initialize=function(){return this._DEBUG&&console.log("ENO3DLandingPageComponent.initialize called"),new Promise(((e,t)=>{this._landingPageReady().then(e).catch((e=>{this._DEBUG&&console.error("ENO3DLandingPageComponent.initialize\n\tFatal error during initialization",e),t(e)}))}))},i.prototype.clean=function(){return this._DEBUG&&console.log("ENO3DLandingPageComponent.clean called"),new Promise((e=>{e()}))},i.prototype.destroy=function(){return this._DEBUG&&console.log("ENO3DLandingPageComponent.destroy called"),new Promise((e=>{this.destroyParent().then(e)}))},i.prototype._landingPageReady=function(){return this._DEBUG&&console.log("ENO3DLandingPageComponent._landingPageReady called"),new Promise((e=>{this.getExecutionContext().setContext("LandingPageReady",!0),this._isComponentInitialized=!0,e()}))},i.prototype.createLandingPage=function(){return this._DEBUG&&console.log("ENO3DLandingPageComponent.createLandingPage called"),new Promise(((e,t)=>{this._initLandingPage().then(e).catch((e=>{this._DEBUG&&console.error("ENO3DLandingPageComponent.createLandingPage\n\tFatal error during initialization",e),t(e)}))}))},i.prototype._initLandingPage=function(){return this._DEBUG&&console.log("ENO3DLandingPageComponent._initLandingPage called"),new Promise((e=>{require(["DS/ENO3DUtils/utils/ENO3DLandingPage",`i18n!${this._options.nlsAMDPath}`],((i,n)=>{this._landingPage=new i({executionContext:this.getExecutionContext(),widget:this.getWidget(),readOnlyApp:!0,appTitle:"3D Navigate",description:n.appDescription,renderDiv:document.querySelector(".wafr-uiframe.wux-afr-framewindow"),structKey:"xsceneStoredObjects",onLandingPageReady:()=>{("undefined"==typeof widget||widget.getValue("showWelcomePanel"))&&t.publish({event:"ENO3DView/UnblockUX"}),e()},onReady:()=>{this.getWidget().dispatchEvent("onENOPADReady")}}),this._landingPage.initialize()}))}))},i.prototype.getLandingPage=function(){return this._landingPage},i.prototype.canBeParallelized=function(){return!1},i.prototype.getWidget=function(){return this.getComponentFromIdentifier(this._identifiers.widget).getSessionWidget()},i}));