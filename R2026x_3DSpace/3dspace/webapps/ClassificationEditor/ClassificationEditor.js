function ClassificationEditor(e){"use strict";var t={leftPanelState:!0,isWelcomePanelCollapsed:!1},i={rightPanelState:!1,size:300},r={widget:null,filterFromWin:null,libraryContent_Cont:null,libraryContentController:null,libraryTree_div:null,libraryTreeDoc_div:null,libraryTree_Cont:null,libraryIdCard_div:null,libraryIdCard_Cont:null,core:null,widthToHideLeftPanel:300,_actionbar:null,libraryTree_W_NotLinked:!1,css_view_class:"windowed",_mouseEventsManager:{unlockMouseMove:!1,draggingXSlider:null,mouseStartXSlider:null,initialMouseStartXSlider:null,dragginDirection:null,cancelDragging:!1,spanPosition:null,widthLeftDiv:null,widthRightDiv:null,widthLeftDivSave:null,widthRightDivSave:null,widthGlobalDiv:null,newWidthGlobalDiv:null},init:function(e){var r=this;require(["DS/ClassificationEditor/utils/ClassificationEditorUtil"],(function(e){var r=e.getLeftPanelStatus(),a=e.getRightPanelStatus();Promise.all([r,a]).then((function(e){t=e[0],i=e[1]}))})),require(["DS/PADUtils/PADSettingsMgt"],(function(e){e.setSetting("columnParametrization",!0),e.setSetting("activateTXO",!0)})),require(["DS/IPClassifyUtil/IPClassifyUtility","DS/ClassificationEditor/dataProvider/LibraryContentDataProvider","DS/IPClassifyUX/utils/IPClassifyWidgetData"],(function(e,t,i){e.isCustomizedEnv(),e.initURLSAsync().then((function(){i.setIsEditModeEnabled(!1),t.hasLibrarianRole().then((function(e){e="string"==typeof e?JSON.parse(e):e,i.setReadOnly(e.readOnly),i.setPermission(e.permission),i.setIsPermissionRestrictionEnabled(e.isPermissionRestrictionEnabled)})).catch((e=>console.log(e.message))),r.migratePreferences()}))})),this.widget=e.widget,this.dataForActiveClassODT=e.dataForActiveClassODT,e.defaultSelectionPath&&(this.widget.defaultSelectionPathFromWin="root,LibrarySection_AllLibraries,"+e.defaultSelectionPath),require(["DS/ClassificationEditor/utils/ClassificationEditorcontrol"],(function(e){e.setWidgetRefresh(r.onRefresh.bind(r))})),require(["DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/ClassificationEditor/utils/ClassificationEditorUtil"],(function(e,t,i){t.setCurrentWidgetTab(i.getCurrentTab(),1!=i.CURRENT_TAB_VALUE),1==i.CURRENT_TAB_VALUE&&(e._currentLibrary={noTree:!0,getType:function(){return"Exception"}},e._currentLibraryPath=null)})),this.widget.removeEvent("onLoad"),this.widget.removeEvent("onRefresh"),this.widget.removeEvent("onDestroy"),this.widget.removeEvent("onResize"),this.widget.removeEvent("onEdit"),this.widget.removeEvent("endEdit"),this.widget.addEvent("onLoad",this.onLoad.bind(this)),this.widget.addEvent("onRefresh",this.onRefresh.bind(this)),this.widget.addEvent("onDestroy",this.onDestroy.bind(this)),this.widget.addEvent("onResize",this.onResize.bind(this)),this.widget.changeInPreference={};var a={},n={};this.widget.addEvent("onEdit",(function(){r.widget.preferences.forEach((function(e){"hidden"!==e.type&&(a[e.name]=r.widget.getValue(e.name))}))})),this.widget.addEvent("endEdit",(function(e){!(!e||!e.submitted&&!e.needRefresh)&&(r.widget.changeInPreference={},Object.keys(a).forEach((function(e){n[e]=r.widget.getValue(e),a[e]!==n[e]&&(r.widget.changeInPreference[e]=n[e])})))}))},doRefresh:function(e,t,i,r,a,n){var o=this,s=[];s.push(a.initURLSAsync()),o.widget.changeInPreference.x3dPlatformId&&(o.widget.changeInPreference={}),Promise.all(s).then((function(){var s=a.isIndexedMode();if(r.getContent().updateFilterBI(s),r.getContent().updateComputedColumns(),o.libraryContent_Cont.addEvent("onCompleteRefreshNodes",(function(e){this.removeEvent("onCompleteRefreshNodes"),t.displayNotification({message:i.msg_info_refresh,className:"primary"})})),n&&UWA.is(n.authored.deleted,"array")){var l=e.getCurrentLibrary();null!=l&&l.getID()===n.authored.deleted[0]&&l.getParent().select(!0)}r.getTreeCont().refreshLibraryTree(),r.getContent().refreshLibraryContent()}))},onRefresh:function(e){var t=this;e&&e.reInitialize?t._onReInit():require(["DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADContext","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/IPClassifyUtil/IPClassifyUtility","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUXUtil/IPClassifyConfirmation"],(function(i,r,a,n,o,s,l,d,c,u){c.getIsEditModeEnabled()?null==document.querySelector(".right-actions.fonticon.fonticon-cancel")&&u.launch({title:a.command_CancelUpdates,content:a.confirmation_cancel_attributesSure,confirmLabel:a.confirmation_ok},(function(){var u=n.get(),f=u.options.views?u.options.views.datagridview:void 0;if(f){f.options.dgv.prepareUpdateView();var p=f.options.dgvLayout.getLeafColumns();p&&Array.isArray(p)&&p.forEach((function(e){e.toggleToEdit&&!0===e.toggleToEdit&&(e.getCellEditableState=function(e){return!1},e.getCellTypeRepresentation=function(e){return"string"}),"AuthorizedValues"===e.dataIndex&&(e.getCellValue=function(e){if(e.nodeModel){let t=e.nodeModel.getAttributeValue("AuthorizedValues"),i=d.getOldNodeValues()[e.nodeModel.options.grid.Name];return i&&(t=i),{label:t,func:"",module:""}}})})),f.options.dgv.treeDocument.cancelChanges(),f.options.dgv.treeDocument.setUseChangeTransactionMode(!1),f.options.dgv.pushUpdateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0},!0),c.setIsEditModeEnabled(!1),d.emptyOldNodeValues(),d.emptyUpdatedNodes(),l.updateCommands()}t.doRefresh(i,r,a,o,s,e)})):t.doRefresh(i,r,a,o,s,e)}))},onDestroy:function(){},onResize:function(){var e=this;setTimeout((function(){e.libraryGlobal_div&&e.libraryIdCard_Cont&&0!==e.libraryGlobal_div.clientWidth&&e.libraryIdCard_Cont.updateDisplayPath()}),500)},migratePreferences:function(){return new Promise((function(e){require(["text!DS/ClassificationEditor/assets/classificationVersion.json","DS/ClassificationEditor/utils/ClassificationMigration","DS/IPClassifyUtil/IPClassifyPreference"],(function(t,i,r){let a=JSON.parse(t);var n=[];let o=new Promise((function(e){r.get("LibraryFavPrefVersion",(function(t){!t||!t.version||t.version<a.LibraryFavPrefVersion?i.migrateFavPreferences(null,a.LibraryFavPrefVersion).then((function(){e()})):e()}),!1)}));n.push(o);let s=new Promise((function(e){r.get("LibraryTreeStrcutPrefVersion",(function(t){!t||!t.version||t.version<a.LibraryTreeStrcuturePrefVersion?i.migrateTreeStructurePreferences(null,a.LibraryTreeStrcuturePrefVersion).then((function(){e()})):e()}))}));n.push(s),Promise.all(n).then((function(){e()}))}))}))},_onReInit:function(){delete r.libraryTree_Cont,r.libraryTree_Cont=null,delete r.libraryContent_Cont,r.libraryContent_Cont=null,delete r.libraryIdCard_Cont,r.libraryIdCard_Cont=null,r.widget.body.container=null,r.libraryTree_W_NotLinked=!1,r.init({widget:this.widget,reInitialize:!0})},onLoad:function(){this.probeHeader=this.widget.id+"_"+this.widget.getTitle()+"_",window.top.performance.mark("onLoad_begin"),window.top.performance.measure(this.probeHeader+"createToOnLoad","createWidget_begin","onLoad_begin");var e=this;require(["DS/PADUtils/Configuration","DS/IPClassifyUX/utils/IPClassifyWidgetData","text!DS/ClassificationEditor/assets/ClassificationEditorConf.json","DS/PADServices/utils/AttributesMgt","DS/ClassificationEditor/utils/ClassificationEditorUtil","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],(function(t,i,r,a,n,o){var s=JSON.parse(r),l=i.getWidgetData(),d="";l&&l.currentWidgetTab&&l.currentWidgetTab!==n.CONTENT_TABS.LIBRARIES?(s.settings.dgvOptions.value.dgv.showModelChangesFlag=!0,s.settings.dgvOptions.value.dgv.rowsHeader=!0,s.settings.dgvOptions.value.dgv.showColumnBorderFlag=!0,s.settings.dgvOptions.value.dgv.isAttributesTab=!0,d=s.columnsCusto.ATTRIBUTES,Array.isArray(d.attributes)&&d.attributes.forEach((function(e){let t=o[e.nls_key]?o[e.nls_key]:e.dataIndex;e.text=t;let i=e.children;i&&i.forEach((function(e){e.text=o[e.nls_key]?o[e.nls_key]:e.dataIndex}))}))):(s.settings.dgvOptions.value.dgv.defaultColumnDef.typeRepresentation="string",s.settings.dgvOptions.value.dgv.showModelChangesFlag=!1,s.settings.dgvOptions.value.dgv.showColumnBorderFlag=!1,s.settings.dgvOptions.value.dgv.rowsHeader=!1,s.settings.dgvOptions.value.dgv.isAttributesTab=!1,d=s.columnsCusto.LIBRARIES),t.mergeConfig(s),a.updateAttributesList(d),require(["UWA/Core","DS/PADUtils/PADContext","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADSharedSettings","DS/PADUtils/PADUtilsServices","DS/IPClassifyUX/LibraryContent","DS/ClassificationEditor/dataProvider/LibraryContentDataProvider","DS/IPClassifyUX/LibraryIdCardCont","DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider","DS/IPClassifyUX/LibraryTree","DS/ClassificationEditor/dataProvider/LibraryTreeDataProvider","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/dataProvider/LibraryCSODataProvider","DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/service/LibraryServices","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/UIKIT/Mask","DS/ClassificationEditor/utils/ClassificationEditorKeyboardListener","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassifyUtil/IPClassifyUtility","DS/PADUtils/PADProbes","DS/IPClassifyUXUtil/IPClassifyLoaderGlobal","DS/ClassificationEditor/utils/FilterUtils","DS/IPClassifyUX/IPClassifyUXEvents","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/WidgetServices/WidgetServices","DS/IPClassifyUXUtil/CredentialsView","text!DS/ClassificationEditor/assets/library_settings.json","DS/MessageBus/MessageBus","DS/ClassificationEditor/dataProvider/ClassificationTabBarProvider","DS/Windows/ImmersiveFrame"],(function(t,i,r,a,n,o,s,l,d,c,u,f,p,g,m,C,b,y,h,_,v,S,A,D,E,T,w,L,P,I,N,x,U,M){try{w.init()}catch(e){}var O=e;O.options={},O.addEvent=()=>{},O.checkOnCommand=!1,i.set(O),window.top.performance.mark("loadRequire_end"),window.top.performance.measure(e.probeHeader+"loadRequire","createWidget_begin","loadRequire_end"),widget.setValue("tenantAware",!0),a.addEventOnce("onNoSecurityContext",(function(e){if(!0!==e){_._isSecurityCTXInitialized=!1,widget.setBody(" ");var t=UWA.createElement("div",{text:C.get("authentication_error")});t.set("styles",{position:"absolute",top:"40%",bottom:"30%",left:"30%",right:"30%"}),t.inject(widget.body)}})),a.addEvent("onPad_security_ctx",(function(e){p.getCurrentLibrary()&&p.getCurrentLibrary()._options&&_.getContent()&&_.getContent().getView()&&_.getContent().getView().options&&_.getContent().getView().options.model&&_.getContent().getView().options.model.getModelEvents()&&_.getContent().getView().options.model.getModelEvents().publish({event:"titleRecalc",data:p.getCurrentLibrary()._options.label})})),widget.addPreference({name:"pad_security_ctx",type:"hidden"});var F=JSON.parse(x);if(a.setApp(F.padsettings,"enopad",!0),a.setSetting("activate_padprobes",!0),a.setSetting("add_objects_when_select",!1),E.initialize({padid:widget.id,padtitle:widget.getTitle()}),n.addSharedSettings(widget,["x3dPlatformId"]),widget.setValue("editProperties_readOnly",!1),widget&&widget.lang&&a.setSetting("lang",widget.lang),e.widget.addEvent("endEdit",a.updateWidgetPreferences.bind(a)),a.updateWidgetPreferences(),e.updateSecurityPreference(),P.addModeIntervalPreferences({refreshView:function(){require(["DS/ClassificationEditor/utils/ClassificationEditorcontrol"],(function(e){e.getTreeCont().refreshLibraryTree(),e.getContent().refreshLibraryContent()}))},updateTaggerAndComputeColumns:function(e){require(["DS/ClassificationEditor/utils/ClassificationEditorcontrol"],(function(t){t.getContent().updateFilterBI(e),t.getContent().updateComputedColumns()}))}}),e.widget.getValue("x3dSharedId")||e.widget.getValue("x3dAppId")||e.widget.addPreference({name:"x3dAppId",type:"hidden",defaultValue:"ENOPACX_AP"}),e.widget.getValue("x3dSharedId")||e.widget.addPreference({name:"x3dSharedId",type:"hidden",defaultValue:"ClassificationEditor_"+o.getWidgetId()}),N.render(),null===e.libraryTree_Cont||void 0===e.libraryTree_Cont){e.core=t,e.widget.body.empty(),e._buildSkeleton();e.widget.addEvent("endEdit",(function(){e.widget.getPreferences().forEach((function(t){var i="boolean"===t.type&&UWA.is(t.value,"string")?e.convertToBool(t.value):t.value;e.widget.setValue(t.name,i)}))})),e.libraryGlobal_div=e.widget.body.container,e.libraryTreeDoc_div=e.widget.body.right_side_div,e.libraryIdCard_div=e.widget.body.top_right_side_div,e.libraryContent_div=e.widget.body.bottom_right_side_div;var R=e._initializeClassificationEditorComponent.bind(e);if(T.setContainer("global",e.widget.body.globalLoaderContainer),null===e.libraryContent_Cont){var W={x3dAppId:e.widget.getValue("x3dAppId"),lang:e.widget.lang?e.widget.lang:e.widget.getValue("lang"),layout:{view_customization:null,css_view_class:e.css_view_class,store_roots_in_pref:!0,padshell:!0},authorize_setStructure:!0,settings:F};e.widget.getValue("LibraryCusto_treelistview_v1")?(W.layout.view_customization=JSON.parse(D.jsonUnzip(e.widget.getValue("LibraryCusto_treelistview_v1"))),R(W)):o.app_initialization((function(){require(["DS/IPClassifyUtil/service/IPClassifyUtilWebService"],(function(t){t.getUserPreferences({name:e.widget.getValue("x3dAppId")+"_Classification_v1",onComplete:function(e){var t=null;e&&e.length>0&&(t=JSON.parse(D.jsonUnzip(e))),W.layout.view_customization=t,R(W)},onFailure:function(e){R(W)}})}))})),e.getSelectedNodes=function(){return p.getSelectedNodes()},e.getCurrentLibrary=function(){var e=A.getCurrentSecurityContextAndLibraryData(!0);return JSON.stringify(e)},e.getSecurityContext=function(){return{SecurityContext:a.getSetting("pad_security_ctx"),tenant:widget.getValue("pad_tenant")}},e.beginBlockingTransaction=function(t){v.mask(e.libraryContent_div,t)},e.endBlockingTransaction=function(){v.unmask(e.libraryContent_div)},e.author=function(e){},e.displayNotification=function(e){h.displayNotification({title:e.title?e.title:null,subtitle:e.subtitle?e.subtitle:null,message:e.msg,className:e.eventID})},e.getPADTreeDocument=function(){return _.getContent().getView()?_.getContent().getView().getPADTreeDocument():null},e.toggleView=function(e){UWA.is(_.getContent().getView().toggleView(e))&&_.getContent().getView().toggleView(e)},e.getPADTreeListView=function(){return _.getContent().getView().getPADTreeListView()},e.getContent=function(){return _.getContent()}}}}))}))},_slidderMoveEndCallback:function(){this.libraryIdCard_Cont&&this.libraryIdCard_Cont.updateDisplayPath()},_buildSkeleton:function(){if(!this.core.is(this.widget.body.container)){var e=require("DS/Windows/ImmersiveFrame"),t=require("DS/WebUAUtils/WebUAUtils"),i=new UWA.Element("div",{class:"ClassificationEditor-widget-help",style:{"vertical-align":"top"}});if(i.inject(widget.body),this.widget.myImmersiveFrame){this.widget.bottom.destroy();var r=this.widget.myImmersiveFrame}else{r=new e;this.widget.myImmersiveFrame=r,t.setPanelHelpMode({immersiveFrame:this.widget.myImmersiveFrame})}try{t.closePanelHelp()}catch(e){console.log("UA Panel already closed")}r.inject(i),r.getFreeZone().replaceChildren(),this.widget.body.container=UWA.createElement("div",{class:"LibraryEditor_global_container"}).inject(r.getFreeZone(),"top"),this.widget.body.globalLoaderContainer=UWA.createElement("div",{class:"LibraryEditor_global_loader"}).inject(this.widget.body.container),this.widget.body.right_side_div=UWA.createElement("div",{class:"LibraryEditor_right_side_div"}).inject(this.widget.body.container),this.widget.body.top_right_side_div=UWA.createElement("div",{class:"LibraryEditor_top_right_side_div"}).inject(this.widget.body.right_side_div),this.widget.bottom=this.widget.body.bottom_right_side_div=UWA.createElement("div",{class:"LibraryEditor_bottom_right_side_div"}).inject(this.widget.body.right_side_div);var a=UWA.createElement("div",{class:"LibraryEditor_containerTools"}),n=this;require(["DS/PADServices/utils/GlobalModelEvents"],(function(e){e.getModelEvents().subscribe({event:"AddExistingAttributesCmd/Views/showInWidgetBody"},(function(e){e.html?(a.empty(),e.html.inject(a),a.inject(widget.body),e.keepOpacity||n.widget.body.right_side_div.setStyle("opacity",.5)):!0===e.restore&&(a.remove(),n.widget.body.right_side_div.setStyle("opacity",1))}))}))}},convertToBool:function(e){return"true"===e.toLowerCase()},_initializeClassificationEditorComponent:function(e){var r=this,a=require("DS/IPClassifyUX/LibraryTree"),n=require("DS/ClassificationEditor/dataProvider/LibraryTreeDataProvider"),o=require("DS/ClassificationEditor/utils/ClassificationEditorcontrol"),s=(require("DS/IPClassifyUX/LibraryIdCardCont"),require("DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider"),require("DS/IPClassifyUX/LibraryContent")),l=require("DS/ClassificationEditor/dataProvider/LibraryContentDataProvider"),d=require("DS/ClassificationEditor/utils/ClassificationEditorKeyboardListener"),c=require("DS/PADUtils/PADUtilsServices"),u=require("DS/ClassificationEditor/dataProvider/LibraryCSODataProvider"),f=require("DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider"),p=require("i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"),g=require("DS/ClassificationEditor/service/LibraryTypeService"),m=require("DS/ClassificationEditor/utils/ClassificationEditorUtil"),C=require("DS/PADServices/utils/GlobalModelEvents"),b=require("DS/ClassificationEditor/dataProvider/ClassificationTabBarProvider");require("DS/IPClassifyUX/utils/IPClassifyWidgetData");c.app_initialization((function(){c.getSecurityContext((function(y){if(y&&""!==y.securityContext&&y.securityContextList.length>0){if(0==m.CURRENT_TAB_VALUE)null===r.libraryTree_Cont&&c.app_initialization((function(){var d=new a({lang:r.widget.lang?r.widget.lang:r.widget.getValue("lang"),css_view_class:r.css_view_class,dataProvider:n,CSOProvider:u,DnDProvider:f,LibraryTypeService:g,events:{onReady:function(){if(o.setTreeCont(this),r.libraryTree_Cont=this._libraryTreeView,null!==r.libraryTree_Cont)r.libraryTree_Cont.setOption("_libraryContentView",this._libraryTreeView);else{if(!0===r.libraryTree_W_NotLinked)throw"LibraryTree are not linked !!!";r.libraryTree_W_NotLinked=!0}var a=r._retrieveinitializationOpts(),n=UWA.extend(e,a);n.placeholderData={},n.placeholderData.multiplePlaceholders=!0,n.placeholderData.placeholders={},n.placeholderData.placeholders.favoriteSection={},n.placeholderData.placeholders.favoriteSection.labelNLS=p.placeholder_Msg_FavoriteSection,n.placeholderData.placeholders.createNewDefinitionLibrary={},n.placeholderData.placeholders.createNewDefinitionLibrary.labelNLS=p.placeholder_Msg_CreateStandardOrDefinitonLib,n.placeholderData.placeholders.createNewDefinitionLibrary.commandNLS=p.placeholder_CMD1_CrteLib,n.placeholderData.placeholders.createNewDefinitionLibrary.command="CreateNewDefinitionLibrary",n.placeholderData.placeholders.createNewStandardLibrary={},n.placeholderData.placeholders.createNewStandardLibrary.labelNLS=p.placeholder_Msg_CreateStandardOrDefinitonLib,n.placeholderData.placeholders.createNewStandardLibrary.commandNLS=p.placeholder_CMD2_CrteLib,n.placeholderData.placeholders.createNewStandardLibrary.command="CreateNewStandardLibrary",n.placeholderData.placeholders.addClassAttributes={},n.placeholderData.placeholders.addClassAttributes.labelNLS=p.placeholder_Msg_classAttributes,n.placeholderData.placeholders.addClassAttributes.commandNLS=p.command_addExistingAttribute,n.placeholderData.placeholders.addClassAttributes.command="AddExistingAttributes",n.placeholderData.placeholders.createNewClass={},n.placeholderData.placeholders.createNewClass.labelNLS=p.placeholder_Msg,n.placeholderData.placeholders.createNewClass.labelNLS_Cls=p.placeholder_Msg_Cls,n.placeholderData.placeholders.createNewClass.commandNLS=p.placeholder_CMD1,n.placeholderData.placeholders.createNewClass.command="CreateNewClass",n.placeholderData.placeholders.newClassAttributes={},n.placeholderData.placeholders.newClassAttributes.labelNLS=p.placeholder_Msg_newClassAttributes,n.placeholderData.placeholders.newClassAttributes.commandNLS=p.placeholder_CMD2,n.placeholderData.placeholders.newClassAttributes.command="CreateClassAttributes",n.leftTriptychElem=r.libraryTree_Cont.elements.container,n.dataProvider=l,n.CSOProvider=u,n.DnDProvider=f,n.libraryEditorUtil=m,n.libraryControl=o,n.leftState=t,n.rightState=i,n.libraryContent_div=r.libraryContent_div,n.tabBarProvider=b,n.css_view_class=r.css_view_class,r.libraryContentController=new s(n),o.setContent(r.libraryContentController),r.widget.dispatchEvent("onClassificationEditorReady")}}});o.setTreeCont(d)}));else{var h=r._retrieveinitializationOpts(),_=UWA.extend(e,h);_.placeholderData={},_.placeholderData.multiplePlaceholders=!0,_.placeholderData.placeholders={},_.placeholderData.placeholders.favoriteSection={},_.placeholderData.placeholders.favoriteSection.labelNLS=p.placeholder_Msg_FavoriteSection,_.placeholderData.placeholders.createNewDefinitionLibrary={},_.placeholderData.placeholders.createNewDefinitionLibrary.labelNLS=p.placeholder_Msg_CreateStandardOrDefinitonLib,_.placeholderData.placeholders.createNewDefinitionLibrary.commandNLS=p.placeholder_CMD1_CrteLib,_.placeholderData.placeholders.createNewDefinitionLibrary.command="CreateNewDefinitionLibrary",_.placeholderData.placeholders.createNewStandardLibrary={},_.placeholderData.placeholders.createNewStandardLibrary.labelNLS=p.placeholder_Msg_CreateStandardOrDefinitonLib,_.placeholderData.placeholders.createNewStandardLibrary.commandNLS=p.placeholder_CMD2_CrteLib,_.placeholderData.placeholders.createNewStandardLibrary.command="CreateNewStandardLibrary",_.placeholderData.placeholders.addClassAttributes={},_.placeholderData.placeholders.addClassAttributes.labelNLS=p.placeholder_Msg_classAttributes,_.placeholderData.placeholders.addClassAttributes.commandNLS=p.command_addExistingAttribute,_.placeholderData.placeholders.addClassAttributes.command="AddExistingAttributes",_.placeholderData.placeholders.createNewClass={},_.placeholderData.placeholders.createNewClass.labelNLS=p.placeholder_Msg,_.placeholderData.placeholders.createNewClass.labelNLS_Cls=p.placeholder_Msg_Cls,_.placeholderData.placeholders.createNewClass.commandNLS=p.placeholder_CMD1,_.placeholderData.placeholders.createNewClass.command="CreateNewClass",_.placeholderData.placeholders.newClassAttributes={},_.placeholderData.placeholders.newClassAttributes.labelNLS=p.placeholder_Msg_newClassAttributes,_.dataProvider=l,_.CSOProvider=u,_.DnDProvider=f,_.tabBarProvider=b,_.libraryContent_div=r.libraryContent_div,_.thumbnailAttributeDelayed=!0,r.libraryContentController=new s(_),o.setContent(r.libraryContentController),r.widget.dispatchEvent("onClassificationEditorReady"),C.subscribe({event:"/NLSRange/updated"},(function(e){m.uppendChangestoList(e)}))}r._keyboardListener||(r._keyboardListener=new d,r._keyboardListener.startObservingKeyboard())}}))}))},updateSecurityPreference:function(){window.library&&require(["DS/PADUtils/PADSettingsMgt"],(function(e){var t="ctx::"+window.library.params.securityContext;e.setSetting("pad_security_ctx",t)}))},_retrieveinitializationOpts:function(){var e=this;return{renderTo:e.libraryContent_div,events:{onActionBarReadyToBuild:function(){var r=require("DS/IPClassifyUX/LibraryIdCardCont"),a=require("DS/PADServices/utils/GlobalModelEvents"),n=require("DS/ClassificationEditor/dataProvider/LibraryCSODataProvider"),o=require("DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider"),s=require("DS/ClassificationEditor/dataProvider/ClassificationTabBarProvider");window.DEBUG_ActionBar_Require=!0,window.DEBUG_ActionBar_CmdInstantiation=!0,window.DEBUG_ActionBar_Xml=!0,window.DEBUG_ActionBar_ProcessCommandHeader=!0,window.DEBUG_ActionBar_Init=!0,e.elements=this.elements,e.options=this.options,e.togglePanel=this.togglePanel,null===e.libraryIdCard_Cont&&(e.libraryIdCard_Cont=new r({lang:e.widget.lang?e.widget.lang:e.widget.getValue("lang"),css_view_class:e.css_view_class,parentDiv:e.libraryIdCard_div,leftState:t,rightState:i,modelEvents:a.getModelEvents(),libraryCSODataProvider:n,libraryDataProvider:o,TabBarProvider:s,TabCont:e.widget.body.top_right_side_div,events:{onReady:function(){e.libraryIdCard_Cont=this,e.libraryIdCard_Cont.render().inject(e.libraryIdCard_div)}}}))},onReady:function(){e.libraryContent_Cont=this,e.addEvent=e.libraryContent_Cont.addEvent.bind(e.libraryContent_Cont),e.libraryContent_Cont.dropInvitContainer&&(e.libraryContent_Cont._dropInvitContainer=e.libraryContent_Cont.dropInvitContainer),e.libraryContent_Cont.options.renderTo&&(e.libraryContent_Cont._dropInvitContainer.hide(),e.libraryContent_Cont.render().inject(e.libraryContent_Cont.options.renderTo));require("DS/PADUtils/PADSettingsMgt");e.updateSecurityPreference();var t=e.widget.getValue("X3DContentId");if(t){var i=UWA.is(t,"string")?JSON.parse(t):t;if(i.data.items.length>0){var r=i.data.items[0].objectId;e.widget.setValue("X3DContentId","");var a=require("DS/ClassificationEditor/utils/ClassificationEditorcontrol"),n=require("DS/IPClassifyUtil/IPClassifyAlert");a.getTreeCont().expandTreeAndSelectLibrary({libraryToFindAndSelect:{id:r},onFailure:function(e){n.displayNotification({message:e instanceof Error?e.message:e,className:"error"})},isInvisible:!0})}}},onCustoViewChange:function(t){require(["DS/IPClassifyUtil/IPClassifyUtility"],(function(i){e.widget.setValue("LibraryCusto_treelistview_v1",i.jsonZip(JSON.stringify(t)))}))},onSaveAsTemplate:function(t){require(["DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassifyUtil/IPClassifyUtility"],(function(i,r){e.widget.setValue("LibraryCusto_treelistview_v1",r.jsonZip(JSON.stringify(t))),i.saveUserPreferences({name:e.widget.getValue("x3dAppId")+"_Classification_v1",value:r.jsonZip(JSON.stringify(t)),onComplete:function(e){console.log("Saved as template")},onFailure:function(e){console.warn("Cannot save customization template")}})}))},onSwitchView:function(){require("DS/ClassificationEditor/ActionBar/ClassificationCommandManager").updateCommands()},onToggleView:function(){require("DS/ClassificationEditor/ActionBar/ClassificationCommandManager").updateCommands()}}}}};return r.init(e),r}define("DS/ClassificationEditor/service/LibraryServices",["DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],(function(e,t,i,r,a){"use strict";return{DeleteLibrary:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");e.IDs.length>0?t.deleteLibrary({IDs:e.IDs,onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var r=i.error;console.log("Delete Library WebService Err : "+r),r.length>200&&(r=null),e.callbacks.onFailure(r)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure}):e.callbacks.onFailure(e)},DeleteClass:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");e.IDs.length>0?t.deleteClass({IDs:e.IDs,onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var r=i.error;console.log("Delete Class WebService Err : "+r),r.length>200&&(r=null),e.callbacks.onFailure(r)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure}):e.callbacks.onFailure(e)},MoveClass:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");var i=e.targetLibrary,r=i?i.id:"";r.length&&e.IDs.length?t.moveClass({classPhysicalIds:e.IDs,targetLibraryPhysicalId:r,carryOverAttributeGroups:e.carryOverAttributeGroups,onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var r=i.error;console.log("MoveClass WebService Err : "+r),e.callbacks.onFailure(r)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure}):e.callbacks.onFailure(e)}}})),define("DS/ClassificationEditor/utils/LibrarySearch",["UWA/Class","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","text!DS/ClassificationEditor/assets/library_exclude_columns.json"],(function(e,t,i){"use strict";return e.singleton({init:function(e){this._parent(e),this._predicateToHeaderMap=null,this._dynamicHeaderMap=[],this._dynamicMapSorted=!1,this._searchInfo=null,this._defaultPredicates=["ds6w:label","physicalid","mxid","ds6w:type","owner","ds6w:classificationUsage"],this._authModePredicates=["ds6w:label","physicalid","mxid","ds6w:description","ds6w:modified","ds6w:created","ds6w:responsible","ds6w:type","ds6w:identifier","ds6w:status","ds6w:reservedBy","owner","policy","ds6w:classificationUsage"],this._authPersonAttributes=["ds6w:reservedby","ds6w:responsible"];this._searchInfo={with_indexing_date:!0,select_predicate:this._defaultPredicates.slice(0),select_file:["icon","thumbnail_2d"],order_field:"ds6w:modified",order_by:"desc",nresults:25}},getSearchInfo:function(e){var t=Object.assign({},this._searchInfo);return!0===e&&(t.select_predicate=this._authModePredicates),t},filterExcludeListColumns:function(e){var t=[],r=JSON.parse(i);if(r){r=r.columnToExclude;for(var a=0;a<e.length;++a)-1==r.indexOf(e[a].dataIndex)&&t.push(e[a])}return t},setPredicates:function(e,t){var r=this,a=JSON.parse(i),n=[];a&&(n=a.predicateToExclude,a=a.columnToExclude),Array.isArray(e)&&e.forEach((function(e){var t=e.ds6w;t||(t=e.dataIndex),"tree"===t||-1===r._searchInfo.select_predicate.indexOf(t)&&-1===a.indexOf(t)&&-1===n.indexOf(t)&&r._searchInfo.select_predicate.push(t)}))},removeAllPredicates:function(){this._searchInfo.select_predicate=[],this._searchInfo.select_predicate=this._searchInfo.select_predicate.concat(this._defaultPredicates)},removePredicates:function(e){for(var t=[],i=[],r=0;r<e.length;++r)i.push(e[r].dataIndex);this._searchInfo.select_predicate.forEach((function(e){-1===i.indexOf(e)&&t.push(e)})),this._searchInfo.select_predicate=t},getPersonPredicatesForAuth:function(){return this._authPersonAttributes},setAttrNameToPredMapping:function(e){this._attrNameToPredMapping||(this._attrNameToPredMapping={}),this._attrNameToPredMapping&&e&&(this._attrNameToPredMapping[e.key]=e.value)},getAttrNameToPredMapping:function(){return this._attrNameToPredMapping||(this._attrNameToPredMapping={}),this._attrNameToPredMapping},resetAttrNameToPredMapping:function(){this._attrNameToPredMapping=null},initPredicateToHeaderMap:function(e){if(!this._predicateToHeaderMap){this._predicateToHeaderMap=[];for(var t=0;t<e.length;t++){var i=e[t],r=i.text?i.text.toLowerCase():null;if(r&&i.ds6w){var a={header:r,predicate:i.ds6w};this._predicateToHeaderMap.push(a)}}}},addToPredicateHeaderMap:function(e){for(var t=0;t<e.length;++t){var i=e[t],r=i.text?i.text.toLowerCase():null;if(r&&i.ds6w){var a={header:r,predicate:i.ds6w};this._predicateToHeaderMap.push(a)}}},removeFromPredicateHeaderMap:function(e){this._predicateToHeaderMap=this._predicateToHeaderMap.filter((function(e){for(var t=0;t<this.length;++t)if(this[t].ds6w==e.predicate)return!1;return!0}),e)}})})),define("DS/ClassificationEditor/service/LibraryTypeService",["UWA/Controls/Abstract","text!DS/PADUtils/assets/PADOpenCommandsSettings.json"],(function(e,t){return e.singleton({TYPE_ROOT_LIBRARY_1:"General Library",TYPE_ROOT_LIBRARY_2:"Part Library",TYPE_ROOT_LIBRARY_3:"RootLibrary",TYPE_LIBRARY_1:"General Class",TYPE_LIBRARY_2:"Library",TYPE_LIBRARIES_SECTION:"LibrarySection_AllLibraries",TYPE_FAVORITES_SECTION:"LibrarySection_favorite",RELATIONSHIP_SUBCLASS:"Subclass",STANDARD_USAGE:"STANDARD",openTypes:[],getOpenAvailableForTypes:function(e){if(0==this.openTypes.length&&e){var i=JSON.parse(t);i["openInCAD_"+e+"_supported_types"]&&(this.openTypes=i["openInCAD_"+e+"_supported_types"])}return this.openTypes},init:function(){},isRootLibrary:function(e){return e===this.TYPE_ROOT_LIBRARY_1||e===this.TYPE_ROOT_LIBRARY_2||e===this.TYPE_ROOT_LIBRARY_3},isLibrary:function(e){return e===this.TYPE_LIBRARY_1||e===this.TYPE_LIBRARY_2},inFamilyLibrary:function(e){return this.isRootLibrary(e)||this.isLibrary(e)},isSection:function(e){return e===this.TYPE_LIBRARIES_SECTION||e===this.TYPE_FAVORITES_SECTION},getPlmTypeFromContentDetails:function(e){if(e&&!(e.length<1)){for(var t,i,r,a,n="Content",o=0,s=e.length;o<s;++o)if("flattenedtaxonomies"===e[o].name){if("types/Classification"===e[o].value?t=!0:"types/General Class"===e[o].value?i=!0:"types/Libraries"===e[o].value?r=!0:"types/General Library"===e[o].value&&(a=!0),"types/Classification"===e[o].value[0]&&"types/General Class"===e[o].value[1]){n="Library";break}if("types/Libraries"===e[o].value[0]&&"types/General Library"===e[o].value[1]){n="RootLibrary";break}}return t&&i&&(n="Library"),r&&a&&(n="RootLibrary"),n}},getPLMTypeOfLibraryTreeNode:function(e){var t="";if(e){var i=e.plmType;t="Library"==i?"General Class":"RootLibrary"==i?"General Library":i}return t}})})),define("DS/ClassificationEditor/commands/ActionBar_ExpandNCmd",["UWA/Core","DS/ApplicationFrame/Command"],(function(e,t){"use strict";return t.extend({labelTopBar:e.i18n("Expand N levels"),isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),require(["DS/IPClassifyUtil/IPClassifyAlert","DS/PADUtils/views/PADLevelSel","DS/ClassificationEditor/utils/Library_CSO","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],(function(e,t,i,r){}))},beginExecute:function(){},execute:function(){var e=require("DS/IPClassifyUtil/IPClassifyAlert"),t=require("DS/PADUtils/views/PADLevelSel"),i=require("DS/ClassificationEditor/utils/Library_CSO"),r=require("i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"),a=null;null===(a=i.getCurrentLibrary())?e.displayNotification({message:r.msg_warning_noselection,className:"warning"}):new t({css_style:"",events:{onApply:function(e){a.expandNLevels({numberOfLevelsToExpand:parseInt(e),initialLevel:a.getNodeDepth()})}}})},endExecute:function(){}})})),define("DS/ClassificationEditor/utils/FilterUtils",["UWA/Class"],(function(e){"use strict";return e.singleton({init:function(e){this.libraryFilter='flattenedtaxonomies:"types/General Library"',this.classFilter=["General Class"],this.classTreeFilter='flattenedtaxonomies:"types/General Class"',this.classTreeFilterAuth="General Class",this.endItemFilter=null,this.excludeBOTypesFromContentView=["Document Family","Part Family"]}})})),define("DS/ClassificationEditor/utils/ClassificationEditorcontrol",["UWA/Controls/Abstract"],(function(e){return e.singleton({_Content:null,_TreeCont:null,_IdCardCont:null,_onWidgetRefresh:null,getContent:function(){return this._Content},setContent:function(e){this._Content=e},getTreeCont:function(){return this._TreeCont},setTreeCont:function(e){this._TreeCont=e},getIdCardCont:function(){return this._IdCardCont},setIdCardCont:function(e){this._IdCardCont=e},setWidgetRefresh:function(e){this._onWidgetRefresh=e},getWidgetRefresh:function(){return this._onWidgetRefresh}})})),define("DS/ClassificationEditor/utils/ClassificationMigration",["DS/IPClassifyUtil/IPClassifyPreference","DS/IPClassifyUtil/IPClassifyUtility"],(function(e,t){return{migrateFavPreferences:function(i,r){return new Promise((function(i){1==r?e.get("ipcFavoriteList_v1",(function(a){e.set(t.getTenantAwarePreferenceName("ipcFavoriteList_v1"),a,!1,!1),e.set("LibraryFavPrefVersion",{version:r},!1),i()}),!1):i()}))},migrateTreeStructurePreferences:function(i,r){return new Promise((function(i){1==r?e.get("ipcTreeStrucure_v1",(function(a){e.set(t.getTenantAwarePreferenceName("ipcTreeStrucure_v1"),a),e.get("ipcTreeSelectedNode_v1",(function(a){e.set(t.getTenantAwarePreferenceName("ipcTreeSelectedNode_v1"),a),e.set("LibraryTreeStrcutPrefVersion",{version:r}),i()}))})):i()}))}}})),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewIntegerAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],(function(e,t,i,r,a){"use strict";return t.extend({labelTopBar:e.i18n("New Integer Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new a).loadAttrCreatePanel({attrType:"Integer",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewBooleanAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],(function(e,t,i,r,a){"use strict";return t.extend({labelTopBar:e.i18n("New Boolean Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new a).loadAttrCreatePanel({attrType:"Boolean",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewStringAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],(function(e,t,i,r,a,n,o,s){"use strict";return t.extend({labelTopBar:e.i18n("New String Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new o).loadAttrCreatePanel({attrType:"String",container:a.getContent().getView().elements.container,grid:a.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewDateAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],(function(e,t,i,r,a){"use strict";return t.extend({labelTopBar:e.i18n("New Date Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new a).loadAttrCreatePanel({attrType:"Date",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewRealAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],(function(e,t,i,r,a){"use strict";return t.extend({labelTopBar:e.i18n("New Real Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new a).loadAttrCreatePanel({attrType:"Double",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/ActionBar_ClassAttributesToolsCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],(function(e,t,i,r,a){"use strict";return t.extend({labelTopBar:e.i18n("New Boolean Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new a).buildToolsMenu({container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewDimentionalAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],(function(e,t,i,r,a){"use strict";return t.extend({labelTopBar:e.i18n("New Attribute With Dimention"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new a).loadAttrCreatePanel({attrType:"DoubleWithDim",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})})),define("DS/ClassificationEditor/service/ClassificationEditorWebService",["UWA/Core","DS/WAFData/WAFData","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/ClassificationEditor/utils/LibrarySearch","DS/ClassificationEditor/utils/FilterUtils","DS/IPClassifyUtil/IPClassifyUtility","text!DS/ClassificationEditor/assets/ClassificationEditorProps.json","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUX/models/LibrarySearchModel"],(function(e,t,i,r,a,n,o,s,l,d,c){"use strict";return{_pageCount:50,content:function(e){var t={};UWA.extend(t,e);var i="";t.checkClassifiedItems?i="classification: "+e.mxid+' AND NOT (flattenedtaxonomies: ("types/Part Family" OR "types/Document Family" OR "types/General Class")) ':t.searchQuery?i="("+e.searchQuery.trim()+' ) AND (flattenedtaxonomies:"types/General Class" AND classification: '+e.mxid+")":(i='flattenedtaxonomies:"types/General Class"',!0===e.isAuthoringMode&&(i='type == "General Class"'),t.isExpand=!0),!0===t.isExpand&&t.pid&&(i=i+" AND NOT( physicalid == "+t.pid+")"),t.searchPageCount=this._pageCount,this._performSearchQuery(t,i,"content")},roots:function(e){var t='flattenedtaxonomies:"types/Libraries"',i=o.libraryFilter;i&&null!=i&&(t=i),!0===e.isAuthoringMode&&(t='type == "General Library"'),!0!==e.fetchAll&&(e.searchPageCount=this._pageCount),this._performSearchQuery(e,t,"roots")},favourites:function(e){this._performFetchQuery(e,"favourites")},libraries:function(e){var t={};UWA.extend(t,e),t.expand_iter="1",e.isExpandAll&&(t.expand_iter="-1");var i=o.classTreeFilter;e.isAuthoringMode&&(i=o.classTreeFilterAuth),t.filter=i,this._performExpandQuery(t,"libraries")},deleteLibrary:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.deleteLibrary");var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.IDs[0]+"/delete";t.headers={"content-type":"application/json"},t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"deleteLibrary")},deleteClass:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.deleteClass");var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/class/"+t.IDs[0]+"/delete";t.headers={"content-type":"application/json"},t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"deleteClass")},moveClass:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.moveClass");var i=s.get3DSpaceUrl()+"/resources/IPClassificationReuse/class/"+t.classPhysicalIds[0]+"/moveClassification?carryOver="+t.carryOverAttributeGroups;t.headers={"content-type":"application/json"},t.data={id:t.targetLibraryPhysicalId},t.data=UWA.Json.encode(t.data),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"moveClass")},setProperties:function(e){var t={};if(UWA.extend(t,e),!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.setProperties");if(!UWA.is(t.pid,"string"))throw new Error("Invalid inputs for ClassificationEditorWebService.setProperties");var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.pid+"/updateClassificationProps",r=n.getSearchInfo(e.isAuthoringMode).select_predicate;r=r.concat(["flattenedtaxonomies"]),t.payload={};var o=["svg","bi_color"],l=r.filter((function(e){return o.indexOf(e)<0}));t.payload.physicalid=t.pid,t.payload.select_predicate=l,t.payload.properties=t.properties,s.isIndexedMode()?(t.payload.person_predicate=[],t.payload.compute_select_bo=["icon","thumbnail_2d"]):(t.payload.person_predicate=n.getPersonPredicatesForAuth(),t.payload.compute_select_bo=["icon","thumbnail_2d"]),t.method="POST",t.headers={"content-type":"application/json",Accept:"application/json"},t.type="json",t.data={properties:t.properties,fetchPayload:t.payload},t.data=UWA.Json.encode(t.data),this._executeRequest(i,t,"setProperties")},getLibraryPathLength:function(e){e.fetchClassification=!0,this._performFetchQuery(e,"getLibraryPathLength")},getLibraryPath:function(e){var t={};UWA.extend(t,e);for(var i={},r=t.depth,a=1;a<=r;a++)i["GET_PARENT_"+a+"_LIBRARY"]=[{id:2,iter:a}];t.patterns=i,this._performNavigateQuery(t,"getLibraryPath")},_performNavigateQuery:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var t={};UWA.extend(t,e);var i=r.getSetting("pad_security_ctx"),s=a.get3DSpaceUrl()+"/cvservlet/navigate";!0===e.isAuthoringMode&&(s=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/Navigate/navigate"),s+="?SecurityContext="+encodeURIComponent(i);var l=widget.lang?widget.lang:widget.getValue("lang"),d=[];d.push(e.pid),t.payload={},t.payload.input_physical_ids=d;var c=o.classFilter;c&&null!=c&&"RootLibrary"==e.selectedType?t.payload.primitives=[{navigate_to_rel:{id:1,filter:{bo_type:c}},navigate_from_rel:{id:2}}]:t.payload.primitives=[{navigate_to_rel:{id:1},navigate_from_rel:{id:2}}],t.payload.patterns=t.patterns;var u=n.getSearchInfo(!0).select_predicate;if(u=u.concat(["flattenedtaxonomies"]),e.dynamicattrs&&e.dynamicattrs.length>0){var f=u.concat(e.dynamicattrs);t.payload.attributes=f}else t.payload.attributes=u;t.payload.version=3;var p=new Date;return t.payload.label=("LibraryWidgetNavigate_"+p.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),t.method="POST",t.headers={Accept:"application/json","content-type":"application/json","Accept-Language":l},t.type="json",t.data=UWA.Json.encode(t.payload),this._executeRequest(s,t,"searchInLibrary")},_performExpandQueryIndex:function(e,t,i){var n={};UWA.extend(n,e);let o=a.get3DSpaceUrl()+"/cvservlet/progressiveexpand/v2?output_format=cvjson",l=[];return n.pid&&(n.children||(n.children=[]),n.children.push(n.pid)),n.children.forEach(((e,i)=>{let r={label:t+"_"+i,root:{physical_id:e},parameters:{graph_advise:1,limit_max_path:1e4},graph:{descending_condition_object:{uql:'(flattenedtaxonomies:"types/General Class") OR (flattenedtaxonomies:"types/General Library") '}},filter:{all:1}};n.expand_iter>=0&&(r.aggregation_processors=[{truncate:{max_distance_from_prefix:n.expand_iter,prefix_filter:{prefix_path:[{physical_id_path:[e]}]}}}]),l.push(r)})),n.payload={batch:{expands:l},outputs:{select_object:i,format:"entity_relation_occurrence",hits:{predefined_computation:["mythumbnail2d","icons"]}}},n.headers={SecurityToken:s.getUserLogin()+"|"+r.getSetting("pad_security_ctx")+"|preferred","content-type":"application/json"},n.type="json",n.data=UWA.Json.encode(n.payload),n.method="POST",this._executeRequest(o,n,"expandFolder")},_performExpandQuery:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var t=n.getSearchInfo(!0).select_predicate;t=t.concat(["flattenedtaxonomies"]);var i=["svg","bi_color"],o=t.filter((function(e){return i.indexOf(e)<0}));let s=("LibraryWidgetExpand_"+(g=new Date).getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-");if(!0!==e.isAuthoringMode)return e.dynamicattrs&&e.dynamicattrs.length>0&&(o=o.concat(e.dynamicattrs)),this._performExpandQueryIndex(e,s,o);var l={};UWA.extend(l,e);var d=null;!0===e.isAuthoringMode&&(d=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/Expand/expand");var c=widget.lang?widget.lang:widget.getValue("lang");if(l.payload={},l.payload.expand_iter=e.expand_iter,l.children&&l.children.length>0){var u=[];u.push(e.pid);for(var f=0;f<l.children.length;++f)u.push(l.children[f]);l.payload.multi_root_physicalid=u}else l.payload.root_physicalid=e.pid;if(l.filter&&!1===e.isAuthoringMode&&(l.payload["q.iterative_filter_query_bo"]=e.filter),l.filter&&!0===e.isAuthoringMode&&(l.payload.iterative_filter_query_bo=e.filter,l.payload.person_predicate=n.getPersonPredicatesForAuth()),e.dynamicattrs&&e.dynamicattrs.length>0){var p=o.concat(e.dynamicattrs);l.payload.select_bo=p}else l.payload.select_bo=o;l.payload.compute_select_bo=["icon","thumbnail_2d"];var g=new Date;return l.payload.label=("LibraryWidgetExpand_"+g.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),l.payload.max_count_path="10000",l.method="POST",l.headers={SecurityContext:encodeURIComponent(r.getSetting("pad_security_ctx")),Accept:"application/json","content-type":"application/json","Accept-Language":c},l.type="json",l.data=UWA.Json.encode(l.payload),this._executeRequest(d,l,"Expand")},_performFetchQuery:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var t={};UWA.extend(t,e);var i=r.getSetting("pad_security_ctx"),o=a.get3DSpaceUrl()+"/cvservlet/fetch/v2",l=widget.lang?widget.lang:widget.getValue("lang"),d=n.getSearchInfo(e.isAuthoringMode).select_predicate;d=d.concat(["flattenedtaxonomies"]),t.payload={},e.dynamicAttrs&&e.dynamicAttrs.length>0&&(t.payload.classification_attribute=e.dynamicAttrs,d=d.concat(e.dynamicAttrs));var c=["svg","bi_color"],u=d.filter((function(e){return c.indexOf(e)<0}));!0===e.fetchClassification&&u.push("classification"),t.payload.physicalid=t.ids,t.payload.select_predicate=u,!0===e.isAuthoringMode&&(o=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/classifiedItem/getContentDetails",t.payload.person_predicate=n.getPersonPredicatesForAuth(),t.payload.compute_select_bo=["icon","thumbnail_2d"]);var f=new Date;return t.payload.label=("LibraryWidgetFetch_"+f.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),t.method="POST",t.headers={Accept:"application/json","content-type":"application/json","Accept-Language":l,SecurityToken:s.getUserLogin()+"|"+i+"|preferred"},t.type="json",t.data=UWA.Json.encode(t.payload),this._executeRequest(o,t,"Fetch")},_performSearchQuery:function(e,t){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var i={};UWA.extend(i,e);var o=a.get3DSearchUrl()+"/search",s=widget.lang?widget.lang:widget.getValue("lang");i.payload=Object.assign({},n.getSearchInfo(e.isAuthoringMode));var l=i.payload.select_predicate;i.securityContextRequired=!1,!0===e.isAuthoringMode&&0==c.isSearchActive()?(i.securityContextRequired=!0,o=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/Search/search",i.payload.person_predicate=n.getPersonPredicatesForAuth(),i.payload.root_physicalid=e.pid):i.payload.login={"3dspace":{SecurityContext:r.getSetting("pad_security_ctx")}},l=l.concat(["flattenedtaxonomies"]),e.dynamicattributes&&e.dynamicattributes.length>0&&(l=l.concat(e.dynamicattributes)),i.payload.select_predicate=l;var u=new Date,f=Math.random();f.toString(36);var p=f.toString(36).substr(2,9);return i.payload.label=("LibraryWidgetSearch_"+p+"_"+u.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),i.payload.locale=s,i.payload.query=t,i.payload.tenant=a.getPlatformId(),i.payload.next_start=e.next_start,i.payload.start=e.start,i.method="POST",i.headers={SecurityContext:encodeURIComponent(r.getSetting("pad_security_ctx")),Accept:"application/json","content-type":"application/json","Accept-Language":s},i.type="json",e.order_field&&(i.payload.order_field=e.order_field,i.payload.order_by=e.order_by),e.searchPageCount&&(i.payload.nresults=e.searchPageCount),!0===e.fetchAll&&(i.payload.nresults=1e3),e.isExpand&&!1===e.isAuthoringMode&&(i.payload.source=["3dspace"],i.payload.specific_source_parameter={"3dspace":{search_in_context:{expand:{root_physicalid:e.pid,expand_iter:"1",type_filter_rel:[d.RELATIONSHIP_SUBCLASS]}},option:{with_Idx_Search:!0}}}),e.filters&&!1===e.isAuthoringMode&&(i.payload.refine=e.filters),i.data=UWA.Json.encode(i.payload),this._executeRequest(o,i,"searchInLibrary")},_executeRequest:function(e,a,n){var o=Math.round(1e3*Math.random()).toString(),s=widget.id+"_"+widget.getTitle()+"_";window.top.performance.mark("libraryRequest_begin"+o);var l={};if(UWA.extend(l,a),!l.payload&&e.indexOf("cvservlet")>-1){l.payload={};var d=new Date;l.payload.label=("LibraryWidgetExecute_"+d.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-")}UWA.is(l.onTimeout,"function")||(l.onTimeout=function(){var e={type:"timeout",toString:function(){return i.msg_InfoAction_Timeout}};l.onFailure(e)},l.onComplete=function(e){window.top.performance.mark("libraryRequest_end"+o);var t=window.top.performance.getEntriesByName("libraryRequest_begin"+o);t&&1===t.length&&(window.top.performance.measure(s+"_Request"+n,"libraryRequest_begin"+o,"libraryRequest_end"+o),window.top.performance.clearMarks("libraryRequest_end"+o),window.top.performance.clearMarks("libraryRequest_begin"+o)),a.onComplete(e)});var c={Accept:"application/json","Accept-Language":widget.lang?widget.lang:widget.getValue("lang")};if(!1!==l.securityContextRequired){let e=r.getSetting("pad_security_ctx")?encodeURIComponent(r.getSetting("pad_security_ctx")):r.getSetting("pad_security_ctx");c.SecurityContext=e}return a.headers?l.headers=UWA.extend(c,a.headers):l.headers=c,(l.timeout||l.timeout<12e4)&&(l.timeout=12e4),t.authenticatedRequest(e,l)},getClassificationAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.getClassificationAttributes");var t={};UWA.extend(t,e);var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/"+t.classid+"/getClassAttributes?timezoneOffset="+(new Date).getTimezoneOffset()/60;return t.method="GET",t.timeout=12e4,this._executeRequest(i,t,"getClassificationAttributes")},fetchDataForClassAttributesTab:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.fetchAllTheClassificationAttributes");var t={};UWA.extend(t,e);var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/getDataForClassAttributesTab?timezoneOffset="+(new Date).getTimezoneOffset()/60;return t.method="GET",t.timeout=12e4,t.securityContextRequired=!0,this._executeRequest(i,t,"fetchDataForClassAttributesTab")},fetchAllTheClassificationAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.fetchAllTheClassificationAttributes");var t={};UWA.extend(t,e);var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/fetchAttributes?timezoneOffset="+(new Date).getTimezoneOffset()/60;return t.method="GET",t.timeout=12e4,this._executeRequest(i,t,"fetchAllTheClassificationAttributes")},addClassAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.addClassAttributes");var t={};UWA.extend(t,e);var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/"+t.pid+"/addAttributes";if(t.headers={"content-type":"application/json"},t.attributes){var r=t.attributes,n=[];r.forEach((function(e){n.push(e.name)})),t.data={attributes:n},t.data=UWA.Json.encode(t.data)}t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"addClassAttributes")},reorderClassAttributes:function(e){var t=[];if(e.attributeList.forEach((function(e){UWA.is(e)&&t.push(e)})),!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.reorderClassAttributes");var i={};UWA.extend(i,e);var r=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/reorderClassAttributes";i.headers={"content-type":"application/json"},i.data={classId:e.classId,attributeList:t},i.data=UWA.Json.encode(i.data),i.method="POST",i.timeout=12e4,this._executeRequest(r,i,"reorderClassAttributes")},removeClassAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.removeClassAttributes");var t={};UWA.extend(t,e);var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/"+t.pid+"/removeAttributes";t.headers={"content-type":"application/json"},t.attributes&&(t.data={attributes:t.attributes},t.data=UWA.Json.encode(t.data)),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"removeClassAttributes")},exportClassificationAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.exportClassificationAttributes");var t={};UWA.extend(t,e);var i=JSON.parse(l);t.headers={Accept:"application/zip","Content-Type":"application/zip","Accept-Language":widget.lang},t.package=i.package_name,t.tenant=a.getPlatformId(),t.type="blob",t.method="GET",t.timeout=18e5;var r=a.get3DSpaceUrl()+"/resources/dictionary/ExportData?tenant="+t.tenant+"&package="+t.package;this._executeRequest(r,t,"exportClassificationAttributes")},downloadCatNls:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.exportClassificationAttributes");var t={};UWA.extend(t,e);JSON.parse(l);t.headers={Accept:"application/zip","Content-Type":"application/zip","Accept-Language":widget.lang},t.tenant=a.getPlatformId(),t.type="blob",t.method="GET",t.timeout=18e5;var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/downloadCATNls";this._executeRequest(i,t,"downloadCATNls")},exportLibraryStructure:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.exportLibraryStructure");var t={};UWA.extend(t,e);var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.pid+"/exportStructure";t.headers={"content-type":"application/json",Accept:"application/json"},t.method="GET",t.timeout=6e5,this._executeRequest(i,t,"exportLibraryStructure")},importLibraryStructure:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.importLibraryStructure");var t={};UWA.extend(t,e);var i=a.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/importStructure";t.headers={"content-type":"application/json",Accept:"application/json"},t.fileContent&&(t.data={isValidate:t.isValidate,fileContent:t.fileContent},t.data=UWA.Json.encode(t.data)),t.method="POST",t.timeout=6e5,this._executeRequest(i,t,"importLibraryStructure")},hasLibrarianRole:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for LibraryEditorWebService.hasLibrarianRole");var i=s.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/canManageClassificationAttributes";return t.method="GET",this._executeRequest(i,t,"hasLibrarianRole")},checkModifyAccessOnItems:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for LibraryEditorWebService.addcontent");var i=s.get3DSpaceUrl()+"/resources/IPClassificationReuse/classifiedItem/checkModifyAccess";t.headers={"content-type":"application/json"},t.data={objectIds:e.objectIds},t.data=UWA.Json.encode(t.data),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"checkModifyAccess")}}})),define("DS/ClassificationEditor/utils/ClassificationEditorDataConversion",["DS/WebappsUtils/WebappsUtils","DS/ClassificationEditor/service/LibraryTypeService","DS/PADServices/utils/AttributesMgt","DS/ClassificationEditor/utils/LibrarySearch","DS/IPClassifyUtil/IPClassifyUtility","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],(function(e,t,i,r,a,n){var o=function(e){var t=e.toLowerCase(),r=null;i.getAvailableColumns()&&(r=i.getAvailableColumns());var a=i.getTreeColumn(),n=null;return Array.isArray(r)&&r.every((function(e){return"tree"===e&&(e=a),t==e.toLowerCase()&&(n=e),null===n})),n=n||e},s={convertToExaleadDataFormatFederated:function(e){var t={children:null},i=e.attributes,n=r.getAttrNameToPredMapping(),s={"ds6w:type":"type","ds6w:label":"label","ds6w:classificationUsage":"usage"},l={};return i.forEach((function(e){if("resourceid"==e.name||"physicalid"==e.name)t.physicalid=e.value,t.resourceid=e.value;else if("mxid"==e.name)t.mxid=e.value;else if("nonNlsStatus"==e.name)t.status=e.value;else if("type_icon_url"===e.name)t.icons=[e.value];else if("preview_url"===e.name)t.thumbnail=e.value;else if(e.name.startsWith("ds6w")){var i=e.name.split("/");"ds6w:type"===(f=i[i.length-1])&&(m=e.value,["CATIA Embedded Component","CATPart","CATProduct","CATProcess","CATDrawing","CATAnalysis","CATShape"].indexOf(m)>=0)?t.children=[]:"ds6w:created"===f&&(t.created=e.value);var r=e.object?e.object:e.value;if(r=r||e.dispValue,n[f]){if(l[f]){r=[r];var d=l[f];Array.isArray(d)||(d=[d]),r=r.concat(d)}f=n[f]}if("ds6w:created"===f||"ds6w:modified"===f){if(r.indexOf("T")<0&&(!a.isOnPremise()||a.isOnPremise()&&!0===a.isIndexedMode())){r=new Date(r);var c=new Date(r).getTimezoneOffset();r=new Date(new Date(r).getTime()+Math.abs(60*c*1e3))}else r=new Date(r);r=r.toString()}l[f]=r,l[e.name]=r;var u=s[f];u&&(t[u]=r)}else{var f=e.name;n[f]&&(f=n[f]);var p=l[o(e.name)];if(p)if(Array.isArray(p))p.push(e.value);else{var g=[p,e.value];l[o(e.name)]=g,l[f]=g}else l[o(e.name)]=e.value,l[f]=e.value}var m})),e.id||(e.id=t.resourceid),t.grid=l,t.padgrid={"ds6w:leaf":"False","ds6w:root":"True"},t},convertAttributeFromDicoToExaleadDataFormat:function(t){var i={children:null},r={};for(var a in t)if(t.hasOwnProperty(a)){if("nls_hasDefault"===a)r.hasDefault=t[a];else if("name"===a)r["ds6w:label"]=t[a],i.label=t[a],r.Name=t[a],i.Name=t[a];else if("isInDico"===a)r.isInDico=t[a];else if("nls_predicate"===a)r.Predicates=t[a];else if("default"===a)r.DefaultValue=t[a];else if("description"===a)r.Description=t[a];else if("nls_type"===a)r.Type=t[a],i.type=t[a];else if("nls_dimension"===a)r.Dimension=t[a];else if("manipulationUnit"===a)r.prefUnit=t[a];else if("displayAsEntered"===a)r.DisplayAsEntered="Yes"==t[a]?"Yes":"No";else if("origin"===a)r.origin=t[a],i.origin=t[a];else if("range"===a){var n=t[a];(n="string"==typeof n?JSON.parse(n):n).forEach((function(e){if("between"==e.operator){var t=e.value.split(" ");r.Minimum=t[0],r.Maximum=t[2]}else r.AuthorizedValues?r.AuthorizedValues+=","+e.value:r.AuthorizedValues=e.value}))}else"nls_valuetype"===a?r.IsMultivalue=t[a]:"nls_multiline"===a?r.IsMultiline=t[a]:"attr_nls_en"===a?r.nls_EN=t[a]:"attr_nls_fr"===a?r.nls_FR=t[a]:"attr_nls_de"===a?r.nls_DE=t[a]:"attr_nls_ja"===a?r.nls_JA=t[a]:"attr_nls_ko"===a?r.nls_KO=t[a]:"attr_nls_ru"===a?r.nls_RU=t[a]:"attr_nls_zh"===a?r.nls_ZH=t[a]:"nls_isParametric"===a&&(r.attrIsParametric=t[a]);null==r.DisplayAsEntered&&r.Dimension&&(r.DisplayAsEntered="No"),r.values={isInDico:t.actual_is_InDico?t.actual_is_InDico.toString():"false",hasDefault:t.hasDefault,type:t.type}}return i.icons=[e.getWebappsAssetUrl("ClassificationEditor","icons/attributes.png")],i.grid=r,i.padgrid={"ds6w:leaf":"False","ds6w:root":"True"},i},convertAttributeToExaleadDataFormat:function(t){var i={children:null},r={};for(var a in t)if(t.hasOwnProperty(a)){if("nls_label"===a?(r["ds6w:label"]=t[a],i.label=t[a]):"nls_hasDefault"===a?r.hasDefault=t[a]:"isInDico"===a?r.isInDico=t[a]:"name"===a?r.Name=t[a]:"nls_predicate"===a?r.Predicates=t[a]:"default"===a?r.DefaultValue=t[a]:"description"===a?r.Description=t[a]:"nls_type"===a?(r.Type=t[a],i.type=t[a]):"nls_dimension"===a&&(r.Dimensions=t[a],t.manipulationUnit&&t.manipulationUnit.length>0&&(r.Dimensions+="("+t.manipulationUnit+")")),"displayAsEntered"===a)r.displayAsEntered="Yes"==t[a]?n.get("VALUE_TYPE_TRUE"):n.get("VALUE_TYPE_FALSE");else if("origin"===a)r.origin=t[a],i.origin=t[a];else if("range"===a){var o=t[a];(o="string"==typeof o?JSON.parse(o):o).forEach((function(e){if("between"==e.operator){var t=e.value.split(" ");r.Minimum=t[0],r.Maximum=t[2]}else r.AuthorizedValues?r.AuthorizedValues+=","+e.value:r.AuthorizedValues=e.value}))}else"valuetype"===a?r.IsMultivalue=t[a]&&"multival"==t[a]?n.get("VALUE_TYPE_TRUE"):n.get("VALUE_TYPE_FALSE"):"nls_isParametric"===a?r.attrIsParametric=t[a]:"classAttributeOrder"===a&&(r.classAttributeOrder=t[a]);null==r.displayAsEntered&&r.Dimensions&&(r.displayAsEntered=n.get("VALUE_TYPE_FALSE"))}return i.icons=[e.getWebappsAssetUrl("ClassificationEditor","icons/attributes.png")],i.grid=r,i.padgrid={"ds6w:leaf":"False","ds6w:root":"True"},i},convertExpandToSearchFormat:function(e,t){var i=[];return t.forEach((function(t){var r=!1;t.attributes&&t.attributes.forEach((function(t){"physicalid"===t.name&&t.value!=e&&(r=!0)})),r&&i.push(t)})),i},convertNavigateToSearchFormat:function(e){var t=[],i=e[0].outputs.GET_CONTENT;return i&&i.forEach((function(e){var i=[];for(var r in e)i.push({name:r,value:e[r]});t.push({attributes:i})})),t},convertNavigateToFlatFormat:function(e,t){var i=[];if(t.length<=0)return i;for(var r=t[0],a=r.input_object,n=r.outputs,o=e,s=0;o>0;o--){var l=n["GET_PARENT_"+o+"_LIBRARY"];l&&((l=l[0]).level=s++,i.push(l))}return i.push(a),i},getLibraryDepth:function(e){var t=e.results[0].attributes,i=[];return t.forEach((function(e){"classification"===e.name&&i.push(e.value)})),i.length+1},getPathsAndObjectsFromExpand:function(e){if(e&&!(e.length<=0)){for(var t=[],i={},r={},n={},o=0,l=e.length;o<l;++o){var d=e[o];if(d.attributes){for(var c,u,f=!0,p=0,g=d.attributes.length;p<g;++p)"physicalid"===d.attributes[p].name?(f=!1,u=d.attributes[p].value):"did"===d.attributes[p].name&&(c=d.attributes[p].value);f||(i[u]=d,r[c]=u)}else if(d.path)t.push(d.path);else if(d.Path)t.push(d.Path);else if(d.icon__default_thumbnail_2d)for(var m=0;m<d.icon__default_thumbnail_2d.length;m++)for(var C=d.icon__default_thumbnail_2d[m].did,b=0;b<C.length;b++){var y=[];y.push(d.icon__default_thumbnail_2d[m].icon),y.push(d.icon__default_thumbnail_2d[m].thumbnail_2d),n[C[b]]=y}}for(var h in i)for(var _,v=i[h],S=0;S<v.attributes.length;S++)if("did"===v.attributes[S].name){_=v.attributes[S].value,v.attributes.push({name:"icons",value:n[_]});break}for(var A in i){var D=i[A],E=s.convertToExaleadDataFormatFederated(D);i[A]=E}var T=1;a.isIndexedMode()&&(T=2);var w=[];for(o=0;o<t.length;++o){var L=t[o],P=[];for(p=0;p<L.length;p+=T)P.push(r[L[p]]);w.push(P)}return{paths:w,objects:i}}}};return s})),define("DS/ClassificationEditor/utils/Library_CSO",["DS/Selection/XSO","DS/Logger/Logger","DS/ClassificationEditor/service/LibraryTypeService","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUX/IPClassifyUXEvents","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/PADUtils/PADProbes","DS/IPClassifyUtil/IPClassifyUtility"],(function(e,t,i,r,a,n,o,s){"use strict";var l=e.singleton({name:"library_cso",_logger:null,_permissionValues:{isAuthorized:{readOnly:!1,permission:"Architect",isPermissionRestrictionEnabled:!0}},_currentLibrary:null,init:function(e){var i={areEquals:function(e,t){return e===t}};UWA.extend(i,e),this._parent(i),this._logger=t.getLogger(l);var r=this;this.onPostAdd((function(e){var t="CONTENT",i=e;UWA.is(e,"array")&&(e=e[0]),e&&UWA.is(e.getID,"function")&&e.getID()==r.getCurrentLibraryID()&&(t="TREE"),UWA.is(e)&&a.notifyLibrarySelected({context:t,selectedNode:e,allSelectNodes:i})}))},addInLibraryCSO:function(e,t){if(!UWA.is(e))throw new Error("No libraryNode specified");if(!UWA.is(t))throw new Error("No context specified");var l=o.createProbe("library_addInLibraryCSO");if("TREE"==(t="string"==typeof t||t instanceof String?t.toUpperCase():t.toString().toUpperCase())){var d=this;this.empty(!1);var c=this._currentLibrary;this._currentLibrary=e;var u=function(e,t){a.notifyCurrentLibraryChange({previousNode:e,currentNode:t}),d.add(t),l.end()};this._currentLibraryPath=[{id:e.id,type:i.getPLMTypeOfLibraryTreeNode(e),label:e.getLabel(),mxid:e.options.mxid}];var f=!1;if(i.inFamilyLibrary(e.plmType)){if(e.isVisible&&e.isVisible()&&e.getPath){var p=e.getPath();if(Array.isArray(p)&&p.length>=2&&p[0]&&"LibrarySection_AllLibraries"===p[0].plmType){this._currentLibraryPath=[];for(var g=1;g<p.length;g++){var m=p[g];this._currentLibraryPath.push({id:m.id,type:i.getPLMTypeOfLibraryTreeNode(m),label:m.getLabel()})}f=!0}}}else f=!0;f?u(c,e):r.getLibraryPathLength({ids:[e.id],onComplete:function(t){!t.results&&t.error&&(d._logger.warn("Unable to retrieve LibraryPath using Index/Search"),u(c,d._currentLibrary));var i=n.getLibraryDepth(t);if(1===i){var a={};a.id=e.id,a.type=e.plmType,a.label=e.options.label,d._currentLibrary&&a.id==d._currentLibrary.id?(d._currentLibraryPath=[],d._currentLibraryPath.push({id:a.id,type:a.type,label:a.label}),u(c,d._currentLibrary)):d._logger.log("LibraryPath returned by Index do not corresponds to the current Library")}else if(i>1){var o=i-1;r.getLibraryPath({depth:o,pid:e.id,isAuthoringMode:!s.isIndexedMode(),onComplete:function(e){var t=n.convertNavigateToFlatFormat(o,e.result);d._currentLibrary&&t[i-1].physicalid==d._currentLibrary.id&&(d._currentLibraryPath=[],t.forEach((function(e){d._currentLibraryPath.push({id:e.physicalid,type:e["ds6w:type"],label:e["ds6w:label"]})})),u(c,d._currentLibrary))},onFailure:function(e){d._logger.warn("Unable to retrieve LibraryPath using Index/Navigate"),u(c,d._currentLibrary)}})}},onFailure:function(e){d._logger.warn("Unable to retrieve LibraryPathLength using Index/Search"),u(c,d._currentLibrary)}})}else{this.empty(!1);var C=null;0===(C="array"==UWA.typeOf(e)?e:[e]).length?(null==this._currentLibrary&&(this._currentLibrary={noTree:!0,getType:function(){return"Exception"}}),this.add(this._currentLibrary),l.end()):(this.add(C),l.end())}},removeFromLibraryCSO:function(e){if(!UWA.is(e))throw new Error("No libraryNode specified");this.remove(e),0===this.getSelectedNodes().length&&e!=this._currentLibrary&&this.add(this._currentLibrary)},removeAllFromLibraryCSO:function(){this.empty(!0)},getCurrentLibrary:function(){return this._currentLibrary},getCurrentLibraryID:function(){var e=null;return this._currentLibrary&&this._currentLibrary.getID&&(e=this._currentLibrary.getID()),e},getCurrentLibraryPath:function(){var e=[];return this._currentLibraryPath&&this._currentLibraryPath.forEach((function(t){e.push({id:t.id,type:t.type,label:t.label})})),e},getSelectedNodes:function(){var e=[];return this.get()&&this.get().forEach((function(t){t.getIconUrl=function(){return""},e.push(t)})),e},getSelectedNodesID:function(){var e=[];return this.get()&&this.get().forEach((function(t){e.push(t.getID())})),e},getCAChangeAccessOnClass:function(e){return!!this.CAChangeAccess&&this.CAChangeAccess[e]},setCAChangeAccessOnClass:function(e,t){this.CAChangeAccess={},this.CAChangeAccess[e]=t},getPermissions:function(){return this._permissionValues},setPermissions:function(e){Object.assign(this._permissionValues,e)}});return l})),define("DS/ClassificationEditor/commands/ActionBar_AddToFavoritesCmd",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","DS/ClassificationEditor/utils/Library_CSO","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/service/LibraryTypeService"],(function(e,t,i,r,a,n){"use strict";return t.extend({labelTopBar:r.label_ActionBar_AddToFavorites,isInsert:!0,datas:{},init:function(t){this._parent(t,{});var o=this;i.onChange((function(){o._adaptStateToCurrentLibrary()})),this.onStateChange((function(){if(o.getState()){if(t=i.getCurrentLibrary()){s=t.getID(),l=t.getType(),d=t.options.label;if(s&&n.inFamilyLibrary(l))if(e.is(a.getTreeCont()))0==a.getTreeCont().isLibraryAmongFavoriteLibraries(s)&&a.getTreeCont().addFavorite({id:s,name:d})}o.labelTopBar=r.label_ActionBar_RemoveFromFavorites}else{var t;if(t=i.getCurrentLibrary()){var s=t.getID(),l=t.getType(),d=t.options.label;if(s&&n.inFamilyLibrary(l))if(e.is(a.getTreeCont()))if(1==a.getTreeCont().isLibraryAmongFavoriteLibraries(s))!1===a.getTreeCont().removeFavorite({id:s,name:d})&&o.setState(!0,!1)}o.labelTopBar=r.label_ActionBar_AddToFavorites}}))},_adaptStateToCurrentLibrary:function(){var t=i.getCurrentLibrary();if(t&&t.getID){var r=t.getID();if(e.is(a.getTreeCont())){var n=!1;a.getTreeCont().isLibraryAmongFavoriteLibraries(r)&&(n=!0),this.setState(n,!1)}}}})})),define("DS/ClassificationEditor/ActionBar/ClassificationCommandManager",["UWA/Class","DS/ApplicationFrame/CommandsManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/service/LibraryTypeService","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUX/IPClassifyUXEvents","DS/IPClassifyUXUtil/ActionBar/IPCommandManager","DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUtil/IPClassifyUtility","text!DS/ClassificationEditor/assets/ClassificationProbesCommandMapping.json","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],(function(e,t,i,r,a,n,o,s,l,d,c,u,f){"use strict";var p={},g=JSON.parse(u),m=[],C=["NewStringAttribute","NewIntegerAttribute","NewRealAttribute","NewBooleanAttribute","NewDateAttribute","NewDimentionalAttribute","NewStringAttribute_group","downloadCAT","ClassAttributesTools","EditAttributes","DeleteAttributes"],b=["AddExistingAttributes","ReorderAttributes","RemoveAttributes","ImportLibrary"],y=e.singleton(o,{noSizeToFit:["classificationLocation"],initialize:function(){var e=this;this.enableAllCommands(!1),a.onEmpty((()=>{e.enableAllCommands(!1)}));var t=new Promise((e=>{require(["text!DS/ClassificationEditor/assets/afr/ClassificationEditor.json"],e)}));return new Promise((e=>{t.then((t=>{var i={};if(t)for(var r in(i=JSON.parse(t)).headers){i.headers[r].ID=r}p=i.Rules,e(i)}))}))},revaluateContentValue:function(e,t){if(!0===e.CONTENT)return!0;if(!t.checkWhiteClick&&!t.isFavoriteNode&&t.isCtxMenu&&!1===e.CONTENT.ctxMenu)return!1;var i=!0;if(!1!==i&&e.CONTENT.filter){var r=e.CONTENT.filter;t.isCtxMenu&&r.ctxMenuRestictTo&&Array.isArray(r.ctxMenuRestictTo)&&(i=r.ctxMenuRestictTo.includes(t.plmType)),!1!==i&&r.ctxMenuOnly&&Array.isArray(r.ctxMenuOnly)&&(i=!r.ctxMenuOnly.includes(t.tab)||1==t.isCtxMenu)}return!1!==i&&1==e.CONTENT.favCtxMenuOnly&&(i=t.isCtxMenu&&!t.isMultiSelect&&t.isFavoriteNode),!1!==i&&(!0===e.CONTENT.FavContent?i=t.isFavSection:!1===e.CONTENT.FavContent&&(i=!t.isFavSection)),!1!==i&&(!0===e.CONTENT.RootLibraries?i=t.isRoot:!1===e.CONTENT.RootLibraries&&(i=!t.isRoot||1==t.isCtxMenu&&1==t.isFavoriteNode)),!1!==i&&(!0===e.CONTENT.Libraries?i=t.isLibrary:!1===e.CONTENT.Libraries&&(i=!t.isLibrary)),!1!==i&&(!0===e.CONTENT.FavNode?i=t.isFavoriteNode:!1===e.CONTENT.FavNode&&(i=!t.isFavoriteNode)),!1!==i&&1==t.isCtxMenu&&t.isFavoriteNode&&e.CONTENT&&!0===e.CONTENT.ctxFavOnMultiSel&&(i=!0),i},revaluateTreeValue:function(e,t){if(!0===e.TREE)return!0;if(!t.checkWhiteClick&&!t.isFavoriteNode&&t.isCtxMenu&&!1===e.TREE.ctxMenu)return!1;var i=!0;if(e.TREE.filter){var r=e.TREE.filter;t.isCtxMenu&&r.ctxMenuRestictTo&&Array.isArray(r.ctxMenuRestictTo)&&(i=r.ctxMenuRestictTo.includes(t.plmType)),!1!==i&&r.ctxMenuOnly&&Array.isArray(r.ctxMenuOnly)&&(i=!r.ctxMenuOnly.includes(t.tab)||1==t.isCtxMenu)}return!1!==i&&(!0===e.TREE.Sections?i=t.isSection:!1===e.TREE.Sections&&(i=!t.isSection)),!1!==i&&(!0===e.TREE.RootLibraries?i=t.isRoot:!1===e.TREE.RootLibraries&&(i=!t.isRoot)),!1!==i&&(!0===e.TREE.Libraries?i=t.isLibrary:!1===e.TREE.Libraries&&(i=!t.isLibrary)),!1!==i&&(!0===e.TREE.FavSection?i=t.isFavSection:!1===e.TREE.FavSection&&(i=!t.isFavSection)),!1!==i&&(!0===e.TREE.FavNode?i=t.isFavoriteNode:!1===e.TREE.FavNode&&(i=!t.isFavoriteNode)),i},getDisplayNameForCommand:function(e){var t=require("DS/Controls/TooltipModel"),i=require("DS/WebUAUtils/WebUAUtils"),r=new t;if(r.title=f.get("Menu.title"),r.shortHelp=f.get("Menu.shortHelp"),r.longHelp=f.get("Menu.longHelp"),!r.moreHelpCB){var a={helpid:"menu",content:{"menu.PanelHelp":"Lbc3DDashUAPanelMap/lbc3ddash-t-CreateAttributes.htm"}},n=i.getMoreHelpCallback(a);r.moreHelpCB=n}return r},_manageSwitchOfCommands:function(e,t,i,n){var o=!1,s=i&&!!t&&0===t.length;!e||t&&0!=t.length||s?t&&t.length>0&&(o=t[0].isFavorite):o=e.isFavorite;var d=l.getWidgetData().currentTab;0==l.getWidgetData().currentWidgetTab&&a._currentLibrary&&(r.isRootLibrary(a._currentLibrary.getType())||r.isSection(a._currentLibrary.getType()))&&(d=0);var c=l.getWidgetData().currentWidgetTab,u=l.getWidgetData().isEditMode,f=l.getWidgetData().isReadOnly,g=!1,y=!1,h=!1,_=!1,v=!1,S=!1;e&&(v="LibrarySection_favorite"==e.plmType,S="LibrarySection_AllLibraries"==e.plmType,h=r.isRootLibrary(e.plmType),_=r.isLibrary(e.plmType));var A=v||S,D=!1;t&&t.every((function(e){return g=g||r.isRootLibrary(e.plmType),y=y||r.isLibrary(e.plmType),D=D||"Busy"===e.plmType,!g||!y||!D}));var E=!0;if((v||D||(S||!e)&&t&&0===t.length)&&(E=!1),i||this.enableAllCommands(E),!D){var T={},w=Object.keys(p);n&&(w=n);var L={};L.isSection=A,L.isFavSection=v,L.isCtxMenu=i,L.isFavoriteNode=o,L.checkWhiteClick=s,L.tab=d;var P=a.getPermissions();return P.isAuthorized.isPermissionRestrictionEnabled&&("Expert"!=P.isAuthorized.permission&&"Specialist"!=P.isAuthorized.permission||(m=m.concat(C)),"Specialist"==P.isAuthorized.permission&&(m=m.concat(b))),w.forEach((r=>{var a=p[r];if(a){var n=t&&t.length>0||1==c,l=e&&1!=e.noTree&&(!n||void 0===a.CONTENT),C=!0;"object"==typeof a&&(C&&"edit"==a.WIDGET_MODE&&(C=u),!C||a.WIDGET_MODE&&"view"!=a.WIDGET_MODE||(C=!u||0==c),C&&null!=a.WIDGET_TAB&&(C=a.WIDGET_TAB==c),C&&a.TABS&&Array.isArray(a.TABS)&&(C=a.TABS.includes(d)),(C&&!1===a.TREE&&l||!1===a.CONTENT&&n)&&(C=!1),C&&s&&(C=1==a.white_click||a.white_click==e.plmType||a.white_click===d),C&&void 0!==a.multisel&&(C=!t||t.length<=1),C&&!1===a.NoSelection&&(C=t&&t.length>0),C&&i&&o&&!0!==a.ctxFavorite&&(C=t&&t.length>1&&1==a.CONTENT.ctxFavOnMultiSel),C&&!1===a.CATIAV6&&(C=!0!==widget.getValue("noCompass")),C&&!0===a.roleCheck&&(C=!f),C&&a.TREE&&l&&(L.plmType=e.plmType,L.isRoot=h,L.isLibrary=_,l=this.revaluateTreeValue(a,L)),C&&a.CONTENT&&n&&(L.plmType=t[0]?t[0].plmType:"Attribute",L.isRoot=g,L.isLibrary=y,L.isFavoriteNode=o,L.isCtxMenu=i,L.isMultiSelect=t&&t.length>1,n=this.revaluateContentValue(a,L)),C=C&&(!0===n||!0===l||null===n&&null===l||!1===n&&!1===l&&1==a.noSelection)),m.length>0&&m.includes(r)&&(C=!1);["ExpandAll","ExpandN","CollapseAll"].includes(r)&&o&&(C=!1),T[r]=C,i||this._switchCommand(r,C,a.type,i),i||"openWith"!==r||this.getModelEvents().publish({event:"build_openwith",data:{visible:C,nodes:n?t:[e]}})}})),m=[],T}},getCommand:function(e){var i=t.getCommands(e);return i=i||t.getCommandCheckHeader(e)},enableAllCommands:function(e){var i=t.getCommands();for(var r in i){var a=t.getCommand(r);UWA.is(a)&&a.enable&&(e?this._switchCommand(r,!0):this._switchCommand(r,!1))}},getModelEvents:function(){return s.getModelEvents()},updateCommands:function(e,t){if(t||(t=a.getCurrentLibrary()),i.getContent()&&i.getContent().getView().getPADTreeDocument()){r=(r=i.getContent().getView().getPADTreeDocument().getSelectedNodes())||(e?[e]:[]),this._parent(t,r)}else{var r=[];try{r=(r=i.getContent().getView().getPADTreeDocument().getSelectedNodes())||(e?[e]:[])}catch(e){}this._parent(t,r)}},launchCommand:function(e,t,i,r){let n=e;g&&g[e]&&(n=g[e]);"ContextualMenu"===r?"CreateNewClass"==e&&"Definition"==a.getCurrentLibrary()._options.usage?c.sendTrackerPageEvent("ClassificationWidget_contextual","Create Definition Class"):"CreateNewClass"==e&&"Standard"==a.getCurrentLibrary()._options.usage?c.sendTrackerPageEvent("ClassificationWidget_contextual","Create Categorization Class"):c.sendTrackerPageEvent("ClassificationWidget_contextual",n):"CreateNewClass"==e&&"Definition"==a.getCurrentLibrary()._options.usage?c.sendTrackerPageEvent("ClassificationWidget_iconBar","Create Definition Class"):"CreateNewClass"==e&&"Standard"==a.getCurrentLibrary()._options.usage?c.sendTrackerPageEvent("ClassificationWidget_iconBar","Create Categorization Class"):c.sendTrackerPageEvent("ClassificationWidget_iconBar",n),this._parent.apply(this,arguments)}});return y})),define("DS/ClassificationEditor/commands/LibraryCommands",["DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/Library_CSO","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ApplicationFrame/CommandsManager","DS/PADUtils/views/PADProgressBar","DS/WidgetServices/WidgetServices","text!DS/ClassificationEditor/assets/ClassificationProbesCommandMapping.json","DS/ClassificationEditor/ActionBar/ClassificationCommandManager"],(function(e,t,i,r,a,n,o,s,l){"use strict";JSON.parse(s);return{_endProgressBarListener:function(){var e=this;r.getContent().getView().addEvent("onCompleteRefreshNodes",(function(t){this.removeEvent("onCompleteRefreshNodes"),e._offProgressBar()}))},_offProgressBar:function(){if(0===n._counter)return null;n.off()},_commonError:function(t,i,r){console.error(t,r);var a=i;!UWA.is(r)||r instanceof Error||(a+="<br>"+r),e.displayNotification({message:a,className:"error"})},_startProgressBar:function(e){1===n._counter&&n.off(),n.on(e)},_nbItemsNotNull:function(e){var t,i=e.length,r=0;for(t=0;t<i;++t)e&&r++;return r},convertSystemError:function(e){return-1!=e.indexOf("No fromconnect access to business object")?i.error_no_fromconnect_onParent:(console.error("Unexpected Error:: "+e),i.error_unexpected)},extractMyErrorMessage:function(e,t,r){var a=e;return e&&"timeout"===e.type?a=i.msg_InfoAction_Timeout:t&&(r&&"application/json"===r["content-type"]?(t="string"==typeof t?JSON.parse(t):t).error&&t.error.message&&(a=t.error.message):a="User doesnt have Librarian Role"===t?i.error_no_LibrarianRole:"string"==typeof t&&0===t.indexOf("System Error:")?this.convertSystemError(t):t),a},RenameCmd:function(e,t){if("CONTENT"==t){var i=e.manager.layout.getColumnIndex("tree"),r=e.manager.layout.getCellsFromNodeModel(e.nodeModel)[i],a=e.manager.getEditionManager(r);a.onF2&&(e.manager.setActiveCell(r),a.onF2(r))}else{var n=e.manager.layout.getColumnIndex("tree");r=e.manager.layout.getCellIDFromCoordinates({rowID:e.rowID,columnID:n});e.manager.setCellInEdition(r)}},ExpandAllCmd:function(r,a){r.plmType;var n=[];"TREE"===a&&r?n.push(r):n=t.getSelectedNodes();var o=null;o=t.getCurrentLibrary(),n.length?n.forEach((function(e){null===e.options.children||e.expandAll()})):null===o?e.displayNotification({message:i.msg_warning_nocurrentlibrary,className:"warning"}):o.expandAll()},CollapseAllCmd:function(r,a){r.plmType;var n=[],o=t.getCurrentLibrary();"TREE"===a&&r?n.push(r):n=t.getSelectedNodes(),n.length?n.forEach((function(e){e.collapseAll()})):null===o?e.displayNotification({message:i.msg_warning_noselection,className:"warning"}):o.collapseAll()},ChangeMaturityCmd:function(e,t){var i=a.getCommand("MaturityHdr",r.getContent());i&&i.begin()},AccessRightCmd:function(e,t){var i=a.getCommand("ActionBar_AccessRightCmd",r.getContent());i&&i.begin()},Information:function(){var e=r.getContent()._infoPanelView;e&&(e._context.elements.padshell._isRightOpen||e._modelEv.publish({event:"information-panel-open"}))},RemoveFavoriteCmd:function(e,t){var i=e;if(console.log("  RemoveFavoriteCmd currentFavoriteTreeNode : ",i),i&&i.isFavorite){var a=i.getID(),n=i.options.label;console.log("  currentLibrary Id : ",a),a&&UWA.is(r.getTreeCont())&&r.getTreeCont().removeFavorite({id:a,name:n})}},AddExistingAttributesCmd:function(e,t){var i=a.getCommand("AddExistingAttributes",r.getContent());i&&i.begin()},RemoveAttributesCmd:function(e,t){var i=a.getCommand("RemoveAttributes",r.getContent());i&&i.begin()},GetContextualMenuForAttributes:function(e,i,r){var a=!0===(!!e.white_Click&&e.white_Click)?a=t.getCurrentLibrary():e.nodeModel;return void 0===a&&(a=e),Array.isArray(a)||(a=[a]),"CONTENT"===i?(r||(r={cellInfos:e,data:{event:{pageX:0,pageY:0}}}),Promise.resolve(l.getContextualMenu(a,!1,r))):Promise.resolve([])},GetContextualMenu:function(e,i,a){var n,o=!!e.white_Click&&e.white_Click,s=a?r.getContent().getView().getPADTreeDocument().getSelectedNodes():[];try{n=!0===o?n=t.getCurrentLibrary():s&&s.length>0?s:e.nodeModel}catch(e){n=void 0}return void 0===n&&(n=e),Array.isArray(n)||(n=[n]),a||(a={cellInfos:e,data:{event:{pageX:0,pageY:0}}}),l.getContextualMenu(n,"TREE"===i,a)},_addHiddenInput:function(e){var t=r.getContent().getView();UWA.createElement("a",{href:e,styles:{display:"hidden"}}).inject(t.elements.container).click()}}})),define("DS/ClassificationEditor/commands/ActionBar_DownloadCATNlsCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","DS/WidgetServices/WidgetServices","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],(function(e,t,i,r,a,n,o,s){"use strict";return t.extend({labelTopBar:e.i18n("Export Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},execute:function(){var e=this;n._startProgressBar(s.get("msg_info_downloadProgress")),e.disable(),i.downloadCatNls({onComplete:function(t){var i=document.createElement("a");i.href=window.URL.createObjectURL(t),i.download="CATNls.zip",i.dispatchEvent(new MouseEvent("click")),n._offProgressBar(),e.enable(),a.displayNotification({message:s.get("msg_info_downloadComplete"),className:"success"}),console.log("CatNls download complete")},onFailure:function(t,i,r){var o=s.get("msg_classificationattributes_webservicefailed")+": "+n.extractMyErrorMessage(t,i,r);a.displayNotification({message:o,className:"error"}),n._offProgressBar(),e.enable()}})},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/CtxCommands",["DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/PADUtils/PADContext"],(function(e,t,i){"use strict";return e.extend({execute:function(){i.get().ctxInfo;if("Information"===this.options.ID)t.Information()}})})),define("DS/ClassificationEditor/commands/ActionBar_ImportLibraryStructureCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADUtilsServices"],(function(e,t,i,r,a,n,o,s,l,d){"use strict";return t.extend({labelTopBar:e.i18n("Add Existing Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),this.importPanel=null},beginExecute:function(){},execute:function(){var e=this;require(["DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUXUtil/FileImportPanel","DS/ClassificationEditor/utils/Library_CSO"],(function(t,n,d){var c=d.getCurrentLibrary(),u=t.getModelEvents();e.importPanel=new n({panelHeaderName:l.importLibraryPanelHeader,panelHeaderIcon:{iconName:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-import",fontIconFamily:WUXManagedFontIcons.Font3DS},modelEvents:u,validateFile:e.validateFile,downloadErrorReport:e.downloadErrorReport,closePanelEvent:"AddExistingAttributesCmd/Views/showInWidgetBody",importFileEvent:"ImportLibraryStructureXML/SelectedFileContent",validationInProgressMsg:l.validateLibrary_loading});var f=[];f.push(u.subscribe({event:"ImportLibraryStructureXML/SelectedFileContent"},(function(t){t.isValidate||a._startProgressBar(l.importLibrary_loading),e.disable(),i.importLibraryStructure({fileContent:t.selectedFileContent,isValidate:!1,onComplete:function(i){var n=i?JSON.parse(i):void 0;if(n&&n.ErrorDescription){var d=n.ErrorDescription;n.MissingAttributes&&(e.downloadErrorReport(d,t.fileName,n.MissingAttributes),d=l.msg_importLibrary_failedSeeReport+" ImportLibrary_ErrorReport.txt"),r.displayNotification({title:l.get("msg_importLibrary_failed"),message:d,className:"error"})}else{o.setAuthoringMode("authoring",l.msg_importLibrary_success);var u=s.getTreeCont().getView()._rootNodeLibraries;u.isExpanded()&&(s.getTreeCont().performOperationOnNode(u,"collapse"),s.getTreeCont().performOperationOnNode(u,"expand")),n&&n.LibraryMxID&&u.isSelected()&&s.getContent().loadContentAndSelect(c)}a._offProgressBar(),e.enable()},onFailure:function(t,i,n){var o=a.extractMyErrorMessage(t,i,n);o=l.msg_importLibrary_failed+o,t&&t.message&&t.message.includes("NetworkError")?r.displayNotification({title:l.msg_error_MoveInLibraryErrorMessage,subtitle:l.msg_error_server_disconnect_unexpectedly,className:"error"}):r.displayNotification({message:o,className:"error"}),a._offProgressBar(),e.enable()},onTimeout:function(t,i){r.displayNotification({message:l.command_importLibrary+": "+l.msg_InfoAction_Timeout,className:"warning"}),a._offProgressBar(),e.enable()}})}))),f.push(u.subscribe({event:"AddExistingAttributesCmd/Views/showInWidgetBody"},(function(e){!0===e.restore&&f.forEach((function(e){u.unsubscribe(e)}))})))}))},validateFile:function(e){var t=this;return new Promise((function(r){var n={};i.importLibraryStructure({fileContent:e.selectedFileContent,isValidate:!0,onComplete:function(i){var a=i?JSON.parse(i):void 0;if(a&&a.ErrorDescription){var o=a.ErrorDescription;a.MissingAttributes&&(t.downloadErrorReport(o,e.fileName,a.MissingAttributes),o=l.msg_importLibrary_failedSeeReport+" ImportLibrary_ErrorReport.txt"),n.success=!1,n.message=l.msg_importLibrary_validationFailed+o}else n.success=!0,n.message=l.msg_importLibrary_validationSucess;r(n)},onFailure:function(e,t,i){var o=a.extractMyErrorMessage(e,t,i);n.success=!1,n.message=l.msg_importLibrary_validationFailed+o,r(n)}})}))},downloadErrorReport:function(e,t,i){var r="#############################################\n\t".concat(l.msg_importLibrary_errorReportHeader).concat("\n#############################################\n-----------------------------------------------\n").concat(l.msg_importLibrary_errorReportFile).concat(t).concat("\n-----------------------------------------------\n").concat(l.msg_importLibrary_errorReportMsg).concat(e).concat(": \n");i.forEach((function(e){r=r.concat(e).concat("\n")})),d.downloadfile(r,"ImportLibrary_ErrorReport.txt","text/plain")},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/ClassificationIconBar_RenameCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],(function(e,t,i,r,a){"use strict";return t.extend({labelTopBar:e.i18n("Rename"),datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=r.getSelectedNodes(),t="",n={},o="";if(e[0].pathId){t="TREE";var s=(n=a.getTreeCont().getView()._libraries_TreeView).layout.getColumnIndex("tree");o=n.layout.getCellIDFromCoordinates({rowID:e[0]._rowID,columnID:s})}else{t="CONTENT";s=(n=a.getContent().getView().getPADTreeListView().getManager()).layout.getColumnIndex("tree");o=n.layout.getCellsFromNodeModel(e[0])[s]}var l=n.getCellInfosAt(o);l.manager||(l.manager=n),i.RenameCmd(l,t)},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/ActionBar_DeleteAttributesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/IPClassificationAttributes/utils/AttributesUtil","DS/IPClassificationAttributes/dataprovider/DataProvider","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUXUtil/IPClassifyLoaderGlobal","UWA/Promise","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],(function(e,t,i,r,a,n,o,s,l,d,c,u,f){"use strict";return t.extend({labelTopBar:e.i18n("Delete Class Attribute"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var t=this,n=u.getContent().getView().getPADTreeDocument().getSelectedNodes(),s=[];if(n.length>0){var l=[],p=[];if(n.forEach((function(t){"Attribute"===t.plmType&&("false"==t.options.grid.values.isInDico?p.push(e.is(t.options.label)?t.options.label:t.options.grid.Name):(s.push(t),t.getLabel=()=>t.options.grid.Name,l.push(e.is(t.options.grid.Name)?t.options.grid.Name:t.id)))})),0==l.length&&p.length>0)return void c.displayNotification({message:f.msg_delete_attributesNotPossibleHere+"\n"+f.msg_delete_attributesNotPossibleSuffix,className:"warning"});var g={confirmationBoxText:f.msg_singleAttributeCheckbox,titleLabel:f.title_delete+" - "+l[0],warningMessage:f.replace(f.msg_deleteMultipleAttributeWarning,{attributeName:l[0]}),moreInfo:f.msg_deleteSingleAttributeMoreInfo1+"\n"+f.msg_deleteSingleAttributeMoreInfo2};g.enableConfirmationBox=!0,p.length>0&&(g.moreInfo=g.moreInfo+"\n\n"+f.msgNoteDeleteAttr),p.length,l.length>1&&(t.createDataForDGV(g,s),g.showDGV=!0,g.titleLabel=f.replace(f.TitleAttributesDelete,{number:l.length}),g.confirmationBoxText=f.msg_multipleAttributeCheckbox,g.warningMessage=f.msg_deleteMultipleAttributeWarning,g.moreInfo=f.msg_deleteMultipleAttributeMoreInfo1+"\n"+f.msg_deleteMultipleAttributeMoreInfo2),d.confirmDialog(g,(function(){var e={attributes:l};o.addComponentsToLoad("global",{deleteAttributes:f.msg_deleteattr}),a.removeClassificationInterfaces(e).then((function(e){var n="string"==typeof e?JSON.parse(e):e,s=r.buildObjectToDelete(l);a.deleteClassAttributes(s).then((function(e){o.removeComponentToLoad("global","deleteAttributes"),e="string"==typeof e?JSON.parse(e):e;var t=Object.keys(r.extractArributesNode(e)),s=l.filter((function(e){return t.includes(e)}));if(a.reloadCache(),l.length>5)u.getContent().RefreshProductStructure=!0,u.getContent().loadContentAndSelect();else for(var d=0;d<l.length;d++)s.includes(l[d])||u.getContent()._libraryContentView.removeNodeInContent(l[d]);0===u.getContent()._libraryContentView.options.model.getAllDescendants().length&&u.getContent().getView()._addPlaceHolder(),s&&s.length>0?c.displayNotification({message:f.confirmation_delete_attributesPrefix+"<br>"+s,className:"error"}):c.displayNotification({message:f.replace(f.msg_info_attributeDeleted,{number:l.length}),className:"success"}),n.CONFLICTED_WITH&&n.CONFLICTED_WITH.length>0&&a.restoreSybolicNames(n.CONFLICTED_WITH).then((function(e){c.displayNotification({message:f.replace(f.msg_info_attributeSymbUpdated,{number:n.CONFLICTED_WITH.length}),className:"infos"})}),(function(e){i._commonError("DeleteAttributes",f.msg_error_creatingClassAttrSymb,e)}))}),(function(e){o.removeComponentToLoad("global","deleteAttributes"),e&&"timeout"==e.type?c.displayNotification({title:f.deleteTimeout,subtitle:f.msg_deleteTimoutForAttribute,className:"warning"}):i._commonError("DeleteAttributes",f.msg_error_deleteClassAttributes,e),t.enable()}))}),(function(e){if(o.removeComponentToLoad("global","deleteAttributes"),e&&"timeout"==e.type){let e=f.msg_deleteTimoutForInterfaces;l>1&&(e=f.msg_deleteTimoutForInterfacesMultiple),c.displayNotification({title:f.deleteFail,message:e,className:"error"})}else i._commonError("DeleteAttributes",f.msg_error_deleteClassAttributes,e);t.enable()}))}))}else c.displayNotification({message:f.msg_warning_noAttributeSelected,className:"warning"})},createDataForDGV:function(e,t){var i=[],r=[{dataIndex:"Tree",text:f.Name},{dataIndex:"Type",text:f.Type},{dataIndex:"Predicate",text:f.column_Predicates},{dataIndex:"Title",text:f.Title}];f.cannotBeDeleted,f.toBeDeleted;let a="nls_"+widget.lang.toUpperCase();t.forEach((function(e){var t={};t.Tree=e.options.grid.Name,t.Type=e.options.type,t.Predicate=e.options.grid.Predicates,t.Title=e.options.grid[a]?e.options.grid[a]:e.options.grid.nls_EN,i.push(t)})),e.cols=r,e.data=i},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/ActionBar_CollapseAllCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/utils/Library_CSO"],(function(e,t,i,r){"use strict";return t.extend({labelTopBar:e.i18n("Collase All"),isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=r.getSelectedNodes();if(e.length){var t=e[0];i.CollapseAllCmd(t,"CONTENT")}else{var a=r.getCurrentLibrary();i.CollapseAllCmd(a,"TREE")}},endExecute:function(){}})})),define("DS/ClassificationEditor/utils/ClassificationEditorKeyboardListener",["UWA/Core","UWA/Class","UWA/Event","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUX/events/IPClassifyEvents","DS/Logger/Logger"],(function(e,t,i,r,a,n,o,s,l,d){var c=t.extend({name:"ClassificationEditorKeyboardListener",init:function(e){this._parent(e),this._logger=d.getLogger(c),this._onKeyDown_binded=this._onKeyDown.bind(this)},startObservingKeyboard:function(){e.Element.addEvent.call(document,"keydown",this._onKeyDown_binded)},_onKeyDown:function(e){var t=this,a=i.whichKey(e);e.ODTENVKeyName&&(a=e.ODTENVKeyName);var d,c,u,f=function(){var e=document.activeElement;return!(!e||"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName)};switch(a){case"ctrl+a":d=a,c="SelectAll",(u=n.getCommand(c))&&u.isEnabled()?f()?t._logger.log("Info : '"+d+"' key pressed in INPUT field, no command launched"):(u.begin(),i.stop(e)):t._logger.log("Info : '"+d+"' key pressed, but command '"+c+"' is disabled");break;case"alt+return":l.notifyInfoExpand();break;case"ctrl+f":var p=r.getIdCardCont();p._isSearchAvailable()&&(p.switchSearch(!0),i.stop(e));break;case"f2":if(f())t._logger.log("Info : '"+a+"' key pressed in INPUT field, no command launched");else{var g=o.getSelectedNodes(),m=o.getCurrentLibrary();if(1!=(Array.isArray(g)?g.length:0))break;var C=g[0];if(C&&s.inFamilyLibrary(C.plmType)&&r.getTreeCont().getView().isTreeNodeModelInstance(C))if(m.getID()==C.getID()){var b=r.getTreeCont();b&&b.switchLibraryTreeNodeLabelToWriteView&&b.switchLibraryTreeNodeLabelToWriteView(m)}else{var y=r.getContent();y&&y.switchLibraryTreeNodeLabelToWriteView&&y.switchLibraryTreeNodeLabelToWriteView(C)}else t._logger.log("Info : '"+a+"' key pressed but selected element is not a Library, no command launched")}}}});return c})),define("DS/ClassificationEditor/commands/ActionBar_ExportLibraryStructureCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADUtilsServices"],(function(e,t,i,r,a,n,o){"use strict";return t.extend({labelTopBar:e.i18n("Add Existing Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},execute:function(){var e=this;require(["DS/ClassificationEditor/utils/Library_CSO"],(function(t){var s,l,d,c="No Library Selected",u=!1;if(t.getCurrentLibrary()&&(s=(l=t.getCurrentLibrary()).getID(),c=l.getLabel(),d=l.plmType||l.getType()),"RootLibrary"===d)u=!0;else if("LibrarySection_AllLibraries"==d||"LibrarySection_favorite"==d){var f=t.getSelectedNodes(),p=f.length;if(1===p&&"RootLibrary"===f[0].plmType)u=!0,s=f[0].id,c=f[0].getLabel();else{var g=n.msg_exportLibrary_selectLib;p>1&&(g=n.msg_exportLibrary_selectOneLib),r.displayNotification({message:g,className:"warning"})}}else r.displayNotification({message:n.msg_exportLibrary_selectLib,className:"warning"});u&&(a._startProgressBar(n.msg_exportLibrary_loading+c),e.disable(),i.exportLibraryStructure({pid:s,onComplete:function(t,i,s,l){var d=t?JSON.parse(t):void 0;d&&d.fileContent?o.downloadfile(d.fileContent,d.fileName,"text/xml"):d&&d.ErrorDescription?r.displayNotification({title:n.msg_exportLibrary_failure,subtitle:d.ErrorDescription,className:"error"}):r.displayNotification({message:n.replace(n.msg_exportLibrary_failed,{libraryname:c}),className:"error"}),a._offProgressBar(),e.enable()},onFailure:function(t,i,o){if(t&&t.message&&t.message.includes("NetworkError"))r.displayNotification({title:n.msg_error_server_disconnect_unexpectedly_title,subtitle:n.msg_error_server_disconnect_unexpectedly_SubTitle,className:"error"});else{var s=n.replace(n.msg_exportLibrary_failed,{libraryname:c});i&&"User doesnt have Librarian Role"===i&&(s=n.replace(n.error_exportLibrary,{libraryname:c})+"<br>"+n.error_no_LibrarianRole),r.displayNotification({message:s,className:"error"})}a._offProgressBar(),e.enable()},onTimeout:function(t,i){r.displayNotification({message:n.command_exportLibrary+": "+n.msg_InfoAction_Timeout,className:"warning"}),a._offProgressBar(),e.enable()}}))}))},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/ActionBar_ExpandAllCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/utils/Library_CSO"],(function(e,t,i,r){"use strict";return t.extend({labelTopBar:e.i18n("Expand All"),isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=r.getSelectedNodes();if(e.length){var t=e[0];i.ExpandAllCmd(t,"CONTENT")}else{var a=r.getCurrentLibrary();i.ExpandAllCmd(a,"TREE")}},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/ActionBar_RemoveAttributesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/service/ClassificationEditorWebService"],(function(e,t,i,r){"use strict";return t.extend({labelTopBar:e.i18n("Remove Class Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),require(["DS/ClassificationEditor/commands/LibraryCommands"],(function(e){}))},beginExecute:function(){},execute:function(){var t=this;require(["DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],(function(a,n,o,s,l){var d=a.getCurrentLibrary();if(d){var c=d.getID(),u=a.getCAChangeAccessOnClass(c);if(!u||"true,true"!==u&&"false,true"!==u)i._commonError("RemoveAttributes",l.command_removeAttribute+": ",l.error_noChangeAccessOnCA);else{var f=a.getSelectedNodes();if(f.length>0){var p=[],g=[],m=[],C=[];if(f.forEach((function(t){"Attribute"===t.plmType&&("Inherited"===t.options.origin?(g.push(e.is(t.getLabel())?t.getLabel():t.id),m.push(e.is(t.getLabel())?t.getLabel():t.id)):"UserAG"===t.options.origin?(g.push(e.is(t.getLabel())?t.getLabel():t.id),C.push(e.is(t.getLabel())?t.getLabel():t.id)):(t.getLabel=()=>t.options.grid.Name,p.push(e.is(t.options.grid.Name)?t.options.grid.Name:t.id)))})),p.length>0){l.confirmation_remove_attributesSure;g.length>0&&(g.length<6?l.confirmation_remove_attributesPrefix+"\n"+g+"\n\n"+l.confirmation_remove_attributesSuffix:l.replace(l.confirmation_remove_attributesNumber,{number:g.length}));var b={confirmationBoxText:l.msg_checkBoxSingleRemove,titleLabel:l.command_removeAttribute+" - "+p[0],moreInfo:l.msg_removeMoreInfo,deleteButtonLabel:l.command_removeAttribute,warningMessage:l.replace(l.msg_singleRemoveWarning,{attributeName:p[0],className:d._options.label})};function _(t,i,r){var a=[],n=[{dataIndex:"Tree",text:l.Name},{dataIndex:"Type",text:l.Type},{dataIndex:"Predicate",text:l.column_Predicates},{dataIndex:"Title",text:l.Title}],o=l.cannotBeRemoved,s=l.canBeRemoved;i.forEach((function(t){var i={};i.Tree=e.is(t.options.label)?t.options.label:t.options.grid.Name,i.Type=t.options.type,i.isDeletable=r&&r.includes(i.Tree)?o:s,i.Predicate=t.options.grid.Predicates,i.Title=t.options.grid["ds6w:label"]?t.options.grid["ds6w:label"]:t.options.grid.Name,a.push(i)})),t.cols=n,t.data=a}p.length>1&&(b.warningMessage=l.replace(l.msg_multipleRemoveWarning,{className:d._options.label}),b.moreInfo=l.msg_removeMoreMultipleInfo,b.titleLabel=l.replace(l.titleRemoveAttributes,{number:p.length}),b.confirmationBoxText=l.msg_checkBoxMultipleRemove),b.enableConfirmationBox=!0,(g.length>1||p.length>1||g.length+p.length>1)&&(_(b,f,g),b.showDGV=!0),n.confirmDialog(b,(function(){i._startProgressBar(l.remove_attributes_loading),t.disable(),r.removeClassAttributes({pid:c,attributes:p,onComplete:function(e){var t={},r=JSON.parse(e),a=r?r.attributes:[];if(a&&a.length>0)for(var n=0;n<a.length;n++)t[a[n]]=!0;for(var c=0;c<p.length;c++){var u=p[c];t[u]||s.getContent()._libraryContentView.removeNodeInContent(u)}s.getContent().RefreshProductStructure=!0,s.getContent().loadContentAndSelect(d),0===s.getContent()._libraryContentView.options.model.getAllDescendants().length&&s.getContent().getView()._addPlaceHolder(),i._offProgressBar(),a&&a.length>0?o.displayNotification({message:l.confirmation_remove_attributesPrefix+"<br>"+a,className:"error"}):o.displayNotification({message:l.replace(l.msg_info_attributeremoved,{number:p.length,libraryname:d.options.label}),className:"success"})},onFailure:function(e,r,a){var n=i.extractMyErrorMessage(e,r,a);i._offProgressBar(),t.enable(),i._commonError("RemoveAttributes",l.msg_error_removeClassAttributes,n)}})}))}else{var y=l.msg_warning_noAttributeSelected,h=l.msg_error_removeClassAttributes;g.length>0&&(y=l.msg_remove_attributesNotPossibleSuffix,h=l.msg_remove_attributesNotPossibleHere,m.length>0&&C.length<1?(y=l.msg_nonRemovableParent_title,h=l.msg_nonRemovableParent):m.length<1&&C.length>0&&(y=l.msg_nonRemovableAttributeGroup_title,h=l.msg_nonRemovableAttributeGroup),o.displayNotification({title:h,message:y,className:"warning"}))}}else o.displayNotification({message:l.msg_warning_noAttributeSelected,className:"warning"})}}else o.displayNotification({message:l.msg_warning_nocurrentlibrary,className:"warning"})}))},endExecute:function(){}})})),define("DS/ClassificationEditor/utils/ClassificationEditorUtil",["UWA/Utils","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/PADUtils/PADSettingsMgt","DS/IPClassifyUtil/IPClassifyPreference","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUX/IPClassifyUXEvents"],(function(e,t,i,r,a,n,o,s,l,d,c,u,f,p){var g=null;let m=null,C=null;return getStatusPref=function(){if(!g){var e=widget.getValue("view_status");g={},e&&(g=function(e){var t=l.jsonUnzip(e),i=null;try{i=JSON.parse(t)}catch(e){i=null}return i}(e))}return g||{}},saveStatus=function(e,t){var i,r=getStatusPref();r[e]=t,widget.setValue("view_status",(i=r,l.jsonZip(JSON.stringify(i))))},getStatus=function(e){return getStatusPref()[e]},{CONTENT_TABS:{CLASSES:0,CLASSIFICATION_ATTRIBUTES:1,LIBRARIES:0,EXCEPTIONS:1},CURRENT_TAB_VALUE:0,shouldBeEditable:function(e){return!1},prohibitedOperations:{},updatedNodes:{},saveBlockedNodes:{blockSave:!1,attributeToMod:new Set},oldNodeValues:{},getProhibitedOperations:function(){return this.prohibitedOperations},getOldNodeValues:function(){return this.oldNodeValues},getUpdatedNodes:function(){return this.updatedNodes},emptyProhibitedOperations:function(){this.prohibitedOperations={}},emptyOldNodeValues:function(){this.oldNodeValues={}},emptyUpdatedNodes:function(){this.updatedNodes={}},storeOldNodeValues:function(e,t){this.oldNodeValues[e]=t},cleanValues:function(e){var t={};for(let i in e){let r=e[i],a={};for(let e in r)"value"!=e&&(a[e]=null!=r[e]?r[e]:"");Object.keys(a).length>0&&(t[i]=a)}return t},uppendChangestoList:function(e){if(e&&e.Name){let i=this.updatedNodes[e.Name];if(!i){var t=e.attrType.charAt(0).toUpperCase()+e.attrType.slice(1);i={Name:e.Name,Owner:"ClassificationAttributes",Nature:"Attribute",Type:"Real"==t?"Double":t},"String"==t&&(i.MaxLength="0")}e.nameNLS&&!i.NameNLS&&(i.NameNLS=e.nameNLS),Object.keys(e.nlsRanges).length>0&&(i.AuthorizedValuesNLS=e.nlsRanges),null!=e.defaultValue&&null!=e.defaultValue&&e.defaultValueChanged&&(i.Default=e.defaultValue?e.defaultValue:"",i.HasDefault="Yes",e.isDefaultValueSaveBlocked?(this.saveBlockedNodes.blockSave=!0,this.saveBlockedNodes.attributeToMod.add(e.Name)):this.saveBlockedNodes.attributeToMod.size>0&&this.saveBlockedNodes.attributeToMod.delete(e.Name));let r=e.authorizedValues?e.authorizedValues.split(";"):[],a=e.originalRange?e.originalRange:[];(r.length>0||a.length>0)&&(i.AuthorizedValues||(i.AuthorizedValues=[],i.HasRangeDefined="Yes"),r.forEach((function(e){var t="";if(0!=(t=a.includes(e)?"":"append:"+e).trim().length&&!i.AuthorizedValues.includes(t.trim())){let r="drop:"+e;if(i.AuthorizedValues.includes(r.trim())){let e=i.AuthorizedValues.indexOf(r.trim());-1!==e&&i.AuthorizedValues.splice(e,1)}i.AuthorizedValues.push(t.trim())}})),a.forEach((function(e){var t="";if(0!=(t=r.includes(e)?"":"drop:"+e).trim().length&&!i.AuthorizedValues.includes(t.trim())){let r="append:"+e;if(i.AuthorizedValues.includes(r.trim())){let e=i.AuthorizedValues.indexOf(r.trim());-1!==e&&i.AuthorizedValues.splice(e,1)}i.AuthorizedValues.push(t.trim())}}))),this.updatedNodes[e.Name]=i}},onNodeModelUpdate:function(e){var s=e.data.nodeModel,l=this;if(1==f.getWidgetData().currentWidgetTab){if(s){var c=this.updatedNodes[s.options.grid.Name],u=s.options.grid.Name;if(c||(c={Name:u,Nature:"Attribute"}),e.data.attributes)for(let t in e.data.attributes)if("DefaultValue"==t){var p=e.data.attributes[t];try{if("date/time"==e.data.nodeModel.options.grid.values.type||"timestamp"==e.data.nodeModel.options.grid.values.type){let e=new Date(p.toDateString()+" 10:00:00 GMT");p=Math.floor(e.getTime()/1e3).toString()}c.Default=p,c.HasDefault="Yes",e.data.nodeModel.resetDefaultValue&&(e.data.nodeModel.resetDefaultValue=!1,delete c.Default,delete c.HasDefault),this.saveBlockedNodes.attributeToMod.size>0&&this.saveBlockedNodes.attributeToMod.has(u)&&this.saveBlockedNodes.attributeToMod.delete(u)}catch(e){console.log("date format error :"+c.Default)}}else if("AuthorizedValues"==t){let i=e.data.attributes[t]?e.data.attributes[t].split(","):[];if(1==s.setAuthorizedValuesFromForm)s.setAuthorizedValuesFromForm=!1;else if(i.length>0){c.AuthorizedValues=[];var g=l.oldNodeValues[s.options.grid.Name];if(g){var b=g.split(","),y=l.prohibitedOperations.removeRangeNotAllowed;if(y||(y=l.prohibitedOperations.removeRangeNotAllowed=[]),b.some((function(e){return!i.includes(e)})))y.includes(s.options.grid.Name)||y.push(s.options.grid.Name);else{var h=y.indexOf(s.options.grid.Name);y.splice(h,1),0==y.length&&(l.prohibitedOperations={},i.forEach((function(e){c.AuthorizedValues.push("add:"+e)})),c.AuthorizedValues.length>0&&(c.HasRangeDefined="Yes"))}}}}else if(t.startsWith("nls_")){c.NameNLS||(c.NameNLS={en:s.options.grid.nls_EN,fr:s.options.grid.nls_FR,de:s.options.grid.nls_DE,ja:s.options.grid.nls_JA,ko:s.options.grid.nls_KO,ru:s.options.grid.nls_RU,zh:s.options.grid.nls_ZH});let i=t.split("_")[1].toLowerCase();c.NameNLS[i]=e.data.attributes[t]}else"DisplayAsEntered"==t&&(c.DisplayAsEntered=e.data.attributes[t])}(c.NameNLS&&Object.keys(c.NameNLS).length>0||"Yes"==c.HasRangeDefined||"Yes"==c.HasDefault||c.DisplayAsEntered)&&(this.updatedNodes[s.options.grid.Name]=c)}else{if(!i.inFamilyLibrary(s.plmType))return;var _=s._lastUpdateTime?s._lastUpdateTime:0,v=Date.now()-_;if(s._lastUpdateTime=Date.now(),console.log("lastUpdateTime : "+_+", elapsedTime : "+v),0!==_&&v<300)return;if(s._resetting)return void(s._resetting=!1);var S=s.getID(),A=s.options.label,D=s.options.oldLabel;if(void 0===D&&(D=""),A===D)return;A&&A.trim&&(A=A.trim());var E=!0;if(0==A.trim().length&&(r.displayNotification({message:n.get("msg_error_name_empty"),className:"error"}),E=!1),E)if(s.isFavorite){if(UWA.is(o.getTreeCont())){var T={id:S,name:D};if(e.data.attributes.label===e.data.previousAttributes.label)return;if(m===S&&C===A)return;m=S,C=A,o.getTreeCont().renameFavorite(T,A,s)}}else t.setProperties({pid:S,plmType:s.plmType,properties:{title:A},onComplete:function(e){var t;(D+A).length>150?"RootLibrary"===s.plmType?t=n.get("msg_library_rename_successful"):"Library"===s.plmType&&(t=n.get("msg_class_rename_successful")):"RootLibrary"===s.plmType?t=n.replace(n.get("msg_info_renameLibrary"),{name1:D,name2:A}):"Library"===s.plmType&&(t=n.replace(n.get("msg_info_renameClass"),{name1:D,name2:A})),d.setAuthoringMode("authoring",t),d.updateRefreshTime(),s.options.oldLabel=A,a.notifyLibraryRename({oldNode:s,newLabel:A});var i={},r=[];r.push(S),i.modified=r,i.fromRenameOp=!0,o.getContent()._libraryContentView.getPADTreeDocument().refreshNodeById(i)},onFailure:function(e,t,i){var a=n.replace(n.get("msg_error_rename"),{name1:D});t&&t.errorMsg&&(t.errorMsg.contains("'business object' does not exist")&&(a=n.msg_error_renameDeletedClass),t.errorMsg.contains("No 'modify' access on Attribute")&&(a=n.msg_error_renameActiveClass)),r.displayNotification({message:a,className:"error"}),s._resetting=!0,setTimeout((function(){s.withTransactionUpdate((function(){this.setLabel(D)})),s._resetting=!1}))}});else s.withTransactionUpdate((function(){this.setLabel(D)}))}},getCurrentSecurityContextAndLibraryData:function(e){var t=s.getCurrentLibrary(),r=c.getSetting("pad_security_ctx"),a=widget.getValue("pad_tenant"),n={From:"ClassificationEditor",LibraryID:null,LibraryType:null,IsInDeletedItems:!1,Timestamp:Date.now(),Tenant:a,SecurityContext:r};return t&&(i.inFamilyLibrary(t.plmType)||e)&&(n.LibraryID=t.getID(),n.LibraryType=t.getType()),n},sortColumn:function(e,t){var r=i.inFamilyLibrary(e.plmType),a=i.inFamilyLibrary(t.plmType);return r&&!a?-1:!r&&a?1:0},setRightPanelStatus:function(e){saveStatus("rightPanel",e)},setLeftPanelStatus:function(e){saveStatus("leftPanel_"+this.CURRENT_TAB_VALUE,e)},getRightPanelStatus:function(){var e={rightPanelState:!1,size:300},t=getStatus("rightPanel");return new Promise((function(i){i(t||e)}))},getLeftPanelStatus:function(){var e={leftPanelState:!0,isWelcomePanelCollapsed:!1},t=getStatus("leftPanel_"+this.CURRENT_TAB_VALUE);return new Promise((function(i){i(t||e)}))},sortAttributeColumn:function(e,t,i){var r,a=e.options.grid[i.order_field]?e.options.grid[i.order_field]:"",n=t.options.grid[i.order_field]?t.options.grid[i.order_field]:"";return"classAttributeOrder"!==i.order_field?(r=a.localeCompare(n),"asc"===i.order_by?r:-r):"asc"===i.order_by?parseInt(a)-parseInt(n):parseInt(n)-parseInt(a)},setCurrentTab:function(e){u.set("lib_currentTab",{CurrentTab:e},!0,!1),this.CURRENT_TAB_VALUE=e},getCurrentTab:function(){let e;return u.get("lib_currentTab",(function(t){e=t&&t.hasOwnProperty("CurrentTab")?t.CurrentTab:0}),!0),this.CURRENT_TAB_VALUE=e,e}}})),define("DS/ClassificationEditor/dataProvider/LibraryContentDataProvider",["UWA/Class","UWA/Class/Promise","DS/PADUtils/PADProbes","DS/WebappsUtils/WebappsUtils","DS/SearchDictionaryAccess/SearchDictionaryAccessAPI","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyPreference","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/ClassificationEditor/utils/LibrarySearch","DS/ClassificationEditor/commands/LibraryCommands","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassificationAttributes/utils/EventHandler","DS/IPClassifyUtil/IPClassifyUtility","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/IPClassifyUX/IPClassifyUXEvents"],(function(e,t,i,r,a,n,o,s,l,d,c,u,f,p,g,m,C,b,y,h,_,v,S){"use strict";var A={FAVORITES:"ipcFavoriteList_v1",getFavorites:function(){return C.getTenantAwarePreferenceName(this.FAVORITES)}},D=null,E={order_field:"Name",order_by:"asc"},T=e.singleton({getObjectsForRefresh:function(e,i){var r=this;return new t((function(t){var a=[];i.forEach((function(e){e.isDynamic&&-1===a.indexOf(e.dataIndex)&&a.push(e.dataIndex)})),o._performFetchQuery({ids:e,dynamicAttrs:a,isAuthoringMode:!0,onComplete:function(e){var i=[];e.results&&e.results.length>0&&e.results.forEach((function(e){let t=n.convertToExaleadDataFormatFederated(e);r.setIconsForLibraries(t),i.push(t)})),t(i)},onFailure:function(){console.error("Unable to update Content root node, Error in getting content Properties"),t(null)}})}))},setIconsForLibraries:function(e,t){var i,a=e.options?e.options:e,n=a.thumbnail;"General Class"==a.type&&"Definition"==a.grid["ds6w:classificationUsage"]&&((i=[]).push(r.getWebappsAssetUrl("LibraryEditor","icons/categorizationIcons/GeneralClass_small.png")),n.includes("I_GeneralClass")&&(a.thumbnail=r.getWebappsAssetUrl("LibraryEditor","icons/categorizationIcons/GeneralClass_Tile.png")),a.icons=i);"General Library"==a.type&&"Standard"==a.grid["ds6w:classificationUsage"]&&((i=[]).push(r.getWebappsAssetUrl("LibraryEditor","icons/categorizationIcons/GeneralLibrary_small.png")),n.includes("I_GeneralLibrary")&&(a.thumbnail=r.getWebappsAssetUrl("LibraryEditor","icons/categorizationIcons/GeneralLibrary_Tile.png")),a.icons=i)},checkTypesForActiveThumbnails:function(e){return!0},refreshOnLBCDelete:function(e){_.setAuthoringMode("authoring",null),_.updateRefreshTime();var t=g.getSelectedNodes(),i=!1;i=!!(t&&t[0]&&t[0].pathId);for(var r=e.itemsRemoved,a=0;a<r.length;a++){var n=r[a];(t=g._currentLibrary)._parentNode&&"LibrarySection_favorite"==t._parentNode.plmType&&"RootLibrary"==t.plmType?t=b.getTreeCont().getView()._rootNodeFavorite:"LibrarySection_AllLibraries"==t.plmType||"RootLibrary"==t.plmType&&n==t.id?t=b.getTreeCont().getView()._rootNodeLibraries:"Library"==t.plmType&&n!=t.id||i&&"RootLibrary"!=t.plmType&&(t=t._parentNode),t.select(),b.getTreeCont().performOperationOnNode(t,"collapse"),b.getTreeCont().performOperationOnNode(t,"expand"),h.notifyRemoveNodeInContent(n),0===b.getContent()._libraryContentView.options.model.getAllDescendants().length&&b.getContent().getView()._addPlaceHolder()}},getExceptionTabContents:function(e){return E.order_field=e.order_field,E.order_by=e.order_by,new t((function(e,t){var r=i.createProbe("probeFindClassificationAttrs");o.fetchDataForClassAttributesTab({onComplete:function(t){var i=JSON.parse(t),o=i.attribute;o||(o=i.Attribute);var s=[],l={};function d(e){var t={},i=[];e.forEach((function(e){e.predicate&&!e.predicate.startsWith("ds6wg")&&(e.nls_predicate=l[e.predicate]?l[e.predicate]:"");var t=n.convertAttributeFromDicoToExaleadDataFormat(e);t.plmType="Attribute",i.push(t)})),t.results=i;var r={};return r.nhits=i.length,r.nresults=i.length,r.next_start="0 0",t.infos=r,m&&m.setAttributeNameList(e),t}o.forEach((function(e){e.predicate&&!e.predicate.startsWith("ds6wg")&&s.push(e.predicate)})),a.get6wResourcesInfo(s.join(","),{tenantId:C.getTenantId(),lang:widget.lang,onComplete:function(t){var i=t.vocabularyElementNLSInfo;for(let e in i)l[i[e].uri]=i[e].nlsName;var a=d(o);e({results:a.results,infos:a.infos,facets:{}}),r.end()},onFailure:function(t){console.log(" Predicate NLS could not be fetched ");var i=d(o);e({results:i.results,infos:i.infos,facets:{}}),r.end()}})},onFailure:function(e,i,a){t({results:[],facets:{}}),f.displayNotification({message:p.get("msg_classificationattributes_webservicefailed")+": "+i,className:"error"}),r.end()}})}))},_getAttributesTabContents:function(e){return E.order_field=e.order_field,E.order_by=e.order_by,new t((function(t,r){var s=i.createProbe("probeFetchClassificationAttrs");o.getClassificationAttributes({classid:e.pid,onComplete:function(i){var r=JSON.parse(i),o=r.attribute;o||(o=r.Attribute),g.setCAChangeAccessOnClass(e.pid,r.changeaccess);var l={},d=[];function c(e){var t={},i=[],r=[],a=[];e.forEach((function(e,t){e.predicate&&!e.predicate.startsWith("ds6wg")&&(e.nls_predicate=l[e.predicate]?l[e.predicate]:""),e.classAttributeOrder="NA"===e.classAttributeOrder?"NA":parseInt(e.classAttributeOrder);var i=n.convertAttributeToExaleadDataFormat(e);i.plmType="Attribute","NA"!==e.classAttributeOrder?a.push(i):r.push(i)})),r.sort(((e,t)=>e.grid["ds6w:label"]-t.grid["ds6w:label"])),a.sort(((e,t)=>e.grid.classAttributeOrder-t.grid.classAttributeOrder)),a.forEach((function(e,t){e.grid.classAttributeOrder=t+1,i.push(e)})),r.forEach((function(e){i.push(e)})),t.contents=i;var o={};return o.nhits=i.length,o.nresults=i.length,o.next_start="0 0",t.infos=o,t}if(o.forEach((function(e){e.predicate&&!e.predicate.startsWith("ds6wg")&&d.push(e.predicate)})),d.length>0)a.get6wResourcesInfo(d.join(","),{lang:widget.lang,tenantId:C.getTenantId(),onComplete:function(e){var i=e.vocabularyElementNLSInfo;for(let e in i)l[i[e].uri]=i[e].nlsName;var r=c(o);t({contents:r.contents,infos:r.infos,facets:{}}),s.end()},onFailure:function(e){console.log(" Predicate NLS could not be fetched ")}});else{var u=c(o);t({contents:u.contents,infos:u.infos,facets:{}}),s.end()}},onFailure:function(e,t,i){var a=p.get("msg_classificationattributes_webservicefailed")+": "+u.extractMyErrorMessage(e,t,i);r({msg:a}),s.end()}})}))},_getDefaultTabContents:function(e){return new t((function(t,i){o.content({pid:e.pid,mxid:e.mxid,searchQuery:e.searchQuery,isExactSearch:e.isExactSearch,selectedType:e.selectedType,dynamicattributes:e.dynamicattributes,filters:e.filters,start:e.start,next_start:e.next_start,order_field:e.order_field,order_by:e.order_by,grid:e.grid,isAuthoringMode:!C.isIndexedMode(),onComplete:function(i){if((i="string"==typeof i?JSON.parse(i):i).result)return r=n.convertNavigateToSearchFormat(i.result),void t({contents:a(r),infos:i.infos,facets:i.facets});var r=function(e,t){var i=[];null!=e&&e.forEach((function(e){var r=!1;e.attributes&&e.attributes.forEach((function(e){"physicalid"===e.name&&e.value!=t&&(r=!0)})),r&&i.push(e)}));return i}(i.results,e.pid);function a(e){var t=[];return e.forEach((function(e){var i=n.convertToExaleadDataFormatFederated(e),r=e.attributes;i.plmType=s.getPlmTypeFromContentDetails(r),i.Documentlocked=e.Documentlocked,i.publishOnConnect=e.publishOnConnect,t.push(i)})),t}t({contents:a(r),infos:i.infos,facets:i.facets})},onFailure:function(e,t){i({err:e,serverErr:t,msg:p.msg_error_contentnotavailable})}})}))},isColumnSortableInAuthoring:function(e){return!(!y||!y._widgetData||1!=y._widgetData.currentWidgetTab)||e},getObjectContents:function(e){return D=e.widgetData,new t((function(t,i){var r=e.widgetData;!r||!r.currentTab&&!r.currentWidgetTab||r.currentTab===d.CONTENT_TABS.CLASSES&&r.currentWidgetTab===d.CONTENT_TABS.LIBRARIES||r.currentWidgetTab===d.CONTENT_TABS.LIBRARIES&&r.currentWidgetTab===d.CONTENT_TABS.LIBRARIES&&"RootLibrary"==g.getCurrentLibrary().getType()?T._getDefaultTabContents(e).then((function(e){t(e)}),(function(e){i(e)})):1===r.currentTab&&0===r.currentWidgetTab?T._getAttributesTabContents(e).then((function(e){t(e)}),(function(e){i(e)})):1===r.currentWidgetTab&&T.getExceptionTabContents(e).then((function(e){t(e)}),(function(e){i(e)}))}))},getPaginatedSectionContents:function(e){return D=e.widgetData,new t((function(t,i){o.roots({filters:e.filters,start:e.start,next_start:e.next_start,order_field:e.order_field,order_by:e.order_by,isAuthoringMode:!C.isIndexedMode(),onComplete:function(e){var i=[];e.results&&e.results.forEach((function(e){var t=n.convertToExaleadDataFormatFederated(e),r=e.attributes;t.plmType=s.getPlmTypeFromContentDetails(r),t.Documentlocked=e.Documentlocked,t.publishOnConnect=e.publishOnConnect,i.push(t)})),t({results:i,infos:e.infos,facets:e.facets})},onFailure:function(){i()}})}))},getPreferenceSectionContents:function(e){return D=e.widgetData,new t((function(t,i){o.favourites({ids:e.ids,onComplete:function(e){for(var i=(e="string"==typeof e?JSON.parse(e):e).results?e.results:[],r=[],a=0;a<i.length;++a){var o=s.getPlmTypeFromContentDetails(i[a].attributes),l=n.convertToExaleadDataFormatFederated(i[a]);l.plmType=o,r.push(l)}t(r)},onFailure:function(e){i(e)}})}))},getContextualMenu:function(e,t,i,r){return i&&i.currentTab&&i.currentTab!==d.CONTENT_TABS.CLASSES?i.currentTab===d.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES?u.GetContextualMenuForAttributes(e,t,r):[]:u.GetContextualMenu(e,t,r)},comparator:function(e,t){return 1==y.getWidgetData().currentWidgetTab?d.sortAttributeColumn(e,t,E):D&&D.currentTab&&D.currentTab!==d.CONTENT_TABS.CLASSES?D.currentTab===d.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES?d.sortAttributeColumn(e,t,E):void 0:d.sortColumn(e,t)},getPreferenceSectionName:function(){return A.getFavorites()},isValidType:function(e){return s.inFamilyLibrary(e)},isValidTypeForPlaceholder:function(e,t){return!0},showClassTabs:function(){return 0===y.getWidgetData().currentWidgetTab},getFilterOptions:function(){return 1===y.getWidgetData().currentWidgetTab?{Type:{filterId:"string",filterModel:{condition1:{type:"contains",filter:""}}}}:void 0},toEnableTreeColumnEdit:function(e,t){return 1!==t.currentWidgetTab&&(!t||!t.currentTab||t.currentTab===d.CONTENT_TABS.CLASSES)},isSection:function(e){return"LibrarySection_favorite"==e||"LibrarySection_AllLibraries"==e},isPreferenceSection:function(e){return"LibrarySection_favorite"==e},isPaginatedSection:function(e){return"LibrarySection_AllLibraries"==e},shouldBeEditable:function(e){return d.shouldBeEditable(e)},onContentUpdate:function(e){return d.onNodeModelUpdate(e)},onAddColumn:function(e){c.filterExcludeListColumns(e).length>0&&(c.setPredicates(e),c.addToPredicateHeaderMap(e))},onRemoveColumn:function(e){c.removePredicates(e),c.removeFromPredicateHeaderMap(e)},onResetColumn:function(e,t){c.removeAllPredicates(),c.setPredicates(e,t)},setColumnNames:function(e,t){c.setPredicates(e,t)},initColumns:function(e){c.initPredicateToHeaderMap(e)},getPageTabs:function(){var e=[];return e.push({label:p.classes_tab,isSelected:0==y._widgetData.currentTab,value:d.CONTENT_TABS.CLASSES,icon:{iconName:"library-class",fontIconFamily:WUXManagedFontIcons.Font3DS}}),e.push({label:p.classification_attributes_tab,isSelected:1==y._widgetData.currentTab,value:d.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES,icon:{iconName:"attributes",fontIconFamily:WUXManagedFontIcons.Font3DS}}),e},getTabsVisOnSelectionChange:function(){if(!g.getCurrentLibrary())return!1;var e=g.getCurrentLibrary().getType();return!this.isSection(e)&&"RootLibrary"!==e},reloadAfterSort:function(){return 1!=y.getWidgetData().currentWidgetTab},getColumnConfig:function(e){return!e||!e.currentTab&&!e.currentWidgetTab||e.currentTab===d.CONTENT_TABS.CLASSES&&e.currentWidgetTab===d.CONTENT_TABS.LIBRARIES?[{dataIndex:"ds6w:classificationUsage"},{dataIndex:"ds6w:type"},{dataIndex:"ds6w:status"},{dataIndex:"ds6w:description"},{dataIndex:"ds6w:responsible"},{dataIndex:"ds6w:modified"},{dataIndex:"ds6w:created"},{dataIndex:"ds6w:identifier"},{dataIndex:"ds6w:reservedBy"}]:[{dataIndex:"Name",text:p.column_Name},{dataIndex:"Type",text:p.column_Type},{dataIndex:"classAttributeOrder",text:p.CLASS_Attribute_Order},{dataIndex:"Description",text:p.column_Description},{dataIndex:"DefaultValue",text:p.column_DefaultValue},{dataIndex:"hasDefault",text:p.hasDefault},{dataIndex:"Dimensions",text:p.column_Dimensions},{dataIndex:"displayAsEntered",text:p.column_DisplayAsEntered},{dataIndex:"Predicates",text:p.column_Predicates},{dataIndex:"AuthorizedValues",text:p.column_Authorized_Values},{dataIndex:"attrIsParametric",text:p.column_Is_Parametric},{dataIndex:"IsMultivalue",text:p.column_Is_Multivalue},{dataIndex:"Minimum",text:p.column_Minimum},{dataIndex:"Maximum",text:p.column_Maximum},{dataIndex:"isInDico",text:p.existInDictionary}]},isDNDSupported:function(){return!0},showContentPlaceholder:function(){return!0},doSelect:function(){return 1!=y.getWidgetData().currentWidgetTab},hasWelcomePanel:function(){return 1!=y.getWidgetData().currentWidgetTab},hasLibrarianRole:function(){return new t((function(e,t){o.hasLibrarianRole({onComplete:function(t){var i=JSON.parse(t);g.setPermissions(i),e({readOnly:JSON.parse(t).isAuthorized.readOnly,permission:JSON.parse(t).isAuthorized.permission,isPermissionRestrictionEnabled:JSON.parse(t).isAuthorized.isPermissionRestrictionEnabled})},onFailure:function(){t({readOnly:!1})}})}))},getLibraryControl:function(){return b},getLibraryEditorUtil:function(){return d},getLibraryTypeService:function(){return s},getStatus:function(e,t){return!1===e.contains(".")&&(e=t&&t.contains(" ")?t+"."+e.toUpperCase():t&&t.contains("_")?t+"."+(e=e.replace(" ","_")).toUpperCase():t&&e.contains(" ")?t+"."+(e=e.replace(" ","")):t+"."+e),e}});return T})),define("DS/ClassificationEditor/commands/ActionBar_SaveUpdatesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUX/utils/IPClassifyWidgetData","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/PADUtils/PADContext","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassificationAttributes/dataprovider/DataProvider","DS/IPClassifyUXUtil/IPClassifyLoaderGlobal","DS/ClassificationEditor/commands/LibraryCommands","DS/IPClassificationAttributes/utils/AttributesUtil","text!DS/IPClassificationAttributes/assets/IPClassificationAttributesProps.json","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],(function(e,t,i,r,a,n,o,s,l,d,c,u,f,p){"use strict";return t.extend({labelTopBar:e.i18n("Save Changes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=o.getProhibitedOperations();if(Object.keys(e).length>0){var t="";return Object.keys(e).forEach((function(i){t=r[i]+"<br>"+e[i].join("<br>")})),void f.displayNotification({message:t,className:"error"})}var g=o.getUpdatedNodes();if(0!=Object.keys(g).length){var m=o.saveBlockedNodes;if(m.attributeToMod&&m.attributeToMod.size>0)f.displayNotification({message:"Please update default value for the following attribute : "+Array.from(m.attributeToMod).join(", "),className:"error"});else{o.saveBlockedNodes.blockSave=!1;var C=JSON.parse(u);Object.keys(g).length>=1&&l.addComponentsToLoad("global",{modifyAttributes:r.msg_updateattr}),s.updateClassAttributes(c.formatObjectToSend(g)).then((function(e){e="string"==typeof e?JSON.parse(e):e,l.removeComponentToLoad("global","modifyAttributes");var t=e.Dictionary.Interfaces[C.interface_name].Attributes,d=[];if(Object.keys(g).forEach((function(e){var i=g[e],r=t[e],a=t[e].Type;Object.keys(i).forEach((function(t){let n=i[t],o=r[t];if("boolean"===(a=a.toLowerCase())&&"Default"==t&&("Yes"!=o&&"No"!=o||(o="Yes"==o)),"NameNLS"==t&&o)Object.keys(n).forEach((function(t){n[t]==o[t]||d.includes(e)||d.push(e)}));else if("AuthorizedValues"==t&&o){"double"==a&&(o=o.map((e=>Number(e).toString()))),n.every((function(e){var t=e,i="";return e.indexOf(":")>-1&&(t=e.split(":")[1],i=e.split(":")[0]),"double"==a&&(t=Number(t).toString()),"append"==i?o.includes(t):"drop"==i?!o.includes(t):void 0}))||d.includes(e)||d.push(e)}else"AuthorizedValuesNLS"==t&&o?Object.keys(n).forEach((function(t){let i=n[t];Object.keys(i).forEach((function(r){"value"==r||i[r]==o[t][r]||d.includes(e)||d.push(e)}))})):"Default"==t&&(""==n&&null==o?console.log("Removed default value : "):o&&n!=o&&!d.includes(e)&&d.push(e))}))})),d&&d.length>0)f.displayNotification({message:r.confirmation_update_attributesPrefix+"<br>"+d,className:"error"});else{f.displayNotification({message:r.replace(r.msg_info_attributeUpdated,{number:Object.keys(g).length}),className:"success"});var c=n.get(),u=c.options.views?c.options.views.datagridview:void 0;if(u){var m=u.options.dgvLayout.getLeafColumns();m&&Array.isArray(m)&&m.forEach((function(e){e.toggleToEdit&&!0===e.toggleToEdit&&(e.getCellEditableState=function(e){return!1},e.getCellTypeRepresentation=function(e){return"string"}),"AuthorizedValues"===e.dataIndex&&(e.getCellValue=function(e){if(e.nodeModel)return{label:e.nodeModel.getAttributeValue("AuthorizedValues"),url:""}})})),u.options.dgv.treeDocument.acceptChanges(),u.options.dgv.treeDocument.setUseChangeTransactionMode(!1),u.options.dgv.getModel().updateRenderedColumn("AuthorizedValues",{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1},!0),p.getContent().RefreshProductStructure=!0,s.reloadCache().then((function(){p.getContent().loadContentAndSelect()}),(function(e){p.getContent().loadContentAndSelect()})),o.emptyOldNodeValues(),o.emptyUpdatedNodes(),o.emptyProhibitedOperations(),i.setIsEditModeEnabled(!1),a.updateCommands()}}}),(function(e){l.removeComponentToLoad("global","modifyAttributes"),d._commonError("SaveUpdatesCmd",r.msg_error_updateClassAttributes,e)}))}}else f.displayNotification({message:r.noAttributetoUpdate,className:"warning"})},endExecute:function(){}})})),define("DS/ClassificationEditor/dataProvider/ClassificationTabBarProvider",["UWA/Class","DS/ClassificationEditor/utils/ClassificationEditorUtil","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],(function(e,t,i,r){"use strict";return e.singleton({getTabBars:function(){var e=[],r={};r.tabOptions={label:i.library_tab,value:t.CONTENT_TABS.LIBRARIES,icon:{iconName:"library",fontIconFamily:WUXManagedFontIcons.Font3DS}},r.showTreeView=!0,r.plmType="LibrarySection_AllLibraries",e.push(r);var a={};return a.tabOptions={label:i.exception_tab,value:t.CONTENT_TABS.EXCEPTIONS,icon:{iconName:"attributes-cog",fontIconFamily:WUXManagedFontIcons.Font3DS}},a.showTreeView=!1,a.plmType="LibrarySection_AllExceptions",e.push(a),e},updateLayoutOnTabChange:function(e){t.setCurrentTab(e),r.getWidgetRefresh()({reInitialize:!0})}})})),define("DS/ClassificationEditor/commands/ActionBar_CancelUpdatesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUX/utils/IPClassifyWidgetData","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/PADUtils/PADContext","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassificationAttributes/dataprovider/DataProvider","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],(function(e,t,i,r,a,n,o,s,l,d,c){"use strict";return t.extend({labelTopBar:e.i18n("Undo Edit"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=this,t=s.getUpdatedNodes();0==Object.keys(t).length?(d.displayNotification({message:a.noCangesToUndo,className:"warning"}),e.cancelChanges()):i.launch({title:a.command_CancelUpdates,content:a.confirmation_cancel_attributesSure,confirmLabel:a.confirmation_ok},(function(){e.cancelChanges()}))},cancelChanges:function(){var e=o.get(),t=e.options.views?e.options.views.datagridview:void 0;if(t){var i=t.options.dgvLayout.getLeafColumns();i&&Array.isArray(i)&&i.forEach((function(e){e.getCellEditableState=function(e){return!1},e.toggleToEdit&&!0===e.toggleToEdit&&(e.getCellTypeRepresentation=function(e){return"string"}),"AuthorizedValues"===e.dataIndex&&(e.getCellValue=function(e){if(e.nodeModel){let t=e.nodeModel.getAttributeValue("AuthorizedValues"),i=s.getOldNodeValues()[e.nodeModel.options.grid.Name];return i&&(t=i,e.nodeModel.options.grid.AuthorizedValues=t),{label:t,func:"",module:""}}})})),t.options.dgv.treeDocument.cancelChanges(),t.options.dgv.treeDocument.setUseChangeTransactionMode(!1),t.options.dgv.getModel().updateRenderedColumn("AuthorizedValues",{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1},!0),r.setIsEditModeEnabled(!1),c.getContent().RefreshProductStructure=!1,l.reloadCache().then((function(){c.getContent().loadContentAndSelect()}),(function(e){c.getContent().loadContentAndSelect()})),s.emptyOldNodeValues(),s.emptyUpdatedNodes(),n.updateCommands(),s.emptyProhibitedOperations(),l.setSavedNlsRanges(void 0,{})}},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/ActionBar_EditAttributesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/PADUtils/PADContext","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassificationAttributes/utils/EventHandler","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],(function(e,t,i,r,a,n,o,s){"use strict";return t.extend({labelTopBar:e.i18n("Edite Class Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){n.emptyUpdatedNodes();var e=r.get(),t=e.options.views?e.options.views.datagridview:void 0;if(t){try{var o=t.options.dgv.layout.getColumnIndex("AuthorizedValues"),l=t.options.dgv.getRowModelLength();if(l)for(var d=0;d<l;d++){var c=t.options.dgv.layout.getCellIDFromCoordinates({rowID:d,columnID:o}),u=t.options.dgv.getCellInfosAt(c);u&&n.storeOldNodeValues(u.nodeModel.options.grid.Name,u.nodeModel.getAttributeValue("AuthorizedValues"))}}catch(e){}var f=t.options.dgvLayout.getLeafColumns();f&&Array.isArray(f)&&f.forEach((function(e){e.getCellEditableState=function(t){try{if("false"==t.nodeModel.options.grid.values.isInDico)return!1;if("DefaultValue"===e.dataIndex)return"TRUE"==t.nodeModel.options.grid.values.hasDefault}catch(e){console.log(e)}return!0===e.toggleToEdit},"AuthorizedValues"===e.dataIndex&&(e.getCellTypeRepresentation=function(e){return"url"},e.getCellValue=function(e){if(e.nodeModel)return e.nodeModel.options.grid.AuthorizedValues&&e.nodeModel.options.grid.AuthorizedValues.length>0&&"true"==e.nodeModel.options.grid.values.isInDico?{label:e.nodeModel.getAttributeValue("AuthorizedValues"),func:"valuesClickAction",module:"DS/IPClassificationAttributes/utils/EventHandler"}:{label:e.nodeModel.getAttributeValue("AuthorizedValues"),func:"",module:""}},e.setCellValue=function(e,t){if(e.nodeModel){var i={grid:{}};t.hasOwnProperty("label")&&(i.grid.AuthorizedValues=t.label),e.nodeModel.updateOptions(i)}}),"DefaultValue"===e.dataIndex&&(e.getCellTypeRepresentation=function(e){if(e.nodeModel&&e.nodeModel.options.grid.values.type){var t=e.nodeModel.options.grid.values.type;return"boolean"==t.toLowerCase()||e.nodeModel.options.grid.AuthorizedValues?"string":"date/time"==t.toLowerCase()||"timestamp"==t.toLowerCase()?"date":"real"==t.toLowerCase()?"double":e.nodeModel.options.grid.values.type.toLowerCase()}return"string"},e.getCellSemantics=function(e){if(e.nodeModel&&e.nodeModel.options.grid.values.type){if("boolean"===e.nodeModel.options.grid.values.type.toLowerCase())return{possibleValues:["false","true"]};var t=e.nodeModel.options.grid.AuthorizedValues;if(t)return{allowResetToUndefinedByUIFlag:!0,possibleValues:t.split(",")}}return{}}),"DisplayAsEntered"===e.dataIndex&&(e.getCellEditableState=function(e){try{if("false"==e.nodeModel.options.grid.values.isInDico)return!1}catch(e){console.log(e)}let t=!1;(window.createDisplayAsEnteredAttribute||widget.createDisplayAsEnteredAttribute||window[0]&&window[0].createDisplayAsEnteredAttribute)&&(t=!0);let i=!0;try{i=null!=e.nodeModel.options.grid.Dimension}catch(e){i=!1}return t=!(!i||!t),t},e.getCellSemantics=function(e){if(e.nodeModel&&e.nodeModel.options.grid.values.type){e.nodeModel.options.grid.values.type;return{possibleValues:[{label:s.get("VALUE_TYPE_TRUE"),value:"Yes"},{label:s.get("VALUE_TYPE_FALSE"),value:"No"}]}}})})),t.options.dgv.treeDocument.setUseChangeTransactionMode(!0),t.options.dgv.getModel().updateRenderedColumn("AuthorizedValues",{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1},!0),i.setIsEditModeEnabled(!0),a.updateCommands()}},endExecute:function(){}})})),define("DS/ClassificationEditor/dataProvider/LibraryTreeDataProvider",["UWA/Class","UWA/Class/Promise","DS/ClassificationEditor/service/LibraryTypeService","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/ClassificationEditor/commands/LibraryCommands","DS/WebappsUtils/WebappsUtils","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/IPClassifyAlert"],(function(e,t,i,r,a,n,o,s,l,d,c){"use strict";var u={FAVORITES:"ipcFavoriteList_v1",getFavorites:function(){return d.getTenantAwarePreferenceName(this.FAVORITES)}};return e.singleton({expandObject:function(e){return new t((function(t,i){a.libraries({pid:e.pid,mxid:e.mxid,children:e.children,isExpandAll:e.isExpandAll,isAuthoringMode:!d.isIndexedMode(),onComplete:function(i){i="string"==typeof i?JSON.parse(i):i,d.isIndexedMode()&&(i.results=d.convertExpandV2toV1(i.results));var r=n.getPathsAndObjectsFromExpand(i.results);if(null==r)t({paths:[],objects:[]});else if(r.paths&&r.paths.length<=0){var a=[];i.results&&(a=n.convertExpandToSearchFormat(e.pid,i.results));var o=[];for(var s in r.objects)r.objects.hasOwnProperty(s)&&s!==e.pid&&o.push(s);t({objects:function(e){var t=[];e&&e.length>0&&e.forEach((function(e){var i=n.convertToExaleadDataFormatFederated(e);"Standard"==i.grid["ds6w:classificationUsage"]?i.icons=[{iconName:"library-class"}]:i.icons=[{iconName:"library-class-filled"}],i.plmType="Library",t.push(i)}));return t}(a),childIds:o,paths:r.paths})}else{for(var s in r.objects)r.objects.hasOwnProperty(s)&&("Standard"==r.objects[s].grid["ds6w:classificationUsage"]?r.objects[s].icons=[{iconName:"library-class"}]:r.objects[s].icons=[{iconName:"library-class-filled"}],r.objects[s].plmType="Library");t({paths:r.paths,objects:r.objects})}},onFailure:function(e){i(e)}})}))},getRootSectionContents:function(e){return new t((function(e,t){a.roots({fetchAll:!0,isAuthoringMode:!d.isIndexedMode(),onComplete:function(t){var i=(t="string"==typeof t?JSON.parse(t):t).results?t.results:[],r=[],a=[];i.forEach((function(e){var t=n.convertToExaleadDataFormatFederated(e);"Standard"==t.grid["ds6w:classificationUsage"]?t.icons=[{iconName:"library-lined"}]:t.icons=[{iconName:"library"}],t.plmType="RootLibrary",a.push(t),r.push(t.physicalid)})),e({objects:a,ids:r,infos:t.infos})},onFailure:function(e){t(e)}})}))},getObjectPathLength:function(e){return new t((function(t,i){a.getLibraryPathLength({ids:e.ids,onComplete:function(e){if(e.results){var r=n.getLibraryDepth(e);t(r)}else c.displayNotification({message:l.msg_error_BOdeleted,className:"error"}),i()},onFailure:function(e){that._logger.log("WebService getObjectPathLength Err : "+e),i(e)}})}))},getObjectPath:function(e){return new t((function(t,i){a.getLibraryPath({depth:e.depth,pid:e.pid,isAuthoringMode:!d.isIndexedMode(),onComplete:function(i){var r=n.convertNavigateToFlatFormat(e.depth,i.result);t(r)},onFailure:function(e){that._logger.log("WebService getObjectPath Err : "+e),i(e)}})}))},getPreferenceSectionContents:function(e){return new t((function(t,r){a.favourites({ids:e.ids,onComplete:function(r){for(var a=(r="string"==typeof r?JSON.parse(r):r).results?r.results:[],o={},s=0;s<a.length;++s){var l=i.getPlmTypeFromContentDetails(a[s].attributes),d=n.convertToExaleadDataFormatFederated(a[s]);d.plmType=l,"RootLibrary"===d.plmType?"Standard"==d.grid["ds6w:classificationUsage"]?d.icons=[{iconName:"library-lined"}]:d.icons=[{iconName:"library"}]:"Standard"==d.grid["ds6w:classificationUsage"]?d.icons=[{iconName:"library-class"}]:d.icons=[{iconName:"library-class-filled"}],o[d.physicalid]=d}var c=[];e.ids.forEach((e=>{o[e]&&c.push(o[e])})),t(c)},onFailure:function(e){r(e)}})}))},comparator:function(e,t){var i,r="LibrarySection_favorite"===e.getParent().plmType;if(r)return null;if(e.isRoot()&&t.isRoot()||r)return null;if("date"!==widget.getValue("sortMode"))return e.options.label.localeCompare(t.options.label);try{i=new Date(e.options.created)>new Date(t.options.created)?1:new Date(e.options.created)<new Date(t.options.created)?-1:0}catch(r){i=e.options.created<t.options.created?-1:1}finally{return i}},shouldBeEditable:function(e){return r.shouldBeEditable(e)},getContextualMenu:function(e){return o.GetContextualMenu(e,"TREE")},onContentUpdate:function(e){return r.onNodeModelUpdate(e)},isValidType:function(e){return i.inFamilyLibrary(e)},isSection:function(e){return"LibrarySection_favorite"==e||"LibrarySection_AllLibraries"==e},isTreeNodeEditable:function(e){if(e&&e.nodeModel){var t=e.nodeModel.plmType;return!("LibrarySection_favorite"==t||"LibrarySection_AllLibraries"==t)}return!1},isPreferenceSection:function(e){return"LibrarySection_favorite"==e},getSectionsData:function(){var e=[],t={};t.label=l.name_Section_FavoriteLibraries,t.icon=s.getWebappsAssetUrl("ClassificationEditor","icons/libraryfavorites.png"),t.plmType="LibrarySection_favorite",e.push(t);var i={};return i.label=l.name_Section_AllLibraries,i.icon=s.getWebappsAssetUrl("ClassificationEditor","icons/librarysectionall.png"),i.plmType="LibrarySection_AllLibraries",i.defaultSelectedSection=!0,e.push(i),e},getPreferenceSectionName:function(){return u.getFavorites()},getSecurityContextAndData:function(){return r.getCurrentSecurityContextAndLibraryData()},getObjectNotVisiblemessage:function(){return l.msg_error_NoVisibleRootLibrary},isDNDSupported:function(){return!0},isRoot:function(e){return!(!e||!e.flattenedtaxonomies||"types/Libraries"!==e.flattenedtaxonomies[0]||"types/General Library"!==e.flattenedtaxonomies[1])}})})),define("DS/ClassificationEditor/dataProvider/ClassAttributesDataProvider",["UWA/Class","UWA/Class/Promise","DS/ClassificationEditor/service/ClassificationEditorWebService","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/IPClassifyUtil/IPClassifyAlert","DS/SearchDictionaryAccess/SearchDictionaryAccessAPI","DS/IPClassifyUtil/IPClassifyUtility","DS/WebappsUtils/WebappsUtils"],(function(e,t,i,r,a,n,o,s){"use strict";return e.singleton({hasLibrarianRole:function(){return new t((function(e,t){i.hasLibrarianRole({onComplete:function(t){e({readOnly:JSON.parse(t).isAuthorized.readOnly,permission:JSON.parse(t).isAuthorized.permission,isPermissionRestrictionEnabled:JSON.parse(t).isAuthorized.isPermissionRestrictionEnabled})},onFailure:function(){t({readOnly:!0})}})}))},fetchTheObjects:function(){return new t((function(e){i.fetchAllTheClassificationAttributes({onComplete:function(t){var i=JSON.parse(t).attribute||[],a=s.getWebappsAssetUrl("ClassificationEditor","icons/attributes.png"),l=[],d=[],c={};function u(){i.forEach((function(e){var t="",i="",n="",o="string"==typeof o?JSON.parse(e.range):e.range;o&&o.length>0&&(o.forEach((function(e){if("between"==e.operator){var r=e.value.split(" ");t=r[0],i=r[2]}else n+=","+e.value})),n.length>0&&(n=n.substring(n.indexOf(",")+1))),e.predicate&&!e.predicate.startsWith("ds6wg")&&(e.nls_predicate=c[e.predicate]?c[e.predicate]:"");let s=e.manipulationUnit&&e.manipulationUnit.length>0?e.nls_dimension+"("+e.manipulationUnit+")":e.nls_dimension;l.push({label:e.name,icons:[a],grid:{attrName:e.name,attrTitle:e.nls_label,attrDesc:e.description,attrKind:e.nls_type,attrDefault:e.default,attrHasDefault:e.nls_hasDefault,attrDim:s,displayAsEntered:"Yes"==e.displayAsEntered?r.get("VALUE_TYPE_TRUE"):s?r.get("VALUE_TYPE_FALSE"):void 0,attrPredi:e.nls_predicate,attrAuthorizedValues:n,attrMinimum:t,attrMaximum:i,attrIsMultivalue:e.valuetype&&"multival"==e.valuetype?r.get("VALUE_TYPE_TRUE"):r.get("VALUE_TYPE_FALSE"),attrIsParametric:e.nls_isParametric,attrIsInDico:e.isInDico,attrSel:!1}})}))}i.forEach((function(e){e.predicate&&!e.predicate.startsWith("ds6wg")&&d.push(e.predicate)})),n.get6wResourcesInfo(d.join(","),{lang:widget.lang,tenantId:o.getTenantId(),onComplete:function(t){var i=t.vocabularyElementNLSInfo;for(let e in i)c[i[e].uri]=i[e].nlsName;u(),e({objectsList:l})},onFailure:function(t){console.log(" Predicate NLS could not be fetched "),u(),e({objectsList:l})}})},onFailure:function(t,i,n){var o=r.get("msg_classificationattributes_webservicefailed");i&&"User doesnt have Librarian Role"===i&&(o=o+": <br>"+r.error_no_LibrarianRole),a.displayNotification({message:o,className:"error"}),e({})}})}))},fetchPlaceHolder:function(){return r.classAttributesPanel_Placeholder},initialSortModel:function(){return[{dataIndex:"attrTitle",sort:"asc"}]},searchMatchCriteria:function(e,t){var i=!1,r=new RegExp(e,"i");return(r.test(t.nodeModel.options.grid.attrTitle)||r.test(t.nodeModel.getLabel())||r.test(t.nodeModel.options.grid.attrKind)||r.test(t.nodeModel.options.grid.attrDim))&&(i=!0),i},fetchColumns:function(){return{checkBoxColumn:"attrSel",objectIdentifier:"attrName",columns:[{icon:{iconName:"check",fontIconFamily:1},dataIndex:"attrSel",pinned:"left",typeRepresentation:"boolean",alwaysVisibleFlag:!0,width:40,resizableFlag:!1,editableFlag:!0,editionPolicy:"EditionInPlace",getCellEditableState:function(e){return e.nodeModel,!0}},{dataIndex:"tree",text:r.column_ActualName||"Name",tooltip:r.column_ActualName||"Actual Name"},{dataIndex:"attrTitle",text:r.column_DisplayName||"Display Name",tooltip:r.column_DisplayName||"Display Name",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrKind",text:r.column_Type||"Type",tooltip:r.column_Type||"Type",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrDesc",text:r.column_Description||"Description",tooltip:r.column_Description||"Description",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrDefault",text:r.column_DefaultValue||"Default Value",tooltip:r.column_DefaultValue||"Default Value",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrHasDefault",text:r.hasDefault||"Has Default",tooltip:r.hasDefault||"Has Default",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrDim",text:r.column_Dimensions||"Dimension",tooltip:r.column_Dimensions||"Dimension",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"displayAsEntered",text:r.column_DisplayAsEntered||"Display Unit As Entered",tooltip:r.column_DisplayAsEntered||"Display Unit As Entered",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrPredi",text:r.column_Predicates||"Predicate",tooltip:r.column_Predicates||"Predicate",editableFlag:!1,sortableFlag:!0,resizableFlag:!1},{dataIndex:"attrAuthorizedValues",text:r.column_Authorized_Values||"Authorized Values",tooltip:r.column_Authorized_Values||"Authorized Values",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrIsParametric",text:r.column_Is_Parametric||"Is Parametric",tooltip:r.column_Is_Parametric||"Is Parametric",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrIsMultivalue",text:r.column_Is_Multivalue||"Is Multivalue",tooltip:r.column_Is_Multivalue||"Is Multivalue",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrMinimum",text:r.column_Minimum||"Minimum",tooltip:r.column_Minimum||"Minimum",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrMaximum",text:r.column_Maximum||"Maximum",tooltip:r.column_Maximum||"Maximum",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrIsInDico",text:r.existInDictionary,tooltip:r.existInDictionary,editableFlag:!1,sortableFlag:!0,resizableFlag:!0}]}}})})),define("DS/ClassificationEditor/commands/ActionBar_AddExistingAttributesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUXUtil/IPClassifyLoaderGlobal","DS/ClassificationEditor/dataProvider/ClassAttributesDataProvider","DS/ClassificationEditor/commands/LibraryCommands","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/IPClassificationAttributes/CreateNewAttributes"],(function(e,t,i,r,a,n,o,s,l,d,c){"use strict";var u=!1,f="Specialist",p=!1;return t.extend({labelTopBar:e.i18n("Add Existing Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),this.attributesPanel=null,s.hasLibrarianRole().then((function(e){e="string"==typeof e?JSON.parse(e):e,u=e.readOnly,f=e.permission,p=e.isPermissionRestrictionEnabled})).catch((e=>console.log(e.message)))},beginExecute:function(){},execute:function(){var e=this;require(["DS/PADServices/utils/GlobalModelEvents","DS/PADUtils/PADContext","DS/IPClassifyUXUtil/ObjectsSelectionPanel","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],(function(t,g,m,C,b){var y,h,_=g.get(),v="No Class Selected";C.getCurrentLibrary()&&(h=C.getCurrentLibrary(),y=h.getID(),v=h.getLabel());var S=[];try{S=b.getContent()._libraryContentView.getPADTreeDocument().getRoots()}catch(e){}var A={};S.forEach((function(e){A[e.options.grid.Name]=!0})),e.disable(),o.addComponentsToLoad("contentView",{addExistingAttributes:d.loading});var D=[],E=C.getCurrentLibrary().getID(),T=C.getCurrentLibrary().mxid,w=C.getCurrentLibrary().options.label,L=C.getCurrentLibrary().options.usage;function P(){if(_.options.views?_.options.views.datagridview:void 0){var n=t.getModelEvents();e.attributesPanel=new m({panelHeader:d.command_addExistingAttribute+" - "+v,okButtonLabel:d.classAttributesPanel_okButtonLabel,cancelButtonLabel:d.classAttributesPanel_cancelButtonLabel,okEventName:"AddExistingClassificationAttributes/selectedAttributes",cancelOrCloseEventName:"AddExistingAttributesCmd/Views/showInWidgetBody",modelEvents:n,objectsToSkip:A,dataProvider:s,newAttributeUI:c,isReadOnly:u,permission:f,isPermissionRestrictionEnabled:p});var g=[];g.push(n.subscribe({event:"AddExistingClassificationAttributes/selectedAttributes"},(function(t){o.addComponentsToLoad("contentView",{addExistingAttributes:d.command_addExistingAttribute}),i.addClassAttributes({pid:y,attributes:t.selectedObjects,onComplete:function(i){var n=i?JSON.parse(i):void 0;if(n&&n.error){var s=n.error;r.displayNotification({message:d.msg_addclassificationattributes_failed+s,className:"error"})}else r.displayNotification({message:d.replace(d.msg_addclassificationattributes_success,{number:t.selectedObjects.length,libraryname:v}),className:"success"}),a.getContent().loadContentAndSelect(h);o.removeComponentToLoad("contentView","addExistingAttributes"),e.enable()},onFailure:function(t,i,r){var a=l.extractMyErrorMessage(t,i,r);o.removeComponentToLoad("contentView","addExistingAttributes"),e.enable(),l._commonError("AddExistingAttributes",d.msg_addclassificationattributes_failed,a)}}),g.forEach((function(e){n.unsubscribe(e)}))}))),g.push(n.subscribe({event:"AddExistingAttributesCmd/Views/showInWidgetBody"},(function(t){e.enable(),!0===t.restore&&g.forEach((function(e){n.unsubscribe(e)}))})))}}function I(){e.enable()}D.push(E),i.checkModifyAccessOnItems({objectIds:D,onComplete:function(e){(e?JSON.parse(e):void 0).unModifiableIds.length>0?(o.removeComponentToLoad("contentView","addExistingAttributes"),l._commonError("AddExistingAttributes",d.command_addExistingAttribute+": ",d.error_noChangeAccessOnCA)):i.content({checkClassifiedItems:!0,mxid:T,isExactSearch:!1,start:0,searchPageCount:2,isAuthoringMode:!1,onComplete:function(e){if(o.removeComponentToLoad("contentView","addExistingAttributes"),e&&e.results&&e.results.length>0){var t={confirmationBoxText:d.checkbox_AddAttributes,titleLabel:d.replace(d.title_addAttributes,{className:w}),warningMessage:d.replace(d.msg_warningAddAttributes,{className:w}),enableConfirmationBox:!0,moreInfo:d.msg_moreInfo+": \n - "+d.msg_info1+"\n - "+d.msg_info2+"\n - "+d.msg_info3};"Standard"==L&&(t.buttonColor="blue",t.enableConfirmationBox=!1),t.deleteButtonLabel=d.Add_button,n.confirmDialog(t,P,I)}else P()},onFailure:function(e){o.removeComponentToLoad("contentView","addExistingAttributes"),P()}})},onFailure:function(t){o.removeComponentToLoad("contentView","addExistingAttributes"),e.enable(),l._commonError("AddExistingAttributes",d.command_addExistingAttribute+": ",d.error_noChangeAccessOnCA)}})}))},endExecute:function(){}})})),define("DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider",["UWA/Class","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/service/LibraryServices","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUXUtil/IPClassifyConfirmationWthCheckBx","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/IPClassifyUX/utils/IPClassifyWidgetData"],(function(e,t,i,r,a,n,o,s,l,d,c,u,f,p){"use strict";return e.singleton({shouldAcceptDrag:function(){var e=!0,t=o.getSelectedNodes();if(1==t.length){for(var i=0;i<t.length;++i)if("Library"!==t[i].plmType){e=!1;break}}else e=!1;return e},shouldAcceptDrop:function(e){var t=!1;return e||(e=o.getCurrentLibrary()),"LibrarySection_AllLibraries"===e.plmType&&"LibrarySection_Favorites"===e.plmType||!s.inFamilyLibrary(e.plmType)||(t=!0),t},addContentInObject:function(e,i,r,a){t.displayNotification({message:f.msg_warning_dndnotsupported,className:"warning"})},addClassesInLibrary:function(e,a,l,p,g){if(e&&e.plmType&&s.inFamilyLibrary(e.plmType)&&l){var m=l;if(m.length<1)return void console.warn("  Error in LibraryDnDServiceProvider.addClassesInLibrary, lContentId list is empty");if(e.id===a)return i._offProgressBar(),void t.displayNotification({message:f.msg_error_MoveInSamelibrary,className:"error"});for(var C=0;C<m.length;C++){var b=m[C];if(e.id===b)return i._offProgressBar(),void t.displayNotification({message:f.msg_error_MoveInSamelibrary,className:"error"})}var y=g,h=o.getCurrentLibrary();if("LibrarySection_favorite"===h.getType())return i._offProgressBar(),void t.displayNotification({message:f.msg_warning_dndnotsupported,className:"warning"});h.getID()===l[0]&&(h=h.getParent());var _=o.getSelectedNodes(),v=e&&s.inFamilyLibrary(e.plmType)?e:null;function L(e,t,i,r){if(i.id!=t.id){if("MOVE_CLASS"===e&&!s.isRootLibrary(t.plmType))if(UWA.is(r,"array")&&1===r.length&&r[0]===t){var a=t.getParent();if(a&&a.id===i.id)return!1}return!0}}function P(e,a,n){r.MoveClass({IDs:e,targetLibrary:a,carryOverAttributeGroups:n,callbacks:{onComplete:function(e){I(e)},onFailure:function(e,r,a){i._offProgressBar();var n=i.extractMyErrorMessage(e,r,a);t.displayNotification({message:n?f.msg_error_moveClass+"<br>"+n:f.msg_error_moveClass,className:"error"})}}})}function I(e){i._offProgressBar();var t=f.replace(f.msg_info_classesmoved,{number:w,libraryname:v._options.label});1===T&&(t=f.replace(f.msg_info_classmoved,{classmovedname:_[0]._options.label,libraryname:v._options.label})),d.setAuthoringMode("authoring",t),n.getContent().loadContentAndSelect(h),h.isExpanded()&&(n.getTreeCont().performOperationOnNode(h,"collapse"),n.getTreeCont().performOperationOnNode(h,"expand")),y?(v=n.getTreeCont()._getNodesById(v.id)[0]).isExpanded()&&(n.getTreeCont().performOperationOnNode(v,"collapse"),n.getTreeCont().performOperationOnNode(v,"expand")):v.isExpanded()&&(n.getTreeCont().performOperationOnNode(v,"collapse"),n.getTreeCont().performOperationOnNode(v,"expand"))}if(v||(v=o.getCurrentLibrary()),!_)return;var S=[],A=[],D=[],E=[],T=_.length;T>0?_.forEach((function(e){S.push(UWA.is(e.id)?e.id:e.options.resourceid),s.isLibrary(e.plmType)?(A.push(UWA.is(e.id)?e.id:e.options.resourceid),D.push(e)):s.isRootLibrary(e.plmType)?"RootLibrary"===e.plmType&&A.push(UWA.is(e.id)?e.id:e.options.resourceid):E.push(UWA.is(e.id)?e.id:e.options.resourceid)})):(S.push(_),"Library"==node.plmType?(A.push(_.id),D.push(_)):s.isRootLibrary(node.plmType)||E.push(_.id));var w=A.length;v?A.length>0&&(void 0!==v._options.usage&&h._options.usage!==(v._options.usage?v._options.usage:v._options.classUsage)?(i._offProgressBar(),t.displayNotification({title:f.msg_error_MoveInLibraryErrorTitle,subtitle:f.msg_error_MoveInLibraryErrorSubTitle,message:f.msg_error_MoveInLibraryErrorMessage,className:"error"})):L("MOVE_CLASS",h,v,_)?"RootLibrary"===h.plmType?c.launch({title:f.confirmation_move_title+" - "+_[0].getLabel(),content:f.replace(f.confirmation_move_message,{parentlibrary:v.getLabel()}),confirmLabel:f.confirmMoveYes,cancelLabel:f.confirmMoveNo},(function(){i._startProgressBar(f.Move_Class_loading),P(A,v,!1)}),null,(function(){i._offProgressBar()})):"Library"===h.plmType&&r.MoveClass({IDs:A,targetLibrary:v,carryOverAttributeGroups:"",callbacks:{onComplete:function(e){JSON.parse(e).hasInheritedAttributes?u.launch({title:f.confirmation_move_title+" "+_[0].getLabel(),confirmLabel:f.confirmMoveYes,cancelLabel:f.confirmMoveNo,mainDivContent:{divHeaderShow:f._class+_[0].getLabel()+f.moveClassAttributesLostMsg_Part1+h.getLabel(),divFooterHide:f.moveClassAttributesLostMsg_Part2+JSON.parse(e).noOfClassifiedItemsAffected+f.moveClassAttributesLostMsg_Part3,checkBoxParams:{label:f.includeInheritedAttributes}}},(function(){i._startProgressBar(f.Move_Class_loading),u.getChkBoxCheckedFlag()?P(A,v,!0):P(A,v,!1)}),null,(function(){i._offProgressBar()})):c.launch({title:f.confirmation_move_title+" "+_[0].getLabel(),content:f.replace(f.confirmation_move_message,{parentlibrary:v.getLabel()}),confirmLabel:f.confirmMoveYes,cancelLabel:f.confirmMoveNo},(function(){i._startProgressBar(f.Move_Class_loading),P(A,v,!1)}),null,(function(){i._offProgressBar()}))},onFailure:function(e,r,a){i._offProgressBar();var n=i.extractMyErrorMessage(e,r,a);t.displayNotification({message:n?f.msg_error_moveClass+"<br>"+n:f.msg_error_moveClass,className:"error"})}}}):(i._offProgressBar(),t.displayNotification({message:f.msg_error_MoveInSamelibrary,className:"error"}))):(i._offProgressBar(),t.displayNotification({message:f.msg_warning_nocurrentlibrary,className:"warning"}))}},getDroppedData:function(e){var t=[],i=[],r=[];if(e&&e.data&&e.data.items&&Array.isArray(e.data.items)){for(var a=0;a<e.data.items.length;a++){var n=e.data.items[a],o=n.objectId,l=n.objectType_Internal;if(l||(l=n.objectType),Array.isArray(l)){for(var d=l.length,c=d>0?l[d-1]:void 0,u=0;u<d;++u)if(s.inFamilyLibrary(l[u])){c=l[u];break}l=c}var f=n.displayName;f||(f=l),f||(f=o);var p={droppedItem_id:o,droppedItem_type:l,droppedItem_name:f,droppedSourceLibrary_id:n.libraryId,droppedItem_tenantId:n.envId};s.isRootLibrary(l)?t.push(p):s.isLibrary(l)?i.push(p):r.push(p)}var g={};return g.RootLibrary_itemList=t,g.Library_itemList=i,g.Content_itemList=r,g}},inFamilyLibrary:function(e){return s.inFamilyLibrary(e)}})})),define("DS/ClassificationEditor/commands/ClassificationIconBar_MoveClass",["UWA/Core","DS/ApplicationFrame/Command","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/LibraryActive/LibraryActive","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider"],(function(e,t,i,r,a,n){"use strict";return t.extend({labelTopBar:i.moveClass_ActiveClassify_LabelTopbar,isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=this;e.popover?(e.popover.nestedMenuInContext.popover.title=i.confirmation_move_title+" - "+a.getSelectedNodes()[0].getLabel(),e.popover.showPopover()):(e.popover=new r({container:document.body.querySelector('[data-command="ActionBar_ActiveClassificationCmd"]'),topBarLabel:i.confirmation_move_title+" - "+a.getSelectedNodes()[0].getLabel(),selectBtnLabel:i.confirmMoveYes,isChooserPanel:!0,panelIcon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-move-to",couldBeValid:function(e){e&&e.getID&&e.getID();if(e&&e.getType){if(e.getType()&&"LibrarySection_AllLibraries"!==e.getType())return"General Class"===e.getType()||"General Library"===e.getType();if("General Class"===e.plmType||"General Library"===e.plmType)return!0;if("LibrarySection_AllLibraries"===e.getType())return!0}return!1},isMaturityFilterDisabled:!0}),e.popover.addEvent("onSetActive",(function(e){var t=e,i=a.getCurrentLibrary().getID(),r=[a.getSelectedNodes()[0].getID()];n.addClassesInLibrary(t,i,r,!1,!0),require("DS/ClassificationEditor/commands/LibraryCommands")._offProgressBar()})))},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/PLMNewClassCmd",["DS/UIKIT/Mask","DS/ENONewWidget/ENONew/Events","DS/ENONewWidget/command/NewContentCommandBase","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],(function(e,t,i,r,a,n){"use strict";var o,s;return i.extend({defaults:{type:o},init:function(i,r){s="new_class",o="General Class",this.defaults.type=o,t.addEvent("onCreationDialogAction",(function(t){if(t&&"ready"===t.action){var i=n.getContent().getView().getContent().getChildren()[1].getChildren()[0];e.unmask(i)}})),this._parent(i)},getType(){return this.defaults.type},execute:function(){var t=n.getContent().getView().getContent().getChildren()[1].getChildren()[0];e.mask(t),this.launchCreationDialog()},launchCreationDialog:function(){var e=this.getCreateOptions({});this.launchCreateNew(e)},getOptions:function(){var e,t=this,i=a.getCurrentLibrary()._options.usage;return e=a.getCurrentLibrary().getID(),{options:{typeName:o,parentPIDs:[e],attributes:{"Class Usage":i}},context:{serviceBaseUrl:t.options.serviceBaseUrl,tenant:t.options.tenant,header:{SecurityContext:t.options.securityContext},getENONewContext:function(){return{}}},events:t.options.callbacks,viewType:"listView",labelTopBar:r.get(s),activeTopBar:!0,silentMode:!1,type:o}}})})),define("DS/ClassificationEditor/commands/PLMNewLibraryCmd",["DS/UIKIT/Mask","DS/ENONewWidget/ENONew/Events","DS/ENONewWidget/command/NewContentCommandBase","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],(function(e,t,i,r,a){"use strict";var n,o,s;return i.extend({defaults:{type:n},init:function(i,r){n="General Library","CreateNewDefinitionLibrary"===r?(o="new_definition_library",s="Definition"):(o="new_standard_library",s="Standard"),this.defaults.type=n,t.addEvent("onCreationDialogAction",(function(t){if(t&&"ready"===t.action){var i=a.getContent().getView().getContent().getChildren()[1].getChildren()[0];e.unmask(i)}})),this._parent(i)},getType(){return this.defaults.type},execute:function(){var t=a.getContent().getView().getContent().getChildren()[1].getChildren()[0];e.mask(t),this.launchCreationDialog()},launchCreationDialog:function(){var e=this.getCreateOptions({});this.launchCreateNew(e)},getOptions:function(){var e=this;return{options:{typeName:n,attributes:{"Library Usage":s}},context:{serviceBaseUrl:e.options.serviceBaseUrl,tenant:e.options.tenant,header:{SecurityContext:e.options.securityContext},getENONewContext:function(){return{}}},events:e.options.callbacks,viewType:"listView",labelTopBar:r.get(o),activeTopBar:!0,silentMode:!1,type:n}}})})),define("DS/ClassificationEditor/commands/ReorderClassAttributeCmd",["UWA/Core","UWA/Class","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyModelEvents","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/PADUtils/Configuration","DS/ClassificationEditor/commands/LibraryCommands","DS/Controls/Find","DS/Utilities/Utils"],(function(e,t,i,r,a,n,o,s,l,d,c,u,f,p){"use strict";var g=null;let m;let C;var b={_treeView:"",containerListView:"",init:function(e){this._parent(e)},reorderTree:function(e,t,i){[];let r=[],a=require("DS/IPClassifyUX/views/LibraryMode");"read"==a.getCurrentModeType()&&a.switchtoAuthoringMode();let n={},o=[],s=!1;e.contents.forEach((function(e,t){e.classAttributeOrder="NA"===e.classAttributeOrder?"NA":parseInt(e.classAttributeOrder),o.push(e),"NA"===e.classAttributeOrder&&(s=!0)})),s?o.sort(((e,t)=>e["ds6w:label"]-t["ds6w:label"])):o.sort(((e,t)=>e.classAttributeOrder-t.classAttributeOrder)),n.contents=o,n.contents.forEach((e=>{r.push({Name:e["ds6w:label"],InternalName:e.Name,Type:e.Type,icon:e[0]})})),m=r,this._createPanel(r,t,i)},_disableButtons:function(){let e=this._dialog.buttons;e.Ok.disabled=!0,e.Reset.disabled=!0},_enableButtons:function(e){e.Ok.disabled=!1,e.Reset.disabled=!1},_insertInView:function(e){e._isMoved=!0,this._dialog.buttons.Ok.disabled&&this._enableButtons(this._dialog.buttons)},_treeOrderUpdatedEvent:function(e,t){this._dialog.buttons.Ok.disabled&&this._enableButtons(this._dialog.buttons),t?a.publish({event:"TreeOrderUpdatedInPanel",data:{relIdsArray:e,flag:!0}}):a.publish({event:"TreeOrderUpdatedInPanel",data:e})},_createPanel:function(t,i,r){let a=this;require(["DS/Windows/Dialog","DS/Controls/Button","DS/Controls/TooltipModel"],((o,s,l)=>{a.immersiveFrame=widget.myImmersiveFrame;let d=e.createElement("div",{class:"AttributeReorderDialog-reorder-dialog-body",styles:{width:"100%",height:"95%",padding:0}});a._dialog=new o({immersiveFrame:a.immersiveFrame,title:n.tree_ordering_panel_title+" - "+r,className:"AttributeReorderDialog-reorder_dialog",content:d,resizableFlag:!1,modalFlag:!0,movableFlag:!0,width:700,minWidth:500,minHeight:300,height:500,position:{},touchMode:!0,buttons:{Ok:new s({label:n.tree_ordering_Reorder_btn,disabled:!0,onClick:this._reorderDone.bind(this,i)}),Reset:new s({label:n.tree_ordering_reset_btn,disabled:!0,onClick:a._onReset.bind(a)}),Cancel:new s({label:n.tree_ordering_cancel_btn,onClick:function(e){let t=e.dsModel.dialog;new o({immersiveFrame:a.immersiveFrame,title:n.tree_ordering_cancel_btn_confirm_header,content:n.tree_ordering_cancel_btn_confirm_Body,modalFlag:!0,position:{},touchMode:!0,buttons:{Ok:new s({label:n.VALUE_TYPE_TRUE,disabled:!1,onClick:function(e){e.dsModel.dialog.close(),t.close()}}),Cancel:new s({label:n.VALUE_TYPE_FALSE,disabled:!1,onClick:function(e){e.dsModel.dialog.close()}})}})}})}}),a._dialog.addEventListener("close",a._onClosePanel.bind(a),!1),a._dialog.elements.container.classList.add("ClassificationEditor_reorder_Dialog"),a._dialog.elements.container.addEventListener("click",(function(e){return e.preventDefault(),e.stopPropagation(),!1}));let c=new e.Element("div",{class:"AttributeReorderDialog-reorder_tree_mainContainer"}).inject(d),u=new e.Element("div",{class:"AttributeReorderDialog-reorder_body_container"}).inject(c);new e.Element("div",{class:"messageDiv",text:n.tree_ordering_panel_title_warning_msg}).inject(u);b.containerListView=new e.Element("div",{class:"AttributeReorderDialog-reorder-manual-listview-container",styles:{width:"calc(100% - 50px)",height:"100%",position:"relative",display:"inline-block"}}).inject(u);let f=new e.Element("div",{class:"AttributeReorderDialog-reorder-manual-updown-container",styles:{display:"inline-block","flex-direction":"column","justify-content":"center","vertical-align":"top","margin-top":"20%"}}).inject(u);a.reorderToTop=new s({displayStyle:"icon",icon:{iconName:"move-to-top",fontIconFamily:WUXManagedFontIcons.Font3DS},disabled:!0,type:"radio"}).inject(f),a.reorderUp=new s({displayStyle:"icon",icon:{iconName:"up",fontIconFamily:WUXManagedFontIcons.Font3DS},disabled:!0,type:"radio"}).inject(f),a.reorderDown=new s({displayStyle:"icon",icon:{iconName:"down",fontIconFamily:WUXManagedFontIcons.Font3DS},disabled:!0,type:"radio"}).inject(f),a.reorderToBottom=new s({displayStyle:"icon",icon:{iconName:"move-to-bottom",fontIconFamily:WUXManagedFontIcons.Font3DS},disabled:!0,type:"radio"}).inject(f),a.reorderToTop.addEventListener("buttonclick",a._onReorderToTop.bind(a)),a.reorderUp.addEventListener("buttonclick",a._onReorderUp.bind(a)),a.reorderDown.addEventListener("buttonclick",a._onReorderDown.bind(a)),a.reorderToBottom.addEventListener("buttonclick",a._onReorderTobottom.bind(a)),a.reorderToTop.tooltipInfos=new l({shortHelp:n.tree_ordering_movetop_btn}),a.reorderUp.tooltipInfos=new l({shortHelp:n.tree_ordering_moveup_btn}),a.reorderDown.tooltipInfos=new l({shortHelp:n.tree_ordering_movedown_btn}),a.reorderToBottom.tooltipInfos=new l({shortHelp:n.tree_ordering_movebottom_btn}),a._createTreeOrderList(t)}))},_createTreeOrderList:function(t){let i=this;g=null,C=null,i.arrowEnableFlag=void 0,i.model=new s({shouldAcceptDrop:function(e){return"middle"!==e.dropPosition&&e.draggedTreeNodeModel.getParent()===e.dropNode.getParent()}}),i.model.prepareUpdate();for(let e=0;e<t.length;e++){let r=t[e],a=new l({label:r.label,grid:r});i.model.addChild(a)}i.model.expandAll(),i.model.pushUpdate();let r=e.clone(c.getConfig("dgvOptions")),a=r&&r.dgv?r.dgv:{},o=e.extend({_identifier:"DataGridView-reorderListView-"+widget.id},a);o.treeDocument=i.model,o.columns=[{dataIndex:"tree",text:n.Title,width:"auto",autoRowHeightFlag:!0,allowUnsafeHTMLContent:!1,editableFlag:!1,typeRepresentation:"url",getCellValue:function(e){let t=e.nodeModel.options.grid;return{label:t.Name,icon:t.icon}},getCellValueAsStringForFind:function(e){if(e.nodeModel)return e.nodeModel._options.grid.Name}},{dataIndex:"Type",text:n.Type,width:"auto",autoRowHeightFlag:!0,allowUnsafeHTMLContent:!1,editableFlag:!1,typeRepresentation:"string",getCellValueAsStringForFind:function(e){if(e.nodeModel)return e.nodeModel._options.grid.Type}}],o.layoutOptions={useLastColumnWidthAutoFlag:!0,rowsHeader:!0},o.rowSelection="single",o.showOutlineFlag=!0,o.selectionBehavior={toggle:!1,unselectAllOnEmptyArea:!0,selectNodeModelOnCellSelection:!0},o.rowHeaderActivated=!0,o.showRowIndexFlag=!0,o.cellDragEnabledFlag=!0,o.rowDragEnabledFlag=!0,o.showSelectionCheckBoxesFlag=!0,o.showColumnBorderFlag=!0,o.onContextualEvent=()=>[],o.findNavigationMode="row",o.showMatchingCellBackgroundFlag=!0,b._treeView=new d(o);let u=e.createElement("div",{class:"divToolbar",styles:{float:"right"}});b.containerListView.appendChild(u);let f={entries:[{id:"openSearch",dataElements:{typeRepresentation:"function",icon:{iconName:"find",fontIconFamily:1}},action:{module:"DS/ClassificationEditor/commands/ReorderClassAttributeCmd",func:"openSearch"},tooltip:n.find_in_left_tree_btn}]},p=b._treeView.setToolbar(JSON.stringify(f));u.appendChild(p.getContent()),b._treeView.inject(b.containerListView),b._treeView.onDropRowHeader=i.onDropEventCall.bind(i),b._treeView.onDropCell=i.onDropEventCall.bind(i),b._treeView.addEventListener("click",(function(e,t){if(t){let e=t.nodeModel;g||(C=g=e,g.select(),i._enableManualSortButtons(i.reorderDown,i.reorderToBottom,i.reorderToTop,i.reorderUp)),g&&g!=e&&(g.unselect(),e.select(),C=g,g=e,C._isMoved&&(i._treeOrderUpdatedEvent(C),C._isMoved=!1))}}))},onDropEventCall:function(e,t){let i,r,a;if(e.preventDefault(),t.nodeModel&&(i=t.nodeModel),t.droppedNodes[0]&&(r=t.droppedNodes[0]),t.dropPosition&&(a=t.dropPosition),i&&r&&a){let e,t;switch(a){case"top":e=i.getPreviousNode(),t=i;break;case"bottom":e=i,t=i.getNextNode()}let n=[];n.push(e?e.options.grid.relId:"null"),n.push(r?r.options.grid.relId:"null"),n.push(t?t.options.grid.relId:"null"),this._treeOrderUpdatedEvent(n,!0)}return!0},openSearch:function(){let e=arguments[0].context.executionContext,t=document.body,i=document.getElementsByClassName("wux-ui-3ds-find"),r=i&&i.length?i[0]:void 0;for(;r;)r=r.parentElement,r&&r.classList.contains("wux-controls-button")&&(t=r);if(e){if(e.findWidget)e.findWidget.visibleFlag=!e.findWidget.visibleFlag;else{new f({displayMatchCaseToggle:!0,relatedWidget:e,onFindRequest:e.setFindStr,onFindPreviousResult:e.goToPreviousMatchingCell,onFindNextResult:e.goToNextMatchingCell,onFindClose:e.closeFind}).inject(document.getElementsByClassName("wux-windows-modalDialog")[0]);e.findWidget.getContent().style.position="absolute"}p.setConstrainedPosition(e.findWidget,t,{position:"top left"}),e.findWidget.focus()}},_enableManualSortButtons:function(e,t,i,r){e.disabled=!1,t.disabled=!1,i.disabled=!1,r.disabled=!1},_disableManualSortButtons:function(e,t,i,r){e.disabled=!0,t.disabled=!0,i.disabled=!0,r.disabled=!0},_onReorderUp:function(){let t=this,i=t.model.getSelectedNodes()[0];if(e.is(i)){let e=i._rowID;if(e>0){let r=i.getPreviousNode();t.model.prepareUpdate(),i.getParent().insertBefore(i,r),t.model.pushUpdate(),i.select(),i._rowID!=e&&(t._insertInView(i),b._treeView.ensureNodeModelVisible(i))}}},_onReorderDown:function(){let t=this,i=t.model.getSelectedNodes()[0],r=t.model.getRoots().length;if(e.is(i)){let e=i._rowID;if(e<r-1){let r=i.getNextNode();t.model.prepareUpdate(),r.getParent().insertBefore(r,i),t.model.pushUpdate(),i.select(),i._rowID!=e&&(t._insertInView(i),b._treeView.ensureNodeModelVisible(i))}}},_onReorderToTop:function(){let t=this,i=t.model.getRoots()[0],r=t.model.getSelectedNodes()[0];if(e.is(r)){let e=r._rowID;e>0&&(t.model.prepareUpdate(),r.getParent().insertBefore(r,i),t.model.pushUpdate(),r.select(),r._rowID!=e&&(t._insertInView(r),b._treeView.ensureNodeModelVisible(r)))}},_onReorderTobottom:function(){let t=this,i=t.model.getSelectedNodes()[0],r=t.model.getRoots().length;if(e.is(i)){let e=i._rowID;e<r-1&&(t.model.prepareUpdate(),i.getParent().addChild(i),t.model.pushUpdate(),i.select(),i._rowID!=e&&(t._insertInView(i),b._treeView.ensureNodeModelVisible(i)))}},_reorderDone:function(e){let t=this,a=[];g&&g._isMoved&&(this._treeOrderUpdatedEvent(g),g._isMoved=!1),t.model._trueRoot.__trueRoot._options.children.length>0&&t.model._trueRoot.__trueRoot._options.children.forEach((function(e,i){a[i]=t.model._trueRoot.__trueRoot._options.children[i]._options.grid.InternalName})),r.reorderClassAttributes({classId:e,attributeList:a,onComplete:function(e){o.getContent().loadContentAndSelect(),t._onClosePanel(),i.displayNotification({message:n.command_reorderClassAttributesOrder_success,className:"success"})},onFailure:function(e,r,a){i.displayNotification({title:n.command_reorderClassAttributesOrder_failed+": ",subtitle:n.error_noChangeAccessOnCA,className:"error"}),t._onClosePanel()}})},_onReset:function(){this._disableButtons(),g=null,[],C=null,this._disableManualSortButtons(this.reorderDown,this.reorderToBottom,this.reorderToTop,this.reorderUp),this._dialog.content.getChildren()[0].getChildren()[0].getChildren()[1].innerHTML="",this._createTreeOrderList(m)},_onClosePanel:function(){this._dialog.destroy(),this._dialog=null}};return b})),define("DS/ClassificationEditor/commands/ActionBar_ReorderClassAttributes",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/dataProvider/ClassAttributesDataProvider","DS/ClassificationEditor/commands/LibraryCommands","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/commands/ReorderClassAttributeCmd","DS/PADUtils/PADContext","DS/ClassificationEditor/utils/Library_CSO"],(function(e,t,i,r,a,n,o,s,l,d,c){"use strict";var u=[];return t.extend({labelTopBar:e.i18n("Reorder of Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e;d.get();c.getCurrentLibrary()&&((e=c.getCurrentLibrary()).getID(),e.getLabel()),u=a.getContent()._libraryContentView.getPADTreeDocument().getRoots();var t={};u.forEach((function(e){t[e.options.grid.Name]=!0}));var n=[],o=c.getCurrentLibrary().getID();n.push(o);var f=c.getCurrentLibrary().getLabel();i.checkModifyAccessOnItems({objectIds:n,onComplete:function(e){var t=e?JSON.parse(e):void 0;if(UWA.is(t)&&t.unModifiableIds.length>0)r.displayNotification({title:s.command_reorderClassAttributesOrder_failed+": ",subtitle:s.error_noChangeAccessOnCA,className:"error"});else{for(var i={contents:[]},a=0;a<u.length;a++)i.contents.push(u[a]._options.grid);i.contents.length>1?l.reorderTree(i,n[0],f):r.displayNotification({message:s.get("error_OnlyOneAttr"),className:"warning"})}},onFailure:function(e){r.displayNotification({title:s.msg_reorderClassAttributesOrder_failed+": ",subtitle:s.error_noChangeAccessOnCA,className:"error"})}})},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/ActionBar_ClassCreationCmd",["DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/PLMNewClassCmd","DS/IPClassifyUX/service/SettingsManagement","DS/PADUtils/PADSettingsMgt","DS/ApplicationFrame/CommandsManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],(function(e,t,i,r,a,n,o,s,l,d,c,u){"use strict";return e.extend({isInsert:!0,executedByTopBarClass:!1,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},executeTopBar:function(){let e=this;e.executedByTopBarClass||(e.executedByTopBarClass=!0,e.execute())},execute:function(){let e=this;var f=a.getCurrentCmdId(),p={fetchSecurityContext:function(){return r.getSetting("pad_security_ctx")},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return n.getContent().getView().getPADTreeDocument().getSelectedNodes()},getDocumentFromNodeModel:function(e){return e.options.data},getOrigin:function(){return{source:UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"toolbar"}},platformUrls:i.getPlatformURLs().platformurls},g={onSuccess:function(t){e.executedByTopBarClass=!1;var i=[o.getCurrentLibrary()];d._performFetchQuery({ids:[t.result[0].identifier],dynamicAttrs:[],isAuthoringMode:!0,onComplete:function(r){e.executedByTopBarClass=!1;var a=[],d="library-class";r.results&&r.results.length>0&&(r.results.forEach((function(e){a.push(c.convertToExaleadDataFormatFederated(e))})),a[0].usage&&"Definition"==a[0].usage&&(d="library-class-filled")),n.getTreeCont().addNewNode({physicalid:a[0].physicalid,label:a[0].label,plmType:"Library",type:a[0].type,mxid:a[0].mxid,parentid:o.getSelectedNodes()[0].getID(),icons:[{iconName:d}],usage:a[0].usage}),l.setAuthoringMode("authoring","none"),UWA.is(n.getContent())&&n.getContent().loadContentAndSelect(i[0],t.result[0].identifier),s.displayNotification({message:u.replace(u.msg_info_classcreated,{classname:a[0].label}),className:"success"})},onFailure:function(){}})},onFailure:function(t){e.executedByTopBarClass=!1,console.log("object creation failure")},onCancel:function(t){e.executedByTopBarClass=!1,localStorage.setItem("PLMNewClassCmd"+(UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId),t.preferedType),console.log("object creation cancellled")}};new t({preferedType:localStorage.getItem("PLMNewClassCmd"+(UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId)),serviceBaseUrl:p.platformUrls["3DSpace"],tenant:p.platformUrls.platformId,securityContext:p.fetchSecurityContext(),callbacks:g},f).execute()},endExecute:function(){}})})),define("DS/ClassificationEditor/commands/ActionBar_LibraryCreationCmd",["DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/PLMNewLibraryCmd","DS/IPClassifyUX/service/SettingsManagement","DS/PADUtils/PADSettingsMgt","DS/ApplicationFrame/CommandsManager","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/TopBarProxy/TopBarProxy","DS/TopBarProxy/Menu","DS/TopBarProxy/MenuItem","DS/IPClassifyUX/models/LibrarySearchModel","DS/ClassificationEditor/commands/ActionBar_ClassCreationCmd"],(function(e,t,i,r,a,n,o,s,l,d,c,u,f,p,g,m,C){"use strict";var b;return e.extend({isInsert:!0,executedByTopBar:!1,init:function(e){var t=this;this._parent(e,{mode:"exclusive",isAsynchronous:!1}),this._menuItem=null;try{var i=new f({id:widget.id}),r=new g({label:u.placeholder_CMD1_CrteLib,onExecute:function(){m.isSearchActive()||"LibrarySection_AllLibraries"!=s.getCurrentLibrary().plmType?l.displayNotification({title:u.msg_error_topbar_library_creation_error,className:"error"}):t.executeTopBar("CreateNewDefinitionLibrary")}}),a=new g({label:u.placeholder_CMD2_CrteLib,onExecute:function(){m.isSearchActive()||"LibrarySection_AllLibraries"!=s.getCurrentLibrary().plmType?l.displayNotification({title:u.msg_error_topbar_library_creation_error,className:"error"}):t.executeTopBar("CreateNewStandardLibrary")}}),n=new g({label:u.new_class,onExecute:function(){m.isSearchActive()||"General Class"!=s.getCurrentLibrary().systemType&&"General Library"!=s.getCurrentLibrary().systemType?l.displayNotification({title:u.msg_error_topbar_class_creation_error,className:"error"}):t.executeTopBar("General Class")}});t._menuItem=[r,a,n],i.addContent({add:t._menuItem})}catch(e){console.log("can't load top bar")}},beginExecute:function(){},executeTopBar:function(e){var t=this;t.executedByTopBar||(t.executedByTopBar=!0,t.storeCmdValue(e),"General Class"===e?(C.prototype.executeTopBar(),t.executedByTopBar=!1):t.execute())},storeCmdValue:function(e){b=e},execute:function(){var e=this,f=a.getCurrentCmdId();"NoRunningCmd"==f&&(f=b);var p={fetchSecurityContext:function(){return r.getSetting("pad_security_ctx")},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return o.getContent().getView().getPADTreeDocument().getSelectedNodes()},getDocumentFromNodeModel:function(e){return e.options.data},getOrigin:function(){return{source:UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"toolbar"}},platformUrls:i.getPlatformURLs().platformurls},g={onSuccess:function(t){var i=[s.getCurrentLibrary()];e.executedByTopBar=!1,d._performFetchQuery({ids:[t.result[0].identifier],dynamicAttrs:[],isAuthoringMode:!0,onComplete:function(r){var a=[];e.executedByTopBar=!1;var s="library-lined";r.results&&r.results.length>0&&(r.results.forEach((function(e){a.push(c.convertToExaleadDataFormatFederated(e))})),a[0].usage&&"Definition"==a[0].usage&&(s="library")),o.getTreeCont().addNewNode({physicalid:a[0].physicalid,label:a[0].label,usage:a[0].usage,plmType:"RootLibrary",type:a[0].type,mxid:a[0].mxid,icons:[{iconName:s}]}),n.setAuthoringMode("authoring","none"),UWA.is(o.getContent())&&o.getContent().loadContentAndSelect(i[0],t.result[0].identifier,!1,!1,!0),l.displayNotification({message:u.replace(u.msg_info_librarycreated,{libraryname:a[0].label}),className:"success"})},onFailure:function(){e.executedByTopBar=!1}})},onFailure:function(t){e.executedByTopBar=!1,console.log("object creation failure")},onCancel:function(t){e.executedByTopBar=!1,localStorage.setItem("PLMNewLibraryCmd"+(UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId),t.preferedType),console.log("object creation cancellled")}};new t({preferedType:localStorage.getItem("PLMNewLibraryCmd"+(UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId)),serviceBaseUrl:p.platformUrls["3DSpace"],tenant:p.platformUrls.platformId,securityContext:p.fetchSecurityContext(),callbacks:g},f).execute()},endExecute:function(){}})})),define("DS/ClassificationEditor/dataProvider/LibraryCSODataProvider",["UWA/Class","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUX/utils/IPClassifyWidgetData"],(function(e,t,i){"use strict";return e.singleton({getCurrentObject:function(){return t.getCurrentLibrary()},getCurrentObjectPath:function(){return t.getCurrentLibraryPath()},addInCSO:function(e,i){t.addInLibraryCSO(e,i)},getSelectedNodes:function(){return t.getSelectedNodes()},getSelectedNodesID:function(){return t.getSelectedNodesID()},removeBroadcast:function(){if(1==i.getWidgetData().currentWidgetTab)return!1}})})),define("DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider",["UWA/Class","UWA/Class/Promise","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUX/utils/IPClassifyWidgetData","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/IPClassifyUX/LibrarySearchWithinController","DS/ClassificationEditor/dataProvider/LibraryCSODataProvider","DS/ClassificationEditor/utils/Library_CSO"],(function(e,t,i,r,a,n,o,s,l,d,c,u){"use strict";return e.singleton({getChildrenInfos:function(e){return new t((function(t){var n=i.getTreeCont()._getVisibleNodeById(e);if(n){var o=n.getChildren();t(o)}else r.libraries({pid:e,onComplete:function(i){var r=[];i.results?r=a.convertExpandToSearchFormat(e,i.results):i.result&&(r=a.convertNavigateToSearchFormat(i.result)),r.forEach((function(e){e.plmType=e.plmType||"Library"})),t(r)},onFailure:function(e){console.warn("WebService libraries Err : "+e),t([])}})}))},isSection:function(e){return"LibrarySection_favorite"==e||"LibrarySection_AllLibraries"==e},needSep:function(){if(this.showSeachCommand())return!1},showSeachCommand:function(){var e=s.getWidgetData().currentWidgetTab;let t=s.getIsEditModeEnabled();var i,r,a;return c&&(i=c.getCurrentObject())&&(r=this.isSection(i.getType()),a=this.getLibraryTypeService().isRootLibrary(i.getType())),!(r||!(1===e&&!t||"0"==e&&"0"==s.getWidgetData().currentTab||"0"==e&&a))},getCurrentTabValue:function(){return s.getWidgetData().currentWidgetTab},isIndexModeVisible:function(e){return 0===e&&0===s.getWidgetData().currentTab},showInformationCommand:function(){return 0===s.getWidgetData().currentWidgetTab},getStableAreaWidth:function(e,t,i){if(i)return i+5;var r=s.getWidgetData();if(0!==r.currentWidgetTab){return 1==s.getIsEditModeEnabled()?49:77}return 0===r.currentTab?e?166:143:1===r.currentTab?105:void 0},searchMatchCriteria:function(e,t){var i=!1,r=new RegExp(e,"i");return(r.test(t.nodeModel.options.grid.Name)||r.test(t.nodeModel.options.grid.nls_DE)||r.test(t.nodeModel.options.grid.nls_EN)||r.test(t.nodeModel.options.grid.nls_FR)||r.test(t.nodeModel.options.grid.nls_JA)||r.test(t.nodeModel.options.grid.nls_KO)||r.test(t.nodeModel.options.grid.nls_RU)||r.test(t.nodeModel.options.grid.nls_ZH))&&(i=!0),i},getClassAttributeSearch:function(e){var t=this;e=e||"";var r=i.getContent().getView().getPADTreeDocument();r.withTransactionUpdate((function(){var i=!0;r.search({match:function(r){t.searchMatchCriteria(e,r)?(r.nodeModel.show(),e.length>0&&i?(r.nodeModel.matchSearch(),i=!1):(r.nodeModel.unmatchSearch(),r.nodeModel.unselect())):(r.nodeModel.unmatchSearch(),r.nodeModel.unselect(),r.nodeModel.hide())}})}))},isSearchInContextAvailable:function(){return!1},getLibraryControl:function(){return i},getSearchWithinController:function(){return d},getCommandManager:function(){return n},getIndexModePanelHelp:function(){return"Lbc3DDashUAPanelMap/lbc3ddash-c-index-database-mode.htm"},getSearchTooltip:function(){let e={};return e=1==s.getWidgetData().currentWidgetTab?{title:l.searchTooltip.title,shortHelp:l.attrSearchshortHelp}:{title:l.searchTooltip.title,shortHelp:l.searchTooltip.shortHelp,longHelp:l.searchTooltip.longHelp},e},getLibraryTypeService:function(){return o},advanceSearchWithinWidget:function(){return!1}})}));