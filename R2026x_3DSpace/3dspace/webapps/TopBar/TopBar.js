require.config({paths:{vuex:`${window.dsDefaultWebappsBaseUrl||""}vuex/3.1.1/vuex.min`}}),define("DS/TopBar/model/MainMenuBar",["UWA/Core","UWA/Utils/InterCom","UWA/Utils","DS/TopBarProxy/Menu","DS/TopBarProxy/MenuBarItem","DS/vue/vue","DS/vuekit/vuekit"],(function(e,t,n,i,o,a){"use strict";var s,r,c;function l(t,n,i){var o,a,s;if(!e.is(t,"object"))return t;for(o=0,a=(s=Object.keys(t)).length;o<a;o++)n.call(i,t[s[o]],s[o],t);return t}return r={},c=["away","active","busy","offline"],s=i.singleton({model:o,uwaClassName:"DS/TopBar/model/MainMenuBar",uninitializedCalls:"throw",alwaysActiveMenuProvidersIds:[],activeMenuProvidersIds:[],_activeProxiesIds:[],setStaticMenuProviders:function(e){this.alwaysActiveMenuProvidersIds=n.splat(e),this.setActiveMenuProviders(this.activeMenuProvidersIds)},setActiveMenuProviders:function(e){this.activeMenuProvidersIds=this.alwaysActiveMenuProvidersIds.concat(n.splat(e)),this._computeActiveProxiesIds(),this._setActiveProxiesIdsOnTopMenuItems()},_computeActiveProxiesIds:function(){this._activeProxiesIds=[],this.activeMenuProvidersIds.forEach((function(e){l(r[e],(function(e,t){!0===e&&this._activeProxiesIds.push(t)}),this)}),this)},_setActiveProxiesIdsOnTopMenuItems:function(){this.forEach((function(e){e.setActiveProxyIds(this._activeProxiesIds)}),this)},getActiveMenuProviders:function(){return this.activeMenuProvidersIds},init:function(e){this._parent(null,e)},setup:function(i,o){var a,s,r=[],c=this;this._server=new t.Server("MainMenuBar",{isPublic:!1}),l({activate:"_activateProxy",deactivate:"_deactivateProxy",die:"_unregisterProxy",subscribeToChannel:"_registerProxy",setContent:"setContent",onSubMenuReady:"fireOnSubMenuReady"},(function(e,t){this._server.addListener(t,(function(t,n){c[e].call(c,n.origin.socket,t)}))}),this),["onExecute","onSubMenuDisplayed"].forEach((function(e){this.addEvent(e,(function(t,i){this._server.dispatchEvent(e,i,null,n.splat(t))}),this)}),this),s=["context","profile","notification","add","share","content","enovTasks","social","home","help"],(a=o&&o.topMenus)?s.forEach((function(e){var t,n;(t=a)[n=e]&&r.push({id:n,value:t[n]})})):r=[{id:"context"},{id:"profile"},{id:"add"},{id:"share"},{id:"home"},{id:"help"}],r.push({id:"search"}),this.add(r.map((function(t){var n={id:t.id,label:t.id.ucfirst(),submenu:[],onExecute:e.is(t.value,"function")?t.value:void 0};return"profile"===t.id&&(n.userName=o.userName),n})),{silent:!0}),this.setActiveMenuProviders([]),this.addUserPresence(o.tenantId,o.swymUrl,o.userId)},addUserPresence:async function(e,t,n){t||(t=await this.loadSwymUrl());var i=window.dsUserLogin?window.dsUserLogin:n;this._loadModules(["DS/RTVueUserPresenceAPI/RTVueUserPresenceAPI"]).then((function(){try{document.mainvue=new a({el:".user-presence",template:`<vu-rtuserpresence tenantId="${e}" login="${i}" swymUrl="${t}" :noTooltip="false" class="small bgBlue" />`})}catch(e){}}))},setContent:function(e,t){var n,i=t.onSubMenuDisplayed||{};this.forEach((function(o){var a,s;a=o.id,(s=t[a])&&(o.get("submenu").setItems(e,s),i[a]&&((n=o.get("onSubMenuDisplayed")||{})[e]=!0,o.set("onSubMenuDisplayed",n)))}),this)},fireOnSubMenuReady:function(e,t){var n=this.get(t);n&&n.dispatchEvent("onSubMenuReady",[e])},_setProxyActivateStatus:function(t,n,i){var o,a,s,c=r[n];if(e.is(c,"object")&&(a=c[t]),!e.is(a,"boolean"))throw s=this.uwaClassName,new Error(s+": Failed to "+(!1===i?"deactivate":"activate")+" unknown Proxy "+t+" (channel:"+n+")");i!==a&&(c[t]=i,this.activeMenuProvidersIds.indexOf(n)>-1&&(!0===i?this._computeActiveProxiesIds():(o=this._activeProxiesIds.indexOf(t))>-1&&this._activeProxiesIds.splice(o,1),this._setActiveProxiesIdsOnTopMenuItems()))},_deactivateProxy:function(e,t){return this._setProxyActivateStatus(e,t,!1)},_activateProxy:function(e,t){return this._setProxyActivateStatus(e,t,!0)},_unregisterProxy:function(e,t){this.setContent(e,{profile:[],add:[],share:[],home:[],help:[],notification:[],social:[],content:[],enovTasks:[]}),this._deactivateProxy(e,t),delete r[t][e],this._server.unsubscribeSocket(e)},_registerProxy:function(t,n){var i=r[n],o=this.getWidgetInstance(n)||{};if(i&&!o.data||(i=r[n]={}),e.is(i[t],"boolean"))throw new Error("Proxy "+t+" is already registered on channel "+n);i[t]=!1,this._activateProxy(t,n)},_removeProvider:function(e){var t=this,n=r[e];n&&(l(n,(function(n,i){t._unregisterProxy(i,e)})),delete r[e])},setStatus:function(t){var n=this.get({id:"profile"});n?n.set("status",c.indexOf(t)>=0?t:""):e.log("MainMenuBar: Could not change status")},setBadge:function(e,t){var n=this.get({id:e});n&&n.set("countBadge",t)},toJSON:function(e){var t={};return this.forEach((function(n){t[n.id]=n.toJSON(e)}),this),t},dump:function(t){t||(t=" "),e.log("Dumping MenuBar: "),this.invoke("dump",t),e.log("JSON value: "),e.log(this.toJSON())},_loadModules:function(t){var n=[];return e.is(t,"string")?n[0]=t:n=t,new Promise((function(e,t){require(n,(function(){e(Array.prototype.slice.call(arguments))}),(function(e){t("Error loading modules."+(e&&e.requireModules?e:""))}))}))},getWidgetInstance:function(t){return e.Widgets&&e.Widgets.instances.find((function(e){return e.id===t}))},loadSwymUrl:async function(){try{const e=await this._loadModules(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"]),t=()=>new Promise(((t,n)=>{e[0].getPlatformServices({onComplete:e=>{const i=e&&e[0],o=i&&i["3DSwym"];o?t(o):n(new Error("Swym URL not found"))}})}));return await t()}catch(e){}}}),s})),define("TopBar/model/MainMenuBar",["DS/TopBar/model/MainMenuBar"],(function(e){"use strict";return e})),define("DS/TopBar/utils/Utils",["UWA/Core"],(function(e){"use strict";var t,n=function(){function e(e){if(null==e)throw new TypeError("assign cannot be called with null or undefined");return Object(e)}return Object.assign?Object.assign:function(t){var n,i,o,a,s,r=e(t);if(1===arguments.length)return r;for(n=1;n<arguments.length;n++)if(null!=(i=arguments[n]))for(o=e(i),a=Object.keys(o),s=0;s<a.length;s++)r[a[s]]=o[a[s]];return r}}();return t={debounce:function(e,t,n){var i;return function(){var o,a=this,s=arguments;o=n&&!i,clearTimeout(i),i=setTimeout((function(){i=null,n||e.apply(a,s)}),t),o&&e.apply(a,s)}},throttle:function(e,t){var n,i,o,a,s=0;function r(){s=Date.now(),o=null,a=e.apply(n,i)}return function(){var c=Date.now(),l=t-(c-s);return n=this,i=arguments,l<=0?(clearTimeout(o),o=null,s=c,a=e.apply(n,i)):o||(o=setTimeout(r,l)),a}},result:function(t,n){var i;return t?(i=t[n],"function"===e.typeOf(i)?i.call(t):i):null},pick:function(t){var i,o,a;return o={},a=e.is,i=n.apply(null,Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1)).map((function(e){var t;return a(e,"string")?(t={})[e]=e:a(e,"plain")&&(t=e),t}))),Object.keys(i).forEach((function(e){var n,s;e in t&&null!=(n=t[e])&&""!==n&&(s=i[e],a(s,"string")&&(o[s]=t[e]))})),o},renderInitials:function(t,n){var i,o,a,s,r,c,l=["#42A2DA","#57B847","#EA4F37","#00B8DE","#E87B00","#9B2C98","#00AA86","#F564A3","#FF8A2E","#6D2815"];n=e.merge(n||{},{className:"",seed:0});return i=e.createElement("div",{class:"initials-view "+n.className}),(o=(t||"").trim().split(" ")).length<2||(a=((r=o[0].substr(0,1))+(c=o[1].substr(0,1))).toUpperCase(),s=Math.ceil((r.charCodeAt(0)+c.charCodeAt(0)+n.seed)%l.length),i.setStyles({"background-color":n.backgroundColor?n.backgroundColor:l[s]}),i.setText(a)),i},find:function(e,t){if(!Array.isArray(e))throw new TypeError("TopBarUtils > find must be call on Array");if("function"!=typeof t)throw new TypeError("TopBarUtils > callback must be a function");for(var n=0;n<e.length;n++){if(t(e[n]))return e[n]}return null},getAllTenants:function(e){return e=e||{},new Promise((function(t){require([["DS","i3DXCompassPlatformServices","i3DXCompassPlatformServices"].join("/")],(function(n){n.getPlatformServices({public:e.public,role:e.role,onComplete:function(n){n=n||[];var i=e.serviceName;t(i?n.filter((function(e){return e[i]})):n)},onFailure:function(){t([])}})}),(function(){t([])}))}))},getTenant:function(e,t,n){var i=this;return new Promise((function(o){e?(t?t(n):i.getAllTenants(n)).then((function(t){if(t.length){var n=i.find(t,(function(t){return[e,t.platformId,t.displayName].every(i.isString)&&t.platformId.toLocaleLowerCase()===e.toLocaleLowerCase()||t.displayName.toLocaleLowerCase()===e.toLocaleLowerCase()}));o(n)}else o(null)})):o(null)}))},getTenants:function(e,t,n){var i=this,o=[];return new Promise((function(a){if(e.length)return e.forEach((function(e){o.push(i.getTenant(e,t,n))})),Promise.all(o).then((function(e){return a(e)}));a([])}))},buildPath:function(){var e=[],t=arguments.length-1;return Array.prototype.forEach.call(arguments,(function(n,i){n&&(n+="",0!==i&&(n=n.replace(/^\//,"")),i!==t&&(n=n.replace(/\/$/,"")),e.push(n))})),e.join("/")},getAllCollabSpaces:function(e){var t=this;return e.platformId?new Promise((function(t){require([["DS","i3DXCompassPlatformServices","i3DXCompassPlatformServices"].join("/")],(function(n){n.getServiceUrl({serviceName:"3DSpace",platformId:e.platformId,onComplete:t,onFailure:function(){t([])}})}),(function(){t([])}))})).then((function(e){return new Promise((function(n,i){var o=t.buildPath(e,"/resources/modeler/pno/person?current=true&select=collabspaces");require([["DS","WAFData","WAFData"].join("/")],(function(e){e.authenticatedRequest(o,{method:"GET",type:"json",onComplete:function(e){n((e||{}).collabspaces)},onFailure:function(){n([])}})}),(function(e){n([])}))}))})):Promise.resolve([])},getAllCredentials:function(e){return this.getCollabSpace(e).then((function(e){return e&&e.couples}))},getCredential:function(e){var t=this;return e.credentialId&&e.credentialId.role&&e.credentialId.organization?t.getAllCredentials(e).then((function(n){return t.find(n,(function(t){return t.role.name===e.credentialId.role&&t.organization.name===e.credentialId.organization}))})):Promise.resolve(null)},getCredentials:function(e){var t=this,n=[];return new Promise((function(i){if(e.length)return e.forEach((function(e){n.push(t.getCredential(e))})),Promise.all(n).then((function(e){return i(e)}));i([])}))},getCollabSpace:function(e){var t=this;return e.collabSpaceId?t.getAllCollabSpaces(e).then((function(n){return t.find(n,(function(t){return t.name===e.collabSpaceId||t.pid===e.collabSpaceId||t.title===e.collabSpaceId}))})):Promise.resolve(null)},getCollabSpaces:function(e){var t=this,n=[];return new Promise((function(i){if(e.length)return e.forEach((function(e){n.push(t.getCollabSpace(e))})),Promise.all(n).then((function(e){return i(e)}));i([])}))},isString:function(e){return"string"==typeof e||e instanceof String}},t})),define("DS/TopBar/views/MenuItemView",["UWA/Core","UWA/Event","UWA/Element","UWA/Class/View","require"],(function(e,t,n,i,o){"use strict";var a;return i.extend({tagName:"li",className:"menu-item",setup:function(){var e;this.listenTo(this.model,{onChange:this.update,"onChange:label":this.updateLabel,"onChange:checked":this.updateChecked,"onChange:className":this._updateClassName,onBadgeSumChange:this._updateCountBadge,onRemove:this.remove}),(e=this.model.get("className"))&&e.length&&this.container.addClassName(e)},destroy:function(){this.stopListening(),this._parent()},getContent:function(){var n,i,s,r=this,c=this.model.get("submenu"),l=e.is(c),d=this.model.get("onExecute"),u=this.model.get("group")&&l,m=this.model.get("separator");return this.container.firstChild?this.container:m?(this.container.addClassName("separator"),this.container):(u?this.container.addClassName("menu-item-group"):(this.container.addContent({tag:"div",class:"header",html:[{tag:"span",class:"menu-item-icon menu-item-icon-before"},{tag:"span",class:"menu-item-text",text:this.model.get("label")},{tag:"span",class:"menu-item-badge"}]}),this.model.get("checked")&&this.container.getElement(".menu-item-icon-before").addClassName("checked"),this.$countBadge=this.container.getElement(".menu-item-badge"),"checkbox"===this.model.get("type")?this.container.getElement(".menu-item-icon-before").addClassName("menu-checkbox"):this.model.get("icon")&&this.container.getElement(".menu-item-icon-before").addClassName("fonticon fonticon-"+this.model.get("icon")),this.model.get("icon-after")&&this.container.getElement(".header").addContent({tag:"span",class:"menu-item-icon menu-item-icon-after fonticon fonticon-"+this.model.get("icon-after")})),l&&(a||(a=o("DS/TopBar/views/MenuView").extend({className:"sub-menu"})),i=new a({model:c}),u?n=this.container:(s=function(e){r.toggleSubMenu(),t.stop(e)},d?(this.container.addClassName("executable"),this.container.addContent({tag:"span",class:"menu-item-submenu-icon",events:{click:s}}),this.container.getElement(".header").addEvent("click",(function(e){r.container.hasClassName("executable")||s(e)}))):(this.container.getElement(".header").addContent({tag:"span",class:"menu-item-submenu-icon"}),this.container.addEvent("click",s)),n=e.createElement("div",{class:"menu-item-submenu"}),this.container.addContent(n)),i.inject(n)),this.model.get("onExecute")?this.container.addEvent("click",(function(e){r.model.execute(),t.stop(e)})):l||this.container.addEvent("click",(function(e){t.stop(e)})),this.container)},onPostInject:function(){this.$countBadge&&this._updateCountBadge()},update:function(e){e.hasChanged("label")||e.hasChanged("checked")||e.hasChanged("_countBadgeSum")},updateChecked:function(){this.container.getElement(".menu-item-icon-before").toggleClassName("checked")},updateLabel:function(e,t){this.container.getElement(".menu-item-text").setText(t)},remove:function(){this.toggleSubMenu(!1),this.destroy()},toggleSubMenu:function(t){var n=null;e.is(this.model.get("submenu"))&&(this.container.toggleClassName("expanded",t),this.model.get("onExecute")&&this.container.toggleClassName("executable",e.is(t)?!t:void 0),n=this.container.getClosest(".menu"),e.is(n)&&n.toggleClassName("sub-menu-expanded",t))},_updateCountBadge:function(){var e=this.model._getCountsSum();this.$countBadge&&(e&&this.$countBadge.setText(e>99?"99+":e),this.container.toggleClassName("badge",e))},_updateClassName:function(e,t){var n=this.model.previous("className");n&&this.container.removeClassName(n),t&&this.container.addClassName(t)}})})),define("DS/TopBar/utils/Debuggable",["UWA/Core","UWA/Class/Debug"],(function(e,t){"use strict";var n;return n=t.extend({log:function(t){var n=e.is(this.uwaClassName,"string")?this.uwaClassName:"[UNKNOWN]";return this._parent(String.prototype.format.apply(n+": "+t,[].slice.call(arguments,1)))}}),n})),define("DS/TopBar/views/Menu",["UWA/Core","UWA/Element","UWA/Event","UWA/Utils","UWA/Controls/Abstract"],(function(e,t,n,i,o){"use strict";var a,s=(a=/^(header|divider)$/,function(e){if(!e)return!1;for(var t=e.split(" "),n=0;n<t.length;n++)if(a.test(t[n]))return!0;return!1});var r,c={name:"",templateClassname:"",items:null,isVisible:!1,keyboardIndex:-1,defaultOptions:{multiSelect:!1,attributes:{}},init:function(e){void 0===(e=e||{}).kb&&(e.kb=!0),this._parent(e),this.items=[],this.buildSkeleton(),e.items&&e.items.forEach((function(e){this.addItem(e)}),this)},buildSkeleton:function(){var t=e.createElement,n=this.elements;n.container||(n.container=t("div",{class:this.getClassNames(),styles:{display:"none","z-index":26}}),Object.keys(this.options.attributes).forEach((function(e){n.container.setAttribute(e,this.options.attributes[e])}),this),n.wrapper=t("ul",{class:this.name+"-wrap",tabindex:"1"}),this.options.multiSelect&&n.wrapper.addClassName("dropdown-multiselect"),n.wrapper.inject(n.container))},hide:function(){return this.isVisible&&(this.isVisible=!1,this.getContent().setStyle("display","none"),this.dispatchEvent("onHide")),this},show:function(){return this.isVisible||(this.isVisible=!0,this.getContent().setStyle("display",""),this.focusIt(),this.dispatchEvent("onShow")),this},focusIt:function(){this.options.kb&&this.elements.wrapper.focus()},addItem:function(e){var t=this;return i.splat(e).forEach((function(e){t._addItem(e)})),this},_addItem:function(t){var n,o,a=this.elements,r=t.className||"",c={},l=this;return c.id=t.id||"itm-"+i.getUUID().substr(0,6),t.name||(c.name=t.text),t.disabled&&(r+=" disabled"),t.selected&&(t.selectable=!0),t.selectable&&(r+=" selectable",c.toggleSelection=function(){l.toggleSelection(c)}),c.elements={},c.elements.container=e.createElement("li",{class:"item "+r,id:c.id,title:t.title||""}),Object.keys(t.attributes||{}).forEach((function(e){c.elements.container.setAttribute(e,t.attributes[e])})),t.name&&c.elements.container.set("name",t.name),t.template?c.elements.content=e.createElement("div",{class:"item "+this.templateClassname,id:c.id,html:t.template}).inject(c.elements.container):t.text&&(c.elements.content=e.createElement("span",{class:"item-text",text:t.text||""}).inject(c.elements.container)),s(t.className)?c.elements.container.removeClassName("item"):(t.fonticon&&(c.elements.icon=e.createElement("span",{class:"fonticon fonticon-"+t.fonticon}).inject(c.elements.container,"top"),a.wrapper.addClassName(this.name+"-icons")),!t.fonticon&&t.icon&&(o=t.icon,/\.(gif|jpg|jpeg|tiff|png)$/i.test(o)?c.elements.icon=e.createElement("img",{src:t.icon,class:"item-icon"}):c.elements.icon=e.createElement("span",{class:t.icon}),c.elements.icon.inject(c.elements.container,"top"),a.wrapper.addClassName(this.name+"-icons"))),t.handler&&e.is(t.handler,"function")&&(c.handler=t.handler),t.index&&t.index!==this.items.length+1?(n=this.items[t.index-1],c.elements.container.inject(n.elements.container,"before"),this.items.splice(t.index-1,0,e.merge(c,t))):(c.elements.container.inject(a.wrapper),this.items.push(e.merge(c,t))),t.selected&&this.select(c),c},removeItem:function(e){var t=this;return i.splat(e).forEach((function(e){t._removeItem(e)})),this},_removeItem:function(e){var t=this.getItem(e);t&&(t.elements.container.destroy(),this.items.splice(this.items.indexOf(t),1))},updateItem:function(e){var t=this;return i.splat(e).forEach((function(e){t._updateItem(e)})),this},_updateItem:function(t){var n,i=this.getItem(t.id);i&&(e.is(t.text)&&i.text!==t.text&&(i.text=t.text,i.elements.container.getElement(".item-text").setText(t.text)),n=i.elements.container.getElement("."+this.templateClassname),e.is(t.template)&&n&&n.setHTML(t.template),e.is(t.name)&&i.name!==t.name&&(i.name=t.name),e.is(t.title)&&i.title!==t.title&&(i.title=t.title,i.elements.container.title=t.title),e.is(t.fonticon)&&i.fonticon!==t.fonticon?(i.fonticon=t.fonticon,function(t){t.elements.icon&&t.elements.icon.destroy(),t.elements.icon=e.createElement("span",{class:"fonticon fonticon-"+t.fonticon}).inject(t.elements.container,"top")}(i)):e.is(t.icon)&&i.icon!==t.icon&&(i.icon=t.icon,function(t){t.elements.icon&&t.elements.icon.destroy(),t.elements.icon=e.createElement("span",{class:t.icon}).inject(t.elements.container,"top")}(i)),e.is(t.disabled)&&i.elements.container.toggleClassName("disabled",t.disabled),e.is(t.className)&&i.className!==t.className&&(i.elements.container.removeClassName(i.className),i.elements.container.addClassName(t.className),i.className=t.className,s(t.className)?i.elements.container.removeClassName("item"):i.elements.container.addClassName("item")),e.is(t.handler)&&(i.handler=t.handler))},enableItem:function(e){var t=this.getItem(e);return t&&t.elements.container.removeClassName("disabled"),this},disableItem:function(e){var t=this.getItem(e);return t&&t.elements.container.addClassName("disabled"),this},getItem:function(e){var t,n,i,o=!1;for(t=0,n=this.items.length;t<n;t+=1){if(o=this.items[t],e&&e.nodeType){if(i=e.hasClassName("item")?e:e.getParent(),o.id===i.id)break}else if(t===e||o.id===e||o.name===e)break;o=!1}return o},_hoverItem:function(e,t){var n=this.getItem(e);n&&((t=void 0===t||t)?(n.elements.container.addClassName("js-selected"),this.options.kb&&n.elements.container.focus()):n.elements.container.removeClassName("js-selected"))},_updateKeyboardIndex:function(e,t){var n,i=t||this.keyboardIndex,o=this.keyboardIndex,a=!1;-1===i&&"reset"!==e?(i=0,a=!0):"down"===e&&i<this.items.length-1?(i+=1,a=!0):"up"===e&&i>0?(i-=1,a=!0):"reset"===e&&(this._hoverItem(i,!1),i=-1),(n=this.getItem(i))&&s(n.elements.container.className)&&(a=!1,"down"!==e&&"up"!==e||this._updateKeyboardIndex(e,i)),a&&i>=0&&(this._hoverItem(o,!1),this._hoverItem(i),this.keyboardIndex=i)},toggleSelection:function(e){this.select(e,!e.selected)},select:(r=function(e,t){e.selected=t,e.elements.container[t?"addClassName":"removeClassName"]("selected")},function(e,t){var n,i=!this.options.multiSelect;if(void 0===t||!0===t)i&&(n=this.items.filter((function(e){return e.selected})),n[0]&&r(n[0],!1)),r(e,!0);else{if(i&&e.selected)return;r(e,!1)}})};return o.extend(c)})),define("DS/TopBar/views/DropdownMenu",["UWA/Core","UWA/Element","UWA/Event","UWA/Utils","DS/UIKIT/Dropdown","DS/UIKIT/Menu"],(function(e,t,n,i,o,a){"use strict";var s="dropdown-menu",r="item",c="item-submenu",l="item-template",d=a.extend({name:s,templateClassname:l});function u(e,t,n){Object.keys(e).forEach((function(i){!function(e,t,n,i){t.addEventListener?t.addEventListener(e,n,i):t.attachEvent&&t.attachEvent("on"+e,n,i)}(i,t,e[i],n)}))}var m,h=(m=/^(header|divider|disabled)$/,function(e){if(!e)return!1;for(var t=e.split(" "),n=0;n<t.length;n++)if(m.test(t[n]))return!0;return!1}),p={name:s,items:null,menus:null,activeMenu:null,defaultOptions:{subMenuMaxDepth:20},init:function(e){this.menus=[],this.items=[],null==(e=e||{}).kb&&(e.kb=!0),this.setupTemplates(e),this._parent(e),this.menus.reverse()},buildSkeleton:function(){var e,t=this.elements,n=this.options;t.container||(e=this.addMenu(n.items,0,null,n.multiSelect),t.container=e.elements.container,t.container.className=this.getClassNames(),this._handleEvents())},addMenu:function(t,n,i,o){var a,s=[],r=[];return t.forEach((function(e,t){e.items&&n<this.options.subMenuMaxDepth&&(s.push(this.addMenu(e.items,n+1,e.position,e.multiSelect)),r.push(t))}),this),(a=new d({kb:this.options.kb,multiSelect:o,items:t,attributes:this.options.attributes})).position=i||"bottom right",this.menus.push(a),this.items=this.items.concat(a.items),s.length&&s.forEach((function(t,n){var i,o=a.getItem(r[n]);t.inject(o.elements.container),o.elements.container.addClassName(c),(i=e.createElement("div",{class:"next-icon"})).inject(o.elements.container),e.createElement("span",{class:"fonticon fonticon-right-open"}).inject(i),t.parentItem=o})),a},setupTemplates:function(t){this.template={},this.template.getItem=function(e){return e.hasClassName(r)?e:e.getParent("."+r)},e.extend(this.template,t.template)},addItem:function(e){var t=this;return i.splat(e).forEach((function(e){t._addItem(e)})),this},_addItem:function(t){var n,i,o,a=this;function s(t,n,i){var o,s=a.addMenu(n,0,null,i);return s.inject(a.elements.container),t.elements.container.addClassName(c),(o=e.createElement("div",{class:"next-icon"})).inject(t.elements.container),e.createElement("span",{class:"fonticon fonticon-right-open"}).inject(o),s.parentItem=t,a.updatePosition(),s}if(t.parentItemId)if(i=function(e){var t=a.getItem(e);return t&&a._getMenuFromParentItem(t.id)}(t.parentItemId),i)t.items?t.text||t.name?((n=i._addItem(t))&&this.items.push(n),n&&s(n,t.items,t.multiSelect)):t.items.forEach((function(e){a.items.push(i._addItem(e))})):this.items.push(i._addItem(t));else{if(!(o=this.getItem(t.parentItemId)))return;t.items&&(t.text||t.name)?i=s(o,[t],t.multiSelect):s(o,t.items||[t],t.multiSelect)}else i=this.menus[0],t.items?((o=i._addItem(t))&&this.items.push(o),o&&s(o,t.items,t.multiSelect)):this.items.push(i._addItem(t))},removeItem:function(e){var t=this;return i.splat(e).forEach((function(e){t._removeItem(e)})),this},_removeItem:function(e){var t,n=this,i=this.getItem(e);i&&((t=this._getMenuFromParentItem(i.id))&&(this.items=this.items.filter((function(i){var o=n._getMenuFromItem(i.id);return!(!o||o.parentItem&&(!o.parentItem||o.parentItem.id===e))||(t.removeItem(i),!1)})),this.menus.splice(this.menus.indexOf(t),1),t.destroy()),(t=this._getMenuFromItem(i.id))&&t.removeItem(e),this.items.splice(this.items.indexOf(i),1))},updateItem:function(e){var t=this;return i.splat(e).forEach((function(e){t._updateItem(e)})),this},_updateItem:function(e){var t,n;(n=this.getItem(e.id))&&(t=this._getMenuFromItem(n.id),e.id=n.id,t&&t.updateItem(e))},enableItem:function(e){var t=this.getItem(e);return t&&t.elements.container.removeClassName("disabled"),this},disableItem:function(e){var t=this.getItem(e);return t&&t.elements.container.addClassName("disabled"),this},getItem:function(e){var t,n,i,o=!1;for(t=0,n=this.items.length;t<n;t++){if(o=this.items[t],e&&e.nodeType){if(i=e.hasClassName(r)?e:e.getParent(),o.id===i.id)break}else if(t===e||o.id===e||o.name===e)break;o=!1}return o},updatePosition:function(e){var t=this;if(this._parent(e),this.isVisible&&!(this.menus.length<=1)){this.getContent().addClassName("js-visible");for(var n=1,i=this.menus.length;n<i;n++)o=this.menus[n],a=void 0,s=void 0,r=void 0,c=void 0,l=void 0,d=void 0,u=void 0,l=(c="bottom")+"-"+(r="right"),d=o.getContent(),u=d.getSize(),o._position&&d.removeClassName(o._position),d.addClassName(l),a=d.getPosition(t.getContent()),s=d.getPosition(),(t._position.offsets.x+a.x+u.width>t._position.viewportWidth||o.position&&o.position.indexOf("left")>-1&&t._position.offsets.x+a.x-s.x-u.width>0)&&(r="left"),(t._position.offsets.y+a.y+u.height>t._position.viewportHeight+t._position.scrollTop||o.position&&o.position.indexOf("top")>-1&&t._position.offsets.y+a.y-s.y-u.height>t._position.scrollTop)&&(c="top"),o._position=c+"-"+r,l!==o._position&&(d.removeClassName(l),d.addClassName(o._position));var o,a,s,r,c,l,d,u;this.getContent().removeClassName("js-visible")}},show:function(e,t){var n;if(this.items.length)return n=this._parent(e,t),this.activeMenu=this.menus[0],this.activeMenu.keyboardIndex=-1,this.activeMenu.focusIt(),this.usingKeyboard=!1,n},hide:function(e){return this._hideSubmenus(),this._parent(e)},_getMenu:function(e){var t,n,i=!1;for(t=0,n=this.menus.length;t<n&&(i=this.menus[t],!e||!e.nodeType||i.elements.container!==e)&&(t!==e&&i.id!==e&&i.name!==e);t++)i=!1;return i},_getMenuFromItem:function(e){return this.menus.filter((function(t){return t.getItem(e)}))[0]},_getMenuFromParentItem:function(e){return this.menus.filter((function(t){return t.parentItem&&(t.parentItem.id===e||t.parentItem.name===e||t.parentItem.value===e)}))[0]},_hideSubmenus:function(e){var t,n,i=this;if(this.menus.length<=1)this.menus[0].items.forEach((function(e){(e=e.elements&&e.elements.container).removeClassName("js-selected")}));else if(e)!function e(n){n&&n.items.forEach((function(n){(n=n.elements&&n.elements.container)&&n.hasClassName(c)&&(t=i._getMenuFromParentItem(n.id),n.removeClassName("js-selected"),t&&t._updateKeyboardIndex("reset"),t&&t.hide(),e(t))}))}(i._getMenuFromItem(e));else for(var o=1,a=this.menus.length;o<a;o++)(t=this.menus[o]).hide(),(n=t.parentItem&&this.getItem(t.parentItem.id))&&n.elements.container.removeClassName("js-selected")},_handleItemSelection:function(e){var t;this.timeoutId&&clearTimeout(this.timeoutId),e.hasClassName(c)||e.hasClassName(l)?(t=this._getMenuFromParentItem(e.id))&&!t.isVisible&&(this._hideSubmenus(e.id),t=this._getMenuFromParentItem(e.id),e.addClassName("js-selected"),t&&t.show(),this.activeMenu=t):e.hasClassName(r)&&this._hideSubmenus(e.id)},_handleItemClick:function(t,i){var o=n.getElement(t),a=e.Utils.Client.Features.touchEvents,s=!1;if(!i){if(!(i=this.template.getItem(o)))return;i=this.getItem(i.id?i.id:i)}i&&!h(i.elements.container.className)&&(i.selectable&&i.toggleSelection(),a&&(this._handleItemSelection(i.elements.container),s=i.elements.container.hasClassName(c)),this.dispatchEvent("onClick",[t,i,s],this),e.is(i.handler,"function")&&i.handler.call(this,t))},_handleEvents:function(){var t=this,i=this.options;this.events.container={click:function(e){t._handleItemClick(e)},mouseleave:this.dispatchEvent.bind(this,"onMouseLeave"),mouseover:function(e){!t.usingKeyboard&&t._handleItemSelection(n.getElement(e))},mouseout:function(){t.usingKeyboard||(t.timeoutId=setTimeout(t._hideSubmenus.bind(t),500))}},i.kb&&(this.events.container.keydown=function(n){var o,a,s;function r(){t.activeMenu.hide(),(a=t._getMenuFromItem(t.activeMenu.parentItem.id))&&(t.activeMenu=a,t.activeMenu.focusIt())}function c(){(o=t._getActiveItem())&&(o=o.elements.container,t._handleItemSelection(o)),t.activeMenu._updateKeyboardIndex()}switch(t.usingKeyboard=!0,n.which){case 13:(o=t._getActiveItem())&&t._handleItemClick(n,t._getActiveItem()),t.options.closeOnClick&&(t.hide(),i.target.focus()),e.Event.preventDefault(n);break;case 27:t.hide(),i.target.focus(),e.Event.preventDefault(n);break;case 37:s=t.activeMenu.elements.container,o=t._getActiveItem(),s.hasClassName("bottom-left")||s.hasClassName("top-left")?o&&o.elements.container.hasClassName("item-submenu")&&c():r(),e.Event.preventDefault(n);break;case 38:t.activeMenu._updateKeyboardIndex("up"),e.Event.preventDefault(n);break;case 39:s=t.activeMenu.elements.container,o=t._getActiveItem(),s.hasClassName("bottom-left")||s.hasClassName("top-left")?r():o&&o.elements.container.hasClassName("item-submenu")&&c(),e.Event.preventDefault(n);break;case 40:t.activeMenu._updateKeyboardIndex("down"),e.Event.preventDefault(n);break;default:e.Event.preventDefault(n)}}),this.elements.container.addEvents(this.events.container),i.contextual?(this.events.target={mousedown:function(t){var i=n.getElement(t),o=2===e.Event.whichButton(t);i.isInjected(this.elements.container)||i===this.elements.container||o&&this.isVisible&&this.updatePosition(t)}.bind(this),contextmenu:function(e){this.show(!0,e),n.stop(e)}.bind(this)},u(this.events.target,i.target,!0)):i.bound&&(this.events.target={click:this.toggle.bind(this)},u(this.events.target,i.target,!0))},_getActiveItem:function(){var e=this.activeMenu.keyboardIndex;return!!(this.activeMenu&&e>=0)&&this.activeMenu.getItem(e)},getSelectedItems:function(){var e=[];return this.items&&(e=this.items.filter((function(e){return e.selected}))),e},isSelected:function(e){var t=this.getItem(e);return t&&t.selected},toggleSelection:function(e){e&&e.selectable&&e.toggleSelection()}};return o.extend(p)})),define("DS/TopBar/views/MenuView",["UWA/Core","UWA/Class/View","DS/TopBar/utils/Utils","DS/UIKIT/DropdownMenu","i18n!DS/TopBar/assets/nls/TopBar"],(function(e,t,n,i,o){"use strict";function a(e){return e?e.get("id")||e.id:null}var s=i.extend({init:function(e){this._parent(e)},_onKeyDown:function(e){[13,27,37,38,39,40].includes(e.which)&&this._parent(e)}});return t.extend({className:"",_target:null,_itemMap:null,_dropdownMenu:null,_isDirty:!0,_isActive:!1,setup:function(e){var t,n=this;if(!n.model)throw new Error("Incorrect arguments");n._target=e.target,t=n._mapItems(n.model,n._getItemConnections,n._onExecuteItem),n._itemMap=t.map,n._buildDdMenu(n._getInitialDDMenuOptions()),n._addCollectionListeners=n._addCollectionListeners.bind(n),n._initItem=n._initItem.bind(n),n._onExecuteItem=n._onExecuteItem.bind(n),n._onAdd=n._onAdd.bind(n),n._onRemove=n._onRemove.bind(n),n._onRefresh=n._onRefresh.bind(n),n._onUpdateItem=n._onUpdateItem.bind(n),n._bfsIterator(n.model,n._initItem,n._getItemConnections)},_getInitialDDMenuOptions:function(){var e,t=this;return e=t._mapItems(t.model,t._getItemConnections,t._onExecuteItem),{tenant:t.options.tenant,items:e.items.length>0?e.items:[{text:""}]}},_addTenantPlaceholder:function(e){var t=n.find(e.items,(function(e){return e&&e.name&&"context"===e.name}));return t&&(t.items=[{className:"topbar-menu-dd-item",disabled:!0,id:"context-placeholder",name:"context-placeholder",selectable:!1,selected:!1,template:'<span class="item-text">Loading ...</span>',text:"Loading ..."}]),e},_removeTenantPlaceholder:function(){return this._dropdownMenu.removeItem("context-placeholder")},_addTenants:function(e){var t=e||{},n=t&&t.currentTenant,i=n&&n.text,o=n&&n.fonticon,a=t&&t.tenants;t&&t.submenu?(this._dropdownMenu.addItem({parentItemId:"context",items:[{className:"topbar-menu-dd-item",fonticon:o,id:"tenant",name:i,text:i}]}),this._dropdownMenu.addItem({parentItemId:i,items:a.map((function(e){return e.className="topbar-menu-dd-item",e}))})):(a.length>0&&(this._dropdownMenu.getItem("context").items=[]),this._dropdownMenu.addItem({parentItemId:"context",items:a.filter((e=>0==this._dropdownMenu.items.filter((t=>t.name==e.name&&t.text==e.text)).length)).map((function(e){return e.className=e.className||"topbar-menu-dd-item",e}))}))},_addCollabSpaces:function(e){var t=e||{},n=t&&t.currentCollabSpace,i=n&&n.text,o=n&&n.fonticon,a=t&&t.collabSpaces;t&&t.submenu?(this._dropdownMenu.addItem({parentItemId:"context",items:[{className:"topbar-menu-dd-item",fonticon:o,id:"collabspace",name:i,text:i}]}),this._dropdownMenu.addItem({parentItemId:i,items:a.map((function(e){return e.className="topbar-menu-dd-item",e}))})):this._dropdownMenu.addItem({parentItemId:"context",items:a.map((function(e){return e.className="topbar-menu-dd-item",e}))})},_addCredentials:function(e){var t=e||{},n=t&&t.currentCredential,i=n&&n.text,o=n&&n.fonticon,a=t&&t.credentials;t&&t.submenu?(this._dropdownMenu.addItem({parentItemId:"context",items:[{className:"topbar-menu-dd-item",fonticon:o,id:"credential",name:i,text:i}]}),this._dropdownMenu.addItem({parentItemId:i,items:a.map((function(e){return e.className="topbar-menu-dd-item",e}))})):this._dropdownMenu.addItem({parentItemId:"context",items:a.map((function(e){return e.className="topbar-menu-dd-item",e}))})},_addContexts:function(e){var t,n,i,o,a,s,r,c=this;e().then((function(e){n=e.items[0],o=e.items[1],a=e.items[2],t=n&&n.items,i=o&&o.items,s=a&&a.items,r=t&&t.length&&i&&i.length,n&&t&&t.length>1?(c._updateContextTitle({readOnly:!1}),c._addTenants({currentTenant:n,tenants:t,submenu:r})):c._updateContextTitle({readOnly:c.model.get("readOnlyUserContext")}),o&&i&&i.length&&(c._addCollabSpaces({currentCollabSpace:o,collabSpaces:i,submenu:r}),a&&s&&s.length&&c._addCredentials({currentCredential:a,credentials:s,submenu:r})),c._removeTenantPlaceholder(),c._dropdownMenu.updatePosition()}))},_updateContextTitle:function(t){var n=this,i=t&&t.name,o=t&&t.readOnly;i&&n._dropdownMenu.updateItem({id:"context",text:i,name:i}),e.is(o,"boolean")&&n._dropdownMenu.updateItem({id:"context",className:o?"topbar-menu-dd-item read-only disabled":"topbar-menu-dd-item"}),n._dropdownMenu.updatePosition()},_buildDdMenu:function(t){var i=this,o=i.model.collection||"",r=o.indexOf(i.model),c=o.length&&o.length-r<=3,l=n.pick(i.options,["position","bound","closeOnClick","offset","events","renderTo","altPosition","multiSelect","subMenuMaxDepth","kb"]),d=e.extend(l,{className:"topbar-menu-dd context-dropdown-menu menu-context profile-dropdown-d-flex",items:t.items||i._getInitialDDMenuOptions().items,addTenantPlaceholder:t.addTenantPlaceholder,target:i._target,scrollableResponsive:!0,events:{onShow:i._handleDropdownEvents.bind(i,"onShow"),onHide:i._handleDropdownEvents.bind(i,"onHide"),onClick:i._handleDropdownEvents.bind(i,"onClick"),onClickOutside:i._handleDropdownEvents.bind(i,"onClickOutside"),onMouseLeave:i._handleDropdownEvents.bind(i,"onMouseLeave")}});i._dropdownMenu&&i._dropdownMenu.destroy(),i.model.id&&(d.position=c?"end-edge":"center"),d.addTenantPlaceholder&&(d=i._addTenantPlaceholder(d)),i._dropdownMenu=new s(d),i._dropdownMenu.elements.container.addClassName(a(i.model))},_handleDropdownEvents:function(e,t,n){var i=this,o=i.options.events;"onShow"===e&&(i._isActive=!0,i._isDirty&&(i._onRefresh(i.model.get("submenu"),[],{force:!0}),i.show())),"onHide"===e&&(i._isActive=!1),o&&o[e]&&o[e].apply(null,[t,n])},_initItem:function(e,t){t&&this._addCollectionListeners(t,{isRoot:this.model===e})},_onUpdateItem:function(e){var t,n,i=this,o=e.changedAttributes(),a=i._dropdownMenu;i._isActive?o&&a&&(t=a.getItem(e.id))&&(n={id:e.id,template:i._getItemTemplate(e),disabled:e.get("disabled"),selectable:e.get("checked")||"checkbox"===e.get("type")||e.get("selectable"),selected:e.get("checked")||e.get("selected"),multiSelect:e.get("multiSelect")},a.updateItem(n),n.selected!==t.selected&&t.toggleSelection&&t.toggleSelection(),i._onRefresh(i.model.get("submenu"),[])):i._isDirty=!0},_addCollectionListeners:function(e,t){t||(t={});var n=this;e&&n.listenTo(e,t.isRoot?{onAdd:n._onAdd,onRemove:n._onRemove,onChange:n._onUpdateItem,onChangeActivatedProxyIds:n._onRefresh}:{onAdd:n._onAdd,onRemove:n._onRemove})},_removeCollectionListeners:function(e){e&&this.stopListening(e)},getContent:function(){},toggle:function(){},_treeIterator:function(t,n,i,o){o||(o={});var a,s,r,c=[{model:t,parentModel:null,parentCollection:null}],l=!!o.dfs;function d(e){c.push(function(e){return{model:e,parentModel:a.model,parentCollection:a.connections}}(e))}function u(){if(l){if(a=c.pop(),s=a.connections=i(a.model))for(var e=s.length-1||0;e>=0;e--)d(s.at?s.at(e):s[e]);r=n(a.model,s,a.parentModel,a.parentCollection)}else a=c.splice(0,1)[0],(s=a.connections=i(a.model))&&s.forEach(d),r=n(a.model,s,a.parentModel,a.parentCollection)}for(;c.length>0&&(!e.is(r)||r);)u()},_bfsIterator:function(e,t,n){this._treeIterator.call(this,e,t,n)},_dfsIterator:function(e,t,n){this._treeIterator.call(this,e,t,n,{dfs:!0})},_getItemConnections:function(e,t){return t||(t={}),e.get("submenu")},_onAdd:function(t,n){var i,o,s,r,c=this,l=c._itemMap;c._isActive?l[a(t)]||n.getActiveItems&&n.getActiveItems().indexOf(t)<0||(o=c._mapItem(t,c._onExecuteItem.bind(null,t)),l[a(t)]=o,s=c._getParentModel(t,c._getItemConnections),i=c._mapItems(t,c._getItemConnections,c._onExecuteItem,{itemMap:l}),e.extend(l,i.map),i.items.length>0&&(o.items=i.items),s&&s!==c.model&&(o.parentItemId=a(s)),t.get("group")&&t.get("submenu")?(r=[],t.get("submenu").forEach((function(e){var t=l[a(e)];t&&r.push(t)})),c._dropdownMenu.addItem(r)):c._dropdownMenu.addItem(o),c._bfsIterator(t,c._initItem,c._getItemConnections),c._isActive&&!c.isVisible()&&c.show()):c._isDirty=!0},_onRemove:function(e){var t=this;t._bfsIterator(e,(function(e,n){t._removeCollectionListeners(n)}),t._getItemConnections),t._dropdownMenu.removeItem(a(e)),delete t._itemMap[a(e)]},_getParentModel:function(t,n){var i;return this._bfsIterator(this.model,(function(n,o,a){return i=t===n?a:i,!e.is(i)}),n),i},_onExecuteItem:function(e){e&&(e.execute?e.execute():e.get("onExecute")&&e.get("onExecute").call())},_onExecuteGroup:function(e,t,n){var i=this._dropdownMenu;t.get("multiSelect")||(this._getItemConnections(t)||[]).forEach((function(t){var n=i.getItem(t.id);t!==e&&n&&n.selected&&n.selectable&&n.toggleSelection()})),n(e)},_mapItems:function(e,t,i,o){o||(o={});var s=this,r=a(e),c=s.options,l=o.itemMap||Object.create(null);function d(e,t){return t.last?t.last()===e:t[t.length-1]===e}return s._dfsIterator(e,(function(e,t,o,r){var u,m,h,p=a(e),f=l[a(o)],g=n.pick(c,["multiSelect"]);if(e.get("separator")?u=s._mapItem(null,null,{type:"separator"}):e.get("group")?(e.get("label")||r&&(m=0,((h=r).at?h.at(m):h[m]||null)!==e))&&(u=s._mapItem(e,null,{type:"group"})):u=s._mapItem(e,i.bind(null,e),g),o)if(o.get("group")){var v=s._getParentModel(o,s._getItemConnections),b=l[a(v)];u.handler=s._onExecuteGroup.bind(s,e,o,i),b.items||(b.items=[]),b.items.push(u),d(e,r)&&o.collection&&!d(o,o.collection)&&b.items.push(s._mapItem(null,null,{type:"group"}))}else f.items||(f.items=[]),u&&f.items.push(u);u&&(l[p]=u)}),t),{items:l[r].items||[],map:l}},_mapItem:function(e,t,n){n||(n={});var i,s,r=e.get("id"),c=r&&o[r]||e.get("label");switch(n.type){case"separator":case"group":i=e&&e.collection&&e.get("label")?{className:"header",text:e.get("label")}:{className:"divider"};break;default:i={name:s=a(e),id:s,disabled:e.get("disabled"),text:c,template:this._getItemTemplate(e),selectable:e.get("checked")||"checkbox"===e.get("type")||e.get("selectable"),selected:e.get("checked")||e.get("selected"),className:"topbar-menu-dd-item "+e.get("className"),multiSelect:e.get("multiSelect"),handler:e.get("onExecute")&&t?t:void 0}}if(e.get("statusName")){const t=e.get("icon")||{};i.className+=" selectable user-presence ",i.fonticon=t&&t.fonticon&&t.fonticon.replace("fonticon-","")}return i},_getItemTemplate:function(e){var t="",n=e.get("id"),i=n&&o[n]||e.get("label")||"",a=e.get("fonticon")||"",s=e.get("icon")||"",r=e._getCountsSum?e._getCountsSum():0,c=e.get("disabled")?"disabled":"enabled";return a&&(t+='<span class="fonticon fonticon-'+a.escapeHTML()+" item-icon "+c+'"></span>'),s&&(t+='<span class="item-icon item-image '+c+'" style="background-image: url(\''+s+"')\"></span>"),r&&(t+='<span class="item-badge">'+(r>99?"+99":r)+"</span>"),t+='<span class="item-text">'+i.escapeHTML()+"</span>"},_onRefresh:function(e,t,n){n||(n={});var i,o=this;function a(e,t){t&&o._removeCollectionListeners(t)}o._isActive||n.force?(e.forEach((function(e){o._bfsIterator(e,a,o._getItemConnections)})),i=o._mapItems(o.model,(function(e){var t=e.get("submenu"),n=null;return t&&(n=t.getActiveItems?t.getActiveItems():t),n}),o._onExecuteItem),o._itemMap=i.map,o._buildDdMenu({items:i.items}),o._bfsIterator(o.model,o._initItem,o._getItemConnections),o._isDirty=!1,o._isActive&&!o.isVisible()&&o.show()):o._isDirty=!0},show:function(e){var t=this,n=e&&e.refresh;t._isActive=!0,t._isDirty=t._isDirty||!!n,t._isDirty&&t._onRefresh(t.model.get("submenu"),[]),t._dropdownMenu&&t._dropdownMenu.show()},hide:function(){this._isActive=!1,this._dropdownMenu&&this._dropdownMenu.hide()},isVisible:function(){return this._dropdownMenu&&this._dropdownMenu.isVisible},destroy:function(){var e=this;e._parent(),e._dropdownMenu.destroy(),e.container=null,e._target=null}})})),define("DS/TopBar/views/SearchView",["text!DS/TopBar/assets/templates/SearchView.html","DS/TopBar/assets/nls/TopBar_temp","DS/Handlebars/Handlebars4","UWA/Core","UWA/Element","UWA/Event","UWA/Class/View","DS/TopBar/utils/Debuggable","DS/TopBar/utils/Utils","DS/TopBar/views/MenuView","DS/UIKIT/Tooltip","i18n!DS/TopBar/assets/nls/TopBar"],(function(e,t,n,i,o,a,s,r,c,l,d,u){"use strict";function m(e,t,n){var o,a,s;if(!i.is(e,"object"))return e;for(o=0,a=(s=Object.keys(e)).length;o<a;o++)t.call(n,e[s[o]],s[o],e);return e}return s.extend(r,{uwaClassName:"SearchView",id:"global_ctn_search",className:"topbar-search",children:null,domEvents:{"click .topbar-search-cmd":"_onSearch","click .topbar-search-clear":"_onClearSearch","keyup .topbar-search-input":"_onSearchInputKeyUp","keydown .topbar-search-input":"_onSearchInputKeyDown"},template:n.compile(e),setup:function(e){var t=this;t.listenTo(this.model,{"onChange:searchOptionBox":t._updateSearchOptionName,"onChange:searchPlaceHolder":t._updateSearchPlaceHolder}),t.debugMode=c.result(e,"debugMode"),t.children={},t._filterInProgress=!1},destroy:function(){var e=this;e.stopListening(e.children.searchOptions),m(e.children,(function(e,t,n){e.destroy(),n[t]=null})),e.stopListening(e.model),e._parent(),e.container=null},_updateSearchOptionName:function(e,t){this.$searchOptionName.setText(t||"")},_updateSearchPlaceHolder:function(e,t){this.$searchInput.placeholder=t||""},_onSearch:function(){var e="search",t=this.$searchInput.value,n=""===t;this._filterInProgress=!n,this.model.hasEvent(e)&&this.model.dispatchEvent(e,{value:t})},_onClearSearch:function(){var e=this;e.$searchInput.value="",e.$clearSearchButton.hide(),e.model.hasEvent("clearSearch")&&e.model.dispatchEvent("clearSearch")},_onSearchInputKeyUp:function(e){var t=this;t.$searchInput.value?t.$clearSearchButton.setStyle("display","inline-block"):t._filterInProgress||t.$clearSearchButton.hide(),a.stopPropagation(e)},_onSearchInputKeyDown:function(e){"return"===a.whichKey(e)&&this._onSearch(),a.stopPropagation(e)},render:function(){var e,n=this;return n.model.set("tooltips",{search:u.search,clear:u.clear}),e=n.template({model:n.model.toJSON(),nls:u}),n.container.setContent(e),m({searchButton:".topbar-search-cmd",searchInput:"input.topbar-search-input",clearSearchButton:".topbar-search-clear"},(function(e,t){n["$"+t]=n.getElement(e)}),n),new d({position:"bottom",target:n.$searchButton,body:t.search}),n.children.searchOptions=new l({target:n.$searchInput,renderTo:n.container,model:n.options.searchMenu,bound:!0,altPosition:{x:-1,y:42},multiSelect:!0,closeOnClick:!1}),n}})})),define("DS/TopBar/views/ResponsiveDropdownMenu",["UWA/Core","UWA/Element","UWA/Event","DS/TopBar/views/DropdownMenu","DS/TopBar/views/Menu"],(function(e,t,n,i,o){"use strict";function a(n,i,o){o=o||5;var a=n.parentNode,s=0;if(i)for(;s<o&&a&&1===a.nodeType&&!t.match.call(a,i);)a=a.parentNode,s++;return(a&&1!==a.nodeType||s===o)&&(a=null),a?e.extendElement(a):null}var s,r=(s=/^(header|divider|disabled)$/,function(e){if(!e)return!1;for(var t=e.split(" "),n=0;n<t.length;n++)if(s.test(t[n]))return!0;return!1}),c="responsive",l="dropdown-menu",d="topbar-menu-dd-item",u="item-submenu",m="item-template",h="conceal",p="active",f="current",g="item-back",v=e.Utils.Client.Features,b=o.extend({name:l,templateClassname:m,show:function(){var e,n=this,i=n._parent,o=arguments,a=this.elements.container;function s(){a.removeClassName(h)}function r(){clearTimeout(e),a.addClassName(p),a.addClassName(f),i.apply(n,o),a.removeEvent("transitionEnd")}n.isVisible||(639>=t.getSize.call(document.body).width?(e=setTimeout(r,400),a.addEvent("transitionEnd",r),window.requestAnimationFrame(s)):(i.apply(n,o),s()),n.isVisible=!0)},hide:function(e){e||(e={});var n,i=this,o=i._parent,a=arguments,s=i.elements.container;function r(){s.addClassName(h)}function c(){clearTimeout(n),s.removeClassName(p),s.removeClassName(f),o.apply(i,a),s.removeEvent("transitionEnd")}i.isVisible&&(639>=t.getSize.call(document.body).width?(n=setTimeout(c,400),s.addEvent("transitionEnd",c),window.requestAnimationFrame(r)):(o.apply(i,a),r()),i.isVisible=!1)}}),C=i.extend({UI_BREAK:639,name:l,_mainMenu:null,buildSkeleton:function(){var t,n=this,i=n.elements,o=n.options;i.container||(i.container=e.createElement("div"),n._mainMenu=t=n.addMenu(o.items,0,o.position,o.multiSelect,null,n),t.elements.container.inject(i.container,"top"),t.elements.container.className=n.getClassNames().replace(o.className,""),i.container.className=o.className+" "+c+"-dropdown-menu ",t.elements.container.setStyle("display",""),n._handleEvents())},_isSmallScreen:function(){return t.getSize.call(document.body).width<=this.UI_BREAK},_handleEvents:function(){var e,t=this,i=t.elements.container;t._parent.apply(t,arguments),i.removeEvent("mouseover"),i.removeEvent("mouseout"),i.addEvent("mouseover",(function(i){t._isSmallScreen()||t._shouldIgnoreMouseOverEvent||(t._shouldIgnoreClickEvent&&(t._shouldIgnoreMouseOverEvent=!0,setTimeout((function(){t._shouldIgnoreMouseOverEvent=!1}),100)),(e=n.getElement(i)).hasClassName(d)||(e=a(e,"."+d,3)||e),!t.usingKeyboard&&t._handleItemSelection(e))})),i.addEvent("mouseout",(function(e){t._shouldIgnoreMouseOverEvent||t._isSmallScreen()||!t.usingKeyboard&&(t.timeoutId=setTimeout(t._hideSubmenus.bind(t),500))})),!v.touchEvents&&i.addEventListener("touchstart",t._onHybridTouch.bind(t),{passive:!0})},_addMenu:function(t,n,i,o,a,s,r,l){var d,m,p;return(d=new b({kb:s.options.kb,multiSelect:o,items:t})).elements.container.addClassName(c),d.elements.container.addClassName(h),d.position=i||"bottom right",a&&((m=d.getItem(0)).parentItem=a,(p=e.createElement("div",{class:"back-icon"})).inject(m.elements.container,"top"),e.createElement("span",{class:"fonticon fonticon-left-open"}).inject(p)),this.menus.push(d),s.items=s.items.concat(d.items),r&&r.length&&r.forEach((function(t,n){var i,o=d.getItem(l[n]);t.inject(s.elements.container,"top"),o.elements.container.addClassName(u),(i=e.createElement("div",{class:"next-icon"})).inject(o.elements.container),e.createElement("span",{class:"fonticon fonticon-right-open"}).inject(i),t.parentItem=o})),d},addMenu:function(e,t,n,i,o,a){var s=[],r=[];return o&&e.splice(0,null,{text:o.text,className:g}),e.forEach(function(e,n){e.items&&t<this.options.subMenuMaxDepth&&(s.push(this.addMenu(e.items,t+1,e.position,e.multiSelect,e,a)),r.push(n))}.bind(this)),a||(a=this),this._addMenu(e,t,n,i,o,a,s,r)},_handleItemSelection:function(e){var t,n,i,o=this,a=o._getMenuFromItem(e.id);o.timeoutId&&clearTimeout(o.timeoutId),a&&(e.hasClassName(g)?(i=o.getItem(e.id),(t=o._getMenuFromItem(i.parentItem.id)).elements.container.getElements(".js-selected").forEach((function(e){e&&e.removeClassName("js-selected")})),window.requestAnimationFrame((function(){a.hide(),t.elements.container.addClassName(f)}))):(e.hasClassName(u)||e.hasClassName(m))&&(o._isSmallScreen()&&(n=o._getMenuFromParentItem(e.id))&&n.elements.container.setStyle("display",""),window.requestAnimationFrame((function(){a.elements.container.removeClassName(f)})))),e.hasClassName(u)||e.hasClassName(m)?(n=o._getMenuFromParentItem(e.id))&&!n.isVisible?(o._hideSubmenus(e.id,n),n=o._getMenuFromParentItem(e.id),e.addClassName("js-selected"),n&&n.show(),o.activeMenu=n):n&&n.isVisible&&o._hideSubmenus(n.items[0].id):e.hasClassName("item")&&o._hideSubmenus(e.id)},_hideSubmenus:function(e){var t,n,i=this,o=arguments[arguments.length-1];if(this.menus.length<=1)this.menus[0].items.forEach((function(e){(e=e.elements&&e.elements.container).removeClassName("js-selected")}));else if(e)!function e(n){n&&n.items.forEach((function(n){(n=n.elements&&n.elements.container)&&n.hasClassName(u)&&(t=i._getMenuFromParentItem(n.id),n.removeClassName("js-selected"),t&&t._updateKeyboardIndex("reset"),t&&t!==o&&t.hide(),e(t))}))}(i._getMenuFromItem(e));else for(var a=1,s=this.menus.length;a<s;a++)(t=this.menus[a]).hide(),(n=t.parentItem&&this.getItem(t.parentItem.id))&&n.elements.container.removeClassName("js-selected")},show:function(){var e=this._mainMenu.elements.container;e.addClassName("responsive-dropdown-menu-root"),this._parent.apply(this,arguments),window.requestAnimationFrame((function(){e.addClassName(p),e.addClassName(f)}))},hide:function(){var e=this._mainMenu.elements.container;this._parent.apply(this,arguments),window.requestAnimationFrame((function(){e.removeClassName(p),e.removeClassName(f)}))},updatePosition:function(){this._parent.apply(this,arguments),"end-edge"===this.options.position&&this.elements.container.addClassName("topbar-end-edge")},_onHybridTouch:function(e){var t=n.getElement(e),i=this.template.getItem(t);i&&(i.hasClassName(d)||(i=a(i,"."+d,3)||i),(i=this.getItem(i.id?i.id:i))&&i.elements.container.hasClassName("item-submenu")&&(this._shouldIgnoreClickEvent=!0,setTimeout((function(){this._shouldIgnoreClickEvent=!1}),50)))},_handleItemClick:function(t,i,o){var s=this,c=n.getElement(t),l=!1;(o=o||v.touchEvents||v.pointerEvents)||!this._shouldIgnoreClickEvent?(i||(i=s.template.getItem(c)))&&(i&&i.hasClassName(g)||t.target.hasClassName(g)||a(t.target,"."+g,3)?(s._isSmallScreen()&&s._handleItemSelection(i),l=!0,s.dispatchEvent("onClick",[t,s.getItem(i.id?i.id:i),l],s)):(i=s.getItem(i.id?i.id:i))&&!r(i.elements.container.className)&&(i.selectable&&i.toggleSelection(),(o||s._isSmallScreen())&&(s._handleItemSelection(i.elements.container),l=i.elements.container.hasClassName(u)),s.dispatchEvent("onClick",[t,i,l],s),e.is(i.handler,"function")&&i.handler.call(s,t))):this._shouldIgnoreClickEvent=!1},updateBackIcon:function(e,t){var n,i=e&&this._getMenuFromParentItem(e);i&&(n=i.items&&i.items[0],this.updateItem({id:n.id,text:t}))}});return C})),define("DS/TopBar/views/MenuBarItemView",["UWA/Core","DS/MessageBus/MessageBus","UWA/Class/View","DS/TopBar/views/MenuView","DS/UIKIT/Tooltip","i18n!DS/TopBar/assets/nls/TopBar"],(function(e,t,n,i,o,a){"use strict";return n.extend({className:function(){var e=this;return e.model.id+" topbar-menu-item topbar-cmd "+(e.model.get("disabled")?"disabled":"enabled")+" fonticon fonticon-"+e.model.get("fonticon")},attributes:{html:[{tag:"span",class:"topbar-menu-item-badge"},{tag:"span",class:"topbar-floating-arrow"}]},domEvents:{click:"_onIconClick"},_getBadgeClassName:function(e){var t="fonticon fonticon-";switch(e){case"active":t+="check "+e;break;case"busy":t+="minus "+e;break;case"away":t+="cancel "+e;break;case"offline":t+="record "+e}return t},setup:function(){var e=this;e.className=e.className+" .btn_"+e.model.id,e.listenTo(e.model,{onBadgeSumChange:e._updateCountBadge,"onChange:activatedProxyIds":e._updateEnabled,"onChange:countBadge":e._updateCountBadge,"onChange:status":e._updateStatus,onSubMenuReady:e._onSubMenuReady}),e.$countBadge=e.getElement(".topbar-menu-item-badge"),e.$floatingArrow=e.getElement(".topbar-floating-arrow"),e.deactivate=e.deactivate.bind(e),e.activate=e.activate.bind(e)},destroy:function(){this.subView&&this.subView.destroy(),this.subView=null,this.stopListening(),this._parent(),this.container=null},activate:function(){var e=this;e.dispatchEvent("onActivate",[e,e.model]),e.container.addClassName("active"),e.model.fireOnSubMenuReady(),e.model.fireOnSubMenuDisplayed()},_onSubMenuReady:function(){var e=this,t=e.model.get("submenu");t&&t.length>0?e.$floatingArrow.show():e.$floatingArrow.hide(),e.subView.show()},deactivate:function(){var e=this;e.container.removeClassName("active"),e.dispatchEvent("onDeactivate",[e,e.model]),e.subView.hide(),e.$floatingArrow.hide()},isActive:function(){return this.container.hasClassName("active")},_onIconClick:function(){var t,n=this,i=n.model.get("submenu");n.model.get("onExecute")&&(t=n.model.get("onExecute").call()),(t=e.is(t)?t:!!i&&!!i.getActiveItems().length)&&(n.isActive()?n.deactivate():(window.addEventListener("resize",n._onWindowResize),window.that=n,n.activate()))},_onWindowResize:function(e){var t=e.currentTarget.that;window.innerWidth<959&&(t.deactivate(),window.removeEventListener("resize",t._onWindowResize))},_updateEnabled:function(){this.model.get("disabled")?(this.container.removeClassName("enabled"),this.container.addClassName("disabled")):(this.container.addClassName("enabled"),this.container.removeClassName("disabled")),this._updateCountBadge()},_updateCountBadge:function(){var e=this.model.get("submenu")._getCountsSum()+(this.model.get("countBadge")||0);e&&(t.publish({channel:"onCountBadgeChange",topic:"link",data:e}),this.$countBadge.setText(e>99?"+99":e),this.options.topFrameVue&&this.options.topFrameVue.patch("menus",[{id:"notification",badge:e}])),this.model.get("status")||this.$countBadge.setStyle("display",e?"inline":"none"),"notification"===this.model.id&&t.publish({channel:"onCountBadgeChange",topic:"link",data:e})},_updateStatus:function(e,t){var n=this,i=n.$countBadge;function o(){i.removeClassName("fonticon"),i.removeClassName("fonticon-check"),i.removeClassName("active"),i.removeClassName("fonticon-minus"),i.removeClassName("busy"),i.removeClassName("fonticon-cancel"),i.removeClassName("away"),i.removeClassName("fonticon-record"),i.removeClassName("offline")}(i||"profile"===n.model.id)&&window.requestAnimationFrame((function(){t?(i.hide(),i.setText(""),o(),i.addClassName(n._getBadgeClassName(t)),i.show()):(i.hide(),o())}))},render:function(){var e=this,t="profile"!==e.model.id&&a[e.model.id];return e.subView=new i({kb:!1,model:e.model,target:e.container,tenant:"context"===e.model.get("id")&&e.model.get("tenantId"),bound:!1,closeOnClick:!0,offset:{x:0,y:-1},subMenuMaxDepth:40,events:{onClickOutside:e.deactivate,onHide:e.deactivate}}),t&&new o({position:"bottom",target:e.container,body:t,closeOnClick:!0}),e.subView.inject(e.container),e.container}})})),define("DS/TopBar/views/ScrollableDropdownMenu",["UWA/Core","UWA/Element","UWA/Utils/Client","DS/UIKIT/Scroller","DS/TopBar/views/ResponsiveDropdownMenu"],(function(e,t,n,i,o){"use strict";var a=o.extend({name:"scrollable-dropdown-menu",_handleItemSelection:function(t){var i=this,o=i._parent.apply(i,arguments),a=e.Element.getSize.apply(document.body),s=a.width>=i.UI_BREAK;if(t.hasClassName("js-selected")){var r=i.activeMenu,c=i.elements.container,l=r.elements.container;if(i.activeMenu.items.some((function(e){return Array.isArray(e.items)}))){var d=c.getSize(),u=t.getPosition(c);l&&l.setStyles({right:Math.ceil(d.width-u.x)})}window.requestAnimationFrame((function(){var e=document.body.getElement(".main"),o=e&&e.getSize(),s=o&&o.height,r=c.getSize(),d=a&&a.height,u=t.getPosition(c),m=u&&u.y,h=l&&l.getSize().height;l.setStyles({right:Math.ceil(r.width-u.x)}),s<=h+m?l.setStyle("top",Math.ceil(d-h)-c.offsetTop):l.setStyle("top",Math.ceil(Math.min(d-h,m))),n.Engine.firefox||i.elements.container.setStyles({overflow:""})})),i.activeMenu._scroller===i._scroller||s?i._adaptMenuSize(i.activeMenu,{doSyncResize:!0}):s?n.Engine.firefox&&i.activeMenu._scroller.elements.content.setStyles({"padding-bottom":0,"padding-right":0,"overflow-x":"hidden"}):i._updateSmallMenuHeight()}return o},_adaptMenuSize:function(i,o){o||(o={});var a,s,r=this,c=i||this.activeMenu;function l(){var i,l,d=e.extendElement(a.wrapper),u=d.getElements(".topbar-menu-dd-item"),m=d.getSize(),h=m.width,p={height:Math.ceil(m.height+3)},f=c._scroller.elements.xScrollbar;u.forEach((function(e){var n=t.getSize.call(e).width;h=h>n?h:n})),n.Engine.firefox?(p.width=h-6,c._scroller.elements.content.setStyles({bottom:-25,right:-25,"padding-bottom":0,"padding-right":0,"overflow-x":"hidden"})):p.width=Math.ceil(h),s.setStyles(p),s.offsetWidth<=s.scrollWidth+2&&(f?f.hide():(i=s.offsetWidth,l=s.scrollWidth,Object.defineProperty(c._scroller.elements,"xScrollbar",{configurable:!0,get:function(){return f},set:function(e){(f=e)&&s.offsetWidth===i&&s.scrollWidth===l&&f.hide()}}))),o.updatePosition&&r.elements.container&&r.updatePosition()}c&&(a=c.elements,s=a.container,o.doSyncResize?l():window.requestAnimationFrame(l))},_updateSmallMenuHeight:function(){var e=this,t=e._getMenuFromItem(e.activeMenu.parentItem.id),n={root:e._mainMenu.elements.container.getSize().height,parent:t.elements.container.getSize().height,active:e.activeMenu.elements.wrapper.getSize().height},i=n.root>=n.active?"root":n.parent>=n.active?"parent":"active";e.activeMenu.elements.container.setStyles({height:n[i]}),setTimeout((function(){e.activeMenu._scroller.updateVisible()}),200)},addMenu:function(e,t){var n,o=this,a=o._parent.apply(o,arguments),s=a.elements.container;return n=new i({element:s,scrollbarsMargin:0}),0===t&&(o._scroller=n),a._scroller=n,a.elements.container=n.elements.container,a},addItem:function(){var e=this,t=e._parent.apply(e,arguments);return e._adaptMenuSize(),t},removeItem:function(){var e=this,t=e._parent.apply(e,arguments);return e._adaptMenuSize(),t},onPreInject:function(){var e=this;e._parent.apply(e,arguments),e._adaptMenuSize(e._getMenu(e.id),{updatePosition:!0})}});return a})),define("DS/TopBar/views/MenuBarView",["UWA/Core","UWA/Class","UWA/Class/Timed","UWA/Element","UWA/Class/View","DS/TopBar/utils/Utils","DS/TopBar/views/MenuBarItemView"],(function(e,t,n,i,o,a,s){"use strict";return o.extend({className:"topbar-menu",subViews:null,_initialsEl:null,setup:function(){var e=this;e.subViews=[],e._onItemViewActivate=e._onItemViewActivate.bind(e)},render:function(){var i,o,a,r,c,l,d,u=this,m=u.subViews,h=u.collection,p=u.options.userName||"";if(!p)return u.container.hide(),u.container;for(new(t.extend(n,{})),r=e.createElement("div",{class:"topbar-user d-flex flex-row"}),c=e.createElement("div",{class:"d-flex flex-column full-width topbar-user-context-username-text"}),l=e.createElement("div",{class:"d-flex flex-column justify-end full-width topbar-user-context-arrow-wrapper"}),c.inject(r),u.userName=e.createElement("div",{class:"font-3dslight topbar-username",text:p.trim()}),u.userName.inject(c),u.container.addContent(r),d=e.createElement("div",{class:"topbar-user-context-wrapper hide"}),e.createElement("span",{class:"font-3dsregular topbar-user-context-text"}).inject(d),d.inject(c),e.createElement("span",{class:"fonticon fonticon-chevron-down topbar-user-context-arrow hide"}).inject(l),l.inject(r),i=0;i<h.length;i++)o=h.at(i),(a=new s({model:o,topFrameVue:u.options.topFrameVue})).render().inject(u.container),u._addSubViewListener(a),m.push(a);return u._handleRepositioning(),u.container},_setInitials:function(){var e=this,t=e.container.getElement(".profile"),n=e._initialsEl;t&&(n&&n.destroy(),e._initialsEl=a.renderInitials(e.options.userName,{className:"topbar-initials"}).inject(t))},updateUserName:function(e){this.userName.setText(e)},updateContextTitle:function(e){var t=a.find(this.subViews,(function(e){return"profile"===e.model.id}));t&&t.subView._updateContextTitle({name:e})},updateProfilePicture:function(e){var t,n,i=this.container.getElement(".profile");i&&((n=i.getElement(".profile-picture"))||(i.removeClassName("fonticon-user-alt"),i.addContent({tag:"div",class:"profile-picture"}),(n=i.getElement(".profile-picture")).addContent({tag:"div",class:"user-presence"})),(t=this.subViews.filter((function(e){return"profile"===e.model.id}))[0])&&(t.subView._target=n,t.subView.options.offset={x:-10,y:9},t.subView._isDirty=!0))},_addSubViewListener:function(e){this.listenTo(e,"onActivate",this._onItemViewActivate)},_onItemViewActivate:function(e){e?this.subViews.forEach((function(t){e!==t&&(t.model.get("onExecute")?e.model.get("onExecute")&&t.deactivate():t.deactivate())})):this.subViews.forEach((function(e){e.deactivate()}))},_handleRepositioning:function(){var e=this;e.previousScreenWidth=document.body.getSize().width,i.addEvent.call(window,"resize",a.throttle((function(t){var n;e.currentScreenWidth=t.target.innerWidth,n=e.currentScreenWidth<=957&&e.previousScreenWidth>957,e.subViews.forEach((function(t){var i=t.subView;i&&i.isVisible()&&(n?i.hide():i._dropdownMenu.updatePosition()),e.previousScreenWidth=e.currentScreenWidth}))}),300))},toggleActivate:function(){},destroy:function(){var e=this;e.stopListening(),e.subViews.forEach((function(e){e.destroy()})),e._parent(),e.container=null,e.subViews.length=0}})})),define("DS/TopBar/views/TopBarView",["text!DS/TopBar/assets/templates/TopBarView.html","DS/Handlebars/Handlebars4","UWA/Core","UWA/Utils","UWA/Element","UWA/Class/View","DS/MessageBus/MessageBus","DS/TopBar/utils/Debuggable","DS/TopBar/utils/Utils","DS/TopBar/views/MenuBarView","DS/TopBar/views/MenuView","DS/TopBar/model/MainMenuBar","DS/TopBarProxy/Menu","DS/TopBar/views/ScrollableDropdownMenu","DS/UIKIT/Tooltip","DS/UIKIT/DropdownMenu","DS/UIKIT/Input/Text","DS/UIKIT/Alert","i18n!DS/TopBar/assets/nls/TopBar"],(function(e,t,n,i,o,a,s,r,c,l,d,u,m,h,p,f,g,v,b){"use strict";var C=959,_=1356,w="3dspace",I=".menu-context .dropdown-menu-wrap";function x(e,t,i){var o,a,s;if(!n.is(e,"object"))return e;for(o=0,a=(s=Object.keys(e)).length;o<a;o++)t.call(i,e[s[o]],s[o],e);return e}function S(e,t){x(e,(function(e,t){this["$"+t]=this.getElement(e)}),t)}function y(e,t){return e.slice().sort((function(e,n){var i=t(e).toLowerCase(),o=t(n).toLowerCase();return i<o?-1:i>o?1:0}))}var M=f.extend({init:function(e){this._parent(e)},_onKeyDown:function(e){[13,27,37,38,39,40].includes(e.which)&&this._parent(e)}});return a.extend(r,{uwaClassName:"TopBarView",className:"topbar",id:"topbar",serviceName:"",domEvents:{"click .topbar-logo":"_on3DSLogoActivate","click .btn_tag_nav":"_onTaggerActivate","click .topbar-cmd.menu":"_onMenuActivate","click .topbar-cmd.search":"_onSearchActivate","click .topbar-cmd.extrabtn":"_onExtrabtnClick","click .topbar-cmd.shortcutsbtn":"_onShortcutClick","click .topbar-cmd.addin-close":"_onCloseAddinModeClick","click .topbar-cmd.context, .topbar-user":"_debouncedOnContextClick"},template:t.compile(e),searchAnimationTemplate:t.compile("@media only screen and (min-width : {{smallBreakpoint}}px) and (max-width : {{mediumBreakpoint}}px) {#topbar.topbar .topbar-center { right: {{right}}px; }}"),tenants:null,contextMenu:{},contextVisibility:!1,ddMenuHeight:"",setup:function(e){var t=this,n=t.model,i=n.get("userName");t.serviceName=e.serviceName||"";var o=c.debounce(t._updateUserContextText.bind(t),300);t._debouncedOnContextClick=t._onContextClick(),t.listenTo(n,{"onChange:userName":t._updateUserName,"onChange:brand":t._updateTitle,"onChange:application":t._updateTitle,"onChange:isShared":t._toggleSharedIcon,"onChange:picture":t._updateProfilePicture,"onChange:collabSpaceId":o,"onChange:credentialId":o,"onChange:tenantId":o,"onChange:serviceName":o,"onChange:disableUserContextDropdown":t._updateDisableUserContextDropdown,"onChange:readOnlyUserContext":t._updateReadOnlyUserContext}),t.debugMode=c.result(e,"debugMode"),t.currentScreenWidth=window.innerWidth,t.menuCollection=new m(u.filter((function(e){return"search"!==e.id}))),t.children={rightMenuBar:new l({userName:i,collection:t.menuCollection,topFrameVue:t.options.topFrameVue}),menuView:null},t._handleRepositioning(),t.addListeneronCountBadgeChange()},destroy:function(){x(this.children,(function(e,t,n){e.destroy(),n[t]=null})),this.stopListening(this.model),this.stopListening(u),this._parent(),this.container=null},_updateUserName:function(e,t){this.children.rightMenuBar.updateUserName(t)},_updateProfilePicture:function(e,t){this.children.rightMenuBar.updateProfilePicture(t)},_updateTitle:function(){var e,t,n=this,i=n.model.get("application"),o=n.$appName;n.$brandName.setText(n.model.get("brand")),i&&o.setText(i),n.addinCloseTooltip&&n.addinCloseTooltip.setBody((e=b.closeApp,t={appName:i},e.replace(/\{([\w\-]+)\}/g,(function(e,n){return void 0!==t[n]?t[n]:""}))))},_updateContextTitle:function(e){this.children.rightMenuBar.updateContextTitle({name:e})},_toggleSharedIcon:function(e,t){this.$appIcon.setStyle("display",t?"inline-block":"none")},_updateUserContextVisibility:function(e){var t=this.getElement(".topbar-user"),n=this.getElement(".topbar-user-context-wrapper"),i=this.getElement(".topbar-user-context-arrow"),o=this.getElement(".topbar-user-context-arrow-wrapper"),a=!this.model.get("disableUserContextDropdown"),s=this.getElement(".context.topbar-menu-item");this.contextVisibility=e,e?(t&&t.addClassName("topbar-user-context"),n&&n.removeClassName("hide"),i&&i.removeClassName("hide"),s&&s.removeClassName("hide"),o&&a&&o.removeClassName("hide")):(t&&t.removeClassName("topbar-user-context"),n&&n.addClassName("hide"),i&&i.addClassName("hide"),s&&s.addClassName("hide"),o&&o.addClassName("hide"))},_updateUserContextClickable:function(e,t){var n=this.getElement(".topbar-user-context-wrapper");n&&(t?n.addClassName("clickable"):n.removeClassName("clickable"))},_getComputedUserContext:function(e){var t=e&&e.tenant,n=e&&e.collabSpace,i="";return t&&(i+=t),t&&n&&(i+=" | "),n&&(i+=n),i},destroyContextDropdownMenus:function(){var e,t=this;n.is(t.contextMenu,"object")&&Object.keys(t.contextMenu).forEach((function(n){(e=t.contextMenu[n])&&(e.hide(),e.destroy()),t.contextMenu[n]=null}))},_updateDisableUserContextDropdown:function(e,t){var n=this,i="hide",o=n.getElement(".topbar-user-context-arrow-wrapper"),a=n.children,s=a&&a.menuView;o&&(t?(o.addClassName(i),n.destroyContextDropdownMenus()):o.removeClassName(i),s&&(s._dropdownMenu.hide(),s._buildDdMenu({addTenantPlaceholder:!t})))},_updateReadOnlyUserContext:function(e,t){var n=this,i="read-only disabled",o=n.getElement(".topbar-user-context-text"),a=n.getElement(".topbar-user-context-arrow"),s=n.getElement(".topbar-user-context"),r=n.getElement(".topbar-menu-item.context");n._updateUserContextText(),t?(o&&o.addClassName(i),a&&a.addClassName(i),s&&s.addClassName(i),r&&r.addClassName(i),this.model.set("disableUserContextDropdown",!0)):(o&&o.removeClassName(i),a&&a.removeClassName(i),s&&s.removeClassName(i),r&&r.removeClassName(i),this.model.set("disableUserContextDropdown",!1))},_updateUserContextText:function(){var e=this,t=e.model,n=t.get("tenantId"),i=t.get("collabSpaceId"),o=t.get("serviceName"),a="3DSwym"===o,s="3DSwym"===o||"3DDashboard"===o?"IFW":"",r=t.get("readOnlyUserContext"),l=e.options.getAllTenants||c.getAllTenants,d=e.options.tenantSwitcher,u=function(t){var n=e.$userContext,i=e._getComputedUserContext(t);i&&n.setText(i)},m=function(){e.userContextTooltip&&e.userContextTooltip.destroy(),e.userContextTooltip=null},h=function(t){var n=e.currentScreenWidth>=_;u(t),f(),!function(t){var n,i=e.$userContextWrapper;return u(t),(n=i).offsetWidth<n.scrollWidth}(t)&&n?m():function(t){e.userContextTooltip&&m(),e.userContextTooltip=new p({className:"topbar-user-context-tooltip-container",position:"bottom",target:t.target}),e.userContextTooltip.setBody('<div class="topbar-user-context-tooltip '+(r?"read-only disabled":"")+'"><span class="fonticon fonticon-cloud-alt"></span> <span>'+t.message+"</span></div>")}({message:e._getComputedUserContext(t),target:e.getUserContextElement()})},f=function(){e._updateUserContextVisibility(!0)};window.dsTenantId=n,Promise.all([l({serviceName:o,public:a,role:s}),c.getTenant(n,l,{serviceName:o,public:a,role:s}),c.getCollabSpace({platformId:n,collabSpaceId:i})]).then((function(t){var n=e.tenants=t.shift(),i=t.shift(),o=t.shift();e.destroyContextDropdownMenus();var a=window.dsTenantId;!i&&a&&(i={platformId:a,displayName:a},n.length>1&&!n.some((e=>e.platformId===a))&&n.unshift(i)),d&&i&&n.length>1&&o?(h({tenant:i.displayName,collabSpace:o.title}),e._updateContextTitle(e._getComputedUserContext({tenant:i.displayName,collabSpace:o.title}))):d&&i&&n.length>1?(h({tenant:i.displayName}),e._updateContextTitle(e._getComputedUserContext({tenant:i.displayName}))):o?h({collabSpace:o.title}):(e._updateUserContextVisibility(!1),m())}))},_on3DSLogoActivate:function(){this.model.dispatchEvent("logo")},_onTaggerActivate:function(){this.model.dispatchEvent("tagger")},_onExtrabtnClick:function(){this.model.dispatchEvent("click-extrabtn")},_onShortcutClick:function(e){if(e&&e.target&&e.target.classList.length){const t=e.target.classList[0];this.model.dispatchEvent("click-shortcut",t)}},_onCloseAddinModeClick:function(){this.model.dispatchEvent("click-close-addinmode")},_getBreakpoint:e=>e<=C?"small":e<=_?"medium":"large",_getContextMenuOptions:function(e){var t,i,o,a,s,r,l,d=this,u=d.model,m=e&&e.tenantID||u.get("tenantId"),h=e&&e.collabSpaceId||u.get("collabSpaceId"),p=e&&e.collabSpaceId||u.get("credentialId"),f=u.get("serviceName"),g=document.querySelector("#context"),v="3DSwym"===f,C="3DSwym"===f||"3DDashboard"===f?"IFW":"",_=u.get("disableUserContextDropdown"),w=e&&e.target,I=e&&e.flatTenants,x=d.options.getAllTenants||c.getAllTenants,S=[],M=[];return window.dsTenantId=m,g&&(d.contextVisibility?g.removeClassName("hide"):g.addClassName("hide")),Promise.all([x({serviceName:f,public:v,role:C}),c.getAllCollabSpaces({platformId:m}),c.getTenant(m,x,{serviceName:f,public:v,role:C}),c.getCollabSpace({platformId:m,collabSpaceId:h}),c.getCredential({platformId:m,collabSpaceId:h,credentialId:p}),c.getAllCredentials({platformId:m,collabSpaceId:h})]).then((function(e){t=e.shift(),i=e.shift(),o=e.shift(),a=e.shift(),s=e.shift(),r=e.shift();var g=window.dsTenantId;if(!o&&g&&(o={platformId:g,displayName:g},t.length>1&&!t.some((e=>e.platformId===g))&&t.unshift(o)),I=I&&!(a&&i&&i.length),l={className:"context-dropdown-menu menu-context",target:w,items:[],events:{onShow:function(){w&&w.classList.add("active");var e=document.querySelector("#context");e&&(d.contextVisibility?e.removeClassName("hide"):e.addClassName("hide"))},onHide:function(){w&&w.classList.remove("active")},onClickOutside:function(){d.destroyContextDropdownMenus()},onClick:function(e,t){var i=t&&t.name,s=t&&t.text,r=i&&"tenant"===i,l=i&&"collabSpace"===i,g=i&&"credentials"===i,b=t&&t.id&&"context"===t.id;r?c.getTenants([o.platformId,s],x,{serviceName:f,public:v,role:C}).then((function(e){e.length&&require([["DS","i3DXCompass","i3DXCompass"].join("/")],(function(t){var n=e.shift(),i=e.shift();try{t.resetCompassSelectedPlatform({newPlatform:i})}catch(e){}u.dispatchEvent("tenant",{from:n,to:i})}))})):l?c.getCollabSpaces([{collabSpaceId:a.name,platformId:o.platformId},{collabSpaceId:s,platformId:o.platformId}]).then((function(e){e.length&&u.dispatchEvent("collabSpace",{from:e.shift(),to:e.shift()})})):g?c.getCredentials([{platformId:m,collabSpaceId:h,credentialId:p},{platformId:m,collabSpaceId:h,credentialId:{organization:t.attributes.organization,role:t.attributes.role}}]).then((function(e){e.length&&u.dispatchEvent("credentials",{from:e.shift(),to:e.shift()})})):b&&n.is(d.options.onUserContextClick,"function")&&d.options.onUserContextClick()}}},!_){if(o&&t&&t.length>1){(t=y(t,(function(e){return e.displayName}))).map((function(e){return{name:"tenant",text:e.displayName,title:e.platformId,selected:e.platformId===o.platformId,type:e.type}})).forEach((function(e){e.type&&"staging"===e.type.toLowerCase()?M.push(e):S.push(e)}));var N=[];M.length&&N.push({text:b.productionPlatform,className:"header"}),N=N.concat(S),M.length&&(N.push({text:b.stagingPlatform,className:"header"}),N=N.concat(M)),I?l.items.push(N):l.items.push({text:o.displayName,fonticon:"cloud-alt",items:N})}a&&i&&i.length&&(i=y(i,(function(e){return e.title})),l.items.push({text:a.title,fonticon:"drive",items:i.map((function(e){return{name:"collabSpace",text:e.title,selected:e.name===a.name}}))}),s&&r&&r.length&&(r=y(r,(function(e){return e.role.nls+" - "+e.organization.title})),l.items.push({text:s.role.nls+" - "+s.organization.title,fonticon:"user",items:r.map((function(e){return{name:"credentials",text:e.role.nls+" - "+e.organization.title,selected:e.role.name===s.role.name&&e.organization.name===s.organization.name,attributes:{organization:e.organization.name,role:e.role.name}}}))})))}return l}))},_buildFilterPlatformAction:function(){var e=this,t=e.elements;t.searchMainCtn&&t.searchMainCtn.destroy(),t.searchMainCtn=n.createElement("li",{class:"search-main-container"}),t.searchAction=n.createElement("div",{class:"search-view-container",html:[{tag:"span",class:"search-view-action search-view-apply fonticon fonticon-2x fonticon-search pull-right",events:{click:function(){t.searchInput.focus()}}},{tag:"span",class:"search-view-action search-view-cancel fonticon fonticon-2x fonticon-cancel-squared pull-right",events:{click:function(){e.onClearPlatformFilter()}}}]}),t.searchInput=new g({placeholder:b.findPlatform,className:"search-platform",events:{onKeyDown:function(n){const{input:i}=t.searchInput.elements,o=i.selectionStart;"ArrowLeft"===n.key&&o>0?i.setSelectionRange(o-1,o-1):"ArrowRight"===n.key&&o<i.value.length?i.setSelectionRange(o+1,o+1):setTimeout((function(){e.onSearchChange()}))}}}).inject(t.searchAction,"top"),t.searchAction.inject(t.searchMainCtn,"top");var i=document.querySelector(I);i&&t.searchMainCtn.inject(i,"top"),t.searchInput.focus()},onClearPlatformFilter:function(){var e=this.elements;e.searchInput.setValue(""),e.searchInput.focus(),this.onSearchChange()},onSearchChange:c.debounce((function(){var e=this,t=e.elements,n=0,i=t.searchInput.getValue().trim().toLowerCase(),o=document.querySelectorAll(I+' [name="tenant"]'),a=document.querySelectorAll(I+" .header"),s=document.querySelector(".context-dropdown-menu");t.searchAction.toggleClassName("active",!!i),o.forEach((function(e){!i||e.innerText.trim().toLowerCase().includes(i)||e.title.trim().toLowerCase().includes(i)?(e.show(),n++):e.hide()})),s.style.height=i?n?45*(n+1)>450?e.ddMenuHeight+"px":45*(n+1)+(a.length&&30*a.length)+"px":a.length?30*a.length+45+"px":"45px":e.ddMenuHeight+"px"}),300),_onContextClick:function(){var e=!1;return function(){var t=this,i=t._getBreakpoint(window.innerWidth),o="small"===i?h:M,a=i&&t.contextMenu[i];this.contextVisibility&&(t.model.get("disableUserContextDropdown")||e||(a?t.destroyContextDropdownMenus():(e=!0,t._getContextMenuOptions({flatTenants:!0,target:t.getUserContextElement()}).then((function(n){n.items.length&&(t.destroyContextDropdownMenus(),t.contextMenu[i]=new o(n),t.userContextTooltip&&t.userContextTooltip.hide(),t.contextMenu[i].show(),t.serviceName.toLowerCase()!==w&&t.tenants.length>10&&(t._buildFilterPlatformAction(),t.ddMenuHeight=t.contextMenu[i].elements.container.clientHeight)),e=!1})))),n.is(t.options.onUserContextClick,"function")&&t.options.onUserContextClick())}},_buildMenuView:function(e,t){var n=this,i=new d({model:t,target:e,offset:{x:0,y:-3},kb:!1,bound:!1,events:{onHide:this._onMenuActivate.bind(this,{force:"hide"}),onClick:function(e,t){n._getContextMenuOptions().then((function(i){i.events.onClick(e,t);var o=n._getBreakpoint(window.innerWidth);t.id.includes("context")&&n.serviceName.toLowerCase()!==w&&n.tenants.length>10&&"small"!==o&&n._buildFilterPlatformAction()}))},onShow:function(e,t){n._getContextMenuOptions().then((function(n){return n.events.onShow(e,t),n})).then((function(e){e.className.includes("context")&&n.serviceName.toLowerCase()!==w&&n.tenants.length>10&&n._buildFilterPlatformAction()}))}}});return i.rightMenuModel=this.rightMenuModel,i.show(),i},_onSearchActivate:function(){var e=this,t="active",n=e.$searchCmd,i=e.$menuCmdCenter,o=n.hasClassName(t),a=o?"disable":"enable";e.container.toggleClassName("search-active"),o?n.removeClassName(t):(n.addClassName(t),i&&i.removeClassName(t)),e.model.dispatchEvent("mobileSearchAction",{action:a})},_onMenuActivate:function(e){e||(e={});var t=this,n=t.model,i="active",o=t.$searchCmd,a=t.$menuCmdCenter,s=t.children,r=n.get("tenantId"),l=n.get("serviceName"),d="3DSwym"===l,u="3DSwym"===l||"3DDashboard"===l?"IFW":"",m=n.get("collabSpaceId"),h=t.options.getAllTenants||c.getAllTenants,p=t.model.get("shortcuts"),f=t.model.get("submenu");p&&(f.remove(f.findWhere({className:"shortcut"})),p.forEach((e=>{f.add({id:e.id,label:e.text,fonticon:e.icon,className:"shortcut",disabled:!1,onExecute:e.onExecute||function(){},selectable:!1,selected:!1})}))),t.container.removeClassName("search-active"),o&&o.removeClassName(i),t.container.getSize().width<=C&&(s.menuView||(s.menuView=t._buildMenuView(a,t.model)),a.hasClassName(i)||"hide"===e.force?(a.removeClassName(i),s.menuView.hide()):(a.addClassName(i),s.menuView._addContexts(t._getContextMenuOptions.bind(t)),s.menuView.show({refresh:!1}),window.addEventListener("resize",t._onWindowResize),window.that=t,Promise.all([h({serviceName:l,public:d,role:u}),c.getTenant(r,h,{serviceName:l,public:d,role:u}),c.getCollabSpace({platformId:r,collabSpaceId:m})]).then((function(e){var n=e.shift(),i=e.shift(),o=e.shift(),a=n.length>1&&i&&i.displayName,r=o&&o.title;s.menuView._updateContextTitle({name:t._getComputedUserContext({tenant:a,collabSpace:r})})})))),n.dispatchEvent("mobileSearchAction",{action:"disable"})},_onWindowResize:function(e){var t=e.currentTarget.that,n=t.children,i=t.container,o=t.$menuCmdCenter;i.getSize().width>C&&(o.removeClassName("active"),n.menuView.hide(),window.removeEventListener("resize",t._onWindowResize))},_handleRepositioning:function(){var e=this,t=n.extendElement(document.body).getSize().width;e.previousScreenWidth=t,e.previousBreakpoint=e._getBreakpoint(t),window.addEventListener("resize",c.throttle((function(t){var n;!function(t){var n,i=e.children,o=i&&i.menuView;e.currentScreenWidth=t.target.innerWidth,n=e.currentScreenWidth>=C&&e.previousScreenWidth<C,o&&o.isVisible()&&(n?o.hide():o._dropdownMenu.updatePosition(),e.previousScreenWidth=e.currentScreenWidth)}(t),(n=e._getBreakpoint(window.innerWidth))!==e.previousBreakpoint&&(e.destroyContextDropdownMenus(),e._updateUserContextText(),e.previousBreakpoint=n)}),300))},_onIconClick:function(e){this.subViews.forEach((function(t){e!==t&&t.deactivate()}))},render:function(){var e,t,i=this,o=i.model.toJSON(),a=o.picture||void 0;if(n.extendElement(document),n.extendElement(document.body),e=i.template(o),i.container.setContent(e),i.model.get("displayAccess")&&i.container.addClassName("display-access"),S({brandName:".topbar-app-brand",appName:".topbar-app-name",appIcon:".topbar-app-icon",appMenuIcon:".topbar-app-menu",appTitle:".topbar-app-title",menuCmdCenter:".topbar-center .topbar-cmd.menu",menuCmdRight:".topbar-right .topbar-cmd.menu",searchCmd:".topbar-cmd.search",left:".topbar-left",center:".topbar-center",right:".topbar-right",rightLinks:".topbar-access",extrabtnWrapper:".topbar-extrabtn",extrabtn:".topbar-cmd.extrabtn",shortcutsbtnWrapper:".topbar-shortcutsbtn",addinbtn:".topbar-addinbtn",addinClose:".topbar-cmd.addin-close",tagNav:".topbar-cmd.tagnav"},i),i.children.rightMenuBar.render().inject(i.$right),a&&i.children.rightMenuBar.updateProfilePicture(a),S({user:".topbar-user",userContext:".topbar-user-context-text",userContextWrapper:".topbar-user-context-wrapper",contextIcon:".topbar-cmd.context"},i),i.model.get("displayAccess")&&(t=[{tag:"a",class:"topbar-access-link",text:b.login,events:{click:i.onAccessLinkClick.bind(i,"login")}}],"public"===i.model.get("logoutMode")&&t.push({tag:"a",class:"topbar-access-link",text:b.signup,events:{click:i.onAccessLinkClick.bind(i,"signup")}}),i.$rightLinks.addContent(t)),i.children.search)throw new Error("TopBarView unexpectedly rendered twice!");return i.options.activateSearch&&require([i.options.activateNewSearch?"DS/SNSearchUX/SearchView":"DS/TopBar/views/SearchView"],(function(e){i.children.search=new e({model:i.model,searchMenu:u.get({id:"search"})}),i.children.search.render().inject(i.$center,"top"),new p({position:"bottom",target:i.$searchCmd,body:b.search})})),!1===i.options.showTaggerBtn?i.$tagNav.setStyle("display","none"):new p({position:"bottom",target:i.$tagNav,body:b.tagNav}),i.$menuCmdCenter&&i.$menuCmdCenter.addClassName("fonticon-notification-badge"),i.$menuCmdCenter&&(i.$menuCmdCenter.innerHTML+='<span class="item-badge" style="display: none;"></span>'),i.$menuCmdCenter&&new p({position:"bottom",target:i.$menuCmdCenter,body:b.mainMenu}),i.$menuCmdRight&&new p({position:"bottom",target:i.$menuCmdRight,body:b.mainMenu}),i.extrabtnTooltip=new p({position:"bottom",target:i.$extrabtn,body:""}),i.$addinbtn&&!i.options.lockedAppMode&&(i.addinCloseTooltip=new p({position:"bottom",target:i.$addinClose,body:b.close})),i.model.get("shouldRemoveTopBar")&&i.container&&i.container.classList.add("hl","inDashboardLocked"),i},onAccessLinkClick:function(e){var t=this.model.get(e+"Url"),n=this.model.get(e+"Action");t&&("string"==typeof t||t instanceof String)?window.location=t:n&&"function"==typeof n&&n()},getTitleMenuElement:function(){return this.$appTitle},getTitleMenuIconElement:function(){return this.$appMenuIcon},getTitleName:function(){return this.model.get("application")},getUserContextWrapperElement:function(){return this.getElement(".topbar-user-context-wrapper")},getUserContextElement:function(){return this.currentScreenWidth>=_?this.$user:this.$contextIcon},hideExitFullscreenButton:function(e){var t=this;t.$extrabtnWrapper.addClassName("topbar-extrabtn-hidden"),["center","right"].forEach((function(e){t["$"+e].removeClassName("topbar-with-extrabtn"),t["$"+e].addClassName("topbar-without-extrabtn")})),e&&e.onlyShorcuts?(t.model.get("shortcuts")&&t.model.get("shortcuts").length>0&&t.$extrabtnWrapper.addClassName("onlyShorcuts"),t.$extrabtnWrapper.removeClassName("topbar-extrabtn-hidden")):t.$extrabtnWrapper.removeClassName("onlyShorcuts")},showExitFullscreenButton:function(e){var t=this;t.$extrabtnWrapper.removeClassName("topbar-extrabtn-hidden"),["center","right"].forEach((function(e){t["$"+e].addClassName("topbar-with-extrabtn"),t["$"+e].removeClassName("topbar-without-extrabtn")})),e&&e.onlyShorcuts?t.model.get("shortcuts")&&t.model.get("shortcuts").length>0&&t.$extrabtnWrapper.addClassName("onlyShorcuts"):t.$extrabtnWrapper.removeClassName("onlyShorcuts")},setExtraButtonOptions:function(e){e.tooltip&&this.extrabtnTooltip.setBody(e.tooltip),e.fonticon&&this.$extrabtn.setAttribute("class","topbar-cmd extrabtn fonticon "+e.fonticon)},setShorcutsButtonOptions:function(e){e&&(this.$shortcutsbtnWrapper.innerHTML="",e.forEach((e=>{if("help"!==e.id){var t=n.createElement("div",{class:e.id+" topbar-cmd shortcutsbtn fonticon fonticon-"+e.icon+(!0===e.enable?" active":!1===e.enable?" disabled":"")}).inject(this.$shortcutsbtnWrapper,"bottom");new p({position:"bottom",target:t,body:e.text})}})))},deactivateShortcutsButton:function(e){var t=this.$shortcutsbtnWrapper.querySelector("."+e);t&&t.classList.remove("active")},enableShortcutsButton:function(e){var t=this.$shortcutsbtnWrapper.querySelector("."+e);t&&(t.classList.remove("disabled"),t.classList.remove("active"))},activateShortcutsButton:function(e){var t=this.$shortcutsbtnWrapper.querySelector("."+e);t&&(t.classList.remove("disabled"),t.classList.add("active"))},disableShortcutsButton:function(e){var t=this.$shortcutsbtnWrapper.querySelector("."+e);t&&(t.classList.remove("active"),t.classList.add("disabled"))},toggleAddinModeButton:function(){var e=this;e.$addinbtn.toggleClassName("topbar-addinbtn-hidden"),["center","right"].forEach((function(t){e["$"+t].toggleClassName("with-addinbtn")}))},focusOnSearch:function(){var e=this,t=e.getElement(".topbar-search input"),n=e.$searchCmd,i=n.hasClassName("active");!n||n.isHidden()||i||e._onSearchActivate(),t&&!t.isHidden()&&t.click()},addListeneronCountBadgeChange:function(){s.subscribe({channel:"onCountBadgeChange",topic:"link",callback:this.updateMenuIcon})},updateMenuIcon:function(e){var t=document.querySelector(".fonticon-notification-badge .item-badge");e?(t.style.display="inline",t.textContent=e>99?"+99":e):(t.style.display="none",t.textContent="")}})})),define("DS/TopBar/TopBar",["UWA/Core","DS/TopBar/model/MainMenuBar","UWA/Class/Model","UWA/Class/Collection","DS/TopBar/views/TopBarView","DS/TopBar/assets/nls/TopBar_temp"],(function(e,t,n,i,o,a){"use strict";var s,r=n.extend({set:function(t,n,i){var o=this;if(o._parent.apply(o,arguments),e.is(n)&&"picture"===t){var a=o.get("submenu").get({id:"profile"});a&&a.set("icon",n)}}});return s={init:function(n){var s,c,l,d,u=this,m=function(t){var n={};if(!t)return n;if(Array.isArray(t.topMenus)){var i=Object.create(null);t.topMenus.forEach((function(t){e.is(t,"string")&&(i[t]=!0)})),n.topMenus=i}return e.extend(t,n)}(n),h=m.tenantId;for(c in u.attributes=m,t.init(m),m.events&&(s=m.events,delete m.events),l=new i(t.filter((function(e){return["context","profile","home","share","add","help","content","enovTasks","notification","social"].indexOf(e.id)>=0}))),u._model=d=new r(e.extend(m,{submenu:l,tenantId:""})),d.set("displayAccess",!m.userName),d.set("logoutMode",m.logoutMode),d.set("addinMode",m.addinMode),d.set("lockedAppMode",m.lockedAppMode),d.set("dashboardLockedMode",m.dashboardLockedMode),s)u.addEvent(c,s[c]);u.rightMenuModel={enable:!1,title:""},u.view=new o({model:u._model,activateNewSearch:m.activateNewSearch,activateSearch:m.activateSearch,showTaggerBtn:m.useTagger,addinMode:m.addinMode,lockedAppMode:m.lockedAppMode,onUserContextClick:m.onUserContextClick,getAllTenants:m.getAllTenants,topFrameVue:m.topFrameVue,serviceName:m.serviceName,tenantSwitcher:m.tenantSwitcher}),u.getTitleMenuElement=u.view.getTitleMenuElement.bind(u.view),u.getTitleMenuIconElement=u.view.getTitleMenuIconElement.bind(u.view),u.getTitleName=u.view.getTitleName.bind(u.view),u.showExitFullscreenButton=u.view.showExitFullscreenButton.bind(u.view),u.hideExitFullscreenButton=u.view.hideExitFullscreenButton.bind(u.view),u.setExtraButtonOptions=u.view.setExtraButtonOptions.bind(u.view),u.setShorcutsButtonOptions=u.view.setShorcutsButtonOptions.bind(u.view),u.deactivateShortcutsButton=u.view.deactivateShortcutsButton.bind(u.view),u.enableShortcutsButton=u.view.enableShortcutsButton.bind(u.view),u.disableShortcutsButton=u.view.disableShortcutsButton.bind(u.view),u.activateShortcutsButton=u.view.activateShortcutsButton.bind(u.view),u.toggleAddinModeButton=u.view.toggleAddinModeButton.bind(u.view),u.getUserContextWrapperElement=u.view.getUserContextWrapperElement.bind(u.view),a.init(m);var p=u.view.render();if(m.topFrameVue){var f=document.head.querySelector('link[rel=stylesheet][href*="TopBar.css"]');if(f&&f.remove(),e.is(m.topMenus,"object"))Object.keys(m.topMenus).forEach((function(t){e.is(m.topMenus[t],"function")&&u.addEvent(t,m.topMenus[t])}))}else p.inject(document.body,"top");d.set("collabSpaceId",""),d.set("credentialId",""),d.set("tenantId",h),d.set("serviceName",m.serviceName),d.set("disableUserContextDropdown",!1),d.set("readOnlyUserContext",!1)},set:function(){this._model.set.apply(this._model,arguments)},addEvent:function(t,n,i){var o,a=this._model,s=this.attributes;if(s&&s.topFrameVue&&(e.is(t,"object")&&t.events&&s.topFrameVue.on(t.events),e.is(t,"string"))){var r={};r[t]=n,s.topFrameVue.on(r)}if(a)if(e.is(t,"object")&&t.events)for(o in t.events)a.addEvent(o,t.events[o],i);else e.is(t,"string")&&a.addEvent(t,n,i)},removeEvent:function(e,t,n){var i=this._model;i&&i.removeEvent(e,t,n)},setRightMenuContext:function(e){var t=this,n={setTitle:function(e){e&&t.set("collabSpaceId",e)},getTarget:null};return console.warn&&console.warn("TopBar.setRightMenuContext is deprecated. Use TopBar.set('collabSpaceId', setRightMenuContext) instead"),n.setTitle(e.title),n},MainMenuBar:t},s})),define("TopBar",["TopBar/TopBar"],(function(e){"use strict";return e})),define("TopBar/TopBar",["DS/TopBar/TopBar"],(function(e){"use strict";return e}));