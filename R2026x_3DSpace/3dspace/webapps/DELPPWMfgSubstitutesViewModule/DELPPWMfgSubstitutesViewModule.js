define("DS/DELPPWMfgSubstitutesViewModule/MfgSubstitutesViewUI",["UWA/Core"],(function(e){"use strict";return function(t,n,o,i,a){var r,c,s,d,l=i.getComponent("WUXDockAreaEnum"),u=i.getComponent("WUXFrameWindowsManager").getFrameWindow(t.getAppContext()).getImmersiveFrame();return r=function(r,u){var g=t.getElement(),f=i.createElement("div",{class:"tree-list-container"}),h=e.is(a)?a.getIconURLFromKey(u):"";f.inject(g),d=a.getNLSValue("View."+r+".Title")||"",n.loadDocument(o.getWUXNodeModel()),n.getContent().inject(f),(c=i.create("Panel",{position:{at:"right"},minWidth:300,minHeight:250,height:250,title:d,icon:h,side:l.RightDockArea,currentDockArea:l.RightDockArea,identifier:"panel-"+s,content:g,resizableFlag:!0,closeButtonFlag:!0,useBordersFlag:!0,visibleFlag:!1,collapsibleFlag:!0,verticallyStretchableFlag:!1})).close=function(){e.is(s)?t.notify("toggleCmdCheckHeaderState",{cmdName:s,cmdState:!1}):c.hide()}},{init:function(n,o,i){e.is(n,"string")?(s=n,r(o,i)):t.debug("MfgSubstitutesViewUI","Command name is not defined to create action UI.")},destroy:function(){o.emptyNodeModel(),e.is(c)&&(c.destroy(),c=void 0)},toggle:function(t){var n;t.state&&!c.visibleFlag?(c.immersiveFrame=u,n=u.getDockingElement(c.currentDockArea),e.is(n)&&(n.collapseDockingZoneFlag=!1),c.show()):c.hide()},updateTitle:function(t){e.is(t)&&""!==t?c.title=d+" - "+t:c.title=d}}}})),define("DS/DELPPWMfgSubstitutesViewModule/MfgSubstitutesViewModule",["UWA/Core","DS/DELPPWMfgSubstitutesViewModule/MfgSubstitutesViewUI"],(function(e,t){"use strict";return{behaviors:["TreeListViewBehavior","WUXNodeModelBehavior","UXFactoryBehavior","LinkBehavior","ModelBehavior","SelectionBehavior","SearchBehavior","ResourceBehavior"],creator:function(n,o,i,a,r,c,s,d,l){var u,g,f,h=[],m=[],v=null,C=function(t){return!(!e.is(t)||!e.is(t.get))&&m.indexOf(t.get("type"))>-1},p=function(){return h.indexOf("PROCESS")>-1||h.indexOf("SERVICE")>-1||h.indexOf("CONSTRUCTION")>-1},S=function(t){var i={action:[],parameters:[]};e.is(t,"array")&&t.length>0?(t.forEach((function(e,t){i.action[t]="addRoot",i.parameters[t]={rootReferencePID:e.id}})),o.processDropEffect(i)):n.debug("No search results")},y=function(){var t,o,a,d,l=s.getSelections();if(i.emptyNodeModel(),e.is(l,"array")&&1===l[1].length)if(d=l[1][0],e.is(d))if(v=d,t=c.getReferenceModel(d),c.isInstance(d)&&(o=c.getInstance(d),a=d),e.is(t)){g.updateTitle(c.getDisplayName(t));const n={silentMode:!0,onComplete:function(t){var n;e.is(v)&&Array.isArray(t)&&t.length>0&&(i.prepareUpdate(),t.forEach((function(t){C(t)&&t.get("from")===a&&(n=c.getReference(t.get("to")),e.is(n)&&(i.isNodeAdded(n)||i.addNode(n,{loadChildren:!1})))})),i.pushUpdate())}};e.is(o)?r.getConnectionsByModel(t,o,n):r.getConnectionsByModel(t,null,n)}else n.debug("Reference Model is empty for PID:"+d);else n.debug("No selection in mbom to load action view data.");else v=null,g.updateTitle("")};return{listenTo:function(){return{referenceChanged:this.onChangeIRPC,connectionAdded:this.onAddConnection,connectionChanged:this.onChangeIRPC,connectionRemoved:this.onRemoveConnection,select:this.reloadUI,ActionRemove:this.onActionRemove,SearchAndAddCommand:this.onSearchAndAddCommand,refreshImpacted:this.reloadUI}},onStart:function(e){var r;h=(e=e||{}).pprTypes,m=e.linkTypes,u=e.relatedCmdId,f=e.moduleIcon,r=l.getNLSValue(u),(g=new t(n,o,i,a,l)).init(u,r,f),g.toggle({state:!0}),y()},onStop:function(){e.is(g)&&(g.destroy(),g=void 0),v=null},onSearchAndAddCommand:function(){p()&&d.activate(l.getNLSValue("InContextSearch.SUB.Title"),S.bind(this))},onActionRemove:function(){var t,o,i=null,a=s.getSelections();e.is(a,"array")&&a[0].length>0&&e.is(1===a[1].length)&&(o=c.getReferenceModel(a[1]),c.isInstance(a[1])&&(i=c.getInstance(a[1])),r.getConnectionsByModel(o,i,{onComplete:function(n){if(e.is(n,"array")&&n.length>0)for(t=0;t<a[0].length;t++)n.forEach((function(e){e.get("to")===a[0][t]&&r.deleteConnection(e.get("PID"))}))},onFailure:function(){n.debug("Getting connections failed")}}))},onChangeIRPC:function(t){var n;t=Array.isArray(t)?t:[t],n=s.getSelections(),e.is(n,"array")&&n.length>0&&1===n[1].length&&i.withTransactionUpdate((function(){t.forEach((function(e){p()&&i.updateAttributes(e)}))}))},onAddConnection:function(t){var n=function(t){var n,o,a,r;C(t)&&(a=t.get("to"),n=s.getSelections(),e.is(n,"array")&&1===n[1].length&&(o=c.getReferenceModel(n[1][0]),e.is(o)&&o.get("PID")!==a&&(r=c.getReferenceModel(a),e.is(r)&&(i.isNodeAdded(r.get("PID"))||i.addNode(r,{loadChildren:!1})))))};e.is(t,"array")?t.forEach((function(e){n(e)})):n(t)},onRemoveConnection:function(t){var n=[],o=function(t){var o,i=t.get("to");C(t)&&(o=c.getReferenceModel(i),e.is(o)&&n.push(o.get("PID")))};i.withTransactionUpdate((function(){e.is(t,"array")?t.forEach((function(e){o(e)})):o(t),n.length>0&&i.removeNodes(n)}))},reloadUI:function(t){e.is(t)&&y()}}}}}));