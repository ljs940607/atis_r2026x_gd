/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
define("DS/PADUtils/Configuration",["text!DS/PADUtils/assets/GlobalConfiguration.json","UWA/Core","UWA/Class"],(function(e,t,n){"use strict";var i=JSON.parse(e);return n.singleton({notFlagInit:!0,initialize:function(e){this.notFlagInit&&(this.notFlagInit=!1,window.__karma__&&window.__karma__.config.json&&window.__karma__.config.json.Configuration&&this.mergeConfig(window.__karma__.config.json.Configuration))},getConfig:function(e){return this.initialize(),!!i.settings[e]&&i.settings[e].value},mergeConfig:function(e){i=t.extend(i,e,!0)},getWebAPIOptions:function(e){return i.webapiDefaults[e]?t.clone(i.webapiDefaults[e],!0):{}}})})),define("DS/PADUtils/PADIndexedDb",["UWA/Core","UWA/Class"],(function(e,t){"use strict";return t.singleton({name:"PADIndexedDb",userStore:"user",scStore:"sc",_dbName:"eno_apps_2021x",_db:null,_version:1,_storeNames:["user","sc"],_keyPath:"id",_columns:{user:["id","dashboards","activeDashboard","preferredSC","timestamp"],sc:["id","userId","dashboardId","activeSC","timestamp"]},init:function(t){var n,i;t=t||{},this._parent(t);let s=this;e.is(s._db)||(this.dbReady=new Promise((e=>{(n=indexedDB.open(s._dbName,s._version)).onupgradeneeded=function(e){s._db=e.target.result,s._storeNames.forEach((function(e){i=s._db.createObjectStore(e,{keyPath:s._keyPath}),s._columns[e].forEach((function(e){i.createIndex(e,e,{unique:"id"===e})}))}))},n.onsuccess=function(t){s._db=t.target.result,e()},n.onerror=function(e){console.log("no db error",e.target.errorCode)}})))},isReady:function(){return this.dbReady},get:function(t){var n;e.is(this._db)&&((n=this._db.transaction([t.storeName]).objectStore(t.storeName).get(t.id)).onsuccess=function(n){e.is(n.target.result)?e.is(t.foundCallback)&&t.foundCallback(n.target.result):e.is(t.notFoundCallback)&&t.notFoundCallback({msg:"no data found"})},n.onerror=function(n){console.log("error",n.target.errorCode),e.is(t.notFoundCallback)&&t.notFoundCallback({msg:"no data"})})},put:function(t){var n,i;n={id:t.id,timestamp:Date.now()},t.hasOwnProperty("dashboards")&&(n.dashboards=t.dashboards),t.hasOwnProperty("activeDashboard")&&(n.activeDashboard=t.activeDashboard),t.hasOwnProperty("userId")&&(n.userId=t.userId),t.hasOwnProperty("dashboardId")&&(n.dashboardId=t.dashboardId),t.hasOwnProperty("activeSC")&&(n.activeSC=t.activeSC),t.hasOwnProperty("preferredSC")&&(n.preferredSC=t.preferredSC),e.is(this._db)&&((i=this._db.transaction([t.storeName],"readwrite").objectStore(t.storeName).put(n)).onsuccess=function(n){e.is(t.callback)&&t.callback(n.target.result)},i.onerror=function(n){console.log("put error",n.target.errorCode),e.is(t.callback)&&t.callback(n.target.errorCode)})},getUser:function(e){e.storeName||(e.storeName=this.userStore),this.get(e)},addUser:function(e){e.storeName||(e.storeName=this.userStore),this.put(e)},getSC:function(e){e.storeName||(e.storeName=this.scStore),this.get(e)},addSC:function(e){let t=this;e.storeName||(e.storeName=t.scStore),t.put(e)},updateUser:function(t){var n=this;if(e.is(n._db)){t.storeName||(t.storeName=n.userStore);var i=n._db.transaction([t.storeName],"readwrite").objectStore(t.storeName),s=i.get(t.id);s.onerror=function(e){console.log("error in get User data to update")},s.onsuccess=function(s){var o=s.target.result;if(o){t.hasOwnProperty("dashboards")&&(o.dashboards=t.dashboards),t.hasOwnProperty("activeDashboard")&&(o.activeDashboard=t.activeDashboard),t.hasOwnProperty("preferedSC")&&(o.preferedSC=t.preferedSC),o.timestamp=Date.now();var a=i.put(o);a.onerror=function(e){console.warn("update user error")},a.onsuccess=function(n){e.is(t.callback,"function")&&t.callback(n.target.result)}}else n.addUser(t)}}}})})),define("DS/PADUtils/Utility",["DS/Utilities/DateUtils"],(function(e){"use strict";var t=/(\d+)\/(\d+)\/(\d+)@\d+:\d+:\d+:\w+/;function n(e,t,n,i){var s=-1;return function(){if(++s<=e.length-1){var o=e[s];n(o,t)}else i()}}function i(e,t){for(var n=[],i=e.length,s=0;s<i;s+=t)n.push(e.slice(s,s+t));return n}return{compareValue:function(e,t){return e||(e=""),t||(t=""),require("DS/WidgetServices/WidgetServices").compareValue(t,e)},convertDateTime:function(n){var i="";if("NULL"===n)i="";else{if(t.test(n))n=require("DS/WidgetServices/WidgetServices").formatDateObj(n).toUTCString();var s=Date.parse(n);isNaN(s)||(i=e.formatDateToString(new Date(s)))}return i},batchBreakup:i,createStepper:n,createBatchStepper:function(e,t,s,o,a){let r,l;return r=e.length>=t?i(e,s):[e],l=n(r,null,(function(e){new Promise((function(t,n){o(e,t)})).then(l)}),(function(){a()})),l},elementIsOrIsWithin:function(e,t){return e===t||(t.contains(e)||e.contains(t))},getBIColor:function(e,t,n){var i="rgba(255, 255, 255, 0.3)";if("date"===e){var s=n.substring(0,n.indexOf("T")).split("-"),o=[];o.push([s[0],s[1],s[2]].join("/")),o.push([s[0],s[1]].join("/")),o.push(s[0]);for(var a=!0,r=0,l=o.length;r<l&&a;r++)void 0!==t.map[o[r]]&&(a=!1,i=t.map[o[r]])}else if("boolean"===e&&"boolean"==typeof n){var c=n?"TRUE":"FALSE";i=t.map[c]}else void 0!==t.map[n]&&(i=t.map[n]);return i}}})),define("DS/PADUtils/views/PADTenantMgt",["css!DS/UIKIT/UIKIT","css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Class/Events","UWA/Controls/Abstract","DS/UIKIT/Modal","DS/Controls/Button","DS/UIKIT/Tooltip"],(function(e,t,n,i,s,o,a,r){return s.extend(i,{name:"PadTenantMgt",_command_id:"",init:function(e){var t=this;this._parent(e),e.renderTo||(e.renderTo=document.body);var i=UWA.createElement("div",{class:"padcustomizeview_instruction",content:n.platformChangeMsg}),s=UWA.createElement("div",{class:"footerModal"});changeButton=new a({label:n.change,emphasize:"primary",touchMode:!0,onClick:function(){t.options.currentTenant.isClearView=!0,t.options.callback(t.options.currentTenant),t.modal.hide(),t.modal.destroy()}}),changeButton.inject(s),new a({label:n.cancel,touchMode:!0,onClick:function(){t.options.currentTenant.isMultiTenant=!0,t.options.callback(t.options.currentTenant),t.modal.hide(),t.modal.destroy()}}).inject(s),this.modal=new o({className:"padtenantmgt",closable:!0,visible:!0,header:n.platformChangeTitle,body:i,footer:s}).inject(e.renderTo)}})})),define("DS/PADUtils/views/PADDropTooltip",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events"],(function(e,t,n,i,s,o){"use strict";return i.extend(s,o,{name:"paddrop_tooltip",defaultOptions:{tooltips:{add_in_context:{nls:"add_in_context",icon:"plus"},add_as_object:{nls:"add_as_object",icon:"plus"},insert:{nls:"insert",icon:"plus"},find:{icon:"search",nls:"find"}}},_active_tooltip:null,_isDisplayed:!1,_fonticon:null,_label:null,init:function(e){this._parent(e),this.elements.container=UWA.createElement("div",{class:"padutils_dropTooltip wux-afr-contextual-bar"});var t=UWA.createElement("table",{class:"enopad3Dviewer_dropTooltip_table"}).inject(this.elements.container).insertRow(0);this._fonticon=t.insertCell(0),this._label=t.insertCell(1),this._fonticon.appendChild(UWA.createElement("span",{class:"padutils_dropTooltip_ftIcon wux-ui-3ds wux-ui-3ds-plus"})),this._label.appendChild(UWA.createElement("div",{class:"wux-afr-label"}))},show:function(e){var n=this.elements.container.getDimensions(),i=n.width,s=n.height,o=this.getOption("renderTo");if(!this._isDisplayed&&o&&(this.elements.container.inject(o),this._isDisplayed=!0),e.intent!==this._active_tooltip){for(;this._fonticon.firstChild;)this._fonticon.removeChild(this._fonticon.firstChild);this._fonticon.appendChild(UWA.createElement("span",{class:"padutils_dropTooltip_ftIcon wux-ui-3ds wux-ui-3ds-"+this.options.tooltips[e.intent].icon})),this._label.textContent=t["PADDropInvit_"+this.options.tooltips[e.intent].nls],this._active_tooltip=e.intent}o.clientWidth<=i+e.x+15?this.elements.container.setStyles({left:o.clientWidth-i}):this.elements.container.setStyles({left:e.x+15}),o.clientHeight<=s+e.y+25?this.elements.container.setStyles({top:o.clientHeight-s}):this.elements.container.setStyles({top:e.y+25+"px"})},hide:function(){var e=this.getOption("renderTo");this._isDisplayed&&e&&(e.removeChild(this.elements.container),this._isDisplayed=!1)}})})),define("DS/PADUtils/PADPredicatesNls",["UWA/Core","UWA/Class","UWA/Class/Options","DS/PADServices/utils/DictionaryAccess"],(function(e,t,n,i){"use strict";return t.singleton(n,{init:function(){this._nlsManager=i},updateColumnsWithNLS:function(e,t){this._nlsManager&&this._nlsManager.updateColumnsWithNLS(e,t)},updateNLS:function(e){this._nlsManager&&this._nlsManager.updateNLS(e)}})})),define("DS/PADUtils/views/PADProgressBar",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","DS/Controls/Loader","DS/Controls/Button"],(function(e,t,n,i,s,o,a){"use strict";return i.singleton(s,{name:"pad_progressBar",_UILoader:null,_counter:0,_offTimeout:null,_onTimeout:null,_isCustomTextDisplayed:!1,_defaultText:"",_customText:"",_buttonCB:null,init:function(e){this._parent(e),this._defaultText=t.PADProgressBar_loading,this.elements.container=UWA.createElement("div",{class:"topBarContainer"}),this.render(e),this.elements.viewContainer=UWA.createElement("div",{class:"progressBarContainer"}).inject(this.elements.container),this._UILoader=new o({fadeDuration:0,showButtonFlag:!1}).inject(this.elements.viewContainer),this._button=new a({label:t.PADProgressBar_cancel,emphasize:"primary"}).inject(this._UILoader.elements.container);var n=this;this._button.elements.container.addClassName("PADProgressBar_cancelButton"),this._button.addEventListener("buttonclick",(function(e){n._buttonCB&&n._buttonCB()})),n.elements.container.hide()},render:function(e){var t=e&&e.renderTo?e.renderTo:document.body;this.elements.container.inject(t)},destroy:function(){this._UILoader&&(this._UILoader.destroy(),delete this._UILoader),this._counter=0,this._offTimeout=null,this._isCustomTextDisplayed=!1,this._text="",this._customText="",this._2sTimeout&&(clearTimeout(this._2sTimeout),this._2sTimeout=null),this._10sTimeout&&(clearTimeout(this._10sTimeout),this._10sTimeout=null),this._parent()},on:function(e,n,i){var s=this;s.elements.container.show(),n?(this._buttonCB=n,this._button.label=void 0!==i?i:t.PADProgressBar_cancel,this._button.show()):this._button.hide(),this._defaultText=e||t.PADProgressBar_loading,this._customText=this._defaultText,this._isCustomTextDisplayed?this._UILoader.text=this._text:this._UILoader.text=this._defaultText,this._counter++,this._offTimeout&&clearTimeout(this._offTimeout),this._2sTimeout||(this._2sTimeout=setTimeout((function(){s.elements.viewContainer.addClassName("progressBarShown"),s._10sTimeout||(s._10sTimeout=setTimeout((function(){s._isCustomTextDisplayed=!0,s._UILoader.text=s._customText}),8e3))}),2e3)),s._UILoader.on()},off:function(){var e=this;this._counter--,0===this._counter&&(e._offTimeout=setTimeout((function(){e._2sTimeout&&clearTimeout(e._2sTimeout),e._10sTimeout&&clearTimeout(e._10sTimeout),e.elements.viewContainer.removeClassName("progressBarShown"),e._offTimeout=null,e._isCustomTextDisplayed=!1,e._2sTimeout=null,e._10sTimeout=null,e._customText="",e._buttonCB=null,setTimeout((function(){0===e._counter&&(e.elements.container.hide(),e._UILoader.off())}),1e3)})))},update:function(e){this._UILoader&&this._UILoader.update(e)},setText:function(e){this._UILoader&&e&&(this._customText=e,this._isCustomTextDisplayed&&(this._UILoader.text=this._customText))}})})),define("DS/PADUtils/views/PADThumbnail",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Class","UWA/Class/Options","UWA/Drivers/Alone","DS/Logger/Logger","DS/UIKIT/Modal"],(function(e,t,n,i,s,o,a){"use strict";var r=n.extend(i,{name:"padthumbnail",_logger:null,_modal:null,options:{},init:function(e){this._logger=o.getLogger(r),this._logger.log("init"),this._parent(e),this.setOptions(e),e.renderTo||(e.renderTo=document.body);var t=UWA.createElement("div",{class:this.name+"_main",styles:{"background-image":e.cellModel.options?e.cellModel.options.value:"url('"+e.cellModel+"')"}}),n=this;this._modal=new a({className:this.name+"_modal",closable:!1,body:t,visible:!0}),setTimeout((function(){n._modal.elements.container.addEventListener("click",(function(e){n._modal.destroy()})),n._modal.elements.content.addEventListener("click",(function(e){return e.preventDefault(),e.stopPropagation(),!1})),document.onkeydown=function(e){27===(e=e||window.event).keyCode&&n._modal.destroy()}}),500),this._modal.elements.wrapper.setStyle("width","350px"),this._modal.inject(e.renderTo)}});return r})),define("DS/PADUtils/PADCommandProxy",["DS/PADServices/utils/CommandProxy"],(function(e){"use strict";return e})),define("DS/PADUtils/views/PADFilterCancel",["css!DS/UIKIT/UIKIT","css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Events","DS/UIKIT/SuperModal","DS/UIKIT/Input/Button","DS/Utilities/Utils"],(function(e,t,n,i,s,o,a,r,l){return s.extend(o,{name:"filterCancel",defaultOptions:{},init:function(e,t){this.prdtitle=t,this.cancelModal=new a({className:this.name+"_modal",closable:!0,okButtonText:n.addObject,koButtonText:n.cancel,animate:!0,renderTo:document.body});var i={};i.title=n.replace(n.filterCancel,{name:t}),i.message=n.filterCancelMessage,i.callback=function(t){e.callback(t)},this.cancelModal.fromProxy=!1,this.cancelModal.confirm(i)}})})),define("DS/PADUtils/views/PADAlert",["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/PADServices/utils/PADTrackerManager"],(function(e,t,n){"use strict";return{_notif_manager:null,displayNotification:function(i){null===this._notif_manager&&(this._notif_manager=e,t.setNotificationManager(this._notif_manager),t.setStackingPolicy(5));var s="info";if(UWA.is(i.eventID)&&"primary"!==i.eventID&&(s=i.eventID),this._notif_manager.addNotif({level:s,title:void 0!==i.title?i.title:void 0,subtitle:void 0!==i.subtitle?i.subtitle:void 0,message:i.msg,sticky:!1,allowUnsafeHTML:!1}),"error"===s||"warning"===s){var o=n.getPADTracker({eventCategory:"usage",eventAction:"notification"});o&&(o.setEventData({eventLabel:i.key?i.key:"no-key",eventValue:"error"===s?1:2}),o.trackPageEvent())}},displayAdvancedNotification:function(i){null===this._notif_manager&&(this._notif_manager=e,t.setNotificationManager(this._notif_manager),t.setStackingPolicy(5));var s="info";if(UWA.is(i.eventID)&&"primary"!==i.eventID&&(s=i.eventID),this._notif_manager.addNotif({level:s,title:i.title,subtitle:i.subtitle,message:i.message,sticky:!1,allowUnsafeHTML:!1}),"error"===s||"warning"===s){var o=n.getPADTracker({eventCategory:"usage",eventAction:"notification"});o&&(o.setEventData({eventLabel:i.key?i.key:"no-key",eventValue:"error"===s?1:2}),o.trackPageEvent())}}}})),define("DS/PADUtils/PADPromise",["UWA/Promise"],(function(e){"use strict";var t=[];return{getPromises:function(){for(var e=[],n=0;n<t.length;n++)t[n].isFulfilled&&t[n].isFulfilled()||e.push(t[n]);return t=e},createPromise:function(t,n,i){var s=new e(t),o=this._makeIntrospectablePromise(s,n);return void 0!==i&&!0!==i||this.getPromises().push(o),o},empty:function(){t=[]},_makeIntrospectablePromise:function(e,t){if(e.isResolved)return e;var n=!0,i=!1,s=!1,o=e.then((function(e){return s=!0,n=!1,e}),(function(e){return i=!0,n=!1,e}));return o.isFulfilled=function(){return s},o.isPending=function(){return n},o.isRejected=function(){return i},o.name=t,o}}})),define("DS/PADUtils/PADContext",["UWA/Class","UWA/Class/Options"],(function(e,t){"use strict";return e.singleton(t,{name:"PADContext",init:function(){this._context=null},set:function(e){null===this._context&&(this._context=e)},get:function(e){return null===this._context?void 0===e?null:e:this._context},reset:function(){this._context=null}})})),define("DS/PADUtils/PADModelEvents",["DS/CoreEvents/ModelEvents"],(function(e){console.warn("Deprecated module DS/PADUtils/PADModelEvents use DS/PADServices/utils/GlobalModelEvents");var t=new e;return{getModelEvents:function(){return t},publish:function(e){return t.publish(e)},subscribe:function(e,n){return t.subscribe(e,n)},unsubscribe:function(e){return t.unsubscribe(e)},unsubscribeAll:function(e){return t.unsubscribeAll(e)}}})),define("DS/PADUtils/views/PADLevelSel",["css!DS/PADUtils/PADUtils","css!DS/UIKIT/UIKIT","UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Modal","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/LineEditor","DS/Controls/SpinBox"],(function(e,t,n,i,s,o,a,r,l){"use strict";return i.extend({name:"pad_level_sel",defaultOptions:{current_level:1},init:function(e){this._parent(e);var t=this,n=UWA.createElement("div",{class:this.getClassNames()}),i=new l({value:t.options.current_level,minValue:1,stepValue:1,pageStepValue:1,typingFilter:!0,decimals:0}).inject(n);i.getContent().addClassName(this.getClassNames("_spinbox")),this.elements.level_selector=i,i.getContent().addEvent("change",this._updateDownState.bind(this));var o=new a({icon:"check",emphasize:"success"}).inject(n);o.getContent().addClassName(this.getClassNames("_okbtn")),o.getContent().setStyle("width","22px"),i.addEventListener("change",(function(e){t.options.current_level=parseInt(e.dsModel.value)})),i.elements.inputField&&i.elements.inputField.addEventListener("keyup",(function(e){if(13===e.keyCode){var n=t.options.current_level.toString();t.dispatchEvent("onApply",[n]),d.destroy()}})),o.addEventListener("click",(function(){var e=t.options.current_level.toString();t.dispatchEvent("onApply",[e]),d.destroy()}));var r,c=UWA.is(e.css_style)?" "+e.css_style:"",d=new s({className:this.getClassNames("_modal")+c,closable:!1,body:n,visible:!0});d.elements.wrapper.setStyle("padding-top","calc("+(r="500px",document.body.scrollHeight>40&&(r=document.body.scrollHeight+"px"),r+" - 80px)")),d.elements.scrollableContent&&d.elements.scrollableContent.setStyle("width","155px"),d.elements.container.addEventListener("click",(function(e){d.destroy()})),d.elements.content.addEventListener("click",(function(e){return e.preventDefault(),e.stopPropagation(),!1})),d.inject(document.body),this._updateDownState()},_updateDownState:function(){var e=this.elements.level_selector.value,t=this.elements.level_selector.minValue,n=this.elements.level_selector.elements.down;e<=t?n.addClassName("pad_level_sel_down_arrow_disabled"):n.removeClassName("pad_level_sel_down_arrow_disabled")}})})),define("DS/PADUtils/PADTransactionManager",["UWA/Class","UWA/Class/Events"],(function(e,t){"use strict";var n=function(e,t,n){this.getId=function(){return t},this.isNested=function(){return n};var i=this;this.end=function(){e(i)}};return e.extend(t,{_transactionStack:[],startTransaction:function(e){var t=Boolean(this._transactionStack.length>0),i=this;var s=new n((function(e){var t=i._transactionStack.indexOf(e),n=e.getId();if(t<0)throw new Error('This "'+n+'" transaction is not part of the transaction stack, may be it has already been ended');if(t!==i._transactionStack.length-1)throw new Error('Cannot end this "'+n+'" transaction as it is not the innermost transaction');i._transactionStack.pop();var s=e.isNested();i.dispatchEvent("onTransactionEnd",[n,s])}),e,t);return this._transactionStack.push(s),t=s.isNested(),this.dispatchEvent("onTransactionStart",[e,t]),s},wrapInTransaction:function(e,t){var n=this.startTransaction(t);try{UWA.is(e,"function")&&e()}finally{n.end()}}})})),define("DS/PADUtils/commands/PADAddRoot_cmd",["DS/ApplicationFrame/Command"],(function(e){"use strict";return e.extend({execute:function(e){require(["DS/PADUtils/PADContext","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADTypesMgt","DS/PADUtils/views/PADAlert"],(function(e,t,n,i,s){for(var o="",a=t.getSetting("authorized_root_types")?t.getSetting("authorized_root_types"):t.getSetting("authorized_types"),r=a.length,l=0;l<r;l++){var c=a[l];o=""===o?o+'type:"'+c+'"':o+' OR type:"'+c+'"'}var d={fts_value:o,callback:function(t){var n=e.get(),i=t.selected_data;n.openDroppedObjects({notifPerObjects:!0,displayNotif:!1,unserializedData:i,broadcast:!0,version:"2.0"})},cancel:function(){}};n.inAppsSearch(d)}))}})})),define("DS/PADUtils/commands/PADOpenInCADFromSearch",["text!DS/PADUtils/assets/PADOpenCommandsSettings.json","UWA/Core","UWA/Controls/Abstract","DS/PlatformAPI/PlatformAPI"],(function(e,t,n,i){"use strict";return n.extend({name:"PADOpenInCADFromSearch",_compass_socket:null,_role_check_promise:null,_context:null,init:function(e){e&&e.addinmode&&(this._context=e.addinmode)},availableForTypes:function(){var t=[],n=JSON.parse(e);return this._context&&n["openInCAD_"+this._context+"_supported_types"]&&(t=n["openInCAD_"+this._context+"_supported_types"]),t},getActionForObject:function(n,i){if(this._context){var s=this,o=JSON.parse(e);require(["i18n!DS/PADUtils/assets/nls/PADUtils.json"],(function(e){var a=[],r=null;if(n.taxonomies){var l=null;if(t.is(n.taxonomies,"string"))l=n.taxonomies;else if(t.is(n.taxonomies,"array"))for(var c=0;c<n.taxonomies.length;c++)if(t.is(n.taxonomies[c],"string")&&0===n.taxonomies[c].indexOf("types/")){l=n.taxonomies[c];break}t.is(l)&&(r=l.split("/"))}else r=[n["ds6w:type_value"]];if(t.is(r,"array"))for(var d=!1,u=r.length-1;u>=0;u--){var p=r[u];if(o["openInCAD_"+s._context+"_supported_types"].indexOf(p)>-1&&!d){a.push({icon:"fonticon fonticon-open",id:s.name,multisel:!1,title:e.PAD_CMDOpenInCAD,callback:s.launchCustoAction.bind(s)}),d=!0;break}}i.call(null,a)}))}else i.call(null,[])},launchCustoAction:function(e){i.publish("webinwin:web:notification",JSON.stringify({operation:"open/setObject",operationVersion:"1.0",content:[{phid:e.object_ids[e.object_ids.length-1]}]}))}})})),define("DS/PADUtils/PADWebInWinServices",["UWA/Core","UWA/Class"],(function(e,t){"use strict";return t.singleton({_widget:null,_addinmode:null,initialize:function(e){this._widget=e.widget,this._addinmode=this._widget?this._widget.getValue("addinmode"):"undefined"!=typeof widget?widget.getValue("addinmode"):""},isWebInWinContext:function(){return"solidworks"===this._addinmode||"catiav5"===this._addinmode}})})),define("DS/PADUtils/PADSettingsMgt",["text!DS/PADUtils/assets/PADSettingsMgt.json","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Class","UWA/Class/Options","UWA/Class/Events","DS/PADUtils/views/PADAlert","DS/PADUtils/PADContext","DS/PADUtils/views/PADTenantMgt","DS/PADUtils/Configuration","DS/PADServices/utils/GlobalModelEvents","DS/PADServices/utils/WidgetProxy","DS/PADServices/settings/AppSettings"],(function(e,t,n,i,s,o,a,r,l,c,d,u,p){"use strict";function h(e,t,n){e.splice(n,0,e.splice(t,1)[0])}function g(e,t){for(var n=0;n<e.length;n++){if(e[n].name===t)return n}return null}var f=function(e){return"true"===e.toLowerCase()},_={widgetDomain:null},m=i.singleton(s,o,{app_context:null,version:"1.0",defaultOptions:{run_options:{},debug_options:{},session_options:{},webapi_options:{},layout_options:{}},with_security_context:!1,init:function(e){this._parent(e),this.setOptions(this.defaultOptions)},destroy:function(){this.app_context=null,this.version="1.0",this.options.run_options={},this.options.debug_options={},this.options.session_options={},this.options.webapi_options={},this.options.layout_options={}},setApp:async function(e,t,n,i){return new Promise((s=>{null!==this.app_context&&console.warn("Warning, PADSettingsMgt.setApp has already been initialized. It is not designed to be called more than once per app. Consider updating settings manually instead.");var o=n||!1;this.set_app_context(t,o);var a=e;UWA.is(a.common)&&(this.options.debug_options=UWA.is(a.common.debug_options)?a.common.debug_options:this.options.debug_options,this.options.run_options=UWA.is(a.common.run_options)?a.common.run_options:this.options.run_options,this.options.webapi_options=UWA.is(a.common.webapi_options)?a.common.webapi_options:this.options.webapi_options,this.options.layout_options=UWA.is(a.common.layout_options)?a.common.layout_options:this.options.layout_options),i&&this.options&&this.options&&this.options.run_options&&this.options.run_options.changeControlPosition&&this.options.run_options.changeControlPosition.preference&&(this.options.run_options.changeControlPosition.preference=void 0),UWA.is(t,"string")&&UWA.is(a[t],"object")&&(this.options=UWA.extend(this.options,a[t],!0)),require(["DS/PADServices/settings/AppSettings"],(e=>{e.initializeSettings({padsettingsInit:UWA.clone(this.options)}).then(s)}))}))},set_app_context:function(t,n){var i=JSON.parse(e),s=!UWA.is(n,"boolean")||!n;if(!UWA.is(t,"string"))throw new Error("Invalid app context");this.app_context=t,this.version=i.version,this.options=UWA.extend(this.options,i.common,!0),UWA.is(i[t],"object")&&(this.options=UWA.extend(this.options,i[t],!0)),this.with_security_context=s||!1,!0===this.with_security_context&&(this.options=UWA.extend(i.security_ctx,this.options,!0))},build_preferences:function(e){require("DS/PADUtils/PADSettingsMgt");let t,n=Object.getOwnPropertyNames(e),i=0,s=[];for(i=0;i<n.length;i++){const o=n[i],a=e[o];if(UWA.is(a.preference,"object")&&!0!==a.notAddedByDefault){let e=!0;if(UWA.is(a.activatedBySetting,"string")?(t=m.getSetting(a.activatedBySetting,!0),!1===t&&(e=!1)):UWA.is(a.activatedBySetting,"object")?(t=m.getSetting(a.activatedBySetting.name,!0),t!==a.activatedBySetting.value&&(e=!1)):UWA.is(a.activatedByWidgetPreference,"object")&&"undefined"!=typeof widget&&widget.getValue(a.activatedByWidgetPreference.name)&&widget.getValue(a.activatedByWidgetPreference.name)!==a.activatedByWidgetPreference.value&&(e=!1,m.setSetting(o,!1)),!0===e){const e=UWA.merge({name:o,defaultValue:a.value},a.preference);s.push(e)}}}return s},orderWidgetPreferences:function(){widget&&function(e){for(var t,n,i,s,o,a=e.getPreferences(),r=[],l=!1,c=a.length,d=0;d<c;d++){var u=a[d];"pad_security_ctx"===u.name&&1!==d&&r.push({prop:"pad_security_ctx",from:d,to:1}),"x3dPlatformId"===u.name&&c>1&&(l=!0,0!==d&&r.push({prop:"x3dPlatformId",from:d,to:0}))}if(!l&&r.length){let e={prop:"pad_security_ctx",from:r[0].from,to:0};r.pop(),r.push(e)}if(r.sort((function(e,t){return e.from>t.from?-1:e.from<t.from?1:e.from===t.from?0:void 0})),r.length){for(var p=r.length,f=0;f<p;f++){var _=r[f];0!==f&&(_.from=g(a,_.prop)),p-1===f?(t=a,n=_.from,i=_.to,s=void 0,o=void 0,s=t.splice(n,1)[0],o=t.splice(i,1)[0],t.splice(n,0,o),t.splice(i,0,s)):h(a,_.from,_.to)}e.setPreferences(a)}}(widget)},getWidgetPreferences:function(){var e=[];if(null===this.app_context)throw new Error("Set the app context before using the PADSettingsMgt");if(widget&&(e=e.concat(m.build_preferences(this.options.run_options)),"1"===widget.getValue("debug_me"))){const t=m.build_preferences(this.options.debug_options);e=e.concat(t)}return e},getSpecificWidgetPreference:function(e){if(!UWA.is(e,"string")||0===e.length)throw new Error("getSpecificWidgetPreference: Invalid input parameter");let t=null,n=null;if(this.options.run_options.hasOwnProperty(e))n=this.options.run_options[e];else{if(!this.options.debug_options.hasOwnProperty(e))throw console.error("getSpecificWidgetPreference: Unknown setting ["+e+"]"),new Error("getSpecificWidgetPreference: Unknown setting ["+e+"]");n=this.options.debug_options[e]}if(!UWA.is(n.preference,"object"))throw new Error("getSpecificWidgetPreference: setting ["+e+"] has no prefence defined");return t=UWA.merge({name:e,defaultValue:n.value},n.preference),[t]},getSecurityPreferences:function(){if(this.options.run_options.x3dPlatformId&&this.options.run_options.pad_security_ctx)return m.build_preferences({x3dPlatformId:this.options.run_options.x3dPlatformId,pad_security_ctx:this.options.run_options.pad_security_ctx});throw new Error("Invalid call - Security Context hasn't been declared")},updateSecuritySettings:function(e,t,n,i,s){s=void 0===s||s;for(var o,a="ctx::",r=-1===n.indexOf(a)?a+n:n,l=!1,c=0;c<i.length;c++){var d=i[c];0===c&&(o=d.value),d.value===r&&(l=!0)}l||(r=o),s&&u.addPreference({name:"pad_security_ctx",type:"list",label:"pad_security_ctx",defaultValue:r,options:i}),!0===this._dynamicUpdate?u.dispatchEvent("onEdit"):(m.updateTenantSettings(e,t,s),u.setValue("pad_security_ctx",r),u.setValue("xPref_CREDENTIAL",r.replace("ctx::","")),this.setSetting("pad_security_ctx",r,!0))},updateTenantSettings:function(e,t,n){if(void 0!==window.widget){var i,s,o={name:"x3dPlatformId",type:"list",label:"pad_tenant",defaultValue:e,options:t,onchange:"onPlatformIdChange"};if(1===t.length&&(o.disabled=!0),e&&"OnPremise"!==e)i=!0;else{var a=widget.getValue("x3dPlatformId");a&&"OnPremise"!==a&&(i=!0)}widget.getValue("noCompass")&&(s=!0),s||(i&&n&&widget.addPreference(o),this.orderWidgetPreferences()),widget.setValue("x3dPlatformId",e),this.setSetting("x3dPlatformId",e),widget.setValue("pad_tenant",e),this.setSetting("pad_tenant",e)}else this.setSetting("x3dPlatformId",e),this.setSetting("pad_tenant",e)},updateTenantPreference:function(e){if(null===this.app_context)throw new Error("Set the app context before using the PADSettingsMgt");var n=this,i=r.get();if(i&&UWA.is(i.empty,"function")){var s=!1;UWA.is(i.getPADTreeDocument,"function")?s=0!==i.getPADTreeDocument().getRoots().length:UWA.is(i.getRoots,"function")?s=0!==i.getRoots().length:console.warn("Unknown context");var o=n.getSetting("x3dPlatformId");if(s){var c=n.getSetting("pad_security_ctx");if(o!==e.value)new l({id:"PadTenantMgt",currentTenant:{isMultiTenant:!1,isClearView:!1},callback:function(s){let r=!1;if(s.isClearView)r=!0,i.empty(),n.setSetting(e.name,e.value),a.displayNotification({msg:t.PlatformChange,eventID:"success"});else{var l={tenant:o,padsecurityctx:c};require("DS/PADUtils/PADUtilsServices").updateWidgetSecPref(l),n.setSetting(e.name,n.getSetting("x3dPlatformId"))}d.publish({event:"ENXApp/tenantDialog/complete",data:{skipRefresh:r}})}})}else n.setSetting(e.name,e.value),o!==e.value&&a.displayNotification({msg:t.PlatformChange,eventID:"success"})}else n.setSetting(e.name,e.value)},updateTenantSecPreference:function(e,t){this._dynamicUpdate=t;var n={tenant:e,withPreference:!0,dynamicUpdate:t};require("DS/PADUtils/PADUtilsServices").updateWidgetSecPref(n)},updateWidgetPreferences:function(e){if(this._dynamicUpdate=null,e&&!1===e.submitted)return;if(null===this.app_context)throw new Error("Set the app context before using the PADSettingsMgt");const t=this;widget&&widget.getPreferences().forEach((function(e){"x3dPlatformId"===e.name?m.updateTenantPreference(e):t.setSetting(e.name,e.value)}))},getSetting:function(e,t){var n;return this.options.run_options.hasOwnProperty(e)?n=this.options.run_options[e].value:this.options.debug_options.hasOwnProperty(e)?(!0===t&&this.options.debug_options[e].activatedByWidgetPreference&&"undefined"!=typeof widget&&widget.getValue(this.options.debug_options[e].activatedByWidgetPreference.name)&&widget.getValue(this.options.debug_options[e].activatedByWidgetPreference.name)!==this.options.debug_options[e].activatedByWidgetPreference.value&&(this.options.debug_options[e].value=!1),n=this.options.debug_options[e].value):n=!!this.options.session_options.hasOwnProperty(e)&&this.options.session_options[e].value,n},setSetting:function(e,t,n){var i;if(this.options.run_options.hasOwnProperty(e)?i=this.options.run_options[e]:this.options.debug_options.hasOwnProperty(e)?i=this.options.debug_options[e]:this.options.session_options[e]={value:t},i){var s=t;(i.preference&&"boolean"===i.preference.type&&UWA.is(t,"string")||t&&UWA.is(t.toLowerCase,"function")&&("true"===t.toLowerCase()||"false"===t.toLowerCase()))&&(s=f(t)),i.value!==s&&(i.value=s,!0===i.dispatch&&this.dispatchEvent(function(e){return"on"+e.charAt(0).toUpperCase()+e.slice(1)}(e),s)),n&&"undefined"!=typeof widget&&widget.setValue(e,s)}p.setSetting(e,t)},dispatchEvent:function(e,t){this._parent(e,t),d.publish({event:"ENXApp/SettingsModification/"+e,data:t})},getWebAPI_Options:function(e){var t={};return this.options.webapi_options.hasOwnProperty(e)&&(t=this.options.webapi_options[e]),t},setWebAPI_Options:function(e,t){this.options.webapi_options.hasOwnProperty(e)&&(this.options.webapi_options[e]=t)},getLayout_options:function(e){var t={};return this.options.layout_options.hasOwnProperty(e)&&(t=this.options.layout_options[e]),t},getURLParameter:function(e){return null===_.widgetDomain&&(_.widgetDomain=decodeURIComponent((new RegExp("[?|&]widgetDomain=([^&;]+?)(&|#|;|$)").exec(location.search)||[null,""])[1].replace(/\+/g,"%20"))||null),_.widgetDomain&&decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(_.widgetDomain)||[null,""])[1].replace(/\+/g,"%20"))||null},hasSetting:function(e,t){return!!this.options.run_options.hasOwnProperty(e)||!(!t||!this.options.debug_options.hasOwnProperty(e))}});return m.addEvent("onPad_security_ctx",(function(e){require("DS/PADServices/utils/GlobalUtils").setSecurityContext(e),"undefined"!=typeof widget&&widget.setValue("xPref_CREDENTIAL",widget.getValue("pad_security_ctx").replace("ctx::",""))})),m})),define("DS/PADUtils/PADSecurityCtxConverter",["UWA/Class","UWA/Promise","DS/PADUtils/views/PADAlert","DS/PADUtils/PADSettingsMgt"],(function(e,t,n,i){"use strict";var s=" ";return e.singleton({init:function(e){this._parent(e)},buildSecurityContext:function(e,t,n){return"ctx::"+n+"."+t+"."+e},buildDisplayString:function(e,t,n,i){return i?e+s+"●"+s+n:e+s+"●"+s+t+" ●"+s+n},extractCouple:function(e){var t="",n="",i="",s="";for(var o in e){var a=e[o];switch(o){case"organization":t=a.name,n=a.title?a.title:t;break;case"role":i=a.name,s=a.nls?a.nls:i}}return{org:t,orgTitle:n,role:i,roleNls:s}},prepareForStorage:function(e){let t=void 0!==window.jasmine;if(e&&e.collabspaces||t){var n,i,s,o=require("DS/PADServices/utils/GlobalUtils"),a="ctx:",r=e.pid,l=[];for(var c in e.preferredcredentials){var d=e.preferredcredentials[c];switch(c){case"collabspace":n=d.name,d.title?d.title:n;break;case"organization":i=d.name;break;case"role":s=d.name}}a=this.buildSecurityContext(n,i,s);for(var u=!1,p=function(e,t){for(var n=[],i=0;i<e.collabspaces.length;i++)for(var s=e.collabspaces[i],o=0;o<s.couples.length;o++){var a=t.extractCouple(s.couples[o]);-1===n.indexOf(a.org)&&n.push(a.org)}return 1===n.length}(e,this),h=0;h<e.collabspaces.length;h++)for(var g=e.collabspaces[h],f=0;f<g.couples.length;f++){var _=this.extractCouple(g.couples[f]);"Administrator"===_.roleNls&&o.setAdminUser(!0);var m=this.buildSecurityContext(g.name,_.org,_.role),v=g.title?g.title:g.name,D={csName:v,label:this.buildDisplayString(v,_.orgTitle,_.roleNls,p),value:m};a===m&&(D.isDefault=!0,u=!0),l.push(D)}if(!u&&l.length){var S=l[0];S.isDefault=!0,a=S.value}return l.sort((function(e,t){return e.label<t.label?-1:e.label>t.label?1:0})),{userId:r,securityContext:a,cspaces:l,isAdminUser:o.getAdminUser()}}var P=[];o=require("DS/PADServices/utils/GlobalUtils");for(var y of e.credentials)P.push({csName:y.prjname,label:y.ctxtitle,value:"ctx::"+y.ctxname}),"Administrator"===y.roletitle&&o.setAdminUser(!0);return{securityContext:"ctx::"+e.credentials[0].ctxname,cspaces:P,isAdminUser:o.getAdminUser()}},getSecurityContext:function(e){var i=e.callback,s=e.tenant,o=this;"undefined"!=typeof widget&&widget.lang;require(["DS/PADUtils/PADWSAccess"],(function(e){new t((function(t,i){e.getscandcollab({tenant:s,onComplete:function(e){var n=UWA.is(e,"string")?JSON.parse(e):e,i=o.prepareForStorage(n);t({securityContext:i.securityContext,securityContextList:i.cspaces,isAdminUser:i.isAdminUser})},onFailure:function(e,t){var s,o;if(UWA.is(t,"string")&&t.length>0){try{s=JSON.parse(t)}catch(e){o=t}s&&s.error&&s.error.message?n.displayNotification({msg:s.error.message,eventID:"error",key:"padUtils-getSecurityContext-server-error"}):n.displayNotification({msg:o,eventID:"error",key:"padUtils-getSecurityContext-server-error"})}i(e,t)}})})).then((function(e){i(e)})).catch((function(e){i(null)}))}))},setSecurityContext:function(e){e&&require(["DS/PADUtils/PADUtilsServices"],(function(t){var n=t.getPlatformId(),i=JSON.parse(sessionStorage.getItem("PADSecurityCtx_"+n)),s=e.replace("ctx::","");i!==s&&sessionStorage.setItem("PADSecurityCtx_"+n,JSON.stringify(s))}))}})})),define("DS/PADUtils/PADUtilsServices",["i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Utils/InterCom","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/i3DXCompassServices/i3DXCompassPubSub","DS/PADUtils/PADSettingsMgt","DS/PADUtils/views/PADAlert","DS/PADUtils/views/PADTenantMgt","DS/PADUtils/PADContext","DS/PADUtils/PADIndexedDb","DS/PADServices/utils/WidgetProxy","DS/PlatformAPI/PlatformAPI","DS/PADServices/utils/PADTrackerManager","DS/ENOXParser/modules/Numbers","require","DS/WAFData/WAFData","DS/PADServices/utils/GlobalUtils"],(function(e,t,n,i,s,o,a,r,l,c,d,u,p,h,g,f){"use strict";var _,m,v,D=null,S=null,P=!1,y=!1,A={registrationOpts:function(){return{title:e.ENOPAD_title,mode:"furtive",default_with_precond:!0,widget_id:widget.id,app_socket_id:"enopad_"+widget.id,idcard_activated:!1,advanced_search:{showByDefault:!1},tenant:b.getPlatformId()}},buildDefaultDropData:function(e="ENOSTDE_AP"){const t="ENOSTDE_AP"===e?"ENOSTDE_AP":"ENOPSTR_AP";return{protocol:"3DXContent",version:"2.1",source:widget&&widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):t,widgetId:b.getWidgetId(),data:{items:[]}}},dropdata_from_node:function(e,t={}){let n=[e.options.type];t&&t[e.options.type]&&(n=t[e.options.type]);const i=e.options.i3dx||"",o=b.calculatePathOfNode(e);return{envId:b.getPlatformId(),serviceId:"3DSpace",contextId:s.getSetting("pad_security_ctx")?s.getSetting("pad_security_ctx"):void 0,objectId:e.getID(),objectType:e.options.type,objectTaxonomies:n,displayName:e.options.display?e.options.display:e.getLabel(),displayType:e.options.grid["ds6w:type"],path:o,i3dx:i,cpid:e.options.cpid}},get_current_tenant_idx:function(e){if(e){var t=e;if(!UWA.is(m)||v[m].platformId!==t)for(var n=0;n<v.length;n++)if(v[n].platformId===t){m=n;break}}else if("undefined"!=typeof widget&&_!==widget.getValue("x3dPlatformId")&&(_=widget.getValue("x3dPlatformId")),UWA.is(_)){t=_;if(!UWA.is(m)||v[m].platformId!==t)for(n=0;n<v.length;n++)if(v[n].platformId===t){m=n;break}}return UWA.is(m)||(m=0),m},set_current_tenant:function(e){_=e},set_current_security_ctx:function(e){e;require(["DS/PADUtils/PADSecurityCtxConverter"],(function(t){t.setSecurityContext(e)}))},_getSecurityContext:function(e){var t=e.user,n=e.callback,i=e.tenant;require(["DS/PADUtils/PADSecurityCtxConverter"],(function(e){e.getSecurityContext({user:t,callback:n,tenant:i})}))},update_user_history:function(e){Date.now();var t,n,i,s,o,a=!1,r={},c=b.getUser(),d=b.getUserLogin(),u={id:d,foundCallback:function(e){r=e,t=e.preferredSC||""},notFoundCallback:function(e){a=!0}};try{l.getUser(u)}catch(e){console.error("getUser:",e)}if(c&&c.properties&&UWA.is(c.properties.dashboards,"string")&&(n=Object.keys(JSON.parse(c.properties.dashboards)),i=c.properties.lastOpenedDashboardId||""),r?(s=r.dashboards,o=r.activeDashboard,s&&s===n&&o&&o===i||(a=!0)):a=!0,a){var p={id:d,dashboards:n||s,preferredSC:t||e.currentSC,activeDashboard:i||o,callback:e.callback||function(e){}};try{l.updateUser(p)}catch(e){console.error("updateuser error:",e)}}},update_user_sc_history:function(e){Date.now();var t,n,i,s,o=e.currentSC,a=b.getUser(),r=b.getUserLogin();if(a&&a.properties&&(s=a.properties.lastOpenedDashboardId),r&&s&&(i=r+"_"+s),i){var c={id:i,foundCallback:function(e){n=e.activeSC},notFoundCallback:function(e){t=!0}};try{l.getSC(c)}catch(e){console.error("getSC:",e)}if(n?o&&o!==n&&(t=!0):t=!0,o&&t){var d={id:i,userId:r,dashboardId:s,activeSC:o,callback:e.callback||function(e){}};try{l.addSC(d)}catch(e){console.error("updateSC error",e)}}}},getUserActiveSC:function(e){var t,n,i,s=Date.now(),o=e.user||b.getUser(),a=b.getUserLogin();if(o&&o.properties&&(n=o.properties.lastOpenedDashboardId),a&&n&&(i=a+"_"+n),i){var r={id:i,foundCallback:function(n){t=n.activeSC,UWA.is(e.cb)&&e.cb({activeSC:t})},notFoundCallback:function(t){UWA.is(e.cb)&&e.cb({activeSC:""})}};try{l.getSC(r)}catch(e){console.error(s,"getSC:",e)}}else UWA.is(e.cb)&&e.cb({activeSC:""})},fillSecurityPreferences:function(e){var t,n;Date.now();function i(i){if(y=!1,i)if(""!==i.securityContext&&i.securityContextList.length>0){if(e.padsecurityctx&&0!==e.padsecurityctx.length)s.updateSecuritySettings(o,a,e.padsecurityctx,i.securityContextList,e.withPreference);else{var r=s.getSetting("pad_security_ctx")?s.getSetting("pad_security_ctx"):i.securityContext;o&&"OnPremise"===o&&t&&(r=t),n=r,s.updateSecuritySettings(o,a,r,i.securityContextList,e.withPreference)}t||A.update_user_sc_history({currentSC:n}),e.resolve&&e.resolve()}else 0===i.securityContextList.length&&s.setSetting("noSecurityContext",!0);else s.setSetting("noSecurityContext",!0)}if(e.user&&e.user.properties&&e.user.properties.lastOpenedDashboardId&&A.getUserActiveSC({user:e.user,cb:function(e){t=e.activeSC}}),e.user||(e.user=b.getUser()),!1===y&&!0!==e.dynamicUpdate){y=!0;var o,a=b.getTenantsPreference();e.tenant?(o=e.tenant,c.setValue("x3dPlatformId",o),c.setValue("pad_tenant",o)):c.getValue("x3dPlatformId")?o=c.getValue("x3dPlatformId"):(o=a[0].value,c.setValue("x3dPlatformId",o),c.setValue("pad_tenant",o)),this._getSecurityContext({user:e.user,callback:i,tenant:o})}else 1==e.dynamicUpdate&&this._getSecurityContext({user:e.user,callback:i,tenant:e.tenant})}},b={calculatePathOfNode:function(e){return e.isRelationsObjectNode?void 0:f.isFakeTreeNodeModel(e)?e.getParent().getOccurencePathWithType():e.getOccurencePathWithType?e.getOccurencePathWithType():void 0},getPCSPrefix:function(){return"undefined"==typeof widget?"ODTFallbackPrefix":widget.id+"_"+widget.title},dropdata_from_selected_nodes:function(e){let t=A.buildDefaultDropData(),n=e.filter((function(e){return!0!==e.isGroupingNode}));return t.data.items=n.map((function(e){return A.dropdata_from_node(e)})),t},contentOpenWith:function(e,t){let n=[];e.forEach((function(e){-1===n.indexOf(e.options.type)&&n.push(e.options.type)})),require(["DS/PADUtils/PADTypesMgt"],(function(i){i.retrieveHierarchy(n,(function(n){let i=A.buildDefaultDropData();for(let t=0;t<e.length;t++){const s=e[t];!0!==s.isGroupingNode&&s&&"function"==typeof s.getNodeSource&&1!==s.getNodeSource()&&i.data.items.push(A.dropdata_from_node(s,n))}t(i)}))}))},dropdata_from_selected_ids:function(e){let t=A.buildDefaultDropData("ENOPSTR_AP");for(let n=0;n<e.length;n++){const i=e[n],o=i.options&&i.options.i3dx?i.options.i3dx:"";t.data.items.push({envId:b.getPlatformId(),serviceId:"3DSpace",contextId:s.getSetting("pad_security_ctx")?s.getSetting("pad_security_ctx"):void 0,objectId:i.id,objectType:i.type,displayName:i.label,i3dx:o})}return t},retrieveDroppedDataType:function(e){let t,n="unknown",i={},s=UWA.is(e.dataTransfer.types.indexOf,"function")?"indexOf":"contains",o="";const a=["text/searchitems","text/plain","Text"];for(let t=0;t<a.length&&""===o;t++){const n=e.dataTransfer.types[s](a[t]);(UWA.is(n,"number")&&n>=0||UWA.is(n,"boolean")&&!0===n)&&(o=a[t])}if(""!==o){t=e.dataTransfer.getData(o);try{i=JSON.parse(t),"3DXContent"===i.protocol&&(n=i.protocol)}catch(e){console.warn("Unknown data format")}}return n},deserializeDroppedData:function(e){let t={data:{items:[]}},n=UWA.is(e.dataTransfer.types.indexOf,"function")?"indexOf":"contains",i="";const s=["text/searchitems","text/plain","Text"];for(let t=0;t<s.length&&""===i;t++){const o=e.dataTransfer.types[n](s[t]);(UWA.is(o,"number")&&o>=0||UWA.is(o,"boolean")&&!0===o)&&(i=s[t])}let o;if(""!==i){o=e.dataTransfer.getData(i);try{t=JSON.parse(o)}catch(e){}}return t},retrieveDroppedData:function(t,n,i){function o(t,n){require(["DS/PADUtils/views/PADAlert"],(function(i){i.displayNotification({msg:e.replace(e.get("unsupported_type"),{type:t,name:n}),eventID:"warning"})}))}n=void 0===n||n;var a={},r=[];if(a=b.deserializeDroppedData(t),!0===s.getSetting("accept_all_types")||!0===i)console.log("Accept all types");else{var l=s.getSetting("authorized_types"),c=0;if(UWA.is(l,"array")){if(UWA.is(a.data)&&UWA.is(a.data.items,"array")&&a.data.items.length>0)do{var d=a.data.items[c].objectType;if(a.data.items[c].path&&a.data.items[c].path.length>0){var u="WITHOUT_CONTEXT";t&&(u=t.shiftKey?"WITHOUT_CONTEXT":"WITH_CONTEXT");var p=1;"WITHOUT_CONTEXT"===u&&(p=a.data.items[c].path.length),a.data.items[c].path[p-1].type&&(d=a.data.items[c].path[p-1].type)}if(-1===l.indexOf(d)){if(console.warn("Unsupported type ["+d+"]"),n)o(a.data.items[c].displayType?a.data.items[c].displayType:a.data.items[c].objectType,a.data.items[c].displayName);r=r.concat(a.data.items.splice(c,1))}else c++}while(c<a.data.items.length)}else console.warn("Unknown property authorized_types")}return{unserializedData:a,unsupportedObjects:r}},retrieveDroppedDataAsync:function(e,t,n,i){n=void 0===n||n;var o=b.deserializeDroppedData(e);!0===s.getSetting("accept_all_types")||!0===i?(console.log("Accept all types"),t({unserializedData:o,unsupportedObjects:[]})):require(["DS/PADUtils/PADTypesMgt"],(function(n){n.retrieveAuthorizedObjects({notifPerObjects:!0,displayNotif:!1,dnd_event:e,unserializedData:o,version:"2.0",callback:function(e){t({unserializedData:o,unsupportedObjects:e.unauthorized_objects,authorized_objects:e.authorized_objects,source_data:e.source_data,authorizedWithKind:e.authorizedWithKind})}})}))},getTenantsPreference:function(){var e=[];if(!UWA.is(v,"array"))throw new Error("Platform services not initialize yet");return v.forEach((function(t){e.push({label:t.displayName,value:t.platformId})})),e},getTenantId:function(){return console.warn("Deprecated method. Should use getPlatformId()"),b.getPlatformId()},updatePlatformId:function(e){e&&("undefined"!=typeof widget&&(widget.setValue("x3dPlatformId",e),widget.setValue("pad_tenant",e)),A.set_current_tenant(e),s.setSetting("x3dPlatformId",e),s.setSetting("pad_tenant",e))},get3DSearchUrl:function(){if(!UWA.is(v,"array"))throw new Error("Platform services not initialize yet");var e=A.get_current_tenant_idx(),t="/federated";return-1===v[e]["3DSearch"].indexOf(t,v[e]["3DSearch"].length-10)?v[e]["3DSearch"]+t:v[e]["3DSearch"]},get3DSpaceUrl:function(e){if(!UWA.is(v,"array"))throw new Error("Platform services not initialize yet");var t=0;return t=e?A.get_current_tenant_idx(e):A.get_current_tenant_idx(),void 0===v[t]["3DSpace"]&&console.warn("No 3DSpace URL available for this tenant"),v[t]["3DSpace"]},getPlatformURL:function(e,t,n){if(!UWA.is(v,"array"))throw new Error("Platform services not initialize yet");var i=0;return i=t?A.get_current_tenant_idx(t):A.get_current_tenant_idx(),void 0===v[i][e]?n?void console.error("No "+e+" URL available for this tenant"):(console.error("No "+e+" URL available for this tenant. Returning 3DSpace URL as failsafe"),b.get3DSpaceUrl(t)):v[i][e]},setOption:function(e,t){console.warn("DEPRECATED: Invalid call: please use DS/PADUtils/PADSettingsMgt.setSetting"),s.setSetting(e,t)},getOption:function(e){console.warn("DEPRECATED: Invalid call: please use DS/PADUtils/PADSettingsMgt.getSetting"),s.getSetting(e)},getGrantedRoles:function(e){n.getGrantedRoles((function(t){e(t)}))},getVISnVIOStatus:function(e,t){if(this.isCloud()){if(void 0===t&&(t=0),void 0===this.getPlatformURL("3dvisucontentjobmgmt",void 0,!0)){console.error("No URL for 3dvisucontentjobmgmt service available. Disabling Elastic loading capability");var n=u.getPADTracker({eventCategory:"usage",eventAction:"call_failure"});return n&&(n.setEventData({eventLabel:"getVISnVIOStatus-no-service-url-available"}),n.trackPageEvent()),void e({hasLicense:!1})}var i=this.getPlatformURL("3dvisucontentjobmgmt",void 0,!0)+"/api/v1/activation/license",s={method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},timeout:3e4,onComplete:function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch{t={hasLicense:!1};var n=u.getPADTracker({eventCategory:"usage",eventAction:"call_failure"});n&&(n.setEventData({eventLabel:"getVISnVIOStatus-response-parsing-failed"}),n.trackPageEvent())}var i=u.getPADTracker({eventCategory:"usage",eventAction:"vik_usage"});i&&(i.setEventData({eventLabel:t&&!0===t.hasLicense?"activated":"deactivated"}),i.trackPageEvent()),e(t)}};s.onFailure=function(){var n;++t>5?(console.warn("/!\\ getVISnVIOStatus failed, stopping retry, setting hasLicense = false... /!\\ "),(n=u.getPADTracker({eventCategory:"usage",eventAction:"call_failure"}))&&(n.setEventData({eventLabel:"getVISnVIOStatus-noResponse-after-n-retry-set-false"}),n.persDim.pd2=""+t-1,n.trackPageEvent()),e({hasLicense:!1})):(console.warn("/!\\ getVISnVIOStatus failed, retry n°"+t+"... /!\\ "),(n=u.getPADTracker({eventCategory:"usage",eventAction:"call_failure"}))&&(n.setEventData({eventLabel:"getVISnVIOStatus-retry-on-failure"}),n.persDim.pd2=""+t,n.trackPageEvent()),setTimeout(function(t){this.getVISnVIOStatus(e,t)}.bind(this,t),1e3*Math.pow(t,2)))}.bind(this),s.onTimeout=function(){var n;++t>5?(console.warn("/!\\ getVISnVIOStatus timeout, stopping retry, setting hasLicense = false... /!\\ "),(n=u.getPADTracker({eventCategory:"usage",eventAction:"call_failure"}))&&(n.setEventData({eventLabel:"getVISnVIOStatus-noResponse-after-n-retry-set-false"}),n.persDim.pd2=""+t-1,n.trackPageEvent()),e({hasLicense:!1})):(console.warn("/!\\ getVISnVIOStatus timeout, retry n°"+t+"... /!\\ "),(n=u.getPADTracker({eventCategory:"usage",eventAction:"call_failure"}))&&(n.setEventData({eventLabel:"getVISnVIOStatus-retry-on-timeout"}),n.persDim.pd2=""+t,n.trackPageEvent()),setTimeout(function(t){this.getVISnVIOStatus(e,t)}.bind(this,t),1e3*Math.pow(t,2)))}.bind(this),s.onCancel=function(){var n;++t>5?(console.warn("/!\\ getVISnVIOStatus canceled, stopping retry, setting hasLicense = false... /!\\ "),(n=u.getPADTracker({eventCategory:"usage",eventAction:"call_failure"}))&&(n.setEventData({eventLabel:"getVISnVIOStatus-noResponse-after-n-retry-set-false"}),n.persDim.pd2=""+t-1,n.trackPageEvent()),e({hasLicense:!1})):(console.warn("/!\\ getVISnVIOStatus canceled, retry n°"+t+"... /!\\ "),(n=u.getPADTracker({eventCategory:"usage",eventAction:"call_failure"}))&&(n.setEventData({eventLabel:"getVISnVIOStatus-retry-on-cancel"}),n.persDim.pd2=""+t,n.trackPageEvent()),setTimeout(function(t){this.getVISnVIOStatus(e,t)}.bind(this,t),1e3*Math.pow(t,2)))}.bind(this),g.authenticatedRequest(i,s)}else e({hasLicense:!1})},app_initialization:function(t,i,a){if(a=void 0===a||a,!UWA.is(t,"function"))throw new Error("Invalid callback for the PAD app initialization");var r=require("DS/PADUtils/PADProbes").createProbe("_getPlatformServices"),l="undefined"==typeof widget||null==widget.data||null==widget.data.addPlatformPref||widget.data.addPlatformPref;if("undefined"!=typeof widget&&widget.addEvent("onPlatformIdChange",(function(e,t){"x3dPlatformId"===e&&s.updateTenantSecPreference(t,!0)})),void 0!==i){var c=this.getUser();if(r.end(),r=null,v=i,!0===s.with_security_context)A.fillSecurityPreferences({user:c,withPreference:a});else{var d=b.getTenantsPreference(),u="undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):d[0].value;1==l&&a&&s.updateTenantSettings(u,d)}t.call(null)}else{var p=!1;"undefined"!=typeof widget&&widget.getValue("noCompass")&&(p=!0),n.getPlatformServices({onComplete:function(i){r.end(),r=null,v=[];var c=!1;if(!p&&"undefined"!=typeof widget&&i&&i.length>1){var d=i[0].platformId;d&&-1===["OnTenant1","odt_tenant","OnPremise"].indexOf(d)&&(c=!0)}if(c)n.getAppInfo({appId:b.getAppId(),onComplete:function(n){var r=!!n.tenantAware&&n.tenantAware;if(r){for(var c=0;c<n.platforms.length;c++)for(var d=0;d<i.length;d++)if(!r||i[d].platformId===n.platforms[c].id){v.push(i[d]);break}if(0===n.platforms.length)for(d=0;d<i.length;d++)if(!r||i[d].platformId===n.platformId){v.push(i[d]);break}}else v=i;var u=b.getTenantsPreference();if("undefined"!=typeof widget){let t=b.getPlatformId(),n=!0;for(let e=0;e<v.length&&n;e++)v[e].platformId===t&&(n=!1);n&&(b.updatePlatformId(u[0].value),o.displayNotification({msg:e.replace(e.get("notAccessibleTenant"),{tenant:t,switchedTenant:u[0].label}),eventID:"warning",key:"notAccessibleTenant"}))}if("ENOPSTR_AP"===b.getAppId()){var p=b.getPlatformId();s.updateTenantSettings(p,u,!0)}if(!0===s.with_security_context)A.fillSecurityPreferences({user:b.getUser(),withPreference:a});else{var h="undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):u[0].value;1==l&&a&&(console.info("tenants",u),console.info("current_tenant",h),s.updateTenantSettings(h,u,!0))}t({success:!0})},onFailure:function(e){console.error("Cannot retrieve the App Info"),t({success:!1})}});else{if(v=i,!0===s.with_security_context)A.fillSecurityPreferences({user:b.getUser(),withPreference:a});else{var u=b.getTenantsPreference(),h="undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):u[0].value;1==l&&a&&h&&s.updateTenantSettings(h,u)}t({success:!0})}},onFailure:function(e){r.end(),r=null,t({success:!1})}})}},in_apps_search:function(e){console.warn("DEPRECATED: Invalid call: please use DS/PADUtils/PADUtilsServices.inAppsSearch()");var n=UWA.extend(A.registrationOpts(),e),i=new t.Socket(n.app_socket_id,{dispacthRetryInterval:0});!0===e.debug_mode&&i.setDebugMode(!0),UWA.is(e.parent_window)?i.subscribeServer("SearchComServer",window):i.subscribeServer("SearchComServer"),i.dispatchEvent("RegisterContext",n),UWA.is(e.context_name)&&(n.context_title=e.context_name);var s=[];n.default_search_criteria=e.fts_value,i.dispatchEvent("InContextSearch",n),i.addListener("Selected_Objects_search",(function(e){s=e})),i.addListener("closeTransient",(function(t){"in_app_ok"===t.command_id?e.callback.call(null,s):"in_app_apply"===t.command_id?e.apply?e.apply.call(null,s):e.callback.call(null,s):e.cancel&&e.cancel.call(null),i.dispatchEvent("UnregisterContext",{widget_id:n.widget_id})})),i.addListener("onCloseTransient",(function(t){e.cancel&&e.cancel.call(null),i.dispatchEvent("UnregisterContext",{widget_id:n.widget_id})}))},inAppsSearch:function(e){var n=UWA.extend(A.registrationOpts(),e),i=new t.Socket(n.app_socket_id,{dispacthRetryInterval:0});!0===e.debug_mode&&i.setDebugMode(!0),UWA.is(e.parent_window)?i.subscribeServer("SearchComServer",window):i.subscribeServer("SearchComServer"),i.dispatchEvent("RegisterContext",n),UWA.is(e.context_name)&&(n.context_title=e.context_name),n.default_search_criteria=e.fts_value,i.dispatchEvent("InContextSearch",n),i.addListener("InContextSearch_Response",(function(t){switch(t.selected_command){case"in_app_ok":e.callback.call(null,t);break;case"in_app_apply":e.apply?e.apply.call(null,t):e.callback.call(null,t);break;default:e.cancel&&e.cancel.call(null)}i.dispatchEvent("UnregisterContext",{widget_id:n.widget_id})})),i.addListener("onCloseTransient",(function(t){e.cancel&&e.cancel.call(null),i.dispatchEvent("UnregisterContext",{widget_id:n.widget_id})}))},subscribeCfgModifyEvent(e){var t="cfgEffectivityModifications_"+this.getWidgetId();d.subscribe(t,(function(t){UWA.is(t,"string")&&(t=JSON.parse(t)),console.info("cfg==>",t.commandName),e.handler?e.handler(t):console.info("some random event",t)}))},getWidgetId:function(){return"undefined"!=typeof widget?widget.id:-1},getAppId:function(){if("undefined"!=typeof widget)return widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):widget.getValue("appId")},getSharedId:function(){return"undefined"!=typeof widget?widget.getValue("x3dSharedId")?widget.getValue("x3dSharedId"):this.getAppId():-1},getPlatformId:function(){return"undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):s.getSetting("x3dPlatformId")},getRequestLabel:function(){return b.getUserLogin()+"-"+b.getAppId()+"-"+Date.now()},showTransientWidget:function(e,t,n,i){require(["DS/TransientWidget/TransientWidget"],(function(s){s.showWidget(e,t,n,i)}))},setObject_on_compass:function(e){var n=UWA.is(widget)&&widget.id?"padcompassSocket_"+widget.id:"padcompassSocket";if(!UWA.is(e.nodes_2_open,"array"))throw new Error("setObject_on_compass: Invalid init parameter nodes_2_open");null===D&&(D=new t.Socket(n)).subscribeServer("com.ds.compass",window.parent);var i=null;if(0===e.nodes_2_open.length)D.dispatchEvent("onResetX3DContent",{},n);else{null===i&&(i=require("DS/PADUtils/PADSettingsMgt"));var s=b.dropdata_from_selected_nodes(e.nodes_2_open);0===s.data.items.length?D.dispatchEvent("onResetX3DContent",{},n):D.dispatchEvent("onSetX3DContent",s,n)}},setStructure_4_open_in_cv5:function(e){var t=[];if(!UWA.is(e.nodes_2_open,"array")&&!UWA.is(e.completeselection))throw new Error("setStructure_4_open_in_cv5: Invalid init parameter nodes_2_open");t=e.completeselection?e.completeselection:b.buildOpenJson(e.nodes_2_open,e.selected_paths);var n=JSON.stringify(t);i.publish("setStructure",{structure:n})},buildOpenJson:function(e,t){var n,i,s={version:"1",structures:{references:[],connections:[],trees:{}}},o=[],a="",r=0,l=0,c={},d=[];t&&t.forEach((function(e){d.push(e[e.length-1])}));var u=function(e){var t=c[e];UWA.is(n[t.localid])||(n[t.localid]={},t.selected&&(n[t.localid].selected=t.selected)),n=n[t.localid]},p=function(e){var t=e.isSelected();return d.length&&(t=-1!==d.indexOf(e.getID())),t};return e.forEach((function(e){var t=e.getParents(),d=e.getAllDescendants();for(r=0;r<t.length;r++)(a=t[r].getRelationID()).length>0&&-1===o.indexOf(a)&&(s.structures.connections.push({physicalid:a,localid:l+""}),c[a]={localid:l,selected:p(t[r])},l++,o.push(a)),a=t[r].getID(),-1===o.indexOf(a)&&(s.structures.references.push({physicalid:a,type:t[r].options.type,localid:l+""}),c[a]={localid:l},l++,o.push(a));for((a=e.getRelationID()).length>0&&-1===o.indexOf(a)&&(s.structures.connections.push({physicalid:a,localid:l+""}),c[a]={localid:l,selected:p(e)},l++,o.push(a)),a=e.getID(),-1===o.indexOf(a)&&(s.structures.references.push({physicalid:a,type:e.options.type,localid:l+""}),c[a]={localid:l},e.isRoot()&&p(e)&&(c[a].selected=p(e)),l++,o.push(a)),r=0;r<d.length;r++)(a=d[r].getRelationID()).length>0&&-1===o.indexOf(a)&&(s.structures.connections.push({physicalid:a,localid:l+""}),c[a]={localid:l,selected:p(d[r])},l++,o.push(a)),a=d[r].getID(),-1===o.indexOf(a)&&(s.structures.references.push({physicalid:a,type:d[r].options.type,localid:l+""}),c[a]={localid:l},l++,o.push(a));var h=e.getLeaves();if(h.length>0)for(var g=0;g<h.length;g++)n=s.structures.trees,(i=h[g].getOccurencePath()).forEach(u);else i=e.getOccurencePath(),n=s.structures.trees,i.forEach(u)})),s},open_app:function(e,n){var i=UWA.is(widget)&&widget.id?"padcompassSocket_"+widget.id:"padcompassSocket";null===D&&(D=new t.Socket(i)).subscribeServer("com.ds.compass",window.parent),D.addListener("launchApp",(function(e){UWA.is(n,"function")&&n(e)})),D.dispatchEvent("onLaunchApp",e,i)},launchApp:function(e,t){let n={appId:e.appId,widgetId:e.widgetId};i.publish("launchApp",n,(function(e){UWA.is(t,"function")&&t(e)}))},updateWidgetSecPref:function(e){UWA.is(v,"array")&&A.fillSecurityPreferences(e)},multiTenantMgt:function(t,n,i,s){var l=[],c=r.get(),d={isMultiTenant:!1,isClearView:!1};d.tenant=t[0].envId,d.padsecurityctx=t[0].contextId,""!==d.tenant&&void 0!==d.tenant||(d.tenant="OnPremise");var u=b.getTenantsPreference().find((({value:e})=>e.toLowerCase()===d.tenant.toLowerCase()));if(u&&b.getTenantsPreference().length>1&&b.getPlatformId()!==d.tenant)if(0===n.length)l.push(new Promise((function(e){var t={tenant:d.tenant,padsecurityctx:d.padsecurityctx,resolve:e,withPreference:s};A.fillSecurityPreferences(t)}))),l&&Promise.all(l).then((function(){o.displayNotification({msg:e.PlatformChange,eventID:"success"}),i(d)}));else{var p=require("DS/PADServices/utils/GlobalModelEvents");p.publish({event:"ENXApp/possibleTenantChange"});new a({id:"PadTenantMgt",currentTenant:d,callback:function(t){t.isClearView?(c.empty(void 0,!0),l.push(new Promise((function(e){var t={tenant:d.tenant,padsecurityctx:d.padsecurityctx,resolve:e,withPreference:s};A.fillSecurityPreferences(t)}))),l&&Promise.all(l).then((function(){o.displayNotification({msg:e.PlatformChange,eventID:"success"}),i(t)}))):(p.publish({event:"ENXApp/cancelTenantChange"}),i(t))}})}else u||(d.isMultiTenant=!0,d.invalidTenant=!0,o.displayNotification({msg:e.replace(e.invalidTenant,{tenant:d.tenant}),eventID:"warning",key:"invalidTenant"})),i(d)},authoringCtxAvailable:function(){P=!0},isAuthoringCtxAvailable:function(){return P},setTypesForOFW:function(e){console.warn("/! PADUtilsServices.setTypesForOFW:: Internal and Obsolete Code")},_setpadsocketToNull:function(){D=null},getUser:function(){return null==S&&(S=d.getUser()),S},getUserLogin:function(){var e=b.getUser(),t="";return e&&(t=e.login),t},getUserName:function(){var e=b.getUser(),t="";return e&&(t=e.firstName+" "+e.lastName),t},printWindow:void 0,printWindowOpen:function(){return void 0!==b.printWindow&&null!==b.printWindow&&!1===b.printWindow.closed},printhtml:function(e){b.printWindowOpen()&&b.printWindow.close();setTimeout((function(){b.printWindow=window.open("","PrintWindow","width=1024, height=768"),void 0!==b.printWindow&&(b.printWindow.document.write(e),b.printWindow.document.close(),b.printWindow.focus(),b.printWindow.print(),b.printWindow.close())}),0)},downloadfile:function(e,t,n){var i=document,s=i.createElement("a");if(UWA.is(e)&&UWA.is(t)&&UWA.is(n)){if(n=n||"application/octet-stream",navigator.msSaveBlob&&!this.odtMode)return navigator.msSaveBlob(new Blob([e],{type:n}),t);if("download"in s){var o=URL.createObjectURL(new Blob([e],{type:n}));return s.setAttribute("href",o),s.setAttribute("download",t),s.innerHTML="downloading...",i.body.appendChild(s),setTimeout((function(){s.click(),i.body.removeChild(s),URL.revokeObjectURL(o)}),66),!0}}},getSecurityContext:function(e){var t=b.getTenantsPreference(),n="undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):t[0].value,i=this.getUser();A._getSecurityContext({user:i,callback:e,tenant:n})},isTouchDevice:function(){return"ontouchstart"in document.documentElement},isSurface:function(){return navigator.maxTouchPoints>0},isMobileDevice:function(){return navigator.userAgent.match(/Android|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i)||b.isIOSDesktopMode()},isIPad:function(){return navigator.userAgent.match(/iPad/i)||this.isIOSDesktopMode()},isIOSDesktopMode:function(){return"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1},isCloud:function(){let e;return void 0===e&&(e=!1,"undefined"!=typeof widget&&"OnPremise"!==widget.getValue("x3dPlatformId")&&(e=!0)),e},checkNotIdentity:p.checkNotIdentity};return s.addEvent("onX3dPlatformId",(function(e){A.set_current_tenant(e)})),s.addEvent("onPad_security_ctx",(function(e){Date.now();var t,n={cb:function(e){t=e.activeSC}};A.getUserActiveSC(n),!e&&t&&(e=t),e&&(A.update_user_history({currentSC:e}),A.update_user_sc_history({currentSC:e}),A.set_current_security_ctx(e))})),b})),define("DS/PADUtils/PADSharedSettings",["text!DS/PADUtils/assets/PADSharedSettings.json","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/PADSettingsMgt","DS/PADUtils/Configuration","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADCommandProxy","DS/PADServices/utils/SGIUtils"],(function(e,t,n,i,s,o,a){"use strict";const r="activateSGI";var l={debouncePrefSynchro:{},cbFuncLocal:{},cbFuncShared:{},proxy:null,appWidget:null},c={sharedSettings:JSON.parse(e),usedSharedSettings:[],destroy:function(){l.appWidget=null,l.proxy&&(l.proxy.destroy(),l.proxy=null),l.debouncePrefSynchro={},l.cbFuncLocal={},l.cbFuncShared={},c.usedSharedSettings=[]},listAvailableSharedSettings:function(){return Object.getOwnPropertyNames(c.sharedSettings)},addSharedSettings:function(e,t){if(e){if(l.appWidget||(l.appWidget=e),l.appWidget!==e)throw new Error("Unexpected widget");var i=(UWA.is(t,"array")?t:c.listAvailableSharedSettings()).filter((function(e){return-1===c.usedSharedSettings.indexOf(e)}));if(0===i.length)return;if(-1!==i.indexOf("pad_security_ctx")&&(n.with_security_context=!0),-1!==i.indexOf("enopad3dviewer_CGRorTHB")){var a=e.getValue("enopad3dviewer_CGRorTHB");"boolean"==typeof a&&(a?e.setValue("enopad3dviewer_CGRorTHB","HIGH"):e.setValue("enopad3dviewer_CGRorTHB","OPTIMIZED"))}if(-1!==i.indexOf("autoreload")){var d=e.getValue("Cockpit_RootIds");"null"===d&&(d=null),(d||e.getValue("3dmigrated"))&&(c.sharedSettings.autoreload.value=!0,e.setValue("autoreload",!0),e.deleteValue("3dmigrated"))}var u=i.indexOf(r);-1!==u&&i.splice(u,1);var p,h={},g=[];for(p=0;p<i.length;p++)if(UWA.is(c.sharedSettings[i[p]],"object")){if(("ENOPSTE_AP"===e.data.appId||"ENOSC2D_AP"===e.data.appId)&&!0===c.sharedSettings[i[p]].only3D){i.splice(p,1);continue}n.options.run_options[i[p]]=c.sharedSettings[i[p]],!0!==i[p].notAddedByDefault&&(h[i[p]]=c.sharedSettings[i[p]]),c.usedSharedSettings.push(i[p]),g.push(i[p])}else console.warn("Unknown shared setting "+i[p]);var f=n.build_preferences(h);if(l.appWidget.mergePreferences(f),-1!==i.indexOf("pad_security_ctx")&&s.updateWidgetSecPref({user:s.getUser()}),!l.proxy){var _=function(e){l.debouncePrefSynchro[e.name]=!0,l.appWidget.setValue(e.name,e.value),n.setSetting(e.name,e.value)};l.proxy=o.create({events:{onPreferenceModification:function(e){void 0===l.cbFuncLocal[e.name]&&-1!==c.usedSharedSettings.indexOf(e.name)&&(l.cbFuncLocal[e.name]=_),l.cbFuncLocal[e.name]&&l.cbFuncLocal[e.name](e)}}})}var m=function(e){!0!==l.debouncePrefSynchro[e.name]&&l.proxy?l.proxy.preferenceModification({name:e.name,value:e.value}):l.debouncePrefSynchro[e.name]=!1};for(p=0;p<g.length;p++){!function(e){var t="on"+e.charAt(0).toUpperCase()+e.slice(1);n.addEvent(t,(function(t){var n={name:e,value:t};void 0===l.cbFuncShared[n.name]&&(l.cbFuncShared[n.name]=m),l.cbFuncShared[n.name](n)}))}(g[p])}}},addAsyncSharedSettings:async function(e,t){if(e){if(l.appWidget||(l.appWidget=e),l.appWidget!==e)throw new Error("Unexpected widget");const g=(UWA.is(t,"array")?t:c.listAvailableSharedSettings()).filter((function(e){return-1===c.usedSharedSettings.indexOf(e)}));if(0===g.length)return;if(-1!==g.indexOf("pad_security_ctx")&&(n.with_security_context=!0),-1!==g.indexOf("enopad3dviewer_CGRorTHB")){const t=e.getValue("enopad3dviewer_CGRorTHB");"boolean"==typeof t&&(t?e.setValue("enopad3dviewer_CGRorTHB","HIGH"):e.setValue("enopad3dviewer_CGRorTHB","OPTIMIZED"))}if(-1!==g.indexOf("autoreload")){let t=e.getValue("Cockpit_RootIds");"null"===t&&(t=null),(t||e.getValue("3dmigrated"))&&(c.sharedSettings.autoreload.value=!0,e.setValue("autoreload",!0),e.deleteValue("3dmigrated"))}let f=!1;const _=g.indexOf(r);-1!==_&&(f=await a.isSGIAvailable(),!0!==f?(e.hasPreference(r)&&e.deletePreference(r),g.splice(_,1),!1===a.isSupplementalAvailable()&&(n.setSetting(r,!1),e.deleteValue(r))):!0===a.isSupplementalAvailable()&&(e.hasPreference(r)&&e.deletePreference(r),g.splice(_,1),n.setSetting(r,!0),e.deleteValue(r)));var i,d={},u=[];for(i=0;i<g.length;i++)if(UWA.is(c.sharedSettings[g[i]],"object")){if(("ENOPSTE_AP"===e.data.appId||"ENOSC2D_AP"===e.data.appId)&&!0===c.sharedSettings[g[i]].only3D){g.splice(i,1);continue}n.options.run_options[g[i]]=c.sharedSettings[g[i]],!0!==g[i].notAddedByDefault&&(d[g[i]]=c.sharedSettings[g[i]]),c.usedSharedSettings.push(g[i]),u.push(g[i])}else console.warn("Unknown shared setting "+g[i]);const m=n.build_preferences(d);if(l.appWidget.mergePreferences(m),-1!==g.indexOf("pad_security_ctx")&&s.updateWidgetSecPref({user:s.getUser()}),!l.proxy){var p=function(e){l.debouncePrefSynchro[e.name]=!0,l.appWidget.setValue(e.name,e.value),n.setSetting(e.name,e.value)};l.proxy=o.create({events:{onPreferenceModification:function(e){void 0===l.cbFuncLocal[e.name]&&-1!==c.usedSharedSettings.indexOf(e.name)&&(l.cbFuncLocal[e.name]=p),l.cbFuncLocal[e.name]&&l.cbFuncLocal[e.name](e)}}})}var h=function(e){!0!==l.debouncePrefSynchro[e.name]&&l.proxy?l.proxy.preferenceModification({name:e.name,value:e.value}):l.debouncePrefSynchro[e.name]=!1};for(i=0;i<u.length;i++){!function(e){var t="on"+e.charAt(0).toUpperCase()+e.slice(1);n.addEvent(t,(function(t){var n={name:e,value:t};void 0===l.cbFuncShared[n.name]&&(l.cbFuncShared[n.name]=h),l.cbFuncShared[n.name](n)}))}(u[i])}}return Promise.resolve()},resetDebounceFlags:function(){l.debouncePrefSynchro={}}};return c})),define("DS/PADUtils/PADSettings",["DS/PADUtils/PADUtilsServices"],(function(e){"use strict";return console.warn("Deprecated module DS/PADUtils/PADSettings use DS/PADUtils/PADUtilsServices instead for the services methods or DS/PADUtils/PADSettingsMgt for settings mgt"),e})),define("DS/PADUtils/views/PADPager",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADCommandProxy","DS/CoreEvents/ModelEvents","DS/Controls/Button","DS/Controls/ButtonGroup","DS/UIKIT/Tooltip"],(function(e,t,n,i,s,o,a,r,l,c){"use strict";var d=i.extend({renderTo:null,visible:!1,_modelEvents:null,init:function(e){this.renderTo=e.renderTo?e.renderTo:document.body,this.callbacks=e.callbacks?e.callbacks:{},this.injectNow=e.injectNow?e.injectNow:void 0,this._parent(e),this._buildSkeleton(),this._commandProxy=o.create({events:{onPadPagerSync:this.padPagerSync.bind(this)}}),this._modelEvents=new a;require(["DS/PADServices/utils/GlobalModelEvents"],function(e){e.subscribe({event:"ENXViews/PADPager/close"},function(e){this.getModelEvents().publish({event:"close"})}.bind(this))}.bind(this))},show:function(){!1===this.visible&&(this.elements.container.inject(this.renderTo),this.visible=!0)},hide:function(e=!1){if(!0===this.visible){this.renderTo.removeChild(this.elements.container),this.visible=!1;let t={operation:"close",sharedID:s.getSharedId()};this._commandProxy.padPagerSync(t),e||this.padPagerSync(t)}this.injectNow&&this.destroy()},padPagerSync:function(e){e&&e.operation&&("next"===e.operation&&this.callbacks.onNext?this.callbacks.onNext():"previous"===e.operation&&this.callbacks.onPrevious?this.callbacks.onPrevious():"selectAll"===e.operation&&this.callbacks.onSelectAll?this.callbacks.onSelectAll():"reframeAll"===e.operation&&this.callbacks.onReframeAll?this.callbacks.onReframeAll():"close"===e.operation&&this.callbacks.onClose&&this.callbacks.onClose())},setLabel:function(e){this.elements.textInfo&&(this.elements.textInfo.innerHTML=e)},publish:function(e){this.getModelEvents().publish(e)},subscribe:function(e,t){return this.getModelEvents().subscribe(e,t)},unsubscribe:function(e){this.getModelEvents().unsubscribe(e)},getModelEvents:function(){return this._modelEvents},_buildSkeleton:function(){var e=this;this.elements.container=UWA.createElement("div",{class:"PADPagerContainer"}),this.elements.topBarContainer=UWA.createElement("span",{class:"PADSelectionNavigatiorTopBar"}).inject(this.elements.container),this.elements.textInfo=UWA.createElement("div",{class:"PADPagerLabel wux-afr-label"}).inject(this.elements.topBarContainer),this.elements.navActions=UWA.createElement("span",{class:"PADSelectionNavigateActions"}).inject(this.elements.topBarContainer),this.elements.navBtnGrp=new l({}).inject(this.elements.navActions),this.elements.previousButton=new r({title:t.PADSearchView_previous,type:"standard",icon:{iconName:"chevron-up",fontIconFamily:1}}),this.elements.previousButton.getContent().addClassName("PADPager3DPreviousButton PADPager-controls-button"),this.elements.previousButtonTooltip=new c({target:this.elements.previousButton.elements.button,position:"bottom"}),this.elements.previousButtonTooltip.setBody(t.PADSearchView_previous),this.elements.nextButton=new r({title:t.PADSearchView_next,type:"standard",icon:{iconName:"chevron-down",fontIconFamily:1}}),this.elements.nextButton.getContent().addClassName("PADPager3DNextButton PADPager-controls-button"),this.elements.nextButtonTooltip=new c({target:this.elements.nextButton.elements.button,position:"bottom"}),this.elements.nextButtonTooltip.setBody(t.PADSearchView_next),this.elements.navBtnGrp.addChild(this.elements.previousButton),this.elements.navBtnGrp.addChild(this.elements.nextButton),this.elements.selectButton=new r({title:t.PADSearchView_select,type:"standard",icon:{iconName:"select-on",fontIconFamily:1}}).inject(this.elements.topBarContainer),this.elements.selectButton.getContent().addClassName("PADPager3DSelectButton PADPager-controls-button"),this.elements.selectButtonTooltip=new c({target:this.elements.selectButton.elements.button,position:"bottom"}),this.elements.selectButtonTooltip.setBody(t.PADSearchView_select),this.callbacks.onReframeAll&&(this.elements.reframeButton=new r({title:t.PADSearchView_reframe,type:"standard",icon:{iconName:"zoom-fit",fontIconFamily:1}}).inject(this.elements.topBarContainer),this.elements.reframeButton.getContent().addClassName("PADPager3DReframeButton PADPager-controls-button"),this.elements.reframeButtonTooltip=new c({target:this.elements.reframeButton.elements.button,position:"bottom"}),this.elements.reframeButtonTooltip.setBody(t.PADSearchView_reframe)),s.isMobileDevice()?(this.elements.selectButton.getContent().setStyle("margin-top","0px"),this.elements.reframeButton&&this.elements.reframeButton.getContent().setStyle("margin-top","0px"),this.elements.previousButton.addEventListener("touchend",(function(t){e.padPagerSync({operation:"previous"}),e._commandProxy.padPagerSync({operation:"previous"})})),this.elements.nextButton.addEventListener("touchend",(function(t){e.padPagerSync({operation:"next"}),e._commandProxy.padPagerSync({operation:"next"})})),this.elements.selectButton.addEventListener("touchend",(function(t){e.padPagerSync({operation:"selectAll"}),e._commandProxy.padPagerSync({operation:"selectAll"})})),this.elements.reframeButton&&this.elements.reframeButton.addEventListener("touchend",(function(t){e.padPagerSync({operation:"reframeAll"}),e._commandProxy.padPagerSync({operation:"reframeAll"})}))):s.isTouchDevice()?(this.elements.previousButton.addEventListener("click",(function(t){e.padPagerSync({operation:"previous"}),e._commandProxy.padPagerSync({operation:"previous"})})),this.elements.nextButton.addEventListener("click",(function(t){e.padPagerSync({operation:"next"}),e._commandProxy.padPagerSync({operation:"next"})})),this.elements.selectButton.addEventListener("click",(function(t){e.padPagerSync({operation:"selectAll"}),e._commandProxy.padPagerSync({operation:"selectAll"})})),this.elements.reframeButton&&this.elements.reframeButton.addEventListener("click",(function(t){e.padPagerSync({operation:"reframeAll"}),e._commandProxy.padPagerSync({operation:"reframeAll"})})),this.elements.previousButton.addEventListener("touchend",(function(t){e.padPagerSync({operation:"previous"}),e._commandProxy.padPagerSync({operation:"previous"})})),this.elements.nextButton.addEventListener("touchend",(function(t){e.padPagerSync({operation:"next"}),e._commandProxy.padPagerSync({operation:"next"})})),this.elements.selectButton.addEventListener("touchend",(function(t){e.padPagerSync({operation:"selectAll"}),e._commandProxy.padPagerSync({operation:"selectAll"})})),this.elements.reframeButton&&this.elements.reframeButton.addEventListener("touchend",(function(t){e.padPagerSync({operation:"reframeAll"}),e._commandProxy.padPagerSync({operation:"reframeAll"})}))):(this.elements.previousButton.addEventListener("click",(function(t){e.padPagerSync({operation:"previous"}),e._commandProxy.padPagerSync({operation:"previous"})})),this.elements.nextButton.addEventListener("click",(function(t){e.padPagerSync({operation:"next"}),e._commandProxy.padPagerSync({operation:"next"})})),this.elements.reframeButton&&this.elements.reframeButton.addEventListener("click",(function(t){e.padPagerSync({operation:"reframeAll"}),e._commandProxy.padPagerSync({operation:"reframeAll"})})),this.elements.selectButton.addEventListener("click",(function(t){e.padPagerSync({operation:"selectAll"}),e._commandProxy.padPagerSync({operation:"selectAll"})}))),this.elements.closeButton=UWA.createElement("span",{class:"fonticon fonticon-wrong PADPagerCloseButton","data-toggle":"tooltip","data-placement":"top",title:t.PADSearchView_close}).inject(this.elements.topBarContainer),s.isTouchDevice()&&this.elements.closeButton.addClassName("CloseButtonTouch"),this.elements.closeButton.addEventListener("click",(function(t){let n={operation:"close",sharedID:s.getSharedId()};e._commandProxy.padPagerSync(n),e.padPagerSync(n)}))},destroy:function(){this._commandProxy&&(this._commandProxy.padDestroy(),this._commandProxy.destroy(),delete this._commandProxy)}});return UWA.namespace("DS/PADUtils/commands/PADPager",d)})),define("DS/PADUtils/views/PADDnDInviteLA",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/Core/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","UWA/Utils/Client","DS/PADUtils/PADContext","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADWebInWinServices","DS/PADUtils/PADUtilsServices","DS/PADServices/utils/GlobalUtils","DS/PADServices/utils/GlobalModelEvents","DS/PADServices/utils/Generics","DS/PADServices/utils/Storage"],(function(e,t,n,i,s,o,a,r,l,c,d,u,p,h,g){"use strict";const f=g.sess.get("PADDnDInvite_debug_dnd")?console.log:function(){},_="paddnd_invite_ignore",m="paddnd-invite-hover",v=["empty","column"],D=["empty","leave","column","overcell"],S={mode:"drop",behavior:"WITH_CONTEXT",unserializedData:null,broadcast:!0};function P(e,t){return h.merge({behavior:e,unserializedData:t},S)}function y(e){var t=0,n=0;return e.pageX||e.pageY?(t=e.pageX,n=e.pageY):(e.clientX||e.clientY)&&(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:t,y:n}}function A(e,t){return e.y>=t.top&&e.y<=t.bottom&&e.x>=t.left&&e.x<=t.right}function b(e,t){let n=!1;return A(t,e.getBoundingClientRect())&&(n=!0),n}function x(e,n,i){let s=UWA.createElement("div",{class:e.getClassNames("_display "+n.key),draggable:!1,"data-id":n.key});return UWA.createElement("i",{class:e.getClassNames("_img wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-"+n.icon)}).inject(s),UWA.createElement("h5",{class:e.getClassNames("_txt font-3dsregular "+n.key),text:t["PADDropInvit_"+n.nls]}).inject(s),s.inject(i),s}function C(e){f("default");let t='[data-id="'+e.options.defaultInvite+'"]';return e.elements.informationThree.querySelector(t)}function w(e){e.classList.add(_)}function U(e){e.classList.remove(_)}function T(e){return e.preventDefault(),e.stopPropagation(),!1}function I(){return null!==document.querySelector(".eno-find-panel-content")}var E;function O(){return E||(E=r.get()),E._commandProxy}var W=i.extend(s,o,{name:"paddnd_invite",defaultOptions:{mode:"dynamic",invites:{drop:{nls:"drop",icon:"drag-drop"},add_in_context:{nls:"add_in_context",icon:"plus"},add_as_object:{nls:"add_as_object",icon:"plus"},insert:{icon:"plus",nls:"insert"},find:{icon:"search",nls:"find"}},active_invite:"drop",three:{open_filter:{sort:2,nls:"filter",behavior:"FILTER",icon:"filter"},add_in_context:{sort:1,nls:"add_in_context",behavior:"WITH_CONTEXT",icon:"plus",isDefault:!0},add_as_object:{sort:0,nls:"add_as_object",behavior:"WITHOUT_CONTEXT",icon:"plus"}},defaultInvite:"",isTouchActivated:!1},init:function(e){this._parent(e),this.options.isTouchActivated=l.getSetting("touchDropInvite")&&a.Features.touchEvents&&!a.Features.pointerEvents,this.options.isTouchActivated&&(this.options.invites.drop={nls:"add_as_object",icon:"touch"}),this.options.dndLA=!this.options.hasOwnProperty("dndLA")||this.options.dndLA,this._dndLAInit(e)},_dndLAInit:function(e){this._originalInit(e),this.options.isEditor="ENOPSTR_AP"===u.getAppId(),this.options.hasWelcomePanel=this.options.hasOwnProperty("hasWelcomePanel")?this.options.hasWelcomePanel:null!==document.querySelector(".enx-welcome-panel");let t=this.elements.containerThree=UWA.createElement("div",{class:this.getClassNames("_containerThree")}),n=this.elements.informationThree=UWA.createElement("div",{class:this.getClassNames("_informationThree")});n.inject(t),n.hide();let i=function(e){let t=[],n=Object.keys(e);for(let i=0;i<n.length;i++){let s=n[i],o=e[s];o.key=s,t.push(o)}return t.sort((function(e,t){return e.sort-t.sort})),t}(this.options.three);this.options.invitesArray=[],this.options.threeOptions=i;for(let e=0;e<i.length;e++){let t=i[e],s=x(this,t,n);t.isDefault&&(this.options.defaultInvite=t.key),this.options.invitesArray.push(s)}this._boundInsertDragOver=this._onInsertDragOver.bind(this),t.addEventListener("drop",this._onDrop.bind(this)),t.addEventListener("dragenter",this._onDragEnter.bind(this)),t.addEventListener("dragover",this._onDragOver.bind(this)),t.addEventListener("dragleave",this._onDragLeave.bind(this)),t.addEventListener("dragend",this._onDragEnd.bind(this)),w(t),this._subscribeEvents(),t.inject(this.getOption("renderTo"))},_originalInit:function(e){switch(this.getMode()){case"none":break;case"drop_here":this._createDropHereInvite();break;case"dynamic":this._createDynamicInvite();break;case"inviteWithFilter":void 0===e.filterActive||!0===e.filterActive?this._createDynamicInvite(!0):this._createDynamicInvite(!1);break;default:console.warn("Unknown mode ["+this.getMode()+"]"),this._createDynamicInvite()}},_createDynamicInvite:function(e){var n=this;this.elements.container=UWA.createElement("div",{class:this.getClassNames("_container_la")});var i=Object.getOwnPropertyNames(this.options.invites);if(this.elements.container.informationDiv=UWA.createElement("div",{class:this.getClassNames("_informationMain"),draggable:!1}),this.elements.container.informationDiv.inject(this.elements.container),this.options.isTouchActivated){this.elements.container.className+=" touch_look",this.elements.container.informationDiv.style.pointerEvents="auto",this.elements.container.informationDiv.addEventListener("touchend",(function(e){require(["DS/ApplicationFrame/CommandsManager"],(function(e){e.getCommand("AddRoot","Default").begin()}))}))}for(var s=0;s<i.length;s++){var o=i[s];this.options.dndLA&&"insert"===o&&(this.options.invites[o].nls="add"),this.elements.container[o]=UWA.createElement("div",{class:this.getClassNames("_display "+o),draggable:!1}),UWA.createElement("i",{class:this.getClassNames("_img wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-"+this.options.invites[o].icon)}).inject(this.elements.container[o]),UWA.createElement("h5",{class:this.getClassNames("_txt font-3dsregular "+o),text:t["PADDropInvit_"+this.options.invites[o].nls]}).inject(this.elements.container[o]),this.elements.container[o].inject(this.elements.container.informationDiv),this.options.active_invite!==o&&this.elements.container[o].hide()}UWA.is(n.options.dropOnInvite,"function")&&(this.elements.container.addEventListener("dragover",(function(e){return e.preventDefault(),e.stopPropagation(),!1})),this.elements.container.addEventListener("drop",(function(e){return n.options.dropOnInvite(e),!1}))),this.getOption("renderTo")&&this.elements.container.inject(this.getOption("renderTo"))},_subscribeEvents:function(){p.subscribe({event:"ENXModel/Root/remove"},this._removeRoots.bind(this))},_removeRoots:function(e){e.all&&(this.elements.informationThree.hide(),this.showOriginal("drop"))},_onDrop:function(e){let t=y(e);if(b(this.elements.informationThree,t)){f("inside");let n=this.options.invitesArray.filter((function(e){return b(e,t)})),i=u.deserializeDroppedData(e);if(n.length){f("match",n);let t=n[0].dataset.id,s=this.options.three[t];if(this.options.hasWelcomePanel){let t=P(s.behavior,i);if(e.shiftKey&&(t.behavior="WITHOUT_CONTEXT"),p.publish({event:"ENXViews/WelcomePanel/openContent",data:t}),"FILTER"===t.behavior){O().loadStoredObj(t)}}else this._onDispatchOldCallback(e,s.behavior)}}else{let t=C(this);if(this.options.hasWelcomePanel){let n=u.deserializeDroppedData(e),i=P(t.behavior,n);p.publish({event:"ENXViews/WelcomePanel/openContent",data:i})}else this._onDispatchOldCallback(e,t.behavior)}return this._cleanupHovers(),this.elements.container.informationDiv.hide(),this.elements.informationThree.hide(),w(this.elements.containerThree),0===r._context.getRoots().length&&this.show("drop"),w(this.elements.container),T(e)},_onDispatchOldCallback:function(e,t){switch(e.shiftKey&&(t="WITHOUT_CONTEXT"),t){case"FILTER":this._dropFilterCB(e);break;case"WITH_CONTEXT":e.shiftKeyOverride=!1,this.options.dropOnInvite(e);break;case"WITHOUT_CONTEXT":e.shiftKeyOverride=!0,this.options.dropOnInvite(e)}},_onDragEnter:function(e){return!!I()||(this.elements.informationThree.show(),this.elements.container.informationDiv.hide(),T(e))},_onDragOver:function(e){if(I())return!0;this.elements.informationThree.show(),this.elements.container.informationDiv.hide();let t=this,n=function(e){f("default");const n=C(t);t._hoverUpdate(n)},i=y(e);if(b(this.elements.informationThree,i)){f("inside");let e=this.options.invitesArray.filter((function(e){return b(e,i)}));if(e.length){f("matched",e);let t=e[0];this._hoverUpdate(t)}else n()}else n();return T(e)},_onDragLeave:function(e){w(this.elements.containerThree);let t=y(e),n=document.querySelector("#BubbleContainer");return n&&b(n,t)?(this._cleanupHovers(),this.elements.informationThree.hide()):b(this.elements.informationThree,t)||b(this.options.renderTo,t)||(this._cleanupHovers(),this.elements.informationThree.hide(),this._displayEmptyDropIf()),T(e)},_onDragEnd:function(e){let t=y(e),n=document.querySelector("#BubbleContainer");n&&b(n,t)&&(this._cleanupHovers(),this.elements.informationThree.hide())},_onInsertDragOver:function(e){this.elements.container.informationDiv.hide(),this.elements.informationThree.show(),this.setInsertState(!1)},_dropFilterCB:function(e){e.preventDefault(),e.stopPropagation(),this.elements.container.removeClassName("withFilterOpen"),this.options.dndLA||(this.elements.container.filterDiv.style.display="none");var t=r.get();if(t.dropBehavior="FILTER",e.dataTransfer.files&&e.dataTransfer.files.length>0){var n=t?t.options.model:null;return n&&0===n.getRoots().length?this.show("drop"):this.hide(),!1}let i=!1;t&&t.publish?t.publish({event:"onFilterDropped"}):i=!0;var s=d.deserializeDroppedData(e);return"wafr"!==l.getSetting("eno3dviewer_infrastructure_version")||i?require(["DS/ApplicationFrame/CommandsManager"],function(e){var n=e.getCommand("FilterDropObjects","function"==typeof t.getCommandContext?t.getCommandContext():null);if(n)if(i){let e={isWP:!1,fromProxy:!1,loadWithFilter:!0};n.execute(s,e)}else n.execute(s);else console.error("PADDnDInvite : _dropFilterCB() - The command PAD3DViewerFilterDropObjectsHdr is undefined");this.hide()}.bind(this)):t.loadSource("DS/ENOPAD3DViewer/commands/PAD3DViewerFilterDropObjectsCmd").then((e=>{(new e).execute(s)})).catch((e=>{console.error("PADDnDInvite : _dropFilterCB() - The command PAD3DViewerFilterDropObjectsCmd is undefined")})),!1},_createDropHereInvite:function(){this.elements.container=UWA.createElement("div",{class:this.getClassNames("_drop_here"),draggable:!1}),UWA.createElement("i",{class:this.getClassNames("_img wux-ui-3ds wux-ui-3ds-4x wux-ui-3ds-drag-drop")}).inject(this.elements.container),UWA.createElement("h5",{class:this.getClassNames("_txt drop_here"),text:t.PADDropInvit_drop_here}).inject(this.elements.container),this.getOption("renderTo")&&this.elements.container.inject(this.getOption("renderTo"))},show:function(e){I()||(this.options.dndLA?this.showLA(e):this.showOriginal(e))},hide:function(e){this.options.dndLA?this.hideLA(e):this.hideOriginal(e)},dropOccurred:function(){w(this.elements.containerThree),w(this.elements.container)},setInsertState:function(e){this._insertState=e,e?(U(this.elements.container),w(this.elements.containerThree),this.elements.container.addEventListener("dragover",this._boundInsertDragOver)):(w(this.elements.container),U(this.elements.containerThree),this.elements.container.removeEventListener("dragover",this._boundInsertDragOver))},getNotInsertState:function(){return!0!==this._insertState},showLA:function(e){"drop"===e?(this.elements&&this.elements.containerThree&&this.elements.container&&(this.elements.container.show(),this.elements.containerThree.show()),this.elements.container.informationDiv.show(),this.showOriginal("drop")):"insert"===e&&(this.setInsertState(!0),this.elements&&this.elements.containerThree&&this.elements.container&&(this.elements.container.show(),this.elements.containerThree.show()),this.elements.container.informationDiv.show(),this.elements.informationThree.hide(),this.showOriginal(e))},hideLA:function(e){"none"!==this.getMode()&&(void 0===e?(this.elements.container.informationDiv.hide(),this.elements.informationThree.hide(),w(this.elements.container)):"insert"===e&&this.setInsertState(!1),this.elements&&this.elements.containerThree&&this.elements.container&&(this.elements.container.hide(),this.elements.containerThree.hide()))},showOriginal:function(e){switch(this.getMode()){case"none":break;case"drop_here":"drop"===e?(this.elements.container.show(),this.dispatchEvent("toggleInvite",!0)):"block"===this.elements.container.getStyle("display")&&(this.elements.container.hide(),this.dispatchEvent("toggleInvite",!0));break;default:this.options.active_invite!==e&&(UWA.is(e,"string")?(this.options.active_invite!==e&&""!==this.options.active_invite&&this.elements.container[this.options.active_invite].hide(),this.options.active_invite=e):this.options.active_invite="drop","drop"===this.options.active_invite?this.elements.container.informationDiv.style.pointerEvents="auto":this.elements.container.informationDiv.style.pointerEvents="none",this.elements.container[this.options.active_invite].show(),this.elements.container.show(),this.dispatchEvent("toggleInvite",!0))}},hideOriginal:function(e){switch(this.getMode()){case"none":this.options.active_invite="";break;case"drop_here":"block"===this.elements.container.getStyle("display")&&(this.elements.container.hide(),this.dispatchEvent("toggleInvite",!0));break;default:UWA.is(e,"string")?""!==this.options.active_invite&&this.options.active_invite===e&&(this.elements.container[this.options.active_invite].hide(),this.elements.container.hide()):""!==this.options.active_invite&&(this.elements.container[this.options.active_invite].hide(),this.elements.container.hide()),this.options.active_invite="",this.dispatchEvent("toggleInvite",!1)}},getMode:function(){return c.isWebInWinContext()?"none":this.options.mode},isEventInside:function(e){if("none"===this.getMode())return!1;var t=y(e);if(!this.elements.container.isHidden()&&A(t,this.elements.container.getBoundingClientRect()))return!0;return!1},isEventInsideThree:function(e){var t=y(e);if(!this.elements.containerThree.isHidden()&&b(this.elements.containerThree,t))return!0;return!1},processIfInside:function(e,t,n){if("leave"===e&&this.getNotInsertState()&&(U(this.elements.containerThree),U(this.elements.container)),I())return{isInside:!1,returnValue:!0};let i=y(t);if(b(this.elements.informationThree,i)){let s={isInside:!0,returnValue:!0};return this._processByEvent(e,t,n,s,i,!0),s}{let s={isInside:!1,returnValue:!0};if(D.includes(e))return this._processByEvent(e,t,n,s,i,!1),s}return{isInside:!1}},_processByEvent:function(e,t,n,i,s,o){f("_processByEvent",t,e,o);let a=b(this.options.renderTo,s);switch(t.type){case"dragleave":if(t.preventDefault(),t.stopPropagation(),i.returnValue=!0,o)this._matchAndHighlight(s);else if("leave"===e)if(a){let e=document.querySelector("#BubbleContainer");e&&b(e,s)?(this._cleanupHovers(),this.elements.informationThree.hide()):i.isInside=!0}else this.elements.container.informationDiv.show(),this.elements.informationThree.hide(),this._displayEmptyDropIf();break;case"dragover":case"dragenter":t.preventDefault(),t.stopPropagation(),t.dataTransfer&&("copyMove"!==t.dataTransfer.effectAllowed&&"copy"!==t.dataTransfer.effectAllowed||(t.dataTransfer.dropEffect="copy"));let n=this,r=function(){const e=C(n);n.elements.container.informationDiv.hide(),n.elements.informationThree.show(),n._hoverUpdate(e)};o?(U(this.elements.containerThree),this._matchAndHighlight(s)):v.includes(e)&&a?r():"overcell"===e&&a?this.options.isEditor?(this.setInsertState(!0),this.elements.container.informationDiv.show(),this.elements.informationThree.hide(),this.showOriginal("insert")):r():(this.elements.container.informationDiv.show(),this.elements.informationThree.hide()),i.returnValue=!0;break;default:this.elements.informationThree.hide(),w(this.elements.containerThree),w(this.elements.container)}},_displayEmptyDropIf:function(){(function(){E||(E=r.get());let e=void 0!==E.publish,t=E.getRoots(),n=e?E._controller.getHiddenRootIds():[];return t&&0===t.length&&0===n.length})()&&(this.elements.informationThree.hide(),this.elements.container.informationDiv.show(),this.showOriginal("drop"))},_matchAndHighlight:function(e){let t=this.options.invitesArray.filter((function(t){return b(t,e)}));if(t.length){let e=t[0];this._hoverUpdate(e)}else{const e=C(this);this._hoverUpdate(e)}},_hoverUpdate:function(e){e.classList.add(m);let t=this.options.invitesArray.filter((function(t){return e!==t}));for(let e=0;e<t.length;e++){t[e].classList.remove(m)}},_cleanupHovers:function(){let e=this.options.invitesArray;for(let t=0;t<e.length;t++){e[t].classList.remove(m)}}});return W})),define("DS/PADUtils/commands/RightSidePanel",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","UWA/Promise","DS/PADUtils/PADContext","DS/PADUtils/PADUtilsServices","DS/Utilities/Utils","UWA/Class/Model","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADServices/utils/SGIUtils","DS/PADServices/utils/GlobalModelEvents"],(function(e,t,n,i,s,o,a,r,l,c){"use strict";let d,u,p=[],h=!1;return void 0!==i.get&&null!==i.get()&&void 0!==i.get().getEditMode&&!0!==i.get().getEditMode()&&(h=!0),t.extend({_context:null,_propertiesWdg:null,_xso:null,_readOnly:h,_tkAdd:null,_tkRemove:null,_tkEmpty:null,init:function(e){this._parent(e,{}),this._context=i.get();const t=this;e.arguments.length&&e.arguments.forEach((function(e){"PropertiesReadOnly"===e.ID&&"true"===e.Value&&(t._readOnly=!0)}));const n=o.debounce((function(){if(t.getTriptych()){let e=t.getTriptych()?t.getTriptych()._rightPanel:void 0,n=e?e.getElementsByClassName("triptych-close-right fonticon fonticon-wrong"):[];n.length&&n[0].classList.contains("displaynone")&&n[0].classList.remove("displaynone")}0===t.getXSO().get().length?t._propertiesWdg&&t._propertiesWdg.initDatas([]):!0===t.getState()&&t._selectionChange()}),100);this._tkAdd=this.getXSO().onPostAdd(n),this._tkRemove=this.getXSO().onPostRemove(n),this._tkEmpty=this.getXSO().onEmpty(n),this._buildView(),c.subscribe({event:"ENXViews/Triptych/onOverlayClick"},(function(e){e&&"right"===e&&!0===t.getState()&&(t.toggleState(),t.getTriptych().togglePanel("right"))})),l.supplementalModeActivated?(this.disable(),this.supplementalModeActivated=!0):this.enable(),c.subscribe({event:"DS/ENXApp/supplementalActivated"},(function(e){e?t.disable():t.enable()}))},_selectionChange:function(){let e=this,t=this.getXSO().get();t=t.filter((function(e){return!("function"==typeof e.getNodeSource&&1===e.getNodeSource())}));let i=new n((function(i){n.all(p).then((function(){let s=[],o=[];t.length&&t.forEach((function(t){if(e.isNodeValid(t)){"r2vsurvey"===e.getServiceId(t)?o.push(e.__r2vsurveyPropModel(t)):o.push(e.__defaultPropNodeModel(t));let n=e._propertiesWdg.controller.getUI()._lFacets;for(let i=0;i<n.length;i++)switch(n[i].facet.name){case"specificationdocuments":case"referencedocuments":"Document"===t.type||!0===e.isInternalJSONObject(t)?n[i].alwaysVisible=!1:n[i].alwaysVisible=!0;break;case"derivedoutputs":!0===e.isInternalJSONObject(t)&&(n[i].alwaysVisible=!1)}}})),n.all(o).then((t=>{if(s=t,e._propertiesWdg.initDatas(s),1===t.length){let t=e.getTriptych()?e.getTriptych()._rightPanel:void 0,n=t?t.getElementsByClassName("triptych-close-right fonticon fonticon-wrong"):[];n.length&&n[0].classList&&n[0].classList.add("displaynone")}})).catch((()=>{console.warn("Cannot retrieve properties model")})),i()}))}));p.push(i)},__defaultPropNodeModel:function(e){const t=this;return new n((n=>{if(t.__facetToSetVisible&&t.__facetToSetVisible.length){let e=this._propertiesWdg.controller.getUI()._lFacets;for(let n=0;n<e.length;n++)-1!==t.__facetToSetVisible.indexOf(e[n].facet.name)&&(e[n].alwaysVisible=!0);delete this.__facetToSetVisible}let i={ID:"",relation:"",type:"",i3dx:"",getID:function(){return this.ID},getRelationID:function(){return this.relation},getType:function(){return this.type},getI3DX:function(){return e.options&&e.options.grid?e.getI3DX():t.getI3DX(e)}};"function"!=typeof e.getID&&(e.getID=function(){return t.getID(this)}),"function"!=typeof e.getRelationID&&(e.getRelationID=function(){return t.getRelationID(this)}),void 0===e.type&&(e.options&&e.options.type?e.type=e.options.type:e.type=t.getType(e)),i.ID=e.getID(),!0===t.isInternalJSONObject(e)?i.relation=void 0:i.relation=e.getRelationID(),i.type=e.type,n(t.EditPropUtils.getModelFromSelectedNode(i))}))},__r2vsurveyPropModel:function(e){return new n(((t,n)=>{require(["DS/PADServices/utils/R2VProperties"],(i=>{this.__facetToSetVisible=[];let s=this._propertiesWdg.controller.getUI()._lFacets;for(let e=0;e<s.length;e++)if("properties"===s[e].facet.name);else!0===s[e].alwaysVisible&&(this.__facetToSetVisible.push(s[e].facet.name),s[e].alwaysVisible=!1);i.getPropModel({objectId:this.getID(e),type:this.getType(e),serviceId:this.getServiceId(e)}).then(t).catch(n)}))}))},_buildView:function(){let t=this;if(t.getTriptych()){let i=t.getTriptych().getRightPanelContainer().querySelector(".rightSidePanel");if(i&&null===i.firstElementChild){let o=new n((function(o){require(["DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/utils/EditPropUtils","DS/EditPropWidget/constants/EditPropConstants"],(function(a,l,c){t.EditPropUtils=l,u=t.EditPropUtils;let p=t._context.getPropertiesFacet();d?t._propertiesWdg=d:(t._propertiesWdg=new a({className:"enxpropertiestab",setEditButton:!t._readOnly,readOnly:t._readOnly,typeOfDisplay:c.ALL,selectionType:c.NO_SELECTION,warningOnUnsaved:!1,multiselection:c.MULTISEL_NO,collapseTabs:!1,context:t._context,appId:"undefined"!=typeof widget&&null!==widget?widget.getValue("appId"):"",actions:[{name:"action_close_panel",text:r.closeProperties,icon:"close",handler:function(){t.setState(!1)}}]}),t._propertiesWdg.removeFacets([c.FACET_VIEWS]),t._propertiesWdg.removeFacets([c.FACET_DERIVEDOUTPUT]),t._context.addEvent("onParentResize",t._propertiesWdg.onResize.bind(t._propertiesWdg)),t._context.addEvent("editModeModified",(function(e){void 0!==t._propertiesWdg.setReadonlyStatus&&t._propertiesWdg.setReadonlyStatus(!e)}))),d=t._propertiesWdg.inject(i),!0===t.getState()&&t._selectionChange();let h=[];for(let i=0;i<p.length;i++){let o=p[i],a=new n((function(i){let a=o;n.all(h).then((function(){if(e.is(a,"string")&&"relations"===a){require(["DS/ENORIPE_Relations/RelationsTabSettings"],(function(n){let o={getPlatformID:function(){return s.getPlatformId()},getServiceID:function(){return"3DSpace"}};n.isAvailable(o,{isDraggable:!0}).then((function(n){e.is(n,"object")&&e.is(n.facetInfo)?(n.facetInfo.options={defaultProfile:"Designer"},n.facetInfo.position=2,t._propertiesWdg.addFacets([n.facetInfo])):console.log("facets info is NOT in good format"),i()}),(function(){console.log("this facet is not available for this context = "+n),i()}))}),(function(e){console.warn("Cannot load "+e.requireModules),i()}))}else if(a.facet){if(a.facet.text||(a.facet.text=r[a.facet.name+"_cmd_title"]),a.actions&&a.actions.length>0)for(let e=0;e<a.actions.length;e++)a.actions[e].text=r[a.facet.name+a.actions[e].text];t._propertiesWdg.addFacets([a]),i()}else i()}))}));h.push(a)}t._propertiesWdg.stopSelection(!t.getState()),o()}))}));p.push(o)}else i&&null!==i.firstElementChild&&i.getElement&&i.getElement(".enxpropertiestab")&&(t._propertiesWdg=d,t._propertiesWdg.options&&t._propertiesWdg.options.actions&&e.is(t._propertiesWdg.options.actions,"array")&&"action_close_panel"===t._propertiesWdg.options.actions[0].name&&(t._propertiesWdg.options.actions[0].handler=function(){t.setState(!1)}),t.EditPropUtils=u);t.onStateChange((function(){t.getTriptych().getRightOpen()&&t.getState()||!t.getTriptych().getRightOpen()&&!t.getState()||(t._propertiesWdg.stopSelection(!t.getState()),!0===t.getState()&&t._selectionChange(),t.getTriptych().togglePanel("right"))})),t.getTriptych()&&t.getTriptych()._modelEvents.subscribe({event:"triptych-hide-panel"},(function(e){e&&"right"===e&&!0===t.getState()&&(t.getTriptych().togglePanel("right"),t.getTriptych().getRightOpen()||t.setState(!1))})),t.getTriptych().getRightOpen()&&t.setState(!0)}else{console.log("Triptych not ready yet. Wait for it to complete the side panel");let e=new n((function(e){t.onTriptychReady(t._buildView.bind(t)),e()}));p.push(e)}},isNodeValid:function(e){return!0},getServiceId:function(e){return"3DSpace"},destroy:function(){this.getXSO().unsubscribe(this._tkAdd),this.getXSO().unsubscribe(this._tkRemove),this.getXSO().unsubscribe(this._tkEmpty)},isInternalJSONObject:function(e){if("function"==typeof e.isInternalJSONObject)return e.isInternalJSONObject()}})})),define("DS/PADUtils/commands/PADUtilsAddRootCmd",["DS/PADUtils/PADContext","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices"],(function(e,t,n){"use strict";function i(e){this._ec=e.executionContext}return i.prototype.beginExecute=function(){require(["DS/PADServices/utils/PADTrackerManager"],(e=>{const t=e.getPADTracker({eventCategory:"usage",eventAction:"command-3D"});t.setEventData({eventLabel:"PADUtilsAddRootCmd"}),t.trackPageEvent()}));for(var i="",s=t.getSetting("authorized_root_types")?t.getSetting("authorized_root_types"):t.getSetting("authorized_types"),o=s.length,a=0;a<o;a++){var r=s[a];i=""===i?i+'type:"'+r+'"':i+' OR type:"'+r+'"'}var l={fts_value:i,callback:t=>{var n=e.get(),i=t.selected_data;n.openDroppedObjects({notifPerObjects:!0,displayNotif:!1,unserializedData:i,broadcast:!0,version:"2.0"}),this.endExecute()},cancel:()=>{this.endExecute()}};n.inAppsSearch(l)},i.prototype.cancelExecute=function(){this.endExecute()},i.prototype.endExecute=function(){this.destroy(),this.done()},i.prototype.destroy=function(){delete this._ec},i})),define("DS/PADUtils/views/PADStatusBar",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Drivers/Alone","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/PADSettingsMgt","DS/UIKIT/Tooltip","DS/Controls/ProgressBar","DS/WebappsUtils/WebappsUtils","DS/PADUtils/PADUtilsServices","DS/ENOXInterWdgCom/LinkManager"],(function(e,t,n,i,s,o,a,r,l,c,d,u){"use strict";return n.extend(i,{name:"pad_status",_tooltipInfo:null,_latestNotification:null,_icons:["filter","change","info","warning","error","widgetLinkSync","sgiActivation","startupView","latestNotification","perfoDebug"],_previousLabel:null,_isPaused:!1,_isFreezed:!1,_widgetLinkPanelOpened:!1,init:function(e){this._parent(e),this._tooltipCBForTouch=function(){this&&this.toggle()},this._onDragEvent=e.onDragEvent;var t=d.isTouchDevice()?" touch-mode":"";this.elements.container=UWA.createElement("div",{class:"pad_status_footer"+t}),this.elements.container.dataset.open=!0,this.elements.footerLeft=new UWA.Element("div",{class:"pad_status_footer_left"}).inject(this.elements.container),this.elements.selectionTextContainer=UWA.createElement("div",{class:"pad_status_footer_selection_text_container"}).inject(this.elements.footerLeft),this.elements.selectionText=UWA.createElement("span",{class:"selection_text"}).inject(this.elements.selectionTextContainer);if(this.elements.selectionText.innerHTML='<span class="fonticon fonticon-select-off"></span>',this._selectionTooltip=new r({target:this.elements.selectionText,position:"top left"}),this._selectionTooltip.setBody(o.PADStatusInfos_noSelection),e.withLoader){this.elements.loaderContainer=UWA.createElement("div",{class:"pad_status_footer_loader_container"}).inject(this.elements.footerLeft),this.elements.loaderFeedbackIcon=UWA.createElement("span",{}).inject(this.elements.loaderContainer);var n=c.getWebappsAssetUrl("PADUtils","icons/32/spinner.gif");this.elements.progressbarContainer=UWA.createElement("div",{class:"pad_status_footer_progress_bar hidden"}).inject(this.elements.loaderContainer),this._progressBar=UWA.createElement("img",{class:"pad_status_footer_progress_loader hidden",src:n}).inject(this.elements.progressbarContainer),this._progressBarTooltip=new r({target:this._progressBar,position:"top left"}),this.elements.progressbarLabel=UWA.createElement("div",{class:"pad_status_footer_progress_label"}).inject(this.elements.loaderContainer),this.elements.progressbarLabel.innerHTML="",this.elements.playPause3DloadingFonticonContainer=UWA.createElement("div",{class:"pad_status_footer_play_button_container",events:{click:function(){this._isFreezed||("play"===this.elements.playPause3DloadingFonticonContainer.status?(e.onPause(),this.pause()):(e.onPlay(),this.resume()))}.bind(this)}}).inject(this.elements.loaderContainer),this.elements.playPause3DloadingFonticon=UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-pause pad_status_font_icon pad_status_fonticon_playPause3Dloading"}).inject(this.elements.playPause3DloadingFonticonContainer),this.elements.playPause3DloadingFonticonContainer.status="play",this._playPause3DloadingFonticonTooltip=new r({target:this.elements.playPause3DloadingFonticonContainer,position:"top left"}),this._playPause3DloadingFonticonTooltip.setBody(o.PADStatusInfos_lock3DLoadingTooltip),d.isTouchDevice()&&this._playPause3DloadingFonticonTooltip.options.target.addEventListener("touchend",this._tooltipCBForTouch.bind(this._playPause3DloadingFonticonTooltip))}this.elements.infoContainer=UWA.createElement("div",{class:"pad_status_footer_right"}).inject(this.elements.container);for(var i=this._icons.length-1;i>=0;--i)switch(this._icons[i]){case"change":this.elements.changeFonticonContainer=UWA.createElement("div",{class:"hidden"+t}).inject(this.elements.infoContainer),this.elements.changeFonticon=UWA.createElement("span",{class:"fonticon fonticon fonticon-change-action-workunder pad_status_font_icon pad_status_fonticon_change empty"}).inject(this.elements.changeFonticonContainer);break;case"info":this.elements.infoFonticonContainer=UWA.createElement("div",{class:"hidden"+t}).inject(this.elements.infoContainer),this.elements.infoFonticon=UWA.createElement("span",{class:"fonticon fonticon-info pad_status_font_icon pad_status_fonticon_info empty"}).inject(this.elements.infoFonticonContainer);break;case"warning":this.elements.warningFonticonContainer=UWA.createElement("div",{class:"hidden"+t}).inject(this.elements.infoContainer),this.elements.warningFonticon=UWA.createElement("span",{class:"fonticon fonticon-attention pad_status_font_icon pad_status_fonticon_warning empty"}).inject(this.elements.warningFonticonContainer);break;case"error":this.elements.errorFonticonContainer=UWA.createElement("div",{class:"hidden"+t}).inject(this.elements.infoContainer),this.elements.errorFonticon=UWA.createElement("span",{class:"fonticon fonticon-alert pad_status_font_icon pad_status_fonticon_error empty"}).inject(this.elements.errorFonticonContainer);break;case"filter":this.elements.filterFonticonContainer=UWA.createElement("div",{class:"hidden"+t}).inject(this.elements.infoContainer),this.elements.filterFonticon=UWA.createElement("span",{class:"fonticon fonticon-filter pad_status_font_icon pad_status_fonticon_filter empty"}).inject(this.elements.filterFonticonContainer);break;case"widgetLinkSync":this.elements.widgetLinkOptionsFonticonContainer=UWA.createElement("div",{class:"status_bar_action widgetLinkOptionsFonticonContainer hidden",events:{click:function(){e.onWidgetLinkOptionsClicked()&&e.onWidgetLinkOptionsClicked()}.bind(this)}}).inject(this.elements.infoContainer),this.elements.widgetLinkSyncFonticon=UWA.createElement("span",{class:"wux-ui-3ds fonticon-link-ok pad_status_font_icon pad_status_fonticon_startupView"}).inject(this.elements.widgetLinkOptionsFonticonContainer),this._widgetLinkSyncFonticonTooltip=new r({target:this.elements.widgetLinkOptionsFonticonContainer,position:"top right"}),this._widgetLinkSyncFonticonTooltip.setBody(o.PADStatusInfos_widgetLinkSync);break;case"startupView":this.elements.startupViewFonticonContainer=UWA.createElement("div",{class:"status_bar_action startupViewFonticonContainer hidden",events:{click:function(){e.onSetStartupViewClicked()&&e.onSetStartupViewClicked()}.bind(this)}}).inject(this.elements.infoContainer),this.elements.startupViewFonticon=UWA.createElement("span",{class:"wux-ui-3ds fonticon-space-rocket pad_status_font_icon pad_status_fonticon_startupView"}).inject(this.elements.startupViewFonticonContainer),this._startupViewFonticonTooltip=new r({target:this.elements.startupViewFonticonContainer,position:"top right"}),this._startupViewFonticonTooltip.setBody(o.PADStatusInfos_startupViewTooltip);break;case"latestNotification":var s=this;this.elements.latestNotificationFonticonContainer=UWA.createElement("div",{class:"hidden"+t}).inject(this.elements.infoContainer),this.elements.latestNotificationFonticon=UWA.createElement("span",{class:"fonticon fonticon-bell-alt pad_status_font_icon pad_status_fonticon_latestNotification empty",events:{click:function(){require(["DS/PADUtils/views/PADAlert"],(function(e){s._latestNotification&&e.displayNotification(s._latestNotification),d.isTouchDevice()&&(s.elements.latestNotificationFonticon.removeClassName("new"),s._latestNotification?s.elements.latestNotificationFonticon.addClassName("old"):s.elements.latestNotificationFonticon.addClassName("empty"))}))}}}).inject(this.elements.latestNotificationFonticonContainer),this._latestNotificationTooltip=new r({target:this.elements.latestNotificationFonticonContainer,position:"top right",events:{onHide:function(){s.elements.latestNotificationFonticon.removeClassName("new"),s._latestNotification?s.elements.latestNotificationFonticon.addClassName("old"):s.elements.latestNotificationFonticon.addClassName("empty")}}}),this._latestNotificationTooltip.setBody(o.PADStatusInfos_showLatestNotification),d.isTouchDevice()&&this._latestNotificationTooltip.options.target.addEventListener("touchend",this._tooltipCBForTouch.bind(this._latestNotificationTooltip));break;case"perfoDebug":if(e.onPerfoClicked&&e.perfoDebug){s=this;this.elements.perfoDebugFonticonContainer=UWA.createElement("div",{class:"pad_status_perfo_icon"+t,styles:"cursor: pointer;"}).inject(this.elements.infoContainer),this.elements.perfoDebugFonticon=UWA.createElement("span",{class:"fonticon fonticon-chart-gauge-angular pad_status_font_icon",events:{click:function(){e.onPerfoClicked()}}}).inject(this.elements.perfoDebugFonticonContainer),this._perfoDebugTooltip=new r({target:this.elements.perfoDebugFonticonContainer,position:"top right"}),this._perfoDebugTooltip.setBody(o.PADStatusInfos_debugPerformance),d.isTouchDevice()&&this._perfoDebugTooltip.options.target.addEventListener("touchend",this._tooltipCBForTouch.bind(this._perfoDebugTooltip))}}this.getOption("renderTo")&&this.inject(this.getOption("renderTo")),this.resetPreviousLabel()},destroy:function(){a.removeEvent("onX3dPlatformId")},setLoader:function(e){e&&"on"===e.status?(this.resetProgressLabel(),this._progressBar&&(this._progressBar.classList.remove("hidden"),this.elements.progressbarContainer&&this.elements.progressbarContainer.classList.contains("hidden")&&this.elements.progressbarContainer.classList.remove("hidden"))):e&&"off"===e.status?(this.resetProgressLabel(),this._progressBar&&(this._progressBar.classList.add("hidden"),this.elements.progressbarContainer&&this.elements.progressbarContainer.classList.add("hidden"))):e&&"show"===e.status?this.elements.progressbarContainer&&!this._progressBar.classList.contains("hidden")&&this.elements.progressbarContainer.classList.remove("hidden"):e&&"hide"===e.status&&this.elements.progressbarContainer&&this.elements.progressbarContainer.classList.add("hidden")},setProgressTooltip:function(e){this._progressBarTooltip&&this._progressBarTooltip.destroy(),this._progressBarTooltip=new r({target:this._progressBar,position:"top left"}),this._progressBarTooltip.setBody(e)},setProgressLabel:function(e){!0===this._isPaused?this._previousLabel=e:(this.elements.progressbarLabel.innerHTML=e,this.elements.progressbarLabel.style.marginLeft="10px")},setCustomProgressLabel:function(e){if(e&&e.label&&e.tooltip&&e.severity){if("warning"===e.severity)this.elements.loaderFeedbackIcon.className="pad_status_loader_fedback fonticon",this.elements.loaderFeedbackIcon.classList.add("fonticon-attention");else this.elements.loaderFeedbackIcon.className="";!0===this._isPaused?(this._previousLabel=UWA.createElement("div",{class:"pad_status_footer_progress_label"}),this._previousLabel=e.label):(this.elements.progressbarLabel.innerHTML="",this.elements.progressbarLabel.innerHTML=e.label,this.elements.progressbarLabel.style.marginLeft="10px"),this._progressLabelTooltip&&this._progressLabelTooltip.destroy(),this._progressLabelTooltip=new r({target:this.elements.loaderFeedbackIcon,position:"left"}),this._progressLabelTooltip.setBody(e.tooltip),d.isTouchDevice()&&this._progressLabelTooltip.options.target.addEventListener("touchend",this._tooltipCBForTouch.bind(this._progressLabelTooltip))}},pauseProgresslabel:function(){this._previousLabel=this.elements.progressbarLabel.innerHTML,this.elements.progressbarLabel.innerHTML=o.PADStatus_loadingPaused,this.elements.progressbarLabel.style.marginLeft="10px"},restorePreviousLabel:function(){this.elements.progressbarLabel.innerHTML=this._previousLabel,""===this._previousLabel&&(this.elements.progressbarLabel.style.marginLeft="0")},resetPreviousLabel:function(){this._previousLabel=""},resetProgressLabel:function(){this.elements.loaderFeedbackIcon.className="",!1===this._isPaused&&(this.elements.progressbarLabel.innerHTML="",this.elements.progressbarLabel.style.marginLeft="0",this._progressLabelTooltip&&(d.isTouchDevice()&&this._progressLabelTooltip.options.target.removeEventListener("touchend",this._tooltipCBForTouch),this._progressLabelTooltip.destroy(),this._progressLabelTooltip=null))},pause:function(){this._isFreezed||(this._isPaused=!0,this.elements.playPause3DloadingFonticonContainer.status="pause",this.elements.playPause3DloadingFonticon.removeClassName("wux-ui-3ds-pause"),this.elements.playPause3DloadingFonticon.addClassName("wux-ui-3ds-play"),this._playPause3DloadingFonticonTooltip.setBody(o.PADStatusInfos_unlock3DLoadingTooltip),this.setLoader({status:"hide"}))},resume:function(){this._isFreezed||(this._isPaused=!1,this.elements.playPause3DloadingFonticonContainer.locked=!1,this.elements.playPause3DloadingFonticonContainer.status="play",this.elements.playPause3DloadingFonticon.removeClassName("wux-ui-3ds-play"),this.elements.playPause3DloadingFonticon.addClassName("wux-ui-3ds-pause"),this._playPause3DloadingFonticonTooltip.setBody(o.PADStatusInfos_lock3DLoadingTooltip),this.setLoader({status:"show"}))},enableProgress:function(){this._isFreezed=!1,this.resume(),this.elements.progressbarLabel.innerHTML="",this.elements.progressbarLabel.style.marginLeft="0",this.elements.playPause3DloadingFonticonContainer.classList.remove("freezed")},disableProgress:function(){this.pause(),this._isFreezed=!0,this._previousLabel="",this.elements.progressbarLabel.innerHTML=o.PADStatus_loadingFreezed,this.elements.progressbarLabel.style.marginLeft="10px",this.elements.playPause3DloadingFonticonContainer.classList.add("freezed")},setError:function(e){if(e&&e.message){this.elements.errorFonticon.addClassName("new"),this._errorTooltip&&(this._errorTooltip.destroy(),this._errorTooltip=null);var t=this;this._errorTooltip=new r({target:this.elements.errorFonticonContainer,position:"top right",events:{onHide:function(){t.elements.errorFonticon.removeClassName("new"),t.elements.errorFonticon.addClassName("old")}}}),this._errorTooltip.setBody(e.message),this.elements.errorFonticonContainer.removeClassName("hidden"),d.isTouchDevice()&&this.elements.errorFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._errorTooltip))}},clearError:function(){this.elements.errorFonticonContainer.addClassName("hidden"),this.elements.errorFonticon.removeClassName("new"),this.elements.errorFonticon.removeClassName("old"),this._errorTooltip&&(this._errorTooltip.destroy(),this._errorTooltip=null,d.isTouchDevice()&&this.elements.errorFonticon.removeEventListener("touchend",this._tooltipCBForTouch))},setWarning:function(e){if(e&&e.message){this.elements.warningFonticon.addClassName("new"),this._warningTooltip&&(this._warningTooltip.destroy(),this._warningTooltip=null);var t=this;this._warningTooltip=new r({target:this.elements.warningFonticonContainer,position:"top right",events:{onHide:function(){t.elements.warningFonticon.removeClassName("new"),t.elements.warningFonticon.addClassName("old")}}}),this._warningTooltip.setBody(e.message),this.elements.warningFonticonContainer.removeClassName("hidden"),d.isTouchDevice()&&this.elements.warningFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._warningTooltip))}},clearWarning:function(){this.elements.warningFonticonContainer.addClassName("hidden"),this.elements.warningFonticon.removeClassName("new"),this.elements.warningFonticon.removeClassName("old"),this._warningTooltip&&(this._warningTooltip.destroy(),this._warningTooltip=null,d.isTouchDevice()&&this.elements.warningFonticon.removeEventListener("touchend",this._tooltipCBForTouch))},setChange:function(e){if(e&&e.message){this.elements.changeFonticon.addClassName("new"),this._changeTooltip&&(this._changeTooltip.destroy(),this._changeTooltip=null);var t=this;this._changeTooltip=new r({target:this.elements.changeFonticonContainer,position:"top right",events:{onHide:function(){t.elements.changeFonticon.removeClassName("new"),t.elements.changeFonticon.addClassName("old")}}}),this._changeTooltip.setBody(e.message),this.elements.changeFonticonContainer.removeClassName("hidden"),d.isTouchDevice()&&this.elements.changeFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._changeTooltip))}},clearChange:function(){this.elements.changeFonticonContainer.addClassName("hidden"),this.elements.changeFonticon.removeClassName("new"),this.elements.changeFonticon.removeClassName("old"),this._changeTooltip&&(this._changeTooltip.destroy(),this._changeTooltip=null,d.isTouchDevice()&&this.elements.changeFonticon.removeEventListener("touchend",this._tooltipCBForTouch))},setSelection:function(e){if(e&&e.length){this.elements.selectionText.innerHTML='<span class="fonticon fonticon-select-on"></span>'+e.length,!0===a.getSetting("padstatusbar_allowSelectionDragging")&&(this.elements.selectionText.classList.add("has-selection"),this.elements.selectionText.parentNode.setAttribute("draggable",!0),this.elements.selectionText.parentNode.addEventListener("dragstart",this._onDragEvent)),this._selectionTooltip&&(this._selectionTooltip.destroy(),this._selectionTooltip=null),this._selectionTooltip=new r({target:this.elements.selectionText,position:"top left"}),this._selectionTooltip.setBody(e.length+o.PADStatusInfos_nbObjectsSelected),d.isTouchDevice()&&this.elements.selectionText.addEventListener("touchend",this._tooltipCBForTouch.bind(this._selectionTooltip))}},clearSelection:function(e){this.elements.selectionText.innerHTML='<span class="fonticon fonticon-select-off"></span>',!0===a.getSetting("padstatusbar_allowSelectionDragging")&&(this.elements.selectionText.classList.remove("has-selection"),this.elements.selectionText.parentNode.removeAttribute("draggable"),this.elements.selectionText.parentNode.removeEventListener("dragstart",this._onDragEvent)),this._selectionTooltip&&(this._selectionTooltip.setBody(o.PADStatusInfos_noSelection),d.isTouchDevice()&&this.elements.selectionText.removeEventListener("touchend",this._tooltipCBForTouch))},setInfo:function(e){if(e&&e.message){this.elements.infoFonticon.addClassName("new"),this._infoTooltip&&(this._infoTooltip.destroy(),this._infoTooltip=null);var t=this;this._infoTooltip=new r({target:this.elements.infoFonticonContainer,position:"top right",events:{onHide:function(){t.elements.infoFonticon.removeClassName("new"),t.elements.infoFonticon.addClassName("old")}}}),this._infoTooltip.setBody(e.message),this.elements.infoFonticonContainer.removeClassName("hidden"),d.isTouchDevice()&&this.elements.infoFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._infoTooltip))}},clearInfo:function(){this.elements.infoFonticonContainer.addClassName("hidden"),this.elements.infoFonticon.removeClassName("old"),this.elements.infoFonticon.removeClassName("new"),this._infoTooltip&&(this._infoTooltip.destroy(),this._infoTooltip=null,d.isTouchDevice()&&this.elements.infoFonticon.removeEventListener("touchend",this._tooltipCBForTouch))},setFilter:function(e){if(e&&e.message){this.elements.filterFonticon.addClassName("new"),this._filterTooltip||(this._filterTooltip=new r({target:this.elements.filterFonticonContainer,position:"top right",events:{onHide:function(){this.elements.filterFonticon.removeClassName("new"),this.elements.filterFonticon.addClassName("old")}.bind(this)}}),this._filterTooltip.elements.body.innerHTML="");for(var t=!1,n=this._filterTooltip.elements.body,i=0;i<n.children.length;++i)n.children[i].id==="statusbar-filter-"+e.id&&(t=!0);if(!1===t){var s=c.getWebappsAssetUrl("ENOPAD3DViewer","icons/32/I_DefineFilter.png"),o='<div id="statusbar-filter-'+e.id+'" class="filter-tooltip"><img src="'+s+'" /><p>'+e.message+"</p></div>";this._filterTooltip.elements.body.innerHTML+=o,this.elements.filterFonticonContainer.removeClassName("hidden"),this.elements.filterFonticonContainer.addEventListener("click",this._tooltipCBForTouch.bind(this._filterTooltip)),d.isTouchDevice()&&this.elements.filterFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._filterTooltip))}}},clearFilter:function(e){var t=function(){this.elements.filterFonticonContainer.addClassName("hidden"),this.elements.filterFonticon.removeClassName("old"),this.elements.filterFonticon.removeClassName("new"),this._filterTooltip&&(this._filterTooltip.destroy(),this._filterTooltip=null,d.isTouchDevice()&&this.elements.filterFonticon.removeEventListener("touchend",this._tooltipCBForTouch))}.bind(this),n=function(e){if(this._filterTooltip){for(var n=this._filterTooltip.elements.body,i=n.children.length-1;i>=0;--i)n.children[i].id==="statusbar-filter-"+e&&n.removeChild(n.children[i]);0===n.children.length&&t()}}.bind(this);if(e&&e.id)n(e.id);else if(e&&e.ids)for(var i=0;i<e.ids.length;++i)n(e.ids[i]);else t()},toggleWidgetLinkOptions:function(e){!0===e?this.elements.widgetLinkOptionsFonticonContainer.removeClassName("hidden"):this.elements.widgetLinkOptionsFonticonContainer.addClassName("hidden")},toggleStartupView:function(e){!0===e?this.elements.startupViewFonticonContainer.removeClassName("hidden"):this.elements.startupViewFonticonContainer.addClassName("hidden")},setStartupView:function(e){if(this.elements.startupViewFonticon){this.elements.startupViewFonticon.addClassName("new"),e.icon=e.icon?e.icon:"";var t=document.createElement("P");t.textContent=e.name;var n=`\n          <div id="statusbar-startupView-${e.id}" class="filter-tooltip">\n            <img src="${e.icon}"/>\n            ${t.textContent}\n          </div>\n        `;setTimeout(function(){this._startupViewFonticonTooltip.setBody(n)}.bind(this),100)}},clearStartupView:function(){this.elements.startupViewFonticon&&(this.elements.startupViewFonticon.removeClassName("new"),this._startupViewFonticonTooltip.setBody(o.PADStatusInfos_startupViewTooltip))},setLatestNotification:function(e){e&&e.notification&&(this.elements.latestNotificationFonticon.addClassName("new"),this._latestNotification=e.notification),this.elements.latestNotificationFonticonContainer.removeClassName("hidden")},clearLatestNotification:function(){this.elements.latestNotificationFonticonContainer.addClassName("hidden"),this.elements.latestNotificationFonticon.removeClassName("new"),this.elements.latestNotificationFonticon.removeClassName("old"),this._latestNotification=null},toggle:function(){"true"===this.elements.container.dataset.open?this.close():this.open()},open:function(){this.elements.container.classList.remove("closed"),this.elements.container.dataset.open=!0,this.elements.container.style.display="block"},close:function(){this.elements.container.classList.add("closed"),this.elements.container.dataset.open=!1,this.elements.container.style.display="none"},setIsPaused:function(e){this._isPaused=e},updateSGIActivationStatus:function(e){!0===e?this.elements.sgiActivation.addClassName("activated"):this.elements.sgiActivation.removeClassName("activated")}})})),define("DS/PADUtils/PADSession",["UWA/Class","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADSettingsMgt","DS/PADUtils/views/PADAlert","DS/CoreEvents/ModelEvents","i18n!DS/PADUtils/assets/nls/PADUtils.json"],(function(e,t,n,i,s,o){"use strict";return e.singleton({_modelEvents:null,_notSilent:!0,_onlyIndex:!1,init:function(){var e=this;function i(t){if("enxscene"!==require("DS/PADUtils/PADSettingsMgt").app_context){if(UWA.is(t.authored,"boolean")){var n=t.authored_reason;!n&&t.authored&&(n=o.PADSession_disabling_index_authoring),e.setAuthoringState(t.authored,n,!1)}if(UWA.is(t.useIndexPreference,"boolean")){var i=t.useIndexPreference_reason;e.setUseIndexPreference(t.useIndexPreference,i,!1)}}}this._modelEvents=new s,n.addEvent("onUseIndexAccleration",function(e){this.setUseIndexPreference(e)}.bind(this)),this._commandProxy=t.create({events:{onAuthored:i,onSessionStateChange:i}}),this._authored=!1,this._useIndexPreference=!0,this._callCounter=0},setUseIndexPreference:function(e,t,n){var i={useIndexPreference:e,useIndexPreference_reason:t};e!==this._useIndexPreference?(this._useIndexPreference=e,!1!==n&&this._commandProxy.sessionStateChange(i),this.publish({event:"useIndexPreferenceModified",data:{useIndexPreference:e}})):!0===n&&this._commandProxy.sessionStateChange(i)},setAuthoringState:function(e,t,s,a){var r=!1;if(UWA.is(e,"boolean")&&e!==this._authored){if(t&&this._notSilent&&!0===this._useIndexPreference){var l=o[t]||t;i.displayNotification({title:l.title?l.title:"",msg:l.msg?l.msg:l,eventID:"primary"})}this._authored=e,r=!0,e&&(this._lastAuthoredTime=Date.now()),this.publish({event:"authoringStateModified",data:{authored:this._authored}})}(r&&void 0===s||!0===s)&&this._commandProxy.authored({authored:this._authored,authored_reason:t,instanceId:a}),n.getSetting("activateAutoSwitchAuthoringToIndex")&&e&&this.publish({event:"applySwitchTimeout",data:{authored:this._authored,useIndexPreference:this._useIndexPreference}})},getLastAuthoredTimeStamp:function(){return this._lastAuthoredTime?this._lastAuthoredTime:NaN},isAuthoring:function(){return this._authored&&!this._onlyIndex},isUsingIndex:function(){return console.warn("The method PADSession.determineAuthoredFlag is clearer than isUsingIndex"),Boolean(this._useIndexPreference&&!(this._authored&&!this._onlyIndex))},determineAuthoredFlag:function(){return!this._useIndexPreference||this._authored&&!this._onlyIndex},softInit:function(e,t){!0===e&&(this._notSilent=!e),!0===t&&(this._onlyIndex=t)},getModelEvents:function(){return this._modelEvents},publish:function(e){this.getModelEvents().publish(e)},subscribe:function(e,t){return this.getModelEvents().subscribe(e,t)},unsubscribe:function(e){this.getModelEvents().unsubscribe(e)},onAuthoringMode:function(e){return this.getModelEvents().subscribe({event:"authoringStateModified"},e)}})})),define("DS/PADUtils/commands/SwitchAuthoringIndex",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","DS/PADUtils/PADContext","DS/CoreEvents/ModelEvents","DS/PADUtils/PADSession","DS/PADUtils/PADSettingsMgt","i18n!DS/PADUtils/assets/nls/PADUtils.json"],(function(e,t,n,i,s,o,a){"use strict";var r=t.extend({_context:null,_triggerFromCmd:!1,init:function(e){this._parent(e,{}),this._context=n.get(),this._sessionCBTokens=[],s.isAuthoring()?!1===this.getState()&&this.setState(!0,!1):!0===this.getState()&&this.setState(!1,!1),!1===o.getSetting("useIndexAccleration")&&"undefined"!=typeof widget&&void 0!==widget.getPreference("useIndexAccleration")?(this.disable(),s.determineAuthoredFlag()&&!1===this.getState()&&s.setAuthoringState(!0)):this.enable();var t=this;this._sessionCBTokens.push(s.subscribe({event:"authoringStateModified"},(function(e){!0===t._triggerFromCmd?t._triggerFromCmd=!1:s.isAuthoring()?!1===t.getState()&&t.setState(!0,!1):!0===t.getState()&&t.setState(!1,!1)}))),this._sessionCBTokens.push(s.subscribe({event:"useIndexPreferenceModified"},(function(e){!0===e.useIndexPreference?(t.enable(),s.setAuthoringState(!1)):(t.disable(),s.setAuthoringState(!0))}))),this.onStateChange((function(){t._triggerFromCmd=!1,t.getState()?r.enableAuthoringIndex():r.disableAuthoringIndex()}))}});return r.enableAuthoringIndex=function(e){s.setAuthoringState(!0,a.PADSession_enabling_authoring_mode),e&&e()},r.disableAuthoringIndex=function(e){s.setAuthoringState(!1,a.PADSession_disabling_authoring_mode),e&&e()},r})),define("DS/PADUtils/views/PADDnDInvite",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/Core/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","UWA/Utils/Client","DS/PADUtils/PADContext","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADWebInWinServices","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSession"],(function(e,t,n,i,s,o,a,r,l,c,d,u){"use strict";return i.extend(s,o,{name:"paddnd_invite",defaultOptions:{mode:"dynamic",invites:{drop:{nls:"drop",icon:"drag-drop"},add_in_context:{nls:"add_in_context",icon:"plus"},add_as_object:{nls:"add_as_object",icon:"plus"},insert:{icon:"plus",nls:"insert"},find:{icon:"search",nls:"find"}},active_invite:"drop",isTouchActivated:!1},init:function(e){switch(this._parent(e),this.options.isTouchActivated=l.getSetting("touchDropInvite")&&a.Features.touchEvents&&!a.Features.pointerEvents,this.options.isTouchActivated&&(this.options.invites.drop={nls:"add_as_object",icon:"touch"}),this.getMode()){case"none":break;case"drop_here":this._createDropHereInvite();break;case"dynamic":this._createDynamicInvite();break;case"inviteWithFilter":void 0===e.filterActive||!0===e.filterActive?this._createDynamicInvite(!0):this._createDynamicInvite(!1);break;default:console.warn("Unknown mode ["+this.getMode()+"]"),this._createDynamicInvite()}},dataTransferDropEffect:function(e){e.dataTransfer&&("copyMove"!==e.dataTransfer.effectAllowed&&"copy"!==e.dataTransfer.effectAllowed||(e.dataTransfer.dropEffect="copy",e.preventDefault()),"copy"!==e.dataTransfer.dropEffect&&"move"!==e.dataTransfer.dropEffect||(e.dataTransfer.dropEffect="copy",e.preventDefault()))},_createDynamicInvite:function(e){var n=this;this.elements.container=UWA.createElement("div",{class:this.getClassNames("_container")});var i=Object.getOwnPropertyNames(this.options.invites);if(this.elements.container.informationDiv=UWA.createElement("div",{class:this.getClassNames("_informationMain"),draggable:!1}),this.elements.container.informationDiv.inject(this.elements.container),this.options.isTouchActivated){this.elements.container.className+=" touch_look",this.elements.container.informationDiv.style.pointerEvents="auto",this.elements.container.informationDiv.addEventListener("touchend",(function(e){if("wafr"===l.getSetting("eno3dviewer_infrastructure_version")){var t=r.get();if(t.getExecutionContext){t.getExecutionContext().getComponent(WAfrStandardComponentKey.HandlerComponent).executeHandler({id:"PADUtilsAddRootCmd",args:{executionContext:t.getExecutionContext()}}).then((()=>{})).catch((e=>{console.error(e.getError())}))}}else require(["DS/ApplicationFrame/CommandsManager"],(function(e){e.getCommand("AddRoot","Default").begin()}))}))}for(var s=0;s<i.length;s++){var o=i[s];this.elements.container[o]=UWA.createElement("div",{class:this.getClassNames("_display "+o),draggable:!1}),UWA.createElement("i",{class:this.getClassNames("_img wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-"+this.options.invites[o].icon)}).inject(this.elements.container[o]),UWA.createElement("h5",{class:this.getClassNames("_txt font-3dsregular "+o),text:t["PADDropInvit_"+this.options.invites[o].nls]}).inject(this.elements.container[o]),this.elements.container[o].inject(this.elements.container.informationDiv),this.options.active_invite!==o&&this.elements.container[o].hide()}if(!0===e){this.elements.container.style.pointerEvents="auto",this.elements.container.addEventListener("dragover",(function(e){return e.dataTransfer.dropEffect="move",e.preventDefault(),e.stopPropagation(),n.dataTransferDropEffect(e),!1}));var a=0;this.elements.container.addEventListener("dragenter",(function(e){require("DS/PADUtils/PADSession").determineAuthoredFlag()?(n.elements.container.removeClassName("withFilterOpen"),n.elements.container.filterDiv.style.display="none"):(e.preventDefault(),e.stopPropagation(),a++,n.elements.container.addClassName("withFilterOpen"),n.elements.container.filterDiv.style.display="block"),n.dataTransferDropEffect(e)})),this.elements.container.addEventListener("dragleave",(function(e){if(!1===require("DS/PADUtils/PADSession").determineAuthoredFlag())return e.preventDefault(),e.stopPropagation(),--a<=0&&(n.elements.container.removeClassName("withFilterOpen"),n.elements.container.filterDiv.style.display="none",a=0),!1})),this.elements.container.addEventListener("drop",(function(e){return a=0,!1===require("DS/PADUtils/PADSession").determineAuthoredFlag()&&(n.elements.container.removeClassName("withFilterOpen"),n.elements.container.filterDiv.style.display="none"),UWA.is(n.options.dropOnInvite,"function")&&(l.setSetting("changeControlDlgOpen",!0),n.options.dropOnInvite(e)),!1})),this.elements.container.filterDiv=UWA.createElement("div",{class:this.getClassNames("_filterMain"),draggable:!1}),this.elements.container.filterDiv.style.display="none",this.elements.container.filterDiv.inject(this.elements.container);o="filter";this.elements.container[o]=UWA.createElement("div",{class:this.getClassNames("_display "+o)}),UWA.createElement("i",{class:this.getClassNames("_img wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-filter")}).inject(this.elements.container[o]),UWA.createElement("h5",{class:this.getClassNames("_txt font-3dsregular "+o),text:t.PADDropInvit_filter}).inject(this.elements.container[o]),this.elements.container[o].inject(this.elements.container.filterDiv);var c=function(e){a=0,this._dropFilterCB(e)}.bind(this);this.elements.container.filterDiv.addEventListener("dragover",(function(e){return e.dataTransfer.dropEffect="move",e.preventDefault(),e.stopPropagation(),n.dataTransferDropEffect(e),!1})),this.elements.container.filterDiv.addEventListener("drop",c)}else UWA.is(n.options.dropOnInvite,"function")&&(this.elements.container.addEventListener("dragover",(function(e){return e.preventDefault(),e.stopPropagation(),n.dataTransferDropEffect(e),!1})),this.elements.container.addEventListener("drop",(function(e){return n.options.dropOnInvite(e),!1})));this.getOption("renderTo")&&this.elements.container.inject(this.getOption("renderTo"))},_dropFilterCB:function(e){e.preventDefault(),e.stopPropagation(),this.elements.container.removeClassName("withFilterOpen"),this.elements.container.filterDiv.style.display="none";var t=r.get();if(e.dataTransfer.files&&e.dataTransfer.files.length>0){var n=t?t.options.model:null;return n&&0===n.getRoots().length?this.show("drop"):this.hide(),!1}let i=!1;t&&t.publish?t.publish({event:"onFilterDropped"}):i=!0;var s=d.deserializeDroppedData(e);return"wafr"!==l.getSetting("eno3dviewer_infrastructure_version")||i?require(["DS/ApplicationFrame/CommandsManager"],function(e){var n=e.getCommand("FilterDropObjects","function"==typeof t.getCommandContext?t.getCommandContext():null);if(n)if(i){let e={isWP:!1,fromProxy:!1,loadWithFilter:!0};n.execute(s,e)}else n.execute(s);else console.error("PADDnDInvite : _dropFilterCB() - The command PAD3DViewerFilterDropObjectsHdr is undefined");this.hide()}.bind(this)):t.loadSource("DS/ENOPAD3DViewer/commands/PAD3DViewerFilterDropObjectsCmd").then((e=>{(new e).execute(s)})).catch((e=>{console.error("PADDnDInvite : _dropFilterCB() - The command PAD3DViewerFilterDropObjectsCmd is undefined")})),!1},_createDropHereInvite:function(){this.elements.container=UWA.createElement("div",{class:this.getClassNames("_drop_here"),draggable:!1}),UWA.createElement("i",{class:this.getClassNames("_img wux-ui-3ds wux-ui-3ds-4x wux-ui-3ds-drag-drop")}).inject(this.elements.container),UWA.createElement("h5",{class:this.getClassNames("_txt drop_here"),text:t.PADDropInvit_drop_here}).inject(this.elements.container),this.getOption("renderTo")&&this.elements.container.inject(this.getOption("renderTo"))},show:function(e){switch(this.getMode()){case"none":break;case"drop_here":"drop"===e?(this.elements.container.show(),this.dispatchEvent("toggleInvite",!0)):"block"===this.elements.container.getStyle("display")&&(this.elements.container.hide(),this.dispatchEvent("toggleInvite",!0));break;default:this.options.active_invite!==e&&(UWA.is(e,"string")?(this.options.active_invite!==e&&""!==this.options.active_invite&&this.elements.container[this.options.active_invite].hide(),this.options.active_invite=e):this.options.active_invite="drop","drop"===this.options.active_invite?this.elements.container.informationDiv.style.pointerEvents="auto":this.elements.container.informationDiv.style.pointerEvents="none",this.elements.container[this.options.active_invite].show(),this.elements.container.show(),this.dispatchEvent("toggleInvite",!0))}},hide:function(e){switch(this.getMode()){case"none":this.options.active_invite="";break;case"drop_here":"block"===this.elements.container.getStyle("display")&&(this.elements.container.hide(),this.dispatchEvent("toggleInvite",!0));break;default:UWA.is(e,"string")?""!==this.options.active_invite&&this.options.active_invite===e&&(this.elements.container[this.options.active_invite].hide(),this.elements.container.hide()):""!==this.options.active_invite&&(this.elements.container[this.options.active_invite].hide(),this.elements.container.hide()),this.options.active_invite="",this.dispatchEvent("toggleInvite",!1)}},getMode:function(){return c.isWebInWinContext()?"none":this.options.mode},isEventInside:function(e){if("none"===this.getMode())return!1;var t,n,i,s,o,a=(n=0,i=0,(t=e).pageX||t.pageY?(n=t.pageX,i=t.pageY):(t.clientX||t.clientY)&&(n=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:n,y:i});if(!this.elements.container.isHidden()){var r=this.elements.container.getBoundingClientRect();if((s=a).y>=(o=r).top&&s.y<=o.bottom&&s.x>=o.left&&s.x<=o.right)return!0}return!1}})})),define("DS/PADUtils/commands/SwitchAuthoringIndexComponent",["DS/PADUtils/PADContext","DS/PADUtils/PADSession","DS/PADUtils/PADSettingsMgt"],(function(e,t,n){"use strict";const i="SwitchAuthoringIndex";return class{constructor(){}setState(e){const t=this.getExecutionContext().getComponent(WAfrStandardComponentKey.HandlerComponent);t.isCheckExecutable(i)&&t.setCheckState({id:i,state:e})}getState(){return this.getExecutionContext().getComponent(WAfrStandardComponentKey.HandlerComponent).getCheckState({id:i})}disable(){this.getExecutionContext().getComponent(WAfrStandardComponentKey.HandlerComponent).disableCheck(i)}enable(){this.getExecutionContext().getComponent(WAfrStandardComponentKey.HandlerComponent).enableCheck(i)}initialize(){this._context=e.get(),this._sessionCBTokens=[],t.isAuthoring()?!1===this.getState()&&this.setState(!0):!0===this.getState()&&this.setState(!1),!1===n.getSetting("useIndexAccleration")&&"undefined"!=typeof widget&&void 0!==widget.getPreference("useIndexAccleration")?(this.disable(),t.determineAuthoredFlag()&&!1===this.getState()&&t.setAuthoringState(!0)):this.enable();var i=this;return this._sessionCBTokens.push(t.subscribe({event:"authoringStateModified"},(function(){!0===i._triggerFromCmd?i._triggerFromCmd=!1:t.isAuthoring()?!1===i.getState()&&i.setState(!0):!0===i.getState()&&i.setState(!1)}))),this._sessionCBTokens.push(t.subscribe({event:"useIndexPreferenceModified"},(function(e){!0===e.useIndexPreference?(i.enable(),t.setAuthoringState(!1)):(i.disable(),t.setAuthoringState(!0))}))),Promise.resolve()}clean(){if(this._sessionCBTokens.length)for(var e=0;e<this._sessionCBTokens.length;e++)t.unsubscribe(this._sessionCBTokens[e]);return this._sessionCBTokens=[],Promise.resolve()}destroy(){return Promise.resolve()}}})),define("DS/PADUtils/views/PADStatusInfos",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Drivers/Alone","DS/Logger/Logger","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/UIKIT/Tooltip","DS/Controls/Loader","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSession"],(function(e,t,n,i,s,o,a,r,l,c,d){"use strict";var u=n.extend(i,{name:"pad_status",_logger:null,_tooltipInfo:null,init:function(e){this._logger=o.getLogger(u),this._logger.log("init"),this._parent(e),e.withProgress?(this.elements.container=UWA.createElement("div",{class:this.getClassNames()+" with_progress"}),this.elements.loaderContainer=UWA.createElement("div",{class:"pad_status_loader_div"}).inject(this.elements.container),this._loader=(new l).inject(this.elements.loaderContainer),this.elements.fonticonInfoContainer=UWA.createElement("div",{class:"pad_status_fonticon_info_div"}).inject(this.elements.container),this.elements.fonticonInfo=UWA.createElement("i",{class:"fonticon fonticon-info pad_status_span"}).inject(this.elements.fonticonInfoContainer),this._tooltipInfo=new r({className:this.getClassNames("_tooltipInfo"),target:this.elements.container,position:"top",trigger:"touch",events:e.events}),this.elements.fonticonAttentionContainer=UWA.createElement("div",{class:"pad_status_fonticon_attention_div"}).inject(this.elements.container),this.elements.fonticonAttention=UWA.createElement("i",{class:"fonticon fonticon-attention pad_status_span"}).inject(this.elements.fonticonAttentionContainer),this._tooltipAttention=new r({className:this.getClassNames("_tooltipAttention"),target:this.elements.fonticonAttention,position:"top left",trigger:"touch",events:e.events}),this.getOption("status")&&this._tooltipInfo.setBody(this.getOption("status")),this.getOption("renderTo")&&this.inject(this.getOption("renderTo")),this.getOption("attention")&&this._tooltipAttention.setBody(this.getOption("attention")),this.showLoader=function(e){if(e){var t=this;this._isloading=!0,t._loadingText=e.nlsTooltip,setTimeout((function(){!0===t._isloading&&t._loader&&(t._loader.on(),t.elements.fonticonInfoContainer.style.display="",t.elements.fonticonAttentionContainer.style.display="none",e.fonticon&&(t._replacedFonticon=e.fonticon,t.elements.fonticonInfo.removeClassName("fonticon-info"),t.elements.fonticonInfo.addClassName(e.fonticon)),t._addLoading(),!1===t._tooltipInfo.isVisible&&t._tooltipInfo.toggle())}),e.timeout?e.timeout:0)}else this._loader&&(this._loader.on(),this.elements.fonticonInfoContainer.style.display="",this.elements.fonticonAttentionContainer.style.display="none")},this.hideLoader=function(e){this._isloading=!1,this._loader&&(this._loader.off(),e&&!0===e.memoryFull&&(this.elements.fonticonAttentionContainer.style.display="",this.elements.fonticonInfoContainer.style.display="none")),!0===this._tooltipInfo.isVisible&&this._tooltipInfo.toggle(),this.elements.fonticonInfo.addClassName("fonticon-info"),this.elements.fonticonInfo.removeClassName(this._replacedFonticon),this._removeLoading()},this.elements.fonticonAttentionContainer.style.display="none"):(this.elements.container=UWA.createElement("span",{class:this.getClassNames()+" fonticon fonticon-info"}),this._tooltipInfo=new r({className:this.getClassNames("_tooltipInfo"),target:this.elements.container,position:"top left",trigger:"touch",events:e.events}),this.getOption("status")&&this._tooltipInfo.setBody(this.getOption("status")),this.getOption("renderTo")&&this.inject(this.getOption("renderTo")))},setStatus:function(e){this._tooltipInfo.setBody(e),this._isloading&&this._addLoading()},_addLoading:function(){var e=this._tooltipInfo.getBody(),t=UWA.createElement("div",{id:"loadingTooltip",text:this._loadingText});null===e.querySelector("loadingTooltip")&&t.inject(e)},_removeLoading:function(){var e=this._tooltipInfo.getBody().querySelector("loadingTooltip");null!==e&&e.remove(e)}});return u.buildStatus=function(e){var t=UWA.createElement("div",{class:"pad_status_msg"});if(e.tree_content){if(!UWA.is(e.tree_content.nbObjectsSelected))throw new Error("Invalid status. Parameter nbObjectsSelected missing");void 0!==e.tree_content.nbObjectsInTree?e.tree_content.nbObjectsInTree>0?(1===e.tree_content.nbObjectsInTree?UWA.createElement("div",{text:a.PADStatusInfos_oneObjectInTree}).inject(t):UWA.createElement("div",{text:e.tree_content.nbObjectsInTree+a.PADStatusInfos_nbObjectsInTree}).inject(t),UWA.createElement("div",{text:e.tree_content.nbObjectsSelected+a.PADStatusInfos_nbObjectsSelected}).inject(t)):UWA.createElement("div",{text:a.PADStatusInfos_noObjectInTree}).inject(t):null!=e.tree_content.nbObjectsSelected?UWA.createElement("div",{text:e.tree_content.nbObjectsSelected+a.PADStatusInfos_nbObjectsSelected}).inject(t):UWA.createElement("div",{text:a.PADStatusInfos_noObjectInTree}).inject(t);var n=d.isAuthoring()?a.PADStatusInfos_authoringModeEnabled:a.PADStatusInfos_authoringModeDisabled;UWA.createElement("div",{text:n,style:"border-top: 1px;"}).inject(t)}var i=c.getTenantsPreference();return e.Tenant&&i.length>1&&UWA.createElement("div",{text:a.PADStatusInfos_Tenant+e.Tenant}).inject(t),t},u})),define("DS/PADUtils/PADTypesMgt",["i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/PADUtils/views/PADAlert"],(function(e,t,n,i){"use strict";var s={},o={authorized_types:[],type_kind:{},type_kind_setting:{},types_hierarchies:{},displayNotification:function(t,n){i.displayNotification({msg:e.replace(e.get("unsupported_type"),{type:t,name:n||""}),eventID:"warning"})},retrieveKind:function(e){var t;for(var n in o.type_kind)if(-1!==o.type_kind[n].indexOf(e)){t=n;break}if(!t){for(var i in o.type_kind_setting)if(-1!==o.type_kind_setting[i].indexOf(e)){t=i,o.type_kind[i]||(o.type_kind[i]=[]),o.type_kind[i].includes(e)||o.type_kind[i].push(e);break}t||(t="Product")}return t}};return s.isTypesAuthorized=function(e,n,i,s,a){var r=[],l=[],c={},d=t.getSetting("authorized_root_types");o.type_kind_setting=t.getSetting("type_kind");var u={},p=!0===s?[]:t.getSetting("unsupported_root_types");p||(p=[]),e.forEach((function(e){if(-1!==o.authorized_types.indexOf(e.type)||-1!==d.indexOf(e.type)){if(r.push(e.type),"2.0"===a){u.supportedTypes||(u.supportedTypes={});var t=o.retrieveKind(e.type);t&&(u.supportedTypes[t]||(u.supportedTypes[t]=[]),u.supportedTypes[t].push(e.type),o.type_kind[t]||(o.type_kind[t]=[]),o.type_kind[t].push(e.type))}}else l.push(e.type),c[e.type]=e.displayType})),console.debug("process unknown_types",l),l.length?require(["DS/PADUtils/PADWSAccess"],(function(e){e.getTypesHierarchy({types:l,onComplete:function(e){var t=!1;(UWA.is(e,"string")?JSON.parse(e):e).types_hierarchies.forEach((function(e){let n=e.type;o.types_hierarchies[n]||(o.types_hierarchies[n]=e.hierarchy,o.types_hierarchies[n].unshift(n));for(var l,h=!1,g=0;g<e.hierarchy.length&&!1===h;g++){let t=e.hierarchy[g];if(-1!==d.indexOf(e.hierarchy[g]))if(-1!==p.indexOf(n))h=!1;else{h=!0,l=t;let e=o.retrieveKind(l);e&&(console.debug(n," add to ",e),o.type_kind[e]||(o.type_kind[e]=[]),o.type_kind[e].includes(n)||o.type_kind[e].push(n))}}if(!0===h){if(!0!==s&&o.authorized_types.push(e.type),r.push(e.type),"2.0"===a){u.supportedTypes||(u.supportedTypes={});var f=o.retrieveKind(l);f&&(u.supportedTypes[f]||(u.supportedTypes[f]=[]),u.supportedTypes[f].includes(e.type)||u.supportedTypes[f].push(e.type),o.type_kind[f]||(o.type_kind[f]=[]),o.type_kind[f].includes(e.typ)||o.type_kind[f].push(e.typ))}}else i&&(o.displayNotification(c[e.type],""),t=!0)})),t&&(u.unsupportedDropNotified=!0),n(r,u)},onFailure:function(e){n(r,u)}})})):n(r,u)},s.retrieveAuthorizedObjects=function(a){var r;r=a.X3DContentId?a.X3DContentId:a.unserializedData?a.unserializedData:n.deserializeDroppedData(a.dnd_event);var l=[],c={authorized_objects:[],unauthorized_objects:[]},d="WITHOUT_CONTEXT";a.dnd_event?d=a.dnd_event.shiftKey?"WITHOUT_CONTEXT":"WITH_CONTEXT":a.behavior&&(d=a.behavior),c.source_data=UWA.clone(r),delete c.source_data.data;var u=void 0===a.displayNotif||a.displayNotif;UWA.is(r.data)&&UWA.is(r.data.items,"array")&&r.data.items.length>0?!0===t.getSetting("accept_all_types")?(console.log("Accept all types"),c.authorized_objects=r.data.items,a.callback(c)):("2.0"===a.version&&(c.authorizedWithKind={}),r.data.items.forEach((function(e){var t=e.objectType;UWA.is(e.objectType_Internal)&&(t=e.objectType_Internal);var n=e.displayType;"WITH_CONTEXT"===d&&e.path&&e.path.length>1&&e.path[0].type&&l.push({type:e.path[0].type,displayType:e.path[0].type}),t&&0!==t.length?-1===l.indexOf(t)&&l.push({type:t,displayType:n}):(console.warn("No type available ==> Object not supported"),c.unauthorized_objects.push(e))})),s.isTypesAuthorized(l,(function(t,n){n&&n.unsupportedDropNotified&&(c.unsupportedDropNotified=!0),r.data.items.forEach((function(n){var s=n.objectType;if(UWA.is(n.objectType_Internal)&&(s=n.objectType_Internal),"WITH_CONTEXT"===d&&n.path&&n.path.length>1&&n.path[0].type&&(-1===t.indexOf(n.path[0].type)?n.path=[{resourceid:n.objectId,type:s}]:s=n.path[0].type),-1!==t.indexOf(s)){if("2.0"===a.version){var r=o.retrieveKind(s);c.authorizedWithKind[r]||(c.authorizedWithKind[r]=[]),c.authorizedWithKind[r].push(n)}c.authorized_objects.push(n)}else c.unauthorized_objects.push(n),!0===a.notifPerObjects&&(i.displayNotification({msg:e.replace(e.get("unsupported_type"),{type:n.displayType,name:n.displayName}),eventID:"warning"}),c.unsupportedDropNotified=!1)})),a.callback(c)}),u,a.isFindInCtx,a.version)):(c.unsupportedDropNotified=!0,a.callback(c))},s.retrieveHierarchy=function(e,t){for(var n={},i=[],s=0;s<e.length;s++)o.types_hierarchies[e[s]]?n[e[s]]=UWA.clone(o.types_hierarchies[e[s]]):i.push(e[s]);i.length>0?require(["DS/PADUtils/PADWSAccess"],(function(e){e.getTypesHierarchy({types:i,onComplete:function(e){(UWA.is(e,"string")?JSON.parse(e):e).types_hierarchies.forEach((function(e){void 0===o.types_hierarchies[e.type]&&(o.types_hierarchies[e.type]=e.hierarchy,o.types_hierarchies[e.type].push(e.type)),n[e.type]=e.hierarchy,n[e.type].push(e.type),t(n)}))},onFailure:function(e){console.warn("Cannot retrieve hierarchy"),i.forEach((function(e){n[e]=[e],t(n)}))}})})):t(n)},s})),define("DS/PADUtils/commands/PADOpenInCADBaseCmd",["DS/ApplicationFrame/Command","DS/PlatformAPI/PlatformAPI","DS/PADUtils/PADWebInWinServices"],(function(e,t,n){"use strict";return e.extend({_context:null,init:function(e){this._parent(e),"undefined"!=typeof widget&&(this._context=widget.getValue("addinmode"))},getSelection:function(e){console.error("This method must be overloaded to give your selection back"),console.error("Data given in input of the callback must respect 'setTypes' schema")},execute:function(){this.getSelection((function(e){UWA.is(e.setObject,"object")?t.publish("webinwin:web:notification",JSON.stringify({operation:"open/setObject",operationVersion:"1.0",content:[{phid:e.setObject.objectId}]})):t.publish("webinwin:web:notification",JSON.stringify({operation:"open/setTypes",operationVersion:"1.0",content:e}))}))},isAvailable:function(){return n.isWebInWinContext()}})})),define("DS/PADUtils/commands/PADOpenInCAD",["text!DS/PADUtils/assets/PADOpenCommandsSettings.json","DS/ApplicationFrame/Command","DS/PADUtils/commands/PADOpenInCADBaseCmd","DS/PADUtils/PADContext","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","require"],(function(e,t,n,i,s,o,a){"use strict";return n.extend({init:function(e){this._parent(e)},getSelection:function(t){var n,r=i.get().getPADTreeDocument().getSelectedNodesForOFW(),l=JSON.parse(e);null==l["openInCAD_"+this._context+"_expand_at_open"]||l["openInCAD_"+this._context+"_expand_at_open"];if(o.isAuthoringCtxAvailable())try{var c=a("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");n=c.get()}catch(e){console.warn("CfgAuthoringContext throw an error")}if("solidworks"!==this._context&&("catiav5"!==this._context||1!==r.length||!r[0].isRoot()||UWA.is(r[0].options.config_filter)||UWA.is(r[0].options.sequence_filter)||UWA.is(n)&&""!==n.change.id||!0!==s.getSetting("directOpenPCS")))a(["DS/ENXNav/utils/OFWRemodel"],(e=>{e.buildDataForWiW({selectedNodes:r,treeDocument:i.get().getPADTreeDocument(),authCtx:n}).then((e=>{t(e)}))}));else{var d={setObject:{objectId:r[0].getID(),envId:o.getPlatformId(),contextId:s.getSetting("pad_security_ctx")}};t(d)}}})})),define("DS/PADUtils/views/PADSearchView",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Class/View","UWA/Drivers/Alone","DS/Logger/Logger","DS/PADUtils/PADCommandProxy","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/Handlebars/Handlebars","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADTypesMgt","DS/PADUtils/PADContext","UWA/Event"],(function(e,t,n,i,s,o,a,r,l,c,d,u){"use strict";var p=n.extend({name:"PADSearchView",_searchTriggered:!1,className:"pad_global_ctn_search",_selected_paths:[],_insertReplaceNode:null,_insertParams:null,domEvents:{"click div.run_ctn_search":"_onSearch","click span.fonticon-check":"_onConfirmSelect","click div.clear_ctn_search":"_onClearSearch","click span.fonticon-up-open":"_onPrevious","click span.fonticon-down-open":"_onNext","keyup input.input_search":"_onSearchInputKeyUp","paste input.input_search":"_onSearchInputPaste","keydown input.input_search":"_onSearchInputKeyDown"},template:null,_logger:null,setup:function(e){var t=this;d.get().getPADTreeDocument()._insertFlag=!0;this._logger=s.getLogger(p),this._logger.log("setup"),!0===e.navigate_onresult?this.template=r.compile('<div class="left_ctn_search ctn_search"></div>    <div class="input_ctn_search ctn_search search_css_temp">        <div class="input_search_div with_nav" id="input_search_div">        <input class="input_search" id="input_search_input" type="text" placeholder="Search" ondrop="event.preventDefault ? event.preventDefault() : event.returnValue = false">        </div>        <div class="pad_count_ctn" id="pad_count_ctn"><div class="pad_count" id="pad_count"></div></div>        <div class="right_search">            <div class="nav_ctn_search ctn_search"><span class="fonticon fonticon-up-open ctn_search pad_nav"  style="display:none;" title="Previous"></span></div>            <div class="nav_ctn_search ctn_search"><span class="fonticon fonticon-down-open ctn_search pad_nav"  style="display:none;" title="Next"></span></div>            <div class="clear_ctn_search ctn_search"><div class="clear_btn_search" style="display:none;"></div></div>            <div class="run_ctn_search ctn_search"><div class="run_btn_search" style="opacity:0.1;"></div></div>            <div class="right_ctn_search ctn_search"></div>        </div>    </div>'):this.template=r.compile('<div class="left_ctn_search ctn_search"></div>    <div class="input_ctn_search ctn_search search_css_temp">        <div class="input_search_div" id="input_search_div">        <input class="input_search" id="input_search_input" type="text" placeholder="Search" ondrop="event.preventDefault ? event.preventDefault() : event.returnValue = false">        </div>        <div class="right_search">            <div class="clear_ctn_search ctn_search"><div class="clear_btn_search" style="display:none;"></div></div>            <div class="nav_ctn_search ctn_search"><span class="fonticon fonticon-check fonticon-1x"  style="opacity:0;"></span></div>            <div class="run_ctn_search ctn_search"><div class="run_btn_search"  style="opacity:0.1;"></div></div>            <div class="right_ctn_search ctn_search"></div>        </div>    </div>'),this._searchTriggered=!1,this._parent(e),this._commandProxy=o.create({events:{onSelect:function(e,n){function i(){t.$clearSearchButton.style.display="inline-block",t.$searchInput.value=t._insertParams["ds6w:label"],t.input_text=t.$searchInput.value,t.$searchButton.style.opacity=1,t.$checkButton.style.opacity=1,d.get().getPADTreeDocument()._insertSelected=!0}if(d.get().getPADTreeDocument()._insertFlag&&!0===d.get().getPADTreeDocument().options.insert_replace&&e.paths[0]){var s=e.paths[0],o=s[s.length-1],r=[];r.push({type:e.attributes[o].type}),c.isTypesAuthorized(r,(function(n){n.length>0&&(t._selected_paths=e.paths[0],t._insertReplaceNode=t._selected_paths[t._selected_paths.length-1],t._insertParams={"ds6w:type":e.attributes[t._insertReplaceNode].type,"ds6w:label":e.attributes[t._insertReplaceNode].label},UWA.is(t._insertParams["ds6w:label"])?i():require(["DS/PADUtils/PADWSAccess"],(function(e){t._insertParams["ds6w:label"]=a.PADProgressBar_loading,i();var n=l.getWebAPI_Options("fetch");e.fetch({enopad_webapis:l.getSetting("enopad_webapis"),data:n,pids:[t._selected_paths[t._selected_paths.length-1]],onComplete:function(e){var n=UWA.is(e,"string")?JSON.parse(e):e;if(n.results&&1===n.results.length){var s,o=n.results[0],a=null,r=o.attributes.length;for(s=0;s<r&&!a;s++)"ds6w:label"===o.attributes[s].name&&(a=o.attributes[s].value);t._insertParams["ds6w:label"]=a,i()}else t._insertParams["ds6w:label"]=null,i()},onFailure:function(){t._insertParams["ds6w:label"]=null,i()}})})))}))}}}})},render:function(){this._logger.log("render");var e=this.template();return this.container.setContent(e),function(e,n,i){var s,o,a;if(!t.is(e,"object"))return e;for(s=0,o=(a=Object.keys(e)).length;s<o;s++)n.call(i,e[a[s]],a[s],e)}({searchInput:"input.input_search",searchButton:"div.run_btn_search",checkButton:"span.fonticon-check",searchOptionButton:".option_ctn_search",clearSearchButton:"div.clear_btn_search",onprevious:"span.fonticon-up-open",onnext:"span.fonticon-down-open",padcount:"div.pad_count"},(function(e,t){this["$"+t]=this.getElement(e)}),this),this.$onprevious&&(this.$onprevious.title=a.PADSearchView_previous),this.$onnext&&(this.$onnext.title=a.PADSearchView_next),this.$clearSearchButton&&(this.$clearSearchButton.title=a.PADSearchView_clear),this.$searchButton&&(this.$searchButton.title=a.PADSearchView_search),this.$checkButton&&(this.$checkButton.title=a.PADSearchView_check),!0===d.get().getPADTreeDocument().options.insert_replace?(this.$searchInput.placeholder=a.PADSearchView_search_select,this.$searchInput.title=a.PADSearchView_search_select):(this.$searchInput.placeholder=a.PADSearchView_search,this.$searchInput.title=a.PADSearchView_search),setTimeout(function(){this.$searchInput.focus()}.bind(this),500),this},setCount:function(e){this.$padcount.setContent(e.index+"/"+e.total),null!==this.$onprevious&&null!==this.$onnext&&(this.$onprevious.setStyle("display","inline-block"),this.$onnext.setStyle("display","inline-block"))},_onConfirmSelect:function(e){var t=this;!0===d.get().getPADTreeDocument()._insertSelected&&(UWA.is(this.options.callbacks.onSearch,"function")&&this.options.callbacks.onSearch.call(null,[{search_value:this.$searchInput.value,resourceid:t._insertReplaceNode,"ds6w:type":t._insertParams["ds6w:type"],"ds6w:type_value":t._insertParams["ds6w:type"],"ds6w:label":t._insertParams["ds6w:label"]}]),d.get().getPADTreeDocument()._insertSelected=!1,d.get().getPADTreeDocument()._insertFlag=!1)},_onSearch:function(e){d.get().getPADTreeDocument()._insertSelected=!1,this._logger.log("_onSearch"),this.$searchInput.blur(),UWA.is(this.options.callbacks.onSearch,"function")&&this.options.callbacks.onSearch.call(null,{search_value:this.$searchInput.value}),d.get().getPADTreeDocument()._insertFlag=!1},_onClearSearch:function(e){this._logger.log("_onClearSearch"),this.$searchInput.value="",this.$clearSearchButton.hide(),this.$checkButton&&this.$checkButton.setStyle("opacity","0"),this.$searchButton.setStyle("opacity","0.1"),this._searchTriggered=!1,null!==this.$onprevious&&null!==this.$onnext&&null!==this.$padcount&&(this.$onprevious.hide(),this.$onnext.hide(),this.$padcount.setContent("")),UWA.is(this.options.callbacks.onClear,"function")&&this.options.callbacks.onClear.call(null)},_onSearchInputKeyUp:function(e){this.$searchInput.value?(this.$searchButton.setStyle("opacity","1"),this.$clearSearchButton.setStyle("display","inline-block"),null!==this.$onprevious&&null!==this.$onnext&&!0===this._searchTriggered&&(this.$onprevious.setStyle("display","inline-block"),this.$onnext.setStyle("display","inline-block"))):(this.$clearSearchButton.hide(),null!==this.$onprevious&&null!==this.$onnext&&null!==this.$padcount&&(this.$onprevious.hide(),this.$onnext.hide(),this.$padcount.setContent("")),this.$searchButton.setStyle("opacity","0.1")),this.$checkButton&&this.input_text!==this.$searchInput.value&&(d.get().getPADTreeDocument()._insertSelected=!1,this.$checkButton.setStyle("opacity","0.2"))},_onSearchInputPaste:function(e){var t=this;setTimeout((function(){t._onSearchInputKeyUp()}),200)},_onPrevious:function(){UWA.is(this.options.callbacks.onPrevious,"function")&&this.options.callbacks.onPrevious.call(null)},_onNext:function(){UWA.is(this.options.callbacks.onNext,"function")&&this.options.callbacks.onNext.call(null)},_onSearchInputKeyDown:function(e){var t=this;"return"!==u.whichKey(e)&&"Enter"!==e.keyIdentifier&&"return"!==e.keyIdentifier||(!0===d.get().getPADTreeDocument()._insertSelected?(UWA.is(this.options.callbacks.onSearch,"function")&&this.options.callbacks.onSearch.call(null,[{search_value:this.$searchInput.value,resourceid:t._insertReplaceNode,"ds6w:type":t._insertParams["ds6w:type"],"ds6w:type_value":t._insertParams["ds6w:type"],"ds6w:label":t._insertParams["ds6w:label"]}]),d.get().getPADTreeDocument()._insertSelected=!1,d.get().getPADTreeDocument()._insertFlag=!1):this._onSearch()),u.stopPropagation(e)}});return p})),define("DS/PADUtils/views/PADModalChooser",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Class","UWA/Class/Options","UWA/Drivers/Alone","DS/Logger/Logger","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/views/PADSearchView","DS/UIKIT/Modal","css!UIKIT/UIKIT.css","DS/PADUtils/PADContext","DS/PADUtils/PADUtilsServices","DS/PADServices/utils/SearchUtils"],(function(e,t,n,i,s,o,a,r,l,c,d,u,p){"use strict";return n.extend(i,{name:"padmodalchooser",_logger:null,_modal:null,options:{},init:function(e){if(this._logger=o.getLogger(r),this._logger.log("init"),this._parent(e),this.setOptions(e),!e.renderTo){var t=document.getElementsByClassName("xnav_component");t&&1===t.length?e.renderTo=t[0]:e.renderTo=document.body}var n=UWA.createElement("div"),i=this,s=new r({callbacks:{onSearch:this._onPADSearch.bind(this)}});if(s.render().inject(n),document.addEventListener("keyup",(function(e){27===e.keyCode&&(i._modal.destroy(),d.get().getPADTreeDocument()._insertFlag=!1)})),this._modal=new l({className:this.name+"_modal",closable:!1,body:n,visible:!0,overlay:!UWA.is(this.getOption("overlay"))||this.getOption("overlay")}),e.position)if(e.position.top&&e.position.left)this._modal.elements.content.setStyle("top",e.position.top),this._modal.elements.content.setStyle("left",e.position.left);else if("above_action_bar"===e.position){var a=e.renderTo.getBoundingClientRect();this._modal.elements.wrapper.setStyle("padding-top","calc("+a.height+"px - 80px)"),this._modal.elements.wrapper.setStyle("padding-left","calc(50% - 135px)")}else this._logger.log("unknown style");this._modal.elements.container.addEventListener("click",(function(e){console.log("view click",e),i._modal.destroy(),d.get().getPADTreeDocument()._insertFlag=!1})),this._modal.elements.content.addEventListener("click",(function(e){return e.preventDefault(),e.stopPropagation(),!1})),this._modal.inject(e.renderTo),s.$searchInput.focus()},close:function(){this._modal.destroy()},_onPADSearch:function(e){this._logger.log("_onPADSearch with "+JSON.stringify(e));var t=this;if(!0===d.get().getPADTreeDocument()._insertSelected)t._modal.destroy(),this.getOption("in_apps_search").in_apps_callback.call(null,e);else if(e.search_value.length){var n,i=this.getOption("in_apps_search");if(!0===this.getOption("retrieveSearchValue")){n=e.search_value,t._modal.destroy();var s=this.getOption("searchValueCallback");UWA.is(s,"function")&&s.call(null,{searchValue:n})}else i&&(n=e.search_value,i.fts_value=n,i.callback=function(e){t._logger.log("In Apps Search callback"),t._modal.destroy(),UWA.is(i.in_apps_callback,"function")&&i.in_apps_callback.call(null,e)},i.cancel=function(){t._logger.log("In Apps Search Cancel callback"),t._modal.destroy()},p.inAppsSearch(i))}else this._logger.log("No search done since no string inside the input"),this._modal.destroy()}})})),define("DS/PADUtils/PADProbes",["UWA/Core","UWA/Class","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/PADServices/utils/PADTrackerManager"],(function(e,t,n,i,s){"use strict";var o=t.singleton({initialize:function(e){},createProbe:function(e,t){var i={end:function(){},dump:function(){}};return this._initialized||(this._isActivated=n.getSetting("probes_activated"),this._initialized=!0),this._isActivated&&(i=new a(e,t)),i},networkprobe:function(e){var t,n,i=e.request_options,o=e.wsName?e.wsName:function(e){var t=e.split("/");if(t.length>5){var n=t[t.length-1],i=t[t.length-1].indexOf("?");return-1!==i&&(n=n.substring(0,i),t[t.length-1]=n),t.slice(4,t.length).join("/")}return 0===t[t.length-1].length?t[t.length-2]:t[t.length-1]}(e.url),a=o,r=this.createProbe("query_"+o,a);return r.txKey=e.txKey,i.onComplete=(t=i.onComplete,function(e){if(r.end(),r.eventName){var n=s.getPADTracker({eventCategory:"usage",eventAction:"query"}),i=r.startTime&&r.finishTime?r.finishTime-r.startTime:void 0;n.setEventData({eventLabel:r.eventName,eventValue:i,txKey:r.txKey}),n.trackPageEvent()}if(UWA.is(t,"function"))return t.apply(this,Array.prototype.slice.call(arguments))}),i.onFailure=(n=i.onFailure,function(e){if(r.end(),r.eventName){var t=s.getPADTracker({eventCategory:"usage",eventAction:"queryFailed"}),i=r.startTime&&r.finishTime?r.finishTime-r.startTime:void 0;t.setEventData({eventLabel:r.eventName,eventValue:i}),t.trackPageEvent()}if(UWA.is(n,"function"))return n.apply(this,Array.prototype.slice.call(arguments))}),i}});function a(e,t){this.id=i.getPCSPrefix()+"_"+e,this.inprogress=!0,this.stamp=window.top.performance.now(),this.beginMark=this.id+"__begin_"+this.stamp,this.endMark=this.id+"__end_"+this.stamp,window.top.performance.mark(this.beginMark),this.startTime=Date.now(),void 0!==t&&(this.eventName=t)}return a.prototype.end=function(){!0===this.inprogress&&(this.inprogress=!1,window.top.performance.mark(this.endMark),this.finishTime=Date.now(),window.top.performance.measure(this.id,this.beginMark,this.endMark))},a.prototype.dump=function(){console.log(window.top.performance.getEntriesByName(this.id))},o})),define("DS/PADUtils/utilsWS/WSUtils",["DS/WAFData/WAFData","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADProbes","DS/PADUtils/Configuration"],(function(e,t,n,i){"use strict";function s(e,t){for(var n=0;n<t.length;n++)-1===e.indexOf(t[n])&&e.push(t[n]);return e}var o={executeRequest:function(i,s,o,a){var r=require("DS/PADUtils/PADSettingsMgt").getSetting("pad_security_ctx");if(UWA.is(r,"string")&&!0!==o&&(s.headers.SecurityContext=r,!0!==a)){var l=t.getUser();l&&l.login&&(s.headers.SecurityToken=l.login+"|"+r+"|preferred")}n.networkprobe({url:i,request_options:s,wsName:s.wsName,txKey:s.txKey});return e.authenticatedRequest(i,s)},completeWebAPIPayload:function(e,t,n){var o=i.getWebAPIOptions(e);if(t=UWA.extend(o.config,t),!0===n.withThumbnail2D&&t.select_file.push("thumbnail_2D"),o.mandatoryAttr)for(var a=Object.getOwnPropertyNames(o.mandatoryAttr),r=0;r<a.length;r++){var l=a[r];if(void 0===t[l])t[l]=o.mandatoryAttr[l];else if(UWA.is(t[l],"array")&&UWA.is(o.mandatoryAttr[l],"array"))for(var c=0;c<o.mandatoryAttr[l].length;c++)-1===t[l].indexOf(o.mandatoryAttr[l][c])&&t[l].push(o.mandatoryAttr[l][c]);else console.warn("##WSUtils: Unknown kind of property to complete")}var d=require("DS/PADServices/utils/AttributesMgtV2").createOutputsRequest(e);return t.select_bo&&(t.select_bo=s(t.select_bo,d.select_object)),t.select_predicate&&(t.select_predicate=s(t.select_predicate,d.select_object)),t.select_rel&&(t.select_rel=s(t.select_rel,d.select_relation)),!0===require("DS/PADUtils/PADSettingsMgt").getSetting("pgpFromServer")&&(t.select_pgp=["Show"],t.select_bo&&-1===t.select_bo.indexOf("bo.PGPShowExtension.V_PGP_Show")&&t.select_bo.push("bo.PGPShowExtension.V_PGP_Show"),t.select_rel&&-1===t.select_rel.indexOf("ro.PGPShowExtension.V_PGP_Show")&&t.select_rel.push("ro.PGPShowExtension.V_PGP_Show"),t.select_predicate&&-1===t.select_predicate.indexOf("bo.PGPShowExtension.V_PGP_Show")&&t.select_predicate.push("bo.PGPShowExtension.V_PGP_Show"),"explore_2D"!==t.intent&&(t.select_pgp=["Show","Color","Opacity"],t.select_bo&&-1===t.select_bo.indexOf("bo.PGPColorExtension.V_PGP_ColorRGB.Asstring")&&t.select_bo.push("bo.PGPColorExtension.V_PGP_ColorRGB.Asstring"),t.select_rel&&-1===t.select_rel.indexOf("ro.PGPColorExtension.V_PGP_ColorRGB.Asstring")&&t.select_rel.push("ro.PGPColorExtension.V_PGP_ColorRGB.Asstring"),t.select_predicate&&-1===t.select_predicate.indexOf("bo.PGPColorExtension.V_PGP_ColorRGB.Asstring")&&t.select_predicate.push("bo.PGPColorExtension.V_PGP_ColorRGB.Asstring"),t.select_bo&&-1===t.select_bo.indexOf("bo.PGPOpacityExtension.V_PGP_Opacity")&&t.select_bo.push("bo.PGPOpacityExtension.V_PGP_Opacity"),t.select_rel&&-1===t.select_rel.indexOf("ro.PGPOpacityExtension.V_PGP_Opacity")&&t.select_rel.push("ro.PGPOpacityExtension.V_PGP_Opacity"),t.select_predicate&&-1===t.select_predicate.indexOf("bo.PGPOpacityExtension.V_PGP_Opacity")&&t.select_predicate.push("bo.PGPOpacityExtension.V_PGP_Opacity"),t.select_bo&&-1===t.select_bo.indexOf("bo.PGPInheritanceExtension.V_PGP_Inheritance")&&t.select_bo.push("bo.PGPInheritanceExtension.V_PGP_Inheritance"),t.select_rel&&-1===t.select_rel.indexOf("ro.PGPInheritanceExtension.V_PGP_Inheritance")&&t.select_rel.push("ro.PGPInheritanceExtension.V_PGP_Inheritance"),t.select_predicate&&-1===t.select_predicate.indexOf("bo.PGPInheritanceExtension.V_PGP_Inheritance")&&t.select_predicate.push("bo.PGPInheritanceExtension.V_PGP_Inheritance"))),t},executeSplittedRequest:function(e,t,n){({pattern:n,max:void 0===n.max?10:n.max,url:e,options:UWA.clone(t,!1),onComplete:t.onComplete,onFailure:t.onFailure,onTimeout:t.onTimeout||t.onFailure,onCancel:t.onCancel||t.onFailure,execute:function(){void 0!==this.pattern.init&&(this.data=this.options.data,this.data=UWA.is(this.data,"string")?JSON.parse(this.data):this.data,this.options.onComplete=function(e,t){var n=(e=UWA.is(e,"string")?JSON.parse(e):e)[this.pattern.init.response.packets];void 0!==n?this.executePackets(n):void 0!==this.onComplete&&this.onComplete(e,t)}.bind(this),UWA.extend(this.data,this.pattern.init.query,!0),this.options.data=JSON.stringify(this.data),o.executeRequest(this.url,UWA.clone(this.options,!1)))},executePackets:function(e){if(this.packets=e,this.pending=0,this.response={},this.stopped=!1,void 0!==this.pattern.init&&void 0!==this.pattern.init.query)for(var t in this.pattern.init.query)delete this.data[t];if(void 0!==this.pattern.packet.query.remove)for(var n=0;n<this.pattern.packet.query.remove.length;n++)delete this.data[this.pattern.packet.query.remove[n]];this.options.onComplete=this.onPacketComplete.bind(this),this.options.onFailure=this.onPacketFailure.bind(this),this.options.onTimeout=this.onPacketTimeout.bind(this),this.options.onCancel=this.onPacketCancel.bind(this),this.executePacket()},executePacket:function(){for(;this.pending<this.max&&void 0!==this.packets&&this.packets.length>0;)this.data[this.pattern.packet.query.packet]=this.packets.shift(),this.options.data=JSON.stringify(this.data),this.pending++,o.executeRequest(this.url,UWA.clone(this.options,!1))},onPacketCancel:function(e){this.stopped||(this.stopped=!0,void 0!==this.onCancel&&this.onCancel(e))},onPacketTimeout:function(e){this.stopped||(this.stopped=!0,void 0!==this.onTimeout&&this.onTimeout(e))},onPacketFailure:function(e){this.stopped||(this.stopped=!0,void 0!==this.onFailure&&this.onFailure(e))},onPacketComplete:function(e,t){if(this.pending--,!this.stopped){e=UWA.is(e,"string")?JSON.parse(e):e;var n=this.pattern.packet.response.concat;if(void 0!==n)for(var i=0;i<n.length;i++){this.response[n[i]]=this.response[n[i]]||[];var s=this.updateResponsePacket(e[n[i]]);this.response[n[i]]=this.response[n[i]].concat(s)}var o=this.pattern.packet.response.copy;if(void 0!==o)for(var a=0;a<o.length;a++)"full_path"!==o[a]||!1!==this.response[o[a]]&&!1!==e[o[a]]?this.response[o[a]]=e[o[a]]:this.response[o[a]]=!1;0===this.packets.length&&0===this.pending?void 0!==this.onComplete&&this.onComplete(this.response,t):this.executePacket()}},updateResponsePacket:function(e){for(var t=[],n=Date.now(),i=0;i<e.length;i++){var s=e[i],o=0;if(s.attributes){for(o=0;o<s.attributes.length;o++)"did"===s.attributes[o].name&&(s.attributes[o].value=n+"-"+s.attributes[o].value)}else if(s.path)for(o=0;o<s.path.length;o++)s.path[o]=n+"-"+s.path[o];else if(s.pgp_overload){var a=Object.getOwnPropertyNames(s.pgp_overload);for(o=0;o<a.length;o++){for(var r=a[o].split(","),l=0;l<r.length;l++)r[l]=n+"-"+r[l];s.pgp_overload[r.toString()]=s.pgp_overload[a[o]],delete s.pgp_overload[a[o]]}}t.push(s)}return t}}).execute()},MassChunkedRequests:function(e){var t,n,i,s,o=e.chunkSize||30,a=[],r=0,l=0,c=0,d=!1,u=this;this.process=function(){if(r!==s&&"function"==typeof e.cbOnProcess){var t=n.slice(l,l+o);e.cbOnProcess(u,t)}},this.reprocess=function(){if(!d&&"function"==typeof e.cbOnProcess){var t=n.slice(l,l+o);e.cbOnProcess(u,t)}},this.setAnswer=function(n,p){if(!d){if(r++,t?i.push({request:n,answer:p}):i[n]=p,a.push(p),"function"==typeof e.cbOnProgress){var h=r/s;e.cbOnProgress(u,h,n)}r>c&&(l=c+1,(c+=o)>=s&&(c=s-1),this.process()),r>=s&&"function"==typeof e.cbOnComplete&&(e.cbOnComplete(u),d=!0)}},this.getAnswer=function(e){if(void 0!==t){if(!t)return i[e];for(var n=JSON.stringify(e),s=0,o=i.length;s<o;s++){if(n===JSON.stringify(i[s].request))return i[s].answer}}},this.getAnswers=function(){if(void 0!==t)return{results:a}},this.cancel=function(){d=!0,"function"==typeof e.cbOnComplete&&e.cbOnComplete(u),e.cbOnCancel&&"function"==typeof e.cbOnCancel&&e.cbOnCancel(u)},this.start=function(){if(void 0!==e.requests&&Array.isArray(e.requests)&&(s=e.requests.length)>0&&("string"==typeof e.requests[0]?(t=!1,i={},n=e.requests.filter((function(e,t,n){return n.indexOf(e)==t})),s=n.length):"object"==typeof e.requests[0]&&(t=!0,i=[],n=e.requests),void 0!==t))return l=0,(c=o-1)>=s&&(c=s-1),void this.process();"function"==typeof e.cbOnComplete&&e.cbOnComplete(u)},this.start()},MassChunkedRequestsLWC:function(e){var t,n,i,s,o=e.chunkSize||30,a=[],r=[],l=0,c=!1,d=this;this.process=function(){if(r.length!==s&&"function"==typeof e.cbOnProcess){var t=n.slice(l,l+o);e.cbOnProcess(d,t)}},this.reprocess=function(){if(!c&&"function"==typeof e.cbOnProcess){var t=n.slice(l,l+o);e.cbOnProcess(d,t)}},this.setAnswer=function(n,o){if(!c){var l;if(t?i.push({request:n,answer:o}):i[n]=o,o.path&&(l=o.path.join("_"),r.push(l)),a.push(o),"function"==typeof e.cbOnProgress){var u=r.length/s;e.cbOnProgress(d,u,n)}r.length===s&&"function"==typeof e.cbOnComplete&&(e.cbOnComplete(d),c=!0)}},this.setAnswers=function(t,n){if(a=n,r=t,"function"==typeof e.cbOnProgress){var i=r.length/s;e.cbOnProgress(d,i,t)}"function"==typeof e.cbOnComplete&&(e.cbOnComplete(d),c=!0)},this.getAnswer=function(e){if(void 0!==t){if(!t)return i[e];for(var n=JSON.stringify(e),s=0,o=i.length;s<o;s++){if(n===JSON.stringify(i[s].request))return i[s].answer}}},this.getAnswers=function(){if(void 0!==t)return{results:a}},this.cancel=function(){c=!0,"function"==typeof e.cbOnComplete&&e.cbOnComplete(d),e.cbOnCancel&&"function"==typeof e.cbOnCancel&&e.cbOnCancel(d)},this.start=function(){if(void 0!==e.requests&&Array.isArray(e.requests)&&(s=e.requests.length)>0&&("string"==typeof e.requests[0]?(t=!1,i={},n=e.requests.filter((function(e,t,n){return n.indexOf(e)==t})),s=n.length):"object"==typeof e.requests[0]&&(t=!0,i=[],n=e.requests),void 0!==t))return l=0,o-1>=s&&s-1,void this.process();"function"==typeof e.cbOnComplete&&e.cbOnComplete(d)},this.start()}};return o})),define("DS/PADUtils/utilsWS/PADLWCAccess",["UWA/Core","DS/PADUtils/PADSession","DS/PADUtils/PADUtilsServices","DS/PADUtils/utilsWS/WSUtils"],(function(e,t,n,i){"use strict";var s={url:"/resources/enopad/lwc/fetch",verb:"POST"},o={url:"/resources/enopad/lwc/expand",verb:"POST"},a={url:"/resources/enopad/lwc/refresh",verb:"POST"};return{fetch:function(e){var o,a=e,r=require("DS/PADUtils/PADSettingsMgt");r.getSetting("pad_security_ctx")&&r.getSetting("pad_security_ctx");if(!UWA.is(a,"object"))throw new Error("Invalid inputs for PADLWCAccess.fetch");a.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":r.getSetting("lang")},a.timeout||(a.timeout=r.getSetting("webapi_timeout"));var l=s,c=void 0!==a.data.authored?a.data.authored:t.determineAuthoredFlag();a.method=l.verb,o=n.get3DSpaceUrl()+l.url+"?tenant="+n.getPlatformId();var d=[];a.pids.forEach((function(e){UWA.is(e,"array")&&e.length>1?d.push(e[e.length-1]):d.push(e)}));var u={label:n.getRequestLabel(),query:"physicalid:"+d.join(" OR physicalid:"),intent:a.data.intent,nresults:a.pids.length,tenant:n.getPlatformId(),authored:c,select_file:a.data.select_file,fcs_url_mode:void 0!==a.data.fcs_url_mode?a.data.fcs_url_mode:void 0};return void 0===u.include_param_Attributes&&r.getSetting("readsettingsv2")&&(u.include_param_Attributes=!0),!0===r.getSetting("pgpFromServer")&&(u.select_pgp=["Show"],!0===r.getSetting("pgpColorFromServer")&&(u.select_pgp=["Show","Color","Opacity"])),a.data=JSON.stringify(u),a.onTimeout=a.onTimeout||a.onFailure,i.executeRequest(o,a)},expand:function(e){var s,a=e,r=require("DS/PADUtils/PADSettingsMgt");r.getSetting("pad_security_ctx")&&r.getSetting("pad_security_ctx");if(!UWA.is(a,"object"))throw new Error("Invalid inputs for PADLWCAccess.fetch");a.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":r.getSetting("lang")},a.timeout||(a.timeout=r.getSetting("webapi_timeout"));var l=o;void 0!==a.data.authored?a.data.authored:t.determineAuthoredFlag();if(a.method=l.verb,s=n.get3DSpaceUrl()+l.url+"?tenant="+n.getPlatformId(),r.getSetting("readsettingsv2")&&(a.data.include_param_Attributes=!0),!UWA.is(a.data.roots)&&UWA.is(a.data.root_physicalid)?a.data.roots=[{id:a.data.root_physicalid}]:!UWA.is(a.data.paths)&&UWA.is(a.data.root_path_physicalid)&&(a.data.paths=a.data.root_path_physicalid),UWA.is(a.data.level)||(a.data.level=a.data.expand_iter),UWA.is(a.data.intent)||(a.data.intent="explore_2D"),UWA.is(a.data.source)||(a.data.source="cstorage"),UWA.is(a.data.authored)||UWA.is(a.data.find_path_filter)||(a.data.authored=void 0!==a.data.authored?a.data.authored:t.determineAuthoredFlag()),a.data.label=n.getRequestLabel(),!0===r.getSetting("pgpFromServer")&&(a.data.select_pgp=["Show"],!0===r.getSetting("pgpColorFromServer")&&(a.data.select_pgp=["Show","Color","Opacity"])),delete a.data.root_physicalid,delete a.data.expand_iter,delete a.data.enopad_webapis,delete a.data.select_bo,delete a.data.select_rel,delete a.data.select_ds6w_facet,!UWA.is(a.data.roots)&&!UWA.is(a.data.paths))throw new Error("## PADWSv1.navigate: Invalid inputs: no root_physical_id or no root_path_physicalid found");return a.onTimeout=a.onTimeout||a.onFailure,a.data=JSON.stringify(a.data),i.executeRequest(s,a)},refresh:function(e){var s=require("DS/PADUtils/PADSettingsMgt"),o=a,r=n.get3DSpaceUrl()+o.url+"?tenant="+n.getPlatformId();if(!UWA.is(r)||!UWA.is(e,"object"))throw new Error("## PADWSv1.refresh: Invalid inputs");if(!UWA.is(e.data,"object"))throw new Error("## PADWSv1.refresh: Invalid inputs - options.data not found");e.method=o.verb,e.headers={Accept:"application/json","Content-Type":"application/json"},UWA.is(e.data.intent)||(e.data.intent="explore_2D"),UWA.is(e.data.source)||(e.data.source="cstorage"),s.getSetting("readsettingsv2")&&(e.data.include_param_Attributes=!0),e.data.authored=e.data.authored?e.data.authored:!t.isUsingIndex(),e.data.label=n.getRequestLabel(),!0===s.getSetting("pgpFromServer")&&(e.data.select_pgp=["Show"],!0===s.getSetting("pgpColorFromServer")&&(e.data.select_pgp=["Show","Color","Opacity"])),e.onTimeout=e.onTimeout||e.onFailure,e.data=JSON.stringify(e.data),i.executeSplittedRequest(r,e,{max:1,init:{query:{split:!0},response:{packets:"packets"}},packet:{query:{packet:"packet",remove:[]},response:{concat:["results"],copy:["full_path"]}}})}}})),define("DS/PADUtils/utilsWS/WS4DECModel",["DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSession"],(function(e,t,n){"use strict";var i={modify:{url:"/resources/enopad/authoring/modify",verb:"POST"},insertexisting:{url:"/resources/enopad/authoring/insertexisting",verb:"POST"},replace:{url:"/resources/enopad/authoring/replace",verb:"POST"},reorder:{url:"/resources/enopad/authoring/reorder",verb:"POST"},reparent:{url:"/resources/enopad/authoring/reparent",verb:"POST"},unparent:{url:"/resources/enopad/authoring/unparent",verb:"POST"},deleteinstance:{url:"/resources/enopad/authoring/deleteinstance",verb:"POST"},composite:{url:"/resources/enopad/authoring/composite",verb:"POST"},editability:{url:"/resources/enopad/navigate/editability",verb:"POST"},navigate:{url:"/resources/enopad/navigate/navigate",verb:"POST"},completeselection:{url:"/resources/enov5ma/productstructure/completeselection",verb:"POST"}},s=function(n,s){var o=require("DS/PADUtils/PADSettingsMgt"),a=i[s],r=UWA.clone(n,!1);r.method=a.verb,r.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":o.getSetting("lang")},"object"==typeof r.data&&(r.data=JSON.stringify(r.data));var l=t.get3DSpaceUrl()+a.url+"?tenant="+t.getPlatformId();return console.group(),console.error("======================================="),console.error("=== DEPRECATED USAGE OF THIS WEBAPI ==="),console.error("===    ["+s+"]    ==="),console.error("======================================="),console.groupEnd(),e.executeRequest(l,r)};return{modify:function(n){if(!UWA.is(n,"object"))throw new Error("No parameter defined");if(!UWA.is(n.data,"array"))throw new Error("No input data defined");if(!UWA.is(n.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(n.onFailure,"function"))throw new Error("No onFailure callback function defined");var s={nodes:n.data,commit:!0},o=i.modify,a=t.get3DSpaceUrl();a=a+o.url+"?tenant="+t.getPlatformId();var r={};return r.method=o.verb,r.headers={Accept:"application/json","Content-Type":"application/json"},r.data=JSON.stringify(s),r.onComplete=n.onComplete,r.onFailure=n.onFailure,r.onTimeout=n.onTimeout||n.onFailure,console.group(),console.error("======================================="),console.error("=== DEPRECATED USAGE OF THIS WEBAPI ==="),console.error("===           [modify]              ==="),console.error("======================================="),console.groupEnd(),e.executeRequest(a,r)},insertExisting:function(e){s(e,"insertexisting")},replace:function(e){s(e,"replace")},reorder:function(e){s(e,"reorder")},reParent:function(e){s(e,"reparent")},detach:function(e){s(e,"unparent")},deleteInstance:function(e){s(e,"deleteinstance")},composite:function(e){s(e,"composite")},getEditability:function(s){if(!UWA.is(s,"object"))throw new Error("No options defined");if(!UWA.is(s.data,"object"))throw new Error("No data defined");if(!UWA.is(s.data.ids,"array"))throw new Error("No physicalids defined");if(!UWA.is(s.data.intent,"string"))throw new Error("No intent defined");if(!UWA.is(s.data.name,"array"))throw new Error("No criteria defined");if(!UWA.is(s.data.authored,"boolean"))throw new Error("No authored defined");if(!UWA.is(s.data.lang,"string"))throw new Error("No language defined");if(!UWA.is(s.onComplete,"function"))throw new Error("No onComplete defined");if(!UWA.is(s.onFailure,"function"))throw new Error("No onFailure defined");var o=i.editability,a=t.get3DSpaceUrl()+o.url+"?tenant="+t.getPlatformId();return s.method=o.verb,s.headers={Accept:"application/json","Content-Type":"application/json"},"move"===s.data.name[0]&&"explore_3D"===s.data.intent&&(s.data.rel_physicalid=s.data.ids,delete s.data.ids),UWA.is(s.data.source)||(s.data.source="cstorage"),s.data.authored=s.data.authored?s.data.authored:!n.isUsingIndex(),s.onTimeout=s.onTimeout||s.onFailure,s.data=JSON.stringify(s.data),console.group(),console.error("======================================="),console.error("=== DEPRECATED USAGE OF THIS WEBAPI ==="),console.error("===        [getEditability]         ==="),console.error("======================================="),console.groupEnd(),e.executeRequest(a,s)},navigateOnLinks:function(s){if(!UWA.is(s,"object"))throw new Error("No options defined");if(!UWA.is(s.data,"object"))throw new Error("No data defined");if(!UWA.is(s.data.intent,"string"))throw new Error("No intent defined");if(!UWA.is(s.data.authored,"boolean"))throw new Error("No authored defined");if(!UWA.is(s.data.nav_pattern,"array"))throw new Error("No nav_pattern defined");if(!UWA.is(s.data.nav_pattern[0].name,"string"))throw new Error("No criteria defined");if(!UWA.is(s.data.nav_pattern[0].direction,"string"))throw new Error("No direction defined");if(!UWA.is(s.data.nav_pattern[0].physicalid,"array"))throw new Error("No ids defined");if(!UWA.is(s.onComplete,"function"))throw new Error("No onComplete defined");if(!UWA.is(s.onFailure,"function"))throw new Error("No onFailure defined");var o=i.navigate,a=t.get3DSpaceUrl()+o.url+"?tenant="+t.getPlatformId();if(!UWA.is(a))throw new Error("Invalid inputs for PADWSAccess.navigateOnLinks");return s.method=o.verb,s.headers={Accept:"application/json","Content-Type":"application/json"},UWA.is(s.data.source)||(s.data.source="cstorage"),s.data.authored=s.data.authored?s.data.authored:!n.isUsingIndex(),s.onTimeout=s.onTimeout||s.onFailure,s.data=JSON.stringify(s.data),console.group(),console.error("======================================="),console.error("=== DEPRECATED USAGE OF THIS WEBAPI ==="),console.error("===        [navigateOnLinks]        ==="),console.error("======================================="),console.groupEnd(),e.executeRequest(a,s)},completeselection:function(n){var s=i.completeselection,o=t.get3DSpaceUrl()+s.url+"?tenant="+t.getPlatformId();return n.method=s.verb,n.headers={Accept:"application/json","Content-Type":"application/json"},n.onTimeout=n.onTimeout||n.onFailure,n.data=JSON.stringify(n.data),console.group(),console.error("======================================="),console.error("=== DEPRECATED USAGE OF THIS WEBAPI ==="),console.error("===       [completeselection]       ==="),console.error("======================================="),console.groupEnd(),e.executeRequest(o,n)}}})),define("DS/PADUtils/utilsWS/WSMiscellaneous",["DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices","require"],(function(e,t,n){"use strict";var i={url:"/resources/enopad/navigate/getstreamurl",verb:"POST"},s={url:"/resources/v1/collabServices/attributes/op/read",verb:"POST"},o={url:"/resources/v1/collabServices/attributes/op/update",verb:"PUT"},a={url:"/resources/enopad/getfcsurls",verb:"POST"},r={url:"/resources/SNAPI/pq_services/pqs",verb:"GET"},l={url:"/resources/FilterBIAPI/Filter/getFiltersFromIds",verb:"POST"};return{getFcsUrls:function(n){var i=require("DS/PADUtils/PADSettingsMgt"),s=i.getSetting("pad_security_ctx")?i.getSetting("pad_security_ctx"):"preferred";s=encodeURIComponent(s);var o=t.get3DSpaceUrl()+a.url+"?SecurityContext="+s+"&tenant="+t.getPlatformId(),r=n;return r.method=a.verb,r.headers={Accept:"application/json","Content-Type":"application/json"},r.data=JSON.stringify(r.data),e.executeRequest(o,r)},getDownloadUrl:function(n){var s=t.get3DSpaceUrl()+i.url+"?tenant="+t.getPlatformId(),o=n;return o.method=i.verb,o.headers={Accept:"application/json","Content-Type":"application/json"},o.data=JSON.stringify(o.data),e.executeRequest(s,o)},read:function(i){var o,a=i,r=t.get3DSpaceUrl()+s.url+"?tenant="+t.getPlatformId();if(a.method=s.verb,t.isAuthoringCtxAvailable())try{o=n("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext").get()}catch(e){console.warn("CfgAuthoringContext throw an error")}return a.headers={Accept:"application/json","Content-Type":"application/json"},o&&""!==o.change.id&&(a.headers["DS-Change-Authoring-Context"]="pid:"+o.change.id),o&&null!==o.AuthoringContextHeader&&UWA.extend(a.headers,o.AuthoringContextHeader),a.cache=-1,delete a.ids,a.onTimeout=a.onTimeout||a.onFailure,a.data=JSON.stringify(a.data),e.executeRequest(r,a)},update:function(i){var s,a=i,r=t.get3DSpaceUrl()+o.url+"?tenant="+t.getPlatformId();if(a.method=o.verb,t.isAuthoringCtxAvailable())try{s=n("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext").get()}catch(e){console.warn("CfgAuthoringContext throw an error")}return a.headers={Accept:"application/json","Content-Type":"application/json"},s&&""!==s.change.id&&(a.headers["DS-Change-Authoring-Context"]="pid:"+s.change.id),s&&null!==s.AuthoringContextHeader&&UWA.extend(a.headers,s.AuthoringContextHeader),a.cache=-1,a.onTimeout=a.onTimeout||a.onFailure,a.data=JSON.stringify(a.data),e.executeRequest(r,a)},retrievePQ:function(n){var i=require("DS/PADUtils/PADSettingsMgt"),s=n,o=t.get3DSpaceUrl()+r.url+"?tenant="+t.getPlatformId();return s.method=r.verb,s.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":i.getSetting("lang")},s.cache=-1,s.onTimeout=s.onTimeout||s.onFailure,e.executeRequest(o,s,!1,!0)},getFiltersFromIds:function(n){var i=n,s=t.get3DSpaceUrl()+l.url+"?tenant="+t.getPlatformId();return i.method=l.verb,i.headers={Accept:"application/json","Content-Type":"application/json"},i.cache=-1,i.onTimeout=i.onTimeout||i.onFailure,i.data=JSON.stringify(n.data),e.executeRequest(s,i,!0,!0)}}})),define("DS/PADUtils/utilsWS/CVServletServices",["UWA/Core","DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices","DS/PADServices/settings/AppSettings","DS/PADServices/utils/SGIUtils"],(function(e,t,n,i,s){"use strict";var o={fetch:{url:"/cvservlet/fetch/v2",verb:"POST"},expand3D:{url:"/cvservlet/expand3d",verb:"POST"},expandv2:{url:"/cvservlet/progressiveexpand/v2",verb:"POST"},progressiveExpand:{url:"/cvservlet/progressiveexpand",verb:"POST"},search:{url:"/search",verb:"POST"},searchv2:{url:"/cvservlet/progressiveexpand/v2",verb:"POST"},indexingdate:{url:"/cvservlet/indexingdate",verb:"POST"}},a=function(e,t){e.push("show"),e.push("hide"),e.push("color"),e.push("opacity"),t.select_bo.push("bo.PGPShowExtension.V_PGP_Show"),t.select_bo.push("bo.PGPColorExtension.V_PGP_ColorRGB.Asstring"),t.select_bo.push("bo.PGPOpacityExtension.V_PGP_Opacity"),t.select_bo.push("bo.PGPInheritanceExtension.V_PGP_Inheritance"),t.select_rel.push("ro.PGPShowExtension.V_PGP_Show"),t.select_rel.push("ro.PGPColorExtension.V_PGP_ColorRGB.Asstring"),t.select_rel.push("ro.PGPOpacityExtension.V_PGP_Opacity"),t.select_rel.push("ro.PGPInheritanceExtension.V_PGP_Inheritance")};return{_logger:{nbCalls:0,inputDataSize:[],outputDataSize:[],inputDataSizeLog:[],outputDataSizeLog:[]},fetch:function(i){let a=require("DS/PADUtils/PADSettingsMgt"),r=a.getSetting("pad_security_ctx")?a.getSetting("pad_security_ctx"):"preferred",l="";s.isSGIEnv()&&(l=s.getAdditionalParameters(i.pids));let c=n.get3DSpaceUrl()+o.fetch.url+"?SecurityContext="+r+"&tenant="+n.getPlatformId()+l,d=i.data;delete i.data;let u=e.extend({method:o.fetch.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":a.getSetting("lang")},timeout:i.timeout?i.timeout:a.getSetting("webapi_timeout")},i),p=e.extend({label:n.getRequestLabel(),physicalid:i.pids,locale:a.getSetting("lang"),tenant:n.getPlatformId(),shatteredFetch:!!s.isSGIEnv()||void 0},d);return!0!==i.noCompletion&&(p="fetch_3D"===p.intent?t.completeWebAPIPayload("fetch3d",p,i):t.completeWebAPIPayload("fetch2d",p,i)),delete u.pids,delete u.enopad_webapis,delete p.intent,delete p.authored,p.select_predicate&&(p.select_predicate=p.select_predicate.filter((function(e,t,n){return n.indexOf(e)===t}))),u.data=JSON.stringify(p),u.onTimeout=u.onTimeout||u.onFailure,t.executeRequest(c,u)},refresh:function(e){e.data.expand_iter||(e.data.expand_iter="1"),delete e.data.session;for(var t=[],n=[],i=0;i<e.data.root_path_physicalid.length;i++){var s=e.data.root_path_physicalid[i];s.length>1&&(s=s.slice(0,-2));var o=JSON.stringify(s);-1===n.indexOf(o)&&(t.push(s),n.push(o))}e.data.root_path_physicalid=t,this.expand(e)},expand:function(){console.error("Invalid call to PADWSAccess.expand")},expand3d:function(i){var s=require("DS/PADUtils/PADSettingsMgt"),a=s.getSetting("pad_security_ctx")?s.getSetting("pad_security_ctx"):"preferred",r=n.get3DSpaceUrl()+o[i.expand3DType].url+"?SecurityContext="+a+"&tenant="+n.getPlatformId();"progressiveExpand"===i.expand3DType&&(r+="&output_format=cvjson");var l=i.data;l.fcs_url_mode=s.getSetting("enopad3dviewer_useStaticURL")?"REDIRECT":void 0,delete i.data;var c,d=e.extend({method:o[i.expand3DType].verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":s.getSetting("lang")},timeout:i.timeout?i.timeout:s.getSetting("webapi_timeout")},i);l.root_path_physicalid?c=l.root_path_physicalid:l.paths?c=l.paths:l.root_physicalid?c=[[l.root_physicalid]]:console.error("## CVServletServices.expand3d: No roots defined in input");var u=e.extend({label:n.getRequestLabel(),locale:s.getSetting("lang"),tenant:n.getPlatformId(),root_path_physicalid:c},l);return u=t.completeWebAPIPayload("expand3d",u,i),delete d.expand3DType,delete d.enopad_webapis,delete u.intent,delete u.root_physicalid,delete u.authored,delete u.debug,u.select_bo=u.select_bo.filter((function(e,t,n){return n.indexOf(e)===t})),d.data=JSON.stringify(u),d.onTimeout=d.onTimeout||d.onFailure,t.executeRequest(r,d)},getRootStats:function(e){var r={},l=require("DS/PADUtils/PADSettingsMgt"),c=l.getSetting("pad_security_ctx")?l.getSetting("pad_security_ctx"):"preferred";let d="",u=!1;s.isSGIEnv()&&(d=s.getAdditionalParameters([e.data.rootPhID]),u=s.isFeatureNavigationAvailable());var p=n.get3DSpaceUrl()+o.expandv2.url+"?output_format=cvjson&SecurityContext="+c+"&tenant="+n.getPlatformId()+d,h=this._buildPredefinedComputation(e.data.compute_select_bo),g=this._buildPrefixPath(e.data.rootPhID,e.data.root_path_physicalid),f=!1,_=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{}});let m=[];void 0===_?_={all:1}:(Array.isArray(_.aggregation_processors)&&_.aggregation_processors.length>0&&(m=_.aggregation_processors),_=_.filter,f=!0);var v=[{truncate:{max_distance_from_prefix:i.getSetting("eno3dview_VDRP_activate_POS")?1:0,prefix_filter:{prefix_path:g}}}],D=[];f&&(D.push({bounding_box:{name:"ProgressiveExpand_FilteredBBox",sampling:l.getSetting("enopad3dviewer_filteredBBoxSampling_progressiveExpand")}}),m.length>0&&(D=D.concat(m))),D.push({synthesis:{name:"ProgressiveExpand_FlatSynthesis",mode:"flat"}}),D.push({synthesis:{name:"ProgressiveExpand_OccSynthesis",mode:"occurence"}}),D.push({synthesis:{name:"ProgressiveExpand_LeafSynthesis",mode:"tree_leaf",synthesis_only:1}});var S,P=void 0;let y;e.data.get_materials&&void 0!==e.data.materialParameters&&(v.push(e.data.materialParameters.aggregationProcessors),P=e.data.materialParameters.materialAttributes),!0===l.getSetting("pgpFromServer")&&a(S=[],e.data),e.data.select_bo=e.data.select_bo.filter((function(e,t,n){return n.indexOf(e)===t})),e.data.select_rel=e.data.select_rel.filter((function(e,t,n){return n.indexOf(e)===t})),l.getSetting("enopad3dviewer_flexibleAssemblySupportActivated")&&(y=1);var A={batch:{expands:[{label:"ProgressiveExpand_Synthesis_"+n.getRequestLabel(),root:{physical_id:e.data.rootPhID},parameters:{limit_max_path:e.maxLeaves,apply_flexible_assembly_matrix:y||void 0},filter:_,graph:l.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:D,shatteredExpand:!!u||void 0},{label:"ProgressiveExpand_Expand0_"+n.getRequestLabel(),root:{physical_id:e.data.rootPhID},filter:{prefix_filter:{prefix_path:g}},graph:i.getSetting("eno3dview_VDRP_activate_POS")?l.getSetting("enopad3dviewer_graphDefinitionForGetRootStatsVDRPExpand"):l.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:v,parameters:y?{apply_flexible_assembly_matrix:1}:void 0,shatteredExpand:!!u||void 0}]},outputs:{select_object:i.getSetting("eno3dview_VDRP_activate_POS")?["bo.plmentity.v_discipline"].concat(e.data.select_bo):e.data.select_bo,select_relation:e.data.select_rel,select_material:P,select_pgp:S,hits:{predefined_computation:h},synthesis:["ProgressiveExpand_FlatSynthesis","ProgressiveExpand_OccSynthesis","ProgressiveExpand_LeafSynthesis"],bounding_box:f?["ProgressiveExpand_FilteredBBox"]:void 0,select_flexible_assembly_matrix:y?1:void 0}};return r.onComplete=e.onComplete,r.onFailure=e.onFailure,r.onTimeout=e.onTimeout||e.onFailure,r.timeout=6e4,r.method=o.expandv2.verb,r.headers={Accept:"application/json","Content-Type":"application/json"},r.wsName="getRootStats",r.txKey=e.data.rootPhID,r.data=JSON.stringify(A),t.executeRequest(p,r)},getStaticMappingExcludedOccurrences:function(e){var i={},a=require("DS/PADUtils/PADSettingsMgt"),r=a.getSetting("pad_security_ctx")?a.getSetting("pad_security_ctx"):"preferred";let l="",c=!1;s.isSGIEnv()&&(l=s.getAdditionalParameters([e.data.rootPhID]),c=s.isFeatureNavigationAvailable());var d=n.get3DSpaceUrl()+o.expandv2.url+"?output_format=cvjson&SecurityContext="+r+"&tenant="+n.getPlatformId()+"&disable_implicit_static_mapping_filter=true"+l,u=this._buildPrefixPath(e.data.rootPhID,e.data.root_path_physicalid);let p=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:u,staticMapping:1}});p=p||{};let h=[];e.intent&&"explore_2D"===e.intent&&(h=[{truncate:{compute_matching_subpaths_lengths:1,match_only_refs:1,or:{filters:[{and_not:{left:{and:{filters:[{all:1}]}},right:{and:{filters:[{static_mapping_filter:1}]}}}}]}}}]),Array.isArray(p.aggregation_processors)&&p.aggregation_processors.length>0&&(h=h.concat(p.aggregation_processors));var g={batch:{expands:[{label:"ProgressiveExpand_ExpandAll_"+n.getRequestLabel(),root:{physical_id:e.data.rootPhID},parameters:{disable_occurrence_output:1},filter:p.filter,graph:a.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:[{synthesis:{name:"ProgressiveExpand_FlatSynthesis",mode:"flat"}}],shatteredExpand:!!c||void 0},{label:"ProgressiveExpand_ExpandAll_ExcludedOccurences_"+n.getRequestLabel(),root:{physical_id:e.data.rootPhID},filter:{or:{filters:[{and_not:{left:{and:{filters:[{counted_by_flat_synthesis_filter:{synthesis_name:"ProgressiveExpand_FlatSynthesis"}},{prefix_filter:{prefix_path:[{physical_id_path:[e.data.rootPhID]}]}}]}},right:p.filter}}]}},graph:a.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:h.length>0?h:void 0,shatteredExpand:!!c||void 0}]},outputs:{format:"occurrence_path",select_object:e.data.select_bo,select_relation:e.data.select_rel,matching_lengths:e.intent&&"explore_2D"===e.intent?1:void 0}};return i.onComplete=e.onComplete,i.onFailure=e.onFailure,i.onTimeout=e.onTimeout||e.onFailure,i.timeout=3e5,i.method=o.expandv2.verb,i.headers={Accept:"application/json","Content-Type":"application/json"},i.wsName="getStaticMappingExcludedOccurrences",i.txKey=e.data.rootPhID,i.data=JSON.stringify(g),t.executeRequest(d,i)},progressiveExpand:function(e){var i={},r=require("DS/PADUtils/PADSettingsMgt"),l=r.getSetting("pad_security_ctx")?r.getSetting("pad_security_ctx"):"preferred";let c="",d=!1;s.isSGIEnv()&&(c=s.getAdditionalParameters([e.data.rootPhID]),d=s.isFeatureNavigationAvailable());var u=n.get3DSpaceUrl()+o.expandv2.url+"?output_format=cvjson&SecurityContext="+l+"&tenant="+n.getPlatformId()+c,p=void 0===e.withFrustumFilter||e.withFrustumFilter,h=this._buildPredefinedComputation(e.data.compute_select_bo),g=this._buildPrefixPath(e.data.rootPhID,e.data.root_path_physicalid),f=this._buildMatriceOverloads(e.data.rootPhID,e.overrides),_=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:g,inFrustumObj:p&&e.data.frustumDefinition&&void 0!==e.data.frustumDefinition.angle?e.data.frustumDefinition:void 0,inParallelFrustumObj:p&&e.data.frustumDefinition&&void 0!==e.data.frustumDefinition.left?e.data.frustumDefinition:void 0}}),m=void 0,v=void 0;e.data.get_materials&&void 0!==e.data.materialParameters&&(m=[e.data.materialParameters.aggregationProcessors],v=e.data.materialParameters.materialAttributes);var D,S=-1;let P;e.data.expand_iter&&(S=parseInt(e.data.expand_iter))>-1&&(void 0===m&&(m=[]),m.push({truncate:{max_distance_from_prefix:S,prefix_filter:{prefix_path:g}}})),Array.isArray(_.aggregation_processors)&&_.aggregation_processors.length>0&&(void 0===m&&(m=[]),m=m.concat(_.aggregation_processors)),!0===r.getSetting("pgpFromServer")&&a(D=[],e.data),e.data.select_bo=e.data.select_bo.filter((function(e,t,n){return n.indexOf(e)===t})),e.data.select_rel=e.data.select_rel.filter((function(e,t,n){return n.indexOf(e)===t})),r.getSetting("enopad3dviewer_flexibleAssemblySupportActivated")&&(P={apply_flexible_assembly_matrix:1});var y={batch:{expands:[{label:p?"ProgressiveExpand_ExpandFullVP_"+n.getRequestLabel():-1!=S?"ProgressiveExpand_Expand"+e.data.expand_iter+"_"+n.getRequestLabel():"ProgressiveExpand_ExpandAll_"+n.getRequestLabel(),root:{physical_id:e.data.rootPhID},matrices_overloads:p&&f.length?f:void 0,filter:_.filter,graph:r.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:m,parameters:void 0!==P?P:void 0,shatteredExpand:!!d||void 0}]},outputs:{select_object:e.data.select_bo,select_relation:e.data.select_rel,select_material:v,select_pgp:D,hits:{predefined_computation:h},select_flexible_assembly_matrix:void 0!==P?1:void 0}};return i.onComplete=e.onComplete,i.onFailure=e.onFailure,i.onTimeout=e.onTimeout||e.onFailure,i.timeout=6e5,i.method=o.expandv2.verb,i.headers={Accept:"application/json","Content-Type":"application/json"},i.data=JSON.stringify(y),i.wsName="expandv2",i.txKey=e.data.rootPhID,t.executeRequest(u,i)},progressiveExpandVDRP:function(e){var i={},r=require("DS/PADUtils/PADSettingsMgt"),l=r.getSetting("pad_security_ctx")?r.getSetting("pad_security_ctx"):"preferred";let c="",d=!1;s.isSGIEnv()&&(c=s.getAdditionalParameters([e.data.rootPhID]),d=s.isFeatureNavigationAvailable());var u=n.get3DSpaceUrl()+o.expandv2.url+"?output_format=cvjson&SecurityContext="+l+"&tenant="+n.getPlatformId()+c,p=void 0===e.withFrustumFilter||e.withFrustumFilter,h=this._buildPredefinedComputation(e.data.compute_select_bo),g=this._buildPrefixPath(e.data.rootPhID,e.data.root_path_physicalid),f=this._buildMatriceOverloads(e.data.rootPhID,e.overrides),_=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:g,inFrustumObj:p&&e.data.frustumDefinition&&void 0!==e.data.frustumDefinition.angle?e.data.frustumDefinition:void 0,inParallelFrustumObj:p&&e.data.frustumDefinition&&void 0!==e.data.frustumDefinition.left?e.data.frustumDefinition:void 0}}),m=e.FBIProxy.getFilterSpec(e.posArchRootId,{V2:{prefixPathArray:this._buildPrefixPath(e.posArchRootId,[]),inFrustumObj:p&&e.data.frustumDefinition&&void 0!==e.data.frustumDefinition.angle?e.data.frustumDefinition:void 0,inParallelFrustumObj:p&&e.data.frustumDefinition&&void 0!==e.data.frustumDefinition.left?e.data.frustumDefinition:void 0}}),v=void 0,D=void 0;e.data.get_materials&&void 0!==e.data.materialParameters&&(v=[e.data.materialParameters.aggregationProcessors],D=e.data.materialParameters.materialAttributes);var S,P=-1;let y;e.data.expand_iter&&(P=parseInt(e.data.expand_iter))>-1&&(void 0===v&&(v=[]),v.push({truncate:{max_distance_from_prefix:P,prefix_filter:{prefix_path:g}}})),Array.isArray(_.aggregation_processors)&&_.aggregation_processors.length>0&&(void 0===v&&(v=[]),v=v.concat(_.aggregation_processors)),!0===r.getSetting("pgpFromServer")&&a(S=[],e.data),e.data.select_bo=e.data.select_bo.filter((function(e,t,n){return n.indexOf(e)===t})),e.data.select_rel=e.data.select_rel.filter((function(e,t,n){return n.indexOf(e)===t})),r.getSetting("enopad3dviewer_flexibleAssemblySupportActivated")&&(y={apply_flexible_assembly_matrix:1});var A={batch:{expands:[{label:"ProgressiveExpand_ExpandAllBOM_"+n.getRequestLabel(),root:{physical_id:e.data.rootPhID},matrices_overloads:p&&f.length?f:void 0,filter:_.filter,graph:{descending_condition_object:{uql:'([ds6w:globaltype]:"ds6w:Document" OR [ds6w:globaltype]:"ds6w:Part") AND (flattenedtaxonomies:"types/LPAbstract3DRepReference" OR flattenedtaxonomies:"types/LPAbstractReference")'},descending_condition_relation:{uql:'NOT (flattenedtaxonomies:"reltypes/PositioningArch") AND NOT (flattenedtaxonomies:"reltypes/XCADBaseDependency")'}},aggregation_processors:v,parameters:void 0!==y?y:void 0,shatteredExpand:!!d||void 0},{label:"ProgressiveExpand_ExpandAllPosArch_"+n.getRequestLabel(),root:{physical_id:e.posArchRootId},matrices_overloads:p&&f.length?f:void 0,filter:m.filter,graph:{descending_condition_object:{uql:'([ds6w:globaltype]:"ds6w:Document" OR [ds6w:globaltype]:"ds6w:Part") AND (flattenedtaxonomies:"types/LPAbstract3DRepReference" OR flattenedtaxonomies:"types/LPAbstractReference")'},descending_condition_relation:{uql:'NOT (flattenedtaxonomies:"reltypes/XCADBaseDependency")'}},aggregation_processors:v,parameters:void 0!==y?y:void 0,shatteredExpand:!!d||void 0}]},outputs:{select_object:["bo.plmentity.v_discipline"].concat(e.data.select_bo),select_relation:["pathsr"].concat(e.data.select_rel),select_material:D,select_pgp:S,hits:{predefined_computation:h},select_flexible_assembly_matrix:void 0!==y?1:void 0}};return i.onComplete=e.onComplete,i.onFailure=e.onFailure,i.onTimeout=e.onTimeout||e.onFailure,i.timeout=6e5,i.method=o.expandv2.verb,i.headers={Accept:"application/json","Content-Type":"application/json"},i.data=JSON.stringify(A),i.wsName="expandv2",i.txKey=e.data.rootPhID,t.executeRequest(u,i)},multiexpand:function(e){console.warn("/! PADWSAccess.multiexpand:: Internal and Obsolete Code"),e.onFailure()},volumeQuery:function(e){console.warn("/! PADWSAccess.volumeQuery:: Internal and Obsolete Code"),e.onFailure()},volumeQueryV2:function(e){var i={},r=require("DS/PADUtils/PADSettingsMgt"),l=r.getSetting("pad_security_ctx")?r.getSetting("pad_security_ctx"):"preferred";let c="",d=!1;s.isSGIEnv()&&(c=s.getAdditionalParameters([e.data.rootPhID]),d=s.isFeatureNavigationAvailable());let u=n.get3DSpaceUrl()+o.expandv2.url+"?output_format=cvjson&SecurityContext="+l+"&tenant="+n.getPlatformId()+c;var p,h,g=this._buildPredefinedComputation(e.data.compute_select_bo),f=this._buildMatriceOverloads(e.data.rootPhID,e.data.overrides),_=this._buildPrefixPath(e.data.rootPhID,e.data.root_path_physicalid),m=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:_,volumeObj:[e.data.volume_filter]}}),v=void 0;let D;e.data.get_materials&&void 0!==e.data.materialParameters&&(v=[e.data.materialParameters.aggregationProcessors],p=e.data.materialParameters.materialAttributes),Array.isArray(m.aggregation_processors)&&m.aggregation_processors.length>0&&(void 0===v&&(v=[]),v=v.concat(m.aggregation_processors)),!0===r.getSetting("pgpFromServer")&&a(h=[],e.data),e.data.select_bo=e.data.select_bo.filter((function(e,t,n){return n.indexOf(e)===t})),e.data.select_rel=e.data.select_rel.filter((function(e,t,n){return n.indexOf(e)===t})),r.getSetting("enopad3dviewer_flexibleAssemblySupportActivated")&&(D=1);let S={limit_max_path:e.data.max_output_paths?e.data.max_output_paths:void 0,apply_flexible_assembly_matrix:D||void 0};S.limit_max_path||S.apply_flexible_assembly_matrix||(S=void 0);var P={applicationID:void 0!==e.data.applicationID?e.data.applicationID:void 0,batch:{expands:[{label:"ProgressiveExpand_VolumeQuery_"+n.getRequestLabel(),parameters:S,root:{physical_id:e.data.rootPhID},matrices_overloads:f.length?f:void 0,filter:m.filter,graph:r.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:v,shatteredExpand:!!d||void 0}]},outputs:{select_object:e.data.select_bo,select_relation:e.data.select_rel,select_material:p,select_pgp:h,hits:{predefined_computation:g},format:"entity_relation_occurrence",select_flexible_assembly_matrix:void 0!==D?1:void 0}};return i.onComplete=e.onComplete,i.onFailure=e.onFailure,i.onTimeout=e.onTimeout||e.onFailure,i.timeout=6e4,i.method=o.searchv2.verb,i.headers={Accept:"application/json","Content-Type":"application/json"},i.data=JSON.stringify(P),i.wsName="volumeQueryV2",i.txKey=e.data.rootPhID,t.executeRequest(u,i)},search:function(e){console.warn("/! PADWSAccess.search:: Internal and Obsolete Code"),e.onFailure()},searchV2:function(e){var i={},r=require("DS/PADUtils/PADSettingsMgt"),l=r.getSetting("pad_security_ctx")?r.getSetting("pad_security_ctx"):"preferred";let c="",d=!1;s.isSGIEnv()&&(c=s.getAdditionalParameters([e.data.rootPhID]),d=s.isFeatureNavigationAvailable());var u=n.get3DSpaceUrl()+o.searchv2.url+"?output_format=cvjson&SecurityContext="+l+"&tenant="+n.getPlatformId()+c,p=this._buildPredefinedComputation(e.data.compute_select_bo),h=this._buildPrefixPath(e.data.rootPhID);e.data.max_count_path&&(e.data.max_count_path=parseInt(e.data.max_count_path),e.data.max_count_path===parseInt(r.getSetting("enopad3dviewer_max_count_in_search"))&&(e.data.max_count_path=e.data.max_count_path+1));var g=null,f=[];if(e.data.subPaths){g=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:h,find_subpaths:e.data.subPaths}});const t={truncate:e.FBIProxy.buildSpecFromAppIntent({V2:{find_subpaths:e.data.subPaths}})};t.truncate.max_distance_from_prefix=0,t.truncate.compute_matching_subpaths_lengths=1,t.truncate.match_only_refs=1,f=[t]}else if(e.data.taggerSelect){g=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:h,tagger_select:e.data.taggerSelect}});const t={truncate:e.FBIProxy.buildSpecFromAppIntent({V2:{tagger_select:e.data.taggerSelect}})};t.truncate.max_distance_from_prefix=0,t.truncate.compute_matching_subpaths_lengths=1,t.truncate.match_only_refs=1,f=[t]}else if(e.data.searchQuery){g=e.FBIProxy.GetFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:h,find_in_context:e.data.searchQuery}});const t={truncate:e.FBIProxy.buildSpecFromAppIntent({V2:{find_in_context:e.data.searchQuery}})};t.truncate.max_distance_from_prefix=0,t.truncate.compute_matching_subpaths_lengths=1,t.truncate.match_only_refs=1,f=[t]}var _,m=void 0;let v;e.data.get_materials&&void 0!==e.data.materialParameters&&(f.push(e.data.materialParameters.aggregationProcessors),m=e.data.materialParameters.materialAttributes),!0===r.getSetting("pgpFromServer")&&a(_=[],e.data),Array.isArray(g.aggregation_processors)&&g.aggregation_processors.length>0&&(f=f.concat(g.aggregation_processors)),e.data.select_bo=e.data.select_bo.filter((function(e,t,n){return n.indexOf(e)===t})),e.data.select_rel=e.data.select_rel.filter((function(e,t,n){return n.indexOf(e)===t})),r.getSetting("enopad3dviewer_flexibleAssemblySupportActivated")&&(v=1);let D={limit_max_path:e.data.max_count_path?e.data.max_count_path:void 0,apply_flexible_assembly_matrix:void 0!==v?v:void 0};D.limit_max_path||D.apply_flexible_assembly_matrix||(D=void 0);var S={batch:{expands:[{label:"ProgressiveExpand_SearchV2_"+n.getRequestLabel(),parameters:D,root:{physical_id:e.data.rootPhID},filter:g.filter,graph:r.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:f,shatteredExpand:!!d||void 0}]},outputs:{select_object:e.data.select_bo,select_relation:e.data.select_rel,select_material:m,select_pgp:_,hits:{predefined_computation:p},matching_lengths:1,format:"entity_relation_occurrence",select_flexible_assembly_matrix:void 0!==v?1:void 0}};return i.onComplete=e.onComplete,i.onFailure=e.onFailure,i.onTimeout=e.onTimeout||e.onFailure,i.timeout=6e4,i.method=o.searchv2.verb,i.headers={Accept:"application/json","Content-Type":"application/json"},i.wsName="searchV2",i.txKey=e.data.rootPhID,i.data=JSON.stringify(S),t.executeRequest(u,i)},getMinMaxDistanceCandidates:function(e){var i={},r=require("DS/PADUtils/PADSettingsMgt"),l=r.getSetting("pad_security_ctx")?r.getSetting("pad_security_ctx"):"preferred";let c="",d=!1;s.isSGIEnv()&&(c=s.getAdditionalParameters([e.data.rootPhID]),d=s.isFeatureNavigationAvailable());var u=n.get3DSpaceUrl()+o.expandv2.url+"?output_format=cvjson&SecurityContext="+l+"&tenant="+n.getPlatformId()+c,p=this._buildPredefinedComputation(e.data.compute_select_bo),h=this._buildMatriceOverloads(e.data.rootPhID,e.data.overrides),g=e.data.sets[0].paths;g=g.concat(e.data.sets[1].paths);var f,_,m=this._buildPrefixPath(e.data.rootPhID,g),v=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:m}}),D=[this._buildMinMaxSets(e.data.mode,e.data.sets)];let S;e.data.get_materials&&void 0!==e.data.materialParameters&&(D.push(e.data.materialParameters.aggregationProcessors),f=e.data.materialParameters.materialAttributes),!0===r.getSetting("pgpFromServer")&&a(_=[],e.data),Array.isArray(v.aggregation_processors)&&v.aggregation_processors.length>0&&(D=D.concat(v.aggregation_processors)),e.data.select_bo=e.data.select_bo.filter((function(e,t,n){return n.indexOf(e)===t})),e.data.select_rel=e.data.select_rel.filter((function(e,t,n){return n.indexOf(e)===t})),r.getSetting("enopad3dviewer_flexibleAssemblySupportActivated")&&(S={apply_flexible_assembly_matrix:1});var P={batch:{expands:[{label:"ProgressiveExpand_MinMaxDistance_"+n.getRequestLabel(),root:{physical_id:e.data.rootPhID},matrices_overloads:h.length?h:void 0,filter:v.filter,graph:r.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:D,parameters:S||void 0,shatteredExpand:!!d||void 0}]},outputs:{select_object:e.data.select_bo,select_relation:e.data.select_rel,select_material:f,select_pgp:_,hits:{predefined_computation:p},format:"entity_relation_occurrence",select_flexible_assembly_matrix:S?1:void 0}};return i.onComplete=e.onComplete,i.onFailure=e.onFailure,i.onTimeout=e.onTimeout||e.onFailure,i.timeout=6e4,i.method=o.searchv2.verb,i.headers={Accept:"application/json","Content-Type":"application/json"},i.data=JSON.stringify(P),t.executeRequest(u,i)},_buildMinMaxSets:function(e,t){var n={},i=0,s={set_a_label:t[0].id,set_a_filter:{prefix_filter:{prefix_path:[]}},set_b_label:t[1].id,set_b_filter:{prefix_filter:{prefix_path:[]}}};for(i=0;i<t[0].paths.length;i++)s.set_a_filter.prefix_filter.prefix_path.push({physical_id_path:t[0].paths[i]});for(i=0;i<t[1].paths.length;i++)s.set_b_filter.prefix_filter.prefix_path.push({physical_id_path:t[1].paths[i]});return"min"===e?n.min_distance=s:"max"===e&&(n.max_distance=s),n},_buildPredefinedComputation:function(e){var t=["boundingbox"];if(-1!==e.indexOf("thumbnail_3d")){let e=require("DS/PADUtils/PADSettingsMgt");n.isCloud()||!0!==e.getSetting("eno3dviewer_thumbnail_if_uptodate_else_cgr")?t.push("thumbnail_3d_fallback_cgr"):t.push("navrep_if_uptodate_else_cgr")}else-1!==e.indexOf("stepcgr")?t.push("urlstream|cgr|stepcgr"):t=t.concat(e);return t},_buildPrefixPath:function(e,t){var n=null,i=0;if(t&&t.length)for(n=[],i=0;i<t.length;i++)n.push({physical_id_path:t[i]});else n=[{physical_id_path:[e]}];return n},_buildMatriceOverloads:function(e,t){var n=[],i=0;if(t)for(i=0;i<t.length;i++){var s=t[i];s.idPath&&s.value&&16===s.value.length&&(s.idPath.splice(0,1),s.idPath[0]===e&&n.push({path:{physical_id_path:s.idPath},matrix:[s.value[0],s.value[1],s.value[2],s.value[4],s.value[5],s.value[6],s.value[8],s.value[9],s.value[10],s.value[12],s.value[13],s.value[14]]}))}return n},getIndexingDate:function(i){var s={select_service:i.service},a=require("DS/PADUtils/PADSettingsMgt"),r=a.getSetting("pad_security_ctx")?a.getSetting("pad_security_ctx"):"preferred",l=n.get3DSpaceUrl()+o.indexingdate.url+"?SecurityContext="+r+"&tenant="+n.getPlatformId(),c=e.extend({method:o.indexingdate.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":a.getSetting("lang")},timeout:a.getSetting("webapi_timeout")},i);return c.data=JSON.stringify(s),t.executeRequest(l,c)}}})),define("DS/PADUtils/utilsWS/WSAdmin",["DS/WAFData/WAFData","DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/Configuration","DS/PADUtils/PADUtilsServices"],(function(e,t,n,i){"use strict";let s={url:"/resources/vplmte/getallctx",verb:"GET"},o={url:"/resources/modeler/pno/person?current=true&select=preferredcredentials&select=collabspaces",verb:"GET"},a={url:"/resources/6WVocab/access/PredicatesNLSNames",verb:"GET"},r={url:"/resources/AppsMngt/user/preference",verb:"GET"},l={url:"/resources/AppsMngt/user/preference",verb:"PUT"},c={url:"/resources/enopad/admin/readsettings/v2",verb:"GET"},d={url:"/resources/enong/dico/gettypeshierarchy",verb:"POST"},u={url:"/resources/dictionary/getTypeInfo",verb:"POST"},p={url:"/resources/dictionary/class/interfaces",verb:"POST"};return{getscandcollab:function(e){let n,a,r,l=require("DS/PADUtils/PADSettingsMgt"),c=void 0!==window.jasmine,d=e;return r=d.tenant?d.tenant:i.getPlatformId(),l.hasSetting("getAllContext")&&!l.getSetting("getAllContext")||c?(n=o,a=i.get3DSpaceUrl(r)+n.url+"&tenant="+r):(n=s,a=i.get3DSpaceUrl(r)+n.url+"?tenant="+r),d.method=n.verb,d.headers={Accept:"application/json","Accept-Language":l.getSetting("lang"),"Content-Type":"application/json"},d.cache=-1,t.executeRequest(a,d,!0)},predicates_nls_names:function(e){let n=require("DS/PADUtils/PADSettingsMgt");if(!0===n.getSetting("FedDictionnaryAccess"))throw new Error("## WSAdmin.predicates_nls_names: Call new FedDictionaryAccessAPI instead");let s=a,o=i.get3DSpaceUrl()+s.url,r=e;return r.method=s.verb,r.headers={Accept:"application/json","Accept-Language":n.getSetting("lang")},r.data="name="+e.name+"&tenant="+i.getPlatformId(),t.executeRequest(o,r)},getPredicates:function(t){let n=require("DS/PADUtils/PADSettingsMgt");if(!0===n.getSetting("FedDictionnaryAccess"))throw new Error("## WSAdmin.getElementsNLSNames: Call new FedDictionaryAccessAPI instead");let s=t||{},o=i.get3DSpaceUrl()+"/resources/6WVocab/access/Predicates?tenant="+i.getPlatformId();s.method="POST",s.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":n.getSetting("lang")},s.data=t.classURIs,e.authenticatedRequest(o,s)},getVocabularyClasses:function(t){let n=require("DS/PADUtils/PADSettingsMgt");if(!0===n.getSetting("FedDictionnaryAccess"))throw new Error("## WSAdmin.getElementsNLSNames: Call new FedDictionaryAccessAPI instead");let s=t||{},o=i.get3DSpaceUrl()+"/resources/6WVocab/access/VocabularyClasses?tenant="+i.getPlatformId();s.method="GET",s.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":n.getSetting("lang")},s.timeout=6e4,s.data="name="+t.vocabularyname,e.authenticatedRequest(o,s)},getTypeInfo:function(e){let n=require("DS/PADUtils/PADSettingsMgt"),s=u,o=i.get3DSpaceUrl()+s.url+"?tenant="+i.getPlatformId(),a=e;if(a.url_parameters){let t=Object.getOwnPropertyNames(e.url_parameters);for(let n=0;n<t.length;n++)o=o+"&"+t[n]+"="+e.url_parameters[t[n]];delete a.url_parameters}return a.method=s.verb,a.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":n.getSetting("lang")},a.data=JSON.stringify(a.body),delete a.body,t.executeRequest(o,a)},interfaces:function(e){let n=require("DS/PADUtils/PADSettingsMgt"),s=p,o=i.get3DSpaceUrl()+s.url+"?tenant="+i.getPlatformId(),a=e;return a.method=s.verb,a.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":n.getSetting("lang")},a.data=JSON.stringify(a.data),t.executeRequest(o,a)},getMyAppsTemplate:function(e){require("DS/PADUtils/PADSettingsMgt");let n=r,s=i.getPlatformURL("3DCompass")+n.url,o=e;return o.method=n.verb,o.headers={Accept:"application/json, text/plain"},o.data={name:e.preference_name},t.executeRequest(s,o,!0)},saveMyAppsTemplate:function(e){require("DS/PADUtils/PADSettingsMgt");let n=l,s=i.getPlatformURL("3DCompass")+n.url,o=e;return o.method=n.verb,o.headers={Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},o.data={name:e.preference_name,value:e.value},t.executeRequest(s,o,!0)},padtreelistOpts:function(e){require("DS/PADUtils/PADSettingsMgt");let n=c,s=i.get3DSpaceUrl()+n.url+"?tenant="+i.getPlatformId(),o=e;if(o.method=n.verb,o.headers={Accept:"application/json"},void 0===e.data.intent||void 0===e.data.app)throw new Error("Invalid inputs for WSAdmin.padtreelistOpts");return o.data="intent="+e.data.intent+"&app="+e.data.app+"&reset="+(!0===e.data.reset?"true":"false"),t.executeRequest(s,o)},getTypesHierarchy:function(e){require("DS/PADUtils/PADSettingsMgt");let n=d,s=i.get3DSpaceUrl()+n.url+"?tenant="+i.getPlatformId(),o=e;return o.method=n.verb,o.headers={Accept:"application/json","Content-Type":"application/json"},o.data=JSON.stringify({types:e.types}),t.executeRequest(s,o)},getsecuritycontext:function(e){e.onFailure("DEPRECATED METHOD")},availablesecuritycontext:function(e){e.onFailure("DEPRECATED METHOD")},catalogs:function(e){e.onFailure("DEPRECATED METHOD")}}})),define("DS/PADUtils/utilsWS/LWCDirectAccess",["UWA/Core","DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices","DS/PADServices/settings/AppSettings","DS/PADServices/utils/PConfigUtils","DS/PADServices/utils/PlatformURL"],(function(e,t,n,i,s,o){"use strict";var a,r={url:"/resources/enoauthoring/fetch/v1",verb:"POST"},l={url:"/resources/enoauthoring/expand/v1",verb:"POST"},c={url:"/resources/enoauthoring/expand/v2",verb:"POST"},d={url:"/resources/enoauthoring/expand/v2/progressive",verb:"POST"};var u={fetch:function(i){var s=require("DS/PADUtils/PADSettingsMgt"),o=s.getSetting("pad_security_ctx")?s.getSetting("pad_security_ctx"):"preferred";o=encodeURIComponent(o);var a=n.get3DSpaceUrl()+r.url+"?SecurityContext="+o+"&tenant="+n.getPlatformId(),l=i.data;delete i.data;var c=e.extend({method:r.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":s.getSetting("lang")},timeout:i.timeout?i.timeout:s.getSetting("webapi_timeout")},i),d=require("DS/PADServices/utils/AttributesMgtV2"),u=e.extend({label:n.getRequestLabel(),physicalid:i.pids,locale:s.getSetting("lang"),tenant:n.getPlatformId(),types:d.getSelectedTypes(),extensions:d.getSelectedExtensions()},l);return u="fetch_3D"===u.intent?t.completeWebAPIPayload("fetch3d",u,i):t.completeWebAPIPayload("fetch2d",u,i),delete c.pids,delete c.enopad_webapis,delete u.intent,delete u.authored,u.select_predicate=u.select_predicate.filter((function(e,t,n){return n.indexOf(e)===t})),c.data=JSON.stringify(u),c.onTimeout=c.onTimeout||c.onFailure,t.executeRequest(a,c)},expand:function(i){var s=require("DS/PADUtils/PADSettingsMgt"),o=s.getSetting("pad_security_ctx")?s.getSetting("pad_security_ctx"):"preferred";o=encodeURIComponent(o);require("DS/PADServices/utils/PConfigUtils");var a=require("DS/PADServices/settings/AppSettings"),r=n.get3DSpaceUrl()+l.url+"?SecurityContext="+o+"&tenant="+n.getPlatformId(),c=i.data;delete i.data;var d=e.extend({method:l.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":s.getSetting("lang")},timeout:i.timeout?i.timeout:s.getSetting("webapi_timeout")},i),u=[];e.is(c.roots)?u=c.roots:e.is(c.root_physicalid)?u=[[c.root_physicalid]]:e.is(c.paths)?u=c.paths:e.is(c.root_path_physicalid)&&(u=c.root_path_physicalid);let p,h=a.getSetting("authoringFilterEnabled"),g=a.getSetting("authoringFilterEnabledForMultiRoot"),f=[],_="",m="",v=0,D=!1;if(h&&(g||1===i.FBIProxy._mRootsDataInSession.size)&&1===u.length&&i.FBIProxy&&i.FBIProxy._mRootsDataInSession){for(var S=i.FBIProxy._mRootsDataInSession.get(u[0].at(0)),P=S?S.filterInfos.objQueryV2.batch.expands:[],y=0;y<P.length;y++){if(P[y].filter&&P[y].filter.or.filters&&1===P[y].filter.or.filters.length&&P[y].filter.or.filters[0].and)for(var A=P[y].filter.or.filters[0].and.filters,b=0;b<A.length;b++){if(A[b].assembly_shape_filter||A[b].sequence_filter){_="",m="";break}A[b].prefix_filter?v++:A[b].config_filter?(_=A[b].config_filter,m="Compiled"):A[b].config_filter_id&&(_=A[b].config_filter_id.physical_id,m="PhysicalId")}v<1&&_&&m&&(D=!0);var x={isValid:D,config_filter:_,configCompiledForm:m};x.isValid&&f.push(x)}f&&1===f.length&&(p=f[0])}var C=require("DS/PADServices/utils/AttributesMgtV2"),w=e.extend({label:n.getRequestLabel(),root_path_physicalid:u,locale:s.getSetting("lang"),tenant:n.getPlatformId(),types:C.getSelectedTypes(),extensions:C.getSelectedExtensions()},c);return w="explore_3d"===w.intent.toLowerCase()?t.completeWebAPIPayload("expand3d",w,i):t.completeWebAPIPayload("expand",w,i),p&&p.isValid&&(p.config_filter&&(w.config_filter=p.config_filter),p.configCompiledForm&&(w.configCompiledForm=p.configCompiledForm)),w.static_mapping=a.getSetting("staticMappingEnabled"),delete d.pids,delete d.enopad_webapis,delete w.intent,delete w.authored,delete w.root_physicalid,w.select_bo=w.select_bo.filter((function(e,t,n){return n.indexOf(e)===t})),w.select_rel=w.select_rel.filter((function(e,t,n){return n.indexOf(e)===t})),d.data=JSON.stringify(w),d.onTimeout=d.onTimeout||d.onFailure,t.executeRequest(r,d)},expandV2:function(s){var o=require("DS/PADUtils/PADSettingsMgt"),a=o.getSetting("pad_security_ctx")?o.getSetting("pad_security_ctx"):"preferred";a=encodeURIComponent(a);var r=n.get3DSpaceUrl()+c.url+"?SecurityContext="+a+"&tenant="+n.getPlatformId(),d=s.data;delete s.data;var u=e.extend({method:l.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":o.getSetting("lang")},timeout:s.timeout?s.timeout:o.getSetting("webapi_timeout")},s),p=[];e.is(d.roots)?p=d.roots:e.is(d.root_physicalid)?p=[[d.root_physicalid]]:e.is(d.paths)?p=d.paths:e.is(d.root_path_physicalid)&&(p=d.root_path_physicalid);let h,g=i.getSetting("authoringFilterEnabled"),f=i.getSetting("authoringFilterEnabledForMultiRoot"),_=[],m="",v="",D=0,S=!1;if(g&&(f||1===s.FBIProxy._mRootsDataInSession.size)&&1===p.length&&s.FBIProxy&&s.FBIProxy._mRootsDataInSession){for(var P=s.FBIProxy._mRootsDataInSession.get(p[0].at(0)),y=P?P.filterInfos.objQueryV2.batch.expands:[],A=0;A<y.length;A++){if(y[A].filter&&y[A].filter.or.filters&&1===y[A].filter.or.filters.length&&y[A].filter.or.filters[0].and)for(var b=y[A].filter.or.filters[0].and.filters,x=0;x<b.length;x++){if(b[x].assembly_shape_filter||b[x].sequence_filter){m="",v="";break}b[x].prefix_filter?D++:b[x].config_filter?(m=b[x].config_filter,v="Compiled"):b[x].config_filter_id&&(m=b[x].config_filter_id.physical_id,v="PhysicalId")}D<1&&m&&v&&(S=!0);var C={isValid:S,config_filter:m,configCompiledForm:v};C.isValid&&_.push(C)}_&&1===_.length&&(h=_[0])}var w=require("DS/PADServices/utils/AttributesMgtV2"),U=e.extend({label:n.getRequestLabel(),root_path_physicalid:p,locale:o.getSetting("lang"),tenant:n.getPlatformId(),types:w.getSelectedTypes(),extensions:w.getSelectedExtensions()},d);return U="explore_3d"===U.intent.toLowerCase()?t.completeWebAPIPayload("expand3d",U,s):t.completeWebAPIPayload("expand",U,s),h&&(h.config_filter&&(U.config_filter=h.config_filter),h.configCompiledForm&&(U.configCompiledForm=h.configCompiledForm)),U.static_mapping=i.getSetting("staticMappingEnabled"),delete u.pids,delete u.enopad_webapis,delete U.intent,delete U.authored,delete U.root_physicalid,U.select_bo=U.select_bo.filter((function(e,t,n){return n.indexOf(e)===t})),U.select_rel=U.select_rel.filter((function(e,t,n){return n.indexOf(e)===t})),u.data=JSON.stringify(U),u.onTimeout=u.onTimeout||u.onFailure,t.executeRequest(r,u)},configFilterFn:function(t){a=null;var n=t.data,s=[];e.is(n.roots)?s=n.roots:e.is(n.root_physicalid)?s=[[n.root_physicalid]]:e.is(n.paths)?s=n.paths:e.is(n.root_path_physicalid)&&(s=n.root_path_physicalid);let o,r=i.getSetting("authoringFilterEnabled"),l=i.getSetting("authoringFilterEnabledForMultiRoot"),c=[],d="",u="",p=0,h=!1;if(r&&(l||1===t.FBIProxy._mRootsDataInSession.size)&&1===s.length&&t.FBIProxy&&t.FBIProxy._mRootsDataInSession){for(var g=t.FBIProxy._mRootsDataInSession.get(s[0].at(0)),f=g?g.filterInfos.objQueryV2.batch.expands:[],_=0;_<f.length;_++){if(f[_].filter&&f[_].filter.or.filters&&1===f[_].filter.or.filters.length&&f[_].filter.or.filters[0].and)for(var m=f[_].filter.or.filters[0].and.filters,v=0;v<m.length;v++){if(m[v].assembly_shape_filter||m[v].sequence_filter){d="",u="";break}m[v].prefix_filter?p++:m[v].config_filter?(d=m[v].config_filter,u="Compiled"):m[v].config_filter_id&&(d=m[v].config_filter_id.physical_id,u="PhysicalId")}p<1&&d&&u&&(h=!0);var D={isValid:h,config_filter:d,configCompiledForm:u};D.isValid&&c.push(D)}c&&1===c.length&&(o=c[0])}a=o},expandV2progressive:function(s){var o=require("DS/PADUtils/PADSettingsMgt");let r=d;var c=o.getSetting("pad_security_ctx")?o.getSetting("pad_security_ctx"):"preferred";c=encodeURIComponent(c);var u=n.get3DSpaceUrl()+r.url+"?tenant="+n.getPlatformId();c&&(u+="&SecurityContext="+c);var p=s.data,h=e.extend({method:l.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":o.getSetting("lang")},timeout:s.timeout?s.timeout:o.getSetting("webapi_timeout")},s);s.data.boundingbox;var g=[];e.is(p.roots)?g=p.roots:e.is(p.root_physicalid)?g=[[p.root_physicalid]]:e.is(p.paths)?g=p.paths:e.is(p.root_path_physicalid)&&(g=p.root_path_physicalid);var f,_=require("DS/PADServices/utils/AttributesMgtV2"),m=e.extend({label:n.getRequestLabel(),root_path_physicalid:g,locale:o.getSetting("lang"),tenant:n.getPlatformId(),types:_.getSelectedTypes(),extensions:_.getSelectedExtensions()},p);this.configFilterFn(s),(m=m.intent&&"explore_3d"===m.intent.toLowerCase()?t.completeWebAPIPayload("expand3d",m,s):t.completeWebAPIPayload("expand",m,s)).select_bo=m.select_bo.filter((function(e,t,n){return n.indexOf(e)===t})),m.select_rel=m.select_rel.filter((function(e,t,n){return n.indexOf(e)===t})),a&&(a.config_filter&&(m.config_filter=a.config_filter),a.configCompiledForm&&(m.configCompiledForm=a.configCompiledForm)),m.static_mapping=i.getSetting("staticMappingEnabled"),delete h.pids,delete h.enopad_webapis,delete m.intent,delete m.authored,delete m.root_physicalid,!0===i.getSetting("pgpFromServer")&&(f=["show","hide","color","opacity"]);var v=this._buildPredefinedComputation(s.data.compute_select_bo);let D={aggregation_processors:[{truncate:{max_distance_from_prefix:0,prefix_filter:{prefix_path:[{physical_id_path:[s.data.root_path_physicalid]}]}}}],filter:{prefix_filter:{prefix_path:[{physical_id_path:[s.data.root_path_physicalid]}]}},graph:o.getSetting("enopad3dviewer_graphDefinitionForExpand"),label:"ProgressiveExpand_Expand_0_"+n.getRequestLabel(),root:{physical_id:s.data.root_path_physicalid}};var S={batch:{expands:[{label:"ProgressiveExpand_Expand_All_"+n.getRequestLabel(),root:{physical_id:s.data.root_path_physicalid},filter:{or:{filters:[{and:{filters:[{prefix_filter:{prefix_path:[{physical_id_path:s.data.root_path_physicalid}]}}]}}]}},graph:o.getSetting("enopad3dviewer_graphDefinitionForExpand"),parameters:{apply_flexible_assembly_matrix:1}}]},outputs:{select_object:s.data.select_bo,select_relation:s.data.select_rel,select_pgp:f,select_flexible_assembly_matrix:1,hits:{predefined_computation:v}}},P={batch:{expands:[{label:"ProgressiveExpand_Expand_All_"+n.getRequestLabel(),root:{physical_id:s.data.root_path_physicalid},filter:{all:1},parameters:{limit_max_path:20001,apply_flexible_assembly_matrix:1},graph:{descending_condition:{uql:"availability:2"},descending_condition_object:{uql:'[ds6w:globaltype]:"ds6w:Document" OR [ds6w:globaltype]:"ds6w:Part"'},descending_condition_relation:{uql:'NOT (flattenedtaxonomies:"reltypes/XCADBaseDependency")'}},aggregation_processors:[{synthesis:{name:"ProgressiveExpand_FlatSynthesis",mode:"flat"}},{synthesis:{name:"ProgressiveExpand_OccSynthesis",mode:"occurence"}},{synthesis:{name:"ProgressiveExpand_LeafSynthesis",mode:"tree_leaf",synthesis_only:1}}]}]},outputs:{select_object:s.data.select_bo,select_relation:s.data.select_rel,select_pgp:f,select_flexible_assembly_matrix:1,hits:{predefined_computation:v},synthesis:["ProgressiveExpand_FlatSynthesis","ProgressiveExpand_OccSynthesis","ProgressiveExpand_LeafSynthesis"]}};"0"!==m.expand_iter&&(S.outputs.select_object&&S.outputs.select_object.push("cestamp"),S.outputs.select_relation&&S.outputs.select_relation.push("cestamp")),"0"===m.expand_iter&&(S=P).batch.expands&&S.batch.expands.push(D);let y={cv:S,db:m};return h.data=JSON.stringify(y),h.onTimeout=h.onTimeout||h.onFailure,t.executeRequest(u,h)},refresh:function(t){var n=[],i=[];e.is(t.data.session)&&t.data.session.length>0&&t.data.session.forEach((function(e){e.forEach((function(t){if(t.length>2){var s=t.filter((function(e,t,i){return t%2==0&&t<i.length-2&&!n.includes(e)}));n=n.concat(s)}1==e.length&&1==t.length&&(i.push(t[0]),n.push(t[0]))}))}));var s=[];if(n.forEach((function(e){s.push(new Array(e))})),i.length>0){var o=e.extend({pids:i},t),a=o.onComplete;o.onComplete=function(t){var n=e.is(t,"string")?JSON.parse(t):t;n.full_path=!0,n.results.forEach((function(e){for(var t=0;t<e.attributes.length;t++)if("physicalid"===e.attributes[t].name||"resourceid"===e.attributes[t].name){var i=e.attributes[t].value;e.attributes.push({name:"did",value:i}),n.results.push({path:[i]});break}})),t=JSON.stringify(n),e.is(a,"function")&&a(t)},this.fetch(o)}var r=t;r.data.sessions=r.data.session,delete r.data.session,r.data=e.extend({root_path_physicalid:s,expand_iter:"1"},t.data);a=r.onComplete;r.onComplete=function(t){var n=e.is(t,"string")?JSON.parse(t):t;n.full_path=!1,t=JSON.stringify(n),e.is(a,"function")&&a(t)},this.expand(r)},getDerivedOutputs:function(e){console.group(),console.log("======================================="),console.log("== LWCDirectAccess.getDerivedOutputs =="),console.log("== Fallback on WSAccessV1            =="),console.log("======================================="),console.groupEnd(),require(["DS/PADUtils/utilsWS/WSAccessV1"],(function(t){t.getDerivedOutputs(e)}))},_buildPredefinedComputation:function(e){var t=["boundingbox"];return-1!==e.indexOf("thumbnail_3d")?t.push("thumbnail_3d_fallback_cgr"):-1!==e.indexOf("stepcgr")?t.push("urlstream|cgr|stepcgr"):-1!==e.indexOf("cgr")?t.push("cgr"):t=t.concat(e),t}};return u})),define("DS/PADUtils/PADWSProxy",["UWA/Core","DS/WAFData/WAFData","DS/PADUtils/PADUtilsServices","UWA/Promise","DS/PADUtils/utilsWS/WSUtils","require"],(function(e,t,n,i,s,o){function a(e,t,n){return new i((function(i,o){t.onComplete=function(e){var t=function(e){return"string"==typeof e?JSON.parse(e):e}(e),s=t;n&&(s=n(t)),i(s)},t.onFailure=function(e){o(e)},t.data&&(t.data=JSON.stringify(t.data)),s.executeRequest(e,t,!1)}))}return{getcainfo:function(e){var t=o("DS/PADUtils/PADSettingsMgt"),i=e||{},s=n.get3DSpaceUrl()+"/resources/modeler/change/changeaction/pid:"+e.id+"?attributes=1&context=1&people=1&applicability=1&proposed=1&realized=1";return i.method="GET",i.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":t.getSetting("lang")},a(s,i)}}})),define("DS/PADUtils/PADChangeActionHandler",["DS/PADUtils/PADWSProxy","DS/PADUtils/views/PADAlert","DS/PADUtils/PADTypesMgt","i18n!DS/PADUtils/assets/nls/PADUtils.json"],(function(e,t,n,i){function s(e,t){var n=[];if(!1===t)for(var i=0;i<e.length;i++)e[i].amo.forEach((function(e){var t=o(e.after.instanceof?e.after.instanceof.id:e.after.id);a(n,t)}));else for(var s=0;s<e.length;s++){var r=e[s],l=r.id;!0===t&&(l=r.where.id);var c=o(l);a(n,c)}return n}function o(e){return e.substr(e.indexOf(":")+1)}function a(e,t){-1===e.indexOf(t)&&e.push(t)}function r(e,t){for(var n=0;n<t.length;n++)a(e,t[n])}return{extractIds:s,extractRealizedAndProposed:function(e){var t=s(e.changeaction.realized,!0),n=s(e.changeaction.proposed,!0),i=s(e.changeaction.realized,!1);return r(t,n=n.concat(i)),t},getInfos:function(n,s,o){for(var a=[],r=0;r<n.length;r++){var l=e.getcainfo({id:n[r]});a.push(l)}Promise.all(a).then((function(e){s(e)})).catch((function(e){t.displayNotification({eventID:"error",msg:i.generic_service_failure,key:"padUtils-getInfos-generic-service-failure"}),console.error(e),o&&o(e)}))},determineExecution:async function(e,o){let a=!1;if(e.checkTypes){var l=[],c=[];e.changeaction.context&&e.changeaction.context.map((function(e){-1===l.indexOf(e.info.type)&&(l.push(e.info.type),c.push({type:e.info.type,displayType:e.info.typeNLS}))})),e.changeaction.realized&&e.changeaction.realized.map((function(e){-1===l.indexOf(e.where.info.type)&&(l.push(e.where.info.type),c.push({type:e.where.info.type,displayType:e.where.info.typeNLS}))})),a=await async function(e){return new Promise((function(t){n.isTypesAuthorized(e,((e,n)=>{t(!0===n.unsupportedDropNotified)}),!0,!1,"2.0")}))}(c)}if(!0!==a)if(e.changeaction.context.length>0&&e.changeaction.realized.length>0)o.addAndFind(e);else{var d=(h=(p=(p=[]).concat(s((u=e).changeaction.context))).length,r(p,s(u.changeaction.realized,!0)),p.length>h&&r(p,s(u.changeaction.proposed,!0)),p);d.length>0?o.add(d):(t.displayNotification({eventID:"warning",msg:i.WARN_empty_change_action}),o.wasEmpty())}else o.wasEmpty();var u,p,h}}})),define("DS/PADUtils/utilsWS/WSAccessV2",["UWA/Core","DS/PADUtils/PADSession","DS/PADUtils/Configuration","DS/PADUtils/utilsWS/WSAdmin","DS/PADUtils/utilsWS/WSMiscellaneous","DS/PADUtils/utilsWS/LWCDirectAccess","DS/PADUtils/utilsWS/CVServletServices","DS/PADUtils/utilsWS/WS4DECModel","DS/PADUtils/PADSettingsMgt"],(function(e,t,n,i,s,o,a,r,l){"use strict";var c={version:2,fetch:function(e){var i=!1;return!1===n.getConfig("readOnlyApp")&&(i=e.data&&void 0!==e.data.authored?e.data.authored:t.determineAuthoredFlag()),!0===i?o.fetch(e):a.fetch(e)},navigate:function(e){var i=!1;if(!1===n.getConfig("readOnlyApp")&&!0===e.enopad_webapis&&(i=e.data&&void 0!==e.data.authored?e.data.authored:t.determineAuthoredFlag()),!0===i)return e.data.timeout&&(e.timeout=e.data.timeout),o.expand(e);var s="explore_2D"===e.data.intent?"expand":void 0===e.expand3DType?"expand3D":e.expand3DType;return"expand"===s?a.expand(e):(e.expand3DType=s,a.expand3d(e))},navigateV2:function(e){return!0===l.getSetting("activateFUN142888")?o.expandV2progressive(e):o.expandV2(e)},multiexpand:function(e){var i=!1;return!1===n.getConfig("readOnlyApp")&&(i=e.data&&void 0!==e.data.authored?e.data.authored:t.determineAuthoredFlag()),!0===i&&console.warn("No multiexpand in authoring mode. Call on the index instead"),a.multiexpand(e)},progressiveExpand:function(e){var n=null;if(!e.readOnly&&t.determineAuthoredFlag()){var i={data:{select_rel:e.data.select_rel,select_bo:e.data.select_bo,compute_select_bo:e.data.compute_select_bo,boundingbox:e.data.boundingbox,root_path_physicalid:e.data.root_path_physicalid,fcs_url_mode:e.data.fcs_url_mode,expand_iter:e.data.expand_iter,intent:"explore_3d"},onComplete:e.onComplete,onFailure:e.onFailure,onTimeout:e.onTimeout,timeout:6e4,FBIProxy:e.FBIProxy};n=this.navigateV2(i)}else n=a.progressiveExpand(e);return n},progressiveExpandVDRP:function(e){var n=null;if(!e.readOnly&&t.determineAuthoredFlag()){var i={data:{select_rel:e.data.select_rel,select_bo:e.data.select_bo,compute_select_bo:e.data.compute_select_bo,boundingbox:e.data.boundingbox,root_path_physicalid:e.data.root_path_physicalid,fcs_url_mode:e.data.fcs_url_mode,expand_iter:e.data.expand_iter,intent:"explore_3d"},onComplete:e.onComplete,onFailure:e.onFailure,onTimeout:e.onTimeout,timeout:6e4,FBIProxy:e.FBIProxy};n=this.navigateV2(i)}else n=a.progressiveExpandVDRP(e);return n},getRootStats:function(e){var n=null;if(!e.readOnly&&t.determineAuthoredFlag()){var i={data:{select_rel:e.data.select_rel,select_bo:e.data.select_bo,compute_select_bo:e.data.compute_select_bo,boundingbox:!0,root_path_physicalid:e.data.root_path_physicalid?e.data.root_path_physicalid:[[e.data.rootPhID]],fcs_url_mode:e.data.fcs_url_mode,expand_iter:"0",intent:"explore_3d"},onComplete:function(e,t,n){try{var i="string"==typeof n?JSON.parse(n):n;i.results&&i.results.length&&(i.results.push({synthesis:{name:"ProgressiveExpand_FlatSynthesis",value:-1}}),i.results.push({synthesis:{name:"ProgressiveExpand_OccSynthesis",value:-1}}),i.results.push({synthesis:{name:"ProgressiveExpand_LeafSynthesis",value:-1}})),e(JSON.stringify(i))}catch(e){t()}}.bind(this,e.onComplete,e.onFailure),onFailure:e.onFailure,onTimeout:e.onTimeout,timeout:6e4,FBIProxy:e.FBIProxy};n=this.navigateV2(i)}else n=a.getRootStats(e);return n},getStaticMappingExcludedOccurrences:function(e){return a.getStaticMappingExcludedOccurrences(e)},getFlexibleAssemblies:function(e){return a.getFlexibleAssemblies(e)},volumeQuery:function(e){return a.volumeQuery(e)},volumeQueryV2:function(e){return a.volumeQueryV2(e)},getMinMaxDistanceCandidates:function(e){return a.getMinMaxDistanceCandidates(e)},search:function(e){return a.search(e)},searchV2:function(e){return a.searchV2(e)},getIndexingDate:function(e){return a.getIndexingDate(e)},refresh:function(e){if(e.data.deepRefresh)return a.refresh(e);var i=!1;if(!1===n.getConfig("readOnlyApp")&&(i=e.data&&void 0!==e.data.authored?e.data.authored:t.determineAuthoredFlag()),!i&&e.data.session){for(var s=[],r=0;r<e.data.session.length;r++)s=s.concat(e.data.session[r]);return e.data.root_path_physicalid=s,a.refresh(e)}return o.refresh(e)},getDerivedOutputs:function(e){return o.getDerivedOutputs(e)}};return c=UWA.extend(c,i),c=UWA.extend(c,s),c=UWA.extend(c,r)})),define("DS/PADUtils/utilsWS/PADWSv1",["UWA/Core","DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSession","require"],(function(e,t,n,i,s){"use strict";var o={url:"/resources/enopad/navigate/fetch",verb:"POST"},a={url:"/resources/enopad/navigate/expand",verb:"POST"},r={url:"/resources/enopad/navigate/refresh",verb:"POST"};return{fetch:function(a){var r="",l=a,c=require("DS/PADUtils/PADSettingsMgt");if(!0!==c.getSetting("useLWCWebServices")||!0!==a.enopad_webapis||"stream_2D"===a.data.intent){c.getSetting("pad_security_ctx")&&c.getSetting("pad_security_ctx");if(e.is(a.enopad_webapis)||(a.enopad_webapis=!1),l.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":c.getSetting("lang")},l.timeout||(l.timeout=c.getSetting("webapi_timeout")),!a.enopad_webapis)throw new Error("## PADWSv1.fetch: Invalid inputs enopad_webapis should be set to true");var d=o,u=void 0!==l.data.authored?l.data.authored:i.determineAuthoredFlag();l.method=d.verb,r=n.get3DSpaceUrl()+d.url+"?tenant="+n.getPlatformId();var p={query:"physicalid:"+l.pids.join(" OR physicalid:"),intent:l.data.intent,nresults:l.pids.length,tenant:n.getPlatformId(),authored:u};return void 0===p.include_param_Attributes&&c.getSetting("readsettingsv2")&&(p.include_param_Attributes=!0),l.data=JSON.stringify(p),l.onTimeout=l.onTimeout||l.onFailure,t.executeRequest(r,l)}s(["DS/PADUtils/utilsWS/PADLWCAccess"],(function(e){e.fetch(a)}))},navigate:function(o){var r=n.get3DSpaceUrl(),l=o,c=require("DS/PADUtils/PADSettingsMgt");if(!0!==c.getSetting("useLWCWebServices")||!0!==o.enopad_webapis){var d=a,u=c.getSetting("pad_security_ctx")?c.getSetting("pad_security_ctx"):"preferred";if(e.is(o.enopad_webapis)||(o.enopad_webapis=!1),o.enopad_webapis)r=r+d.url+"?tenant="+n.getPlatformId();else if("explore_2D"===l.data.intent)r=r+"/cvservlet/expand?SecurityContext="+u+"&tenant="+n.getPlatformId();else{switch(o.expand3DType=void 0===o.expand3DType?"expand3D":o.expand3DType,o.expand3DType){case"expand3D":r=r+"/cvservlet/expand3d?SecurityContext="+u+"&tenant="+n.getPlatformId();break;case"wrap":r=r+"/cvservlet/wrap?SecurityContext="+u+"&tenant="+n.getPlatformId();break;case"progressiveExpand":r=r+"/cvservlet/progressiveexpand?SecurityContext="+u+"&tenant="+n.getPlatformId()}delete o.expand3DType,l.data.fcs_url_mode=c.getSetting("enopad3dviewer_useStaticURL")?"REDIRECT":void 0}if(!e.is(r)||!e.is(l,"object"))throw new Error("## PADWSv1.navigate: Invalid inputs");if(!e.is(l.data,"object"))throw new Error("## PADWSv1.navigate: Invalid inputs options.data not found");if(l.method=d.verb,l.headers={Accept:"application/json","Content-Type":"application/json"},l.timeout||(l.timeout=c.getSetting("webapi_timeout")),c.getSetting("readsettingsv2")&&(l.data.include_param_Attributes=!0),o.enopad_webapis){if(c.getSetting("use_gen_expand")&&(l.data.activate="use_gen_expand"),!e.is(l.data.roots)&&e.is(l.data.root_physicalid)?l.data.roots=[{id:l.data.root_physicalid}]:!e.is(l.data.paths)&&e.is(l.data.root_path_physicalid)&&(l.data.paths=l.data.root_path_physicalid),e.is(l.data.level)||(l.data.level=l.data.expand_iter),e.is(l.data.intent)||(l.data.intent="explore_2D"),e.is(l.data.source)||(l.data.source="cstorage"),e.is(l.data.authored)||e.is(l.data.find_path_filter)||(l.data.authored=void 0!==l.data.authored?l.data.authored:i.determineAuthoredFlag()),delete l.data.root_physicalid,delete l.data.expand_iter,delete l.data.enopad_webapis,delete l.data.compute_select_bo,delete l.data.select_bo,delete l.data.select_rel,delete l.data.select_ds6w_facet,!e.is(l.data.roots)&&!e.is(l.data.paths))throw new Error("## PADWSv1.navigate: Invalid inputs: no root_physical_id or no root_path_physicalid found")}else{delete l.data.intent,delete l.data.authored;var p=c.getWebAPI_Options("navigate");if(!e.is(l.data.root_physicalid)&&!e.is(l.data.root_path_physicalid)&&!e.is(l.data.paths))throw new Error("## PADWSv1.navigate: Invalid inputs: no root_physical_id or no root_path_physicalid found");!e.is(l.data.root_path_physicalid)&&e.is(l.data.paths)&&(l.data.root_path_physicalid=l.data.paths),e.is(l.data.expand_iter)||e.is(l.find_in_ctx)||(l.data.expand_iter=c.getSetting("expand_iter")),e.is(l.data.select_bo)||(l.data.select_bo=p.select_bo),e.is(l.data.select_rel)||(l.data.select_rel=p.select_rel)}return l.onTimeout=l.onTimeout||l.onFailure,l.data=JSON.stringify(l.data),t.executeRequest(r,l)}s(["DS/PADUtils/utilsWS/PADLWCAccess"],(function(e){e.expand(o)}))},refresh:function(o){var a=require("DS/PADUtils/PADSettingsMgt");if(!0===a.getSetting("useLWCWebServices"))s(["DS/PADUtils/utilsWS/PADLWCAccess"],(function(e){e.refresh(o)}));else{var l=r,c=n.get3DSpaceUrl()+l.url+"?tenant="+n.getPlatformId();if(!e.is(c)||!e.is(o,"object"))throw new Error("## PADWSv1.refresh: Invalid inputs");if(!e.is(o.data,"object"))throw new Error("## PADWSv1.refresh: Invalid inputs - options.data not found");o.method=l.verb,o.headers={Accept:"application/json","Content-Type":"application/json"},a.getSetting("use_gen_expand")&&(o.data.activate="use_gen_expand"),e.is(o.data.intent)||(o.data.intent="explore_2D"),e.is(o.data.source)||(o.data.source="cstorage"),a.getSetting("readsettingsv2")&&(o.data.include_param_Attributes=!0),o.data.authored=o.data.authored?o.data.authored:!i.isUsingIndex(),o.onTimeout=o.onTimeout||o.onFailure,o.data=JSON.stringify(o.data),t.executeSplittedRequest(c,o,{max:1,init:{query:{split:!0},response:{packets:"packets"}},packet:{query:{packet:"packet",remove:["session"]},response:{concat:["results"],copy:["full_path"]}}})}},getDerivedOutputs:function(t){if(!e.is(t)||!e.is(t.pids))throw new Error("## PADWSv1.getDerivedOutputs: Invalid inputs");require("DS/PADUtils/PADSettingsMgt");t.enopad_webapis=!0,e.is(t.data)||(t.data={}),t.data.intent="stream_2D",this.fetch(t)}}})),define("DS/PADUtils/utilsWS/WSAccessV1",["UWA/Core","DS/PADUtils/PADSession","DS/PADUtils/Configuration","DS/PADUtils/utilsWS/WSAdmin","DS/PADUtils/utilsWS/WSMiscellaneous","DS/PADUtils/utilsWS/WS4DECModel","DS/PADUtils/utilsWS/CVServletServices","DS/PADUtils/utilsWS/PADWSv1"],(function(e,t,n,i,s,o,a,r){"use strict";var l={fetch:function(e){return!0!==n.getConfig("readOnlyApp")&&!0===e.enopad_webapis||!0===e.forceAuthoringCall?r.fetch(e):a.fetch(e)},navigate:function(e){if(!0===n.getConfig("readOnlyApp")||!0!==e.enopad_webapis){var t="explore_2D"===e.data.intent?"expand":void 0===e.expand3DType?"expand3D":e.expand3DType;return"expand"===t?a.expand(e):(e.expand3DType=t,a.expand3d(e))}return r.navigate(e)},progressiveExpand:function(e){return a.progressiveExpand(e)},progressiveExpandVDRP:function(e){return a.progressiveExpandVDRP(e)},searchV2:function(e){return a.searchV2(e)},multiexpand:function(e){var i=!1;return!1===n.getConfig("readOnlyApp")&&(i=e.data&&void 0!==e.data.authored?e.data.authored:t.determineAuthoredFlag()),!0===i&&console.warn("No multiexpand in authoring mode. Call on the index instead"),a.multiexpand(e)},volumeQuery:function(e){return a.volumeQuery(e)},refresh:function(e){return e.data.deepRefresh?a.refresh(e):r.refresh(e)},getDerivedOutputs:function(e){require(["DS/PADUtils/utilsWS/PADWSv1"],(function(t){t.getDerivedOutputs(e)}))}};return l=e.extend(l,i),l=e.extend(l,s),l=e.extend(l,o)})),define("DS/PADUtils/PADWSAccess",["DS/PADUtils/Configuration","DS/PADUtils/utilsWS/WSAccessV1","DS/PADUtils/utilsWS/WSAccessV2"],(function(e,t,n){return!0===e.getConfig("WSAccessV2")?n:t}));