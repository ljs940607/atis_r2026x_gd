define("DS/Controls/ModalContainer",["require","exports","DS/Utilities/Utils","css!DS/Core/wux.css"],(function(e,t,i){"use strict";function n(e){return!!e.getContent}return function(){function e(){}return e.createModal=function(e,t,s){if(e){if("static"===window.getComputedStyle(e).getPropertyValue("position"))throw"The given container is not positionned. Please position your container before creating a modalContainer on it.";e.classList.add("modalElement");var o=i.getDocumentOwner(e).createElement("div");if(o.classList.add("wux-controls-modalContainer"),s&&s.transparentFlag&&o.classList.add("wux-transparent"),o.setStyle=function(e,t){o.style[e]=t},t){var l=n(t)?t.getContent():t;l.classList.add("wux-controls-modalContent"),o.appendChild(l)}e.appendChild(o)}},e.removeModal=function(e){if(e){var t=void 0,i=void 0,s=n(e)?e.getContent():e,o=s.children;if(o.length>0)for(var l=0;l<o.length;l++)if(o[l].classList.contains("wux-controls-modalContainer")){t=o[l];break}t&&((i=t.querySelector(".wux-controls-modalContent"))&&(i.classList.remove("wux-controls-modalContent"),t.removeChild(i)),t.remove()),s.classList.remove("modalElement")}},e}()})),define("DS/Controls/DecoratorManager",["UWA/Class"],(function(e){"use strict";var t=e.singleton({defaultOptions:{},init:function(e){this._parent(e),this._decorator=null,this._widget=null,this._mapNamesDecorators={}},registerDecorator:function(e,t){this._mapNamesDecorators[e]?console.log("This decoratorID has already been registered"):this._mapNamesDecorators[e]=t},createDecorator:function(e,t,i,n,s){var o=this;this._mapNamesDecorators[e]?console.log("This decorator has already been registered"):require([n],(function(n){var l=new n({widget:t,decoratedWidget:i});o.registerDecorator(e,l),s.call(o)}))},showDecorator:function(e,t,i){this._widget=e,this._decorator&&this._decorator.hide(!0),i||(i=e.name),void 0===this._mapNamesDecorators[i]?console.log("DecoratorManager: Decorator has not been registered"):(this._decorator=this._mapNamesDecorators[i],this._decorator.setProperties({decoratedWidget:t,widget:e}),this._decorator.show())},hideDecorator:function(e,t){this._widget&&(null===this._widget.getContent().getAttributeNode("focused")||t)&&this._decorator.hide(e)},getWidget:function(){return this._widget},getDecorator:function(){return this._decorator},isDecoratorDisplayed:function(){return this._decorator&&this._decorator.visibleFlag}});return t})),define("DS/Controls/Stack",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core"],(function(e,t,i){"use strict";var n={horizontal:"inline-block",vertical:"block"},s=i.extend({defaultOptions:{orientation:"horizontal",class:"",styles:{margin:0,padding:0}},init:function(e){this._parent(e),this._stackCells=[],this._stackCellsContainers=[],this._totalWeight=0,this.buildSkeleton(),this.addEvent("onPostInject",this._onPostInject)},buildSkeleton:function(){this.elements.container=new e.Element("ul",{class:"Stack "+this.options.class,styles:this.options.styles})},toggleOrientation:function(){},append:function(t,i){i=e.extend({weight:0,styles:null},i);var s=new e.Element("li",{styles:{display:n[this.options.orientation]},html:t,events:i.events});s.addClassName(i.class),s.setStyles(i.styles),this._totalWeight+=parseInt(i.weight,10),s.inject(this.elements.container);var o={container:s,options:i};return this._stackCellsContainers.push(s),this._stackCells.push(o),o},getElements:function(){return this._stackCells},getElementsContainers:function(){return this._stackCellsContainers},remove:function(e){var t=this._stackCells.indexOf(e);-1!==t&&(this._stackCellsContainers[t].destroy(),this._stackCells.splice(t,1),this._stackCellsContainers.splice(t,1))},_onPostInject:function(){var e=this,t=0;this._stackCells.forEach((function(i){var n;if(n=i.options.weight/e._totalWeight*100,i.options.weight)if("horizontal"===e.options.orientation){var s=t;t+=n,i.container.setStyles({left:s+"%",width:n+"%",top:0,bottom:0})}else i.container.setStyles("height",n+"%");0}))}});return e.namespace("WUX/Controls/Stack",s)})),define("DS/Controls/_private/MkmkMagic",["DS/WUXAutoComplete/AutoComplete"],(function(e){"use strict";return{AutoComplete:e}})),define("DS/Controls/LayerSet",["UWA/Core","UWA/Event","UWA/Controls/Abstract"],(function(e,t,i){"use strict";var n=i.extend({defaultOptions:{styles:{}},init:function(e){this._parent(e),this._buildSkeleton()},_buildSkeleton:function(){this.elements.container=new e.Element("div",{class:"LayerSet",styles:this.options.styles}),this.elements._inner=new e.Element("div",{class:"Content"}),this.elements._inner.inject(this.elements.container)},addLayer:function(t,i){void 0===i&&(i={left:0,right:0,top:0,bottom:0});var n=new e.Element("div",{class:"Content"});return n.setStyle("position","absolute"),n.setStyles(i),t.inject(n),n.inject(this.elements._inner),n}});return e.namespace("Controls/LayerSet",n)}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Scroller",["require","exports","UWA/Core","UWA/Controls/Abstract","DS/CoreEvents/ModelEvents","DS/Utilities/Utils","DS/Utilities/WUXUWAUtils","DS/WUXTypings/typings/UWA","DS/WUXTypings/typings/WEBUX","DS/Utilities/typings/types"],(function(e,t,i,n,s,o,l){"use strict";var a={eventPeriod:0,scrollDebounceTimeout:0,scrollEndTimeout:201,useRequestAnimationFrame:!1,events:{onScrollBegin:null,onScroll:null,onScrollEnd:null}};var r=function(e){function t(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var r=e.apply(this,n)||this;return l.extendingClassFlag||(r.options=Object.assign(i.clone(a),r.options),r._modelEvents=new s({callMode:"asc"}),r._target=t,r._beginScrollPosition={x:0,y:0},r._scrollPosition={x:0,y:0},r._lastScrollPosition=r._scrollPosition,r._scrollDirection={x:0,y:0},r._overflow={horizontal:void 0,vertical:void 0},r._lastScrollDirection=r._scrollDirection,r._scrollEndTimeOut=null,r._buildSkeleton(),r._bindBehaviors(),r._modelEvents.publish({event:"INIT",context:r})),r}return __extends(t,e),t.prototype._buildSkeleton=function(){var e=new i.Element("div",{class:"wux-scroller",styles:{position:"absolute",left:0,right:0,top:0,bottom:0}});e.dsModel=this,this.elements.container=e,this.elements.container.append(this._target)},t.prototype.onInit=function(e){return this._modelEvents.subscribe({event:"INIT"},e)},t.prototype.onScrollBegin=function(e){return this._modelEvents.subscribe({event:"SCROLL_START"},e)},t.prototype.onScroll=function(e){return this._modelEvents.subscribe({event:"SCROLL"},e)},t.prototype.onScrollEnd=function(e){return this._modelEvents.subscribe({event:"SCROLL_END"},e)},t.prototype.unsubscribe=function(e){this._modelEvents.unsubscribe(e)},t.prototype._onVerticalScrollDirectionChanged=function(e){return this._modelEvents.subscribe({event:"VERTICAL_SCROLL_DIRECTION_CHANGED"},e)},t.prototype._onHorizontalScrollDirectionChanged=function(e){return this._modelEvents.subscribe({event:"HORIZONTAL_SCROLL_DIRECTION_CHANGED"},e)},t.prototype._updatePosition=function(){this.elements.container&&this.setPosition({x:this.elements.container.scrollLeft,y:this.elements.container.scrollTop})},t.prototype.isInScrollTransaction=function(){return null!==this._scrollEndTimeOut},t.prototype._bindBehaviors=function(){var e,t=this,n=!0;function s(){t._modelEvents.publish({event:"SCROLL",context:t})}var l=o.debounce(s,t.options.scrollDebounceTimeout);function a(i,o){t._updatePosition(),t.elements.verticalScrollbar&&t.elements.horizontalScrollbar&&t._updateScrollingFeedbacks(),n&&(t._beginScrollPosition=t.getPosition(),t._modelEvents.publish({event:"SCROLL_START",context:t}),n=!1),clearTimeout(t._scrollEndTimeOut),t.options.useRequestAnimationFrame&&!t._animationFrameRequested&&(t._animationFrameRequested=!0,e=requestAnimationFrame(r)),t._deltaPositionFromBeginning={x:t._scrollPosition.x-t._beginScrollPosition.x,y:t._scrollPosition.y-t._beginScrollPosition.y},t.options.useRequestAnimationFrame||(t.options.scrollDebounceTimeout>0?l():s()),t._scrollEndTimeOut=setTimeout((function(){t._scrollEndTimeOut=null,t._deltaPositionFromBeginning={x:0,y:0},t.options.useRequestAnimationFrame&&cancelAnimationFrame(e),t._modelEvents.publish({event:"SCROLL_END",context:t}),n=!0}),t.options.scrollEndTimeout)}function r(){t.options.scrollDebounceTimeout>0?l():s(),t._animationFrameRequested=!1}var h=!1;try{var u=Object.defineProperty({},"passive",{get:function(){h=!0}});window.addEventListener("testPassive",null,u),window.removeEventListener("testPassive",null,u)}catch(e){}if(this.options.scrollDebounceTimeout){var c=o.debounce((function(e){a()}),this.options.scrollDebounceTimeout);this.elements.container.addEventListener("scroll",c,!!h&&{passive:!0})}else this.elements.container.addEventListener("scroll",a,!!h&&{passive:!0});i.Element.addEvent.call(this.elements.container,"wheel",(function(e){if(!e.ctrlKey&&!e.shiftKey){var i=function(e){var t=0,i=0,n=0,s=0;return"detail"in e&&(i=e.detail),"wheelDelta"in e&&(i=-e.wheelDelta/120),"wheelDeltaY"in e&&(i=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),n=10*t,s=10*i,"deltaY"in e&&(s=e.deltaY),"deltaX"in e&&(n=e.deltaX),(n||s)&&e.deltaMode&&(1===e.deltaMode?(n*=40,s*=40):(n*=800,s*=800)),n&&!t&&(t=n<1?-1:1),s&&!i&&(i=s<1?-1:1),{spinX:t,spinY:i,pixelX:n,pixelY:s}}(e),n=Math.abs(i.pixelY),s=0;if(i.pixelY<0&&0===t.elements.container.scrollTop||i.pixelY>0&&t.elements.container.scrollHeight-t.elements.container.scrollTop===t.elements.container.clientHeight)return;for(e.preventDefault();s<=n;){s+=50;var o=t.elements.container.scrollTop+50*i.spinY;t.elements.container.scrollTop=o}}}))},t.prototype.setPosition=function(e,t){void 0===e.x&&(e.x=this.elements.container.scrollLeft),void 0===e.y&&(e.y=this.elements.container.scrollTop),t&&(this.elements.container.scrollTop=e.y,this.elements.container.scrollLeft=e.x,"immediate"!==t)||(this._lastScrollDirection=this._scrollDirection,this._scrollDirection={x:this._scrollPosition.x-this._lastScrollPosition.x>0?1:-1,y:this._scrollPosition.y-this._lastScrollPosition.y>0?1:-1},0!==this._lastScrollDirection.y&&this._lastScrollDirection.y!==this._scrollDirection.y&&this._modelEvents.publish({event:"VERTICAL_SCROLL_DIRECTION_CHANGED",context:this}),0!==this._lastScrollDirection.x&&this._lastScrollDirection.x!==this._scrollDirection.x&&this._modelEvents.publish({event:"HORIZONTAL_SCROLL_DIRECTION_CHANGED",context:this}),this._lastScrollPosition=this._scrollPosition,this._scrollPosition=e)},t.prototype._resetDeltaScrollPositionFromBeginning=function(){this._beginScrollPosition={x:this._scrollPosition.x,y:this._scrollPosition.y},this._deltaPositionFromBeginning={x:0,y:0}},t.prototype.getDeltaScrollPositionFromBeginning=function(){return this._deltaPositionFromBeginning},t.prototype.resetPosition=function(){this.setPosition({x:0,y:0}),this.setPosition({x:0,y:0},!0)},t.prototype.getPosition=function(e){return e?{x:this.elements.container.scrollLeft,y:this.elements.container.scrollTop}:this._scrollPosition},t.prototype.getDeltaScrollPosition=function(){return{x:this._scrollPosition.x-this._lastScrollPosition.x,y:this._scrollPosition.y-this._lastScrollPosition.y}},t.prototype.showScrollingFeedbacks=function(){this._scrollingFeedbacksDisplayed=!0,this.elements.scrollbarContainer||(this.elements.scrollbarContainer=new i.Element("div",{class:"wux-scroller-scrollbarContainer"}).inject(this.elements.container)),this.elements.verticalScrollbar||(this.elements.verticalScrollbar=new i.Element("div",{class:"wux-vertical-scrollbar"}).inject(this.elements.scrollbarContainer)),this.elements.horizontalScrollbar||(this.elements.horizontalScrollbar=new i.Element("div",{class:"wux-horizontal-scrollbar"}).inject(this.elements.scrollbarContainer)),this._updateScrollingFeedbacks(),this.elements.verticalScrollbar.classList.remove("wux-scrollbar-hidden"),this.elements.horizontalScrollbar.classList.remove("wux-scrollbar-hidden"),"hidden"!==this._overflow.vertical&&this.elements.verticalScrollbar.classList.add("wux-scrollbar-visible"),"hidden"!==this._overflow.horizontal&&this.elements.horizontalScrollbar.classList.add("wux-scrollbar-visible")},t.prototype._updateScrollingFeedbacks=function(){if(this.elements.verticalScrollbar&&this.elements.horizontalScrollbar){var e=this.getContent().getDimensions(),t=this.getContent().scrollHeight,i=t>0?e.height/t:1,n=Math.max(Math.round((e.height-12)*i),40),s=t>0?this._scrollPosition.y/(t-e.height):0,o=this._scrollPosition.y+Math.floor((e.height-12-n)*s)+6,l=this._scrollPosition.x+e.width-6,a=this.getContent().scrollWidth,r=a>0?e.width/a:1,h=Math.max(Math.round((e.width-12)*r),40),u=a>0?this._scrollPosition.x/(a-e.width):0,c=this._scrollPosition.y+e.height-6,d=this._scrollPosition.x+Math.floor((e.width-12-h)*u)+6;i>=1?this.elements.verticalScrollbar.hide():(this.elements.verticalScrollbar.show(),this.elements.verticalScrollbar.setStyle("height",n+"px"),this.elements.verticalScrollbar.setStyle("top",o+"px"),this.elements.verticalScrollbar.setStyle("left",l+"px")),r>=1?this.elements.horizontalScrollbar.hide():(this.elements.horizontalScrollbar.show(),this.elements.horizontalScrollbar.setStyle("width",h+"px"),this.elements.horizontalScrollbar.setStyle("top",c+"px"),this.elements.horizontalScrollbar.setStyle("left",d+"px"))}},t.prototype.hideScrollingFeedbacks=function(){this._scrollingFeedbacksDisplayed&&this.elements.verticalScrollbar&&this.elements.horizontalScrollbar&&(this.elements.verticalScrollbar.classList.remove("wux-scrollbar-visible"),this.elements.horizontalScrollbar.classList.remove("wux-scrollbar-visible"),this.elements.verticalScrollbar.classList.add("wux-scrollbar-hidden"),this.elements.horizontalScrollbar.classList.add("wux-scrollbar-hidden")),this._scrollingFeedbacksDisplayed=!1},t.prototype.areScrollbarsDisplayed=function(e){var t=this.getContent();return e&&"vertical"===e?t.scrollHeight>t.offsetHeight&&"hidden"!==this._overflow.vertical:e&&"horizontal"===e?t.scrollWidth>t.offsetWidth&&"hidden"!==this._overflow.horizontal:{vertical:t.scrollHeight>t.offsetHeight&&"hidden"!==this._overflow.vertical,horizontal:t.scrollWidth>t.offsetWidth&&"hidden"!==this._overflow.horizontal}},t.prototype._setOverflow=function(e){e&&(e.hasOwnProperty("horizontal")&&(void 0===e.horizontal?this.getContent().style["overflow-x"]="":this.getContent().style["overflow-x"]=e.horizontal,this._overflow.horizontal=e.horizontal),e.hasOwnProperty("vertical")&&(void 0===e.horizontal?this.getContent().style["overflow-y"]="":this.getContent().style["overflow-y"]=e.vertical,this._overflow.vertical=e.vertical))},t}(n);return r})),define("DS/Controls/typings/types",[],(()=>{})),define("DS/Controls/Deck",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","DS/Maths/Vector3","DS/Utilities/Utils"],(function(e,t,i,n,s,o){"use strict";var l={translate:!0,translate3d:!0,translateX:!0,translateY:!0,translateZ:!0,rotate:!0,rotate3d:!0,rotateX:!0,rotateY:!0,rotateZ:!0,scale3d:!0};return i.extend({init:function(t){this._transitionCounter=0;this.settings=e.extend({selector:null,onComplete:function(){}},t),this.container=document.querySelector(this.settings.container),"string"==typeof this.settings.selector?(this.items=o.listToArray(document.querySelectorAll(this.settings.selector)),n.log("selector is string")):(this.items.push(this.settings.selector),n.log("selector is uwa element")),n.log(this.items),this.currentEffectIndice=0,this.play()},buildSkeleton:function(){var t=this.elements;t.container=new e.Element("div",{class:"AfrActionBar2",events:null}),t.itemContainer=t.container},_attachTransition:function(){var e=this;this._transitionCounter=this.items.length,this.items.forEach((function(t){t.style.webkitTransition=e.settings.duration+"ms "+e.settings.ease})),setTimeout((function(){e.nextEffect()}),e.settings.duration)},_dettachTransition:function(){this.items.forEach((function(e){e.style.webkitTransition=""}))},initial:function(){this.items.forEach((function(e){e.style.webkitTransform=""}))},play:function(e){void 0===e&&(e=0);var t=this.settings.distributions[e];if(t){var i,n=this,s=this.items.length;this._attachTransition(),setTimeout((function(){for(i=0;i<s;i++)n._iterate(i,n.items[i],t)}),10)}},_iterate:function(e,t,i){var o=t.style.webkitTransform;for(var a in i)if("string"==typeof i[a])t.style[a]=i[a];else{var r=i[a](e,t,this.items);if(l[a]){var h="",u="";switch(a){case"scale3d":u=/scale3d\((-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?)\)/,h=new s([r.x,r.y,r.z]).toString();break;case"translate3d":u=/translate3d\((-?\d+(?:\.\d*)?)px, (-?\d+(?:\.\d*)?)px, (-?\d+(?:\.\d*)?)px\)/,h=new s([r.x,r.y,r.z]).toString();break;case"rotate3d":u=/rotate3d\((-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?), (-?\d+(?:\.\d*)?)rad\)/,h=new s([r.x,r.y,r.z]).toString()+", "+r.a+"rad"}o=o.replace(u,""),o+=" "+a+"("+h+")"}else t.style[a]=r}n.log("transform:"+o),t.style.webkitTransform=o},nextEffect:function(){this.currentEffectIndice++,this.settings.distributions[this.currentEffectIndice]&&this.play(this.currentEffectIndice)}})})),define("DS/Controls/ViewBase",["UWA/Core","UWA/Controls/Abstract","DS/Utilities/Utils","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents"],(function(e,t,i,n,s){"use strict";return t.extend({defaultOptions:{size:"small",view:"thumbnail",menu:[],icon:"",color:null},init:function(t){this._parent(t),this._modelEvents=new s,this.elements.container=this.elements.thumbnail=new e.Element("div",{class:"wux-controls-"+this.options.view+" wux-ui-size-"+this.options.size}),this.elements.picture=new e.Element("div",{class:"wux-controls-"+this.options.view+"-picture"}).inject(this.elements.thumbnail),this.elements.cartouche=new e.Element("div",{class:"wux-controls-"+this.options.view+"-cartouche"}).inject(this.elements.thumbnail),this.elements.cartoucheContent=new e.Element("div",{class:"wux-controls-"+this.options.view+"-cartouche-content"}).inject(this.elements.cartouche),this.elements.color=new e.Element("div",{class:"wux-controls-"+this.options.view+"-color"}).inject(this.elements.cartoucheContent),this.elements.title=new e.Element("div",{class:"wux-controls-"+this.options.view+"-title wux-ui-size-"+this.options.size+" wux-font-3dsregular"}).inject(this.elements.cartoucheContent),this.elements.subtitle=new e.Element("div",{class:"wux-controls-"+this.options.view+"-subtitle",html:"Sous-titre"}).inject(this.elements.cartoucheContent),this.elements.menu=new e.Element("div",{class:"wux-controls-"+this.options.view+"-menu wux-ui-size-"+this.options.size}).inject(this.elements.thumbnail),this.elements.menu.addClassName("wux-ui-3ds"),this.elements.menu.addClassName("wux-ui-3ds-open-down"),this.elements.description=new e.Element("div",{class:"wux-controls-"+this.options.view+"-description"}).inject(this.elements.cartoucheContent)},_attachEvents:function(){var e=this;this.elements.container.addEventListener(n.POINTERUP,(function(t){e._modelEvents.publish({event:"containerUp",context:e})})),this.elements.picture.addEventListener(n.POINTERUP,(function(t){e._modelEvents.publish({event:"pictureUp",context:e})})),this.elements.title.addEventListener(n.POINTERUP,(function(t){e._modelEvents.publish({event:"titleUp",context:e})})),this.elements.subtitle.addEventListener(n.POINTERUP,(function(t){e._modelEvents.publish({event:"subtitleUp",context:e})})),this.elements.description.addEventListener(n.POINTERUP,(function(t){e._modelEvents.publish({event:"descriptionUp",context:e})})),this.elements.cartouche.addEventListener(n.POINTERUP,(function(t){e._modelEvents.publish({event:"cartoucheUp",context:e})}))},onClick:function(e){return this._modelEvents.subscribe({event:"containerUp"},e)},onCartoucheClick:function(e){return this._modelEvents.subscribe({event:"cartoucheUp"},e)},onTitleClick:function(e){return this._modelEvents.subscribe({event:"titleUp"},e)},onSubtitleClick:function(e){return this._modelEvents.subscribe({event:"subtitleUp"},e)},onDescriptionClick:function(e){return this._modelEvents.subscribe({event:"descriptionUp"},e)},onPictureClick:function(e){return this._modelEvents.subscribe({event:"pictureUp"},e)},setColor:function(e){e?(this.elements.container.setAttribute("has-color","true"),this.elements.color.setStyles({background:e}).show()):(this.elements.container.setAttribute("has-color","false"),this.elements.color.hide())},setTitle:function(e){if(this.elements.menu&&this.elements.menu.cellView){this.elements.title.layoutDsModel=this.elements.menu.cellView.getGridEngine();var t=this.elements.menu.cellView.getCellInfos();if(!1===i.getUnsafeHTMLContentValueToApply(this.elements.menu.cellView.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(t)))return void(this.elements.title.textContent=e)}this.elements.title.setHTML(e)},setSubtitle:function(e){if(this.elements.menu&&this.elements.menu.cellView){this.elements.subtitle.layoutDsModel=this.elements.menu.cellView.getGridEngine();var t=this.elements.menu.cellView.getCellInfos();if(!1===i.getUnsafeHTMLContentValueToApply(this.elements.menu.cellView.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(t)))return void(this.elements.subtitle.textContent=e)}this.elements.subtitle.setHTML(e)},setPicture:function(e){this.elements.picture.setStyles({backgroundImage:"url("+e+")"})},setDescription:function(e){if(this.elements.menu&&this.elements.menu.cellView){this.elements.description.layoutDsModel=this.elements.menu.cellView.getGridEngine();var t=this.elements.menu.cellView.getCellInfos();if(!1===i.getUnsafeHTMLContentValueToApply(this.elements.menu.cellView.getGridEngine().options.shouldCellAllowUnsafeHTMLContentAt(t)))return void(this.elements.description.textContent=e)}this.elements.description.setHTML(e)}})})),define("DS/Controls/_private/DateUtilsPrivate",["require","exports","DS/Utilities/LanguageUtils","DS/Utilities/DateUtils"],(function(e,t,i,n){"use strict";var s={};function o(e){e=e||i.regionalFormatLanguage;var t=s[e];if(!t){var n;t={period:!1,dateParts:void 0},s[e]=t;var o,l=new Intl.DateTimeFormat(e,{hour:"numeric",minute:"numeric"});[new Date(2022,1,1,1),new Date(2022,1,1,13)].forEach((function(e){l.formatToParts(e).some((function(e){if("dayPeriod"===e.type)return n||(n=[]),n.push(e.value),!0}))})),2===(null==n?void 0:n.length)&&(t.period=n),new Intl.DateTimeFormat(e,{year:"numeric",month:"numeric",day:"numeric"}).formatToParts(new Date(2022,0,1)).forEach((function(e){var t=e.type;"year"!==t&&"month"!==t&&"day"!==t||(o||(o=[]),o.push(t))})),3===(null==o?void 0:o.length)?t.dateParts=o:t.dateParts=["year","month","day"]}return t}return function(){function e(){}return e.parseDateAndTime=function(t,i){if("string"==typeof t&&t){t=t.trim();var s=o(null==i?void 0:i.locale).dateParts,l="/";if(!t.includes("/")){var a=(t.match(/-/g)||[]).length;2!==a&&3!==a||(l="-",s=["year","month","day"])}for(var r=1,h={year:void 0,month:void 0,day:void 0},u=0,c=s.length;u<c;++u){t=t.trim();for(var d=s[u],p="",m=void 0;t;)if(m=t[0],t=t.substring(1),"0"<=m&&m<="9")p+=m;else{if(p||"year"!==d||"-"!==m){if(" "===m){u<2&&(m=(t=t.trimStart())[0],t=t.substring(1));break}break}r=-1}if(u<2&&m!==l)break;2===u&&" "!==m&&t&&(t=m+t);var g=parseInt(p);if(isNaN(g))break;h[d]=g}if(void 0!==h.year&&void 0!==h.month&&void 0!==h.day&&(h.year*=r,h.month-=1,!(h.month<0||h.month>11))){var f,v,y=(f=h.year,v=h.month,[31,n.isLeapYear(f)?29:28,31,30,31,30,31,31,30,31,30,31][v]);if(!(h.day<1||h.day>y)){if(t=t.trim()){var _=e.parseTime(t,i);if(!_)return;return Object.assign({year:h.year,month:h.month,day:h.day},_)}return{year:h.year,month:h.month,day:h.day}}}}},e.parseTime=function(t,i){if("string"==typeof t&&t){var n=!0;if((t=t.trim()).startsWith("T")&&(n=!1,t=t.replace("T","")),!n){if(!/^[0-9][0-9hms:]*$/.test(t))return}var s,l,a,r="";if(n){var h=o(null==i?void 0:i.locale).period;h&&(t.includes(h[1])?(r="pm",t=t.replace(h[1],"")):t.includes(h[0])&&(r="am",t=t.replace(h[0],""))),(t=t.toLowerCase().trim()).endsWith("pm")||t.endsWith("p.m.")?(r="pm",t=t.replace("pm","").replace("p.m.","")):(t.endsWith("am")||t.endsWith("a.m."))&&(r="am",t=t.replace("am","").replace("a.m.",""))}t=e.updateSpaces(t,"");if(/^(\d{1,2})(?::(\d{1,2}))?(?::(\d{1,2}))?$/.test(t)){var u=t.split(":");if(s=parseInt(u[0])||0,l=parseInt(u[1])||0,a=parseInt(u[2])||0,12===s&&"am"===r?s=0:12!==s&&"pm"===r&&(s+=12),!(s<0||s>23||l<0||l>59||a<0||a>59))return{hours:s,minutes:l,seconds:a}}}},e.parseDuration=function(t,i){if("string"==typeof t&&t){var n,s,o,l=!1;if((t=t.trim()).startsWith("PT")&&(t=t.replace("PT","")).includes(":")&&(l=!0),t=(t=e.updateSpaces(t,"")).toLowerCase(),l){var a=t.split(":");n=parseInt(a[0])||0,s=parseInt(a[1])||0,o=parseInt(a[2])||0}else{for(var r=["h","m","s"],h={h:void 0,m:void 0,s:void 0},u=!0,c="h",d=0;d<3&&t;++d){for(var p="",m=void 0;t;){if(m=t[0],t=t.substring(1),!("0"<=m&&m<="9")){if(r.includes(m))break;u=!1;break}p+=m}if(!u)break;if(t&&m<c){u=!1;break}if(p){var g=parseInt(p);if(isNaN(g)){u=!1;break}if(m&&"number"==typeof h[m]){u=!1;break}r.includes(m)||m&&t?h[m]=g:h[c]=g}if(t)if("h"===m)c="m";else if("m"===m)c="s";else if("s"===m){u=!1;break}}if(!u)return;n=h.h,s=h.m,o=h.s}if(!("number"==typeof n&&n<0||"number"==typeof s&&(s<0||s>59)||"number"==typeof o&&(o<0||o>59)))return{hours:n||0,minutes:s||0,seconds:o||0}}},e.updateSpaces=function(e,t){if(void 0===t&&(t=" "),"string"==typeof e)return e.replaceAll(/\s/g,t)},e}()})),define("DS/Controls/CustomizableDecoratorItems",["require","exports","text!DS/Controls/assets/CustomizableDecoratorItems.json","UWA/Core"],(function(e,t,i,n){"use strict";var s=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}return e.getInstance=function(){return e.instance||(e.instance=new e,e.instance._registeredItems={},e.addDecoratorItems(JSON.parse(i))),e.instance},e.addDecoratorItems=function(t){t&&"object"==typeof t&&(e.getInstance()._registeredItems=n.merge(t,e.getInstance()._registeredItems))},e.getItem=function(t){return e.getInstance()._registeredItems[t]},e}();return s})),define("DS/Controls/TooltipLoader",["require","exports","DS/Core/TooltipLoader"],(function(e,t,i){"use strict";return console.error("'DS/Controls/TooltipLoader' is deprecated, use 'DS/Core/TooltipLoader' instead."),i})),define("DS/Controls/Switch",["UWA/Core","UWA/Controls/Abstract","DS/Utilities/UUID","DS/CoreEvents/ModelEvents"],(function(e,t,i,n){"use strict";var s="EVT_CHANGE";return t.extend({defaultOptions:{label:null,value:!1,onChange:null,size:"mid"},init:function(e){console.warn("/!\\************************************   WEB UX TEAM    ***************************************/!\\"),console.warn("/!\\*********************       MESSAGE TO THE SWITCH CONTROL USERS         *********************/!\\"),console.warn("/!\\*********************         Switch control is deprecated              *********************/!\\"),console.warn("/!\\*********************     Please migrate to the Toggle control asap     *********************/!\\"),console.warn("/!\\*********************     Please see the Toggle API in the Showroom     *********************/!\\"),console.warn("/!\\*********************************************************************************************/!\\"),this._parent(e),this.options.size="mid",this._uuid=i.v4(),this._modelEvents=new n,this._buildView(),this.setValue(this.options.value,!1),this._proxifyEvents()},_buildView:function(){this.elements.container=new e.Element("ul",{class:"wux-ui-stack-h wux-controls-switch wux-ui-size-"+this.options.size,styles:{display:this.options.label?"block":"inline-block"}}),this.options.label&&(this.elements.label=new e.Element("li",{class:"wux-controls-switch-label",html:this.options.label}).inject(this.elements.container)),this.elements.switchContainer=new e.Element("li",{class:"wux-controls-switch-container"}).inject(this.elements.container),this.elements.checkbox=new e.Element("input",{class:"wux-controls-switch-checkbox",id:"wux-controls-switch-"+this._uuid,type:"checkbox"}).inject(this.elements.switchContainer),this.elements.outer=new e.Element("label",{class:"wux-controls-switch-outer",for:"wux-controls-switch-"+this._uuid,type:"checkbox"}).inject(this.elements.switchContainer),this.elements.inner=new e.Element("div",{class:"wux-controls-switch-inner"}).inject(this.elements.outer),this.elements.button=new e.Element("div",{class:"wux-controls-switch-button"}).inject(this.elements.outer)},_proxifyEvents:function(){var e=this;this.elements.container.addEvent("click",(function(t){t.stopPropagation(),e.setValue(!e.elements.checkbox.checked)})),this.elements.checkbox.addEventListener("change",(function(e){e.stopPropagation()})),this.elements.container.addEvent("mousedown",(function(e){e.stopPropagation()})),this.elements.container.addEvent("mouseup",(function(e){e.stopPropagation()}))},onChange:function(e){return this._modelEvents.subscribe({event:s},e)},getValue:function(){return this.elements.checkbox.checked},setValue:function(e,t){var i=this;void 0===t&&(t=!0),this.elements.checkbox.checked=e,this.elements.checkbox.checked?(this.elements.container.setAttribute("checked","true"),this.elements.checkbox.setAttribute("checked","true")):(this.elements.container.removeAttribute("checked"),this.elements.checkbox.removeAttribute("checked")),t&&(i.options.onChange&&i.options.onChange.call(i,i.getValue()),i._modelEvents.publish({context:i,event:s,data:i}))}})})),define("DS/Controls/TreeNodeBase",["UWA/Core","UWA/Controls/Abstract","DS/Core/Core","DS/UIBehaviors/Draggable","DS/UIBehaviors/Droppable","UWA/Utils/Client"],(function(UWA,Abstract,WUX,WUXDraggable,WUXDroppable,UWAClient){"use strict";var FX_DURATION=200,NAVIGATOR=UWAClient.Engine,DEBUG=!1;function wux_move(e,t,i){if(i>=e.length)for(var n=i-e.length;1+n--;)e.push(void 0);return e.splice(i,0,e.splice(t,1)[0]),e}function cleanArray(e){for(var t=[],i=0;i<e.length;i++)e[i]&&t.push(e[i]);return t}var TreeNodeBase=Abstract.extend({defaultOptions:{expandAtInit:!1,isFakeRoot:!1,isRoot:!1,isEditable:void 0,isDraggable:void 0,node:null,tree:null,animateOnExpand:!1,onPreExpand:null,onPostExpand:null,onPreCollapse:null,onPostCollapse:null,UI:"default",rowIndex:null,data:null,renderSaver:100,allowTextCopy:!1},init:function(e){this._parent(e),this.options=UWA.extend(this.options,e),this._uuid=UWA.Utils.getUUID(),this._nodeDepth=-1,this._childrenSlots=[],this._children="array"===UWA.typeOf(this.options.children)?[]:null,this._childID=null,this._isExpanded=!1,this._isInTreeListView=!1,this._hasBeenAttached=!1,this._rowIndex=null,this._isInWriteMode=!1,this._updateViewTimeout=null;var t=this;this._modeIsExpandAll=!1,this._modeIsMultiSel=!1,UWA.typeOf(this.options.UI),this.buildSkeleton(),this.options.isRoot&&this._attachToView(),UWA.Element.addEvent.call(document,"keydown",(function(e){"ctrl"!==UWA.Event.whichKey(e)||t._modeIsMultiSel||(t._modeIsMultiSel=!0)})),UWA.Element.addEvent.call(document,"keyup",(function(e){"ctrl"===UWA.Event.whichKey(e)&&(t._modeIsMultiSel=!1)}))},delegateEvents:function(){WUX.warn("deprecated","don't use anymore the method delegateEvents on TreeNode")},getParent:function(){return this._parentNode},getRoot:function(){for(var e=this;e&&!e.options.isRoot;)e=e.getParent();return e},getPath:function(){for(var e=this,t="";e&&!e.options.isRoot;)e.elements.label&&e.elements.label.getText()&&(t=e.elements.label.getText()+" > "+t),e=e.getParent();return t},isAscendantOf:function(e){for(var t=e;t&&!t.options.isRoot;)if((t=t.getParent())===this)return!0;return!1},highlight:function(e){void 0===e?this.elements.label.addClassName("wux-datagrid-cell-highlighted"):this.elements.label.setStyles(e)},unhighlight:function(){this.elements.label.removeClassName("wux-datagrid-cell-highlighted")},setLabel:function(e,t){void 0===t&&(t=!0),this.options.label=e,this.isInWriteMode()?this.switchToWriteView():this.switchToReadView();var i=this.getTree();i&&t&&i._modelEvents.publish({context:this,event:"UPDATE_LABEL",data:e})},getLabel:function(){return this.options.label},isInWriteMode:function(){return this._isInWriteMode},switchToWriteView:function(){var e=this,t=this.options,i=this.options.isEditable;void 0===i.switchToWriteView.callback&&(i.switchToWriteView.callback=function(e){this.switchToWriteView()});var n=t.label;this.elements._readWriteContainer=i.switchToWriteView.view.call(this,this),this.elements._readWriteContainer.addEvent("change",(function(e){n=this.value})),i.switchToReadView.event.split(" ").forEach((function(t){e.elements._readWriteContainer.addEvent(t,(function(t){i.switchToReadView.callback.call(e,t,e),e._isInWriteMode=!1,e.setLabel(n)}))})),this.elements.label.setContent(this.elements._readWriteContainer),this.elements._readWriteContainer.focus(),this._isInWriteMode=!0},switchToReadView:function(){var e=this,t=this.options.isEditable;t&&t.switchToReadView&&t.switchToWriteView?(void 0===t.switchToReadView.callback&&(t.switchToReadView.callback=function(e){this.switchToReadView()}),this.elements._readOnlyContainer=t.switchToReadView.view.call(this,this),t.switchToWriteView.event.split(" ").forEach((function(i){e.elements._readOnlyContainer.addEvent(i,(function(i){t.switchToWriteView.callback.call(e,i,e)}))}))):this.elements._readOnlyContainer=new UWA.Element("div",{html:this.options.label});this.elements.label&&this.elements.label.setContent(this.elements._readOnlyContainer),this._isInWriteMode=!1},addChild:function(e,t){if(e.isAscendantOf(this))console.warn("logical error","You tried to attach a node on one of its descendant, or on itself");else{if(e.getParent()===this){var i=this._children.indexOf(e);wux_move(this._children,i,t),this._children=cleanArray(this._children)}else e.elements.container&&e.elements.container.parentNode&&e.elements.container.parentNode.removeChild(e.elements.container),e.getParent()&&e.getParent().removeChild(e),e.isExpanded()&&e.collapse(),e.options.UI=this.options.UI,e.options.tree=this.options.tree,this.options.tree&&this._onTreeAttach(t),this._children||(this._children=[]),void 0!==t?(this._children.splice(t,0,e),e._childID=this._children.length-1):e._childID=this._children.push(e)-1;e._setParent(this),this._hasBeenAttached=!0}},addChildren:function(e,t){var i=this;this.children.forEach((function(e){i.addChild(e,t)}))},_setParent:function(e){if(this._parentNode=e,e){var t=e.getNextBrothersNodes();t.length&&t[0]._updateView(!1),e._updateView(e._isExpanded,e._isExpanded)}this._inheritFromTree(),this.getParent()&&this.getParent().getParent()&&this.getParent().getParent()._updateView(!1)},_inheritFromTree:function(){if(null===this.options.isEditable||void 0===this.options.isEditable){var e=this.getTree();e&&e.options.isEditable&&(this.options.isEditable={},UWA.extend(this.options.isEditable,e.options.isEditable,!0))}},_unsetParent:function(){var e=this.getParent();this._dettachFromView();var t=this.getPrevBrotherNode(),i=e.getChildren().splice(this._childID,1)[0];return t&&t._updateView(),0===e.getChildren().length&&e._isExpanded&&(e._isExpanded=!1),e&&e._updateView(),this._setParent(null),i},_onTreeAttach:function(){this._buildExpander(!1);var e=this.getChildren();e&&e.forEach((function(e){e._onTreeAttach()}))},removeChild:function(e,t){void 0===t&&(t=!0),e.getContent().destroy();var i=this._children.indexOf(e);-1!==i&&this._children.splice(i,1),this.getLastChild()&&(this.getLastChild()._buildExpander(!1),this.getLastChild()._buildLink(!0)),t&&this.getChildren()&&0===this.getChildren().length&&(this._children=null),this._buildExpander(!1),this._buildLink(!0)},remove:function(){this.getParent().removeChild(this)},removeChildren:function(){for(var e=this._children.length,t=0;t<e;t++)this._children[t]&&this.removeChild(this._children[t]);this._children=null,this.updateExpanderState()},buildSkeleton:function(e){this.elements.container&&this.elements.container.parentNode&&this.elements.container.parentNode.removeChild(this.elements.container),this.elements.container=new UWA.Element("li",{class:"Container",styles:{position:"relative",overflow:"hidden",minHeight:16}}),this._buildChildrenContainer()},updateExpanderState:function(){this._buildExpander(!1)},_buildExpander:function(e){void 0===e&&(e=!0);var t=this,i=this.options,n=i.UI,s=(n.icon.size-(n.expander.size+2*n.expander.borderSize))/2,o=0;if(this._children)switch(UWA.typeOf(this._children)){case"string":this._expandState="asyncState",this._nodeIsAsync=!0;break;case"array":this._isExpanded?this._expandState="collapseState":this._expandState="expandState",this._nodeIsAsync=!1}else this.isRoot()?this._expandState="noExpandRoot":this._expandState="noExpandState",this._nodeIsAsync=!1,o=n.expander.size*n.expander.borderSize/2,s=n.icon.size/2;var l=this.options.UI[this._expandState];l.styles.marginLeft=o,l.styles.marginTop=s,e?(i&&i.children&&this.elements.container.setAttributes({"data-isExpanded":!1}),this.elements.expander=new UWA.Element("li",l),this.elements.expander.inject(this.elements.view),this.elements.expander.removeEvent("click"),this.elements.expander.addEvent("click",(function(e){t._isExpanded?t.collapse():t.expand()}))):this.elements.expander&&(this.elements.expander.set(this.options.UI[this._expandState]),this.options.UI.shadow&&this.elements.expander.addClassName("Shadow"))},_isLastChild:function(){return this.getParent()&&this.getParent().getChildren().indexOf(this)+1===this.getParent().getChildren().length},_buildLink:function(e){if(!this.options.isRoot){var t=this.options.UI;void 0===e&&(e=!1);var i="bottom",n=-2*t.layout.btMargin+t.icon.size/2+"px";this._isLastChildFlag=this._isLastChild(),this._isLastChild()&&(i="height",n=2*t.layout.btMargin+t.icon.size/2+t.link.size/2+"px");var s=-Number(t.layout.btMargin)+"px";e||(this.elements.verticalLink=new UWA.Element("li",{text:"",class:"Link"}),this.elements.verticalLink.inject(this.elements.container)),this.elements.verticalLink&&(this.elements.verticalLink.setStyles({borderLeft:t.link.size+"px "+t.link.style+" "+t.link.color,top:s,position:"absolute",left:this._marginLeft+t.expander.size/2}),"bottom"===i?this.elements.verticalLink.setStyle("height","auto"):this.elements.verticalLink.setStyle("bottom","auto"),this.elements.verticalLink.setStyle(i,n))}},_buildIcons:function(){var e=this.options;if(e&&e.icons){this.elements.icons=[];for(var t=e.icons.length,i=0;i<t;i++){var n=new UWA.Element("li",{class:"Icon",styles:{marginLeft:this.options.UI.layout.lrMargin,background:"url("+e.icons[i]+")",backgroundSize:"100%"}});n.inject(this.elements.view),this.elements.icons.push(n)}}},setIcon:function(e){if(e=UWA.extend({picture:"",iconID:0},e),this.elements.icons[e.iconID])this.elements.icons[e.iconID].setStyles({marginLeft:this.options.UI.layout.lrMargin,background:"url("+e.picture+")",backgroundSize:"100%"});else{var t=new UWA.Element("li",{class:"Icon",styles:{marginLeft:this.options.UI.layout.lrMargin,background:"url("+e.picture+")",backgroundSize:"100%"}});t.inject(this.elements.view),this.elements.icons[e.iconID](t)}},_buildLabel:function(){var e=this.options,t=this;e.label&&(e.isRoot?this.options.UI.label.fontWeight="bold":this.options.UI.label.fontWeight="normal",this.elements.label=new UWA.Element("li",{class:"wux-treenode-label",styles:this.options.UI.label}),this.elements.label.setStyles(this.options.UI.label),this._isHighlighted&&this.elements.label.setStyles({boxShadow:"inset 0px 0px 7px rgb(0, 133, 255), inset 0 0 200px #0FF"}),this.options.UI.shadow&&this.elements.label.addClassName("Label Shadow"),this.elements.label.setStyles({backgroundColor:e.backgroundColor}),this.elements.label.inject(this.elements.view),this.elements.label.addEvent("click",(function(e){var i=t.getTree();i.options.onClick&&i.options.onClick.apply(t,t,t.options.data)})),this.elements.label.addEvent("click",(function(e){var i=t.getTree();i&&(i._modeIsMultiSel=e.ctrlKey,i._modelEvents.publish({event:"click",data:t}))})),this.elements.label.addEvent("dblclick",(function(e){var i=t.getTree();i&&i._modelEvents.publish({event:"dblClick",data:t})})))},getTree:function(){var e=this.getRoot();return e?e.options.tree:this.options.tree},buildNode:function(){var e,t=this.options;this.getParent()&&(this._nodeDepth=this.getParent()._nodeDepth+1),this.elements.container.setAttributes({"data-nodeDepth":this._nodeDepth}),t.grid&&(e="wux-tree-row"),t.isRoot&&(e+=" wux-tree-headers"),this.elements.row=new UWA.Element("div",{class:e,styles:{display:"inline-block",whiteSpace:"pre",marginRight:14}});var i=this.options.UI;this._marginLeft=this._nodeDepth*(i.layout.lrMargin+1*(i.expander.size+2*i.expander.borderSize)+(i.icon.size-(i.expander.size+2*i.expander.borderSize))/2),this.elements.view=new UWA.Element("ul",{class:"Node Horizontal",styles:{marginLeft:this._marginLeft+"px",position:"relative",display:"inline-block",zIndex:10,paddingTop:this.options.UI.layout.btMargin}}),this._inheritFromTree(),this._buildExpander(),this._buildLink(),this._buildIcons(),this._buildLabel(),this.elements.view.inject(this.elements.row),this._customizeNodeView&&this._customizeNodeView(),this.elements.row.inject(this.elements.container,"top"),this.options.expandAllAtInit&&this._nodeDepth>0||0===this._nodeDepth?this.show():this.hide(),this.setLabel(this.options.label,!1)},_buildChildrenContainer:function(){this.elements.childrenContainer=new UWA.Element("ul",{class:"wux-controls-treenodebase-children wux-ui-stack-v",styles:{}}).inject(this.elements.container)},getPrevBrotherNode:function(){if(this.getParent()){var e=this.getParent().getChildren().indexOf(this);if(e>0)return e--,this.getParent().getNthChild(e)}},getNextBrotherNode:function(){if(this.getParent()){var e=this.getParent().getChildren().indexOf(this);if(e<this.getParent().getChildren().length)return e++,this.getParent().getNthChild(e)}},getNextBrothersNodes:function(){var e=[];if(this.getParent())for(var t=this.getParent().getChildren().indexOf(this);t<this.getParent().getChildren().length-1;)t++,e.push(this.getParent().getNthChild(t));return e},getChildIndex:function(){return this.getParent()&&this.getParent().getChildren()?this.getParent().getChildren().indexOf(this):-1},getChildren:function(){return this._children},hasChildren:function(){var e=this.getChildren();return!!(e&&e.length>0)},getAllDescendants:function(e){void 0===e?e=[]:e.push(this);var t=this.getChildren();return t&&t.forEach((function(t){t.getAllDescendants(e)})),e},getNthChild:function(e){if(this.getChildren())return this._children[e]},getLastChild:function(){return this._children[this._children.length-1]},_getRowIndex:function(){return this.options._rowIndex},_setRowIndex:function(e){this.options._rowIndex=e},onPreExpand:function(e){e&&(this.options.onPreExpand=e)},onPostExpand:function(e){e&&(this.options.onPostExpand=e)},_preExpandDone:function(){this.getTree()._modelEvents.publish({event:"PRE_EXPAND_DONE"})},expand:function(e){void 0===e&&(e=1);var t=this,i=function(){!0!==t._modeIsExpandAll?(t._modeIsExpandAll=e,t._modeIsExpandAll&&t._modeIsExpandAll>0&&(t._modeIsExpandAll--,t._processChildren(!0))):t._processChildren(!0),t.getChildren()||t._buildExpander(!1),t.getTree()._modelEvents.publish({event:"expand",context:t,data:{node:t}}),t.options.onPostExpand&&t.options.onPostExpand.call(t),t.getTree()._modelEvents.publish({event:"postExpand",context:t,data:{node:t}})};e>0&&!this.isExpanded()&&(t.getTree()._modelEvents.publish({event:"preExpand",context:t,data:{node:t}}),t.options.onPreExpand&&t.options.onPreExpand.call(t),t.options.useAsyncPreExpand?t.getTree()._modelEvents.subscribe({event:"PRE_EXPAND_DONE"},(function(){i()})):i())},expandAll:function(){this._modeIsExpandAll=!0,this._processChildren(!0),this._modeIsExpandAll=!1},isExpanded:function(){return this._isExpanded},isRoot:function(){return this.options.isRoot},_showChildren:function(){var e=this;this._children.forEach((function(t){(t._attachToView(),e._modeIsExpandAll&&t.expand(e._modeIsExpandAll),e.options.animateOnExpand)&&new UWA.Fx(t.getContent(),{duration:FX_DURATION,transition:"quintIn"}).start({opacity:[0,1],marginTop:[-20,0]});e.getTree()._onUpdate(t)})),this._isExpanded=!0,this.elements.expander&&this.elements.expander.set(this.options.UI.collapseState)},_processChildren:function(){var e=this.getChildren();this._loadModel(e)},_getObjectClass:function(){return"TreeNodeBase"},onPreCollapse:function(e){e&&(this.options.onPreCollapse=e)},onPostCollapse:function(e){e&&(this.options.onPostCollapse=e)},collapseNode:function(){console.warn("Please use the collapse method instead"),this.collapse()},collapse:function(){this.isExpanded()&&(this.options.onPreCollapse&&this.options.onPreCollapse.call(this),this.getTree()._modelEvents.publish({event:"preCollapse",context:this,data:{node:this}}),this._children&&this._children.forEach((function(e){e._dettachFromView(),e.collapse()})),this._isExpanded=!1,this._expandState="expandState",this.isDrawn()&&this.elements.expander.set(this.options.UI[this._expandState]),this.getTree()._modelEvents.publish({event:"collapse",context:this,data:{node:this}}),this.options.onPostCollapse&&this.options.onPostCollapse.call(this),this.getTree()._modelEvents.publish({event:"postCollapse",context:this,data:{node:this}}))},_attachToView:function(e){if(this.buildSkeleton(),this.buildNode(),this.show(),this.getParent()&&!this.options.isRoot&&!this.getContent().isInjected()){var t=this.getParent().getChildren().indexOf(this);(i=this.getParent().elements.childrenContainer).children&&i.children[t]?i.insertBefore(this.getContent(),i.children[t]):i.appendChild(this.getContent())}if(this.getParent()&&this.options.isRoot){var i;t=parseInt(this.getParent().getChildren().indexOf(this),10);(i=this.getTree().elements.treeContainer).children&&i.children[t]?i.insertBefore(this.getContent(),i.children[t]):i.appendChild(this.getContent()),this.show()}this.options.isRoot&&this.show(),this.options.isRoot&&this.options.isFakeRoot&&this.hide(),this._isDrawn=!0,this._bindBehaviors()},_dettachFromView:function(){this.elements&&this.elements.container&&this.getContent()&&this.getContent().destroy(),this._isDrawn=!1},isDrawn:function(){return this._isDrawn},_bindBehaviors:function(){var e,t=this,i=this.getTree();(void 0===this.options.isDraggable&&i.options.isEditable&&(this.options.isDraggable=i.options.isEditable.nodesAreDraggable),i.options.isEditable&&(this.options.isEditable={autoExpandAtDrag:!0,autoExpandAtDragDelay:1e3},this.options.isEditable=UWA.merge(this.options.isEditable,i.options.isEditable,!0)),this.options.isDraggable)&&(this._drag=new WUXDraggable(this,this.elements.view,{dataTransfer:{type:"Text",data:"toto"},data:this,onDragStart:function(e,n){i._modelEvents.publish({context:t,event:"NODE/DRAG_START",data:t})}}),this._drop=new WUXDroppable(this,this.elements.view,{onDragEnter:function(e,t,n){i._clearAutoExpandAtDragTimeout()},onDragOver:function(n,s,o){var l=this,a=t.elements.view.getDimensions(),r=Number(a.height)/3,h=2*a.height/3,u=NAVIGATOR.ie?n.offsetY:n.layerY;u<r?(e="top",s.setStyles({boxShadow:"inset 0px 1px 0px blue"}),i._clearAutoExpandAtDragTimeout()):u>=r&&u<h?(e="middle",s.setStyles({boxShadow:"inset -1px -1px 0px blue, inset 1px 1px 0px blue"}),t.options.isEditable.autoExpandAtDrag&&!i._toAutoExpandAtDrag&&(i._toAutoExpandAtDrag=setTimeout((function(){l.expand()}),t.options.isEditable.autoExpandAtDragDelay))):(e="bottom",s.setStyles({boxShadow:"inset 0px -1px 0px blue"}),i._clearAutoExpandAtDragTimeout()),i._modelEvents.publish({context:t,event:"NODE/DRAG_OVER",data:t})},onDragLeave:function(e,n){n.setStyles({boxShadow:"none"}),i._clearAutoExpandAtDragTimeout(),i._modelEvents.publish({context:t,event:"NODE/DRAG_LEAVE",data:t})},drop:function(t,n,s){if(n.setStyles({boxShadow:"none"}),i._modelEvents.publish({context:this,event:"NODE/PRE_DROP",data:s}),this!==s.from)if(i._onDropCallBack)i._onDropCallBack.call(this,s);else{var o=1,l=0;switch(s.from.getParent()===this.getParent()&&(o=s.from.getParent().getChildren().indexOf(s.from)<this.getParent().getChildren().indexOf(this)?0:1,l=s.from.getParent().getChildren().indexOf(s.from)<this.getParent().getChildren().indexOf(this)?1:0),e){case"top":this.getParent().addChild(s.from,this.getParent().getChildren().indexOf(this)-l);break;case"middle":this.addChild(s.from);break;case"bottom":this.getParent().addChild(s.from,this.getParent().getChildren().indexOf(this)+o)}}else console.warn("You dropped the node on itself");i._modelEvents.publish({context:this,event:"NODE/POST_DROP",data:s})}}))},_updateView:function(e,t){var i=this;function n(){var n;(void 0===e&&(e=!1),void 0===t&&(t=!1),e)?(i._dettachFromView(),i.getParent()&&i.getParent()._isExpanded&&i._attachToView(),DEBUG&&((n=new UWA.Fx(i.elements.label,{duration:1e3})).start({backgroundColor:["#FFF","#3F0"]}),n.start({backgroundColor:["#3F0","#FFF"]}))):(i._buildExpander(!1),i._buildLink(!0),DEBUG&&((n=new UWA.Fx(i.elements.label,{duration:1e3})).start({backgroundColor:["#FFF","#3CF"]}),n.start({backgroundColor:["#3CF","#FFF"]})));t&&(i.getChildren()&&i.getChildren().forEach((function(t){t&&t._updateView(e,!0)})))}this._updateViewTimeout&&clearTimeout(this._updateViewTimeout),this.options.renderSaver?this._updateViewTimeout=setTimeout(n,this.options.renderSaver):n()},flash:function(e){void 0===e&&(e="#F1960C");var t=new UWA.Fx(this.elements.label,{duration:1e3});t.start({backgroundColor:["#FFF",e]}),t.start({backgroundColor:[e,"#FFF"]})},dump:function(e){return this._dump(e,{icons:null,label:null})},_dump:function(e,t,i){for(var n in i||(i={}),e||(e=1),void 0===t&&(t={icons:null,label:null}),t){var s=this.options[n];s&&(i[n]=s)}var o=this.getChildren();if(o)switch(e){default:case 1:return i.children=[],o.forEach((function(t){i.children.push(t.dump(e))})),i;case 2:return UWA.Json.encode(UWA.Json.path(o,"$_children[*]"))}return i},processChildren:function(e){var t=this.getChildren();t&&t.forEach((function(t){e&&(e.call(t,t),t.processChildren(e))}))},_loadModel:function(children){var expandChildren=!0,me=this;if(children)switch(UWA.typeOf(children)){case"string":expandChildren&&UWA.Ajax.request(children,{async:!0,onComplete:function(msg){me.removeChildren();var jsonObject=eval(msg);//!TODO replace with the good UWA method
me._parseTree(jsonObject,me,me._uuid,me.options.UI),expandChildren?me._showChildren():me.collapse()},onFailure:function(e){console.log("[!]\tError loading file:"+children)}});break;case"array":expandChildren&&me._showChildren()}},search:function(e){var t=this.getChildren();t&&t.forEach((function(t){var i;if(t.options.label){var n=t.options.label.toLowerCase();""!==e?-1!==n.search(e.toLowerCase())?(i=WUX.Utilities.Css.recordState(t.elements.label,["box-shadow","font-weight","text-shadow","border"]),t.elements.label.setStyles({boxShadow:"inset 0px 0px 200px 0px #ffff00,inset 0px 0px 2px 1px white",fontWeight:"bold",textShadow:"0px 1px 1px white"}),t.getParent().expand(1)):WUX.Utilities.Css.restoreState(t.elements.label,i,["box-shadow","font-weight","text-shadow"]):(WUX.Utilities.Css.restoreState(t.elements.label,i,["box-shadow","font-weight","text-shadow"]),t.expand(1))}t.search(e)}))}});return UWA.namespace("WUX/Controls/TreeNodeBase",TreeNodeBase)})),define("DS/Controls/TooltipModel",["require","exports","DS/Core/TooltipModel"],(function(e,t,i){"use strict";return console.error("'DS/Controls/TooltipModel' is deprecated, use 'DS/Core/TooltipModel' instead."),i})),define("DS/Controls/Gauge",["UWA/Core","UWA/Controls/Abstract","DS/CoreEvents/ModelEvents","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Utilities/Utils"],(function(e,t,i,n,s,o){"use strict";return t.extend({defaultOptions:{snap:0,value:0,minValue:0,minDeltaValue:0,maxValue:360,stepValue:1,graduations:12,graduationsLabel:!0,dynamicGraduations:!1,dynamicGaugeColor:!0,showCursorLabel:!0,theme:{shiftCursorOnBorders:!0,fontSize:10,height:22,gaugeHeight:10,cursor:{width:16,height:16,borderRadius:"50%"},width:200,graduations:{width:1,height:24}},displayFunction:function(e){return e.toString()},onChange:null},init:function(e){e.graduations>=0&&"number"==typeof e.graduations&&e.graduations--,this._parent(e),this._modelEvents=new i,this.options.className&&(this.className=this.options.className),this._value=[],this._resolutionfactor=1,this._isRangeMode=Array.isArray(this.options.value),this._realRange=this.options.maxValue-this.options.minValue,this._gaugeSize=parseInt(.75*this.options.theme.height,10),this._buildSkeleton(),this._virtualRange=this.elements.container.getDimensions().width,this._buildScaling(),this._buildCursor(0),this._buildCursor(1),this._attachBehaviors(),this.setValue(this.options.value)},_percentToRealValue:function(e){return e*this._realRange+this.options.minValue},_realValueToPercent:function(e){return(e-this.options.minValue)/this._realRange},_percentToVirtualValue:function(e){return e*this._virtualRange},_virtualToRealValue:function(e,t){void 0===t&&(t=1);var i=e/this.elements.container.getDimensions().width;return{value:this._percentToRealValue(i),percent:i}},_realToVirtualValue:function(e){var t=e/this._realRange;return{value:this._percentToVirtualValue(),percent:t}},_buildScaling:function(){var t,i,n=0,s=this.options.graduations,o=e.typeOf(s);i="array"===o?t=s.length:(t=parseInt(s,10))+1;for(var l=-parseInt(this.options.theme.fontSize+5,10),a=0;a<i;a++){var r,h;if(this.options.dynamicGraduations)h="hsl("+(180-180*a/t)+", 100%, 50%)",r=0;else h=this.options.inactiveGraduationsColor,r=1;n="array"===o?this._realToVirtualValue(s[a].value).percent:a/t;var u=new e.Element("div",{class:"wux-Gauge-scale",styles:{position:"absolute",opacity:r}}),c=new e.Element("div",{styles:{position:"relative"}}).inject(u);if(this.options.graduationsLabel){var d;d="array"===o?s[a].label:this._percentToRealValue(parseFloat(n));var p=this;new e.Element("div",{class:"wux-Gauge-scale-label","data-value":p._percentToRealValue(n),styles:{position:"absolute",top:l,fontSize:this.options.theme.fontSize,color:this.options.graduationsLabelColor},html:d.toString(),events:{click:function(t){var i=e.Event.getElement(t).getAttribute("data-value");p.setValue(i)}}}).inject(c)}var m=100*n;u.setStyles({backgroundColor:h,top:-2,left:m+"%",marginLeft:a===i-1?-1:0,width:this.options.theme.graduations.width,height:this.options.theme.graduations.height}).inject(this.elements.container)}},_buildCursor:function(t){var i=new e.Element("div",{class:"wux-Gauge-scale wux-Gauge-cursor",styles:{display:this.options.showCursorLabel?"block":"none",position:"absolute",width:this.options.theme.cursor.width,height:this.options.theme.cursor.height,marginLeft:-this.options.theme.cursor.width/2,top:(this.options.theme.height-this.options.theme.cursor.height)/2,borderRadius:this.options.theme.cursor.borderRadius}});(this._isRangeMode||0!==t)&&i.inject(this.elements.container);var n=new e.Element("div",{}).inject(i),s=new e.Element("div",{class:"wux-Gauge-scale-label",styles:{marginLeft:this.options.theme.cursor.width/2,bottom:-2},html:this._value}).inject(n);this._isRangeMode&&s.setAttribute("data-side",t?"right":"left"),this._cursors[t]=s,this._scales[t]=i},_buildSkeleton:function(){this.elements.container=e.Element("div",{class:"wux-controls-gauge "+this.className,styles:{position:"relative",marginTop:20,height:this.options.theme.height}}),this.elements.control=e.Element("div",{class:"wux-Gauge-control wux-ui-material-"+this.options.GaugeMaterial,styles:{position:"absolute",top:(this.options.theme.height-this.options.theme.gaugeHeight)/2,height:this.options.theme.gaugeHeight}}).inject(this.elements.container);this.elements.gauge=e.Element("div",{class:"wux-Gauge wux-ui-indicator-"+this.options.GaugeIndicator+" wux-ui-material-"+this.options.GaugeMaterial+" "+this.className,styles:{}}).inject(this.elements.control),this.elements.gaugeTop=e.Element("div",{class:"wux-Gauge-top"}),this.elements.gaugeBottom=e.Element("div",{class:"wux-Gauge-bottom"}),this._cursors=[],this._scales=[]},addEvent:function(e,t){return this._subscribe(e,t)},_removeEvent:function(e){return this._modelEvents.unsubscribe(e)},_removeEventListener:function(e){return this._modelEvents.unsubscribe(e)},addEventOnce:function(e,t){return this._modelEvents.subscribeOnce({event:e},t)},addEventListener:function(e,t){return this._subscribe(e,t)},_subscribe:function(e,t){return this._modelEvents.subscribe({event:e},t)},_updateGaugePercent:function(e){var t=this.elements.gauge,i={position:"absolute",left:100*e[0]+"%",right:100-100*e[1]+"%"};if(this.options.dynamicGaugeColor){var n=120-100*e[1];i.backgroundColor="hsl("+n+", 100%, 50%)"}t.setStyles(i),this._updateCursor(0,this._realValueToPercent(this._value[0]),this._value[0]),this._updateCursor(1,this._realValueToPercent(this._value[1]),this._value[1])},_updateCursor:function(e,t,i){var n=this._cursors[e],s=this._scales[e],o=this._labelWidth[e],l=this._controlWidth,a=t*l;if(this.options.theme.shiftCursorOnBorders&&l>0){var r=a+o/2;a-o/2<0?n.setStyles({marginLeft:this.options.theme.cursor.width}):r>=l?n.setStyles({marginLeft:0}):n.setStyles({marginLeft:this.options.theme.cursor.width/2})}var h=100*t;s.setStyles({left:h+"%"}),this._isRangeMode?n.setHTML(this.options.displayFunction(this._value[e].toString())):n.setHTML(this.options.displayFunction(this.getValue().toString()))},_constraintValue:function(e){var t=0,i=this.options.stepValue.toString();(i.split(".")[1]&&(t=i.split(".")[1].length),e>this.options.maxValue&&(e=this.options.maxValue),e<this.options.minValue&&(e=this.options.minValue),this._isRangeMode)&&(this._value[1]-this._value[0]<=this.options.minDeltaValue&&(0===this._selectedEdge&&(e=this._value[1]-this.options.minDeltaValue),1===this._selectedEdge&&(e=this._value[0]+this.options.minDeltaValue)));return e=(Math.round(e/this.options.stepValue)*this.options.stepValue).toFixed(t),t?Number(e).toFixed(t):parseFloat(e)},_setValue:function(e,t,i){void 0===t&&(t=!0),void 0===i&&(i=!1),this._isRangeMode?Array.isArray(e)?(0===this._selectedEdge&&(this._value[0]=this._constraintValue(e[0]*this._resolutionfactor)),1===this._selectedEdge&&(this._value[1]=this._constraintValue(e[1]*this._resolutionfactor)),null===this._selectedEdge&&(this._value[0]=this._constraintValue(e[0]*this._resolutionfactor),this._value[1]=this._constraintValue(e[1]*this._resolutionfactor))):console.warn("You must provide an array as value when you want to use a range gauge"):(this._value[0]=this.options.minValue,this._value[1]=this._constraintValue(e*this._resolutionfactor));var n=[this._realValueToPercent(this._value[0]),this._realValueToPercent(this._value[1])];this._updateGaugePercent(n),t&&(this.options.onChange&&this.options.onChange.call(this,this.getValue()),this._modelEvents.publish({context:this,event:"change",data:this}))},setValue:function(e,t){this._selectedEdge=null,this._setValue(e,t)},enable:function(){this.getContent().removeClassName("wux-ui-state-disabled").setStyle("pointer-events","")},disable:function(){this.getContent().addClassName("wux-ui-state-disabled").setStyle("pointer-events","none")},_attachBehaviors:function(){var t,i,l,a,r,h,u=this,c=this.elements.container,d=this.elements.gauge,p=u._cursors;function m(e){f&&(l=t.x-e.pageX-i,a=u._virtualToRealValue(-l),u._isRangeMode?h[r]=a.value:h=a.value,u._setValue(h,!0,!0))}function g(){u._resolutionfactor=1,f=!1,u.elements.container.removeClassName("wux-ui-state-active");let e=o.getDocumentOwner(u.elements.container);s.removeEventOnElement(u,e,n.POINTERMOVE,m),s.removeEventOnElement(u,e,n.POINTERUP,g)}u._labelWidth=[],u._labelWidth[0]=p[0].getDimensions().width,u._labelWidth[1]=p[1].getDimensions().width;var f=!1;c.addEvent(n.POINTERDOWN,(function(e){e.preventDefault(),u._resolutionfactor=1,u.elements.container.addClassName("wux-ui-state-active"),u._controlWidth=u.elements.control.getDimensions().width;var c=u._controlWidth,p=d.getDimensions(),v=d.getOffsets();t={y:v.y+p.height/2,x:v.x};var y=(Number(u._value[1])+Number(u._value[0]))/2;i=u._realValueToPercent(u._value[0])*c,l=t.x-e.pageX-i,a=u._virtualToRealValue(-l),r=a.value<y?0:1,u._selectedEdge=r,h=u.getValue(),u._isRangeMode?h[r]=a.value:h=a.value,u._setValue(h),f=!0;let _=o.getDocumentOwner(u.elements.container);s.addEventOnElement(u,_,n.POINTERMOVE,m),s.addEventOnElement(u,_,n.POINTERUP,g)})),e.Element.addEvent.call(c,"mousewheel",(function(t){e.Event.wheelDelta(t);t.shiftKey}))},getValue:function(){return this._isRangeMode?this._value:parseFloat(this._value[1])}})})),define("DS/Controls/Timeline",["UWA/Core","UWA/Event","DS/Core/Core","DS/Controls/Gauge","DS/CoreEvents/Events"],(function(e,t,i,n,s){"use strict";var o=n.extend({className:"wux-timeline",defaultOptions:{},init:function(e){e.beginDate&&(e.minValue=new Date(e.beginDate).valueOf()),e.endDate&&(e.maxValue=new Date(e.endDate).valueOf()),e.dateAtInit&&(e.value=new Date(e.dateAtInit).valueOf()),e.date&&(e.value=new Date(e.date).valueOf()),!e.displayFunction&&e.beginDate&&(e.displayFunction=function(e){if(e)return new Date(e).strftime("%Y-%m-%d")}),e.displayFunction||e.beginDate||(e.displayFunction=function(e){return e}),e.graduations=[];var t=this;this._isDateBased=!0,this._eventsList=[],e.eventsList&&e.eventsList.forEach((function(i){var n;i.date?(n=new Date(i.date).valueOf()-e.minValue,t._isDateBased=!0):(n=i.value-e.minValue,t._isDateBased=!1);var s={label:i.label,value:n,onEvent:i.onEvent,state:0};e.graduations.push(s)})),this._parent(e),this._isPlaying=!1},_play:function(e,t){var i=this,n=this._value[1];n=parseFloat(n,10)+parseFloat(e,10),i.setValue(n),i.elements.container.addClassName("wux-ui-state-active"),n!==i.options.minValue&&n!==i.options.maxValue&&i._isPlaying&&(this.playerTO=setTimeout((function(){i._isPlaying&&i._play.call(i,e,t)}),t))},play:function(e,t){void 0===t&&(t=!0),this._isPlaying=!1,void 0===e&&(e=1);this._isPlaying=!0;window.clearTimeout(this.playerTO),this._play(e/20,50),t&&this._modelEvents.publish({event:"PLAY",context:this})},pause:function(e){void 0===e&&(e=!0),this.elements.container.removeClassName("wux-ui-state-active"),this._isPlaying=!1,e&&this._modelEvents.publish({event:"PAUSE",context:this})},stop:function(e){void 0===e&&(e=!0),this.elements.container.removeClassName("wux-ui-state-active"),this.pause(!1),this.setValue(this.options.minValue),e&&this._modelEvents.publish({event:"STOP",context:this})},onPlay:function(e){return this._modelEvents.subscribe({event:"PLAY"},e)},onPause:function(e){return this._modelEvents.subscribe({event:"PAUSE"},e)},onStop:function(e){return this._modelEvents.subscribe({event:"STOP"},e)},next:function(){},previous:function(){},setValue:function(e,t){var i=this;this._setValue(e,t),i._value[1]===i.options.maxValue&&i.pause(),i.options.graduations.forEach((function(e){var t=e.value+i.options.minValue;i._value[1]>=t&&0===e.state&&(e.state=1,e.onEvent&&e.onEvent.call(i)),i._value[1]<t&&e.state>0&&(e.state=0)}))},getValue:function(){if(this._isDateBased){var e=new Date;return e.setTime(this._value[1]),e}return this._value[1]}});return e.namespace("WUX/Controls/Timeline",o)})),define("DS/Controls/Tile",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Controls/Scroller","DS/Core/Core","DS/Utilities/Color","DS/Controls/Deck","DS/Core/PointerEvents"],(function(e,t,i,n,s,o,l,a){"use strict";var r="push-left",h="push-right",u="flip";var c=i.extend({defaultOptions:{rows:2,container:window,color:!1,effects:"flip",button:!1},init:function(t){this._parent(t);var i=this;this._id=e.Utils.getUUID(),this._flagIsSecondary=!1;var n=this.options.effects.split(":");this._effect=n[0],this._effectParam=parseFloat(n[1]),n[1]&&(this._effectParamUnit=n[1].replace(/^[\-\d\.]+/,"")),this.buildSkeleton(),this._zIndex=this.elements.container.style.zIndex,this.elements.infos.addEvent(a.POINTERUP,(function(e){switch(e.preventDefault(),e.stopPropagation(),i._effect){case u:i.rotate();break;case r:i.pushLeft();break;case h:i.pushRight()}}))},buildSkeleton:function(){var t="white";this.options.color&&(t=o.random());Math.ceil(800+800*Math.random()),Math.ceil(200+200*Math.random());var i=this.elements,n=(this.options,"");this._effect!=r&&this._effect!=h||(n=""),this._effect==u&&(n=" Back"),i.container=new e.Element("div",{id:this._id,class:"WUXTile",events:null}),i.container.setAttributes({"data-color":o.hexToHsl(t)}),i.front=new e.Element("div",{class:"Primary Tile",id:e.Utils.getUUID(),styles:{backgroundSize:"cover",background:t},events:null}),i.back=new e.Element("div",{class:"Secondary Tile"+n,html:{tag:"div",class:"Logo"},events:null}),i.infos=new e.Element("div",{class:"Infos",html:"i",events:null}),this.options.button||i.infos.hide(),i.infos.inject(i.container),i.front.inject(i.container),i.back.inject(i.container)},setPrimaryViewContent:function(e,t){this.elements.front.setHTML(e),t&&this.elements.front.setStyles(t)},setSecondaryViewContent:function(e,t){this.elements.back.setHTML(e),t&&this.elements.front.setStyles(t)},setAlternativeViewContent:function(e,t){this.elements.container.hasClassName("Flip")?(this.setPrimaryViewContent(e,t),this.displayPrimaryView()):(this.setSecondaryViewContent(e,t),this.displaySecondaryView())},toggleView:function(e,t){this.elements.container.hasClassName("Flip")?(e&&this.setPrimaryViewContent(e,t),this.displayPrimaryView()):(e&&this.setSecondaryViewContent(e,t),this.displaySecondaryView())},displayAlternativeView:function(e,t){console.warn("deprecated","Controls/Tile","method displayAlternativeView is deprecated. Please use toggleView method"),this.toggleView(e,t)},getPrimaryView:function(){return this.elements.front},getSecondaryView:function(){return this.elements.back},pushLeft:function(){this.elements.container.toggleClassName("wux-ui-state-left");var e='[id="'+this.getPrimaryView().id+'"]',t=this._effectParam;this._flagIsSecondary||(t="-"+t),this._flagIsSecondary&&"px"==this._effectParamUnit&&(t=0),t+=this._effectParamUnit,this._flagIsSecondary=!this._flagIsSecondary;new l({selector:e,container:"body",distributions:[{translate3d:function(e,i,n){return{x:t,y:0,z:0}}}],duration:200,ease:"ease-in-out"})},pushRight:function(){this.elements.container.toggleClassName("wux-ui-state-right");this.getPrimaryView().id;var e=this._effectParam;this._flagIsSecondary&&(e=0),this._flagIsSecondary&&"px"==this._effectParamUnit&&(e=0),e+=this._effectParamUnit,this._flagIsSecondary=!this._flagIsSecondary,this.elements.front.setStyles({transition:"transform ease-in-out 0.2s"}),this.elements.front.setStyles({transform:"translate3d("+e+", 0, 0)"})},displayPrimaryView:function(e,t){e&&this.setPrimaryViewContent(e,t),this.elements.container.removeClassName("Flip")},displaySecondaryView:function(e,t){e&&this.setSecondaryViewContent(e,t),this.elements.container.addClassName("Flip")},rotate:function(){this.elements.container.toggleClassName("Flip")}});return e.namespace("WUX/Controls/Tile",c)}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Abstract",["require","exports","UWA/Core","DS/Core/BaseComponent","DS/Core/WebUXComponents","DS/WebRecordEnabler/Adapter","DS/UIBehaviors/KeymapManager","DS/UIBehaviors/CommandsRegistry","DS/Utilities/TouchUtils","DS/Utilities/Dom","DS/Controls/TooltipLoader","DS/Utilities/Utils","./typings/types"],(function(e,t,i,n,s,o,l,a,r,h,u,c){"use strict";var d=["dimensionsChanged"];function p(e,t,i){var n=document.createEvent("Event");null==i&&(i={});var s=void 0===i.bubbles||i.bubbles;return n.initEvent(t,s,!1),n.dsModel=e,n.options=i,n}var m=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return n.keymaps||(n.keymaps={}),n.commands||(n.commands={}),n}return __extends(t,e),t.prototype.init=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this._disabledState=!1,this._changeDisabledStateWhileApplyingDisabled=!0,e.prototype.init.apply(this,t)},Object.defineProperty(t,"publishedProperties",{get:function(){return{domId:{defaultValue:null,type:"string",category:"Behavior"},disabled:{defaultValue:!1,type:"boolean",category:"Behavior",recordFlag:!0},visibleFlag:{defaultValue:!0,type:"boolean",category:"Behavior",recordFlag:!0},animation:{defaultValue:null,type:"object",noNeedToApplyFlag:!0,category:"Appearance"},touchMode:{defaultValue:void 0,type:"boolean",category:"Accessibility"},tooltipInfos:{defaultValue:void 0,type:"Object",category:"Accessibility",advancedSetter:!0},recId:{defaultValue:null,type:"string",category:"Record",uiDisplay:!1},fireOnlyFromUIInteractionFlag:{defaultValue:!1,type:"boolean",category:"Behavior",noNeedToApplyFlag:!0},identifier:{defaultValue:void 0,type:"string",readOnly:!0,category:"Behavior"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!1,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.handleEvents=function(){},t.prototype._postBuildView=function(){},t.prototype.getPublishedPropertiesDefaultValue=function(){var e={},t=Object.getPrototypeOf(this);if(t&&t.publishedProperties)for(var i in t.publishedProperties)t.publishedProperties.hasOwnProperty(i)&&(e[i]=t.publishedProperties[i].defaultValue);return e},t.prototype.addEventListener=function(e,t,i){this.getContent().addEventListener(e,t,i)},t.prototype.removeEventListener=function(e,t,i){(this.elements.container||this.container)&&this.getContent().removeEventListener(e,t,i)},t.prototype.destroy=function(){this._keymapManager&&this._keymapManager.destroy(),h.removeAllEventsOnElement(this),h.removeAllResizeObserverOnElement(this),e.prototype.destroy.call(this)},t.prototype._isCurrentlyCalledFromUIInteraction=function(){return h.isCurrentlyCalledFromUIInteraction()},t.prototype.fire=function(e,t){if(this.elements.container){var i=h.increaseCurrentPositionInStack(this.getContent()),n=-1===d.indexOf(e);this.fireOnlyFromUIInteractionFlag&&n||this.getContent().dispatchEvent(p(this,e,t)),i.inCurrentUIInteractionStack&&i.firstTimeInstanceIsCalled&&this.elements.container&&o.addCustomInteraction(this.elements.container,{type:"webUX_event",reason:"UIInteraction",event:e,eventOptions:t},void 0,!0),i.inCurrentUIInteractionStack&&this.fireOnlyFromUIInteractionFlag&&n&&this.getContent().dispatchEvent(p(this,e,t)),i.increment&&h.decreaseCurrentPositionInStack()}},t.prototype.setPropertyFromUIInteraction=function(e,t){if((this.elements.container||this.container)&&!(this._properties&&this._properties[e]&&(Array.isArray(t)||t instanceof Date?i.equals(this._properties[e].value,t):this._properties[e].value===t))){var n=h.increaseCurrentPositionInStack(this.getContent());n.inCurrentUIInteractionStack&&n.firstTimeInstanceIsCalled&&this.elements.container&&o.addCustomInteraction(this.elements.container,{type:"webUX_property",property:e,value:t},void 0,!0),this[e]=t,n.increment&&h.decreaseCurrentPositionInStack()}},t.prototype.setReadOnlyPropertyFromUIInteraction=function(e,t){if(this.elements.container||this.container){var i="_apply"+(e.substring(0,1).toUpperCase()+e.substring(1,e.length)),n=h.increaseCurrentPositionInStack(this.getContent());for(var s in n.inCurrentUIInteractionStack&&n.firstTimeInstanceIsCalled&&this.elements.container&&o.addCustomInteraction(this.elements.container,{type:"webUX_readOnlyProperties",property:e,value:t},void 0,!0),t)t.hasOwnProperty(s)&&this._properties[e]&&(this._properties[e][s]=t[s]);this[i]&&this[i](),n.increment&&h.decreaseCurrentPositionInStack()}},t.prototype.modifyObjectFromUIInteraction=function(e,t){if(this.elements.container||this.container){var i="_apply"+(e.substring(0,1).toUpperCase()+e.substring(1,e.length)),n=h.increaseCurrentPositionInStack(this.getContent());for(var s in n.inCurrentUIInteractionStack&&n.firstTimeInstanceIsCalled&&this.elements.container&&o.addCustomInteraction(this.elements.container,{type:"webUX_subproperties",property:e,value:t},void 0,!0),t)t.hasOwnProperty(s)&&(this[e][s]=t[s]);this[i](),n.increment&&h.decreaseCurrentPositionInStack()}},t.prototype.buildView=function(){},t.prototype.modifyArrayFromUIInteraction=function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(this.elements.container||this.container){var s=h.increaseCurrentPositionInStack(this.getContent());s.inCurrentUIInteractionStack&&s.firstTimeInstanceIsCalled&&this.elements.container&&o.addCustomInteraction(this.elements.container,{type:"webUX_property",property:e,value:this[e]},void 0,!0),t.apply(this[e],i),s.increment&&h.decreaseCurrentPositionInStack()}},t.prototype.callMethodFromUIInteraction=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n=Array.prototype.slice.call(arguments,1);return h.callMethodFromUIInteraction(e,this,this[e],n)},t.prototype.addKeyMapsAndCommands=function(e,t){if(e&&t){var i=this._getCommandRegistry();for(var n in t)i.registerCommand(this.name+":"+n,t[n]);var s={target:this.getContent(),jsModel:this,commandsRegistry:i};for(var o in void 0===this._keymapManager&&(this._keymapManager=new l(s)),e)if("object"==typeof e[o]){var a=e[o].keydown?this.name+":"+e[o].keydown:void 0,r=e[o].keyup?this.name+":"+e[o].keyup:void 0;this._keymapManager.registerKeymap(o,a,r)}else this._keymapManager.registerKeymap(o,this.name+":"+e[o])}},t.prototype.removeKeyMaps=function(e){for(var t=0;t<e.length;t++)delete this._keymapManager._keymap[e[t]]},t.prototype._preBuild=function(e){this._preBuildView&&this._preBuildView(e),this.keymaps&&this.commands&&this.addKeyMapsAndCommands(this.keymaps,this.commands)},t.prototype._getCommandRegistry=function(){var e=Object.getPrototypeOf(this);return e?(e.hasOwnProperty("_commandRegistry")||(e._commandRegistry=new a),e._commandRegistry):null},t.prototype._build=function(){this.buildView&&this.buildView(),void 0===this.touchMode&&this._applyTouchMode&&this._applyTouchMode()},t.prototype._postBuild=function(){this._postBuildView&&this._postBuildView(),this._handleEvents&&this._handleEvents(),this.markForRecordFlag&&this.markForRecord&&this.markForRecord(this.getContent())},t.prototype._preBuildView=function(e){this.elements.container?this.elements.container.addClassName("wux-controls-abstract"):this.elements.container=i.createElement("div",{class:"wux-controls-abstract"}),this.elements.container.dsModel=this},t.prototype.getOwnerDocument=function(){return c.getDocumentOwner(this)},t.prototype.getWindow=function(){return c.getDocumentWindow(this)},t.prototype._handleEvents=function(){var e=this,t=this._getElementToFocus();t&&t.addEventListener&&(h.addEventOnElement(this,t,"focus",(function(t){e._onFocusReceived()}),!0),h.addEventOnElement(this,t,"blur",(function(t){e._resetFocus()}),!0)),this.handleEvents&&this.handleEvents()},t.prototype._applyDisabled=function(e){this.elements.container&&(this.disabled?(this.getContent().setAttributeNode(document.createAttribute("disabled")),this.getContent().getAttributeNode("focused")&&this.getContent().removeAttribute("focused")):this.getContent().removeAttribute("disabled")),this._changeDisabledStateWhileApplyingDisabled&&(this._disabledState=this.disabled)},t.prototype._applyTouchMode=function(e){!0===this._getCurrentTouchMode()?this.getContent().setAttributeNode(document.createAttribute("touch-mode")):this.getContent().removeAttribute("touch-mode")},t.prototype._applyIdentifier=function(){this.identifier&&(window.__karma__||navigator.webdriver||"true"===localStorage.getItem("ACTIVATE_FT_SCRIPTER"))&&this.getContent().setAttribute("wux-identifier",this.identifier)},t.prototype.setDisabledFlagWithoutChangingDisabledState=function(e){this._changeDisabledStateWhileApplyingDisabled=!1,this.disabled=e,this._changeDisabledStateWhileApplyingDisabled=!0},t.prototype.focus=function(e){var t=this._getElementToFocus();t&&t.focus&&t.focus(e)},t.prototype._getDisabledState=function(){return this._disabledState},t.prototype._getCurrentTouchMode=function(){return void 0===this.touchMode?r.getTouchMode():this.touchMode},t.prototype._touchModeChange=function(e){this._applyTouchMode&&this._applyTouchMode()},t.prototype._applyDomId=function(e){if(this.domId){var t=document.createAttribute("id");t.value=this.domId,this.getContent().setAttributeNode(t)}else if(e){e===this.getContent().id&&this.getContent().removeAttribute("id")}},t.prototype._applyRecId=function(e){if(this.recId){var t=document.createAttribute("data-rec-id");t.value=this.recId,this.getContent().setAttributeNode(t),this.elements.container.getCheckpointData||(this.elements.container.getCheckpointData=function(e){var t={},i=this.dsModel;if(i&&i.publishedProperties)for(var n in i.publishedProperties){var s=i.publishedProperties[n];if(s.recordFlag)if(Array.isArray(s.recordFlag)){if(i[n]){for(var o={},l=0;l<s.recordFlag.length;l++)o[s.recordFlag[l]]=i[n][s.recordFlag[l]];t[n]=o}}else void 0!==i[n]&&(t[n]=i[n])}e(t,!1)})}else this.getContent().removeAttribute("data-rec-id"),this.elements.container.getCheckpointData=void 0},t.prototype._applyVisibleFlag=function(e){this.visibleFlag?c.show(this.getContent()):c.hide(this.getContent())},t.prototype._applyTooltipInfos=function(){},t.prototype._applyProperties=function(e){this.isDirty("disabled")&&this._applyDisabled(e?e.disabled:void 0),!this.isDirty("visibleFlag")||e&&void 0===e.visibleFlag||this._applyVisibleFlag(e?e.visibleFlag:void 0),this.isDirty("touchMode")&&this._applyTouchMode(e?e.touchMode:void 0),this.isDirty("recId")&&this._applyRecId(e?e.recId:void 0),this.isDirty("domId")&&this._applyDomId(e?e.domId:void 0),this.isDirty("identifier")&&this._applyIdentifier(),this.isDirty("tooltipInfos")&&s._applyForAdvancedSetterProperty(this,"tooltipInfos",e?e.tooltipInfos:void 0,this.tooltipInfos)},t.prototype._getElementToFocus=function(){return this.getContent()},t.prototype._onFocusReceived=function(){this._isFocused()||this.elements.container&&this.getContent().setAttributeNode(document.createAttribute("focused"))},t.prototype._giveFocus=function(){this.elements.container&&this.getContent().setAttributeNode(document.createAttribute("focused"))},t.prototype._resetFocus=function(){this.elements.container&&this.getContent().removeAttribute("focused")},t.prototype._isFocused=function(){return!!this.elements.container&&this.elements.container.hasAttribute("focused")},t.prototype.show=function(t){t=t||!0;var i=this.animation;var n=e.prototype.show.call(this,t);return!0===t&&i&&i.show&&(this.getContent().addClassName("wux-ui-animation-"+i.show+"-in"),this.getContent().addEventListener("animationend",(function e(t){t.target.removeEventListener("animationend",e),t.target.removeClassName("wux-ui-animation-"+i.show+"-in")}))),this.visibleFlag=!0,n},t.prototype.hide=function(e){e=e||!0;var t=this.animation;!0===e&&t&&t.hide?(this.getContent().addClassName("wux-ui-animation-"+t.hide+"-out"),this.getContent().addEventListener("animationend",(function e(i){i.target.removeEventListener("animationend",e),i.target.removeClassName("wux-ui-animation-"+t.hide+"-out")}))):this.visibleFlag=!1},t.prototype._getCustomContent=function(){return[]},t}(n);return m.prototype.blackBoxFlag=!1,s.addClass(m,"abstract"),u.initTooltipFrame(),m}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ColorPalette",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Color","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils"],(function(e,t,i,n,s,o,l,a,r){"use strict";function h(e,t){var i=void 0;if(t){var n=0;for(n=0;n<t.length;n++)if(t[n]&&o.compareColorStrings(t[n].value,e)){i=t[n];break}}return i}function u(e,t){var i=t?o.UNSET_COLOR_TEXTURE_URL_TOUCH:o.UNSET_COLOR_TEXTURE_URL_MOUSE,n="url("+i+")";e&&(e=o.getValidCssColor(e),i=t?o.TRANSPARENCY_TEXTURE_URL_TOUCH:o.TRANSPARENCY_TEXTURE_URL_MOUSE,n="linear-gradient("+o.setAlphaToColorString(e,1)+", "+e+"), url("+i+")");return n}var c=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return r.extendingClassFlag||n.addKeyMapsAndCommands({up:{keydown:"selectPrevious",keyup:"preventDefault"},down:{keydown:"selectNext",keyup:"preventDefault"},left:{keydown:"selectPrevious",keyup:"preventDefault"},right:{keydown:"selectNext",keyup:"preventDefault"}},{selectNext:function(){var e=h(this.value,this._swatchList),t=this._swatchList.indexOf(e);return t>=0&&++t>=this._swatchList.length&&(t=0),this.value=this._swatchList[t].value,{preventDefault:!0,stopPropagation:!1}},selectPrevious:function(){var e=h(this.value,this._swatchList),t=this._swatchList.indexOf(e);return t>=0&&--t<0&&(t=this._swatchList.length-1),this.value=this._swatchList[t].value,{preventDefault:!0,stopPropagation:!1}},preventDefault:function(){return{preventDefault:!0,stopPropagation:!0}}}),n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:"",type:"string",category:"Behavior",advancedSetter:!0},swatches:{defaultValue:[],type:"array",category:"Behavior"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-controls-colorpalette"),this.elements.container.setAttribute("tabindex","0"),this._swatchList=[]},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("swatches")&&this._applySwatches(),this.isDirty("value")&&this._preEditValue(t.value,this.value)&&this._applyValue(t.value)},t.prototype._preEditValue=function(e,t){return!(t&&!o.isValidColorString(t))},t.prototype._applyValue=function(e){var t,i,n=h(this.value,this._swatchList);t=n?n.swatch:void 0,(i=this.elements.container)&&i.getChildren().forEach((function(e){e.removeAttribute("is-selected")})),t&&t.setAttribute("is-selected",""),this.fire("change")},t.prototype._applySwatches=function(){this._removeAllSwatches(),this._addSwatches(this.swatches)},t.prototype._applyTouchMode=function(t){e.prototype._applyTouchMode.call(this,t),this._swatchList&&this._swatchList.forEach((function(e){e.swatch&&(e.swatch.style.background=u(e.value,this._getCurrentTouchMode()))}))},t.prototype.reApplySwatches=function(){this._applySwatches()},t.prototype.loadDefault=function(){var e=[];Object.keys(o.COLORS_3DEXPERIENCE).forEach((function(t){e.push({value:o.COLORS_3DEXPERIENCE[t]})})),this.swatches=e},t.prototype.reset=function(){this.swatches=[],this.value=""},t.prototype.handleEvents=function(){l.addEventOnElement(this,this.getContent(),s.POINTERHIT,this._onPointerHit.bind(this))},t.prototype._onPointerHit=function(e){1===e.multipleHitCount&&e.target&&e.target.hasClassName("wux-controls-colorpalette-swatch")&&(this.value=e.target._value)},t.prototype._addSwatches=function(e){for(var t={},i=0;i<this.swatches.length;i++){this.swatches[i].value||(this.swatches[i].value=void 0);var n=this.swatches[i].value?this.swatches[i].value.toUpperCase():void 0;t[n]||n&&!o.isValidColorString(n)?this.swatches.splice(i,1):t[n]=this.swatches[i].value?this.swatches[i].value:"undefined",this._addSwatch(this.swatches[i]);var s=this._swatchList.length>0?this._swatchList.length-1:0;o.compareColorStrings(this._swatchList[s].value,this.value)?this._swatchList[s].swatch.setAttribute("is-selected",""):this._swatchList[s].swatch.removeAttribute("is-selected")}},t.prototype._addSwatch=function(e){if(e){var t=u(e.value,this._getCurrentTouchMode()),n=i.createElement("div",{class:"wux-controls-colorpalette-swatch",styles:{background:t}});n._value=e.value;var s=e.tooltipParams?e.tooltipParams:{shortHelp:e.value?e.value:"undefined color"};n.tooltipInfos=s,this.elements.container.appendChild(n);var o={value:e.value,swatch:n};this._swatchList.push(o)}},t.prototype._removeAllSwatches=function(){this._swatchList.forEach((function(e){e.swatch&&(e.swatch.remove(),e.swatch.destroy())})),this._swatchList=[]},t}(n);return a.addClass(c,"colorPalette"),c.prototype.blackBoxFlag=!0,c}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,s=0,o=t.length;s<o;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))};define("DS/Controls/Breadcrumb",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Handlebars/Handlebars","DS/Menu/ContextualMenu","DS/Menu/Menu","DS/Utilities/Dom","DS/Core/PointerEvents","DS/Core/WebUXComponents","DS/CoreBase/WebUXGlobalEnums"],(function(e,t,i,n,s,o,l,a,r,h,u){"use strict";var c="wux-controls-breadcrumb",d="".concat(c,"-item"),p="".concat(d,"-separator"),m="".concat(d,"-label"),g="".concat(d,"-icon"),f="is-hovered",v="is-selected",y="index",_="hidden",b={task:s.compile("{{#unless isExpandableSeparator}}                           {{#if isLiteStyle}}                             <div class='wux-controls-breadcrumb-item-separator'>\\</div>                           {{/if}}                         {{/unless}}                         {{#if isIconVisible}}                           <div class='wux-controls-breadcrumb-item-icon'>{{&icon}}</div>                         {{/if}}                         {{#if isLabelVisible}}                           <div class='wux-controls-breadcrumb-item-label'>{{label}}</div>                         {{/if}}                         {{#if isExpandableSeparator}}                           <div class='wux-controls-breadcrumb-item-separator wux-ui-3ds wux-ui-3ds-chevron-right wux-ui-3ds-lg'></div>                         {{/if}}")},C=function(e,t,i){if(e&&e.elements&&e.elements.container)if(t)if(e.elements.container.setAttributeNode(document.createAttribute(f)),this.displayStyle===U.DISPLAY_STYLE.IMMERSIVE)e.elements.icon&&e.elements.icon.setAttributeNode(document.createAttribute(f)),e.elements.label&&e.elements.label.setAttributeNode(document.createAttribute(f)),e.elements.separator&&e.elements.separator.setAttributeNode(document.createAttribute(f));else switch(i){case 2:if(e.elements.separator&&e.elements.separator.setAttributeNode(document.createAttribute(f)),!this.expandableSeparatorFlag)break;case 1:e.elements.icon&&e.elements.icon.setAttributeNode(document.createAttribute(f)),e.elements.label&&e.elements.label.setAttributeNode(document.createAttribute(f))}else e.elements.container.removeAttribute(f),e.elements.icon&&e.elements.icon.removeAttribute(f),e.elements.label&&e.elements.label.removeAttribute(f),e.elements.separator&&e.elements.separator.removeAttribute(f)},w=function(e){!0===e&&(this._listItems=[]);var t,i=(!this._listItems||0===this._listItems.length)&&0!==this.value.length,n=void 0;for(t=0;t<this.value.length;t++){if(!i&&!(i=t>=this._listItems.length)){var s=A(this._listItems[t],this.value[t]);if(-1===s&&D.call(this,this._listItems[t],this.value[t]),i=1===s)for(var o=this._listItems.length-1;o>=t;o--)this.elements.container.removeChild(this._listItems[o].elements.container),this._listItems.pop()}if(i){void 0===n&&(n=t);var l=F.call(this,this.value[t],t);this._listItems.push(l),this.elements.container.appendChild(l.elements.container),N.call(this)}}if(!i)for(o=this._listItems.length-1;o>=t;o--)this.elements.container.removeChild(this._listItems[o].elements.container),this._listItems.pop();return n},x=function(){for(;this.elements.container.firstChild;)this.elements.container.removeChild(this.elements.container.firstChild);if(this.elements._responsiveMenuMainContent&&(a.removeEventOnElement(this,this.elements._responsiveMenuMainContent,r.POINTERHIT),this.elements._responsiveMenuMainContent.destroy(),delete this.elements._responsiveMenuMainContent),this.elements._lastHiddenItemExpandableSeparator&&(a.removeEventOnElement(this,this.elements._lastHiddenItemExpandableSeparator,r.POINTERHIT),this.elements._lastHiddenItemExpandableSeparator.destroy(),delete this.elements._lastHiddenItemExpandableSeparator),this.displayStyle===U.DISPLAY_STYLE.LITE){var e=void 0;!0!==this.__customOverflowManagement__&&(e={iconName:"menu",fontIconFamily:u.WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},this.elements._responsiveMenuMainContent=a.generateIcon(e),this.elements._responsiveMenuMainContent.addClassName("wux-controls-breadcrumb-responsive-menu"),this.elements.container.appendChild(this.elements._responsiveMenuMainContent),a.addEventOnElement(this,this.elements._responsiveMenuMainContent,r.POINTERHIT,E.bind(this))),!0===this.expandableSeparatorFlag&&(e={iconName:"chevron-right",fontIconFamily:u.WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},this.elements._lastHiddenItemExpandableSeparator=a.generateIcon(e),this.elements._lastHiddenItemExpandableSeparator.addClassName("wux-controls-breadcrumb-last-hidden-item-separator"),this.elements.container.appendChild(this.elements._lastHiddenItemExpandableSeparator),a.addEventOnElement(this,this.elements._lastHiddenItemExpandableSeparator,r.POINTERHIT,S.bind(this))),N.call(this)}var t=w.call(this,!0);V.call(this,t),L.call(this,this.elements.container.clientWidth)},E=function(e){var t=this;this.responsiveMenuModel=[];for(var i=function(e){var i=e.selected?l.MENU_STATE_SELECTED:l.MENU_STATE_NONE,s={type:"CheckItem",title:e.label,icon:e.icon,state:l.translateStateBitFieldToString(i),action:{callback:function(){for(var i=t.responsiveMenuModel,n=e.label,s=-1,o=0;o<i.length;o++)if(i[o].title===n){s=o;break}var a=[];if(t.mode===U.MODE.MULTIPLE_SELECTION){var r=(m=l.getItemState(i[s]))&l.MENU_STATE_DISABLED;m&l.MENU_STATE_SELECTED||(r|=l.MENU_STATE_SELECTED),l.setItemState(i[s],r),a.push(i[s])}else if(t.mode===U.MODE.EXCLUSIVE_SELECTION||t.mode===U.MODE.NAVIGATION){for(var h=0,u=i;h<u.length;h++){var c=u[h],d=l.getItemState(c)&l.MENU_STATE_DISABLED;l.setItemState(c,d)}r=(m=l.getItemState(i[s]))&l.MENU_STATE_DISABLED;r|=l.MENU_STATE_SELECTED,l.setItemState(i[s],r),a.push.apply(a,i)}l.updateModel(a);var p=[];for(o=0;o<i.length;o++){var m;(m=l.getItemState(i[o]))&l.MENU_STATE_SELECTED&&p.push(o)}var g=t._hiddenItems.map((function(e){return e.label})),f=t.selectedValues.filter((function(e){return"string"==typeof e?!g.includes(e):!g.includes(e.label)}));for(o=0;o<t._hiddenItems.length;o++){var y=t._hiddenItems[o];t.mode===U.MODE.MULTIPLE_SELECTION?(p.includes(o)?(f.push(t.value[y.index]),y.selected=!0):y.selected=!1,y.elements.container.setAttribute(v,y.selected)):t.mode!==U.MODE.EXCLUSIVE_SELECTION&&t.mode!==U.MODE.NAVIGATION||1===p.length&&p[0]===o&&f[0]!==t.value[y.index]&&(f=[t.value[y.index]])}t.selectedValues=__spreadArray([],f,!0)}},submenu:"function"==typeof t.onContextualEvent||!0===t.expandableSeparatorFlag?function(e){if(!t.disabled){var i,n,s=l.getMenuItemUidFromNode(e.info.target);if(s>=0&&(i=l.getMenuDescriptionFromUid(s)),i){var o=t._hiddenItems.filter((function(e){return e.label===i.title}));o.length>0&&(n=o[0])}if(n)if("function"==typeof t.onContextualEvent){var a=t.onContextualEvent.call(t,{infos:e.info,data:e.data,indexFound:n.index});if(!t.customContextMenuFlag)return a}else!0===t.expandableSeparatorFlag&&(t.onSeparatorClickEvent?t.onSeparatorClickEvent.call(t,{index:n.index}):t.fire("separatorClick",{index:n.index}))}}:void 0};n.responsiveMenuModel.push(s)},n=this,s=0,o=this._hiddenItems;s<o.length;s++){i(o[s])}var a=this.elements._responsiveMenuMainContent.getBoundingClientRect();l.show(this.responsiveMenuModel,{doNotHideOnAction:t.mode===U.MODE.MULTIPLE_SELECTION,position:{x:a.left,y:a.top+a.height}})},S=function(e){var t=this._hiddenItems.length>0?this._hiddenItems[this._hiddenItems.length-1]:null;t&&(this.onSeparatorClickEvent?this.onSeparatorClickEvent.call(this,{index:t.index}):this.fire("separatorClick",{index:t.index}))},D=function(e,t){e.value="string"==typeof t?t:t.value},A=function(e,t){var i={label:"",icon:void 0,value:""};return"string"==typeof t?(i.label=t||"",i.value=i.label):(i.label=t.label?t.label:"",i.icon=t.icon,i.value=t.value?t.value:i.label),e.icon!==i.icon||e.label!==i.label?1:e.value===i.value?0:-1},F=function(e,t){var i={label:"",index:t,selected:!1,elements:{}};return"string"==typeof e?(i.label=e,i.value=e):(i.label=e.label?e.label:"",i.icon=e.icon,i.value=e.value?e.value:i.label),P.call(this,i),I.call(this,i),i},P=function(e){e.elements.container=i.createElement("span",{class:d}),e.elements.container.setAttribute(y,e.index),e.elements.container.setAttribute(v,!1);var t,n=e.label&&this.displayLabels!==U.DISPLAY_ELEMENT.NONE,s=e.icon&&this.displayIcons!==U.DISPLAY_ELEMENT.NONE;if(s){var o=i.createElement("div"),l=a.generateIcon(e.icon);o.setContent(l),t=o.innerHTML,o.destroy()}e.elements.container.setContent(b.task({label:e.label,isLabelVisible:n,icon:t,isIconVisible:s,isExpandableSeparator:this.expandableSeparatorFlag,isLiteStyle:this.displayStyle===U.DISPLAY_STYLE.LITE})),e.elements.label=n?e.elements.container.getElementsByClassName(m)[0]:void 0,e.elements.icon=s?e.elements.container.getElementsByClassName(g)[0]:void 0,e.elements.separator=e.elements.container.getElementsByClassName(p)[0]},I=function(e){var t=this,i=function(){if(!t.disabled)if(t.mode===U.MODE.MULTIPLE_SELECTION){if(e.selected){for(var i=0;i<t.selectedValues.length;i++)if(0===A(e,t.selectedValues[i])){t.selectedValues.splice(i,1);break}e.selected=!1,e.elements.container.setAttribute(v,!1)}else t.selectedValues.push(t.value[e.index]),e.selected=!0,e.elements.container.setAttribute(v,!0);t.fire("selectionChange")}else if(t.mode===U.MODE.EXCLUSIVE_SELECTION)e.selected||(t.selectedValues=[t.value[e.index]]);else if(t.mode===U.MODE.NAVIGATION){var n=t.value.length-1-e.index;B.call(t,n),L.call(t,t.elements.container.clientWidth)}};this.displayStyle===U.DISPLAY_STYLE.IMMERSIVE?a.addEventOnElement(e,e.elements.container,"click",i):(e.elements.label&&a.addEventOnElement(e,e.elements.label,"click",i),e.elements.icon&&a.addEventOnElement(e,e.elements.icon,"click",i)),this.expandableSeparatorFlag&&a.addEventOnElement(e,e.elements.separator,"click",(function(i){i.stopPropagation(),t.disabled||(t.onSeparatorClickEvent?t.onSeparatorClickEvent.call(t,{index:e.index}):t.fire("separatorClick",{index:e.index}))}))},V=function(e){var t;if(t=void 0!==e?e:this.value.length,this.mode===U.MODE.MULTIPLE_SELECTION)for(var n=0;n<this.selectedValues.length;n++){for(var s=this.selectedValues[n],o=!1,l=0;l<t&&!(o=i.equals(this.value[l],s));l++);if(!o)return void this._applySelectedValues()}else if(this.mode===U.MODE.EXCLUSIVE_SELECTION){if(this.selectedValues.length>1)return void this._applySelectedValues();for(o=!1,l=0;l<t&&!(o=i.equals(this.value[l],this.selectedValues[0]));l++);o||this._applySelectedValues()}else this.mode===U.MODE.NAVIGATION&&(this.value.length>0?i.equals(this.value[this.value.length-1],this.selectedValues[0])?this._applySelectedValues():this.selectedValues=[this.value[this.value.length-1]]:this.selectedValues=[])},T=function(){var e=[];if(this.mode===U.MODE.MULTIPLE_SELECTION||this.mode===U.MODE.EXCLUSIVE_SELECTION)for(var t=0;t<this.selectedValues.length;t++){for(var n=this.selectedValues[t],s=!1,o=0;o<this.value.length;o++)if(s=i.equals(this.value[o],n)){e.push(o);break}s||console.error("UpdateSelectedItems should not be call with wrong values.")}else this.mode===U.MODE.NAVIGATION&&e.push(this.value.length-1);for(t=0;t<this._listItems.length;t++)-1!==e.indexOf(t)?(this._listItems[t].selected=!0,this._listItems[t].elements.container.setAttribute(v,!0)):(this._listItems[t].selected=!1,this._listItems[t].elements.container.setAttribute(v,!1))},B=function(e){if(!(e<=0)){for(var t=this._listItems.length-1,i=0;i<e;i++){var n=this._listItems[(t-i).toString()].elements.container;this.elements.container.removeChild(n),this._listItems.pop()}this.value.splice(t-e+1,e),V.call(this),this.fire("change")}},O=function(e){for(var t=-1,i=-1;e&&-1===t&&!a.hasClass(e,c);)a.hasClass(e,p)?(t=e.parentNode.getAttribute(y),i=2):a.hasClass(e,m)||a.hasClass(e,g)?(t=e.parentNode.getAttribute(y),i=1):a.hasClass(e,d)&&(t=e.getAttribute(y),i=0),e=e.parentNode;return{indexFound:t,itemFound:i}},M=function(e,t){if(e)for(var i=0;i<this._listItems.length;i++){(n=this._listItems[i]).elements.container.setAttributeNode(document.createAttribute(t)),n.elements.label&&n.elements.label.setAttributeNode(document.createAttribute(t)),n.elements.icon&&n.elements.icon.setAttributeNode(document.createAttribute(t)),n.elements.separator&&n.elements.separator.setAttributeNode(document.createAttribute(t))}else for(i=0;i<this._listItems.length;i++){var n;(n=this._listItems[i]).elements.container.removeAttribute(t),n.elements.label&&n.elements.label.removeAttribute(t),n.elements.icon&&n.elements.icon.removeAttribute(t),n.elements.separator&&n.elements.separator.removeAttribute(t)}},N=function(){if(this.displayStyle===U.DISPLAY_STYLE.LITE)for(var e=!1,t=0,i=this._listItems;t<i.length;t++){var n=i[t];(e=n.elements.container.hasAttribute(_))&&n.elements.container.removeAttribute(_),n.width=n.elements.container.clientWidth,e&&n.elements.container.setAttribute(_,"")}},L=function(e){if(this.displayStyle===U.DISPLAY_STYLE.LITE){var t=[];!0!==this.__customOverflowManagement__&&this.elements._responsiveMenuMainContent.hide(),!0===this.expandableSeparatorFlag&&this.elements._lastHiddenItemExpandableSeparator.hide(),this._hiddenItems=[];var i=0,n=!1,s=-1,o=void 0;for(o=this._listItems.length-1;o>=0;o--)this._listItems[o].elements.container.setAttribute(_,""),!0===n?t.push(this._listItems[o]):i+this._listItems[o].width>e?(n=!0,s=o,t.push(this._listItems[o])):(i+=this._listItems[o].width,this._listItems[o].elements.container.removeAttribute(_));if(!0===n){var l=0;!0!==this.__customOverflowManagement__&&(this.elements._responsiveMenuMainContent.show(),l=this.elements._responsiveMenuMainContent.clientWidth+16);var a=0;!0===this.expandableSeparatorFlag&&(this.elements._lastHiddenItemExpandableSeparator.show(),a=this.elements._lastHiddenItemExpandableSeparator.clientWidth),l+a+i>e&&++s<this._listItems.length&&(this._listItems[s].elements.container.setAttribute(_,""),t.unshift(this._listItems[s]))}this._hiddenItems=t.reverse()}},k=function(e){if(e&&e.length&&e[0]&&e[0].target&&e[0].target.clientWidth){var t=e[0].target.clientWidth;t&&L.call(this,t)}},U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:[],type:"array",category:"Behavior"},selectedValues:{defaultValue:[],type:"array",category:"Helper"},mode:{defaultValue:0,type:"enum",category:"Behavior"},expandableSeparatorFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},displayStyle:{defaultValue:0,type:"enum",category:"Appearance"},displayIcons:{defaultValue:1,type:"enum",category:"Appearance"},displayLabels:{defaultValue:1,type:"enum",category:"Appearance"},onContextualEvent:{defaultValue:null,type:"function",noNeedToApplyFlag:!0},customContextMenuFlag:{defaultValue:!1,type:"boolean",category:"Behavior",noNeedToApplyFlag:!0},onSeparatorClickEvent:{defaultValue:null,type:"function",noNeedToApplyFlag:!0}}},enumerable:!1,configurable:!0}),t.prototype._preBuild=function(t){e.prototype._preBuild.call(this,t),this.elements.container.addClassName(c),this._listItems=[]},t.prototype._postBuildView=function(){N.call(this),L.call(this,this.elements.container.clientWidth)},t.prototype.handleEvents=function(){var e=this,i=this,n=-1;this.displayStyle===t.DISPLAY_STYLE.LITE&&a.addResizeObserver(this,this.elements.container,k),a.addEventOnElement(this,this.elements.container,"mouseover",(function(e){if(!i.disabled){var t=O.call(i,e.target),s=t.indexFound,o=t.itemFound;if(n>-1&&n<i._listItems.length){var l=i._listItems[n];C.call(i,l,!1)}if(s>-1){l=i._listItems[s];C.call(i,l,!0,o)}n!==s&&i.fire("preSelection",{oldItem:Number(n),newItem:Number(s)}),n=s}})),a.addEventOnElement(this,this.elements.container,"mouseleave",(function(){if(n>-1&&n<i._listItems.length){var e=i._listItems[n];C.call(i,e,!1)}i.fire("preSelection",{oldItem:Number(n),newItem:Number(-1)}),n=-1})),this._ctxMenuToken=o.addEventListener(this.elements.container,{callback:function(t){if(!e.disabled&&"function"==typeof e.onContextualEvent){var i=void 0,n=-1,s=O.call(e,t.data.target);if(s.indexFound<e._listItems.length&&s.indexFound>-1&&(i=e._listItems[s.indexFound]),i&&(n=s.indexFound),-1!==n){var o=e.onContextualEvent.call(e,{infos:t.info,data:t.data,indexFound:n});if(!e.customContextMenuFlag)return o}}}}),a.onNodeRendered(this.elements.container,(function(){N.call(i)}))},t.prototype.pop=function(){if(!(this._listItems.length<=0)){var e=this.value[this.value.length-1];return B.call(this,1),L.call(this,this.elements.container.clientWidth),e}},t.prototype.push=function(e){this.value.push(e);var t=F.call(this,e,this.value.length-1);this._listItems.push(t),this.elements.container.appendChild(t.elements.container),N.call(this),L.call(this,this.elements.container.clientWidth),V.call(this),this.fire("change")},t.prototype._applyValue=function(e){x.call(this),function(e,t){if(!e&&t)return!0;if(e&&!t)return!0;if(e&&t){if(e.length!==t.length)return!0;for(var i=0;i<t.length;i++){var n={};"string"==typeof t[i]?(n.label=t[i],n.value=t[i]):(n.label=t[i].label?t[i].label:"",n.icon=t[i].icon,n.value=t[i].value?t[i].value:n.label);var s={};if("string"==typeof e[i]?(s.label=e[i],s.value=e[i]):(s.label=e[i].label?e[i].label:"",s.icon=e[i].icon,s.value=e[i].value?e[i].value:s.label),A(s,n)>0)return!0}}return!1}(e,this.value)&&this.fire("change")},t.prototype._applySelectedValues=function(e){if(this.mode===t.MODE.MULTIPLE_SELECTION)for(var n=0;n<this.selectedValues.length;){for(var s=this.selectedValues[n],o=!1,l=0;l<this.value.length&&!(o=i.equals(this.value[l],s));l++);o?n++:this.selectedValues.splice(n,1)}else if(this.mode===t.MODE.EXCLUSIVE_SELECTION){this.selectedValues.splice(1,this.selectedValues.length-1);for(o=!1,l=0;l<this.value.length&&!(o=i.equals(this.value[l],this.selectedValues[0]));l++);o||(this._properties.selectedValues.value=[])}else if(this.mode===t.MODE.NAVIGATION){n=void 0;for(n=this.value.length-1;n>=0;n--)if(i.equals(this.value[n],this.selectedValues[0])){if(this.value.length-1-n>0)return B.call(this,this.value.length-1-n),void L.call(this,this.elements.container.clientWidth);break}if(n<0&&this.value.length>0)return void(this.selectedValues=e)}T.call(this),this.fire("selectionChange")},t.prototype._applyMode=function(){V.call(this)},t.prototype._applyExpandableSeparatorFlag=function(){this.expandableSeparatorFlag?this.getContent().setAttributeNode(document.createAttribute("expandable-separator")):this.getContent().removeAttribute("expandable-separator"),x.call(this)},t.prototype._applyDisplayStyle=function(){this.getContent().setAttribute("display-style",void 0!==this.displayStyle&&this.displayStyle.toString()),x.call(this)},t.prototype._applyDisplayIcons=function(e){this.getContent().setAttribute("display-icons",void 0!==this.displayIcons&&this.displayIcons.toString()),e!==t.DISPLAY_ELEMENT.NONE&&this.displayIcons!==t.DISPLAY_ELEMENT.NONE||x.call(this)},t.prototype._applyDisplayLabels=function(e){this.getContent().setAttribute("display-labels",void 0!==this.displayLabels&&this.displayLabels.toString()),e!==t.DISPLAY_ELEMENT.NONE&&this.displayLabels!==t.DISPLAY_ELEMENT.NONE||x.call(this)},t.prototype._applyDisabled=function(t){e.prototype._applyDisabled.call(this,t),M.call(this,this.disabled,"disabled")},t.prototype._applyTouchMode=function(i){e.prototype._applyTouchMode.call(this,i),M.call(this,this.touchMode,"touch-mode"),this.displayStyle===t.DISPLAY_STYLE.LITE&&N.call(this)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("value")?this._applyValue(t.value):this.isDirty("selectedValues")&&this._applySelectedValues(t.selectedValues),this.isDirty("expandableSeparatorFlag")&&this._applyExpandableSeparatorFlag(),this.isDirty("mode")&&this._applyDisplayStyle(),this.isDirty("displayStyle")&&this._applyDisplayStyle(),this.isDirty("displayLabels")&&this._applyDisplayLabels(t.displayLabels),this.isDirty("displayIcons")&&this._applyDisplayIcons(t.displayIcons),this.isDirty("touchMode")&&this._applyTouchMode(t.touchMode)},t.prototype.destroy=function(){this.displayStyle===t.DISPLAY_STYLE.LITE&&a.removeResizeObserver(this,this.elements.container,k),this._ctxMenuToken&&o.removeEventListener(this.elements.container,this._ctxMenuToken),e.prototype.destroy.call(this)},t}(n);return function(e){!function(e){e[e.NAVIGATION=0]="NAVIGATION",e[e.MULTIPLE_SELECTION=1]="MULTIPLE_SELECTION",e[e.EXCLUSIVE_SELECTION=2]="EXCLUSIVE_SELECTION"}(e.MODE||(e.MODE={})),function(e){e[e.LITE=0]="LITE",e[e.IMMERSIVE=1]="IMMERSIVE"}(e.DISPLAY_STYLE||(e.DISPLAY_STYLE={})),function(e){e[e.NONE=0]="NONE",e[e.ALL=1]="ALL",e[e.SELECTED=2]="SELECTED",e[e.HOVERED=3]="HOVERED",e[e.HOVERED_OR_SELECTED=4]="HOVERED_OR_SELECTED"}(e.DISPLAY_ELEMENT||(e.DISPLAY_ELEMENT={}))}(U||(U={})),h.addClass(U,"breadcrumb"),U}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/GroupBox",["require","exports","DS/Controls/Abstract","UWA/Core","DS/Core/WebUXComponents","DS/Utilities/Dom","DS/Utilities/WUXUWAUtils"],(function(e,t,i,n,s,o,l){"use strict";var a=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return l.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{label:{defaultValue:"",type:"string",category:"Appearance",advancedSetter:!0},icon:{defaultValue:"",type:"object",category:"Appearance",advancedSetter:!0},iconDimension:{defaultValue:"16px",type:"string",category:"Appearance",advancedSetter:!0},content:{defaultValue:null,type:"object",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-groupbox"),this.elements._contentDiv=document.createElement("fieldset"),this._legendElement=document.createElement("legend"),this._titleElement=document.createElement("span"),this._iconElement=document.createElement("div"),this.elements.container.appendChild(this.elements._contentDiv),this.elements._contentDiv.appendChild(this._legendElement),this._legendElement.appendChild(this._iconElement),this._legendElement.appendChild(this._titleElement)},t.prototype.appendChild=function(e){var t=new n.Element("div",{styles:{width:"inherit"},html:e});return this.elements._contentDiv.appendChild(e),t},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("label")&&this._applyLabel(t.label,this.label),this.isDirty("icon")&&this._applyIcon(t.value,this.icon),this.isDirty("iconDimension")&&this._applyIconDimension(t.value,this.icon),this.isDirty("content")&&this._applyContent(t.content,this.content)},t.prototype._applyLabel=function(e,t){this._titleElement.innerText=t},t.prototype._applyIcon=function(e,t){o.generateIcon(t,{target:this._iconElement})?this._iconElement.classList.remove("hidden"):this._iconElement.classList.add("hidden"),this.fire("change")},t.prototype._applyIconDimension=function(e,t){this._iconElement&&(this._iconElement.style.width=t+"px",this._iconElement.style.height=t+"px",this._iconElement.style["font-size"]=t+"px")},t.prototype._applyContent=function(e,t){if(this.elements._contentDiv){e&&e.remove();var i=this.content;i&&(n.is(i,"element")&&(this.content=new n.extendElement(i)),this.content.inject(this.elements._contentDiv))}},t}(i);return s.addClass(a,"groupBox"),a}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Button",["require","exports","UWA/Core","DS/Controls/Abstract","DS/CoreBase/WebUXGlobalEnums","DS/Core/PointerEvents","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter","DS/Utilities/Utils","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils","DS/CoreBase/WebUXGlobalEnums","./typings/types"],(function(e,t,i,n,s,o,l,a,r,h,u){"use strict";function c(e){this._latestActionOptions={ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey};var t=p.call(this);return this.fire("buttonclick",this._latestActionOptions),t}function d(){if(this.elements.icon&&(this.elements.iconPlaceholder&&this.elements.iconPlaceholder.empty(),delete this.elements.icon),this.elements.separator&&this.elements.separator.remove(this.elements.button),this.icon){this.elements.iconPlaceholder||(this.elements.iconPlaceholder=new i.Element("div",{class:"wux-button-icon-placeholder"})),this.elements.iconPlaceholder.isInjected(this.elements.button)||this.elements.iconPlaceholder.inject(this.elements.button,"top");var e=l.oldGenerateIcon(this.icon,this.iconSize,s.WUXManagedFontIcons.FontAwesome);if(e){if(this.elements.icon=e,this.elements.iconPlaceholder&&this.elements.iconPlaceholder.show(),this.elements.icon.style.pointerEvents="none",this.elements.iconPlaceholder&&(this.elements.icon.inject(this.elements.iconPlaceholder),"flyout"===this.displayStyle&&(this.elements.separator||(this.elements.separator=new i.Element("div",{class:"wux-button-separator"})),this.elements.separator.inject(this.elements.iconPlaceholder,"after"))),l.isFontIcon(this.icon))this.elements.container.removeClassName("wux-contains-richIcon");else if(this.elements.container.addClassName("wux-contains-richIcon"),this.elements.icon&&"IMG"===this.elements.icon.tagName){var t=this;this.elements.icon.onload=function(){t&&t.elements&&t.elements.icon&&(t.elements.icon.onload=null,t.fire("dimensionsChanged"))}}}else this.elements.iconPlaceholder&&this.elements.iconPlaceholder.hide()}else this.elements.iconPlaceholder&&this.elements.iconPlaceholder.hide()}function p(){return"check"===this.type?(this.setPropertyFromUIInteraction("checkFlag",!this.checkFlag),!0):"radio"!==this.type||(this.checkFlag?!this.multiSelWithControlFlag||this._latestActionOptions&&this._latestActionOptions.ctrlKey?!!(this.multiSelWithControlFlag&&this._latestActionOptions&&this._latestActionOptions.ctrlKey)&&(this.setPropertyFromUIInteraction("checkFlag",!1),!0):(this._applyCheckFlag(this.checkFlag),!0):(this.setPropertyFromUIInteraction("checkFlag",!0),!0))}var m=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var s=e.apply(this,t)||this;return u.extendingClassFlag||s.addKeyMapsAndCommands({return:{keydown:"validate",keyup:"validate"},space:{keydown:"validate",keyup:"validate"}},{validate:function(e){if(this.disabled)return{stopPropagation:!1};var t={};return(1===this.clickMode&&"keydown"===e.type||0===this.clickMode&&"keyup"===e.type)&&(t.actionPerformed=c.call(this,e)),"return"===i.Event.whichKey(e)?{stopPropagation:!1,infos:t}:{stopPropagation:!0,preventDefault:!0,infos:t}}}),s}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{label:{defaultValue:"",type:"string",category:"Appearance"},emphasize:{defaultValue:"secondary",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"object",category:"Appearance"},iconSize:{defaultValue:"1x",type:"string",category:"Appearance",uiDisplay:!1},value:{defaultValue:void 0,type:"object",category:"Behavior",recordFlag:!0},type:{defaultValue:"standard",type:"string",category:"Behavior",noNeedToApplyFlag:!0},checkFlag:{defaultValue:!1,type:"boolean",category:"Behavior",recordFlag:!0},minWidth:{defaultValue:-1,type:"integer",category:"Appearance"},minHeight:{defaultValue:-1,type:"integer",category:"Appearance"},preferredWidth:{defaultValue:-1,type:"integer",category:"Appearance"},preferredHeight:{defaultValue:-1,type:"integer",category:"Appearance"},onClick:{defaultValue:void 0,type:"function",category:"Behavior"},clickMode:{defaultValue:0,type:"integer",category:"Behavior"},multiSelFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},showLabelFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},allowUnsafeHTMLLabel:{defaultValue:void 0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-controls-button"),window.matchMedia("(pointer: fine)").matches&&this.elements.container.addClassName("wux-pointer-fine"),this.elements.container.tabindex=0,this.elements.button=this.elements.container,this.isMultiSelection=!1,this.preventToggleSiblings=!1},t.prototype._applyIcon=function(e){"object"==typeof this.icon&&(this.icon.fontIconFamily||(this.icon.fontIconFamily=s.WUXManagedFontIcons.FontAwesome),this.icon.fontIconSize||"1x"===this.iconSize||(this.icon.fontIconSize=this.iconSize)),d.call(this)},t.prototype._applyIconSize=function(e){this.elements.icon&&("object"==typeof this.icon&&"1x"!==this.iconSize&&(this.icon.fontIconSize=this.iconSize),d.call(this))},t.prototype._applyEmphasize=function(e){if(e){var t="wux-ui-state-"+e;this.elements.button.removeClassName(t)}var i="wux-ui-state-"+this.emphasize;this.elements.button.addClassName(i)},t.prototype._applyDisplayStyle=function(e){e&&this.elements.button.removeClassName("wux-ui-style-"+e),this.elements.button.addClassName("wux-ui-style-"+this.displayStyle),"lite-borders"===this.displayStyle&&this.elements.icon?this.elements.icon.style.margin="0px 0px 0px 0px":this.elements.icon&&d.call(this)},t.prototype._applyPreferredWidth=function(e){this.preferredWidth>0?(this.elements.button.setStyles({"max-width":this.preferredWidth+"px"}),this.elements.button.setStyles({width:"100%"})):(this.elements.button.setStyles({"max-width ":""}),this.elements.button.setStyles({"width ":""}))},t.prototype._applyPreferredHeight=function(e){this.preferredHeight>0?(this.elements.button.setStyles({"max-height":this.preferredHeight+"px"}),this.elements.button.setStyles({height:"100%"})):(this.elements.button.setStyles({"max-height":""}),this.elements.button.setStyles({height:""}))},t.prototype._applyMinWidth=function(e){-1!=this.minWidth?this.elements.button.setStyles({"min-width":this.minWidth+"px"}):this.elements.button.setStyles({"min-width":""})},t.prototype._applyMinHeight=function(e){-1!=this.minHeight?this.elements.button.setStyles({"min-height":this.minHeight+"px"}):this.elements.button.setStyles({"min-height":""})},t.prototype._applyOnClick=function(e){e&&this.removeEventListener("buttonclick",e),this.onClick&&this.addEventListener("buttonclick",this.onClick)},t.prototype.handleEvents=function(){var e=this;l.addEventOnElement(this,this.elements.button,"click",(function(t){e.disabled||(e._actionHasBeenLaunchedOnDown||c.call(e,t),e._actionHasBeenLaunchedOnDown=void 0)})),l.addEventOnElement(this,this.elements.button,o.POINTERHIT,(function(t){e.disabled||2===t.multipleHitCount&&e.fire("buttonDblClick")})),l.addEventOnElement(this,this.elements.button,o.POINTERDOWN,(function(t){t.dsModel=e,e.disabled||1===e.clickMode&&(e._actionHasBeenLaunchedOnDown=!0,c.call(e,t))})),l.addEventOnElement(this,this.elements.button,"mousedrag",(function(t){t.dsModel=e})),l.addEventOnElement(this,this.elements.button,o.POINTERUP,(function(t){t.dsModel=e}))},t.prototype._applyCheckFlag=function(e){var t,i;if(!0===this.checkFlag?(this.elements.button.setAttributeNode(document.createAttribute("checked")),this.multiSelFlag||this.isMultiSelection||this.multiSelWithControlFlag&&this._latestActionOptions&&this._latestActionOptions.ctrlKey||this.preventToggleSiblings||this._uncheckSiblings()):this.elements.button.removeAttribute("checked"),void 0===e||e===this.checkFlag||this.preventTriggeringChangeEvent){if(!this.preventTriggeringChangeEvent){var n=null===(i=null===(t=this.elements)||void 0===t?void 0:t.button)||void 0===i?void 0:i.parentNode;n&&n.dsModel&&"buttonGroup"===n.dsModel.__proto__.name&&n.dsModel._onCheckFlagUpdated(this)}}else this.fire("change")},t.prototype._applyDisabled=function(t){e.prototype._applyDisabled.call(this),this.disabled?this.elements.button.removeAttribute("tabindex"):this.elements.button.setAttribute("tabindex",0)},t.prototype._applyLabel=function(e){void 0!==this.label&&""!==this.label?(this.elements.text||(this.elements.text=i.createElement("span"),this.elements.text.addClassName("wux-button-label"),this.elements.text.inject(this.elements.button),this._applyShowLabelFlag()),r.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLLabel)?this.elements.text.setContent(this.label):this.elements.text.textContent=this.label):this.elements.text&&(this._applyShowLabelFlag(),this.elements.text.remove(),this.elements.text=void 0,delete this.elements.text)},t.prototype._applyShowLabelFlag=function(){this.elements.text&&(this.showLabelFlag?(this.elements.text.show(),this.elements.button.setAttributeNode(document.createAttribute("showlabel"))):this.showLabelFlag||(this.elements.text.hide(),this.elements.button.removeAttribute("showlabel")))},t.prototype._applyAllowUnsafeHTMLLabel=function(){this._applyLabel(this.label)},t.prototype._applyTooltipInfos=function(){this.tooltipInfos||(this._properties.tooltipInfos.value=this._getDefaultTooltipInfos()),e.prototype._applyTooltipInfos.call(this)},t.prototype._getDefaultTooltipInfos=function(){var e=this;return{getAllInformationCB:function(){if(e.label&&e.showLabelFlag&&e.elements.text&&e.elements.text.scrollWidth>e.elements.text.offsetWidth)return{model:{shortHelp:e.label}}}}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("emphasize")&&this._applyEmphasize(t.emphasize),this.isDirty("displayStyle")&&this._applyDisplayStyle(t.displayStyle),this.isDirty("preferredWidth")&&this._applyPreferredWidth(t.preferredWidth),this.isDirty("preferredHeight")&&this._applyPreferredHeight(t.preferredHeight),this.isDirty("minWidth")&&this._applyMinWidth(t.minWidth),this.isDirty("minHeight")&&this._applyMinHeight(t.minHeight),this.isDirty("icon")?this._applyIcon(t.icon):this.isDirty("iconSize")&&this._applyIconSize(t.iconSize),(this.isDirty("allowUnsafeHTMLLabel")||this.isDirty("label"))&&this._applyLabel(t.label),this.isDirty("onClick")&&this._applyOnClick(t.onClick),this.isDirty("checkFlag")&&this._applyCheckFlag(t.checkFlag),this._applyDisplayStyle(t.displayStyle),this._applyShowLabelFlag()},t.prototype._uncheckSiblings=function(){var e=this;if("radio"===this.type){var i=this.elements.button.parentNode;if(i){var n=function(){for(var n=i.childNodes,s=0;s<n.length;s++)n[s]!==e.elements.button&&n[s].dsModel&&n[s].dsModel instanceof t&&"radio"===n[s].dsModel.type&&(n[s].dsModel.checkFlag=!1)};i.dsModel&&"buttonGroup"===i.dsModel.__proto__.name?i.dsModel.__privateLockChange((function(){n()})):n()}}},t.prototype._setDisplayingMenuFlag=function(e){!0===e?this.elements.button.setAttributeNode(document.createAttribute("is-displaying-menu")):this.elements.button.removeAttribute("is-displaying-menu")},t}(n);return h.addClass(m,"button"),m.prototype.markForRecordFlag=!0,a.register(m,"DS/ControlsRec/AbstractRec"),m}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/DropdownButton",["require","exports","DS/Controls/Abstract","DS/Controls/Button","DS/CoreBase/WebUXGlobalEnums","DS/Menu/Menu","DS/Core/WebUXComponents","./typings/types"],(function(e,t,i,n,s,o,l){"use strict";var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{emphasize:{defaultValue:"secondary",type:"string",category:"Appearance"},mainAction:{defaultValue:void 0,type:"object",category:"Appearance"},secondaryActions:{defaultValue:void 0,type:"Array<object> | Function",category:"Appearance",noNeedToApplyFlag:!0}}},enumerable:!1,configurable:!0}),t.prototype._postBuildView=function(){var t,i,l,a;e.prototype._postBuildView.call(this),this.elements.container.addClassName("wux-controls-dropdownbutton"),this.elements._mainButton=new n({emphasize:this.emphasize,label:null===(t=this.mainAction)||void 0===t?void 0:t.label,icon:null===(i=this.mainAction)||void 0===i?void 0:i.icon,onClick:null===(l=this.mainAction)||void 0===l?void 0:l.onClick,disabled:!!this.disabled||(null===(a=this.mainAction)||void 0===a?void 0:a.disabled)}),this.elements._mainButton.getContent().addClassName("wux-dropdownbutton-mainbutton"),this.elements._mainButton.inject(this.elements.container);var r=this;this.elements._expandButton=new n({emphasize:this.emphasize,icon:{fontIconFamily:s.WUXManagedFontIcons.Font3DS,iconName:"expand-down"},disabled:this.disabled,onClick:function(){if(r.secondaryActions){var e=function(e){var t,i=[];t="function"==typeof e?e():e;for(var n=0;n<t.length;n++)i.push({type:"PushItem",title:t[n].label,icon:t[n].icon,action:{callback:t[n].onClick},state:t[n].disabled?"disabled":""});return i}(r.secondaryActions),t=r.elements._expandButton.getContent().getBoundingClientRect();o.show(e,{position:{x:t.left,y:t.top+t.height},forceTouchMode:r._getCurrentTouchMode()},{onShow:function(){},onHide:function(){}})}}}),this.elements._expandButton.getContent().addClassName("wux-dropdownbutton-expanderbutton"),this.elements._expandButton.inject(this.elements.container)},t.prototype._applyEmphasize=function(e){this.elements._mainButton&&(this.elements._mainButton.emphasize=this.emphasize),this.elements._expandButton&&(this.elements._expandButton.emphasize=this.emphasize)},t.prototype._applyMainAction=function(e){var t,i,n,s;this.elements._mainButton&&(this.elements._mainButton.label=null===(t=this.mainAction)||void 0===t?void 0:t.label,this.elements._mainButton.icon=null===(i=this.mainAction)||void 0===i?void 0:i.icon,this.elements._mainButton.onClick=null===(n=this.mainAction)||void 0===n?void 0:n.onClick,this.elements._mainButton.disabled=!!this.disabled||(null===(s=this.mainAction)||void 0===s?void 0:s.disabled))},t.prototype._applyDisabled=function(t){var i;e.prototype._applyDisabled.call(this,t),this.elements._mainButton&&(this.elements._mainButton.disabled=!!this.disabled||(null===(i=this.mainAction)||void 0===i?void 0:i.disabled)),this.elements._expandButton&&(this.elements._expandButton.disabled=this.disabled)},t.prototype._applyTouchMode=function(t){e.prototype._applyTouchMode.call(this,t),this.elements._mainButton&&(this.elements._mainButton.touchMode=this.touchMode),this.elements._expandButton&&(this.elements._expandButton.touchMode=this.touchMode)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("emphasize")&&this._applyEmphasize(t.emphasize),this.isDirty("mainAction")&&this._applyMainAction(t.mainAction)},t}(i);return l.addClass(a,"dropdownbutton"),a}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,s=0,o=t.length;s<o;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))};define("DS/Controls/Calendar",["require","exports","DS/Controls/Abstract","DS/Controls/Button","DS/Utilities/LanguageUtils","DS/Core/PointerEvents","DS/Core/WebUXComponents","DS/Utilities/Dom","DS/Utilities/DateUtils","DS/Utilities/KeyboardUtils","i18n!./assets/nls/translation","text!./assets/json/weekInfoPerLanguage.json","DS/Controls/_private/MkmkMagic"],(function(e,t,i,n,s,o,l,a,r,h,u,c){"use strict";var d,p=e("DS/Controls/_private/MkmkMagic").AutoComplete,m={weekday:"long",year:"numeric",month:"long",day:"numeric"};d={lang:void 0,day_names:[],day_names_short:[],month_names:[],month_names_short:[],fstDayLang:void 0};var g=0;function f(e){return e[0].toUpperCase()+e.slice(1)}function v(e,t,i){this[e]=r.addToDate(this[e],t,i)}function y(e,t,i,n){return r.isDateInBetween(e,t,i,n||"day")}function _(e,t,i,n){if(e&&!y(e,t,i,n)){if(t&&e<t)return t;if(i&&e>i)return i}}function b(e,t,i){return r.areDatesEqual(e,t,i?"time":"day")}function C(e,t,i){return void 0===t&&void 0===e||!(!e||!t)&&(e instanceof Date&&t instanceof Date?b(e,t,i):Array.isArray(e)&&t instanceof Date?e.some((function(e){return b(e,t,i)})):!(!Array.isArray(e)||!Array.isArray(t))&&(e.length===t.length&&e.every((function(e){return C(e,t,i)}))))}function w(e,t,i){r.pushUniqueDate(e,t,i||"day")}function x(e,t,i){return"JanuaryFirst"===e?function(e,t){var i=e.getFullYear(),n=new Date(Date.UTC(i,e.getMonth(),e.getDate()));n.setUTCFullYear(i);var s=new Date(Date.UTC(i,0,1));s.setUTCFullYear(i);var o=s.getUTCDay()-t;o=o>=0?o:o+7;var l=Math.floor((n.getTime()-s.getTime())/864e5)+1,a=Math.floor((l+o)/7)+1;return 53===a?((s=new Date(Date.UTC(++i,0,1))).setUTCFullYear(i),a=Math.floor((s.getTime()-n.getTime())/864e5)+1>7?53:1):a>53&&(a=1),a}(t,i).toString():"FirstThursday"!==e?(window.console.warn("Invalid week number algorithm: ",e),""):function(e,t){var i=e.getFullYear(),n=new Date(Date.UTC(i,e.getMonth(),e.getDate()));n.setUTCFullYear(i);var s=new Date(Date.UTC(i,0,1));s.setUTCFullYear(i);var o=s.getUTCDay()-t;o=o>=0?o:o+7;var l=4-t;l=l>=0?l:l+7;var a=Math.floor((n.getTime()-s.getTime())/864e5)+1,r=Math.floor((a+o)/7);return o<=l&&(r+=1),53===r?((s=new Date(Date.UTC(++i,0,1))).setUTCFullYear(i),Math.floor((s.getTime()-n.getTime())/864e5)+1<=7&&(r=(o=s.getUTCDay())<=4?1:53)):r>53&&(r=1),r}(t,i).toString()}function E(e,t){if(void 0!==e&&!1!==e){if(!0===e)return s.useISO8601ForDateAndTime||1===t?"FirstThursday":"JanuaryFirst";if("JanuaryFirst"===e)return e;if("FirstThursday"===e)return e;window.console.warn("Invalid showWeekNumbers property value: ",e)}}function S(e,t){if(t.stopPropagation(),!1===this.disabled&&!e.classList.contains("unclickable")){var i=(e.getAttribute("data-value")||"").split("/"),n=!e.classList.contains("selected"),s=parseInt(i[0]),o=parseInt(i[1])-1,l=parseInt(i[2]),a=0,r=0,h=0,u=this._timePicker;u&&u.value&&(a=u.value.getHours(),r=u.value.getMinutes(),h="sec"===u.precision?u.value.getSeconds():0);var c=new Date(l,o,s,a,r,h);if(c.setFullYear(l),this.allowMultipleValuesFlag){var d=this.value;if(d){if(Array.isArray(d)){if(d=__spreadArray([],d,!0),n)d.push(c);else{for(var p=[],m=0,g=d.length;m<g;++m)C(d[m],c)||p.push(d[m]);if(!this.allowUndefinedFlag&&0===p.length)return;this._preventReferenceDateUpdate=!0,d=p}this.setPropertyFromUIInteraction("value",d),this._preventReferenceDateUpdate=!1}}else this.setPropertyFromUIInteraction("value",[c])}else this.allowUndefinedFlag&&!n?this.setPropertyFromUIInteraction("value",void 0):n&&this.setPropertyFromUIInteraction("value",c)}}var D=function(e){function t(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return e.apply(this,__spreadArray([t],i,!1))||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:void 0,type:"date",category:"Behavior",advancedSetter:!0},referenceDate:{defaultValue:void 0,type:"date",category:"Behavior"},minValue:{defaultValue:void 0,type:"date",category:"Behavior"},maxValue:{defaultValue:void 0,type:"date",category:"Behavior"},allowMultipleValuesFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},allowUndefinedFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},showWeekNumbers:{defaultValue:void 0,type:"boolean",category:"Appearance"},hideTodayOrNowButton:{defaultValue:!1,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_timePicker:{defaultValue:void 0,type:"object"},_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype._preBuild=function(t){e.prototype._preBuild.call(this,t);var i=new Date;this._properties.value.value=new Date(i.getTime()),t&&t.value&&!t.referenceDate&&(this._properties.referenceDate.value=Array.isArray(t.value)?t.value[t.value.length-1]:t.value),this._properties.referenceDate.value||(this._properties.referenceDate.value=i)},t.prototype.buildView=function(){this._updateLanguage(),this.elements.container.addClassName("wux-controls-calendar"),this.elements.container.setAttribute("tabindex",0),this.elements.calendarHeader=document.createElement("div"),this.elements.calendarHeader.classList.add("wux-controls-calendar-header"),this.elements.container.appendChild(this.elements.calendarHeader),this.elements.left=document.createElement("div"),this.elements.left.classList.add("wux-controls-calendar-button");var e=a.generateIcon("expand-left");e.classList.remove("wux-ui-3ds-lg"),this.elements.left.appendChild(e),this.elements.left.tooltipInfos={shortHelp:u.previousMonth||""},this.elements.calendarHeader.appendChild(this.elements.left),this.elements.center=document.createElement("div"),this.elements.center.classList.add("wux-controls-calendar-center"),this.elements.calendarHeader.appendChild(this.elements.center),this.elements.monthsCombo=new p({placeholder:"",customFilterMessage:u.noMonthsFound,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1,multiSearchMode:!1,elementsTree:d.month_names.map((function(e,t){return{label:e,value:t}})),_maximumItemsDisplayed:this._timePicker?8:7}).inject(this.elements.center),this.elements.right=document.createElement("div"),this.elements.right.classList.add("wux-controls-calendar-button"),(e=a.generateIcon("expand-right")).classList.remove("wux-ui-3ds-lg"),this.elements.right.appendChild(e),this.elements.right.tooltipInfos={shortHelp:u.nextMonth||""},this.elements.calendarHeader.appendChild(this.elements.right),this.elements.calendarContainer=document.createElement("table"),this.elements.calendarContainer.classList.add("wux-controls-calendar-table"),this.elements.container.appendChild(this.elements.calendarContainer),this.elements.calendarTabHead=document.createElement("thead"),this.elements.calendarTabHead.classList.add("wux-controls-calendar-table-head"),this.elements.calendarContainer.appendChild(this.elements.calendarTabHead),this._updateColumnsHeader(),this.elements.calendarFooter=document.createElement("div"),this.elements.calendarFooter.classList.add("wux-controls-calendar-footer"),this.elements.container.appendChild(this.elements.calendarFooter)},t.prototype._buildCalendarDays=function(e,t){var i=E(this.showWeekNumbers,g),n=new Date(t,e,1);n.setFullYear(t);var o,l,r=(o=n.getDay()-g)>=0?o:o+7,h=new Date,u=this.minValue&&new Date(this.minValue.getFullYear(),this.minValue.getMonth(),this.minValue.getDate()),c=this.maxValue&&new Date(this.maxValue.getFullYear(),this.maxValue.getMonth(),this.maxValue.getDate()+1),p=document.createElement("tbody");n.setDate(n.getDate()-r);for(var f=n.getMonth(),v=n.getFullYear(),y=0;y<r;++y){if(0===y)if(l=document.createElement("tr"),p.appendChild(l),i)(A=document.createElement("td")).classList.add("weeknumber"),A.innerText=x(i,n,g),l.appendChild(A);var _=n.getDate(),w=!0;(I=document.createElement("td")).innerText=_.toString(),I.tooltipInfos={shortHelp:n.toLocaleDateString(s.regionalFormatLanguage,m)},I.setAttribute("data-value",_+"/"+(f+1)+"/"+v),I.classList.add("other-date"),(u&&n<u||c&&n>=c)&&(I.classList.add("unclickable"),w=!1),C(this.value,n)&&I.classList.add("selected"),w&&a.addEventOnElement(this,I,"click",S.bind(this,I)),l.appendChild(I),n.setDate(_+1)}for(var D=r;n.getMonth()===e;){var A;_=n.getDate(),w=!0;if(0===D)if(l=document.createElement("tr"),p.appendChild(l),i)(A=document.createElement("td")).classList.add("weeknumber"),A.innerText=x(i,n,g),l.appendChild(A);(I=document.createElement("td")).innerText=_.toString(),I.tooltipInfos={shortHelp:n.toLocaleDateString(s.regionalFormatLanguage,m)},I.setAttribute("data-value",_+"/"+(e+1)+"/"+t),I.classList.add(b(n,h)?"today":"days"),(u&&n<u||c&&n>=c)&&(I.classList.add("unclickable"),w=!0),C(this.value,n)&&I.classList.add("selected"),w&&a.addEventOnElement(this,I,"click",S.bind(this,I)),l.appendChild(I),n.setDate(_+1),D=++D%d.day_names.length}if(0!==D){var F=n.getMonth(),P=n.getFullYear();for(y=D;y<d.day_names.length;++y){var I;_=n.getDate(),w=!0;(I=document.createElement("td")).innerText=_.toString(),I.tooltipInfos={shortHelp:n.toLocaleDateString(s.regionalFormatLanguage,m)},I.setAttribute("data-value",_+"/"+(F+1)+"/"+P),I.classList.add("other-date"),(u&&n<u||c&&n>=c)&&(I.classList.add("unclickable"),w=!1),C(this.value,n)&&I.classList.add("selected"),w&&a.addEventOnElement(this,I,"click",S.bind(this,I)),l.appendChild(I),n.setDate(_+1)}}return p.appendChild(l),p},t.prototype._buildYearsList=function(){var e=this.referenceDate.getFullYear(),t=-10,i=10,n=!1;this._yearsList&&-1===this._yearsList.indexOf(e)&&(n=!0),this._yearsList=[],this.minValue&&(t=this.minValue.getFullYear()-e),this.maxValue&&(i=this.maxValue.getFullYear()-e);for(var s=t;s<=i;s++)this._yearsList[this._yearsList.length]=e+s,n=!0;this.elements.yearsCombo?n&&(this._yearsComboUpdate=!0,this.elements.yearsCombo.elementsTree.toString()!==this._yearsList.toString()&&(this.elements.monthsCombo.value=this.referenceDate.getMonth(),this.elements.yearsCombo.elementsTree=this._yearsList.map((function(e){return{label:String(e),value:e}}))),this.elements.yearsCombo.value=e,this._yearsComboUpdate=void 0):(this.elements.yearsCombo=new p({placeholder:"",customFilterMessage:u.noMonthsFound,allowFreeInputFlag:!0,allowResetToUndefinedByUIFlag:!1,multiSearchMode:!1,elementsTree:this._yearsList.map((function(e){return{label:String(e),value:e}})),value:e,_maximumItemsDisplayed:this._timePicker?8:7}).inject(this.elements.center),this.elements.yearsCombo.getContent().classList.add("wux-calendar-yearscombo"),this.elements.yearsCombo.touchMode=this.touchMode)},t.prototype._buildTodayNowButton=function(){var e=this;this.elements.todayButton||(this.elements.todayButton=new n({label:this._timePicker?u.nowButtonLabel:u.todayButtonLabel,tooltipInfos:{shortHelp:this._timePicker?u.nowTooltip:u.todayTooltip},disabled:this.disabled||!this._checkTodayIsBetweenMinMaxValues(),touchMode:this.touchMode}).inject(this.elements.calendarFooter),this.elements.todayButton.getContent().classList.add("wux-controls-calendar-todaybutton"),a.addEventOnElement(this,this.elements.todayButton,"buttonclick",(function(){if(!1===e.disabled){var t=new Date;if(e.allowMultipleValuesFlag){var i=e.value;i?Array.isArray(i)&&(C(i,t,Boolean(e._timePicker))||((i=i.slice()).push(t),e._setCurrentDate(i))):e._setCurrentDate([t]),e._setReferenceDate(t)}else e._setCurrentDate(t)}})))},t.prototype._applyDisabled=function(t){e.prototype._applyDisabled.call(this,t),this.elements.todayButton&&(this.elements.todayButton.disabled=this.disabled)},t.prototype._applyTouchMode=function(t){e.prototype._applyTouchMode.call(this,t),this.elements.yearsCombo&&(this.elements.yearsCombo.touchMode=this.touchMode),this.elements.monthsCombo&&(this.elements.monthsCombo.touchMode=this.touchMode),this.elements.todayButton&&(this.elements.todayButton.touchMode=this.touchMode)},t.prototype.handleEvents=function(){var e,t,i=this,n=200;this._isLeftDown=!1,this._isRightDown=!1,a.addEventOnElement(this,this.elements.left,o.POINTERDOWN,(function(s){s.stopPropagation(),s.preventDefault(),i._isLeftDown=!0,(t||e)&&(clearTimeout(t),clearInterval(e)),t=setTimeout((function(){if(!i._isLeftDown)return clearTimeout(t),void clearInterval(e);e=setInterval((function(){if(!i._isLeftDown)return clearTimeout(t),void clearInterval(e);a.pushUserInteractionContext(),i._decrement(),a.popUserInteractionContext()}),n)}),n)})),a.addEventOnElement(this,this.elements.left,o.POINTERUP,(function(n){n.stopPropagation(),n.preventDefault(),clearTimeout(t),clearInterval(e),i._isLeftDown&&(i._decrement(),i._isLeftDown=!1)})),a.addEventOnElement(this,this.elements.right,o.POINTERDOWN,(function(s){s.stopPropagation(),s.preventDefault(),i._isRightDown=!0,(t||e)&&(clearTimeout(t),clearInterval(e)),t=setTimeout((function(){if(!i._isRightDown)return clearTimeout(t),void clearInterval(e);e=setInterval((function(){if(!i._isRightDown)return clearTimeout(t),void clearInterval(e);a.pushUserInteractionContext(),i._increment(),a.popUserInteractionContext()}),n)}),n)})),a.addEventOnElement(this,this.elements.right,o.POINTERUP,(function(n){n.stopPropagation(),n.preventDefault(),clearTimeout(t),clearInterval(e),i._isRightDown&&(i._increment(),i._isRightDown=!1)})),a.addEventOnElement(this,this.elements.monthsCombo,"show",(function(e){return e.stopPropagation})),a.addEventOnElement(this,this.elements.yearsCombo,"show",(function(e){return e.stopPropagation})),a.addEventOnElement(this,this.elements.monthsCombo,"hide",(function(e){return e.stopPropagation})),a.addEventOnElement(this,this.elements.yearsCombo,"hide",(function(e){return e.stopPropagation})),a.addEventOnElement(this,this.elements.monthsCombo,"change",(function(e){if(e.stopPropagation(),!i._redrawInProgress){var t=i.elements.monthsCombo.value;if(0<=t&&t<=12){var n=t-i.referenceDate.getMonth();n&&v.call(i,"referenceDate",n,"month")}else i.elements.monthsCombo.value=i.referenceDate.getMonth()}})),a.addEventOnElement(this,this.elements.yearsCombo,"change",(function(e){if(e.stopPropagation(),!i._redrawInProgress&&!i._yearsComboUpdate){var t=i.elements.yearsCombo.value;if(isNaN(t))i.elements.yearsCombo.value=i.referenceDate.getFullYear();else{var n=t-i.referenceDate.getFullYear();n&&v.call(i,"referenceDate",n,"year")}}})),a.addEventOnElement(this,this.elements.calendarContainer,o.POINTERMOVE,(function(e){e.preventDefault(),e.stopPropagation()})),a.addEventOnElement(this,this.elements.yearsCombo,"onwheel"in document?"wheel":"mousewheel",(function(e){(i.elements.yearsCombo===document.activeElement||i.getContent().hasAttribute("focused"))&&(e.preventDefault(),e.stopPropagation(),e.deltaY<0?i._decrement(!0):i._increment(!0))})),a.addEventOnElement(this,this.elements.container,"onwheel"in document?"wheel":"mousewheel",(function(e){(i.elements.container===document.activeElement||i.getContent().hasAttribute("focused"))&&(e.preventDefault(),e.stopPropagation(),e.deltaY<0?i._decrement():i._increment())})),a.addEventOnElement(this,this.elements.container,"keydown",(function(e){if(i.elements.container===document.activeElement||i.getContent().hasAttribute("focused")){var t=void 0;e.keyCode===h.LEFTARROW||e.keyCode===h.RIGHTARROW||e.keyCode===h.ARROWUP||e.keyCode===h.ARROWDOWN?t=!0:e.keyCode===h.PAGEUP?(i._decrement(),t=!0):e.keyCode===h.PAGEDOWN&&(i._increment(),t=!0),t&&(e.stopPropagation(),e.preventDefault())}})),a.addEventOnElement(this,document,o.POINTERUP,(function(){clearTimeout(t),clearInterval(e)})),this._updateOnCurrentLanguageChange=function(){i._updateLanguage(),i._updateColumnsHeader(),i._redrawCalendar()},s.subscribe("onRegionalFormatLanguageChange",this._updateOnCurrentLanguageChange)},t.prototype.destroy=function(){s.unsubscribe("onRegionalFormatLanguageChange",this._updateOnCurrentLanguageChange),e.prototype.destroy.call(this)},t.prototype._applyProperties=function(t){if(e.prototype._applyProperties.call(this,t),this._preventRedraw=!0,this.isDirty("_timePicker")&&this._apply_timePicker(t._timePicker,this._timePicker),this.isDirty("showWeekNumbers")&&this._applyShowWeekNumbers(),this.isDirty("referenceDate")&&(this._applyReferenceDate(t.referenceDate,this.referenceDate),this._preventReferenceDateUpdate=!0),this.isDirty("minValue")&&this._applyMinValue(),this.isDirty("maxValue")&&this._applyMaxValue(),this.isDirty("allowMultipleValuesFlag")){var i=this.allowMultipleValuesFlag;t.hasOwnProperty("value")&&t.value&&(t.value=i?[t.value]:t.value[0]),this._applyAllowMultipleValuesFlag(t.allowMultipleValuesFlag,i)}this.isDirty("hideTodayOrNowButton")&&this._applyHideTodayOrNowButton(t.hideTodayOrNowButton,this.hideTodayOrNowButton),this.isDirty("value")&&l._applyForAdvancedSetterProperty(this,"value",t.value,this.value),this._preventReferenceDateUpdate=!1,this._preventRedraw=!1,this._redrawNeeded&&this._redrawCalendar()},t.prototype._applyMinValue=function(){this._correctValueToMinMaxValues(),this.elements.todayButton&&(this.elements.todayButton.disabled=this.disabled||!this._checkTodayIsBetweenMinMaxValues())},t.prototype._applyMaxValue=function(){this._correctValueToMinMaxValues(),this.elements.todayButton&&(this.elements.todayButton.disabled=this.disabled||!this._checkTodayIsBetweenMinMaxValues())},t.prototype._checkTodayIsBetweenMinMaxValues=function(){return y(new Date,this.minValue,this.maxValue,this._timePicker?"time":"day")},t.prototype._correctValueToMinMaxValues=function(){var e=this,t=this.value,i=this.minValue,n=this.maxValue;if(t&&t instanceof Date)(o=_(t,i,n,this._timePicker?"time":"day"))&&this._setCurrentDate(o);else if(t&&Array.isArray(t)){var s;t=t.map((function(t){var i=_(t,e.minValue,e.maxValue,e._timePicker?"time":"day");return i&&(s=!0),i||t})),s&&this._setCurrentDate(t)}var o,l=this.referenceDate;l&&l instanceof Date&&((o=_(l,i,n,"month"))&&(this.referenceDate=o));this._redrawCalendar()},t.prototype._preEditValue=function(e,t){if(void 0===e&&void 0===t)return!1;if(void 0===t)return!0;if(null===t)return{validValue:void 0};if(this.allowMultipleValuesFlag){if(!Array.isArray(t))return!1;for(var i=0,n=t.length;i<n;++i)t[i]=r.convertToDate(t[i])}else{if(Array.isArray(t))return!1;if(!(t=r.convertToDate(t)))return!1}var s,o=this._timePicker?"time":"day";if(Array.isArray(t)){s=[];for(i=0;i<t.length;++i){var l=t[i];y(l=_(l,this.minValue,this.maxValue,o)||l,this.minValue,this.maxValue,o)&&w(s,new Date(l),o)}}else y(t=_(t,this.minValue,this.maxValue,o)||t,this.minValue,this.maxValue,o)&&(s=new Date(t));return!(!s||C(e,s,!0))&&{validValue:s}},t.prototype._applyValue=function(e,t){var i=!1;this._preventRedraw||(i=this._preventRedraw=!0),this._preventReferenceDateUpdate||(this.referenceDate=t),i&&(this._preventRedraw=!1,this._redrawCalendar()),this.fire("change")},t.prototype._applyReferenceDate=function(e,t){var i,n,s;i=(i=Array.isArray(t)?t.length?t[t.length-1]:void 0:t)?new Date(i):i,this.minValue&&(n=new Date(this.minValue.getFullYear(),0)),this.maxValue&&(s=new Date(this.maxValue.getFullYear(),11)),y(i,n,s,"month")||(i=e||new Date,this._properties.referenceDate.value=i),C(i,this.referenceDate)||(this._properties.referenceDate.value=i),C(e,i)||this._redrawCalendar()},t.prototype._applyAllowMultipleValuesFlag=function(e,t){if(t!==e){var i=this.value;t&&i&&!Array.isArray(i)?this._properties.value.value=[i]:!t&&i&&Array.isArray(i)&&(this._properties.value.value=1!==i.length?void 0:i[0]),t?this.getContent().setAttribute("multiple-values",""):this.getContent().removeAttribute("multiple-values")}},t.prototype._setCurrentDate=function(e){this.value=e},t.prototype._setReferenceDate=function(e){this.referenceDate=e},t.prototype._apply_timePicker=function(e,t){if(t!==e){e&&e.getContent().remove(),t&&this.elements.calendarFooter.prepend(t.getContent()),this.elements&&this.elements.monthsCombo&&(this.elements.monthsCombo._maximumItemsDisplayed=t?8:7),this.elements&&this.elements.yearsCombo&&(this.elements.yearsCombo._maximumItemsDisplayed=t?8:7);var i=this.elements.todayButton;i&&(i.label=t?u.nowButtonLabel:u.todayButtonLabel,i.tooltipInfos.shortHelp=t?u.nowTooltip:u.todayTooltip,i.disabled=this.disabled||!this._checkTodayIsBetweenMinMaxValues())}},t.prototype._applyShowWeekNumbers=function(){E(this.showWeekNumbers,g)?this.elements.container.setAttribute("withweeknumbers",""):this.elements.container.removeAttribute("withweeknumbers",""),this._updateColumnsHeader(),this._redrawCalendar()},t.prototype._applyHideTodayOrNowButton=function(e,t){this.elements.todayButton&&!0===t?(this.elements.todayButton.destroy(),this.elements.todayButton=void 0):!0!==t&&this._buildTodayNowButton()},t.prototype._increment=function(e){v.call(this,"referenceDate",1,e?"year":"month")},t.prototype._decrement=function(e){v.call(this,"referenceDate",-1,e?"year":"month")},t.prototype.incrementDayValue=function(){v.call(this,"value",1,"day")},t.prototype.decrementDayValue=function(){v.call(this,"value",-1,"day")},t.prototype.incrementMonthValue=function(){v.call(this,"value",1,"month")},t.prototype.decrementMonthValue=function(){v.call(this,"value",-1,"month")},t.prototype.incrementYearValue=function(){v.call(this,"value",1,"year")},t.prototype.decrementYearValue=function(){v.call(this,"value",-1,"year")},t.prototype._redrawCalendar=function(){if(this._preventRedraw)this._redrawNeeded=!0;else{this._redrawInProgress=!0;var e=this.referenceDate.getMonth(),t=this.referenceDate.getFullYear();this.elements.calendarTab&&this.elements.calendarTab.remove(),this.elements.calendarTab=this._buildCalendarDays(e,t),this.elements.calendarContainer.appendChild(this.elements.calendarTab),this._buildYearsList(),this.elements.monthsCombo.value=e,this.elements.yearsCombo.value=t,this._updateArrows(),this._redrawInProgress=!1,this._redrawNeeded=!1}},t.prototype._updateArrows=function(){var e=!0;this.minValue&&(0===this.referenceDate.getMonth()?this.minValue.getFullYear()>this.referenceDate.getFullYear()-1&&(e=!1):this.minValue.getFullYear()>this.referenceDate.getFullYear()&&(e=!1),e?this.elements.left.removeAttribute("disabled"):this.elements.left.setAttributeNode(document.createAttribute("disabled"))),e=!0,this.maxValue&&(11===this.referenceDate.getMonth()?this.maxValue.getFullYear()<this.referenceDate.getFullYear()+1&&(e=!1):this.maxValue.getFullYear()<this.referenceDate.getFullYear()&&(e=!1),e?this.elements.right.removeAttribute("disabled"):this.elements.right.setAttributeNode(document.createAttribute("disabled")))},t.prototype._updateColumnsHeader=function(){this.elements.calendarTabHead.textContent="";var e=document.createElement("tr");E(this.showWeekNumbers,g)&&e.appendChild(document.createElement("th"));for(var t=0;t<d.day_names_short.length;++t){var i=document.createElement("th");i.innerText=d.day_names_short[t],i.tooltipInfos={shortHelp:d.day_names[t]},e.appendChild(i)}this.elements.calendarTabHead.appendChild(e)},t.prototype._updateLanguage=function(){!function(){var e=s.regionalFormatLanguage,t=(null===navigator||void 0===navigator?void 0:navigator.language)||"en-GB";if(d.lang!==e||d.fstDayLang!==t){d={lang:e,day_names:[],day_names_short:[],month_names:[],month_names_short:[],fstDayLang:t};for(var i=new Date(Date.UTC(1900,0,1)),n=0;n<7;n++)d.day_names.push(f(i.toLocaleDateString(e,{weekday:"long",timeZone:"UTC"}))),d.day_names_short.push(i.toLocaleDateString(e,{weekday:"short",timeZone:"UTC"})),i.setDate(i.getDate()+1);var o=new Intl.Locale(t).weekInfo;if(!o)try{var l=JSON.parse(c);if(!(o=l[t])){var a=t.split("-");a.length>2&&(o=l[t=a[0]+"-"+a[1]]),o||(o=l[a[0]])}}catch(e){}if(o){g=(o.firstDay||0)%7;for(var r=o.firstDay-1||0,h=0;h<r;++h)d.day_names.push(d.day_names.shift()),d.day_names_short.push(d.day_names_short.shift())}for(s.useISO8601ForDateAndTime&&(g=1),e=s.regionalFormatLanguage,n=0;n<12;n++)d.month_names.push(f(i.toLocaleDateString(e,{month:"long"}))),d.month_names_short.push(i.toLocaleDateString(e,{month:"short"})),i.setMonth(i.getMonth()+1)}}(),this.elements.monthsCombo&&this.elements.monthsCombo.elementsTree.toString()!==d.month_names.toString()&&(this.elements.monthsCombo.elementsTree=d.month_names.map((function(e,t){return{label:e,value:t}})))},t}(i);return D.prototype.blackBoxFlag=!0,l.addClass(D,"calendar"),D}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Popup",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Utilities/Utils","DS/Utilities/Dom","DS/UIBehaviors/PopupManager","DS/Utilities/KeyboardUtils","DS/Core/PointerEvents","DS/Core/WebUXComponents","DS/Menu/Menu","DS/Utilities/typings/types","./typings/types"],(function(e,t,i,n,s,o,l,a,r,h,u){"use strict";var c="wux-controls-popup",d={x:0,y:0};function p(e){this.__preventCallShouldDisplayLock=!0,e.call(this),this.__preventCallShouldDisplayLock=!1}function m(){return!this.__preventCallShouldDisplayLock}function g(){var e=this.getContent();e&&e.setStyles({top:0,left:0,height:void 0,width:void 0,maxHeight:void 0,maxWidth:void 0,overflow:void 0})}function f(e){return e&&(e.disabled&&!e._showPopupOnDisabledTarget||e.dsModel&&e.dsModel.disabled&&!e.dsModel._showPopupOnDisabledTarget)}function v(e){var t=e.availableSpaces,i=e.boundaries,n=this.getContent();if(n){var o={overflow:"auto"},l=window.getComputedStyle(n);if("top"===this.position||"bottom"===this.position){var a=parseInt(l.paddingTop)+parseInt(l.paddingBottom),r=e.availableSpaces.left+e.availableSpaces.right+e.targetSize.width;Math.round(r)<Math.round(e.size.width)&&(e.size.height+=s.getScrollbarWidth()),t.top>t.bottom?(o.height=Math.min(e.size.height,Math.round(t.top-a)),o.top=Math.max(i.minPos.y,Math.round(e.targetPosition.y-o.height+e.offset.top.y-a))):(o.height=Math.min(e.size.height,Math.round(t.bottom-a)),o.top=Math.max(i.minPos.y,Math.round(e.targetPosition.y+e.targetSize.height+e.offset.bottom.y)));var h=o.height<e.size.height?s.getScrollbarWidth():0;o.left=Math.max(i.minPos.x,Math.min(i.maxPos.x-e.size.width-h,parseInt(l.left))),o.maxWidth=Math.round(i.maxPos.x-i.minPos.x)}else{var u=parseInt(l.paddingLeft)+parseInt(l.paddingRight);(r=e.availableSpaces.top+e.availableSpaces.bottom+e.targetSize.height)<e.size.height&&(e.size.width+=s.getScrollbarWidth());h=e.size.height>i.maxPos.y-i.minPos.y?s.getScrollbarWidth():0;t.left>t.right?(o.width=Math.min(e.size.width+h,Math.round(t.left-u)+h),o.left=Math.max(i.minPos.x,Math.round(e.targetPosition.x-o.width+e.offset.left.y))):(o.width=Math.min(e.size.width+h,Math.round(t.right-u+h)),o.left=Math.max(i.minPos.x,Math.round(e.targetPosition.x+e.targetSize.width+e.offset.right.x)));var c=o.width<e.size.width?s.getScrollbarWidth():0;o.top=Math.max(i.minPos.y,Math.min(i.maxPos.y-e.size.height-c,parseInt(l.top))),o.maxHeight=Math.round(i.maxPos.y-i.minPos.y)}n.setStyles(o)}}function y(e){this.visibleFlag&&this.elements&&this.elements.container&&this.hide()}var _=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return e.apply(this,t)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{identifier:{defaultValue:"",type:"string",readOnly:!0,category:"Behavior"},position:{defaultValue:"right",type:"string",category:"Appearance"},alignment:{defaultValue:"near",type:"string",category:"Appearance"},visibleFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},target:{defaultValue:null,type:"object",category:"Behavior",uiDisplay:!1},positionTarget:{defaultValue:null,type:"object",category:"Behavior",uiDisplay:!1},offset:{defaultValue:{x:0,y:0},type:"vector2",category:"Appearance",noNeedToApplyFlag:!0},constraint:{defaultValue:"none",type:"string",category:"Appearance"},trigger:{defaultValue:"",type:"string",category:"Behavior",uiDisplay:!1},mouseRelativePosition:{defaultValue:!1,type:"boolean",category:"Appearance",noNeedToApplyFlag:!0},overlap:{defaultValue:!0,type:"boolean",category:"Appearance"},overlapCallback:{defaultValue:v,type:"function",category:"Behavior"},shouldDisplayCallback:{defaultValue:null,type:"function",category:"Behavior"},beforeDisplayCallback:{defaultValue:null,type:"function",category:"Behavior"},postOverlapCallback:{defaultValue:null,type:"function",category:"Behavior"},toggleFlag:{defaultValue:!0,type:"boolean",category:"Behavior",noNeedToApplyFlag:!0},className:{defaultValue:"wux-controls-popup",type:"string",category:"Appearance"},arrowBoxFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},autoHide:{defaultValue:!0,type:"boolean",category:"Appearance"},usePaddingFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},forceKeepOrientation:{defaultValue:void 0,type:"boolean",category:"Appearance"},resizableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},preferredHeight:{defaultValue:void 0,type:"number",category:"Appearance",advancedSetter:!0}}},enumerable:!1,configurable:!0}),t.prototype.getBody=function(){if(this.elements)return this.elements.body},t.prototype.setBody=function(e){var t=this;this.elements.container&&this.elements.container.empty(),this.elements.body=e,e||delete this.elements.body,this.elements.container.setContent(e),this.elements.container.setAttribute("tabindex",0),this._applyArrowBoxFlag(),this.elements._footerDiv=new i.Element("div",{class:"wux-controls-popup-footer"}),this.elements._footerDiv.setStyle("width","100%"),this.elements._footerDiv.inject(this.elements.container),this.elements._resizeZone=new i.Element("div",{class:"wux-controls-popup-resize-zone"}),this.elements._resizeZone.inject(this.elements._footerDiv),this.elements._resizeZone.hide(),this.elements._bottomRightResizeHandler=new i.Element("div",{class:"wux-controls-popup-resize-handler wux-controls-popup-resize-handler-bottom-right wux-controls-popup-resize-handler-corner"}),this.elements._bottomRightResizeHandler.inject(this.elements.container),this._applyResizableFlag(),this._initialPointerPosition||(this._initialPointerPosition={x:0,y:0});var n=function(e){e.preventDefault();var i=e.clientX-t._initialPointerPosition.x,n=t._initialPopupSize.width+i;t.getContent().style.width=n.toString()+"px";var o=e.clientY-t._initialPointerPosition.y,l=t._initialPopupSize.height+o;if(t.getContent().style.height=l.toString()+"px",t.identifier){var a={width:n,height:l};s.saveDataInLocalPreferences({identifier:t.identifier},c,"dimension",a)}},l=function(e){var i=s.getDocumentOwner(t.elements.container);o.removeEventOnElement(t,i,r.POINTERMOVE,n),o.removeEventOnElement(t,i,r.POINTERUP,l),i.body.removeAttribute("resizing")};o.addEventOnElement(this,this.elements._bottomRightResizeHandler,r.POINTERDOWN,(function(e){!function(e){var i=s.getDocumentOwner(t.elements.container);i.body.setAttributeNode(i.createAttribute("resizing")),t._initialPointerPosition.x=e.clientX,t._initialPointerPosition.y=e.clientY,t._initialPopupSize.width=t.elements.container.clientWidth,t._initialPopupSize.height=t.elements.container.clientHeight}(e),o.addEventOnElement(t,t.elements.container.ownerDocument,r.POINTERMOVE,n),o.addEventOnElement(t,t.elements.container.ownerDocument,r.POINTERUP,l)}),!0),o.onNodeRendered(this.elements.container,(function(){t.elements&&t.elements.container&&(t._initialPopupSize={height:t.elements.container.clientHeight,width:t.elements.container.clientWidth})}))},t.prototype._applyArrowBoxFlag=function(){this.arrowBoxFlag?(this.elements.arrow||(this.elements.arrow=new i.Element("div",{class:"wux-controls-popup-arrow-"+this.position}),this.elements.arrow.inject(this.elements.container),this.elements.container.addClassName("wux-controls-popup-with-arrow")),this._updateView()):(this.elements.arrow&&(this.elements.arrow.style.display="none"),this.elements.container.removeClassName("wux-controls-popup-with-arrow"))},t.prototype._applyTarget=function(e){w.call(this),e&&o.removeOnNodeRemoved(e.elements&&e.elements.container?e.elements.container:e,this._targetRemovedToken),this.target&&(this._targetRemovedToken=o.onNodeRemoved(this.target.getContent?this.target.getContent():this.target,this._onTargetRemovedFromDOMBound)),this._updateView()},t.prototype._applyPositionTarget=function(e){this._updateView()},t.prototype._applyTrigger=function(e){w.call(this)},t.prototype._applyUsePaddingFlag=function(){this.usePaddingFlag?this.getContent().removeAttribute("no-padding"):this.getContent().setAttributeNode(document.createAttribute("no-padding"))},t.prototype._preEditPreferredHeight=function(e,t){if("auto"===t)return{validValue:void 0}},t.prototype._applyPreferredHeight=function(){this.preferredHeight?this.getContent().setStyle("height",this.preferredHeight+"px"):this.getContent().setStyle("height","auto")},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.className&&""!==this.className&&(this.elements.container.removeClassName("wux-controls-popup"),this.elements.container.addClassName(this.className)),this.isDirty("usePaddingFlag")&&this._applyUsePaddingFlag(),this.isDirty("target")?this._applyTarget(t.target):this._updateView()},t.prototype._preInject=function(){},t.prototype._postInject=function(){},t.prototype.show=function(t){var i=this;if(this.visibleFlag){if(m.call(this)&&this.shouldDisplayCallback&&!this.shouldDisplayCallback.call(null))return void(this.visibleFlag=!1);var n=this.target;if(!arguments[0]&&f(n))return this;var a=s.getDocumentOwner(n);if(!this._windowEventListenersSet){var r=s.getDocumentWindow(n);r.visualViewport&&(o.addEventOnElement(this,r.visualViewport,"resize",(function(){i._updateView()})),o.addEventOnElement(this,r.visualViewport,"scroll",(function(){i._updateView()}))),this._windowEventListenersSet=!0}if(this.elements&&this.elements.container){if(s.isFunction(this.beforeDisplayCallback)){var h=this.beforeDisplayCallback(this);if(h&&h.preventDisplay)return void(this.visibleFlag=!1)}!this._isVisibilityManagedByPopupManager||this._isMouseOver&&1===this._getVisibilityCounter()||l.add(this),this._preInject(),this.inject(a.body),this._postInject(),e.prototype.show.call(this,t),this._updateView(),this.fire("show")}this.mouseRelativePosition&&(this.elements.container.style.pointerEvents="none")}else this.visibleFlag=!0,this._applyArrowBoxFlag();if(!0===this.resizableFlag&&this.identifier){var u=s.getDataFromLocalPreferences({identifier:this.identifier},c,"dimension");u&&(this.getContent().style.width=u.width.toString()+"px",this.getContent().style.height=u.height.toString()+"px")}return this},t.prototype.hide=function(t){if(this.visibleFlag)this.visibleFlag=!1;else{e.prototype.hide.call(this,t),this._isVisibilityManagedByPopupManager&&l.remove(this);var i=o.getDocumentOwner(this.target);if(this.elements&&this.elements.container){var n=null==i?void 0:i.activeElement,s=null==n?void 0:n.tagName.toLowerCase();"input"!==s&&"textarea"!==s||!o.isElementInside(n,this.elements.container)||n.blur(),this.elements.container.remove(i.body),g.call(this),this.fire("hide",{trigger:this._escapeKbdAction?"escape":""})}}},t.prototype._applyVisibleFlag=function(e){if(this.visibleFlag&&!this._globalListening){var t=s.getDocumentWindow(this.getContent());this._scrollAtShow.x=t.scrollX,this._scrollAtShow.y=t.scrollY,this._resizeAndScrollEvtsHandler=o.addScrollAndResizeListener(this,this.target,this._hideThisPopupBound),this._globalListening=!0}else!this.visibleFlag&&this._globalListening&&(this._resizeAndScrollEvtsHandler&&(o.removeScrollAndResizeListener(this._resizeAndScrollEvtsHandler),delete this._resizeAndScrollEvtsHandler),this._globalListening=null);this.visibleFlag?this.show():this.hide()},t.prototype._applyResizableFlag=function(){if(this.elements._resizeZone&&this.elements._bottomRightResizeHandler)if(!0===this.resizableFlag){if(this.elements._resizeZone.show(),this.elements._bottomRightResizeHandler.show(),this.identifier){var e=s.getDataFromLocalPreferences({identifier:this.identifier},c,"dimension");e&&(this.getContent().style.width=e.width.toString()+"px",this.getContent().style.height=e.height.toString()+"px")}}else this.elements._resizeZone.hide(),this.elements._bottomRightResizeHandler.hide()},t.prototype.isElementInside=function(e){if(!e)return!1;var t=l.getContainingPopup(e);return!!t&&(t.options.grid.data===this||this.isElementInside(t.options.grid.data.target))},t.prototype.toggle=function(){var e=this.visibleFlag;this.visibleFlag=!e},t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t),this._isVisibilityManagedByPopupManager=!0},t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-popup"),this.elements.container.setStyles({left:0,top:0}),this._hideThisPopupBound=C.bind(this),this._scrollAtShow={x:0,y:0},this._onTargetRemovedFromDOMBound=y.bind(this)},t.prototype.destroy=function(){this.target&&this._targetRemovedToken&&o.removeOnNodeRemoved(this.target.elements&&this.target.elements.container?this.target.elements.container:this.target,this._targetRemovedToken),e.prototype.destroy.call(this)},t.delayPopupCreation=function(e,i){var n,l=e.target,h=function(o,l){if((!o||"mouseover"!==o.type||0===o.buttons)&&(!o||"keydown"!==o.type||a.isAlphaNumeric(o.keyCode))&&(!e.shouldDisplayCallback||e.shouldDisplayCallback.call(null))&&(!this||!f(this))){n(),e.visibleFlag=!1;var h=new t(e);o&&"mouseover"===o.type?h._isMouseOver=!0:o&&o.type===r.POINTERDOWN?h._isMousePressed=!0:o&&"click"===o.type&&(h._isClicked=!0),l||(l=e.getBody.call());var u=function(){h.setBody(l),i(h),p.call(h,(function(){h.visibleFlag=!0}))};s.isPromise(l)?l.then((function(e){l=e,u()})):u(),o&&"mouseover"!==o.type&&"focus"!==o.type&&o.stopPropagation()}};l&&e.trigger?(n=function(){o.removeEventOnElement(l,l,"mouseover",h),o.removeEventOnElement(l,l,"focus",h),o.removeEventOnElement(l,l,"click",h),o.removeEventOnElement(l,l,r.POINTERDOWN,h),o.removeEventOnElement(l,l,"keydown",h)},e.trigger.split(" ").forEach((function(e){"hover"===e&&o.addEventOnElement(l,l,"mouseover",h),"focus"===e&&o.addEventOnElement(l,l,"focus",h),"click"===e&&o.addEventOnElement(l,l,"click",h),"mousePress"===e&&o.addEventOnElement(l,l,r.POINTERDOWN,h),"keydown"===e&&o.addEventOnElement(l,l,"keydown",h)}))):n=function(){};return{removeListeners:n,createVisiblePopup:h}},t.prototype.handleEvents=function(){var e=this,t=this;o.addEventOnElement(this,this.elements.container,"click",(function(t){l.removeChild(e)})),o.addEventOnElement(this,this.elements.container,"dimensionsChanged",(function(){t.preferredHeight||t.getContent().setStyle("height","auto"),t._updateView()}))},t.prototype._updateView=function(){if(this.visibleFlag){var e=this.positionTarget?this.positionTarget:this.target,t=s.convertOffsetToAdvancedOffset(this.offset,this.position);this.arrowBoxFlag&&(t.bottom.y+=7,t.top.y-=7,t.right.x+=7,t.left.x-=7),this._applyPreferredHeight();var i=s.setConstrainedPosition(this,e,{position:this.position,alignment:this.alignment,offset:t,constraint:this.constraint,overlap:this.overlap,mouseRelativePosition:this.mouseRelativePosition,mousePosition:d,mouseOffset:{x:-10,y:10},forceKeepOrientation:this.forceKeepOrientation});this._latestComputedPosition=i.positionToTarget,this.arrowBoxFlag&&(this.elements.arrow.className="wux-controls-popup-arrow arrow-"+this._latestComputedPosition),!1===i.success&&s.isFunction(this.overlapCallback)&&(this.overlapCallback(i),this.postOverlapCallback&&this.postOverlapCallback(i))}},t.prototype._getVisibilityCounter=function(){var e=o.getDocumentOwner(this.target),t=0;return this.trigger.includes("focus")&&e.activeElement==this.target&&t++,this.trigger.includes("hover")&&this._isMouseOver&&t++,this.trigger.includes("mousePress")&&this._isMousePressed&&t++,this.trigger.includes("click")&&this._isClicked&&t++,t},t.prototype._managePopupVisibility=function(){var e=this._getVisibilityCounter();e>0?this.visibleFlag?this._isMouseOver&&e>1&&l.add(this):this.visibleFlag=!0:this.visibleFlag=!1},t.prototype.storeMousePosition=function(e){this.mouseRelativePosition&&(d.x=e.pageX,d.y=e.pageY)},t}(n);function b(e,t){if(!s.isHTMLElement(e))return null;var i=window.getComputedStyle(e)["overflow-y"];return e.scrollHeight>e.offsetHeight&&("scroll"===i||"auto"===i)?e:e===t?null:b(e.parentNode)}function C(e){if(e.target&&"resize"!==e.type){if(this.isElementInside(e.target)){var t=0;"mousewheel"===e.type||"scroll"===e.type?t=e.wheelDelta:"DOMMouseScroll"===e.type&&(t=-e.detail),this._scrollDown=!(t>=0);var i=b(e.target,this.elements.container);return i&&(i.offsetHeight+i.scrollTop>=i.scrollHeight&&this._scrollDown||0===i.scrollTop&&!this._scrollDown)&&e.preventDefault(),void(i=null)}this.visibleFlag=!1}else"resize"===e.type&&(this.visibleFlag=!1)}function w(){o.removeAllEventsOnElement(this);var e=this,t=this.trigger.split(" "),i=this.target;i&&t.forEach((function(t){if("hover"===t&&(o.addEventOnElement(e,i,"mousemove",(function(t){e.storeMousePosition(t),0!==t.buttons||e._isMouseOver||(e.storeMousePosition(t),e._isMouseOver=!0,e._managePopupVisibility())})),o.addEventOnElement(e,i,"mouseover",(function(t){0===t.buttons&&(e.storeMousePosition(t),e._isMouseOver=!0,e._managePopupVisibility())})),o.addEventOnElement(e,i,"mouseleave",(function(){e._isMouseOver=!1,e._managePopupVisibility()}))),"focus"===t&&(o.addEventOnElement(e,i,"focus",(function(){e._managePopupVisibility()})),o.addEventOnElement(e,i,"blur",(function(){e._managePopupVisibility()}))),"mousePress"===t&&o.addEventOnElement(e,i,r.POINTERDOWN,(function(){e._isMousePressed=!0,e._managePopupVisibility();var t=o.getDocumentOwner(i);o.addEventOnElement(e,t,r.POINTERUP,(function i(){e._isMousePressed=!1,e._managePopupVisibility(),o.removeEventOnElement(e,t,r.POINTERUP,i)}))})),"click"===t){o.addEventOnElement(e,i,"click",(function(t){e.target&&!f(e.target)&&(t.stopPropagation(),e._isClicked=!0,e.storeMousePosition(t),e.toggleFlag?(!e.visibleFlag||e.target.canClosePopup&&!e.target.canClosePopup(!1))&&e.visibleFlag||e.callMethodFromUIInteraction("toggle"):e.setPropertyFromUIInteraction("visibleFlag",!0),e._isClicked=!1)}));var n=function(t){var i=!1;if(t.target){var n=u.getMenuItemUidFromNode(t.target),s=n?u.getMenuDescriptionFromUid(n):void 0;s&&(i=void 0!==s.submenu&&(void 0===s.action||t.target.classList.contains("wux-menu-submenu")))}var l=e.target.elements?e.target.getContent():e.target;i||e.isElementInside(t.target)||o.isElementInside(t.target,l)||!e.autoHide||l&&l.canClosePopup&&!l.canClosePopup(!0)||e.setPropertyFromUIInteraction("visibleFlag",!1)},s=o.getDocumentOwner(e.target),l=s?s.defaultView:null,h=function(e){e.target===l&&n(e)};o.addEventOnElement(e,e,"show",(function(){o.addEventOnElement(e,s.body,r.POINTERDOWN,n,!0),l&&o.addEventOnElement(e,l,"blur",h,!0)})),o.addEventOnElement(e,e,"hide",(function(t){t.target===e.getContent()&&(o.removeEventOnElement(e,s.body,r.POINTERDOWN,n,!0),l&&o.removeEventOnElement(e,l,"blur",h,!0))}))}"escape"===t&&o.addEventOnElement(e,e.getContent(),"keydown",(function(t){a.ESCAPE===t.keyCode&&(e._escapeKbdAction=!0,t.actionPerformed=!0,e.visibleFlag=!1,e._escapeKbdAction=!1)}))}))}return function(e){!function(e){e[e.NoAdjust=0]="NoAdjust",e[e.AdjustToVisibleContents=1]="AdjustToVisibleContents",e[e.AdjustToAllContents=2]="AdjustToAllContents",e[e.Crop=3]="Crop"}(e.SizeAdjustPolicyEnum||(e.SizeAdjustPolicyEnum={}))}(_||(_={})),h.addClass(_,"popup"),_})),define("DS/Controls/Flyout",["UWA/Core","DS/Utilities/Dom","DS/Controls/Abstract","DS/Controls/Button","DS/Controls/Popup","DS/Menu/Menu"],(function(e,t,i,n,s,o){"use strict";var l={STANDARD:0,CHECK:1},a={EXPANDER:0,BUTTON:1};function r(e){for(let t=0;t<e.length;t++)e[t].state?e[t].state.indexOf("enabled")>-1?e[t].state.replace("enabled","disabled"):-1===e[t].state.indexOf("disabled")&&(e[t].state+="|disabled"):e[t].state="disabled",e[t].subMenu&&r(e[t].subMenu)}function h(t,i){if(i&&i.disabled){let i=e.clone(t,!0);return r(i),i}return t}var u=function(){this.extendedView&&this.extendedView.menuModel?this._delayPopupCreation&&this._delayPopupCreation.removeListeners.call():this._delayPopupCreation||c.call(this)},c=function(){var e=this;if(!this.elements.popup){var t={target:m.call(e),positionTarget:e.elements._button.elements.iconPlaceholder,position:"bottom",offset:{x:0,y:4},alignment:"near",className:"wux-controls-popup wux-controls-flyout-popup",constraint:"screen",overlap:!1,trigger:"click",usePaddingFlag:!1,getBody:function(){return e.getExtendedView()}};this._delayPopupCreation=s.delayPopupCreation(t,(function(t){e.elements.popup=t}))}},d=function(e){var t=this;if(!this._menuDisplayed){var i=this.getContent().getBoundingClientRect();o.show(e,{position:{x:i.left,y:i.top+i.height},forceTouchMode:this._getCurrentTouchMode()},{onShow:()=>{t.elements._button._setDisplayingMenuFlag(!0)},onHide:()=>{t._menuDisplayed=!1,t.elements._button._setDisplayingMenuFlag(!1)}}),this._menuDisplayed=!0}},p=function(){o.hide(),this._menuDisplayed=!1},m=function(){return this.displayMode===f.DISPLAY_MODE.EXPANDER?this.elements._expanderPickingDiv:this.elements._button},g=function(){this.isExtendedViewVisible()?this.hideExtendedView():this.showExtendedView()},f=i.inherit({name:"flyout",publishedProperties:{label:{defaultValue:"",type:"string"},icon:{defaultValue:null,type:"string"},onClick:{defaultValue:null,type:"function",noNeedToApply:!0},showLabelFlag:{defaultValue:!1,type:"boolean"},type:{defaultValue:l.STANDARD,type:"DS/Controls/Flyout.TYPE"},checkFlag:{defaultValue:!1,type:"boolean"},mainElementDisabledFlag:{defaultValue:!1,type:"boolean"},extendedView:{defaultValue:null,type:"object"},getExtendedView:{defaultValue:function(){return this.extendedView},type:"function"},displayMode:{defaultValue:a.EXPANDER,type:"DS/Controls/Flyout.DISPLAY_MODE"},allowUnsafeHTMLLabel:{defaultValue:!1,type:"boolean"}},_extendedMode:void 0,isExtendedViewVisible:function(){switch(this._extendedMode){case void 0:return!1;case"menu":return this._menuDisplayed;case"popup":return void 0!==this.elements.popup&&this.elements.popup.visibleFlag}},showExtendedView:function(){var e=this.getExtendedView();if(e&&e.menuModel){this._extendedMode="menu";let t=h(e.menuModel,{disabled:this.disabled});d.call(this,t)}else this._extendedMode="popup",e&&this._needUpdatePopupBody?(!this.elements.popup&&this._delayPopupCreation&&this._delayPopupCreation.createVisiblePopup(void 0,e),this.elements.popup&&this.elements.popup.getBody()!==e?this.elements.popup.setBody(e):this.elements.popup&&(this.elements.popup.visibleFlag=!0)):this.elements.popup&&(this.elements.popup.visibleFlag=!0);this._needUpdatePopupBody&&(this._needUpdatePopupBody=!1)},hideExtendedView:function(){this.elements.popup?this.elements.popup.visibleFlag=!1:p.call(this)},_applyLabel:function(e){this.elements._button&&(this.elements._button.label=this.label)},_applyIcon:function(e){this.elements._button&&(this.elements._button.icon=this.icon)},_applyShowLabelFlag:function(e){this.showLabelFlag?this.elements.container.setAttributeNode(document.createAttribute("showlabel")):this.elements.container.removeAttribute("showlabel"),this.elements._button&&(this.elements._button.showLabelFlag=this.showLabelFlag)},_applyType:function(e){this.elements._button&&(this.elements._button.type=this.displayMode===f.DISPLAY_MODE.EXPANDER&&this.type===f.TYPE.CHECK?"check":"standard",this._applyCheckFlag())},_applyCheckFlag:function(){this.elements._button&&(this.elements._button.checkFlag="check"===this.elements._button.type&&this.checkFlag)},_applyExtendedView:function(e){this._needUpdatePopupBody=!0,u.call(this)},_applyGetExtendedView:function(e){this._needUpdatePopupBody=!0},_applyDisplayMode:function(e){this.displayMode===f.DISPLAY_MODE.EXPANDER?this.elements.container.setAttribute("displayMode","expander"):this.elements.container.setAttribute("displayMode","button"),this._applyType()},_applyDisabled:function(){this._updateMainElementDisabledState()},_applyMainElementDisabledFlag:function(){this._updateMainElementDisabledState()},_updateMainElementDisabledState:function(){if(this.displayMode!==f.DISPLAY_MODE.BUTTON){let e=this.disabled||this.mainElementDisabledFlag;this.elements&&this.elements._button&&(this.elements._button.disabled=e)}},_applyAllowUnsafeHTMLLabel:function(e){this.elements._button&&(this.elements._button.allowUnsafeHTMLLabel=this.allowUnsafeHTMLLabel)},_applyTouchMode:function(){this._parent(),this.elements._button&&(this.elements._button.touchMode=this.touchMode)},_applyProperties:function(e){this._parent(e),this.elements._button&&(this.isDirty("label")||this.isDirty("icon")||this.isDirty("type")&&this.displayMode!==f.DISPLAY_MODE.BUTTON||this.isDirty("checkflag")&&this.type===f.TYPE.CHECK&&this.displayMode!==f.DISPLAY_MODE.BUTTON||this.isDirty("showLabelFlag")||this.isDirty("allowUnsafeHTMLLabel"))&&this.elements._button.setProperties({label:this.label,icon:this.icon,type:this.type,checkflag:this.checkflag,showLabelFlag:this.showLabelFlag,allowUnsafeHTMLLabel:this.allowUnsafeHTMLLabel}),this.isDirty("mainElementDisabledFlag")&&!this.isDirty("disabledFlag")&&this._applyMainElementDisabledFlag(),this.isDirty("showLabelFlag")&&(this.showLabelFlag?this.elements.container.setAttributeNode(document.createAttribute("showlabel")):this.elements.container.removeAttribute("showlabel")),this.isDirty("displayMode")&&this._applyDisplayMode(e.displayMode),this.isDirty("touchMode")&&this._applyTouchMode(e.touchMode),(this.isDirty("getExtendedView")||this.isDirty("extendedView"))&&(this._needUpdatePopupBody=!0)},_preBuildView:function(e){this._parent(e),this.getContent().addClassName("wux-controls-flyout")},buildView:function(){this._parent(),this.elements._expanderPickingDiv=new e.Element("div",{class:"wux-controls-flyout-expander-picking"}).inject(this.elements.container),this.elements.container.setAttributeNode(document.createAttribute("displayMode")),this.elements._expanderDiv=new e.Element("div",{class:"wux-controls-flyout-expander"}).inject(this.elements._expanderPickingDiv),this.elements._button=null,this._needUpdatePopupBody=!0},_postBuildView:function(){this.elements._button=new n({label:this.label,icon:null!==this.icon?this.icon:void 0,type:this.displayMode===f.DISPLAY_MODE.EXPANDER&&this.type===f.TYPE.CHECK?"check":"standard",checkFlag:this.displayMode===f.DISPLAY_MODE.EXPANDER&&this.type===f.TYPE.CHECK&&this.checkFlag,showLabelFlag:this.showLabelFlag,allowUnsafeHTMLLabel:this.allowUnsafeHTMLLabel,emphasize:"secondary",displayStyle:"smartIcon",touchMode:this.touchMode}).inject(this.getContent()),this._updateMainElementDisabledState();var e=this;t.addEventOnElement(this,this.elements._button,"buttonclick",(function(t){t.stopPropagation(),e.displayMode===f.DISPLAY_MODE.EXPANDER&&e.onClick&&!e.disabled?e.onClick():e.displayMode===f.DISPLAY_MODE.BUTTON&&g.call(e)})),u.call(this)},destroy:function(){this._parent(),this.hideExtendedView()},_handleEvents:function(){this._parent();var e=this;t.addEventOnElement(this,this.elements._expanderPickingDiv,"click",(function(t){t.stopPropagation(),g.call(e)}))}});return f.DISPLAY_MODE=a,f.TYPE=l,f}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Toolbar",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Utilities/Utils","DS/Utilities/Dom","DS/Controls/Button","DS/Controls/Popup","DS/Utilities/Array","DS/Core/WebUXComponents","DS/Utilities/TouchUtils","DS/CoreBase/WebUXGlobalEnums"],(function(e,t,i,n,s,o,l,a,r,h,u,c){"use strict";var d,p,m="wux-controls-toolbar-category-separator",g=[c.TOOLBAR_POSITIONS.NEAR,c.TOOLBAR_POSITIONS.CENTER,c.TOOLBAR_POSITIONS.FAR],f=0,v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{overflowManagement:{defaultValue:"scroll",type:"string",category:"Behavior"},direction:{defaultValue:"horizontal",type:"string",category:"Appearance"},verticalAlign:{defaultValue:c.TOOLBAR_POSITIONS.CENTER,type:"string",category:"Appearance"},adaptSizeToParent:{defaultValue:!1,type:"boolean",category:"Appearance"},popupClass:{defaultValue:void 0,type:"string",category:"Appearance",readOnly:!0}}},enumerable:!1,configurable:!0}),t.prototype.add=function(e,t){switch(e){case"element":t.element&&t.position&&(s.isUWAElement(t.element)||(t.element=i.extendElement(t.element)),t.element.addClassName("wux-toolbar-items wux-toolbar-items-"+t.position),y.call(this,"element",{element:t.element,position:t.position,index:t.index,priority:t.priority||0,category:t.category,data:t.data,alwaysInOverflow:t.alwaysInOverflow,visibleFlag:void 0===t.visibleFlag||t.visibleFlag,id:t.id?t.id:"ID_".concat(f++)}),"scroll"!==this.overflowManagement&&-1===this._resizeListeners.indexOf(t.position)&&(this._resizeListeners.push(t.position),o.addResizeObserver(this,this._getContainerFromPosition(t.position),p.bind(this))),t.alwaysInOverflow&&this.elements.dropdownButtonContainer&&this.elements.dropdownButtonContainer.isHidden()&&this.elements.dropdownButtonContainer.show());break;case"separator":if(t.element){var n=r.getIndexOfElement(this._elementsArray,"element",t.element);if(-1===n)return;var l=new i.createElement("div",{class:"wux-controls-toolbar-separator"}),a=this._elementsArray[n];this._elementsArray.splice(n,0,{type:"separator",element:l,position:a.position,container:a.container,priority:t.priority||a.priority,category:t.category,data:t.data,id:t.id?t.id:"ID_".concat(f++)});for(var h=g.indexOf(a.position)+1;h<g.length;h++)-1!==this._firstElementIndexForPosition[g[h]]&&this._firstElementIndexForPosition[g[h]]++;a.element.getParent().insertBefore(l,a.element)}else if(t.position){if(-1===this._firstElementIndexForPosition[t.position])return;l=new i.createElement("div",{class:"wux-controls-toolbar-separator"});y.call(this,"separator",{element:l,position:t.position,index:t.index,priority:t.priority||0,category:t.category,data:t.data,id:t.id?t.id:"ID_".concat(f++)})}}},t.prototype.removeItem=function(e,t){switch(e){case"element":if(t.element){var i=r.getIndexOfElement(this._elementsArray,"element",t.element);if(-1===i)return;C.call(this,i)}else if(t.position&&void 0!==t.index){if(-1===this._firstElementIndexForPosition[t.position])return;for(var n=g.indexOf(t.position),s=this._elementsArray.length-1,o=n+1;o<g.length;o++)if(-1!==this._firstElementIndexForPosition[g[o]]){s=this._firstElementIndexForPosition[g[o]]-1;break}var l=Math.min(s-this._firstElementIndexForPosition[t.position],t.index);if("separator"===this._elementsArray[this._firstElementIndexForPosition[t.position]+l].type)return;C.call(this,this._firstElementIndexForPosition[t.position]+l)}break;case"separator":if(t.position&&void 0!==t.index){if(-1===this._firstElementIndexForPosition[t.position])return;for(n=g.indexOf(t.position),s=this._elementsArray.length-1,o=n+1;o<g.length;o++)if(-1!==this._firstElementIndexForPosition[g[o]]){s=this._firstElementIndexForPosition[g[o]]-1;break}l=Math.min(s-this._firstElementIndexForPosition[t.position],t.index);if("separator"!==this._elementsArray[this._firstElementIndexForPosition[t.position]+l].type)return;C.call(this,this._firstElementIndexForPosition[t.position]+l)}}},t.prototype.clearPosition=function(e){var t=this._elementsArray.filter((function(t){return t.position===e}));if(0!==t.length){for(var i=0,n=t;i<n.length;i++){var s=n[i];C.call(this,this._elementsArray.indexOf(s))}var o=this._getContainerFromPosition(e);(o?Array.from(o.getElementsByClassName(m)):[]).forEach((function(e){return e.remove()}))}},t.prototype.clear=function(){for(var e=0;e<g.length;e++)this.clearPosition(g[e])},t.prototype.getPositionFromElement=function(e){for(var t=0;t<g.length;t++){var i=this._getContainerFromPosition(g[t]);if(e.getParent()===i)return{position:g[t],index:i.getChildren().indexOf(e),container:"toolbar"}}var n=this.getPopupContent();if(e.getParent()===n)return{position:this.getItemFromElement(e).position,index:n.getChildren().indexOf(e),container:"popup"}},t.prototype.modelModified=function(){P.call(this)},t.prototype.getItemFromElement=function(e){var t=r.getIndexOfElement(this._elementsArray,"element",e);return-1!==t?this._elementsArray[t]:void 0},t.prototype.getItemFromIndex=function(e){if(e>=0&&e<this._elementsArray.length)return this._elementsArray[e]},t.prototype.getNumberOfItems=function(){return this._elementsArray.length},t.prototype.enablePopupBehavior=function(e){e=e||{},this._showEverything=e.showEverything||this._showEverythingDefault,this._moveFromToolbarToPopup=e.moveFromToolbarToPopup||this._moveFromToolbarToPopupDefault,this._moveFromPopupToToolbar=e.moveFromPopupToToolbar||this._moveFromPopupToToolbarDefault,this._onPopupCreationFunction=e.onPopupCreationFunction||this._onPopupCreationFunctionDefault,this._popupBeforeDisplayCallback=e.popupBeforeDisplayCallback,this._popupPostOverlapCallback=e.popupPostOverlapCallback,this._onResize()},t.prototype.buildView=function(){var e=this;this._elementsArray=new Array,this._firstElementIndexForPosition={near:-1,center:-1,far:-1},this._listeningResizeEvent=!1,this._resizeListeners=[],this._enableCalculus=function(e){this._isCalculusEnabled=!0},this._enableSizeCalculus=function(e){return this._isCalculusEnabled},this.enablePopupBehavior(),this.elements.container.addClassName("wux-controls-toolbar"),this.elements.maskContainer=new i.createElement("div",{class:"wux-controls-toolbar-mask-container"}).inject(this.elements.container),this.elements.nearContainer=new i.createElement("div",{class:"wux-controls-toolbar-containers wux-controls-toolbar-nearContainer"}).inject(this.elements.maskContainer),this.elements.centerContainer=new i.createElement("div",{class:"wux-controls-toolbar-containers wux-controls-toolbar-centerContainer"}).inject(this.elements.maskContainer),this.elements.farContainer=new i.createElement("div",{class:"wux-controls-toolbar-containers wux-controls-toolbar-farContainer"}).inject(this.elements.maskContainer),this.elements.container.dsModel=this,this.elements.maskContainer.dsModel=this,this.elements.popupContent=new i.createElement("div",{class:"wux-controls-toolbar-popup-content"}),o.addEventOnElement(this,this.getContent(),"dimensionsChanged",(function(t){for(var i=t.target;i&&i!==e.getContent()&&!i.hasClassName("wux-toolbar-items");)i=i.getParent();if(i&&i!==e.getContent()){var n=r.getIndexOfElement(e._elementsArray,"element",i);n>=0&&(e._elementsArray[n].size={})}}))},t.prototype.handleEvents=function(){var e=this;this._listeningResizeEvent||"scroll"===this.overflowManagement||(this._listeningResizeEvent=!0,o.addResizeObserver(this,this.elements.container,d.bind(this)),this.elements.container.offsetParent?this._enableCalculus("creation"):(this._mutationObserver=new MutationObserver((function(t,i){if(e.elements.container||e.container)for(var n=0,s=t;n<s.length;n++)for(var o=s[n],l=0,a=Array.from(o.addedNodes);l<a.length;l++){if(a[l].contains(e.getContent()))return i.disconnect(),e._enableCalculus("DomUtilsNodeInsertedIntoDocument"),void e._onResize()}})),this._mutationObserver.observe(document,{childList:!0,subtree:!0})))},t.prototype.destroy=function(){this.clear(),o.removeResizeObserver(this,this.elements.container,d.bind(this)),this._mutationObserver&&(this._mutationObserver.disconnect(),this._mutationObserver=null);for(var t=0;t<g.length;t++)-1!==this._resizeListeners.indexOf(g[t])&&o.removeResizeObserver(this,this._getContainerFromPosition(g[t]),p.bind(this));this._resizeListeners=null,e.prototype.destroy.call(this)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("overflowManagement")&&this._applyOverflowManagement(t.overflowManagement),this.isDirty("direction")&&this._applyDirection(t.direction),this.isDirty("verticalAlign")&&this._applyVerticalAlign(t.verticalAlign),this.isDirty("touchMode")&&this._applyTouchMode()},t.prototype._applyTouchMode=function(){if(e.prototype._applyTouchMode.call(this),this._elementsArray)for(var t=0;t<this._elementsArray.length;t++){var i=this._elementsArray[t].size;i&&(i.shouldRecomputeNextTimeInToolbar=!0);var n=this._elementsArray[t].element;n&&u.applyTouch(n,this._getCurrentTouchMode())}this.elements&&this.elements.dropDownButton&&(this.elements.dropDownButton.touchMode=this.touchMode)},t.prototype._applyDirection=function(e){"vertical"===this.direction?(this.elements.container.addClassName("wux-toolbar-vertical"),this.elements.container.removeClassName("wux-toolbar-horizontal"),this.elements.maskContainer.addClassName("wux-toolbar-vertical"),this.elements.maskContainer.removeClassName("wux-toolbar-horizontal")):(this.elements.container.addClassName("wux-toolbar-horizontal"),this.elements.container.removeClassName("wux-toolbar-vertical"),this.elements.maskContainer.addClassName("wux-toolbar-horizontal"),this.elements.maskContainer.removeClassName("wux-toolbar-vertical")),this.elements.dropdownButtonContainer&&A.call(this,!0),this._onResize()},t.prototype._applyVerticalAlign=function(e){this.elements.container.removeClassName("wux-toolbar-vertical-align-near"),this.elements.container.removeClassName("wux-toolbar-vertical-align-center"),this.elements.container.removeClassName("wux-toolbar-vertical-align-far"),this.verticalAlign===c.TOOLBAR_POSITIONS.NEAR?this.elements.container.addClassName("wux-toolbar-vertical-align-near"):this.verticalAlign===c.TOOLBAR_POSITIONS.CENTER?this.elements.container.addClassName("wux-toolbar-vertical-align-center"):this.verticalAlign===c.TOOLBAR_POSITIONS.FAR&&this.elements.container.addClassName("wux-toolbar-vertical-align-far")},t.prototype._applyAdaptSizeToParent=function(e){this.adaptSizeToParent?(this.getContent().addClassName("wux-toolbar-adaptToParent"),this.elements.maskContainer.addClassName("wux-toolbar-adaptToParent")):(this.getContent().removeClassName("wux-toolbar-adaptToParent"),this.elements.maskContainer.removeClassName("wux-toolbar-adaptToParent"))},t.prototype.getPreferredSize=function(){return S.call(this,!0)},t.prototype._applyOverflowManagement=function(e){this.handleEvents();var t=this;if("scroll"===this.overflowManagement)this.elements.maskContainer.addClassName("wux-toolbar-scroll"),this.elements.maskContainer.removeClassName("wux-toolbar-dropdown"),this._showEverything(),this.elements.dropdownButtonContainer&&(this.elements.dropdownButtonContainer.destroy(),delete this.elements.dropdownButtonContainer);else if("dropdown"===this.overflowManagement||"custom"===this.overflowManagement){if(this.elements.dropdownButtonContainer||(this.elements.dropdownButtonContainer=new i.createElement("div").inject(this.elements.farContainer),this.elements.dropdownButtonContainer.addClassName("wux-toolbar-dropdown-container"),this.elements.dropDownButtonSeparator=new i.createElement("div",{class:"wux-controls-toolbar-separator"}).inject(this.elements.dropdownButtonContainer),this.elements.dropDownButton=new l({displayStyle:"lite",visibleFlag:!0,icon:{iconName:"menu-dot",fontIconFamily:c.WUXManagedFontIcons.Font3DS},touchMode:this._getCurrentTouchMode()}).inject(this.elements.dropdownButtonContainer),this.elements.dropDownButton.getContent().classList.add("wux-toolbar-dropdown-button"),this.elements.dropdownButtonContainer.hide(),A.call(this),this.elements.maskContainer.addClassName("wux-toolbar-dropdown"),this.elements.maskContainer.removeClassName("wux-toolbar-scroll")),"dropdown"===this.overflowManagement)if(this.elements.dropdownPopup)this.elements.dropdownPopup.target=this.elements.dropDownButton.getContent();else{var n={target:this.elements.dropDownButton.getContent(),position:"bottom",offset:{x:0,y:4},alignment:c.TOOLBAR_POSITIONS.NEAR,constraint:"screen",trigger:"click",overlap:!1,className:"wux-controls-popup wux-toolbar-popup",getBody:function(){return t.getPopupContent()},usePaddingFlag:!1,beforeDisplayCallback:function(){t.popupClass&&this.getContent().addClassName(t.popupClass),t._popupBeforeDisplayCallback&&t._popupBeforeDisplayCallback.call(t)},postOverlapCallback:function(e){if(t._popupPostOverlapCallback)return t._popupPostOverlapCallback.call(t,e)}};this._preventDelayPopupCreation=a.delayPopupCreation(n,(function(e){t.elements.dropdownPopup=e,t._onPopupCreationFunction()}))}else"custom"===this.overflowManagement&&(this.elements.dropdownPopup&&(this.elements.dropdownPopup.destroy(),this.elements.dropdownPopup=void 0),this._preventDelayPopupCreation&&this._preventDelayPopupCreation.removeListeners.call(void 0),o.addEventOnElement(this,this.elements.dropDownButton,"buttonclick",(function(e){t.fire("dropDownButtonClick")})));this._onResize()}},t.prototype._onResize=function(){if("scroll"!==this.overflowManagement&&this.getContent().offsetParent&&this._isCalculusEnabled){var e="vertical"===this.direction?this.elements.container.getSize().height:this.elements.container.getSize().width,t=S.call(this);if(t>e)for(;t>e;){var i=b.call(this);if(!i)break;var n=w.call(this,i,"toolbar")+9*M.call(this,i),s=0;this._moveFromToolbarToPopup(i);var o=B.call(this);this.elements.dropdownButtonContainer.isHidden()&&(this.elements.dropdownButtonContainer.show(),s=F.call(this,o)),o||this.elements.dropDownButtonSeparator.hide(),t=t-n+s}else{for(var l=this._getNbElementsInPopup(),a=l.nbElementsInPopup-l.nbElementsAlwaysInPopup;a>0&&t<=e;){var r=_.call(this),h=(n=w.call(this,r,"popup")+9*O.call(this,r),0);(o=B.call(this))||(h=9);var u=t+n+h-(1===a&&0===l.nbElementsAlwaysInPopup?F.call(this,o):0);if(!(u<=e))break;this._moveFromPopupToToolbar(r),this.elements.dropDownButtonSeparator.isHidden()&&this.elements.dropDownButtonSeparator.show(),t=u,a--}0===a&&0===l.nbElementsAlwaysInPopup&&this.elements.dropdownButtonContainer.hide()}P.call(this),this.fire("dimensionsChanged"),this.fire("toolbarResized")}},t.prototype.showPopup=function(){this.elements.dropdownPopup?this.elements.dropdownPopup.show():this.elements.dropDownButton.getContent().click()},t.prototype._getContainerFromPosition=function(e){switch(e){case c.TOOLBAR_POSITIONS.NEAR:return this.elements.nearContainer;case c.TOOLBAR_POSITIONS.CENTER:return this.elements.centerContainer;case c.TOOLBAR_POSITIONS.FAR:return this.elements.farContainer}},t.prototype._insertItemInToolbarView=function(e){var t=this._elementsArray.indexOf(e),i=this._getSiblingItemInContainer(1,c.TOOLBAR_CONTAINERS.TOOLBAR,t),n=null;if(i?n=i.element:"scroll"!==this.overflowManagement&&(e.position===c.TOOLBAR_POSITIONS.FAR?n=this.elements.dropdownButtonContainer:-1!==this._resizeListeners.indexOf(e.position)&&(n=null)),n)k(n.previousSibling)&&(N(e,i)||n.previousSibling.isHidden())&&(n=n.previousSibling),e.element.inject(n,"before");else{var s=this._getContainerFromPosition(e.position);e.element.inject(s)}},t.prototype._insertItemInPopupView=function(e){var t=this._elementsArray.indexOf(e),i=this._getSiblingItemInContainer(1,c.TOOLBAR_CONTAINERS.POPUP,t),n=this.getPopupContent(),s=null;i&&(s=i.element),n.insertBefore(e.element,s)},t.prototype._getSiblingItemInContainer=function(e,t,i){var n=this._elementsArray[i].position,s=t===c.TOOLBAR_CONTAINERS.POPUP,o=i,l=function(){1===e?o++:o--};for(l();o>=0&&o<this._elementsArray.length;l()){if(!s&&this._elementsArray[o].position!==n)return null;if(this._elementsArray[o].container===t)return this._elementsArray[o]}return null},t.prototype._showEverythingDefault=function(){for(var e=0;e<this._elementsArray.length;e++){var t=this._elementsArray[e];t.container!==c.TOOLBAR_CONTAINERS.POPUP||t.alwaysInOverflow||this._moveFromPopupToToolbar(t)}},t.prototype._moveFromToolbarToPopupDefault=function(e){var t=e.element.previousSibling;M.call(this,e)>0&&k(t)&&(t.remove(),t.destroy()),e.element.remove(),e.container=c.TOOLBAR_CONTAINERS.POPUP,"dropdown"!==this.overflowManagement||this._customDropDownManagement||this._insertItemInPopupView(e)},t.prototype._moveFromPopupToToolbarDefault=function(e){e.element&&e.element.remove(),e.container=c.TOOLBAR_CONTAINERS.TOOLBAR,this._insertItemInToolbarView(e)},t.prototype._onPopupCreationFunctionDefault=function(){},t.prototype.getPopupContent=function(){return this.elements.popupContent},t.prototype._getNbElementsInPopup=function(){var e=0,t=0;return this._elementsArray.forEach((function(i){i.container===c.TOOLBAR_CONTAINERS.POPUP&&(e++,i.alwaysInOverflow&&t++)})),{nbElementsInPopup:e,nbElementsAlwaysInPopup:t}},t}(n);d=function(e){if(e&&e.length&&e[0]&&e[0].target){var t=this;(t.elements.container||t.container)&&t._onResize()}},p=function(e){if(e&&e.length&&e[0]&&e[0].target&&e[0].target.getParent()&&e[0].target.getParent().getParent()){var t=this;(t.elements.container||t.container)&&t._onResize()}};var y=function(e,t){var i,n=t.position,s=g.indexOf(n),o=void 0!==t.index?t.index:1/0;if(-1===this._firstElementIndexForPosition[n]){for(var l=s+1;l<g.length;l++)if(-1!==this._firstElementIndexForPosition[g[l]]){this._firstElementIndexForPosition[n]=this._firstElementIndexForPosition[g[l]];break}-1===this._firstElementIndexForPosition[n]&&(this._firstElementIndexForPosition[n]=this._elementsArray.length),i=0}else{var a=this._elementsArray.length;for(l=s+1;l<g.length;l++)if(-1!==this._firstElementIndexForPosition[g[l]]){a=this._firstElementIndexForPosition[g[l]];break}i=Math.min(a-this._firstElementIndexForPosition[n],o)}for(l=s+1;l<g.length;l++)-1!==this._firstElementIndexForPosition[g[l]]&&this._firstElementIndexForPosition[g[l]]++;var r=this._firstElementIndexForPosition[n]+i;this._elementsArray.splice(r,0,{type:e,element:t.element,position:n,priority:t.priority,container:t.alwaysInOverflow?c.TOOLBAR_CONTAINERS.POPUP:c.TOOLBAR_CONTAINERS.TOOLBAR,category:t.category,data:t.data,alwaysInOverflow:t.alwaysInOverflow,visibleFlag:void 0===t.visibleFlag||t.visibleFlag,id:t.id?t.id:"ID_".concat(f++)});var h=this._elementsArray[r];t.alwaysInOverflow?this._moveFromToolbarToPopup(h):this._insertItemInToolbarView(h),P.call(this)},_=function(){if(0!==this._elementsArray.length){for(var e=-1,t=[],i=0,n=0;n<this._elementsArray.length;n++)if(this._elementsArray[n].container===c.TOOLBAR_CONTAINERS.POPUP&&!0!==this._elementsArray[n].alwaysInOverflow)if(this._elementsArray[n].priority>e)e=this._elementsArray[n].priority,t=[this._elementsArray[n]],i=g.indexOf(this._elementsArray[n].position);else if(this._elementsArray[n].priority===e){var s=g.indexOf(this._elementsArray[n].position);s<i?(t=[this._elementsArray[n]],i=s):s===i&&t.push(this._elementsArray[n])}return t.length>0?t[0]:null}},b=function(){if(0!==this._elementsArray.length){for(var e=1/0,t=[],i=0,n=0;n<this._elementsArray.length;n++)if(this._elementsArray[n].container===c.TOOLBAR_CONTAINERS.TOOLBAR&&!1!==this._elementsArray[n].visibleFlag&&!0!==this._elementsArray[n].alwaysInOverflow)if(this._elementsArray[n].priority<e)e=this._elementsArray[n].priority,t=[this._elementsArray[n]],i=g.indexOf(this._elementsArray[n].position);else if(this._elementsArray[n].priority===e){var s=g.indexOf(this._elementsArray[n].position);s>i?(t=[this._elementsArray[n]],i=s):s===i&&t.push(this._elementsArray[n])}return t.length>0?t[t.length-1]:null}},C=function(e){var t=this._elementsArray[e];this._firstElementIndexForPosition[t.position]===this._elementsArray.length&&(this._firstElementIndexForPosition[t.position]=-1);for(var i=g.indexOf(t.position)+1;i<g.length;i++)-1!==this._firstElementIndexForPosition[g[i]]&&this._firstElementIndexForPosition[g[i]]--,this._firstElementIndexForPosition[g[i]]===this._firstElementIndexForPosition[t.position]&&(this._firstElementIndexForPosition[t.position]=-1);t.element.remove(),this._elementsArray.splice(e,1),this.fire("itemRemoved",{item:t}),P.call(this)},w=function(e,t){if(this._enableSizeCalculus(e)){if(e.size||(e.size={}),!e.size[this.direction]||e.size.shouldRecomputeNextTimeInToolbar&&"toolbar"===t){var i=E.call(this,this.direction,e.element);i>0&&(e.size[this.direction]=i),delete e.size.shouldRecomputeNextTimeInToolbar}return e.size[this.direction]}return 0},x=function(e,t){for(var i=0,n=window.getComputedStyle(t),s=0;s<e.length;s++){var o=n.getPropertyValue("margin-"+e[s]);""!==o&&(i+=parseFloat(o))}return i},E=function(e,t){var i,n,s;return t.isHidden()&&(t.show(),n=!0),i=t.getSize(),s="vertical"===e?i.height+x(["top","bottom"],t):i.width+x(["right","left"],t),n&&t.hide(),s},S=function(e){for(var t=0,i=0;i<this._elementsArray.length;i++)if(e||this._elementsArray[i].container===c.TOOLBAR_CONTAINERS.TOOLBAR){var n=w.call(this,this._elementsArray[i],"toolbar");void 0!==n&&(t+=n)}var s=0,o=0;if(this.elements.container){var l=window.getComputedStyle(this.elements.container),a="vertical"===this.direction?l.getPropertyValue("padding-top"):l.getPropertyValue("padding-left"),r="vertical"===this.direction?l.getPropertyValue("padding-bottom"):l.getPropertyValue("padding-right");s=""===a?0:parseInt(a,10),o=""===r?0:parseInt(r,10)}if(t=t+s+o,e)t+=9*D.call(this);else{var h=this.getContent().getElementsByClassName(m);t+=9*Array.prototype.slice.call(h).filter((function(e){return!e.isHidden()})).length}return!this.elements.dropdownButtonContainer||this.elements.dropdownButtonContainer.isHidden()||e||(t+=A.call(this),B.call(this)&&(t+=9)),t};function D(){for(var e,t=0,i=0;i<this._elementsArray.length;i++){var n=this._elementsArray[i];n.visibleFlag&&(e&&e.position===n.position&&e.category!==n.category&&t++,e=n)}return t}var A=function(e){return this._dropDownMenuButtonSize=this._dropDownMenuButtonSize&&!e?this._dropDownMenuButtonSize:E.call(this,this.direction,this.elements.dropDownButton.getContent()),this._dropDownMenuButtonSize},F=function(e){return 0===this._dropDownMenuButtonSize&&A.call(this),this._dropDownMenuButtonSize+(e?9:0)};function P(){for(var e,t,i=[],n=0;n<this._elementsArray.length;n++){var s=this._elementsArray[n];if(s.visibleFlag&&(s.container===c.TOOLBAR_CONTAINERS.TOOLBAR||!this._customDropDownManagement)){if(N(s.container===c.TOOLBAR_CONTAINERS.TOOLBAR?e:t,s)){var o=s.element.previousSibling;if(k(o))i.push(o);else{var l=L.call(this);l.inject(s.element,"before"),i.push(l)}}s.container===c.TOOLBAR_CONTAINERS.TOOLBAR?e=s:t=s}}I(Array.prototype.slice.call(this.getContent().getElementsByClassName(m)),i);var a=this.elements.dropdownButtonContainer?this.elements.dropdownButtonContainer.previousSibling:void 0;(a&&k(a)&&(a.remove(),a.destroy()),"dropdown"!==this.overflowManagement||this._customDropDownManagement)||I(Array.prototype.slice.call(this.elements.popupContent.getElementsByClassName(m)),i)}function I(e,t){for(var i=0;i<e.length;i++){var n=e[i];k(n.nextSibling)?(n.remove(),n.destroy()):t.indexOf(n)>-1?n.isHidden()&&n.show():n.isHidden()||n.hide()}}function V(e,t){for(var i=this._elementsArray.indexOf(e)-1;i>=0;i--)if(this._elementsArray[i].visibleFlag&&this._elementsArray[i].container===t)return this._elementsArray[i]}function T(e,t){for(var i=this._elementsArray.indexOf(e)+1;i<this._elementsArray.length;i++)if(this._elementsArray[i].visibleFlag&&this._elementsArray[i].container===t)return this._elementsArray[i]}function B(){for(var e=0;e<this._elementsArray.length;e++)if(this._elementsArray[e].visibleFlag&&this._elementsArray[e].container===c.TOOLBAR_CONTAINERS.TOOLBAR)return!0;return!1}function O(e){var t=0;N(V.call(this,e,"toolbar"),e)&&t++;var i=T.call(this,e,"toolbar");return N(i,e)&&(k(i.element.previousSibling)&&!i.element.previousSibling.isHidden()||t++),t}function M(e){var t=0,i=V.call(this,e,"toolbar");N(i,e)&&t++;var n=T.call(this,e,"toolbar");return n&&!N(i,n)&&k(n.element.previousSibling)&&!n.element.previousSibling.isHidden()&&t++,t}function N(e,t){return e&&t&&(e.position===t.position||e.container===c.TOOLBAR_CONTAINERS.POPUP&&t.container===c.TOOLBAR_CONTAINERS.POPUP)&&e.category!==t.category}var L=function(){return new i.createElement("div",{class:m})};function k(e){return e&&e.hasClassName(m)}return h.addClass(v,"toolbar"),v}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Toggle",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter","DS/Utilities/Utils","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils","DS/CoreBase/WebUXGlobalEnums"],(function(e,t,i,n,s,o,l,a,r,h,u){"use strict";var c=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var s=e.apply(this,t)||this;return h.extendingClassFlag||s.addKeyMapsAndCommands({return:{keydown:"validate",keyup:"validate"},space:{keydown:"validate",keyup:"validate"}},{validate:function(e){if(this.disabled)return{stopPropagation:!1};var t={};if(1===this.clickMode&&"keydown"===e.type||0===this.clickMode&&"keyup"===e.type){t.actionPerformed=this.toggle();var n={ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,key:e.key};this.fire("buttonclick",n),this.fire("valueChangedByKeyPressed",n)}return"return"===i.Event.whichKey(e)?{stopPropagation:!1,infos:t}:{stopPropagation:!0,infos:t,preventDefault:!0}}}),s}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{type:{defaultValue:"checkbox",type:"string",category:"Behavior"},checkFlag:{defaultValue:!1,type:"boolean",category:"Behavior",recordFlag:!0},mixedState:{defaultValue:!1,type:"boolean",category:"Behavior"},label:{defaultValue:"",type:"string",category:"Appearance"},value:{defaultValue:void 0,type:"object",noNeedToApplyFlag:!0,category:"Behavior",recordFlag:!0},internalLabelsFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},clickMode:{defaultValue:0,type:"integer",category:"Behavior"},multiSelFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},allowUnsafeHTMLLabel:{defaultValue:void 0,type:"boolean",category:"Behavior"},iconsReference:{defaultValue:[{value:"checked",icon:"check"},{value:"unchecked",icon:"wrong"},{value:"checked_mixed",icon:""},{value:"unchecked_mixed",icon:""}],type:"array",category:"Behavior"},icon:{defaultValue:void 0,type:"string|WUX.IconDefinition"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"},_cropPolicy:{defaultValue:u.CropPolicy.CropWithDots,type:"integer",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.classList.add("wux-controls-toggle"),this.elements.container.setAttribute("tabindex",0),window.matchMedia("(pointer: fine)").matches&&this.elements.container.addClassName("wux-pointer-fine"),this.elements.checkSign=i.createElement("div",{class:"wux-toggle-icon-placeholder",tabindex:-1}),this.elements.checkSign.inject(this.elements.container),this.isMultiSelection=!1,this.preventTriggeringChangeEvent=!0},t.prototype._postBuildView=function(){this.preventTriggeringChangeEvent=!1},t.prototype.handleEvents=function(){var e=this;o.addEventOnElement(this,e.elements.container,"click",(function(t){if(0===e.clickMode){if(e.disabled)return;e.callMethodFromUIInteraction("toggle");var i={ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,altKey:t.altKey};e.fire("buttonclick",i)}})),o.addEventOnElement(this,e.elements.container,s.POINTERDOWN,(function(t){if(1===e.clickMode){if(e.disabled)return;e.callMethodFromUIInteraction("toggle");var i={ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,altKey:t.altKey};e.fire("buttonclick",i)}})),o.addEventOnElement(this,e.elements.container,s.POINTERHIT,(function(t){2===t.multipleHitCount&&(e.disabled||e.fire("buttonDblClick"))})),o.addEventOnElement(this,this.elements.checkSign,"focus",(function(t){e.elements.container.focus()}))},t.prototype._applyType=function(){for(this.elements.checkSign.classList.remove(this._toggleIconClass),this.elements.container.classList.remove("wux-controls-checkbox"),this.elements.container.classList.remove("wux-controls-radio"),this.elements.container.classList.remove("wux-controls-switch"),this.elements.container.classList.remove("wux-controls-toggle-icon"),this.elements.checkSign.classList.remove("wux-icon"),this.elements.checkSign.classList.remove("wux-ui-fa");this.elements.checkSign.children.length>0;)this.elements.checkSign.children[0].destroy();"checkbox"===this.type?(this._toggleIconClass="wux-ui-fa-check",this.elements.container.classList.add("wux-controls-checkbox"),this.elements.checkSign.addClassName("wux-ui-fa wux-icon")):"radio"===this.type?(this._toggleIconClass="wux-controls-radio-on",this.elements.container.classList.add("wux-controls-radio"),this.elements.checkSign.classList.add("wux-icon"),this.elements.checkSign.classList.add("wux-ui-fa")):"switch"===this.type?(this.elements.checkSign.classList.add("wux-ui-fa"),this.elements.innerSwitch=i.createElement("div",{class:"wux-controls-toggle-switch-inner"}),this.elements.labelSwitch1=i.createElement("div",{class:"wux-controls-toggle-switch-label wux-controls-toggle-switch-label-left"}),this.elements.buttonSwitch=i.createElement("div",{class:"wux-controls-toggle-switch-button"}),this.elements.labelSwitch2=i.createElement("div",{class:"wux-controls-toggle-switch-label wux-controls-toggle-switch-label-right"}),this.elements.innerSwitch.inject(this.elements.checkSign),this.elements.labelSwitch1.inject(this.elements.innerSwitch),this.elements.buttonSwitch.inject(this.elements.innerSwitch),this.elements.labelSwitch2.inject(this.elements.innerSwitch),this._toggleIconClass="wux-controls-switch-on",this.elements.container.classList.add("wux-controls-switch"),this.elements.innerSwitch.classList.add("wux-controls-toggle-switch-inner")):"toggleIcon"===this.type&&this.elements.container.classList.add("wux-controls-toggle-icon"),this._setState(),this._applyInternalLabelsFlag()},t.prototype._applyLabel=function(){""===this.label||void 0===this.label?(this.elements.label&&this.elements.label.remove(),this.elements.container.removeAttribute("showlabel")):(this.elements.container.setAttributeNode(document.createAttribute("showlabel")),this.elements.label||(this.elements.label=document.createElement("label"),this.elements.label.classList.add("wux-label"),this.elements.label.tabIndex=-1),this.elements.container.appendChild(this.elements.label),a.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLLabel)?this.elements.label.innerHTML=this.label:this.elements.label.textContent=this.label)},t.prototype._applyIcon=function(){if(this.elements.icon&&(this.elements.icon.remove(),this.elements.icon.destroy(),this.elements.icon=void 0),this.icon){if(this.elements.container.setAttributeNode(document.createAttribute("showicon")),this.elements.icon=o.generateIcon(this.icon),!this.elements.icon)return;this.elements.icon.classList.add("wux-toggle-icon"),this.elements.icon.tabIndex=-1,this.elements.icon.style.pointerEvents="none",""===this.label||void 0===this.label?this.elements.container.appendChild(this.elements.icon):this.elements.container.insertBefore(this.elements.icon,this.elements.label)}else this.elements.container.removeAttribute("showicon")},t.prototype._applyAllowUnsafeHTMLLabel=function(){this._applyLabel()},t.prototype._applyCheckFlag=function(){this._setState()},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),!0===this.disabled?(this.elements.container.setAttribute("tabindex",-1),this.elements.checkSign.disabled=this.disabled):this.elements.container.setAttribute("tabindex",0)},t.prototype._applyMixedState=function(){this._setState()},t.prototype._applyInternalLabelsFlag=function(){!0===this.internalLabelsFlag&&"switch"===this.type?this.elements.labelSwitch1&&this.elements.labelSwitch2&&(this.elements.labelSwitch1.setHTML("l"),this.elements.labelSwitch2.setHTML("O")):this.elements.labelSwitch1&&this.elements.labelSwitch2&&(this.elements.labelSwitch1.setHTML(""),this.elements.labelSwitch2.setHTML(""))},t.prototype._applyIconsReference=function(){for(var e=this.iconsReference,t=0;t<e.length;t++)"checked"===e[t].value?this._iconChecked=null===e[t].icon?"check":e[t].icon:"unchecked"===e[t].value?this._iconUnchecked=null===e[t].icon?"wrong":e[t].icon:"checked_mixed"===e[t].value?this._iconCheckedMixed=null===e[t].icon?"":e[t].icon:"unchecked_mixed"===e[t].value&&(this._iconUncheckedMixed=null===e[t].icon?"":e[t].icon);this._setState()},t.prototype._apply_cropPolicy=function(e,t){if(null!=t){var i=this.elements.container;i&&(i.setAttribute("cropPolicy",""),t===u.CropPolicy.NoCrop?i.setAttribute("cropPolicy","NoCrop"):t===u.CropPolicy.CropCut?i.setAttribute("cropPolicy","CropCut"):t===u.CropPolicy.CropBeginWithDots&&i.setAttribute("cropPolicy","CropBeginWithDots"))}else this._cropPolicy=Object.getPrototypeOf(this)._privateProperties._cropPolicy.defaultValue},t.prototype._setState=function(){if("toggleIcon"===this.type){if(this.elements.checkSign.innerHTML="",this.mixedState)return void((e=o.generateIcon(this.checkFlag?this._iconCheckedMixed:this._iconUncheckedMixed))&&(this.elements.checkSign.appendChild(e),e.classList.add("wux-ui-genereatedicon-fi"),e.classList.add("wux-ui-3ds")));!0===this.checkFlag?this.elements.container.setAttributeNode(document.createAttribute("checked")):this.elements.container.removeAttribute("checked");var e,t=this.checkFlag?this._iconChecked:this._iconUnchecked;if(t)(e=o.generateIcon(t))&&(this.elements.checkSign.appendChild(e),o.isFontIcon(t)?this.elements.container.removeClassName("wux-contains-richIcon"):this.elements.container.addClassName("wux-contains-richIcon"))}else!0===this.checkFlag?(this.elements.container.setAttributeNode(document.createAttribute("checked")),this.mixedState||this.elements.checkSign.classList.add(this._toggleIconClass),this.multiSelFlag&&this.isMultiSelection||this._uncheckSiblings()):(this.elements.checkSign.classList.remove(this._toggleIconClass),this.elements.container.removeAttribute("checked"));this.mixedState?(this.elements.checkSign.classList.remove(this._toggleIconClass),this.elements.checkSign.classList.add("wux-toggle-mixed-icon")):(this.elements.checkSign.classList.remove("wux-toggle-mixed-icon"),this.checkFlag&&this.elements.checkSign.classList.add(this._toggleIconClass)),this.preventTriggeringChangeEvent||this.fire("change")},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("type")&&this._applyType(),this.isDirty("_cropPolicy")&&this._apply_cropPolicy(t._cropPolicy,this._cropPolicy),(this.isDirty("label")||this.isDirty("allowUnsafeHTMLLabel"))&&this._applyLabel(),this.isDirty("icon")&&this._applyIcon(),this.isDirty("checkFlag")&&this._applyCheckFlag(),this.isDirty("mixedState")&&this._applyMixedState(),this.isDirty("internalLabelsFlag")&&this._applyInternalLabelsFlag(),this.isDirty("iconsReference")&&"toggleIcon"===this.type&&this._applyIconsReference()},t.prototype._giveFocus=function(){this._isFocused()||(e.prototype._giveFocus.call(this),this.elements.container.focus())},t.prototype.toggle=function(){return"checkbox"===this.type||"switch"===this.type||"toggleIcon"===this.type?(!0===this.mixedState?this.mixedState=!1:this.checkFlag=!this.checkFlag,!0):"radio"===this.type?!0===this.mixedState?(this.mixedState=!1,this.checkFlag=!0,!0):!1===this.checkFlag&&(this.checkFlag=!0,!0):void 0},t.prototype._uncheckSiblings=function(){var e=this;if("radio"===this.type){var i=this.elements.container.parentNode;if(i){var n=function(){for(var n=i.childNodes,s=0;s<n.length;s++)n[s]!==e.elements.container&&n[s].dsModel&&n[s].dsModel instanceof t&&"radio"===n[s].dsModel.type&&(n[s].dsModel.checkFlag=!1,n[s].dsModel.mixedState=!1)};i.dsModel&&"buttonGroup"===i.dsModel.__proto__.name?i.dsModel.__privateLockChange((function(){n()})):n()}}},t}(n);return r.addClass(c,"toggle"),c.prototype.markForRecordFlag=!0,l.register(c,"DS/ControlsRec/AbstractRec"),c}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/AbstractEditor",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils","DS/Core/PointerEvents","DS/Utilities/Dom"],(function(e,t,i,n,s,o,l,a){"use strict";function r(e){e.elements._validityIcon||(e.elements._validityIcon=a.generateValidityIcon({state:"invalid",getValidityReason:function(){return e.validFlag?"fixed":e.requiredFlag&&!e.valueToCommit?"required":"format"}}),e.elements.container.appendChild(e.elements._validityIcon))}var h=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return o.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{requiredFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},placeholder:{defaultValue:"",type:"string",category:"Appearance"},value:{defaultValue:"",type:"string",category:"Behavior"},valueToCommit:{defaultValue:"",type:"string",category:"Behavior"},validFlag:{defaultValue:!0,type:"boolean",readOnly:!0,category:"Appearance"},selectAllOnFocus:{defaultValue:!1,type:"boolean",category:"Behavior"},escapeHTML:{defaultValue:!1,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype._postBuildView=function(){},t.prototype.handleEvents=function(){e.prototype.handleEvents.call(this);var t=this;this._myInput&&(a.addEventOnElement(this,this._myInput,l.POINTERDOWN,(function(e){t._selectAllOnFocusHasBeenDone=!1})),a.addEventOnElement(this,this._myInput,l.POINTERUP,(function(e){t._selectAllOnFocusHasBeenDone&&(e.preventDefault(),t._selectAllOnFocusHasBeenDone=!1)})))},t.prototype.commitCurrentEntry=function(){if(this.value!==this.valueToCommit)return this.value=this.valueToCommit,this._updateValidFlag(),!0},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),this.disabled?this._myInput.setAttributeNode(document.createAttribute("disabled")):this._myInput.removeAttribute("disabled")},t.prototype._applyRequiredFlag=function(){this._realApplyRequiredFlag(),this._updateValidFlag()},t.prototype._applyPlaceholder=function(){this.placeholder?this._myInput.setAttribute("placeholder",this.placeholder):this._myInput.removeAttribute("placeholder")},t.prototype._applyValue=function(e,t){null==t?this._myInput.value="":(this._myInput.value=t,this._applyEscapeHTML(),this._myInput.value=this.escapeHTML?i.String.unescapeHTML(this.value):this.value),this.valueToCommit=this.value,this.fire("change"),this._updateValidFlag(),this._selectAllOnFocusHasBeenDone=!1},t.prototype._applyValueToCommit=function(e){this._selectAllOnFocusHasBeenDone=!1;var t=this.valueToCommit;if(void 0!==t){if(this._myInput.value!==t){var n=t&&" "===t.toString().charAt(t.length-1)?" ":"",s=this.escapeHTML?i.String.unescapeHTML(t)+n:t;this._myInput.value=s}}else this._myInput.value="";this._updateValidFlag(),this.fire("uncommittedChange",{uncommittedValue:this.valueToCommit})},t.prototype._applyEscapeHTML=function(e){this._myInput.value&&(this.escapeHTML?this._properties.value.value=i.String.escapeHTML(this._myInput.value):!0===e&&(this._properties.value.value=i.String.unescapeHTML(this._myInput.value)))},t.prototype._realApplyRequiredFlag=function(){this._updateInvalidSign()},t.prototype._updateInvalidSign=function(){if(this._myInput){var e=!0;(this.pattern||this.requiredFlag)&&(this.validFlag?this.elements._wasInvalidDuringModification?(e=!1,r(this),this.elements.container.setAttribute("with-validsign",""),this.elements._validityIcon.setValidityIconState("valid")):this.elements.container.removeAttribute("with-validsign"):(e=!1,r(this),this.elements._validityIcon.setValidityIconState("invalid"))),e&&this.elements._validityIcon&&(this.elements._validityIcon.remove(),delete this.elements._validityIcon),this._myInput.value?this._myInput.removeAttribute("is-empty"):this._myInput.setAttribute("is-empty","")}},t.prototype._updateValidFlag=function(){if(this._myInput&&this._myInput.validity){var e=this._myInput.validity.valid;if(!this._myInput.value&&this.requiredFlag&&(e=!1),e===this._properties.validFlag.value)return;this._properties.validFlag.value=e,e?this.elements.container.removeAttribute("with-validsign"):this.elements.container.setAttribute("with-validsign",""),this._updateInvalidSign(),this.fire("validFlagChange")}},t.prototype.getInputElement=function(){return this._myInput},t.prototype._getElementToFocus=function(){return this._myInput},t.prototype._onFocusReceived=function(t){this._isFocused()||(e.prototype._onFocusReceived.call(this),this.getOwnerDocument().activeElement!==this._myInput&&this._myInput.focus({preventScroll:!0}),!this.disabled&&this.selectAllOnFocus&&!1!==t&&(this._myInput.setSelectionRange(0,0),this._myInput.select(),this._selectAllOnFocusHasBeenDone=!0),this.fire("focus"))},t.prototype._giveFocus=function(t){this._isFocused()||(e.prototype._giveFocus.call(this),this.getOwnerDocument().activeElement!==this._myInput&&this._myInput.focus({preventScroll:!0}),!this.disabled&&this.selectAllOnFocus&&!1!==t&&(this._myInput.setSelectionRange(0,0),this._myInput.select()),this.fire("focus"))},t.prototype.destroy=function(){e.prototype.destroy.call(this),this._myInput=null},t}(n);return h.prototype.blackBoxFlag=!0,s.addClass(h,"abstract editor"),h}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Editor",["require","exports","UWA/Core","DS/Controls/AbstractEditor","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils"],(function(e,t,i,n,s,o,l){"use strict";function a(){this.fire("dimensionsChanged")}var r=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return l.extendingClassFlag||n.addKeyMapsAndCommands({up:{keydown:"consume",keyup:"consume"},right:{keydown:"consume",keyup:"consume"},down:{keydown:"consume",keyup:"consume"},left:{keydown:"consume",keyup:"consume"},pagedown:{keydown:"preventDefaultAndConsume",keyup:"preventDefaultAndConsume"},pageup:{keydown:"preventDefaultAndConsume",keyup:"preventDefaultAndConsume"},space:{keydown:"consume",keyup:"consume"},del:{keydown:"consume",keyup:"consume"},backspace:{keydown:"consume",keyup:"consume"},"ctrl+c":{keydown:"consume",keyup:"consume"},"ctrl+v":{keydown:"consume",keyup:"consume"},"ctrl+x":{keydown:"consume",keyup:"consume"},"ctrl+a":{keydown:"consume",keyup:"consume"},"ctrl+z":{keydown:"consume",keyup:"consume"},"shift+up":{keydown:"consume",keyup:"consume"},"shift+right":{keydown:"consume",keyup:"consume"},"shift+down":{keydown:"consume",keyup:"consume"},"shift+left":{keydown:"consume",keyup:"consume"},"ctrl+up":{keydown:"consume",keyup:"consume"},"ctrl+right":{keydown:"consume",keyup:"consume"},"ctrl+down":{keydown:"consume",keyup:"consume"},"ctrl+left":{keydown:"consume",keyup:"consume"},"ctrl+del":{keydown:"consume",keyup:"consume"},"ctrl+backspace":{keydown:"consume",keyup:"consume"},"ctrl+shift+right":{keydown:"consume",keyup:"consume"},"ctrl+shift+left":{keydown:"consume",keyup:"consume"},"shift+ctrl+right":{keydown:"consume",keyup:"consume"},"shift+ctrl+left":{keydown:"consume",keyup:"consume"},home:{keydown:"consume",keyup:"consume"},"shift+home":{keydown:"consume",keyup:"consume"},end:{keydown:"consume",keyup:"consume"},"shift+end":{keydown:"consume",keyup:"consume"}},{consume:function(){return{stopPropagation:!0}},validateValue:function(){return{preventDefault:!0,stopPropagation:!1,infos:{actionPerformed:this.commitCurrentEntry()}}},preventDefault:function(){return{preventDefault:!0,stopPropagation:!1}},preventDefaultAndConsume:function(){return{preventDefault:!0,stopPropagation:!0}}}),n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:"",type:"string",category:"Behavior",advancedSetter:!0},widthInCharNumber:{defaultValue:20,type:"integer",category:"Appearance"},maxLength:{defaultValue:-1,type:"integer",category:"Appearance"},nbRows:{defaultValue:2,type:"integer",category:"Appearance"},newLineMode:{defaultValue:"shiftEnter",type:"string",category:"Behavior"},autoCommitFlag:{defaultValue:!1,type:"boolean",noNeedToApplyFlag:!0,category:"Behavior"},resizableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-editor"),this.elements.inputField=new i.Element("textarea",{type:"text",title:""}),this._myInput=this.elements.inputField,this.elements.inputField.addClassName("wux-ui-state-"+this.options.type),this.elements.inputField.inject(this.elements.container)},t.prototype.handleEvents=function(){var t=this;e.prototype.handleEvents.call(this),s.addEventOnElement(this,this.elements.inputField,"change",(function(e){e.stopPropagation()})),s.addEventOnElement(this,this.elements.inputField,"input",(function(e){e.stopPropagation(),t.validFlag||(t.elements._wasInvalidDuringModification=!0),t.autoCommitFlag?t.setPropertyFromUIInteraction("value",t.elements.inputField.value):t.setPropertyFromUIInteraction("valueToCommit",t.elements.inputField.value)})),s.addEventOnElement(this,this.elements.inputField,"blur",(function(e){e.preventDefault(),t.callMethodFromUIInteraction("commitCurrentEntry"),t.elements._wasInvalidDuringModification=!1,t._updateInvalidSign(),t.fire("blur")}))},t.prototype._applyNewLineMode=function(){"enter"===this.newLineMode?this.addKeyMapsAndCommands({return:{keydown:"consume",keyup:"preventDefaultAndConsume"},"shift+return":{keydown:"consume",keyup:"preventDefaultAndConsume"}},{}):"shiftEnter"===this.newLineMode?this.addKeyMapsAndCommands({"shift+return":{keydown:"consume",keyup:"preventDefaultAndConsume"},return:{keydown:"validateValue",keyup:"preventDefault"}},{}):this.removeKeyMaps(["return","shift+return"])},t.prototype._applyMaxLength=function(e){this.maxLength>0?this.elements.inputField.setAttribute("maxlength",this.maxLength):this.elements.inputField.removeAttribute("maxlength"),o._applyForAdvancedSetterProperty(this,"value",this.value,this.value)},t.prototype._applyWidthInCharNumber=function(){this.widthInCharNumber>0?(this.elements.inputField.setAttribute("cols",this.widthInCharNumber),this.elements.container.removeClassName("wux-controls-editor-width")):(this.elements.inputField.removeAttribute("cols"),this.elements.container.addClassName("wux-controls-editor-width"))},t.prototype._applyNbRows=function(e){this.nbRows>0?this.elements.inputField.setAttribute("rows",this.nbRows):this.elements.inputField.removeAttribute("rows"),e!==this.nbRows&&this.fire("dimensionsChanged")},t.prototype._applyResizableFlag=function(e,t){e!==t&&(s.removeResizeObserver(this,this.elements.inputField,a),t?(this.elements.inputField.style.resize=!0===t?"both":t,s.addResizeObserver(this,this.elements.inputField,a)):this.elements.inputField.style.resize=null)},t.prototype._preEditValue=function(e,t){var i=parseInt(this.maxLength);return!(i>0)||{validValue:t=t.slice(0,i)}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this._applyPlaceholder(),this._applyWidthInCharNumber(),this._applyNbRows(t.nbRows),this._applyMaxLength(),this._applyNewLineMode(),this._applyResizableFlag(t.resizableFlag,this.resizableFlag),this._realApplyRequiredFlag(),this.isDirty("value")&&o._applyForAdvancedSetterProperty(this,"value",t.value,this.value),this._updateValidFlag()},t.prototype.setHeight=function(e){this.elements.inputField&&(void 0===e?this.elements.inputField.style.height="":"number"==typeof e&&(this.elements.inputField.style.height=e+"px"))},t.prototype.destroy=function(){s.removeResizeObserver(this,this.elements.inputField,a),e.prototype.destroy.call(this)},t}(n);return o.addClass(r,"editor"),r}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/LineEditor",["require","exports","UWA/Core","DS/Core/BaseComponent","DS/Controls/AbstractEditor","DS/Controls/CustomizableDecoratorItems","./DecoratorManager","DS/Controls/Popup","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/Utilities/Utils","DS/Utilities/WUXUWAUtils","i18n!DS/Controls/assets/nls/translation","./typings/types"],(function(e,t,i,n,s,o,l,a,r,h,u,c,d,p){"use strict";function m(){var e=this;""!==e.valueToCommit&&(e._getInputField().value=""),""!==e.value&&void 0!==e.value?(e.value="",e.fire("clear")):e._applyValue()}function g(){this.pattern?this._getInputField().setAttribute("pattern",this.pattern):this._getInputField().removeAttribute("pattern")}var f=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return d.extendingClassFlag||n.addKeyMapsAndCommands({left:{keydown:"consume",keyup:"consume"},right:{keydown:"consume",keyup:"consume"},pagedown:{keydown:"preventDefault",keyup:"preventDefault"},pageup:{keydown:"preventDefault",keyup:"preventDefault"},space:{keydown:"consume",keyup:"consume"},del:{keydown:"consume",keyup:"consume"},backspace:{keydown:"consume",keyup:"consume"},"+":{keydown:"consume",keyup:"consume"},"-":{keydown:"consume",keyup:"consume"},"*":{keydown:"consume",keyup:"consume"},"/":{keydown:"consume",keyup:"consume"},"ctrl+c":{keydown:"consume",keyup:"consume"},"ctrl+v":{keydown:"consume",keyup:"consume"},"ctrl+x":{keydown:"consume",keyup:"consume"},"ctrl+a":{keydown:"consume",keyup:"consume"},"ctrl+z":{keydown:"consume",keyup:"consume"},"shift+up":{keydown:"consume",keyup:"consume"},"shift+right":{keydown:"consume",keyup:"consume"},"shift+down":{keydown:"consume",keyup:"consume"},"shift+left":{keydown:"consume",keyup:"consume"},"ctrl+up":{keydown:"consume",keyup:"consume"},"ctrl+right":{keydown:"consume",keyup:"consume"},"ctrl+down":{keydown:"consume",keyup:"consume"},"ctrl+left":{keydown:"consume",keyup:"consume"},"ctrl+del":{keydown:"consume",keyup:"consume"},"ctrl+backspace":{keydown:"consume",keyup:"consume"},"ctrl+shift+right":{keydown:"consume",keyup:"consume"},"ctrl+shift+left":{keydown:"consume",keyup:"consume"},"shift+ctrl+right":{keydown:"consume",keyup:"consume"},"shift+ctrl+left":{keydown:"consume",keyup:"consume"},home:{keydown:"consume",keyup:"consume"},"shift+home":{keydown:"consume",keyup:"consume"},end:{keydown:"consume",keyup:"consume"},"shift+end":{keydown:"consume",keyup:"consume"},return:{keydown:"validateValue",keyup:"preventDefault"}},{consume:function(){},validateValue:function(){return{preventDefault:!0,stopPropagation:!1,infos:{actionPerformed:this.commitCurrentEntry()}}},preventDefault:function(){return{preventDefault:!0,stopPropagation:!1}},preventDefaultAndConsume:function(){return{preventDefault:!0,stopPropagation:!0}}}),n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{pattern:{defaultValue:"",type:"string",category:"Behavior"},sizeInCharNumber:{defaultValue:-1,type:"integer",category:"Appearance"},displayStyle:{defaultValue:"text",type:"string",category:"Appearance"},autoCommitFlag:{defaultValue:!1,type:"boolean",noNeedToApplyFlag:!0,category:"Behavior"},value:{defaultValue:"",type:"string",category:"Behavior",advancedSetter:!0},autoCorrectFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},displayClearFieldButtonFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},icon:{defaultValue:void 0,type:"string",category:"Appearance"},customDecoratorDefinition:{defaultValue:void 0,type:"object",category:"Behavior"},maxLength:{defaultValue:-1,type:"integer",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-lineeditor"),this.elements.inputField=new i.Element("input",{type:"text",tabindex:0,autocomplete:"off",title:""}),this._myInput=this.elements.inputField,this.elements.inputField.inject(this.elements.container),this.elements.inputField.addClassName("wux-ui-state-"+this.options.type),this.displayClearFieldButtonFlag&&this._layoutClearFieldButton()},t.prototype._getInputField=function(){return this.elements&&this.elements.inputField?this.elements.inputField:this._myInput},t.prototype.destroy=function(){l.getWidget()===this&&l.hideDecorator(),e.prototype.destroy.call(this)},t.prototype.handleEvents=function(){var t=this;e.prototype.handleEvents.call(this),h.addEventOnElement(this,this._getInputField(),"change",(function(e){e.stopPropagation()})),h.addEventOnElement(this,this._getInputField(),"input",(function(e){e.stopPropagation(),t.validFlag||(t.elements._wasInvalidDuringModification=!0),t.autoCommitFlag?t.setPropertyFromUIInteraction("value",t._getInputField().value):t.setPropertyFromUIInteraction("valueToCommit",t._getInputField().value)})),h.addEventOnElement(this,this._getInputField(),"blur",(function(e){for(var i=!0,s=e,o=(null==s?void 0:s.relatedTarget)?s.relatedTarget:null,l=0;o&&t._blurExceptionTargets&&l<t._blurExceptionTargets.length;l++){var r=t._blurExceptionTargets[l],u=r instanceof n?r.getContent():r;r&&(r instanceof a&&!r.isElementInside(o)||!h.isElementInside(o,u)||(i=!1))}i&&(t.callMethodFromUIInteraction("commitCurrentEntry"),t.elements._wasInvalidDuringModification=!1,t._updateInvalidSign(),t._getInputField()&&t.fire("blur"))})),h.addEventOnElement(this,this._getInputField(),r.POINTERDOWN,(function(e){t._createPointerUpOnDocumentFunction();var i=t.getOwnerDocument(),n=i.activeElement;!r.isTouchEvent(e)||(l.isDecoratorDisplayed()||l.getWidget()!==t&&n!==this)&&l.getWidget()===t&&n===this?l.isDecoratorDisplayed()&&(l.hideDecorator(!1,!0),h.removeEventOnElement(t,i,r.POINTERUP,t._pointerUpOnDocument)):t.customDecoratorDefinition&&t.customDecoratorDefinition.decoratorID&&(e.preventDefault(),l.showDecorator(t,this,t.customDecoratorDefinition.decoratorID),h.addEventOnElement(t,i,r.POINTERUP,t._pointerUpOnDocument))})),h.addEventOnElement(this,this._getInputField(),r.POINTERHIT,(function(e){e.stopPropagation()}))},t.prototype.preventBlurForTargetedElements=function(e){this._blurExceptionTargets||(this._blurExceptionTargets=[]),this._blurExceptionTargets=this._blurExceptionTargets.concat(e)},t.prototype.removeElementFromPreventedBlurTarget=function(e){if(this._blurExceptionTargets&&e){var t=this._blurExceptionTargets.indexOf(e);t>-1&&this._blurExceptionTargets.splice(t,1)}},t.prototype._layoutClearFieldButton=function(){var e=this;this.elements._clearFieldButton=new i.Element("div",{class:"wux-controls-lineeditor-clearbutton"}),this.elements._clearFieldButton.setAttribute("draggable","false"),this.elements._clearFieldButton.addClassName("wux-controls-lineeditor-clearbutton"),this.elements._clearFieldButton.tooltipInfos={shortHelp:p.get("clearField")},this.elements._clearFieldButton.inject(this.elements.container),this._getInputField().setAttribute("has-clearButton","true"),h.generateIcon("clear",{target:this.elements._clearFieldButton}),h.addEventOnElement(this,this.elements._clearFieldButton,r.POINTERDOWN,(function(e){e.preventDefault()})),h.addEventOnElement(this,this.elements._clearFieldButton,"touchstart",(function(t){t.preventDefault(),m.call(e)})),h.addEventOnElement(this,this.elements._clearFieldButton,"click",(function(t){t.stopPropagation(),m.call(e)}))},t.prototype._layoutIconFieldButton=function(){var e=this;this.elements._iconFieldButton=new i.Element("div",{class:"wux-controls-lineeditor-iconbutton"}),this.elements._iconFieldButton.addClassName("wux-controls-lineeditor-iconbutton"),this.elements._iconFieldButton.inject(this.elements.container),h.generateIcon(this.icon,{target:this.elements._iconFieldButton}),this._getInputField().setAttribute("has-iconButton",""),h.addEventOnElement(this,this.elements._iconFieldButton,"click",(function(t){t.stopPropagation(),e.fire("click")}))},t.prototype._applyValueToCommit=function(t){e.prototype._applyValueToCommit.call(this,t),this._applyDisplayClearFieldButtonFlag()},t.prototype._preEditValue=function(e,t){if(!this.autoCorrectFlag)return!0;var i;if(null!=t){t!==e&&this._getInputField().value!==t&&(this._getInputField().value=t);var n=parseInt(this.maxLength);n>0&&(i=t.slice(0,n))}else this._getInputField().value="";return!this._getInputField().validity.valid&&t.length>0?(this._getInputField().value!==e&&(this._getInputField().value=e,this.valueToCommit=e),!1):!i||{validValue:i}},t.prototype._applyValue=function(e,t){this._applyEscapeHTML(),this.valueToCommit=this.value,this.fire("change")},t.prototype._applyPattern=function(){g.call(this),this._updateValidFlag()},t.prototype._applySizeInCharNumber=function(){this.sizeInCharNumber>0?(this._getInputField().setAttribute("size",this.sizeInCharNumber.toString()),this.elements.container.removeClassName("wux-controls-lineeditor-width")):(this._getInputField().removeAttribute("size"),this.elements.container.addClassName("wux-controls-lineeditor-width"))},t.prototype._applyMaxLength=function(e){this.maxLength>0?this._getInputField().setAttribute("maxlength",this.maxLength.toString()):this._getInputField().removeAttribute("maxlength"),u._applyForAdvancedSetterProperty(this,"value",this.value,this.value)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this._applyPlaceholder(),this._applySizeInCharNumber(),this.isDirty("maxLength")&&this._applyMaxLength(t.maxLength),this._getInputField().type="password"===this.displayStyle?"password":"text","lite"===this.displayStyle?this._getInputField().addClassName("wux-controls-lineEditor-lite"):this._getInputField().removeClassName("wux-controls-lineEditor-lite"),void 0!==this.value&&null!==this.value?this._getInputField().value=this.escapeHTML?i.String.unescapeHTML(this.value):this.value:this._getInputField().value="",this._realApplyRequiredFlag(),g.call(this),this.valueToCommit=this.value,this._updateValidFlag(),this.isDirty("value")&&this.fire("change"),this._applyDisplayClearFieldButtonFlag(),this._applyIcon()},t.prototype._applyDisplayClearFieldButtonFlag=function(){this.displayClearFieldButtonFlag?(this.elements._clearFieldButton||this._layoutClearFieldButton(),""===this.valueToCommit||void 0===this.valueToCommit||this.disabled?this.elements._clearFieldButton.hide():(this.elements._clearFieldButton.show(),this._getInputField().setAttribute("has-clearButton","true"),this.icon&&this.elements._clearFieldButton.setAttribute("has-IconAndButton",""))):this.elements._clearFieldButton&&(this.elements._clearFieldButton.hide(),this._getInputField().removeAttribute("has-clearButton"))},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),this._applyDisplayClearFieldButtonFlag()},t.prototype._applyTouchMode=function(){e.prototype._applyTouchMode.call(this),c.isOnIPhone()?this.getContent().addClassName("wux-device-iphone"):this.getContent().removeClassName("wux-device-iphone")},t.prototype._applyIcon=function(){this.elements._iconFieldButton&&(this.elements._iconFieldButton.remove(),this.elements._iconFieldButton=null),this.icon?(this._getInputField().setAttribute("has-iconButton",""),this._layoutIconFieldButton()):(this._getInputField().removeAttribute("has-iconButton"),this.elements._clearFieldButton&&this.elements._clearFieldButton.removeAttribute("has-IconAndButton"))},t.prototype._createPointerUpOnDocumentFunction=function(){if(!this._pointerUpOnDocument){var e=this;this._pointerUpOnDocument=function(t){if(!h.isElementInside(t.target,e._getInputField())){var i=t.clientX,n=t.clientY;if(l.isDecoratorDisplayed()&&!c.isMouseOverElement(l.getWidget().getContent(),{x:i,y:n})&&!c.isMouseOverElement(l.getDecorator().elements.popup.getContent(),{x:i,y:n})){l.hideDecorator(!0,!0);var s=e.getOwnerDocument();h.removeEventOnElement(e,s,r.POINTERUP,e._pointerUpOnDocument)}}}}},t.prototype._onDecoratorClick=function(e,t){if(!t){var i=o.getItem(e),n=this._getInputField().selectionStart,s=this._getInputField();if(i&&i.label){var a=s.value.substring(0,s.selectionStart)+i.label+s.value.substring(s.selectionEnd);s.value=a,s.selectionStart=this._getInputField().selectionEnd=n+i.label.length}else if("delete"===e){a=void 0;a=s.selectionEnd>s.selectionStart?s.value.substring(0,s.selectionStart)+s.value.substring(s.selectionEnd+1):s.value.substring(0,s.value.length-1),s.value=a,s.selectionStart=this._getInputField().selectionEnd=n}else"validate"===e&&l.hideDecorator(!0,!0)}},t.prototype._onDecoratorShow=function(){var e=this.getOwnerDocument();e.activeElement&&e.activeElement.blur(),this._getInputField().setAttributeNode(e.createAttribute("readonly")),this._getInputField().focus(),this._getInputField().selectionStart=0,this._getInputField().selectionEnd=this._getInputField().value.length},t.prototype._onDecoratorHide=function(){if(this._getInputField()){this._getInputField().removeAttribute("readonly"),this.commitCurrentEntry();var e=l.getDecorator();e&&e.resetActiveView&&l.getDecorator().resetActiveView()}},t}(s);return u.addClass(f,"lineEditor"),f}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/FilePicker",["require","exports","DS/Utilities/Utils","DS/Utilities/Dom","DS/Controls/Abstract","DS/Controls/Button","DS/Controls/LineEditor","DS/Core/WebUXComponents","i18n!DS/Controls/assets/nls/translation","DS/CoreBase/WebUXGlobalEnums"],(function(e,t,i,n,s,o,l,a,r,h){"use strict";function u(){var e;null===(e=this.elements._placeholderDnD)||void 0===e||e.removeAttribute("hide")}function c(e){var t;e&&!this._dropoverDone||null===(t=this.elements._placeholderDnD)||void 0===t||t.setAttribute("hide","")}function d(e){var t=!0;e.dataTransfer.items.length&&-1!==e.dataTransfer.types.indexOf("Files")||(t=!1),t&&!0!==this.allowMultipleFiles&&e.dataTransfer.items.length>1&&(t=!1),t||(e.dataTransfer.dropEffect="none")}function p(e){var t,i;if(this._dropoverDone=!1,e.preventDefault(),e.stopPropagation(),(null===(t=this.dropOptions)||void 0===t?void 0:t.dropArea)?this.dropOptions.dropArea.appendChild(this.elements._placeholderDnD):this.elements.container.appendChild(this.elements._placeholderDnD),d.call(this,e),u.call(this),null===(i=this.dropOptions)||void 0===i?void 0:i.dropArea){var n=this.dropOptions.dropArea.getBoundingClientRect();n.height<42?this.elements._placeholderDnD.setAttribute("size","small"):n.height<280?this.elements._placeholderDnD.setAttribute("size","normal"):this.elements._placeholderDnD.setAttribute("size","big")}else this.elements._placeholderDnD.setAttribute("size","small")}function m(e){this._dropoverDone=!0,e.stopPropagation(),e.preventDefault(),d.call(this,e),u.call(this)}function g(e){e.stopPropagation(),e.preventDefault(),c.call(this,e),this._dropoverDone=!1}function f(e){var t=this;c.call(this),e.stopPropagation(),e.preventDefault();var i=new DataTransfer,n=[];Array.from(e.dataTransfer.items).forEach((function(e){if(e.webkitGetAsEntry||e.getAsEntry){var t=e.webkitGetAsEntry?e.webkitGetAsEntry():e.getAsEntry();(null==t?void 0:t.isFile)&&n.push((s=t,o=i.items,new Promise((function(e){s.file((function(t){o.add(t),e()}),e)}))))}var s,o})),Promise.all(n).then((function(){t.elements._fileChooserTrigger.files=i.files,t.elements._fileChooserTrigger.dispatchEvent(new Event("change"))}))}var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:void 0,type:"object",category:"Appearance",advancedSetter:!0},placeholder:{defaultValue:void 0,type:"string",category:"Appearance"},fileTypes:{defaultValue:void 0,type:"string",category:"Behavior"},allowMultipleFiles:{defaultValue:!1,type:"boolean",category:"Behavior"},allowResetToUndefinedByUIFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},dropOptions:{defaultValue:void 0,type:"object",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype._preBuild=function(t){e.prototype._preBuild.call(this,t),this._dragEnterListener=p.bind(this),this._dragOverListener=m.bind(this),this._dragLeaveListener=g.bind(this),this._dropListener=f.bind(this)},t.prototype.buildView=function(){this.elements.container.classList.add("wux-controls-filepicker"),this.elements._fileChooserTrigger=document.createElement("input"),this.elements._fileChooserTrigger.type="file",this.elements._fileChooserTrigger.title=" ",this.elements._fileChooserTrigger.classList.add("wux-controls-filepicker-fileChooser-trigger"),this.elements._lineEditor=new l({placeholder:r.dragAndDropFiles,value:void 0}),this.elements.container.appendChild(this.elements._lineEditor.getContent()),this.elements._lineEditor.elements.inputField.setAttribute("readonly","readonly"),this.elements._fileChooserHandle=new o({showLabelFlag:!1,icon:{iconName:"upload",iconSize:"1x",fontIconFamily:h.WUXManagedFontIcons.Font3DS}}),this.elements._fileChooserHandle.elements.container.classList.add("wux-tweakers-multirep-button"),this.elements._fileChooserHandle.elements.container.classList.add("wux-tweakers-multirep-button-line-editor"),this.elements._fileChooserHandle.elements.container.setAttribute("tabindex",-1),this.elements.container.appendChild(this.elements._fileChooserHandle.getContent()),this._updateInputTooltip(),this.elements._placeholderDnD=document.createElement("div"),this.elements._placeholderDnD.classList.add("wux-controls-filepicker-placeholder-dnd"),c.call(this),this.elements.container.appendChild(this.elements._placeholderDnD),this.elements._placeholderDnD.appendChild(n.generateIcon({iconName:"up",className:"wux-controls-filepicker-placeholder-dnd-icon"}));var e=document.createElement("span");e.classList.add("wux-controls-filepicker-placeholder-dnd-text"),e.classList.add("wux-font-arial-regular"),e.textContent=r.dropText,this.elements._placeholderDnD.appendChild(e)},t.prototype.handleEvents=function(){var t=this;e.prototype.handleEvents.call(this);var s=function(e){var n;if(e.stopPropagation(),t.elements._fileChooserTrigger.files.length&&(n=t.elements._fileChooserTrigger.files),n&&n.length&&(t.allowMultipleFiles||!(n.length>1))){var s=new DataTransfer;Array.from(n).forEach((function(e){return s.items.add(e)}));var o=t.allowMultipleFiles?s.files:s.files[0];0!==i.compare(t.value,o)&&(t.value=o)}};n.addEventOnElement(this,this.elements._fileChooserTrigger,"change",s),n.addEventOnElement(this,this.elements._placeholderDnD,"drop",s),n.addEventOnElement(this,this.elements._lineEditor,"clear",(function(e){e.stopPropagation(),t.value=void 0})),n.addEventOnElement(this,this.elements._lineEditor,"change",(function(e){return e.stopPropagation()})),n.addEventOnElement(this,this.elements._lineEditor.getContent(),"focus",(function(){t.elements._fileChooserHandle&&t.elements._fileChooserHandle.getContent().setAttribute("focused","")})),n.addEventOnElement(this,this.elements._lineEditor.getContent(),"blur",(function(){t.elements._fileChooserHandle&&t.elements._fileChooserHandle.getContent().removeAttribute("focused")})),n.addEventOnElement(this,this.elements._lineEditor.getContent(),"click",(function(e){e.stopPropagation(),e.preventDefault(),t.elements._fileChooserTrigger.click()})),n.addEventOnElement(this,this.elements._lineEditor.getContent(),"copy",(function(e){var i=t.elements._lineEditor.value||"";e&&e.clipboardData&&e.clipboardData.setData("Text",i),e.preventDefault()})),n.addEventOnElement(this,this.elements._fileChooserHandle.getContent(),"buttonclick",(function(e){e.stopPropagation(),e.preventDefault(),t.elements._fileChooserTrigger.click()}))},t.prototype._applyPlaceholder=function(e){this.elements._lineEditor&&(this.elements._lineEditor.placeholder="string"==typeof this.placeholder?this.placeholder:r.dragAndDropFiles),this._updateInputTooltip()},t.prototype._preEditValue=function(e,t){return void 0===t||!!t&&(t instanceof File&&!1===this.allowMultipleFiles||t instanceof FileList&&!0===this.allowMultipleFiles)},t.prototype._applyValue=function(e,t){0!==i.compare(e,t)&&(this.elements._lineEditor&&(this.elements._lineEditor.value=function(e){if(void 0!==e){var t="";if(e instanceof FileList)for(var i=0,n=e.length;i<n;++i)i>0&&(t+=" | "),t+=e[i].name;else t+=e.name;return t}}(t)),!t&&this.elements._fileChooserTrigger&&(this.elements._fileChooserTrigger.value=null),this._updateInputTooltip(),this.fire("change"))},t.prototype._applyFileTypes=function(e){this.elements._fileChooserTrigger&&(this.elements._fileChooserTrigger.accept=this.fileTypes)},t.prototype._applyAllowMultipleFiles=function(e,t){if(this.elements._fileChooserTrigger&&(this.elements._fileChooserTrigger.multiple=t),!t&&this.value instanceof FileList&&this.value.length)this.value=this.value[0];else if(t&&this.value instanceof File){var i=new DataTransfer;i.items.add(this.value),this.value=i.files}},t.prototype._applyAllowResetToUndefinedByUIFlag=function(e){this.elements._lineEditor&&(this.elements._lineEditor.displayClearFieldButtonFlag=this.allowResetToUndefinedByUIFlag)},t.prototype._applyDropOptions=function(e,t){var i=null==e?void 0:e.dropArea,s=null==t?void 0:t.dropArea;n.removeEventOnElement(this,i||this.getContent(),"dragenter",this._dragEnterListener),n.removeEventOnElement(this,i||this.getContent(),"dragover",this._dragOverListener),n.removeEventOnElement(this,i||this.getContent(),"dragleave",this._dragLeaveListener),n.removeEventOnElement(this,i||this.getContent(),"drop",this._dropListener),(null==e?void 0:e.className)&&this.elements._placeholderDnD.classList.remove(e.className),s?s.appendChild(this.elements._placeholderDnD):this.elements.container.appendChild(this.elements._placeholderDnD),(null==t?void 0:t.className)&&this.elements._placeholderDnD.classList.add(t.className),n.addEventOnElement(this,s||this.getContent(),"dragenter",this._dragEnterListener),n.addEventOnElement(this,s||this.getContent(),"dragover",this._dragOverListener),n.addEventOnElement(this,s||this.getContent(),"dragleave",this._dragLeaveListener),n.addEventOnElement(this,s||this.getContent(),"drop",this._dropListener)},t.prototype._applyDisabled=function(t){e.prototype._applyDisabled.call(this,t),this.elements._lineEditor&&(this.elements._lineEditor.disabled=this.disabled),this.elements._fileChooserHandle&&(this.elements._fileChooserHandle.disabled=this.disabled)},t.prototype._applyTouchMode=function(t){e.prototype._applyTouchMode.call(this,t),this.elements._lineEditor&&(this.elements._lineEditor.touchMode=this.touchMode),this.elements._fileChooserHandle&&(this.elements._fileChooserHandle.touchMode=this.touchMode),this.elements._placeholderDnD&&(this._getCurrentTouchMode()?this.elements._placeholderDnD.setAttribute("touch-mode",""):this.elements._placeholderDnD.removeAttribute("touch-mode"))},t.prototype._applyTooltipInfos=function(){this.tooltipInfos||(this._properties.tooltipInfos.value=this._defaultTooltipModel),e.prototype._applyTooltipInfos.call(this)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("placeholder")&&this._applyPlaceholder(t.placeholder),this.isDirty("allowMultipleFiles")&&this._applyAllowMultipleFiles(t.allowMultipleFiles,this.allowMultipleFiles),this.isDirty("fileTypes")&&this._applyFileTypes(t.fileTypes),this.isDirty("allowResetToUndefinedByUIFlag")&&this._applyAllowResetToUndefinedByUIFlag(t.allowResetToUndefinedByUIFlag),this.isDirty("dropOptions")&&this._applyDropOptions(t.dropOptions,this.dropOptions),this.isDirty("value")&&this._applyValue(t.value,this.value)},t.prototype.focus=function(t){e.prototype.focus.call(this,t),this.elements._lineEditor.focus(t)},t.prototype._updateInputTooltip=function(){var e="";this.elements._lineEditor&&(e=void 0!==this.elements._lineEditor.value?this.elements._lineEditor.value:r.get("inputNoFileChosen")),this._defaultTooltipModel?this._defaultTooltipModel.shortHelp=e:this._defaultTooltipModel={shortHelp:e}},t}(s);return a.addClass(v,"filePicker"),v}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function l(e){try{r(n.next(e))}catch(e){o(e)}}function a(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,a)}r((n=n.apply(e,t||[])).next())}))},__generator=this&&this.__generator||function(e,t){var i,n,s,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=a(0),l.throw=a(1),l.return=a(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(a){return function(r){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;l&&(l=0,a[0]&&(o=0)),o;)try{if(i=1,n&&(s=2&a[0]?n.return:a[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,a[1])).done)return s;switch(n=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){o.label=a[1];break}if(6===a[0]&&o.label<s[1]){o.label=s[1],s=a;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(a);break}s[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{i=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,r])}}};define("DS/Controls/SelectionChips",["require","exports","UWA/Core","UWA/Utils","DS/Utilities/Utils","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Menu/ContextualMenu","DS/UIBehaviors/DragAndDropManager","DS/Core/WebUXComponents","i18n!DS/Controls/assets/nls/translation","./typings/types"],(function(e,t,i,n,s,o,l,a,r,h,u,c){"use strict";function d(){this._preventEventsCpt++}function p(){this._preventEventsCpt--}function m(){var e=!1;this._items.forEach((function(t){var i=t.associatedChipCellView;t.isSelected?i.isHighlighted||(i.isHighlighted=!0,e=!0,i.addClassName("wux-ui-state-highlighted")):i.isHighlighted&&(i.isHighlighted=!1,e=!0,i.removeClassName("wux-ui-state-highlighted"))})),e&&0===this._preventEventsCpt&&this.fire("selectionChange")}function g(e,t){var i=window.getComputedStyle(t),n=parseInt(i.borderLeftWidth,10),s=t.getBoundingClientRect();return e.clientX-n-s.left}function f(e,t){return g.call(this,e,t)<1*t.getDimensions().width/3?"left":"right"}function v(e){var t={chipCellView:void 0,dropPosition:"",dropIndex:void 0};if(t.chipCellView=a.firstParentWithClass(e.target,"wux-chip-cell-container"),void 0===t.chipCellView)for(var i=e.clientX,n=e.clientY,s=[{x:i,y:n-3},{x:i,y:n+3},{x:i-3,y:n},{x:i+3,y:n}],o=0;o<s.length;o++){var l=document.elementFromPoint(s[o].x,s[o].y),r=a.firstParentWithClass(l,"wux-chip-cell-container");if(r){t.chipCellView=r;break}}if(t.chipCellView&&("dragstart"===e.type||"dragover"===e.type||"dragenter"===e.type||"dragleave"===e.type||"drop"===e.type)){t.dropPosition=f.call(this,e,t.chipCellView);for(o=0;o<this._items.length;o++)this._items[o].associatedChipCellView===t.chipCellView&&(t.dropIndex=o)}return t}function y(e){var t=this,i={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"}[e.type];function n(i,n){var s=!0,o=t[i+n];if(o&&(s=o.call(t,e,t._currentDnDInfos)),s){var l=t[i+n+"Default"];l&&l.call(t,e,t._currentDnDInfos)}}"dragstart"!==e.type&&"dragover"!==e.type&&"dragenter"!==e.type&&"dragleave"!==e.type&&"drop"!==e.type||(this._currentDnDInfos=v.call(this,e)),"dragend"===e.type||"drop"===e.type?(b.call(this),D.call(this)):"dragleave"===e.type?E.call(this):"drag"!==e.type&&(S.call(this),w.call(this,e)),this._currentDnDInfos.chipCellView?n(i,"Cell"):n(i,"Blank")}function _(){this.__cachedCanBeDraggedFrom=void 0,this.__cachedCanBeDroppedTo=void 0}function b(){this._nextChipIsFirstInLine&&this._nextChipIsFirstInLine.classList.remove("wux-selectionchips-firstOfLine")}function C(e){this._nextChipIsFirstInLine=e,this._nextChipIsFirstInLine.classList.add("wux-selectionchips-firstOfLine")}function w(e){if(this.elements.dndSeparator||(this.elements.dndSeparator=new i.Element("span",{class:"wux-chip-cell-drop-feedback"})),this._currentDnDInfos)if(this._currentDnDInfos.chipCellView){var t=this._currentDnDInfos.dropPosition;if("left"===t)this.elements.dndSeparator.nextSibling!==this._currentDnDInfos.chipCellView&&(this.elements.dndSeparator.inject(this._currentDnDInfos.chipCellView,"before"),this.elements.dndSeparator.offsetTop!==this._currentDnDInfos.chipCellView.offsetTop&&(this._nextChipIsFirstInLine&&this._nextChipIsFirstInLine!==this._currentDnDInfos.chipCellView&&b.call(this),C.call(this,this._currentDnDInfos.chipCellView)));else if("right"===t&&this._currentDnDInfos.chipCellView.nextSibling!==this.elements.dndSeparator){var n=this._currentDnDInfos.chipCellView.nextSibling;this.elements.dndSeparator.inject(this._currentDnDInfos.chipCellView,"after"),n&&this.elements.dndSeparator.offsetTop!==n.offsetTop&&(this._nextChipIsFirstInLine&&this._nextChipIsFirstInLine!==n&&b.call(this),C.call(this,n))}}else this.elements.dndSeparator.inject(this.getContent())}function x(e){this.elements.dndSeparator&&(e?this.elements.dndSeparator.setAttribute("drop-acceptated","true"):void 0===e?this.elements.dndSeparator.setAttribute("drop-acceptated","unknown"):this.elements.dndSeparator.setAttribute("drop-acceptated","false"))}function E(){var e=this;this._delayedUnhighlightCB=setTimeout((function(){D.call(e)}),30)}function S(){this._delayedUnhighlightCB&&(clearTimeout(this._delayedUnhighlightCB),this._delayedUnhighlightCB=void 0)}function D(){this.elements.dndSeparator&&this.elements.dndSeparator.remove()}function A(e,t){t=i.extend({source:{uuid:this._uuid,amd:"DS/Controls/SelectionChips"},data:{"dswebux/x-controls.selectionchips.data+json":""}},t),e.dataTransfer.setData("Text",JSON.stringify(t))}function F(e){var t=e.dataTransfer.getData("Text");try{return JSON.parse(t)}catch(e){window.console.warn('the element being in dataTransfer type "text" is not parsable usable JSON.parse')}}function P(e){var t=this,n=new i.Element("div",{class:"wux-chip-cell-container"});n.isHighlighted=!1,n.associatedModelItem=e;var s=a.generateIcon(e.chipOptions.icon,e.chipOptions._iconOptions);s&&(s.setStyles({height:"12px",width:"12px","line-height":"13px","margin-right":void 0===e.chipOptions.label?"8px":""}),n.appendChild(s)),n.label=void 0,void 0!==e.chipOptions.label&&(n.label=new i.Element("li",{class:"wux-chip-cell-label",text:e.chipOptions.label}),n.appendChild(n.label));var o=new i.Element("li",{class:"wux-chip-cell-close wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-close"});o.tooltipInfos={shortHelp:c.get("close")},n.tooltipInfos=e.chipOptions.tooltip||{getAllInformationCB:function(){if(void 0!==n.label&&n.label.offsetWidth-15<Math.round(a.computeStringWidth(e.chipOptions.label,t._getCurrentTouchMode()?14:12,"Arial")))return{model:{updateModel:!0,shortHelp:e.chipOptions.label}};return{model:{updateModel:!0}}}},n.appendChild(o);var r=!0;return a.addEventOnElement(t,n,l.POINTERDOWN,(function(i){r=e.isSelected,e.isSelected||(t._modifierKeysPressed=i.ctrlKey||i.shiftKey,t.selectChip(e),t._modifierKeysPressed=!1)})),a.addEventOnElement(t,n,l.POINTERUP,(function(i){r&&e.isSelected&&(t._modifierKeysPressed=i.ctrlKey||i.shiftKey,t.unselectChip(e),t._modifierKeysPressed=!1)})),a.addEventOnElement(t,n,"mouseenter",(function(e){r=!1,n.addClassName("wux-ui-state-prehighlighted")})),a.addEventOnElement(t,n,"mouseleave",(function(e){n.removeClassName("wux-ui-state-prehighlighted")})),a.addEventOnElement(t,o,l.POINTERDOWN,(function(e){e.preventDefault(),e.stopPropagation()})),a.addEventOnElement(t,o,l.POINTERUP,(function(i){var n=t._items.findIndex((function(t){return t.associatedChipCellView===e.associatedChipCellView}));t.removeChip(n)})),n.setAttribute("draggable","true"),n}function I(e){var t={chipOptions:e,isSelected:!1,associatedChipCellView:void 0},i=P.call(this,t);return t.associatedChipCellView=i,{modelItem:t,chipCellView:i}}function V(e,t){if(e.getUUID()===t)return e;for(var i=s.getDocumentOwner(e.getContent()).body.getElementsByClassName("wux-controls-selectionChips"),n=0;n<i.length;n++){var o=i[n].dsModel;if(o.getUUID()===t)return o}}function T(e,t){return e.chipCellView?JSON.stringify(t)+"_"+e.chipCellView.associatedModelItem.chipOptions.id+"_"+e.dropPosition:this._items&&this._items.length>0?JSON.stringify(t)+"_"+this._items[this._items.length-1].chipOptions.id+"_right":JSON.stringify(t)+"_blank_"+e.dropPosition}function B(e,t){return __awaiter(this,void 0,void 0,(function(){var i,n,s,o,l,a;return __generator(this,(function(r){if(i=this,(n=h.getGlobalData())&&n.sourceSelectionChipUUID){if(this._cachedDndTimeStamp&&this._cachedDndTimeStamp!==n.timestamp&&_.call(this),this._cachedDndTimeStamp=n.timestamp,s=!0,o=void 0,l=T.call(this,t,n),a=V(this,n.sourceSelectionChipUUID),n.sourceSelectionChipUUID!==this.getUUID())if(D.call(a),this.__cachedCanBeDraggedFrom||(this.__cachedCanBeDraggedFrom={}),e.ctrlKey)s=!0,this.__cachedCanBeDraggedFrom[l]=s;else{if(this.__cachedCanBeDraggedFrom.hasOwnProperty(l))return this.__cachedCanBeDraggedFrom[l]?(e.preventDefault(),e.dataTransfer.dropEffect=e.ctrlKey?"copy":"move"):e.dataTransfer.dropEffect="none",[2];e.dataTransfer.dropEffect="move",x.call(i,void 0),e.preventDefault(),s=!!a.acceptDrop&&a.acceptDrop({sourceSelectionChips:a,targetSelectionChips:this,dndInfos:t}),this.__cachedCanBeDraggedFrom[l]=s}if(this.__cachedCanBeDroppedTo||(this.__cachedCanBeDroppedTo={}),this.__cachedCanBeDroppedTo.hasOwnProperty(l))return this.__cachedCanBeDroppedTo[l]?(e.preventDefault(),e.dataTransfer.dropEffect=e.ctrlKey?"copy":"move"):e.dataTransfer.dropEffect="none",[2];e.dataTransfer.dropEffect=e.ctrlKey?"copy":"move",x.call(i,void 0),e.preventDefault(),o=n.sourceSelectionChipUUID===this.getUUID()||!!this.acceptDrop&&this.acceptDrop.call(a,{sourceSelectionChips:a,targetSelectionChips:this,dndInfos:t}),this.__cachedCanBeDroppedTo[l]=o,Promise.all([s,o]).then((function(t){if(i.__cachedCanBeDraggedFrom&&(i.__cachedCanBeDraggedFrom[l]=t[0]),i.__cachedCanBeDroppedTo&&(i.__cachedCanBeDroppedTo[l]=t[1]),!t[0]||!t[1])return e.dataTransfer.dropEffect="none",void x.call(i,!1);e.dataTransfer.dropEffect=e.ctrlKey?"copy":"move",x.call(i,!0)}))}else e.preventDefault(),x.call(this,!0);return[2]}))}))}function O(e,t){return __awaiter(this,void 0,void 0,(function(){var i,n,s,o,l,a,r,u,c,g,f,v,y,b,C,w,x,E;return __generator(this,(function(S){switch(S.label){case 0:return i=!1,n=F.call(this,e),(s=h.getGlobalData())&&s.sourceSelectionChipUUID&&s.sourceSelectionChipUUID!==this.getUUID()?(o=T.call(this,t,s),l=this.__cachedCanBeDraggedFrom[o],a=this.__cachedCanBeDroppedTo[o],[4,Promise.all([l,a]).then((function(e){return!(!e[0]||!e[1])}))]):[3,2];case 1:if(r=S.sent(),_.call(this),!r)return[2];S.label=2;case 2:if(d.call(this),u=[],n&&(c=n.source?n.source.uuid:void 0,g=t.chipCellView?t.chipCellView.associatedModelItem:void 0,this._uuid!==c||!g||!g.isSelected)){if(f=n.data["dswebux/x-controls.selectionchips.items+json"],v=t.dropPosition,(b=V(y=this,c))&&!e.ctrlKey){for(C=[],w=0;w<b._items.length;w++)b._items[w].isSelected&&C.push(w);C.sort((function(e,t){return e>t?-1:1})),b.removeChips(C)}f&&(x=this._items.indexOf(g),E=void 0,"left"===v?E=-1!==x?x:0:"right"===v&&(E=-1!==x?x+1:0),f.forEach((function(e){i=!0,y._onDragAndDropFlag=!0,y.elements._lastWidgetDiv.children.length>0&&void 0===E?e.index=y._items.length:(e.index=E,Number.isInteger(E)&&E++);var t=y.addChip(e);t.isSelected=!0,u.push(t),y._onDragAndDropFlag=!1})),m.call(this))}return p.call(this),i&&0===this._preventEventsCpt&&(this.fire("change"),this.fire("dimensionsChanged"),this.fire("onPostAdd",{chips:u})),[2]}}))}))}var M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{selection:{defaultValue:{toggle:!0,mode:2,unselectAllOnEmptyArea:!0},type:"object",category:"Behavior",noNeedToApplyFlag:!0},placeholder:{defaultValue:"",type:"string",category:"Appearance"},displayMenu:{defaultValue:!0,type:"boolean",category:"Appearance"},acceptDrop:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragStartCell:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragEndCell:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragOverCell:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragEnterCell:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragLeaveCell:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDropCell:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDropBlank:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragLeaveBlank:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragOverBlank:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0},onDragEnterBlank:{defaultValue:void 0,type:"function",category:"Behavior",noNeedToApplyFlag:!0}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this._uuid=n.getUUID(),this._preventEventsCpt=0,this.elements.container.addClassName("wux-controls-selectionChips"),this.elements._placeholderDiv=new i.Element("div",{class:"wux-controls-placeholder-selectionChips",text:this.placeholder}).inject(this.elements.container),this.elements._lastWidgetDiv=new i.Element("div",{class:"wux-controls-lastWidget-selectionChips"}),this._lastWidgetDiv=this.elements._lastWidgetDiv,this._items=[],this._onDragAndDropFlag=!1},t.prototype.handleEvents=function(){var e=this,t=y.bind(this);a.addEventOnElement(this,this.getContent(),"dragstart",t),a.addEventOnElement(this,this.getContent(),"drop",t),a.addEventOnElement(this,this.getContent(),"dragover",t),a.addEventOnElement(this,this.getContent(),"drag",t),a.addEventOnElement(this,this.getContent(),"dragend",t),a.addEventOnElement(this,this.getContent(),"dragleave",t),a.addEventOnElement(this,this.getContent(),"dragenter",t),r.addEventListener(this.getContent(),{callback:function(t){if(!(e.disabled||t.data.target&&"input"===t.data.target.tagName.toLowerCase()))return[{type:"PushItem",title:c.get("clearAll"),action:{callback:function(){a.pushUserInteractionContext(),e.removeAllChips(),a.popUserInteractionContext()}}}]}}),a.addEventOnElement(this,this.getContent(),l.POINTERDOWN,(function(t){var i=t.target.className;e.selection.unselectAllOnEmptyArea&&-1===i.indexOf("wux-chip-cell-container")&&-1===i.indexOf("wux-chip-cell-label")&&-1===i.indexOf("wux-chip-cell-close")&&e.unselectAllChips()})),this._modifierKeysPressed=!1},t.prototype.isInMultiSelection=function(){return this.selection.mode===t.SELECTION_MODE.MULTIPLE||this.selection.mode===t.SELECTION_MODE.MULTIPLE_ONKEYS&&this._modifierKeysPressed},t.prototype._applyPlaceholder=function(e){this.elements._placeholderDiv.setText(this.placeholder)},t.prototype._applyDisplayMenu=function(e){if(e!==this.displayMenu){var t=this;this.elements.container.removeAttribute("has-menu"),this.elements._clearAllDiv&&(this.elements._clearAllDiv.remove(),this.elements._clearAllDiv.destroy(),this.elements._clearAllDiv=null),this.displayMenu&&(this.elements._clearAllDiv=new i.Element("div",{class:"wux-controls-clear-selectionChips wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-menu-dot"}),this.elements._clearAllDiv.tooltipInfos={shortHelp:c.get("menu")},this.elements._clearAllDiv.inject(this.elements.container),a.addEventOnElement(this,this.elements._clearAllDiv,"click",(function(e){e.stopPropagation();var i=document.createEvent("HTMLEvents");i.initEvent("contextmenu",!0,!1),i.pageX=e.pageX,i.pageY=e.pageY,t.getContent().dispatchEvent(i)})),this.elements.container.setAttribute("has-menu",!0))}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("placeholder")&&this._applyPlaceholder(t.placeholder),this.isDirty("displayMenu")&&this._applyDisplayMenu(t.displayMenu)},t.prototype.getUUID=function(){return this._uuid},t.prototype._applyIdentifier=function(){this.identifier&&this.getContent().setAttribute("wux-identifier",this.identifier)},t.prototype._flashEffectOnChip=function(e,t){t>=0&&t<this._items.length&&(this._items[t].associatedChipCellView.classList.add(e),this._items[t].associatedChipCellView.addEventListener("animationend",(function(t){t.target.classList.remove(e)})))},t.prototype.selectChip=function(e){var t=void 0;"string"==typeof e?this._items.some((function(i){return i.chipOptions.label===e&&(t=i,!0)})):"number"==typeof e?e>=0&&e<this._items.length&&(t=this._items[e]):t=e,void 0!==t&&(this.isInMultiSelection()||this._items.forEach((function(e){e.isSelected=!1})),t.isSelected=!0,m.call(this))},t.prototype.selectAllChips=function(){this.isInMultiSelection()&&(this._items.forEach((function(e){e.isSelected=!0})),m.call(this))},t.prototype.unselectChip=function(e){if(this.selection.toggle||this.isInMultiSelection()){var t=void 0;"string"==typeof e?this._items.some((function(i){return i.chipOptions.label===e&&(t=i,!0)})):"number"==typeof e?e>=0&&e<this._items.length&&(t=this._items[e]):t=e,void 0!==t&&(t.isSelected=!1,m.call(this))}},t.prototype.unselectAllChips=function(){(this.selection.toggle||this.isInMultiSelection()||arguments||arguments[0])&&(this._items.forEach((function(e){e.isSelected=!1})),m.call(this))},t.prototype.addChip=function(e){if(e){var t=void 0;if("string"==typeof e?t={label:e}:"object"==typeof e&&(t=Object.assign({},e)),t&&(void 0===t.index&&(t.index=this._items.length),!(t.index<0||t.index>this._items.length))){var i=I.call(this,t);if(this._items.splice(t.index,0,i.modelItem),t.index<this._items.length-1)for(var n=t.index+1;n<this._items.length;n++)this._items[n].chipOptions.index=n;if(this.elements._placeholderDiv.remove(),t.index===this._items.length)this.elements.container.appendChild(i.chipCellView);else{var s=this.displayMenu?t.index+1:t.index;this.elements.container.insertBefore(i.chipCellView,this.elements.container.children[s])}return this.elements._lastWidgetDiv.children.length>0&&!this._onDragAndDropFlag&&this.elements.container.appendChild(this.elements._lastWidgetDiv),this._addMultipleChips||0===this._preventEventsCpt&&(this.fire("change"),this.fire("dimensionsChanged"),this.fire("onPostAdd",{chips:[i.modelItem]})),i.modelItem}}},t.prototype.addChips=function(e){if(e){this._addMultipleChips=!0;for(var t=0;t<e.length;t++){var i=void 0;"string"==typeof e[t]?i={label:e[t]}:"object"==typeof e[t]&&(i=Object.assign({},e[t])),this.addChip({label:i.label,value:i.value,icon:i.icon,tooltip:i.tooltip,_iconOptions:i._iconOptions,id:i.id,index:i.index})}0===this._preventEventsCpt&&(this.fire("change"),this.fire("dimensionsChanged"),this.fire("onPostAdd",{chips:e})),this._addMultipleChips=!1}},t.prototype.addLastWidget=function(e){e&&(this.elements._placeholderDiv&&this.elements._placeholderDiv.remove(),this.elements.container.appendChild(this.elements._lastWidgetDiv),this.elements._lastWidgetDiv.setContent(e))},t.prototype.removeLastWidget=function(){this.elements._lastWidgetDiv.children.length&&this.elements._lastWidgetDiv.removeChild(this.elements._lastWidgetDiv.firstChild)},t.prototype.removeChip=function(e){var t=!1,i=void 0;if("string"==typeof e){var n=this;this._items.some((function(s,o){return s.chipOptions.label===e&&(n._items.splice(o,1),n.elements.container.removeChild(s.associatedChipCellView),i=s,t=!0,!0)}))}else if("number"==typeof e){if(e>=0&&e<this._items.length){var s=this._items.splice(e,1)[0];this.elements.container.removeChild(s.associatedChipCellView),i=s,t=!0}}else if("object"==typeof e&&void 0!==e){n=this;var o=Object.keys(e);if(o.length<1)return;var l=o[0];if(this._items.some((function(s,o){return s.chipOptions[l]===e[l]&&(n._items.splice(o,1),n.elements.container.removeChild(s.associatedChipCellView),i=s,t=!0,!0)})),i.index<this._items.length-1)for(var a=i.index+1;a<this._items.length;a++)this._items[a].chipOptions.index=a}return 0===this._items.length&&0==this.elements._lastWidgetDiv.children.length&&(this.elements._clearAllDiv?this.getContent().insertBefore(this.elements._placeholderDiv,this.elements._clearAllDiv):this.getContent().appendChild(this.elements._placeholderDiv)),t&&0===this._preventEventsCpt&&(this.fire("change"),this.fire("dimensionsChanged"),this.fire("onPostRemove",{chips:[i]})),i},t.prototype.removeChips=function(e){if(e.length>0){var t=[];d.call(this);for(var i=0;i<e.length;i++)t.push(this.removeChip(e[i]));p.call(this),0===this._preventEventsCpt&&(this.fire("change"),this.fire("dimensionsChanged"),this.fire("onPostRemove",{chips:t}))}},t.prototype.removeAllChips=function(){if(this._items.length>0){var e=this._items;this._items=[],this.getContent().empty(),this.elements._placeholderDiv.inject(this.getContent()),this._applyDisplayMenu(),0!==this.elements._lastWidgetDiv.children.length&&this.elements._lastWidgetDiv.inject(this.getContent()),0===this._preventEventsCpt&&(this.fire("change"),this.fire("dimensionsChanged"),this.fire("onPostRemove",{chips:e,allChipsRemoved:!0}))}},t.prototype.updateChipOptions=function(e,t){var n=!1;if(void 0!==e&&t){var s=void 0;if("string"==typeof t?s={label:t}:"object"==typeof t&&(s=Object.assign({},t)),s){var o=void 0;if("string"==typeof e?this._items.some((function(t,i){return t.chipOptions.label===e&&(o=t,!0)})):"number"==typeof e&&e>=0&&e<this._items.length&&(o=this._items[e]),void 0!==o){var l=o.chipOptions;i.merge(s,l),o.chipOptions=s;n=!1;l.label!==s.label&&(o.associatedChipCellView.label.textContent=s.label,n=!0),l.icon,s.icon,l.index!==s.index&&(this._items.splice(l.index,1),o.associatedChipCellView.remove(),this._items.splice(s.index,0,o),this.elements.container.insertBefore(o.associatedChipCellView,this.elements.container.children[s.index+1]),n=!0),n&&0===this._preventEventsCpt&&(this.fire("change"),this.fire("dimensionsChanged"))}}}},t.prototype.getChipLabel=function(e){return e>=0&&e<this._items.length?this._items[e].chipOptions.label:""},t.prototype.getChipPosition=function(e){var t=-1;return this._items.some((function(i,n){return i.chipOptions.label===e&&(t=n,!0)})),t},t.prototype.getAllChipsOptions=function(){var e=[];return this._items.forEach((function(t){e.push(Object.assign({},t.chipOptions))})),e},t.prototype.getAllChipsAsLabels=function(){var e=[];return this._items.forEach((function(t){e.push(t.chipOptions.label)})),e},t.prototype.getSelectedChipsOptions=function(){var e=[];return this._items.forEach((function(t){t.isSelected&&e.push(Object.assign({},t.chipOptions))})),e},t.prototype.getNumberOfChips=function(e){if(e){var t=0;return this._items.forEach((function(e){e.isSelected&&t++})),t}return this._items.length},t.prototype.onDragStartCellDefault=function(e,t){var i=[];this._items.forEach((function(e){e.isSelected&&("object"==typeof e.chipOptions.value&&(e.chipOptions.value=e.chipOptions.value._options.value),i.push(e.chipOptions))})),A.call(this,e,{data:{"dswebux/x-controls.selectionchips.items+json":i}}),e.dataTransfer.effectAllowed="copyMove",h.storeGlobalData({sourceSelectionChipUUID:this.getUUID(),draggedItems:i,timestamp:Date.now()})},t.prototype.onDragEndCellDefault=function(e,t){},t.prototype.onDragOverCellDefault=function(e,t){B.call(this,e,t)},t.prototype.onDragEnterCellDefault=function(e,t){e.preventDefault()},t.prototype.onDragLeaveCellDefault=function(e,t){return!0},t.prototype.onDropCellDefault=function(e,t){e.preventDefault(),O.call(this,e,t)},t.prototype.onDropBlankDefault=function(e,t){O.call(this,e,t)},t.prototype.onDragLeaveBlankDefault=function(e,t){},t.prototype.onDragOverBlankDefault=function(e,t){B.call(this,e,t)},t.prototype.onDragEnterBlankDefault=function(e,t){e.preventDefault()},t}(o);return function(e){!function(e){e[e.SINGLE=0]="SINGLE",e[e.MULTIPLE=1]="MULTIPLE",e[e.MULTIPLE_ONKEYS=2]="MULTIPLE_ONKEYS"}(e.SELECTION_MODE||(e.SELECTION_MODE={}))}(M||(M={})),u.addClass(M,"selectionChips"),M}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ButtonGroup",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Utilities/Dom","DS/Controls/Toggle","DS/Controls/Button","DS/Utilities/KeyboardUtils","DS/Core/WebUXComponents"],(function(e,t,i,n,s,o,l,a,r){"use strict";var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:void 0,type:"array",category:"Behavior",advancedSetter:!0,recordFlag:!0},type:{defaultValue:"radio",type:"string",category:"Behavior"},minButtonWidth:{defaultValue:-1,type:"integer",category:"Appearance"},preferredButtonWidth:{defaultValue:-1,type:"integer",category:"Appearance"},multiSelFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},allowResetToUndefinedByUIFlag:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){this.elements.container=i.Element("div",{class:"wux-controls-buttongroup"}),this.preventTriggeringChangeEvent=0,e.prototype._preBuildView.call(this,t)},t.prototype._applyRecId=function(e){if(null!==this.recId&&void 0!==this.recId)for(var t=this._getButtonList(),i=0;i<t.length;i++)t[i].recId=this.recId+t[i].value;else if(null!=e)for(t=this._getButtonList(),i=0;i<t.length;i++)t[i].recId=null},t.prototype._applyMultiSelFlag=function(e){for(var t=this._getButtonList(),i=0;i<t.length;i++)t[i].multiSelWithControlFlag=this.multiSelFlag},t.prototype._applyType=function(e){var t=this._getButtonList();if("radio"===this.type)for(var i=0;i<t.length;i++)t[i].type="radio",t[i].checkFlag=!1;else if("checkbox"===this.type)for(i=0;i<t.length;i++)t[i]instanceof l?t[i].type="check":t[i]instanceof o&&(t[i].type="checkbox");else if("switch"===this.type)for(i=0;i<t.length;i++)t[i]instanceof o&&(t[i].type="switch")},t.prototype._updateChildPropertiesAndListeners=function(e,t){if(void 0===e.value)if(void 0!==t)e.value=t;else{var i=this.getButtonCount();e.value=i}for(var n=!0;n;){n=!1;for(var s=this._getButtonList(),a=0;a<s.length;a++){var r=s[a];if(r.value===e.value&&r!==e&&(e instanceof l==r instanceof l||e instanceof o==r instanceof o)){e.value=e.value+1,n=!0;break}}}var h=e._getDisabledState(),u=!0===this.disabled?this.disabled:h;if(e.setDisabledFlagWithoutChangingDisabledState(u),e.touchMode=this.touchMode,e.multiSelWithControlFlag=this.multiSelFlag,e.checkFlag)if("radio"===this.type)this.value=[e.value],e._uncheckSiblings();else{var c=this.value.slice();c.push(e.value),this.value=c}},t.prototype.addChild=function(e,t){e.recId||null===this.recId||void 0===this.recId||(e.recId=this.recId+e.value),this._updateChildPropertiesAndListeners(e,t),this._addChildToUI(e,t)},t.prototype._addChildToUI=function(e,t){if(void 0===t||t>=this.elements.container.childNodes.length)e.inject(this.elements.container);else{var i=this.elements.container.getChildren()[t];e.inject(i,"before")}},t.prototype.moveButton=function(e,t){var i=this,n=this.getButton(e);n&&this.__privateLockChange((function(){i.removeChild(n),i.addChild(n,t)}))},t.prototype._getButtonList=function(){for(var e=this.elements.container.childNodes,t=[],i=0;i<e.length;i++){var n=e[i];n.dsModel&&(n.dsModel instanceof l||n.dsModel instanceof o)&&t.push(n.dsModel)}return t},t.prototype.getButtonCount=function(){return this._getButtonList().length},t.prototype.getButtonIndex=function(e){return this._getButtonList().indexOf(e)},t.prototype.getButton=function(e){return this._getButtonList()[e]},t.prototype.getButtonFromValue=function(e){for(var t=0;t<this.elements.container.childNodes.length;t++){var i=this.elements.container.childNodes[t].dsModel;if(void 0!==i.value&&null!==i.value&&null!==e&&i.value===e)return i}},t.prototype.removeChild=function(e){if(e&&(e.remove(),this.value&&this.value.length>0)){var t=this.value.indexOf(e.value);if(-1!==t){var i=this.value.slice();i.splice(t,1),this.value=i}}},t.prototype.selectIndex=function(e){var t=this.getButton(e);if(t){if("radio"===this.type)this.value=[t.value];else{var i=this.value.slice();i.push(t.value),this.value=i}t.getContent().focus()}},t.prototype._isButtonValueInButtonGroup=function(e){for(var t=this._getButtonList(),i=0;i<t.length;i++){if(t[i].value===e)return!0}return!1},t.prototype.selectValue=function(e){if(this._isButtonValueInButtonGroup(e))if("radio"===this.type)this.value=[e];else{var t=this.value.slice();t.push(e),this.value=t}},t.prototype.selectNext=function(){d.call(this,!1)},t.prototype.selectPrevious=function(){d.call(this,!0)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("value")&&this._applyValue(t.value),void 0===this.value&&(this.value=[]),this.isDirty("touchMode")&&this._applyTouchMode(),this.isDirty("multiSelFlag")&&this._applyMultiSelFlag(t.multiSelFlag)},t.prototype._applyMaxWidth=function(){-1!==this.maxWidth?(this.elements.container.setStyle("max-width",this.maxWidth+"px"),this.elements.container.setStyle("overflow","hidden")):(this.elements.container.setStyle("max-width",""),this.elements.container.setStyle("overflow",""))},t.prototype._applyDisabled=function(e){this.disabled?this.elements.container.setAttribute("tabindex",-1):this.elements.container.removeAttribute("tabindex");for(var t=this._getButtonList(),i=0;i<t.length;i++)t[i].setDisabledFlagWithoutChangingDisabledState(!0===this.disabled?this.disabled:t[i]._getDisabledState())},t.prototype._preEditValue=function(e,t){if(!Array.isArray(t))return{validValue:[t]};if(t.length>1&&"radio"===this.type){var i=this._getButtonList();if(!this.multiSelFlag||!function(e){for(var t=0;t<e.length;t++)if(!e[t]||e[t]instanceof o)return!1;return!0}(i))return{validValue:[t[0]]}}return!0},t.prototype._applyValue=function(e){var t=this._getButtonList();t.forEach((function(e){e.preventTriggeringChangeEvent=!0,e.preventToggleSiblings=!0}));var i=c.call(this,this.value);i.length>1&&this.multiSelFlag?t.forEach((function(e){i.indexOf(e)>-1?e.checkFlag=!0:e.checkFlag=!1})):(c.call(this,e).forEach((function(e){e.checkFlag=!1})),i.length>0&&i.forEach((function(e){e.checkFlag=!0})));t.forEach((function(e){e.preventTriggeringChangeEvent=!1,e.preventToggleSiblings=!1})),0===this.preventTriggeringChangeEvent&&this.fire("change")},t.prototype._onCheckFlagUpdated=function(e){var t=this;if(e&&p.call(this,e)){var i=this._getButtonList();i.forEach((function(e){e.preventTriggeringChangeEvent=!0}));var n=this.value?this.value.slice(0):[];this.__privateLockChange((function(){i.forEach((function(e){e.checkFlag&&-1===t.value.indexOf(e.value)?n.push(e.value):e.checkFlag||-1===t.value.indexOf(e.value)||n.splice(n.indexOf(e.value),1)})),0!==n.length||t.allowResetToUndefinedByUIFlag?t.value=n:t._applyValue()})),(i=this._getButtonList()).forEach((function(e){e.preventTriggeringChangeEvent=!1}))}0===this.preventTriggeringChangeEvent&&this.fire("change")},t.prototype._applyPreferredButtonWidth=function(){for(var e=this._getButtonList(),t=0;t<e.length;t++){var i=e[t];i instanceof l&&(i.preferredWidth=this.preferredButtonWidth)}},t.prototype._applyMinButtonWidth=function(){for(var e=this._getButtonList(),t=0;t<e.length;t++){var i=e[t];i instanceof l&&(i.minWidth=this.minButtonWidth)}},t.prototype._applyTouchMode=function(t){e.prototype._applyTouchMode.call(this,t);for(var i=this._getCurrentTouchMode(),n=this._getButtonList(),s=0;s<n.length;s++)n[s].touchMode=i},t.prototype._hasOverflow=function(){return this.getContent().scrollWidth>this.getContent().offsetWidth},t.prototype.handleEvents=function(){var e=this;s.addEventOnElement(this,this.elements.container,"keydown",(function(t){if(!e.disabled){var i=!1;a.previous(t.keyCode)&&(e.callMethodFromUIInteraction("selectPrevious"),i=!0),a.next(t.keyCode)&&(e.callMethodFromUIInteraction("selectNext"),i=!0),a.PAGEUP==t.keyCode&&(e.callMethodFromUIInteraction("selectIndex",0),i=!0),a.PAGEDOWN==t.keyCode&&(e.callMethodFromUIInteraction("selectIndex",e.getButtonCount()-1),i=!0),i&&(t.preventDefault(),t.stopPropagation())}})),s.addEventOnElement(this,this.elements.container,"change",(function(t){t.target!==e.elements.container&&(t.stopPropagation(),t.stopImmediatePropagation(),e._onCheckFlagUpdated(t.dsModel))}))},t.prototype.destroy=function(){for(var t=this._getButtonList(),i=0;i<t.length;i++)t[i].destroy();t=null,e.prototype.destroy.call(this)},t.prototype.__privateLockChange=function(e){this.preventTriggeringChangeEvent++,e(),this.preventTriggeringChangeEvent--},t}(n);function u(){for(var e=this.getOwnerDocument(),t=0;t<this.elements.container.childNodes.length;t++){var i=this.elements.container.childNodes[t];if(i===e.activeElement)return i.dsModel}return null}function c(e){for(var t=[],i=0;i<this.elements.container.childNodes.length;i++){var n=this.elements.container.childNodes[i].dsModel;void 0!==n.value&&null!==n.value&&null!=e&&-1!==e.indexOf(n.value)&&t.push(n)}return t}function d(e){var t,i=u.call(this),n=(e?"previous":"next")+"Sibling";if(i&&(t=i.getContent()[n])){var s=t.dsModel;s&&s.visibleFlag&&p.call(this,s)&&"radio"===this.type&&(this.value=[s.value]),t.focus()}}function p(e){return e instanceof o||e instanceof l}return h.prototype.markForRecordFlag=!0,r.addClass(h,"buttonGroup"),h}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function l(e){try{r(n.next(e))}catch(e){o(e)}}function a(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,a)}r((n=n.apply(e,t||[])).next())}))},__generator=this&&this.__generator||function(e,t){var i,n,s,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=a(0),l.throw=a(1),l.return=a(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(a){return function(r){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;l&&(l=0,a[0]&&(o=0)),o;)try{if(i=1,n&&(s=2&a[0]?n.return:a[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,a[1])).done)return s;switch(n=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){o.label=a[1];break}if(6===a[0]&&o.label<s[1]){o.label=s[1],s=a;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(a);break}s[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{i=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,r])}}};define("DS/Controls/BaseCard",["require","exports","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Core/WebUXComponents","DS/Utilities/Dom","./typings/types","DS/CoreBase/WebUXGlobalEnums"],(function(e,t,i,n,s,o){"use strict";function l(e){var t=this._getCurrentTouchMode(),i=t?"setAttribute":"removeAttribute",n=this._elements[e]||this.elements[e];n&&((n.getContent&&n.getContent()||n).dsModel?n.touchMode=t:n[i]("touch-mode",""))}function a(e){var t=this._debug?"setAttribute":"removeAttribute",i=this._elements[e]||this.elements[e];i&&(i.getContent&&i.getContent()||i)[t]("_debug","")}var r=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i,"publishedProperties",{get:function(){return{_debug:{defaultValue:!1,type:"boolean",category:"Appearance"},highlightModel:{defaultValue:void 0,type:"object",category:"Appearance"}}},enumerable:!1,configurable:!0}),i.prototype._preBuildView=function(e){void 0===this._elements&&(this._elements={}),void 0===this._debug&&(this._debug=!1),t.prototype._preBuildView.call(this,e)},i.prototype.buildView=function(){t.prototype.buildView.call(this),this.elements.container.addClassName("wux-controls-"+this._classId)},i.prototype._applyProperties=function(e){t.prototype._applyProperties.call(this,e),this.isDirty("_debug")&&this._apply_debug()},i.prototype.handleEvents=function(){},i.prototype._bindMainActionToElt=function(t){var i=this;this._mainActionElement=t,o.addEventOnElement(t,t,n.POINTERHIT,(function(t){return __awaiter(i,void 0,void 0,(function(){var i,n,s,o,l,a,r,h;return __generator(this,(function(u){switch(u.label){case 0:return void 0===(i=this.mainAction)?[3,5]:(t.stopImmediatePropagation(),this._mainActionElement.setAttributeNode(document.createAttribute("visited")),"function"!=typeof i?[3,1]:(i(),[3,4]));case 1:return"object"==typeof(c=i)&&(c.hasOwnProperty("func")&&"function"==typeof c.func||c.hasOwnProperty("func")&&"string"==typeof c.func&&c.hasOwnProperty("module")&&"string"==typeof c.func)?"function"!=typeof i.func?[3,2]:(l=Object.assign({},i.argument),i.func(l),[3,4]):[3,4];case 2:return n=i.module,[4,new Promise((function(t,i){e([n],t,i)}))];case 3:(s=u.sent())&&(o=s[i.func])&&"function"==typeof o&&(l=Object.assign({},i.argument),o(l)),u.label=4;case 4:a=void 0,r=void 0,"string"==typeof i?(a="_blank",r=i):function(e){var t=e;return"object"==typeof t&&t.hasOwnProperty("url")&&"string"==typeof t.url}(i)&&(a=i.target||"_blank",r=i.url+(i.parameters?i.parameters:"")),r&&a&&("_blank"===a?window.open(r,"_blank"):"_self"===a?window.location.href=r:"_parent"===a?window.parent.location.href=r:"_top"===a?window.top.location.href=r:a&&(h=window.frames[a])&&(h.location.href=r)),u.label=5;case 5:return[2]}var c}))}))}))},i.prototype._applyTouchMode=function(e){for(var i in t.prototype._applyTouchMode.call(this,e),this.elements)l.call(this,i);for(var i in this._elements)l.call(this,i)},i.prototype._applyHighlightModel=function(){},i.prototype._apply_debug=function(){for(var e in this.elements)a.call(this,e);for(var e in this._elements)a.call(this,e)},i.prototype._updateElement=function(e){var t=e.name,i=e.parentName,n=e.nextSiblingsNames,s=e.shouldAddElement,o=e.createElement,r=e.fillElement,h=e.keepParentWhenRemoved;if(s.call(this)){this._elements[t]||(this._elements[t]=o?o.call(this):document.createElement("div"),(this._elements[t].getContent&&this._elements[t].getContent()||this._elements[t]).classList.add("wux-".concat(this._classId,"-").concat(t)));var u=this._elements[t].getContent&&this._elements[t].getContent()||this._elements[t];if(r&&r.call(this),!u.parentNode){this["_updateContainer_"+i]();for(var c=this._elements[i]||this.elements[i],d=!1,p=0;p<n.length&&!d;p++){var m=n[p],g=this._elements[m],f=(null==g?void 0:g.getContent)?g.getContent():g;(null==f?void 0:f.parentNode)&&(f.parentNode.insertBefore(u,f),d=!0)}d||c.appendChild(u)}l.call(this,t),a.call(this,t)}else{var v=(u=this._elements[t]&&this._elements[t].getContent&&this._elements[t].getContent()||this._elements[t])&&u.parentNode?u.parentNode:void 0;if(v&&(u.remove(),!h))for(var y=void 0;v&&v!==this.elements.container&&(v=(y=v).parentNode,0===y.children.length);)y.remove()}this._updateHasElements_TO_REMOVE_WHEN_HAS_IS_SUPPORTED()},i.prototype._updateHasElements_TO_REMOVE_WHEN_HAS_IS_SUPPORTED=function(){},i.prototype._updateContainerElement=function(e){var t=e.name,i=e.parentName,n=e.prepend,s=e.fillElement,o=e.nextSiblingsNames;if(this["_updateContainer_"+i](),this._elements[t]||(this._elements[t]=document.createElement("div"),this._elements[t].classList.add("wux-".concat(this._classId,"-").concat(t)),s&&s.call(this)),!this._elements[t].parentNode)if(o){for(var l=this._elements[i]||this.elements[i],a=!1,r=0;r<o.length&&!a;r++){var h=this._elements[o[r]];h&&h.parentNode&&(l.insertBefore(this._elements[t],h),a=!0)}a||l.appendChild(this._elements[t])}else(this._elements[i]||this.elements[i])[n?"prepend":"appendChild"](this._elements[t])},i}(i);return s.addClass(r,"baseCard"),r}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Stepper",["require","exports","DS/Core/WebUXComponents","DS/Utilities/Dom","DS/Controls/Abstract","DS/Controls/BaseCard","./typings/types","DS/CoreBase/WebUXGlobalEnums"],(function(e,t,i,n,s,o){"use strict";function l(){var e=this,t=this.title.trim(),i=this.description.trim(),s=this.detailsFlag&&Boolean(t);this._updateElement({name:"body_title_span",parentName:"body_title",nextSiblingsNames:[],shouldAddElement:function(){return s},fillElement:function(){e._elements.body_title_span.textContent=t}}),this._updateElement({name:"body_description",parentName:"body",nextSiblingsNames:[],shouldAddElement:function(){return s},fillElement:function(){e._elements.body_description.textContent=i}});var o=Math.min(n.computeStringWidth(t,12,"arial",!0),182),l=Math.min(n.computeStringWidth(i,12,"arial",!1),182),a=s?24+Math.max(o,l):0;this._fullWidthHorizontal=64+a+10,this._fullWidthVertical=60+a+10}var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{title:{defaultValue:"",type:"string",category:"Appearance"},description:{defaultValue:"",type:"string",category:"Appearance"},status:{defaultValue:"default",type:"WUX.StepStatus",category:"Appearance"},number:{defaultValue:0,type:"number",category:"Appearance"},activeFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},detailsFlag:{defaultValue:!0,type:"boolean",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("title")&&this._applyTitle(),this.isDirty("description")&&this._applyDescription(),this.isDirty("status")&&this._applyStatus(),this.isDirty("number")&&this._applyNumber(),this.isDirty("activeFlag")&&this._applyActiveFlag(),this.isDirty("detailsFlag")&&this._applyDetailsFlag()},t.prototype._preBuildView=function(t){this._classId="step",e.prototype._preBuildView.call(this,t)},t.prototype._applyTitle=function(){l.call(this)},t.prototype._applyDescription=function(){l.call(this)},t.prototype._applyStatus=function(){var e=this;this.elements.container.setAttribute("status",this.status),this._updateElement({name:"number",parentName:"container",nextSiblingsNames:["body"],shouldAddElement:function(){return!0},fillElement:function(){n.generateIcon({step:{value:e.number,status:e.status}},{target:e._elements.number})}})},t.prototype._applyNumber=function(){var e=this;this._updateElement({name:"number",parentName:"container",nextSiblingsNames:["body"],shouldAddElement:function(){return!0},fillElement:function(){n.generateIcon({step:{value:e.number,status:e.status}},{target:e._elements.number})}})},t.prototype._applyActiveFlag=function(){this.getContent().toggleAttribute("active",this.activeFlag)},t.prototype._applyDetailsFlag=function(){l.call(this)},t.prototype.update=function(e){var t=this;Object.keys(e).forEach((function(i){t[i]=e[i]}))},t.prototype._getFullWidth=function(e){return"horizontal"===e?this._fullWidthHorizontal:this._fullWidthVertical},t.prototype._updateContainer_container=function(){},t.prototype._updateContainer_body=function(){this._updateContainerElement({name:"body",parentName:"container",prepend:!1,nextSiblingsNames:[]})},t.prototype._updateContainer_body_title=function(){this._updateContainerElement({name:"body_title",parentName:"body",prepend:!0,nextSiblingsNames:["body_description"]})},t.prototype.handleEvents=function(){var e=this;n.addEventOnElement(this,this.elements.container,"click",(function(t){t.stopPropagation(),e.fire("clickOnStep")}))},t}(o);function r(){for(var e=this,t=0;t<this.steps.length;t++)this._stepsViews[t]||(this._stepsViews[t]=new a,n.addEventOnElement(this,this._stepsViews[t],"clickOnStep",(function(t){t.stopPropagation(),e.activeStep=e.number-1,e.fire("activeStepChange")}))),this._stepsViews[t].update(Object.assign({title:"",description:"",status:"default",number:t+1,activeFlag:t===this.activeStep,detailsFlag:this.detailsFlag},this.steps[t])),this._stepsViews[t].getContent().parentNode||this._stepsViews[t].inject(this.elements.container);this._stepsViews.slice(this.steps.length).forEach((function(e){return e.remove()})),this._apply_debug()}function h(e){if(e.__isProxy)return e;var t=this;function i(e){return new Proxy(e,{get:function(e,t,i){return"__isProxy"===t||Reflect.get(e,t,i)},set:function(e,i,n){e[i]=n;var s=t._steps.indexOf(e),o=t._stepsProxies[s];return t._stepsViews[s].update(o),!0}})}return this._steps=[],this._stepsProxies=e.map((function(e,n){return t._steps.push(e),i(e)})),new Proxy(this._stepsProxies,{get:function(e,t,i){return"__isProxy"===t||Reflect.get(e,t,i)},set:function(e,n,s){if("string"==typeof n&&n.trim()&&!isNaN(Number(n))){var o=s.__isProxy?t._steps[t._stepsProxies.indexOf(s)]:s;t._steps[n]=o;var l=s.__isProxy?s:i(s);t._stepsProxies[n]=l,e[n]=l}else e[n]=s;return r.call(self),!0}})}i.addClass(a,"stepView");var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{steps:{defaultValue:[],type:"WUX.Step[]",category:"Appearance",advancedSetter:!0},activeStep:{defaultValue:0,type:"number",category:"Appearance",advancedSetter:!0},orientation:{defaultValue:"horizontal",type:"WUX.StepperOrientation",category:"Appearance"},detailsFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},_debug:{defaultValue:0,type:"number",category:"Appearance",advancedSetter:!0}}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t),this._stepsViews=[]},t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.classList.add("wux-controls-stepper")},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("steps")&&i._applyForAdvancedSetterProperty(this,"steps",t.steps,this.steps),this.isDirty("activeStep")&&this._applyActiveStep(),this.isDirty("orientation")&&this._applyOrientation(),this.isDirty("detailsFlag")&&this._applyDetailsFlag()},t.prototype._preEditSteps=function(e,t){return e!==t&&{validValue:h.call(this,t)}},t.prototype._applySteps=function(){r.call(this)},t.prototype._applyActiveStep=function(){var e=this;this._stepsViews.forEach((function(t,i){t.activeFlag=i===e.activeStep}))},t.prototype._applyOrientation=function(){this.elements.container.setAttribute("orientation",this.orientation)},t.prototype._applyDetailsFlag=function(){var e=this;this._stepsViews.forEach((function(t){t.detailsFlag=e.detailsFlag}))},t.prototype._apply_debug=function(){var e=this;this.getContent().toggleAttribute("_debug",this._debug),this._stepsViews.forEach((function(t,i){t._debug=e._debug}))},t.prototype.handleEvents=function(){var t=this;e.prototype.handleEvents.call(this),n.addResizeObserverOnElement(this,this,this.elements.container,(function(){var e="horizontal"===t.orientation?t.steps.reduce((function(e,i,n){var s;return e+(null===(s=t._stepsViews[n])||void 0===s?void 0:s._getFullWidth("horizontal"))||0}),Math.max(0,38*(t.steps.length-1))):t._stepsViews.length?Math.max.apply(Math,t._stepsViews.map((function(e){return e._getFullWidth("vertical")}))):0;t.elements.container.toggleAttribute("reduced",e>t.elements.container.clientWidth)}))},t}(s);return i.addClass(u,"stepper"),u}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ProgressBar",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Core/WebUXComponents","DS/CoreBase/WebUXGlobalEnums"],(function(e,t,i,n,s){"use strict";var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:0,type:"number",category:"Behavior",advancedSetter:!0},shape:{defaultValue:"linear",type:"string",category:"Appearance"},emphasize:{defaultValue:"info",type:"string",category:"Appearance"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},statusFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},infiniteFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},height:{defaultValue:void 0,type:"number",category:"Appearance"},gradientAnimationFlag:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName(l)},t.prototype._applyShape=function(e){if(e!==this.shape){switch(this._view&&(this._view.dispose(),this._view=null),this.shape){case"linear":this._view=new h(this);break;case"circular":this._view=new u(this);break;case"spinner":this._view=new c(this)}this.getContent().setAttribute("shape",this.shape)}},t.prototype._applyHeight=function(e){this._view.updateHeight()},t.prototype._applyDisplayStyle=function(e){this._view.updateDisplayStyle(),this.elements.container.setAttribute("displayStyle",this.displayStyle)},t.prototype._applyInfiniteFlag=function(e){this._view.updateInfiniteFlag(),this.infiniteFlag?this.elements.container.setAttributeNode(document.createAttribute("infinite")):this.elements.container.removeAttribute("infinite")},t.prototype._applyEmphasize=function(e){this._view.updateEmphasize(),this.elements.container.setAttribute("emphasize",this.emphasize)},t.prototype._applyStatusFlag=function(e){this._view.updateStatusFlag()},t.prototype._preEditValue=function(e,t){return!isNaN(t)&&"number"==typeof t&&t>=0&&t<=100},t.prototype._applyValue=function(e){this._view.updateValue(),void 0!==this.value?this.elements.container.setAttribute("value",this.value):this.elements.container.removeAttribute("value"),this.value!==e&&this.fire("change")},t.prototype._applyGradientAnimationFlag=function(e){this._view.updateGradientAnimationFlag(),this.gradientAnimationFlag?this.elements.container.setAttributeNode(document.createAttribute("animated-gradient")):this.elements.container.removeAttribute("animated-gradient")},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("shape")&&this._applyShape(),this.isDirty("height")&&this._applyHeight(),this.isDirty("displayStyle")&&this._applyDisplayStyle(),this.isDirty("statusFlag")&&this._applyStatusFlag(),this.isDirty("infiniteFlag")&&this._applyInfiniteFlag(),this.isDirty("emphasize")&&this._applyEmphasize(),this.isDirty("value")&&this._applyValue(),this.isDirty("gradientAnimationFlag")&&this._applyGradientAnimationFlag()},t}(n),l="wux-controls-progressbar",a=l+"-hide-gradient",r=function(){function e(e){this.name="abstract",this._progressBar=e}return e.prototype.dispose=function(){},e.prototype.updateHeight=function(){},e.prototype.updateDisplayStyle=function(){},e.prototype.updateInfiniteFlag=function(){},e.prototype.updateEmphasize=function(){},e.prototype.updateStatusFlag=function(){},e.prototype.updateValue=function(){},e.prototype.updateGradientAnimationFlag=function(){},Object.defineProperty(e.prototype,"visibleStatusState",{get:function(){return this._progressBar.statusFlag&&"lite"!==this._progressBar.displayStyle&&!this._progressBar.infiniteFlag},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"valueToDisplay",{get:function(){var e=this._progressBar.value;if(!(isNaN(e)||"number"!=typeof e||e<0||e>100)){var t=e<1?Math.ceil(e):Math.round(e);return t=100===t&&100!==e?99:t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseClassName",{get:function(){return l+"-"+this.name},enumerable:!1,configurable:!0}),e}(),h=function(e){function t(t){var n=e.call(this,t)||this;return n.name="linear",n._progressBar.getContent().addClassName(n.baseClassName),n._linearBar=new i.Element("div",{class:n.baseClassName+"-bar"}),n._linearBarGradient=new i.Element("div",{class:n.baseClassName+"-bar-gradient"}).inject(n._linearBar),n._linearStatus=null,n.updateDisplayStyle(),n.updateInfiniteFlag(),n.updateEmphasize(),n.updateValue(),n.updateGradientAnimationFlag(),n._linearBar.inject(n._progressBar.getContent(),"top"),n}return __extends(t,e),t.prototype.dispose=function(){this._progressBar.getContent().removeClassName(this.baseClassName),this._progressBar.getContent().removeClassName(this.baseClassName+"-lite"),this._progressBar.getContent().removeClassName(l+"-infinite"),this._progressBar.getContent().removeClassName("wux-ui-state-info"),this._progressBar.getContent().removeClassName("wux-ui-state-success"),this._progressBar.getContent().removeClassName("wux-ui-state-warning"),this._progressBar.getContent().removeClassName("wux-ui-state-high-attention"),this._progressBar.getContent().removeClassName("wux-ui-state-pause"),this._progressBar.getContent().style.removeProperty("--valueAsPercent"),this._progressBar.getContent().style.removeProperty("--valueAsString"),this._linearBar&&(this._linearBar.remove(),this._linearBar.destroy(),this._linearBar=null),this._linearBarGradient&&(this._linearBarGradient.destroy(),this._linearBarGradient=null),this._linearStatus&&(delete this._progressBar.elements.linearStatus,this._linearStatus.remove(),this._linearStatus.destroy(),this._linearStatus=null)},t.prototype.updateDisplayStyle=function(){"lite"===this._progressBar.displayStyle?this._progressBar.elements.container.addClassName(this.baseClassName+"-lite"):this._progressBar.elements.container.removeClassName(this.baseClassName+"-lite"),this.updateStatusFlag()},t.prototype.updateInfiniteFlag=function(){this._progressBar.infiniteFlag?(this._progressBar.elements.container.addClassName(l+"-infinite"),this._linearBar.addClassName(this.baseClassName+"-bar-infinite"),this._linearBarGradient.addClassName(this.baseClassName+"-bar-gradient-infinite")):(this._progressBar.elements.container.removeClassName(l+"-infinite"),this._linearBar.removeClassName(this.baseClassName+"-bar-infinite"),this._linearBarGradient.removeClassName(this.baseClassName+"-bar-gradient-infinite")),this.updateStatusFlag()},t.prototype.updateEmphasize=function(){this._progressBar.elements.container.removeClassName("wux-ui-state-info"),this._progressBar.elements.container.removeClassName("wux-ui-state-success"),this._progressBar.elements.container.removeClassName("wux-ui-state-warning"),this._progressBar.elements.container.removeClassName("wux-ui-state-high-attention"),this._progressBar.elements.container.removeClassName("wux-ui-state-pause"),this._progressBar.elements.container.addClassName("wux-ui-state-"+this._progressBar.emphasize)},t.prototype.updateStatusFlag=function(){var e=this.visibleStatusState;if(e!==this._previousVisibleStatusState)if(this._previousVisibleStatusState=e,e){this._linearStatus||(this._linearStatus=new i.Element("span",{class:this.baseClassName+"-status"}).inject(this._progressBar.getContent()),this._progressBar.elements.linearStatus=this._linearStatus);var t=this.valueToDisplay;void 0!==t&&(this._linearStatus.innerText=t+"%",this._progressBar.getContent().style.setProperty("--valueAsPercent",t+"%"),this._progressBar.getContent().style.setProperty("--valueAsString",'"'+t+'%"'))}else this._linearStatus&&(this._linearStatus.remove(),this._linearStatus.destroy(),this._linearStatus=null),this._progressBar.getContent().style.removeProperty("--valueAsPercent"),this._progressBar.getContent().style.removeProperty("--valueAsString")},t.prototype.updateValue=function(){var e=this.valueToDisplay;void 0!==e&&(this._linearBar.setStyle("width",this._progressBar.value+"%"),100===e?this._linearBarGradient.addClassName(this.baseClassName+"-bar-gradient-at-100-percent"):this._linearBarGradient.removeClassName(this.baseClassName+"-bar-gradient-at-100-percent"),this.visibleStatusState&&(this._linearStatus&&(this._linearStatus.innerText=e+"%"),this._progressBar.getContent().style.setProperty("--valueAsPercent",e+"%"),this._progressBar.getContent().style.setProperty("--valueAsString",'"'+e+'%"')))},t.prototype.updateGradientAnimationFlag=function(){this._progressBar.gradientAnimationFlag?this._linearBarGradient.removeClassName(a):this._linearBarGradient.addClassName(a)},t}(r),u=function(e){function t(t){var n=e.call(this,t)||this;return n.name="circular",n._progressBar.getContent().addClassName(n.baseClassName),n._circularSubcontainer=i.Element("div",{class:n.baseClassName+"-subcontainer"}),n._progressBar.elements.circularSubcontainer=n._circularSubcontainer,n._circularFullFirstHalfBar=new i.Element("div",{class:n.baseClassName+"-full-first-half-bar"}).inject(n._circularSubcontainer),n._circularLastBarSegmentContainer=new i.Element("div",{class:n.baseClassName+"-last-bar-segment-container"}).inject(n._circularSubcontainer),n._circularLastBarSegment=new i.Element("div",{class:n.baseClassName+"-last-bar-segment"}).inject(n._circularLastBarSegmentContainer),n._circularGradientContainer=new i.Element("div",{class:n.baseClassName+"-gradient-container"}).inject(n._circularSubcontainer),n._circularGradient=new i.Element("div",{class:n.baseClassName+"-gradient"}).inject(n._circularGradientContainer),n._circularStatus=null,n.updateHeight(),n.updateInfiniteFlag(),n.updateEmphasize(),n.updateStatusFlag(),n.updateGradientAnimationFlag(),n._circularSubcontainer.inject(n._progressBar.getContent(),"top"),n}return __extends(t,e),t.prototype.dispose=function(){this._progressBar.elements.container.removeClassName(this.baseClassName),this._progressBar.elements.container.removeClassName(l+"-infinite"),this._progressBar.elements.container.removeClassName("wux-ui-state-info"),this._progressBar.elements.container.removeClassName("wux-ui-state-success"),this._progressBar.elements.container.removeClassName("wux-ui-state-warning"),this._progressBar.elements.container.removeClassName("wux-ui-state-high-attention"),this._progressBar.elements.container.removeClassName("wux-ui-state-pause"),this._circularSubcontainer&&(delete this._progressBar.elements.circularSubcontainer,this._circularSubcontainer.remove(),this._circularSubcontainer.destroy(),this._circularSubcontainer=null),this._circularFullFirstHalfBar&&(this._circularFullFirstHalfBar.destroy(),this._circularFullFirstHalfBar=null),this._circularLastBarSegmentContainer&&(this._circularLastBarSegmentContainer.destroy(),this._circularLastBarSegmentContainer=null),this._circularLastBarSegment&&(this._circularLastBarSegment.destroy(),this._circularLastBarSegment=null),this._circularGradientContainer&&(this._circularGradientContainer.destroy(),this._circularGradientContainer=null),this._circularGradient&&(this._circularGradient.destroy(),this._circularGradient=null),this._circularStatus&&(this._circularStatus.remove(),this._circularStatus.destroy(),this._circularStatus=null)},t.prototype.updateHeight=function(){var e=5,i=this.heightToApply;if(i<t._defaultHeight){var n=this._progressBar.touchMode?3/22:3/16;e=Math.ceil(i*n)}this._circularSubcontainer.setStyle("width",i+"px"),this._circularSubcontainer.setStyle("height",i+"px"),this._circularSubcontainer.setStyle("-webkit-mask-size",2*(i-2*e)+"px"),this._circularFullFirstHalfBar.setStyle("width",i+"px"),this._circularFullFirstHalfBar.setStyle("height",i+"px"),this._circularFullFirstHalfBar.setStyle("-webkit-mask-size",2*(i-2*e)+"px"),this._circularLastBarSegmentContainer.setStyle("width",i+"px"),this._circularLastBarSegmentContainer.setStyle("height",i+"px"),this._circularLastBarSegment.setStyle("width",i+"px"),this._circularLastBarSegment.setStyle("height",i+"px"),this._circularLastBarSegment.setStyle("-webkit-mask-size",2*(i-2*e)+"px"),this._circularGradientContainer.setStyle("width",i),this._circularGradientContainer.setStyle("height",i),this._circularGradient.setStyle("width",i),this._circularGradient.setStyle("height",i),this._circularGradient.setStyle("-webkit-mask-size",2*(i-2*e)+"px"),this.visibleStatusState&&this._circularStatus&&(this._circularStatus.setStyle("width",i+"px"),this._circularStatus.setStyle("height",i+"px"),this._circularStatus.setStyle("line-height",i+"px"))},t.prototype.updateInfiniteFlag=function(){this._progressBar.infiniteFlag?(this._progressBar.elements.container.addClassName(l+"-infinite"),this._circularFullFirstHalfBar.addClassName(this.baseClassName+"-full-first-half-bar-infinite"),this._circularLastBarSegmentContainer.addClassName(this.baseClassName+"-last-bar-segment-container-infinite"),this._circularGradientContainer.addClassName(this.baseClassName+"-gradient-container-infinite"),this._circularGradient.addClassName(this.baseClassName+"-gradient-infinite")):(this._progressBar.elements.container.removeClassName(l+"-infinite"),this._circularFullFirstHalfBar.removeClassName(this.baseClassName+"-full-first-half-bar-infinite"),this._circularLastBarSegmentContainer.removeClassName(this.baseClassName+"-last-bar-segment-container-infinite"),this._circularGradientContainer.removeClassName(this.baseClassName+"-gradient-container-infinite"),this._circularGradient.removeClassName(this.baseClassName+"-gradient-infinite")),this.updateValue(),this.updateStatusFlag()},t.prototype.updateEmphasize=function(){this._progressBar.elements.container.removeClassName("wux-ui-state-info"),this._progressBar.elements.container.removeClassName("wux-ui-state-success"),this._progressBar.elements.container.removeClassName("wux-ui-state-warning"),this._progressBar.elements.container.removeClassName("wux-ui-state-high-attention"),this._progressBar.elements.container.removeClassName("wux-ui-state-pause"),this._progressBar.elements.container.addClassName("wux-ui-state-"+this._progressBar.emphasize)},t.prototype.updateStatusFlag=function(){var e=this.visibleStatusState;if(e!==this._previousVisibleStatusState)if(this._previousVisibleStatusState=e,e){this._circularStatus||(this._circularStatus=new i.Element("span",{class:l+"-circular-status"}).inject(this._progressBar.getContent()));var t=this.heightToApply;this._circularStatus.setStyle("width",t+"px"),this._circularStatus.setStyle("height",t+"px"),this._circularStatus.setStyle("line-height",t+"px");var n=this.valueToDisplay;void 0!==n&&(this._circularStatus.innerText=n+"%")}else this._circularStatus&&(this._circularStatus.destroy(),this._circularStatus=null)},t.prototype.updateValue=function(){var e=this.valueToDisplay;if(void 0!==e){var t=360*e/100;this._progressBar.infiniteFlag&&(t=60),t<=180?(this._circularFullFirstHalfBar.addClassName(l+"-circular-full-first-half-bar-less-or-equal-180-deg"),this._circularFullFirstHalfBar.removeClassName(l+"-circular-full-first-half-bar-more-than-180-deg"),this._circularLastBarSegmentContainer.addClassName(l+"-circular-last-bar-segment-container-less-or-equal-180-deg"),this._circularLastBarSegmentContainer.removeClassName(l+"-circular-last-bar-segment-container-more-than-180-deg"),this._circularGradientContainer.addClassName(l+"-circular-gradient-container-less-or-equal-180-deg"),this._circularGradientContainer.removeClassName(l+"-circular-gradient-container-more-than-180-deg")):(this._circularFullFirstHalfBar.removeClassName(l+"-circular-full-first-half-bar-less-or-equal-180-deg"),this._circularFullFirstHalfBar.addClassName(l+"-circular-full-first-half-bar-more-than-180-deg"),this._circularLastBarSegmentContainer.removeClassName(l+"-circular-last-bar-segment-container-less-or-equal-180-deg"),this._circularLastBarSegmentContainer.addClassName(l+"-circular-last-bar-segment-container-more-than-180-deg"),this._circularGradientContainer.removeClassName(l+"-circular-gradient-container-less-or-equal-180-deg"),this._circularGradientContainer.addClassName(l+"-circular-gradient-container-more-than-180-deg")),360===t?this._circularGradientContainer.addClassName(l+"-circular-gradient-container-equals-360-deg"):this._circularGradientContainer.removeClassName(l+"-circular-gradient-container-equals-360-deg"),this._circularLastBarSegment.setStyles({transform:"rotate(".concat(t,"deg)")}),this._circularGradient.setStyles({transform:"rotate(".concat(t,"deg)")}),this.visibleStatusState&&this._circularStatus&&(this._circularStatus.innerText=e+"%")}},t.prototype.updateGradientAnimationFlag=function(){this._progressBar.gradientAnimationFlag?this._circularGradient.removeClassName(a):this._circularGradient.addClassName(a)},Object.defineProperty(t.prototype,"heightToApply",{get:function(){var e=this._progressBar.height;return void 0!==e?e:t._defaultHeight},enumerable:!1,configurable:!0}),t._defaultHeight=60,t}(r),c=function(e){function t(t){var i=e.call(this,t)||this;i.name="spinner";var n=document.createDocumentFragment();return i._spinnerBars=[],["first","second","third","fourth"].forEach((function(e){var t=document.createElement("span");t.classList.add(i.baseClassName+"-bar"),t.setAttributeNode(document.createAttribute(e)),n.appendChild(t),i._spinnerBars.push(t)})),i.updateHeight(),i.updateEmphasize(),i.updateValue(),i._progressBar.getContent().appendChild(n),i}return __extends(t,e),t.prototype.dispose=function(){this._progressBar.getContent().innerHTML="",this._progressBar.getContent().style.removeProperty("--bar-height"),this._spinnerBars=[]},t.prototype.updateHeight=function(){this._progressBar.getContent().style.setProperty("--bar-height",this.heightToApply+"px")},Object.defineProperty(t.prototype,"heightToApply",{get:function(){var e=this._progressBar.height;return void 0!==e?e:t._defaultHeight},enumerable:!1,configurable:!0}),t._defaultHeight=15,t}(r);return s.addClass(o,"progressBar"),o}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,s=0,o=t.length;s<o;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))};define("DS/Controls/Slider",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Utilities/Utils","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter","DS/Utilities/KeyboardUtils","DS/Core/PointerEvents","DS/Core/WebUXComponents","DS/Controls/Popup","DS/Utilities/WUXUWAUtils"],(function(e,t,i,n,s,o,l,a,r,h,u,c){"use strict";var d=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return c.extendingClassFlag||(n.addKeyMapsAndCommands({esc:{keydown:"cancel"}},{cancel:function(){var e=!1;return this.handleEditionCancel?(this.disabled||(this._properties.value.value=this.initialValue,this._updateCursor(),this._updateTooltipText(),this.fire("change"),this._inEdition&&(this._inEdition=!1,this.fire("cancelEdit")),e=!0),{infos:{actionPerformed:e}}):{stopPropagation:!1}}}),n._showPopupOnDisabledTarget=!0),n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{minValue:{defaultValue:0,type:"number",category:"Behavior"},maxValue:{defaultValue:100,type:"number",category:"Behavior"},stepValue:{defaultValue:1,type:"number",category:"Behavior"},value:{defaultValue:0,type:"number",category:"Behavior",advancedSetter:!0,recordFlag:!0},displayStyle:{defaultValue:"horizontal",type:"string",category:"Appearance"},tooltipPosition:{defaultValue:"",type:"string",category:"Appearance"},handleEditionCancel:{defaultValue:!0,type:"boolean",category:"Behavior"},valuePopupFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},sliderButtonStyle:{defaultValue:"standard",type:"string",category:"Appearance"},suffix:{defaultValue:"",type:"string"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype._buildCursorView=function(){var e=i.Element("div",{class:"wux-controls-slider-cursor"}).inject(this.elements.sliderContainer);void 0===this._cursors?this._cursors=[e]:this._cursors.push(e)},t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-slider"),this.elements.container.setAttribute("tabindex",0),this.elements.sliderContainer=i.Element("div",{class:"wux-controls-slider-container"}),this.elements.sliderContainer.inject(this.elements.container),this.elements.sliderBackground=i.Element("div",{class:"wux-controls-slider-bg"}).inject(this.elements.sliderContainer),this.elements.sliderBackgroundFilled=i.Element("div",{class:"wux-controls-slider-bgFilled"}).inject(this.elements.sliderContainer),this._buildCursorView(),this._inEdition=!1},t.prototype._applyDisplayStyle=function(){this.__resolveCssClasses();var e=this._getComputedPosition();this.elements.popup&&(this.elements.popup.position=e)},t.prototype._applySliderButtonStyle=function(){this.__resolveCssClasses()},t.prototype.__resolveCssClasses=function(){this.elements.container.removeClassName("wux-controls-slider-vertical"),this.elements.container.removeClassName("wux-controls-slider-accurate"),"vertical"===this.displayStyle&&this.elements.container.addClassName("wux-controls-slider-vertical"),"accurate"===this.sliderButtonStyle&&this.elements.container.addClassName("wux-controls-slider-accurate"),this._updateCursor()},t.prototype._getComputedPosition=function(){if(this.elements.popup&&this.elements.popup.visibleFlag&&this.elements.popup._latestComputedPosition)return this.elements.popup._latestComputedPosition;var e=this.tooltipPosition;return"vertical"===this.displayStyle?""===e&&(e="right"):""===e&&(e="top"),e},t.prototype._applyTooltipPosition=function(){this.elements.popup&&(this.elements.popup.position=this._getComputedPosition())},t.prototype._applyValuePopupFlag=function(){if(this.valuePopupFlag){if(!this.elements.popup&&this.valuePopupFlag&&!this._popupCreationRemovalFunction){var e=this,t=this._getComputedPosition(),n={arrowBoxFlag:!0,overlap:!1,target:this.elements.container,position:t,constraint:"screen",alignment:"center",trigger:"hover mousePress",positionTarget:this._cursors[0],forceKeepOrientation:!0,getBody:function(){return e.elements.spanTooltip=i.Element("span"),e.elements.spanTooltip.addClassName("wux-slider-span-tooltip"),e.elements.spanTooltip},beforeDisplayCallback:function(){if(!e.getTextFromValue(e._closestHandlerIndex))return{preventDisplay:!0}}};e._popupCreationRemovalFunction=u.delayPopupCreation(n,(function(t){e.elements.popup=t,e._popupCreationRemovalFunction=void 0,e.elements.popup.getContent().addClassName("wux-slider-tooltip"),e._applyDisplayStyle(),o.addEventOnElement(e,e.elements.popup,"show",(function(t){e._closestHandlerIndex=e._findClosestHandlerIndex(t),e._updateTooltipText()}))})).removeListeners}}else this.elements.popup?(this.elements.popup.destroy(),this.elements.popup=void 0):void 0!==this._popupCreationRemovalFunction&&(this._popupCreationRemovalFunction(),this._popupCreationRemovalFunction=void 0)},t.prototype._preEditValue=function(e,t){if(null!=t&&"number"!=typeof t&&"object"!=typeof t)return this._inEdition&&(this._inEdition=!1,this.fire("cancelEdit")),!1;var i=this._getValidatedValue(t);return i!==e&&(i!==t?(this.value=i,!1):void 0)},t.prototype._applyValue=function(e,t){this._updateCursor(),this._updateTooltipText(),this.fire("change")},t.prototype._applyMinValue=function(){this._validateValue(this.value)},t.prototype._applyMaxValue=function(){this._validateValue(this.value)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("value")&&(this._applyValue(t.value,this.value),this.initialValue=this.value),this.isDirty("disabled")&&this._applyDisabled(),this.isDirty("valuePopupFlag")&&this._applyValuePopupFlag(),this.isDirty("displayStyle")?this._applyDisplayStyle():this.isDirty("sliderButtonStyle")&&this.__resolveCssClasses()},t.prototype._applyDisabled=function(){if(e.prototype._applyDisabled.call(this),this.disabled){this.elements.container.removeAttribute("tabindex");for(var t=0,i=this._cursors;t<i.length;t++){i[t].setAttributeNode(document.createAttribute("disabled"))}}else{this.elements.container.setAttribute("tabindex","0");for(var n=0,s=this._cursors;n<s.length;n++){s[n].removeAttribute("disabled")}}},t.prototype._onFocusReceived=function(){this.elements.container.focus()},t.prototype._giveFocus=function(){this.elements.container.focus()},t.prototype.increment=function(e){if(void 0!==this.value){var t;if("number"==typeof this.value)t=this.value;else if("object"==typeof this.value){if(e||(e=0),e<0||e>=this.value.length)return;t=this.value[e]}var i=this._clampInValue(t+this.stepValue,e);if("number"==typeof this.value)this.value=i;else{var n=__spreadArray([],this.value,!0);n[e]=i,this.value=n}}},t.prototype.decrement=function(e){if(void 0!==this.value){var t;if("number"==typeof this.value)t=this.value;else if("object"==typeof this.value){if(e||(e=0),e<0||e>=this.value.length)return;t=this.value[e]}var i=this._clampInValue(t-this.stepValue,e);if("number"==typeof this.value)this.value=i;else{var n=__spreadArray([],this.value,!0);n[e]=i,this.value=n}}},t.prototype._updateCursor=function(){var e;if("number"==typeof this.value||void 0===this.value||null===this.value?e=1:"object"==typeof this.value&&(e=this.value.length),this._cursors.length>e&&(this._cursors=this._cursors.splice(e,this._cursors.length-e)),this._cursors.length<e)for(var t=this._cursors.length,i=t;i<=e-t;i++)this._buildCursorView();var n,s=this.getPercentage(),o=s+"%",l=this.getPercentage(0);"object"==typeof this.value&&void 0!==this.value&&null!==this.value&&(n=this.getPercentage(this.value.length-1)),"horizontal"===this.displayStyle?void 0===n?this.elements.sliderBackgroundFilled.setStyles({top:"",height:"",width:o}):this.elements.sliderBackgroundFilled.setStyles({top:"",height:"",left:l+"%",width:n-l+"%"}):void 0===n?this.elements.sliderBackgroundFilled.setStyles({top:100-s+"%",height:o,width:""}):this.elements.sliderBackgroundFilled.setStyles({top:100-n+"%",height:n-l+"%",left:"",width:""}),this.elements.sliderBackgroundFilled.removeAttribute("minimum-value"),this.elements.sliderBackgroundFilled.removeAttribute("maximum-value"),this.elements.sliderBackgroundFilled.removeAttribute("null-range"),this.elements.sliderBackgroundFilled.removeAttribute("range"),100!==n&&100!==l||this.elements.sliderBackgroundFilled.setAttributeNode(document.createAttribute("maximum-value")),0!==l&&0!==n||this.elements.sliderBackgroundFilled.setAttributeNode(document.createAttribute("minimum-value")),void 0!==n&&l===n||void 0===n&&0===l?this.elements.sliderBackgroundFilled.setAttributeNode(document.createAttribute("null-range")):void 0!==n&&this.elements.sliderBackgroundFilled.setAttributeNode(document.createAttribute("range"));for(i=0;i<this._cursors.length;i++){var a=this._cursors[i];o=(s=this.getPercentage(i))+"%",void 0===this.value||null===this.value?a.addClassName("undefined-class"):a.removeClassName("undefined-class"),"horizontal"===this.displayStyle?a.setStyles({bottom:"",left:o}):a.setStyles({bottom:o,left:""})}},t.prototype._getValidatedSingleValue=function(e,t,i){var n=void 0;if(isNaN(e))n=0;else if(null!=e){var o=e-("number"==typeof t?t:0);n=parseFloat(s.round(o,this.stepValue)),"number"==typeof t&&(n+=t),n=parseFloat(n.toFixed(13)),"number"==typeof i&&n<i&&i-n<this.stepValue&&e>=n+(i-n)/2&&(n=i)}else n=e;var l=n;return null!=n&&s.isNumber(t)&&s.isNumber(i)&&(l=s.clamp(t,i,n)),l},t.prototype._clampInValue=function(e,t){if(null==e)return e;var i=this.value;if(-1===t&&(t=0),"object"==typeof i){var n=0===t?this.minValue:i[t-1],s=t===i.length-1?this.maxValue:i[t+1];return this._getValidatedSingleValue(e,n,s)}return this._getValidatedSingleValue(e,this.minValue,this.maxValue)},t.prototype._getValidatedValue=function(e){if(null==e)return e;if("number"==typeof e)return this._getValidatedSingleValue(e,this.minValue,this.maxValue);if(void 0!==this._currentHandlerIndex){var t=0===this._currentHandlerIndex?this.minValue:e[this._currentHandlerIndex-1],i=this._currentHandlerIndex===e.length-1?this.maxValue:e[this._currentHandlerIndex+1];e[this._currentHandlerIndex]=this._getValidatedSingleValue(e[this._currentHandlerIndex],t,i)}for(var n=0;n<e.length;n++)if(n!==this._currentHandlerIndex){t=0===n?this.minValue:e[n-1],i=n===e.length-1?this.maxValue:e[n+1];e[n]=this._getValidatedSingleValue(e[n],t,i)}return e},t.prototype._validateValue=function(e){var t=this._getValidatedValue(e);void 0!==t&&this.value!==t&&(this.value=t),this._updateCursor()},t.prototype.getTextFromValue=function(e){var t,i=this.value;return"number"==typeof i?t=i:Array.isArray(i)&&i.length&&(t=i[e=s.clamp(0,i.length-1,e||0)]),"number"==typeof t?String(t)+(isNaN(t)?"":this.suffix||""):""},t.prototype._computePercentageFromValue=function(e){var t=(e-this.minValue)/(this.maxValue-this.minValue)*100;return t=(t=t>=0?t:0)<=100?t:100},t.prototype.getPercentage=function(e){var t;return void 0===this.value||null===this.value?0:("number"==typeof this.value?t=this.value:"object"==typeof this.value&&(t=this.value[void 0!==e?e:0]),this._computePercentageFromValue(t))},t.prototype.setPercentage=function(e){this.value=e/100*(this.maxValue-this.minValue)+this.minValue},t.prototype._updateTooltipText=function(){if(this.valuePopupFlag&&this.elements.spanTooltip){var e=this.getTextFromValue(this._closestHandlerIndex);e?(this.elements.spanTooltip.textContent=e,this._updateOffsetTooltipSlider()):this.elements.popup&&this.elements.popup.hide()}},t.prototype._updateOffsetTooltipSlider=function(){if(this.elements.popup){this.elements.popup.positionTarget=this._cursors[this._closestHandlerIndex];var e=this._getOffsetTooltipSlider();e&&(this.elements.popup.offset=e),this.elements.popup._updateView()}},t.prototype._getOffsetTooltipSlider=function(){return"accurate"===this.sliderButtonStyle&&"vertical"===this.displayStyle&&"right"===this._getComputedPosition()?{right:{x:this.touchMode?18:10,y:0}}:"accurate"===this.sliderButtonStyle&&"horizontal"===this.displayStyle&&"bottom"===this._getComputedPosition()?{bottom:{x:0,y:this.touchMode?18:10}}:{left:{x:0,y:0},right:{x:0,y:0},top:{x:0,y:0},bottom:{x:0,y:0}}},t.prototype.handleEvents=function(){var e,t=this,n=0,l=0,h=0,u=t.elements.container;function c(e){if("number"==typeof t.value||void 0===t.value||null===t.value)t.setPropertyFromUIInteraction("value",e);else{var i=__spreadArray([],t.value,!0);i[t._currentHandlerIndex]=e,t.setPropertyFromUIInteraction("value",i)}}function d(i){if(!t.disabled){i.preventDefault(),t._inEdition||(t.fire("beginEdit",{pointerDown:!0}),t._inEdition=!0);var o=void 0;"horizontal"===t.displayStyle?(e=i.clientX-l+n,e=s.clamp(0,h,e),0!==h&&t.maxValue!==t.minValue&&(o=e/h*(t.maxValue-t.minValue)+t.minValue)):(e=i.clientY-l+n,e=s.clamp(0,h,s.round(e,1)),0!==h&&t.maxValue!==t.minValue&&(o=(h-e)/h*(t.maxValue-t.minValue)+t.minValue)),void 0!==o&&c(o=t._clampInValue(o,t._currentHandlerIndex)),t._updateOffsetTooltipSlider()}}function p(e){t._currentHandlerIndex=-1;var i=o.getDocumentOwner(t.getContent());o.removeEventOnElement(t,i,r.POINTERMOVE,d),o.removeEventOnElement(t,i,r.POINTERUP,p),t.disabled||(t.initialValue=t.value,e.preventDefault(),e.stopPropagation(),t._inEdition&&(t._inEdition=!1,t.fire("endEdit"))),e.touchFlag&&(t.valuePopupFlag&&t.elements.popup.hide(),t._resetClosestHandlerIndex())}o.addEventOnElement(this,this.elements.container,r.POINTERMOVE,(function(e){e.originalEvent&&0===e.originalEvent.buttons&&(t._closestHandlerIndex=t._findClosestHandlerIndex(e),t._updateTooltipText())}),!1),o.addEventOnElement(this,u,r.POINTERDOWN,(function(e){if(e.preventDefault(),e.touchFlag&&(t._closestHandlerIndex=t._findClosestHandlerIndex(e)),e.stopPropagation(),!t.disabled){var i=o.getDocumentOwner(t.getContent());o.addEventOnElement(t,i,r.POINTERMOVE,d),o.addEventOnElement(t,i,r.POINTERUP,p),t.initialValue=t.value;var a=t.elements.sliderContainer;if(t._currentHandlerIndex=t._closestHandlerIndex,"horizontal"===t.displayStyle){l=e.clientX,h=a.clientWidth;var m=e.offsetX;if(t.fire("beginEdit",{pointerDown:!0}),t._inEdition=!0,0!==h&&t.maxValue!==t.minValue){n=Math.round(m);var g=(n=s.clamp(0,h,n))/h*(t.maxValue-t.minValue)+t.minValue;c(g=t._clampInValue(g,t._currentHandlerIndex))}}else{l=e.clientY,h=a.clientHeight;m=e.clientY-Math.floor(a.getBoundingClientRect().top);if(t.fire("beginEdit",{pointerDown:!0}),t._inEdition=!0,0!==h&&t.maxValue!==t.minValue){n=Math.round(m),n=s.clamp(0,h,n);g=(h-n)/h*(t.maxValue-t.minValue)+t.minValue;c(g=t._clampInValue(g,t._currentHandlerIndex))}}u.focus(),t.valuePopupFlag&&t.elements.popup&&t._updateOffsetTooltipSlider()}})),o.addEventOnElement(this,u,"mousewheel",(function(e){var n=o.getDocumentOwner(t.getContent());if(!t.disabled&&(t.elements.container===n.activeElement||t.getContent().hasAttribute("focused"))){e.preventDefault(),e.stopPropagation();var s=i.Event.wheelDelta(e);t.fire("beginEdit"),t._inEdition=!0,s>0?t.callMethodFromUIInteraction("increment",t._closestHandlerIndex):t.callMethodFromUIInteraction("decrement",t._closestHandlerIndex),t._inEdition&&(t._inEdition=!1,t.fire("endEdit"))}})),o.addEventOnElement(this,u,"keyup",(function(e){!t.disabled&&t.keyDown&&(a.decrease(e.keyCode)||a.increase(e.keyCode))&&(e.preventDefault(),e.stopPropagation(),t.keyDown=!1,(e.keyCode!==a.ESCAPE||e.keyCode===a.ESCAPE&&!0===e.actionPerformed)&&t._inEdition&&(t._inEdition=!1,t.fire("endEdit")))})),o.addEventOnElement(this,u,"keydown",(function(e){(!t.disabled&&a.decrease(e.keyCode)||a.increase(e.keyCode))&&(t.keyDown||(t.keyDown=!0,t.fire("beginEdit"),t._inEdition=!0),a.decrease(e.keyCode)?t.callMethodFromUIInteraction("decrement"):t.callMethodFromUIInteraction("increment"),e.preventDefault(),e.stopPropagation())}))},t.prototype._resetClosestHandlerIndex=function(){var e=this;void 0!==e._closestHandlerIndex&&-1!==e._closestHandlerIndex&&(e._cursors[e._closestHandlerIndex]&&e._cursors[e._closestHandlerIndex].removeClassName("wux-closest-cursor"),e._closestHandlerIndex=-1)},t.prototype._computeValueFromCursorPosition=function(e){var t=this;return null==e?Array.isArray(t.value)?t.value[0]:t.value:t.maxValue===t.minValue?t.maxValue:"horizontal"===t.displayStyle?0===t.elements.sliderContainer.clientWidth?0:s.clamp(0,t.elements.sliderContainer.clientWidth,Math.round(e))/t.elements.sliderContainer.clientWidth*(t.maxValue-t.minValue)+t.minValue:0===t.elements.sliderContainer.clientHeight?0:s.clamp(0,t.elements.sliderContainer.clientHeight,Math.round(t.elements.sliderContainer.clientHeight-e))/t.elements.sliderContainer.clientHeight*(t.maxValue-t.minValue)+t.minValue},t.prototype._findClosestHandlerIndex=function(e){for(var t=this,i=t._findClosestHandlerIndexFromValue(t._computeValueFromCursorPosition("horizontal"===t.displayStyle?e.offsetX:e.offsetY)),n=0;n<t._cursors.length;n++){var s=t._cursors[n];n===i?s.addClassName("wux-closest-cursor"):s.removeClassName("wux-closest-cursor")}return i},t.prototype._findClosestHandlerIndexFromValue=function(e){for(var t=this,i=t._computePercentageFromValue(e),n=100,s=-1,o=0;o<t._cursors.length;o++){var l=t.getPercentage(o),a=Math.abs(l-i);(a===n&&(i>l||0===l)||a<n)&&(n=a,s=o)}return s},t}(n);return h.addClass(d,"slider"),d.prototype.markForRecordFlag=!0,l.register(d,"DS/ControlsRec/AbstractRec"),d.prototype.blackBoxFlag=!0,d}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ColoredSlider",["require","exports","UWA/Core","DS/Utilities/Color","DS/Controls/Slider","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils"],(function(e,t,i,n,s,o,l){"use strict";var a=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return l.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{minValue:{defaultValue:0,type:"number",category:"Behavior"},maxValue:{defaultValue:255,type:"number",category:"Behavior"},stepValue:{defaultValue:1,type:"number",category:"Behavior"},colorFrom:{defaultValue:"#000",type:"string",category:"Appearance"},colorTo:{defaultValue:"#fff",type:"string",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-controls-colorslider"),this.elements.sliderBackgroundFilled.remove(),this.elements.sliderTransparentBackground=i.Element("div",{class:"wux-controls-slider-transparent-background"}).inject(this.elements.sliderContainer,"top"),this.elements.sliderCursorColoredBackground=i.Element("div",{class:"wux-controls-slider-cursor-colored-background"}).inject(this._cursors[0])},t.prototype.handleEvents=function(){e.prototype.handleEvents.call(this)},t.prototype._applyColorFrom=function(){this._updateBackground(),this._updateCursor()},t.prototype._applyColorTo=function(){this._updateBackground(),this._updateCursor()},t.prototype.__resolveCssClasses=function(){e.prototype.__resolveCssClasses.call(this),this._updateBackground()},t.prototype._updateCursor=function(){e.prototype._updateCursor.call(this);var t=this.getPercentage()/100,i=this.colorFrom,s=this.colorTo;"transparent"===i&&(i="#fff",this.elements.sliderCursorColoredBackground.setStyle("opacity",t)),"transparent"===s&&(s="#fff",this.elements.sliderCursorColoredBackground.setStyle("opacity",1-t));for(var o=n.lerpColorHex(i,s,t),l=0,a=this._cursors;l<a.length;l++){a[l].setStyle("background-position-x",200*t+"px, 0px")}this.elements.sliderCursorColoredBackground.setStyle("background-color","#"+o)},t.prototype._updateBackground=function(){this.colorFrom=r(this.colorFrom),this.colorTo=r(this.colorTo);var e="linear-gradient(";e+=("horizontal"===this.displayStyle?"to right":"to top")+", "+this.colorFrom+", "+this.colorTo+")",this.elements.sliderBackground.setStyle("background",e)},t}(s);function r(e){return"transparent"===e?e:"string"!=typeof e?"#000":("#"===e.charAt(0)&&(e=e.substr(1)),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),6===e.length?"#"+e:"#000")}return o.addClass(a,"coloredSlider"),a}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function l(e){try{r(n.next(e))}catch(e){o(e)}}function a(e){try{r(n.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,a)}r((n=n.apply(e,t||[])).next())}))},__generator=this&&this.__generator||function(e,t){var i,n,s,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=a(0),l.throw=a(1),l.return=a(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(a){return function(r){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;l&&(l=0,a[0]&&(o=0)),o;)try{if(i=1,n&&(s=2&a[0]?n.return:a[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,a[1])).done)return s;switch(n=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){o.label=a[1];break}if(6===a[0]&&o.label<s[1]){o.label=s[1],s=a;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(a);break}s[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{i=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,r])}}};define("DS/Controls/Loader",["require","exports","UWA/Core","UWA/Fx","DS/Controls/Abstract","DS/Controls/ProgressBar","DS/Controls/Button","DS/Core/WebUXComponents","DS/CoreEvents/ModelEvents","DS/Utilities/Dom","DS/Utilities/Utils","i18n!DS/Controls/assets/nls/translation","DS/CoreBase/WebUXGlobalEnums"],(function(e,t,i,n,s,o,l,a,r,h,u,c){"use strict";var d="wux-controls-loader",p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.__underDefaultHeightUseAltValueDisplay=!1,t._showFx=null,t._hideFx=null,t._loaderCounter=0,t._loaderMessages=[],t._inlinedValue=void 0,t}return __extends(t,e),t.prototype.process=function(){this._fadeIn()},t.prototype.on=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return this._loaderCounter++,this._loaderMessages.push(e),e&&(this.text=e),this._loaderMessages.length!==this._loaderCounter&&console.warn("[WebUX][Loader] Invalid state, wrong amount of messages stored."),1!==this._loaderCounter?[3,2]:[4,this._fadeIn()];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.off=function(e){return __awaiter(this,void 0,void 0,(function(){var t,i;return __generator(this,(function(n){switch(n.label){case 0:return this._loaderCounter<=0||-1===(t=this._loaderMessages.lastIndexOf(e))?[2]:(this._loaderCounter--,this._loaderMessages.splice(t,1),this._loaderMessages.length!==this._loaderCounter&&console.warn("[WebUX][Loader] Invalid state, wrong amount of messages stored."),i=void 0,i=this._loaderMessages.length>0?this._loaderMessages[this._loaderMessages.length-1]:"",0!==this._loaderCounter?[3,2]:[4,this._fadeOut()]);case 1:n.sent(),n.label=2;case 2:return void 0!==i&&(this.text=i),[2]}}))}))},t.prototype.update=function(e){var t=void 0;e&&(t="string"==typeof e?+(e=e.replace("%","")):e),this._inlinedValue=t,t?(this.elements.progressBar.infiniteFlag=!1,this.elements.progressBar.value=t):(this.elements.progressBar.infiniteFlag=!0,this.elements.progressBar.value=this.elements.progressBar.publishedProperties.value.defaultValue),this._applyText()},Object.defineProperty(t,"publishedProperties",{get:function(){return{shape:{defaultValue:"circular",type:"string",category:"Appearance",advancedSetter:!0},fadeDuration:{defaultValue:1e3,type:"number",category:"Appearance"},text:{defaultValue:"",type:"string",category:"Appearance"},showButtonFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},height:{defaultValue:void 0,type:"number",category:"Appearance"},allowUnsafeHTMLText:{defaultValue:void 0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){var t=this;e.prototype.buildView.call(this),this._modelEvents=new r,this._showFx=null,this._hideFx=null,this.elements.container.addClassName(d+" wux-font-3dsregular"),this.elements.progressBar=new o({shape:"circular",infiniteFlag:!0,statusFlag:!1}).inject(this.elements.container),this.elements.label=i.Element("span",{class:d+"-label"}).inject(this.elements.container),this.elements.stopButton=new l({label:c.get("cancel"),emphasize:"primary"}).inject(this.elements.container),h.addEventOnElement(this,this.elements.stopButton,"buttonclick",(function(){t._fadeOut()})),this.hide()},t.prototype.destroy=function(){this._showFx&&(this._showFx.stop(),this._showFx=null),this._hideFx&&(this._hideFx.stop(),this._hideFx=null),e.prototype.destroy.call(this)},t.prototype._preEditShape=function(e,t){return"circular"===t||"spinner"===t},t.prototype._applyShape=function(e){this.elements.progressBar.shape=this.shape,this._applyText()},t.prototype._applyText=function(e){var t=this.text;this._shouldDisplayInlinedValue()?(this.elements.progressBar.statusFlag=!1,""===t?t=this._inlinedValue+"%":t+=" ("+this._inlinedValue+"%)"):this.elements.progressBar.statusFlag=void 0!==this._inlinedValue,u.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLText)?this.elements.label.setContent(t):this.elements.label.textContent=t},t.prototype._applyAllowUnsafeHTMLText=function(e){this._applyText(this.text)},t.prototype._applyShowButtonFlag=function(e){this.showButtonFlag?this.elements.stopButton.show():this.elements.stopButton.hide()},t.prototype._applyHeight=function(e){this.elements.progressBar.height=this.height,this._applyText(),e!==this.height&&this.fire("dimensionsChanged")},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("shape")&&a._applyForAdvancedSetterProperty(this,"shape",t?t.shape:void 0,this.shape),(this.isDirty("allowUnsafeHTMLText")||this.isDirty("text"))&&this._applyText(t.text),this.isDirty("height")&&this._applyHeight(t.height),this._applyShowButtonFlag()},t.prototype._fadeIn=function(){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(t){return this.show(),[2,new Promise((function(t){var i=e;e._hideFx&&(e._hideFx.stop(),e._hideFx=null),e._showFx=new n(e.elements.container,{duration:e.fadeDuration,transition:"linear",events:{onStart:function(){i.showButtonFlag&&i.elements.stopButton.inject(i.elements.container)},onComplete:function(){e._showFx=null,i._modelEvents.publish({event:"START",context:i}),i.fire("show"),t(void 0)}}}),e._showFx.start({opacity:[0,1]})}))]}))}))},t.prototype._fadeOut=function(){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(t){return[2,new Promise((function(t){var i=e;e._showFx&&(e._showFx.stop(),e._showFx=null),e._hideFx=new n(e.elements.container,{duration:e.fadeDuration,transition:"linear",events:{onStart:function(){},onComplete:function(){e._hideFx=null,i.showButtonFlag&&i.elements.stopButton.remove(),i.hide(),i._modelEvents.publish({event:"END",context:i}),i.fire("hide"),t(void 0)}}}),e._hideFx.start({opacity:[1,0]}),e._loaderCounter=0,e._loaderMessages=[]}))]}))}))},t.prototype._shouldDisplayInlinedValue=function(){return void 0!==this._inlinedValue&&("spinner"===this.shape||this.__underDefaultHeightUseAltValueDisplay&&this.height<60)},t}(s);return a.addClass(p,"loader"),p}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Find",["require","exports","UWA/Core","DS/Utilities/Utils","DS/Controls/Abstract","DS/Controls/LineEditor","DS/Controls/Toggle","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Controls/Loader","i18n!DS/Controls/assets/nls/translation","DS/Core/WebUXComponents"],(function(e,t,i,n,s,o,l,a,r,h,u,c){"use strict";var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{findStr:{defaultValue:"",type:"string",category:"Appearance"},count:{defaultValue:void 0,type:"number"},matchCase:{defaultValue:!1,type:"boolean"},displayMatchCaseToggle:{defaultValue:!1,type:"boolean"},displayNavigationButtons:{defaultValue:!0,type:"boolean"},displayClose:{defaultValue:!0,type:"boolean"},relatedWidget:{defaultValue:void 0,type:"object"},onFindRequest:{defaultValue:void 0,type:"function"},onFindPreviousResult:{defaultValue:void 0,type:"function"},onFindNextResult:{defaultValue:void 0,type:"function"},onFindClose:{defaultValue:void 0,type:"function"},placeholder:{defaultValue:"",type:"string",category:"Appearance"},closeOnEscape:{defaultValue:!0,type:"boolean",noNeedToApplyFlag:!0,category:"Behavior"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){var e=this;this.elements.container.addClassName("wux-controls-find"),this.elements.findContainer=new i.Element("div",{class:"wux-controls-find-container"}).inject(this.elements.container),this.elements.findEditor=new o({selectAllOnFocus:!0,sizeInCharNumber:22,displayStyle:"lite"}).inject(this.elements.findContainer),this.elements.findEditor.getContent().addClassName("wux-controls-find-editor"),r.addEventOnElement(this,this.elements.findEditor.getContent(),"keydown",(function(t){var n=i.Event.whichKey(t);"return"===n?(e.elements.findEditor.valueToCommit===e.findStr&&(e._debounceLaunched?e._launchFindOnRelatedWidget(void 0):e._goToNextFindResult()),t.stopPropagation()):"shift+return"===n?(e.elements.findEditor.valueToCommit===e.findStr&&e._goToPreviousFindResult(),t.stopPropagation()):"esc"===n&&e.closeOnEscape&&(e.elements.findEditor.valueToCommit===e.findStr&&e.close(),t.stopPropagation())})),this.elements.findCounter=new i.Element("span",{class:"wux-controls-find-counter"}).inject(this.elements.findContainer),this._displayCurrentValue()},t.prototype._launchFindOnRelatedWidget=function(e,t){var i=this;this.findStr=this.elements.findEditor.valueToCommit;var s=function(t){(i._debounceLaunched||t)&&(i._debounceLaunched=!1,i.onFindRequest&&i.relatedWidget&&i.onFindRequest.call(i.relatedWidget,i.findStr,i.matchCase,e))};this._debouncedLaunchFind||(this._debouncedLaunchFind=n.debounce(s,500)),t?(this._debounceLaunched=!0,this._debouncedLaunchFind()):s.call(this,!0)},t.prototype._applyProperties=function(t){this.isDirty("displayNavigationButtons")&&this._applyDisplayNavigationButtons(t.displayNavigationButtons),e.prototype._applyProperties.call(this,t),this.isDirty("findStr")&&this._applyFindStr(t.findStr),this.isDirty("count")&&this._applyCount(t.count),this.isDirty("matchCase")&&this._applyCount(t.matchCase),this.isDirty("displayMatchCaseToggle")&&this._applyDisplayMatchCaseToggle(t.displayMatchCaseToggle),this.isDirty("displayClose")&&this._applyDisplayClose(t.displayClose),this.isDirty("relatedWidget")&&this._applyRelatedWidget(),this.isDirty("placeholder")&&this._applyPlaceholder()},t.prototype._applyFindStr=function(e){(e||this.findStr)&&this.findStr!==e&&(this.elements.findEditor.valueToCommit!==this.findStr&&(this.elements.findEditor.value=this.findStr),this._launchFindOnRelatedWidget(void 0,!0))},t.prototype._applyCount=function(e){this.count>0?this.currentValue=1:this.currentValue=0,this._displayCurrentValue()},t.prototype._applyMatchCase=function(e){this.matchCase!==e&&(this.count=0,this._launchFindOnRelatedWidget(),this.elements.matchCaseToggle&&(this.elements.matchCaseToggle.checkFlag=this.matchCase))},t.prototype._applyDisplayMatchCaseToggle=function(e){var t=this;this.displayMatchCaseToggle?this.elements.matchCaseContainer?this.elements.matchCaseContainer.style.display="":(this.elements.matchCaseContainer=new i.Element("div",{class:"wux-controls-find-matchcase-container"}).inject(this.elements.findContainer,"after"),this.elements.matchCaseToggle=new l({label:u.get("matchCase"),checkFlag:this.matchCase}).inject(this.elements.matchCaseContainer),this.elements.matchCaseToggle.getContent().addClassName("wux-controls-find-matchcase-toggle"),r.addEventOnElement(this,this.elements.matchCaseToggle,"change",(function(e){t.matchCase=t.elements.matchCaseToggle.checkFlag}))):this.elements.matchCaseContainer&&(this.elements.matchCaseContainer.style.display="none")},t.prototype._applyDisplayNavigationButtons=function(e){if(this.displayNavigationButtons){if(!this.elements.previousResult){var t=this;this.elements.separator=new i.Element("div",{class:"wux-controls-find-separator",html:"|"}).inject(this.elements.findCounter,"after"),this.elements.previousResult=new i.Element("div",{class:"wux-controls-find-previous"}).inject(this.elements.separator,"after"),r.generateIcon("chevron-up",{target:this.elements.previousResult}),this.elements.nextResult=new i.Element("div",{class:"wux-controls-find-next"}).inject(this.elements.previousResult,"after"),r.generateIcon("chevron-down",{target:this.elements.nextResult}),r.addEventOnElement(this,this.elements.previousResult,a.POINTERHIT,(function(e){t.disabled||(t._goToPreviousFindResult(),e.stopPropagation())})),r.addEventOnElement(this,this.elements.nextResult,a.POINTERHIT,(function(e){t.disabled||(t._goToNextFindResult(),e.stopPropagation())}))}this.elements.container.setAttribute("display-navigation-buttons","")}else this.elements.container.removeAttribute("display-navigation-buttons")},t.prototype._applyDisplayClose=function(e){var t=this;this.displayClose?this.elements.closeFind?this.elements.closeFind.style.display="":(this.elements.closeFind=new i.Element("div",{class:"wux-controls-find-close"}).inject(this.elements.findContainer),r.generateIcon("close",{target:this.elements.closeFind}),r.addEventOnElement(this,this.elements.closeFind,a.POINTERHIT,(function(e){t.close(),e.stopPropagation()}))):this.elements.closeFind&&(this.elements.closeFind.style.display="none")},t.prototype._applyRelatedWidget=function(){this.relatedWidget&&(this.relatedWidget.findWidget=this)},t.prototype._applyVisibleFlag=function(t){e.prototype._applyVisibleFlag.call(this,t),this.visibleFlag&&this._launchFindOnRelatedWidget(this.currentValue)},t.prototype._applyPlaceholder=function(){this.elements.findEditor&&(this.elements.findEditor.placeholder=this.placeholder)},t.prototype._applyDisabled=function(e){this.elements.findEditor.disabled=this.disabled,this._updatePreviousAndNextDisabledState()},t.prototype._displayCurrentValue=function(){this.elements.findCounter&&(this.elements.findCounter.innerText=this.findStr&&""!==this.findStr&&void 0!==this.currentValue&&void 0!==this.count?this.currentValue+"/"+this.count:""),this._updatePreviousAndNextDisabledState()},t.prototype._updatePreviousAndNextDisabledState=function(){var e=!(this.count>1&&!this.disabled);this.elements.previousResult&&this.elements.nextResult&&(this.elements.previousResult.disabled=e,this.elements.nextResult.disabled=e,e?(this.elements.previousResult.setAttributeNode(document.createAttribute("disabled")),this.elements.nextResult.setAttributeNode(document.createAttribute("disabled"))):(this.elements.previousResult.removeAttribute("disabled"),this.elements.nextResult.removeAttribute("disabled")))},t.prototype._goToPreviousFindResult=function(){var e=this,t=e.currentValue;e.count&&0!==e.count&&(e.currentValue>1?e.currentValue--:e.currentValue=e.count,e._displayCurrentValue()),e.currentValue&&t!==e.currentValue&&e.onFindPreviousResult&&e.relatedWidget&&e.onFindPreviousResult.call(e.relatedWidget)},t.prototype._goToNextFindResult=function(){var e=this,t=e.currentValue;e.count&&0!==e.count&&(e.currentValue<e.count?e.currentValue++:e.currentValue=1,e._displayCurrentValue()),e.currentValue&&t!==e.currentValue&&e.onFindNextResult&&e.relatedWidget&&e.onFindNextResult.call(e.relatedWidget)},t.prototype.handleEvents=function(){var e=this;r.addEventOnElement(this,this.elements.findEditor,"uncommittedChange",(function(t){e.findStr=e.elements.findEditor.valueToCommit})),r.addEventOnElement(this,this.elements.findContainer,a.POINTERHIT,(function(t){e._giveFocus()}))},t.prototype.setCurrentValue=function(e){this.currentValue=e,this._displayCurrentValue()},t.prototype.close=function(){this.visibleFlag=!1,this.onFindClose&&this.relatedWidget&&this.onFindClose.call(this.relatedWidget)},t.prototype.destroy=function(){this.relatedWidget&&(this.relatedWidget.findWidget=null,this.relatedWidget=null),e.prototype.destroy.call(this)},t.prototype.setLoadingState=function(e){this.elements.findLoader||(this.elements.findLoader=new h({height:20,infiniteFlag:!0,visibleFlag:!1}).inject(this.elements.findEditor.getContent(),"after"),this.elements.findLoader.getContent().addClassName("wux-controls-find-loader")),this.elements.findLoader.visibleFlag=e},t.prototype._getElementToFocus=function(){return this.elements.findEditor.elements.inputField},t}(s);return c.addClass(d,"find"),d})),define("DS/Controls/ModalLoader",["require","exports","DS/Controls/ModalContainer","DS/Controls/Loader","DS/Utilities/Dom","i18n!DS/Controls/assets/nls/translation"],(function(e,t,i,n,s,o){"use strict";return function(){function e(){}return e.displayModalLoader=function(e,t,l){e&&(e._loaderDisplayed||(e._loaderDisplayed=new n),0===e._loaderDisplayed._loaderCounter&&i.createModal(e,e._loaderDisplayed.elements.container),t||(t=o.loading),e._loaderDisplayed.on(t),l&&(1===e._loaderDisplayed._loaderCounter?s.onNodeRendered(e._loaderDisplayed.elements.container,l):l()))},e.removeModalLoader=function(e,t){e._loaderDisplayed&&(t||(t=o.loading),e._loaderDisplayed.off(t),e._loaderDisplayed._loaderCounter<=0&&(i.removeModal(e),e._loaderDisplayed=void 0))},e}()})),define("DS/Controls/TreeNode",["UWA/Core","UWA/Event","DS/Core/Core","DS/Controls/TreeNodeBase","DS/CoreEvents/Events"],(function(e,t,i,n,s){"use strict";var o=n.extend({defaultOptions:{pathElement:null},init:function(e){this._parent(e),this._isHighlighted=!1},getPathElement:function(){return this.options.pathElement}});return e.namespace("WUX/Controls/TreeNode",o)}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/GradientSlider",["require","exports","UWA/Core","DS/Core/PointerEvents","DS/Core/WebUXComponents","DS/Utilities/Color","DS/Controls/Slider","DS/Utilities/WUXUWAUtils"],(function(e,t,i,n,s,o,l,a){"use strict";var r=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return a.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{gradientType:{defaultValue:"Hue",type:"string"},modulationColor:{defaultValue:void 0,type:"array"}}},enumerable:!1,configurable:!0}),t.prototype._getOffsetTooltipSlider=function(){return"accurate"===this.sliderButtonStyle&&"vertical"===this.displayStyle&&"right"===this._getComputedPosition()?{right:{x:this.touchMode?18:14,y:0}}:"accurate"===this.sliderButtonStyle&&"horizontal"===this.displayStyle&&"bottom"===this._getComputedPosition()?{bottom:{x:0,y:this.touchMode?18:14}}:{left:{x:0,y:0},right:{x:0,y:0},top:{x:0,y:0},bottom:{x:0,y:0}}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("gradientType")&&this._applyGradientType(),this.isDirty("modulationColor")&&this._applyModulationColor()},t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t)},t.prototype.setColorSubAttribute=function(e,t){this.gradientType===e&&(this.value=t)},t.prototype._applyValue=function(e,t){this._applyingValue=!0,this._updateCursor(),this._updateTooltipText(),this.fire("change",{colorSubAttributeType:this.gradientType}),this._applyingValue=!1},t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-controls-gradientslider"),this.elements.sliderBackgroundFilled.remove(),this.elements.canvasHuePicker=new i.Element("canvas",{class:"wux-controls-gradientslider-canvasHue"}),this.elements.canvasHuePicker.setStyle("height","100%"),this.elements.canvasHuePicker.setStyle("width","100%"),this.elements.canvasHuePicker.inject(this.elements.sliderBackground)},t.prototype._applyGradientType=function(){var e,t,i,n;void 0!==this.modulationColor&&(e=o.hsvToRgb(this.modulationColor),t=this.modulationColor,i=o.hsvToHsl(this.modulationColor)),"Hue"===this.gradientType?(this.maxValue=360,n=361,t&&(this.value=t[0])):"Saturation"===this.gradientType?(this.maxValue=100,n=101,t&&(this.value=t[1])):"HslSaturation"===this.gradientType?(this.maxValue=100,n=101,t&&(this.value=i[1])):"Value"===this.gradientType?(this.maxValue=100,n=101,t&&(this.value=t[2])):"Lightness"===this.gradientType?(this.maxValue=100,n=101,t&&(this.value=i[2])):"Red"===this.gradientType?(this.maxValue=255,n=256,t&&(this.value=e.r)):"Green"===this.gradientType?(this.maxValue=255,n=256,t&&(this.value=e.g)):"Blue"===this.gradientType?(this.maxValue=255,n=256,t&&(this.value=e.b)):"Alpha"===this.gradientType&&(this.maxValue=255,n=256,t&&(this.value=this.modulationColor[3])),this.elements.canvasHuePicker.width="vertical"===this.displayStyle?1:n,this.elements.canvasHuePicker.height="horizontal"===this.displayStyle?1:n,this.updateCanvas()},t.prototype._updateCursor=function(){e.prototype._updateCursor.call(this);for(var t=0,i=this._cursors;t<i.length;t++){var n=i[t],s=this._computeModulationColor();this._applyingValue&&!this.isDirty("modulationColor")&&(this.modulationColor=s);var l=o.hsvToRgb(s);l.a=255,n.setStyle("background-color",o.colorToCssColor(l))}},t.prototype._computeModulationColor=function(){var e,t=this.value;if(t="Alpha"===this.gradientType?void 0===this.value?255:t:void 0===this.value?0:t,"Hue"===this.gradientType)e=[t,(e=void 0!==this.modulationColor?this.modulationColor.slice():[0,100,100])[1],e[2]];else if("Saturation"===this.gradientType)e=[(e=void 0!==this.modulationColor?this.modulationColor.slice():[0,100,100])[0],t,e[2]];else if("Value"===this.gradientType)e=[(e=void 0!==this.modulationColor?this.modulationColor.slice():[0,100,100])[0],e[1],t];else if("HslSaturation"===this.gradientType){e=void 0!==this.modulationColor?this.modulationColor.slice():[0,100,100],(i=o.hsvToHsl(e))[1]=t,e=o.hslToHsv(i)}else if("Lightness"===this.gradientType){var i;e=void 0!==this.modulationColor?this.modulationColor.slice():[0,0,100],100!==(i=o.hsvToHsl(e))[2]&&100===this.value?this._hslSaturationBackup=i[1]:this._applyingValue&&!this.isDirty("modulationColor")&&100===i[2]&&100!==this.value?i[1]=this._hslSaturationBackup:0!==i[2]&&0===this.value?this._hslSaturationBackup=i[1]:this._applyingValue&&!this.isDirty("modulationColor")&&0===i[2]&&0!==this.value&&(i[1]=this._hslSaturationBackup),i[2]=t,e=o.hslToHsv(i)}else if("Red"===this.gradientType){e=void 0!==this.modulationColor?this.modulationColor.slice():[0,100,100],(n=o.hsvToRgb(e)).r=t,e=o.rgbToHsv(n.r,n.g,n.b,n.a)}else if("Green"===this.gradientType){e=void 0!==this.modulationColor?this.modulationColor.slice():[120,100,100],(n=o.hsvToRgb(e)).g=t,e=o.rgbToHsv(n.r,n.g,n.b,n.a)}else if("Blue"===this.gradientType){var n;e=void 0!==this.modulationColor?this.modulationColor.slice():[240,100,100],(n=o.hsvToRgb(e)).b=t,e=o.rgbToHsv(n.r,n.g,n.b,n.a)}else"Alpha"===this.gradientType&&((e=void 0!==this.modulationColor?this.modulationColor.slice():[0,0,100,255])[3]=t);return e},t.prototype._applyModulationColor=function(){this._applyingValue||this._updateCursor(),this.updateCanvas()},t.prototype.handleEvents=function(){e.prototype.handleEvents.call(this),this.elements.container.addEvent(n.POINTERDOWN,(function(e){e.stopPropagation()})),this.elements.container.addEvent(n.POINTERMOVE,(function(e){e.preventDefault()}))},t.prototype.updateCanvas=function(){this.elements.canvasHuePicker.removeClassName("wux-controls-slider-alpha");var e=this.elements.canvasHuePicker.getContext("2d"),t=e.createLinearGradient(0,0,"vertical"===this.displayStyle?0:this.elements.canvasHuePicker.width,"vertical"===this.displayStyle?this.elements.canvasHuePicker.height:0),i="vertical"===this.displayStyle?1:0,n="vertical"===this.displayStyle?0:1;if("Hue"===this.gradientType)for(var s=!this.modulationColor||isNaN(this.modulationColor[0])||isNaN(this.modulationColor[1])||isNaN(this.modulationColor[2])?[0,100,100]:this.modulationColor,l=0;l<37;l++){var a,r=l/36;a="vertical"===this.displayStyle?[360*(1-r),s[1],s[2]]:[360*r,s[1],s[2]];var h=o.hsvToRgb(a),u=o.colorToCssColor(h);t.addColorStop(r,u)}else if("Red"===this.gradientType||"Green"===this.gradientType||"Blue"===this.gradientType){var c={r:(p=!this.modulationColor||isNaN(this.modulationColor[0])||isNaN(this.modulationColor[1])||isNaN(this.modulationColor[2])?{r:0,g:0,b:0}:o.hsvToRgb(this.modulationColor)).r,g:p.g,b:p.b},d={r:p.r,g:p.g,b:p.b};"Red"===this.gradientType?(c.r=0,d.r=255):"Green"===this.gradientType?(c.g=0,d.g=255):"Blue"===this.gradientType&&(c.b=0,d.b=255),t.addColorStop(i,o.colorToCssColor(c)),t.addColorStop(n,o.colorToCssColor(d))}else if("Alpha"===this.gradientType){c={r:255,g:255,b:255,a:0},d={r:255,g:255,b:255,a:0};t.addColorStop(i,o.colorToCssColor(c)),t.addColorStop(n,o.colorToCssColor(d)),this.elements.canvasHuePicker.addClassName("wux-controls-slider-alpha");var p=this.modulationColor?[this.modulationColor[0],this.modulationColor[1],this.modulationColor[2],255]:[0,0,100,255],m="horizontal"===this.displayStyle?"to right":"to top";this.elements.canvasHuePicker.setStyle("background-image","linear-gradient("+m+", transparent 0%, "+o.colorToCssColor(o.hsvToRgb(p))+" 100%)")}else{var g=!this.modulationColor||isNaN(this.modulationColor[0])||isNaN(this.modulationColor[1])||isNaN(this.modulationColor[2])?[0,100,100]:this.modulationColor;if("Saturation"===this.gradientType){var f=o.hsvToRgb([g[0],100,g[2]]),v=o.hsvToRgb([g[0],0,g[2]]);t.addColorStop(n,o.colorToCssColor(f)),t.addColorStop(i,o.colorToCssColor(v))}else if("HslSaturation"===this.gradientType){var y=o.hsvToHsl([g[0],g[1],g[2]]);f=o.hslToRgb([y[0],100,y[2]]),v=o.hslToRgb([y[0],0,y[2]]);t.addColorStop(n,o.colorToCssColor(f)),t.addColorStop(i,o.colorToCssColor(v))}else if("Value"===this.gradientType){var _=o.hsvToRgb([g[0],g[1],100]),b=o.hsvToRgb([g[0],g[1],0]);t.addColorStop(n,o.colorToCssColor(_)),t.addColorStop(i,o.colorToCssColor(b))}else if("Lightness"===this.gradientType){g=!this.modulationColor||isNaN(this.modulationColor[0])||isNaN(this.modulationColor[1])||isNaN(this.modulationColor[2])?[0,0,100]:this.modulationColor;y=o.hsvToHsl(g),_=void 0;_=0!==this.value&&100!==this.value||void 0===this._hslSaturationBackup?o.hslToRgb([y[0],y[1],50]):o.hslToRgb([y[0],this._hslSaturationBackup,50]),t.addColorStop(n,"white"),t.addColorStop(.5,o.colorToCssColor(_)),t.addColorStop(i,"black")}}e.fillStyle=t,e.fillRect(0,0,this.elements.canvasHuePicker.width,this.elements.canvasHuePicker.height)},t.prototype._getMousePos=function(e,t){var i=e.getBoundingClientRect();return{x:t.clientX-i.left,y:t.clientY-i.top}},t}(l);return s.addClass(r,"gradientSlider"),r}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/TabBar",["require","exports","UWA/Core","DS/Core/PointerEvents","DS/Core/WebUXComponents","DS/CoreEvents/ModelEvents","DS/Utilities/Dom","DS/Utilities/Utils","DS/Utilities/WUXUWAUtils","DS/Controls/Abstract","DS/Controls/ButtonGroup","DS/Controls/LineEditor","DS/Controls/Button","DS/Controls/Toggle","./ComboBox","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Menu/Menu","DS/CoreBase/WebUXGlobalEnums","i18n!DS/Controls/assets/nls/translation.json"],(function(e,t,i,n,s,o,l,a,r,h,u,c,d,p,m,g,f,v,y,_){"use strict";var b="selectTab",C="pinTab",w="unpinTab",x="editTab",E="removeTab",S="endDragTab",D="beginDragTab",A="changeLabelTab",F="newTab",P="endEditTab",I="preNewTab",V="contextualMenu";function T(e,t){e.__slideMargin!==t&&(e.__slideMargin=t,e._buttonGroup.getContent().setStyle("margin-left",t?t+"px":""))}function B(e,t,i,n){if(e&&this._requestedProperties){var s=e.value;n&&t&&this._editedButton&&this._editedButton===e||(this._requestedProperties[s]&&!1===this._requestedProperties[s].showTitleFlag?e.showLabelFlag=!1:e.showLabelFlag=t,e.label&&!i&&(t?e.elements.text.scrollWidth<=e.elements.text.offsetWidth&&(e.tooltipInfos.shortHelp=void 0):e.tooltipInfos={shortHelp:e.label,allowUnsafeHTMLShortHelp:!0}))}}function O(e){var t=this._hasButtonAChevron(e),n=this._hasButtonADirectClose(e);if(t||n){if(-1!==this.displayStyle.indexOf("strip"))this._setSideButton(e);else if(-1===this.displayStyle.indexOf("bullet")&&!e.elements._sideButton||e.elements._sideButton&&e.getContent().lastChild!==e.elements._sideButton){e.elements._sideButton=new i.Element("button",{type:"button",class:"wux-controls-tabBar-close wux-ui-3ds wux-ui-3ds-close"}),e.elements._sideButton.tooltipInfos={shortHelp:_.close};var s=e.getContent().lastChild,o=s?s.nextSibling:null;e.getContent().insertBefore(e.elements._sideButton,o),e.elements._sideButton.value="close"}e.checkFlag&&M.call(this,e)}else N.call(this,e)}function M(e){e&&e.elements&&e.elements._sideButton&&(e.elements._sideButton.show(),e.elements._sideButton.removeClassName("button-close-unvisible"),e.getContent().addClassName("remove-padding-class"))}function N(e){e&&e.elements&&e.elements._sideButton&&(e.elements._sideButton.hide(),e.elements._sideButton.addClassName("button-close-unvisible"),e.getContent().removeClassName("remove-padding-class"))}function L(e,t){var i=!1;return void 0!==e&&e.forEach((function(e){e.title===t&&(i=!0)})),i}Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};var k=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return r.extendingClassFlag||(n._slide=0,n._pinnedListIsBeingUpdated=!1,n.modelEvent=new o,n._history=new g,n._cptSelection=0,n._historySelection=[],n._buttonGroup.multiSelFlag=n.multiSelFlag,n._togglesTab={},n.addKeyMapsAndCommands({esc:{keydown:"cancel"}},{cancel:function(e){var t=!1;return!this.disabled&&a.isInput(e.target)&&(this._endEditTab(!0),t=!0),{infos:{actionPerformed:t},stopPropagation:t}}})),n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{newTabButtonFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},pinFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},editableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},centeredFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},closeButtonFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},closeAllButtonFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},minWidth:{defaultValue:-1,type:"number",category:"Appearance"},slideStep:{defaultValue:200,type:"number",category:"Behavior"},pinnedList:{defaultValue:void 0,type:"array",category:"Behavior",advancedSetter:!0},displayStyle:{defaultValue:"normal",type:"array",category:"Appearance"},value:{defaultValue:void 0,type:"array",category:"Behavior"},multiSelFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},reorderFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},showComboBoxFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},autoCloseFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},autoNewTabFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},allowUnsafeHTMLOnTabButton:{defaultValue:void 0,type:"boolean",category:"Behavior"},position:{defaultValue:"top",type:"string",category:"Appearance"},tabButtonDirection:{defaultValue:"horizontal",type:"string",category:"Appearance"},showButtonLabelFlag:{defaultValue:void 0,type:"boolean",category:"Appearance"},responsiveFlag:{defaultValue:!0,type:"boolean",category:"Appearance"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_getVerticalDisplayWidth:{defaultValue:function(){var e;return(null===(e=this.elements)||void 0===e?void 0:e.container)?this.elements.container.getBoundingClientRect().width:0},type:"function",category:"Appearance"},_onContainerResized:{defaultValue:function(){this._onResizeFun&&this._onResizeFun.call(this)},type:"function",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-tabBar"),this.elements.buttonsContainer=new i.createElement("div",{class:"wux-controls-tabBar-buttonsContainer"}).inject(this.elements.container),this.elements.tabBar=new i.createElement("div",{class:"wux-controls-tabBar-tabs"}).inject(this.elements.container),this.elements.containerAddandNextButton=new i.Element("div",{class:"wux-controls-tabBar-buttonsContainer-addandnext"}).inject(this.elements.buttonsContainer),this.elements.buttonGroupContainer=new i.Element("div",{class:"wux-controls-tabBar-tabs-container"}).inject(this.elements.tabBar),this._buttonGroup=new u({allowResetToUndefinedByUIFlag:!1}),this.buttonGroup=this._buttonGroup,this._buttonGroup.inject(this.elements.buttonGroupContainer),this._buttonGroup.getContent().setAttribute("role","presentation"),this._applyCenteredFlag(),this._newTabButton=new d({icon:"plus",value:"NewTab",allowUnsafeHTMLOnTabButton:this.allowUnsafeHTMLOnTabButton}),this._newTabButton.tooltipInfos={shortHelp:_.addNewItem,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton},-1!==this.displayStyle.indexOf("vertical")?this._newTabButton.getContent().inject(this.elements.buttonsContainer):this._newTabButton.inject(this.elements.tabBar),this._newTabButton.getContent().addClassName("wux-controls-tabBar-tabs-container-buttonNewTab"),this.newTabButtonFlag||this._newTabButton.getContent().hide()},t.prototype._handleEvents=function(){var e=this,t=this,s=!1,o=function(e){var i;i=e.dsModel instanceof d?e.dsModel:e.parentNode.dsModel,t._draggedOverButton!==i&&(t._draggedOverButton&&t._timeoutToActivateTabToken&&(clearTimeout(t._timeoutToActivateTabToken),t._timeoutToActivateTabToken=void 0),t._draggedOverButton=i,t._timeoutToActivateTabToken=setTimeout((function(){t.value=[t._draggedOverButton.value]}),400))};l.addEventOnElement(this,this._buttonGroup.getContent(),"dragenter",(function(e){console.log("dragenter"),o(e.target)})),l.addEventOnElement(this,this._buttonGroup.getContent(),"dragover",(function(e){console.log("dragover"),o(e.target)})),l.addEventOnElement(this,this._buttonGroup.getContent(),"dragleave",(function(e){console.log("dragleave"),clearTimeout(t._timeoutToActivateTabToken),t._timeoutToActivateTabToken=void 0,t._draggedOverButton=void 0})),l.addEventOnElement(this,this._buttonGroup.getContent(),"click",(function(e){var i=e.target;if(i.classList.contains("wux-controls-tabBar-close")){var n=l.firstParentWithClass(i,"wux-controls-button").dsModel;t._hasButtonAChevron(n)?t._onChevronButtonClicked(n):t._hasButtonADirectClose(n)&&t._closeListener(n)}})),this._onResizeFun=function(){!0===t._onNodeRenderedCalled&&(t._onNodeRenderedCalled=void 0,t._threshold||(t._threshold={}),t._updateThresholds()),t._slideToAvoidBlankSpace(),t.redrawTabBar()},l.addResizeListener(this.elements.container,this._onResizeFun,0),l.onNodeRendered(this.elements.container,(function(){void 0!==e.elements.container&&-1!==e.displayStyle.indexOf("strip")&&(e.multiSelFlag&&e._applyMultiSelFlag(),t._threshold||(t._threshold={}),e._applyTouchMode(),e._onNodeRenderedCalled=!0)})),l.addEventOnElement(this,this._newTabButton,"click",(function(){j.call(t)})),l.addEventOnElement(this,this._buttonGroup,n.POINTERDOWN,(function(e){if(s=!1,t.closeButtonFlag&&a.isMouseEvent(e)&&1===e.button){var i=e.target.parentNode;s=!!i.dsModel}return e.target&&"close"===e.target.value&&(s=!0),s})),l.addEventOnElement(this,this._buttonGroup,n.POINTERUP,(function(e){if(s){s=!1;var i=void 0,n=void 0;if(!(i=e.target.dsModel instanceof d?e.target.dsModel:e.target.parentNode.dsModel))return;if(i&&(n=i.value),void 0!==n)if(!t.getButtonFromValue(n).elements._sideButton)return;t._closeListener(i),t._computeButtonsAndTogglesCSS(),t.redrawTabBar()}}));this._buttonGroup.addEventListener("change",(function(e){if(e.dsModel===t._buttonGroup){if(t._preventButtonGroupListener)return;if(e.stopPropagation(),t.disabled)return;t._endEditTab();var i=t.getButtonFromValue(e.dsModel.value);Array.isArray(i)||(i=[i]),t.setPropertyFromUIInteraction("value",t._buttonGroup.value);for(var n=0;n<i.length;n++){var s=i[n],o=s._index;if(-1!==o)if(s.checkFlag&&(void 0!==t._cptSelection&&(t._cptSelection++,t._setHistoryFromButton(s,t._cptSelection)),t.modelEvent.publish({event:b,data:{index:o,tabBar:t}})),-1!==t.displayStyle.indexOf("bullet")){var l=R(t._buttonGroup._getButtonList(),s);l&&(s.value!=t.value||s.checkFlag||(s.checkFlag=!0),l.checkFlag=s.checkFlag,l.show()),t._updateView(),T(t,0),this.showComboBoxFlag||(t._showPreviousButton&&(t._showPreviousButton.disabled=!0),t._showNextButton&&(t._showNextButton.disabled=!1))}else if(-1!==t.displayStyle.indexOf("normal")){var a=U(t._togglesTab,s);a&&(a.checkFlag=s.checkFlag),t._updateView()}else if(-1!==t.displayStyle.indexOf("panel")){var r=t.getIndexesByValues(t.value);r=r.sort();for(var h=0;h<r.length;h++){var u=t.getValueByIndex(r[h]);if(void 0!==u){var c=t.getButtonFromValue(u);(void 0!==c&&!Array.isArray(c)||Array.isArray(c)&&c.length>0)&&0===h&&c.getContent().setStyles({"border-bottom":"1px solid #f1f1f1"})}}var d=t._buttonGroup._getButtonList();for(h=0;h<d.length;h++){var p=d[h];p.checkFlag||p.getContent().setStyles({"border-bottom":"1px solid #b4b6ba"})}}}t.closeButtonFlag?t._updateThresholds():t.redrawTabBar()}})),l.addEventOnElement(this,this._buttonGroup,"buttonclick",(function(e){var i=e.target;if(e.stopPropagation(),i){for(;i&&!(i.dsModel instanceof d||i.dsModel instanceof p)&&a.isObject(i)&&i.parentElement;)i=i.parentElement;t.fire("tabButtonClick",{value:t.getValueByIndex(t._buttonGroup.getButtonIndex(i.dsModel))})}})),l.addEventOnElement(this,this._buttonGroup,"buttonDblClick",(function(e){e.stopPropagation()})),l.addEventOnElement(this,this._buttonGroup,n.POINTERHIT,(function(e){if(e.preventDefault(),2===e.multipleHitCount&&!t.disabled){for(var i=e.target;i&&(!i.dsModel||!(i.dsModel instanceof d));)i=i.getParent();if(i){var n=t.getButtonFromValue(i.dsModel.value);n instanceof p&&(n=R(t._buttonGroup._getButtonList(),n)),t.editableFlag?t._editTab(n.value):t.pinFlag&&t._pinTab(n.value)}}})),l.addEventOnElement(this,this.elements.container,"focusout",(function(t){a.isInput(t.target)&&e._lineEditorOfButton&&null===e._lineEditorOfButton.getContent().getAttributeNode("focused")&&e._endEditTab()})),l.addEventOnElement(this,this._buttonGroup.getContent(),"mousewheel",(function(e){t._hasOverflow()&&t._buttonGroup.getContent().hasAttribute("focused")&&(i.Event.wheelDelta(e)>0?t._slideTabBar("right"):t._slideTabBar("left"),e.stopPropagation(),e.preventDefault())}))},t.prototype._onDragPointerDown=function(e){if(!this.disabled){var t=this;if(e.dsModel){var i=this.getButtonFromValue(e.dsModel.value);i&&(this._valueSource=i.value)}var s=this.getOwnerDocument();l.addEventOnElement(this,s,n.POINTERMOVE,o),l.addEventOnElement(this,s,n.POINTERUP,(function e(i){void 0!==t._valueSource&&t._onDragPointerUp(i),l.removeEventOnElement(t,s,n.POINTERMOVE,o),l.removeEventOnElement(t,s,n.POINTERUP,e)})),this.modelEvent.publish({event:D,data:{}})}function o(e){e.target.parentNode&&e.target.parentNode.dsModel===t._buttonGroup&&void 0!==t._valueSource&&t._onDragPointerMove(e)}},t.prototype._onDragPointerMove=function(e){if(!this.disabled&&0===e.button){e.preventDefault();var t=void 0,i=e.target;i&&i.dsModel?t=i.dsModel:i.dsModel||i.parentElement&&(t=i.parentElement.dsModel),t&&t.value!==this._valueSource&&this.callMethodFromUIInteraction("_exchangeTabs",this._valueSource,t.value)}},t.prototype._onDragPointerUp=function(e){void 0!==this._valueTarget&&(this._valueSource=void 0,this._valueTarget=void 0,this.redrawTabBar(),this.fire("endReorder"))},t.prototype._exchangeTabs=function(e,t){this.value=[e];var i=this.getButtonFromValue(t),n=this.getButtonFromValue(e);if(i&&n&&void 0!==n.value&&void 0!==i.value&&n.value!==i.value){this._valueTarget=i.value;var s=i._index,o=n._index;this._buttonGroup.moveButton(o,s),i._index=o,n._index=s,this.modelEvent.publish({event:S,data:{valueButtonDragged:e,valueButtonTarget:t,valueTab:this.value}}),this._changeButtonIndexInComboBox(n,n._index),this._changeButtonIndexInComboBox(i,i._index),this._computeButtonsAndTogglesCSS(),this._updateThresholds([i,n]),this.fire("beginReorder",{value:n.value})}},t.prototype._applyShowComboBoxFlag=function(){var e=this;this.showComboBoxFlag?(this._tabComboBox=new m({elementsTree:this._history,mainElementVisibleFlag:!1,enableSearchFlag:!1,multiSelFlag:this.multiSelFlag,showToggleColumnForMultiSelFlag:!1,displayStyle:-1!==this.displayStyle.indexOf("strip")?"lite":"normal"}).inject(this.elements.buttonsContainer,"before"),this._tabComboBox._updatePopupHeight=function(){if(e._tabComboBox.elements.treeListViewContainer){var t=e._tabComboBox.nbDisplayedElements,i=(e._tabComboBox._getCurrentTouchMode()?38:22)*t+(e.newTabButtonFlag?33:0)+"px";if(e._tabComboBox.elements.treeListViewContainer.style.height!==i){var n=e._tabComboBox._isPopupOpened();e._tabComboBox.elements.popup.visibleFlag=!1,e._tabComboBox.elements.treeListViewContainer.style.height=i,e._tabComboBox.elements.popup.visibleFlag=n,e._tabComboBox.elements.treeListView&&e._tabComboBox.elements.treeListView.updateHeight(i)}}},this._tabComboBox.tooltipInfos={shortHelp:_.listAllItems,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton},this._tabComboBox.getContent().addClassName("wux-controls-tabBar-combobox"),this._tabComboBox.addEventListener("change",this._comboCB.bind(this)),this._updateComboBox(),this._showPreviousButton&&(this._showPreviousButton.destroy(),this._showPreviousButton=null),this._showNextButton&&(this._showNextButton.destroy(),this._showNextButton=null)):(this._tabComboBox&&(this._tabComboBox.removeEventListener("change",this._comboCB.bind(this)),this._tabComboBox.getContent().hide(),this._tabComboBox.destroy(),this._tabComboBox=null),this._createButtonsNextAndPrevious()),-1!==this.displayStyle.indexOf("panel")&&this._tabComboBox&&this._tabComboBox.getContent().addClassName("wux-controls-tabbar-panel"),this.redrawTabBar()},t.prototype._applyCenteredFlag=function(){this.centeredFlag?(this.elements.buttonGroupContainer.addClassName("wux-controls-tabBar-centered"),this.elements.tabBar.addClassName("wux-controls-tabBar-centered"),this.elements.container.addClassName("wux-controls-tabBar-centered")):(this.elements.buttonGroupContainer.removeClassName("wux-controls-tabBar-centered"),this.elements.tabBar.removeClassName("wux-controls-tabBar-centered"),this.elements.container.removeClassName("wux-controls-tabBar-centered"))},t.prototype._applyReorderFlag=function(){var e=this;function t(t){e._onDragPointerDown(t)}this.reorderFlag?l.addEventOnElement(this,this.elements.container,n.POINTERDOWN,t):l.removeEventOnElement(this,this.elements.container,n.POINTERDOWN,t)},t.prototype._applyMultiSelFlag=function(){for(var e in this._buttonGroup.multiSelFlag=this.multiSelFlag,this._togglesTab)this._togglesTab.hasOwnProperty(e)&&(this._togglesTab[e].multiSelFlag=this.multiSelFlag);if(!this.multiSelFlag&&this.value&&this.value.length>0){var t=this._getMaxHistory();this.value=void 0!==t?[t]:[]}else this._buttonGroup._applyValue();this._tabComboBox&&this.multiSelFlag&&(this._tabComboBox.multiSelFlag=this.multiSelFlag)},t.prototype._preEditPinnedList=function(e,t){if(!this._pinnedListIsBeingUpdated){this._pinnedListIsBeingUpdated=!0,this.pinnedList||(this.pinnedList=[]),void 0===e&&(e=[]);for(var i=X.call(this,t,e),n=X.call(this,e,t),s=0;s<i.length;s++)this.pinTab(i[s]);for(var o=0;o<n.length;o++)this.pinTab(n[o]);this._pinnedListIsBeingUpdated=!1}return!0},t.prototype._applyPinFlag=function(e){this.pinFlag||(this.pinnedList=[])},t.prototype._applyPosition=function(){"dockingStyle"===this.displayStyle&&(this.getContent().removeClassName("wux-controls-tabbar-top"),this.getContent().removeClassName("wux-controls-tabbar-right"),this.getContent().removeClassName("wux-controls-tabbar-bottom"),this.getContent().removeClassName("wux-controls-tabbar-left"),this.getContent().addClassName("wux-controls-tabbar-"+this.position))},t.prototype._hasToHideLabel=function(){return void 0===this.showButtonLabelFlag?-1!==this.displayStyle.indexOf("vertical"):!this.showButtonLabelFlag},t.prototype._applyTabButtonDirection=function(){if("vertical"===this.tabButtonDirection&&(-1===this.displayStyle.indexOf("vertical")||-1===this.displayStyle.indexOf("strip")))return console.warn("WebUX TabBar component - tabButtonDirection vertical is supported only for displayStyle mode 'strip' & 'vertical' !"),void(this.tabButtonDirection="horizontal");if("vertical"===this.tabButtonDirection?(this.elements.container.setAttributeNode(document.createAttribute("lite-borders")),this.elements.tabBar.setAttributeNode(document.createAttribute("lite-borders"))):(this.elements.container.removeAttribute("lite-borders"),this.elements.tabBar.removeAttribute("lite-borders")),this._buttonGroup){for(var e=this._buttonGroup._getButtonList(),t=0;t<e.length;t++){var i=e[t];i&&("vertical"===this.tabButtonDirection&&i.icon&&!this._hasToHideLabel()?i.displayStyle="lite-borders":i.displayStyle="normal")}e.length&&this._updateThresholds()}},t.prototype._applyShowButtonLabelFlag=function(){this._hasOverflow()},t.prototype._applyResponsiveFlag=function(){if(this._buttonGroup&&!this._hasToHideLabel()){var e=void 0,t=this._buttonGroup._getButtonList();for(e=0;e<t.length;e++){var i=t[e];B.call(this,i,!0,Boolean(this._requestedProperties[i.value].tooltipInfos),this._isButtonInEdition)}}this._hasOverflow()},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this._slide=0,this.isDirty("centeredFlag")&&this._applyCenteredFlag(),this.isDirty("showComboBoxFlag")&&this._applyShowComboBoxFlag(),this.isDirty("reorderFlag")&&this._applyReorderFlag(),this.isDirty("position")&&this._applyPosition(),this.isDirty("tabButtonDirection")&&this._applyTabButtonDirection(),this.isDirty("showButtonLabelFlag")&&this._applyShowButtonLabelFlag(),this.isDirty("responsiveFlag")&&this._applyResponsiveFlag()},t.prototype._applyCloseButtonFlag=function(){for(var e=0;e<this._buttonGroup.getButtonCount();e++){var t=this._getButtonByIndex(e);t&&O.call(this,t)}this.showComboBoxFlag&&this._updateComboBox()},t.prototype._applyCloseAllButtonFlag=function(){for(var e=0;e<this._buttonGroup.getButtonCount();e++){var t=this._getButtonByIndex(e);t&&O.call(this,t)}this.showComboBoxFlag&&this._updateComboBox()},t.prototype._applyDisabled=function(){this._buttonGroup.disabled=this.disabled,this.showComboBoxFlag&&-1===this.displayStyle.indexOf("strip")?this._tabComboBox&&(this._tabComboBox.disabled=this.disabled):(this._showPreviousButton&&(this._showPreviousButton.disabled=this.disabled),this._showNextButton&&(this._showNextButton.disabled=this.disabled)),this._newTabButton&&(this._newTabButton.disabled=this.disabled)},t.prototype._applyNewTabButtonFlag=function(){-1!==this.displayStyle.indexOf("strip")&&this.showComboBoxFlag&&this._addNewButtonInComboBox(),this.newTabButtonFlag?this._tabComboBox&&this._tabComboBox.visibleFlag?this._newTabButton.getContent().hide():(this._newTabButton.getContent().show(),this._newTabButton.getContent().style.marginLeft=-1!==this.displayStyle.indexOf("strip")?"0px":-this._buttonGroup.getContent().offsetLeft+"px"):this._newTabButton.getContent().hide()},t.prototype._applyTouchMode=function(e){var t=this._getCurrentTouchMode();!0===t?(this.elements.container.setAttributeNode(document.createAttribute("touch-mode")),this.elements.tabBar.setAttributeNode(document.createAttribute("touch-mode")),this.elements.buttonGroupContainer.setAttributeNode(document.createAttribute("touch-mode"))):(this.elements.container.removeAttribute("touch-mode"),this.elements.tabBar.removeAttribute("touch-mode"),this.elements.buttonGroupContainer.removeAttribute("touch-mode")),this._buttonGroup.touchMode=t,this._tabComboBox&&(this._tabComboBox.touchMode=t),this._showNextButton&&(this._showNextButton.touchMode=t),this._newTabButton&&(this._newTabButton.touchMode=t),this._showPreviousButton&&(this._showPreviousButton.touchMode=t),this._updateThresholds()},t.prototype._applyMinWidth=function(){-1!==this.minWidth?this.elements.container.setStyles({width:this.minWidth+"px"}):this.elements.container.setStyles({width:""}),T(this,0),this.showComboBoxFlag||(this._showPreviousButton.disabled=!0,this._showNextButton.disabled=!1),this.redrawTabBar()},t.prototype._closeListener=function(e){if(this.modelEvent.publish({event:E,data:{index:e._index,value:e.value,tabBar:this}}),this.fire("removeTab",{index:e._index,value:e.value,tabBar:this}),this.autoCloseFlag){this.pinFlag&&this.pinnedList&&this.pinnedList.length>0&&-1!==this.pinnedList.indexOf(e.value)&&this._removePinnedButton(e.value),this.showComboBoxFlag&&this._removeValueComboBox(e.value),this.removeTab(e.value),e.remove(),this._removeHistoryFromButton(e.value);for(var t=this._buttonGroup._getButtonList(),i=t.length-1;i>=0;i--){var n=t[i];n instanceof p&&n.checkFlag&&n.remove()}var s=this._getMaxHistory();void 0!==s?this.setPropertyFromUIInteraction("value",[s]):this.setPropertyFromUIInteraction("value",[])}},t.prototype._isButtonClosable=function(e){return!0===this.closeButtonFlag&&!1!==this._allowClosableFlags[e.value]||!0===this.closeAllButtonFlag},t.prototype._updateView=function(){for(var e=this._buttonGroup._getButtonList(),t=0;t<e.length;t++){if(e[t]instanceof d){var i=void 0;(i=-1!==this.displayStyle.indexOf("bullet")?U(this._buttonGroup._getButtonList(),e[t]):U(this._togglesTab,e[t]))&&-1!==this.displayStyle.indexOf("bullet")&&(e[t].visibleFlag=i.checkFlag,i.checkFlag=e[t].checkFlag)}else if(e[t]instanceof p&&(e[t].show(),this._buttonGroup.value.length<=0&&e[0]&&(e[0].checkFlag=!0),e[t])){var n=R(e,e[t]);n&&n instanceof d&&(n.visibleFlag=e[t].checkFlag,n.checkFlag=e[t].checkFlag)}this.pinnedList&&-1!==this.pinnedList.indexOf(e[t].value)&&e[t].show()}if(-1!==this.displayStyle.indexOf("normal"))for(var s=0;s<e.length;s++)e[s].show();this.redrawTabBar()},t.prototype._applyDisplayStyle=function(e){var t=this.value?this.value.slice():[];if(-1!==this.displayStyle.indexOf("bullet")){if(this.touchMode&&(this.touchMode=!1),Array.isArray(this.displayStyle)){var i=this.displayStyle.indexOf("vertical");-1!==i&&this.displayStyle.splice(i,1)}"vertical"===this.tabButtonDirection&&(this.tabButtonDirection="horizontal"),this.closeButtonFlag&&(this.closeButtonFlag=!1),this.closeAllButtonFlag&&(this.closeAllButtonFlag=!1)}for(var n=this._buttonGroup._getButtonList(),s=0;s<n.length;s++){var o=n[s].getContent();-1!==this.displayStyle.indexOf("normal")&&(o.removeClassName("wux-controls-toggle-selectbutton"),o.removeClassName("wux-controls-toggle-pinnedbutton"))}for(var l in this._togglesTab)-1!==this.displayStyle.indexOf("normal")?this._buttonGroup.removeChild(this._togglesTab[l]):-1!==this.displayStyle.indexOf("bullet")&&this._buttonGroup.addChild(this._togglesTab[l]);if(-1===this.displayStyle.indexOf("wide")?this.getContent().removeClassName("wux-controls-tabbar-display-wide"):this.getContent().addClassName("wux-controls-tabbar-display-wide"),-1!==this.displayStyle.indexOf("vertical")){this.elements.buttonsContainer.addClassName("wux-controls-tabbar-vertical"),this.elements.tabBar.addClassName("wux-controls-tabbar-vertical"),this.elements.buttonGroupContainer.addClassName("wux-controls-tabbar-vertical");var a=this._buttonGroup._getButtonList();for(s=0;s<a.length;s++){(o=a[s].getContent()).addClassName("wux-controls-tabbar-vertical")}this._addTooltips(),this.showComboBoxFlag&&(this._tabComboBox.remove(),this._tabComboBox.inject(this.elements.container)),this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-panel"),this.elements.tabBar.addClassName("wux-controls-tabbar-panel"),this._buttonGroup.getContent().removeClassName("wux-controls-tabbar-panel"),this.elements.tabBar.removeClassName("wux-controls-tabbar-panel"),-1!==this.displayStyle.indexOf("strip")?this.elements.container.addClassName("wux-controls-tabbar-vertical"):this.elements.container.removeClassName("wux-controls-tabbar-vertical")}else if(-1!==this.displayStyle.indexOf("panel")){var r=this._buttonGroup._getButtonList();for(s=0;s<r.length;s++){(o=r[s].getContent()).addClassName("wux-controls-tabbar-panel")}this._buttonGroup.getContent().addClassName("wux-controls-tabbar-panel"),this.elements.buttonGroupContainer.addClassName("wux-controls-tabbar-panel"),this.elements.tabBar.addClassName("wux-controls-tabbar-panel")}else{this.elements.buttonsContainer.removeClassName("wux-controls-tabbar-vertical"),this.elements.tabBar.removeClassName("wux-controls-tabbar-vertical"),this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-vertical");var h=this._buttonGroup._getButtonList();for(s=0;s<h.length;s++){o=h[s].getContent();h[s].tooltipInfos=this._requestedProperties&&this._requestedProperties[h[s].value]&&this._requestedProperties[h[s].value].tooltipInfos?this._requestedProperties[h[s].value].tooltipInfos:void 0,o.removeClassName("wux-controls-tabbar-vertical"),o.removeClassName("wux-controls-tabbar-panel")}this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-panel"),this._buttonGroup.getContent().removeClassName("wux-controls-tabbar-panel"),this.elements.tabBar.removeClassName("wux-controls-tabbar-panel"),this._tabComboBox&&this.showComboBoxFlag&&(this._tabComboBox.remove(),this._tabComboBox.inject(this.elements.tabBar,"before"))}-1!==this.displayStyle.indexOf("strip")?(this.pinFlag=!1,z.call(this),this._addTooltips()):!e||-1===e.indexOf("strip")&&"strip"!==e||G.call(this),-1!==this.displayStyle.indexOf("dockingStyle")?this.getContent().addClassName("wux-controls-tabbar-dockingStyle"):this.getContent().removeClassName("wux-controls-tabbar-dockingStyle"),this._updateView(),T(this,0),this._tabComboBox&&(-1!==this.displayStyle.indexOf("panel")?this._tabComboBox.getContent().addClassName("wux-controls-tabbar-panel"):this._tabComboBox.getContent().removeClassName("wux-controls-tabbar-panel")),this.value=t,this._hasOverflow()},t.prototype._addPinnedButton=function(e){this.pinnedList||this.setPropertyFromUIInteraction("pinnedList",[]),-1===this.pinnedList.indexOf(e)&&this.modifyArrayFromUIInteraction("pinnedList",Array.prototype.push,e);var t=this.getButtonFromValue(e);-1!==this.displayStyle.indexOf("bullet")&&t.show(),t.getContent().setAttributeNode(document.createAttribute("pinned"));var i=U(this._togglesTab,t);i&&i.getContent().setAttributeNode(document.createAttribute("pinned"))},t.prototype._removePinnedButton=function(e){var t=this.getButtonFromValue(e);t&&t.getContent().getAttributeNode("pinned")?t.getContent().removeAttributeNode(t.getContent().getAttributeNode("pinned")):console.log("Ohoh ... This tab should have been pinned ...");var i=U(this._togglesTab,t);i&&i.getContent().removeAttributeNode(i.getContent().getAttributeNode("pinned"));for(var n=0;n<this.pinnedList.length;n++)this.pinnedList[n]===e&&this.modifyArrayFromUIInteraction("pinnedList",Array.prototype.splice,n,1)},t.prototype._getMaxHistory=function(){var e,t=0;if(!(this._historySelection[0]&&this.getButtonFromValue(this._historySelection[0].value)&&this.getButtonFromValue(this._historySelection[0].value).visibleFlag))for(var i=0;i<this._buttonGroup.getButtonCount();i++){var n=this.getValueByIndex(i);void 0!==n&&this.getButtonFromValue(n).visibleFlag&&(e=this.getValueByIndex(i))}for(var s in this._historySelection){var o=this.getButtonFromValue(this._historySelection[s].value);void 0!==this._historySelection[s].cpt&&t<=this._historySelection[s].cpt&&o&&o.visibleFlag&&(e=this._historySelection[s].value,t=this._historySelection[s].cpt)}return e},t.prototype._setHistoryFromButton=function(e,t){for(var i in this._historySelection)if(void 0!==this._historySelection[i].value&&this._historySelection[i].value===e.value)return void(this._historySelection[i].cpt=t)},t.prototype._removeHistoryFromButton=function(e){for(var t in this._historySelection)if(void 0!==this._historySelection[t].value&&this._historySelection[t].value===e)return void this._historySelection.splice(parseInt(t),1)},t.prototype._indexesFromValues=function(e){var t=[];if(null!=e)for(var i=this._buttonGroup._getButtonList(),n=0;n<e.length;n++)for(var s=0;s<i.length;s++){var o=i[s];o.value===e[n]&&o instanceof d&&t.push(o._index)}return t},t.prototype._updateThresholds=function(e){var t=this;if(this._threshold){var i=0,n=this._buttonGroup._getButtonList(),s=[];e?e.forEach((function(e){s.push(t._buttonGroup.getButtonIndex(e))})):s=Array.apply(null,{length:n.length}).map(Number.call,Number);var o=[];s.forEach((function(e){if(Number.isInteger(e)&&n[e]){var t=n[e];o[e]=t.showLabelFlag,B.call(this,t,!0,Boolean(this._requestedProperties[t.value].tooltipInfos),this._isButtonInEdition)}}),this),s.forEach((function(e){var s=n[e];Number.isInteger(e)&&s&&(n[e].visibleFlag?(i=t.getWidthOfButton(s),Number(i)?s._iconLabelWidth=i:s._iconLabelWidth=0):s._iconLabelWidth=0)})),s.forEach((function(e){if(Number.isInteger(e)&&n[e]){var t=n[e];B.call(this,t,t instanceof d&&!t.icon,Boolean(this._requestedProperties[t.value].tooltipInfos),this._isButtonInEdition)}}),this),s.forEach((function(e){var s=n[e];Number.isInteger(e)&&s&&(s.visibleFlag?(i=t.getWidthOfButton(s),Number(i)?s._iconWidth=i:s._iconWidth=0):s._iconWidth=0)})),s.forEach((function(e){Number.isInteger(e)&&n[e]&&B.call(this,n[e],o[e],Boolean(this._requestedProperties[n[e].value].tooltipInfos),this._isButtonInEdition)}),this),this._threshold._iconAndLabelSize=0;for(var l=-1!==this.displayStyle.indexOf("vertical"),a=0;a<n.length;a++)l?this._threshold._iconAndLabelSize=Math.max(n[a]._iconLabelWidth,this._threshold._iconAndLabelSize):this._threshold._iconAndLabelSize+=n[a]._iconLabelWidth;this._threshold._iconAndLabelSelectedSize=0;for(a=0;a<n.length;a++)n[a].checkFlag||n[a]instanceof d&&!n[a].icon?l?this._threshold._iconAndLabelSelectedSize=Math.max(n[a]._iconLabelWidth,this._threshold._iconAndLabelSelectedSize):this._threshold._iconAndLabelSelectedSize+=n[a]._iconLabelWidth:l?this._threshold._iconAndLabelSelectedSize=Math.max(n[a]._iconWidth,this._threshold._iconAndLabelSelectedSize):this._threshold._iconAndLabelSelectedSize+=n[a]._iconWidth;this._threshold._iconOnlySize=0;for(a=0;a<n.length;a++)l?this._threshold._iconOnlySize=Math.max(n[a]._iconWidth,this._threshold._iconOnlySize):this._threshold._iconOnlySize+=n[a]._iconWidth;this.redrawTabBar()}},t.prototype._hasOverflow=function(){var e=0,t=!1;if(this._hasToHideLabel()){var i=this._buttonGroup._getButtonList();for(e=0;e<i.length;e++){var n=i[e];B.call(this,n,!1,Boolean(this._requestedProperties[n.value].tooltipInfos),this._isButtonInEdition)}t=!0}else if(this.responsiveFlag)if(-1===this.displayStyle.indexOf("strip")){var s=0;this.showComboBoxFlag&&this._tabComboBox&&this._tabComboBox.getContent()&&(s=this._tabComboBox.getContent().getBoundingClientRect().width);var o=0;this.newTabButtonFlag&&this._newTabButton&&this._newTabButton.getContent()&&(o=this._newTabButton.getContent().getBoundingClientRect().width);var l=-1!==this.displayStyle.indexOf("vertical"),a=this._buttonGroup.getContent().getBoundingClientRect().width+s+o,r=0;if(0!==(r=l?this._getVerticalDisplayWidth.call(this):this.elements.container.getBoundingClientRect().width)){i=this._buttonGroup._getButtonList();for(var h=0;h<i.length;h++){(n=i[h])&&n.label&&B.call(this,n,!0,Boolean(this._requestedProperties[n.value].tooltipInfos),this._isButtonInEdition)}if(this.showComboBoxFlag||this.newTabButtonFlag){var u=0;this._applyInheritWidthToButtons();for(var c=0;c<i.length;c++){if((n=i[c]).visibleFlag)u+=this.getWidthOfButton(n)}if(u+o>r+1){for(var p=100/this.getVisibleTabCount()+"%",m=this._buttonGroup._getButtonList(),g=0;g<m.length;g++){(n=m[g]).visibleFlag&&(n.getContent().style.width=p)}return this.getContent().setAttributeNode(document.createAttribute("overflow")),this.centeredFlag||(this.elements.buttonGroupContainer.removeClassName("wux-controls-tabBar-centered"),this.elements.tabBar.removeClassName("wux-controls-tabBar-centered"),this.elements.container.removeClassName("wux-controls-tabBar-centered")),!0}this._applyInheritWidthToButtons()}else if(a>r){if(this.getContent().setAttributeNode(document.createAttribute("overflow")),-1!==this.displayStyle.indexOf("panel")&&!this.showComboBoxFlag){var f=void 0;f=!0===this.touchMode?"38px":"22px",this.elements.tabBar.style.marginLeft=f}return!0}}this.getContent().removeAttribute("overflow"),-1===this.displayStyle.indexOf("panel")||this.showComboBoxFlag||(this.elements.tabBar.style.marginLeft="0px")}else{l=-1!==this.displayStyle.indexOf("vertical"),r=0,i=this._buttonGroup._getButtonList();if(l)r=this._getVerticalDisplayWidth.call(this);else{for(e=0;e<i.length;e++){n=i[e];B.call(this,n,!n.icon,Boolean(this._requestedProperties[n.value].tooltipInfos),this._isButtonInEdition)}r=this.elements.container.getBoundingClientRect().width}if(this._threshold&&0!==r){o=0;var v=0;this.newTabButtonFlag&&this._newTabButton&&this._newTabButton.getContent()&&(o=this._newTabButton.getContent().getBoundingClientRect().width),this.showComboBoxFlag&&this._tabComboBox&&this._tabComboBox.getContent()&&(v=this._tabComboBox.getContent().getBoundingClientRect().width),this._threshold._iconAndLabelSelectedSize=0;for(var y=0;y<i.length;y++)i[y].checkFlag||i[y]instanceof d&&!i[y].icon?l?this._threshold._iconAndLabelSelectedSize=Math.max(i[y]._iconLabelWidth,this._threshold._iconAndLabelSelectedSize):this._threshold._iconAndLabelSelectedSize+=i[y]._iconLabelWidth:l?this._threshold._iconAndLabelSelectedSize=Math.max(i[y]._iconWidth,this._threshold._iconAndLabelSelectedSize):this._threshold._iconAndLabelSelectedSize+=i[y]._iconWidth;if(this._threshold._iconAndLabelSize+o+v<=r){for(e=0;e<i.length;e++)B.call(this,i[e],!0,Boolean(this._requestedProperties[i[e].value].tooltipInfos),this._isButtonInEdition);this.getContent().removeAttribute("overflow")}else if(this._threshold._iconAndLabelSelectedSize+o+v<=r){for(e=0;e<i.length;e++){n=i[e];B.call(this,n,n.checkFlag||!n.icon,Boolean(this._requestedProperties[n.value].tooltipInfos),this._isButtonInEdition)}this.getContent().removeAttribute("overflow")}else{for(e=0;e<i.length;e++){n=i[e];B.call(this,n,!n.icon,Boolean(this._requestedProperties[n.value].tooltipInfos),this._isButtonInEdition)}this._threshold._iconOnlySize+o+v<=r?this.getContent().removeAttribute("overflow"):(this.getContent().setAttributeNode(document.createAttribute("overflow")),t=!0)}}}else t=!1;return t&&this.centeredFlag&&this.showComboBoxFlag&&(this.elements.buttonGroupContainer.addClassName("wux-controls-tabBar-centered"),this.elements.tabBar.addClassName("wux-controls-tabBar-centered"),this.elements.container.addClassName("wux-controls-tabBar-centered")),t},t.prototype._createButtonsNextAndPrevious=function(){var e=this;this._showPreviousButton||(this._showPreviousButton=new d({icon:-1!==this.displayStyle.indexOf("strip")?{iconName:"open-left",fontIconFamily:1}:"PreviousImage",allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton}),this._showPreviousButton.tooltipInfos={shortHelp:_.previousItems,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton},-1!==this.displayStyle.indexOf("strip")&&this._showPreviousButton.getContent().addClassName("wux-controls-tabbar-strip"),this._showPreviousButton.getContent().inject(this.elements.buttonsContainer),this._showPreviousButton.getContent().addClassName("wux-controls-tabBar-tabs-container-buttonPrevious"),l.addEventOnElement(this,this._showPreviousButton,"click",(function(){e._slideTabBar("left")}))),this._showNextButton||(this._showNextButton=new d({icon:-1!==this.displayStyle.indexOf("strip")?{iconName:"open-right",fontIconFamily:1}:"NextImage",allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton}),this._showNextButton.tooltipInfos={shortHelp:_.nextItems,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton},-1!==this.displayStyle.indexOf("strip")&&this._showNextButton.getContent().addClassName("wux-controls-tabbar-strip"),this._showNextButton.getContent().inject(this.elements.containerAddandNextButton),this._showNextButton.getContent().addClassName("wux-controls-tabBar-tabs-container-buttonNext"),l.addEventOnElement(this,this._showNextButton,"click",(function(){e._slideTabBar("right")}))),this._showButtonsNextAndPrevious()},t.prototype._showButtonsNextAndPrevious=function(){if(this._showPreviousButton.visibleFlag||-1!==this.displayStyle.indexOf("strip")||this._slideTabBar("left"),this._newTabButton&&-1===this.displayStyle.indexOf("vertical")&&this._newTabButton.getContent().inject(this.elements.containerAddandNextButton),!this._showPreviousButton.visibleFlag||!this._showNextButton.visibleFlag){this._showPreviousButton.visibleFlag=!0,this._showNextButton.visibleFlag=!0,-1!==this.displayStyle.indexOf("immersif")?(this._showPreviousButton.elements.icon.addClassName("wux-controls-showprevious-immersif"),this._showNextButton.elements.icon.addClassName("wux-controls-shownext-immersif"),this._showPreviousButton.getContent().addClassName("wux-controls-showprevious-immersif"),this._showNextButton.getContent().addClassName("wux-controls-shownext-immersif"),this.elements.buttonGroupContainer.addClassName("wux-controls-buttonGroup-immersif")):(this._showPreviousButton.elements.icon.removeClassName("wux-controls-showprevious-immersif"),this._showNextButton.elements.icon.removeClassName("wux-controls-shownext-immersif"),this._showPreviousButton.getContent().removeClassName("wux-controls-showprevious-immersif"),this._showNextButton.getContent().removeClassName("wux-controls-shownext-immersif"),this.elements.buttonGroupContainer.removeClassName("wux-controls-buttonGroup-immersif"));for(var e=this._buttonGroup._getButtonList(),t=0;t<e.length;t++){!0===(s=e[t]).visibleFlag&&-1!==this.displayStyle.indexOf("immersif")?s.getContent().addClassName("wux-controls-button-show-firstbutton"):t===e.length-1&&-1!==this.displayStyle.indexOf("bullet")&&e[e.length-1].getContent().addClassName("wux-controls-button-show-lastbutton")}for(var i=!1,n=e.length-1;n>=0;n--){var s=e[n];i||!0!==s.visibleFlag||(-1!==this.displayStyle.indexOf("immersif")&&(s.getContent().addClassName("wux-controls-button-show-lastbutton"),s.getContent().removeClassName("wux-controls-button-show-firstbutton")),i=!0)}}var o=this._buttonGroup.getContent().scrollWidth,l=this.elements.tabBar.getBoundingClientRect().width-o;this._slide>0&&(this._slide=0),this._slide<l&&(this._slide=l),this._manageButtonsVisibility(l),this._computeButtonsAndTogglesCSS()},t.prototype._hideButtonsNextAndPrevious=function(){this._showPreviousButton&&this._showNextButton&&(this._newTabButton&&-1===this.displayStyle.indexOf("vertical")&&this._newTabButton.inject(this.elements.tabBar),this._showPreviousButton.visibleFlag?(this._showPreviousButton.visibleFlag=!1,this._showNextButton.visibleFlag=!1,-1===this.displayStyle.indexOf("strip")&&this._slideTabBar("left")):(this._showPreviousButton.visibleFlag=!1,this._showNextButton.visibleFlag=!1),this._computeButtonsAndTogglesCSS())},t.prototype._manageButtonsVisibility=function(e){if(this._showPreviousButton&&this._showNextButton){var t=!1;if(0===e&&(t=!0),-1!==this.displayStyle.indexOf("strip")){var i=this.touchMode?54:36,n=0;if(this.value&&this.value.length>0){var s=this.getButtonFromValue(this.value[0]);s&&(n=void 0!==s.icon?s._iconWidth:s._iconLabelWidth)}n=n>i?n:i,this.elements.tabBar.getSize().width<n&&(t=!0)}t?this._hideButtonsNextAndPrevious():(this._showPreviousButton.visibleFlag=!0,this._showNextButton.visibleFlag=!0,0===this._slide?(this._showPreviousButton.disabled=!0,this._showNextButton.disabled=!1):this._slide===e?(this._showPreviousButton.disabled=!1,this._showNextButton.disabled=!0):(this._showPreviousButton.disabled=!1,this._showNextButton.disabled=!1))}else 0===this._slide?this._maxSlide="left":this._slide===e?this._maxSlide="right":this._maxSlide=""},t.prototype._slideTabBar=function(e){if(!("left"===e&&(this._showPreviousButton&&this._showPreviousButton.disabled||"left"===this._maxSlide)||"right"===e&&(this._showNextButton&&this._showNextButton.disabled||"right"===this._maxSlide))){var t,i=this._buttonGroup.getContent().scrollWidth,n=this.elements.tabBar.getBoundingClientRect().width,s=n-i;s=s>0?0:s,this._slide>0&&(this._slide=0),this._slide<s&&(this._slide=s);var o=Math.min(this.slideStep,n);"right"===e?(t=this._slide-o,this._slide=t>s?t:s):"left"===e&&(t=this._slide+o,this._slide=t<=0?t:0),T(this,this._slide),this._manageButtonsVisibility(s)}},t.prototype._slideToAvoidBlankSpace=function(){if(-1!==this.displayStyle.indexOf("strip"))if(this.value&&0!==this.value.length)this._slideToValue();else{var e=this._buttonGroup.getContent().scrollWidth,t=this.elements.tabBar.clientWidth;this._slide=0===e?0:t-e,T(this,this._slide)}},t.prototype._applyValue=function(e){if(void 0!==this.value){if(i.equals(e,this.value))return;this._buttonGroup.value=this.value,this._tabComboBox&&this.showComboBoxFlag&&(this._tabComboBox.value=this._tabComboBox.multiSelFlag?Array.from(this.value):this.value[0]);var t=this.getButtonFromValue(this.value[0]);if(-1!==this.displayStyle.indexOf("strip")&&(t&&O.call(this,t),e)){var n=this.getButtonFromValue(e[0]);N.call(this,n)}this._slideToValue(),-1!==this.displayStyle.indexOf("bullet")?this._updateView():this.redrawTabBar(),this.fire("change")}},t.prototype._slideToValue=function(){if(this.value&&this.value.length>0){var e=this.getButtonFromValue(this.value[0]);if(e){var t=this._buttonGroup.getContent().scrollWidth,i=this.elements.tabBar.getBoundingClientRect().width,n=i-t,s=e.getContent().getPosition(this._buttonGroup.getContent()).x,o=s+e.getContent().getDimensions().outerWidth,l=this.elements.tabBar.getBoundingClientRect().left-this._buttonGroup.getContent().getBoundingClientRect().left;if(l>=0&&s>=0&&l>=s)this._slide=-s;else{if(!(i+l<=o))return;this._slide=Math.floor(i-o)}this._slide<n&&(this._slide=n),this._slide>0&&(this._slide=0),T(this,this._slide)}}},t.prototype._comboCB=function(e){if(e.stopPropagation(),this.showComboBoxFlag){var t=!1;if(!1===this._tabComboBox.multiSelFlag)t=(this.value?this.value[0]:void 0)!==this._tabComboBox.currentValue;else for(var i=0;i<this._tabComboBox.currentValue.length;i++)if(-1===this.value.indexOf(this._tabComboBox.currentValue[i])){t=!0;break}if(t){var n=this._tabComboBox.multiSelFlag?this._tabComboBox.currentValue:[this._tabComboBox.currentValue];this.setPropertyFromUIInteraction("value",n)}}},t.prototype._removeValueComboBox=function(e){for(var t=0;t<this._history.getRoots().length;t++)this._history.getRoots()[t].options.grid.valueItem===e&&this._history.removeRoot(this._history.getRoots()[t]);this._tabComboBox.elementsTree=this._history},t.prototype._addTooltips=function(){for(var e=this._buttonGroup._getButtonList(),t=0;t<e.length;t++)this._updateTooltip(e[t])},t.prototype._updateTooltip=function(e){var t=this._requestedProperties[e.value].tooltipInfos;t&&(e.tooltipInfos=t)},t.prototype._updateComboBox=function(e){for(var t=this._buttonGroup._getButtonList(),i=0;i<t.length;i++)if(t[i].visibleFlag){for(var n=t[i],s=new f({label:n.label,index:n._index,grid:{valueItem:n.value},icons:n instanceof d&&n.icon?[{iconName:a.isIconDefinition(n.icon)?n.icon.iconName:n.icon}]:""}),o=!1,l=0;l<this._history.getRoots().length;l++)if(this._history.getRoots()[l].options.grid.valueItem===s.options.grid.valueItem||void 0!==e&&e===this._history.getRoots()[l].options.index){o=!0,this._history.getRoots()[l].options.label=s.options.label,this._history.getRoots()[l].options.icons=s.options.icons,this._history.getRoots()[l].options.grid.valueItem=s.options.grid.valueItem;break}o||this._history.addRoot(s,t[i]._index)}this._tabComboBox.elementsTree=this._history},t.prototype._changeButtonIndexInComboBox=function(e,t){for(var i,n=new f({label:e.label,grid:{valueItem:e.value}}),s=0;s<this._history.getRoots().length;s++)if(this._history.getRoots()[s].options.grid.valueItem===n.options.grid.valueItem){i=this._history.getRoots()[s];break}i&&this._history.removeRoot(i),this._history.addRoot(n,t)},t.prototype.getButtonFromValue=function(e){var t,i=this._buttonGroup._getButtonList();if(i){if(Array.isArray(e)){for(var n=[],s=0;s<i.length;s++){t=i[s];for(var o=0;o<e.length;o++)(e[o]===t.value&&t instanceof d&&-1===this.displayStyle.indexOf("bullet")||e[o]===t.value&&t instanceof p&&-1!==this.displayStyle.indexOf("bullet"))&&n.push(t)}return n}for(s=0;s<i.length;s++)if((t=i[s]).value===e)return t}},t.prototype._updateButtonFocus=function(){if(this.value&&this.value.length>0){var e=this.getButtonFromValue(this.value[0]);e&&(e.getContent().blur(),e.getContent().focus())}},t.prototype.getWidthWithoutScroll=function(){if(this.redrawTabBar(),this._overflow)return this._overflow},t.prototype.getMinWidthWithoutScroll=function(){this.redrawTabBar();for(var e=0,t=this.getVisibleTabCount(),i=this._buttonGroup._getButtonList(),n=0;n<t;n++)i[n]&&(e+=i[n].getContent().getBoundingClientRect().width);return this.showComboBoxFlag&&(e+=this._tabComboBox.getContent().getBoundingClientRect().width),e},t.prototype.getWidthOfAllVisibleButtons=function(){for(var e=0,t=this._buttonGroup._getButtonList(),i=0;i<t.length;i++){var n=t[i];n.visibleFlag&&(e+=this.getWidthOfButton(n))}return e+3},t.prototype.getWidthOfButton=function(e){var t=window.getComputedStyle(e.getContent(),null),i=parseInt(t.marginLeft.slice(0,-2)),n=parseInt(t.marginRight.slice(0,-2));return e.getContent().getBoundingClientRect().width+i+n},t.prototype._applyInheritWidthToButtons=function(){for(var e=this._buttonGroup._getButtonList(),t=0;t<e.length;t++){var i=e[t];i.visibleFlag&&(i.getContent().style.width="inherit")}},t.prototype._getButtonByIndex=function(e){var t,i=this._buttonGroup._getButtonList();if(i)for(var n=0;n<i.length;n++)if((t=i[n])._index===e)return t},t.prototype.getValueByIndex=function(e){var t=this._getButtonByIndex(e);if(t)return t.value},t.prototype.getIndexesByValues=function(e){for(var t=[],i=0;i<e.length;i++){var n=this.getButtonFromValue(e[i]);if(-1===this.displayStyle.indexOf("bullet")){if(n)void 0!==(s=n._index)&&(t[i]=s);else t[i]=void 0}else{var s,o=R(this._buttonGroup._getButtonList(),n);if(o)(s=o._index)&&(t[i]=s);else t[i]=void 0}}return t},t.prototype.getTabCount=function(){if(this._buttonGroup)return-1!==this.displayStyle.indexOf("bullet")?this._buttonGroup.getButtonCount()/2:this._buttonGroup.getButtonCount()},t.prototype.getVisibleTabCount=function(){if(this._buttonGroup){for(var e=0,t=this._buttonGroup._getButtonList(),i=0;i<t.length;i++)t[i].visibleFlag&&e++;return e}},t.prototype._getVisibleTabButtons=function(){if(this._buttonGroup){for(var e=[],t=this._buttonGroup._getButtonList(),i=0;i<t.length;i++){var n=t[i];n.visibleFlag&&e.push(n)}return e}},t.prototype.add=function(e){void 0===e.allowClosableFlag&&(e.allowClosableFlag=!0);var t=this._buttonGroup.getButtonCount();void 0===e.index&&(e.index=t),void 0!==e.isSelected&&null!==e.isSelected||(e.isSelected=!1),void 0!==e.showTitleFlag&&null!==e.showTitleFlag||(e.showTitleFlag=!0);for(var i=void 0!==e.value&&null!==e.value?e.value:e.index;this.getButtonFromValue(i);){if("string"==typeof i)return void console.error("TabPage with same value already exists. Ensure that value is unique!");i++}var n=e.icon;n&&n.iconName&&void 0===n.fontIconFamily&&(n.fontIconFamily=y.WUXManagedFontIcons.FontAwesome),this._updateAllowClosableFlags(i,e.allowClosableFlag),this._updateAllowContextualMenuFlags(i,e.allowContextualMenuFlag);var s=new d({label:e.label,type:"radio",value:i,checkFlag:e.isSelected,clickMode:1,showLabelFlag:e.showTitleFlag,icon:n,touchMode:e.touchMode,allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton,tooltipInfos:e.tooltipInfos,displayStyle:"vertical"===this.tabButtonDirection&&n?"lite-borders":"normal"});s._index=e.index,this._requestedProperties||(this._requestedProperties={}),this._requestedProperties[i]||(this._requestedProperties[i]={}),this._requestedProperties[i].showTitleFlag=e.showTitleFlag,this._requestedProperties[i].tooltipInfos=e.tooltipInfos;var o=new p({type:"radio",value:i,checkFlag:e.isSelected,clickMode:1,allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton,tooltipInfos:e.tooltipInfos});o._index=e.index;for(var l,a=e.index;this._togglesTab.hasOwnProperty(a);)a++;if(this._togglesTab[a]=o,O.call(this,s),0===t)s.inject(this._buttonGroup.elements.container);else for(var r=this._buttonGroup._getButtonList(),h=0;h<r.length;h++){var u=r[h];u._index<e.index&&(l=u)}return l?s.inject(l.getContent(),"after"):s.inject(this._buttonGroup.getButton(0).getContent(),"before"),this._updateIndexOfTab(),this._buttonGroup._updateChildPropertiesAndListeners(s,s._index),this._historySelection[this._historySelection.length]={value:s.value,cpt:this._cptSelection},s.getContent().setAttribute("role","tab"),this.showComboBoxFlag||-1===this.displayStyle.indexOf("strip")&&this._hideButtonsNextAndPrevious(),this._applyDisplayStyle(),this.showComboBoxFlag&&this._updateComboBox(),this._computeButtonsAndTogglesCSS(),this._updateThresholds(),e&&!1===e.visibleFlag&&this._setTabVisibility(i,!1),s},t.prototype._updateAllowClosableFlags=function(e,t){this._allowClosableFlags=this._allowClosableFlags||[],this._allowClosableFlags[e]=void 0===t?this._allowClosableFlags[e]:t},t.prototype._updateAllowContextualMenuFlags=function(e,t){this._allowContextualMenuFlags=this._allowContextualMenuFlags||[],this._allowContextualMenuFlags[e]=void 0===t?this._allowContextualMenuFlags[e]:t},t.prototype._hasButtonAChevron=function(e){var t=e.value;return!0===this._allowContextualMenuFlags[t]||void 0===this._allowContextualMenuFlags[t]&&this.closeButtonFlag&&!1!==this._allowClosableFlags[t]||this.closeAllButtonFlag},t.prototype._hasButtonADirectClose=function(e){var t=e.value;return!this._hasButtonAChevron(e)&&this.closeButtonFlag&&!1!==this._allowClosableFlags[t]},t.prototype.addTab=function(e,t,i,n,s,o,l){var a={label:e,index:t,isSelected:i,value:n,icon:s,allowClosableFlag:o,showTitleFlag:l};return this.add(a)},t.prototype._onChevronButtonClicked=function(e){var t=this,i=[];this.closeButtonFlag&&e.elements&&"true"===e.elements._sideButton.getAttribute("closable")&&!L(i,_.close)&&i.push({type:"PushItem",title:_.close,action:{callback:function(){t._closeListener(e)}}}),this.closeAllButtonFlag&&!L(i,_.closeAllTabs)&&i.push({type:"PushItem",title:_.closeAllTabs,action:{callback:function(){for(var e=t._buttonGroup.elements.container.childNodes.length,i=0,n=0;i<e;i++)t._buttonGroup.elements.container.childNodes[n].dsModel.elements._sideButton?t._closeListener(t._buttonGroup.elements.container.childNodes[n].dsModel):n++}}}),this.editableFlag&&!L(i,_.rename)&&i.push({type:"PushItem",title:_.rename,action:{callback:function(){t._editTab(e.value)}}}),this.modelEvent.publish({event:V,data:{menu:i,index:e._index,value:e.value}});var n=e.elements._sideButton.parentNode.getBoundingClientRect(),s=26;return!0===e.touchMode&&(s=44),0!==i.length&&v.show(i,{position:{x:n.left+n.width-s,y:n.top+n.height}},{onShow:function(){e.elements._sideButton.setAttributeNode(document.createAttribute("is-displaying-menu"))},onHide:function(){e.elements._sideButton.removeAttribute("is-displaying-menu")}}),i},t.prototype.setAllowClosableFlagOnValue=function(e,t){var i=this.getButtonFromValue(e);i&&(this._updateAllowClosableFlags(e,t),O.call(this,i))},t.prototype.changeLabel=function(e,t){var i=new Error("DEPRECATED METHOD");i.name="WARNING",console.warn(i.stack),this._buttonGroup.getButton(e).label=t,this.modelEvent.publish({event:A,data:{index:e,label:t}})},t.prototype.removeTab=function(e,t){if(this.value&&Array.isArray(this.value)){var i=-1!==this.value.indexOf(e);this.pinFlag&&this.pinnedList&&this.pinnedList.length>0&&-1!==this.pinnedList.indexOf(e)&&this._removePinnedButton(e);var n=this.getButtonFromValue(e);if(!n)return;if(this._preventButtonGroupListener=i,t)n.visibleFlag=!1,this.getOwnerDocument().body.appendChild(n.getContent());else this._buttonGroup.removeChild(n);if(this._preventButtonGroupListener=!1,-1!==this.displayStyle.indexOf("bullet")){var s=H(this._togglesTab,e);this._togglesTab[s].destroy(),this._togglesTab[s]=null,delete this._togglesTab[s]}if(this._updateIndexOfTab(),this.showComboBoxFlag&&this._removeValueComboBox(e),this._removeHistoryFromButton(e),i){var o=this._getMaxHistory();this.value=void 0!==o?[o]:[]}this._computeButtonsAndTogglesCSS(),this._updateIndexOfTab(),this._updateThresholds(),this._slideToAvoidBlankSpace(),this.redrawTabBar()}},t.prototype.updateTab=function(e,t){var i=this.getButtonFromValue(e);if(i){var n=i.label!=t.label||i.icon!=t.icon;t.hasOwnProperty("label")&&(i.label=t.label,i.elements._sideButton&&i.getContent().insertBefore(i.elements._sideButton,i.elements.lastChild),!t.hasOwnProperty("tooltipInfos")&&i.tooltipInfos&&this._requestedProperties&&this._requestedProperties[e]&&!this._requestedProperties[e].tooltipInfos&&(i.tooltipInfos.shortHelp=t.label)),t.hasOwnProperty("tooltipInfos")&&(i.tooltipInfos=t.tooltipInfos,this._requestedProperties[e].tooltipInfos=t.tooltipInfos),t.hasOwnProperty("icon")&&(i.icon=t.icon),this._updateAllowClosableFlags(e,t.allowClosableFlag),this._updateAllowContextualMenuFlags(e,t.allowContextualMenuFlag),O.call(this,i),void 0!==t.showTitleFlag&&(this._requestedProperties||(this._requestedProperties={}),this._requestedProperties[e]||(this._requestedProperties[e]={}),this._requestedProperties[e].showTitleFlag=t.showTitleFlag,B.call(this,i,t.showTitleFlag,Boolean(this._requestedProperties[i.value].tooltipInfos),this._isButtonInEdition)),n&&this.showComboBoxFlag&&this._updateComboBox(),this._updateThresholds([i])}},t.prototype.getOptionFromButton=function(e,t){var i=this.getButtonFromValue(t);if(i&&i[e])return i[e]},t.prototype.setOptionFromButton=function(e,t,i){var n=this.getButtonFromValue(i);n&&(n[e]=t),!this.showComboBoxFlag||"icon"!==e&&"label"!==e||this._updateComboBox()},t.prototype._editTab=function(e){this._editedButton=this.getButtonFromValue(e),this._isButtonInEdition=!0;var t=this._editedButton.getContent(),i=window.getComputedStyle(t),n=window.getComputedStyle(this._editedButton.elements.text),s=t.getBoundingClientRect().width-parseInt(i.getPropertyValue("border-left"))-parseInt(i.getPropertyValue("border-right"));if("horizontal"===this.tabButtonDirection){if(this._editedButton.elements.icon)s-=this._editedButton.elements.icon.getBoundingClientRect().width,s-=parseInt(i.getPropertyValue("padding-left"));-1!==this.displayStyle.indexOf("vertical")&&(s-=parseInt(n.getPropertyValue("padding-right")))}else"vertical"===this.tabButtonDirection&&(s=parseInt(n.getPropertyValue("width")));var o=parseInt(n.getPropertyValue("height"));if(isNaN(o)&&(o=parseInt(i.getPropertyValue("height"))),"horizontal"===this.tabButtonDirection&&(o-=5),this.closeButtonFlag&&this._editedButton.elements._sideButton&&N.call(this,this._editedButton),this.closeAllButtonFlag&&this._editedButton.elements._closeAllButton&&this._editedButton.elements._closeAllButton.hide(),this._editedButton instanceof d&&(this.editableFlag||this._editedButton.label===_.newTab)){if(this._lineEditorOfButton){if(this._lineEditorOfButton.visibleFlag)return;var l=this._lineEditorOfButton.getContent();"horizontal"===this.tabButtonDirection?l.style.display="inline-block":l.style.display="",this._lineEditorOfButton.value=this._editedButton.label,this._lineEditorOfButton.inject(this._editedButton.elements.container),this._lineEditorOfButton.show()}else{var a=this._editedButton.elements.text?this._editedButton.elements.text.innerText:"";this._lineEditorOfButton=new c({value:a,touchMode:this.touchMode,selectAllOnFocus:-1!==this.displayStyle.indexOf("strip")}),this._lineEditorOfButton.inject(this._editedButton.elements.container);var r=this._lineEditorOfButton.getContent();r.addClassName("wux-controls-tabbar-lineeditor"),r.style.minWidth="44px","horizontal"===this.tabButtonDirection&&(r.style.display="inline-block")}var h=this._lineEditorOfButton.getContent();this._editedButton.elements.icon?h.setAttribute("tabPageHasIcon",""):t.addClassName("wux-controls-tabbar-button-nopadding"),t.setAttribute("tabPageEdited",""),h.style.width=s+"px",o&&(-1!==this.displayStyle.indexOf("strip")&&(h.style.height=o+"px"),this._lineEditorOfButton.elements.inputField.style.height=o+"px"),this._lineEditorOfButton.focus({preventScroll:!0}),this._updateThresholds([this._editedButton]),this._editedButton.elements.text&&this._editedButton.elements.text.hide()}this.modelEvent.publish({event:x,data:{value:e}}),this.fire("edit",{value:e})},t.prototype._endEditTab=function(e){if(this._editedButton){this._isButtonInEdition=!1,this._editedButton.getContent().removeClassName("wux-controls-tabbar-button-nopadding"),this._editedButton.getContent().removeAttribute("tabPageEdited");var t=this._editedButton.elements.container.getElements(".wux-controls-lineeditor");if(t&&t[0]){var i=t[0].dsModel,n=this._editedButton.label;e?i.valueToCommit=n:this._editedButton.label=i.value,i.visibleFlag=!1,this._editedButton.elements.text&&this._editedButton.elements.text.show(),this.closeButtonFlag&&this._editedButton.elements._sideButton&&M.call(this,this._editedButton),this.closeAllButtonFlag&&this._editedButton.elements._closeAllButton&&this._editedButton.elements._closeAllButton.show(),this.showComboBoxFlag&&this._tabComboBox&&this._updateComboBox(),this.modelEvent.publish({event:P,data:{button:this._editedButton}}),e?this.fire("cancelEdit",{button:this._editedButton,previousLabel:n}):this.fire("endEdit",{button:this._editedButton,previousLabel:n}),this._slideToValue(),this._updateThresholds([this._editedButton]),this._updateTooltip(this._editedButton)}}},t.prototype._updateIndexOfTab=function(){for(var e=this._buttonGroup._getButtonList(),t=0;t<e.length;t++)e[t]._index=t},t.prototype._setTabVisibility=function(e,t){var i=this.getButtonFromValue(e),n=i.visibleFlag;if(i.visibleFlag=t,t||(i.preventTriggeringChangeEvent=!0,i.checkFlag=!1,i.preventTriggeringChangeEvent=!1),this.showComboBoxFlag&&(!t&&n?this._removeValueComboBox(e):t&&!n&&this._updateComboBox()),!t&&this.value&&1===this.value.length&&this.value[0]===e){var s=this._getMaxHistory();this.value=void 0!==s?[s]:[]}this._computeButtonsAndTogglesCSS()},t.prototype._getTabVisibility=function(e){return this.getButtonFromValue(e).visibleFlag},t.prototype.pinTab=function(e){this._pinTab(e)},t.prototype._pinTab=function(e){var t=this.getButtonFromValue(e),i=t._index;t&&this.pinFlag&&(this.pinnedList&&-1!==this.pinnedList.indexOf(e)?(this._removePinnedButton(t.value),this.modelEvent.publish({event:w,data:{index:i,value:t.value}}),this.fire("pinStateChange",{value:e,pinnedFlag:!1})):(this._addPinnedButton(t.value),this.modelEvent.publish({event:C,data:{index:i,value:t.value}}),this.fire("pinStateChange",{value:e,pinnedFlag:!0})),this.fire("change"),this.redrawTabBar(),this._hasOverflow())},t.prototype.redrawTabBar=function(){if(this._buttonGroup&&this._buttonGroup.getContent()){var e=this._buttonGroup.getContent().getBoundingClientRect().width;if(-1!==this.displayStyle.indexOf("panel")&&this._tabComboBox){var t=24;this.touchMode&&(t=36);var i=2*t;this._buttonGroup.visibleFlag=!0,this._tabComboBox.getContent().addClassName("wux-button-tabBar-combo-right"),this.getContent().getBoundingClientRect().width<i&&(this._buttonGroup.visibleFlag=!1,this._tabComboBox.getContent().removeClassName("wux-button-tabBar-combo-right"))}if(this.visibleFlag&&0!==e){if(this._hasOverflow()||-1!==this.displayStyle.indexOf("panel")&&!this._buttonGroup.visibleFlag?(this._overflow=e+2,this.showComboBoxFlag?(this._addTooltips(),this._tabComboBox.show(),-1!==this.displayStyle.indexOf("strip")&&this._showButtonsNextAndPrevious()):this._showButtonsNextAndPrevious(),this._slide>1&&this._updateButtonFocus(),this.touchMode?this.elements.tabBar.getSize().width<54&&this._hideButtonsNextAndPrevious():this.elements.tabBar.getSize().width<36&&this._hideButtonsNextAndPrevious()):(T(this,0),this._overflow=e+2,this.showComboBoxFlag?(this._tabComboBox.hide(),-1!==this.displayStyle.indexOf("strip")&&this._showPreviousButton&&this._showNextButton&&this._hideButtonsNextAndPrevious()):this._hideButtonsNextAndPrevious()),this.newTabButtonFlag&&this._applyNewTabButtonFlag(),this._buttonGroup.value)for(var n=this._buttonGroup._getButtonList(),s=0;s<n.length;s++){var o=n[s];-1!==this.displayStyle.indexOf("bullet")&&o.checkFlag&&o.getContent().addClassName("wux-controls-toggle-selectbutton"),W(this,o)}this.showComboBoxFlag&&this._updateComboBox()}}},t.prototype.onSelectTab=function(e){return this.modelEvent.subscribe({event:b},e)},t.prototype.onBeginTabDrag=function(e){return this.modelEvent.subscribe({event:D},e)},t.prototype.onEndTabDrag=function(e){return this.modelEvent.subscribe({event:S},e)},t.prototype.onUnpinTab=function(e){return this.modelEvent.subscribe({event:w},e)},t.prototype.onPinTab=function(e){return this.modelEvent.subscribe({event:C},e)},t.prototype.onEditTab=function(e){return this.modelEvent.subscribe({event:x},e)},t.prototype.onEndEditTab=function(e){return this.modelEvent.subscribe({event:P},e)},t.prototype.onChangeLabelTab=function(e){return this.modelEvent.subscribe({event:A},e)},t.prototype.onPreNewTab=function(e){return this.modelEvent.subscribe({event:I},e)},t.prototype.onNewTab=function(e){return this.modelEvent.subscribe({event:F},e)},t.prototype.onRemoveTabEvent=function(e){return this.modelEvent.subscribe({event:E},e)},t.prototype.onContextualMenuEvent=function(e){return this.modelEvent.subscribe({event:V},e)},t.prototype.destroy=function(){function t(e,t){e&&e[t]&&(e[t].destroy(),e[t]=null)}for(var i in l.removeResizeListener(this.elements.container,this._onResizeFun),t(this,"_buttonGroup"),t(this,"_newTabButton"),t(this,"_showPreviousButton"),t(this,"_showNextButton"),t(this,"_newTabComboBox"),t(this,"_tabComboBox"),t(this,"_history"),this._togglesTab)i&&t(this._togglesTab,i);e.prototype.destroy.call(this)},t.prototype._addNewButtonInComboBox=function(){var e=this;if(!this._newTabComboBox&&(this._newTabComboBox=new d({icon:"plus",label:_.newTab,allowUnsafeHTMLLabel:this.allowUnsafeHTMLOnTabButton}),this._newTabComboBox.tooltipInfos={shortHelp:_.addNewItem,allowUnsafeHTMLTitle:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLShortHelp:this.allowUnsafeHTMLOnTabButton,allowUnsafeHTMLLongHelp:this.allowUnsafeHTMLOnTabButton},this._newTabComboBox.elements.container.addClassName("wux-controls-tabbar-newbuttoncombo"),l.addEventOnElement(this,this._newTabComboBox,"click",(function(){j.call(e)})),this._tabComboBox&&this._tabComboBox.elements&&this._tabComboBox.elements.popup)){var t=this._tabComboBox.elements.popup.getBody(),n=i.createElement("div");this._newTabComboBox.inject(n),t.inject(n),this._tabComboBox.elements.popup.setBody(n)}var s=void 0;if(this._tabComboBox&&this._tabComboBox.elements&&this._tabComboBox.elements.popup&&(s=this._tabComboBox.elements.popup.getBody()),this.newTabButtonFlag&&this.showComboBoxFlag){if(this._tabComboBox&&this._tabComboBox.elements&&this._tabComboBox.elements.popup&&!1===s.contains(this._newTabComboBox.getContent())){s=this._tabComboBox.elements.popup.getBody();n=i.createElement("div");this._newTabComboBox.inject(n),s.inject(n),this._tabComboBox.elements.popup.setBody(n)}this._newTabComboBox.show(),s&&s.addClassName("wux-controls-tabbar-combopopup")}else this._newTabComboBox.hide(),s&&s.removeClassName("wux-controls-tabbar-combopopup")},t.prototype._setSideButton=function(e){e.elements._sideButton||(e.elements._sideButton=new i.Element("div",{class:"wux-controls-tabBar-close wux-ui-3ds wux-ui-3ds-chevron-down"})),this._hasButtonAChevron(e)?(e.elements._sideButton.addClassName("wux-ui-3ds-chevron-down"),e.elements._sideButton.removeClassName("wux-ui-3ds-close"),e.elements._sideButton.tooltipInfos=void 0):this._hasButtonADirectClose(e)&&(e.elements._sideButton.removeClassName("wux-ui-3ds-chevron-down"),e.elements._sideButton.addClassName("wux-ui-3ds-close"),e.elements._sideButton.tooltipInfos={shortHelp:_.close}),e.getContent().addClassName("wux-controls-tabbar-closebutton");var t=this._isButtonClosable(e);e.elements._sideButton.setAttribute("closable",t);var n=e.getContent().lastChild,s=n?n.nextSibling:null;e.getContent().insertBefore(e.elements._sideButton,s),e.elements._sideButton.addClassName("button-close-unvisible")},t.prototype._computeButtonsAndTogglesCSS=function(){if(-1===this.displayStyle.indexOf("strip")){var e,t=this._getVisibleTabButtons(),i=0,n="wux-controls-button-",s=this.getVisibleTabCount();if(1===s)t[0].getContent().addClassName(n+"onlyone"),t[0].getContent().removeClassName(n+"allothers"),t[0].getContent().removeClassName(n+"lastone"),t[0].getContent().removeClassName(n+"firstone"),-1!==this.displayStyle.indexOf("normal")&&t[0].getContent().setStyle("margin-right","0px"),t[1]&&t[1].getContent().addClassName(n+"lastone");else for(var o=0;o<s;o++)(e=t[o].getContent()).removeClassName(n+"show-lastbutton"),e.removeClassName(n+"show-firstbutton"),!0===t[o].visibleFlag&&(-1!==this.displayStyle.indexOf("bullet")?0===i?(e.addClassName(n+"firstone"),e.removeClassName(n+"allothers"),e.removeClassName(n+"lastone"),e.removeClassName(n+"onlyone"),i=1):o===s-1?(e.addClassName(n+"lastone"),e.removeClassName(n+"allothers"),e.removeClassName(n+"firstone"),e.removeClassName(n+"onlyone")):(e.addClassName(n+"allothers"),e.removeClassName(n+"onlyone"),e.removeClassName(n+"firstone"),e.removeClassName(n+"lastone")):0===o?(e.addClassName(n+"firstone"),e.removeClassName(n+"allothers"),e.removeClassName(n+"lastone"),e.removeClassName(n+"onlyone")):o===s-1?(e.addClassName(n+"lastone"),e.removeClassName(n+"allothers"),e.removeClassName(n+"firstone"),e.removeClassName(n+"onlyone")):(e.addClassName(n+"allothers"),e.removeClassName(n+"onlyone"),e.removeClassName(n+"firstone"),e.removeClassName(n+"lastone")))}},t}(h),U=function(e,t){if(!e||!t)throw new Error("WRONG PARAMETERS");for(var i in e)if(t.value===e[i].value)return e[i]},H=function(e,t){for(var i in e)if(t===e[i].value)return i},R=function(e,t){if(!e||!t)throw new Error("WRONG PARAMETERS");for(var i=0;i<e.length;++i)if(t.value===e[i].value&&e[i]instanceof d)return e[i]},W=function(e,t){if(!e||!t)throw new Error("WRONG PARAMETER");if(e.pinnedList&&e.pinnedList.length>0)for(var i=0;i<e.pinnedList.length;++i)t.value===e.pinnedList[i]&&(-1!==e.displayStyle.indexOf("normal")?t.getContent().removeClassName("wux-controls-toggle-pinnedbutton"):-1!==e.displayStyle.indexOf("bullet")&&(t.getContent().addClassName("wux-controls-toggle-pinnedbutton"),t.show()))},j=function(){var e;if(this.autoNewTabFlag){var t=this.add({label:_.newTab,touchMode:this.touchMode});e=t._index;var i=t.value;this.modelEvent.publish({event:I,data:{index:e,value:t.value}}),this.fire("preAddTab",{index:e,value:t.value}),i!==t.value&&(this._requestedProperties[i]&&(this._requestedProperties[t.value]=this._requestedProperties[i],delete this._requestedProperties[i]),this._historySelection[this._historySelection.length]={value:t.value,cpt:1},this.showComboBoxFlag&&this._updateComboBox(e)),this._buttonGroup.selectIndex(e),this._editTab(t.value);var n=this._buttonGroup.getContent().scrollWidth,s=this.elements.tabBar.getBoundingClientRect().width,o=s-n;this._slide=s/2-(t.getContent().getBoundingClientRect().left-this._buttonGroup.getContent().getBoundingClientRect().left),this._slide<o&&(this._slide=o),-1===this.displayStyle.indexOf("immersif")&&(this._slide-=5),this.redrawTabBar(),this._lineEditorOfButton&&this._lineEditorOfButton.elements.inputField.focus()}this.modelEvent.publish({event:F,data:{index:e}}),this.fire("addTab",{index:e})},z=function(){this.elements.buttonGroupContainer.addClassName("wux-controls-tabbar-strip"),this.elements.buttonsContainer.addClassName("wux-controls-tabbar-strip"),this.elements.container.addClassName("wux-controls-tabbar-strip"),this._newTabButton&&(-1!==this.displayStyle.indexOf("vertical")?this._newTabButton.inject(this.elements.containerAddandNextButton):this._newTabButton.inject(this.elements.tabBar),this._newTabButton.getContent().addClassName("wux-controls-tabbar-strip"),this._newTabButton.icon="plus",this._newTabButton.label="",this.newTabButtonFlag||this._newTabButton.hide()),this._showPreviousButton||this._showNextButton||this._createButtonsNextAndPrevious(),this._showPreviousButton&&(this._showPreviousButton.icon={iconName:"open-left",fontIconFamily:1},this._showPreviousButton.getContent().addClassName("wux-controls-tabbar-strip")),this._showNextButton&&(this._showNextButton.icon={iconName:"open-right",fontIconFamily:1},this._showNextButton.getContent().addClassName("wux-controls-tabbar-strip")),this._newTabButton&&(this._newTabButton.getContent().style.marginLeft="0px"),this._tabComboBox&&(this._tabComboBox.expanderIcon=this.newTabButtonFlag?"list-add":"list",this._tabComboBox.getContent().addClassName("wux-controls-tabbar-strip"),this._tabComboBox.elements.popup||this._tabComboBox._buildPopup(),this._tabComboBox.elements.popup.alignment="left",this._tabComboBox.elements.popup.getContent().addClassName("wux-controls-tabbar-strip"),this._tabComboBox.elements.treeListView.getManager().options.defaultCellHeight=30,this._addNewButtonInComboBox(),this._tabComboBox.inject(this.elements.containerAddandNextButton)),-1!==this.displayStyle.indexOf("strip-box")&&this.elements.container.addClassName("wux-controls-tabbar-strip-box")},G=function(){this.elements.buttonGroupContainer.removeClassName("wux-controls-tabbar-strip"),this.elements.buttonsContainer.removeClassName("wux-controls-tabbar-strip"),this.elements.container.removeClassName("wux-controls-tabbar-strip"),this.elements.container.removeClassName("wux-controls-tabbar-strip-box"),this._showPreviousButton&&(this._showPreviousButton.destroy(),this._showPreviousButton=null),this._showNextButton&&(this._showNextButton.destroy(),this._showNextButton=null),this._tabComboBox&&(this._tabComboBox.destroy(),this._tabComboBox=null),this._applyShowComboBoxFlag(),this._applyNewTabButtonFlag()},X=function(e,t){for(var i=[],n=0;n<e.length;n++)-1===t.indexOf(e[n])&&i.push(e[n]);return i};return s.addClass(k,"tabbar"),k}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Tab",["require","exports","UWA/Core","DS/Core/WebUXComponents","DS/Utilities/Utils","DS/Controls/Abstract","DS/Controls/TabBar","DS/Utilities/Dom"],(function(e,t,i,n,s,o,l,a){"use strict";var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{tabBar:{defaultValue:void 0,type:"TabBar"},tabBarDOMContainer:{defaultValue:void 0,type:"object"},tabPanelContainer:{defaultValue:void 0,type:"object"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},value:{defaultValue:void 0,type:"Array<WUX.TabbarButtonValue>"},multiSelFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},reorderFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},showComboBoxFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},autoCloseFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},autoNewTabFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},multiSelLayout:{defaultValue:"vertical",type:"string",category:"Appearance"},newTabButtonFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},allowUnsafeHTMLOnTabButton:{defaultValue:void 0,type:"boolean",category:"Behavior"},position:{defaultValue:"top",type:"string",category:"Appearance"},hideTabBarWhenOnlyOnePageFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},tabButtonDirection:{defaultValue:"horizontal",type:"string",category:"Appearance"},showButtonLabelFlag:{defaultValue:void 0,type:"boolean",category:"Appearance"},responsiveFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},usePaddingFlag:{defaultValue:!1,type:"boolean",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];t&&t.length>0&&t[0]._noCSSOnParent&&(this._noCSSOnParent=t[0]._noCSSOnParent),e.prototype.init.apply(this,t)},t.prototype.buildView=function(){var e=this;this.elements.container.addClassName("wux-controls-tab"),this.tabBarDOMContainer||(this.tabBarDOMContainer=new i.Element("div",{class:"tabBarContainer"}),this.tabBarDOMContainer.inject(this.elements.container,"top")),this.tabPanelContainer||(this.tabPanelContainer=new i.Element("div",{class:"tabContainer"}),this.tabPanelContainer.inject(this.elements.container,"bottom")),this.tabBar||(this.tabBar=new l({allowUnsafeHTMLOnTabButton:this.allowUnsafeHTMLOnTabButton}),this.tabBar._getVerticalDisplayWidth=function(){if(e.elements.container)return.2*e.elements.container.getBoundingClientRect().width}),this._tabContent=[]},t.prototype.destroy=function(){this._onResizeFun&&this.elements.container&&a.removeResizeListener(this.elements.container,this._onResizeFun),this.tabBar.destroy(),e.prototype.destroy.call(this)},t.prototype._postBuildView=function(){this.tabBar&&(this.tabBar.allowUnsafeHTMLOnTabButton=this.allowUnsafeHTMLOnTabButton)},t.prototype._applyReorderFlag=function(){this.tabBar&&(this.tabBar.reorderFlag=this.reorderFlag)},t.prototype._applyTabBar=function(e){e&&e.remove(),this.tabBar&&this.tabBarDOMContainer&&(i.is(this.tabBar,"element")&&(this.tabBar=new i.extendElement(this.tabBar)),this.tabBar.inject(this.tabBarDOMContainer))},t.prototype._applyTabBarDOMContainer=function(e){e&&e.remove(),this.tabBarDOMContainer&&(i.is(this.tabBarDOMContainer,"element")&&(this.tabBarDOMContainer=new i.extendElement(this.tabBarDOMContainer)),this._applyTabBar())},t.prototype._applyTabPanelContainer=function(e){e&&e.remove(),this.tabPanelContainer&&(i.is(this.tabPanelContainer,"element")&&(this.tabPanelContainer=new i.extendElement(this.tabPanelContainer)),this.tabPanelContainer.addClassName("wux-controls-tab-container"),this._applyUsePaddingFlag())},t.prototype._applyShowComboBoxFlag=function(){this.tabBar&&(this.tabBar.showComboBoxFlag=this.showComboBoxFlag)},t.prototype._applyNewTabButtonFlag=function(){-1!==this.displayStyle.indexOf("strip")&&this.tabBar&&(this.tabBar.newTabButtonFlag=this.newTabButtonFlag)},t.prototype._applyAutoCloseFlag=function(){this.tabBar&&(this.tabBar.autoCloseFlag=this.autoCloseFlag)},t.prototype._applyAutoNewTabFlag=function(){this.tabBar&&(this.tabBar.autoNewTabFlag=this.autoNewTabFlag)},t.prototype._applyPosition=function(){this.tabBar&&(this.tabBar.position=this.position)},t.prototype._applyTabButtonDirection=function(){this.tabBar&&(this.tabBar.tabButtonDirection=this.tabButtonDirection)},t.prototype._applyShowButtonLabelFlag=function(){this.tabBar&&(this.tabBar.showButtonLabelFlag=this.showButtonLabelFlag)},t.prototype._applyResponsiveFlag=function(){this.tabBarDOMContainer&&(this.responsiveFlag?this.tabBarDOMContainer.removeAttribute("no-responsiveness"):this.tabBarDOMContainer.setAttributeNode(document.createAttribute("no-responsiveness"))),this.tabBar&&(this.tabBar.responsiveFlag=this.responsiveFlag)},t.prototype._applyUsePaddingFlag=function(){this.usePaddingFlag?this.tabPanelContainer.removeAttribute("no-padding"):this.tabPanelContainer.setAttributeNode(document.createAttribute("no-padding"))},t.prototype._applyDisabled=function(t){e.prototype._applyDisabled.call(this),this.disabled?(this.elements.contentDisabler||(this.elements.contentDisabler=s.createContentDisablerDiv()),this.elements.container.appendChild(this.elements.contentDisabler)):this.elements.contentDisabler&&this.elements.container.removeChild(this.elements.contentDisabler)},t.prototype._applyTouchMode=function(e){var t=this._getCurrentTouchMode();this.tabBar&&(this.tabBar.touchMode=t),!0===t?(this.tabPanelContainer.setAttributeNode(document.createAttribute("touch-mode")),this.tabBarDOMContainer.setAttributeNode(document.createAttribute("touch-mode"))):(this.tabPanelContainer.removeAttribute("touch-mode"),this.tabBarDOMContainer.removeAttribute("touch-mode"))},t.prototype._applyDisplayStyle=function(){this.tabBar&&this.displayStyle&&this.tabPanelContainer&&(this.tabBar.displayStyle=this.displayStyle,-1!==this.displayStyle.indexOf("panel")&&this.tabPanelContainer.addClassName("wux-controls-tabbar-panel"),-1!==this.displayStyle.indexOf("strip")?(this.tabPanelContainer.addClassName("wux-controls-tab-strip"),-1!==this.displayStyle.indexOf("strip-box")&&this.tabPanelContainer.addClassName("wux-controls-tab-strip-box")):(this.tabPanelContainer.removeClassName("wux-controls-tab-strip"),this.tabPanelContainer.removeClassName("wux-controls-tab-strip-box")),-1!==this.displayStyle.indexOf("vertical")?this.tabBarDOMContainer&&this.tabPanelContainer&&(this.elements.container.setAttributeNode(document.createAttribute("vertical")),this.tabBarDOMContainer.setAttributeNode(document.createAttribute("vertical")),this.tabPanelContainer.addClassName("wux-controls-tabbar-vertical")):this.tabBarDOMContainer&&this.tabPanelContainer&&(this.elements.container.removeAttribute("vertical"),this.tabBarDOMContainer.removeAttribute("vertical"),this.tabPanelContainer.removeClassName("wux-controls-tabbar-vertical")),this.redrawTabBar())},t.prototype._applyMultiSelFlag=function(){this.tabBar&&(this.tabBar.multiSelFlag=this.multiSelFlag,this._applyDisplayStyle(),this._applyMultiSelLayout())},t.prototype._applyMultiSelLayout=function(e){if("horizontal"===e&&"vertical"===this.multiSelLayout&&this._updateMultiSelLayoutCSS(!0),"horizontal"===this.multiSelLayout&&this.multiSelFlag)return this.tabPanelContainer.addClassName("wux-controls-tab-horizontalMultiSelLayout"),void this._updateMultiSelLayoutCSS();this.tabPanelContainer.removeClassName("wux-controls-tab-horizontalMultiSelLayout")},t.prototype._applyValue=function(e){if(e)for(var t=this.getIndexesFromValues(e),i=0;i<t.length;i++)this.tabBar.pinnedList&&-1!==this.tabBar.pinnedList.indexOf(this.getPageValueFromIndex(t[i]))||this._hideContent(this.getPageValueFromIndex(t[i]));if(this.tabBar){this.tabBar.value=this.value,d.call(this);var n=this.getIndexesFromValues(this.value);n=n.sort();for(var s=0;s<n.length;s++)this._showContent(this.getPageValueFromIndex(n[s]));this.redrawTabBar(),this._checkForMultiSelection(),this._updateMultiSelLayoutCSS(),this.fire("change")}},t.prototype._updateMultiSelLayoutCSS=function(e){if("horizontal"===this.multiSelLayout||e){var t=void 0,i=-1;for(var n in this._tabContent)this._tabContent[n].content.classList.remove("wux-controls-tab-lastVisibleContent"),this._tabContent[n].content.classList.remove("wux-controls-tab-onlyVisibleContent"),(this.value.indexOf(this._tabContent[n].value)>-1||this.tabBar.pinnedList&&this.tabBar.pinnedList.indexOf(this._tabContent[n].value)>-1)&&this._tabContent[n].index>i&&(t=this._tabContent[n].content,i=this._tabContent[n].index);!e&&t&&(t.classList.add("wux-controls-tab-lastVisibleContent"),this._isInMultiSelection()||t.classList.add("wux-controls-tab-onlyVisibleContent"))}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("tabBar")&&this._applyTabBar(t.tabBar),this.isDirty("tabBarDOMContainer")&&this._applyTabBarDOMContainer(t.tabBarDOMContainer),this.isDirty("tabPanelContainer")&&this._applyTabPanelContainer(t.tabPanelContainer),this.isDirty("showComboBoxFlag")&&this._applyShowComboBoxFlag(),this.isDirty("displayStyle")&&this._applyDisplayStyle(),this.isDirty("value")&&this._applyValue(t.value),this.isDirty("multiSelFlag")&&this._applyMultiSelFlag(),this.isDirty("multiSelLayout")&&this._applyMultiSelLayout(t.multiSelLayout),this.isDirty("reorderFlag")&&this._applyReorderFlag(),this.isDirty("newTabButtonFlag")&&this._applyNewTabButtonFlag(),this.isDirty("autoCloseFlag")&&this._applyAutoCloseFlag(),this.isDirty("autoNewTabFlag")&&this._applyAutoNewTabFlag(),this.isDirty("position")&&this._applyPosition(),this.isDirty("tabButtonDirection")&&this._applyTabButtonDirection(),this.isDirty("showButtonLabelFlag")&&this._applyShowButtonLabelFlag(),this.isDirty("responsiveFlag")&&this._applyResponsiveFlag(),this.isDirty("usePaddingFlag")&&this._applyUsePaddingFlag()},t.prototype._isInMultiSelection=function(){if(this.tabPanelContainer){var e=[],t=0;if(this.value&&(t=this.value.length),this.tabBar.pinnedList){for(var i=0;i<this.tabBar.pinnedList.length;i++)-1!==this.value.indexOf(this.tabBar.pinnedList[i])&&e.push(this.tabBar.pinnedList[i]);t=t+this.tabBar.pinnedList.length-e.length}return t>1}},t.prototype._checkForMultiSelection=function(){this._isInMultiSelection()?this.tabPanelContainer.addClassName("wux-controls-tab-multiSelection"):this.tabPanelContainer.removeClassName("wux-controls-tab-multiSelection")},t.prototype.getPageCount=function(){return this.tabBar.getTabCount()},t.prototype.getVisiblePageCount=function(){return this.tabBar.getVisibleTabCount()},t.prototype.getPageContent=function(e){return this.getPageContentFromIndex(e)},t.prototype.getPageContentFromValue=function(e){for(var t in this._tabContent)if(this._tabContent[t].value===e)return this._tabContent[t].content},t.prototype.containsContent=function(e){for(var t in this._tabContent)if(this._tabContent[t].content===e)return!0;return!1},t.prototype.getPageContentFromIndex=function(e){for(var t in this._tabContent)if(this._tabContent[t].index===e)return this._tabContent[t].content},t.prototype._setContentIdFromValue=function(e,t){void 0!==e.id&&null!==e.id&&""!==e.id||(e.id=t)},t.prototype.setPageContentFromIndex=function(e,t){if(this._tabContent&&this._tabContent.length>e){var n=e;if(this._tabContent[n].index!==e)for(var s=0;s<this._tabContent.length;s++)if(this._tabContent[s].index===e){n=s;break}var o=this._tabContent[n].content;if(i.is(t,"element")&&(t=new i.extendElement(t)),o!==t)return t._tabId=this._tabContent[n].value,t.inject(o,"before"),"none"===o.style.display&&t.setStyle("display","none"),this._tabContent[n].content=t,o.remove()}},t.prototype.setPageContentFromValue=function(e,t){for(var n,s=0,o=this._tabContent.length;s<o;++s)if(this._tabContent[s].value===e){i.is(t,"element")&&(t=new i.extendElement(t));var l=this.tabPanelContainer.getChildren();if(0===l.length)t.inject(this.tabPanelContainer);else if((n=this._tabContent[s].content)&&n.parentNode)t.inject(n,"before");else{for(var a=void 0,r=this._tabContent[s].index,h=0,u=0;u<o;++u)this._tabContent[u].content&&this._tabContent[u].content.parentNode&&this._tabContent[u].index<r&&this._tabContent[u].index>=h&&(a=this._tabContent[u].content,h=this._tabContent[u].index);a?(a=a.getContent?a.getContent():a,t.inject(a,"after")):t.inject(l[0],"before")}n&&n.parentNode&&n.remove(),-1===this.value.indexOf(e)&&t.setStyle("display","none"),t._tabId=e,this._setContentIdFromValue(t,e),this._tabContent[s].content=t;break}return n},t.prototype.getPageIndexFromValue=function(e){for(var t in this._tabContent)if(this._tabContent[t].value===e)return this._tabContent[t].index},t.prototype.getOptionFromButton=function(e,t){return this.tabBar.getOptionFromButton(e,t)},t.prototype.setOptionFromButton=function(e,t,i){this.tabBar.setOptionFromButton(e,t,i)},t.prototype.getPageValueFromIndex=function(e){for(var t in this._tabContent)if(void 0!==this._tabContent[t].index&&this._tabContent[t].index===e)return this._tabContent[t].value},t.prototype.add=function(e){var t=this.tabBar.add({label:e.label,index:e.index,isSelected:!1,value:e.value,icon:e.icon,allowClosableFlag:e.allowClosableFlag,allowContextualMenuFlag:e.allowContextualMenuFlag,showTitleFlag:e.showTitleFlag,tooltipInfos:e.tooltipInfos,touchMode:this._getCurrentTouchMode(),visibleFlag:e.visibleFlag});if(t)return u.call(this,e.content,t._index,t.value),e.isSelected?this._showContent(t.value):this._hideContent(t.value),e.isSelected&&(this.value=[t.value]),this._applyDisplayStyle(),{button:t,value:t.value}},t.prototype.addTab=function(e,t,i,n,s,o,l,a){var r={label:e,content:t,index:i,isSelected:n,value:s,icon:o,allowClosableFlag:l,showTitleFlag:a};return this.add(r)},t.prototype.update=function(e,t){if(this._tabContent&&this._tabContent.length>e){t.content&&this.setPageContentFromIndex(e,t.content);var i=this.getPageValueFromIndex(e);this.tabBar.updateTab(i,t)}},t.prototype.removeTab=function(e,t){var i=this.getIndexOf(e),n=this.getPageValueFromIndex(i);if(i>=0)return this.removeTabContent(n,t)},t.prototype.removeTabContent=function(e,t){var i=this.tabPanelContainer.getChildren(),n=this.getPageContentFromValue(e),s=this.getPageIndexFromValue(e);if(!(void 0===s||s>=i.length||s<0)){for(var o=0;o<this._tabContent.length;o++)if(void 0!==this._tabContent[o].index&&this._tabContent[o].index===s){this._tabContent[o].index=void 0,this._tabContent.splice(o,1);break}return!n||n.dsModel&&!n.dsModel.visibleFlag||(n.show(),n.remove()),this.tabBar&&this.tabBar.removeTab(e,t),d.call(this),n.visibleFlag&&n.show(),c.call(this),n}},t.prototype.clear=function(){for(;this.getPageCount()>0;)this.removeTab(this.getPageContentFromIndex(0))},t.prototype.getIndexOf=function(e){for(var t=0;t<this._tabContent.length;t++)if(this._tabContent[t].content===e)return this._tabContent[t].index;return-1},t.prototype.getIndexesFromValues=function(e){return this.tabBar._indexesFromValues(e)},t.prototype.redrawTabBar=function(){this.tabBar.redrawTabBar(),this.tabPanelContainer&&!this._noCSSOnParent&&this.tabPanelContainer.setStyles({width:"auto"})},t.prototype.isPinned=function(e){return!(!this.tabBar.pinFlag||!this.tabBar.pinnedList||-1===this.tabBar.pinnedList.indexOf(e))},t.prototype._showContent=function(e){var t=this.getPageContentFromValue(e);!t||t.dsModel&&!t.dsModel.visibleFlag||t.show()},t.prototype._showPinnedContent=function(){if(this.tabBar.pinnedList&&this.tabBar.pinnedList.length>0){var e=this.getIndexesFromValues(this.tabBar.pinnedList);e=e.sort();for(var t=0;t<e.length;t++){var i=this.getPageContentFromIndex(e[t]);i&&i.show()}}},t.prototype._hideContent=function(e){var t=this.getPageContentFromValue(e);t&&t.hide()},t.prototype._setTabVisibility=function(e,t){var i=this.getPageContentFromValue(e);i&&(t&&this._shouldContentBeDisplayed(e)?i.show():i.hide()),this.tabBar._setTabVisibility(e,t),this.redrawTabBar(),c.call(this)},t.prototype._shouldContentBeDisplayed=function(e){return-1!==this.value.indexOf(e)||this.tabBar.pinnedList&&-1!==this.tabBar.pinnedList.indexOf(e)},t.prototype._getTabVisibility=function(e){return this.tabBar._getTabVisibility(e)},t.prototype._redrawBorder=function(){var e,t=this.getIndexesFromValues(this.value).sort(),i=t;if(this.tabBar.pinnedList&&this.tabBar.pinnedList.length>0)for(var n=this.getIndexesFromValues(this.tabBar.pinnedList),o=0;o<n.length;o++)-1===i.indexOf(n[o])&&i.push(n[o]);else i=t;s.sortNumberArray(i);for(var l=0;l<i.length;l++)i.length>1&&i[l]!==i[i.length-1]?(e=this.getPageContentFromIndex(i[l]))&&e.addClassName("wux-controls-tab-borderSeparator"):i.length>1&&i[l]===i[i.length-1]?(e=this.getPageContentFromIndex(i[l]))&&e.removeClassName("wux-controls-tab-borderSeparator"):1===i.length&&i[l]===i[0]&&(e=this.getPageContentFromIndex(i[l]))&&e.removeClassName("wux-controls-tab-borderSeparator"),i.length>1&&i[l]===i[i.length-1]&&(e=this.getPageContentFromIndex(i[l]))&&e.removeClassName("wux-controls-tab-borderSeparator"),i.length>1&&i[l]===i[0]&&(e=this.getPageContentFromIndex(i[l]))&&e.addClassName("wux-controls-tab-borderSeparator")},t.prototype._handleEvents=function(){var e=this,t=this;this.tabBar.addEventListener("change",(function(i){e.elements.container&&!e.elements.container.offsetParent?i.dsModel=e:i.stopPropagation(),e.value=t.tabBar.value,e._redrawBorder(),e.fire("onSelectTab",i)})),this.tabBar.onEndTabDrag((function(i){h.call(t,i.valueButtonDragged,i.valueButtonTarget),e._redrawBorder()})),this.tabBar.onPinTab((function(){e._checkForMultiSelection(),e._showPinnedContent(),e._redrawBorder(),e._updateMultiSelLayoutCSS()})),this.tabBar.onUnpinTab((function(t){var i=t.value,n=e.getPageContentFromValue(i);n&&(n.setStyles({"background-color":""}),n&&-1===e.value.indexOf(i)&&n.hide(),e._redrawBorder(),e._checkForMultiSelection())})),this.tabBar.onRemoveTabEvent((function(t){e.tabBar===t.tabBar&&(e.autoCloseFlag&&(e.removeTabContent(t.value),e.value=e.tabBar.value,e._redrawBorder()),e.fire("close",t))})),this.tabBar.onPreNewTab((function(t){e.autoNewTabFlag&&u.call(e,new i.Element("div"),t.index,t.value)})),this.tabBar.addEventListener("tabButtonClick",(function(t){e.fire("activateTab",t)})),this._onResizeFun=function(){e.tabBar&&-1!==e.displayStyle.indexOf("vertical")&&e.tabBar._onContainerResized()},a.addResizeListener(this.elements.container,this._onResizeFun,0)},t}(o);function h(e,t){var i=this.getPageIndexFromValue(e),n=this.getPageIndexFromValue(t);if(i-n==1)this.tabPanelContainer.insertBefore(p.call(this,e),p.call(this,t));else if(n-i==1)this.tabPanelContainer.insertBefore(p.call(this,t),p.call(this,e));else{var s=p.call(this,t),o=p.call(this,e),l=void 0,a=void 0;s&&(l=s.nextSibling),o&&(a=o.nextSibling),l?this.tabPanelContainer.insertBefore(o,l):o.inject(this.tabPanelContainer),a?this.tabPanelContainer.insertBefore(s,a):s.inject(this.tabPanelContainer)}d.call(this)}function u(e,t,n){var s=this.tabPanelContainer.getChildren();if(e)if(i.is(e,"element")&&(e=new i.extendElement(e)),e._tabId=n,this._setContentIdFromValue(e,n),void 0===t||0===s.length)e.inject(this.tabPanelContainer);else{for(var o=void 0,l=0,a=0;a<this._tabContent.length;a++)this._tabContent[a].index<t&&this._tabContent[a].index>=l&&(o=this._tabContent[a].content,l=this._tabContent[a].index);if(o){var r=o.getContent?o.getContent():o;e.inject(r,"after")}else e.inject(this.tabPanelContainer.getChildren()[0],"before")}this._tabContent[this._tabContent.length]={content:e,value:n,index:t},d.call(this),c.call(this)}function c(){this.hideTabBarWhenOnlyOnePageFlag&&(this.getVisiblePageCount()<=1?(this.tabBar.hide(),this.getContent().setAttribute("no-tabbar","")):(this.tabBar.show(),this.getContent().removeAttribute("no-tabbar")))}function d(){if(this._tabContent)for(var e=0;e<this._tabContent.length;e++)if(this._tabContent.hasOwnProperty(e)){var t=this.getIndexesFromValues([this._tabContent[e].value]);void 0!==this._tabContent[e].value&&void 0!==t&&(this._tabContent[e].index=t[0])}}function p(e){var t=this.tabPanelContainer.childNodes;for(var i in t)if(t[i]._tabId===e||parseInt(t[i]._tabId)===e)return t[i]}return n.addClass(r,"tab"),r}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ColorCanvas",["require","exports","DS/Controls/Abstract","UWA/Core","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/Utilities/Color","DS/Utilities/Utils","DS/Utilities/WUXUWAUtils"],(function(e,t,i,n,s,o,l,a,r,h){"use strict";var u=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return h.extendingClassFlag||n.addKeyMapsAndCommands({esc:{keydown:"cancel"}},{cancel:function(){if(!this.handleEditionCancel)return{stopPropagation:!1};this.disabled||(this._inEdition=!1,this._canceling=!0,this.setPropertyFromUIInteraction("hsvValue",this.initialHsvValue),this._canceling=!1,this.fire("cancelEdit"))}}),n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:void 0,type:"string",advancedSetter:!0},hsvValue:{defaultValue:void 0,type:"array"},handleEditionCancel:{defaultValue:!0,type:"boolean",category:"Behavior"},coordinatesInBitmap:{defaultValue:void 0,type:"object"},subColorAttributeX:{defaultValue:"Hue",type:"string"},subColorAttributeY:{defaultValue:"Lightness",type:"string"},modulationValue:{defaultValue:100,type:"integer"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){var e=this,t="wux-controls-colorcanvas";e.elements.container.addClassName(t),e.elements.internalContainer=n.createElement("div").inject(e.elements.container),e.elements._canvas=n.createElement("canvas",{tabIndex:-1,class:t+"-canvas"}).inject(e.elements.internalContainer),this.buildCanvas(),e.elements._pickerCursor=n.createElement("div",{class:t+"-canvas-picker-cursor"}),e.elements._pickerCursor2=n.createElement("div",{class:t+"-canvas-picker-cursor2"}).inject(e.elements._pickerCursor),e.elements._pickerCursor.inject(e.elements.internalContainer),o.onNodeRendered(e.getContent(),(function(){e._updatePickerCursorPositionAndColor()}))},t.prototype._handleEvents=function(){var e=this,t=document;e.getContent()&&e.getContent().ownerDocument&&(t=e.getContent().ownerDocument);var i=function(t){if(!this.disabled&&e._inEdition){var i={x:t.clientX,y:t.clientY},n=e.elements._canvas.getBoundingClientRect();e.setPropertyFromUIInteraction("coordinatesInBitmap",e._getCanvasValuesFromCoordinates(i,n))}},n=function(l){e._inEdition=!1,e.beginEdit&&(e.fire("endEdit"),e.beginEdit=!1),o.removeEventOnElement(e,t,s.POINTERMOVE,i),o.removeEventOnElement(e,t,s.POINTERMOVE,n)};o.addEventOnElement(this,e.elements.internalContainer,s.POINTERDOWN,(function(l){if(!e.disabled){e._inEdition=!0,e.initialHsvValue=e.hsvValue,e.beginEdit||(e.fire("beginEdit"),e.beginEdit=!0);var a={x:l.clientX,y:l.clientY},r=e.elements._canvas.getBoundingClientRect();e.setPropertyFromUIInteraction("coordinatesInBitmap",e._getCanvasValuesFromCoordinates(a,r)),o.addEventOnElement(e,t,s.POINTERMOVE,i),o.addEventOnElement(e,t,s.POINTERUP,n)}})),o.addEventOnElement(this,e.elements.internalContainer,s.POINTERUP,n),o.addEventOnElement(this,e.elements.internalContainer,s.POINTERMOVE,i)},t.prototype._refreshModulationValue=function(){var e=this._computeModulationType();if(void 0!==this.hsvValue){var t=this.hsvValue,i=a.hsvToHsl(this.hsvValue),n=a.hsvToRgb(this.hsvValue),s=this.modulationValue;switch(e){case"Hue":s!==t[0]&&(s=t[0]);break;case"HslSaturation":s=i[1];break;case"Saturation":s=t[1];break;case"Value":s=t[2];break;case"Lightness":s=i[2];break;case"Red":s=n.r;break;case"Green":s=n.g;break;case"Blue":s=n.b}var o=this._computeHsvValueFromCoordinatesAndModulation();o[0]===t[0]&&o[1]===t[1]&&o[2]===t[2]||(this.modulationValue=s)}else this.modulationValue="Hue"===e?0:"Red"===e||"Green"===e||"Blue"===e?255:100},t.prototype._computeCoordinatesInBitmapFromValue=function(){if(void 0!==this.hsvValue){this._computingCoordinatesInBitmapFromValue=!0;var e=this.hsvValue,t=a.hsvToHsl(this.hsvValue),i=a.hsvToRgb(this.hsvValue),n={x:0,y:0};"Hue"===this.subColorAttributeX?n.x=e[0]:"Saturation"===this.subColorAttributeX?n.x=e[1]:"HslSaturation"===this.subColorAttributeX?n.x=t[1]:"Value"===this.subColorAttributeX?n.x=e[2]:"Lightness"===this.subColorAttributeX?n.x=t[2]:"Red"===this.subColorAttributeX?n.x=i.r:"Green"===this.subColorAttributeX?n.x=i.g:"Blue"===this.subColorAttributeX&&(n.x=i.b),"Hue"===this.subColorAttributeY?n.y=e[0]:"Saturation"===this.subColorAttributeY?n.y=e[1]:"HslSaturation"===this.subColorAttributeY?n.y=t[1]:"Value"===this.subColorAttributeY?n.y=e[2]:"Lightness"===this.subColorAttributeY?n.y=t[2]:"Red"===this.subColorAttributeY?n.y=i.r:"Green"===this.subColorAttributeY?n.y=i.g:"Blue"===this.subColorAttributeY&&(n.y=i.b),this.coordinatesInBitmap=n,this._computingCoordinatesInBitmapFromValue=!1}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),(this.isDirty("subColorAttributeX")||this.isDirty("subColorAttributeY"))&&(this.buildCanvas(),this._computeCoordinatesInBitmapFromValue(),this._updatePickerCursorPositionAndColor(),this._refreshModulationValue()),this.isDirty("value")&&this._applyValue()},t.prototype._applyHsvValue=function(){this._applyingHsvValue=!0,this._applyingValue||(this.value=a.hsvToHex(this.hsvValue)),this._applyingCoordinatesInBitmap||this._applyingModulationValue||(this._computeCoordinatesInBitmapFromValue(),this._canceling||this._refreshModulationValue()),void 0!==this.hsvValue&&null!==this.hsvValue?this.elements._pickerCursor.show():this.elements._pickerCursor.hide(),this._applyingHsvValue=!1},t.prototype._applyValue=function(){(this._applyingValue=!0,this._applyingHsvValue)||a.hsvToHex(this.hsvValue)!==this.value&&(this.hsvValue=a.hexToHsv(this.value));this.fire("change"),this._applyingValue=!1},t.prototype._computeModulationType=function(){return"Red"===this.subColorAttributeX?"Green"===this.subColorAttributeY?"Blue":"Green":"Green"===this.subColorAttributeX?"Red"===this.subColorAttributeY?"Blue":"Red":"Blue"===this.subColorAttributeX?"Red"===this.subColorAttributeY?"Green":"Red":"Hue"!==this.subColorAttributeX&&"Hue"!==this.subColorAttributeY?"Hue":"Saturation"===this.subColorAttributeX||"Saturation"===this.subColorAttributeY?"Value":"HslSaturation"===this.subColorAttributeX||"HslSaturation"===this.subColorAttributeY?"Lightness":"Value"===this.subColorAttributeX||"Value"===this.subColorAttributeY?"Saturation":"Lightness"===this.subColorAttributeX||"Lightness"===this.subColorAttributeY?"HslSaturation":void 0},t.prototype._setModulationValue=function(e){var t=this.hsvValue;void 0===t&&(t=[0,100,100]);var i=t,n=a.hsvToHsl(t),s=a.hsvToRgb(t);this._applyingModulationValue=!0;var o=this._computeModulationType();this.modulationValue=e,"Hue"===o?(i[0]=e,this.hsvValue=i):"Saturation"===o?(i[1]=e,this.hsvValue=i):"HslSaturation"===o?(n[1]=e,this.hsvValue=a.hslToHsv(n)):"Value"===o?(i[2]=e,this.hsvValue=i):"Lightness"===o?(n[2]=e,this.hsvValue=a.hslToHsv(n)):"Red"===o?(s.r=e,this.hsvValue=a.rgbToHsv(s.r,s.g,s.b)):"Green"===o?(s.g=e,this.hsvValue=a.rgbToHsv(s.r,s.g,s.b)):"Blue"===o&&(s.b=e,this.hsvValue=a.rgbToHsv(s.r,s.g,s.b)),this.buildCanvas(),this._updatePickerCursorPositionAndColor(),this._applyingModulationValue=!1},t.prototype._computeHsvValueFromCoordinatesAndModulation=function(){var e=[0,0,0],t=[void 0,void 0,void 0],i={r:0,g:0,b:0};"Hue"===this.subColorAttributeX?(e[0]=this.coordinatesInBitmap.x,t[0]=this.coordinatesInBitmap.x):"Saturation"===this.subColorAttributeX?e[1]=this.coordinatesInBitmap.x:"HslSaturation"===this.subColorAttributeX?t[1]=this.coordinatesInBitmap.x:"Value"===this.subColorAttributeX?e[2]=this.coordinatesInBitmap.x:"Lightness"===this.subColorAttributeX?t[2]=this.coordinatesInBitmap.x:"Red"===this.subColorAttributeX?i.r=this.coordinatesInBitmap.x:"Green"===this.subColorAttributeX?i.g=this.coordinatesInBitmap.x:"Blue"===this.subColorAttributeX&&(i.b=this.coordinatesInBitmap.x),"Hue"===this.subColorAttributeY?(e[0]=this.coordinatesInBitmap.y,t[0]=this.coordinatesInBitmap.y):"Saturation"===this.subColorAttributeY?e[1]=this.coordinatesInBitmap.y:"HslSaturation"===this.subColorAttributeX?t[1]=this.coordinatesInBitmap.y:"Value"===this.subColorAttributeY?e[2]=this.coordinatesInBitmap.y:"Lightness"===this.subColorAttributeY?t[2]=this.coordinatesInBitmap.y:"Red"===this.subColorAttributeY?i.r=this.coordinatesInBitmap.y:"Green"===this.subColorAttributeY?i.g=this.coordinatesInBitmap.y:"Blue"===this.subColorAttributeY&&(i.b=this.coordinatesInBitmap.y);var n,s=this.modulationValue,o=this._computeModulationType();return"Hue"===o?(e[0]=s,t[0]=s):"Saturation"===o?e[1]=s:"HslSaturation"===o?t[1]=s:"Value"===o?e[2]=s:"Lightness"===o?t[2]=s:"Red"===o?i.r=s:"Green"===o?i.g=s:"Blue"===o&&(i.b=s),n="Red"===o||"Green"===o||"Blue"===o?a.rgbToHsv(i.r,i.g,i.b):void 0!==t[2]&&void 0!==t[1]&&void 0!==t[0]?a.hslToHsv(t):e,void 0!==this.hsvValue&&void 0!==this.hsvValue[3]&&(n[3]=this.hsvValue[3]),n},t.prototype._applyCoordinatesInBitmap=function(){this._computingCoordinatesInBitmapFromValue?this._updatePickerCursorPositionAndColor():this._applyingCoordinatesInBitmap||(this._applyingCoordinatesInBitmap=!0,this.hsvValue=this._computeHsvValueFromCoordinatesAndModulation(),this._updatePickerCursorPositionAndColor(),this._applyingCoordinatesInBitmap=!1)},t.prototype._applyModulationValue=function(){this.buildCanvas()},t.prototype._applyTouchMode=function(){!0===this._getCurrentTouchMode()?this.elements._canvas.setAttributeNode(document.createAttribute("touch-mode")):this.elements._canvas.removeAttribute("touch-mode")},t.prototype._getCanvasValuesFromCoordinates=function(e,t){var i=100;"Red"===this.subColorAttributeX||"Green"===this.subColorAttributeX||"Blue"===this.subColorAttributeX?i=255:"Hue"===this.subColorAttributeX&&(i=360);var n=100;"Red"===this.subColorAttributeY||"Green"===this.subColorAttributeY||"Blue"===this.subColorAttributeY?n=255:"Hue"===this.subColorAttributeY&&(n=360);var s=r.clamp(0,t.width,e.x-t.left),o=r.clamp(0,t.height,t.height-(e.y-t.top));return{x:s/t.width*i,y:o/t.height*n}},t.prototype.setColorSubAttribute=function(e,t){if(this.subColorAttributeX===e)this.coordinatesInBitmap={x:t,y:this.coordinatesInBitmap.y};else if(this.subColorAttributeY===e)this.coordinatesInBitmap={x:this.coordinatesInBitmap.x,y:t};else{this._computeModulationType()===e&&this._setModulationValue(t)}},t.prototype.getColorSubAttribute=function(e){return this.subColorAttributeX===e?this.coordinatesInBitmap.x:this.subColorAttributeY===e?this.coordinatesInBitmap.y:this._computeModulationType()===e?this.modulationValue:void 0},t.prototype.buildCanvas=function(){var e,t,i,n=this.elements._canvas.getContext("2d");switch(this.subColorAttributeX){case"Hue":this.elements._canvas.width=361,e=0;break;case"Saturation":case"HslSaturation":this.elements._canvas.width=101,e=1;break;case"Value":case"Lightness":this.elements._canvas.width=101,e=2;break;case"Red":this.elements._canvas.width=256,e=0;break;case"Green":this.elements._canvas.width=256,e=1;break;case"Blue":this.elements._canvas.width=256,e=2;break;default:this.elements._canvas.width=101}switch(this.subColorAttributeY){case"Hue":this.elements._canvas.height=361,t=0;break;case"Saturation":case"HslSaturation":this.elements._canvas.height=101,t=1;break;case"Value":case"Lightness":this.elements._canvas.height=101,t=2;break;case"Red":this.elements._canvas.height=256,t=0;break;case"Green":this.elements._canvas.height=256,t=1;break;case"Blue":this.elements._canvas.height=256,t=2;break;default:this.elements._canvas.height=101}var s,o=this.elements._canvas.width,l=this.elements._canvas.height,r=l-1,h=this.modulationValue;if(s="Red"===this.subColorAttributeX||"Green"===this.subColorAttributeX||"Blue"===this.subColorAttributeX?void 0:"Lightness"===this.subColorAttributeX||"Lightness"===this.subColorAttributeY?a.hslToRgb:a.hsvToRgb,n.clearRect(0,0,o,l),void 0!==e&&void 0!==t){if(e+t===1)i=2;else if(e+t===2)i=1;else{if(e+t!==3)return;i=0}for(var u=n.createImageData(o,l),c=0,d=0;d<l;d++)for(var p=0;p<o;p++){var m=[0,0,0];m[e]=p,m[t]=r-d,m[i]=h;var g=void 0;g=s?s(m):{r:m[0],g:m[1],b:m[2]},u.data[c]=g.r,u.data[c+1]=g.g,u.data[c+2]=g.b,u.data[c+3]=255,c+=4}n.putImageData(u,0,0)}},t.prototype._updatePickerCursorPositionAndColor=function(){if(void 0!==this.coordinatesInBitmap&&void 0!==this.hsvValue){var e=100;"Red"===this.subColorAttributeX||"Green"===this.subColorAttributeX||"Blue"===this.subColorAttributeX?e=255:"Hue"===this.subColorAttributeX&&(e=360);var t=100;"Red"===this.subColorAttributeY||"Green"===this.subColorAttributeY||"Blue"===this.subColorAttributeY?t=255:"Hue"===this.subColorAttributeY&&(t=360);var i=this.elements._canvas.getBoundingClientRect(),n=this.coordinatesInBitmap.x/e*i.width,s=i.height-this.coordinatesInBitmap.y/t*i.height;this.elements._pickerCursor.setStyle("left",n+"px"),this.elements._pickerCursor.setStyle("top",s+"px"),this.elements._pickerCursor.setStyle("background",a.colorToCssColor(a.hsvToRgb(this.hsvValue)))}},t}(i);return l.addClass(u,"colorCanvas"),u})),define("DS/Controls/Knob",["UWA/Core","UWA/Event","UWA/Controls/Abstract","DS/Core/Core","UWA/Controls/Scroller","DS/Utilities/Css3D","DS/Controls/Stack","DS/Controls/Gauge","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents"],(function(e,t,i,n,s,o,l,a,r,h){"use strict";var u=i.extend({defaultOptions:{snap:0,value:0,stepValue:1,minValue:0,maxValue:360,graduations:12,graduationsLabel:!1,dynamicGraduations:!1,activeGraduationsColor:"#00FFF5",inactiveGraduationsColor:"#FF0000",graduationsLabelColor:"black",knobIndicator:"dot",knobMaterial:"pearl",turn:null,onChange:null,interactionMode:"rotate",theme:{display:"inline-block",fontSize:10,size:80}},init:function(e){this._parent(e),this._modelEvents=new h,this.startDeg=0,this.currentDeg=0,this.rotation=0,this.lastDeg=0,this._value=this.options.value,this._delta=this.options.maxValue-this.options.minValue,this._knobSize=parseInt(.75*this.options.theme.size,10),this._graduationSize={width:parseInt((this.options.theme.size-this._knobSize)/2,10),height:parseInt((this.options.theme.size-this._knobSize)/5,10)},this._buildSkeleton(),this._buildScaling(),this._attachBehaviors(),this._rotateKnob(this._valueToDeg(this.options.value))},_valueToDeg:function(e){return(e-this.options.minValue)/this._delta*360},_degToValue:function(e){return e/360*this._delta+this.options.minValue},_buildScaling:function(){var t,i=180/Math.PI,n=0,s=this.options.graduations,o=e.typeOf(s);t="array"===o?s.length:s;for(var l=0;l<t;l++){var a,r;if(this.options.dynamicGraduations)r="hsl("+(120-120*l/t)+", 100%, 50%)",a=0;else r=this.options.inactiveGraduationsColor,a=1;n="array"===o?this._valueToDeg(s[l].value):l*(360/t);var h=parseInt(this._graduationSize.height/4,10);this.options.dynamicGraduations&&(h=0);var u=new e.Element("div",{class:"wux-knob-scale",styles:{boxShadow:"inset 0 0 "+h+"px black",borderRadius:h,opacity:a}}),c=new e.Element("div",{styles:{position:"relative"}}).inject(u);if(this.options.graduationsLabel){var d,p;if(d="array"===o?s[l].label:this._degToValue(parseFloat(n)),"array"===o)switch(l){case 0:p=-parseInt(1.5*this.options.theme.fontSize,10);break;case t-1:p=0;break;default:p=-parseInt(this.options.theme.fontSize/2,10)}else p=-parseInt(this.options.theme.fontSize/2,10);new e.Element("div",{class:"wux-knob-scale-label",styles:{position:"absolute",transform:"rotate("+-n+"deg)",top:p,fontSize:this.options.theme.fontSize,whiteSpace:"nowrap",color:this.options.graduationsLabelColor},html:d.toString()}).inject(c)}var m=-Math.sin(n/i)*(this.options.theme.size-2*this._graduationSize.width)/2+this.options.theme.size/2-this._graduationSize.height/2+this.options.theme.fontSize,g=Math.cos((180-n)/i)*(this.options.theme.size-2*this._graduationSize.width)/2+(this.options.theme.size-this._graduationSize.width)/2+this.options.theme.fontSize;u.setStyles({backgroundColor:r,transform:"rotate("+n+"deg)",top:parseInt(m,10),left:parseInt(g,10),width:this._graduationSize.width,height:this._graduationSize.height}).inject(this.elements.container)}},turn:function(t){var i,n=this,s=this.elements.container.getElements(".wux-knob-scale"),o=-1;if((i=Math.ceil(s.length*t))===o)return!1;o=i,s.forEach((function(s,o){var l={},a=function(){s.addClassName("active"),n.options.dynamicGraduations?l.opacity=1:l.backgroundColor=n.options.activeGraduationsColor,s.setStyles(l)},r=function(){s.removeClassName("active"),n.options.dynamicGraduations?l.opacity=0:(l.opacity=1,l.backgroundColor=n.options.inactiveGraduationsColor),s.setStyles(l)},h=t*n._delta+n.options.minValue,u=n._degToValue(h),c=n.options.graduations;"array"===e.typeOf(c)?c[o].value<=u?a():r():o<i?a():r()}))},_buildSkeleton:function(){this.elements.container=e.Element("div",{styles:{position:"relative",height:this.options.theme.size+2*this.options.theme.fontSize,width:this.options.theme.size+2*this.options.theme.fontSize,display:this.options.theme.display}}),this.elements.control=e.Element("div",{class:"wux-knob-control wux-ui-material-"+this.options.knobMaterial,styles:{position:"absolute",top:"50%",left:"50%",marginTop:-this._knobSize/2,marginLeft:-this._knobSize/2}}).inject(this.elements.container);var t="";this.options.theme.size>50&&(t=" wux-ui-size-big"),this.elements.knob=e.Element("div",{class:"wux-knob wux-ui-indicator-"+this.options.knobIndicator+" wux-ui-material-"+this.options.knobMaterial+t,styles:{height:this._knobSize,width:this._knobSize,borderRadius:"100%"}}).inject(this.elements.control),this.elements.knobTop=e.Element("div",{class:"wux-knob-top"}),this.elements.knobBottom=e.Element("div",{class:"wux-knob-bottom"})},_attachBehaviors:function(){var t=this,i=this.elements.container,n=this.elements.knob;i.addEvent(r.POINTERDOWN,(function(i){i.preventDefault();var s,o,l,a=n.getDimensions(),h=n.getOffsets(),u=h.y+a.height/2,c=h.x+a.width/2,d=180/Math.PI,p=e.extendElement(document);if("vertical-slide"===t.options.interactionMode){var m,g=1;m=window.setInterval((function(){var e=Math.abs(s);g=e<200?Math.min(parseInt(e/200*5,10),5):5,s>0&&t.increment(g),s<0&&t.decrement(g)}),50)}p.addEvent(r.POINTERMOVE,(function(e){s=u-e.pageY,"rotate"===t.options.interactionMode&&(o=c-e.pageX,l=Math.atan2(s,o)*d,t._rotateKnob(l))})),p.addEvent(r.POINTERUP,(function(){window.clearInterval(m),p.removeEvent(r.POINTERMOVE),p.removeEvent(r.POINTERUP),t.rotation=t.currentDeg,t.startDeg=-1}))})),e.Element.addEvent.call(t.elements.container,"mousewheel",(function(i){var n=e.Event.wheelDelta(i);i.shiftKey&&(n*=5),t.currentDeg+=n,t._rotateKnob(t.currentDeg)}))},increment:function(e){var t=this.getValue()+e*this.options.stepValue;console.log("increment",this,this.getValue(),t,e),this.setValue(t)},decrement:function(e){var t=this.getValue()-e*this.options.stepValue;console.log("decrement",this,this.getValue(),t,e),this.setValue(t)},getValue:function(){return this._value},_rotateKnob:function(e){e<0&&(e=360+e),-1===this.startDeg&&(this.startDeg=e);var t=Math.floor(e-this.startDeg+this.rotation);if(t<0?t=360+t:t>359&&(t%=360),this.options.snap&&t<this.options.snap&&(t=0),Math.abs(t-this.lastDeg)>180)return!1;this.currentDeg=t,this.lastDeg=t,this.setValue(this._degToValue(this.currentDeg))},setValue:function(e,t){void 0===t&&(t=!0);var i=this.elements.knob;this._value=e,this.currentDeg=this._valueToDeg(e),i.setStyle("transform","rotate("+this.currentDeg+"deg)"),this.options.turn||(this.options.turn=this.turn),this.options.turn.call(this,this.currentDeg/360),t&&(this.options.onChange&&this.options.onChange.call(this,this.getValue()),this._modelEvents.publish({context:this,event:"change",data:this}))},addEvent:function(e,t){return this._subscribe(e,t)},_removeEvent:function(e){return this._modelEvents.unsubscribe(e)},_removeEventListener:function(e){return this._modelEvents.unsubscribe(e)},addEventOnce:function(e,t){return this._modelEvents.subscribeOnce({event:e},t)},addEventListener:function(e,t){return this._subscribe(e,t)},_subscribe:function(e,t){return this._modelEvents.subscribe({event:e},t)}});return e.namespace("WUX/Controls/Knob",u)})),define("DS/Controls/SmartInput",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Controls/Form","UWA/Controls/ToolTip","DS/Controls/Stack","DS/Controls/Knob","UWA/Controls/DatePicker","DS/Controls/Switch"],(function(e,t,i){"use strict";var n=i.extend({defaultOptions:{value:[0,0,0],labels:["x","y","z"],inputType:"number",onChange:null},init:function(e){this._parent(e),this._inputs=[],this._buildView(),this.setValue(this.options.value),this._value=this.getValue()},setValue:function(e){var t=this;this._value=[],e.forEach((function(e,i){t._inputs[i]&&t._inputs[i].setAttribute("value",e),t._value.push(e)}))},getValue:function(){this._value=[];var e=this;return e._inputs.forEach((function(t,i){var n=t.value;e._value.push(n)})),this._value},_buildView:function(){this.elements.container=new e.Element("div",{class:"wux-input-vector"});var t=this;this.options.value.forEach((function(i,n){var s=new e.Element("div",{class:"wux-input-vector-label",styles:{textAlign:"right",display:"inline-block"}}).inject(t.elements.container),o=t.options.labels[n];o&&s.set({text:o+":",styles:{minWidth:40}});var l=new e.Element("input",{type:t.options.inputType,styles:{width:50,height:14},events:{change:function(){t.options.onChange&&t.options.onChange.call(t,t.getValue())}}}).inject(t.elements.container);t._inputs.push(l)}))}}),s=i.extend({defaultOptions:{value:[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],onChange:null},init:function(e){this._parent(e);var t=this.options.value,i=this;this._upVector=new n({labels:["up"],value:t[0],inputType:"text",onChange:function(){i._onChange()}}),this._rightVector=new n({labels:["right"],value:t[1],inputType:"text",onChange:function(){i._onChange()}}),this._dirVector=new n({labels:["dir"],value:t[2],inputType:"text",onChange:function(){i._onChange()}}),this._posVector=new n({labels:["pos"],value:t[3],inputType:"text",onChange:function(){i._onChange()}}),this._buildView()},_onChange:function(){console.log("-"),this.options.onChange&&this.options.onChange.call(this,this.getValue())},setValue:function(e){this._value=[],this._upVector.setValue(e[0]),this._righVector.setValue(e[1]),this._dirVector.setValue(e[2]),this._posVector.setValue(e[3]),this._value.push(this._upVector.getValue()),this._value.push(this._rightVector.getValue()),this._value.push(this._dirVector.getValue()),this._value.push(this._posVector.getValue())},getValue:function(){return this._value=[],this._value.push(this._upVector.getValue()),this._value.push(this._rightVector.getValue()),this._value.push(this._dirVector.getValue()),this._value.push(this._posVector.getValue()),console.log(this._value),this._value},_buildView:function(){this.elements.container=new e.Element("div",{class:"wux-controls-matrix4x4"}),this.elements.container.addContent(this._upVector).addContent(this._rightVector).addContent(this._dirVector).addContent(this._posVector)}}),o=i.extend({defaultOptions:{value:10,minValue:0,maxValue:100,stepValue:1,onChange:null},init:function(e){this._parent(e),this._value=this.options.value,this._buildView()},_buildView:function(){var t=this;this.elements.container=new e.Element("ul",{class:"wux-input-distance"});var i=this.options.minValue.toString();this.options.minLabel&&(i=this.options.minLabel),this.elements.minValue=new e.Element("li",{html:i}).inject(this.elements.container),this.elements.inputRangeContainer=new e.Element("li",{}).inject(this.elements.container),this.elements.inputRange=new e.Element("input",{type:"range",min:this.options.minValue,max:this.options.maxValue,step:this.options.stepValue,events:{change:function(e){console.log("change"),t._value=t.elements.inputRange.value,t.elements.valueContainer.setHTML(t._value),t.options.onChange&&t.options.onChange.call(t,t._value),t.dispatchEvent("onChange")}}}).inject(this.elements.inputRangeContainer);var n=this.options.maxValue.toString();this.options.maxLabel&&(n=this.options.maxLabel),this.elements.maxValue=new e.Element("li",{html:n}).inject(this.elements.container),this.elements.valueContainer=new e.Element("div",{html:this._value.toString(),styles:{color:"#444",minWidth:50,fontWeight:"bold",backgroundColor:"#FFF",borderRadius:5}}).inject(this.elements.container)}});var l=i.extend({defaultOptions:{position:{parent:null,x:0,y:0},label:"Value",name:"smart_input",unit:"",kind:"string",value:void 0,inPlaceEdit:!1,editEvent:"click",rules:{minLength:null,maxLength:null,minValue:null,maxValue:null,unit:null,dataType:null},onConfirm:null,onCancel:null,onChange:null},init:function(e){this._parent(e),console.warn("deprecated","Please DO NOT use anymore Controls/SmartInput, use SmartInputs/* instead")},buildView:function(){var t=this;if(this._smartInput=function(t){var i,l,a=t.name;switch(t.kind){case"text":l=50,i=new e.Controls.Form({fields:[{type:"text",name:a,label:t.label,value:t.value}]});break;case"combo":l=50,i=new e.Controls.Form({fields:[{type:"range",name:a,label:t.label,value:t.value,step:t.rules.stepValue,min:t.rules.minValue,max:t.rules.maxValue}]});break;case"switch":l=50,i=new WUX.Controls.Switch({value:t.value,label:t.label,onChange:t.onChange});break;case"translation":l=40,i=new n({value:t.value,labels:["Tx","Ty","Tz"],onChange:t.onChange});break;case"matrix4x4":l=40;var r={};t.value&&(r.value=t.value),r.onChange=t.onChange,i=new s(r);break;case"vector":l=40,i=new n({value:t.value,onChange:t.onChange});break;case"rotation":l=40,i=new n({value:t.value,labels:["Rx","Ry","Rz"],onChange:t.onChange});break;case"direction":l=40,i=new n({value:t.value,labelX:"up",labelY:"right",labelZ:"dir",onChange:t.onChange});break;case"angle":l=100,void 0===t.value&&(t.value=0),i=new WUX.Controls.Knob({graduationsLabel:!0,value:t.value,minValue:0,maxValue:2*Math.PI,graduations:[{label:"0",value:0},{label:"&pi;/2",value:Math.PI/2},{label:"&pi;",value:Math.PI},{label:"3&pi;/2",value:3*Math.PI/2},{label:"2&pi;",value:2*Math.PI}],graduationsLabelColor:"black",activeGraduationsColor:"#3CF",inactiveGraduationsColor:"#CCC",knobIndicator:"line",knobMaterial:"pearl",onChange:t.onChange});break;case"intensity":void 0===t.value&&(t.value=0),l=100,i=new WUX.Controls.Knob({knobMaterial:"pearl",value:t.value,graduations:20,dynamicGraduations:!0,minValue:t.rules.minValue,maxValue:t.rules.maxValue,onChange:t.onChange});break;case"systemColor":l=24,i=new e.Element("input",{type:"color",styles:{height:12,padding:0,margin:0,border:"none"},name:a,value:t.value});break;case"distance":l=50,i=new o({value:t.value,minValue:t.rules.minValue,maxValue:t.rules.maxValue,stepValue:t.rules.stepValue,onChange:t.onChange});break;case"number":l=50,i=new e.Element("input",{type:"number",min:t.rules.minValue,max:t.rules.maxValue,step:t.rules.stepValue,name:a,value:t.value});break;case"date":i=new e.Controls.DatePicker({type:"date",format:"%e %b %Y"});break;default:l=50,i=new e.Controls.Form({fields:[{type:t.kind,name:a,label:t.label,value:t.value}]})}return i.getHeight=function(){return l},i}(this.options),this.options.inPlaceEdit)this.elements.container=new e.Element("div",{class:"wux-smartinput",html:this._smartInput});else{var i,l=new e.Element("button",{class:"wux-smartinput-button wux-smartinput-button-valid",html:"V",events:{click:function(){t._onConfirm.call(t)}}}),a=new e.Element("button",{class:"wux-smartinput-button wux-smartinput-button-cancel",html:"X",events:{click:function(){t._onCancel.call(t)}}}),r=this._smartInput.getHeight(),h=new WUX.Controls.Stack({styles:{height:r}});h.append(this._smartInput,{styles:{height:r,lineHeight:r+"px",verticalAlign:"middle"}}),h.append(l,{styles:{height:r,lineHeight:r+"px",verticalAlign:"middle"}}),h.append(a,{styles:{height:r,lineHeight:r+"px",verticalAlign:"middle"}}),i=t.options.value?this.options.value.toString()+" "+this.options.unit:this._smartInput.getValue(),this.elements.container=new e.Element("div",{class:"wux-smartinput",html:i}),this._tooltip=new e.Controls.ToolTip(this.elements.container,h,{className:"wux-smartinput-tooltip",showOver:!1,offsetX:10,offsetY:0}),this.elements.container.addEvent(this.options.editEvent,(function(i){e.extendElement(document).getElements(".wux-smartinput-tooltip").forEach((function(e){e.hide()}));var n=t.elements.container.getOffsets();n.y+=20,t._tooltip.show();var s=t._tooltip.elements.tooltip;s.setStyle("position","fixed"),s.show(),s.setPosition(n),t.options.relativePosition&&t._tooltip.elements.tooltip.inject(t.options.relativePosition)}))}},_onConfirm:function(){var e=this.getValue();this.elements.container.setHTML(e+" "+this.options.unit),this.options.onConfirm&&this.options.onConfirm.call(this,{name:this.options.name,value:e}),this._tooltip.hide()},getValue:function(){var e;switch(this.options.kind){case"number":case"distance":e=this._smartInput._value;break;case"systemColor":e=this._smartInput.value;break;case"translation":case"rotation":case"angle":case"intensity":case"vector":case"matrix4x4":case"angle":e=this._smartInput.getValue().toString();break;case"switch":e=this._smartInput.getValue();break;case"date":e=this._smartInput.getDate().toString(),console.log(e);break;default:e=this._smartInput.getFormValue(this.options.name)}return e},_onCancel:function(){this.options.onCancel&&this.options.onCancel.call(this),this._tooltip.hide()},onConfirm:function(e){e&&(this.options.onConfirm=e)},onCancel:function(e){e&&(this.options.onCancel=e)}});return e.namespace("WUX/Controls/SmartInput",l)})),define("DS/Controls/ThumbnailView",["UWA/Core","UWA/Controls/Abstract","DS/Layouts/GridEngineCellAbstract","DS/Controls/ViewBase","DS/Menu/ContextualMenu","DS/Core/PointerEvents","DS/Controls/Toggle","DS/Utilities/Dom"],(function(e,t,i,n,s,o,l,a){"use strict";return n.extend({defaultOptions:{size:"small",view:"thumbnail",menu:[]},init:function(t){this._parent(t);var i,n=this,a=!1,r=!1;this._isHighlighted=!1,this.elements.icon=new e.Element("div",{class:"wux-controls-"+this.options.view+"-icon",styles:{backgroundImage:"",backgroundSize:"cover"}}).inject(this.elements.cartoucheContent),this.elements.badgeTopRight=new e.Element("div",{class:"wux-controls-thumbnail-badge-top-right"}).inject(this.elements.cartoucheContent),this.elements.badgeBottomRight=new e.Element("div",{class:"wux-controls-thumbnail-badge-bottom-right"}).inject(this.elements.cartoucheContent),this.elements.menu.addEvent("mouseenter",(function(e){a=!0})),this.elements.menu.addEvent("mouseleave",(function(e){a=!1})),this.elements.cartouche.addEvent("mouseenter",(function(e){r=!0})),this.elements.cartouche.addEvent("mouseleave",(function(e){r=!1,n.elements.container.removeClassName("wux-ui-state-active")})),this.elements.cartouche.addEvent("mousemove",(function(e){clearTimeout(i),e.target===n.elements.menu||n.elements.container.hasClassName("wux-ui-state-active")||n.elements.container.removeClassName("wux-ui-state-active"),i=setTimeout((function(){a||(r&&e.target!==n.elements.menu?n.elements.container.addClassName("wux-ui-state-active"):(clearTimeout(i),n.elements.container.removeClassName("wux-ui-state-active")))}),20)})),this.elements.checkbox=new l({checkFlag:!1,disabled:!1}).inject(this.elements.picture),this.elements.checkbox.getContent().addClassName("wux-controls-thumbnail-checkbox wux-ui-size-"+this.options.size);n=this;if(this.elements.container.addEvent("mouseenter",(function(e){n.isPreHighlighted||(n.elements.checkbox.getContent().addClassName("wux-ui-state-prehighlighted"),n.isPreHighlighted=!0)})),this.elements.container.addEvent("mouseleave",(function(e){n.isPreHighlighted&&(n.elements.checkbox.getContent().removeClassName("wux-ui-state-prehighlighted"),n.isPreHighlighted=!1)})),this.elements.checkbox.addEventListener(o.POINTERDOWN,(function(e){e.stopPropagation()})),this.elements.checkbox.addEventListener(o.POINTERUP,(function(e){e.stopPropagation()})),this._listenToChanges=!0,this.elements.checkbox.addEventListener("change",(function(e){n._listenToChanges&&(n.isHighlighted()?n.unhighlight():n.highlight())})),!t||!t.gridEngine){var h=this.options.onContextualEvent;if(h){s.addEventListener(this.elements.container,{callback:function(e){return h.callback.call(h.this,{context:e.context,infos:e.info,data:e.data})}});var u=this.elements.menu;this.elements.menu.addEventListener(o.POINTERUP,(function(e){var t=document.createEvent("HTMLEvents");t.initEvent("contextmenu",!0,!1),t.pageX=e.pageX,t.pageY=e.pageY,u.dispatchEvent(t)}))}}this._attachEvents()},setIcon:function(e){this.elements.icon.className="",this.elements.icon.addClassName("wux-controls-"+this.options.view+"-icon"),e?a.generateIcon(e,{target:this.elements.icon}):this.elements.icon.empty()},isHighlighted:function(){return this._isHighlighted},highlight:function(){this._isHighlighted=!0,this.elements.container.addClassName("wux-ui-state-highlighted"),this.elements.checkbox.getContent().addClassName("wux-ui-state-highlighted"),!0!==this.elements.checkbox.checkFlag&&(this._listenToChanges=!1,this.elements.checkbox.checkFlag=!0,this._listenToChanges=!0)},unhighlight:function(){this._isHighlighted=!1,this.elements.container.removeClassName("wux-ui-state-highlighted"),this.elements.checkbox.getContent().removeClassName("wux-ui-state-highlighted"),!1!==this.elements.checkbox.checkFlag&&(this._listenToChanges=!1,this.elements.checkbox.checkFlag=!1,this._listenToChanges=!0)},activate:function(){this.elements.container.addClassName("wux-ui-state-activated")},deactivate:function(){this.elements.container.removeClassName("wux-ui-state-activated")}})})),define("DS/Controls/ThumbnailCellView",["DS/Controls/ThumbnailView","DS/Layouts/GridEngineCellAbstract","DS/UIBehaviors/ContextualMenuManager","DS/Core/PointerEvents","DS/Menu/ContextualMenu","DS/Utilities/Dom"],(function(e,t,i,n,s,o){"use strict";function l(e){return e.charAt(0).toUpperCase()+e.slice(1)}return t.extend({defaultOptions:{size:"small",menu:[]},init:function(t){var s=t.menu;t.menu=[],this._CtxMenuByRightClick=!0,this._parent(t),this.elements.container.setStyles({border:"none"}),this.elements.container.setAttribute("draggable","true"),this.elements.container.dsView=this,this._view=new e(this.options).inject(this.elements.container),this._view.elements.menu.cellView=this;var o=this;this._view.elements.checkbox.addEventListener(n.POINTERDOWN,(function(e){e.stopPropagation()}),!0),this._view.elements.checkbox.addEventListener(n.POINTERUP,(function(e){e.stopPropagation()})),this._view.elements.checkbox.addEventListener("click",(function(e){o.getGridEngine()&&!0===o.getGridEngine()._isTouchWithatCellHover&&(o.getGridEngine()._isTouchWithatCellHover=!1,e.stopPropagation(),o.getGridEngine()._enableInteractiveMultiSelMode())}),!0),this._view._listenToChanges=!0,this._view.elements.checkbox.addEventListener("change",(function(e){if(o._view._listenToChanges){var t=o.getGridEngine(),i=o.getCellInfos();t&&i&&(t._enableInteractiveMultiSelMode(),i.cellModel.isSelected()?i.cellModel.unselect():(t.options.selection.canMultiSelect||t.options.TreedocModel.getXSO().empty(),i.cellModel.select()),t.options.lastSelectedNode=i.cellModel)}})),this.setupContextualMenu(s),this.getGridEngine().options.onContextualEvent?this._view.elements.menu.addEventListener(n.POINTERUP,(function(e){e.preventDefault();var t=this.cellView;if(o._CtxMenuByRightClick=!1,!n.isTouchEvent(e)||!t.getGridEngine()._preventSelectionForTouchScroll){var i=t.getCellInfos();if(i){var s=i.nodeModel;s&&!s.isSelected()&&(s.select(!0),t.getGridEngine().setActiveNode(s,!0))}if(t.getGridEngine().options.onContextualEvent){var l=document.createEvent("HTMLEvents");l.initEvent("contextmenu",!0,!1),l.pageX=e.pageX,l.pageY=e.pageY,this.dispatchEvent(l)}o._CtxMenuByRightClick=!0,e.stopPropagation()}})):this._view.elements.menu.addEventListener(n.POINTERDOWN,(function(e){var t=this.cellView;o._CtxMenuByRightClick=!1;var n=t.getCellInfos();i.show(t._view.elements.container,[e.pageX,e.pageY]),o._CtxMenuByRightClick=!0,n.cellModel.isSelected()&&e.stopPropagation()}))},setupContextualMenu:function(e){var t=this,n=this.getGridEngine().options.onContextualEvent;if(n)s.addEventListener(this.elements.container,{callback:function(e){if(t.getGridEngine()&&(t.getGridEngine()._cellCtxMenuRequired=!0,!0===t._CtxMenuByRightClick)){var i=t.getCellInfos();if(i){var s=i.nodeModel;s&&!s.isSelected()&&(s.select(!0),t.getGridEngine().setActiveNode(s,!0))}}return n.callback.call(n.this,{context:t,menuContext:e.context,infos:e.info,data:e.data,cellInfos:t.getCellInfos()})}});else{var o=this.getGridEngine().options.onContextualMenuReady,l=o;"function"==typeof o&&(l=function(){var e=t.getCellInfos();if(e&&!0===t._CtxMenuByRightClick){var i=e.nodeModel;i&&!i.isSelected()&&(i.select(!0),t.getGridEngine().setActiveNode(i,!0))}return o.call(t,e)}),0===(e?e.length:0)?(i.forget({target:this._view.elements.container,nodes:l}),i.onReady({target:this._view.elements.container,nodes:l})):i.onReady({target:this._view.elements.container,context:this,nodes:e})}},updateInternalParameters:function(){this.setColor(),this.setTitle(),this.setSubtitle(),this.setDescription(),this.unhighlight(),this.deactivate(),this.unsetBadges()},setTitle:function(e){this._view.setTitle(e),(!this.getGridEngine()||this.getGridEngine()&&"function"==typeof this.getGridEngine().getShouldDisplayTooltipFlag&&!0===this.getGridEngine().getShouldDisplayTooltipFlag())&&(this.elements.container.title=e)},setColor:function(e){this._view.setColor(e)},setIcon:function(e){this._view.setIcon(e)},setSubtitle:function(e){this._view.setSubtitle(e)},setDescription:function(e){this._view.setDescription(e)},setPicture:function(e){this._view.setPicture(e)},highlight:function(){this._view.highlight()},unhighlight:function(){this._view.unhighlight()},activate:function(){this._view.activate()},deactivate:function(){this._view.deactivate()},getCellInfos:function(){var e=this._parent(),t=this.getVirtualCoordinates();return e.nodeModel=this.getGridEngine().getCellModel(t.virtualRowID,t.virtualColumnID),e},setPictureBackgroundSize:function(e){this._view&&this._view.elements.picture&&this._view.elements.picture.setStyle("background-size",e)},unsetBadges:function(){this._view.elements.badgeTopRight.style.backgroundImage="",this._view.elements.badgeTopRight.style.visibility="hidden",this._view.elements.badgeTopRight.className="",this._view.elements.badgeTopRight.addClassName("wux-controls-thumbnail-badge-top-right"),this._view.elements.badgeBottomRight.style.backgroundImage="",this._view.elements.badgeBottomRight.style.visibility="hidden",this._view.elements.badgeBottomRight.className="",this._view.elements.badgeBottomRight.addClassName("wux-controls-thumbnail-badge-bottom-right")},setBadges:function(e){for(var t in e){var i=e[t];i&&(o.generateIcon(i,{target:this._view.elements["badge"+l(t)]}),this._view.elements["badge"+l(t)].style.visibility="visible")}}})}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/StandardTooltipView",["require","exports","DS/Controls/Abstract","UWA/Core","DS/Utilities/Utils","DS/Core/TooltipModel","DS/Core/TooltipUtils","DS/Core/WebUXComponents","i18n!DS/Controls/assets/nls/translation.json"],(function(e,t,i,n,s,o,l,a,r){"use strict";function h(){var e=l.completeTooltipInfos(this.tooltipModel);if(e){var t={},i=e.wrapPolicy===o.WrapPolicy.MULTILINE&&e.wrapThreshold>0;if(t["max-width"]=i?e.wrapThreshold:"none",e._isLoadedFromHelpRscFile&&(t["white-space"]="normal"),this.elements.container.setStyles(t),e.title&&void 0===this.elements.title){var a={class:"wux-tooltip-title"};s.getUnsafeHTMLContentValueToApply(e.allowUnsafeHTMLTitle)?a.html=e.title:a.text=e.title,this.elements.title=n.createElement("div",a),this.elements.title.setAttribute("title",e.title),this.elements.title.inject(this.elements.container)}if(e.postTitle&&void 0===this.elements.postTitle&&(this.elements.postTitle=n.createElement("span",{class:"wux-tooltip-postTitle",text:" ("+e.postTitle+")"}),this.elements.postTitle.inject(this.elements.title)),e.shortHelp&&void 0===this.elements.shortHelp){a={class:"wux-tooltip-shortHelp"};s.getUnsafeHTMLContentValueToApply(e.allowUnsafeHTMLShortHelp)?a.html=e.shortHelp:a.text=e.shortHelp,this.elements.shortHelp=n.createElement("div",a),this.elements.shortHelp.setAttribute("shortHelp",e.shortHelp),this.elements.shortHelp.inject(this.elements.container)}if(e.shortHelpImage&&void 0===this.elements.shortHelpImage&&(this.elements.shortHelpImage=n.createElement("img",{class:"wux-tooltip-shortHelpImage",src:e.shortHelpImage,width:e.shortHelpImageDimension.x,height:e.shortHelpImageDimension.y}),this.elements.shortHelpImage.inject(this.elements.container)),e.longHelp&&void 0===this.elements.longHelp){a={class:"wux-tooltip-longHelp"};s.getUnsafeHTMLContentValueToApply(e.allowUnsafeHTMLLongHelp)?a.html=e.longHelp:a.text=e.longHelp,this.elements.longHelp=n.createElement("div",a),this.elements.longHelp.setAttribute("longHelp",e.longHelp),this.elements.longHelp.style.display=e.shortHelp?"none":"block",this.elements.longHelp.inject(this.elements.container)}if(e.longHelpImage&&void 0===this.elements.longHelpImage&&(this.elements.longHelpImage=n.createElement("img",{class:"wux-tooltip-longHelpImage",src:e.longHelpImage,width:e.longHelpImageDimension.x,height:e.longHelpImageDimension.y}),this.elements.longHelpImage.style.display="none",this.elements.longHelpImage.inject(this.elements.container)),l.isReachable(e)&&void 0===this.elements.moreHelp){this.elements.container.addClassName("wux-controls-tooltip-reachable");a={class:"wux-tooltip-moreHelp"};s.getUnsafeHTMLContentValueToApply(e.allowUnsafeHTMLTitle)?a.html=r.moreHelp:a.text=r.moreHelp,this.elements.moreHelp=n.createElement("div",a),this.elements.moreHelp.setAttribute("moreHelp",r.moreHelp),this.elements.moreHelp.visibility="visible",this.elements.moreHelp.inject(this.elements.container)}}}function u(){this.elements.container&&(this.elements.container.empty(),this.elements.container.setStyles({minWidth:void 0,minHeight:void 0,whiteSpace:void 0})),this._longHelpRawWidth=0,this.elements.title=void 0,this.elements.postTitle=void 0,this.elements.shortHelp=void 0,this.elements.shortHelpImage=void 0,this.elements.longHelp=void 0,this.elements.longHelpImage=void 0,this.elements.moreHelp=void 0}var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{tooltipModel:{defaultValue:void 0,type:"object",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype._postBuildView=function(){this.getContent().addClassName("wux-controls-standard-tooltip-view"),h.call(this)},t.prototype.destroy=function(){u.call(this)},t.prototype._applyTooltipModel=function(e){this._updateView()},t.prototype.updateOverflow=function(e){var t;if(void 0!==this.elements.shortHelp&&(this.elements.shortHelp.removeAttribute("overflow"),e&&(t=this.elements.shortHelp.offsetHeight)<this.elements.shortHelp.scrollHeight)){this.elements.shortHelp.setAttributeNode(document.createAttribute("overflow"));var i=1;if((o=getComputedStyle(this.elements.shortHelp)).lineHeight.endsWith("px"))i=Math.floor(t/parseFloat(o.lineHeight));else{var n=parseFloat(o.fontSize),s=parseFloat(o.lineHeight);i=Math.floor(t/(n*s))}this.elements.shortHelp.style.setProperty("--nb-lines",i)}if(void 0!==this.elements.longHelp&&(this.elements.longHelp.removeAttribute("overflow"),e&&(t=this.elements.longHelp.offsetHeight)<this.elements.longHelp.scrollHeight)){this.elements.longHelp.setAttributeNode(document.createAttribute("overflow"));var o;i=1;if((o=getComputedStyle(this.elements.longHelp)).lineHeight.endsWith("px"))i=Math.floor(t/parseFloat(o.lineHeight));else{n=parseFloat(o.fontSize),s=parseFloat(o.lineHeight);i=Math.floor(t/(n*s))}this.elements.longHelp.style.setProperty("--nb-lines",i)}},t.prototype._applyProperties=function(e){this._updateView()},t.prototype.updateModel=function(e){e&&e.tooltipModel&&(this.tooltipModel!==e.tooltipModel?this.tooltipModel=e.tooltipModel:this._updateView())},t.prototype._updateView=function(){u.call(this),h.call(this)},t.prototype.displayLong=function(){void 0!==this.elements.longHelp&&this.elements.longHelp.style.removeProperty("display"),void 0!==this.elements.longHelpImage&&(this.elements.longHelpImage.style.display="block"),this._longHelpRawWidth&&this.getContent().setStyle("min-width",this._longHelpRawWidth+"px")},t.prototype.postInjectTooltip=function(){if(l.willLongDisplay(this.tooltipModel)){var e=this.elements.container;if(e){var t=void 0,i=void 0;this.elements.longHelp&&(t=this.elements.longHelp.style.display,this.elements.longHelp.style.display="block"),this.elements.longHelpImage&&(i=this.elements.longHelpImage.style.display,this.elements.longHelpImage.style.display="block"),this._longHelpRawWidth=parseFloat(e.getStyle("width")),this.elements.longHelp&&(this.elements.longHelp.style.display=t),this.elements.longHelpImage&&(this.elements.longHelpImage.style.display=i)}}},t.prototype.onClick=function(e){var t;e===this.elements.moreHelp&&(null===(t=this.tooltipModel)||void 0===t?void 0:t.moreHelpCB)&&"function"==typeof this.tooltipModel.moreHelpCB&&this.tooltipModel.moreHelpCB()},t}(i);return a.addClass(c,"tooltip"),c})),define("DS/Controls/ComboBoxBase",["UWA/Core","DS/Core/PointerEvents","DS/Utilities/KeyboardUtils","DS/Controls/Abstract","DS/Controls/Popup","DS/Tree/TreeListView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Tree/TreeNodeView","DS/Tree/Manager","DS/Utilities/Dom","DS/Utilities/Array","DS/Utilities/Utils"],(function(e,t,i,n,s,o,l,a,r,h,u,c,d){"use strict";var p=h.extend({syncModel:function(e,t){g.call(this.getDocument()),this._parent(e,t)}}),m=r.extend({updateInternalParameters:function(){this._parent();var e=this.getCellInfos();if(!e.isHeader){e.nodeModel._wuxComboBoxPreselected?this.getContent().addClassName("wux-controls-combobox-row-preselected"):this.getContent().removeClassName("wux-controls-combobox-row-preselected");var t=e.nodeModel.options.comboBoxSemantics||"leaf",i=document.createAttribute("semantics");i.value=t,this.getContent().setAttributeNode(i)}}});function g(){var e=0;this._getTrueRoot().processDescendants({onlyVisibleNodes:!1,processNode:function(t){t.nodeModel._unfilteredRowID=e,e++}})}function f(){var t=this;u.addEventOnElement(this,this.elements.container,"mousewheel",(function(i){if(t.disabled)return;if(t.multiSelFlag&&!t._isPopupOpened())return;if(d.getDocumentOwner(t).activeElement===t._getMainElement()||t.getContent().hasAttribute("focused")){i.preventDefault(),i.stopPropagation();var n=e.Event.wheelDelta(i);if(n<0)for(var s=0;s>n;s--)t.callMethodFromUIInteraction("incrementIndex");else for(s=0;s<n;s++)t.callMethodFromUIInteraction("decrementIndex")}}))}function v(){if(this._model){this.multiSelFlag&&!this._firstLoadModel&&(this.selectedIndexes=[]);var e=!0;this._addChildCB&&(this._model.unsubscribe(this._addChildCB),this._addChildCB=void 0),this._removeChildCB&&(this._model.unsubscribe(this._removeChildCB),this._removeChildCB=void 0,e=!1),e&&(this.elements.treeListView&&this.elements.treeListView.getManager().getDocument()&&(this.elements.treeListView.getManager().unloadDocument(),this.elements.treeListView.getManager()._treeDocument=null),this._model&&(this._model.destroy(),delete this._model)),this._model=void 0}this._allDescendants=void 0;var t=this;if(this.elementsList.length){this._model=new l({shouldBeEditable:function(){return t.multiSelFlag}}),this._model.prepareUpdate();for(var i="string"==typeof this.elementsList[0],n=0;n<this.elementsList.length;n++){var s,o;i?s={label:this.elementsList[n]}:void 0!==this.elementsList[n].label?(s={label:this.elementsList[n].label,description:this.elementsList[n].description,grid:{valueItem:this.elementsList[n].value}},o="icon"):(s={label:this.elementsList[n].labelItem,description:this.elementsList[n].description,grid:{valueItem:this.elementsList[n].valueItem}},o="iconItem"),""!==s.label&&(this._model.options._hasAtLeastOneLabel=!0);var r=this.elementsList[n][o];r&&""!==r&&(this._model.options._hasAtLeastOneIcon=!0,"string"!=typeof r||""===r||u.isAPath(r)||-1===r.indexOf(".")&&(this.elementsList[n][o]={iconName:r}),s.icons=[this.elementsList[n][o]]),this._model.addRoot(new a(s))}this._model.pushUpdate()}else if(this.elementsTree){this._model=this.elementsTree;var h=function(){if(t._allDescendants=void 0,g.call(t._model),t._model){var e=t._model.getXSO().get(),i=[];for(const n of e){let e=t._isSelectAllCombo?n._unfilteredRowID-1:n._unfilteredRowID;n.options.selectAllNode||i.push(e)}t.selectedIndexes=i}t._updateNbDisplayedElements(),t._updatePopupHeight()};this._addChildCB=this._model.addModelEventListener("addChild",h),this._removeChildCB=this._model.addModelEventListener("removeChild",h);var d=!1,p=!1;this._model.processDescendants({onlyVisibleNodes:!1,processNode:function(e){e&&e.nodeModel&&(""!==e.nodeModel._options.label&&(d=!0),e.nodeModel._options.icons.length>0&&(p=!0))}}),this._model.options._hasAtLeastOneLabel=d,this._model.options._hasAtLeastOneIcon=p}else this._model=new l({shouldBeEditable:function(){return t.multiSelFlag}});if(this.completeModel&&this.completeModel(this._model),this._firstLoadModel=!1,this._model){g.call(this._model),this._treeListViewReady&&(this.elements.treeListView.getContent().removeClassName("wux-controls-combobox-treelistview-iconandtext"),this.elements.treeListView.getContent().removeClassName("wux-controls-combobox-treelistview-icononly"),this._model.options._hasAtLeastOneIcon&&(this._model.options._hasAtLeastOneLabel?this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-iconandtext"):this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-icononly")),this._isPopupOpened()&&!this.elements.treeListView.getManager().getDocument()&&(this.elements.treeListView.getManager().loadDocument(this._model),this.elements.treeListView.getManager().setScrollerPosition({x:0,y:0}),this._modelHasChanged=!1)),this._model.getXSO().onAdd((function(e){if(t._preventXSOCB)t._forceNodeChange&&t._ignoredNodes.push(e);else if(t.multiSelFlag){if(t._ignoredNodes.forEach((e=>{let i=t._isSelectAllCombo?e._unfilteredRowID-1:e._unfilteredRowID;i>-1&&t.selectedIndexes.push(i)})),t._ignoredNodes=[],-1===t._getSelectedIndexes().indexOf(e._unfilteredRowID)){let i=t._isSelectAllCombo?e._unfilteredRowID-1:e._unfilteredRowID;i>-1&&t.selectedIndexes.push(i),t._applySelectedIndexes()}}else t._isPopupOpened()?(t._properties.preselectedIndex.value=e._unfilteredRowID,t._applyPreselectedIndex()):t.selectedIndex=e._unfilteredRowID}));let e=!1;this._model.getXSO().onRemove((function(i){if(t._preventXSOCB)t._forceNodeChange&&t._ignoredNodes.push(i);else if(t.multiSelFlag){if(t._model.getXSO().get().length){t._ignoredNodes.forEach((e=>{let i=t._getSelectedIndexes().indexOf(e._getRowID(1));t._isSelectAllCombo&&t.isAllSelected()&&i--,i>=0&&t.selectedIndexes.splice(i,1)})),t._ignoredNodes=[];let e=t._getSelectedIndexes().indexOf(i._getRowID(1));t._isSelectAllCombo&&t.isAllSelected()&&e--,e>=0&&t.selectedIndexes.splice(e,1)}else c.clear(t.selectedIndexes);e||(t._removeIndex=!0,t._applySelectedIndexes(),t._removeIndex=!1)}})),this._model.getXSO().onPreEmpty((function(){e=!0})),this._model.getXSO().onEmpty((function(){e=!1}))}this._modelHasChanged=!0,this._updateNbDisplayedElements(),this._updatePopupHeight(),this._modelLoaded&&this._modelLoaded(),this.fire("modelLoaded")}function y(e,t){if(void 0===e)return t.value=-1,1;if(-1===e&&this.reachablePlaceholderFlag)return 0;if(e<-1&&this.reachablePlaceholderFlag)return t.value=-1,1;var i,n=this._getAllDescendants();return 0===n.length?-1!==e?(t.value=-1,1):0:e<=-.5&&!this.reachablePlaceholderFlag?(t.value=0,1):e>=n.length?(t.value=n.length-1,1):(t.value=Math.round(e))!==e?1:this.isIndexValid(e)?0:0===this._direction?2:1===this._direction?-1===(i=b.call(this,e))?2:(t.value=i,1):(i=w.call(this,e))===this._getAllDescendants().length?2:(t.value=i,1)}function _(e){var t=e;do{if(-1===(t=b.call(this,t)))return t}while(!this.isIndexValid(t));return t}function b(e){var t=-1;if(void 0!==e)return e<this._getAllDescendants().length-1&&(t=e+1),t;if(this._isPopupOpened()){var i=this._model.getXSO().get();if(i.length>0){var n=i[i.length-1]._unfilteredRowID;n<this._getAllDescendants().length-1&&(t=n+1)}else t=0}else this.multiSelFlag?this._getSelectedIndexes()[this._getSelectedIndexes().length-1]<this._getAllDescendants().length-1&&(t=this._getSelectedIndexes()[this._getSelectedIndexes().length-1]+1):this.selectedIndex<this._getAllDescendants().length-1&&(t=this.selectedIndex+1);return t}function C(e){var t=e;do{if((t=w.call(this,t))===this._getAllDescendants().length)return t}while(!this.isIndexValid(t));return t}function w(e){var t=this._getAllDescendants().length;if(void 0!==e)return e>(this.reachablePlaceholderFlag&&!this._isPopupOpened()?-1:0)&&(t=e-1),t;if(this._isPopupOpened()){var i=this._model.getXSO().get()[0];if(i){var n=i._unfilteredRowID;n>0&&(t=n-1)}}else this.selectedIndex>(this.reachablePlaceholderFlag?-1:0)&&(t=this.selectedIndex-1);return t}function x(e,t){const i=this.elements.treeListView.getManager();if(e&&i.isNodeInVisibleViewport(e))return!1;if(this._treeListViewIsBeingScrolled=!0,e){var n=this.elements.treeListView.getManager().options.defaultCellHeight,s=e._getRowID(1)*n;if(t){var o=Math.max(0,s-n*Math.floor(this.nbDisplayedElements/2));i.setScrollerPosition({x:0,y:o})}else{var l=this.nbDisplayedElements*n,a=this.elements.treeListView.getManager().getScrollerPosition().y;s>a+l-n?i.setScrollerPosition({x:0,y:s-l+n}):s<a&&i.setScrollerPosition({x:0,y:s})}}else i.setScrollerPosition({x:0,y:0});return!0}function E(){var e=!1;const t=this.elements.treeListView.getManager();var i;this._getAllDescendants()&&((this.multiSelFlag&&this._getSelectedIndexes().length>0||!this.multiSelFlag&&-1!==this.selectedIndex)&&(i=this._getAllDescendants()[this.preselectedIndex]),this.multiSelFlag&&!i&&this._getAllDescendants().length?t.setActiveNode(this._getAllDescendants()[0]):t.setActiveNode(i),i&&this._getAllDescendants().length>this.nbDisplayedElements&&(e=x.call(this,i,!0)));e||(t.prepareUpdateView(),t.pushUpdateView(),this._updatePopupWidth())}function S(e=!1){let t=0;if(this.elements.mainElement){const i=this._getCurrentTouchMode(),n=i?14:12,s=i?14:7,o=11;let l=0,a=!1;const r=[];if(this._getAllDescendants().forEach((function(t){if(!t.isHidden()){const i=u.computeStringWidth(t.getLabel(),n,"Arial");if(l<i&&(l=i),t.options.icons&&t.options.icons.length>0&&t.options.icons[0])if(e){const e=new Promise(((e,i)=>{const n=u.generateIcon(t.options.icons[0]);n.style.cssText="position: absolute; height: 22px; opacity: 0; "+n.style.cssText,u.onNodeRendered(n,(()=>{const t=n.getSize().width;n.remove(),e(t)}),{once:!0}),document.body.appendChild(n)}));r.push(e)}else a=!0}})),t=l+s,this.elements.iconPlaceholder&&a&&(t+=32),r.length>0)return new Promise(((e,i)=>{Promise.allSettled(r).then((i=>{e(Math.max(...Array.from(i,(e=>e.value)))+o+t)}))}))}return t}return n.inherit({name:"comboBoxBase",publishedProperties:{nbDisplayedElements:{defaultValue:-1,type:"integer",readOnly:!0,category:"Appearance"},selectedIndex:{defaultValue:-1,type:"integer",category:"Appearance",recordFlag:!0},preselectedIndex:{defaultValue:-1,type:"integer",readOnly:!0,category:"Appearance"},selectedIndexes:{defaultValue:[],type:"array",category:"Appearance",recordFlag:!0},value:{defaultValue:void 0,type:"object",category:"Appearance",recordFlag:!0},currentValue:{defaultValue:void 0,type:"object",category:"Appearance",uiDisplay:!1},label:{defaultValue:"",type:"string",readOnly:!0,category:"Appearance"},currentLabel:{defaultValue:"",type:"string",readOnly:!0,category:"Appearance"},elementsList:{defaultValue:[],type:"array",category:"Model"},elementsTree:{defaultValue:void 0,type:"array",category:"Model"},multiSelFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},showToggleColumnForMultiSelFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},reachablePlaceholderFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},_validateOnBlurForTMCAndFilterApp:{defaultValue:!1,type:"boolean",category:"Behavior",readOnly:!0,noNeedToApplyFlag:!0},popupSizeAdjustPolicy:{defaultValue:s.SizeAdjustPolicyEnum.AdjustToVisibleContents,type:"integer",category:"Appearance",noNeedToApplyFlag:!0},mainElementSizeAdjustPolicy:{defaultValue:s.SizeAdjustPolicyEnum.NoAdjust,type:"integer",category:"Appearance"},selectionStyle:{defaultValue:"",type:"string"},onContextualEvent:{defaultValue:void 0,type:"function",noNeedToApplyFlag:!0},completeModel:{defaultValue:void 0,type:"function"}},_privateProperties:{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"},_isSelectAllCombo:{defaultValue:!1,type:"boolean",category:"Behavior"},_isA2X:{defaultValue:void 0,type:"boolean",category:"Behavior"}},buildView:function(){this.elements.container.addClassName("wux-controls-combobox"),this._model=null,this._firstLoadModel=!0,this._lastValidatedPreselectedIndex=void 0,this._lastValidatedSelectedIndex=void 0,this._treeListViewReady=!1,this._direction=0,this._preventXSOCB=!1,this._removeIndex=!1,this._lastValidatedSelectedIndexes=[],this._forceNodeChange=!1,this._ignoredNodes=[]},handleEvents:function(){f.call(this)},destroy:function(){this._hidePopup(!0),this._addChildCB&&(this._model.unsubscribe(this._addChildCB),this._addChildCB=void 0),this._removeChildCB&&(this._model.unsubscribe(this._removeChildCB),this._removeChildCB=void 0),this._allDescendants=null,this._parent(),this.elementsList&&this.elementsList.length>0&&this._model.destroy()},isIndexValid:function(e){if(e<-1||e>=this._getAllDescendants().length)return!1;if(-1===e)return this.reachablePlaceholderFlag;var t=this._getAllDescendants()[e];return!!t&&this._model.options.shouldBeSelected(t)},incrementIndex:function(){if(this._direction=1,this._treeListViewReady&&!this._modelHasChanged&&this.elements.treeListView.getManager().getActiveNode())this.elements.treeListView.getManager()._commandRegistry.dispatch("treelistview:go-to-next-visible-node-no-empty-xso",this.elements.treeListView.getManager()),e=this.elements.treeListView.getManager().getActiveNode()._unfilteredRowID,this.multiSelFlag&&(this._properties.preselectedIndex.value=e,this._applyPreselectedIndex());else{var e=_.call(this);e>=0&&(this._isPopupOpened()?this._selectInList(e):this.selectedIndex=e)}this._direction=0},decrementIndex:function(){if(this._direction=2,this._treeListViewReady&&!this._modelHasChanged&&this.elements.treeListView.getManager().getActiveNode()){var e=this.preselectedIndex;this.elements.treeListView.getManager()._commandRegistry.dispatch("treelistview:go-to-previous-visible-node-no-empty-xso",this.elements.treeListView.getManager()),t=this.elements.treeListView.getManager().getActiveNode()._unfilteredRowID,this.multiSelFlag?(this._properties.preselectedIndex.value=t,this._applyPreselectedIndex()):!this._isPopupOpened()&&e===t&&this.reachablePlaceholderFlag&&(this.selectedIndex=-1)}else{var t=C.call(this);t!==this._getAllDescendants().length&&(this._isPopupOpened()?this._selectInList(t):this.selectedIndex=t)}this._direction=0},getPopupWidth:function(){var e=this.elements.container.offsetWidth;if(this.multiSelFlag){var t=Math.round(this.elements.treeListView._treeWidth);return t>e?t:e}return e},_selectInList:function(e){this._preventXSOCB=!0;var t,i=this.multiSelFlag?e:[e];this.multiSelFlag&&this._removeIndex&&this._treeListViewReady&&(t=this.elements.treeListView.getManager().getActiveNode()),this._model.prepareUpdate(),this._model.getXSO().empty();for(var n=0;n<i.length;n++)i[n]>=0&&i[n]<this._getAllDescendants().length&&this._getAllDescendants()[i[n]].select();this.multiSelFlag&&this._removeIndex||(this._properties.preselectedIndex.value=i[i.length-1],this._applyPreselectedIndex(1),t=this._getAllDescendants()[this.preselectedIndex]),this._treeListViewReady&&this.elements.treeListView.getManager().setActiveNode(t),this._model.pushUpdate(),this._preventXSOCB=!1},_addCommonEvents:function(){var e=this;this.elements.expander&&u.addEventOnElement(this,this.elements.expander,"click",(function(t){t.stopPropagation(),e.disabled||(e._isPopupOpened()?e.callMethodFromUIInteraction("_hidePopup",!e.multiSelFlag&&!(e._validateOnBlurForTMCAndFilterApp||e._isA2X&&e.enableSearchFlag)):e.callMethodFromUIInteraction("_showPopup"))})),this._getMainElement&&u.addEventOnElement(this,this._getMainElement(),"keydown",(function(t){var n=!1;switch(t.keyCode){case i.ARROWUP:(e.multiSelFlag&&e._isPopupOpened()||!e.multiSelFlag&&!t.shiftKey&&!t.ctrlKey)&&(n=!0,e.callMethodFromUIInteraction("decrementIndex")),t.stopPropagation();break;case i.ARROWDOWN:(e.multiSelFlag&&e._isPopupOpened()||!e.multiSelFlag&&!t.shiftKey&&!t.ctrlKey)&&(n=!0,e.callMethodFromUIInteraction("incrementIndex")),t.stopPropagation();break;case i.ESCAPE:if(e._isPopupOpened()){var s=e.preselectedIndex,o=e._isPopupOpened();e.callMethodFromUIInteraction("_hidePopup",1),s!==e.preselectedIndex&&(t.actionPerformed=!0,e._actionPerformedOnKeyDown=!0),o&&(t.stopPropagation(),e._stopPropagation=!0)}break;case e.multiSelFlag&&i.TAB:e._isPopupOpened()&&e.callMethodFromUIInteraction("_hidePopup",!e.multiSelFlag),t.stopPropagation();break;case t.ctrlKey&&i.SPACE:e.multiSelFlag&&e._isPopupOpened()&&e._treeListViewReady&&this.elements.treeListView.getManager()._commandRegistry.dispatch("treelistview:toggle-selection",this.elements.treeListView.getManager()),t.stopPropagation()}n&&t.preventDefault()}))},_updatePopupHeight:function(){if(this.elements.treeListViewContainer){var e=this.nbDisplayedElements,t=(this._getCurrentTouchMode()?38:22)*e+"px";if(this.elements.treeListViewContainer.style.height!==t){var i=this._isPopupOpened();this.elements.popup.visibleFlag=!1,this.elements.treeListViewContainer.style.height=t,this.elements.treeListView&&this.elements.treeListView.updateHeight(t),i&&this._showPopup()}}},_updatePopupWidth:function(){if(this.elements.treeListView&&!this._treeListViewIsBeingScrolled){if(this.popupSizeAdjustPolicy===s.SizeAdjustPolicyEnum.NoAdjust||this.popupSizeAdjustPolicy===s.SizeAdjustPolicyEnum.Crop){var e=this.getPopupWidth();this.elements.treeListViewContainer.style.width=e+"px"}if(null!==this.elements.treeListView.getContent().offsetParent&&this._treeListViewReady){if(this.popupSizeAdjustPolicy===s.SizeAdjustPolicyEnum.AdjustToVisibleContents||this.popupSizeAdjustPolicy===s.SizeAdjustPolicyEnum.AdjustToAllContents){var t=this.elements.treeListView.getManager();if(t){e=t._computeMinimalColumnWidth("tree",!1);var i=0;t.isColumnHidden("selection")||(e+=i=t._computeMinimalColumnWidth("selection",!1));var n=0;t.getScroller().areScrollbarsDisplayed("vertical")&&(e+=n=d.getScrollbarWidth());var o=Math.max(this.getContent().clientWidth,void 0!==this._minPopupWidth?this._minPopupWidth:0);if(e=Math.max(o,e),this._minPopupWidth=e,parseInt(this.elements.treeListViewContainer.style.width)!==e){let s=d.getDocumentOwner(this);e=Math.min(e,s.body.offsetWidth),this.elements.treeListViewContainer.style.width=e+"px",this.elements.popup._updateView(),t.prepareUpdateView(),t.setColumnWidth("tree",e-i-n),t.isColumnHidden("selection")||(i=t.sizeColumnToFit("selection")),t.pushUpdateView()}this.elements.popup.getContent().setStyle("visibility","visible")}}this.fire("popupVisibilityChange")}}},_managePopupOverlaping:function(e){let t=e.availableSpaces;var i=this._properties.nbDisplayedElements.value;this._updateNbDisplayedElements(t),i!==this._properties.nbDisplayedElements.value&&this._updatePopupHeight()},_updateNbDisplayedElements:function(e){var t=this._model.getNumberOfVisibleDescendants();e?this._reduceNbDisplayedToAvoidOverlaping(e,t<10?t:10):this._properties.nbDisplayedElements.value=t<10?t:10},_reduceNbDisplayedToAvoidOverlaping:function(e,t){var i=this._getCurrentTouchMode()?38:22,n=Math.max(e.bottom,e.top),s=Math.min(Math.max(3,Math.floor(n/i)),t);this._properties.nbDisplayedElements.value=s},_hidePopup:function(e){if(this._isPopupOpened()){if(e)this.multiSelFlag&&(this.selectedIndexes=this._lastValidatedSelectedIndexes.slice());else if(this.multiSelFlag)this._lastValidatedSelectedIndexes=this.selectedIndexes.slice();else{const e=this._model.getXSO().get().length?this._model.getXSO().get()[0]._unfilteredRowID:-1;-1===e&&(this._validateOnBlurForTMCAndFilterApp||this._isA2X&&this.enableSearchFlag)&&(this._lastCustomEntry=this._getMainElement().value),this.selectedIndex!==e?this.selectedIndex=e:-1===e&&(this._validateOnBlurForTMCAndFilterApp||this._isA2X&&this.enableSearchFlag)&&this._applySelectedIndex()}this.multiSelFlag?(this._properties.preselectedIndex.value=this._getSelectedIndexes().length?this._getSelectedIndexes()[this._getSelectedIndexes().length-1]:-1,this._applyPreselectedIndex()):(this._properties.preselectedIndex.value=this.selectedIndex,this._applyPreselectedIndex()),this.elements.popup&&(this.elements.popup.visibleFlag=!1,this._popupHidden&&this._popupHidden(e),e&&(this.multiSelFlag||(this._model.getXSO().empty(),this.selectedIndex>-1&&this._model.getXSO().add(this._getAllDescendants()[this.selectedIndex]))),this._minPopupWidth=0,this.fire("hide",{cancelPopupSelection:e}))}},_buildPopup:function(){if(this.elements.popup)this._inOverlapCallback||this._updateNbDisplayedElements(),this._updatePopupHeight();else{var i=this,n={target:this,position:"bottom",offset:{x:0,y:4},forceKeepOrientation:!0,alignment:"near",className:"wux-controls-combobox-popup wux-controls-popup",constraint:"screen",overlap:!1,trigger:"",overlapCallback:function(e){i._inOverlapCallback=!0,i._managePopupOverlaping(e),i._inOverlapCallback=void 0},beforeDisplayCallback:function(){i.popupSizeAdjustPolicy!==s.SizeAdjustPolicyEnum.AdjustToVisibleContents&&i.popupSizeAdjustPolicy!==s.SizeAdjustPolicyEnum.AdjustToAllContents||i.elements.popup.getContent().setStyle("visibility","hidden")}};this.elements.popup=new s(n),this.recId&&(this.elements.popup.recId=this.recId+"-popup"),this._applySelectionStyle(),this.elements.treeListViewContainer=new e.Element("div"),this.elements.popup.setBody(this.elements.treeListViewContainer),this._updatePopupHeight();i=this;var l=this.nbDisplayedElements,a=this._getCurrentTouchMode()?38:22,r=a*l+"px",h={onContextualEvent:this.onContextualEvent,managerClass:p,manageHeight:!0,expanderStyle:"none",columns:[{dataIndex:"selection",type:"selection",isHidden:!0},{text:"tree",dataIndex:"tree",isHidden:!1,isEditable:!1,width:"auto"},{text:"valueItem",dataIndex:"valueItem",isHidden:!0,isEditable:!1,isDraggable:!1,width:0}],defaultCellHeight:a,defaultCellWidth:36,height:r,isEditable:!0,resize:{columns:!0,rows:!1},show:{rowHeaders:!1,columnHeaders:!1},rootMargin:7,selection:{rowHeaders:!1,columnHeaders:!1,unselectAllOnEmptyArea:!1,preSelection:!0,toggle:!1===this.showToggleColumnForMultiSelFlag,canMultiSelect:this.multiSelFlag,enableListSelection:this.multiSelFlag},treeDocument:this._model,performances:{useRequestAnimationFrameRendering:!0},shouldAcceptDrag:function(){return!1},shouldDisplayTooltip:function(e){return{allowUnsafeHTMLShortHelp:!1,shortHelp:void 0===e.nodeModel.options.description?e.nodeModel.getLabel():e.nodeModel.options.description}},apiVersion:2,cellClass:m,enableActiveUI:!0,enableKeyboardNavigation:!0,allowUnsafeHTMLContent:!1};this.elements.treeListView=new o(h),this.elements.treeListView.getManager().__isComboBox__=!0,this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview"),this._model.options._hasAtLeastOneIcon&&(this._model.options._hasAtLeastOneLabel?this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-iconandtext"):this.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-icononly")),this._applyMultiSelFlag();i=this;var c={x:-1,y:-1},g=!0;u.addEventOnElement(this,this.elements.popup.getContent(),"mousemove",(function(e){var t=e.clientX,n=e.clientY;if(t!==c.x||n!==c.y||!g){var s=u.firstParentWithClass(e.target,"wux-datagrid-cell");if(s&&s.dsView&&s.dsView._cellInfos&&s.dsView._cellInfos.cellModel&&s.dsView._cellInfos.cellModel.options){var o=s.dsView._cellInfos.nodeModel._unfilteredRowID;i.setReadOnlyPropertyFromUIInteraction("preselectedIndex",{value:parseInt(o)})}c.x=t,c.y=n,g=!0}}),!0),this.elements.popup.getContent().addEvent("mousewheel",(function(){g=!1})),this.elements.treeListView.onNodeClick((function(e){i._getMainElement&&!t.isLastEventTouch()&&i._getMainElement().focus(),i.isIndexValid(e.nodeModel._unfilteredRowID)&&(i.multiSelFlag||i._hidePopup()),i._isA2X||i.fire("click")})),this.elements.treeListView.getManager().onReady((function(){i._treeListViewReady=!0,E.call(i),i.elements.treeListView.getContent().addClassName("wux-controls-combobox-treelistview-colors"),i.elements.treeListView.getManager().getScroller().onScrollEnd((function(){i._treeListViewIsBeingScrolled=!1,i._updatePopupWidth()}))}));var f=d.getDocumentOwner(i);u.addEventOnElement(this,f.defaultView,"blur",(function(e){i._isPopupOpened()&&e.target===f.defaultView&&i._hidePopup(!i.multiSelFlag)}),!0);var v=function(e){if(i._isPopupOpened()&&!u.firstParentWithClass(e.target,"wux-controls-combobox-popup")){var t=u.firstParentWithClass(e.target,"wux-controls-combobox");!!t&&t.dsModel===i||(u.pushUserInteractionContext(),i.callMethodFromUIInteraction("_hidePopup",!i.multiSelFlag&&!(i._validateOnBlurForTMCAndFilterApp||i._isA2X&&i.enableSearchFlag)),u.popUserInteractionContext())}};u.addEventOnElement(this,f.body,"mousedown",v,!0),u.addEventOnElement(this,f.body,"touchstart",v,!0)}},_getAllDescendants:function(){return this._allDescendants||(this._allDescendants=this._model.getAllDescendants()),this._allDescendants},_showPopup:function(){this._isPopupOpened()||(this.fire("preDropdown"),this._buildPopup(),this._updatePopupWidth(),this._treeListViewReady&&this.elements.treeListView.getManager().onPostUpdateViewOnce((()=>{E.call(this)})),this.elements.popup.visibleFlag=!0,this._modelHasChanged&&(this.elements.treeListView.getManager().actualizeScrollerPosition(),this.elements.treeListView.inject(this.elements.treeListViewContainer),this.elements.treeListView.getManager().loadDocument(this._model),this._modelHasChanged=!1),this._getMainElement&&this._getMainElement().focus(),this.multiSelFlag&&(this._lastValidatedSelectedIndexes=this.selectedIndexes.slice()),this._popupDisplayed&&this._popupDisplayed(),this.fire("show"))},_isPopupOpened:function(){return this.elements.popup&&this.elements.popup.visibleFlag},_updateCurrentProperties:function(){if(!this.multiSelFlag&&-1===this.selectedIndex||this.multiSelFlag&&0===this.selectedIndexes.length)this._properties.value.value=this.multiSelFlag?[]:void 0,this._properties.currentValue.value=this.multiSelFlag?[]:void 0,this._properties.label.value="",this._properties.currentLabel.value="";else{for(var e=[],t="",i=this.multiSelFlag?this._getSelectedIndexes():[this.selectedIndex],n=0;n<i.length;n++){var s=this._getAllDescendants()[i[n]];s&&!s.options.selectAllNode&&(void 0!==s.options.grid.valueItem?c.pushUnique(e,s.options.grid.valueItem):c.pushUnique(e,s.options.label),t+=s.options.label,n!==i.length-1&&i.length>1&&(t+=", "))}this._properties.value.value=this.multiSelFlag?e:e[0],this._properties.currentValue.value=this.multiSelFlag?e:e[0],this._properties.label.value=t,this._properties.currentLabel.value=t}},_applyPreselectedIndex:function(e){var t=this._lastValidatedPreselectedIndex!==this.preselectedIndex;if(t||e){var i={value:0},n=y.call(this,this.preselectedIndex,i);if(1===n)return this._properties.preselectedIndex.value=i.value,void this._applyPreselectedIndex();if(2!==n){var s=this._getAllDescendants();void 0!==this._lastValidatedPreselectedIndex&&this._lastValidatedPreselectedIndex>=0&&this._lastValidatedPreselectedIndex<s.length&&(s[this._lastValidatedPreselectedIndex]._wuxComboBoxPreselected=!1,this._treeListViewReady&&this.elements.treeListView.getManager().removeRowClass(s[this._lastValidatedPreselectedIndex]._getRowID(),"wux-controls-combobox-row-preselected")),this._lastValidatedPreselectedIndex=this.preselectedIndex,-1!==this.preselectedIndex&&(s[this.preselectedIndex]._wuxComboBoxPreselected=!0,this._treeListViewReady&&this.elements.treeListView.getManager().addRowClass(s[this.preselectedIndex]._getRowID(),"wux-controls-combobox-row-preselected")),this._preselectedIndexModified&&this._preselectedIndexModified(),this.elements.popup&&this.elements.popup.visibleFlag&&t&&this.fire("preselectionChange")}else this._properties.preselectedIndex.value=this._lastValidatedPreselectedIndex?this._lastValidatedPreselectedIndex:-1}},_applySelectedIndex:function(e){if(this.multiSelFlag)this.selectedIndexes=[this.selectedIndex];else{var t=!0,i={value:0},n=y.call(this,this.selectedIndex,i);if(1===n)return i.value===e?void(this._properties.selectedIndex.value=e):void(this.selectedIndex=i.value);2===n&&(this._properties.selectedIndex.value=this._lastValidatedSelectedIndex?this._lastValidatedSelectedIndex:this.reachablePlaceholderFlag?-1:0,t=!1),t=this._modelChanged?t&&(this._lastValidatedSelectedIndex!==this.selectedIndex||this._lastValidatedSelectedIndex===this.selectedIndex&&-1!==this.selectedIndex):t&&(this._lastValidatedSelectedIndex!==this.selectedIndex||this._lastValidatedSelectedIndex===this.selectedIndex&&-1===this.selectedIndex),this._lastValidatedSelectedIndex=this.selectedIndex,this._selectInList(this.selectedIndex),this._selectedIndexModified&&this._selectedIndexModified(),this._updateCurrentProperties(),t&&this.fire("change")}},_applySelectedIndexes:function(t,i){if(this.multiSelFlag){for(var n=!0,s=[],o=0;o<this.selectedIndexes.length;o++){var l=this.selectedIndexes[o];this.isIndexValid(l)&&c.pushUnique(s,l)}s.length>0?this._properties.selectedIndexes.value=s:0===s.length&&this.selectedIndexes.length>0&&(this._properties.selectedIndexes.value=t||[],n=!1),this._modelChanged||(n=n&&(!t||!e.equals(t,this.selectedIndexes))),this._selectedIndexModified&&this._selectedIndexModified(),this._selectInList(this._getSelectedIndexes()),this._updateCurrentProperties(),n&&this.fire("change"),this.elements.popup&&this.elements.popup.visibleFlag&&this._updatePopupWidth()}},_applyValue:function(t){var i=0,n=[],s=void 0;s=this.multiSelFlag?void 0!==this.value?this.value:[]:void 0!==this.value?[this.value]:[];var o=this._getAllDescendants(),l=s.length;if(s&&l>0)for(var a=0;a<s.length;){var r=!1;for(i=0;i<o.length;i++){var h=o[i];if(void 0!==h.options.grid.valueItem){if(e.equals(h.options.grid.valueItem,s[a])){c.pushUnique(n,i),r=!0;break}}else if(h.options.label===s[a]){c.pushUnique(n,i),r=!0;break}}r?a++:s.splice(a,1)}this.multiSelFlag?n.length>0?this.selectedIndexes=n:l>0?this._properties.value.value=t:(this._properties.value.value=[],this.selectedIndexes=[]):i===o.length?this._properties.value.value=t:this.selectedIndex=n.length>0?n[0]:-1,this._properties.currentValue.value=this.value},_applyCurrentValue:function(e){this.value=this.currentValue},_applyElementsList:function(){this._modelChanged=!0,this._forceApplyProperties(["selectedIndex","selectedIndexes"]),this._modelChanged=!1},_applyElementsTree:function(){this._modelChanged=!0,this._forceApplyProperties(["selectedIndex","selectedIndexes"]),this._modelChanged=!1},_applyDisabled:function(){this._parent(),this.disabled?(this.elements.mainElement.disabled=!0,this.elements.expander.setAttributeNode(document.createAttribute("disabled"))):(this.elements.mainElement.disabled=!1,this.elements.expander.removeAttribute("disabled"))},_applyShowToggleColumnForMultiSelFlag:function(){var e=this.elements.treeListView;e&&(this.multiSelFlag&&this.showToggleColumnForMultiSelFlag?e.getManager().showColumn(0):e.getManager().hideColumn(0))},_applyMultiSelFlag:function(e){var t=this.elements.treeListView;t&&(t.getManager().options.selection.canMultiSelect=this.multiSelFlag,this.multiSelFlag&&this.showToggleColumnForMultiSelFlag?(t.getManager().showColumn(0),"lightSelectionEdging"===this.selectionStyle&&t.getManager().forceMultiSelection(!1)):(t.getManager().hideColumn(0),"lightSelectionEdging"===this.selectionStyle&&t.getManager().forceMultiSelection(!0)),t.getManager().options.selection.enableListSelection=this.multiSelFlag),this.multiSelFlag?(0===this.selectedIndexes.length&&(this.selectedIndexes=-1===this.selectedIndex?[]:[this.selectedIndex]),this.selectedIndex=-1,this.getContent().setAttributeNode(document.createAttribute("multiple"))):(this.selectedIndexes.length>0&&(this.selectedIndex=this.selectedIndexes.length?this.selectedIndexes[this.selectedIndexes.length-1]:-1,this._properties.selectedIndexes.value=[]),this.getContent().removeAttribute("multiple"))},_applyReachablePlaceholderFlag:function(){this.enableSearchFlag&&(this.reachablePlaceholderFlag=!0),this.reachablePlaceholderFlag||this.multiSelFlag||-1!==this.selectedIndex||void 0!==this.currentValue||void 0!==this.value||""!==this.currentLabel||""!==this.label||(this.selectedIndex=_.call(this,-1))},_applyTouchMode:function(e){this._parent(e),this._treeListViewReady&&(this._getCurrentTouchMode()?(this.elements.treeListView.options.defaultCellHeight=38,this.elements.treeListView._datagrid.options.defaultCellHeight=38,this.elements.treeListView.getManager().options.defaultCellHeight=38):(this.elements.treeListView.options.defaultCellHeight=22,this.elements.treeListView._datagrid.options.defaultCellHeight=22,this.elements.treeListView.getManager().options.defaultCellHeight=22),this.elements.treeListView.getManager()._indexRowsPosition({async:!1}),this._updatePopupHeight())},_applySelectionStyle:function(e){this.elements.popup&&this.elements.popup.elements.container.setAttribute("selection-style",this.selectionStyle)},_applyMainElementSizeAdjustPolicy:function(e){if(this.elements.container&&this.elements.container.style&&this.elements.mainElement&&this.elements.mainElement.style)if(this.mainElementSizeAdjustPolicy===s.SizeAdjustPolicyEnum.NoAdjust)this.elements.mainElement.style.removeProperty("min-width"),this.elements.container.style.minWidth="auto";else if(this.mainElementSizeAdjustPolicy===s.SizeAdjustPolicyEnum.AdjustToVisibleContents||this.mainElementSizeAdjustPolicy===s.SizeAdjustPolicyEnum.AdjustToAllContents){const e=S.call(this,this._isA2X),t=e=>{this.elements.container&&this.elements.mainElement&&(e?this.elements.mainElement.style.minWidth=e+"px":this.elements.mainElement.style.removeProperty("min-width"),this.elements.container.style.minWidth="auto")};d.isPromise(e)?e.then(t):t(e)}else this.mainElementSizeAdjustPolicy===s.SizeAdjustPolicyEnum.Crop&&(this.elements.mainElement.style.removeProperty("min-width"),this.elements.container.style.minWidth="0px")},_apply_IsA2X(){this._isA2X&&this._applyMainElementSizeAdjustPolicy()},_applyProperties:function(e){this._parent(e),(this.isDirty("elementsList")||this.isDirty("elementsTree"))&&v.call(this),this.isDirty("reachablePlaceholderFlag")&&this._applyReachablePlaceholderFlag(e.reachablePlaceholderFlag),this.isDirty("touchMode")&&this._applyTouchMode(e.touchMode),this.isDirty("currentValue")&&e&&e.hasOwnProperty("currentValue")&&this._applyCurrentValue(e.currentValue),this.isDirty("value")&&e&&e.hasOwnProperty("value")&&this._applyValue(e.value),(this.isDirty("selectedIndex")||this.isDirty("elementsList")||this.isDirty("elementsTree"))&&this._applySelectedIndex(e.selectedIndex),(this.isDirty("selectedIndexes")||this.isDirty("elementsList")||this.isDirty("elementsTree"))&&this._applySelectedIndexes(e.selectedIndexes),this.isDirty("multiSelFlag")&&this._applyMultiSelFlag(e.multiSelFlag),this.isDirty("selectionStyle")&&this._applySelectionStyle(e.selectionStyle),this.isDirty("mainElementSizeAdjustPolicy")&&this._applyMainElementSizeAdjustPolicy(e.mainElementSizeAdjustPolicy),this.isDirty("_isA2X")&&this._apply_IsA2X()},_getElementToFocus:function(){return this._getMainElement()},_giveFocus:function(){this._isFocused()||(this._parent(),this._getMainElement().focus())},_getSelectedIndexes:function(){if(this._isSelectAllCombo){let e=[];this.isAllSelected&&this.isAllSelected()&&e.push(0);for(let t=0;t<this.selectedIndexes.length;t++)e.push(this.selectedIndexes[t]+1);return e}return this.selectedIndexes}})})),define("DS/Controls/ComboBox",["UWA/Core","DS/Utilities/KeyboardUtils","DS/Controls/ComboBoxBase","DS/WebRecordEnabler/Adapter","DS/Utilities/Dom","DS/Controls/LineEditor","DS/TreeModel/TreeNodeModel","i18n!DS/Controls/assets/nls/translation.json"],(function(e,t,i,n,s,o,l,a){"use strict";function r(){this.elements.mainElement=new o({displayStyle:"text",selectAllOnFocus:this.selectAllOnFocus}).inject(this.elements.container),this.elements.mainElement.elements.inputField.addClassName("wux-controls-combobox-mainelement"),this.elements.expander=new e.Element("button",{type:"button",class:"wux-controls-button wux-controls-combobox-expander",tabindex:-1,isTextField:!0,name:"Button"}).inject(this.elements.container),this.elements.expander.setAttribute("style","border-left-width: 0px;")}function h(){var e=this;this._getMainElementTag().addEventListener("uncommittedChange",(function(t){t.stopPropagation(),e.fire("uncommittedChange",t.options)})),this._getMainElementTag().addEventListener("change",(function(e){e.stopPropagation()}));var i=0,n=function(){var t=!1,n=!1;if(i){clearTimeout(i),i=0;var s=e._getMainElement().value,o=-1;e._model.search({match:function(t){e._model.options.shouldBeSelected(t.nodeModel)&&s.toLowerCase()===t.nodeModel.options.label.toLowerCase()&&(t.nodeModel._getRowID(1),o=t.nodeModel._unfilteredRowID)},shouldStop:function(e){return-1!==o}}),t=o===e.selectedIndex&&-1===o&&e._lastCustomEntry!==s,-1===o&&(e._lastCustomEntry=s),e.selectedIndex!==o&&(e.selectedIndex=o,n=!0)}else t=e.preselectedIndex===e.selectedIndex&&-1===e.selectedIndex&&e._lastCustomEntry!==e._getMainElement().value,-1===e.preselectedIndex&&(e._lastCustomEntry=e._getMainElement().value);return t&&(n=!0,e._applySelectedIndex()),n};(this._validateOnBlurForTMCAndFilterApp||this._isA2X&&this.enableSearchFlag)&&this._getMainElement().addEventListener("blur",(function(e){n()}));var o,l,a=!1;s.addEventOnElement(this,this._getMainElement(),"keydown",(function(i){if(e._getMainElement().value!==o&&(o=e._getMainElement().value),a=!1,i.keyCode>=t.KEY0&&i.keyCode<=t.Z||229===i.keyCode)a=!0;else if(i.keyCode>=t.NUMPAD0&&i.keyCode<=t.SLASH)a=!0;else if(i.keyCode===t.DELETE||i.keyCode===t.BACKSPACE||i.keyCode===t.SPACE)a=!0;else if(i.keyCode>=t.SEMICOLON&&i.keyCode<=222)a=!0;else if(i.keyCode===t.ENTER){var s=e._isPopupOpened(),l=n();i.actionPerformed=l,e._actionPerformedOnKeyDown=l,s&&(i.stopPropagation(),e._stopPropagation=!0),e.callMethodFromUIInteraction("_hidePopup"),e._getMainElement().removeClassName("wux-controls-lineeditor-hideCursor")}})),s.addEventOnElement(this,this._getMainElement(),"keyup",(function(n){if(e._actionPerformedOnKeyDown&&(n.actionPerformed=e._actionPerformedOnKeyDown,e._actionPerformedOnKeyDown=void 0),e._stopPropagation&&(n.stopPropagation(),e._stopPropagation=void 0),n.keyCode!==t.TAB&&a){var s=this.value;e.elements.mainElement.value=s,i&&(clearTimeout(i),i=0),i=setTimeout((function(){var o=!1;n.keyCode!==t.DELETE&&n.keyCode!==t.BACKSPACE||!e._emptySearched||""!==s||!l||l!==t.DELETE&&l!==t.BACKSPACE||(o=!0),e._emptySearched=""===s,e.callMethodFromUIInteraction("_showPopup");var a=e.callMethodFromUIInteraction("_showMatchingLabel",s);e.setPropertyFromUIInteraction("_isFiltering",!0);var r=0===e._nbDisplayedItems;e.callMethodFromUIInteraction("_updateNbDisplayedElements"),e.callMethodFromUIInteraction("_updatePopupHeight"),e.generateRegexpString===e.publishedProperties.generateRegexpString.defaultValue?e._currentStartFiltered=e._getMainElement().selectionStart:e._currentStartFiltered=0;var h=-1;r||(o||!e.autocompleteFlag)&&-1===a?o=!1:h=-1!==a?a:e._firstVisibleSelectableIndex,e.callMethodFromUIInteraction("_selectInList",h),clearTimeout(i),i=0}),500),l=n.keyCode}}))}function u(){this.elements.mainElement=new e.Element("button",{class:"wux-controls-button wux-controls-combobox-mainelement",type:"button",tabindex:0,isTextField:!1,name:"Button"}).inject(this.elements.container),this.elements.iconPlaceholder=new e.Element("div",{class:"wux-comboBox-icon-placeholder"}).inject(this.elements.mainElement),this.elements.text||(this.elements.text=e.createElement("span").inject(this.elements.mainElement)),this.elements.expander=new e.Element("button",{class:"wux-controls-button wux-controls-combobox-expander",type:"button",tabindex:-1,isTextField:!1,name:"Button"}).inject(this.elements.container),this.actionOnClickFlag||this.elements.expander.setAttribute("style","border-left-width: 0px;"),this.elements.mainElement.setAttribute("action",this.actionOnClickFlag)}function c(){var e=this;s.addEventOnElement(this,this.elements.mainElement,"click",(function(t){e.actionOnClickFlag?(t.dsModel=e,e._isPopupOpened()&&e.callMethodFromUIInteraction("_hidePopup",!e.multiSelFlag)):(t.stopPropagation(),e._isPopupOpened()?e.callMethodFromUIInteraction("_hidePopup",!e.multiSelFlag):e.callMethodFromUIInteraction("_showPopup"))})),this._getMainElement().addEventListener("dblclick",(function(e){e.stopPropagation()}));var i,n=!1;s.addEventOnElement(this,this._getMainElement(),"keydown",(function(i){n=!1,(i.keyCode>=t.KEY0&&i.keyCode<=t.Z||i.keyCode>=t.NUMPAD0&&i.keyCode<=t.NUMPAD9)&&(n=!0),e.multiSelFlag&&!e._isPopupOpened()&&(n=!1),t.validate(i.keyCode)&&(e.actionOnClickFlag&&!e._isPopupOpened()&&e.mainElementVisibleFlag||(e._isPopupOpened()?e.multiSelFlag&&i.keyCode===t.SPACE||(e.callMethodFromUIInteraction("_hidePopup"),e.actionOnClickFlag&&e.fire("click"),i.stopPropagation(),e._stopPropagation=!0,i.preventDefault()):(e.callMethodFromUIInteraction("_showPopup"),i.stopPropagation(),e._stopPropagation=!0,i.preventDefault())))}));var o="";s.addEventOnElement(this,this._getMainElement(),"keyup",(function(l){e._actionPerformedOnKeyDown&&(l.actionPerformed=e._actionPerformedOnKeyDown,e._actionPerformedOnKeyDown=void 0),e._stopPropagation&&(l.stopPropagation(),e._stopPropagation=void 0),l.keyCode===t.SPACE&&l.stopPropagation(),l.keyCode!==t.TAB&&n&&(i&&clearTimeout(i),o+=String.fromCharCode(l.keyCode),i=setTimeout((function(){s.pushUserInteractionContext();var t=-1;e._model.search({match:function(i){e._model.options.shouldBeSelected(i.nodeModel)&&new RegExp(e.generateRegexpString(o),"i").test(i.nodeModel.options.label)&&(t=i.nodeModel._getRowID(1))},shouldStop:function(e){return-1!==t}}),-1!==t&&(e.multiSelFlag?e.selectedIndexes=[t]:e.selectedIndex=t),o="",s.popUserInteractionContext()}),500))}))}function d(e){if(this.elements.text.textContent=e.label,this._properties.label.value=e.label,this.elements.iconPlaceholder){void 0!==this._generatedIcon&&(this.elements.iconPlaceholder.contains(this._generatedIcon)&&this.elements.iconPlaceholder.removeChild(this._generatedIcon),this.elements.text.style.display="icon"===this.mainElementContent?"none":"",this.elements.mainElement.style.textAlign="initial",this.elements.iconPlaceholder.style.marginRight="0px",this.elements.iconPlaceholder.style.paddingLeft="0px",delete this._generatedIcon);var t=!1;e&&e.icon&&(this._generatedIcon=s.generateIcon(e.icon),this._generatedIcon&&this._generatedIcon.inject(this.elements.iconPlaceholder),""!==e.label&&void 0!==e.label&&null!==e.label&&("icon"!==this.mainElementContent||"icon"===this.mainElementContent&&this._isIconModeAutomaticalySet)?this.elements.iconPlaceholder.style.marginRight="11px":t=!0),t&&"icon"!==this.mainElementContent&&!this._isIconModeAutomaticalySet?(this.mainElementContent="icon",this._isIconModeAutomaticalySet=!0):!t&&"icon"===this.mainElementContent&&this._isIconModeAutomaticalySet&&(this.mainElementContent="all",this._isIconModeAutomaticalySet=!1),"icon"===this.mainElementContent&&(this.elements.text.style.displayStyle="none",this.elements.mainElement.style.textAlign="center",!this.actionOnClickFlag&&this.expanderVisibleFlag&&"icon"!==this.mainElementContent&&(this.touchMode?this.elements.iconPlaceholder.style.paddingLeft="19px":this.elements.iconPlaceholder.style.paddingLeft="11px"))}}function p(){this.elements.mainElement&&(this.elements.iconPlaceholder&&(this.elements.mainElement.removeChild(this.elements.iconPlaceholder),delete this.elements.iconPlaceholder),this.elements.text&&(this.elements.mainElement.removeChild(this.elements.text),delete this.elements.text),this.elements.container.removeChild(this._getMainElementTag()),delete this.elements.mainElement,this.elements.container.removeChild(this.elements.expander),delete this.elements.expander),!0===this.enableSearchFlag?(r.call(this),h.call(this)):(u.call(this),c.call(this)),"icon"===this.mainElementContent?this.getContent().setAttributeNode(document.createAttribute("mainElementIcon")):this.getContent().removeAttribute("mainElementIcon"),this._addCommonEvents(),this._applyDisplayStyle()}function m(){this._isFiltering&&(this._model.prepareUpdate(),this._model.processDescendants({treeTraversalOrder:"postOrder",processNode:function(e){var t=e.nodeModel;t.isHidden()&&t.show(),t.isExpanded()||t.expand()}}),this._model.pushUpdate(),this._firstVisibleSelectableIndex=-1,this._nbDisplayedItems=0,this._currentStartFiltered=-1,this._getMainElement().selectionStart=this._getMainElement().selectionEnd,this._isFiltering=!1,this._updateNbDisplayedElements(),this._updatePopupHeight())}function g(){var e=this;this._model.getXSO().onAdd((function(t){e.mainElementVisibleFlag&&e.autocompleteFlag&&e.enableSearchFlag&&e._isFiltering&&(e.elements.mainElement.value=t.options.label,e._getMainElement().selectionStart=e._currentStartFiltered)}))}var f=i.inherit({name:"comboBox",markForRecordFlag:!0,publishedProperties:{placeholder:{defaultValue:"",type:"string",category:"Appearance"},mainElementVisibleFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},mainElementContent:{defaultValue:"all",type:"string",category:"Appearance"},expanderVisibleFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},enableSearchFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},generateRegexpString:{defaultValue:function(e){return"^"+e},type:"function",category:"Behavior",uiDisplay:!1},useMatchingSearchFunction:{defaultValue:!1,type:"boolean",category:"Behavior",uiDisplay:!1},isNodeMatchingSearch:{defaultValue:function(e,t){return this.displayChildrenSearchMethod(e,t)},type:"function",category:"Behavior",uiDisplay:!1},autocompleteFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},actionOnClickFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},expanderIcon:{defaultValue:"expand-down",type:"object",category:"Appearance"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},getMainElementCustomization:{defaultValue:void 0,type:"function",category:"Behavior"},selectAllOnFocus:{defaultValue:!1,type:"boolean",category:"Behavior"}},buildView:function(){this._parent(),this._regex="",this._firstVisibleSelectableIndex=-1,this._nbDisplayedItems=0,this._currentStartFiltered=-1,this._lastCustomEntry="",this._isFiltering=!1,this._emptySearched=!1,this._isIconModeAutomaticalySet=!1,this._selectAllLabel="",this._selectAllIcon={}},_showMatchingLabel:function(e){this._model.prepareUpdate();var t=-1;this._regex=e;var i=void 0;if(this.useMatchingSearchFunction)this._getAllDescendants().forEach((function(e){e.options.alreadyTreated=void 0}));else try{i=new RegExp(this.generateRegexpString(this._regex),"i")}catch(e){}var n=this;return this._model.search({match:function(s){(n.useMatchingSearchFunction?n.isNodeMatchingSearch(e,s):i&&i.test(s.nodeModel.options.label))?(s.nodeModel.isHidden()&&s.nodeModel.show(),e===s.nodeModel.getLabel()&&(t=s.nodeModel._unfilteredRowID)):s.nodeModel.isHidden()||s.nodeModel.hide()}}),this._firstVisibleSelectableIndex=-1,this._nbDisplayedItems=0,this._getAllDescendants().forEach((function(e){e.isHidden()||(e.getParents().forEach((function(e){e.isHidden()&&(e.show(),n._nbDisplayedItems++),e.isExpanded()||e.expand()})),-1===n._firstVisibleSelectableIndex&&n._model.options.shouldBeSelected(e)&&(n._firstVisibleSelectableIndex=e._unfilteredRowID),n._nbDisplayedItems++)})),this._model.pushUpdate(),t},getPopupWidth:function(){return this.mainElementVisibleFlag?this._parent():this.elements.treeListView._treeWidth},displayBrothersSearchMethod:function(e,t){var i=t.nodeModel;if(void 0!==i.options.alreadyTreated)return i.options.alreadyTreated;if(i.getLabel().toLowerCase().includes(e.toLowerCase())){var n=i.getParent().getChildren();return n&&n.forEach((function(e){e.isHidden()?e.show():e.options.alreadyTreated=!0})),!0}return!1},displayChildrenSearchMethod:function(e,t){var i=t.nodeModel;if(void 0!==i.options.alreadyTreated)return i.options.alreadyTreated;if(i.getLabel().toLowerCase().includes(e.toLowerCase())){var n=function(e){var t=e.getChildren();t&&t.forEach((function(e){e.options.alreadyTreated=!0,n(e)}))};return n(i),!0}return!1},_preselectedIndexModified:function(){},_selectedIndexModified:function(){if(this.mainElementVisibleFlag)if(this.enableSearchFlag)this._emptySearched=!1,-1===this.selectedIndex?this.elements.mainElement.value=this._lastCustomEntry:(this._lastCustomEntry="",this.elements.mainElement.value=this._getAllDescendants()[this.selectedIndex].options.label);else{!this.multiSelFlag&&-1===this.selectedIndex||this.multiSelFlag&&0===this.selectedIndexes.length?(this.elements.mainElement.value=this._lastCustomEntry,this.elements.mainElement.addClassName("wux-combobox-placeholderstyle")):this.elements.mainElement.removeClassName("wux-combobox-placeholderstyle");var e=void 0;if(void 0!==this.getMainElementCustomization){(e=this.getMainElementCustomization())||(e={});var t=e.hasOwnProperty("label"),i=e.hasOwnProperty("icon");if(!t||!i){var n=this.getDefaultMainElementCustomization();t||(e.label=n.label),i||(e.icon=n.icon)}}else e=this.getDefaultMainElementCustomization();d.call(this,e),this.fire("dimensionsChanged")}},getDefaultMainElementCustomization:function(){var e=void 0,t="";if(!this.multiSelFlag){let t=this._getAllDescendants()[this.selectedIndex];t&&t.options.icons&&t.options.icons.length>0&&t.options.icons[0]&&(e=t.options.icons[0])}if("icon"!==this.mainElementContent)if(this.multiSelFlag&&this.selectedIndexes.length>0)for(var i=0;i<this.selectedIndexes.length;i++){let e=this.selectedIndexes[i];this._isSelectAllCombo&&e++;let n=this._getAllDescendants()[e];n&&(t+=n.options.label,i!==this._getSelectedIndexes().length-1&&(t+=", "))}else if(this.selectedIndex>=0&&this.selectedIndex<this._getAllDescendants().length){let e=this._getAllDescendants()[this.selectedIndex];e&&(t=e.options.label)}else this.placeholder&&(t=this.placeholder);return{icon:e,label:t}},_popupHidden:function(e){m.call(this),this._selectedIndexModified()},_modelLoaded:function(){m.call(this),g.call(this)},_updateCurrentProperties:function(){this.enableSearchFlag&&-1===this.selectedIndex?(this._properties.value.value=""!==this._lastCustomEntry?this._lastCustomEntry:void 0,this._properties.currentValue.value=""!==this._lastCustomEntry?this._lastCustomEntry:void 0,this._properties.label.value=this._lastCustomEntry,this._properties.currentLabel.value=this._lastCustomEntry):this._parent()},_getMainElement:function(){return this.mainElementVisibleFlag?this.elements.mainElement instanceof o?this.elements.mainElement.getContent().dsModel.elements.inputField:this.elements.mainElement:this.elements.expander},_getMainElementTag:function(){return this.elements.mainElement instanceof o?this.elements.mainElement.getContent():this.elements.mainElement},_applyPlaceholder:function(e){e!==this.placeholder&&(this.elements.mainElement.placeholder=this.placeholder,this._selectedIndexModified())},_applyMainElementVisibleFlag:function(){this._applyProperties({})},_applyMainElementContent:function(){this._applyProperties({})},_applyExpanderVisibleFlag:function(){var e=this._getMainElementTag();this.expanderVisibleFlag?(this.elements.expander.show(),this.getContent().removeAttribute("no-expander"),e.removeClassName("wux-combobox-mainelement-noexpander")):(this.elements.expander.hide(),this.getContent().setAttributeNode(document.createAttribute("no-expander")),e.addClassName("wux-combobox-mainelement-noexpander"))},_applyGetMainElementCustomization:function(){this._selectedIndexModified()},_applyEnableSearchFlag:function(){this.mainElementVisibleFlag&&(this.enableSearchFlag&&(this.reachablePlaceholderFlag=!0),this._applyProperties({}))},_applyAutocompleteFlag:function(){this.enableSearchFlag&&this._isFiltering&&(this.autocompleteFlag?this._preselectedIndexModified():this.elements.mainElement.value=this._regex)},_applyActionOnClickFlag:function(){!this.enableSearchFlag&&this.mainElementVisibleFlag&&this._applyProperties({})},_applyDisplayStyle:function(){"lite"===this.displayStyle?(this.enableSearchFlag?this.elements.mainElement.displayStyle="lite":this.elements.mainElement.addClassName("wux-ui-style-lite"),this.elements.expander.addClassName("wux-ui-style-lite")):"normal"===this.displayStyle&&(this.enableSearchFlag?this.elements.mainElement.displayStyle="text":this.elements.mainElement.removeClassName("wux-ui-style-lite"),this.elements.expander.removeClassName("wux-ui-style-lite"))},_applyExpanderIcon:function(){this.elements.icon&&this.elements.icon.remove(),this.elements.icon=s.generateIcon(this.expanderIcon).inject(this.elements.expander),this.elements.icon.addClassName("wux-controls-combobox-icon")},_applySelectAllOnFocus:function(){this.elements.mainElement instanceof o&&(this.elements.mainElement.selectAllOnFocus=this.selectAllOnFocus)},_applyProperties:function(e){var t=this.isDirty("enableSearchFlag")||this.isDirty("actionOnClickFlag")&&!1===this.enableSearchFlag||this.isDirty("mainElementVisibleFlag")||this.isDirty("mainElementContent");t&&(p.call(this),this.mainElementVisibleFlag||(this._getMainElementTag().hide(),this.elements.expander.addClassName("wux-combobox-expander-nomainelement"),this.elements.expander.setAttribute("style","border-left-width:1px;"))),this._parent(e),(this.isDirty("expanderIcon")||t)&&this._applyExpanderIcon(e.expanderIcon),(this.isDirty("placeholder")||t)&&this._applyPlaceholder(e.placeholder),(this.isDirty("autocompleteFlag")||t)&&this._applyAutocompleteFlag(e.autocompleteFlag),!this.isDirty("selectedIndex")&&t&&this._applySelectedIndex(e.selectedIndex),!this.isDirty("selectedIndexes")&&t&&this._applySelectedIndexes(e.selectedIndexes),(this.isDirty("expanderVisibleFlag")||t)&&this._applyExpanderVisibleFlag(e.expanderVisibleFlag),this.isDirty("selectAllOnFocus")&&this._applySelectAllOnFocus()}});return n.register(f,"DS/ControlsRec/AbstractRec"),f.createSelectAllComboBox=function(e,t){let i,n;const s=function(){i.selectedIndexes=[],!0===t.selected&&(i._isAllSelected=!0,i._model.selectAll());i._model.addEventListener("preAddChild",(function(e){i._isAllSelected&&(i._isAllSelected=!1,n.unselect())})),i._model.getXSO().onPreAdd((function(e){i._preventXSOCB||((Array.isArray(e)?-1!==e.indexOf(n):e===n)?(i._isAllSelected=!0,i._preventXSOCB=!0,i._forceNodeChange=!0,i._model.selectAll(),i._forceNodeChange=!1,i._preventXSOCB=!1,i._ignoredNodes.forEach((e=>{e!==n&&i.selectedIndexes.push(e._unfilteredRowID-1)})),i._ignoredNodes=[],-1===i.selectedIndexes.indexOf(e._unfilteredRowID)&&i.selectedIndexes.push(e._unfilteredRowID),i._applySelectedIndexes(),i._properties.preselectedIndex.value=n._unfilteredRowID):i._isAllSelected||i._getSelectedIndexes().length+(Array.isArray(e)?e.length:1)+1!==i._model._numberOfNodesInDocument||(i._isAllSelected=!0,i._preventXSOCB=!0,i._forceNodeChange=!0,n.select(),i._forceNodeChange=!1,i._preventXSOCB=!1))}));i._model.addEventListener("removeChild",(function(e){e.data.nodeModel.isSelected()||i._getSelectedIndexes().length!==i._model._numberOfNodesInDocument-2||i._isAllSelected||(i._isAllSelected=!0,n.select())})),i._model.getXSO().onPreRemove((function(e){i._preventXSOCB||(i._isAllSelected=!1,-1!==e.indexOf(n)?(i._preventXSOCB=!0,i._forceNodeChange=!0,i._model.unselectAll(),i._forceNodeChange=!1,i._preventXSOCB=!1,i._ignoredNodes.forEach((e=>{let t=i._getSelectedIndexes().indexOf(e._getRowID(1));i._isAllSelected&&t--,-1!==t&&i.selectedIndexes.splice(t,1)})),i._ignoredNodes=[],i._removeIndex=!0,i._applySelectedIndexes(),i._removeIndex=!1,i._properties.preselectedIndex.value=n._unfilteredRowID):n.isSelected()&&(i._preventXSOCB=!0,i._forceNodeChange=!0,n.unselect(),i._forceNodeChange=!1,i._preventXSOCB=!1,i._properties.preselectedIndex.value=e[0]._unfilteredRowID))}));i.addEventListener("change",(function(){i._preventXSOCB||(i._getSelectedIndexes().length!==i._model.getChildren().length-1||i._isAllSelected?i._getSelectedIndexes().length!==i._model.getChildren().length&&i._isAllSelected&&(i._isAllSelected=!1,i._preventXSOCB=!0,i._forceNodeChange=!0,n.unselect(),i._forceNodeChange=!1,i._preventXSOCB=!1,i._selectedIndexModified&&i._selectedIndexModified(),i._updateCurrentProperties()):(i._isAllSelected=!0,i._preventXSOCB=!0,i._forceNodeChange=!0,n.select(),i._forceNodeChange=!1,i._preventXSOCB=!1,i._selectedIndexModified&&i._selectedIndexModified(),i._updateCurrentProperties()))}))};return t||(t={}),t.hasOwnProperty("label")||(t.label=a.get("selectAll")),e.completeModel=function(e){n=new l({label:t.label,icon:t.icon,selectAllNode:!0}),e.addChild(n,0)},e.multiSelFlag=!0,e.getMainElementCustomization||(e.getMainElementCustomization=function(){return this._isAllSelected?{label:a.get("All")}:this.getDefaultMainElementCustomization()}),e._isSelectAllCombo=!0,i=new f(e),i.isAllSelected=function(){return this._isAllSelected},i.getSelectAllInfos=function(){return{label:t.label,icon:t.icon}},i._isAllSelected=!1,s(),i.addEventListener("modelLoaded",s),i},f})),define("DS/Controls/TileView",["UWA/Core","UWA/Controls/Abstract","DS/Layouts/GridEngineCellAbstract","DS/Controls/ViewBase","DS/UIBehaviors/SwipeableMenu","DS/Core/PointerEvents","DS/Controls/Toggle","DS/Utilities/Dom"],(function(e,t,i,n,s,o,l,a){"use strict";return n.extend({defaultOptions:{size:"small",view:"tile",picture:{size:"cover",width:null,position:"center center"}},init:function(t){this._parent(t),this._isHighlighted=!1,this.elements.container=new e.Element("div",{class:"wux-controls-tileview wux-ui-size-"+this.options.size,styles:{padding:0}}),this.elements.thumbnail=new e.Element("div",{class:"wux-controls-tileview-container wux-ui-size-"+this.options.size,styles:{border:"none",margin:0}});var i=void 0;(this.options.useSwipableMenu=!0,t.gridEngine&&!1===t.gridEngine.options.useSwipableMenu)?(this.options.useSwipableMenu=!1,this.elements.thumbnail.inject(this.elements.container)):(i=new s({target:this.elements.thumbnail,menu:this.options.menu})).getContent().setStyles({lineHeight:"60px",overflow:"visible"}).inject(this.elements.container);this.elements.picture=new e.Element("div",{class:"wux-controls-tileview-picture",styles:{backgroundImage:"",width:this.options.picture.width?this.options.picture.width:"",backgroundSize:this.options.picture.size,backgroundPosition:this.options.picture.position}}).inject(this.elements.thumbnail),this.elements.checkbox=new l({checkFlag:!1,disabled:!1}).inject(this.elements.picture),this.elements.checkbox.getContent().addClassName("wux-controls-tileview-checkbox wux-ui-size-"+this.options.size);var n=this;this.elements.container.addEvent("mouseenter",(function(e){n.isPreHighlighted||(n.elements.checkbox.getContent().addClassName("wux-ui-state-prehighlighted"),n.isPreHighlighted=!0)})),this.elements.container.addEvent("mouseleave",(function(e){n.isPreHighlighted&&(n.elements.checkbox.getContent().removeClassName("wux-ui-state-prehighlighted"),n.isPreHighlighted=!1)})),this.elements.checkbox.addEventListener(o.POINTERDOWN,(function(e){e.stopPropagation()})),this.elements.checkbox.addEventListener(o.POINTERUP,(function(e){e.stopPropagation()})),this._listenToChanges=!0,this.elements.checkbox.addEventListener("change",(function(e){n._listenToChanges&&(n.isHighlighted()?n.unhighlight():n.highlight())})),this.elements.cartouche=new e.Element("div",{class:"wux-controls-tileview-cartouche",styles:{left:this.options.picture.width?this.options.picture.width:""}}).inject(this.elements.thumbnail),this.elements.cartoucheContent=new e.Element("div",{class:"wux-controls-tileview-cartouche-content"}).inject(this.elements.cartouche),this.elements.icon=new e.Element("div",{class:"wux-controls-tileview-icon wux-ui-size-"+this.options.size,styles:{backgroundImage:"",backgroundSize:"cover"}}).inject(this.elements.cartoucheContent),this.elements.badgeTopRight=new e.Element("div",{class:"wux-controls-tileview-badge-top-right"}).inject(this.elements.cartoucheContent),this.elements.badgeBottomRight=new e.Element("div",{class:"wux-controls-tileview-badge-bottom-right"}).inject(this.elements.cartoucheContent),this.elements.color=new e.Element("div",{class:"wux-controls-tileview-color"}).inject(this.elements.container),this.elements.colorBlank=new e.Element("div",{class:"wux-controls-tileview-colorBlank"}).inject(this.elements.container),this.elements.title=new e.Element("div",{class:"wux-controls-tileview-title wux-font-3dsregular"}).inject(this.elements.cartoucheContent),this.elements.subtitle=new e.Element("div",{class:"wux-controls-tileview-subtitle",html:"Sous-titre"}).inject(this.elements.cartoucheContent),this.elements.menu=new e.Element("div",{class:"wux-controls-tileview-menu wux-ui-size-"+this.options.size}).inject(this.elements.cartoucheContent),this.elements.menu.addClassName("wux-ui-3ds"),this.elements.menu.addClassName("wux-ui-3ds-open-down"),this.elements.description=new e.Element("div",{class:"wux-controls-tileview-description",html:"Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts. Separated they live in Bookmarksgrove right at the coast of the ..."}).inject(this.elements.cartoucheContent),this.elements.menu.addEvent(o.POINTERDOWN,(function(e){e.preventDefault();var t=this.cellView;if(t){var s=t.getCellInfos();s.cellModel&&s.cellModel.isSelected()&&e.stopPropagation()}!0===n.options.useSwipableMenu&&i._indexPositions()})),this.elements.menu.addEvent(o.POINTERUP,(function(e){e.preventDefault(),!0===n.options.useSwipableMenu&&i.toggle()})),this.setColor(this.options.color),this.setIcon(this.options.icon),this._attachEvents()},setIcon:function(e){this.elements.icon.className="",this.elements.icon.addClassName("wux-controls-tileview-icon wux-ui-size-"+this.options.size),e?(this.elements.container.setAttribute("has-icon","true"),this.elements.icon.setAttribute("has-icon","true"),a.generateIcon(e,{target:this.elements.icon}),this.elements.icon.show()):(this.elements.container.setAttribute("has-icon","false"),this.elements.icon.setAttribute("has-icon","false"),this.elements.icon.hide())},isHighlighted:function(){return this._isHighlighted},highlight:function(){this._isHighlighted=!0,this.elements.container.addClassName("wux-ui-state-highlighted"),this.elements.checkbox.getContent().addClassName("wux-ui-state-highlighted"),!0!==this.elements.checkbox.checkFlag&&(this._listenToChanges=!1,this.elements.checkbox.checkFlag=!0,this._listenToChanges=!0)},unhighlight:function(){this._isHighlighted=!1,this.elements.container.removeClassName("wux-ui-state-highlighted"),this.elements.checkbox.getContent().removeClassName("wux-ui-state-highlighted"),!1!==this.elements.checkbox.checkFlag&&(this._listenToChanges=!1,this.elements.checkbox.checkFlag=!1,this._listenToChanges=!0)},activate:function(){this.elements.container.addClassName("wux-ui-state-activated")},deactivate:function(){this.elements.container.removeClassName("wux-ui-state-activated")}})})),define("DS/Controls/TileCellView",["UWA/Core","DS/Controls/TileView","DS/Layouts/GridEngineCellAbstract","DS/UIBehaviors/ContextualMenuManager","DS/Core/PointerEvents","DS/Menu/ContextualMenu","DS/Utilities/Dom"],(function(e,t,i,n,s,o,l){"use strict";function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}return i.extend({defaultOptions:{size:"small",menu:[]},init:function(e){var i=e.menu;e.menu=[],this._CtxMenuByRightClick=!0,this._parent(e),this.elements.container.setStyles({border:"none"}),this.elements.container.setAttribute("draggable","true"),this.elements.container.dsView=this,this._view=new t(this.options).inject(this.elements.container),this._view.elements.menu.cellView=this;var o=this;this._view.elements.checkbox.addEventListener(s.POINTERDOWN,(function(e){e.stopPropagation()})),this._view.elements.checkbox.addEventListener(s.POINTERUP,(function(e){e.stopPropagation()})),this._view.elements.checkbox.addEventListener("click",(function(e){o.getGridEngine()&&!0===o.getGridEngine()._isTouchWithatCellHover&&(o.getGridEngine()._isTouchWithatCellHover=!1,e.stopPropagation(),o.getGridEngine()._enableInteractiveMultiSelMode())}),!0),this._view._listenToChanges=!0,this._view.elements.checkbox.addEventListener("change",(function(e){if(o._view._listenToChanges){var t=o.getGridEngine(),i=o.getCellInfos();t&&i&&(t._enableInteractiveMultiSelMode(),i.cellModel.isSelected()?i.cellModel.unselect():(t.options.selection.canMultiSelect||t.options.TreedocModel.getXSO().empty(),i.cellModel.select()),t.options.lastSelectedNode=i.cellModel)}})),this.setupContextualMenu(i),this.getGridEngine().options.onContextualEvent?this._view.elements.menu.addEventListener(s.POINTERUP,(function(e){var t=this.cellView;if(o._CtxMenuByRightClick=!1,!s.isTouchEvent(e)||!t.getGridEngine()._preventSelectionForTouchScroll){var i=t.getCellInfos();if(i){var n=i.nodeModel;n&&!n.isSelected()&&(n.select(!0),t.getGridEngine().setActiveNode(n,!0))}if(t.getGridEngine().options.onContextualEvent){var l=document.createEvent("HTMLEvents");l.initEvent("contextmenu",!0,!1),l.pageX=e.pageX,l.pageY=e.pageY,this.dispatchEvent(l)}o._CtxMenuByRightClick=!0,e.stopPropagation()}})):this._view.elements.menu.addEventListener(s.POINTERDOWN,(function(e){var t=this.cellView;o._CtxMenuByRightClick=!1,n.show(t._view.elements.container,[e.pageX,e.pageY]),o._CtxMenuByRightClick=!0}))},setupContextualMenu:function(e){var t=this,i=this.getGridEngine().options.onContextualEvent;if(i)o.addEventListener(this.elements.container,{callback:function(e){if(t.getGridEngine()&&(t.getGridEngine()._cellCtxMenuRequired=!0,!0===t._CtxMenuByRightClick)){var n=t.getCellInfos();if(n){var s=n.nodeModel;s&&!s.isSelected()&&(s.select(!0),t.getGridEngine().setActiveNode(s,!0))}}return i.callback.call(i.this,{context:t,menuContext:e.context,infos:e.info,data:e.data,cellInfos:t.getCellInfos()})}});else{var s=this.getGridEngine().options.onContextualMenuReady,l=s;"function"==typeof s&&(l=function(){var e=t.getCellInfos();if(e&&!0===t._CtxMenuByRightClick){var i=e.nodeModel;i&&!i.isSelected()&&(i.select(!0),t.getGridEngine().setActiveNode(i,!0))}return s.call(t,e)}),n.forget({target:this._view.elements.container,nodes:l}),n.onReady({target:this._view.elements.container,nodes:l})}},updateInternalParameters:function(){this.setColor(),this.setTitle(),this.setSubtitle(),this.setDescription(),this.unhighlight(),this.deactivate(),this.unsetBadges()},setColor:function(e){this._view.setColor(e)},setIcon:function(e){this._view.setIcon(e)},setTitle:function(e){this._view.setTitle(e),(!this.getGridEngine()||this.getGridEngine()&&"function"==typeof this.getGridEngine().getShouldDisplayTooltipFlag&&!0===this.getGridEngine().getShouldDisplayTooltipFlag())&&(this.elements.container.title=e)},setSubtitle:function(e){this._view.setSubtitle(e)},setDescription:function(e){this._view.setDescription(e)},setPicture:function(e){this._view.setPicture(e)},highlight:function(){this._view.highlight()},unhighlight:function(){this._view.unhighlight()},activate:function(){this._view.activate()},deactivate:function(){this._view.deactivate()},getCellInfos:function(){var e=this._parent(),t=this.getVirtualCoordinates();return e.nodeModel=this.getGridEngine().getCellModel(t.virtualRowID,t.virtualColumnID),e},setPictureBackgroundSize:function(e){this._view&&this._view.elements.picture&&this._view.elements.picture.setStyle("background-size",e)},unsetBadges:function(){this._view.elements.badgeTopRight.style.backgroundImage="",this._view.elements.badgeTopRight.style.visibility="hidden",this._view.elements.badgeTopRight.className="",this._view.elements.badgeTopRight.addClassName("wux-controls-tileview-badge-top-right"),this._view.elements.badgeBottomRight.style.backgroundImage="",this._view.elements.badgeBottomRight.style.visibility="hidden",this._view.elements.badgeBottomRight.className="",this._view.elements.badgeBottomRight.addClassName("wux-controls-tileview-badge-bottom-right")},setBadges:function(e){for(var t in e){var i=e[t];i&&(l.generateIcon(i,{target:this._view.elements["badge"+a(t)]}),this._view.elements["badge"+a(t)].style.visibility="visible")}}})}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Expander",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Utilities/Dom","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils","DS/CoreBase/WebUXGlobalEnums"],(function(e,t,i,n,s,o,l,a,r,h){"use strict";var u="wux-controls-expander";function c(){this.elements.icon&&(this.elements.icon.remove(this.elements.iconPlaceholder),delete this.elements.icon);var e=s.generateIcon(this.icon);e?(this.elements.icon=e,this.elements.iconPlaceholder.show(),this.elements.icon.style.margin="0px",this.elements.icon.inject(this.elements.iconPlaceholder)):this.elements.iconPlaceholder.hide()}function d(){var e=2;return this._getCurrentTouchMode()?(e+=38,this.elements.icon&&(e+=19)):(e+=26,this.elements.icon&&(e+=17)),e}function p(){return this._getCurrentTouchMode()?38:26}function m(e){var t,i=this.getContent(),n=null===(t=this.elements)||void 0===t?void 0:t.header,s=e.target;if(!i||!n||!s)return!1;if(!this.interactiveFlag)return!1;for(;s&&s!==i;){if(s===n)return!0;s=s.parentNode}return!1}function g(){var e,t=null===(e=this.elements)||void 0===e?void 0:e.customHeader;t&&(t.classList.contains(u+"-customHeader")||t.classList.add(u+"-customHeader"),t.removeAttribute("near"),t.removeAttribute("far"),t.removeAttribute("alone"),t.setAttribute("near"===this.customHeaderPosition?"near":"far",""),this.header||this.icon||t.setAttribute("alone",""))}var f=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return r.extendingClassFlag||n.addKeyMapsAndCommands({space:{keydown:"consume",keyup:"toggle"}},{consume:function(){},toggle:function(e){m.call(this,e)&&this.toggle()}}),n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{header:{defaultValue:"",type:"string",category:"Appearance"},body:{defaultValue:void 0,type:"HTMLElement",category:"Behavior"},interactiveFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},expandedFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},style:{defaultValue:"filled-separate",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"object",category:"Appearance"},height:{defaultValue:"auto",type:"string",category:"Appearance"},orientation:{defaultValue:"vertical",type:"string",category:"Behavior"},customHeader:{defaultValue:void 0,type:"object",category:"Behavior"},customHeaderPosition:{defaultValue:"far",type:"string",category:"Appearance"},allowUnsafeHTMLHeader:{defaultValue:void 0,type:"boolean",category:"Behavior"},headerTooltipInfos:{defaultValue:void 0,type:"TooltipModel | WUX.TooltipModelProperties",category:"Accessibility"},stretchableContentFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},usePaddingFlag:{defaultValue:!0,type:"boolean",category:"Appearance"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName(u+"-placeholder"),this.elements.container.addClassName(u),this.elements.expanderContainer=new i.Element("div",{class:u+"-container"}).inject(this.elements.container),this.elements.header=new i.Element("div",{class:u+"-header",tabindex:0}).inject(this.elements.expanderContainer),this.elements.headerArrow=new i.Element("div",{class:u+"-arrow wux-ui-3ds wux-ui-3ds-expand-down"}).inject(this.elements.header),this.elements.iconPlaceholder=new i.Element("div",{class:"wux-expander-icon-placeholder"}).inject(this.elements.header),this.elements.headerContainer=new i.Element("div",{class:u+"-header-container"}).inject(this.elements.header),this.elements.bodyContainer=new i.Element("div",{class:u+"-body"}).inject(this.elements.expanderContainer)},t.prototype.handleEvents=function(){var e=this;s.addEventOnElement(this,this.elements.header,"blur",(function(t){e.getContent().removeClassName("wux-isMouseFocused")})),s.addEventOnElement(this,this.elements.header,o.POINTERHIT,(function(t){t.preventDefault(),m.call(e,t)&&(e.getContent().addClassName("wux-isMouseFocused"),e.setPropertyFromUIInteraction("expandedFlag",!e.expandedFlag))})),s.addEventOnElement(this,this.elements.bodyContainer,"transitionend",(function(t){t.target===e.elements.bodyContainer&&e.fire("dimensionsChanged")}))},t.prototype._applyInteractiveFlag=function(){this.interactiveFlag?this.getContent().removeAttribute("no-interaction"):this.getContent().setAttributeNode(document.createAttribute("no-interaction"))},t.prototype._applyExpandedFlag=function(e){e&&e===this.expandedFlag||(!0===this.expandedFlag?this._expand():this._close()),"100%"===this.height&&this.expandedFlag?this.elements.expanderContainer.setStyle("height","100%"):this.elements.expanderContainer.setStyle("height",""),this.elements.bodyContainer.inert=!this.expandedFlag},t.prototype._applyDisabled=function(t){e.prototype._applyDisabled.call(this),this.disabled?(this.elements.header.tabIndex=-1,this.elements.contentDisabler||(this.elements.contentDisabler=l.createContentDisablerDiv()),this.elements.bodyContainer.appendChild(this.elements.contentDisabler),this.customHeader&&(this.elements.customHeaderDisabler||(this.elements.customHeaderDisabler=l.createContentDisablerDiv()),this.elements.customHeader.appendChild(this.elements.customHeaderDisabler))):(this.elements.header.tabIndex=0,this.elements.contentDisabler&&this.elements.contentDisabler.remove(),this.elements.customHeaderDisabler&&this.elements.customHeaderDisabler.remove())},t.prototype._applyHeader=function(){if(l.getUnsafeHTMLContentValueToApply(this.allowUnsafeHTMLHeader))this.elements.headerContainer.innerHTML='<h5 class="headerTitle" >'+this.header+" </h5> ";else{this.elements.headerContainer.innerHTML="";var e=new i.Element("h5",{class:"headerTitle"});e.textContent=this.header,e.inject(this.elements.headerContainer)}this.header&&"horizontal"!==this.orientation?this.elements.headerContainer.show():this.elements.headerContainer.hide()},t.prototype._applyBody=function(e){this.body&&this.elements.bodyContainer&&(e&&e.remove(),i.is(this.body,"element")&&(this.body=new i.extendElement(this.body)),this.body.inject(this.elements.bodyContainer))},t.prototype._applyTouchMode=function(t){e.prototype._applyTouchMode.call(this),!0===this._getCurrentTouchMode()?(this.elements.header.setAttributeNode(document.createAttribute("touch-mode")),this.elements.headerContainer.setAttributeNode(document.createAttribute("touch-mode")),this.elements.headerArrow.setAttributeNode(document.createAttribute("touch-mode")),this.elements.bodyContainer.setAttributeNode(document.createAttribute("touch-mode")),this.elements.iconPlaceholder.setAttributeNode(document.createAttribute("touch-mode"))):(this.elements.header.removeAttribute("touch-mode"),this.elements.headerArrow.removeAttribute("touch-mode"),this.elements.headerContainer.removeAttribute("touch-mode"),this.elements.bodyContainer.removeAttribute("touch-mode"),this.elements.iconPlaceholder.removeAttribute("touch-mode"))},t.prototype._applyStyle=function(e){e&&this.elements.expanderContainer.removeClassName(u+"-"+e),this.elements.expanderContainer.addClassName(u+"-"+this.style),"mode-selector"===this.style&&(this.elements.iconPlaceholder.inject(this.elements.headerArrow,"before"),this.elements.headerContainer.inject(this.elements.iconPlaceholder,"before"))},t.prototype._applyOrientation=function(e){this.elements.headerContainer.hide(),"horizontal"===this.orientation?(this.elements.container.setAttributeNode(document.createAttribute("horizontal")),this.elements.expanderContainer.setAttributeNode(document.createAttribute("horizontal")),this.elements.bodyContainer.setAttributeNode(document.createAttribute("horizontal")),this.elements.headerContainer.setAttributeNode(document.createAttribute("horizontal")),this.elements.header.setAttributeNode(document.createAttribute("horizontal")),this.expandedFlag&&("mode-selector"!==this.style?(this.elements.headerArrow.addClassName("wux-ui-3ds-expand-left"),this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down")):(this.elements.headerArrow.addClassName("wux-ui-3ds-expand-up"),this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down"))),this.elements.bodyContainer.style.maxWidth="calc(100% - "+(20+d.call(this))+"px)",this.elements.bodyContainer.style.maxHeight=""):(this.header&&this.elements.headerContainer.show(),this.elements.container.removeAttribute("horizontal"),this.elements.expanderContainer.removeAttribute("horizontal"),this.elements.bodyContainer.removeAttribute("horizontal"),this.elements.headerContainer.removeAttribute("horizontal"),this.elements.header.removeAttribute("horizontal"),this.expandedFlag&&("mode-selector"!==this.style?(this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-left"),this.elements.headerArrow.addClassName("wux-ui-3ds-expand-down")):(this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down"),this.elements.headerArrow.addClassName("wux-ui-3ds-expand-up"))),this.elements.bodyContainer.style.maxWidth=""),this._applyHeight()},t.prototype._applyHeight=function(e){if("auto"===this.height&&"horizontal"===this.orientation?this.elements.container.setStyles({position:"absolute",height:"auto",top:0,bottom:0}):this.elements.container.setStyles({position:"",height:this.height}),"vertical"===this.orientation)if("100%"===this.height)this.elements.bodyContainer.style.maxHeight="calc( 100% - "+(20+p.call(this))+"px)",this._applyExpandedFlag();else{var t="number"==typeof this.height?this.height:parseInt(this.height);this.elements.bodyContainer.style.maxHeight="calc("+t+"px - "+(20+p.call(this))+"px)"}},t.prototype._applyIcon=function(){"object"==typeof this.icon&&this.icon&&(this.icon.iconClasses||(this.icon.iconClasses=""),this.icon.iconName||(this.icon.iconName=""),this.icon.fontIconFamily||(this.icon.fontIconFamily=h.WUXManagedFontIcons.FontAwesome),this.icon.fontIconSize||(this.icon.fontIconSize="1x")),c.call(this),"horizontal"===this.orientation&&(this.elements.bodyContainer.style.maxWidth="calc(100% - "+d.call(this)+"px)")},t.prototype._applyCustomHeader=function(e,t){this.elements.customHeader&&e&&this.elements.customHeader.removeChild(e.getContent?e.getContent():e),t&&(this.elements.customHeader||(this.elements.customHeader=i.createElement("div"),this.elements.header.appendChild(this.elements.customHeader)),g.call(this),this.elements.customHeader.appendChild(t.getContent?t.getContent():t))},t.prototype._applyCustomHeaderPosition=function(){g.call(this)},t.prototype._applyAllowUnsafeHTMLHeader=function(){this._applyHeader()},t.prototype._applyHeaderTooltipInfos=function(){this.elements.header.tooltipInfos=this.headerTooltipInfos},t.prototype._applyStretchableContentFlag=function(){this.elements.container&&(this.stretchableContentFlag?this.elements.container.addClassName("wux-controls-expander-stretchable-content"):this.elements.container.removeClassName("wux-controls-expander-stretchable-content"))},t.prototype._applyUsePaddingFlag=function(e){this.usePaddingFlag?this.elements.bodyContainer.removeAttribute("no-padding"):this.elements.bodyContainer.setAttributeNode(document.createAttribute("no-padding"))},t.prototype._applyProperties=function(t){(this.isDirty("customHeader")||this.isDirty("customHeaderPosition"))&&this._applyCustomHeader(t.customHeader,this.customHeader),e.prototype._applyProperties.call(this,t),this.isDirty("expandedFlag")&&this._applyExpandedFlag(t.expandedFlag),(this.isDirty("header")||this.isDirty("allowUnsafeHTMLHeader"))&&this._applyHeader(),this.isDirty("body")&&this._applyBody(t.body),this.isDirty("style")&&this._applyStyle(t.style),this.isDirty("icon")&&this._applyIcon(),this.isDirty("orientation")&&this._applyOrientation(t.orientation),this.isDirty("headerTooltipInfos")&&this._applyHeaderTooltipInfos(),this.isDirty("stretchableContentFlag")&&this._applyStretchableContentFlag(),this.isDirty("usePaddingFlag")&&this._applyUsePaddingFlag(t.usePaddingFlag)},t.prototype._expand=function(){this.elements.header.setAttributeNode(document.createAttribute("expanded")),this.elements.expanderContainer.addClassName(u+"-toggle"),this.elements.bodyContainer.addClassName(u+"-body-toggle"),"mode-selector"!==this.style?(this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-right"),"horizontal"===this.orientation?this.elements.headerArrow.addClassName("wux-ui-3ds-expand-left"):this.elements.headerArrow.addClassName("wux-ui-3ds-expand-down")):(this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down"),this.elements.headerArrow.addClassName("wux-ui-3ds-expand-up")),this.elements.bodyContainer.style.overflow="",this.fire("expand")},t.prototype._close=function(){this.elements.header.removeAttribute("expanded"),this.elements.expanderContainer.removeClassName(u+"-toggle"),this.elements.bodyContainer.removeClassName(u+"-body-toggle"),"mode-selector"!==this.style?(this.elements.headerArrow.addClassName("wux-ui-3ds-expand-right"),this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-down"),this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-left")):(this.elements.headerArrow.addClassName("wux-ui-3ds-expand-down"),this.elements.headerArrow.removeClassName("wux-ui-3ds-expand-up")),this.elements.bodyContainer.style.overflow="hidden",this.fire("collapse")},t.prototype.expand=function(){this.expandedFlag=!0},t.prototype.close=function(){this.expandedFlag=!1},t.prototype.toggle=function(){!0===this.expandedFlag?this.close():this.expand()},t.prototype._getCustomContent=function(){var e,t,i=[];return(null===(e=null==this?void 0:this.elements)||void 0===e?void 0:e.customHeader)&&i.push(this.elements.customHeader),(null===(t=null==this?void 0:this.elements)||void 0===t?void 0:t.bodyContainer)&&i.push(this.elements.bodyContainer),i},t}(n);return a.addClass(f,"expander"),f}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Accordeon",["require","exports","DS/Controls/Abstract","DS/Controls/Expander","DS/Utilities/Dom","DS/Core/WebUXComponents"],(function(e,t,i,n,s,o){"use strict";var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{items:{defaultValue:[],type:"array",category:"Behavior"},exclusive:{defaultValue:!0,type:"boolean",category:"Behavior"},collapsibleFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},style:{defaultValue:"filled-separate",type:"string",category:"Appearance"},stretchableChildrenFlag:{defaultValue:!1,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-accordeon-container"),this._expanderItems=[],this._weightItems=[]},t.prototype.handleEvents=function(){var e=this;function t(t){t.dsModel!==e&&(t.stopImmediatePropagation(),t.dsModel&&e._expanderItems.every((function(i,n){return i!==t.dsModel||(e.fire(event.type,{expanderIndex:n,expanderTarget:i}),!1)})))}this.addEventListener("expand",t),this.addEventListener("collapse",t)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("items")&&this._applyItems(),this.isDirty("style")&&this._applyStyle(),this.isDirty("stretchableChildrenFlag")&&this._applyStretchableChildrenFlag()},t.prototype._applyTouchMode=function(){var e=this._getCurrentTouchMode();!0===e?this.getContent().setAttributeNode(document.createAttribute("touch-mode")):this.getContent().removeAttribute("touch-mode");for(var t=0;t<this._expanderItems.length;t++)this._expanderItems[t].touchMode=e},t.prototype._applyDisabled=function(){for(var e=0;e<this._expanderItems.length;e++)this._expanderItems[e].disabled=this.disabled},t.prototype._applyItems=function(){for(var e=this,t=e._expanderItems.length;t>=0;t--)this._expanderItems[t]&&this._expanderItems[t].remove(),this._expanderItems.splice(t,1);e.items.forEach((function(t){e._addItem(t)}))},t.prototype._applyExclusive=function(){if(this.exclusive)for(var e=null,t=0;t<this._expanderItems.length;t++){var i=this._expanderItems[t];i&&i.expandedFlag&&(e&&i!==e?i.close():e=i)}},t.prototype._applyCollapsibleFlag=function(){for(var e=a.call(this),t=0;t<this._expanderItems.length;t++){var i;(i=this._expanderItems[t])&&(i.interactiveFlag=this.collapsibleFlag||!e||e!==i)}this.collapsibleFlag||r.call(this)&&(i=this._expanderItems[0])&&i.expand()},t.prototype._applyStyle=function(){for(var e=0;e<this._expanderItems.length;e++)this._expanderItems[e].style=this.style},t.prototype._applyStretchableChildrenFlag=function(){this.elements.container&&(this.stretchableChildrenFlag?this.elements.container.addClassName("wux-controls-accordeon-stretchable-children"):this.elements.container.removeClassName("wux-controls-accordeon-stretchable-children"))},t.prototype.addItem=function(e){return this.items.push(e),this._addItem(e)},t.prototype._addItem=function(e){var t={},i=n.prototype.publishedProperties;Object.keys(i).forEach((function(i){e.hasOwnProperty(i)&&(t[i]=e[i])})),t.style=this.style,t.body=e.body||e.content,t.touchMode=e.touchMode||this._getCurrentTouchMode(),this.elements.expander=new n(t).inject(this.elements.container),this.stretchableChildrenFlag&&(void 0===e.weight?(this._weightItems.push(1),this.elements.expander.stretchableContentFlag=!0):void 0!==e.weight&&!isNaN(e.weight)&&e.weight>0?(this._weightItems.push(e.weight),this.elements.expander.stretchableContentFlag=!0):this._weightItems.push(0));var o=this._getFirstUnusedID();this.elements.expander._expanderId=o,this.elements.expander.elements.container.attributes.identifier=o,this._expanderItems.push(this.elements.expander);var l=this;return s.addEventOnElement(this,this.elements.expander,"expand",(function(e){if(l.exclusive){for(var t=0;t<l._expanderItems.length;t++){(i=l._expanderItems[t])&&i.expandedFlag&&i!==this&&(i.close(),i.interactiveFlag=!0,i.stretchableContentFlag&&(i.getContent().style.flex="0 1 0px"))}this.interactiveFlag=l.collapsibleFlag}else{for(t=0;t<l._expanderItems.length;t++){var i;(i=l._expanderItems[t])&&(i.interactiveFlag=!0)}this.interactiveFlag=l.collapsibleFlag||!a.call(l)}if(l.stretchableChildrenFlag){var n=l._expanderItems.indexOf(this);l._weightItems[n]>0&&(this.getContent().style.flex=l._weightItems[n].toString()+" 0 0px")}})),s.addEventOnElement(this,this.elements.expander,"collapse",(function(e){if(l.collapsibleFlag)l.stretchableChildrenFlag&&(this.getContent().style.flex="0 1 0px");else if(r.call(l)){if(this.expand(),l.stretchableChildrenFlag){var t=l._expanderItems.indexOf(this);this.getContent().style.flex=l._weightItems[t].toString()+" 0 0px"}}else{var i=a.call(l);i&&(i.interactiveFlag=!1)}})),e.expandedFlag&&this.expandItem(this.getIndexFromId(o)),o},t.prototype.deleteItem=function(e){this._expanderItems[e]&&this._expanderItems[e].remove(),this._expanderItems.splice(e,1),this.items.splice(e,1)},t.prototype._getFirstUnusedID=function(){for(var e=[],t=0;t<this._expanderItems.length;t++)e[this._expanderItems[t]._expanderId]=1;for(var i=0;i<e.length;i++)if(1!==e[i])return i;return e.length},t.prototype.updateItem=function(e,t){var i=this.items[e];i&&(i.header=t.header||i.header,i.body=t.body||i.body,i.icon=t.icon||i.icon,i.customHeader=t.customHeader||i.customHeader,i.customHeaderPosition=t.customHeaderPosition||i.customHeaderPosition);var n=this._expanderItems[e];n&&n.setProperties(i)},t.prototype.expandItem=function(e){if(this.exclusive)for(var t=0;t<this._expanderItems.length;t++)e!==t&&!0===this._expanderItems[t].expandedFlag&&this._expanderItems[t].close();this._expanderItems[e].expand()},t.prototype.closeItem=function(e){this._expanderItems[e].close()},t.prototype.clear=function(){for(;this.items.length>0;)this.deleteItem(0)},t.prototype.getIndexFromId=function(e){for(var t=0;t<this._expanderItems.length;t++)if(this._expanderItems[t]._expanderId===e)return t;return-1},t.prototype.getIndexFrom=function(e){if(void 0!==e.id)return this.getIndexFromId(e.id);var t=void 0!==e.header?"header":void 0!==e.body||void 0!==e.content?"body":void 0;if(t)for(var i=0;i<this._expanderItems.length;i++)if(this._expanderItems[i][t]===e[t])return i;return-1},t.prototype.getExpanderFromIndex=function(e){return this._expanderItems[e]},t}(i);function a(){for(var e=!1,t=0;t<this._expanderItems.length;t++){var i=this._expanderItems[t];if(i&&i.expandedFlag){if(e)return!1;e=i}}return e}function r(){for(var e=0;e<this._expanderItems.length;e++){var t=this._expanderItems[e];if(t&&t.expandedFlag)return!1}return!0}return o.addClass(l,"accordeon"),l}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/UserCard",["require","exports","i18n!./assets/nls/translation","DS/Core/WebUXComponents","DS/Core/PointerEvents","DS/Utilities/DateUtils","DS/Utilities/Dom","DS/Controls/BaseCard","DS/Controls/Button","./typings/types","DS/CoreBase/WebUXGlobalEnums"],(function(e,t,i,n,s,o,l,a,r){"use strict";var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{picture:{defaultValue:void 0,type:"string",category:"Appearance"},name:{defaultValue:void 0,type:"string",category:"Appearance"},trigram:{defaultValue:void 0,type:"string",category:"Appearance"},email:{defaultValue:void 0,type:"string",category:"Appearance"},presence:{defaultValue:void 0,type:"string",category:"Appearance"},subPresence:{defaultValue:void 0,type:"string",category:"Appearance"},presenceDate:{defaultValue:void 0,type:"Date",category:"Appearance"},role:{defaultValue:void 0,type:"string",category:"Appearance"},company:{defaultValue:void 0,type:"string",category:"Appearance"},externalFlag:{defaultValue:void 0,type:"boolean",category:"Appearance"},country:{defaultValue:void 0,type:"boolean",category:"Appearance"},followFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},actionsFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},mainAction:{defaultValue:void 0,type:"WUX.LinkDefinition | WUX.FunctionDefinition"},onFollow:{defaultValue:void 0,type:"WUX.FunctionDefinition"},onChat:{defaultValue:void 0,type:"WUX.FunctionDefinition"},onCall:{defaultValue:void 0,type:"WUX.FunctionDefinition"},onVisio:{defaultValue:void 0,type:"WUX.FunctionDefinition"},onScreenSharing:{defaultValue:void 0,type:"WUX.FunctionDefinition"}}},enumerable:!1,configurable:!0}),t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("picture")&&this._applyPicture(),this.isDirty("name")&&this._applyName(),this.isDirty("mainAction")&&this._applyMainAction(),this.isDirty("email")&&this._applyEmail(),this.isDirty("trigram")&&this._applyTrigram(),this.isDirty("role")&&this._applyRole(),(this.isDirty("presence")||this.isDirty("subPresence")||this.isDirty("presenceDate"))&&this._updatePresence(),this.isDirty("company")&&this._applyCompany(),this.isDirty("externalFlag")&&this._applyExternalFlag(),this.isDirty("country")&&this._applyCountry(),(this.isDirty("followFlag")||this.isDirty("actionsFlag"))&&this._applyActionsFlag()},t.prototype._preBuildView=function(t){this._updateContainer_header&&(this._classId="usercard",e.prototype._preBuildView.call(this,t))},t.prototype._applyPicture=function(){var e=this;this._updateElement({name:"header_picture",parentName:"header",nextSiblingsNames:["header_title"],shouldAddElement:function(){return!0},fillElement:function(){var t,i=e.externalFlag;null===(t=e._elements.header_picture.firstElementChild)||void 0===t||t.remove(),e._elements.header_picture.appendChild(e.picture?l.generateIcon({iconPath:"url(".concat(e.picture,")"),avatarSize:5,externalFlag:i}):l.generateIcon({userName:e.name||"",avatarSize:5,externalFlag:i}))}})},t.prototype._applyName=function(){var e=this;this._updateElement({name:"header_text_name",parentName:"header_text",nextSiblingsNames:["header_text_trigram","header_text_email"],shouldAddElement:function(){return!0},createElement:function(){var t=document.createElement("div");return e._bindMainActionToElt(t),t},fillElement:function(){e._elements.header_text_name.textContent=e.name||""}}),void 0===this.picture&&this._applyPicture()},t.prototype._applyMainAction=function(){this._elements.header_text_name&&(void 0!==this.mainAction?this._elements.header_text_name.setAttributeNode(document.createAttribute("has-callback")):this._elements.header_text_name.removeAttribute("has-callback"))},t.prototype._applyEmail=function(){this._updateHeaderSubtext()},t.prototype._applyTrigram=function(){this._updateHeaderSubtext()},t.prototype._updateHeaderSubtext=function(){var e=this,t=void 0!==this.trigram,i=void 0!==this.email&&!t,n=t?this.trigram:this.email;this._updateElement({name:"header_text_trigram",parentName:"header_text",nextSiblingsNames:[],shouldAddElement:function(){return t},fillElement:t?function(){e._elements.header_text_trigram.textContent=n||""}:void 0}),this._updateElement({name:"header_text_email",parentName:"header_text",nextSiblingsNames:[],shouldAddElement:function(){return i},fillElement:i?function(){e._elements.header_text_email.textContent=n||""}:void 0})},t.prototype._applyPresence=function(){this._updatePresence()},t.prototype._applySubPresence=function(){this._updatePresence()},t.prototype._applyPresenceDate=function(){this._updatePresence()},t.prototype._updatePresence=function(){var e=this;this._updateElement({name:"body_presence_icon",parentName:"body_presence",nextSiblingsNames:["body_presence_text","body_presence_subtext"],shouldAddElement:function(){return!0},fillElement:function(){l.generateIcon({userPresence:e.presence,iconSize:{width:"12px",height:"12px"}},{target:e._elements.body_presence_icon})}}),this._updateElement({name:"body_presence_text",parentName:"body_presence",nextSiblingsNames:["body_presence_subtext"],shouldAddElement:function(){return!0},fillElement:function(){e._elements.body_presence_text.textContent=i[e.presence]}});var t,n=void 0!==this.subPresence&&("busy"===this.presence&&("inCall"===this.subPresence||"inMeeting"===this.subPresence)||"dnd"===this.presence&&"presenting"===this.subPresence),s=(new Date).getTime(),a=this.presenceDate&&this.presenceDate.getTime(),r=!n&&["offline","away"].includes(this.presence)&&this.presenceDate&&a<s,h=!r&&"out"===this.presence&&this.presenceDate&&s<a,u=0,c=function(){var s="",l={dateStyle:"short"};if(n)s=" - ".concat(i[e.subPresence]||"");else if(r){var c=(t=(new Date).getTime())-a,d=Math.floor(c/6e4),p=Math.floor(c/36e5);u=Math.floor(c/864e5),s=d<1?i.forLessThanAMinute:d<60?" ".concat(i.for," ").concat(d," ").concat(i.minute).concat(d>1?"s":""):p<24?" ".concat(i.for," ").concat(p," ").concat(i.hour).concat(p>1?"s":""):u<3?" ".concat(i.for," ").concat(u," ").concat(i.day).concat(u>1?"s":""):" ".concat(i.since," ").concat(o.formatDateToString(e.presenceDate,l))}else h&&(s=" ".concat(i.until," ").concat(o.formatDateToString(e.presenceDate,l)));e._elements.body_presence_subtext.textContent=s,r&&u>=3?e._stopPresenceUpdate():h&&t>=a&&(e._stopPresenceUpdate(),e._updatePresence())};this._updateElement({name:"body_presence_subtext",parentName:"body_presence",nextSiblingsNames:[],shouldAddElement:function(){return n||r||h},fillElement:c}),this._stopPresenceUpdate(),(r&&(!a||t-a<2592e5)||h&&a&&t<a)&&(this._presenceUpdateInterval=setInterval(c,1e4))},t.prototype._stopPresenceUpdate=function(){null!==this._presenceUpdateInterval&&(clearInterval(this._presenceUpdateInterval),this._presenceUpdateInterval=null)},t.prototype.destroy=function(){this._stopPresenceUpdate(),e.prototype.destroy.call(this)},t.prototype._applyRole=function(){var e=this;this._updateElement({name:"body_role",parentName:"body",nextSiblingsNames:["body_company","body_country"],shouldAddElement:function(){return void 0!==e.role},fillElement:function(){e._elements.body_role.textContent=e.role}})},t.prototype._applyCompany=function(){var e=this;this._updateElement({name:"body_company_details_name",parentName:"body_company_details",nextSiblingsNames:["body_company_details_external"],shouldAddElement:function(){return void 0!==e.company},fillElement:function(){e._elements.body_company_details_name.textContent=e.company}})},t.prototype._applyExternalFlag=function(){var e=this;this._updateElement({name:"body_company_details_external",parentName:"body_company_details",nextSiblingsNames:[],shouldAddElement:function(){return e.externalFlag},fillElement:function(){e._elements.body_company_details_external.textContent="External"}}),this._applyPicture()},t.prototype._applyCountry=function(){var e=this;this._updateElement({name:"body_company_country_flag",parentName:"body_company_country",nextSiblingsNames:["body_company_country_name"],shouldAddElement:function(){return!0},createElement:function(){return document.createElement("img")},fillElement:function(){l.generateIcon({countryFlag:e.country},{target:e._elements.body_company_country_flag})}}),this._updateElement({name:"body_company_country_name",parentName:"body_company_country",nextSiblingsNames:[],shouldAddElement:function(){return!0},fillElement:function(){l.generateIcon({countryFlag:e.country},{target:e._elements.body_company_country_flag}),e._elements.body_company_country_name.textContent=l.getCountryNameFromSymbol(e.country)||""}})},t.prototype._applyFollowFlag=function(){this._updateActions()},t.prototype._applyActionsFlag=function(){this._updateActions()},t.prototype._updateActions=function(){for(var e=this,t=this,i=["user-add","chat","phone","videocamera","monitor"],n=["onFollow","onChat","onCall","onVisio","onScreenSharing"],o=function(o){l._updateElement({name:"footer_".concat(i[o]),parentName:"footer",nextSiblingsNames:i.slice(o+1).map((function(e){return"footer_".concat(e)})),createElement:function(){var l=new r({displayStyle:"lite",label:"lite displayStyle",icon:{iconName:i[o],fontIconFamily:WUXManagedFontIcons.Font3DS},showLabelFlag:!1});return l.getContent().classList.add("wux-".concat(e._classId,"-").concat(0===o?"social":"action","-button")),l.addEventListener(s.POINTERHIT,(function(e){t[n[o]]&&t[n[o]](t)})),l},shouldAddElement:function(){return e.actionsFlag&&(0===o&&e.followFlag||0!==o)}})},l=this,a=0;a<i.length;a++)o(a)},t.prototype.onClick=function(e,t){e.closest(".wux-usercard-footer_user-add")?this.onFollow(this):e.closest(".wux-usercard-footer_chat")?this.onChat(this):e.closest(".wux-usercard-footer_phone")?this.onCall(this):e.closest(".wux-usercard-footer_videocamera")?this.onVisio(this):e.closest(".wux-usercard-footer_monitor")&&this.onScreenSharing(this)},t.prototype._updateContainer_container=function(){},t.prototype._updateContainer_header=function(){this._updateContainerElement({name:"header",parentName:"container",prepend:!0})},t.prototype._updateContainer_header_text=function(){this._updateContainerElement({name:"header_text",parentName:"header",prepend:!1})},t.prototype._updateContainer_body=function(){this._updateContainerElement({name:"body",parentName:"container",prepend:!1,nextSiblingsNames:["footer"]})},t.prototype._updateContainer_body_presence=function(){this._updateContainerElement({name:"body_presence",parentName:"body",prepend:!0})},t.prototype._updateContainer_body_role=function(){this._updateContainerElement({name:"body_role",parentName:"body",prepend:!1,nextSiblingsNames:["body_company","body_country"]})},t.prototype._updateContainer_body_company=function(){this._updateContainerElement({name:"body_company",parentName:"body",prepend:!1,nextSiblingsNames:["body_country"]})},t.prototype._updateContainer_body_company_details=function(){this._updateContainerElement({name:"body_company_details",parentName:"body_company",prepend:!0})},t.prototype._updateContainer_body_company_country=function(){this._updateContainerElement({name:"body_company_country",parentName:"body_company",prepend:!1})},t.prototype._updateContainer_footer=function(){this._updateContainerElement({name:"footer",parentName:"container",prepend:!1,nextSiblingsNames:[]})},t}(a);return n.addClass(h,"userCard"),h}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Tooltip",["require","exports","UWA/Core","DS/Controls/Popup","DS/Utilities/Utils","DS/Controls/StandardTooltipView","DS/Controls/UserCard","DS/Core/TooltipUtils","DS/Core/WebUXComponents"],(function(e,t,i,n,s,o,l,a,r){"use strict";var h=function(){function e(e,t,i){this._visualRZ=null,this._id=e,this._color=t,this.setPosition({left:-1,right:-1,top:-1,bottom:-1})}return Object.defineProperty(e.prototype,"left",{get:function(){return this._left},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this._right},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this._top},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this._bottom},enumerable:!1,configurable:!0}),e.prototype.setPosition=function(e){var t=Object.assign({left:this._left,right:this._right,top:this._top,bottom:this._bottom},e);return this._left=Math.floor(t.left),this._right=Math.floor(t.right),this._top=Math.ceil(t.top),this._bottom=Math.ceil(t.bottom),this},e.prototype.isWUXOffset=function(e){return e.hasOwnProperty("x")||e.hasOwnProperty("y")},e.prototype.setOffset=function(e){return this.isWUXOffset(e)&&(e.hasOwnProperty("x")&&(e.x>0?this._left-=e.x:this._right-=e.x),e.hasOwnProperty("y")&&(e.y>0?this._top-=e.y:this._bottom-=e.y)),this},e.prototype.reset=function(){return this.setPosition({left:-1,right:-1,top:-1,bottom:-1}),this.hide(),this},e.prototype.isPositionInRZ=function(e,t){if(void 0===e||this._left===this._right&&this._top===this._bottom)return!1;var i=t||0;return e.x>=this._left-i&&e.x<=this._right+i&&e.y>=this._top-i&&e.y<=this._bottom+i},e.prototype.show=function(){return this._visualRZ||(this._visualRZ=document.createElement("div"),this._visualRZ.id=this._id,this._visualRZ.style.position="absolute",this._visualRZ.style.zIndex="2147483647",this._visualRZ.style.pointerEvents="none",this._visualRZ.style.border="1px solid "+this._color),this._visualRZ.style.top=this._top+"px",this._visualRZ.style.left=this._left+"px",this._visualRZ.style.width=this._right-this._left+"px",this._visualRZ.style.height=this._bottom-this._top+"px",document.body.appendChild(this._visualRZ),this},e.prototype.hide=function(){return this._visualRZ&&this._visualRZ.remove(),this},e}();function u(){var e=this.target;if(e){var t=null,n=null;if(e.getBoundingClientRect){t=e.getBoundingClientRect();var s=i.extendElement(e);(n=s.getPosition(document.body)).x+=parseInt(s.getStyle("marginLeft"),10),n.y+=parseInt(s.getStyle("marginTop"),10)}else void 0!==e.getContent()&&(t=e.getContent().getBoundingClientRect(),(n=e.getContent().getPosition(document.body)).x+=parseInt(e.getContent().getStyle("marginLeft"),10),n.y+=parseInt(e.getContent().getStyle("marginTop"),10));this._targetRZ.setPosition({left:n.x,top:n.y,right:n.x+t.width,bottom:n.y+t.height}),this.mouseRelativePosition?this._tooltipRZ.setPosition({left:Math.max(n.x,this._lastShowPosition.x-10),top:Math.max(n.y,this._lastShowPosition.y-10),right:this._targetRZ.right,bottom:this._targetRZ.bottom}):this._tooltipRZ.reset()}}function c(){var e=this.target;if(e){var t=e.tooltipInfos.position||a.getDefaultTooltipProperty("position");t&&(this.position=e.tooltipInfos.position);var i=void 0!==e.tooltipInfos.mouseRelativePosition?e.tooltipInfos.mouseRelativePosition:a.getDefaultTooltipProperty("mouseRelativePosition");if(this.mouseRelativePosition=i,i)this.offset={x:15,y:15};else switch(t){case"top":this.offset={x:0,y:-1};break;case"bottom":this.offset={x:0,y:1};break;case"left":this.offset={x:-1,y:0};break;case"right":this.offset={x:1,y:0};break;default:this.offset={x:0,y:0}}}}function d(){f.call(this),this._parentShow(!0),this.target&&a.isReachable(this.target.tooltipInfos)&&(this.elements.container.style.pointerEvents="auto"),this.RESHOW_FLAG=!0,clearTimeout(this.RESHOW_TIMER),this.RESHOW_TIMER=null}function p(){var e={x:0,y:0},t=s.getDocumentWindow(this);e.x=this._mousePosition.x+t.scrollX,e.y=this._mousePosition.y+t.scrollY;var i=this.target&&this.target.tooltipInfos&&!a.isEmpty(this.target.tooltipInfos);this._isShortDisplayVisible=i&&(this.isPositionInRZ(e,"target")||this.touchMode||this.RESHOW_FLAG),this._isShortDisplayVisible&&d.call(this)}function m(){clearTimeout(this.INITIAL_DELAY_TIMER),clearTimeout(this.LONG_TO_SHOW_DELAY),this._hasInitialTimerEnded=!1,this._isShortDisplayVisible=!1,this._isLongDisplayVisible=!1}function g(){this.elements.container&&this.elements.container.setStyles({minWidth:void 0,minHeight:void 0,whiteSpace:void 0})}function f(){var e=this,t=this.target.tooltipInfos;if(a.isTooltipInfoStandard(t)){var i={tooltipModel:t};this.elements._standardTooltipView?this.elements._standardTooltipView.updateModel(i):this.elements._standardTooltipView=new o(i),this.elements.container.firstChild&&this.elements.container.removeChild(this.elements.container.firstChild),this.elements._standardTooltipView.inject(this.elements.container),this.elements.container.classList.remove("wux-controls-tooltip-usercard"),this.elements.container.classList.add("wux-controls-tooltip-standard")}else a.isTooltipInfoUserCard(t)?(this.elements._userCardTooltipView?Object.keys(t).forEach((function(i){e.elements._userCardTooltipView[i]=t[i]})):this.elements._userCardTooltipView=new l(t),this.elements.container.firstChild&&this.elements.container.removeChild(this.elements.container.firstChild),this.elements._userCardTooltipView.inject(this.elements.container),this.elements.container.classList.remove("wux-controls-tooltip-standard"),this.elements.container.classList.add("wux-controls-tooltip-usercard")):(this.elements.container.classList.remove("wux-controls-tooltip-standard"),this.elements.container.classList.remove("wux-controls-tooltip-usercard"));a.willLongDisplay(t)&&(this.LONG_TO_SHOW_DELAY=setTimeout((function(){v.call(e),e._updateView()}),this.target.tooltipInfos.shortToLongDelay))}function v(){var e=this.getView();e&&e.displayLong&&"function"==typeof e.displayLong&&e.displayLong()}function y(e){var t=this.getView();t&&t.updateOverflow&&"function"==typeof t.updateOverflow&&t.updateOverflow(e)}var _=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return e.apply(this,t)||this}return __extends(t,e),t.prototype.show=function(){var t=this.target;if(t&&this.target.tooltipInfos){if(!this.visibleFlag)return a.isEmpty(t.tooltipInfos)||(this.visibleFlag=!0),this;c.call(this),u.call(this),this._parentShow=e.prototype.show,this._setInitialTimer()}return this},t.prototype.hide=function(t){if(this.visibleFlag)this.visibleFlag=!1;else{if(m.call(this),this.target&&void 0!==this.target.tooltipInfos){if(this.RESHOW_FLAG){var i=this;null!==this.RESHOW_TIMER&&(clearTimeout(this.RESHOW_TIMER),this.RESHOW_TIMER=null),this.RESHOW_TIMER=setTimeout((function(){i.RESHOW_FLAG=!1}),this.target.tooltipInfos.reshowDelay||a.getDefaultTooltipProperty("reshowDelay"))}this.target=void 0}g.call(this),e.prototype.hide.call(this,t),this._targetRZ.reset(),this._tooltipRZ.reset()}},t.prototype.isPositionInRZ=function(e,t,i){return"target"===t?this._targetRZ.isPositionInRZ(e,i):"tooltip"===t&&this._tooltipRZ.isPositionInRZ(e,i)},Object.defineProperty(t.prototype,"isShortDisplayVisible",{get:function(){return this._isShortDisplayVisible},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLongDisplayVisible",{get:function(){return this._isLongDisplayVisible},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasInitialTimerEnded",{get:function(){return this._hasInitialTimerEnded},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mousePosition",{set:function(e){this._mousePosition=Object.assign({},e)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"publishedProperties",{get:function(){return{}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t),this._properties.constraint.value="screen",this._properties.autoHide.value=!1,this._properties.position.value="bottom",this._properties.forceKeepOrientation.value=!0,this._isVisibilityManagedByPopupManager=!1,this.elements.container.addClassName("wux-controls-tooltip"),this.INITIAL_DELAY_TIMER=null,this.LONG_TO_SHOW_DELAY=null,this.RESHOW_TIMER=null,this.RESHOW_FLAG=!1,this._targetRZ=new h("visual-target-reaching-zone","red"),this._tooltipRZ=new h("visual-old-tooltip-reaching-zone","blue"),this._lastShowPosition={x:0,y:0}},t.prototype._preInject=function(){var e=this.elements.container;e&&e.setStyles({left:"0px",top:"0px",visibility:"hidden"})},t.prototype._applyPosition=function(){},t.prototype._applyMouseRelativePosition=function(){},t.prototype._applyOverlap=function(){},t.prototype._postInject=function(){var e=this.getView();e&&e.postInjectTooltip&&"function"==typeof e.postInjectTooltip&&e.postInjectTooltip()},t.prototype._updateView=function(){if(this.visibleFlag){var e=this.elements.container,t=s.setConstrainedPosition(this,this.target,{position:this.mouseRelativePosition?"bottom":this.position,alignment:this.alignment,offset:this.offset,constraint:this.constraint,overlap:this.overlap,mouseRelativePosition:this.mouseRelativePosition,mousePosition:this._mousePosition,maxSizeRatioInContainer:.8}),i={minWidth:t.adjustedSize.width,minHeight:t.adjustedSize.height},n=!1;t.size.height>t.adjustedSize.height&&(i.height=t.adjustedSize.height,n=!0),t.size.width>t.adjustedSize.width&&(i.width=t.adjustedSize.width,n=!0),e.setStyles(i),y.call(this,n);var o=this.getContent().getBoundingClientRect(),l=void 0,r=!1;if(this.target&&this.target.tooltipInfos&&(r=a.isReachable(this.target.tooltipInfos),l=void 0!==this.target.tooltipInfos.mouseRelativePosition?this.target.tooltipInfos.mouseRelativePosition:a.getDefaultTooltipProperty("mouseRelativePosition")),r&&(o.width>0||o.height>0)){var h=s.getOffset(this.getContent());l?this._tooltipRZ.setPosition({left:Math.min(this._tooltipRZ.left,h.left),top:Math.min(this._tooltipRZ.top,h.top),right:Math.max(this._tooltipRZ.right,h.left+o.width),bottom:Math.max(this._tooltipRZ.bottom,h.top+o.height)}):this._tooltipRZ.setPosition({left:h.left,top:h.top,right:h.left+o.width,bottom:h.top+o.height}).setOffset(this.offset)}e.style.visibility="visible",this.fire("wux-tooltip-updateview")}},t.prototype._setInitialTimer=function(){var e=this;m.call(this);var t=this.touchMode||this.RESHOW_FLAG?0:this.target.tooltipInfos.initialDelay||a.getDefaultTooltipProperty("initialDelay");this.INITIAL_DELAY_TIMER=setTimeout((function(){e._hasInitialTimerEnded=!0;var t=a.getTooltipPendingPromise(e.target&&e.target.tooltipInfos);t?t.then((function(){p.call(e)})):p.call(e)}),t)},t.prototype.getView=function(){if(this.target){if(a.isTooltipInfoStandard(this.target.tooltipInfos))return this.elements._standardTooltipView;if(a.isTooltipInfoUserCard(this.target.tooltipInfos))return this.elements._userCardTooltipView}},t.prototype.onClick=function(e){var t=this.getView();t&&t.onClick&&"function"==typeof t.onClick&&t.onClick(e)},t}(n);return r.addClass(_,"tooltip"),_}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/SelectionChipsEditor",["require","exports","DS/Controls/Abstract","DS/Controls/SelectionChips","DS/Controls/LineEditor","DS/Utilities/Array","DS/Utilities/Dom","DS/Core/WebUXComponents","UWA/Core","DS/Utilities/WUXUWAUtils"],(function(e,t,i,n,s,o,l,a,r,h){"use strict";var u=function(){function e(e){var t=this;if(("string"==typeof e||Array.isArray(e))&&e&&e.length){var i=(this.value||[]).slice(0),n=[],s=[];return e=Array.isArray(e)?e:[e],this.uniqueValue?e.forEach((function(e){"string"==typeof e&&e&&(o.pushUnique(i,e)?n.push(e):s.push(e))})):e.forEach((function(e){"string"==typeof e&&e&&(i.push(e),n.push(e))})),n.length?(this._properties.value.value=i,this._selectionChips&&(n.forEach((function(e){return t._selectionChips.addChip({label:e})})),s.forEach((function(e){return t._selectionChips._flashEffectOnChip("ui-modified",i.indexOf(e))}))),this.fire("change"),!0):(this._selectionChips&&s.forEach((function(e){return t._selectionChips._flashEffectOnChip("ui-modified",i.indexOf(e))})),!1)}}return function(t){if(this._lineEditor&&(this._lineEditor.value="",this._lineEditor.valueToCommit=""),"string"==typeof t){if(!this.customValidator)return e.call(this,t);var i=this.customValidator(t);if(!(i instanceof Promise))return e.call(this,i);i.then(function(t){e.call(this,t)}.bind(this))}}}();function c(e,t){if(e&&(t=t||[],Array.isArray(t))){var i=t.map((function(e){return{label:e}}));e.removeAllChips(),e.addChips(i)}}var d=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return h.extendingClassFlag||n.addKeyMapsAndCommands({tab:"manageTab","shift+tab":"manageTab",return:"manageReturn",esc:"manageEsc"},{manageTab:function(){var e=this._lineEditor.valueToCommit;return u.call(this,e),""!==e&&this.focus({preventScroll:!0}),{preventDefault:!0,stopPropagation:!1,infos:{actionPerformed:""!==e}}},manageReturn:function(e){return e.actionPerformed&&this.focus({preventScroll:!0}),{preventDefault:!0,stopPropagation:!1,infos:{actionPerformed:e.actionPerformed}}},manageEsc:function(){var e=Boolean(this._lineEditor.valueToCommit);return this._lineEditor.valueToCommit="",{preventDefault:!0,stopPropagation:!1,infos:{actionPerformed:e}}}}),n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{placeholder:{defaultValue:"",type:"string",category:"Appearance"},value:{defaultValue:void 0,type:"array",category:"Appearance",advancedSetter:!0},uniqueValue:{defaultValue:!1,type:"boolean",category:"Appearance"},customValidator:{defaultValue:void 0,type:"function",category:"Behavior"},selection:{defaultValue:{toggle:!0,mode:n.SELECTION_MODE.MULTIPLE_ONKEYS,unselectAllOnEmptyArea:!0},type:"object",category:"Behavior",noNeedToApplyFlag:!0},maxLength:{defaultValue:-1,type:"integer",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-selectionchipseditor"),this.elements.container.setAttribute("tabindex",0)},t.prototype._postBuildView=function(){this._lineEditor||this._selectionChips||(this._lineEditor=new s({placeholder:this.placeholder,displayStyle:"lite",fireOnlyFromUIInteractionFlag:!0,selectAllOnFocus:!0,disabled:this.disabled,touchMode:this.touchMode,maxLength:this.maxLength}),this._selectionChips=new n({fireOnlyFromUIInteractionFlag:!0,selection:this.selection,disabled:this.disabled,touchMode:this.touchMode}),this._selectionChips.addLastWidget(this._lineEditor),this._selectionChips.inject(this.elements.container),c(this._selectionChips,this.value))},t.prototype.handleEvents=function(){l.addEventOnElement(this,this._lineEditor,"change",function(e){e.stopPropagation(),u.call(this,this._lineEditor.valueToCommit)}.bind(this)),l.addEventOnElement(this,this._selectionChips,"change",function(e){e.stopPropagation();var t=this._selectionChips.getAllChipsAsLabels();r.equals(t,this._properties.value.value)||(this._properties.value.value=t,this.fire("change"))}.bind(this)),l.addEventOnElement(this,this._selectionChips,"click",(function(e){return e.stopPropagation()}))},t.prototype.addValues=function(e){if(e&&Array.isArray(e)){for(var t=(this.value||[]).slice(0),i=[],n=0;n<e.length;++n){var s=e[n];s&&"string"==typeof s&&(this.uniqueValue?o.pushUnique(t,s)&&i.push({label:s}):(t.push(s),i.push({label:s})))}i.length&&(this._properties.value.value=t,this._selectionChips&&this._selectionChips.addChips(i),this.fire("change"))}},t.prototype.removeValues=function(e){if(e&&Array.isArray(e)){for(var t=!1,i=0;i<e.length;++i){var n=e[i];n&&"string"==typeof n&&this._selectionChips&&this._selectionChips.removeChip(n)&&(t=!0)}t&&(this._properties.value.value=this._selectionChips.getAllChipsAsLabels(),this.fire("change"))}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("placeholder")&&this._applyPlaceholder(t.placeholder,this.placeholder),this.isDirty("selection")&&this._applySelection(t.selection,this.selection),this.isDirty("uniqueValue")&&this._applyUniqueValue(t.uniqueValue,this.uniqueValue),this.isDirty("maxLength")&&this._applyMaxLength(t.maxLength,this.maxLength),this.isDirty("value")&&a._applyForAdvancedSetterProperty(this,"value",t.value,this.value)},t.prototype._applyPlaceholder=function(e,t){this._lineEditor&&(this._lineEditor.placeholder=t)},t.prototype._applySelection=function(e,t){this._selectionChips&&(this._selectionChips.selection=t)},t.prototype._applyUniqueValue=function(e,t){if(e!==t&&t&&!this.isDirty("value")){for(var i=[],n=this.value||[],s=0;s<n.length;++s)o.pushUnique(i,n[s]);n.length!==i.length&&(this._properties.value.value=i,this._applyValue(e,i))}},t.prototype._preEditValue=function(e,t){if(void 0===t)return!0;if(t&&"string"==typeof t)return{validValue:[t]};if(!Array.isArray(t))return!1;for(var i=[],n=0;n<t.length;++n){var s=t[n];if(s&&"string"==typeof s){var l=parseInt(this.maxLength);l>0&&(s=s.slice(0,l)),this.uniqueValue?o.pushUnique(i,s):i.push(s)}}return!r.equals(e,i)&&(!!r.equals(t,i)||{validValue:i})},t.prototype._applyValue=function(e,t){c(this._selectionChips,t),this.fire("change")},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),this._lineEditor&&(this._lineEditor.disabled=this.disabled),this._selectionChips&&(this._selectionChips.disabled=this.disabled)},t.prototype._applyTouchMode=function(){e.prototype._applyTouchMode.call(this);var t=this._getCurrentTouchMode();t?this.elements.container.setAttributeNode(document.createAttribute("touch-mode")):this.elements.container.removeAttribute("touch-mode"),this._lineEditor&&(this._lineEditor.touchMode=t),this._selectionChips&&(this._selectionChips.touchMode=t)},t.prototype._applyMaxLength=function(e,t){this._lineEditor&&(this._lineEditor.maxLength=this.maxLength),a._applyForAdvancedSetterProperty(this,"value",this.value,this.value)},t.prototype._getElementToFocus=function(){return this._lineEditor&&this._lineEditor._getElementToFocus()},t.prototype.getSelectedChipsValue=function(){var e=[];this._selectionChips&&(e=this._selectionChips.getSelectedChipsOptions().map((function(e){return e.label})));return e},t.prototype.selectChip=function(e){return this._selectionChips&&this._selectionChips.selectChip(e)},t.prototype.selectAllChips=function(){return this._selectionChips&&this._selectionChips.selectAllChips()},t.prototype.unselectChip=function(e){return this._selectionChips&&this._selectionChips.unselectChip(e)},t.prototype.destroy=function(){this._lineEditor&&(this._lineEditor.destroy(),delete this._lineEditor),this._selectionChips&&(this._selectionChips.destroy(),delete this._selectionChips),e.prototype.destroy.call(this)},t}(i);return a.addClass(d,"selectionChipsEditor"),d}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,s=0,o=t.length;s<o;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))};define("DS/Controls/TimeChooser",["require","exports","DS/Controls/Abstract","DS/Utilities/DateUtils","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/Utilities/LanguageUtils"],(function(e,t,i,n,s,o,l){"use strict";var a=Number.MAX_VALUE;function r(e){return e.toString().padStart(2,"0")}var h={};function u(e){var t=h[e];if(!t){t={partsMin:new Intl.DateTimeFormat(e,{hour:"numeric",minute:"numeric"}).formatToParts(new Date(2022,0,1,1,1,1)),partsSec:new Intl.DateTimeFormat(e,{hour:"numeric",minute:"numeric",second:"numeric"}).formatToParts(new Date(2022,0,1,1,1,1)),period:!1,isPeriodFirst:!1};var i,n=!1,s=new Intl.DateTimeFormat(e,{hour:"numeric",minute:"numeric"});[new Date(2022,0,1,1,1,1),new Date(2022,0,1,13,1,1)].forEach((function(e){s.formatToParts(e).some((function(e,t){if("dayPeriod"===e.type)return i||(i=[]),i.push(e.value),0===t&&(n=!0),!0}))})),2===(null==i?void 0:i.length)&&(t.period=i,t.isPeriodFirst=n),h[e]=t}return t}function c(e){return e instanceof Date&&!isNaN(e.getTime())}function d(e,t){t.forEach((function(t){return e.classList.add(t)}))}function p(){var e=this;this._arrowsInfo=[{name:"hoursUp",onClick:this.incrementHours.bind(this),upFlag:!0},{name:"minutesUp",onClick:this.incrementMinutes.bind(this),upFlag:!0},{name:"secondsUp",onClick:this.incrementSeconds.bind(this),upFlag:!0,secondsFlag:!0},{name:"amPmUp",onClick:this.incrementAmPm.bind(this),upFlag:!0,amPmFlag:!0},{name:"hoursDown",onClick:this.decrementHours.bind(this),upFlag:!1},{name:"minutesDown",onClick:this.decrementMinutes.bind(this),upFlag:!1},{name:"secondsDown",onClick:this.decrementSeconds.bind(this),upFlag:!1,secondsFlag:!0},{name:"amPmDown",onClick:this.decrementAmPm.bind(this),upFlag:!1,amPmFlag:!0}],this.elements._arrowsDiv=[],this._arrowsInfo.forEach((function(t){var i=["wux-ui-3ds"];t.secondsFlag?i.push("wux-controls-timechooser-seconds"):t.amPmFlag&&i.push("wux-controls-timechooser-ampm"),t.upFlag?i.push.apply(i,["wux-ui-3ds-expand-up","wux-controls-timechooser-arrow","wux-controls-timechooser-arrow-up"]):i.push.apply(i,["wux-ui-3ds-expand-down","wux-controls-timechooser-arrow","wux-controls-timechooser-arrow-down"]);var n=document.createElement("button");n.type="button",d(n,i),e.elements._arrowsDiv.push(n)})),this._inputsInfo=[{name:"hours",minValue:0,maxValue:23,onChange:function(t){e._setHours(t)}},{name:"minutes",minValue:0,maxValue:59,onChange:function(t){e._setMinutes(t)}},{name:"seconds",minValue:0,maxValue:59,onChange:function(t){e._setSeconds(t)},secondsFlag:!0}],this.elements._inputsDiv=[],this._inputsInfo.forEach((function(t){var i=["wux-controls-timechooser-input"];t.secondsFlag&&i.push("wux-controls-timechooser-seconds");var n=document.createElement("input");d(n,i),e.elements._inputsDiv.push(n)})),this.elements._amPmDiv=document.createElement("input"),this.elements._amPmDiv.classList.add("wux-controls-timechooser-ampm"),this.elements._amPmDiv.classList.add("wux-controls-timechooser-input"),this.elements._amPmDiv.inert=!0,this.elements._amPmDiv.value="AM",this.elements._inputsDiv.push(this.elements._amPmDiv)}var m=function(){function e(e,t,i,n){var s=document.createElement("span");d(s,i),s.textContent=t,e[n?"prepend":"appendChild"](s)}return function(){if(!this.elements._columnHour){for(var t=["_columnHour","_columnMinute","_columnSecond","_columnAMPM"],i=["wux-controls-timechooser-column-hr","wux-controls-timechooser-column-min","wux-controls-timechooser-column-sec","wux-controls-timechooser-column-ampm"],n=0;n<t.length;++n){var s=document.createElement("div");s.classList.add("wux-controls-timechooser-column-container"),s.classList.add(i[n]);var o=document.createElement("div");o.classList.add("wux-controls-timechooser-column-inside"),s.appendChild(o),o.appendChild(this.elements._arrowsDiv[n]),o.appendChild(this.elements._inputsDiv[n]),o.appendChild(this.elements._arrowsDiv[n+4]),this.elements[t[n]]=s,this.elements.container.appendChild(s)}e(this.elements._columnHour,"h",["wux-controls-timechooser-deliminator"],!1),e(this.elements._columnMinute,":",["wux-controls-timechooser-deliminator"],!0),e(this.elements._columnMinute,"m",["wux-controls-timechooser-deliminator"],!1),e(this.elements._columnSecond,":",["wux-controls-timechooser-deliminator"],!0),e(this.elements._columnSecond,"s",["wux-controls-timechooser-deliminator"],!1)}var a=u(l.regionalFormatLanguage);this.elements._columnAMPM.remove(),this.elements.container[a.isPeriodFirst?"prepend":"appendChild"](this.elements._columnAMPM);var r=this.mode;"duration"===r||!1===a.period||"24"===r?this.elements._columnAMPM.style.display="none":2===a.period.length&&(this.elements._columnAMPM.style.display="")}}();function g(){var e=this.mode,t=this.value,i=u(l.regionalFormatLanguage);if(void 0!==t){var n=this.getHours(),s=this.getMinutes(),o=this.getSeconds();"duration"!==e&&("24"===e||!1===i.period||2===i.period.length&&(n>=12?(n>=13&&(n-=12),this.elements._amPmDiv.value=i.period[1]):(0===n&&(n=12),this.elements._amPmDiv.value=i.period[0]))),this.elements._inputsDiv[0].value=!1===i.period||"time"!==e?r(n):n,this.elements._inputsDiv[1].value=r(s),this.elements._inputsDiv[2].value=r(o)}else"duration"===e?this.elements._inputsDiv[0].value=this.elements._inputsDiv[1].value=this.elements._inputsDiv[2].value="00":(this.elements._inputsDiv[0].value=this.elements._inputsDiv[1].value=this.elements._inputsDiv[2].value="",i.period&&2===i.period.length&&(this.elements._amPmDiv.value=i.period[0]))}function f(e){var t=this["get".concat(e)]();return void 0===t&&(t="duration"===this.mode?0:(new Date)["get"+e]()),t}function v(){void 0===this.value&&("duration"===this.mode?this._properties.value.value=0:this._properties.value.value=new Date)}function y(e){if("number"==typeof e){var t=Math.round(e);return t===e||{validValue:t}}return!1}var _=function(e){function t(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return e.apply(this,__spreadArray([t],i,!1))||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:void 0,type:"date",category:"Behavior",advancedSetter:!0},precision:{defaultValue:"min",type:"string",category:"Behavior"},mode:{defaultValue:"time",type:"string",category:"Behavior"},hoursStep:{defaultValue:1,type:"integer",noNeedToApplyFlag:!0,category:"Behavior",advancedSetter:!0},minutesStep:{defaultValue:1,type:"integer",noNeedToApplyFlag:!0,category:"Behavior",advancedSetter:!0},secondsStep:{defaultValue:1,type:"integer",noNeedToApplyFlag:!0,category:"Behavior",advancedSetter:!0}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype._preBuild=function(t){e.prototype._preBuild.call(this,t),t&&"duration"===t.mode?this._properties.value.value=0:this._properties.value.value=new Date},t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-controls-timechooser"),this.elements.container.setAttribute("tabindex",0),p.call(this),m.call(this)},t.prototype.handleEvents=function(){var e=this;this.elements._arrowsDiv.forEach((function(t,i){s.addEventOnElement(e,t,"click",(function(){e._arrowsInfo[i].onClick.call(e)})),s.addEventOnElement(e,t,"focus",(function(){t.blur(),e.elements.container.focus()}))})),this.elements._inputsDiv.forEach((function(t,i){s.addEventOnElement(e,t,"change",(function(){var n=parseInt(t.value),s=e._inputsInfo[i];n>=s.minValue&&n<=s.maxValue?s.onChange.call(e,n):g.call(e)}))})),this._updateOnRegionLanguageChange=function(){m.call(e),g.call(e)},l.subscribe("onRegionalFormatLanguageChange",this._updateOnRegionLanguageChange)},t.prototype._applyMode=function(e,t){"time"!==t&&"24"!==t&&"duration"!==t&&(this._properties.mode.value="time");var i=this.mode;"duration"===i?(this._inputsInfo[0].maxValue=a,this.getContent().setAttribute("mode","duration")):"24"===i?this.getContent().setAttribute("mode","24"):this.getContent().removeAttribute("mode"),m.call(this),g.call(this)},t.prototype._preEditValue=function(e,t){if(!t)return!0;if("string"==typeof t){var i=new Date(t);return!!c(i)&&{validValue:i}}return t instanceof Date?0!==n.compare(e,t,"time")&&!!c.call(this,t):"number"==typeof t&&e!==t},t.prototype._applyValue=function(e){g.call(this),this.fire("change")},t.prototype._applyPrecision=function(e){"min"===this.precision?this.getContent().setAttribute("precision","min"):this.getContent().setAttribute("precision","sec")},t.prototype._applyDisabled=function(t){e.prototype._applyDisabled.call(this,t),this.disabled?(this.elements._arrowsDiv.forEach((function(e){e.setAttributeNode(document.createAttribute("disabled"))})),this.elements._inputsDiv.forEach((function(e){e.setAttributeNode(document.createAttribute("disabled"))}))):(this.elements._arrowsDiv.forEach((function(e){e.removeAttribute("disabled")})),this.elements._inputsDiv.forEach((function(e){e.removeAttribute("disabled")})))},t.prototype._preEditHoursStep=function(e,t){return y(t)},t.prototype._preEditMinutesStep=function(e,t){return y(t)},t.prototype._preEditSecondsStep=function(e,t){return y(t)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("mode")&&this._applyMode(t.mode,this.mode),this.isDirty("value")&&this._applyValue(t.value),this.isDirty("precision")&&this._applyPrecision(t.precision),this.isDirty("hoursStep")&&o._applyForAdvancedSetterProperty(this,"hoursStep",t.hoursStep,this.hoursStep),this.isDirty("minutesStep")&&o._applyForAdvancedSetterProperty(this,"minutesStep",t.minutesStep,this.minutesStep),this.isDirty("secondsStep")&&o._applyForAdvancedSetterProperty(this,"secondsStep",t.secondsStep,this.secondsStep)},t.prototype.getHours=function(){var e=this.value;if(void 0!==e)return"number"==typeof e?Math.floor(e/36e5):e.getHours()},t.prototype.getMinutes=function(){var e=this.value;if(void 0!==e)return"number"==typeof e?Math.floor(e/6e4%60):e.getMinutes()},t.prototype.getSeconds=function(){var e=this.value;if(void 0!==e)return"number"==typeof e?Math.floor(e/1e3%60):e.getSeconds()},t.prototype._setHours=function(e){if(!isNaN(e))if(v.call(this),"number"==typeof this.value){(t=this.value-36e5*(this.getHours()-e))>=0&&this.setPropertyFromUIInteraction("value",t)}else{var t,i=(e+24)%24;(t=new Date(this.value)).setHours(i),this.setPropertyFromUIInteraction("value",t)}},t.prototype.setHours=function(e){this._setHours(e)},t.prototype._setMinutes=function(e){if(!isNaN(e))if(v.call(this),"number"==typeof this.value){(t=this.value-6e4*(this.getMinutes()-e))>=0&&this.setPropertyFromUIInteraction("value",t)}else{var t,i=(e+60)%60;(t=new Date(this.value)).setMinutes(i),this.setPropertyFromUIInteraction("value",t)}},t.prototype.setMinutes=function(e){this._setMinutes(e)},t.prototype._setSeconds=function(e){if(!isNaN(e))if(v.call(this),"number"==typeof this.value){(t=this.value-1e3*(this.getSeconds()-e))>=0&&this.setPropertyFromUIInteraction("value",t)}else{var t,i=(e+60)%60;(t=new Date(this.value)).setSeconds(i),this.setPropertyFromUIInteraction("value",t)}},t.prototype.setSeconds=function(e){this._setSeconds(e)},t.prototype.incrementAmPm=function(){this.setHours(f.call(this,"Hours")+12)},t.prototype.decrementAmPm=function(){this.setHours(f.call(this,"Hours")-12)},t.prototype.incrementHours=function(){this.setHours(f.call(this,"Hours")+this.hoursStep)},t.prototype.decrementHours=function(){this.setHours(f.call(this,"Hours")-this.hoursStep)},t.prototype.incrementMinutes=function(){this.setMinutes(f.call(this,"Minutes")+this.minutesStep)},t.prototype.decrementMinutes=function(){this.setMinutes(f.call(this,"Minutes")-this.minutesStep)},t.prototype.incrementSeconds=function(){this.setSeconds(f.call(this,"Seconds")+this.secondsStep)},t.prototype.decrementSeconds=function(){this.setSeconds(f.call(this,"Seconds")-this.secondsStep)},t.prototype.destroy=function(){l.unsubscribe("onRegionalFormatLanguageChange",this._updateOnRegionLanguageChange),e.prototype.destroy.call(this)},t}(i);return o.addClass(_,"timeChooser"),_}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/AbstractDecorator",["require","exports","DS/Controls/Abstract","DS/Controls/Popup","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils"],(function(e,t,i,n,s,o){"use strict";var l=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return o.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{widget:{defaultValue:void 0,type:"WUX.IBaseComponent",category:"Behavior"},decoratedWidget:{defaultValue:void 0,type:"HTMLElement",category:"Behavior"},visibleFlag:{defaultValue:!1,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this._shouldValidateValue=!0},t.prototype.destroy=function(){this.hide(),e.prototype.destroy.call(this)},t.prototype.hide=function(e){this._shouldValidateValue=e,this.visibleFlag=!1},t.prototype.show=function(){this.visibleFlag=!0},t.prototype._buildContent=function(){},t.prototype._onShow=function(){},t.prototype._onHide=function(e){},t.prototype._applyVisibleFlag=function(){var e=this;if(this.visibleFlag)if(this._onShow(),this.elements.popup)this.elements.popup.show();else{var t={target:e.decoratedWidget,position:"bottom",alignment:"center",constraint:"screen",className:"wux-controls-popup wux-decorator-popup",overlap:!1,arrowBoxFlag:!0,getBody:function(){return e._buildContent()}};n.delayPopupCreation(t,(function(t){e.elements.popup=t,e.elements.popup.elements.container.removeAttribute("tabindex")})).createVisiblePopup.call(this)}else this._onHide(this._shouldValidateValue),this.elements.popup&&this.elements.popup.hide()},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("decoratedWidget")&&this.elements.popup&&(this.elements.popup.target=this.decoratedWidget)},t}(i);return s.addClass(l,"abstractdecorator"),l})),define("DS/Controls/TreeBase",["UWA/Core","UWA/Event","UWA/Controls/Abstract","UWA/Controls/Drag","UWA/Controls/Scroller","DS/Core/Core","DS/Utilities/Css3D","DS/Controls/TreeNodeBase","DS/Controls/TreeNode","DS/Utilities/MouseEvents","DS/CoreEvents/ModelEvents"],(function(e,t,i,n,s,o,l,a,r,h,u){"use strict";var c="#333",d="transparent",p="solid",m="#FFF",g=10,f={expander:{size:g,borderSize:1},icon:{size:20},link:{size:1,color:c,bgColor:d,style:p},label:{padding:5,cursor:"pointer",marginRight:5,marginLeft:5,borderRadius:0},layout:{btMargin:5,lrMargin:5},expandState:{class:"Expander",text:"+",styles:{backgroundColor:m,borderColor:c,height:g,width:g,lineHeight:"8px",cursor:"pointer",zIndex:1e3}},collapseState:{class:"Expander",text:"",styles:{backgroundColor:m,borderColor:c,height:g,width:g,lineHeight:"8px",cursor:"pointer",zIndex:1e3}},asyncState:{class:"Expander",text:"",styles:{backgroundColor:m,borderColor:c,height:g,width:g,lineHeight:"8px",cursor:"pointer",zIndex:1e3}},noExpandState:{class:"NoExpander Link",text:"",styles:{backgroundColor:d,marginTop:10,width:6,borderTop:"1px solid "+c,cursor:"pointer",zIndex:1e3}},noExpandRoot:{class:"NoExpander Link",text:"",styles:{backgroundColor:d,marginTop:10,width:6,cursor:"pointer",zIndex:1e3}}},v=i.extend({defaultOptions:{isEditable:!1,expandAllAtInit:!1,zoomFactor:100,hasFilterBox:!1,isScrollable:!0,UI:f,roots:[],nodeClass:a},init:function(e){this._parent(e),this._zoom=1,this._roots=[],this._modelEvents=new u,this.buildSkeleton(),this._loadModel(this.options.roots),this._buildCustomView(),this._buildScroller(),this._listenEvents()},_clearAutoExpandAtDragTimeout:function(){this._toAutoExpandAtDrag&&(clearTimeout(this._toAutoExpandAtDrag),this._toAutoExpandAtDrag=null)},_listenEvents:function(){var t=this;if(e.Element.addEvent.call(this.elements.container,"mousewheel",(function(i){var n=e.Event.wheelDelta(i);i.shiftKey&&(1===Math.abs(n)&&(n*=.1),t._zoom+n>.55&&t._zoom+n<10&&(t._zoom=t._zoom+n,t.setZoomFactor(t._zoom.toFixed(2))))})),this.options.isScrollable){var i=0;this._scroller.addEvent("onRefresh",(function(){2===++i&&(t.elements.container.setStyle("width","auto"),t.elements.container.getElement(".uwa-scroller").setStyle("width","auto")),i>=2&&t.elements.container.getElement(".uwa-scroller").setStyle("width","auto")}))}},buildSkeleton:function(){var t=this,i=this.elements;i.container=new e.Element("div",{class:"WUX WUXTree",styles:{zoom:this.options.zoomFactor+"%",height:"100%",position:"relative"}}),this.options.hasFilterBox&&(i.search=new e.Element("input",{type:"search",placeholder:"search in tree ...",styles:{backgroundColor:"rgba(255, 255, 255, 0.8)",padding:"2px 5px",border:"1px solid #FFF",marginLeft:12},events:{blur:function(e){t.search(i.search.value)},change:function(e){t.search(i.search.value)},keydown:function(e){t.search(i.search.value)}}}),i.search.inject(i.container)),i.scrollContainer=new e.Element("div"),i.scrollContainer.inject(i.container),i.treeAndGrid=new e.Element("ul",{class:"Horizontal"}),i.treeAndGrid.inject(i.scrollContainer),this.elements.treeContainer=new e.Element("li",{styles:{verticalAlign:"top",width:"100%"}}),this.elements.treeContainer.inject(i.treeAndGrid),this._currentNodeID++,this._treeRoot=new this.options.nodeClass({isFakeRoot:!0,isRoot:!0,label:"Root",tree:this,UI:this.options.UI}),this._treeRoot.inject(this.elements.treeContainer)},_buildCustomView:function(){},_buildScroller:function(){this.options.isScrollable&&(this._scroller=new e.Controls.Scroller(this.elements.scrollContainer,{momentum:!0,scrollableX:!1,scrollableY:!0,scrollDrag:!1}))},empty:function(){this.removeAllRoots()},addRoot:function(e){e.isRoot=!0,e.tree=this,e.UI=this.options.UI;var t=this._createNode(e);return t.getContent().addClassName("wux-tree-root"),this._treeRoot.addChild(t),this._roots.push(t),this._updateRootsView(!0),t},removeRoot:function(e){e.getContent().destroy();var t=this._treeRoot._children.indexOf(e);-1!==t&&(this._treeRoot._children.splice(t,1),this._roots.splice(t,1))},removeAllRoots:function(){for(var e=this.getRoots().length,t=0;t<e;t++){var i=this.getNthRoot(0);this.removeRoot(i)}},_updateRootsView:function(){this._treeRoot.collapse(),this._treeRoot.expand()},dump:function(e){return this._treeRoot.dump(e)},processNodes:function(e){this._treeRoot.processChildren(e)},toggle:function(){this.elements.container.toggle()},getRoots:function(){return this._treeRoot.getChildren()?this._treeRoot.getChildren():[]},_getTrueRoot:function(){return this._treeRoot},getNthRoot:function(e){if(this._treeRoot.getChildren())return this._getTrueRoot().getChildren()[e]},setZoomFactor:function(e){this.options.zoomFactor=e,this._treeRoot.elements.container.setStyle("zoom",e)},_onUpdate:function(e){},_onPreExpand:function(e,t){},_onExpand:function(e,t){},_onPostExpand:function(e,t){},_onPreCollapse:function(e,t){},_onCollapse:function(e,t){},_onPostCollapse:function(e,t){},onExpand:function(e){return this._modelEvents.subscribe({event:"expand"},e)},onCollapse:function(e){return this._modelEvents.subscribe({event:"collapse"},e)},onNodeDragOver:function(e){return this._modelEvents.subscribe({event:"NODE/DRAG_OVER"},e)},onNodeDragStart:function(e){return this._modelEvents.subscribe({event:"NODE/DRAG_START"},e)},onNodeDragLeave:function(e){return this._modelEvents.subscribe({event:"NODE/DRAG_LEAVE"},e)},onNodePreDrop:function(e){return this._modelEvents.subscribe({event:"NODE/PRE_DROP"},e)},onNodeDrop:function(e){this._onDropCallBack=e},onNodePostDrop:function(e){return this._modelEvents.subscribe({event:"NODE/POST_DROP"},e)},onPreExpand:function(e){return this._modelEvents.subscribe({event:"preExpand"},e)},onPostExpand:function(e){return this._modelEvents.subscribe({event:"postExpand"},e)},onPreCollapse:function(e){return this._modelEvents.subscribe({event:"preCollapse"},e)},onPostCollapse:function(e){return this._modelEvents.subscribe({event:"postCollapse"},e)},onNodeClick:function(e){return this._modelEvents.subscribe({event:"click"},e)},onNodeDblClick:function(e){return this._modelEvents.subscribe({event:"dblClick"},e)},onLabelChange:function(e){this._modelEvents.subscribe({event:"UPDATE_LABEL"},e)},delegateEvents:function(e){},search:function(e){this.getRoots().forEach((function(t){t.search(e)}))},_createNode:function(e){return new this.options.nodeClass(e)},_loadModel:function(e){var t=this;!function e(i,n,s){var o;0===++s?n.forEach((function(i){e(o=t.addRoot(i),i,s)})):n.children&&n.children.forEach((function(n){o=t._createNode(n),i.addChild(o),e(o,n,s)})),s--}(this._treeRoot,e,-1)}});return v.themes={default:f},e.namespace("WUX/Controls/TreeBase",v)})),define("DS/Controls/Tree",["UWA/Core","UWA/Event","DS/Core/Core","DS/Controls/TreeBase","DS/Controls/TreeNode","DS/Selection/HSOManager","DS/Selection/CSOManager","DS/Utilities/Css","DS/Panels/SidePanel"],(function(e,t,i,n,s,o,l,a,r){"use strict";var h="#04C7F0",u="transparent",c="solid",d="#FFF",p=10,m="EVT_TREE_IS_SHOWN",g="EVT_TREE_PANEL_IS_HIDDEN";function f(e,t){if(e instanceof Function)return t instanceof Function&&e.toString()===t.toString();if(null==e||null==t)return e===t;if(e===t||e.valueOf()===t.valueOf())return!0;if(e instanceof Date)return!1;if(t instanceof Date)return!1;if(!(e instanceof Object))return!1;if(!(t instanceof Object))return!1;var i=Object.keys(e);return void 0!==e.pathElement&&void 0!==t.pathElement?e.pathElement.isEqual(t.pathElement):!!Object.keys(t).every((function(e){return-1!==i.indexOf(e)}))&&i.every((function(i){return f(e[i],t[i])}))}var v={shadow:!0,expander:{size:p},link:{size:1,color:h,bgColor:u,style:c},label:{borderRadius:1,padding:"2px 4px",verticalAlign:"middle",border:"1px solid rgba(255,255,255,0.5)",minHeight:"1em",lineHeight:"1em"},expandState:{class:"Expander",text:"+",styles:{backgroundColor:d,borderColor:h,height:p,width:p,lineHeight:"8px",cursor:"pointer",zIndex:1e3}},collapseState:{class:"Expander",text:"",styles:{backgroundColor:d,borderColor:h,height:p,width:p,lineHeight:"8px",cursor:"pointer",zIndex:1e3}},asyncState:{class:"Expander",text:"",styles:{backgroundColor:d,borderColor:h,height:p,width:p,lineHeight:"8px",cursor:"pointer",zIndex:1e3}},noExpandState:{class:"NoExpander Link",text:"",styles:{backgroundColor:u,borderTop:"1px solid "+h,width:5,cursor:"pointer",zIndex:1e3}}},y=n.extend({defaultOptions:{isEditable:!1,nodeClass:s},init:function(e){e.UI=v,this._parent(e),this.elements.container.addClassName("wux-controls-tree"),this._highlightedNodes=[],this._modeIsMultiSel=!1,this._modeIsListSel=!1,this._selectionManagement()},_selectNode:function(e,t){var i={pathElement:e.options.pathElement};return t?(l.unique(i),o.unique(i)):l.isIn(i)?(l.remove(i),o.remove(i)):(l.add(i),o.add(i)),i},_selectionManagement:function(){var e,t=this,i=null,n=null,s=0;this._onNodeClickCB=function(e){if(s++,!n&&i&&t._modeIsListSel&&(n=e,t._selectNode(e)),i&&(null===i||null===n)||s%2==0||(i=e,n=null,s=1),t._modeIsMultiSel)t._selectNode(e);else if(t._modeIsListSel){n=e;var o=e.getParent();if(o){var l=!1;o.getChildren().forEach((function(e,s){f(e.options.pathElement,i.options.pathElement)&&(l=!0),l&&!f(e.options.pathElement,n.options.pathElement)&&t._selectNode(e),f(e.options.pathElement,n.options.pathElement)&&(l=!1)}))}}else t._selectNode(e,!0)},this._onNodeClickToken=this.onNodeClick(this._onNodeClickCB);var o=function(i){var n=i.pathElement,s=t._searchPathElement(n);s&&s.elements&&s.elements.label&&(e=a.recordState(s.elements.label,["box-shadow","font-weight","text-shadow"]),t._highlightedNodes.push(s),s._isHighlighted=!0,s.elements.label.setStyles({boxShadow:"inset 0px 0px 7px rgb(0, 133, 255), inset 0 0 200px #0FF"}))};function r(){t.getContent().offsetParent&&!t._panelIsHidden&&(t._highlightedNodes.forEach((function(i,n){t._highlightedNodes.splice(n,1),i.elements&&i.elements.label&&e&&a.restoreState(i.elements.label,e,["box-shadow","font-weight","text-shadow"])})),l.get().forEach(o))}t.onPostExpand((function(e){r()})),t.onPostCollapse((function(e){r()})),t._modelEvents.subscribe({event:m},(function(){r()})),l.onPostAdd((function(e){r()})),l.onRemove((function(i){var n=i.pathElement,s=t._searchPathElement(n);s&&s.elements&&s.elements.label&&(s._isHighlighted=!1,a.restoreState(s.elements.label,e,["box-shadow","font-weight","text-shadow"]))}))},_buildCustomView:function(){this._panelIsHidden=!1,this._sidePanel=new r({side:"left"}).inject(this.elements.container),this._sidePanel.elements.container.setStyles({minHeight:0,minWidth:0}),this._sidePanel.elements.content.setStyles({height:"100%",boxSizing:"border-box",backgroundColor:"transparent",padding:"0 5px",pointerEvents:"none"}),this._sidePanel.elements.panel.setStyles({backgroundColor:"transparent",border:"none",pointerEvents:"none"}),this._sidePanel.appendChild(this.elements.scrollContainer).setStyles({height:"100%"});var e=this;this._sidePanel.onSlideIn((function(){e._panelIsHidden=!1,e._modelEvents.publish({event:m,data:e})})),this._sidePanel.onSlideOut((function(){e._panelIsHidden=!0,e._modelEvents.publish({event:g,data:e})}))},onPanelSlideIn:function(e){return this._modelEvents.subscribe({event:m},e)},onPanelSlideOut:function(e){return this._modelEvents.subscribe({event:g},e)},slideOut:function(){this._sidePanel.slideOut()},slideIn:function(){this._sidePanel.slideIn()},_getNodeClass:function(){return"TreeNode"},_searchPathElement:function(e,t){var i;if(void 0===t&&(t=!1),e)return this.getRoots().forEach((function(n){i=n,i=function i(n){var s=0,o=null;if(n.options.pathElement&&n.options.pathElement.isAParentOf(e)){if(t&&n.expand(1),n._children&&n._isExpanded)for(s=0;s<n._children.length&&!o;s++)o=i(n._children[s]);o||(o=n)}return o}(n)})),i}});return e.namespace("WUX/Controls/Tree",y)}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/Label",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Utilities/Utils","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/Utilities/Color","DS/CoreBase/WebUXGlobalEnums","DS/Utilities/WebUXColorEnums","DS/CoreBase/WebUXGlobalEnums"],(function(e,t,i,n,s,o,l,a,r,h){"use strict";function u(){if(this.icon){var e={iconName:s.isIconDefinition(this.icon)?this.icon.iconName:this.icon,fontIconFamily:"string"!=typeof this.icon&&this.icon.fontIconFamily?this.icon.fontIconFamily:r.WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},t=o.generateIcon(e);t&&(this.elements._icon=t,this.elements._icon.addClassName("wux-controls-label-icon"),this.elements._iconPlaceHolder?this.elements._icon&&this.elements._iconPlaceHolder.removeChild(this.elements._iconPlaceHolder.getChildren()[0]):(this.elements._iconPlaceHolder=i.createElement("span",{class:"wux-controls-label-iconplaceholder"}),this.elements.container.insertBefore(this.elements._iconPlaceHolder,this.elements._content)),this.elements._icon.inject(this.elements._iconPlaceHolder))}else this.elements._icon&&(this.elements._icon.remove(),this.elements._iconPlaceHolder.remove(),this.elements._icon=void 0,this.elements._iconPlaceHolder=void 0)}function c(){this.elements._content=i.createElement("span",{class:"wux-controls-label-content"}).inject(this.elements.container),this._content=this.elements._content}function d(){var e=this;this.elements._closeButton||(this.elements._closeButton=new i.Element("span",{class:"wux-controls-label-close wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-close"}).inject(this.elements.container),o.addEventOnElement(this,this.elements._closeButton,"click",(function(t){e.fire("close"),e.elements.container.remove(),e.destroy(),t.stopPropagation()})),this._closeButton=this.elements._closeButton)}function p(){if(this.elements._content){var e=this.value;this.maxDisplayLength&&this.value.length>this.maxDisplayLength&&(this.tooltipInfos={shortHelp:this.value,mouseRelativePosition:!1,position:"bottom"},e=this.value.slice(0,this.maxDisplayLength-3)+"..."),this.elements._content.setText(e)}}function m(){this.value?(this.elements._content||c.call(this),this.elements._content.setText(this.value)):this.elements._content&&(this.elements._content.remove(),this.elements._content=void 0)}function g(){m.call(this),"closeable-chip"===this.appearance?d.call(this):this.elements._closeButton&&(this.elements._closeButton.remove(),this.elements._closeButton=void 0)}var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:"",type:"string",category:"Appearance"},maxDisplayLength:{defaultValue:50,type:"integer",category:"Behavior"},emphasize:{defaultValue:"secondary",type:"string",category:"Appearance"},backgroundColor:{defaultValue:void 0,type:"Color.COLORS_STATUS",category:"Appearance"},icon:{defaultValue:"",type:"string",category:"Behavior"},appearance:{defaultValue:"chip",type:"string",category:"Behavior"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-controls-label"),this._closeButton=void 0},t.prototype._applyValue=function(e){g.call(this)},t.prototype._applyMaxDisplayLength=function(e){p.call(this)},t.prototype._applyEmphasize=function(e){var t="wux-controls-abstract wux-controls-label wux-controls-label-".concat(this.emphasize||"secondary");this.getContent().className="",this.getContent().addClassName(t)},t.prototype._applyBackgroundColor=function(e){void 0!==this.backgroundColor&&a.isAValidColor(this.backgroundColor,h.COLORS_STATUS)?(this.getContent().style.color=a.hexToHsl(this.backgroundColor)[2]<85?"white":h.COLORS_STATUS.COLOR_DARK_GRAY,this.getContent().style.backgroundColor=this.backgroundColor):(this.backgroundColor=void 0,this.getContent().style.color="",this.getContent().style.backgroundColor="")},t.prototype._applyIcon=function(e){u.call(this)},t.prototype._applyAppearance=function(e){g.call(this)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("icon")&&this._applyIcon(t.icon),this.isDirty("value")&&this._applyValue(t.value),this.isDirty("appearance")&&this._applyAppearance(t.appearance),this.isDirty("maxDisplayLength")&&this._applyMaxDisplayLength(t.maxDisplayLength),this.isDirty("emphasize")&&this._applyEmphasize(t.emphasize),this.isDirty("backgroundColor")&&this._applyBackgroundColor(t.color)},t}(n);return l.addClass(f,"label"),f}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/CustomizableDecorator",["require","exports","DS/Controls/AbstractDecorator","DS/Controls/CustomizableDecoratorItems","DS/Core/WebUXComponents","DS/Utilities/Dom","UWA/Core","DS/Core/PointerEvents","DS/Utilities/WUXUWAUtils"],(function(e,t,i,n,s,o,l,a,r){"use strict";function h(e){var t=new l.Element("div");t.addClassName("wux-decorator-item");var i=n.getItem(e);return i&&Object.keys(i).length>0&&(t.addClassName("wux-decorator-filled-item"),t.setAttribute("itemid",e),i.label?(t.addClassName("wux-decorator-label-item"),t.setText(i.label)):i.icon&&t.setContent(o.generateIcon(i.icon)),i.semantics&&t.addClassName("wux-decorator-item-"+i.semantics)),t}function u(e){if(e)return e.classList.contains("wux-decorator-item")?e:u.call(this,e.getParent())}var c=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return n._views={},r.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{items:{defaultValue:void 0,type:"object|array",category:"Appearance"},activeView:{defaultValue:void 0,type:"string",category:"Behavior"},viewSwitchingDefinition:{defaultValue:void 0,type:"object",category:"Behavior"},onClick:{defaultValue:void 0,type:"function",category:"Behavior"},gridDefinition:{defaultValue:void 0,type:"object",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype._applyItems=function(){this.elements.container.empty(),this._views={}},t.prototype._applyActiveView=function(){this._buildActiveView()},t.prototype._buildContent=function(){return this.elements.container.addClassName("wux-decorator-customizableDecorator"),this._buildActiveView(),this.elements.container},t.prototype.handleEvents=function(){var e=this;o.addEventOnElement(this,this.getContent(),a.POINTERDOWN,(function(e){e.preventDefault(),e.stopPropagation(),u(e.target).addClassName("wux-decorator-customizableDecorator-active")})),o.addEventOnElement(this,this.getContent(),a.POINTERUP,(function(t){t.preventDefault(),t.stopPropagation();var i=u.call(this,t.target),n=i.getAttribute("itemid");e.viewSwitchingDefinition&&e.viewSwitchingDefinition[n]&&(e.activeView=e.viewSwitchingDefinition[n]);var s=!1;if(e.onClick){var o=e.onClick.call(e,{itemID:n,input:e.widget&&e.widget.elements.inputField?e.widget.elements.inputField:void 0});o&&o.preventDefault&&(s=!0)}void 0!==n&&e.widget._onDecoratorClick&&e.widget._onDecoratorClick.call(e.widget,n,s),i.removeClassName("wux-decorator-customizableDecorator-active")}))},t.prototype._buildActiveView=function(){if(this.elements.container.empty(),this.activeView)if(this.activeView&&!this._views[this.activeView]){var e=new l.Element("div"),t=new DocumentFragment,i=Array.isArray(this.items)?this.items:this.items[this.activeView],n=i.length,s=void 0,o=void 0;this.gridDefinition&&"object"==typeof this.gridDefinition&&(this.gridDefinition[this.activeView]?(s=this.gridDefinition[this.activeView].numberOfColumns,o=this.gridDefinition[this.activeView].numberOfLines):this.gridDefinition.numberOfColumns&&this.gridDefinition.numberOfLines&&(s=this.gridDefinition.numberOfColumns,o=this.gridDefinition.numberOfLines));var a=s||Math.ceil(Math.sqrt(n)),r=o||Math.floor(Math.sqrt(n));e.addClassName("wux-decorator-customizableDecorator-view-container"),e.setStyle("grid-template-columns","repeat("+a+", auto)"),e.setStyle("grid-template-rows","repeat("+r+", auto)");for(var u=0;u<n;u++)t.appendChild(h(i[u]));e.appendChild(t),this._views[this.activeView]=e,this.elements.container.appendChild(this._views[this.activeView])}else this.activeView&&this.elements.container.appendChild(this._views[this.activeView]);else this.resetActiveView()},t.prototype.resetActiveView=function(){this.activeView=Array.isArray(this.items)?"WUXDefaultActiveView":Object.keys(this.items)[0]},t.prototype._onShow=function(){this.widget&&this.widget._onDecoratorShow&&this.widget._onDecoratorShow.call(this.widget)},t.prototype._onHide=function(e){this.widget&&this.widget._onDecoratorHide&&this.widget._onDecoratorHide.call(this.widget,e)},t}(i);return s.addClass(c,"customizableDecorator"),c}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/BadgesContainer",["require","exports","DS/Controls/Abstract","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils","DS/Controls/Label","DS/Utilities/Dom","DS/Menu/Menu","DS/Controls/Button","DS/Core/PointerEvents","DS/CoreBase/WebUXGlobalEnums"],(function(e,t,i,n,s,o,l,a,r,h,u){"use strict";function c(e){var t=e.badgeDefinition,i=e.i,n=e.mustAddBadge,s=t.hasOwnProperty("icon")?t.icon:"",l=t.hasOwnProperty("text")&&null!==t.text?t.text:"",a=t.hasOwnProperty("emphasize")?t.emphasize:void 0,r=t.hasOwnProperty("tooltip")?t.tooltip:void 0;if(void 0===this.elements._badges[i]||n){var h=new o({visibleFlag:!1,icon:s,value:l,emphasize:a,tooltipInfos:r});if(this.elements._badges[i]){var u=this.elements.container.children[i];this.elements.container.insertBefore(h.getContent(),u),this.elements._badges.splice(i,0,h)}else this.elements.container.appendChild(h.getContent()),this.elements._badges.push(h)}else this.elements._badges[i].icon=s,this.elements._badges[i].value=l,this.elements._badges[i].emphasize=a,this.elements._badges[i].tooltipInfos=r;null===t.text?this.elements._badges[i].getContent().addClassName("wux-controls-badge-icon"):this.elements._badges[i].getContent().removeClassName("wux-controls-badge-icon"),t.callback?this.elements._badges[i].getContent().addClassName("wux-controls-badge-clickable"):this.elements._badges[i].getContent().removeClassName("wux-controls-badge-clickable")}function d(){this._updateBadgesVisibility(),this.fire("change")}var p=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return s.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:[],type:"WUX.BadgeDefinition[]"}}},enumerable:!1,configurable:!0}),t.prototype.addBadge=function(e,t){if(void 0===t||!("number"!=typeof t||t<0||t>this.value.length)){var i=void 0!==t?t:this.value.length;this.value.splice(i,0,e),c.call(this,{badgeDefinition:e,i:i,mustAddBadge:!0}),d.call(this)}},t.prototype.refreshBadge=function(e){var t=this.value.findIndex((function(t){return t===e}));-1!==t&&(c.call(this,{badgeDefinition:e,i:t}),d.call(this))},t.prototype.removeBadge=function(e){var t=this.value.findIndex((function(t){return t===e}));if(-1!==t){this.value.splice(t,1);var i=this.elements.container.children[t];this.elements.container.removeChild(i),this.elements._badges.splice(t,1),d.call(this)}},t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-badgescontainer"),this.elements._badges=[],this.elements._moreIcon=new r({displayStyle:"lite",icon:{iconName:"menu-dot",fontIconFamily:u.WUXManagedFontIcons.Font3DS},touchMode:!1}),this.elements._moreIcon.getContent().classList.add("wux-controls-badgescontainer-moreicon"),e.prototype.buildView.call(this)},t.prototype.handleEvents=function(){var e=this;this.elements._moreIcon.addEventListener(h.POINTERDOWN,(function(t){t.stopPropagation(),e._showMoreMenu()})),new ResizeObserver((function(t){e._updateBadgesVisibility()})).observe(this.elements.container),l.onNodeRendered(this.elements.container,(function(){e._updateBadgesVisibility(),e.fire("onReady")})),l.addEventOnElement(this,this.elements.container,h.POINTERDOWN,this.clickOnBadge.bind(this))},t.prototype.clickOnBadge=function(e,t){var i;if(t){i=(o=this.value||[]).indexOf(t)}else{var n=l.firstParentWithClass(e.target,"wux-controls-label");if(n){var s=n.dsModel;s&&(i=this.elements._badges.indexOf(s))}}if(i>=0){e&&e.stopPropagation&&e.stopPropagation();var o=this.value||[],a={index:i,icon:this.elements._badges[i].icon,text:this.elements._badges[i].value},r=o[i].callback;r&&r.call(this,a),this.fire("badgeClick",a)}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("value")&&this._applyValue()},t.prototype._applyVisibleFlag=function(t){e.prototype._applyVisibleFlag.call(this,t),this._updateBadgesVisibility()},t.prototype._applyValue=function(){for(var e=this.value||[],t=0;t<e.length;t++)c.call(this,{badgeDefinition:e[t],i:t});for(t=e.length;t<this.elements._badges.length;t++)this.elements._badges[t].remove();this.elements._badges=this.elements._badges.slice(0,e.length),d.call(this)},t.prototype._updateBadgesVisibility=function(){var e=this.elements.container?this.elements.container.offsetWidth:0;if(0!==e){var t=this._getCurrentTouchMode(),i=t?22:19,n=t?14:12,s=[],o=[],a=[],r=[],h=0,u=0,c=0,d=0,p=0,m=Array(this.elements._badges.length).fill(!0);for(this.elements._moreIcon.remove(),this._maxHiddenBadgeWidth=0,p=0;p<this.elements._badges.length;p++)s[p]=this.elements._badges[p].icon?i:0,h=void 0!==this.elements._badges[p].value?l.computeStringWidth(this.elements._badges[p].value,n,"Arial",!1,!1)+8:3,r[p]=s[p]+h+6,u=void 0!==this.elements._badges[p].value?Math.min(h,l.computeStringWidth(this.elements._badges[p].value.substring(0,4)+"...",n,"Arial",!1,!1))+8:3,a[p]=Math.min(s[p]+u+6,r[p]);var g=!1;if(a.reduce((function(e,t){return e+t}),0)<=e){for(d=r.reduce((function(e,t){return e+t}),0),p=this.elements._badges.length-1,c=d;p>=0&&c>=e;p--)c-=r[p],o[p]=Math.max(e-c,a[p]),c+=o[p];for(;p>=0;p--)o[p]=r[p]}else{for(g=!0,p=0,c=0;p<this.elements._badges.length&&c+a[p]<=e-24;p++)c+=a[p];for(var f=p;p<this.elements._badges.length;p++)m[p]=!1,this._maxHiddenBadgeWidth=Math.max(this._maxHiddenBadgeWidth,r[p]);for(p=f-1,c=r.reduce((function(e,t,i){return e+(m[i]?t:0)}),0);p>=0&&c>=e-24;p--)c-=r[p],o[p]=Math.max(e-24-c,a[p]),c+=o[p];for(;p>=0;p--)o[p]=r[p]}for(p=0;p<this.elements._badges.length;p++)m[p]?(this.elements._badges[p]._content&&(this.elements._badges[p]._content.style.width=o[p]-6-s[p]+"px"),this.elements._badges[p].show()):this.elements._badges[p].hide();g&&(this.elements._moreIcon.inject(this.elements.container),this.elements._moreIcon.show())}},t.prototype._showMoreMenu=function(){for(var e=this,t=[],i=function(i){var s,l;n.elements._badges[i].visibleFlag||t.push({type:"PushItem",badge:(s=Object.assign(e.value[i],{className:e.value[i].callback?"wux-controls-badge-clickable":""}),l=new o({icon:s.hasOwnProperty("icon")?s.icon:"",value:s.hasOwnProperty("text")?s.text:"",emphasize:s.hasOwnProperty("emphasize")?s.emphasize:"secondary",tooltipInfos:s.hasOwnProperty("tooltip")?s.tooltip:void 0}),l.getContent().addClassName(s.className),l),tooltip:n.value[i].tooltip,action:{callback:n.clickOnBadge.bind(n,void 0,n.value[i])}})},n=this,s=0;s<this.elements._badges.length;s++)i(s);var l=this.elements._moreIcon.getContent().getBoundingClientRect();0!==t.length&&a.show(t,{position:{x:l.left+l.width-26,y:l.top+l.height},_size:{width:this._maxHiddenBadgeWidth}})},t}(i);return n.addClass(p,"badgesContainer"),p}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ResponsiveViewAdaptor",["require","exports","UWA/Core","DS/Utilities/Utils","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Menu/ContextualMenu","DS/Controls/BadgesContainer","DS/Core/WebUXComponents","DS/WUXTypings/typings/UWA"],(function(e,t,i,n,s,o,l,a,r,h){"use strict";var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{picture:{defaultValue:"",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"string",category:"Appearance"},title:{defaultValue:"",type:"string",category:"Appearance"},multipleTitleLineNumber:{defaultValue:!1,type:"boolean",category:"Behavior"},subtitle:{defaultValue:"",type:"string",category:"Appearance"},description:{defaultValue:"",type:"string",category:"Appearance"},propertiesList:{defaultValue:[],type:"array",category:"Appearance"},displayPropertiesTooltip:{defaultValue:!0,type:"boolean",category:"Appearance"},contextualMenu:{defaultValue:[],type:"array",category:"Behavior"},onContextMenuBuildCallback:{defaultValue:void 0,type:"function",category:"Behavior"},emptyStatusbarVisibleFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},statusbarIcons:{defaultValue:[],type:"array",category:"Behavior"},statusbarLabelsWidthRatios:{defaultValue:[],type:"array",category:"Behavior"},statusbarIconsTooltips:{defaultValue:[],type:"array",category:"Behavior"},onStatusbarIconPointerDown:{defaultValue:void 0,type:"function",category:"Behavior"},activeFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},color:{defaultValue:"",type:"string",category:"Appearance"},customTooltip:{defaultValue:"",type:"object",category:"Appearance"},badges:{defaultValue:[],type:"array",category:"Behavior"},clickableTitle:{defaultValue:!1,type:"boolean",category:"Behavior"},allowUnsafeHTMLContent:{defaultValue:!0,type:"boolean",noNeedToApplyFlag:!0},shouldCellAllowUnsafeHTMLContentFor:{defaultValue:function(e){return this.allowUnsafeHTMLContent},type:"function",noNeedToApplyFlag:!0}}},enumerable:!1,configurable:!0}),t.prototype._preBuild=function(t){this.layoutingCollection=t?t.layoutingCollection:void 0,e.prototype._preBuild.call(this,t)},t.prototype._applyProperties=function(t){this.elements.container.style.display="none",e.prototype._applyProperties.call(this,t),this.isDirty("statusbarIcons")&&this._applyStatusbarIcons(t.statusbarIcons),this.isDirty("badges")&&this._applyBadges(t.badges),this.isDirty("emptyStatusbarVisibleFlag")&&this._applyEmptyStatusbarVisibleFlag(t.emptyStatusbarVisibleFlag),this.isDirty("picture")&&this._applyPicture(t.picture),this.isDirty("icon")&&this._applyIcon(t.icon),this.isDirty("title")&&this._applyTitle(t.title),this.isDirty("clickableTitle")&&this._applyClickableTitle(t.clickableTitle),this.isDirty("multipleTitleLineNumber")&&this._applyMultipleTitleLineNumber(t.multipleTitleLineNumber),this.isDirty("subtitle")&&this._applySubtitle(t.subtitle),this.isDirty("description")&&this._applyDescription(t.description),this.isDirty("propertiesList")&&this._applyPropertiesList(t.propertiesList),this.isDirty("title")&&this._applyTitle(t.title),this.isDirty("contextualMenu")&&this._applyContextualMenu(t.contextualMenu),this.isDirty("onContextMenuBuildCallback")&&this._applyOnContextMenuBuildCallback(t.onContextMenuBuildCallback),this.isDirty("statusbarLabelsWidthRatios")&&this._applyStatusbarLabelsWidthRatios(t.statusbarLabelsWidthRatios),this.isDirty("statusbarIconsTooltips")&&this._applyStatusbarIconsTooltips(t.statusbarIconsTooltips),this.isDirty("onStatusbarIconPointerDown")&&this._applyOnStatusbarIconPointerDown(t.onStatusbarIconPointerDown),this.isDirty("activeFlag")&&this._applyActiveFlag(t.activeFlag),this.isDirty("color")&&this._applyColor(t.color),this.isDirty("customTooltip")&&this._applyCustomTooltip(t.customTooltip),this.elements.container.style.display=""},t.prototype._postBuildView=function(){var t=this;e.prototype._postBuildView.call(this),this.layoutingCollection||(l.onNodeRendered(this.getContent(),(function(e){t._onViewResize()})),this.getContent().addEvent("resize",(function(){t._onViewResize()})))},t.prototype._applyPicture=function(e){if(this.picture){this.elements.container.setAttribute("has-picture","true"),this.elements.picture.innerText&&(this.elements.picture.innerText="",this.elements.checkbox.inject(this.elements.picture));var t=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"picture"):this.shouldCellAllowUnsafeHTMLContentFor("picture");if(i.is(this.picture,"string")){var s=e&&e.getContent?e.getContent():e;n.isHTMLElement(s)&&this.elements.picture.contains(s)&&this.elements.picture.removeChild(s),this.elements.picture.setStyles({backgroundImage:"url("+this.picture+")"})}else if(t){this.elements.picture.setStyles({backgroundImage:""});var o=this.picture;s=o.getContent?o.getContent():this.picture;l.setContent(this.elements.picture,s,!0),!1!==o.displayCheckbox&&this.elements.checkbox.inject(this.elements.picture)}}else{var a=this.layoutingCollection&&this.layoutingCollection._rowModel&&this.layoutingCollection._rowModel._isServerSide()?"":"PLACE YOUR PNG PICTURE HERE";this.elements.container.setAttribute("has-picture","false"),this.elements.picture.innerText=a,this.elements.checkbox.inject(this.elements.picture)}},t.prototype._getViewWidth=function(){},t.prototype._applyViewWidth=function(e){this._getViewWidth()!==e&&this._getViewWidth()>=this._getViewMinWidth()&&(!this._getViewMaxWidth()||this._getViewWidth()<=this._getViewMaxWidth())&&(this.getContent().setStyle("width",this._getViewWidth().toString()+"px"),this._onViewResize())},t.prototype._applyIcon=function(e){if(this.elements.icon.className="",this.elements.icon.addClassName("wux-controls-"+this.name.toLowerCase()+"-icon"),!this.icon)return this.elements.container.setAttribute("has-icon","false"),this.elements.title.setAttribute("has-icon","false"),this.elements.icon&&this.elements.icon.hide(),void this._applyTitle();this.elements.container.setAttribute("has-icon","true"),this.elements.title.setAttribute("has-icon","true"),l.generateIcon(this.icon,{target:this.elements.icon}),this.elements.icon.show(),this._applyTitle()},t.prototype._applyTitle=function(e){this._setTitle(this.title,this.elements.container.titleLineNumber),this._onViewResize()},t.prototype._applyClickableTitle=function(e){this.clickableTitle?this.elements.title.addClassName("wux-controls-responsiveview-clickable-title"):this.elements.title.removeClassName("wux-controls-responsiveview-clickable-title")},t.prototype._setTitle=function(e,t){if(!e)return this.elements.realtitle="",void(this.elements.title&&(this.elements.title.innerHTML=""));this.elements.realtitle=e;var n=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"title"):this.shouldCellAllowUnsafeHTMLContentFor("title");if(1===t)this.elements.title.removeClassName("wux-controls-"+this._getViewCssClassSuffix()+"-multiple-line-title"),this.elements.title.layoutDsModel=this.layoutingCollection,i.is(e,"string")?l.setContent(this.elements.title,e,n):this.elements.title.setHTML(e),this.customTooltip||(this.layoutingCollection&&!1===this.layoutingCollection.displayTitleTooltip?this.tooltipInfos=null:this.tooltipInfos=this._createTooltipModel(e,n));else{var s=this._getTitleLineHeight(),o=e;"true"===this.elements.title.getAttribute("has-icon")&&(o="..W"+e);var a=null;(a=/<\/?[^>]*>/.test(e)?this._createEllipsisHTML({allowUnsafeHTMLContent:n,label:o,maxWidth:"auto",lineHeight:s,nbLinesVisible:t}):l.createEllipsisText({allowUnsafeHTMLLabel:n,label:o,maxWidth:"auto",lineHeight:s,nbLinesVisible:t})).style.wordBreak="break-word","true"===this.elements.title.getAttribute("has-icon")&&a.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-multiple-line-title");var r=this.elements.title.getAttribute("has-icon","true"),h=this.elements.title.getAttribute("has-menu","true");this.elements.titlebar.removeChild(this.elements.title),this.elements.title=a,this.elements.title.layoutDsModel=this.layoutingCollection,this.elements.title.contentView=this,l.addEventOnElement(this,this.elements.title,"click",this._onTitleClick),a.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-title"),this.elements.title.setAttribute("has-icon",r),this.elements.title.setAttribute("has-menu",h),this.clickableTitle&&this.elements.title.addClassName("wux-controls-responsiveview-clickable-title"),this.elements.titlebar.appendChild(a),this.layoutingCollection&&!0!==this.layoutingCollection.displayTitleTooltip||this.customTooltip||(this.tooltipInfos=this._createTooltipModel(e,n))}var u=t*this._getTitleLineHeight()+"px";this.elements.titlebar.setStyle("height",u),this.elements.title.setStyle("height",u)},t.prototype._applyMultipleTitleLineNumber=function(e){(!1===this.multipleTitleLineNumber||!0===this.multipleTitleLineNumber&&"false"===this.elements.propertiesList.getAttribute("has-propertiesList"))&&(this.elements.container.titleLineNumber=!1===this.multipleTitleLineNumber?1:2,this._onViewResize())},t.prototype._applySubtitle=function(e){var t=this.subtitle;if(t){var i=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"subtitle"):this.shouldCellAllowUnsafeHTMLContentFor("subtitle");this.elements.subtitle.layoutDsModel=this.layoutingCollection,l.setContent(this.elements.subtitle,t,i),this.elements.subtitle.setAttribute("has-subtitle","true")}else this.elements.subtitle.setAttribute("has-subtitle","false");this._onViewResize()},t.prototype._applyDescription=function(e){this._setDescription(this.description,this.elements.container.descriptionLineNumber),this._onViewResize()},t.prototype._onTitleClick=function(){var e=this;if(e.contentView&&e.contentView.layoutingCollection){var t=e.contentView.layoutingCollection.getCellInfosFromHtmlElement(e);e.contentView.layoutingCollection._onCellTitleClick(t)}},t.prototype._setDescription=function(e,t){if(!e)return this.elements.description.setAttribute("has-description","false"),this.elements.realdescription="",this.elements.description.textContent="",this._applyPropertiesList(),void("false"!==this.elements.subtitle.getAttribute("has-subtitle")&&"false"!==this.elements.propertiesList.getAttribute("has-propertiesList")&&(this.multipleTitleLineNumber=!1));this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.realdescription=e,1===t?this.elements.description.setAttribute("on-singleLine","true"):this.elements.description.setAttribute("on-singleLine","false");var i=this._getDescriptionLineHeight(),n=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"description"):this.shouldCellAllowUnsafeHTMLContentFor("description"),s=l.createEllipsisText({allowUnsafeHTMLLabel:n,label:e,maxWidth:"auto",lineHeight:i,nbLinesVisible:t});this.elements.description.getParent()===this.elements.maincontent&&this.elements.maincontent.removeChild(this.elements.description),this.elements.description=s,this.elements.description.layoutDsModel=this.layoutingCollection,this.elements.description.setAttribute("has-description","true"),s.addClassName("wux-controls-"+this._getViewCssClassSuffix()+"-description"),this.elements.maincontent.appendChild(s)},t.prototype._applyPropertiesList=function(e){this._propertiesArray||(this._propertiesArray=[]),this._propertiesSpacersArray||(this._propertiesSpacersArray=[]);var t=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"propertiesList"):this.shouldCellAllowUnsafeHTMLContentFor("propertiesList");if(this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.propertiesList){var n=this._propertiesArray.length,s=this.propertiesList.length,o=this.displayPropertiesTooltip;if(this.layoutingCollection&&(o=this.layoutingCollection.displayPropertiesTooltip),s>n)for(var a=n;a<s;a++){var r=new i.Element("div",{class:"wux-controls-"+this._getViewCssClassSuffix()+"-propertyDesc"});r.setStyle("display","none"),r.layoutDsModel=this.layoutingCollection,l.setContent(r,this.propertiesList[a],t),r.tooltipInfos=o?this._createTooltipModel(this.propertiesList[a],t):null,this._propertiesArray.push(r)}if(s>this._propertiesSpacersArray.length)for(a=this._propertiesSpacersArray.length;a<s;a++){var h=new i.Element("div",{class:"wux-controls-"+this._getViewCssClassSuffix()+"-propertyDesc-spacer"});h.setStyle("display","none"),this._propertiesSpacersArray.push(h)}for(a=n;a<s;a++)(a+1)%2==0?(this._propertiesArray[a].inject(this.elements.propertiesListSecondContainer),this._propertiesSpacersArray[a].inject(this.elements.propertiesListSecondContainer)):(this._propertiesArray[a].inject(this.elements.propertiesListFirstContainer),this._propertiesSpacersArray[a].inject(this.elements.propertiesListFirstContainer));for(var u=0;u<this.propertiesList.length;u++)this._propertiesArray[u].layoutDsModel=this.layoutingCollection,l.setContent(this._propertiesArray[u],this.propertiesList[u],t),o?this._propertiesArray[u].tooltipInfos?this._propertiesArray[u].tooltipInfos.shortHelp=this.propertiesList[u]:this._propertiesArray[u].tooltipInfos=this._createTooltipModel(this.propertiesList[u],t):this._propertiesArray[u].tooltipInfos=null}"false"===this.elements.description.getAttribute("has-description")?this.propertiesList&&this.propertiesList.length>0?(this.elements.description.setStyle("display","none"),this.elements.propertiesList.setAttribute("has-propertiesList","true"),"false"!==this.elements.subtitle.getAttribute("has-subtitle")&&(this.multipleTitleLineNumber=!1)):this.elements.description.setStyle("display","block"):(this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.description.setStyle("display","block")),this._onViewResize()},t.prototype._applyDisplayPropertiesTooltip=function(e){this._applyPropertiesList()},t.prototype._applyContextualMenu=function(e){this.contextualMenu&&(this.contextualMenu.length||!0===this.contextualMenu)?(this.elements.title.setAttribute("has-menu","true"),this.elements.subtitle.setAttribute("has-menu","true"),this.elements.maincontent.setAttribute("has-menu","true"),this.elements.titlebar.setAttribute("has-menu","true"),this.elements.menu.setAttribute("has-menu","true"),this.elements.menu.list=this.contextualMenu):(this.elements.title.setAttribute("has-menu","false"),this.elements.subtitle.setAttribute("has-menu","false"),this.elements.titlebar.setAttribute("has-menu","false"),this.elements.maincontent.setAttribute("has-menu","false"),this.elements.menu.setAttribute("has-menu","false"))},t.prototype._applyOnContextMenuBuildCallback=function(e){e&&this.elements.menu.removeEventListener(o.POINTERUP,e);var t=this;l.addEventOnElement(this,this.elements.menu,o.POINTERDOWN,(function(e){if(t.layoutingCollection&&!o.isTouchEvent(e)){var i=t.layoutingCollection.getCellInfosFromHtmlElement(t.getContent());i.cellModel&&t.layoutingCollection.modelProvider.isNodeSelected(i.cellModel)&&e.stopPropagation()}})),l.addEventOnElement(this,this.elements.menu,"click",(function(e){var i=t.layoutingCollection;if(o.isTouchEvent(e)&&i){var n=i.getCellInfosFromHtmlElement(t.getContent());if(n){var s=n.nodeModel;s&&!i.modelProvider.isNodeSelected(s)&&(i._cellUISelectionAction=!0,i.modelProvider.selectNode(s,!0),i._setActiveNode(s,!0),i._cellUISelectionAction=!1)}}var l=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!1,view:window,clientX:e.pageX-window.pageXOffset,clientY:e.pageY-window.pageYOffset});l.dispatchContext="menuClick",this.dispatchEvent(l),e.stopPropagation()})),a.addEventListener(t.elements.container,{callback:function(e){var i=e&&e.data?e.data.event:void 0;i&&i.stopPropagation();var n=t.layoutingCollection;if(n&&n.onContextualEvent){n._cellCtxMenuRequired=!0;var s=n.getCellInfosFromHtmlElement(t.getContent());if(s){var o=s.cellModel;t.disabled||!o||n.modelProvider.isNodeSelected(o)||(n._cellUISelectionAction=!0,n.modelProvider.selectNode(o,!0),n.setActiveNode(o,!0),n._cellUISelectionAction=!1)}var l=n.onContextualEvent;return l.callback.call(l.this,{context:t,infos:e.info,data:e.data,menu:t.contextualMenu,infoContext:e.context,cellInfos:n.getCellInfosFromHtmlElement(t.getContent())})}return t._setCtxMenuCB(e)}})},t.prototype._applyEmptyStatusbarVisibleFlag=function(e){!0===this.emptyStatusbarVisibleFlag?(this.elements.statusbar.setAttribute("is-empty-statusbar-visible","true"),this.elements.container.setAttribute("is-empty-statusbar-visible","true")):!1===this.emptyStatusbarVisibleFlag&&(this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false"),this.elements.container.setAttribute("is-empty-statusbar-visible","false"))},t.prototype._applyStatusbarIcons=function(e){this.statusbarIcons&&this.statusbarIcons.length>8&&this.statusbarIcons.splice(8,this.statusbarIcons.length-8),this._displayAllStatusBarIcons()},t.prototype._displayAllStatusBarIcons=function(){var e=this;this.statusbarIcons&&0!==this.statusbarIcons.length||this.badges&&0!==this.badges.length?(this.elements.container.setAttribute("has-statusbar-content","true"),this.elements.statusbar.setAttribute("has-statusbar-content","true")):(this.elements.container.setAttribute("has-statusbar-content","false"),this.elements.statusbar.setAttribute("has-statusbar-content","false"));var t=[];if(this.statusbarIcons){for(var i=void 0,n=void 0,s=function(s){o.statusbarIconsTooltips=o.statusbarIconsTooltips||[],n="string"==typeof o.statusbarIconsTooltips[s]?{shortHelp:o.statusbarIconsTooltips[s]}:o.statusbarIconsTooltips[s],o.statusbarIcons[s]?"string"==typeof o.statusbarIcons[s]?i={icon:o.statusbarIcons[s],text:null,tooltip:n}:(i={icon:o.statusbarIcons[s].icon,text:o.statusbarIcons[s].label,emphasize:o.statusbarIcons[s].emphasize,tooltip:o.statusbarIcons[s].tooltip||n},o.statusbarIcons[s].callback&&(i.callback=function(t){var i=e.layoutingCollection;if(i){var n={cellInfos:i.getCellInfosFromHtmlElement(e.getContent()),clickedIconIndex:t.index,icon:t.icon,text:t.text};e.statusbarIcons[s].callback&&e.statusbarIcons[s].callback(n)}})):i={tooltip:n},t.push(i)},o=this,l=0;l<this.statusbarIcons.length;l++)s(l);if(this.badges){var a;for(l=0;l<this.badges.length;l++)a={icon:this.badges[l],text:"",emphasize:void 0},t.push(a)}this.elements.statusbarBadgesContainer||(this.elements.statusbarBadgesContainer=(new r).inject(this.elements.statusbar)),this.elements.statusbarBadgesContainer.value=t,this.elements.statusbaricons=[];for(l=0;l<t.length;l++)this.elements.statusbaricons[l]=this.elements.statusbarBadgesContainer.elements._badges[l].getContent()}this._onViewResize()},t.prototype._applyBadges=function(e){this._displayAllStatusBarIcons()},t.prototype._applyStatusbarLabelsWidthRatios=function(e){},t.prototype._applyStatusbarIconsTooltips=function(e){this.statusbarIconsTooltips=this.statusbarIconsTooltips||[],this._displayAllStatusBarIcons()},t.prototype._getViewCssClassSuffix=function(){},t.prototype._applyOnStatusbarIconPointerDown=function(e){var t=this;e&&this.removeEventListener("StatusbarIconPointerDown",this._onStatusbarIconPointerDownCB),this._onStatusbarIconPointerDownCB=function(e){var i=t.layoutingCollection;return i&&i.onStatusbarIconPointerDown?i.onStatusbarIconPointerDown.call(t,{cellInfos:i.getCellInfosFromHtmlElement(t.getContent()),clickedIconIndex:e.options?e.options.iconIndex:-1,icon:e.options?e.options.icon:void 0,text:e.options?e.options.text:void 0}):t.onStatusbarIconPointerDown?t.onStatusbarIconPointerDown(e):void 0},this.addEventListener("StatusbarIconPointerDown",this._onStatusbarIconPointerDownCB)},t.prototype._getViewMinWidth=function(){},t.prototype._getViewMaxWidth=function(){},t.prototype._applyActiveFlag=function(e){void 0!==this.activeFlag&&(!0===this.activeFlag?this.elements.container.setAttribute("active-mode","true"):!1===this.activeFlag&&this.elements.container.setAttribute("active-mode","false"))},t.prototype._applyColor=function(e){this.color&&"initial"!=this.color?(this.elements.color.setAttribute("has-color","true"),this.elements.color.setStyles({background:this.color}).show()):this.elements.color.setAttribute("has-color","false")},t.prototype._applyCustomTooltip=function(e){var t=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"customTooltip"):this.shouldCellAllowUnsafeHTMLContentFor("customTooltip");this.customTooltip!==e&&((this.customTooltip||e)&&this.customTooltip?this.tooltipInfos=this._createTooltipModel(this.customTooltip,t):this.layoutingCollection&&!1===this.layoutingCollection.displayTitleTooltip?this.tooltipInfos=null:this.tooltipInfos=this._createTooltipModel(this.title,t))},t.prototype.handleEvents=function(){var e=this;l.addEventOnElement(this,this.elements.container,"mouseenter",(function(t){t&&t.touchFlag||e.prehighlight()})),l.addEventOnElement(this,this.elements.container,"mouseleave",(function(t){e.unPrehighlight()})),l.addEventOnElement(this,this.elements.checkbox,o.POINTERDOWN,(function(t){e.layoutingCollection&&e.layoutingCollection._enableInteractiveMultiSelMode()})),this.elements.statusbarBadgesContainer&&l.addEventOnElement(this,this.elements.statusbarBadgesContainer,"badgeClick",(function(t){e.fire("StatusbarIconPointerDown",{iconIndex:t.options.index,icon:t.options.icon,text:t.options.text}),t.stopPropagation()}))},t.prototype.prehighlight=function(){var e=this;e.isPreHighlighted||e.disabled||e.layoutingCollection&&"none"===e.layoutingCollection.getUsedCellPreselectionFeedback()||(e.elements.container.addClassName("wux-ui-state-prehighlighted"),e.elements.checkbox.addClassName("wux-ui-state-prehighlighted"),e.elements.highlightBorder.addClassName("wux-ui-state-prehighlighted"),e.isPreHighlighted=!0)},t.prototype.unPrehighlight=function(){var e=this;e.isPreHighlighted&&!e.disabled&&(e.elements.container.removeClassName("wux-ui-state-prehighlighted"),e.elements.checkbox.removeClassName("wux-ui-state-prehighlighted"),e.elements.highlightBorder.removeClassName("wux-ui-state-prehighlighted"),e.isPreHighlighted=!1)},t.prototype.isHighlighted=function(){return this._isHighlighted},t.prototype.highlight=function(){this.disabled||(this._isHighlighted=!0,this.elements.container.addClassName("wux-ui-state-highlighted"),this.elements.checkbox.addClassName("wux-ui-state-highlighted"),this.elements.highlightBorder.addClassName("wux-ui-state-highlighted"))},t.prototype.unhighlight=function(){this._isHighlighted&&(this._isHighlighted=!1,this.elements.container.removeClassName("wux-ui-state-highlighted"),this.elements.checkbox.removeClassName("wux-ui-state-highlighted"),this.elements.highlightBorder.removeClassName("wux-ui-state-highlighted"))},t.prototype.activate=function(){this.elements.container.addClassName("wux-ui-state-activated")},t.prototype.deactivate=function(){this.elements.container.removeClassName("wux-ui-state-activated")},t.prototype.setPictureBackgroundSize=function(e){this.elements.picture&&this.elements.picture.setStyle("background-size",e)},t.prototype.onStatusbarIconPointerDown=function(e){this._modelEvents.publish({event:"StatusbarIconPointerDown",context:this,data:this})},t.prototype._setCtxMenuCB=function(e){var t=[];if(this.elements.menu.list&&this.elements.menu.list.length){var i=this.elements.menu.list;if(this.onContextMenuBuildCallback)t=this.onContextMenuBuildCallback(i);else for(var n=0;n<i.length;n++)t.push({type:"PushItem",title:i[n],action:{callback:function(e){window.console.error("No action implemented on this context menu entry! Please implement onContextMenuBuildCallback callback!")}}}),n>=0&&n<i.length&&t.push({type:"SeparatorItem"})}return t},t.prototype._onViewResize=function(){if("false"===this.elements.description.getAttribute("has-description")&&"true"===this.elements.propertiesList.getAttribute("has-propertiesList")||this.elements.description.setStyle("display","block"),"true"===this.elements.propertiesList.getAttribute("has-propertiesList")){var e=0;if(this.layoutingCollection&&this.layoutingCollection.layout)e=this.layoutingCollection.layout._columnWidth-(97+("true"===this.elements.maincontent.getAttribute("has-menu")?40:10));else{var t=window.getComputedStyle(this.elements.maincontent);e=t.width?parseInt(t.width,10):0}var s=Math.max(0,Math.floor(e/175)),o=Math.min(this.propertiesList.length,this._propertiesArray.length),a=Math.min(2*s,o);if(0===a&&(a=this.propertiesList.length>=2?2:1===this.propertiesList.length?1:0),0!==a){for(var r=((e-20*Math.round(a/2))/Math.round(a/2)).toString()+"px",h=0;h<a;h++)this._propertiesArray[h].setStyle("display","block"),this._propertiesArray[h].setStyle("width",r),this._propertiesSpacersArray[h].setStyle("display","block");for(h=a;h<this._propertiesArray.length;h++)this._propertiesArray[h].setStyle("display","none"),this._propertiesSpacersArray[h].setStyle("display","none")}else for(h=0;h<this._propertiesArray.length;h++)this._propertiesArray[h].setStyle("display","none"),this._propertiesSpacersArray[h].setStyle("display","none")}var u=this.elements.container.titleLineNumber,c=1;"false"===this.elements.subtitle.getAttribute("has-subtitle")&&"false"===this.elements.propertiesList.getAttribute("has-propertiesList")&&(!0===this.multipleTitleLineNumber?u++:0,c=0),"false"===this.elements.description.getAttribute("has-description")&&"false"===this.elements.propertiesList.getAttribute("has-propertiesList")&&(!0===this.multipleTitleLineNumber&&u++);var d=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"title"):this.shouldCellAllowUnsafeHTMLContentFor("title"),p=i.createElement("div",{});n.getUnsafeHTMLContentValueToApply(d)?p.innerHTML=this.elements.realtitle:p.innerText=this.elements.realtitle;var m=l.computeStringWidth(this.elements.realdescription,13,"arial"),g=0,f=0;if(this.layoutingCollection&&this.layoutingCollection.layout)g=this.layoutingCollection.layout._columnWidth-(97+("true"===this.elements.maincontent.getAttribute("has-menu")?40:10)),f="true"===this.elements.container.getAttribute("has-icon")?16:0;else{var v=window.getComputedStyle(this.elements.maincontent);g=parseInt(v.width,10);var y=window.getComputedStyle(this.elements.icon);f=parseInt(y.width,10)}u>1&&m<g-f&&(u=1),this._setTitle(this.elements.realtitle,u),u>1?this.elements.title.setAttribute("on-singleLine","false"):this.elements.title.setAttribute("on-singleLine","true"),this.elements.realdescription?(this.elements.container.descriptionLineNumber=4-u-c,this._setDescription(this.elements.realdescription,4-u-c)):3===u&&this.elements.description.setStyle("display","none")},t.prototype._createEllipsisHTML=function(e){var t=e||{maxWidth:"auto",lineHeight:18,nbLinesVisible:2,textAlign:"justify"};if(1===t.nbLinesVisible){var s={class:"wux-button-label-ellipsis-nowrap",styles:{"max-width":t.maxWidth,"line-height":t.lineHeight+"px"}};return n.getUnsafeHTMLContentValueToApply(t.allowUnsafeHTMLContent)?s.html=t.label:s.text=t.label,new i.Element("div",s)}var o=t.nbLinesVisible||2,a=t.lineHeight,r={class:"wux-button-label-ellipsis-wrap",styles:{"text-align":t.textAlign,"max-width":t.maxWidth,"line-height":t.lineHeight+"px","max-height":t.lineHeight*o+"px"}};n.getUnsafeHTMLContentValueToApply(t.allowUnsafeHTMLContent)?r.html=t.label:r.text=t.label;var h=new i.Element("div",r);return l.onNodeRendered(h,(function(){var e=null,t=0,n=0,s=null,l=null,r=null,u=[],c=0,d=0;h.getChildren().every((function(i,a){if(0!==n)u.push(i);else{var h=i.getPosition().y;h!==e&&(e=h,t++),t===o&&(n=a,l=i,r=s,c=i.getPosition().x,d=i.getPosition().y,u.push(i))}return s=i,!0}));var p=i.createElement("span",{styles:{overflow:"hidden","text-overflow":"ellipsis","white-space":"pre",display:"inline-block"}});c>0&&(p.setStyle("position","absolute"),r.setStyle("margin-right","3px"));var m=h.getDimensions().width-c-1;p.setStyle("width",m+"px"),h.insertBefore(p,l);for(var g=0;g<u.length;g++)h.removeChild(u[g]),u[g].setStyle("margin-right","3px"),p.appendChild(u[g]);var f=p.getPosition().y;if(Math.abs(f-d)>=a)p.setStyle("position","relative");else if(Math.abs(f-d)>=a-2){p.setStyle("position","absolute"),r.setStyle("margin-right","3px");var v=p.getPosition().x,y=h.getDimensions().width-v-1;p.setStyle("width",y+"px")}""===p.innerHTML&&p.setStyle("display","none")})),h},t.prototype._getTitleLineHeight=function(){return 15},t.prototype._getDescriptionLineHeight=function(){return 13},t.prototype._createTooltipModel=function(e,t){var i={};if("string"==typeof e)i.shortHelp=e;else if(e)for(var n in e)i[n]=e[n];return i.allowUnsafeHTMLTitle=t,i.allowUnsafeHTMLShortHelp=t,i.allowUnsafeHTMLLongHelp=t,i},t.prototype._setHighlightModel=function(e){for(var t=["title","subtitle","description"],i=[],s=[],o=0;o<t.length;o++){var l=t[o];i.push(this.elements[l]),s.push({highlightModel:e,newValue:this[l],allowUnsafeHTMLContent:this.allowUnsafeHTMLContent})}var a=this.elements.statusbaricons||[];for(o=0;o<a.length;o++){var r=this.elements.statusbaricons[o].getElementsByClassName("wux-controls-label-content")[0];r&&(i.push(r),s.push({highlightModel:e,newValue:r.textContent,allowUnsafeHTMLContent:this.allowUnsafeHTMLContent}))}n.highlightContentsDeep(i,s)},t}(s);return h.addClass(u,"ResponsiveViewAdaptor"),u}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ResponsiveThumbnailView",["require","exports","UWA/Core","DS/Utilities/Utils","DS/Controls/ResponsiveViewAdaptor","DS/Utilities/Dom","DS/CoreEvents/ModelEvents","DS/Controls/ProgressBar","DS/Core/WebUXComponents"],(function(e,t,i,n,s,o,l,a,r){"use strict";var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{thumbnailWidth:{defaultValue:200,type:"integer",category:"Behavior"},progressValueData:{defaultValue:void 0,type:"object",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this._modelEvents=new l,this._isHighlighted=!1,this.elements.container.addClassName("wux-controls-responsivethumbnailview"),this.elements.container.setAttribute("has-icon","false"),this.elements.container.setAttribute("active-mode","false"),this.elements.container.titleLineNumber=1,this.elements.container.descriptionLineNumber=2,this.elements.dndArea=i.createElement("div",{class:"wux-controls-responsivethumbnailview-dndarea"}).inject(this.elements.container),this.elements.highlightBorder=new i.Element("div",{class:"wux-controls-highlightborder"}).inject(this.elements.container),this.elements.activediv=new i.Element("div",{class:"wux-controls-activediv"}).inject(this.elements.container),this.elements.picture=new i.Element("div",{class:"wux-controls-responsivethumbnailview-picture"}).inject(this.elements.container),this.elements.color=new i.Element("div",{class:"wux-controls-responsivethumbnailview-color"}).inject(this.elements.picture),this.elements.color.setAttribute("has-color","false"),this.elements.checkbox=new i.Element("div",{class:"wux-controls-responsivethumbnailview-checkbox"}).inject(this.elements.picture),this.elements.maincontent=new i.Element("div",{class:"wux-controls-responsivethumbnailview-maincontent"}).inject(this.elements.container),this.elements.maincontent.setAttribute("has-menu","false"),this.elements.titlebar=new i.Element("div",{class:"wux-controls-responsivethumbnailview-titlebar"}).inject(this.elements.maincontent),this.elements.icon=new i.Element("div",{class:"wux-controls-responsivethumbnailview-icon"}).inject(this.elements.titlebar),this.elements.title=new i.Element("div",{class:"wux-controls-responsivethumbnailview-title"}).inject(this.elements.titlebar),this.elements.title.contentView=this,o.addEventOnElement(this,this.elements.title,"click",this._onTitleClick),this.elements.title.setAttribute("has-menu","false"),this.elements.title.setAttribute("has-icon","false"),this.elements.subtitle=new i.Element("div",{class:"wux-controls-responsivethumbnailview-subtitle"}).inject(this.elements.maincontent),this.elements.subtitle.setAttribute("has-subtitle","false"),this.elements.subtitle.setAttribute("has-menu","false"),this.elements.mc_pb_separator=new i.Element("div",{class:"wux-controls-mc_desc_separator"}).inject(this.elements.container),this.elements.mc_pb_separator.setAttribute("has-progressBar","false"),this.elements.progressBar=(new a).inject(this.elements.container),this.elements.progressBar.getContent().addClassName("wux-controls-responsivethumbnailview-progressbar"),this.elements.progressBar.getContent().setAttribute("has-progressBar","false"),this.elements.progressBar.getContent().setAttribute("is-lite-display-style","false"),this.elements.progressBar.tooltipInfos={},this.elements.mc_desc_separator=new i.Element("div",{class:"wux-controls-mc_desc_separator"}).inject(this.elements.container),this.elements.description=new i.Element("div",{class:"wux-controls-responsivethumbnailview-description"}).inject(this.elements.container),this.elements.description.setAttribute("has-description","false"),this.elements.propertiesList=new i.Element("div",{class:"wux-controls-responsivethumbnailview-propertiesListContainer"}).inject(this.elements.container),this.elements.propertiesList.setAttribute("has-propertiesList","false");for(var e=0;e<13;e++)new i.Element("div",{class:"wux-controls-responsivethumbnailview-propertyDesc"}).inject(this.elements.propertiesList);this.elements.menu=new i.Element("div",{class:"wux-controls-responsivethumbnailview-menu"}).inject(this.elements.maincontent),this.elements.menu.setAttribute("has-menu","false"),this.elements.statusbar_separator=new i.Element("div",{class:"wux-controls-statusbar_separator"}).inject(this.elements.container),this.elements.statusbar=new i.Element("div",{class:"wux-controls-responsivethumbnailview-statusbar"}).inject(this.elements.container),this.elements.statusbar.setAttribute("has-statusbar-content","false"),this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false"),this.elements.statusbaricons=[]},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("thumbnailWidth")&&this._applyThumbnailWidth(t.thumbnailWidth),this.isDirty("progressValueData")&&this._applyProgressValueData(t.progressValueData)},t.prototype._applyPicture=function(e){if(this.picture){this.elements.container.setAttribute("has-picture","true"),this.elements.picture.innerText&&(this.elements.picture.innerText="",this.elements.color.inject(this.elements.picture),this.elements.checkbox.inject(this.elements.picture));var t=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"picture"):this.shouldCellAllowUnsafeHTMLContentFor("picture");if(i.is(this.picture,"string")){var s=e&&e.getContent?e.getContent():e;n.isHTMLElement(s)&&this.elements.picture.contains(s)&&(this.elements.picture.innerText="",this.elements.color.inject(this.elements.picture),this.elements.checkbox.inject(this.elements.picture)),this.elements.picture.setStyles({backgroundImage:"url("+this.picture+")"})}else if(t){this.elements.picture.setStyles({backgroundImage:""});var l=this.picture;s=l.getContent?l.getContent():l;o.setContent(this.elements.picture,s,!0),!1!==l.displayCheckbox&&this.elements.checkbox.inject(this.elements.picture)}}else{var a=this.layoutingCollection&&this.layoutingCollection._rowModel&&this.layoutingCollection._rowModel._isServerSide()?"":"PLACE YOUR PNG PICTURE HERE";this.elements.container.setAttribute("has-picture","false"),this.elements.picture.innerText=a,this.elements.color.inject(this.elements.picture),this.elements.checkbox.inject(this.elements.picture)}},t.prototype._applyThumbnailWidth=function(e){this._applyViewWidth(e)},t.prototype._applyProgressValueData=function(e){e!==this.progressValueData&&(!this.layoutingCollection&&void 0!==this.progressValueData&&void 0!==this.progressValueData.progressValue||this.layoutingCollection&&!0===this.layoutingCollection.useProgressBar?(!i.is(this.progressValueData.progressValue,"number")||this.progressValueData.progressValue<0?console.warn("Warning, progressValue value must be number greater or equal than 0 because layout.useProgressBar is set to true."):(this.elements.progressBar.value=this.progressValueData.progressValue,this.progressValueData.emphasize&&(this.elements.progressBar.emphasize=this.progressValueData.emphasize),this.progressValueData.displayStyle&&(this.elements.progressBar.displayStyle=this.progressValueData.displayStyle,"lite"===this.progressValueData.displayStyle?this.elements.progressBar.getContent().setAttribute("is-lite-display-style","true"):this.elements.progressBar.getContent().setAttribute("is-lite-display-style","false")),this.progressValueData.tooltipInfos&&this.progressValueData.tooltipInfos.shortHelp&&(this.elements.progressBar.tooltipInfos.shortHelp=this.progressValueData.tooltipInfos.shortHelp),this.progressValueData.tooltipInfos&&this.progressValueData.tooltipInfos.longHelp&&(this.elements.progressBar.tooltipInfos.longHelp=this.progressValueData.tooltipInfos.longHelp),this.progressValueData.tooltipInfos&&this.progressValueData.tooltipInfos.shortHelpImage&&(this.elements.progressBar.tooltipInfos.shortHelpImage=this.progressValueData.tooltipInfos.shortHelpImage)),this.elements.mc_pb_separator.setAttribute("has-progressBar","true"),this.elements.progressBar.getContent().setAttribute("has-progressBar","true")):(this.elements.mc_pb_separator.setAttribute("has-progressBar","false"),this.elements.progressBar.getContent().setAttribute("has-progressBar","false")))},t.prototype._applyMultipleTitleLineNumber=function(e){this.multipleTitleLineNumber&&(this.elements.container.titleLineNumber=2,this._onViewResize())},t.prototype._applyDescription=function(t){this.elements.mc_desc_separator.style.display="none",e.prototype._applyDescription.call(this,t),this._updateStatusBarSeparatorVisibility()},t.prototype._setDescription=function(e,t){if(!e)return this.elements.description.setAttribute("has-description","false"),this.elements.realdescription="",void this._applyPropertiesList();this.elements.mc_desc_separator.style.display="",this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.realdescription=e,1===t?this.elements.description.setAttribute("on-singleLine","true"):this.elements.description.setAttribute("on-singleLine","false");var i=t;if(this.layoutingCollection&&this.layoutingCollection.layout){var n=this.layoutingCollection.getViewportDimensions(!0),s=Math.floor((n.width-(this.layoutingCollection.layout._numberOfColumns+1)*this.layoutingCollection.layout.gutter)/this.layoutingCollection.layout._numberOfColumns);s<150&&(s=150);var l=this.layoutingCollection.layout.getRowHeight()-(this.layoutingCollection._getPictureHeight()+this.layoutingCollection._getMainContentHeight()+this.layoutingCollection._getDescriptionBottomMargins()+("true"===this.elements.statusbar.getAttribute("has-statusbar-content")||!0===this.emptyStatusbarVisibleFlag?this.layoutingCollection._getStatusbarHeight():0)+(!0===this.layoutingCollection.useProgressBar?this.layoutingCollection._getProgressBarContainerHeight():0));i=Math.floor(l/13)}else{var a=window.getComputedStyle(this.elements.description),r=0,h=o.computeStringWidth(this.elements.realdescription,11,"arial");""!==a.width?0!==(r=parseInt(a.width,10))&&(r-=28):r=this.thumbnailWidth,i=0,0!==r&&(i=Math.ceil(h/r)),0===i&&(i=1),++i>13&&(i=13),1===i?this.elements.description.setAttribute("on-singleLine","true"):this.elements.description.setAttribute("on-singleLine","false")}var u=this._getDescriptionLineHeight(),c=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"description"):this.shouldCellAllowUnsafeHTMLContentFor("description"),d=o.createEllipsisText({allowUnsafeHTMLLabel:c,label:e,maxWidth:"auto",lineHeight:u,nbLinesVisible:i}),p=this.elements.description.getAttribute("on-singleLine");this.elements.container.removeChild(this.elements.description),this.elements.description=d,this.elements.description.layoutDsModel=this.layoutingCollection,this.elements.description.setAttribute("has-description","true"),this.elements.description.setAttribute("on-singleLine",p),this.elements.description.addClassName("wux-controls-responsivethumbnailview-description"),this.elements.container.insertBefore(d,this.elements.statusbar_separator),this._updateThumbnailHeightFromDescriptionOrProperties(i)},t.prototype._applyPropertiesList=function(e){this.elements.mc_desc_separator.style.display="none";for(var t=0;t<this.elements.propertiesList.children.length;t++)this.elements.propertiesList.children[t].setStyle("display","none");var i=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"propertiesList"):this.shouldCellAllowUnsafeHTMLContentFor("propertiesList"),n=window.getComputedStyle(this.elements.mc_desc_separator),s=parseInt(n.width,10).toString()+"px",l=this.displayPropertiesTooltip;this.layoutingCollection&&(l=this.layoutingCollection.displayPropertiesTooltip);var a=this.layoutingCollection?this.layoutingCollection.descriptionLinesNumber:13;if(this.propertiesList){this.propertiesList.length>0&&(this.elements.mc_desc_separator.style.display="");for(t=0;t<this.propertiesList.length&&t<a;t++){var r=this.elements.propertiesList.children[t];r.layoutDsModel=this.layoutingCollection,t===a-1&&this.propertiesList.length>a?o.setContent(r,"..."):o.setContent(r,this.propertiesList[t],i),l?r.tooltipInfos?r.tooltipInfos.shortHelp=this.propertiesList[t]:r.tooltipInfos={shortHelp:this.propertiesList[t]}:r.tooltipInfos=null,""!==this.propertiesList[t]?(r.setStyle("display","block"),r.setStyle("width",s)):r.setStyle("display","none")}}"false"===this.elements.description.getAttribute("has-description")?(this.elements.description.setStyle("display","none"),this.propertiesList&&this.propertiesList.length>0?this.elements.propertiesList.setAttribute("has-propertiesList","true"):this.elements.propertiesList.setAttribute("has-propertiesList","false")):(this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.description.setStyle("display","block")),this._updateStatusBarSeparatorVisibility();var h=this.propertiesList?this.propertiesList.length:0;this._updateThumbnailHeightFromDescriptionOrProperties(Math.min(h,a))},t.prototype._applyBadges=function(t){e.prototype._applyBadges.call(this,t),this._updateStatusBarSeparatorVisibility()},t.prototype._applyStatusbarIcons=function(t){e.prototype._applyStatusbarIcons.call(this,t),this._updateStatusBarSeparatorVisibility()},t.prototype._updateStatusBarSeparatorVisibility=function(){this.elements.statusbar_separator.setAttribute("has-statusbar-content",this.elements.statusbar.getAttribute("has-statusbar-content")),"false"!==this.elements.statusbar.getAttribute("has-statusbar-content")||"true"!==this.elements.description.getAttribute("has-description")&&"true"!==this.elements.propertiesList.getAttribute("has-propertiesList")||this.elements.statusbar_separator.setAttribute("has-statusbar-content","true")},t.prototype._getViewMinWidth=function(){return 150},t.prototype._getViewMaxWidth=function(){return 420},t.prototype._getViewWidth=function(){return this.thumbnailWidth},t.prototype._onViewResize=function(){var e=this.elements.container.titleLineNumber,t=this.layoutingCollection?this.layoutingCollection.descriptionLinesNumber:10;"false"===this.elements.subtitle.getAttribute("has-subtitle")&&!0===this.multipleTitleLineNumber&&e++;var s=this.layoutingCollection?this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos,"title"):this.shouldCellAllowUnsafeHTMLContentFor("title"),l=i.createElement("div",{});n.getUnsafeHTMLContentValueToApply(s)?l.innerHTML=this.elements.realtitle:l.innerText=this.elements.realtitle;var a=o.computeStringWidth(this.elements.realdescription,13,"arial"),r=window.getComputedStyle(this.elements.title),h=parseInt(r.width,10),u=window.getComputedStyle(this.elements.icon),c=parseInt(u.width,10);e>1&&a<h-c&&(e=1),this._setTitle(this.elements.realtitle,e),e>1?(this.elements.title.setAttribute("on-singleLine","false"),this.elements.subtitle.setAttribute("title-on-singleLine","false")):(this.elements.title.setAttribute("on-singleLine","true"),this.elements.subtitle.setAttribute("title-on-singleLine","true")),this.elements.realdescription||"false"===this.elements.description.getAttribute("has-description")?(this.elements.container.descriptionLineNumber=t,this._setDescription(this.elements.realdescription,t)):3===e&&this.elements.description.setStyle("display","none")},t.prototype._getViewCssClassSuffix=function(){return"responsivethumbnailview"},t.prototype._updateThumbnailHeightFromDescriptionOrProperties=function(e){if(!this.layoutingCollection){var t=window.getComputedStyle(this.elements.container);if(t.width){var i=parseInt(t.width,10),n=e*this._getDescriptionLineHeight()+14,s=3/4*i+70+(void 0!==this.progressValueData?44:0)+n+(this.statusbarIcons&&this.statusbarIcons.length>0||(!this.statusbarIcons||0===this.statusbarIcons.length)&&!0===this.emptyStatusbarVisibleFlag?28:0);this.elements.container.style.height=s.toString()+"px"}}},t}(s);return r.addClass(h,"ResponsiveThumbnailView"),h}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,s=0,o=t.length;s<o;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))};define("DS/Controls/TimePicker",["require","exports","DS/Controls/Abstract","DS/Controls/TimeChooser","DS/Controls/LineEditor","DS/Controls/Button","DS/Controls/Popup","DS/Controls/_private/DateUtilsPrivate","UWA/Core","DS/Utilities/LanguageUtils","DS/Utilities/DateUtils","DS/Utilities/Dom","DS/Core/WebUXComponents","i18n!DS/Controls/assets/nls/translation","DS/CoreBase/WebUXGlobalEnums"],(function(e,t,i,n,s,o,l,a,r,h,u,c,d,p,m){"use strict";function g(e){return e instanceof Date&&!isNaN(e.getTime())}function f(e,t){if(!g.call(this,e)||!g.call(this,t))return!1;var i={hour:"2-digit",minute:"2-digit"};return"sec"===this.precision&&(i.second="2-digit"),e.toLocaleTimeString("en",i)===t.toLocaleTimeString("en",i)}function v(){var e=this.value,t=this.mode;if("number"==typeof e&&"duration"===t){var i=this.getHours().toString().padStart(2,"0"),n=this.getMinutes().toString().padStart(2,"0"),s=void 0;"sec"===this.precision?(s=this.getSeconds().toString().padStart(2,"0"),this.elements.inputField.value=i+"h "+n+"m "+s+"s"):this.elements.inputField.value=i+"h "+n+"m"}else if("number"!=typeof e&&"duration"!==t&&g(e)){var o={datePrecision:"none",timePrecision:this.precision};"24"===t&&(o.timeStyle="23h");var l=u.formatDateToString(e,o);this.elements.inputField.value=l}else this.elements.inputField.value=""}function y(e,t){switch(t){case"hr":return 36e5*e;case"min":return 6e4*e;case"sec":return 1e3*e;default:return 1}}function _(e,t){if(void 0!==e)return"sec"===t?36e5*e.getHours()+6e4*e.getMinutes()+1e3*e.getSeconds():36e5*e.getHours()+6e4*e.getMinutes()}function b(){var e,t=this.precision;return e="duration"===this.mode?"00h 00m"+("sec"===this.precision?" 00s":""):p.datePicker_hour+":"+p.datePicker_minute+("sec"===t?":"+p.datePicker_second:""),this.elements&&this.elements.inputField&&(this.elements.inputField.placeholder=e),e}function C(){var e=this,t={target:this.elements.timeChooserButton.getContent(),position:"bottom",offset:{x:0,y:4},trigger:"click",constraint:"screen",alignment:"far",overlap:!1,className:"wux-controls-popup wux-controls-timepicker-popup",positionTarget:this.elements.container,getBody:function(){return e.elements.timeChooser=new n({value:void 0!==e.value||"duration"===e.mode?e.value:new Date,hoursStep:e.hoursStep,minutesStep:e.minutesStep,secondsStep:e.secondsStep,mode:e.mode,precision:e.precision}),e.elements.timeChooser.addEventListener("change",(function(t){t.stopPropagation(),e._updatingTimeChooser||t.dsModel&&"undefined"!==t.dsModel.value&&("duration"===e.mode?r.equals(e.value,t.dsModel.value)||(e.value=t.dsModel.value):f.call(e,e.value,e.elements.timeChooser.value)||(e.value=new Date(t.dsModel.value)),v.call(e))})),e.elements.timeChooser}};l.delayPopupCreation(t,(function(t){e.elements.popup=t,e.elements.popup.addEventListener("hide",(function(t){e.popupVisibleFlag=!1,c.pushUserInteractionContext(),e.value&&("duration"===e.mode?r.equals(e.value,t.dsModel.value)||e.fire("change"):f.call(e,e.value,e._onShowPopupValue)||e.fire("change")),t.stopPropagation(),e.elements.timeChooserButton&&e.elements.timeChooserButton.getContent().removeAttribute("wuxactive"),e.fire("hide"),c.popUserInteractionContext()})),e.elements.popup.addEventListener("show",(function(t){e.popupVisibleFlag=!0,"duration"===e.mode?e._onShowPopupValue=e.value:e._onShowPopupValue=new Date(e.value),e.value&&("duration"===e.mode?r.equals(e.value,e.elements.timeChooser.value)||(e.elements.timeChooser.value=e.value):f.call(e,e.value,e.elements.timeChooser.value)||(e.elements.timeChooser.value=new Date(e.value))),t.stopPropagation(),e.elements.timeChooserButton&&e.elements.timeChooserButton.getContent().setAttribute("wuxactive",""),e.fire("show")}))}))}var w=function(e){function t(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return e.apply(this,__spreadArray([t],i,!1))||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:void 0,type:"date",category:"Behavior",advancedSetter:!0},precision:{defaultValue:"min",type:"string",category:"Behavior"},mode:{defaultValue:"time",type:"string",category:"Behavior"},hoursStep:{defaultValue:1,type:"integer",category:"Behavior"},minutesStep:{defaultValue:1,type:"integer",category:"Behavior"},secondsStep:{defaultValue:1,type:"integer",category:"Behavior"},popupVisibleFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},allowUndefinedFlag:{defaultValue:!1,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype._preBuild=function(t){e.prototype._preBuild.call(this,t),t&&"duration"===t.mode?this._properties.value.value=0:this._properties.value.value=new Date},t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-controls-timepicker"),this.elements.inputField=new s({sizeInCharNumber:20,selectAllOnFocus:!0,placeholder:b.call(this)}).inject(this.elements.container),this.elements.inputField.getContent().addClassName("wux-controls-timepicker-lineeditor"),this.elements.timeChooserButton=new o({emphasize:"primary",icon:{iconName:"clock",fontIconSize:"1x",fontIconFamily:m.WUXManagedFontIcons.Font3DS},displayStyle:"lite"}).inject(this.elements.container),this.elements.timeChooserButton.getContent().addClassName("wux-controls-timepicker-button"),this._onShowPopupValue=this.value,C.call(this)},t.prototype.handleEvents=function(){var e=this,t=this;c.addEventOnElement(this,this.elements.inputField,"change",(function(e){if(e.stopPropagation(),e.dsModel){var i=e.dsModel.value;if(i){var n=i;if("duration"===t.mode){var s=function(e){var t=a.parseDuration(e);if(t){var i=[t.hours,t.minutes,t.seconds];if(3===(null==i?void 0:i.length)){for(var n=0,s="hr",o=0;o<(null==i?void 0:i.length);++o){var l=i[o];if(o>0&&(l>59||l<0))return NaN;n+=y(l,s),"hr"===s?s="min":"min"===s&&(s="sec")}return n}}}(n);"number"!=typeof s||isNaN(s)||t.setPropertyFromUIInteraction("value",s)}else{var o=a.parseTime(n);if(o){var l=new Date("2016/07/13 ".concat(o.hours,":").concat(o.minutes,":").concat(o.seconds));!l||isNaN(l.getTime())||f.call(t,l,t.value)||t.setPropertyFromUIInteraction("value",l)}}v.call(t)}else t.allowUndefinedFlag&&""===i?t.setPropertyFromUIInteraction("value",void 0):v.call(t)}})),c.addEventOnElement(this,this.elements.inputField,"click",(function(t){t.stopPropagation(),e.elements.popup?e.elements.popup.visibleFlag||(e.elements.popup.visibleFlag=!0):e.elements.timeChooserButton.getContent().click()})),this._updateOnRegionLanguageChange=function(){v.call(e)},h.subscribe("onRegionalFormatLanguageChange",this._updateOnRegionLanguageChange),h.subscribe("onUseISO8601ForDateAndTimeChange",this._updateOnRegionLanguageChange)},t.prototype._preEditValue=function(e,t){return void 0===t||("duration"===this.mode&&"number"==typeof t?!(isNaN(t)||t<0):t?"string"==typeof t?(this.value=new Date(t),!1):t instanceof Date?!r.equals(e,t):void 0:{validValue:void 0})},t.prototype._applyValue=function(e){"duration"===this.mode?"object"==typeof this.value&&(this.value=_(this.value,this.precision)):void 0!==this.value&&"object"!=typeof this.value&&(this.value=new Date(this.value)),v.call(this),this.elements.popup&&this.elements.popup.visibleFlag?"duration"===this.mode?(this._updatingTimeChooser=!0,r.equals(this.value,this.elements.timeChooser.value)||(this.elements.timeChooser.value=this.value),this._updatingTimeChooser=!1):(this._updatingTimeChooser=!0,f.call(this,this.elements.timeChooser.value,this.value)||(this.elements.timeChooser.value=new Date(this.value)),this._updatingTimeChooser=!1,this.fire("liveChange")):(this._updatingTimeChooser=!0,void 0===this.value&&this.elements.timeChooser&&(this.elements.timeChooser.value="duration"===this.mode?void 0:new Date),this._updatingTimeChooser=!1,this.fire("change"))},t.prototype._applyPrecision=function(e){"min"===this.precision||"sec"===this.precision?(v.call(this),b.call(this),this.elements.timeChooser&&(this.elements.timeChooser.precision=this.precision)):this.precision=e},t.prototype._applyMode=function(e,t){if("time"!==t&&"24"!==t&&"duration"!==t&&(this._properties.mode.value="time"),"duration"===this.mode&&"number"!=typeof this.value){var i=_(this.value,this.precision);this.value=i}v.call(this),b.call(this),this.elements.timeChooser&&(this.elements.timeChooser.mode=this.mode)},t.prototype._applyHoursStep=function(e){this.elements.timeChooser&&(this.elements.timeChooser.hoursStep=this.hoursStep)},t.prototype._applyMinutesStep=function(e){this.elements.timeChooser&&(this.elements.timeChooser.minutesStep=this.minutesStep)},t.prototype._applySecondsStep=function(e){this.elements.timeChooser&&(this.elements.timeChooser.secondsStep=this.secondsStep)},t.prototype._applyDisabled=function(t){e.prototype._applyDisabled.call(this,t),this.elements.inputField.disabled=this.disabled,this.elements.timeChooserButton.disabled=this.disabled},t.prototype._applyPopupVisibleFlag=function(e){this.elements.popup&&(this.popupVisibleFlag?this.elements.popup.visibleFlag=!0:this.elements.popup.visibleFlag=!1)},t.prototype._applyTouchMode=function(t){e.prototype._applyTouchMode.call(this,t),this.elements.timeChooserButton&&(this.elements.timeChooserButton.touchMode=this.touchMode),this.elements.inputField&&(this.elements.inputField.touchMode=this.touchMode)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("hoursStep")&&this._applyHoursStep(t.hoursStep),this.isDirty("minutesStep")&&this._applyMinutesStep(t.minutesStep),this.isDirty("secondsStep")&&this._applySecondsStep(t.secondsStep),this.isDirty("mode")&&this._applyMode(t.mode,this.mode),this.isDirty("precision")&&this._applyPrecision(t.precision),this.isDirty("value")&&d._applyForAdvancedSetterProperty(this,"value",t.value,this.value)},t.prototype.getHours=function(){var e=this.value;if(void 0!==e)return"number"==typeof e?Math.floor(e/36e5):e.getHours()},t.prototype.getMinutes=function(){var e=this.value;if(void 0!==e)return"number"==typeof e?Math.floor(e/6e4%60):e.getMinutes()},t.prototype.getSeconds=function(){var e=this.value;if(void 0!==e)return"number"==typeof e?Math.floor(e/1e3%60):e.getSeconds()},t.prototype.destroy=function(){h.unsubscribe("onRegionalFormatLanguageChange",this._updateOnRegionLanguageChange),h.unsubscribe("onUseISO8601ForDateAndTimeChange",this._updateOnRegionLanguageChange),e.prototype.destroy.call(this)},t}(i);return d.addClass(w,"timePicker"),w})),define("DS/Controls/DatePicker",["UWA/Core","DS/Controls/Abstract","DS/Utilities/LanguageUtils","DS/Utilities/Dom","DS/Utilities/DateUtils","DS/Controls/Popup","DS/Controls/TimePicker","DS/Controls/LineEditor","DS/Controls/Button","DS/Controls/SelectionChipsEditor","DS/Controls/SelectionChips","DS/Utilities/KeyboardUtils","DS/Core/PointerEvents","DS/Controls/_private/DateUtilsPrivate","DS/Core/WebUXComponents","i18n!DS/Controls/assets/nls/translation"],(function(e,t,i,n,s,o,l,a,r,h,u,c,d,p,m,g){"use strict";let f={};function v(){if(f.displayLang!==i.regionalFormatLanguage){let e=i.regionalFormatLanguage,t=new Date(2022,1),n="2022",s={year:"numeric"};f={displayLang:e};let o=new Intl.DateTimeFormat(e,s),l=o.formatToParts(t).some((e=>e.value===n));l||(e=e.split("-")[0],e!==i.regionalFormatLanguage&&(o=new Intl.DateTimeFormat(e,s),l=o.formatToParts(t).some((e=>e.value===n)))),l||(e="en-GB"),f.editLang=e,o=new Intl.DateTimeFormat(f.editLang,{hour:"numeric",minute:"numeric"});let a=o.formatToParts(new Date);f.hasDayPeriod=a.some((e=>"dayPeriod"===e.type))}}let y=function(){const e=["year","month","day","hour","minute","second"];return function(t){let i="";for(let n of e)t[n]&&(i+=n+"|"+t[n]+"|");return i}}();function _(){let e={year:"numeric",month:"numeric",day:"numeric"};return this.timePickerFlag&&(e.hasDayPeriod=f.hasDayPeriod,e.hour="numeric",e.minute="numeric","sec"===this.timePickerPrecision&&(e.second="numeric")),e}function b(){let e={year:"numeric",month:"short",day:"numeric"};return this.timePickerFlag&&(e.hour="numeric",e.minute="numeric","sec"===this.timePickerPrecision&&(e.second="numeric")),e}let C=function(){const e=["/",":"," "],t=["hour","minute","second"],i=["year","month","day"],n=new Date(2022,1,1,15,4,5);function s(){let s=b.call(this),o=_.call(this),l=y(s),a=y(o),r="display_"+l;f[r]=new Intl.DateTimeFormat(f.displayLang,s),r="displayNeg_"+l,s.era="short",f[r]=new Intl.DateTimeFormat(f.displayLang,s);let h="edit_"+a;f[h]=new Intl.DateTimeFormat(f.editLang,o);let u="parts_"+a,c=f[h].formatToParts(n),d=0,m=0,v=c.length-1,C=f[u]=[];c.forEach(((n,s)=>{"literal"===n.type&&s!==v?(n.value=p.updateSpaces(n.value," "),e.indexOf(n.value)>-1?C.push(n.value):", "===n.value?C.push(" "):m&&m<3?C.push("/"):d?C.push(":"):C.push(" ")):i.indexOf(n.type)>-1?(m++,C.push(n.type)):t.indexOf(n.type)>-1?(d++,C.push(n.type)):"dayPeriod"===n.type&&C.push(n.type)}));let w,x="placeholder_"+a,E="";for(w=0,v=C.length;w<v;++w){let e=C[w];"dayPeriod"!==e&&(E+=g["datePicker_"+e]||e)}f[x]=p.updateSpaces(E).trim().replace("  "," ")}return function(e){let t="display"===e||"displayNeg"===e?b.call(this):_.call(this),i=e+"_"+y(t);return f[i]||s.call(this),f[i]}}();function w(){let e=C.call(this,"placeholder");return this._tooltipInfos?this._tooltipInfos.shortHelp=e:this._tooltipInfos={shortHelp:e},this.elements&&this.elements.inputField&&this.elements.inputField.placeholder&&(this.elements.inputField.placeholder=e),this.elements&&this.elements._selChipsEdt&&this.elements._selChipsEdt.placeholder&&(this.elements._selChipsEdt.placeholder=e),e}function x(e,t,i){this[e]=s.addToDate(this[e],t,i)}function E(e,t,i,n){return s.isDateInBetween(e,t,i,!0===n?"time":n||"day")}function S(e,t,i,n){if(e&&!E(e,t,i,n)){if(t&&e<t)return t;if(i&&e>i)return i}}function D(e,t,i){return s.areDatesEqual(e,t,i?"time":"day")}function A(e,t,i){s.pushUniqueDate(e,t,i?"time":"day")}function F(e,t,i){return void 0===t&&void 0===e||!(!e||!t)&&(e instanceof Date&&t instanceof Date?D(e,t,i):Array.isArray(e)&&t instanceof Date?e.some((e=>D(e,t,i))):!(!Array.isArray(e)||!Array.isArray(t))&&(e.length===t.length&&e.every((e=>F(e,t,i)))))}const P=function(e){if(e){let t={timePrecision:this.timePickerFlag?this.timePickerPrecision:void 0};if(e instanceof Date)return s.formatDateToString(e,t);if(Array.isArray(e))return e.map((e=>s.formatDateToString(e,t)))}},I=function(){const e=["year","month","day","hour","minute","second"];return function(t){let i=C.call(this,"edit"),n=C.call(this,"parts");if(t instanceof Date)return function(t,i,n){const s=t.getFullYear();let o,l=i.formatToParts(t),a="";for(let t=0,i=n.length;t<i;++t)o=l[t],e.indexOf(o.type)>-1?"year"===o.type?a+=s:a+=o.value:"dayPeriod"===o.type?a+=o.value:a+=n[t];return a=p.updateSpaces(a),a}(t,i,n)}}();function V(e){const t=p.parseDateAndTime(e);if(t){let e=[t.year,t.month,t.day];"number"==typeof t.hours&&e.push(t.hours,t.minutes,t.seconds);let i=new Date(...e);return i.setFullYear(t.year),i}}function T(){this.elements.popup?this.elements.popup.visibleFlag||(this.elements.popup.visibleFlag=!0):this.elements.calendarButton.getContent().click()}function B(){this.elements.popup&&this.elements.popup.visibleFlag&&(this.elements.popup.visibleFlag=!1)}function O(e){this.elements._selChipsEdt&&(this._updatingChips=!0,this.elements._selChipsEdt.value=P.call(this,e),this._updatingChips=!1)}function M(){if(!this.allowMultipleValuesFlag)if(this._preventUpdateView)this._updateViewNeeded=!0;else if(this.elements.inputField)if(this.value){let e="";if(e=this._editModeFlag?I.call(this,this.value):P.call(this,this.value),e!==this.elements.inputField.value){let t=this._editModeFlag;this._editModeFlag=!1,this.elements.inputField.value=e,this._editModeFlag=t}}else this.elements.inputField.value=""}function N(){this&&this.elements&&this.elements.popupContent&&(this.elements._selChipsEdt&&this.elements._selChipsEdt._lineEditor.preventBlurForTargetedElements([this.elements.popupContent]),this.elements.inputField&&this.elements.inputField.preventBlurForTargetedElements([this.elements.popupContent]))}let L=function(){let e=new Promise((e=>{require(["DS/Controls/Calendar"],(t=>e(t)))}));return()=>e}();return t.inherit({name:"datePicker",publishedProperties:{value:{defaultValue:void 0,type:"date",category:"Behavior",advancedSetter:!0},minValue:{defaultValue:void 0,type:"date",category:"Behavior"},maxValue:{defaultValue:void 0,type:"date",category:"Behavior"},timePickerFlag:{defaultValue:!1,type:"boolean",category:"Appearance"},timePickerPrecision:{defaultValue:"min",type:"string",category:"Appearance"},popupVisibleFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},allowUndefinedFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},allowMultipleValuesFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},showWeekNumbers:{defaultValue:void 0,type:"boolean",category:"Appearance"},hideTodayOrNowButton:{defaultValue:!1,type:"boolean",category:"Behavior"}},blackBoxFlag:!0,_smartInputClass:"wux-controls-datepicker",keymaps:{esc:"manageEscape"},commands:{manageEscape:function(){return this.elements.popup&&this.elements.popup.visibleFlag?(B.call(this),{stopPropagation:!0,infos:{actionPerformed:!0}}):{stopPropagation:!1}}},init:function(...e){v(),this._editModeFlag=!1,this._parent(...e)},buildView:function(){this.elements.container.addClassName(this._smartInputClass),this.elements.inputField=new a({selectAllOnFocus:!0,fireOnlyFromUIInteractionFlag:!0,placeholder:w.call(this)}).inject(this.elements.container),this.elements.calendarButton=new r({emphasize:"primary",icon:{iconName:"calendar",fontIconSize:"1x",fontIconFamily:WUXManagedFontIcons.Font3DS},displayStyle:"lite"}).inject(this.elements.container),this.elements.calendarButton.getContent().addClassName("wux-controls-datepicker-button"),this.elements.popupContent=e.createElement("div",{class:"wux-controls-datepicker-popup-content"}),N.call(this),this.value=new Date,this._buildPopup()},handleEvents:function(){let e=this;n.addEventOnElement(this,this.elements.inputField,"change",(function(t){if(t.stopPropagation(),e._editModeFlag&&!e.allowMultipleValuesFlag)if(""!==t.dsModel.value){const i=V.call(e,t.dsModel.value);E(i,e.minValue,e.maxValue,e.timePickerFlag)?e.setPropertyFromUIInteraction("value",i):M.call(e)}else e.allowUndefinedFlag&&""===t.dsModel.value?e.setPropertyFromUIInteraction("value",void 0):M.call(e)})),n.addEventOnElement(this,this.elements.inputField,"click",(function(t){t.stopPropagation(),T.call(e)})),n.addEventOnElement(this,this.elements.inputField._getElementToFocus(),"blur",(function(){e._editModeFlag=!1,M.call(e)})),n.addEventOnElement(this,this.elements.calendarButton,d.POINTERHIT,(e=>e.stopPropagation())),n.addEventOnElement(this,this.elements.container,d.POINTERDOWN,(e=>e.stopPropagation())),n.addEventOnElement(this,this.elements.container,d.POINTERHIT,(e=>e.stopPropagation())),e._updateOnCurrentLanguageChange=function(){e.elements&&e.elements.container&&(v(),w.call(e),M.call(e),O.call(e,e.value))},i.subscribe("onRegionalFormatLanguageChange",e._updateOnCurrentLanguageChange)},destroy:function(){i.unsubscribe("onRegionalFormatLanguageChange",this._updateOnCurrentLanguageChange),this._parent()},incrementDay:function(){x.call(this,"value",1,"day")},decrementDay:function(){x.call(this,"value",-1,"day")},incrementMonth:function(){x.call(this,"value",1,"month")},decrementMonth:function(){x.call(this,"value",-1,"month")},_preEditValue:function(e,t){if(void 0===e&&void 0===t)return!1;if(void 0===t)return!0;if(this.allowMultipleValuesFlag){if(!Array.isArray(t))return!1;for(let e=0,i=t.length;e<i;++e)t[e]=s.convertToDate(t[e])}else if(!(t=s.convertToDate(t)))return!1;let i;if(Array.isArray(t)){i=[];for(let e=0;e<t.length;++e){let n=t[e];n=S(n,this.minValue,this.maxValue,this.timePickerFlag)||n,E(n,this.minValue,this.maxValue,this.timePickerFlag)&&A(i,n,this.timePickerFlag)}}else E(t=S(t,this.minValue,this.maxValue,this.timePickerFlag)||t,this.minValue,this.maxValue,this.timePickerFlag)&&(i=t);return!(!i||F(e,i,this.timePickerFlag))&&{validValue:i}},_applyValue:function(e,t){M.call(this),this.elements.calendar&&(this.elements.calendar.value=t),O.call(this,t),this._updatingTimePicker=!0,!this.allowMultipleValuesFlag&&this.timePickerFlag&&this.elements.timePicker&&(this.elements.timePicker.value=t?new Date(t):new Date),this._updatingTimePicker=!1,this.elements.popup&&this.elements.popup.visibleFlag&&this.elements.popup._updateView(),this.fire("change")},_applyDisabled:function(){this._parent();const e=this.disabled;this.elements.calendarButton.disabled=e,this.elements.inputField.disabled=e,this.elements._selChipsEdt&&(this.elements._selChipsEdt.disabled=e)},_applyTouchMode:function(){this._parent();const e=this.touchMode;this.elements.calendarButton&&(this.elements.calendarButton.touchMode=e),this.elements.inputField&&(this.elements.inputField.touchMode=e),this.elements.calendar&&(this.elements.calendar.touchMode=e),this.elements._selChipsEdt&&(this.elements._selChipsEdt.touchMode=e)},_correctValueToMinMaxValues:function(){let e=this.value,t=this.minValue,i=this.maxValue;if(e&&e instanceof Date){const n=S(e,t,i,this.timePickerFlag);n&&(this.value=n)}else if(e&&Array.isArray(e)){let n;e=e.map((e=>{const s=S(e,t,i,this.timePickerFlag);return s&&(n=!0),s||e})),n&&(this.value=e)}},_applyMinValue:function(){this._correctValueToMinMaxValues(),this.elements.calendar&&(this.elements.calendar.minValue=this.minValue)},_applyMaxValue:function(){this._correctValueToMinMaxValues(),this.elements.calendar&&(this.elements.calendar.maxValue=this.maxValue)},_applyTimePickerFlag:function(e,t){t!==e&&(t?this._buildTimePicker():this.elements.timePicker&&(this.elements.calendar&&(this.elements.calendar._timePicker=void 0),this.elements.timePicker.destroy(),delete this.elements.timePicker),w.call(this),this.allowMultipleValuesFlag?O.call(this,this.value):M.call(this))},_applyTimePickerPrecision:function(){this.elements.timePicker&&(this.elements.timePicker.precision=this.timePickerPrecision),w.call(this),this.allowMultipleValuesFlag?O.call(this,this.value):M.call(this)},_applyAllowMultipleValuesFlag:function(e,t){if(t===e)return;const i=this.value;t&&i&&!Array.isArray(i)?this._properties.value.value=[i]:!t&&i&&Array.isArray(i)&&(this._properties.value.value=1!==i.length?void 0:i[0]),this.elements.calendar&&this.elements.calendar.setProperties({allowUndefinedFlag:t||this.allowUndefinedFlag,allowMultipleValuesFlag:t,value:this.value}),this._buildSelectionChipsEditor(),t?(this.elements.inputField.remove(),this.elements.calendarButton.getContent().style.display="none",this.elements._selChipsEdt.inject(this.elements.container)):(this.elements._selChipsEdt&&this.elements._selChipsEdt.remove(),this.elements.inputField.inject(this.elements.container,"top"),this.elements.calendarButton.getContent().style.display="")},_applyShowWeekNumbers:function(){this.elements.calendar&&(this.elements.calendar.showWeekNumbers=this.showWeekNumbers)},_applyHideTodayOrNowButton:function(){this.elements.calendar&&(this.elements.calendar.hideTodayOrNowButton=this.hideTodayOrNowButton)},_applyTooltipInfos:function(e,t){this._parent(e,t),this.elements._selChipsEdt&&(this.elements._selChipsEdt.tooltipInfos=t?void 0:this._tooltipInfos)},_applyProperties:function(e){this._parent(e),this._preventUpdateView=!0,this.isDirty("value")&&m._applyForAdvancedSetterProperty(this,"value",e.value,this.value),this.isDirty("minValue")&&this._applyMinValue(e.minValue,this.minValue),this.isDirty("maxValue")&&this._applyMaxValue(e.maxValue,this.maxValue),this.isDirty("timePickerFlag")&&this._applyTimePickerFlag(e.timePickerFlag,this.timePickerFlag),this.isDirty("timePickerPrecision")&&this._applyTimePickerPrecision(e.timePickerPrecision,this.timePickerPrecision),this.isDirty("allowMultipleValuesFlag")&&this._applyAllowMultipleValuesFlag(e.allowMultipleValuesFlag,this.allowMultipleValuesFlag),this.isDirty("showWeekNumbers")&&this._applyShowWeekNumbers(),this.isDirty("hideTodayOrNowButton")&&this._applyHideTodayOrNowButton(),this._preventUpdateView=!1,this._updateViewNeeded&&(M.call(this),this._updateViewNeeded=!1)},_getElementToFocus:function(){return this.elements[this.allowMultipleValuesFlag?"_selChipsEdt":"inputField"]._getElementToFocus()},_onFocusReceived:function(){this._isFocused()||(this._parent(),this._editModeFlag=!0,M.call(this),this.allowMultipleValuesFlag?this.elements._selChipsEdt&&this.elements._selChipsEdt._onFocusReceived():(this.elements.inputField._resetFocus(),this.elements.inputField._onFocusReceived()))},_giveFocus:function(){this._isFocused()||(this._parent(),this._editModeFlag=!0,M.call(this),this.elements.inputField._giveFocus())},_applyPopupVisibleFlag:function(){this.elements.popup&&(this.elements.popup.visibleFlag=Boolean(this.popupVisibleFlag))},_buildPopup:function(){const e=this,t={target:this.elements.calendarButton.getContent(),position:"bottom",offset:{x:0,y:4},trigger:"click",constraint:"screen",className:"wux-controls-popup wux-controls-datepicker-popup",alignment:"far",overlap:!1,positionTarget:this.elements.container,getBody:function(){return this.elements.calendar?this.elements.popupContent:L().then(function(t){if(this.elements.popupContent)return this.elements.calendar||(this.elements.calendar=new t({value:this.value,minValue:this.minValue,maxValue:this.maxValue,allowMultipleValuesFlag:this.allowMultipleValuesFlag,allowUndefinedFlag:!!this.allowMultipleValuesFlag||this.allowUndefinedFlag,showWeekNumbers:this.showWeekNumbers,hideTodayOrNowButton:this.hideTodayOrNowButton,fireOnlyFromUIInteractionFlag:!0}),this._buildTimePicker(),this.elements.calendar.inject(this.elements.popupContent),N.call(this),this.elements.calendar.addEventListener("change",(function(t){if(t.stopPropagation(),!t.dsModel)return;let i,n;if(t.dsModel.value)if(e.allowMultipleValuesFlag){let s=e.value;(s&&s.length<t.dsModel.value.length||!s&&1===t.dsModel.value.length)&&(n=t.dsModel.value.length-1),i=t.dsModel.value.map((e=>new Date(e)))}else if(i=new Date(t.dsModel.value),e.elements.timePicker);else if(e.value)i.setHours(e.value.getHours()),i.setMinutes(e.value.getMinutes()),i.setSeconds(e.value.getSeconds());else{const e=new Date;i.setHours(e.getHours()),i.setMinutes(e.getMinutes()),i.setSeconds(e.getSeconds())}e.setPropertyFromUIInteraction("value",i),"number"==typeof n&&e.elements._selChipsEdt&&(e.elements._selChipsEdt.selectChip(n),e._updatingTimePicker=!0,e.elements.timePicker&&(e.elements.timePicker.value=e.value[n]),e._updatingTimePicker=!1),e.allowMultipleValuesFlag||B.call(e)}))),this.elements.popupContent}.bind(this))}.bind(this)};this._popupDelayInfos=o.delayPopupCreation(t,(function(t){e.elements.popup=t,t.addEventListener("show",(function(i){i.stopPropagation(),i.dsModel===t&&(e.elements.calendar&&(e.elements.calendar.value=e.value,e.elements.calendar.referenceDate=e.value),e.elements.calendarButton&&e.elements.calendarButton.getContent().setAttribute("wuxactive",""),e.setPropertyFromUIInteraction("popupVisibleFlag",!0),e.fire("show"))})),t.addEventListener("hide",(function(t){t.target===e.elements.popup.getContent()&&(t.stopPropagation(),e.elements.calendarButton&&e.elements.calendarButton.getContent().removeAttribute("wuxactive"),e.setPropertyFromUIInteraction("popupVisibleFlag",!1),e.fire("hide"),M.call(e))})),n.addEventOnElement(e,t.getContent(),"keydown",(function(t){c.ESCAPE===t.keyCode&&B.call(e)}))}))},_buildTimePicker:function(){if(!this.timePickerFlag||this.elements.timePicker||!this.elements.calendar)return;let e;this.allowMultipleValuesFlag?Array.isArray(e)&&(e=1===e.length?e[0]:null):e=this.value,this.elements.timePicker=new l({value:e instanceof Date?e:new Date,precision:this.timePickerPrecision}),this.elements.timePicker.getContent().style.width="100%","min"===this.timePickerPrecision&&this.elements.timePicker.elements.popup&&(this.elements.timePicker.elements.popup.offset.x=-80),this.elements.calendar._timePicker=this.elements.timePicker;let t=this;this.elements.timePicker.addEventListener("change",(function(e){if(e.stopPropagation(),!t._updatingTimePicker&&e.dsModel&&e.dsModel.value){let e,i,n=t.elements.timePicker.value,s=t.value;if(!n)return;if(Array.isArray(s)){if(t.elements._selChipsEdt){let o=t.elements._selChipsEdt.getSelectedChipsValue();if(o&&1===o.length)for(let l=0,a=s.length;l<a;++l){let a=P.call(t,s[l]);if(o[0]===a){i=l,e=[...s];let t=new Date(e[l]);e[l]=t,t.setHours(n.getHours()),t.setMinutes(n.getMinutes()),t.setSeconds(n.getSeconds());break}}}}else s&&(e=new Date(s),e.setHours(n.getHours()),e.setMinutes(n.getMinutes()),e.setSeconds(n.getSeconds()));e&&t.setPropertyFromUIInteraction("value",e),"number"==typeof i&&t.elements._selChipsEdt&&t.elements._selChipsEdt.selectChip(i)}})),this.elements.timePicker.addEventListener("show",(e=>e.stopPropagation())),this.elements.timePicker.addEventListener("hide",(e=>e.stopPropagation()))},_buildSelectionChipsEditor:function(){if(this.elements._selChipsEdt||!this.allowMultipleValuesFlag)return void(this.elements._selChipsEdt&&(this.elements._selChipsEdt.value=P.call(this,this.value)));this.elements._selChipsEdt=new h({value:P.call(this,this.value),placeholder:w.call(this),uniqueValue:!0,selection:{toggle:!0,mode:u.SELECTION_MODE.SINGLE,unselectAllOnEmptyArea:!0},disabled:this.disabled,touchMode:this.touchMode,fireOnlyFromUIInteractionFlag:!0,customValidator:function(e){if(!this.allowMultipleValuesFlag)return"";let t=V.call(this,e),i=this.value,n=i?Array.isArray(i)?i.slice():void 0:[];return n&&(n.push(t),this.setPropertyFromUIInteraction("value",n)),i&&i.length&&this.value&&i.length===this.value.length?P.call(this,t):""}.bind(this)}),this.elements._selChipsEdt.tooltipInfos=this.tooltipInfos?void 0:this._tooltipInfos,N.call(this);let e=this;n.addEventOnElement(this,this.elements._selChipsEdt._getElementToFocus(),"focus",(function(){T.call(e)})),n.addEventOnElement(this,this.elements._selChipsEdt._getElementToFocus(),d.POINTERDOWN,(function(){T.call(e)})),n.addEventOnElement(this,this.elements._selChipsEdt,"change",(function(t){if(t.stopPropagation(),e._updatingChips)return;const i=e.elements._selChipsEdt.value;let n=e.value,s=[];for(let t=0,o=i.length;t<o;++t)for(let o=0,l=n.length;o<l;++o){let l=P.call(e,n[o]);if(i[t]===l){s=s.concat(n.splice(o,1));break}}e.setPropertyFromUIInteraction("value",s)})),n.addEventOnElement(this,this.elements._selChipsEdt,"selectionChange",(function(t){t.stopPropagation();let i,n=e.elements._selChipsEdt.getSelectedChipsValue(),s=e.value;if(n&&1===n.length){T.call(e);for(let t=0,o=s.length;t<o;++t){let o=P.call(e,s[t]);if(n[0]===o){i=s[t];break}}i&&L().then((()=>{e.elements.calendar.referenceDate=i,e._updatingTimePicker=!0,e.elements.timePicker&&(e.elements.timePicker.value=i),e._updatingTimePicker=!1}))}else n&&0===n.length&&B.call(e)}))}})})),define("DS/Controls/SpinBoxDecorator",["require","exports","DS/Controls/CustomizableDecorator","DS/Controls/CustomizableDecoratorItems","DS/Controls/DecoratorManager"],(function(e,t,i,n,s){"use strict";return function(){function e(){}return e.getId=function(){if(!e.decoratorID){e.decoratorID="defaultWebUXSpinBoxDecorator",n.addDecoratorItems({defaultWebUXSpinBoxDecoratorSwitchToViewOperators:{icon:{iconName:"math-more-less"},semantics:"primary"},defaultWebUXSpinBoxDecoratorSwitchToViewNumbers:{icon:{iconName:"numeric-keypad"},semantics:"primary"}});var t=new i({items:{viewNumbers:["1","2","3","arrowUp","4","5","6","arrowDown","7","8","9","delete","defaultWebUXSpinBoxDecoratorSwitchToViewOperators","0","decimal","validate"],viewOperators:["defaultWebUXSpinBoxDecoratorSwitchToViewNumbers","exponential","substraction","validate"]},viewSwitchingDefinition:{defaultWebUXSpinBoxDecoratorSwitchToViewOperators:"viewOperators",defaultWebUXSpinBoxDecoratorSwitchToViewNumbers:"viewNumbers"},gridDefinition:{viewNumbers:{numberOfColumns:4,numberOfLines:4},viewOperators:{numberOfColumns:4,numberOfLines:1}}});s.registerDecorator(e.decoratorID,t)}return e.decoratorID},e}()}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ResponsiveTileView",["require","exports","UWA/Core","DS/Controls/ResponsiveViewAdaptor","DS/Utilities/Dom","DS/CoreEvents/ModelEvents","DS/Core/WebUXComponents"],(function(e,t,i,n,s,o,l){"use strict";var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{tileWidth:{defaultValue:260,type:"integer",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this._modelEvents=new o,this._isHighlighted=!1,this.elements.container.addClassName("wux-controls-responsivetileview"),this.elements.container.setAttribute("has-picture","false"),this.elements.container.setAttribute("has-icon","false"),this.elements.container.setAttribute("has-statusbar-content","false"),this.elements.container.setAttribute("is-empty-statusbar-visible","false"),this.elements.container.setAttribute("active-mode","false"),this.elements.container.titleLineNumber=1,this.elements.container.descriptionLineNumber=2,this.elements.dndArea=i.createElement("div",{class:"wux-controls-responsivetileview-dndarea"}).inject(this.elements.container),this.elements.highlightBorder=new i.Element("div",{class:"wux-controls-highlightborder"}).inject(this.elements.container),this.elements.activediv=new i.Element("div",{class:"wux-controls-activediv"}).inject(this.elements.container),this.elements.color=new i.Element("div",{class:"wux-controls-responsivetileview-color"}).inject(this.elements.container),this.elements.color.setAttribute("has-color","false"),this.elements.picture=new i.Element("div",{class:"wux-controls-responsivetileview-picture"}).inject(this.elements.container),this.elements.checkbox=new i.Element("div",{class:"wux-controls-responsivetileview-checkbox"}).inject(this.elements.picture),this.elements.maincontent=new i.Element("div",{class:"wux-controls-responsivetileview-maincontent"}).inject(this.elements.container),this.elements.maincontent.setAttribute("has-menu","false"),this.elements.titlebar=new i.Element("div",{class:"wux-controls-responsivetileview-titlebar"}).inject(this.elements.maincontent),this.elements.icon=new i.Element("div",{class:"wux-controls-responsivetileview-icon"}).inject(this.elements.titlebar),this.elements.title=new i.Element("div",{class:"wux-controls-responsivetileview-title"}).inject(this.elements.titlebar),this.elements.title.contentView=this,s.addEventOnElement(this,this.elements.title,"click",this._onTitleClick),this.elements.title.setAttribute("has-menu","false"),this.elements.title.setAttribute("has-icon","false"),this.elements.subtitle=new i.Element("div",{class:"wux-controls-responsivetileview-subtitle"}).inject(this.elements.maincontent),this.elements.subtitle.setAttribute("has-subtitle","false"),this.elements.description=new i.Element("div",{class:"wux-controls-responsivetileview-description"}).inject(this.elements.maincontent),this.elements.description.setAttribute("has-description","false"),this.elements.propertiesList=new i.Element("div",{class:"wux-controls-responsivetileview-propertiesListContainer"}).inject(this.elements.maincontent),this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.propertiesListFirstContainer=new i.Element("div",{class:"wux-controls-responsivetileview-propertyChildContainer"}).inject(this.elements.propertiesList),this.elements.propertiesListFirstContainer.setAttribute("has-large-style","false"),this.elements.propertiesListSecondContainer=new i.Element("div",{class:"wux-controls-responsivetileview-propertyChildContainer"}).inject(this.elements.propertiesList),this.elements.propertiesListSecondContainer.setAttribute("has-large-style","false"),this.elements.menu=new i.Element("div",{class:"wux-controls-responsivetileview-menu"}).inject(this.elements.container),this.elements.menu.responsiveTileView=this,this.elements.menu.setAttribute("has-menu","false"),this.elements.statusbar=new i.Element("div",{class:"wux-controls-responsivetileview-statusbar"}).inject(this.elements.container),this.elements.statusbar.setAttribute("has-statusbar-content","false"),this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false"),this.elements.statusbaricons=[]},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("tileWidth")&&this._applyTileWidth(t.tileWidth)},t.prototype._applyTileWidth=function(e){this._applyViewWidth(e)},t.prototype._getViewMinWidth=function(){return 260},t.prototype._getViewMaxWidth=function(){if(!this.layoutingCollection||"wux-cell-responsivelargetile"!==this.layoutingCollection.cellStyleOverload)return 540},t.prototype._getViewWidth=function(){return this.tileWidth},t.prototype._onTileResize=function(e){this._onViewResize()},t.prototype._getViewCssClassSuffix=function(){return"responsivetileview"},t}(n);return l.addClass(a,"ResponsiveTileView"),a}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ResponsiveTextualTileView",["require","exports","UWA/Core","DS/Controls/ResponsiveTileView","DS/Utilities/Dom","DS/CoreEvents/ModelEvents","DS/Core/WebUXComponents"],(function(e,t,i,n,s,o,l){"use strict";var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.buildView=function(){this._modelEvents=new o,this._isHighlighted=!1,this.elements.container.addClassName("wux-controls-responsivetextualtileview"),this.elements.container.setAttribute("has-picture","false"),this.elements.container.setAttribute("has-icon","false"),this.elements.container.setAttribute("has-statusbar-content","false"),this.elements.container.setAttribute("is-empty-statusbar-visible","false"),this.elements.container.setAttribute("active-mode","false"),this.elements.container.titleLineNumber=1,this.elements.container.descriptionLineNumber=2,this.elements.highlightBorder=new i.Element("div",{class:"wux-controls-highlightborder"}).inject(this.elements.container),this.elements.activediv=new i.Element("div",{class:"wux-controls-activediv"}).inject(this.elements.container),this.elements.color=new i.Element("div",{class:"wux-controls-responsivetextualtileview-color"}).inject(this.elements.container),this.elements.color.setAttribute("has-color","false"),this.elements.picture=new i.Element("div",{class:"wux-controls-responsivetextualtileview-picture"}).inject(this.elements.container),this.elements.pictureplaceholder=new i.Element("div",{class:"wux-controls-responsivetextualtileview-pictureplaceholder",html:"PLACE YOUR PNG PICTURE HERE"}).inject(this.elements.picture),this.elements.checkbox=new i.Element("div",{class:"wux-controls-responsivetextualtileview-checkbox"}).inject(this.elements.picture),this.elements.titlebar=new i.Element("div",{class:"wux-controls-responsivetextualtileview-titlebar"}).inject(this.elements.container),this.elements.maincontent=new i.Element("div",{class:"wux-controls-responsivetextualtileview-maincontent"}).inject(this.elements.container),this.elements.maincontent.setAttribute("has-menu","false"),this.elements.icon=new i.Element("div",{class:"wux-controls-responsivetextualtileview-icon"}).inject(this.elements.titlebar),this.elements.title=new i.Element("div",{class:"wux-controls-responsivetextualtileview-title"}).inject(this.elements.titlebar),this.elements.title.contentView=this,s.addEventOnElement(this,this.elements.title,"click",this._onTitleClick),this.elements.title.setAttribute("has-menu","false"),this.elements.title.setAttribute("has-icon","false"),this.elements.subtitle=new i.Element("div",{class:"wux-controls-responsivetextualtileview-subtitle"}).inject(this.elements.maincontent),this.elements.subtitle.setAttribute("has-subtitle","false"),this.elements.description=new i.Element("div",{class:"wux-controls-responsivetextualtileview-description"}).inject(this.elements.maincontent),this.elements.description.setAttribute("has-description","false"),this.elements.propertiesList=new i.Element("div",{class:"wux-controls-responsivetextualtileview-propertiesListContainer"}).inject(this.elements.maincontent),this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.propertiesListFirstContainer=new i.Element("div",{class:"wux-controls-responsivetextualtileview-propertyChildContainer"}).inject(this.elements.propertiesList),this.elements.propertiesListFirstContainer.setAttribute("has-large-style","false"),this.elements.propertiesListSecondContainer=new i.Element("div",{class:"wux-controls-responsivetextualtileview-propertyChildContainer"}).inject(this.elements.propertiesList),this.elements.propertiesListSecondContainer.setAttribute("has-large-style","false"),this.elements.menu=new i.Element("div",{class:"wux-controls-responsivetextualtileview-menu"}).inject(this.elements.container),this.elements.menu.responsiveTileView=this,this.elements.menu.setAttribute("has-menu","false"),this.elements.statusbar=new i.Element("div",{class:"wux-controls-responsivetextualtileview-statusbar"}).inject(this.elements.container),this.elements.statusbar.setAttribute("has-statusbar-content","false"),this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false"),this.elements.statusbaricons=[]},t.prototype._applyMultipleTitleLineNumber=function(e){this.elements.container.titleLineNumber=1},t.prototype._getTitleLineHeight=function(){return 28},t.prototype._getDescriptionLineHeight=function(){return 19},t.prototype._getViewCssClassSuffix=function(){return"responsivetextualtileview"},t}(n);return l.addClass(a,"ResponsiveTextualTileView"),a}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/SpinBox",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Controls/SpinBoxDecorator","DS/Controls/CustomizableDecoratorItems","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Utilities/Dom","DS/Units/Units","DS/Controls/DecoratorManager","DS/Utilities/KeyboardUtils","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils","DS/Utilities/LanguageUtils"],(function(e,t,i,n,s,o,l,a,r,h,u,c,d,p,m){"use strict";var g,f,v,y=1,_=2;function b(e){return"undefined"!=typeof localStorage&&"true"===localStorage.getItem(e)}function C(){return void 0===f&&(f=b("WebUX_SB_ticksFeature")),f}function w(){return void 0===v&&(v=b("WebUX_SB_buttonsV2Feature")),v}var x=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return n.valueHasBeenModified=!1,n.editHasBegun=!1,n._valueOperation={operationType:void 0},p.extendingClassFlag||n.addKeyMapsAndCommands({return:"manageEnter",esc:{keydown:"manageEscape"},pageup:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},pagedown:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},up:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},down:{keydown:"manageArrowsKeyDown",keyup:"endEdit"},space:{keydown:"consume",keyup:"consume"},left:{keydown:"consume",keyup:"consume"},right:{keydown:"consume",keyup:"consume"},del:{keydown:"consume",keyup:"consume"},backspace:{keydown:"consume",keyup:"consume"},"ctrl+c":{keydown:"consume",keyup:"consume"},"ctrl+v":{keydown:"consume",keyup:"consume"},"ctrl+x":{keydown:"consume",keyup:"consume"},"ctrl+a":{keydown:"consume",keyup:"consume"},"ctrl+z":{keydown:"consume",keyup:"consume"},"shift+up":{keydown:"consume",keyup:"consume"},"shift+right":{keydown:"consume",keyup:"consume"},"shift+down":{keydown:"consume",keyup:"consume"},"shift+left":{keydown:"consume",keyup:"consume"},"ctrl+up":{keydown:"consume",keyup:"consume"},"ctrl+right":{keydown:"consume",keyup:"consume"},"ctrl+down":{keydown:"consume",keyup:"consume"},"ctrl+left":{keydown:"consume",keyup:"consume"},"ctrl+del":{keydown:"consume",keyup:"consume"},"ctrl+backspace":{keydown:"consume",keyup:"consume"},"ctrl+shift+right":{keydown:"consume",keyup:"consume"},"ctrl+shift+left":{keydown:"consume",keyup:"consume"},"shift+ctrl+right":{keydown:"consume",keyup:"consume"},"shift+ctrl+left":{keydown:"consume",keyup:"consume"},f1:{keydown:"doNotStopPropagation",keyup:"doNotStopPropagation"},home:{keydown:"consume",keyup:"consume"},end:{keydown:"consume",keyup:"consume"},defaultKey:{keydown:"forceEditMode",keyup:"consume"}},{consume:function(){return{stopPropagation:!0}},manageEnter:function(){if(this.elements.inputField){this.elements.inputField.focus();var e=!1;return u.isDecoratorDisplayed()?(u.hideDecorator(!0,!0),e=!0):e=this._validateValue(this.elements.inputField.value),this.lastValueWhenEnter=this.value,this._endEdit(),{stopPropagation:!1,infos:{actionPerformed:e}}}},forceEditMode:function(){M.call(this,!0)},doNotStopPropagation:function(){return{stopPropagation:!1}},manageEscape:function(){var e=!1;if(this.elements.inputField){if(!this.handleEditionCancel)return{stopPropagation:!1};this._managingEscape=!0,u.isDecoratorDisplayed()&&u.hideDecorator(!1,!0);var t=I.call(this,this.lastValueWhenEnter);this.elements.inputField.value!==t?(this.editIsCancelled=!0,this._validateValue(this.lastValueWhenEnter),this._cancelEdit(),e=!0):this.lastValueWhenEnter!==this.value&&(this._validateValue(this.lastValueWhenEnter),this._cancelEdit(),e=!0),O.call(this)&&N.call(this),this.editIsCancelled=!1,this._managingEscape=!1,this.selectAllOnFocus&&W(this.elements.inputField,!1)}return{stopPropagation:!1,infos:{actionPerformed:e}}},manageArrowsKeyDown:function(e){var t;return this.elements.inputField&&(void 0!==this.value&&null!==this.value||this.elements.inputField&&""!==this.elements.inputField.value||(this._beginEdit(),this._validateValue(0))),e.keyCode===c.ARROWUP?t=this.increment(!0):e.keyCode===c.ARROWDOWN?t=this.decrement(!0):e.keyCode===c.PAGEUP?t=this.pageIncrement(!0):e.keyCode===c.PAGEDOWN&&(t=this.pageDecrement(!0)),this.elements.inputField&&this.elements.inputField.isInjected()&&(this.elements.inputField.focus(),this.selectAllOnFocus&&W(this.elements.inputField,!0)),{stopPropagation:!0,preventDefault:!0,infos:{actionPerformed:t}}},endEdit:function(){this._endEdit()}}),n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:0,type:"number",category:"Behavior",advancedSetter:!0},units:{defaultValue:"",type:"string",category:"Behavior"},minValue:{defaultValue:void 0,type:"number",category:"Behavior"},maxValue:{defaultValue:void 0,type:"number",category:"Behavior"},stepValue:{defaultValue:.1,type:"number",category:"Behavior"},pageStepValue:{defaultValue:10,type:"number",category:"Behavior"},decimals:{defaultValue:5,type:"integer",category:"Behavior",advancedSetter:!0},highExponentProperty:{defaultValue:6,type:"integer",category:"Behavior"},lowExponentProperty:{defaultValue:6,type:"integer",category:"Behavior"},displayStyle:{defaultValue:"normal",type:"string",category:"Appearance"},useScientificNotationFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},displayCustomizer:{defaultValue:void 0,type:"function",category:"Behavior"},customFormatter:{defaultValue:void 0,type:"function",category:"Behavior"},customValidator:{defaultValue:void 0,type:"function",category:"Behavior"},typingFilter:{defaultValue:void 0,type:"boolean",category:"Behavior"},allowUndefinedFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},useLocaleDisplayOutsideEdition:{defaultValue:!1,type:"boolean",category:"Appearance"},handleEditionCancel:{defaultValue:!0,type:"boolean",category:"Behavior"},customDecoratorDefinition:{defaultValue:void 0,type:"object",category:"Behavior"},selectAllOnFocus:{defaultValue:!0,type:"boolean",category:"Behavior"},requiredFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},placeholder:{defaultValue:"",type:"string",category:"Appearance"},valueToCommit:{defaultValue:"",type:"string",category:"Behavior"},validFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},validState:{defaultValue:!0,type:"boolean",readOnly:!0,category:"Appearance"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-spinbox"),w()&&this.elements.container.addClassName("wux-buttons-v2"),this.elements.inputContainer=new i.Element("div",{class:"wux-input-container"}).inject(this.elements.container)},t.prototype.handleEvents=function(){var t=this;e.prototype.handleEvents.call(this),r.addEventOnElement(this,this.getContent(),l.POINTERUP,(function(e){t._selectAllOnFocusHasBeenDone&&(e.preventDefault(),t._selectAllOnFocusHasBeenDone=!1)})),r.addEventOnElement(this,this.elements.container,"mousewheel",(function(e){if(!t.disabled&&(t.elements.inputField===document.activeElement||t.elements.fakeInput===document.activeElement||t.getContent().hasAttribute("focused"))){var n=t.elements.inputField,s=t.selectAllOnFocus;e.preventDefault(),e.stopPropagation(),i.Event.wheelDelta(e)>0?t.increment(!0):t.decrement(!0),t._endEdit(),s&&W(n,!1)}})),this._createPointerUpOnDocumentFunction(),this._updateViewOnEventFun=function(){t._updateView()},m.subscribe("onRegionalFormatLanguageChange",this._updateViewOnEventFun)},t.prototype._onDecoratorClick=function(e,t){if(!t){var i=o.getItem(e),n=this.elements.inputField.selectionStart,s=this.elements.inputField.selectionEnd,l=this.elements.inputField.value.substring(n,s);if(i&&i.label){if("decimal"===e&&this.elements.inputField.value.indexOf(i.label)>-1&&-1===l.indexOf(i.label))return;var a=u.getDecorator();if(a&&a.viewSwitchingDefinition&&a.viewSwitchingDefinition[e])return;r=S(r=this.elements.inputField.value.substring(0,n)+i.label+this.elements.inputField.value.substring(s)),this.elements.inputField.value=r,this.valueToCommit=r,this.elements.inputField.selectionStart=this.elements.inputField.selectionEnd=n+i.label.length}else if("delete"===e){var r=void 0;r=this.elements.inputField.selectionEnd>this.elements.inputField.selectionStart?this.elements.inputField.value.substring(0,this.elements.inputField.selectionStart)+this.elements.inputField.value.substring(this.elements.inputField.selectionEnd+1):this.elements.inputField.value.substring(0,this.elements.inputField.value.length-1),this.elements.inputField.value=r,this.elements.inputField.selectionStart=this.elements.inputField.selectionEnd=n}else"validate"===e?u.hideDecorator(!0,!0):"arrowUp"===e?(this._validateValue(this.elements.inputField.value),this.increment()):"arrowDown"===e&&(this._validateValue(this.elements.inputField.value),this.decrement())}},t.prototype._onDecoratorShow=function(){this._blurThenFocusOnLineEditor=!0,document.activeElement&&document.activeElement.blur();var e=this.elements.inputField;e.setAttributeNode(document.createAttribute("readonly")),r.addEventOnElement(this,e,"keydown",(function(){e.removeAttribute("readonly")}),{once:!0}),e.focus(),e.select(),this._blurThenFocusOnLineEditor=!1},t.prototype._onDecoratorHide=function(e){var t=this.elements.inputField;if(t){var i=this,n=t.value;if(t.blur(),t.removeAttribute("readonly"),!e){var s=this.lastValueWhenEnter;this._blurThenFocusOnLineEditor=!0,t.blur(),this._preventUpdateOnNextFocus=!0,setTimeout((function(){t.focus(),t.value=n,i.lastValueWhenEnter=s,i._blurThenFocusOnLineEditor=!1}),10)}!0===e&&this._validateValue&&this._validateValue(n);var o=u.getDecorator();o&&o.resetActiveView&&u.getDecorator().resetActiveView()}},t.prototype._beginEdit=function(){this.editHasBegun||(this.editHasBegun=!0,this.fire("beginEdit"))},t.prototype._cancelEdit=function(){this.editHasBegun&&(this._updateView(),this.editHasBegun=!1,this.fire("cancelEdit"))},t.prototype._endEdit=function(){this.editHasBegun&&(this.editHasBegun=!1,this.fire("endEdit"))},t.prototype.destroy=function(){u.getWidget()===this&&u.hideDecorator(),m.unsubscribe("onRegionalFormatLanguageChange",this._updateViewOnEventFun),e.prototype.destroy.call(this)},t.prototype._modifyValue=function(e,t,i){var n,s,o;if(void 0!==this.value&&null!==this.value||""!==this.elements.inputField.value){var l=this.elements.inputField?this.elements.inputField.value:this.value.toString();if(this.customValidator)return this._callCustomValidator(l,e,i,this.value),!0;this.customFormatter&&isNaN(l)&&(null===(n=this.value)||void 0===n?void 0:n.toString)&&(l=this.value.toString());var r=a.getDecimalSeparator(m.regionalFormatLanguage);l=l.replace(r,"."),s=parseFloat(l)+e}else s=0;var h,u=this.decimals;h="number"==typeof u?a.round(s,Number(Math.pow(10,-1*u).toFixed(u))):s.toString();var c=this._getValidatedValue(h);return isNaN(c)&&(c=void 0),c!==this.value&&(t&&this._beginEdit(),o=this._validateValue(c)),o},t.prototype.increment=function(e){void 0===e&&(e=!1),j.call(this,this._valueOperation,{operationType:y},(function(){this._modifyValue(this.stepValue,e,this._valueOperation)}))},t.prototype.decrement=function(e){void 0===e&&(e=!1),j.call(this,this._valueOperation,{operationType:_},(function(){this._modifyValue(-this.stepValue,e,this._valueOperation)}))},t.prototype.pageIncrement=function(e){void 0===e&&(e=!1),this._modifyValue(this.pageStepValue,e)},t.prototype.pageDecrement=function(e){void 0===e&&(e=!1),this._modifyValue(-this.pageStepValue,e)},t.prototype.filteringCharOtherThanNumberEdition=function(e){var t=a.getDecimalSeparator(m.regionalFormatLanguage);return!(e.keyCode!==c.SPACE&&!isNaN(Number(e.key))||e.ctrlKey||c.isInteractiveKey(e.keyCode)&&(e.keyCode!==c.SPACE||"number"==typeof this.valueToCommit||this.valueToCommit.indexOf(" ")<0)||("."===e.key||","===e.key)&&e.key===t&&this.decimals&&("number"==typeof this.valueToCommit&&this.valueToCommit%1==0||"string"==typeof this.valueToCommit&&this.valueToCommit.indexOf(t)<0))},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),this.disabled?this.elements.inputField&&this.elements.inputField.setAttributeNode(document.createAttribute("disabled")):this.elements.inputField&&this.elements.inputField.removeAttribute("disabled"),this.disabled?(this.elements.inputField&&this.elements.inputField.setAttributeNode(document.createAttribute("disabled")),"normal"===this.displayStyle&&(this.elements.up&&this.elements.up.setAttributeNode(document.createAttribute("disabled")),this.elements.down&&this.elements.down.setAttributeNode(document.createAttribute("disabled")))):(this.elements.inputField&&this.elements.inputField.removeAttribute("disabled"),"normal"===this.displayStyle&&(this.elements.up&&this.elements.up.removeAttribute("disabled"),this.elements.down&&this.elements.down.removeAttribute("disabled")))},t.prototype._applyTouchMode=function(){e.prototype._applyTouchMode.call(this),this.elements.container&&(a.isOnIPhone()?this.elements.container.addClassName("wux-device-iphone"):this.elements.container.removeClassName("wux-device-iphone")),!0!==this._getCurrentTouchMode()||w()?"normal"===this.displayStyle&&(this._createSpinBoxButtons(),this.elements.buttonsDiv||(this.elements.buttonsDiv=new i.Element("div",{class:"wux-controls-lineeditor-buttonsDivRight",tabindex:-1}),w()&&H.call(this,this.elements.buttonsDiv)),this.elements.up&&this.elements.up.inject(this.elements.buttonsDiv),this.elements.down&&this.elements.down.inject(this.elements.buttonsDiv),this.elements.container&&this.elements.buttonsDiv.show().inject(this.elements.container)):(this.elements.down&&this.elements.container&&this.elements.down.inject(this.elements.container,"top"),this.elements.buttonsDiv&&this.elements.buttonsDiv.remove(),this.elements.up&&this.elements.container&&this.elements.up.inject(this.elements.container))},t.prototype._applyDisplayStyle=function(){"normal"===this.displayStyle?(this._createSpinBoxButtons(),this.elements.buttonsDiv&&this.elements.buttonsDiv.setStyle("border-width","0 0 0 1px")):(this._deleteSpinBoxButtons(),this.elements.buttonsDiv&&this.elements.buttonsDiv.setStyle("border-width","0")),this._applyTouchMode()},t.prototype._preEditDecimals=function(e,t){if("number"==typeof t){if(t>9)return{validValue:9};if(t<0)return{validValue:0}}else{if(null===t)return{validValue:void 0};if(void 0!==t)return{validValue:5}}return!0},t.prototype._applyDecimals=function(){this._updateView()},t.prototype._applyUnits=function(){this._updateView()},t.prototype._applyUseLocaleDisplayOutsideEdition=function(){this._updateView()},t.prototype._preEditValue=function(e,t){if(this.customValidator&&"string"==typeof t)return this._callCustomValidator(t,0,void 0,e),!1;if(void 0!==t&&isNaN(t)){this._cancelEdit();var i=R.call(this,e);return isNaN(i)&&(i=void 0),this.value=i,!1}var n=R.call(this,t);return n===t||(this.value=n,!1)},t.prototype._applyValue=function(e){this.valueHasBeenModified=!0,!this.allowUndefinedFlag||"Infinity"!==this.value&&this.value!==1/0?this.allowUndefinedFlag||"Infinity"!==this.value&&this.value!==1/0||(this.value=e):this.value=void 0,this._updateView(),this.valueHasBeenModified=!1,this.editIsCancelled||(this.lastValueWhenEnter=this.value,this.fire("change")),this._properties.valueToCommit.value=this.value},t.prototype._applyMinValue=function(e){if(this.minValue){var t=R.call(this,this.value);t!==this.value&&(this.value=t)}L.call(this)},t.prototype._applyMaxValue=function(e){if(this.maxValue){var t=R.call(this,this.value);t!==this.value&&(this.value=t)}L.call(this)},t.prototype._applyHighExponentProperty=function(e){this._updateView()},t.prototype._applyLowExponentProperty=function(e){this._updateView()},t.prototype._applyPlaceholder=function(){this.elements.inputField&&(this.placeholder?this.elements.inputField.setAttribute("placeholder",this.placeholder):!this.placeholder&&this.allowUndefinedFlag?this.elements.inputField.setAttribute("placeholder","- -"):this.elements.inputField.removeAttribute("placeholder"))},t.prototype._applyDisplayCustomizer=function(){window.console.warn('"displayCustomizer" property is deprecated. use "customFormatter" instead'),this.customFormatter=this.displayCustomizer},t.prototype._applyCustomFormatter=function(){this._updateView()},t.prototype._applyProperties=function(t){(this.isDirty("decimals")&&d._applyForAdvancedSetterProperty(this,"decimals",t.decimals,this.decimals,{onlyPreEdit:this.isDirty("value")}),this.isDirty("displayCustomizer")&&this.displayCustomizer&&this._applyDisplayCustomizer(),this.isDirty("customFormatter")&&!this.isDirty("value")&&this._applyCustomFormatter(),this.isDirty("minValue")&&this._applyMinValue(),this.isDirty("maxValue")&&this._applyMaxValue(),this.isDirty("placeholder")&&this._applyPlaceholder(),this.isDirty("value"))&&(this._preEditValue(t.value,this.value)&&this._applyValue(t.value));this.isDirty("requiredFlag")&&this._applyRequiredFlag(),this.isDirty("displayStyle")&&this._applyDisplayStyle(),k.call(this),e.prototype._applyProperties.call(this,t)},t.prototype._getElementToFocus=function(){return this.elements.inputField},t.prototype._onFocusReceived=function(){if(!this.disabled&&(e.prototype._onFocusReceived.call(this),!this._mouseDownOnFakeInput&&!this._mouseDownOnButton))if(document.activeElement===this.elements.fakeInput&&M.call(this,!1),this._isFocused()){if(this.selectAllOnFocus){var t=this.elements.inputField;t&&(0!==t.selectionStart||t.selectionEnd!==t.value.length)&&(this._selectAllOnFocusHasBeenDone=!0,W(this.elements.inputField,!1))}}else u.isDecoratorDisplayed()||T.call(this),this.selectAllOnFocus&&!u.isDecoratorDisplayed()&&W(this.elements.inputField,!1),this.fire("focus")},t.prototype._giveFocus=function(){if(!this.disabled&&(e.prototype._giveFocus.call(this),!this._mouseDownOnFakeInput&&!this._mouseDownOnButton))if(document.activeElement===this.elements.fakeInput&&M.call(this,!1),!this.elements.inputField||document.activeElement===this.elements.inputField||l.isLastEventTouch())if(this._isFocused()){if(this.selectAllOnFocus){var t=this.elements.inputField;t&&(0!==t.selectionStart||t.selectionEnd!==t.value.length)&&(this._selectAllOnFocusHasBeenDone=!0,W(this.elements.inputField,!1))}}else u.isDecoratorDisplayed()||T.call(this),this.selectAllOnFocus&&!u.isDecoratorDisplayed()&&W(this.elements.inputField,!1),this.fire("focus");else this.elements.inputField.focus({preventScroll:!0})},t.prototype.getInputText=function(){return this.elements.inputField?this.elements.inputField.value:this.elements.fakeInput?this.elements.fakeInput.content:this.value},t.prototype._callCustomValidator=function(e,t,i,n){var s=this,o=this.customValidator(e,t,i);if(o instanceof Promise){var l=this.elements.inputField,a=this.selectAllOnFocus&&l&&0===l.selectionStart&&l.selectionEnd===l.value.length;o.then((function(e){void 0!==e&&isNaN(e)&&(e=n+parseFloat(t)),a=a||s.selectAllOnFocus&&l&&0===l.selectionStart&&l.selectionEnd===l.value.length,e!==s.value?s.value=e:s._updateView(),a&&W(l,!0)}))}else void 0!==o&&isNaN(o)&&(o=n+parseFloat(t)),o!==s.value?s.value=o:s._updateView()},t.prototype._updateView=function(){this._updateValidState(),k.call(this),this.elements.container&&null!==this.elements.container.getAttributeNode("focused")?T.call(this):V.call(this)},t.prototype._validateValue=function(e){var t=!1;if((e=null!=e?e.toString():"",this.customFormatter)&&this.customFormatter(this.value)===e)return this._updateView(),this.value;if(this.customValidator)t=!0,this._callCustomValidator(e,0,void 0,this.value);else{var i=this._getValidatedValue(e);i!==this.value?(this.setPropertyFromUIInteraction("value",i),t=!0):this._updateView()}return t},t.prototype._createPointerUpOnDocumentFunction=function(){if(!this._pointerUpOnDocument){var e=this;this._pointerUpOnDocument=function(t){if(e.elements.container){e._mouseDownOnButton=!1,clearTimeout(e.timeoutPointerDown),e.timeoutPointerDown=void 0,clearInterval(e.intervalPointerDown),e.intervalPointerDown=void 0,B.call(e);var i=t.clientX,n=t.clientY;if(e.editHasBegun&&e.value!==e.lastValueWhenEnter&&e._validateValue(e.value),e._endEdit(),!r.isElementInside(t.target,e.elements.inputContainer)&&u.isDecoratorDisplayed()&&!a.isMouseOverElement(u.getWidget().getContent(),{x:i,y:n})&&!a.isMouseOverElement(u.getDecorator().elements.popup.getContent(),{x:i,y:n})){e._decoratorHasBeenDisplayedOnce=!1,u.hideDecorator(!0,!0);var s=r.getDocumentOwner.call(e,e);r.removeEventOnElement(e,s,l.POINTERUP,e._pointerUpOnDocument)}}}}},t.prototype._createSpinBoxButtons=function(){this.elements.up||this.elements.down?(this.elements.up&&this.elements.up.show(),this.elements.down&&this.elements.down.show()):(this._createPointerUpOnDocumentFunction(),this.elements.up=new i.Element("button",{class:"wux-up-button wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-expand-up",tabindex:-1,name:"Button",type:"button"}),this.elements.down=new i.Element("button",{class:"wux-down-button wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-expand-down",tabindex:-1,name:"Button",type:"button"}),w()||(H.call(this,this.elements.up,1),H.call(this,this.elements.down,-1)))},t.prototype._deleteSpinBoxButtons=function(){this.elements.up&&this.elements.up.hide(),this.elements.down&&this.elements.down.hide()},t.prototype._changeValueInExpForm=function(){if(this.useScientificNotationFlag)return!0;var e=this.value,t=Math.abs(e),i=this.highExponentProperty;if("number"==typeof i&&t>=Math.pow(10,i))return!0;var n=this.lowExponentProperty;if("number"==typeof n){var s=this.decimals;if(0!==e&&"number"==typeof s&&this.decimals<n&&t<Math.pow(10,-s)&&(n=Math.ceil(-Math.log(t)/Math.LN10)-1),0!==e&&t<Math.pow(10,-n))return!0}return!1},t.prototype._getValidatedValue=function(e){var t=this;if(!this.allowUndefinedFlag||""!==e&&"Infinity"!==e){if(!this.allowUndefinedFlag&&(""===e||"Infinity"===e))return this.value;var i,n=a.getDecimalSeparator(m.regionalFormatLanguage),s=e=e.replace(n,".");if(t.units){var o=/((?:-?\d*)\.?\d+([eE][-\+]?\d+)?)(\s*)?(.*)?/g.exec(e);if(!o||!o.length)return this.value;try{i=new h({unit:o[4]||t.units,value:parseFloat(o[1])});try{s=i.to(t.units).options.value}catch(e){s=i.options.value}}catch(e){s=parseFloat(o[1])}}else{var l=-1;t.elements.inputField&&(l=t.elements.inputField.value.indexOf("e")),s=l>=1?parseFloat(e.replace(",",".")):parseFloat(e)}return R.call(this,s)}},t.prototype._postBuildView=function(){O.call(this)?N.call(this):M.call(this)},t.prototype.commitCurrentEntry=function(){if(this.value!==this.valueToCommit)return this.value=this.valueToCommit,!0},t.prototype._applyRequiredFlag=function(){this.elements.inputField&&(!0===this.requiredFlag?this.elements.inputField.setAttributeNode(document.createAttribute("required")):this.elements.inputField.removeAttribute("required")),this._updateValidState()},t.prototype._applyValueToCommit=function(e){this.fire("uncommittedChange"),this._updateValidState()},t.prototype._applyValidFlag=function(){this._updateValidState()},t.prototype._updateValidState=function(){var e=this.requiredFlag&&void 0===this.value;e=e||!this.validFlag,this.elements.container&&(e?this.elements.container.setAttributeNode(document.createAttribute("invalid")):this.elements.container.removeAttribute("invalid")),e===this._properties.validState.value&&(this._properties.validState.value=!e,this.fire("validStateChange"))},t.prototype.getContent=function(){return e.prototype.getContent.call(this)},t.prototype.inject=function(t,i){return e.prototype.inject.call(this,t,i)},t}(n);function E(e){var t;if(!Number.isNaN(parseInt(e)))return(t=(e=parseFloat(e)).toExponential().split("e"))[0]=parseFloat(t[0]),t[1]=parseFloat(t[1]),t}function S(e){if(null!=e)return"0"===e.substring(0,1)&&e.length>1&&function(e){for(var t=["0","1","2","3","4","5","6","7","8","9"],i=0;i<t.length;i++)if(e===t[i])return!0;return!1}(e.substring(1,2))?S(e.substring(1,e.length)):e}function D(e){if(null!=e){if(e.match(/e/))return(e.match(/(\.|,).*0+e/)?e.replace(/0+e/,"e"):e).replace(/\.e|,e/,"e");if(e.match(/\.|,/)){var t=e;return e.match(/\./)&&(t=t.replace(/0+$/,"").replace(/\.$/,"")),e.match(/,/)&&(t=t.replace(/,$/,"")),t}return e}}function A(e){if(e)return Boolean(e.toString().match(/\./))}function F(e){if(e&&A(e))return String(e).match(/\.[0-9]+|\,[0-9]+/)[0].length-1-(String(e).match(/0+$|0+$/)?String(e).match(/0+$|0+$/)[0].length:0)}function P(e,t){return 10===e&&(e=1,t+=1),e+"e"+(t>=0?"+":"")+t}function I(e){var t=E(e),i="";if("number"==typeof this.decimals){var n=this.decimals;if(this._changeValueInExpForm()){i=D(P(this.useLocaleDisplayOutsideEdition?parseFloat(t[0].toFixed(n)).toLocaleString(m.regionalFormatLanguage,{maximumFractionDigits:n}):parseFloat(t[0].toFixed(n)),t[1]))}else this.useLocaleDisplayOutsideEdition?i=parseFloat(e).toLocaleString(m.regionalFormatLanguage,{maximumFractionDigits:n}):isNaN(e)||(i=parseFloat(parseFloat(e).toFixed(n)).toString())}else i=this._changeValueInExpForm()?this.useLocaleDisplayOutsideEdition?A(e)?D(P(t[0].toLocaleString(m.regionalFormatLanguage,{maximumFractionDigits:String(t[0]).match(/.[1-9]+|,[1-9]/)[0].length-1}),t[1])):D(t[0].toLocaleString(m.regionalFormatLanguage)+t[1]):D(P(t[0],t[1])):this.useLocaleDisplayOutsideEdition?A(e)?e.toLocaleString(m.regionalFormatLanguage,{maximumFractionDigits:F(e)}):e.toLocaleString(m.regionalFormatLanguage):e.toString();return this.units&&(i=i+" "+this.units),i}function V(){var e=this.value;if(this.customFormatter){var t=this.customFormatter(e);if("string"==typeof t)return this.elements.inputField&&(this.elements.inputField.value=t),void(this.elements.fakeInput&&(this.elements.fakeInput.textContent=t))}if(null==e)return this.elements.inputField&&(this.elements.inputField.value=""),void(this.elements.fakeInput&&(this.elements.fakeInput.textContent=""));var i=I.call(this,e);if(""===i&&(this.value=void 0),void 0!==i){var n=a.getDecimalSeparator(m.regionalFormatLanguage),s=i.toString().replace(".",n);this.elements.inputField&&(this.elements.inputField.value=s),this.elements.fakeInput&&(this.elements.fakeInput.textContent=s)}}function T(){if(this._preventUpdateOnNextFocus)this._preventUpdateOnNextFocus=!1;else{var e,t=this;if(void 0===t.value||null===t.value)return t.elements.inputField&&(t.elements.inputField.value=""),void(t.elements.fakeInput&&(t.elements.fakeInput.textContent=t.elements.inputField.value));if(t.customFormatter){var i=t.customFormatter.call(this,t.value);if("string"==typeof i)return t.elements.inputField&&(t.elements.inputField.value=i),void(t.elements.fakeInput&&(t.elements.fakeInput.textContent=i))}if(t.useScientificNotationFlag){var n=E(t.value);e=D(P("number"!=typeof t.decimals?n[0]:parseFloat(n[0].toFixed(t.decimals)),n[1]))}else"number"==typeof t.decimals?isNaN(t.value)?t.value=void 0:e=parseFloat(parseFloat(t.value).toFixed(t.decimals)):e=t.value;if(t.units&&(e=e+" "+t.units),void 0!==e){var s=a.getDecimalSeparator(m.regionalFormatLanguage),o=e.toString().replace(".",s);t.elements.inputField&&e!==t.elements.inputField.value&&(t.elements.inputField.value=o),t.elements.fakeInput&&(t.elements.fakeInput.textContent=o)}}}function B(e){void 0===e?(this.elements.up&&this.elements.up.removeAttribute("activated"),this.elements.down&&this.elements.down.removeAttribute("activated")):"up"===e?(this.elements.up&&this.elements.up.setAttributeNode(document.createAttribute("activated")),this.elements.down&&this.elements.down.removeAttribute("activated")):(this.elements.down&&this.elements.down.setAttributeNode(document.createAttribute("activated")),this.elements.up&&this.elements.up.removeAttribute("activated"))}function O(){return void 0===g&&(g=b("WebUX_SB_slidingFeature")),g?!1===this.selectAllOnFocus?0:1:0}function M(e){if(this.elements.fakeInput&&this.elements.fakeInput.isInjected()&&(this.elements.fakeInput.remove(),this.elements.sliderFeedback&&this.elements.sliderFeedback.remove(),this.elements.tickContainer&&this.elements.tickContainer.remove()),!this.elements.inputField){this.elements.inputField=new i.Element("input",{class:"wux-spinbox-input wux-controls-lineeditor",type:"text",tabindex:0,name:"LineEditor",autocomplete:"off"}),this._myInput=this.elements.inputField,this._applyPlaceholder(),this._updateView(),this._applyDisabled();var t=this;r.addEventOnElement(this,this.elements.inputField,"keydown",(function(e){t.typingFilter&&!t.units&&("function"==typeof t.typingFilter&&t.typingFilter(e.keyCode)||t.filteringCharOtherThanNumberEdition(e))&&e.preventDefault()})),r.addEventOnElement(this,this.elements.inputField,"change",(function(e){e.stopPropagation()})),r.addEventOnElement(this,this.elements.inputField,"blur",(function(e){t._mouseDownOnButton||t._managingEscape||(!t._blurThenFocusOnLineEditor&&t._decoratorHasBeenDisplayedOnce&&(t._decoratorHasBeenDisplayedOnce=!1),t.disabled||u.isDecoratorDisplayed()||(!t.editHasBegun||t.customFormatter&&t.customValidator||!(this.value!==t.lastValueWhenEnter||""===this.value&&void 0!==t.lastValueWhenEnter&&t.allowUndefinedFlag)?t.customFormatter&&t.customValidator?t._callCustomValidator(this.value,0,void 0,t.value):t._updateView():t._validateValue(this.value),t._endEdit()),O.call(t)&&N.call(t))})),r.addEventOnElement(this,this.elements.inputField,l.POINTERMOVE,(function(e){l.isTouchEvent(e)&&e.preventDefault()})),r.addEventOnElement(this,this.elements.inputField,"focus",(function(e){e.preventDefault()})),r.addEventOnElement(this,this.elements.inputField,l.POINTERDOWN,(function(e){if(t._selectAllOnFocusHasBeenDone=!1,!l.isTouchEvent(e)||u.getWidget()===t&&t._decoratorHasBeenDisplayedOnce){if(u.isDecoratorDisplayed()){u.hideDecorator(!1,!0);n=r.getDocumentOwner.call(t,t);r.removeEventOnElement(t,n,l.POINTERUP,t._pointerUpOnDocument)}}else{e.preventDefault(),t._decoratorHasBeenDisplayedOnce=!0;var i=t.customDecoratorDefinition&&t.customDecoratorDefinition.decoratorID?t.customDecoratorDefinition.decoratorID:s.getId();u.showDecorator(t,this,i);var n=r.getDocumentOwner.call(t,t);r.addEventOnElement(t,n,l.POINTERUP,t._pointerUpOnDocument)}})),r.addEventOnElement(this,this.elements.inputField,"input",(function(e){e.stopPropagation(),t._beginEdit(),t.setPropertyFromUIInteraction("valueToCommit",t.elements.inputField.value)})),this.elements.inputField&&this.elements.inputContainer&&this.elements.inputField.inject(this.elements.inputContainer)}!this.elements.inputField.isInjected()&&this.elements.inputContainer&&this.elements.inputField.inject(this.elements.inputContainer),e&&this.elements.inputField.focus()}function N(){this._lockDisplayFakeInput||(this._lockDisplayFakeInput=!0,this.elements.fakeInput||(this.elements.fakeInput=new i.Element("span",{class:"wux-spinbox-input",tabindex:"0"}),this._applyPlaceholder(),this._updateView(),U.call(this)),this.elements.sliderFeedback&&this.elements.sliderFeedback.inject(this.elements.inputContainer),this.elements.fakeInput.inject(this.elements.inputContainer),this.elements.tickContainer&&this.elements.tickContainer.inject(this.elements.inputContainer),this.elements.inputField&&this.elements.inputField.isInjected()&&this.elements.inputField.remove(),this._lockDisplayFakeInput=!1)}function L(){if(C())if(this.selectAllOnFocus){if(!this.elements.tickContainer){this.elements.tickContainer=new i.Element("div",{class:"ticksContainer",content:"<ol><li></li> <li></li> <li></li> <li></li></ol>"})}this.elements.tickContainer.inject(this.elements.inputContainer,"top")}else this.elements.tickContainer&&this.elements.tickContainer.remove();O.call(this)&&void 0!==this.minValue&&void 0!==this.maxValue?this.elements.sliderFeedback?this.elements.sliderFeedback.show():this.elements.sliderFeedback=new i.Element("div",{class:"sliderFeedback"}).inject(this.elements.inputContainer,"top"):this.elements.sliderFeedback&&this.elements.sliderFeedback.hide()}function k(){if(void 0!==this.minValue&&void 0!==this.maxValue&&this.elements.sliderFeedback&&this.maxValue-this.minValue>0&&this.elements.sliderFeedback.setStyle("width",this.value/(this.maxValue-this.minValue)*100+"%"),C()&&this.elements.tickContainer&&this.stepValue){var e=this.elements.inputContainer.clientWidth,t=Math.round(e/4);if(void 0!==this.minValue&&void 0!==this.maxValue)this.elements.tickContainer.setStyle("margin-left","25%");else{var i=void 0;i=this.value<0?(t-Math.round(this.value/this.stepValue))%t:this.value>0?t-Math.round(this.value/this.stepValue)%t:"25%",this.elements.tickContainer.setStyle("margin-left",i)}}}function U(){var e,t,i,n,s=this,o=0,h=0,u=0,c=0,d=!1;function p(l){s.disabled||l.preventDefault(),void 0!==s.minValue&&void 0!==s.maxValue?function(i){if(t=i.clientX,n||Math.abs(t-o)>3&&(n=!0),n){var l=void 0;e=i.clientX-u,0!==h&&s.maxValue!==s.minValue&&(e>h&&(e=h),e<0&&(e=0),void 0!==s.value&&null!==s.value||s.elements.inputField&&""!==s.elements.inputField.value||(s._beginEdit(),s._validateValue(0)),(l=e/h*(s.maxValue-s.minValue)+s.minValue)!==s.value&&(d=!0),o=i.clientX,c=a.clamp(0,h,Math.round(e))),void 0!==l&&(s.stepValue&&(l=s.stepValue*Math.round(l/s.stepValue)),l=a.clamp(s.minValue,s.maxValue,l),s.value=l)}}(l):function(e){t=e.clientX,n||Math.abs(t-o)>3&&(n=!0),n&&(r.pushUserInteractionContext(),void 0!==s.value&&null!==s.value||s.elements.inputField&&""!==s.elements.inputField.value||(s._beginEdit(),s._validateValue(0)),Math.round(t-i)<0?s.decrement(!0):s.increment(!0),i=t,d=!0,r.popUserInteractionContext())}(l)}function m(e){s._mouseDownOnFakeInput=!1,d||M.call(s,!0),clearTimeout(s.timeoutPointerDown),s.timeoutPointerDown=void 0,clearInterval(s.intervalPointerDown),s.intervalPointerDown=void 0,B.call(s);var t=r.getDocumentOwner(s.getContent());r.removeEventOnElement(s,t,l.POINTERMOVE,p),r.removeEventOnElement(s,t,l.POINTERUP,m),s.disabled||(e.preventDefault(),e.stopPropagation(),s._inEdition&&(s._inEdition=!1,s.fire("endEdit")))}r.addEventOnElement(this,this.elements.fakeInput,l.POINTERDOWN,(function(e){if(s._mouseDownOnFakeInput=!0,e.stopPropagation(),!s.disabled){n=!1,d=!1;var t=r.getDocumentOwner(s.getContent());r.addEventOnElement(s,t,l.POINTERMOVE,p),r.addEventOnElement(s,t,l.POINTERUP,m),h=s.elements.inputContainer.clientWidth,u=e.clientX-e.offsetX,o=e.clientX,i=e.clientX;var g=e.offsetX;s.fire("beginEdit",{pointerDown:!0}),s._inEdition=!0,0!==h&&s.maxValue!==s.minValue&&(c=Math.round(g),c=a.clamp(0,h,c))}}))}function H(e,t){var i,n=this;r.addEventOnElement(this,e,l.POINTERDOWN,(function(s){if(s.stopPropagation(),s.preventDefault(),!n.disabled){n._mouseDownOnButton=!0,i={x:s.clientX,y:s.clientY},r.addEventOnElement(this,window,l.POINTERMOVE,(function(e){i={x:e.clientX,y:e.clientY}}),!0);var o=e.getBoundingClientRect(),a=o.bottom-o.top,h=function(){if(1===t)n.increment(!0);else if(-1===t)n.decrement(!0);else{var e=i.y>o.top+a/2?-1:1;e<0?n.decrement(!0):n.increment(!0),W(n.elements.inputField,!0),B.call(n,-1===e?"down":"up")}},u=n.selectAllOnFocus&&!l.isTouchEvent(s);if(n.timeoutPointerDown=setTimeout((function(){n.intervalPointerDown=setInterval((function(){r.pushUserInteractionContext(),h(),u&&W(n.elements.inputField,!0),r.popUserInteractionContext()}),100)}),200),l.isTouchEvent(s)?n.getContent().setAttributeNode(document.createAttribute("focused")):n.elements.fakeInput&&n.elements.fakeInput.isInjected()?n.elements.fakeInput.focus():n.elements.inputField&&n.elements.inputField.isInjected()&&n.elements.inputField.focus(),void 0!==n.value&&null!==n.value||n.elements.inputField&&""!==n.elements.inputField.value||(n._beginEdit(),n._validateValue(0)),n.customFormatter){var c=n.customFormatter(n.value);n.elements.inputField&&n.elements.inputField.value!==c&&n._validateValue(n.value)}else n.elements.inputField&&parseFloat(n.elements.inputField.value)!==n.value&&n._validateValue(n.elements.inputField.value);h(),u&&W(n.elements.inputField,!0);var d=r.getDocumentOwner(n.getContent());r.addEventOnElement(n,d,l.POINTERUP,n._pointerUpOnDocument)}})),r.addEventOnElement(n,e,l.POINTERUP,(function(e){e.preventDefault(),n._mouseDownOnButton=!1,n.intervalPointerDown&&n.timeoutPointerDown&&e.stopPropagation(),clearTimeout(n.timeoutPointerDown),n.timeoutPointerDown=void 0,clearInterval(n.intervalPointerDown),n.intervalPointerDown=void 0,n._endEdit(),B.call(n);var t=r.getDocumentOwner(n.getContent());r.removeEventOnElement(n,t,l.POINTERUP,n._pointerUpOnDocument)}))}function R(e){return void 0!==this.maxValue&&null!==this.maxValue&&e>this.maxValue&&(e=this.maxValue),void 0!==this.minValue&&null!==this.minValue&&e<this.minValue&&(e=this.minValue),e}function W(e,t){e&&(t&&e.selectionStart!==e.selectionEnd||(e.setSelectionRange(0,0),e.select()))}function j(e,t,i){!0===e.hasOwnProperty("operationType")&&(this._valueOperation.operationType=t.operationType),i.call(this),e.operationType&&(this._valueOperation.operationType=void 0)}return d.addClass(x,"spinBox"),x}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ColorEditors",["require","exports","DS/Controls/Abstract","UWA/Core","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/Utilities/Color","DS/Controls/GradientSlider","DS/Controls/SpinBox","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/Toggle","DS/Utilities/WUXUWAUtils"],(function(e,t,i,n,s,o,l,a,r,h,u,c,d){"use strict";var p=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return d.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:"ff0000",type:"string"},hsvValue:{defaultValue:void 0,type:"array"},availableColorFormats:{defaultValue:void 0,type:"array"},displayStyle:{defaultValue:"tabs",type:"string"},useColorSlidersFlag:{defaultValue:!0,type:"boolean"},showAlphaFlag:{defaultValue:!1,type:"boolean"}}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t),this.hsvValue=l.hexToHsv(this.value),this.availableColorFormats=["RGB","HSV","HSL","RGBA","HSVA","HSLA"],this._currentSubAttribute="Hue"},t.prototype._postBuildView=function(){this.elements.container.addClassName("wux-controls-color-editors"),this._editors={},"tabs"===this.displayStyle&&this.buildTabView(),e.prototype._postBuildView.call(this),"tabs"===this.displayStyle?this._setCurrentColorFormat(this.availableColorFormats[this.showAlphaFlag?3:0]):this._buildStackedLayout(),this._applyDisabled()},t.prototype._refreshEditors=function(){if(this._refreshingEditorsFlag=!0,void 0===this.hsvValue)for(var e=0;e<this._editors.spinBox.length;e++)this._editors.spinBox[e].value=void 0,this._editors.slider&&(this._editors.slider[e].value=void 0,this._editors.slider[e].modulationColor=void 0);else if(void 0===this._editors||void 0===this._editors.spinBox||0===this._editors.spinBox.length);else{if(this._editors.slider)for(e=0;e<this._editors.slider.length;e++)this._editors.slider[e].modulationColor=this.hsvValue;var t=void 0;if("tabs"===this.displayStyle)switch(this._currentColorFormat){case"RGB":t=[(n=l.hsvToRgb(this.hsvValue)).r,n.g,n.b];break;case"RGBA":t=[(s=l.hsvToRgb(this.hsvValue)).r,s.g,s.b,s.a];break;case"HSV":case"HSVA":t=this.hsvValue;break;case"HSL":case"HSLA":t=l.hsvToHsl(this.hsvValue)}else{t=[];for(var i=0;i<this.availableColorFormats.length;i++)switch(this.availableColorFormats[i]){case"RGB":var n=l.hsvToRgb(this.hsvValue);t=t.concat([n.r,n.g,n.b]);break;case"RGBA":var s=l.hsvToRgb(this.hsvValue);t=t.concat([s.r,s.g,s.b,s.a]);break;case"HSV":t=t.concat([this.hsvValue[0],this.hsvValue[1],this.hsvValue[2]]);break;case"HSVA":t=t.concat([this.hsvValue[0],this.hsvValue[1],this.hsvValue[2],this.hsvValue[3]]);break;case"HSL":var o=l.hsvToHsl(this.hsvValue);t=t.concat([o[0],o[1],o[2]]);break;case"HSLA":var a=l.hsvToHsl(this.hsvValue);t=t.concat([a[0],a[1],a[2],a[3]])}t=t.concat(this.hsvValue[3])}if(t)for(e=0;e<this._editors.spinBox.length;e++){var r=void 0;r=1!==e||"HSL"!==this._currentColorFormat&&"HSLA"!==this._currentColorFormat||void 0===this._hslSaturationBackup?Math.round(t[e]):this._editors.slider[e].value=this._hslSaturationBackup,this._editors.slider&&this._editors.slider[e]&&(this._editors.slider[e].value=r),this._editors.spinBox[e].value=r}}this._refreshingEditorsFlag=!1},t.prototype._applyValue=function(){this._applyingValue=!0,this._applyingHsvValue||(this.hsvValue=l.hexToHsv(this.value),this._refreshEditors()),this._applyingValue=!1},t.prototype._applyHsvValue=function(){this._applyingHsvValue=!0,this._applyingValue||(this.value=l.hsvToHex(this.hsvValue),this._refreshEditors()),this._applyingHsvValue=!1},t.prototype._buildStackedLayout=function(){var e=0,t=[],i=[],s=[],o=[],h=l.hsvToRgb(this.hsvValue),u=void 0;void 0!==h&&(u=[h.r,h.g,h.b],void 0!==h.a&&(u[3]=h.a));for(var d=l.hsvToHsl(this.hsvValue),p=0;p<this.availableColorFormats.length;p++)switch(this.availableColorFormats[p]){case"RGB":e+=3,t.push("R","G","B"),i.push("Red","Green","Blue"),s.push(255,255,255),o=o.concat(u);break;case"RGBA":e+=4,t.push("R","G","B","A"),i.push("Red","Green","Blue","Alpha"),s.push(255,255,255,255),o=o.concat(u);break;case"HSV":e+=3,t.push("H","S","V"),i.push("Hue","Saturation","Value"),s.push(360,100,100),o=o.concat(this.hsvValue);break;case"HSVA":e+=4,t.push("H","S","V","A"),i.push("Hue","Saturation","Value","Alpha"),s.push(360,100,100,255),o=o.concat(this.hsvValue);break;case"HSL":e+=3,t.push("H","S","L"),i.push("Hue","HslSaturation","Lightness"),s.push(360,100,100),o=o.concat(d);break;case"HSLA":e+=4,t.push("H","S","L","A"),i.push("Hue","HslSaturation","Lightness","Alpha"),s.push(360,100,100,255),o=o.concat(d)}if(this.showAlphaFlag&&(e++,t.push("A"),i.push("Alpha"),s.push(255),o.push(255)),this._editors.editorContainer)for(var m=0;m<this._editors.editorContainer.length;m++)this._editors.editorContainer[m].remove().destroy(),this._editors.radio[m].remove().destroy(),this._editors.label[m].remove().destroy(),this._editors.slider&&this._editors.slider[m].remove().destroy(),this._editors.spinBox[m].remove().destroy();this._editors.editorContainer=new Array(e),this._editors.radio=new Array(e),this._editors.label=new Array(e),this.useColorSlidersFlag?this._editors.slider=new Array(e):this._editors.slider=void 0,this._editors.spinBox=new Array(e);for(m=0;m<e;m++)this._editors.editorContainer[m]=new n.Element("div",{class:"wux-color-container"}).inject(this.elements.container),this._editors.radio[m]=new c({type:"radio",fireOnlyFromUIInteractionFlag:!0}).inject(this._editors.editorContainer[m]),this._editors.label[m]=new n.Element("div",{class:"wux-color-editor-label",text:t[m]}).inject(this._editors.editorContainer[m]),this._editors.slider&&(this._editors.slider[m]=new a({value:o?o[m]:void 0,gradientType:i[m],modulationColor:this.hsvValue,valuePopupFlag:!1,fireOnlyFromUIInteractionFlag:!0}).inject(this._editors.editorContainer[m])),this._editors.spinBox[m]=new r({value:o?Math.round(o[m]):void 0,stepValue:1,maxValue:s[m],minValue:0,fireOnlyFromUIInteractionFlag:!0,displayStyle:"lite",selectAllOnFocus:!0}).inject(this._editors.editorContainer[m]);this.showAlphaFlag&&this._editors.radio[this._editors.radio.length-1].getContent().setStyle("visibility","hidden"),this._refreshRadioButtons()},t.prototype._setCurrentColorFormat=function(e){if("stacked"!==this.displayStyle){var t,i,s,o,h;this._currentColorFormat=e,this._editors.buttonGroup.value=[e];var u=l.hsvToRgb(this.hsvValue),d=void 0;void 0!==u&&(d=[u.r,u.g,u.b],u.a&&(d[3]=u.a));var p=l.hsvToHsl(this.hsvValue);switch(this._currentColorFormat){case"RGB":t=3,i=["R","G","B"],s=["Red","Green","Blue"],o=[255,255,255],h=d;break;case"RGBA":t=4,i=["R","G","B","A"],s=["Red","Green","Blue","Alpha"],o=[255,255,255,255],h=d;break;case"HSV":t=3,i=["H","S","V"],s=["Hue","Saturation","Value"],o=[360,100,100],h=this.hsvValue;break;case"HSVA":t=4,i=["H","S","V","A"],s=["Hue","Saturation","Value","Alpha"],o=[360,100,100,255],h=this.hsvValue;break;case"HSL":t=3,i=["H","S","L"],s=["Hue","HslSaturation","Lightness"],o=[360,100,100],h=p;break;case"HSLA":t=4,i=["H","S","L","A"],s=["Hue","HslSaturation","Lightness","Alpha"],o=[360,100,100,255],h=p}if(this._editors.editorContainer)for(var m=0;m<this._editors.editorContainer.length;m++)this._editors.editorContainer[m].remove().destroy(),this._editors.radio[m].remove().destroy(),this._editors.label[m].remove().destroy(),this._editors.slider&&this._editors.slider[m].remove().destroy(),this._editors.spinBox[m].remove().destroy();this._editors.editorContainer=new Array(t),this._editors.radio=new Array(t),this._editors.label=new Array(t),this.useColorSlidersFlag?this._editors.slider=new Array(t):this._editors.slider=void 0,this._editors.spinBox=new Array(t);for(m=0;m<t;m++)this._editors.editorContainer[m]=new n.Element("div",{class:"wux-color-container"}).inject(this.elements.container),this._editors.radio[m]=new c({type:"radio",fireOnlyFromUIInteractionFlag:!0}).inject(this._editors.editorContainer[m]),this._editors.label[m]=new n.Element("div",{class:"wux-color-editor-label",text:i[m]}).inject(this._editors.editorContainer[m]),this._editors.slider&&(this._editors.slider[m]=new a({value:h?h[m]:void 0,gradientType:s[m],modulationColor:this.hsvValue,valuePopupFlag:!1,fireOnlyFromUIInteractionFlag:!0,maxValue:o[m]}).inject(this._editors.editorContainer[m])),this._editors.spinBox[m]=new r({value:h?Math.round(h[m]):void 0,stepValue:1,maxValue:o[m],minValue:0,fireOnlyFromUIInteractionFlag:!0,displayStyle:"lite",selectAllOnFocus:!0}).inject(this._editors.editorContainer[m]);this.showAlphaFlag&&this._editors.radio[this._editors.radio.length-1].getContent().setStyle("visibility","hidden"),this._refreshRadioButtons()}},t.prototype.setColorSubAttribute=function(e,t){void 0===this.hsvValue&&(this.hsvValue=[0,1,1,this.showAlphaFlag?255:void 0]);var i=l.hsvToRgb(this.hsvValue),n=l.hsvToHsl(this.hsvValue);switch(e){case"Hue":this.hsvValue=[t,this.hsvValue[1],this.hsvValue[2],this.hsvValue[3]];break;case"HslSaturation":this._hslSaturationBackup=t,this.hsvValue=l.hslToHsv([n[0],t,n[2],n[3]]);break;case"Saturation":this.hsvValue=[this.hsvValue[0],t,this.hsvValue[2],this.hsvValue[3]];break;case"Value":this.hsvValue=[this.hsvValue[0],this.hsvValue[1],t,this.hsvValue[3]];break;case"Lightness":var s=this._hslSaturationBackup?this._hslSaturationBackup:n[1];this.hsvValue=l.hslToHsv([n[0],s,t,n[3]]);break;case"Red":this.hsvValue=l.rgbToHsv(t,i.g,i.b,i.a);break;case"Green":this.hsvValue=l.rgbToHsv(i.r,t,i.b,i.a);break;case"Blue":this.hsvValue=l.rgbToHsv(i.r,i.g,t,i.a);break;case"Alpha":this.hsvValue=l.rgbToHsv(i.r,i.g,i.b,t)}},t.prototype.buildTabView=function(){this._editors.buttonGroupDiv=new n.Element("div",{class:"wux-buttongroup-div"}).inject(this.elements.container),this._editors.buttonGroup=(new h).inject(this._editors.buttonGroupDiv);var e=this.showAlphaFlag?"A":"";this._editors.buttonGroup.addChild(new u({type:"radio",label:"RGB"+e,value:"RGB"+e})),this._editors.buttonGroup.addChild(new u({type:"radio",label:"HSV"+e,value:"HSV"+e})),this._editors.buttonGroup.addChild(new u({type:"radio",label:"HSL"+e,value:"HSL"+e})),this._editors.buttonGroup.value=this._currentColorFormat},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this);var t=this.disabled;if(this._editors&&(this._editors.buttonGroup&&(this._editors.buttonGroup.disabled=t),this._editors.radio))for(var i=0;i<this._editors.radio.length;i++)this._editors.radio[i].disabled=t,this._editors.slider&&(this._editors.slider[i].disabled=t),this._editors.spinBox[i].disabled=t},t.prototype.buildView=function(){},t.prototype._refreshRadioButtons=function(){for(var e=0;e<this._editors.radio.length;e++)this._editors.radio[e].checkFlag=!1;for(var t=this._buildSubColorAttributeTypeArray(),i=0;i<this._editors.radio.length;i++)t[i]===this._currentSubAttribute&&(this._editors.radio[i].checkFlag=!0)},t.prototype._buildSubColorAttributeTypeArray=function(){var e;if("tabs"===this.displayStyle)switch(this._currentColorFormat){case"RGB":e=["Red","Green","Blue"];break;case"RGBA":e=["Red","Green","Blue","Alpha"];break;case"HSV":e=["Hue","Saturation","Value"];break;case"HSVA":e=["Hue","Saturation","Value","Alpha"];break;case"HSL":e=["Hue","HslSaturation","Lightness"];break;case"HSLA":e=["Hue","HslSaturation","Lightness","Alpha"]}else{e=[];for(var t=0;t<this.availableColorFormats.length;t++)switch(this.availableColorFormats[t]){case"RGB":e.push("Red","Green","Blue");break;case"HSV":e.push("Hue","Saturation","Value");break;case"HSL":e.push("Hue","HslSaturation","Lightness")}this.showAlphaFlag&&e.push("Alpha")}return e},t.prototype._handleEvents=function(){var e=this;s.addEventOnElement(this,this.elements.container,"beginEdit",(function(t){t.dsModel!==e&&(t.stopPropagation(),e.fire("beginEdit"))})),s.addEventOnElement(this,this.elements.container,"endEdit",(function(t){t.dsModel!==e&&(t.stopPropagation(),e.fire("endEdit"))})),s.addEventOnElement(this,this.elements.container,"cancelEdit",(function(t){t.dsModel!==e&&(t.stopPropagation(),e.fire("cancelEdit"))})),s.addEventOnElement(this,this.elements.container,"change",(function(t){if(t.dsModel!==e&&(t.stopPropagation(),!e._refreshingEditorsFlag))if(t.dsModel===e._editors.buttonGroup)e._setCurrentColorFormat(e._editors.buttonGroup.value[0]);else{if(!t.dsModel)return;for(var i=e._buildSubColorAttributeTypeArray(),n=void 0,s=0;s<i.length;s++){switch(t.dsModel){case e._editors.radio[s]:return e._currentSubAttribute=i[s],"Alpha"!==e._currentSubAttribute&&e._refreshRadioButtons(),void e.fire("changeModulation",{colorSubAttributeType:i[s],currentColorFormat:e._currentColorFormat});case e._editors.slider&&e._editors.slider[s]:"Lightness"===i[s]&&(e._hslSaturationBackup=e._editors.slider[1].value),e.setColorSubAttribute(i[s],t.dsModel.value),e._editors.spinBox[s].value=Math.round(t.dsModel.value),n=s;break;case e._editors.spinBox[s]:e.setColorSubAttribute(i[s],t.dsModel.value),e._editors.slider&&(e._editors.slider[s].value=t.dsModel.value),n=s}if(n)break}e.fire("change",{colorSubAttributeType:i[n],currentColorFormat:e._currentColorFormat})}}))},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("value")&&this._applyValue(),this.isDirty("hsvValue")&&this._applyHsvValue()},t}(i);return o.addClass(p,"ColorEditors"),p}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ColorChooser",["require","exports","DS/Controls/Abstract","UWA/Core","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/Utilities/Color","DS/Controls/LineEditor","DS/Controls/GradientSlider","DS/Controls/ColorCanvas","DS/Utilities/KeyboardUtils","DS/Controls/ColorEditors"],(function(e,t,i,n,s,o,l,a,r,h,u,c,d){"use strict";var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:"ffffff",type:"string",advancedSetter:!0},hsvValue:{defaultValue:void 0,type:"array"},referenceValue:{defaultValue:"ffffff",type:"string"},informationsVisibleFlag:{defaultValue:!0,type:"boolean"},handleEditionCancel:{defaultValue:!0,type:"boolean",category:"Behavior",noNeedToApplyFlag:!0},displayStyle:{defaultValue:"basic",type:"string"},showAlphaFlag:{defaultValue:!1,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t),this.hsvValue=a.hexToHsv(this.value)},t.prototype.buildView=function(){},t.prototype.buildColorChooserView=function(){var e=this;this.elements.container.addClassName("wux-controls-colorchooser"),"advanced"===e.displayStyle?this.elements.container.addClassName("wux-advanced"):this.elements.container.removeClassName("wux-advanced");var t="wux-controls-colorchooser-";this.elements.canvasContainer&&this.elements.canvasContainer.destroy(),this.elements.canvasContainer=new n.Element("div",{class:"wux-canvas-container"}).inject(e.elements.container),e.elements._colorCanvas=new u({subColorAttributeX:"Saturation",subColorAttributeY:"Value",handleEditionCancel:!1,fireOnlyFromUIInteractionFlag:!0}).inject(e.elements.canvasContainer),this.elements._slider=new h({handleEditionCancel:!1,fireOnlyFromUIInteractionFlag:!0,valuePopupFlag:!1,displayStyle:"vertical",sliderButtonStyle:"accurate"}).inject(this.elements.canvasContainer),this.elements._slider.displayStyle="vertical",e.elements._panelInfos=new n.Element("div",{class:t+"informations"}).inject(e.elements.canvasContainer),e.elements._colorBox=new n.Element("div",{class:"color-box"}).inject(e.elements._panelInfos);var i=new n.Element("div",{class:t+"picker-color-container"}).inject(e.elements._colorBox);e.elements._color=new n.Element("div",{class:t+"picker-color"}).inject(i),e.showAlphaFlag&&(e.elements._colorBackground=new n.Element("div",{class:t+"picker-color-background"}).inject(i));var l=new n.Element("div",{class:t+"picker-colorRef-container"}).inject(e.elements._colorBox);e.elements._colorRef=new n.Element("div",{class:t+"picker-colorRef"}).inject(l),e.showAlphaFlag&&(e.elements._colorRefBackground=new n.Element("div",{class:t+"picker-colorRef-background"}).inject(l)),e.elements._panelColorHex=new n.Element("div",{class:t+"informations-color"}).inject(e.elements._panelInfos),"basic"===e.displayStyle&&(e.elements._colorEditors=new d({fireOnlyFromUIInteractionFlag:!0,showAlphaFlag:this.showAlphaFlag,displayStyle:"stacked",useColorSlidersFlag:!1,availableColorFormats:["RGB","HSV"]}).inject(e.elements._panelInfos)),o.addEventOnElement(this,this.elements._colorRef,s.POINTERHIT,(function(t){2===t.multipleHitCount&&e.setPropertyFromUIInteraction("value",e.referenceValue)})),e.elements._labelHex=new n.Element("div",{class:t+"label-hexa",text:" # "}).inject(e.elements._panelColorHex),e.elements._valueHex=new r({placeholder:"",pattern:this.showAlphaFlag?"^([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{4}|[A-Fa-f0-9]{3})$":"^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",sizeInCharNumber:3,value:void 0,fireOnlyFromUIInteractionFlag:!0}).inject(e.elements._panelColorHex),e.elements._valueHex.getContent().addClassName(t+"lineeditor"),"advanced"===e.displayStyle&&(e.elements._colorEditors=new d({fireOnlyFromUIInteractionFlag:!0,showAlphaFlag:this.showAlphaFlag}).inject(e.elements.container)),this._applyReferenceValue(),this._applyInformationsVisibleFlag(),this._applyDisabled(),this._applyTouchMode(),this._refreshEditors(),this._apply_preventDefaultContextMenu()},t.prototype._postBuildView=function(){},t.prototype._updateAlphaValues=function(){this.showAlphaFlag?(this.value=a.addAlphaComponentToHex(this.value),this.referenceValue=a.addAlphaComponentToHex(this.referenceValue)):(this.value=a.removeAlphaComponentFromHex(this.value),this.referenceValue=a.removeAlphaComponentFromHex(this.referenceValue))},t.prototype._applyShowAlphaFlag=function(){this._updateAlphaValues(),this._refreshEditors()},t.prototype._applyInformationsVisibleFlag=function(){this.elements._panelInfos&&(this.informationsVisibleFlag?this.elements._panelInfos.show():this.elements._panelInfos.hide())},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this._applyShowAlphaFlag(),this.isDirty("hsvValue")&&this._applyHsvValue(),this.isDirty("value")&&this._applyValue(t.value,this.value),this.isDirty("referenceValue")&&this._applyReferenceValue(t.referenceValue),this.isDirty("touchMode")&&this._applyTouchMode(),this.isDirty("informationsVisibleFlag")&&this._applyInformationsVisibleFlag(),this.isDirty("showAlphaFlag")&&this._applyShowAlphaFlag(),this.isDirty("displayStyle")&&this._applyDisplayStyle()},t.prototype._applyDisplayStyle=function(){this.buildColorChooserView()},t.prototype._applyDisabled=function(){e.prototype._applyDisabled.call(this),this.elements._slider&&(this.elements._slider.disabled=this.disabled,this.elements._colorCanvas.disabled=this.disabled,this.elements._valueHex.disabled=this.disabled,this.elements._colorEditors.disabled=this.disabled),this.disabled?this.elements.container.removeAttribute("tabindex"):this.elements.container.setAttribute("tabindex","0")},t.prototype._applyReferenceValue=function(e,t){if(void 0!==this.referenceValue){if("#"===this.referenceValue.charAt(0)){var i=this.referenceValue.substr(1);(this.showAlphaFlag?new RegExp("^([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{4}|[A-Fa-f0-9]{3})$","g"):new RegExp("^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$","g")).test(i)?this.referenceValue=i:this.referenceValue=e}if(this.elements._colorRef){var n=a.hexToRgb(this.referenceValue);if(void 0!==n.a&&(n.a=void 0),this.showAlphaFlag){var s=a.hexToRgb(this.referenceValue);void 0===s.a&&(s.a=255),this.elements._colorRef.setStyle("background","linear-gradient(to top, "+a.colorToCssColor(n)+" 0%, "+a.colorToCssColor(s)+" 70%, "+a.colorToCssColor(s)+" 100%)")}else this.elements._colorRef.setStyle("backgroundColor",a.colorToCssColor(n));this.elements._colorRef.removeClassName("undefined-class")}}else this.elements._colorRef&&(this.elements._colorRef.setStyle("background","white"),this.elements._colorRef.addClassName("undefined-class"))},t.prototype._apply_preventDefaultContextMenu=function(){this.elements._slider&&(this.elements._slider._preventDefaultContextMenu=this._preventDefaultContextMenu,this.elements._colorCanvas._preventDefaultContextMenu=this._preventDefaultContextMenu,this.elements._valueHex._preventDefaultContextMenu=this._preventDefaultContextMenu,this.elements._colorEditors._preventDefaultContextMenu=this._preventDefaultContextMenu)},t.prototype._refreshEditors=function(){if(void 0!==this.elements._slider){if(void 0===this.hsvValue)return this.elements._slider.value=void 0,this.elements._colorCanvas.hsvValue=void 0,this.elements._colorEditors.hsvValue=void 0,this.elements._valueHex.value="",this.elements._color.setStyle("background","white"),void this.elements._color.addClassName("undefined-class");var e=this.getColorSubAttribute(this.elements._slider.gradientType);this.elements._slider.value=e,this.elements._colorCanvas.hsvValue=this.hsvValue,this.elements._colorEditors.hsvValue=this.hsvValue;var t=this.hsvValue;this.showAlphaFlag||(t=t.slice(0,3)),this.elements._valueHex.value=a.hsvToHex(t);var i=a.hexToRgb(this.value);if(void 0!==i.a&&(i.a=void 0),this.showAlphaFlag){var n=a.hexToRgb(this.value);null==n.a&&(n.a=255),this.elements._color.setStyle("background","linear-gradient(to top, "+a.colorToCssColor(i)+" 0%, "+a.colorToCssColor(n)+" 70%, "+a.colorToCssColor(n)+" 100%)")}else this.elements._color.setStyle("backgroundColor",a.colorToCssColor(i));this.elements._color.removeClassName("undefined-class")}},t.prototype._applyValue=function(e,t){this.value=this.showAlphaFlag?a.addAlphaComponentToHex(t):a.removeAlphaComponentFromHex(t),this._applyingValue=!0,this._applyingHsvValue||(this.hsvValue=a.hexToHsv(this.value),this._refreshEditors()),this._applyingValue=!1},t.prototype._applyHsvValue=function(){this._applyingHsvValue=!0,this._applyingValue||(this.value=a.hsvToHex(this.hsvValue),this._refreshEditors(),this.elements._slider&&(this.elements._slider.modulationColor="Hue"===this.elements._slider.gradientType?[this.hsvValue[0],100,100]:this.hsvValue)),this.fire("change"),this._applyingHsvValue=!1},t.prototype._applyTouchMode=function(){e.prototype._applyTouchMode.call(this);var t=this._getCurrentTouchMode();this.elements._panelInfos&&(!0===t?this.elements._panelInfos.setAttributeNode(document.createAttribute("touch-mode")):this.elements._panelInfos.removeAttribute("touch-mode"))},t.prototype.setColorSubAttribute=function(e,t){var i=this.hsvValue||[0,100,100,this.showAlphaFlag?255:void 0],n=a.hsvToRgb(i),s=a.hsvToHsl(i);switch(e){case"Hue":this.hsvValue=[t,i[1],i[2],i[3]];break;case"HslSaturation":this.hsvValue=a.hslToHsv([s[0],t,s[2],i[3]]);break;case"Saturation":this.hsvValue=[i[0],t,i[2],i[3]];break;case"Value":this.hsvValue=[i[0],i[1],t,i[3]];break;case"Lightness":this.hsvValue=a.hslToHsv([s[0],s[1],t,s[3]]);break;case"Red":this.hsvValue=a.rgbToHsv(t,n.g,n.b,n.a);break;case"Green":this.hsvValue=a.rgbToHsv(n.r,t,n.b,n.a);break;case"Blue":this.hsvValue=a.rgbToHsv(n.r,n.g,t,n.a);break;case"Alpha":this.hsvValue=a.rgbToHsv(n.r,n.g,n.b,t)}},t.prototype.getColorSubAttribute=function(e){var t=a.hsvToRgb(this.hsvValue),i=a.hsvToHsl(this.hsvValue);switch(e){case"Hue":return this.hsvValue[0];case"HslSaturation":return i[1];case"Saturation":return this.hsvValue[1];case"Value":return this.hsvValue[2];case"Lightness":return i[2];case"Red":return t.r;case"Green":return t.g;case"Blue":return t.b;case"Alpha":return t.a}},t.prototype._handleEvents=function(){var e=this;this.pointerdownCanvasP=!1,this.pointerdownSliderP=!1;var t=document;e.getContent()&&e.getContent().ownerDocument&&(t=e.getContent().ownerDocument),o.addEventOnElement(this,this.elements._panelInfos,"beginEdit",(function(t){t.stopPropagation(),e.fire("beginEdit")})),o.addEventOnElement(this,this.elements._panelInfos,"endEdit",(function(t){t.stopPropagation(),e.fire("endEdit")})),o.addEventOnElement(this,this.elements._panelInfos,"cancelEdit",(function(t){t.stopPropagation(),e.fire("cancelEdit")})),o.addEventOnElement(this,this.elements._panelInfos,"uncommittedChange",(function(e){e.stopPropagation()})),o.addEventOnElement(this,this.elements._panelInfos,"preValidateValue",(function(e){e.stopPropagation()})),o.addEventOnElement(this,this.elements._valueHex,"focus",(function(t){t.stopPropagation(),e.fire("beginEdit")})),o.addEventOnElement(this,this.elements._valueHex,"change",(function(t){(t.stopPropagation(),void 0!==e.elements._valueHex.value&&null!==e.elements._valueHex.value)&&((e.showAlphaFlag?new RegExp("^([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{4}|[A-Fa-f0-9]{3})$","g"):new RegExp("^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$","g")).test(e.elements._valueHex.value)?e.setPropertyFromUIInteraction("value",e.elements._valueHex.value):e.value=void 0)})),o.addEventOnElement(this,this.elements._valueHex,"blur",(function(t){t.stopPropagation(),e.fire("endEdit")})),o.addEventOnElement(this,this.elements._valueHex,"uncommittedChange",(function(e){e.stopPropagation()})),o.addEventOnElement(this,this.elements._slider,s.POINTERDOWN,(function(e){e.stopPropagation()})),o.addEventOnElement(this,this.elements._slider,"beginEdit",(function(t){t.stopPropagation(),e.pointerdownSliderP=!0,e.initialValue=e.hsvValue,e.fire("beginEdit")})),o.addEventOnElement(this,this.elements._slider,"endEdit",(function(t){t.stopPropagation(),e.pointerdownSliderP=!1,e.fire("endEdit")})),o.addEventOnElement(this,this.elements._slider,"cancelEdit",(function(t){t.stopPropagation(),e.pointerdownSliderP=!1,e.fire("cancelEdit")})),o.addEventOnElement(this,this.elements._colorCanvas,"beginEdit",(function(t){t.stopPropagation(),e.pointerdownCanvasP=!0,e.initialValue=e.hsvValue,e.fire("beginEdit")})),o.addEventOnElement(this,this.elements._colorCanvas,"endEdit",(function(t){t.stopPropagation(),e.pointerdownCanvasP=!1,e.fire("endEdit")})),o.addEventOnElement(this,this.elements._colorCanvas,"cancelEdit",(function(t){t.stopPropagation(),e.pointerdownCanvasP=!1,e.fire("cancelEdit")})),o.addEventOnElement(this,this.elements._colorEditors,"changeModulation",(function(t){t.stopPropagation();for(var i=0,n=["Hue","Saturation","Value","HslSaturation","Lightness","Red","Green","Blue"];i<n.length;i++){var s=n[i];t.options.colorSubAttributeType===s&&(e.elements._slider.gradientType=s,e.elements._slider&&(e.elements._slider.modulationColor="Hue"===e.elements._slider.gradientType?[e.hsvValue[0],100,100]:e.hsvValue),"Hue"===s?"HSL"===t.currentColorFormat?e.elements._colorCanvas.setProperties({subColorAttributeX:"HslSaturation",subColorAttributeY:"Lightness"}):e.elements._colorCanvas.setProperties({subColorAttributeX:"Saturation",subColorAttributeY:"Value"}):"Saturation"===s?e.elements._colorCanvas.setProperties({subColorAttributeX:"Hue",subColorAttributeY:"Value"}):"HslSaturation"===s?e.elements._colorCanvas.setProperties({subColorAttributeX:"Hue",subColorAttributeY:"Lightness"}):"Value"===s?e.elements._colorCanvas.setProperties({subColorAttributeX:"Hue",subColorAttributeY:"Saturation"}):"Lightness"===s?e.elements._colorCanvas.setProperties({subColorAttributeX:"Hue",subColorAttributeY:"HslSaturation"}):"Red"===s?e.elements._colorCanvas.setProperties({subColorAttributeX:"Green",subColorAttributeY:"Blue"}):"Green"===s?e.elements._colorCanvas.setProperties({subColorAttributeX:"Blue",subColorAttributeY:"Red"}):"Blue"===s&&e.elements._colorCanvas.setProperties({subColorAttributeX:"Red",subColorAttributeY:"Green"}))}})),o.addEventOnElement(this,this.elements._colorCanvas,"change",(function(t){t.stopPropagation();var i=e.elements._colorCanvas.hsvValue;e.showAlphaFlag&&void 0===i[3]&&(i[3]=255),e.hsvValue=i})),o.addEventOnElement(this,this.elements._colorEditors,"change",(function(t){t.stopPropagation(),e.hsvValue=e.elements._colorEditors.hsvValue})),o.addEventOnElement(this,this.elements._slider,"change",(function(t){t.stopPropagation(),e.setColorSubAttribute(e.elements._slider.gradientType,e.elements._slider.value)})),o.addEventOnElement(this,t.body,s.POINTERUP,(function(i){e.disabled||(e.pointerdownCanvasP&&(e.pointerdownCanvasP=!1,e.fire("endEdit")),t.body.style.cursor="")})),o.addEventOnElement(this,this.elements._colorCanvas,"keydown",(function(t){if(!e.disabled&&c.ESCAPE==t.keyCode&&e.pointerdownCanvasP){if(!e.handleEditionCancel)return;t.stopPropagation(),void 0!==e.initialValue&&(e.setPropertyFromUIInteraction("hsvValue",e.initialValue),e.fire("cancelEdit"))}})),o.addEventOnElement(this,this.elements._slider,"keydown",(function(t){if(!e.disabled&&c.ESCAPE==t.keyCode&&e.pointerdownSliderP){if(!e.handleEditionCancel)return;t.stopPropagation(),void 0!==e.initialValue&&e.setPropertyFromUIInteraction("hsvValue",e.initialValue),e.fire("cancelEdit")}}))},t}(i);return l.addClass(p,"colorChooser"),p.prototype.blackBoxFlag=!0,p}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Controls/ColorPicker",["require","exports","DS/Controls/Abstract","DS/Controls/ColorChooser","DS/Controls/Popup","DS/Utilities/Color","DS/Utilities/KeyboardUtils","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/WebappsUtils/WebappsUtils","DS/Utilities/WUXUWAUtils"],(function(e,t,i,n,s,o,l,a,r,h,u){"use strict";var c=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return u.extendingClassFlag||n.addKeyMapsAndCommands({space:{keydown:"actionPopup",keyup:"preventDefault"}},{actionPopup:function(){return this.popupVisibleFlag=!this.popupVisibleFlag,{preventDefault:!0,stopPropagation:!0}},preventDefault:function(){return{preventDefault:!0,stopPropagation:!0}}}),n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:"ffffff",type:"string",category:"Behavior",advancedSetter:!0},referenceValue:{defaultValue:"ffffff",type:"string",category:"Behavior"},showAlphaFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},popupVisibleFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},handleEditionCancel:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_preventDefaultContextMenu:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this.elements.container.addClassName("wux-controls-colorpicker-button"),this._createPopup(),this.currentValue=this.value,this.initialValue=void 0},t.prototype._postBuildView=function(){this._preEditValue(void 0,this.value)&&this._applyValue()},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("value")&&(this._preEditValue&&!this._preEditValue(t.value,this.value)||this._applyValue(t.value)),this.isDirty("referenceValue")&&this._applyReferenceValue(t.referenceValue),this.isDirty("popupVisibleFlag")&&this._applyPopupVisibleFlag(t.popupVisibleFlag),this._apply_preventDefaultContextMenu()},t.prototype._applyTouchMode=function(){!0===this._getCurrentTouchMode()?this.elements.container.setAttributeNode(document.createAttribute("touch-mode")):this.elements.container.removeAttribute("touch-mode")},t.prototype._preEditValue=function(e,t){if(null!=t){var i=!0;return t.toString()!==t&&(t=t.toString(),i=!1),"#"===t.charAt(0)&&(t=t.substr(1),i=!1),!!(this.showAlphaFlag?new RegExp("^([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{4}|[A-Fa-f0-9]{3})$","g"):new RegExp("^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$","g")).test(t)&&(!!i||(this.value=t,!1))}return!0},t.prototype._applyValue=function(e){var t=this.value;if(this.elements.container&&null!=t){this.elements._colorChooser&&(this.elements._colorChooser.value=t);var i=o.hexToRgb(t);if(void 0!==i.a){var n=o.hexToRgb(t);n.a=255,this.elements.container.setStyle("background","linear-gradient("+o.colorToCssColor(n)+", "+o.colorToCssColor(i)+"), url("+h.getWebappsBaseUrl()+"Utilities/assets/textures/colorCheckeredBackground_22x22.png)")}else this.elements.container.setStyle("background",o.colorToCssColor(i));var s=this.currentValue;if("string"!=typeof s||"string"!=typeof t||null===t||null===s)t!==s&&(this.popupVisibleFlag||this._popupClosingFlag)?this.fire("liveChange"):t===s||this.popupVisibleFlag||e&&t&&e!==t.substr(1)&&e.substr(1)!==t&&this.fire("change");else{var l=!1;(this.popupVisibleFlag||this._popupClosingFlag)&&(e&&t.toLowerCase()!==e.toLowerCase()||t.toLowerCase()!==s.toLowerCase())&&(l=!0),l?this.fire("liveChange"):t.toLowerCase()===s.toLowerCase()||this.popupVisibleFlag||("string"!=typeof e||null===e||"string"!=typeof t||null===t?e!==t&&this.fire("change"):e&&t&&e!==t.substr(1)&&e.substr(1)!==t&&this.fire("change"))}this.elements.container.removeClassName("undefined-class")}else this.elements._colorChooser&&(this.elements._colorChooser.value=t),this.elements.container.addClassName("undefined-class"),this.elements.container.setStyle("background",o.colorToCssColor(o.hexToRgb("ffffff")))},t.prototype._applyReferenceValue=function(e){void 0!==this.referenceValue&&this.elements._colorChooser&&(this.elements._colorChooser.referenceValue=this.referenceValue)},t.prototype._applyDisabled=function(t){e.prototype._applyDisabled.call(this,t),this.elements._colorChooser&&(this.elements._colorChooser.disabled=this.disabled),this.disabled?this.elements.container.removeAttribute("tabindex"):this.elements.container.setAttribute("tabindex",0)},t.prototype._applyPopupVisibleFlag=function(e){this.elements._popup&&(this.popupVisibleFlag?(this.elements._popup.visibleFlag=!0,this.elements._colorChooser.value=this.value,this.fire("show")):(this.elements._popup.visibleFlag=!1,this.fire("hide",{cancelFlag:"escape"===this._eventTrigger})))},t.prototype._apply_preventDefaultContextMenu=function(){this.elements._colorChooser&&(this.elements._colorChooser._preventDefaultContextMenu=this._preventDefaultContextMenu)},t.prototype._createPopup=function(){var e=this;this.elements._popup=void 0;var t={target:this.getContent(),position:"bottom",offset:{x:0,y:4},alignment:"near",constraint:"screen",trigger:"click escape",overlap:!1,className:"wux-controls-popup wux-controls-colorpicker-popup",fireOnlyFromUIInteractionFlag:!0,getBody:function(){if(!e.elements._colorChooser)return e.elements._colorChooser=new n({value:e.value,referenceValue:e.referenceValue,handleEditionCancel:!1,disabled:e.disabled,_preventDefaultContextMenu:e._preventDefaultContextMenu,showAlphaFlag:e.showAlphaFlag}),a.addEventOnElement(e,e.elements._colorChooser,"beginEdit",(function(t){t.stopPropagation(),e.fire("beginEdit")})),a.addEventOnElement(e,e.elements._colorChooser,"change",(function(t){var i;t.stopPropagation(),void 0!==e.value&&null!==e.value?e.value.toLowerCase()!==(null===(i=e.elements._colorChooser.value)||void 0===i?void 0:i.toLowerCase())&&e.setPropertyFromUIInteraction("value",e.elements._colorChooser.value):e.setPropertyFromUIInteraction("value",e.elements._colorChooser.value)})),a.addEventOnElement(e,e.elements._colorChooser,"endEdit",(function(t){t.stopPropagation(),e.fire("endEdit")})),e.elements._colorChooser}};s.delayPopupCreation(t,(function(t){e.elements._popup=t,a.addEventOnElement(e,e.elements._popup,"show",(function(t){t.stopPropagation(),e.currentValue=e.value,e.initialValue=e.value,e.setPropertyFromUIInteraction("popupVisibleFlag",!0)})),a.addEventOnElement(e,e.elements._popup,"hide",(function(t){t.stopPropagation(),"escape"===t.options.trigger?e.handleEditionCancel&&(void 0!==e.initialValue&&!0===e.handleEditionCancel&&(e.currentValue=e.value,e._popupClosingFlag=!0,e.setPropertyFromUIInteraction("value",e.initialValue),e._popupClosingFlag=!1),e.fire("cancelEdit")):void 0===e.currentValue||void 0===e.value||null===e.value||null===e.currentValue?e.value===e.currentValue||null!=e.initialValue&&e.value===e.initialValue||(e.fire("change"),e.fire("endEdit")):e.value.toLowerCase()===e.currentValue.toLowerCase()||void 0!==e.initialValue&&e.value.toLowerCase()===e.initialValue.toLowerCase()||(e.fire("change"),e.fire("endEdit")),e.initialValue=void 0,e._eventTrigger=t.options.trigger,e.setPropertyFromUIInteraction("popupVisibleFlag",!1),e._eventTrigger=void 0})),a.addEventOnElement(e,e.elements._popup,"keydown",(function(t){t.stopPropagation(),l.ENTER===t.keyCode&&!0!==t.actionPerformed&&e.popupVisibleFlag&&e.elements._popup.hide()}))}))},t.prototype._giveFocus=function(){this._isFocused()||this.elements.container.focus()},t.prototype.show=function(){return this.popupVisibleFlag=!0,this},t.prototype.hide=function(){this.popupVisibleFlag=!1},t.prototype.getPopup=function(){return this.elements._popup},t}(i);return c.prototype.blackBoxFlag=!0,r.addClass(c,"colorPicker"),c}));