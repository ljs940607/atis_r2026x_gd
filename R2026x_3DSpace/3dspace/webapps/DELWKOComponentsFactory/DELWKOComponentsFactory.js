define("DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessDataCollectionUI",["UWA/Core","DS/DELWKOViewBehaviors/DELWKOFormUI","DS/DELPPWModelServices_FD02/BehaviorUtil","text!DS/DELPPWViewBehaviors_FD02/assets/json/TypeMapping.json"],(function(e,t,n,r){"use strict";return function(i,o,a,l,s,c,u){var d,f,g,m=null,p=null,y=null,C=null,v=null,L=null,D=null,V=null,I=null,h={},T=null,b=null,O=!1,S=!1,w=new e.Element("div",{class:"Form-Sections-Container"}),E=a.getComponent("ComboBox"),F=a.getComponent("Accordeon"),P=a.getComponent("TooltipModel"),W=e.Json.decode(r),k=function(t){var n;y=t.dsModel.currentValue,n=m.concat("/",y),d.type=n,I.destroy(),e.is(T)&&T.destroy(),null===b&&A(),B((function(e){R(e)})),d.onTypeChange(y,w)},x=function(e){p=e.dsModel.currentValue,b.destroy(),b=null,k(e)},U=function(e){L=e.dsModel.currentValue},M=function(e){e.sort((function(e,t){return e.label.localeCompare(t.label,widget.lang,{numeric:!0})}))},N=function(t){var n,r,i=[];return n={elementsList:i=t.elementsList.map((function(e){return{labelItem:e.label,valueItem:e.value}})),actionOnClickFlag:!1,enableSearchFlag:!1},e.is(t.selected)&&(n.selectedIndex=i.findIndex((function(e){return e.valueItem===t.selected}))),(r=new E(n)).fieldType=t.fieldType,h[t.name]=r,e.is(t.onChange,"function")&&r.addEventListener("change",t.onChange),r},A=function(){var t=function(){var t,r,o,a,s,c,d,f,m,C,v,D,I,h={},T=[];e.is(V,"object")&&e.owns(V,y)&&(h=V[y]),C=function(t){let n={},r=[];return e.is(h,"object")&&e.owns(h,"Type")&&(n=function(t,n){let r;return Array.isArray(t.Type)&&(r=t.Type.find((function(e){return e.name===n}))),e.is(r)?r:{}}(h,t)),e.is(n,"object")&&(e.owns(n,"visibility")&&"true"===n.visibility||!e.owns(n,"visibility"))&&(m=u.getTypeInfo(t),u.isAKindOf(t,"Resource")?(e.owns(m,"isOOTB")&&"false"===m.isOOTB||e.owns(m,"Newable")&&function(e){let t=e.toUpperCase();return["NEW","ALL"].some((e=>t.includes(e)))}(m.Newable))&&r.push({value:t,label:l.getNLSValue(t,null,"Type")}):r.push({value:t,label:l.getNLSValue(t,null,"Type")})),r},T=T.concat(C(y)),e.is(p)&&p!==y?(T=T.concat(C(p)),f=u.getTypeHierarchy(p)):f=u.getTypeHierarchy(y),e.is(f,"array")&&f.forEach((function(e){e!==y&&(T=T.concat(C(e)))})),M(T),d=new e.Element("div",{class:"section-container"}),t=new e.Element("div",{class:"wux-field-container inline-container"}).inject(d),a=new e.Element("div",{class:"wux-field-container inline-container"}).inject(d),o=new e.Element("h6",{class:"wux-type-textElement",text:l.getNLSValue("General.Type")}).inject(t),r=N({name:"V_Type",elementsList:T,fieldType:"select",selected:y,onChange:k}),o.tooltipInfos=new P({shortHelp:l.getNLSValue("General.Type")}),r.inject(t),!1===n.isCloud()&&(c=new e.Element("h6",{class:"wux-type-textElement",text:l.getNLSValue("General.Credentials")}).inject(a),s=function(){var t=i.getService("ConfigService").getSecurityContext(),n=t.getAllSC(),r=i.getConfig().isFacet&&!t.getSCFromPreferences().includes("ctx::")?"ctx::"+t.getSCFromPreferences():t.getSCFromPreferences(),o=new E({elementsList:n.map((function(e){return{labelItem:e.label,valueItem:e.value}})),actionOnClickFlag:!1,enableSearchFlag:!1,selectedIndex:n.findIndex((function(e){return e.value===r}))});return L=r,e.is(U,"function")&&o.addEventListener("change",U),o}(),c.tooltipInfos=new P({shortHelp:l.getNLSValue("General.Credentials")}),s.inject(a)),v="Section.General",D=d,I=new e.Element("div",{class:"Type-Section-Container"}).inject(w),new F({items:[{header:l.getNLSValue(v)?l.getNLSValue(v):v,content:D,expandedFlag:!0}],style:"filled-separate"}).inject(I),D.addEvent("resize",(function(){var t,n,r,i;i=D.getElements(".wux-field-container"),(r=D.clientWidth)<290||r>290&&"block-container"===g?(t="inline-container",n="block-container"):(t="block-container",n="inline-container"),e.is(i)&&i.forEach((function(e){e.removeClassName(t),e.addClassName(n)}))})),b=I};e.is(V)?t():s.getXMLValues(i.getConfig().resource.ItemOOTBFiltering,(function(n){e.owns(W,o.getId())&&(V=n.convert("Config.Preferences."+W[o.getId()].section+".OOTBType","name")),t()}),(function(e){S=!0,o.debug("failed to get ItemOOTBFiltering XML. Error Desc: "+e)}))},B=function(t){var n=function(){var n,r=D[y]||{};if(e.owns(r,"Section")||(r.Section={},r.Section.name=l.getNLSValue("Section.Attributes"),r.Section.Attribute=[{dicoType:"PLMEntity",name:"V_Name",mandatory:!0},{dicoType:"PLMEntity",name:"V_description"}]),"ProcessContinuousProvide"===y&&e.is(f)&&!1===f){switch(C){case"LENGTH":n="DELFmiContQuantity_Length";break;case"MASS":n="DELFmiContQuantity_Mass";break;case"AREA":n="DELFmiContQuantity_Area";break;case"VOLUME":n="DELFmiContQuantity_Volume";break;default:n=null}r.Section.Attribute.push({dicoType:n,name:"V_ContQuantity",readOnly:!1})}t(r)};e.is(D)?n():e.is(d)&&!0===d.explode?s.getXMLValues(i.getConfig().resource.explodeWorkOrderFromProcessFormAttributeXML,(function(e){D=e.convert("AttributesDescriptionList.Type","name"),n()}),(function(e){O=!0,o.debug("failed to get createWorkOrderFromProcessFormAttributeXML XML. Error Desc: "+e)})):s.getXMLValues(i.getConfig().resource.createWorkOrderFromProcessFormAttributeXML,(function(e){D=e.convert("AttributesDescriptionList.Type","name"),n()}),(function(e){O=!0,o.debug("failed to get createWorkOrderFromProcessFormAttributeXML XML. Error Desc: "+e)}))},R=function(n){I=new t(i,o,a,l,c,u),T=new e.Element("div",{class:"Form-container"}),I.createUI({sections:n,type:d.type,renderTo:T,defaultValues:v}),T.inject(w),g=I.getFormStyle()},_=function(){return O||S};return{createUI:function(t){d=t||{},e.is(d.type)&&e.is(d.renderTo)&&(O=!1,S=!1,y=d.type.split("/")[1]||"",m=d.type.split("/")[0],C=d.dimension,d.defaultValues&&(v=d.defaultValues[0]),e.is(d.createRoot)&&(f=d.createRoot),B((function(t){var n,r=[];if(e.is(t.Section)){var i=t.Section;if(e.is(i)){var o=i.Attribute,a=(n=o,new e.Promise((function(t,r){var i=0,o=0;n.forEach((n=>{e.is(n.implementation)&&(i++,require([n.implementation],(function(e){o++,n.customUI=e,o===i&&t()})))})),0===i&&t()})));r.push(a)}}e.Promise.all(r).then((function(n){var r,i,o,a;e.is(d.baseTypes)&&(a=d.baseTypes.map((function(e){return{value:e,label:l.getNLSValue(e,null,"Type")}})),M(a),r=new e.Element("div",{class:"top-container inline-container"}).inject(w),i=new e.Element("h6",{class:"wux-type-textElement",text:l.getNLSValue("Base.Type")}).inject(r),o=N({name:"V_BaseType",elementsList:a,fieldType:"select",selected:d.selectedBaseType,onChange:x}),i.tooltipInfos=new P({shortHelp:l.getNLSValue("Base.Type")}),o.inject(r),p=d.selectedBaseType),A(),R(t)}))})),_()&&e.is(d.onFailure,"function")&&d.onFailure({invalidXML:!0}),w.inject(d.renderTo))},destroy:function(){e.is(I)&&I.destroy(),e.is(T)&&T.destroy(),e.is(w)&&w.destroy()},getValues:function(){var t,n={};return e.owns(h,"V_Type")&&e.is("V_Type")&&(h.V_Type.currentValue?(n.V_Type=m.concat("/",h.V_Type.currentValue),n.type=y):(n.V_Type=h.V_Type,n.type=y)),t=I.getValues(),e.extend(t,n),t},getSecurityContextOverride:function(){return L},validate:function(){return _()?{result:!1,message:l.getNLSValue("ModelBehavior.CreateReference.Failure.InvalidXML")}:I?I.validate():{result:!0,message:null}},updateToDefaultValues:function(e){I&&I.updateToDefaultValues(e)}}}})),define("DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessUI",["UWA/Core","DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessDataCollectionUI"],(function(e,t){"use strict";return function(t,n,r,i){var o,a=1,l=2,s=3,c=4,u=5,d={CreateNew:1,ExplodeWorkOrder:2,CreateContinuesProvided:3},f=n.getComponent("Element"),g=n.getComponent("Button"),m=null,p=null,y=null,C=!1,v=function(t){e.is(t)&&e.is(t.invalidXML)&&(C=t.invalidXML)},L=function(e,t){var n;switch(o){case d.ReplaceByNew:return n="InsertUI.ReplaceByNewDialog.Title",r.getNLSValue(n,{type:r.getNLSValue(e,null,"Type")});case d.CreateContinuesProvided:return n="InsertUI.ContinuousProvidedMaterial.Title",r.getNLSValue(n,{dimension:r.getNLSValue(t,null,"Dimension")});case d.ExplodeWorkOrder:return n="InsertUI.ExplodeDialog.Title",r.getNLSValue(n,{type:r.getNLSValue(e,null,"Type")});default:return n="InsertUI.CreateDialog.Title",r.getNLSValue(n,{type:r.getNLSValue(e,null,"Type")})}},D=function(f,v,D,V,I,h){var T,b,O,S,w,E,F,P,W,k=e.is(h)&&e.is(h.fatherPID,"string")&&h.fatherPID.length>0?h.fatherPID:null,x=e.is(h)&&e.is(h.transactionUUID,"string")&&h.transactionUUID.length>0?h.transactionUUID:null,U={transactionUUID:x,requestedCreation:0},M=t.getPreferenceValue("showDialog")&&(!e.is(V,"boolean")||V);if(P=function(){!0!==(O=m.validate()).result?(b=r.getNLSValue("ModelBehavior.CreateReference.Failure.ReferenceNotCreated")+O.message,t.warn(b),y.close()):(W=m.getSecurityContextOverride(),T=m.getValues(),y.close(),v(T,{securityContextOverride:W,fatherPID:k,transactionUUID:x}))},w=function(n){var r=function(){return O=m.validate(),W=m.getSecurityContextOverride(),!0!==O.result?(e.is(O.message)&&y.error(O.message),!1):(y.clearMessages(),T=m.getValues(),v(T,{securityContextOverride:W,fatherPID:k,transactionUUID:x}),!0)},i=function(){y.close()};switch(n){case a:return function(){O=null,i(),e.is(x)&&t.notify("objectCreationUIClosed",U)};case s:return function(){e.is(x)&&U.requestedCreation++,r()};case l:return function(){r()&&(i(),e.is(x)&&(U.requestedCreation++,t.notify("objectCreationUIClosed",U)))};case u:return function(){O=null,i(),e.is(x)&&t.notify("objectCreationUIClosed",U)};case c:return function(){!function(){if(O=m.validate(),W=m.getSecurityContextOverride(),!0!==O.result)return e.is(O.message)&&y.error(O.message),!1;y.clearMessages(),T=m.getValues(),i(),D(h.selectedObjectId,{onComplete:function(){v(T,{securityContextOverride:W,showConfirmation:!1,fatherPID:k,transactionUUID:x,onComplete:function(){e.is(x)&&(U.requestedCreation++,t.notify("objectCreationUIClosed",U))}})},showConfirmation:!1})}()};default:t.log("wrong option")}},o===d.ExplodeWorkOrder)S={No:new g({label:r.getNLSValue("InsertUI.Close.Title"),onClick:w(u)}),Yes:new g({label:r.getNLSValue("InsertUI.ExplodeClose.Title"),onClick:w(c)})};else S={No:new g({label:r.getNLSValue("InsertUI.Close.Title"),onClick:w(a)}),Apply:new g({label:r.getNLSValue("InsertUI.Create.Title"),onClick:w(s)}),Yes:new g({label:r.getNLSValue("InsertUI.CreateAndClose.Title"),onClick:w(l)})};e.is(n)?(F={title:L(f.split("/")[1]||"",I),domId:"CreateWorkOrder-dialog",content:p,resizableFlag:!0,modalFlag:!0,minWidth:290,buttons:S,visibleFlag:M},e.is(i)&&(E=f.indexOf("/")>-1?f.split("/")[1]:f,i.getPPRTypeFromType(E),F=e.merge({position:{my:"top",at:"top"},height:520,width:600},F)),(y=n.create("Dialog",F)).close=function(){e.is(m)&&(m.destroy(),m=null),e.is(p)&&p.destroy(),this.destroy(),y=null},M?C&&y.error(r.getNLSValue("ModelBehavior.CreateReference.Failure.InvalidXML")):P()):t.debug("uxFactoryBehavior is not available.")},V=function(e){y.title=L(e),y.clearMessages()};return{createDialog:function(t,r,i,a,l,s){o=d.CreateNew,e.is(a)&&(o=d.CreateContinuesProvided),p=new f("div",{class:"Insert-Command-Container"}),e.is(y)||(e.is(m)||(m=n.create("DELWKOCreateWorkOrderFromProcessDataCollectionUI",{type:t,onTypeChange:V,renderTo:p,dimension:a,createRoot:l,onFailure:v})),D(t,r,void 0,i,a,s))},createExplodeWorkOrderDialog:function(t,r,i,a,l,s,c){o=d.ExplodeWorkOrder,e.is(l)&&(o=d.CreateContinuesProvided),p=new f("div",{class:"Insert-Command-Container"}),e.is(y)||(e.is(m)||(m=n.create("DELWKOCreateWorkOrderFromProcessDataCollectionUI",{defaultValues:c.defaultValues,explode:!0,type:t,onTypeChange:V,renderTo:p,dimension:l,createRoot:s,onFailure:v})),D(t,r,i,a,l,c))},isActive:function(){return!!e.is(y)&&y.visibleFlag},destroyUI:function(){e.is(y)&&y.close()}}}})),define("DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessCmdModule",["UWA/Core","DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessUI"],(function(e,t){"use strict";return{behaviors:["UXFactoryBehavior","ModelBehavior","LinkBehavior","ResourceBehavior","SelectionBehavior","SearchBehavior","ReplaceBehavior"],creator:function(n,r,i,o,a,l,s,c){var u,d,f,g,m,p={},y=null,C=null;return m=function(){var t,n,r;if(r=l.getSelections(),e.is(r,"array")&&r.length>0)for(n=0;n<r.length;n++)if(t=r[n][0],e.is(t))return t},f=function(e,t){m();i.createWorkOrderFromProcess(e,undefined,t)},g=function(t,n){i.deleteReference([i.getReferenceModel(t)],{showConfirmation:!1,onComplete:function(t){e.is(n)&&n.onComplete&&n.onComplete.call(t)}})},function(t,n){var r,o,a=m();e.is(a)&&(r=i.getReferenceModel(a).id,o=i.getInstance(a),e.is(o)&&(t.instancePID=o.id)),e.is(C)&&(t["DELFmiMagnitudeExt.V_DimensionType"]=C),i.createRefOrInst(t,r,n)},function(t,n){e.is(n.newRef)&&c.replace("replaceByNew",n.newRef.id)},u=function(t){var n,r,i,o=t.arguments,a="",l=[];y.isActive()&&y.destroyUI(),C=null,e.is(o,"array")&&0<o.length&&o.forEach((function(t){if(e.is(t)&&e.is(t.ID,"string")&&e.is(t.Value,"string"))switch(t.ID){case"ReferenceType":a=t.Value;break;case"ShowDialog":n="false"!==t.Value;break;case"DisplayedInTableView":e.is(this._displayedInTableView,"array")||(l=[]),l.push(t.Value);break;case"V_DimensionType":C=t.Value}}),this),e.is(C)&&(i=m(),e.is(i)&&(r=!1)),a="DELLmiWorkOrder/DELLmiWorkOrderReference",y.createDialog(a,f,n,C,r)},d=function(t){var n,r,o=t.arguments,a="",l=[];y.isActive()&&y.destroyUI(),C=null,e.is(o,"array")&&0<o.length&&o.forEach((function(t){if(e.is(t)&&e.is(t.ID,"string")&&e.is(t.Value,"string"))switch(t.ID){case"ReferenceType":a=t.Value;break;case"ShowDialog":n="false"!==t.Value;break;case"DisplayedInTableView":e.is(this._displayedInTableView,"array")||(l=[]),l.push(t.Value);break;case"V_DimensionType":C=t.Value}}),this),r=m();var s={};if(e.is(r)){s.selectedObjectId=r;var c=i.getReferenceModel(r);s.defaultValues=[{"PLMEntity.V_Name":c.get("V_Name"),"DELLmiProductionPlanReference.ProductionPlan":i.getProductionPlanFromWorkOrder(r).get("PID"),OrderQuantity:c.getOrderQuantity().toString(),"DELLmiUPRSystemReference.V_DueDate":c.get("V_DueDate")}]}a="DELLmiWorkOrder/DELLmiWorkOrderReference",y.createExplodeWorkOrderDialog(a,f,g,n,C,undefined,s)},{listenTo:function(){return{CreateWorkOrderFromProcessCmd:u,ExplodeWorkOrderCmd:d}},onStart:function(o,l){p=e.extend(p,o),e.is(p.createWorkOrderFromProcessFormAttributeXML)||(n.debug("CreateWorkOrderFromProcess Module loading failed : createWorkOrderFromProcessFormAttributeXML option is undefined"),l()),e.is(p.explodeWorkOrderFromProcessFormAttributeXML)||(n.debug("ExplodeWorkOrderFromProcess Module loading failed : explodeWorkOrderFromProcessFormAttributeXML option is undefined"),l()),y=new t(n,r,a,i),l()},onStop:function(){y.isActive()&&y.destroyUI(),y=void 0}}}}}));