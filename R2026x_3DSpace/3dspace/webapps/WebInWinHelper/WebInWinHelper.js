define("DS/WebInWinHelper/WebInWinHelper",["UWA/Class","DS/WebToWinInfra/WebToWinCom","DS/WebappsUtils/WebappsUtils","DS/LifecycleServices/LifecycleServicesSettings","UWA/Json"],(function(e,t,n,i,a){"use strict";return e.singleton({init:function(){},createWebInWinSocket:function(e){return t.createSocket({socket_id:e+Math.floor(1e5*Math.random()+1)})},parseContextualMenu:function(e){return t.parseContextualMenu(e)},createJSONArraySelect:function(e){for(var t=[],n=0;n<e.length;n++){var i={id:e[n].physicalid,session_object:!1};t.push(i)}return'{ "objects_name": '+JSON.stringify(t)+"}"},createJSONArraySelectWithCSOTrue:function(e){for(var t=[],n=0;n<e.length;n++){var i={id:e[n].physicalid,session_object:!0};t.push(i)}return'{ "objects_name": '+JSON.stringify(t)+"}"},createJSONArrayActionWithArgs:function(e,t){for(var n={action:e,objectIds:[],Args:[]},i=0;i<t.length;i++)n.objectIds.push(t[i].physicalid),n.Args.push({Name:t[i].Name,Value:t[i].Value});return JSON.stringify(n)},createMoveJSONArray:function(e){for(var t=[],n=0;n<e.length;n++){var i={},a=[],o=Object.getOwnPropertyNames(e[n]);for(let t in o)if(o.hasOwnProperty(t)){var r=o[t];a.push({name:r,value:e[n][r]})}i.attributes=a,t.push({action:"Move",objectId:i})}return JSON.stringify(t)},createMaturityJSONArray:function(e,t,n){for(var i=[],a=0;a<e.length;a++){var o={},r=[],s=Object.getOwnPropertyNames(e[a]);for(let t in s)if(s.hasOwnProperty(t)){var c=s[t];r.push({name:c,value:e[a][c]})}o.attributes=r,i.push(o)}var l={objectId:i};JSON.stringify(l);return JSON.stringify(l)},createJSONArrayActionWithStates:function(e,t,n,i){for(var a={action:e,report:n,Args:[],status:i},o=0;o<t.length;o++)a.Args.push({Name:t[o].Name,Value:t[o].Value});return JSON.stringify(a)},setContextRestoreSelection:function(e,t){},setCSOSelection:function(e,t,n){var i=[];t.forEach((function(e){var t,n;void 0!==e.physicalId?t=e.physicalId:void 0!==e.physicalid?t=e.physicalid:void 0!==e.id?t=e.id:void 0!==e._options&&void 0!==e._options.id&&(t=e._options.id),void 0!==e.name?n=e.name:void 0!==e.displayName?n=e.displayName:void 0!==e._options&&void 0!==e._options.label&&(n=e._options.label);var a={physicalid:t,name:n};i.push(a)}));var a=this.createJSONArraySelect(i);e.dispatchEvent("onDispatchToWin",{notif_name:void 0!==n&&!0===n?"onAddToCSODirect":"onAddToCSO",notif_parameters:a},"lf_web_in_win")},setCSOSelectionIteration:function(e,t){var n=[];t.forEach((function(e){var t,i;void 0!==e.physicalId?t=e.physicalId:void 0!==e.physicalid?t=e.physicalid:void 0!==e.id&&(t=e.id),void 0!==e.name?i=e.name:void 0!==e.displayName&&(i=e.displayName);var a={physicalid:t,name:i};n.push(a)}));var i=this.createJSONArraySelectWithCSOTrue(n);e.dispatchEvent("onDispatchToWin",{notif_name:"onAddToCSO",notif_parameters:i},"lf_web_in_win")},fetchContextFromSelection:function(e,t,n){var i=[];t.forEach((function(e){var t,a;"ConfiguredBaseline"==e.type&&n&&"ConfiguredBaseline"==n.type&&null!=n.id?t=n.id:void 0!==e.physicalid&&(t=e.physicalid),void 0!==e.name?a=e.name:void 0!==e.displayName&&(a=e.displayName);var o={physicalid:t,name:a};i.push(o)}));var a=this.createJSONArraySelect(i);e.dispatchEvent("onDispatchToWin",{notif_name:"onActionClickDottedNoCSO",notif_parameters:a},"lf_web_in_win")},closePanel:function(e){e.dispatchEvent("onDispatchToWin",{notif_name:"ClosePanel",notif_parameters:"ClosePanel"},"lf_web_in_win")},transferStart:function(e){e.dispatchEvent("onDispatchToWin",{notif_name:"transferStart",notif_parameters:"transferStart"},"lf_web_in_win")},viewReadyFireWintopNotif:function(e){e.dispatchEvent("onDispatchToWin",{notif_name:"onViewReady",notif_parameters:'{ "action": "onViewReady" }'},"lf_web_in_win")},fireWintopCommand:function(e,n,i){var a=[];null!==n&&a.push({physicalid:n.id,id:n.id,displayName:n.displayName});var o=t.createJSONArrayAction(i,a);if(o.length>0){this.setCSOSelection(e,a),e.dispatchEvent("onDispatchToWin",{notif_name:"onCtxMenuClick",notif_parameters:o},"lf_web_in_win")}},onBuildWinContextMenu:function(e,t,i,a){for(var o,r=n.getWebappsBaseUrl()+"WebInWinHelper/assets/icons/32/",s=0;s<t.length;s++){var c=t[s];if(void 0===c.items){var l=c.actionId;if("Copy"!=l){var p=c.icon,d=(c.menu,c.text),h=c.accelerator;o=""==p||void 0===p?"":"url("+r+(p=p.replace(".png",""))+".png)",this.addMenuContextNode(e,i,l,d,h,o,a)}}else{var f=[];this.onBuildWinContextMenu(e,c.items,f,a);var u={title:c.text,submenu:f,type:"PushItem"};i.push(u)}}},addMenuContextNode:function(e,t,n,i,a,o,r){var s=this,c=n,l={callback:function(){s.fireWintopCommand(e,r,c)}};t.push({title:i,type:"PushItem",icon:o,action:l,accelerator:a})},launchWinRestoreIterations:function(e,n,i){var a=[];null!==n&&a.push({physicalid:n.physicalid}),null!==i&&a.push({physicalid:i.physicalid});var o=t.createJSONArrayAction("CATImmRestoreItertionCmd",a);o.length>0&&e.dispatchEvent("onDispatchToWin",{notif_name:"onCtxMenuClick",notif_parameters:o},"lf_web_in_win")},launchWinCompareIterations:function(e,t,n){var i=[];null!==t&&i.push({physicalid:t.physicalid,Name:"name1",Value:t.name}),null!==n&&i.push({physicalid:n.physicalid,Name:"name2",Value:n.name});var a=this.createJSONArrayActionWithArgs("CATImmCompareIterationBaseCmd",i);a.length>0&&e.dispatchEvent("onDispatchToWin",{notif_name:"onCtxMenuClick",notif_parameters:a},"lf_web_in_win")},sendGetLicenseNotif:function(e){e.dispatchEvent("onDispatchToWin",{notif_name:"controlLicense"},"lf_web_in_win")},sendModelLoadedNotif:function(e){e.dispatchEvent("onDispatchToWin",{notif_name:"modelLoaded"},"lf_web_in_win")},launchWinOpenIterations:function(e,t){var n={action:"CATImmOpenIterationCmd",Args:[]};if(0!=t.length){for(var i=0;i<t.length;i++){var a=i+1,o="name".concat(a),r="date".concat(a),s="physicalId".concat(a);n.Args.push({Name:o,Value:t[i].name},{Name:r,Value:t[i].date},{Name:s,Value:t[i].physicalid})}var c=JSON.stringify(n);c.length>0&&e.dispatchEvent("onDispatchToWin",{notif_name:"onCtxMenuClick",notif_parameters:c},"lf_web_in_win")}},launchWinCompare:function(e,n,i){var a=[];null!==i&&a.push({physicalid:i.id}),null!==n&&a.push({physicalid:n.id});var o=t.createJSONArrayAction("CATPLMCompareHdr",a);o.length>0&&e.dispatchEvent("onDispatchToWin",{notif_name:"onCtxMenuClick",notif_parameters:o},"lf_web_in_win")},getJSONArrayFromSelectionData:function(e,t,n){var i;if(null!==t&&void 0!==t.selectedNodes)for(i=0;i<t.selectedNodes.length;i++)n.push({physicalid:t.selectedNodes[i]._options.id,displayName:t.selectedNodes[i]._options.label})},fireWintopCommandWithArgs:function(e,n,i){var a,o=i,r=[];if(null!==n&&void 0!==n.selectedNodes)for(a=0;a<n.selectedNodes.length;a++)r.push({physicalid:n.selectedNodes[a]._options.id});var s=t.createJSONArrayAction(o,r);s.length>0&&e.dispatchEvent("onDispatchToWin",{notif_name:"onCtxMenuClick",notif_parameters:s},"lf_web_in_win")},fireWintopMaturityCompletedCommandWithArgs:function(e,t,n){var i,a=n,o=[],r=[],s="";if(t&&t.hasOwnProperty("data")&&null!==t.data)for(i=0;i<t.data.length;i++)o.push({Name:t.data[i].physicalid,Value:{fromstate:t.data[i].fromstate,tostate:t.data[i].tostate}});t&&t.hasOwnProperty("report")&&(r=t.report),t&&t.hasOwnProperty("status")&&(s=t.status);var c=this.createJSONArrayActionWithStates(a,o,r,s);c.length>0&&e.dispatchEvent("onDispatchToWin",{notif_name:"onCtxMenuClick",notif_parameters:c},"lf_web_in_win")},getServices:function(e){if(e.options.wintop){var t;t=void 0===e.options.platform_services?e.options.serverUrl:e.options.platform_services;var n={wintop:e.options.wintop,platform_services:t};return i.getInstance(n)}return i},initTenant:function(e){e.options.wintop&&void 0!==e.options.serverUrl&&e.options.serverUrl.length>0&&void 0!==e.options.serverUrl[0].platformId&&(e.tenant=e.options.serverUrl[0].platformId)},loadCssfile:function(e){var t=document.createElement("link");void 0!==t&&(t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),document.getElementsByTagName("head")[0].appendChild(t))}})}));