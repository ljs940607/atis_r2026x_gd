define("DS/MPFOrderListComponent/NoStatusSelectorTileElement",["UWA/Class/View","DS/MPFUtils/MPFUtils","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t){"use strict";let r;const s=e.extend({className:"mpf-hidden",render:function(){return this},setIsSelected:t.doNothing,updateCount:t.doNothing});return s.getInstance=function(){return r||(r=new s),r},s})),define("DS/MPFOrderListComponent/OrderListEvents",[],(function(){"use strict";return Object.freeze({FILTER_BY_STATE:"filterByState",FILTER_BY_DATE:"filterByDate",SORT:"sort",CLEAR_DATE_FILTER:"clearFilter",RE_ORDER:"reOrder",FORWARD:"forward",OPEN_CART:"openCart"})})),define("DS/MPFOrderListComponent/StatusProgressTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartItemModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t,r,s,i,n,o){"use strict";const a={CANCELLED:"0",SUBMITTED:"14",WAITING_PAYMENT:"29",PROCESSING_PAYMENT:"43",PAID:"58",PROCESSING:"72",READY:"86",SHIPPED:"86",DELIVERED:"100"};return t.extend({className:"mpf-status-progress",setup:function(t={}){this._parent(t),this._checkPrototypes(t),this.cart=t.cart,this.service=e.is(t.service)?t.service:s.MAKE},render:function(){return this.container.setContent([this._getProgressBarContainer(),this._getOrderStatusContainer()]),this},destroy:function(){this.cart=null,this._parent(),this.container=null},_getProgressBarContainer:function(){const t=this.cart.getGlobalState(),r=a[t],s=e.createElement("div",{class:"mpf-progress-bar",html:e.createElement("div",{class:"mpf-step-bar",styles:{width:r+"%"}})});if(t===i.GlobalStates.DELIVERED&&s.addClassName("complete"),t===i.GlobalStates.SHIPPED){const e=new Date;new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())-new Date(this.cart.getDeliveryDate())>0&&s.addClassName("late")}return s},_getOrderStatusContainer:function(){return e.createElement("div",{class:"mpf-status",html:[this._getIconContainer(),e.createElement("span",{class:"mpf-status-label",text:o.get(this.cart.getGlobalState().toLowerCase())})]})},_getIconContainer:function(){let t;const r=this.cart.getGlobalState();return r===i.GlobalStates.SUBMITTED?t="fonticon fonticon-right":r===i.GlobalStates.WAITING_PAYMENT?t="fonticon fonticon-survey":r===i.GlobalStates.PROCESSING_PAYMENT?t="fonticon fonticon-hourglass":r===i.GlobalStates.PAID?t="fonticon fonticon-check":r===i.GlobalStates.PROCESSING?t="fonticon fonticon-clock":r===i.GlobalStates.READY?t="fonticon fonticon-parcel-ok":r===i.GlobalStates.DELIVERED?t="fonticon fonticon-status-ok":r===i.GlobalStates.CANCELLED?t="fonticon fonticon-wrong":r===i.GlobalStates.SHIPPED&&(t="fonticon fonticon-truck-delivery"),e.createElement("span",{class:t})},_checkPrototypes:function(e){r.requiredOfPrototype(e.cart,i,"options.cart must be a CartModel")}})})),define("DS/MPFOrderListComponent/LegalEntityTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFError/BadArgumentError","DS/MPFFiniteStateMachine/FiniteStateMachine","DS/MPFCartModel/CartModel","DS/MPFTCContractModel/TCContractModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t,r,s,i,n,o,a){"use strict";const c=Object.freeze({BUYER:"buyer",SELLER:"seller",EMP:"emp"}),l=t.extend({className:"mpf-legal-entity-tile",setup:function(e){r.requiredOfPrototype(this.model,n,"this.model must be a CartModel"),this.isSeller=!0===e.isSeller,this.stateMachine=this._createStateMachine(e.state),this.logo=this._createLogo(),this.title=this._createTitle(),this.subtitle=this._createSubtitle()},render:function(){return this.isSeller?this.container.addClassName("seller"):this.container.addClassName("buyer"),this.container.setContent([this.logo&&e.createElement("div",{class:"first-column",html:this.logo}),e.createElement("div",{class:"second-column",html:[this.title,this.subtitle]})]),this},destroy:function(){this.model=null,this._parent(),this.container=null},_createLogo:function(){const t=this.stateMachine.getState();if(!this.isSeller||t!==c.SELLER)return e.createElement("span",{class:this.isSeller?"fonticon fonticon-factory":"fonticon fonticon-user"})},_createTitle:function(){let t;const r=this.stateMachine.getState();return t=this.isSeller&&r!==c.SELLER?this.model.getShopName():this.isSeller?"":this.model.getOwnerData().FirstName+" "+this.model.getOwnerData().LastName.toUpperCase(),e.createElement("div",{class:"mpf-legal-entity-name",text:t})},_createSubtitle:function(){let t="";const r=this.model.getContractDocuments();if(this.isSeller){if(this.isSeller&&r&&r.length>0){const e=this.model.getContractDocuments().filter((function(e){return e.documentType===o.DOCUMENT_TYPES.NDA&&e.currentState!==o.STATUS.archived}));if(e.length>0){const r=e[0].currentState;r===o.STATUS.draft?t+=a.get("NDA")+" - "+a.get("notSigned"):r===o.STATUS.inEffect&&(t+=a.get("NDA")+" - "+a.get("signed"))}}}else t+=this.model.getOwnerData().Company;return e.createElement("div",{class:"mpf-legal-entity-subtitle",text:t})},_createStateMachine:function(e){return new i({state:e,states:[c.BUYER,c.SELLER,c.EMP],transitions:[]})}});return l.States=c,l})),define("DS/MPFOrderListComponent/3DExperienceServiceTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t,r,s,i){"use strict";return t.extend({className:"mpf-3dexp-tile",setup:function(e={}){r.requiredOfPrototype(e.cart,s,"options.cart must be a CartModel"),this.cart=e.cart},render:function(){const t=this.cart.getActionType()===s.ActionTypes.RENEWAL?i.get("renewal"):i.get("order");return this.container.setContent([i.get("type")+" ",e.createElement("span",{class:"mpf-cart-type",text:t})]),this}})})),define("DS/MPFOrderListComponent/DetailItemsTile",["UWA/Core","UWA/Event","UWA/Class/View","DS/UIKIT/Input/Button","DS/MPFServices/ObjectService","DS/MPFFiniteStateMachine/FiniteStateMachine","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartItemCollection","DS/MPFDataProxy/NoDataProxy","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t,r,s,i,n,o,a,c,l){"use strict";const d=Object.freeze({DETAILS_DISPLAYED:"DETAILS_DISPLAYED",DETAILS_NOT_DISPLAYED:"DETAILS_NOT_DISPLAYED"}),h=r.extend({className:"mpf-detail-items",setup:function(e={}){this._parent(e),this._checkPrototypes(e),this.locale=e.locale||"fr-FR",this.cart=e.cart,this.cartItems=this.cart.getItems(),this.stateMachine=this._createStateMachine(),this.detailsButton=this._createDetailsButton(),this.table=this._createTable()},render:function(){return this.container.setContent([this.detailsButton,this.table]),this.table.hide(),this},destroy:function(){this.cart=null,this.cartItems=null,this._parent(),this.container=null},_createItemRow:function(t){const r=this.cart.getCurrency(),s=t.getUnitNetAmount().toLocaleString(this.locale,{style:"currency",currency:r,currencyDisplay:"code"}).replace(r,"").trim(),i=t.getUnitTaxesAmount().toLocaleString(this.locale,{style:"currency",currency:r,currencyDisplay:"code"}).replace(r,"").trim(),n=t.getTotalGrossAmount().toLocaleString(this.locale,{style:"currency",currency:r});return e.createElement("tr",{html:[e.createElement("td",{text:t.getProductDisplayName()}),e.createElement("td",{text:parseInt(t.getQuantity())}),e.createElement("td",{text:s}),e.createElement("td",{text:i}),e.createElement("td",{text:n})]})},_createTable:function(){return e.createElement("div",{class:"table-responsive",html:this._createTableContent()})},_createTableFooter:function(){return e.createElement("tfoot",{html:e.createElement("tr",{html:[e.createElement("td"),e.createElement("td"),e.createElement("td"),e.createElement("td",{text:l.get("total")}),e.createElement("td",{text:this.cart.getNetAmountTotal().toLocaleString(this.locale,{style:"currency",currency:this.cart.getCurrency()})+" "+l.get("taxExcludedAbbreviation")})]})})},_createTableBody:function(){return e.createElement("tbody",{html:this.cartItems.map((function(e){return this._createItemRow(e)}),this)})},_createTableHeader:function(){return e.createElement("thead",{html:e.createElement("tr",{html:[e.createElement("th",{text:l.get("item")}),e.createElement("th",{text:l.get("quantity")}),e.createElement("th",{text:l.get("unitPrice")}),e.createElement("th",{text:l.get("taxes")}),e.createElement("th",{text:l.get("totalAmountWithTaxes")})]})})},_createTableContent:function(){return e.createElement("table",{class:"table table-hover",html:[this._createTableHeader(),this._createTableBody(),this._createTableFooter()]})},_onClickHandler:function(e){t.stopPropagation(e);const r=this.stateMachine.getState();r===d.DETAILS_NOT_DISPLAYED&&(this.table.show(),this.detailsButton.setIcon("eye-off"),this.detailsButton.setValue(l.get("hideDetails")),this.stateMachine.changeState(d.DETAILS_DISPLAYED)),r===d.DETAILS_DISPLAYED&&(this.table.hide(),this.detailsButton.setIcon("eye"),this.detailsButton.setValue(l.get("details")),this.stateMachine.changeState(d.DETAILS_NOT_DISPLAYED)),this.detailsButton.setFocus(!1)},_createDetailsButton:function(){return new s({className:"link",icon:"eye",value:l.get("details"),events:{onClick:this._onClickHandler.bind(this)}})},_createStateMachine:function(){return new n({state:d.DETAILS_NOT_DISPLAYED,states:[d.DETAILS_DISPLAYED,d.DETAILS_NOT_DISPLAYED],transitions:[{from:d.DETAILS_DISPLAYED,to:d.DETAILS_NOT_DISPLAYED},{from:d.DETAILS_NOT_DISPLAYED,to:d.DETAILS_DISPLAYED}]})},_checkPrototypes:function(e){i.requiredOfPrototype(e.cart,o,"options.cart must be a CartModel")}});return h.States=d,h})),define("DS/MPFOrderListComponent/LastUpdateTile",["UWA/Core","UWA/Class/View","UWA/String","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartModelHelper","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t,r,s,i,n,o){"use strict";return t.extend({className:"mpf-order-last-update",setup:function(e={}){this._parent(e),this._checkPrototypes(e),this.cart=e.cart},render:function(){const t=e.createElement("span",{class:"mpf-last-update-label",text:o.get("lastUpdate")}),r=e.createElement("span",{class:"mpf-last-update-value",text:this._getLastUpdateTime()});return this.container.setContent([t,r]),this},_getLastUpdateTime:function(){return r.format(o.get("timeAgo"),n.getElapsedTime(this.cart.getLastUpdate()||this.cart.getCreated()))},_checkPrototypes:function(e){s.requiredOfPrototype(e.cart,i,"options.cart must be a CartModel")}})})),define("DS/MPFOrderListComponent/OrderIdTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t,r,s,i){"use strict";return t.extend({className:"mpf-order-id",setup:function(e={}){this._parent(e),this._checkPrototypes(e),this.cart=e.cart},render:function(){const e=[];return this.cart.isTender()&&e.push({tag:"span",class:"mpf-tender-icon"+(this.cart.isTenderResponse()?" mpf-tender-response":""),html:[{tag:"span",class:"fonticon fonticon-megaphone"}]}),e.push({tag:"span",class:"mpf-cart-name",text:this.cart.getName()}),this.container.setContent(e),this},_checkPrototypes:function(e){r.requiredOfPrototype(e.cart,s,"options.cart must be a CartModel")}})})),define("DS/MPFOrderListComponent/TenderInfoTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","DS/MPFView/GuidanceHelper","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent"],(function(e,t,r,s,i,n){"use strict";const o=Object.freeze({}),a=t.extend({className:"mpf-tender-info-tile",setup({cart:e}={}){r.requiredOfPrototype(e,s,"options.cart must be a CartModel"),this.cart=e,this.infoIconWithTooltip=this._createInfoIcon()},render(){const t=this.cart.getNumberSellers(),r=e.createElement("span",{class:"mpf-number mpf-blue",text:t||"?"}),s=parseInt(this.cart.getNumberAnswers()),i=e.createElement("span",{class:"mpf-number",text:s});return this.container.setContent([{tag:"div",class:"mpf-tender-info-line",html:[{tag:"span",class:"fonticon fonticon-factory mpf-info-line-icon"},{tag:"span",class:"mpf-label",html:1===parseInt(t)?n.get("oneServiceProviderNotified",{number:r.outerHTML}):n.get("xServiceProvidersNotified",{number:r.outerHTML})}]},{tag:"div",class:"mpf-tender-info-line",html:[{tag:"span",class:"fonticon fonticon-export-multiple mpf-info-line-icon"},{tag:"span",class:"mpf-label mpf-"+this._getQuoteNumberColor(parseInt(s)),html:[1===s?n.get("oneQuoteSent",{number:i.outerHTML}):n.get("nQuotesSent",{number:i.outerHTML}),this.infoIconWithTooltip]}]}]),this},destroy(){this._parent(),this.container=null},_getQuoteNumberColor(e){let t;return t=1===e?"orange":0===e?"red":"blue",t},_createInfoIcon:()=>new i({content:n.get("tenderQuotesTooltip"),useTooltip:!0})});return a.Events=o,a})),define("DS/MPFOrderListComponent/RequestStatusTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t,r,s,i){"use strict";const n=Object.freeze({ACTIVE:"active",FINISHED:"finished"}),o=t.extend({className:"mpf-request-status-tile",setup:function(e){r.requiredOfPrototype(e.cart,s,"options.cart must be a CartModel"),this.cart=e.cart},render:function(){return this.state=this._getState(),this.container.setContent([{tag:"span",class:"mpf-label",text:i.get("requestStatus")},{tag:"span",class:"mpf-status "+this.state,text:i.get(this.state)}]),this},destroy:function(){this.cart=null,this._parent(),this.container=null},_getState:function(){const e=this.cart.getState();return e===s.States.CANCELLED||e===s.States.FINISHED?n.FINISHED:n.ACTIVE}});return o.States=n,o})),define("DS/MPFOrderListComponent/PriceTile",["UWA/Core","UWA/Promise","UWA/Event","UWA/Class/View","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartModelHelper","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFInvoiceModel/InvoiceFactory","DS/MPFInvoiceModel/InvoiceModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t,r,s,i,n,o,a,c,l,d){"use strict";return s.extend({className:"mpf-price-tile",setup:function(t){o.requiredOfPrototype(t.cart,i,"options.cartItem must be a CartModel"),t.isSellerView&&t.cart.getGlobalState()===i.GlobalStates.DELIVERED&&o.requiredOfPrototype(t.invoiceFactory,c,"options.invoiceFactory must be a InvoiceFactory"),this.cart=t.cart,this.isSellerView=t.isSellerView,this.invoiceFactory=t.invoiceFactory,this.locale=t.locale||"fr-FR",this.service=e.is(t.service)?t.service:a.MAKE,this.price=this._createPrice(),this.taxComment=this._createTaxComment(),this.invoiceLink=this._createInvoiceLink()},render:function(){return this.container.setContent([this.price,this.taxComment,this.invoiceLink]),this},destroy:function(){this.cart=null,this._parent(),this.container=null},_createPrice:function(){let t;const r=this.cart.get(i.Fields.PRICE_MINIMUM),s=this.cart.get(i.Fields.PRICE_MAXIMUM),o=r<0&&s>=0,c=r>=0&&s>=0,l=r>=0&&s<0;return t=this.service===a.STORE||this.service===a.IFWELOOP?this._formatPrice(this.cart.getNetAmountTotal()):o?this._formatPrice(s):c?this._formatPrice(r,{noSymbol:!0})+"- "+this._formatPrice(s,{noSymbol:!0})+n.getCurrencySymbol(this.cart):l?this._formatPrice(r,{noSymbol:!0})+"+ "+n.getCurrencySymbol(this.cart):"-- "+n.getCurrencySymbol(this.cart),e.createElement("div",{class:"mpf-price-tile-price",text:t})},_formatPrice:function(e,t){return t||(t={}),t.locale=this.locale,n.formatPrice(this.cart,e,t)},_createTaxComment:function(){return e.createElement("div",{class:"mpf-price-tile-tax-comment",text:d.get("taxExcludedAbbreviation")})},_createInvoiceLink:function(){let t;return this.isSellerView&&this.cart.getGlobalState()===i.GlobalStates.DELIVERED&&(t=e.createElement("a",{href:"#",events:{click:function(e){r.stopPropagation(e)}}}),this._getInvoiceFromCartId().then((function(e){e&&(t.setAttributes({href:e.getInvoice(),download:e.getName()}),t.setText(d.get("commissionInvoice")))}))),t},_getInvoiceFromCartId:function(){const e=this.invoiceFactory.createCollection(c.Types.CART_INVOICE);return e.setParentResourceId(this.cart.id),e.fetchPromise().then((function(){return e.find((function(e){return e.getType()===l.Types.INVOICE}))}))}})})),define("DS/MPFOrderListComponent/StatusDateTile",["UWA/Core","UWA/Class/View","UWA/String","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartModelHelper","DS/MPFFiniteStateMachine/FiniteStateMachine","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t,r,s,i,n,o,a,c){"use strict";const l=Object.freeze({CREATION:"creation",DELIVERY:"delivery",DEADLINE:"deadline"}),d="DELIVERED",h=t.extend({className:"mpf-status-date",setup:function(e={}){this._parent(e),this._checkPrototypes(e),this.cart=e.cart,this.stateMachine=this._createStateMachine(e.state),this.service=e.service},render:function(){return this.stateMachine.getState()===l.CREATION?this.container.setContent(this._getCreationContent()):this.stateMachine.getState()===l.DELIVERY?this.container.setContent(this._getDeliveryContent()):this.stateMachine.getState()===l.DEADLINE&&this.container.setContent(this._getDeadlineContent()),this},destroy:function(){this.cart=null,this.stateMachine=null,this._parent(),this.container=null},_getCreationContent:function(){const t=this.cart.getCreated(),s=e.createElement("div",{class:"mpf-time",html:[c.get("created")+" ",e.createElement("span",{text:r.format(c.get("timeAgo"),o.getElapsedTime(t))})]}),i=e.createElement("div",{class:"mpf-date",text:"("+this._getDateString(t)+")"});return this.container.addClassName("creation"),[s,i]},_getDeliveryContent:function(){let t,s;const i=this.cart.getDeliveryDate();if(""===i){const r=e.createElement("span",{text:c.get("notSet")});t=e.createElement("div",{class:"mpf-time",html:c.get("deliveryNotSet",{notSet:r.outerHTML})}),s=e.createElement("div",{class:"mpf-date",html:"&nbsp;"})}else{const n=new Date;if(new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds())-new Date(i)<0){const r=e.createElement("span",{text:o.getRemainingTime(i)});t=e.createElement("div",{class:"mpf-time",html:c.get("deliveryIn",{time:r.outerHTML})})}else{const s=e.createElement("span",{text:r.format(c.get("timeAgo"),o.getElapsedTime(i))});this.cart.getGlobalState()===d?t=e.createElement("div",{class:"mpf-time",html:c.get("deliveryExpected",{timeAgo:s.outerHTML})}):(this.container.addClassName("attention"),t=e.createElement("div",{class:"mpf-time",html:[e.createElement("span",{class:"fonticon fonticon-attention"}),c.get("deliveryExpected",{timeAgo:s.outerHTML})]}))}s=e.createElement("div",{class:"mpf-date",text:"("+this._getDateString(i)+")"})}return this.container.addClassName("delivery"),[t,s]},_getDeadlineContent:function(){let t;const r=this.cart.getDeadlineDate(),s=new Date,i=new Date(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate(),s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds());if(new Date(r)-i>0){const s=e.createElement("span",{text:o.getRemainingTime(r)});t=e.createElement("div",{class:"mpf-time",html:c.get("endsIn",{time:s.outerHTML})})}else{const r=e.createElement("span",{text:c.get("ended")});t=e.createElement("div",{class:"mpf-time ended",html:r})}const n=e.createElement("div",{class:"mpf-date",text:"("+this._getDateString(r)+")"});return this.container.addClassName("deadline"),[t,n]},_getDateString:function(e){return new Date(e).toLocaleDateString("en-EN",{year:"numeric",month:"long",day:"numeric"})},_createStateMachine:function(e){return new a({state:e,states:[l.CREATION,l.DELIVERY],transitions:[]})},_checkPrototypes:function(e){s.requiredOfPrototype(e.cart,n,"options.cart must be a CartModel")}});return h.States=l,h})),define("DS/MPFOrderListComponent/StatusSelectorTileElement",["UWA/Core","UWA/Class/View"],(function(e,t){"use strict";return t.extend({className:"mpf-status-selector-tile-element",domEvents:{click:"onClick"},setup:function(e){this.title=e.title,this.setIsSelected(e.isSelected),this.container.addClassName(e.cssClass)},render:function({count:e=0}={}){return this.container.setContent([this._createTitleElement(),this._createCountElement({count:e})]),this},setIsSelected:function(e){this.isSelected=!0===e,this.isSelected?this.container.addClassName("mpf-selected"):this.container.removeClassName("mpf-selected")},onClick:function(){this.dispatchEvent("selected"),this.setIsSelected(!0)},destroy:function(){this._parent()},updateCount:function(e){this.countElement.setText("("+e+")")},_createTitleElement(){return e.createElement("p",{class:"mpf-title",text:this.title})},_createCountElement:({count:t})=>e.createElement("p",{class:"mpf-count",text:"("+t+")"})})})),define("DS/MPFOrderListComponent/PaymentDateTile",["UWA/Core","UWA/Class/View","UWA/String","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartModelHelper","DS/MPFFiniteStateMachine/FiniteStateMachine","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t,r,s,i,n,o,a){"use strict";const c=Object.freeze({PAID:"PAID",DUE_DATE:"DUE_DATE"}),l=t.extend({className:"mpf-payment-date",setup:function(e={}){this._parent(e),this._checkPrototypes(e),this.cart=e.cart,this.stateMachine=this._createStateMachine(e.state)},render:function(){return this.stateMachine.getState()===c.PAID?this.container.setContent(this._getPaidContent()):this.stateMachine.getState()===c.DUE_DATE&&this.container.setContent(this._getDueDateContent()),this},destroy:function(){this.cart=null,this._parent(),this.container=null},_getPaidContent:function(){const t=this.cart.getCreated(),s=e.createElement("div",{class:"mpf-time",html:[a.get("paidLabel")+" ",e.createElement("span",{text:r.format(a.get("timeAgo"),n.getElapsedTime(t))})]}),i=e.createElement("div",{class:"mpf-date",text:"("+this._getDateString(t)+")"});return this.container.addClassName("paid"),[s,i]},_getDueDateContent:function(){if(this.cart.getGlobalState()!==i.States.DELIVERED&&this.cart.getGlobalState()!==i.States.CANCELLED){const t=e.is(this.cart.get("dueDate"))&&""!==this.cart.get("dueDate")?n.getRemainingTime(this.cart.get("dueDate")):a.get("notSet"),r=e.createElement("div",{class:"mpf-time",html:a.get("dueDateIn",{time:e.createElement("span",{text:t}).outerHTML})}),s=e.createElement("div",{class:"mpf-date",text:e.is(this.cart.get("dueDate"))&&""!==this.cart.get("dueDate")?"("+this._getDateString(t)+")":""});return this.container.addClassName("due-date"),[r,s]}},_getDateString:function(e){const t={},r=new Date(e);return t.year="numeric",t.month="long",t.day="numeric",r.toLocaleDateString("en-EN",t)},_createStateMachine:function(e){return new o({state:e,states:[c.PAID,c.DUE_DATE],transitions:[]})},_checkPrototypes:function(e){s.requiredOfPrototype(e.cart,i,"options.cart must be a CartModel")}});return l.States=c,l})),define("DS/MPFOrderListComponent/NumberServiceProvidersTile",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCartModel/CartModel","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t,r,s,i){"use strict";return t.extend({className:"mpf-number-service-providers-tile",setup:function(e){r.requiredOfPrototype(e.cart,s,"options.cart must be a CartModel"),this.cart=e.cart},render:function(){const t=this.cart.getNumberSellers(),r=e.createElement("span",{class:"mpf-number",text:t||"?"});return this.container.setContent([{tag:"div",class:"first-column",html:[{tag:"span",class:"fonticon fonticon-factory"}]},{tag:"div",class:"second-column",html:[{tag:"div",class:"mpf-legal-entity-name",html:t>1?i.get("xServiceProvidersNotified",{number:r.outerHTML}):i.get("oneServiceProviderNotified",{number:r.outerHTML})}]}]),this},destroy:function(){this.cart=null,this._parent(),this.container=null}})})),define("DS/MPFOrderListComponent/StatusSelectorTile",["UWA/Class/View","DS/MPFOrderListComponent/StatusSelectorTileElement","DS/MPFOrderListComponent/NoStatusSelectorTileElement","DS/MPFCartModel/CartCollection","DS/MPFCartModel/CartFilters","DS/MPFOrderListComponent/OrderListEvents","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFView/EmptyView","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent"],(function(e,t,r,s,i,n,o,a,c,l){"use strict";return e.extend({className:"mpf-status-selector-tile",setup:function(e){o.requiredOfPrototype(e.carts,s,"options.carts must be a CartCollection"),this.carts=e.carts,this.statusSelectorInitValue=e.statusSelectorInitValue,this.service=e.service,this.pendingSelector=this._createPendingSelector(),this.deliveredSelector=this._createDeliveredSelector(),this.canceledSelector=this._createCanceledSelector(),this.allSelector=this._createAllSelector(),this.listenTo(this.pendingSelector,"selected",this._onPendingSelected.bind(this)),this.listenTo(this.deliveredSelector,"selected",this._onDeliveredSelected.bind(this)),this.listenTo(this.canceledSelector,"selected",this._onCanceledSelected.bind(this)),this.listenTo(this.allSelector,"selected",this._onAllSelected.bind(this)),this.listenTo(this.carts,"onReset",this.render.bind(this))},render:function(){return this.container.setContent([this.pendingSelector.render({count:this.carts.pending}),this.deliveredSelector.render({count:this.carts.delivered}),this.canceledSelector.render({count:this.carts.cancelled}),this.allSelector.render({count:this.carts.all})]),this},destroy:function(){this.stopListening(),this.pendingSelector.destroy(),this.deliveredSelector.destroy(),this.canceledSelector.destroy(),this.allSelector.destroy(),this.pendingSelector=null,this.deliveredSelector=null,this.canceledSelector=null,this.allSelector=null,this._parent(),this.container=null},_createPendingSelector:function(){return new t({title:l.get("pending"),isSelected:this.statusSelectorInitValue===i.STATE_PENDING_FILTER,cssClass:"pending"})},_createDeliveredSelector:function(){let e;return e=this.service===a.ENGINEERING?r.getInstance():new t({title:l.get("delivered"),isSelected:this.statusSelectorInitValue===i.STATE_DELIVERED_FILTER,cssClass:"delivered"}),e},_createCanceledSelector:function(){return new t({title:l.get("canceled"),isSelected:this.statusSelectorInitValue===i.STATE_CANCELED_FILTER,cssClass:"canceled"})},_createAllSelector:function(){return new t({title:l.get("all"),isSelected:this.statusSelectorInitValue===i.STATE_ALL_FILTER,cssClass:"all"})},_onPendingSelected:function(){this.deliveredSelector.setIsSelected(!1),this.canceledSelector.setIsSelected(!1),this.allSelector.setIsSelected(!1),this.dispatchEvent(n.FILTER_BY_STATE,{[i.FILTER_BY_STATE]:i.STATE_PENDING_FILTER})},_onDeliveredSelected:function(){this.pendingSelector.setIsSelected(!1),this.canceledSelector.setIsSelected(!1),this.allSelector.setIsSelected(!1),this.dispatchEvent(n.FILTER_BY_STATE,{[i.FILTER_BY_STATE]:i.STATE_DELIVERED_FILTER})},_onCanceledSelected:function(){this.pendingSelector.setIsSelected(!1),this.deliveredSelector.setIsSelected(!1),this.allSelector.setIsSelected(!1),this.dispatchEvent(n.FILTER_BY_STATE,{[i.FILTER_BY_STATE]:i.STATE_CANCELED_FILTER})},_onAllSelected:function(){this.pendingSelector.setIsSelected(!1),this.deliveredSelector.setIsSelected(!1),this.canceledSelector.setIsSelected(!1),this.dispatchEvent(n.FILTER_BY_STATE,{[i.FILTER_BY_STATE]:i.STATE_ALL_FILTER})}})})),define("DS/MPFOrderListComponent/OrderListCommandSort",["UWA/Class/View","DS/MPFOrderListComponent/OrderListEvents","DS/MPFCartModel/CartSorts","DS/MPFSort/SortOrder","DS/MPFSort/SortDirection","DS/MPFSortSelector/SortSelector","DS/MPFServices/MarketplaceServices","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent"],(function(e,t,r,s,i,n,o,a){"use strict";return e.extend({className:"mpf-order-list-command-sort",setup:function(e={}){this.company=e.company,this.me=e.me,this.isSellerView=e.isSellerView,this.service=e.service,this.sortSelector=this._createSortSelector({sortOptions:e.sortOptions}),this.listenTo(this.sortSelector,n.Events.SORT,this._onSortSelected.bind(this))},render:function(){return this.container.setContent([this.sortSelector.render()]),this},destroy:function(){this.company=null,this.me=null,this.stopListening(this.sortSelector),this.sortSelector.destroy(),this.sortSelector=null,this._parent(),this.container=null},_createSortSelector:function({sortOptions:e}){return new n({entries:this._createSortOptions({sortOptions:e})})},_createSortOptions:function({sortOptions:e}){let t;return t=this.isSellerView?this._createSortOptionForSeller({sortOptions:e}):this.company&&this.me.isAdminOfThisEMP(this.company.getEmpProjectName())?this._createSortOptionsForEmpAdmin({sortOptions:e}):this._createSortOptionForBuyer({sortOptions:e}),t},_onSortSelected:function(e){let s;s=e.direction===i.DESCENDING?r.desc(e.sort):e.sort,this.dispatchEvent(t.SORT,{sort:s})},_createSortOptionForBuyer:function({sortOptions:e=[r.MODIFICATION_DATE,r.CREATION_DATE,r.DELIVERY_DATE,r.SERVICE_PROVIDER]}={}){return e.map((e=>({label:a.get(e),name:e,order:e.endsWith("Date")&&s.NUMERICAL,selected:e===r.MODIFICATION_DATE&&i.DESCENDING})))},_createSortOptionForSeller:function(){const e=[{label:a.get("modificationDate"),name:r.MODIFICATION_DATE,order:s.NUMERICAL,selected:i.DESCENDING},{label:a.get("creationDate"),name:r.CREATION_DATE,order:s.NUMERICAL},{label:a.get("customer"),name:r.CUSTOMER}];return this.service!==o.ENGINEERING&&e.splice(2,0,{label:a.get("deliveryDate"),name:r.DELIVERY_DATE,order:s.NUMERICAL}),e},_createSortOptionsForEmpAdmin:function(){const e=[{label:a.get("modificationDate"),name:r.MODIFICATION_DATE,order:s.NUMERICAL,selected:i.DESCENDING},{label:a.get("creationDate"),name:r.CREATION_DATE,order:s.NUMERICAL},{label:a.get("customer"),name:r.CUSTOMER},{label:a.get("serviceProvider"),name:r.SERVICE_PROVIDER}];return this.service!==o.ENGINEERING&&e.splice(2,0,{label:a.get("deliveryDate"),name:r.DELIVERY_DATE,order:s.NUMERICAL}),e}})})),define("DS/MPFOrderListComponent/OrderCardBody",["UWA/Core","UWA/Class/View","UWA/Event","DS/UIKIT/Input/Button","DS/UIKIT/Tooltip","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFFiniteStateMachine/FiniteStateMachine","DS/MPFCartModel/CartModel","DS/MPFOrderListComponent/OrderListEvents","DS/MPFOrderListComponent/LegalEntityTile","DS/MPFOrderListComponent/NumberServiceProvidersTile","DS/MPFOrderListComponent/StatusDateTile","DS/MPFOrderListComponent/PaymentDateTile","DS/MPFOrderListComponent/PriceTile","DS/MPFOrderListComponent/TenderInfoTile","DS/MPFView/EmptyView","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t,r,s,i,n,o,a,c,l,d,h,u,m,S,p,E,T){"use strict";const C=Object.freeze({BUYER:"buyer",SELLER:"seller",EMP:"emp"}),D=t.extend({className:"mpf-order-card-body",setup:function(t={}){this._parent(t),this._checkPrototypes(t),this.isSellerView=!0===t.isSellerView,this.isOperator=!0===t.isOperator,this.serviceView=t.serviceView,this.cart=t.cart,this.invoiceFactory=t.invoiceFactory,this.service=e.is(t.service)?t.service:o.MAKE,this.stateMachine=this._createStateMachine(this.isSellerView),this.actorEntitiesTiles=this._createAppropriateActorEntitiesTiles(),this.statusDateTiles=this._createStatusDateTiles(),this.priceTile=this._createPriceTile(),this.platformNameTile=this._createPlatformNameTile()},render:function(){return this.container.setContent([this.serviceView.render(),{tag:"div",class:"mpf-actors-container",html:[this.actorEntitiesTiles.map((e=>e.render())),this.platformNameTile]},{tag:"div",class:"mpf-time-container",html:this.statusDateTiles.map((e=>e.render()))},this._createPriceAndReOrderContainer()]),this},_createStatusDateTiles:function(){let e;return this.cart.getDeadlineDate()?(e=[new u({state:u.States.DEADLINE,cart:this.cart})],this.cart.getDeliveryDate()?e.push(new u({state:u.States.DELIVERY,cart:this.cart,service:this.service})):e.push(new u({state:u.States.CREATION,cart:this.cart}))):e=this.service===o.ENGINEERING||this.service===o.INNOVATE?[new u({state:u.States.CREATION,cart:this.cart})]:this.service===o.STORE?[new m({state:m.States.PAID,cart:this.cart}),new m({state:m.States.DUE_DATE,cart:this.cart})]:[new u({state:u.States.DELIVERY,cart:this.cart,service:this.service}),new u({state:u.States.CREATION,cart:this.cart})],e},_createPriceTile:function(){return!this.cart.isTender()||this.cart.isTenderResponse()||this.cart.hasPrice()?new S({service:this.service,cart:this.cart,isSellerView:this.isSellerView,invoiceFactory:this.invoiceFactory}):this.isSellerView?new p({cart:this.cart}):new E({class:"mpf-pricing-tile"})},_createPriceAndReOrderContainer(){const e=this.cart.getGlobalState();return this.isReOrder=e===c.GlobalStates.DELIVERED||e===c.GlobalStates.SHIPPED,this.service!==o.MAKE||this.isSellerView||e===c.GlobalStates.CANCELLED||this.cart.isTender()&&!this.cart.isTenderResponse()||this.isOperator&&(!this.isOperator||this.isReOrder)?this.priceTile.render():{tag:"div",class:"mpf-price-reorder-container",html:[this.priceTile.render(),this._createReOrderButton()]}},_createReOrderButton(){const t=e.createElement("div",{class:"fonticon fonticon-info"});return this._createTooltip(t),e.createElement("div",{class:this.isReOrder?"mpf-reorder":"mpf-forward",html:[t,new s({className:"default",value:this.isReOrder?T.get("Re-order"):T.get("forwardAnotherProvider"),events:{onClick:this._reOrder.bind(this)}})]})},_createTooltip(e){return new i({target:e,trigger:"hover touch",body:this.isReOrder?T.get("reorderInfo"):T.get("forwardInfo")})},_reOrder(e){r.stopPropagation(e),this.isReOrder?this.dispatchEvent(l.RE_ORDER):this.dispatchEvent(l.FORWARD)},_createPlatformNameTile:function(){const t=this.service===o.INNOVATE,r=this.cart.getItems()[0]?this.cart.getItems()[0].getOnlineInstance():"";return t&&r&&!this.isSellerView?e.createElement("div",{html:r}):""},_createAppropriateActorEntitiesTiles:function(){const e=this.stateMachine.getState(),t=[];let r,s;return this.cart.getNumberSellers()?e===C.SELLER?(r=new d({isSeller:!1,model:this.cart,state:e}),t.push(r)):(s=new h({cart:this.cart}),t.push(s)):e===C.BUYER?(s=new d({isSeller:!0,model:this.cart,state:e}),t.push(s)):(e===C.SELLER||e===C.EMP)&&(r=new d({isSeller:!1,model:this.cart,state:e}),t.push(r),s=new d({isSeller:!0,model:this.cart,state:e}),t.push(s)),t},_createStateMachine:function(){let e;return e=null!==window.location.search.match(/esid=/)?C.EMP:this.isSellerView?C.SELLER:C.BUYER,new a({state:e,states:[C.BUYER,C.SELLER,C.EMP],transitions:[]})},_checkPrototypes:function(e){n.requiredOfPrototype(e.cart,c,"options.cart must be a CartModel")}});return D.States=C,D})),define("DS/MPFOrderListComponent/OrderCardHeader",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFCartModel/CartModel","DS/MPFOrderListComponent/OrderIdTile","DS/MPFOrderListComponent/LastUpdateTile","DS/MPFOrderListComponent/StatusProgressTile","DS/MPFOrderListComponent/RequestStatusTile","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t,r,s,i,n,o,a,c,l){"use strict";return t.extend({className:"mpf-order-card-header",setup:function(t={}){this._parent(t),this._checkPrototypes(t),this.cart=t.cart,this.service=e.is(t.service)?t.service:s.MAKE,this.orderIdTile=new n({cart:this.cart}),this.lastUpdateTile=new o({cart:this.cart}),this.cart.isTender()&&this.cart.getDeadlineDate()?this.statusProgressTile=new c({cart:this.cart}):this.statusProgressTile=new a({service:this.service,cart:this.cart})},render:function(){const e=[this.orderIdTile.render()];return this.service!==s.STORE&&e.push(this.lastUpdateTile.render()),this.container.setContent([{tag:"div",class:"mpf-order-card-header-content",html:[{tag:"div",class:"mpf-left-column",html:e},{tag:"div",class:"mpf-right-column",html:this.statusProgressTile.render()}]}]),this},_checkPrototypes:function(e){r.requiredOfPrototype(e.cart,i,"options.cart must be a CartModel")}})})),define("DS/MPFOrderListComponent/OrderListCommandFilter",["UWA/Core","UWA/Class/View","DS/UIKIT/DropdownMenu","DS/UIKIT/Tooltip","DS/MPFOrderListComponent/OrderListEvents","DS/MPFCartModel/CartFilters","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent"],(function(e,t,r,s,i,n,o){"use strict";const a={CLEAR:"clearFilter",CREATION_DATE_TODAY:"creationDateToday",CREATION_DATE_LAST_7_DAYS:"creationDateLast7Days",CREATION_DATE_LAST_30_DAYS:"creationDateLast30Days",CREATION_DATE_LAST_6_MONTHS:"creationDateLast6Months",MODIFICATION_DATE_TODAY:"modificationDateToday",MODIFICATION_DATE_LAST_7_DAYS:"modificationDateLast7Days",MODIFICATION_DATE_LAST_30_DAYS:"modificationDateLast30Days",MODIFICATION_DATE_LAST_6_MONTHS:"modificationDateLast6Months"};return t.extend({className:"mpf-order-list-command-filter",setup:function(){this.filterIcon=this._createFilterIcon(),this.filterMenu=this._createFilterMenu()},render:function(){return this.container.setContent([this.filterIcon]),this},destroy:function(){this._parent()},setActive:function(e){!0===e?this.filterIcon.addClassName("mpf-active"):this.filterIcon.removeClassName("mpf-active")},_createFilterIcon:function(){return e.createElement("div",{class:"fonticon fonticon-filter"})},_createFilterTooltip:function(e){return new s({target:this.filterIcon,body:e})},_createFilterMenu:function(){return new r({target:this.container,renderTo:this.container,multiSelect:!1,items:[{text:o.get("creationDate"),items:[{text:o.get("today"),name:a.CREATION_DATE_TODAY,selectable:!0},{text:o.get("lastXDays",{number:7}),name:a.CREATION_DATE_LAST_7_DAYS,selectable:!0},{text:o.get("lastXDays",{number:30}),name:a.CREATION_DATE_LAST_30_DAYS,selectable:!0},{text:o.get("lastXMonths",{number:6}),name:a.CREATION_DATE_LAST_6_MONTHS,selectable:!0}]},{text:o.get("modificationDate"),items:[{text:o.get("today"),name:a.MODIFICATION_DATE_TODAY,selectable:!0},{text:o.get("lastXDays",{number:7}),name:a.MODIFICATION_DATE_LAST_7_DAYS,selectable:!0},{text:o.get("lastXDays",{number:30}),name:a.MODIFICATION_DATE_LAST_30_DAYS,selectable:!0},{text:o.get("lastXMonths",{number:6}),name:a.MODIFICATION_DATE_LAST_6_MONTHS,selectable:!0}]},{text:o.get("clearFilter"),name:a.CLEAR,selectable:!0,fonticon:"trash"}],events:{onClick:this._onFilterSelected.bind(this)}})},_onFilterSelected:function(e,t){let r,s,o;switch(this._updateMenuSelection(t),t.name){case a.CREATION_DATE_TODAY:r=0,o=n.FILTER_BY_CREATION_DATE_DAYS;break;case a.CREATION_DATE_LAST_7_DAYS:r=7,o=n.FILTER_BY_CREATION_DATE_DAYS;break;case a.CREATION_DATE_LAST_30_DAYS:r=30,o=n.FILTER_BY_CREATION_DATE_DAYS;break;case a.CREATION_DATE_LAST_6_MONTHS:s=6,o=n.FILTER_BY_CREATION_DATE_MONTHS;break;case a.MODIFICATION_DATE_TODAY:r=0,o=n.FILTER_BY_MODIFICATION_DATE_DAYS;break;case a.MODIFICATION_DATE_LAST_7_DAYS:r=7,o=n.FILTER_BY_MODIFICATION_DATE_DAYS;break;case a.MODIFICATION_DATE_LAST_30_DAYS:r=30,o=n.FILTER_BY_MODIFICATION_DATE_DAYS;break;case a.MODIFICATION_DATE_LAST_6_MONTHS:s=6,o=n.FILTER_BY_MODIFICATION_DATE_MONTHS;break;case a.CLEAR:o=n.CLEAR}this.dispatchEvent(i.FILTER_BY_DATE,{filter:o,months:s,days:r}),this._updateTooltip(this._getTooltipText(t))},_updateMenuSelection:function(e){this.filterMenu.getSelectedItems().forEach((function(t){t!==e&&(t.elements.container.removeClassName("selected"),t.selected=!1)}))},_setFilterBlue:function(){this.filterIcon.classList.contains("mpf-active")||this.setActive(!0)},_setFilterGrey:function(){this.filterIcon.classList.contains("mpf-active")&&this.setActive(!1)},_getTooltipText:function(e){let t="";return e.name.includes("creation")?t=o.get("created")+" "+e.text.toLowerCase():e.name.includes("modification")&&(t=o.get("modified")+" "+e.text.toLowerCase()),t},_updateTooltip:function(e){this._needToCreateTooltip(e)?this.filterTooltip=this._createFilterTooltip(e):e?this.filterTooltip.setBody(e):this.filterTooltip&&this.filterTooltip.getBody()&&this.filterTooltip.destroy()},_needToCreateTooltip:function(e){return!(!e||this.filterTooltip)||!(!e||this.filterTooltip.getBody())}})})),define("DS/MPFOrderListComponent/OrderCard",["UWA/Core","UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFServices/MarketplaceServices","DS/MPFCartModel/CartModel","DS/MPFPersonModel/PersonModel","DS/MPFOrderListComponent/OrderListEvents","DS/MPFOrderListComponent/OrderCardHeader","DS/MPFOrderListComponent/OrderCardBody","DS/PlatformAPI/PlatformAPI","css!DS/MPFOrderListComponent/MPFOrderListComponent"],(function(e,t,r,s,i,n,o,a,c,l){"use strict";const d=Object.freeze({REFRESH_CARD:"refreshCard"}),h=t.extend({className:"mpf-order-card",domEvents:{click:"_goToOrder"},setup:function(t={}){this._parent(t),this._checkPrototypes(t),this.isSellerView=!0===t.isSellerView,this.isOperator=!0===t.isOperator,this.redirectToOrder=!1!==t.redirectToOrder,this.cart=t.cart,this.serviceView=t.serviceView,this.invoiceFactory=t.invoiceFactory,this.service=e.is(t.service)?t.service:s.MAKE,this.orderCardHeader=new a({isSellerView:this.isSellerView,service:this.service,cart:this.cart}),this.orderCardBody=new c({isSellerView:this.isSellerView,isOperator:this.isOperator,serviceView:this.serviceView,cart:this.cart,invoiceFactory:this.invoiceFactory,service:this.service}),this.orderCardFooter=t.orderCardFooter,this.service===s.MAKE&&(this.listenTo(this.orderCardBody,o.RE_ORDER,(()=>{this.dispatchEvent(o.RE_ORDER)})),this.listenTo(this.orderCardBody,o.FORWARD,(()=>{this.dispatchEvent(o.FORWARD)}))),this.listenTo(this.orderCardFooter,d.REFRESH_CARD,this._refreshCard.bind(this))},render:function(){return this.redirectToOrder||this.container.addClassName("no-cursor"),this.container.setContent([this.orderCardHeader.render(),this.orderCardBody.render(),this.orderCardFooter.render()]),this},destroy:function(){this.stopListening(),this.serviceView&&e.is(this.serviceView.destroy,"function")&&this.serviceView.destroy(),this.orderCardFooter&&e.is(this.orderCardFooter.destroy,"function")&&this.orderCardFooter.destroy(),this.serviceView=null,this.cart=null,this.nda=null,this._parent(),this.container=null},_goToOrder:function(){this.isOperator?this.dispatchEvent(o.OPEN_CART):l.publish("changePage",{name:"order",attributes:{id:this.cart.id}})},_checkPrototypes:function(e){r.requiredOfPrototype(e.cart,i,"options.cart must be a CartModel")},_refreshCard:function(e){e.cart&&this.cart.set(e.cart.pick(this.cart.keys())),this.render()}});return h.Events=Object.freeze(d),h})),define("DS/MPFOrderListComponent/OrderListCommands",["UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFExportOrderModel/ExportOrderFactory","DS/MPFBuyer/BuyerType","DS/MPFPersonModel/PersonModel","DS/MPFExportOrdersComponent/ExportOrdersComponent","DS/MPFView/EmptyView","DS/MPFOrderListComponent/OrderListCommandFilter","DS/MPFOrderListComponent/OrderListCommandSort","DS/MPFOrderListComponent/OrderListEvents"],(function(e,t,r,s,i,n,o,a,c,l){"use strict";return e.extend({className:"mpf-order-list-commands",setup:function(e){t.requiredOfPrototype(e.buyerType,s,"options.buyerType must be a BuyerType"),t.requiredOfPrototype(e.me,i,"options.me must be a PersonModel"),t.requiredOfPrototype(e.exportOrderFactory,r,"options.exportOrderFactory must be an ExportOrderFactory"),this.buyerType=e.buyerType,this.me=e.me,this.company=e.company,this.exportOrderFactory=e.exportOrderFactory,this.isSellerView=!0===e.isSellerView,this.service=e.service,this.exportCommand=this._createExportCommand(),this.filterCommand=this._createFilterCommand(),this.sortCommand=this._createSortCommand({sortOptions:e.sortOptions}),this.listenTo(this.filterCommand,l.FILTER_BY_DATE,this._onFilterByDate.bind(this)),this.listenTo(this.sortCommand,l.SORT,this._onSort.bind(this))},render:function(){return this.container.setContent([this.exportCommand.render(),this.filterCommand.render(),this.sortCommand.render()]),this},destroy:function(){this.stopListening(this.filterCommand),this.stopListening(this.sortCommand),this.filterCommand.destroy(),this.filterCommand=null,this.sortCommand.destroy(),this.sortCommand=null,this._parent()},setFilterActive:function(e){this.filterCommand.setActive(e)},_createExportCommand:function(){return this.isSellerView?new o:new n({buyerType:this.buyerType,me:this.me,company:this.company,exportOrderFactory:this.exportOrderFactory,layoutV2:!0})},_createFilterCommand:function(){return new a},_createSortCommand:function({sortOptions:e}){return new c({company:this.company,me:this.me,isSellerView:this.isSellerView,service:this.service,sortOptions:e})},_onFilterByDate:function(e){this.dispatchEvent(l.FILTER_BY_DATE,e)},_onSort:function(e){this.dispatchEvent(l.SORT,e)}})})),define("DS/MPFOrderListComponent/OrderListHeader",["UWA/Class/View","DS/MPFServices/ObjectService","DS/MPFCartModel/CartCollection","DS/MPFExportOrderModel/ExportOrderFactory","DS/MPFBuyer/BuyerType","DS/MPFPersonModel/PersonModel","DS/MPFOrderListComponent/StatusSelectorTile","DS/MPFOrderListComponent/OrderListCommands","DS/MPFOrderListComponent/OrderListEvents"],(function(e,t,r,s,i,n,o,a,c){"use strict";return e.extend({className:"mpf-order-list-header",setup:function(e={}){t.requiredOfPrototype(e.carts,r,"options.carts must be a CartCollection"),t.requiredOfPrototype(e.buyerType,i,"options.buyerType must be a BuyerType"),t.requiredOfPrototype(e.me,n,"options.me must be a PersonModel"),t.requiredOfPrototype(e.exportOrderFactory,s,"options.exportOrderFactory must be an ExportOrderFactory"),this.carts=e.carts,this.buyerType=e.buyerType,this.me=e.me,this.company=e.company,this.exportOrderFactory=e.exportOrderFactory,this.isSellerView=!0===e.isSellerView,this.service=e.service,this.statusSelectorTile=this._createStatusSelectorTile(e.statusSelectorInitValue),this.commands=this._createCommands({sortOptions:e.sortOptions}),this.stateFilter="all",this.listenTo(this.statusSelectorTile,c.FILTER_BY_STATE,this._onFilterByState.bind(this)),this.listenTo(this.commands,c.FILTER_BY_DATE,this._onFilterByDate.bind(this)),this.listenTo(this.commands,c.SORT,this._onSort.bind(this))},render:function(){return this.container.setContent([this.statusSelectorTile.render(),this.commands.render()]),this},destroy:function(){this.stopListening(this.statusSelectorTile),this.stopListening(this.commands),this.statusSelectorTile.destroy(),this.statusSelectorTile=null,this.commands.destroy(),this.commands=null,this._parent()},setFilterActive:function(e){this.commands.setFilterActive(e)},_createStatusSelectorTile:function(e){return new o({carts:this.carts,statusSelectorInitValue:e,service:this.service})},_createCommands:function({sortOptions:e}){return new a({buyerType:this.buyerType,me:this.me,company:this.company,exportOrderFactory:this.exportOrderFactory,isSellerView:this.isSellerView,service:this.service,sortOptions:e})},_onFilterByState:function(e){this.dispatchEvent(c.FILTER_BY_STATE,e)},_onFilterByDate:function(e){this.dispatchEvent(c.FILTER_BY_DATE,e)},_onSort:function(e){this.dispatchEvent(c.SORT,e)}})})),define("DS/MPFOrderListComponent/OrderListPage",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/PlatformAPI/PlatformAPI","DS/MPFServices/MarketplaceServices","DS/MPFCartModel/CartCollection","DS/MPFCartModel/CartFilters","DS/MPFCartModel/CartSorts","DS/MPFExportOrderModel/ExportOrderFactory","DS/MPFBuyer/Buyer","DS/MPFBuyer/BuyerType","DS/MPFPersonModel/PersonModel","DS/MPFServices/ObjectService","DS/MPFOrderListComponent/OrderListHeader","DS/MPFOrderListComponent/OrderCard","DS/MPFPaginationComponent/PaginationComponent","DS/MPFOrderListComponent/OrderListEvents","DS/MPFView/EmptyView","DS/MPFUtils/MPFUtils","i18n!DS/MPFOrderListComponent/assets/nls/OrderListComponent"],(function(e,t,r,s,i,n,o,a,c,l,d,h,u,m,S,p,E,T,C,D){"use strict";const _="MPF_ORDER_LIST",f=t.extend({className:"mpf-order-list-page",setup:function(t){u.requiredOfPrototype(t.carts,n,"options.carts must be a CartCollection"),u.requiredOfPrototype(t.me,h,"options.me must be a PersonModel"),u.requiredOfPrototype(t.exportOrderFactory,c,"options.exportOrderFactory must be an ExportOrderFactory"),this.isSellerView=!0===t.isSellerView,this.redirectToOrder=!1!==t.redirectToOrder,this.carts=t.carts,this.buyerType=t.buyerType,this.me=t.me,this.legalEntityId=t.legalEntityId,this.company=t.company,this.invoiceFactory=t.invoiceFactory,this.exportOrderFactory=t.exportOrderFactory,this.serviceViewFactory="function"==typeof t.serviceViewFactory?t.serviceViewFactory:C.doNothing,this.orderCardFooterFactory="function"==typeof t.orderCardFooterFactory?t.orderCardFooterFactory:C.doNothing,this.service=e.is(t.service)?t.service:i.MAKE,this.statusSelectorInitValue=e.is(t.statusSelectorInitValue)?t.statusSelectorInitValue:o.STATE_PENDING_FILTER,this.header=this._createHeader(),this.pagination=this._createPagination(),this.fetchOptions={reset:!0,start:0,size:10,company:this.legalEntityId},this.fetchOptions[o.FILTER_BY_STATE]=this.statusSelectorInitValue,this.listenTo(this.header,E.FILTER_BY_STATE,this._onFilterByState.bind(this)),this.listenTo(this.header,E.FILTER_BY_DATE,this._onFilterByDate.bind(this)),this.listenTo(this.header,E.SORT,this._onSort.bind(this)),this.listenTo(this.pagination,p.Events.CHANGE_PAGE,this._onChangePage.bind(this)),s.subscribe("SearchBar/search",this._onTopBarSearch.bind(this)),s.subscribe("SearchBar/clear",this._onTopBarClear.bind(this))},render:function(){let e;return this.carts.isEmpty()?e=[this._createEmptyListMessage()]:(e=this._createOrderCards().map((function(e){return e.render()})),e.push(this.pagination.render())),e.unshift(this.header.render()),this.container.setContent(e),this},operatorSearch(e={}){this._resetPage(),Object.keys(e).forEach((t=>{this.fetchOptions[t]=e[t]})),this._refreshCarts()},destroy:function(){this.stopListening(this.header),this.stopListening(this.pagination),s.unsubscribe("SearchBar/search"),s.unsubscribe("SearchBar/clear"),this.header.destroy(),this.header=null,this.pagination.destroy(),this.pagination=null,this.carts=null,this.me=null,this._parent(),this.container=null},refresh:function(){return this._refreshCarts()},_createHeader:function(){return new m({carts:this.carts,buyerType:this.buyerType,me:this.me,company:this.company,exportOrderFactory:this.exportOrderFactory,isSellerView:this.isSellerView,statusSelectorInitValue:this.statusSelectorInitValue,service:this.service})},_createEmptyListMessage:function(){return e.createElement("div",{class:"mpf-message",html:[{tag:"i",class:"fonticon fonticon-doc-log"},{tag:"h4",text:D.get("orderListEmpty")},{tag:"p",text:D.get("noOrdersMatchingSearchCriteria")}]})},_createOrderCards:function(){return this.carts.map((function(e){const t=this.serviceViewFactory({cart:e}),r=this.orderCardFooterFactory({cart:e}),s=new S({isSellerView:this.isSellerView,cart:e,serviceView:t||T.getInstance(),orderCardFooter:r||T.getInstance(),invoiceFactory:this.invoiceFactory,service:this.service,redirectToOrder:this.redirectToOrder,isOperator:this.me.isDSOperator()});return this.service===i.MAKE&&(this.listenTo(s,E.RE_ORDER,(()=>{this.dispatchEvent(E.RE_ORDER,{cart:e})})),this.listenTo(s,E.FORWARD,(()=>{this.dispatchEvent(E.FORWARD,{cart:e})})),this.listenTo(s,E.OPEN_CART,(()=>{this.dispatchEvent(E.OPEN_CART,{cart:e})}))),s}),this)},_createPagination:function(){return new p({collection:this.carts,pageSize:10})},_refreshCarts:function(){return r.mask(this.container),this.carts.fetchPromise(e.clone(this.fetchOptions)).then(this.render.bind(this)).finally(r.unmask.bind(null,this.container))},_onFilterByState:function(e){this._resetPage(),this.fetchOptions[o.FILTER_BY_STATE]=e[o.FILTER_BY_STATE],s.publish(_,{filter:o.FILTER_BY_STATE,value:e[o.FILTER_BY_STATE]}),this._refreshCarts()},_onFilterByDate:function(e){switch(this._resetPage(),e.filter){case o.FILTER_BY_CREATION_DATE_DAYS:this._resetDateFilter(),this.fetchOptions[o.FILTER_BY_CREATION_DATE_DAYS]=e.days,this.header.setFilterActive(!0);break;case o.FILTER_BY_CREATION_DATE_MONTHS:this._resetDateFilter(),this.fetchOptions[o.FILTER_BY_CREATION_DATE_MONTHS]=e.months,this.header.setFilterActive(!0);break;case o.FILTER_BY_MODIFICATION_DATE_DAYS:this._resetDateFilter(),this.fetchOptions[o.FILTER_BY_MODIFICATION_DATE_DAYS]=e.days,this.header.setFilterActive(!0);break;case o.FILTER_BY_MODIFICATION_DATE_MONTHS:this._resetDateFilter(),this.fetchOptions[o.FILTER_BY_MODIFICATION_DATE_MONTHS]=e.months,this.header.setFilterActive(!0);break;case o.CLEAR:this._resetDateFilter(),this.header.setFilterActive(!1)}this._refreshCarts()},_resetDateFilter:function(){this.header.setFilterActive(!1),this.fetchOptions[o.FILTER_BY_CREATION_DATE_MONTHS]=null,this.fetchOptions[o.FILTER_BY_CREATION_DATE_DAYS]=null,this.fetchOptions[o.FILTER_BY_MODIFICATION_DATE_DAYS]=null,this.fetchOptions[o.FILTER_BY_MODIFICATION_DATE_MONTHS]=null},_onSort:function(e){this._resetPage(),e&&e.sort?this.fetchOptions[a.SORT]=e.sort:this.fetchOptions[a.SORT]=null,this._refreshCarts()},_onChangePage:function(e){e||(e={});const t=e.page||1;this.fetchOptions.start=10*(t-1),this.header.container.scrollIntoView(!1),this._refreshCarts()},_resetPage:function(){this.pagination.changePage(1,{silent:!0}),this.fetchOptions.start=0},_onTopBarSearch:function(e){this._resetPage(),this.fetchOptions.search=e,this._refreshCarts()},_onTopBarClear:function(){this._resetPage(),this.fetchOptions.search="",this._refreshCarts()}});return f.ORDER_PER_PAGE=10,f.TOPIC=_,f})),define("DS/MPFOrderListComponent/OrderListPageFactory",["UWA/Promise","DS/MPFOrderListComponent/OrderListPage","DS/MPFDataProxy/MarketplaceConnector","DS/MPFModelFactory/MPFFactoriesV2","DS/MPFCartModel/CartFactory","DS/MPFPersonModel/PersonFactory","DS/MPFCompanyModel/CompanyFactory","DS/MPFCartModel/CartModel","DS/MPFCartModel/CartFilters","DS/MPFModel/CollectionFetchOptions","DS/MPFBuyer/Buyer","DS/MPFBuyer/BuyerType"],(function(e,t,r,s,i,n,o,a,c,l,d,h){"use strict";function u(e){const t=s.getInstance(e);return Promise.all([t.getFactory(s.Types.CART),t.getFactory(s.Types.PERSON),t.getFactory(s.Types.EXPORT_ORDER)])}function m(e){const t=s.getInstance(e);return Promise.all([t.getFactory(s.Types.CART),t.getFactory(s.Types.PERSON),t.getFactory(s.Types.EXPORT_ORDER),t.getFactory(s.Types.INVOICE)])}function S(e,t){const r=t[0],s=t[1],i=t[2];return Promise.all([T(r,e),E(s),i]).then((function(e){const t=e[0],r=e[1],s=e[2];return Promise.all([t,r,s,d.fromPerson(r),false])}))}function p(e,t){const r=t[0],s=t[1],i=t[2],n=t[3];return Promise.all([C(e,r),E(s),i]).then((function(e){const t=e[0],r=e[1],s=e[2];return Promise.all([t,r,s,d.fromPerson(r),true,n])}))}function E(e){return e.createModel(n.Types.ME).fetchPromise()}function T(e,r){return e.createCollection(i.Types.ME_V2).fetchPromise({[c.FILTER_BY_STATE]:c.STATE_PENDING_FILTER,[l.COMPANY]:r,expand:[a.Expands.CART_ITEMS],start:0,size:t.ORDER_PER_PAGE})}function C(e,r){const s=r.createCollection(i.Types.SELLER_CARTV2);return s.setParentResourceId(e),s.fetchPromise({[c.FILTER_BY_STATE]:c.STATE_PENDING_FILTER,expand:[a.Expands.CART_ITEMS],start:0,size:t.ORDER_PER_PAGE})}function D(e,r){const s=r[0],i=r[1],n=r[2],o=r[3],a=r[4],c=r[5],l=o.getBuyerType(),d={service:e.service,carts:s,me:i,buyerType:l,exportOrderFactory:n,serviceViewFactory:e.serviceViewFactory,orderCardFooterFactory:e.orderCardFooterFactory,isSellerView:a,invoiceFactory:c,legalEntityId:e.legalEntityId};return l===h.COMPANY&&(d.company=o.getModel()),new t(d)}return{fromMeBuyer:function(e={}){const t={service:e.service,serviceViewFactory:e.serviceViewFactory,orderCardFooterFactory:e.orderCardFooterFactory,legalEntityId:e.legalEntityId};return r.fetchPromise(e).then(u).then(S.bind(null,e.legalEntityId)).then(D.bind(null,t))},fromSeller:function(e={}){const t={service:e.service,serviceViewFactory:e.serviceViewFactory,orderCardFooterFactory:e.orderCardFooterFactory},s=e.shopId;return r.fetchPromise(e).then(m).then(p.bind(null,s)).then(D.bind(null,t))}}}));