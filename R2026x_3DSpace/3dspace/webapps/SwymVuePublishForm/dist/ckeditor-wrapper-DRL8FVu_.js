define("DS/SwymVuePublishForm/ckeditor-wrapper-DRL8FVu_",["exports","DS/SwymVuePublishForm/vue.amd","./publish-form-vue-BKQGyVzh"],function(Le,se,w){"use strict";var B0,O0;function z0(i,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in i)){const o=Object.getOwnPropertyDescriptor(n,s);o&&Object.defineProperty(i,s,o.get?o:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let I;try{I={window,document}}catch{/* istanbul ignore next -- @preserve */I={window:{},document:{}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function H0(){try{return navigator.userAgent.toLowerCase()}catch{return""}}const _n=H0(),$={isMac:cu(_n),isWindows:W0(_n),isGecko:j0(_n),isSafari:q0(_n),isiOS:G0(_n),isAndroid:K0(_n),isBlink:Z0(_n),get isMediaForcedColors(){return Y0()},get isMotionReduced(){return X0()},features:{isRegExpUnicodePropertySupported:J0()}};function cu(i){return i.indexOf("macintosh")>-1}function W0(i){return i.indexOf("windows")>-1}function j0(i){return!!i.match(/gecko\/\d+/)}function q0(i){return i.indexOf(" applewebkit/")>-1&&i.indexOf("chrome")===-1}function G0(i){return!!i.match(/iphone|ipad/i)||cu(i)&&navigator.maxTouchPoints>0}function K0(i){return i.indexOf("android")>-1}function Z0(i){return i.indexOf("chrome/")>-1&&i.indexOf("edge/")<0}function J0(){let i=!1;try{i="ć".search(new RegExp("[\\p{L}]","u"))===0}catch{}return i}function Y0(){return I.window.matchMedia?I.window.matchMedia("(forced-colors: active)").matches:!1}function X0(){return I.window.matchMedia?I.window.matchMedia("(prefers-reduced-motion)").matches:!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function uu(i,e,t,n){t=t||function(l,c){return l===c};const s=Array.isArray(i)?i:Array.prototype.slice.call(i),o=Array.isArray(e)?e:Array.prototype.slice.call(e),r=Q0(s,o,t);return n?tw(r,o.length):ew(o,r)}function Q0(i,e,t){const n=du(i,e,t);if(n===-1)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const s=hu(i,n),o=hu(e,n),r=du(s,o,t),a=i.length-r,l=e.length-r;return{firstIndex:n,lastIndexOld:a,lastIndexNew:l}}function du(i,e,t){for(let n=0;n<Math.max(i.length,e.length);n++)if(i[n]===void 0||e[n]===void 0||!t(i[n],e[n]))return n;return-1}function hu(i,e){return i.slice(e).reverse()}function ew(i,e){const t=[],{firstIndex:n,lastIndexOld:s,lastIndexNew:o}=e;return o-n>0&&t.push({index:n,type:"insert",values:i.slice(n,o)}),s-n>0&&t.push({index:n+(o-n),type:"delete",howMany:s-n}),t}function tw(i,e){const{firstIndex:t,lastIndexOld:n,lastIndexNew:s}=i;if(t===-1)return Array(e).fill("equal");let o=[];return t>0&&(o=o.concat(Array(t).fill("equal"))),s-t>0&&(o=o.concat(Array(s-t).fill("insert"))),n-t>0&&(o=o.concat(Array(n-t).fill("delete"))),s<e&&(o=o.concat(Array(e-s).fill("equal"))),o}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ki(i,e,t){t=t||function(g,b){return g===b};const n=i.length,s=e.length;if(n>200||s>200||n+s>300)return Ki.fastDiff(i,e,t,!0);let o,r;if(s<n){const g=i;i=e,e=g,o="delete",r="insert"}else o="insert",r="delete";const a=i.length,l=e.length,c=l-a,u={},d={};function h(g){const b=(d[g-1]!==void 0?d[g-1]:-1)+1,_=d[g+1]!==void 0?d[g+1]:-1,T=b>_?-1:1;u[g+T]&&(u[g]=u[g+T].slice(0)),u[g]||(u[g]=[]),u[g].push(b>_?o:r);let O=Math.max(b,_),B=O-g;for(;B<a&&O<l&&t(i[B],e[O]);)B++,O++,u[g].push("equal");return O}let f=0,m;do{for(m=-f;m<c;m++)d[m]=h(m);for(m=c+f;m>c;m--)d[m]=h(m);d[c]=h(c),f++}while(d[c]!==l);return u[c].slice(1)}Ki.fastDiff=uu;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function fu(){return function i(){i.called=!0}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ht{constructor(e,t){this.source=e,this.name=t,this.path=[],this.stop=fu(),this.off=fu()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Se=new Array(256).fill("").map((i,e)=>("0"+e.toString(16)).slice(-2));function it(){const i=Math.random()*4294967296>>>0,e=Math.random()*4294967296>>>0,t=Math.random()*4294967296>>>0,n=Math.random()*4294967296>>>0;return"e"+Se[i>>0&255]+Se[i>>8&255]+Se[i>>16&255]+Se[i>>24&255]+Se[e>>0&255]+Se[e>>8&255]+Se[e>>16&255]+Se[e>>24&255]+Se[t>>0&255]+Se[t>>8&255]+Se[t>>16&255]+Se[t>>24&255]+Se[n>>0&255]+Se[n>>8&255]+Se[n>>16&255]+Se[n>>24&255]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const We={get(i="normal"){return typeof i!="number"?this[i]||this.normal:i},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function mu(i,e){const t=We.get(e.priority);for(let n=0;n<i.length;n++)if(We.get(i[n].priority)<t){i.splice(n,0,e);return}i.push(e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const nw="https://ckeditor.com/docs/ckeditor5/latest/support/error-codes.html";class p extends Error{constructor(e,t,n){super(iw(e,n)),this.name="CKEditorError",this.context=t,this.data=n}is(e){return e==="CKEditorError"}static rethrowUnexpectedError(e,t){if(e.is&&e.is("CKEditorError"))throw e;const n=new p(e.message,t);throw n.stack=e.stack,n}}function Q(i,e){console.warn(...sw(i,e))}function gu(i){return`
Read more: ${nw}#error-${i}`}function iw(i,e){const t=new WeakSet,s=e?` ${JSON.stringify(e,(r,a)=>{if(typeof a=="object"&&a!==null){if(t.has(a))return`[object ${a.constructor.name}]`;t.add(a)}return a})}`:"",o=gu(i);return i+s+o}function sw(i,e){const t=gu(i);return e?[i,e,t]:[i,t]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const ow="41.4.2",rw=new Date(2024,4,17);/* istanbul ignore next -- @preserve */if(globalThis.CKEDITOR_VERSION)throw new p("ckeditor-duplicated-modules",null);globalThis.CKEDITOR_VERSION=ow;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const ti=Symbol("listeningTo"),ba=Symbol("emitterId"),Wt=Symbol("delegations"),pu=ee(Object);function ee(i){if(!i)return pu;class e extends i{on(n,s,o){this.listenTo(this,n,s,o)}once(n,s,o){let r=!1;const a=(l,...c)=>{r||(r=!0,l.off(),s.call(this,l,...c))};this.listenTo(this,n,a,o)}off(n,s){this.stopListening(this,n,s)}listenTo(n,s,o,r={}){let a,l;this[ti]||(this[ti]={});const c=this[ti];wa(n)||bu(n);const u=wa(n);(a=c[u])||(a=c[u]={emitter:n,callbacks:{}}),(l=a.callbacks[s])||(l=a.callbacks[s]=[]),l.push(o),uw(this,n,s,o,r)}stopListening(n,s,o){const r=this[ti];let a=n&&wa(n);const l=r&&a?r[a]:void 0,c=l&&s?l.callbacks[s]:void 0;if(!(!r||n&&!l||s&&!c))if(o)va(this,n,s,o),c.indexOf(o)!==-1&&(c.length===1?delete l.callbacks[s]:va(this,n,s,o));else if(c){for(;o=c.pop();)va(this,n,s,o);delete l.callbacks[s]}else if(l){for(s in l.callbacks)this.stopListening(n,s);delete r[a]}else{for(a in r)this.stopListening(r[a].emitter);delete this[ti]}}fire(n,...s){try{const o=n instanceof Ht?n:new Ht(this,n),r=o.name;let a=_u(this,r);if(o.path.push(this),a){const c=[o,...s];a=Array.from(a);for(let u=0;u<a.length&&(a[u].callback.apply(this,c),o.off.called&&(delete o.off.called,this._removeEventListener(r,a[u].callback)),!o.stop.called);u++);}const l=this[Wt];if(l){const c=l.get(r),u=l.get("*");c&&vu(c,o,s),u&&vu(u,o,s)}return o.return}catch(o){/* istanbul ignore next -- @preserve */p.rethrowUnexpectedError(o,this)}}delegate(...n){return{to:(s,o)=>{this[Wt]||(this[Wt]=new Map),n.forEach(r=>{const a=this[Wt].get(r);a?a.set(s,o):this[Wt].set(r,new Map([[s,o]]))})}}}stopDelegating(n,s){if(this[Wt])if(!n)this[Wt].clear();else if(!s)this[Wt].delete(n);else{const o=this[Wt].get(n);o&&o.delete(s)}}_addEventListener(n,s,o){cw(this,n);const r=_a(this,n),a=We.get(o.priority),l={callback:s,priority:a};for(const c of r)mu(c,l)}_removeEventListener(n,s){const o=_a(this,n);for(const r of o)for(let a=0;a<r.length;a++)r[a].callback==s&&(r.splice(a,1),a--)}}return e}["on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(i=>{ee[i]=pu.prototype[i]});function aw(i,e){const t=i[ti];return t&&t[e]?t[e].emitter:null}function bu(i,e){i[ba]||(i[ba]=e||it())}function wa(i){return i[ba]}function wu(i){return i._events||Object.defineProperty(i,"_events",{value:{}}),i._events}function lw(){return{callbacks:[],childEvents:[]}}function cw(i,e){const t=wu(i);if(t[e])return;let n=e,s=null;const o=[];for(;n!==""&&!t[n];)t[n]=lw(),o.push(t[n]),s&&t[n].childEvents.push(s),s=n,n=n.substr(0,n.lastIndexOf(":"));if(n!==""){for(const r of o)r.callbacks=t[n].callbacks.slice();t[n].childEvents.push(s)}}function _a(i,e){const t=wu(i)[e];if(!t)return[];let n=[t.callbacks];for(let s=0;s<t.childEvents.length;s++){const o=_a(i,t.childEvents[s]);n=n.concat(o)}return n}function _u(i,e){let t;return!i._events||!(t=i._events[e])||!t.callbacks.length?e.indexOf(":")>-1?_u(i,e.substr(0,e.lastIndexOf(":"))):null:t.callbacks}function vu(i,e,t){for(let[n,s]of i){s?typeof s=="function"&&(s=s(e.name)):s=e.name;const o=new Ht(e.source,s);o.path=[...e.path],n.fire(o,...t)}}function uw(i,e,t,n,s){e._addEventListener?e._addEventListener(t,n,s):i._addEventListener.call(e,t,n,s)}function va(i,e,t,n){e._removeEventListener?e._removeEventListener(t,n):i._removeEventListener.call(e,t,n)}var yu=typeof global=="object"&&global&&global.Object===Object&&global,dw=typeof self=="object"&&self&&self.Object===Object&&self,gt=yu||dw||Function("return this")(),xt=gt.Symbol,Cu=Object.prototype,hw=Cu.hasOwnProperty,fw=Cu.toString,Zi=xt?xt.toStringTag:void 0;function mw(i){var e=hw.call(i,Zi),t=i[Zi];try{i[Zi]=void 0;var n=!0}catch{}var s=fw.call(i);return n&&(e?i[Zi]=t:delete i[Zi]),s}var gw=Object.prototype,pw=gw.toString;function bw(i){return pw.call(i)}var ww="[object Null]",_w="[object Undefined]",ku=xt?xt.toStringTag:void 0;function rn(i){return i==null?i===void 0?_w:ww:ku&&ku in Object(i)?mw(i):bw(i)}function st(i){return i!=null&&typeof i=="object"}var vw="[object Symbol]";function mo(i){return typeof i=="symbol"||st(i)&&rn(i)==vw}function Tu(i,e){for(var t=-1,n=i==null?0:i.length,s=Array(n);++t<n;)s[t]=e(i[t],t,i);return s}var Ve=Array.isArray,Eu=xt?xt.prototype:void 0,Au=Eu?Eu.toString:void 0;function xu(i){if(typeof i=="string")return i;if(Ve(i))return Tu(i,xu)+"";if(mo(i))return Au?Au.call(i):"";var e=i+"";return e=="0"&&1/i==-1/0?"-0":e}var yw=/\s/;function Cw(i){for(var e=i.length;e--&&yw.test(i.charAt(e)););return e}var kw=/^\s+/;function Tw(i){return i&&i.slice(0,Cw(i)+1).replace(kw,"")}function ie(i){var e=typeof i;return i!=null&&(e=="object"||e=="function")}var Su=NaN,Ew=/^[-+]0x[0-9a-f]+$/i,Aw=/^0b[01]+$/i,xw=/^0o[0-7]+$/i,Sw=parseInt;function Iu(i){if(typeof i=="number")return i;if(mo(i))return Su;if(ie(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=ie(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=Tw(i);var t=Aw.test(i);return t||xw.test(i)?Sw(i.slice(2),t?2:8):Ew.test(i)?Su:+i}function an(i){return i}var Iw="[object AsyncFunction]",Pw="[object Function]",Rw="[object GeneratorFunction]",Mw="[object Proxy]";function vn(i){if(!ie(i))return!1;var e=rn(i);return e==Pw||e==Rw||e==Iw||e==Mw}var ya=gt["__core-js_shared__"],Pu=function(){var i=/[^.]+$/.exec(ya&&ya.keys&&ya.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}();function Bw(i){return!!Pu&&Pu in i}var Ow=Function.prototype,Lw=Ow.toString;function yn(i){if(i!=null){try{return Lw.call(i)}catch{}try{return i+""}catch{}}return""}var Vw=/[\\^$.*+?()[\]{}|]/g,Dw=/^\[object .+?Constructor\]$/,Nw=Function.prototype,Fw=Object.prototype,$w=Nw.toString,Uw=Fw.hasOwnProperty,zw=RegExp("^"+$w.call(Uw).replace(Vw,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Hw(i){if(!ie(i)||Bw(i))return!1;var e=vn(i)?zw:Dw;return e.test(yn(i))}function Ww(i,e){return i==null?void 0:i[e]}function Cn(i,e){var t=Ww(i,e);return Hw(t)?t:void 0}var Ca=Cn(gt,"WeakMap"),Ru=Object.create,jw=function(){function i(){}return function(e){if(!ie(e))return{};if(Ru)return Ru(e);i.prototype=e;var t=new i;return i.prototype=void 0,t}}();function qw(i,e,t){switch(t.length){case 0:return i.call(e);case 1:return i.call(e,t[0]);case 2:return i.call(e,t[0],t[1]);case 3:return i.call(e,t[0],t[1],t[2])}return i.apply(e,t)}function Mu(i,e){var t=-1,n=i.length;for(e||(e=Array(n));++t<n;)e[t]=i[t];return e}var Gw=800,Kw=16,Zw=Date.now;function Jw(i){var e=0,t=0;return function(){var n=Zw(),s=Kw-(n-t);if(t=n,s>0){if(++e>=Gw)return arguments[0]}else e=0;return i.apply(void 0,arguments)}}function Yw(i){return function(){return i}}var go=function(){try{var i=Cn(Object,"defineProperty");return i({},"",{}),i}catch{}}(),Xw=go?function(i,e){return go(i,"toString",{configurable:!0,enumerable:!1,value:Yw(e),writable:!0})}:an,Qw=Jw(Xw);function e_(i,e){for(var t=-1,n=i==null?0:i.length;++t<n&&e(i[t],t,i)!==!1;);return i}var t_=9007199254740991,n_=/^(?:0|[1-9]\d*)$/;function po(i,e){var t=typeof i;return e=e??t_,!!e&&(t=="number"||t!="symbol"&&n_.test(i))&&i>-1&&i%1==0&&i<e}function bo(i,e,t){e=="__proto__"&&go?go(i,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):i[e]=t}function Ji(i,e){return i===e||i!==i&&e!==e}var i_=Object.prototype,s_=i_.hasOwnProperty;function ka(i,e,t){var n=i[e];(!(s_.call(i,e)&&Ji(n,t))||t===void 0&&!(e in i))&&bo(i,e,t)}function ni(i,e,t,n){var s=!t;t||(t={});for(var o=-1,r=e.length;++o<r;){var a=e[o],l=void 0;l===void 0&&(l=i[a]),s?bo(t,a,l):ka(t,a,l)}return t}var Bu=Math.max;function o_(i,e,t){return e=Bu(e===void 0?i.length-1:e,0),function(){for(var n=arguments,s=-1,o=Bu(n.length-e,0),r=Array(o);++s<o;)r[s]=n[e+s];s=-1;for(var a=Array(e+1);++s<e;)a[s]=n[s];return a[e]=t(r),qw(i,this,a)}}function r_(i,e){return Qw(o_(i,e,an),i+"")}var a_=9007199254740991;function Ta(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=a_}function ii(i){return i!=null&&Ta(i.length)&&!vn(i)}function l_(i,e,t){if(!ie(t))return!1;var n=typeof e;return(n=="number"?ii(t)&&po(e,t.length):n=="string"&&e in t)?Ji(t[e],i):!1}function Ea(i){return r_(function(e,t){var n=-1,s=t.length,o=s>1?t[s-1]:void 0,r=s>2?t[2]:void 0;for(o=i.length>3&&typeof o=="function"?(s--,o):void 0,r&&l_(t[0],t[1],r)&&(o=s<3?void 0:o,s=1),e=Object(e);++n<s;){var a=t[n];a&&i(e,a,n,o)}return e})}var c_=Object.prototype;function Aa(i){var e=i&&i.constructor,t=typeof e=="function"&&e.prototype||c_;return i===t}function u_(i,e){for(var t=-1,n=Array(i);++t<i;)n[t]=e(t);return n}var d_="[object Arguments]";function Ou(i){return st(i)&&rn(i)==d_}var Lu=Object.prototype,h_=Lu.hasOwnProperty,f_=Lu.propertyIsEnumerable,wo=Ou(function(){return arguments}())?Ou:function(i){return st(i)&&h_.call(i,"callee")&&!f_.call(i,"callee")};function m_(){return!1}var Vu=typeof Le=="object"&&Le&&!Le.nodeType&&Le,Du=Vu&&typeof module=="object"&&module&&!module.nodeType&&module,g_=Du&&Du.exports===Vu,Nu=g_?gt.Buffer:void 0,p_=Nu?Nu.isBuffer:void 0,Yi=p_||m_,b_="[object Arguments]",w_="[object Array]",__="[object Boolean]",v_="[object Date]",y_="[object Error]",C_="[object Function]",k_="[object Map]",T_="[object Number]",E_="[object Object]",A_="[object RegExp]",x_="[object Set]",S_="[object String]",I_="[object WeakMap]",P_="[object ArrayBuffer]",R_="[object DataView]",M_="[object Float32Array]",B_="[object Float64Array]",O_="[object Int8Array]",L_="[object Int16Array]",V_="[object Int32Array]",D_="[object Uint8Array]",N_="[object Uint8ClampedArray]",F_="[object Uint16Array]",$_="[object Uint32Array]",ae={};ae[M_]=ae[B_]=ae[O_]=ae[L_]=ae[V_]=ae[D_]=ae[N_]=ae[F_]=ae[$_]=!0,ae[b_]=ae[w_]=ae[P_]=ae[__]=ae[R_]=ae[v_]=ae[y_]=ae[C_]=ae[k_]=ae[T_]=ae[E_]=ae[A_]=ae[x_]=ae[S_]=ae[I_]=!1;function U_(i){return st(i)&&Ta(i.length)&&!!ae[rn(i)]}function xa(i){return function(e){return i(e)}}var Fu=typeof Le=="object"&&Le&&!Le.nodeType&&Le,Xi=Fu&&typeof module=="object"&&module&&!module.nodeType&&module,z_=Xi&&Xi.exports===Fu,Sa=z_&&yu.process,si=function(){try{var i=Xi&&Xi.require&&Xi.require("util").types;return i||Sa&&Sa.binding&&Sa.binding("util")}catch{}}(),$u=si&&si.isTypedArray,Ia=$u?xa($u):U_,H_=Object.prototype,W_=H_.hasOwnProperty;function Uu(i,e){var t=Ve(i),n=!t&&wo(i),s=!t&&!n&&Yi(i),o=!t&&!n&&!s&&Ia(i),r=t||n||s||o,a=r?u_(i.length,String):[],l=a.length;for(var c in i)(e||W_.call(i,c))&&!(r&&(c=="length"||s&&(c=="offset"||c=="parent")||o&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||po(c,l)))&&a.push(c);return a}function zu(i,e){return function(t){return i(e(t))}}var j_=zu(Object.keys,Object),q_=Object.prototype,G_=q_.hasOwnProperty;function K_(i){if(!Aa(i))return j_(i);var e=[];for(var t in Object(i))G_.call(i,t)&&t!="constructor"&&e.push(t);return e}function Qi(i){return ii(i)?Uu(i):K_(i)}function Z_(i){var e=[];if(i!=null)for(var t in Object(i))e.push(t);return e}var J_=Object.prototype,Y_=J_.hasOwnProperty;function X_(i){if(!ie(i))return Z_(i);var e=Aa(i),t=[];for(var n in i)n=="constructor"&&(e||!Y_.call(i,n))||t.push(n);return t}function oi(i){return ii(i)?Uu(i,!0):X_(i)}var Hu=Ea(function(i,e){ni(e,oi(e),i)}),Q_=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ev=/^\w*$/;function Pa(i,e){if(Ve(i))return!1;var t=typeof i;return t=="number"||t=="symbol"||t=="boolean"||i==null||mo(i)?!0:ev.test(i)||!Q_.test(i)||e!=null&&i in Object(e)}var es=Cn(Object,"create");function tv(){this.__data__=es?es(null):{},this.size=0}function nv(i){var e=this.has(i)&&delete this.__data__[i];return this.size-=e?1:0,e}var iv="__lodash_hash_undefined__",sv=Object.prototype,ov=sv.hasOwnProperty;function rv(i){var e=this.__data__;if(es){var t=e[i];return t===iv?void 0:t}return ov.call(e,i)?e[i]:void 0}var av=Object.prototype,lv=av.hasOwnProperty;function cv(i){var e=this.__data__;return es?e[i]!==void 0:lv.call(e,i)}var uv="__lodash_hash_undefined__";function dv(i,e){var t=this.__data__;return this.size+=this.has(i)?0:1,t[i]=es&&e===void 0?uv:e,this}function kn(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var n=i[e];this.set(n[0],n[1])}}kn.prototype.clear=tv,kn.prototype.delete=nv,kn.prototype.get=rv,kn.prototype.has=cv,kn.prototype.set=dv;function hv(){this.__data__=[],this.size=0}function _o(i,e){for(var t=i.length;t--;)if(Ji(i[t][0],e))return t;return-1}var fv=Array.prototype,mv=fv.splice;function gv(i){var e=this.__data__,t=_o(e,i);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():mv.call(e,t,1),--this.size,!0}function pv(i){var e=this.__data__,t=_o(e,i);return t<0?void 0:e[t][1]}function bv(i){return _o(this.__data__,i)>-1}function wv(i,e){var t=this.__data__,n=_o(t,i);return n<0?(++this.size,t.push([i,e])):t[n][1]=e,this}function jt(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var n=i[e];this.set(n[0],n[1])}}jt.prototype.clear=hv,jt.prototype.delete=gv,jt.prototype.get=pv,jt.prototype.has=bv,jt.prototype.set=wv;var ts=Cn(gt,"Map");function _v(){this.size=0,this.__data__={hash:new kn,map:new(ts||jt),string:new kn}}function vv(i){var e=typeof i;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?i!=="__proto__":i===null}function vo(i,e){var t=i.__data__;return vv(e)?t[typeof e=="string"?"string":"hash"]:t.map}function yv(i){var e=vo(this,i).delete(i);return this.size-=e?1:0,e}function Cv(i){return vo(this,i).get(i)}function kv(i){return vo(this,i).has(i)}function Tv(i,e){var t=vo(this,i),n=t.size;return t.set(i,e),this.size+=t.size==n?0:1,this}function qt(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var n=i[e];this.set(n[0],n[1])}}qt.prototype.clear=_v,qt.prototype.delete=yv,qt.prototype.get=Cv,qt.prototype.has=kv,qt.prototype.set=Tv;var Ev="Expected a function";function Ra(i,e){if(typeof i!="function"||e!=null&&typeof e!="function")throw new TypeError(Ev);var t=function(){var n=arguments,s=e?e.apply(this,n):n[0],o=t.cache;if(o.has(s))return o.get(s);var r=i.apply(this,n);return t.cache=o.set(s,r)||o,r};return t.cache=new(Ra.Cache||qt),t}Ra.Cache=qt;var Av=500;function xv(i){var e=Ra(i,function(n){return t.size===Av&&t.clear(),n}),t=e.cache;return e}var Sv=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Iv=/\\(\\)?/g,Pv=xv(function(i){var e=[];return i.charCodeAt(0)===46&&e.push(""),i.replace(Sv,function(t,n,s,o){e.push(s?o.replace(Iv,"$1"):n||t)}),e});function ns(i){return i==null?"":xu(i)}function yo(i,e){return Ve(i)?i:Pa(i,e)?[i]:Pv(ns(i))}function ri(i){if(typeof i=="string"||mo(i))return i;var e=i+"";return e=="0"&&1/i==-1/0?"-0":e}function Ma(i,e){e=yo(e,i);for(var t=0,n=e.length;i!=null&&t<n;)i=i[ri(e[t++])];return t&&t==n?i:void 0}function is(i,e,t){var n=i==null?void 0:Ma(i,e);return n===void 0?t:n}function Wu(i,e){for(var t=-1,n=e.length,s=i.length;++t<n;)i[s+t]=e[t];return i}var Ba=zu(Object.getPrototypeOf,Object),Rv="[object Object]",Mv=Function.prototype,Bv=Object.prototype,ju=Mv.toString,Ov=Bv.hasOwnProperty,Lv=ju.call(Object);function De(i){if(!st(i)||rn(i)!=Rv)return!1;var e=Ba(i);if(e===null)return!0;var t=Ov.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&ju.call(t)==Lv}function qu(i,e,t){var n=-1,s=i.length;e<0&&(e=-e>s?0:s+e),t=t>s?s:t,t<0&&(t+=s),s=e>t?0:t-e>>>0,e>>>=0;for(var o=Array(s);++n<s;)o[n]=i[n+e];return o}function Vv(i,e,t){var n=i.length;return t=t===void 0?n:t,!e&&t>=n?i:qu(i,e,t)}var Dv="\\ud800-\\udfff",Nv="\\u0300-\\u036f",Fv="\\ufe20-\\ufe2f",$v="\\u20d0-\\u20ff",Uv=Nv+Fv+$v,zv="\\ufe0e\\ufe0f",Hv="\\u200d",Wv=RegExp("["+Hv+Dv+Uv+zv+"]");function Gu(i){return Wv.test(i)}function jv(i){return i.split("")}var Ku="\\ud800-\\udfff",qv="\\u0300-\\u036f",Gv="\\ufe20-\\ufe2f",Kv="\\u20d0-\\u20ff",Zv=qv+Gv+Kv,Jv="\\ufe0e\\ufe0f",Yv="["+Ku+"]",Oa="["+Zv+"]",La="\\ud83c[\\udffb-\\udfff]",Xv="(?:"+Oa+"|"+La+")",Zu="[^"+Ku+"]",Ju="(?:\\ud83c[\\udde6-\\uddff]){2}",Yu="[\\ud800-\\udbff][\\udc00-\\udfff]",Qv="\\u200d",Xu=Xv+"?",Qu="["+Jv+"]?",ey="(?:"+Qv+"(?:"+[Zu,Ju,Yu].join("|")+")"+Qu+Xu+")*",ty=Qu+Xu+ey,ny="(?:"+[Zu+Oa+"?",Oa,Ju,Yu,Yv].join("|")+")",iy=RegExp(La+"(?="+La+")|"+ny+ty,"g");function sy(i){return i.match(iy)||[]}function oy(i){return Gu(i)?sy(i):jv(i)}function ry(i){return function(e){e=ns(e);var t=Gu(e)?oy(e):void 0,n=t?t[0]:e.charAt(0),s=t?Vv(t,1).join(""):e.slice(1);return n[i]()+s}}var ed=ry("toUpperCase");function ay(i,e,t,n){for(var s=-1,o=i==null?0:i.length;++s<o;)t=e(t,i[s],s,i);return t}function ly(i){return function(e){return i==null?void 0:i[e]}}var cy={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},uy=ly(cy),dy=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,hy="\\u0300-\\u036f",fy="\\ufe20-\\ufe2f",my="\\u20d0-\\u20ff",gy=hy+fy+my,py="["+gy+"]",by=RegExp(py,"g");function wy(i){return i=ns(i),i&&i.replace(dy,uy).replace(by,"")}var _y=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function vy(i){return i.match(_y)||[]}var yy=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function Cy(i){return yy.test(i)}var td="\\ud800-\\udfff",ky="\\u0300-\\u036f",Ty="\\ufe20-\\ufe2f",Ey="\\u20d0-\\u20ff",Ay=ky+Ty+Ey,nd="\\u2700-\\u27bf",id="a-z\\xdf-\\xf6\\xf8-\\xff",xy="\\xac\\xb1\\xd7\\xf7",Sy="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Iy="\\u2000-\\u206f",Py=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",sd="A-Z\\xc0-\\xd6\\xd8-\\xde",Ry="\\ufe0e\\ufe0f",od=xy+Sy+Iy+Py,rd="['’]",ad="["+od+"]",My="["+Ay+"]",ld="\\d+",By="["+nd+"]",cd="["+id+"]",ud="[^"+td+od+ld+nd+id+sd+"]",Oy="\\ud83c[\\udffb-\\udfff]",Ly="(?:"+My+"|"+Oy+")",Vy="[^"+td+"]",dd="(?:\\ud83c[\\udde6-\\uddff]){2}",hd="[\\ud800-\\udbff][\\udc00-\\udfff]",ai="["+sd+"]",Dy="\\u200d",fd="(?:"+cd+"|"+ud+")",Ny="(?:"+ai+"|"+ud+")",md="(?:"+rd+"(?:d|ll|m|re|s|t|ve))?",gd="(?:"+rd+"(?:D|LL|M|RE|S|T|VE))?",pd=Ly+"?",bd="["+Ry+"]?",Fy="(?:"+Dy+"(?:"+[Vy,dd,hd].join("|")+")"+bd+pd+")*",$y="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Uy="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",zy=bd+pd+Fy,Hy="(?:"+[By,dd,hd].join("|")+")"+zy,Wy=RegExp([ai+"?"+cd+"+"+md+"(?="+[ad,ai,"$"].join("|")+")",Ny+"+"+gd+"(?="+[ad,ai+fd,"$"].join("|")+")",ai+"?"+fd+"+"+md,ai+"+"+gd,Uy,$y,ld,Hy].join("|"),"g");function jy(i){return i.match(Wy)||[]}function qy(i,e,t){return i=ns(i),e=e,e===void 0?Cy(i)?jy(i):vy(i):i.match(e)||[]}var Gy="['’]",Ky=RegExp(Gy,"g");function Zy(i){return function(e){return ay(qy(wy(e).replace(Ky,"")),i,"")}}function Jy(){this.__data__=new jt,this.size=0}function Yy(i){var e=this.__data__,t=e.delete(i);return this.size=e.size,t}function Xy(i){return this.__data__.get(i)}function Qy(i){return this.__data__.has(i)}var e2=200;function t2(i,e){var t=this.__data__;if(t instanceof jt){var n=t.__data__;if(!ts||n.length<e2-1)return n.push([i,e]),this.size=++t.size,this;t=this.__data__=new qt(n)}return t.set(i,e),this.size=t.size,this}function pt(i){var e=this.__data__=new jt(i);this.size=e.size}pt.prototype.clear=Jy,pt.prototype.delete=Yy,pt.prototype.get=Xy,pt.prototype.has=Qy,pt.prototype.set=t2;function n2(i,e){return i&&ni(e,Qi(e),i)}function i2(i,e){return i&&ni(e,oi(e),i)}var wd=typeof Le=="object"&&Le&&!Le.nodeType&&Le,_d=wd&&typeof module=="object"&&module&&!module.nodeType&&module,s2=_d&&_d.exports===wd,vd=s2?gt.Buffer:void 0,yd=vd?vd.allocUnsafe:void 0;function Cd(i,e){if(e)return i.slice();var t=i.length,n=yd?yd(t):new i.constructor(t);return i.copy(n),n}function o2(i,e){for(var t=-1,n=i==null?0:i.length,s=0,o=[];++t<n;){var r=i[t];e(r,t,i)&&(o[s++]=r)}return o}function kd(){return[]}var r2=Object.prototype,a2=r2.propertyIsEnumerable,Td=Object.getOwnPropertySymbols,Va=Td?function(i){return i==null?[]:(i=Object(i),o2(Td(i),function(e){return a2.call(i,e)}))}:kd;function l2(i,e){return ni(i,Va(i),e)}var c2=Object.getOwnPropertySymbols,Ed=c2?function(i){for(var e=[];i;)Wu(e,Va(i)),i=Ba(i);return e}:kd;function u2(i,e){return ni(i,Ed(i),e)}function Ad(i,e,t){var n=e(i);return Ve(i)?n:Wu(n,t(i))}function Da(i){return Ad(i,Qi,Va)}function d2(i){return Ad(i,oi,Ed)}var Na=Cn(gt,"DataView"),Fa=Cn(gt,"Promise"),$a=Cn(gt,"Set"),xd="[object Map]",h2="[object Object]",Sd="[object Promise]",Id="[object Set]",Pd="[object WeakMap]",Rd="[object DataView]",f2=yn(Na),m2=yn(ts),g2=yn(Fa),p2=yn($a),b2=yn(Ca),bt=rn;(Na&&bt(new Na(new ArrayBuffer(1)))!=Rd||ts&&bt(new ts)!=xd||Fa&&bt(Fa.resolve())!=Sd||$a&&bt(new $a)!=Id||Ca&&bt(new Ca)!=Pd)&&(bt=function(i){var e=rn(i),t=e==h2?i.constructor:void 0,n=t?yn(t):"";if(n)switch(n){case f2:return Rd;case m2:return xd;case g2:return Sd;case p2:return Id;case b2:return Pd}return e});var w2=Object.prototype,_2=w2.hasOwnProperty;function v2(i){var e=i.length,t=new i.constructor(e);return e&&typeof i[0]=="string"&&_2.call(i,"index")&&(t.index=i.index,t.input=i.input),t}var Co=gt.Uint8Array;function Ua(i){var e=new i.constructor(i.byteLength);return new Co(e).set(new Co(i)),e}function y2(i,e){var t=e?Ua(i.buffer):i.buffer;return new i.constructor(t,i.byteOffset,i.byteLength)}var C2=/\w*$/;function k2(i){var e=new i.constructor(i.source,C2.exec(i));return e.lastIndex=i.lastIndex,e}var Md=xt?xt.prototype:void 0,Bd=Md?Md.valueOf:void 0;function T2(i){return Bd?Object(Bd.call(i)):{}}function Od(i,e){var t=e?Ua(i.buffer):i.buffer;return new i.constructor(t,i.byteOffset,i.length)}var E2="[object Boolean]",A2="[object Date]",x2="[object Map]",S2="[object Number]",I2="[object RegExp]",P2="[object Set]",R2="[object String]",M2="[object Symbol]",B2="[object ArrayBuffer]",O2="[object DataView]",L2="[object Float32Array]",V2="[object Float64Array]",D2="[object Int8Array]",N2="[object Int16Array]",F2="[object Int32Array]",$2="[object Uint8Array]",U2="[object Uint8ClampedArray]",z2="[object Uint16Array]",H2="[object Uint32Array]";function W2(i,e,t){var n=i.constructor;switch(e){case B2:return Ua(i);case E2:case A2:return new n(+i);case O2:return y2(i,t);case L2:case V2:case D2:case N2:case F2:case $2:case U2:case z2:case H2:return Od(i,t);case x2:return new n;case S2:case R2:return new n(i);case I2:return k2(i);case P2:return new n;case M2:return T2(i)}}function Ld(i){return typeof i.constructor=="function"&&!Aa(i)?jw(Ba(i)):{}}var j2="[object Map]";function q2(i){return st(i)&&bt(i)==j2}var Vd=si&&si.isMap,G2=Vd?xa(Vd):q2,K2="[object Set]";function Z2(i){return st(i)&&bt(i)==K2}var Dd=si&&si.isSet,J2=Dd?xa(Dd):Z2,Y2=1,X2=2,Q2=4,Nd="[object Arguments]",eC="[object Array]",tC="[object Boolean]",nC="[object Date]",iC="[object Error]",Fd="[object Function]",sC="[object GeneratorFunction]",oC="[object Map]",rC="[object Number]",$d="[object Object]",aC="[object RegExp]",lC="[object Set]",cC="[object String]",uC="[object Symbol]",dC="[object WeakMap]",hC="[object ArrayBuffer]",fC="[object DataView]",mC="[object Float32Array]",gC="[object Float64Array]",pC="[object Int8Array]",bC="[object Int16Array]",wC="[object Int32Array]",_C="[object Uint8Array]",vC="[object Uint8ClampedArray]",yC="[object Uint16Array]",CC="[object Uint32Array]",oe={};oe[Nd]=oe[eC]=oe[hC]=oe[fC]=oe[tC]=oe[nC]=oe[mC]=oe[gC]=oe[pC]=oe[bC]=oe[wC]=oe[oC]=oe[rC]=oe[$d]=oe[aC]=oe[lC]=oe[cC]=oe[uC]=oe[_C]=oe[vC]=oe[yC]=oe[CC]=!0,oe[iC]=oe[Fd]=oe[dC]=!1;function li(i,e,t,n,s,o){var r,a=e&Y2,l=e&X2,c=e&Q2;if(t&&(r=s?t(i,n,s,o):t(i)),r!==void 0)return r;if(!ie(i))return i;var u=Ve(i);if(u){if(r=v2(i),!a)return Mu(i,r)}else{var d=bt(i),h=d==Fd||d==sC;if(Yi(i))return Cd(i,a);if(d==$d||d==Nd||h&&!s){if(r=l||h?{}:Ld(i),!a)return l?u2(i,i2(r,i)):l2(i,n2(r,i))}else{if(!oe[d])return s?i:{};r=W2(i,d,a)}}o||(o=new pt);var f=o.get(i);if(f)return f;o.set(i,r),J2(i)?i.forEach(function(b){r.add(li(b,e,t,b,i,o))}):G2(i)&&i.forEach(function(b,_){r.set(_,li(b,e,t,_,i,o))});var m=c?l?d2:Da:l?oi:Qi,g=u?void 0:m(i);return e_(g||i,function(b,_){g&&(_=b,b=i[_]),ka(r,_,li(b,e,t,_,i,o))}),r}var kC=4;function Ud(i){return li(i,kC)}var TC=1,EC=4;function ot(i){return li(i,TC|EC)}var AC=1,xC=4;function za(i,e){return e=typeof e=="function"?e:void 0,li(i,AC|xC,e)}var SC="__lodash_hash_undefined__";function IC(i){return this.__data__.set(i,SC),this}function PC(i){return this.__data__.has(i)}function ko(i){var e=-1,t=i==null?0:i.length;for(this.__data__=new qt;++e<t;)this.add(i[e])}ko.prototype.add=ko.prototype.push=IC,ko.prototype.has=PC;function RC(i,e){for(var t=-1,n=i==null?0:i.length;++t<n;)if(e(i[t],t,i))return!0;return!1}function MC(i,e){return i.has(e)}var BC=1,OC=2;function zd(i,e,t,n,s,o){var r=t&BC,a=i.length,l=e.length;if(a!=l&&!(r&&l>a))return!1;var c=o.get(i),u=o.get(e);if(c&&u)return c==e&&u==i;var d=-1,h=!0,f=t&OC?new ko:void 0;for(o.set(i,e),o.set(e,i);++d<a;){var m=i[d],g=e[d];if(n)var b=r?n(g,m,d,e,i,o):n(m,g,d,i,e,o);if(b!==void 0){if(b)continue;h=!1;break}if(f){if(!RC(e,function(_,T){if(!MC(f,T)&&(m===_||s(m,_,t,n,o)))return f.push(T)})){h=!1;break}}else if(!(m===g||s(m,g,t,n,o))){h=!1;break}}return o.delete(i),o.delete(e),h}function LC(i){var e=-1,t=Array(i.size);return i.forEach(function(n,s){t[++e]=[s,n]}),t}function VC(i){var e=-1,t=Array(i.size);return i.forEach(function(n){t[++e]=n}),t}var DC=1,NC=2,FC="[object Boolean]",$C="[object Date]",UC="[object Error]",zC="[object Map]",HC="[object Number]",WC="[object RegExp]",jC="[object Set]",qC="[object String]",GC="[object Symbol]",KC="[object ArrayBuffer]",ZC="[object DataView]",Hd=xt?xt.prototype:void 0,Ha=Hd?Hd.valueOf:void 0;function JC(i,e,t,n,s,o,r){switch(t){case ZC:if(i.byteLength!=e.byteLength||i.byteOffset!=e.byteOffset)return!1;i=i.buffer,e=e.buffer;case KC:return!(i.byteLength!=e.byteLength||!o(new Co(i),new Co(e)));case FC:case $C:case HC:return Ji(+i,+e);case UC:return i.name==e.name&&i.message==e.message;case WC:case qC:return i==e+"";case zC:var a=LC;case jC:var l=n&DC;if(a||(a=VC),i.size!=e.size&&!l)return!1;var c=r.get(i);if(c)return c==e;n|=NC,r.set(i,e);var u=zd(a(i),a(e),n,s,o,r);return r.delete(i),u;case GC:if(Ha)return Ha.call(i)==Ha.call(e)}return!1}var YC=1,XC=Object.prototype,QC=XC.hasOwnProperty;function ek(i,e,t,n,s,o){var r=t&YC,a=Da(i),l=a.length,c=Da(e),u=c.length;if(l!=u&&!r)return!1;for(var d=l;d--;){var h=a[d];if(!(r?h in e:QC.call(e,h)))return!1}var f=o.get(i),m=o.get(e);if(f&&m)return f==e&&m==i;var g=!0;o.set(i,e),o.set(e,i);for(var b=r;++d<l;){h=a[d];var _=i[h],T=e[h];if(n)var O=r?n(T,_,h,e,i,o):n(_,T,h,i,e,o);if(!(O===void 0?_===T||s(_,T,t,n,o):O)){g=!1;break}b||(b=h=="constructor")}if(g&&!b){var B=i.constructor,W=e.constructor;B!=W&&"constructor"in i&&"constructor"in e&&!(typeof B=="function"&&B instanceof B&&typeof W=="function"&&W instanceof W)&&(g=!1)}return o.delete(i),o.delete(e),g}var tk=1,Wd="[object Arguments]",jd="[object Array]",To="[object Object]",nk=Object.prototype,qd=nk.hasOwnProperty;function ik(i,e,t,n,s,o){var r=Ve(i),a=Ve(e),l=r?jd:bt(i),c=a?jd:bt(e);l=l==Wd?To:l,c=c==Wd?To:c;var u=l==To,d=c==To,h=l==c;if(h&&Yi(i)){if(!Yi(e))return!1;r=!0,u=!1}if(h&&!u)return o||(o=new pt),r||Ia(i)?zd(i,e,t,n,s,o):JC(i,e,l,t,n,s,o);if(!(t&tk)){var f=u&&qd.call(i,"__wrapped__"),m=d&&qd.call(e,"__wrapped__");if(f||m){var g=f?i.value():i,b=m?e.value():e;return o||(o=new pt),s(g,b,t,n,o)}}return h?(o||(o=new pt),ek(i,e,t,n,s,o)):!1}function ss(i,e,t,n,s){return i===e?!0:i==null||e==null||!st(i)&&!st(e)?i!==i&&e!==e:ik(i,e,t,n,ss,s)}var sk=1,ok=2;function rk(i,e,t,n){var s=t.length,o=s;if(i==null)return!o;for(i=Object(i);s--;){var r=t[s];if(r[2]?r[1]!==i[r[0]]:!(r[0]in i))return!1}for(;++s<o;){r=t[s];var a=r[0],l=i[a],c=r[1];if(r[2]){if(l===void 0&&!(a in i))return!1}else{var u=new pt,d;if(!(d===void 0?ss(c,l,sk|ok,n,u):d))return!1}}return!0}function Gd(i){return i===i&&!ie(i)}function ak(i){for(var e=Qi(i),t=e.length;t--;){var n=e[t],s=i[n];e[t]=[n,s,Gd(s)]}return e}function Kd(i,e){return function(t){return t==null?!1:t[i]===e&&(e!==void 0||i in Object(t))}}function lk(i){var e=ak(i);return e.length==1&&e[0][2]?Kd(e[0][0],e[0][1]):function(t){return t===i||rk(t,i,e)}}function ck(i,e){return i!=null&&e in Object(i)}function uk(i,e,t){e=yo(e,i);for(var n=-1,s=e.length,o=!1;++n<s;){var r=ri(e[n]);if(!(o=i!=null&&t(i,r)))break;i=i[r]}return o||++n!=s?o:(s=i==null?0:i.length,!!s&&Ta(s)&&po(r,s)&&(Ve(i)||wo(i)))}function dk(i,e){return i!=null&&uk(i,e,ck)}var hk=1,fk=2;function mk(i,e){return Pa(i)&&Gd(e)?Kd(ri(i),e):function(t){var n=is(t,i);return n===void 0&&n===e?dk(t,i):ss(e,n,hk|fk)}}function gk(i){return function(e){return e==null?void 0:e[i]}}function pk(i){return function(e){return Ma(e,i)}}function bk(i){return Pa(i)?gk(ri(i)):pk(i)}function Zd(i){return typeof i=="function"?i:i==null?an:typeof i=="object"?Ve(i)?mk(i[0],i[1]):lk(i):bk(i)}function wk(i){return function(e,t,n){for(var s=-1,o=Object(e),r=n(e),a=r.length;a--;){var l=r[++s];if(t(o[l],l,o)===!1)break}return e}}var Jd=wk();function Yd(i,e){return i&&Jd(i,e,Qi)}function _k(i,e){return function(t,n){if(t==null)return t;if(!ii(t))return i(t,n);for(var s=t.length,o=-1,r=Object(t);++o<s&&n(r[o],o,r)!==!1;);return t}}var vk=_k(Yd),Wa=function(){return gt.Date.now()},yk="Expected a function",Ck=Math.max,kk=Math.min;function St(i,e,t){var n,s,o,r,a,l,c=0,u=!1,d=!1,h=!0;if(typeof i!="function")throw new TypeError(yk);e=Iu(e)||0,ie(t)&&(u=!!t.leading,d="maxWait"in t,o=d?Ck(Iu(t.maxWait)||0,e):o,h="trailing"in t?!!t.trailing:h);function f(S){var V=n,E=s;return n=s=void 0,c=S,r=i.apply(E,V),r}function m(S){return c=S,a=setTimeout(_,e),u?f(S):r}function g(S){var V=S-l,E=S-c,L=e-V;return d?kk(L,o-E):L}function b(S){var V=S-l,E=S-c;return l===void 0||V>=e||V<0||d&&E>=o}function _(){var S=Wa();if(b(S))return T(S);a=setTimeout(_,g(S))}function T(S){return a=void 0,h&&n?f(S):(n=s=void 0,r)}function O(){a!==void 0&&clearTimeout(a),c=0,n=l=s=a=void 0}function B(){return a===void 0?r:T(Wa())}function W(){var S=Wa(),V=b(S);if(n=arguments,s=this,l=S,V){if(a===void 0)return m(l);if(d)return clearTimeout(a),a=setTimeout(_,e),f(l)}return a===void 0&&(a=setTimeout(_,e)),r}return W.cancel=O,W.flush=B,W}function ja(i,e,t){(t!==void 0&&!Ji(i[e],t)||t===void 0&&!(e in i))&&bo(i,e,t)}function Tk(i){return st(i)&&ii(i)}function qa(i,e){if(!(e==="constructor"&&typeof i[e]=="function")&&e!="__proto__")return i[e]}function Ek(i){return ni(i,oi(i))}function Ak(i,e,t,n,s,o,r){var a=qa(i,t),l=qa(e,t),c=r.get(l);if(c){ja(i,t,c);return}var u=o?o(a,l,t+"",i,e,r):void 0,d=u===void 0;if(d){var h=Ve(l),f=!h&&Yi(l),m=!h&&!f&&Ia(l);u=l,h||f||m?Ve(a)?u=a:Tk(a)?u=Mu(a):f?(d=!1,u=Cd(l,!0)):m?(d=!1,u=Od(l,!0)):u=[]:De(l)||wo(l)?(u=a,wo(a)?u=Ek(a):(!ie(a)||vn(a))&&(u=Ld(l))):d=!1}d&&(r.set(l,u),s(u,l,n,o,r),r.delete(l)),ja(i,t,u)}function Ga(i,e,t,n,s){i!==e&&Jd(e,function(o,r){if(s||(s=new pt),ie(o))Ak(i,e,r,t,Ga,n,s);else{var a=n?n(qa(i,r),o,r+"",i,e,s):void 0;a===void 0&&(a=o),ja(i,r,a)}},oi)}var xk=Ea(function(i,e,t,n){Ga(i,e,t,n)});function Sk(i){var e=i==null?0:i.length;return e?i[e-1]:void 0}var Xd=/[\\^$.*+?()[\]{}|]/g,Ik=RegExp(Xd.source);function Pk(i){return i=ns(i),i&&Ik.test(i)?i.replace(Xd,"\\$&"):i}function Rk(i,e){var t=-1,n=ii(i)?Array(i.length):[];return vk(i,function(s,o,r){n[++t]=e(s,o,r)}),n}function Mk(i,e){var t=Ve(i)?Tu:Rk;return t(i,Zd(e))}var Bk="[object String]";function Qd(i){return typeof i=="string"||!Ve(i)&&st(i)&&rn(i)==Bk}function Ok(i,e){return e.length<2?i:Ma(i,qu(e,0,-1))}function Tn(i){return st(i)&&i.nodeType===1&&!De(i)}function ci(i,e){return ss(i,e)}function Lk(i,e,t){t=typeof t=="function"?t:void 0;var n=t?t(i,e):void 0;return n===void 0?ss(i,e,void 0,t):!!n}function Vk(i,e){var t={};return e=Zd(e),Yd(i,function(n,s,o){bo(t,s,e(n,s,o))}),t}var Ka=Ea(function(i,e,t){Ga(i,e,t)});function Dk(i,e){return e=yo(e,i),i=Ok(i,e),i==null||delete i[ri(Sk(e))]}function Nk(i,e,t,n){if(!ie(i))return i;e=yo(e,i);for(var s=-1,o=e.length,r=o-1,a=i;a!=null&&++s<o;){var l=ri(e[s]),c=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return i;if(s!=r){var u=a[l];c=void 0,c===void 0&&(c=ie(u)?u:po(e[s+1])?[]:{})}ka(a,l,c),a=a[l]}return i}function Fk(i,e,t){return i==null?i:Nk(i,e,t)}var $k=Zy(function(i,e,t){return i+(t?" ":"")+ed(e)}),Uk="Expected a function";function os(i,e,t){var n=!0,s=!0;if(typeof i!="function")throw new TypeError(Uk);return ie(t)&&(n="leading"in t?!!t.leading:n,s="trailing"in t?!!t.trailing:s),St(i,e,{leading:n,maxWait:e,trailing:s})}function zk(i,e){return i==null?!0:Dk(i,e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Eo=Symbol("observableProperties"),Ao=Symbol("boundObservables"),xo=Symbol("boundProperties"),ui=Symbol("decoratedMethods"),eh=Symbol("decoratedOriginal"),th=re(ee());function re(i){if(!i)return th;class e extends i{set(n,s){if(ie(n)){Object.keys(n).forEach(r=>{this.set(r,n[r])},this);return}Za(this);const o=this[Eo];if(n in this&&!o.has(n))throw new p("observable-set-cannot-override",this);Object.defineProperty(this,n,{enumerable:!0,configurable:!0,get(){return o.get(n)},set(r){const a=o.get(n);let l=this.fire(`set:${n}`,n,r,a);l===void 0&&(l=r),(a!==l||!o.has(n))&&(o.set(n,l),this.fire(`change:${n}`,n,l,a))}}),this[n]=s}bind(...n){if(!n.length||!nh(n))throw new p("observable-bind-wrong-properties",this);if(new Set(n).size!==n.length)throw new p("observable-bind-duplicate-properties",this);Za(this);const s=this[xo];n.forEach(r=>{if(s.has(r))throw new p("observable-bind-rebind",this)});const o=new Map;return n.forEach(r=>{const a={property:r,to:[]};s.set(r,a),o.set(r,a)}),{to:Hk,toMany:Wk,_observable:this,_bindProperties:n,_to:[],_bindings:o}}unbind(...n){if(!this[Eo])return;const s=this[xo],o=this[Ao];if(n.length){if(!nh(n))throw new p("observable-unbind-wrong-properties",this);n.forEach(r=>{const a=s.get(r);a&&(a.to.forEach(([l,c])=>{const u=o.get(l),d=u[c];d.delete(a),d.size||delete u[c],Object.keys(u).length||(o.delete(l),this.stopListening(l,"change"))}),s.delete(r))})}else o.forEach((r,a)=>{this.stopListening(a,"change")}),o.clear(),s.clear()}decorate(n){Za(this);const s=this[n];if(!s)throw new p("observablemixin-cannot-decorate-undefined",this,{object:this,methodName:n});this.on(n,(o,r)=>{o.return=s.apply(this,r)}),this[n]=function(...o){return this.fire(n,o)},this[n][eh]=s,this[ui]||(this[ui]=[]),this[ui].push(n)}stopListening(n,s,o){if(!n&&this[ui]){for(const r of this[ui])this[r]=this[r][eh];delete this[ui]}super.stopListening(n,s,o)}}return e}["set","bind","unbind","decorate","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(i=>{re[i]=th.prototype[i]});function Za(i){i[Eo]||(Object.defineProperty(i,Eo,{value:new Map}),Object.defineProperty(i,Ao,{value:new Map}),Object.defineProperty(i,xo,{value:new Map}))}function Hk(...i){const e=qk(...i),t=Array.from(this._bindings.keys()),n=t.length;if(!e.callback&&e.to.length>1)throw new p("observable-bind-to-no-callback",this);if(n>1&&e.callback)throw new p("observable-bind-to-extra-callback",this);e.to.forEach(s=>{if(s.properties.length&&s.properties.length!==n)throw new p("observable-bind-to-properties-length",this);s.properties.length||(s.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(t[0]).callback=e.callback),Zk(this._observable,this._to),Kk(this),this._bindProperties.forEach(s=>{ih(this._observable,s)})}function Wk(i,e,t){if(this._bindings.size>1)throw new p("observable-bind-to-many-not-one-binding",this);this.to(...jk(i,e),t)}function jk(i,e){const t=i.map(n=>[n,e]);return Array.prototype.concat.apply([],t)}function nh(i){return i.every(e=>typeof e=="string")}function qk(...i){if(!i.length)throw new p("observable-bind-to-parse-error",null);const e={to:[]};let t;return typeof i[i.length-1]=="function"&&(e.callback=i.pop()),i.forEach(n=>{if(typeof n=="string")t.properties.push(n);else if(typeof n=="object")t={observable:n,properties:[]},e.to.push(t);else throw new p("observable-bind-to-parse-error",null)}),e}function Gk(i,e,t,n){const s=i[Ao],o=s.get(t),r=o||{};r[n]||(r[n]=new Set),r[n].add(e),o||s.set(t,r)}function Kk(i){let e;i._bindings.forEach((t,n)=>{i._to.forEach(s=>{e=s.properties[t.callback?0:i._bindProperties.indexOf(n)],t.to.push([s.observable,e]),Gk(i._observable,t,s.observable,e)})})}function ih(i,e){const n=i[xo].get(e);let s;n.callback?s=n.callback.apply(i,n.to.map(o=>o[0][o[1]])):(s=n.to[0],s=s[0][s[1]]),Object.prototype.hasOwnProperty.call(i,e)?i[e]=s:i.set(e,s)}function Zk(i,e){e.forEach(t=>{const n=i[Ao];let s;n.get(t.observable)||i.listenTo(t.observable,"change",(o,r)=>{s=n.get(t.observable)[r],s&&s.forEach(a=>{ih(i,a.property)})})})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Jk{constructor(){this._replacedElements=[]}replace(e,t){this._replacedElements.push({element:e,newElement:t}),e.style.display="none",t&&e.parentNode.insertBefore(t,e.nextSibling)}restore(){this._replacedElements.forEach(({element:e,newElement:t})=>{e.style.display="",t&&t.remove()}),this._replacedElements=[]}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ja(i){let e=0;for(const t of i)e++;return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Be(i,e){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)if(i[n]!=e[n])return n;return i.length==e.length?"same":i.length<e.length?"prefix":"extension"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function je(i){return!!(i&&i[Symbol.iterator])}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function wt(i,e,t={},n=[]){const s=t&&t.xmlns,o=s?i.createElementNS(s,e):i.createElement(e);for(const r in t)o.setAttribute(r,t[r]);(Qd(n)||!je(n))&&(n=[n]);for(let r of n)Qd(r)&&(r=i.createTextNode(r)),o.appendChild(r);return o}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class sh{constructor(e,t){this._config={},t&&this.define(oh(t)),e&&this._setObjectToTarget(this._config,e)}set(e,t){this._setToTarget(this._config,e,t)}define(e,t){this._setToTarget(this._config,e,t,!0)}get(e){return this._getFromSource(this._config,e)}*names(){for(const e of Object.keys(this._config))yield e}_setToTarget(e,t,n,s=!1){if(De(t)){this._setObjectToTarget(e,t,s);return}const o=t.split(".");t=o.pop();for(const r of o)De(e[r])||(e[r]={}),e=e[r];if(De(n)){De(e[t])||(e[t]={}),e=e[t],this._setObjectToTarget(e,n,s);return}s&&typeof e[t]<"u"||(e[t]=n)}_getFromSource(e,t){const n=t.split(".");t=n.pop();for(const s of n){if(!De(e[s])){e=null;break}e=e[s]}return e?oh(e[t]):void 0}_setObjectToTarget(e,t,n){Object.keys(t).forEach(s=>{this._setToTarget(e,s,t[s],n)})}}function oh(i){return za(i,Yk)}function Yk(i){return Tn(i)||typeof i=="function"?i:void 0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ln(i){if(i){if(i.defaultView)return i instanceof i.defaultView.Document;if(i.ownerDocument&&i.ownerDocument.defaultView)return i instanceof i.ownerDocument.defaultView.Node}return!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function So(i){const e=Object.prototype.toString.apply(i);return e=="[object Window]"||e=="[object global]"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const rh=qe(ee());function qe(i){if(!i)return rh;class e extends i{listenTo(n,s,o,r={}){if(ln(n)||So(n)){const a={capture:!!r.useCapture,passive:!!r.usePassive},l=this._getProxyEmitter(n,a)||new Xk(n,a);this.listenTo(l,s,o,r)}else super.listenTo(n,s,o,r)}stopListening(n,s,o){if(ln(n)||So(n)){const r=this._getAllProxyEmitters(n);for(const a of r)this.stopListening(a,s,o)}else super.stopListening(n,s,o)}_getProxyEmitter(n,s){return aw(this,ah(n,s))}_getAllProxyEmitters(n){return[{capture:!1,passive:!1},{capture:!1,passive:!0},{capture:!0,passive:!1},{capture:!0,passive:!0}].map(s=>this._getProxyEmitter(n,s)).filter(s=>!!s)}}return e}["_getProxyEmitter","_getAllProxyEmitters","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(i=>{qe[i]=rh.prototype[i]});class Xk extends ee(){constructor(e,t){super(),bu(this,ah(e,t)),this._domNode=e,this._options=t}attach(e){if(this._domListeners&&this._domListeners[e])return;const t=this._createDomListener(e);this._domNode.addEventListener(e,t,this._options),this._domListeners||(this._domListeners={}),this._domListeners[e]=t}detach(e){let t;this._domListeners[e]&&(!(t=this._events[e])||!t.callbacks.length)&&this._domListeners[e].removeListener()}_addEventListener(e,t,n){this.attach(e),ee().prototype._addEventListener.call(this,e,t,n)}_removeEventListener(e,t){ee().prototype._removeEventListener.call(this,e,t),this.detach(e)}_createDomListener(e){const t=n=>{this.fire(e,n)};return t.removeListener=()=>{this._domNode.removeEventListener(e,t,this._options),delete this._domListeners[e]},t}}function Qk(i){return i["data-ck-expando"]||(i["data-ck-expando"]=it())}function ah(i,e){let t=Qk(i);for(const n of Object.keys(e).sort())e[n]&&(t+="-"+n);return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function e5(i){const e=[];let t=i;for(;t&&t.nodeType!=Node.DOCUMENT_NODE;)e.unshift(t),t=t.parentNode;return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function t5(i){return i instanceof HTMLTextAreaElement?i.value:i.innerHTML}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function lh(i){const e=i.ownerDocument.defaultView.getComputedStyle(i);return{top:parseInt(e.borderTopWidth,10),right:parseInt(e.borderRightWidth,10),bottom:parseInt(e.borderBottomWidth,10),left:parseInt(e.borderLeftWidth,10)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function he(i){return Object.prototype.toString.call(i)=="[object Text]"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Io(i){return Object.prototype.toString.apply(i)=="[object Range]"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ch(i){return!i||!i.parentNode||i.offsetParent===I.document.body?null:i.offsetParent}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const uh=["top","right","bottom","left","width","height"];class z{constructor(e){const t=Io(e);if(Object.defineProperty(this,"_source",{value:e._source||e,writable:!0,enumerable:!1}),Ya(e)||t)if(t){const n=z.getDomRangeRects(e);Po(this,z.getBoundingRect(n))}else Po(this,e.getBoundingClientRect());else if(So(e)){const{innerWidth:n,innerHeight:s}=e;Po(this,{top:0,right:n,bottom:s,left:0,width:n,height:s})}else Po(this,e)}clone(){return new z(this)}moveTo(e,t){return this.top=t,this.right=e+this.width,this.bottom=t+this.height,this.left=e,this}moveBy(e,t){return this.top+=t,this.right+=e,this.left+=e,this.bottom+=t,this}getIntersection(e){const t={top:Math.max(this.top,e.top),right:Math.min(this.right,e.right),bottom:Math.min(this.bottom,e.bottom),left:Math.max(this.left,e.left),width:0,height:0};if(t.width=t.right-t.left,t.height=t.bottom-t.top,t.width<0||t.height<0)return null;{const n=new z(t);return n._source=this._source,n}}getIntersectionArea(e){const t=this.getIntersection(e);return t?t.getArea():0}getArea(){return this.width*this.height}getVisible(){const e=this._source;let t=this.clone();if(dh(e))return t;let n=e,s=e.parentNode||e.commonAncestorContainer,o;for(;s&&!dh(s);){const r=n5(s)==="visible";n instanceof HTMLElement&&hh(n)==="absolute"&&(o=n);const a=hh(s);if(r||o&&(a==="relative"&&r||a!=="relative")){n=s,s=s.parentNode;continue}const l=new z(s),c=t.getIntersection(l);if(c)c.getArea()<t.getArea()&&(t=c);else return null;n=s,s=s.parentNode}return t}isEqual(e){for(const t of uh)if(this[t]!==e[t])return!1;return!0}contains(e){const t=this.getIntersection(e);return!!(t&&t.isEqual(e))}toAbsoluteRect(){const{scrollX:e,scrollY:t}=I.window,n=this.clone().moveBy(e,t);if(Ya(n._source)){const s=ch(n._source);s&&i5(n,s)}return n}excludeScrollbarsAndBorders(){const e=this._source;let t,n,s;if(So(e))t=e.innerWidth-e.document.documentElement.clientWidth,n=e.innerHeight-e.document.documentElement.clientHeight,s=e.getComputedStyle(e.document.documentElement).direction;else{const o=lh(e);t=e.offsetWidth-e.clientWidth-o.left-o.right,n=e.offsetHeight-e.clientHeight-o.top-o.bottom,s=e.ownerDocument.defaultView.getComputedStyle(e).direction,this.left+=o.left,this.top+=o.top,this.right-=o.right,this.bottom-=o.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=t,s==="ltr"?this.right-=t:this.left+=t,this.height-=n,this.bottom-=n,this}static getDomRangeRects(e){const t=[],n=Array.from(e.getClientRects());if(n.length)for(const s of n)t.push(new z(s));else{let s=e.startContainer;he(s)&&(s=s.parentNode);const o=new z(s.getBoundingClientRect());o.right=o.left,o.width=0,t.push(o)}return t}static getBoundingRect(e){const t={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,width:0,height:0};let n=0;for(const s of e)n++,t.left=Math.min(t.left,s.left),t.top=Math.min(t.top,s.top),t.right=Math.max(t.right,s.right),t.bottom=Math.max(t.bottom,s.bottom);return n==0?null:(t.width=t.right-t.left,t.height=t.bottom-t.top,new z(t))}}function Po(i,e){for(const t of uh)i[t]=e[t]}function dh(i){return Ya(i)?i===i.ownerDocument.body:!1}function Ya(i){return i!==null&&typeof i=="object"&&i.nodeType===1&&typeof i.getBoundingClientRect=="function"}function hh(i){return i instanceof HTMLElement?i.ownerDocument.defaultView.getComputedStyle(i).position:"static"}function n5(i){return i instanceof HTMLElement?i.ownerDocument.defaultView.getComputedStyle(i).overflow:"visible"}function i5(i,e){const t=new z(e),n=lh(e);let s=0,o=0;s-=t.left,o-=t.top,s+=e.scrollLeft,o+=e.scrollTop,s-=n.left,o-=n.top,i.moveBy(s,o)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let rs=class pe{constructor(e,t){pe._observerInstance||pe._createObserver(),this._element=e,this._callback=t,pe._addElementCallback(e,t),pe._observerInstance.observe(e)}get element(){return this._element}destroy(){pe._deleteElementCallback(this._element,this._callback)}static _addElementCallback(e,t){pe._elementCallbacks||(pe._elementCallbacks=new Map);let n=pe._elementCallbacks.get(e);n||(n=new Set,pe._elementCallbacks.set(e,n)),n.add(t)}static _deleteElementCallback(e,t){const n=pe._getElementCallbacks(e);n&&(n.delete(t),n.size||(pe._elementCallbacks.delete(e),pe._observerInstance.unobserve(e))),pe._elementCallbacks&&!pe._elementCallbacks.size&&(pe._observerInstance=null,pe._elementCallbacks=null)}static _getElementCallbacks(e){return pe._elementCallbacks?pe._elementCallbacks.get(e):null}static _createObserver(){pe._observerInstance=new I.window.ResizeObserver(e=>{for(const t of e){const n=pe._getElementCallbacks(t.target);if(n)for(const s of n)s(t)}})}};rs._observerInstance=null,rs._elementCallbacks=null;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function fh(i,e){i instanceof HTMLTextAreaElement&&(i.value=e),i.innerHTML=e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function di(i){return e=>e+i}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function as(i){let e=0;for(;i.previousSibling;)i=i.previousSibling,e++;return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function mh(i,e,t){i.insertBefore(t,i.childNodes[e]||null)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ls(i){return i&&i.nodeType===Node.COMMENT_NODE}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function gh(i){try{I.document.createAttribute(i)}catch{return!1}return!0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function En(i){return!!(i&&i.getClientRects&&i.getClientRects().length)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ro({element:i,target:e,positions:t,limiter:n,fitInViewport:s,viewportOffsetConfig:o}){vn(e)&&(e=e()),vn(n)&&(n=n());const r=ch(i),a=s5(o),l=new z(i),c=ph(e,a);let u;if(!c||!a.getIntersection(c))return null;const d={targetRect:c,elementRect:l,positionedElementAncestor:r,viewportRect:a};if(!n&&!s)u=new bh(t[0],d);else{if(n){const h=ph(n,a);h&&(d.limiterRect=h)}u=o5(t,d)}return u}function ph(i,e){const t=new z(i).getVisible();return t?t.getIntersection(e):null}function s5(i){i=Object.assign({top:0,bottom:0,left:0,right:0},i);const e=new z(I.window);return e.top+=i.top,e.height-=i.top,e.bottom-=i.bottom,e.height-=i.bottom,e}function o5(i,e){const{elementRect:t}=e,n=t.getArea(),s=i.map(a=>new bh(a,e)).filter(a=>!!a.name);let o=0,r=null;for(const a of s){const{limiterIntersectionArea:l,viewportIntersectionArea:c}=a;if(l===n)return a;const u=c**2+l**2;u>o&&(o=u,r=a)}return r}class bh{constructor(e,t){const n=e(t.targetRect,t.elementRect,t.viewportRect,t.limiterRect);if(!n)return;const{left:s,top:o,name:r,config:a}=n;this.name=r,this.config=a,this._positioningFunctionCoordinates={left:s,top:o},this._options=t}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get limiterIntersectionArea(){const e=this._options.limiterRect;return e?e.getIntersectionArea(this._rect):0}get viewportIntersectionArea(){return this._options.viewportRect.getIntersectionArea(this._rect)}get _rect(){return this._cachedRect?this._cachedRect:(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCoordinates.left,this._positioningFunctionCoordinates.top),this._cachedRect)}get _absoluteRect(){return this._cachedAbsoluteRect?this._cachedAbsoluteRect:(this._cachedAbsoluteRect=this._rect.toAbsoluteRect(),this._cachedAbsoluteRect)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function wh(i){const e=i.parentNode;e&&e.removeChild(i)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function r5({target:i,viewportOffset:e=0,ancestorOffset:t=0,alignToTop:n,forceScroll:s}){const o=Xa(i);let r=o,a=null;for(e=c5(e);r;){let l;r==o?l=kh(i):l=kh(a),l5({parent:l,getRect:()=>Th(i,r),alignToTop:n,ancestorOffset:t,forceScroll:s});const c=Th(i,r);if(a5({window:r,rect:c,viewportOffset:e,alignToTop:n,forceScroll:s}),r.parent!=r){if(a=r.frameElement,r=r.parent,!a)return}else r=null}}function a5({window:i,rect:e,alignToTop:t,forceScroll:n,viewportOffset:s}){const o=e.clone().moveBy(0,s.bottom),r=e.clone().moveBy(0,-s.top),a=new z(i).excludeScrollbarsAndBorders(),l=[r,o],c=t&&n,u=l.every(g=>a.contains(g));let{scrollX:d,scrollY:h}=i;const f=d,m=h;c?h-=a.top-e.top+s.top:u||(vh(r,a)?h-=a.top-e.top+s.top:_h(o,a)&&(t?h+=e.top-a.top-s.top:h+=e.bottom-a.bottom+s.bottom)),u||(yh(e,a)?d-=a.left-e.left+s.left:Ch(e,a)&&(d+=e.right-a.right+s.right)),(d!=f||h!==m)&&i.scrollTo(d,h)}function l5({parent:i,getRect:e,alignToTop:t,forceScroll:n,ancestorOffset:s=0,limiterElement:o}){const r=Xa(i),a=t&&n;let l,c,u;const d=o||r.document.body;for(;i!=d;)c=e(),l=new z(i).excludeScrollbarsAndBorders(),u=l.contains(c),a?i.scrollTop-=l.top-c.top+s:u||(vh(c,l)?i.scrollTop-=l.top-c.top+s:_h(c,l)&&(t?i.scrollTop+=c.top-l.top-s:i.scrollTop+=c.bottom-l.bottom+s)),u||(yh(c,l)?i.scrollLeft-=l.left-c.left+s:Ch(c,l)&&(i.scrollLeft+=c.right-l.right+s)),i=i.parentNode}function _h(i,e){return i.bottom>e.bottom}function vh(i,e){return i.top<e.top}function yh(i,e){return i.left<e.left}function Ch(i,e){return i.right>e.right}function Xa(i){return Io(i)?i.startContainer.ownerDocument.defaultView:i.ownerDocument.defaultView}function kh(i){if(Io(i)){let e=i.commonAncestorContainer;return he(e)&&(e=e.parentNode),e}else return i.parentNode}function Th(i,e){const t=Xa(i),n=new z(i);if(t===e)return n;{let s=t;for(;s!=e;){const o=s.frameElement,r=new z(o).excludeScrollbarsAndBorders();n.moveBy(r.left,r.top),s=s.parent}}return n}function c5(i){return typeof i=="number"?{top:i,bottom:i,left:i,right:i}:i}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const u5={ctrl:"⌃",cmd:"⌘",alt:"⌥",shift:"⇧"},d5={ctrl:"Ctrl+",alt:"Alt+",shift:"Shift+"},Eh={37:"←",38:"↑",39:"→",40:"↓",9:"⇥",33:"Page Up",34:"Page Down"},U=p5(),h5=Object.fromEntries(Object.entries(U).map(([i,e])=>{let t;return e in Eh?t=Eh[e]:t=i.charAt(0).toUpperCase()+i.slice(1),[e,t]}));function hi(i){let e;if(typeof i=="string"){if(e=U[i.toLowerCase()],!e)throw new p("keyboard-unknown-key",null,{key:i})}else e=i.keyCode+(i.altKey?U.alt:0)+(i.ctrlKey?U.ctrl:0)+(i.shiftKey?U.shift:0)+(i.metaKey?U.cmd:0);return e}function cs(i){return typeof i=="string"&&(i=b5(i)),i.map(e=>typeof e=="string"?m5(e):e).reduce((e,t)=>t+e,0)}function Mo(i){let e=cs(i);return Object.entries($.isMac||$.isiOS?u5:d5).reduce((s,[o,r])=>(e&U[o]&&(e&=~U[o],s+=r),s),"")+(e?h5[e]:"")}function f5(i){return i==U.arrowright||i==U.arrowleft||i==U.arrowup||i==U.arrowdown}function Qa(i,e){const t=e==="ltr";switch(i){case U.arrowleft:return t?"left":"right";case U.arrowright:return t?"right":"left";case U.arrowup:return"up";case U.arrowdown:return"down"}}function m5(i){if(i.endsWith("!"))return hi(i.slice(0,-1));const e=hi(i);return($.isMac||$.isiOS)&&e==U.ctrl?U.cmd:e}function g5(i,e){const t=Qa(i,e);return t==="down"||t==="right"}function p5(){const i={pageup:33,pagedown:34,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,shift:2228224,alt:4456448,cmd:8912896};for(let e=65;e<=90;e++){const t=String.fromCharCode(e);i[t.toLowerCase()]=e}for(let e=48;e<=57;e++)i[e-48]=e;for(let e=112;e<=123;e++)i["f"+(e-111)]=e;return Object.assign(i,{"'":222,",":108,"-":109,".":110,"/":111,";":186,"=":187,"[":219,"\\":220,"]":221,"`":223}),i}function b5(i){return i.split("+").map(e=>e.trim())}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const w5=["ar","ara","dv","div","fa","per","fas","he","heb","ku","kur","ug","uig"];function Ah(i){return w5.includes(i)?"rtl":"ltr"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function J(i){return Array.isArray(i)?i:[i]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//* istanbul ignore else -- @preserve */I.window.CKEDITOR_TRANSLATIONS||(I.window.CKEDITOR_TRANSLATIONS={});function _5(i,e,t=1,n){if(typeof t!="number")throw new p("translation-service-quantity-not-a-number",null,{quantity:t});const s=n||I.window.CKEDITOR_TRANSLATIONS,o=C5(s);o===1&&(i=Object.keys(s)[0]);const r=e.id||e.string;if(o===0||!y5(i,r,s))return t!==1?e.plural:e.string;const a=s[i].dictionary,l=s[i].getPluralForm||(d=>d===1?0:1),c=a[r];if(typeof c=="string")return c;const u=Number(l(t));return c[u]}function v5(i){return Array.isArray(i)?i.reduce((e,t)=>Ka(e,t)):i}function y5(i,e,t){return!!t[i]&&!!t[i].dictionary[e]}function C5(i){return Object.keys(i).length}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class k5{constructor({uiLanguage:e="en",contentLanguage:t,translations:n}={}){this.uiLanguage=e,this.contentLanguage=t||this.uiLanguage,this.uiLanguageDirection=Ah(this.uiLanguage),this.contentLanguageDirection=Ah(this.contentLanguage),this.translations=v5(n),this.t=(s,o)=>this._t(s,o)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(e,t=[]){t=J(t),typeof e=="string"&&(e={string:e});const s=!!e.plural?t[0]:1,o=_5(this.uiLanguage,e,s,this.translations);return T5(o,t)}}function T5(i,e){return i.replace(/%(\d+)/g,(t,n)=>n<e.length?e[n]:t)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Oe extends ee(){constructor(e={},t={}){super();const n=je(e);if(n||(t=e),this._items=[],this._itemMap=new Map,this._idProperty=t.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],n)for(const s of e)this._items.push(s),this._itemMap.set(this._getItemIdBeforeAdding(s),s)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(e,t){return this.addMany([e],t)}addMany(e,t){if(t===void 0)t=this._items.length;else if(t>this._items.length||t<0)throw new p("collection-add-item-invalid-index",this);let n=0;for(const s of e){const o=this._getItemIdBeforeAdding(s),r=t+n;this._items.splice(r,0,s),this._itemMap.set(o,s),this.fire("add",s,r),n++}return this.fire("change",{added:e,removed:[],index:t}),this}get(e){let t;if(typeof e=="string")t=this._itemMap.get(e);else if(typeof e=="number")t=this._items[e];else throw new p("collection-get-invalid-arg",this);return t||null}has(e){if(typeof e=="string")return this._itemMap.has(e);{const t=this._idProperty,n=e[t];return n&&this._itemMap.has(n)}}getIndex(e){let t;return typeof e=="string"?t=this._itemMap.get(e):t=e,t?this._items.indexOf(t):-1}remove(e){const[t,n]=this._remove(e);return this.fire("change",{added:[],removed:[t],index:n}),t}map(e,t){return this._items.map(e,t)}forEach(e,t){this._items.forEach(e,t)}find(e,t){return this._items.find(e,t)}filter(e,t){return this._items.filter(e,t)}clear(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);const e=Array.from(this._items);for(;this.length;)this._remove(0);this.fire("change",{added:[],removed:e,index:0})}bindTo(e){if(this._bindToCollection)throw new p("collection-bind-to-rebind",this);return this._bindToCollection=e,{as:t=>{this._setUpBindToBinding(n=>new t(n))},using:t=>{typeof t=="function"?this._setUpBindToBinding(t):this._setUpBindToBinding(n=>n[t])}}}_setUpBindToBinding(e){const t=this._bindToCollection,n=(s,o,r)=>{const a=t._bindToCollection==this,l=t._bindToInternalToExternalMap.get(o);if(a&&l)this._bindToExternalToInternalMap.set(o,l),this._bindToInternalToExternalMap.set(l,o);else{const c=e(o);if(!c){this._skippedIndexesFromExternal.push(r);return}let u=r;for(const d of this._skippedIndexesFromExternal)r>d&&u--;for(const d of t._skippedIndexesFromExternal)u>=d&&u++;this._bindToExternalToInternalMap.set(o,c),this._bindToInternalToExternalMap.set(c,o),this.add(c,u);for(let d=0;d<t._skippedIndexesFromExternal.length;d++)u<=t._skippedIndexesFromExternal[d]&&t._skippedIndexesFromExternal[d]++}};for(const s of t)n(null,s,t.getIndex(s));this.listenTo(t,"add",n),this.listenTo(t,"remove",(s,o,r)=>{const a=this._bindToExternalToInternalMap.get(o);a&&this.remove(a),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((l,c)=>(r<c&&l.push(c-1),r>c&&l.push(c),l),[])})}_getItemIdBeforeAdding(e){const t=this._idProperty;let n;if(t in e){if(n=e[t],typeof n!="string")throw new p("collection-add-invalid-id",this);if(this.get(n))throw new p("collection-add-item-already-exists",this)}else e[t]=n=it();return n}_remove(e){let t,n,s,o=!1;const r=this._idProperty;if(typeof e=="string"?(n=e,s=this._itemMap.get(n),o=!s,s&&(t=this._items.indexOf(s))):typeof e=="number"?(t=e,s=this._items[t],o=!s,s&&(n=s[r])):(s=e,n=s[r],t=this._items.indexOf(s),o=t==-1||!this._itemMap.get(n)),o)throw new p("collection-remove-404",this);this._items.splice(t,1),this._itemMap.delete(n);const a=this._bindToInternalToExternalMap.get(s);return this._bindToInternalToExternalMap.delete(s),this._bindToExternalToInternalMap.delete(a),this.fire("remove",s,t),[s,t]}[Symbol.iterator](){return this._items[Symbol.iterator]()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ce(i){const e=i.next();return e.done?null:e.value}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class be extends qe(re()){constructor(){super(),this._elements=new Set,this._nextEventLoopTimeout=null,this.set("isFocused",!1),this.set("focusedElement",null)}add(e){if(this._elements.has(e))throw new p("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",()=>this._focus(e),{useCapture:!0}),this.listenTo(e,"blur",()=>this._blur(),{useCapture:!0}),this._elements.add(e)}remove(e){e===this.focusedElement&&this._blur(),this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e))}destroy(){this.stopListening()}_focus(e){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=e,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Te{constructor(){this._listener=new(qe())}listenTo(e){this._listener.listenTo(e,"keydown",(t,n)=>{this._listener.fire("_keydown:"+hi(n),n)})}set(e,t,n={}){const s=cs(e),o=n.priority;this._listener.listenTo(this._listener,"_keydown:"+s,(r,a)=>{t(a,()=>{a.preventDefault(),a.stopPropagation(),r.stop()}),r.return=!0},{priority:o})}press(e){return!!this._listener.fire("_keydown:"+hi(e),e)}stopListening(e){this._listener.stopListening(e)}destroy(){this.stopListening()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function E5(i){const e=new Map;for(const t in i)e.set(t,i[t]);return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function _t(i){return je(i)?new Map(i):E5(i)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const A5=1e4;function x5(i,e,t,n){if(Math.max(e.length,i.length)>A5)return i.slice(0,t).concat(e).concat(i.slice(t+n,i.length));{const s=Array.from(i);return s.splice(t,n,...e),s}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function el(i,e){let t;function n(...s){n.cancel(),t=setTimeout(()=>i(...s),e)}return n.cancel=()=>{clearTimeout(t)},n}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function S5(i){function e(d){return d.length>=40&&d.length<=255?"VALID":"INVALID"}if(!i)return"INVALID";let t="";try{t=atob(i)}catch{return"INVALID"}const n=t.split("-"),s=n[0],o=n[1];if(!o)return e(i);try{atob(o)}catch{try{if(atob(s),!atob(s).length)return e(i)}catch{return e(i)}}if(s.length<40||s.length>255)return"INVALID";let r="";try{atob(s),r=atob(o)}catch{return"INVALID"}if(r.length!==8)return"INVALID";const a=Number(r.substring(0,4)),l=Number(r.substring(4,6))-1,c=Number(r.substring(6,8)),u=new Date(a,l,c);return u<rw||isNaN(Number(u))?"INVALID":"VALID"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function I5(i){return!!i&&i.length==1&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(i)}function P5(i){return!!i&&i.length==1&&/[\ud800-\udbff]/.test(i)}function R5(i){return!!i&&i.length==1&&/[\udc00-\udfff]/.test(i)}function tl(i,e){return P5(i.charAt(e-1))&&R5(i.charAt(e))}function nl(i,e){return I5(i.charAt(e))}const M5=B5();function xh(i,e){const t=String(i).matchAll(M5);return Array.from(t).some(n=>n.index<e&&e<n.index+n[0].length)}function B5(){const i=[new RegExp("\\p{Emoji}[\\u{E0020}-\\u{E007E}]+\\u{E007F}","u"),new RegExp("\\p{Emoji}\\u{FE0F}?\\u{20E3}","u"),new RegExp("\\p{Emoji}\\u{FE0F}","u"),new RegExp("(?=\\p{General_Category=Other_Symbol})\\p{Emoji}\\p{Emoji_Modifier}*","u")],e=new RegExp("\\p{Regional_Indicator}{2}","u").source,t="(?:"+i.map(s=>s.source).join("|")+")",n=`${e}|${t}(?:‍${t})*`;return new RegExp(n,"ug")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class y extends re(){constructor(e){super(),this._disableStack=new Set,this.editor=e,this.set("isEnabled",!0)}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",Sh,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",Sh),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}}function Sh(i){i.return=!1,i.stop()}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class F extends re(){constructor(e){super(),this.editor=e,this.set("value",void 0),this.set("isEnabled",!1),this._affectsData=!0,this._isEnabledBasedOnSelection=!0,this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",()=>{this.refresh()}),this.listenTo(e,"change:isReadOnly",()=>{this.refresh()}),this.on("set:isEnabled",t=>{if(!this.affectsData)return;const n=e.model.document.selection,o=!(n.getFirstPosition().root.rootName=="$graveyard")&&e.model.canEditAt(n);(e.isReadOnly||this._isEnabledBasedOnSelection&&!o)&&(t.return=!1,t.stop())},{priority:"highest"}),this.on("execute",t=>{this.isEnabled||t.stop()},{priority:"high"})}get affectsData(){return this._affectsData}set affectsData(e){this._affectsData=e}refresh(){this.isEnabled=!0}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",Ih,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",Ih),this.refresh())}execute(...e){}destroy(){this.stopListening()}}function Ih(i){i.return=!1,i.stop()}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ph extends F{constructor(){super(...arguments),this._childCommandsDefinitions=[]}refresh(){}execute(...e){const t=this._getFirstEnabledCommand();return!!t&&t.execute(e)}registerChildCommand(e,t={}){mu(this._childCommandsDefinitions,{command:e,priority:t.priority||"normal"}),e.on("change:isEnabled",()=>this._checkEnabled()),this._checkEnabled()}_checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand()}_getFirstEnabledCommand(){const e=this._childCommandsDefinitions.find(({command:t})=>t.isEnabled);return e&&e.command}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Rh extends ee(){constructor(e,t=[],n=[]){super(),this._plugins=new Map,this._context=e,this._availablePlugins=new Map;for(const s of t)s.pluginName&&this._availablePlugins.set(s.pluginName,s);this._contextPlugins=new Map;for(const[s,o]of n)this._contextPlugins.set(s,o),this._contextPlugins.set(o,s),s.pluginName&&this._availablePlugins.set(s.pluginName,s)}*[Symbol.iterator](){for(const e of this._plugins)typeof e[0]=="function"&&(yield e)}get(e){const t=this._plugins.get(e);if(!t){let n=e;throw typeof e=="function"&&(n=e.pluginName||e.name),new p("plugincollection-plugin-not-loaded",this._context,{plugin:n})}return t}has(e){return this._plugins.has(e)}init(e,t=[],n=[]){const s=this,o=this._context;f(e),g(e);const r=e.filter(S=>!d(S,t)),a=[...m(r)];W(a,n);const l=O(a);return B(l,"init").then(()=>B(l,"afterInit")).then(()=>l);function c(S){return typeof S=="function"}function u(S){return c(S)&&!!S.isContextPlugin}function d(S,V){return V.some(E=>E===S||h(S)===E||h(E)===S)}function h(S){return c(S)?S.pluginName||S.name:S}function f(S,V=new Set){S.forEach(E=>{c(E)&&(V.has(E)||(V.add(E),E.pluginName&&!s._availablePlugins.has(E.pluginName)&&s._availablePlugins.set(E.pluginName,E),E.requires&&f(E.requires,V)))})}function m(S,V=new Set){return S.map(E=>c(E)?E:s._availablePlugins.get(E)).reduce((E,L)=>V.has(L)?E:(V.add(L),L.requires&&(g(L.requires,L),m(L.requires,V).forEach(K=>E.add(K))),E.add(L)),new Set)}function g(S,V=null){S.map(E=>c(E)?E:s._availablePlugins.get(E)||E).forEach(E=>{b(E,V),_(E,V),T(E,V)})}function b(S,V){if(!c(S))throw V?new p("plugincollection-soft-required",o,{missingPlugin:S,requiredBy:h(V)}):new p("plugincollection-plugin-not-found",o,{plugin:S})}function _(S,V){if(u(V)&&!u(S))throw new p("plugincollection-context-required",o,{plugin:h(S),requiredBy:h(V)})}function T(S,V){if(V&&d(S,t))throw new p("plugincollection-required",o,{plugin:h(S),requiredBy:h(V)})}function O(S){return S.map(V=>{let E=s._contextPlugins.get(V);return E=E||new V(o),s._add(V,E),E})}function B(S,V){return S.reduce((E,L)=>!L[V]||s._contextPlugins.has(L)?E:E.then(L[V].bind(L)),Promise.resolve())}function W(S,V){for(const E of V){if(typeof E!="function")throw new p("plugincollection-replace-plugin-invalid-type",null,{pluginItem:E});const L=E.pluginName;if(!L)throw new p("plugincollection-replace-plugin-missing-name",null,{pluginItem:E});if(E.requires&&E.requires.length)throw new p("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:L});const K=s._availablePlugins.get(L);if(!K)throw new p("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:L});const He=S.indexOf(K);if(He===-1){if(s._contextPlugins.has(K))return;throw new p("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:L})}if(K.requires&&K.requires.length)throw new p("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:L});S.splice(He,1,E),s._availablePlugins.set(L,E)}}}destroy(){const e=[];for(const[,t]of this)typeof t.destroy=="function"&&!this._contextPlugins.has(t)&&e.push(t.destroy());return Promise.all(e)}_add(e,t){this._plugins.set(e,t);const n=e.pluginName;if(n){if(this._plugins.has(n))throw new p("plugincollection-plugin-name-conflict",null,{pluginName:n,plugin1:this._plugins.get(n).constructor,plugin2:e});this._plugins.set(n,t)}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Mh{constructor(e){this._contextOwner=null;const{translations:t,...n}=e||{};this.config=new sh(n,this.constructor.defaultConfig);const s=this.constructor.builtinPlugins;this.config.define("plugins",s),this.plugins=new Rh(this,s);const o=this.config.get("language")||{};this.locale=new k5({uiLanguage:typeof o=="string"?o:o.ui,contentLanguage:this.config.get("language.content"),translations:t}),this.t=this.locale.t,this.editors=new Oe}initPlugins(){const e=this.config.get("plugins")||[],t=this.config.get("substitutePlugins")||[];for(const n of e.concat(t)){if(typeof n!="function")throw new p("context-initplugins-constructor-only",null,{Plugin:n});if(n.isContextPlugin!==!0)throw new p("context-initplugins-invalid-plugin",null,{Plugin:n})}return this.plugins.init(e,[],t)}destroy(){return Promise.all(Array.from(this.editors,e=>e.destroy())).then(()=>this.plugins.destroy())}_addEditor(e,t){if(this._contextOwner)throw new p("context-addeditor-private-context");this.editors.add(e),t&&(this._contextOwner=e)}_removeEditor(e){return this.editors.has(e)&&this.editors.remove(e),this._contextOwner===e?this.destroy():Promise.resolve()}_getEditorConfig(){const e={};for(const t of this.config.names())["plugins","removePlugins","extraPlugins"].includes(t)||(e[t]=this.config.get(t));return e}static create(e){return new Promise(t=>{const n=new this(e);t(n.initPlugins().then(()=>n))})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class O5 extends re(){constructor(e){super(),this.context=e}destroy(){this.stopListening()}static get isContextPlugin(){return!0}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Bo=new WeakMap;let Bh=!1;function Oo({view:i,element:e,text:t,isDirectHost:n=!0,keepOnFocus:s=!1}){const o=i.document;Bo.has(o)||(Bo.set(o,new Map),o.registerPostFixer(a=>il(o,a)),o.on("change:isComposing",()=>{i.change(a=>il(o,a))},{priority:"high"})),e.is("editableElement")&&e.on("change:placeholder",(a,l,c)=>{r(c)}),e.placeholder?r(e.placeholder):t&&r(t),t&&F5();function r(a){Bo.get(o).set(e,{text:a,isDirectHost:n,keepOnFocus:s,hostElement:n?e:null}),i.change(l=>il(o,l))}}function L5(i,e){return e.hasClass("ck-placeholder")?!1:(i.addClass("ck-placeholder",e),!0)}function V5(i,e){return e.hasClass("ck-placeholder")?(i.removeClass("ck-placeholder",e),!0):!1}function D5(i,e){if(!i.isAttached()||Array.from(i.getChildren()).some(r=>!r.is("uiElement")))return!1;const n=i.document,o=n.selection.anchor;return n.isComposing&&o&&o.parent===i?!1:e||!n.isFocused?!0:!!o&&o.parent!==i}function il(i,e){const t=Bo.get(i),n=[];let s=!1;for(const[o,r]of t)r.isDirectHost&&(n.push(o),Oh(e,o,r)&&(s=!0));for(const[o,r]of t){if(r.isDirectHost)continue;const a=N5(o);a&&(n.includes(a)||(r.hostElement=a,Oh(e,o,r)&&(s=!0)))}return s}function Oh(i,e,t){const{text:n,isDirectHost:s,hostElement:o}=t;let r=!1;return o.getAttribute("data-placeholder")!==n&&(i.setAttribute("data-placeholder",n,o),r=!0),(s||e.childCount==1)&&D5(o,t.keepOnFocus)?L5(i,o)&&(r=!0):V5(i,o)&&(r=!0),r}function N5(i){if(i.childCount){const e=i.getChild(0);if(e.is("element")&&!e.is("uiElement")&&!e.is("attributeElement"))return e}return null}function F5(){Bh||Q("enableplaceholder-deprecated-text-option"),Bh=!0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let An=class{is(){throw new Error("is() method is abstract")}};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let xn=class extends ee(An){constructor(e){super(),this.document=e,this.parent=null}get index(){let e;if(!this.parent)return null;if((e=this.parent.getChildIndex(this))==-1)throw new p("view-node-not-found-in-parent",this);return e}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let t=this;for(;t.parent;)e.unshift(t.index),t=t.parent;return e}getAncestors(e={}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}getCommonAncestor(e,t={}){const n=this.getAncestors(t),s=e.getAncestors(t);let o=0;for(;n[o]==s[o]&&n[o];)o++;return o===0?null:n[o-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const t=this.getPath(),n=e.getPath(),s=Be(t,n);switch(s){case"prefix":return!0;case"extension":return!1;default:return t[s]<n[s]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}_remove(){this.parent._removeChildren(this.index)}_fireChange(e,t){this.fire(`change:${e}`,t),this.parent&&this.parent._fireChange(e,t)}toJSON(){const e=Ud(this);return delete e.parent,e}};xn.prototype.is=function(i){return i==="node"||i==="view:node"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let le=class lu extends xn{constructor(e,t){super(e),this._textData=t}get data(){return this._textData}get _data(){return this.data}set _data(e){this._fireChange("text",this),this._textData=e}isSimilar(e){return e instanceof lu?this===e||this.data===e.data:!1}_clone(){return new lu(this.document,this.data)}};le.prototype.is=function(i){return i==="$text"||i==="view:$text"||i==="text"||i==="view:text"||i==="node"||i==="view:node"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let It=class extends An{constructor(e,t,n){if(super(),this.textNode=e,t<0||t>e.data.length)throw new p("view-textproxy-wrong-offsetintext",this);if(n<0||t+n>e.data.length)throw new p("view-textproxy-wrong-length",this);this.data=e.data.substring(t,t+n),this.offsetInText=t}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}getAncestors(e={}){const t=[];let n=e.includeSelf?this.textNode:this.parent;for(;n!==null;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}};It.prototype.is=function(i){return i==="$textProxy"||i==="view:$textProxy"||i==="textProxy"||i==="view:textProxy"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ge{constructor(...e){this._patterns=[],this.add(...e)}add(...e){for(let t of e)(typeof t=="string"||t instanceof RegExp)&&(t={name:t}),this._patterns.push(t)}match(...e){for(const t of e)for(const n of this._patterns){const s=Lh(t,n);if(s)return{element:t,pattern:n,match:s}}return null}matchAll(...e){const t=[];for(const n of e)for(const s of this._patterns){const o=Lh(n,s);o&&t.push({element:n,pattern:s,match:o})}return t.length>0?t:null}getElementName(){if(this._patterns.length!==1)return null;const e=this._patterns[0],t=e.name;return typeof e!="function"&&t&&!(t instanceof RegExp)?t:null}}function Lh(i,e){if(typeof e=="function")return e(i);const t={};return e.name&&(t.name=$5(e.name,i.name),!t.name)||e.attributes&&(t.attributes=W5(e.attributes,i),!t.attributes)||e.classes&&(t.classes=j5(e.classes,i),!t.classes)||e.styles&&(t.styles=q5(e.styles,i),!t.styles)?null:t}function $5(i,e){return i instanceof RegExp?!!e.match(i):i===e}function sl(i,e,t){const n=U5(i),s=Array.from(e),o=[];if(n.forEach(([r,a])=>{s.forEach(l=>{z5(r,l)&&H5(a,l,t)&&o.push(l)})}),!(!n.length||o.length<n.length))return o}function U5(i){return Array.isArray(i)?i.map(e=>De(e)?((e.key===void 0||e.value===void 0)&&Q("matcher-pattern-missing-key-or-value",e),[e.key,e.value]):[e,!0]):De(i)?Object.entries(i):[[i,!0]]}function z5(i,e){return i===!0||i===e||i instanceof RegExp&&e.match(i)}function H5(i,e,t){if(i===!0)return!0;const n=t(e);return i===n||i instanceof RegExp&&!!String(n).match(i)}function W5(i,e){const t=new Set(e.getAttributeKeys());return De(i)?(i.style!==void 0&&Q("matcher-pattern-deprecated-attributes-style-key",i),i.class!==void 0&&Q("matcher-pattern-deprecated-attributes-class-key",i)):(t.delete("style"),t.delete("class")),sl(i,t,n=>e.getAttribute(n))}function j5(i,e){return sl(i,e.getClassNames(),()=>{})}function q5(i,e){return sl(i,e.getStyleNames(!0),t=>e.getStyle(t))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Lo{constructor(e){this._styles={},this._styleProcessor=e}get isEmpty(){return!Object.entries(this._styles).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(e){this.clear();const t=K5(e);for(const[n,s]of t)this._styleProcessor.toNormalizedForm(n,s,this._styles)}has(e){if(this.isEmpty)return!1;const n=this._styleProcessor.getReducedForm(e,this._styles).find(([s])=>s===e);return Array.isArray(n)}set(e,t){if(ie(e))for(const[n,s]of Object.entries(e))this._styleProcessor.toNormalizedForm(n,s,this._styles);else this._styleProcessor.toNormalizedForm(e,t,this._styles)}remove(e){const t=ol(e);zk(this._styles,t),delete this._styles[e],this._cleanEmptyObjectsOnPath(t)}getNormalized(e){return this._styleProcessor.getNormalized(e,this._styles)}toString(){return this.isEmpty?"":this.getStylesEntries().map(e=>e.join(":")).sort().join(";")+";"}getAsString(e){if(this.isEmpty)return;if(this._styles[e]&&!ie(this._styles[e]))return this._styles[e];const n=this._styleProcessor.getReducedForm(e,this._styles).find(([s])=>s===e);if(Array.isArray(n))return n[1]}getStyleNames(e=!1){return this.isEmpty?[]:e?this._styleProcessor.getStyleNames(this._styles):this.getStylesEntries().map(([n])=>n)}clear(){this._styles={}}getStylesEntries(){const e=[],t=Object.keys(this._styles);for(const n of t)e.push(...this._styleProcessor.getReducedForm(n,this._styles));return e}_cleanEmptyObjectsOnPath(e){const t=e.split(".");if(!(t.length>1))return;const s=t.splice(0,t.length-1).join("."),o=is(this._styles,s);if(!o)return;!Object.keys(o).length&&this.remove(s)}}class G5{constructor(){this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(e,t,n){if(ie(t)){rl(n,ol(e),t);return}if(this._normalizers.has(e)){const s=this._normalizers.get(e),{path:o,value:r}=s(t);rl(n,o,r)}else rl(n,e,t)}getNormalized(e,t){if(!e)return Ka({},t);if(t[e]!==void 0)return t[e];if(this._extractors.has(e)){const n=this._extractors.get(e);if(typeof n=="string")return is(t,n);const s=n(e,t);if(s)return s}return is(t,ol(e))}getReducedForm(e,t){const n=this.getNormalized(e,t);return n===void 0?[]:this._reducers.has(e)?this._reducers.get(e)(n):[[e,n]]}getStyleNames(e){const t=Array.from(this._consumables.keys()).filter(s=>{const o=this.getNormalized(s,e);return o&&typeof o=="object"?Object.keys(o).length:o}),n=new Set([...t,...Object.keys(e)]);return Array.from(n)}getRelatedStyles(e){return this._consumables.get(e)||[]}setNormalizer(e,t){this._normalizers.set(e,t)}setExtractor(e,t){this._extractors.set(e,t)}setReducer(e,t){this._reducers.set(e,t)}setStyleRelation(e,t){this._mapStyleNames(e,t);for(const n of t)this._mapStyleNames(n,[e])}_mapStyleNames(e,t){this._consumables.has(e)||this._consumables.set(e,[]),this._consumables.get(e).push(...t)}}function K5(i){let e=null,t=0,n=0,s=null;const o=new Map;if(i==="")return o;i.charAt(i.length-1)!=";"&&(i=i+";");for(let r=0;r<i.length;r++){const a=i.charAt(r);if(e===null)switch(a){case":":s||(s=i.substr(t,r-t),n=r+1);break;case'"':case"'":e=a;break;case";":{const l=i.substr(n,r-n);s&&o.set(s.trim(),l.trim()),s=null,t=r+1;break}}else a===e&&(e=null)}return o}function ol(i){return i.replace("-",".")}function rl(i,e,t){let n=t;ie(t)&&(n=Ka({},is(i,e),t)),Fk(i,e,n)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let vt=class $0 extends xn{constructor(e,t,n,s){if(super(e),this._unsafeAttributesToRender=[],this._customProperties=new Map,this.name=t,this._attrs=Z5(n),this._children=[],s&&this._insertChild(0,s),this._classes=new Set,this._attrs.has("class")){const o=this._attrs.get("class");Vh(this._classes,o),this._attrs.delete("class")}this._styles=new Lo(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style"))}get childCount(){return this._children.length}get isEmpty(){return this._children.length===0}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(e){if(e=="class")return this._classes.size>0?[...this._classes].join(" "):void 0;if(e=="style"){const t=this._styles.toString();return t==""?void 0:t}return this._attrs.get(e)}hasAttribute(e){return e=="class"?this._classes.size>0:e=="style"?!this._styles.isEmpty:this._attrs.has(e)}isSimilar(e){if(!(e instanceof $0))return!1;if(this===e)return!0;if(this.name!=e.name||this._attrs.size!==e._attrs.size||this._classes.size!==e._classes.size||this._styles.size!==e._styles.size)return!1;for(const[t,n]of this._attrs)if(!e._attrs.has(t)||e._attrs.get(t)!==n)return!1;for(const t of this._classes)if(!e._classes.has(t))return!1;for(const t of this._styles.getStyleNames())if(!e._styles.has(t)||e._styles.getAsString(t)!==this._styles.getAsString(t))return!1;return!0}hasClass(...e){for(const t of e)if(!this._classes.has(t))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(e){return this._styles.getAsString(e)}getNormalizedStyle(e){return this._styles.getNormalized(e)}getStyleNames(e){return this._styles.getStyleNames(e)}hasStyle(...e){for(const t of e)if(!this._styles.has(t))return!1;return!0}findAncestor(...e){const t=new Ge(...e);let n=this.parent;for(;n&&!n.is("documentFragment");){if(t.match(n))return n;n=n.parent}return null}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const e=Array.from(this._classes).sort().join(","),t=this._styles.toString(),n=Array.from(this._attrs).map(s=>`${s[0]}="${s[1]}"`).sort().join(" ");return this.name+(e==""?"":` class="${e}"`)+(t?` style="${t}"`:"")+(n==""?"":` ${n}`)}shouldRenderUnsafeAttribute(e){return this._unsafeAttributesToRender.includes(e)}_clone(e=!1){const t=[];if(e)for(const s of this.getChildren())t.push(s._clone(e));const n=new this.constructor(this.document,this.name,this._attrs,t);return n._classes=new Set(this._classes),n._styles.set(this._styles.getNormalized()),n._customProperties=new Map(this._customProperties),n.getFillerOffset=this.getFillerOffset,n._unsafeAttributesToRender=this._unsafeAttributesToRender,n}_appendChild(e){return this._insertChild(this.childCount,e)}_insertChild(e,t){this._fireChange("children",this);let n=0;const s=J5(this.document,t);for(const o of s)o.parent!==null&&o._remove(),o.parent=this,o.document=this.document,this._children.splice(e,0,o),e++,n++;return n}_removeChildren(e,t=1){this._fireChange("children",this);for(let n=e;n<e+t;n++)this._children[n].parent=null;return this._children.splice(e,t)}_setAttribute(e,t){const n=String(t);this._fireChange("attributes",this),e=="class"?Vh(this._classes,n):e=="style"?this._styles.setTo(n):this._attrs.set(e,n)}_removeAttribute(e){return this._fireChange("attributes",this),e=="class"?this._classes.size>0?(this._classes.clear(),!0):!1:e=="style"?this._styles.isEmpty?!1:(this._styles.clear(),!0):this._attrs.delete(e)}_addClass(e){this._fireChange("attributes",this);for(const t of J(e))this._classes.add(t)}_removeClass(e){this._fireChange("attributes",this);for(const t of J(e))this._classes.delete(t)}_setStyle(e,t){this._fireChange("attributes",this),typeof e!="string"?this._styles.set(e):this._styles.set(e,t)}_removeStyle(e){this._fireChange("attributes",this);for(const t of J(e))this._styles.remove(t)}_setCustomProperty(e,t){this._customProperties.set(e,t)}_removeCustomProperty(e){return this._customProperties.delete(e)}};vt.prototype.is=function(i,e){return e?e===this.name&&(i==="element"||i==="view:element"):i==="element"||i==="view:element"||i==="node"||i==="view:node"};function Z5(i){const e=_t(i);for(const[t,n]of e)n===null?e.delete(t):typeof n!="string"&&e.set(t,String(n));return e}function Vh(i,e){const t=e.split(/\s+/);i.clear(),t.forEach(n=>i.add(n))}function J5(i,e){return typeof e=="string"?[new le(i,e)]:(je(e)||(e=[e]),Array.from(e).map(t=>typeof t=="string"?new le(i,t):t instanceof It?new le(i,t.data):t))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class us extends vt{constructor(e,t,n,s){super(e,t,n,s),this.getFillerOffset=Y5}}us.prototype.is=function(i,e){return e?e===this.name&&(i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"):i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function Y5(){const i=[...this.getChildren()],e=i[this.childCount-1];if(e&&e.is("element","br"))return this.childCount;for(const t of i)if(!t.is("uiElement"))return null;return this.childCount}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Vo extends re(us){constructor(e,t,n,s){super(e,t,n,s),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("placeholder",void 0),this.bind("isReadOnly").to(e),this.bind("isFocused").to(e,"isFocused",o=>o&&e.selection.editableElement==this),this.listenTo(e.selection,"change",()=>{this.isFocused=e.isFocused&&e.selection.editableElement==this})}destroy(){this.stopListening()}}Vo.prototype.is=function(i,e){return e?e===this.name&&(i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"):i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Dh=Symbol("rootName");class Nh extends Vo{constructor(e,t){super(e,t),this.rootName="main"}get rootName(){return this.getCustomProperty(Dh)}set rootName(e){this._setCustomProperty(Dh,e)}set _name(e){this.name=e}}Nh.prototype.is=function(i,e){return e?e===this.name&&(i==="rootElement"||i==="view:rootElement"||i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"):i==="rootElement"||i==="view:rootElement"||i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Sn=class{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new p("view-tree-walker-no-start-position",null);if(e.direction&&e.direction!="forward"&&e.direction!="backward")throw new p("view-tree-walker-unknown-direction",e.startPosition,{direction:e.direction});this.boundaries=e.boundaries||null,e.startPosition?this._position=x._createAt(e.startPosition):this._position=x._createAt(e.boundaries[e.direction=="backward"?"end":"start"]),this.direction=e.direction||"forward",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}get position(){return this._position}skip(e){let t,n;do n=this.position,t=this.next();while(!t.done&&e(t.value));t.done||(this._position=n)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){let e=this.position.clone();const t=this.position,n=e.parent;if(n.parent===null&&e.offset===n.childCount)return{done:!0,value:void 0};if(n===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0,value:void 0};let s;if(n instanceof le){if(e.isAtEnd)return this._position=x._createAfter(n),this._next();s=n.data[e.offset]}else s=n.getChild(e.offset);if(s instanceof vt){if(!this.shallow)e=new x(s,0);else{if(this.boundaries&&this.boundaries.end.isBefore(e))return{done:!0,value:void 0};e.offset++}return this._position=e,this._formatReturnValue("elementStart",s,t,e,1)}if(s instanceof le){if(this.singleCharacters)return e=new x(s,0),this._position=e,this._next();let o=s.data.length,r;return s==this._boundaryEndParent?(o=this.boundaries.end.offset,r=new It(s,0,o),e=x._createAfter(r)):(r=new It(s,0,s.data.length),e.offset++),this._position=e,this._formatReturnValue("text",r,t,e,o)}if(typeof s=="string"){let o;this.singleCharacters?o=1:o=(n===this._boundaryEndParent?this.boundaries.end.offset:n.data.length)-e.offset;const r=new It(n,e.offset,o);return e.offset+=o,this._position=e,this._formatReturnValue("text",r,t,e,o)}return e=x._createAfter(n),this._position=e,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",n,t,e)}_previous(){let e=this.position.clone();const t=this.position,n=e.parent;if(n.parent===null&&e.offset===0)return{done:!0,value:void 0};if(n==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0,value:void 0};let s;if(n instanceof le){if(e.isAtStart)return this._position=x._createBefore(n),this._previous();s=n.data[e.offset-1]}else s=n.getChild(e.offset-1);if(s instanceof vt)return this.shallow?(e.offset--,this._position=e,this._formatReturnValue("elementStart",s,t,e,1)):(e=new x(s,s.childCount),this._position=e,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",s,t,e));if(s instanceof le){if(this.singleCharacters)return e=new x(s,s.data.length),this._position=e,this._previous();let o=s.data.length,r;if(s==this._boundaryStartParent){const a=this.boundaries.start.offset;r=new It(s,a,s.data.length-a),o=r.data.length,e=x._createBefore(r)}else r=new It(s,0,s.data.length),e.offset--;return this._position=e,this._formatReturnValue("text",r,t,e,o)}if(typeof s=="string"){let o;if(this.singleCharacters)o=1;else{const a=n===this._boundaryStartParent?this.boundaries.start.offset:0;o=e.offset-a}e.offset-=o;const r=new It(n,e.offset,o);return this._position=e,this._formatReturnValue("text",r,t,e,o)}return e=x._createBefore(n),this._position=e,this._formatReturnValue("elementStart",n,t,e,1)}_formatReturnValue(e,t,n,s,o){return t instanceof It&&(t.offsetInText+t.data.length==t.textNode.data.length&&(this.direction=="forward"&&!(this.boundaries&&this.boundaries.end.isEqual(this.position))?(s=x._createAfter(t.textNode),this._position=s):n=x._createAfter(t.textNode)),t.offsetInText===0&&(this.direction=="backward"&&!(this.boundaries&&this.boundaries.start.isEqual(this.position))?(s=x._createBefore(t.textNode),this._position=s):n=x._createBefore(t.textNode))),{done:!1,value:{type:e,item:t,previousPosition:n,nextPosition:s,length:o}}}};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let x=class on extends An{constructor(e,t){super(),this.parent=e,this.offset=t}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return this.offset===0}get isAtEnd(){const e=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===e}get root(){return this.parent.root}get editableElement(){let e=this.parent;for(;!(e instanceof Vo);)if(e.parent)e=e.parent;else return null;return e}getShiftedBy(e){const t=on._createAt(this),n=t.offset+e;return t.offset=n<0?0:n,t}getLastMatchingPosition(e,t={}){t.startPosition=this;const n=new Sn(t);return n.skip(e),n.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(e){const t=this.getAncestors(),n=e.getAncestors();let s=0;for(;t[s]==n[s]&&t[s];)s++;return s===0?null:t[s-1]}isEqual(e){return this.parent==e.parent&&this.offset==e.offset}isBefore(e){return this.compareWith(e)=="before"}isAfter(e){return this.compareWith(e)=="after"}compareWith(e){if(this.root!==e.root)return"different";if(this.isEqual(e))return"same";const t=this.parent.is("node")?this.parent.getPath():[],n=e.parent.is("node")?e.parent.getPath():[];t.push(this.offset),n.push(e.offset);const s=Be(t,n);switch(s){case"prefix":return"before";case"extension":return"after";default:return t[s]<n[s]?"before":"after"}}getWalker(e={}){return e.startPosition=this,new Sn(e)}clone(){return new on(this.parent,this.offset)}static _createAt(e,t){if(e instanceof on)return new this(e.parent,e.offset);{const n=e;if(t=="end")t=n.is("$text")?n.data.length:n.childCount;else{if(t=="before")return this._createBefore(n);if(t=="after")return this._createAfter(n);if(t!==0&&!t)throw new p("view-createpositionat-offset-required",n)}return new on(n,t)}}static _createAfter(e){if(e.is("$textProxy"))return new on(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new p("view-position-after-root",e,{root:e});return new on(e.parent,e.index+1)}static _createBefore(e){if(e.is("$textProxy"))return new on(e.textNode,e.offsetInText);if(!e.parent)throw new p("view-position-before-root",e,{root:e});return new on(e.parent,e.index)}};x.prototype.is=function(i){return i==="position"||i==="view:position"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let H=class wn extends An{constructor(e,t=null){super(),this.start=e.clone(),this.end=t?t.clone():e.clone()}*[Symbol.iterator](){yield*new Sn({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let e=this.start.getLastMatchingPosition(Do,{direction:"backward"}),t=this.end.getLastMatchingPosition(Do);return e.parent.is("$text")&&e.isAtStart&&(e=x._createBefore(e.parent)),t.parent.is("$text")&&t.isAtEnd&&(t=x._createAfter(t.parent)),new wn(e,t)}getTrimmed(){let e=this.start.getLastMatchingPosition(Do);if(e.isAfter(this.end)||e.isEqual(this.end))return new wn(e,e);let t=this.end.getLastMatchingPosition(Do,{direction:"backward"});const n=e.nodeAfter,s=t.nodeBefore;return n&&n.is("$text")&&(e=new x(n,0)),s&&s.is("$text")&&(t=new x(s,s.data.length)),new wn(e,t)}isEqual(e){return this==e||this.start.isEqual(e.start)&&this.end.isEqual(e.end)}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const n=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),s=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return n&&s}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new wn(this.start,e.start)),this.containsPosition(e.end)&&t.push(new wn(e.end,this.end))):t.push(this.clone()),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,n=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(n=e.end),new wn(t,n)}return null}getWalker(e={}){return e.boundaries=this,new Sn(e)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let e=this.start.nodeAfter,t=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(e=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(t=this.end.parent.previousSibling),e&&e.is("element")&&e===t?e:null}clone(){return new wn(this.start,this.end)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new Sn(e);for(const n of t)yield n.item}*getPositions(e={}){e.boundaries=this;const t=new Sn(e);yield t.position;for(const n of t)yield n.nextPosition}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}static _createFromParentsAndOffsets(e,t,n,s){return new this(new x(e,t),new x(n,s))}static _createFromPositionAndShift(e,t){const n=e,s=e.getShiftedBy(t);return t>0?new this(n,s):new this(s,n)}static _createIn(e){return this._createFromParentsAndOffsets(e,0,e,e.childCount)}static _createOn(e){const t=e.is("$textProxy")?e.offsetSize:1;return this._createFromPositionAndShift(x._createBefore(e),t)}};H.prototype.is=function(i){return i==="range"||i==="view:range"};function Do(i){return!!(i.item.is("attributeElement")||i.item.is("uiElement"))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Gt=class U0 extends ee(An){constructor(...e){super(),this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",e.length&&this.setTo(...e)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.end:e.start).clone()}get focus(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.start:e.end).clone()}get isCollapsed(){return this.rangeCount===1&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const e of this._ranges)yield e.clone()}getFirstRange(){let e=null;for(const t of this._ranges)(!e||t.start.isBefore(e.start))&&(e=t);return e?e.clone():null}getLastRange(){let e=null;for(const t of this._ranges)(!e||t.end.isAfter(e.end))&&(e=t);return e?e.clone():null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}isEqual(e){if(this.isFake!=e.isFake||this.isFake&&this.fakeSelectionLabel!=e.fakeSelectionLabel||this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let n=!1;for(const s of e._ranges)if(t.isEqual(s)){n=!0;break}if(!n)return!1}return!0}isSimilar(e){if(this.isBackward!=e.isBackward)return!1;const t=Ja(this.getRanges()),n=Ja(e.getRanges());if(t!=n)return!1;if(t==0)return!0;for(let s of this.getRanges()){s=s.getTrimmed();let o=!1;for(let r of e.getRanges())if(r=r.getTrimmed(),s.start.isEqual(r.start)&&s.end.isEqual(r.end)){o=!0;break}if(!o)return!1}return!0}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}setTo(...e){let[t,n,s]=e;if(typeof n=="object"&&(s=n,n=void 0),t===null)this._setRanges([]),this._setFakeOptions(s);else if(t instanceof U0||t instanceof al)this._setRanges(t.getRanges(),t.isBackward),this._setFakeOptions({fake:t.isFake,label:t.fakeSelectionLabel});else if(t instanceof H)this._setRanges([t],s&&s.backward),this._setFakeOptions(s);else if(t instanceof x)this._setRanges([new H(t)]),this._setFakeOptions(s);else if(t instanceof xn){const o=!!s&&!!s.backward;let r;if(n===void 0)throw new p("view-selection-setto-required-second-parameter",this);n=="in"?r=H._createIn(t):n=="on"?r=H._createOn(t):r=new H(x._createAt(t,n)),this._setRanges([r],o),this._setFakeOptions(s)}else if(je(t))this._setRanges(t,s&&s.backward),this._setFakeOptions(s);else throw new p("view-selection-setto-not-selectable",this);this.fire("change")}setFocus(e,t){if(this.anchor===null)throw new p("view-selection-setfocus-no-ranges",this);const n=x._createAt(e,t);if(n.compareWith(this.focus)=="same")return;const s=this.anchor;this._ranges.pop(),n.compareWith(s)=="before"?this._addRange(new H(n,s),!0):this._addRange(new H(s,n)),this.fire("change")}_setRanges(e,t=!1){e=Array.from(e),this._ranges=[];for(const n of e)this._addRange(n);this._lastRangeBackward=!!t}_setFakeOptions(e={}){this._isFake=!!e.fake,this._fakeSelectionLabel=e.fake&&e.label||""}_addRange(e,t=!1){if(!(e instanceof H))throw new p("view-selection-add-range-not-range",this);this._pushRange(e),this._lastRangeBackward=!!t}_pushRange(e){for(const t of this._ranges)if(e.isIntersecting(t))throw new p("view-selection-range-intersects",this,{addedRange:e,intersectingRange:t});this._ranges.push(new H(e.start,e.end))}};Gt.prototype.is=function(i){return i==="selection"||i==="view:selection"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let al=class extends ee(An){constructor(...e){super(),this._selection=new Gt,this._selection.delegate("change").to(this),e.length&&this._selection.setTo(...e)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(e){return this._selection.isEqual(e)}isSimilar(e){return this._selection.isSimilar(e)}_setTo(...e){this._selection.setTo(...e)}_setFocus(e,t){this._selection.setFocus(e,t)}};al.prototype.is=function(i){return i==="selection"||i=="documentSelection"||i=="view:selection"||i=="view:documentSelection"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class fi extends Ht{constructor(e,t,n){super(e,t),this.startRange=n,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const ll=Symbol("bubbling contexts");function cl(i){class e extends i{fire(n,...s){try{const o=n instanceof Ht?n:new Ht(this,n),r=ul(this);if(!r.size)return;if(ds(o,"capturing",this),mi(r,"$capture",o,...s))return o.return;const a=o.startRange||this.selection.getFirstRange(),l=a?a.getContainedElement():null,c=l?!!Fh(r,l):!1;let u=l||X5(a);if(ds(o,"atTarget",u),!c){if(mi(r,"$text",o,...s))return o.return;ds(o,"bubbling",u)}for(;u;){if(u.is("rootElement")){if(mi(r,"$root",o,...s))return o.return}else if(u.is("element")&&mi(r,u.name,o,...s))return o.return;if(mi(r,u,o,...s))return o.return;u=u.parent,ds(o,"bubbling",u)}return ds(o,"bubbling",this),mi(r,"$document",o,...s),o.return}catch(o){/* istanbul ignore next -- @preserve */p.rethrowUnexpectedError(o,this)}}_addEventListener(n,s,o){const r=J(o.context||"$document"),a=ul(this);for(const l of r){let c=a.get(l);c||(c=new(ee()),a.set(l,c)),this.listenTo(c,n,s,o)}}_removeEventListener(n,s){const o=ul(this);for(const r of o.values())this.stopListening(r,n,s)}}return e}{const i=cl(Object);["fire","_addEventListener","_removeEventListener"].forEach(e=>{cl[e]=i.prototype[e]})}function ds(i,e,t){i instanceof fi&&(i._eventPhase=e,i._currentTarget=t)}function mi(i,e,t,...n){const s=typeof e=="string"?i.get(e):Fh(i,e);return s?(s.fire(t,...n),t.stop.called):!1}function Fh(i,e){for(const[t,n]of i)if(typeof t=="function"&&t(e))return n;return null}function ul(i){return i[ll]||(i[ll]=new Map),i[ll]}function X5(i){if(!i)return null;const e=i.start.parent,t=i.end.parent,n=e.getPath(),s=t.getPath();return n.length>s.length?e:t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let No=class extends cl(re()){constructor(e){super(),this._postFixers=new Set,this.selection=new al,this.roots=new Oe({idProperty:"rootName"}),this.stylesProcessor=e,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1)}getRoot(e="main"){return this.roots.get(e)}registerPostFixer(e){this._postFixers.add(e)}destroy(){this.roots.forEach(e=>e.destroy()),this.stopListening()}_callPostFixers(e){let t=!1;do for(const n of this._postFixers)if(t=n(e),t)break;while(t)}};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const $h=10;class In extends vt{constructor(e,t,n,s){super(e,t,n,s),this._priority=$h,this._id=null,this._clonesGroup=null,this.getFillerOffset=Q5}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(this.id===null)throw new p("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}isSimilar(e){return this.id!==null||e.id!==null?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}_clone(e=!1){const t=super._clone(e);return t._priority=this._priority,t._id=this._id,t}}In.DEFAULT_PRIORITY=$h,In.prototype.is=function(i,e){return e?e===this.name&&(i==="attributeElement"||i==="view:attributeElement"||i==="element"||i==="view:element"):i==="attributeElement"||i==="view:attributeElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function Q5(){if(dl(this))return null;let i=this.parent;for(;i&&i.is("attributeElement");){if(dl(i)>1)return null;i=i.parent}return!i||dl(i)>1?null:this.childCount}function dl(i){return Array.from(i.getChildren()).filter(e=>!e.is("uiElement")).length}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class hl extends vt{constructor(e,t,n,s){super(e,t,n,s),this.getFillerOffset=e3}_insertChild(e,t){if(t&&(t instanceof xn||Array.from(t).length>0))throw new p("view-emptyelement-cannot-add",[this,t]);return 0}}hl.prototype.is=function(i,e){return e?e===this.name&&(i==="emptyElement"||i==="view:emptyElement"||i==="element"||i==="view:element"):i==="emptyElement"||i==="view:emptyElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function e3(){return null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Fo extends vt{constructor(e,t,n,s){super(e,t,n,s),this.getFillerOffset=n3}_insertChild(e,t){if(t&&(t instanceof xn||Array.from(t).length>0))throw new p("view-uielement-cannot-add",[this,t]);return 0}render(e,t){return this.toDomElement(e)}toDomElement(e){const t=e.createElement(this.name);for(const n of this.getAttributeKeys())t.setAttribute(n,this.getAttribute(n));return t}}Fo.prototype.is=function(i,e){return e?e===this.name&&(i==="uiElement"||i==="view:uiElement"||i==="element"||i==="view:element"):i==="uiElement"||i==="view:uiElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function t3(i){i.document.on("arrowKey",(e,t)=>i3(e,t,i.domConverter),{priority:"low"})}function n3(){return null}function i3(i,e,t){if(e.keyCode==U.arrowright){const n=e.domTarget.ownerDocument.defaultView.getSelection(),s=n.rangeCount==1&&n.getRangeAt(0).collapsed;if(s||e.shiftKey){const o=n.focusNode,r=n.focusOffset,a=t.domPositionToView(o,r);if(a===null)return;let l=!1;const c=a.getLastMatchingPosition(u=>(u.item.is("uiElement")&&(l=!0),!!(u.item.is("uiElement")||u.item.is("attributeElement"))));if(l){const u=t.viewPositionToDom(c);s?n.collapse(u.parent,u.offset):n.extend(u.parent,u.offset)}}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class fl extends vt{constructor(e,t,n,s){super(e,t,n,s),this.getFillerOffset=s3}_insertChild(e,t){if(t&&(t instanceof xn||Array.from(t).length>0))throw new p("view-rawelement-cannot-add",[this,t]);return 0}render(e,t){}}fl.prototype.is=function(i,e){return e?e===this.name&&(i==="rawElement"||i==="view:rawElement"||i==="element"||i==="view:element"):i==="rawElement"||i==="view:rawElement"||i===this.name||i==="view:"+this.name||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function s3(){return null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Pn=class extends ee(An){constructor(e,t){super(),this._children=[],this._customProperties=new Map,this.document=e,t&&this._insertChild(0,t)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return this.childCount===0}get root(){return this}get parent(){return null}get name(){}get getFillerOffset(){}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}_appendChild(e){return this._insertChild(this.childCount,e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(e,t){this._fireChange("children",this);let n=0;const s=o3(this.document,t);for(const o of s)o.parent!==null&&o._remove(),o.parent=this,this._children.splice(e,0,o),e++,n++;return n}_removeChildren(e,t=1){this._fireChange("children",this);for(let n=e;n<e+t;n++)this._children[n].parent=null;return this._children.splice(e,t)}_fireChange(e,t){this.fire("change:"+e,t)}_setCustomProperty(e,t){this._customProperties.set(e,t)}_removeCustomProperty(e){return this._customProperties.delete(e)}};Pn.prototype.is=function(i){return i==="documentFragment"||i==="view:documentFragment"};function o3(i,e){return typeof e=="string"?[new le(i,e)]:(je(e)||(e=[e]),Array.from(e).map(t=>typeof t=="string"?new le(i,t):t instanceof It?new le(i,t.data):t))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Uh{constructor(e){this._cloneGroups=new Map,this._slotFactory=null,this.document=e}setSelection(...e){this.document.selection._setTo(...e)}setSelectionFocus(e,t){this.document.selection._setFocus(e,t)}createDocumentFragment(e){return new Pn(this.document,e)}createText(e){return new le(this.document,e)}createAttributeElement(e,t,n={}){const s=new In(this.document,e,t);return typeof n.priority=="number"&&(s._priority=n.priority),n.id&&(s._id=n.id),n.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),s}createContainerElement(e,t,n={},s={}){let o=null;De(n)?s=n:o=n;const r=new us(this.document,e,t,o);return s.renderUnsafeAttributes&&r._unsafeAttributesToRender.push(...s.renderUnsafeAttributes),r}createEditableElement(e,t,n={}){const s=new Vo(this.document,e,t);return n.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),s}createEmptyElement(e,t,n={}){const s=new hl(this.document,e,t);return n.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),s}createUIElement(e,t,n){const s=new Fo(this.document,e,t);return n&&(s.render=n),s}createRawElement(e,t,n,s={}){const o=new fl(this.document,e,t);return n&&(o.render=n),s.renderUnsafeAttributes&&o._unsafeAttributesToRender.push(...s.renderUnsafeAttributes),o}setAttribute(e,t,n){n._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,n){De(e)&&n===void 0?t._setStyle(e):n._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,n){n._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}breakAttributes(e){return e instanceof x?this._breakAttributes(e):this._breakAttributesRange(e)}breakContainer(e){const t=e.parent;if(!t.is("containerElement"))throw new p("view-writer-break-non-container-element",this.document);if(!t.parent)throw new p("view-writer-break-root",this.document);if(e.isAtStart)return x._createBefore(t);if(!e.isAtEnd){const n=t._clone(!1);this.insert(x._createAfter(t),n);const s=new H(e,x._createAt(t,"end")),o=new x(n,0);this.move(s,o)}return x._createAfter(t)}mergeAttributes(e){const t=e.offset,n=e.parent;if(n.is("$text"))return e;if(n.is("attributeElement")&&n.childCount===0){const r=n.parent,a=n.index;return n._remove(),this._removeFromClonedElementsGroup(n),this.mergeAttributes(new x(r,a))}const s=n.getChild(t-1),o=n.getChild(t);if(!s||!o)return e;if(s.is("$text")&&o.is("$text"))return Hh(s,o);if(s.is("attributeElement")&&o.is("attributeElement")&&s.isSimilar(o)){const r=s.childCount;return s._appendChild(o.getChildren()),o._remove(),this._removeFromClonedElementsGroup(o),this.mergeAttributes(new x(s,r))}return e}mergeContainers(e){const t=e.nodeBefore,n=e.nodeAfter;if(!t||!n||!t.is("containerElement")||!n.is("containerElement"))throw new p("view-writer-merge-containers-invalid-position",this.document);const s=t.getChild(t.childCount-1),o=s instanceof le?x._createAt(s,"end"):x._createAt(t,"end");return this.move(H._createIn(n),x._createAt(t,"end")),this.remove(H._createOn(n)),o}insert(e,t){t=je(t)?[...t]:[t],Wh(t,this.document);const n=t.reduce((r,a)=>{const l=r[r.length-1],c=!a.is("uiElement");return!l||l.breakAttributes!=c?r.push({breakAttributes:c,nodes:[a]}):l.nodes.push(a),r},[]);let s=null,o=e;for(const{nodes:r,breakAttributes:a}of n){const l=this._insertNodes(o,r,a);s||(s=l.start),o=l.end}return s?new H(s,o):new H(e)}remove(e){const t=e instanceof H?e:H._createOn(e);if(hs(t,this.document),t.isCollapsed)return new Pn(this.document);const{start:n,end:s}=this._breakAttributesRange(t,!0),o=n.parent,r=s.offset-n.offset,a=o._removeChildren(n.offset,r);for(const c of a)this._removeFromClonedElementsGroup(c);const l=this.mergeAttributes(n);return t.start=l,t.end=l.clone(),new Pn(this.document,a)}clear(e,t){hs(e,this.document);const n=e.getWalker({direction:"backward",ignoreElementEnd:!0});for(const s of n){const o=s.item;let r;if(o.is("element")&&t.isSimilar(o))r=H._createOn(o);else if(!s.nextPosition.isAfter(e.start)&&o.is("$textProxy")){const a=o.getAncestors().find(l=>l.is("element")&&t.isSimilar(l));a&&(r=H._createIn(a))}r&&(r.end.isAfter(e.end)&&(r.end=e.end),r.start.isBefore(e.start)&&(r.start=e.start),this.remove(r))}}move(e,t){let n;if(t.isAfter(e.end)){t=this._breakAttributes(t,!0);const s=t.parent,o=s.childCount;e=this._breakAttributesRange(e,!0),n=this.remove(e),t.offset+=s.childCount-o}else n=this.remove(e);return this.insert(t,n)}wrap(e,t){if(!(t instanceof In))throw new p("view-writer-wrap-invalid-attribute",this.document);if(hs(e,this.document),e.isCollapsed){let n=e.start;n.parent.is("element")&&!r3(n.parent)&&(n=n.getLastMatchingPosition(o=>o.item.is("uiElement"))),n=this._wrapPosition(n,t);const s=this.document.selection;return s.isCollapsed&&s.getFirstPosition().isEqual(e.start)&&this.setSelection(n),new H(n)}else return this._wrapRange(e,t)}unwrap(e,t){if(!(t instanceof In))throw new p("view-writer-unwrap-invalid-attribute",this.document);if(hs(e,this.document),e.isCollapsed)return e;const{start:n,end:s}=this._breakAttributesRange(e,!0),o=n.parent,r=this._unwrapChildren(o,n.offset,s.offset,t),a=this.mergeAttributes(r.start);a.isEqual(r.start)||r.end.offset--;const l=this.mergeAttributes(r.end);return new H(a,l)}rename(e,t){const n=new us(this.document,e,t.getAttributes());return this.insert(x._createAfter(t),n),this.move(H._createIn(t),x._createAt(n,0)),this.remove(H._createOn(t)),n}clearClonedElementsGroup(e){this._cloneGroups.delete(e)}createPositionAt(e,t){return x._createAt(e,t)}createPositionAfter(e){return x._createAfter(e)}createPositionBefore(e){return x._createBefore(e)}createRange(e,t){return new H(e,t)}createRangeOn(e){return H._createOn(e)}createRangeIn(e){return H._createIn(e)}createSelection(...e){return new Gt(...e)}createSlot(e="children"){if(!this._slotFactory)throw new p("view-writer-invalid-create-slot-context",this.document);return this._slotFactory(this,e)}_registerSlotFactory(e){this._slotFactory=e}_clearSlotFactory(){this._slotFactory=null}_insertNodes(e,t,n){let s;if(n?s=ml(e):s=e.parent.is("$text")?e.parent.parent:e.parent,!s)throw new p("view-writer-invalid-position-container",this.document);let o;n?o=this._breakAttributes(e,!0):o=e.parent.is("$text")?gl(e):e;const r=s._insertChild(o.offset,t);for(const u of t)this._addToClonedElementsGroup(u);const a=o.getShiftedBy(r),l=this.mergeAttributes(o);l.isEqual(o)||a.offset--;const c=this.mergeAttributes(a);return new H(l,c)}_wrapChildren(e,t,n,s){let o=t;const r=[];for(;o<n;){const l=e.getChild(o),c=l.is("$text"),u=l.is("attributeElement");if(u&&this._wrapAttributeElement(s,l))r.push(new x(e,o));else if(c||!u||a3(s,l)){const d=s._clone();l._remove(),d._appendChild(l),e._insertChild(o,d),this._addToClonedElementsGroup(d),r.push(new x(e,o))}else this._wrapChildren(l,0,l.childCount,s);o++}let a=0;for(const l of r){if(l.offset-=a,l.offset==t)continue;this.mergeAttributes(l).isEqual(l)||(a++,n--)}return H._createFromParentsAndOffsets(e,t,e,n)}_unwrapChildren(e,t,n,s){let o=t;const r=[];for(;o<n;){const l=e.getChild(o);if(!l.is("attributeElement")){o++;continue}if(l.isSimilar(s)){const c=l.getChildren(),u=l.childCount;l._remove(),e._insertChild(o,c),this._removeFromClonedElementsGroup(l),r.push(new x(e,o),new x(e,o+u)),o+=u,n+=u-1;continue}if(this._unwrapAttributeElement(s,l)){r.push(new x(e,o),new x(e,o+1)),o++;continue}this._unwrapChildren(l,0,l.childCount,s),o++}let a=0;for(const l of r){if(l.offset-=a,l.offset==t||l.offset==n)continue;this.mergeAttributes(l).isEqual(l)||(a++,n--)}return H._createFromParentsAndOffsets(e,t,e,n)}_wrapRange(e,t){const{start:n,end:s}=this._breakAttributesRange(e,!0),o=n.parent,r=this._wrapChildren(o,n.offset,s.offset,t),a=this.mergeAttributes(r.start);a.isEqual(r.start)||r.end.offset--;const l=this.mergeAttributes(r.end);return new H(a,l)}_wrapPosition(e,t){if(t.isSimilar(e.parent))return zh(e.clone());e.parent.is("$text")&&(e=gl(e));const n=this.createAttributeElement("_wrapPosition-fake-element");n._priority=Number.POSITIVE_INFINITY,n.isSimilar=()=>!1,e.parent._insertChild(e.offset,n);const s=new H(e,e.getShiftedBy(1));this.wrap(s,t);const o=new x(n.parent,n.index);n._remove();const r=o.nodeBefore,a=o.nodeAfter;return r instanceof le&&a instanceof le?Hh(r,a):zh(o)}_wrapAttributeElement(e,t){if(!jh(e,t)||e.name!==t.name||e.priority!==t.priority)return!1;for(const n of e.getAttributeKeys())if(!(n==="class"||n==="style")&&t.hasAttribute(n)&&t.getAttribute(n)!==e.getAttribute(n))return!1;for(const n of e.getStyleNames())if(t.hasStyle(n)&&t.getStyle(n)!==e.getStyle(n))return!1;for(const n of e.getAttributeKeys())n==="class"||n==="style"||t.hasAttribute(n)||this.setAttribute(n,e.getAttribute(n),t);for(const n of e.getStyleNames())t.hasStyle(n)||this.setStyle(n,e.getStyle(n),t);for(const n of e.getClassNames())t.hasClass(n)||this.addClass(n,t);return!0}_unwrapAttributeElement(e,t){if(!jh(e,t)||e.name!==t.name||e.priority!==t.priority)return!1;for(const n of e.getAttributeKeys())if(!(n==="class"||n==="style")&&(!t.hasAttribute(n)||t.getAttribute(n)!==e.getAttribute(n)))return!1;if(!t.hasClass(...e.getClassNames()))return!1;for(const n of e.getStyleNames())if(!t.hasStyle(n)||t.getStyle(n)!==e.getStyle(n))return!1;for(const n of e.getAttributeKeys())n==="class"||n==="style"||this.removeAttribute(n,t);return this.removeClass(Array.from(e.getClassNames()),t),this.removeStyle(Array.from(e.getStyleNames()),t),!0}_breakAttributesRange(e,t=!1){const n=e.start,s=e.end;if(hs(e,this.document),e.isCollapsed){const l=this._breakAttributes(e.start,t);return new H(l,l)}const o=this._breakAttributes(s,t),r=o.parent.childCount,a=this._breakAttributes(n,t);return o.offset+=o.parent.childCount-r,new H(a,o)}_breakAttributes(e,t=!1){const n=e.offset,s=e.parent;if(e.parent.is("emptyElement"))throw new p("view-writer-cannot-break-empty-element",this.document);if(e.parent.is("uiElement"))throw new p("view-writer-cannot-break-ui-element",this.document);if(e.parent.is("rawElement"))throw new p("view-writer-cannot-break-raw-element",this.document);if(!t&&s.is("$text")&&pl(s.parent)||pl(s))return e.clone();if(s.is("$text"))return this._breakAttributes(gl(e),t);const o=s.childCount;if(n==o){const r=new x(s.parent,s.index+1);return this._breakAttributes(r,t)}else if(n===0){const r=new x(s.parent,s.index);return this._breakAttributes(r,t)}else{const r=s.index+1,a=s._clone();s.parent._insertChild(r,a),this._addToClonedElementsGroup(a);const l=s.childCount-n,c=s._removeChildren(n,l);a._appendChild(c);const u=new x(s.parent,r);return this._breakAttributes(u,t)}}_addToClonedElementsGroup(e){if(!e.root.is("rootElement"))return;if(e.is("element"))for(const s of e.getChildren())this._addToClonedElementsGroup(s);const t=e.id;if(!t)return;let n=this._cloneGroups.get(t);n||(n=new Set,this._cloneGroups.set(t,n)),n.add(e),e._clonesGroup=n}_removeFromClonedElementsGroup(e){if(e.is("element"))for(const s of e.getChildren())this._removeFromClonedElementsGroup(s);const t=e.id;if(!t)return;const n=this._cloneGroups.get(t);n&&n.delete(e)}}function r3(i){return Array.from(i.getChildren()).some(e=>!e.is("uiElement"))}function ml(i){let e=i.parent;for(;!pl(e);){if(!e)return;e=e.parent}return e}function a3(i,e){return i.priority<e.priority?!0:i.priority>e.priority?!1:i.getIdentity()<e.getIdentity()}function zh(i){const e=i.nodeBefore;if(e&&e.is("$text"))return new x(e,e.data.length);const t=i.nodeAfter;return t&&t.is("$text")?new x(t,0):i}function gl(i){if(i.offset==i.parent.data.length)return new x(i.parent.parent,i.parent.index+1);if(i.offset===0)return new x(i.parent.parent,i.parent.index);const e=i.parent.data.slice(i.offset);return i.parent._data=i.parent.data.slice(0,i.offset),i.parent.parent._insertChild(i.parent.index+1,new le(i.root.document,e)),new x(i.parent.parent,i.parent.index+1)}function Hh(i,e){const t=i.data.length;return i._data+=e.data,e._remove(),new x(i,t)}const l3=[le,In,us,hl,fl,Fo];function Wh(i,e){for(const t of i){if(!l3.some(n=>t instanceof n))throw new p("view-writer-insert-invalid-node-type",e);t.is("$text")||Wh(t.getChildren(),e)}}function pl(i){return i&&(i.is("containerElement")||i.is("documentFragment"))}function hs(i,e){const t=ml(i.start),n=ml(i.end);if(!t||!n||t!==n)throw new p("view-writer-invalid-range-container",e)}function jh(i,e){return i.id===null&&e.id===null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const qh=i=>i.createTextNode(" "),Gh=i=>{const e=i.createElement("span");return e.dataset.ckeFiller="true",e.innerText=" ",e},Kh=i=>{const e=i.createElement("br");return e.dataset.ckeFiller="true",e},yt=7,fs="⁠".repeat(yt);function Ke(i){return typeof i=="string"?i.substr(0,yt)===fs:he(i)&&i.data.substr(0,yt)===fs}function gi(i){return i.data.length==yt&&Ke(i)}function Zh(i){const e=typeof i=="string"?i:i.data;return Ke(i)?e.slice(yt):e}function c3(i){i.document.on("arrowKey",u3,{priority:"low"})}function u3(i,e){if(e.keyCode==U.arrowleft){const t=e.domTarget.ownerDocument.defaultView.getSelection();if(t.rangeCount==1&&t.getRangeAt(0).collapsed){const n=t.getRangeAt(0).startContainer,s=t.getRangeAt(0).startOffset;Ke(n)&&s<=yt&&t.collapse(n,0)}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class d3 extends re(){constructor(e,t){super(),this.domDocuments=new Set,this.markedAttributes=new Set,this.markedChildren=new Set,this.markedTexts=new Set,this._inlineFiller=null,this._fakeSelectionContainer=null,this.domConverter=e,this.selection=t,this.set("isFocused",!1),this.set("isSelecting",!1),$.isBlink&&!$.isAndroid&&this.on("change:isSelecting",()=>{this.isSelecting||this.render()}),this.set("isComposing",!1),this.on("change:isComposing",()=>{this.isComposing||this.render()})}markToSync(e,t){if(e==="text")this.domConverter.mapViewToDom(t.parent)&&this.markedTexts.add(t);else{if(!this.domConverter.mapViewToDom(t))return;if(e==="attributes")this.markedAttributes.add(t);else if(e==="children")this.markedChildren.add(t);else throw new p("view-renderer-unknown-type",this)}}render(){if(this.isComposing&&!$.isAndroid)return;let e=null;const t=$.isBlink&&!$.isAndroid?!this.isSelecting:!0;for(const n of this.markedChildren)this._updateChildrenMappings(n);t?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(e=this.domConverter.domPositionToView(this._inlineFiller),e&&e.parent.is("$text")&&(e=x._createBefore(e.parent)));for(const n of this.markedAttributes)this._updateAttrs(n);for(const n of this.markedChildren)this._updateChildren(n,{inlineFillerPosition:e});for(const n of this.markedTexts)!this.markedChildren.has(n.parent)&&this.domConverter.mapViewToDom(n.parent)&&this._updateText(n,{inlineFillerPosition:e});if(t)if(e){const n=this.domConverter.viewPositionToDom(e),s=n.parent.ownerDocument;Ke(n.parent)?this._inlineFiller=n.parent:this._inlineFiller=Jh(s,n.parent,n.offset)}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.domConverter._clearTemporaryCustomProperties(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const n=Array.from(t.childNodes),s=Array.from(this.domConverter.viewChildrenToDom(e,{withChildren:!1})),o=this._diffNodeLists(n,s),r=this._findUpdateActions(o,n,s,f3);if(r.indexOf("update")!==-1){const a={equal:0,insert:0,delete:0};for(const l of r)if(l==="update"){const c=a.equal+a.insert,u=a.equal+a.delete,d=e.getChild(c);d&&!d.is("uiElement")&&!d.is("rawElement")&&this._updateElementMappings(d,n[u]),wh(s[c]),a.equal++}else a[l]++}}_updateElementMappings(e,t){this.domConverter.unbindDomElement(t),this.domConverter.bindElements(t,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("$text")?x._createBefore(e.parent):e}_isSelectionInInlineFiller(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=this.domConverter.viewPositionToDom(e);return!!(t&&he(t.parent)&&Ke(t.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!Ke(e))throw new p("view-renderer-filler-was-lost",this);gi(e)?e.remove():e.data=e.data.substr(yt),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=e.parent,n=e.offset;if(!this.domConverter.mapViewToDom(t.root)||!t.is("element")||!h3(t))return!1;const s=e.nodeBefore,o=e.nodeAfter;return!(s instanceof le||o instanceof le||n===t.getFillerOffset()&&(!s||!s.is("element","br"))||$.isAndroid&&(s||o))}_updateText(e,t){const n=this.domConverter.findCorrespondingDomText(e);let o=this.domConverter.viewToDom(e).data;const r=t.inlineFillerPosition;r&&r.parent==e.parent&&r.offset==e.index&&(o=fs+o),Yh(n,o)}_updateAttrs(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const n=Array.from(t.attributes).map(o=>o.name),s=e.getAttributeKeys();for(const o of s)this.domConverter.setDomElementAttribute(t,o,e.getAttribute(o),e);for(const o of n)e.hasAttribute(o)||this.domConverter.removeDomElementAttribute(t,o)}_updateChildren(e,t){const n=this.domConverter.mapViewToDom(e);if(!n)return;if($.isAndroid){let d=null;for(const h of Array.from(n.childNodes)){if(d&&he(d)&&he(h)){n.normalize();break}d=h}}const s=t.inlineFillerPosition,o=n.childNodes,r=Array.from(this.domConverter.viewChildrenToDom(e,{bind:!0}));s&&s.parent===e&&Jh(n.ownerDocument,r,s.offset);const a=this._diffNodeLists(o,r),l=this._findUpdateActions(a,o,r,m3);let c=0;const u=new Set;for(const d of l)d==="delete"?(u.add(o[c]),wh(o[c])):(d==="equal"||d==="update")&&c++;c=0;for(const d of l)d==="insert"?(mh(n,c,r[c]),c++):d==="update"?(Yh(o[c],r[c].data),c++):d==="equal"&&(this._markDescendantTextToSync(this.domConverter.domToView(r[c])),c++);for(const d of u)d.parentNode||this.domConverter.unbindDomElement(d)}_diffNodeLists(e,t){return e=b3(e,this._fakeSelectionContainer),Ki(e,t,g3.bind(null,this.domConverter))}_findUpdateActions(e,t,n,s){if(e.indexOf("insert")===-1||e.indexOf("delete")===-1)return e;let o=[],r=[],a=[];const l={equal:0,insert:0,delete:0};for(const c of e)c==="insert"?a.push(n[l.equal+l.insert]):c==="delete"?r.push(t[l.equal+l.delete]):(o=o.concat(Ki(r,a,s).map(u=>u==="equal"?"update":u)),o.push("equal"),r=[],a=[]),l[c]++;return o.concat(Ki(r,a,s).map(c=>c==="equal"?"update":c))}_markDescendantTextToSync(e){if(e){if(e.is("$text"))this.markedTexts.add(e);else if(e.is("element"))for(const t of e.getChildren())this._markDescendantTextToSync(t)}}_updateSelection(){if($.isBlink&&!$.isAndroid&&this.isSelecting&&!this.markedChildren.size)return;if(this.selection.rangeCount===0){this._removeDomSelection(),this._removeFakeSelection();return}const e=this.domConverter.mapViewToDom(this.selection.editableElement);!this.isFocused||!e||(this.selection.isFake?this._updateFakeSelection(e):this._fakeSelectionContainer&&this._fakeSelectionContainer.isConnected?(this._removeFakeSelection(),this._updateDomSelection(e)):this.isComposing&&$.isAndroid||this._updateDomSelection(e))}_updateFakeSelection(e){const t=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=w3(t));const n=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(n,this.selection),!this._fakeSelectionNeedsUpdate(e))return;(!n.parentElement||n.parentElement!=e)&&e.appendChild(n),n.textContent=this.selection.fakeSelectionLabel||" ";const s=t.getSelection(),o=t.createRange();s.removeAllRanges(),o.selectNodeContents(n),s.addRange(o)}_updateDomSelection(e){const t=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(t))return;const n=this.domConverter.viewPositionToDom(this.selection.anchor),s=this.domConverter.viewPositionToDom(this.selection.focus);t.setBaseAndExtent(n.parent,n.offset,s.parent,s.offset),$.isGecko&&p3(s,t)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const t=e&&this.domConverter.domSelectionToView(e);return!(t&&this.selection.isEqual(t)||!this.selection.isCollapsed&&this.selection.isSimilar(t))}_fakeSelectionNeedsUpdate(e){const t=this._fakeSelectionContainer,n=e.ownerDocument.getSelection();return!t||t.parentElement!==e||n.anchorNode!==t&&!t.contains(n.anchorNode)?!0:t.textContent!==this.selection.fakeSelectionLabel}_removeDomSelection(){for(const e of this.domDocuments){const t=e.getSelection();if(t.rangeCount){const n=e.activeElement,s=this.domConverter.mapDomToView(n);n&&s&&t.removeAllRanges()}}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}}function h3(i){if(i.getAttribute("contenteditable")=="false")return!1;const e=i.findAncestor(t=>t.hasAttribute("contenteditable"));return!e||e.getAttribute("contenteditable")=="true"}function Jh(i,e,t){const n=e instanceof Array?e:e.childNodes,s=n[t];if(he(s))return s.data=fs+s.data,s;{const o=i.createTextNode(fs);return Array.isArray(e)?n.splice(t,0,o):mh(e,t,o),o}}function f3(i,e){return ln(i)&&ln(e)&&!he(i)&&!he(e)&&!ls(i)&&!ls(e)&&i.tagName.toLowerCase()===e.tagName.toLowerCase()}function m3(i,e){return ln(i)&&ln(e)&&he(i)&&he(e)}function g3(i,e,t){return e===t?!0:he(e)&&he(t)?e.data===t.data:!!(i.isBlockFiller(e)&&i.isBlockFiller(t))}function p3(i,e){let t=i.parent,n=i.offset;if(he(t)&&gi(t)&&(n=as(t)+1,t=t.parentNode),t.nodeType!=Node.ELEMENT_NODE||n!=t.childNodes.length-1)return;const s=t.childNodes[n];s&&s.tagName=="BR"&&e.addRange(e.getRangeAt(0))}function b3(i,e){const t=Array.from(i);return t.length==0||!e||t[t.length-1]==e&&t.pop(),t}function w3(i){const e=i.createElement("div");return e.className="ck-fake-selection-container",Object.assign(e.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),e.textContent=" ",e}function Yh(i,e){const t=i.data;if(t==e)return;const n=uu(t,e);for(const s of n)s.type==="insert"?i.insertData(s.index,s.values.join("")):i.deleteData(s.index,s.howMany)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const _3=Kh(I.document),v3=qh(I.document),y3=Gh(I.document),$o="data-ck-unsafe-attribute-",Xh="data-ck-unsafe-element";class Uo{constructor(e,{blockFillerMode:t,renderingMode:n="editing"}={}){this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap,this._rawContentElementMatcher=new Ge,this._inlineObjectElementMatcher=new Ge,this._elementsWithTemporaryCustomProperties=new Set,this.document=e,this.renderingMode=n,this.blockFillerMode=t||(n==="editing"?"br":"nbsp"),this.preElements=["pre"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this.unsafeElements=["script","style"],this._domDocument=this.renderingMode==="editing"?I.document:I.document.implementation.createHTMLDocument("")}bindFakeSelection(e,t){this._fakeSelectionMapping.set(e,new Gt(t))}fakeSelectionToView(e){return this._fakeSelectionMapping.get(e)}bindElements(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}unbindDomElement(e){const t=this._domToViewMapping.get(e);if(t){this._domToViewMapping.delete(e),this._viewToDomMapping.delete(t);for(const n of Array.from(e.children))this.unbindDomElement(n)}}bindDocumentFragments(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}shouldRenderAttribute(e,t,n){return this.renderingMode==="data"?!0:(e=e.toLowerCase(),e.startsWith("on")||e==="srcdoc"&&t.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i)?!1:n==="img"&&(e==="src"||e==="srcset")||n==="source"&&e==="srcset"?!0:!t.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i))}setContentOf(e,t){if(this.renderingMode==="data"){e.innerHTML=t;return}const n=new DOMParser().parseFromString(t,"text/html"),s=n.createDocumentFragment(),o=n.body.childNodes;for(;o.length>0;)s.appendChild(o[0]);const r=n.createTreeWalker(s,NodeFilter.SHOW_ELEMENT),a=[];let l;for(;l=r.nextNode();)a.push(l);for(const c of a){for(const d of c.getAttributeNames())this.setDomElementAttribute(c,d,c.getAttribute(d));const u=c.tagName.toLowerCase();this._shouldRenameElement(u)&&(tf(u),c.replaceWith(this._createReplacementDomElement(u,c)))}for(;e.firstChild;)e.firstChild.remove();e.append(s)}viewToDom(e,t={}){if(e.is("$text")){const n=this._processDataFromViewText(e);return this._domDocument.createTextNode(n)}else{const n=e;if(this.mapViewToDom(n))if(n.getCustomProperty("editingPipeline:doNotReuseOnce"))this._elementsWithTemporaryCustomProperties.add(n);else return this.mapViewToDom(n);let s;if(n.is("documentFragment"))s=this._domDocument.createDocumentFragment(),t.bind&&this.bindDocumentFragments(s,n);else{if(n.is("uiElement"))return n.name==="$comment"?s=this._domDocument.createComment(n.getCustomProperty("$rawContent")):s=n.render(this._domDocument,this),t.bind&&this.bindElements(s,n),s;this._shouldRenameElement(n.name)?(tf(n.name),s=this._createReplacementDomElement(n.name)):n.hasAttribute("xmlns")?s=this._domDocument.createElementNS(n.getAttribute("xmlns"),n.name):s=this._domDocument.createElement(n.name),n.is("rawElement")&&n.render(s,this),t.bind&&this.bindElements(s,n);for(const o of n.getAttributeKeys())this.setDomElementAttribute(s,o,n.getAttribute(o),n)}if(t.withChildren!==!1)for(const o of this.viewChildrenToDom(n,t))s instanceof HTMLTemplateElement?s.content.appendChild(o):s.appendChild(o);return s}}setDomElementAttribute(e,t,n,s){const o=this.shouldRenderAttribute(t,n,e.tagName.toLowerCase())||s&&s.shouldRenderUnsafeAttribute(t);if(o||Q("domconverter-unsafe-attribute-detected",{domElement:e,key:t,value:n}),!gh(t)){Q("domconverter-invalid-attribute-detected",{domElement:e,key:t,value:n});return}e.hasAttribute(t)&&!o?e.removeAttribute(t):e.hasAttribute($o+t)&&o&&e.removeAttribute($o+t),e.setAttribute(o?t:$o+t,n)}removeDomElementAttribute(e,t){t!=Xh&&(e.removeAttribute(t),e.removeAttribute($o+t))}*viewChildrenToDom(e,t={}){const n=e.getFillerOffset&&e.getFillerOffset();let s=0;for(const o of e.getChildren()){n===s&&(yield this._getBlockFiller());const r=o.is("element")&&!!o.getCustomProperty("dataPipeline:transparentRendering")&&!ce(o.getAttributes());r&&this.renderingMode=="data"?yield*this.viewChildrenToDom(o,t):(r&&Q("domconverter-transparent-rendering-unsupported-in-editing-pipeline",{viewElement:o}),yield this.viewToDom(o,t)),s++}n===s&&(yield this._getBlockFiller())}viewRangeToDom(e){const t=this.viewPositionToDom(e.start),n=this.viewPositionToDom(e.end),s=this._domDocument.createRange();return s.setStart(t.parent,t.offset),s.setEnd(n.parent,n.offset),s}viewPositionToDom(e){const t=e.parent;if(t.is("$text")){const n=this.findCorrespondingDomText(t);if(!n)return null;let s=e.offset;return Ke(n)&&(s+=yt),{parent:n,offset:s}}else{let n,s,o;if(e.offset===0){if(n=this.mapViewToDom(t),!n)return null;o=n.childNodes[0]}else{const a=e.nodeBefore;if(s=a.is("$text")?this.findCorrespondingDomText(a):this.mapViewToDom(a),!s)return null;n=s.parentNode,o=s.nextSibling}if(he(o)&&Ke(o))return{parent:o,offset:yt};const r=s?as(s)+1:0;return{parent:n,offset:r}}}domToView(e,t={}){const n=[],s=this._domToView(e,t,n),o=s.next().value;return!o||(s.next(),this._processDomInlineNodes(null,n,t),o.is("$text")&&o.data.length==0)?null:o}*domChildrenToView(e,t={},n=[]){let s=[];e instanceof HTMLTemplateElement?s=[...e.content.childNodes]:s=[...e.childNodes];for(let o=0;o<s.length;o++){const r=s[o],a=this._domToView(r,t,n),l=a.next().value;l!==null&&(this._isBlockViewElement(l)&&this._processDomInlineNodes(e,n,t),yield l,a.next())}this._processDomInlineNodes(e,n,t)}domSelectionToView(e){if(T3(e))return new Gt([]);if(e.rangeCount===1){let s=e.getRangeAt(0).startContainer;he(s)&&(s=s.parentNode);const o=this.fakeSelectionToView(s);if(o)return o}const t=this.isDomSelectionBackward(e),n=[];for(let s=0;s<e.rangeCount;s++){const o=e.getRangeAt(s),r=this.domRangeToView(o);r&&n.push(r)}return new Gt(n,{backward:t})}domRangeToView(e){const t=this.domPositionToView(e.startContainer,e.startOffset),n=this.domPositionToView(e.endContainer,e.endOffset);return t&&n?new H(t,n):null}domPositionToView(e,t=0){if(this.isBlockFiller(e))return this.domPositionToView(e.parentNode,as(e));const n=this.mapDomToView(e);if(n&&(n.is("uiElement")||n.is("rawElement")))return x._createBefore(n);if(he(e)){if(gi(e))return this.domPositionToView(e.parentNode,as(e));const s=this.findCorrespondingViewText(e);let o=t;return s?(Ke(e)&&(o-=yt,o=o<0?0:o),new x(s,o)):null}else{if(t===0){const s=this.mapDomToView(e);if(s)return new x(s,0)}else{const s=e.childNodes[t-1];if(he(s)&&gi(s)||s&&this.isBlockFiller(s))return this.domPositionToView(s.parentNode,as(s));const o=he(s)?this.findCorrespondingViewText(s):this.mapDomToView(s);if(o&&o.parent)return new x(o.parent,o.index+1)}return null}}mapDomToView(e){return this.getHostViewElement(e)||this._domToViewMapping.get(e)}findCorrespondingViewText(e){if(gi(e))return null;const t=this.getHostViewElement(e);if(t)return t;const n=e.previousSibling;if(n){if(!this.isElement(n))return null;const s=this.mapDomToView(n);if(s){const o=s.nextSibling;return o instanceof le?o:null}}else{const s=this.mapDomToView(e.parentNode);if(s){const o=s.getChild(0);return o instanceof le?o:null}}return null}mapViewToDom(e){return this._viewToDomMapping.get(e)}findCorrespondingDomText(e){const t=e.previousSibling;return t&&this.mapViewToDom(t)?this.mapViewToDom(t).nextSibling:!t&&e.parent&&this.mapViewToDom(e.parent)?this.mapViewToDom(e.parent).childNodes[0]:null}focus(e){const t=this.mapViewToDom(e);if(t&&t.ownerDocument.activeElement!==t){const{scrollX:n,scrollY:s}=I.window,o=[];Qh(t,r=>{const{scrollLeft:a,scrollTop:l}=r;o.push([a,l])}),t.focus(),Qh(t,r=>{const[a,l]=o.shift();r.scrollLeft=a,r.scrollTop=l}),I.window.scrollTo(n,s)}}_clearDomSelection(){const e=this.mapViewToDom(this.document.selection.editableElement);if(!e)return;const t=e.ownerDocument.defaultView.getSelection(),n=this.domSelectionToView(t);n&&n.rangeCount>0&&t.removeAllRanges()}isElement(e){return e&&e.nodeType==Node.ELEMENT_NODE}isDocumentFragment(e){return e&&e.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isBlockFiller(e){return this.blockFillerMode=="br"?e.isEqualNode(_3):e.tagName==="BR"&&ef(e,this.blockElements)&&e.parentNode.childNodes.length===1?!0:e.isEqualNode(y3)||k3(e,this.blockElements)}isDomSelectionBackward(e){if(e.isCollapsed)return!1;const t=this._domDocument.createRange();try{t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset)}catch{return!1}const n=t.collapsed;return t.detach(),n}getHostViewElement(e){const t=e5(e);for(t.pop();t.length;){const n=t.pop(),s=this._domToViewMapping.get(n);if(s&&(s.is("uiElement")||s.is("rawElement")))return s}return null}isDomSelectionCorrect(e){return this._isDomSelectionPositionCorrect(e.anchorNode,e.anchorOffset)&&this._isDomSelectionPositionCorrect(e.focusNode,e.focusOffset)}registerRawContentMatcher(e){this._rawContentElementMatcher.add(e)}registerInlineObjectMatcher(e){this._inlineObjectElementMatcher.add(e)}_clearTemporaryCustomProperties(){for(const e of this._elementsWithTemporaryCustomProperties)e._removeCustomProperty("editingPipeline:doNotReuseOnce");this._elementsWithTemporaryCustomProperties.clear()}_getBlockFiller(){switch(this.blockFillerMode){case"nbsp":return qh(this._domDocument);case"markedNbsp":return Gh(this._domDocument);case"br":return Kh(this._domDocument)}}_isDomSelectionPositionCorrect(e,t){if(he(e)&&Ke(e)&&t<yt||this.isElement(e)&&Ke(e.childNodes[t]))return!1;const n=this.mapDomToView(e);return!(n&&(n.is("uiElement")||n.is("rawElement")))}*_domToView(e,t,n){if(this.isBlockFiller(e))return null;const s=this.getHostViewElement(e);if(s)return s;if(ls(e)&&t.skipComments)return null;if(he(e)){if(gi(e))return null;{const o=e.data;if(o==="")return null;const r=new le(this.document,o);return n.push(r),r}}else{let o=this.mapDomToView(e);if(o)return this._isInlineObjectElement(o)&&n.push(o),o;if(this.isDocumentFragment(e))o=new Pn(this.document),t.bind&&this.bindDocumentFragments(e,o);else{o=this._createViewElement(e,t),t.bind&&this.bindElements(e,o);const a=e.attributes;if(a)for(let l=a.length,c=0;c<l;c++)o._setAttribute(a[c].name,a[c].value);if(this._isViewElementWithRawContent(o,t))return o._setCustomProperty("$rawContent",e.innerHTML),this._isBlockViewElement(o)||n.push(o),o;if(ls(e))return o._setCustomProperty("$rawContent",e.data),o}yield o;const r=[];if(t.withChildren!==!1)for(const a of this.domChildrenToView(e,t,r))o._appendChild(a);if(this._isInlineObjectElement(o))n.push(o);else for(const a of r)n.push(a)}}_processDomInlineNodes(e,t,n){if(!t.length||e&&!this.isDocumentFragment(e)&&!this._isBlockDomElement(e))return;let s=!1;for(let o=0;o<t.length;o++){const r=t[o];if(!r.is("$text")){s=!1;continue}let a,l=!1;if(C3(r,this.preElements))a=Zh(r.data);else{a=r.data.replace(/[ \n\t\r]{1,}/g," "),l=/[^\S\u00A0]/.test(a.charAt(a.length-1));const c=o>0?t[o-1]:null,u=o+1<t.length?t[o+1]:null,d=!c||c.is("element")&&c.name=="br"||s,h=u?!1:!Ke(r.data);n.withChildren!==!1&&(d&&(a=a.replace(/^ /,"")),h&&(a=a.replace(/ $/,""))),a=Zh(a),a=a.replace(/ \u00A0/g,"  ");const f=u&&u.is("element")&&u.name!="br",m=u&&u.is("$text")&&u.data.charAt(0)==" ";(/[ \u00A0]\u00A0$/.test(a)||!u||f||m)&&(a=a.replace(/\u00A0$/," ")),(d||c&&c.is("element")&&c.name!="br")&&(a=a.replace(/^\u00A0/," "))}a.length==0&&r.parent?(r._remove(),t.splice(o,1),o--):(r._data=a,s=l)}t.length=0}_processDataFromViewText(e){let t=e.data;if(e.getAncestors().some(n=>this.preElements.includes(n.name)))return t;if(t.charAt(0)==" "){const n=this._getTouchingInlineViewNode(e,!1);(n&&n.is("$textProxy")&&this._nodeEndsWithSpace(n)||!n)&&(t=" "+t.substr(1))}if(t.charAt(t.length-1)==" "){const n=this._getTouchingInlineViewNode(e,!0),s=n&&n.is("$textProxy")&&n.data.charAt(0)==" ";(t.charAt(t.length-2)==" "||!n||s)&&(t=t.substr(0,t.length-1)+" ")}return t.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(e){if(e.getAncestors().some(n=>this.preElements.includes(n.name)))return!1;const t=this._processDataFromViewText(e);return t.charAt(t.length-1)==" "}_getTouchingInlineViewNode(e,t){const n=new Sn({startPosition:t?x._createAfter(e):x._createBefore(e),direction:t?"forward":"backward"});for(const s of n){if(s.item.is("element","br"))return null;if(this._isInlineObjectElement(s.item))return s.item;if(s.item.is("containerElement"))return null;if(s.item.is("$textProxy"))return s.item}return null}_isBlockDomElement(e){return this.isElement(e)&&this.blockElements.includes(e.tagName.toLowerCase())}_isBlockViewElement(e){return e.is("element")&&this.blockElements.includes(e.name)}_isInlineObjectElement(e){return e.is("element")?e.name=="br"||this.inlineObjectElements.includes(e.name)||!!this._inlineObjectElementMatcher.match(e):!1}_createViewElement(e,t){if(ls(e))return new Fo(this.document,"$comment");const n=t.keepOriginalCase?e.tagName:e.tagName.toLowerCase();return new vt(this.document,n)}_isViewElementWithRawContent(e,t){return t.withChildren!==!1&&e.is("element")&&!!this._rawContentElementMatcher.match(e)}_shouldRenameElement(e){const t=e.toLowerCase();return this.renderingMode==="editing"&&this.unsafeElements.includes(t)}_createReplacementDomElement(e,t){const n=this._domDocument.createElement("span");if(n.setAttribute(Xh,e),t){for(;t.firstChild;)n.appendChild(t.firstChild);for(const s of t.getAttributeNames())n.setAttribute(s,t.getAttribute(s))}return n}}function C3(i,e){return i.getAncestors().some(t=>t.is("element")&&e.includes(t.name))}function Qh(i,e){let t=i;for(;t;)e(t),t=t.parentElement}function k3(i,e){return i.isEqualNode(v3)&&ef(i,e)&&i.parentNode.childNodes.length===1}function ef(i,e){const t=i.parentNode;return!!t&&!!t.tagName&&e.includes(t.tagName.toLowerCase())}function tf(i){i==="script"&&Q("domconverter-unsafe-script-element-detected"),i==="style"&&Q("domconverter-unsafe-style-element-detected")}function T3(i){if(!$.isGecko||!i.rangeCount)return!1;const e=i.getRangeAt(0).startContainer;try{Object.prototype.toString.call(e)}catch{return!0}return!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Pt extends qe(){constructor(e){super(),this._isEnabled=!1,this.view=e,this.document=e.document}get isEnabled(){return this._isEnabled}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(e){return e&&e.nodeType===3&&(e=e.parentNode),!e||e.nodeType!==1?!1:e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class pi{constructor(e,t,n){this.view=e,this.document=e.document,this.domEvent=t,this.domTarget=t.target,Hu(this,n)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class cn extends Pt{constructor(){super(...arguments),this.useCapture=!1}observe(e){(typeof this.domEventType=="string"?[this.domEventType]:this.domEventType).forEach(n=>{this.listenTo(e,n,(s,o)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(o.target)&&this.onDomEvent(o)},{useCapture:this.useCapture})})}stopObserving(e){this.stopListening(e)}fire(e,t,n){this.isEnabled&&this.document.fire(e,new pi(this.view,t,n))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class E3 extends cn{constructor(){super(...arguments),this.domEventType=["keydown","keyup"]}onDomEvent(e){const t={keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,get keystroke(){return hi(this)}};this.fire(e.type,e,t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class A3 extends Pt{constructor(e){super(e),this._fireSelectionChangeDoneDebounced=St(t=>{this.document.fire("selectionChangeDone",t)},200)}observe(){const e=this.document;e.on("arrowKey",(t,n)=>{e.selection.isFake&&this.isEnabled&&n.preventDefault()},{context:"$capture"}),e.on("arrowKey",(t,n)=>{e.selection.isFake&&this.isEnabled&&this._handleSelectionMove(n.keyCode)},{priority:"lowest"})}stopObserving(){}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const t=this.document.selection,n=new Gt(t.getRanges(),{backward:t.isBackward,fake:!1});(e==U.arrowleft||e==U.arrowup)&&n.setTo(n.getFirstPosition()),(e==U.arrowright||e==U.arrowdown)&&n.setTo(n.getLastPosition());const s={oldSelection:t,newSelection:n,domSelection:null};this.document.fire("selectionChange",s),this._fireSelectionChangeDoneDebounced(s)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let nf=class extends Pt{constructor(e){super(e),this._config={childList:!0,characterData:!0,subtree:!0},this.domConverter=e.domConverter,this.renderer=e._renderer,this._domElements=new Set,this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.add(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}stopObserving(e){if(this._domElements.delete(e),this.isEnabled){this._mutationObserver.disconnect();for(const t of this._domElements)this._mutationObserver.observe(t,this._config)}}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(e.length===0)return;const t=this.domConverter,n=new Set,s=new Set;for(const r of e){const a=t.mapDomToView(r.target);a&&(a.is("uiElement")||a.is("rawElement")||r.type==="childList"&&!this._isBogusBrMutation(r)&&s.add(a))}for(const r of e){const a=t.mapDomToView(r.target);if(!(a&&(a.is("uiElement")||a.is("rawElement")))&&r.type==="characterData"){const l=t.findCorrespondingViewText(r.target);l&&!s.has(l.parent)?n.add(l):!l&&Ke(r.target)&&s.add(t.mapDomToView(r.target.parentNode))}}let o=!1;for(const r of n)o=!0,this.renderer.markToSync("text",r);for(const r of s){const a=t.mapViewToDom(r),l=Array.from(r.getChildren()),c=Array.from(t.domChildrenToView(a,{withChildren:!1}));Lk(l,c,x3)||(o=!0,this.renderer.markToSync("children",r))}o&&this.view.forceRender()}_isBogusBrMutation(e){let t=null;return e.nextSibling===null&&e.removedNodes.length===0&&e.addedNodes.length==1&&(t=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),t&&t.is("element","br")}};function x3(i,e){if(!Array.isArray(i))return i===e?!0:i.is("$text")&&e.is("$text")?i.data===e.data:!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class zo extends cn{constructor(e){super(e),this._isFocusChanging=!1,this.domEventType=["focus","blur"],this.useCapture=!0;const t=this.document;t.on("focus",()=>{this._isFocusChanging=!0,this._renderTimeoutId=setTimeout(()=>{this.flush(),e.change(()=>{})},50)}),t.on("blur",(n,s)=>{const o=t.selection.editableElement;(o===null||o===s.target)&&(t.isFocused=!1,this._isFocusChanging=!1,e.change(()=>{}))})}flush(){this._isFocusChanging&&(this._isFocusChanging=!1,this.document.isFocused=!0)}onDomEvent(e){this.fire(e.type,e)}destroy(){this._renderTimeoutId&&clearTimeout(this._renderTimeoutId),super.destroy()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class S3 extends Pt{constructor(e){super(e),this.mutationObserver=e.getObserver(nf),this.focusObserver=e.getObserver(zo),this.selection=this.document.selection,this.domConverter=e.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=St(t=>{this.document.fire("selectionChangeDone",t)},200),this._clearInfiniteLoopInterval=setInterval(()=>this._clearInfiniteLoop(),1e3),this._documentIsSelectingInactivityTimeoutDebounced=St(()=>this.document.isSelecting=!1,5e3),this._loopbackCounter=0}observe(e){const t=e.ownerDocument,n=()=>{this.document.isSelecting=!0,this._documentIsSelectingInactivityTimeoutDebounced()},s=()=>{this.document.isSelecting&&(this._handleSelectionChange(null,t),this.document.isSelecting=!1,this._documentIsSelectingInactivityTimeoutDebounced.cancel())};this.listenTo(e,"selectstart",n,{priority:"highest"}),this.listenTo(e,"keydown",s,{priority:"highest",useCapture:!0}),this.listenTo(e,"keyup",s,{priority:"highest",useCapture:!0}),!this._documents.has(t)&&(this.listenTo(t,"mouseup",s,{priority:"highest",useCapture:!0}),this.listenTo(t,"selectionchange",(o,r)=>{this.document.isComposing&&!$.isAndroid||(this._handleSelectionChange(r,t),this._documentIsSelectingInactivityTimeoutDebounced())}),this._documents.add(t))}stopObserving(e){this.stopListening(e)}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel()}_reportInfiniteLoop(){}_handleSelectionChange(e,t){if(!this.isEnabled)return;const n=t.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(n.anchorNode))return;this.mutationObserver.flush();const s=this.domConverter.domSelectionToView(n);if(s.rangeCount==0){this.view.hasDomSelection=!1;return}if(this.view.hasDomSelection=!0,this.focusObserver.flush(),!(this.selection.isEqual(s)&&this.domConverter.isDomSelectionCorrect(n))){if(++this._loopbackCounter>60){this._reportInfiniteLoop();return}if(this.selection.isSimilar(s))this.view.forceRender();else{const o={oldSelection:this.selection,newSelection:s,domSelection:n};this.document.fire("selectionChange",o),this._fireSelectionChangeDoneDebounced(o)}}}_clearInfiniteLoop(){this._loopbackCounter=0}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class I3 extends cn{constructor(e){super(e),this.domEventType=["compositionstart","compositionupdate","compositionend"];const t=this.document;t.on("compositionstart",()=>{t.isComposing=!0},{priority:"low"}),t.on("compositionend",()=>{t.isComposing=!1},{priority:"low"})}onDomEvent(e){this.fire(e.type,e,{data:e.data})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class sf{constructor(e,t={}){this._files=t.cacheFiles?of(e):null,this._native=e}get files(){return this._files||(this._files=of(this._native)),this._files}get types(){return this._native.types}getData(e){return this._native.getData(e)}setData(e,t){this._native.setData(e,t)}set effectAllowed(e){this._native.effectAllowed=e}get effectAllowed(){return this._native.effectAllowed}set dropEffect(e){this._native.dropEffect=e}get dropEffect(){return this._native.dropEffect}setDragImage(e,t,n){this._native.setDragImage(e,t,n)}get isCanceled(){return this._native.dropEffect=="none"||!!this._native.mozUserCancelled}}function of(i){const e=Array.from(i.files||[]),t=Array.from(i.items||[]);return e.length?e:t.filter(n=>n.kind==="file").map(n=>n.getAsFile())}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class P3 extends cn{constructor(){super(...arguments),this.domEventType="beforeinput"}onDomEvent(e){const t=e.getTargetRanges(),n=this.view,s=n.document;let o=null,r=null,a=[];if(e.dataTransfer&&(o=new sf(e.dataTransfer)),e.data!==null?r=e.data:o&&(r=o.getData("text/plain")),s.selection.isFake)a=Array.from(s.selection.getRanges());else if(t.length)a=t.map(l=>{const c=n.domConverter.domPositionToView(l.startContainer,l.startOffset),u=n.domConverter.domPositionToView(l.endContainer,l.endOffset);if(c)return n.createRange(c,u);if(u)return n.createRange(u)}).filter(l=>!!l);else if($.isAndroid){const l=e.target.ownerDocument.defaultView.getSelection();a=Array.from(n.domConverter.domSelectionToView(l).getRanges())}if($.isAndroid&&e.inputType=="insertCompositionText"&&r&&r.endsWith(`
`)){this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:[n.createRange(a[0].end)]});return}if(e.inputType=="insertText"&&r&&r.includes(`
`)){const l=r.split(/\n{1,2}/g);let c=a;for(let u=0;u<l.length;u++){const d=l[u];d!=""&&(this.fire(e.type,e,{data:d,dataTransfer:o,targetRanges:c,inputType:e.inputType,isComposing:e.isComposing}),c=[s.selection.getFirstRange()]),u+1<l.length&&(this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:c}),c=[s.selection.getFirstRange()])}return}this.fire(e.type,e,{data:r,dataTransfer:o,targetRanges:a,inputType:e.inputType,isComposing:e.isComposing})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class R3 extends Pt{constructor(e){super(e),this.document.on("keydown",(t,n)=>{if(this.isEnabled&&f5(n.keyCode)){const s=new fi(this.document,"arrowKey",this.document.selection.getFirstRange());this.document.fire(s,n),s.stop.called&&t.stop()}})}observe(){}stopObserving(){}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class M3 extends Pt{constructor(e){super(e);const t=this.document;t.on("keydown",(n,s)=>{if(!this.isEnabled||s.keyCode!=U.tab||s.ctrlKey)return;const o=new fi(t,"tab",t.selection.getFirstRange());t.fire(o,s),o.stop.called&&n.stop()})}observe(){}stopObserving(){}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let B3=class extends re(){constructor(e){super(),this.domRoots=new Map,this._initialDomRootAttributes=new WeakMap,this._observers=new Map,this._ongoingChange=!1,this._postFixersInProgress=!1,this._renderingDisabled=!1,this._hasChangedSinceTheLastRendering=!1,this.document=new No(e),this.domConverter=new Uo(this.document),this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new d3(this.domConverter,this.document.selection),this._renderer.bind("isFocused","isSelecting","isComposing").to(this.document,"isFocused","isSelecting","isComposing"),this._writer=new Uh(this.document),this.addObserver(nf),this.addObserver(zo),this.addObserver(S3),this.addObserver(E3),this.addObserver(A3),this.addObserver(I3),this.addObserver(R3),this.addObserver(P3),this.addObserver(M3),c3(this),t3(this),this.on("render",()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1}),this.listenTo(this.document.selection,"change",()=>{this._hasChangedSinceTheLastRendering=!0}),this.listenTo(this.document,"change:isFocused",()=>{this._hasChangedSinceTheLastRendering=!0}),$.isiOS&&this.listenTo(this.document,"blur",(t,n)=>{this.domConverter.mapDomToView(n.domEvent.relatedTarget)||this.domConverter._clearDomSelection()})}attachDomRoot(e,t="main"){const n=this.document.getRoot(t);n._name=e.tagName.toLowerCase();const s={};for(const{name:r,value:a}of Array.from(e.attributes))s[r]=a,r==="class"?this._writer.addClass(a.split(" "),n):this._writer.setAttribute(r,a,n);this._initialDomRootAttributes.set(e,s);const o=()=>{this._writer.setAttribute("contenteditable",(!n.isReadOnly).toString(),n),n.isReadOnly?this._writer.addClass("ck-read-only",n):this._writer.removeClass("ck-read-only",n)};o(),this.domRoots.set(t,e),this.domConverter.bindElements(e,n),this._renderer.markToSync("children",n),this._renderer.markToSync("attributes",n),this._renderer.domDocuments.add(e.ownerDocument),n.on("change:children",(r,a)=>this._renderer.markToSync("children",a)),n.on("change:attributes",(r,a)=>this._renderer.markToSync("attributes",a)),n.on("change:text",(r,a)=>this._renderer.markToSync("text",a)),n.on("change:isReadOnly",()=>this.change(o)),n.on("change",()=>{this._hasChangedSinceTheLastRendering=!0});for(const r of this._observers.values())r.observe(e,t)}detachDomRoot(e){const t=this.domRoots.get(e);Array.from(t.attributes).forEach(({name:s})=>t.removeAttribute(s));const n=this._initialDomRootAttributes.get(t);for(const s in n)t.setAttribute(s,n[s]);this.domRoots.delete(e),this.domConverter.unbindDomElement(t);for(const s of this._observers.values())s.stopObserving(t)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let t=this._observers.get(e);if(t)return t;t=new e(this),this._observers.set(e,t);for(const[n,s]of this.domRoots)t.observe(s,n);return t.enable(),t}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection({alignToTop:e,forceScroll:t,viewportOffset:n=20,ancestorOffset:s=20}={}){const o=this.document.selection.getFirstRange();if(!o)return;const r=ot({alignToTop:e,forceScroll:t,viewportOffset:n,ancestorOffset:s});typeof n=="number"&&(n={top:n,bottom:n,left:n,right:n});const a={target:this.domConverter.viewRangeToDom(o),viewportOffset:n,ancestorOffset:s,alignToTop:e,forceScroll:t};this.fire("scrollToTheSelection",a,r),r5(a)}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new p("cannot-change-view-tree",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const t=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),t}catch(t){/* istanbul ignore next -- @preserve */p.rethrowUnexpectedError(t,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.getObserver(zo).flush(),this.change(()=>{})}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,t){return x._createAt(e,t)}createPositionAfter(e){return x._createAfter(e)}createPositionBefore(e){return x._createBefore(e)}createRange(e,t){return new H(e,t)}createRangeOn(e){return H._createOn(e)}createRangeIn(e){return H._createIn(e)}createSelection(...e){return new Gt(...e)}_disableRendering(e){this._renderingDisabled=e,e==!1&&this.change(()=>{})}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class un{is(){throw new Error("is() method is abstract")}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Rn=class extends un{constructor(e){super(),this.parent=null,this._attrs=_t(e)}get document(){return null}get index(){let e;if(!this.parent)return null;if((e=this.parent.getChildIndex(this))===null)throw new p("model-node-not-found-in-parent",this);return e}get startOffset(){let e;if(!this.parent)return null;if((e=this.parent.getChildStartOffset(this))===null)throw new p("model-node-not-found-in-parent",this);return e}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.parent===null?!1:this.root.isAttached()}getPath(){const e=[];let t=this;for(;t.parent;)e.unshift(t.startOffset),t=t.parent;return e}getAncestors(e={}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}getCommonAncestor(e,t={}){const n=this.getAncestors(t),s=e.getAncestors(t);let o=0;for(;n[o]==s[o]&&n[o];)o++;return o===0?null:n[o-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const t=this.getPath(),n=e.getPath(),s=Be(t,n);switch(s){case"prefix":return!0;case"extension":return!1;default:return t[s]<n[s]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}hasAttribute(e){return this._attrs.has(e)}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce((t,n)=>(t[n[0]]=n[1],t),{})),e}_clone(e){return new this.constructor(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(e,t){this._attrs.set(e,t)}_setAttributesTo(e){this._attrs=_t(e)}_removeAttribute(e){return this._attrs.delete(e)}_clearAttributes(){this._attrs.clear()}};Rn.prototype.is=function(i){return i==="node"||i==="model:node"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ms{constructor(e){this._nodes=[],e&&this._insertNodes(0,e)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((e,t)=>e+t.offsetSize,0)}getNode(e){return this._nodes[e]||null}getNodeIndex(e){const t=this._nodes.indexOf(e);return t==-1?null:t}getNodeStartOffset(e){const t=this.getNodeIndex(e);return t===null?null:this._nodes.slice(0,t).reduce((n,s)=>n+s.offsetSize,0)}indexToOffset(e){if(e==this._nodes.length)return this.maxOffset;const t=this._nodes[e];if(!t)throw new p("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(t)}offsetToIndex(e){let t=0;for(const n of this._nodes){if(e>=t&&e<t+n.offsetSize)return this.getNodeIndex(n);t+=n.offsetSize}if(t!=e)throw new p("model-nodelist-offset-out-of-bounds",this,{offset:e,nodeList:this});return this.length}_insertNodes(e,t){for(const n of t)if(!(n instanceof Rn))throw new p("model-nodelist-insertnodes-not-node",this);this._nodes=x5(this._nodes,Array.from(t),e,0)}_removeNodes(e,t=1){return this._nodes.splice(e,t)}toJSON(){return this._nodes.map(e=>e.toJSON())}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class te extends Rn{constructor(e,t){super(t),this._data=e||""}get offsetSize(){return this.data.length}get data(){return this._data}toJSON(){const e=super.toJSON();return e.data=this.data,e}_clone(){return new te(this.data,this.getAttributes())}static fromJSON(e){return new te(e.data,e.attributes)}}te.prototype.is=function(i){return i==="$text"||i==="model:$text"||i==="text"||i==="model:text"||i==="node"||i==="model:node"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ct extends un{constructor(e,t,n){if(super(),this.textNode=e,t<0||t>e.offsetSize)throw new p("model-textproxy-wrong-offsetintext",this);if(n<0||t+n>e.offsetSize)throw new p("model-textproxy-wrong-length",this);this.data=e.data.substring(t,t+n),this.offsetInText=t}get startOffset(){return this.textNode.startOffset!==null?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return this.startOffset!==null?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}Ct.prototype.is=function(i){return i==="$textProxy"||i==="model:$textProxy"||i==="textProxy"||i==="model:textProxy"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Y extends Rn{constructor(e,t,n){super(t),this._children=new ms,this.name=e,n&&this._insertChild(0,n)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}offsetToIndex(e){return this._children.offsetToIndex(e)}getNodeByPath(e){let t=this;for(const n of e)t=t.getChild(t.offsetToIndex(n));return t}findAncestor(e,t={}){let n=t.includeSelf?this:this.parent;for(;n;){if(n.name===e)return n;n=n.parent}return null}toJSON(){const e=super.toJSON();if(e.name=this.name,this._children.length>0){e.children=[];for(const t of this._children)e.children.push(t.toJSON())}return e}_clone(e=!1){const t=e?Array.from(this._children).map(n=>n._clone(!0)):void 0;return new Y(this.name,this.getAttributes(),t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const n=O3(t);for(const s of n)s.parent!==null&&s._remove(),s.parent=this;this._children._insertNodes(e,n)}_removeChildren(e,t=1){const n=this._children._removeNodes(e,t);for(const s of n)s.parent=null;return n}static fromJSON(e){let t;if(e.children){t=[];for(const n of e.children)n.name?t.push(Y.fromJSON(n)):t.push(te.fromJSON(n))}return new Y(e.name,e.attributes,t)}}Y.prototype.is=function(i,e){return e?e===this.name&&(i==="element"||i==="model:element"):i==="element"||i==="model:element"||i==="node"||i==="model:node"};function O3(i){return typeof i=="string"?[new te(i)]:(je(i)||(i=[i]),Array.from(i).map(e=>typeof e=="string"?new te(e):e instanceof Ct?new te(e.data,e.getAttributes()):e))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Kt{constructor(e){if(!e||!e.boundaries&&!e.startPosition)throw new p("model-tree-walker-no-start-position",null);const t=e.direction||"forward";if(t!="forward"&&t!="backward")throw new p("model-tree-walker-unknown-direction",e,{direction:t});this.direction=t,this.boundaries=e.boundaries||null,e.startPosition?this._position=e.startPosition.clone():this._position=C._createAt(this.boundaries[this.direction=="backward"?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}get position(){return this._position}skip(e){let t,n,s,o;do s=this.position,o=this._visitedParent,{done:t,value:n}=this.next();while(!t&&e(n));t||(this._position=s,this._visitedParent=o)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){const e=this.position,t=this.position.clone(),n=this._visitedParent;if(n.parent===null&&t.offset===n.maxOffset)return{done:!0,value:void 0};if(n===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0,value:void 0};const s=gs(t,n),o=s||rf(t,n,s);if(o instanceof Y){if(!this.shallow)t.path.push(0),this._visitedParent=o;else{if(this.boundaries&&this.boundaries.end.isBefore(t))return{done:!0,value:void 0};t.offset++}return this._position=t,Mn("elementStart",o,e,t,1)}if(o instanceof te){let r;if(this.singleCharacters)r=1;else{let c=o.endOffset;this._boundaryEndParent==n&&this.boundaries.end.offset<c&&(c=this.boundaries.end.offset),r=c-t.offset}const a=t.offset-o.startOffset,l=new Ct(o,a,r);return t.offset+=r,this._position=t,Mn("text",l,e,t,r)}return t.path.pop(),t.offset++,this._position=t,this._visitedParent=n.parent,this.ignoreElementEnd?this._next():Mn("elementEnd",n,e,t)}_previous(){const e=this.position,t=this.position.clone(),n=this._visitedParent;if(n.parent===null&&t.offset===0)return{done:!0,value:void 0};if(n==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0,value:void 0};const s=t.parent,o=gs(t,s),r=o||af(t,s,o);if(r instanceof Y)return t.offset--,this.shallow?(this._position=t,Mn("elementStart",r,e,t,1)):(t.path.push(r.maxOffset),this._position=t,this._visitedParent=r,this.ignoreElementEnd?this._previous():Mn("elementEnd",r,e,t));if(r instanceof te){let a;if(this.singleCharacters)a=1;else{let u=r.startOffset;this._boundaryStartParent==n&&this.boundaries.start.offset>u&&(u=this.boundaries.start.offset),a=t.offset-u}const l=t.offset-r.startOffset,c=new Ct(r,l-a,a);return t.offset-=a,this._position=t,Mn("text",c,e,t,a)}return t.path.pop(),this._position=t,this._visitedParent=n.parent,Mn("elementStart",n,e,t,1)}}function Mn(i,e,t,n,s){return{done:!1,value:{type:i,item:e,previousPosition:t,nextPosition:n,length:s}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class C extends un{constructor(e,t,n="toNone"){if(super(),!e.is("element")&&!e.is("documentFragment"))throw new p("model-position-root-invalid",e);if(!(t instanceof Array)||t.length===0)throw new p("model-position-path-incorrect-format",e,{path:t});e.is("rootElement")?t=t.slice():(t=[...e.getPath(),...t],e=e.root),this.root=e,this.path=t,this.stickiness=n}get offset(){return this.path[this.path.length-1]}set offset(e){this.path[this.path.length-1]=e}get parent(){let e=this.root;for(let t=0;t<this.path.length-1;t++)if(e=e.getChild(e.offsetToIndex(this.path[t])),!e)throw new p("model-position-path-incorrect",this,{position:this});if(e.is("$text"))throw new p("model-position-path-incorrect",this,{position:this});return e}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return gs(this,this.parent)}get nodeAfter(){const e=this.parent;return rf(this,e,gs(this,e))}get nodeBefore(){const e=this.parent;return af(this,e,gs(this,e))}get isAtStart(){return this.offset===0}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(e){if(this.root!=e.root)return"different";const t=Be(this.path,e.path);switch(t){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[t]<e.path[t]?"before":"after"}}getLastMatchingPosition(e,t={}){t.startPosition=this;const n=new Kt(t);return n.skip(e),n.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const e=this.parent;return e.is("documentFragment")?[e]:e.getAncestors({includeSelf:!0})}findAncestor(e){const t=this.parent;return t.is("element")?t.findAncestor(e,{includeSelf:!0}):null}getCommonPath(e){if(this.root!=e.root)return[];const t=Be(this.path,e.path),n=typeof t=="string"?Math.min(this.path.length,e.path.length):t;return this.path.slice(0,n)}getCommonAncestor(e){const t=this.getAncestors(),n=e.getAncestors();let s=0;for(;t[s]==n[s]&&t[s];)s++;return s===0?null:t[s-1]}getShiftedBy(e){const t=this.clone(),n=t.offset+e;return t.offset=n<0?0:n,t}isAfter(e){return this.compareWith(e)=="after"}isBefore(e){return this.compareWith(e)=="before"}isEqual(e){return this.compareWith(e)=="same"}isTouching(e){if(this.root!==e.root)return!1;const t=Math.min(this.path.length,e.path.length);for(let n=0;n<t;n++){const s=this.path[n]-e.path[n];if(s<-1||s>1)return!1;if(s===1)return lf(e,this,n);if(s===-1)return lf(this,e,n)}return this.path.length===e.path.length?!0:this.path.length>e.path.length?bl(this.path,t):bl(e.path,t)}hasSameParentAs(e){if(this.root!==e.root)return!1;const t=this.getParentPath(),n=e.getParentPath();return Be(t,n)=="same"}getTransformedByOperation(e){let t;switch(e.type){case"insert":t=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":t=this._getTransformedByMoveOperation(e);break;case"split":t=this._getTransformedBySplitOperation(e);break;case"merge":t=this._getTransformedByMergeOperation(e);break;default:t=C._createAt(this);break}return t}_getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany)}_getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany)}_getTransformedBySplitOperation(e){const t=e.movedRange;return t.containsPosition(this)||t.start.isEqual(this)&&this.stickiness=="toNext"?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1)}_getTransformedByMergeOperation(e){const t=e.movedRange,n=t.containsPosition(this)||t.start.isEqual(this);let s;return n?(s=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(s=s._getTransformedByDeletion(e.deletionPosition,1))):this.isEqual(e.deletionPosition)?s=C._createAt(e.deletionPosition):s=this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),s}_getTransformedByDeletion(e,t){const n=C._createAt(this);if(this.root!=e.root)return n;if(Be(e.getParentPath(),this.getParentPath())=="same"){if(e.offset<this.offset){if(e.offset+t>this.offset)return null;n.offset-=t}}else if(Be(e.getParentPath(),this.getParentPath())=="prefix"){const s=e.path.length-1;if(e.offset<=this.path[s]){if(e.offset+t>this.path[s])return null;n.path[s]-=t}}return n}_getTransformedByInsertion(e,t){const n=C._createAt(this);if(this.root!=e.root)return n;if(Be(e.getParentPath(),this.getParentPath())=="same")(e.offset<this.offset||e.offset==this.offset&&this.stickiness!="toPrevious")&&(n.offset+=t);else if(Be(e.getParentPath(),this.getParentPath())=="prefix"){const s=e.path.length-1;e.offset<=this.path[s]&&(n.path[s]+=t)}return n}_getTransformedByMove(e,t,n){if(t=t._getTransformedByDeletion(e,n),e.isEqual(t))return C._createAt(this);const s=this._getTransformedByDeletion(e,n);return s===null||e.isEqual(this)&&this.stickiness=="toNext"||e.getShiftedBy(n).isEqual(this)&&this.stickiness=="toPrevious"?this._getCombined(e,t):s._getTransformedByInsertion(t,n)}_getCombined(e,t){const n=e.path.length-1,s=C._createAt(t);return s.stickiness=this.stickiness,s.offset=s.offset+this.path[n]-e.offset,s.path=[...s.path,...this.path.slice(n+1)],s}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(e,t,n="toNone"){if(e instanceof C)return new C(e.root,e.path,e.stickiness);{const s=e;if(t=="end")t=s.maxOffset;else{if(t=="before")return this._createBefore(s,n);if(t=="after")return this._createAfter(s,n);if(t!==0&&!t)throw new p("model-createpositionat-offset-required",[this,e])}if(!s.is("element")&&!s.is("documentFragment"))throw new p("model-position-parent-incorrect",[this,e]);const o=s.getPath();return o.push(t),new this(s.root,o,n)}}static _createAfter(e,t){if(!e.parent)throw new p("model-position-after-root",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,t)}static _createBefore(e,t){if(!e.parent)throw new p("model-position-before-root",e,{root:e});return this._createAt(e.parent,e.startOffset,t)}static fromJSON(e,t){if(e.root==="$graveyard"){const n=new C(t.graveyard,e.path);return n.stickiness=e.stickiness,n}if(!t.getRoot(e.root))throw new p("model-position-fromjson-no-root",t,{rootName:e.root});return new C(t.getRoot(e.root),e.path,e.stickiness)}}C.prototype.is=function(i){return i==="position"||i==="model:position"};function gs(i,e){const t=e.getChild(e.offsetToIndex(i.offset));return t&&t.is("$text")&&t.startOffset<i.offset?t:null}function rf(i,e,t){return t!==null?null:e.getChild(e.offsetToIndex(i.offset))}function af(i,e,t){return t!==null?null:e.getChild(e.offsetToIndex(i.offset)-1)}function lf(i,e,t){return!(t+1===i.path.length||!bl(e.path,t+1)||!L3(i,t+1))}function bl(i,e){for(;e<i.length;){if(i[e]!==0)return!1;e++}return!0}function L3(i,e){let t=i.parent,n=i.path.length-1,s=0;for(;n>=e;){if(i.path[n]+s!==t.maxOffset)return!1;s=1,n--,t=t.parent}return!0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class v extends un{constructor(e,t){super(),this.start=C._createAt(e),this.end=t?C._createAt(t):C._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new Kt({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){const e=this.start.getParentPath(),t=this.end.getParentPath();return Be(e,t)=="same"}get root(){return this.start.root}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const n=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),s=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return n&&s}containsItem(e){const t=C._createBefore(e);return this.containsPosition(t)||this.start.isEqual(t)}isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new v(this.start,e.start)),this.containsPosition(e.end)&&t.push(new v(e.end,this.end))):t.push(new v(this.start,this.end)),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,n=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(n=e.end),new v(t,n)}return null}getJoined(e,t=!1){let n=this.isIntersecting(e);if(n||(this.start.isBefore(e.start)?n=t?this.end.isTouching(e.start):this.end.isEqual(e.start):n=t?e.end.isTouching(this.start):e.end.isEqual(this.start)),!n)return null;let s=this.start,o=this.end;return e.start.isBefore(s)&&(s=e.start),e.end.isAfter(o)&&(o=e.end),new v(s,o)}getMinimalFlatRanges(){const e=[],t=this.start.getCommonPath(this.end).length,n=C._createAt(this.start);let s=n.parent;for(;n.path.length>t+1;){const o=s.maxOffset-n.offset;o!==0&&e.push(new v(n,n.getShiftedBy(o))),n.path=n.path.slice(0,-1),n.offset++,s=s.parent}for(;n.path.length<=this.end.path.length;){const o=this.end.path[n.path.length-1],r=o-n.offset;r!==0&&e.push(new v(n,n.getShiftedBy(r))),n.offset=o,n.path.push(0)}return e}getWalker(e={}){return e.boundaries=this,new Kt(e)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new Kt(e);for(const n of t)yield n.item}*getPositions(e={}){e.boundaries=this;const t=new Kt(e);yield t.position;for(const n of t)yield n.nextPosition}getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new v(this.start,this.end)]}getTransformedByOperations(e){const t=[new v(this.start,this.end)];for(const n of e)for(let s=0;s<t.length;s++){const o=t[s].getTransformedByOperation(n);t.splice(s,1,...o),s+=o.length-1}for(let n=0;n<t.length;n++){const s=t[n];for(let o=n+1;o<t.length;o++){const r=t[o];(s.containsRange(r)||r.containsRange(s)||s.isEqual(r))&&t.splice(o,1)}}return t}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const e=this.start.nodeAfter,t=this.end.nodeBefore;return e&&e.is("element")&&e===t?e:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(e,t=!1){return this._getTransformedByInsertion(e.position,e.howMany,t)}_getTransformedByMoveOperation(e,t=!1){const n=e.sourcePosition,s=e.howMany,o=e.targetPosition;return this._getTransformedByMove(n,o,s,t)}_getTransformedBySplitOperation(e){const t=this.start._getTransformedBySplitOperation(e);let n=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(n=this.end.getShiftedBy(1)),t.root!=n.root&&(n=this.end.getShiftedBy(-1)),new v(t,n)}_getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new v(this.start);let t=this.start._getTransformedByMergeOperation(e),n=this.end._getTransformedByMergeOperation(e);return t.root!=n.root&&(n=this.end.getShiftedBy(-1)),t.isAfter(n)?(e.sourcePosition.isBefore(e.targetPosition)?(t=C._createAt(n),t.offset=0):(e.deletionPosition.isEqual(t)||(n=e.deletionPosition),t=e.targetPosition),new v(t,n)):new v(t,n)}_getTransformedByInsertion(e,t,n=!1){if(n&&this.containsPosition(e))return[new v(this.start,e),new v(e.getShiftedBy(t),this.end._getTransformedByInsertion(e,t))];{const s=new v(this.start,this.end);return s.start=s.start._getTransformedByInsertion(e,t),s.end=s.end._getTransformedByInsertion(e,t),[s]}}_getTransformedByMove(e,t,n,s=!1){if(this.isCollapsed){const d=this.start._getTransformedByMove(e,t,n);return[new v(d)]}const o=v._createFromPositionAndShift(e,n),r=t._getTransformedByDeletion(e,n);if(this.containsPosition(t)&&!s&&(o.containsPosition(this.start)||o.containsPosition(this.end))){const d=this.start._getTransformedByMove(e,t,n),h=this.end._getTransformedByMove(e,t,n);return[new v(d,h)]}let a;const l=this.getDifference(o);let c=null;const u=this.getIntersection(o);if(l.length==1?c=new v(l[0].start._getTransformedByDeletion(e,n),l[0].end._getTransformedByDeletion(e,n)):l.length==2&&(c=new v(this.start,this.end._getTransformedByDeletion(e,n))),c?a=c._getTransformedByInsertion(r,n,u!==null||s):a=[],u){const d=new v(u.start._getCombined(o.start,r),u.end._getCombined(o.start,r));a.length==2?a.splice(1,0,d):a.push(d)}return a}_getTransformedByDeletion(e,t){let n=this.start._getTransformedByDeletion(e,t),s=this.end._getTransformedByDeletion(e,t);return n==null&&s==null?null:(n==null&&(n=e),s==null&&(s=e),new v(n,s))}static _createFromPositionAndShift(e,t){const n=e,s=e.getShiftedBy(t);return t>0?new this(n,s):new this(s,n)}static _createIn(e){return new this(C._createAt(e,0),C._createAt(e,e.maxOffset))}static _createOn(e){return this._createFromPositionAndShift(C._createBefore(e),e.offsetSize)}static _createFromRanges(e){if(e.length===0)throw new p("range-create-from-ranges-empty-array",null);if(e.length==1)return e[0].clone();const t=e[0];e.sort((o,r)=>o.start.isAfter(r.start)?1:-1);const n=e.indexOf(t),s=new this(t.start,t.end);if(n>0)for(let o=n-1;e[o].end.isEqual(s.start);o++)s.start=C._createAt(e[o].start);for(let o=n+1;o<e.length&&e[o].start.isEqual(s.end);o++)s.end=C._createAt(e[o].end);return s}static fromJSON(e,t){return new this(C.fromJSON(e.start,t),C.fromJSON(e.end,t))}}v.prototype.is=function(i){return i==="range"||i==="model:range"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class cf extends ee(){constructor(){super(),this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._viewToModelLengthCallbacks=new Map,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._deferredBindingRemovals=new Map,this._unboundMarkerNames=new Set,this.on("modelToViewPosition",(e,t)=>{if(t.viewPosition)return;const n=this._modelToViewMapping.get(t.modelPosition.parent);if(!n)throw new p("mapping-model-position-view-parent-not-found",this,{modelPosition:t.modelPosition});t.viewPosition=this.findPositionIn(n,t.modelPosition.offset)},{priority:"low"}),this.on("viewToModelPosition",(e,t)=>{if(t.modelPosition)return;const n=this.findMappedViewAncestor(t.viewPosition),s=this._viewToModelMapping.get(n),o=this._toModelOffset(t.viewPosition.parent,t.viewPosition.offset,n);t.modelPosition=C._createAt(s,o)},{priority:"low"})}bindElements(e,t){this._modelToViewMapping.set(e,t),this._viewToModelMapping.set(t,e)}unbindViewElement(e,t={}){const n=this.toModelElement(e);if(this._elementToMarkerNames.has(e))for(const s of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(s);t.defer?this._deferredBindingRemovals.set(e,e.root):(this._viewToModelMapping.delete(e),this._modelToViewMapping.get(n)==e&&this._modelToViewMapping.delete(n))}unbindModelElement(e){const t=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(t)==e&&this._viewToModelMapping.delete(t)}bindElementToMarker(e,t){const n=this._markerNameToElements.get(t)||new Set;n.add(e);const s=this._elementToMarkerNames.get(e)||new Set;s.add(t),this._markerNameToElements.set(t,n),this._elementToMarkerNames.set(e,s)}unbindElementFromMarkerName(e,t){const n=this._markerNameToElements.get(t);n&&(n.delete(e),n.size==0&&this._markerNameToElements.delete(t));const s=this._elementToMarkerNames.get(e);s&&(s.delete(t),s.size==0&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}flushDeferredBindings(){for(const[e,t]of this._deferredBindingRemovals)e.root==t&&this.unbindViewElement(e);this._deferredBindingRemovals=new Map}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this._deferredBindingRemovals=new Map}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new v(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new H(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const t={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",t),t.modelPosition}toViewPosition(e,t={}){const n={modelPosition:e,mapper:this,isPhantom:t.isPhantom};return this.fire("modelToViewPosition",n),n.viewPosition}markerNameToElements(e){const t=this._markerNameToElements.get(e);if(!t)return null;const n=new Set;for(const s of t)if(s.is("attributeElement"))for(const o of s.getElementsWithSameId())n.add(o);else n.add(s);return n}registerViewToModelLength(e,t){this._viewToModelLengthCallbacks.set(e,t)}findMappedViewAncestor(e){let t=e.parent;for(;!this._viewToModelMapping.has(t);)t=t.parent;return t}_toModelOffset(e,t,n){if(n!=e){const o=this._toModelOffset(e.parent,e.index,n),r=this._toModelOffset(e,t,e);return o+r}if(e.is("$text"))return t;let s=0;for(let o=0;o<t;o++)s+=this.getModelLength(e.getChild(o));return s}getModelLength(e){if(this._viewToModelLengthCallbacks.get(e.name))return this._viewToModelLengthCallbacks.get(e.name)(e);if(this._viewToModelMapping.has(e))return 1;if(e.is("$text"))return e.data.length;if(e.is("uiElement"))return 0;{let t=0;for(const n of e.getChildren())t+=this.getModelLength(n);return t}}findPositionIn(e,t){let n,s=0,o=0,r=0;if(e.is("$text"))return new x(e,t);for(;o<t;)n=e.getChild(r),s=this.getModelLength(n),o+=s,r++;return o==t?this._moveViewPositionToTextNode(new x(e,r)):this.findPositionIn(n,t-(o-s))}_moveViewPositionToTextNode(e){const t=e.nodeBefore,n=e.nodeAfter;return t instanceof le?new x(t,t.data.length):n instanceof le?new x(n,0):e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class V3{constructor(){this._consumable=new Map,this._textProxyRegistry=new Map}add(e,t){t=Ho(t),e instanceof Ct&&(e=this._getSymbolForTextProxy(e)),this._consumable.has(e)||this._consumable.set(e,new Map),this._consumable.get(e).set(t,!0)}consume(e,t){return t=Ho(t),e instanceof Ct&&(e=this._getSymbolForTextProxy(e)),this.test(e,t)?(this._consumable.get(e).set(t,!1),!0):!1}test(e,t){t=Ho(t),e instanceof Ct&&(e=this._getSymbolForTextProxy(e));const n=this._consumable.get(e);if(n===void 0)return null;const s=n.get(t);return s===void 0?null:s}revert(e,t){t=Ho(t),e instanceof Ct&&(e=this._getSymbolForTextProxy(e));const n=this.test(e,t);return n===!1?(this._consumable.get(e).set(t,!0),!0):n===!0?!1:null}verifyAllConsumed(e){const t=[];for(const[n,s]of this._consumable)for(const[o,r]of s){const a=o.split(":")[0];r&&e==a&&t.push({event:o,item:n.name||n.description})}if(t.length)throw new p("conversion-model-consumable-not-consumed",null,{items:t})}_getSymbolForTextProxy(e){let t=null;const n=this._textProxyRegistry.get(e.startOffset);if(n){const s=n.get(e.endOffset);s&&(t=s.get(e.parent))}return t||(t=this._addSymbolForTextProxy(e)),t}_addSymbolForTextProxy(e){const t=e.startOffset,n=e.endOffset,s=e.parent,o=Symbol("$textProxy:"+e.data);let r,a;return r=this._textProxyRegistry.get(t),r||(r=new Map,this._textProxyRegistry.set(t,r)),a=r.get(n),a||(a=new Map,r.set(n,a)),a.set(s,o),o}}function Ho(i){const e=i.split(":");return e[0]=="insert"?e[0]:e[0]=="addMarker"||e[0]=="removeMarker"?i:e.length>1?e[0]+":"+e[1]:e[0]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class uf extends ee(){constructor(e){super(),this._conversionApi={dispatcher:this,...e},this._firedEventsMap=new WeakMap}convertChanges(e,t,n){const s=this._createConversionApi(n,e.getRefreshedItems());for(const r of e.getMarkersToRemove())this._convertMarkerRemove(r.name,r.range,s);const o=this._reduceChanges(e.getChanges());for(const r of o)r.type==="insert"?this._convertInsert(v._createFromPositionAndShift(r.position,r.length),s):r.type==="reinsert"?this._convertReinsert(v._createFromPositionAndShift(r.position,r.length),s):r.type==="remove"?this._convertRemove(r.position,r.length,r.name,s):this._convertAttribute(r.range,r.attributeKey,r.attributeOldValue,r.attributeNewValue,s);s.mapper.flushDeferredBindings();for(const r of s.mapper.flushUnboundMarkerNames()){const a=t.get(r).getRange();this._convertMarkerRemove(r,a,s),this._convertMarkerAdd(r,a,s)}for(const r of e.getMarkersToAdd())this._convertMarkerAdd(r.name,r.range,s);s.consumable.verifyAllConsumed("insert")}convert(e,t,n,s={}){const o=this._createConversionApi(n,void 0,s);this._convertInsert(e,o);for(const[r,a]of t)this._convertMarkerAdd(r,a,o);o.consumable.verifyAllConsumed("insert")}convertSelection(e,t,n){const s=this._createConversionApi(n);this.fire("cleanSelection",{selection:e},s);const o=e.getFirstPosition().root;if(!s.mapper.toViewElement(o))return;const r=Array.from(t.getMarkersAtPosition(e.getFirstPosition()));if(this._addConsumablesForSelection(s.consumable,e,r),this.fire("selection",{selection:e},s),!!e.isCollapsed){for(const a of r)if(s.consumable.test(e,"addMarker:"+a.name)){const l=a.getRange();if(!D3(e.getFirstPosition(),a,s.mapper))continue;const c={item:e,markerName:a.name,markerRange:l};this.fire(`addMarker:${a.name}`,c,s)}for(const a of e.getAttributeKeys())if(s.consumable.test(e,"attribute:"+a)){const l={item:e,range:e.getFirstRange(),attributeKey:a,attributeOldValue:null,attributeNewValue:e.getAttribute(a)};this.fire(`attribute:${a}:$text`,l,s)}}}_convertInsert(e,t,n={}){n.doNotAddConsumables||this._addConsumablesForInsert(t.consumable,e);for(const s of Array.from(e.getWalker({shallow:!0})).map(df))this._testAndFire("insert",s,t)}_convertRemove(e,t,n,s){this.fire(`remove:${n}`,{position:e,length:t},s)}_convertAttribute(e,t,n,s,o){this._addConsumablesForRange(o.consumable,e,`attribute:${t}`);for(const r of e){const a={item:r.item,range:v._createFromPositionAndShift(r.previousPosition,r.length),attributeKey:t,attributeOldValue:n,attributeNewValue:s};this._testAndFire(`attribute:${t}`,a,o)}}_convertReinsert(e,t){const n=Array.from(e.getWalker({shallow:!0}));this._addConsumablesForInsert(t.consumable,n);for(const s of n.map(df))this._testAndFire("insert",{...s,reconversion:!0},t)}_convertMarkerAdd(e,t,n){if(t.root.rootName=="$graveyard")return;const s=`addMarker:${e}`;if(n.consumable.add(t,s),this.fire(s,{markerName:e,markerRange:t},n),!!n.consumable.consume(t,s)){this._addConsumablesForRange(n.consumable,t,s);for(const o of t.getItems()){if(!n.consumable.test(o,s))continue;const r={item:o,range:v._createOn(o),markerName:e,markerRange:t};this.fire(s,r,n)}}}_convertMarkerRemove(e,t,n){t.root.rootName!="$graveyard"&&this.fire(`removeMarker:${e}`,{markerName:e,markerRange:t},n)}_reduceChanges(e){const t={changes:e};return this.fire("reduceChanges",t),t.changes}_addConsumablesForInsert(e,t){for(const n of t){const s=n.item;if(e.test(s,"insert")===null){e.add(s,"insert");for(const o of s.getAttributeKeys())e.add(s,"attribute:"+o)}}return e}_addConsumablesForRange(e,t,n){for(const s of t.getItems())e.add(s,n);return e}_addConsumablesForSelection(e,t,n){e.add(t,"selection");for(const s of n)e.add(t,"addMarker:"+s.name);for(const s of t.getAttributeKeys())e.add(t,"attribute:"+s);return e}_testAndFire(e,t,n){const s=N3(e,t),o=t.item.is("$textProxy")?n.consumable._getSymbolForTextProxy(t.item):t.item,r=this._firedEventsMap.get(n),a=r.get(o);if(!a)r.set(o,new Set([s]));else if(!a.has(s))a.add(s);else return;this.fire(s,t,n)}_testAndFireAddAttributes(e,t){const n={item:e,range:v._createOn(e)};for(const s of n.item.getAttributeKeys())n.attributeKey=s,n.attributeOldValue=null,n.attributeNewValue=n.item.getAttribute(s),this._testAndFire(`attribute:${s}`,n,t)}_createConversionApi(e,t=new Set,n={}){const s={...this._conversionApi,consumable:new V3,writer:e,options:n,convertItem:o=>this._convertInsert(v._createOn(o),s),convertChildren:o=>this._convertInsert(v._createIn(o),s,{doNotAddConsumables:!0}),convertAttributes:o=>this._testAndFireAddAttributes(o,s),canReuseView:o=>!t.has(s.mapper.toModelElement(o))};return this._firedEventsMap.set(s,new Map),s}}function D3(i,e,t){const n=e.getRange(),s=Array.from(i.getAncestors());return s.shift(),s.reverse(),!s.some(r=>{if(n.containsItem(r))return!!t.toViewElement(r).getCustomProperty("addHighlight")})}function N3(i,e){const t=e.item.is("element")?e.item.name:"$text";return`${i}:${t}`}function df(i){const e=i.item,t=v._createFromPositionAndShift(i.previousPosition,i.length);return{item:e,range:t}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ze extends ee(un){constructor(...e){super(),this._lastRangeBackward=!1,this._attrs=new Map,this._ranges=[],e.length&&this.setTo(...e)}get anchor(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.end:e.start}return null}get focus(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.start:e.end}return null}get isCollapsed(){return this._ranges.length===1?this._ranges[0].isCollapsed:!1}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let n=!1;for(const s of e._ranges)if(t.isEqual(s)){n=!0;break}if(!n)return!1}return!0}*getRanges(){for(const e of this._ranges)yield new v(e.start,e.end)}getFirstRange(){let e=null;for(const t of this._ranges)(!e||t.start.isBefore(e.start))&&(e=t);return e?new v(e.start,e.end):null}getLastRange(){let e=null;for(const t of this._ranges)(!e||t.end.isAfter(e.end))&&(e=t);return e?new v(e.start,e.end):null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}setTo(...e){let[t,n,s]=e;if(typeof n=="object"&&(s=n,n=void 0),t===null)this._setRanges([]);else if(t instanceof Ze)this._setRanges(t.getRanges(),t.isBackward);else if(t&&typeof t.getRanges=="function")this._setRanges(t.getRanges(),t.isBackward);else if(t instanceof v)this._setRanges([t],!!s&&!!s.backward);else if(t instanceof C)this._setRanges([new v(t)]);else if(t instanceof Rn){const o=!!s&&!!s.backward;let r;if(n=="in")r=v._createIn(t);else if(n=="on")r=v._createOn(t);else if(n!==void 0)r=new v(C._createAt(t,n));else throw new p("model-selection-setto-required-second-parameter",[this,t]);this._setRanges([r],o)}else if(je(t))this._setRanges(t,s&&!!s.backward);else throw new p("model-selection-setto-not-selectable",[this,t])}_setRanges(e,t=!1){const n=Array.from(e),s=n.some(o=>{if(!(o instanceof v))throw new p("model-selection-set-ranges-not-range",[this,e]);return this._ranges.every(r=>!r.isEqual(o))});n.length===this._ranges.length&&!s||(this._replaceAllRanges(n),this._lastRangeBackward=!!t,this.fire("change:range",{directChange:!0}))}setFocus(e,t){if(this.anchor===null)throw new p("model-selection-setfocus-no-ranges",[this,e]);const n=C._createAt(e,t);if(n.compareWith(this.focus)=="same")return;const s=this.anchor;this._ranges.length&&this._popRange(),n.compareWith(s)=="before"?(this._pushRange(new v(n,s)),this._lastRangeBackward=!0):(this._pushRange(new v(s,n)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(e){return this._attrs.has(e)}removeAttribute(e){this.hasAttribute(e)&&(this._attrs.delete(e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}setAttribute(e,t){this.getAttribute(e)!==t&&(this._attrs.set(e,t),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}*getSelectedBlocks(){const e=new WeakSet;for(const t of this.getRanges()){const n=ff(t.start,e);$3(n,t)&&(yield n);for(const o of t.getWalker()){const r=o.item;o.type=="elementEnd"&&F3(r,e,t)&&(yield r)}const s=ff(t.end,e);U3(s,t)&&(yield s)}}containsEntireContent(e=this.anchor.root){const t=C._createAt(e,0),n=C._createAt(e,"end");return t.isTouching(this.getFirstPosition())&&n.isTouching(this.getLastPosition())}_pushRange(e){this._checkRange(e),this._ranges.push(new v(e.start,e.end))}_checkRange(e){for(let t=0;t<this._ranges.length;t++)if(e.isIntersecting(this._ranges[t]))throw new p("model-selection-range-intersects",[this,e],{addedRange:e,intersectingRange:this._ranges[t]})}_replaceAllRanges(e){this._removeAllRanges();for(const t of e)this._pushRange(t)}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}}Ze.prototype.is=function(i){return i==="selection"||i==="model:selection"};function hf(i,e){return e.has(i)?!1:(e.add(i),i.root.document.model.schema.isBlock(i)&&!!i.parent)}function F3(i,e,t){return hf(i,e)&&wl(i,t)}function ff(i,e){const n=i.parent.root.document.model.schema,s=i.parent.getAncestors({parentFirst:!0,includeSelf:!0});let o=!1;const r=s.find(a=>o?!1:(o=n.isLimit(a),!o&&hf(a,e)));return s.forEach(a=>e.add(a)),r}function wl(i,e){const t=z3(i);return t?!e.containsRange(v._createOn(t),!0):!0}function $3(i,e){return i?e.isCollapsed||i.isEmpty?!0:e.start.isTouching(C._createAt(i,i.maxOffset))?!1:wl(i,e):!1}function U3(i,e){return i?e.isCollapsed||i.isEmpty?!0:e.end.isTouching(C._createAt(i,0))?!1:wl(i,e):!1}function z3(i){const e=i.root.document.model.schema;let t=i.parent;for(;t;){if(e.isBlock(t))return t;t=t.parent}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class rt extends ee(v){constructor(e,t){super(e,t),H3.call(this)}detach(){this.stopListening()}toRange(){return new v(this.start,this.end)}static fromRange(e){return new rt(e.start,e.end)}}rt.prototype.is=function(i){return i==="liveRange"||i==="model:liveRange"||i=="range"||i==="model:range"};function H3(){this.listenTo(this.root.document.model,"applyOperation",(i,e)=>{const t=e[0];t.isDocumentOperation&&W3.call(this,t)},{priority:"low"})}function W3(i){const e=this.getTransformedByOperation(i),t=v._createFromRanges(e),n=!t.isEqual(this),s=j3(this,i);let o=null;if(n){t.root.rootName=="$graveyard"&&(i.type=="remove"?o=i.sourcePosition:o=i.deletionPosition);const r=this.toRange();this.start=t.start,this.end=t.end,this.fire("change:range",r,{deletionPosition:o})}else s&&this.fire("change:content",this.toRange(),{deletionPosition:o})}function j3(i,e){switch(e.type){case"insert":return i.containsPosition(e.position);case"move":case"remove":case"reinsert":case"merge":return i.containsPosition(e.sourcePosition)||i.start.isEqual(e.sourcePosition)||i.containsPosition(e.targetPosition);case"split":return i.containsPosition(e.splitPosition)||i.containsPosition(e.insertionPosition)}return!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const ps="selection:";class kt extends ee(un){constructor(e){super(),this._selection=new q3(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection.updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(e){this._selection.observeMarkers(e)}_setFocus(e,t){this._selection.setFocus(e,t)}_setTo(...e){this._selection.setTo(...e)}_setAttribute(e,t){this._selection.setAttribute(e,t)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection.getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return ps+e}static _isStoreAttributeKey(e){return e.startsWith(ps)}}kt.prototype.is=function(i){return i==="selection"||i=="model:selection"||i=="documentSelection"||i=="model:documentSelection"};class q3 extends Ze{constructor(e){super(),this.markers=new Oe({idProperty:"name"}),this._attributePriority=new Map,this._selectionRestorePosition=null,this._hasChangedRange=!1,this._overriddenGravityRegister=new Set,this._observedMarkers=new Set,this._model=e.model,this._document=e,this.listenTo(this._model,"applyOperation",(t,n)=>{const s=n[0];!s.isDocumentOperation||s.type=="marker"||s.type=="rename"||s.type=="noop"||(this._ranges.length==0&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))},{priority:"lowest"}),this.on("change:range",()=>{this._validateSelectionRanges(this.getRanges())}),this.listenTo(this._model.markers,"update",(t,n,s,o)=>{this._updateMarker(n,o)}),this.listenTo(this._document,"change",(t,n)=>{G3(this._model,n)})}get isCollapsed(){return this._ranges.length===0?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(...e){super.setTo(...e),this._updateAttributes(!0),this.updateMarkers()}setFocus(e,t){super.setFocus(e,t),this._updateAttributes(!0),this.updateMarkers()}setAttribute(e,t){if(this._setAttribute(e,t)){const n=[e];this.fire("change:attribute",{attributeKeys:n,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}overrideGravity(){const e=it();return this._overriddenGravityRegister.add(e),this._overriddenGravityRegister.size===1&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new p("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(e){this._observedMarkers.add(e),this.updateMarkers()}_replaceAllRanges(e){this._validateSelectionRanges(e),super._replaceAllRanges(e)}_popRange(){this._ranges.pop().detach()}_pushRange(e){const t=this._prepareRange(e);t&&this._ranges.push(t)}_validateSelectionRanges(e){for(const t of e)if(!this._document._validateSelectionRange(t))throw new p("document-selection-wrong-position",this,{range:t})}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const t=rt.fromRange(e);return t.on("change:range",(n,s,o)=>{if(this._hasChangedRange=!0,t.root==this._document.graveyard){this._selectionRestorePosition=o.deletionPosition;const r=this._ranges.indexOf(t);this._ranges.splice(r,1),t.detach()}}),t}updateMarkers(){if(!this._observedMarkers.size)return;const e=[];let t=!1;for(const s of this._model.markers){const o=s.name.split(":",1)[0];if(!this._observedMarkers.has(o))continue;const r=s.getRange();for(const a of this.getRanges())r.containsRange(a,!a.isCollapsed)&&e.push(s)}const n=Array.from(this.markers);for(const s of e)this.markers.has(s)||(this.markers.add(s),t=!0);for(const s of Array.from(this.markers))e.includes(s)||(this.markers.remove(s),t=!0);t&&this.fire("change:marker",{oldMarkers:n,directChange:!1})}_updateMarker(e,t){const n=e.name.split(":",1)[0];if(!this._observedMarkers.has(n))return;let s=!1;const o=Array.from(this.markers),r=this.markers.has(e);if(!t)r&&(this.markers.remove(e),s=!0);else{let a=!1;for(const l of this.getRanges())if(t.containsRange(l,!l.isCollapsed)){a=!0;break}a&&!r?(this.markers.add(e),s=!0):!a&&r&&(this.markers.remove(e),s=!0)}s&&this.fire("change:marker",{oldMarkers:o,directChange:!1})}_updateAttributes(e){const t=_t(this._getSurroundingAttributes()),n=_t(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[o,r]of this._attributePriority)r=="low"&&(this._attrs.delete(o),this._attributePriority.delete(o));this._setAttributesTo(t);const s=[];for(const[o,r]of this.getAttributes())(!n.has(o)||n.get(o)!==r)&&s.push(o);for(const[o]of n)this.hasAttribute(o)||s.push(o);s.length>0&&this.fire("change:attribute",{attributeKeys:s,directChange:!1})}_setAttribute(e,t,n=!0){const s=n?"normal":"low";return s=="low"&&this._attributePriority.get(e)=="normal"||super.getAttribute(e)===t?!1:(this._attrs.set(e,t),this._attributePriority.set(e,s),!0)}_removeAttribute(e,t=!0){const n=t?"normal":"low";return n=="low"&&this._attributePriority.get(e)=="normal"||(this._attributePriority.set(e,n),!super.hasAttribute(e))?!1:(this._attrs.delete(e),!0)}_setAttributesTo(e){const t=new Set;for(const[n,s]of this.getAttributes())e.get(n)!==s&&this._removeAttribute(n,!1);for(const[n,s]of e)this._setAttribute(n,s,!1)&&t.add(n);return t}*getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const t of e.getAttributeKeys())t.startsWith(ps)&&(yield[t.substr(ps.length),e.getAttribute(t)])}_getSurroundingAttributes(){const e=this.getFirstPosition(),t=this._model.schema;if(e.root.rootName=="$graveyard")return null;let n=null;if(this.isCollapsed){const s=e.textNode?e.textNode:e.nodeBefore,o=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(n=bs(s,t)),n||(n=bs(o,t)),!this.isGravityOverridden&&!n){let r=s;for(;r&&!n;)r=r.previousSibling,n=bs(r,t)}if(!n){let r=o;for(;r&&!n;)r=r.nextSibling,n=bs(r,t)}n||(n=this.getStoredAttributes())}else{const s=this.getFirstRange();for(const o of s){if(o.item.is("element")&&t.isObject(o.item)){n=bs(o.item,t);break}if(o.type=="text"){n=o.item.getAttributes();break}}}return n}_fixGraveyardSelection(e){const t=this._model.schema.getNearestSelectionRange(e);t&&this._pushRange(t)}}function bs(i,e){if(!i)return null;if(i instanceof Ct||i instanceof te)return i.getAttributes();if(!e.isInline(i))return null;if(!e.isObject(i))return[];const t=[];for(const[n,s]of i.getAttributes())e.checkAttribute("$text",n)&&e.getAttributeProperties(n).copyFromObject!==!1&&t.push([n,s]);return t}function G3(i,e){const t=i.document.differ;for(const n of t.getChanges()){if(n.type!="insert")continue;const s=n.position.parent;n.length===s.maxOffset&&i.enqueueChange(e,r=>{const a=Array.from(s.getAttributeKeys()).filter(l=>l.startsWith(ps));for(const l of a)r.removeAttribute(l,s)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class mf{constructor(e){this._dispatchers=e}add(e){for(const t of this._dispatchers)e(t);return this}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class K3 extends mf{elementToElement(e){return this.add(hT(e))}elementToStructure(e){return this.add(fT(e))}attributeToElement(e){return this.add(mT(e))}attributeToAttribute(e){return this.add(gT(e))}markerToElement(e){return this.add(pT(e))}markerToHighlight(e){return this.add(wT(e))}markerToData(e){return this.add(bT(e))}}function gf(){return(i,e,t)=>{if(!t.consumable.consume(e.item,i.name))return;const n=t.writer,s=t.mapper.toViewPosition(e.range.start),o=n.createText(e.item.data);n.insert(s,o)}}function pf(){return(i,e,t)=>{t.convertAttributes(e.item),!e.reconversion&&e.item.is("element")&&!e.item.isEmpty&&t.convertChildren(e.item)}}function Z3(){return(i,e,t)=>{const n=t.mapper.toViewPosition(e.position),s=e.position.getShiftedBy(e.length),o=t.mapper.toViewPosition(s,{isPhantom:!0}),r=t.writer.createRange(n,o),a=t.writer.remove(r.getTrimmed());for(const l of t.writer.createRangeIn(a).getItems())t.mapper.unbindViewElement(l,{defer:!0})}}function bf(i,e){const t=i.createAttributeElement("span",e.attributes);return e.classes&&t._addClass(e.classes),typeof e.priority=="number"&&(t._priority=e.priority),t._id=e.id,t}function J3(){return(i,e,t)=>{const n=e.selection;if(n.isCollapsed||!t.consumable.consume(n,"selection"))return;const s=[];for(const o of n.getRanges())s.push(t.mapper.toViewRange(o));t.writer.setSelection(s,{backward:n.isBackward})}}function Y3(){return(i,e,t)=>{const n=e.selection;if(!n.isCollapsed||!t.consumable.consume(n,"selection"))return;const s=t.writer,o=n.getFirstPosition(),r=t.mapper.toViewPosition(o),a=s.breakAttributes(r);s.setSelection(a)}}function X3(){return(i,e,t)=>{const n=t.writer,s=n.document.selection;for(const o of s.getRanges())o.isCollapsed&&o.end.parent.isAttached()&&t.writer.mergeAttributes(o.start);n.setSelection(null)}}function Q3(i){return(e,t,n)=>{if(!n.consumable.test(t.item,e.name))return;const s=i(t.attributeOldValue,n,t),o=i(t.attributeNewValue,n,t);if(!s&&!o)return;n.consumable.consume(t.item,e.name);const r=n.writer,a=r.document.selection;if(t.item instanceof Ze||t.item instanceof kt)r.wrap(a.getFirstRange(),o);else{let l=n.mapper.toViewRange(t.range);t.attributeOldValue!==null&&s&&(l=r.unwrap(l,s)),t.attributeNewValue!==null&&o&&r.wrap(l,o)}}}function eT(i,e=ET){return(t,n,s)=>{if(!e(n.item,s.consumable,{preflight:!0}))return;const o=i(n.item,s,n);if(!o)return;e(n.item,s.consumable);const r=s.mapper.toViewPosition(n.range.start);s.mapper.bindElements(n.item,o),s.writer.insert(r,o),s.convertAttributes(n.item),Tf(o,n.item.getChildren(),s,{reconversion:n.reconversion})}}function tT(i,e){return(t,n,s)=>{if(!e(n.item,s.consumable,{preflight:!0}))return;const o=new Map;s.writer._registerSlotFactory(yT(n.item,o,s));const r=i(n.item,s,n);if(s.writer._clearSlotFactory(),!r)return;CT(n.item,o,s),e(n.item,s.consumable);const a=s.mapper.toViewPosition(n.range.start);s.mapper.bindElements(n.item,r),s.writer.insert(a,r),s.convertAttributes(n.item),kT(r,o,s,{reconversion:n.reconversion})}}function nT(i){return(e,t,n)=>{t.isOpening=!0;const s=i(t,n);t.isOpening=!1;const o=i(t,n);if(!s||!o)return;const r=t.markerRange;if(r.isCollapsed&&!n.consumable.consume(r,e.name))return;for(const c of r)if(!n.consumable.consume(c.item,e.name))return;const a=n.mapper,l=n.writer;l.insert(a.toViewPosition(r.start),s),n.mapper.bindElementToMarker(s,t.markerName),r.isCollapsed||(l.insert(a.toViewPosition(r.end),o),n.mapper.bindElementToMarker(o,t.markerName)),e.stop()}}function iT(){return(i,e,t)=>{const n=t.mapper.markerNameToElements(e.markerName);if(n){for(const s of n)t.mapper.unbindElementFromMarkerName(s,e.markerName),t.writer.clear(t.writer.createRangeOn(s),s);t.writer.clearClonedElementsGroup(e.markerName),i.stop()}}}function sT(i){return(e,t,n)=>{const s=i(t.markerName,n);if(!s)return;const o=t.markerRange;n.consumable.consume(o,e.name)&&(wf(o,!1,n,t,s),wf(o,!0,n,t,s),e.stop())}}function wf(i,e,t,n,s){const o=e?i.start:i.end,r=o.nodeAfter&&o.nodeAfter.is("element")?o.nodeAfter:null,a=o.nodeBefore&&o.nodeBefore.is("element")?o.nodeBefore:null;if(r||a){let c,u;e&&r||!e&&!a?(c=r,u=!0):(c=a,u=!1);const d=t.mapper.toViewElement(c);if(d){oT(d,e,u,t,n,s);return}}const l=t.mapper.toViewPosition(o);rT(l,e,t,n,s)}function oT(i,e,t,n,s,o){const r=`data-${o.group}-${e?"start":"end"}-${t?"before":"after"}`,a=i.hasAttribute(r)?i.getAttribute(r).split(","):[];a.unshift(o.name),n.writer.setAttribute(r,a.join(","),i),n.mapper.bindElementToMarker(i,s.markerName)}function rT(i,e,t,n,s){const o=`${s.group}-${e?"start":"end"}`,r=s.name?{name:s.name}:null,a=t.writer.createUIElement(o,r);t.writer.insert(i,a),t.mapper.bindElementToMarker(a,n.markerName)}function aT(i){return(e,t,n)=>{const s=i(t.markerName,n);if(!s)return;const o=n.mapper.markerNameToElements(t.markerName);if(!o)return;for(const a of o)n.mapper.unbindElementFromMarkerName(a,t.markerName),a.is("containerElement")?(r(`data-${s.group}-start-before`,a),r(`data-${s.group}-start-after`,a),r(`data-${s.group}-end-before`,a),r(`data-${s.group}-end-after`,a)):n.writer.clear(n.writer.createRangeOn(a),a);n.writer.clearClonedElementsGroup(t.markerName),e.stop();function r(a,l){if(l.hasAttribute(a)){const c=new Set(l.getAttribute(a).split(","));c.delete(s.name),c.size==0?n.writer.removeAttribute(a,l):n.writer.setAttribute(a,Array.from(c).join(","),l)}}}}function lT(i){return(e,t,n)=>{if(!n.consumable.test(t.item,e.name))return;const s=i(t.attributeOldValue,n,t),o=i(t.attributeNewValue,n,t);if(!s&&!o)return;n.consumable.consume(t.item,e.name);const r=n.mapper.toViewElement(t.item),a=n.writer;if(!r)throw new p("conversion-attribute-to-attribute-on-text",n.dispatcher,t);if(t.attributeOldValue!==null&&s)if(s.key=="class"){const l=typeof s.value=="string"?s.value.split(/\s+/):s.value;for(const c of l)a.removeClass(c,r)}else if(s.key=="style")if(typeof s.value=="string"){const l=new Lo(a.document.stylesProcessor);l.setTo(s.value);for(const[c]of l.getStylesEntries())a.removeStyle(c,r)}else{const l=Object.keys(s.value);for(const c of l)a.removeStyle(c,r)}else a.removeAttribute(s.key,r);if(t.attributeNewValue!==null&&o)if(o.key=="class"){const l=typeof o.value=="string"?o.value.split(/\s+/):o.value;for(const c of l)a.addClass(c,r)}else if(o.key=="style")if(typeof o.value=="string"){const l=new Lo(a.document.stylesProcessor);l.setTo(o.value);for(const[c,u]of l.getStylesEntries())a.setStyle(c,u,r)}else{const l=Object.keys(o.value);for(const c of l)a.setStyle(c,o.value[c],r)}else a.setAttribute(o.key,o.value,r)}}function cT(i){return(e,t,n)=>{if(!t.item||!(t.item instanceof Ze||t.item instanceof kt)&&!t.item.is("$textProxy"))return;const s=_l(i,t,n);if(!s||!n.consumable.consume(t.item,e.name))return;const o=n.writer,r=bf(o,s),a=o.document.selection;if(t.item instanceof Ze||t.item instanceof kt)o.wrap(a.getFirstRange(),r);else{const l=n.mapper.toViewRange(t.range),c=o.wrap(l,r);for(const u of c.getItems())if(u.is("attributeElement")&&u.isSimilar(r)){n.mapper.bindElementToMarker(u,t.markerName);break}}}}function uT(i){return(e,t,n)=>{if(!t.item||!(t.item instanceof Y))return;const s=_l(i,t,n);if(!s||!n.consumable.test(t.item,e.name))return;const o=n.mapper.toViewElement(t.item);if(o&&o.getCustomProperty("addHighlight")){n.consumable.consume(t.item,e.name);for(const a of v._createIn(t.item))n.consumable.consume(a.item,e.name);o.getCustomProperty("addHighlight")(o,s,n.writer),n.mapper.bindElementToMarker(o,t.markerName)}}}function dT(i){return(e,t,n)=>{if(t.markerRange.isCollapsed)return;const s=_l(i,t,n);if(!s)return;const o=bf(n.writer,s),r=n.mapper.markerNameToElements(t.markerName);if(r){for(const a of r)n.mapper.unbindElementFromMarkerName(a,t.markerName),a.is("attributeElement")?n.writer.unwrap(n.writer.createRangeOn(a),o):a.getCustomProperty("removeHighlight")(a,s.id,n.writer);n.writer.clearClonedElementsGroup(t.markerName),e.stop()}}}function hT(i){const e=_f(i.model),t=ws(i.view,"container");return e.attributes.length&&(e.children=!0),n=>{n.on(`insert:${e.name}`,eT(t,kf(e)),{priority:i.converterPriority||"normal"}),(e.children||e.attributes.length)&&n.on("reduceChanges",Cf(e),{priority:"low"})}}function fT(i){const e=_f(i.model),t=ws(i.view,"container");return e.children=!0,n=>{if(n._conversionApi.schema.checkChild(e.name,"$text"))throw new p("conversion-element-to-structure-disallowed-text",n,{elementName:e.name});n.on(`insert:${e.name}`,tT(t,kf(e)),{priority:i.converterPriority||"normal"}),n.on("reduceChanges",Cf(e),{priority:"low"})}}function mT(i){i=ot(i);let e=i.model;typeof e=="string"&&(e={key:e});let t=`attribute:${e.key}`;if(e.name&&(t+=":"+e.name),e.values)for(const s of e.values)i.view[s]=ws(i.view[s],"attribute");else i.view=ws(i.view,"attribute");const n=vf(i);return s=>{s.on(t,Q3(n),{priority:i.converterPriority||"normal"})}}function gT(i){i=ot(i);let e=i.model;typeof e=="string"&&(e={key:e});let t=`attribute:${e.key}`;if(e.name&&(t+=":"+e.name),e.values)for(const s of e.values)i.view[s]=yf(i.view[s]);else i.view=yf(i.view);const n=vf(i);return s=>{s.on(t,lT(n),{priority:i.converterPriority||"normal"})}}function pT(i){const e=ws(i.view,"ui");return t=>{t.on(`addMarker:${i.model}`,nT(e),{priority:i.converterPriority||"normal"}),t.on(`removeMarker:${i.model}`,iT(),{priority:i.converterPriority||"normal"})}}function bT(i){i=ot(i);const e=i.model;let t=i.view;return t||(t=n=>({group:e,name:n.substr(i.model.length+1)})),n=>{n.on(`addMarker:${e}`,sT(t),{priority:i.converterPriority||"normal"}),n.on(`removeMarker:${e}`,aT(t),{priority:i.converterPriority||"normal"})}}function wT(i){return e=>{e.on(`addMarker:${i.model}`,cT(i.view),{priority:i.converterPriority||"normal"}),e.on(`addMarker:${i.model}`,uT(i.view),{priority:i.converterPriority||"normal"}),e.on(`removeMarker:${i.model}`,dT(i.view),{priority:i.converterPriority||"normal"})}}function _f(i){return typeof i=="string"&&(i={name:i}),{name:i.name,attributes:i.attributes?J(i.attributes):[],children:!!i.children}}function ws(i,e){return typeof i=="function"?i:(t,n)=>_T(i,n,e)}function _T(i,e,t){typeof i=="string"&&(i={name:i});let n;const s=e.writer,o=Object.assign({},i.attributes);if(t=="container")n=s.createContainerElement(i.name,o);else if(t=="attribute"){const r={priority:i.priority||In.DEFAULT_PRIORITY};n=s.createAttributeElement(i.name,o,r)}else n=s.createUIElement(i.name,o);if(i.styles){const r=Object.keys(i.styles);for(const a of r)s.setStyle(a,i.styles[a],n)}if(i.classes){const r=i.classes;if(typeof r=="string")s.addClass(r,n);else for(const a of r)s.addClass(a,n)}return n}function vf(i){return i.model.values?(e,t,n)=>{const s=i.view[e];return s?s(e,t,n):null}:i.view}function yf(i){return typeof i=="string"?e=>({key:i,value:e}):typeof i=="object"?i.value?()=>i:e=>({key:i.key,value:e}):i}function _l(i,e,t){const n=typeof i=="function"?i(e,t):i;return n?(n.priority||(n.priority=10),n.id||(n.id=e.markerName),n):null}function vT(i){return(e,t)=>{if(!e.is("element",i.name))return!1;if(t.type=="attribute"){if(i.attributes.includes(t.attributeKey))return!0}else{/* istanbul ignore else: This is always true because otherwise it would not register a reducer callback. -- @preserve */if(i.children)return!0}return!1}}function Cf(i){const e=vT(i);return(t,n)=>{const s=[];n.reconvertedElements||(n.reconvertedElements=new Set);for(const o of n.changes){const r=o.type=="attribute"?o.range.start.nodeAfter:o.position.parent;if(!r||!e(r,o)){s.push(o);continue}if(!n.reconvertedElements.has(r)){n.reconvertedElements.add(r);const a=C._createBefore(r);let l=s.length;for(let c=s.length-1;c>=0;c--){const u=s[c],h=(u.type=="attribute"?u.range.start:u.position).compareWith(a);if(h=="before"||u.type=="remove"&&h=="same")break;l=c}s.splice(l,0,{type:"remove",name:r.name,position:a,length:1},{type:"reinsert",name:r.name,position:a,length:1})}}n.changes=s}}function kf(i){return(e,t,n={})=>{const s=["insert"];for(const o of i.attributes)e.hasAttribute(o)&&s.push(`attribute:${o}`);return s.every(o=>t.test(e,o))?(n.preflight||s.forEach(o=>t.consume(e,o)),!0):!1}}function yT(i,e,t){return(n,s)=>{const o=n.createContainerElement("$slot");let r=null;if(s==="children")r=Array.from(i.getChildren());else if(typeof s=="function")r=Array.from(i.getChildren()).filter(a=>s(a));else throw new p("conversion-slot-mode-unknown",t.dispatcher,{modeOrFilter:s});return e.set(o,r),o}}function CT(i,e,t){const n=Array.from(e.values()).flat(),s=new Set(n);if(s.size!=n.length)throw new p("conversion-slot-filter-overlap",t.dispatcher,{element:i});if(s.size!=i.childCount)throw new p("conversion-slot-filter-incomplete",t.dispatcher,{element:i})}function kT(i,e,t,n){t.mapper.on("modelToViewPosition",r,{priority:"highest"});let s=null,o=null;for([s,o]of e)Tf(i,o,t,n),t.writer.move(t.writer.createRangeIn(s),t.writer.createPositionBefore(s)),t.writer.remove(s);t.mapper.off("modelToViewPosition",r);function r(a,l){const c=l.modelPosition.nodeAfter,u=o.indexOf(c);u<0||(l.viewPosition=l.mapper.findPositionIn(s,u))}}function Tf(i,e,t,n){for(const s of e)TT(i.root,s,t,n)||t.convertItem(s)}function TT(i,e,t,n){const{writer:s,mapper:o}=t;if(!n.reconversion)return!1;const r=o.toViewElement(e);return!r||r.root==i||!t.canReuseView(r)?!1:(s.move(s.createRangeOn(r),o.toViewPosition(C._createBefore(e))),!0)}function ET(i,e,{preflight:t}={}){return t?e.test(i,"insert"):e.consume(i,"insert")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ef(i){const{schema:e,document:t}=i.model;for(const n of t.getRoots())if(n.isEmpty&&!e.checkChild(n,"$text")&&e.checkChild(n,"paragraph"))return i.insertElement("paragraph",n),!0;return!1}function Af(i,e,t){const n=t.createContext(i);return!(!t.checkChild(n,"paragraph")||!t.checkChild(n.push("paragraph"),e))}function xf(i,e){const t=e.createElement("paragraph");return e.insert(t,i),e.createPositionAt(t,0)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class AT extends mf{elementToElement(e){return this.add(If(e))}elementToAttribute(e){return this.add(IT(e))}attributeToAttribute(e){return this.add(PT(e))}elementToMarker(e){return this.add(RT(e))}dataToMarker(e){return this.add(MT(e))}}function Sf(){return(i,e,t)=>{if(!e.modelRange&&t.consumable.consume(e.viewItem,{name:!0})){const{modelRange:n,modelCursor:s}=t.convertChildren(e.viewItem,e.modelCursor);e.modelRange=n,e.modelCursor=s}}}function xT(){return(i,e,{schema:t,consumable:n,writer:s})=>{let o=e.modelCursor;if(!n.test(e.viewItem))return;if(!t.checkChild(o,"$text")){if(!Af(o,"$text",t)||e.viewItem.data.trim().length==0)return;const a=o.nodeBefore;o=xf(o,s),a&&a.is("element","$marker")&&(s.move(s.createRangeOn(a),o),o=s.createPositionAfter(a))}n.consume(e.viewItem);const r=s.createText(e.viewItem.data);s.insert(r,o),e.modelRange=s.createRange(o,o.getShiftedBy(r.offsetSize)),e.modelCursor=e.modelRange.end}}function ST(i,e){return(t,n)=>{const s=n.newSelection,o=[];for(const a of s.getRanges())o.push(e.toModelRange(a));const r=i.createSelection(o,{backward:s.isBackward});r.isEqual(i.document.selection)||i.change(a=>{a.setSelection(r)})}}function If(i){i=ot(i);const e=yl(i),t=vl(i.view),n=t?`element:${t}`:"element";return s=>{s.on(n,e,{priority:i.converterPriority||"normal"})}}function IT(i){i=ot(i),Pf(i);const e=Rf(i,!1),t=vl(i.view),n=t?`element:${t}`:"element";return s=>{s.on(n,e,{priority:i.converterPriority||"low"})}}function PT(i){i=ot(i);let e=null;(typeof i.view=="string"||i.view.key)&&(e=LT(i)),Pf(i,e);const t=Rf(i,!0);return n=>{n.on("element",t,{priority:i.converterPriority||"low"})}}function RT(i){const e=NT(i.model);return If({...i,model:e})}function MT(i){i=ot(i),i.model||(i.model=s=>s?i.view+":"+s:i.view);const e={view:i.view,model:i.model},t=yl(Mf(e,"start")),n=yl(Mf(e,"end"));return s=>{s.on(`element:${i.view}-start`,t,{priority:i.converterPriority||"normal"}),s.on(`element:${i.view}-end`,n,{priority:i.converterPriority||"normal"});const o=We.low,r=We.highest,a=We.get(i.converterPriority)/r;s.on("element",BT(e),{priority:o+a})}}function BT(i){return(e,t,n)=>{const s=`data-${i.view}`;if(!n.consumable.test(t.viewItem,{attributes:s+"-end-after"})&&!n.consumable.test(t.viewItem,{attributes:s+"-start-after"})&&!n.consumable.test(t.viewItem,{attributes:s+"-end-before"})&&!n.consumable.test(t.viewItem,{attributes:s+"-start-before"}))return;t.modelRange||Object.assign(t,n.convertChildren(t.viewItem,t.modelCursor)),n.consumable.consume(t.viewItem,{attributes:s+"-end-after"})&&o(t.modelRange.end,t.viewItem.getAttribute(s+"-end-after").split(",")),n.consumable.consume(t.viewItem,{attributes:s+"-start-after"})&&o(t.modelRange.end,t.viewItem.getAttribute(s+"-start-after").split(",")),n.consumable.consume(t.viewItem,{attributes:s+"-end-before"})&&o(t.modelRange.start,t.viewItem.getAttribute(s+"-end-before").split(",")),n.consumable.consume(t.viewItem,{attributes:s+"-start-before"})&&o(t.modelRange.start,t.viewItem.getAttribute(s+"-start-before").split(","));function o(r,a){for(const l of a){const c=i.model(l,n),u=n.writer.createElement("$marker",{"data-name":c});n.writer.insert(u,r),t.modelCursor.isEqual(r)?t.modelCursor=t.modelCursor.getShiftedBy(1):t.modelCursor=t.modelCursor._getTransformedByInsertion(r,1),t.modelRange=t.modelRange._getTransformedByInsertion(r,1)[0]}}}}function vl(i){return typeof i=="string"?i:typeof i=="object"&&typeof i.name=="string"?i.name:null}function yl(i){const e=new Ge(i.view);return(t,n,s)=>{const o=e.match(n.viewItem);if(!o)return;const r=o.match;if(r.name=!0,!s.consumable.test(n.viewItem,r))return;const a=OT(i.model,n.viewItem,s);a&&s.safeInsert(a,n.modelCursor)&&(s.consumable.consume(n.viewItem,r),s.convertChildren(n.viewItem,a),s.updateConversionResult(a,n))}}function OT(i,e,t){return i instanceof Function?i(e,t):t.writer.createElement(i)}function LT(i){typeof i.view=="string"&&(i.view={key:i.view});const e=i.view.key,t=typeof i.view.value>"u"?/[\s\S]*/:i.view.value;let n;return e=="class"||e=="style"?n={[e=="class"?"classes":"styles"]:t}:n={attributes:{[e]:t}},i.view.name&&(n.name=i.view.name),i.view=n,e}function Pf(i,e=null){const t=e===null?!0:o=>o.getAttribute(e),n=typeof i.model!="object"?i.model:i.model.key,s=typeof i.model!="object"||typeof i.model.value>"u"?t:i.model.value;i.model={key:n,value:s}}function Rf(i,e){const t=new Ge(i.view);return(n,s,o)=>{if(!s.modelRange&&e)return;const r=t.match(s.viewItem);if(!r||(VT(i.view,s.viewItem)?r.match.name=!0:delete r.match.name,!o.consumable.test(s.viewItem,r.match)))return;const a=i.model.key,l=typeof i.model.value=="function"?i.model.value(s.viewItem,o):i.model.value;if(l===null)return;s.modelRange||Object.assign(s,o.convertChildren(s.viewItem,s.modelCursor)),DT(s.modelRange,{key:a,value:l},e,o)&&(o.consumable.test(s.viewItem,{name:!0})&&(r.match.name=!0),o.consumable.consume(s.viewItem,r.match))}}function VT(i,e){const t=typeof i=="function"?i(e):i;return typeof t=="object"&&!vl(t)?!1:!t.classes&&!t.attributes&&!t.styles}function DT(i,e,t,n){let s=!1;for(const o of Array.from(i.getItems({shallow:t})))n.schema.checkAttribute(o,e.key)&&(s=!0,!o.hasAttribute(e.key)&&n.writer.setAttribute(e.key,e.value,o));return s}function NT(i){return(e,t)=>{const n=typeof i=="string"?i:i(e,t);return t.writer.createElement("$marker",{"data-name":n})}}function Mf(i,e){const t=(n,s)=>{const o=n.getAttribute("name"),r=i.model(o,s);return s.writer.createElement("$marker",{"data-name":r})};return{view:`${i.view}-${e}`,model:t}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function FT(i){i.document.registerPostFixer(e=>$T(e,i))}function $T(i,e){const t=e.document.selection,n=e.schema,s=[];let o=!1;for(const r of t.getRanges()){const a=Bf(r,n);a&&!a.isEqual(r)?(s.push(a),o=!0):s.push(r)}return o&&i.setSelection(WT(s),{backward:t.isBackward}),!1}function Bf(i,e){return i.isCollapsed?UT(i,e):zT(i,e)}function UT(i,e){const t=i.start,n=e.getNearestSelectionRange(t);if(!n){const o=t.getAncestors().reverse().find(r=>e.isObject(r));return o?v._createOn(o):null}if(!n.isCollapsed)return n;const s=n.start;return t.isEqual(s)?null:new v(s)}function zT(i,e){const{start:t,end:n}=i,s=e.checkChild(t,"$text"),o=e.checkChild(n,"$text"),r=e.getLimitElement(t),a=e.getLimitElement(n);if(r===a){if(s&&o)return null;if(HT(t,n,e)){const d=t.nodeAfter&&e.isSelectable(t.nodeAfter)?null:e.getNearestSelectionRange(t,"forward"),f=n.nodeBefore&&e.isSelectable(n.nodeBefore)?null:e.getNearestSelectionRange(n,"backward"),m=d?d.start:t,g=f?f.end:n;return new v(m,g)}}const l=r&&!r.is("rootElement"),c=a&&!a.is("rootElement");if(l||c){const u=t.nodeAfter&&n.nodeBefore&&t.nodeAfter.parent===n.nodeBefore.parent,d=l&&(!u||!Lf(t.nodeAfter,e)),h=c&&(!u||!Lf(n.nodeBefore,e));let f=t,m=n;return d&&(f=C._createBefore(Of(r,e))),h&&(m=C._createAfter(Of(a,e))),new v(f,m)}return null}function Of(i,e){let t=i,n=t;for(;e.isLimit(n)&&n.parent;)t=n,n=n.parent;return t}function HT(i,e,t){const n=i.nodeAfter&&!t.isLimit(i.nodeAfter)||t.checkChild(i,"$text"),s=e.nodeBefore&&!t.isLimit(e.nodeBefore)||t.checkChild(e,"$text");return n||s}function WT(i){const e=[...i],t=new Set;let n=1;for(;n<e.length;){const o=e[n],r=e.slice(0,n);for(const[a,l]of r.entries())if(!t.has(a)){if(o.isEqual(l))t.add(a);else if(o.isIntersecting(l)){t.add(a),t.add(n);const c=o.getJoined(l);e.push(c)}}n++}return e.filter((o,r)=>!t.has(r))}function Lf(i,e){return i&&e.isSelectable(i)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class jT extends re(){constructor(e,t){super(),this.model=e,this.view=new B3(t),this.mapper=new cf,this.downcastDispatcher=new uf({mapper:this.mapper,schema:e.schema});const n=this.model.document,s=n.selection,o=this.model.markers;this.listenTo(this.model,"_beforeChanges",()=>{this.view._disableRendering(!0)},{priority:"highest"}),this.listenTo(this.model,"_afterChanges",()=>{this.view._disableRendering(!1)},{priority:"lowest"}),this.listenTo(n,"change",()=>{this.view.change(r=>{this.downcastDispatcher.convertChanges(n.differ,o,r),this.downcastDispatcher.convertSelection(s,o,r)})},{priority:"low"}),this.listenTo(this.view.document,"selectionChange",ST(this.model,this.mapper)),this.listenTo(this.view.document,"beforeinput",qT(this.mapper,this.model.schema,this.view),{priority:"high"}),this.downcastDispatcher.on("insert:$text",gf(),{priority:"lowest"}),this.downcastDispatcher.on("insert",pf(),{priority:"lowest"}),this.downcastDispatcher.on("remove",Z3(),{priority:"low"}),this.downcastDispatcher.on("cleanSelection",X3()),this.downcastDispatcher.on("selection",J3(),{priority:"low"}),this.downcastDispatcher.on("selection",Y3(),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using(r=>{if(r.rootName=="$graveyard")return null;const a=new Nh(this.view.document,r.name);return a.rootName=r.rootName,this.mapper.bindElements(r,a),a})}destroy(){this.view.destroy(),this.stopListening()}reconvertMarker(e){const t=typeof e=="string"?e:e.name,n=this.model.markers.get(t);if(!n)throw new p("editingcontroller-reconvertmarker-marker-not-exist",this,{markerName:t});this.model.change(()=>{this.model.markers._refresh(n)})}reconvertItem(e){this.model.change(()=>{this.model.document.differ._refreshItem(e)})}}function qT(i,e,t){return(n,s)=>{if(!(t.document.isComposing&&!$.isAndroid))for(let o=0;o<s.targetRanges.length;o++){const r=s.targetRanges[o],a=i.toModelRange(r),l=Bf(a,e);!l||l.isEqual(a)||(s.targetRanges[o]=i.toViewRange(l))}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _s{constructor(){this._consumables=new Map}add(e,t){let n;if(e.is("$text")||e.is("documentFragment")){this._consumables.set(e,!0);return}this._consumables.has(e)?n=this._consumables.get(e):(n=new GT(e),this._consumables.set(e,n)),n.add(t)}test(e,t){const n=this._consumables.get(e);return n===void 0?null:e.is("$text")||e.is("documentFragment")?n:n.test(t)}consume(e,t){return this.test(e,t)?(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!1):this._consumables.get(e).consume(t),!0):!1}revert(e,t){const n=this._consumables.get(e);n!==void 0&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):n.revert(t))}static consumablesFromElement(e){const t={element:e,name:!0,attributes:[],classes:[],styles:[]},n=e.getAttributeKeys();for(const r of n)r=="style"||r=="class"||t.attributes.push(r);const s=e.getClassNames();for(const r of s)t.classes.push(r);const o=e.getStyleNames();for(const r of o)t.styles.push(r);return t}static createFrom(e,t){if(t||(t=new _s),e.is("$text"))return t.add(e),t;e.is("element")&&t.add(e,_s.consumablesFromElement(e)),e.is("documentFragment")&&t.add(e);for(const n of e.getChildren())t=_s.createFrom(n,t);return t}}const Wo=["attributes","classes","styles"];class GT{constructor(e){this.element=e,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(e){e.name&&(this._canConsumeName=!0);for(const t of Wo)t in e&&this._add(t,e[t])}test(e){if(e.name&&!this._canConsumeName)return this._canConsumeName;for(const t of Wo)if(t in e){const n=this._test(t,e[t]);if(n!==!0)return n}return!0}consume(e){e.name&&(this._canConsumeName=!1);for(const t of Wo)t in e&&this._consume(t,e[t])}revert(e){e.name&&(this._canConsumeName=!0);for(const t of Wo)t in e&&this._revert(t,e[t])}_add(e,t){const n=J(t),s=this._consumables[e];for(const o of n){if(e==="attributes"&&(o==="class"||o==="style"))throw new p("viewconsumable-invalid-attribute",this);if(s.set(o,!0),e==="styles")for(const r of this.element.document.stylesProcessor.getRelatedStyles(o))s.set(r,!0)}}_test(e,t){const n=J(t),s=this._consumables[e];for(const o of n)if(e==="attributes"&&(o==="class"||o==="style")){const r=o=="class"?"classes":"styles",a=this._test(r,[...this._consumables[r].keys()]);if(a!==!0)return a}else{const r=s.get(o);if(r===void 0)return null;if(!r)return!1}return!0}_consume(e,t){const n=J(t),s=this._consumables[e];for(const o of n)if(e==="attributes"&&(o==="class"||o==="style")){const r=o=="class"?"classes":"styles";this._consume(r,[...this._consumables[r].keys()])}else if(s.set(o,!1),e=="styles")for(const r of this.element.document.stylesProcessor.getRelatedStyles(o))s.set(r,!1)}_revert(e,t){const n=J(t),s=this._consumables[e];for(const o of n)if(e==="attributes"&&(o==="class"||o==="style")){const r=o=="class"?"classes":"styles";this._revert(r,[...this._consumables[r].keys()])}else s.get(o)===!1&&s.set(o,!0)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class KT extends re(){constructor(){super(),this._sourceDefinitions={},this._attributeProperties={},this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",(e,t)=>{t[0]=new Bn(t[0])},{priority:"highest"}),this.on("checkChild",(e,t)=>{t[0]=new Bn(t[0]),t[1]=this.getDefinition(t[1])},{priority:"highest"})}register(e,t){if(this._sourceDefinitions[e])throw new p("schema-cannot-register-item-twice",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},t)],this._clearCache()}extend(e,t){if(!this._sourceDefinitions[e])throw new p("schema-cannot-extend-missing-item",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},t)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let t;return typeof e=="string"?t=e:"is"in e&&(e.is("$text")||e.is("$textProxy"))?t="$text":t=e.name,this.getDefinitions()[t]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const t=this.getDefinition(e);return!!(t&&t.isBlock)}isLimit(e){const t=this.getDefinition(e);return t?!!(t.isLimit||t.isObject):!1}isObject(e){const t=this.getDefinition(e);return t?!!(t.isObject||t.isLimit&&t.isSelectable&&t.isContent):!1}isInline(e){const t=this.getDefinition(e);return!!(t&&t.isInline)}isSelectable(e){const t=this.getDefinition(e);return t?!!(t.isSelectable||t.isObject):!1}isContent(e){const t=this.getDefinition(e);return t?!!(t.isContent||t.isObject):!1}checkChild(e,t){return t?this._checkContextMatch(t,e):!1}checkAttribute(e,t){const n=this.getDefinition(e.last);return n?n.allowAttributes.includes(t):!1}checkMerge(e,t){if(e instanceof C){const n=e.nodeBefore,s=e.nodeAfter;if(!(n instanceof Y))throw new p("schema-check-merge-no-element-before",this);if(!(s instanceof Y))throw new p("schema-check-merge-no-element-after",this);return this.checkMerge(n,s)}for(const n of t.getChildren())if(!this.checkChild(e,n))return!1;return!0}addChildCheck(e){this.on("checkChild",(t,[n,s])=>{if(!s)return;const o=e(n,s);typeof o=="boolean"&&(t.stop(),t.return=o)},{priority:"high"})}addAttributeCheck(e){this.on("checkAttribute",(t,[n,s])=>{const o=e(n,s);typeof o=="boolean"&&(t.stop(),t.return=o)},{priority:"high"})}setAttributeProperties(e,t){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),t)}getAttributeProperties(e){return this._attributeProperties[e]||{}}getLimitElement(e){let t;for(e instanceof C?t=e.parent:t=(e instanceof v?[e]:Array.from(e.getRanges())).reduce((s,o)=>{const r=o.getCommonAncestor();return s?s.getCommonAncestor(r,{includeSelf:!0}):r},null);!this.isLimit(t)&&t.parent;)t=t.parent;return t}checkAttributeInSelection(e,t){if(e.isCollapsed){const s=[...e.getFirstPosition().getAncestors(),new te("",e.getAttributes())];return this.checkAttribute(s,t)}else{const n=e.getRanges();for(const s of n)for(const o of s)if(this.checkAttribute(o.item,t))return!0}return!1}*getValidRanges(e,t){e=uE(e);for(const n of e)yield*this._getValidRangesForRange(n,t)}getNearestSelectionRange(e,t="both"){if(e.root.rootName=="$graveyard")return null;if(this.checkChild(e,"$text"))return new v(e);let n,s;const o=e.getAncestors().reverse().find(r=>this.isLimit(r))||e.root;(t=="both"||t=="backward")&&(n=new Kt({boundaries:v._createIn(o),startPosition:e,direction:"backward"})),(t=="both"||t=="forward")&&(s=new Kt({boundaries:v._createIn(o),startPosition:e}));for(const r of cE(n,s)){const a=r.walker==n?"elementEnd":"elementStart",l=r.value;if(l.type==a&&this.isObject(l.item))return v._createOn(l.item);if(this.checkChild(l.nextPosition,"$text"))return new v(l.nextPosition)}return null}findAllowedParent(e,t){let n=e.parent;for(;n;){if(this.checkChild(n,t))return n;if(this.isLimit(n))return null;n=n.parent}return null}setAllowedAttributes(e,t,n){const s=n.model;for(const[o,r]of Object.entries(t))s.schema.checkAttribute(e,o)&&n.setAttribute(o,r,e)}removeDisallowedAttributes(e,t){for(const n of e)if(n.is("$text"))Vf(this,n,t);else{const o=v._createIn(n).getPositions();for(const r of o){const a=r.nodeBefore||r.parent;Vf(this,a,t)}}}getAttributesWithProperty(e,t,n){const s={};for(const[o,r]of e.getAttributes()){const a=this.getAttributeProperties(o);a[t]!==void 0&&(n===void 0||n===a[t])&&(s[o]=r)}return s}createContext(e){return new Bn(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},t=this._sourceDefinitions,n=Object.keys(t);for(const s of n)e[s]=ZT(t[s],s);for(const s of n)JT(e,s);for(const s of n)YT(e,s);for(const s of n)XT(e,s);for(const s of n)QT(e,s),eE(e,s);for(const s of n)tE(e,s),nE(e,s),iE(e,s);this._compiledDefinitions=e}_checkContextMatch(e,t,n=t.length-1){const s=t.getItem(n);if(e.allowIn.includes(s.name)){if(n==0)return!0;{const o=this.getDefinition(s);return this._checkContextMatch(o,t,n-1)}}else return!1}*_getValidRangesForRange(e,t){let n=e.start,s=e.start;for(const o of e.getItems({shallow:!0}))o.is("element")&&(yield*this._getValidRangesForRange(v._createIn(o),t)),this.checkAttribute(o,t)||(n.isEqual(s)||(yield new v(n,s)),n=C._createAfter(o)),s=C._createAfter(o);n.isEqual(s)||(yield new v(n,s))}findOptimalInsertionRange(e,t){const n=e.getSelectedElement();if(n&&this.isObject(n)&&!this.isInline(n))return t=="before"||t=="after"?new v(C._createAt(n,t)):v._createOn(n);const s=ce(e.getSelectedBlocks());if(!s)return new v(e.focus);if(s.isEmpty)return new v(C._createAt(s,0));const o=C._createAfter(s);return e.focus.isTouching(o)?new v(o):new v(C._createBefore(s))}}class Bn{constructor(e){if(e instanceof Bn)return e;let t;typeof e=="string"?t=[e]:Array.isArray(e)?t=e:t=e.getAncestors({includeSelf:!0}),this._items=t.map(lE)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(e){const t=new Bn([e]);return t._items=[...this._items,...t._items],t}getItem(e){return this._items[e]}*getNames(){yield*this._items.map(e=>e.name)}endsWith(e){return Array.from(this.getNames()).join(" ").endsWith(e)}startsWith(e){return Array.from(this.getNames()).join(" ").startsWith(e)}}function ZT(i,e){const t={name:e,allowIn:[],allowContentOf:[],allowWhere:[],allowAttributes:[],allowAttributesOf:[],allowChildren:[],inheritTypesFrom:[]};return sE(i,t),On(i,t,"allowIn"),On(i,t,"allowContentOf"),On(i,t,"allowWhere"),On(i,t,"allowAttributes"),On(i,t,"allowAttributesOf"),On(i,t,"allowChildren"),On(i,t,"inheritTypesFrom"),oE(i,t),t}function JT(i,e){const t=i[e];for(const n of t.allowChildren){const s=i[n];s&&s.allowIn.push(e)}t.allowChildren.length=0}function YT(i,e){for(const t of i[e].allowContentOf)i[t]&&rE(i,t).forEach(s=>{s.allowIn.push(e)});delete i[e].allowContentOf}function XT(i,e){for(const t of i[e].allowWhere){const n=i[t];if(n){const s=n.allowIn;i[e].allowIn.push(...s)}}delete i[e].allowWhere}function QT(i,e){for(const t of i[e].allowAttributesOf){const n=i[t];if(n){const s=n.allowAttributes;i[e].allowAttributes.push(...s)}}delete i[e].allowAttributesOf}function eE(i,e){const t=i[e];for(const n of t.inheritTypesFrom){const s=i[n];if(s){const o=Object.keys(s).filter(r=>r.startsWith("is"));for(const r of o)r in t||(t[r]=s[r])}}delete t.inheritTypesFrom}function tE(i,e){const t=i[e],n=t.allowIn.filter(s=>i[s]);t.allowIn=Array.from(new Set(n))}function nE(i,e){const t=i[e];for(const n of t.allowIn)i[n].allowChildren.push(e)}function iE(i,e){const t=i[e];t.allowAttributes=Array.from(new Set(t.allowAttributes))}function sE(i,e){for(const t of i){const n=Object.keys(t).filter(s=>s.startsWith("is"));for(const s of n)e[s]=!!t[s]}}function On(i,e,t){for(const n of i){const s=n[t];typeof s=="string"?e[t].push(s):Array.isArray(s)&&e[t].push(...s)}}function oE(i,e){for(const t of i){const n=t.inheritAllFrom;n&&(e.allowContentOf.push(n),e.allowWhere.push(n),e.allowAttributesOf.push(n),e.inheritTypesFrom.push(n))}}function rE(i,e){const t=i[e];return aE(i).filter(n=>n.allowIn.includes(t.name))}function aE(i){return Object.keys(i).map(e=>i[e])}function lE(i){return typeof i=="string"||i.is("documentFragment")?{name:typeof i=="string"?i:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:i.is("element")?i.name:"$text",*getAttributeKeys(){yield*i.getAttributeKeys()},getAttribute(e){return i.getAttribute(e)}}}function*cE(i,e){let t=!1;for(;!t;){if(t=!0,i){const n=i.next();n.done||(t=!1,yield{walker:i,value:n.value})}if(e){const n=e.next();n.done||(t=!1,yield{walker:e,value:n.value})}}}function*uE(i){for(const e of i)yield*e.getMinimalFlatRanges()}function Vf(i,e,t){for(const n of e.getAttributeKeys())i.checkAttribute(e,n)||t.removeAttribute(n,e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class dE extends ee(){constructor(e){super(),this._splitParts=new Map,this._cursorParents=new Map,this._modelCursor=null,this._emptyElementsToKeep=new Set,this.conversionApi={...e,consumable:null,writer:null,store:null,convertItem:(t,n)=>this._convertItem(t,n),convertChildren:(t,n)=>this._convertChildren(t,n),safeInsert:(t,n)=>this._safeInsert(t,n),updateConversionResult:(t,n)=>this._updateConversionResult(t,n),splitToAllowedParent:(t,n)=>this._splitToAllowedParent(t,n),getSplitParts:t=>this._getSplitParts(t),keepEmptyElement:t=>this._keepEmptyElement(t)}}convert(e,t,n=["$root"]){this.fire("viewCleanup",e),this._modelCursor=fE(n,t),this.conversionApi.writer=t,this.conversionApi.consumable=_s.createFrom(e),this.conversionApi.store={};const{modelRange:s}=this._convertItem(e,this._modelCursor),o=t.createDocumentFragment();if(s){this._removeEmptyElements();for(const r of Array.from(this._modelCursor.parent.getChildren()))t.append(r,o);o.markers=hE(o,t)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this._emptyElementsToKeep.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,o}_convertItem(e,t){const n={viewItem:e,modelCursor:t,modelRange:null};if(e.is("element")?this.fire(`element:${e.name}`,n,this.conversionApi):e.is("$text")?this.fire("text",n,this.conversionApi):this.fire("documentFragment",n,this.conversionApi),n.modelRange&&!(n.modelRange instanceof v))throw new p("view-conversion-dispatcher-incorrect-result",this);return{modelRange:n.modelRange,modelCursor:n.modelCursor}}_convertChildren(e,t){let n=t.is("position")?t:C._createAt(t,0);const s=new v(n);for(const o of Array.from(e.getChildren())){const r=this._convertItem(o,n);r.modelRange instanceof v&&(s.end=r.modelRange.end,n=r.modelCursor)}return{modelRange:s,modelCursor:n}}_safeInsert(e,t){const n=this._splitToAllowedParent(e,t);return n?(this.conversionApi.writer.insert(e,n.position),!0):!1}_updateConversionResult(e,t){const n=this._getSplitParts(e),s=this.conversionApi.writer;t.modelRange||(t.modelRange=s.createRange(s.createPositionBefore(e),s.createPositionAfter(n[n.length-1])));const o=this._cursorParents.get(e);o?t.modelCursor=s.createPositionAt(o,0):t.modelCursor=t.modelRange.end}_splitToAllowedParent(e,t){const{schema:n,writer:s}=this.conversionApi;let o=n.findAllowedParent(t,e);if(o){if(o===t.parent)return{position:t};this._modelCursor.parent.getAncestors().includes(o)&&(o=null)}if(!o)return Af(t,e,n)?{position:xf(t,s)}:null;const r=this.conversionApi.writer.split(t,o),a=[];for(const c of r.range.getWalker())if(c.type=="elementEnd")a.push(c.item);else{const u=a.pop(),d=c.item;this._registerSplitPair(u,d)}const l=r.range.end.parent;return this._cursorParents.set(e,l),{position:r.position,cursorParent:l}}_registerSplitPair(e,t){this._splitParts.has(e)||this._splitParts.set(e,[e]);const n=this._splitParts.get(e);this._splitParts.set(t,n),n.push(t)}_getSplitParts(e){let t;return this._splitParts.has(e)?t=this._splitParts.get(e):t=[e],t}_keepEmptyElement(e){this._emptyElementsToKeep.add(e)}_removeEmptyElements(){let e=!1;for(const t of this._splitParts.keys())t.isEmpty&&!this._emptyElementsToKeep.has(t)&&(this.conversionApi.writer.remove(t),this._splitParts.delete(t),e=!0);e&&this._removeEmptyElements()}}function hE(i,e){const t=new Set,n=new Map,s=v._createIn(i).getItems();for(const o of s)o.is("element","$marker")&&t.add(o);for(const o of t){const r=o.getAttribute("data-name"),a=e.createPositionBefore(o);n.has(r)?n.get(r).end=a.clone():n.set(r,new v(a.clone())),e.remove(o)}return n}function fE(i,e){let t;for(const n of new Bn(i)){const s={};for(const r of n.getAttributeKeys())s[r]=n.getAttribute(r);const o=e.createElement(n.name,s);t&&e.insert(o,t),t=C._createAt(o,0)}return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class mE{getHtml(e){const n=I.document.implementation.createHTMLDocument("").createElement("div");return n.appendChild(e),n.innerHTML}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class gE{constructor(e){this.skipComments=!0,this.domParser=new DOMParser,this.domConverter=new Uo(e,{renderingMode:"data"}),this.htmlWriter=new mE}toData(e){const t=this.domConverter.viewToDom(e);return this.htmlWriter.getHtml(t)}toView(e){const t=this._toDom(e);return this.domConverter.domToView(t,{skipComments:this.skipComments})}registerRawContentMatcher(e){this.domConverter.registerRawContentMatcher(e)}useFillerType(e){this.domConverter.blockFillerMode=e=="marked"?"markedNbsp":"nbsp"}_toDom(e){e.match(/<(?:html|body|head|meta)(?:\s[^>]*)?>/i)||(e=`<body>${e}</body>`);const t=this.domParser.parseFromString(e,"text/html"),n=t.createDocumentFragment(),s=t.body.childNodes;for(;s.length>0;)n.appendChild(s[0]);return n}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class pE extends ee(){constructor(e,t){super(),this.model=e,this.mapper=new cf,this.downcastDispatcher=new uf({mapper:this.mapper,schema:e.schema}),this.downcastDispatcher.on("insert:$text",gf(),{priority:"lowest"}),this.downcastDispatcher.on("insert",pf(),{priority:"lowest"}),this.upcastDispatcher=new dE({schema:e.schema}),this.viewDocument=new No(t),this.stylesProcessor=t,this.htmlProcessor=new gE(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new Uh(this.viewDocument),this.upcastDispatcher.on("text",xT(),{priority:"lowest"}),this.upcastDispatcher.on("element",Sf(),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",Sf(),{priority:"lowest"}),re().prototype.decorate.call(this,"init"),re().prototype.decorate.call(this,"set"),re().prototype.decorate.call(this,"get"),re().prototype.decorate.call(this,"toView"),re().prototype.decorate.call(this,"toModel"),this.on("init",()=>{this.fire("ready")},{priority:"lowest"}),this.on("ready",()=>{this.model.enqueueChange({isUndoable:!1},Ef)},{priority:"lowest"})}get(e={}){const{rootName:t="main",trim:n="empty"}=e;if(!this._checkIfRootsExists([t]))throw new p("datacontroller-get-non-existent-root",this);const s=this.model.document.getRoot(t);return s.isAttached()||Q("datacontroller-get-detached-root",this),n==="empty"&&!this.model.hasContent(s,{ignoreWhitespaces:!0})?"":this.stringify(s,e)}stringify(e,t={}){const n=this.toView(e,t);return this.processor.toData(n)}toView(e,t={}){const n=this.viewDocument,s=this._viewWriter;this.mapper.clearBindings();const o=v._createIn(e),r=new Pn(n);this.mapper.bindElements(e,r);const a=e.is("documentFragment")?e.markers:bE(e);return this.downcastDispatcher.convert(o,a,s,t),r}init(e){if(this.model.document.version)throw new p("datacontroller-init-document-not-empty",this);let t={};if(typeof e=="string"?t.main=e:t=e,!this._checkIfRootsExists(Object.keys(t)))throw new p("datacontroller-init-non-existent-root",this);return this.model.enqueueChange({isUndoable:!1},n=>{for(const s of Object.keys(t)){const o=this.model.document.getRoot(s);n.insert(this.parse(t[s],o),o,0)}}),Promise.resolve()}set(e,t={}){let n={};if(typeof e=="string"?n.main=e:n=e,!this._checkIfRootsExists(Object.keys(n)))throw new p("datacontroller-set-non-existent-root",this);this.model.enqueueChange(t.batchType||{},s=>{s.setSelection(null),s.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const o of Object.keys(n)){const r=this.model.document.getRoot(o);s.remove(s.createRangeIn(r)),s.insert(this.parse(n[o],r),r,0)}})}parse(e,t="$root"){const n=this.processor.toView(e);return this.toModel(n,t)}toModel(e,t="$root"){return this.model.change(n=>this.upcastDispatcher.convert(e,n,t))}addStyleProcessorRules(e){e(this.stylesProcessor)}registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const t of e)if(!this.model.document.getRoot(t))return!1;return!0}}function bE(i){const e=[],t=i.root.document;if(!t)return new Map;const n=v._createIn(i);for(const s of t.model.markers){const o=s.getRange(),r=o.isCollapsed,a=o.start.isEqual(n.start)||o.end.isEqual(n.end);if(r&&a)e.push([s.name,o]);else{const l=n.getIntersection(o);l&&e.push([s.name,l])}}return e.sort(([s,o],[r,a])=>{if(o.end.compareWith(a.start)!=="after")return 1;if(o.start.compareWith(a.end)!=="before")return-1;switch(o.start.compareWith(a.start)){case"before":return 1;case"after":return-1;default:switch(o.end.compareWith(a.end)){case"before":return 1;case"after":return-1;default:return r.localeCompare(s)}}}),new Map(e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class wE{constructor(e,t){this._helpers=new Map,this._downcast=J(e),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=J(t),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(e,t){const n=this._downcast.includes(t);if(!this._upcast.includes(t)&&!n)throw new p("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:e,dispatchers:[t],isDowncast:n})}for(e){if(!this._helpers.has(e))throw new p("conversion-for-unknown-group",this);return this._helpers.get(e)}elementToElement(e){this.for("downcast").elementToElement(e);for(const{model:t,view:n}of Cl(e))this.for("upcast").elementToElement({model:t,view:n,converterPriority:e.converterPriority})}attributeToElement(e){this.for("downcast").attributeToElement(e);for(const{model:t,view:n}of Cl(e))this.for("upcast").elementToAttribute({view:n,model:t,converterPriority:e.converterPriority})}attributeToAttribute(e){this.for("downcast").attributeToAttribute(e);for(const{model:t,view:n}of Cl(e))this.for("upcast").attributeToAttribute({view:n,model:t})}_createConversionHelpers({name:e,dispatchers:t,isDowncast:n}){if(this._helpers.has(e))throw new p("conversion-group-exists",this);const s=n?new K3(t):new AT(t);this._helpers.set(e,s)}}function*Cl(i){if(i.model.values)for(const e of i.model.values){const t={key:i.model.key,value:e},n=i.view[e],s=i.upcastAlso?i.upcastAlso[e]:void 0;yield*Df(t,n,s)}else yield*Df(i.model,i.view,i.upcastAlso)}function*Df(i,e,t){if(yield{model:i,view:e},t)for(const n of J(t))yield{model:i,view:n}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Je{constructor(e){this.baseVersion=e,this.isDocumentOperation=this.baseVersion!==null,this.batch=null}_validate(){}toJSON(){const e=Object.assign({},this);return e.__className=this.constructor.className,delete e.batch,delete e.isDocumentOperation,e}static get className(){return"Operation"}static fromJSON(e,t){return new this(e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function kl(i,e){const t=Ff(e),n=t.reduce((r,a)=>r+a.offsetSize,0),s=i.parent;Cs(i);const o=i.index;return s._insertChild(o,t),ys(s,o+t.length),ys(s,o),new v(i,i.getShiftedBy(n))}function Nf(i){if(!i.isFlat)throw new p("operation-utils-remove-range-not-flat",this);const e=i.start.parent;Cs(i.start),Cs(i.end);const t=e._removeChildren(i.start.index,i.end.index-i.start.index);return ys(e,i.start.index),t}function vs(i,e){if(!i.isFlat)throw new p("operation-utils-move-range-not-flat",this);const t=Nf(i);return e=e._getTransformedByDeletion(i.start,i.end.offset-i.start.offset),kl(e,t)}function _E(i,e,t){Cs(i.start),Cs(i.end);for(const n of i.getItems({shallow:!0})){const s=n.is("$textProxy")?n.textNode:n;t!==null?s._setAttribute(e,t):s._removeAttribute(e),ys(s.parent,s.index)}ys(i.end.parent,i.end.index)}function Ff(i){const e=[];function t(n){if(typeof n=="string")e.push(new te(n));else if(n instanceof Ct)e.push(new te(n.data,n.getAttributes()));else if(n instanceof Rn)e.push(n);else if(je(n))for(const s of n)t(s)}t(i);for(let n=1;n<e.length;n++){const s=e[n],o=e[n-1];s instanceof te&&o instanceof te&&$f(s,o)&&(e.splice(n-1,2,new te(o.data+s.data,o.getAttributes())),n--)}return e}function ys(i,e){const t=i.getChild(e-1),n=i.getChild(e);if(t&&n&&t.is("$text")&&n.is("$text")&&$f(t,n)){const s=new te(t.data+n.data,t.getAttributes());i._removeChildren(e-1,2),i._insertChild(e-1,s)}}function Cs(i){const e=i.textNode,t=i.parent;if(e){const n=i.offset-e.startOffset,s=e.index;t._removeChildren(s,1);const o=new te(e.data.substr(0,n),e.getAttributes()),r=new te(e.data.substr(n),e.getAttributes());t._insertChild(s,[o,r])}}function $f(i,e){const t=i.getAttributes(),n=e.getAttributes();for(const s of t){if(s[1]!==e.getAttribute(s[0]))return!1;n.next()}return n.next().done}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class G extends Je{constructor(e,t,n,s){super(s),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toNext",this.howMany=t,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNone"}get type(){return this.targetPosition.root.rootName=="$graveyard"?"remove":this.sourcePosition.root.rootName=="$graveyard"?"reinsert":"move"}get affectedSelectable(){return[v._createFromPositionAndShift(this.sourcePosition,this.howMany),v._createFromPositionAndShift(this.targetPosition,0)]}clone(){return new G(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new G(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent,n=this.sourcePosition.offset,s=this.targetPosition.offset;if(n+this.howMany>e.maxOffset)throw new p("move-operation-nodes-do-not-exist",this);if(e===t&&n<s&&s<n+this.howMany)throw new p("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&Be(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())=="prefix"){const o=this.sourcePosition.path.length-1;if(this.targetPosition.path[o]>=n&&this.targetPosition.path[o]<n+this.howMany)throw new p("move-operation-node-into-itself",this)}}_execute(){vs(v._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e}static get className(){return"MoveOperation"}static fromJSON(e,t){const n=C.fromJSON(e.sourcePosition,t),s=C.fromJSON(e.targetPosition,t);return new this(n,e.howMany,s,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ve extends Je{constructor(e,t,n){super(n),this.position=e.clone(),this.position.stickiness="toNone",this.nodes=new ms(Ff(t)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}get affectedSelectable(){return this.position.clone()}clone(){const e=new ms([...this.nodes].map(n=>n._clone(!0))),t=new ve(this.position,e,this.baseVersion);return t.shouldReceiveAttributes=this.shouldReceiveAttributes,t}getReversed(){const e=this.position.root.document.graveyard,t=new C(e,[0]);return new G(this.position,this.nodes.maxOffset,t,this.baseVersion+1)}_validate(){const e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new p("insert-operation-position-invalid",this)}_execute(){const e=this.nodes;this.nodes=new ms([...e].map(t=>t._clone(!0))),kl(this.position,e)}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e}static get className(){return"InsertOperation"}static fromJSON(e,t){const n=[];for(const o of e.nodes)o.name?n.push(Y.fromJSON(o)):n.push(te.fromJSON(o));const s=new ve(C.fromJSON(e.position,t),n,e.baseVersion);return s.shouldReceiveAttributes=e.shouldReceiveAttributes,s}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ne extends Je{constructor(e,t,n,s,o){super(o),this.splitPosition=e.clone(),this.splitPosition.stickiness="toNext",this.howMany=t,this.insertionPosition=n,this.graveyardPosition=s?s.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const e=this.insertionPosition.path.slice();return e.push(0),new C(this.insertionPosition.root,e)}get movedRange(){const e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new v(this.splitPosition,e)}get affectedSelectable(){const e=[v._createFromPositionAndShift(this.splitPosition,0),v._createFromPositionAndShift(this.insertionPosition,0)];return this.graveyardPosition&&e.push(v._createFromPositionAndShift(this.graveyardPosition,0)),e}clone(){return new ne(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.splitPosition.root.document.graveyard,t=new C(e,[0]);return new ue(this.moveTargetPosition,this.howMany,this.splitPosition,t,this.baseVersion+1)}_validate(){const e=this.splitPosition.parent,t=this.splitPosition.offset;if(!e||e.maxOffset<t)throw new p("split-operation-position-invalid",this);if(e.parent){if(this.howMany!=e.maxOffset-this.splitPosition.offset)throw new p("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new p("split-operation-graveyard-position-invalid",this)}else throw new p("split-operation-split-in-root",this)}_execute(){const e=this.splitPosition.parent;if(this.graveyardPosition)vs(v._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const n=e._clone();kl(this.insertionPosition,n)}const t=new v(C._createAt(e,this.splitPosition.offset),C._createAt(e,e.maxOffset));vs(t,this.moveTargetPosition)}toJSON(){const e=super.toJSON();return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e}static get className(){return"SplitOperation"}static getInsertionPosition(e){const t=e.path.slice(0,-1);return t[t.length-1]++,new C(e.root,t,"toPrevious")}static fromJSON(e,t){const n=C.fromJSON(e.splitPosition,t),s=C.fromJSON(e.insertionPosition,t),o=e.graveyardPosition?C.fromJSON(e.graveyardPosition,t):null;return new this(n,e.howMany,s,o,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ue extends Je{constructor(e,t,n,s,o){super(o),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=t,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=s.clone()}get type(){return"merge"}get deletionPosition(){return new C(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new v(this.sourcePosition,e)}get affectedSelectable(){const e=this.sourcePosition.parent;return[v._createOn(e),v._createFromPositionAndShift(this.targetPosition,0),v._createFromPositionAndShift(this.graveyardPosition,0)]}clone(){return new ue(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.targetPosition._getTransformedByMergeOperation(this),t=this.sourcePosition.path.slice(0,-1),n=new C(this.sourcePosition.root,t)._getTransformedByMergeOperation(this);return new ne(e,this.howMany,n,this.graveyardPosition,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent;if(e.parent)if(t.parent){if(this.howMany!=e.maxOffset)throw new p("merge-operation-how-many-invalid",this)}else throw new p("merge-operation-target-position-invalid",this);else throw new p("merge-operation-source-position-invalid",this)}_execute(){const e=this.sourcePosition.parent,t=v._createIn(e);vs(t,this.targetPosition),vs(v._createOn(e),this.graveyardPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e}static get className(){return"MergeOperation"}static fromJSON(e,t){const n=C.fromJSON(e.sourcePosition,t),s=C.fromJSON(e.targetPosition,t),o=C.fromJSON(e.graveyardPosition,t);return new this(n,e.howMany,s,o,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ne extends Je{constructor(e,t,n,s,o,r){super(r),this.name=e,this.oldRange=t?t.clone():null,this.newRange=n?n.clone():null,this.affectsData=o,this._markers=s}get type(){return"marker"}get affectedSelectable(){const e=[];return this.oldRange&&e.push(this.oldRange.clone()),this.newRange&&(this.oldRange?e.push(...this.newRange.getDifference(this.oldRange)):e.push(this.newRange.clone())),e}clone(){return new Ne(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new Ne(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){this.newRange?this._markers._set(this.name,this.newRange,!0,this.affectsData):this._markers._remove(this.name)}toJSON(){const e=super.toJSON();return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e}static get className(){return"MarkerOperation"}static fromJSON(e,t){return new Ne(e.name,e.oldRange?v.fromJSON(e.oldRange,t):null,e.newRange?v.fromJSON(e.newRange,t):null,t.model.markers,e.affectsData,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class fe extends Je{constructor(e,t,n,s,o){super(o),this.range=e.clone(),this.key=t,this.oldValue=n===void 0?null:n,this.newValue=s===void 0?null:s}get type(){return this.oldValue===null?"addAttribute":this.newValue===null?"removeAttribute":"changeAttribute"}get affectedSelectable(){return this.range.clone()}clone(){return new fe(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new fe(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const e=super.toJSON();return e.range=this.range.toJSON(),e}_validate(){if(!this.range.isFlat)throw new p("attribute-operation-range-not-flat",this);for(const e of this.range.getItems({shallow:!0})){if(this.oldValue!==null&&!ci(e.getAttribute(this.key),this.oldValue))throw new p("attribute-operation-wrong-old-value",this,{item:e,key:this.key,value:this.oldValue});if(this.oldValue===null&&this.newValue!==null&&e.hasAttribute(this.key))throw new p("attribute-operation-attribute-exists",this,{node:e,key:this.key})}}_execute(){ci(this.oldValue,this.newValue)||_E(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(e,t){return new fe(v.fromJSON(e.range,t),e.key,e.oldValue,e.newValue,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class we extends Je{get type(){return"noop"}get affectedSelectable(){return null}clone(){return new we(this.baseVersion)}getReversed(){return new we(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Fe extends Je{constructor(e,t,n,s){super(s),this.position=e,this.position.stickiness="toNext",this.oldName=t,this.newName=n}get type(){return"rename"}get affectedSelectable(){return this.position.nodeAfter}clone(){return new Fe(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new Fe(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const e=this.position.nodeAfter;if(e instanceof Y){if(e.name!==this.oldName)throw new p("rename-operation-wrong-name",this)}else throw new p("rename-operation-wrong-position",this)}_execute(){const e=this.position.nodeAfter;e.name=this.newName}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e}static get className(){return"RenameOperation"}static fromJSON(e,t){return new Fe(C.fromJSON(e.position,t),e.oldName,e.newName,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Zt extends Je{constructor(e,t,n,s,o){super(o),this.root=e,this.key=t,this.oldValue=n===void 0?null:n,this.newValue=s===void 0?null:s}get type(){return this.oldValue===null?"addRootAttribute":this.newValue===null?"removeRootAttribute":"changeRootAttribute"}get affectedSelectable(){return this.root}clone(){return new Zt(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Zt(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new p("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(this.oldValue!==null&&this.root.getAttribute(this.key)!==this.oldValue)throw new p("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(this.oldValue===null&&this.newValue!==null&&this.root.hasAttribute(this.key))throw new p("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){this.newValue!==null?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const e=super.toJSON();return e.root=this.root.toJSON(),e}static get className(){return"RootAttributeOperation"}static fromJSON(e,t){if(!t.getRoot(e.root))throw new p("rootattribute-operation-fromjson-no-root",this,{rootName:e.root});return new Zt(t.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Rt extends Je{constructor(e,t,n,s,o){if(super(o),this.rootName=e,this.elementName=t,this.isAdd=n,this._document=s,!this._document.getRoot(this.rootName)){const r=this._document.createRoot(this.elementName,this.rootName);r._isAttached=!1}}get type(){return this.isAdd?"addRoot":"detachRoot"}get affectedSelectable(){return this._document.getRoot(this.rootName)}clone(){return new Rt(this.rootName,this.elementName,this.isAdd,this._document,this.baseVersion)}getReversed(){return new Rt(this.rootName,this.elementName,!this.isAdd,this._document,this.baseVersion+1)}_execute(){this._document.getRoot(this.rootName)._isAttached=this.isAdd}toJSON(){const e=super.toJSON();return delete e._document,e}static get className(){return"RootOperation"}static fromJSON(e,t){return new Rt(e.rootName,e.elementName,e.isAdd,t,e.baseVersion)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const at={};at[fe.className]=fe,at[ve.className]=ve,at[Ne.className]=Ne,at[G.className]=G,at[we.className]=we,at[Je.className]=Je,at[Fe.className]=Fe,at[Zt.className]=Zt,at[Rt.className]=Rt,at[ne.className]=ne,at[ue.className]=ue;class vE{static fromJSON(e,t){return at[e.__className].fromJSON(e,t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Tl=new Map;function q(i,e,t){let n=Tl.get(i);n||(n=new Map,Tl.set(i,n)),n.set(e,t)}function yE(i,e){const t=Tl.get(i);return t&&t.has(e)?t.get(e):CE}function CE(i){return[i]}function Uf(i,e,t={}){const n=yE(i.constructor,e.constructor);try{return i=i.clone(),n(i,e,t)}catch(s){throw s}}function kE(i,e,t){i=i.slice(),e=e.slice();const n=new TE(t.document,t.useRelations,t.forceWeakRemove);n.setOriginalOperations(i),n.setOriginalOperations(e);const s=n.originalOperations;if(i.length==0||e.length==0)return{operationsA:i,operationsB:e,originalOperations:s};const o=new WeakMap;for(const l of i)o.set(l,0);const r={nextBaseVersionA:i[i.length-1].baseVersion+1,nextBaseVersionB:e[e.length-1].baseVersion+1,originalOperationsACount:i.length,originalOperationsBCount:e.length};let a=0;for(;a<i.length;){const l=i[a],c=o.get(l);if(c==e.length){a++;continue}const u=e[c],d=Uf(l,u,n.getContext(l,u,!0)),h=Uf(u,l,n.getContext(u,l,!1));n.updateRelation(l,u),n.setOriginalOperations(d,l),n.setOriginalOperations(h,u);for(const f of d)o.set(f,c+h.length);i.splice(a,1,...d),e.splice(c,1,...h)}return zf(i,r.nextBaseVersionB),zf(e,r.nextBaseVersionA),{operationsA:i,operationsB:e,originalOperations:s}}class TE{constructor(e,t,n=!1){this.originalOperations=new Map,this._history=e.history,this._useRelations=t,this._forceWeakRemove=!!n,this._relations=new Map}setOriginalOperations(e,t=null){const n=t?this.originalOperations.get(t):null;for(const s of e)this.originalOperations.set(s,n||s)}updateRelation(e,t){if(e instanceof G)t instanceof ue?e.targetPosition.isEqual(t.sourcePosition)||t.movedRange.containsPosition(e.targetPosition)?this._setRelation(e,t,"insertAtSource"):e.targetPosition.isEqual(t.deletionPosition)?this._setRelation(e,t,"insertBetween"):e.targetPosition.isAfter(t.sourcePosition)&&this._setRelation(e,t,"moveTargetAfter"):t instanceof G&&(e.targetPosition.isEqual(t.sourcePosition)||e.targetPosition.isBefore(t.sourcePosition)?this._setRelation(e,t,"insertBefore"):this._setRelation(e,t,"insertAfter"));else if(e instanceof ne){if(t instanceof ue)e.splitPosition.isBefore(t.sourcePosition)&&this._setRelation(e,t,"splitBefore");else if(t instanceof G)if(e.splitPosition.isEqual(t.sourcePosition)||e.splitPosition.isBefore(t.sourcePosition))this._setRelation(e,t,"splitBefore");else{const n=v._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&n.containsPosition(e.splitPosition)){const s=n.end.offset-e.splitPosition.offset,o=e.splitPosition.offset-n.start.offset;this._setRelation(e,t,{howMany:s,offset:o})}}}else if(e instanceof ue)t instanceof ue?(e.targetPosition.isEqual(t.sourcePosition)||this._setRelation(e,t,"mergeTargetNotMoved"),e.sourcePosition.isEqual(t.targetPosition)&&this._setRelation(e,t,"mergeSourceNotMoved"),e.sourcePosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeSameElement")):t instanceof ne?e.sourcePosition.isEqual(t.splitPosition)&&this._setRelation(e,t,"splitAtSource"):t instanceof G&&t.howMany>0&&(e.sourcePosition.isEqual(t.sourcePosition.getShiftedBy(t.howMany))&&this._setRelation(e,t,"mergeSourceAffected"),e.targetPosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeTargetWasBefore"));else if(e instanceof Ne){const n=e.newRange;if(!n)return;if(t instanceof G){const s=v._createFromPositionAndShift(t.sourcePosition,t.howMany),o=s.containsPosition(n.start)||s.start.isEqual(n.start),r=s.containsPosition(n.end)||s.end.isEqual(n.end);(o||r)&&!s.containsRange(n)&&this._setRelation(e,t,{side:o?"left":"right",path:o?n.start.path.slice():n.end.path.slice()})}else if(t instanceof ue){const s=n.start.isEqual(t.targetPosition),o=n.start.isEqual(t.deletionPosition),r=n.end.isEqual(t.deletionPosition),a=n.end.isEqual(t.sourcePosition);(s||o||r||a)&&this._setRelation(e,t,{wasInLeftElement:s,wasStartBeforeMergedElement:o,wasEndBeforeMergedElement:r,wasInRightElement:a})}}}getContext(e,t,n){return{aIsStrong:n,aWasUndone:this._wasUndone(e),bWasUndone:this._wasUndone(t),abRelation:this._useRelations?this._getRelation(e,t):null,baRelation:this._useRelations?this._getRelation(t,e):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(e){const t=this.originalOperations.get(e);return t.wasUndone||this._history.isUndoneOperation(t)}_getRelation(e,t){const n=this.originalOperations.get(t),s=this._history.getUndoneOperation(n);if(!s)return null;const o=this.originalOperations.get(e),r=this._relations.get(o);return r&&r.get(s)||null}_setRelation(e,t,n){const s=this.originalOperations.get(e),o=this.originalOperations.get(t);let r=this._relations.get(s);r||(r=new Map,this._relations.set(s,r)),r.set(o,n)}}function zf(i,e){for(const t of i)t.baseVersion=e++}q(fe,fe,(i,e,t)=>{if(i.key===e.key&&i.range.start.hasSameParentAs(e.range.start)){const n=i.range.getDifference(e.range).map(o=>new fe(o,i.key,i.oldValue,i.newValue,0)),s=i.range.getIntersection(e.range);return s&&t.aIsStrong&&n.push(new fe(s,e.key,e.newValue,i.newValue,0)),n.length==0?[new we(0)]:n}else return[i]}),q(fe,ve,(i,e)=>{if(i.range.start.hasSameParentAs(e.position)&&i.range.containsPosition(e.position)){const n=i.range._getTransformedByInsertion(e.position,e.howMany,!e.shouldReceiveAttributes).map(s=>new fe(s,i.key,i.oldValue,i.newValue,i.baseVersion));if(e.shouldReceiveAttributes){const s=Hf(e,i.key,i.oldValue);s&&n.unshift(s)}return n}return i.range=i.range._getTransformedByInsertion(e.position,e.howMany,!1)[0],[i]});function Hf(i,e,t){const s=i.nodes.getNode(0).getAttribute(e);if(s==t)return null;const o=new v(i.position,i.position.getShiftedBy(i.howMany));return new fe(o,e,s,t,0)}q(fe,ue,(i,e)=>{const t=[];i.range.start.hasSameParentAs(e.deletionPosition)&&(i.range.containsPosition(e.deletionPosition)||i.range.start.isEqual(e.deletionPosition))&&t.push(v._createFromPositionAndShift(e.graveyardPosition,1));const n=i.range._getTransformedByMergeOperation(e);return n.isCollapsed||t.push(n),t.map(s=>new fe(s,i.key,i.oldValue,i.newValue,i.baseVersion))}),q(fe,G,(i,e)=>EE(i.range,e).map(n=>new fe(n,i.key,i.oldValue,i.newValue,i.baseVersion)));function EE(i,e){const t=v._createFromPositionAndShift(e.sourcePosition,e.howMany);let n=null,s=[];t.containsRange(i,!0)?n=i:i.start.hasSameParentAs(t.start)?(s=i.getDifference(t),n=i.getIntersection(t)):s=[i];const o=[];for(let r of s){r=r._getTransformedByDeletion(e.sourcePosition,e.howMany);const a=e.getMovedRangeStart(),l=r.start.hasSameParentAs(a),c=r._getTransformedByInsertion(a,e.howMany,l);o.push(...c)}return n&&o.push(n._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany,!1)[0]),o}q(fe,ne,(i,e)=>{if(i.range.end.isEqual(e.insertionPosition))return e.graveyardPosition||i.range.end.offset++,[i];if(i.range.start.hasSameParentAs(e.splitPosition)&&i.range.containsPosition(e.splitPosition)){const t=i.clone();return t.range=new v(e.moveTargetPosition.clone(),i.range.end._getCombined(e.splitPosition,e.moveTargetPosition)),i.range.end=e.splitPosition.clone(),i.range.end.stickiness="toPrevious",[i,t]}return i.range=i.range._getTransformedBySplitOperation(e),[i]}),q(ve,fe,(i,e)=>{const t=[i];if(i.shouldReceiveAttributes&&i.position.hasSameParentAs(e.range.start)&&e.range.containsPosition(i.position)){const n=Hf(i,e.key,e.newValue);n&&t.push(n)}return t}),q(ve,ve,(i,e,t)=>i.position.isEqual(e.position)&&t.aIsStrong?[i]:(i.position=i.position._getTransformedByInsertOperation(e),[i])),q(ve,G,(i,e)=>(i.position=i.position._getTransformedByMoveOperation(e),[i])),q(ve,ne,(i,e)=>(i.position=i.position._getTransformedBySplitOperation(e),[i])),q(ve,ue,(i,e)=>(i.position=i.position._getTransformedByMergeOperation(e),[i])),q(Ne,ve,(i,e)=>(i.oldRange&&(i.oldRange=i.oldRange._getTransformedByInsertOperation(e)[0]),i.newRange&&(i.newRange=i.newRange._getTransformedByInsertOperation(e)[0]),[i])),q(Ne,Ne,(i,e,t)=>{if(i.name==e.name)if(t.aIsStrong)i.oldRange=e.newRange?e.newRange.clone():null;else return[new we(0)];return[i]}),q(Ne,ue,(i,e)=>(i.oldRange&&(i.oldRange=i.oldRange._getTransformedByMergeOperation(e)),i.newRange&&(i.newRange=i.newRange._getTransformedByMergeOperation(e)),[i])),q(Ne,G,(i,e,t)=>{if(i.oldRange&&(i.oldRange=v._createFromRanges(i.oldRange._getTransformedByMoveOperation(e))),i.newRange){if(t.abRelation){const n=v._createFromRanges(i.newRange._getTransformedByMoveOperation(e));if(t.abRelation.side=="left"&&e.targetPosition.isEqual(i.newRange.start))return i.newRange.end=n.end,i.newRange.start.path=t.abRelation.path,[i];if(t.abRelation.side=="right"&&e.targetPosition.isEqual(i.newRange.end))return i.newRange.start=n.start,i.newRange.end.path=t.abRelation.path,[i]}i.newRange=v._createFromRanges(i.newRange._getTransformedByMoveOperation(e))}return[i]}),q(Ne,ne,(i,e,t)=>{if(i.oldRange&&(i.oldRange=i.oldRange._getTransformedBySplitOperation(e)),i.newRange){if(t.abRelation){const n=i.newRange._getTransformedBySplitOperation(e);return i.newRange.start.isEqual(e.splitPosition)&&t.abRelation.wasStartBeforeMergedElement?i.newRange.start=C._createAt(e.insertionPosition):i.newRange.start.isEqual(e.splitPosition)&&!t.abRelation.wasInLeftElement&&(i.newRange.start=C._createAt(e.moveTargetPosition)),i.newRange.end.isEqual(e.splitPosition)&&t.abRelation.wasInRightElement?i.newRange.end=C._createAt(e.moveTargetPosition):i.newRange.end.isEqual(e.splitPosition)&&t.abRelation.wasEndBeforeMergedElement?i.newRange.end=C._createAt(e.insertionPosition):i.newRange.end=n.end,[i]}i.newRange=i.newRange._getTransformedBySplitOperation(e)}return[i]}),q(ue,ve,(i,e)=>(i.sourcePosition.hasSameParentAs(e.position)&&(i.howMany+=e.howMany),i.sourcePosition=i.sourcePosition._getTransformedByInsertOperation(e),i.targetPosition=i.targetPosition._getTransformedByInsertOperation(e),[i])),q(ue,ue,(i,e,t)=>{if(i.sourcePosition.isEqual(e.sourcePosition)&&i.targetPosition.isEqual(e.targetPosition))if(t.bWasUndone){const n=e.graveyardPosition.path.slice();return n.push(0),i.sourcePosition=new C(e.graveyardPosition.root,n),i.howMany=0,[i]}else return[new we(0)];if(i.sourcePosition.isEqual(e.sourcePosition)&&!i.targetPosition.isEqual(e.targetPosition)&&!t.bWasUndone&&t.abRelation!="splitAtSource"){const n=i.targetPosition.root.rootName=="$graveyard",s=e.targetPosition.root.rootName=="$graveyard";if(s&&!n||!(n&&!s)&&t.aIsStrong){const l=e.targetPosition._getTransformedByMergeOperation(e),c=i.targetPosition._getTransformedByMergeOperation(e);return[new G(l,i.howMany,c,0)]}else return[new we(0)]}return i.sourcePosition.hasSameParentAs(e.targetPosition)&&(i.howMany+=e.howMany),i.sourcePosition=i.sourcePosition._getTransformedByMergeOperation(e),i.targetPosition=i.targetPosition._getTransformedByMergeOperation(e),(!i.graveyardPosition.isEqual(e.graveyardPosition)||!t.aIsStrong)&&(i.graveyardPosition=i.graveyardPosition._getTransformedByMergeOperation(e)),[i]}),q(ue,G,(i,e,t)=>{const n=v._createFromPositionAndShift(e.sourcePosition,e.howMany);return e.type=="remove"&&!t.bWasUndone&&!t.forceWeakRemove&&i.deletionPosition.hasSameParentAs(e.sourcePosition)&&n.containsPosition(i.sourcePosition)?[new we(0)]:(e.sourcePosition.getShiftedBy(e.howMany).isEqual(i.sourcePosition)?i.sourcePosition.stickiness="toNone":e.targetPosition.isEqual(i.sourcePosition)&&t.abRelation=="mergeSourceAffected"?i.sourcePosition.stickiness="toNext":e.sourcePosition.isEqual(i.targetPosition)?(i.targetPosition.stickiness="toNone",i.howMany-=e.howMany):e.targetPosition.isEqual(i.targetPosition)&&t.abRelation=="mergeTargetWasBefore"?(i.targetPosition.stickiness="toPrevious",i.howMany+=e.howMany):(i.sourcePosition.hasSameParentAs(e.targetPosition)&&(i.howMany+=e.howMany),i.sourcePosition.hasSameParentAs(e.sourcePosition)&&(i.howMany-=e.howMany)),i.sourcePosition=i.sourcePosition._getTransformedByMoveOperation(e),i.targetPosition=i.targetPosition._getTransformedByMoveOperation(e),i.sourcePosition.stickiness="toPrevious",i.targetPosition.stickiness="toNext",i.graveyardPosition.isEqual(e.targetPosition)||(i.graveyardPosition=i.graveyardPosition._getTransformedByMoveOperation(e)),[i])}),q(ue,ne,(i,e,t)=>{if(e.graveyardPosition&&(i.graveyardPosition=i.graveyardPosition._getTransformedByDeletion(e.graveyardPosition,1),i.deletionPosition.isEqual(e.graveyardPosition)&&(i.howMany=e.howMany)),i.targetPosition.isEqual(e.splitPosition)){const n=e.howMany!=0,s=e.graveyardPosition&&i.deletionPosition.isEqual(e.graveyardPosition);if(n||s||t.abRelation=="mergeTargetNotMoved")return i.sourcePosition=i.sourcePosition._getTransformedBySplitOperation(e),[i]}if(i.sourcePosition.isEqual(e.splitPosition)){if(t.abRelation=="mergeSourceNotMoved")return i.howMany=0,i.targetPosition=i.targetPosition._getTransformedBySplitOperation(e),[i];if(t.abRelation=="mergeSameElement"||i.sourcePosition.offset>0)return i.sourcePosition=e.moveTargetPosition.clone(),i.targetPosition=i.targetPosition._getTransformedBySplitOperation(e),[i]}return i.sourcePosition.hasSameParentAs(e.splitPosition)&&(i.howMany=e.splitPosition.offset),i.sourcePosition=i.sourcePosition._getTransformedBySplitOperation(e),i.targetPosition=i.targetPosition._getTransformedBySplitOperation(e),[i]}),q(G,ve,(i,e)=>{const n=v._createFromPositionAndShift(i.sourcePosition,i.howMany)._getTransformedByInsertOperation(e,!1)[0];return i.sourcePosition=n.start,i.howMany=n.end.offset-n.start.offset,i.targetPosition.isEqual(e.position)||(i.targetPosition=i.targetPosition._getTransformedByInsertOperation(e)),[i]}),q(G,G,(i,e,t)=>{const n=v._createFromPositionAndShift(i.sourcePosition,i.howMany),s=v._createFromPositionAndShift(e.sourcePosition,e.howMany);let o=t.aIsStrong,r=!t.aIsStrong;t.abRelation=="insertBefore"||t.baRelation=="insertAfter"?r=!0:(t.abRelation=="insertAfter"||t.baRelation=="insertBefore")&&(r=!1);let a;if(i.targetPosition.isEqual(e.targetPosition)&&r?a=i.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany):a=i.targetPosition._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),Wf(i,e)&&Wf(e,i))return[e.getReversed()];if(n.containsPosition(e.targetPosition)&&n.containsRange(s,!0))return n.start=n.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),n.end=n.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),bi([n],a);if(s.containsPosition(i.targetPosition)&&s.containsRange(n,!0))return n.start=n.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),n.end=n.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),bi([n],a);const u=Be(i.sourcePosition.getParentPath(),e.sourcePosition.getParentPath());if(u=="prefix"||u=="extension")return n.start=n.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),n.end=n.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),bi([n],a);i.type=="remove"&&e.type!="remove"&&!t.aWasUndone&&!t.forceWeakRemove?o=!0:i.type!="remove"&&e.type=="remove"&&!t.bWasUndone&&!t.forceWeakRemove&&(o=!1);const d=[],h=n.getDifference(s);for(const m of h){m.start=m.start._getTransformedByDeletion(e.sourcePosition,e.howMany),m.end=m.end._getTransformedByDeletion(e.sourcePosition,e.howMany);const g=Be(m.start.getParentPath(),e.getMovedRangeStart().getParentPath())=="same",b=m._getTransformedByInsertion(e.getMovedRangeStart(),e.howMany,g);d.push(...b)}const f=n.getIntersection(s);return f!==null&&o&&(f.start=f.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),f.end=f.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),d.length===0?d.push(f):d.length==1?s.start.isBefore(n.start)||s.start.isEqual(n.start)?d.unshift(f):d.push(f):d.splice(1,0,f)),d.length===0?[new we(i.baseVersion)]:bi(d,a)}),q(G,ne,(i,e,t)=>{let n=i.targetPosition.clone();(!i.targetPosition.isEqual(e.insertionPosition)||!e.graveyardPosition||t.abRelation=="moveTargetAfter")&&(n=i.targetPosition._getTransformedBySplitOperation(e));const s=v._createFromPositionAndShift(i.sourcePosition,i.howMany);if(s.end.isEqual(e.insertionPosition))return e.graveyardPosition||i.howMany++,i.targetPosition=n,[i];if(s.start.hasSameParentAs(e.splitPosition)&&s.containsPosition(e.splitPosition)){let a=new v(e.splitPosition,s.end);a=a._getTransformedBySplitOperation(e);const l=[new v(s.start,e.splitPosition),a];return bi(l,n)}i.targetPosition.isEqual(e.splitPosition)&&t.abRelation=="insertAtSource"&&(n=e.moveTargetPosition),i.targetPosition.isEqual(e.insertionPosition)&&t.abRelation=="insertBetween"&&(n=i.targetPosition);const r=[s._getTransformedBySplitOperation(e)];if(e.graveyardPosition){const a=s.start.isEqual(e.graveyardPosition)||s.containsPosition(e.graveyardPosition);i.howMany>1&&a&&!t.aWasUndone&&r.push(v._createFromPositionAndShift(e.insertionPosition,1))}return bi(r,n)}),q(G,ue,(i,e,t)=>{const n=v._createFromPositionAndShift(i.sourcePosition,i.howMany);if(e.deletionPosition.hasSameParentAs(i.sourcePosition)&&n.containsPosition(e.sourcePosition)){if(i.type=="remove"&&!t.forceWeakRemove){if(!t.aWasUndone){const r=[];let a=e.graveyardPosition.clone(),l=e.targetPosition._getTransformedByMergeOperation(e);i.howMany>1&&(r.push(new G(i.sourcePosition,i.howMany-1,i.targetPosition,0)),a=a._getTransformedByMove(i.sourcePosition,i.targetPosition,i.howMany-1),l=l._getTransformedByMove(i.sourcePosition,i.targetPosition,i.howMany-1));const c=e.deletionPosition._getCombined(i.sourcePosition,i.targetPosition),u=new G(a,1,c,0),d=u.getMovedRangeStart().path.slice();d.push(0);const h=new C(u.targetPosition.root,d);l=l._getTransformedByMove(a,c,1);const f=new G(l,e.howMany,h,0);return r.push(u),r.push(f),r}}else if(i.howMany==1)return t.bWasUndone?(i.sourcePosition=e.graveyardPosition.clone(),i.targetPosition=i.targetPosition._getTransformedByMergeOperation(e),[i]):[new we(0)]}const o=v._createFromPositionAndShift(i.sourcePosition,i.howMany)._getTransformedByMergeOperation(e);return i.sourcePosition=o.start,i.howMany=o.end.offset-o.start.offset,i.targetPosition=i.targetPosition._getTransformedByMergeOperation(e),[i]}),q(Fe,ve,(i,e)=>(i.position=i.position._getTransformedByInsertOperation(e),[i])),q(Fe,ue,(i,e)=>i.position.isEqual(e.deletionPosition)?(i.position=e.graveyardPosition.clone(),i.position.stickiness="toNext",[i]):(i.position=i.position._getTransformedByMergeOperation(e),[i])),q(Fe,G,(i,e)=>(i.position=i.position._getTransformedByMoveOperation(e),[i])),q(Fe,Fe,(i,e,t)=>{if(i.position.isEqual(e.position))if(t.aIsStrong)i.oldName=e.newName;else return[new we(0)];return[i]}),q(Fe,ne,(i,e)=>{const t=i.position.path,n=e.splitPosition.getParentPath();if(Be(t,n)=="same"&&!e.graveyardPosition){const s=new Fe(i.position.getShiftedBy(1),i.oldName,i.newName,0);return[i,s]}return i.position=i.position._getTransformedBySplitOperation(e),[i]}),q(Zt,Zt,(i,e,t)=>{if(i.root===e.root&&i.key===e.key){if(!t.aIsStrong||i.newValue===e.newValue)return[new we(0)];i.oldValue=e.newValue}return[i]}),q(Rt,Rt,(i,e)=>i.rootName===e.rootName&&i.isAdd===e.isAdd?[new we(0)]:[i]),q(ne,ve,(i,e)=>(i.splitPosition.hasSameParentAs(e.position)&&i.splitPosition.offset<e.position.offset&&(i.howMany+=e.howMany),i.splitPosition=i.splitPosition._getTransformedByInsertOperation(e),i.insertionPosition=i.insertionPosition._getTransformedByInsertOperation(e),[i])),q(ne,ue,(i,e,t)=>{if(!i.graveyardPosition&&!t.bWasUndone&&i.splitPosition.hasSameParentAs(e.sourcePosition)){const n=e.graveyardPosition.path.slice();n.push(0);const s=new C(e.graveyardPosition.root,n),o=ne.getInsertionPosition(new C(e.graveyardPosition.root,n)),r=new ne(s,0,o,null,0);return i.splitPosition=i.splitPosition._getTransformedByMergeOperation(e),i.insertionPosition=ne.getInsertionPosition(i.splitPosition),i.graveyardPosition=r.insertionPosition.clone(),i.graveyardPosition.stickiness="toNext",[r,i]}return i.splitPosition.hasSameParentAs(e.deletionPosition)&&!i.splitPosition.isAfter(e.deletionPosition)&&i.howMany--,i.splitPosition.hasSameParentAs(e.targetPosition)&&(i.howMany+=e.howMany),i.splitPosition=i.splitPosition._getTransformedByMergeOperation(e),i.insertionPosition=ne.getInsertionPosition(i.splitPosition),i.graveyardPosition&&(i.graveyardPosition=i.graveyardPosition._getTransformedByMergeOperation(e)),[i]}),q(ne,G,(i,e,t)=>{const n=v._createFromPositionAndShift(e.sourcePosition,e.howMany);if(i.graveyardPosition){const o=n.start.isEqual(i.graveyardPosition)||n.containsPosition(i.graveyardPosition);if(!t.bWasUndone&&o){const r=i.splitPosition._getTransformedByMoveOperation(e),a=i.graveyardPosition._getTransformedByMoveOperation(e),l=a.path.slice();l.push(0);const c=new C(a.root,l);return[new G(r,i.howMany,c,0)]}i.graveyardPosition=i.graveyardPosition._getTransformedByMoveOperation(e)}const s=i.splitPosition.isEqual(e.targetPosition);if(s&&(t.baRelation=="insertAtSource"||t.abRelation=="splitBefore"))return i.howMany+=e.howMany,i.splitPosition=i.splitPosition._getTransformedByDeletion(e.sourcePosition,e.howMany),i.insertionPosition=ne.getInsertionPosition(i.splitPosition),[i];if(s&&t.abRelation&&t.abRelation.howMany){const{howMany:o,offset:r}=t.abRelation;return i.howMany+=o,i.splitPosition=i.splitPosition.getShiftedBy(r),[i]}if(i.splitPosition.hasSameParentAs(e.sourcePosition)&&n.containsPosition(i.splitPosition)){const o=e.howMany-(i.splitPosition.offset-e.sourcePosition.offset);return i.howMany-=o,i.splitPosition.hasSameParentAs(e.targetPosition)&&i.splitPosition.offset<e.targetPosition.offset&&(i.howMany+=e.howMany),i.splitPosition=e.sourcePosition.clone(),i.insertionPosition=ne.getInsertionPosition(i.splitPosition),[i]}return e.sourcePosition.isEqual(e.targetPosition)||(i.splitPosition.hasSameParentAs(e.sourcePosition)&&i.splitPosition.offset<=e.sourcePosition.offset&&(i.howMany-=e.howMany),i.splitPosition.hasSameParentAs(e.targetPosition)&&i.splitPosition.offset<e.targetPosition.offset&&(i.howMany+=e.howMany)),i.splitPosition.stickiness="toNone",i.splitPosition=i.splitPosition._getTransformedByMoveOperation(e),i.splitPosition.stickiness="toNext",i.graveyardPosition?i.insertionPosition=i.insertionPosition._getTransformedByMoveOperation(e):i.insertionPosition=ne.getInsertionPosition(i.splitPosition),[i]}),q(ne,ne,(i,e,t)=>{if(i.splitPosition.isEqual(e.splitPosition)){if(!i.graveyardPosition&&!e.graveyardPosition)return[new we(0)];if(i.graveyardPosition&&e.graveyardPosition&&i.graveyardPosition.isEqual(e.graveyardPosition))return[new we(0)];if(t.abRelation=="splitBefore")return i.howMany=0,i.graveyardPosition=i.graveyardPosition._getTransformedBySplitOperation(e),[i]}if(i.graveyardPosition&&e.graveyardPosition&&i.graveyardPosition.isEqual(e.graveyardPosition)){const n=i.splitPosition.root.rootName=="$graveyard",s=e.splitPosition.root.rootName=="$graveyard";if(s&&!n||!(n&&!s)&&t.aIsStrong){const l=[];return e.howMany&&l.push(new G(e.moveTargetPosition,e.howMany,e.splitPosition,0)),i.howMany&&l.push(new G(i.splitPosition,i.howMany,i.moveTargetPosition,0)),l}else return[new we(0)]}if(i.graveyardPosition&&(i.graveyardPosition=i.graveyardPosition._getTransformedBySplitOperation(e)),i.splitPosition.isEqual(e.insertionPosition)&&t.abRelation=="splitBefore")return i.howMany++,[i];if(e.splitPosition.isEqual(i.insertionPosition)&&t.baRelation=="splitBefore"){const n=e.insertionPosition.path.slice();n.push(0);const s=new C(e.insertionPosition.root,n),o=new G(i.insertionPosition,1,s,0);return[i,o]}return i.splitPosition.hasSameParentAs(e.splitPosition)&&i.splitPosition.offset<e.splitPosition.offset&&(i.howMany-=e.howMany),i.splitPosition=i.splitPosition._getTransformedBySplitOperation(e),i.insertionPosition=ne.getInsertionPosition(i.splitPosition),[i]});function Wf(i,e){return i.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany)===null}function bi(i,e){const t=[];for(let n=0;n<i.length;n++){const s=i[n],o=new G(s.start,s.end.offset-s.start.offset,e,0);t.push(o);for(let r=n+1;r<i.length;r++)i[r]=i[r]._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)[0];e=e._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)}return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $e extends ee(C){constructor(e,t,n="toNone"){if(super(e,t,n),!this.root.is("rootElement"))throw new p("model-liveposition-root-not-rootelement",e);AE.call(this)}detach(){this.stopListening()}toPosition(){return new C(this.root,this.path.slice(),this.stickiness)}static fromPosition(e,t){return new this(e.root,e.path.slice(),t||e.stickiness)}}$e.prototype.is=function(i){return i==="livePosition"||i==="model:livePosition"||i=="position"||i==="model:position"};function AE(){this.listenTo(this.root.document.model,"applyOperation",(i,e)=>{const t=e[0];t.isDocumentOperation&&xE.call(this,t)},{priority:"low"})}function xE(i){const e=this.getTransformedByOperation(i);if(!this.isEqual(e)){const t=this.toPosition();this.path=e.path,this.root=e.root,this.fire("change",t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class wi{constructor(e={}){typeof e=="string"&&(e=e==="transparent"?{isUndoable:!1}:{},Q("batch-constructor-deprecated-string-type"));const{isUndoable:t=!0,isLocal:n=!0,isUndo:s=!1,isTyping:o=!1}=e;this.operations=[],this.isUndoable=t,this.isLocal=n,this.isUndo=s,this.isTyping=o}get type(){return Q("batch-type-deprecated"),"default"}get baseVersion(){for(const e of this.operations)if(e.baseVersion!==null)return e.baseVersion;return null}addOperation(e){return e.batch=this,this.operations.push(e),e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class SE{constructor(e){this._changesInElement=new Map,this._elementSnapshots=new Map,this._changedMarkers=new Map,this._changedRoots=new Map,this._changeCount=0,this._cachedChanges=null,this._cachedChangesWithGraveyard=null,this._refreshedItems=new Set,this._markerCollection=e}get isEmpty(){return this._changesInElement.size==0&&this._changedMarkers.size==0&&this._changedRoots.size==0}bufferOperation(e){const t=e;switch(t.type){case"insert":{if(this._isInInsertedElement(t.position.parent))return;this._markInsert(t.position.parent,t.position.offset,t.nodes.maxOffset);break}case"addAttribute":case"removeAttribute":case"changeAttribute":{for(const n of t.range.getItems({shallow:!0}))this._isInInsertedElement(n.parent)||this._markAttribute(n);break}case"remove":case"move":case"reinsert":{if(t.sourcePosition.isEqual(t.targetPosition)||t.sourcePosition.getShiftedBy(t.howMany).isEqual(t.targetPosition))return;const n=this._isInInsertedElement(t.sourcePosition.parent),s=this._isInInsertedElement(t.targetPosition.parent);n||this._markRemove(t.sourcePosition.parent,t.sourcePosition.offset,t.howMany),s||this._markInsert(t.targetPosition.parent,t.getMovedRangeStart().offset,t.howMany);break}case"rename":{if(this._isInInsertedElement(t.position.parent))return;this._markRemove(t.position.parent,t.position.offset,1),this._markInsert(t.position.parent,t.position.offset,1);const n=v._createFromPositionAndShift(t.position,1);for(const s of this._markerCollection.getMarkersIntersectingRange(n)){const o=s.getData();this.bufferMarkerChange(s.name,o,o)}break}case"split":{const n=t.splitPosition.parent;this._isInInsertedElement(n)||this._markRemove(n,t.splitPosition.offset,t.howMany),this._isInInsertedElement(t.insertionPosition.parent)||this._markInsert(t.insertionPosition.parent,t.insertionPosition.offset,1),t.graveyardPosition&&this._markRemove(t.graveyardPosition.parent,t.graveyardPosition.offset,1);break}case"merge":{const n=t.sourcePosition.parent;this._isInInsertedElement(n.parent)||this._markRemove(n.parent,n.startOffset,1);const s=t.graveyardPosition.parent;this._markInsert(s,t.graveyardPosition.offset,1);const o=t.targetPosition.parent;this._isInInsertedElement(o)||this._markInsert(o,t.targetPosition.offset,n.maxOffset);break}case"detachRoot":case"addRoot":{const n=t.affectedSelectable;if(!n._isLoaded||n.isAttached()==t.isAdd)return;this._bufferRootStateChange(t.rootName,t.isAdd);break}case"addRootAttribute":case"removeRootAttribute":case"changeRootAttribute":{if(!t.root._isLoaded)return;const n=t.root.rootName;this._bufferRootAttributeChange(n,t.key,t.oldValue,t.newValue);break}}this._cachedChanges=null}bufferMarkerChange(e,t,n){t.range&&t.range.root.is("rootElement")&&!t.range.root._isLoaded&&(t.range=null),n.range&&n.range.root.is("rootElement")&&!n.range.root._isLoaded&&(n.range=null);let s=this._changedMarkers.get(e);s?s.newMarkerData=n:(s={newMarkerData:n,oldMarkerData:t},this._changedMarkers.set(e,s)),s.oldMarkerData.range==null&&n.range==null&&this._changedMarkers.delete(e)}getMarkersToRemove(){const e=[];for(const[t,n]of this._changedMarkers)n.oldMarkerData.range!=null&&e.push({name:t,range:n.oldMarkerData.range});return e}getMarkersToAdd(){const e=[];for(const[t,n]of this._changedMarkers)n.newMarkerData.range!=null&&e.push({name:t,range:n.newMarkerData.range});return e}getChangedMarkers(){return Array.from(this._changedMarkers).map(([e,t])=>({name:e,data:{oldRange:t.oldMarkerData.range,newRange:t.newMarkerData.range}}))}hasDataChanges(){if(this.getChanges().length||this._changedRoots.size>0)return!0;for(const{newMarkerData:e,oldMarkerData:t}of this._changedMarkers.values()){if(e.affectsData!==t.affectsData)return!0;if(e.affectsData){const n=e.range&&!t.range,s=!e.range&&t.range,o=e.range&&t.range&&!e.range.isEqual(t.range);if(n||s||o)return!0}}return!1}getChanges(e={}){if(this._cachedChanges)return e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let t=[];for(const n of this._changesInElement.keys()){const s=this._changesInElement.get(n).sort((u,d)=>u.offset===d.offset?u.type!=d.type?u.type=="remove"?-1:1:0:u.offset<d.offset?-1:1),o=this._elementSnapshots.get(n),r=jf(n.getChildren()),a=IE(o.length,s);let l=0,c=0;for(const u of a)if(u==="i")t.push(this._getInsertDiff(n,l,r[l])),l++;else if(u==="r")t.push(this._getRemoveDiff(n,l,o[c])),c++;else if(u==="a"){const d=r[l].attributes,h=o[c].attributes;let f;if(r[l].name=="$text")f=new v(C._createAt(n,l),C._createAt(n,l+1));else{const m=n.offsetToIndex(l);f=new v(C._createAt(n,l),C._createAt(n.getChild(m),0))}t.push(...this._getAttributesDiff(f,h,d)),l++,c++}else l++,c++}t.sort((n,s)=>n.position.root!=s.position.root?n.position.root.rootName<s.position.root.rootName?-1:1:n.position.isEqual(s.position)?n.changeCount-s.changeCount:n.position.isBefore(s.position)?-1:1);for(let n=1,s=0;n<t.length;n++){const o=t[s],r=t[n],a=o.type=="remove"&&r.type=="remove"&&o.name=="$text"&&r.name=="$text"&&o.position.isEqual(r.position),l=o.type=="insert"&&r.type=="insert"&&o.name=="$text"&&r.name=="$text"&&o.position.parent==r.position.parent&&o.position.offset+o.length==r.position.offset,c=o.type=="attribute"&&r.type=="attribute"&&o.position.parent==r.position.parent&&o.range.isFlat&&r.range.isFlat&&o.position.offset+o.length==r.position.offset&&o.attributeKey==r.attributeKey&&o.attributeOldValue==r.attributeOldValue&&o.attributeNewValue==r.attributeNewValue;a||l||c?(o.length++,c&&(o.range.end=o.range.end.getShiftedBy(1)),t[n]=null):s=n}t=t.filter(n=>n);for(const n of t)delete n.changeCount,n.type=="attribute"&&(delete n.position,delete n.length);return this._changeCount=0,this._cachedChangesWithGraveyard=t,this._cachedChanges=t.filter(PE),e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice()}getChangedRoots(){return Array.from(this._changedRoots.values()).map(e=>{const t={...e};return t.state!==void 0&&delete t.attributes,t})}getRefreshedItems(){return new Set(this._refreshedItems)}reset(){this._changesInElement.clear(),this._elementSnapshots.clear(),this._changedMarkers.clear(),this._changedRoots.clear(),this._refreshedItems=new Set,this._cachedChanges=null}_bufferRootStateChange(e,t){if(!this._changedRoots.has(e)){this._changedRoots.set(e,{name:e,state:t?"attached":"detached"});return}const n=this._changedRoots.get(e);n.state!==void 0?(delete n.state,n.attributes===void 0&&this._changedRoots.delete(e)):n.state=t?"attached":"detached"}_bufferRootAttributeChange(e,t,n,s){const o=this._changedRoots.get(e)||{name:e},r=o.attributes||{};if(r[t]){const a=r[t];s===a.oldValue?delete r[t]:a.newValue=s}else r[t]={oldValue:n,newValue:s};Object.entries(r).length===0?(delete o.attributes,o.state===void 0&&this._changedRoots.delete(e)):(o.attributes=r,this._changedRoots.set(e,o))}_refreshItem(e){if(this._isInInsertedElement(e.parent))return;this._markRemove(e.parent,e.startOffset,e.offsetSize),this._markInsert(e.parent,e.startOffset,e.offsetSize),this._refreshedItems.add(e);const t=v._createOn(e);for(const n of this._markerCollection.getMarkersIntersectingRange(t)){const s=n.getData();this.bufferMarkerChange(n.name,s,s)}this._cachedChanges=null}_bufferRootLoad(e){if(e.isAttached()){this._bufferRootStateChange(e.rootName,!0),this._markInsert(e,0,e.maxOffset);for(const t of e.getAttributeKeys())this._bufferRootAttributeChange(e.rootName,t,null,e.getAttribute(t));for(const t of this._markerCollection)if(t.getRange().root==e){const n=t.getData();this.bufferMarkerChange(t.name,{...n,range:null},n)}}}_markInsert(e,t,n){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const s={type:"insert",offset:t,howMany:n,count:this._changeCount++};this._markChange(e,s)}_markRemove(e,t,n){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const s={type:"remove",offset:t,howMany:n,count:this._changeCount++};this._markChange(e,s),this._removeAllNestedChanges(e,t,n)}_markAttribute(e){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const t={type:"attribute",offset:e.startOffset,howMany:e.offsetSize,count:this._changeCount++};this._markChange(e.parent,t)}_markChange(e,t){this._makeSnapshot(e);const n=this._getChangesForElement(e);this._handleChange(t,n),n.push(t);for(let s=0;s<n.length;s++)n[s].howMany<1&&(n.splice(s,1),s--)}_getChangesForElement(e){let t;return this._changesInElement.has(e)?t=this._changesInElement.get(e):(t=[],this._changesInElement.set(e,t)),t}_makeSnapshot(e){this._elementSnapshots.has(e)||this._elementSnapshots.set(e,jf(e.getChildren()))}_handleChange(e,t){e.nodesToHandle=e.howMany;for(const n of t){const s=e.offset+e.howMany,o=n.offset+n.howMany;if(e.type=="insert"&&(n.type=="insert"&&(e.offset<=n.offset?n.offset+=e.howMany:e.offset<o&&(n.howMany+=e.nodesToHandle,e.nodesToHandle=0)),n.type=="remove"&&e.offset<n.offset&&(n.offset+=e.howMany),n.type=="attribute")){if(e.offset<=n.offset)n.offset+=e.howMany;else if(e.offset<o){const r=n.howMany;n.howMany=e.offset-n.offset,t.unshift({type:"attribute",offset:s,howMany:r-n.howMany,count:this._changeCount++})}}if(e.type=="remove"){if(n.type=="insert"){if(s<=n.offset)n.offset-=e.howMany;else if(s<=o)if(e.offset<n.offset){const r=s-n.offset;n.offset=e.offset,n.howMany-=r,e.nodesToHandle-=r}else n.howMany-=e.nodesToHandle,e.nodesToHandle=0;else if(e.offset<=n.offset)e.nodesToHandle-=n.howMany,n.howMany=0;else if(e.offset<o){const r=o-e.offset;n.howMany-=r,e.nodesToHandle-=r}}if(n.type=="remove"&&(s<=n.offset?n.offset-=e.howMany:e.offset<n.offset&&(e.nodesToHandle+=n.howMany,n.howMany=0)),n.type=="attribute"){if(s<=n.offset)n.offset-=e.howMany;else if(e.offset<n.offset){const r=s-n.offset;n.offset=e.offset,n.howMany-=r}else if(e.offset<o)if(s<=o){const r=n.howMany;n.howMany=e.offset-n.offset;const a=r-n.howMany-e.nodesToHandle;t.unshift({type:"attribute",offset:e.offset,howMany:a,count:this._changeCount++})}else n.howMany-=o-e.offset}}if(e.type=="attribute"){if(n.type=="insert")if(e.offset<n.offset&&s>n.offset){if(s>o){const r={type:"attribute",offset:o,howMany:s-o,count:this._changeCount++};this._handleChange(r,t),t.push(r)}e.nodesToHandle=n.offset-e.offset,e.howMany=e.nodesToHandle}else e.offset>=n.offset&&e.offset<o&&(s>o?(e.nodesToHandle=s-o,e.offset=o):e.nodesToHandle=0);if(n.type=="remove"&&e.offset<n.offset&&s>n.offset){const r={type:"attribute",offset:n.offset,howMany:s-n.offset,count:this._changeCount++};this._handleChange(r,t),t.push(r),e.nodesToHandle=n.offset-e.offset,e.howMany=e.nodesToHandle}n.type=="attribute"&&(e.offset>=n.offset&&s<=o?(e.nodesToHandle=0,e.howMany=0,e.offset=0):e.offset<=n.offset&&s>=o&&(n.howMany=0))}}e.howMany=e.nodesToHandle,delete e.nodesToHandle}_getInsertDiff(e,t,n){return{type:"insert",position:C._createAt(e,t),name:n.name,attributes:new Map(n.attributes),length:1,changeCount:this._changeCount++,_element:n.element}}_getRemoveDiff(e,t,n){return{type:"remove",position:C._createAt(e,t),name:n.name,attributes:new Map(n.attributes),length:1,changeCount:this._changeCount++,_element:n.element}}_getAttributesDiff(e,t,n){const s=[];n=new Map(n);for(const[o,r]of t){const a=n.has(o)?n.get(o):null;a!==r&&s.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:o,attributeOldValue:r,attributeNewValue:a,changeCount:this._changeCount++}),n.delete(o)}for(const[o,r]of n)s.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:o,attributeOldValue:null,attributeNewValue:r,changeCount:this._changeCount++});return s}_isInInsertedElement(e){const t=e.parent;if(!t)return!1;const n=this._changesInElement.get(t),s=e.startOffset;if(n){for(const o of n)if(o.type=="insert"&&s>=o.offset&&s<o.offset+o.howMany)return!0}return this._isInInsertedElement(t)}_removeAllNestedChanges(e,t,n){const s=new v(C._createAt(e,t),C._createAt(e,t+n));for(const o of s.getItems({shallow:!0}))o.is("element")&&(this._elementSnapshots.delete(o),this._changesInElement.delete(o),this._removeAllNestedChanges(o,0,o.maxOffset))}}function jf(i){const e=[];for(const t of i)if(t.is("$text"))for(let n=0;n<t.data.length;n++)e.push({name:"$text",attributes:new Map(t.getAttributes())});else e.push({name:t.name,attributes:new Map(t.getAttributes()),element:t});return e}function IE(i,e){const t=[];let n=0,s=0;for(const o of e){if(o.offset>n){for(let r=0;r<o.offset-n;r++)t.push("e");s+=o.offset-n}if(o.type=="insert"){for(let r=0;r<o.howMany;r++)t.push("i");n=o.offset+o.howMany}else if(o.type=="remove"){for(let r=0;r<o.howMany;r++)t.push("r");n=o.offset,s+=o.howMany}else t.push(..."a".repeat(o.howMany).split("")),n=o.offset+o.howMany,s+=o.howMany}if(s<i)for(let o=0;o<i-s-n;o++)t.push("e");return t}function PE(i){const e="position"in i&&i.position.root.rootName=="$graveyard",t="range"in i&&i.range.root.rootName=="$graveyard";return!e&&!t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class RE{constructor(){this._operations=[],this._undoPairs=new Map,this._undoneOperations=new Set,this._baseVersionToOperationIndex=new Map,this._version=0,this._gaps=new Map}get version(){return this._version}set version(e){this._operations.length&&e>this._version+1&&this._gaps.set(this._version,e),this._version=e}get lastOperation(){return this._operations[this._operations.length-1]}addOperation(e){if(e.baseVersion!==this.version)throw new p("model-document-history-addoperation-incorrect-version",this,{operation:e,historyVersion:this.version});this._operations.push(e),this._version++,this._baseVersionToOperationIndex.set(e.baseVersion,this._operations.length-1)}getOperations(e,t=this.version){if(!this._operations.length)return[];const n=this._operations[0];e===void 0&&(e=n.baseVersion);let s=t-1;for(const[a,l]of this._gaps)e>a&&e<l&&(e=l),s>a&&s<l&&(s=a-1);if(s<n.baseVersion||e>this.lastOperation.baseVersion)return[];let o=this._baseVersionToOperationIndex.get(e);o===void 0&&(o=0);let r=this._baseVersionToOperationIndex.get(s);return r===void 0&&(r=this._operations.length-1),this._operations.slice(o,r+1)}getOperation(e){const t=this._baseVersionToOperationIndex.get(e);if(t!==void 0)return this._operations[t]}setOperationAsUndone(e,t){this._undoPairs.set(t,e),this._undoneOperations.add(e)}isUndoingOperation(e){return this._undoPairs.has(e)}isUndoneOperation(e){return this._undoneOperations.has(e)}getUndoneOperation(e){return this._undoPairs.get(e)}reset(){this._version=0,this._undoPairs=new Map,this._operations=[],this._undoneOperations=new Set,this._gaps=new Map,this._baseVersionToOperationIndex=new Map}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class jo extends Y{constructor(e,t,n="main"){super(t),this._isAttached=!0,this._isLoaded=!0,this._document=e,this.rootName=n}get document(){return this._document}isAttached(){return this._isAttached}toJSON(){return this.rootName}}jo.prototype.is=function(i,e){return e?e===this.name&&(i==="rootElement"||i==="model:rootElement"||i==="element"||i==="model:element"):i==="rootElement"||i==="model:rootElement"||i==="element"||i==="model:element"||i==="node"||i==="model:node"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const qf="$graveyard";class ME extends ee(){constructor(e){super(),this.model=e,this.history=new RE,this.selection=new kt(this),this.roots=new Oe({idProperty:"rootName"}),this.differ=new SE(e.markers),this.isReadOnly=!1,this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",qf),this.listenTo(e,"applyOperation",(t,n)=>{const s=n[0];s.isDocumentOperation&&this.differ.bufferOperation(s)},{priority:"high"}),this.listenTo(e,"applyOperation",(t,n)=>{const s=n[0];s.isDocumentOperation&&this.history.addOperation(s)},{priority:"low"}),this.listenTo(this.selection,"change",()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0}),this.listenTo(e.markers,"update",(t,n,s,o,r)=>{const a={...n.getData(),range:o};this.differ.bufferMarkerChange(n.name,r,a),s===null&&n.on("change",(l,c)=>{const u=n.getData();this.differ.bufferMarkerChange(n.name,{...u,range:c},u)})}),this.registerPostFixer(t=>{let n=!1;for(const s of this.roots)!s.isAttached()&&!s.isEmpty&&(t.remove(t.createRangeIn(s)),n=!0);for(const s of this.model.markers)s.getRange().root.isAttached()||(t.removeMarker(s),n=!0);return n})}get version(){return this.history.version}set version(e){this.history.version=e}get graveyard(){return this.getRoot(qf)}createRoot(e="$root",t="main"){if(this.roots.get(t))throw new p("model-document-createroot-name-exists",this,{name:t});const n=new jo(this,e,t);return this.roots.add(n),n}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(e=!1){return this.getRoots(e).map(t=>t.rootName)}getRoots(e=!1){return this.roots.filter(t=>t!=this.graveyard&&(e||t.isAttached())&&t._isLoaded)}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=Ud(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){const e=this.getRoots();return e.length?e[0]:this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),t=this.model,n=t.schema,s=t.createPositionFromPath(e,[0]);return n.getNearestSelectionRange(s)||t.createRange(s)}_validateSelectionRange(e){return Gf(e.start)&&Gf(e.end)}_callPostFixers(e){let t=!1;do for(const n of this._postFixers)if(this.selection.refresh(),t=n(e),t)break;while(t)}}function Gf(i){const e=i.textNode;if(e){const t=e.data,n=i.offset-e.startOffset;return!tl(t,n)&&!nl(t,n)}return!0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class BE extends ee(){constructor(){super(...arguments),this._markers=new Map}[Symbol.iterator](){return this._markers.values()}has(e){const t=e instanceof _i?e.name:e;return this._markers.has(t)}get(e){return this._markers.get(e)||null}_set(e,t,n=!1,s=!1){const o=e instanceof _i?e.name:e;if(o.includes(","))throw new p("markercollection-incorrect-marker-name",this);const r=this._markers.get(o);if(r){const c=r.getData(),u=r.getRange();let d=!1;return u.isEqual(t)||(r._attachLiveRange(rt.fromRange(t)),d=!0),n!=r.managedUsingOperations&&(r._managedUsingOperations=n,d=!0),typeof s=="boolean"&&s!=r.affectsData&&(r._affectsData=s,d=!0),d&&this.fire(`update:${o}`,r,u,t,c),r}const a=rt.fromRange(t),l=new _i(o,a,n,s);return this._markers.set(o,l),this.fire(`update:${o}`,l,null,t,{...l.getData(),range:null}),l}_remove(e){const t=e instanceof _i?e.name:e,n=this._markers.get(t);return n?(this._markers.delete(t),this.fire(`update:${t}`,n,n.getRange(),null,n.getData()),this._destroyMarker(n),!0):!1}_refresh(e){const t=e instanceof _i?e.name:e,n=this._markers.get(t);if(!n)throw new p("markercollection-refresh-marker-not-exists",this);const s=n.getRange();this.fire(`update:${t}`,n,s,s,n.getData())}*getMarkersAtPosition(e){for(const t of this)t.getRange().containsPosition(e)&&(yield t)}*getMarkersIntersectingRange(e){for(const t of this)t.getRange().getIntersection(e)!==null&&(yield t)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const t of this._markers.values())t.name.startsWith(e+":")&&(yield t)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}}class _i extends ee(un){constructor(e,t,n,s){super(),this.name=e,this._liveRange=this._attachLiveRange(t),this._managedUsingOperations=n,this._affectsData=s}get managedUsingOperations(){if(!this._liveRange)throw new p("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new p("marker-destroyed",this);return this._affectsData}getData(){return{range:this.getRange(),affectsData:this.affectsData,managedUsingOperations:this.managedUsingOperations}}getStart(){if(!this._liveRange)throw new p("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new p("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new p("marker-destroyed",this);return this._liveRange.toRange()}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}_i.prototype.is=function(i){return i==="marker"||i==="model:marker"};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class OE extends Je{constructor(e,t){super(null),this.sourcePosition=e.clone(),this.howMany=t}get type(){return"detach"}get affectedSelectable(){return null}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new p("detach-operation-on-document-node",this)}_execute(){Nf(v._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Jt extends un{constructor(e){super(),this.markers=new Map,this._children=new ms,e&&this._insertChild(0,e)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}get nextSibling(){return null}get previousSibling(){return null}get root(){return this}get parent(){return null}get document(){return null}isAttached(){return!1}getAncestors(){return[]}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}getPath(){return[]}getNodeByPath(e){let t=this;for(const n of e)t=t.getChild(t.offsetToIndex(n));return t}offsetToIndex(e){return this._children.offsetToIndex(e)}toJSON(){const e=[];for(const t of this._children)e.push(t.toJSON());return e}static fromJSON(e){const t=[];for(const n of e)n.name?t.push(Y.fromJSON(n)):t.push(te.fromJSON(n));return new Jt(t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const n=LE(t);for(const s of n)s.parent!==null&&s._remove(),s.parent=this;this._children._insertNodes(e,n)}_removeChildren(e,t=1){const n=this._children._removeNodes(e,t);for(const s of n)s.parent=null;return n}}Jt.prototype.is=function(i){return i==="documentFragment"||i==="model:documentFragment"};function LE(i){return typeof i=="string"?[new te(i)]:(je(i)||(i=[i]),Array.from(i).map(e=>typeof e=="string"?new te(e):e instanceof Ct?new te(e.data,e.getAttributes()):e))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class VE{constructor(e,t){this.model=e,this.batch=t}createText(e,t){return new te(e,t)}createElement(e,t){return new Y(e,t)}createDocumentFragment(){return new Jt}cloneElement(e,t=!0){return e._clone(t)}insert(e,t,n=0){if(this._assertWriterUsedCorrectly(),e instanceof te&&e.data=="")return;const s=C._createAt(t,n);if(e.parent)if(Jf(e.root,s.root)){this.move(v._createOn(e),s);return}else{if(e.root.document)throw new p("model-writer-insert-forbidden-move",this);this.remove(e)}const o=s.root.document?s.root.document.version:null,r=new ve(s,e,o);if(e instanceof te&&(r.shouldReceiveAttributes=!0),this.batch.addOperation(r),this.model.applyOperation(r),e instanceof Jt)for(const[a,l]of e.markers){const c=C._createAt(l.root,0),d={range:new v(l.start._getCombined(c,s),l.end._getCombined(c,s)),usingOperation:!0,affectsData:!0};this.model.markers.has(a)?this.updateMarker(a,d):this.addMarker(a,d)}}insertText(e,t,n,s){t instanceof Jt||t instanceof Y||t instanceof C?this.insert(this.createText(e),t,n):this.insert(this.createText(e,t),n,s)}insertElement(e,t,n,s){t instanceof Jt||t instanceof Y||t instanceof C?this.insert(this.createElement(e),t,n):this.insert(this.createElement(e,t),n,s)}append(e,t){this.insert(e,t,"end")}appendText(e,t,n){t instanceof Jt||t instanceof Y?this.insert(this.createText(e),t,"end"):this.insert(this.createText(e,t),n,"end")}appendElement(e,t,n){t instanceof Jt||t instanceof Y?this.insert(this.createElement(e),t,"end"):this.insert(this.createElement(e,t),n,"end")}setAttribute(e,t,n){if(this._assertWriterUsedCorrectly(),n instanceof v){const s=n.getMinimalFlatRanges();for(const o of s)Kf(this,e,t,o)}else Zf(this,e,t,n)}setAttributes(e,t){for(const[n,s]of _t(e))this.setAttribute(n,s,t)}removeAttribute(e,t){if(this._assertWriterUsedCorrectly(),t instanceof v){const n=t.getMinimalFlatRanges();for(const s of n)Kf(this,e,null,s)}else Zf(this,e,null,t)}clearAttributes(e){this._assertWriterUsedCorrectly();const t=n=>{for(const s of n.getAttributeKeys())this.removeAttribute(s,n)};if(!(e instanceof v))t(e);else for(const n of e.getItems())t(n)}move(e,t,n){if(this._assertWriterUsedCorrectly(),!(e instanceof v))throw new p("writer-move-invalid-range",this);if(!e.isFlat)throw new p("writer-move-range-not-flat",this);const s=C._createAt(t,n);if(s.isEqual(e.start))return;if(this._addOperationForAffectedMarkers("move",e),!Jf(e.root,s.root))throw new p("writer-move-different-document",this);const o=e.root.document?e.root.document.version:null,r=new G(e.start,e.end.offset-e.start.offset,s,o);this.batch.addOperation(r),this.model.applyOperation(r)}remove(e){this._assertWriterUsedCorrectly();const n=(e instanceof v?e:v._createOn(e)).getMinimalFlatRanges().reverse();for(const s of n)this._addOperationForAffectedMarkers("move",s),DE(s.start,s.end.offset-s.start.offset,this.batch,this.model)}merge(e){this._assertWriterUsedCorrectly();const t=e.nodeBefore,n=e.nodeAfter;if(this._addOperationForAffectedMarkers("merge",e),!(t instanceof Y))throw new p("writer-merge-no-element-before",this);if(!(n instanceof Y))throw new p("writer-merge-no-element-after",this);e.root.document?this._merge(e):this._mergeDetached(e)}createPositionFromPath(e,t,n){return this.model.createPositionFromPath(e,t,n)}createPositionAt(e,t){return this.model.createPositionAt(e,t)}createPositionAfter(e){return this.model.createPositionAfter(e)}createPositionBefore(e){return this.model.createPositionBefore(e)}createRange(e,t){return this.model.createRange(e,t)}createRangeIn(e){return this.model.createRangeIn(e)}createRangeOn(e){return this.model.createRangeOn(e)}createSelection(...e){return this.model.createSelection(...e)}_mergeDetached(e){const t=e.nodeBefore,n=e.nodeAfter;this.move(v._createIn(n),C._createAt(t,"end")),this.remove(n)}_merge(e){const t=C._createAt(e.nodeBefore,"end"),n=C._createAt(e.nodeAfter,0),s=e.root.document.graveyard,o=new C(s,[0]),r=e.root.document.version,a=new ue(n,e.nodeAfter.maxOffset,t,o,r);this.batch.addOperation(a),this.model.applyOperation(a)}rename(e,t){if(this._assertWriterUsedCorrectly(),!(e instanceof Y))throw new p("writer-rename-not-element-instance",this);const n=e.root.document?e.root.document.version:null,s=new Fe(C._createBefore(e),e.name,t,n);this.batch.addOperation(s),this.model.applyOperation(s)}split(e,t){this._assertWriterUsedCorrectly();let n=e.parent;if(!n.parent)throw new p("writer-split-element-no-parent",this);if(t||(t=n.parent),!e.parent.getAncestors({includeSelf:!0}).includes(t))throw new p("writer-split-invalid-limit-element",this);let s,o;do{const r=n.root.document?n.root.document.version:null,a=n.maxOffset-e.offset,l=ne.getInsertionPosition(e),c=new ne(e,a,l,null,r);this.batch.addOperation(c),this.model.applyOperation(c),!s&&!o&&(s=n,o=e.parent.nextSibling),e=this.createPositionAfter(e.parent),n=e.parent}while(n!==t);return{position:e,range:new v(C._createAt(s,"end"),C._createAt(o,0))}}wrap(e,t){if(this._assertWriterUsedCorrectly(),!e.isFlat)throw new p("writer-wrap-range-not-flat",this);const n=t instanceof Y?t:new Y(t);if(n.childCount>0)throw new p("writer-wrap-element-not-empty",this);if(n.parent!==null)throw new p("writer-wrap-element-attached",this);this.insert(n,e.start);const s=new v(e.start.getShiftedBy(1),e.end.getShiftedBy(1));this.move(s,C._createAt(n,0))}unwrap(e){if(this._assertWriterUsedCorrectly(),e.parent===null)throw new p("writer-unwrap-element-no-parent",this);this.move(v._createIn(e),this.createPositionAfter(e)),this.remove(e)}addMarker(e,t){if(this._assertWriterUsedCorrectly(),!t||typeof t.usingOperation!="boolean")throw new p("writer-addmarker-no-usingoperation",this);const n=t.usingOperation,s=t.range,o=t.affectsData===void 0?!1:t.affectsData;if(this.model.markers.has(e))throw new p("writer-addmarker-marker-exists",this);if(!s)throw new p("writer-addmarker-no-range",this);return n?(ks(this,e,null,s,o),this.model.markers.get(e)):this.model.markers._set(e,s,n,o)}updateMarker(e,t){this._assertWriterUsedCorrectly();const n=typeof e=="string"?e:e.name,s=this.model.markers.get(n);if(!s)throw new p("writer-updatemarker-marker-not-exists",this);if(!t){Q("writer-updatemarker-reconvert-using-editingcontroller",{markerName:n}),this.model.markers._refresh(s);return}const o=typeof t.usingOperation=="boolean",r=typeof t.affectsData=="boolean",a=r?t.affectsData:s.affectsData;if(!o&&!t.range&&!r)throw new p("writer-updatemarker-wrong-options",this);const l=s.getRange(),c=t.range?t.range:l;if(o&&t.usingOperation!==s.managedUsingOperations){t.usingOperation?ks(this,n,null,c,a):(ks(this,n,l,null,a),this.model.markers._set(n,c,void 0,a));return}s.managedUsingOperations?ks(this,n,l,c,a):this.model.markers._set(n,c,void 0,a)}removeMarker(e){this._assertWriterUsedCorrectly();const t=typeof e=="string"?e:e.name;if(!this.model.markers.has(t))throw new p("writer-removemarker-no-marker",this);const n=this.model.markers.get(t);if(!n.managedUsingOperations){this.model.markers._remove(t);return}const s=n.getRange();ks(this,t,s,null,n.affectsData)}addRoot(e,t="$root"){this._assertWriterUsedCorrectly();const n=this.model.document.getRoot(e);if(n&&n.isAttached())throw new p("writer-addroot-root-exists",this);const s=this.model.document,o=new Rt(e,t,!0,s,s.version);return this.batch.addOperation(o),this.model.applyOperation(o),this.model.document.getRoot(e)}detachRoot(e){this._assertWriterUsedCorrectly();const t=typeof e=="string"?this.model.document.getRoot(e):e;if(!t||!t.isAttached())throw new p("writer-detachroot-no-root",this);for(const o of this.model.markers)o.getRange().root===t&&this.removeMarker(o);for(const o of t.getAttributeKeys())this.removeAttribute(o,t);this.remove(this.createRangeIn(t));const n=this.model.document,s=new Rt(t.rootName,t.name,!1,n,n.version);this.batch.addOperation(s),this.model.applyOperation(s)}setSelection(...e){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(...e)}setSelectionFocus(e,t){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(e,t)}setSelectionAttribute(e,t){if(this._assertWriterUsedCorrectly(),typeof e=="string")this._setSelectionAttribute(e,t);else for(const[n,s]of _t(e))this._setSelectionAttribute(n,s)}removeSelectionAttribute(e){if(this._assertWriterUsedCorrectly(),typeof e=="string")this._removeSelectionAttribute(e);else for(const t of e)this._removeSelectionAttribute(t)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(e){this.model.document.selection._restoreGravity(e)}_setSelectionAttribute(e,t){const n=this.model.document.selection;if(n.isCollapsed&&n.anchor.parent.isEmpty){const s=kt._getStoreAttributeKey(e);this.setAttribute(s,t,n.anchor.parent)}n._setAttribute(e,t)}_removeSelectionAttribute(e){const t=this.model.document.selection;if(t.isCollapsed&&t.anchor.parent.isEmpty){const n=kt._getStoreAttributeKey(e);this.removeAttribute(n,t.anchor.parent)}t._removeAttribute(e)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new p("writer-incorrect-use",this)}_addOperationForAffectedMarkers(e,t){for(const n of this.model.markers){if(!n.managedUsingOperations)continue;const s=n.getRange();let o=!1;if(e==="move"){const r=t;o=r.containsPosition(s.start)||r.start.isEqual(s.start)||r.containsPosition(s.end)||r.end.isEqual(s.end)}else{const r=t,a=r.nodeBefore,l=r.nodeAfter,c=s.start.parent==a&&s.start.isAtEnd,u=s.end.parent==l&&s.end.offset==0,d=s.end.nodeAfter==l,h=s.start.nodeAfter==l;o=c||u||d||h}o&&this.updateMarker(n.name,{range:s})}}}function Kf(i,e,t,n){const s=i.model,o=s.document;let r=n.start,a,l,c;for(const d of n.getWalker({shallow:!0}))c=d.item.getAttribute(e),a&&l!=c&&(l!=t&&u(),r=a),a=d.nextPosition,l=c;a instanceof C&&a!=r&&l!=t&&u();function u(){const d=new v(r,a),h=d.root.document?o.version:null,f=new fe(d,e,l,t,h);i.batch.addOperation(f),s.applyOperation(f)}}function Zf(i,e,t,n){const s=i.model,o=s.document,r=n.getAttribute(e);let a,l;if(r!=t){if(n.root===n){const u=n.document?o.version:null;l=new Zt(n,e,r,t,u)}else{a=new v(C._createBefore(n),i.createPositionAfter(n));const u=a.root.document?o.version:null;l=new fe(a,e,r,t,u)}i.batch.addOperation(l),s.applyOperation(l)}}function ks(i,e,t,n,s){const o=i.model,r=o.document,a=new Ne(e,t,n,o.markers,!!s,r.version);i.batch.addOperation(a),o.applyOperation(a)}function DE(i,e,t,n){let s;if(i.root.document){const o=n.document,r=new C(o.graveyard,[0]);s=new G(i,e,r,o.version)}else s=new OE(i,e);t.addOperation(s),n.applyOperation(s)}function Jf(i,e){return i===e||i instanceof jo&&e instanceof jo}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function NE(i,e,t={}){if(e.isCollapsed)return;const n=e.getFirstRange();if(n.root.rootName=="$graveyard")return;const s=i.schema;i.change(o=>{if(!t.doNotResetEntireContent&&GE(s,e)){qE(o,e);return}const r={};if(!t.doNotAutoparagraph){const c=e.getSelectedElement();c&&Object.assign(r,s.getAttributesWithProperty(c,"copyOnReplace",!0))}const[a,l]=FE(n);a.isTouching(l)||o.remove(o.createRange(a,l)),t.leaveUnmerged||(UE(o,a,l),s.removeDisallowedAttributes(a.parent.getChildren(),o)),em(o,e,a),!t.doNotAutoparagraph&&WE(s,a)&&Qf(o,a,e,r),a.detach(),l.detach()})}function FE(i){const e=i.root.document.model,t=i.start;let n=i.end;if(e.hasContent(i,{ignoreMarkers:!0})){const s=$E(n);if(s&&n.isTouching(e.createPositionAt(s,0))){const o=e.createSelection(i);e.modifySelection(o,{direction:"backward"});const r=o.getLastPosition(),a=e.createRange(r,n);e.hasContent(a,{ignoreMarkers:!0})||(n=r)}}return[$e.fromPosition(t,"toPrevious"),$e.fromPosition(n,"toNext")]}function $E(i){const e=i.parent,t=e.root.document.model.schema,n=e.getAncestors({parentFirst:!0,includeSelf:!0});for(const s of n){if(t.isLimit(s))return null;if(t.isBlock(s))return s}}function UE(i,e,t){const n=i.model;if(!El(i.model.schema,e,t))return;const[s,o]=HE(e,t);!s||!o||(!n.hasContent(s,{ignoreMarkers:!0})&&n.hasContent(o,{ignoreMarkers:!0})?Xf(i,e,t,s.parent):Yf(i,e,t,s.parent))}function Yf(i,e,t,n){const s=e.parent,o=t.parent;if(!(s==n||o==n)){for(e=i.createPositionAfter(s),t=i.createPositionBefore(o),t.isEqual(e)||i.insert(o,e),i.merge(e);t.parent.isEmpty;){const r=t.parent;t=i.createPositionBefore(r),i.remove(r)}El(i.model.schema,e,t)&&Yf(i,e,t,n)}}function Xf(i,e,t,n){const s=e.parent,o=t.parent;if(!(s==n||o==n)){for(e=i.createPositionAfter(s),t=i.createPositionBefore(o),t.isEqual(e)||i.insert(s,t);e.parent.isEmpty;){const r=e.parent;e=i.createPositionBefore(r),i.remove(r)}t=i.createPositionBefore(o),zE(i,t),El(i.model.schema,e,t)&&Xf(i,e,t,n)}}function zE(i,e){const t=e.nodeBefore,n=e.nodeAfter;t.name!=n.name&&i.rename(t,n.name),i.clearAttributes(t),i.setAttributes(Object.fromEntries(n.getAttributes()),t),i.merge(e)}function El(i,e,t){const n=e.parent,s=t.parent;return n==s||i.isLimit(n)||i.isLimit(s)?!1:jE(e,t,i)}function HE(i,e){const t=i.getAncestors(),n=e.getAncestors();let s=0;for(;t[s]&&t[s]==n[s];)s++;return[t[s],n[s]]}function WE(i,e){const t=i.checkChild(e,"$text"),n=i.checkChild(e,"paragraph");return!t&&n}function jE(i,e,t){const n=new v(i,e);for(const s of n.getWalker())if(t.isLimit(s.item))return!1;return!0}function Qf(i,e,t,n={}){const s=i.createElement("paragraph");i.model.schema.setAllowedAttributes(s,n,i),i.insert(s,e),em(i,t,i.createPositionAt(s,0))}function qE(i,e){const t=i.model.schema.getLimitElement(e);i.remove(i.createRangeIn(t)),Qf(i,i.createPositionAt(t,0),e)}function GE(i,e){const t=i.getLimitElement(e);if(!e.containsEntireContent(t))return!1;const n=e.getFirstRange();return n.start.parent==n.end.parent?!1:i.checkChild(t,"paragraph")}function em(i,e,t){e instanceof kt?i.setSelection(t):e.setTo(t)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function KE(i,e){return i.change(t=>{const n=t.createDocumentFragment(),s=e.getFirstRange();if(!s||s.isCollapsed)return n;const o=s.start.root,r=s.start.getCommonPath(s.end),a=o.getNodeByPath(r);let l;s.start.parent==s.end.parent?l=s:l=t.createRange(t.createPositionAt(a,s.start.path[r.length]),t.createPositionAt(a,s.end.path[r.length]+1));const c=l.end.offset-l.start.offset;for(const u of l.getItems({shallow:!0}))u.is("$textProxy")?t.appendText(u.data,u.getAttributes(),n):t.append(t.cloneElement(u,!0),n);if(l!=s){const u=s._getTransformedByMove(l.start,t.createPositionAt(n,0),c)[0],d=t.createRange(t.createPositionAt(n,0),u.start),h=t.createRange(u.end,t.createPositionAt(n,"end"));tm(h,t),tm(d,t)}return n})}function tm(i,e){const t=[];Array.from(i.getItems({direction:"backward"})).map(n=>e.createRangeOn(n)).filter(n=>(n.start.isAfter(i.start)||n.start.isEqual(i.start))&&(n.end.isBefore(i.end)||n.end.isEqual(i.end))).forEach(n=>{t.push(n.start.parent),e.remove(n)}),t.forEach(n=>{let s=n;for(;s.parent&&s.isEmpty;){const o=e.createRangeOn(s);s=s.parent,e.remove(o)}})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ZE(i,e,t){return i.change(n=>{const s=t||i.document.selection;s.isCollapsed||i.deleteContent(s,{doNotAutoparagraph:!0});const o=new JE(i,n,s.anchor),r=[];let a;if(e.is("documentFragment")){if(e.markers.size){const u=[];for(const[d,h]of e.markers){const{start:f,end:m}=h,g=f.isEqual(m);u.push({position:f,name:d,isCollapsed:g},{position:m,name:d,isCollapsed:g})}u.sort(({position:d},{position:h})=>d.isBefore(h)?1:-1);for(const{position:d,name:h,isCollapsed:f}of u){let m=null,g=null;const b=d.parent===e&&d.isAtStart,_=d.parent===e&&d.isAtEnd;!b&&!_?(m=n.createElement("$marker"),n.insert(m,d)):f&&(g=b?"start":"end"),r.push({name:h,element:m,collapsed:g})}}a=e.getChildren()}else a=[e];o.handleNodes(a);let l=o.getSelectionRange();if(e.is("documentFragment")&&r.length){const u=l?rt.fromRange(l):null,d={};for(let h=r.length-1;h>=0;h--){const{name:f,element:m,collapsed:g}=r[h],b=!d[f];if(b&&(d[f]=[]),m){const _=n.createPositionAt(m,"before");d[f].push(_),n.remove(m)}else{const _=o.getAffectedRange();if(!_){g&&d[f].push(o.position);continue}g?d[f].push(_[g]):d[f].push(b?_.start:_.end)}}for(const[h,[f,m]]of Object.entries(d))f&&m&&f.root===m.root&&f.root.document&&!n.model.markers.has(h)&&n.addMarker(h,{usingOperation:!0,affectsData:!0,range:new v(f,m)});u&&(l=u.toRange(),u.detach())}/* istanbul ignore else -- @preserve */l&&(s instanceof kt?n.setSelection(l):s.setTo(l));const c=o.getAffectedRange()||i.createRange(s.anchor);return o.destroy(),c})}class JE{constructor(e,t,n){this._firstNode=null,this._lastNode=null,this._lastAutoParagraph=null,this._filterAttributesOf=[],this._affectedStart=null,this._affectedEnd=null,this._nodeToSelect=null,this.model=e,this.writer=t,this.position=n,this.canMergeWith=new Set([this.position.parent]),this.schema=e.schema,this._documentFragment=t.createDocumentFragment(),this._documentFragmentPosition=t.createPositionAt(this._documentFragment,0)}handleNodes(e){for(const t of Array.from(e))this._handleNode(t);this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}_updateLastNodeFromAutoParagraph(e){const t=this.writer.createPositionAfter(this._lastNode),n=this.writer.createPositionAfter(e);if(n.isAfter(t)){this._lastNode=e;/* istanbul ignore if -- @preserve */if(this.position.parent!=e||!this.position.isAtEnd)throw new p("insertcontent-invalid-insertion-position",this);this.position=n,this._setAffectedBoundaries(this.position)}}getSelectionRange(){return this._nodeToSelect?v._createOn(this._nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new v(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(e){if(this.schema.isObject(e)){this._handleObject(e);return}let t=this._checkAndAutoParagraphToAllowedPosition(e);if(!t&&(t=this._checkAndSplitToAllowedPosition(e),!t)){this._handleDisallowedNode(e);return}this._appendToFragment(e),this._firstNode||(this._firstNode=e),this._lastNode=e}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const e=$e.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=e.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=e.toPosition(),e.detach()}_handleObject(e){this._checkAndSplitToAllowedPosition(e)?this._appendToFragment(e):this._tryAutoparagraphing(e)}_handleDisallowedNode(e){e.is("element")?this.handleNodes(e.getChildren()):this._tryAutoparagraphing(e)}_appendToFragment(e){/* istanbul ignore if -- @preserve */if(!this.schema.checkChild(this.position,e))throw new p("insertcontent-wrong-position",this,{node:e,position:this.position});this.writer.insert(e,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(e.offsetSize),this.schema.isObject(e)&&!this.schema.checkChild(this.position,"$text")?this._nodeToSelect=e:this._nodeToSelect=null,this._filterAttributesOf.push(e)}_setAffectedBoundaries(e){this._affectedStart||(this._affectedStart=$e.fromPosition(e,"toPrevious")),(!this._affectedEnd||this._affectedEnd.isBefore(e))&&(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=$e.fromPosition(e,"toNext"))}_mergeOnLeft(){const e=this._firstNode;if(!(e instanceof Y)||!this._canMergeLeft(e))return;const t=$e._createBefore(e);t.stickiness="toNext";const n=$e.fromPosition(this.position,"toNext");this._affectedStart.isEqual(t)&&(this._affectedStart.detach(),this._affectedStart=$e._createAt(t.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=$e._createAt(t.nodeBefore,"end","toNext")),this.position=n.toPosition(),n.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_mergeOnRight(){const e=this._lastNode;if(!(e instanceof Y)||!this._canMergeRight(e))return;const t=$e._createAfter(e);t.stickiness="toNext";/* istanbul ignore if -- @preserve */if(!this.position.isEqual(t))throw new p("insertcontent-invalid-insertion-position",this);this.position=C._createAt(t.nodeBefore,"end");const n=$e.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(t)&&(this._affectedEnd.detach(),this._affectedEnd=$e._createAt(t.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=$e._createAt(t.nodeBefore,0,"toPrevious")),this.position=n.toPosition(),n.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_canMergeLeft(e){const t=e.previousSibling;return t instanceof Y&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(t,e)}_canMergeRight(e){const t=e.nextSibling;return t instanceof Y&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(e,t)}_tryAutoparagraphing(e){const t=this.writer.createElement("paragraph");this._getAllowedIn(this.position.parent,t)&&this.schema.checkChild(t,e)&&(t._appendChild(e),this._handleNode(t))}_checkAndAutoParagraphToAllowedPosition(e){if(this.schema.checkChild(this.position.parent,e))return!0;if(!this.schema.checkChild(this.position.parent,"paragraph")||!this.schema.checkChild("paragraph",e))return!1;this._insertPartialFragment();const t=this.writer.createElement("paragraph");return this.writer.insert(t,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=t,this.position=this.writer.createPositionAt(t,0),!0}_checkAndSplitToAllowedPosition(e){const t=this._getAllowedIn(this.position.parent,e);if(!t)return!1;for(t!=this.position.parent&&this._insertPartialFragment();t!=this.position.parent;)if(this.position.isAtStart){const n=this.position.parent;this.position=this.writer.createPositionBefore(n),n.isEmpty&&n.parent===t&&this.writer.remove(n)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const n=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=n,this.canMergeWith.add(this.position.nodeAfter)}return!0}_getAllowedIn(e,t){return this.schema.checkChild(e,t)?e:this.schema.isLimit(e)?null:this._getAllowedIn(e.parent,t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function YE(i,e,t,n={}){if(!i.schema.isObject(e))throw new p("insertobject-element-not-an-object",i,{object:e});const s=t||i.document.selection;let o=s;n.findOptimalPosition&&i.schema.isBlock(e)&&(o=i.createSelection(i.schema.findOptimalInsertionRange(s,n.findOptimalPosition)));const r=ce(s.getSelectedBlocks()),a={};return r&&Object.assign(a,i.schema.getAttributesWithProperty(r,"copyOnReplace",!0)),i.change(l=>{o.isCollapsed||i.deleteContent(o,{doNotAutoparagraph:!0});let c=e;const u=o.anchor.parent;!i.schema.checkChild(u,e)&&i.schema.checkChild(u,"paragraph")&&i.schema.checkChild("paragraph",e)&&(c=l.createElement("paragraph"),l.insert(e,c)),i.schema.setAllowedAttributes(c,a,l);const d=i.insertContent(c,o);return d.isCollapsed||n.setSelection&&XE(l,e,n.setSelection,a),d})}function XE(i,e,t,n){const s=i.model;if(t=="on"){i.setSelection(e,"on");return}if(t!="after")throw new p("insertobject-invalid-place-parameter-value",s);let o=e.nextSibling;if(s.schema.isInline(e)){i.setSelection(e,"after");return}!(o&&s.schema.checkChild(o,"$text"))&&s.schema.checkChild(e.parent,"paragraph")&&(o=i.createElement("paragraph"),s.schema.setAllowedAttributes(o,n,i),s.insertContent(o,i.createPositionAfter(e))),o&&i.setSelection(o,0)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const QE=' ,.?!:;"-()';function eA(i,e,t={}){const n=i.schema,s=t.direction!="backward",o=t.unit?t.unit:"character",r=!!t.treatEmojiAsSingleUnit,a=e.focus,l=new Kt({boundaries:sA(a,s),singleCharacters:!0,direction:s?"forward":"backward"}),c={walker:l,schema:n,isForward:s,unit:o,treatEmojiAsSingleUnit:r};let u;for(;u=l.next();){if(u.done)return;const d=tA(c,u.value);if(d){e instanceof kt?i.change(h=>{h.setSelectionFocus(d)}):e.setFocus(d);return}}}function tA(i,e){const{isForward:t,walker:n,unit:s,schema:o,treatEmojiAsSingleUnit:r}=i,{type:a,item:l,nextPosition:c}=e;if(a=="text")return i.unit==="word"?iA(n,t):nA(n,s,r);if(a==(t?"elementStart":"elementEnd")){if(o.isSelectable(l))return C._createAt(l,t?"after":"before");if(o.checkChild(c,"$text"))return c}else{if(o.isLimit(l)){n.skip(()=>!0);return}if(o.checkChild(c,"$text"))return c}}function nA(i,e,t){const n=i.position.textNode;if(n){const s=n.data;let o=i.position.offset-n.startOffset;for(;tl(s,o)||e=="character"&&nl(s,o)||t&&xh(s,o);)i.next(),o=i.position.offset-n.startOffset}return i.position}function iA(i,e){let t=i.position.textNode;for(t||(t=e?i.position.nodeAfter:i.position.nodeBefore);t&&t.is("$text");){const n=i.position.offset-t.startOffset;if(rA(t,n,e))t=e?i.position.nodeAfter:i.position.nodeBefore;else{if(oA(t.data,n,e))break;i.next()}}return i.position}function sA(i,e){const t=i.root,n=C._createAt(t,e?"end":0);return e?new v(i,n):new v(n,i)}function oA(i,e,t){const n=e+(t?0:-1);return QE.includes(i.charAt(n))}function rA(i,e,t){return e===(t?i.offsetSize:0)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let aA=class extends re(){constructor(){super(),this.markers=new BE,this.document=new ME(this),this.schema=new KT,this._pendingChanges=[],this._currentWriter=null,["deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(e=>this.decorate(e)),this.on("applyOperation",(e,t)=>{t[0]._validate()},{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$container",{allowIn:["$root","$container"]}),this.schema.register("$block",{allowIn:["$root","$container"],isBlock:!0}),this.schema.register("$blockObject",{allowWhere:"$block",isBlock:!0,isObject:!0}),this.schema.register("$inlineObject",{allowWhere:"$text",allowAttributesOf:"$text",isInline:!0,isObject:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$marker"),this.schema.addChildCheck((e,t)=>{if(t.name==="$marker")return!0}),FT(this),this.document.registerPostFixer(Ef),this.on("insertContent",(e,[t,n])=>{e.return=ZE(this,t,n)}),this.on("insertObject",(e,[t,n,s])=>{e.return=YE(this,t,n,s)}),this.on("canEditAt",e=>{const t=!this.document.isReadOnly;e.return=t,t||e.stop()})}change(e){try{return this._pendingChanges.length===0?(this._pendingChanges.push({batch:new wi,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(t){/* istanbul ignore next -- @preserve */p.rethrowUnexpectedError(t,this)}}enqueueChange(e,t){try{e?typeof e=="function"?(t=e,e=new wi):e instanceof wi||(e=new wi(e)):e=new wi,this._pendingChanges.push({batch:e,callback:t}),this._pendingChanges.length==1&&this._runPendingChanges()}catch(n){/* istanbul ignore next -- @preserve */p.rethrowUnexpectedError(n,this)}}applyOperation(e){e._execute()}insertContent(e,t,n,...s){const o=Al(t,n);return this.fire("insertContent",[e,o,n,...s])}insertObject(e,t,n,s,...o){const r=Al(t,n);return this.fire("insertObject",[e,r,s,s,...o])}deleteContent(e,t){NE(this,e,t)}modifySelection(e,t){eA(this,e,t)}getSelectedContent(e){return KE(this,e)}hasContent(e,t={}){const n=e instanceof v?e:v._createIn(e);if(n.isCollapsed)return!1;const{ignoreWhitespaces:s=!1,ignoreMarkers:o=!1}=t;if(!o){for(const r of this.markers.getMarkersIntersectingRange(n))if(r.affectsData)return!0}for(const r of n.getItems())if(this.schema.isContent(r))if(r.is("$textProxy"))if(s){if(r.data.search(/\S/)!==-1)return!0}else return!0;else return!0;return!1}canEditAt(e){const t=Al(e);return this.fire("canEditAt",[t])}createPositionFromPath(e,t,n){return new C(e,t,n)}createPositionAt(e,t){return C._createAt(e,t)}createPositionAfter(e){return C._createAfter(e)}createPositionBefore(e){return C._createBefore(e)}createRange(e,t){return new v(e,t)}createRangeIn(e){return v._createIn(e)}createRangeOn(e){return v._createOn(e)}createSelection(...e){return new Ze(...e)}createBatch(e){return new wi(e)}createOperationFromJSON(e){return vE.fromJSON(e,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];this.fire("_beforeChanges");try{for(;this._pendingChanges.length;){const t=this._pendingChanges[0].batch;this._currentWriter=new VE(this,t);const n=this._pendingChanges[0].callback(this._currentWriter);e.push(n),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}}finally{this._pendingChanges.length=0,this._currentWriter=null,this.fire("_afterChanges")}return e}};function Al(i,e){if(i)return i instanceof Ze||i instanceof kt?i:i instanceof Rn?e||e===0?new Ze(i,e):i.is("rootElement")?new Ze(i,"in"):new Ze(i,"on"):new Ze(i)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class lA extends cn{constructor(){super(...arguments),this.domEventType="click"}onDomEvent(e){this.fire(e.type,e)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class xl extends cn{constructor(){super(...arguments),this.domEventType=["mousedown","mouseup","mouseover","mouseout"]}onDomEvent(e){this.fire(e.type,e)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ye{constructor(e){this.document=e}createDocumentFragment(e){return new Pn(this.document,e)}createElement(e,t,n){return new vt(this.document,e,t,n)}createText(e){return new le(this.document,e)}clone(e,t=!1){return e._clone(t)}appendChild(e,t){return t._appendChild(e)}insertChild(e,t,n){return n._insertChild(e,t)}removeChildren(e,t,n){return n._removeChildren(e,t)}remove(e){const t=e.parent;return t?this.removeChildren(t.getChildIndex(e),1,t):[]}replace(e,t){const n=e.parent;if(n){const s=n.getChildIndex(e);return this.removeChildren(s,1,n),this.insertChild(s,t,n),!0}return!1}unwrapElement(e){const t=e.parent;if(t){const n=t.getChildIndex(e);this.remove(e),this.insertChild(n,e.getChildren(),t)}}rename(e,t){const n=new vt(this.document,e,t.getAttributes(),t.getChildren());return this.replace(t,n)?n:null}setAttribute(e,t,n){n._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,n){De(e)&&n===void 0?t._setStyle(e):n._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,n){n._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}createPositionAt(e,t){return x._createAt(e,t)}createPositionAfter(e){return x._createAfter(e)}createPositionBefore(e){return x._createBefore(e)}createRange(e,t){return new H(e,t)}createRangeOn(e){return H._createOn(e)}createRangeIn(e){return H._createIn(e)}createSelection(...e){return new Gt(...e)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const cA=/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i,uA=/^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i,dA=/^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,hA=/^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i,fA=/^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,mA=/\w+\((?:[^()]|\([^()]*\))*\)|\S+/gi,gA=new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext","rebeccapurple","currentcolor","transparent"]);function nm(i){return i.startsWith("#")?cA.test(i):i.startsWith("rgb")?uA.test(i)||dA.test(i):i.startsWith("hsl")?hA.test(i)||fA.test(i):gA.has(i.toLowerCase())}const pA=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"];function bA(i){return pA.includes(i)}const wA=/^([+-]?[0-9]*([.][0-9]+)?(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/;function Sl(i){return wA.test(i)}const _A=/^[+-]?[0-9]*([.][0-9]+)?%$/;function vA(i){return _A.test(i)}const yA=["repeat-x","repeat-y","repeat","space","round","no-repeat"];function CA(i){return yA.includes(i)}const kA=["center","top","bottom","left","right"];function TA(i){return kA.includes(i)}const EA=["fixed","scroll","local"];function AA(i){return EA.includes(i)}const xA=/^url\(/;function SA(i){return xA.test(i)}function Ts(i=""){if(i==="")return{top:void 0,right:void 0,bottom:void 0,left:void 0};const e=Il(i),t=e[0],n=e[2]||t,s=e[1]||t,o=e[3]||s;return{top:t,bottom:n,right:s,left:o}}function Es(i){return e=>{const{top:t,right:n,bottom:s,left:o}=e,r=[];return[t,n,o,s].every(a=>!!a)?r.push([i,IA(e)]):(t&&r.push([i+"-top",t]),n&&r.push([i+"-right",n]),s&&r.push([i+"-bottom",s]),o&&r.push([i+"-left",o])),r}}function IA({top:i,right:e,bottom:t,left:n}){const s=[];return n!==e?s.push(i,e,t,n):t!==i?s.push(i,e,t):e!==i?s.push(i,e):s.push(i),s.join(" ")}function im(i){return e=>({path:i,value:Ts(e)})}function Il(i){const e=i.matchAll(mA);return Array.from(e).map(t=>t[0])}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function sm(i){i.setNormalizer("background",PA()),i.setNormalizer("background-color",RA()),i.setReducer("background",MA()),i.setStyleRelation("background",["background-color"])}function PA(){return i=>{const e={},t=Il(i);for(const n of t)CA(n)?(e.repeat=e.repeat||[],e.repeat.push(n)):TA(n)?(e.position=e.position||[],e.position.push(n)):AA(n)?e.attachment=n:nm(n)?e.color=n:SA(n)&&(e.image=n);return{path:"background",value:e}}}function RA(){return i=>({path:"background.color",value:i})}function MA(){return i=>{const e=[];return e.push(["background-color",i.color]),e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function om(i){i.setNormalizer("border",BA()),i.setNormalizer("border-top",qo("top")),i.setNormalizer("border-right",qo("right")),i.setNormalizer("border-bottom",qo("bottom")),i.setNormalizer("border-left",qo("left")),i.setNormalizer("border-color",Pl("color")),i.setNormalizer("border-width",Pl("width")),i.setNormalizer("border-style",Pl("style")),i.setNormalizer("border-top-color",lt("color","top")),i.setNormalizer("border-top-style",lt("style","top")),i.setNormalizer("border-top-width",lt("width","top")),i.setNormalizer("border-right-color",lt("color","right")),i.setNormalizer("border-right-style",lt("style","right")),i.setNormalizer("border-right-width",lt("width","right")),i.setNormalizer("border-bottom-color",lt("color","bottom")),i.setNormalizer("border-bottom-style",lt("style","bottom")),i.setNormalizer("border-bottom-width",lt("width","bottom")),i.setNormalizer("border-left-color",lt("color","left")),i.setNormalizer("border-left-style",lt("style","left")),i.setNormalizer("border-left-width",lt("width","left")),i.setExtractor("border-top",Go("top")),i.setExtractor("border-right",Go("right")),i.setExtractor("border-bottom",Go("bottom")),i.setExtractor("border-left",Go("left")),i.setExtractor("border-top-color","border.color.top"),i.setExtractor("border-right-color","border.color.right"),i.setExtractor("border-bottom-color","border.color.bottom"),i.setExtractor("border-left-color","border.color.left"),i.setExtractor("border-top-width","border.width.top"),i.setExtractor("border-right-width","border.width.right"),i.setExtractor("border-bottom-width","border.width.bottom"),i.setExtractor("border-left-width","border.width.left"),i.setExtractor("border-top-style","border.style.top"),i.setExtractor("border-right-style","border.style.right"),i.setExtractor("border-bottom-style","border.style.bottom"),i.setExtractor("border-left-style","border.style.left"),i.setReducer("border-color",Es("border-color")),i.setReducer("border-style",Es("border-style")),i.setReducer("border-width",Es("border-width")),i.setReducer("border-top",Ko("top")),i.setReducer("border-right",Ko("right")),i.setReducer("border-bottom",Ko("bottom")),i.setReducer("border-left",Ko("left")),i.setReducer("border",LA()),i.setStyleRelation("border",["border-color","border-style","border-width","border-top","border-right","border-bottom","border-left","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","border-top-width","border-right-width","border-bottom-width","border-left-width"]),i.setStyleRelation("border-color",["border-top-color","border-right-color","border-bottom-color","border-left-color"]),i.setStyleRelation("border-style",["border-top-style","border-right-style","border-bottom-style","border-left-style"]),i.setStyleRelation("border-width",["border-top-width","border-right-width","border-bottom-width","border-left-width"]),i.setStyleRelation("border-top",["border-top-color","border-top-style","border-top-width"]),i.setStyleRelation("border-right",["border-right-color","border-right-style","border-right-width"]),i.setStyleRelation("border-bottom",["border-bottom-color","border-bottom-style","border-bottom-width"]),i.setStyleRelation("border-left",["border-left-color","border-left-style","border-left-width"])}function BA(){return i=>{const{color:e,style:t,width:n}=rm(i);return{path:"border",value:{color:Ts(e),style:Ts(t),width:Ts(n)}}}}function qo(i){return e=>{const{color:t,style:n,width:s}=rm(e),o={};return t!==void 0&&(o.color={[i]:t}),n!==void 0&&(o.style={[i]:n}),s!==void 0&&(o.width={[i]:s}),{path:"border",value:o}}}function Pl(i){return e=>({path:"border",value:OA(e,i)})}function OA(i,e){return{[e]:Ts(i)}}function lt(i,e){return t=>({path:"border",value:{[i]:{[e]:t}}})}function Go(i){return(e,t)=>{if(t.border)return As(t.border,i)}}function As(i,e){const t={};return i.width&&i.width[e]&&(t.width=i.width[e]),i.style&&i.style[e]&&(t.style=i.style[e]),i.color&&i.color[e]&&(t.color=i.color[e]),t}function rm(i){const e={},t=Il(i);for(const n of t)Sl(n)||/thin|medium|thick/.test(n)?e.width=n:bA(n)?e.style=n:e.color=n;return e}function LA(){return e=>{const t=As(e,"top"),n=As(e,"right"),s=As(e,"bottom"),o=As(e,"left"),r=[t,n,s,o],a={width:i(r,"width"),style:i(r,"style"),color:i(r,"color")},l=vi(a,"all");return l.length?l:[...Object.entries(a).reduce((u,[d,h])=>(h&&(u.push([`border-${d}`,h]),r.forEach(f=>delete f[d])),u),[]),...vi(t,"top"),...vi(n,"right"),...vi(s,"bottom"),...vi(o,"left")]};function i(e,t){return e.map(n=>n[t]).reduce((n,s)=>n==s?n:null)}}function Ko(i){return e=>vi(e,i)}function vi(i,e){const t=[];if(i&&i.width&&t.push("width"),i&&i.style&&t.push("style"),i&&i.color&&t.push("color"),t.length==3){const n=t.map(s=>i[s]).join(" ");return[e=="all"?["border",n]:[`border-${e}`,n]]}return e=="all"?[]:t.map(n=>[`border-${e}-${n}`,i[n]])}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function VA(i){i.setNormalizer("margin",im("margin")),i.setNormalizer("margin-top",e=>({path:"margin.top",value:e})),i.setNormalizer("margin-right",e=>({path:"margin.right",value:e})),i.setNormalizer("margin-bottom",e=>({path:"margin.bottom",value:e})),i.setNormalizer("margin-left",e=>({path:"margin.left",value:e})),i.setReducer("margin",Es("margin")),i.setStyleRelation("margin",["margin-top","margin-right","margin-bottom","margin-left"])}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function DA(i){i.setNormalizer("padding",im("padding")),i.setNormalizer("padding-top",e=>({path:"padding.top",value:e})),i.setNormalizer("padding-right",e=>({path:"padding.right",value:e})),i.setNormalizer("padding-bottom",e=>({path:"padding.bottom",value:e})),i.setNormalizer("padding-left",e=>({path:"padding.left",value:e})),i.setReducer("padding",Es("padding")),i.setStyleRelation("padding",["padding-top","padding-right","padding-bottom","padding-left"])}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class NA{constructor(){this._commands=new Map}add(e,t){this._commands.set(e,t)}get(e){return this._commands.get(e)}execute(e,...t){const n=this.get(e);if(!n)throw new p("commandcollection-command-not-found",this,{commandName:e});return n.execute(...t)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const e of this.commands())e.destroy()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class FA extends Te{constructor(e){super(),this.editor=e}set(e,t,n={}){if(typeof t=="string"){const s=t;t=(o,r)=>{this.editor.execute(s),r()}}super.set(e,t,n)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Rl="contentEditing",am="common";class $A{constructor(e){this.keystrokeInfos=new Map,this._editor=e;const t=e.config.get("menuBar.isVisible"),n=e.locale.t;this.addKeystrokeInfoCategory({id:Rl,label:n("Content editing keystrokes"),description:n("These keyboard shortcuts allow for quick access to content editing features.")});const s=[{label:n("Close contextual balloons, dropdowns, and dialogs"),keystroke:"Esc"},{label:n("Open the accessibility help dialog"),keystroke:"Alt+0"},{label:n("Move focus between form fields (inputs, buttons, etc.)"),keystroke:[["Tab"],["Shift+Tab"]]},{label:n("Move focus to the toolbar, navigate between toolbars"),keystroke:"Alt+F10",mayRequireFn:!0},{label:n("Navigate through the toolbar or menu bar"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]},{label:n("Execute the currently focused button. Executing buttons that interact with the editor content moves the focus back to the content."),keystroke:[["Enter"],["Space"]]}];t&&s.push({label:n("Move focus to the menu bar, navigate between menu bars"),keystroke:"Alt+F9",mayRequireFn:!0}),this.addKeystrokeInfoCategory({id:"navigation",label:n("User interface and content navigation keystrokes"),description:n("Use the following keystrokes for more efficient navigation in the CKEditor 5 user interface."),groups:[{id:"common",keystrokes:s}]})}addKeystrokeInfoCategory({id:e,label:t,description:n,groups:s}){this.keystrokeInfos.set(e,{id:e,label:t,description:n,groups:new Map}),this.addKeystrokeInfoGroup({categoryId:e,id:am}),s&&s.forEach(o=>{this.addKeystrokeInfoGroup({categoryId:e,...o})})}addKeystrokeInfoGroup({categoryId:e=Rl,id:t,label:n,keystrokes:s}){const o=this.keystrokeInfos.get(e);if(!o)throw new p("accessibility-unknown-keystroke-info-category",this._editor,{groupId:t,categoryId:e});o.groups.set(t,{id:t,label:n,keystrokes:s||[]})}addKeystrokeInfos({categoryId:e=Rl,groupId:t=am,keystrokes:n}){if(!this.keystrokeInfos.has(e))throw new p("accessibility-unknown-keystroke-info-category",this._editor,{categoryId:e,keystrokes:n});const s=this.keystrokeInfos.get(e);if(!s.groups.has(t))throw new p("accessibility-unknown-keystroke-info-group",this._editor,{groupId:t,categoryId:e,keystrokes:n});s.groups.get(t).keystrokes.push(...n)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class UA extends re(){constructor(e={}){super();const t=this.constructor,{translations:n,...s}=t.defaultConfig||{},{translations:o=n,...r}=e,a=e.language||s.language;this._context=e.context||new Mh({language:a,translations:o}),this._context._addEditor(this,!e.context);const l=Array.from(t.builtinPlugins||[]);this.config=new sh(r,s),this.config.define("plugins",l),this.config.define(this._context._getEditorConfig()),this.plugins=new Rh(this,l,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this._readOnlyLocks=new Set,this.commands=new NA,this.set("state","initializing"),this.once("ready",()=>this.state="ready",{priority:"high"}),this.once("destroy",()=>this.state="destroyed",{priority:"high"}),this.model=new aA,this.on("change:isReadOnly",()=>{this.model.document.isReadOnly=this.isReadOnly});const c=new G5;this.data=new pE(this.model,c),this.editing=new jT(this.model,c),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new wE([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new FA(this),this.keystrokes.listenTo(this.editing.view.document),this.accessibility=new $A(this)}get isReadOnly(){return this._readOnlyLocks.size>0}set isReadOnly(e){throw new p("editor-isreadonly-has-no-setter")}enableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new p("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)||(this._readOnlyLocks.add(e),this._readOnlyLocks.size===1&&this.fire("change:isReadOnly","isReadOnly",!0,!1))}disableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new p("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)&&(this._readOnlyLocks.delete(e),this._readOnlyLocks.size===0&&this.fire("change:isReadOnly","isReadOnly",!1,!0))}setData(e){this.data.set(e)}getData(e){return this.data.get(e)}initPlugins(){const e=this.config,t=e.get("plugins"),n=e.get("removePlugins")||[],s=e.get("extraPlugins")||[],o=e.get("substitutePlugins")||[];return this.plugins.init(t.concat(s),n,o)}destroy(){let e=Promise.resolve();return this.state=="initializing"&&(e=new Promise(t=>this.once("ready",t))),e.then(()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()}).then(()=>this.plugins.destroy()).then(()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()}).then(()=>this._context._removeEditor(this))}execute(e,...t){try{return this.commands.execute(e,...t)}catch(n){/* istanbul ignore next -- @preserve */p.rethrowUnexpectedError(n,this)}}focus(){this.editing.view.focus()}static create(...e){throw new Error("This is an abstract method.")}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function zA(i){if(!vn(i.updateSourceElement))throw new p("attachtoform-missing-elementapi-interface",i);const e=i.sourceElement;if(HA(e)&&e.form){let t;const n=e.form,s=()=>i.updateSourceElement();vn(n.submit)&&(t=n.submit,n.submit=()=>{s(),t.apply(n)}),n.addEventListener("submit",s),i.on("destroy",()=>{n.removeEventListener("submit",s),t&&(n.submit=t)})}}function HA(i){return!!i&&i.tagName.toLowerCase()==="textarea"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ml(i){class e extends i{updateSourceElement(n){if(!this.sourceElement)throw new p("editor-missing-sourceelement",this);const s=this.config.get("updateSourceElementOnDestroy"),o=this.sourceElement instanceof HTMLTextAreaElement;if(!s&&!o){fh(this.sourceElement,"");return}const r=typeof n=="string"?n:this.data.get();fh(this.sourceElement,r)}}return e}Ml.updateSourceElement=Ml(Object).prototype.updateSourceElement;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class WA extends O5{static get pluginName(){return"PendingActions"}init(){this.set("hasAny",!1),this._actions=new Oe({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}add(e){if(typeof e!="string")throw new p("pendingactions-add-invalid-message",this);const t=new(re());return t.set("message",e),this._actions.add(t),this.hasAny=!0,t}remove(e){this._actions.remove(e),this.hasAny=!!this._actions.length}get first(){return this._actions.get(0)}[Symbol.iterator](){return this._actions[Symbol.iterator]()}}const jA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',qA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 16h9a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2z"/><path d="M17 1a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14zm0 1.5H3a.5.5 0 0 0-.492.41L2.5 3v9a.5.5 0 0 0 .41.492L3 12.5h14a.5.5 0 0 0 .492-.41L17.5 12V3a.5.5 0 0 0-.41-.492L17 2.5z" fill-opacity=".6"/></svg>',GA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',KA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.333 2 .19 2.263a5.899 5.899 0 0 1 1.458.604L14.714 3.4 16.6 5.286l-1.467 1.733c.263.452.468.942.605 1.46L18 8.666v2.666l-2.263.19a5.899 5.899 0 0 1-.604 1.458l1.467 1.733-1.886 1.886-1.733-1.467a5.899 5.899 0 0 1-1.46.605L11.334 18H8.667l-.19-2.263a5.899 5.899 0 0 1-1.458-.604L5.286 16.6 3.4 14.714l1.467-1.733a5.899 5.899 0 0 1-.604-1.458L2 11.333V8.667l2.262-.189a5.899 5.899 0 0 1 .605-1.459L3.4 5.286 5.286 3.4l1.733 1.467a5.899 5.899 0 0 1 1.46-.605L8.666 2h2.666zM10 6.267a3.733 3.733 0 1 0 0 7.466 3.733 3.733 0 0 0 0-7.466z"/></svg>',ZA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.209 18.717A8.5 8.5 0 1 1 18.686 9.6h-.008l.002.12a3 3 0 0 1-2.866 2.997h-.268l-.046-.002v.002h-4.791a2 2 0 1 0 0 4 1 1 0 1 1-.128 1.992 8.665 8.665 0 0 1-.372.008Zm-3.918-7.01a1.25 1.25 0 1 0-2.415-.648 1.25 1.25 0 0 0 2.415.647ZM5.723 8.18a1.25 1.25 0 1 0 .647-2.414 1.25 1.25 0 0 0-.647 2.414ZM9.76 6.155a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Zm4.028 1.759a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Z"/></svg>',JA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m8.636 9.531-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>',YA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11 1a9 9 0 1 1-8.027 13.075l1.128-1.129A7.502 7.502 0 0 0 18.5 10a7.5 7.5 0 1 0-14.962.759l-.745-.746-.76.76A9 9 0 0 1 11 1z"/><path d="M.475 8.17a.75.75 0 0 1 .978.047l.075.082 1.284 1.643 1.681-1.284a.75.75 0 0 1 .978.057l.073.083a.75.75 0 0 1-.057.978l-.083.073-2.27 1.737a.75.75 0 0 1-.973-.052l-.074-.082-1.741-2.23a.75.75 0 0 1 .13-1.052z"/><path d="M11.5 5v4.999l3.196 3.196-1.06 1.06L10.1 10.72l-.1-.113V5z"/></svg>',XA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22 2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>',QA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.035 1C2.446 1 2 1.54 2 2.098V10.5h1.5v-8h13v8H18V2.098C18 1.539 17.48 1 16.9 1H3.035Zm10.453 2.61a1.885 1.885 0 0 0-1.442.736 1.89 1.89 0 0 0 1.011 2.976 1.903 1.903 0 0 0 2.253-1.114 1.887 1.887 0 0 0-1.822-2.598ZM7.463 8.163a.611.611 0 0 0-.432.154L5.071 10.5h5.119L7.88 8.348a.628.628 0 0 0-.417-.185Zm6.236 1.059a.62.62 0 0 0-.42.164L12.07 10.5h2.969l-.92-1.113a.618.618 0 0 0-.42-.165ZM.91 11.5a.91.91 0 0 0-.91.912v6.877c0 .505.405.91.91.91h18.178a.91.91 0 0 0 .912-.91v-6.877a.908.908 0 0 0-.912-.912H.91ZM3.668 13h1.947l2.135 5.7H5.898l-.28-.946H3.601l-.278.945H1.516L3.668 13Zm4.947 0h1.801v4.3h2.7v1.4h-4.5V13h-.001Zm4.5 0h5.4v1.4h-1.798v4.3h-1.701v-4.3h-1.9V13h-.001Zm-8.517 1.457-.614 2.059h1.262l-.648-2.059Z"/></svg>',ex='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.68 13.74h-.001l4.209 4.208a1 1 0 1 0 1.414-1.414l-4.267-4.268a6 6 0 1 0-1.355 1.474ZM13 9a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z"/></svg>',tx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>',nx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>',ix='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.66 9.118a.693.693 0 0 1 .956.032l3.65 3.411 2.422-2.238a.695.695 0 0 1 .945 0L17.5 13.6V2.5h-15v11.1l4.16-4.482ZM17.8 1c.652 0 1.2.47 1.2 1.1v14.362c0 .64-.532 1.038-1.184 1.038H2.184C1.532 17.5 1 17.103 1 16.462V2.1C1 1.47 1.537 1 2.2 1h15.6Zm-5.655 6a2.128 2.128 0 0 1 .157-2.364A2.133 2.133 0 1 1 12.145 7Z"/></svg>',sx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037h9.494a2.97 2.97 0 0 1-.414-.287 2.998 2.998 0 0 1-1.055-2.03 3.003 3.003 0 0 1 .693-2.185l.383-.455-.02.018-3.65-3.41a.695.695 0 0 0-.957-.034L1.5 13.6V2.5h15v5.535a2.97 2.97 0 0 1 1.412.932l.088.105V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.146 2.146 0 0 0-2.049 1.992 2.14 2.14 0 0 0 1.28 2.096 2.13 2.13 0 0 0 2.644-3.11 2.134 2.134 0 0 0-1.875-.978Z"/><path d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.784.784 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79Z"/><path d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.784.784 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79Z"/></svg>',ox='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1c-.662 0-1.2.47-1.2 1.1v14.248c0 .64.533 1.152 1.185 1.152h6.623v-7.236L6.617 9.15a.694.694 0 0 0-.957-.033L1.602 13.55V2.553l14.798.003V9.7H18V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.723 2.805a2.094 2.094 0 0 0-1.621.832 2.127 2.127 0 0 0 1.136 3.357 2.13 2.13 0 0 0 2.611-1.506 2.133 2.133 0 0 0-.76-2.244 2.13 2.13 0 0 0-1.366-.44Z"/><path clip-rule="evenodd" d="M19.898 12.369v6.187a.844.844 0 0 1-.844.844h-8.719a.844.844 0 0 1-.843-.844v-7.312a.844.844 0 0 1 .843-.844h2.531a.843.843 0 0 1 .597.248l.838.852h4.75c.223 0 .441.114.6.272a.844.844 0 0 1 .247.597Zm-1.52.654-4.377.02-1.1-1.143H11v6h7.4l-.023-4.877Z"/></svg>',rx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037h7.029a5.401 5.401 0 0 1 .615-4.338l.762-1.232-2.975-2.78a.696.696 0 0 0-.957-.033L1.5 13.6V2.5h15v6.023c.449.131.887.32 1.307.573l.058.033c.046.028.09.057.135.086V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.15 2.15 0 0 0-1.611.834 2.118 2.118 0 0 0-.438 1.158 2.14 2.14 0 0 0 1.277 2.096 2.132 2.132 0 0 0 2.645-3.11 2.13 2.13 0 0 0-1.873-.978Z"/><path d="M16.63 10.294a3.003 3.003 0 0 0-4.142.887l-.117.177a.647.647 0 0 0-.096.492.664.664 0 0 0 .278.418.7.7 0 0 0 .944-.234 1.741 1.741 0 0 1 2.478-.463 1.869 1.869 0 0 1 .476 2.55.637.637 0 0 0-.071.5.646.646 0 0 0 .309.396.627.627 0 0 0 .869-.19l.027-.041a3.226 3.226 0 0 0-.956-4.492Zm-6.061 3.78-.044.066a3.228 3.228 0 0 0 .82 4.403 3.005 3.005 0 0 0 4.275-.798l.13-.197a.626.626 0 0 0 .092-.475.638.638 0 0 0-.268-.402.713.713 0 0 0-.99.26l-.018.029a1.741 1.741 0 0 1-2.477.461 1.87 1.87 0 0 1-.475-2.55l.029-.047a.647.647 0 0 0 .086-.485.66.66 0 0 0-.275-.408l-.04-.027a.609.609 0 0 0-.845.17Z"/><path d="M15.312 13.925c.24-.36.154-.838-.19-1.067-.346-.23-.82-.124-1.059.236l-1.268 1.907c-.239.36-.153.838.192 1.067.345.23.818.123 1.057-.236l1.268-1.907Z"/></svg>',ax='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.239 13.938-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.752.752 0 0 1-.511.187.752.752 0 0 1-.511-.187zM4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5H4.25z"/></svg>',lx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 11.875a.752.752 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.752.752 0 0 1-.508.184.752.752 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75z"/></svg>',cx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m10.261 7.062 2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .511-.187.752.752 0 0 1 .511.187zM15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5h10.5z"/></svg>',ux='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',dx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>',hx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>',fx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',mx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',gx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M15.003 7v5.5a1 1 0 0 1-1 1H5.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H6.5V12h6.997V7.5z"/></svg>',px='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',bx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18 7v5.5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1zm-1.505.5H3.504V12h12.991V7.5z"/></svg>',wx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',_x='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zm0-3H18v1.5h-4.5zm0-3H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',vx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2zm0-9h5v1.5H2zm0 3h5v1.5H2zm0 3h5v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',yx='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M18.095 2H1.905C.853 2 0 2.895 0 4v12c0 1.105.853 2 1.905 2h16.19C19.147 18 20 17.105 20 16V4c0-1.105-.853-2-1.905-2zm0 1.5c.263 0 .476.224.476.5v12c0 .276-.213.5-.476.5H1.905a.489.489 0 0 1-.476-.5V4c0-.276.213-.5.476-.5h16.19z"/></svg>',Cx='<svg xmlns="http://www.w3.org/2000/svg" xmlns:v="https://vecta.io/nano" viewBox="0 0 20 20"><path d="M.95 1.43a.95.95 0 0 0-.95.95v3.1a.95.95 0 0 0 .95.95h.75v6.3H.95a.95.95 0 0 0-.95.95v3.1a.95.95 0 0 0 .95.95h3.1a.95.95 0 0 0 .95-.95v-.65h1.932l1.539-1.5H5v-.95a.95.95 0 0 0-.95-.95H3.2v-6.3h.85A.95.95 0 0 0 5 5.48v-.55h10v.55a.95.95 0 0 0 .95.95h3.1a.95.95 0 0 0 .95-.95v-3.1a.95.95 0 0 0-.95-.95h-3.1a.95.95 0 0 0-.95.95v1.05H5V2.38a.95.95 0 0 0-.95-.95H.95zm.55 3.5v-2h2v2h-2zm0 9.3v2h2v-2h-2zm15-11.3v2h2v-2h-2z"/><path d="M8.139 20.004v-2.388l7.045-7.048 2.391 2.391-7.046 7.046h-2.39zm11.421-9.101a.64.64 0 0 1-.138.206l-1.165 1.168-2.391-2.391 1.167-1.163a.63.63 0 0 1 .206-.138.635.635 0 0 1 .243-.049.63.63 0 0 1 .449.187l1.491 1.488c.059.059.108.129.138.206s.049.16.049.243a.6.6 0 0 1-.049.243z"/></svg>',kx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M13 5.5H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2ZM13 7a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-8A.5.5 0 0 1 2 7h11Z"/></svg>',Tx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M7 9.5H2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2ZM7 11a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-4A.5.5 0 0 1 2 11h5Z"/></svg>',Ex='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M10 7.5H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2ZM10 9a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-6A.5.5 0 0 1 2 9h8Z"/></svg>',Ax='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.3 17.37-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5 9.375 17H19v1.5H8z"/></svg>',xx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4z"/></svg>',Sx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>',Ix='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>',Px='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M5 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M5 16.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 16.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/></svg>',Rx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>',Mx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.5 5.5H7v5h3.5a2.5 2.5 0 1 0 0-5zM5 3h6.5v.025a5 5 0 0 1 0 9.95V13H7v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z"/></svg>',Bx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 0 0-1 1v6H3a1 1 0 1 0 0 2h6v6a1 1 0 1 0 2 0v-6h6a1 1 0 1 0 0-2h-6V3a1 1 0 0 0-1-1Z"/></svg>',Ox='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555Zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13Z"/><path d="m12.09 17-.534-1.292.848-1.971.545 1.319L12.113 17h-.023Zm1.142-5.187.545 1.319L15.5 9.13l1.858 4.316h-3.45l.398.965h3.467L18.887 17H20l-3.873-9h-1.254l-1.641 3.813Z"/></svg>',Lx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M19 4.5 14 0H3v12.673l.868-1.041c.185-.222.4-.402.632-.54V1.5h8v5h5v7.626a2.24 2.24 0 0 1 1.5.822V4.5ZM14 5V2l3.3 3H14Zm-3.692 12.5c.062.105.133.206.213.303L11.52 19H8v-.876a2.243 2.243 0 0 0 1.82-.624h.488Zm7.518-.657a.75.75 0 0 0-1.152-.96L15.5 17.29V12H14v5.29l-1.174-1.408a.75.75 0 0 0-1.152.96l2.346 2.816a.95.95 0 0 0 1.46 0l2.346-2.815Zm-15.056-.38a.75.75 0 0 1-.096-1.056l2.346-2.815a.95.95 0 0 1 1.46 0l2.346 2.815a.75.75 0 1 1-1.152.96L6.5 14.96V20H5v-5.04l-1.174 1.408a.75.75 0 0 1-1.056.096Z"/></svg>',Vx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14.958 9.367-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>',Dx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m5.042 9.367 2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',Nx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>',Fx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',$x='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m2.315 14.705 2.224-2.24a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .949L2.865 16.07a.682.682 0 0 1-.112.089.647.647 0 0 1-.852-.051L.688 14.886a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.717.722zm5.185.045a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75zM2.329 5.745l2.21-2.226a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .95L2.865 7.125a.685.685 0 0 1-.496.196.644.644 0 0 1-.468-.187L.688 5.912a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.73.736zM7.5 5.75A.75.75 0 0 1 8.25 5h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',Ux='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.87 12.61a.75.75 0 0 1-.089.976l-.085.07-3.154 2.254 3.412 2.414a.75.75 0 0 1 .237.95l-.057.095a.75.75 0 0 1-.95.237l-.096-.058-4.272-3.022-.003-1.223 4.01-2.867a.75.75 0 0 1 1.047.174zm2.795-.231.095.057 4.011 2.867-.003 1.223-4.272 3.022-.095.058a.75.75 0 0 1-.88-.151l-.07-.086-.058-.095a.75.75 0 0 1 .15-.88l.087-.07 3.412-2.414-3.154-2.253-.085-.071a.75.75 0 0 1 .862-1.207zM16 0a2 2 0 0 1 2 2v9.354l-.663-.492-.837-.001V2a.5.5 0 0 0-.5-.5H2a.5.5 0 0 0-.5.5v15a.5.5 0 0 0 .5.5h3.118L7.156 19H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h14zM5.009 15l.003 1H3v-1h2.009zm2.188-2-1.471 1H5v-1h2.197zM10 11v.095L8.668 12H7v-1h3zm4-2v1H7V9h7zm0-2v1H7V7h7zm-4-2v1H5V5h5zM6 3v1H3V3h3z"/></svg>',zx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.627 16.5zm5.873-.196zm0-7.001V8h-13v8.5h4.341c.191.54.457 1.044.785 1.5H2a1.5 1.5 0 0 1-1.5-1.5v-13A1.5 1.5 0 0 1 2 2h4.5a1.5 1.5 0 0 1 1.06.44L9.122 4H16a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 19 8v2.531a6.027 6.027 0 0 0-1.5-1.228zM16 6.5v-1H8.5l-2-2H2v13h1V8a1.5 1.5 0 0 1 1.5-1.5H16z"/><path d="M14.5 19.5a5 5 0 1 1 0-10 5 5 0 0 1 0 10zM15 14v-2h-1v2h-2v1h2v2h1v-2h2v-1h-2z"/></svg>',Hx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M19 9v10h-2v-8h-2V9h4zM4 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H10a1 1 0 0 1-1-1V11H4v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H3a1 1 0 0 1 1 1v4.5z"/></svg>',Wx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V11H3v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H2a1 1 0 0 1 1 1v4.5zm16.076 8.343V18.5h-6.252c.067-.626.27-1.22.61-1.78.338-.561 1.006-1.305 2.005-2.232.804-.749 1.297-1.257 1.479-1.523.245-.368.368-.732.368-1.092 0-.398-.107-.703-.32-.917-.214-.214-.51-.32-.886-.32-.372 0-.669.111-.889.336-.22.224-.347.596-.38 1.117l-1.778-.178c.106-.982.438-1.686.997-2.114.558-.427 1.257-.64 2.095-.64.918 0 1.64.247 2.164.742.525.495.787 1.11.787 1.847 0 .419-.075.818-.225 1.197-.15.378-.388.775-.714 1.19-.216.275-.605.67-1.168 1.187-.563.516-.92.859-1.07 1.028a3.11 3.11 0 0 0-.365.495h3.542z"/></svg>',jx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V11H3v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H2a1 1 0 0 1 1 1v4.5zm9.989 7.53 1.726-.209c.055.44.203.777.445 1.01.24.232.533.349.876.349.368 0 .678-.14.93-.42.251-.279.377-.655.377-1.13 0-.448-.12-.803-.362-1.066a1.153 1.153 0 0 0-.882-.393c-.228 0-.501.044-.819.133l.197-1.453c.482.012.85-.092 1.105-.315.253-.222.38-.517.38-.885 0-.313-.093-.563-.279-.75-.186-.185-.434-.278-.743-.278a1.07 1.07 0 0 0-.78.317c-.216.212-.347.52-.394.927l-1.644-.28c.114-.562.287-1.012.517-1.348.231-.337.553-.601.965-.794a3.24 3.24 0 0 1 1.387-.289c.876 0 1.579.28 2.108.838.436.457.653.973.653 1.549 0 .817-.446 1.468-1.339 1.955.533.114.96.37 1.28.768.319.398.478.878.478 1.441 0 .817-.298 1.513-.895 2.088-.596.576-1.339.864-2.228.864-.842 0-1.54-.243-2.094-.727-.555-.485-.876-1.118-.965-1.901z"/></svg>',qx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm13.55 10v-1.873h-3.81v-1.561l4.037-5.91h1.498v5.904h1.156v1.567h-1.156V18.5H17.05zm0-3.44v-3.18l-2.14 3.18h2.14z"/></svg>',Gx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm9.578 7.607 1.777-.184c.05.402.201.72.45.955a1.223 1.223 0 0 0 1.81-.101c.258-.303.387-.759.387-1.368 0-.572-.128-1-.384-1.286-.256-.285-.59-.428-1-.428-.512 0-.971.226-1.377.679l-1.448-.21.915-4.843h4.716v1.67H15.56l-.28 1.58a2.697 2.697 0 0 1 1.219-.298 2.68 2.68 0 0 1 2.012.863c.55.576.825 1.323.825 2.241a3.36 3.36 0 0 1-.666 2.05c-.605.821-1.445 1.232-2.52 1.232-.86 0-1.56-.23-2.101-.692-.542-.461-.866-1.081-.971-1.86z"/></svg>',Kx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm15.595 2.973-1.726.19c-.043-.355-.153-.617-.33-.787-.178-.169-.409-.253-.692-.253-.377 0-.695.169-.956.507-.26.339-.424 1.043-.492 2.114.445-.525.997-.787 1.657-.787.745 0 1.383.284 1.914.85.531.568.797 1.3.797 2.197 0 .952-.28 1.716-.838 2.291-.559.576-1.276.864-2.152.864-.94 0-1.712-.365-2.317-1.095-.605-.73-.908-1.927-.908-3.59 0-1.705.316-2.935.946-3.688.63-.753 1.45-1.13 2.457-1.13.706 0 1.291.198 1.755.594.463.395.758.97.885 1.723zm-4.043 3.891c0 .58.133 1.028.4 1.343.266.315.57.473.914.473.33 0 .605-.13.825-.388.22-.258.33-.68.33-1.27 0-.604-.118-1.047-.355-1.329a1.115 1.115 0 0 0-.89-.422c-.342 0-.632.134-.869.403s-.355.666-.355 1.19z"/></svg>',Zx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 9h16v2H2z"/></svg>',Jx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17 0a2 2 0 0 1 2 2v7a1 1 0 0 1 1 1v5a1 1 0 0 1-.883.993l-.118.006L19 17a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2l-.001-1.001-.116-.006A1 1 0 0 1 0 15v-5a1 1 0 0 1 .999-1L1 2a2 2 0 0 1 2-2h14zm.499 15.999h-15L2.5 17a.5.5 0 0 0 .5.5h14a.5.5 0 0 0 .5-.5l-.001-1.001zm-3.478-6.013-.014.014H14v.007l-1.525 1.525-1.46-1.46-.015.013V10h-1v5h1v-3.53l1.428 1.43.048.043.131-.129L14 11.421V15h1v-5h-.965l-.014-.014zM2 10H1v5h1v-2h2v2h1v-5H4v2H2v-2zm7 0H6v1h1v4h1v-4h1v-1zm8 0h-1v5h3v-1h-2v-4zm0-8.5H3a.5.5 0 0 0-.5.5l-.001 6.999h15L17.5 2a.5.5 0 0 0-.5-.5zM10 7v1H4V7h6zm3-2v1H4V5h9zm-3-2v1H4V3h6z"/></svg>',Yx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95 5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',Xx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>',Qx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 5.5v3h4v-3H3Zm0 4v3h4v-3H3Zm0 4v3h4v-3H3Zm5 3h4v-3H8v3Zm5 0h4v-3h-4v3Zm4-4v-3h-4v3h4Zm0-4v-3h-4v3h4Zm1.5 8A1.5 1.5 0 0 1 17 18H3a1.5 1.5 0 0 1-1.5-1.5V3c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13.5Zm-6.5-4v-3H8v3h4Zm0-4v-3H8v3h4Z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const P={bold:Rx,cancel:jA,caption:qA,check:GA,cog:KA,colorPalette:ZA,eraser:JA,history:YA,image:ix,imageUpload:sx,imageAssetManager:ox,imageUrl:rx,lowVision:XA,textAlternative:QA,loupe:ex,previousArrow:tx,nextArrow:nx,importExport:Lx,paragraph:Mx,plus:Bx,text:Ox,alignBottom:ax,alignMiddle:lx,alignTop:cx,alignLeft:ux,alignCenter:dx,alignRight:hx,alignJustify:fx,objectLeft:_x,objectCenter:gx,objectRight:vx,objectFullWidth:bx,objectInline:wx,objectBlockLeft:mx,objectBlockRight:px,objectSizeCustom:Cx,objectSizeFull:yx,objectSizeLarge:kx,objectSizeSmall:Tx,objectSizeMedium:Ex,pencil:Ax,pilcrow:xx,quote:Sx,threeVerticalDots:Ix,dragIndicator:Px,redo:Vx,undo:Dx,bulletedList:Nx,numberedList:Fx,todoList:$x,codeBlock:Ux,browseFiles:zx,heading1:Hx,heading2:Wx,heading3:jx,heading4:qx,heading5:Gx,heading6:Kx,horizontalLine:Zx,html:Jx,indent:Yx,outdent:Xx,table:Qx};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class lm{constructor(e,t=20){this._batch=null,this.model=e,this._size=0,this.limit=t,this._isLocked=!1,this._changeCallback=(n,s)=>{s.isLocal&&s.isUndoable&&s!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch({isTyping:!0})),this._batch}get size(){return this._size}input(e){this._size+=e,this._size>=this.limit&&this._reset(!0)}get isLocked(){return this._isLocked}lock(){this._isLocked=!0}unlock(){this._isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(e=!1){(!this.isLocked||e)&&(this._batch=null,this._size=0)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class e4 extends F{constructor(e,t){super(e),this._buffer=new lm(e.model,t),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const t=this.editor.model,n=t.document,s=e.text||"",o=s.length;let r=n.selection;if(e.selection?r=e.selection:e.range&&(r=t.createSelection(e.range)),!t.canEditAt(r))return;const a=e.resultRange;t.enqueueChange(this._buffer.batch,l=>{this._buffer.lock();const c=Array.from(n.selection.getAttributes());t.deleteContent(r),s&&t.insertContent(l.createText(s,c),r),a?l.setSelection(a):r.is("documentSelection")||l.setSelection(r),this._buffer.unlock(),this._buffer.input(o)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const cm=["insertText","insertReplacementText"];class t4 extends Pt{constructor(e){super(e),this.focusObserver=e.getObserver(zo),$.isAndroid&&cm.push("insertCompositionText");const t=e.document;t.on("beforeinput",(n,s)=>{if(!this.isEnabled)return;const{data:o,targetRanges:r,inputType:a,domEvent:l}=s;if(!cm.includes(a))return;this.focusObserver.flush();const c=new Ht(t,"insertText");t.fire(c,new pi(e,l,{text:o,selection:e.createSelection(r)})),c.stop.called&&n.stop()}),t.on("compositionend",(n,{data:s,domEvent:o})=>{!this.isEnabled||$.isAndroid||s&&t.fire("insertText",new pi(e,o,{text:s,selection:t.selection}))},{priority:"lowest"})}observe(){}stopObserving(){}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class um extends y{static get pluginName(){return"Input"}init(){const e=this.editor,t=e.model,n=e.editing.view,s=t.document.selection;n.addObserver(t4);const o=new e4(e,e.config.get("typing.undoStep")||20);e.commands.add("insertText",o),e.commands.add("input",o),this.listenTo(n.document,"insertText",(r,a)=>{n.document.isComposing||a.preventDefault();const{text:l,selection:c,resultRange:u}=a,d=Array.from(c.getRanges()).map(m=>e.editing.mapper.toModelRange(m));let h=l;if($.isAndroid){const m=Array.from(d[0].getItems()).reduce((g,b)=>g+(b.is("$textProxy")?b.data:""),"");m&&(m.length<=h.length?h.startsWith(m)&&(h=h.substring(m.length),d[0].start=d[0].start.getShiftedBy(m.length)):m.startsWith(h)&&(d[0].start=d[0].start.getShiftedBy(h.length),h=""))}const f={text:h,selection:t.createSelection(d)};u&&(f.resultRange=e.editing.mapper.toModelRange(u)),e.execute("insertText",f),n.scrollToTheSelection()}),$.isAndroid?this.listenTo(n.document,"keydown",(r,a)=>{s.isCollapsed||a.keyCode!=229||!n.document.isComposing||dm(t,o)}):this.listenTo(n.document,"compositionstart",()=>{s.isCollapsed||dm(t,o)})}}function dm(i,e){if(!e.isEnabled)return;const t=e.buffer;t.lock(),i.enqueueChange(t.batch,()=>{i.deleteContent(i.document.selection)}),t.unlock()}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class hm extends F{constructor(e,t){super(e),this.direction=t,this._buffer=new lm(e.model,e.config.get("typing.undoStep")),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}execute(e={}){const t=this.editor.model,n=t.document;t.enqueueChange(this._buffer.batch,s=>{this._buffer.lock();const o=s.createSelection(e.selection||n.selection);if(!t.canEditAt(o))return;const r=e.sequence||1,a=o.isCollapsed;if(o.isCollapsed&&t.modifySelection(o,{direction:this.direction,unit:e.unit,treatEmojiAsSingleUnit:!0}),this._shouldEntireContentBeReplacedWithParagraph(r)){this._replaceEntireContentWithParagraph(s);return}if(this._shouldReplaceFirstBlockWithParagraph(o,r)){this.editor.execute("paragraph",{selection:o});return}if(o.isCollapsed)return;let l=0;o.getFirstRange().getMinimalFlatRanges().forEach(c=>{l+=Ja(c.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),t.deleteContent(o,{doNotResetEntireContent:a,direction:this.direction}),this._buffer.input(l),s.setSelection(o),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const t=this.editor.model,s=t.document.selection,o=t.schema.getLimitElement(s);if(!(s.isCollapsed&&s.containsEntireContent(o))||!t.schema.checkChild(o,"paragraph"))return!1;const a=o.getChild(0);return!(a&&a.is("element","paragraph"))}_replaceEntireContentWithParagraph(e){const t=this.editor.model,s=t.document.selection,o=t.schema.getLimitElement(s),r=e.createElement("paragraph");e.remove(e.createRangeIn(o)),e.insert(r,o),e.setSelection(r,0)}_shouldReplaceFirstBlockWithParagraph(e,t){const n=this.editor.model;if(t>1||this.direction!="backward"||!e.isCollapsed)return!1;const s=e.getFirstPosition(),o=n.schema.getLimitElement(s),r=o.getChild(0);return!(s.parent!=r||!e.containsEntireContent(r)||!n.schema.checkChild(o,"paragraph")||r.name=="paragraph")}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const n4="character",fm="word",i4="codePoint",dn="selection",yi="backward",xs="forward",mm={deleteContent:{unit:dn,direction:yi},deleteContentBackward:{unit:i4,direction:yi},deleteWordBackward:{unit:fm,direction:yi},deleteHardLineBackward:{unit:dn,direction:yi},deleteSoftLineBackward:{unit:dn,direction:yi},deleteContentForward:{unit:n4,direction:xs},deleteWordForward:{unit:fm,direction:xs},deleteHardLineForward:{unit:dn,direction:xs},deleteSoftLineForward:{unit:dn,direction:xs}};class s4 extends Pt{constructor(e){super(e);const t=e.document;let n=0;t.on("keydown",()=>{n++}),t.on("keyup",()=>{n=0}),t.on("beforeinput",(s,o)=>{if(!this.isEnabled)return;const{targetRanges:r,domEvent:a,inputType:l}=o,c=mm[l];if(!c)return;const u={direction:c.direction,unit:c.unit,sequence:n};u.unit==dn&&(u.selectionToRemove=e.createSelection(r[0])),l==="deleteContentBackward"&&($.isAndroid&&(u.sequence=1),r4(r)&&(u.unit=dn,u.selectionToRemove=e.createSelection(r)));const d=new fi(t,"delete",r[0]);t.fire(d,new pi(e,a,u)),d.stop.called&&s.stop()}),$.isBlink&&o4(this)}observe(){}stopObserving(){}}function o4(i){const e=i.view,t=e.document;let n=null,s=!1;t.on("keydown",(a,{keyCode:l})=>{n=l,s=!1}),t.on("keyup",(a,{keyCode:l,domEvent:c})=>{const u=t.selection,d=i.isEnabled&&l==n&&o(l)&&!u.isCollapsed&&!s;if(n=null,d){const h=u.getFirstRange(),f=new fi(t,"delete",h),m={unit:dn,direction:r(l),selectionToRemove:u};t.fire(f,new pi(e,c,m))}}),t.on("beforeinput",(a,{inputType:l})=>{const c=mm[l];o(n)&&c&&c.direction==r(n)&&(s=!0)},{priority:"high"}),t.on("beforeinput",(a,{inputType:l,data:c})=>{n==U.delete&&l=="insertText"&&c==""&&a.stop()},{priority:"high"});function o(a){return a==U.backspace||a==U.delete}function r(a){return a==U.backspace?yi:xs}}function r4(i){if(i.length!=1||i[0].isCollapsed)return!1;const e=i[0].getWalker({direction:"backward",singleCharacters:!0,ignoreElementEnd:!0});let t=0;for(const{nextPosition:n,item:s}of e){if(n.parent.is("$text")){const o=n.parent.data,r=n.offset;if(tl(o,r)||nl(o,r)||xh(o,r))continue;t++}else(s.is("containerElement")||s.is("emptyElement"))&&t++;if(t>1)return!0}return!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ln extends y{static get pluginName(){return"Delete"}init(){const e=this.editor,t=e.editing.view,n=t.document,s=e.model.document;t.addObserver(s4),this._undoOnBackspace=!1;const o=new hm(e,"forward");e.commands.add("deleteForward",o),e.commands.add("forwardDelete",o),e.commands.add("delete",new hm(e,"backward")),this.listenTo(n,"delete",(r,a)=>{n.isComposing||a.preventDefault();const{direction:l,sequence:c,selectionToRemove:u,unit:d}=a,h=l==="forward"?"deleteForward":"delete",f={sequence:c};if(d=="selection"){const m=Array.from(u.getRanges()).map(g=>e.editing.mapper.toModelRange(g));f.selection=e.model.createSelection(m)}else f.unit=d;e.execute(h,f),t.scrollToTheSelection()},{priority:"low"}),this.editor.plugins.has("UndoEditing")&&(this.listenTo(n,"delete",(r,a)=>{this._undoOnBackspace&&a.direction=="backward"&&a.sequence==1&&a.unit=="codePoint"&&(this._undoOnBackspace=!1,e.execute("undo"),a.preventDefault(),r.stop())},{context:"$capture"}),this.listenTo(s,"change",()=>{this._undoOnBackspace=!1}))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class a4 extends y{static get requires(){return[um,Ln]}static get pluginName(){return"Typing"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function gm(i,e){let t=i.start;return{text:Array.from(i.getWalker({ignoreElementEnd:!1})).reduce((s,{item:o})=>o.is("$text")||o.is("$textProxy")?s+o.data:(t=e.createPositionAfter(o),""),""),range:e.createRange(t,i.end)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class pm extends re(){constructor(e,t){super(),this.model=e,this.testCallback=t,this._hasMatch=!1,this.set("isEnabled",!0),this.on("change:isEnabled",()=>{this.isEnabled?this._startListening():(this.stopListening(e.document.selection),this.stopListening(e.document))}),this._startListening()}get hasMatch(){return this._hasMatch}_startListening(){const t=this.model.document;this.listenTo(t.selection,"change:range",(n,{directChange:s})=>{if(s){if(!t.selection.isCollapsed){this.hasMatch&&(this.fire("unmatched"),this._hasMatch=!1);return}this._evaluateTextBeforeSelection("selection")}}),this.listenTo(t,"change:data",(n,s)=>{s.isUndo||!s.isLocal||this._evaluateTextBeforeSelection("data",{batch:s})})}_evaluateTextBeforeSelection(e,t={}){const n=this.model,o=n.document.selection,r=n.createRange(n.createPositionAt(o.focus.parent,0),o.focus),{text:a,range:l}=gm(r,n),c=this.testCallback(a);if(!c&&this.hasMatch&&this.fire("unmatched"),this._hasMatch=!!c,c){const u=Object.assign(t,{text:a,range:l});typeof c=="object"&&Object.assign(u,c),this.fire(`matched:${e}`,u)}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class bm extends y{static get pluginName(){return"TwoStepCaretMovement"}constructor(e){super(e),this._isNextGravityRestorationSkipped=!1,this.attributes=new Set,this._overrideUid=null}init(){const e=this.editor,t=e.model,n=e.editing.view,s=e.locale,o=t.document.selection;this.listenTo(n.document,"arrowKey",(r,a)=>{if(!o.isCollapsed||a.shiftKey||a.altKey||a.ctrlKey)return;const l=a.keyCode==U.arrowright,c=a.keyCode==U.arrowleft;if(!l&&!c)return;const u=s.contentLanguageDirection;let d=!1;u==="ltr"&&l||u==="rtl"&&c?d=this._handleForwardMovement(a):d=this._handleBackwardMovement(a),d===!0&&r.stop()},{context:"$text",priority:"highest"}),this.listenTo(o,"change:range",(r,a)=>{if(this._isNextGravityRestorationSkipped){this._isNextGravityRestorationSkipped=!1;return}this._isGravityOverridden&&(!a.directChange&&ct(o.getFirstPosition(),this.attributes)||this._restoreGravity())}),this._enableClickingAfterNode(),this._enableInsertContentSelectionAttributesFixer(),this._handleDeleteContentAfterNode()}registerAttribute(e){this.attributes.add(e)}_handleForwardMovement(e){const t=this.attributes,n=this.editor.model,s=n.document.selection,o=s.getFirstPosition();return this._isGravityOverridden||o.isAtStart&&Yt(s,t)?!1:ct(o,t)?(Is(e),Yt(s,t)&&ct(o,t,!0)?Ss(n,t):this._overrideGravity(),!0):!1}_handleBackwardMovement(e){const t=this.attributes,n=this.editor.model,s=n.document.selection,o=s.getFirstPosition();return this._isGravityOverridden?(Is(e),this._restoreGravity(),ct(o,t,!0)?Ss(n,t):Zo(n,t,o),!0):o.isAtStart?Yt(s,t)?(Is(e),Zo(n,t,o),!0):!1:!Yt(s,t)&&ct(o,t,!0)?(Is(e),Zo(n,t,o),!0):wm(o,t)?o.isAtEnd&&!Yt(s,t)&&ct(o,t)?(Is(e),Zo(n,t,o),!0):(this._isNextGravityRestorationSkipped=!0,this._overrideGravity(),!1):!1}_enableClickingAfterNode(){const e=this.editor,t=e.model,n=t.document.selection,s=e.editing.view.document;e.editing.view.addObserver(xl);let o=!1;this.listenTo(s,"mousedown",()=>{o=!0}),this.listenTo(s,"selectionChange",()=>{const r=this.attributes;if(!o||(o=!1,!n.isCollapsed)||!Yt(n,r))return;const a=n.getFirstPosition();ct(a,r)&&(a.isAtStart||ct(a,r,!0)?Ss(t,r):this._isGravityOverridden||this._overrideGravity())})}_enableInsertContentSelectionAttributesFixer(){const t=this.editor.model,n=t.document.selection,s=this.attributes;this.listenTo(t,"insertContent",()=>{const o=n.getFirstPosition();Yt(n,s)&&ct(o,s)&&Ss(t,s)},{priority:"low"})}_handleDeleteContentAfterNode(){const e=this.editor,t=e.model,n=t.document.selection,s=e.editing.view;let o=!1,r=!1;this.listenTo(s.document,"delete",(a,l)=>{o=l.direction==="backward"},{priority:"high"}),this.listenTo(t,"deleteContent",()=>{if(!o)return;const a=n.getFirstPosition();r=Yt(n,this.attributes)&&!wm(a,this.attributes)},{priority:"high"}),this.listenTo(t,"deleteContent",()=>{o&&(o=!1,!r&&e.model.enqueueChange(()=>{const a=n.getFirstPosition();Yt(n,this.attributes)&&ct(a,this.attributes)&&(a.isAtStart||ct(a,this.attributes,!0)?Ss(t,this.attributes):this._isGravityOverridden||this._overrideGravity())}))},{priority:"low"})}get _isGravityOverridden(){return!!this._overrideUid}_overrideGravity(){this._overrideUid=this.editor.model.change(e=>e.overrideSelectionGravity())}_restoreGravity(){this.editor.model.change(e=>{e.restoreSelectionGravity(this._overrideUid),this._overrideUid=null})}}function Yt(i,e){for(const t of e)if(i.hasAttribute(t))return!0;return!1}function Zo(i,e,t){const n=t.nodeBefore;i.change(s=>{if(n){const o=[],r=i.schema.isObject(n)&&i.schema.isInline(n);for(const[a,l]of n.getAttributes())i.schema.checkAttribute("$text",a)&&(!r||i.schema.getAttributeProperties(a).copyFromObject!==!1)&&o.push([a,l]);s.setSelectionAttribute(o)}else s.removeSelectionAttribute(e)})}function Ss(i,e){i.change(t=>{t.removeSelectionAttribute(e)})}function Is(i){i.preventDefault()}function wm(i,e){const t=i.getShiftedBy(-1);return ct(t,e)}function ct(i,e,t=!1){const{nodeBefore:n,nodeAfter:s}=i;for(const o of e){const r=n?n.getAttribute(o):void 0,a=s?s.getAttribute(o):void 0;if(!(t&&(r===void 0||a===void 0))&&a!==r)return!0}return!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Jo(i,e,t,n){return n.createRange(_m(i,e,t,!0,n),_m(i,e,t,!1,n))}function _m(i,e,t,n,s){let o=i.textNode||(n?i.nodeBefore:i.nodeAfter),r=null;for(;o&&o.getAttribute(e)==t;)r=o,o=n?o.previousSibling:o.nextSibling;return r?s.createPositionAt(r,n?"before":"after"):i}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function l4(i,e,t,n){const s=i.editing.view,o=new Set;s.document.registerPostFixer(r=>{const a=i.model.document.selection;let l=!1;if(a.hasAttribute(e)){const c=Jo(a.getFirstPosition(),e,a.getAttribute(e),i.model),u=i.editing.mapper.toViewRange(c);for(const d of u.getItems())d.is("element",t)&&!d.hasClass(n)&&(r.addClass(n,d),o.add(d),l=!0)}return l}),i.conversion.for("editingDowncast").add(r=>{r.on("insert",a,{priority:"highest"}),r.on("remove",a,{priority:"highest"}),r.on("attribute",a,{priority:"highest"}),r.on("selection",a,{priority:"highest"});function a(){s.change(l=>{for(const c of o.values())l.removeClass(n,c),o.delete(c)})}})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function hn(i,e,t,n){let s,o=null;typeof n=="function"?s=n:(o=i.commands.get(n),s=()=>{i.execute(n)}),i.model.document.on("change:data",(r,a)=>{if(o&&!o.isEnabled||!e.isEnabled)return;const l=ce(i.model.document.selection.getRanges());if(!l.isCollapsed||a.isUndo||!a.isLocal)return;const c=Array.from(i.model.document.differ.getChanges()),u=c[0];if(c.length!=1||u.type!=="insert"||u.name!="$text"||u.length!=1)return;const d=u.position.parent;if(d.is("element","codeBlock")||d.is("element","listItem")&&typeof n!="function"&&!["numberedList","bulletedList","todoList"].includes(n)||o&&o.value===!0)return;const h=d.getChild(0),f=i.model.createRangeOn(h);if(!f.containsRange(l)&&!l.end.isEqual(f.end))return;const m=t.exec(h.data.substr(0,l.end.offset));m&&i.model.enqueueChange(g=>{const b=g.createPositionAt(d,0),_=g.createPositionAt(d,m[0].length),T=new rt(b,_);if(s({match:m})!==!1){g.remove(T);const B=i.model.document.selection.getFirstRange(),W=g.createRangeIn(d);d.isEmpty&&!W.isEqual(B)&&!W.containsRange(B,!0)&&g.remove(d)}T.detach(),i.model.enqueueChange(()=>{i.plugins.get("Delete").requestUndoOnBackspace()})})})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ci(i,e,t,n){let s,o;t instanceof RegExp?s=t:o=t,o=o||(r=>{let a;const l=[],c=[];for(;(a=s.exec(r))!==null&&!(a&&a.length<4);){let{index:u,"1":d,"2":h,"3":f}=a;const m=d+h+f;u+=a[0].length-m.length;const g=[u,u+d.length],b=[u+d.length+h.length,u+d.length+h.length+f.length];l.push(g),l.push(b),c.push([u+d.length,u+d.length+h.length])}return{remove:l,format:c}}),i.model.document.on("change:data",(r,a)=>{if(a.isUndo||!a.isLocal||!e.isEnabled)return;const l=i.model,c=l.document.selection;if(!c.isCollapsed)return;const u=Array.from(l.document.differ.getChanges()),d=u[0];if(u.length!=1||d.type!=="insert"||d.name!="$text"||d.length!=1)return;const h=c.focus,f=h.parent,{text:m,range:g}=c4(l.createRange(l.createPositionAt(f,0),h),l),b=o(m),_=vm(g.start,b.format,l),T=vm(g.start,b.remove,l);_.length&&T.length&&l.enqueueChange(O=>{if(n(O,_)!==!1){for(const W of T.reverse())O.remove(W);l.enqueueChange(()=>{i.plugins.get("Delete").requestUndoOnBackspace()})}})})}function vm(i,e,t){return e.filter(n=>n[0]!==void 0&&n[1]!==void 0).map(n=>t.createRange(i.getShiftedBy(n[0]),i.getShiftedBy(n[1])))}function c4(i,e){let t=i.start;return{text:Array.from(i.getItems()).reduce((s,o)=>!(o.is("$text")||o.is("$textProxy"))||o.getAttribute("code")?(t=e.createPositionAfter(o),""):s+o.data,""),range:e.createRange(t,i.end)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class u4 extends y{static get requires(){return[Ln]}static get pluginName(){return"Autoformat"}afterInit(){const e=this.editor,t=this.editor.t;this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats(),this._addHorizontalLineAutoformats(),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Revert autoformatting action"),keystroke:"Backspace"}]})}_addListAutoformats(){const e=this.editor.commands;e.get("bulletedList")&&hn(this.editor,this,/^[*-]\s$/,"bulletedList"),e.get("numberedList")&&hn(this.editor,this,/^1[.|)]\s$/,"numberedList"),e.get("todoList")&&hn(this.editor,this,/^\[\s?\]\s$/,"todoList"),e.get("checkTodoList")&&hn(this.editor,this,/^\[\s?x\s?\]\s$/,()=>{this.editor.execute("todoList"),this.editor.execute("checkTodoList")})}_addBasicStylesAutoformats(){const e=this.editor.commands;if(e.get("bold")){const t=Yo(this.editor,"bold");Ci(this.editor,this,/(?:^|\s)(\*\*)([^*]+)(\*\*)$/g,t),Ci(this.editor,this,/(?:^|\s)(__)([^_]+)(__)$/g,t)}if(e.get("italic")){const t=Yo(this.editor,"italic");Ci(this.editor,this,/(?:^|\s)(\*)([^*_]+)(\*)$/g,t),Ci(this.editor,this,/(?:^|\s)(_)([^_]+)(_)$/g,t)}if(e.get("code")){const t=Yo(this.editor,"code");Ci(this.editor,this,/(`)([^`]+)(`)$/g,t)}if(e.get("strikethrough")){const t=Yo(this.editor,"strikethrough");Ci(this.editor,this,/(~~)([^~]+)(~~)$/g,t)}}_addHeadingAutoformats(){const e=this.editor.commands.get("heading");e&&e.modelElements.filter(t=>t.match(/^heading[1-6]$/)).forEach(t=>{const n=t[7],s=new RegExp(`^(#{${n}})\\s$`);hn(this.editor,this,s,()=>{if(!e.isEnabled||e.value===t)return!1;this.editor.execute("heading",{value:t})})})}_addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&hn(this.editor,this,/^>\s$/,"blockQuote")}_addCodeBlockAutoformats(){const e=this.editor,t=e.model.document.selection;e.commands.get("codeBlock")&&hn(e,this,/^```$/,()=>{if(t.getFirstPosition().parent.is("element","listItem"))return!1;this.editor.execute("codeBlock",{usePreviousLanguageChoice:!0})})}_addHorizontalLineAutoformats(){this.editor.commands.get("horizontalLine")&&hn(this.editor,this,/^---$/,"horizontalLine")}}function Yo(i,e){return(t,n)=>{if(!i.commands.get(e).isEnabled)return!1;const o=i.model.schema.getValidRanges(n,e);for(const r of o)t.setAttribute(e,!0,r);t.removeSelectionAttribute(e)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Xo extends F{constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,s=t.document.selection,o=e.forceValue===void 0?!this.value:e.forceValue;t.change(r=>{if(s.isCollapsed)o?r.setSelectionAttribute(this.attributeKey,!0):r.removeSelectionAttribute(this.attributeKey);else{const a=t.schema.getValidRanges(s.getRanges(),this.attributeKey);for(const l of a)o?r.setAttribute(this.attributeKey,o,l):r.removeAttribute(this.attributeKey,l)}})}_getValueFromFirstAllowedNode(){const e=this.editor.model,t=e.schema,n=e.document.selection;if(n.isCollapsed)return n.hasAttribute(this.attributeKey);for(const s of n.getRanges())for(const o of s.getItems())if(t.checkAttribute(o,this.attributeKey))return o.hasAttribute(this.attributeKey);return!1}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const ki="bold";class d4 extends y{static get pluginName(){return"BoldEditing"}init(){const e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:ki}),e.model.schema.setAttributeProperties(ki,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:ki,view:"strong",upcastAlso:["b",n=>{const s=n.getStyle("font-weight");return s&&(s=="bold"||Number(s)>=600)?{name:!0,styles:["font-weight"]}:null}]}),e.commands.add(ki,new Xo(e,ki)),e.keystrokes.set("CTRL+B",ki),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Bold text"),keystroke:"CTRL+B"}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Xe extends Oe{constructor(e=[]){super(e,{idProperty:"viewUid"}),this.on("add",(t,n,s)=>{this._renderViewIntoCollectionParent(n,s)}),this.on("remove",(t,n)=>{n.element&&this._parentElement&&n.element.remove()}),this._parentElement=null}destroy(){this.map(e=>e.destroy())}setParent(e){this._parentElement=e;for(const t of this)this._renderViewIntoCollectionParent(t)}delegate(...e){if(!e.length||!h4(e))throw new p("ui-viewcollection-delegate-wrong-events",this);return{to:t=>{for(const n of this)for(const s of e)n.delegate(s).to(t);this.on("add",(n,s)=>{for(const o of e)s.delegate(o).to(t)}),this.on("remove",(n,s)=>{for(const o of e)s.stopDelegating(o,t)})}}}_renderViewIntoCollectionParent(e,t){e.isRendered||e.render(),e.element&&this._parentElement&&this._parentElement.insertBefore(e.element,this._parentElement.children[t])}remove(e){return super.remove(e)}}function h4(i){return i.every(e=>typeof e=="string")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const f4="http://www.w3.org/1999/xhtml";class Ue extends ee(){constructor(e){super(),Object.assign(this,Tm(km(e))),this._isRendered=!1,this._revertData=null}render(){const e=this._renderNode({intoFragment:!0});return this._isRendered=!0,e}apply(e){return this._revertData=Pm(),this._renderNode({node:e,intoFragment:!1,isApplying:!0,revertData:this._revertData}),e}revert(e){if(!this._revertData)throw new p("ui-template-revert-not-applied",[this,e]);this._revertTemplateFromNode(e,this._revertData)}*getViews(){function*e(t){if(t.children)for(const n of t.children)er(n)?yield n:Bl(n)&&(yield*e(n))}yield*e(this)}static bind(e,t){return{to(n,s){return new m4({eventNameOrFunction:n,attribute:n,observable:e,emitter:t,callback:s})},if(n,s,o){return new ym({observable:e,emitter:t,attribute:n,valueIfTrue:s,callback:o})}}}static extend(e,t){if(e._isRendered)throw new p("template-extend-render",[this,e]);Sm(e,Tm(km(t)))}_renderNode(e){let t;if(e.node?t=this.tag&&this.text:t=this.tag?this.text:!this.text,t)throw new p("ui-template-wrong-syntax",this);return this.text?this._renderText(e):this._renderElement(e)}_renderElement(e){let t=e.node;return t||(t=e.node=document.createElementNS(this.ns||f4,this.tag)),this._renderAttributes(e),this._renderElementChildren(e),this._setUpListeners(e),t}_renderText(e){let t=e.node;return t?e.revertData.text=t.textContent:t=e.node=document.createTextNode(""),Qo(this.text)?this._bindToObservable({schema:this.text,updater:p4(t),data:e}):t.textContent=this.text.join(""),t}_renderAttributes(e){if(!this.attributes)return;const t=e.node,n=e.revertData;for(const s in this.attributes){const o=t.getAttribute(s),r=this.attributes[s];n&&(n.attributes[s]=o);const a=Im(r)?r[0].ns:null;if(Qo(r)){const l=Im(r)?r[0].value:r;n&&Rm(s)&&l.unshift(o),this._bindToObservable({schema:l,updater:b4(t,s,a),data:e})}else if(s=="style"&&typeof r[0]!="string")this._renderStyleAttribute(r[0],e);else{n&&o&&Rm(s)&&r.unshift(o);const l=r.map(c=>c&&(c.value||c)).reduce((c,u)=>c.concat(u),[]).reduce(Am,"");Ti(l)||t.setAttributeNS(a,s,l)}}}_renderStyleAttribute(e,t){const n=t.node;for(const s in e){const o=e[s];Qo(o)?this._bindToObservable({schema:[o],updater:w4(n,s),data:t}):n.style[s]=o}}_renderElementChildren(e){const t=e.node,n=e.intoFragment?document.createDocumentFragment():t,s=e.isApplying;let o=0;for(const r of this.children)if(Ol(r)){if(!s){r.setParent(t);for(const a of r)n.appendChild(a.element)}}else if(er(r))s||(r.isRendered||r.render(),n.appendChild(r.element));else if(ln(r))n.appendChild(r);else if(s){const a=e.revertData,l=Pm();a.children.push(l),r._renderNode({intoFragment:!1,node:n.childNodes[o++],isApplying:!0,revertData:l})}else n.appendChild(r.render());e.intoFragment&&t.appendChild(n)}_setUpListeners(e){if(this.eventListeners)for(const t in this.eventListeners){const n=this.eventListeners[t].map(s=>{const[o,r]=t.split("@");return s.activateDomEventListener(o,r,e)});e.revertData&&e.revertData.bindings.push(n)}}_bindToObservable({schema:e,updater:t,data:n}){const s=n.revertData;Cm(e,t,n);const o=e.filter(r=>!Ti(r)).filter(r=>r.observable).map(r=>r.activateAttributeListener(e,t,n));s&&s.bindings.push(o)}_revertTemplateFromNode(e,t){for(const s of t.bindings)for(const o of s)o();if(t.text){e.textContent=t.text;return}const n=e;for(const s in t.attributes){const o=t.attributes[s];o===null?n.removeAttribute(s):n.setAttribute(s,o)}for(let s=0;s<t.children.length;++s)this._revertTemplateFromNode(n.childNodes[s],t.children[s])}}class Ps{constructor(e){this.attribute=e.attribute,this.observable=e.observable,this.emitter=e.emitter,this.callback=e.callback}getValue(e){const t=this.observable[this.attribute];return this.callback?this.callback(t,e):t}activateAttributeListener(e,t,n){const s=()=>Cm(e,t,n);return this.emitter.listenTo(this.observable,`change:${this.attribute}`,s),()=>{this.emitter.stopListening(this.observable,`change:${this.attribute}`,s)}}}class m4 extends Ps{constructor(e){super(e),this.eventNameOrFunction=e.eventNameOrFunction}activateDomEventListener(e,t,n){const s=(o,r)=>{(!t||r.target.matches(t))&&(typeof this.eventNameOrFunction=="function"?this.eventNameOrFunction(r):this.observable.fire(this.eventNameOrFunction,r))};return this.emitter.listenTo(n.node,e,s),()=>{this.emitter.stopListening(n.node,e,s)}}}class ym extends Ps{constructor(e){super(e),this.valueIfTrue=e.valueIfTrue}getValue(e){const t=super.getValue(e);return Ti(t)?!1:this.valueIfTrue||!0}}function Qo(i){return i?(i.value&&(i=i.value),Array.isArray(i)?i.some(Qo):i instanceof Ps):!1}function g4(i,e){return i.map(t=>t instanceof Ps?t.getValue(e):t)}function Cm(i,e,{node:t}){const n=g4(i,t);let s;i.length==1&&i[0]instanceof ym?s=n[0]:s=n.reduce(Am,""),Ti(s)?e.remove():e.set(s)}function p4(i){return{set(e){i.textContent=e},remove(){i.textContent=""}}}function b4(i,e,t){return{set(n){i.setAttributeNS(t,e,n)},remove(){i.removeAttributeNS(t,e)}}}function w4(i,e){return{set(t){i.style[e]=t},remove(){i.style[e]=null}}}function km(i){return za(i,t=>{if(t&&(t instanceof Ps||Bl(t)||er(t)||Ol(t)))return t})}function Tm(i){if(typeof i=="string"?i=y4(i):i.text&&C4(i),i.on&&(i.eventListeners=v4(i.on),delete i.on),!i.text){i.attributes&&_4(i.attributes);const e=[];if(i.children)if(Ol(i.children))e.push(i.children);else for(const t of i.children)Bl(t)||er(t)||ln(t)?e.push(t):e.push(new Ue(t));i.children=e}return i}function _4(i){for(const e in i)i[e].value&&(i[e].value=J(i[e].value)),Em(i,e)}function v4(i){for(const e in i)Em(i,e);return i}function y4(i){return{text:[i]}}function C4(i){i.text=J(i.text)}function Em(i,e){i[e]=J(i[e])}function Am(i,e){return Ti(e)?i:Ti(i)?e:`${i} ${e}`}function xm(i,e){for(const t in e)i[t]?i[t].push(...e[t]):i[t]=e[t]}function Sm(i,e){if(e.attributes&&(i.attributes||(i.attributes={}),xm(i.attributes,e.attributes)),e.eventListeners&&(i.eventListeners||(i.eventListeners={}),xm(i.eventListeners,e.eventListeners)),e.text&&i.text.push(...e.text),e.children&&e.children.length){if(i.children.length!=e.children.length)throw new p("ui-template-extend-children-mismatch",i);let t=0;for(const n of e.children)Sm(i.children[t++],n)}}function Ti(i){return!i&&i!==0}function er(i){return i instanceof R}function Bl(i){return i instanceof Ue}function Ol(i){return i instanceof Xe}function Im(i){return ie(i[0])&&i[0].ns}function Pm(){return{children:[],bindings:[],attributes:{}}}function Rm(i){return i=="class"||i=="style"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class R extends qe(re()){constructor(e){super(),this.element=null,this.isRendered=!1,this.locale=e,this.t=e&&e.t,this._viewCollections=new Oe,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",(t,n)=>{n.locale=e,n.t=e&&e.t}),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=Ue.bind(this,this)}createCollection(e){const t=new Xe(e);return this._viewCollections.add(t),t}registerChild(e){je(e)||(e=[e]);for(const t of e)this._unboundChildren.add(t)}deregisterChild(e){je(e)||(e=[e]);for(const t of e)this._unboundChildren.remove(t)}setTemplate(e){this.template=new Ue(e)}extendTemplate(e){Ue.extend(this.template,e)}render(){if(this.isRendered)throw new p("ui-view-render-already-rendered",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map(e=>e.destroy()),this.template&&this.template._revertData&&this.template.revert(this.element)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Vn({emitter:i,activator:e,callback:t,contextElements:n}){i.listenTo(document,"mousedown",(s,o)=>{if(!e())return;const r=typeof o.composedPath=="function"?o.composedPath():[],a=typeof n=="function"?n():n;for(const l of a)if(l.contains(o.target)||r.includes(l))return;t()})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function k4(i){class e extends i{disableCssTransitions(){this._isCssTransitionsDisabled=!0}enableCssTransitions(){this._isCssTransitionsDisabled=!1}constructor(...n){super(...n),this.set("_isCssTransitionsDisabled",!1),this.initializeCssTransitionDisablerMixin()}initializeCssTransitionDisablerMixin(){this.extendTemplate({attributes:{class:[this.bindTemplate.if("_isCssTransitionsDisabled","ck-transitions-disabled")]}})}}return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ll({view:i}){i.listenTo(i.element,"submit",(e,t)=>{t.preventDefault(),i.fire("submit")},{useCapture:!0})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Mm({keystrokeHandler:i,focusTracker:e,gridItems:t,numberOfColumns:n,uiLanguageDirection:s}){const o=typeof n=="number"?()=>n:n;i.set("arrowright",r((c,u)=>s==="rtl"?l(c,u.length):a(c,u.length))),i.set("arrowleft",r((c,u)=>s==="rtl"?a(c,u.length):l(c,u.length))),i.set("arrowup",r((c,u)=>{let d=c-o();return d<0&&(d=c+o()*Math.floor(u.length/o()),d>u.length-1&&(d-=o())),d})),i.set("arrowdown",r((c,u)=>{let d=c+o();return d>u.length-1&&(d=c%o()),d}));function r(c){return u=>{const d=t.find(m=>m.element===e.focusedElement),h=t.getIndex(d),f=c(h,t);t.get(f).focus(),u.stopPropagation(),u.preventDefault()}}function a(c,u){return c===u-1?0:c+1}function l(c,u){return c===0?u-1:c-1}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Qe extends R{constructor(e){super(e),this.set("text",void 0),this.set("for",void 0),this.id=`ck-editor__label_${it()}`;const t=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:t.to("for")},children:[{text:t.to("text")}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class T4 extends R{constructor(e,t){super(e);const n=e.t,s=new Qe;s.text=n("Help Contents. To close this dialog press ESC."),this.setTemplate({tag:"div",attributes:{class:["ck","ck-accessibility-help-dialog__content"],"aria-labelledby":s.id,role:"document",tabindex:-1},children:[wt(document,"p",{},n("Below, you can find a list of keyboard shortcuts that can be used in the editor.")),...this._createCategories(Array.from(t.values())),s]})}focus(){this.element.focus()}_createCategories(e){return e.map(t=>{const n=[wt(document,"h3",{},t.label),...Array.from(t.groups.values()).map(s=>this._createGroup(s)).flat()];return t.description&&n.splice(1,0,wt(document,"p",{},t.description)),wt(document,"section",{},n)})}_createGroup(e){const t=e.keystrokes.sort((s,o)=>s.label.localeCompare(o.label)).map(s=>this._createGroupRow(s)).flat(),n=[wt(document,"dl",{},t)];return e.label&&n.unshift(wt(document,"h4",{},e.label)),n}_createGroupRow(e){const t=this.locale.t,n=wt(document,"dt"),s=wt(document,"dd"),o=A4(e.keystroke),r=[];for(const a of o)r.push(a.map(E4).join(""));return n.innerHTML=e.label,s.innerHTML=r.join(", ")+(e.mayRequireFn&&$.isMac?` ${t("(may require <kbd>Fn</kbd>)")}`:""),[n,s]}}function E4(i){return Mo(i).split("+").map(e=>`<kbd>${e}</kbd>`).join("+")}function A4(i){return typeof i=="string"?[[i]]:typeof i[0]=="string"?[i]:i}const Bm='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 6.628a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"/><path d="M8.5 9.125a.3.3 0 0 0-.253-.296L5.11 8.327a.75.75 0 1 1 .388-1.449l4.04.716c.267.072.624.08.893.009l4.066-.724a.75.75 0 1 1 .388 1.45l-3.132.5a.3.3 0 0 0-.253.296v1.357a.3.3 0 0 0 .018.102l1.615 4.438a.75.75 0 0 1-1.41.513l-1.35-3.71a.3.3 0 0 0-.281-.197h-.209a.3.3 0 0 0-.282.198l-1.35 3.711a.75.75 0 0 1-1.41-.513l1.64-4.509a.3.3 0 0 0 .019-.103V9.125Z"/><path clip-rule="evenodd" d="M10 18.5a8.5 8.5 0 1 1 0-17 8.5 8.5 0 0 1 0 17Zm0 1.5c5.523 0 10-4.477 10-10S15.523 0 10 0 0 4.477 0 10s4.477 10 10 10Z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class x4 extends y{constructor(){super(...arguments),this.contentView=null}static get requires(){return[Xt]}static get pluginName(){return"AccessibilityHelp"}init(){const e=this.editor,t=e.locale.t;e.ui.componentFactory.add("accessibilityHelp",()=>{const n=this._createButton(N);return n.set({tooltip:!0,withText:!1,label:t("Accessibility help")}),n}),e.ui.componentFactory.add("menuBar:accessibilityHelp",()=>{const n=this._createButton(Ae);return n.label=t("Accessibility"),n}),e.keystrokes.set("Alt+0",(n,s)=>{this._showDialog(),s()}),this._setupRootLabels()}_createButton(e){const n=this.editor.locale,s=new e(n);return s.set({keystroke:"Alt+0",icon:Bm}),s.on("execute",()=>this._showDialog()),s}_setupRootLabels(){const e=this.editor,t=e.editing.view,n=e.t;e.ui.on("ready",()=>{t.change(o=>{for(const r of t.document.roots)s(o,r)}),e.on("addRoot",(o,r)=>{const a=e.editing.view.document.getRoot(r.rootName);t.change(l=>s(l,a))},{priority:"low"})});function s(o,r){const l=`${r.getAttribute("aria-label")}. ${n("Press %0 for help.",[Mo("Alt+0")])}`;o.setAttribute("aria-label",l,r)}}_showDialog(){const e=this.editor,t=e.plugins.get("Dialog"),n=e.locale.t;this.contentView||(this.contentView=new T4(e.locale,e.accessibility.keystrokeInfos)),t.show({id:"accessibilityHelp",className:"ck-accessibility-help-dialog",title:n("Accessibility help"),icon:Bm,hasCloseButton:!0,content:this.contentView})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class S4 extends Xe{constructor(e,t=[]){super(t),this.locale=e}get bodyCollectionContainer(){return this._bodyCollectionContainer}attachToDom(){this._bodyCollectionContainer=new Ue({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection},children:this}).render();let e=document.querySelector(".ck-body-wrapper");e||(e=wt(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(e)),e.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove();const e=document.querySelector(".ck-body-wrapper");e&&e.childElementCount==0&&e.remove()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Mt extends R{constructor(){super();const e=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.set("isColorInherited",!0),this.set("isVisible",!0),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon",e.if("isVisible","ck-hidden",t=>!t),"ck-reset_all-excluded",e.if("isColorInherited","ck-icon_inherit-color")],viewBox:e.to("viewBox")}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",()=>{this._updateXMLContent(),this._colorFillPaths()}),this.on("change:fillColor",()=>{this._colorFillPaths()})}_updateXMLContent(){if(this.content){const t=new DOMParser().parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg"),n=t.getAttribute("viewBox");n&&(this.viewBox=n);for(const{name:s,value:o}of Array.from(t.attributes))Mt.presentationalAttributeNames.includes(s)&&this.element.setAttribute(s,o);for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(;t.childNodes.length>0;)this.element.appendChild(t.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(e=>{e.style.fill=this.fillColor})}}Mt.presentationalAttributeNames=["alignment-baseline","baseline-shift","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-rendering","cursor","direction","display","dominant-baseline","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","mask","opacity","overflow","paint-order","pointer-events","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-overflow","text-rendering","transform","unicode-bidi","vector-effect","visibility","white-space","word-spacing","writing-mode"];/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class I4 extends R{constructor(){super(),this.set({style:void 0,text:void 0,id:void 0});const e=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:e.to("style"),id:e.to("id")},children:[{text:e.to("text")}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class N extends R{constructor(e,t=new I4){super(e),this._focusDelayed=null;const n=this.bindTemplate,s=it();this.set("ariaLabel",void 0),this.set("ariaLabelledBy",`ck-editor__aria-label_${s}`),this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke",void 0),this.set("label",void 0),this.set("role",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.labelView=this._setupLabelView(t),this.iconView=new Mt,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this));const o={tag:"button",attributes:{class:["ck","ck-button",n.to("class"),n.if("isEnabled","ck-disabled",r=>!r),n.if("isVisible","ck-hidden",r=>!r),n.to("isOn",r=>r?"ck-on":"ck-off"),n.if("withText","ck-button_with-text"),n.if("withKeystroke","ck-button_with-keystroke")],role:n.to("role"),type:n.to("type",r=>r||"button"),tabindex:n.to("tabindex"),"aria-checked":n.to("ariaChecked"),"aria-label":n.to("ariaLabel"),"aria-labelledby":n.to("ariaLabelledBy"),"aria-disabled":n.if("isEnabled",!0,r=>!r),"aria-pressed":n.to("isOn",r=>this.isToggleable?String(!!r):!1),"data-cke-tooltip-text":n.to("_tooltipString"),"data-cke-tooltip-position":n.to("tooltipPosition")},children:this.children,on:{click:n.to(r=>{this.isEnabled?this.fire("execute"):r.preventDefault()})}};$.isSafari&&(this._focusDelayed||(this._focusDelayed=el(()=>this.focus(),0)),o.on.mousedown=n.to(()=>{this._focusDelayed()}),o.on.mouseup=n.to(()=>{this._focusDelayed.cancel()})),this.setTemplate(o)}render(){super.render(),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.labelView),this.withKeystroke&&this.keystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}destroy(){this._focusDelayed&&this._focusDelayed.cancel(),super.destroy()}_setupLabelView(e){return e.bind("text","style","id").to(this,"label","labelStyle","ariaLabelledBy"),e}_createKeystrokeView(){const e=new R;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",t=>Mo(t))}]}),e}_getTooltipString(e,t,n){return e?typeof e=="string"?e:(n&&(n=Mo(n)),e instanceof Function?e(t,n):`${t}${n?` (${n})`:""}`):""}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class tr extends N{constructor(e){super(e),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new R;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class P4 extends N{constructor(e){super(e),this.buttonView=this,this._fileInputView=new R4(e),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.on("execute",()=>{this._fileInputView.open()}),this.extendTemplate({attributes:{class:"ck-file-dialog-button"}})}render(){super.render(),this.children.add(this._fileInputView)}}class R4 extends R{constructor(e){super(e),this.set("acceptedType",void 0),this.set("allowMultipleFiles",!1);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:t.to("acceptedType"),multiple:t.to("allowMultipleFiles")},on:{change:t.to(()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""})}})}open(){this.element.click()}}const Vl='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function nr(i,e){const t=i.t,n={Black:t("Black"),"Dim grey":t("Dim grey"),Grey:t("Grey"),"Light grey":t("Light grey"),White:t("White"),Red:t("Red"),Orange:t("Orange"),Yellow:t("Yellow"),"Light green":t("Light green"),Green:t("Green"),Aquamarine:t("Aquamarine"),Turquoise:t("Turquoise"),"Light blue":t("Light blue"),Blue:t("Blue"),Purple:t("Purple")};return e.map(s=>{const o=n[s.label];return o&&o!=s.label&&(s.label=o),s})}function ir(i){return i.map(M4).filter(e=>!!e)}function M4(i){return typeof i=="string"?{model:i,label:i,hasBorder:!1,view:{name:"span",styles:{color:i}}}:{model:i.color,label:i.label||i.color,hasBorder:i.hasBorder===void 0?!1:i.hasBorder,view:{name:"span",styles:{color:`${i.color}`}}}}const B4='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0z"/><path d="M14.814 6.035 8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Om extends N{constructor(e){super(e);const t=this.bindTemplate;this.set("color",void 0),this.set("hasBorder",!1),this.icon=B4,this.extendTemplate({attributes:{style:{backgroundColor:t.to("color",n=>$.isMediaForcedColors?null:n)},class:["ck","ck-color-grid__tile",t.if("hasBorder","ck-color-selector__color-tile_bordered")]}})}render(){super.render(),this.iconView.fillColor="hsl(0, 0%, 100%)"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Lm extends R{constructor(e,t){super(e);const n=t&&t.colorDefinitions?t.colorDefinitions:[];this.columns=t&&t.columns?t.columns:5;const s={gridTemplateColumns:`repeat( ${this.columns}, 1fr)`};this.set("selectedColor",void 0),this.items=this.createCollection(),this.focusTracker=new be,this.keystrokes=new Te,this.items.on("add",(o,r)=>{r.isOn=r.color===this.selectedColor}),n.forEach(o=>{const r=new Om;r.set({color:o.color,label:o.label,tooltip:!0,hasBorder:o.options.hasBorder}),r.on("execute",()=>{this.fire("execute",{value:o.color,hasBorder:o.options.hasBorder,label:o.label})}),this.items.add(r)}),this.setTemplate({tag:"div",children:this.items,attributes:{class:["ck","ck-color-grid"],style:s}}),this.on("change:selectedColor",(o,r,a)=>{for(const l of this.items)l.isOn=l.color===a})}focus(){this.items.length&&this.items.first.focus()}focusLast(){this.items.length&&this.items.last.focus()}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,t)=>{this.focusTracker.add(t.element)}),this.items.on("remove",(e,t)=>{this.focusTracker.remove(t.element)}),this.keystrokes.listenTo(this.element),Mm({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:this.columns,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}}var Vm={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};const Dm=w.getDefaultExportFromCjs(Vm);var Nm={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function Fm(i){var e,t=[],n=1,s;if(typeof i=="string")if(Dm[i])t=Dm[i].slice(),s="rgb";else if(i==="transparent")n=0,s="rgb",t=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(i)){var o=i.slice(1),r=o.length,a=r<=4;n=1,a?(t=[parseInt(o[0]+o[0],16),parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16)],r===4&&(n=parseInt(o[3]+o[3],16)/255)):(t=[parseInt(o[0]+o[1],16),parseInt(o[2]+o[3],16),parseInt(o[4]+o[5],16)],r===8&&(n=parseInt(o[6]+o[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),s="rgb"}else if(e=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(i)){var l=e[1],c=l==="rgb",o=l.replace(/a$/,"");s=o;var r=o==="cmyk"?4:o==="gray"?1:3;t=e[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(h,f){if(/%$/.test(h))return f===r?parseFloat(h)/100:o==="rgb"?parseFloat(h)*255/100:parseFloat(h);if(o[f]==="h"){if(/deg$/.test(h))return parseFloat(h);if(Nm[h]!==void 0)return Nm[h]}return parseFloat(h)}),l===o&&t.push(1),n=c||t[r]===void 0?1:t[r],t=t.slice(0,r)}else i.length>10&&/[0-9](?:\s|\/)/.test(i)&&(t=i.match(/([0-9]+)/g).map(function(u){return parseFloat(u)}),s=i.match(/([a-z])/ig).join("").toLowerCase());else isNaN(i)?Array.isArray(i)||i.length?(t=[i[0],i[1],i[2]],s="rgb",n=i.length===4?i[3]:1):i instanceof Object&&(i.r!=null||i.red!=null||i.R!=null?(s="rgb",t=[i.r||i.red||i.R||0,i.g||i.green||i.G||0,i.b||i.blue||i.B||0]):(s="hsl",t=[i.h||i.hue||i.H||0,i.s||i.saturation||i.S||0,i.l||i.lightness||i.L||i.b||i.brightness]),n=i.a||i.alpha||i.opacity||1,i.opacity!=null&&(n/=100)):(s="rgb",t=[i>>>16,(i&65280)>>>8,i&255]);return{space:s,values:t,alpha:n}}const Rs=Vm,$m={};for(const i of Object.keys(Rs))$m[Rs[i]]=i;const M={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var Um=M;for(const i of Object.keys(M)){if(!("channels"in M[i]))throw new Error("missing channels property: "+i);if(!("labels"in M[i]))throw new Error("missing channel labels property: "+i);if(M[i].labels.length!==M[i].channels)throw new Error("channel and label counts mismatch: "+i);const{channels:e,labels:t}=M[i];delete M[i].channels,delete M[i].labels,Object.defineProperty(M[i],"channels",{value:e}),Object.defineProperty(M[i],"labels",{value:t})}M.rgb.hsl=function(i){const e=i[0]/255,t=i[1]/255,n=i[2]/255,s=Math.min(e,t,n),o=Math.max(e,t,n),r=o-s;let a,l;o===s?a=0:e===o?a=(t-n)/r:t===o?a=2+(n-e)/r:n===o&&(a=4+(e-t)/r),a=Math.min(a*60,360),a<0&&(a+=360);const c=(s+o)/2;return o===s?l=0:c<=.5?l=r/(o+s):l=r/(2-o-s),[a,l*100,c*100]},M.rgb.hsv=function(i){let e,t,n,s,o;const r=i[0]/255,a=i[1]/255,l=i[2]/255,c=Math.max(r,a,l),u=c-Math.min(r,a,l),d=function(h){return(c-h)/6/u+1/2};return u===0?(s=0,o=0):(o=u/c,e=d(r),t=d(a),n=d(l),r===c?s=n-t:a===c?s=1/3+e-n:l===c&&(s=2/3+t-e),s<0?s+=1:s>1&&(s-=1)),[s*360,o*100,c*100]},M.rgb.hwb=function(i){const e=i[0],t=i[1];let n=i[2];const s=M.rgb.hsl(i)[0],o=1/255*Math.min(e,Math.min(t,n));return n=1-1/255*Math.max(e,Math.max(t,n)),[s,o*100,n*100]},M.rgb.cmyk=function(i){const e=i[0]/255,t=i[1]/255,n=i[2]/255,s=Math.min(1-e,1-t,1-n),o=(1-e-s)/(1-s)||0,r=(1-t-s)/(1-s)||0,a=(1-n-s)/(1-s)||0;return[o*100,r*100,a*100,s*100]};function O4(i,e){return(i[0]-e[0])**2+(i[1]-e[1])**2+(i[2]-e[2])**2}M.rgb.keyword=function(i){const e=$m[i];if(e)return e;let t=1/0,n;for(const s of Object.keys(Rs)){const o=Rs[s],r=O4(i,o);r<t&&(t=r,n=s)}return n},M.keyword.rgb=function(i){return Rs[i]},M.rgb.xyz=function(i){let e=i[0]/255,t=i[1]/255,n=i[2]/255;e=e>.04045?((e+.055)/1.055)**2.4:e/12.92,t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92;const s=e*.4124+t*.3576+n*.1805,o=e*.2126+t*.7152+n*.0722,r=e*.0193+t*.1192+n*.9505;return[s*100,o*100,r*100]},M.rgb.lab=function(i){const e=M.rgb.xyz(i);let t=e[0],n=e[1],s=e[2];t/=95.047,n/=100,s/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,s=s>.008856?s**(1/3):7.787*s+16/116;const o=116*n-16,r=500*(t-n),a=200*(n-s);return[o,r,a]},M.hsl.rgb=function(i){const e=i[0]/360,t=i[1]/100,n=i[2]/100;let s,o,r;if(t===0)return r=n*255,[r,r,r];n<.5?s=n*(1+t):s=n+t-n*t;const a=2*n-s,l=[0,0,0];for(let c=0;c<3;c++)o=e+1/3*-(c-1),o<0&&o++,o>1&&o--,6*o<1?r=a+(s-a)*6*o:2*o<1?r=s:3*o<2?r=a+(s-a)*(2/3-o)*6:r=a,l[c]=r*255;return l},M.hsl.hsv=function(i){const e=i[0];let t=i[1]/100,n=i[2]/100,s=t;const o=Math.max(n,.01);n*=2,t*=n<=1?n:2-n,s*=o<=1?o:2-o;const r=(n+t)/2,a=n===0?2*s/(o+s):2*t/(n+t);return[e,a*100,r*100]},M.hsv.rgb=function(i){const e=i[0]/60,t=i[1]/100;let n=i[2]/100;const s=Math.floor(e)%6,o=e-Math.floor(e),r=255*n*(1-t),a=255*n*(1-t*o),l=255*n*(1-t*(1-o));switch(n*=255,s){case 0:return[n,l,r];case 1:return[a,n,r];case 2:return[r,n,l];case 3:return[r,a,n];case 4:return[l,r,n];case 5:return[n,r,a]}},M.hsv.hsl=function(i){const e=i[0],t=i[1]/100,n=i[2]/100,s=Math.max(n,.01);let o,r;r=(2-t)*n;const a=(2-t)*s;return o=t*s,o/=a<=1?a:2-a,o=o||0,r/=2,[e,o*100,r*100]},M.hwb.rgb=function(i){const e=i[0]/360;let t=i[1]/100,n=i[2]/100;const s=t+n;let o;s>1&&(t/=s,n/=s);const r=Math.floor(6*e),a=1-n;o=6*e-r,r&1&&(o=1-o);const l=t+o*(a-t);let c,u,d;switch(r){default:case 6:case 0:c=a,u=l,d=t;break;case 1:c=l,u=a,d=t;break;case 2:c=t,u=a,d=l;break;case 3:c=t,u=l,d=a;break;case 4:c=l,u=t,d=a;break;case 5:c=a,u=t,d=l;break}return[c*255,u*255,d*255]},M.cmyk.rgb=function(i){const e=i[0]/100,t=i[1]/100,n=i[2]/100,s=i[3]/100,o=1-Math.min(1,e*(1-s)+s),r=1-Math.min(1,t*(1-s)+s),a=1-Math.min(1,n*(1-s)+s);return[o*255,r*255,a*255]},M.xyz.rgb=function(i){const e=i[0]/100,t=i[1]/100,n=i[2]/100;let s,o,r;return s=e*3.2406+t*-1.5372+n*-.4986,o=e*-.9689+t*1.8758+n*.0415,r=e*.0557+t*-.204+n*1.057,s=s>.0031308?1.055*s**(1/2.4)-.055:s*12.92,o=o>.0031308?1.055*o**(1/2.4)-.055:o*12.92,r=r>.0031308?1.055*r**(1/2.4)-.055:r*12.92,s=Math.min(Math.max(0,s),1),o=Math.min(Math.max(0,o),1),r=Math.min(Math.max(0,r),1),[s*255,o*255,r*255]},M.xyz.lab=function(i){let e=i[0],t=i[1],n=i[2];e/=95.047,t/=100,n/=108.883,e=e>.008856?e**(1/3):7.787*e+16/116,t=t>.008856?t**(1/3):7.787*t+16/116,n=n>.008856?n**(1/3):7.787*n+16/116;const s=116*t-16,o=500*(e-t),r=200*(t-n);return[s,o,r]},M.lab.xyz=function(i){const e=i[0],t=i[1],n=i[2];let s,o,r;o=(e+16)/116,s=t/500+o,r=o-n/200;const a=o**3,l=s**3,c=r**3;return o=a>.008856?a:(o-16/116)/7.787,s=l>.008856?l:(s-16/116)/7.787,r=c>.008856?c:(r-16/116)/7.787,s*=95.047,o*=100,r*=108.883,[s,o,r]},M.lab.lch=function(i){const e=i[0],t=i[1],n=i[2];let s;s=Math.atan2(n,t)*360/2/Math.PI,s<0&&(s+=360);const r=Math.sqrt(t*t+n*n);return[e,r,s]},M.lch.lab=function(i){const e=i[0],t=i[1],s=i[2]/360*2*Math.PI,o=t*Math.cos(s),r=t*Math.sin(s);return[e,o,r]},M.rgb.ansi16=function(i,e=null){const[t,n,s]=i;let o=e===null?M.rgb.hsv(i)[2]:e;if(o=Math.round(o/50),o===0)return 30;let r=30+(Math.round(s/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return o===2&&(r+=60),r},M.hsv.ansi16=function(i){return M.rgb.ansi16(M.hsv.rgb(i),i[2])},M.rgb.ansi256=function(i){const e=i[0],t=i[1],n=i[2];return e===t&&t===n?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(n/255*5)},M.ansi16.rgb=function(i){let e=i%10;if(e===0||e===7)return i>50&&(e+=3.5),e=e/10.5*255,[e,e,e];const t=(~~(i>50)+1)*.5,n=(e&1)*t*255,s=(e>>1&1)*t*255,o=(e>>2&1)*t*255;return[n,s,o]},M.ansi256.rgb=function(i){if(i>=232){const o=(i-232)*10+8;return[o,o,o]}i-=16;let e;const t=Math.floor(i/36)/5*255,n=Math.floor((e=i%36)/6)/5*255,s=e%6/5*255;return[t,n,s]},M.rgb.hex=function(i){const t=(((Math.round(i[0])&255)<<16)+((Math.round(i[1])&255)<<8)+(Math.round(i[2])&255)).toString(16).toUpperCase();return"000000".substring(t.length)+t},M.hex.rgb=function(i){const e=i.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];let t=e[0];e[0].length===3&&(t=t.split("").map(a=>a+a).join(""));const n=parseInt(t,16),s=n>>16&255,o=n>>8&255,r=n&255;return[s,o,r]},M.rgb.hcg=function(i){const e=i[0]/255,t=i[1]/255,n=i[2]/255,s=Math.max(Math.max(e,t),n),o=Math.min(Math.min(e,t),n),r=s-o;let a,l;return r<1?a=o/(1-r):a=0,r<=0?l=0:s===e?l=(t-n)/r%6:s===t?l=2+(n-e)/r:l=4+(e-t)/r,l/=6,l%=1,[l*360,r*100,a*100]},M.hsl.hcg=function(i){const e=i[1]/100,t=i[2]/100,n=t<.5?2*e*t:2*e*(1-t);let s=0;return n<1&&(s=(t-.5*n)/(1-n)),[i[0],n*100,s*100]},M.hsv.hcg=function(i){const e=i[1]/100,t=i[2]/100,n=e*t;let s=0;return n<1&&(s=(t-n)/(1-n)),[i[0],n*100,s*100]},M.hcg.rgb=function(i){const e=i[0]/360,t=i[1]/100,n=i[2]/100;if(t===0)return[n*255,n*255,n*255];const s=[0,0,0],o=e%1*6,r=o%1,a=1-r;let l=0;switch(Math.floor(o)){case 0:s[0]=1,s[1]=r,s[2]=0;break;case 1:s[0]=a,s[1]=1,s[2]=0;break;case 2:s[0]=0,s[1]=1,s[2]=r;break;case 3:s[0]=0,s[1]=a,s[2]=1;break;case 4:s[0]=r,s[1]=0,s[2]=1;break;default:s[0]=1,s[1]=0,s[2]=a}return l=(1-t)*n,[(t*s[0]+l)*255,(t*s[1]+l)*255,(t*s[2]+l)*255]},M.hcg.hsv=function(i){const e=i[1]/100,t=i[2]/100,n=e+t*(1-e);let s=0;return n>0&&(s=e/n),[i[0],s*100,n*100]},M.hcg.hsl=function(i){const e=i[1]/100,n=i[2]/100*(1-e)+.5*e;let s=0;return n>0&&n<.5?s=e/(2*n):n>=.5&&n<1&&(s=e/(2*(1-n))),[i[0],s*100,n*100]},M.hcg.hwb=function(i){const e=i[1]/100,t=i[2]/100,n=e+t*(1-e);return[i[0],(n-e)*100,(1-n)*100]},M.hwb.hcg=function(i){const e=i[1]/100,n=1-i[2]/100,s=n-e;let o=0;return s<1&&(o=(n-s)/(1-s)),[i[0],s*100,o*100]},M.apple.rgb=function(i){return[i[0]/65535*255,i[1]/65535*255,i[2]/65535*255]},M.rgb.apple=function(i){return[i[0]/255*65535,i[1]/255*65535,i[2]/255*65535]},M.gray.rgb=function(i){return[i[0]/100*255,i[0]/100*255,i[0]/100*255]},M.gray.hsl=function(i){return[0,0,i[0]]},M.gray.hsv=M.gray.hsl,M.gray.hwb=function(i){return[0,100,i[0]]},M.gray.cmyk=function(i){return[0,0,0,i[0]]},M.gray.lab=function(i){return[i[0],0,0]},M.gray.hex=function(i){const e=Math.round(i[0]/100*255)&255,n=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(n.length)+n},M.rgb.gray=function(i){return[(i[0]+i[1]+i[2])/3/255*100]};const sr=Um;function L4(){const i={},e=Object.keys(sr);for(let t=e.length,n=0;n<t;n++)i[e[n]]={distance:-1,parent:null};return i}function V4(i){const e=L4(),t=[i];for(e[i].distance=0;t.length;){const n=t.pop(),s=Object.keys(sr[n]);for(let o=s.length,r=0;r<o;r++){const a=s[r],l=e[a];l.distance===-1&&(l.distance=e[n].distance+1,l.parent=n,t.unshift(a))}}return e}function D4(i,e){return function(t){return e(i(t))}}function N4(i,e){const t=[e[i].parent,i];let n=sr[e[i].parent][i],s=e[i].parent;for(;e[s].parent;)t.unshift(e[s].parent),n=D4(sr[e[s].parent][s],n),s=e[s].parent;return n.conversion=t,n}var F4=function(i){const e=V4(i),t={},n=Object.keys(e);for(let s=n.length,o=0;o<s;o++){const r=n[o];e[r].parent!==null&&(t[r]=N4(r,e))}return t};const Dl=Um,$4=F4,Ei={},U4=Object.keys(Dl);function z4(i){const e=function(...t){const n=t[0];return n==null?n:(n.length>1&&(t=n),i(t))};return"conversion"in i&&(e.conversion=i.conversion),e}function H4(i){const e=function(...t){const n=t[0];if(n==null)return n;n.length>1&&(t=n);const s=i(t);if(typeof s=="object")for(let o=s.length,r=0;r<o;r++)s[r]=Math.round(s[r]);return s};return"conversion"in i&&(e.conversion=i.conversion),e}U4.forEach(i=>{Ei[i]={},Object.defineProperty(Ei[i],"channels",{value:Dl[i].channels}),Object.defineProperty(Ei[i],"labels",{value:Dl[i].labels});const e=$4(i);Object.keys(e).forEach(n=>{const s=e[n];Ei[i][n]=H4(s),Ei[i][n].raw=z4(s)})});var zm=Ei;const Hm=z0({__proto__:null,default:w.getDefaultExportFromCjs(zm)},[zm]);/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Wm(i,e){if(!i)return"";const t=jm(i);if(!t)return"";if(t.space===e)return i;if(!G4(t))return"";const s=Hm[t.space][e];if(!s)return"";const o=s(t.space==="hex"?t.hexValue:t.values);return q4(o,e)}function W4(i){if(!i)return"";const e=jm(i);return e?e.space==="hex"?e.hexValue:Wm(i,"hex"):"#000"}function j4(i,e){customElements.get(i)===void 0&&customElements.define(i,e)}function q4(i,e){switch(e){case"hex":return`#${i}`;case"rgb":return`rgb( ${i[0]}, ${i[1]}, ${i[2]} )`;case"hsl":return`hsl( ${i[0]}, ${i[1]}%, ${i[2]}% )`;case"hwb":return`hwb( ${i[0]}, ${i[1]}, ${i[2]} )`;case"lab":return`lab( ${i[0]}% ${i[1]} ${i[2]} )`;case"lch":return`lch( ${i[0]}% ${i[1]} ${i[2]} )`;default:return""}}function jm(i){if(i.startsWith("#")){const t=Fm(i);return{space:"hex",values:t.values,hexValue:i,alpha:t.alpha}}const e=Fm(i);return e.space?e:null}function G4(i){return Object.keys(Hm).includes(i.space)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ie extends R{constructor(e,t){super(e);const n=`ck-labeled-field-view-${it()}`,s=`ck-labeled-field-view-status-${it()}`;this.fieldView=t(this,n,s),this.set("label",void 0),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class",void 0),this.set("placeholder",void 0),this.labelView=this._createLabelView(n),this.statusView=this._createStatusView(s),this.fieldWrapperChildren=this.createCollection([this.fieldView,this.labelView]),this.bind("_statusText").to(this,"errorText",this,"infoText",(r,a)=>r||a);const o=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",o.to("class"),o.if("isEnabled","ck-disabled",r=>!r),o.if("isEmpty","ck-labeled-field-view_empty"),o.if("isFocused","ck-labeled-field-view_focused"),o.if("placeholder","ck-labeled-field-view_placeholder"),o.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:this.fieldWrapperChildren},this.statusView]})}_createLabelView(e){const t=new Qe(this.locale);return t.for=e,t.bind("text").to(this,"label"),t}_createStatusView(e){const t=new R(this.locale),n=this.bindTemplate;return t.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",n.if("errorText","ck-labeled-field-view__status_error"),n.if("_statusText","ck-hidden",s=>!s)],id:e,role:n.if("errorText","alert")},children:[{text:n.to("_statusText")}]}),t}focus(e){this.fieldView.focus(e)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class K4 extends R{constructor(e){super(e),this.set("value",void 0),this.set("id",void 0),this.set("placeholder",void 0),this.set("tabIndex",void 0),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById",void 0),this.set("ariaLabel",void 0),this.focusTracker=new be,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck","ck-input",t.if("isFocused","ck-input_focused"),t.if("isEmpty","ck-input-text_empty"),t.if("hasError","ck-error")],id:t.to("id"),placeholder:t.to("placeholder"),tabindex:t.to("tabIndex"),readonly:t.to("isReadOnly"),"aria-invalid":t.if("hasError",!0),"aria-describedby":t.to("ariaDescribedById"),"aria-label":t.to("ariaLabel")},on:{input:t.to((...n)=>{this.fire("input",...n),this._updateIsEmpty()}),change:t.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",(e,t,n)=>{this._setDomElementValue(n),this._updateIsEmpty()})}destroy(){super.destroy(),this.focusTracker.destroy()}select(){this.element.select()}focus(){this.element.focus()}reset(){this.value=this.element.value="",this._updateIsEmpty()}_updateIsEmpty(){this.isEmpty=Z4(this.element)}_setDomElementValue(e){this.element.value=!e&&e!==0?"":e}}function Z4(i){return!i.value}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class J4 extends K4{constructor(e){super(e),this.set("inputMode","text");const t=this.bindTemplate;this.extendTemplate({attributes:{inputmode:t.to("inputMode")}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class qm extends J4{constructor(e){super(e),this.extendTemplate({attributes:{type:"text",class:["ck-input-text"]}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Y4 extends R{constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",t.to("position",n=>`ck-dropdown__panel_${n}`),t.if("isVisible","ck-dropdown__panel-visible")],tabindex:"-1"},children:this.children,on:{selectstart:t.to(n=>{n.target.tagName.toLocaleLowerCase()!=="input"&&n.preventDefault()})}})}focus(){if(this.children.length){const e=this.children.first;typeof e.focus=="function"?e.focus():Q("ui-dropdown-panel-focus-child-missing-focus",{childView:this.children.first,dropdownPanel:this})}}focusLast(){if(this.children.length){const e=this.children.last;typeof e.focusLast=="function"?e.focusLast():e.focus()}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ai extends R{constructor(e,t,n){super(e);const s=this.bindTemplate;this.buttonView=t,this.panelView=n,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class",void 0),this.set("id",void 0),this.set("panelPosition","auto"),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new Te,this.focusTracker=new be,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",s.to("class"),s.if("isEnabled","ck-disabled",o=>!o)],id:s.to("id"),"aria-describedby":s.to("ariaDescribedById")},children:[t,n]}),t.extendTemplate({attributes:{class:["ck-dropdown__button"],"data-cke-tooltip-disabled":s.to("isOpen")}})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.listenTo(this.buttonView,"open",()=>{this.isOpen=!this.isOpen}),this.on("change:isOpen",(t,n,s)=>{if(s)if(this.panelPosition==="auto"){const o=Ai._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=o?o.name:this._panelPositions[0].name}else this.panelView.position=this.panelPosition}),this.keystrokes.listenTo(this.element);const e=(t,n)=>{this.isOpen&&(this.isOpen=!1,n())};this.keystrokes.set("arrowdown",(t,n)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,n())}),this.keystrokes.set("arrowright",(t,n)=>{this.isOpen&&n()}),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:e,north:t,southEast:n,southWest:s,northEast:o,northWest:r,southMiddleEast:a,southMiddleWest:l,northMiddleEast:c,northMiddleWest:u}=Ai.defaultPanelPositions;return this.locale.uiLanguageDirection!=="rtl"?[n,s,a,l,e,o,r,c,u,t]:[s,n,l,a,e,r,o,u,c,t]}}Ai.defaultPanelPositions={south:(i,e)=>({top:i.bottom,left:i.left-(e.width-i.width)/2,name:"s"}),southEast:i=>({top:i.bottom,left:i.left,name:"se"}),southWest:(i,e)=>({top:i.bottom,left:i.left-e.width+i.width,name:"sw"}),southMiddleEast:(i,e)=>({top:i.bottom,left:i.left-(e.width-i.width)/4,name:"sme"}),southMiddleWest:(i,e)=>({top:i.bottom,left:i.left-(e.width-i.width)*3/4,name:"smw"}),north:(i,e)=>({top:i.top-e.height,left:i.left-(e.width-i.width)/2,name:"n"}),northEast:(i,e)=>({top:i.top-e.height,left:i.left,name:"ne"}),northWest:(i,e)=>({top:i.top-e.height,left:i.left-e.width+i.width,name:"nw"}),northMiddleEast:(i,e)=>({top:i.top-e.height,left:i.left-(e.width-i.width)/4,name:"nme"}),northMiddleWest:(i,e)=>({top:i.top-e.height,left:i.left-(e.width-i.width)*3/4,name:"nmw"})},Ai._getOptimalPosition=Ro;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Gm extends N{constructor(e){super(e),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",t=>String(t))}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new Mt;return e.content=Vl,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class et extends ee(){constructor(e){if(super(),this.focusables=e.focusables,this.focusTracker=e.focusTracker,this.keystrokeHandler=e.keystrokeHandler,this.actions=e.actions,e.actions&&e.keystrokeHandler)for(const t in e.actions){let n=e.actions[t];typeof n=="string"&&(n=[n]);for(const s of n)e.keystrokeHandler.set(s,(o,r)=>{this[t](),r()})}this.on("forwardCycle",()=>this.focusFirst(),{priority:"low"}),this.on("backwardCycle",()=>this.focusLast(),{priority:"low"})}get first(){return this.focusables.find(Nl)||null}get last(){return this.focusables.filter(Nl).slice(-1)[0]||null}get next(){return this._getDomFocusableItem(1)}get previous(){return this._getDomFocusableItem(-1)}get current(){let e=null;return this.focusTracker.focusedElement===null?null:(this.focusables.find((t,n)=>{const s=t.element===this.focusTracker.focusedElement;return s&&(e=n),s}),e)}focusFirst(){this._focus(this.first,1)}focusLast(){this._focus(this.last,-1)}focusNext(){const e=this.next;if(e&&this.focusables.getIndex(e)===this.current){this.fire("forwardCycle");return}e===this.first?this.fire("forwardCycle"):this._focus(e,1)}focusPrevious(){const e=this.previous;if(e&&this.focusables.getIndex(e)===this.current){this.fire("backwardCycle");return}e===this.last?this.fire("backwardCycle"):this._focus(e,-1)}_focus(e,t){e&&this.focusTracker.focusedElement!==e.element&&e.focus(t)}_getDomFocusableItem(e){const t=this.focusables.length;if(!t)return null;const n=this.current;if(n===null)return this[e===1?"first":"last"];let s=this.focusables.get(n),o=(n+t+e)%t;do{const r=this.focusables.get(o);if(Nl(r)){s=r;break}o=(o+t+e)%t}while(o!==n);return s}}function Nl(i){return Ms(i)&&En(i.element)}function Ms(i){return"focus"in i&&typeof i.focus=="function"}function X4(i){return Ms(i)&&"focusCycler"in i&&i.focusCycler instanceof et}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Fl extends R{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Q4 extends R{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function eS(i){return i.bindTemplate.to(e=>{e.target===i.element&&e.preventDefault()})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Km(i){if(Array.isArray(i))return{items:i,removeItems:[]};const e={items:[],removeItems:[]};return i?{...e,...i}:e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const tS={alignLeft:P.alignLeft,bold:P.bold,importExport:P.importExport,paragraph:P.paragraph,plus:P.plus,text:P.text,threeVerticalDots:P.threeVerticalDots,pilcrow:P.pilcrow,dragIndicator:P.dragIndicator};class xi extends R{constructor(e,t){super(e);const n=this.bindTemplate,s=this.t;this.options=t||{},this.set("ariaLabel",s("Editor toolbar")),this.set("maxWidth","auto"),this.items=this.createCollection(),this.focusTracker=new be,this.keystrokes=new Te,this.set("class",void 0),this.set("isCompact",!1),this.itemsView=new nS(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection();const o=e.uiLanguageDirection==="rtl";this._focusCycler=new et({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:[o?"arrowright":"arrowleft","arrowup"],focusNext:[o?"arrowleft":"arrowright","arrowdown"]}});const r=["ck","ck-toolbar",n.to("class"),n.if("isCompact","ck-toolbar_compact")];this.options.shouldGroupWhenFull&&this.options.isFloating&&r.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:r,role:"toolbar","aria-label":n.to("ariaLabel"),style:{maxWidth:n.to("maxWidth")},tabindex:-1},children:this.children,on:{mousedown:eS(this)}}),this._behavior=this.options.shouldGroupWhenFull?new sS(this):new iS(this)}render(){super.render(),this.focusTracker.add(this.element);for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,t)=>{this.focusTracker.add(t.element)}),this.items.on("remove",(e,t)=>{this.focusTracker.remove(t.element)}),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,t,n){this.items.addMany(this._buildItemsFromConfig(e,t,n))}_buildItemsFromConfig(e,t,n){const s=Km(e),o=n||s.removeItems;return this._cleanItemsConfiguration(s.items,t,o).map(a=>ie(a)?this._createNestedToolbarDropdown(a,t,o):a==="|"?new Fl:a==="-"?new Q4:t.create(a)).filter(a=>!!a)}_cleanItemsConfiguration(e,t,n){const s=e.filter((o,r,a)=>o==="|"?!0:n.indexOf(o)!==-1?!1:o==="-"?this.options.shouldGroupWhenFull?(Q("toolbarview-line-break-ignored-when-grouping-items",a),!1):!0:!ie(o)&&!t.has(o)?(Q("toolbarview-item-unavailable",{item:o}),!1):!0);return this._cleanSeparatorsAndLineBreaks(s)}_cleanSeparatorsAndLineBreaks(e){const t=r=>r!=="-"&&r!=="|",n=e.length,s=e.findIndex(t);if(s===-1)return[];const o=n-e.slice().reverse().findIndex(t);return e.slice(s,o).filter((r,a,l)=>t(r)?!0:!(a>0&&l[a-1]===r))}_createNestedToolbarDropdown(e,t,n){let{label:s,icon:o,items:r,tooltip:a=!0,withText:l=!1}=e;if(r=this._cleanItemsConfiguration(r,t,n),!r.length)return null;const c=this.locale,u=tt(c);return s||Q("toolbarview-nested-toolbar-dropdown-missing-label",e),u.class="ck-toolbar__nested-toolbar-dropdown",u.buttonView.set({label:s,tooltip:a,withText:!!l}),o!==!1?u.buttonView.icon=tS[o]||o||P.threeVerticalDots:u.buttonView.withText=!0,lr(u,()=>u.toolbarView._buildItemsFromConfig(r,t,n)),u}}class nS extends R{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class iS{constructor(e){const t=e.bindTemplate;e.set("isVertical",!1),e.itemsView.children.bindTo(e.items).using(n=>n),e.focusables.bindTo(e.items).using(n=>Ms(n)?n:null),e.extendTemplate({attributes:{class:[t.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}}class sS{constructor(e){this.resizeObserver=null,this.cachedPadding=null,this.shouldUpdateGroupingOnNextResize=!1,this.view=e,this.viewChildren=e.children,this.viewFocusables=e.focusables,this.viewItemsView=e.itemsView,this.viewFocusTracker=e.focusTracker,this.viewLocale=e.locale,this.ungroupedItems=e.createCollection(),this.groupedItems=e.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),e.itemsView.children.bindTo(this.ungroupedItems).using(t=>t),this.ungroupedItems.on("change",this._updateFocusCyclableItems.bind(this)),e.children.on("change",this._updateFocusCyclableItems.bind(this)),e.items.on("change",(t,n)=>{const s=n.index,o=Array.from(n.added);for(const r of n.removed)s>=this.ungroupedItems.length?this.groupedItems.remove(r):this.ungroupedItems.remove(r);for(let r=s;r<s+o.length;r++){const a=o[r-s];r>this.ungroupedItems.length?this.groupedItems.add(a,r-this.ungroupedItems.length):this.ungroupedItems.add(a,r)}this._updateGrouping()}),e.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(e){this.viewElement=e.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(e)}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!En(this.viewElement)){this.shouldUpdateGroupingOnNextResize=!0;return}const e=this.groupedItems.length;let t;for(;this._areItemsOverflowing;)this._groupLastItem(),t=!0;if(!t&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==e&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const e=this.viewElement,t=this.viewLocale.uiLanguageDirection,n=new z(e.lastChild),s=new z(e);if(!this.cachedPadding){const o=I.window.getComputedStyle(e),r=t==="ltr"?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(o[r])}return t==="ltr"?n.right>s.right-this.cachedPadding:n.left<s.left+this.cachedPadding}_enableGroupingOnResize(){let e;this.resizeObserver=new rs(this.viewElement,t=>{(!e||e!==t.contentRect.width||this.shouldUpdateGroupingOnNextResize)&&(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),e=t.contentRect.width)}),this._updateGrouping()}_enableGroupingOnMaxWidthChange(e){e.on("change:maxWidth",()=>{this._updateGrouping()})}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new Fl),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const e=this.viewLocale,t=e.t,n=tt(e);return n.class="ck-toolbar__grouped-dropdown",n.panelPosition=e.uiLanguageDirection==="ltr"?"sw":"se",lr(n,this.groupedItems),n.buttonView.set({label:t("Show more items"),tooltip:!0,tooltipPosition:e.uiLanguageDirection==="rtl"?"se":"sw",icon:P.threeVerticalDots}),n}_updateFocusCyclableItems(){this.viewFocusables.clear(),this.ungroupedItems.map(e=>{Ms(e)&&this.viewFocusables.add(e)}),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Dn extends R{constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!0),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item",t.if("isVisible","ck-hidden",n=>!n)],role:"presentation"},children:this.children})}focus(){this.children.first&&this.children.first.focus()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class or extends R{constructor(e){super(e),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class rr extends R{constructor(e,t=new Qe){super(e);const n=this.bindTemplate,s=new ar(e);this.set({label:"",isVisible:!0}),this.labelView=t,this.labelView.bind("text").to(this,"label"),this.children=this.createCollection(),this.children.addMany([this.labelView,s]),s.set({role:"group",ariaLabelledBy:t.id}),s.focusTracker.destroy(),s.keystrokes.destroy(),this.items=s.items,this.setTemplate({tag:"li",attributes:{role:"presentation",class:["ck","ck-list__group",n.if("isVisible","ck-hidden",o=>!o)]},children:this.children})}focus(){if(this.items){const e=this.items.find(t=>!(t instanceof or));e&&e.focus()}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ar extends R{constructor(e){super(e),this._listItemGroupToChangeListeners=new WeakMap;const t=this.bindTemplate;this.focusables=new Xe,this.items=this.createCollection(),this.focusTracker=new be,this.keystrokes=new Te,this._focusCycler=new et({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.set("ariaLabel",void 0),this.set("ariaLabelledBy",void 0),this.set("role",void 0),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"],role:t.to("role"),"aria-label":t.to("ariaLabel"),"aria-labelledby":t.to("ariaLabelledBy")},children:this.items})}render(){super.render();for(const e of this.items)e instanceof rr?this._registerFocusableItemsGroup(e):e instanceof Dn&&this._registerFocusableListItem(e);this.items.on("change",(e,t)=>{for(const n of t.removed)n instanceof rr?this._deregisterFocusableItemsGroup(n):n instanceof Dn&&this._deregisterFocusableListItem(n);for(const n of Array.from(t.added).reverse())n instanceof rr?this._registerFocusableItemsGroup(n,t.index):this._registerFocusableListItem(n,t.index)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}focusFirst(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}_registerFocusableListItem(e,t){this.focusTracker.add(e.element),this.focusables.add(e,t)}_deregisterFocusableListItem(e){this.focusTracker.remove(e.element),this.focusables.remove(e)}_getOnGroupItemsChangeCallback(e){return(t,n)=>{for(const s of n.removed)this._deregisterFocusableListItem(s);for(const s of Array.from(n.added).reverse())this._registerFocusableListItem(s,this.items.getIndex(e)+n.index)}}_registerFocusableItemsGroup(e,t){Array.from(e.items).forEach((s,o)=>{const r=typeof t<"u"?t+o:void 0;this._registerFocusableListItem(s,r)});const n=this._getOnGroupItemsChangeCallback(e);this._listItemGroupToChangeListeners.set(e,n),e.items.on("change",n)}_deregisterFocusableItemsGroup(e){for(const t of e.items)this._deregisterFocusableListItem(t);e.items.off("change",this._listItemGroupToChangeListeners.get(e)),this._listItemGroupToChangeListeners.delete(e)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Bs extends R{constructor(e,t){super(e);const n=this.bindTemplate;this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke",void 0),this.set("withKeystroke",!1),this.set("label",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(t),this.arrowView=this._createArrowView(),this.keystrokes=new Te,this.focusTracker=new be,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",n.to("class"),n.if("isVisible","ck-hidden",s=>!s),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",(e,t)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),t())}),this.keystrokes.set("arrowleft",(e,t)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),t())})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.actionView.focus()}_createActionView(e){const t=e||new N;return e||t.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),t.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),t.delegate("execute").to(this),t}_createArrowView(){const e=new N,t=e.bindTemplate;return e.icon=Vl,e.extendTemplate({attributes:{class:["ck-splitbutton__arrow"],"data-cke-tooltip-disabled":t.to("isOn"),"aria-haspopup":!0,"aria-expanded":t.to("isOn",n=>String(n))}}),e.bind("isEnabled").to(this),e.bind("label").to(this),e.bind("tooltip").to(this),e.delegate("execute").to(this,"open"),e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function tt(i,e=Gm){const t=typeof e=="function"?new e(i):e,n=new Y4(i),s=new Ai(i,t,n);return t.bind("isEnabled").to(s),t instanceof Bs?t.arrowView.bind("isOn").to(s,"isOpen"):t.bind("isOn").to(s,"isOpen"),oS(s),s}function lr(i,e,t={}){i.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),i.isOpen?Zm(i,e,t):i.once("change:isOpen",()=>Zm(i,e,t),{priority:"highest"}),t.enableActiveItemFocusOnDropdownOpen&&Ym(i,()=>i.toolbarView.items.find(n=>n.isOn))}function Zm(i,e,t){const n=i.locale,s=n.t,o=i.toolbarView=new xi(n),r=typeof e=="function"?e():e;o.ariaLabel=t.ariaLabel||s("Dropdown toolbar"),t.maxWidth&&(o.maxWidth=t.maxWidth),t.class&&(o.class=t.class),t.isCompact&&(o.isCompact=t.isCompact),t.isVertical&&(o.isVertical=!0),r instanceof Xe?o.items.bindTo(r).using(a=>a):o.items.addMany(r),i.panelView.children.add(o),o.items.delegate("execute").to(i)}function Si(i,e,t={}){i.isOpen?Jm(i,e,t):i.once("change:isOpen",()=>Jm(i,e,t),{priority:"highest"}),Ym(i,()=>i.listView.items.find(n=>n instanceof Dn?n.children.first.isOn:!1))}function Jm(i,e,t){const n=i.locale,s=i.listView=new ar(n),o=typeof e=="function"?e():e;s.ariaLabel=t.ariaLabel,s.role=t.role,Xm(i,s.items,o,n),i.panelView.children.add(s),s.items.delegate("execute").to(i)}function Ym(i,e){i.on("change:isOpen",()=>{if(!i.isOpen)return;const t=e();t&&(typeof t.focus=="function"?t.focus():Q("ui-dropdown-focus-child-on-open-child-missing-focus",{view:t}))},{priority:We.low-10})}function oS(i){rS(i),aS(i),lS(i),cS(i),uS(i),dS(i)}function rS(i){i.on("render",()=>{Vn({emitter:i,activator:()=>i.isOpen,callback:()=>{i.isOpen=!1},contextElements:()=>[i.element,...i.focusTracker._elements]})})}function aS(i){i.on("execute",e=>{e.source instanceof tr||(i.isOpen=!1)})}function lS(i){i.focusTracker.on("change:isFocused",(e,t,n)=>{i.isOpen&&!n&&(i.isOpen=!1)})}function cS(i){i.keystrokes.set("arrowdown",(e,t)=>{i.isOpen&&(i.panelView.focus(),t())}),i.keystrokes.set("arrowup",(e,t)=>{i.isOpen&&(i.panelView.focusLast(),t())})}function uS(i){i.on("change:isOpen",(e,t,n)=>{if(n)return;const s=i.panelView.element;s&&s.contains(I.document.activeElement)&&i.buttonView.focus()})}function dS(i){i.on("change:isOpen",(e,t,n)=>{n&&i.panelView.focus()},{priority:"low"})}function Xm(i,e,t,n){e.bindTo(t).using(s=>{if(s.type==="separator")return new or(n);if(s.type==="group"){const o=new rr(n);return o.set({label:s.label}),Xm(i,o.items,s.items,n),o.items.delegate("execute").to(i),o}else if(s.type==="button"||s.type==="switchbutton"){const o=new Dn(n);let r;return s.type==="button"?(r=new N(n),r.bind("ariaChecked").to(r,"isOn")):r=new tr(n),r.bind(...Object.keys(s.model)).to(s.model),r.delegate("execute").to(o),o.children.add(r),o}return null})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Bt=(i,e,t)=>{const n=new qm(i.locale);return n.set({id:e,ariaDescribedById:t}),n.bind("isReadOnly").to(i,"isEnabled",s=>!s),n.bind("hasError").to(i,"errorText",s=>!!s),n.on("input",()=>{i.errorText=null}),i.bind("isEmpty","isFocused","placeholder").to(n),n},Qm=(i,e,t)=>{const n=tt(i.locale);return n.set({id:e,ariaDescribedById:t}),n.bind("isEnabled").to(i),n},Os=(i,e=0,t=1)=>i>t?t:i<e?e:i,Ee=(i,e=0,t=Math.pow(10,e))=>Math.round(t*i)/t,hS=i=>bS($l(i)),$l=i=>(i[0]==="#"&&(i=i.substring(1)),i.length<6?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16),a:i.length===4?Ee(parseInt(i[3]+i[3],16)/255,2):1}:{r:parseInt(i.substring(0,2),16),g:parseInt(i.substring(2,4),16),b:parseInt(i.substring(4,6),16),a:i.length===8?Ee(parseInt(i.substring(6,8),16)/255,2):1}),fS=i=>pS(gS(i)),mS=({h:i,s:e,v:t,a:n})=>{const s=(200-e)*t/100;return{h:Ee(i),s:Ee(s>0&&s<200?e*t/100/(s<=100?s:200-s)*100:0),l:Ee(s/2),a:Ee(n,2)}},Ul=i=>{const{h:e,s:t,l:n}=mS(i);return`hsl(${e}, ${t}%, ${n}%)`},gS=({h:i,s:e,v:t,a:n})=>{i=i/360*6,e=e/100,t=t/100;const s=Math.floor(i),o=t*(1-e),r=t*(1-(i-s)*e),a=t*(1-(1-i+s)*e),l=s%6;return{r:Ee([t,r,o,o,a,t][l]*255),g:Ee([a,t,t,r,o,o][l]*255),b:Ee([o,o,a,t,t,r][l]*255),a:Ee(n,2)}},cr=i=>{const e=i.toString(16);return e.length<2?"0"+e:e},pS=({r:i,g:e,b:t,a:n})=>{const s=n<1?cr(Ee(n*255)):"";return"#"+cr(i)+cr(e)+cr(t)+s},bS=({r:i,g:e,b:t,a:n})=>{const s=Math.max(i,e,t),o=s-Math.min(i,e,t),r=o?s===i?(e-t)/o:s===e?2+(t-i)/o:4+(i-e)/o:0;return{h:Ee(60*(r<0?r+6:r)),s:Ee(s?o/s*100:0),v:Ee(s/255*100),a:n}},eg=(i,e)=>{if(i===e)return!0;for(const t in i)if(i[t]!==e[t])return!1;return!0},wS=(i,e)=>i.toLowerCase()===e.toLowerCase()?!0:eg($l(i),$l(e)),tg={},ng=i=>{let e=tg[i];return e||(e=document.createElement("template"),e.innerHTML=i,tg[i]=e),e},zl=(i,e,t)=>{i.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:t}))};let Ii=!1;const Hl=i=>"touches"in i,_S=i=>Ii&&!Hl(i)?!1:(Ii||(Ii=Hl(i)),!0),ig=(i,e)=>{const t=Hl(e)?e.touches[0]:e,n=i.el.getBoundingClientRect();zl(i.el,"move",i.getMove({x:Os((t.pageX-(n.left+window.pageXOffset))/n.width),y:Os((t.pageY-(n.top+window.pageYOffset))/n.height)}))},vS=(i,e)=>{const t=e.keyCode;t>40||i.xy&&t<37||t<33||(e.preventDefault(),zl(i.el,"move",i.getMove({x:t===39?.01:t===37?-.01:t===34?.05:t===33?-.05:t===35?1:t===36?-1:0,y:t===40?.01:t===38?-.01:0},!0)))};class sg{constructor(e,t,n,s){const o=ng(`<div role="slider" tabindex="0" part="${t}" ${n}><div part="${t}-pointer"></div></div>`);e.appendChild(o.content.cloneNode(!0));const r=e.querySelector(`[part=${t}]`);r.addEventListener("mousedown",this),r.addEventListener("touchstart",this),r.addEventListener("keydown",this),this.el=r,this.xy=s,this.nodes=[r.firstChild,r]}set dragging(e){const t=e?document.addEventListener:document.removeEventListener;t(Ii?"touchmove":"mousemove",this),t(Ii?"touchend":"mouseup",this)}handleEvent(e){switch(e.type){case"mousedown":case"touchstart":if(e.preventDefault(),!_S(e)||!Ii&&e.button!=0)return;this.el.focus(),ig(this,e),this.dragging=!0;break;case"mousemove":case"touchmove":e.preventDefault(),ig(this,e);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":vS(this,e);break}}style(e){e.forEach((t,n)=>{for(const s in t)this.nodes[n].style.setProperty(s,t[s])})}}class yS extends sg{constructor(e){super(e,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:e}){this.h=e,this.style([{left:`${e/360*100}%`,color:Ul({h:e,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${Ee(e)}`)}getMove(e,t){return{h:t?Os(this.h+e.x*360,0,360):360*e.x}}}class CS extends sg{constructor(e){super(e,"saturation",'aria-label="Color"',!0)}update(e){this.hsva=e,this.style([{top:`${100-e.v}%`,left:`${e.s}%`,color:Ul(e)},{"background-color":Ul({h:e.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${Ee(e.s)}%, Brightness ${Ee(e.v)}%`)}getMove(e,t){return{s:t?Os(this.hsva.s+e.x*100,0,100):e.x*100,v:t?Os(this.hsva.v-e.y*100,0,100):Math.round(100-e.y*100)}}}const kS=':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',TS="[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}",ES="[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}",ur=Symbol("same"),Wl=Symbol("color"),og=Symbol("hsva"),jl=Symbol("update"),rg=Symbol("parts"),ag=Symbol("css"),lg=Symbol("sliders");class AS extends HTMLElement{static get observedAttributes(){return["color"]}get[ag](){return[kS,TS,ES]}get[lg](){return[CS,yS]}get color(){return this[Wl]}set color(e){if(!this[ur](e)){const t=this.colorModel.toHsva(e);this[jl](t),this[Wl]=e}}constructor(){super();const e=ng(`<style>${this[ag].join("")}</style>`),t=this.attachShadow({mode:"open"});t.appendChild(e.content.cloneNode(!0)),t.addEventListener("move",this),this[rg]=this[lg].map(n=>new n(t))}connectedCallback(){if(this.hasOwnProperty("color")){const e=this.color;delete this.color,this.color=e}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(e,t,n){const s=this.colorModel.fromAttr(n);this[ur](s)||(this.color=s)}handleEvent(e){const t=this[og],n={...t,...e.detail};this[jl](n);let s;!eg(n,t)&&!this[ur](s=this.colorModel.fromHsva(n))&&(this[Wl]=s,zl(this,"color-changed",{value:s}))}[ur](e){return this.color&&this.colorModel.equal(e,this.color)}[jl](e){this[og]=e,this[rg].forEach(t=>t.update(e))}}const xS={defaultColor:"#000",toHsva:hS,fromHsva:({h:i,s:e,v:t})=>fS({h:i,s:e,v:t,a:1}),equal:wS,fromAttr:i=>i};class SS extends AS{get colorModel(){return xS}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const IS=150;class PS extends R{constructor(e,t={}){super(e),this.set({color:"",_hexColor:""}),this.hexInputRow=this._createInputRow();const n=this.createCollection();t.hideInput||n.add(this.hexInputRow),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker"],tabindex:-1},children:n}),this._config=t,this._debounceColorPickerEvent=St(s=>{this.set("color",s),this.fire("colorSelected",{color:this.color})},IS,{leading:!0}),this.on("set:color",(s,o,r)=>{s.return=Wm(r,this._config.format||"hsl")}),this.on("change:color",()=>{this._hexColor=ql(this.color)}),this.on("change:_hexColor",()=>{document.activeElement!==this.picker&&this.picker.setAttribute("color",this._hexColor),ql(this.color)!=ql(this._hexColor)&&(this.color=this._hexColor)})}render(){if(super.render(),j4("hex-color-picker",SS),this.picker=I.document.createElement("hex-color-picker"),this.picker.setAttribute("class","hex-color-picker"),this.picker.setAttribute("tabindex","-1"),this._createSlidersView(),this.element){this.hexInputRow.element?this.element.insertBefore(this.picker,this.hexInputRow.element):this.element.appendChild(this.picker);const e=document.createElement("style");e.textContent='[role="slider"]:focus [part$="pointer"] {border: 1px solid #fff;outline: 1px solid var(--ck-color-focus-border);box-shadow: 0 0 0 2px #fff;}',this.picker.shadowRoot.appendChild(e)}this.picker.addEventListener("color-changed",e=>{const t=e.detail.value;this._debounceColorPickerEvent(t)})}focus(){/* istanbul ignore next -- @preserve */!this._config.hideInput&&($.isGecko||$.isiOS||$.isSafari)&&this.hexInputRow.children.get(1).focus(),this.slidersView.first.focus()}_createSlidersView(){const n=[...this.picker.shadowRoot.children].filter(s=>s.getAttribute("role")==="slider").map(s=>new RS(s));this.slidersView=this.createCollection(),n.forEach(s=>{this.slidersView.add(s)})}_createInputRow(){const e=this._createColorInput();return new BS(this.locale,e)}_createColorInput(){const e=new Ie(this.locale,Bt),{t}=this.locale;return e.set({label:t("HEX"),class:"color-picker-hex-input"}),e.fieldView.bind("value").to(this,"_hexColor",n=>e.isFocused?e.fieldView.value:n.startsWith("#")?n.substring(1):n),e.fieldView.on("input",()=>{const n=e.fieldView.element.value;if(n){const s=cg(n);s&&this._debounceColorPickerEvent(s)}}),e}isValid(){const{t:e}=this.locale;return this.resetValidationStatus(),this.hexInputRow.getParsedColor()?!0:(this.hexInputRow.inputView.errorText=e('Please enter a valid color (e.g. "ff0000").'),!1)}resetValidationStatus(){this.hexInputRow.inputView.errorText=null}}function ql(i){let e=W4(i);return e||(e="#000"),e.length===4&&(e="#"+[e[1],e[1],e[2],e[2],e[3],e[3]].join("")),e.toLowerCase()}class RS extends R{constructor(e){super(),this.element=e}focus(){this.element.focus()}}class MS extends R{constructor(e){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__hash-view"]},children:"#"})}}class BS extends R{constructor(e,t){super(e),this.inputView=t,this.children=this.createCollection([new MS,this.inputView]),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__row"]},children:this.children})}getParsedColor(){return cg(this.inputView.fieldView.element.value)}}function cg(i){if(!i)return null;const e=i.trim().replace(/^#/,"");return![3,4,6,8].includes(e.length)||!/^(([0-9a-fA-F]{2}){3,4}|([0-9a-fA-F]){3,4})$/.test(e)?null:`#${e}`}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class OS extends re(Oe){constructor(e){super(e),this.set("isEmpty",!0),this.on("change",()=>{this.set("isEmpty",this.length===0)})}add(e,t){return this.find(n=>n.color===e.color)?this:super.add(e,t)}hasColor(e){return!!this.find(t=>t.color===e)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const{eraser:LS,colorPalette:VS}=P;class DS extends R{constructor(e,{colors:t,columns:n,removeButtonLabel:s,documentColorsLabel:o,documentColorsCount:r,colorPickerLabel:a,focusTracker:l,focusables:c}){super(e);const u=this.bindTemplate;this.set("isVisible",!0),this.focusTracker=l,this.items=this.createCollection(),this.colorDefinitions=t,this.columns=n,this.documentColors=new OS,this.documentColorsCount=r,this._focusables=c,this._removeButtonLabel=s,this._colorPickerLabel=a,this._documentColorsLabel=o,this.setTemplate({tag:"div",attributes:{class:["ck-color-grids-fragment",u.if("isVisible","ck-hidden",d=>!d)]},children:this.items}),this.removeColorButtonView=this._createRemoveColorButton(),this.items.add(this.removeColorButtonView)}updateDocumentColors(e,t){const n=e.document,s=this.documentColorsCount;this.documentColors.clear();for(const o of n.getRoots()){const r=e.createRangeIn(o);for(const a of r.getItems())if(a.is("$textProxy")&&a.hasAttribute(t)&&(this._addColorToDocumentColors(a.getAttribute(t)),this.documentColors.length>=s))return}}updateSelectedColors(){const e=this.documentColorsGrid,t=this.staticColorsGrid,n=this.selectedColor;t.selectedColor=n,e&&(e.selectedColor=n)}render(){if(super.render(),this.staticColorsGrid=this._createStaticColorsGrid(),this.items.add(this.staticColorsGrid),this.documentColorsCount){const e=Ue.bind(this.documentColors,this.documentColors),t=new Qe(this.locale);t.text=this._documentColorsLabel,t.extendTemplate({attributes:{class:["ck","ck-color-grid__label",e.if("isEmpty","ck-hidden")]}}),this.items.add(t),this.documentColorsGrid=this._createDocumentColorsGrid(),this.items.add(this.documentColorsGrid)}this._createColorPickerButton(),this._addColorSelectorElementsToFocusTracker()}focus(){this.removeColorButtonView.focus()}destroy(){super.destroy()}addColorPickerButton(){this.colorPickerButtonView&&(this.items.add(this.colorPickerButtonView),this.focusTracker.add(this.colorPickerButtonView.element),this._focusables.add(this.colorPickerButtonView))}_addColorSelectorElementsToFocusTracker(){this.focusTracker.add(this.removeColorButtonView.element),this._focusables.add(this.removeColorButtonView),this.staticColorsGrid&&(this.focusTracker.add(this.staticColorsGrid.element),this._focusables.add(this.staticColorsGrid)),this.documentColorsGrid&&(this.focusTracker.add(this.documentColorsGrid.element),this._focusables.add(this.documentColorsGrid))}_createColorPickerButton(){this.colorPickerButtonView=new N,this.colorPickerButtonView.set({label:this._colorPickerLabel,withText:!0,icon:VS,class:"ck-color-selector__color-picker"}),this.colorPickerButtonView.on("execute",()=>{this.fire("colorPicker:show")})}_createRemoveColorButton(){const e=new N;return e.set({withText:!0,icon:LS,label:this._removeButtonLabel}),e.class="ck-color-selector__remove-color",e.on("execute",()=>{this.fire("execute",{value:null,source:"removeColorButton"})}),e.render(),e}_createStaticColorsGrid(){const e=new Lm(this.locale,{colorDefinitions:this.colorDefinitions,columns:this.columns});return e.on("execute",(t,n)=>{this.fire("execute",{value:n.value,source:"staticColorsGrid"})}),e}_createDocumentColorsGrid(){const e=Ue.bind(this.documentColors,this.documentColors),t=new Lm(this.locale,{columns:this.columns});return t.extendTemplate({attributes:{class:e.if("isEmpty","ck-hidden")}}),t.items.bindTo(this.documentColors).using(n=>{const s=new Om;return s.set({color:n.color,hasBorder:n.options&&n.options.hasBorder}),n.label&&s.set({label:n.label,tooltip:!0}),s.on("execute",()=>{this.fire("execute",{value:n.color,source:"documentColorsGrid"})}),s}),this.documentColors.on("change:isEmpty",(n,s,o)=>{o&&(t.selectedColor=null)}),t}_addColorToDocumentColors(e){const t=this.colorDefinitions.find(n=>n.color===e);t?this.documentColors.add(Object.assign({},t)):this.documentColors.add({color:e,label:e,options:{hasBorder:!1}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class NS extends R{constructor(e,{focusTracker:t,focusables:n,keystrokes:s,colorPickerViewConfig:o}){super(e),this.items=this.createCollection(),this.focusTracker=t,this.keystrokes=s,this.set("isVisible",!1),this.set("selectedColor",void 0),this._focusables=n,this._colorPickerViewConfig=o;const r=this.bindTemplate,{saveButtonView:a,cancelButtonView:l}=this._createActionButtons();this.saveButtonView=a,this.cancelButtonView=l,this.actionBarView=this._createActionBarView({saveButtonView:a,cancelButtonView:l}),this.setTemplate({tag:"div",attributes:{class:["ck-color-picker-fragment",r.if("isVisible","ck-hidden",c=>!c)]},children:this.items})}render(){super.render();const e=new PS(this.locale,{...this._colorPickerViewConfig});this.colorPickerView=e,this.colorPickerView.render(),this.selectedColor&&(e.color=this.selectedColor),this.listenTo(this,"change:selectedColor",(t,n,s)=>{e.color=s}),this.items.add(this.colorPickerView),this.items.add(this.actionBarView),this._addColorPickersElementsToFocusTracker(),this._stopPropagationOnArrowsKeys(),this._executeOnEnterPress(),this._executeUponColorChange()}destroy(){super.destroy()}focus(){this.colorPickerView.focus()}resetValidationStatus(){this.colorPickerView.resetValidationStatus()}_executeOnEnterPress(){this.keystrokes.set("enter",e=>{this.isVisible&&this.focusTracker.focusedElement!==this.cancelButtonView.element&&this.colorPickerView.isValid()&&(this.fire("execute",{value:this.selectedColor}),e.stopPropagation(),e.preventDefault())})}_stopPropagationOnArrowsKeys(){const e=t=>t.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}_addColorPickersElementsToFocusTracker(){for(const t of this.colorPickerView.slidersView)this.focusTracker.add(t.element),this._focusables.add(t);const e=this.colorPickerView.hexInputRow.children.get(1);e.element&&(this.focusTracker.add(e.element),this._focusables.add(e)),this.focusTracker.add(this.saveButtonView.element),this._focusables.add(this.saveButtonView),this.focusTracker.add(this.cancelButtonView.element),this._focusables.add(this.cancelButtonView)}_createActionBarView({saveButtonView:e,cancelButtonView:t}){const n=new R,s=this.createCollection();return s.add(e),s.add(t),n.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector_action-bar"]},children:s}),n}_createActionButtons(){const e=this.locale,t=e.t,n=new N(e),s=new N(e);return n.set({icon:P.check,class:"ck-button-save",type:"button",withText:!1,label:t("Accept")}),s.set({icon:P.cancel,class:"ck-button-cancel",type:"button",withText:!1,label:t("Cancel")}),n.on("execute",()=>{this.colorPickerView.isValid()&&this.fire("execute",{source:"colorPickerSaveButton",value:this.selectedColor})}),s.on("execute",()=>{this.fire("colorPicker:cancel")}),{saveButtonView:n,cancelButtonView:s}}_executeUponColorChange(){this.colorPickerView.on("colorSelected",(e,t)=>{this.fire("execute",{value:t.color,source:"colorPicker"}),this.set("selectedColor",t.color)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class FS extends R{constructor(e,{colors:t,columns:n,removeButtonLabel:s,documentColorsLabel:o,documentColorsCount:r,colorPickerLabel:a,colorPickerViewConfig:l}){super(e),this.items=this.createCollection(),this.focusTracker=new be,this.keystrokes=new Te,this._focusables=new Xe,this._colorPickerViewConfig=l,this._focusCycler=new et({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.colorGridsFragmentView=new DS(e,{colors:t,columns:n,removeButtonLabel:s,documentColorsLabel:o,documentColorsCount:r,colorPickerLabel:a,focusTracker:this.focusTracker,focusables:this._focusables}),this.colorPickerFragmentView=new NS(e,{focusables:this._focusables,focusTracker:this.focusTracker,keystrokes:this.keystrokes,colorPickerViewConfig:l}),this.set("_isColorGridsFragmentVisible",!0),this.set("_isColorPickerFragmentVisible",!1),this.set("selectedColor",void 0),this.colorGridsFragmentView.bind("isVisible").to(this,"_isColorGridsFragmentVisible"),this.colorPickerFragmentView.bind("isVisible").to(this,"_isColorPickerFragmentVisible"),this.on("change:selectedColor",(c,u,d)=>{this.colorGridsFragmentView.set("selectedColor",d),this.colorPickerFragmentView.set("selectedColor",d)}),this.colorGridsFragmentView.on("change:selectedColor",(c,u,d)=>{this.set("selectedColor",d)}),this.colorPickerFragmentView.on("change:selectedColor",(c,u,d)=>{this.set("selectedColor",d)}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector"]},children:this.items})}render(){super.render(),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}appendUI(){this._appendColorGridsFragment(),this._colorPickerViewConfig&&this._appendColorPickerFragment()}showColorPickerFragment(){!this.colorPickerFragmentView.colorPickerView||this._isColorPickerFragmentVisible||(this._isColorPickerFragmentVisible=!0,this.colorPickerFragmentView.focus(),this.colorPickerFragmentView.resetValidationStatus(),this._isColorGridsFragmentVisible=!1)}showColorGridsFragment(){this._isColorGridsFragmentVisible||(this._isColorGridsFragmentVisible=!0,this.colorGridsFragmentView.focus(),this._isColorPickerFragmentVisible=!1)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}updateDocumentColors(e,t){this.colorGridsFragmentView.updateDocumentColors(e,t)}updateSelectedColors(){this.colorGridsFragmentView.updateSelectedColors()}_appendColorGridsFragment(){this.items.length||(this.items.add(this.colorGridsFragmentView),this.colorGridsFragmentView.delegate("execute").to(this),this.colorGridsFragmentView.delegate("colorPicker:show").to(this))}_appendColorPickerFragment(){this.items.length!==2&&(this.items.add(this.colorPickerFragmentView),this.colorGridsFragmentView.colorPickerButtonView&&this.colorGridsFragmentView.colorPickerButtonView.on("execute",()=>{this.showColorPickerFragment()}),this.colorGridsFragmentView.addColorPickerButton(),this.colorPickerFragmentView.delegate("execute").to(this),this.colorPickerFragmentView.delegate("colorPicker:cancel").to(this))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $S{constructor(e){this._components=new Map,this.editor=e}*names(){for(const e of this._components.values())yield e.originalName}add(e,t){this._components.set(Gl(e),{callback:t,originalName:e})}create(e){if(!this.has(e))throw new p("componentfactory-item-missing",this,{name:e});return this._components.get(Gl(e)).callback(this.editor.locale)}has(e){return this._components.has(Gl(e))}}function Gl(i){return String(i).toLowerCase()}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Kl extends R{constructor(e,t={}){super(e);const n=this.bindTemplate;this.set("label",t.label||""),this.set("class",t.class||null),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__header",n.to("class")]},children:this.children}),t.icon&&(this.iconView=new Mt,this.iconView.content=t.icon,this.children.add(this.iconView));const s=new R(e);s.setTemplate({tag:"h2",attributes:{class:["ck","ck-form__header__label"],role:"presentation"},children:[{text:n.to("label")}]}),this.children.add(s)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function US(i){class e extends i{constructor(...n){super(...n),this._onDragBound=this._onDrag.bind(this),this._onDragEndBound=this._onDragEnd.bind(this),this._lastDraggingCoordinates={x:0,y:0},this.on("render",()=>{this._attachListeners()}),this.set("isDragging",!1)}_attachListeners(){this.listenTo(this.element,"mousedown",this._onDragStart.bind(this)),this.listenTo(this.element,"touchstart",this._onDragStart.bind(this))}_attachDragListeners(){this.listenTo(I.document,"mouseup",this._onDragEndBound),this.listenTo(I.document,"touchend",this._onDragEndBound),this.listenTo(I.document,"mousemove",this._onDragBound),this.listenTo(I.document,"touchmove",this._onDragBound)}_detachDragListeners(){this.stopListening(I.document,"mouseup",this._onDragEndBound),this.stopListening(I.document,"touchend",this._onDragEndBound),this.stopListening(I.document,"mousemove",this._onDragBound),this.stopListening(I.document,"touchmove",this._onDragBound)}_onDragStart(n,s){if(!this._isHandleElementPressed(s))return;this._attachDragListeners();let o=0,r=0;s instanceof MouseEvent?(o=s.clientX,r=s.clientY):(o=s.touches[0].clientX,r=s.touches[0].clientY),this._lastDraggingCoordinates={x:o,y:r},this.isDragging=!0}_onDrag(n,s){if(!this.isDragging){this._detachDragListeners();return}let o=0,r=0;s instanceof MouseEvent?(o=s.clientX,r=s.clientY):(o=s.touches[0].clientX,r=s.touches[0].clientY),s.preventDefault(),this.fire("drag",{deltaX:Math.round(o-this._lastDraggingCoordinates.x),deltaY:Math.round(r-this._lastDraggingCoordinates.y)}),this._lastDraggingCoordinates={x:o,y:r}}_onDragEnd(){this._detachDragListeners(),this.isDragging=!1}_isHandleElementPressed(n){return this.dragHandleElement?this.dragHandleElement===n.target||n.target instanceof HTMLElement&&this.dragHandleElement.contains(n.target):!1}}return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class zS extends R{constructor(e){super(e),this.children=this.createCollection(),this.keystrokes=new Te,this._focusTracker=new be,this._focusables=new Xe,this.focusCycler=new et({focusables:this._focusables,focusTracker:this._focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__actions"]},children:this.children})}render(){super.render(),this.keystrokes.listenTo(this.element)}setButtons(e){for(const t of e){const n=new N(this.locale);let s;n.on("execute",()=>t.onExecute()),t.onCreate&&t.onCreate(n);for(s in t)s!="onExecute"&&s!="onCreate"&&n.set(s,t[s]);this.children.add(n)}this._updateFocusCyclableItems()}focus(e){e===-1?this.focusCycler.focusLast():this.focusCycler.focusFirst()}_updateFocusCyclableItems(){Array.from(this.children).forEach(e=>{this._focusables.add(e),this._focusTracker.add(e.element)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class HS extends R{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__content"]},children:this.children})}reset(){for(;this.children.length;)this.children.remove(0)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Tt={SCREEN_CENTER:"screen-center",EDITOR_CENTER:"editor-center",EDITOR_TOP_SIDE:"editor-top-side",EDITOR_TOP_CENTER:"editor-top-center",EDITOR_BOTTOM_CENTER:"editor-bottom-center",EDITOR_ABOVE_CENTER:"editor-above-center",EDITOR_BELOW_CENTER:"editor-below-center"},ug=di("px");class Pi extends US(R){constructor(e,{getCurrentDomRoot:t,getViewportOffset:n}){super(e),this.wasMoved=!1;const s=this.bindTemplate,o=e.t;this.set("className",""),this.set("ariaLabel",o("Editor dialog")),this.set("isModal",!1),this.set("position",Tt.SCREEN_CENTER),this.set("_isVisible",!1),this.set("_isTransparent",!1),this.set("_top",0),this.set("_left",0),this._getCurrentDomRoot=t,this._getViewportOffset=n,this.decorate("moveTo"),this.parts=this.createCollection(),this.keystrokes=new Te,this.focusTracker=new be,this._focusables=new Xe,this._focusCycler=new et({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog-overlay",s.if("isModal","ck-dialog-overlay__transparent",r=>!r),s.if("_isVisible","ck-hidden",r=>!r)],tabindex:"-1"},children:[{tag:"div",attributes:{tabindex:"-1",class:["ck","ck-dialog",s.to("className")],role:"dialog","aria-label":s.to("ariaLabel"),style:{top:s.to("_top",r=>ug(r)),left:s.to("_left",r=>ug(r)),visibility:s.if("_isTransparent","hidden")}},children:this.parts}]})}render(){super.render(),this.keystrokes.set("Esc",(e,t)=>{this.fire("close",{source:"escKeyPress"}),t()}),this.on("drag",(e,{deltaX:t,deltaY:n})=>{this.wasMoved=!0,this.moveBy(t,n)}),this.listenTo(I.window,"resize",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.listenTo(I.document,"scroll",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.on("change:_isVisible",(e,t,n)=>{n&&(this._isTransparent=!0,setTimeout(()=>{this.updatePosition(),this._isTransparent=!1,this.focus()},10))}),this.keystrokes.listenTo(this.element)}get dragHandleElement(){return this.headerView?this.headerView.element:null}setupParts({icon:e,title:t,hasCloseButton:n=!0,content:s,actionButtons:o}){t&&(this.headerView=new Kl(this.locale,{icon:e}),n&&(this.closeButtonView=this._createCloseButton(),this.headerView.children.add(this.closeButtonView)),this.headerView.label=t,this.ariaLabel=t,this.parts.add(this.headerView,0)),s&&(s instanceof R&&(s=[s]),this.contentView=new HS(this.locale),this.contentView.children.addMany(s),this.parts.add(this.contentView)),o&&(this.actionsView=new zS(this.locale),this.actionsView.setButtons(o),this.parts.add(this.actionsView)),this._updateFocusCyclableItems()}focus(){this._focusCycler.focusFirst()}moveTo(e,t){const n=this._getViewportRect(),s=this._getDialogRect();e+s.width>n.right&&(e=n.right-s.width),e<n.left&&(e=n.left),t<n.top&&(t=n.top),this._moveTo(e,t)}_moveTo(e,t){this._left=e,this._top=t}moveBy(e,t){this.moveTo(this._left+e,this._top+t)}_moveOffScreen(){this._moveTo(-9999,-9999)}updatePosition(){if(!this.element||!this.element.parentNode)return;const e=this._getViewportRect();let t=this.position,n;this._getCurrentDomRoot()?n=this._getVisibleDomRootRect(e):t=Tt.SCREEN_CENTER;const s=Pi.defaultOffset,o=this._getDialogRect();switch(t){case Tt.EDITOR_TOP_SIDE:{if(n){const r=this.locale.contentLanguageDirection==="ltr"?n.right-o.width-s:n.left+s;this.moveTo(r,n.top+s)}else this._moveOffScreen();break}case Tt.EDITOR_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),Math.round(n.top+n.height/2-o.height/2)):this._moveOffScreen();break}case Tt.SCREEN_CENTER:{this.moveTo(Math.round((e.width-o.width)/2),Math.round((e.height-o.height)/2));break}case Tt.EDITOR_TOP_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),n.top+s):this._moveOffScreen();break}case Tt.EDITOR_BOTTOM_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),n.bottom-o.height-s):this._moveOffScreen();break}case Tt.EDITOR_ABOVE_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),n.top-o.height-s):this._moveOffScreen();break}case Tt.EDITOR_BELOW_CENTER:{n?this.moveTo(Math.round(n.left+n.width/2-o.width/2),n.bottom+s):this._moveOffScreen();break}}}_getVisibleDomRootRect(e){let t=new z(this._getCurrentDomRoot()).getVisible();if(t){if(t=e.getIntersection(t),!t)return null}else return null;return t}_getDialogRect(){return new z(this.element.firstElementChild)}_getViewportRect(){return WS(this._getViewportOffset())}_updateFocusCyclableItems(){const e=[];if(this.contentView)for(const t of this.contentView.children)Ms(t)&&e.push(t);this.actionsView&&e.push(this.actionsView),this.closeButtonView&&e.push(this.closeButtonView),e.forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element),X4(t)&&(this.listenTo(t.focusCycler,"forwardCycle",n=>{this._focusCycler.focusNext(),this._focusCycler.next!==this._focusCycler.focusables.get(this._focusCycler.current)&&n.stop()}),this.listenTo(t.focusCycler,"backwardCycle",n=>{this._focusCycler.focusPrevious(),this._focusCycler.previous!==this._focusCycler.focusables.get(this._focusCycler.current)&&n.stop()}))})}_createCloseButton(){const e=new N(this.locale),t=this.locale.t;return e.set({label:t("Close"),tooltip:!0,icon:P.cancel}),e.on("execute",()=>this.fire("close",{source:"closeButton"})),e}}Pi.defaultOffset=15;function WS(i){i=Object.assign({top:0,bottom:0,left:0,right:0},i);const e=new z(I.window);return e.top+=i.top,e.height-=i.top,e.bottom-=i.bottom,e.height-=i.bottom,e.left+=i.left,e.right-=i.right,e.width-=i.left+i.right,e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Xt extends y{static get pluginName(){return"Dialog"}constructor(e){super(e);const t=e.t;this._initShowHideListeners(),this._initFocusToggler(),this._initMultiRootIntegration(),this.set("id",null),e.accessibility.addKeystrokeInfos({categoryId:"navigation",keystrokes:[{label:t("Move focus in and out of an active dialog window"),keystroke:"Ctrl+F6",mayRequireFn:!0}]})}_initShowHideListeners(){this.on("show",(e,t)=>{this._show(t)}),this.on("show",(e,t)=>{t.onShow&&t.onShow(this)},{priority:"low"}),this.on("hide",()=>{Xt._visibleDialogPlugin&&Xt._visibleDialogPlugin._hide()}),this.on("hide",()=>{this._onHide&&(this._onHide(this),this._onHide=void 0)},{priority:"low"})}_initFocusToggler(){const e=this.editor;e.keystrokes.set("Ctrl+F6",(t,n)=>{!this.isOpen||this.view.isModal||(this.view.focusTracker.isFocused?e.editing.view.focus():this.view.focus(),n())})}_initMultiRootIntegration(){const e=this.editor.model;e.document.on("change:data",()=>{if(!this.view)return;const t=e.document.differ.getChangedRoots();for(const n of t)n.state&&this.view.updatePosition()})}show(e){this.hide(),this.fire(`show:${e.id}`,e)}_show({id:e,icon:t,title:n,hasCloseButton:s=!0,content:o,actionButtons:r,className:a,isModal:l,position:c,onHide:u}){const d=this.editor;this.view=new Pi(d.locale,{getCurrentDomRoot:()=>d.editing.view.getDomRoot(d.model.document.selection.anchor.root.rootName),getViewportOffset:()=>d.ui.viewportOffset});const h=this.view;h.on("close",()=>{this.hide()}),d.ui.view.body.add(h),d.ui.focusTracker.add(h.element),d.keystrokes.listenTo(h.element),c||(c=l?Tt.SCREEN_CENTER:Tt.EDITOR_CENTER),h.set({position:c,_isVisible:!0,className:a,isModal:l}),h.setupParts({icon:t,title:n,hasCloseButton:s,content:o,actionButtons:r}),this.id=e,u&&(this._onHide=u),this.isOpen=!0,Xt._visibleDialogPlugin=this}hide(){Xt._visibleDialogPlugin&&Xt._visibleDialogPlugin.fire(`hide:${Xt._visibleDialogPlugin.id}`)}_hide(){if(!this.view)return;const e=this.editor,t=this.view;t.contentView&&t.contentView.reset(),e.ui.view.body.remove(t),e.ui.focusTracker.remove(t.element),e.keystrokes.stopListening(t.element),t.destroy(),e.editing.view.focus(),this.id=null,this.isOpen=!1,Xt._visibleDialogPlugin=null}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const dg=di("px"),hg=I.document.body,jS={top:-99999,left:-99999,name:"arrowless",config:{withArrow:!1}};class Pe extends R{constructor(e){super(e);const t=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class",void 0),this._pinWhenIsVisibleCallback=null,this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",t.to("position",n=>`ck-balloon-panel_${n}`),t.if("isVisible","ck-balloon-panel_visible"),t.if("withArrow","ck-balloon-panel_with-arrow"),t.to("class")],style:{top:t.to("top",dg),left:t.to("left",dg)}},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(e){this.show();const t=Pe.defaultPositions,n=Object.assign({},{element:this.element,positions:[t.southArrowNorth,t.southArrowNorthMiddleWest,t.southArrowNorthMiddleEast,t.southArrowNorthWest,t.southArrowNorthEast,t.northArrowSouth,t.northArrowSouthMiddleWest,t.northArrowSouthMiddleEast,t.northArrowSouthWest,t.northArrowSouthEast,t.viewportStickyNorth],limiter:hg,fitInViewport:!0},e),s=Pe._getOptimalPosition(n)||jS,o=parseInt(s.left),r=parseInt(s.top),a=s.name,l=s.config||{},{withArrow:c=!0}=l;this.top=r,this.left=o,this.position=a,this.withArrow=c}pin(e){this.unpin(),this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(e):this._stopPinning()},this._startPinning(e),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(e){this.attachTo(e);const t=Zl(e.target),n=e.limiter?Zl(e.limiter):hg;this.listenTo(I.document,"scroll",(s,o)=>{const r=o.target,a=t&&r.contains(t),l=n&&r.contains(n);(a||l||!t||!n)&&this.attachTo(e)},{useCapture:!0}),this.listenTo(I.window,"resize",()=>{this.attachTo(e)})}_stopPinning(){this.stopListening(I.document,"scroll"),this.stopListening(I.window,"resize")}}Pe.arrowSideOffset=25,Pe.arrowHeightOffset=10,Pe.stickyVerticalOffset=20,Pe._getOptimalPosition=Ro,Pe.defaultPositions=fg();function Zl(i){return Tn(i)?i:Io(i)?i.commonAncestorContainer:typeof i=="function"?Zl(i()):null}function fg(i={}){const{sideOffset:e=Pe.arrowSideOffset,heightOffset:t=Pe.arrowHeightOffset,stickyVerticalOffset:n=Pe.stickyVerticalOffset,config:s}=i;return{northWestArrowSouthWest:(a,l)=>({top:o(a,l),left:a.left-e,name:"arrow_sw",...s&&{config:s}}),northWestArrowSouthMiddleWest:(a,l)=>({top:o(a,l),left:a.left-l.width*.25-e,name:"arrow_smw",...s&&{config:s}}),northWestArrowSouth:(a,l)=>({top:o(a,l),left:a.left-l.width/2,name:"arrow_s",...s&&{config:s}}),northWestArrowSouthMiddleEast:(a,l)=>({top:o(a,l),left:a.left-l.width*.75+e,name:"arrow_sme",...s&&{config:s}}),northWestArrowSouthEast:(a,l)=>({top:o(a,l),left:a.left-l.width+e,name:"arrow_se",...s&&{config:s}}),northArrowSouthWest:(a,l)=>({top:o(a,l),left:a.left+a.width/2-e,name:"arrow_sw",...s&&{config:s}}),northArrowSouthMiddleWest:(a,l)=>({top:o(a,l),left:a.left+a.width/2-l.width*.25-e,name:"arrow_smw",...s&&{config:s}}),northArrowSouth:(a,l)=>({top:o(a,l),left:a.left+a.width/2-l.width/2,name:"arrow_s",...s&&{config:s}}),northArrowSouthMiddleEast:(a,l)=>({top:o(a,l),left:a.left+a.width/2-l.width*.75+e,name:"arrow_sme",...s&&{config:s}}),northArrowSouthEast:(a,l)=>({top:o(a,l),left:a.left+a.width/2-l.width+e,name:"arrow_se",...s&&{config:s}}),northEastArrowSouthWest:(a,l)=>({top:o(a,l),left:a.right-e,name:"arrow_sw",...s&&{config:s}}),northEastArrowSouthMiddleWest:(a,l)=>({top:o(a,l),left:a.right-l.width*.25-e,name:"arrow_smw",...s&&{config:s}}),northEastArrowSouth:(a,l)=>({top:o(a,l),left:a.right-l.width/2,name:"arrow_s",...s&&{config:s}}),northEastArrowSouthMiddleEast:(a,l)=>({top:o(a,l),left:a.right-l.width*.75+e,name:"arrow_sme",...s&&{config:s}}),northEastArrowSouthEast:(a,l)=>({top:o(a,l),left:a.right-l.width+e,name:"arrow_se",...s&&{config:s}}),southWestArrowNorthWest:a=>({top:r(a),left:a.left-e,name:"arrow_nw",...s&&{config:s}}),southWestArrowNorthMiddleWest:(a,l)=>({top:r(a),left:a.left-l.width*.25-e,name:"arrow_nmw",...s&&{config:s}}),southWestArrowNorth:(a,l)=>({top:r(a),left:a.left-l.width/2,name:"arrow_n",...s&&{config:s}}),southWestArrowNorthMiddleEast:(a,l)=>({top:r(a),left:a.left-l.width*.75+e,name:"arrow_nme",...s&&{config:s}}),southWestArrowNorthEast:(a,l)=>({top:r(a),left:a.left-l.width+e,name:"arrow_ne",...s&&{config:s}}),southArrowNorthWest:a=>({top:r(a),left:a.left+a.width/2-e,name:"arrow_nw",...s&&{config:s}}),southArrowNorthMiddleWest:(a,l)=>({top:r(a),left:a.left+a.width/2-l.width*.25-e,name:"arrow_nmw",...s&&{config:s}}),southArrowNorth:(a,l)=>({top:r(a),left:a.left+a.width/2-l.width/2,name:"arrow_n",...s&&{config:s}}),southArrowNorthMiddleEast:(a,l)=>({top:r(a),left:a.left+a.width/2-l.width*.75+e,name:"arrow_nme",...s&&{config:s}}),southArrowNorthEast:(a,l)=>({top:r(a),left:a.left+a.width/2-l.width+e,name:"arrow_ne",...s&&{config:s}}),southEastArrowNorthWest:a=>({top:r(a),left:a.right-e,name:"arrow_nw",...s&&{config:s}}),southEastArrowNorthMiddleWest:(a,l)=>({top:r(a),left:a.right-l.width*.25-e,name:"arrow_nmw",...s&&{config:s}}),southEastArrowNorth:(a,l)=>({top:r(a),left:a.right-l.width/2,name:"arrow_n",...s&&{config:s}}),southEastArrowNorthMiddleEast:(a,l)=>({top:r(a),left:a.right-l.width*.75+e,name:"arrow_nme",...s&&{config:s}}),southEastArrowNorthEast:(a,l)=>({top:r(a),left:a.right-l.width+e,name:"arrow_ne",...s&&{config:s}}),westArrowEast:(a,l)=>({top:a.top+a.height/2-l.height/2,left:a.left-l.width-t,name:"arrow_e",...s&&{config:s}}),eastArrowWest:(a,l)=>({top:a.top+a.height/2-l.height/2,left:a.right+t,name:"arrow_w",...s&&{config:s}}),viewportStickyNorth:(a,l,c,u)=>{const d=u||c;return!a.getIntersection(d)||d.height-a.height>n?null:{top:d.top+n,left:a.left+a.width/2-l.width/2,name:"arrowless",config:{withArrow:!1,...s}}}};function o(a,l){return a.top-l.height-t}function r(a){return a.bottom+t}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const mg="ck-tooltip";class ye extends qe(){constructor(e){if(super(),this._currentElementWithTooltip=null,this._currentTooltipPosition=null,this._resizeObserver=null,this._mutationObserver=null,ye._editors.add(e),ye._instance)return ye._instance;ye._instance=this,this.tooltipTextView=new R(e.locale),this.tooltipTextView.set("text",""),this.tooltipTextView.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:this.tooltipTextView.bindTemplate.to("text")}]}),this.balloonPanelView=new Pe(e.locale),this.balloonPanelView.class=mg,this.balloonPanelView.content.add(this.tooltipTextView),this._mutationObserver=qS(()=>{this._updateTooltipPosition()}),this._pinTooltipDebounced=St(this._pinTooltip,600),this._unpinTooltipDebounced=St(this._unpinTooltip,400),this.listenTo(I.document,"keydown",this._onKeyDown.bind(this),{useCapture:!0}),this.listenTo(I.document,"mouseenter",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(I.document,"mouseleave",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(I.document,"focus",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(I.document,"blur",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(I.document,"scroll",this._onScroll.bind(this),{useCapture:!0}),this._watchdogExcluded=!0}destroy(e){const t=e.ui.view&&e.ui.view.body;ye._editors.delete(e),this.stopListening(e.ui),t&&t.has(this.balloonPanelView)&&t.remove(this.balloonPanelView),ye._editors.size||(this._unpinTooltip(),this.balloonPanelView.destroy(),this.stopListening(),ye._instance=null)}static getPositioningFunctions(e){const t=ye.defaultBalloonPositions;return{s:[t.southArrowNorth,t.southArrowNorthEast,t.southArrowNorthWest],n:[t.northArrowSouth],e:[t.eastArrowWest],w:[t.westArrowEast],sw:[t.southArrowNorthEast],se:[t.southArrowNorthWest]}[e]}_onKeyDown(e,t){t.key==="Escape"&&this._currentElementWithTooltip&&(this._unpinTooltip(),t.stopPropagation())}_onEnterOrFocus(e,{target:t}){const n=Jl(t);if(!n){e.name==="focus"&&this._unpinTooltip();return}n!==this._currentElementWithTooltip&&(this._unpinTooltip(),this._pinTooltipDebounced(n,gg(n)))}_onLeaveOrBlur(e,{target:t,relatedTarget:n}){if(e.name==="mouseleave"){if(!Tn(t))return;const s=this.balloonPanelView.element,o=s&&(s===n||s.contains(n)),r=!o&&t===s;if(o){this._unpinTooltipDebounced.cancel();return}if(!r&&this._currentElementWithTooltip&&t!==this._currentElementWithTooltip)return;const a=Jl(t),l=Jl(n);(r||a&&a!==l)&&this._unpinTooltipDebounced()}else{if(this._currentElementWithTooltip&&t!==this._currentElementWithTooltip)return;this._unpinTooltipDebounced()}}_onScroll(e,{target:t}){this._currentElementWithTooltip&&(t.contains(this.balloonPanelView.element)&&t.contains(this._currentElementWithTooltip)||this._unpinTooltip())}_pinTooltip(e,{text:t,position:n,cssClass:s}){this._unpinTooltip();const o=ce(ye._editors.values()).ui.view.body;o.has(this.balloonPanelView)||o.add(this.balloonPanelView),this.tooltipTextView.text=t,this.balloonPanelView.pin({target:e,positions:ye.getPositioningFunctions(n)}),this._resizeObserver=new rs(e,()=>{En(e)||this._unpinTooltip()}),this._mutationObserver.attach(e),this.balloonPanelView.class=[mg,s].filter(r=>r).join(" ");for(const r of ye._editors)this.listenTo(r.ui,"update",this._updateTooltipPosition.bind(this),{priority:"low"});this._currentElementWithTooltip=e,this._currentTooltipPosition=n}_unpinTooltip(){this._unpinTooltipDebounced.cancel(),this._pinTooltipDebounced.cancel(),this.balloonPanelView.unpin();for(const e of ye._editors)this.stopListening(e.ui,"update");this._currentElementWithTooltip=null,this._currentTooltipPosition=null,this.tooltipTextView.text="",this._resizeObserver&&this._resizeObserver.destroy(),this._mutationObserver.detach()}_updateTooltipPosition(){if(!this._currentElementWithTooltip)return;const e=gg(this._currentElementWithTooltip);if(!En(this._currentElementWithTooltip)||!e.text){this._unpinTooltip();return}this.balloonPanelView.pin({target:this._currentElementWithTooltip,positions:ye.getPositioningFunctions(e.position)})}}ye.defaultBalloonPositions=fg({heightOffset:5,sideOffset:13}),ye._editors=new Set,ye._instance=null;function Jl(i){return Tn(i)?i.closest("[data-cke-tooltip-text]:not([data-cke-tooltip-disabled])"):null}function gg(i){return{text:i.dataset.ckeTooltipText,position:i.dataset.ckeTooltipPosition||"s",cssClass:i.dataset.ckeTooltipClass||""}}function qS(i){const e=new MutationObserver(()=>{i()});return{attach(t){e.observe(t,{attributes:!0,attributeFilter:["data-cke-tooltip-text","data-cke-tooltip-position"]})},detach(){e.disconnect()}}}const GS=`<svg xmlns="http://www.w3.org/2000/svg" width="53" height="10" viewBox="0 0 53 10"><path fill="#1C2331" d="M31.724 1.492a15.139 15.139 0 0 0 .045 1.16 2.434 2.434 0 0 0-.687-.34 3.68 3.68 0 0 0-1.103-.166 2.332 2.332 0 0 0-1.14.255 1.549 1.549 0 0 0-.686.87c-.15.41-.225.98-.225 1.712 0 .939.148 1.659.444 2.161.297.503.792.754 1.487.754.452.015.9-.094 1.294-.316.296-.174.557-.4.771-.669l.14.852h1.282V.007h-1.623v1.485ZM31 6.496a1.77 1.77 0 0 1-.494.061.964.964 0 0 1-.521-.127.758.758 0 0 1-.296-.466 3.984 3.984 0 0 1-.093-.992 4.208 4.208 0 0 1 .098-1.052.753.753 0 0 1 .307-.477 1.08 1.08 0 0 1 .55-.122c.233-.004.466.026.69.089l.483.144v2.553c-.11.076-.213.143-.307.2a1.73 1.73 0 0 1-.417.189ZM35.68 0l-.702.004c-.322.002-.482.168-.48.497l.004.581c.002.33.164.493.486.49l.702-.004c.322-.002.481-.167.48-.496L36.165.49c-.002-.33-.164-.493-.486-.491ZM36.145 2.313l-1.612.01.034 5.482 1.613-.01-.035-5.482ZM39.623.79 37.989.8 38 2.306l-.946.056.006 1.009.949-.006.024 2.983c.003.476.143.844.419 1.106.275.26.658.39 1.148.387.132 0 .293-.01.483-.03.19-.02.38-.046.57-.08.163-.028.324-.068.482-.119l-.183-1.095-.702.004a.664.664 0 0 1-.456-.123.553.553 0 0 1-.14-.422l-.016-2.621 1.513-.01-.006-1.064-1.514.01-.01-1.503ZM46.226 2.388c-.41-.184-.956-.274-1.636-.27-.673.004-1.215.101-1.627.29-.402.179-.72.505-.888.91-.18.419-.268.979-.264 1.68.004.688.1 1.24.285 1.655.172.404.495.724.9.894.414.18.957.268 1.63.264.68-.004 1.224-.099 1.632-.284.4-.176.714-.501.878-.905.176-.418.263-.971.258-1.658-.004-.702-.097-1.261-.28-1.677a1.696 1.696 0 0 0-.888-.9Zm-.613 3.607a.77.77 0 0 1-.337.501 1.649 1.649 0 0 1-1.317.009.776.776 0 0 1-.343-.497 4.066 4.066 0 0 1-.105-1.02 4.136 4.136 0 0 1 .092-1.03.786.786 0 0 1 .337-.507 1.59 1.59 0 0 1 1.316-.008.79.79 0 0 1 .344.502c.078.337.113.683.105 1.03.012.343-.019.685-.092 1.02ZM52.114 2.07a2.67 2.67 0 0 0-1.128.278c-.39.191-.752.437-1.072.73l-.157-.846-1.273.008.036 5.572 1.623-.01-.024-3.78c.35-.124.646-.22.887-.286.26-.075.53-.114.8-.118l.45-.003.144-1.546-.286.001ZM22.083 7.426l-1.576-2.532a2.137 2.137 0 0 0-.172-.253 1.95 1.95 0 0 0-.304-.29.138.138 0 0 1 .042-.04 1.7 1.7 0 0 0 .328-.374l1.75-2.71c.01-.015.025-.028.024-.048-.01-.01-.021-.007-.031-.007L20.49 1.17a.078.078 0 0 0-.075.045l-.868 1.384c-.23.366-.46.732-.688 1.099a.108.108 0 0 1-.112.06c-.098-.005-.196-.001-.294-.002-.018 0-.038.006-.055-.007.002-.02.002-.039.005-.058a4.6 4.6 0 0 0 .046-.701V1.203c0-.02-.009-.032-.03-.03h-.033L16.93 1.17c-.084 0-.073-.01-.073.076v6.491c-.001.018.006.028.025.027h1.494c.083 0 .072.007.072-.071v-2.19c0-.055-.003-.11-.004-.166a3.366 3.366 0 0 0-.05-.417h.06c.104 0 .209.002.313-.002a.082.082 0 0 1 .084.05c.535.913 1.07 1.824 1.607 2.736a.104.104 0 0 0 .103.062c.554-.003 1.107-.002 1.66-.002l.069-.003-.019-.032-.188-.304ZM27.112 6.555c-.005-.08-.004-.08-.082-.08h-2.414c-.053 0-.106-.003-.159-.011a.279.279 0 0 1-.246-.209.558.558 0 0 1-.022-.15c0-.382 0-.762-.002-1.143 0-.032.007-.049.042-.044h2.504c.029.003.037-.012.034-.038V3.814c0-.089.013-.078-.076-.078h-2.44c-.07 0-.062.003-.062-.06v-.837c0-.047.004-.093.013-.14a.283.283 0 0 1 .241-.246.717.717 0 0 1 .146-.011h2.484c.024.002.035-.009.036-.033l.003-.038.03-.496c.01-.183.024-.365.034-.548.005-.085.003-.087-.082-.094-.218-.018-.437-.038-.655-.05a17.845 17.845 0 0 0-.657-.026 72.994 72.994 0 0 0-1.756-.016 1.7 1.7 0 0 0-.471.064 1.286 1.286 0 0 0-.817.655c-.099.196-.149.413-.145.633v3.875c0 .072.003.144.011.216a1.27 1.27 0 0 0 .711 1.029c.228.113.48.167.734.158.757-.005 1.515.002 2.272-.042.274-.016.548-.034.82-.053.03-.002.043-.008.04-.041-.008-.104-.012-.208-.019-.312a69.964 69.964 0 0 1-.05-.768ZM16.14 7.415l-.127-1.075c-.004-.03-.014-.04-.044-.037a13.125 13.125 0 0 1-.998.073c-.336.01-.672.02-1.008.016-.116-.001-.233-.014-.347-.039a.746.746 0 0 1-.45-.262c-.075-.1-.132-.211-.167-.33a3.324 3.324 0 0 1-.126-.773 9.113 9.113 0 0 1-.015-.749c0-.285.022-.57.065-.852.023-.158.066-.312.127-.46a.728.728 0 0 1 .518-.443 1.64 1.64 0 0 1 .397-.048c.628-.001 1.255.003 1.882.05.022.001.033-.006.036-.026l.003-.031.06-.55c.019-.177.036-.355.057-.532.004-.034-.005-.046-.04-.056a5.595 5.595 0 0 0-1.213-.21 10.783 10.783 0 0 0-.708-.02c-.24-.003-.48.01-.719.041a3.477 3.477 0 0 0-.625.14 1.912 1.912 0 0 0-.807.497c-.185.2-.33.433-.424.688a4.311 4.311 0 0 0-.24 1.096c-.031.286-.045.572-.042.86-.006.43.024.86.091 1.286.04.25.104.497.193.734.098.279.26.53.473.734.214.205.473.358.756.446.344.11.702.17 1.063.177a8.505 8.505 0 0 0 1.578-.083 6.11 6.11 0 0 0 .766-.18c.03-.008.047-.023.037-.057a.157.157 0 0 1-.003-.025Z"/><path fill="#AFE229" d="M6.016 6.69a1.592 1.592 0 0 0-.614.21c-.23.132-.422.32-.56.546-.044.072-.287.539-.287.539l-.836 1.528.009.006c.038.025.08.046.123.063.127.046.26.07.395.073.505.023 1.011-.007 1.517-.003.29.009.58.002.869-.022a.886.886 0 0 0 .395-.116.962.962 0 0 0 .312-.286c.056-.083.114-.163.164-.249.24-.408.48-.816.718-1.226.075-.128.148-.257.222-.386l.112-.192a1.07 1.07 0 0 0 .153-.518l-1.304.023s-1.258-.005-1.388.01Z"/><path fill="#771BFF" d="m2.848 9.044.76-1.39.184-.352c-.124-.067-.245-.14-.367-.21-.346-.204-.706-.384-1.045-.6a.984.984 0 0 1-.244-.207c-.108-.134-.136-.294-.144-.46-.021-.409-.002-.818-.009-1.227-.003-.195 0-.39.003-.585.004-.322.153-.553.427-.713l.833-.488c.22-.13.44-.257.662-.385.05-.029.105-.052.158-.077.272-.128.519-.047.76.085l.044.028c.123.06.242.125.358.196.318.178.635.357.952.537.095.056.187.117.275.184.194.144.254.35.266.578.016.284.007.569.006.853-.001.28.004.558 0 .838.592-.003 1.259 0 1.259 0l.723-.013c-.003-.292-.007-.584-.007-.876 0-.524.015-1.048-.016-1.571-.024-.42-.135-.8-.492-1.067a5.02 5.02 0 0 0-.506-.339A400.52 400.52 0 0 0 5.94.787C5.722.664 5.513.524 5.282.423 5.255.406 5.228.388 5.2.373 4.758.126 4.305-.026 3.807.21c-.097.046-.197.087-.29.14A699.896 699.896 0 0 0 .783 1.948c-.501.294-.773.717-.778 1.31-.004.36-.009.718-.001 1.077.016.754-.017 1.508.024 2.261.016.304.07.6.269.848.127.15.279.28.448.382.622.4 1.283.734 1.92 1.11l.183.109Z"/></svg>
`;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const KS=53,ZS=10,JS=50,YS=350,XS="Powered by";class QS extends qe(){constructor(e){super(),this.editor=e,this._balloonView=null,this._lastFocusedEditableElement=null,this._showBalloonThrottled=os(this._showBalloon.bind(this),50,{leading:!0}),e.on("ready",this._handleEditorReady.bind(this))}destroy(){const e=this._balloonView;e&&(e.unpin(),this._balloonView=null),this._showBalloonThrottled.cancel(),this.stopListening()}_handleEditorReady(){const e=this.editor,t=!!e.config.get("ui.poweredBy.forceVisible");/* istanbul ignore next -- @preserve */!t&&S5(e.config.get("licenseKey"))==="VALID"||e.ui.view&&(e.ui.focusTracker.on("change:isFocused",(n,s,o)=>{this._updateLastFocusedEditableElement(),o?this._showBalloon():this._hideBalloon()}),e.ui.focusTracker.on("change:focusedElement",(n,s,o)=>{this._updateLastFocusedEditableElement(),o&&this._showBalloon()}),e.ui.on("update",()=>{this._showBalloonThrottled()}))}_createBalloonView(){const e=this.editor,t=this._balloonView=new Pe,n=bg(e),s=new e7(e.locale,n.label);t.content.add(s),t.set({class:"ck-powered-by-balloon"}),e.ui.view.body.add(t),e.ui.focusTracker.add(t.element),this._balloonView=t}_showBalloon(){if(!this._lastFocusedEditableElement)return;const e=t7(this.editor,this._lastFocusedEditableElement);this._balloonView||this._createBalloonView(),this._balloonView.pin(e)}_hideBalloon(){this._balloonView&&this._balloonView.unpin()}_updateLastFocusedEditableElement(){const e=this.editor,t=e.ui.focusTracker.isFocused,n=e.ui.focusTracker.focusedElement;if(!t||!n){this._lastFocusedEditableElement=null;return}const s=Array.from(e.ui.getEditableElementsNames()).map(o=>e.ui.getEditableElement(o));s.includes(n)?this._lastFocusedEditableElement=n:this._lastFocusedEditableElement=s[0]}}class e7 extends R{constructor(e,t){super(e);const n=new Mt,s=this.bindTemplate;n.set({content:GS,isColorInherited:!1}),n.extendTemplate({attributes:{style:{width:KS+"px",height:ZS+"px"}}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-powered-by"],"aria-hidden":!0},children:[{tag:"a",attributes:{href:"https://ckeditor.com/?utm_source=ckeditor&utm_medium=referral&utm_campaign=701Dn000000hVgmIAE_powered_by_ckeditor_logo",target:"_blank",tabindex:"-1"},children:[...t?[{tag:"span",attributes:{class:["ck","ck-powered-by__label"]},children:[t]}]:[],n],on:{dragstart:s.to(o=>o.preventDefault())}}]})}}function t7(i,e){const t=bg(i),n=t.side==="right"?n7(e,t):i7(e,t);return{target:e,positions:[n]}}function n7(i,e){return pg(i,e,(t,n)=>t.left+t.width-n.width-e.horizontalOffset)}function i7(i,e){return pg(i,e,t=>t.left+e.horizontalOffset)}function pg(i,e,t){return(n,s)=>{const o=new z(i);if(o.width<YS||o.height<JS)return null;let r;e.position==="inside"?r=o.bottom-s.height:r=o.bottom-s.height/2,r-=e.verticalOffset;const a=t(o,s),c=n.clone().moveTo(a,r).getIntersection(s.clone().moveTo(a,r)).getVisible();return!c||c.getArea()<s.getArea()?null:{top:r,left:a,name:`position_${e.position}-side_${e.side}`,config:{withArrow:!1}}}}function bg(i){const e=i.config.get("ui.poweredBy"),t=e&&e.position||"border";return{position:t,label:XS,verticalOffset:t==="inside"?5:0,horizontalOffset:5,side:i.locale.contentLanguageDirection==="ltr"?"right":"left",...e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const wg={POLITE:"polite",ASSERTIVE:"assertive"};class s7{constructor(e){this.editor=e,e.once("ready",()=>{for(const t of Object.values(wg))this.announce("",t)})}announce(e,t=wg.POLITE){const n=this.editor;if(!n.ui.view)return;this.view||(this.view=new o7(n.locale),n.ui.view.body.add(this.view));const{politeness:s,isUnsafeHTML:o}=typeof t=="string"?{politeness:t}:t;let r=this.view.regionViews.find(a=>a.politeness===s);r||(r=new r7(n,s),this.view.regionViews.add(r)),r.announce({announcement:e,isUnsafeHTML:o})}}class o7 extends R{constructor(e){super(e),this.regionViews=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-aria-live-announcer"]},children:this.regionViews})}}class r7 extends R{constructor(e,t){super(e.locale),this.setTemplate({tag:"div",attributes:{role:"region","aria-live":t,"aria-relevant":"additions"},children:[{tag:"ul",attributes:{class:["ck","ck-aria-live-region-list"]}}]}),e.on("destroy",()=>{this._pruneAnnouncementsInterval!==null&&(clearInterval(this._pruneAnnouncementsInterval),this._pruneAnnouncementsInterval=null)}),this.politeness=t,this._domConverter=e.data.htmlProcessor.domConverter,this._pruneAnnouncementsInterval=setInterval(()=>{this.element&&this._listElement.firstChild&&this._listElement.firstChild.remove()},5e3)}announce({announcement:e,isUnsafeHTML:t}){if(!e.trim().length)return;const n=document.createElement("li");t?this._domConverter.setContentOf(n,e):n.innerText=e,this._listElement.appendChild(n)}get _listElement(){return this.element.querySelector("ul")}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class a7 extends re(){constructor(e){super(),this.isReady=!1,this._editableElementsMap=new Map,this._focusableToolbarDefinitions=[];const t=e.editing.view;this.editor=e,this.componentFactory=new $S(e),this.focusTracker=new be,this.tooltipManager=new ye(e),this.poweredBy=new QS(e),this.ariaLiveAnnouncer=new s7(e),this.set("viewportOffset",this._readViewportOffsetFromConfig()),this.once("ready",()=>{this.isReady=!0}),this.listenTo(t.document,"layoutChanged",this.update.bind(this)),this.listenTo(t,"scrollToTheSelection",this._handleScrollToTheSelection.bind(this)),this._initFocusTracking()}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy(),this.tooltipManager.destroy(this.editor),this.poweredBy.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null,this.editor.keystrokes.stopListening(e);this._editableElementsMap=new Map,this._focusableToolbarDefinitions=[]}setEditableElement(e,t){this._editableElementsMap.set(e,t),t.ckeditorInstance||(t.ckeditorInstance=this.editor),this.focusTracker.add(t);const n=()=>{this.editor.editing.view.getDomRoot(e)||this.editor.keystrokes.listenTo(t)};this.isReady?n():this.once("ready",n)}removeEditableElement(e){const t=this._editableElementsMap.get(e);t&&(this._editableElementsMap.delete(e),this.editor.keystrokes.stopListening(t),this.focusTracker.remove(t),t.ckeditorInstance=null)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}addToolbar(e,t={}){e.isRendered?(this.focusTracker.add(e.element),this.editor.keystrokes.listenTo(e.element)):e.once("render",()=>{this.focusTracker.add(e.element),this.editor.keystrokes.listenTo(e.element)}),this._focusableToolbarDefinitions.push({toolbarView:e,options:t})}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}_readViewportOffsetFromConfig(){const e=this.editor,t=e.config.get("ui.viewportOffset");if(t)return t;const n=e.config.get("toolbar.viewportTopOffset");return n?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:n}):{top:0}}_initFocusTracking(){const e=this.editor,t=e.editing.view;let n,s;e.keystrokes.set("Alt+F10",(o,r)=>{const a=this.focusTracker.focusedElement;Array.from(this._editableElementsMap.values()).includes(a)&&!Array.from(t.domRoots.values()).includes(a)&&(n=a);const l=this._getCurrentFocusedToolbarDefinition();(!l||!s)&&(s=this._getFocusableCandidateToolbarDefinitions());for(let c=0;c<s.length;c++){const u=s.shift();if(s.push(u),u!==l&&this._focusFocusableCandidateToolbar(u)){l&&l.options.afterBlur&&l.options.afterBlur();break}}r()}),e.keystrokes.set("Esc",(o,r)=>{const a=this._getCurrentFocusedToolbarDefinition();a&&(n?(n.focus(),n=null):e.editing.view.focus(),a.options.afterBlur&&a.options.afterBlur(),r())})}_getFocusableCandidateToolbarDefinitions(){const e=[];for(const t of this._focusableToolbarDefinitions){const{toolbarView:n,options:s}=t;(En(n.element)||s.beforeFocus)&&e.push(t)}return e.sort((t,n)=>_g(t)-_g(n)),e}_getCurrentFocusedToolbarDefinition(){for(const e of this._focusableToolbarDefinitions)if(e.toolbarView.element&&e.toolbarView.element.contains(this.focusTracker.focusedElement))return e;return null}_focusFocusableCandidateToolbar(e){const{toolbarView:t,options:{beforeFocus:n}}=e;return n&&n(),En(t.element)?(t.focus(),!0):!1}_handleScrollToTheSelection(e,t){const n={top:0,bottom:0,left:0,right:0,...this.viewportOffset};t.viewportOffset.top+=n.top,t.viewportOffset.bottom+=n.bottom,t.viewportOffset.left+=n.left,t.viewportOffset.right+=n.right}}function _g(i){const{toolbarView:e,options:t}=i;let n=10;return En(e.element)&&n--,t.isContextual&&n--,n}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class l7 extends R{constructor(e){super(e),this.body=new S4(e)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class c7 extends l7{constructor(e){super(e),this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const e=this.t,t=new Qe;return t.text=e("Rich Text Editor"),t.extendTemplate({attributes:{class:"ck-voice-label"}}),t}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class u7 extends R{constructor(e,t,n){super(e),this.name=null,this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.set("isFocused",!1),this._editableElement=n,this._hasExternalElement=!!this._editableElement,this._editingView=t}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",()=>this._updateIsFocusedClasses()),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}get hasExternalElement(){return this._hasExternalElement}_updateIsFocusedClasses(){const e=this._editingView;e.isRenderingInProgress?n(this):t(this);function t(s){e.change(o=>{const r=e.document.getRoot(s.name);o.addClass(s.isFocused?"ck-focused":"ck-blurred",r),o.removeClass(s.isFocused?"ck-blurred":"ck-focused",r)})}function n(s){e.once("change:isRenderingInProgress",(o,r,a)=>{a?n(s):t(s)})}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class d7 extends u7{constructor(e,t,n,s={}){super(e,t,n);const o=e.t;this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}}),this._generateLabel=s.label||(()=>o("Editor editing area: %0",this.name))}render(){super.render();const e=this._editingView;e.change(t=>{const n=e.document.getRoot(this.name);t.setAttribute("aria-label",this._generateLabel(this),n)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ri extends re(){constructor(e,t){super(),t&&Hu(this,t),e&&this.set(e)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const dr=di("px");class Ot extends y{static get pluginName(){return"ContextualBalloon"}constructor(e){super(e),this._viewToStack=new Map,this._idToStack=new Map,this._view=null,this._rotatorView=null,this._fakePanelsView=null,this.positionLimiter=()=>{const t=this.editor.editing.view,s=t.document.selection.editableElement;return s?t.domConverter.mapViewToDom(s.root):null},this.set("visibleView",null),this.set("_numberOfStacks",0),this.set("_singleViewMode",!1)}destroy(){super.destroy(),this._view&&this._view.destroy(),this._rotatorView&&this._rotatorView.destroy(),this._fakePanelsView&&this._fakePanelsView.destroy()}get view(){return this._view||this._createPanelView(),this._view}hasView(e){return Array.from(this._viewToStack.keys()).includes(e)}add(e){if(this._view||this._createPanelView(),this.hasView(e.view))throw new p("contextualballoon-add-view-exist",[this,e]);const t=e.stackId||"main";if(!this._idToStack.has(t)){this._idToStack.set(t,new Map([[e.view,e]])),this._viewToStack.set(e.view,this._idToStack.get(t)),this._numberOfStacks=this._idToStack.size,(!this._visibleStack||e.singleViewMode)&&this.showStack(t);return}const n=this._idToStack.get(t);e.singleViewMode&&this.showStack(t),n.set(e.view,e),this._viewToStack.set(e.view,n),n===this._visibleStack&&this._showView(e)}remove(e){if(!this.hasView(e))throw new p("contextualballoon-remove-view-not-exist",[this,e]);const t=this._viewToStack.get(e);this._singleViewMode&&this.visibleView===e&&(this._singleViewMode=!1),this.visibleView===e&&(t.size===1?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(t.values())[t.size-2])),t.size===1?(this._idToStack.delete(this._getStackId(t)),this._numberOfStacks=this._idToStack.size):t.delete(e),this._viewToStack.delete(e)}updatePosition(e){e&&(this._visibleStack.get(this.visibleView).position=e),this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition()}showStack(e){this.visibleStack=e;const t=this._idToStack.get(e);if(!t)throw new p("contextualballoon-showstack-stack-not-exist",this);this._visibleStack!==t&&this._showView(Array.from(t.values()).pop())}_createPanelView(){this._view=new Pe(this.editor.locale),this.editor.ui.view.body.add(this._view),this.editor.ui.focusTracker.add(this._view.element),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(e){return Array.from(this._idToStack.entries()).find(n=>n[1]===e)[0]}_showNextStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)+1;e[t]||(t=0),this.showStack(this._getStackId(e[t]))}_showPrevStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)-1;e[t]||(t=e.length-1),this.showStack(this._getStackId(e[t]))}_createRotatorView(){const e=new h7(this.editor.locale),t=this.editor.locale.t;return this.view.content.add(e),e.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",(n,s)=>!s&&n>1),e.on("change:isNavigationVisible",()=>this.updatePosition(),{priority:"low"}),e.bind("counter").to(this,"visibleView",this,"_numberOfStacks",(n,s)=>{if(s<2)return"";const o=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return t("%0 of %1",[o,s])}),e.buttonNextView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()}),e.buttonPrevView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()}),e}_createFakePanelsView(){const e=new f7(this.editor.locale,this.view);return e.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",(t,n)=>!n&&t>=2?Math.min(t-1,2):0),e.listenTo(this.view,"change:top",()=>e.updatePosition()),e.listenTo(this.view,"change:left",()=>e.updatePosition()),this.editor.ui.view.body.add(e),e}_showView({view:e,balloonClassName:t="",withArrow:n=!0,singleViewMode:s=!1}){this.view.class=t,this.view.withArrow=n,this._rotatorView.showView(e),this.visibleView=e,this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition(),s&&(this._singleViewMode=!0)}_getBalloonPosition(){let e=Array.from(this._visibleStack.values()).pop().position;return e&&(e.limiter||(e=Object.assign({},e,{limiter:this.positionLimiter})),e=Object.assign({},e,{viewportOffsetConfig:this.editor.ui.viewportOffset})),e}}class h7 extends R{constructor(e){super(e);const t=e.t,n=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new be,this.buttonPrevView=this._createButtonView(t("Previous"),P.previousArrow),this.buttonNextView=this._createButtonView(t("Next"),P.nextArrow),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",n.to("isNavigationVisible",s=>s?"":"ck-hidden")]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:n.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}destroy(){super.destroy(),this.focusTracker.destroy()}showView(e){this.hideView(),this.content.add(e)}hideView(){this.content.clear()}_createButtonView(e,t){const n=new N(this.locale);return n.set({label:e,icon:t,tooltip:!0}),n}}class f7 extends R{constructor(e,t){super(e);const n=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=t,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",n.to("numberOfPanels",s=>s?"":"ck-hidden")],style:{top:n.to("top",dr),left:n.to("left",dr),width:n.to("width",dr),height:n.to("height",dr)}},children:this.content}),this.on("change:numberOfPanels",(s,o,r,a)=>{r>a?this._addPanels(r-a):this._removePanels(a-r),this.updatePosition()})}_addPanels(e){for(;e--;){const t=new R;t.setTemplate({tag:"div"}),this.content.add(t),this.registerChild(t)}}_removePanels(e){for(;e--;){const t=this.content.last;this.content.remove(t),this.deregisterChild(t),t.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:e,left:t}=this._balloonPanelView,{width:n,height:s}=new z(this._balloonPanelView.element);Object.assign(this,{top:e,left:t,width:n,height:s})}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Mi=di("px");class m7 extends R{constructor(e){super(e);const t=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheBottomOfLimiter",!1),this.set("_stickyTopOffset",null),this.set("_stickyBottomOffset",null),this.content=this.createCollection(),this._contentPanelPlaceholder=new Ue({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:t.to("isSticky",n=>n?"block":"none"),height:t.to("isSticky",n=>n?Mi(this._contentPanelRect.height):null)}}}).render(),this.contentPanelElement=new Ue({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",t.if("isSticky","ck-sticky-panel__content_sticky"),t.if("_isStickyToTheBottomOfLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:t.to("isSticky",n=>n?Mi(this._contentPanelPlaceholder.getBoundingClientRect().width):null),top:t.to("_stickyTopOffset",n=>n&&Mi(n)),bottom:t.to("_stickyBottomOffset",n=>n&&Mi(n)),marginLeft:t.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this.contentPanelElement]})}render(){super.render(),this.checkIfShouldBeSticky(),this.listenTo(I.document,"scroll",()=>{this.checkIfShouldBeSticky()},{useCapture:!0}),this.listenTo(this,"change:isActive",()=>{this.checkIfShouldBeSticky()})}checkIfShouldBeSticky(){if(!this.limiterElement||!this.isActive){this._unstick();return}const e=new z(this.limiterElement);let t=e.getVisible();if(t){const n=new z(I.window);n.top+=this.viewportTopOffset,n.height-=this.viewportTopOffset,t=t.getIntersection(n)}if(t&&e.top<t.top){const n=t.top;if(n+this._contentPanelRect.height+this.limiterBottomOffset>t.bottom){const s=Math.max(e.bottom-t.bottom,0)+this.limiterBottomOffset;e.bottom-s>e.top+this._contentPanelRect.height?this._stickToBottomOfLimiter(s):this._unstick()}else this._contentPanelRect.height+this.limiterBottomOffset<e.height?this._stickToTopOfAncestors(n):this._unstick()}else this._unstick()}_stickToTopOfAncestors(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=e,this._stickyBottomOffset=null,this._marginLeft=Mi(-I.window.scrollX)}_stickToBottomOfLimiter(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!0,this._stickyTopOffset=null,this._stickyBottomOffset=e,this._marginLeft=Mi(-I.window.scrollX)}_unstick(){this.isSticky=!1,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=null,this._stickyBottomOffset=null,this._marginLeft=null}get _contentPanelRect(){return new z(this.contentPanelElement)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class g7 extends Ie{constructor(e,t){const n=e.t,s=Object.assign({},{showResetButton:!0,showIcon:!0,creator:Bt},t);super(e,s.creator),this.label=t.label,this._viewConfig=s,this._viewConfig.showIcon&&(this.iconView=new Mt,this.iconView.content=P.loupe,this.fieldWrapperChildren.add(this.iconView,0),this.extendTemplate({attributes:{class:"ck-search__query_with-icon"}})),this._viewConfig.showResetButton&&(this.resetButtonView=new N(e),this.resetButtonView.set({label:n("Clear"),icon:P.cancel,class:"ck-search__reset",isVisible:!1,tooltip:!0}),this.resetButtonView.on("execute",()=>{this.reset(),this.focus(),this.fire("reset")}),this.resetButtonView.bind("isVisible").to(this.fieldView,"isEmpty",o=>!o),this.fieldWrapperChildren.add(this.resetButtonView),this.extendTemplate({attributes:{class:"ck-search__query_with-reset"}}))}reset(){this.fieldView.reset(),this._viewConfig.showResetButton&&(this.resetButtonView.isVisible=!1)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class p7 extends R{constructor(){super();const e=this.bindTemplate;this.set({isVisible:!1,primaryText:"",secondaryText:""}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-search__info",e.if("isVisible","ck-hidden",t=>!t)],tabindex:-1},children:[{tag:"span",children:[{text:[e.to("primaryText")]}]},{tag:"span",children:[{text:[e.to("secondaryText")]}]}]})}focus(){this.element.focus()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class b7 extends R{constructor(e){super(e),this.children=this.createCollection(),this.focusTracker=new be,this.setTemplate({tag:"div",attributes:{class:["ck","ck-search__results"],tabindex:-1},children:this.children}),this._focusCycler=new et({focusables:this.children,focusTracker:this.focusTracker})}render(){super.render();for(const e of this.children)this.focusTracker.add(e.element)}focus(){this._focusCycler.focusFirst()}focusFirst(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class w7 extends R{constructor(e,t){super(e),this._config=t,this.filteredView=t.filteredView,this.queryView=this._createSearchTextQueryView(),this.focusTracker=new be,this.keystrokes=new Te,this.resultsView=new b7(e),this.children=this.createCollection(),this.focusableChildren=this.createCollection([this.queryView,this.resultsView]),this.set("isEnabled",!0),this.set("resultsCount",0),this.set("totalItemsCount",0),t.infoView&&t.infoView.instance?this.infoView=t.infoView.instance:(this.infoView=new p7,this._enableDefaultInfoViewBehavior(),this.on("render",()=>{this.search("")})),this.resultsView.children.addMany([this.infoView,this.filteredView]),this.focusCycler=new et({focusables:this.focusableChildren,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.on("search",(n,{resultsCount:s,totalItemsCount:o})=>{this.resultsCount=s,this.totalItemsCount=o}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-search",t.class||null],tabindex:"-1"},children:this.children})}render(){super.render(),this.children.addMany([this.queryView,this.resultsView]);const e=t=>t.stopPropagation();for(const t of this.focusableChildren)this.focusTracker.add(t.element);this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}focus(){this.queryView.focus()}reset(){this.queryView.reset(),this.search("")}search(e){const t=e?new RegExp(Pk(e),"ig"):null,n=this.filteredView.filter(t);this.fire("search",{query:e,...n})}_createSearchTextQueryView(){const e=new g7(this.locale,this._config.queryView);return this.listenTo(e.fieldView,"input",()=>{this.search(e.fieldView.element.value)}),e.on("reset",()=>this.reset()),e.bind("isEnabled").to(this),e}_enableDefaultInfoViewBehavior(){const e=this.locale.t,t=this.infoView;this.on("search",(s,o)=>{if(o.resultsCount)t.set({isVisible:!1});else{const r=this._config.infoView&&this._config.infoView.text;let a,l;o.totalItemsCount?r&&r.notFound?(a=r.notFound.primary,l=r.notFound.secondary):(a=e("No results found"),l=""):r&&r.noSearchableItems?(a=r.noSearchableItems.primary,l=r.noSearchableItems.secondary):(a=e("No searchable items"),l=""),t.set({primaryText:n(a,o),secondaryText:n(l,o),isVisible:!0})}});function n(s,{query:o,resultsCount:r,totalItemsCount:a}){return typeof s=="function"?s(o,r,a):s}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ls extends w7{constructor(e,t){super(e,t),this._config=t;const n=di("px");this.extendTemplate({attributes:{class:["ck-autocomplete"]}});const s=this.resultsView.bindTemplate;this.resultsView.set("isVisible",!1),this.resultsView.set("_position","s"),this.resultsView.set("_width",0),this.resultsView.extendTemplate({attributes:{class:[s.if("isVisible","ck-hidden",o=>!o),s.to("_position",o=>`ck-search__results_${o}`)],style:{width:s.to("_width",n)}}}),this.focusTracker.on("change:isFocused",(o,r,a)=>{this._updateResultsVisibility(),a?this.resultsView.element.scrollTop=0:t.resetOnBlur&&this.queryView.reset()}),this.on("search",()=>{this._updateResultsVisibility(),this._updateResultsViewWidthAndPosition()}),this.keystrokes.set("esc",(o,r)=>{this.resultsView.isVisible&&(this.queryView.focus(),this.resultsView.isVisible=!1,r())}),this.listenTo(I.document,"scroll",()=>{this._updateResultsViewWidthAndPosition()}),this.on("change:isEnabled",()=>{this._updateResultsVisibility()}),this.filteredView.on("execute",(o,{value:r})=>{this.focus(),this.reset(),this.queryView.fieldView.value=this.queryView.fieldView.element.value=r,this.resultsView.isVisible=!1}),this.resultsView.on("change:isVisible",()=>{this._updateResultsViewWidthAndPosition()})}_updateResultsViewWidthAndPosition(){if(!this.resultsView.isVisible)return;this.resultsView._width=new z(this.queryView.fieldView.element).width;const e=Ls._getOptimalPosition({element:this.resultsView.element,target:this.queryView.element,fitInViewport:!0,positions:Ls.defaultResultsPositions});this.resultsView._position=e?e.name:"s"}_updateResultsVisibility(){const e=typeof this._config.queryMinChars>"u"?0:this._config.queryMinChars,t=this.queryView.fieldView.element.value.length;this.resultsView.isVisible=this.focusTracker.isFocused&&this.isEnabled&&t>=e}}Ls.defaultResultsPositions=[i=>({top:i.bottom,left:i.left,name:"s"}),(i,e)=>({top:i.top-e.height,left:i.left,name:"n"})],Ls._getOptimalPosition=Ro;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _7 extends N{constructor(e){super(e);const t=this.bindTemplate;this.set({withText:!0,role:"menuitem"}),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__button"],"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",n=>String(n)),"data-cke-tooltip-disabled":t.to("isOn")},on:{mouseenter:t.to("mouseenter")}})}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new Mt;return e.content=Vl,e.extendTemplate({attributes:{class:"ck-menu-bar__menu__button__arrow"}}),e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Bi extends Dn{constructor(e,t){super(e);const n=this.bindTemplate;this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item"]},on:{mouseenter:n.to("mouseenter")}}),this.delegate("mouseenter").to(t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const hr=5,Vs={toggleMenusAndFocusItemsOnHover(i){i.on("menu:mouseenter",e=>{if(i.isOpen){for(const t of i.menus){const n=e.path[0],s=n instanceof Bi&&n.children.first===t;t.isOpen=(e.path.includes(t)||s)&&t.isEnabled}e.source.focus()}})},focusCycleMenusOnArrows(i){const e=i.locale.uiLanguageDirection==="rtl";i.on("menu:arrowright",n=>{t(n.source,e?-1:1)}),i.on("menu:arrowleft",n=>{t(n.source,e?1:-1)});function t(n,s){const o=i.children.getIndex(n),r=n.isOpen,a=i.children.length,l=i.children.get((o+a+s)%a);n.isOpen=!1,r&&(l.isOpen=!0),l.buttonView.focus()}},closeMenusWhenTheBarCloses(i){i.on("change:isOpen",()=>{i.isOpen||i.menus.forEach(e=>{e.isOpen=!1})})},closeMenuWhenAnotherOnTheSameLevelOpens(i){i.on("menu:change:isOpen",(e,t,n)=>{n&&i.menus.filter(s=>e.source.parentMenuView===s.parentMenuView&&e.source!==s&&s.isOpen).forEach(s=>{s.isOpen=!1})})},closeOnClickOutside(i){Vn({emitter:i,activator:()=>i.isOpen,callback:()=>i.close(),contextElements:()=>i.children.map(e=>e.element)})}},Nn={openAndFocusPanelOnArrowDownKey(i){i.keystrokes.set("arrowdown",(e,t)=>{i.focusTracker.focusedElement===i.buttonView.element&&(i.isOpen||(i.isOpen=!0),i.panelView.focus(),t())})},openOnArrowRightKey(i){const e=i.locale.uiLanguageDirection==="rtl"?"arrowleft":"arrowright";i.keystrokes.set(e,(t,n)=>{i.focusTracker.focusedElement!==i.buttonView.element||!i.isEnabled||(i.isOpen||(i.isOpen=!0),i.panelView.focus(),n())})},openOnButtonClick(i){i.buttonView.on("execute",()=>{i.isOpen=!0,i.panelView.focus()})},toggleOnButtonClick(i){i.buttonView.on("execute",()=>{i.isOpen=!i.isOpen,i.isOpen&&i.panelView.focus()})},closeOnArrowLeftKey(i){const e=i.locale.uiLanguageDirection==="rtl"?"arrowright":"arrowleft";i.keystrokes.set(e,(t,n)=>{i.isOpen&&(i.isOpen=!1,i.focus(),n())})},closeOnEscKey(i){i.keystrokes.set("esc",(e,t)=>{i.isOpen&&(i.isOpen=!1,i.focus(),t())})},closeOnParentClose(i){i.parentMenuView.on("change:isOpen",(e,t,n)=>{!n&&e.source===i.parentMenuView&&(i.isOpen=!1)})}},v7={southEast:i=>({top:i.bottom,left:i.left,name:"se"}),southWest:(i,e)=>({top:i.bottom,left:i.left-e.width+i.width,name:"sw"}),northEast:(i,e)=>({top:i.top-e.height,left:i.left,name:"ne"}),northWest:(i,e)=>({top:i.top-e.height,left:i.left-e.width+i.width,name:"nw"}),eastSouth:i=>({top:i.top,left:i.right-hr,name:"es"}),eastNorth:(i,e)=>({top:i.top-e.height,left:i.right-hr,name:"en"}),westSouth:(i,e)=>({top:i.top,left:i.left-e.width+hr,name:"ws"}),westNorth:(i,e)=>({top:i.top-e.height,left:i.left-e.width+hr,name:"wn"})},y7=[{menuId:"file",label:"File",groups:[{groupId:"export",items:["menuBar:exportPdf","menuBar:exportWord"]},{groupId:"import",items:["menuBar:importWord"]},{groupId:"revisionHistory",items:["menuBar:revisionHistory"]}]},{menuId:"edit",label:"Edit",groups:[{groupId:"undo",items:["menuBar:undo","menuBar:redo"]},{groupId:"selectAll",items:["menuBar:selectAll"]},{groupId:"findAndReplace",items:["menuBar:findAndReplace"]}]},{menuId:"view",label:"View",groups:[{groupId:"sourceEditing",items:["menuBar:sourceEditing"]},{groupId:"showBlocks",items:["menuBar:showBlocks"]},{groupId:"restrictedEditingException",items:["menuBar:restrictedEditingException"]}]},{menuId:"insert",label:"Insert",groups:[{groupId:"insertMainWidgets",items:["menuBar:uploadImage","menuBar:ckbox","menuBar:ckfinder","menuBar:insertTable"]},{groupId:"insertInline",items:["menuBar:link","menuBar:comment"]},{groupId:"insertMinorWidgets",items:["menuBar:insertTemplate","menuBar:blockQuote","menuBar:codeBlock","menuBar:htmlEmbed"]},{groupId:"insertStructureWidgets",items:["menuBar:horizontalLine","menuBar:pageBreak","menuBar:tableOfContents"]},{groupId:"restrictedEditing",items:["menuBar:restrictedEditing"]}]},{menuId:"format",label:"Format",groups:[{groupId:"textAndFont",items:[{menuId:"text",label:"Text",groups:[{groupId:"basicStyles",items:["menuBar:bold","menuBar:italic","menuBar:underline","menuBar:strikethrough","menuBar:superscript","menuBar:subscript","menuBar:code"]},{groupId:"textPartLanguage",items:["menuBar:textPartLanguage"]}]},{menuId:"font",label:"Font",groups:[{groupId:"fontProperties",items:["menuBar:fontSize","menuBar:fontFamily"]},{groupId:"fontColors",items:["menuBar:fontColor","menuBar:fontBackgroundColor"]},{groupId:"highlight",items:["menuBar:highlight"]}]},"menuBar:heading"]},{groupId:"list",items:["menuBar:bulletedList","menuBar:numberedList","menuBar:todoList"]},{groupId:"indent",items:["menuBar:alignment","menuBar:indent","menuBar:outdent"]},{groupId:"caseChange",items:["menuBar:caseChange"]},{groupId:"removeFormat",items:["menuBar:removeFormat"]}]},{menuId:"tools",label:"Tools",groups:[{groupId:"aiTools",items:["menuBar:aiAssistant","menuBar:aiCommands"]},{groupId:"tools",items:["menuBar:trackChanges","menuBar:commentsArchive"]}]},{menuId:"help",label:"Help",groups:[{groupId:"help",items:["menuBar:accessibilityHelp"]}]}];function C7(i){let e;return!("items"in i)||!i.items?e={items:ot(y7),addItems:[],removeItems:[],isVisible:!0,isUsingDefaultConfig:!0,...i}:e={items:i.items,removeItems:[],addItems:[],isVisible:!0,isUsingDefaultConfig:!1,...i},e}function k7({normalizedConfig:i,locale:e,componentFactory:t}){const n=ot(i);return T7(i,n),E7(i,n),A7(i,n,t),yg(i,n),x7(n,e),n}function T7(i,e){const t=e.removeItems,n=[];e.items=e.items.filter(({menuId:s})=>t.includes(s)?(n.push(s),!1):!0),Oi(e.items,s=>{s.groups=s.groups.filter(({groupId:o})=>t.includes(o)?(n.push(o),!1):!0);for(const o of s.groups)o.items=o.items.filter(r=>{const a=Cg(r);return t.includes(a)?(n.push(a),!1):!0})});for(const s of t)n.includes(s)||Q("menu-bar-item-could-not-be-removed",{menuBarConfig:i,itemName:s})}function E7(i,e){const t=e.addItems,n=[];for(const s of t){const o=P7(s.position),r=R7(s.position);if(S7(s))if(!r)o==="start"?(e.items.unshift(s.menu),n.push(s)):o==="end"&&(e.items.push(s.menu),n.push(s));else{const a=e.items.findIndex(l=>l.menuId===r);a!=-1?o==="before"?(e.items.splice(a,0,s.menu),n.push(s)):o==="after"&&(e.items.splice(a+1,0,s.menu),n.push(s)):vg(e,s.menu,r,o)&&n.push(s)}else I7(s)?Oi(e.items,a=>{if(a.menuId===r)o==="start"?(a.groups.unshift(s.group),n.push(s)):o==="end"&&(a.groups.push(s.group),n.push(s));else{const l=a.groups.findIndex(c=>c.groupId===r);l!==-1&&(o==="before"?(a.groups.splice(l,0,s.group),n.push(s)):o==="after"&&(a.groups.splice(l+1,0,s.group),n.push(s)))}}):vg(e,s.item,r,o)&&n.push(s)}for(const s of t)n.includes(s)||Q("menu-bar-item-could-not-be-added",{menuBarConfig:i,addedItemConfig:s})}function vg(i,e,t,n){let s=!1;return Oi(i.items,o=>{for(const{groupId:r,items:a}of o.groups){if(s)return;if(r===t)n==="start"?(a.unshift(e),s=!0):n==="end"&&(a.push(e),s=!0);else{const l=a.findIndex(c=>Cg(c)===t);l!==-1&&(n==="before"?(a.splice(l,0,e),s=!0):n==="after"&&(a.splice(l+1,0,e),s=!0))}}}),s}function A7(i,e,t){Oi(e.items,n=>{for(const s of n.groups)s.items=s.items.filter(o=>{const r=typeof o=="string"&&!t.has(o);return r&&!e.isUsingDefaultConfig&&Q("menu-bar-item-unavailable",{menuBarConfig:i,parentMenuConfig:ot(n),componentName:o}),!r})})}function yg(i,e){const t=e.isUsingDefaultConfig;let n=!1;if(e.items=e.items.filter(s=>s.groups.length?!0:(Yl(i,s,t),!1)),!e.items.length){Yl(i,i,t);return}Oi(e.items,s=>{s.groups=s.groups.filter(o=>o.items.length?!0:(n=!0,!1));for(const o of s.groups)o.items=o.items.filter(r=>kg(r)&&!r.groups.length?(Yl(i,r,t),n=!0,!1):!0)}),n&&yg(i,e)}function Yl(i,e,t){t||Q("menu-bar-menu-empty",{menuBarConfig:i,emptyMenuConfig:e})}function x7(i,e){const t=e.t,n={File:t({string:"File",id:"MENU_BAR_MENU_FILE"}),Edit:t({string:"Edit",id:"MENU_BAR_MENU_EDIT"}),View:t({string:"View",id:"MENU_BAR_MENU_VIEW"}),Insert:t({string:"Insert",id:"MENU_BAR_MENU_INSERT"}),Format:t({string:"Format",id:"MENU_BAR_MENU_FORMAT"}),Tools:t({string:"Tools",id:"MENU_BAR_MENU_TOOLS"}),Help:t({string:"Help",id:"MENU_BAR_MENU_HELP"}),Text:t({string:"Text",id:"MENU_BAR_MENU_TEXT"}),Font:t({string:"Font",id:"MENU_BAR_MENU_FONT"})};Oi(i.items,s=>{s.label in n&&(s.label=n[s.label])})}function Oi(i,e){if(Array.isArray(i))for(const n of i)t(n);function t(n){e(n);for(const s of n.groups)for(const o of s.items)kg(o)&&t(o)}}function S7(i){return typeof i=="object"&&"menu"in i}function I7(i){return typeof i=="object"&&"group"in i}function P7(i){return i.startsWith("start")?"start":i.startsWith("end")?"end":i.startsWith("after")?"after":"before"}function R7(i){const e=i.match(/^[^:]+:(.+)/);return e?e[1]:null}function Cg(i){return typeof i=="string"?i:i.menuId}function kg(i){return typeof i=="object"&&"menuId"in i}function M7(i,e){const t=e.element;i.ui.focusTracker.add(t),i.keystrokes.listenTo(t);const n=C7(i.config.get("menuBar")||{});e.fillFromConfig(n,i.ui.componentFactory),i.keystrokes.set("Esc",(s,o)=>{t.contains(i.ui.focusTracker.focusedElement)&&(i.editing.view.focus(),o())}),i.keystrokes.set("Alt+F9",(s,o)=>{t.contains(i.ui.focusTracker.focusedElement)||(e.focus(),o())})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class B7 extends R{constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-menu-bar__menu__panel",t.to("position",n=>`ck-menu-bar__menu__panel_position_${n}`),t.if("isVisible","ck-hidden",n=>!n)],tabindex:"-1"},children:this.children,on:{selectstart:t.to(n=>{n.target.tagName.toLocaleLowerCase()!=="input"&&n.preventDefault()})}})}focus(e=1){this.children.length&&(e===1?this.children.first.focus():this.children.last.focus())}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Lt extends R{constructor(e){super(e);const t=this.bindTemplate;this.buttonView=new _7(e),this.buttonView.delegate("mouseenter").to(this),this.buttonView.bind("isOn","isEnabled").to(this,"isOpen","isEnabled"),this.panelView=new B7(e),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new Te,this.focusTracker=new be,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("panelPosition","w"),this.set("class",void 0),this.set("parentMenuView",null),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar__menu",t.to("class"),t.if("isEnabled","ck-disabled",n=>!n),t.if("parentMenuView","ck-menu-bar__menu_top-level",n=>!n)]},children:[this.buttonView,this.panelView]})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.keystrokes.listenTo(this.element),Nn.closeOnEscKey(this),this._repositionPanelOnOpen()}_attachBehaviors(){this.parentMenuView?(Nn.openOnButtonClick(this),Nn.openOnArrowRightKey(this),Nn.closeOnArrowLeftKey(this),Nn.closeOnParentClose(this)):(this._propagateArrowKeystrokeEvents(),Nn.openAndFocusPanelOnArrowDownKey(this),Nn.toggleOnButtonClick(this))}_propagateArrowKeystrokeEvents(){this.keystrokes.set("arrowright",(e,t)=>{this.fire("arrowright"),t()}),this.keystrokes.set("arrowleft",(e,t)=>{this.fire("arrowleft"),t()})}_repositionPanelOnOpen(){this.on("change:isOpen",(e,t,n)=>{if(!n)return;const s=Lt._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=s?s.name:this._panelPositions[0].name})}focus(){this.buttonView.focus()}get _panelPositions(){const{southEast:e,southWest:t,northEast:n,northWest:s,westSouth:o,eastSouth:r,westNorth:a,eastNorth:l}=v7;return this.locale.uiLanguageDirection==="ltr"?this.parentMenuView?[r,l,o,a]:[e,t,n,s]:this.parentMenuView?[o,a,r,l]:[t,e,s,n]}}Lt._getOptimalPosition=Ro;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ds extends ar{constructor(e){super(e),this.role="menu"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ae extends N{constructor(e){super(e),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class O7 extends P4{constructor(e){super(e),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Tg=["mouseenter","arrowleft","arrowright","change:isOpen"];class L7 extends R{constructor(e){super(e),this.menus=[];const t=e.t;this.set("isOpen",!1),this._setupIsOpenUpdater(),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar"],"aria-label":t("Editor menu bar"),role:"menubar"},children:this.children})}fillFromConfig(e,t){const n=this.locale,o=k7({normalizedConfig:e,locale:n,componentFactory:t}).items.map(r=>this._createMenu({componentFactory:t,menuDefinition:r}));this.children.addMany(o)}render(){super.render(),Vs.toggleMenusAndFocusItemsOnHover(this),Vs.closeMenusWhenTheBarCloses(this),Vs.closeMenuWhenAnotherOnTheSameLevelOpens(this),Vs.focusCycleMenusOnArrows(this),Vs.closeOnClickOutside(this)}focus(){this.children.first&&this.children.first.focus()}close(){for(const e of this.children)e.isOpen=!1}registerMenu(e,t=null){t?(e.delegate(...Tg).to(t),e.parentMenuView=t):e.delegate(...Tg).to(this,n=>"menu:"+n),e._attachBehaviors(),this.menus.push(e)}_createMenu({componentFactory:e,menuDefinition:t,parentMenuView:n}){const s=this.locale,o=new Lt(s);return this.registerMenu(o,n),o.buttonView.set({label:t.label}),o.once("change:isOpen",()=>{const r=new Ds(s);r.ariaLabel=t.label,o.panelView.children.add(r),r.items.addMany(this._createMenuItems({menuDefinition:t,parentMenuView:o,componentFactory:e}))}),o}_createMenuItems({menuDefinition:e,parentMenuView:t,componentFactory:n}){const s=this.locale,o=[];for(const r of e.groups){for(const a of r.items){const l=new Bi(s,t);if(ie(a))l.children.add(this._createMenu({componentFactory:n,menuDefinition:a,parentMenuView:t}));else{const c=this._createMenuItemContentFromFactory({componentName:a,componentFactory:n,parentMenuView:t});if(!c)continue;l.children.add(c)}o.push(l)}r!==e.groups[e.groups.length-1]&&o.push(new or(s))}return o}_createMenuItemContentFromFactory({componentName:e,parentMenuView:t,componentFactory:n}){const s=n.create(e);return s instanceof Lt||s instanceof Ae||s instanceof O7?(this._registerMenuTree(s,t),s.on("execute",()=>{this.close()}),s):(Q("menu-bar-component-unsupported",{componentName:e,componentView:s}),null)}_registerMenuTree(e,t){if(!(e instanceof Lt)){e.delegate("mouseenter").to(t);return}this.registerMenu(e,t);const n=e.panelView.children.filter(o=>o instanceof Ds)[0];if(!n){e.delegate("mouseenter").to(t);return}const s=n.items.filter(o=>o instanceof Dn);for(const o of s)this._registerMenuTree(o.children.get(0),e)}_setupIsOpenUpdater(){let e;this.on("menu:change:isOpen",(t,n,s)=>{clearTimeout(e),s?this.isOpen=!0:e=setTimeout(()=>{this.isOpen=Array.from(this.children).some(o=>o.isOpen)},0)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function fr({editor:i,commandName:e,plugin:t,icon:n,label:s,keystroke:o}){return r=>{const a=i.commands.get(e),l=new r(i.locale);return l.set({label:s,icon:n,keystroke:o,isToggleable:!0}),l.bind("isEnabled").to(a,"isEnabled"),t.listenTo(l,"execute",()=>{i.execute(e),i.editing.view.focus()}),l}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const mr="bold";class V7 extends y{static get pluginName(){return"BoldUI"}init(){const e=this.editor,t=e.locale.t,n=e.commands.get(mr),s=fr({editor:e,commandName:mr,plugin:this,icon:P.bold,label:t("Bold"),keystroke:"CTRL+B"});e.ui.componentFactory.add(mr,()=>{const o=s(N);return o.set({tooltip:!0}),o.bind("isOn").to(n,"value"),o}),e.ui.componentFactory.add("menuBar:"+mr,()=>s(Ae))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class D7 extends y{static get requires(){return[d4,V7]}static get pluginName(){return"Bold"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Li="italic";class N7 extends y{static get pluginName(){return"ItalicEditing"}init(){const e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:Li}),e.model.schema.setAttributeProperties(Li,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Li,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),e.commands.add(Li,new Xo(e,Li)),e.keystrokes.set("CTRL+I",Li),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Italic text"),keystroke:"CTRL+I"}]})}}const F7='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.586 14.633.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const gr="italic";class $7 extends y{static get pluginName(){return"ItalicUI"}init(){const e=this.editor,t=e.commands.get(gr),n=e.locale.t,s=fr({editor:e,commandName:gr,plugin:this,icon:F7,keystroke:"CTRL+I",label:n("Italic")});e.ui.componentFactory.add(gr,()=>{const o=s(N);return o.set({tooltip:!0}),o.bind("isOn").to(t,"value"),o}),e.ui.componentFactory.add("menuBar:"+gr,()=>s(Ae))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class U7 extends y{static get requires(){return[N7,$7]}static get pluginName(){return"Italic"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Ns="strikethrough";class z7 extends y{static get pluginName(){return"StrikethroughEditing"}init(){const e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:Ns}),e.model.schema.setAttributeProperties(Ns,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Ns,view:"s",upcastAlso:["del","strike",{styles:{"text-decoration":"line-through"}}]}),e.commands.add(Ns,new Xo(e,Ns)),e.keystrokes.set("CTRL+SHIFT+X","strikethrough"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Strikethrough text"),keystroke:"CTRL+SHIFT+X"}]})}}const H7='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 16.4c-.8-.4-1.5-.9-2.2-1.5a.6.6 0 0 1-.2-.5l.3-.6h1c1 1.2 2.1 1.7 3.7 1.7 1 0 1.8-.3 2.3-.6.6-.4.6-1.2.6-1.3.2-1.2-.9-2.1-.9-2.1h2.1c.3.7.4 1.2.4 1.7v.8l-.6 1.2c-.6.8-1.1 1-1.6 1.2a6 6 0 0 1-2.4.6c-1 0-1.8-.3-2.5-.6zM6.8 9 6 8.3c-.4-.5-.5-.8-.5-1.6 0-.7.1-1.3.5-1.8.4-.6 1-1 1.6-1.3a6.3 6.3 0 0 1 4.7 0 4 4 0 0 1 1.7 1l.3.7c0 .1.2.4-.2.7-.4.2-.9.1-1 0a3 3 0 0 0-1.2-1c-.4-.2-1-.3-2-.4-.7 0-1.4.2-2 .6-.8.6-1 .8-1 1.5 0 .8.5 1 1.2 1.5.6.4 1.1.7 1.9 1H6.8z"/><path d="M3 10.5V9h14v1.5z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const pr="strikethrough";class W7 extends y{static get pluginName(){return"StrikethroughUI"}init(){const e=this.editor,t=e.locale.t,n=fr({editor:e,commandName:pr,plugin:this,icon:H7,keystroke:"CTRL+SHIFT+X",label:t("Strikethrough")});e.ui.componentFactory.add(pr,()=>{const s=n(N),o=e.commands.get(pr);return s.set({tooltip:!0}),s.bind("isOn").to(o,"value"),s}),e.ui.componentFactory.add("menuBar:"+pr,()=>n(Ae))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class j7 extends y{static get requires(){return[z7,W7]}static get pluginName(){return"Strikethrough"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Fs="underline";class q7 extends y{static get pluginName(){return"UnderlineEditing"}init(){const e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:Fs}),e.model.schema.setAttributeProperties(Fs,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Fs,view:"u",upcastAlso:{styles:{"text-decoration":"underline"}}}),e.commands.add(Fs,new Xo(e,Fs)),e.keystrokes.set("CTRL+U","underline"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Underline text"),keystroke:"CTRL+U"}]})}}const G7='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 18v-1.5h14V18zm2.2-8V3.6c0-.4.4-.6.8-.6.3 0 .7.2.7.6v6.2c0 2 1.3 2.8 3.2 2.8 1.9 0 3.4-.9 3.4-2.9V3.6c0-.3.4-.5.8-.5.3 0 .7.2.7.5V10c0 2.7-2.2 4-4.9 4-2.6 0-4.7-1.2-4.7-4z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const br="underline";class K7 extends y{static get pluginName(){return"UnderlineUI"}init(){const e=this.editor,t=e.commands.get(br),n=e.locale.t,s=fr({editor:e,commandName:br,plugin:this,icon:G7,label:n("Underline"),keystroke:"CTRL+U"});e.ui.componentFactory.add(br,()=>{const o=s(N);return o.set({tooltip:!0}),o.bind("isOn").to(t,"value"),o}),e.ui.componentFactory.add("menuBar:"+br,()=>s(Ae))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Z7 extends y{static get requires(){return[q7,K7]}static get pluginName(){return"Underline"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function*Eg(i,e){for(const t of e)t&&i.getAttributeProperties(t[0]).copyOnEnter&&(yield t)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class J7 extends F{execute(){this.editor.model.change(e=>{this.enterBlock(e),this.fire("afterExecute",{writer:e})})}enterBlock(e){const t=this.editor.model,n=t.document.selection,s=t.schema,o=n.isCollapsed,r=n.getFirstRange(),a=r.start.parent,l=r.end.parent;if(s.isLimit(a)||s.isLimit(l))return!o&&a==l&&t.deleteContent(n),!1;if(o){const c=Eg(e.model.schema,n.getAttributes());return Ag(e,r.start),e.setSelectionAttribute(c),!0}else{const c=!(r.start.isAtStart&&r.end.isAtEnd),u=a==l;if(t.deleteContent(n,{leaveUnmerged:c}),c){if(u)return Ag(e,n.focus),!0;e.setSelection(l,0)}}return!1}}function Ag(i,e){i.split(e),i.setSelection(e.parent.nextSibling,0)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Y7={insertParagraph:{isSoft:!1},insertLineBreak:{isSoft:!0}};class xg extends Pt{constructor(e){super(e);const t=this.document;let n=!1;t.on("keydown",(s,o)=>{n=o.shiftKey}),t.on("beforeinput",(s,o)=>{if(!this.isEnabled)return;let r=o.inputType;$.isSafari&&n&&r=="insertParagraph"&&(r="insertLineBreak");const a=o.domEvent,l=Y7[r];if(!l)return;const c=new fi(t,"enter",o.targetRanges[0]);t.fire(c,new pi(e,a,{isSoft:l.isSoft})),c.stop.called&&s.stop()})}observe(){}stopObserving(){}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $s extends y{static get pluginName(){return"Enter"}init(){const e=this.editor,t=e.editing.view,n=t.document,s=this.editor.t;t.addObserver(xg),e.commands.add("enter",new J7(e)),this.listenTo(n,"enter",(o,r)=>{n.isComposing||r.preventDefault(),!r.isSoft&&(e.execute("enter"),t.scrollToTheSelection())},{priority:"low"}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:s("Insert a hard break (a new paragraph)"),keystroke:"Enter"}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class X7 extends F{execute(){const e=this.editor.model,t=e.document;e.change(n=>{eI(e,n,t.selection),this.fire("afterExecute",{writer:n})})}refresh(){const e=this.editor.model,t=e.document;this.isEnabled=Q7(e.schema,t.selection)}}function Q7(i,e){if(e.rangeCount>1)return!1;const t=e.anchor;if(!t||!i.checkChild(t,"softBreak"))return!1;const n=e.getFirstRange(),s=n.start.parent,o=n.end.parent;return!((Xl(s,i)||Xl(o,i))&&s!==o)}function eI(i,e,t){const n=t.isCollapsed,s=t.getFirstRange(),o=s.start.parent,r=s.end.parent,a=o==r;if(n){const l=Eg(i.schema,t.getAttributes());Sg(i,e,s.end),e.removeSelectionAttribute(t.getAttributeKeys()),e.setSelectionAttribute(l)}else{const l=!(s.start.isAtStart&&s.end.isAtEnd);i.deleteContent(t,{leaveUnmerged:l}),a?Sg(i,e,t.focus):l&&e.setSelection(r,0)}}function Sg(i,e,t){const n=e.createElement("softBreak");i.insertContent(n,t),e.setSelection(n,"after")}function Xl(i,e){return i.is("rootElement")?!1:e.isLimit(i)||Xl(i.parent,e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ig extends y{static get pluginName(){return"ShiftEnter"}init(){const e=this.editor,t=e.model.schema,n=e.conversion,s=e.editing.view,o=s.document,r=this.editor.t;t.register("softBreak",{allowWhere:"$text",isInline:!0}),n.for("upcast").elementToElement({model:"softBreak",view:"br"}),n.for("downcast").elementToElement({model:"softBreak",view:(a,{writer:l})=>l.createEmptyElement("br")}),s.addObserver(xg),e.commands.add("shiftEnter",new X7(e)),this.listenTo(o,"enter",(a,l)=>{o.isComposing||l.preventDefault(),l.isSoft&&(e.execute("shiftEnter"),s.scrollToTheSelection())},{priority:"low"}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:r("Insert a soft break (a <code>&lt;br&gt;</code> element)"),keystroke:"Shift+Enter"}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class tI extends F{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,n=t.schema,s=t.document.selection,o=Array.from(s.getSelectedBlocks()),r=e.forceValue===void 0?!this.value:e.forceValue;t.change(a=>{if(!r)this._removeQuote(a,o.filter(wr));else{const l=o.filter(c=>wr(c)||Rg(n,c));this._applyQuote(a,l)}})}_getValue(){const e=this.editor.model.document.selection,t=ce(e.getSelectedBlocks());return!!(t&&wr(t))}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,n=ce(e.getSelectedBlocks());return n?Rg(t,n):!1}_removeQuote(e,t){Pg(e,t).reverse().forEach(n=>{if(n.start.isAtStart&&n.end.isAtEnd){e.unwrap(n.start.parent);return}if(n.start.isAtStart){const o=e.createPositionBefore(n.start.parent);e.move(n,o);return}n.end.isAtEnd||e.split(n.end);const s=e.createPositionAfter(n.end.parent);e.move(n,s)})}_applyQuote(e,t){const n=[];Pg(e,t).reverse().forEach(s=>{let o=wr(s.start);o||(o=e.createElement("blockQuote"),e.wrap(s,o)),n.push(o)}),n.reverse().reduce((s,o)=>s.nextSibling==o?(e.merge(e.createPositionAfter(s)),s):o)}}function wr(i){return i.parent.name=="blockQuote"?i.parent:null}function Pg(i,e){let t,n=0;const s=[];for(;n<e.length;){const o=e[n],r=e[n+1];t||(t=i.createPositionBefore(o)),(!r||o.nextSibling!=r)&&(s.push(i.createRange(t,i.createPositionAfter(o))),t=null),n++}return s}function Rg(i,e){const t=i.checkChild(e.parent,"blockQuote"),n=i.checkChild(["$root","blockQuote"],e);return t&&n}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nI extends y{static get pluginName(){return"BlockQuoteEditing"}static get requires(){return[$s,Ln]}init(){const e=this.editor,t=e.model.schema;e.commands.add("blockQuote",new tI(e)),t.register("blockQuote",{inheritAllFrom:"$container"}),e.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),e.model.document.registerPostFixer(r=>{const a=e.model.document.differ.getChanges();for(const l of a)if(l.type=="insert"){const c=l.position.nodeAfter;if(!c)continue;if(c.is("element","blockQuote")&&c.isEmpty)return r.remove(c),!0;if(c.is("element","blockQuote")&&!t.checkChild(l.position,c))return r.unwrap(c),!0;if(c.is("element")){const u=r.createRangeIn(c);for(const d of u.getItems())if(d.is("element","blockQuote")&&!t.checkChild(r.createPositionBefore(d),d))return r.unwrap(d),!0}}else if(l.type=="remove"){const c=l.position.parent;if(c.is("element","blockQuote")&&c.isEmpty)return r.remove(c),!0}return!1});const n=this.editor.editing.view.document,s=e.model.document.selection,o=e.commands.get("blockQuote");this.listenTo(n,"enter",(r,a)=>{if(!s.isCollapsed||!o.value)return;s.getLastPosition().parent.isEmpty&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),a.preventDefault(),r.stop())},{context:"blockquote"}),this.listenTo(n,"delete",(r,a)=>{if(a.direction!="backward"||!s.isCollapsed||!o.value)return;const l=s.getLastPosition().parent;l.isEmpty&&!l.previousSibling&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),a.preventDefault(),r.stop())},{context:"blockquote"})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class iI extends y{static get pluginName(){return"BlockQuoteUI"}init(){const e=this.editor,t=e.commands.get("blockQuote");e.ui.componentFactory.add("blockQuote",()=>{const n=this._createButton(N);return n.set({tooltip:!0}),n.bind("isOn").to(t,"value"),n}),e.ui.componentFactory.add("menuBar:blockQuote",()=>this._createButton(Ae))}_createButton(e){const t=this.editor,n=t.locale,s=t.commands.get("blockQuote"),o=new e(t.locale),r=n.t;return o.set({label:r("Block quote"),icon:P.quote,isToggleable:!0}),o.bind("isEnabled").to(s,"isEnabled"),this.listenTo(o,"execute",()=>{t.execute("blockQuote"),t.editing.view.focus()}),o}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class sI extends y{static get requires(){return[nI,iI]}static get pluginName(){return"BlockQuote"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function _r(i){const e=i.t,t=i.config.get("codeBlock.languages");for(const n of t)n.label==="Plain text"&&(n.label=e("Plain text")),n.class===void 0&&(n.class=`language-${n.language}`);return t}function vr(i,e,t){const n={};for(const s of i)if(e==="class"){const o=s[e].split(" ").shift();n[o]=s[t]}else n[s[e]]=s[t];return n}function Ql(i){return i.data.match(/^(\s*)/)[0]}function oI(i,e){const t=i.createDocumentFragment(),n=e.split(`
`),s=n.reduce((o,r,a)=>(o.push(r),a<n.length-1&&o.push(i.createElement("br")),o),[]);return i.appendChild(s,t),t}function ec(i){const e=i.document.selection,t=[];if(e.isCollapsed)return[e.anchor];const n=e.getFirstRange().getWalker({ignoreElementEnd:!0,direction:"backward"});for(const{item:s}of n){if(!s.is("$textProxy"))continue;const{parent:o,startOffset:r}=s.textNode;if(!o.is("element","codeBlock"))continue;const a=Ql(s.textNode),l=i.createPositionAt(o,r+a.length);t.push(l)}return t}function Mg(i){const e=ce(i.getSelectedBlocks());return!!e&&e.is("element","codeBlock")}function Bg(i,e){return e.is("rootElement")||i.isLimit(e)?!1:i.checkChild(e.parent,"codeBlock")}function Og(i,e,t,n){const s=vr(e,"language","label"),o=t.getAttribute("language");if(o in s){const r=s[o];return i(n==="enter"?"Entering %0 code snippet":"Leaving %0 code snippet",r)}return i(n==="enter"?"Entering code snippet":"Leaving code snippet")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class rI extends F{constructor(e){super(e),this._lastLanguage=null}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor,n=t.model,s=n.document.selection,r=_r(t)[0],a=Array.from(s.getSelectedBlocks()),l=e.forceValue==null?!this.value:e.forceValue,c=aI(e,this._lastLanguage,r.language);n.change(u=>{l?this._applyCodeBlock(u,a,c):this._removeCodeBlock(u,a)})}_getValue(){const e=this.editor.model.document.selection,t=ce(e.getSelectedBlocks());return!!(t&&t.is("element","codeBlock"))?t.getAttribute("language"):!1}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,n=ce(e.getSelectedBlocks());return n?Bg(t,n):!1}_applyCodeBlock(e,t,n){this._lastLanguage=n;const s=this.editor.model.schema,o=t.filter(r=>Bg(s,r));for(const r of o)e.rename(r,"codeBlock"),e.setAttribute("language",n,r),s.removeDisallowedAttributes([r],e),Array.from(r.getChildren()).filter(a=>!s.checkChild(r,a)).forEach(a=>e.remove(a));o.reverse().forEach((r,a)=>{const l=o[a+1];r.previousSibling===l&&(e.appendElement("softBreak",l),e.merge(e.createPositionBefore(r)))})}_removeCodeBlock(e,t){const n=t.filter(s=>s.is("element","codeBlock"));for(const s of n){const o=e.createRangeOn(s);for(const r of Array.from(o.getItems()).reverse())if(r.is("element","softBreak")&&r.parent.is("element","codeBlock")){const{position:a}=e.split(e.createPositionBefore(r)),l=a.nodeAfter;e.rename(l,"paragraph"),e.removeAttribute("language",l),e.remove(r)}e.rename(s,"paragraph"),e.removeAttribute("language",s)}}}function aI(i,e,t){return i.language?i.language:i.usePreviousLanguageChoice&&e?e:t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class lI extends F{constructor(e){super(e),this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const t=this.editor.model;t.change(n=>{const s=ec(t);for(const o of s){const r=n.createText(this._indentSequence);t.insertContent(r,o)}})}_checkEnabled(){return this._indentSequence?Mg(this.editor.model.document.selection):!1}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class cI extends F{constructor(e){super(e),this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const t=this.editor.model;t.change(()=>{const n=ec(t);for(const s of n){const o=Lg(t,s,this._indentSequence);o&&t.deleteContent(t.createSelection(o))}})}_checkEnabled(){if(!this._indentSequence)return!1;const e=this.editor.model;return Mg(e.document.selection)?ec(e).some(t=>Lg(e,t,this._indentSequence)):!1}}function Lg(i,e,t){const n=uI(e);if(!n)return null;const s=Ql(n),o=s.lastIndexOf(t);if(o+t.length!==s.length||o===-1)return null;const{parent:r,startOffset:a}=n;return i.createRange(i.createPositionAt(r,a+o),i.createPositionAt(r,a+o+t.length))}function uI(i){let e=i.parent.getChild(i.index);return(!e||e.is("element","softBreak"))&&(e=i.nodeBefore),!e||e.is("element","softBreak")?null:e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Vg(i,e,t=!1){const n=vr(e,"language","class"),s=vr(e,"language","label");return(o,r,a)=>{const{writer:l,mapper:c,consumable:u}=a;if(!u.consume(r.item,"insert"))return;const d=r.item.getAttribute("language"),h=c.toViewPosition(i.createPositionBefore(r.item)),f={};t&&(f["data-language"]=s[d],f.spellcheck="false");const m=n[d]?{class:n[d]}:void 0,g=l.createContainerElement("code",m),b=l.createContainerElement("pre",f,g);l.insert(h,b),c.bindElements(r.item,g)}}function dI(i){return(e,t,n)=>{if(t.item.parent.name!=="codeBlock")return;const{writer:s,mapper:o,consumable:r}=n;if(!r.consume(t.item,"insert"))return;const a=o.toViewPosition(i.createPositionBefore(t.item));s.insert(a,s.createText(`
`))}}function hI(i,e){const t=vr(e,"class","language"),n=e[0].language;return(s,o,r)=>{const a=o.viewItem,l=a.parent;if(!l||!l.is("element","pre")||o.modelCursor.findAncestor("codeBlock"))return;const{consumable:c,writer:u}=r;if(!c.test(a,{name:!0}))return;const d=u.createElement("codeBlock"),h=[...a.getClassNames()];h.length||h.push("");for(const f of h){const m=t[f];if(m){u.setAttribute("language",m,d);break}}d.hasAttribute("language")||u.setAttribute("language",n,d),r.convertChildren(a,d),r.safeInsert(d,o.modelCursor)&&(c.consume(a,{name:!0}),r.updateConversionResult(d,o))}}function fI(){return(i,e,{consumable:t,writer:n})=>{let s=e.modelCursor;if(!t.test(e.viewItem)||!s.findAncestor("codeBlock"))return;t.consume(e.viewItem);const r=e.viewItem.data.split(`
`).map(l=>n.createText(l)),a=r[r.length-1];for(const l of r)if(n.insert(l,s),s=s.getShiftedBy(l.offsetSize),l!==a){const c=n.createElement("softBreak");n.insert(c,s),s=n.createPositionAfter(c)}e.modelRange=n.createRange(e.modelCursor,s),e.modelCursor=s}}function mI(){return(i,e,{consumable:t})=>{const n=e.viewItem;if(n.findAncestor("pre"))return;const s=Array.from(n.getChildren()),o=s.find(r=>r.is("element","code"));if(o)for(const r of s)r===o||!r.is("$text")||t.consume(r,{name:!0})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Dg="paragraph";class gI extends y{static get pluginName(){return"CodeBlockEditing"}static get requires(){return[Ig]}constructor(e){super(e),e.config.define("codeBlock",{languages:[{language:"plaintext",label:"Plain text"},{language:"c",label:"C"},{language:"cs",label:"C#"},{language:"cpp",label:"C++"},{language:"css",label:"CSS"},{language:"diff",label:"Diff"},{language:"html",label:"HTML"},{language:"java",label:"Java"},{language:"javascript",label:"JavaScript"},{language:"php",label:"PHP"},{language:"python",label:"Python"},{language:"ruby",label:"Ruby"},{language:"typescript",label:"TypeScript"},{language:"xml",label:"XML"}],indentSequence:"	"})}init(){const e=this.editor,t=e.model.schema,n=e.model,s=e.editing.view,o=e.plugins.has("ListEditing")?e.plugins.get("ListEditing"):null,r=_r(e);e.commands.add("codeBlock",new rI(e)),e.commands.add("indentCodeBlock",new lI(e)),e.commands.add("outdentCodeBlock",new cI(e)),this.listenTo(s.document,"tab",(a,l)=>{const c=l.shiftKey?"outdentCodeBlock":"indentCodeBlock";e.commands.get(c).isEnabled&&(e.execute(c),l.stopPropagation(),l.preventDefault(),a.stop())},{context:"pre"}),t.register("codeBlock",{allowWhere:"$block",allowChildren:"$text",isBlock:!0,allowAttributes:["language"]}),t.addAttributeCheck((a,l)=>{if(a.endsWith("codeBlock")&&o&&o.getListAttributeNames().includes(l))return!0;if(a.endsWith("codeBlock $text"))return!1}),e.model.schema.addChildCheck((a,l)=>{if(a.endsWith("codeBlock")&&l.isObject)return!1}),e.editing.downcastDispatcher.on("insert:codeBlock",Vg(n,r,!0)),e.data.downcastDispatcher.on("insert:codeBlock",Vg(n,r)),e.data.downcastDispatcher.on("insert:softBreak",dI(n),{priority:"high"}),e.data.upcastDispatcher.on("element:code",hI(s,r)),e.data.upcastDispatcher.on("text",fI()),e.data.upcastDispatcher.on("element:pre",mI(),{priority:"high"}),this.listenTo(e.editing.view.document,"clipboardInput",(a,l)=>{let c=n.createRange(n.document.selection.anchor);if(l.targetRanges&&(c=e.editing.mapper.toModelRange(l.targetRanges[0])),!c.start.parent.is("element","codeBlock"))return;const u=l.dataTransfer.getData("text/plain"),d=new Ye(e.editing.view.document);l.content=oI(d,u)}),this.listenTo(n,"getSelectedContent",(a,[l])=>{const c=l.anchor;l.isCollapsed||!c.parent.is("element","codeBlock")||!c.hasSameParentAs(l.focus)||n.change(u=>{const d=a.return;if(c.parent.is("element")&&(d.childCount>1||l.containsEntireContent(c.parent))){const f=u.createElement("codeBlock",c.parent.getAttributes());u.append(d,f);const m=u.createDocumentFragment();u.append(f,m),a.return=m;return}const h=d.getChild(0);t.checkAttribute(h,"code")&&u.setAttribute("code",!0,h)})})}afterInit(){const e=this.editor,t=e.commands,n=t.get("indent"),s=t.get("outdent");n&&n.registerChildCommand(t.get("indentCodeBlock"),{priority:"highest"}),s&&s.registerChildCommand(t.get("outdentCodeBlock")),this.listenTo(e.editing.view.document,"enter",(o,r)=>{e.model.document.selection.getLastPosition().parent.is("element","codeBlock")&&(!bI(e,r.isSoft)&&!wI(e,r.isSoft)&&pI(e),r.preventDefault(),o.stop())},{context:"pre"}),this._initAriaAnnouncements()}_initAriaAnnouncements(){const{model:e,ui:t,t:n}=this.editor,s=_r(this.editor);let o=null;e.document.selection.on("change:range",()=>{const r=e.document.selection.focus.parent;!t||o===r||!r.is("element")||(o&&o.is("element","codeBlock")&&t.ariaLiveAnnouncer.announce(Og(n,s,o,"leave")),r.is("element","codeBlock")&&t.ariaLiveAnnouncer.announce(Og(n,s,r,"enter")),o=r)})}}function pI(i){const t=i.model.document,n=t.selection.getLastPosition(),s=n.nodeBefore||n.textNode;let o;s&&s.is("$text")&&(o=Ql(s)),i.model.change(r=>{i.execute("shiftEnter"),o&&r.insertText(o,t.selection.anchor)})}function bI(i,e){const n=i.model.document,s=i.editing.view,o=n.selection.getLastPosition(),r=o.nodeAfter;return e||!n.selection.isCollapsed||!o.isAtStart||!Fn(r)?!1:(i.model.change(a=>{i.execute("enter");const l=n.selection.anchor.parent.previousSibling;a.rename(l,Dg),a.setSelection(l,"in"),i.model.schema.removeDisallowedAttributes([l],a),a.remove(r)}),s.scrollToTheSelection(),!0)}function wI(i,e){const t=i.model,n=t.document,s=i.editing.view,o=n.selection.getLastPosition(),r=o.nodeBefore;let a;if(e||!n.selection.isCollapsed||!o.isAtEnd||!r||!r.previousSibling)return!1;if(Fn(r)&&Fn(r.previousSibling))a=t.createRange(t.createPositionBefore(r.previousSibling),t.createPositionAfter(r));else if(tc(r)&&Fn(r.previousSibling)&&Fn(r.previousSibling.previousSibling))a=t.createRange(t.createPositionBefore(r.previousSibling.previousSibling),t.createPositionAfter(r));else if(tc(r)&&Fn(r.previousSibling)&&tc(r.previousSibling.previousSibling)&&r.previousSibling.previousSibling&&Fn(r.previousSibling.previousSibling.previousSibling))a=t.createRange(t.createPositionBefore(r.previousSibling.previousSibling.previousSibling),t.createPositionAfter(r));else return!1;return i.model.change(l=>{l.remove(a),i.execute("enter");const c=n.selection.anchor.parent;l.rename(c,Dg),i.model.schema.removeDisallowedAttributes([c],l)}),s.scrollToTheSelection(),!0}function tc(i){return i&&i.is("$text")&&!i.data.match(/\S/)}function Fn(i){return i&&i.is("element","softBreak")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _I extends y{static get pluginName(){return"CodeBlockUI"}init(){const e=this.editor,t=e.t,n=e.ui.componentFactory,s=_r(e),o=this._getLanguageListItemDefinitions(s),r=e.commands.get("codeBlock");n.add("codeBlock",a=>{const l=tt(a,Bs),c=l.buttonView,u=t("Insert code block");return c.set({label:u,tooltip:!0,icon:P.codeBlock,isToggleable:!0}),c.bind("isOn").to(r,"value",d=>!!d),c.on("execute",()=>{e.execute("codeBlock",{usePreviousLanguageChoice:!0}),e.editing.view.focus()}),l.on("execute",d=>{e.execute("codeBlock",{language:d.source._codeBlockLanguage,forceValue:!0}),e.editing.view.focus()}),l.class="ck-code-block-dropdown",l.bind("isEnabled").to(r),Si(l,o,{role:"menu",ariaLabel:u}),l}),n.add("menuBar:codeBlock",a=>{const l=new Lt(a);l.buttonView.set({label:t("Code block"),icon:P.codeBlock}),l.bind("isEnabled").to(r);const c=new Ds(a);c.set({ariaLabel:t("Insert code block")});for(const u of o){const d=new Bi(a,l),h=new Ae(a);h.bind(...Object.keys(u.model)).to(u.model),h.bind("ariaChecked").to(h,"isOn"),h.delegate("execute").to(l),h.on("execute",()=>{e.execute("codeBlock",{language:u.model._codeBlockLanguage,forceValue:r.value!=u.model._codeBlockLanguage}),e.editing.view.focus()}),d.children.add(h),c.items.add(d)}return l.panelView.children.add(c),l})}_getLanguageListItemDefinitions(e){const n=this.editor.commands.get("codeBlock"),s=new Oe;for(const o of e){const r={type:"button",model:new Ri({_codeBlockLanguage:o.language,label:o.label,role:"menuitemradio",withText:!0})};r.model.bind("isOn").to(n,"value",a=>a===r.model._codeBlockLanguage),s.add(r)}return s}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class vI extends y{static get requires(){return[gI,_I]}static get pluginName(){return"CodeBlock"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class yI extends a7{constructor(e,t){super(e),this.view=t,this._toolbarConfig=Km(e.config.get("toolbar")),this._elementReplacer=new Jk,this.listenTo(e.editing.view,"scrollToTheSelection",this._handleScrollToTheSelectionWithStickyPanel.bind(this))}get element(){return this.view.element}init(e){const t=this.editor,n=this.view,s=t.editing.view,o=n.editable,r=s.document.getRoot();o.name=r.rootName,n.render();const a=o.element;this.setEditableElement(o.name,a),n.editable.bind("isFocused").to(this.focusTracker),s.attachDomRoot(a),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),n.menuBarView&&M7(t,n.menuBarView),this._initDialogPluginIntegration(),this.fire("ready")}destroy(){super.destroy();const e=this.view,t=this.editor.editing.view;this._elementReplacer.restore(),t.detachDomRoot(e.editable.name),e.destroy()}_initToolbar(){const e=this.view;e.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),e.stickyPanel.limiterElement=e.element,e.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",({top:t})=>t||0),e.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),this.addToolbar(e.toolbar)}_initPlaceholder(){const e=this.editor,t=e.editing.view,n=t.document.getRoot(),s=e.sourceElement;let o;const r=e.config.get("placeholder");r&&(o=typeof r=="string"?r:r[this.view.editable.name]),!o&&s&&s.tagName.toLowerCase()==="textarea"&&(o=s.getAttribute("placeholder")),o&&(n.placeholder=o),Oo({view:t,element:n,isDirectHost:!1,keepOnFocus:!0})}_handleScrollToTheSelectionWithStickyPanel(e,t,n){const s=this.view.stickyPanel;if(s.isSticky){const o=new z(s.element).height;t.viewportOffset.top+=o}else{const o=()=>{this.editor.editing.view.scrollToTheSelection(n)};this.listenTo(s,"change:isSticky",o),setTimeout(()=>{this.stopListening(s,"change:isSticky",o)},20)}}_initDialogPluginIntegration(){if(!this.editor.plugins.has("Dialog"))return;const e=this.view.stickyPanel,t=this.editor.plugins.get("Dialog");t.on("show",()=>{const n=t.view;n.on("moveTo",(s,o)=>{if(!e.isSticky||n.wasMoved)return;const r=new z(e.contentPanelElement);o[1]<r.bottom+Pi.defaultOffset&&(o[1]=r.bottom+Pi.defaultOffset)},{priority:"high"})},{priority:"low"})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class CI extends c7{constructor(e,t,n={}){super(e),this.stickyPanel=new m7(e),this.toolbar=new xi(e,{shouldGroupWhenFull:n.shouldToolbarGroupWhenFull}),n.useMenuBar&&(this.menuBarView=new L7(e)),this.editable=new d7(e,t)}render(){super.render(),this.menuBarView?this.stickyPanel.content.addMany([this.menuBarView,this.toolbar]):this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ng{constructor(e){if(this.crashes=[],this.state="initializing",this._now=Date.now,this.crashes=[],this._crashNumberLimit=typeof e.crashNumberLimit=="number"?e.crashNumberLimit:3,this._minimumNonErrorTimePeriod=typeof e.minimumNonErrorTimePeriod=="number"?e.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=t=>{const n="error"in t?t.error:t.reason;n instanceof Error&&this._handleError(n,t)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}destroy(){this._stopErrorHandling(),this._listeners={}}on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}off(e,t){this._listeners[e]=this._listeners[e].filter(n=>n!==t)}_fire(e,...t){const n=this._listeners[e]||[];for(const s of n)s.apply(this,[null,...t])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(e,t){if(this._shouldReactToError(e)){this.crashes.push({message:e.message,stack:e.stack,filename:t instanceof ErrorEvent?t.filename:void 0,lineno:t instanceof ErrorEvent?t.lineno:void 0,colno:t instanceof ErrorEvent?t.colno:void 0,date:this._now()});const n=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:e,causesRestart:n}),n?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(e){return e.is&&e.is("CKEditorError")&&e.context!==void 0&&e.context!==null&&this.state==="ready"&&this._isErrorComingFromThisItem(e)}_shouldRestart(){if(this.crashes.length<=this._crashNumberLimit)return!0;const e=this.crashes[this.crashes.length-1].date,t=this.crashes[this.crashes.length-1-this._crashNumberLimit].date;return(e-t)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function nc(i,e=new Set){const t=[i],n=new Set;let s=0;for(;t.length>s;){const o=t[s++];if(!(n.has(o)||!kI(o)||e.has(o)))if(n.add(o),Symbol.iterator in o)try{for(const r of o)t.push(r)}catch{}else for(const r in o)r!=="defaultValue"&&t.push(o[r])}return n}function kI(i){const e=Object.prototype.toString.call(i),t=typeof i;return!(t==="number"||t==="boolean"||t==="string"||t==="symbol"||t==="function"||e==="[object Date]"||e==="[object RegExp]"||e==="[object Module]"||i===void 0||i===null||i._watchdogExcluded||i instanceof EventTarget||i instanceof Event)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Fg(i,e,t=new Set){if(i===e&&TI(i))return!0;const n=nc(i,t),s=nc(e,t);for(const o of n)if(s.has(o))return!0;return!1}function TI(i){return typeof i=="object"&&i!==null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $g extends Ng{constructor(e,t={}){super(t),this._editor=null,this._lifecyclePromise=null,this._initUsingData=!0,this._editables={},this._throttledSave=os(this._save.bind(this),typeof t.saveInterval=="number"?t.saveInterval:5e3),e&&(this._creator=(n,s)=>e.create(n,s)),this._destructor=n=>n.destroy()}get editor(){return this._editor}get _item(){return this._editor}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(e=>{console.error("An error happened during the editor destroying.",e)}).then(()=>{const e={},t=[],n=this._config.rootsAttributes||{},s={};for(const[r,a]of Object.entries(this._data.roots))a.isLoaded?(e[r]="",s[r]=n[r]||{}):t.push(r);const o={...this._config,extraPlugins:this._config.extraPlugins||[],lazyRoots:t,rootsAttributes:s,_watchdogInitialData:this._data};return delete o.initialData,o.extraPlugins.push(EI),this._initUsingData?this.create(e,o,o.context):Tn(this._elementOrData)?this.create(this._elementOrData,o,o.context):this.create(this._editables,o,o.context)}).then(()=>{this._fire("restart")})}create(e=this._elementOrData,t=this._config,n){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(super._startErrorHandling(),this._elementOrData=e,this._initUsingData=typeof e=="string"||Object.keys(e).length>0&&typeof Object.values(e)[0]=="string",this._config=this._cloneEditorConfiguration(t)||{},this._config.context=n,this._creator(e,this._config))).then(s=>{this._editor=s,s.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=s.model.document.version,this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this.state="ready",this._fire("stateChange")}).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}destroy(){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy())).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.cancel();const e=this._editor;return this._editor=null,e.model.document.off("change:data",this._throttledSave),this._destructor(e)})}_save(){const e=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=e}catch(t){console.error(t,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(e){this._excludedProps=e}_getData(){const e=this._editor,t=e.model.document.roots.filter(a=>a.isAttached()&&a.rootName!="$graveyard"),{plugins:n}=e,s=n.has("CommentsRepository")&&n.get("CommentsRepository"),o=n.has("TrackChanges")&&n.get("TrackChanges"),r={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};t.forEach(a=>{r.roots[a.rootName]={content:JSON.stringify(Array.from(a.getChildren())),attributes:JSON.stringify(Array.from(a.getAttributes())),isLoaded:a._isLoaded}});for(const a of e.model.markers)a._affectsData&&(r.markers[a.name]={rangeJSON:a.getRange().toJSON(),usingOperation:a._managedUsingOperations,affectsData:a._affectsData});return s&&(r.commentThreads=JSON.stringify(s.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),o&&(r.suggestions=JSON.stringify(o.getSuggestions({toJSON:!0,skipNotAttached:!0}))),r}_getEditables(){const e={};for(const t of this.editor.model.document.getRootNames()){const n=this.editor.ui.getEditableElement(t);n&&(e[t]=n)}return e}_isErrorComingFromThisItem(e){return Fg(this._editor,e.context,this._excludedProps)}_cloneEditorConfiguration(e){return za(e,(t,n)=>{if(Tn(t)||n==="context")return t})}}class EI{constructor(e){this.editor=e,this._data=e.config.get("_watchdogInitialData")}init(){this.editor.data.on("init",e=>{e.stop(),this.editor.model.enqueueChange({isUndoable:!1},t=>{this._restoreCollaborationData(),this._restoreEditorData(t)}),this.editor.data.fire("ready")},{priority:999})}_createNode(e,t){if("name"in t){const n=e.createElement(t.name,t.attributes);if(t.children)for(const s of t.children)n._appendChild(this._createNode(e,s));return n}else return e.createText(t.data,t.attributes)}_restoreEditorData(e){const t=this.editor;Object.entries(this._data.roots).forEach(([n,{content:s,attributes:o}])=>{const r=JSON.parse(s),a=JSON.parse(o),l=t.model.document.getRoot(n);for(const[c,u]of a)e.setAttribute(c,u,l);for(const c of r){const u=this._createNode(e,c);e.insert(u,l,"end")}}),Object.entries(this._data.markers).forEach(([n,s])=>{const{document:o}=t.model,{rangeJSON:{start:r,end:a},...l}=s,c=o.getRoot(r.root),u=e.createPositionFromPath(c,r.path,r.stickiness),d=e.createPositionFromPath(c,a.path,a.stickiness),h=e.createRange(u,d);e.addMarker(n,{range:h,...l})})}_restoreCollaborationData(){const e=JSON.parse(this._data.commentThreads),t=JSON.parse(this._data.suggestions);e.forEach(n=>{const s=this.editor.config.get("collaboration.channelId"),o=this.editor.plugins.get("CommentsRepository");o.hasCommentThread(n.threadId)&&o.getCommentThread(n.threadId).remove(),o.addCommentThread({channelId:s,...n})}),t.forEach(n=>{const s=this.editor.plugins.get("TrackChangesEditing");if(s.hasSuggestion(n.id)){const o=s.getSuggestion(n.id);o.attributes=n.attributes}else s.addSuggestionData(n)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Us=Symbol("MainQueueId");class AI extends Ng{constructor(e,t={}){super(t),this._watchdogs=new Map,this._context=null,this._contextProps=new Set,this._actionQueues=new xI,this._watchdogConfig=t,this._creator=n=>e.create(n),this._destructor=n=>n.destroy(),this._actionQueues.onEmpty(()=>{this.state==="initializing"&&(this.state="ready",this._fire("stateChange"))})}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}get context(){return this._context}create(e={}){return this._actionQueues.enqueue(Us,()=>(this._contextConfig=e,this._create()))}getItem(e){return this._getWatchdog(e)._item}getItemState(e){return this._getWatchdog(e).state}add(e){const t=Ug(e);return Promise.all(t.map(n=>this._actionQueues.enqueue(n.id,()=>{if(this.state==="destroyed")throw new Error("Cannot add items to destroyed watchdog.");if(!this._context)throw new Error("Context was not created yet. You should call the `ContextWatchdog#create()` method first.");let s;if(this._watchdogs.has(n.id))throw new Error(`Item with the given id is already added: '${n.id}'.`);if(n.type==="editor")return s=new $g(null,this._watchdogConfig),s.setCreator(n.creator),s._setExcludedProperties(this._contextProps),n.destructor&&s.setDestructor(n.destructor),this._watchdogs.set(n.id,s),s.on("error",(o,{error:r,causesRestart:a})=>{this._fire("itemError",{itemId:n.id,error:r}),a&&this._actionQueues.enqueue(n.id,()=>new Promise(l=>{const c=()=>{s.off("restart",c),this._fire("itemRestart",{itemId:n.id}),l()};s.on("restart",c)}))}),s.create(n.sourceElementOrData,n.config,this._context);throw new Error(`Not supported item type: '${n.type}'.`)})))}remove(e){const t=Ug(e);return Promise.all(t.map(n=>this._actionQueues.enqueue(n,()=>{const s=this._getWatchdog(n);return this._watchdogs.delete(n),s.destroy()})))}destroy(){return this._actionQueues.enqueue(Us,()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))}_restart(){return this._actionQueues.enqueue(Us,()=>(this.state="initializing",this._fire("stateChange"),this._destroy().catch(e=>{console.error("An error happened during destroying the context or items.",e)}).then(()=>this._create()).then(()=>this._fire("restart"))))}_create(){return Promise.resolve().then(()=>(this._startErrorHandling(),this._creator(this._contextConfig))).then(e=>(this._context=e,this._contextProps=nc(this._context),Promise.all(Array.from(this._watchdogs.values()).map(t=>(t._setExcludedProperties(this._contextProps),t.create(void 0,void 0,this._context))))))}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling();const e=this._context;return this._context=null,this._contextProps=new Set,Promise.all(Array.from(this._watchdogs.values()).map(t=>t.destroy())).then(()=>this._destructor(e))})}_getWatchdog(e){const t=this._watchdogs.get(e);if(!t)throw new Error(`Item with the given id was not registered: ${e}.`);return t}_isErrorComingFromThisItem(e){for(const t of this._watchdogs.values())if(t._isErrorComingFromThisItem(e))return!1;return Fg(this._context,e.context)}}class xI{constructor(){this._onEmptyCallbacks=[],this._queues=new Map,this._activeActions=0}onEmpty(e){this._onEmptyCallbacks.push(e)}enqueue(e,t){const n=e===Us;this._activeActions++,this._queues.get(e)||this._queues.set(e,Promise.resolve());const o=(n?Promise.all(this._queues.values()):Promise.all([this._queues.get(Us),this._queues.get(e)])).then(t),r=o.catch(()=>{});return this._queues.set(e,r),o.finally(()=>{this._activeActions--,this._queues.get(e)===r&&this._activeActions===0&&this._onEmptyCallbacks.forEach(a=>a())})}}function Ug(i){return Array.isArray(i)?i:[i]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class yr extends Ml(UA){constructor(e,t={}){if(!Cr(e)&&t.initialData!==void 0)throw new p("editor-create-initial-data",null);super(t),this.config.define("menuBar.isVisible",!1),this.config.get("initialData")===void 0&&this.config.set("initialData",SI(e)),Cr(e)&&(this.sourceElement=e),this.model.document.createRoot();const n=!this.config.get("toolbar.shouldNotGroupWhenFull"),s=this.config.get("menuBar"),o=new CI(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:n,useMenuBar:s.isVisible});this.ui=new yI(this,o),zA(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,t={}){return new Promise(n=>{const s=new this(e,t);n(s.initPlugins().then(()=>s.ui.init(Cr(e)?e:null)).then(()=>s.data.init(s.config.get("initialData"))).then(()=>s.fire("ready")).then(()=>s))})}}yr.Context=Mh,yr.EditorWatchdog=$g,yr.ContextWatchdog=AI;function SI(i){return Cr(i)?t5(i):i}function Cr(i){return Tn(i)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class zs extends cn{constructor(e){super(e),this.domEventType=["paste","copy","cut","drop","dragover","dragstart","dragend","dragenter","dragleave"];const t=this.document;this.listenTo(t,"paste",n("clipboardInput"),{priority:"low"}),this.listenTo(t,"drop",n("clipboardInput"),{priority:"low"}),this.listenTo(t,"dragover",n("dragging"),{priority:"low"});function n(s){return(o,r)=>{r.preventDefault();const a=r.dropRange?[r.dropRange]:null,l=new Ht(t,s);t.fire(l,{dataTransfer:r.dataTransfer,method:o.name,targetRanges:a,target:r.target,domEvent:r.domEvent}),l.stop.called&&r.stopPropagation()}}}onDomEvent(e){const t="clipboardData"in e?e.clipboardData:e.dataTransfer,n=e.type=="drop"||e.type=="paste",s={dataTransfer:new sf(t,{cacheFiles:n})};(e.type=="drop"||e.type=="dragover")&&(s.dropRange=II(this.view,e)),this.fire(e.type,e,s)}}function II(i,e){const t=e.target.ownerDocument,n=e.clientX,s=e.clientY;let o;return t.caretRangeFromPoint&&t.caretRangeFromPoint(n,s)?o=t.caretRangeFromPoint(n,s):e.rangeParent&&(o=t.createRange(),o.setStart(e.rangeParent,e.rangeOffset),o.collapse(!0)),o?i.domConverter.domRangeToView(o):null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function PI(i){return i=i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;"),(i.includes("</p><p>")||i.includes("<br>"))&&(i=`<p>${i}</p>`),i}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function RI(i){return i.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(e,t)=>t.length==1?" ":t).replace(/<!--[\s\S]*?-->/g,"")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const zg=["figcaption","li"],Hg=["ol","ul"];function Wg(i){if(i.is("$text")||i.is("$textProxy"))return i.data;if(i.is("element","img")&&i.hasAttribute("alt"))return i.getAttribute("alt");if(i.is("element","br"))return`
`;let e="",t=null;for(const n of i.getChildren())e+=MI(n,t)+Wg(n),t=n;return e}function MI(i,e){return e?i.is("element","li")&&!i.isEmpty&&i.getChild(0).is("containerElement")||Hg.includes(i.name)&&Hg.includes(e.name)?`

`:!i.is("containerElement")&&!e.is("containerElement")?"":zg.includes(i.name)||zg.includes(e.name)?`
`:`

`:""}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Hs extends y{constructor(){super(...arguments),this._markersToCopy=new Map}static get pluginName(){return"ClipboardMarkersUtils"}_registerMarkerToCopy(e,t){this._markersToCopy.set(e,t)}_copySelectedFragmentWithMarkers(e,t,n=s=>s.model.getSelectedContent(s.model.document.selection)){return this.editor.model.change(s=>{const o=s.model.document.selection;s.setSelection(t);const r=this._insertFakeMarkersIntoSelection(s,s.model.document.selection,e),a=n(s),l=this._removeFakeMarkersInsideElement(s,a);for(const[c,u]of Object.entries(r)){l[c]||(l[c]=s.createRangeIn(a));for(const d of u)s.remove(d)}a.markers.clear();for(const[c,u]of Object.entries(l))a.markers.set(c,u);return s.setSelection(o),a})}_pasteMarkersIntoTransformedElement(e,t){const n=this._getPasteMarkersFromRangeMap(e);return this.editor.model.change(s=>{const o=this._insertFakeMarkersElements(s,n),r=t(s),a=this._removeFakeMarkersInsideElement(s,r);for(const l of Object.values(o).flat())s.remove(l);for(const[l,c]of Object.entries(a))s.model.markers.has(l)||s.addMarker(l,{usingOperation:!0,affectsData:!0,range:c});return r})}_pasteFragmentWithMarkers(e){const t=this._getPasteMarkersFromRangeMap(e.markers);e.markers.clear();for(const n of t)e.markers.set(n.name,n.range);return this.editor.model.insertContent(e)}_forceMarkersCopy(e,t,n={allowedActions:"all",copyPartiallySelected:!0,duplicateOnPaste:!0}){const s=this._markersToCopy.get(e);this._markersToCopy.set(e,n),t(),s?this._markersToCopy.set(e,s):this._markersToCopy.delete(e)}_isMarkerCopyable(e,t){const n=this._getMarkerClipboardConfig(e);if(!n)return!1;if(!t)return!0;const{allowedActions:s}=n;return s==="all"||s.includes(t)}_hasMarkerConfiguration(e){return!!this._getMarkerClipboardConfig(e)}_getMarkerClipboardConfig(e){const[t]=e.split(":");return this._markersToCopy.get(t)||null}_insertFakeMarkersIntoSelection(e,t,n){const s=this._getCopyableMarkersFromSelection(e,t,n);return this._insertFakeMarkersElements(e,s)}_getCopyableMarkersFromSelection(e,t,n){const s=Array.from(t.getRanges()),o=new Set(s.flatMap(a=>Array.from(e.model.markers.getMarkersIntersectingRange(a)))),r=a=>{if(!this._isMarkerCopyable(a.name,n))return!1;const{copyPartiallySelected:c}=this._getMarkerClipboardConfig(a.name);if(!c){const u=a.getRange();return s.some(d=>d.containsRange(u,!0))}return!0};return Array.from(o).filter(r).map(a=>({name:n==="dragstart"?this._getUniqueMarkerName(a.name):a.name,range:a.getRange()}))}_getPasteMarkersFromRangeMap(e,t=null){const{model:n}=this.editor;return(e instanceof Map?Array.from(e.entries()):Object.entries(e)).flatMap(([o,r])=>{if(!this._hasMarkerConfiguration(o))return[{name:o,range:r}];if(this._isMarkerCopyable(o,t)){const a=this._getMarkerClipboardConfig(o),l=n.markers.has(o)&&n.markers.get(o).getRange().root.rootName==="$graveyard";return(a.duplicateOnPaste||l)&&(o=this._getUniqueMarkerName(o)),[{name:o,range:r}]}return[]})}_insertFakeMarkersElements(e,t){const n={},s=t.flatMap(o=>{const{start:r,end:a}=o.range;return[{position:r,marker:o,type:"start"},{position:a,marker:o,type:"end"}]}).sort(({position:o},{position:r})=>o.isBefore(r)?1:-1);for(const{position:o,marker:r,type:a}of s){const l=e.createElement("$marker",{"data-name":r.name,"data-type":a});n[r.name]||(n[r.name]=[]),n[r.name].push(l),e.insert(l,o)}return n}_removeFakeMarkersInsideElement(e,t){const s=this._getAllFakeMarkersFromElement(e,t).reduce((o,r)=>{const a=r.markerElement&&e.createPositionBefore(r.markerElement);let l=o[r.name],c=!1;return l&&l.start&&l.end&&(this._getMarkerClipboardConfig(r.name).duplicateOnPaste?o[this._getUniqueMarkerName(r.name)]=o[r.name]:c=!0,l=null),c||(o[r.name]={...l,[r.type]:a}),r.markerElement&&e.remove(r.markerElement),o},{});return Vk(s,o=>new v(o.start||e.createPositionFromPath(t,[0]),o.end||e.createPositionAt(t,"end")))}_getAllFakeMarkersFromElement(e,t){const n=Array.from(e.createRangeIn(t)).flatMap(({item:r})=>{if(!r.is("element","$marker"))return[];const a=r.getAttribute("data-name"),l=r.getAttribute("data-type");return[{markerElement:r,name:a,type:l}]}),s=[],o=[];for(const r of n)r.type==="end"&&(n.some(l=>l.name===r.name&&l.type==="start")||s.push({markerElement:null,name:r.name,type:"start"})),r.type==="start"&&(n.some(l=>l.name===r.name&&l.type==="end")||o.unshift({markerElement:null,name:r.name,type:"end"}));return[...s,...n,...o]}_getUniqueMarkerName(e){const t=e.split(":"),n=it().substring(1,6);return t.length===3?`${t.slice(0,2).join(":")}:${n}`:`${t.join(":")}:${n}`}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Vt extends y{static get pluginName(){return"ClipboardPipeline"}static get requires(){return[Hs]}init(){this.editor.editing.view.addObserver(zs),this._setupPasteDrop(),this._setupCopyCut()}_fireOutputTransformationEvent(e,t,n){const s=this.editor.plugins.get("ClipboardMarkersUtils");this.editor.model.enqueueChange({isUndoable:n==="cut"},()=>{const o=s._copySelectedFragmentWithMarkers(n,t);this.fire("outputTransformation",{dataTransfer:e,content:o,method:n})})}_setupPasteDrop(){const e=this.editor,t=e.model,n=e.editing.view,s=n.document,o=this.editor.plugins.get("ClipboardMarkersUtils");this.listenTo(s,"clipboardInput",(r,a)=>{a.method=="paste"&&!e.model.canEditAt(e.model.document.selection)&&r.stop()},{priority:"highest"}),this.listenTo(s,"clipboardInput",(r,a)=>{const l=a.dataTransfer;let c;if(a.content)c=a.content;else{let d="";l.getData("text/html")?d=RI(l.getData("text/html")):l.getData("text/plain")&&(d=PI(l.getData("text/plain"))),c=this.editor.data.htmlProcessor.toView(d)}const u=new Ht(this,"inputTransformation");this.fire(u,{content:c,dataTransfer:l,targetRanges:a.targetRanges,method:a.method}),u.stop.called&&r.stop(),n.scrollToTheSelection()},{priority:"low"}),this.listenTo(this,"inputTransformation",(r,a)=>{if(a.content.isEmpty)return;const c=this.editor.data.toModel(a.content,"$clipboardHolder");c.childCount!=0&&(r.stop(),t.change(()=>{this.fire("contentInsertion",{content:c,method:a.method,dataTransfer:a.dataTransfer,targetRanges:a.targetRanges})}))},{priority:"low"}),this.listenTo(this,"contentInsertion",(r,a)=>{a.resultRange=o._pasteFragmentWithMarkers(a.content)},{priority:"low"})}_setupCopyCut(){const e=this.editor,t=e.model.document,s=e.editing.view.document,o=(r,a)=>{const l=a.dataTransfer;a.preventDefault(),this._fireOutputTransformationEvent(l,t.selection,r.name)};this.listenTo(s,"copy",o,{priority:"low"}),this.listenTo(s,"cut",(r,a)=>{e.model.canEditAt(e.model.document.selection)?o(r,a):a.preventDefault()},{priority:"low"}),this.listenTo(this,"outputTransformation",(r,a)=>{const l=e.data.toView(a.content);s.fire("clipboardOutput",{dataTransfer:a.dataTransfer,content:l,method:a.method})},{priority:"low"}),this.listenTo(s,"clipboardOutput",(r,a)=>{a.content.isEmpty||(a.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(a.content)),a.dataTransfer.setData("text/plain",Wg(a.content))),a.method=="cut"&&e.model.deleteContent(t.selection)},{priority:"low"})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class BI extends ee(){constructor(){super(...arguments),this._stack=[]}add(e,t){const n=this._stack,s=n[0];this._insertDescriptor(e);const o=n[0];s!==o&&!ic(s,o)&&this.fire("change:top",{oldDescriptor:s,newDescriptor:o,writer:t})}remove(e,t){const n=this._stack,s=n[0];this._removeDescriptor(e);const o=n[0];s!==o&&!ic(s,o)&&this.fire("change:top",{oldDescriptor:s,newDescriptor:o,writer:t})}_insertDescriptor(e){const t=this._stack,n=t.findIndex(o=>o.id===e.id);if(ic(e,t[n]))return;n>-1&&t.splice(n,1);let s=0;for(;t[s]&&OI(t[s],e);)s++;t.splice(s,0,e)}_removeDescriptor(e){const t=this._stack,n=t.findIndex(s=>s.id===e);n>-1&&t.splice(n,1)}}function ic(i,e){return i&&e&&i.priority==e.priority&&kr(i.classes)==kr(e.classes)}function OI(i,e){return i.priority>e.priority?!0:i.priority<e.priority?!1:kr(i.classes)>kr(e.classes)}function kr(i){return Array.isArray(i)?i.sort().join(","):i}const LI='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const VI="ck-widget",jg="ck-widget_selected";function me(i){return i.is("element")?!!i.getCustomProperty("widget"):!1}function Ws(i,e,t={}){if(!i.is("containerElement"))throw new p("widget-to-widget-wrong-element-type",null,{element:i});return e.setAttribute("contenteditable","false",i),e.addClass(VI,i),e.setCustomProperty("widget",!0,i),i.getFillerOffset=zI,e.setCustomProperty("widgetLabel",[],i),t.label&&FI(i,t.label),t.hasSelectionHandle&&HI(i,e),qg(i,e),i}function DI(i,e,t){if(e.classes&&t.addClass(J(e.classes),i),e.attributes)for(const n in e.attributes)t.setAttribute(n,e.attributes[n],i)}function NI(i,e,t){if(e.classes&&t.removeClass(J(e.classes),i),e.attributes)for(const n in e.attributes)t.removeAttribute(n,i)}function qg(i,e,t=DI,n=NI){const s=new BI;s.on("change:top",(a,l)=>{l.oldDescriptor&&n(i,l.oldDescriptor,l.writer),l.newDescriptor&&t(i,l.newDescriptor,l.writer)});const o=(a,l,c)=>s.add(l,c),r=(a,l,c)=>s.remove(l,c);e.setCustomProperty("addHighlight",o,i),e.setCustomProperty("removeHighlight",r,i)}function FI(i,e){i.getCustomProperty("widgetLabel").push(e)}function $I(i){return i.getCustomProperty("widgetLabel").reduce((t,n)=>typeof n=="function"?t?t+". "+n():n():t?t+". "+n:n,"")}function sc(i,e,t={}){return e.addClass(["ck-editor__editable","ck-editor__nested-editable"],i),e.setAttribute("role","textbox",i),e.setAttribute("tabindex","-1",i),t.label&&e.setAttribute("aria-label",t.label,i),e.setAttribute("contenteditable",i.isReadOnly?"false":"true",i),i.on("change:isReadOnly",(n,s,o)=>{e.setAttribute("contenteditable",o?"false":"true",i)}),i.on("change:isFocused",(n,s,o)=>{o?e.addClass("ck-editor__nested-editable_focused",i):e.removeClass("ck-editor__nested-editable_focused",i)}),qg(i,e),i}function UI(i,e){const t=i.getSelectedElement();if(t){const n=fn(i);if(n)return e.createRange(e.createPositionAt(t,n))}return e.schema.findOptimalInsertionRange(i)}function zI(){return null}function HI(i,e){const t=e.createUIElement("div",{class:"ck ck-widget__selection-handle"},function(n){const s=this.toDomElement(n),o=new Mt;return o.set("content",LI),o.render(),s.appendChild(o.element),s});e.insert(e.createPositionAt(i,0),t),e.addClass(["ck-widget_with-selection-handle"],i)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Qt="widget-type-around";function $n(i,e,t){return!!i&&me(i)&&!t.isInline(e)}function WI(i){return i.closest(".ck-widget__type-around__button")}function jI(i){return i.classList.contains("ck-widget__type-around__button_before")?"before":"after"}function qI(i,e){const t=i.closest(".ck-widget");return e.mapDomToView(t)}function fn(i){return i.getAttribute(Qt)}const GI='<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Gg=["before","after"],KI=new DOMParser().parseFromString(GI,"image/svg+xml").firstChild,Kg="ck-widget__type-around_disabled";class ZI extends y{constructor(){super(...arguments),this._currentFakeCaretModelElement=null}static get pluginName(){return"WidgetTypeAround"}static get requires(){return[$s,Ln]}init(){const e=this.editor,t=e.editing.view;this.on("change:isEnabled",(n,s,o)=>{t.change(r=>{for(const a of t.document.roots)o?r.removeClass(Kg,a):r.addClass(Kg,a)}),o||e.model.change(r=>{r.removeSelectionAttribute(Qt)})}),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableInsertObjectIntegration(),this._enableDeleteContentIntegration()}destroy(){super.destroy(),this._currentFakeCaretModelElement=null}_insertParagraph(e,t){const n=this.editor,s=n.editing.view,o=n.model.schema.getAttributesWithProperty(e,"copyOnReplace",!0);n.execute("insertParagraph",{position:n.model.createPositionAt(e,t),attributes:o}),s.focus(),s.scrollToTheSelection()}_listenToIfEnabled(e,t,n,s){this.listenTo(e,t,(...o)=>{this.isEnabled&&n(...o)},s)}_insertParagraphAccordingToFakeCaretPosition(){const n=this.editor.model.document.selection,s=fn(n);if(!s)return!1;const o=n.getSelectedElement();return this._insertParagraph(o,s),!0}_enableTypeAroundUIInjection(){const e=this.editor,t=e.model.schema,n=e.locale.t,s={before:n("Insert paragraph before block"),after:n("Insert paragraph after block")};e.editing.downcastDispatcher.on("insert",(o,r,a)=>{const l=a.mapper.toViewElement(r.item);l&&$n(l,r.item,t)&&(JI(a.writer,s,l),l.getCustomProperty("widgetLabel").push(()=>this.isEnabled?n("Press Enter to type after or press Shift + Enter to type before the widget"):""))},{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const e=this.editor,t=e.model,n=t.document.selection,s=t.schema,o=e.editing.view;this._listenToIfEnabled(o.document,"arrowKey",(a,l)=>{this._handleArrowKeyPress(a,l)},{context:[me,"$text"],priority:"high"}),this._listenToIfEnabled(n,"change:range",(a,l)=>{l.directChange&&e.model.change(c=>{c.removeSelectionAttribute(Qt)})}),this._listenToIfEnabled(t.document,"change:data",()=>{const a=n.getSelectedElement();if(a){const l=e.editing.mapper.toViewElement(a);if($n(l,a,s))return}e.model.change(l=>{l.removeSelectionAttribute(Qt)})}),this._listenToIfEnabled(e.editing.downcastDispatcher,"selection",(a,l,c)=>{const u=c.writer;if(this._currentFakeCaretModelElement){const m=c.mapper.toViewElement(this._currentFakeCaretModelElement);m&&(u.removeClass(Gg.map(r),m),this._currentFakeCaretModelElement=null)}const d=l.selection.getSelectedElement();if(!d)return;const h=c.mapper.toViewElement(d);if(!$n(h,d,s))return;const f=fn(l.selection);f&&(u.addClass(r(f),h),this._currentFakeCaretModelElement=d)}),this._listenToIfEnabled(e.ui.focusTracker,"change:isFocused",(a,l,c)=>{c||e.model.change(u=>{u.removeSelectionAttribute(Qt)})});function r(a){return`ck-widget_type-around_show-fake-caret_${a}`}}_handleArrowKeyPress(e,t){const n=this.editor,s=n.model,o=s.document.selection,r=s.schema,a=n.editing.view,l=t.keyCode,c=g5(l,n.locale.contentLanguageDirection),u=a.document.selection.getSelectedElement(),d=n.editing.mapper.toModelElement(u);let h;$n(u,d,r)?h=this._handleArrowKeyPressOnSelectedWidget(c):o.isCollapsed?h=this._handleArrowKeyPressWhenSelectionNextToAWidget(c):t.shiftKey||(h=this._handleArrowKeyPressWhenNonCollapsedSelection(c)),h&&(t.preventDefault(),e.stop())}_handleArrowKeyPressOnSelectedWidget(e){const n=this.editor.model,s=n.document.selection,o=fn(s);return n.change(r=>{if(o){if(!(o===(e?"after":"before")))return r.removeSelectionAttribute(Qt),!0}else return r.setSelectionAttribute(Qt,e?"after":"before"),!0;return!1})}_handleArrowKeyPressWhenSelectionNextToAWidget(e){const t=this.editor,n=t.model,s=n.schema,o=t.plugins.get("Widget"),r=o._getObjectElementNextToSelection(e),a=t.editing.mapper.toViewElement(r);return $n(a,r,s)?(n.change(l=>{o._setSelectionOverElement(r),l.setSelectionAttribute(Qt,e?"before":"after")}),!0):!1}_handleArrowKeyPressWhenNonCollapsedSelection(e){const t=this.editor,n=t.model,s=n.schema,o=t.editing.mapper,r=n.document.selection,a=e?r.getLastPosition().nodeBefore:r.getFirstPosition().nodeAfter,l=o.toViewElement(a);return $n(l,a,s)?(n.change(c=>{c.setSelection(a,"on"),c.setSelectionAttribute(Qt,e?"after":"before")}),!0):!1}_enableInsertingParagraphsOnButtonClick(){const e=this.editor,t=e.editing.view;this._listenToIfEnabled(t.document,"mousedown",(n,s)=>{const o=WI(s.domTarget);if(!o)return;const r=jI(o),a=qI(o,t.domConverter),l=e.editing.mapper.toModelElement(a);this._insertParagraph(l,r),s.preventDefault(),n.stop()})}_enableInsertingParagraphsOnEnterKeypress(){const e=this.editor,t=e.model.document.selection,n=e.editing.view;this._listenToIfEnabled(n.document,"enter",(s,o)=>{if(s.eventPhase!="atTarget")return;const r=t.getSelectedElement(),a=e.editing.mapper.toViewElement(r),l=e.model.schema;let c;this._insertParagraphAccordingToFakeCaretPosition()?c=!0:$n(a,r,l)&&(this._insertParagraph(r,o.isSoft?"before":"after"),c=!0),c&&(o.preventDefault(),s.stop())},{context:me})}_enableInsertingParagraphsOnTypingKeystroke(){const t=this.editor.editing.view.document;this._listenToIfEnabled(t,"insertText",(n,s)=>{this._insertParagraphAccordingToFakeCaretPosition()&&(s.selection=t.selection)},{priority:"high"}),$.isAndroid?this._listenToIfEnabled(t,"keydown",(n,s)=>{s.keyCode==229&&this._insertParagraphAccordingToFakeCaretPosition()}):this._listenToIfEnabled(t,"compositionstart",()=>{this._insertParagraphAccordingToFakeCaretPosition()},{priority:"high"})}_enableDeleteIntegration(){const e=this.editor,t=e.editing.view,n=e.model,s=n.schema;this._listenToIfEnabled(t.document,"delete",(o,r)=>{if(o.eventPhase!="atTarget")return;const a=fn(n.document.selection);if(!a)return;const l=r.direction,c=n.document.selection.getSelectedElement(),u=a==="before",d=l=="forward";if(u===d)e.execute("delete",{selection:n.createSelection(c,"on")});else{const f=s.getNearestSelectionRange(n.createPositionAt(c,a),l);if(f)if(!f.isCollapsed)n.change(m=>{m.setSelection(f),e.execute(d?"deleteForward":"delete")});else{const m=n.createSelection(f.start);if(n.modifySelection(m,{direction:l}),!m.focus.isEqual(f.start))n.change(g=>{g.setSelection(f),e.execute(d?"deleteForward":"delete")});else{const g=QI(s,f.start.parent);n.deleteContent(n.createSelection(g,"on"),{doNotAutoparagraph:!0})}}}r.preventDefault(),o.stop()},{context:me})}_enableInsertContentIntegration(){const e=this.editor,t=this.editor.model,n=t.document.selection;this._listenToIfEnabled(e.model,"insertContent",(s,[o,r])=>{if(r&&!r.is("documentSelection"))return;const a=fn(n);if(a)return s.stop(),t.change(l=>{const c=n.getSelectedElement(),u=t.createPositionAt(c,a),d=l.createSelection(u),h=t.insertContent(o,d);return l.setSelection(d),h})},{priority:"high"})}_enableInsertObjectIntegration(){const e=this.editor,n=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"insertObject",(s,o)=>{const[,r,a={}]=o;if(r&&!r.is("documentSelection"))return;const l=fn(n);l&&(a.findOptimalPosition=l,o[3]=a)},{priority:"high"})}_enableDeleteContentIntegration(){const e=this.editor,n=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"deleteContent",(s,[o])=>{if(o&&!o.is("documentSelection"))return;fn(n)&&s.stop()},{priority:"high"})}}function JI(i,e,t){const n=i.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},function(s){const o=this.toDomElement(s);return YI(o,e),XI(o),o});i.insert(i.createPositionAt(t,"end"),n)}function YI(i,e){for(const t of Gg){const n=new Ue({tag:"div",attributes:{class:["ck","ck-widget__type-around__button",`ck-widget__type-around__button_${t}`],title:e[t],"aria-hidden":"true"},children:[i.ownerDocument.importNode(KI,!0)]});i.appendChild(n.render())}}function XI(i){const e=new Ue({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});i.appendChild(e.render())}function QI(i,e){let t=e;for(const n of e.getAncestors({parentFirst:!0})){if(n.childCount>1||i.isLimit(n))break;t=n}return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function e6(i){const e=i.model;return(t,n)=>{const s=n.keyCode==U.arrowup,o=n.keyCode==U.arrowdown,r=n.shiftKey,a=e.document.selection;if(!s&&!o)return;const l=o;if(r&&i6(a,l))return;const c=t6(i,a,l);if(c){if(c.isCollapsed){if(a.isCollapsed)return;if(r)return}(c.isCollapsed||n6(i,c,l))&&(e.change(u=>{const d=l?c.end:c.start;if(r){const h=e.createSelection(a.anchor);h.setFocus(d),u.setSelection(h)}else u.setSelection(d)}),t.stop(),n.preventDefault(),n.stopPropagation())}}}function t6(i,e,t){const n=i.model;if(t){const s=e.isCollapsed?e.focus:e.getLastPosition(),o=Zg(n,s,"forward");if(!o)return null;const r=n.createRange(s,o),a=Jg(n.schema,r,"backward");return a?n.createRange(s,a):null}else{const s=e.isCollapsed?e.focus:e.getFirstPosition(),o=Zg(n,s,"backward");if(!o)return null;const r=n.createRange(o,s),a=Jg(n.schema,r,"forward");return a?n.createRange(a,s):null}}function Zg(i,e,t){const n=i.schema,s=i.createRangeIn(e.root),o=t=="forward"?"elementStart":"elementEnd";for(const{previousPosition:r,item:a,type:l}of s.getWalker({startPosition:e,direction:t})){if(n.isLimit(a)&&!n.isInline(a))return r;if(l==o&&n.isBlock(a))return null}return null}function Jg(i,e,t){const n=t=="backward"?e.end:e.start;if(i.checkChild(n,"$text"))return n;for(const{nextPosition:s}of e.getWalker({direction:t}))if(i.checkChild(s,"$text"))return s;return null}function n6(i,e,t){const n=i.model,s=i.view.domConverter;if(t){const c=n.createSelection(e.start);n.modifySelection(c),!c.focus.isAtEnd&&!e.start.isEqual(c.focus)&&(e=n.createRange(c.focus,e.end))}const o=i.mapper.toViewRange(e),r=s.viewRangeToDom(o),a=z.getDomRangeRects(r);let l;for(const c of a){if(l===void 0){l=Math.round(c.bottom);continue}if(Math.round(c.top)>=l)return!1;l=Math.max(l,Math.round(c.bottom))}return!0}function i6(i,e){return!i.isCollapsed&&i.isBackward==e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oc extends y{constructor(){super(...arguments),this._previouslySelected=new Set}static get pluginName(){return"Widget"}static get requires(){return[ZI,Ln]}init(){const e=this.editor,t=e.editing.view,n=t.document,s=e.t;this.editor.editing.downcastDispatcher.on("selection",(o,r,a)=>{const l=a.writer,c=r.selection;if(c.isCollapsed)return;const u=c.getSelectedElement();if(!u)return;const d=e.editing.mapper.toViewElement(u);me(d)&&a.consumable.consume(c,"selection")&&l.setSelection(l.createRangeOn(d),{fake:!0,label:$I(d)})}),this.editor.editing.downcastDispatcher.on("selection",(o,r,a)=>{this._clearPreviouslySelectedWidgets(a.writer);const l=a.writer,c=l.document.selection;let u=null;for(const d of c.getRanges())for(const h of d){const f=h.item;me(f)&&!o6(f,u)&&(l.addClass(jg,f),this._previouslySelected.add(f),u=f)}},{priority:"low"}),t.addObserver(xl),this.listenTo(n,"mousedown",(...o)=>this._onMousedown(...o)),this.listenTo(n,"arrowKey",(...o)=>{this._handleSelectionChangeOnArrowKeyPress(...o)},{context:[me,"$text"]}),this.listenTo(n,"arrowKey",(...o)=>{this._preventDefaultOnArrowKeyPress(...o)},{context:"$root"}),this.listenTo(n,"arrowKey",e6(this.editor.editing),{context:"$text"}),this.listenTo(n,"delete",(o,r)=>{this._handleDelete(r.direction=="forward")&&(r.preventDefault(),o.stop())},{context:"$root"}),this.listenTo(n,"tab",(o,r)=>{o.eventPhase=="atTarget"&&(r.shiftKey||this._selectFirstNestedEditable()&&(r.preventDefault(),o.stop()))},{context:me,priority:"low"}),this.listenTo(n,"tab",(o,r)=>{r.shiftKey&&this._selectAncestorWidget()&&(r.preventDefault(),o.stop())},{priority:"low"}),this.listenTo(n,"keydown",(o,r)=>{r.keystroke==U.esc&&this._selectAncestorWidget()&&(r.preventDefault(),o.stop())},{priority:"low"}),e.accessibility.addKeystrokeInfoGroup({id:"widget",label:s("Keystrokes that can be used when a widget is selected (for example: image, table, etc.)"),keystrokes:[{label:s("Insert a new paragraph directly after a widget"),keystroke:"Enter"},{label:s("Insert a new paragraph directly before a widget"),keystroke:"Shift+Enter"},{label:s("Move the caret to allow typing directly before a widget"),keystroke:[["arrowup"],["arrowleft"]]},{label:s("Move the caret to allow typing directly after a widget"),keystroke:[["arrowdown"],["arrowright"]]}]})}_onMousedown(e,t){const n=this.editor,s=n.editing.view,o=s.document;let r=t.target;if(t.domEvent.detail>=3){this._selectBlockContent(r)&&t.preventDefault();return}if(s6(r)||!me(r)&&(r=r.findAncestor(me),!r))return;$.isAndroid&&t.preventDefault(),o.isFocused||s.focus();const a=n.editing.mapper.toModelElement(r);this._setSelectionOverElement(a)}_selectBlockContent(e){const t=this.editor,n=t.model,s=t.editing.mapper,o=n.schema,r=s.findMappedViewAncestor(this.editor.editing.view.createPositionAt(e,0)),a=r6(s.toModelElement(r),n.schema);return a?(n.change(l=>{const c=o.isLimit(a)?null:a6(l.createPositionAfter(a),o),u=l.createPositionAt(a,0),d=c?l.createPositionAt(c,0):l.createPositionAt(a,"end");l.setSelection(l.createRange(u,d))}),!0):!1}_handleSelectionChangeOnArrowKeyPress(e,t){const n=t.keyCode,s=this.editor.model,o=s.schema,r=s.document.selection,a=r.getSelectedElement(),l=Qa(n,this.editor.locale.contentLanguageDirection),c=l=="down"||l=="right",u=l=="up"||l=="down";if(a&&o.isObject(a)){const h=c?r.getLastPosition():r.getFirstPosition(),f=o.getNearestSelectionRange(h,c?"forward":"backward");f&&(s.change(m=>{m.setSelection(f)}),t.preventDefault(),e.stop());return}if(!r.isCollapsed&&!t.shiftKey){const h=r.getFirstPosition(),f=r.getLastPosition(),m=h.nodeAfter,g=f.nodeBefore;(m&&o.isObject(m)||g&&o.isObject(g))&&(s.change(b=>{b.setSelection(c?f:h)}),t.preventDefault(),e.stop());return}if(!r.isCollapsed)return;const d=this._getObjectElementNextToSelection(c);if(d&&o.isObject(d)){if(o.isInline(d)&&u)return;this._setSelectionOverElement(d),t.preventDefault(),e.stop()}}_preventDefaultOnArrowKeyPress(e,t){const n=this.editor.model,s=n.schema,o=n.document.selection.getSelectedElement();o&&s.isObject(o)&&(t.preventDefault(),e.stop())}_handleDelete(e){const n=this.editor.model.document.selection;if(!this.editor.model.canEditAt(n)||!n.isCollapsed)return;const s=this._getObjectElementNextToSelection(e);if(s)return this.editor.model.change(o=>{let r=n.anchor.parent;for(;r.isEmpty;){const a=r;r=a.parent,o.remove(a)}this._setSelectionOverElement(s)}),!0}_setSelectionOverElement(e){this.editor.model.change(t=>{t.setSelection(t.createRangeOn(e))})}_getObjectElementNextToSelection(e){const t=this.editor.model,n=t.schema,s=t.document.selection,o=t.createSelection(s);if(t.modifySelection(o,{direction:e?"forward":"backward"}),o.isEqual(s))return null;const r=e?o.focus.nodeBefore:o.focus.nodeAfter;return r&&n.isObject(r)?r:null}_clearPreviouslySelectedWidgets(e){for(const t of this._previouslySelected)e.removeClass(jg,t);this._previouslySelected.clear()}_selectFirstNestedEditable(){const e=this.editor,n=this.editor.editing.view.document;for(const s of n.selection.getFirstRange().getItems())if(s.is("editableElement")){const o=e.editing.mapper.toModelElement(s);/* istanbul ignore next -- @preserve */if(!o)continue;const r=e.model.createPositionAt(o,0),a=e.model.schema.getNearestSelectionRange(r,"forward");return e.model.change(l=>{l.setSelection(a)}),!0}return!1}_selectAncestorWidget(){const e=this.editor,t=e.editing.mapper,s=e.editing.view.document.selection.getFirstPosition().parent,r=(s.is("$text")?s.parent:s).findAncestor(me);if(!r)return!1;const a=t.toModelElement(r);/* istanbul ignore next -- @preserve */return a?(e.model.change(l=>{l.setSelection(a,"on")}),!0):!1}}function s6(i){let e=i;for(;e;){if(e.is("editableElement")&&!e.is("rootElement"))return!0;if(me(e))return!1;e=e.parent}return!1}function o6(i,e){return e?Array.from(i.getAncestors()).includes(e):!1}function r6(i,e){for(const t of i.getAncestors({includeSelf:!0,parentFirst:!0})){if(e.checkChild(t,"$text"))return t;if(e.isLimit(t)&&!e.isObject(t))break}return null}function a6(i,e){const t=new Kt({startPosition:i});for(const{item:n}of t){if(e.isLimit(n)||!n.is("element"))return null;if(e.checkChild(n,"$text"))return n}return null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Tr extends y{constructor(){super(...arguments),this._toolbarDefinitions=new Map}static get requires(){return[Ot]}static get pluginName(){return"WidgetToolbarRepository"}init(){const e=this.editor;if(e.plugins.has("BalloonToolbar")){const t=e.plugins.get("BalloonToolbar");this.listenTo(t,"show",n=>{l6(e.editing.view.document.selection)&&n.stop()},{priority:"high"})}this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui,"update",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui.focusTracker,"change:isFocused",()=>{this._updateToolbarsVisibility()},{priority:"low"})}destroy(){super.destroy();for(const e of this._toolbarDefinitions.values())e.view.destroy()}register(e,{ariaLabel:t,items:n,getRelatedElement:s,balloonClassName:o="ck-toolbar-container"}){if(!n.length){Q("widget-toolbar-no-items",{toolbarId:e});return}const r=this.editor,a=r.t,l=new xi(r.locale);if(l.ariaLabel=t||a("Widget toolbar"),this._toolbarDefinitions.has(e))throw new p("widget-toolbar-duplicated",this,{toolbarId:e});const c={view:l,getRelatedElement:s,balloonClassName:o,itemsConfig:n,initialized:!1};r.ui.addToolbar(l,{isContextual:!0,beforeFocus:()=>{const u=s(r.editing.view.document.selection);u&&this._showToolbar(c,u)},afterBlur:()=>{this._hideToolbar(c)}}),this._toolbarDefinitions.set(e,c)}_updateToolbarsVisibility(){let e=0,t=null,n=null;for(const s of this._toolbarDefinitions.values()){const o=s.getRelatedElement(this.editor.editing.view.document.selection);if(!this.isEnabled||!o)this._isToolbarInBalloon(s)&&this._hideToolbar(s);else if(!this.editor.ui.focusTracker.isFocused)this._isToolbarVisible(s)&&this._hideToolbar(s);else{const r=o.getAncestors().length;r>e&&(e=r,t=o,n=s)}}n&&this._showToolbar(n,t)}_hideToolbar(e){this._balloon.remove(e.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(e,t){this._isToolbarVisible(e)?Yg(this.editor,t):this._isToolbarInBalloon(e)||(e.initialized||(e.initialized=!0,e.view.fillFromConfig(e.itemsConfig,this.editor.ui.componentFactory)),this._balloon.add({view:e.view,position:Xg(this.editor,t),balloonClassName:e.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",()=>{for(const n of this._toolbarDefinitions.values())if(this._isToolbarVisible(n)){const s=n.getRelatedElement(this.editor.editing.view.document.selection);Yg(this.editor,s)}}))}_isToolbarVisible(e){return this._balloon.visibleView===e.view}_isToolbarInBalloon(e){return this._balloon.hasView(e.view)}}function Yg(i,e){const t=i.plugins.get("ContextualBalloon"),n=Xg(i,e);t.updatePosition(n)}function Xg(i,e){const t=i.editing.view,n=Pe.defaultPositions;return{target:t.domConverter.mapViewToDom(e),positions:[n.northArrowSouth,n.northArrowSouthWest,n.northArrowSouthEast,n.southArrowNorth,n.southArrowNorthWest,n.southArrowNorthEast,n.viewportStickyNorth]}}function l6(i){const e=i.getSelectedElement();return!!(e&&me(e))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//* istanbul ignore file -- @preserve */const rc=di("px");class c6 extends R{constructor(){super();const e=this.bindTemplate;this.set({isVisible:!1,left:null,top:null,width:null}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-clipboard-drop-target-line",e.if("isVisible","ck-hidden",t=>!t)],style:{left:e.to("left",t=>rc(t)),top:e.to("top",t=>rc(t)),width:e.to("width",t=>rc(t))}}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Er extends y{constructor(){super(...arguments),this.removeDropMarkerDelayed=el(()=>this.removeDropMarker(),40),this._updateDropMarkerThrottled=os(e=>this._updateDropMarker(e),40),this._reconvertMarkerThrottled=os(()=>{this.editor.model.markers.has("drop-target")&&this.editor.editing.reconvertMarker("drop-target")},0),this._dropTargetLineView=new c6,this._domEmitter=new(qe()),this._scrollables=new Map}static get pluginName(){return"DragDropTarget"}init(){this._setupDropMarker()}destroy(){this._domEmitter.stopListening();for(const{resizeObserver:e}of this._scrollables.values())e.destroy();return this._updateDropMarkerThrottled.cancel(),this.removeDropMarkerDelayed.cancel(),this._reconvertMarkerThrottled.cancel(),super.destroy()}updateDropMarker(e,t,n,s,o,r){this.removeDropMarkerDelayed.cancel();const a=Qg(this.editor,e,t,n,s,o,r);/* istanbul ignore next -- @preserve */if(a){if(r&&r.containsRange(a))return this.removeDropMarker();this._updateDropMarkerThrottled(a)}}getFinalDropRange(e,t,n,s,o,r){const a=Qg(this.editor,e,t,n,s,o,r);return this.removeDropMarker(),a}removeDropMarker(){const e=this.editor.model;this.removeDropMarkerDelayed.cancel(),this._updateDropMarkerThrottled.cancel(),this._dropTargetLineView.isVisible=!1,e.markers.has("drop-target")&&e.change(t=>{t.removeMarker("drop-target")})}_setupDropMarker(){const e=this.editor;e.ui.view.body.add(this._dropTargetLineView),e.conversion.for("editingDowncast").markerToHighlight({model:"drop-target",view:{classes:["ck-clipboard-drop-target-range"]}}),e.conversion.for("editingDowncast").markerToElement({model:"drop-target",view:(t,{writer:n})=>{if(e.model.schema.checkChild(t.markerRange.start,"$text"))return this._dropTargetLineView.isVisible=!1,this._createDropTargetPosition(n);t.markerRange.isCollapsed?this._updateDropTargetLine(t.markerRange):this._dropTargetLineView.isVisible=!1}})}_updateDropMarker(e){const t=this.editor,n=t.model.markers;t.model.change(s=>{n.has("drop-target")?n.get("drop-target").getRange().isEqual(e)||s.updateMarker("drop-target",{range:e}):s.addMarker("drop-target",{range:e,usingOperation:!1,affectsData:!1})})}_createDropTargetPosition(e){return e.createUIElement("span",{class:"ck ck-clipboard-drop-target-position"},function(t){const n=this.toDomElement(t);return n.append("⁠",t.createElement("span"),"⁠"),n})}_updateDropTargetLine(e){const t=this.editor.editing,n=e.start.nodeBefore,s=e.start.nodeAfter,o=e.start.parent,r=n?t.mapper.toViewElement(n):null,a=r?t.view.domConverter.mapViewToDom(r):null,l=s?t.mapper.toViewElement(s):null,c=l?t.view.domConverter.mapViewToDom(l):null,u=t.mapper.toViewElement(o);if(!u)return;const d=t.view.domConverter.mapViewToDom(u),h=this._getScrollableRect(u),{scrollX:f,scrollY:m}=I.window,g=a?new z(a):null,b=c?new z(c):null,_=new z(d).excludeScrollbarsAndBorders(),T=g?g.bottom:_.top,O=b?b.top:_.bottom,B=I.window.getComputedStyle(d),W=T<=O?(T+O)/2:O;if(h.top<W&&W<h.bottom){const S=_.left+parseFloat(B.paddingLeft),V=_.right-parseFloat(B.paddingRight),E=Math.max(S+f,h.left),L=Math.min(V+f,h.right);this._dropTargetLineView.set({isVisible:!0,left:E,top:W+m,width:L-E})}else this._dropTargetLineView.isVisible=!1}_getScrollableRect(e){const t=e.root.rootName;let n;if(this._scrollables.has(t))n=this._scrollables.get(t).domElement;else{const s=this.editor.editing.view.domConverter.mapViewToDom(e);n=d6(s),this._domEmitter.listenTo(n,"scroll",this._reconvertMarkerThrottled,{usePassive:!0});const o=new rs(n,this._reconvertMarkerThrottled);this._scrollables.set(t,{domElement:n,resizeObserver:o})}return new z(n).excludeScrollbarsAndBorders()}}function Qg(i,e,t,n,s,o,r){const a=i.model,l=i.editing.mapper;let u=tp(i,e);for(;u;){if(!o){if(a.schema.checkChild(u,"$text")){if(t){const d=t[0].start,h=l.toModelPosition(d);if(!r||Array.from(r.getItems()).every(m=>a.schema.checkChild(h,m))){if(a.schema.checkChild(h,"$text"))return a.createRange(h);if(d)return Ar(i,tp(i,d.parent),n,s)}}}else if(a.schema.isInline(u))return Ar(i,u,n,s)}if(a.schema.isBlock(u))return Ar(i,u,n,s);if(a.schema.checkChild(u,"$block")){const d=Array.from(u.getChildren()).filter(m=>m.is("element")&&!u6(i,m));let h=0,f=d.length;if(f==0)return a.createRange(a.createPositionAt(u,"end"));for(;h<f-1;){const m=Math.floor((h+f)/2);ep(i,d[m],n,s)=="before"?f=m:h=m}return Ar(i,d[h],n,s)}u=u.parent}return null}function u6(i,e){const t=i.editing.mapper,n=i.editing.view.domConverter,s=t.toViewElement(e);if(!s)return!0;const o=n.mapViewToDom(s);return I.window.getComputedStyle(o).float!="none"}function Ar(i,e,t,n){const s=i.model;return s.createRange(s.createPositionAt(e,ep(i,e,t,n)))}function ep(i,e,t,n){const s=i.editing.mapper,o=i.editing.view.domConverter,r=s.toViewElement(e),a=o.mapViewToDom(r),l=new z(a);return i.model.schema.isInline(e)?t<(l.left+l.right)/2?"before":"after":n<(l.top+l.bottom)/2?"before":"after"}function tp(i,e){const t=i.editing.mapper,n=i.editing.view,s=t.toModelElement(e);if(s)return s;const o=n.createPositionBefore(e),r=t.findMappedViewAncestor(o);return t.toModelElement(r)}function d6(i){let e=i;do{e=e.parentElement;const t=I.window.getComputedStyle(e).overflowY;if(t=="auto"||t=="scroll")break}while(e.tagName!="BODY");return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class h6 extends y{constructor(){super(...arguments),this._isBlockDragging=!1,this._domEmitter=new(qe())}static get pluginName(){return"DragDropBlockToolbar"}init(){const e=this.editor;if(this.listenTo(e,"change:isReadOnly",(t,n,s)=>{s?(this.forceDisabled("readOnlyMode"),this._isBlockDragging=!1):this.clearForceDisabled("readOnlyMode")}),$.isAndroid&&this.forceDisabled("noAndroidSupport"),e.plugins.has("BlockToolbar")){const n=e.plugins.get("BlockToolbar").buttonView.element;this._domEmitter.listenTo(n,"dragstart",(s,o)=>this._handleBlockDragStart(o)),this._domEmitter.listenTo(I.document,"dragover",(s,o)=>this._handleBlockDragging(o)),this._domEmitter.listenTo(I.document,"drop",(s,o)=>this._handleBlockDragging(o)),this._domEmitter.listenTo(I.document,"dragend",()=>this._handleBlockDragEnd(),{useCapture:!0}),this.isEnabled&&n.setAttribute("draggable","true"),this.on("change:isEnabled",(s,o,r)=>{n.setAttribute("draggable",r?"true":"false")})}}destroy(){return this._domEmitter.stopListening(),super.destroy()}_handleBlockDragStart(e){if(!this.isEnabled)return;const t=this.editor.model,n=t.document.selection,s=this.editor.editing.view,o=Array.from(n.getSelectedBlocks()),r=t.createRange(t.createPositionBefore(o[0]),t.createPositionAfter(o[o.length-1]));t.change(a=>a.setSelection(r)),this._isBlockDragging=!0,s.focus(),s.getObserver(zs).onDomEvent(e)}_handleBlockDragging(e){if(!this.isEnabled||!this._isBlockDragging)return;const t=e.clientX+(this.editor.locale.contentLanguageDirection=="ltr"?100:-100),n=e.clientY,s=document.elementFromPoint(t,n),o=this.editor.editing.view;!s||!s.closest(".ck-editor__editable")||o.getObserver(zs).onDomEvent({...e,type:e.type,dataTransfer:e.dataTransfer,target:s,clientX:t,clientY:n,preventDefault:()=>e.preventDefault(),stopPropagation:()=>e.stopPropagation()})}_handleBlockDragEnd(){this._isBlockDragging=!1}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class f6 extends y{constructor(){super(...arguments),this._clearDraggableAttributesDelayed=el(()=>this._clearDraggableAttributes(),40),this._blockMode=!1,this._domEmitter=new(qe())}static get pluginName(){return"DragDrop"}static get requires(){return[Vt,oc,Er,h6]}init(){const e=this.editor,t=e.editing.view;this._draggedRange=null,this._draggingUid="",this._draggableElement=null,t.addObserver(zs),t.addObserver(xl),this._setupDragging(),this._setupContentInsertionIntegration(),this._setupClipboardInputIntegration(),this._setupDraggableAttributeHandling(),this.listenTo(e,"change:isReadOnly",(n,s,o)=>{o?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")}),this.on("change:isEnabled",(n,s,o)=>{o||this._finalizeDragging(!1)}),$.isAndroid&&this.forceDisabled("noAndroidSupport")}destroy(){return this._draggedRange&&(this._draggedRange.detach(),this._draggedRange=null),this._previewContainer&&this._previewContainer.remove(),this._domEmitter.stopListening(),this._clearDraggableAttributesDelayed.cancel(),super.destroy()}_setupDragging(){const e=this.editor,t=e.model,n=e.editing.view,s=n.document,o=e.plugins.get(Er);this.listenTo(s,"dragstart",(r,a)=>{if(a.target&&a.target.is("editableElement")){a.preventDefault();return}if(this._prepareDraggedRange(a.target),!this._draggedRange){a.preventDefault();return}this._draggingUid=it(),a.dataTransfer.effectAllowed=this.isEnabled?"copyMove":"copy",a.dataTransfer.setData("application/ckeditor5-dragging-uid",this._draggingUid);const l=t.createSelection(this._draggedRange.toRange());this.editor.plugins.get("ClipboardPipeline")._fireOutputTransformationEvent(a.dataTransfer,l,"dragstart");const{dataTransfer:u,domTarget:d,domEvent:h}=a,{clientX:f}=h;this._updatePreview({dataTransfer:u,domTarget:d,clientX:f}),a.stopPropagation(),this.isEnabled||(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="")},{priority:"low"}),this.listenTo(s,"dragend",(r,a)=>{this._finalizeDragging(!a.dataTransfer.isCanceled&&a.dataTransfer.dropEffect=="move")},{priority:"low"}),this._domEmitter.listenTo(I.document,"dragend",()=>{this._blockMode=!1},{useCapture:!0}),this.listenTo(s,"dragenter",()=>{this.isEnabled&&n.focus()}),this.listenTo(s,"dragleave",()=>{o.removeDropMarkerDelayed()}),this.listenTo(s,"dragging",(r,a)=>{if(!this.isEnabled){a.dataTransfer.dropEffect="none";return}const{clientX:l,clientY:c}=a.domEvent;o.updateDropMarker(a.target,a.targetRanges,l,c,this._blockMode,this._draggedRange),this._draggedRange||(a.dataTransfer.dropEffect="copy"),$.isGecko||(a.dataTransfer.effectAllowed=="copy"?a.dataTransfer.dropEffect="copy":["all","copyMove"].includes(a.dataTransfer.effectAllowed)&&(a.dataTransfer.dropEffect="move")),r.stop()},{priority:"low"})}_setupClipboardInputIntegration(){const e=this.editor,n=e.editing.view.document,s=e.plugins.get(Er);this.listenTo(n,"clipboardInput",(o,r)=>{if(r.method!="drop")return;const{clientX:a,clientY:l}=r.domEvent,c=s.getFinalDropRange(r.target,r.targetRanges,a,l,this._blockMode,this._draggedRange);if(!c){this._finalizeDragging(!1),o.stop();return}if(this._draggedRange&&this._draggingUid!=r.dataTransfer.getData("application/ckeditor5-dragging-uid")&&(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid=""),np(r.dataTransfer)=="move"&&this._draggedRange&&this._draggedRange.containsRange(c,!0)){this._finalizeDragging(!1),o.stop();return}r.targetRanges=[e.editing.mapper.toViewRange(c)]},{priority:"high"})}_setupContentInsertionIntegration(){const e=this.editor.plugins.get(Vt);e.on("contentInsertion",(t,n)=>{if(!this.isEnabled||n.method!=="drop")return;const s=n.targetRanges.map(o=>this.editor.editing.mapper.toModelRange(o));this.editor.model.change(o=>o.setSelection(s))},{priority:"high"}),e.on("contentInsertion",(t,n)=>{if(!this.isEnabled||n.method!=="drop")return;const s=np(n.dataTransfer)=="move",o=!n.resultRange||!n.resultRange.isCollapsed;this._finalizeDragging(o&&s)},{priority:"lowest"})}_setupDraggableAttributeHandling(){const e=this.editor,t=e.editing.view,n=t.document;this.listenTo(n,"mousedown",(s,o)=>{if($.isAndroid||!o)return;this._clearDraggableAttributesDelayed.cancel();let r=ip(o.target);if($.isBlink&&!e.isReadOnly&&!r&&!n.selection.isCollapsed){const a=n.selection.getSelectedElement();(!a||!me(a))&&(r=n.selection.editableElement)}r&&(t.change(a=>{a.setAttribute("draggable","true",r)}),this._draggableElement=e.editing.mapper.toModelElement(r))}),this.listenTo(n,"mouseup",()=>{$.isAndroid||this._clearDraggableAttributesDelayed()})}_clearDraggableAttributes(){const e=this.editor.editing;e.view.change(t=>{this._draggableElement&&this._draggableElement.root.rootName!="$graveyard"&&t.removeAttribute("draggable",e.mapper.toViewElement(this._draggableElement)),this._draggableElement=null})}_finalizeDragging(e){const t=this.editor,n=t.model;t.plugins.get(Er).removeDropMarker(),this._clearDraggableAttributes(),t.plugins.has("WidgetToolbarRepository")&&t.plugins.get("WidgetToolbarRepository").clearForceDisabled("dragDrop"),this._draggingUid="",this._previewContainer&&(this._previewContainer.remove(),this._previewContainer=void 0),this._draggedRange&&(e&&this.isEnabled&&n.change(o=>{const r=n.createSelection(this._draggedRange);n.deleteContent(r,{doNotAutoparagraph:!0});const a=r.getFirstPosition().parent;a.isEmpty&&!n.schema.checkChild(a,"$text")&&n.schema.checkChild(a,"paragraph")&&o.insertElement("paragraph",a,0)}),this._draggedRange.detach(),this._draggedRange=null)}_prepareDraggedRange(e){const t=this.editor,n=t.model,s=n.document.selection,o=e?ip(e):null;if(o){const c=t.editing.mapper.toModelElement(o);this._draggedRange=rt.fromRange(n.createRangeOn(c)),this._blockMode=n.schema.isBlock(c),t.plugins.has("WidgetToolbarRepository")&&t.plugins.get("WidgetToolbarRepository").forceDisabled("dragDrop");return}if(s.isCollapsed&&!s.getFirstPosition().parent.isEmpty)return;const r=Array.from(s.getSelectedBlocks()),a=s.getFirstRange();if(r.length==0){this._draggedRange=rt.fromRange(a);return}const l=sp(n,r);if(r.length>1)this._draggedRange=rt.fromRange(l),this._blockMode=!0;else if(r.length==1){const c=a.start.isTouching(l.start)&&a.end.isTouching(l.end);this._draggedRange=rt.fromRange(c?l:a),this._blockMode=c}n.change(c=>c.setSelection(this._draggedRange.toRange()))}_updatePreview({dataTransfer:e,domTarget:t,clientX:n}){const s=this.editor.editing.view,o=s.document.selection.editableElement,r=s.domConverter.mapViewToDom(o),a=I.window.getComputedStyle(r);this._previewContainer?this._previewContainer.firstElementChild&&this._previewContainer.removeChild(this._previewContainer.firstElementChild):(this._previewContainer=wt(I.document,"div",{style:"position: fixed; left: -999999px;"}),I.document.body.appendChild(this._previewContainer));const l=new z(r);if(r.contains(t))return;const c=parseFloat(a.paddingLeft),u=wt(I.document,"div");u.className="ck ck-content",u.style.width=a.width,u.style.paddingLeft=`${l.left-n+c}px`,$.isiOS&&(u.style.backgroundColor="white"),u.innerHTML=e.getData("text/html"),e.setDragImage(u,0,0),this._previewContainer.appendChild(u)}}function np(i){return $.isGecko?i.dropEffect:["all","copyMove"].includes(i.effectAllowed)?"move":"copy"}function ip(i){if(i.is("editableElement"))return null;if(i.hasClass("ck-widget__selection-handle"))return i.findAncestor(me);if(me(i))return i;const e=i.findAncestor(t=>me(t)||t.is("editableElement"));return me(e)?e:null}function sp(i,e){const t=e[0],n=e[e.length-1],s=t.getCommonAncestor(n),o=i.createPositionBefore(t),r=i.createPositionAfter(n);if(s&&s.is("element")&&!i.schema.isLimit(s)){const a=i.createRangeOn(s),l=o.isTouching(a.start),c=r.isTouching(a.end);if(l&&c)return sp(i,[s])}return i.createRange(o,r)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class m6 extends y{static get pluginName(){return"PastePlainText"}static get requires(){return[Vt]}init(){const e=this.editor,t=e.model,n=e.editing.view,s=n.document,o=t.document.selection;let r=!1;n.addObserver(zs),this.listenTo(s,"keydown",(a,l)=>{r=l.shiftKey}),e.plugins.get(Vt).on("contentInsertion",(a,l)=>{!r&&!g6(l.content,t.schema)||t.change(c=>{const u=Array.from(o.getAttributes()).filter(([h])=>t.schema.getAttributeProperties(h).isFormatting);o.isCollapsed||t.deleteContent(o,{doNotAutoparagraph:!0}),u.push(...o.getAttributes());const d=c.createRangeIn(l.content);for(const h of d.getItems())h.is("$textProxy")&&c.setAttributes(u,h)})})}}function g6(i,e){if(i.childCount>1)return!1;const t=i.getChild(0);return e.isObject(t)?!1:Array.from(t.getAttributeKeys()).length==0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class p6 extends y{static get pluginName(){return"Clipboard"}static get requires(){return[Hs,Vt,f6,m6]}init(){const e=this.editor,t=this.editor.t;e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Copy selected content"),keystroke:"CTRL+C"},{label:t("Paste content"),keystroke:"CTRL+V"},{label:t("Paste content as plain text"),keystroke:"CTRL+SHIFT+V"}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class b6 extends F{constructor(e){super(e),this.affectsData=!1}execute(){const e=this.editor.model,t=e.document.selection;let n=e.schema.getLimitElement(t);if(t.containsEntireContent(n)||!op(e.schema,n))do if(n=n.parent,!n)return;while(!op(e.schema,n));e.change(s=>{s.setSelection(n,"in")})}}function op(i,e){return i.isLimit(e)&&(i.checkChild(e,"$text")||i.checkChild(e,"paragraph"))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const w6=cs("Ctrl+A");class _6 extends y{static get pluginName(){return"SelectAllEditing"}init(){const e=this.editor,t=e.t,s=e.editing.view.document;e.commands.add("selectAll",new b6(e)),this.listenTo(s,"keydown",(o,r)=>{hi(r)===w6&&(e.execute("selectAll"),r.preventDefault())}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Select all"),keystroke:"CTRL+A"}]})}}const v6='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class y6 extends y{static get pluginName(){return"SelectAllUI"}init(){const e=this.editor;e.ui.componentFactory.add("selectAll",()=>{const t=this._createButton(N);return t.set({tooltip:!0}),t}),e.ui.componentFactory.add("menuBar:selectAll",()=>this._createButton(Ae))}_createButton(e){const t=this.editor,n=t.locale,s=t.commands.get("selectAll"),o=new e(t.locale),r=n.t;return o.set({label:r("Select all"),icon:v6,keystroke:"Ctrl+A"}),o.bind("isEnabled").to(s,"isEnabled"),this.listenTo(o,"execute",()=>{t.execute("selectAll"),t.editing.view.focus()}),o}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class C6 extends y{static get requires(){return[_6,y6]}static get pluginName(){return"SelectAll"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class rp extends F{constructor(e){super(e),this._stack=[],this._createdBatches=new WeakSet,this.refresh(),this._isEnabledBasedOnSelection=!1,this.listenTo(e.data,"set",(t,n)=>{n[1]={...n[1]};const s=n[1];s.batchType||(s.batchType={isUndoable:!1})},{priority:"high"}),this.listenTo(e.data,"set",(t,n)=>{n[1].batchType.isUndoable||this.clearStack()})}refresh(){this.isEnabled=this._stack.length>0}get createdBatches(){return this._createdBatches}addBatch(e){const t=this.editor.model.document.selection,n={ranges:t.hasOwnRange?Array.from(t.getRanges()):[],isBackward:t.isBackward};this._stack.push({batch:e,selection:n}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(e,t,n){const s=this.editor.model,o=s.document,r=[],a=e.map(c=>c.getTransformedByOperations(n)),l=a.flat();for(const c of a){const u=c.filter(d=>d.root!=o.graveyard).filter(d=>!T6(d,l));u.length&&(k6(u),r.push(u[0]))}r.length&&s.change(c=>{c.setSelection(r,{backward:t})})}_undo(e,t){const n=this.editor.model,s=n.document;this._createdBatches.add(t);const o=e.operations.slice().filter(r=>r.isDocumentOperation);o.reverse();for(const r of o){const a=r.baseVersion+1,l=Array.from(s.history.getOperations(a)),u=kE([r.getReversed()],l,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}).operationsA;for(let d of u){const h=d.affectedSelectable;h&&!n.canEditAt(h)&&(d=new we(d.baseVersion)),t.addOperation(d),n.applyOperation(d),s.history.setOperationAsUndone(r,d)}}}}function k6(i){i.sort((e,t)=>e.start.isBefore(t.start)?-1:1);for(let e=1;e<i.length;e++){const n=i[e-1].getJoined(i[e],!0);n&&(e--,i.splice(e,2,n))}}function T6(i,e){return e.some(t=>t!==i&&t.containsRange(i,!0))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class E6 extends rp{execute(e=null){const t=e?this._stack.findIndex(o=>o.batch==e):this._stack.length-1,n=this._stack.splice(t,1)[0],s=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(s,()=>{this._undo(n.batch,s);const o=this.editor.model.document.history.getOperations(n.batch.baseVersion);this._restoreSelection(n.selection.ranges,n.selection.isBackward,o)}),this.fire("revert",n.batch,s),this.refresh()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class A6 extends rp{execute(){const e=this._stack.pop(),t=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(t,()=>{const s=e.batch.operations[e.batch.operations.length-1].baseVersion+1,o=this.editor.model.document.history.getOperations(s);this._restoreSelection(e.selection.ranges,e.selection.isBackward,o),this._undo(e.batch,t)}),this.refresh()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class x6 extends y{constructor(){super(...arguments),this._batchRegistry=new WeakSet}static get pluginName(){return"UndoEditing"}init(){const e=this.editor,t=e.t;this._undoCommand=new E6(e),this._redoCommand=new A6(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",(n,s)=>{const o=s[0];if(!o.isDocumentOperation)return;const r=o.batch,a=this._redoCommand.createdBatches.has(r),l=this._undoCommand.createdBatches.has(r);this._batchRegistry.has(r)||(this._batchRegistry.add(r),r.isUndoable&&(a?this._undoCommand.addBatch(r):l||(this._undoCommand.addBatch(r),this._redoCommand.clearStack())))},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",(n,s,o)=>{this._redoCommand.addBatch(o)}),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Undo"),keystroke:"CTRL+Z"},{label:t("Redo"),keystroke:[["CTRL+Y"],["CTRL+SHIFT+Z"]]}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class S6 extends y{static get pluginName(){return"UndoUI"}init(){const e=this.editor,t=e.locale,n=e.t,s=t.uiLanguageDirection=="ltr"?P.undo:P.redo,o=t.uiLanguageDirection=="ltr"?P.redo:P.undo;this._addButtonsToFactory("undo",n("Undo"),"CTRL+Z",s),this._addButtonsToFactory("redo",n("Redo"),"CTRL+Y",o)}_addButtonsToFactory(e,t,n,s){const o=this.editor;o.ui.componentFactory.add(e,()=>{const r=this._createButton(N,e,t,n,s);return r.set({tooltip:!0}),r}),o.ui.componentFactory.add("menuBar:"+e,()=>this._createButton(Ae,e,t,n,s))}_createButton(e,t,n,s,o){const r=this.editor,a=r.locale,l=r.commands.get(t),c=new e(a);return c.set({label:n,icon:o,keystroke:s}),c.bind("isEnabled").to(l,"isEnabled"),this.listenTo(c,"execute",()=>{r.execute(t),r.editing.view.focus()}),c}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class I6 extends y{static get requires(){return[x6,S6]}static get pluginName(){return"Undo"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class P6 extends y{static get requires(){return[x4,p6,$s,C6,Ig,a4,I6]}static get pluginName(){return"Essentials"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class R6 extends F{constructor(e){super(e),this._isEnabledBasedOnSelection=!1}refresh(){const e=this.editor.model,t=e.document,n=ce(t.selection.getSelectedBlocks());this.value=!!n&&n.is("element","paragraph"),this.isEnabled=!!n&&ap(n,e.schema)}execute(e={}){const t=this.editor.model,n=t.document,s=e.selection||n.selection;t.canEditAt(s)&&t.change(o=>{const r=s.getSelectedBlocks();for(const a of r)!a.is("element","paragraph")&&ap(a,t.schema)&&o.rename(a,"paragraph")})}}function ap(i,e){return e.checkChild(i.parent,"paragraph")&&!e.isObject(i)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class M6 extends F{constructor(e){super(e),this._isEnabledBasedOnSelection=!1}execute(e){const t=this.editor.model,n=e.attributes;let s=e.position;t.canEditAt(s)&&t.change(o=>{if(s=this._findPositionToInsertParagraph(s,o),!s)return;const r=o.createElement("paragraph");n&&t.schema.setAllowedAttributes(r,n,o),t.insertContent(r,s),o.setSelection(r,"in")})}_findPositionToInsertParagraph(e,t){const n=this.editor.model;if(n.schema.checkChild(e,"paragraph"))return e;const s=n.schema.findAllowedParent(e,"paragraph");if(!s)return null;const o=e.parent,r=n.schema.checkChild(o,"$text");return o.isEmpty||r&&e.isAtEnd?n.createPositionAfter(o):!o.isEmpty&&r&&e.isAtStart?n.createPositionBefore(o):t.split(e,s).position}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Vi extends y{static get pluginName(){return"Paragraph"}init(){const e=this.editor,t=e.model;e.commands.add("paragraph",new R6(e)),e.commands.add("insertParagraph",new M6(e)),t.schema.register("paragraph",{inheritAllFrom:"$block"}),e.conversion.elementToElement({model:"paragraph",view:"p"}),e.conversion.for("upcast").elementToElement({model:(n,{writer:s})=>!Vi.paragraphLikeElements.has(n.name)||n.isEmpty?null:s.createElement("paragraph"),view:/.+/,converterPriority:"low"})}}Vi.paragraphLikeElements=new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td","th"]);/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const B6=P.paragraph;class O6 extends y{static get requires(){return[Vi]}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("paragraph",n=>{const s=new N(n),o=e.commands.get("paragraph");return s.label=t("Paragraph"),s.icon=B6,s.tooltip=!0,s.isToggleable=!0,s.bind("isEnabled").to(o),s.bind("isOn").to(o,"value"),s.on("execute",()=>{e.execute("paragraph")}),s})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class L6 extends F{constructor(e,t){super(e),this.modelElements=t}refresh(){const e=ce(this.editor.model.document.selection.getSelectedBlocks());this.value=!!e&&this.modelElements.includes(e.name)&&e.name,this.isEnabled=!!e&&this.modelElements.some(t=>lp(e,t,this.editor.model.schema))}execute(e){const t=this.editor.model,n=t.document,s=e.value;t.change(o=>{const r=Array.from(n.selection.getSelectedBlocks()).filter(a=>lp(a,s,t.schema));for(const a of r)a.is("element",s)||o.rename(a,s)})}}function lp(i,e,t){return t.checkChild(i.parent,e)&&!t.isObject(i)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const cp="paragraph";class V6 extends y{static get pluginName(){return"HeadingEditing"}constructor(e){super(e),e.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[Vi]}init(){const e=this.editor,t=e.config.get("heading.options"),n=[];for(const s of t)s.model!=="paragraph"&&(e.model.schema.register(s.model,{inheritAllFrom:"$block"}),e.conversion.elementToElement(s),n.push(s.model));this._addDefaultH1Conversion(e),e.commands.add("heading",new L6(e,n))}afterInit(){const e=this.editor,t=e.commands.get("enter"),n=e.config.get("heading.options");t&&this.listenTo(t,"afterExecute",(s,o)=>{const r=e.model.document.selection.getFirstPosition().parent;n.some(l=>r.is("element",l.model))&&!r.is("element",cp)&&r.childCount===0&&o.writer.rename(r,cp)})}_addDefaultH1Conversion(e){e.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:We.low+1})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function up(i){const e=i.t,t={Paragraph:e("Paragraph"),"Heading 1":e("Heading 1"),"Heading 2":e("Heading 2"),"Heading 3":e("Heading 3"),"Heading 4":e("Heading 4"),"Heading 5":e("Heading 5"),"Heading 6":e("Heading 6")};return i.config.get("heading.options").map(n=>{const s=t[n.title];return s&&s!=n.title&&(n.title=s),n})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class D6 extends y{static get pluginName(){return"HeadingUI"}init(){const e=this.editor,t=e.t,n=up(e),s=t("Choose heading"),o=t("Heading");e.ui.componentFactory.add("heading",r=>{const a={},l=new Oe,c=e.commands.get("heading"),u=e.commands.get("paragraph"),d=[c];for(const f of n){const m={type:"button",model:new Ri({label:f.title,class:f.class,role:"menuitemradio",withText:!0})};f.model==="paragraph"?(m.model.bind("isOn").to(u,"value"),m.model.set("commandName","paragraph"),d.push(u)):(m.model.bind("isOn").to(c,"value",g=>g===f.model),m.model.set({commandName:"heading",commandValue:f.model})),l.add(m),a[f.model]=f.title}const h=tt(r);return Si(h,l,{ariaLabel:o,role:"menu"}),h.buttonView.set({ariaLabel:o,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:o}),h.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),h.bind("isEnabled").toMany(d,"isEnabled",(...f)=>f.some(m=>m)),h.buttonView.bind("label").to(c,"value",u,"value",(f,m)=>{const g=m?"paragraph":f;return typeof g=="boolean"||!a[g]?s:a[g]}),h.buttonView.bind("ariaLabel").to(c,"value",u,"value",(f,m)=>{const g=m?"paragraph":f;return typeof g=="boolean"||!a[g]?o:`${a[g]}, ${o}`}),this.listenTo(h,"execute",f=>{const{commandName:m,commandValue:g}=f.source;e.execute(m,g?{value:g}:void 0),e.editing.view.focus()}),h}),e.ui.componentFactory.add("menuBar:heading",r=>{const a=new Lt(r),l=e.commands.get("heading"),c=e.commands.get("paragraph"),u=[l],d=new Ds(r);a.set({class:"ck-heading-dropdown"}),d.set({ariaLabel:t("Heading"),role:"menu"}),a.buttonView.set({label:t("Heading")}),a.panelView.children.add(d);for(const h of n){const f=new Bi(r,a),m=new Ae(r);f.children.add(m),d.items.add(f),m.set({label:h.title,role:"menuitemradio",class:h.class}),m.bind("ariaChecked").to(m,"isOn"),m.delegate("execute").to(a),m.on("execute",()=>{const g=h.model==="paragraph"?"paragraph":"heading";e.execute(g,{value:h.model}),e.editing.view.focus()}),h.model==="paragraph"?(m.bind("isOn").to(c,"value"),u.push(c)):m.bind("isOn").to(l,"value",g=>g===h.model)}return a.bind("isEnabled").toMany(u,"isEnabled",(...h)=>h.some(f=>f)),a})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class N6 extends y{static get requires(){return[V6,D6]}static get pluginName(){return"Heading"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const F6={heading1:P.heading1,heading2:P.heading2,heading3:P.heading3,heading4:P.heading4,heading5:P.heading5,heading6:P.heading6};class $6 extends y{init(){up(this.editor).filter(t=>t.model!=="paragraph").map(t=>this._createButton(t))}_createButton(e){const t=this.editor;t.ui.componentFactory.add(e.model,n=>{const s=new N(n),o=t.commands.get("heading");return s.label=e.title,s.icon=e.icon||F6[e.model],s.tooltip=!0,s.isToggleable=!0,s.bind("isEnabled").to(o),s.bind("isOn").to(o,"value",r=>r==e.model),s.on("execute",()=>{t.execute("heading",{value:e.model}),t.editing.view.focus()}),s})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class U6 extends F{refresh(){const e=this.editor.model,t=e.document;this.value=t.selection.getAttribute("highlight"),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"highlight")}execute(e={}){const t=this.editor.model,s=t.document.selection,o=e.value;t.change(r=>{if(s.isCollapsed){const a=s.getFirstPosition();if(s.hasAttribute("highlight")){const l=h=>h.item.hasAttribute("highlight")&&h.item.getAttribute("highlight")===this.value,c=a.getLastMatchingPosition(l,{direction:"backward"}),u=a.getLastMatchingPosition(l),d=r.createRange(c,u);!o||this.value===o?(a.isEqual(u)||r.removeAttribute("highlight",d),r.removeSelectionAttribute("highlight")):(a.isEqual(u)||r.setAttribute("highlight",o,d),r.setSelectionAttribute("highlight",o))}else o&&r.setSelectionAttribute("highlight",o)}else{const a=t.schema.getValidRanges(s.getRanges(),"highlight");for(const l of a)o?r.setAttribute("highlight",o,l):r.removeAttribute("highlight",l)}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class z6 extends y{static get pluginName(){return"HighlightEditing"}constructor(e){super(e),e.config.define("highlight",{options:[{model:"yellowMarker",class:"marker-yellow",title:"Yellow marker",color:"var(--ck-highlight-marker-yellow)",type:"marker"},{model:"greenMarker",class:"marker-green",title:"Green marker",color:"var(--ck-highlight-marker-green)",type:"marker"},{model:"pinkMarker",class:"marker-pink",title:"Pink marker",color:"var(--ck-highlight-marker-pink)",type:"marker"},{model:"blueMarker",class:"marker-blue",title:"Blue marker",color:"var(--ck-highlight-marker-blue)",type:"marker"},{model:"redPen",class:"pen-red",title:"Red pen",color:"var(--ck-highlight-pen-red)",type:"pen"},{model:"greenPen",class:"pen-green",title:"Green pen",color:"var(--ck-highlight-pen-green)",type:"pen"}]})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:"highlight"});const t=e.config.get("highlight.options");e.conversion.attributeToElement(H6(t)),e.commands.add("highlight",new U6(e))}}function H6(i){const e={model:{key:"highlight",values:[]},view:{}};for(const t of i)e.model.values.push(t.model),e.view[t.model]={name:"mark",classes:t.class};return e}const W6='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M10.798 1.59 3.002 12.875l1.895 1.852 2.521 1.402 6.997-12.194z"/><path d="m2.556 16.727.234-.348c-.297-.151-.462-.293-.498-.426-.036-.137.002-.416.115-.837.094-.25.15-.449.169-.595a4.495 4.495 0 0 0 0-.725c-.209-.621-.303-1.041-.284-1.26.02-.218.178-.506.475-.862l6.77-9.414c.539-.91 1.605-.85 3.199.18 1.594 1.032 2.188 1.928 1.784 2.686l-5.877 10.36c-.158.412-.333.673-.526.782-.193.108-.604.179-1.232.21-.362.131-.608.237-.738.318-.13.081-.305.238-.526.47-.293.265-.504.397-.632.397-.096 0-.27-.075-.524-.226l-.31.41-1.6-1.12zm-.279.415 1.575 1.103-.392.515H1.19l1.087-1.618zm8.1-13.656-4.953 6.9L8.75 12.57l4.247-7.574c.175-.25-.188-.647-1.092-1.192-.903-.546-1.412-.652-1.528-.32zM8.244 18.5 9.59 17h9.406v1.5H8.245z"/></svg>',j6='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M10.126 2.268 2.002 13.874l1.895 1.852 2.521 1.402L14.47 5.481l-1.543-2.568-2.801-.645z"/><path d="m4.5 18.088-2.645-1.852-.04-2.95-.006-.005.006-.008v-.025l.011.008L8.73 2.97c.165-.233.356-.417.567-.557l-1.212.308L4.604 7.9l-.83-.558 3.694-5.495 2.708-.69 1.65 1.145.046.018.85-1.216 2.16 1.512-.856 1.222c.828.967 1.144 2.141.432 3.158L7.55 17.286l.006.005-3.055.797H4.5zm-.634.166-1.976.516-.026-1.918 2.002 1.402zM9.968 3.817l-.006-.004-6.123 9.184 3.277 2.294 6.108-9.162.005.003c.317-.452-.16-1.332-1.064-1.966-.891-.624-1.865-.776-2.197-.349zM8.245 18.5 9.59 17h9.406v1.5H8.245z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class q6 extends y{get localizedOptionTitles(){const e=this.editor.t;return{"Yellow marker":e("Yellow marker"),"Green marker":e("Green marker"),"Pink marker":e("Pink marker"),"Blue marker":e("Blue marker"),"Red pen":e("Red pen"),"Green pen":e("Green pen")}}static get pluginName(){return"HighlightUI"}init(){const e=this.editor.config.get("highlight.options");for(const t of e)this._addHighlighterButton(t);this._addRemoveHighlightButton(),this._addDropdown(e),this._addMenuBarButton(e)}_addRemoveHighlightButton(){const e=this.editor.t,t=this.editor.commands.get("highlight");this._addButton("removeHighlight",e("Remove highlight"),P.eraser,null,n=>{n.bind("isEnabled").to(t,"isEnabled")})}_addHighlighterButton(e){const t=this.editor.commands.get("highlight");this._addButton("highlight:"+e.model,e.title,xr(e.type),e.model,n);function n(s){s.bind("isEnabled").to(t,"isEnabled"),s.bind("isOn").to(t,"value",o=>o===e.model),s.iconView.fillColor=e.color,s.isToggleable=!0}}_addButton(e,t,n,s,o){const r=this.editor;r.ui.componentFactory.add(e,a=>{const l=new N(a),c=this.localizedOptionTitles[t]?this.localizedOptionTitles[t]:t;return l.set({label:c,icon:n,tooltip:!0}),l.on("execute",()=>{r.execute("highlight",{value:s}),r.editing.view.focus()}),o(l),l})}_addDropdown(e){const t=this.editor,n=t.t,s=t.ui.componentFactory,o=e[0],r=e.reduce((a,l)=>(a[l.model]=l,a),{});s.add("highlight",a=>{const l=t.commands.get("highlight"),c=tt(a,Bs),u=c.buttonView;u.set({label:n("Highlight"),tooltip:!0,lastExecuted:o.model,commandValue:o.model,isToggleable:!0}),u.bind("icon").to(l,"value",f=>xr(h(f,"type"))),u.bind("color").to(l,"value",f=>h(f,"color")),u.bind("commandValue").to(l,"value",f=>h(f,"model")),u.bind("isOn").to(l,"value",f=>!!f),u.delegate("execute").to(c);const d=()=>{const f=e.map(m=>{const g=s.create("highlight:"+m.model);return this.listenTo(g,"execute",()=>{c.buttonView.set({lastExecuted:m.model})}),g});return f.push(new Fl),f.push(s.create("removeHighlight")),f};c.bind("isEnabled").to(l,"isEnabled"),lr(c,d,{enableActiveItemFocusOnDropdownOpen:!0,ariaLabel:n("Text highlight toolbar")}),G6(c),u.on("execute",()=>{t.execute("highlight",{value:u.commandValue})}),this.listenTo(c,"execute",()=>{t.editing.view.focus()});function h(f,m){const g=!f||f===u.lastExecuted?u.lastExecuted:f;return r[g][m]}return c})}_addMenuBarButton(e){const t=this.editor,n=t.t;t.ui.componentFactory.add("menuBar:highlight",s=>{const o=t.commands.get("highlight"),r=new Lt(s);r.buttonView.set({label:n("Highlight"),icon:xr("marker")}),r.bind("isEnabled").to(o),r.buttonView.iconView.fillColor="transparent";const a=new Ds(s);for(const u of e){const d=new Bi(s,r),h=new Ae(s);h.set({label:u.title,icon:xr(u.type)}),h.delegate("execute").to(r),h.bind("isOn").to(o,"value",f=>f===u.model),h.bind("ariaChecked").to(h,"isOn"),h.iconView.bind("fillColor").to(h,"isOn",f=>f?"transparent":u.color),h.on("execute",()=>{t.execute("highlight",{value:u.model}),t.editing.view.focus()}),d.children.add(h),a.items.add(d)}a.items.add(new or(s));const l=new Bi(s,r),c=new Ae(s);return c.set({label:n("Remove highlight"),icon:P.eraser}),c.delegate("execute").to(r),c.on("execute",()=>{t.execute("highlight",{value:null}),t.editing.view.focus()}),l.children.add(c),a.items.add(l),r.panelView.children.add(a),r})}}function G6(i){i.buttonView.actionView.iconView.bind("fillColor").to(i.buttonView,"color")}function xr(i){return i==="marker"?W6:j6}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class K6 extends y{static get requires(){return[z6,q6]}static get pluginName(){return"Highlight"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Un(i,e,t,n){e&&Z6(i,e,n),t&&Dt(i,t,n)}function Dt(i,e,t){if(e.attributes)for(const[n,s]of Object.entries(e.attributes))i.setAttribute(n,s,t);e.styles&&i.setStyle(e.styles,t),e.classes&&i.addClass(e.classes,t)}function Z6(i,e,t){if(e.attributes)for(const[n]of Object.entries(e.attributes))i.removeAttribute(n,t);if(e.styles)for(const n of Object.keys(e.styles))i.removeStyle(n,t);e.classes&&i.removeClass(e.classes,t)}function J6(i,e){const t=ot(i);let n="attributes";for(n in e)n=="classes"?t[n]=Array.from(new Set([...i[n]||[],...e[n]])):t[n]={...i[n],...e[n]};return t}function Di(i,e,t,n,s){const o=e.getAttribute(t),r={};for(const a of["attributes","styles","classes"]){if(a!=n){o&&o[a]&&(r[a]=o[a]);continue}if(n=="classes"){const c=new Set(o&&o.classes||[]);s(c),c.size&&(r[a]=Array.from(c));continue}const l=new Map(Object.entries(o&&o[a]||{}));s(l),l.size&&(r[a]=Object.fromEntries(l))}Object.keys(r).length?e.is("documentSelection")?i.setSelectionAttribute(t,r):i.setAttribute(t,r,e):o&&(e.is("documentSelection")?i.removeSelectionAttribute(t):i.removeAttribute(t,e))}function Y6(i){return $k(i).replace(/ /g,"")}function ut(i){return`html${Y6(i)}Attributes`}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ac({model:i}){return(e,t)=>t.writer.createElement(i,{htmlContent:e.getCustomProperty("$rawContent")})}function X6(i,{view:e,isInline:t}){const n=i.t;return(s,{writer:o})=>{const r=n("HTML object"),a=Sr(e,s,o),l=s.getAttribute(ut(e));o.addClass("html-object-embed__content",a),l&&Dt(o,l,a);const c=o.createContainerElement(t?"span":"div",{class:"html-object-embed","data-html-object-embed-label":r},a);return Ws(c,o,{label:r})}}function Sr(i,e,t){return t.createRawElement(i,null,(n,s)=>{s.setContentOf(n,e.getAttribute("htmlContent"))})}function Q6({view:i,model:e,allowEmpty:t},n){return o=>{o.on(`element:${i}`,(r,a,l)=>{let c=n.processViewAttributes(a.viewItem,l);if(!(!c&&!l.consumable.test(a.viewItem,{name:!0}))){if(c=c||{},l.consumable.consume(a.viewItem,{name:!0}),a.modelRange||(a=Object.assign(a,l.convertChildren(a.viewItem,a.modelCursor))),t&&a.modelRange.isCollapsed&&Object.keys(c).length){const u=l.writer.createElement("htmlEmptyElement");if(!l.safeInsert(u,a.modelCursor))return;const d=l.getSplitParts(u);a.modelRange=l.writer.createRange(a.modelRange.start,l.writer.createPositionAfter(d[d.length-1])),l.updateConversionResult(u,a),s(u,c,l);return}for(const u of a.modelRange.getItems())s(u,c,l)}},{priority:"low"})};function s(o,r,a){if(a.schema.checkAttribute(o,e)){const l=o.getAttribute(e),c=J6(r,l||{});a.writer.setAttribute(e,c,o)}}}function dp({model:i,view:e},t){return(n,{writer:s,consumable:o})=>{if(!n.hasAttribute(i))return null;const r=s.createContainerElement(e),a=n.getAttribute(i);return o.consume(n,`attribute:${i}`),Dt(s,a,r),r.getFillerOffset=()=>null,t?Ws(r,s):r}}function eP({priority:i,view:e}){return(t,n)=>{if(!t)return;const{writer:s}=n,o=s.createAttributeElement(e,null,{priority:i});return Dt(s,t,o),o}}function js({view:i},e){return t=>{t.on(`element:${i}`,(n,s,o)=>{if(!s.modelRange||s.modelRange.isCollapsed)return;const r=e.processViewAttributes(s.viewItem,o);r&&o.writer.setAttribute(ut(s.viewItem.name),r,s.modelRange)},{priority:"low"})}}function qs({view:i,model:e}){return t=>{t.on(`attribute:${ut(i)}:${e}`,(n,s,o)=>{if(!o.consumable.consume(s.item,n.name))return;const{attributeOldValue:r,attributeNewValue:a}=s,l=o.writer,c=o.mapper.toViewElement(s.item);Un(l,r,a,c)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const hp={block:[{model:"codeBlock",view:"pre"},{model:"paragraph",view:"p"},{model:"blockQuote",view:"blockquote"},{model:"listItem",view:"li"},{model:"pageBreak",view:"div"},{model:"rawHtml",view:"div"},{model:"table",view:"table"},{model:"tableRow",view:"tr"},{model:"tableCell",view:"td"},{model:"tableCell",view:"th"},{model:"tableColumnGroup",view:"colgroup"},{model:"tableColumn",view:"col"},{model:"caption",view:"caption"},{model:"caption",view:"figcaption"},{model:"imageBlock",view:"img"},{model:"imageInline",view:"img"},{model:"htmlP",view:"p",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlBlockquote",view:"blockquote",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlTable",view:"table",modelSchema:{allowWhere:"$block",isBlock:!0}},{model:"htmlTbody",view:"tbody",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlThead",view:"thead",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlTfoot",view:"tfoot",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlCaption",view:"caption",modelSchema:{allowIn:"htmlTable",allowChildren:"$text",isBlock:!1}},{model:"htmlColgroup",view:"colgroup",modelSchema:{allowIn:"htmlTable",allowChildren:"col",isBlock:!1}},{model:"htmlCol",view:"col",modelSchema:{allowIn:"htmlColgroup",isBlock:!1}},{model:"htmlTr",view:"tr",modelSchema:{allowIn:["htmlTable","htmlThead","htmlTbody"],isLimit:!0}},{model:"htmlTd",view:"td",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlTh",view:"th",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlFigure",view:"figure",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFigcaption",view:"figcaption",modelSchema:{allowIn:"htmlFigure",allowChildren:"$text",isBlock:!1}},{model:"htmlAddress",view:"address",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlAside",view:"aside",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlMain",view:"main",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDetails",view:"details",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSummary",view:"summary",modelSchema:{allowChildren:"$text",allowIn:"htmlDetails",isBlock:!1}},{model:"htmlDiv",view:"div",paragraphLikeModel:"htmlDivParagraph",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlFieldset",view:"fieldset",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlLegend",view:"legend",modelSchema:{allowIn:"htmlFieldset",allowChildren:"$text"}},{model:"htmlHeader",view:"header",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFooter",view:"footer",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlForm",view:"form",modelSchema:{inheritAllFrom:"$container",isBlock:!0}},{model:"htmlHgroup",view:"hgroup",modelSchema:{allowChildren:["htmlH1","htmlH2","htmlH3","htmlH4","htmlH5","htmlH6"],isBlock:!1}},{model:"htmlH1",view:"h1",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH2",view:"h2",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH3",view:"h3",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH4",view:"h4",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH5",view:"h5",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH6",view:"h6",modelSchema:{inheritAllFrom:"$block"}},{model:"$htmlList",modelSchema:{allowWhere:"$container",allowChildren:["$htmlList","htmlLi"],isBlock:!1}},{model:"htmlDir",view:"dir",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlMenu",view:"menu",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlUl",view:"ul",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlOl",view:"ol",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlLi",view:"li",modelSchema:{allowIn:"$htmlList",allowChildren:"$text",isBlock:!1}},{model:"htmlPre",view:"pre",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlArticle",view:"article",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSection",view:"section",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlNav",view:"nav",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDivDl",view:"div",modelSchema:{allowChildren:["htmlDt","htmlDd"],allowIn:"htmlDl"}},{model:"htmlDl",view:"dl",modelSchema:{allowWhere:"$container",allowChildren:["htmlDt","htmlDd","htmlDivDl"],isBlock:!1}},{model:"htmlDt",view:"dt",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlDd",view:"dd",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlCenter",view:"center",modelSchema:{inheritAllFrom:"$container",isBlock:!1}}],inline:[{model:"htmlLiAttributes",view:"li",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlOlAttributes",view:"ol",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlUlAttributes",view:"ul",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"table"},{model:"htmlTheadAttributes",view:"thead",appliesToBlock:"table"},{model:"htmlTbodyAttributes",view:"tbody",appliesToBlock:"table"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"imageBlock"},{model:"htmlAcronym",view:"acronym",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTt",view:"tt",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlFont",view:"font",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTime",view:"time",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlVar",view:"var",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBig",view:"big",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSmall",view:"small",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSamp",view:"samp",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlQ",view:"q",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlOutput",view:"output",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlKbd",view:"kbd",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdi",view:"bdi",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdo",view:"bdo",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlAbbr",view:"abbr",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlA",view:"a",priority:5,coupledAttribute:"linkHref"},{model:"htmlStrong",view:"strong",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlB",view:"b",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlI",view:"i",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlEm",view:"em",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlS",view:"s",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDel",view:"del",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlIns",view:"ins",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlU",view:"u",coupledAttribute:"underline",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSub",view:"sub",coupledAttribute:"subscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSup",view:"sup",coupledAttribute:"superscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCode",view:"code",coupledAttribute:"code",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlMark",view:"mark",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSpan",view:"span",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCite",view:"cite",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlLabel",view:"label",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDfn",view:"dfn",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlObject",view:"object",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlIframe",view:"iframe",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlInput",view:"input",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlButton",view:"button",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlTextarea",view:"textarea",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlSelect",view:"select",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlVideo",view:"video",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlEmbed",view:"embed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlOembed",view:"oembed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlAudio",view:"audio",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlImg",view:"img",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlCanvas",view:"canvas",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlMeter",view:"meter",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlProgress",view:"progress",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlScript",view:"script",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlStyle",view:"style",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlCustomElement",view:"$customElement",modelSchema:{allowWhere:["$text","$block"],allowAttributesOf:"$inlineObject",isInline:!0}}]};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ni extends y{constructor(){super(...arguments),this._definitions=[]}static get pluginName(){return"DataSchema"}init(){for(const e of hp.block)this.registerBlockElement(e);for(const e of hp.inline)this.registerInlineElement(e)}registerBlockElement(e){this._definitions.push({...e,isBlock:!0})}registerInlineElement(e){this._definitions.push({...e,isInline:!0})}extendBlockElement(e){this._extendDefinition({...e,isBlock:!0})}extendInlineElement(e){this._extendDefinition({...e,isInline:!0})}getDefinitionsForView(e,t=!1){const n=new Set;for(const s of this._getMatchingViewDefinitions(e)){if(t)for(const o of this._getReferences(s.model))n.add(o);n.add(s)}return n}getDefinitionsForModel(e){return this._definitions.filter(t=>t.model==e)}_getMatchingViewDefinitions(e){return this._definitions.filter(t=>t.view&&tP(e,t.view))}*_getReferences(e){const t=["inheritAllFrom","inheritTypesFrom","allowWhere","allowContentOf","allowAttributesOf"],n=this._definitions.filter(s=>s.model==e);for(const{modelSchema:s}of n)if(s)for(const o of t)for(const r of J(s[o]||[])){const a=this._definitions.filter(l=>l.model==r);for(const l of a)r!==e&&(yield*this._getReferences(l.model),yield l)}}_extendDefinition(e){const t=Array.from(this._definitions.entries()).filter(([,n])=>n.model==e.model);if(t.length==0){this._definitions.push(e);return}for(const[n,s]of t)this._definitions[n]=xk({},s,e,(o,r)=>Array.isArray(o)?o.concat(r):void 0)}}function tP(i,e){return typeof i=="string"?i===e:i instanceof RegExp?i.test(e):!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ge extends y{constructor(e){super(e),this._dataSchema=e.plugins.get("DataSchema"),this._allowedAttributes=new Ge,this._disallowedAttributes=new Ge,this._allowedElements=new Set,this._disallowedElements=new Set,this._dataInitialized=!1,this._coupledAttributes=null,this._registerElementsAfterInit(),this._registerElementHandlers(),this._registerCoupledAttributesPostFixer(),this._registerAssociatedHtmlAttributesPostFixer()}static get pluginName(){return"DataFilter"}static get requires(){return[Ni,oc]}loadAllowedConfig(e){for(const t of e){const n=t.name||/[\s\S]+/,s=mp(t);this.allowElement(n),s.forEach(o=>this.allowAttributes(o))}}loadDisallowedConfig(e){for(const t of e){const n=t.name||/[\s\S]+/,s=mp(t);s.length==0?this.disallowElement(n):s.forEach(o=>this.disallowAttributes(o))}}loadAllowedEmptyElementsConfig(e){for(const t of e)this.allowEmptyElement(t)}allowElement(e){for(const t of this._dataSchema.getDefinitionsForView(e,!0))this._addAllowedElement(t),this._coupledAttributes=null}disallowElement(e){for(const t of this._dataSchema.getDefinitionsForView(e,!1))this._disallowedElements.add(t.view)}allowEmptyElement(e){for(const t of this._dataSchema.getDefinitionsForView(e,!0))t.isInline&&this._dataSchema.extendInlineElement({...t,allowEmpty:!0})}allowAttributes(e){this._allowedAttributes.add(e)}disallowAttributes(e){this._disallowedAttributes.add(e)}processViewAttributes(e,t){const{consumable:n}=t;return fp(e,this._disallowedAttributes,n),nP(e,fp(e,this._allowedAttributes,n))}_addAllowedElement(e){if(!this._allowedElements.has(e)){if(this._allowedElements.add(e),"appliesToBlock"in e&&typeof e.appliesToBlock=="string")for(const t of this._dataSchema.getDefinitionsForModel(e.appliesToBlock))t.isBlock&&this._addAllowedElement(t);this._dataInitialized&&this.editor.data.once("set",()=>{this._fireRegisterEvent(e)},{priority:We.highest+1})}}_registerElementsAfterInit(){this.editor.data.on("init",()=>{this._dataInitialized=!0;for(const e of this._allowedElements)this._fireRegisterEvent(e)},{priority:We.highest+1})}_registerElementHandlers(){this.on("register",(e,t)=>{const n=this.editor.model.schema;if(t.isObject&&!n.isRegistered(t.model))this._registerObjectElement(t);else if(t.isBlock)this._registerBlockElement(t);else if(t.isInline)this._registerInlineElement(t);else throw new p("data-filter-invalid-definition",null,t);e.stop()},{priority:"lowest"})}_registerCoupledAttributesPostFixer(){const e=this.editor.model,t=e.document.selection;e.document.registerPostFixer(n=>{const s=e.document.differ.getChanges();let o=!1;const r=this._getCoupledAttributesMap();for(const a of s){if(a.type!="attribute"||a.attributeNewValue!==null)continue;const l=r.get(a.attributeKey);if(l)for(const{item:c}of a.range.getWalker())for(const u of l)c.hasAttribute(u)&&(n.removeAttribute(u,c),o=!0)}return o}),this.listenTo(t,"change:attribute",(n,{attributeKeys:s})=>{const o=new Set,r=this._getCoupledAttributesMap();for(const a of s){if(t.hasAttribute(a))continue;const l=r.get(a);if(l)for(const c of l)t.hasAttribute(c)&&o.add(c)}o.size!=0&&e.change(a=>{for(const l of o)a.removeSelectionAttribute(l)})})}_registerAssociatedHtmlAttributesPostFixer(){const e=this.editor.model;e.document.registerPostFixer(t=>{const n=e.document.differ.getChanges();let s=!1;for(const o of n)if(!(o.type!=="insert"||o.name==="$text"))for(const r of o.attributes.keys())!r.startsWith("html")||!r.endsWith("Attributes")||e.schema.checkAttribute(o.name,r)||(t.removeAttribute(r,o.position.nodeAfter),s=!0);return s})}_getCoupledAttributesMap(){if(this._coupledAttributes)return this._coupledAttributes;this._coupledAttributes=new Map;for(const e of this._allowedElements)if(e.coupledAttribute&&e.model){const t=this._coupledAttributes.get(e.coupledAttribute);t?t.push(e.model):this._coupledAttributes.set(e.coupledAttribute,[e.model])}return this._coupledAttributes}_fireRegisterEvent(e){e.view&&this._disallowedElements.has(e.view)||this.fire(e.view?`register:${e.view}`:"register",e)}_registerObjectElement(e){const t=this.editor,n=t.model.schema,s=t.conversion,{view:o,model:r}=e;n.register(r,e.modelSchema);/* istanbul ignore next: paranoid check -- @preserve */o&&(n.extend(e.model,{allowAttributes:[ut(o),"htmlContent"]}),t.data.registerRawContentMatcher({name:o}),s.for("upcast").elementToElement({view:o,model:ac(e),converterPriority:We.low+2}),s.for("upcast").add(js(e,this)),s.for("editingDowncast").elementToStructure({model:{name:r,attributes:[ut(o)]},view:X6(t,e)}),s.for("dataDowncast").elementToElement({model:r,view:(a,{writer:l})=>Sr(o,a,l)}),s.for("dataDowncast").add(qs(e)))}_registerBlockElement(e){const t=this.editor,n=t.model.schema,s=t.conversion,{view:o,model:r}=e;if(!n.isRegistered(e.model)){if(n.register(e.model,e.modelSchema),!o)return;s.for("upcast").elementToElement({model:r,view:o,converterPriority:We.low+2}),s.for("downcast").elementToElement({model:r,view:o})}o&&(n.extend(e.model,{allowAttributes:ut(o)}),s.for("upcast").add(js(e,this)),s.for("downcast").add(qs(e)))}_registerInlineElement(e){const t=this.editor,n=t.model.schema,s=t.conversion,o=e.model;e.appliesToBlock||(n.extend("$text",{allowAttributes:o}),e.attributeProperties&&n.setAttributeProperties(o,e.attributeProperties),s.for("upcast").add(Q6(e,this)),s.for("downcast").attributeToElement({model:o,view:eP(e)}),e.allowEmpty&&(n.setAttributeProperties(o,{copyFromObject:!1}),n.isRegistered("htmlEmptyElement")||n.register("htmlEmptyElement",{inheritAllFrom:"$inlineObject"}),t.data.htmlProcessor.domConverter.registerInlineObjectMatcher(r=>r.name==e.view&&r.isEmpty&&Array.from(r.getAttributeKeys()).length?{name:!0}:null),s.for("editingDowncast").elementToElement({model:"htmlEmptyElement",view:dp(e,!0)}),s.for("dataDowncast").elementToElement({model:"htmlEmptyElement",view:dp(e)})))}}function fp(i,e,t){const n=e.matchAll(i)||[],s=i.document.stylesProcessor;return n.reduce((o,{match:r})=>{for(const a of r.styles||[]){const l=s.getRelatedStyles(a).filter(c=>c.split("-").length>a.split("-").length).sort((c,u)=>u.split("-").length-c.split("-").length);for(const c of l)t.consume(i,{styles:[c]})&&o.styles.push(c);t.consume(i,{styles:[a]})&&o.styles.push(a)}for(const a of r.classes||[])t.consume(i,{classes:[a]})&&o.classes.push(a);for(const a of r.attributes||[])t.consume(i,{attributes:[a]})&&o.attributes.push(a);return o},{attributes:[],classes:[],styles:[]})}function nP(i,{attributes:e,classes:t,styles:n}){return!e.length&&!t.length&&!n.length?null:{...e.length&&{attributes:iP(i,e)},...n.length&&{styles:sP(i,n)},...t.length&&{classes:t}}}function iP(i,e){const t={};for(const n of e){const s=i.getAttribute(n);s!==void 0&&gh(n)&&(t[n]=s)}return t}function sP(i,e){const t=new Lo(i.document.stylesProcessor);for(const n of e){const s=i.getStyle(n);s!==void 0&&t.set(n,s)}return Object.fromEntries(t.getStylesEntries())}function lc(i,e){const{name:t}=i,n=i[e];return De(n)?Object.entries(n).map(([s,o])=>({name:t,[e]:{[s]:o}})):Array.isArray(n)?n.map(s=>({name:t,[e]:[s]})):[i]}function mp(i){const{name:e,attributes:t,classes:n,styles:s}=i,o=[];return t&&o.push(...lc({name:e,attributes:t},"attributes")),n&&o.push(...lc({name:e,classes:n},"classes")),s&&o.push(...lc({name:e,styles:s},"styles")),o}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oP extends y{static get requires(){return[ge]}static get pluginName(){return"CodeBlockElementSupport"}init(){if(!this.editor.plugins.has("CodeBlockEditing"))return;const e=this.editor.plugins.get(ge);e.on("register:pre",(t,n)=>{if(n.model!=="codeBlock")return;const s=this.editor,o=s.model.schema,r=s.conversion;o.extend("codeBlock",{allowAttributes:["htmlPreAttributes","htmlContentAttributes"]}),r.for("upcast").add(rP(e)),r.for("downcast").add(aP()),t.stop()})}}function rP(i){return e=>{e.on("element:code",(t,n,s)=>{const o=n.viewItem,r=o.parent;if(!r||!r.is("element","pre"))return;a(r,"htmlPreAttributes"),a(o,"htmlContentAttributes");function a(l,c){const u=i.processViewAttributes(l,s);u&&s.writer.setAttribute(c,u,n.modelRange)}},{priority:"low"})}}function aP(){return i=>{i.on("attribute:htmlPreAttributes:codeBlock",(e,t,n)=>{if(!n.consumable.consume(t.item,e.name))return;const{attributeOldValue:s,attributeNewValue:o}=t,a=n.mapper.toViewElement(t.item).parent;Un(n.writer,s,o,a)}),i.on("attribute:htmlContentAttributes:codeBlock",(e,t,n)=>{if(!n.consumable.consume(t.item,e.name))return;const{attributeOldValue:s,attributeNewValue:o}=t,r=n.mapper.toViewElement(t.item);Un(n.writer,s,o,r)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class lP extends y{static get requires(){return[ge]}static get pluginName(){return"DualContentModelElementSupport"}init(){this.editor.plugins.get(ge).on("register",(t,n)=>{const s=n,o=this.editor,r=o.model.schema,a=o.conversion;if(!s.paragraphLikeModel||r.isRegistered(s.model)||r.isRegistered(s.paragraphLikeModel))return;const l={model:s.paragraphLikeModel,view:s.view};r.register(s.model,s.modelSchema),r.register(l.model,{inheritAllFrom:"$block"}),a.for("upcast").elementToElement({view:s.view,model:(c,{writer:u})=>this._hasBlockContent(c)?u.createElement(s.model):u.createElement(l.model),converterPriority:We.low+.5}),a.for("downcast").elementToElement({view:s.view,model:s.model}),this._addAttributeConversion(s),a.for("downcast").elementToElement({view:l.view,model:l.model}),this._addAttributeConversion(l),t.stop()})}_hasBlockContent(e){const t=this.editor.editing.view,n=t.domConverter.blockElements;for(const s of t.createRangeIn(e).getItems())if(s.is("element")&&n.includes(s.name))return!0;return!1}_addAttributeConversion(e){const t=this.editor,n=t.conversion,s=t.plugins.get(ge);t.model.schema.extend(e.model,{allowAttributes:ut(e.view)}),n.for("upcast").add(js(e,s)),n.for("downcast").add(qs(e))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class cP extends y{static get requires(){return[Ni,$s]}static get pluginName(){return"HeadingElementSupport"}init(){const e=this.editor;if(!e.plugins.has("HeadingEditing"))return;const t=e.config.get("heading.options");this.registerHeadingElements(e,t)}registerHeadingElements(e,t){const n=e.plugins.get(Ni),s=[];for(const o of t)"model"in o&&"view"in o&&(n.registerBlockElement({view:o.view,model:o.model}),s.push(o.model));n.extendBlockElement({model:"htmlHgroup",modelSchema:{allowChildren:s}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ir(i,e,t){const n=i.createRangeOn(e);for(const{item:s}of n.getWalker())if(s.is("element",t))return s}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class uP extends y{static get requires(){return[ge]}static get pluginName(){return"ImageElementSupport"}init(){const e=this.editor;if(!e.plugins.has("ImageInlineEditing")&&!e.plugins.has("ImageBlockEditing"))return;const t=e.model.schema,n=e.conversion,s=e.plugins.get(ge);s.on("register:figure",()=>{n.for("upcast").add(fP(s))}),s.on("register:img",(o,r)=>{r.model!=="imageBlock"&&r.model!=="imageInline"||(t.isRegistered("imageBlock")&&t.extend("imageBlock",{allowAttributes:["htmlImgAttributes","htmlFigureAttributes","htmlLinkAttributes"]}),t.isRegistered("imageInline")&&t.extend("imageInline",{allowAttributes:["htmlA","htmlImgAttributes"]}),n.for("upcast").add(dP(s)),n.for("downcast").add(mP()),e.plugins.has("LinkImage")&&n.for("upcast").add(hP(s,e)),o.stop())})}}function dP(i){return e=>{e.on("element:img",(t,n,s)=>{if(!n.modelRange)return;const o=n.viewItem,r=i.processViewAttributes(o,s);r&&s.writer.setAttribute("htmlImgAttributes",r,n.modelRange)},{priority:"low"})}}function hP(i,e){const t=e.plugins.get("ImageUtils");return n=>{n.on("element:a",(s,o,r)=>{const a=o.viewItem;if(!t.findViewImgElement(a))return;const c=o.modelCursor.parent;if(!c.is("element","imageBlock"))return;const u=i.processViewAttributes(a,r);u&&r.writer.setAttribute("htmlLinkAttributes",u,c)},{priority:"low"})}}function fP(i){return e=>{e.on("element:figure",(t,n,s)=>{const o=n.viewItem;if(!n.modelRange||!o.hasClass("image"))return;const r=i.processViewAttributes(o,s);r&&s.writer.setAttribute("htmlFigureAttributes",r,n.modelRange)},{priority:"low"})}}function mP(){return i=>{e("htmlImgAttributes"),t("img","htmlImgAttributes"),t("figure","htmlFigureAttributes"),t("a","htmlLinkAttributes");function e(n){i.on(`attribute:${n}:imageInline`,(s,o,r)=>{if(!r.consumable.consume(o.item,s.name))return;const{attributeOldValue:a,attributeNewValue:l}=o,c=r.mapper.toViewElement(o.item);Un(r.writer,a,l,c)},{priority:"low"})}function t(n,s){i.on(`attribute:${s}:imageBlock`,(o,r,a)=>{if(!a.consumable.test(r.item,o.name))return;const{attributeOldValue:l,attributeNewValue:c}=r,u=a.mapper.toViewElement(r.item),d=Ir(a.writer,u,n);d&&(Un(a.writer,l,c,d),a.consumable.consume(r.item,o.name))},{priority:"low"}),n==="a"&&i.on("attribute:linkHref:imageBlock",(o,r,a)=>{if(!a.consumable.consume(r.item,"attribute:htmlLinkAttributes:imageBlock"))return;const l=a.mapper.toViewElement(r.item),c=Ir(a.writer,l,"a");Dt(a.writer,r.item.getAttribute("htmlLinkAttributes"),c)},{priority:"low"})}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class gP extends y{static get requires(){return[ge]}static get pluginName(){return"MediaEmbedElementSupport"}init(){const e=this.editor;if(!e.plugins.has("MediaEmbed")||e.config.get("mediaEmbed.previewsInData"))return;const t=e.model.schema,n=e.conversion,s=this.editor.plugins.get(ge),o=this.editor.plugins.get(Ni),r=e.config.get("mediaEmbed.elementName");o.registerBlockElement({model:"media",view:r}),s.on("register:figure",()=>{n.for("upcast").add(bP(s))}),s.on(`register:${r}`,(a,l)=>{l.model==="media"&&(t.extend("media",{allowAttributes:[ut(r),"htmlFigureAttributes"]}),n.for("upcast").add(pP(s,r)),n.for("dataDowncast").add(wP(r)),a.stop())})}}function pP(i,e){const t=(n,s,o)=>{const r=s.viewItem;a(r,ut(e));function a(l,c){const u=i.processViewAttributes(l,o);u&&o.writer.setAttribute(c,u,s.modelRange)}};return n=>{n.on(`element:${e}`,t,{priority:"low"})}}function bP(i){return e=>{e.on("element:figure",(t,n,s)=>{const o=n.viewItem;if(!n.modelRange||!o.hasClass("media"))return;const r=i.processViewAttributes(o,s);r&&s.writer.setAttribute("htmlFigureAttributes",r,n.modelRange)},{priority:"low"})}}function wP(i){return e=>{t(i,ut(i)),t("figure","htmlFigureAttributes");function t(n,s){e.on(`attribute:${s}:media`,(o,r,a)=>{if(!a.consumable.consume(r.item,o.name))return;const{attributeOldValue:l,attributeNewValue:c}=r,u=a.mapper.toViewElement(r.item),d=Ir(a.writer,u,n);Un(a.writer,l,c,d)})}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _P extends y{static get requires(){return[ge]}static get pluginName(){return"ScriptElementSupport"}init(){const e=this.editor.plugins.get(ge);e.on("register:script",(t,n)=>{const s=this.editor,o=s.model.schema,r=s.conversion;o.register("htmlScript",n.modelSchema),o.extend("htmlScript",{allowAttributes:["htmlScriptAttributes","htmlContent"],isContent:!0}),s.data.registerRawContentMatcher({name:"script"}),r.for("upcast").elementToElement({view:"script",model:ac(n)}),r.for("upcast").add(js(n,e)),r.for("downcast").elementToElement({model:"htmlScript",view:(a,{writer:l})=>Sr("script",a,l)}),r.for("downcast").add(qs(n)),t.stop()})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class vP extends y{static get requires(){return[ge]}static get pluginName(){return"TableElementSupport"}init(){const e=this.editor;if(!e.plugins.has("TableEditing"))return;const t=e.model.schema,n=e.conversion,s=e.plugins.get(ge),o=e.plugins.get("TableUtils");s.on("register:figure",()=>{n.for("upcast").add(kP(s))}),s.on("register:table",(r,a)=>{a.model==="table"&&(t.extend("table",{allowAttributes:["htmlTableAttributes","htmlFigureAttributes","htmlTheadAttributes","htmlTbodyAttributes"]}),n.for("upcast").add(CP(s)),n.for("downcast").add(TP()),e.model.document.registerPostFixer(yP(e.model,o)),r.stop())})}}function yP(i,e){return t=>{const n=i.document.differ.getChanges();let s=!1;for(const o of n){if(o.type!="attribute"||o.attributeKey!="headingRows")continue;const r=o.range.start.nodeAfter,a=r.getAttribute("htmlTheadAttributes"),l=r.getAttribute("htmlTbodyAttributes");a&&!o.attributeNewValue?(t.removeAttribute("htmlTheadAttributes",r),s=!0):l&&o.attributeNewValue==e.getRows(r)&&(t.removeAttribute("htmlTbodyAttributes",r),s=!0)}return s}}function CP(i){return e=>{e.on("element:table",(t,n,s)=>{if(!n.modelRange)return;const o=n.viewItem;r(o,"htmlTableAttributes");for(const a of o.getChildren())a.is("element","thead")&&r(a,"htmlTheadAttributes"),a.is("element","tbody")&&r(a,"htmlTbodyAttributes");function r(a,l){const c=i.processViewAttributes(a,s);c&&s.writer.setAttribute(l,c,n.modelRange)}},{priority:"low"})}}function kP(i){return e=>{e.on("element:figure",(t,n,s)=>{const o=n.viewItem;if(!n.modelRange||!o.hasClass("table"))return;const r=i.processViewAttributes(o,s);r&&s.writer.setAttribute("htmlFigureAttributes",r,n.modelRange)},{priority:"low"})}}function TP(){return i=>{e("table","htmlTableAttributes"),e("figure","htmlFigureAttributes"),e("thead","htmlTheadAttributes"),e("tbody","htmlTbodyAttributes");function e(t,n){i.on(`attribute:${n}:table`,(s,o,r)=>{if(!r.consumable.test(o.item,s.name))return;const a=r.mapper.toViewElement(o.item),l=Ir(r.writer,a,t);l&&(r.consumable.consume(o.item,s.name),Un(r.writer,o.attributeOldValue,o.attributeNewValue,l))})}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class EP extends y{static get requires(){return[ge]}static get pluginName(){return"StyleElementSupport"}init(){const e=this.editor.plugins.get(ge);e.on("register:style",(t,n)=>{const s=this.editor,o=s.model.schema,r=s.conversion;o.register("htmlStyle",n.modelSchema),o.extend("htmlStyle",{allowAttributes:["htmlStyleAttributes","htmlContent"],isContent:!0}),s.data.registerRawContentMatcher({name:"style"}),r.for("upcast").elementToElement({view:"style",model:ac(n)}),r.for("upcast").add(js(n,e)),r.for("downcast").elementToElement({model:"htmlStyle",view:(a,{writer:l})=>Sr("style",a,l)}),r.for("downcast").add(qs(n)),t.stop()})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class AP extends y{static get requires(){return[ge]}static get pluginName(){return"ListElementSupport"}init(){const e=this.editor;if(!e.plugins.has("ListEditing"))return;const t=e.model.schema,n=e.conversion,s=e.plugins.get(ge),o=e.plugins.get("ListEditing"),r=e.plugins.get("ListUtils"),a=["ul","ol","li"];o.registerDowncastStrategy({scope:"item",attributeName:"htmlLiAttributes",setAttributeOnDowncast:Dt}),o.registerDowncastStrategy({scope:"list",attributeName:"htmlUlAttributes",setAttributeOnDowncast:Dt}),o.registerDowncastStrategy({scope:"list",attributeName:"htmlOlAttributes",setAttributeOnDowncast:Dt}),s.on("register",(l,c)=>{if(!a.includes(c.view)||(l.stop(),t.checkAttribute("$block","htmlLiAttributes")))return;const u=a.map(d=>ut(d));t.extend("$listItem",{allowAttributes:u}),n.for("upcast").add(d=>{d.on("element:ul",cc("htmlUlAttributes",s),{priority:"low"}),d.on("element:ol",cc("htmlOlAttributes",s),{priority:"low"}),d.on("element:li",cc("htmlLiAttributes",s),{priority:"low"})})}),o.on("postFixer",(l,{listNodes:c,writer:u})=>{for(const{node:d,previousNodeInList:h}of c)if(h){if(h.getAttribute("listType")==d.getAttribute("listType")){const f=gp(h.getAttribute("listType")),m=h.getAttribute(f);!ci(d.getAttribute(f),m)&&u.model.schema.checkAttribute(d,f)&&(u.setAttribute(f,m,d),l.return=!0)}if(h.getAttribute("listItemId")==d.getAttribute("listItemId")){const f=h.getAttribute("htmlLiAttributes");!ci(d.getAttribute("htmlLiAttributes"),f)&&u.model.schema.checkAttribute(d,"htmlLiAttributes")&&(u.setAttribute("htmlLiAttributes",f,d),l.return=!0)}}}),o.on("postFixer",(l,{listNodes:c,writer:u})=>{for(const{node:d}of c){const h=d.getAttribute("listType");!r.isNumberedListType(h)&&d.getAttribute("htmlOlAttributes")&&(u.removeAttribute("htmlOlAttributes",d),l.return=!0),r.isNumberedListType(h)&&d.getAttribute("htmlUlAttributes")&&(u.removeAttribute("htmlUlAttributes",d),l.return=!0)}})}afterInit(){const e=this.editor;if(!e.commands.get("indentList"))return;const t=e.commands.get("indentList");this.listenTo(t,"afterExecute",(n,s)=>{e.model.change(o=>{for(const r of s){const a=gp(r.getAttribute("listType"));e.model.schema.checkAttribute(r,a)&&o.setAttribute(a,{},r)}})})}}function cc(i,e){return(t,n,s)=>{const o=n.viewItem;n.modelRange||Object.assign(n,s.convertChildren(n.viewItem,n.modelCursor));const r=e.processViewAttributes(o,s);for(const a of n.modelRange.getItems({shallow:!0}))a.hasAttribute("listItemId")&&(a.hasAttribute("htmlUlAttributes")||a.hasAttribute("htmlOlAttributes")||s.writer.model.schema.checkAttribute(a,i)&&s.writer.setAttribute(i,r||{},a))}}function gp(i){return i==="numbered"||i=="customNumbered"?"htmlOlAttributes":"htmlUlAttributes"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class xP extends y{static get requires(){return[ge,Ni]}static get pluginName(){return"CustomElementSupport"}init(){const e=this.editor.plugins.get(ge),t=this.editor.plugins.get(Ni);e.on("register:$customElement",(n,s)=>{n.stop();const o=this.editor,r=o.model.schema,a=o.conversion,l=o.editing.view.domConverter.unsafeElements,c=o.data.htmlProcessor.domConverter.preElements;r.register(s.model,s.modelSchema),r.extend(s.model,{allowAttributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"],isContent:!0}),o.data.htmlProcessor.domConverter.registerRawContentMatcher({name:"template"}),a.for("upcast").elementToElement({view:/.*/,model:(u,d)=>{if(u.name=="$comment"||!SP(u.name)||t.getDefinitionsForView(u.name).size)return null;l.includes(u.name)||l.push(u.name),c.includes(u.name)||c.push(u.name);const h=d.writer.createElement(s.model,{htmlElementName:u.name}),f=e.processViewAttributes(u,d);f&&d.writer.setAttribute("htmlCustomElementAttributes",f,h);let m;if(u.is("element","template")&&u.getCustomProperty("$rawContent"))m=u.getCustomProperty("$rawContent");else{const b=new Ye(u.document).createDocumentFragment(u),_=o.data.htmlProcessor.domConverter.viewToDom(b),T=_.firstChild;for(;T.firstChild;)_.appendChild(T.firstChild);T.remove(),m=o.data.htmlProcessor.htmlWriter.getHtml(_)}d.writer.setAttribute("htmlContent",m,h);for(const{item:g}of o.editing.view.createRangeIn(u))d.consumable.consume(g,{name:!0});return h},converterPriority:"low"}),a.for("editingDowncast").elementToElement({model:{name:s.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:(u,{writer:d})=>{const h=u.getAttribute("htmlElementName"),f=d.createRawElement(h);return u.hasAttribute("htmlCustomElementAttributes")&&Dt(d,u.getAttribute("htmlCustomElementAttributes"),f),f}}),a.for("dataDowncast").elementToElement({model:{name:s.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:(u,{writer:d})=>{const h=u.getAttribute("htmlElementName"),f=u.getAttribute("htmlContent"),m=d.createRawElement(h,null,(g,b)=>{b.setContentOf(g,f)});return u.hasAttribute("htmlCustomElementAttributes")&&Dt(d,u.getAttribute("htmlCustomElementAttributes"),m),m}})})}}function SP(i){try{document.createElement(i)}catch{return!1}return!0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class IP extends y{static get pluginName(){return"GeneralHtmlSupport"}static get requires(){return[ge,oP,lP,cP,uP,gP,_P,vP,EP,AP,xP]}init(){const e=this.editor,t=e.plugins.get(ge);t.loadAllowedEmptyElementsConfig(e.config.get("htmlSupport.allowEmpty")||[]),t.loadAllowedConfig(e.config.get("htmlSupport.allow")||[]),t.loadDisallowedConfig(e.config.get("htmlSupport.disallow")||[])}getGhsAttributeNameForElement(e){const t=this.editor.plugins.get("DataSchema"),n=Array.from(t.getDefinitionsForView(e,!1)),s=n.find(o=>o.isInline&&!n[0].isObject);return s?s.model:ut(e)}addModelHtmlClass(e,t,n){const s=this.editor.model,o=this.getGhsAttributeNameForElement(e);s.change(r=>{for(const a of Fi(s,n,o))Di(r,a,o,"classes",l=>{for(const c of J(t))l.add(c)})})}removeModelHtmlClass(e,t,n){const s=this.editor.model,o=this.getGhsAttributeNameForElement(e);s.change(r=>{for(const a of Fi(s,n,o))Di(r,a,o,"classes",l=>{for(const c of J(t))l.delete(c)})})}setModelHtmlAttributes(e,t,n){const s=this.editor.model,o=this.getGhsAttributeNameForElement(e);s.change(r=>{for(const a of Fi(s,n,o))Di(r,a,o,"attributes",l=>{for(const[c,u]of Object.entries(t))l.set(c,u)})})}removeModelHtmlAttributes(e,t,n){const s=this.editor.model,o=this.getGhsAttributeNameForElement(e);s.change(r=>{for(const a of Fi(s,n,o))Di(r,a,o,"attributes",l=>{for(const c of J(t))l.delete(c)})})}setModelHtmlStyles(e,t,n){const s=this.editor.model,o=this.getGhsAttributeNameForElement(e);s.change(r=>{for(const a of Fi(s,n,o))Di(r,a,o,"styles",l=>{for(const[c,u]of Object.entries(t))l.set(c,u)})})}removeModelHtmlStyles(e,t,n){const s=this.editor.model,o=this.getGhsAttributeNameForElement(e);s.change(r=>{for(const a of Fi(s,n,o))Di(r,a,o,"styles",l=>{for(const c of J(t))l.delete(c)})})}}function*Fi(i,e,t){if(e)if(!(Symbol.iterator in e)&&e.is("documentSelection")&&e.isCollapsed)i.schema.checkAttributeInSelection(e,t)&&(yield e);else for(const n of PP(i,e,t))yield*n.getItems({shallow:!0})}function PP(i,e,t){return!(Symbol.iterator in e)&&(e.is("node")||e.is("$text")||e.is("$textProxy"))?i.schema.checkAttribute(e,t)?[i.createRangeOn(e)]:[]:i.schema.getValidRanges(i.createSelection(e).getRanges(),t)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function pp(i){return i.createContainerElement("figure",{class:"image"},[i.createEmptyElement("img"),i.createSlot("children")])}function RP(i,e){const t=i.plugins.get("ImageUtils"),n=i.plugins.has("ImageInlineEditing")&&i.plugins.has("ImageBlockEditing");return o=>t.isInlineImageView(o)?n&&(o.getStyle("display")=="block"||o.findAncestor(t.isBlockImageView)?"imageBlock":"imageInline")!==e?null:s(o):null;function s(o){const r={name:!0};return o.hasAttribute("src")&&(r.attributes=["src"]),r}}function bp(i,e){const t=ce(e.getSelectedBlocks());return!t||i.isObject(t)||t.isEmpty&&t.name!="listItem"?"imageBlock":"imageInline"}function Pr(i){return i&&i.endsWith("px")?parseInt(i):null}function Rr(i){const e=Pr(i.getStyle("width")),t=Pr(i.getStyle("height"));return!!(e&&t)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const MP=/^(image|image-inline)$/;class Nt extends y{constructor(){super(...arguments),this._domEmitter=new(qe())}static get pluginName(){return"ImageUtils"}isImage(e){return this.isInlineImage(e)||this.isBlockImage(e)}isInlineImageView(e){return!!e&&e.is("element","img")}isBlockImageView(e){return!!e&&e.is("element","figure")&&e.hasClass("image")}insertImage(e={},t=null,n=null,s={}){const o=this.editor,r=o.model,a=r.document.selection,l=wp(o,t||a,n);e={...Object.fromEntries(a.getAttributes()),...e};for(const c in e)r.schema.checkAttribute(l,c)||delete e[c];return r.change(c=>{const{setImageSizes:u=!0}=s,d=c.createElement(l,e);return r.insertObject(d,t,null,{setSelection:"on",findOptimalPosition:!t&&l!="imageInline"?"auto":void 0}),d.parent?(u&&this.setImageNaturalSizeAttributes(d),d):null})}setImageNaturalSizeAttributes(e){const t=e.getAttribute("src");t&&(e.getAttribute("width")||e.getAttribute("height")||this.editor.model.change(n=>{const s=new I.window.Image;this._domEmitter.listenTo(s,"load",()=>{!e.getAttribute("width")&&!e.getAttribute("height")&&this.editor.model.enqueueChange(n.batch,o=>{o.setAttribute("width",s.naturalWidth,e),o.setAttribute("height",s.naturalHeight,e)}),this._domEmitter.stopListening(s,"load")}),s.src=t}))}getClosestSelectedImageWidget(e){const t=e.getFirstPosition();if(!t)return null;const n=e.getSelectedElement();if(n&&this.isImageWidget(n))return n;let s=t.parent;for(;s;){if(s.is("element")&&this.isImageWidget(s))return s;s=s.parent}return null}getClosestSelectedImageElement(e){const t=e.getSelectedElement();return this.isImage(t)?t:e.getFirstPosition().findAncestor("imageBlock")}getImageWidgetFromImageView(e){return e.findAncestor({classes:MP})}isImageAllowed(){const t=this.editor.model.document.selection;return BP(this.editor,t)&&OP(t)}toImageWidget(e,t,n){return t.setCustomProperty("image",!0,e),Ws(e,t,{label:()=>{const r=this.findViewImgElement(e).getAttribute("alt");return r?`${r} ${n}`:n}})}isImageWidget(e){return!!e.getCustomProperty("image")&&me(e)}isBlockImage(e){return!!e&&e.is("element","imageBlock")}isInlineImage(e){return!!e&&e.is("element","imageInline")}findViewImgElement(e){if(this.isInlineImageView(e))return e;const t=this.editor.editing.view;for(const{item:n}of t.createRangeIn(e))if(this.isInlineImageView(n))return n}destroy(){return this._domEmitter.stopListening(),super.destroy()}}function BP(i,e){if(wp(i,e,null)=="imageBlock"){const n=LP(e,i.model);if(i.model.schema.checkChild(n,"imageBlock"))return!0}else if(i.model.schema.checkChild(e.focus,"imageInline"))return!0;return!1}function OP(i){return[...i.focus.getAncestors()].every(e=>!e.is("element","imageBlock"))}function LP(i,e){const n=UI(i,e).start.parent;return n.isEmpty&&!n.is("element","$root")?n.parent:n}function wp(i,e,t){const n=i.model.schema,s=i.config.get("image.insert.type");return i.plugins.has("ImageBlockEditing")?i.plugins.has("ImageInlineEditing")?t||(s==="inline"?"imageInline":s!=="auto"?"imageBlock":e.is("selection")?bp(n,e):n.checkChild(e,"imageInline")?"imageInline":"imageBlock"):"imageBlock":"imageInline"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function VP(i){const e=(t,n,s)=>{if(!s.consumable.test(n.viewItem,{name:!0,classes:"image"}))return;const o=i.findViewImgElement(n.viewItem);if(!o||!s.consumable.test(o,{name:!0}))return;s.consumable.consume(n.viewItem,{name:!0,classes:"image"});const r=s.convertItem(o,n.modelCursor),a=ce(r.modelRange.getItems());if(!a){s.consumable.revert(n.viewItem,{name:!0,classes:"image"});return}s.convertChildren(n.viewItem,a),s.updateConversionResult(a,n)};return t=>{t.on("element:figure",e)}}function DP(i,e){const t=(n,s,o)=>{if(!o.consumable.consume(s.item,n.name))return;const r=o.writer,a=o.mapper.toViewElement(s.item),l=i.findViewImgElement(a);s.attributeNewValue===null?(r.removeAttribute("srcset",l),r.removeAttribute("sizes",l)):s.attributeNewValue&&(r.setAttribute("srcset",s.attributeNewValue,l),r.setAttribute("sizes","100vw",l))};return n=>{n.on(`attribute:srcset:${e}`,t)}}function _p(i,e,t){const n=(s,o,r)=>{if(!r.consumable.consume(o.item,s.name))return;const a=r.writer,l=r.mapper.toViewElement(o.item),c=i.findViewImgElement(l);a.setAttribute(o.attributeKey,o.attributeNewValue||"",c)};return s=>{s.on(`attribute:${t}:${e}`,n)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class vp extends Pt{observe(e){this.listenTo(e,"load",(t,n)=>{const s=n.target;this.checkShouldIgnoreEventFromTarget(s)||s.tagName=="IMG"&&this._fireEvents(n)},{useCapture:!0})}stopObserving(e){this.stopListening(e)}_fireEvents(e){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",e))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class NP extends F{constructor(e){super(e);const t=e.config.get("image.insert.type");e.plugins.has("ImageBlockEditing")||t==="block"&&Q("image-block-plugin-required"),e.plugins.has("ImageInlineEditing")||t==="inline"&&Q("image-inline-plugin-required")}refresh(){const e=this.editor.plugins.get("ImageUtils");this.isEnabled=e.isImageAllowed()}execute(e){const t=J(e.source),n=this.editor.model.document.selection,s=this.editor.plugins.get("ImageUtils"),o=Object.fromEntries(n.getAttributes());t.forEach((r,a)=>{const l=n.getSelectedElement();if(typeof r=="string"&&(r={src:r}),a&&l&&s.isImage(l)){const c=this.editor.model.createPositionAfter(l);s.insertImage({...r,...o},c)}else s.insertImage({...r,...o})})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class FP extends F{constructor(e){super(e),this.decorate("cleanupImage")}refresh(){const t=this.editor.plugins.get("ImageUtils"),n=this.editor.model.document.selection.getSelectedElement();this.isEnabled=t.isImage(n),this.value=this.isEnabled?n.getAttribute("src"):null}execute(e){const t=this.editor.model.document.selection.getSelectedElement(),n=this.editor.plugins.get("ImageUtils");this.editor.model.change(s=>{s.setAttribute("src",e.source,t),this.cleanupImage(s,t),n.setImageNaturalSizeAttributes(t)})}cleanupImage(e,t){e.removeAttribute("srcset",t),e.removeAttribute("sizes",t),e.removeAttribute("sources",t),e.removeAttribute("width",t),e.removeAttribute("height",t),e.removeAttribute("alt",t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class yp extends y{static get requires(){return[Nt]}static get pluginName(){return"ImageEditing"}init(){const e=this.editor,t=e.conversion;e.editing.view.addObserver(vp),t.for("upcast").attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:"srcset"});const n=new NP(e),s=new FP(e);e.commands.add("insertImage",n),e.commands.add("replaceImageSource",s),e.commands.add("imageInsert",n)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $P extends y{static get requires(){return[Nt]}static get pluginName(){return"ImageSizeAttributes"}afterInit(){this._registerSchema(),this._registerConverters("imageBlock"),this._registerConverters("imageInline")}_registerSchema(){this.editor.plugins.has("ImageBlockEditing")&&this.editor.model.schema.extend("imageBlock",{allowAttributes:["width","height"]}),this.editor.plugins.has("ImageInlineEditing")&&this.editor.model.schema.extend("imageInline",{allowAttributes:["width","height"]})}_registerConverters(e){const t=this.editor,n=t.plugins.get("ImageUtils"),s=e==="imageBlock"?"figure":"img";t.conversion.for("upcast").attributeToAttribute({view:{name:s,styles:{width:/.+/}},model:{key:"width",value:r=>Rr(r)?Pr(r.getStyle("width")):null}}).attributeToAttribute({view:{name:s,key:"width"},model:"width"}).attributeToAttribute({view:{name:s,styles:{height:/.+/}},model:{key:"height",value:r=>Rr(r)?Pr(r.getStyle("height")):null}}).attributeToAttribute({view:{name:s,key:"height"},model:"height"}),t.conversion.for("editingDowncast").add(r=>{o(r,"width","width",!0),o(r,"height","height",!0)}),t.conversion.for("dataDowncast").add(r=>{o(r,"width","width",!1),o(r,"height","height",!1)});function o(r,a,l,c){r.on(`attribute:${a}:${e}`,(u,d,h)=>{if(!h.consumable.consume(d.item,u.name))return;const f=h.writer,m=h.mapper.toViewElement(d.item),g=n.findViewImgElement(m);if(d.attributeNewValue!==null?f.setAttribute(l,d.attributeNewValue,g):f.removeAttribute(l,g),d.item.hasAttribute("sources"))return;const b=d.item.hasAttribute("resizedWidth");if(e==="imageInline"&&!b&&!c)return;const _=d.item.getAttribute("width"),T=d.item.getAttribute("height");_&&T&&f.setStyle("aspect-ratio",`${_}/${T}`,g)})}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class UP extends F{constructor(e,t){super(e),this._modelElementName=t}refresh(){const t=this.editor.plugins.get("ImageUtils"),n=t.getClosestSelectedImageElement(this.editor.model.document.selection);this._modelElementName==="imageBlock"?this.isEnabled=t.isInlineImage(n):this.isEnabled=t.isBlockImage(n)}execute(e={}){const t=this.editor,n=this.editor.model,s=t.plugins.get("ImageUtils"),o=s.getClosestSelectedImageElement(n.document.selection),r=Object.fromEntries(o.getAttributes());return!r.src&&!r.uploadId?null:n.change(a=>{const{setImageSizes:l=!0}=e,c=Array.from(n.markers).filter(h=>h.getRange().containsItem(o)),u=s.insertImage(r,n.createSelection(o,"on"),this._modelElementName,{setImageSizes:l});if(!u)return null;const d=a.createRangeOn(u);for(const h of c){const f=h.getRange(),m=f.root.rootName!="$graveyard"?f.getJoined(d,!0):d;a.updateMarker(h,{range:m})}return{oldElement:o,newElement:u}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class zP extends y{static get requires(){return[Nt]}static get pluginName(){return"ImagePlaceholder"}afterInit(){this._setupSchema(),this._setupConversion(),this._setupLoadListener()}_setupSchema(){const e=this.editor.model.schema;e.isRegistered("imageBlock")&&e.extend("imageBlock",{allowAttributes:["placeholder"]}),e.isRegistered("imageInline")&&e.extend("imageInline",{allowAttributes:["placeholder"]})}_setupConversion(){const e=this.editor,t=e.conversion,n=e.plugins.get("ImageUtils");t.for("editingDowncast").add(s=>{s.on("attribute:placeholder",(o,r,a)=>{if(!a.consumable.test(r.item,o.name)||!r.item.is("element","imageBlock")&&!r.item.is("element","imageInline"))return;a.consumable.consume(r.item,o.name);const l=a.writer,c=a.mapper.toViewElement(r.item),u=n.findViewImgElement(c);r.attributeNewValue?(l.addClass("image_placeholder",u),l.setStyle("background-image",`url(${r.attributeNewValue})`,u),l.setCustomProperty("editingPipeline:doNotReuseOnce",!0,u)):(l.removeClass("image_placeholder",u),l.removeStyle("background-image",u))})})}_setupLoadListener(){const e=this.editor,t=e.model,n=e.editing,s=n.view,o=e.plugins.get("ImageUtils");s.addObserver(vp),this.listenTo(s.document,"imageLoaded",(r,a)=>{const l=s.domConverter.mapDomToView(a.target);if(!l)return;const c=o.getImageWidgetFromImageView(l);if(!c)return;const u=n.mapper.toModelElement(c);!u||!u.hasAttribute("placeholder")||t.enqueueChange({isUndoable:!1},d=>{d.removeAttribute("placeholder",u)})})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Cp extends y{static get requires(){return[yp,$P,Nt,zP,Vt]}static get pluginName(){return"ImageBlockEditing"}init(){const e=this.editor;e.model.schema.register("imageBlock",{inheritAllFrom:"$blockObject",allowAttributes:["alt","src","srcset"]}),this._setupConversion(),e.plugins.has("ImageInlineEditing")&&(e.commands.add("imageTypeBlock",new UP(this.editor,"imageBlock")),this._setupClipboardIntegration())}_setupConversion(){const e=this.editor,t=e.t,n=e.conversion,s=e.plugins.get("ImageUtils");n.for("dataDowncast").elementToStructure({model:"imageBlock",view:(o,{writer:r})=>pp(r)}),n.for("editingDowncast").elementToStructure({model:"imageBlock",view:(o,{writer:r})=>s.toImageWidget(pp(r),r,t("image widget"))}),n.for("downcast").add(_p(s,"imageBlock","src")).add(_p(s,"imageBlock","alt")).add(DP(s,"imageBlock")),n.for("upcast").elementToElement({view:RP(e,"imageBlock"),model:(o,{writer:r})=>r.createElement("imageBlock",o.hasAttribute("src")?{src:o.getAttribute("src")}:void 0)}).add(VP(s))}_setupClipboardIntegration(){const e=this.editor,t=e.model,n=e.editing.view,s=e.plugins.get("ImageUtils"),o=e.plugins.get("ClipboardPipeline");this.listenTo(o,"inputTransformation",(r,a)=>{const l=Array.from(a.content.getChildren());let c;if(!l.every(s.isInlineImageView))return;a.targetRanges?c=e.editing.mapper.toModelRange(a.targetRanges[0]):c=t.document.selection.getFirstRange();const u=t.createSelection(c);if(bp(t.schema,u)==="imageBlock"){const d=new Ye(n.document),h=l.map(f=>d.createElement("figure",{class:"image"},f));a.content=d.createDocumentFragment(h)}}),this.listenTo(o,"contentInsertion",(r,a)=>{a.method==="paste"&&t.change(l=>{const c=l.createRangeIn(a.content);for(const u of c.getItems())u.is("element","imageBlock")&&s.setImageNaturalSizeAttributes(u)})})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class kp extends y{static get pluginName(){return"ImageCaptionUtils"}static get requires(){return[Nt]}getCaptionFromImageModelElement(e){for(const t of e.getChildren())if(t&&t.is("element","caption"))return t;return null}getCaptionFromModelSelection(e){const t=this.editor.plugins.get("ImageUtils"),n=e.getFirstPosition().findAncestor("caption");return n&&t.isBlockImage(n.parent)?n:null}matchImageCaptionViewElement(e){const t=this.editor.plugins.get("ImageUtils");return e.name=="figcaption"&&t.isBlockImageView(e.parent)?{name:!0}:null}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class HP extends F{refresh(){const e=this.editor,t=e.plugins.get("ImageCaptionUtils"),n=e.plugins.get("ImageUtils");if(!e.plugins.has(Cp)){this.isEnabled=!1,this.value=!1;return}const s=e.model.document.selection,o=s.getSelectedElement();if(!o){const r=t.getCaptionFromModelSelection(s);this.isEnabled=!!r,this.value=!!r;return}this.isEnabled=n.isImage(o),this.isEnabled?this.value=!!t.getCaptionFromImageModelElement(o):this.value=!1}execute(e={}){const{focusCaptionOnShow:t}=e;this.editor.model.change(n=>{this.value?this._hideImageCaption(n):this._showImageCaption(n,t)})}_showImageCaption(e,t){const s=this.editor.model.document.selection,o=this.editor.plugins.get("ImageCaptionEditing"),r=this.editor.plugins.get("ImageUtils");let a=s.getSelectedElement();const l=o._getSavedCaption(a);r.isInlineImage(a)&&(this.editor.execute("imageTypeBlock"),a=s.getSelectedElement());const c=l||e.createElement("caption");e.append(c,a),t&&e.setSelection(c,"in")}_hideImageCaption(e){const t=this.editor,n=t.model.document.selection,s=t.plugins.get("ImageCaptionEditing"),o=t.plugins.get("ImageCaptionUtils");let r=n.getSelectedElement(),a;r?a=o.getCaptionFromImageModelElement(r):(a=o.getCaptionFromModelSelection(n),r=a.parent),s._saveCaption(r,a),e.setSelection(r,"on"),e.remove(a)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class WP extends y{static get requires(){return[Nt,kp]}static get pluginName(){return"ImageCaptionEditing"}constructor(e){super(e),this._savedCaptionsMap=new WeakMap}init(){const e=this.editor,t=e.model.schema;t.isRegistered("caption")?t.extend("caption",{allowIn:"imageBlock"}):t.register("caption",{allowIn:"imageBlock",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleImageCaption",new HP(this.editor)),this._setupConversion(),this._setupImageTypeCommandsIntegration(),this._registerCaptionReconversion()}_setupConversion(){const e=this.editor,t=e.editing.view,n=e.plugins.get("ImageUtils"),s=e.plugins.get("ImageCaptionUtils"),o=e.t;e.conversion.for("upcast").elementToElement({view:r=>s.matchImageCaptionViewElement(r),model:"caption"}),e.conversion.for("dataDowncast").elementToElement({model:"caption",view:(r,{writer:a})=>n.isBlockImage(r.parent)?a.createContainerElement("figcaption"):null}),e.conversion.for("editingDowncast").elementToElement({model:"caption",view:(r,{writer:a})=>{if(!n.isBlockImage(r.parent))return null;const l=a.createEditableElement("figcaption");a.setCustomProperty("imageCaption",!0,l),l.placeholder=o("Enter image caption"),Oo({view:t,element:l,keepOnFocus:!0});const c=r.parent.getAttribute("alt"),u=c?o("Caption for image: %0",[c]):o("Caption for the image");return sc(l,a,{label:u})}})}_setupImageTypeCommandsIntegration(){const e=this.editor,t=e.plugins.get("ImageUtils"),n=e.plugins.get("ImageCaptionUtils"),s=e.commands.get("imageTypeInline"),o=e.commands.get("imageTypeBlock"),r=a=>{if(!a.return)return;const{oldElement:l,newElement:c}=a.return;/* istanbul ignore if: paranoid check -- @preserve */if(!l)return;if(t.isBlockImage(l)){const d=n.getCaptionFromImageModelElement(l);if(d){this._saveCaption(c,d);return}}const u=this._getSavedCaption(l);u&&this._saveCaption(c,u)};s&&this.listenTo(s,"execute",r,{priority:"low"}),o&&this.listenTo(o,"execute",r,{priority:"low"})}_getSavedCaption(e){const t=this._savedCaptionsMap.get(e);return t?Y.fromJSON(t):null}_saveCaption(e,t){this._savedCaptionsMap.set(e,t.toJSON())}_registerCaptionReconversion(){const e=this.editor,t=e.model,n=e.plugins.get("ImageUtils"),s=e.plugins.get("ImageCaptionUtils");t.document.on("change:data",()=>{const o=t.document.differ.getChanges();for(const r of o){if(r.attributeKey!=="alt")continue;const a=r.range.start.nodeAfter;if(n.isBlockImage(a)){const l=s.getCaptionFromImageModelElement(a);if(!l)return;e.editing.reconvertItem(l)}}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class jP extends y{static get requires(){return[kp]}static get pluginName(){return"ImageCaptionUI"}init(){const e=this.editor,t=e.editing.view,n=e.plugins.get("ImageCaptionUtils"),s=e.t;e.ui.componentFactory.add("toggleImageCaption",o=>{const r=e.commands.get("toggleImageCaption"),a=new N(o);return a.set({icon:P.caption,tooltip:!0,isToggleable:!0}),a.bind("isOn","isEnabled").to(r,"value","isEnabled"),a.bind("label").to(r,"value",l=>s(l?"Toggle caption off":"Toggle caption on")),this.listenTo(a,"execute",()=>{e.execute("toggleImageCaption",{focusCaptionOnShow:!0});const l=n.getCaptionFromModelSelection(e.model.document.selection);if(l){const c=e.editing.mapper.toViewElement(l);t.scrollToTheSelection(),t.change(u=>{u.addClass("image__caption_highlighted",c)})}e.editing.view.focus()}),a})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class qP extends y{static get requires(){return[WP,jP]}static get pluginName(){return"ImageCaption"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class GP extends F{refresh(){const e=this.editor,n=e.plugins.get("ImageUtils").getClosestSelectedImageElement(e.model.document.selection);this.isEnabled=!!n,!n||!n.hasAttribute("resizedWidth")?this.value=null:this.value={width:n.getAttribute("resizedWidth"),height:null}}execute(e){const t=this.editor,n=t.model,s=t.plugins.get("ImageUtils"),o=s.getClosestSelectedImageElement(n.document.selection);this.value={width:e.width,height:null},o&&n.change(r=>{r.setAttribute("resizedWidth",e.width,o),r.removeAttribute("resizedHeight",o),s.setImageNaturalSizeAttributes(o)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class KP extends y{static get requires(){return[Nt]}static get pluginName(){return"ImageResizeEditing"}constructor(e){super(e),e.config.define("image",{resizeUnit:"%",resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:custom",value:"custom",icon:"custom"},{name:"resizeImage:25",value:"25",icon:"small"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]})}init(){const e=this.editor,t=new GP(e);this._registerConverters("imageBlock"),this._registerConverters("imageInline"),e.commands.add("resizeImage",t),e.commands.add("imageResize",t)}afterInit(){this._registerSchema()}_registerSchema(){this.editor.plugins.has("ImageBlockEditing")&&this.editor.model.schema.extend("imageBlock",{allowAttributes:["resizedWidth","resizedHeight"]}),this.editor.plugins.has("ImageInlineEditing")&&this.editor.model.schema.extend("imageInline",{allowAttributes:["resizedWidth","resizedHeight"]})}_registerConverters(e){const t=this.editor,n=t.plugins.get("ImageUtils");t.conversion.for("downcast").add(s=>s.on(`attribute:resizedWidth:${e}`,(o,r,a)=>{if(!a.consumable.consume(r.item,o.name))return;const l=a.writer,c=a.mapper.toViewElement(r.item);r.attributeNewValue!==null?(l.setStyle("width",r.attributeNewValue,c),l.addClass("image_resized",c)):(l.removeStyle("width",c),l.removeClass("image_resized",c))})),t.conversion.for("dataDowncast").attributeToAttribute({model:{name:e,key:"resizedHeight"},view:s=>({key:"style",value:{height:s}})}),t.conversion.for("editingDowncast").add(s=>s.on(`attribute:resizedHeight:${e}`,(o,r,a)=>{if(!a.consumable.consume(r.item,o.name))return;const l=a.writer,c=a.mapper.toViewElement(r.item),u=e==="imageInline"?n.findViewImgElement(c):c;r.attributeNewValue!==null?l.setStyle("height",r.attributeNewValue,u):l.removeStyle("height",u)})),t.conversion.for("upcast").attributeToAttribute({view:{name:e==="imageBlock"?"figure":"img",styles:{width:/.+/}},model:{key:"resizedWidth",value:s=>Rr(s)?null:s.getStyle("width")}}),t.conversion.for("upcast").attributeToAttribute({view:{name:e==="imageBlock"?"figure":"img",styles:{height:/.+/}},model:{key:"resizedHeight",value:s=>Rr(s)?null:s.getStyle("height")}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const uc={small:P.objectSizeSmall,medium:P.objectSizeMedium,large:P.objectSizeLarge,custom:P.objectSizeCustom,original:P.objectSizeFull};class ZP extends y{static get requires(){return[KP]}static get pluginName(){return"ImageResizeButtons"}constructor(e){super(e),this._resizeUnit=e.config.get("image.resizeUnit")}init(){const e=this.editor,t=e.config.get("image.resizeOptions"),n=e.commands.get("resizeImage");this.bind("isEnabled").to(n);for(const s of t)this._registerImageResizeButton(s);this._registerImageResizeDropdown(t)}_registerImageResizeButton(e){const t=this.editor,{name:n,value:s,icon:o}=e;t.ui.componentFactory.add(n,r=>{const a=new N(r),l=t.commands.get("resizeImage"),c=this._getOptionLabelValue(e,!0);if(!uc[o])throw new p("imageresizebuttons-missing-icon",t,e);if(a.set({label:c,icon:uc[o],tooltip:c,isToggleable:!0}),a.bind("isEnabled").to(this),t.plugins.has("ImageCustomResizeUI")&&Gs(e)){const u=t.plugins.get("ImageCustomResizeUI");this.listenTo(a,"execute",()=>{u._showForm(this._resizeUnit)})}else{const u=s?s+this._resizeUnit:null;a.bind("isOn").to(l,"value",dc(u)),this.listenTo(a,"execute",()=>{t.execute("resizeImage",{width:u})})}return a})}_registerImageResizeDropdown(e){const t=this.editor,n=t.t,s=e.find(r=>!r.value),o=r=>{const a=t.commands.get("resizeImage"),l=tt(r,Gm),c=l.buttonView,u=n("Resize image");return c.set({tooltip:u,commandValue:s.value,icon:uc.medium,isToggleable:!0,label:this._getOptionLabelValue(s),withText:!0,class:"ck-resize-image-button",ariaLabel:u,ariaLabelledBy:void 0}),c.bind("label").to(a,"value",d=>d&&d.width?d.width:this._getOptionLabelValue(s)),l.bind("isEnabled").to(this),Si(l,()=>this._getResizeDropdownListItemDefinitions(e,a),{ariaLabel:n("Image resize list"),role:"menu"}),this.listenTo(l,"execute",d=>{"onClick"in d.source?d.source.onClick():(t.execute(d.source.commandName,{width:d.source.commandValue}),t.editing.view.focus())}),l};t.ui.componentFactory.add("resizeImage",o),t.ui.componentFactory.add("imageResize",o)}_getOptionLabelValue(e,t=!1){const n=this.editor.t;return e.label?e.label:t?Gs(e)?n("Custom image size"):e.value?n("Resize image to %0",e.value+this._resizeUnit):n("Resize image to the original size"):Gs(e)?n("Custom"):e.value?e.value+this._resizeUnit:n("Original")}_getResizeDropdownListItemDefinitions(e,t){const{editor:n}=this,s=new Oe,o=e.map(r=>Gs(r)?{...r,valueWithUnits:"custom"}:r.value?{...r,valueWithUnits:`${r.value}${this._resizeUnit}`}:{...r,valueWithUnits:null});for(const r of o){let a=null;if(n.plugins.has("ImageCustomResizeUI")&&Gs(r)){const l=n.plugins.get("ImageCustomResizeUI");a={type:"button",model:new Ri({label:this._getOptionLabelValue(r),role:"menuitemradio",withText:!0,icon:null,onClick:()=>{l._showForm(this._resizeUnit)}})};const c=Mk(o,"valueWithUnits");a.model.bind("isOn").to(t,"value",JP(c))}else a={type:"button",model:new Ri({commandName:"resizeImage",commandValue:r.valueWithUnits,label:this._getOptionLabelValue(r),role:"menuitemradio",withText:!0,icon:null})},a.model.bind("isOn").to(t,"value",dc(r.valueWithUnits));a.model.bind("isEnabled").to(t,"isEnabled"),s.add(a)}return s}}function Gs(i){return i.value==="custom"}function dc(i){return e=>{const t=e;return i===null&&t===i?!0:t!==null&&t.width===i}}function JP(i){return e=>!i.some(t=>dc(t)(e))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class YP extends F{constructor(e,t){super(e),this._defaultStyles={imageBlock:!1,imageInline:!1},this._styles=new Map(t.map(n=>{if(n.isDefault)for(const s of n.modelElements)this._defaultStyles[s]=n.name;return[n.name,n]}))}refresh(){const n=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!n,this.isEnabled?n.hasAttribute("imageStyle")?this.value=n.getAttribute("imageStyle"):this.value=this._defaultStyles[n.name]:this.value=!1}execute(e={}){const t=this.editor,n=t.model,s=t.plugins.get("ImageUtils");n.change(o=>{const r=e.value,{setImageSizes:a=!0}=e;let l=s.getClosestSelectedImageElement(n.document.selection);r&&this.shouldConvertImageType(r,l)&&(this.editor.execute(s.isBlockImage(l)?"imageTypeInline":"imageTypeBlock",{setImageSizes:a}),l=s.getClosestSelectedImageElement(n.document.selection)),!r||this._styles.get(r).isDefault?o.removeAttribute("imageStyle",l):o.setAttribute("imageStyle",r,l),a&&s.setImageNaturalSizeAttributes(l)})}shouldConvertImageType(e,t){return!this._styles.get(e).modelElements.includes(t.name)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const{objectFullWidth:XP,objectInline:Tp,objectLeft:Ep,objectRight:hc,objectCenter:fc,objectBlockLeft:Ap,objectBlockRight:xp}=P,Mr={get inline(){return{name:"inline",title:"In line",icon:Tp,modelElements:["imageInline"],isDefault:!0}},get alignLeft(){return{name:"alignLeft",title:"Left aligned image",icon:Ep,modelElements:["imageBlock","imageInline"],className:"image-style-align-left"}},get alignBlockLeft(){return{name:"alignBlockLeft",title:"Left aligned image",icon:Ap,modelElements:["imageBlock"],className:"image-style-block-align-left"}},get alignCenter(){return{name:"alignCenter",title:"Centered image",icon:fc,modelElements:["imageBlock"],className:"image-style-align-center"}},get alignRight(){return{name:"alignRight",title:"Right aligned image",icon:hc,modelElements:["imageBlock","imageInline"],className:"image-style-align-right"}},get alignBlockRight(){return{name:"alignBlockRight",title:"Right aligned image",icon:xp,modelElements:["imageBlock"],className:"image-style-block-align-right"}},get block(){return{name:"block",title:"Centered image",icon:fc,modelElements:["imageBlock"],isDefault:!0}},get side(){return{name:"side",title:"Side image",icon:hc,modelElements:["imageBlock"],className:"image-style-side"}}},Sp={full:XP,left:Ap,right:xp,center:fc,inlineLeft:Ep,inlineRight:hc,inline:Tp},Ip=[{name:"imageStyle:wrapText",title:"Wrap text",defaultItem:"imageStyle:alignLeft",items:["imageStyle:alignLeft","imageStyle:alignRight"]},{name:"imageStyle:breakText",title:"Break text",defaultItem:"imageStyle:block",items:["imageStyle:alignBlockLeft","imageStyle:block","imageStyle:alignBlockRight"]}];function QP(i){return(i.configuredStyles.options||[]).map(n=>n8(n)).filter(n=>i8(n,i))}function e8(i,e){return i&&e?{options:["inline","alignLeft","alignRight","alignCenter","alignBlockLeft","alignBlockRight","block","side"]}:i?{options:["block","side"]}:e?{options:["inline","alignLeft","alignRight"]}:{}}function t8(i){return i.has("ImageBlockEditing")&&i.has("ImageInlineEditing")?[...Ip]:[]}function n8(i){return typeof i=="string"?Mr[i]?i={...Mr[i]}:i={name:i}:i=s8(Mr[i.name],i),typeof i.icon=="string"&&(i.icon=Sp[i.icon]||i.icon),i}function i8(i,{isBlockPluginLoaded:e,isInlinePluginLoaded:t}){const{modelElements:n,name:s}=i;if(!n||!n.length||!s)return Pp({style:i}),!1;{const o=[e?"imageBlock":null,t?"imageInline":null];if(!n.some(r=>o.includes(r)))return Q("image-style-missing-dependency",{style:i,missingPlugins:n.map(r=>r==="imageBlock"?"ImageBlockEditing":"ImageInlineEditing")}),!1}return!0}function s8(i,e){const t={...e};for(const n in i)Object.prototype.hasOwnProperty.call(e,n)||(t[n]=i[n]);return t}function Pp(i){Q("image-style-configuration-definition-invalid",i)}const mc={normalizeStyles:QP,getDefaultStylesConfiguration:e8,getDefaultDropdownDefinitions:t8,warnInvalidStyle:Pp,DEFAULT_OPTIONS:Mr,DEFAULT_ICONS:Sp,DEFAULT_DROPDOWN_DEFINITIONS:Ip};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function o8(i){return(e,t,n)=>{if(!n.consumable.consume(t.item,e.name))return;const s=Rp(t.attributeNewValue,i),o=Rp(t.attributeOldValue,i),r=n.mapper.toViewElement(t.item),a=n.writer;o&&a.removeClass(o.className,r),s&&a.addClass(s.className,r)}}function r8(i){const e={imageInline:i.filter(t=>!t.isDefault&&t.modelElements.includes("imageInline")),imageBlock:i.filter(t=>!t.isDefault&&t.modelElements.includes("imageBlock"))};return(t,n,s)=>{if(!n.modelRange)return;const o=n.viewItem,r=ce(n.modelRange.getItems());if(r&&s.schema.checkAttribute(r,"imageStyle"))for(const a of e[r.name])s.consumable.consume(o,{classes:a.className})&&s.writer.setAttribute("imageStyle",a.name,r)}}function Rp(i,e){for(const t of e)if(t.name===i)return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Mp extends y{static get pluginName(){return"ImageStyleEditing"}static get requires(){return[Nt]}init(){const{normalizeStyles:e,getDefaultStylesConfiguration:t}=mc,n=this.editor,s=n.plugins.has("ImageBlockEditing"),o=n.plugins.has("ImageInlineEditing");n.config.define("image.styles",t(s,o)),this.normalizedStyles=e({configuredStyles:n.config.get("image.styles"),isBlockPluginLoaded:s,isInlinePluginLoaded:o}),this._setupConversion(s,o),this._setupPostFixer(),n.commands.add("imageStyle",new YP(n,this.normalizedStyles))}_setupConversion(e,t){const n=this.editor,s=n.model.schema,o=o8(this.normalizedStyles),r=r8(this.normalizedStyles);n.editing.downcastDispatcher.on("attribute:imageStyle",o),n.data.downcastDispatcher.on("attribute:imageStyle",o),e&&(s.extend("imageBlock",{allowAttributes:"imageStyle"}),n.data.upcastDispatcher.on("element:figure",r,{priority:"low"})),t&&(s.extend("imageInline",{allowAttributes:"imageStyle"}),n.data.upcastDispatcher.on("element:img",r,{priority:"low"}))}_setupPostFixer(){const e=this.editor,t=e.model.document,n=e.plugins.get(Nt),s=new Map(this.normalizedStyles.map(o=>[o.name,o]));t.registerPostFixer(o=>{let r=!1;for(const a of t.differ.getChanges())if(a.type=="insert"||a.type=="attribute"&&a.attributeKey=="imageStyle"){let l=a.type=="insert"?a.position.nodeAfter:a.range.start.nodeAfter;if(l&&l.is("element","paragraph")&&l.childCount>0&&(l=l.getChild(0)),!n.isImage(l))continue;const c=l.getAttribute("imageStyle");if(!c)continue;const u=s.get(c);(!u||!u.modelElements.includes(l.name))&&(o.removeAttribute("imageStyle",l),r=!0)}return r})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class a8 extends y{static get requires(){return[Mp]}static get pluginName(){return"ImageStyleUI"}get localizedDefaultStylesTitles(){const e=this.editor.t;return{"Wrap text":e("Wrap text"),"Break text":e("Break text"),"In line":e("In line"),"Full size image":e("Full size image"),"Side image":e("Side image"),"Left aligned image":e("Left aligned image"),"Centered image":e("Centered image"),"Right aligned image":e("Right aligned image")}}init(){const e=this.editor.plugins,t=this.editor.config.get("image.toolbar")||[],n=e.get("ImageStyleEditing"),s=Bp(n.normalizedStyles,this.localizedDefaultStylesTitles);for(const r of s)this._createButton(r);const o=Bp([...t.filter(ie),...mc.getDefaultDropdownDefinitions(e)],this.localizedDefaultStylesTitles);for(const r of o)this._createDropdown(r,s)}_createDropdown(e,t){const n=this.editor.ui.componentFactory;n.add(e.name,s=>{let o;const{defaultItem:r,items:a,title:l}=e,c=a.filter(f=>t.find(({name:m})=>Op(m)===f)).map(f=>{const m=n.create(f);return f===r&&(o=m),m});a.length!==c.length&&mc.warnInvalidStyle({dropdown:e});const u=tt(s,Bs),d=u.buttonView,h=d.arrowView;return lr(u,c,{enableActiveItemFocusOnDropdownOpen:!0}),d.set({label:Lp(l,o.label),class:null,tooltip:!0}),h.unbind("label"),h.set({label:l}),d.bind("icon").toMany(c,"isOn",(...f)=>{const m=f.findIndex(an);return m<0?o.icon:c[m].icon}),d.bind("label").toMany(c,"isOn",(...f)=>{const m=f.findIndex(an);return Lp(l,m<0?o.label:c[m].label)}),d.bind("isOn").toMany(c,"isOn",(...f)=>f.some(an)),d.bind("class").toMany(c,"isOn",(...f)=>f.some(an)?"ck-splitbutton_flatten":void 0),d.on("execute",()=>{c.some(({isOn:f})=>f)?u.isOpen=!u.isOpen:o.fire("execute")}),u.bind("isEnabled").toMany(c,"isEnabled",(...f)=>f.some(an)),this.listenTo(u,"execute",()=>{this.editor.editing.view.focus()}),u})}_createButton(e){const t=e.name;this.editor.ui.componentFactory.add(Op(t),n=>{const s=this.editor.commands.get("imageStyle"),o=new N(n);return o.set({label:e.title,icon:e.icon,tooltip:!0,isToggleable:!0}),o.bind("isEnabled").to(s,"isEnabled"),o.bind("isOn").to(s,"value",r=>r===t),o.on("execute",this._executeCommand.bind(this,t)),o})}_executeCommand(e){this.editor.execute("imageStyle",{value:e}),this.editor.editing.view.focus()}}function Bp(i,e){for(const t of i)e[t.title]&&(t.title=e[t.title]);return i}function Op(i){return`imageStyle:${i}`}function Lp(i,e){return(i?i+": ":"")+e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class l8 extends y{static get requires(){return[Mp,a8]}static get pluginName(){return"ImageStyle"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class c8 extends y{static get requires(){return[Tr,Nt]}static get pluginName(){return"ImageToolbar"}afterInit(){const e=this.editor,t=e.t,n=e.plugins.get(Tr),s=e.plugins.get("ImageUtils");n.register("image",{ariaLabel:t("Image toolbar"),items:u8(e.config.get("image.toolbar")||[]),getRelatedElement:o=>s.getClosestSelectedImageWidget(o)})}}function u8(i){return i.map(e=>ie(e)?e.name:e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class d8 extends y{static get pluginName(){return"IndentEditing"}init(){const e=this.editor;e.commands.add("indent",new Ph(e)),e.commands.add("outdent",new Ph(e))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class h8 extends y{static get pluginName(){return"IndentUI"}init(){const e=this.editor,t=e.locale,n=e.t,s=t.uiLanguageDirection=="ltr"?P.indent:P.outdent,o=t.uiLanguageDirection=="ltr"?P.outdent:P.indent;this._defineButton("indent",n("Increase indent"),s),this._defineButton("outdent",n("Decrease indent"),o)}_defineButton(e,t,n){const s=this.editor;s.ui.componentFactory.add(e,()=>{const o=this._createButton(N,e,t,n);return o.set({tooltip:!0}),o}),s.ui.componentFactory.add("menuBar:"+e,()=>this._createButton(Ae,e,t,n))}_createButton(e,t,n,s){const o=this.editor,r=o.commands.get(t),a=new e(o.locale);return a.set({label:n,icon:s}),a.bind("isEnabled").to(r,"isEnabled"),this.listenTo(a,"execute",()=>{o.execute(t),o.editing.view.focus()}),a}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class f8 extends y{static get pluginName(){return"Indent"}static get requires(){return[d8,h8]}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Br extends F{constructor(e,t){super(e),this._indentBehavior=t}refresh(){const t=this.editor.model,n=ce(t.document.selection.getSelectedBlocks());if(!n||!this._isIndentationChangeAllowed(n)){this.isEnabled=!1;return}this.isEnabled=this._indentBehavior.checkEnabled(n.getAttribute("blockIndent"))}execute(){const e=this.editor.model,t=this._getBlocksToChange();e.change(n=>{for(const s of t){const o=s.getAttribute("blockIndent"),r=this._indentBehavior.getNextIndent(o);r?n.setAttribute("blockIndent",r,s):n.removeAttribute("blockIndent",s)}})}_getBlocksToChange(){const t=this.editor.model.document.selection;return Array.from(t.getSelectedBlocks()).filter(s=>this._isIndentationChangeAllowed(s))}_isIndentationChangeAllowed(e){const t=this.editor;return t.model.schema.checkAttribute(e,"blockIndent")?!t.plugins.has("ListUtils")||!this._indentBehavior.isForward?!0:!t.plugins.get("ListUtils").isListItemBlock(e):!1}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Vp{constructor(e){this.isForward=e.direction==="forward",this.offset=e.offset,this.unit=e.unit}checkEnabled(e){const t=parseFloat(e||"0");return this.isForward||t>0}getNextIndent(e){const t=parseFloat(e||"0");if(!(!e||e.endsWith(this.unit)))return this.isForward?this.offset+this.unit:void 0;const s=this.isForward?this.offset:-this.offset,o=t+s;return o>0?o+this.unit:void 0}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Dp{constructor(e){this.isForward=e.direction==="forward",this.classes=e.classes}checkEnabled(e){const t=this.classes.indexOf(e);return this.isForward?t<this.classes.length-1:t>=0}getNextIndent(e){const t=this.classes.indexOf(e),n=this.isForward?1:-1;return this.classes[t+n]}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const m8=["paragraph","heading1","heading2","heading3","heading4","heading5","heading6"];class g8 extends y{constructor(e){super(e),e.config.define("indentBlock",{offset:40,unit:"px"})}static get pluginName(){return"IndentBlock"}init(){const e=this.editor,t=e.config.get("indentBlock");t.classes&&t.classes.length?(this._setupConversionUsingClasses(t.classes),e.commands.add("indentBlock",new Br(e,new Dp({direction:"forward",classes:t.classes}))),e.commands.add("outdentBlock",new Br(e,new Dp({direction:"backward",classes:t.classes})))):(e.data.addStyleProcessorRules(VA),this._setupConversionUsingOffset(),e.commands.add("indentBlock",new Br(e,new Vp({direction:"forward",offset:t.offset,unit:t.unit}))),e.commands.add("outdentBlock",new Br(e,new Vp({direction:"backward",offset:t.offset,unit:t.unit}))))}afterInit(){const e=this.editor,t=e.model.schema,n=e.commands.get("indent"),s=e.commands.get("outdent"),o=e.config.get("heading.options");(o&&o.map(l=>l.model)||m8).forEach(l=>{t.isRegistered(l)&&t.extend(l,{allowAttributes:"blockIndent"})}),t.setAttributeProperties("blockIndent",{isFormatting:!0}),n.registerChildCommand(e.commands.get("indentBlock")),s.registerChildCommand(e.commands.get("outdentBlock"))}_setupConversionUsingOffset(){const e=this.editor.conversion,n=this.editor.locale.contentLanguageDirection==="rtl"?"margin-right":"margin-left";e.for("upcast").attributeToAttribute({view:{styles:{[n]:/[\s\S]+/}},model:{key:"blockIndent",value:s=>{if(!s.is("element","li"))return s.getStyle(n)}}}),e.for("downcast").attributeToAttribute({model:"blockIndent",view:s=>({key:"style",value:{[n]:s}})})}_setupConversionUsingClasses(e){const t={model:{key:"blockIndent",values:[]},view:{}};for(const n of e)t.model.values.push(n),t.view[n]={key:"class",value:[n]};this.editor.conversion.attributeToAttribute(t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class p8{constructor(){this._definitions=new Set}get length(){return this._definitions.size}add(e){Array.isArray(e)?e.forEach(t=>this._definitions.add(t)):this._definitions.add(e)}getDispatcher(){return e=>{e.on("attribute:linkHref",(t,n,s)=>{if(!s.consumable.test(n.item,"attribute:linkHref")||!(n.item.is("selection")||s.schema.isInline(n.item)))return;const o=s.writer,r=o.document.selection;for(const a of this._definitions){const l=o.createAttributeElement("a",a.attributes,{priority:5});a.classes&&o.addClass(a.classes,l);for(const c in a.styles)o.setStyle(c,a.styles[c],l);o.setCustomProperty("link",!0,l),a.callback(n.attributeNewValue)?n.item.is("selection")?o.wrap(r.getFirstRange(),l):o.wrap(s.mapper.toViewRange(n.range),l):o.unwrap(s.mapper.toViewRange(n.range),l)}},{priority:"high"})}}getDispatcherForLinkedImage(){return e=>{e.on("attribute:linkHref:imageBlock",(t,n,{writer:s,mapper:o})=>{const r=o.toViewElement(n.item),a=Array.from(r.getChildren()).find(l=>l.is("element","a"));for(const l of this._definitions){const c=_t(l.attributes);if(l.callback(n.attributeNewValue)){for(const[u,d]of c)u==="class"?s.addClass(d,a):s.setAttribute(u,d,a);l.classes&&s.addClass(l.classes,a);for(const u in l.styles)s.setStyle(u,l.styles[u],a)}else{for(const[u,d]of c)u==="class"?s.removeClass(d,a):s.removeAttribute(u,a);l.classes&&s.removeClass(l.classes,a);for(const u in l.styles)s.removeStyle(u,a)}}})}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const b8=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,w8="^(?:(?:<protocols>):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))",_8=/^[\S]+@((?![-_])(?:[-\w\u00a1-\uffff]{0,63}[^-_]\.))+(?:[a-z\u00a1-\uffff]{2,})$/i,v8=/^((\w+:(\/{2,})?)|(\W))/i,y8=["https?","ftps?","mailto"],Ks="Ctrl+K";function C8(i){return i.is("attributeElement")&&!!i.getCustomProperty("link")}function Np(i,{writer:e}){const t=e.createAttributeElement("a",{href:i},{priority:5});return e.setCustomProperty("link",!0,t),t}function Fp(i,e=y8){const t=String(i),n=e.join("|"),s=new RegExp(`${w8.replace("<protocols>",n)}`,"i");return k8(t,s)?t:"#"}function k8(i,e){return!!i.replace(b8,"").match(e)}function T8(i,e){const t={"Open in a new tab":i("Open in a new tab"),Downloadable:i("Downloadable")};return e.forEach(n=>("label"in n&&t[n.label]&&(n.label=t[n.label]),n)),e}function E8(i){const e=[];if(i)for(const[t,n]of Object.entries(i)){const s=Object.assign({},n,{id:`link${ed(t)}`});e.push(s)}return e}function gc(i,e){return i?e.checkAttribute(i.name,"linkHref"):!1}function A8(i){return _8.test(i)}function pc(i,e){const t=A8(i)?"mailto:":e,n=!!t&&!$p(i);return i&&n?t+i:i}function $p(i){return v8.test(i)}function Up(i){window.open(i,"_blank","noopener")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class x8 extends F{constructor(){super(...arguments),this.manualDecorators=new Oe,this.automaticDecorators=new p8}restoreManualDecoratorStates(){for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id)}refresh(){const e=this.editor.model,t=e.document.selection,n=t.getSelectedElement()||ce(t.getSelectedBlocks());gc(n,e.schema)?(this.value=n.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttribute(n,"linkHref")):(this.value=t.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttributeInSelection(t,"linkHref"));for(const s of this.manualDecorators)s.value=this._getDecoratorStateFromModel(s.id)}execute(e,t={}){const n=this.editor.model,s=n.document.selection,o=[],r=[];for(const a in t)t[a]?o.push(a):r.push(a);n.change(a=>{if(s.isCollapsed){const l=s.getFirstPosition();if(s.hasAttribute("linkHref")){const c=zp(s);let u=Jo(l,"linkHref",s.getAttribute("linkHref"),n);s.getAttribute("linkHref")===c&&(u=this._updateLinkContent(n,a,u,e)),a.setAttribute("linkHref",e,u),o.forEach(d=>{a.setAttribute(d,!0,u)}),r.forEach(d=>{a.removeAttribute(d,u)}),a.setSelection(a.createPositionAfter(u.end.nodeBefore))}else if(e!==""){const c=_t(s.getAttributes());c.set("linkHref",e),o.forEach(d=>{c.set(d,!0)});const{end:u}=n.insertContent(a.createText(e,c),l);a.setSelection(u)}["linkHref",...o,...r].forEach(c=>{a.removeSelectionAttribute(c)})}else{const l=n.schema.getValidRanges(s.getRanges(),"linkHref"),c=[];for(const d of s.getSelectedBlocks())n.schema.checkAttribute(d,"linkHref")&&c.push(a.createRangeOn(d));const u=c.slice();for(const d of l)this._isRangeToUpdate(d,c)&&u.push(d);for(const d of u){let h=d;if(u.length===1){const f=zp(s);s.getAttribute("linkHref")===f&&(h=this._updateLinkContent(n,a,d,e),a.setSelection(a.createSelection(h)))}a.setAttribute("linkHref",e,h),o.forEach(f=>{a.setAttribute(f,!0,h)}),r.forEach(f=>{a.removeAttribute(f,h)})}}})}_getDecoratorStateFromModel(e){const t=this.editor.model,n=t.document.selection,s=n.getSelectedElement();return gc(s,t.schema)?s.getAttribute(e):n.getAttribute(e)}_isRangeToUpdate(e,t){for(const n of t)if(n.containsRange(e))return!1;return!0}_updateLinkContent(e,t,n,s){const o=t.createText(s,{linkHref:s});return e.insertContent(o,n)}}function zp(i){if(i.isCollapsed){const e=i.getFirstPosition();return e.textNode&&e.textNode.data}else{const e=Array.from(i.getFirstRange().getItems());if(e.length>1)return null;const t=e[0];return t.is("$text")||t.is("$textProxy")?t.data:null}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class S8 extends F{refresh(){const e=this.editor.model,t=e.document.selection,n=t.getSelectedElement();gc(n,e.schema)?this.isEnabled=e.schema.checkAttribute(n,"linkHref"):this.isEnabled=e.schema.checkAttributeInSelection(t,"linkHref")}execute(){const e=this.editor,t=this.editor.model,n=t.document.selection,s=e.commands.get("link");t.change(o=>{const r=n.isCollapsed?[Jo(n.getFirstPosition(),"linkHref",n.getAttribute("linkHref"),t)]:t.schema.getValidRanges(n.getRanges(),"linkHref");for(const a of r)if(o.removeAttribute("linkHref",a),s)for(const l of s.manualDecorators)o.removeAttribute(l.id,a)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class I8 extends re(){constructor({id:e,label:t,attributes:n,classes:s,styles:o,defaultValue:r}){super(),this.id=e,this.set("value",void 0),this.defaultValue=r,this.label=t,this.attributes=n,this.classes=s,this.styles=o}_createPattern(){return{attributes:this.attributes,classes:this.classes,styles:this.styles}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const P8="ck-link_selected",Hp="automatic",R8="manual",M8=/^(https?:)?\/\//;class Or extends y{static get pluginName(){return"LinkEditing"}static get requires(){return[bm,um,Vt]}constructor(e){super(e),e.config.define("link",{allowCreatingEmptyLinks:!1,addTargetToExternalLinks:!1})}init(){const e=this.editor,t=this.editor.config.get("link.allowedProtocols");e.model.schema.extend("$text",{allowAttributes:"linkHref"}),e.conversion.for("dataDowncast").attributeToElement({model:"linkHref",view:Np}),e.conversion.for("editingDowncast").attributeToElement({model:"linkHref",view:(o,r)=>Np(Fp(o,t),r)}),e.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:o=>o.getAttribute("href")}}),e.commands.add("link",new x8(e)),e.commands.add("unlink",new S8(e));const n=T8(e.t,E8(e.config.get("link.decorators")));this._enableAutomaticDecorators(n.filter(o=>o.mode===Hp)),this._enableManualDecorators(n.filter(o=>o.mode===R8)),e.plugins.get(bm).registerAttribute("linkHref"),l4(e,"linkHref","a",P8),this._enableLinkOpen(),this._enableSelectionAttributesFixer(),this._enableClipboardIntegration()}_enableAutomaticDecorators(e){const t=this.editor,s=t.commands.get("link").automaticDecorators;t.config.get("link.addTargetToExternalLinks")&&s.add({id:"linkIsExternal",mode:Hp,callback:o=>!!o&&M8.test(o),attributes:{target:"_blank",rel:"noopener noreferrer"}}),s.add(e),s.length&&t.conversion.for("downcast").add(s.getDispatcher())}_enableManualDecorators(e){if(!e.length)return;const t=this.editor,s=t.commands.get("link").manualDecorators;e.forEach(o=>{t.model.schema.extend("$text",{allowAttributes:o.id});const r=new I8(o);s.add(r),t.conversion.for("downcast").attributeToElement({model:r.id,view:(a,{writer:l,schema:c},{item:u})=>{if((u.is("selection")||c.isInline(u))&&a){const d=l.createAttributeElement("a",r.attributes,{priority:5});r.classes&&l.addClass(r.classes,d);for(const h in r.styles)l.setStyle(h,r.styles[h],d);return l.setCustomProperty("link",!0,d),d}}}),t.conversion.for("upcast").elementToAttribute({view:{name:"a",...r._createPattern()},model:{key:r.id}})})}_enableLinkOpen(){const e=this.editor,n=e.editing.view.document;this.listenTo(n,"click",(s,o)=>{if(!($.isMac?o.domEvent.metaKey:o.domEvent.ctrlKey))return;let a=o.domTarget;if(a.tagName.toLowerCase()!="a"&&(a=a.closest("a")),!a)return;const l=a.getAttribute("href");l&&(s.stop(),o.preventDefault(),Up(l))},{context:"$capture"}),this.listenTo(n,"keydown",(s,o)=>{const a=e.commands.get("link").value;a&&o.keyCode===U.enter&&o.altKey&&(s.stop(),Up(a))})}_enableSelectionAttributesFixer(){const t=this.editor.model,n=t.document.selection;this.listenTo(n,"change:attribute",(s,{attributeKeys:o})=>{!o.includes("linkHref")||n.hasAttribute("linkHref")||t.change(r=>{B8(r,O8(t.schema))})})}_enableClipboardIntegration(){const e=this.editor,t=e.model,n=this.editor.config.get("link.defaultProtocol");n&&this.listenTo(e.plugins.get("ClipboardPipeline"),"contentInsertion",(s,o)=>{t.change(r=>{const a=r.createRangeIn(o.content);for(const l of a.getItems())if(l.hasAttribute("linkHref")){const c=pc(l.getAttribute("linkHref"),n);r.setAttribute("linkHref",c,l)}})})}}function B8(i,e){i.removeSelectionAttribute("linkHref");for(const t of e)i.removeSelectionAttribute(t)}function O8(i){return i.getDefinition("$text").allowAttributes.filter(t=>t.startsWith("link"))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class L8 extends R{constructor(e,t,n){super(e),this.focusTracker=new be,this.keystrokes=new Te,this._focusables=new Xe;const s=e.t;this._validators=n,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(s("Save"),P.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(s("Cancel"),P.cancel,"ck-button-cancel","cancel"),this._manualDecoratorSwitches=this._createManualDecoratorSwitches(t),this.children=this._createFormChildren(t.manualDecorators),this._focusCycler=new et({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});const o=["ck","ck-link-form","ck-responsive-form"];t.manualDecorators.length&&o.push("ck-link-form_layout-vertical","ck-vertical-form"),this.setTemplate({tag:"form",attributes:{class:o,tabindex:"-1"},children:this.children})}getDecoratorSwitchesState(){return Array.from(this._manualDecoratorSwitches).reduce((e,t)=>(e[t.name]=t.isOn,e),{})}render(){super.render(),Ll({view:this}),[this.urlInputView,...this._manualDecoratorSwitches,this.saveButtonView,this.cancelButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}isValid(){this.resetFormStatus();for(const e of this._validators){const t=e(this);if(t)return this.urlInputView.errorText=t,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null}_createUrlInput(){const e=this.locale.t,t=new Ie(this.locale,Bt);return t.label=e("Link URL"),t}_createButton(e,t,n,s){const o=new N(this.locale);return o.set({label:e,icon:t,tooltip:!0}),o.extendTemplate({attributes:{class:n}}),s&&o.delegate("execute").to(this,s),o}_createManualDecoratorSwitches(e){const t=this.createCollection();for(const n of e.manualDecorators){const s=new tr(this.locale);s.set({name:n.id,label:n.label,withText:!0}),s.bind("isOn").toMany([n,e],"value",(o,r)=>r===void 0&&o===void 0?!!n.defaultValue:!!o),s.on("execute",()=>{n.set("value",!s.isOn)}),t.add(s)}return t}_createFormChildren(e){const t=this.createCollection();if(t.add(this.urlInputView),e.length){const n=new R;n.setTemplate({tag:"ul",children:this._manualDecoratorSwitches.map(s=>({tag:"li",children:[s],attributes:{class:["ck","ck-list__item"]}})),attributes:{class:["ck","ck-reset","ck-list"]}}),t.add(n)}return t.add(this.saveButtonView),t.add(this.cancelButtonView),t}get url(){const{element:e}=this.urlInputView.fieldView;return e?e.value.trim():null}}const V8='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class D8 extends R{constructor(e,t={}){super(e),this.focusTracker=new be,this.keystrokes=new Te,this._focusables=new Xe;const n=e.t;this.previewButtonView=this._createPreviewButton(),this.unlinkButtonView=this._createButton(n("Unlink"),V8,"unlink"),this.editButtonView=this._createButton(n("Edit link"),P.pencil,"edit"),this.set("href",void 0),this._linkConfig=t,this._focusCycler=new et({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-actions","ck-responsive-form"],tabindex:"-1"},children:[this.previewButtonView,this.editButtonView,this.unlinkButtonView]})}render(){super.render(),[this.previewButtonView,this.editButtonView,this.unlinkButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createButton(e,t,n){const s=new N(this.locale);return s.set({label:e,icon:t,tooltip:!0}),s.delegate("execute").to(this,n),s}_createPreviewButton(){const e=new N(this.locale),t=this.bindTemplate,n=this.t;return e.set({withText:!0,tooltip:n("Open link in new tab")}),e.extendTemplate({attributes:{class:["ck","ck-link-actions__preview"],href:t.to("href",s=>s&&Fp(s,this._linkConfig.allowedProtocols)),target:"_blank",rel:"noopener noreferrer"}}),e.bind("label").to(this,"href",s=>s||n("This link has no URL")),e.bind("isEnabled").to(this,"href",s=>!!s),e.template.tag="a",e.template.eventListeners={},e}}const Wp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Ft="link-ui";class jp extends y{constructor(){super(...arguments),this.actionsView=null,this.formView=null}static get requires(){return[Ot]}static get pluginName(){return"LinkUI"}init(){const e=this.editor,t=this.editor.t;e.editing.view.addObserver(lA),this._balloon=e.plugins.get(Ot),this._createToolbarLinkButton(),this._enableBalloonActivators(),e.conversion.for("editingDowncast").markerToHighlight({model:Ft,view:{classes:["ck-fake-link-selection"]}}),e.conversion.for("editingDowncast").markerToElement({model:Ft,view:{name:"span",classes:["ck-fake-link-selection","ck-fake-link-selection_collapsed"]}}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Create link"),keystroke:Ks},{label:t("Move out of a link"),keystroke:[["arrowleft","arrowleft"],["arrowright","arrowright"]]}]})}destroy(){super.destroy(),this.formView&&this.formView.destroy(),this.actionsView&&this.actionsView.destroy()}_createViews(){this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._enableUserBalloonInteractions()}_createActionsView(){const e=this.editor,t=new D8(e.locale,e.config.get("link")),n=e.commands.get("link"),s=e.commands.get("unlink");return t.bind("href").to(n,"value"),t.editButtonView.bind("isEnabled").to(n),t.unlinkButtonView.bind("isEnabled").to(s),this.listenTo(t,"edit",()=>{this._addFormView()}),this.listenTo(t,"unlink",()=>{e.execute("unlink"),this._hideUI()}),t.keystrokes.set("Esc",(o,r)=>{this._hideUI(),r()}),t.keystrokes.set(Ks,(o,r)=>{this._addFormView(),r()}),t}_createFormView(){const e=this.editor,t=e.commands.get("link"),n=e.config.get("link.defaultProtocol"),s=new(k4(L8))(e.locale,t,N8(e));return s.urlInputView.fieldView.bind("value").to(t,"value"),s.urlInputView.bind("isEnabled").to(t,"isEnabled"),s.saveButtonView.bind("isEnabled").to(t,"isEnabled"),this.listenTo(s,"submit",()=>{if(s.isValid()){const{value:o}=s.urlInputView.fieldView.element,r=pc(o,n);e.execute("link",r,s.getDecoratorSwitchesState()),this._closeFormView()}}),this.listenTo(s.urlInputView,"change:errorText",()=>{e.ui.update()}),this.listenTo(s,"cancel",()=>{this._closeFormView()}),s.keystrokes.set("Esc",(o,r)=>{this._closeFormView(),r()}),s}_createToolbarLinkButton(){const e=this.editor,t=e.commands.get("link");e.ui.componentFactory.add("link",()=>{const n=this._createButton(N);return n.set({tooltip:!0,isToggleable:!0}),n.bind("isOn").to(t,"value",s=>!!s),n}),e.ui.componentFactory.add("menuBar:link",()=>this._createButton(Ae))}_createButton(e){const t=this.editor,n=t.locale,s=t.commands.get("link"),o=new e(t.locale),r=n.t;return o.set({label:r("Link"),icon:Wp,keystroke:Ks}),o.bind("isEnabled").to(s,"isEnabled"),this.listenTo(o,"execute",()=>this._showUI(!0)),o}_enableBalloonActivators(){const e=this.editor,t=e.editing.view.document;this.listenTo(t,"click",()=>{this._getSelectedLinkElement()&&this._showUI()}),e.keystrokes.set(Ks,(n,s)=>{s(),e.commands.get("link").isEnabled&&this._showUI(!0)})}_enableUserBalloonInteractions(){this.editor.keystrokes.set("Tab",(e,t)=>{this._areActionsVisible&&!this.actionsView.focusTracker.isFocused&&(this.actionsView.focus(),t())},{priority:"high"}),this.editor.keystrokes.set("Esc",(e,t)=>{this._isUIVisible&&(this._hideUI(),t())}),Vn({emitter:this.formView,activator:()=>this._isUIInPanel,contextElements:()=>[this._balloon.view.element],callback:()=>this._hideUI()})}_addActionsView(){this.actionsView||this._createViews(),!this._areActionsInPanel&&this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()})}_addFormView(){if(this.formView||this._createViews(),this._isFormInPanel)return;const t=this.editor.commands.get("link");this.formView.disableCssTransitions(),this.formView.resetFormStatus(),this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this.formView.urlInputView.fieldView.value=t.value||"",this._balloon.visibleView===this.formView&&this.formView.urlInputView.fieldView.select(),this.formView.enableCssTransitions()}_closeFormView(){const e=this.editor.commands.get("link");e.restoreManualDecoratorStates(),e.value!==void 0?this._removeFormView():this._hideUI()}_removeFormView(){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this.formView.urlInputView.fieldView.reset(),this._balloon.remove(this.formView),this.editor.editing.view.focus(),this._hideFakeVisualSelection())}_showUI(e=!1){this.formView||this._createViews(),this._getSelectedLinkElement()?(this._areActionsVisible?this._addFormView():this._addActionsView(),e&&this._balloon.showStack("main")):(this._showFakeVisualSelection(),this._addActionsView(),e&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI()}_hideUI(){if(!this._isUIInPanel)return;const e=this.editor;this.stopListening(e.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),e.editing.view.focus(),this._removeFormView(),this._balloon.remove(this.actionsView),this._hideFakeVisualSelection()}_startUpdatingUI(){const e=this.editor,t=e.editing.view.document;let n=this._getSelectedLinkElement(),s=r();const o=()=>{const a=this._getSelectedLinkElement(),l=r();n&&!a||!n&&l!==s?this._hideUI():this._isUIVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),n=a,s=l};function r(){return t.selection.focus.getAncestors().reverse().find(a=>a.is("element"))}this.listenTo(e.ui,"update",o),this.listenTo(this._balloon,"change:visibleView",o)}get _isFormInPanel(){return!!this.formView&&this._balloon.hasView(this.formView)}get _areActionsInPanel(){return!!this.actionsView&&this._balloon.hasView(this.actionsView)}get _areActionsVisible(){return!!this.actionsView&&this._balloon.visibleView===this.actionsView}get _isUIInPanel(){return this._isFormInPanel||this._areActionsInPanel}get _isUIVisible(){const e=this._balloon.visibleView;return!!this.formView&&e==this.formView||this._areActionsVisible}_getBalloonPositionData(){const e=this.editor.editing.view,t=this.editor.model,n=e.document;let s;if(t.markers.has(Ft)){const o=Array.from(this.editor.editing.mapper.markerNameToElements(Ft)),r=e.createRange(e.createPositionBefore(o[0]),e.createPositionAfter(o[o.length-1]));s=e.domConverter.viewRangeToDom(r)}else s=()=>{const o=this._getSelectedLinkElement();return o?e.domConverter.mapViewToDom(o):e.domConverter.viewRangeToDom(n.selection.getFirstRange())};return{target:s}}_getSelectedLinkElement(){const e=this.editor.editing.view,t=e.document.selection,n=t.getSelectedElement();if(t.isCollapsed||n&&me(n))return bc(t.getFirstPosition());{const s=t.getFirstRange().getTrimmed(),o=bc(s.start),r=bc(s.end);return!o||o!=r?null:e.createRangeIn(o).getTrimmed().isEqual(s)?o:null}}_showFakeVisualSelection(){const e=this.editor.model;e.change(t=>{const n=e.document.selection.getFirstRange();if(e.markers.has(Ft))t.updateMarker(Ft,{range:n});else if(n.start.isAtEnd){const s=n.start.getLastMatchingPosition(({item:o})=>!e.schema.isContent(o),{boundaries:n});t.addMarker(Ft,{usingOperation:!1,affectsData:!1,range:t.createRange(s,n.end)})}else t.addMarker(Ft,{usingOperation:!1,affectsData:!1,range:n})})}_hideFakeVisualSelection(){const e=this.editor.model;e.markers.has(Ft)&&e.change(t=>{t.removeMarker(Ft)})}}function bc(i){return i.getAncestors().find(e=>C8(e))||null}function N8(i){const e=i.t,t=i.config.get("link.allowCreatingEmptyLinks");return[n=>{if(!t&&!n.url.length)return e("Link URL must not be empty.")}]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const F8=4,qp=new RegExp("(^|\\s)(((?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(((?!www\\.)|(www\\.))(?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.)+(?:[a-z\\u00a1-\\uffff]{2,63})))(?::\\d{2,5})?(?:[/?#]\\S*)?)|((www.|(\\S+@))((?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.))+(?:[a-z\\u00a1-\\uffff]{2,63})))$","i"),$8=2;class Gp extends y{static get requires(){return[Ln,Or]}static get pluginName(){return"AutoLink"}init(){const t=this.editor.model.document.selection;t.on("change:range",()=>{this.isEnabled=!t.anchor.parent.is("element","codeBlock")}),this._enableTypingHandling()}afterInit(){this._enableEnterHandling(),this._enableShiftEnterHandling(),this._enablePasteLinking()}_expandLinkRange(e,t){return t.textNode&&t.textNode.hasAttribute("linkHref")?Jo(t,"linkHref",t.textNode.getAttribute("linkHref"),e):null}_selectEntireLinks(e,t){const s=this.editor.model,o=s.document.selection,r=o.getFirstPosition(),a=o.getLastPosition();let l=t.getJoined(this._expandLinkRange(s,r)||t);l&&(l=l.getJoined(this._expandLinkRange(s,a)||t)),l&&(l.start.isBefore(r)||l.end.isAfter(a))&&e.setSelection(l)}_enablePasteLinking(){const e=this.editor,t=e.model,n=t.document.selection,s=e.plugins.get("ClipboardPipeline"),o=e.commands.get("link");s.on("inputTransformation",(r,a)=>{if(!this.isEnabled||!o.isEnabled||n.isCollapsed||a.method!=="paste"||n.rangeCount>1)return;const l=n.getFirstRange(),c=a.dataTransfer.getData("text/plain");if(!c)return;const u=c.match(qp);u&&u[2]===c&&(t.change(d=>{this._selectEntireLinks(d,l),o.execute(c)}),r.stop())},{priority:"high"})}_enableTypingHandling(){const e=this.editor,t=new pm(e.model,n=>{if(!U8(n))return;const s=Kp(n.substr(0,n.length-1));if(s)return{url:s}});t.on("matched:data",(n,s)=>{const{batch:o,range:r,url:a}=s;if(!o.isTyping)return;const l=r.end.getShiftedBy(-1),c=l.getShiftedBy(-a.length),u=e.model.createRange(c,l);this._applyAutoLink(a,u)}),t.bind("isEnabled").to(this)}_enableEnterHandling(){const e=this.editor,t=e.model,n=e.commands.get("enter");n&&n.on("execute",()=>{const s=t.document.selection.getFirstPosition();if(!s.parent.previousSibling)return;const o=t.createRangeIn(s.parent.previousSibling);this._checkAndApplyAutoLinkOnRange(o)})}_enableShiftEnterHandling(){const e=this.editor,t=e.model,n=e.commands.get("shiftEnter");n&&n.on("execute",()=>{const s=t.document.selection.getFirstPosition(),o=t.createRange(t.createPositionAt(s.parent,0),s.getShiftedBy(-1));this._checkAndApplyAutoLinkOnRange(o)})}_checkAndApplyAutoLinkOnRange(e){const t=this.editor.model,{text:n,range:s}=gm(e,t),o=Kp(n);if(o){const r=t.createRange(s.end.getShiftedBy(-o.length),s.end);this._applyAutoLink(o,r)}}_applyAutoLink(e,t){const n=this.editor.model,s=this.editor.config.get("link.defaultProtocol"),o=pc(e,s);!this.isEnabled||!z8(t,n)||!$p(o)||H8(t)||this._persistAutoLink(o,t)}_persistAutoLink(e,t){const n=this.editor.model,s=this.editor.plugins.get("Delete");n.enqueueChange(o=>{o.setAttribute("linkHref",e,t),n.enqueueChange(()=>{s.requestUndoOnBackspace()})})}}function U8(i){return i.length>F8&&i[i.length-1]===" "&&i[i.length-2]!==" "}function Kp(i){const e=qp.exec(i);return e?e[$8]:null}function z8(i,e){return e.schema.checkAttributeInSelection(e.createSelection(i),"linkHref")}function H8(i){const e=i.start.nodeAfter;return!!e&&e.hasAttribute("linkHref")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Zp extends y{static get requires(){return[Or,jp,Gp]}static get pluginName(){return"Link"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class W8 extends y{static get requires(){return["ImageEditing","ImageUtils",Or]}static get pluginName(){return"LinkImageEditing"}afterInit(){const e=this.editor,t=e.model.schema;e.plugins.has("ImageBlockEditing")&&t.extend("imageBlock",{allowAttributes:["linkHref"]}),e.conversion.for("upcast").add(j8(e)),e.conversion.for("downcast").add(q8(e)),this._enableAutomaticDecorators(),this._enableManualDecorators()}_enableAutomaticDecorators(){const e=this.editor,n=e.commands.get("link").automaticDecorators;n.length&&e.conversion.for("downcast").add(n.getDispatcherForLinkedImage())}_enableManualDecorators(){const e=this.editor,t=e.commands.get("link");for(const n of t.manualDecorators)e.plugins.has("ImageBlockEditing")&&e.model.schema.extend("imageBlock",{allowAttributes:n.id}),e.plugins.has("ImageInlineEditing")&&e.model.schema.extend("imageInline",{allowAttributes:n.id}),e.conversion.for("downcast").add(G8(n)),e.conversion.for("upcast").add(K8(e,n))}}function j8(i){const e=i.plugins.has("ImageInlineEditing"),t=i.plugins.get("ImageUtils");return n=>{n.on("element:a",(s,o,r)=>{const a=o.viewItem,l=t.findViewImgElement(a);if(!l)return;const c=l.findAncestor(f=>t.isBlockImageView(f));if(e&&!c)return;const u={attributes:["href"]};if(!r.consumable.consume(a,u))return;const d=a.getAttribute("href");if(!d)return;let h=o.modelCursor.parent;if(!h.is("element","imageBlock")){const f=r.convertItem(l,o.modelCursor);o.modelRange=f.modelRange,o.modelCursor=f.modelCursor,h=o.modelCursor.nodeBefore}h&&h.is("element","imageBlock")&&r.writer.setAttribute("linkHref",d,h)},{priority:"high"})}}function q8(i){const e=i.plugins.get("ImageUtils");return t=>{t.on("attribute:linkHref:imageBlock",(n,s,o)=>{if(!o.consumable.consume(s.item,n.name))return;const r=o.mapper.toViewElement(s.item),a=o.writer,l=Array.from(r.getChildren()).find(d=>d.is("element","a")),c=e.findViewImgElement(r),u=c.parent.is("element","picture")?c.parent:c;if(l)s.attributeNewValue?a.setAttribute("href",s.attributeNewValue,l):(a.move(a.createRangeOn(u),a.createPositionAt(r,0)),a.remove(l));else{const d=a.createContainerElement("a",{href:s.attributeNewValue});a.insert(a.createPositionAt(r,0),d),a.move(a.createRangeOn(u),a.createPositionAt(d,0))}},{priority:"high"})}}function G8(i){return e=>{e.on(`attribute:${i.id}:imageBlock`,(t,n,s)=>{const o=s.mapper.toViewElement(n.item),r=Array.from(o.getChildren()).find(a=>a.is("element","a"));if(r){for(const[a,l]of _t(i.attributes))s.writer.setAttribute(a,l,r);i.classes&&s.writer.addClass(i.classes,r);for(const a in i.styles)s.writer.setStyle(a,i.styles[a],r)}})}}function K8(i,e){const t=i.plugins.has("ImageInlineEditing"),n=i.plugins.get("ImageUtils");return s=>{s.on("element:a",(o,r,a)=>{const l=r.viewItem,c=n.findViewImgElement(l);if(!c)return;const u=c.findAncestor(m=>n.isBlockImageView(m));if(t&&!u)return;const h=new Ge(e._createPattern()).match(l);if(!h||!a.consumable.consume(l,h.match))return;const f=r.modelCursor.nodeBefore||r.modelCursor.parent;a.writer.setAttribute(e.id,!0,f)},{priority:"high"})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Z8 extends y{static get requires(){return[Or,jp,"ImageBlockEditing"]}static get pluginName(){return"LinkImageUI"}init(){const e=this.editor,t=e.editing.view.document;this.listenTo(t,"click",(n,s)=>{this._isSelectedLinkedImage(e.model.document.selection)&&(s.preventDefault(),n.stop())},{priority:"high"}),this._createToolbarLinkImageButton()}_createToolbarLinkImageButton(){const e=this.editor,t=e.t;e.ui.componentFactory.add("linkImage",n=>{const s=new N(n),o=e.plugins.get("LinkUI"),r=e.commands.get("link");return s.set({isEnabled:!0,label:t("Link image"),icon:Wp,keystroke:Ks,tooltip:!0,isToggleable:!0}),s.bind("isEnabled").to(r,"isEnabled"),s.bind("isOn").to(r,"value",a=>!!a),this.listenTo(s,"execute",()=>{this._isSelectedLinkedImage(e.model.document.selection)?o._addActionsView():o._showUI(!0)}),s})}_isSelectedLinkedImage(e){const t=e.getSelectedElement();return this.editor.plugins.get("ImageUtils").isImage(t)&&t.hasAttribute("linkHref")}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class J8 extends y{static get requires(){return[W8,Z8]}static get pluginName(){return"LinkImage"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class dt{constructor(e,t){this._startElement=e,this._referenceIndent=e.getAttribute("listIndent"),this._isForward=t.direction=="forward",this._includeSelf=!!t.includeSelf,this._sameAttributes=J(t.sameAttributes||[]),this._sameIndent=!!t.sameIndent,this._lowerIndent=!!t.lowerIndent,this._higherIndent=!!t.higherIndent}static first(e,t){const s=new this(e,t)[Symbol.iterator]();return ce(s)}*[Symbol.iterator](){const e=[];for(const{node:t}of Zs(this._getStartNode(),this._isForward?"forward":"backward")){const n=t.getAttribute("listIndent");if(n<this._referenceIndent){if(!this._lowerIndent)break;this._referenceIndent=n}else if(n>this._referenceIndent){if(!this._higherIndent)continue;if(!this._isForward){e.push(t);continue}}else{if(!this._sameIndent){if(this._higherIndent){e.length&&(yield*e,e.length=0);break}continue}if(this._sameAttributes.some(s=>t.getAttribute(s)!==this._startElement.getAttribute(s)))break}e.length&&(yield*e,e.length=0),yield t}}_getStartNode(){return this._includeSelf?this._startElement:this._isForward?this._startElement.nextSibling:this._startElement.previousSibling}}function*Zs(i,e="forward"){const t=e=="forward",n=[];let s=null;for(;_e(i);){let o=null;if(s){const r=i.getAttribute("listIndent"),a=s.getAttribute("listIndent");r>a?n[a]=s:r<a?(o=n[r],n.length=r):o=s}yield{node:i,previous:s,previousNodeInList:o},s=i,i=t?i.nextSibling:i.previousSibling}}class Y8{constructor(e){this._listHead=e}[Symbol.iterator](){return Zs(this._listHead,"forward")}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $i{static next(){return it()}}function _e(i){return!!i&&i.is("element")&&i.hasAttribute("listItemId")}function wc(i,e={}){return[...mn(i,{...e,direction:"backward"}),...mn(i,{...e,direction:"forward"})]}function mn(i,e={}){const t=e.direction=="forward",n=Array.from(new dt(i,{...e,includeSelf:t,sameIndent:!0,sameAttributes:"listItemId"}));return t?n:n.reverse()}function X8(i){return Array.from(new dt(i,{direction:"forward",higherIndent:!0}))}function Jp(i,e){const t=new dt(i,{sameIndent:!0,sameAttributes:"listType",...e}),n=new dt(i,{sameIndent:!0,sameAttributes:"listType",includeSelf:!0,direction:"forward",...e});return[...Array.from(t).reverse(),...n]}function zn(i){return!dt.first(i,{sameIndent:!0,sameAttributes:"listItemId"})}function Yp(i){return!dt.first(i,{direction:"forward",sameIndent:!0,sameAttributes:"listItemId"})}function Js(i,e={}){i=J(i);const t=e.withNested!==!1,n=new Set;for(const s of i)for(const o of wc(s,{higherIndent:t}))n.add(o);return Hn(n)}function Q8(i){i=J(i);const e=new Set;for(const t of i)for(const n of Jp(t))e.add(n);return Hn(e)}function _c(i,e){const t=mn(i,{direction:"forward"}),n=$i.next();for(const s of t)e.setAttribute("listItemId",n,s);return t}function vc(i,e,t){const n={};for(const[o,r]of e.getAttributes())o.startsWith("list")&&(n[o]=r);const s=mn(i,{direction:"forward"});for(const o of s)t.setAttributes(n,o);return s}function yc(i,e,{expand:t,indentBy:n=1}={}){i=J(i);const s=t?Js(i):i;for(const o of s){const r=o.getAttribute("listIndent")+n;r<0?Lr(o,e):e.setAttribute("listIndent",r,o)}return s}function e9(i,e){i=J(i);const t=Js(i),n=new Set,s=Math.min(...t.map(r=>r.getAttribute("listIndent"))),o=new Map;for(const r of t)o.set(r,dt.first(r,{lowerIndent:!0}));for(const r of t){if(n.has(r))continue;n.add(r);const a=r.getAttribute("listIndent")-1;if(a<0){Lr(r,e);continue}if(r.getAttribute("listIndent")==s){const l=i9(r,o.get(r),e);for(const c of l)n.add(c);if(l.length)continue}e.setAttribute("listIndent",a,r)}return Hn(n)}function Lr(i,e){i=J(i);for(const t of i)t.is("element","listItem")&&e.rename(t,"paragraph");for(const t of i)for(const n of t.getAttributeKeys())n.startsWith("list")&&e.removeAttribute(n,t);return i}function Ys(i){if(!i.length)return!1;const e=i[0].getAttribute("listItemId");return e?!i.some(t=>t.getAttribute("listItemId")!=e):!1}function t9(i,e){const t=[];let n=Number.POSITIVE_INFINITY;for(const{node:s}of Zs(i.nextSibling,"forward")){const o=s.getAttribute("listIndent");if(o==0)break;o<n&&(n=o);const r=o-n;e.setAttribute("listIndent",r,s),t.push(s)}return t}function Hn(i){return Array.from(i).filter(e=>e.root.rootName!=="$graveyard").sort((e,t)=>e.index-t.index)}function Xs(i){const e=i.document.selection.getSelectedElement();return e&&i.schema.isObject(e)&&i.schema.isBlock(e)?e:null}function Cc(i,e){return e.checkChild(i.parent,"listItem")&&e.checkChild(i,"$text")&&!e.isObject(i)}function n9(i){return i=="numbered"||i=="customNumbered"}function i9(i,e,t){return mn(e,{direction:"forward"}).pop().index>i.index?vc(i,e,t):[]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Xp extends F{constructor(e,t){super(e),this._direction=t}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,t=Qp(e.document.selection);e.change(n=>{const s=[];Ys(t)&&!zn(t[0])?(this._direction=="forward"&&s.push(...yc(t,n)),s.push(..._c(t[0],n))):this._direction=="forward"?s.push(...yc(t,n,{expand:!0})):s.push(...e9(t,n));for(const o of s){if(!o.hasAttribute("listType"))continue;const r=dt.first(o,{sameIndent:!0});r&&n.setAttribute("listType",r.getAttribute("listType"),o)}this._fireAfterExecute(s)})}_fireAfterExecute(e){this.fire("afterExecute",Hn(new Set(e)))}_checkEnabled(){let e=Qp(this.editor.model.document.selection),t=e[0];if(!t)return!1;if(this._direction=="backward"||Ys(e)&&!zn(e[0]))return!0;e=Js(e),t=e[0];const n=dt.first(t,{sameIndent:!0});return n?n.getAttribute("listType")==t.getAttribute("listType"):!1}}function Qp(i){const e=Array.from(i.getSelectedBlocks()),t=e.findIndex(n=>!_e(n));return t!=-1&&(e.length=t),e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Vr extends F{constructor(e,t,n={}){super(e),this.type=t,this._listWalkerOptions=n.multiLevel?{higherIndent:!0,lowerIndent:!0,sameAttributes:[]}:void 0}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,n=t.document,s=Xs(t),o=Array.from(n.selection.getSelectedBlocks()).filter(a=>t.schema.checkAttribute(a,"listType")||Cc(a,t.schema)),r=e.forceValue!==void 0?!e.forceValue:this.value;t.change(a=>{if(r){const l=o[o.length-1],c=mn(l,{direction:"forward"}),u=[];c.length>1&&u.push(..._c(c[1],a)),u.push(...Lr(o,a)),u.push(...t9(l,a)),this._fireAfterExecute(u)}else if((s||n.selection.isCollapsed)&&_e(o[0])){const l=Jp(s||o[0],this._listWalkerOptions);for(const c of l)a.setAttributes({...e.additionalAttributes,listType:this.type},c);this._fireAfterExecute(l)}else{const l=[];for(const c of o)if(!c.hasAttribute("listType"))!c.is("element","listItem")&&Cc(c,t.schema)&&a.rename(c,"listItem"),a.setAttributes({...e.additionalAttributes,listIndent:0,listItemId:$i.next(),listType:this.type},c),l.push(c);else for(const u of Js(c,{withNested:!1}))u.getAttribute("listType")!=this.type&&(a.setAttributes({...e.additionalAttributes,listType:this.type},u),l.push(u));this._fireAfterExecute(l)}})}_fireAfterExecute(e){this.fire("afterExecute",Hn(new Set(e)))}_getValue(){const e=this.editor.model.document.selection,t=Array.from(e.getSelectedBlocks());if(!t.length)return!1;for(const n of t)if(n.getAttribute("listType")!=this.type)return!1;return!0}_checkEnabled(){const e=this.editor.model,t=e.schema,n=e.document.selection,s=Array.from(n.getSelectedBlocks());if(!s.length)return!1;if(this.value)return!0;for(const o of s)if(t.checkAttribute(o,"listType")||Cc(o,t))return!0;return!1}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class e1 extends F{constructor(e,t){super(e),this._direction=t}refresh(){this.isEnabled=this._checkEnabled()}execute({shouldMergeOnBlocksContentLevel:e=!1}={}){const t=this.editor.model,n=t.document.selection,s=[];t.change(o=>{const{firstElement:r,lastElement:a}=this._getMergeSubjectElements(n,e),l=r.getAttribute("listIndent")||0,c=a.getAttribute("listIndent"),u=a.getAttribute("listItemId");if(l!=c){const d=X8(a);s.push(...yc([a,...d],o,{indentBy:l-c,expand:l<c}))}if(e){let d=n;n.isCollapsed&&(d=o.createSelection(o.createRange(o.createPositionAt(r,"end"),o.createPositionAt(a,0)))),t.deleteContent(d,{doNotResetEntireContent:n.isCollapsed});const h=d.getLastPosition().parent,f=h.nextSibling;s.push(h),f&&f!==a&&f.getAttribute("listItemId")==u&&s.push(...vc(f,h,o))}else s.push(...vc(a,r,o));this._fireAfterExecute(s)})}_fireAfterExecute(e){this.fire("afterExecute",Hn(new Set(e)))}_checkEnabled(){const e=this.editor.model,t=e.document.selection,n=Xs(e);if(t.isCollapsed||n){const s=n||t.getFirstPosition().parent;if(!_e(s))return!1;const o=this._direction=="backward"?s.previousSibling:s.nextSibling;if(!o||Ys([s,o]))return!1}else{const s=t.getLastPosition(),o=t.getFirstPosition();if(s.parent===o.parent||!_e(s.parent))return!1}return!0}_getMergeSubjectElements(e,t){const n=this.editor.model,s=Xs(n);let o,r;if(e.isCollapsed||s){const a=s||e.getFirstPosition().parent,l=zn(a);this._direction=="backward"?(r=a,l&&!t?o=dt.first(a,{sameIndent:!0,lowerIndent:!0}):o=a.previousSibling):(o=a,r=a.nextSibling)}else o=e.getFirstPosition().parent,r=e.getLastPosition().parent;return{firstElement:o,lastElement:r}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class t1 extends F{constructor(e,t){super(e),this._direction=t}refresh(){this.isEnabled=this._checkEnabled()}execute(){this.editor.model.change(t=>{const n=_c(this._getStartBlock(),t);this._fireAfterExecute(n)})}_fireAfterExecute(e){this.fire("afterExecute",Hn(new Set(e)))}_checkEnabled(){const e=this.editor.model.document.selection,t=this._getStartBlock();return e.isCollapsed&&_e(t)&&!zn(t)}_getStartBlock(){const t=this.editor.model.document.selection.getFirstPosition().parent;return this._direction=="before"?t:t.nextSibling}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class s9 extends y{static get pluginName(){return"ListUtils"}expandListBlocksToCompleteList(e){return Q8(e)}isFirstBlockOfListItem(e){return zn(e)}isListItemBlock(e){return _e(e)}expandListBlocksToCompleteItems(e,t={}){return Js(e,t)}isNumberedListType(e){return n9(e)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function n1(i){return i.is("element","ol")||i.is("element","ul")}function Dr(i){return i.is("element","li")}function o9(i){let e=0,t=i.parent;for(;t;){if(Dr(t))e++;else{const n=t.previousSibling;n&&Dr(n)&&e++}t=t.parent}return e}function r9(i,e,t,n=s1(t,e)){return i.createAttributeElement(i1(t),null,{priority:2*e/100-100,id:n})}function a9(i,e,t){return i.createAttributeElement("li",null,{priority:(2*e+1)/100-100,id:t})}function i1(i){return i=="numbered"||i=="customNumbered"?"ol":"ul"}function s1(i,e){return`list-${i}-${e}`}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Et(i,e){const t=i.nodeBefore;if(_e(t)){let n=t;for(const{node:s}of Zs(n,"backward"))if(n=s,e.has(n))return;e.set(t,n)}else{const n=i.nodeAfter;_e(n)&&e.set(n,n)}}function l9(i,e){let t=0,n=-1,s=null,o=!1;for(const{node:r}of i){const a=r.getAttribute("listIndent");if(a>t){let l;s===null?(s=a-t,l=t):(s>a&&(s=a),l=a-s),l>n+1&&(l=n+1),e.setAttribute("listIndent",l,r),o=!0,n=l}else s=null,t=a+1,n=a}return o}function c9(i,e,t){const n=new Set;let s=!1;for(const{node:o}of i){if(n.has(o))continue;let r=o.getAttribute("listType"),a=o.getAttribute("listItemId");if(e.has(a)&&(a=$i.next()),e.add(a),o.is("element","listItem")){o.getAttribute("listItemId")!=a&&(t.setAttribute("listItemId",a,o),s=!0);continue}for(const l of mn(o,{direction:"forward"}))n.add(l),l.getAttribute("listType")!=r&&(a=$i.next(),r=l.getAttribute("listType")),l.getAttribute("listItemId")!=a&&(t.setAttribute("listItemId",a,l),s=!0)}return s}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function u9(){return(i,e,t)=>{const{writer:n,schema:s}=t;if(!e.modelRange)return;const o=Array.from(e.modelRange.getItems({shallow:!0})).filter(d=>s.checkAttribute(d,"listItemId"));if(!o.length)return;const r=$i.next(),a=o9(e.viewItem);let l=e.viewItem.parent&&e.viewItem.parent.is("element","ol")?"numbered":"bulleted";const c=o[0].getAttribute("listType");c&&(l=c);const u={listItemId:r,listIndent:a,listType:l};for(const d of o)d.hasAttribute("listItemId")||n.setAttributes(u,d);o.length>1&&o[1].getAttribute("listItemId")!=u.listItemId&&t.keepEmptyElement(o[0])}}function o1(){return(i,e,t)=>{if(!t.consumable.test(e.viewItem,{name:!0}))return;const n=new Ye(e.viewItem.document);for(const s of Array.from(e.viewItem.getChildren()))!Dr(s)&&!n1(s)&&n.remove(s)}}function d9(i,e,t,n){return()=>{const a=i.document.differ.getChanges(),l=[],c=new Map,u=new Set;for(const d of a)if(d.type=="insert"&&d.name!="$text")Et(d.position,c),d.attributes.has("listItemId")?u.add(d.position.nodeAfter):Et(d.position.getShiftedBy(d.length),c);else if(d.type=="remove"&&d.attributes.has("listItemId"))Et(d.position,c);else if(d.type=="attribute"){const h=d.range.start.nodeAfter;t.includes(d.attributeKey)?(Et(d.range.start,c),d.attributeNewValue===null?(Et(d.range.start.getShiftedBy(1),c),o(h)&&l.push(h)):u.add(h)):_e(h)&&o(h)&&l.push(h)}for(const d of c.values())l.push(...s(d,u));for(const d of new Set(l))e.reconvertItem(d)};function s(a,l){const c=[],u=new Set,d=[];for(const{node:h,previous:f}of Zs(a,"forward")){if(u.has(h))continue;const m=h.getAttribute("listIndent");f&&m<f.getAttribute("listIndent")&&(d.length=m+1),d[m]=Object.fromEntries(Array.from(h.getAttributes()).filter(([b])=>t.includes(b)));const g=mn(h,{direction:"forward"});for(const b of g)u.add(b),(o(b,g)||r(b,d,l))&&c.push(b)}return c}function o(a,l){const c=e.mapper.toViewElement(a);if(!c)return!1;if(n.fire("checkElement",{modelElement:a,viewElement:c}))return!0;if(!a.is("element","paragraph")&&!a.is("element","listItem"))return!1;const d=c1(a,t,l);return d&&c.is("element","p")?!0:!!(!d&&c.is("element","span"))}function r(a,l,c){if(c.has(a))return!1;const u=e.mapper.toViewElement(a);let d=l.length-1;for(let h=u.parent;!h.is("editableElement");h=h.parent){const f=Dr(h),m=n1(h);if(!m&&!f)continue;const g=`checkAttributes:${f?"item":"list"}`;if(n.fire(g,{viewElement:h,modelAttributes:l[d]}))break;if(m&&(d--,d<0))return!1}return!0}}function r1(i,e,t,{dataPipeline:n}={}){const s=w9(i);return(o,r,a)=>{const{writer:l,mapper:c,consumable:u}=a,d=r.item;if(!i.includes(r.attributeKey)||!s(d,u))return;const h=f9(d,c,t);l1(h,l,c),p9(h,l);const f=g9(d,h,e,l,{dataPipeline:n});b9(d,f,e,l)}}function h9(i){return(e,t,n)=>{const{writer:s,mapper:o}=n,r=e.name.split(":")[1];if(!i.checkAttribute(r,"listItemId"))return;const a=o.toViewPosition(t.position),l=t.position.getShiftedBy(t.length),c=o.toViewPosition(l,{isPhantom:!0}),d=s.createRange(a,c).getTrimmed().end.nodeBefore;/* istanbul ignore next -- @preserve */d&&l1(d,s,o)}}function a1(i,{dataPipeline:e}={}){return(t,{writer:n})=>{if(!c1(t,i))return null;if(!e)return n.createContainerElement("span",{class:"ck-list-bogus-paragraph"});const s=n.createContainerElement("p");return n.setCustomProperty("dataPipeline:transparentRendering",!0,s),s}}function f9(i,e,t){const n=t.createRangeOn(i);return e.toViewRange(n).getTrimmed().end.nodeBefore}function m9(i,e){return(t,n)=>{if(n.modelPosition.offset>0)return;const s=n.modelPosition.parent;if(!_e(s)||!i.some(c=>c.scope=="itemMarker"&&c.canInjectMarkerIntoElement&&c.canInjectMarkerIntoElement(s)))return;const o=n.mapper.toViewElement(s),r=e.createRangeIn(o),a=r.getWalker();let l=r.start;for(const{item:c}of a){if(c.is("element")&&n.mapper.toModelElement(c)||c.is("$textProxy"))break;c.is("element")&&c.getCustomProperty("listItemMarker")&&(l=e.createPositionAfter(c),a.skip(({previousPosition:u})=>!u.isEqual(l)))}n.viewPosition=l}}function l1(i,e,t){for(;i.parent.is("attributeElement")&&i.parent.getCustomProperty("listItemWrapper");)e.unwrap(e.createRangeOn(i),i.parent);const n=[];s(e.createPositionBefore(i).getWalker({direction:"backward"})),s(e.createRangeIn(i).getWalker());for(const o of n)e.remove(o);function s(o){for(const{item:r}of o){if(r.is("element")&&t.toModelElement(r))break;r.is("element")&&r.getCustomProperty("listItemMarker")&&n.push(r)}}}function g9(i,e,t,n,{dataPipeline:s}){let o=n.createRangeOn(e);if(!zn(i))return o;for(const r of t){if(r.scope!="itemMarker")continue;const a=r.createElement(n,i,{dataPipeline:s});if(!a||(n.setCustomProperty("listItemMarker",!0,a),r.canInjectMarkerIntoElement&&r.canInjectMarkerIntoElement(i)?n.insert(n.createPositionAt(e,0),a):(n.insert(o.start,a),o=n.createRange(n.createPositionBefore(a),n.createPositionAfter(e))),!r.createWrapperElement||!r.canWrapElement))continue;const l=r.createWrapperElement(n,i,{dataPipeline:s});n.setCustomProperty("listItemWrapper",!0,l),r.canWrapElement(i)?o=n.wrap(o,l):(o=n.wrap(n.createRangeOn(a),l),o=n.createRange(o.start,n.createPositionAfter(e)))}return o}function p9(i,e){let t=i.parent;for(;t.is("attributeElement")&&["ul","ol","li"].includes(t.name);){const n=t.parent;e.unwrap(e.createRangeOn(i),t),t=n}}function b9(i,e,t,n){if(!i.hasAttribute("listIndent"))return;const s=i.getAttribute("listIndent");let o=i;for(let r=s;r>=0;r--){const a=a9(n,r,o.getAttribute("listItemId")),l=r9(n,r,o.getAttribute("listType"));for(const c of t)(c.scope=="list"||c.scope=="item")&&o.hasAttribute(c.attributeName)&&c.setAttributeOnDowncast(n,o.getAttribute(c.attributeName),c.scope=="list"?l:a);if(e=n.wrap(e,a),e=n.wrap(e,l),r==0||(o=dt.first(o,{lowerIndent:!0}),!o))break}}function w9(i){return(e,t)=>{const n=[];for(const s of i)e.hasAttribute(s)&&n.push(`attribute:${s}`);return n.every(s=>t.test(e,s)!==!1)?(n.forEach(s=>t.consume(e,s)),!0):!1}}function c1(i,e,t=wc(i)){if(!_e(i))return!1;for(const n of i.getAttributeKeys())if(!n.startsWith("selection:")&&!e.includes(n))return!1;return t.length<2}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Nr=["listType","listIndent","listItemId"];class _9 extends y{static get pluginName(){return"ListEditing"}static get requires(){return[$s,Ln,s9,Vt]}constructor(e){super(e),this._downcastStrategies=[],e.config.define("list.multiBlock",!0)}init(){const e=this.editor,t=e.model,n=e.config.get("list.multiBlock");if(e.plugins.has("LegacyListEditing"))throw new p("list-feature-conflict",this,{conflictPlugin:"LegacyListEditing"});t.schema.register("$listItem",{allowAttributes:Nr}),n?(t.schema.extend("$container",{allowAttributesOf:"$listItem"}),t.schema.extend("$block",{allowAttributesOf:"$listItem"}),t.schema.extend("$blockObject",{allowAttributesOf:"$listItem"})):t.schema.register("listItem",{inheritAllFrom:"$block",allowAttributesOf:"$listItem"});for(const s of Nr)t.schema.setAttributeProperties(s,{copyOnReplace:!0});e.commands.add("numberedList",new Vr(e,"numbered")),e.commands.add("bulletedList",new Vr(e,"bulleted")),e.commands.add("customNumberedList",new Vr(e,"customNumbered",{multiLevel:!0})),e.commands.add("customBulletedList",new Vr(e,"customBulleted",{multiLevel:!0})),e.commands.add("indentList",new Xp(e,"forward")),e.commands.add("outdentList",new Xp(e,"backward")),e.commands.add("splitListItemBefore",new t1(e,"before")),e.commands.add("splitListItemAfter",new t1(e,"after")),n&&(e.commands.add("mergeListItemBackward",new e1(e,"backward")),e.commands.add("mergeListItemForward",new e1(e,"forward"))),this._setupDeleteIntegration(),this._setupEnterIntegration(),this._setupTabIntegration(),this._setupClipboardIntegration(),this._setupAccessibilityIntegration()}afterInit(){const t=this.editor.commands,n=t.get("indent"),s=t.get("outdent");n&&n.registerChildCommand(t.get("indentList"),{priority:"high"}),s&&s.registerChildCommand(t.get("outdentList"),{priority:"lowest"}),this._setupModelPostFixing(),this._setupConversion()}registerDowncastStrategy(e){this._downcastStrategies.push(e)}getListAttributeNames(){return[...Nr,...this._downcastStrategies.map(e=>e.attributeName)]}_setupDeleteIntegration(){const e=this.editor,t=e.commands.get("mergeListItemBackward"),n=e.commands.get("mergeListItemForward");this.listenTo(e.editing.view.document,"delete",(s,o)=>{const r=e.model.document.selection;Xs(e.model)||e.model.change(()=>{const a=r.getFirstPosition();if(r.isCollapsed&&o.direction=="backward"){if(!a.isAtStart)return;const l=a.parent;if(!_e(l))return;if(!dt.first(l,{sameAttributes:"listType",sameIndent:!0})&&l.getAttribute("listIndent")===0)Yp(l)||e.execute("splitListItemAfter"),e.execute("outdentList");else{if(!t||!t.isEnabled)return;t.execute({shouldMergeOnBlocksContentLevel:u1(e.model,"backward")})}o.preventDefault(),s.stop()}else{if(r.isCollapsed&&!r.getLastPosition().isAtEnd||!n||!n.isEnabled)return;n.execute({shouldMergeOnBlocksContentLevel:u1(e.model,"forward")}),o.preventDefault(),s.stop()}})},{context:"li"})}_setupEnterIntegration(){const e=this.editor,t=e.model,n=e.commands,s=n.get("enter");this.listenTo(e.editing.view.document,"enter",(o,r)=>{const a=t.document,l=a.selection.getFirstPosition().parent;if(a.selection.isCollapsed&&_e(l)&&l.isEmpty&&!r.isSoft){const c=zn(l),u=Yp(l);c&&u?(e.execute("outdentList"),r.preventDefault(),o.stop()):c&&!u?(e.execute("splitListItemAfter"),r.preventDefault(),o.stop()):u&&(e.execute("splitListItemBefore"),r.preventDefault(),o.stop())}},{context:"li"}),this.listenTo(s,"afterExecute",()=>{const o=n.get("splitListItemBefore");if(o.refresh(),!o.isEnabled)return;const a=e.model.document.selection.getLastPosition().parent;wc(a).length===2&&o.execute()})}_setupTabIntegration(){const e=this.editor;this.listenTo(e.editing.view.document,"tab",(t,n)=>{const s=n.shiftKey?"outdentList":"indentList";this.editor.commands.get(s).isEnabled&&(e.execute(s),n.stopPropagation(),n.preventDefault(),t.stop())},{context:"li"})}_setupConversion(){const e=this.editor,t=e.model,n=this.getListAttributeNames(),s=e.config.get("list.multiBlock"),o=s?"paragraph":"listItem";e.conversion.for("upcast").elementToElement({view:"li",model:(a,{writer:l})=>l.createElement(o,{listType:""})}).elementToElement({view:"p",model:(a,{writer:l})=>a.parent&&a.parent.is("element","li")?l.createElement(o,{listType:""}):null,converterPriority:"high"}).add(a=>{a.on("element:li",u9()),a.on("element:ul",o1(),{priority:"high"}),a.on("element:ol",o1(),{priority:"high"})}),s||e.conversion.for("downcast").elementToElement({model:"listItem",view:"p"}),e.conversion.for("editingDowncast").elementToElement({model:o,view:a1(n),converterPriority:"high"}).add(a=>{a.on("attribute",r1(n,this._downcastStrategies,t)),a.on("remove",h9(t.schema))}),e.conversion.for("dataDowncast").elementToElement({model:o,view:a1(n,{dataPipeline:!0}),converterPriority:"high"}).add(a=>{a.on("attribute",r1(n,this._downcastStrategies,t,{dataPipeline:!0}))});const r=m9(this._downcastStrategies,e.editing.view);e.editing.mapper.on("modelToViewPosition",r),e.data.mapper.on("modelToViewPosition",r),this.listenTo(t.document,"change:data",d9(t,e.editing,n,this),{priority:"high"}),this.on("checkAttributes:item",(a,{viewElement:l,modelAttributes:c})=>{l.id!=c.listItemId&&(a.return=!0,a.stop())}),this.on("checkAttributes:list",(a,{viewElement:l,modelAttributes:c})=>{(l.name!=i1(c.listType)||l.id!=s1(c.listType,c.listIndent))&&(a.return=!0,a.stop())})}_setupModelPostFixing(){const e=this.editor.model,t=this.getListAttributeNames();e.document.registerPostFixer(n=>v9(e,n,t,this)),this.on("postFixer",(n,{listNodes:s,writer:o})=>{n.return=l9(s,o)||n.return},{priority:"high"}),this.on("postFixer",(n,{listNodes:s,writer:o,seenIds:r})=>{n.return=c9(s,r,o)||n.return},{priority:"high"})}_setupClipboardIntegration(){const e=this.editor.model,t=this.editor.plugins.get("ClipboardPipeline");this.listenTo(e,"insertContent",y9(e),{priority:"high"}),this.listenTo(t,"outputTransformation",(n,s)=>{e.change(o=>{const r=Array.from(s.content.getChildren()),a=r[r.length-1];if(r.length>1&&a.is("element")&&a.isEmpty&&r.slice(0,-1).every(_e)&&o.remove(a),s.method=="copy"||s.method=="cut"){const l=Array.from(s.content.getChildren());Ys(l)&&Lr(l,o)}})})}_setupAccessibilityIntegration(){const e=this.editor,t=e.t;e.accessibility.addKeystrokeInfoGroup({id:"list",label:t("Keystrokes that can be used in a list"),keystrokes:[{label:t("Increase list item indent"),keystroke:"Tab"},{label:t("Decrease list item indent"),keystroke:"Shift+Tab"}]})}}function v9(i,e,t,n){const s=i.document.differ.getChanges(),o=new Map,r=n.editor.config.get("list.multiBlock");let a=!1;for(const c of s){if(c.type=="insert"&&c.name!="$text"){const u=c.position.nodeAfter;if(!i.schema.checkAttribute(u,"listItemId"))for(const d of Array.from(u.getAttributeKeys()))t.includes(d)&&(e.removeAttribute(d,u),a=!0);Et(c.position,o),c.attributes.has("listItemId")||Et(c.position.getShiftedBy(c.length),o);for(const{item:d,previousPosition:h}of i.createRangeIn(u))_e(d)&&Et(h,o)}else c.type=="remove"?Et(c.position,o):c.type=="attribute"&&t.includes(c.attributeKey)&&(Et(c.range.start,o),c.attributeNewValue===null&&Et(c.range.start.getShiftedBy(1),o));if(!r&&c.type=="attribute"&&Nr.includes(c.attributeKey)){const u=c.range.start.nodeAfter;c.attributeNewValue===null&&u&&u.is("element","listItem")?(e.rename(u,"paragraph"),a=!0):c.attributeOldValue===null&&u&&u.is("element")&&u.name!="listItem"&&(e.rename(u,"listItem"),a=!0)}}const l=new Set;for(const c of o.values())a=n.fire("postFixer",{listNodes:new Y8(c),listHead:c,writer:e,seenIds:l})||a;return a}function y9(i){return(e,[t,n])=>{const s=t.is("documentFragment")?Array.from(t.getChildren()):[t];if(!s.length)return;const r=(n?i.createSelection(n):i.document.selection).getFirstPosition();let a;if(_e(r.parent))a=r.parent;else if(_e(r.nodeBefore))a=r.nodeBefore;else return;i.change(l=>{const c=a.getAttribute("listType"),u=a.getAttribute("listIndent"),d=s[0].getAttribute("listIndent")||0,h=Math.max(u-d,0);for(const f of s){const m=_e(f);a.is("element","listItem")&&f.is("element","paragraph")&&l.rename(f,"listItem"),l.setAttributes({listIndent:(m?f.getAttribute("listIndent"):0)+h,listItemId:m?f.getAttribute("listItemId"):$i.next(),listType:c},f)}})}}function u1(i,e){const t=i.document.selection;if(!t.isCollapsed)return!Xs(i);if(e==="forward")return!0;const s=t.getFirstPosition().parent,o=s.previousSibling;return i.schema.isObject(o)?!1:o.isEmpty?!0:Ys([s,o])}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function d1(i,e,t,n){i.ui.componentFactory.add(e,()=>{const s=h1(N,i,e,t,n);return s.set({tooltip:!0,isToggleable:!0}),s}),i.ui.componentFactory.add(`menuBar:${e}`,()=>h1(Ae,i,e,t,n))}function h1(i,e,t,n,s){const o=e.commands.get(t),r=new i(e.locale);return r.set({label:n,icon:s}),r.bind("isOn","isEnabled").to(o,"value","isEnabled"),r.on("execute",()=>{e.execute(t),e.editing.view.focus()}),r}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class C9 extends y{static get pluginName(){return"ListUI"}init(){const e=this.editor.t;this.editor.ui.componentFactory.has("numberedList")||d1(this.editor,"numberedList",e("Numbered List"),P.numberedList),this.editor.ui.componentFactory.has("bulletedList")||d1(this.editor,"bulletedList",e("Bulleted List"),P.bulletedList)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class k9 extends y{static get requires(){return[_9,C9]}static get pluginName(){return"List"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const T9=[{listStyle:"disc",typeAttribute:"disc",listType:"bulleted"},{listStyle:"circle",typeAttribute:"circle",listType:"bulleted"},{listStyle:"square",typeAttribute:"square",listType:"bulleted"},{listStyle:"decimal",typeAttribute:"1",listType:"numbered"},{listStyle:"decimal-leading-zero",typeAttribute:null,listType:"numbered"},{listStyle:"lower-roman",typeAttribute:"i",listType:"numbered"},{listStyle:"upper-roman",typeAttribute:"I",listType:"numbered"},{listStyle:"lower-alpha",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-alpha",typeAttribute:"A",listType:"numbered"},{listStyle:"lower-latin",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-latin",typeAttribute:"A",listType:"numbered"}];for(const{listStyle:i,typeAttribute:e,listType:t}of T9);/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */cs("Ctrl+Enter");/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */cs("Ctrl+Enter");/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const f1={"(":")","[":"]","{":"}"};class E9 extends F{constructor(e){super(e),this._isEnabledBasedOnSelection=!1}refresh(){const e=this.editor.model,t=e.document;this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"mention")}execute(e){const t=this.editor.model,s=t.document.selection,o=typeof e.mention=="string"?{id:e.mention}:e.mention,r=o.id,a=e.range||s.getFirstRange();if(!t.canEditAt(a))return;const l=e.text||r,c=m1({_text:l,id:r},o);if(e.marker.length!=1)throw new p("mentioncommand-incorrect-marker",this);if(r.charAt(0)!=e.marker)throw new p("mentioncommand-incorrect-id",this);t.change(u=>{const d=_t(s.getAttributes()),h=new Map(d.entries());h.set("mention",c);const f=t.insertContent(u.createText(l,h),a),m=f.start.nodeBefore,g=f.end.nodeAfter,b=g&&g.is("$text")&&g.data.startsWith(" ");let _=!1;if(m&&g&&m.is("$text")&&g.is("$text")){const T=m.data.slice(-1),O=T in f1,B=O&&g.data.startsWith(f1[T]);_=O&&B}!_&&!b&&t.insertContent(u.createText(" ",d),a.start.getShiftedBy(l.length))})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class A9 extends y{static get pluginName(){return"MentionEditing"}init(){const e=this.editor,t=e.model,n=t.document;t.schema.extend("$text",{allowAttributes:"mention"}),e.conversion.for("upcast").elementToAttribute({view:{name:"span",key:"data-mention",classes:"mention"},model:{key:"mention",value:s=>g1(s)}}),e.conversion.for("downcast").attributeToElement({model:"mention",view:S9}),e.conversion.for("downcast").add(x9),n.registerPostFixer(s=>R9(s,n,t.schema)),n.registerPostFixer(s=>M9(s,n)),n.registerPostFixer(s=>I9(s,n)),e.commands.add("mention",new E9(e))}}function m1(i,e){return Object.assign({uid:it()},i,e||{})}function g1(i,e){const t=i.getAttribute("data-mention"),n=i.getChild(0);if(!n)return;const s={id:t,_text:n.data};return m1(s,e)}function x9(i){i.on("attribute:mention",(e,t,n)=>{const s=t.attributeNewValue;if(!t.item.is("$textProxy")||!s)return;const o=t.range.start;(o.textNode||o.nodeAfter).data!=s._text&&n.consumable.consume(t.item,e.name)},{priority:"highest"})}function S9(i,{writer:e}){if(!i)return;const t={class:"mention","data-mention":i.id},n={id:i.uid,priority:20};return e.createAttributeElement("span",t,n)}function I9(i,e){const t=e.selection,n=t.focus;return t.isCollapsed&&t.hasAttribute("mention")&&P9(n)?(i.removeSelectionAttribute("mention"),!0):!1}function P9(i){const e=i.isAtStart;return i.nodeBefore&&i.nodeBefore.is("$text")||e}function R9(i,e,t){const n=e.differ.getChanges();let s=!1;for(const o of n){if(o.type=="attribute")continue;const r=o.position;if(o.name=="$text"){const a=r.textNode&&r.textNode.nextSibling;s=Wn(r.textNode,i)||s,s=Wn(a,i)||s,s=Wn(r.nodeBefore,i)||s,s=Wn(r.nodeAfter,i)||s}if(o.name!="$text"&&o.type=="insert"){const a=r.nodeAfter;for(const l of i.createRangeIn(a).getItems())s=Wn(l,i)||s}if(o.type=="insert"&&t.isInline(o.name)){const a=r.nodeAfter&&r.nodeAfter.nextSibling;s=Wn(r.nodeBefore,i)||s,s=Wn(a,i)||s}}return s}function M9(i,e){const t=e.differ.getChanges();let n=!1;for(const s of t)if(s.type==="attribute"&&s.attributeKey!="mention"){const o=s.range.start.nodeBefore,r=s.range.end.nodeAfter;for(const a of[o,r])p1(a)&&a.getAttribute(s.attributeKey)!=s.attributeNewValue&&(i.setAttribute(s.attributeKey,s.attributeNewValue,a),n=!0)}return n}function p1(i){if(!i||!(i.is("$text")||i.is("$textProxy"))||!i.hasAttribute("mention"))return!1;const e=i.data,n=i.getAttribute("mention")._text;return e!=n}function Wn(i,e){return p1(i)?(e.removeAttribute("mention",i),!0):!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class B9 extends ar{constructor(e){super(e),this.extendTemplate({attributes:{class:["ck-mentions"],tabindex:"-1"}})}selectFirst(){this.select(0)}selectNext(){const e=this.selected,t=this.items.getIndex(e);this.select(t+1)}selectPrevious(){const e=this.selected,t=this.items.getIndex(e);this.select(t-1)}select(e){let t=0;e>0&&e<this.items.length?t=e:e<0&&(t=this.items.length-1);const n=this.items.get(t);this.selected!==n&&(this.selected&&this.selected.removeHighlight(),n.highlight(),this.selected=n,this._isItemVisibleInScrolledArea(n)||(this.element.scrollTop=n.element.offsetTop))}executeSelected(){this.selected.fire("execute")}_isItemVisibleInScrolledArea(e){return new z(this.element).contains(new z(e.element))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class O9 extends R{constructor(e,t){super(e),this.template=void 0,this.domElement=t,this.domElement.classList.add("ck-button"),this.set("isOn",!1),this.on("change:isOn",(n,s,o)=>{o?(this.domElement.classList.add("ck-on"),this.domElement.classList.remove("ck-off")):(this.domElement.classList.add("ck-off"),this.domElement.classList.remove("ck-on"))}),this.listenTo(this.domElement,"click",()=>{this.fire("execute")})}render(){super.render(),this.element=this.domElement}focus(){this.domElement.focus()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class L9 extends Dn{highlight(){const e=this.children.first;e.isOn=!0}removeHighlight(){const e=this.children.first;e.isOn=!1}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Fr=3,V9=[U.arrowup,U.arrowdown,U.esc],D9=[U.enter,U.tab];class N9 extends y{static get pluginName(){return"MentionUI"}static get requires(){return[Ot]}constructor(e){super(e),this._items=new Oe,this._mentionsView=this._createMentionView(),this._mentionsConfigurations=new Map,this._requestFeedDebounced=St(this._requestFeed,100),e.config.define("mention",{feeds:[]})}init(){const e=this.editor,t=e.config.get("mention.commitKeys")||D9,n=V9.concat(t);this._balloon=e.plugins.get(Ot),e.editing.view.document.on("keydown",(r,a)=>{o(a.keyCode)&&this._isUIVisible&&(a.preventDefault(),r.stop(),a.keyCode==U.arrowdown&&this._mentionsView.selectNext(),a.keyCode==U.arrowup&&this._mentionsView.selectPrevious(),t.includes(a.keyCode)&&this._mentionsView.executeSelected(),a.keyCode==U.esc&&this._hideUIAndRemoveMarker())},{priority:"highest"}),Vn({emitter:this._mentionsView,activator:()=>this._isUIVisible,contextElements:()=>[this._balloon.view.element],callback:()=>this._hideUIAndRemoveMarker()});const s=e.config.get("mention.feeds");for(const r of s){const{feed:a,marker:l,dropdownLimit:c}=r;if(!j9(l))throw new p("mentionconfig-incorrect-marker",null,{marker:l});const u=typeof a=="function"?a.bind(this.editor):z9(a),d=r.itemRenderer,h={marker:l,feedCallback:u,itemRenderer:d,dropdownLimit:c};this._mentionsConfigurations.set(l,h)}this._setupTextWatcher(s),this.listenTo(e,"change:isReadOnly",()=>{this._hideUIAndRemoveMarker()}),this.on("requestFeed:response",(r,a)=>this._handleFeedResponse(a)),this.on("requestFeed:error",()=>this._hideUIAndRemoveMarker());function o(r){return n.includes(r)}}destroy(){super.destroy(),this._mentionsView.destroy()}get _isUIVisible(){return this._balloon.visibleView===this._mentionsView}_createMentionView(){const e=this.editor.locale,t=new B9(e);return t.items.bindTo(this._items).using(n=>{const{item:s,marker:o}=n,{dropdownLimit:r}=this._mentionsConfigurations.get(o),a=r||this.editor.config.get("mention.dropdownLimit")||10;if(t.items.length>=a)return null;const l=new L9(e),c=this._renderItem(s,o);return c.delegate("execute").to(l),l.children.add(c),l.item=s,l.marker=o,l.on("execute",()=>{t.fire("execute",{item:s,marker:o})}),l}),t.on("execute",(n,s)=>{const o=this.editor,r=o.model,a=s.item,l=s.marker,c=o.model.markers.get("mention"),u=r.createPositionAt(r.document.selection.focus),d=r.createPositionAt(c.getStart()),h=r.createRange(d,u);this._hideUIAndRemoveMarker(),o.execute("mention",{mention:a,text:a.text,marker:l,range:h}),o.editing.view.focus()}),t}_getItemRenderer(e){const{itemRenderer:t}=this._mentionsConfigurations.get(e);return t}_requestFeed(e,t){this._lastRequested=t;const{feedCallback:n}=this._mentionsConfigurations.get(e),s=n(t);if(!(s instanceof Promise)){this.fire("requestFeed:response",{feed:s,marker:e,feedText:t});return}s.then(r=>{this._lastRequested==t?this.fire("requestFeed:response",{feed:r,marker:e,feedText:t}):this.fire("requestFeed:discarded",{feed:r,marker:e,feedText:t})}).catch(r=>{this.fire("requestFeed:error",{error:r}),Q("mention-feed-callback-error",{marker:e})})}_setupTextWatcher(e){const t=this.editor,n=e.map(r=>({...r,pattern:w1(r.marker,r.minimumCharacters||0)})),s=new pm(t.model,$9(n));s.on("matched",(r,a)=>{const l=b1(n,a.text),u=t.model.document.selection.focus,d=t.model.createPositionAt(u.parent,l.position);if(H9(u)||W9(d)){this._hideUIAndRemoveMarker();return}const h=U9(l,a.text),f=l.marker.length+h.length,m=u.getShiftedBy(-f),g=u.getShiftedBy(-h.length),b=t.model.createRange(m,g);if(kc(t)){const _=t.model.markers.get("mention");t.model.change(T=>{T.updateMarker(_,{range:b})})}else t.model.change(_=>{_.addMarker("mention",{range:b,usingOperation:!1,affectsData:!1})});this._requestFeedDebounced(l.marker,h)}),s.on("unmatched",()=>{this._hideUIAndRemoveMarker()});const o=t.commands.get("mention");return s.bind("isEnabled").to(o),s}_handleFeedResponse(e){const{feed:t,marker:n}=e;if(!kc(this.editor))return;this._items.clear();for(const o of t){const r=typeof o!="object"?{id:o,text:o}:o;this._items.add({item:r,marker:n})}const s=this.editor.model.markers.get("mention");this._items.length?this._showOrUpdateUI(s):this._hideUIAndRemoveMarker()}_showOrUpdateUI(e){this._isUIVisible?this._balloon.updatePosition(this._getBalloonPanelPositionData(e,this._mentionsView.position)):this._balloon.add({view:this._mentionsView,position:this._getBalloonPanelPositionData(e,this._mentionsView.position),singleViewMode:!0}),this._mentionsView.position=this._balloon.view.position,this._mentionsView.selectFirst()}_hideUIAndRemoveMarker(){this._balloon.hasView(this._mentionsView)&&this._balloon.remove(this._mentionsView),kc(this.editor)&&this.editor.model.change(e=>e.removeMarker("mention")),this._mentionsView.position=void 0}_renderItem(e,t){const n=this.editor;let s,o=e.id;const r=this._getItemRenderer(t);if(r){const a=r(e);typeof a!="string"?s=new O9(n.locale,a):o=a}if(!s){const a=new N(n.locale);a.label=o,a.withText=!0,s=a}return s}_getBalloonPanelPositionData(e,t){const n=this.editor,s=n.editing,o=s.view.domConverter,r=s.mapper,a=n.locale.uiLanguageDirection;return{target:()=>{let l=e.getRange();l.start.root.rootName=="$graveyard"&&(l=n.model.document.selection.getFirstRange());const c=r.toViewRange(l);return z.getDomRangeRects(o.viewRangeToDom(c)).pop()},limiter:()=>{const l=this.editor.editing.view,u=l.document.selection.editableElement;return u?l.domConverter.mapViewToDom(u.root):null},positions:F9(t,a)}}}function F9(i,e){const t={caret_se:n=>({top:n.bottom+Fr,left:n.right,name:"caret_se",config:{withArrow:!1}}),caret_ne:(n,s)=>({top:n.top-s.height-Fr,left:n.right,name:"caret_ne",config:{withArrow:!1}}),caret_sw:(n,s)=>({top:n.bottom+Fr,left:n.right-s.width,name:"caret_sw",config:{withArrow:!1}}),caret_nw:(n,s)=>({top:n.top-s.height-Fr,left:n.right-s.width,name:"caret_nw",config:{withArrow:!1}})};return Object.prototype.hasOwnProperty.call(t,i)?[t[i]]:e!=="rtl"?[t.caret_se,t.caret_sw,t.caret_ne,t.caret_nw]:[t.caret_sw,t.caret_se,t.caret_nw,t.caret_ne]}function b1(i,e){let t;for(const n of i){const s=e.lastIndexOf(n.marker);s>0&&!e.substring(s-1).match(n.pattern)||(!t||s>=t.position)&&(t={marker:n.marker,position:s,minimumCharacters:n.minimumCharacters,pattern:n.pattern})}return t}function w1(i,e){const t=e==0?"*":`{${e},}`,o=`(?:^|[ ${$.features.isRegExpUnicodePropertySupported?`\\p{Ps}\\p{Pi}"'`:`\\(\\[{"'`}])([${i}])(.${t})$`;return new RegExp(o,"u")}function $9(i){return t=>{const n=b1(i,t);if(!n)return!1;let s=0;n.position!==0&&(s=n.position-1);const o=t.substring(s);return n.pattern.test(o)}}function U9(i,e){let t=0;i.position!==0&&(t=i.position-1);const n=w1(i.marker,0);return e.substring(t).match(n)[2]}function z9(i){return e=>i.filter(n=>(typeof n=="string"?n:String(n.id)).toLowerCase().includes(e.toLowerCase()))}function H9(i){const e=i.textNode&&i.textNode.hasAttribute("mention"),t=i.nodeBefore;return e||t&&t.is("$text")&&t.hasAttribute("mention")}function W9(i){const e=i.nodeAfter;return e&&e.is("$text")&&e.hasAttribute("mention")}function j9(i){return i&&i.length==1}function kc(i){return i.model.markers.has("mention")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class q9 extends y{toMentionAttribute(e,t){return g1(e,t)}static get pluginName(){return"Mention"}static get requires(){return[A9,N9]}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function G9(i){const e=parseFloat(i);return i.endsWith("pt")?Ui(e*96/72):i.endsWith("pc")?Ui(e*12*96/72):i.endsWith("in")?Ui(e*96):i.endsWith("cm")?Ui(e*96/2.54):i.endsWith("mm")?Ui(e/10*96/2.54):i}function _1(i){return i!==void 0&&i.endsWith("px")}function Ui(i){return i.toFixed(2).replace(/\.?0+$/,"")+"px"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function K9(i,e,t){if(!i.childCount)return;const n=new Ye(i.document),s=J9(i,n);if(!s.length)return;const o={},r=[];for(const a of s)if(a.indent!==void 0){Y9(a)||(r.length=0);const l=`${a.id}:${a.indent}`,c=Math.min(a.indent-1,r.length);if(c<r.length&&r[c].id!==a.id&&(r.length=c),c<r.length-1)r.length=c+1;else{const d=X9(a,e);if(c>r.length-1||r[c].listElement.name!=d.type){c==0&&d.type=="ol"&&a.id!==void 0&&o[l]&&(d.startIndex=o[l]);const h=nR(d,n,t);if(_1(a.marginLeft)&&(c==0||_1(r[c-1].marginLeft))){let f=a.marginLeft;c>0&&(f=Ui(parseFloat(f)-parseFloat(r[c-1].marginLeft))),n.setStyle("padding-left",f,h)}if(r.length==0){const f=a.element.parent,m=f.getChildIndex(a.element)+1;n.insertChild(m,h,f)}else{const f=r[c-1].listItemElements;n.appendChild(h,f[f.length-1])}r[c]={...a,listElement:h,listItemElements:[]},c==0&&a.id!==void 0&&(o[l]=d.startIndex||1)}}const u=a.element.name=="li"?a.element:n.createElement("li");n.appendChild(u,r[c].listElement),r[c].listItemElements.push(u),c==0&&a.id!==void 0&&o[l]++,a.element!=u&&n.appendChild(a.element,u),sR(a.element,n),n.removeStyle("text-indent",a.element),n.removeStyle("margin-left",a.element)}else{const l=r.find(c=>c.marginLeft==a.marginLeft);if(l){const c=l.listItemElements;n.appendChild(a.element,c[c.length-1]),n.removeStyle("margin-left",a.element)}else r.length=0}}function Z9(i,e){for(const t of e.createRangeIn(i)){const n=t.item;if(n.is("element","li")){const s=n.getChild(0);s&&s.is("element","p")&&e.unwrapElement(s)}}}function J9(i,e){const t=e.createRangeIn(i),n=[],s=new Set;for(const o of t.getItems()){if(!o.is("element")||!o.name.match(/^(p|h\d+|li|div)$/))continue;let r=oR(o);if(r!==void 0&&parseFloat(r)==0&&!Array.from(o.getClassNames()).find(a=>a.startsWith("MsoList"))&&(r=void 0),o.hasStyle("mso-list")||r!==void 0&&s.has(r)){const a=iR(o);n.push({element:o,id:a.id,order:a.order,indent:a.indent,marginLeft:r}),r!==void 0&&s.add(r)}else s.clear()}return n}function Y9(i){const e=i.element.previousSibling;return v1(e||i.element.parent)}function v1(i){return i.is("element","ol")||i.is("element","ul")}function X9(i,e){const t=new RegExp(`@list l${i.id}:level${i.indent}\\s*({[^}]*)`,"gi"),n=/mso-level-number-format:([^;]{0,100});/gi,s=/mso-level-start-at:\s{0,100}([0-9]{0,10})\s{0,100};/gi,o=new RegExp(`@list\\s+l${i.id}:level\\d\\s*{[^{]*mso-level-text:"%\\d\\\\.`,"gi"),r=new RegExp(`@list l${i.id}:level\\d\\s*{[^{]*mso-level-number-format:`,"gi"),a=o.exec(e),l=r.exec(e),c=a&&!l,u=t.exec(e);let d="decimal",h="ol",f=null;if(u&&u[1]){const m=n.exec(u[1]);if(m&&m[1]&&(d=m[1].trim(),h=d!=="bullet"&&d!=="image"?"ol":"ul"),d==="bullet"){const g=Q9(i.element);g&&(d=g)}else{const g=s.exec(u[1]);g&&g[1]&&(f=parseInt(g[1]))}c&&(h="ol")}return{type:h,startIndex:f,style:tR(d),isLegalStyleList:c}}function Q9(i){if(i.name=="li"&&i.parent.name=="ul"&&i.parent.hasAttribute("type"))return i.parent.getAttribute("type");const e=eR(i);if(!e)return null;const t=e._data;return t==="o"?"circle":t==="·"?"disc":t==="§"?"square":null}function eR(i){if(i.getChild(0).is("$text"))return null;for(const e of i.getChildren()){if(!e.is("element","span"))continue;const t=e.getChild(0);if(t)return t.is("$text")?t:t.getChild(0)}/* istanbul ignore next -- @preserve */return null}function tR(i){if(i.startsWith("arabic-leading-zero"))return"decimal-leading-zero";switch(i){case"alpha-upper":return"upper-alpha";case"alpha-lower":return"lower-alpha";case"roman-upper":return"upper-roman";case"roman-lower":return"lower-roman";case"circle":case"disc":case"square":return i;default:return null}}function nR(i,e,t){const n=e.createElement(i.type);return i.style&&e.setStyle("list-style-type",i.style,n),i.startIndex&&i.startIndex>1&&e.setAttribute("start",i.startIndex,n),i.isLegalStyleList&&t&&e.addClass("legal-list",n),n}function iR(i){const e=i.getStyle("mso-list");if(e===void 0)return{};const t=e.match(/(^|\s{1,100})l(\d+)/i),n=e.match(/\s{0,100}lfo(\d+)/i),s=e.match(/\s{0,100}level(\d+)/i);return t&&n&&s?{id:t[2],order:n[1],indent:parseInt(s[1])}:{indent:1}}function sR(i,e){const t=new Ge({name:"span",styles:{"mso-list":"Ignore"}}),n=e.createRangeIn(i);for(const s of n)s.type==="elementStart"&&t.match(s.item)&&e.remove(s.item)}function oR(i){const e=i.getStyle("margin-left");return e===void 0||e.endsWith("px")?e:G9(e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function rR(i,e){if(!i.childCount)return;const t=new Ye(i.document),n=lR(i,t);cR(n,i,t),dR(n,i,t),uR(i,t);const s=hR(i,t);s.length&&mR(s,fR(e),t)}function aR(i){return btoa(i.match(/\w{2}/g).map(e=>String.fromCharCode(parseInt(e,16))).join(""))}function lR(i,e){const t=e.createRangeIn(i),n=new Ge({name:/v:(.+)/}),s=[];for(const o of t){if(o.type!="elementStart")continue;const r=o.item,a=r.previousSibling,l=a&&a.is("element")?a.name:null,c=["Chart"],u=n.match(r),d=r.getAttribute("o:gfxdata"),h=l==="v:shapetype",f=d&&c.some(m=>r.getAttribute("id").includes(m));u&&d&&!h&&!f&&s.push(o.item.getAttribute("id"))}return s}function cR(i,e,t){const n=t.createRangeIn(e),s=new Ge({name:"img"}),o=[];for(const r of n)if(r.item.is("element")&&s.match(r.item)){const a=r.item,l=a.getAttribute("v:shapes")?a.getAttribute("v:shapes").split(" "):[];l.length&&l.every(c=>i.indexOf(c)>-1)?o.push(a):a.getAttribute("src")||o.push(a)}for(const r of o)t.remove(r)}function uR(i,e){const t=e.createRangeIn(i),n=new Ge({name:/v:(.+)/}),s=[];for(const o of t)o.type=="elementStart"&&n.match(o.item)&&s.push(o.item);for(const o of s)e.remove(o)}function dR(i,e,t){const n=t.createRangeIn(e),s=[];for(const a of n)if(a.type=="elementStart"&&a.item.is("element","v:shape")){const l=a.item.getAttribute("id");if(i.includes(l))continue;o(a.item.parent.getChildren(),l)||s.push(a.item)}for(const a of s){const l={src:r(a)};a.hasAttribute("alt")&&(l.alt=a.getAttribute("alt"));const c=t.createElement("img",l);t.insertChild(a.index+1,c,a.parent)}function o(a,l){for(const c of a){/* istanbul ignore else -- @preserve */if(c.is("element")&&(c.name=="img"&&c.getAttribute("v:shapes")==l||o(c.getChildren(),l)))return!0}return!1}function r(a){for(const l of a.getChildren()){/* istanbul ignore else -- @preserve */if(l.is("element")&&l.getAttribute("src"))return l.getAttribute("src")}}}function hR(i,e){const t=e.createRangeIn(i),n=new Ge({name:"img"}),s=[];for(const o of t)o.item.is("element")&&n.match(o.item)&&o.item.getAttribute("src").startsWith("file://")&&s.push(o.item);return s}function fR(i){if(!i)return[];const e=/{\\pict[\s\S]+?\\bliptag-?\d+(\\blipupi-?\d+)?({\\\*\\blipuid\s?[\da-fA-F]+)?[\s}]*?/,t=new RegExp("(?:("+e.source+"))([\\da-fA-F\\s]+)\\}","g"),n=i.match(t),s=[];if(n)for(const o of n){let r=!1;o.includes("\\pngblip")?r="image/png":o.includes("\\jpegblip")&&(r="image/jpeg"),r&&s.push({hex:o.replace(e,"").replace(/[^\da-fA-F]/g,""),type:r})}return s}function mR(i,e,t){if(i.length===e.length)for(let n=0;n<i.length;n++){const s=`data:${e[n].type};base64,${aR(e[n].hex)}`;t.setAttribute("src",s,i[n])}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function gR(i){const e=[],t=new Ye(i.document);for(const{item:n}of t.createRangeIn(i))if(n.is("element")){for(const s of n.getClassNames())/\bmso/gi.exec(s)&&t.removeClass(s,n);for(const s of n.getStyleNames())/\bmso/gi.exec(s)&&t.removeStyle(s,n);(n.is("element","w:sdt")||n.is("element","w:sdtpr")&&n.isEmpty||n.is("element","o:p")&&n.isEmpty)&&e.push(n)}for(const n of e){const s=n.parent,o=s.getChildIndex(n);t.insertChild(o,n.getChildren(),s),t.remove(n)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const pR=/<meta\s*name="?generator"?\s*content="?microsoft\s*word\s*\d+"?\/?>/i,bR=/xmlns:o="urn:schemas-microsoft-com/i;class wR{constructor(e,t=!1){this.document=e,this.hasMultiLevelListPlugin=t}isActive(e){return pR.test(e)||bR.test(e)}execute(e){const{body:t,stylesString:n}=e._parsedData;K9(t,n,this.hasMultiLevelListPlugin),rR(t,e.dataTransfer.getData("text/rtf")),gR(t),e.content=t}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function _R(i,e){for(const t of i.getChildren())if(t.is("element","b")&&t.getStyle("font-weight")==="normal"){const n=i.getChildIndex(t);e.remove(t),e.insertChild(n,t.getChildren(),i)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function vR(i,e){const t=new No(e.document.stylesProcessor),n=new Uo(t,{renderingMode:"data"}),s=n.blockElements,o=n.inlineObjectElements,r=[];for(const a of e.createRangeIn(i)){const l=a.item;if(l.is("element","br")){const c=y1(l,"forward",e,{blockElements:s,inlineObjectElements:o}),u=y1(l,"backward",e,{blockElements:s,inlineObjectElements:o}),d=C1(c,s);(C1(u,s)||d)&&r.push(l)}}for(const a of r)a.hasClass("Apple-interchange-newline")?e.remove(a):e.replace(a,e.createElement("p"))}function y1(i,e,t,{blockElements:n,inlineObjectElements:s}){let o=t.createPositionAt(i,e=="forward"?"after":"before");return o=o.getLastMatchingPosition(({item:r})=>r.is("element")&&!n.includes(r.name)&&!s.includes(r.name),{direction:e}),e=="forward"?o.nodeAfter:o.nodeBefore}function C1(i,e){return!!i&&i.is("element")&&e.includes(i.name)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const yR=/id=("|')docs-internal-guid-[-0-9a-f]+("|')/i;class CR{constructor(e){this.document=e}isActive(e){return yR.test(e)}execute(e){const t=new Ye(this.document),{body:n}=e._parsedData;_R(n,t),Z9(n,t),vR(n,t),e.content=n}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function kR(i,e){for(const t of i.getChildren())t.is("element","table")&&t.hasAttribute("xmlns")&&e.removeAttribute("xmlns",t)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function TR(i,e){for(const t of i.getChildren())if(t.is("element","google-sheets-html-origin")){const n=i.getChildIndex(t);e.remove(t),e.insertChild(n,t.getChildren(),i)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ER(i,e){for(const t of i.getChildren())t.is("element","table")&&t.getStyle("width")==="0px"&&e.removeStyle("width",t)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function AR(i,e){for(const t of Array.from(i.getChildren()))t.is("element","style")&&e.remove(t)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const xR=/<google-sheets-html-origin/i;class SR{constructor(e){this.document=e}isActive(e){return xR.test(e)}execute(e){const t=new Ye(this.document),{body:n}=e._parsedData;TR(n,t),kR(n,t),ER(n,t),AR(n,t),e.content=n}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function IR(i){return k1(k1(i)).replace(/(<span\s+style=['"]mso-spacerun:yes['"]>[^\S\r\n]*?)[\r\n]+([^\S\r\n]*<\/span>)/g,"$1$2").replace(/<span\s+style=['"]mso-spacerun:yes['"]><\/span>/g,"").replace(/(<span\s+style=['"]letter-spacing:[^'"]+?['"]>)[\r\n]+(<\/span>)/g,"$1 $2").replace(/ <\//g," </").replace(/ <o:p><\/o:p>/g," <o:p></o:p>").replace(/<o:p>(&nbsp;|\u00A0)<\/o:p>/g,"").replace(/>([^\S\r\n]*[\r\n]\s*)</g,"><")}function PR(i){i.querySelectorAll("span[style*=spacerun]").forEach(e=>{const t=e,n=t.innerText.length||0;t.innerText=Array(n+1).join("  ").substr(0,n)})}function k1(i){return i.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(e,t)=>t.length===1?" ":Array(t.length+1).join("  ").substr(0,t.length))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function RR(i,e){const t=new DOMParser;i=i.replace(/<!--\[if gte vml 1]>/g,""),i=i.replace(/<o:SmartTagType(?:\s+[^\s>=]+(?:="[^"]*")?)*\s*\/?>/gi,"");const n=IR(OR(i)),s=t.parseFromString(n,"text/html");PR(s);const o=s.body.innerHTML,r=MR(s,e),a=BR(s);return{body:r,bodyString:o,styles:a.styles,stylesString:a.stylesString}}function MR(i,e){const t=new No(e),n=new Uo(t,{renderingMode:"data"}),s=i.createDocumentFragment(),o=i.body.childNodes;for(;o.length>0;)s.appendChild(o[0]);return n.domToView(s,{skipComments:!0})}function BR(i){const e=[],t=[],n=Array.from(i.getElementsByTagName("style"));for(const s of n)s.sheet&&s.sheet.cssRules&&s.sheet.cssRules.length&&(e.push(s.sheet),t.push(s.innerHTML));return{styles:e,stylesString:t.join(" ")}}function OR(i){const e="</body>",t="</html>",n=i.indexOf(e);if(n<0)return i;const s=i.indexOf(t,n+e.length);return i.substring(0,n+e.length)+(s>=0?i.substring(s):"")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class LR extends y{static get pluginName(){return"PasteFromOffice"}static get requires(){return[Vt]}init(){const e=this.editor,t=e.plugins.get("ClipboardPipeline"),n=e.editing.view.document,s=[],o=this.editor.plugins.has("MultiLevelList");s.push(new wR(n,o)),s.push(new CR(n)),s.push(new SR(n)),t.on("inputTransformation",(r,a)=>{if(a._isTransformedWithPasteFromOffice||e.model.document.selection.getFirstPosition().parent.is("element","codeBlock"))return;const c=a.dataTransfer.getData("text/html"),u=s.find(d=>d.isActive(c));u&&(a._parsedData||(a._parsedData=RR(c,n.stylesProcessor)),u.execute(a),a._isTransformedWithPasteFromOffice=!0)},{priority:"high"})}}const VR='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.69 14.915c.053.052.173.083.36.093a.366.366 0 0 1 .345.485l-.003.01a.738.738 0 0 1-.697.497h-2.67a.374.374 0 0 1-.353-.496l.013-.038a.681.681 0 0 1 .644-.458c.197-.012.325-.043.386-.093a.28.28 0 0 0 .072-.11L9.592 4.5H6.269c-.359-.017-.609.013-.75.09-.142.078-.289.265-.442.563-.192.29-.516.464-.864.464H4.17a.43.43 0 0 1-.407-.569L4.46 3h13.08l-.62 2.043a.81.81 0 0 1-.775.574h-.114a.486.486 0 0 1-.486-.486c.001-.284-.054-.464-.167-.54-.112-.076-.367-.106-.766-.091h-3.28l-2.68 10.257c-.006.074.007.127.038.158zM3 17h8a.5.5 0 1 1 0 1H3a.5.5 0 1 1 0-1zm11.299 1.17a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.06-1.06l1.415 1.414 1.414-1.415a.75.75 0 1 1 1.06 1.06l-1.413 1.415 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414-1.414 1.414z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const $r="removeFormat";class DR extends y{static get pluginName(){return"RemoveFormatUI"}init(){const e=this.editor;e.ui.componentFactory.add($r,()=>{const t=this._createButton(N);return t.set({tooltip:!0}),t}),e.ui.componentFactory.add(`menuBar:${$r}`,()=>this._createButton(Ae))}_createButton(e){const t=this.editor,n=t.locale,s=t.commands.get($r),o=new e(t.locale),r=n.t;return o.set({label:r("Remove Format"),icon:VR}),o.bind("isEnabled").to(s,"isEnabled"),this.listenTo(o,"execute",()=>{t.execute($r),t.editing.view.focus()}),o}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class NR extends F{refresh(){const e=this.editor.model;this.isEnabled=!!ce(this._getFormattingItems(e.document.selection,e.schema))}execute(){const e=this.editor.model,t=e.schema;e.change(n=>{for(const s of this._getFormattingItems(e.document.selection,t))if(s.is("selection"))for(const o of this._getFormattingAttributes(s,t))n.removeSelectionAttribute(o);else{const o=n.createRangeOn(s);for(const r of this._getFormattingAttributes(s,t))n.removeAttribute(r,o)}})}*_getFormattingItems(e,t){const n=s=>!!ce(this._getFormattingAttributes(s,t));for(const s of e.getRanges())for(const o of s.getItems())!t.isBlock(o)&&n(o)&&(yield o);for(const s of e.getSelectedBlocks())n(s)&&(yield s);n(e)&&(yield e)}*_getFormattingAttributes(e,t){for(const[n]of e.getAttributes()){const s=t.getAttributeProperties(n);s&&s.isFormatting&&(yield n)}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class FR extends y{static get pluginName(){return"RemoveFormatEditing"}init(){const e=this.editor;e.commands.add("removeFormat",new NR(e))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $R extends y{static get requires(){return[FR,DR]}static get pluginName(){return"RemoveFormat"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Tc(i,e){const{modelAttribute:t,styleName:n,viewElement:s,defaultValue:o,reduceBoxSides:r=!1,shouldUpcast:a=()=>!0}=e;i.for("upcast").attributeToAttribute({view:{name:s,styles:{[n]:/[\s\S]+/}},model:{key:t,value:l=>{if(!a(l))return;const c=l.getNormalizedStyle(n),u=r?zr(c):c;if(o!==u)return u}}})}function Ec(i,e,t,n){i.for("upcast").add(s=>s.on("element:"+e,(o,r,a)=>{if(!r.modelRange)return;const l=["border-top-width","border-top-color","border-top-style","border-bottom-width","border-bottom-color","border-bottom-style","border-right-width","border-right-color","border-right-style","border-left-width","border-left-color","border-left-style"].filter(f=>r.viewItem.hasStyle(f));if(!l.length)return;const c={styles:l};if(!a.consumable.test(r.viewItem,c))return;const u=[...r.modelRange.getItems({shallow:!0})].pop();a.consumable.consume(r.viewItem,c);const d={style:r.viewItem.getNormalizedStyle("border-style"),color:r.viewItem.getNormalizedStyle("border-color"),width:r.viewItem.getNormalizedStyle("border-width")},h={style:zr(d.style),color:zr(d.color),width:zr(d.width)};h.style!==n.style&&a.writer.setAttribute(t.style,h.style,u),h.color!==n.color&&a.writer.setAttribute(t.color,h.color,u),h.width!==n.width&&a.writer.setAttribute(t.width,h.width,u)}))}function Qs(i,e){const{modelElement:t,modelAttribute:n,styleName:s}=e;i.for("downcast").attributeToAttribute({model:{name:t,key:n},view:o=>({key:"style",value:{[s]:o}})})}function Ur(i,e){const{modelAttribute:t,styleName:n}=e;i.for("downcast").add(s=>s.on(`attribute:${t}:table`,(o,r,a)=>{const{item:l,attributeNewValue:c}=r,{mapper:u,writer:d}=a;if(!a.consumable.consume(r.item,o.name))return;const h=[...u.toViewElement(l).getChildren()].find(f=>f.is("element","table"));c?d.setStyle(n,c,h):d.removeStyle(n,h)}))}function zr(i){if(!i)return;const e=["top","right","bottom","left"];if(!e.every(o=>i[o]))return i;const n=i.top;return e.every(o=>i[o]===n)?n:i}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function de(i,e,t,n,s=1){e!=null&&s!==void 0&&s!==null&&e>s?n.setAttribute(i,e,t):n.removeAttribute(i,t)}function jn(i,e,t={}){const n=i.createElement("tableCell",t);return i.insertElement("paragraph",n),i.insert(n,e),n}function Ac(i,e){const t=e.parent.parent,n=parseInt(t.getAttribute("headingColumns")||"0"),{column:s}=i.getCellLocation(e);return!!n&&s<n}function Hr(i,e,t){const{modelAttribute:n}=t;i.extend("tableCell",{allowAttributes:[n]}),Tc(e,{viewElement:/^(td|th)$/,...t}),Qs(e,{modelElement:"tableCell",...t})}function qn(i){const e=i.getSelectedElement();return e&&e.is("element","table")?e:i.getFirstPosition().findAncestor("table")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function UR(){return i=>{i.on("element:figure",(e,t,n)=>{if(!n.consumable.test(t.viewItem,{name:!0,classes:"table"}))return;const s=WR(t.viewItem);if(!s||!n.consumable.test(s,{name:!0}))return;n.consumable.consume(t.viewItem,{name:!0,classes:"table"});const o=n.convertItem(s,t.modelCursor),r=ce(o.modelRange.getItems());if(!r){n.consumable.revert(t.viewItem,{name:!0,classes:"table"});return}n.convertChildren(t.viewItem,n.writer.createPositionAt(r,"end")),n.updateConversionResult(r,t)})}}function zR(){return i=>{i.on("element:table",(e,t,n)=>{const s=t.viewItem;if(!n.consumable.test(s,{name:!0}))return;const{rows:o,headingRows:r,headingColumns:a}=jR(s),l={};a&&(l.headingColumns=a),r&&(l.headingRows=r);const c=n.writer.createElement("table",l);if(n.safeInsert(c,t.modelCursor)){if(n.consumable.consume(s,{name:!0}),o.forEach(u=>n.convertItem(u,n.writer.createPositionAt(c,"end"))),n.convertChildren(s,n.writer.createPositionAt(c,"end")),c.isEmpty){const u=n.writer.createElement("tableRow");n.writer.insert(u,n.writer.createPositionAt(c,"end")),jn(n.writer,n.writer.createPositionAt(u,"end"))}n.updateConversionResult(c,t)}})}}function HR(){return i=>{i.on("element:tr",(e,t)=>{t.viewItem.isEmpty&&t.modelCursor.index==0&&e.stop()},{priority:"high"})}}function T1(i){return e=>{e.on(`element:${i}`,(t,n,{writer:s})=>{if(!n.modelRange)return;const o=n.modelRange.start.nodeAfter,r=s.createPositionAt(o,0);if(n.viewItem.isEmpty){s.insertElement("paragraph",r);return}const a=Array.from(o.getChildren());if(a.every(l=>l.is("element","$marker"))){const l=s.createElement("paragraph");s.insert(l,s.createPositionAt(o,0));for(const c of a)s.move(s.createRangeOn(c),s.createPositionAt(l,"end"))}},{priority:"low"})}}function WR(i){for(const e of i.getChildren())if(e.is("element","table"))return e}function jR(i){let e=0,t;const n=[],s=[];let o;for(const r of Array.from(i.getChildren())){if(r.name!=="tbody"&&r.name!=="thead"&&r.name!=="tfoot")continue;r.name==="thead"&&!o&&(o=r);const a=Array.from(r.getChildren()).filter(l=>l.is("element","tr"));for(const l of a)if(o&&r===o||r.name==="tbody"&&Array.from(l.getChildren()).length&&Array.from(l.getChildren()).every(c=>c.is("element","th")))e++,n.push(l);else{s.push(l);const c=qR(l);(!t||c<t)&&(t=c)}}return{headingRows:e,headingColumns:t||0,rows:[...n,...s]}}function qR(i){let e=0,t=0;const n=Array.from(i.getChildren()).filter(s=>s.name==="th"||s.name==="td");for(;t<n.length&&n[t].name==="th";){const s=n[t],o=parseInt(s.getAttribute("colspan")||"1");e=e+o,t++}return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class X{constructor(e,t={}){this._jumpedToStartRow=!1,this._table=e,this._startRow=t.row!==void 0?t.row:t.startRow||0,this._endRow=t.row!==void 0?t.row:t.endRow,this._startColumn=t.column!==void 0?t.column:t.startColumn||0,this._endColumn=t.column!==void 0?t.column:t.endColumn,this._includeAllSlots=!!t.includeAllSlots,this._skipRows=new Set,this._row=0,this._rowIndex=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){this._canJumpToStartRow()&&this._jumpToNonSpannedRowClosestToStartRow();const e=this._table.getChild(this._rowIndex);if(!e||this._isOverEndRow())return{done:!0,value:void 0};if(!e.is("element","tableRow"))return this._rowIndex++,this.next();if(this._isOverEndColumn())return this._advanceToNextRow();let t=null;const n=this._getSpanned();if(n)this._includeAllSlots&&!this._shouldSkipSlot()&&(t=this._formatOutValue(n.cell,n.row,n.column));else{const s=e.getChild(this._cellIndex);if(!s)return this._advanceToNextRow();const o=parseInt(s.getAttribute("colspan")||"1"),r=parseInt(s.getAttribute("rowspan")||"1");(o>1||r>1)&&this._recordSpans(s,r,o),this._shouldSkipSlot()||(t=this._formatOutValue(s)),this._nextCellAtColumn=this._column+o}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,t||this.next()}skipRow(e){this._skipRows.add(e)}_advanceToNextRow(){return this._row++,this._rowIndex++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next()}_isOverEndRow(){return this._endRow!==void 0&&this._row>this._endRow}_isOverEndColumn(){return this._endColumn!==void 0&&this._column>this._endColumn}_formatOutValue(e,t=this._row,n=this._column){return{done:!1,value:new GR(this,e,t,n)}}_shouldSkipSlot(){const e=this._skipRows.has(this._row),t=this._row<this._startRow,n=this._column<this._startColumn,s=this._endColumn!==void 0&&this._column>this._endColumn;return e||t||n||s}_getSpanned(){const e=this._spannedCells.get(this._row);return e&&e.get(this._column)||null}_recordSpans(e,t,n){const s={cell:e,row:this._row,column:this._column};for(let o=this._row;o<this._row+t;o++)for(let r=this._column;r<this._column+n;r++)(o!=this._row||r!=this._column)&&this._markSpannedCell(o,r,s)}_markSpannedCell(e,t,n){this._spannedCells.has(e)||this._spannedCells.set(e,new Map),this._spannedCells.get(e).set(t,n)}_canJumpToStartRow(){return!!this._startRow&&this._startRow>0&&!this._jumpedToStartRow}_jumpToNonSpannedRowClosestToStartRow(){const e=this._getRowLength(0);for(let t=this._startRow;!this._jumpedToStartRow;t--)e===this._getRowLength(t)&&(this._row=t,this._rowIndex=t,this._jumpedToStartRow=!0)}_getRowLength(e){return[...this._table.getChild(e).getChildren()].reduce((n,s)=>n+parseInt(s.getAttribute("colspan")||"1"),0)}}class GR{constructor(e,t,n,s){this.cell=t,this.row=e._row,this.column=e._column,this.cellAnchorRow=n,this.cellAnchorColumn=s,this._cellIndex=e._cellIndex,this._rowIndex=e._rowIndex,this._table=e._table}get isAnchor(){return this.row===this.cellAnchorRow&&this.column===this.cellAnchorColumn}get cellWidth(){return parseInt(this.cell.getAttribute("colspan")||"1")}get cellHeight(){return parseInt(this.cell.getAttribute("rowspan")||"1")}get rowIndex(){return this._rowIndex}getPositionBefore(){return this._table.root.document.model.createPositionAt(this._table.getChild(this.row),this._cellIndex)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function E1(i,e){return(t,{writer:n})=>{const s=t.getAttribute("headingRows")||0,o=n.createContainerElement("table",null,[]),r=n.createContainerElement("figure",{class:"table"},o);s>0&&n.insert(n.createPositionAt(o,"end"),n.createContainerElement("thead",null,n.createSlot(a=>a.is("element","tableRow")&&a.index<s))),s<i.getRows(t)&&n.insert(n.createPositionAt(o,"end"),n.createContainerElement("tbody",null,n.createSlot(a=>a.is("element","tableRow")&&a.index>=s)));for(const{positionOffset:a,filter:l}of e.additionalSlots)n.insert(n.createPositionAt(o,a),n.createSlot(l));return n.insert(n.createPositionAt(o,"after"),n.createSlot(a=>a.is("element","tableRow")?!1:!e.additionalSlots.some(({filter:l})=>l(a)))),e.asWidget?ZR(r,n):r}}function KR(){return(i,{writer:e})=>i.isEmpty?e.createEmptyElement("tr"):e.createContainerElement("tr")}function A1(i={}){return(e,{writer:t})=>{const n=e.parent,s=n.parent,o=s.getChildIndex(n),r=new X(s,{row:o}),a=s.getAttribute("headingRows")||0,l=s.getAttribute("headingColumns")||0;let c=null;for(const u of r)if(u.cell==e){const h=u.row<a||u.column<l?"th":"td";c=i.asWidget?sc(t.createEditableElement(h),t):t.createContainerElement(h);break}return c}}function x1(i={}){return(e,{writer:t})=>{if(!e.parent.is("element","tableCell")||!S1(e))return null;if(i.asWidget)return t.createContainerElement("span",{class:"ck-table-bogus-paragraph"});{const n=t.createContainerElement("p");return t.setCustomProperty("dataPipeline:transparentRendering",!0,n),n}}}function S1(i){return i.parent.childCount==1&&!JR(i)}function ZR(i,e){return e.setCustomProperty("table",!0,i),Ws(i,e,{hasSelectionHandle:!0})}function JR(i){return!i.getAttributeKeys().next().done}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class YR extends F{refresh(){const e=this.editor.model,t=e.document.selection,n=e.schema;this.isEnabled=XR(t,n)}execute(e={}){const t=this.editor,n=t.model,s=t.plugins.get("TableUtils"),o=t.config.get("table.defaultHeadings.rows"),r=t.config.get("table.defaultHeadings.columns");e.headingRows===void 0&&o&&(e.headingRows=o),e.headingColumns===void 0&&r&&(e.headingColumns=r),n.change(a=>{const l=s.createTable(a,e);n.insertObject(l,null,null,{findOptimalPosition:"auto"}),a.setSelection(a.createPositionAt(l.getNodeByPath([0,0,0]),0))})}}function XR(i,e){const t=i.getFirstPosition().parent,n=t===t.root?t:t.parent;return e.checkChild(n,"table")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class I1 extends F{constructor(e,t={}){super(e),this.order=t.order||"below"}refresh(){const e=this.editor.model.document.selection,n=!!this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e).length;this.isEnabled=n}execute(){const e=this.editor,t=e.model.document.selection,n=e.plugins.get("TableUtils"),s=this.order==="above",o=n.getSelectionAffectedTableCells(t),r=n.getRowIndexes(o),a=s?r.first:r.last,l=o[0].findAncestor("table");n.insertRows(l,{at:s?a:a+1,copyStructureFromAbove:!s})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class P1 extends F{constructor(e,t={}){super(e),this.order=t.order||"right"}refresh(){const e=this.editor.model.document.selection,n=!!this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e).length;this.isEnabled=n}execute(){const e=this.editor,t=e.model.document.selection,n=e.plugins.get("TableUtils"),s=this.order==="left",o=n.getSelectionAffectedTableCells(t),r=n.getColumnIndexes(o),a=s?r.first:r.last,l=o[0].findAncestor("table");n.insertColumns(l,{columns:1,at:s?a:a+1})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class R1 extends F{constructor(e,t={}){super(e),this.direction=t.direction||"horizontally"}refresh(){const t=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=t.length===1}execute(){const e=this.editor.plugins.get("TableUtils"),t=e.getSelectionAffectedTableCells(this.editor.model.document.selection)[0];this.direction==="horizontally"?e.splitCellHorizontally(t,2):e.splitCellVertically(t,2)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function M1(i,e,t){const{startRow:n,startColumn:s,endRow:o,endColumn:r}=e,a=t.createElement("table"),l=o-n+1;for(let u=0;u<l;u++)t.insertElement("tableRow",a,"end");const c=[...new X(i,{startRow:n,endRow:o,startColumn:s,endColumn:r,includeAllSlots:!0})];for(const{row:u,column:d,cell:h,isAnchor:f,cellAnchorRow:m,cellAnchorColumn:g}of c){const b=u-n,_=a.getChild(b);if(!f)(m<n||g<s)&&jn(t,t.createPositionAt(_,"end"));else{const T=t.cloneElement(h);t.append(T,_),D1(T,u,d,o,r,t)}}return QR(a,i,n,s,t),a}function B1(i,e,t=0){const n=[],s=new X(i,{startRow:t,endRow:e-1});for(const o of s){const{row:r,cellHeight:a}=o,l=r+a-1;r<e&&e<=l&&n.push(o)}return n}function O1(i,e,t){const n=i.parent,s=n.parent,o=n.index,r=parseInt(i.getAttribute("rowspan")),a=e-o,l={},c=r-a;c>1&&(l.rowspan=c);const u=parseInt(i.getAttribute("colspan")||"1");u>1&&(l.colspan=u);const d=o,h=d+a,f=[...new X(s,{startRow:d,endRow:h,includeAllSlots:!0})];let m=null,g;for(const b of f){const{row:_,column:T,cell:O}=b;O===i&&g===void 0&&(g=T),g!==void 0&&g===T&&_===h&&(m=jn(t,b.getPositionBefore(),l))}return de("rowspan",a,i,t),m}function L1(i,e){const t=[],n=new X(i);for(const s of n){const{column:o,cellWidth:r}=s,a=o+r-1;o<e&&e<=a&&t.push(s)}return t}function V1(i,e,t,n){const s=parseInt(i.getAttribute("colspan")),o=t-e,r={},a=s-o;a>1&&(r.colspan=a);const l=parseInt(i.getAttribute("rowspan")||"1");l>1&&(r.rowspan=l);const c=jn(n,n.createPositionAfter(i),r);return de("colspan",o,i,n),c}function D1(i,e,t,n,s,o){const r=parseInt(i.getAttribute("colspan")||"1"),a=parseInt(i.getAttribute("rowspan")||"1");if(t+r-1>s){const u=s-t+1;de("colspan",u,i,o,1)}if(e+a-1>n){const u=n-e+1;de("rowspan",u,i,o,1)}}function QR(i,e,t,n,s){const o=parseInt(e.getAttribute("headingRows")||"0");if(o>0){const a=o-t;de("headingRows",a,i,s,0)}const r=parseInt(e.getAttribute("headingColumns")||"0");if(r>0){const a=r-n;de("headingColumns",a,i,s,0)}}function xc(i,e){const t=e.getColumns(i),n=new Array(t).fill(0);for(const{column:o}of new X(i))n[o]++;const s=n.reduce((o,r,a)=>r?o:[...o,a],[]);if(s.length>0){const o=s[s.length-1];return e.removeColumns(i,{at:o}),!0}return!1}function Sc(i,e){const t=[],n=e.getRows(i);for(let s=0;s<n;s++)i.getChild(s).isEmpty&&t.push(s);if(t.length>0){const s=t[t.length-1];return e.removeRows(i,{at:s}),!0}return!1}function Ic(i,e){xc(i,e)||Sc(i,e)}function N1(i,e){const t=Array.from(new X(i,{startColumn:e.firstColumn,endColumn:e.lastColumn,row:e.lastRow}));if(t.every(({cellHeight:o})=>o===1))return e.lastRow;const s=t[0].cellHeight-1;return e.lastRow+s}function F1(i,e){const t=Array.from(new X(i,{startRow:e.firstRow,endRow:e.lastRow,column:e.lastColumn}));if(t.every(({cellWidth:o})=>o===1))return e.lastColumn;const s=t[0].cellWidth-1;return e.lastColumn+s}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Wr extends F{constructor(e,t){super(e),this.direction=t.direction,this.isHorizontal=this.direction=="right"||this.direction=="left"}refresh(){const e=this._getMergeableCell();this.value=e,this.isEnabled=!!e}execute(){const e=this.editor.model,t=e.document,s=this.editor.plugins.get("TableUtils").getTableCellsContainingSelection(t.selection)[0],o=this.value,r=this.direction;e.change(a=>{const l=r=="right"||r=="down",c=l?s:o,u=l?o:s,d=u.parent;nM(u,c,a);const h=this.isHorizontal?"colspan":"rowspan",f=parseInt(s.getAttribute(h)||"1"),m=parseInt(o.getAttribute(h)||"1");a.setAttribute(h,f+m,c),a.setSelection(a.createRangeIn(c));const g=this.editor.plugins.get("TableUtils"),b=d.findAncestor("table");Ic(b,g)})}_getMergeableCell(){const t=this.editor.model.document,n=this.editor.plugins.get("TableUtils"),s=n.getTableCellsContainingSelection(t.selection)[0];if(!s)return;const o=this.isHorizontal?eM(s,this.direction,n):tM(s,this.direction,n);if(!o)return;const r=this.isHorizontal?"rowspan":"colspan",a=parseInt(s.getAttribute(r)||"1");if(parseInt(o.getAttribute(r)||"1")===a)return o}}function eM(i,e,t){const s=i.parent.parent,o=e=="right"?i.nextSibling:i.previousSibling,r=(s.getAttribute("headingColumns")||0)>0;if(!o)return;const a=e=="right"?i:o,l=e=="right"?o:i,{column:c}=t.getCellLocation(a),{column:u}=t.getCellLocation(l),d=parseInt(a.getAttribute("colspan")||"1"),h=Ac(t,a),f=Ac(t,l);return r&&h!=f?void 0:c+d===u?o:void 0}function tM(i,e,t){const n=i.parent,s=n.parent,o=s.getChildIndex(n);if(e=="down"&&o===t.getRows(s)-1||e=="up"&&o===0)return null;const r=parseInt(i.getAttribute("rowspan")||"1"),a=s.getAttribute("headingRows")||0,l=e=="down"&&o+r===a,c=e=="up"&&o===a;if(a&&(l||c))return null;const u=parseInt(i.getAttribute("rowspan")||"1"),d=e=="down"?o+u:o,h=[...new X(s,{endRow:d})],m=h.find(b=>b.cell===i).column,g=h.find(({row:b,cellHeight:_,column:T})=>T!==m?!1:e=="down"?b===d:d===b+_);return g&&g.cell?g.cell:null}function nM(i,e,t){$1(i)||($1(e)&&t.remove(t.createRangeIn(e)),t.move(t.createRangeIn(i),t.createPositionAt(e,"end"))),t.remove(i)}function $1(i){const e=i.getChild(0);return i.childCount==1&&e.is("element","paragraph")&&e.isEmpty}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class iM extends F{refresh(){const e=this.editor.plugins.get("TableUtils"),t=e.getSelectionAffectedTableCells(this.editor.model.document.selection),n=t[0];if(n){const s=n.findAncestor("table"),r=e.getRows(s)-1,a=e.getRowIndexes(t),l=a.first===0&&a.last===r;this.isEnabled=!l}else this.isEnabled=!1}execute(){const e=this.editor.model,t=this.editor.plugins.get("TableUtils"),n=t.getSelectionAffectedTableCells(e.document.selection),s=t.getRowIndexes(n),o=n[0],r=o.findAncestor("table"),a=t.getCellLocation(o).column;e.change(l=>{const c=s.last-s.first+1;t.removeRows(r,{at:s.first,rows:c});const u=sM(r,s.first,a,t.getRows(r));l.setSelection(l.createPositionAt(u,0))})}}function sM(i,e,t,n){const s=i.getChild(Math.min(e,n-1));let o=s.getChild(0),r=0;for(const a of s.getChildren()){if(r>t)return o;o=a,r+=parseInt(a.getAttribute("colspan")||"1")}return o}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oM extends F{refresh(){const e=this.editor.plugins.get("TableUtils"),t=e.getSelectionAffectedTableCells(this.editor.model.document.selection),n=t[0];if(n){const s=n.findAncestor("table"),o=e.getColumns(s),{first:r,last:a}=e.getColumnIndexes(t);this.isEnabled=a-r<o-1}else this.isEnabled=!1}execute(){const e=this.editor.plugins.get("TableUtils"),[t,n]=aM(this.editor.model.document.selection,e),s=t.parent.parent,o=[...new X(s)],r={first:o.find(l=>l.cell===t).column,last:o.find(l=>l.cell===n).column},a=rM(o,t,n,r);this.editor.model.change(l=>{const c=r.last-r.first+1;e.removeColumns(s,{at:r.first,columns:c}),l.setSelection(l.createPositionAt(a,0))})}}function rM(i,e,t,n){return parseInt(t.getAttribute("colspan")||"1")>1?t:e.previousSibling||t.nextSibling?t.nextSibling||e.previousSibling:n.first?i.reverse().find(({column:o})=>o<n.first).cell:i.reverse().find(({column:o})=>o>n.last).cell}function aM(i,e){const t=e.getSelectionAffectedTableCells(i),n=t[0],s=t.pop(),o=[n,s];return n.isBefore(s)?o:o.reverse()}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class lM extends F{refresh(){const e=this.editor.plugins.get("TableUtils"),t=this.editor.model,n=e.getSelectionAffectedTableCells(t.document.selection),s=n.length>0;this.isEnabled=s,this.value=s&&n.every(o=>this._isInHeading(o,o.parent.parent))}execute(e={}){if(e.forceValue===this.value)return;const t=this.editor.plugins.get("TableUtils"),n=this.editor.model,s=t.getSelectionAffectedTableCells(n.document.selection),o=s[0].findAncestor("table"),{first:r,last:a}=t.getRowIndexes(s),l=this.value?r:a+1,c=o.getAttribute("headingRows")||0;n.change(u=>{if(l){const d=l>c?c:0,h=B1(o,l,d);for(const{cell:f}of h)O1(f,l,u)}de("headingRows",l,o,u,0)})}_isInHeading(e,t){const n=parseInt(t.getAttribute("headingRows")||"0");return!!n&&e.parent.index<n}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class cM extends F{refresh(){const e=this.editor.model,t=this.editor.plugins.get("TableUtils"),n=t.getSelectionAffectedTableCells(e.document.selection),s=n.length>0;this.isEnabled=s,this.value=s&&n.every(o=>Ac(t,o))}execute(e={}){if(e.forceValue===this.value)return;const t=this.editor.plugins.get("TableUtils"),n=this.editor.model,s=t.getSelectionAffectedTableCells(n.document.selection),o=s[0].findAncestor("table"),{first:r,last:a}=t.getColumnIndexes(s),l=this.value?r:a+1;n.change(c=>{if(l){const u=L1(o,l);for(const{cell:d,column:h}of u)V1(d,h,l,c)}de("headingColumns",l,o,c,0)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const uM=5,Pc=40,dM=2;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function hM(i){const e=new Set;for(const t of i.document.differ.getChanges()){let n=null;switch(t.type){case"insert":n=["table","tableRow","tableCell"].includes(t.name)?t.position:null;break;case"remove":n=["tableRow","tableCell"].includes(t.name)?t.position:null;break;case"attribute":t.range.start.nodeAfter&&(n=["table","tableRow","tableCell"].includes(t.range.start.nodeAfter.name)?t.range.start:null);break}if(!n)continue;const s=n.nodeAfter&&n.nodeAfter.is("element","table")?n.nodeAfter:n.findAncestor("table");for(const o of i.createRangeOn(s).getItems())o.is("element","table")&&to(o)&&e.add(o)}return e}function fM(i,e){return Pc*100/U1(i,e)}function U1(i,e){const t=z1(i,"tbody",e)||z1(i,"thead",e),n=e.editing.view.domConverter.mapViewToDom(t);return Rc(n)}function z1(i,e,t){return[...[...t.editing.mapper.toViewElement(i).getChildren()].find(o=>o.is("element","table")).getChildren()].find(o=>o.is("element",e))}function Rc(i){const e=I.window.getComputedStyle(i);return e.boxSizing==="border-box"?parseFloat(e.width)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderLeftWidth)-parseFloat(e.borderRightWidth):parseFloat(e.width)}function mM(i,e){const t=e.getCellLocation(i).column,n=i.getAttribute("colspan")||1;return{leftEdge:t,rightEdge:t+n-1}}function ze(i){const e=Math.pow(10,dM),t=typeof i=="number"?i:parseFloat(i);return Math.round(t*e)/e}function gM(i,e,t){return i<=e?ze(e):i>=t?ze(t):ze(i)}function pM(i,e){return Array(i).fill(e)}function eo(i){return i.map(e=>typeof e=="number"?e:parseFloat(e)).filter(e=>!Number.isNaN(e)).reduce((e,t)=>e+t,0)}function Mc(i){const e=i.map(s=>s==="auto"?s:parseFloat(s.replace("%","")));let t=bM(e);const n=eo(t);return n!==100&&(t=t.map(s=>ze(s*100/n)).map((s,o,r)=>{if(!(o===r.length-1))return s;const l=eo(r);return ze(s+100-l)})),t.map(s=>s+"%")}function bM(i){const e=i.filter(s=>s==="auto").length;if(e===0)return i.map(s=>ze(s));const t=eo(i),n=Math.max((100-t)/e,uM);return i.map(s=>s==="auto"?n:s).map(s=>ze(s))}function wM(i){const e=I.window.getComputedStyle(i);return e.boxSizing==="border-box"?parseInt(e.width):parseFloat(e.width)+parseFloat(e.paddingLeft)+parseFloat(e.paddingRight)+parseFloat(e.borderWidth)}function H1(i,e,t,n){for(let s=0;s<Math.max(t.length,i.length);s++){const o=i[s],r=t[s];r?o?n.setAttribute("columnWidth",r,o):n.appendElement("tableColumn",{columnWidth:r},e):n.remove(o)}}function to(i){if(i.is("element","tableColumnGroup"))return i;const e=i.getChildren();return Array.from(e).find(t=>t.is("element","tableColumnGroup"))}function no(i){const e=to(i);return e?Array.from(e.getChildren()):[]}function _M(i){return no(i).map(e=>e.getAttribute("columnWidth"))}function vM(i,e){return no(i).reduce((n,s)=>{const o=s.getAttribute("columnWidth"),r=s.getAttribute("colSpan");if(!r)return n.push(o),n;for(let a=0;a<r;a++)n.push(o);return e.removeAttribute("colSpan",s),n},[])}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ce extends y{static get pluginName(){return"TableUtils"}init(){this.decorate("insertColumns"),this.decorate("insertRows")}getCellLocation(e){const t=e.parent,n=t.parent,s=n.getChildIndex(t),o=new X(n,{row:s});for(const{cell:r,row:a,column:l}of o)if(r===e)return{row:a,column:l};/* istanbul ignore next -- @preserve */}createTable(e,t){const n=e.createElement("table"),s=t.rows||2,o=t.columns||2;return Bc(e,n,0,s,o),t.headingRows&&de("headingRows",Math.min(t.headingRows,s),n,e,0),t.headingColumns&&de("headingColumns",Math.min(t.headingColumns,o),n,e,0),n}insertRows(e,t={}){const n=this.editor.model,s=t.at||0,o=t.rows||1,r=t.copyStructureFromAbove!==void 0,a=t.copyStructureFromAbove?s-1:s,l=this.getRows(e),c=this.getColumns(e);if(s>l)throw new p("tableutils-insertrows-insert-out-of-range",this,{options:t});n.change(u=>{const d=e.getAttribute("headingRows")||0;if(d>s&&de("headingRows",d+o,e,u,0),!r&&(s===0||s===l)){Bc(u,e,s,o,c);return}const h=r?Math.max(s,a):s,f=new X(e,{endRow:h}),m=new Array(c).fill(1);for(const{row:g,column:b,cellHeight:_,cellWidth:T,cell:O}of f){const B=g+_-1,W=g<s&&s<=B,S=g<=a&&a<=B;W?(u.setAttribute("rowspan",_+o,O),m[b]=-T):r&&S&&(m[b]=T)}for(let g=0;g<o;g++){const b=u.createElement("tableRow");u.insert(b,e,s);for(let _=0;_<m.length;_++){const T=m[_],O=u.createPositionAt(b,"end");T>0&&jn(u,O,T>1?{colspan:T}:void 0),_+=Math.abs(T)-1}}})}insertColumns(e,t={}){const n=this.editor.model,s=t.at||0,o=t.columns||1;n.change(r=>{const a=e.getAttribute("headingColumns");s<a&&r.setAttribute("headingColumns",a+o,e);const l=this.getColumns(e);if(s===0||l===s){for(const u of e.getChildren())u.is("element","tableRow")&&zi(o,r,r.createPositionAt(u,s?"end":0));return}const c=new X(e,{column:s,includeAllSlots:!0});for(const u of c){const{row:d,cell:h,cellAnchorColumn:f,cellAnchorRow:m,cellWidth:g,cellHeight:b}=u;if(f<s){r.setAttribute("colspan",g+o,h);const _=m+b-1;for(let T=d;T<=_;T++)c.skipRow(T)}else zi(o,r,u.getPositionBefore())}})}removeRows(e,t){const n=this.editor.model,s=t.rows||1,o=this.getRows(e),r=t.at,a=r+s-1;if(a>o-1)throw new p("tableutils-removerows-row-index-out-of-range",this,{table:e,options:t});n.change(l=>{const c={first:r,last:a},{cellsToMove:u,cellsToTrim:d}=kM(e,c);if(u.size){const h=a+1;TM(e,h,u,l)}for(let h=a;h>=r;h--)l.remove(e.getChild(h));for(const{rowspan:h,cell:f}of d)de("rowspan",h,f,l);CM(e,c,l),xc(e,this)||Sc(e,this)})}removeColumns(e,t){const n=this.editor.model,s=t.at,o=t.columns||1,r=t.at+o-1;n.change(a=>{yM(e,{first:s,last:r},a);const l=no(e);for(let c=r;c>=s;c--){for(const{cell:u,column:d,cellWidth:h}of[...new X(e)])d<=c&&h>1&&d+h>c?de("colspan",h-1,u,a):d===c&&a.remove(u);if(l[c]){const u=c===0?l[1]:l[c-1],d=parseFloat(l[c].getAttribute("columnWidth")),h=parseFloat(u.getAttribute("columnWidth"));a.remove(l[c]),a.setAttribute("columnWidth",d+h+"%",u)}}Sc(e,this)||xc(e,this)})}splitCellVertically(e,t=2){const n=this.editor.model,o=e.parent.parent,r=parseInt(e.getAttribute("rowspan")||"1"),a=parseInt(e.getAttribute("colspan")||"1");n.change(l=>{if(a>1){const{newCellsSpan:c,updatedSpan:u}=W1(a,t);de("colspan",u,e,l);const d={};c>1&&(d.colspan=c),r>1&&(d.rowspan=r);const h=a>t?t-1:a-1;zi(h,l,l.createPositionAfter(e),d)}if(a<t){const c=t-a,u=[...new X(o)],{column:d}=u.find(({cell:g})=>g===e),h=u.filter(({cell:g,cellWidth:b,column:_})=>{const T=g!==e&&_===d,O=_<d&&_+b>d;return T||O});for(const{cell:g,cellWidth:b}of h)l.setAttribute("colspan",b+c,g);const f={};r>1&&(f.rowspan=r),zi(c,l,l.createPositionAfter(e),f);const m=o.getAttribute("headingColumns")||0;m>d&&de("headingColumns",m+c,o,l)}})}splitCellHorizontally(e,t=2){const n=this.editor.model,s=e.parent,o=s.parent,r=o.getChildIndex(s),a=parseInt(e.getAttribute("rowspan")||"1"),l=parseInt(e.getAttribute("colspan")||"1");n.change(c=>{if(a>1){const u=[...new X(o,{startRow:r,endRow:r+a-1,includeAllSlots:!0})],{newCellsSpan:d,updatedSpan:h}=W1(a,t);de("rowspan",h,e,c);const{column:f}=u.find(({cell:g})=>g===e),m={};d>1&&(m.rowspan=d),l>1&&(m.colspan=l);for(const g of u){const{column:b,row:_}=g,T=_>=r+h,O=b===f,B=(_+r+h)%d===0;T&&O&&B&&zi(1,c,g.getPositionBefore(),m)}}if(a<t){const u=t-a,d=[...new X(o,{startRow:0,endRow:r})];for(const{cell:m,cellHeight:g,row:b}of d)if(m!==e&&b+g>r){const _=g+u;c.setAttribute("rowspan",_,m)}const h={};l>1&&(h.colspan=l),Bc(c,o,r+1,u,1,h);const f=o.getAttribute("headingRows")||0;f>r&&de("headingRows",f+u,o,c)}})}getColumns(e){return[...e.getChild(0).getChildren()].filter(n=>n.is("element","tableCell")).reduce((n,s)=>{const o=parseInt(s.getAttribute("colspan")||"1");return n+o},0)}getRows(e){return Array.from(e.getChildren()).reduce((t,n)=>n.is("element","tableRow")?t+1:t,0)}createTableWalker(e,t={}){return new X(e,t)}getSelectedTableCells(e){const t=[];for(const n of this.sortRanges(e.getRanges())){const s=n.getContainedElement();s&&s.is("element","tableCell")&&t.push(s)}return t}getTableCellsContainingSelection(e){const t=[];for(const n of e.getRanges()){const s=n.start.findAncestor("tableCell");s&&t.push(s)}return t}getSelectionAffectedTableCells(e){const t=this.getSelectedTableCells(e);return t.length?t:this.getTableCellsContainingSelection(e)}getRowIndexes(e){const t=e.map(n=>n.parent.index);return this._getFirstLastIndexesObject(t)}getColumnIndexes(e){const t=e[0].findAncestor("table"),s=[...new X(t)].filter(o=>e.includes(o.cell)).map(o=>o.column);return this._getFirstLastIndexesObject(s)}isSelectionRectangular(e){if(e.length<2||!this._areCellInTheSameTableSection(e))return!1;const t=new Set,n=new Set;let s=0;for(const r of e){const{row:a,column:l}=this.getCellLocation(r),c=parseInt(r.getAttribute("rowspan"))||1,u=parseInt(r.getAttribute("colspan"))||1;t.add(a),n.add(l),c>1&&t.add(a+c-1),u>1&&n.add(l+u-1),s+=c*u}return AM(t,n)==s}sortRanges(e){return Array.from(e).sort(EM)}_getFirstLastIndexesObject(e){const t=e.sort((o,r)=>o-r),n=t[0],s=t[t.length-1];return{first:n,last:s}}_areCellInTheSameTableSection(e){const t=e[0].findAncestor("table"),n=this.getRowIndexes(e),s=parseInt(t.getAttribute("headingRows"))||0;if(!this._areIndexesInSameSection(n,s))return!1;const o=this.getColumnIndexes(e),r=parseInt(t.getAttribute("headingColumns"))||0;return this._areIndexesInSameSection(o,r)}_areIndexesInSameSection({first:e,last:t},n){const s=e<n,o=t<n;return s===o}}function Bc(i,e,t,n,s,o={}){for(let r=0;r<n;r++){const a=i.createElement("tableRow");i.insert(a,e,t),zi(s,i,i.createPositionAt(a,"end"),o)}}function zi(i,e,t,n={}){for(let s=0;s<i;s++)jn(e,t,n)}function W1(i,e){if(i<e)return{newCellsSpan:1,updatedSpan:1};const t=Math.floor(i/e),n=i-t*e+t;return{newCellsSpan:t,updatedSpan:n}}function yM(i,e,t){const n=i.getAttribute("headingColumns")||0;if(n&&e.first<n){const s=Math.min(n-1,e.last)-e.first+1;t.setAttribute("headingColumns",n-s,i)}}function CM(i,{first:e,last:t},n){const s=i.getAttribute("headingRows")||0;if(e<s){const o=t<s?s-(t-e+1):e;de("headingRows",o,i,n,0)}}function kM(i,{first:e,last:t}){const n=new Map,s=[];for(const{row:o,column:r,cellHeight:a,cell:l}of new X(i,{endRow:t})){const c=o+a-1;if(o>=e&&o<=t&&c>t){const h=t-o+1,f=a-h;n.set(r,{cell:l,rowspan:f})}if(o<e&&c>=e){let h;c>=t?h=t-e+1:h=c-e+1,s.push({cell:l,rowspan:a-h})}}return{cellsToMove:n,cellsToTrim:s}}function TM(i,e,t,n){const o=[...new X(i,{includeAllSlots:!0,row:e})],r=i.getChild(e);let a;for(const{column:l,cell:c,isAnchor:u}of o)if(t.has(l)){const{cell:d,rowspan:h}=t.get(l),f=a?n.createPositionAfter(a):n.createPositionAt(r,0);n.move(n.createRangeOn(d),f),de("rowspan",h,d,n),a=d}else u&&(a=c)}function EM(i,e){const t=i.start,n=e.start;return t.isBefore(n)?-1:1}function AM(i,e){const t=Array.from(i.values()),n=Array.from(e.values()),s=Math.max(...t),o=Math.min(...t),r=Math.max(...n),a=Math.min(...n);return(s-o+1)*(r-a+1)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class xM extends F{refresh(){const e=this.editor.plugins.get(Ce),t=e.getSelectedTableCells(this.editor.model.document.selection);this.isEnabled=e.isSelectionRectangular(t)}execute(){const e=this.editor.model,t=this.editor.plugins.get(Ce);e.change(n=>{const s=t.getSelectedTableCells(e.document.selection),o=s.shift(),{mergeWidth:r,mergeHeight:a}=IM(o,s,t);de("colspan",r,o,n),de("rowspan",a,o,n);for(const c of s)SM(c,o,n);const l=o.findAncestor("table");Ic(l,t),n.setSelection(o,"in")})}}function SM(i,e,t){j1(i)||(j1(e)&&t.remove(t.createRangeIn(e)),t.move(t.createRangeIn(i),t.createPositionAt(e,"end"))),t.remove(i)}function j1(i){const e=i.getChild(0);return i.childCount==1&&e.is("element","paragraph")&&e.isEmpty}function IM(i,e,t){let n=0,s=0;for(const c of e){const{row:u,column:d}=t.getCellLocation(c);n=q1(c,d,n,"colspan"),s=q1(c,u,s,"rowspan")}const{row:o,column:r}=t.getCellLocation(i),a=n-r,l=s-o;return{mergeWidth:a,mergeHeight:l}}function q1(i,e,t,n){const s=parseInt(i.getAttribute(n)||"1");return Math.max(t,e+s)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class PM extends F{constructor(e){super(e),this.affectsData=!1}refresh(){const t=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=t.length>0}execute(){const e=this.editor.model,t=this.editor.plugins.get("TableUtils"),n=t.getSelectionAffectedTableCells(e.document.selection),s=t.getRowIndexes(n),o=n[0].findAncestor("table"),r=[];for(let a=s.first;a<=s.last;a++)for(const l of o.getChild(a).getChildren())r.push(e.createRangeOn(l));e.change(a=>{a.setSelection(r)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class RM extends F{constructor(e){super(e),this.affectsData=!1}refresh(){const t=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=t.length>0}execute(){const e=this.editor.plugins.get("TableUtils"),t=this.editor.model,n=e.getSelectionAffectedTableCells(t.document.selection),s=n[0],o=n.pop(),r=s.findAncestor("table"),a=e.getCellLocation(s),l=e.getCellLocation(o),c=Math.min(a.column,l.column),u=Math.max(a.column,l.column),d=[];for(const h of new X(r,{startColumn:c,endColumn:u}))d.push(t.createRangeOn(h.cell));t.change(h=>{h.setSelection(d)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function MM(i){i.document.registerPostFixer(e=>BM(e,i))}function BM(i,e){const t=e.document.differ.getChanges();let n=!1;const s=new Set;for(const o of t){let r=null;o.type=="insert"&&o.name=="table"&&(r=o.position.nodeAfter),(o.type=="insert"||o.type=="remove")&&(o.name=="tableRow"||o.name=="tableCell")&&(r=o.position.findAncestor("table")),NM(o)&&(r=o.range.start.findAncestor("table")),r&&!s.has(r)&&(n=OM(r,i)||n,n=LM(r,i)||n,s.add(r))}return n}function OM(i,e){let t=!1;const n=VM(i);if(n.length){t=!0;for(const s of n)de("rowspan",s.rowspan,s.cell,e,1)}return t}function LM(i,e){let t=!1;const n=DM(i),s=[];for(const[l,c]of n.entries())!c&&i.getChild(l).is("element","tableRow")&&s.push(l);if(s.length){t=!0;for(const l of s.reverse())e.remove(i.getChild(l)),n.splice(l,1)}const o=n.filter((l,c)=>i.getChild(c).is("element","tableRow")),r=o[0];if(!o.every(l=>l===r)){const l=o.reduce((c,u)=>u>c?u:c,0);for(const[c,u]of o.entries()){const d=l-u;if(d){for(let h=0;h<d;h++)jn(e,e.createPositionAt(i.getChild(c),"end"));t=!0}}}return t}function VM(i){const e=parseInt(i.getAttribute("headingRows")||"0"),t=Array.from(i.getChildren()).reduce((s,o)=>o.is("element","tableRow")?s+1:s,0),n=[];for(const{row:s,cell:o,cellHeight:r}of new X(i)){if(r<2)continue;const l=s<e?e:t;if(s+r>l){const c=l-s;n.push({cell:o,rowspan:c})}}return n}function DM(i){const e=new Array(i.childCount).fill(0);for(const{rowIndex:t}of new X(i,{includeAllSlots:!0}))e[t]++;return e}function NM(i){if(i.type!=="attribute")return!1;const e=i.attributeKey;return e==="headingRows"||e==="colspan"||e==="rowspan"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function FM(i){i.document.registerPostFixer(e=>$M(e,i))}function $M(i,e){const t=e.document.differ.getChanges();let n=!1;for(const s of t)s.type=="insert"&&s.name=="table"&&(n=UM(s.position.nodeAfter,i)||n),s.type=="insert"&&s.name=="tableRow"&&(n=G1(s.position.nodeAfter,i)||n),s.type=="insert"&&s.name=="tableCell"&&(n=Oc(s.position.nodeAfter,i)||n),(s.type=="remove"||s.type=="insert")&&zM(s)&&(n=Oc(s.position.parent,i)||n);return n}function UM(i,e){let t=!1;for(const n of i.getChildren())n.is("element","tableRow")&&(t=G1(n,e)||t);return t}function G1(i,e){let t=!1;for(const n of i.getChildren())t=Oc(n,e)||t;return t}function Oc(i,e){if(i.childCount==0)return e.insertElement("paragraph",i),!0;const t=Array.from(i.getChildren()).filter(n=>n.is("$text"));for(const n of t)e.wrap(e.createRangeOn(n),"paragraph");return!!t.length}function zM(i){return i.position.parent.is("element","tableCell")?i.type=="insert"&&i.name=="$text"||i.type=="remove":!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function HM(i,e){const t=i.document.differ;for(const n of t.getChanges()){let s,o=!1;if(n.type=="attribute"){const c=n.range.start.nodeAfter;if(!c||!c.is("element","table")||n.attributeKey!="headingRows"&&n.attributeKey!="headingColumns")continue;s=c,o=n.attributeKey=="headingRows"}else(n.name=="tableRow"||n.name=="tableCell")&&(s=n.position.findAncestor("table"),o=n.name=="tableRow");if(!s)continue;const r=s.getAttribute("headingRows")||0,a=s.getAttribute("headingColumns")||0,l=new X(s);for(const c of l){const d=c.row<r||c.column<a?"th":"td",h=e.mapper.toViewElement(c.cell);h&&h.is("element")&&h.name!=d&&e.reconvertItem(o?c.cell.parent:c.cell)}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function WM(i,e){const t=i.document.differ,n=new Set;for(const s of t.getChanges()){const o=s.type=="attribute"?s.range.start.parent:s.position.parent;o.is("element","tableCell")&&n.add(o)}for(const s of n.values()){const o=Array.from(s.getChildren()).filter(r=>jM(r,e.mapper));for(const r of o)e.reconvertItem(r)}}function jM(i,e){if(!i.is("element","paragraph"))return!1;const t=e.toViewElement(i);return t?S1(i)!==t.is("element","span"):!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class io extends y{static get pluginName(){return"TableEditing"}static get requires(){return[Ce]}constructor(e){super(e),this._additionalSlots=[]}init(){const e=this.editor,t=e.model,n=t.schema,s=e.conversion,o=e.plugins.get(Ce);n.register("table",{inheritAllFrom:"$blockObject",allowAttributes:["headingRows","headingColumns"]}),n.register("tableRow",{allowIn:"table",isLimit:!0}),n.register("tableCell",{allowContentOf:"$container",allowIn:"tableRow",allowAttributes:["colspan","rowspan"],isLimit:!0,isSelectable:!0}),s.for("upcast").add(UR()),s.for("upcast").add(zR()),s.for("editingDowncast").elementToStructure({model:{name:"table",attributes:["headingRows"]},view:E1(o,{asWidget:!0,additionalSlots:this._additionalSlots})}),s.for("dataDowncast").elementToStructure({model:{name:"table",attributes:["headingRows"]},view:E1(o,{additionalSlots:this._additionalSlots})}),s.for("upcast").elementToElement({model:"tableRow",view:"tr"}),s.for("upcast").add(HR()),s.for("downcast").elementToElement({model:"tableRow",view:KR()}),s.for("upcast").elementToElement({model:"tableCell",view:"td"}),s.for("upcast").elementToElement({model:"tableCell",view:"th"}),s.for("upcast").add(T1("td")),s.for("upcast").add(T1("th")),s.for("editingDowncast").elementToElement({model:"tableCell",view:A1({asWidget:!0})}),s.for("dataDowncast").elementToElement({model:"tableCell",view:A1()}),s.for("editingDowncast").elementToElement({model:"paragraph",view:x1({asWidget:!0}),converterPriority:"high"}),s.for("dataDowncast").elementToElement({model:"paragraph",view:x1(),converterPriority:"high"}),s.for("downcast").attributeToAttribute({model:"colspan",view:"colspan"}),s.for("upcast").attributeToAttribute({model:{key:"colspan",value:K1("colspan")},view:"colspan"}),s.for("downcast").attributeToAttribute({model:"rowspan",view:"rowspan"}),s.for("upcast").attributeToAttribute({model:{key:"rowspan",value:K1("rowspan")},view:"rowspan"}),e.config.define("table.defaultHeadings.rows",0),e.config.define("table.defaultHeadings.columns",0),e.commands.add("insertTable",new YR(e)),e.commands.add("insertTableRowAbove",new I1(e,{order:"above"})),e.commands.add("insertTableRowBelow",new I1(e,{order:"below"})),e.commands.add("insertTableColumnLeft",new P1(e,{order:"left"})),e.commands.add("insertTableColumnRight",new P1(e,{order:"right"})),e.commands.add("removeTableRow",new iM(e)),e.commands.add("removeTableColumn",new oM(e)),e.commands.add("splitTableCellVertically",new R1(e,{direction:"vertically"})),e.commands.add("splitTableCellHorizontally",new R1(e,{direction:"horizontally"})),e.commands.add("mergeTableCells",new xM(e)),e.commands.add("mergeTableCellRight",new Wr(e,{direction:"right"})),e.commands.add("mergeTableCellLeft",new Wr(e,{direction:"left"})),e.commands.add("mergeTableCellDown",new Wr(e,{direction:"down"})),e.commands.add("mergeTableCellUp",new Wr(e,{direction:"up"})),e.commands.add("setTableColumnHeader",new cM(e)),e.commands.add("setTableRowHeader",new lM(e)),e.commands.add("selectTableRow",new PM(e)),e.commands.add("selectTableColumn",new RM(e)),MM(t),FM(t),this.listenTo(t.document,"change:data",()=>{HM(t,e.editing),WM(t,e.editing)})}registerAdditionalSlot(e){this._additionalSlots.push(e)}}function K1(i){return e=>{const t=parseInt(e.getAttribute(i));return Number.isNaN(t)||t<=0?null:t}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Z1 extends R{constructor(e){super(e);const t=this.bindTemplate;this.items=this._createGridCollection(),this.keystrokes=new Te,this.focusTracker=new be,this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",(n,s)=>`${s} × ${n}`),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},on:{"mouseover@.ck-insert-table-dropdown-grid-box":t.to("boxover")},children:this.items},{tag:"div",attributes:{class:["ck","ck-insert-table-dropdown__label"],"aria-hidden":!0},children:[{text:t.to("label")}]}],on:{mousedown:t.to(n=>{n.preventDefault()}),click:t.to(()=>{this.fire("execute")})}}),this.on("boxover",(n,s)=>{const{row:o,column:r}=s.target.dataset;this.items.get((parseInt(o,10)-1)*10+(parseInt(r,10)-1)).focus()}),this.focusTracker.on("change:focusedElement",(n,s,o)=>{if(!o)return;const{row:r,column:a}=o.dataset;this.set({rows:parseInt(r),columns:parseInt(a)})}),this.on("change:columns",()=>this._highlightGridBoxes()),this.on("change:rows",()=>this._highlightGridBoxes())}render(){super.render(),Mm({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:10,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection});for(const e of this.items)this.focusTracker.add(e.element);this.keystrokes.listenTo(this.element)}reset(){this.set({rows:1,columns:1})}focus(){this.items.get(0).focus()}focusLast(){this.items.get(0).focus()}_highlightGridBoxes(){const e=this.rows,t=this.columns;this.items.map((n,s)=>{const o=Math.floor(s/10),r=s%10,a=o<e&&r<t;n.set("isOn",a)})}_createGridButton(e,t,n,s){const o=new N(e);return o.set({label:s,class:"ck-insert-table-dropdown-grid-box"}),o.extendTemplate({attributes:{"data-row":t,"data-column":n}}),o}_createGridCollection(){const e=[];for(let t=0;t<100;t++){const n=Math.floor(t/10),s=t%10,o=`${n+1} × ${s+1}`;e.push(this._createGridButton(this.locale,n+1,s+1,o))}return this.createCollection(e)}}const qM='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>',GM='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>',KM='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ZM extends y{static get pluginName(){return"TableUI"}init(){const e=this.editor,t=this.editor.t,s=e.locale.contentLanguageDirection==="ltr";e.ui.componentFactory.add("insertTable",o=>{const r=e.commands.get("insertTable"),a=tt(o);a.bind("isEnabled").to(r),a.buttonView.set({icon:P.table,label:t("Insert table"),tooltip:!0});let l;return a.on("change:isOpen",()=>{l||(l=new Z1(o),a.panelView.children.add(l),l.delegate("execute").to(a),a.on("execute",()=>{e.execute("insertTable",{rows:l.rows,columns:l.columns}),e.editing.view.focus()}))}),a}),e.ui.componentFactory.add("menuBar:insertTable",o=>{const r=e.commands.get("insertTable"),a=new Lt(o),l=new Z1(o);return l.delegate("execute").to(a),a.on("change:isOpen",(c,u,d)=>{d||l.reset()}),l.on("execute",()=>{e.execute("insertTable",{rows:l.rows,columns:l.columns}),e.editing.view.focus()}),a.buttonView.set({label:t("Table"),icon:P.table}),a.panelView.children.add(l),a.bind("isEnabled").to(r),a}),e.ui.componentFactory.add("tableColumn",o=>{const r=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:t("Header column"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:s?"insertTableColumnLeft":"insertTableColumnRight",label:t("Insert column left")}},{type:"button",model:{commandName:s?"insertTableColumnRight":"insertTableColumnLeft",label:t("Insert column right")}},{type:"button",model:{commandName:"removeTableColumn",label:t("Delete column")}},{type:"button",model:{commandName:"selectTableColumn",label:t("Select column")}}];return this._prepareDropdown(t("Column"),qM,r,o)}),e.ui.componentFactory.add("tableRow",o=>{const r=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:t("Header row"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowAbove",label:t("Insert row above")}},{type:"button",model:{commandName:"insertTableRowBelow",label:t("Insert row below")}},{type:"button",model:{commandName:"removeTableRow",label:t("Delete row")}},{type:"button",model:{commandName:"selectTableRow",label:t("Select row")}}];return this._prepareDropdown(t("Row"),GM,r,o)}),e.ui.componentFactory.add("mergeTableCells",o=>{const r=[{type:"button",model:{commandName:"mergeTableCellUp",label:t("Merge cell up")}},{type:"button",model:{commandName:s?"mergeTableCellRight":"mergeTableCellLeft",label:t("Merge cell right")}},{type:"button",model:{commandName:"mergeTableCellDown",label:t("Merge cell down")}},{type:"button",model:{commandName:s?"mergeTableCellLeft":"mergeTableCellRight",label:t("Merge cell left")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:t("Split cell vertically")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:t("Split cell horizontally")}}];return this._prepareMergeSplitButtonDropdown(t("Merge cells"),KM,r,o)})}_prepareDropdown(e,t,n,s){const o=this.editor,r=tt(s),a=this._fillDropdownWithListOptions(r,n);return r.buttonView.set({label:e,icon:t,tooltip:!0}),r.bind("isEnabled").toMany(a,"isEnabled",(...l)=>l.some(c=>c)),this.listenTo(r,"execute",l=>{o.execute(l.source.commandName),l.source instanceof tr||o.editing.view.focus()}),r}_prepareMergeSplitButtonDropdown(e,t,n,s){const o=this.editor,r=tt(s,Bs),a="mergeTableCells",l=o.commands.get(a),c=this._fillDropdownWithListOptions(r,n);return r.buttonView.set({label:e,icon:t,tooltip:!0,isEnabled:!0}),r.bind("isEnabled").toMany([l,...c],"isEnabled",(...u)=>u.some(d=>d)),this.listenTo(r.buttonView,"execute",()=>{o.execute(a),o.editing.view.focus()}),this.listenTo(r,"execute",u=>{o.execute(u.source.commandName),o.editing.view.focus()}),r}_fillDropdownWithListOptions(e,t){const n=this.editor,s=[],o=new Oe;for(const r of t)JM(r,n,s,o);return Si(e,o),s}}function JM(i,e,t,n){if(i.type==="button"||i.type==="switchbutton"){const s=i.model=new Ri(i.model),{commandName:o,bindIsOn:r}=i.model,a=e.commands.get(o);t.push(a),s.set({commandName:o}),s.bind("isEnabled").to(a),r&&s.bind("isOn").to(a,"value"),s.set({withText:!0})}n.add(i)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Gn extends y{static get pluginName(){return"TableSelection"}static get requires(){return[Ce,Ce]}init(){const e=this.editor,t=e.model,n=e.editing.view;this.listenTo(t,"deleteContent",(s,o)=>this._handleDeleteContent(s,o),{priority:"high"}),this.listenTo(n.document,"insertText",(s,o)=>this._handleInsertTextEvent(s,o),{priority:"high"}),this._defineSelectionConverter(),this._enablePluginDisabling()}getSelectedTableCells(){const e=this.editor.plugins.get(Ce),t=this.editor.model.document.selection,n=e.getSelectedTableCells(t);return n.length==0?null:n}getSelectionAsFragment(){const e=this.editor.plugins.get(Ce),t=this.getSelectedTableCells();return t?this.editor.model.change(n=>{const s=n.createDocumentFragment(),{first:o,last:r}=e.getColumnIndexes(t),{first:a,last:l}=e.getRowIndexes(t),c=t[0].findAncestor("table");let u=l,d=r;if(e.isSelectionRectangular(t)){const m={firstColumn:o,lastColumn:r,firstRow:a,lastRow:l};u=N1(c,m),d=F1(c,m)}const f=M1(c,{startRow:a,startColumn:o,endRow:u,endColumn:d},n);return n.insert(f,s,0),s}):null}setCellSelection(e,t){const n=this._getCellsToSelect(e,t);this.editor.model.change(s=>{s.setSelection(n.cells.map(o=>s.createRangeOn(o)),{backward:n.backward})})}getFocusCell(){const n=[...this.editor.model.document.selection.getRanges()].pop().getContainedElement();return n&&n.is("element","tableCell")?n:null}getAnchorCell(){const e=this.editor.model.document.selection,n=ce(e.getRanges()).getContainedElement();return n&&n.is("element","tableCell")?n:null}_defineSelectionConverter(){const e=this.editor,t=new Set;e.conversion.for("editingDowncast").add(s=>s.on("selection",(o,r,a)=>{const l=a.writer;n(l);const c=this.getSelectedTableCells();if(!c)return;for(const d of c){const h=a.mapper.toViewElement(d);l.addClass("ck-editor__editable_selected",h),t.add(h)}const u=a.mapper.toViewElement(c[c.length-1]);l.setSelection(u,0)},{priority:"lowest"}));function n(s){for(const o of t)s.removeClass("ck-editor__editable_selected",o);t.clear()}}_enablePluginDisabling(){const e=this.editor;this.on("change:isEnabled",()=>{if(!this.isEnabled){const t=this.getSelectedTableCells();if(!t)return;e.model.change(n=>{const s=n.createPositionAt(t[0],0),o=e.model.schema.getNearestSelectionRange(s);n.setSelection(o)})}})}_handleDeleteContent(e,t){const n=this.editor.plugins.get(Ce),s=t[0],o=t[1],r=this.editor.model,a=!o||o.direction=="backward",l=n.getSelectedTableCells(s);l.length&&(e.stop(),r.change(c=>{const u=l[a?l.length-1:0];r.change(h=>{for(const f of l)r.deleteContent(h.createSelection(f,"in"))});const d=r.schema.getNearestSelectionRange(c.createPositionAt(u,0));s.is("documentSelection")?c.setSelection(d):s.setTo(d)}))}_handleInsertTextEvent(e,t){const n=this.editor,s=this.getSelectedTableCells();if(!s)return;const o=n.editing.view,r=n.editing.mapper,a=s.map(l=>o.createRangeOn(r.toViewElement(l)));t.selection=o.createSelection(a)}_getCellsToSelect(e,t){const n=this.editor.plugins.get("TableUtils"),s=n.getCellLocation(e),o=n.getCellLocation(t),r=Math.min(s.row,o.row),a=Math.max(s.row,o.row),l=Math.min(s.column,o.column),c=Math.max(s.column,o.column),u=new Array(a-r+1).fill(null).map(()=>[]),d={startRow:r,endRow:a,startColumn:l,endColumn:c};for(const{row:m,cell:g}of new X(e.findAncestor("table"),d))u[m-r].push(g);const h=o.row<s.row,f=o.column<s.column;return h&&u.reverse(),f&&u.forEach(m=>m.reverse()),{cells:u.flat(),backward:h||f}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class YM extends y{static get pluginName(){return"TableClipboard"}static get requires(){return[Hs,Vt,Gn,Ce]}init(){const e=this.editor,t=e.editing.view.document;this.listenTo(t,"copy",(n,s)=>this._onCopyCut(n,s)),this.listenTo(t,"cut",(n,s)=>this._onCopyCut(n,s)),this.listenTo(e.model,"insertContent",(n,[s,o])=>this._onInsertContent(n,s,o),{priority:"high"}),this.decorate("_replaceTableSlotCell")}_onCopyCut(e,t){const n=this.editor.editing.view,s=this.editor.plugins.get(Gn),o=this.editor.plugins.get(Hs);s.getSelectedTableCells()&&(e.name=="cut"&&!this.editor.model.canEditAt(this.editor.model.document.selection)||(t.preventDefault(),e.stop(),this.editor.model.enqueueChange({isUndoable:e.name==="cut"},()=>{const r=o._copySelectedFragmentWithMarkers(e.name,this.editor.model.document.selection,()=>s.getSelectionAsFragment());n.document.fire("clipboardOutput",{dataTransfer:t.dataTransfer,content:this.editor.data.toView(r),method:e.name})})))}_onInsertContent(e,t,n){if(n&&!n.is("documentSelection"))return;const s=this.editor.model,o=this.editor.plugins.get(Ce),r=this.editor.plugins.get(Hs),a=this.getTableIfOnlyTableInContent(t,s);if(!a)return;const l=o.getSelectionAffectedTableCells(s.document.selection);if(!l.length){Ic(a,o);return}e.stop(),t.is("documentFragment")?r._pasteMarkersIntoTransformedElement(t.markers,c=>this._replaceSelectedCells(a,l,c)):this.editor.model.change(c=>{this._replaceSelectedCells(a,l,c)})}_replaceSelectedCells(e,t,n){const s=this.editor.plugins.get(Ce),o={width:s.getColumns(e),height:s.getRows(e)},r=XM(t,o,n,s),a=r.lastRow-r.firstRow+1,l=r.lastColumn-r.firstColumn+1,c={startRow:0,startColumn:0,endRow:Math.min(a,o.height)-1,endColumn:Math.min(l,o.width)-1};e=M1(e,c,n);const u=t[0].findAncestor("table"),d=this._replaceSelectedCellsWithPasted(e,o,u,r,n);if(this.editor.plugins.get("TableSelection").isEnabled){const h=s.sortRanges(d.map(f=>n.createRangeOn(f)));n.setSelection(h)}else n.setSelection(d[0],0);return u}_replaceSelectedCellsWithPasted(e,t,n,s,o){const{width:r,height:a}=t,l=eB(e,r,a),c=[...new X(n,{startRow:s.firstRow,endRow:s.lastRow,startColumn:s.firstColumn,endColumn:s.lastColumn,includeAllSlots:!0})],u=[];let d;for(const b of c){const{row:_,column:T}=b;T===s.firstColumn&&(d=b.getPositionBefore());const O=_-s.firstRow,B=T-s.firstColumn,W=l[O%a][B%r],S=W?o.cloneElement(W):null,V=this._replaceTableSlotCell(b,S,d,o);V&&(D1(V,_,T,s.lastRow,s.lastColumn,o),u.push(V),d=o.createPositionAfter(V))}const h=parseInt(n.getAttribute("headingRows")||"0"),f=parseInt(n.getAttribute("headingColumns")||"0"),m=s.firstRow<h&&h<=s.lastRow,g=s.firstColumn<f&&f<=s.lastColumn;if(m){const b={first:s.firstColumn,last:s.lastColumn},_=Lc(n,h,b,o,s.firstRow);u.push(..._)}if(g){const b={first:s.firstRow,last:s.lastRow},_=Vc(n,f,b,o);u.push(..._)}return u}_replaceTableSlotCell(e,t,n,s){const{cell:o,isAnchor:r}=e;return r&&s.remove(o),t?(s.insert(t,n),t):null}getTableIfOnlyTableInContent(e,t){if(!e.is("documentFragment")&&!e.is("element"))return null;if(e.is("element","table"))return e;if(e.childCount==1&&e.getChild(0).is("element","table"))return e.getChild(0);const n=t.createRangeIn(e);for(const s of n.getItems())if(s.is("element","table")){const o=t.createRange(n.start,t.createPositionBefore(s));if(t.hasContent(o,{ignoreWhitespaces:!0}))return null;const r=t.createRange(t.createPositionAfter(s),n.end);return t.hasContent(r,{ignoreWhitespaces:!0})?null:s}return null}}function XM(i,e,t,n){const s=i[0].findAncestor("table"),o=n.getColumnIndexes(i),r=n.getRowIndexes(i),a={firstColumn:o.first,lastColumn:o.last,firstRow:r.first,lastRow:r.last},l=i.length===1;return l&&(a.lastRow+=e.height-1,a.lastColumn+=e.width-1,QM(s,a.lastRow+1,a.lastColumn+1,n)),l||!n.isSelectionRectangular(i)?tB(s,a,t):(a.lastRow=N1(s,a),a.lastColumn=F1(s,a)),a}function QM(i,e,t,n){const s=n.getColumns(i),o=n.getRows(i);t>s&&n.insertColumns(i,{at:s,columns:t-s}),e>o&&n.insertRows(i,{at:o,rows:e-o})}function eB(i,e,t){const n=new Array(t).fill(null).map(()=>new Array(e).fill(null));for(const{column:s,row:o,cell:r}of new X(i))n[o][s]=r;return n}function tB(i,e,t){const{firstRow:n,lastRow:s,firstColumn:o,lastColumn:r}=e,a={first:n,last:s},l={first:o,last:r};Vc(i,o,a,t),Vc(i,r+1,a,t),Lc(i,n,l,t),Lc(i,s+1,l,t,n)}function Lc(i,e,t,n,s=0){return e<1?void 0:B1(i,e,s).filter(({column:a,cellWidth:l})=>J1(a,l,t)).map(({cell:a})=>O1(a,e,n))}function Vc(i,e,t,n){return e<1?void 0:L1(i,e).filter(({row:r,cellHeight:a})=>J1(r,a,t)).map(({cell:r,column:a})=>V1(r,a,e,n))}function J1(i,e,t){const n=i+e-1,{first:s,last:o}=t,r=i>=s&&i<=o,a=i<s&&n>=s;return r||a}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nB extends y{static get pluginName(){return"TableKeyboard"}static get requires(){return[Gn,Ce]}init(){const e=this.editor,n=e.editing.view.document,s=e.t;this.listenTo(n,"arrowKey",(...o)=>this._onArrowKey(...o),{context:"table"}),this.listenTo(n,"tab",(...o)=>this._handleTabOnSelectedTable(...o),{context:"figure"}),this.listenTo(n,"tab",(...o)=>this._handleTab(...o),{context:["th","td"]}),e.accessibility.addKeystrokeInfoGroup({id:"table",label:s("Keystrokes that can be used in a table cell"),keystrokes:[{label:s("Move the selection to the next cell"),keystroke:"Tab"},{label:s("Move the selection to the previous cell"),keystroke:"Shift+Tab"},{label:s("Insert a new table row (when in the last cell of a table)"),keystroke:"Tab"},{label:s("Navigate through the table"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]}]})}_handleTabOnSelectedTable(e,t){const n=this.editor,o=n.model.document.selection.getSelectedElement();!o||!o.is("element","table")||(t.preventDefault(),t.stopPropagation(),e.stop(),n.model.change(r=>{r.setSelection(r.createRangeIn(o.getChild(0).getChild(0)))}))}_handleTab(e,t){const n=this.editor,s=this.editor.plugins.get(Ce),o=this.editor.plugins.get("TableSelection"),r=n.model.document.selection,a=!t.shiftKey;let l=s.getTableCellsContainingSelection(r)[0];if(l||(l=o.getFocusCell()),!l)return;t.preventDefault(),t.stopPropagation(),e.stop();const c=l.parent,u=c.parent,d=u.getChildIndex(c),h=c.getChildIndex(l),f=h===0;if(!a&&f&&d===0){n.model.change(_=>{_.setSelection(_.createRangeOn(u))});return}const m=h===c.childCount-1,g=d===s.getRows(u)-1;if(a&&g&&m&&(n.execute("insertTableRowBelow"),d===s.getRows(u)-1)){n.model.change(_=>{_.setSelection(_.createRangeOn(u))});return}let b;if(a&&m)b=u.getChild(d+1).getChild(0);else if(!a&&f){const _=u.getChild(d-1);b=_.getChild(_.childCount-1)}else b=c.getChild(h+(a?1:-1));n.model.change(_=>{_.setSelection(_.createRangeIn(b))})}_onArrowKey(e,t){const n=this.editor,s=t.keyCode,o=Qa(s,n.locale.contentLanguageDirection);this._handleArrowKeys(o,t.shiftKey)&&(t.preventDefault(),t.stopPropagation(),e.stop())}_handleArrowKeys(e,t){const n=this.editor.plugins.get(Ce),s=this.editor.plugins.get("TableSelection"),o=this.editor.model,r=o.document.selection,a=["right","down"].includes(e),l=n.getSelectedTableCells(r);if(l.length){let u;return t?u=s.getFocusCell():u=a?l[l.length-1]:l[0],this._navigateFromCellInDirection(u,e,t),!0}const c=r.focus.findAncestor("tableCell");/* istanbul ignore if: paranoid check -- @preserve */if(!c)return!1;if(!r.isCollapsed)if(t){if(r.isBackward==a&&!r.containsEntireContent(c))return!1}else{const u=r.getSelectedElement();if(!u||!o.schema.isObject(u))return!1}return this._isSelectionAtCellEdge(r,c,a)?(this._navigateFromCellInDirection(c,e,t),!0):!1}_isSelectionAtCellEdge(e,t,n){const s=this.editor.model,o=this.editor.model.schema,r=n?e.getLastPosition():e.getFirstPosition();if(!o.getLimitElement(r).is("element","tableCell"))return s.createPositionAt(t,n?"end":0).isTouching(r);const a=s.createSelection(r);return s.modifySelection(a,{direction:n?"forward":"backward"}),r.isEqual(a.focus)}_navigateFromCellInDirection(e,t,n=!1){const s=this.editor.model,o=e.findAncestor("table"),r=[...new X(o,{includeAllSlots:!0})],{row:a,column:l}=r[r.length-1],c=r.find(({cell:T})=>T==e);let{row:u,column:d}=c;switch(t){case"left":d--;break;case"up":u--;break;case"right":d+=c.cellWidth;break;case"down":u+=c.cellHeight;break}const h=u<0||u>a,f=d<0&&u<=0,m=d>l&&u>=a;if(h||f||m){s.change(T=>{T.setSelection(T.createRangeOn(o))});return}d<0?(d=n?0:l,u--):d>l&&(d=n?l:0,u++);const g=r.find(T=>T.row==u&&T.column==d).cell,b=["right","down"].includes(t),_=this.editor.plugins.get("TableSelection");if(n&&_.isEnabled){const T=_.getAnchorCell()||e;_.setCellSelection(T,g)}else{const T=s.createPositionAt(g,b?0:"end");s.change(O=>{O.setSelection(T)})}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Y1 extends cn{constructor(){super(...arguments),this.domEventType=["mousemove","mouseleave"]}onDomEvent(e){this.fire(e.type,e)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class iB extends y{static get pluginName(){return"TableMouse"}static get requires(){return[Gn,Ce]}init(){this.editor.editing.view.addObserver(Y1),this._enableShiftClickSelection(),this._enableMouseDragSelection()}_enableShiftClickSelection(){const e=this.editor,t=e.plugins.get(Ce);let n=!1;const s=e.plugins.get(Gn);this.listenTo(e.editing.view.document,"mousedown",(o,r)=>{const a=e.model.document.selection;if(!this.isEnabled||!s.isEnabled||!r.domEvent.shiftKey)return;const l=s.getAnchorCell()||t.getTableCellsContainingSelection(a)[0];if(!l)return;const c=this._getModelTableCellFromDomEvent(r);c&&X1(l,c)&&(n=!0,s.setCellSelection(l,c),r.preventDefault())}),this.listenTo(e.editing.view.document,"mouseup",()=>{n=!1}),this.listenTo(e.editing.view.document,"selectionChange",o=>{n&&o.stop()},{priority:"highest"})}_enableMouseDragSelection(){const e=this.editor;let t,n,s=!1,o=!1;const r=e.plugins.get(Gn);this.listenTo(e.editing.view.document,"mousedown",(a,l)=>{!this.isEnabled||!r.isEnabled||l.domEvent.shiftKey||l.domEvent.ctrlKey||l.domEvent.altKey||(t=this._getModelTableCellFromDomEvent(l))}),this.listenTo(e.editing.view.document,"mousemove",(a,l)=>{if(!l.domEvent.buttons||!t)return;const c=this._getModelTableCellFromDomEvent(l);c&&X1(t,c)&&(n=c,!s&&n!=t&&(s=!0)),s&&(o=!0,r.setCellSelection(t,n),l.preventDefault())}),this.listenTo(e.editing.view.document,"mouseup",()=>{s=!1,o=!1,t=null,n=null}),this.listenTo(e.editing.view.document,"selectionChange",a=>{o&&a.stop()},{priority:"highest"})}_getModelTableCellFromDomEvent(e){const t=e.target,n=this.editor.editing.view.createPositionAt(t,0);return this.editor.editing.mapper.toModelPosition(n).parent.findAncestor("tableCell",{includeSelf:!0})}}function X1(i,e){return i.parent.parent==e.parent.parent}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class sB extends y{static get requires(){return[io,ZM,Gn,iB,nB,YM,oc]}static get pluginName(){return"Table"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Q1(i){const e=eb(i);return e||jr(i)}function eb(i){const e=i.getSelectedElement();return e&&tb(e)?e:null}function jr(i){const e=i.getFirstPosition();if(!e)return null;let t=e.parent;for(;t;){if(t.is("element")&&tb(t))return t;t=t.parent}return null}function tb(i){return!!i.getCustomProperty("table")&&me(i)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oB extends y{static get requires(){return[Tr]}static get pluginName(){return"TableToolbar"}afterInit(){const e=this.editor,t=e.t,n=e.plugins.get(Tr),s=e.config.get("table.contentToolbar"),o=e.config.get("table.tableToolbar");s&&n.register("tableContent",{ariaLabel:t("Table toolbar"),items:s,getRelatedElement:jr}),o&&n.register("table",{ariaLabel:t("Table toolbar"),items:o,getRelatedElement:eb})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class rB extends R{constructor(e,t){super(e),this.set("value",""),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isEmpty",!0),this.options=t,this.focusTracker=new be,this._focusables=new Xe,this.dropdownView=this._createDropdownView(),this.inputView=this._createInputTextView(),this.keystrokes=new Te,this._stillTyping=!1,this.focusCycler=new et({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-input-color"]},children:[this.dropdownView,this.inputView]}),this.on("change:value",(n,s,o)=>this._setInputValue(o))}render(){super.render(),[this.inputView,this.dropdownView.buttonView].forEach(e=>{this.focusTracker.add(e.element),this._focusables.add(e)}),this.keystrokes.listenTo(this.element)}focus(e){e===-1?this.focusCycler.focusLast():this.focusCycler.focusFirst()}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createDropdownView(){const e=this.locale,t=e.t,n=this.bindTemplate,s=this._createColorSelector(e),o=tt(e),r=new R;return r.setTemplate({tag:"span",attributes:{class:["ck","ck-input-color__button__preview"],style:{backgroundColor:n.to("value")}},children:[{tag:"span",attributes:{class:["ck","ck-input-color__button__preview__no-color-indicator",n.if("value","ck-hidden",a=>a!="")]}}]}),o.buttonView.extendTemplate({attributes:{class:"ck-input-color__button"}}),o.buttonView.children.add(r),o.buttonView.label=t("Color picker"),o.buttonView.tooltip=!0,o.panelPosition=e.uiLanguageDirection==="rtl"?"se":"sw",o.panelView.children.add(s),o.bind("isEnabled").to(this,"isReadOnly",a=>!a),o.on("change:isOpen",(a,l,c)=>{c&&(s.updateSelectedColors(),s.showColorGridsFragment())}),o}_createInputTextView(){const e=this.locale,t=new qm(e);return t.extendTemplate({on:{blur:t.bindTemplate.to("blur")}}),t.value=this.value,t.bind("isReadOnly","hasError").to(this),this.bind("isFocused","isEmpty").to(t),t.on("input",()=>{const n=t.element.value,s=this.options.colorDefinitions.find(o=>n===o.label);this._stillTyping=!0,this.value=s&&s.color||n}),t.on("blur",()=>{this._stillTyping=!1,this._setInputValue(t.element.value)}),t.delegate("input").to(this),t}_createColorSelector(e){const t=e.t,n=this.options.defaultColorValue||"",s=t(n?"Restore default":"Remove color"),o=new FS(e,{colors:this.options.colorDefinitions,columns:this.options.columns,removeButtonLabel:s,colorPickerLabel:t("Color picker"),colorPickerViewConfig:this.options.colorPickerConfig===!1?!1:{...this.options.colorPickerConfig,hideInput:!0}});o.appendUI(),o.on("execute",(a,l)=>{if(l.source==="colorPickerSaveButton"){this.dropdownView.isOpen=!1;return}this.value=l.value||n,this.fire("input"),l.source!=="colorPicker"&&(this.dropdownView.isOpen=!1)});let r=this.value;return o.on("colorPicker:cancel",()=>{this.value=r,this.fire("input"),this.dropdownView.isOpen=!1}),o.colorGridsFragmentView.colorPickerButtonView.on("execute",()=>{r=this.value}),o.bind("selectedColor").to(this,"value"),o}_setInputValue(e){if(!this._stillTyping){const t=nb(e),n=this.options.colorDefinitions.find(s=>t===nb(s.color));n?this.inputView.value=n.label:this.inputView.value=e||""}}}function nb(i){return i.replace(/([(,])\s+/g,"$1").replace(/^\s+|\s+(?=[),\s]|$)/g,"").replace(/,|\s/g," ")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Dc=i=>i==="";function Nc(i){return{none:i("None"),solid:i("Solid"),dotted:i("Dotted"),dashed:i("Dashed"),double:i("Double"),groove:i("Groove"),ridge:i("Ridge"),inset:i("Inset"),outset:i("Outset")}}function ib(i){return i('The color is invalid. Try "#FF0000" or "rgb(255,0,0)" or "red".')}function sb(i){return i('The value is invalid. Try "10px" or "2em" or simply "2".')}function qr(i){return i=i.trim().toLowerCase(),Dc(i)||nm(i)}function so(i){return i=i.trim(),Dc(i)||ab(i)||Sl(i)||vA(i)}function ob(i){return i=i.trim(),Dc(i)||ab(i)||Sl(i)}function rb(i,e){const t=new Oe,n=Nc(i.t);for(const s in n){const o={type:"button",model:new Ri({_borderStyleValue:s,label:n[s],role:"menuitemradio",withText:!0})};s==="none"?o.model.bind("isOn").to(i,"borderStyle",r=>e==="none"?!r:r===s):o.model.bind("isOn").to(i,"borderStyle",r=>r===s),t.add(o)}return t}function Fc(i){const{view:e,icons:t,toolbar:n,labels:s,propertyName:o,nameToValue:r,defaultValue:a}=i;for(const l in s){const c=new N(e.locale);c.set({label:s[l],icon:t[l],tooltip:s[l]});const u=r?r(l):l;c.bind("isOn").to(e,o,d=>{let h=d;return d===""&&a&&(h=a),u===h}),c.on("execute",()=>{e[o]=u}),n.items.add(c)}}const Gr=[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}];function Kr(i){return(e,t,n)=>{const s=new rB(e.locale,{colorDefinitions:aB(i.colorConfig),columns:i.columns,defaultColorValue:i.defaultColorValue,colorPickerConfig:i.colorPickerConfig});return s.inputView.set({id:t,ariaDescribedById:n}),s.bind("isReadOnly").to(e,"isEnabled",o=>!o),s.bind("hasError").to(e,"errorText",o=>!!o),s.on("input",()=>{e.errorText=null}),e.bind("isEmpty","isFocused").to(s),s}}function ab(i){const e=parseFloat(i);return!Number.isNaN(e)&&i===String(e)}function aB(i){return i.map(e=>({color:e.model,label:e.label,options:{hasBorder:e.hasBorder}}))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nt extends R{constructor(e,t={}){super(e);const n=this.bindTemplate;this.set("class",t.class||null),this.children=this.createCollection(),t.children&&t.children.forEach(s=>this.children.add(s)),this.set("_role",null),this.set("_ariaLabelledBy",null),t.labelView&&this.set({_role:"group",_ariaLabelledBy:t.labelView.id}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__row",n.to("class")],role:n.to("_role"),"aria-labelledby":n.to("_ariaLabelledBy")},children:this.children})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const lb={left:P.alignLeft,center:P.alignCenter,right:P.alignRight,justify:P.alignJustify,top:P.alignTop,middle:P.alignMiddle,bottom:P.alignBottom};class lB extends R{constructor(e,t){super(e),this.set({borderStyle:"",borderWidth:"",borderColor:"",padding:"",backgroundColor:"",width:"",height:"",horizontalAlignment:"",verticalAlignment:""}),this.options=t;const{borderStyleDropdown:n,borderWidthInput:s,borderColorInput:o,borderRowLabel:r}=this._createBorderFields(),{backgroundRowLabel:a,backgroundInput:l}=this._createBackgroundFields(),{widthInput:c,operatorLabel:u,heightInput:d,dimensionsLabel:h}=this._createDimensionFields(),{horizontalAlignmentToolbar:f,verticalAlignmentToolbar:m,alignmentLabel:g}=this._createAlignmentFields();this.focusTracker=new be,this.keystrokes=new Te,this.children=this.createCollection(),this.borderStyleDropdown=n,this.borderWidthInput=s,this.borderColorInput=o,this.backgroundInput=l,this.paddingInput=this._createPaddingField(),this.widthInput=c,this.heightInput=d,this.horizontalAlignmentToolbar=f,this.verticalAlignmentToolbar=m;const{saveButtonView:b,cancelButtonView:_}=this._createActionButtons();this.saveButtonView=b,this.cancelButtonView=_,this._focusables=new Xe,this._focusCycler=new et({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new Kl(e,{label:this.t("Cell properties")})),this.children.add(new nt(e,{labelView:r,children:[r,n,o,s],class:"ck-table-form__border-row"})),this.children.add(new nt(e,{labelView:a,children:[a,l],class:"ck-table-form__background-row"})),this.children.add(new nt(e,{children:[new nt(e,{labelView:h,children:[h,c,u,d],class:"ck-table-form__dimensions-row"}),new nt(e,{children:[this.paddingInput],class:"ck-table-cell-properties-form__padding-row"})]})),this.children.add(new nt(e,{labelView:g,children:[g,f,m],class:"ck-table-cell-properties-form__alignment-row"})),this.children.add(new nt(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-cell-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Ll({view:this}),[this.borderColorInput,this.backgroundInput].forEach(e=>{e.fieldView.focusCycler.on("forwardCycle",t=>{this._focusCycler.focusNext(),t.stop()}),e.fieldView.focusCycler.on("backwardCycle",t=>{this._focusCycler.focusPrevious(),t.stop()})}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.paddingInput,this.horizontalAlignmentToolbar,this.verticalAlignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableCellProperties,t={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},n=Kr({colorConfig:this.options.borderColors,columns:5,defaultColorValue:t.color,colorPickerConfig:this.options.colorPickerConfig}),s=this.locale,o=this.t,r=o("Style"),a=new Qe(s);a.text=o("Border");const l=Nc(o),c=new Ie(s,Qm);c.set({label:r,class:"ck-table-form__border-style"}),c.fieldView.buttonView.set({ariaLabel:r,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:r}),c.fieldView.buttonView.bind("label").to(this,"borderStyle",h=>l[h||"none"]),c.fieldView.on("execute",h=>{this.borderStyle=h.source._borderStyleValue}),c.bind("isEmpty").to(this,"borderStyle",h=>!h),Si(c.fieldView,rb(this,t.style),{role:"menu",ariaLabel:r});const u=new Ie(s,Bt);u.set({label:o("Width"),class:"ck-table-form__border-width"}),u.fieldView.bind("value").to(this,"borderWidth"),u.bind("isEnabled").to(this,"borderStyle",Zr),u.fieldView.on("input",()=>{this.borderWidth=u.fieldView.element.value});const d=new Ie(s,n);return d.set({label:o("Color"),class:"ck-table-form__border-color"}),d.fieldView.bind("value").to(this,"borderColor"),d.bind("isEnabled").to(this,"borderStyle",Zr),d.fieldView.on("input",()=>{this.borderColor=d.fieldView.value}),this.on("change:borderStyle",(h,f,m,g)=>{Zr(m)||(this.borderColor="",this.borderWidth=""),Zr(g)||(this.borderColor=t.color,this.borderWidth=t.width)}),{borderRowLabel:a,borderStyleDropdown:c,borderColorInput:d,borderWidthInput:u}}_createBackgroundFields(){const e=this.locale,t=this.t,n=new Qe(e);n.text=t("Background");const s=Kr({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableCellProperties.backgroundColor,colorPickerConfig:this.options.colorPickerConfig}),o=new Ie(e,s);return o.set({label:t("Color"),class:"ck-table-cell-properties-form__background"}),o.fieldView.bind("value").to(this,"backgroundColor"),o.fieldView.on("input",()=>{this.backgroundColor=o.fieldView.value}),{backgroundRowLabel:n,backgroundInput:o}}_createDimensionFields(){const e=this.locale,t=this.t,n=new Qe(e);n.text=t("Dimensions");const s=new Ie(e,Bt);s.set({label:t("Width"),class:"ck-table-form__dimensions-row__width"}),s.fieldView.bind("value").to(this,"width"),s.fieldView.on("input",()=>{this.width=s.fieldView.element.value});const o=new R(e);o.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:"×"}]});const r=new Ie(e,Bt);return r.set({label:t("Height"),class:"ck-table-form__dimensions-row__height"}),r.fieldView.bind("value").to(this,"height"),r.fieldView.on("input",()=>{this.height=r.fieldView.element.value}),{dimensionsLabel:n,widthInput:s,operatorLabel:o,heightInput:r}}_createPaddingField(){const e=this.locale,t=this.t,n=new Ie(e,Bt);return n.set({label:t("Padding"),class:"ck-table-cell-properties-form__padding"}),n.fieldView.bind("value").to(this,"padding"),n.fieldView.on("input",()=>{this.padding=n.fieldView.element.value}),n}_createAlignmentFields(){const e=this.locale,t=this.t,n=new Qe(e);n.text=t("Table cell text alignment");const s=new xi(e),o=e.contentLanguageDirection==="rtl";s.set({isCompact:!0,ariaLabel:t("Horizontal text alignment toolbar")}),Fc({view:this,icons:lb,toolbar:s,labels:this._horizontalAlignmentLabels,propertyName:"horizontalAlignment",nameToValue:a=>{if(o){if(a==="left")return"right";if(a==="right")return"left"}return a},defaultValue:this.options.defaultTableCellProperties.horizontalAlignment});const r=new xi(e);return r.set({isCompact:!0,ariaLabel:t("Vertical text alignment toolbar")}),Fc({view:this,icons:lb,toolbar:r,labels:this._verticalAlignmentLabels,propertyName:"verticalAlignment",defaultValue:this.options.defaultTableCellProperties.verticalAlignment}),{horizontalAlignmentToolbar:s,verticalAlignmentToolbar:r,alignmentLabel:n}}_createActionButtons(){const e=this.locale,t=this.t,n=new N(e),s=new N(e),o=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.paddingInput];return n.set({label:t("Save"),icon:P.check,class:"ck-button-save",type:"submit",withText:!0}),n.bind("isEnabled").toMany(o,"errorText",(...r)=>r.every(a=>!a)),s.set({label:t("Cancel"),icon:P.cancel,class:"ck-button-cancel",withText:!0}),s.delegate("execute").to(this,"cancel"),{saveButtonView:n,cancelButtonView:s}}get _horizontalAlignmentLabels(){const e=this.locale,t=this.t,n=t("Align cell text to the left"),s=t("Align cell text to the center"),o=t("Align cell text to the right"),r=t("Justify cell text");return e.uiLanguageDirection==="rtl"?{right:o,center:s,left:n,justify:r}:{left:n,center:s,right:o,justify:r}}get _verticalAlignmentLabels(){const e=this.t;return{top:e("Align cell text to the top"),middle:e("Align cell text to the middle"),bottom:e("Align cell text to the bottom")}}}function Zr(i){return i!=="none"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Kn=Pe.defaultPositions,$c=[Kn.northArrowSouth,Kn.northArrowSouthWest,Kn.northArrowSouthEast,Kn.southArrowNorth,Kn.southArrowNorthWest,Kn.southArrowNorthEast,Kn.viewportStickyNorth];function cb(i,e){const t=i.plugins.get("ContextualBalloon"),n=i.editing.view.document.selection;let s;e==="cell"?jr(n)&&(s=db(i)):Q1(n)&&(s=ub(i)),s&&t.updatePosition(s)}function ub(i){const e=i.model.document.selection,t=qn(e),n=i.editing.mapper.toViewElement(t);return{target:i.editing.view.domConverter.mapViewToDom(n),positions:$c}}function db(i){const e=i.editing.mapper,t=i.editing.view.domConverter,n=i.model.document.selection;if(n.rangeCount>1)return{target:()=>cB(n.getRanges(),i),positions:$c};const s=hb(n.getFirstPosition()),o=e.toViewElement(s);return{target:t.mapViewToDom(o),positions:$c}}function hb(i){return i.nodeAfter&&i.nodeAfter.is("element","tableCell")?i.nodeAfter:i.findAncestor("tableCell")}function cB(i,e){const t=e.editing.mapper,n=e.editing.view.domConverter,s=Array.from(i).map(o=>{const r=hb(o.start),a=t.toViewElement(r);return new z(n.mapViewToDom(a))});return z.getBoundingRect(s)}const uB='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.105 18-.17 1H2.5A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1h15A1.5 1.5 0 0 1 19 2.5v9.975l-.85-.124-.15-.302V8h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5h3.105zM2 12h5V8H2v4zm10-4H8v4h4V8zM2 2v5h5V2H2zm0 16h5v-5H2v5zM13 7h5V2h-5v5zM8 2v5h4V2H8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM13 6a1 1 0 0 1 1 1v3.172a2.047 2.047 0 0 0-.293.443l-.858 1.736-1.916.28-.151.027A1.976 1.976 0 0 0 9.315 14H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h6zm-1 2H8v4h4V8z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Zn(i){if(!i||!ie(i))return i;const{top:e,right:t,bottom:n,left:s}=i;if(e==t&&t==n&&n==s)return e}function Jn(i,e){const t=parseFloat(i);return Number.isNaN(t)||String(t)!==String(i)?i:`${t}${e}`}function oo(i,e={}){const t={borderStyle:"none",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",...i};return e.includeAlignmentProperty&&!t.alignment&&(t.alignment="center"),e.includePaddingProperty&&!t.padding&&(t.padding=""),e.includeVerticalAlignmentProperty&&!t.verticalAlignment&&(t.verticalAlignment="middle"),e.includeHorizontalAlignmentProperty&&!t.horizontalAlignment&&(t.horizontalAlignment=e.isRightToLeftContent?"right":"left"),t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const dB=500,fb={borderStyle:"tableCellBorderStyle",borderColor:"tableCellBorderColor",borderWidth:"tableCellBorderWidth",height:"tableCellHeight",width:"tableCellWidth",padding:"tableCellPadding",backgroundColor:"tableCellBackgroundColor",horizontalAlignment:"tableCellHorizontalAlignment",verticalAlignment:"tableCellVerticalAlignment"};class hB extends y{static get requires(){return[Ot]}static get pluginName(){return"TableCellPropertiesUI"}constructor(e){super(e),e.config.define("table.tableCellProperties",{borderColors:Gr,backgroundColors:Gr})}init(){const e=this.editor,t=e.t;this._defaultTableCellProperties=oo(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:e.locale.contentLanguageDirection==="rtl"}),this._balloon=e.plugins.get(Ot),this.view=null,this._isReady=!1,e.ui.componentFactory.add("tableCellProperties",n=>{const s=new N(n);s.set({label:t("Cell properties"),icon:uB,tooltip:!0}),this.listenTo(s,"execute",()=>this._showView());const o=Object.values(fb).map(r=>e.commands.get(r));return s.bind("isEnabled").toMany(o,"isEnabled",(...r)=>r.some(a=>a)),s})}destroy(){super.destroy(),this.view&&this.view.destroy()}_createPropertiesView(){const e=this.editor,t=e.config.get("table.tableCellProperties"),n=ir(t.borderColors),s=nr(e.locale,n),o=ir(t.backgroundColors),r=nr(e.locale,o),a=t.colorPicker!==!1,l=new lB(e.locale,{borderColors:s,backgroundColors:r,defaultTableCellProperties:this._defaultTableCellProperties,colorPickerConfig:a?t.colorPicker||{}:!1}),c=e.t;l.render(),this.listenTo(l,"submit",()=>{this._hideView()}),this.listenTo(l,"cancel",()=>{this._undoStepBatch.operations.length&&e.execute("undo",this._undoStepBatch),this._hideView()}),l.keystrokes.set("Esc",(h,f)=>{this._hideView(),f()}),Vn({emitter:l,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const u=ib(c),d=sb(c);return l.on("change:borderStyle",this._getPropertyChangeCallback("tableCellBorderStyle")),l.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:l.borderColorInput,commandName:"tableCellBorderColor",errorText:u,validator:qr})),l.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:l.borderWidthInput,commandName:"tableCellBorderWidth",errorText:d,validator:ob})),l.on("change:padding",this._getValidatedPropertyChangeCallback({viewField:l.paddingInput,commandName:"tableCellPadding",errorText:d,validator:so})),l.on("change:width",this._getValidatedPropertyChangeCallback({viewField:l.widthInput,commandName:"tableCellWidth",errorText:d,validator:so})),l.on("change:height",this._getValidatedPropertyChangeCallback({viewField:l.heightInput,commandName:"tableCellHeight",errorText:d,validator:so})),l.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:l.backgroundInput,commandName:"tableCellBackgroundColor",errorText:u,validator:qr})),l.on("change:horizontalAlignment",this._getPropertyChangeCallback("tableCellHorizontalAlignment")),l.on("change:verticalAlignment",this._getPropertyChangeCallback("tableCellVerticalAlignment")),l}_fillViewFormFromCommandValues(){const e=this.editor.commands,t=e.get("tableCellBorderStyle");Object.entries(fb).map(([n,s])=>{const o=this._defaultTableCellProperties[n]||"";return[n,e.get(s).value||o]}).forEach(([n,s])=>{(n==="borderColor"||n==="borderWidth")&&t.value==="none"||this.view.set(n,s)}),this._isReady=!0}_showView(){const e=this.editor;this.view||(this.view=this._createPropertiesView()),this.listenTo(e.ui,"update",()=>{this._updateView()}),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:db(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){const e=this.editor;this.stopListening(e.ui,"update"),this._isReady=!1,this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}_updateView(){const e=this.editor,t=e.editing.view.document;jr(t.selection)?this._isViewVisible&&cb(e,"cell"):this._hideView()}get _isViewVisible(){return!!this.view&&this._balloon.visibleView===this.view}get _isViewInBalloon(){return!!this.view&&this._balloon.hasView(this.view)}_getPropertyChangeCallback(e){return(t,n,s)=>{this._isReady&&this.editor.execute(e,{value:s,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:t,viewField:n,validator:s,errorText:o}=e,r=St(()=>{n.errorText=o},dB);return(a,l,c)=>{r.cancel(),this._isReady&&(s(c)?(this.editor.execute(t,{value:c,batch:this._undoStepBatch}),n.errorText=null):r())}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class en extends F{constructor(e,t,n){super(e),this.attributeName=t,this._defaultValue=n}refresh(){const e=this.editor,n=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e.model.document.selection);this.isEnabled=!!n.length,this.value=this._getSingleValue(n)}execute(e={}){const{value:t,batch:n}=e,s=this.editor.model,r=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(s.document.selection),a=this._getValueToSet(t);s.enqueueChange(n,l=>{a?r.forEach(c=>l.setAttribute(this.attributeName,a,c)):r.forEach(c=>l.removeAttribute(this.attributeName,c))})}_getAttribute(e){if(!e)return;const t=e.getAttribute(this.attributeName);if(t!==this._defaultValue)return t}_getValueToSet(e){if(e!==this._defaultValue)return e}_getSingleValue(e){const t=this._getAttribute(e[0]);return e.every(s=>this._getAttribute(s)===t)?t:void 0}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class fB extends en{constructor(e,t){super(e,"tableCellWidth",t)}_getValueToSet(e){if(e=Jn(e,"px"),e!==this._defaultValue)return e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class mb extends y{static get pluginName(){return"TableCellWidthEditing"}static get requires(){return[io]}init(){const e=this.editor,t=oo(e.config.get("table.tableCellProperties.defaultProperties"));Hr(e.model.schema,e.conversion,{modelAttribute:"tableCellWidth",styleName:"width",defaultValue:t.width}),e.commands.add("tableCellWidth",new fB(e,t.width))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class mB extends en{constructor(e,t){super(e,"tableCellPadding",t)}_getAttribute(e){if(!e)return;const t=Zn(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}_getValueToSet(e){const t=Jn(e,"px");if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class gB extends en{constructor(e,t){super(e,"tableCellHeight",t)}_getValueToSet(e){const t=Jn(e,"px");if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class pB extends en{constructor(e,t){super(e,"tableCellBackgroundColor",t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class bB extends en{constructor(e,t){super(e,"tableCellVerticalAlignment",t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class wB extends en{constructor(e,t){super(e,"tableCellHorizontalAlignment",t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class _B extends en{constructor(e,t){super(e,"tableCellBorderStyle",t)}_getAttribute(e){if(!e)return;const t=Zn(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class vB extends en{constructor(e,t){super(e,"tableCellBorderColor",t)}_getAttribute(e){if(!e)return;const t=Zn(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class yB extends en{constructor(e,t){super(e,"tableCellBorderWidth",t)}_getAttribute(e){if(!e)return;const t=Zn(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}_getValueToSet(e){const t=Jn(e,"px");if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const gb=/^(top|middle|bottom)$/,pb=/^(left|center|right|justify)$/;class CB extends y{static get pluginName(){return"TableCellPropertiesEditing"}static get requires(){return[io,mb]}init(){const e=this.editor,t=e.model.schema,n=e.conversion;e.config.define("table.tableCellProperties.defaultProperties",{});const s=oo(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:e.locale.contentLanguageDirection==="rtl"});e.data.addStyleProcessorRules(om),kB(t,n,{color:s.borderColor,style:s.borderStyle,width:s.borderWidth}),e.commands.add("tableCellBorderStyle",new _B(e,s.borderStyle)),e.commands.add("tableCellBorderColor",new vB(e,s.borderColor)),e.commands.add("tableCellBorderWidth",new yB(e,s.borderWidth)),Hr(t,n,{modelAttribute:"tableCellHeight",styleName:"height",defaultValue:s.height}),e.commands.add("tableCellHeight",new gB(e,s.height)),e.data.addStyleProcessorRules(DA),Hr(t,n,{modelAttribute:"tableCellPadding",styleName:"padding",reduceBoxSides:!0,defaultValue:s.padding}),e.commands.add("tableCellPadding",new mB(e,s.padding)),e.data.addStyleProcessorRules(sm),Hr(t,n,{modelAttribute:"tableCellBackgroundColor",styleName:"background-color",defaultValue:s.backgroundColor}),e.commands.add("tableCellBackgroundColor",new pB(e,s.backgroundColor)),TB(t,n,s.horizontalAlignment),e.commands.add("tableCellHorizontalAlignment",new wB(e,s.horizontalAlignment)),EB(t,n,s.verticalAlignment),e.commands.add("tableCellVerticalAlignment",new bB(e,s.verticalAlignment))}}function kB(i,e,t){const n={width:"tableCellBorderWidth",color:"tableCellBorderColor",style:"tableCellBorderStyle"};i.extend("tableCell",{allowAttributes:Object.values(n)}),Ec(e,"td",n,t),Ec(e,"th",n,t),Qs(e,{modelElement:"tableCell",modelAttribute:n.style,styleName:"border-style"}),Qs(e,{modelElement:"tableCell",modelAttribute:n.color,styleName:"border-color"}),Qs(e,{modelElement:"tableCell",modelAttribute:n.width,styleName:"border-width"})}function TB(i,e,t){i.extend("tableCell",{allowAttributes:["tableCellHorizontalAlignment"]}),e.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellHorizontalAlignment"},view:n=>({key:"style",value:{"text-align":n}})}),e.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"text-align":pb}},model:{key:"tableCellHorizontalAlignment",value:n=>{const s=n.getStyle("text-align");return s===t?null:s}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{align:pb}},model:{key:"tableCellHorizontalAlignment",value:n=>{const s=n.getAttribute("align");return s===t?null:s}}})}function EB(i,e,t){i.extend("tableCell",{allowAttributes:["tableCellVerticalAlignment"]}),e.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellVerticalAlignment"},view:n=>({key:"style",value:{"vertical-align":n}})}),e.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"vertical-align":gb}},model:{key:"tableCellVerticalAlignment",value:n=>{const s=n.getStyle("vertical-align");return s===t?null:s}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{valign:gb}},model:{key:"tableCellVerticalAlignment",value:n=>{const s=n.getAttribute("valign");return s===t?null:s}}})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class AB extends y{static get pluginName(){return"TableCellProperties"}static get requires(){return[CB,hB]}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Yn extends F{constructor(e,t,n){super(e),this.attributeName=t,this._defaultValue=n}refresh(){const t=this.editor.model.document.selection,n=qn(t);this.isEnabled=!!n,this.value=this._getValue(n)}execute(e={}){const t=this.editor.model,n=t.document.selection,{value:s,batch:o}=e,r=qn(n),a=this._getValueToSet(s);t.enqueueChange(o,l=>{a?l.setAttribute(this.attributeName,a,r):l.removeAttribute(this.attributeName,r)})}_getValue(e){if(!e)return;const t=e.getAttribute(this.attributeName);if(t!==this._defaultValue)return t}_getValueToSet(e){if(e!==this._defaultValue)return e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class xB extends Yn{constructor(e,t){super(e,"tableBackgroundColor",t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class SB extends Yn{constructor(e,t){super(e,"tableBorderColor",t)}_getValue(e){if(!e)return;const t=Zn(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class IB extends Yn{constructor(e,t){super(e,"tableBorderStyle",t)}_getValue(e){if(!e)return;const t=Zn(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class PB extends Yn{constructor(e,t){super(e,"tableBorderWidth",t)}_getValue(e){if(!e)return;const t=Zn(e.getAttribute(this.attributeName));if(t!==this._defaultValue)return t}_getValueToSet(e){const t=Jn(e,"px");if(t!==this._defaultValue)return t}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class RB extends Yn{constructor(e,t){super(e,"tableWidth",t)}_getValueToSet(e){if(e=Jn(e,"px"),e!==this._defaultValue)return e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class MB extends Yn{constructor(e,t){super(e,"tableHeight",t)}_getValueToSet(e){if(e=Jn(e,"px"),e!==this._defaultValue)return e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class BB extends Yn{constructor(e,t){super(e,"tableAlignment",t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const OB=/^(left|center|right)$/,LB=/^(left|none|right)$/;class VB extends y{static get pluginName(){return"TablePropertiesEditing"}static get requires(){return[io]}init(){const e=this.editor,t=e.model.schema,n=e.conversion;e.config.define("table.tableProperties.defaultProperties",{});const s=oo(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0});e.data.addStyleProcessorRules(om),DB(t,n,{color:s.borderColor,style:s.borderStyle,width:s.borderWidth}),e.commands.add("tableBorderColor",new SB(e,s.borderColor)),e.commands.add("tableBorderStyle",new IB(e,s.borderStyle)),e.commands.add("tableBorderWidth",new PB(e,s.borderWidth)),NB(t,n,s.alignment),e.commands.add("tableAlignment",new BB(e,s.alignment)),bb(t,n,{modelAttribute:"tableWidth",styleName:"width",defaultValue:s.width}),e.commands.add("tableWidth",new RB(e,s.width)),bb(t,n,{modelAttribute:"tableHeight",styleName:"height",defaultValue:s.height}),e.commands.add("tableHeight",new MB(e,s.height)),e.data.addStyleProcessorRules(sm),FB(t,n,{modelAttribute:"tableBackgroundColor",styleName:"background-color",defaultValue:s.backgroundColor}),e.commands.add("tableBackgroundColor",new xB(e,s.backgroundColor))}}function DB(i,e,t){const n={width:"tableBorderWidth",color:"tableBorderColor",style:"tableBorderStyle"};i.extend("table",{allowAttributes:Object.values(n)}),Ec(e,"table",n,t),Ur(e,{modelAttribute:n.color,styleName:"border-color"}),Ur(e,{modelAttribute:n.style,styleName:"border-style"}),Ur(e,{modelAttribute:n.width,styleName:"border-width"})}function NB(i,e,t){i.extend("table",{allowAttributes:["tableAlignment"]}),e.for("downcast").attributeToAttribute({model:{name:"table",key:"tableAlignment"},view:n=>({key:"style",value:{float:n==="center"?"none":n}}),converterPriority:"high"}),e.for("upcast").attributeToAttribute({view:{name:/^(table|figure)$/,styles:{float:LB}},model:{key:"tableAlignment",value:n=>{let s=n.getStyle("float");return s==="none"&&(s="center"),s===t?null:s}}}).attributeToAttribute({view:{attributes:{align:OB}},model:{name:"table",key:"tableAlignment",value:n=>{const s=n.getAttribute("align");return s===t?null:s}}})}function FB(i,e,t){const{modelAttribute:n}=t;i.extend("table",{allowAttributes:[n]}),Tc(e,{viewElement:"table",...t}),Ur(e,t)}function bb(i,e,t){const{modelAttribute:n}=t;i.extend("table",{allowAttributes:[n]}),Tc(e,{viewElement:/^(table|figure)$/,shouldUpcast:s=>!(s.name=="table"&&s.parent.name=="figure"),...t}),Qs(e,{modelElement:"table",...t})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const $B={left:P.objectLeft,center:P.objectCenter,right:P.objectRight};class UB extends R{constructor(e,t){super(e),this.set({borderStyle:"",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",alignment:""}),this.options=t;const{borderStyleDropdown:n,borderWidthInput:s,borderColorInput:o,borderRowLabel:r}=this._createBorderFields(),{backgroundRowLabel:a,backgroundInput:l}=this._createBackgroundFields(),{widthInput:c,operatorLabel:u,heightInput:d,dimensionsLabel:h}=this._createDimensionFields(),{alignmentToolbar:f,alignmentLabel:m}=this._createAlignmentFields();this.focusTracker=new be,this.keystrokes=new Te,this.children=this.createCollection(),this.borderStyleDropdown=n,this.borderWidthInput=s,this.borderColorInput=o,this.backgroundInput=l,this.widthInput=c,this.heightInput=d,this.alignmentToolbar=f;const{saveButtonView:g,cancelButtonView:b}=this._createActionButtons();this.saveButtonView=g,this.cancelButtonView=b,this._focusables=new Xe,this._focusCycler=new et({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new Kl(e,{label:this.t("Table properties")})),this.children.add(new nt(e,{labelView:r,children:[r,n,o,s],class:"ck-table-form__border-row"})),this.children.add(new nt(e,{labelView:a,children:[a,l],class:"ck-table-form__background-row"})),this.children.add(new nt(e,{children:[new nt(e,{labelView:h,children:[h,c,u,d],class:"ck-table-form__dimensions-row"}),new nt(e,{labelView:m,children:[m,f],class:"ck-table-properties-form__alignment-row"})]})),this.children.add(new nt(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Ll({view:this}),[this.borderColorInput,this.backgroundInput].forEach(e=>{e.fieldView.focusCycler.on("forwardCycle",t=>{this._focusCycler.focusNext(),t.stop()}),e.fieldView.focusCycler.on("backwardCycle",t=>{this._focusCycler.focusPrevious(),t.stop()})}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.alignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableProperties,t={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},n=Kr({colorConfig:this.options.borderColors,columns:5,defaultColorValue:t.color,colorPickerConfig:this.options.colorPickerConfig}),s=this.locale,o=this.t,r=o("Style"),a=new Qe(s);a.text=o("Border");const l=Nc(o),c=new Ie(s,Qm);c.set({label:r,class:"ck-table-form__border-style"}),c.fieldView.buttonView.set({ariaLabel:r,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:r}),c.fieldView.buttonView.bind("label").to(this,"borderStyle",h=>l[h||"none"]),c.fieldView.on("execute",h=>{this.borderStyle=h.source._borderStyleValue}),c.bind("isEmpty").to(this,"borderStyle",h=>!h),Si(c.fieldView,rb(this,t.style),{role:"menu",ariaLabel:r});const u=new Ie(s,Bt);u.set({label:o("Width"),class:"ck-table-form__border-width"}),u.fieldView.bind("value").to(this,"borderWidth"),u.bind("isEnabled").to(this,"borderStyle",Jr),u.fieldView.on("input",()=>{this.borderWidth=u.fieldView.element.value});const d=new Ie(s,n);return d.set({label:o("Color"),class:"ck-table-form__border-color"}),d.fieldView.bind("value").to(this,"borderColor"),d.bind("isEnabled").to(this,"borderStyle",Jr),d.fieldView.on("input",()=>{this.borderColor=d.fieldView.value}),this.on("change:borderStyle",(h,f,m,g)=>{Jr(m)||(this.borderColor="",this.borderWidth=""),Jr(g)||(this.borderColor=t.color,this.borderWidth=t.width)}),{borderRowLabel:a,borderStyleDropdown:c,borderColorInput:d,borderWidthInput:u}}_createBackgroundFields(){const e=this.locale,t=this.t,n=new Qe(e);n.text=t("Background");const s=Kr({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableProperties.backgroundColor,colorPickerConfig:this.options.colorPickerConfig}),o=new Ie(e,s);return o.set({label:t("Color"),class:"ck-table-properties-form__background"}),o.fieldView.bind("value").to(this,"backgroundColor"),o.fieldView.on("input",()=>{this.backgroundColor=o.fieldView.value}),{backgroundRowLabel:n,backgroundInput:o}}_createDimensionFields(){const e=this.locale,t=this.t,n=new Qe(e);n.text=t("Dimensions");const s=new Ie(e,Bt);s.set({label:t("Width"),class:"ck-table-form__dimensions-row__width"}),s.fieldView.bind("value").to(this,"width"),s.fieldView.on("input",()=>{this.width=s.fieldView.element.value});const o=new R(e);o.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:"×"}]});const r=new Ie(e,Bt);return r.set({label:t("Height"),class:"ck-table-form__dimensions-row__height"}),r.fieldView.bind("value").to(this,"height"),r.fieldView.on("input",()=>{this.height=r.fieldView.element.value}),{dimensionsLabel:n,widthInput:s,operatorLabel:o,heightInput:r}}_createAlignmentFields(){const e=this.locale,t=this.t,n=new Qe(e);n.text=t("Alignment");const s=new xi(e);return s.set({isCompact:!0,ariaLabel:t("Table alignment toolbar")}),Fc({view:this,icons:$B,toolbar:s,labels:this._alignmentLabels,propertyName:"alignment",defaultValue:this.options.defaultTableProperties.alignment}),{alignmentLabel:n,alignmentToolbar:s}}_createActionButtons(){const e=this.locale,t=this.t,n=new N(e),s=new N(e),o=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.widthInput,this.heightInput];return n.set({label:t("Save"),icon:P.check,class:"ck-button-save",type:"submit",withText:!0}),n.bind("isEnabled").toMany(o,"errorText",(...r)=>r.every(a=>!a)),s.set({label:t("Cancel"),icon:P.cancel,class:"ck-button-cancel",withText:!0}),s.delegate("execute").to(this,"cancel"),{saveButtonView:n,cancelButtonView:s}}get _alignmentLabels(){const e=this.locale,t=this.t,n=t("Align table to the left"),s=t("Center table"),o=t("Align table to the right");return e.uiLanguageDirection==="rtl"?{right:o,center:s,left:n}:{left:n,center:s,right:o}}}function Jr(i){return i!=="none"}const zB='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8 2v5h4V2h1v5h5v1h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5H7v-5H2v-1h5V8H2V7h5V2h1zm4 6H8v4h4V8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM17 1a2 2 0 0 1 2 2v9.475l-.85-.124-.857-1.736a2.048 2.048 0 0 0-.292-.44L17 3H3v14h7.808l.402.392L10.935 19H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const HB=500,wb={borderStyle:"tableBorderStyle",borderColor:"tableBorderColor",borderWidth:"tableBorderWidth",backgroundColor:"tableBackgroundColor",width:"tableWidth",height:"tableHeight",alignment:"tableAlignment"};class WB extends y{static get requires(){return[Ot]}static get pluginName(){return"TablePropertiesUI"}constructor(e){super(e),this.view=null,e.config.define("table.tableProperties",{borderColors:Gr,backgroundColors:Gr})}init(){const e=this.editor,t=e.t;this._defaultTableProperties=oo(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0}),this._balloon=e.plugins.get(Ot),e.ui.componentFactory.add("tableProperties",n=>{const s=new N(n);s.set({label:t("Table properties"),icon:zB,tooltip:!0}),this.listenTo(s,"execute",()=>this._showView());const o=Object.values(wb).map(r=>e.commands.get(r));return s.bind("isEnabled").toMany(o,"isEnabled",(...r)=>r.some(a=>a)),s})}destroy(){super.destroy(),this.view&&this.view.destroy()}_createPropertiesView(){const e=this.editor,t=e.config.get("table.tableProperties"),n=ir(t.borderColors),s=nr(e.locale,n),o=ir(t.backgroundColors),r=nr(e.locale,o),a=t.colorPicker!==!1,l=new UB(e.locale,{borderColors:s,backgroundColors:r,defaultTableProperties:this._defaultTableProperties,colorPickerConfig:a?t.colorPicker||{}:!1}),c=e.t;l.render(),this.listenTo(l,"submit",()=>{this._hideView()}),this.listenTo(l,"cancel",()=>{this._undoStepBatch.operations.length&&e.execute("undo",this._undoStepBatch),this._hideView()}),l.keystrokes.set("Esc",(h,f)=>{this._hideView(),f()}),Vn({emitter:l,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const u=ib(c),d=sb(c);return l.on("change:borderStyle",this._getPropertyChangeCallback("tableBorderStyle")),l.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:l.borderColorInput,commandName:"tableBorderColor",errorText:u,validator:qr})),l.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:l.borderWidthInput,commandName:"tableBorderWidth",errorText:d,validator:ob})),l.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:l.backgroundInput,commandName:"tableBackgroundColor",errorText:u,validator:qr})),l.on("change:width",this._getValidatedPropertyChangeCallback({viewField:l.widthInput,commandName:"tableWidth",errorText:d,validator:so})),l.on("change:height",this._getValidatedPropertyChangeCallback({viewField:l.heightInput,commandName:"tableHeight",errorText:d,validator:so})),l.on("change:alignment",this._getPropertyChangeCallback("tableAlignment")),l}_fillViewFormFromCommandValues(){const e=this.editor.commands,t=e.get("tableBorderStyle");Object.entries(wb).map(([n,s])=>{const o=n,r=this._defaultTableProperties[o]||"";return[o,e.get(s).value||r]}).forEach(([n,s])=>{(n==="borderColor"||n==="borderWidth")&&t.value==="none"||this.view.set(n,s)}),this._isReady=!0}_showView(){const e=this.editor;this.view||(this.view=this._createPropertiesView()),this.listenTo(e.ui,"update",()=>{this._updateView()}),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:ub(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){const e=this.editor;this.stopListening(e.ui,"update"),this._isReady=!1,this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}_updateView(){const e=this.editor,t=e.editing.view.document;Q1(t.selection)?this._isViewVisible&&cb(e,"table"):this._hideView()}get _isViewVisible(){return!!this.view&&this._balloon.visibleView===this.view}get _isViewInBalloon(){return!!this.view&&this._balloon.hasView(this.view)}_getPropertyChangeCallback(e){return(t,n,s)=>{this._isReady&&this.editor.execute(e,{value:s,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:t,viewField:n,validator:s,errorText:o}=e,r=St(()=>{n.errorText=o},HB);return(a,l,c)=>{r.cancel(),this._isReady&&(s(c)?(this.editor.execute(t,{value:c,batch:this._undoStepBatch}),n.errorText=null):r())}}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class jB extends y{static get pluginName(){return"TableProperties"}static get requires(){return[VB,WB]}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function qB(i){i.document.registerPostFixer(e=>GB(e,i))}function GB(i,e){const t=e.document.differ.getChanges();let n=!1;for(const s of t){if(s.type!="insert")continue;const o=s.position.parent;if(o.is("element","table")||s.name=="table"){const r=s.name=="table"?s.position.nodeAfter:o,a=Array.from(r.getChildren()).filter(c=>c.is("element","caption")),l=a.shift();if(!l)continue;for(const c of a)i.move(i.createRangeIn(c),l,"end"),i.remove(c);l.nextSibling&&(i.move(i.createRangeOn(l),r,"end"),n=!0),n=!!a.length||n}}return n}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function _b(i){return!!i&&i.is("element","table")}function Uc(i){for(const e of i.getChildren())if(e.is("element","caption"))return e;return null}function KB(i){const e=qn(i);return e?Uc(e):null}function ZB(i){const e=i.parent;return i.name=="figcaption"&&e&&e.is("element","figure")&&e.hasClass("table")?{name:!0}:i.name=="caption"&&e&&e.is("element","table")?{name:!0}:null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class JB extends F{refresh(){const e=this.editor,t=qn(e.model.document.selection);this.isEnabled=!!t,this.isEnabled?this.value=!!Uc(t):this.value=!1}execute({focusCaptionOnShow:e=!1}={}){this.editor.model.change(t=>{this.value?this._hideTableCaption(t):this._showTableCaption(t,e)})}_showTableCaption(e,t){const n=this.editor.model,s=qn(n.document.selection),a=this.editor.plugins.get("TableCaptionEditing")._getSavedCaption(s)||e.createElement("caption");n.insertContent(a,s,"end"),t&&e.setSelection(a,"in")}_hideTableCaption(e){const t=this.editor.model,n=qn(t.document.selection),s=this.editor.plugins.get("TableCaptionEditing"),o=Uc(n);s._saveCaption(n,o),t.deleteContent(e.createSelection(o,"on"))}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class YB extends y{static get pluginName(){return"TableCaptionEditing"}constructor(e){super(e),this._savedCaptionsMap=new WeakMap}init(){const e=this.editor,t=e.model.schema,n=e.editing.view,s=e.t;t.isRegistered("caption")?t.extend("caption",{allowIn:"table"}):t.register("caption",{allowIn:"table",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleTableCaption",new JB(this.editor)),e.conversion.for("upcast").elementToElement({view:ZB,model:"caption"}),e.conversion.for("dataDowncast").elementToElement({model:"caption",view:(o,{writer:r})=>_b(o.parent)?r.createContainerElement("figcaption"):null}),e.conversion.for("editingDowncast").elementToElement({model:"caption",view:(o,{writer:r})=>{if(!_b(o.parent))return null;const a=r.createEditableElement("figcaption");return r.setCustomProperty("tableCaption",!0,a),a.placeholder=s("Enter table caption"),Oo({view:n,element:a,keepOnFocus:!0}),sc(a,r)}}),qB(e.model)}_getSavedCaption(e){const t=this._savedCaptionsMap.get(e);return t?Y.fromJSON(t):null}_saveCaption(e,t){this._savedCaptionsMap.set(e,t.toJSON())}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class XB extends y{static get pluginName(){return"TableCaptionUI"}init(){const e=this.editor,t=e.editing.view,n=e.t;e.ui.componentFactory.add("toggleTableCaption",s=>{const o=e.commands.get("toggleTableCaption"),r=new N(s);return r.set({icon:P.caption,tooltip:!0,isToggleable:!0}),r.bind("isOn","isEnabled").to(o,"value","isEnabled"),r.bind("label").to(o,"value",a=>n(a?"Toggle caption off":"Toggle caption on")),this.listenTo(r,"execute",()=>{if(e.execute("toggleTableCaption",{focusCaptionOnShow:!0}),o.value){const a=KB(e.model.document.selection),l=e.editing.mapper.toViewElement(a);if(!l)return;t.scrollToTheSelection(),t.change(c=>{c.addClass("table__caption_highlighted",l)})}e.editing.view.focus()}),r})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class QB extends y{static get pluginName(){return"TableCaption"}static get requires(){return[YB,XB]}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class eO extends F{refresh(){this.isEnabled=!0}execute(e={}){const{model:t,plugins:n}=this.editor;let{table:s=t.document.selection.getSelectedElement(),columnWidths:o,tableWidth:r}=e;o&&(o=Array.isArray(o)?o:o.split(",")),t.change(a=>{r?a.setAttribute("tableWidth",r,s):a.removeAttribute("tableWidth",s);const l=n.get("TableColumnResizeEditing").getColumnGroupElement(s);if(!o&&!l)return;if(!o)return a.remove(l);const c=Mc(o);if(l)Array.from(l.getChildren()).forEach((u,d)=>a.setAttribute("columnWidth",c[d],u));else{const u=a.createElement("tableColumnGroup");c.forEach(d=>a.appendElement("tableColumn",{columnWidth:d},u)),a.append(u,s)}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function tO(i){return e=>e.on("element:colgroup",(t,n,s)=>{const o=n.modelCursor.findAncestor("table"),r=to(o);if(!r)return;const a=no(r),l=i.getColumns(o);let c=vM(r,s.writer);c=Array.from({length:l},(u,d)=>c[d]||"auto"),(c.length!=a.length||c.includes("auto"))&&H1(a,r,Mc(c),s.writer)},{priority:"low"})}function nO(){return i=>i.on("insert:table",(e,t,n)=>{const s=n.writer,o=t.item,r=n.mapper.toViewElement(o),a=r.is("element","table")?r:Array.from(r.getChildren()).find(c=>c.is("element","table"));to(o)?s.addClass("ck-table-resized",a):s.removeClass("ck-table-resized",a)},{priority:"low"})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class iO extends y{static get requires(){return[io,Ce]}static get pluginName(){return"TableColumnResizeEditing"}constructor(e){super(e),this._isResizingActive=!1,this.set("_isResizingAllowed",!0),this._resizingData=null,this._domEmitter=new(qe()),this._tableUtilsPlugin=e.plugins.get("TableUtils"),this.on("change:_isResizingAllowed",(t,n,s)=>{const o=s?"removeClass":"addClass";e.editing.view.change(r=>{for(const a of e.editing.view.document.roots)r[o]("ck-column-resize_disabled",e.editing.view.document.getRoot(a.rootName))})})}init(){this._extendSchema(),this._registerPostFixer(),this._registerConverters(),this._registerResizingListeners(),this._registerResizerInserter();const e=this.editor,t=e.plugins.get("TableColumnResize");e.plugins.get("TableEditing").registerAdditionalSlot({filter:o=>o.is("element","tableColumnGroup"),positionOffset:0});const s=new eO(e);e.commands.add("resizeTableWidth",s),e.commands.add("resizeColumnWidths",s),this.bind("_isResizingAllowed").to(e,"isReadOnly",t,"isEnabled",s,"isEnabled",(o,r,a)=>!o&&r&&a)}destroy(){this._domEmitter.stopListening(),super.destroy()}getColumnGroupElement(e){return to(e)}getTableColumnElements(e){return no(e)}getTableColumnsWidths(e){return _M(e)}_extendSchema(){this.editor.model.schema.extend("table",{allowAttributes:["tableWidth"]}),this.editor.model.schema.register("tableColumnGroup",{allowIn:"table",isLimit:!0}),this.editor.model.schema.register("tableColumn",{allowIn:"tableColumnGroup",allowAttributes:["columnWidth","colSpan"],isLimit:!0})}_registerPostFixer(){const t=this.editor.model;t.document.registerPostFixer(o=>{let r=!1;for(const a of hM(t)){const l=this.getColumnGroupElement(a),c=this.getTableColumnElements(l),u=this.getTableColumnsWidths(l);let d=Mc(u);d=n(d,a,this),!ci(u,d)&&(H1(c,l,d,o),r=!0)}return r});function n(o,r,a){const l=a._tableUtilsPlugin.getColumns(r);if(l-o.length===0)return o;const u=o.map(h=>Number(h.replace("%",""))),d=s(a.editor.model.document.differ,r);for(const h of d){const f=l-u.length;if(f===0)continue;const m=f>0,g=a._tableUtilsPlugin.getCellLocation(h).column;if(m){const b=fM(r,a.editor),_=pM(f,b);u.splice(g,0,..._)}else{const b=u.splice(g,Math.abs(f));u[g]+=eo(b)}}return u.map(h=>h+"%")}function s(o,r){const a=new Set;for(const l of o.getChanges())if(l.type=="insert"&&l.position.nodeAfter&&l.position.nodeAfter.name=="tableCell"&&l.position.nodeAfter.getAncestors().includes(r))a.add(l.position.nodeAfter);else if(l.type=="remove"){const c=l.position.nodeBefore||l.position.nodeAfter;c.name=="tableCell"&&c.getAncestors().includes(r)&&a.add(c)}return a}}_registerConverters(){const t=this.editor.conversion;t.for("upcast").attributeToAttribute({view:{name:"figure",key:"style",value:{width:/[\s\S]+/}},model:{name:"table",key:"tableWidth",value:n=>n.getStyle("width")}}),t.for("downcast").attributeToAttribute({model:{name:"table",key:"tableWidth"},view:n=>({name:"figure",key:"style",value:{width:n}})}),t.elementToElement({model:"tableColumnGroup",view:"colgroup"}),t.elementToElement({model:"tableColumn",view:"col"}),t.for("downcast").add(nO()),t.for("upcast").add(tO(this._tableUtilsPlugin)),t.for("upcast").attributeToAttribute({view:{name:"col",styles:{width:/.*/}},model:{key:"columnWidth",value:n=>{const s=n.getStyle("width");return!s||!s.endsWith("%")&&!s.endsWith("pt")?"auto":s}}}),t.for("upcast").attributeToAttribute({view:{name:"col",key:"span"},model:"colSpan"}),t.for("downcast").attributeToAttribute({model:{name:"tableColumn",key:"columnWidth"},view:n=>({key:"style",value:{width:n}})})}_registerResizingListeners(){const e=this.editor.editing.view;e.addObserver(Y1),e.document.on("mousedown",this._onMouseDownHandler.bind(this),{priority:"high"}),this._domEmitter.listenTo(I.window.document,"mousemove",os(this._onMouseMoveHandler.bind(this),50)),this._domEmitter.listenTo(I.window.document,"mouseup",this._onMouseUpHandler.bind(this))}_onMouseDownHandler(e,t){const n=t.target;if(!n.hasClass("ck-table-column-resizer")||!this._isResizingAllowed)return;const s=this.editor,o=s.editing.mapper.toModelElement(n.findAncestor("figure"));if(!s.model.canEditAt(o))return;t.preventDefault(),e.stop();const r=c(o,this._tableUtilsPlugin,s),a=n.findAncestor("table"),l=s.editing.view;Array.from(a.getChildren()).find(h=>h.is("element","colgroup"))||l.change(h=>{u(h,r,a)}),this._isResizingActive=!0,this._resizingData=this._getResizingData(t,r),l.change(h=>d(h,a,this._resizingData));function c(h,f,m){const g=Array(f.getColumns(h)),b=new X(h);for(const _ of b){const T=m.editing.mapper.toViewElement(_.cell),O=m.editing.view.domConverter.mapViewToDom(T),B=wM(O);(!g[_.column]||B<g[_.column])&&(g[_.column]=ze(B))}return g}function u(h,f,m){const g=h.createContainerElement("colgroup");for(let b=0;b<f.length;b++){const _=h.createEmptyElement("col"),T=`${ze(f[b]/eo(f)*100)}%`;h.setStyle("width",T,_),h.insert(h.createPositionAt(g,"end"),_)}h.insert(h.createPositionAt(m,0),g)}function d(h,f,m){const g=m.widths.viewFigureWidth/m.widths.viewFigureParentWidth;h.addClass("ck-table-resized",f),h.addClass("ck-table-column-resizer__active",m.elements.viewResizer),h.setStyle("width",`${ze(g*100)}%`,f.findAncestor("figure"))}}_onMouseMoveHandler(e,t){if(!this._isResizingActive)return;if(!this._isResizingAllowed){this._onMouseUpHandler();return}const{columnPosition:n,flags:{isRightEdge:s,isTableCentered:o,isLtrContent:r},elements:{viewFigure:a,viewLeftColumn:l,viewRightColumn:c},widths:{viewFigureParentWidth:u,tableWidth:d,leftColumnWidth:h,rightColumnWidth:f}}=this._resizingData,m=-h+Pc,g=s?u-d:f-Pc,b=(r?1:-1)*(s&&o?2:1),_=gM((t.clientX-n)*b,Math.min(m,0),Math.max(g,0));_!==0&&this.editor.editing.view.change(T=>{const O=ze((h+_)*100/d);if(T.setStyle("width",`${O}%`,l),s){const B=ze((d+_)*100/u);T.setStyle("width",`${B}%`,a)}else{const B=ze((f-_)*100/d);T.setStyle("width",`${B}%`,c)}})}_onMouseUpHandler(){if(!this._isResizingActive)return;const{viewResizer:e,modelTable:t,viewFigure:n,viewColgroup:s}=this._resizingData.elements,o=this.editor,r=o.editing.view,a=this.getColumnGroupElement(t),l=Array.from(s.getChildren()).filter(g=>g.is("view:element")),c=a?this.getTableColumnsWidths(a):null,u=l.map(g=>g.getStyle("width")),d=!ci(c,u),h=t.getAttribute("tableWidth"),f=n.getStyle("width"),m=h!==f;(d||m)&&(this._isResizingAllowed?o.execute("resizeTableWidth",{table:t,tableWidth:`${ze(f)}%`,columnWidths:u}):r.change(g=>{if(c)for(const b of l)g.setStyle("width",c.shift(),b);else g.remove(s);m&&(h?g.setStyle("width",h,n):g.removeStyle("width",n)),!c&&!h&&g.removeClass("ck-table-resized",[...n.getChildren()].find(b=>b.name==="table"))})),r.change(g=>{g.removeClass("ck-table-column-resizer__active",e)}),this._isResizingActive=!1,this._resizingData=null}_getResizingData(e,t){const n=this.editor,s=e.domEvent.clientX,o=e.target,r=o.findAncestor("td")||o.findAncestor("th"),a=n.editing.mapper.toModelElement(r),l=a.findAncestor("table"),c=mM(a,this._tableUtilsPlugin).rightEdge,u=this._tableUtilsPlugin.getColumns(l)-1,d=c===u,h=!l.hasAttribute("tableAlignment"),f=n.locale.contentLanguageDirection!=="rtl",m=r.findAncestor("table"),g=m.findAncestor("figure"),b=[...m.getChildren()].find(E=>E.is("element","colgroup")),_=b.getChild(c),T=d?void 0:b.getChild(c+1),O=Rc(n.editing.view.domConverter.mapViewToDom(g.parent)),B=Rc(n.editing.view.domConverter.mapViewToDom(g)),W=U1(l,n),S=t[c],V=d?void 0:t[c+1];return{columnPosition:s,flags:{isRightEdge:d,isTableCentered:h,isLtrContent:f},elements:{viewResizer:o,modelTable:l,viewFigure:g,viewColgroup:b,viewLeftColumn:_,viewRightColumn:T},widths:{viewFigureParentWidth:O,viewFigureWidth:B,tableWidth:W,leftColumnWidth:S,rightColumnWidth:V}}}_registerResizerInserter(){this.editor.conversion.for("editingDowncast").add(e=>{e.on("insert:tableCell",(t,n,s)=>{const o=n.item,r=s.mapper.toViewElement(o),a=s.writer;a.insert(a.createPositionAt(r,"end"),a.createUIElement("div",{class:"ck-table-column-resizer"}))},{priority:"lowest"})})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class sO extends y{static get requires(){return[iO,mb]}static get pluginName(){return"TableColumnResize"}}var vb={exports:{}};/*!
 * @license Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md.
 */(function(i,e){(function(t,n){i.exports=n(se)})(self,t=>(()=>{var n={976:a=>{a.exports=t}},s={};function o(a){var l=s[a];if(l!==void 0)return l.exports;var c=s[a]={exports:{}};return n[a](c,c.exports,o),c.exports}o.d=(a,l)=>{for(var c in l)o.o(l,c)&&!o.o(a,c)&&Object.defineProperty(a,c,{enumerable:!0,get:l[c]})},o.o=(a,l)=>Object.prototype.hasOwnProperty.call(a,l);var r={};return(()=>{o.d(r,{default:()=>fV});var a=o(976);const l=function(A){var Z=typeof A;return A!=null&&(Z=="object"||Z=="function")},c=typeof w.commonjsGlobal=="object"&&w.commonjsGlobal&&w.commonjsGlobal.Object===Object&&w.commonjsGlobal;var u=typeof self=="object"&&self&&self.Object===Object&&self;const d=c||u||Function("return this")(),h=function(){return d.Date.now()};var f=/\s/;const m=function(A){for(var Z=A.length;Z--&&f.test(A.charAt(Z)););return Z};var g=/^\s+/;const b=function(A){return A&&A.slice(0,m(A)+1).replace(g,"")},_=d.Symbol;var T=Object.prototype,O=T.hasOwnProperty,B=T.toString,W=_?_.toStringTag:void 0;const S=function(A){var Z=O.call(A,W),ke=A[W];try{A[W]=void 0;var At=!0}catch{}var Qn=B.call(A);return At&&(Z?A[W]=ke:delete A[W]),Qn};var V=Object.prototype.toString;const E=function(A){return V.call(A)};var L=_?_.toStringTag:void 0;const K=function(A){return A==null?A===void 0?"[object Undefined]":"[object Null]":L&&L in Object(A)?S(A):E(A)},He=function(A){return A!=null&&typeof A=="object"},zt=function(A){return typeof A=="symbol"||He(A)&&K(A)=="[object Symbol]"};var fa=/^[-+]0x[0-9a-f]+$/i,aV=/^0b[01]+$/i,lV=/^0o[0-7]+$/i,cV=parseInt;const L0=function(A){if(typeof A=="number")return A;if(zt(A))return NaN;if(l(A)){var Z=typeof A.valueOf=="function"?A.valueOf():A;A=l(Z)?Z+"":Z}if(typeof A!="string")return A===0?A:+A;A=b(A);var ke=aV.test(A);return ke||lV.test(A)?cV(A.slice(2),ke?2:8):fa.test(A)?NaN:+A};var uV=Math.max,dV=Math.min;const hV=function(A,Z,ke){var At,Qn,uo,ho,mt,ei,fo=0,D0=!1,ma=!1,ou=!0;if(typeof A!="function")throw new TypeError("Expected a function");function ru(Me){var sn=At,pa=Qn;return At=Qn=void 0,fo=Me,ho=A.apply(pa,sn)}function mV(Me){return fo=Me,mt=setTimeout(ga,Z),D0?ru(Me):ho}function N0(Me){var sn=Me-ei;return ei===void 0||sn>=Z||sn<0||ma&&Me-fo>=uo}function ga(){var Me=h();if(N0(Me))return F0(Me);mt=setTimeout(ga,function(sn){var pa=Z-(sn-ei);return ma?dV(pa,uo-(sn-fo)):pa}(Me))}function F0(Me){return mt=void 0,ou&&At?ru(Me):(At=Qn=void 0,ho)}function au(){var Me=h(),sn=N0(Me);if(At=arguments,Qn=this,ei=Me,sn){if(mt===void 0)return mV(ei);if(ma)return clearTimeout(mt),mt=setTimeout(ga,Z),ru(ei)}return mt===void 0&&(mt=setTimeout(ga,Z)),ho}return Z=L0(Z)||0,l(ke)&&(D0=!!ke.leading,uo=(ma="maxWait"in ke)?uV(L0(ke.maxWait)||0,Z):uo,ou="trailing"in ke?!!ke.trailing:ou),au.cancel=function(){mt!==void 0&&clearTimeout(mt),fo=0,At=ei=Qn=mt=void 0},au.flush=function(){return mt===void 0?ho:F0(h())},au},V0=(0,a.defineComponent)({name:"Ckeditor",model:{prop:"modelValue",event:"update:modelValue"},props:{editor:{type:Function,required:!0},config:{type:Object,default:()=>({})},modelValue:{type:String,default:""},tagName:{type:String,default:"div"},disabled:{type:Boolean,default:!1},disableTwoWayDataBinding:{type:Boolean,default:!1}},emits:["ready","destroy","blur","focus","input","update:modelValue"],data:()=>({instance:null,lastEditorData:null}),watch:{modelValue(A){this.instance&&A!==this.lastEditorData&&this.instance.data.set(A)},disabled(A){A?this.instance.enableReadOnlyMode("Integration Sample"):this.instance.disableReadOnlyMode("Integration Sample")}},created(){const{CKEDITOR_VERSION:A}=window;if(A){const[Z]=A.split(".").map(Number);Z<37&&console.warn("The <CKEditor> component requires using CKEditor 5 in version 37 or higher.")}else console.warn('Cannot find the "CKEDITOR_VERSION" in the "window" scope.')},mounted(){const A=Object.assign({},this.config);this.modelValue&&(A.initialData=this.modelValue),this.editor.create(this.$el,A).then(Z=>{this.instance=(0,a.markRaw)(Z),this.setUpEditorEvents(),this.modelValue!==A.initialData&&Z.data.set(this.modelValue),this.disabled&&Z.enableReadOnlyMode("Integration Sample"),this.$emit("ready",Z)}).catch(Z=>{console.error(Z)})},beforeUnmount(){this.instance&&(this.instance.destroy(),this.instance=null),this.$emit("destroy",this.instance)},methods:{setUpEditorEvents(){const A=this.instance,Z=hV(ke=>{if(this.disableTwoWayDataBinding)return;const At=this.lastEditorData=A.data.get();this.$emit("update:modelValue",At,ke,A),this.$emit("input",At,ke,A)},300,{leading:!0});A.model.document.on("change:data",Z),A.editing.view.document.on("focus",ke=>{this.$emit("focus",ke,A)}),A.editing.view.document.on("blur",ke=>{this.$emit("blur",ke,A)})}},render(){return(0,a.h)(this.tagName)}});if(!a.version||!a.version.startsWith("3."))throw new Error("The CKEditor plugin works only with Vue 3+. For more information, please refer to https://ckeditor.com/docs/ckeditor5/latest/builds/guides/integration/frameworks/vuejs-v3.html");const fV={install(A){A.component("Ckeditor",V0)},component:V0}})(),r=r.default})())})(vb);var oO=vb.exports;const rO=w.getDefaultExportFromCjs(oO),aO=["bold","italic","strikethrough","subscript","superscript","underline","linkHref","highlight","mention"];class lO extends y{init(){this.editor.model.schema.on("checkAttribute",(t,[n,s])=>{n.endsWith("codeBlock $text")&&(t.stop(),t.return=aO.includes(s))},{priority:"highest"})}}function ro(i,e,t,n="$text"){const s=i.model.schema,o=i.conversion;s.extend(n,{allowAttributes:[e]}),o.for("downcast").attributeToElement({model:e,view:(r,{writer:a})=>a.createAttributeElement("a",{[t]:r},{priority:5})}),o.for("upcast").attributeToAttribute({view:{name:"a",key:t},model:{key:e,value:r=>r.getAttribute(t)}})}class cO extends y{static get requires(){return[Zp]}init(){const e=this.editor;ro(e,"dataType","data-type"),ro(e,"dataContentType","data-content-type"),ro(e,"dataContentId","data-content-id"),ro(e,"dataCommunityId","data-community-id"),ro(e,"dataCommunityType","data-community-type")}}class uO extends y{init(){const e=this.editor.conversion,t=this.editor.config._config.highlight.options.map(n=>({model:n.model,class:n.class}));e.for("upcast").elementToAttribute({view:{name:"span",classes:"marker"},model:{key:"highlight",value:(n,s)=>{var l,c;const r=(l=n.getAttribute("class").split("marker")[1])==null?void 0:l.trim();return(c=t.find(u=>u.class===r))==null?void 0:c.model}}})}}function dO(i){i.conversion.for("upcast").elementToAttribute({view:e=>{if(e.name==="span"||e.name==="a"){const t=["data-login","data-content-type","data-original-text"];if(t.every(s=>e.hasAttribute(s)))return{name:!0,attributes:[...t,"data-full-name"]}}return null},model:{key:"mention",value:e=>i.plugins.get("Mention").toMentionAttribute(e,{login:e.getAttribute("data-login"),format:e.getAttribute("data-type")||"internal",contentType:e.getAttribute("data-content-type"),id:e.getAttribute("data-login"),originalText:e.getAttribute("data-original-text"),full_name:e.getAttribute("data-full-name")})},converterPriority:"highest"}),i.conversion.for("upcast").elementToAttribute({view:e=>{if(e.name==="span"||e.name==="a"){const t=["data-content-type","data-users-group-uri"];if(t.every(s=>e.hasAttribute(s)))return{name:!0,attributes:t}}return null},model:{key:"mention",value:e=>i.plugins.get("Mention").toMentionAttribute(e,{format:e.getAttribute("data-type")||"internal",contentType:e.getAttribute("data-content-type"),id:e.getAttribute("data-users-group-uri"),resource_id:e.getAttribute("data-users-group-uri")})},converterPriority:"high"}),i.conversion.for("upcast").elementToAttribute({view(e){if(e.name==="span"||e.name==="a"){const t=["data-predicate","data-tag-value","data-type"];if(t.every(s=>e.hasAttribute(s)))return{name:!0,attributes:t}}return null},model:{key:"mention",value:e=>i.plugins.get("Mention").toMentionAttribute(e,{sixw_db:e.getAttribute("data-predicate"),object_db:e.getAttribute("data-tag-value"),id:`#-${Math.random()}`})},converterPriority:"high"}),i.config.get("emojiSuggestion.enableEmoji")&&i.conversion.for("upcast").elementToAttribute({view:{name:"span",key:"data-mention",attributes:{"data-emoji-unicode":!0}},model:{key:"mention",value:e=>i.plugins.get("Mention").toMentionAttribute(e,{emoji:e.getAttribute("data-emoji-unicode"),id:`:${e.getAttribute("data-emoji-unicode")}`,name:e.getAttribute("title")})},converterPriority:"high"}),i.config.get("emojiSuggestion.enableEmoji")&&i.conversion.for("upcast").elementToAttribute({view:{name:"span",classes:"special-character"},model:{key:"mention",value:e=>i.plugins.get("Mention").toMentionAttribute(e,{emoji:e.getAttribute("data-emoji-unicode"),id:`:${e.getAttribute("data-emoji-unicode")}`,name:e.getAttribute("title")})},converterPriority:"high"}),i.conversion.for("downcast").attributeToElement({model:"mention",view:(e,{writer:t})=>{var n,s,o,r;if(e){if(((n=e.id)==null?void 0:n[0])===":")return t.createAttributeElement("span",{class:"special-character","data-emoji-unicode":e.id.substring(1),contenteditable:!1,title:e.name},{priority:20,id:e.value});if(((s=e.id)==null?void 0:s[0])==="#"){const a=e.object_db||e.object||e.label||"";return t.createAttributeElement("a",{class:"s6m-tag-link sm-link","data-predicate":e.sixw_db||e.sixw,"data-tag-value":a,"data-type":"internal",contenteditable:!1},{priority:20,id:a})}return t.createAttributeElement("a",{class:"sum-user-link sm-link","data-type":e.format,"data-content-type":(o=e.contentType)==null?void 0:o.toLowerCase(),contenteditable:!1,...((r=e.contentType)==null?void 0:r.toLowerCase())==="group"?{"data-users-group-uri":e.resource_id}:{"data-login":e.login,"data-original-text":e.originalText,...e.full_name&&{"data-full-name":e.full_name.toString().includes("&#039;")?e.full_name.toString().replaceAll("&#039;","'"):e.full_name}}},{priority:20,id:e.login})}},converterPriority:"high"})}function yb(i){return i&&i.__esModule?i.default:i}function ht(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}var Yr,D,Cb,ao,kb,Tb,Xr={},Eb=[],hO=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function gn(i,e){for(var t in e)i[t]=e[t];return i}function Ab(i){var e=i.parentNode;e&&e.removeChild(i)}function zc(i,e,t){var n,s,o,r={};for(o in e)o=="key"?n=e[o]:o=="ref"?s=e[o]:r[o]=e[o];if(arguments.length>2&&(r.children=arguments.length>3?Yr.call(arguments,2):t),typeof i=="function"&&i.defaultProps!=null)for(o in i.defaultProps)r[o]===void 0&&(r[o]=i.defaultProps[o]);return Qr(i,r,n,s,null)}function Qr(i,e,t,n,s){var o={type:i,props:e,key:t,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s??++Cb};return s==null&&D.vnode!=null&&D.vnode(o),o}function tn(){return{current:null}}function Hi(i){return i.children}function $t(i,e){this.props=i,this.context=e}function Wi(i,e){if(e==null)return i.__?Wi(i.__,i.__.__k.indexOf(i)+1):null;for(var t;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null)return t.__e;return typeof i.type=="function"?Wi(i):null}function xb(i){var e,t;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,e=0;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null){i.__e=i.__c.base=t.__e;break}return xb(i)}}function Sb(i){(!i.__d&&(i.__d=!0)&&ao.push(i)&&!ea.__r++||Tb!==D.debounceRendering)&&((Tb=D.debounceRendering)||kb)(ea)}function ea(){for(var i;ea.__r=ao.length;)i=ao.sort(function(e,t){return e.__v.__b-t.__v.__b}),ao=[],i.some(function(e){var t,n,s,o,r,a;e.__d&&(r=(o=(t=e).__v).__e,(a=t.__P)&&(n=[],(s=gn({},o)).__v=o.__v+1,Hc(a,o,s,t.__n,a.ownerSVGElement!==void 0,o.__h!=null?[r]:null,n,r??Wi(o),o.__h),Lb(n,o),o.__e!=r&&xb(o)))})}function Ib(i,e,t,n,s,o,r,a,l,c){var u,d,h,f,m,g,b,_=n&&n.__k||Eb,T=_.length;for(t.__k=[],u=0;u<e.length;u++)if((f=t.__k[u]=(f=e[u])==null||typeof f=="boolean"?null:typeof f=="string"||typeof f=="number"||typeof f=="bigint"?Qr(null,f,null,null,f):Array.isArray(f)?Qr(Hi,{children:f},null,null,null):f.__b>0?Qr(f.type,f.props,f.key,null,f.__v):f)!=null){if(f.__=t,f.__b=t.__b+1,(h=_[u])===null||h&&f.key==h.key&&f.type===h.type)_[u]=void 0;else for(d=0;d<T;d++){if((h=_[d])&&f.key==h.key&&f.type===h.type){_[d]=void 0;break}h=null}Hc(i,f,h=h||Xr,s,o,r,a,l,c),m=f.__e,(d=f.ref)&&h.ref!=d&&(b||(b=[]),h.ref&&b.push(h.ref,null,f),b.push(d,f.__c||m,f)),m!=null?(g==null&&(g=m),typeof f.type=="function"&&f.__k===h.__k?f.__d=l=Pb(f,l,i):l=Rb(i,f,h,_,m,l),typeof t.type=="function"&&(t.__d=l)):l&&h.__e==l&&l.parentNode!=i&&(l=Wi(h))}for(t.__e=g,u=T;u--;)_[u]!=null&&(typeof t.type=="function"&&_[u].__e!=null&&_[u].__e==t.__d&&(t.__d=Wi(n,u+1)),Db(_[u],_[u]));if(b)for(u=0;u<b.length;u++)Vb(b[u],b[++u],b[++u])}function Pb(i,e,t){for(var n,s=i.__k,o=0;s&&o<s.length;o++)(n=s[o])&&(n.__=i,e=typeof n.type=="function"?Pb(n,e,t):Rb(t,n,n,s,n.__e,e));return e}function ta(i,e){return e=e||[],i==null||typeof i=="boolean"||(Array.isArray(i)?i.some(function(t){ta(t,e)}):e.push(i)),e}function Rb(i,e,t,n,s,o){var r,a,l;if(e.__d!==void 0)r=e.__d,e.__d=void 0;else if(t==null||s!=o||s.parentNode==null)e:if(o==null||o.parentNode!==i)i.appendChild(s),r=null;else{for(a=o,l=0;(a=a.nextSibling)&&l<n.length;l+=2)if(a==s)break e;i.insertBefore(s,o),r=o}return r!==void 0?r:s.nextSibling}function fO(i,e,t,n,s){var o;for(o in t)o==="children"||o==="key"||o in e||na(i,o,null,t[o],n);for(o in e)s&&typeof e[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||t[o]===e[o]||na(i,o,e[o],t[o],n)}function Mb(i,e,t){e[0]==="-"?i.setProperty(e,t):i[e]=t==null?"":typeof t!="number"||hO.test(e)?t:t+"px"}function na(i,e,t,n,s){var o;e:if(e==="style")if(typeof t=="string")i.style.cssText=t;else{if(typeof n=="string"&&(i.style.cssText=n=""),n)for(e in n)t&&e in t||Mb(i.style,e,"");if(t)for(e in t)n&&t[e]===n[e]||Mb(i.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")o=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in i?e.toLowerCase().slice(2):e.slice(2),i.l||(i.l={}),i.l[e+o]=t,t?n||i.addEventListener(e,o?Ob:Bb,o):i.removeEventListener(e,o?Ob:Bb,o);else if(e!=="dangerouslySetInnerHTML"){if(s)e=e.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in i)try{i[e]=t??"";break e}catch{}typeof t=="function"||(t!=null&&(t!==!1||e[0]==="a"&&e[1]==="r")?i.setAttribute(e,t):i.removeAttribute(e))}}function Bb(i){this.l[i.type+!1](D.event?D.event(i):i)}function Ob(i){this.l[i.type+!0](D.event?D.event(i):i)}function Hc(i,e,t,n,s,o,r,a,l){var c,u,d,h,f,m,g,b,_,T,O,B=e.type;if(e.constructor!==void 0)return null;t.__h!=null&&(l=t.__h,a=e.__e=t.__e,e.__h=null,o=[a]),(c=D.__b)&&c(e);try{e:if(typeof B=="function"){if(b=e.props,_=(c=B.contextType)&&n[c.__c],T=c?_?_.props.value:c.__:n,t.__c?g=(u=e.__c=t.__c).__=u.__E:("prototype"in B&&B.prototype.render?e.__c=u=new B(b,T):(e.__c=u=new $t(b,T),u.constructor=B,u.render=gO),_&&_.sub(u),u.props=b,u.state||(u.state={}),u.context=T,u.__n=n,d=u.__d=!0,u.__h=[]),u.__s==null&&(u.__s=u.state),B.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=gn({},u.__s)),gn(u.__s,B.getDerivedStateFromProps(b,u.__s))),h=u.props,f=u.state,d)B.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(B.getDerivedStateFromProps==null&&b!==h&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(b,T),!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(b,u.__s,T)===!1||e.__v===t.__v){u.props=b,u.state=u.__s,e.__v!==t.__v&&(u.__d=!1),u.__v=e,e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(W){W&&(W.__=e)}),u.__h.length&&r.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(b,u.__s,T),u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(h,f,m)})}u.context=T,u.props=b,u.state=u.__s,(c=D.__r)&&c(e),u.__d=!1,u.__v=e,u.__P=i,c=u.render(u.props,u.state,u.context),u.state=u.__s,u.getChildContext!=null&&(n=gn(gn({},n),u.getChildContext())),d||u.getSnapshotBeforeUpdate==null||(m=u.getSnapshotBeforeUpdate(h,f)),O=c!=null&&c.type===Hi&&c.key==null?c.props.children:c,Ib(i,Array.isArray(O)?O:[O],e,t,n,s,o,r,a,l),u.base=e.__e,e.__h=null,u.__h.length&&r.push(u),g&&(u.__E=u.__=null),u.__e=!1}else o==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=mO(t.__e,e,t,n,s,o,r,l);(c=D.diffed)&&c(e)}catch(W){e.__v=null,(l||o!=null)&&(e.__e=a,e.__h=!!l,o[o.indexOf(a)]=null),D.__e(W,e,t)}}function Lb(i,e){D.__c&&D.__c(e,i),i.some(function(t){try{i=t.__h,t.__h=[],i.some(function(n){n.call(t)})}catch(n){D.__e(n,t.__v)}})}function mO(i,e,t,n,s,o,r,a){var l,c,u,d=t.props,h=e.props,f=e.type,m=0;if(f==="svg"&&(s=!0),o!=null){for(;m<o.length;m++)if((l=o[m])&&"setAttribute"in l==!!f&&(f?l.localName===f:l.nodeType===3)){i=l,o[m]=null;break}}if(i==null){if(f===null)return document.createTextNode(h);i=s?document.createElementNS("http://www.w3.org/2000/svg",f):document.createElement(f,h.is&&h),o=null,a=!1}if(f===null)d===h||a&&i.data===h||(i.data=h);else{if(o=o&&Yr.call(i.childNodes),c=(d=t.props||Xr).dangerouslySetInnerHTML,u=h.dangerouslySetInnerHTML,!a){if(o!=null)for(d={},m=0;m<i.attributes.length;m++)d[i.attributes[m].name]=i.attributes[m].value;(u||c)&&(u&&(c&&u.__html==c.__html||u.__html===i.innerHTML)||(i.innerHTML=u&&u.__html||""))}if(fO(i,h,d,s,a),u)e.__k=[];else if(m=e.props.children,Ib(i,Array.isArray(m)?m:[m],e,t,n,s&&f!=="foreignObject",o,r,o?o[0]:t.__k&&Wi(t,0),a),o!=null)for(m=o.length;m--;)o[m]!=null&&Ab(o[m]);a||("value"in h&&(m=h.value)!==void 0&&(m!==d.value||m!==i.value||f==="progress"&&!m)&&na(i,"value",m,d.value,!1),"checked"in h&&(m=h.checked)!==void 0&&m!==i.checked&&na(i,"checked",m,d.checked,!1))}return i}function Vb(i,e,t){try{typeof i=="function"?i(e):i.current=e}catch(n){D.__e(n,t)}}function Db(i,e,t){var n,s;if(D.unmount&&D.unmount(i),(n=i.ref)&&(n.current&&n.current!==i.__e||Vb(n,null,e)),(n=i.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){D.__e(o,e)}n.base=n.__P=null}if(n=i.__k)for(s=0;s<n.length;s++)n[s]&&Db(n[s],e,typeof i.type!="function");t||i.__e==null||Ab(i.__e),i.__e=i.__d=void 0}function gO(i,e,t){return this.constructor(i,t)}function Nb(i,e,t){var n,s,o;D.__&&D.__(i,e),s=(n=typeof t=="function")?null:t&&t.__k||e.__k,o=[],Hc(e,i=(!n&&t||e).__k=zc(Hi,null,[i]),s||Xr,Xr,e.ownerSVGElement!==void 0,!n&&t?[t]:s?null:e.firstChild?Yr.call(e.childNodes):null,o,!n&&t?t:s?s.__e:e.firstChild,n),Lb(o,i)}Yr=Eb.slice,D={__e:function(i,e){for(var t,n,s;e=e.__;)if((t=e.__c)&&!t.__)try{if((n=t.constructor)&&n.getDerivedStateFromError!=null&&(t.setState(n.getDerivedStateFromError(i)),s=t.__d),t.componentDidCatch!=null&&(t.componentDidCatch(i),s=t.__d),s)return t.__E=t}catch(o){i=o}throw i}},Cb=0,$t.prototype.setState=function(i,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=gn({},this.state),typeof i=="function"&&(i=i(gn({},t),this.props)),i&&gn(t,i),i!=null&&this.__v&&(e&&this.__h.push(e),Sb(this))},$t.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),Sb(this))},$t.prototype.render=Hi,ao=[],kb=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ea.__r=0;var pO=0;function k(i,e,t,n,s){var o,r,a={};for(r in e)r=="ref"?o=e[r]:a[r]=e[r];var l={type:i,props:a,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--pO,__source:n,__self:s};if(typeof i=="function"&&(o=i.defaultProps))for(r in o)a[r]===void 0&&(a[r]=o[r]);return D.vnode&&D.vnode(l),l}function bO(i,e){try{window.localStorage[`emoji-mart.${i}`]=JSON.stringify(e)}catch{}}function wO(i){try{const e=window.localStorage[`emoji-mart.${i}`];if(e)return JSON.parse(e)}catch{}}var pn={set:bO,get:wO};const Wc=new Map,_O=[{v:15,emoji:"🫨"},{v:14,emoji:"🫠"},{v:13.1,emoji:"😶‍🌫️"},{v:13,emoji:"🥸"},{v:12.1,emoji:"🧑‍🦰"},{v:12,emoji:"🥱"},{v:11,emoji:"🥰"},{v:5,emoji:"🤩"},{v:4,emoji:"👱‍♀️"},{v:3,emoji:"🤣"},{v:2,emoji:"👋🏻"},{v:1,emoji:"🙃"}];function vO(){for(const{v:i,emoji:e}of _O)if(Fb(e))return i}function yO(){return!Fb("🇨🇦")}function Fb(i){if(Wc.has(i))return Wc.get(i);const e=CO(i);return Wc.set(i,e),e}const CO=(()=>{let i=null;try{navigator.userAgent.includes("jsdom")||(i=document.createElement("canvas").getContext("2d",{willReadFrequently:!0}))}catch{}if(!i)return()=>!1;const e=25,t=20,n=Math.floor(e/2);return i.font=n+"px Arial, Sans-Serif",i.textBaseline="top",i.canvas.width=t*2,i.canvas.height=e,s=>{i.clearRect(0,0,t*2,e),i.fillStyle="#FF0000",i.fillText(s,0,22),i.fillStyle="#0000FF",i.fillText(s,t,22);const o=i.getImageData(0,0,t,e).data,r=o.length;let a=0;for(;a<r&&!o[a+3];a+=4);if(a>=r)return!1;const l=t+a/4%t,c=Math.floor(a/4/t),u=i.getImageData(l,c,1,1).data;return!(o[a]!==u[0]||o[a+2]!==u[2]||i.measureText(s).width>=t)}})();var $b={latestVersion:vO,noCountryFlags:yO};const jc=["+1","grinning","kissing_heart","heart_eyes","laughing","stuck_out_tongue_winking_eye","sweat_smile","joy","scream","disappointed","unamused","weary","sob","sunglasses","heart"];let xe=null;function kO(i){xe||(xe=pn.get("frequently")||{});const e=i.id||i;e&&(xe[e]||(xe[e]=0),xe[e]+=1,pn.set("last",e),pn.set("frequently",xe))}function TO({maxFrequentRows:i,perLine:e}){if(!i)return[];xe||(xe=pn.get("frequently"));let t=[];if(!xe){xe={};for(let o in jc.slice(0,e)){const r=jc[o];xe[r]=e-o,t.push(r)}return t}const n=i*e,s=pn.get("last");for(let o in xe)t.push(o);if(t.sort((o,r)=>{const a=xe[r],l=xe[o];return a==l?o.localeCompare(r):a-l}),t.length>n){const o=t.slice(n);t=t.slice(0,n);for(let r of o)r!=s&&delete xe[r];s&&t.indexOf(s)==-1&&(delete xe[t[t.length-1]],t.splice(-1,1,s)),pn.set("frequently",xe)}return t}var Ub={add:kO,get:TO,DEFAULTS:jc},zb={};zb=JSON.parse('{"search":"Search","search_no_results_1":"Oh no!","search_no_results_2":"That emoji couldn’t be found","pick":"Pick an emoji…","add_custom":"Add custom emoji","categories":{"activity":"Activity","custom":"Custom","flags":"Flags","foods":"Food & Drink","frequent":"Frequently used","nature":"Animals & Nature","objects":"Objects","people":"Smileys & People","places":"Travel & Places","search":"Search Results","symbols":"Symbols"},"skins":{"1":"Default","2":"Light","3":"Medium-Light","4":"Medium","5":"Medium-Dark","6":"Dark","choose":"Choose default skin tone"}}');var nn={autoFocus:{value:!1},dynamicWidth:{value:!1},emojiButtonColors:{value:null},emojiButtonRadius:{value:"100%"},emojiButtonSize:{value:36},emojiSize:{value:24},emojiVersion:{value:15,choices:[1,2,3,4,5,11,12,12.1,13,13.1,14,15]},exceptEmojis:{value:[]},icons:{value:"auto",choices:["auto","outline","solid"]},locale:{value:"en",choices:["en","ar","be","cs","de","es","fa","fi","fr","hi","it","ja","ko","nl","pl","pt","ru","sa","tr","uk","vi","zh"]},maxFrequentRows:{value:4},navPosition:{value:"top",choices:["top","bottom","none"]},noCountryFlags:{value:!1},noResultsEmoji:{value:null},perLine:{value:9},previewEmoji:{value:null},previewPosition:{value:"bottom",choices:["top","bottom","none"]},searchPosition:{value:"sticky",choices:["sticky","static","none"]},set:{value:"native",choices:["native","apple","facebook","google","twitter"]},skin:{value:1,choices:[1,2,3,4,5,6]},skinTonePosition:{value:"preview",choices:["preview","search","none"]},theme:{value:"auto",choices:["auto","light","dark"]},categories:null,categoryIcons:null,custom:null,data:null,i18n:null,getImageURL:null,getSpritesheetURL:null,onAddCustomEmoji:null,onClickOutside:null,onEmojiSelect:null,stickySearch:{deprecated:!0,value:!0}};let Re=null,j=null;const qc={};async function Hb(i){if(qc[i])return qc[i];const t=await(await fetch(i)).json();return qc[i]=t,t}let Gc=null,Wb=null,jb=!1;function ia(i,{caller:e}={}){return Gc||(Gc=new Promise(t=>{Wb=t})),i?EO(i):e&&!jb&&console.warn(`\`${e}\` requires data to be initialized first. Promise will be pending until \`init\` is called.`),Gc}async function EO(i){jb=!0;let{emojiVersion:e,set:t,locale:n}=i;if(e||(e=nn.emojiVersion.value),t||(t=nn.set.value),n||(n=nn.locale.value),j)j.categories=j.categories.filter(l=>!l.name);else{j=(typeof i.data=="function"?await i.data():i.data)||await Hb(`https://cdn.jsdelivr.net/npm/@emoji-mart/data@latest/sets/${e}/${t}.json`),j.emoticons={},j.natives={},j.categories.unshift({id:"frequent",emojis:[]});for(const l in j.aliases){const c=j.aliases[l],u=j.emojis[c];u&&(u.aliases||(u.aliases=[]),u.aliases.push(l))}j.originalCategories=j.categories}if(Re=(typeof i.i18n=="function"?await i.i18n():i.i18n)||(n=="en"?yb(zb):await Hb(`https://cdn.jsdelivr.net/npm/@emoji-mart/data@latest/i18n/${n}.json`)),i.custom)for(let l in i.custom){l=parseInt(l);const c=i.custom[l],u=i.custom[l-1];if(!(!c.emojis||!c.emojis.length)){c.id||(c.id=`custom_${l+1}`),c.name||(c.name=Re.categories.custom),u&&!c.icon&&(c.target=u.target||u),j.categories.push(c);for(const d of c.emojis)j.emojis[d.id]=d}}i.categories&&(j.categories=j.originalCategories.filter(l=>i.categories.indexOf(l.id)!=-1).sort((l,c)=>{const u=i.categories.indexOf(l.id),d=i.categories.indexOf(c.id);return u-d}));let s=null,o=null;t=="native"&&(s=$b.latestVersion(),o=i.noCountryFlags||$b.noCountryFlags());let r=j.categories.length,a=!1;for(;r--;){const l=j.categories[r];if(l.id=="frequent"){let{maxFrequentRows:d,perLine:h}=i;d=d>=0?d:nn.maxFrequentRows.value,h||(h=nn.perLine.value),l.emojis=Ub.get({maxFrequentRows:d,perLine:h})}if(!l.emojis||!l.emojis.length){j.categories.splice(r,1);continue}const{categoryIcons:c}=i;if(c){const d=c[l.id];d&&!l.icon&&(l.icon=d)}let u=l.emojis.length;for(;u--;){const d=l.emojis[u],h=d.id?d:j.emojis[d],f=()=>{l.emojis.splice(u,1)};if(!h||i.exceptEmojis&&i.exceptEmojis.includes(h.id)){f();continue}if(s&&h.version>s){f();continue}if(o&&l.id=="flags"&&!PO.includes(h.id)){f();continue}if(!h.search){if(a=!0,h.search=","+[[h.id,!1],[h.name,!0],[h.keywords,!1],[h.emoticons,!1]].map(([g,b])=>{if(g)return(Array.isArray(g)?g:[g]).map(_=>(b?_.split(/[-|_|\s]+/):[_]).map(T=>T.toLowerCase())).flat()}).flat().filter(g=>g&&g.trim()).join(","),h.emoticons)for(const g of h.emoticons)j.emoticons[g]||(j.emoticons[g]=h.id);let m=0;for(const g of h.skins){if(!g)continue;m++;const{native:b}=g;b&&(j.natives[b]=h.id,h.search+=`,${b}`);const _=m==1?"":`:skin-tone-${m}:`;g.shortcodes=`:${h.id}:${_}`}}}}a&&ji.reset(),Wb()}function qb(i,e,t){i||(i={});const n={};for(let s in e)n[s]=Gb(s,i,e,t);return n}function Gb(i,e,t,n){const s=t[i];let o=n&&n.getAttribute(i)||(e[i]!=null&&e[i]!=null?e[i]:null);return s&&(o!=null&&s.value&&typeof s.value!=typeof o&&(typeof s.value=="boolean"?o=o!="false":o=s.value.constructor(o)),s.transform&&o&&(o=s.transform(o)),(o==null||s.choices&&s.choices.indexOf(o)==-1)&&(o=s.value)),o}const AO=/^(?:\:([^\:]+)\:)(?:\:skin-tone-(\d)\:)?$/;let Kc=null;function xO(i){return i.id?i:j.emojis[i]||j.emojis[j.aliases[i]]||j.emojis[j.natives[i]]}function SO(){Kc=null}async function IO(i,{maxResults:e,caller:t}={}){if(!i||!i.trim().length)return null;e||(e=90),await ia(null,{caller:t||"SearchIndex.search"});const n=i.toLowerCase().replace(/(\w)-/,"$1 ").split(/[\s|,]+/).filter((a,l,c)=>a.trim()&&c.indexOf(a)==l);if(!n.length)return;let s=Kc||(Kc=Object.values(j.emojis)),o,r;for(const a of n){if(!s.length)break;o=[],r={};for(const l of s){if(!l.search)continue;const c=l.search.indexOf(`,${a}`);c!=-1&&(o.push(l),r[l.id]||(r[l.id]=0),r[l.id]+=l.id==a?0:c+1)}s=o}return o.length<2||(o.sort((a,l)=>{const c=r[a.id],u=r[l.id];return c==u?a.id.localeCompare(l.id):c-u}),o.length>e&&(o=o.slice(0,e))),o}var ji={search:IO,get:xO,reset:SO,SHORTCODES_REGEX:AO};const PO=["checkered_flag","crossed_flags","pirate_flag","rainbow-flag","transgender_flag","triangular_flag_on_post","waving_black_flag","waving_white_flag"];function RO(i,e){return Array.isArray(i)&&Array.isArray(e)&&i.length===e.length&&i.every((t,n)=>t==e[n])}async function MO(i=1){for(let e in[...Array(i).keys()])await new Promise(requestAnimationFrame)}function BO(i,{skinIndex:e=0}={}){const t=i.skins[e]||(e=0,i.skins[e]),n={id:i.id,name:i.name,native:t.native,unified:t.unified,keywords:i.keywords,shortcodes:t.shortcodes||i.shortcodes};return i.skins.length>1&&(n.skin=e+1),t.src&&(n.src=t.src),i.aliases&&i.aliases.length&&(n.aliases=i.aliases),i.emoticons&&i.emoticons.length&&(n.emoticons=i.emoticons),n}var sa={categories:{activity:{outline:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:k("path",{d:"M12 0C5.373 0 0 5.372 0 12c0 6.627 5.373 12 12 12 6.628 0 12-5.373 12-12 0-6.628-5.372-12-12-12m9.949 11H17.05c.224-2.527 1.232-4.773 1.968-6.113A9.966 9.966 0 0 1 21.949 11M13 11V2.051a9.945 9.945 0 0 1 4.432 1.564c-.858 1.491-2.156 4.22-2.392 7.385H13zm-2 0H8.961c-.238-3.165-1.536-5.894-2.393-7.385A9.95 9.95 0 0 1 11 2.051V11zm0 2v8.949a9.937 9.937 0 0 1-4.432-1.564c.857-1.492 2.155-4.221 2.393-7.385H11zm4.04 0c.236 3.164 1.534 5.893 2.392 7.385A9.92 9.92 0 0 1 13 21.949V13h2.04zM4.982 4.887C5.718 6.227 6.726 8.473 6.951 11h-4.9a9.977 9.977 0 0 1 2.931-6.113M2.051 13h4.9c-.226 2.527-1.233 4.771-1.969 6.113A9.972 9.972 0 0 1 2.051 13m16.967 6.113c-.735-1.342-1.744-3.586-1.968-6.113h4.899a9.961 9.961 0 0 1-2.931 6.113"})}),solid:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:k("path",{d:"M16.17 337.5c0 44.98 7.565 83.54 13.98 107.9C35.22 464.3 50.46 496 174.9 496c9.566 0 19.59-.4707 29.84-1.271L17.33 307.3C16.53 317.6 16.17 327.7 16.17 337.5zM495.8 174.5c0-44.98-7.565-83.53-13.98-107.9c-4.688-17.54-18.34-31.23-36.04-35.95C435.5 27.91 392.9 16 337 16c-9.564 0-19.59 .4707-29.84 1.271l187.5 187.5C495.5 194.4 495.8 184.3 495.8 174.5zM26.77 248.8l236.3 236.3c142-36.1 203.9-150.4 222.2-221.1L248.9 26.87C106.9 62.96 45.07 177.2 26.77 248.8zM256 335.1c0 9.141-7.474 16-16 16c-4.094 0-8.188-1.564-11.31-4.689L164.7 283.3C161.6 280.2 160 276.1 160 271.1c0-8.529 6.865-16 16-16c4.095 0 8.189 1.562 11.31 4.688l64.01 64C254.4 327.8 256 331.9 256 335.1zM304 287.1c0 9.141-7.474 16-16 16c-4.094 0-8.188-1.564-11.31-4.689L212.7 235.3C209.6 232.2 208 228.1 208 223.1c0-9.141 7.473-16 16-16c4.094 0 8.188 1.562 11.31 4.688l64.01 64.01C302.5 279.8 304 283.9 304 287.1zM256 175.1c0-9.141 7.473-16 16-16c4.094 0 8.188 1.562 11.31 4.688l64.01 64.01c3.125 3.125 4.688 7.219 4.688 11.31c0 9.133-7.468 16-16 16c-4.094 0-8.189-1.562-11.31-4.688l-64.01-64.01C257.6 184.2 256 180.1 256 175.1z"})})},custom:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",children:k("path",{d:"M417.1 368c-5.937 10.27-16.69 16-27.75 16c-5.422 0-10.92-1.375-15.97-4.281L256 311.4V448c0 17.67-14.33 32-31.1 32S192 465.7 192 448V311.4l-118.3 68.29C68.67 382.6 63.17 384 57.75 384c-11.06 0-21.81-5.734-27.75-16c-8.828-15.31-3.594-34.88 11.72-43.72L159.1 256L41.72 187.7C26.41 178.9 21.17 159.3 29.1 144C36.63 132.5 49.26 126.7 61.65 128.2C65.78 128.7 69.88 130.1 73.72 132.3L192 200.6V64c0-17.67 14.33-32 32-32S256 46.33 256 64v136.6l118.3-68.29c3.838-2.213 7.939-3.539 12.07-4.051C398.7 126.7 411.4 132.5 417.1 144c8.828 15.31 3.594 34.88-11.72 43.72L288 256l118.3 68.28C421.6 333.1 426.8 352.7 417.1 368z"})}),flags:{outline:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:k("path",{d:"M0 0l6.084 24H8L1.916 0zM21 5h-4l-1-4H4l3 12h3l1 4h13L21 5zM6.563 3h7.875l2 8H8.563l-2-8zm8.832 10l-2.856 1.904L12.063 13h3.332zM19 13l-1.5-6h1.938l2 8H16l3-2z"})}),solid:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:k("path",{d:"M64 496C64 504.8 56.75 512 48 512h-32C7.25 512 0 504.8 0 496V32c0-17.75 14.25-32 32-32s32 14.25 32 32V496zM476.3 0c-6.365 0-13.01 1.35-19.34 4.233c-45.69 20.86-79.56 27.94-107.8 27.94c-59.96 0-94.81-31.86-163.9-31.87C160.9 .3055 131.6 4.867 96 15.75v350.5c32-9.984 59.87-14.1 84.85-14.1c73.63 0 124.9 31.78 198.6 31.78c31.91 0 68.02-5.971 111.1-23.09C504.1 355.9 512 344.4 512 332.1V30.73C512 11.1 495.3 0 476.3 0z"})})},foods:{outline:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:k("path",{d:"M17 4.978c-1.838 0-2.876.396-3.68.934.513-1.172 1.768-2.934 4.68-2.934a1 1 0 0 0 0-2c-2.921 0-4.629 1.365-5.547 2.512-.064.078-.119.162-.18.244C11.73 1.838 10.798.023 9.207.023 8.579.022 7.85.306 7 .978 5.027 2.54 5.329 3.902 6.492 4.999 3.609 5.222 0 7.352 0 12.969c0 4.582 4.961 11.009 9 11.009 1.975 0 2.371-.486 3-1 .629.514 1.025 1 3 1 4.039 0 9-6.418 9-11 0-5.953-4.055-8-7-8M8.242 2.546c.641-.508.943-.523.965-.523.426.169.975 1.405 1.357 3.055-1.527-.629-2.741-1.352-2.98-1.846.059-.112.241-.356.658-.686M15 21.978c-1.08 0-1.21-.109-1.559-.402l-.176-.146c-.367-.302-.816-.452-1.266-.452s-.898.15-1.266.452l-.176.146c-.347.292-.477.402-1.557.402-2.813 0-7-5.389-7-9.009 0-5.823 4.488-5.991 5-5.991 1.939 0 2.484.471 3.387 1.251l.323.276a1.995 1.995 0 0 0 2.58 0l.323-.276c.902-.78 1.447-1.251 3.387-1.251.512 0 5 .168 5 6 0 3.617-4.187 9-7 9"})}),solid:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:k("path",{d:"M481.9 270.1C490.9 279.1 496 291.3 496 304C496 316.7 490.9 328.9 481.9 337.9C472.9 346.9 460.7 352 448 352H64C51.27 352 39.06 346.9 30.06 337.9C21.06 328.9 16 316.7 16 304C16 291.3 21.06 279.1 30.06 270.1C39.06 261.1 51.27 256 64 256H448C460.7 256 472.9 261.1 481.9 270.1zM475.3 388.7C478.3 391.7 480 395.8 480 400V416C480 432.1 473.3 449.3 461.3 461.3C449.3 473.3 432.1 480 416 480H96C79.03 480 62.75 473.3 50.75 461.3C38.74 449.3 32 432.1 32 416V400C32 395.8 33.69 391.7 36.69 388.7C39.69 385.7 43.76 384 48 384H464C468.2 384 472.3 385.7 475.3 388.7zM50.39 220.8C45.93 218.6 42.03 215.5 38.97 211.6C35.91 207.7 33.79 203.2 32.75 198.4C31.71 193.5 31.8 188.5 32.99 183.7C54.98 97.02 146.5 32 256 32C365.5 32 457 97.02 479 183.7C480.2 188.5 480.3 193.5 479.2 198.4C478.2 203.2 476.1 207.7 473 211.6C469.1 215.5 466.1 218.6 461.6 220.8C457.2 222.9 452.3 224 447.3 224H64.67C59.73 224 54.84 222.9 50.39 220.8zM372.7 116.7C369.7 119.7 368 123.8 368 128C368 131.2 368.9 134.3 370.7 136.9C372.5 139.5 374.1 141.6 377.9 142.8C380.8 143.1 384 144.3 387.1 143.7C390.2 143.1 393.1 141.6 395.3 139.3C397.6 137.1 399.1 134.2 399.7 131.1C400.3 128 399.1 124.8 398.8 121.9C397.6 118.1 395.5 116.5 392.9 114.7C390.3 112.9 387.2 111.1 384 111.1C379.8 111.1 375.7 113.7 372.7 116.7V116.7zM244.7 84.69C241.7 87.69 240 91.76 240 96C240 99.16 240.9 102.3 242.7 104.9C244.5 107.5 246.1 109.6 249.9 110.8C252.8 111.1 256 112.3 259.1 111.7C262.2 111.1 265.1 109.6 267.3 107.3C269.6 105.1 271.1 102.2 271.7 99.12C272.3 96.02 271.1 92.8 270.8 89.88C269.6 86.95 267.5 84.45 264.9 82.7C262.3 80.94 259.2 79.1 256 79.1C251.8 79.1 247.7 81.69 244.7 84.69V84.69zM116.7 116.7C113.7 119.7 112 123.8 112 128C112 131.2 112.9 134.3 114.7 136.9C116.5 139.5 118.1 141.6 121.9 142.8C124.8 143.1 128 144.3 131.1 143.7C134.2 143.1 137.1 141.6 139.3 139.3C141.6 137.1 143.1 134.2 143.7 131.1C144.3 128 143.1 124.8 142.8 121.9C141.6 118.1 139.5 116.5 136.9 114.7C134.3 112.9 131.2 111.1 128 111.1C123.8 111.1 119.7 113.7 116.7 116.7L116.7 116.7z"})})},frequent:{outline:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[k("path",{d:"M13 4h-2l-.001 7H9v2h2v2h2v-2h4v-2h-4z"}),k("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10"})]}),solid:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:k("path",{d:"M256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512zM232 256C232 264 236 271.5 242.7 275.1L338.7 339.1C349.7 347.3 364.6 344.3 371.1 333.3C379.3 322.3 376.3 307.4 365.3 300L280 243.2V120C280 106.7 269.3 96 255.1 96C242.7 96 231.1 106.7 231.1 120L232 256z"})})},nature:{outline:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[k("path",{d:"M15.5 8a1.5 1.5 0 1 0 .001 3.001A1.5 1.5 0 0 0 15.5 8M8.5 8a1.5 1.5 0 1 0 .001 3.001A1.5 1.5 0 0 0 8.5 8"}),k("path",{d:"M18.933 0h-.027c-.97 0-2.138.787-3.018 1.497-1.274-.374-2.612-.51-3.887-.51-1.285 0-2.616.133-3.874.517C7.245.79 6.069 0 5.093 0h-.027C3.352 0 .07 2.67.002 7.026c-.039 2.479.276 4.238 1.04 5.013.254.258.882.677 1.295.882.191 3.177.922 5.238 2.536 6.38.897.637 2.187.949 3.2 1.102C8.04 20.6 8 20.795 8 21c0 1.773 2.35 3 4 3 1.648 0 4-1.227 4-3 0-.201-.038-.393-.072-.586 2.573-.385 5.435-1.877 5.925-7.587.396-.22.887-.568 1.104-.788.763-.774 1.079-2.534 1.04-5.013C23.929 2.67 20.646 0 18.933 0M3.223 9.135c-.237.281-.837 1.155-.884 1.238-.15-.41-.368-1.349-.337-3.291.051-3.281 2.478-4.972 3.091-5.031.256.015.731.27 1.265.646-1.11 1.171-2.275 2.915-2.352 5.125-.133.546-.398.858-.783 1.313M12 22c-.901 0-1.954-.693-2-1 0-.654.475-1.236 1-1.602V20a1 1 0 1 0 2 0v-.602c.524.365 1 .947 1 1.602-.046.307-1.099 1-2 1m3-3.48v.02a4.752 4.752 0 0 0-1.262-1.02c1.092-.516 2.239-1.334 2.239-2.217 0-1.842-1.781-2.195-3.977-2.195-2.196 0-3.978.354-3.978 2.195 0 .883 1.148 1.701 2.238 2.217A4.8 4.8 0 0 0 9 18.539v-.025c-1-.076-2.182-.281-2.973-.842-1.301-.92-1.838-3.045-1.853-6.478l.023-.041c.496-.826 1.49-1.45 1.804-3.102 0-2.047 1.357-3.631 2.362-4.522C9.37 3.178 10.555 3 11.948 3c1.447 0 2.685.192 3.733.57 1 .9 2.316 2.465 2.316 4.48.313 1.651 1.307 2.275 1.803 3.102.035.058.068.117.102.178-.059 5.967-1.949 7.01-4.902 7.19m6.628-8.202c-.037-.065-.074-.13-.113-.195a7.587 7.587 0 0 0-.739-.987c-.385-.455-.648-.768-.782-1.313-.076-2.209-1.241-3.954-2.353-5.124.531-.376 1.004-.63 1.261-.647.636.071 3.044 1.764 3.096 5.031.027 1.81-.347 3.218-.37 3.235"})]}),solid:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",children:k("path",{d:"M332.7 19.85C334.6 8.395 344.5 0 356.1 0C363.6 0 370.6 3.52 375.1 9.502L392 32H444.1C456.8 32 469.1 37.06 478.1 46.06L496 64H552C565.3 64 576 74.75 576 88V112C576 156.2 540.2 192 496 192H426.7L421.6 222.5L309.6 158.5L332.7 19.85zM448 64C439.2 64 432 71.16 432 80C432 88.84 439.2 96 448 96C456.8 96 464 88.84 464 80C464 71.16 456.8 64 448 64zM416 256.1V480C416 497.7 401.7 512 384 512H352C334.3 512 320 497.7 320 480V364.8C295.1 377.1 268.8 384 240 384C211.2 384 184 377.1 160 364.8V480C160 497.7 145.7 512 128 512H96C78.33 512 64 497.7 64 480V249.8C35.23 238.9 12.64 214.5 4.836 183.3L.9558 167.8C-3.331 150.6 7.094 133.2 24.24 128.1C41.38 124.7 58.76 135.1 63.05 152.2L66.93 167.8C70.49 182 83.29 191.1 97.97 191.1H303.8L416 256.1z"})})},objects:{outline:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[k("path",{d:"M12 0a9 9 0 0 0-5 16.482V21s2.035 3 5 3 5-3 5-3v-4.518A9 9 0 0 0 12 0zm0 2c3.86 0 7 3.141 7 7s-3.14 7-7 7-7-3.141-7-7 3.14-7 7-7zM9 17.477c.94.332 1.946.523 3 .523s2.06-.19 3-.523v.834c-.91.436-1.925.689-3 .689a6.924 6.924 0 0 1-3-.69v-.833zm.236 3.07A8.854 8.854 0 0 0 12 21c.965 0 1.888-.167 2.758-.451C14.155 21.173 13.153 22 12 22c-1.102 0-2.117-.789-2.764-1.453z"}),k("path",{d:"M14.745 12.449h-.004c-.852-.024-1.188-.858-1.577-1.824-.421-1.061-.703-1.561-1.182-1.566h-.009c-.481 0-.783.497-1.235 1.537-.436.982-.801 1.811-1.636 1.791l-.276-.043c-.565-.171-.853-.691-1.284-1.794-.125-.313-.202-.632-.27-.913-.051-.213-.127-.53-.195-.634C7.067 9.004 7.039 9 6.99 9A1 1 0 0 1 7 7h.01c1.662.017 2.015 1.373 2.198 2.134.486-.981 1.304-2.058 2.797-2.075 1.531.018 2.28 1.153 2.731 2.141l.002-.008C14.944 8.424 15.327 7 16.979 7h.032A1 1 0 1 1 17 9h-.011c-.149.076-.256.474-.319.709a6.484 6.484 0 0 1-.311.951c-.429.973-.79 1.789-1.614 1.789"})]}),solid:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",children:k("path",{d:"M112.1 454.3c0 6.297 1.816 12.44 5.284 17.69l17.14 25.69c5.25 7.875 17.17 14.28 26.64 14.28h61.67c9.438 0 21.36-6.401 26.61-14.28l17.08-25.68c2.938-4.438 5.348-12.37 5.348-17.7L272 415.1h-160L112.1 454.3zM191.4 .0132C89.44 .3257 16 82.97 16 175.1c0 44.38 16.44 84.84 43.56 115.8c16.53 18.84 42.34 58.23 52.22 91.45c.0313 .25 .0938 .5166 .125 .7823h160.2c.0313-.2656 .0938-.5166 .125-.7823c9.875-33.22 35.69-72.61 52.22-91.45C351.6 260.8 368 220.4 368 175.1C368 78.61 288.9-.2837 191.4 .0132zM192 96.01c-44.13 0-80 35.89-80 79.1C112 184.8 104.8 192 96 192S80 184.8 80 176c0-61.76 50.25-111.1 112-111.1c8.844 0 16 7.159 16 16S200.8 96.01 192 96.01z"})})},people:{outline:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[k("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10"}),k("path",{d:"M8 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 8 7M16 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 16 7M15.232 15c-.693 1.195-1.87 2-3.349 2-1.477 0-2.655-.805-3.347-2H15m3-2H6a6 6 0 1 0 12 0"})]}),solid:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:k("path",{d:"M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM256 432C332.1 432 396.2 382 415.2 314.1C419.1 300.4 407.8 288 393.6 288H118.4C104.2 288 92.92 300.4 96.76 314.1C115.8 382 179.9 432 256 432V432zM176.4 160C158.7 160 144.4 174.3 144.4 192C144.4 209.7 158.7 224 176.4 224C194 224 208.4 209.7 208.4 192C208.4 174.3 194 160 176.4 160zM336.4 224C354 224 368.4 209.7 368.4 192C368.4 174.3 354 160 336.4 160C318.7 160 304.4 174.3 304.4 192C304.4 209.7 318.7 224 336.4 224z"})})},places:{outline:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[k("path",{d:"M6.5 12C5.122 12 4 13.121 4 14.5S5.122 17 6.5 17 9 15.879 9 14.5 7.878 12 6.5 12m0 3c-.275 0-.5-.225-.5-.5s.225-.5.5-.5.5.225.5.5-.225.5-.5.5M17.5 12c-1.378 0-2.5 1.121-2.5 2.5s1.122 2.5 2.5 2.5 2.5-1.121 2.5-2.5-1.122-2.5-2.5-2.5m0 3c-.275 0-.5-.225-.5-.5s.225-.5.5-.5.5.225.5.5-.225.5-.5.5"}),k("path",{d:"M22.482 9.494l-1.039-.346L21.4 9h.6c.552 0 1-.439 1-.992 0-.006-.003-.008-.003-.008H23c0-1-.889-2-1.984-2h-.642l-.731-1.717C19.262 3.012 18.091 2 16.764 2H7.236C5.909 2 4.738 3.012 4.357 4.283L3.626 6h-.642C1.889 6 1 7 1 8h.003S1 8.002 1 8.008C1 8.561 1.448 9 2 9h.6l-.043.148-1.039.346a2.001 2.001 0 0 0-1.359 2.097l.751 7.508a1 1 0 0 0 .994.901H3v1c0 1.103.896 2 2 2h2c1.104 0 2-.897 2-2v-1h6v1c0 1.103.896 2 2 2h2c1.104 0 2-.897 2-2v-1h1.096a.999.999 0 0 0 .994-.901l.751-7.508a2.001 2.001 0 0 0-1.359-2.097M6.273 4.857C6.402 4.43 6.788 4 7.236 4h9.527c.448 0 .834.43.963.857L19.313 9H4.688l1.585-4.143zM7 21H5v-1h2v1zm12 0h-2v-1h2v1zm2.189-3H2.811l-.662-6.607L3 11h18l.852.393L21.189 18z"})]}),solid:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:k("path",{d:"M39.61 196.8L74.8 96.29C88.27 57.78 124.6 32 165.4 32H346.6C387.4 32 423.7 57.78 437.2 96.29L472.4 196.8C495.6 206.4 512 229.3 512 256V448C512 465.7 497.7 480 480 480H448C430.3 480 416 465.7 416 448V400H96V448C96 465.7 81.67 480 64 480H32C14.33 480 0 465.7 0 448V256C0 229.3 16.36 206.4 39.61 196.8V196.8zM109.1 192H402.9L376.8 117.4C372.3 104.6 360.2 96 346.6 96H165.4C151.8 96 139.7 104.6 135.2 117.4L109.1 192zM96 256C78.33 256 64 270.3 64 288C64 305.7 78.33 320 96 320C113.7 320 128 305.7 128 288C128 270.3 113.7 256 96 256zM416 320C433.7 320 448 305.7 448 288C448 270.3 433.7 256 416 256C398.3 256 384 270.3 384 288C384 305.7 398.3 320 416 320z"})})},symbols:{outline:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:k("path",{d:"M0 0h11v2H0zM4 11h3V6h4V4H0v2h4zM15.5 17c1.381 0 2.5-1.116 2.5-2.493s-1.119-2.493-2.5-2.493S13 13.13 13 14.507 14.119 17 15.5 17m0-2.986c.276 0 .5.222.5.493 0 .272-.224.493-.5.493s-.5-.221-.5-.493.224-.493.5-.493M21.5 19.014c-1.381 0-2.5 1.116-2.5 2.493S20.119 24 21.5 24s2.5-1.116 2.5-2.493-1.119-2.493-2.5-2.493m0 2.986a.497.497 0 0 1-.5-.493c0-.271.224-.493.5-.493s.5.222.5.493a.497.497 0 0 1-.5.493M22 13l-9 9 1.513 1.5 8.99-9.009zM17 11c2.209 0 4-1.119 4-2.5V2s.985-.161 1.498.949C23.01 4.055 23 6 23 6s1-1.119 1-3.135C24-.02 21 0 21 0h-2v6.347A5.853 5.853 0 0 0 17 6c-2.209 0-4 1.119-4 2.5s1.791 2.5 4 2.5M10.297 20.482l-1.475-1.585a47.54 47.54 0 0 1-1.442 1.129c-.307-.288-.989-1.016-2.045-2.183.902-.836 1.479-1.466 1.729-1.892s.376-.871.376-1.336c0-.592-.273-1.178-.818-1.759-.546-.581-1.329-.871-2.349-.871-1.008 0-1.79.293-2.344.879-.556.587-.832 1.181-.832 1.784 0 .813.419 1.748 1.256 2.805-.847.614-1.444 1.208-1.794 1.784a3.465 3.465 0 0 0-.523 1.833c0 .857.308 1.56.924 2.107.616.549 1.423.823 2.42.823 1.173 0 2.444-.379 3.813-1.137L8.235 24h2.819l-2.09-2.383 1.333-1.135zm-6.736-6.389a1.02 1.02 0 0 1 .73-.286c.31 0 .559.085.747.254a.849.849 0 0 1 .283.659c0 .518-.419 1.112-1.257 1.784-.536-.651-.805-1.231-.805-1.742a.901.901 0 0 1 .302-.669M3.74 22c-.427 0-.778-.116-1.057-.349-.279-.232-.418-.487-.418-.766 0-.594.509-1.288 1.527-2.083.968 1.134 1.717 1.946 2.248 2.438-.921.507-1.686.76-2.3.76"})}),solid:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:k("path",{d:"M500.3 7.251C507.7 13.33 512 22.41 512 31.1V175.1C512 202.5 483.3 223.1 447.1 223.1C412.7 223.1 383.1 202.5 383.1 175.1C383.1 149.5 412.7 127.1 447.1 127.1V71.03L351.1 90.23V207.1C351.1 234.5 323.3 255.1 287.1 255.1C252.7 255.1 223.1 234.5 223.1 207.1C223.1 181.5 252.7 159.1 287.1 159.1V63.1C287.1 48.74 298.8 35.61 313.7 32.62L473.7 .6198C483.1-1.261 492.9 1.173 500.3 7.251H500.3zM74.66 303.1L86.5 286.2C92.43 277.3 102.4 271.1 113.1 271.1H174.9C185.6 271.1 195.6 277.3 201.5 286.2L213.3 303.1H239.1C266.5 303.1 287.1 325.5 287.1 351.1V463.1C287.1 490.5 266.5 511.1 239.1 511.1H47.1C21.49 511.1-.0019 490.5-.0019 463.1V351.1C-.0019 325.5 21.49 303.1 47.1 303.1H74.66zM143.1 359.1C117.5 359.1 95.1 381.5 95.1 407.1C95.1 434.5 117.5 455.1 143.1 455.1C170.5 455.1 191.1 434.5 191.1 407.1C191.1 381.5 170.5 359.1 143.1 359.1zM440.3 367.1H496C502.7 367.1 508.6 372.1 510.1 378.4C513.3 384.6 511.6 391.7 506.5 396L378.5 508C372.9 512.1 364.6 513.3 358.6 508.9C352.6 504.6 350.3 496.6 353.3 489.7L391.7 399.1H336C329.3 399.1 323.4 395.9 321 389.6C318.7 383.4 320.4 376.3 325.5 371.1L453.5 259.1C459.1 255 467.4 254.7 473.4 259.1C479.4 263.4 481.6 271.4 478.7 278.3L440.3 367.1zM116.7 219.1L19.85 119.2C-8.112 90.26-6.614 42.31 24.85 15.34C51.82-8.137 93.26-3.642 118.2 21.83L128.2 32.32L137.7 21.83C162.7-3.642 203.6-8.137 231.6 15.34C262.6 42.31 264.1 90.26 236.1 119.2L139.7 219.1C133.2 225.6 122.7 225.6 116.7 219.1H116.7z"})})}},search:{loupe:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:k("path",{d:"M12.9 14.32a8 8 0 1 1 1.41-1.41l5.35 5.33-1.42 1.42-5.33-5.34zM8 14A6 6 0 1 0 8 2a6 6 0 0 0 0 12z"})}),delete:k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:k("path",{d:"M10 8.586L2.929 1.515 1.515 2.929 8.586 10l-7.071 7.071 1.414 1.414L10 11.414l7.071 7.071 1.414-1.414L11.414 10l7.071-7.071-1.414-1.414L10 8.586z"})})}};function Zc(i){let{id:e,skin:t,emoji:n}=i;if(i.shortcodes){const a=i.shortcodes.match(ji.SHORTCODES_REGEX);a&&(e=a[1],a[2]&&(t=a[2]))}if(n||(n=ji.get(e||i.native)),!n)return i.fallback;const s=n.skins[t-1]||n.skins[0],o=s.src||(i.set!="native"&&!i.spritesheet?typeof i.getImageURL=="function"?i.getImageURL(i.set,s.unified):`https://cdn.jsdelivr.net/npm/emoji-datasource-${i.set}@15.0.1/img/${i.set}/64/${s.unified}.png`:void 0),r=typeof i.getSpritesheetURL=="function"?i.getSpritesheetURL(i.set):`https://cdn.jsdelivr.net/npm/emoji-datasource-${i.set}@15.0.1/img/${i.set}/sheets-256/64.png`;return k("span",{class:"emoji-mart-emoji","data-emoji-set":i.set,children:o?k("img",{style:{maxWidth:i.size||"1em",maxHeight:i.size||"1em",display:"inline-block"},alt:s.native||s.shortcodes,src:o}):i.set=="native"?k("span",{style:{fontSize:i.size,fontFamily:'"EmojiMart", "Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "Apple Color Emoji", "Twemoji Mozilla", "Noto Color Emoji", "Android Emoji"'},children:s.native}):k("span",{style:{display:"block",width:i.size,height:i.size,backgroundImage:`url(${r})`,backgroundSize:`${100*j.sheet.cols}% ${100*j.sheet.rows}%`,backgroundPosition:`${100/(j.sheet.cols-1)*s.x}% ${100/(j.sheet.rows-1)*s.y}%`}})})}const OO=typeof window<"u"&&window.HTMLElement?window.HTMLElement:Object;class Kb extends OO{static get observedAttributes(){return Object.keys(this.Props)}update(e={}){for(let t in e)this.attributeChangedCallback(t,null,e[t])}attributeChangedCallback(e,t,n){if(!this.component)return;const s=Gb(e,{[e]:n},this.constructor.Props,this);this.component.componentWillReceiveProps?this.component.componentWillReceiveProps({[e]:s}):(this.component.props[e]=s,this.component.forceUpdate())}disconnectedCallback(){this.disconnected=!0,this.component&&this.component.unregister&&this.component.unregister()}constructor(e={}){if(super(),this.props=e,e.parent||e.ref){let t=null;const n=e.parent||(t=e.ref&&e.ref.current);t&&(t.innerHTML=""),n&&n.appendChild(this)}}}class LO extends Kb{setShadow(){this.attachShadow({mode:"open"})}injectStyles(e){if(!e)return;const t=document.createElement("style");t.textContent=e,this.shadowRoot.insertBefore(t,this.shadowRoot.firstChild)}constructor(e,{styles:t}={}){super(e),this.setShadow(),this.injectStyles(t)}}var Zb={fallback:"",id:"",native:"",shortcodes:"",size:{value:"",transform:i=>/\D/.test(i)?i:`${i}px`},set:nn.set,skin:nn.skin};class Jb extends Kb{async connectedCallback(){const e=qb(this.props,Zb,this);e.element=this,e.ref=t=>{this.component=t},await ia(),!this.disconnected&&Nb(k(Zc,{...e}),this)}constructor(e){super(e)}}ht(Jb,"Props",Zb),typeof customElements<"u"&&!customElements.get("em-emoji")&&customElements.define("em-emoji",Jb);var Yb,Jc=[],Xb=D.__b,Qb=D.__r,e0=D.diffed,t0=D.__c,n0=D.unmount;function VO(){var i;for(Jc.sort(function(e,t){return e.__v.__b-t.__v.__b});i=Jc.pop();)if(i.__P)try{i.__H.__h.forEach(oa),i.__H.__h.forEach(Yc),i.__H.__h=[]}catch(e){i.__H.__h=[],D.__e(e,i.__v)}}D.__b=function(i){Xb&&Xb(i)},D.__r=function(i){Qb&&Qb(i);var e=i.__c.__H;e&&(e.__h.forEach(oa),e.__h.forEach(Yc),e.__h=[])},D.diffed=function(i){e0&&e0(i);var e=i.__c;e&&e.__H&&e.__H.__h.length&&(Jc.push(e)!==1&&Yb===D.requestAnimationFrame||((Yb=D.requestAnimationFrame)||function(t){var n,s=function(){clearTimeout(o),i0&&cancelAnimationFrame(n),setTimeout(t)},o=setTimeout(s,100);i0&&(n=requestAnimationFrame(s))})(VO))},D.__c=function(i,e){e.some(function(t){try{t.__h.forEach(oa),t.__h=t.__h.filter(function(n){return!n.__||Yc(n)})}catch(n){e.some(function(s){s.__h&&(s.__h=[])}),e=[],D.__e(n,t.__v)}}),t0&&t0(i,e)},D.unmount=function(i){n0&&n0(i);var e,t=i.__c;t&&t.__H&&(t.__H.__.forEach(function(n){try{oa(n)}catch(s){e=s}}),e&&D.__e(e,t.__v))};var i0=typeof requestAnimationFrame=="function";function oa(i){var e=i.__c;typeof e=="function"&&(i.__c=void 0,e())}function Yc(i){i.__c=i.__()}function DO(i,e){for(var t in e)i[t]=e[t];return i}function s0(i,e){for(var t in i)if(t!=="__source"&&!(t in e))return!0;for(var n in e)if(n!=="__source"&&i[n]!==e[n])return!0;return!1}function ra(i){this.props=i}(ra.prototype=new $t).isPureReactComponent=!0,ra.prototype.shouldComponentUpdate=function(i,e){return s0(this.props,i)||s0(this.state,e)};var o0=D.__b;D.__b=function(i){i.type&&i.type.__f&&i.ref&&(i.props.ref=i.ref,i.ref=null),o0&&o0(i)};var NO=D.__e;D.__e=function(i,e,t){if(i.then){for(var n,s=e;s=s.__;)if((n=s.__c)&&n.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),n.__c(i,e)}NO(i,e,t)};var r0=D.unmount;function Xc(){this.__u=0,this.t=null,this.__b=null}function a0(i){var e=i.__.__c;return e&&e.__e&&e.__e(i)}function aa(){this.u=null,this.o=null}D.unmount=function(i){var e=i.__c;e&&e.__R&&e.__R(),e&&i.__h===!0&&(i.type=null),r0&&r0(i)},(Xc.prototype=new $t).__c=function(i,e){var t=e.__c,n=this;n.t==null&&(n.t=[]),n.t.push(t);var s=a0(n.__v),o=!1,r=function(){o||(o=!0,t.__R=null,s?s(a):a())};t.__R=r;var a=function(){if(!--n.__u){if(n.state.__e){var c=n.state.__e;n.__v.__k[0]=function d(h,f,m){return h&&(h.__v=null,h.__k=h.__k&&h.__k.map(function(g){return d(g,f,m)}),h.__c&&h.__c.__P===f&&(h.__e&&m.insertBefore(h.__e,h.__d),h.__c.__e=!0,h.__c.__P=m)),h}(c,c.__c.__P,c.__c.__O)}var u;for(n.setState({__e:n.__b=null});u=n.t.pop();)u.forceUpdate()}},l=e.__h===!0;n.__u++||l||n.setState({__e:n.__b=n.__v.__k[0]}),i.then(r,r)},Xc.prototype.componentWillUnmount=function(){this.t=[]},Xc.prototype.render=function(i,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=function o(r,a,l){return r&&(r.__c&&r.__c.__H&&(r.__c.__H.__.forEach(function(c){typeof c.__c=="function"&&c.__c()}),r.__c.__H=null),(r=DO({},r)).__c!=null&&(r.__c.__P===l&&(r.__c.__P=a),r.__c=null),r.__k=r.__k&&r.__k.map(function(c){return o(c,a,l)})),r}(this.__b,t,n.__O=n.__P)}this.__b=null}var s=e.__e&&zc(Hi,null,i.fallback);return s&&(s.__h=null),[zc(Hi,null,e.__e?null:i.children),s]};var l0=function(i,e,t){if(++t[1]===t[0]&&i.o.delete(e),i.props.revealOrder&&(i.props.revealOrder[0]!=="t"||!i.o.size))for(t=i.u;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;i.u=t=t[2]}};(aa.prototype=new $t).__e=function(i){var e=this,t=a0(e.__v),n=e.o.get(i);return n[0]++,function(s){var o=function(){e.props.revealOrder?(n.push(s),l0(e,i,n)):s()};t?t(o):o()}},aa.prototype.render=function(i){this.u=null,this.o=new Map;var e=ta(i.children);i.revealOrder&&i.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.o.set(e[t],this.u=[1,0,this.u]);return i.children},aa.prototype.componentDidUpdate=aa.prototype.componentDidMount=function(){var i=this;this.o.forEach(function(e,t){l0(i,t,e)})};var FO=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,$O=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,UO=typeof document<"u",zO=function(i){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(i)};$t.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(i){Object.defineProperty($t.prototype,i,{configurable:!0,get:function(){return this["UNSAFE_"+i]},set:function(e){Object.defineProperty(this,i,{configurable:!0,writable:!0,value:e})}})});var c0=D.event;function HO(){}function WO(){return this.cancelBubble}function jO(){return this.defaultPrevented}D.event=function(i){return c0&&(i=c0(i)),i.persist=HO,i.isPropagationStopped=WO,i.isDefaultPrevented=jO,i.nativeEvent=i};var u0={configurable:!0,get:function(){return this.class}},d0=D.vnode;D.vnode=function(i){var e=i.type,t=i.props,n=t;if(typeof e=="string"){var s=e.indexOf("-")===-1;for(var o in n={},t){var r=t[o];UO&&o==="children"&&e==="noscript"||o==="value"&&"defaultValue"in t&&r==null||(o==="defaultValue"&&"value"in t&&t.value==null?o="value":o==="download"&&r===!0?r="":/ondoubleclick/i.test(o)?o="ondblclick":/^onchange(textarea|input)/i.test(o+e)&&!zO(t.type)?o="oninput":/^onfocus$/i.test(o)?o="onfocusin":/^onblur$/i.test(o)?o="onfocusout":/^on(Ani|Tra|Tou|BeforeInp)/.test(o)?o=o.toLowerCase():s&&$O.test(o)?o=o.replace(/[A-Z0-9]/,"-$&").toLowerCase():r===null&&(r=void 0),n[o]=r)}e=="select"&&n.multiple&&Array.isArray(n.value)&&(n.value=ta(t.children).forEach(function(a){a.props.selected=n.value.indexOf(a.props.value)!=-1})),e=="select"&&n.defaultValue!=null&&(n.value=ta(t.children).forEach(function(a){a.props.selected=n.multiple?n.defaultValue.indexOf(a.props.value)!=-1:n.defaultValue==a.props.value})),i.props=n,t.class!=t.className&&(u0.enumerable="className"in t,t.className!=null&&(n.class=t.className),Object.defineProperty(n,"className",u0))}i.$$typeof=FO,d0&&d0(i)};var h0=D.__r;D.__r=function(i){h0&&h0(i),i.__c};const qO={light:"outline",dark:"solid"};class GO extends ra{renderIcon(e){const{icon:t}=e;if(t){if(t.svg)return k("span",{class:"flex",dangerouslySetInnerHTML:{__html:t.svg}});if(t.src)return k("img",{src:t.src})}const n=sa.categories[e.id]||sa.categories.custom,s=this.props.icons=="auto"?qO[this.props.theme]:this.props.icons;return n[s]||n}render(){let e=null;return k("nav",{id:"nav",class:"padding","data-position":this.props.position,dir:this.props.dir,children:k("div",{class:"flex relative",children:[this.categories.map((t,n)=>{const s=t.name||Re.categories[t.id],o=!this.props.unfocused&&t.id==this.state.categoryId;return o&&(e=n),k("button",{"aria-label":s,"aria-selected":o||void 0,title:s,type:"button",class:"flex flex-grow flex-center",onMouseDown:r=>r.preventDefault(),onClick:()=>{this.props.onClick({category:t,i:n})},children:this.renderIcon(t)})}),k("div",{class:"bar",style:{width:`${100/this.categories.length}%`,opacity:e==null?0:1,transform:this.props.dir==="rtl"?`scaleX(-1) translateX(${e*100}%)`:`translateX(${e*100}%)`}})]})})}constructor(){super(),this.categories=j.categories.filter(e=>!e.target),this.state={categoryId:this.categories[0].id}}}class KO extends ra{shouldComponentUpdate(e){for(let t in e)if(t!="children"&&e[t]!=this.props[t])return!0;return!1}render(){return this.props.children}}const la={rowsPerRender:10};class ZO extends $t{getInitialState(e=this.props){return{skin:pn.get("skin")||e.skin,theme:this.initTheme(e.theme)}}componentWillMount(){this.dir=Re.rtl?"rtl":"ltr",this.refs={menu:tn(),navigation:tn(),scroll:tn(),search:tn(),searchInput:tn(),skinToneButton:tn(),skinToneRadio:tn()},this.initGrid(),this.props.stickySearch==!1&&this.props.searchPosition=="sticky"&&(console.warn("[EmojiMart] Deprecation warning: `stickySearch` has been renamed `searchPosition`."),this.props.searchPosition="static")}componentDidMount(){if(this.register(),this.shadowRoot=this.base.parentNode,this.props.autoFocus){const{searchInput:e}=this.refs;e.current&&e.current.focus()}}componentWillReceiveProps(e){this.nextState||(this.nextState={});for(const t in e)this.nextState[t]=e[t];clearTimeout(this.nextStateTimer),this.nextStateTimer=setTimeout(()=>{let t=!1;for(const s in this.nextState)this.props[s]=this.nextState[s],(s==="custom"||s==="categories")&&(t=!0);delete this.nextState;const n=this.getInitialState();if(t)return this.reset(n);this.setState(n)})}componentWillUnmount(){this.unregister()}async reset(e={}){await ia(this.props),this.initGrid(),this.unobserve(),this.setState(e,()=>{this.observeCategories(),this.observeRows()})}register(){document.addEventListener("click",this.handleClickOutside),this.observe()}unregister(){var e;document.removeEventListener("click",this.handleClickOutside),(e=this.darkMedia)==null||e.removeEventListener("change",this.darkMediaCallback),this.unobserve()}observe(){this.observeCategories(),this.observeRows()}unobserve({except:e=[]}={}){Array.isArray(e)||(e=[e]);for(const t of this.observers)e.includes(t)||t.disconnect();this.observers=[].concat(e)}initGrid(){const{categories:e}=j;this.refs.categories=new Map;const t=j.categories.map(s=>s.id).join(",");this.navKey&&this.navKey!=t&&this.refs.scroll.current&&(this.refs.scroll.current.scrollTop=0),this.navKey=t,this.grid=[],this.grid.setsize=0;const n=(s,o)=>{const r=[];r.__categoryId=o.id,r.__index=s.length,this.grid.push(r);const a=this.grid.length-1,l=a%la.rowsPerRender?{}:tn();return l.index=a,l.posinset=this.grid.setsize+1,s.push(l),r};for(let s of e){const o=[];let r=n(o,s);for(let a of s.emojis)r.length==this.getPerLine()&&(r=n(o,s)),this.grid.setsize+=1,r.push(a);this.refs.categories.set(s.id,{root:tn(),rows:o})}}initTheme(e){if(e!="auto")return e;if(!this.darkMedia){if(this.darkMedia=matchMedia("(prefers-color-scheme: dark)"),this.darkMedia.media.match(/^not/))return"light";this.darkMedia.addEventListener("change",this.darkMediaCallback)}return this.darkMedia.matches?"dark":"light"}initDynamicPerLine(e=this.props){if(!e.dynamicWidth)return;const{element:t,emojiButtonSize:n}=e,s=()=>{const{width:r}=t.getBoundingClientRect();return Math.floor(r/n)},o=new ResizeObserver(()=>{this.unobserve({except:o}),this.setState({perLine:s()},()=>{this.initGrid(),this.forceUpdate(()=>{this.observeCategories(),this.observeRows()})})});return o.observe(t),this.observers.push(o),s()}getPerLine(){return this.state.perLine||this.props.perLine}getEmojiByPos([e,t]){const n=this.state.searchResults||this.grid,s=n[e]&&n[e][t];if(s)return ji.get(s)}observeCategories(){const e=this.refs.navigation.current;if(!e)return;const t=new Map,n=r=>{r!=e.state.categoryId&&e.setState({categoryId:r})},s={root:this.refs.scroll.current,threshold:[0,1]},o=new IntersectionObserver(r=>{for(const l of r){const c=l.target.dataset.id;t.set(c,l.intersectionRatio)}const a=[...t];for(const[l,c]of a)if(c){n(l);break}},s);for(const{root:r}of this.refs.categories.values())o.observe(r.current);this.observers.push(o)}observeRows(){const e={...this.state.visibleRows},t=new IntersectionObserver(n=>{for(const s of n){const o=parseInt(s.target.dataset.index);s.isIntersecting?e[o]=!0:delete e[o]}this.setState({visibleRows:e})},{root:this.refs.scroll.current,rootMargin:`${this.props.emojiButtonSize*(la.rowsPerRender+5)}px 0px ${this.props.emojiButtonSize*la.rowsPerRender}px`});for(const{rows:n}of this.refs.categories.values())for(const s of n)s.current&&t.observe(s.current);this.observers.push(t)}preventDefault(e){e.preventDefault()}unfocusSearch(){const e=this.refs.searchInput.current;e&&e.blur()}navigate({e,input:t,left:n,right:s,up:o,down:r}){const a=this.state.searchResults||this.grid;if(!a.length)return;let[l,c]=this.state.pos;const u=(()=>{if(l==0&&c==0&&!e.repeat&&(n||o))return null;if(l==-1)return!e.repeat&&(s||r)&&t.selectionStart==t.value.length?[0,0]:null;if(n||s){let d=a[l];const h=n?-1:1;if(c+=h,!d[c]){if(l+=h,d=a[l],!d)return l=n?0:a.length-1,c=n?0:a[l].length-1,[l,c];c=n?d.length-1:0}return[l,c]}if(o||r){l+=o?-1:1;const d=a[l];return d?(d[c]||(c=d.length-1),[l,c]):(l=o?0:a.length-1,c=o?0:a[l].length-1,[l,c])}})();if(u)e.preventDefault();else{this.state.pos[0]>-1&&this.setState({pos:[-1,-1]});return}this.setState({pos:u,keyboard:!0},()=>{this.scrollTo({row:u[0]})})}scrollTo({categoryId:e,row:t}){const n=this.state.searchResults||this.grid;if(!n.length)return;const s=this.refs.scroll.current,o=s.getBoundingClientRect();let r=0;if(t>=0&&(e=n[t].__categoryId),e&&(r=(this.refs[e]||this.refs.categories.get(e).root).current.getBoundingClientRect().top-(o.top-s.scrollTop)+1),t>=0)if(!t)r=0;else{const a=n[t].__index,l=r+a*this.props.emojiButtonSize,c=l+this.props.emojiButtonSize+this.props.emojiButtonSize*.88;if(l<s.scrollTop)r=l;else if(c>s.scrollTop+o.height)r=c-o.height;else return}this.ignoreMouse(),s.scrollTop=r}ignoreMouse(){this.mouseIsIgnored=!0,clearTimeout(this.ignoreMouseTimer),this.ignoreMouseTimer=setTimeout(()=>{delete this.mouseIsIgnored},100)}handleEmojiOver(e){this.mouseIsIgnored||this.state.showSkins||this.setState({pos:e||[-1,-1],keyboard:!1})}handleEmojiClick({e,emoji:t,pos:n}){if(this.props.onEmojiSelect&&(!t&&n&&(t=this.getEmojiByPos(n)),t)){const s=BO(t,{skinIndex:this.state.skin-1});this.props.maxFrequentRows&&Ub.add(s,this.props),this.props.onEmojiSelect(s,e)}}closeSkins(){this.state.showSkins&&(this.setState({showSkins:null,tempSkin:null}),this.base.removeEventListener("click",this.handleBaseClick),this.base.removeEventListener("keydown",this.handleBaseKeydown))}handleSkinMouseOver(e){this.setState({tempSkin:e})}handleSkinClick(e){this.ignoreMouse(),this.closeSkins(),this.setState({skin:e,tempSkin:null}),pn.set("skin",e)}renderNav(){return k(GO,{ref:this.refs.navigation,icons:this.props.icons,theme:this.state.theme,dir:this.dir,unfocused:!!this.state.searchResults,position:this.props.navPosition,onClick:this.handleCategoryClick},this.navKey)}renderPreview(){const e=this.getEmojiByPos(this.state.pos),t=this.state.searchResults&&!this.state.searchResults.length;return k("div",{id:"preview",class:"flex flex-middle",dir:this.dir,"data-position":this.props.previewPosition,children:[k("div",{class:"flex flex-middle flex-grow",children:[k("div",{class:"flex flex-auto flex-middle flex-center",style:{height:this.props.emojiButtonSize,fontSize:this.props.emojiButtonSize},children:k(Zc,{emoji:e,id:t?this.props.noResultsEmoji||"cry":this.props.previewEmoji||(this.props.previewPosition=="top"?"point_down":"point_up"),set:this.props.set,size:this.props.emojiButtonSize,skin:this.state.tempSkin||this.state.skin,spritesheet:!0,getSpritesheetURL:this.props.getSpritesheetURL})}),k("div",{class:`margin-${this.dir[0]}`,children:e||t?k("div",{class:`padding-${this.dir[2]} align-${this.dir[0]}`,children:[k("div",{class:"preview-title ellipsis",children:e?e.name:Re.search_no_results_1}),k("div",{class:"preview-subtitle ellipsis color-c",children:e?e.skins[0].shortcodes:Re.search_no_results_2})]}):k("div",{class:"preview-placeholder color-c",children:Re.pick})})]}),!e&&this.props.skinTonePosition=="preview"&&this.renderSkinToneButton()]})}renderEmojiButton(e,{pos:t,posinset:n,grid:s}){const o=this.props.emojiButtonSize,r=this.state.tempSkin||this.state.skin,l=(e.skins[r-1]||e.skins[0]).native,c=RO(this.state.pos,t),u=t.concat(e.id).join("");return k(KO,{selected:c,skin:r,size:o,children:k("button",{"aria-label":l,"aria-selected":c||void 0,"aria-posinset":n,"aria-setsize":s.setsize,"data-keyboard":this.state.keyboard,title:this.props.previewPosition=="none"?e.name:void 0,type:"button",class:"flex flex-center flex-middle",tabindex:"-1",onClick:d=>this.handleEmojiClick({e:d,emoji:e}),onMouseEnter:()=>this.handleEmojiOver(t),onMouseLeave:()=>this.handleEmojiOver(),style:{width:this.props.emojiButtonSize,height:this.props.emojiButtonSize,fontSize:this.props.emojiSize,lineHeight:0},children:[k("div",{"aria-hidden":"true",class:"background",style:{borderRadius:this.props.emojiButtonRadius,backgroundColor:this.props.emojiButtonColors?this.props.emojiButtonColors[(n-1)%this.props.emojiButtonColors.length]:void 0}}),k(Zc,{emoji:e,set:this.props.set,size:this.props.emojiSize,skin:r,spritesheet:!0,getSpritesheetURL:this.props.getSpritesheetURL})]})},u)}renderSearch(){const e=this.props.previewPosition=="none"||this.props.skinTonePosition=="search";return k("div",{children:[k("div",{class:"spacer"}),k("div",{class:"flex flex-middle",children:[k("div",{class:"search relative flex-grow",children:[k("input",{type:"search",ref:this.refs.searchInput,placeholder:Re.search,onClick:this.handleSearchClick,onInput:this.handleSearchInput,onKeyDown:this.handleSearchKeyDown,autoComplete:"off"}),k("span",{class:"icon loupe flex",children:sa.search.loupe}),this.state.searchResults&&k("button",{title:"Clear","aria-label":"Clear",type:"button",class:"icon delete flex",onClick:this.clearSearch,onMouseDown:this.preventDefault,children:sa.search.delete})]}),e&&this.renderSkinToneButton()]})]})}renderSearchResults(){const{searchResults:e}=this.state;return e?k("div",{class:"category",ref:this.refs.search,children:[k("div",{class:`sticky padding-small align-${this.dir[0]}`,children:Re.categories.search}),k("div",{children:e.length?e.map((t,n)=>k("div",{class:"flex",children:t.map((s,o)=>this.renderEmojiButton(s,{pos:[n,o],posinset:n*this.props.perLine+o+1,grid:e}))})):k("div",{class:`padding-small align-${this.dir[0]}`,children:this.props.onAddCustomEmoji&&k("a",{onClick:this.props.onAddCustomEmoji,children:Re.add_custom})})})]}):null}renderCategories(){const{categories:e}=j,t=!!this.state.searchResults,n=this.getPerLine();return k("div",{style:{visibility:t?"hidden":void 0,display:t?"none":void 0,height:"100%"},children:e.map(s=>{const{root:o,rows:r}=this.refs.categories.get(s.id);return k("div",{"data-id":s.target?s.target.id:s.id,class:"category",ref:o,children:[k("div",{class:`sticky padding-small align-${this.dir[0]}`,children:s.name||Re.categories[s.id]}),k("div",{class:"relative",style:{height:r.length*this.props.emojiButtonSize},children:r.map((a,l)=>{const c=a.index-a.index%la.rowsPerRender,u=this.state.visibleRows[c],d="current"in a?a:void 0;if(!u&&!d)return null;const h=l*n,f=h+n,m=s.emojis.slice(h,f);return m.length<n&&m.push(...new Array(n-m.length)),k("div",{"data-index":a.index,ref:d,class:"flex row",style:{top:l*this.props.emojiButtonSize},children:u&&m.map((g,b)=>{if(!g)return k("div",{style:{width:this.props.emojiButtonSize,height:this.props.emojiButtonSize}});const _=ji.get(g);return this.renderEmojiButton(_,{pos:[a.index,b],posinset:a.posinset+b,grid:this.grid})})},a.index)})})]})})})}renderSkinToneButton(){return this.props.skinTonePosition=="none"?null:k("div",{class:"flex flex-auto flex-center flex-middle",style:{position:"relative",width:this.props.emojiButtonSize,height:this.props.emojiButtonSize},children:k("button",{type:"button",ref:this.refs.skinToneButton,class:"skin-tone-button flex flex-auto flex-center flex-middle","aria-selected":this.state.showSkins?"":void 0,"aria-label":Re.skins.choose,title:Re.skins.choose,onClick:this.openSkins,style:{width:this.props.emojiSize,height:this.props.emojiSize},children:k("span",{class:`skin-tone skin-tone-${this.state.skin}`})})})}renderLiveRegion(){const e=this.getEmojiByPos(this.state.pos),t=e?e.name:"";return k("div",{"aria-live":"polite",class:"sr-only",children:t})}renderSkins(){const t=this.refs.skinToneButton.current.getBoundingClientRect(),n=this.base.getBoundingClientRect(),s={};return this.dir=="ltr"?s.right=n.right-t.right-3:s.left=t.left-n.left-3,this.props.previewPosition=="bottom"&&this.props.skinTonePosition=="preview"?s.bottom=n.bottom-t.top+6:(s.top=t.bottom-n.top+3,s.bottom="auto"),k("div",{ref:this.refs.menu,role:"radiogroup",dir:this.dir,"aria-label":Re.skins.choose,class:"menu hidden","data-position":s.top?"top":"bottom",style:s,children:[...Array(6).keys()].map(o=>{const r=o+1,a=this.state.skin==r;return k("div",{children:[k("input",{type:"radio",name:"skin-tone",value:r,"aria-label":Re.skins[r],ref:a?this.refs.skinToneRadio:null,defaultChecked:a,onChange:()=>this.handleSkinMouseOver(r),onKeyDown:l=>{(l.code=="Enter"||l.code=="Space"||l.code=="Tab")&&(l.preventDefault(),this.handleSkinClick(r))}}),k("button",{"aria-hidden":"true",tabindex:"-1",onClick:()=>this.handleSkinClick(r),onMouseEnter:()=>this.handleSkinMouseOver(r),onMouseLeave:()=>this.handleSkinMouseOver(),class:"option flex flex-grow flex-middle",children:[k("span",{class:`skin-tone skin-tone-${r}`}),k("span",{class:"margin-small-lr",children:Re.skins[r]})]})]})})})}render(){const e=this.props.perLine*this.props.emojiButtonSize;return k("section",{id:"root",class:"flex flex-column",dir:this.dir,style:{width:this.props.dynamicWidth?"100%":`calc(${e}px + (var(--padding) + var(--sidebar-width)))`},"data-emoji-set":this.props.set,"data-theme":this.state.theme,"data-menu":this.state.showSkins?"":void 0,children:[this.props.previewPosition=="top"&&this.renderPreview(),this.props.navPosition=="top"&&this.renderNav(),this.props.searchPosition=="sticky"&&k("div",{class:"padding-lr",children:this.renderSearch()}),k("div",{ref:this.refs.scroll,class:"scroll flex-grow padding-lr",children:k("div",{style:{width:this.props.dynamicWidth?"100%":e,height:"100%"},children:[this.props.searchPosition=="static"&&this.renderSearch(),this.renderSearchResults(),this.renderCategories()]})}),this.props.navPosition=="bottom"&&this.renderNav(),this.props.previewPosition=="bottom"&&this.renderPreview(),this.state.showSkins&&this.renderSkins(),this.renderLiveRegion()]})}constructor(e){super(),ht(this,"darkMediaCallback",()=>{this.props.theme=="auto"&&this.setState({theme:this.darkMedia.matches?"dark":"light"})}),ht(this,"handleClickOutside",t=>{const{element:n}=this.props;t.target!=n&&(this.state.showSkins&&this.closeSkins(),this.props.onClickOutside&&this.props.onClickOutside(t))}),ht(this,"handleBaseClick",t=>{this.state.showSkins&&(t.target.closest(".menu")||(t.preventDefault(),t.stopImmediatePropagation(),this.closeSkins()))}),ht(this,"handleBaseKeydown",t=>{this.state.showSkins&&t.key=="Escape"&&(t.preventDefault(),t.stopImmediatePropagation(),this.closeSkins())}),ht(this,"handleSearchClick",()=>{this.getEmojiByPos(this.state.pos)&&this.setState({pos:[-1,-1]})}),ht(this,"handleSearchInput",async()=>{const t=this.refs.searchInput.current;if(!t)return;const{value:n}=t,s=await ji.search(n),o=()=>{this.refs.scroll.current&&(this.refs.scroll.current.scrollTop=0)};if(!s)return this.setState({searchResults:s,pos:[-1,-1]},o);const r=t.selectionStart==t.value.length?[0,0]:[-1,-1],a=[];a.setsize=s.length;let l=null;for(let c of s)(!a.length||l.length==this.getPerLine())&&(l=[],l.__categoryId="search",l.__index=a.length,a.push(l)),l.push(c);this.ignoreMouse(),this.setState({searchResults:a,pos:r},o)}),ht(this,"handleSearchKeyDown",t=>{const n=t.currentTarget;switch(t.stopImmediatePropagation(),t.key){case"ArrowLeft":this.navigate({e:t,input:n,left:!0});break;case"ArrowRight":this.navigate({e:t,input:n,right:!0});break;case"ArrowUp":this.navigate({e:t,input:n,up:!0});break;case"ArrowDown":this.navigate({e:t,input:n,down:!0});break;case"Enter":t.preventDefault(),this.handleEmojiClick({e:t,pos:this.state.pos});break;case"Escape":t.preventDefault(),this.state.searchResults?this.clearSearch():this.unfocusSearch();break}}),ht(this,"clearSearch",()=>{const t=this.refs.searchInput.current;t&&(t.value="",t.focus(),this.handleSearchInput())}),ht(this,"handleCategoryClick",({category:t,i:n})=>{this.scrollTo(n==0?{row:-1}:{categoryId:t.id})}),ht(this,"openSkins",t=>{const{currentTarget:n}=t,s=n.getBoundingClientRect();this.setState({showSkins:s},async()=>{await MO(2);const o=this.refs.menu.current;o&&(o.classList.remove("hidden"),this.refs.skinToneRadio.current.focus(),this.base.addEventListener("click",this.handleBaseClick,!0),this.base.addEventListener("keydown",this.handleBaseKeydown,!0))})}),this.observers=[],this.state={pos:[-1,-1],perLine:this.initDynamicPerLine(e),visibleRows:{0:!0},...this.getInitialState(e)}}}class Qc extends LO{async connectedCallback(){const e=qb(this.props,nn,this);e.element=this,e.ref=t=>{this.component=t},await ia(e),!this.disconnected&&Nb(k(ZO,{...e}),this.shadowRoot)}constructor(e){super(e,{styles:yb(f0)})}}ht(Qc,"Props",nn),typeof customElements<"u"&&!customElements.get("em-emoji-picker")&&customElements.define("em-emoji-picker",Qc);var f0={};f0=`:host {
  width: min-content;
  height: 435px;
  min-height: 230px;
  border-radius: var(--border-radius);
  box-shadow: var(--shadow);
  --border-radius: 10px;
  --category-icon-size: 18px;
  --font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;
  --font-size: 15px;
  --preview-placeholder-size: 21px;
  --preview-title-size: 1.1em;
  --preview-subtitle-size: .9em;
  --shadow-color: 0deg 0% 0%;
  --shadow: .3px .5px 2.7px hsl(var(--shadow-color) / .14), .4px .8px 1px -3.2px hsl(var(--shadow-color) / .14), 1px 2px 2.5px -4.5px hsl(var(--shadow-color) / .14);
  display: flex;
}

[data-theme="light"] {
  --em-rgb-color: var(--rgb-color, 34, 36, 39);
  --em-rgb-accent: var(--rgb-accent, 34, 102, 237);
  --em-rgb-background: var(--rgb-background, 255, 255, 255);
  --em-rgb-input: var(--rgb-input, 255, 255, 255);
  --em-color-border: var(--color-border, rgba(0, 0, 0, .05));
  --em-color-border-over: var(--color-border-over, rgba(0, 0, 0, .1));
}

[data-theme="dark"] {
  --em-rgb-color: var(--rgb-color, 222, 222, 221);
  --em-rgb-accent: var(--rgb-accent, 58, 130, 247);
  --em-rgb-background: var(--rgb-background, 21, 22, 23);
  --em-rgb-input: var(--rgb-input, 0, 0, 0);
  --em-color-border: var(--color-border, rgba(255, 255, 255, .1));
  --em-color-border-over: var(--color-border-over, rgba(255, 255, 255, .2));
}

#root {
  --color-a: rgb(var(--em-rgb-color));
  --color-b: rgba(var(--em-rgb-color), .65);
  --color-c: rgba(var(--em-rgb-color), .45);
  --padding: 12px;
  --padding-small: calc(var(--padding) / 2);
  --sidebar-width: 16px;
  --duration: 225ms;
  --duration-fast: 125ms;
  --duration-instant: 50ms;
  --easing: cubic-bezier(.4, 0, .2, 1);
  width: 100%;
  text-align: left;
  border-radius: var(--border-radius);
  background-color: rgb(var(--em-rgb-background));
  position: relative;
}

@media (prefers-reduced-motion) {
  #root {
    --duration: 0;
    --duration-fast: 0;
    --duration-instant: 0;
  }
}

#root[data-menu] button {
  cursor: auto;
}

#root[data-menu] .menu button {
  cursor: pointer;
}

:host, #root, input, button {
  color: rgb(var(--em-rgb-color));
  font-family: var(--font-family);
  font-size: var(--font-size);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  line-height: normal;
}

*, :before, :after {
  box-sizing: border-box;
  min-width: 0;
  margin: 0;
  padding: 0;
}

.relative {
  position: relative;
}

.flex {
  display: flex;
}

.flex-auto {
  flex: none;
}

.flex-center {
  justify-content: center;
}

.flex-column {
  flex-direction: column;
}

.flex-grow {
  flex: auto;
}

.flex-middle {
  align-items: center;
}

.flex-wrap {
  flex-wrap: wrap;
}

.padding {
  padding: var(--padding);
}

.padding-t {
  padding-top: var(--padding);
}

.padding-lr {
  padding-left: var(--padding);
  padding-right: var(--padding);
}

.padding-r {
  padding-right: var(--padding);
}

.padding-small {
  padding: var(--padding-small);
}

.padding-small-b {
  padding-bottom: var(--padding-small);
}

.padding-small-lr {
  padding-left: var(--padding-small);
  padding-right: var(--padding-small);
}

.margin {
  margin: var(--padding);
}

.margin-r {
  margin-right: var(--padding);
}

.margin-l {
  margin-left: var(--padding);
}

.margin-small-l {
  margin-left: var(--padding-small);
}

.margin-small-lr {
  margin-left: var(--padding-small);
  margin-right: var(--padding-small);
}

.align-l {
  text-align: left;
}

.align-r {
  text-align: right;
}

.color-a {
  color: var(--color-a);
}

.color-b {
  color: var(--color-b);
}

.color-c {
  color: var(--color-c);
}

.ellipsis {
  white-space: nowrap;
  max-width: 100%;
  width: auto;
  text-overflow: ellipsis;
  overflow: hidden;
}

.sr-only {
  width: 1px;
  height: 1px;
  position: absolute;
  top: auto;
  left: -10000px;
  overflow: hidden;
}

a {
  cursor: pointer;
  color: rgb(var(--em-rgb-accent));
}

a:hover {
  text-decoration: underline;
}

.spacer {
  height: 10px;
}

[dir="rtl"] .scroll {
  padding-left: 0;
  padding-right: var(--padding);
}

.scroll {
  padding-right: 0;
  overflow-x: hidden;
  overflow-y: auto;
}

.scroll::-webkit-scrollbar {
  width: var(--sidebar-width);
  height: var(--sidebar-width);
}

.scroll::-webkit-scrollbar-track {
  border: 0;
}

.scroll::-webkit-scrollbar-button {
  width: 0;
  height: 0;
  display: none;
}

.scroll::-webkit-scrollbar-corner {
  background-color: rgba(0, 0, 0, 0);
}

.scroll::-webkit-scrollbar-thumb {
  min-height: 20%;
  min-height: 65px;
  border: 4px solid rgb(var(--em-rgb-background));
  border-radius: 8px;
}

.scroll::-webkit-scrollbar-thumb:hover {
  background-color: var(--em-color-border-over) !important;
}

.scroll:hover::-webkit-scrollbar-thumb {
  background-color: var(--em-color-border);
}

.sticky {
  z-index: 1;
  background-color: rgba(var(--em-rgb-background), .9);
  -webkit-backdrop-filter: blur(4px);
  backdrop-filter: blur(4px);
  font-weight: 500;
  position: sticky;
  top: -1px;
}

[dir="rtl"] .search input[type="search"] {
  padding: 10px 2.2em 10px 2em;
}

[dir="rtl"] .search .loupe {
  left: auto;
  right: .7em;
}

[dir="rtl"] .search .delete {
  left: .7em;
  right: auto;
}

.search {
  z-index: 2;
  position: relative;
}

.search input, .search button {
  font-size: calc(var(--font-size)  - 1px);
}

.search input[type="search"] {
  width: 100%;
  background-color: var(--em-color-border);
  transition-duration: var(--duration);
  transition-property: background-color, box-shadow;
  transition-timing-function: var(--easing);
  border: 0;
  border-radius: 10px;
  outline: 0;
  padding: 10px 2em 10px 2.2em;
  display: block;
}

.search input[type="search"]::-ms-input-placeholder {
  color: inherit;
  opacity: .6;
}

.search input[type="search"]::placeholder {
  color: inherit;
  opacity: .6;
}

.search input[type="search"], .search input[type="search"]::-webkit-search-decoration, .search input[type="search"]::-webkit-search-cancel-button, .search input[type="search"]::-webkit-search-results-button, .search input[type="search"]::-webkit-search-results-decoration {
  -webkit-appearance: none;
  -ms-appearance: none;
  appearance: none;
}

.search input[type="search"]:focus {
  background-color: rgb(var(--em-rgb-input));
  box-shadow: inset 0 0 0 1px rgb(var(--em-rgb-accent)), 0 1px 3px rgba(65, 69, 73, .2);
}

.search .icon {
  z-index: 1;
  color: rgba(var(--em-rgb-color), .7);
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
}

.search .loupe {
  pointer-events: none;
  left: .7em;
}

.search .delete {
  right: .7em;
}

svg {
  fill: currentColor;
  width: 1em;
  height: 1em;
}

button {
  -webkit-appearance: none;
  -ms-appearance: none;
  appearance: none;
  cursor: pointer;
  color: currentColor;
  background-color: rgba(0, 0, 0, 0);
  border: 0;
}

#nav {
  z-index: 2;
  padding-top: 12px;
  padding-bottom: 12px;
  padding-right: var(--sidebar-width);
  position: relative;
}

#nav button {
  color: var(--color-b);
  transition: color var(--duration) var(--easing);
}

#nav button:hover {
  color: var(--color-a);
}

#nav svg, #nav img {
  width: var(--category-icon-size);
  height: var(--category-icon-size);
}

#nav[dir="rtl"] .bar {
  left: auto;
  right: 0;
}

#nav .bar {
  width: 100%;
  height: 3px;
  background-color: rgb(var(--em-rgb-accent));
  transition: transform var(--duration) var(--easing);
  border-radius: 3px 3px 0 0;
  position: absolute;
  bottom: -12px;
  left: 0;
}

#nav button[aria-selected] {
  color: rgb(var(--em-rgb-accent));
}

#preview {
  z-index: 2;
  padding: calc(var(--padding)  + 4px) var(--padding);
  padding-right: var(--sidebar-width);
  position: relative;
}

#preview .preview-placeholder {
  font-size: var(--preview-placeholder-size);
}

#preview .preview-title {
  font-size: var(--preview-title-size);
}

#preview .preview-subtitle {
  font-size: var(--preview-subtitle-size);
}

#nav:before, #preview:before {
  content: "";
  height: 2px;
  position: absolute;
  left: 0;
  right: 0;
}

#nav[data-position="top"]:before, #preview[data-position="top"]:before {
  background: linear-gradient(to bottom, var(--em-color-border), transparent);
  top: 100%;
}

#nav[data-position="bottom"]:before, #preview[data-position="bottom"]:before {
  background: linear-gradient(to top, var(--em-color-border), transparent);
  bottom: 100%;
}

.category:last-child {
  min-height: calc(100% + 1px);
}

.category button {
  font-family: -apple-system, BlinkMacSystemFont, Helvetica Neue, sans-serif;
  position: relative;
}

.category button > * {
  position: relative;
}

.category button .background {
  opacity: 0;
  background-color: var(--em-color-border);
  transition: opacity var(--duration-fast) var(--easing) var(--duration-instant);
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}

.category button:hover .background {
  transition-duration: var(--duration-instant);
  transition-delay: 0s;
}

.category button[aria-selected] .background {
  opacity: 1;
}

.category button[data-keyboard] .background {
  transition: none;
}

.row {
  width: 100%;
  position: absolute;
  top: 0;
  left: 0;
}

.skin-tone-button {
  border: 1px solid rgba(0, 0, 0, 0);
  border-radius: 100%;
}

.skin-tone-button:hover {
  border-color: var(--em-color-border);
}

.skin-tone-button:active .skin-tone {
  transform: scale(.85) !important;
}

.skin-tone-button .skin-tone {
  transition: transform var(--duration) var(--easing);
}

.skin-tone-button[aria-selected] {
  background-color: var(--em-color-border);
  border-top-color: rgba(0, 0, 0, .05);
  border-bottom-color: rgba(0, 0, 0, 0);
  border-left-width: 0;
  border-right-width: 0;
}

.skin-tone-button[aria-selected] .skin-tone {
  transform: scale(.9);
}

.menu {
  z-index: 2;
  white-space: nowrap;
  border: 1px solid var(--em-color-border);
  background-color: rgba(var(--em-rgb-background), .9);
  -webkit-backdrop-filter: blur(4px);
  backdrop-filter: blur(4px);
  transition-property: opacity, transform;
  transition-duration: var(--duration);
  transition-timing-function: var(--easing);
  border-radius: 10px;
  padding: 4px;
  position: absolute;
  box-shadow: 1px 1px 5px rgba(0, 0, 0, .05);
}

.menu.hidden {
  opacity: 0;
}

.menu[data-position="bottom"] {
  transform-origin: 100% 100%;
}

.menu[data-position="bottom"].hidden {
  transform: scale(.9)rotate(-3deg)translateY(5%);
}

.menu[data-position="top"] {
  transform-origin: 100% 0;
}

.menu[data-position="top"].hidden {
  transform: scale(.9)rotate(3deg)translateY(-5%);
}

.menu input[type="radio"] {
  clip: rect(0 0 0 0);
  width: 1px;
  height: 1px;
  border: 0;
  margin: 0;
  padding: 0;
  position: absolute;
  overflow: hidden;
}

.menu input[type="radio"]:checked + .option {
  box-shadow: 0 0 0 2px rgb(var(--em-rgb-accent));
}

.option {
  width: 100%;
  border-radius: 6px;
  padding: 4px 6px;
}

.option:hover {
  color: #fff;
  background-color: rgb(var(--em-rgb-accent));
}

.skin-tone {
  width: 16px;
  height: 16px;
  border-radius: 100%;
  display: inline-block;
  position: relative;
  overflow: hidden;
}

.skin-tone:after {
  content: "";
  mix-blend-mode: overlay;
  background: linear-gradient(rgba(255, 255, 255, .2), rgba(0, 0, 0, 0));
  border: 1px solid rgba(0, 0, 0, .8);
  border-radius: 100%;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  box-shadow: inset 0 -2px 3px #000, inset 0 1px 2px #fff;
}

.skin-tone-1 {
  background-color: #ffc93a;
}

.skin-tone-2 {
  background-color: #ffdab7;
}

.skin-tone-3 {
  background-color: #e7b98f;
}

.skin-tone-4 {
  background-color: #c88c61;
}

.skin-tone-5 {
  background-color: #a46134;
}

.skin-tone-6 {
  background-color: #5d4437;
}

[data-index] {
  justify-content: space-between;
}

[data-emoji-set="twitter"] .skin-tone:after {
  box-shadow: none;
  border-color: rgba(0, 0, 0, .5);
}

[data-emoji-set="twitter"] .skin-tone-1 {
  background-color: #fade72;
}

[data-emoji-set="twitter"] .skin-tone-2 {
  background-color: #f3dfd0;
}

[data-emoji-set="twitter"] .skin-tone-3 {
  background-color: #eed3a8;
}

[data-emoji-set="twitter"] .skin-tone-4 {
  background-color: #cfad8d;
}

[data-emoji-set="twitter"] .skin-tone-5 {
  background-color: #a8805d;
}

[data-emoji-set="twitter"] .skin-tone-6 {
  background-color: #765542;
}

[data-emoji-set="google"] .skin-tone:after {
  box-shadow: inset 0 0 2px 2px rgba(0, 0, 0, .4);
}

[data-emoji-set="google"] .skin-tone-1 {
  background-color: #f5c748;
}

[data-emoji-set="google"] .skin-tone-2 {
  background-color: #f1d5aa;
}

[data-emoji-set="google"] .skin-tone-3 {
  background-color: #d4b48d;
}

[data-emoji-set="google"] .skin-tone-4 {
  background-color: #aa876b;
}

[data-emoji-set="google"] .skin-tone-5 {
  background-color: #916544;
}

[data-emoji-set="google"] .skin-tone-6 {
  background-color: #61493f;
}

[data-emoji-set="facebook"] .skin-tone:after {
  border-color: rgba(0, 0, 0, .4);
  box-shadow: inset 0 -2px 3px #000, inset 0 1px 4px #fff;
}

[data-emoji-set="facebook"] .skin-tone-1 {
  background-color: #f5c748;
}

[data-emoji-set="facebook"] .skin-tone-2 {
  background-color: #f1d5aa;
}

[data-emoji-set="facebook"] .skin-tone-3 {
  background-color: #d4b48d;
}

[data-emoji-set="facebook"] .skin-tone-4 {
  background-color: #aa876b;
}

[data-emoji-set="facebook"] .skin-tone-5 {
  background-color: #916544;
}

[data-emoji-set="facebook"] .skin-tone-6 {
  background-color: #61493f;
}

`;function JO(i){return i.split(";").map(e=>e.split("=")).reduce((e,[t,n])=>(e[decodeURIComponent(t==null?void 0:t.trim())]=decodeURIComponent(n==null?void 0:n.trim()),e),{})}const m0=w.Preferences.isNativeApp()?`${window.location.origin}/`:((B0=window.dsDefaultWebappsBaseUrl)==null?void 0:B0.replace("webapps/",""))||`${window.location.origin}/`,YO=w.Preferences.isNativeApp()?`${m0}webapps/`:window.dsDefaultWebappsBaseUrl||`${m0}webapps/`,XO=((O0=JO(window.document.cookie))==null?void 0:O0.swymlang)||"en",g0=[{id:"logo-3ds-compass",name:"3DS",emojis:[{id:"logo-3ds-compass",name:"logo-3ds-compass",keywords:["3dcompass","logo-3ds-compass"],skins:[{src:`${YO}i3DXUXEmojis/assets/emojis/E335.svg`,unified:"E335",native:""}]}]}];function QO(i){return w.useFeatureManager("app.config.mobile_device").value?{onEmojiSelect:i,set:"native",custom:g0,navPosition:"bottom",previewPosition:"none",dynamicWidth:!0}:{onEmojiSelect:i,set:"native",custom:g0,navPosition:"bottom",previewPosition:"none"}}class eL extends y{insertEmoji(e){this.editor.execute("mention",{marker:":",mention:{id:`:${e.unified}`,text:e.native,value:e.native,name:e.id},text:e.native})}async init(){const{$i18n:e,promise:t}=w.useTranslations$1("detail-view"),n=w.useFeatureManager("app.config.mobile_device"),s=w.useFeatureManager("app.config.mobile_breakpoint");await t;const o=this.editor;o.config.get("emojiSuggestion.enableEmoji")&&o.ui.componentFactory.add("emoji",()=>{const r=tt(o.locale);return r.buttonView.set({label:e("Emoji"),tooltip:!0}),r.buttonView.extendTemplate({attributes:{class:["fonticon","fonticon-emoji-smile"]}}),r.buttonView.on("execute",()=>{r.buttonView.isEnabled=!0,r.buttonView.isOn=!1;const a=QO(u=>this.insertEmoji(u)),l=new Qc(a),c=r.panelView.element;c&&((o.config.get("emojiSuggestion.enableEmojiInMedia")&&!n.value||s.value)&&(c.style.width="210px",c.style.borderRadius="5px",l.injectStyles(`
               section#root {
               margin-left:0;
               max-height: 420px;
               max-width :210px;
               width:100%;
              }
               .flex.relative {
                gap: 5px; 
              }
              #nav button {
                flex-shrink: 0;
                width: 15px;
              }`)),n.value||o.config.get("emojiSuggestion.enableEmojiInMedia")&&n.value?(c.style.width="200px",c.style.borderRadius="5px",l.injectStyles(`
               section#root { 
               max-height: 400px; 
               width:100%;    
              }
               .flex.relative { 
                gap: 5px; 
                overflow-x: auto; 
                overflow-y:hidden; 
              }
              #nav button { 
                flex-shrink: 0; 
                width: 18px; 
              }`)):l.injectStyles(`
              section#root { 
                 margin-left:-200px;
                 max-height: 420px;
                 max-width: 370px;
                 box-shadow: 0px 4px 15px 0px #00000040;
                }`),c.replaceChildren(l),l.injectStyles('button[title="logo-3ds-compass"] .emoji-mart-emoji { width: 100%; }'))}),r})}}class tL extends y{static get pluginName(){return"UrlPreviewHelperEditing"}init(){this._defineDefaultActionButton()}_defineDefaultActionButton(){const e=this.editor.conversion;this.editor.model.schema.register("urlPreviewActionButton",{isLimit:!0,allowIn:["$root","externalUrlPreview","internalUrlPreview"]}),e.for("downcast").elementToElement({model:"urlPreviewActionButton",view:(n,{writer:s})=>s.createContainerElement("span",{class:"url-preview-link-action-button fonticon fonticon-wrong"}),converterPriority:"high"}),e.for("upcast").elementToElement({view:{name:"span",classes:"url-preview-link-action-button"},model:(n,{writer:s})=>s.createElement("urlPreviewActionButton"),converterPriority:"high"})}}const nL="/api/exalead/searchstats";async function iL(i){var e;try{const t=(e=i==null?void 0:i.community_id)==null?void 0:e.split(":").pop();return(await w.swymFetch.post(nL,{json:{params:{community_id:t||null,content_type:i!=null&&i.content_type?[i.content_type]:null}}}).json()).limitedResults}catch(t){return w.logger.error(t),!1}}async function p0(i){return w.cacheDecorator(`search-stats-${(i==null?void 0:i.community_id)||"whatsnew"}-${(i==null?void 0:i.content_type)||"all"}`,()=>iL(i),30*1e3)}var ca=(i=>(i.DESC="desc",i))(ca||{}),lo=(i=>(i.UPDATE="ds6w_58_lastcontributed",i.CREATION="ds6w_58_created",i))(lo||{});const Xn={post:"posts",media:"media",question:"iquestion",idea:"idea",wiki:"wikitree",survey:"survey",wedo:"wedo","social-event":"conference"};function sL(i,e){const t=[],n=[],s=[],o=[],r=[],a=[],l=[],c=[],u=h=>`id:"${h}"`,d=[];return i.forEach((h,f)=>{h===w.IContentModel.Post?t.push(u(e[f])):h===w.IContentModel.Idea?o.push(u(e[f])):h===w.IContentModel.Media?n.push(u(e[f])):h===w.IContentModel.Question?s.push(u(e[f])):h===w.IContentModel.Survey?a.push(u(e[f])):h===w.IContentModel.Wedo?l.push(u(e[f])):h===w.IContentModel.Wiki?r.push(u(e[f])):h==="social-event"&&c.push(u(w.getIdFromSubjectUri(e[f])))}),i.length&&e.length&&(t.length&&d.push(`(type:${Xn.post} AND (${t.join(" OR ")}))`),n.length&&d.push(`(type:${Xn.media} AND (${n.join(" OR ")}))`),s.length&&d.push(`(type:${Xn.question} AND (${s.join(" OR ")}))`),o.length&&d.push(`(type:${Xn.idea} AND (${o.join(" OR ")}))`),r.length&&d.push(`(type:${Xn.wiki} AND (${r.join(" OR ")}))`),a.length&&d.push(`(type:${Xn.survey} AND (${a.join(" OR ")}))`),l.length&&d.push(`(${l.join(" OR ")})`),l.length&&d.push(`(type:${Xn["social-event"]} AND (${l.join(" OR ")}))`)),d.join(" OR ")}function oL(i){return w.cacheDecorator(`exalead-search-id-${i.id}`,()=>w.swymFetch.post("/api/exalead/search",{json:{params:{legacyFormat:!1,query:`id:"${i.id}"`,nresults:1,start:0,with_synthesis:!1,...i!=null&&i.derivedTypeId?{derived_type_id:i==null?void 0:i.derivedTypeId}:void 0,...i!=null&&i.contentType?{contentType:i==null?void 0:i.contentType}:void 0}}}).json().then(w.contentsParser).then(e=>e[0]),1e4)}function rL(i){return w.cacheDecorator(i,()=>w.swymFetch.post("/api/exalead/search",{json:{params:{legacyFormat:!1,query:i,select_predicate:["ds6w:label","ds6w:type","ds6w:resourceUid","id","ds6w:community","community_type","ds6w:containerUid","ds6w:docType","ds6w:typeId","ds6w:kind","ds6w:typeFontIcon","ds6w:typeColor","enhanced_summary","swym_source","media_type","username","user_firstname","user_lastname"],nresults:50,start:0,with_synthesis:!1}}}).json().then(w.contentsParser),1e4)}const aL=w.mutualizerDecorator({fetch:rL,merge:i=>sL(i.map(e=>e.contentType),i.map(e=>e.id)),resolve:([i,[e,t]])=>t(i.find(n=>n.id===e.id)),options:{limit:50}});function eu(i){return i.derivedTypeId?oL(i):aL(i)}function lL(){const i=[w.IContentModel.Post,w.IContentModel.Wedo,w.IContentModel.Conference,w.IContentModel.Survey,w.IContentModel.Wiki,w.IContentModel.Media,w.IContentModel.Idea,w.IContentModel.Wedo,w.IContentModel.Question],e={[w.IContentModel.Post]:["posts",w.contentsParser,w.API.Post.Exalead.Content],[w.IContentModel.Media]:["media",w.contentsParser,w.API.Media.Exalead.Content],[w.IContentModel.Idea]:["idea",w.contentsParser,w.API.Idea.Exalead.Content],[w.IContentModel.Question]:["iquestion",w.contentsParser,w.API.Question.Exalead.Content],[w.IContentModel.Wiki]:["wikitree",w.contentsParser,w.API.Wiki.Exalead.Content],[w.IContentModel.Wedo]:["wedo",w.contentsParser,w.API.Wedo.Exalead.Content],[w.IContentModel.Survey]:["survey",w.contentsParser,w.API.Survey.Exalead.Content],[w.IContentModel.Conference]:["conference",w.contentsParser,w.API.Conference.Exalead.Content]};return i.reduce((n,s)=>{const[o,r,a]=e[s];return n[s]=cL({contentType:o,parser:r,api:a}),n},{})}lL();function cL({contentType:i,parser:e,api:t}){return{async count(n){const s=await w.swymFetch.post(t,{json:{params:{legacyFormat:!1,...i?{contentType:i}:{},query:"#all",with_synthesis:!0,order_by:ca.DESC,order_field:lo.UPDATE,start:0,nresults:0,...n}}}).json();return{data:[],total:s.nhits}},async getAll(n){var l,c;const o=ca.DESC,r=15;if(n&&n.community_id&&(!n.query||n.query==="#all")&&!((l=n.refine)!=null&&l.length)&&await p0({community_id:n.community_id,content_type:n.content_type||i})){const d=new Date;d.setFullYear(d.getFullYear()-1);const h=d.toISOString();n.query=`[ds6w:modified]>="${h}"`}const a=await w.swymFetch.post(t,{json:{params:{legacyFormat:!1,nresults:r,order_by:o,order_field:lo.UPDATE,query:"#all",start:0,with_synthesis:!!((c=n==null?void 0:n.refine)!=null&&c.length),...i?{contentType:i}:{},...n}}}).json();return{total:a.nhits,groups:a.groups,data:e(a)}},async getRawData(n={}){var o;if(n.community_id&&(!n.query||n.query==="#all")&&n.order_field===lo.UPDATE&&!((o=n.refine)!=null&&o.length)&&await p0({community_id:n.community_id,content_type:n.content_type||i})){const a=new Date;a.setFullYear(a.getFullYear()-1);const l=a.toISOString();n.query=`[ds6w:modified]>="${l}"`}const s=await w.swymFetch.post(t,{json:{params:{legacyFormat:!1,...i?{contentType:i}:{},query:"#all",with_synthesis:!0,order_by:ca.DESC,order_field:lo.UPDATE,...n,start:0,nresults:0}}}).json();return{groups:s.groups,hits:s.hits,total:s.nhits}}}}async function uL(i="",{contentId:e,contentModel:t}={}){let n=null;if(i&&(co(i)||await w0(i))){const{contentId:h,derivedTypeId:f,contentType:m}=Gi(i);h&&(n=await eu({id:h,derivedTypeId:f||void 0,contentType:m}))}if(!n&&e&&(n=await eu({id:e,contentType:t})),!n)throw new Error("Not a valid internal URL / Content");let s="";if(n.enhanced_summary){const h=document.createElement("div");h.innerHTML=n.enhanced_summary,s=h.textContent||""}const o=n.title,r=`${n.author.first_name} ${n.author.last_name}`,a=n.preview_url,l=`By ${r}`,c=n.model,u=n.media_type,d=n.derived_type;return{description:s,title:o,author:r,image:a,url:i,details:l,type:c,subType:u,derivedTypeData:d,content:n}}function tu(i){try{const e=new URL(i);return!/3dexperience\.3ds\.com|3dx-staging.3ds.com$/.test(e.hostname)}catch{return!1}}async function dL(i){try{const e=await(await w.getServiceUrl(w.SERVICE.DASHBOARD)).split(":443")[0],t=new URL(i),n=new URL(e);return t.hostname===n.hostname}catch{return!1}}function b0(i){const{contentId:e}=Gi(i);return!!e}async function hL(i){try{const{hash:e}=new URL(i),n=/#notification:(.*)/g.exec(e),s=await dL(i);if(n!=null&&n.length&&s)return n[1]}catch{}}function nu(i){const e=["www.youtube.com","youtube.com","youtu.be"];if(!i)return!1;try{const t=new URL(i);return tu(i)&&e.includes(t.hostname)}catch{return!1}}function ua(i){let e,t;if(i!=null&&i.types.includes("text/html")){const n=document.createElement("div");if(n.innerHTML=i.getData("text/html"),n.querySelector("img,figure"))return{};const s=n.querySelector("a");e=s==null?void 0:s.getAttribute("href"),t=(s==null?void 0:s.getAttribute("title"))||(s==null?void 0:s.textContent),n.textContent!==e&&n.textContent!==t&&(e=t=void 0)}if(!e&&(i!=null&&i.types.includes("text/plain"))){const n=i.getData("text/plain").match(/https?:\/\/\S+/g);if((n==null?void 0:n.length)===1&&i.getData("text/plain")===n[0])e=n[0];else return{}}if(!e&&(i!=null&&i.types.includes("text/html"))){const n=document.createElement("div");n.innerHTML=i.getData("text/html"),e=n.textContent}return e?{link:e,text:t}:{}}async function w0(i){try{const e=await(await w.getServiceUrl(w.SERVICE.DASHBOARD)).split(":443")[0],t=new URL(i),n=new URL(e);return t.hostname===n.hostname&&i.includes("#app:X3DMCTY_AP")}catch{return!1}}function co(i){if(!i)return!1;try{const e=new URL(i),t=new URL(w.getSwymUrl());return e.hostname===t.hostname}catch{return!1}}function qi(i){if(!i)return!1;try{return!!new URL(i)}catch{return!1}}function Gi(i){let e,t,n;if(i.includes("#community:")||i.includes("#dm:"))[e,n,t]=gL(i);else if(i.includes("#app:"))[e,n]=pL(i);else{const s=fL(i);e=s.contentId,t=s.derivedTypeId,n=s.contentType}return{contentId:e,derivedTypeId:t,contentType:n}}function fL(i){const e=new URL(i),t=e.searchParams.get("media")||e.searchParams.get("content")||"",n=e.searchParams.get("derivedTypeId")||void 0,o=(t&&t.split(":")||[]).pop()||"",r=w.getContentModelFromSubjectUri(t);return{contentId:o,derivedTypeId:n,contentType:r}}const _0=["post","idea"],mL=_0.concat(["iquestion","wiki","media","survey","wedo"]);function gL(i){let e,t,n=w.IContentModel.Post;for(const s of mL)if(i.includes(s)){let o=i.match(new RegExp(`${s}:([^/]{0,})`,"i"));if(!o&&_0.includes(s)){o=i.match(new RegExp(`dt-${s}-(?:[^/]{0,}):([^/]{0,})`,"i"));const r=i.match(new RegExp(`dt-${s}-([^/]{0,}):(?:[^/]{0,})`,"i"));t=r?r[1]:void 0}if(e=o&&o[1],n=s,e)break}return[e,n,t]}function pL(i){var n,s;const e=(n=i.match(/contentType=([^&]*)/i))==null?void 0:n[1];return[(s=i.match(/contentId=([^&]*)/i))==null?void 0:s[1],e]}async function v0(i){var e;try{const t=await w.swymFetch.get("/uwp/api/proxy/ajax",{searchParams:{type:"text",method:"GET",url:i},handlePassportExpiredError:!1});if(t.status===200){const n=await t.text(),o=new DOMParser().parseFromString(n,"text/html"),r=o.querySelectorAll('meta[property^="og:"]'),a={};for(const c of r){const u=((e=c.getAttribute("property"))==null?void 0:e.replace("og:",""))??"";a[u]=c.getAttribute("content")}(a.title||o.title)&&(a.title=a.title||o.title);const l=o.querySelector('meta[name="description"]');return(a.description||l!=null&&l.getAttribute("content"))&&(a.description=a.description||(l==null?void 0:l.getAttribute("content"))),a.url=a.url||i,a}else return{}}catch{return{}}}async function bL(i){try{const e=await w.swymFetch.get("/uwp/api/proxy/ajax",{searchParams:{type:"json",method:"GET",url:`https://www.youtube.com/oembed?url=${i}&format=json`}});if(e.status===200){const t=await e.json(),n=document.createElement("div");n.innerHTML=t.html;const s=n.firstElementChild;return{...t,src:s==null?void 0:s.getAttribute("src"),height:280,width:500}}else return{}}catch{return{}}}class wL extends R{_buildList({selectedItem:e,itemClickCallback:t,dropdownItemList:n}){const s=this.bindTemplate;return n.map(({title:o,icon:r,name:a})=>new Ue({tag:"li",attributes:{class:["ck","ck-url-option-list-item",...e===a?["active"]:[]]},children:[new Ue({tag:"span",attributes:{class:["ck-url-option-list-item-icon","fonticon",`fonticon-${r}`]}}),o],on:{click:s.to(()=>t(a))}}))}constructor(e){const{locale:t,selectedItem:n,itemClickCallback:s,clickOutsideHandler:o,dropdownItemList:r}=e;super(t),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-url-options-list","ck-reset_all-excluded"],tabindex:"-1",style:{"list-style-type":"none"}},children:this._buildList({selectedItem:n,itemClickCallback:s,dropdownItemList:r})}),this._clickOutsideHandler=o}render(){super.render(),Vn({emitter:this,activator:()=>!0,contextElements:this.element?[this.element]:[],callback:()=>this._clickOutsideHandler()})}}class _L extends ee(y){constructor(){super(...arguments),this._contextualMenuTooltipNLS="Menu"}static get pluginName(){return"UrlPreviewHelperUI"}async init(){this.isEnabled=!1,this.on("change:isEnabled",(n,s,o)=>{s==="isEnabled"&&o&&(this._overrideActionButton(),this._balloon=this.editor.plugins.get(Ot),this._paste(),this._click())});const{$i18n:e,promise:t}=w.useTranslations$1("url-previews");await t,this._contextualMenuTooltipNLS=e("menu")}_switchUI(e,t){this._hideDropdownMenuUI();const n=t.getAttribute("metas"),s=this.editor;if(!(this._getCurrentPreviewUI(t)===e||!n))switch(e){case"remove":s.model.change(r=>r.remove(t));break;default:this.fire("urlPreviewUISwitch",{newPreviewUI:e,metaData:n,modelElement:t});break}}_getCurrentPreviewUI(e){return e.getAttribute("preview-ui")}async _showDropdownMenuUI(e,t){var c;e.classList.add("active");const{$i18n:n,promise:s}=w.useTranslations$1("url-previews");await s;const o=t.name==="platformObjectPreview",r=t.getAttribute("metas"),a=Object.values(w.IContentModel).includes(r.type)&&r.type!==w.IContentModel.Media,l=[...o&&!a?[{name:w.URLPreviewUI.THUMBNAIL,title:n("thumbnail"),icon:"view-small-thb"}]:[],{name:w.URLPreviewUI.TILE,title:n("tile"),icon:"view-small-tile"},{name:w.URLPreviewUI.TITLE,title:n("title"),icon:"list"},...t.hasAttribute("href")?[{name:w.URLPreviewUI.LINK,title:n("link"),icon:"link"}]:[],{name:"remove",title:n("remove"),icon:"trash"}];this._menu=new wL({locale:this.editor.locale,selectedItem:this._getCurrentPreviewUI(t),dropdownItemList:l,itemClickCallback:u=>{e.classList.remove("active"),this._switchUI(u,t)},clickOutsideHandler:()=>{e.classList.remove("active"),this._hideDropdownMenuUI()}}),(c=this._balloon)==null||c.add({view:this._menu,position:{target:e,fitInViewport:!0,positions:[(u,d)=>({top:d.height+u.bottom>document.documentElement.clientHeight?u.top-d.height:u.bottom,left:Math.max(u.left+u.width-d.width,0),name:"bottomLeft",config:{withArrow:!1}})]}})}_hideDropdownMenuUI(){var e,t;(e=this._balloon)==null||e.remove(this._menu),(t=this._menu)==null||t.destroy()}_paste(){const e=this.editor,t=new Ye(e.editing.view.document);e.plugins.get("ClipboardPipeline").on("inputTransformation",(n,s)=>{const{link:o}=ua(s.dataTransfer);if(!(o&&qi(o)))return;(tu(o)&&!nu(o)||co(o)&&b0(o))&&(s.content=t.createDocumentFragment())})}_click(){const e=this.editor;e.listenTo(e.editing.view.document,"click",(t,n)=>{const s=n.target,o=e.editing.mapper.toModelElement(s);if(!o)return;const r=o.getAncestors(),a=["externalUrlPreview","internalUrlPreview","platformObjectPreview"],l=r.find(u=>a.includes(u.name));o.name==="urlPreviewActionButton"&&(this.isEnabled?this._showDropdownMenuUI(n.domTarget,l):e.model.change(u=>{u.remove(l)}))})}_overrideActionButton(){const e=this.editor.conversion,t=this.editor;e.for("dataDowncast").elementToElement({model:"urlPreviewActionButton",view:(s,{writer:o})=>o.createText(""),converterPriority:"highest"}),e.for("editingDowncast").elementToElement({model:"urlPreviewActionButton",view:(s,{writer:o})=>o.createContainerElement("span",{class:"url-preview-link-action-button fonticon-clickable fonticon fonticon-chevron-down","data-cke-tooltip-text":this._contextualMenuTooltipNLS,"data-cke-tooltip-position":"n"}),converterPriority:"highest"});const n=t.model.document.getRoot();if(n){const s=t.model.createRangeIn(n);for(const o of s.getWalker())o.item.name==="urlPreviewActionButton"&&t.editing.reconvertItem(o.item)}}}class vL extends y{static get pluginName(){return"UrlPreviewHelper"}static get requires(){return[tL,_L]}}const y0={defineUrlPreview(i){i.register("externalUrlPreview",{isObject:!0,allowWhere:"$inlineObject",allowAttributes:["href","prefs","metas","preview-ui"]})},defineUrlPreviewThumbnail(i){i.register("externalUrlPreviewThumbnail",{isLimit:!0,allowIn:"externalUrlPreview",allowContentOf:"$root"})},defineUrlPreviewContent(i){i.register("externalUrlPreviewContent",{isLimit:!0,allowIn:"externalUrlPreview",allowContentOf:"$root"})},defineUrlPreviewTitle(i){i.register("externalUrlPreviewTitle",{isLimit:!0,allowIn:"externalUrlPreviewContent",allowContentOf:"$block"})},defineUrlPreviewDescription(i){i.register("externalUrlPreviewDescription",{isLimit:!0,allowIn:"externalUrlPreviewContent",allowContentOf:"$block"})},defineUrlPreviewImage(i){i.register("externalUrlPreviewImage",{isLimit:!0,allowIn:"externalUrlPreviewThumbnail",allowContentOf:"$block",allowAttributes:"src"})},defineUrlPreviewIcon(i){i.register("externalUrlPreviewIcon",{isLimit:!0,allowIn:["externalUrlPreview","externalUrlPreviewContent"],allowContentOf:"$block"})},defineUrlPreviewText(i){i.register("externalUrlPreviewText",{isLimit:!0,allowIn:"externalUrlPreview",allowContentOf:"$block"})}},C0={defineUrlPreview(i){i.for("editingDowncast").elementToElement({model:"externalUrlPreview",view:(e,{writer:t})=>t.createContainerElement("div")}),i.for("dataDowncast").elementToElement({model:"externalUrlPreview",view:(e,{writer:t})=>{const n=e.getAttribute("preview-ui"),s="link-preview external-preview-link",o=n===w.URLPreviewUI.TITLE?`${s} title-preview`:s;return t.createContainerElement("div",{"data-url":e.getAttribute("href"),class:o,"data-prefs":e.getAttribute("prefs"),contenteditable:!1,"data-metas":e.getAttribute("metas"),"data-preview-ui":e.getAttribute("preview-ui")})},converterPriority:"high"}),i.for("upcast").elementToElement({view:{name:"div",classes:"external-preview-link"},model:(e,{writer:t})=>{const n=e.hasClass("external-preview-link","title-preview")?w.URLPreviewUI.TITLE:w.URLPreviewUI.TILE;return t.createElement("externalUrlPreview",{href:e.getAttribute("data-url"),prefs:e.getAttribute("data-prefs"),metas:e.getAttribute("data-metas"),"preview-ui":n})},converterPriority:"high"})},defineUrlPreviewThumbnail(i){i.elementToElement({model:"externalUrlPreviewThumbnail",view:{name:"div",classes:"external-preview-link-thumbnail"}})},defineUrlPreviewContent(i){i.elementToElement({model:"externalUrlPreviewContent",view:{name:"div",classes:"external-preview-link-content"}})},defineUrlPreviewTitle(i){i.elementToElement({model:"externalUrlPreviewTitle",view:{name:"h2",classes:"external-preview-link-heading"},converterPriority:"high"})},defineUrlPreviewDescription(i){i.elementToElement({model:"externalUrlPreviewDescription",view:{name:"p",classes:"external-preview-link-description"},converterPriority:"high"})},defineUrlPreviewImage(i){i.for("downcast").elementToElement({model:"externalUrlPreviewImage",view:(e,{writer:t})=>t.createContainerElement("img",{src:e.getAttribute("src"),class:"external-preview-link-image"}),converterPriority:"high"}),i.for("upcast").elementToElement({view:{name:"img",classes:"external-preview-link-image"},model:(e,{writer:t})=>t.createElement("externalUrlPreviewImage",{src:e.getAttribute("src")}),converterPriority:"high"})},defineUrlPreviewIcon(i){i.elementToElement({model:"externalUrlPreviewIcon",view:{name:"span",classes:["external-preview-icon","fonticon","fonticon-link"]},converterPriority:"high"})},defineUrlPreviewText(i){i.elementToElement({model:"externalUrlPreviewText",view:{name:"span",classes:"external-preview-link-text"},converterPriority:"high"})}};class yL extends y{static get pluginName(){return"ExternalSwymPreviewEditing"}init(){this._defineSchema(),this._defineConverters()}_defineSchema(){const e=this.editor.model.schema;Object.keys(y0).forEach(t=>y0[t](e))}_defineConverters(){const e=this.editor.conversion;Object.keys(C0).forEach(t=>C0[t](e))}}const k0="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='150'%20height='86'%20viewBox='0%200%20150%2086'%3e%3cg%20id='Groupe_3410'%20data-name='Groupe%203410'%20transform='translate(-10%20-10)'%3e%3crect%20id='Capture_d_écran_2024-07-04_à_11.50.36'%20data-name='Capture%20d’écran%202024-07-04%20à%2011.50.36'%20width='150'%20height='86'%20rx='5'%20transform='translate(10%2010)'%20fill='%23d5e8f2'/%3e%3cpath%20id='Tracé_1426'%20data-name='Tracé%201426'%20d='M1.339-3.592a9.293,9.293,0,0,1-4.49-1.159A8.69,8.69,0,0,1-6.563-8.1L-3.1-11.559A4.416,4.416,0,0,0-1.437-9.078a4.518,4.518,0,0,0,2.743.914A4.2,4.2,0,0,0,2.939-8.49a3.846,3.846,0,0,0,.376-.147,2.922,2.922,0,0,0,.359-.2q.18-.114.392-.278a5.45,5.45,0,0,0,.506-.457l5.551-5.518a4.7,4.7,0,0,0,.98-1.5,4.448,4.448,0,0,0,.327-1.665,4.657,4.657,0,0,0-.327-1.714,4.644,4.644,0,0,0-.914-1.469,4.487,4.487,0,0,0-1.437-1.029,4.466,4.466,0,0,0-1.894-.392,4.521,4.521,0,0,0-1.273.163,3.89,3.89,0,0,0-1.012.457,6.342,6.342,0,0,0-.865.669q-.408.376-.833.8a11.741,11.741,0,0,0-4.212-.784,12.889,12.889,0,0,0-1.6.1l3.331-3.3A9.194,9.194,0,0,1,3.314-26.71a8.925,8.925,0,0,1,3.543-.718,8.744,8.744,0,0,1,3.739.784,9.221,9.221,0,0,1,2.873,2.057,9.374,9.374,0,0,1,1.861,2.939A9.114,9.114,0,0,1,16-18.22a9.02,9.02,0,0,1-.653,3.347A9.008,9.008,0,0,1,13.29-11.82q-1.535,1.535-2.6,2.612T8.865-7.38Q8.1-6.629,7.592-6.139a10.389,10.389,0,0,1-.914.8,6.992,6.992,0,0,1-.784.522q-.376.212-.865.441A9.138,9.138,0,0,1,1.339-3.592ZM-16-4.637a9.065,9.065,0,0,1,.653-3.331,8.963,8.963,0,0,1,2.057-3.069q1.535-1.535,2.6-2.612t1.829-1.829q.767-.751,1.273-1.241a10.389,10.389,0,0,1,.914-.8,6.991,6.991,0,0,1,.784-.522q.376-.212.865-.441a8.988,8.988,0,0,1,3.69-.784,9.293,9.293,0,0,1,4.49,1.159,8.69,8.69,0,0,1,3.412,3.347L3.1-11.3A4.416,4.416,0,0,0,1.437-13.78a4.518,4.518,0,0,0-2.743-.914,3.993,3.993,0,0,0-.816.082,5.282,5.282,0,0,0-.816.245,3.925,3.925,0,0,0-1,.555A17.021,17.021,0,0,0-5.29-12.6l-4.833,4.833a4.7,4.7,0,0,0-.98,1.5A4.448,4.448,0,0,0-11.429-4.6,4.656,4.656,0,0,0-11.1-2.89a4.644,4.644,0,0,0,.914,1.469A4.487,4.487,0,0,0-8.751-.392,4.466,4.466,0,0,0-6.857,0,4.52,4.52,0,0,0-5.584-.163,3.89,3.89,0,0,0-4.571-.62a6.342,6.342,0,0,0,.865-.669q.408-.376.833-.8a10.084,10.084,0,0,0,2.09.6,12.316,12.316,0,0,0,2.09.18,13.161,13.161,0,0,0,1.633-.1l-3.331,3.3A8.727,8.727,0,0,1-3.314,3.869a9.1,9.1,0,0,1-3.543.7A8.744,8.744,0,0,1-10.6,3.788a9.221,9.221,0,0,1-2.873-2.057,9.374,9.374,0,0,1-1.861-2.939A9.114,9.114,0,0,1-16-4.637Z'%20transform='translate(80%2064)'%20fill='%23368ec4'/%3e%3c/g%3e%3c/svg%3e",Ut={getContainerElement(i,e){const{href:t,writer:n,urlMetaData:s,prefs:o}=i;return n.createElement("externalUrlPreview",{href:t,prefs:o,metas:JSON.stringify(s),"preview-ui":e||w.URLPreviewUI.TILE})},getUrlPreviewTitle(i){const{writer:e,urlMetaData:t}=i,n=e.createElement("externalUrlPreviewTitle");return e.append(e.createText(t.title||""),n),n},getTextElement(i){const{writer:e,urlMetaData:t}=i,n=e.createElement("externalUrlPreviewText");return e.append(e.createText(t.title||""),n),n},getUrlPreviewDescription(i){const{writer:e,urlMetaData:t}=i,n=e.createElement("externalUrlPreviewDescription");return e.append(e.createText(t.description||""),n),n},getUrlPreviewThumbnail(i){const{writer:e,urlMetaData:t}=i,n=e.createElement("externalUrlPreviewThumbnail"),s=e.createElement("externalUrlPreviewImage",{src:t.image});return e.append(s,n),n},recreatePreviewElement(i,e){const{href:t,urlMetaData:n,prefs:s}=e,o=i.getAttribute("preview-ui");i._setAttributesTo({href:t,prefs:s,metas:JSON.stringify(n),"preview-ui":o}),i._removeChildren(0,i.childCount),o===w.URLPreviewUI.TILE?this.createTilePreviewBody(i,e):this.createTitlePreviewBody(i,e)},createTitlePreviewBody(i,e){const{writer:t}=e,n=t.createElement("externalUrlPreviewIcon"),s=t.createElement("urlPreviewActionButton"),o=Ut.getTextElement(e);t.append(n,i),t.append(o,i),t.append(s,i)},createTilePreviewBody(i,e){const{writer:t,urlMetaData:n}=e;if(n.image){const c=Ut.getUrlPreviewThumbnail(e);t.append(c,i)}const s=t.createElement("externalUrlPreviewContent"),o=t.createElement("urlPreviewActionButton"),r=t.createElement("externalUrlPreviewIcon"),a=Ut.getUrlPreviewTitle(e),l=Ut.getUrlPreviewDescription(e);t.append(o,s),t.append(r,s),t.append(a,s),t.append(l,s),t.append(s,i)}};class CL extends y{static get pluginName(){return"ExternalSwymPreviewUI"}init(){this.isEnabled=!1,this._defineConverters(),this.on("change:isEnabled",(e,t,n)=>{t==="isEnabled"&&n&&(this._onPaste(),this._onUISwitch())}),this._onClick()}async _generateEnhancedInitialPreview(e){const t=this.editor;let n;t.model.change(async s=>{const o={href:e,writer:s,urlMetaData:{title:e,image:k0},prefs:0};n=Ut.getContainerElement(o),Ut.createTilePreviewBody(n,o),t.model.insertContent(n);const r=s.createElement("paragraph");s.insert(r,n,"after"),s.setSelection(r,"in");try{const a=await v0(e);if(!["url","title"].every(c=>Object.keys(a).includes(c)))throw new Error("Insufficient data");t.model.enqueueChange({isUndoable:!1},c=>{Ut.recreatePreviewElement(n,{href:e,writer:c,urlMetaData:a,prefs:0}),this.editor.editing.reconvertItem(n)}),t.editing.view.scrollToTheSelection()}catch{}})}async _generateOldInitialPreview(e){const t=this.editor;try{const n=await v0(e);if(!["url","title"].every(o=>Object.keys(n).includes(o)))throw new Error("Insufficient data");t.model.change(o=>{const r={href:e,urlMetaData:n,writer:o,prefs:0},a=Ut.getContainerElement(r);Ut.createTilePreviewBody(a,r),t.model.insertContent(a);const l=o.createElement("paragraph");o.insert(l,a,"after"),o.setSelection(l,"in")}),t.editing.view.scrollToTheSelection()}catch{}}_onUISwitch(){const e=this.editor;e.plugins.has("UrlPreviewHelper")&&e.plugins.get("UrlPreviewHelperUI").on("urlPreviewUISwitch",(n,{newPreviewUI:s,modelElement:o,metaData:r})=>{const a=o.getAttribute("href");o.name==="externalUrlPreview"&&e.model.change(l=>{const c=o.getAttribute("href");if(s===w.URLPreviewUI.LINK&&c){l.remove(o);const u=c,d=l.createText(u,{linkHref:u});e.model.insertContent(d)}else try{const u=JSON.parse(r),d={href:a,writer:l,urlMetaData:u,prefs:0};o._setAttribute("preview-ui",s),Ut.recreatePreviewElement(o,d),this.editor.editing.reconvertItem(o)}catch{}})})}async _isInValidExternalUrl(e){return!qi(e)||co(e)||tu(e)&&!!await hL(e)||nu(e)}_onPaste(){const e=this.editor,t=new Ye(e.editing.view.document);e.plugins.get("ClipboardPipeline").on("inputTransformation",async(n,s)=>{var l;const{link:o,text:r}=ua(s.dataTransfer);if(!o||await this._isInValidExternalUrl(o))return;s.content=t.createDocumentFragment([t.createElement("a",{href:o},[t.createText(r||o)])]),!!((l=e.plugins.get("UrlPreviewHelperUI"))!=null&&l.isEnabled)?this._generateEnhancedInitialPreview(o):this._generateOldInitialPreview(o)})}_onClick(){const e=this.editor,t={urlPreviewActionButton:s=>{e.model.change(o=>{o.remove(s)})}},n=Object.keys(t);e.listenTo(e.editing.view.document,"click",(s,o)=>{var r;try{const a=o.target,l=e.editing.mapper.toModelElement(a);if(!l)return;const c=l.getAncestors(),u="externalUrlPreview",d=c.find(g=>g.name===u);let h=!1;const f=l.name,m=!!((r=e.plugins.get("UrlPreviewHelperUI"))!=null&&r.isEnabled);if(f==="urlPreviewActionButton"&&m)return;if(t[f]?(t[f](d),h=!0):c.forEach(g=>{const b=g.name;n.includes(b)&&(t[b](d),h=!0)}),!h){const g=d.getAttribute("href");g&&d&&window.open(g,"_blank")}}catch{}})}_defineConverters(){this.editor.conversion.for("editingDowncast").elementToElement({model:"externalUrlPreview",view:(t,{writer:n})=>{const s=t.getAttribute("preview-ui"),o="link-preview external-preview-link",r=s===w.URLPreviewUI.TITLE?`${o} title-preview`:o;return Ws(n.createContainerElement("div",{"data-url":t.getAttribute("href"),class:r,"data-prefs":t.getAttribute("prefs"),contenteditable:!1,"data-metas":t.getAttribute("metas"),"data-preview-ui":t.getAttribute("preview-ui")}),n,{hasSelectionHandle:!1})},converterPriority:"high"})}}let kL=class extends y{static get requires(){return[yL,CL]}static get pluginName(){return"ExternalSwymPreviewUrl"}};const da="3DSwym";w.I3dxDomain.COMMUNITY,w.I3dxDomain.POST,w.IContentModel.Post,w.I3dxDomain.IDEA,w.IContentModel.Idea,w.I3dxDomain.MEDIA,w.IContentModel.Media,w.I3dxDomain.QUESTION,w.IContentModel.Question;const TL=new Map([[w.IContentModel.Post,w.I3dxDomain.POST],[w.IContentModel.Media,w.I3dxDomain.MEDIA],[w.IContentModel.Question,w.I3dxDomain.QUESTION],[w.IContentModel.Idea,w.I3dxDomain.IDEA],["community",w.I3dxDomain.COMMUNITY]]);function T0(i){return TL.get(i)}function EL(i){const e=w.getContentModelFromSubjectUri(i);let t;if(!e){const[n]=i.split(":").splice(-2,1);return n&&n==="community"&&(t=T0(n)),t?`i3dx:${t}!${i}`:""}return t=T0(e),t?`i3dx:${t}!${i}`:""}var ft=(i=>(i.Picture="picture",i.Document="document",i.Video="video",i.Sound="sound",i.Model3D="3d_model",i.Sketch="sketch",i.Story="story",i.Whiteboard="whiteboard",i.Simulation="simulationMedia",i.AnimatedPicture="animatedPicture",i.Drawing="drawing",i.HomeByMe="homebyme",i))(ft||{});const AL={[w.IContentModel.Question]:{icon:"comment-question",color:"text-color-question"},[w.IContentModel.Idea]:{icon:"lamp",color:"text-color-idea"},[w.IContentModel.Wiki]:{icon:"book-open",color:"text-color-wiki"},[w.IContentModel.Conference]:{icon:"calendar",color:"text-color-conference"},[w.IContentModel.Wedo]:{icon:"task",color:"text-color-wedo"},[w.IContentModel.Survey]:{icon:"clipboard",color:"text-color-survey"},[w.IContentModel.Post]:{icon:"newspaper",color:"text-color-post"},[w.IContentModel.Media]:{icon:"picture",color:"text-color-media"}},E0={[ft.AnimatedPicture]:"picture-animated",[ft.Document]:"doc",[ft.Sketch]:"app-3dsketch",[ft.Story]:"app-3dstory",[ft.Whiteboard]:"app-whiteboard",[ft.Simulation]:"run",[ft.Model3D]:"cube",[ft.Picture]:"picture",[ft.HomeByMe]:"logo-homebyme"},xL={ppt:"presentation-slide-layout",pptx:"presentation-slide-layout",xls:"table",xlsx:"table",doc:"doc-log",docx:"doc-log",zip:"folder-zipped"};function SL(i){const e=se.unref(i);if(e.model===w.IContentModel.Media){const t=e;return{icon:t.type?IL(t.type,t.preview_media_file_ext):"",color:"text-color-media"}}if(e.derived_type){const t=e.derived_type;return{icon:t.icon.replace("fonticon",""),color:`text-dt-${t.id}`}}return e.from_ritual?{icon:"calendar-clock",color:"text-color-conference"}:AL[e.model]||{icon:"",color:""}}function IL(i,e){return ft.Document===i?xL[e]||E0[ft.Document]||"":E0[i]||i}function PL(i){const e=[{label:"ds6w:type",value:i.model},{label:"ds6w:responsible",value:`${i.author.first_name} ${i.author.last_name}`}];return i.community_type!=="personalspace"&&e.push({label:"ds6w:community",value:i.community_title}),e.push({label:"ds6w:modified",value:i.updated_at?new Date(i.updated_at).toLocaleString(XO,{dateStyle:"short"}):""}),e}function A0(i){var s;const e=SL(i),t=`fonticon fonticon-${e.icon}  ${e.color}`;let n="";if(i.enhanced_summary){const o=document.createElement("div");o.innerHTML=i.enhanced_summary,n=o.textContent||""}return{objectId:i.subject_uri,thumbnailImage:i.preview_url,icon:t,i3dx:EL(i.subject_uri),type:i.model,service:da,title:i.title,description:n,details:PL(i),community_type:i.community_type,derivedTypeId:(s=i.derived_type)==null?void 0:s.id}}function RL(i){return eu(i).then(e=>A0(e))}class ML extends y{static get pluginName(){return"InternalSwymPreviewUI"}init(){this.isEnabled=!1,this._defineConverters(),this.on("change:isEnabled",(e,t,n)=>{t==="isEnabled"&&n&&this._onPaste()})}async _generateEnhancedInitialPreview(e){const t=this.editor,{contentId:n,derivedTypeId:s,contentType:o}=Gi(e),r=new URL(e);t.execute("addPlatformObject",[{previewData:{isLoadingPlaceholder:!0,objectId:n,derivedTypeId:s,type:o,service:da,section:r.searchParams.get("section")||void 0},previewUI:w.URLPreviewUI.TILE,href:e}])}async _generateOldInitialPreview(e){const t=this.editor;try{const n=await uL(e),{contentId:s,derivedTypeId:o,contentType:r}=Gi(e);n&&n.content&&(["url","image","title","details"].every(l=>Object.keys(n).includes(l))?t.execute("addPlatformObject",[{previewData:A0(n.content),previewUI:w.URLPreviewUI.TILE,href:e}]):t.execute("addPlatformObject",[{previewData:{title:"Content not accessible",objectId:s,derivedTypeId:o,type:r,service:da},previewUI:w.URLPreviewUI.TILE,href:e}])),t.editing.view.scrollToTheSelection()}catch{}}async _isInvalidInternalUrl(e){return!qi(e)||!co(e)&&!await w0(e)||!b0(e)}_onPaste(){const e=this.editor,t=new Ye(e.editing.view.document);e.plugins.get("ClipboardPipeline").on("inputTransformation",async(n,s)=>{var l;const{link:o,text:r}=ua(s.dataTransfer);if(!o||await this._isInvalidInternalUrl(o))return;s.content=t.createDocumentFragment([t.createElement("a",{href:o},[t.createText(r||o)])]),!!((l=e.plugins.get("UrlPreviewHelperUI"))!=null&&l.isEnabled)?this._generateEnhancedInitialPreview(o):this._generateOldInitialPreview(o)})}_defineConverters(){this.editor.conversion.for("upcast").elementToElement({view:t=>{const n=t.getAttribute("href");return t.hasClass("preview-link")&&n&&co(n)?{classes:["preview-link"]}:null},model:(t,{writer:n})=>{const s=t.hasClass("title-preview")?w.URLPreviewUI.TITLE:t.hasClass("thumbnail-preview")?w.URLPreviewUI.THUMBNAIL:w.URLPreviewUI.TILE,o=t.getAttribute("href"),{contentId:r,derivedTypeId:a,contentType:l}=Gi(o);return n.createElement("platformObjectPreview",{href:o,metas:{isLoadingPlaceholder:!0,service:da,previewUI:s,objectId:r,type:l,derivedTypeId:a},"preview-ui":s})},converterPriority:"high"})}}class BL extends y{static get pluginName(){return"PlatformObjectPreviewEditing"}init(){this._defineSchema(),this._defineConverters()}_defineSchema(){this.editor.model.schema.register("platformObjectPreview",{isObject:!0,allowWhere:"$inlineObject",allowAttributes:["href","metas","preview-ui"]})}_defineConverters(){const e=this.editor.conversion;e.for("editingDowncast").elementToElement({model:"platformObjectPreview",view:(t,{writer:n})=>n.createContainerElement("div")}),e.for("dataDowncast").elementToElement({model:"platformObjectPreview",view:(t,{writer:n})=>{const s=t.getAttribute("metas"),o=t.getAttribute("preview-ui"),r=t.getAttribute("href");return n.createContainerElement("a",{...r?{href:r}:void 0,class:`preview-link platform-object-preview ${o}-preview`,"data-content-id":s.objectId,"data-type":s.type,"data-source":s.service,rel:"nofollow"})},converterPriority:"high"}),e.for("upcast").elementToElement({view:t=>t.hasClass("platform-object-preview")?{classes:["platform-object-preview"]}:null,model:(t,{writer:n})=>{const s=t.hasClass("platform-object-preview","title-preview")?w.URLPreviewUI.TITLE:t.hasClass("platform-object-preview","thumbnail-preview")?w.URLPreviewUI.THUMBNAIL:w.URLPreviewUI.TILE,o=t.getAttribute("data-content-id"),r=t.getAttribute("href"),a=t.getAttribute("data-type"),l=t.getAttribute("data-source");return n.createElement("platformObjectPreview",{...r?{href:r}:void 0,metas:{isLoadingPlaceholder:!0,previewUI:s,type:a,service:l,objectId:o},"preview-ui":s})},converterPriority:"high"})}}const OL="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='181.01'%20height='144.191'%20viewBox='0%200%20181.01%20144.191'%3e%3cg%20id='Illustration'%20transform='translate(-81.379%20-80.528)'%3e%3cg%20id='Layer_1_copy'%20data-name='Layer%201%20copy'%20transform='translate(81.379%2080.528)'%3e%3cpath%20id='Tracé_1294'%20data-name='Tracé%201294'%20d='M165.4,181.084H86.67a5.3,5.3,0,0,1-5.291-5.291V85.819a5.3,5.3,0,0,1,5.291-5.291H165.4a5.3,5.3,0,0,1,5.291,5.291v89.975A5.3,5.3,0,0,1,165.4,181.084Z'%20transform='translate(-81.379%20-80.528)'%20fill='%23b4b6ba'/%3e%3cpath%20id='Tracé_1295'%20data-name='Tracé%201295'%20d='M175.288,190.676H103.914a4.7,4.7,0,0,1-4.7-4.7V103.637a4.7,4.7,0,0,1,4.7-4.7h71.374a4.7,4.7,0,0,1,4.7,4.7v82.342A4.7,4.7,0,0,1,175.288,190.676Z'%20transform='translate(-94.945%20-94.53)'%20fill='%23fff'/%3e%3cpath%20id='Tracé_1296'%20data-name='Tracé%201296'%20d='M202.629,384.123H145.787a1.174,1.174,0,1,1,0-2.349h56.845a1.174,1.174,0,0,1,0,2.349Z'%20transform='translate(-129.467%20-309.626)'%20fill='%23b4b6ba'/%3e%3cpath%20id='Tracé_1297'%20data-name='Tracé%201297'%20d='M202.634,403.5H145.792a1.174,1.174,0,1,1,0-2.349h56.842a1.174,1.174,0,1,1,0,2.349Z'%20transform='translate(-129.472%20-324.361)'%20fill='%23b4b6ba'/%3e%3cpath%20id='Tracé_1298'%20data-name='Tracé%201298'%20d='M639.258,463.527s-1.836,8.977,1.224,8.161,1.836-8.569,1.836-8.569Z'%20transform='translate(-505.232%20-371.489)'%20fill='%23a0616a'/%3e%3cg%20id='ignore'%20transform='translate(19.222%2011.307)'%3e%3cg%20id='ignore-2'%20data-name='ignore'%3e%3cpath%20id='Tracé_1402'%20data-name='Tracé%201402'%20d='M57.533,32.434a3.043,3.043,0,0,0-2.152.9l-4.95,6.1.651-18.8c0-.1.18-1.5-2.1-1.5a1.53,1.53,0,0,0-1.5,1.351l-1.4,12.8h-.2l-.452-13.553a1.5,1.5,0,0,0-1.5-1.451h-.6a1.5,1.5,0,0,0-1.5,1.451l-.452,13.553h-.249l-.75-11.953a1.428,1.428,0,0,0-1.451-1.351h-.7a1.473,1.473,0,0,0-1.451,1.451v12.9l-.149.1-1.65-7.749a1.532,1.532,0,0,0-1.5-1.252,1.49,1.49,0,0,0-1.5,1.5l.651,15a11.6,11.6,0,0,0,22.351,4.1l4.9-12.1a2,2,0,0,0,.05-.249c0-.387-1.08-1.252-2.4-1.252Z'%20transform='translate(-19.73%20-11.281)'%20fill='%23b4b6ba'/%3e%3cpath%20id='Tracé_1403'%20data-name='Tracé%201403'%20d='M24.5,0A24.5,24.5,0,1,0,49,24.5,24.5,24.5,0,0,0,24.5,0Zm0,45.506a21,21,0,1,1,21-21A21,21,0,0,1,24.5,45.506Z'%20fill='%23b4b6ba'/%3e%3c/g%3e%3c/g%3e%3c/g%3e%3cg%20id='Layer_4'%20data-name='Layer%204'%20transform='translate(149.9%20199.484)'%3e%3cpath%20id='Tracé_1299'%20data-name='Tracé%201299'%20d='M473.837,628.168c2.9,1.945,6.21,11.778,6.21,11.778s-10.353.675-13.254-1.269a6.326,6.326,0,1,1,7.04-10.512l0,0Z'%20transform='translate(-440.874%20-615.149)'%20fill='%23e2e4e3'/%3e%3cpath%20id='Tracé_1300'%20data-name='Tracé%201300'%20d='M483.606,648.437l-.162.129a32.675,32.675,0,0,0-14.933-10.01l.056-.2A32.905,32.905,0,0,1,483.606,648.437Z'%20transform='translate(-444.315%20-623.714)'%20fill='%23f4f5f6'/%3e%3cpath%20id='Tracé_1301'%20data-name='Tracé%201301'%20d='M514.363,586.312c-.185,4.832-9.371,15.868-9.371,15.868s-8.311-11.709-8.126-16.539a8.755,8.755,0,1,1,17.5.662v.01Z'%20transform='translate(-465.876%20-577.216)'%20fill='%23e2e4e3'/%3e%3cpath%20id='Tracé_1302'%20data-name='Tracé%201302'%20d='M530.668,602.3l-.27-.1c4.451-12.358.991-24.739.955-24.862l.276-.079C531.665,577.383,535.151,589.849,530.668,602.3Z'%20transform='translate(-491.38%20-577.248)'%20fill='%23f4f5f6'/%3e%3cpath%20id='Tracé_1303'%20data-name='Tracé%201303'%20d='M479.684,680.773H367.768a.285.285,0,1,1,0-.57H479.684a.285.285,0,0,1,0,.57Z'%20transform='translate(-367.481%20-655.538)'%20fill='%23d1d4d4'/%3e%3c/g%3e%3cg%20id='Person'%20transform='translate(188.083%20107.884)'%3e%3cg%20id='Layer_3'%20data-name='Layer%203'%20transform='translate(7.829)'%3e%3ccircle%20id='Ellipse_2'%20data-name='Ellipse%202'%20cx='6.121'%20cy='6.121'%20r='6.121'%20transform='translate(8.089%201.434)'%20fill='%239e616a'/%3e%3cpath%20id='Tracé_1304'%20data-name='Tracé%201304'%20d='M593.659,207.977a10.434,10.434,0,0,0,1.574-1.445,3.494,3.494,0,0,0,.853-1.927,2.122,2.122,0,0,0-.809-1.881,1.537,1.537,0,0,0-1.956.137,2.578,2.578,0,0,0-.026-2.281,3.32,3.32,0,0,0-1.929-.865,5.589,5.589,0,0,1-3.232-2.407l1.179.244-.131-.841.977.34.009-1.171,1.009.564a6.439,6.439,0,0,1,4.536-1.69,5.016,5.016,0,0,1,2.405.66,3.521,3.521,0,0,1,1.567,1.9,1.655,1.655,0,0,1,2.063-.076,3.576,3.576,0,0,1,1.231,1.831,7.9,7.9,0,0,1,.332,4.228,6.292,6.292,0,0,1-2.162,3.612,7.019,7.019,0,0,1-3.521,1.4,13.134,13.134,0,0,1-3.82-.163'%20transform='translate(-581.3%20-194.752)'%20fill='%232f2e41'/%3e%3cpath%20id='Tracé_1305'%20data-name='Tracé%201305'%20d='M658.437,436.94a2.051,2.051,0,0,1,.409-3.119l-1.681-7.094,3.559,1.3,1.051,6.537a2.063,2.063,0,0,1-3.337,2.376Z'%20transform='translate(-633.799%20-371.169)'%20fill='%239e616a'/%3e%3cpath%20id='Tracé_1306'%20data-name='Tracé%201306'%20d='M563.192,436.83a2.051,2.051,0,0,0-.409-3.119l1.681-7.094-3.558,1.3-1.051,6.538a2.063,2.063,0,0,0,3.337,2.376Z'%20transform='translate(-559.601%20-371.086)'%20fill='%239e616a'/%3e%3c/g%3e%3cg%20id='Groupe_1730'%20data-name='Groupe%201730'%20transform='translate(8.112%2016.119)'%3e%3cpath%20id='Tracé_1307'%20data-name='Tracé%201307'%20d='M587.394,298.3c-.408-.612,0-1.428,0-2.652s-.816-1.836-.816-3.877c0-1.01-.6-5.418-1.181-9.836a45.817,45.817,0,0,1,0-6.818,5.3,5.3,0,0,0-.363-2.678c-1.328-3.762-1.649-3.314-6.749-10.047a14.444,14.444,0,0,0-6.121,0,45.736,45.736,0,0,0-5.231,6.094h0s-2.244,1.632-2.04,3.468-2.244,17.75-2.244,19.79-.816,2.652-.816,3.876.408,2.04,0,2.652a15.066,15.066,0,0,0-1.02,5.713,11.523,11.523,0,0,1,0,2.856h3.672s.292-.99.73-2.426c2.926.444,13.862.927,19.125,1.117.248.822.4,1.335.4,1.335h3.672a11.51,11.51,0,0,1,0-2.856A15.066,15.066,0,0,0,587.394,298.3Z'%20transform='translate(-560.783%20-262.053)'%20fill='%23368ec4'/%3e%3cpath%20id='Tracé_1308'%20data-name='Tracé%201308'%20d='M582.572,393.988l6.137-13.5-3.068,14.36Z'%20transform='translate(-577.353%20-352.122)'%20opacity='0.1'%20style='isolation:%20isolate'/%3e%3c/g%3e%3cg%20id='Groupe_1731'%20data-name='Groupe%201731'%20transform='translate(0%2057.234)'%3e%3cpath%20id='Tracé_1309'%20data-name='Tracé%201309'%20d='M653.242,635.98h-2.714l-1.291-10.469h4.006Z'%20transform='translate(-619.941%20-579.58)'%20fill='%239e616a'/%3e%3cpath%20id='Tracé_1310'%20data-name='Tracé%201310'%20d='M554.2,633.31l-2.549-.933,2.384-10.275,3.762,1.376Z'%20transform='translate(-545.723%20-576.987)'%20fill='%239e616a'/%3e%3cpath%20id='Tracé_1311'%20data-name='Tracé%201311'%20d='M641.062,665.188H632.31v-.111a3.407,3.407,0,0,1,3.406-3.406h0l1.6-1.213,2.982,1.213h.764Z'%20transform='translate(-607.068%20-606.157)'%20fill='%232f2e41'/%3e%3cpath%20id='Tracé_1312'%20data-name='Tracé%201312'%20d='M535.132,662.015l-8.219-3.007.038-.1a3.406,3.406,0,0,1,4.369-2.029h0l1.918-.59,2.384,2.164.717.262Z'%20transform='translate(-526.913%20-602.984)'%20fill='%232f2e41'/%3e%3cpath%20id='Tracé_1313'%20data-name='Tracé%201313'%20d='M558.111,433.729s-2.448,3.264-2.448,5.1-.816,18.158-.816,18.158-6.195,24.305-4.971,25.529,5.509,2.448,6.121,1.836,5.99-25.733,5.99-25.733l5.1-13.669,4.693,19.586.408,20.81s5.1,1.224,6.121.408,1.224-20.606,0-27.543.2-22.85.2-22.85Z'%20transform='translate(-544.255%20-433.729)'%20fill='%232f2e41'/%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e";class LL extends F{execute(e){const t=this.editor;t.model.change(n=>{e.forEach(s=>{const{previewData:o,previewUI:r,href:a}=s,l=n.createElement("platformObjectPreview",{metas:o,"content-id":o.objectId,"preview-ui":r,...a?{href:a}:void 0});o.isLoadingPlaceholder||n.append(n.createElement("urlPreviewActionButton"),l),t.model.insertContent(l);const c=n.createElement("paragraph"),u=n.createElement("paragraph");n.insert(c,l,"before"),n.insert(u,l,"after"),n.setSelection(u,"in")})})}}function VL(){const i=document.createElement("span");return i.classList.add("spinner-bar"),i.style.width="3px",i.style.height="20px",i.style.backgroundColor="var(--color-blue-4)",i}function DL(){const i=document.createElement("div");return i.setAttribute("disabled","true"),i.classList.add("spinner","spinning"),i.style.width="100%",i.style.height="40px",i.style.display="flex",i.style.gap="2px",i.style.justifyContent="center",i.style.alignItems="center",i}function x0(){const i=DL();for(let e=0;e<=3;e++){const t=VL();t.classList.add(`spinner-bar${e}`),i.appendChild(t)}return i}var iu=(i=>(i.POST="POST",i.IDEA="IDEATION",i))(iu||{});const bn={ideation:"dt-idea",idea:"dt-idea",post:"dt-post"};iu.IDEA,bn.idea,iu.POST,bn.post;function NL(i){if(i.startsWith(bn.idea))return i.replace(`${bn.idea}-`,"");if(i.startsWith(bn.post))return i.replace(`${bn.post}-`,"")}function FL(i){if(i===w.IContentModel.DerivedIdea)return w.IContentModel.Idea;if(i===w.IContentModel.DerivedPost)return w.IContentModel.Post}function $L(i){if(i.startsWith(bn.idea))return w.IContentModel.DerivedIdea;if(i.startsWith(bn.post))return w.IContentModel.DerivedPost}function UL(i){return i==null?void 0:i.split(":").pop()}const S0={_createIconContainer({icon:i,writer:e}){return qi(i)?e.createEmptyElement("span",{class:"platform-object-preview-title-icon",style:`background-image: url(${i})`}):e.createEmptyElement("span",{class:i})},_createTitleContainer({icon:i,title:e,writer:t,isLoadingPlaceholder:n}){return t.createContainerElement("div",{class:"platform-object-preview-title-container"},[this._createIconContainer({icon:i||"fonticon fonticon-link-off",writer:t}),t.createRawElement("span",{class:"platform-object-preview-title"},s=>s.textContent=e||null),...n?[]:[t.createSlot()]])},_createThumbnailImageContainer({writer:i,thumbnailImage:e}){return i.createContainerElement("div",{class:"platform-object-preview-thumbnail-image",style:`background-image: url(${e||k0})`})},_createLoadingSpinnerContainer(i){return i.createRawElement("div",{class:"loading-placeholder-spinner"},e=>{const t=x0();e.append(t)})},_createTitlePreview({objectData:i,writer:e}){const{title:t,icon:n,isLoadingPlaceholder:s}=i;return e.createContainerElement("div",{class:`link-preview platform-object-preview title-preview ${s?"loading-placeholder":""}`},[this._createTitleContainer({writer:e,icon:n,title:t,isLoadingPlaceholder:s})])},_createTileOrThumbnailPreview({objectData:i,previewUI:e,writer:t}){const{title:n,icon:s,thumbnailImage:o,isLoadingPlaceholder:r,details:a,description:l}=i,c=`link-preview platform-object-preview ${e}-preview`;return t.createContainerElement("div",{class:`${c} ${r?"loading-placeholder":""}`},[...r?[this._createLoadingSpinnerContainer(t)]:[],this._createThumbnailImageContainer({writer:t,thumbnailImage:o}),t.createContainerElement("div",{class:"platform-object-preview-content"},[this._createTitleContainer({writer:t,icon:s,title:n,isLoadingPlaceholder:r}),t.createRawElement("span",{class:"platform-object-preview-details"},u=>{a&&(u.textContent=a.map(d=>d.value).join(" | "))}),...e===w.URLPreviewUI.TILE?[t.createRawElement("span",{class:"platform-object-preview-description"},u=>u.textContent=l||null)]:[]])])}};class zL extends y{constructor(){super(...arguments),this.generatingPreviewNLS="Generating URL preview...",this.contentNotAccessibleNLS="Content not accessible"}static get pluginName(){return"PlatformObjectPreviewUI"}async init(){this.isEnabled=!1;const e=this.editor;this._defineConverters(),this.on("change:isEnabled",(s,o,r)=>{o==="isEnabled"&&r&&this._onUISwitch()}),e.commands.add("addPlatformObject",new LL(e));const{$i18n:t,promise:n}=w.useTranslations$1("detail-view");await n,this.generatingPreviewNLS=t("generatingPreview"),this.contentNotAccessibleNLS=t("contentNotAccessible")}_defineConverters(){this.editor.conversion.for("editingDowncast").elementToStructure({model:"platformObjectPreview",view:(t,{writer:n})=>{const s=t.getAttribute("metas"),o=t.getAttribute("preview-ui"),r=t.getAttribute("href");if(r){const{derivedTypeId:a}=Gi(qi(r)?r:w.getSwymUrl()+r);s.derivedTypeId=a}return s.isLoadingPlaceholder&&(this._itemSearch(s,t),s.title=this.generatingPreviewNLS),o===w.URLPreviewUI.TITLE?S0._createTitlePreview({objectData:s,writer:n}):S0._createTileOrThumbnailPreview({objectData:s,previewUI:o,writer:n})},converterPriority:"high"})}_addContextualMenuToPreviewElement(e){const t=this.editor;t.model.change(n=>{n.append(n.createElement("urlPreviewActionButton"),e),t.editing.reconvertItem(e)})}_generateUnreachablePreview(e){const t=this.editor,n=e.getAttribute("metas");t.model.enqueueChange(()=>{e._setAttribute("metas",{...n,isLoadingPlaceholder:!1,title:this.contentNotAccessibleNLS,thumbnailImage:OL})})}_extractContentType(e){const t=$L(e);return t?{contentType:FL(t),derivedTypeId:NL(e)}:{contentType:e}}_itemSearch(e,t){const{objectId:n,type:s,service:o,section:r,derivedTypeId:a}=e,l=this._extractContentType(s);RL({id:UL(n)||n,derivedTypeId:(l==null?void 0:l.derivedTypeId)||a,contentType:l==null?void 0:l.contentType}).then(c=>{if(!c)throw new Error("objectDoesNotExist");t._setAttribute("metas",{...c,isLoadingPlaceholder:!1})}).catch(()=>{this._generateUnreachablePreview(t)}).finally(()=>{this._addContextualMenuToPreviewElement(t)})}_onUISwitch(){const e=this.editor;e.plugins.has("UrlPreviewHelper")&&e.plugins.get("UrlPreviewHelperUI").on("urlPreviewUISwitch",(t,{newPreviewUI:n,modelElement:s,metaData:o})=>{if(s.name==="platformObjectPreview"){const r=s.getAttribute("href");n===w.URLPreviewUI.LINK&&r&&e.model.change(a=>{a.remove(s);const l=w.getSwymUrl()+r,c=a.createText(l,{linkHref:l});e.model.insertContent(c)}),e.model.enqueueChange({isUndoable:!1},()=>{s._setAttribute("metas",o),s._setAttribute("preview-ui",n),e.editing.reconvertItem(s)})}})}}class HL extends y{static get requires(){return[BL,zL,ML]}static get pluginName(){return"PlatformObjectPreview"}}const WL={getYoutubePreviewElement(i){const{writer:e,height:t,width:n,title:s,src:o,url:r}=i;return e.createElement("youtubePreview",{height:t,width:n,title:s,src:o,"data-url":r})}};class jL extends y{static get pluginName(){return"YoutubeSwymPreviewUI"}init(){w.useFeatureManager("content.editor.url_preview").value&&this._onPaste()}_onPaste(){const e=this.editor,t=new Ye(e.editing.view.document);e.plugins.get("ClipboardPipeline").on("inputTransformation",async(n,s)=>{const{link:o,text:r}=ua(s.dataTransfer);if(!(o&&qi(o))||(s.content=t.createDocumentFragment([t.createElement("a",{href:o},[t.createText(r||o)])]),!nu(o)))return;const a=await bL(o);["height","width","src","title"].every(c=>Object.keys(a).includes(c))&&(e.model.change(c=>{const u=WL.getYoutubePreviewElement({height:a.height||0,width:a.width||0,src:a.src||"",title:a.title||"",url:o,writer:c});e.model.insertContent(u);const d=c.createElement("paragraph");c.insert(d,u,"after"),c.setSelection(d,"in")}),e.editing.view.scrollToTheSelection())})}}const I0={defineYoutubePreview(i){i.register("youtubePreview",{isObject:!0,allowWhere:"$inlineObject",allowAttributes:["height","width","title","src","data-url"]})}},P0={defineYoutubePreview(i){i.for("downcast").elementToElement({model:"youtubePreview",view:(e,{writer:t})=>t.createContainerElement("iframe",{src:e.getAttribute("src"),height:e.getAttribute("height"),width:e.getAttribute("width"),title:e.getAttribute("title"),"data-url":e.getAttribute("data-url"),class:"youtube-preview-link"}),converterPriority:"high"}),i.for("upcast").elementToElement({view:{name:"iframe",classes:"youtube-preview-link"},model:(e,{writer:t})=>t.createElement("youtubePreview",{src:e.getAttribute("src"),height:e.getAttribute("height"),width:e.getAttribute("width"),title:e.getAttribute("title"),"data-url":e.getAttribute("data-url")}),converterPriority:"high"})}};class qL extends y{static get pluginName(){return"YoutubeSwymPreviewEditing"}init(){this._defineSchema(),this._defineConverters()}_defineSchema(){const e=this.editor.model.schema;Object.keys(I0).forEach(t=>I0[t](e))}_defineConverters(){const e=this.editor.conversion;Object.keys(P0).forEach(t=>P0[t](e))}}class GL extends y{static get requires(){return[qL,jL]}static get pluginName(){return"YoutubeSwymPreviewUrl"}}function ha({key:i,editorEl:e,plugin:t}){const n=w.useFeatureManager(i),s=se.watch([e,n],([o,r])=>{o&&(o.plugins.has(t)&&(o.plugins.get(t).isEnabled=r),r&&s())},{immediate:!0});return n}function R0(i){return i.contentType.toLowerCase()==="group"?`@${i.full_name}`:w.getInitialsFromName(i.full_name)}async function KL({queryText:i,conversationId:e,usersGroup:t=!0}){var c;const n=(c=(await w.getCurrentUser()).result)==null?void 0:c.login,s=i.toLowerCase(),o=w.getPlatformId(),r=e&&(await w.getConversationById(n,o,e)).users;if(i.length){const u=await w.SearchService.getUserInfo({text:i,userLogin:n,usersGroup:t});return new Promise(d=>{setTimeout(()=>{if(u.data){const f=u.data.filter(a).slice(0,20);d(f.map(m=>({...m,text:R0(m)}))||[])}},100)})}if(typeof r=="string")return[];return r.map(u=>({...u,text:w.getInitialsFromName(u.first_name)}));function a(u){if(!(r&&r.filter(l).find(h=>h.login===u.login)))return u.login===s?u.login.toLowerCase().substring(0):u.id.toLowerCase().substring(0,s.length)}function l(u){if(u.full_name=`${u.first_name} ${u.last_name}`,u.full_name.toLowerCase().substring(0,s.length)===s)return u}}async function ZL({queryText:i,usersGroup:e=!0}){var n;const t=(n=(await w.getCurrentUser()).result)==null?void 0:n.login;if(i.length){const s=await w.SearchService.getUserInfo({text:i,userLogin:t,usersGroup:e});return new Promise(o=>{setTimeout(()=>{if(s.data){const r=s.data.slice(0,20).map(a=>({...a,text:R0(a)}));o(r||[])}},100)})}}const JL=i=>{const e=document.createElement("div"),t=document.createElement("img"),n=document.createElement("span");e.appendChild(t),e.appendChild(n);const s=i.contentType.toLowerCase()==="group";return e.classList.add("user-highlight"),e.id=`mention-user-${s?i.resource_id:i.login}`,t.src=w.proxifyUrl(`${w.getSwymUrl()}/api/user/getpicture/login/${i.login}`),n.textContent=w.unescapeHTML(i.full_name||i.login),e.title=w.unescapeHTML(i.full_name||i.login),e},M0="ck-mentions-is-loading",su="ck-mentions-is-filled",YL=".ck-balloon-panel:has(.ck-mentions) li";function XL(){const{count:i,dec:e,inc:t}=w.useCounter(0,{min:0});function n(){return se.nextTick().then(()=>{var o,r;document.querySelectorAll(YL).length>1?(o=document.body)==null||o.classList.add(su):(r=document.body)==null||r.classList.remove(su)})}function s(){var o;(o=document.body)==null||o.classList.add(su)}return se.watch(i,o=>{var r,a;o?(r=document.body)==null||r.classList.add(M0):(a=document.body)==null||a.classList.remove(M0),n()}),{countLoadingMentions:i,addLoadingMentions:t,removeLoadingMentions:e,checkIfMentionsIsEmpty:n,mentionDropdownIsFilled:s}}function QL(i,e,t){const n=w.resolveRef(i),s=w.resolveRef(e),o=w.resolveRef(t),r=w.useFeatureManager("search.sources.usersgroup"),{checkIfMentionsIsEmpty:a,mentionDropdownIsFilled:l,addLoadingMentions:c,removeLoadingMentions:u}=XL(),d=w.useThrottleFn(async m=>{let g=[];return s.value?g=await KL({queryText:m,conversationId:s.value,usersGroup:r.value}):n.value&&(g=await ZL({queryText:m,usersGroup:r.value})),g},w.EXALEAD_SEARCH_DEBOUNCE,!0,!1,!0),h={loader:!0,id:"",text:""};return{userMentionsFeedCallback:async m=>{if(o.value)return[];if(m.startsWith(" "))return[];if(m.split(/\W/).length>4)return[];if(m.length>50)return[];const g=s.value?0:1;if(m.length<g)return setTimeout(a,0),[h];c();let b=[];try{b=await d(m)||[]}catch{}return u(),b.length&&l(),[...b,h]}}}function eV(){const i=document.createElement("div");return i.setAttribute("disabled","true"),i.style.width="100%",i.style.height="40px",i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",i}function tV(){const i=eV();return i.innerText="No results",i}function nV(i,e){return e.loader?x0():e.noResult?tV():i(e)}const iV=["id"],sV="mediaLibrary",oV=se.defineComponent({__name:"ckeditor-wrapper",props:{mode:{},modelValue:{},pendingActions:{default:()=>[]},placeholder:{default:""},conversationUri:{default:""},communityUri:{default:""},extraPlugins:{default:()=>[]},disableMentions:{type:Boolean,default:!1},contentUri:{default:""},outlined:{type:Boolean,default:!1},minLine:{default:1},maxLine:{default:1},emoji:{type:Boolean,default:!0}},emits:["update:modelValue","update:pending-actions","ready","focus","blur","input","destroy","paste"],setup(i,{emit:e}){se.useCssVars(E=>({"7d0cba86":E.minLine,"97406e62":E.maxLine}));const t=i,n=e,{$i18n:s}=w.useTranslations$1("create-edit-content-default"),o=w.useFeatureManager("content.features.emoji"),r=w.useFeatureManager("app.config.touch_device"),a=rO.component,l=yr,{userMentionsFeedCallback:c}=QL(se.toRef(t,"communityUri"),se.toRef(t,"conversationUri"),se.toRef(t,"disableMentions")),u=se.shallowRef(),d=se.computed(()=>t.placeholder||s("StartWriting"));se.watch([u,d],([E,L])=>{if(!E||!L)return;const K=E.editing.view,He=K.document.getRoot();He&&(He.placeholder=L),Oo({view:K,element:He,isDirectHost:!1,keepOnFocus:!0})},{immediate:!0});function h(E){u.value=E}const f=se.computed({get:()=>t.modelValue,set(E){n("update:modelValue",E)}});w.useVModel(t,"modelValue",n);const m=[],g=[];ha({key:"content.editor.url_preview",editorEl:u,plugin:"ExternalSwymPreviewUI"}),ha({key:"content.editor.url_preview_v2",editorEl:u,plugin:"UrlPreviewHelperUI"}),ha({key:"content.editor.platform_object_preview",editorEl:u,plugin:"PlatformObjectPreviewUI"}),ha({key:"content.editor.url_preview",editorEl:u,plugin:"InternalSwymPreviewUI"});const b=["bold","italic","underline","strikethrough","highlight","|","bulletedList","numberedList","|","removeFormat","link","emoji","autoEmoji"],_=[...m,"bold","italic","underline","strikethrough","highlight","|","bulletedList","numberedList","|","removeFormat","link",...t.emoji&&o.value&&!r.value?["emoji"]:[]],T=["undo","redo","|","paragraph","heading1","heading2","|",...m,"bold","italic","underline","strikethrough","ai-text-generator-separator","ai-text-generator","|","bulletedList","numberedList","blockquote","codeBlock","insertTable","|","outdent","indent","|","highlight","|","removeFormat","link",...t.emoji&&o.value&&!r.value?["emoji","emojiSuggestion"]:[]];function O(E){return E.filter((L,K)=>L==="|"?!0:E.indexOf(L)===K)}const B=se.computed(()=>{switch(t.mode){case"SIMPLE":return O([...b,...g]);case"SIMPLE-WITH-MEDIA":return O([..._,...g]);case"ADVANCED":return O([...T,...g]);default:return[]}}),W=se.computed(()=>({plugins:[u4,P6,Vi,O6,WA,...B.value.includes(sV)?[qP,c8,l8,ZP,yp,Cp,J8]:[],D7,vI,lO,K6,uO,U7,j7,Z7,Zp,Gp,N6,$6,k9,sI,sB,oB,jB,AB,sO,QB,f8,g8,$R,q9,dO,IP,cO,GL,kL,HL,vL,...t.emoji&&o.value?[eL]:[],LR],extraPlugins:[function(L){L.model.schema.setAttributeProperties("highlight",{isFormatting:!0})},function(L){const K=L.plugins.get("PendingActions"),He=()=>{try{n("update:pending-actions",Array.from(K).map(zt=>{const fa=se.ref(zt.message);return zt.on("change",()=>{fa.value=zt.message}),fa}))}catch{n("update:pending-actions",[])}};K.on("add",He),K.on("remove",He)}],toolbar:{items:B.value,shouldNotGroupWhenFull:!1},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells","tableProperties","tableCellProperties","toggleTableCaption"],tableProperties:{defaultProperties:{borderColor:"1px double red",borderWidth:"3px",width:"100%"}}},heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h1",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h2",title:"Heading 2",class:"ck-heading_heading2"}]},image:{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]},resizeUnit:"%",resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:25",value:"31",icon:"small"}],toolbar:["resizeImage:25","resizeImage:original","|","imageStyle:inline","imageStyle:alignLeft","imageStyle:alignCenter","imageStyle:alignRight","|","toggleImageCaption","ImageThumbnail","linkImage"]},codeBlock:{languages:[{language:"plaintext",label:"Code"}]},mention:{dropdownLimit:20,commitKeys:[59,186,13,9],feeds:[{marker:"@",feed:c,itemRenderer:nV.bind(null,JL),minimumCharacters:0}]},highlight:{options:[{model:"yellowMarker",class:"mark",title:"Yellow marker",color:"var(--color-marker-yellow)",type:"marker"},{model:"pinkMarker",class:"mark-pink",title:"Pink marker",color:"var(--color-marker-pink)",type:"marker"},{model:"blueMarker",class:"mark-blue",title:"Blue marker",color:"var(--color-marker-blue)",type:"marker"},{model:"greenMarker",class:"mark-green",title:"Green marker",color:"var(--color-marker-green)",type:"marker"}]},htmlSupport:{allow:[{name:"table",attributes:{border:!0},styles:!0}]},mediaLibrary:{communityUri:t.communityUri},mobileTagsSuggestions:{communityUri:t.communityUri,contentUri:t.contentUri,disableMentions:t.disableMentions},emojiSuggestion:{enableEmoji:t.emoji&&o.value}})),S=se.computed(()=>`${t.mode.toLowerCase()}-editor`),V=se.computed(()=>{const E=[];return t.outlined&&E.push("outlined"),t.minLine>1&&E.push("as-minimum-line"),t.maxLine>1&&E.push("as-maximum-line"),E});return se.onBeforeUnmount(()=>{var E,L,K;if((E=u.value)!=null&&E.plugins.has("FileRepository")){const He=(K=(L=u.value)==null?void 0:L.plugins.get("FileRepository"))==null?void 0:K.loaders;if(He)for(const zt of He)zt==null||zt.abort()}}),(E,L)=>(se.openBlock(),se.createElementBlock("div",{id:S.value,class:se.normalizeClass(V.value)},[se.createVNode(se.unref(a),{modelValue:f.value,"onUpdate:modelValue":L[0]||(L[0]=K=>f.value=K),config:W.value,editor:se.unref(l),onBlur:L[1]||(L[1]=K=>n("blur",K)),onDestroy:L[2]||(L[2]=()=>n("destroy")),onFocus:L[3]||(L[3]=K=>n("focus",K)),onInput:L[4]||(L[4]=K=>n("input",K)),onReady:L[5]||(L[5]=K=>{h(K),n("ready",K)})},null,8,["modelValue","config","editor"])],10,iV))}}),rV=w._export_sfc(oV,[["__scopeId","data-v-54e1a7d6"]]);Le.default=rV,Object.defineProperty(Le,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=ckeditor-wrapper-DRL8FVu_.js.map
