define("DS/CATSolverCDSWeb/CATSolverCDSResultGenerator",[],(function(){"use strict";return function(e,i,t){var o={},r=[];const n=function(e){return e===t.CATCDSMoveStatus.msEXACTLYMOVED?"exactlyMoved":e===t.CATCDSMoveStatus.msMOVED?"moved":e===t.CATCDSMoveStatus.msNOTMOVED?"notMoved":e===t.CATCDSMoveStatus.msFIXED?"fixed":void 0};for(let o=0;o<e.data.length;o++){let u,g=e.data[o];if(void 0===g.name)break;i.SetReplayFileName(g.name);let S=(new Date).getTime();i.Run();let C=(new Date).getTime(),f=i.GetEntities(t.CATCDSType.tpGEOMETRY),m=[];for(const e of f){let i={name:e.GetName()},t={line0:[1,0,0],line1:[0,1,0],line2:[0,0,1]};if(e.GetSketch()){let o=e.GetTransformation2D();void 0!==o?(t.line0=[o[0][0],o[0][1],0],t.line1=[o[1][0],o[1][1],0],i.matrix=t,i.vector=[o[0][2],o[1][2],0]):(i.matrix=t,i.vector=[0,0,0]),i.sketchName=e.GetSketch().GetName()}else{let o=e.GetTransformation();void 0!==o?(i.matrix={line0:[o.matrix[0][0],o.matrix[0][1],o.matrix[0][2]],line1:[o.matrix[1][0],o.matrix[1][1],o.matrix[1][2]],line2:[o.matrix[2][0],o.matrix[2][1],o.matrix[2][2]]},i.vector=o.vector):(i.matrix=t,i.vector=[0,0,0])}m.push(i)}let p=i.GetEntities(t.CATCDSType.tpRIGIDSET);var a=[];for(const e of p)if(e.HasTransformation()){let i={name:e.GetName()},t={line0:[1,0,0],line1:[0,1,0],line2:[0,0,1]};if(e.GetSketch()){var s=e.GetTransformation2D();void 0!==s?(t.line0=[s[0][0],s[0][1],0],t.line1=[s[1][0],s[1][1],0],i.matrix=t,i.vector=[s[0][2],s[1][2],0]):(i.matrix=t,i.vector=[0,0,0]),i.sketchName=e.GetSketch().GetName()}else{let o=e.GetTransformation();void 0!==o?(i.matrix={line0:[o.matrix[0][0],o.matrix[0][1],o.matrix[0][2]],line1:[o.matrix[1][0],o.matrix[1][1],o.matrix[1][2]],line2:[o.matrix[2][0],o.matrix[2][1],o.matrix[2][2]]},i.vector=o.vector):(i.matrix=t,i.vector=[0,0,0])}a.push(i)}let h=i.GetEntities(t.CATCDSType.tpVARIABLE),D=h.map((e=>({name:e.GetName(),value:e.GetValue()})));u={name:g.name,transformations:m,bodyTransformations:a,variableValues:D,time:C-S};var l=i.GetEntities(t.CATCDSType.tpSKETCH),d=i.GetEntities(t.CATCDSType.tpGEOMETRYLEAF),c=i.GetEntities(t.CATCDSType.tpRIGIDSET);let T=d.reduce((function(e,i){if(i.GetType()!==t.CATCDSType.tpSKETCH){let o=i.GetRigidSet();if(i.GetMoveStatus()!==t.CATCDSMoveStatus.msUNKNOWN&&(!o||o.GetMoveStatus()===t.CATCDSMoveStatus.msUNKNOWN)){let t={name:i.GetName(),movingStatus:n(i.GetMoveStatus())};i.GetSketch()&&(t.sketch=i.GetSketch().GetName()),e.push(t)}}return e}),[]),y=l.reduce((function(e,i){let o=i.GetRigidSet();if(i.GetMoveStatus()!==t.CATCDSMoveStatus.msUNKNOWN&&(!o||o.GetMoveStatus()===t.CATCDSMoveStatus.msUNKNOWN)){let t={name:i.GetName(),movingStatus:n(i.GetMoveStatus())};e.push(t)}return e}),[]),A=c.reduce((function(e,i){if(i.GetMoveStatus()!==t.CATCDSMoveStatus.msUNKNOWN){let t={name:i.GetName(),movingStatus:n(i.GetMoveStatus())};i.GetSketch()&&(t.sketch=i.GetSketch().GetName()),e.push(t)}return e}),[]),x=h.reduce((function(e,i){return i.GetMoveStatus()!==t.CATCDSMoveStatus.msUNKNOWN&&e.push({name:i.GetName(),movingStatus:n(i.GetMoveStatus())}),e}),[]);y.length&&(u.sketchMovingStates=y),x.length&&(u.variableMovingStates=x),T.length&&(u.objectMovingStates=T),A.length&&(u.rigidSetMovingStates=A);let b=(d=i.GetEntities(t.CATCDSType.tpGEOMETRYLEAF)).map((function(e){switch(e.GetType()){case t.CATCDSType.tpCYLINDER:case t.CATCDSType.tpCIRCLE:case t.CATCDSType.tpCIRCLE2D:case t.CATCDSType.tpSPHERE:return{name:e.GetName(),radius:e.GetRadius()};case t.CATCDSType.tpELLIPSE:case t.CATCDSType.tpELLIPSE2D:case t.CATCDSType.tpHYPERBOLA:case t.CATCDSType.tpHYPERBOLA2D:case t.CATCDSType.tpTORUS:return{name:e.GetName(),majorRadius:e.GetMajorRadius(),minorRadius:e.GetMinorRadius()};case t.CATCDSType.tpPARABOLA:case t.CATCDSType.tpPARABOLA2D:return{name:e.GetName(),vertexCurvature:e.GetVertexCurvature()};case t.CATCDSType.tpCONE:return{name:e.GetName(),angle:e.GetAngle()}}}));b.length&&(u.objectParams=b);let M=i.GetEntities(t.CATCDSType.tpGEOMCONSTRAINT);for(const e of M){let t={},o=e.GetGeometries();for(const r of o){if(!r)continue;let o={},n=[],a=e.GetHelpParameter(r);void 0!==a?(n.push(a),o.helpParameter=n):(n=e.GetHelpParameters(r),void 0!==n?o.helpParameters=n:i.GetSketch(r)?(n=e.GetHelpPoint2D(r),void 0!==n&&(o.helpPoint2D=n)):(n=e.GetHelpPoint(r),void 0!==n&&(o.helpPoint=n))),o&&(t[r.GetName()]=o)}t&&(u[e.GetName()]=t)}let N={};for(const e of f){let i={status:e.GetStatus().value,underdefinedStatus:t.CATICDSAdvanced.GetUnderdefinedStatus(e)};var v=e.GetName();void 0!==v&&(N[v]=i)}u.geometryStates=N;let I={};for(const e of h)I[e.GetName()]=i.GetStatus(e).value;h.length&&(u.variableStates=I);let O=i.GetEntities(t.CATCDSType.tpCONSTRAINT),G={};for(const e of O)G[e.GetName()]=e.GetStatus().value;O.length&&(u.constraintStates=G);let E=i.GetDependentVariables(),k={};for(let e=0;e<E.length;e++){let i=[];for(let t=0;t<E[e].length;t++)i.push(E[e][t].GetName());k["class"+e]=i}E.length&&(u.variableDependency=k),u.singularity=i.IsSingularityDetected();let L=[],R=i.GetEntities(t.CATCDSType.tpPROFILE2D);for(const e of R){let i=[],t=e.GetProfileIterator(),o=t.next(),r=0;for(;o;){let e={subElement:o.edge.GetName(),globalStart:o.start,globalEnd:o.end,localStart:o.localStart,orientation:o.orientation,hidden:o.hidden};r<o.end&&(r=o.end),i.push(e),o=t.next()}let n={name:e.GetName(),segments:i,upParam:r},a=e.GetVertices(),s=e.GetSubElements();n.closed=a.length===s.length,L.push(n)}u.profiles=L,r.push(u)}return r.length&&(o.JSONOutputs=r),{ObtainedOutputs:o,rc:0,tracesFileNames:[],tracesContents:[]}}})),define("DS/CATSolverCDSWeb/CATSolverCDSLoader",[],(function(){"use strict";return new function(){function e(){Object.defineProperty(this,"length",{get:function(){var e=0;for(var i in this)e++;return e}})}var t,o,r,n,a,s,l,d,c;this.getLoadedJSONConstraints=function(){return r},this.LoadJSONFile=function(i,d,v){v.SetReplayMode(d.CATCDSReplayMode.rmNONE);var u=0;if(t=new e,o=new e,r=new e,n=new e,a=new e,s=[],l=[],c=new Map,void 0!==i.rigidsets)for(var g=v.GetFactory(),S=0;S<i.rigidsets.length;S++){var C=i.rigidsets[S],f=d.CATICDSRigidSet.Create(g),m=C.name;if(""==m)return console.log("error loading rigidSets"),1;f.SetName(m),t[m]=f,!0===C.fixed&&f.FixToggle(),!0===C.fixed2D&&f.FixToggle2D(),void 0!==C.softFixed&&f.SetFixationStiffness(C.softFixed),void 0!==C.softFixed2D&&f.SetFixationStiffness2D(C.softFixed2D)}if(void 0!==i.sketches){S=0;for(S=0;S<i.sketches.length;S++){g=v.GetFactory();var p=i.sketches[S].origin,h=i.sketches[S].axisOX,D=i.sketches[S].axisOY,T=d.CATICDSSketch.Create(g,p,h,D),y=i.sketches[S].name;T.SetName(y),a[y]=T,o[T.GetName()]=T;var A=i.sketches[S].rigidSet;if(void 0!==A){if(void 0===t[A])return console.log("error adding a sketch to a rigid set"),1;t[A].AddGeometry(T)}!0===i.sketches[S].fixed&&T.FixToggle(),void 0!==i.sketches[S].softFixed&&v.SetFixationStiffness(T,i.sketches[S].softFixed)}}if(void 0!==i.variables)for(S=0;S<i.variables.length;S++)u+=this.LoadVariable(i.variables[S],i,d,v);if(void 0!==i.objects)for(S=0;S<i.objects.length;S++)u=this.LoadObject(S,i,d,v);if(void 0!==i.joints)for(S=0;S<i.joints.length;S++)u+=this.LoadJoint(i.joints[S],d,v);if(void 0!==i.patterns)for(S=0;S<i.patterns.length;S++)u+=this.LoadPattern(i.patterns[S],d,v);if(u+=this.LoadConstraints(i,d,v),void 0!==i.equations)for(S=0;S<i.equations.length;S++)u+=this.LoadEquation(i.equations[S],d,v);if(void 0!==i.offsetConstraints)for(S=0;S<i.offsetConstraints.length;S++)u+=this.LoadOffsetConstraint(i.offsetConstraints[S],d,v);if(void 0!==i.movingEntities){for(S=0;S<i.movingEntities.length;S++)u+=this.LoadMovingEntity(i.movingEntities[S],d,v);v.SetTargetValues(s,l)}if(void 0!==i.movedEntities)for(S=0;S<i.movedEntities.length;S++)u+=this.LoadMovedEntity(i.movedEntities[S],d,v);return void 0!==i.options&&(u+=this.LoadOption(i.options,d,v)),u},this.checkName=function(e){return e.name===d},this.LoadObject=function(e,r,n,s){var l,d=r.objects[e];if(void 0!==o[d.name])return 0;if(void 0===d.type)return console.log("error loading object type"),1;if(void 0!==r.objectMapping)for(i=0;i<r.objectMapping.length;i++){var c=r.objectMapping[i].geom2d;o[c];if(c==d.name){var v=r.objectMapping[i].refSketch,u=r.objectMapping[i].geom3d,g=o[u],S=o[v];s.Create2DRep(S,g),l=s.Get2DRep(S,g),d.type="mapping";break}}var C=s.GetFactory();if(void 0!==d.sketch){if(CurrentSk=a[d.sketch],"undefined"==typeof CurrentSk)return 1;s.SetSketch(CurrentSk)}switch(d.type){case"point":s.SetSketch(null);var f=[];if(void 0===d.coords.x||void 0===d.coords.y||void 0===d.coords.z)return console.log("error loading point"),1;f.push(d.coords.x),f.push(d.coords.y),f.push(d.coords.z),l=n.CATICDSPoint.Create(C,f[0],f[1],f[2]);break;case"axis":s.SetSketch(null);var m=[];if(void 0===d.origin.x||void 0===d.origin.y||void 0===d.origin.z)return console.log("error loading axis"),1;m.push(d.origin.x),m.push(d.origin.y),m.push(d.origin.z);var p=[];if(void 0===d.vector1.x||void 0===d.vector1.y||void 0===d.vector1.z)return console.log("error loading axis vector1"),1;p.push(d.vector1.x),p.push(d.vector1.y),p.push(d.vector1.z);var h=[];if(void 0===d.vector2.x||void 0===d.vector2.y||void 0===d.vector2.z)return console.log("error loading axis vector2"),1;h.push(d.vector2.x),h.push(d.vector2.y),h.push(d.vector2.z);var D=[];if(void 0===d.vector3.x||void 0===d.vector3.y||void 0===d.vector3.z)return console.log("error loading axis vector3"),1;D.push(d.vector3.x),D.push(d.vector3.y),D.push(d.vector3.z),l=n.CATICDSAxis.Create(C,m[0],m[1],m[2],p[0],p[1],p[2],h[0],h[1],h[2],D[0],D[1],D[2]);break;case"cylinder":s.SetSketch(null);m=[];if(void 0===d.origin.x||void 0===d.origin.y||void 0===d.origin.z)return console.log("error loading cylinder"),1;m.push(d.origin.x),m.push(d.origin.y),m.push(d.origin.z);var T=[];if(void 0===d.direction.x||void 0===d.direction.y||void 0===d.direction.z)return console.log("error loading cylinder direction"),1;if(T.push(d.direction.x),T.push(d.direction.y),T.push(d.direction.z),void 0===d.radius)return console.log("error loading cylinder radius"),1;var y=d.radius;l=n.CATICDSCylinder.Create(C,m[0],m[1],m[2],T[0],T[1],T[2],y);break;case"cone":m=[];if(s.SetSketch(null),void 0===d.origin.x||void 0===d.origin.y||void 0===d.origin.z)return console.log("error loading cone"),1;m.push(d.origin.x),m.push(d.origin.y),m.push(d.origin.z);T=[];if(void 0===d.direction.x||void 0===d.direction.y||void 0===d.direction.z)return console.log("error loading cone direction"),1;if(T.push(d.direction.x),T.push(d.direction.y),T.push(d.direction.z),void 0===d.angle)return console.log("error loading cone angle"),1;var A=d.angle;l=n.CATICDSCone.Create(C,m[0],m[1],m[2],T[0],T[1],T[2],A);break;case"plane":m=[];if(s.SetSketch(null),void 0===d.origin.x||void 0===d.origin.y||void 0===d.origin.z)return console.log("error loading plane"),1;m.push(d.origin.x),m.push(d.origin.y),m.push(d.origin.z);var x=[];if(void 0===d.normal.x||void 0===d.normal.y||void 0===d.normal.z)return console.log("error loading plane normal"),1;x.push(d.normal.x),x.push(d.normal.y),x.push(d.normal.z),l=n.CATICDSPlane.Create(C,m[0],m[1],m[2],x[0],x[1],x[2]);break;case"sphere":var b=[];if(s.SetSketch(null),void 0===d.center.x||void 0===d.center.y||void 0===d.center.z)return console.log("error loading sphere center"),1;if(b.push(d.center.x),b.push(d.center.y),b.push(d.center.z),void 0===d.radius)return console.log("error loading sphere radius"),1;y=d.radius;l=n.CATICDSSphere.Create(C,b[0],b[1],b[2],y);break;case"torus":b=[];if(s.SetSketch(null),void 0===d.center.x||void 0===d.center.y||void 0===d.center.z)return console.log("error loading torus center"),1;b.push(d.center.x),b.push(d.center.y),b.push(d.center.z);x=[];if(void 0===d.normal.x||void 0===d.normal.y||void 0===d.normal.z)return console.log("error loading torus normal"),1;if(x.push(d.normal.x),x.push(d.normal.y),x.push(d.normal.z),void 0===d.majorRadius)return console.log("error loading torus major radius"),1;var M=d.majorRadius;if(void 0===d.minorRadius)return console.log("error loading torus minor radius"),1;var N=d.minorRadius;l=n.CATICDSTorus.Create(C,b[0],b[1],b[2],x[0],x[1],x[2],M,N);break;case"line":m=[];if(s.SetSketch(null),void 0===d.origin.x||void 0===d.origin.y||void 0===d.origin.z)return console.log("error loading line origin"),1;m.push(d.origin.x),m.push(d.origin.y),m.push(d.origin.z);T=[];if(void 0===d.direction.x||void 0===d.direction.y||void 0===d.direction.z)return console.log("error loading line direction"),1;T.push(d.direction.x),T.push(d.direction.y),T.push(d.direction.z),l=n.CATICDSLine.Create(C,m[0],m[1],m[2],T[0],T[1],T[2]);break;case"circle":b=[];if(s.SetSketch(null),void 0===d.center.x||void 0===d.center.y||void 0===d.center.z)return console.log("error loading circle center"),1;b.push(d.center.x),b.push(d.center.y),b.push(d.center.z);x=[];if(void 0===d.normal.x||void 0===d.normal.y||void 0===d.normal.z)return console.log("error loading circle normal"),1;if(x.push(d.normal.x),x.push(d.normal.y),x.push(d.normal.z),void 0===d.radius)return console.log("error loading circle radius"),1;y=d.radius;l=n.CATICDSCircle.Create(C,b[0],b[1],b[2],x[0],x[1],x[2],y);break;case"ellipse":b=[];if(s.SetSketch(null),void 0===d.center.x||void 0===d.center.y||void 0===d.center.z)return console.log("error loading ellipse center"),1;b.push(d.center.x),b.push(d.center.y),b.push(d.center.z);T=[];if(void 0===d.direction.x||void 0===d.direction.y||void 0===d.direction.z)return console.log("error loading ellipse direction"),1;T.push(d.direction.x),T.push(d.direction.y),T.push(d.direction.z);x=[];if(void 0===d.normal.x||void 0===d.normal.y||void 0===d.normal.z)return console.log("error loading ellipse normal"),1;if(x.push(d.normal.x),x.push(d.normal.y),x.push(d.normal.z),void 0===d.majorRadius)return console.log("error loading ellipse major radius"),1;M=d.majorRadius;if(void 0===d.minorRadius)return console.log("error loading ellipse minor radius"),1;N=d.minorRadius;l=n.CATICDSEllipse.Create(C,b[0],b[1],b[2],T[0],T[1],T[2],x[0],x[1],x[2],M,N);break;case"parabola":case"hyperbola":case"parabola2D":case"hyperbola2D":break;case"point2D":f=[];if(void 0===d.coords.x||void 0===d.coords.y)return console.log("error loading point2D"),1;f.push(d.coords.x),f.push(d.coords.y),l=n.CATICDSPoint2D.Create(C,f[0],f[1]);break;case"line2D":m=[];if(void 0===d.origin.x||void 0===d.origin.y)return console.log("error loading line2D origin"),1;m.push(d.origin.x),m.push(d.origin.y);T=[];if(void 0===d.direction.x||void 0===d.direction.y)return console.log("error loading line2D direction"),1;T.push(d.direction.x),T.push(d.direction.y),l=n.CATICDSLine2D.Create(C,m[0],m[1],T[0],T[1]);break;case"circle2D":b=[];if(void 0===d.center.x||void 0===d.center.y||void 0!==d.center.z)return console.log("error loading circle center"),1;if(b.push(d.center.x),b.push(d.center.y),void 0===d.radius)return console.log("error loading circle radius"),1;y=d.radius;l=n.CATICDSCircle2D.Create(C,b[0],b[1],y);break;case"ellipse2D":b=[];if(void 0===d.center.x||void 0===d.center.y)return console.log("error loading circle center"),1;b.push(d.center.x),b.push(d.center.y);T=[];if(void 0===d.direction.x||void 0===d.direction.y)return console.log("error loading ellipse direction"),1;if(T.push(d.direction.x),T.push(d.direction.y),void 0===d.majorRadius)return console.log("error loading ellipse major radius"),1;M=d.majorRadius;if(void 0===d.minorRadius)return console.log("error loading ellipse minor radius"),1;N=d.minorRadius;l=n.CATICDSEllipse2D.Create(C,b[0],b[1],T[0],T[1],M,N);break;case"axis2D":if(void 0===d.origin||void 0===d.vector1||void 0===d.vector2)return 1;l=n.CATICDSAxis2D.Create(C,d.origin.x,d.origin.y,d.vector1.x,d.vector1.y,d.vector2.x,d.vector2.y);break;case"interpolationNurbsCurve2D":l=this.LoadInterpol(d,n,s,!0);break;case"interpolationNurbsCurve":s.SetSketch(null),l=this.LoadInterpol(d,n,s,!1);break;case"conicarc2D":l=this.LoadNurbsConicArc2D(d,n,s);break;case"nurbsCurve2D":l=this.LoadNurbsCurve2DOr3D(d,n,s,!0);break;case"nurbsCurve":s.SetSketch(null),l=this.LoadNurbsCurve2DOr3D(d,n,s,!1);break;case"profile2D":l=this.LoadProfile(e,r,n,s);break;case"offsetCurve2D":l=this.LoadOffsetCurve2D(d,n,s)}if(!l)return 1;if(void 0!==d.fixed&&l.FixToggle(),void 0!==d.fixed2D&&l.FixToggle2D(),void 0!==d.softFixed&&s.SetFixationStiffness(l,d.softFixed),void 0!==d.softFixed2D&&s.SetFixationStiffness2D(l,d.softFixed2D),void 0!==d.rigidSet){if(void 0===t[d.rigidSet])return console.log("error adding an object to a rigid set"),1;t[d.rigidSet].AddGeometry(l)}var I=d.name;return void 0!==I&&(l.SetName(I),o[I]=l),0},this.LoadVariable=function(e,i,t,o){if(void 0===e.type)return console.log("error loading variable"),1;var r,a=o.GetFactory();switch(e.type){case"free":r=t.CATCDSVariableType.vtFREE;break;case"angle":r=t.CATCDSVariableType.vtANGLE;break;case"distance":r=t.CATCDSVariableType.vtDISTANCE;break;case"curvature":r=t.CATCDSVariableType.vtCURVATURE}var s=t.CATICDSVariable.Create(a,r);if(!s)return console.log("error  : could not create variable"),1;s.SetValue(e.value),s.SetTolerance(e.tolerance),void 0!==e.fixed&&s.Fix();var l=!1,d=!1,c=0,v=0;if(void 0!==e.low&&(l=!0,c=e.low),void 0!==e.up&&(d=!0,v=e.up),s.SetLimitsActivity(l,d),s.SetLimits(c,v),void 0!==e.name){var u=e.name;s.SetName(u),n[u]=s}return 0},this.LoadJoint=function(e,i,t){if(void 0===e.type||void 0===e.name||void 0===e.axis1||void 0===e.axis2)return console.log("error loading joint"),1;if(!o[e.axis1]||!o[e.axis2])return 1;var r;if("fullDOF"===e.type){if(void 0===e.length1||void 0===e.length2||void 0===e.length3||void 0===e.angle1||void 0===e.angle2||void 0===e.sphType)return console.log("error loading joint"),1;n[e.length1]&&n[e.length2]&&n[e.length3]&&n[e.angle1]&&n[e.angle2]&&n[e.angle3]&&("zxy"===e.sphType?r=i.CATICDSFullDOFJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2],i.CATCDSSphericalType.stZXY,n[e.length1],n[e.length2],n[e.length3],n[e.angle1],n[e.angle2],n[e.angle3]):"zyx"===e.sphType?r=i.CATICDSFullDOFJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2],i.CATCDSSphericalType.stZYX,n[e.length1],n[e.length2],n[e.length3],n[e.angle1],n[e.angle2],n[e.angle3]):"zxz"===e.sphType?r=i.CATICDSFullDOFJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2],i.CATCDSSphericalType.stZXZ,n[e.length1],n[e.length2],n[e.length3],n[e.angle1],n[e.angle2],n[e.angle3]):"pointpoint"===e.sphType&&(r=i.CATICDSFullDOFJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2],i.CATCDSSphericalType.stPOINTPOINT,n[e.length1],n[e.length2],n[e.length3],n[e.angle1],n[e.angle2],n[e.angle3])))}else if("cylindrical"===e.type){if(void 0===e.length||void 0===e.angle)return console.log("error loading joint"),1;n[e.length]&&n[e.angle]&&(r=i.CATICDSCylindricalJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2],n[e.angle],n[e.length]))}else if("revolute"===e.type){if(void 0===e.angle)return console.log("error loading joint"),1;n[e.angle]&&(r=i.CATICDSRevoluteJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2],n[e.angle]))}else if("prismatic"===e.type){if(void 0===e.length)return console.log("error loading joint"),1;n[e.length]&&(r=i.CATICDSPrismaticJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2],n[e.length]))}else if("spherical"===e.type){if(void 0===e.angle1||void 0===e.angle2||void 0===e.angle3||void 0===e.sphType)return console.log("error loading joint"),1;n[e.angle1]&&n[e.angle2]&&n[e.angle3]&&("zxy"===e.sphType?r=i.CATICDSSphericalJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2],i.CATCDSSphericalType.stZXY,n[e.angle1],n[e.angle2],n[e.angle3]):"zyx"===e.sphType?r=i.CATICDSSphericalJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2],i.CATCDSSphericalType.stZYX,n[e.angle1],n[e.angle2],n[e.angle3]):"zxz"===e.sphType?r=i.CATICDSSphericalJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2],i.CATCDSSphericalType.stZXZ,n[e.angle1],n[e.angle2],n[e.angle3]):"pointpoint"===e.sphType&&(r=i.CATICDSSphericalJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2],i.CATCDSSphericalType.stPOINTPOINT,n[e.angle1],n[e.angle2],n[e.angle3])))}else if("planar"===e.type)r=i.CATICDSPlanarJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2]);else if("U"===e.type)r=i.CATICDSUJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2]);else if("rigid"===e.type)r=i.CATICDSRigidJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2]);else if("symmetricIJ"===e.type){if(void 0===e.plane)return console.log("error loading joint"),1;o[e.plane]&&(r=i.CATICDSSymmetricIJJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2],o[e.plane]))}else if("symmetricJK"===e.type){if(void 0===e.plane)return console.log("error loading joint"),1;o[e.plane]&&(r=i.CATICDSSymmetricJKJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2],o[e.plane]))}else if("symmetricKI"===e.type){if(void 0===e.plane)return console.log("error loading joint"),1;o[e.plane]&&(r=i.CATICDSSymmetricKIJoint.Create(t.GetFactory(),o[e.axis1],o[e.axis2],o[e.plane]))}return r?(void 0!==e.softness&&t.SetConstraintStiffness(r,e.softness),r.SetName(e.name),0):(console.log("error creating joint"),1)},this.LoadInterpol=function(e,i,t,r){if(void 0===e.interpolationData||void 0===e.degree||void 0===e.periodic)return null;var s,l=t.GetFactory();if(r){var d=e.sketch;if(void 0===d||void 0===a[d])return console.log("error loading sketch of nurbs2D"),null;s=a[d],t.SetSketch(s),obj=i.CATICDSInterpolationNURBSCurve2D.Create(l)}else obj=i.CATICDSInterpolationNURBSCurve.Create(l);if(!obj)return null;obj.SetPeriodic(e.periodic),obj.SetDegree(e.degree);var c=0;for(c=0;c<e.interpolationData.length;c++){var v=e.interpolationData[c],u=v.name;if(void 0===u||void 0===o[u])return console.log("error loading interpolation point"),null;var g=o[u];if(obj.AddInterpolationPoint(c,g),void 0!==v.firstDerivativeDir){if(void 0===(S=o[v.firstDerivativeDir]))return console.log("error loading first derivative direction"),null;obj.SetFirstDerivativeDirection(c,S)}if(void 0!==v.firstDerivativeNormVariable){if(void 0===(C=n[v.firstDerivativeNormVariable]))return console.log("error loading first derivative norm variable"),null;obj.SetFirstDerivativeNormVariable(c,C)}if(void 0!==v.firstDerivativeNormValue&&obj.SetFirstDerivativeNorm(c,v.firstDerivativeNormValue),void 0!==v.secondDerivativeDir){var S;if(void 0===(S=o[v.secondDerivativeDir]))return console.log("error loading second derivative direction"),null;obj.SetSecondDerivativeDirection(c,S)}if(void 0!==v.secondDerivativeNormVariable){var C;if(void 0===(C=o[v.secondDerivativeNormVariable]))return console.log("error loading second derivative norm variable"),null;obj.SetSecondDerivativeNormVariable(c,C)}if(void 0!==v.secondDerivativeNormValue&&obj.SetSecondDerivativeNorm(c,v.secondDerivativeNormValue),void 0!==v.curvatureVariable){var f=o[v.curvatureVariable];if(void 0===f)return console.log("error loading curvature variable"),null;obj.SetCurvatureVariable(c,f)}void 0!==v.curvatureValue&&obj.SetCurvature(c,v.curvatureValue)}return obj},this.LoadNurbsCurve2DOr3D=function(e,i,t,r){var n=t.GetFactory(),s=0,l=[],d=[];for(s=0;s<e.controlPoints.length;s++){if(currentPointName=e.controlPoints[s],!o[currentPointName])return console.log("error loading control points of nurbsCurve"),1;l.push(o[currentPointName]),void 0!==e.weights&&d.push(e.weights[s])}if(0===d.length&&(d=null),r){var c=e.sketch;if(void 0===c||void 0===a[c])return console.log("error loading sketch of nurbs2D"),null;nurbs2DSketch=a[c],t.SetSketch(nurbs2DSketch),obj=i.CATICDSNURBSCurve2D.Create(n,e.degree,e.knots,l,d)}else obj=i.CATICDSNURBSCurve.Create(n,e.degree,e.knots,l,d);return obj},this.LoadNurbsConicArc2D=function(e,i,t){var r=t.GetFactory(),s=0,l=[];for(s=0;s<e.controlPoints.length;s++){if(currentPointName=e.controlPoints[s],!o[currentPointName])return console.log("error loading control points of nurbsCurve"),1;l.push(o[currentPointName])}var d=n[e.rho];if(void 0===d)return console.log("error loading rho"),null;var c=e.sketch;return void 0===c||void 0===a[c]?(console.log("error loading sketch of nurbs2D"),null):(nurbs2DSketch=a[c],t.SetSketch(nurbs2DSketch),obj=i.CATICDSNURBSConicArc2D.Create(r,l,d),obj)},this.LoadOffsetCurve2D=function(e,i,t){var r=t.GetFactory();return void 0===e.baseCurve||"undefined"===e.sketch||"undefined"===a[e.sketch]||void 0===e.offsetVariable&&void 0===e.offsetValue?(console.log("error loading offsetCurve2D"),null):"undefined"!=e.offsetVariable&&"undefined"===n[e.offsetVariable]?(console.log("error loading variable for offsetCurve2D"),null):void 0===o[e.baseCurve]?(console.log("error loading base for offsetCurve2D"),null):(t.SetSketch(a[e.sketch]),void 0!==e.offsetValue?i.CATICDSOffsetCurve2D.CreateFixOffset(r,o[e.baseCurve],e.offsetValue):i.CATICDSOffsetCurve2D.CreateVariableOffset(r,o[e.baseCurve],n[e.offsetVariable]))},this.LoadPattern=function(e,i,t){if("undefined"==e.type)return console.log("error loading pattern"),1;var r=t.GetFactory(),a=(e.objects.length,null),s=null,l=null;if(void 0!==e.objects){a=[];for(var d=0;d<e.objects.length;d++){if(void 0===o[e.objects[d]])return console.log("error loading pattern object"),1;if(a[d]=o[e.objects[d]],!a[d])return console.log("error loading pattern geometry"),1}}if(void 0!==e.variables){s=[];for(d=0;d<e.variables.length;d++){if(void 0===n[e.variables[d]])return console.log("error loading pattern variable"),1;s[d]=n[e.variables[d]]}}if(void 0!==e.alignments){l=[];for(d=0;d<e.alignments.length;d++)switch(e.alignments[d]){case"align":l[d]=i.CATCAlignment.caALIGN;break;case"antiAlign":l[d]=i.CATCAlignment.caANTIALIGN;break;default:l[d]=i.CATCAlignment.caNOTSPECIFIED}}var c=null;if(void 0===o[e.axis])return console.log("error loading pattern axis"),1;var v=o[e.axis];if(!v)return console.log("error loading pattern axis"),1;switch(e.type){case"linear":c=i.CATICDSLinearPattern.Create(r,v,a,s,void 0!==l?l:0);break;case"circular":c=i.CATICDSCircularPattern.Create(r,v,a,s,void 0!==l?l:0);break;case"full2D":c=i.CATICDSFullPattern2D.Create(r,v,a,s)}return c?(void 0!==e.softness&&t.SetConstraintStiffness(c,e.softness),c.SetName(e.name),0):(console.log("error loading pattern"),1)},this.LoadConstraints=function(e,i,t){var o=0;if(void 0!==e.constraints)for(var r=0;r<e.constraints.length;r++)o+=this.LoadConstraint(e.constraints[r],i,t);return o},this.LoadConstraintsWithIndexCondition=function(e,i,t,o){for(var n=!0,s=0;s<i.constraints.length;s++){var l=i.constraints[s];if(void 0===r[l.name]){for(var c=0;c<l.args.length;c++){d=l.args[c];var v=i.objects.findIndex(checkName);if(!a[d]&&v>e){n=!1;break}}if(!n)break;if(0!==this.LoadConstraint(i.constraints[s],t,o))return console.log("error during load of constraint with index condition"),!1}}return!0},this.LoadConstraint=function(e,i,t){if(void 0===e.name)return 1;if(void 0!==r[e.name])return 0;if(void 0===e.args||void 0===o[e.args[0]])return console.log("error loading constraint argument"),1;var a=t.GetFactory(),s=(t.GetEntities(i.CATCDSType.tpGEOMETRYLEAF),o[e.args[0]]);if(!s)return 0;var l=null,d=null;if(e.args.length>=2){if(!o[e.args[1]])return 0;l=o[e.args[1]]}if(e.args.length>=3){if(!o[e.args[2]])return 0;d=o[e.args[2]]}var c,v=!1;switch(e.type){case"coincidence":if(l&&(c=i.CATICDSCoincidence.Create(a,s,l)),!c)return 1;var u=e.circleTorusOrientation;"parallel"===u?c.SetCircleTorusOrientation(i.CATCDSTorusOrientation.toPARALLEL):"perpendicular"===u&&c.SetCircleTorusOrientation(i.CATCDSTorusOrientation.toPERPENDICULAR);break;case"distance":if(l&&(c=i.CATICDSDistance.Create(a,s,l,d)),v=!0,!c)return 1;break;case"angle":if(l&&(c=i.CATICDSAngle.Create(a,s,l,d)),!c)return 1;v=!0,void 0!==e.dimensional&&0==e.dimensional?c.SetAlignment(i.CATCAlignment.caNOTSPECIFIED):c.SetAlignment(i.CATCAlignment.caSPECIFIED);break;case"apexAngle":c=i.CATICDSApexAngle.Create(a,s),v=!0;break;case"parallelism":l&&(c=i.CATICDSParallelism.Create(a,s,l));break;case"perpendicularity":l&&(c=i.CATICDSPerpendicularity.Create(a,s,l));break;case"tangency":l&&(c=i.CATICDSTangency.Create(a,s,l,d));break;case"antitangency":l&&(c=i.CATICDSAntiTangency.Create(a,s,l,d));break;case"concentricity":l&&(c=i.CATICDSConcentricity.Create(a,s,l));break;case"coaxiality":c=i.CATICDSCoaxiality.Create(a,s,l);break;case"midpoint":l&&(c=i.CATICDSMidpoint.Create(a,s,l,d));break;case"symmetry":l&&(c=i.CATICDSSymmetry.Create(a,s,l,d));break;case"curvature":(c=i.CATICDSCurvature.Create(a,s,l))&&void 0!==e.absolute&&c.SetUseAbsoluteValue(e.absolute),v=!0;break;case"cotangency":c=i.CATICDSCoTangency.Create(a,s,l);break;case"focus":c=i.CATICDSFocus.Create(a,s,l);break;case"radius":c=i.CATICDSRadius.Create(a,s),v=!0;break;case"majorRadius":c=i.CATICDSMajorRadius.Create(a,s),v=!0;break;case"minorRadius":c=i.CATICDSMinorRadius.Create(a,s),v=!0;break;case"segmentLength":c=i.CATICDSSegmentLength.Create(a,s,l,d),v=!0;break;case"vertexCurvature":c=i.CATICDSVertexCurvature.Create(a,s),v=!0}if(!c)return console.log("error creating constraint"),1;if(void 0!==e.value&&c.SetValue(e.value),void 0!==e.softness&&t.SetConstraintStiffness(c,e.softness),void 0!==e.alignment&&("align"===e.alignment?c.SetAlignment(i.CATCAlignment.caALIGN):"antiAlign"===e.alignment&&c.SetAlignment(i.CATCAlignment.caANTIALIGN)),void 0!==e.helpParameters){var g=0;for(g=0;g<e.args.length;g++){var S=e.args[g],C=o[S];if(void 0===C)return console.log("error loading constraint parameter"),1;var f=e.helpParameters[S];if(void 0!==f){var m,p=f.helpParameter;void 0!==p&&c.SetHelpParameter(C,p[0]),void 0!==(p=f.helpParameters)&&c.SetHelpParameters(C,p[0],p[1]),void 0!==(m=f.helpPoint)&&3===m.length&&c.SetHelpPoint(C,m),void 0!==(m=f.helpPoint2D)&&2===m.length&&c.SetHelpPoint2D(C,m);var h=n[f.helpParameterVar1],D=n[f.helpParameterVar2];void 0!==h&&(c.SetHelpParameters(C,f.var1Value,void 0!==f.var2Value?f.var2Value:0),c.SetHelpParameterVariables(C,h,void 0!==D?D:null))}}}if(void 0!==e.changeChirality&&!0===e.changeChirality&&c.ChangeChirality(),void 0!==e.orientations&&("+"===e.orientations[0]?c.SetHalfSpace(s,i.CATCDSHalfSpace.hsPOSITIVE):"-"===e.orientations[0]&&c.SetHalfSpace(s,i.CATCDSHalfSpace.hsNEGATIVE),l&&("+"===e.orientations[1]?c.SetHalfSpace(l,i.CATCDSHalfSpace.hsPOSITIVE):"-"===e.orientations[1]&&c.SetHalfSpace(l,i.CATCDSHalfSpace.hsNEGATIVE)),d&&("+"===e.orientations[2]?c.SetHalfSpace(d,i.CATCDSHalfSpace.hsPOSITIVE):"-"===e.orientations[2]&&c.SetHalfSpace(d,i.CATCDSHalfSpace.hsNEGATIVE))),v&&void 0!==e.variable){var T=n[e.variable];void 0!==T&&c.SetVariable(T)}return c.SetName(e.name),r[e.name]=c,0},this.LoadEquation=function(e,i,t){if(void 0===e.type)return console.log("error loading equation"),1;var o=t.GetFactory();if("linear"===e.type){if(void 0===e.terms||void 0===e.tolerance||void 0===e.constant)return console.log("error loading linear equation"),1;for(var r=[],a=[],s=0;s<e.terms.length;s++){if(void 0===n[e.terms[s].name]||void 0===n[e.terms[s].name])return console.log("error loading linear equation"),1;r.push(n[e.terms[s].name]),a.push(e.terms[s].linear)}var l=e.constant,d=i.CATICDSLinearEquation.Create(o,r,a,l)}return d?(d.SetName(e.name),d.SetTolerance(e.tolerance),0):(console.log("error creating equation"),1)},this.LoadProfile=function(e,i,r,n){var s=i.objects[e];if(void 0===s.subElements||void 0===s.vertices)return console.log("error loading profile"),null;if("undefined"!==s.sketch){if(profileSk=a[s.sketch],"undefined"==typeof profileSk)return console.log("error loading profile sketch"),null;n.SetSketch(profileSk)}for(var l=n.GetFactory(),c=[],v=[],u=0;u<s.subElements.length;u++){var g=s.subElements[u].name,S=o[g];d=g;var C=i.objects.findIndex(checkName);if(C<0)return null;if(void 0===S&&(S=this.LoadObject(C,i,r,n)),null===S)return console.log("error loading profile"),null;if(c.push(S),v.push(s.subElements[u].orientation),!this.LoadConstraintsWithIndexCondition(C,i,r,n))return null}var f=[];for(u=0;u<s.vertices.length;u++){var m=o[s.vertices[u].name];d=s.vertices[u].name;var p=i.objects.findIndex(checkName);if(p<0)return null;if(void 0===m&&(m=this.LoadObject(p,i,r,n)),null===m)return console.log("error loading profile"),null;if(f.push(m),!this.LoadConstraintsWithIndexCondition(p,i,r,n))return null}var h=s.closed,D=r.CATICDSProfile2D.Create(l,c,f,v,h);if(!D)return console.log("error creating profile"),null;if("autotrim"==s.selfIntersectionMode&&D.SetSelfIntersectionMode(r.CATCDSSelfIntersectionMode.simAUTOTRIM),void 0!==s.rigidSet){if(void 0===t[s.rigidSet])return console.log("error adding a profile to a rigid set"),null;t[s.rigidSet].AddGeometry(D)}return void 0!==s.segment&&D.SetTrimmingInfo(s.segment),D},this.LoadOffsetConstraint=function(e,i,t){if("undefined"==e.name||"undefined"==e.base||"undefined"==e.offset||"undefined"==e.variables)return console.log("error loading offsetConstraint"),1;var r=t.GetFactory(),a=o[e.base],s=o[e.offset];if(!a||!s)return console.log("error loading offsetConstraint profiles"),1;var l=n[e.variable];if(!l)return console.log("error loading offsetConstraint variable"),1;var d=i.CATICDSOffsetConstraint.Create(r,a,s,l);return d?(void 0!==e.variables&&d.SetBorderVerticesAlignment(!0),void 0!==e.softness&&t.SetConstraintStiffness(d,e.softness),d.SetName(e.name),0):(console.log("error creating offsetConstraint"),1)},this.LoadOption=function(e,i,t){return void 0===e.CDSLevel||void 0===e.outputMode||void 0===e.linearTolerance||void 0===e.angularTolerance||void 0===e.dynamicMoveMode||void 0===e.diagnosticsMode||void 0===e.DOFMode||void 0===e.partialSolvingMode||void 0===e.solvingMode||void 0===e.preserveChiralityMode||void 0===e.overdefinedDiagnosticsMode||void 0===e.varDependencyMode||void 0===e.updateMode||void 0===e.rigidSetDiagnosticsMode||void 0===e.initialDataOnInconsistentGeomComponentMode?(console.log("error loading options"),1):("rootElements"==e.outputMode?t.SetOutputMode(i.CATCDSOutputMode.omCALLBACK_ROOT_ELEMENTS):"allElements"==e.outputMode&&t.SetOutputMode(i.CATCDSOutputMode.omCALLBACK_ALL_ELEMENTS),t.SetTolerances(e.linearTolerance,e.angularTolerance),"standard"==e.dynamicMoveMode?t.SetDynamicMoveMode(i.CATCDSMoveMode.mmSTANDARD):"perturbation"==e.dynamicMoveMode?t.SetDynamicMoveMode(i.CATCDSMoveMode.mmPERTURBATION):"minimum"==e.dynamicMoveMode?t.SetDynamicMoveMode(i.CATCDSMoveMode.mmMINIMUM_MOVE):"accurate"==e.dynamicMoveMode&&t.SetDynamicMoveMode(i.CATCDSMoveMode.mmACCURATE_MOVE),"always"==e.diagnosticsMode?t.SetDiagnosticsMode(i.CATCDSDiagMode.dmALWAYS):"notoverdefined"==e.diagnosticsMode?t.SetDiagnosticsMode(i.CATCDSDiagMode.dmNOTOVERDEFINED):"never"==e.diagnosticsMode?t.SetDiagnosticsMode(i.CATCDSDiagMode.dmNEVER):"notsolved"==e.diagnosticsMode?t.SetDiagnosticsMode(i.CATCDSDiagMode.dmNOTSOLVED):"oldAlways"===e.diagnosticsMode&&t.SetDiagnosticsMode(i.CATCDSDiagMode.dmOLDALWAYS),"full"==e.DOFMode?t.SetDegreesOfFreedomMode(i.CATCDSDOFMode.dmFULL):"withoutDOS"==e.DOFMode&&t.SetDegreesOfFreedomMode(i.CATCDSDOFMode.dmWITHOUTDOS),"always"==e.partialSolvingMode?t.SetPartialSolvingMode(i.CATCDSPartialSolvingMode.psALWAYS):"fail_if_inconsistent"==e.partialSolvingMode&&t.SetPartialSolvingMode(i.CATCDSPartialSolvingMode.psFAIL_IF_INCONSISTENT),"standard"==e.solvingMode?t.SetSolvingMode(i.CATCDSSolvingMode.slSTANDARD):"minimumMove"==e.solvingMode&&t.SetSolvingMode(i.CATCDSSolvingMode.slMINIMUM_MOVE),"free"==e.preserveChiralityMode?t.SetPreserveChiralityMode(i.CATCDSChiralityMode.cmFREE):"keep"==e.preserveChiralityMode&&t.SetPreserveChiralityMode(i.CATCDSChiralityMode.cmKEEP),"dimensional"==e.overdefinedDiagnosticsMode?t.SetOverdefinedDiagnosticsMode(i.CATCDSOverdefinedDiagMode.odDIMENSIONAL):"full"==e.overdefinedDiagnosticsMode&&t.SetOverdefinedDiagnosticsMode(i.CATCDSOverdefinedDiagMode.odFULL),"never"==e.varDependencyMode?t.SetVarDependencyMode(i.CATCDSVarDepMode.vmNEVER):"solved"==e.varDependencyMode&&t.SetVarDependencyMode(i.CATCDSVarDepMode.vmSOLVED),"evaluate"==e.updateMode?t.SetUpdateMode(i.CATCDSUpdateMode.umEVALUATE):"reevaluate"==e.updateMode?t.SetUpdateMode(i.CATCDSUpdateMode.umREEVALUATE):"evalTransform"==e.updateMode&&t.SetUpdateMode(i.CATCDSUpdateMode.umEVALTRANSFORM),"withoutDOS"==e.rigidSetDiagnosticsMode?t.SetRigidSetDiagnosticMode(i.CATRigidSetDiagMode.rdWITHOUTDOS):"full"==e.rigidSetDiagnosticsMode?t.SetRigidSetDiagnosticMode(i.CATRigidSetDiagMode.rdFULL):"extraDof"==e.rigidSetDiagnosticsMode&&t.SetRigidSetDiagnosticMode(i.CATRigidSetDiagMode.rdEXTRADOF),void 0!==e.new3DRigidificationHeuristic&&(0==e.new3DRigidificationHeuristic?t.UseNew3DRigidificationHeuristic(!1):t.UseNew3DRigidificationHeuristic(!0)),void 0!==e.checkUnsolvableConstraintsMode&&(0==e.checkUnsolvableConstraintsMode?t.SetCheckUnsolvableConstraintsMode(!1):t.SetCheckUnsolvableConstraintsMode(!0)),void 0!==e.preprocessKinematicsChains&&(0==e.preprocessKinematicsChains?t.PreprocessKinematicsChains(!1):t.PreprocessKinematicsChains(!0)),t.SetInitialDataOnInconsistentGeomComponentMode(e.initialDataOnInconsistentGeomComponentMode),void 0===e.adaptiveMove?t.SetAdaptiveMove(!1):t.SetAdaptiveMove(e.adaptiveMove),t.SetPerturbationMove(!1),t.SetAccurateMove(!1),0)},this.LoadMovingEntity=function(e,i,r){if(void 0===e.name)return console.log("error loading moving entity"),1;let d=e.name;var v=o[d];if(void 0===v&&void 0===(v=a[d])&&void 0===(v=t[d])&&void 0===(v=n[d]))return console.log("error creating moving entity"),1;var u,g=e.vector,S=e.matrix;if(void 0!==g&&void 0!==S)if(!0===e.transfo2D)u=[S.line0,S.line1],v.SetDynamicMove2D(u,g);else{u=[S.line0,S.line1,S.line2];let t=e.pickingPoint;if(t)if(v.GetType()===i.CATCDSType.tpRIGIDSET)if(void 0!==t.coords.x||void 0!==t.coords.y||void 0!==t.coords.z){let e=r.GetFactory(),n=i.CATICDSPoint.Create(e,t.coords.x,t.coords.y,t.coords.z);v.AddGeometry(n),n.SetName(d),o[d]=n,c.set(v,n),n.SetDynamicMove(u,g),console.log("New picking point is moved")}else console.warn("error loading picking point"),v.SetDynamicMove(u,g);else console.log("Existing picking point is moved"),v.SetDynamicMove(u,g);else v.SetDynamicMove(u,g),console.log("RS is moved")}var C=0,f=0,m=!1;if(void 0!==e.moveMajorRadius&&(C=e.moveMajorRadius,m=!0),void 0!==e.moveMinorRadius&&(f=e.moveMinorRadius,m=!0),m&&v.MoveRadii(C,f),void 0!==e.moveValue&&(s.push(v),l.push(e.moveValue)),void 0!==e.moveByLineOrigin&&void 0!==e.moveByLineDirection){var p=[e.moveByLineOrigin.x,e.moveByLineOrigin.y,e.moveByLineOrigin.z],h=[e.moveByLineDirection.x,e.moveByLineDirection.y,e.moveByLineDirection.z];r.SetDynamicMove(v,p,h)}return 0},this.LoadMovedEntity=function(e,i,t){if(void 0===e.name||void 0===e.matrix||void 0===e.vector)return console.log("error loading moved entity"),1;var r=o[e.name];if(void 0===r)return 1;var n=[[],[]];n[0][0]=e.matrix.line0[0],n[0][1]=e.matrix.line0[1],n[1][0]=e.matrix.line1[0],n[1][1]=e.matrix.line1[1];var a=e.vector;return t.SetAppliedTransformation2D(r,n,a),void 0!==e.parameters&&t.SetPreviousRadii(r,e.parameters[0],e.parameters[1]),0},this.CleanTemporaryGeometries=function(){if(void 0!==c)for(const[e,i]of c)if(e&&i){let t=i.GetName();e.RemoveGeometry(i),delete o[t]}}}})),define("DS/CATSolverCDSWeb/CATSolverCDSSolver",["DS/CATCDSJS/CATCDS","DS/CATSolverCDSWeb/CATSolverCDSResultGenerator","DS/CATSolverCDSWeb/CATSolverCDSLoader","DS/MathematicsES/MathsDef"],(function(e,i,t,o){"use strict";return function(){this._originalJSON=null,this._currentJSON=null,this._cdsSolver=e.CATICDSAdvanced.Create(),null===this._cdsSolver?console.error("CDS solver could not be instantiated."):this._cdsSolver.Run(),this._moveType="undefined",this.initialize=function(e){this._originalJSON=JSON.parse(e),this._currentJSON=JSON.parse(e),void 0===this._originalJSON.data[0].name&&(this._originalJSON.data[0].name="xDesign",this._currentJSON.data[0].name="xDesign"),this._currentJSON.data[0].options.dynamicMoveMode="minimum"},this.load=function(){0!==t.LoadJSONFile(this._currentJSON.data[0],e,this._cdsSolver)&&console.warn("error occured during loading of "+this._currentJSON.data[0].name)},this.isSolveSupported=function(){return 0===this._currentJSON.data[0].JSONstreamStatus.status},this.clean=function(){t.CleanTemporaryGeometries(),this._currentJSON=JSON.parse(JSON.stringify(this._originalJSON)),e.CATICDSAdvanced.Remove(this._cdsSolver)},this.setMovingEntity=function(e,i){if(!this._currentJSON||!this._currentJSON.data)return;const o=this._currentJSON.data[0];if(!o)return void console.warn("solver doesn't contain data.");t.CleanTemporaryGeometries();let r=this.getRigidSetByUsername(e);if(r){let e=[{name:r.name,userName:r.userName,pickingPoint:null}];if(i){let t={coords:{x:i[0],y:i[1],z:i[2]},id:0,name:"pickingPoint",rigidSet:r.name,type:"point"};o.objects.length===this._originalJSON.data[0].objects.length?o.objects.push(t):o.objects[o.objects.length-1]=t,e[0].pickingPoint=t}o.movingEntities=e}else{for(const t of o.rigidsets){let r=e.split("\\u0005");for(let e=r.length-1;e>=0;e--){let n=r[e];if(t.userName===n){let e=[{name:null,userName:t.userName,pickingPoint:null}];if(i){e[0].name=t.name;let r={coords:{x:i[0],y:i[1],z:i[2]},id:0,name:"pickingPoint",rigidSet:t.name,type:"point"};o.objects.length===this._originalJSON.data[0].objects.length?o.objects.push(r):o.objects[o.objects.length-1]=r,e[0].pickingPoint=r}else e[0].name=t.name;return void(o.movingEntities=e)}}}console.warn("instance to move not found in solver's data.")}},this.setTarget=function(i){let o=this._currentJSON.data[0];if(o.movingEntities&&o.movingEntities.length&&this._cdsSolver){if("movebytransfo"===this._moveType){let e=[i.matrix[9],i.matrix[10],i.matrix[11]],t={line0:[i.matrix[0],i.matrix[3],i.matrix[6]],line1:[i.matrix[1],i.matrix[4],i.matrix[7]],line2:[i.matrix[2],i.matrix[5],i.matrix[8]]};o.movingEntities[0].matrix=t,o.movingEntities[0].vector=e,delete o.movingEntities[0].moveByLineDirection,delete o.movingEntities[0].moveByLineOrigin}else{if("movebyray"!==this._moveType)return void console.warn("unsupported move type.");{let e={x:i.line[0],y:i.line[1],z:i.line[2]},t={x:i.line[3],y:i.line[4],z:i.line[5]};o.movingEntities[0].moveByLineDirection=t,o.movingEntities[0].moveByLineOrigin=e,delete o.movingEntities[0].matrix,delete o.movingEntities[0].vector}}this._cdsSolver.Reset(),0!==t.LoadMovingEntity(o.movingEntities[0],e,this._cdsSolver)&&console.warn("error occured during loading of moving entity of "+o.name);let r=[],n=[];this._cdsSolver.SetTargetValues(r,n)}else console.warn("moving entity not found in solver.")},this.setMoveType=function(e){this._moveType=e},this.getMoveType=function(){return this._moveType},this.getRigidSetByName=function(e){return this._currentJSON.data[0].rigidsets.find((i=>i.name===e))},this.getRigidSetByUsername=function(e){return this._currentJSON.data[0].rigidsets.find((i=>i.userName===e))},this.run=function(){let t=[],r=new i(this._currentJSON,this._cdsSolver,e);if(0===r.rc){let e=[],i=r.ObtainedOutputs.JSONOutputs;if(i.length>0){e=i[0].bodyTransformations.map((e=>e))}for(const i of e){let e=this.getRigidSetByName(i.name),r=e?e.userName:"",n=new DSMath.Matrix3x3(i.matrix.line0[0],i.matrix.line0[1],i.matrix.line0[2],i.matrix.line1[0],i.matrix.line1[1],i.matrix.line1[2],i.matrix.line2[0],i.matrix.line2[1],i.matrix.line2[2]),a=new DSMath.Vector3D(i.vector[0],i.vector[1],i.vector[2]),s=new o.Transformation(n,a);t.push({path:r,transfo:s})}}return{results:t,status:r.rc}},this.getRigidSetFromJson=function(e){let i=null;if(!this._currentJSON||!this._currentJSON.data)return void console.warn("getRigidSetFromJson failed | solver doesn't contain data.");const t=this._currentJSON.data[0];if(t){if(i=this.getRigidSetByUsername(e),!i)for(const o of t.rigidsets){let t=e.split("\\u0005");for(let e=t.length-1;e>=0;e--){let r=t[e];if(o.userName===r)return i=o,i}}if(i)return i;console.warn("getRigidSetFromJson failed | Instance to Fix not found in ProductCDS.json.")}else console.warn("getRigidSetFromJson failed | solver doesn't contain data.")},this.fixRigidSet=function(i,t){let o=this.getRigidSetFromJson(i);if(!o)return console.warn("fixRigidSet failed | Instance to Fix not found in ProductCDS.json."),!1;if(o){let i=o.name;if(i){let o=this._cdsSolver.GetEntities(e.CATCDSType.tpRIGIDSET);for(var r=0;r<o.length;r++){let e=o[r];if(e){let o=null;if(o=e.GetName(),i===o)return t&&e.IsFixed()?(console.log("fixRigidSet | RS is already fixed."),!1):(e.FixToggle(),!0)}}console.warn("fixRigidSet failed | Instance to Fix not found in solver's data.")}}return!1}}}));