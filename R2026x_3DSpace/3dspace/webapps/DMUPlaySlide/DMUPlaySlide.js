define("DS/DMUPlaySlide/DMUSlideImport",["UWA/Class","UWA/Utils","DS/DMUBaseExperience/EXPUtils"],(function(e,t,i){"use strict";return e.extend({init:function(e){let n,a,s,l;function r(e,t,n,a){let s;if(e&&t){let l=e.getParameters();if(l){s={};for(let r=0;r<l.length;r++){let o=l[r];if(o.JSONname&&(!n||n&&o.isOverloadable)){let n=t,l=o.JSONname.split(".");for(;void 0!==n;){0===l.length&&(s[o.name]=i.strToType(n,o.type),a&&e.setNominalAttribute(o.name,s[o.name])),n=n[l.shift()]}}}}}return s}this.importData=function(t,i,r,o,g){if(s=o,l=g,t&&i&&e){if(i.fillObjectAttributes(e,t,r),n=t.EnvironmentOverload||{},a=t.ObjectOverloads||[],t.ApplicativeContext){let i=Object.keys(t.ApplicativeContext);for(let n=0;n<i.length;n++)e.setSlideApplicativeContext(i[n],t.ApplicativeContext[i[n]])}i.registerForPostImport(e)}},this.afterImport=function(i){if(e){let o=e.getAttribute("lDMUObjects")||[],g=!1;for(let e=o.length-1;e>=0;e--)o[e]&&o[e].getType||(o.splice(e,1),g=!0);g&&e.setAttribute("lDMUObjects",o);let d=function(e,t){if(e&&"object"==typeof e){if(e.hasOwnProperty(t))return!0;let i=Object.keys(e);for(let n=0;n<i.length;n++)if(d(e[i[n]],t))return!0}};if(n){let t=e.getParent().getParent();e.updateEnvironmentOverload({target:t.getEnvironment(),state:r(t.getEnvironment(),n.state,!0)})}let u=e.getDMUObjects(),D=[],c=[];if(!l&&a){let t,i=e.getParent().getOccurrenceOverloaders();a.forEach((function(n){let a,l=!1;for(a=0;a<i.length;a++)if(i[a].getAttribute("sID")===n.targetId){e.addObjectOverload({target:i[a],state:r(i[a],n.state,!0)}),l=!0;break}if(s&&!l)for(a=0;a<u.length;a++)if(u[a].getAttribute("sID")===n.targetId){D.push(n.targetId),c.push(n),t=r(u[a],n.state,!1,!0),void 0===t.bVisible&&u[a].setNominalAttribute(!1);break}}))}if(l)e.setAttributes([{name:"sID",value:e.getParent().computeNewID()},{name:"sUuid",value:t.getUUID()}]);else if(s)for(let t=0;t<u.length;t++){let i=D.indexOf(u[t].getAttribute("sID"));-1!==i&&(d(c[i],"visible")||d(c[i],"Visible"))||u[t].setNominalAttribute("bVisible",!1),u[t].setNominalAttribute("sID",e.getParent().computeNewID())}e.fireEvent("onDMUObjectInitialized",{dmuObject:e,dmuCont:e.getParent(),mkpRepRef:i})}}}})})),define("DS/DMUPlaySlide/controllers/DMUSlideShowController",["UWA/Class","DS/CATWebUXSlideShow/CATWebUXSlideShowController","DS/DMUBaseUIControllers/DMUSlidesController","DS/DMUBaseUIControllers/DMUCommentsController","DS/DMUBaseUIControllers/DMUReviewController","DS/DMUBaseExperience/DMUContextManager","DS/DMUBaseUIControllers/DMUApplicativeContextManager","DS/DMUBaseExperience/EXPManagerSet","DS/Selection/CSOManager","DS/Selection/HSOManager","DS/Selection/PSOManager","DS/WebappsUtils/WebappsUtils","i18n!DS/DMUPlaySlide/assets/nls/DMUPlaySlide"],(function(e,t,i,n,a,s,l,r,o,g,d,u,D){"use strict";return e.extend({init:function(e){this._parent(e);var c=(e||{}).context,m=r.getManager({name:"DMU2DSheetManager",context:c.getFrameWindow()}),f=u.getWebappsAssetUrl("DMUPlaySlide","icons/32/")+"I_DMU_Slide.png",p=t.getSlideShowController({context:c.getFrameWindow(),id:"DMU3DMarkupSlideShow"});p.setListOfCommandsAllowed(["LockUnlockSectionHdr","DMUPreviousCommentCmdHdr","DMUNextCommentCmdHdr","WebDocumentFitAllInCmdHdr","WebDocumentFitWidthCmdHdr","WebDocumentPreviousPageCmdHdr","WebDocumentNextPageCmdHdr"]);var h,b,M,v,U=[],S=s.giveEventsController({viewer:c.getViewer()});function O(e){var t=s.getReviewContext({context:c}),n=t?t.getValidation():null;if(e.slideData){var a=i.giveDMUSlidesController({context:c.getFrameWindow()});if(a){if(n){var l=e.slideData.slide?e.slideData.slide.getParent().getMarkupOwner():null,r=a.getActiveSlide(),o=r?r.getParent().getMarkupOwner():null;l&&o&&l.getPlmID()!==o.getPlmID()&&n.setCurrentMarkup(l);var g=t.getCurrentSessionMarkup().getSlides(),d=g[0].getAttribute("sID"),u=g[g.length-1].getAttribute("sID"),m=e.slideData.slide?e.slideData.slide.getAttribute("sID"):"";if(l)if(m===d){var h=n.getPreviousRepRef(l.getPlmID());h.isLoaded()||(S.fireEvent("onReplyExpandRequest",{data:{id:h.getPlmID()}}),n.setCurrentMarkup(l))}else if(m===u){var b=n.getNextRepRef(l.getPlmID());b.isLoaded()||(S.fireEvent("onReplyExpandRequest",{data:{id:b.getPlmID()}}),n.setCurrentMarkup(l))}}a.setActiveSlide(e.slideData.slide),p.displaySlideInformation({icon:f,message:e.slideData.slide?e.slideData.slide.getAttribute("sName")+" ("+e.slideData.index+" / "+e.slideData.nbSlides+") ":D.nominalSlide,secondary:n?n.getCurrentMarkup().getName():t?t.getCurrentSessionMarkup().getAttribute("sName"):void 0})}}else if(e.elementData){var M,v;if("page"===e.elementData.type)v=e.elementData.visibleElements.length>1?e.elementData.visibleElements[0].number+", "+e.elementData.visibleElements[1].number:e.elementData.visibleElements[0].number,M=D.page+" "+v+" "+D.of+" "+e.elementData.elementLength;else"requirement"===e.elementData.type&&(M=e.elementData.visibleElements[0].title);p.displaySlideInformation({fontIcon:"wux-ui-3ds-docs",message:M,secondary:n&&n.getCurrentMarkup()?n.getCurrentMarkup().getName():""})}}function y(){var e=null,t=s.getReviewContext({context:c});if(t){var i=t.getValidation();if(i){e=[];for(var n=i.getLoadedRepRefs(),a=0;a<n.length;a++)n[a].getMarkupContent()&&(e=e.concat(n[a].getMarkupContent().getSlides()))}else e=t.getCurrentSessionMarkup().getSlides()}return e}function C(e){if(m&&m.isADocumentDisplayed()&&("Document"===m.getDocumentType()||"Requirement"===m.getDocumentType()))m.centerViewpointAtNextOrPreviousElement("next"===e),O({elementData:m.getElementsVisualizationData()});else{var t=i.giveDMUSlidesController({context:c.getFrameWindow()});if(t){for(var n=y(),a=t.getActiveSlide(),s=0;s<n.length;s++){var l=n[s].getParent().getMarkupOwner(),r=null,o=!0;if(a&&(r=a.getParent().getMarkupOwner()),l&&r&&(o=l.getPlmID()===r.getPlmID()),a&&n[s].getAttribute("sID")===a.getAttribute("sID")&&o)return void("next"===e?s<n.length-1?O({slideData:{slide:n[s+1],index:s+2,nbSlides:n.length}}):O({slideData:{slide:n[0],index:1,nbSlides:n.length}}):O(s>0?{slideData:{slide:n[s-1],index:s,nbSlides:n.length}}:{slideData:{slide:n[n.length-1],index:n.length,nbSlides:n.length}}))}O("next"===e?{slideData:{slide:n[0],index:1,nbSlides:n.length}}:{slideData:{slide:n[n.length-1],index:n.length,nbSlides:n.length}})}}}p.subscribe("onPreviousSlideCB",(function(){C("previous")})),p.subscribe("onNextSlideCB",(function(){C("next")})),p.subscribe("onFirstSlideCB",(function(){if(!m||!m.isADocumentDisplayed()||"Document"!==m.getDocumentType()&&"Requirement"!==m.getDocumentType()){var e=y();O({slideData:{slide:e[0],index:1,nbSlides:e.length}})}})),p.subscribe("onLastSlideCB",(function(){if(!m||!m.isADocumentDisplayed()||"Document"!==m.getDocumentType()&&"Requirement"!==m.getDocumentType()){var e=y();O({slideData:{slide:e[e.length-1],index:e.length,nbSlides:e.length}})}})),p.subscribe("onActiveStateModified",(function(e){var t,r,u,D,f=s.getReviewContext({context:c}),C=m&&m.isADocumentDisplayed()&&("Document"===m.getDocumentType()||"Requirement"===m.getDocumentType()),F=c&&c.getRoots().some((e=>!!e.userData&&"FailureModesEffectsAnalysis"===e.userData.type));if(C){let t=n.giveDMUCommentsController({context:c.getFrameWindow()});u=a.giveDMUReviewController({context:c.getFrameWindow()}),t&&(t.setVisibleFlag(!e.state),t.setPresentationModeFlag(e.state),u&&u.setVisibleFlag(!e.state)),m&&(e.state||(h&&S.removeEvent(h),h=null),m.setCurrentPageWidgetVisibleFlag(!e.state),m.setMultiPageVisibility(e.state),m.setBookmarksVisibility(!e.state),"Document"===m.getDocumentType()&&m.enableTextSelection(!e.state))}else if(F){let t=n.giveDMUCommentsController({context:c.getFrameWindow()});u=a.giveDMUReviewController({context:c.getFrameWindow()}),t&&(t.setVisibleFlag(!e.state),t.setPresentationModeFlag(e.state),u&&u.setVisibleFlag(!e.state))}else{if(t=y(),u=a.giveDMUReviewController({context:c.getFrameWindow()}),!(r=i.giveDMUSlidesController({context:c.getFrameWindow()})))return void p.setActiveState(!1);if(r.setVisibleFlag(!e.state),!u)return void p.setActiveState(!1);u.setVisibleFlag(!e.state);let s=n.giveDMUCommentsController({context:c.getFrameWindow()});s&&(s.setVisibleFlag(!e.state),s.setPresentationModeFlag(e.state))}if(e.state){var A=C||F||null!=t&&t.length>0;let i=!F;if(e.onBeginSlideShow(A,i),!A)return;o.empty(),g.empty(),d.empty(),f&&(b=f.isReadOnly(),f.setReadOnly(!0),f.getCurrentSessionMarkup()&&!f.getCurrentSessionMarkup().isVisible()&&f.getCurrentSessionMarkup().setVisibleFlag(!0)),M=!!m&&m.getReviewPlayMode(),m&&(m.setReviewPlayMode(!0),m.setNavBarVisibleFlag(!1));var x=l.giveDMUApplicativeContextManager({context:c}),P=x?x.getApplicativeControllers():[];for(D=0;D<P.length;D++)U.push({ctx:P[D],minimalFlag:P[D].getMinimalUIFlag?P[D].getMinimalUIFlag():void 0}),P[D].setMinimalUIFlag&&(P[D].setMinimalUIFlag(!0),P[D].setAnnotationUIVisibleFlag&&P[D].setAnnotationUIVisibleFlag(!1));var j=c.getViewer();if(v={activated:j.getManipulators(),preActivate:j.manipulatorManager.preActivation},j.setManipulators({activated:!1,preActivate:!0}),!F)if(C)O({elementData:m.getElementsVisualizationData()}),h=S.addEvent("onCurrentElementChanged",(function(){O({elementData:m.getElementsVisualizationData()})}));else if(r){var I=r.getActiveSlide();if(I){for(D=0;D<t.length;D++)if(t[D].getAttribute("sID")===I.getAttribute("sID")){O({slideData:{slide:I,index:D+1,nbSlides:t.length}});break}}else O({slideData:{slide:t[0],index:1,nbSlides:t.length}})}}else{for(D=0;D<U.length;D++)void 0!==U[D].minimalFlag&&(U[D].ctx.setMinimalUIFlag(U[D].minimalFlag),U[D].ctx.setAnnotationUIVisibleFlag&&U[D].ctx.setAnnotationUIVisibleFlag(!U[D].minimalFlag));U.length=0,m&&(m.setReviewPlayMode(M),m.setNavBarVisibleFlag(!0)),f&&(f.setReadOnly(b),!b&&f.getCurrentSessionMarkup()&&f.getCurrentSessionMarkup().getCurrentSlide()&&f.getCurrentSessionMarkup().getCurrentSlide().getPointedFormats().length&&f.getCurrentSessionMarkup().getCurrentSlide().getPointedFormats()[0].setReadOnly(!0)),c.getViewer().setManipulators(v)}})),this.clean=function(){t.unreferenceSlideShowController({context:c.getFrameWindow(),id:"DMU3DMarkupSlideShow"}),p=null},this.getActiveState=function(){return p?p.getActiveState():null},this.setActiveState=function(e){p&&p.setActiveState(e)},this.subscribe=function(e,t){return p?p.subscribe(e,t):null},this.unsubscribe=function(e){p&&p.unsubscribe(e)}}})})),define("DS/DMUPlaySlide/DMUFormat",["require","exports","DS/Visualization/Node3D","DS/DMUPlaySlide/DMUSlideImport","DS/DMUBaseExperience/DMUContextManager","DS/DMUBaseExperience/DMUObject","DS/DMUBaseExperience/EXPUtils"],(function(e,t,i,n,a,s,l){"use strict";let r=[{name:"sType",type:"string",JSONname:"type",defaultValue:"Format"},{name:"sID",type:"string",JSONname:"id"},{name:"sUuid",type:"string",JSONname:"uuid"},{name:"sName",type:"string",JSONname:"Name"},{name:"sDescription",type:"string",JSONname:"Description"},{name:"sImageType",type:"string",JSONname:"imgData.type"},{name:"sImageData",type:"string",JSONname:"imgData.data"},{name:"bInWork",type:"boolean",JSONname:"InWork"},{name:"lDMUObjects",type:"listObjects",JSONname:"DMUObjects",defaultValue:[]},{name:"mRelativePosMatrix",type:"Matrix4",JSONname:"RelativePosMatrix"},{name:"sPointedReference",type:"string",JSONname:"PointedReference"},{name:"sImageURL",type:"ImageURL",JSONname:"ImageURL"}];return class extends s{constructor(e,t){super(e,t),this.addParameters(r);let s,o=this,g={},d=[];this.initAuthoringData=function(){-1!==a.getAuthoringFeatureTypes().indexOf("Slide")&&(-1===a.getAuthoringFeatureTypes().indexOf("Slide")||o.getContextualMenuCommandList||window.require(["DS/DMUFormatEdition/DMUFormatContextualBar"],(function(e){var i;s=new e,o.getContextualMenuCommandList=s.getContextualMenuCommandList,o.getSharedContextualMenuCommandList=s.getSharedContextualMenuCommandList,s.register({frmWindow:o.getFrameWindow(),type:o.getType(),experience:(null===(i=t.getParent())||void 0===i?void 0:i.getValidation())?"review":"markup"})})))},this.removeAuthoringData=function(){var e;-1!==a.getAuthoringFeatureTypes().indexOf("Slide")&&(o.getSharedContextualMenuCommandList=null,o.getContextualMenuCommandList=null,s&&s.unregister({frmWindow:o.getFrameWindow(),type:o.getType(),experience:(null===(e=t.getParent())||void 0===e?void 0:e.getValidation())?"review":"markup"}))};let u=new n(o);this.importData=u.importData,this.afterImport=u.afterImport,this.initAuthoringData();let D=new i(this);D.getDMUType=this.getType,this.setNode(D),this.getPreview=function(){let e=o.getAttribute("sImageURL");if(e)return e;let t=o.getAttribute("sImageType"),i=o.getAttribute("sImageData");return t&&i?l.getImageDataUrl(t,i):void 0};let c=this.remove;this.remove=function(){let e,t=o.getAttribute("lDMUObjects")||[];for(e=t.length-1;e>=0;e--)t[e].getNode()&&o.getNode().removeChild(t[e].getNode());if(c(),d)for(e=0;e<d.length;e++)d[e].state={},d[e].target.refreshNode();u=d=g=null},this.areSectionPlanesDisplayed=function(){let e;if(o.getActiveFlag()&&o.isVisible()&&o.isDisplayed()){let t=o.getDMUObjects("DMUSection");for(e=0;e<t.length;e++)if(t[e].isSectionDisplayed())return!0;let i=o.getDMUObjects("DMUClipping");for(e=0;e<i.length;e++)if(i[e].isSectionDisplayed())return!0}return!1};let m,f=this.refreshNode;this.refreshNode=function(){let e;if(o.getNode()&&!t.isImporting()){o.getNode().setName(o.getAttribute("sName"));let t=o.getActiveFlag()&&o.isDisplayed()&&o.isVisible();if(o.getNode().setVisibility(t),o.getNode().setVisibilityFree(!t),d){for(e=0;e<d.length;e++)d[e].target.refreshNode();o.fireEvent("onDMUSlideOrFormatOverloadsRefreshRequired",{dmuObject:o})}let i=o.getAttribute("lDMUObjects")||[];for(e=0;e<i.length;e++)(t||"DMUSection"===i[e].getType()||"DMUClipping"===i[e].getType()||-1!==i[e].getType().indexOf("DMUCompare"))&&i[e].refreshNode();o.fireEvent("onDMUSlideOrFormatRefreshRequired",{dmuObject:o}),f()}},this.addDMUObject=function(e){o.set({attribute:"lDMUObjects",value:e,mode:"addValue"}),e.getNode()&&o.getNode().addChild(e.getNode()),("DMUMarker3DSpline"===e.getType()||"DMUMarker3DCloud"===e.getType()||"DMUMarker3DFreehand"===e.getType())&&g&&g.state&&e.updateProjectionPlaneDefinition({up:g.state.vViewpointUp,right:g.state.vViewpointRight}),e.setDisplayedFlag(o.isDisplayed()),o.fireEvent("onDMUObjectAddedInObject",{dmuObject:e,parentObject:o})},this.getDMUObjects=function(e){let t=[],i=o.getAttribute("lDMUObjects")||[];for(let n=0;n<i.length;n++)!e||e&&i[n]&&i[n].getType()===e?t.push(i[n]):i[n].getDMUComments&&"DMUComment"===e&&(t=t.concat(i[n].getDMUComments()));return t},this.removeDMUObject=function(e){let t=o.getAttribute("lDMUObjects")||[];for(let i=0;i<t.length;i++)if(t[i]===e)return e.getNode()&&o.getNode().removeChild(e.getNode()),t.splice(i,1),o.setAttribute("lDMUObjects",t),e.remove(),void o.fireEvent("onDMUObjectRemovedFromObject",{dmuObject:e,parentObject:o})},this.get3DMarkers=function(){let e=o.getDMUObjects();for(let t=e.length-1;t>=0;t--)-1===e[t].getType().indexOf("Marker3D")&&-1===e[t].getType().indexOf("Measure")&&e.splice(t,1);return e},this.get2DMarkers=function(){let e=o.getDMUObjects();for(let t=e.length-1;t>=0;t--)-1===e[t].getType().indexOf("Marker2D")&&e.splice(t,1);return e},this.setSlideApplicativeContext=function(e,t){e&&(m||(m={}),m[e]=t,o.makeDirty(),o.fireEvent("onDMUObjectAttributeModified",{dmuObject:o,attrName:"oApplicativeContext",value:m}))},this.getSlideApplicativeContext=function(e){if(m)return e?m[e]:m};let p=this.setReadOnly;this.setReadOnly=function(e,t){let i,n=o.getDMUObjects();for(i=0;i<n.length;i++)n[i].setReadOnly(e,t);p(e)},this.addObjectOverload=function(e){if(e&&e.target){let t=!1;if(d){for(let i=0;i<d.length;i++)if(d[i].target===e.target){d[i].state=e.state,t=!0;break}t||d.push({target:e.target,state:e.state})}o.makeDirty(),o.fireEvent("onDMUObjectAttributeModified",{dmuObject:o,attrName:"oOccurrenceOverload",value:d})}},this.getObjectOverloads=function(){return d||[]},this.removeObjectOverload=function(e){if(d){let t=d.indexOf(e);if(t>=0){let e=d[t].target;d.splice(t,1),o.fireEvent("onDMUObjectAttributeModified",{dmuObject:o,attrName:"oOccurrenceOverload",value:d}),o.getParent().removeOccurrenceOverloaderIfNeeded(e)}}},this.updateEnvironmentOverload=function(e){g=e,o.getDMUObjects("DMUMarker3DSpline").forEach((t=>{t.updateProjectionPlaneDefinition({up:e.state.vViewpointUp,right:e.state.vViewpointRight})})),o.getDMUObjects("DMUMarker3DCloud").forEach((t=>{t.updateProjectionPlaneDefinition({up:e.state.vViewpointUp,right:e.state.vViewpointRight})})),o.getDMUObjects("DMUMarker3DFreehand").forEach((t=>{t.updateProjectionPlaneDefinition({up:e.state.vViewpointUp,right:e.state.vViewpointRight})})),o.makeDirty(),o.fireEvent("onDMUSlideEnvironmentOverloadChanged",{dmuObject:o,value:e})},this.getEnvironmentOverload=function(){return g||{}};let h=this.setActiveFlag;this.setActiveFlag=function(e){if(e===o.getActiveFlag())return;let t=o.getDMUObjects();for(let i=0;i<t.length;i++)t[i].setActiveFlag(e);h(e)};let b=this.setVisibleFlag;this.setVisibleFlag=function(e){if(e===o.isVisible())return;let t=o.getDMUObjects();for(let i=0;i<t.length;i++)t[i].setVisibleFlag(e);b(e)};let M=this.setDisplayedFlag;this.setDisplayedFlag=function(e){if(e===o.isDisplayed())return;let t=o.getDMUObjects();for(let i=0;i<t.length;i++)t[i].setDisplayedFlag(e);M(e)},this.getDMUObjectFromPathElement=function(e){if(!e)return;let t=e.getLastElement(!0);if(o.getNode()===t)return o;let i,n=o.getAttribute("lDMUObjects")||[];for(let a=0;a<n.length;a++){if(n[a].getNode&&n[a].getNode()===t)return n[a];if(n[a].getDMUObjectFromPathElement&&(i=n[a].getDMUObjectFromPathElement(e),i))return i}},this.getOverloadForTarget=function(e){if(g&&g.target===e)return g;if(d&&d.length)for(let t=0;t<d.length;t++)if(d[t].target===e)return d[t]};let v=this.setAttribute;this.setAttribute=function(e,t){"sImageData"===e&&v("sImageURL",null),v(e,t)},this.getPointedReference=function(){return o.getAttribute("sPointedReference")}}}})),define("DS/DMUPlaySlide/DMUSlide",["require","exports","DS/DMUPlaySlide/DMUFormat"],(function(e,t,i){"use strict";let n=[{name:"sPointedFormats",type:"listStrings",JSONname:"PointedFormats"},{name:"sOwner",type:"string",JSONname:"Owner"},{name:"fCreationDate",type:"float",JSONname:"CreationDate"},{name:"sParentSlideID",type:"string",JSONname:"ParentSlide"},{name:"bMarkedAsDeleted",type:"boolean",JSONname:"MarkedAsDeleted"}];return class extends i{constructor(e,t){super(e,t),this.addParameters(n),this.setAttribute("sType","Slide");let i,a=this,s=[],l=this.remove;this.remove=function(){if(a.setDisplayedFlag(!1),s){for(let e=0;e<s.length;e++)s[e].setDisplayedFlag(!1),s[e].setReadOnly(!1,!0),s[e].refreshNode();s.length=0}l()};let r=this.setReadOnly.bind(this);this.setReadOnly=function(e,t){r(a.getAttribute("bMarkedAsDeleted")||e,t)};let o=this.setAttribute;this.setAttribute=function(e,t){if("sPointedFormats"===e){let i=a.getPointedFormats().slice();s=null;for(let e=0;e<i.length;e++)i[e].setDisplayedFlag(!1),i[e].setReadOnly(!1,!0),i[e].refreshNode();s=[],o(e,t),a.fireEvent("onDMUSlideFormatListModified",{dmuObject:a})}else"bMarkedAsDeleted"===e?(a.setReadOnly(a.isReadOnly()||t),a.getDMUObjects("DMUComment").forEach((e=>e.setAttribute("bMarkedAsDeleted",t))),o(e,t)):o(e,t)},this.getPointedFormats=function(){if(!s)return[];let e=a.getAttribute("sPointedFormats");if(!s.length&&e&&e.length){let i=t.getFormats();for(let t=0;t<e.length;t++)for(let n=0;n<i.length;n++)if(i[n].getAttribute("sID")===e[t]){s.push(i[n]);break}}return s};let g=[];this.addAssociatedHighlightData=function(e){g.some((t=>t.id===e.id))||(g.push(e),a.fireEvent("onDMUSlideAssociatedToHighlight",{dmuObject:a,data:g}))},this.updateAssociatedHighlightData=function(e){const t=g.find((t=>t.id===e.id));t&&(e.rating&&(t.rating=e.rating),"hasIssue"in e&&(t.hasIssue=e.hasIssue),"hasTask"in e&&(t.hasTask=e.hasTask),a.fireEvent("onDMUSlideAssociatedToHighlight",{dmuObject:a,data:g}))},this.removeAssociatedHighlightData=function({id:e}){let t=g.findIndex((t=>t.id===e));-1!==t&&g.splice(t,1),a.fireEvent("onDMUSlideAssociatedToHighlight",{dmuObject:a,data:g})},this.getAssociatedHighlightData=function(){return g};let d=this.refreshNode;this.refreshNode=function(){if(a.getNode()&&!t.isImporting()){let e=a.getPointedFormats();if(e&&e.length){for(let t=0;t<e.length;t++)e[t].setDisplayedFlag(a.isDisplayed()),e[t].setVisibleFlag(a.isVisible()),e[t].setReadOnly(a.isVisible()&&a.isDisplayed(),!0),e[t].refreshNode();a.update3DFormatDisplayed()}d()}},this.areSectionPlanesDisplayed=function(){let e;if(a.getActiveFlag()&&a.isVisible()&&a.isDisplayed()){let t=a.getDMUObjects("DMUSection");for(e=0;e<t.length;e++)if(t[e].isSectionDisplayed())return!0;let i=a.getDMUObjects("DMUClipping");for(e=0;e<i.length;e++)if(i[e].isSectionDisplayed())return!0;let n=a.getPointedFormats();if(n&&n.length)for(let t=0;t<n.length;t++){let i=n[t].getDMUObjects("DMUSection");for(e=0;e<i.length;e++)if(i[e].isSectionDisplayed())return!0;let a=n[t].getDMUObjects("DMUClipping");for(e=0;e<a.length;e++)if(a[e].isSectionDisplayed())return!0}}return!1},this.update3DFormatDisplayed=function(){let e=a.getActiveFlag()&&a.isVisible()&&a.isDisplayed(),t=a.getPointedFormats();if(t&&t.length)for(let i=0;i<t.length;i++){let n,s=a.getDMUObjects("DMUSection"),l=t[i].getDMUObjects("DMUSection"),r=a.getDMUObjects("DMUClipping"),o=t[i].getDMUObjects("DMUClipping"),g=a.getDMUObjects("DMUCompare3D").concat(a.getDMUObjects("DMUCompare2D")),d=t[i].getDMUObjects("DMUCompare3D").concat(t[i].getDMUObjects("DMUCompare2D")),u=!1,D=!1,c=function(e,t,i){if(e.setDisplayedFlag(!t&&i.isDisplayed()),e.setVisibleFlag(!t&&i.isVisible()),e.refreshNode(),u){let t=e.getNode();u&&t&&t.clean()}};if(l.length||o.length){if(e&&(s.length||r.length)){for(n=0;n<s.length;n++)if(s[n].isSectionDisplayed()){u=!0;break}for(n=0;n<r.length;n++)if(r[n].isSectionDisplayed()){u=!0;break}}for(n=0;n<l.length;n++)c(l[n],u,t[i]);for(n=0;n<o.length;n++)c(o[n],u,t[i])}if(d.length){if(e&&g.length)for(n=0;n<g.length;n++){D=!0;break}for(n=0;n<d.length;n++)d[n].setDisplayedFlag(!D&&t[i].isDisplayed()),d[n].setVisibleFlag(!D&&t[i].isVisible()),d[n].refreshNode()}}};let u=this.setDisplayedFlag;this.setDisplayedFlag=function(e){if(e===a.isDisplayed())return;u(e);let t=a.getPointedFormats();if(t&&t.length)for(let i=0;i<t.length;i++)t[i].setDisplayedFlag(e);a.update3DFormatDisplayed()};let D=this.setVisibleFlag;this.setVisibleFlag=function(e){if(e===a.isVisible())return;D(e);let t=a.getPointedFormats();if(t&&t.length)for(let i=0;i<t.length;i++)t[i].setVisibleFlag(e);a.update3DFormatDisplayed()},this.setPreviewFlag=e=>{i=e},this.isPreview=()=>i,this.isReply=()=>Boolean(a.getAttribute("sParentSlideID"))}}}));