define("DS/IPClassifyUXUtil/views/additionalData/manipulationUnitColumns",["UWA/Core","UWA/Class","DS/IPClassifyUtil/DimensionUtils","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil"],(function(e,t,n,i){"use strict";return t.singleton({_columnsWithUnit:[],init:function(e){this._parent(e)},getName:function(){return"manipulationUnitColumns"},isAdditionalColumnsAvailable:function(e){e(!0)},getManagedColumnNames:function(e){let t=[],n=e.columns;this._columnsWithUnit=function(e){let t=[];for(var n=0;n<e.length;++n)e[n].convertInfos&&e[n].convertInfos.manipulationUnit&&e[n].convertInfos.manipulationUnit!==e[n].convertInfos.unit&&t.push(e[n]);return t}(n);for(var i=0;i<this._columnsWithUnit.length;++i)t.push(this._columnsWithUnit[i].dataIndex);return t},toBeUpdated:function(t,n){var i=!1;if(t&&0!==Object.keys(t).length){let n=Object.keys(t);if(n&&n.length>0){n=n[0];let s=function(e){let t={};for(var n=0;n<e.length;++n){let i=null,s=null;e[n].convertInfos&&(i=e[n].convertInfos.nls),e[n].convertInfos&&e[n].convertInfos.manipulationUnit&&e[n].convertInfos.manipulationUnit!==e[n].convertInfos.unit&&(s=e[n].convertInfos.manipulationNls,i=null),t[e[n].dataIndex]={unit:i,convertUnit:s||i}}return t}(this._columnsWithUnit),a=s[n],o=a?a.convertUnit:a;if(o&&t[n]){let s=t[n];!0===e.is(t[n],"array")&&(s=t[n].length>0?t[n][0]:null),s&&-1===s.indexOf(o)&&(i=!0)}}}return i},updateAttributes:function(t,s){if(!1===e.is(t,"object")||!1===e.is(t.pids,"array"))throw new Error("The object ids to modify must be specified");if(!1===e.is(s,"function"))throw new Error("A callback function should be defined");let a=this._columnsWithUnit;if(!a)return void s();let o={Data:[]};for(let e=0;e<a.length;++e){let n=a[e];o.Data[e]={},o.Data[e].Dimension=n.convertInfos.dimension,o.Data[e].UnitFrom=n.convertInfos.unit,o.Data[e].UnitTo=n.convertInfos.manipulationUnit;let i=[];t.nodes.forEach((e=>{let t=e.getAttributeValue(n.dataIndex);Array.isArray(t)?i=i.concat(t):t&&i.push(t)})),o.Data[e].Values=i.filter((e=>-1===e.indexOf(" "))),o.Data[e].Values.length>0&&(o.Data[e].Values=o.Data[e].Values.join(";"))}n.convertToPreferdUnits(o).then((function(n){if(n){var o={};for(let s=0;s<t.nodes.length;++s){let l=t.nodes[s],r=l.getID();o[r]={};for(let t=0;t<a.length;++t){let s=a[t].dataIndex,c=n[t],d=a[t].convertInfos.manipulationNls;if(c&&s&&d){let t=c.ConvertedValues;t=t?t.split(";"):null;let n=c.ValuesToConvert;if(n=n?n.split(";"):null,t&&e.is(t,"array")&&n&&e.is(n,"array")){let e=null,a=l.getAttributeValue(s);if(Array.isArray(a))e=a.map((e=>{let i=n.indexOf(e);return parseFloat(t[i])+" "+d}));else if(a){let i=n.indexOf(a);e=parseFloat(t[i])+" "+d}const c=l.getAttributeValue(s),u=Array.isArray(c)&&c.length>1;c===i.get("multipleClassificationValue")||u||(o[r][s]=e)}}}}var l={pids:o};l=JSON.stringify(l),s(l)}else s()}))}})})),define("DS/IPClassifyUXUtil/FileImportPanel",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Promise","DS/Controls/Button","DS/Windows/ImmersiveFrame","DS/Windows/Panel","DS/Windows/Dialog","DS/IPClassifyUtil/IPClassifyAlert","DS/UIKIT/Mask","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil","css!DS/IPClassifyUXUtil/IPClassifyUXUtil"],(function(e,t,n,i,s,a,o,l,r,c){"use strict";return t.extend({name:"ip-classification-import",init:function(t){this._parent(t);var n=this;n.elements.container=e.createElement("div",{class:n.getClassNames("-immersivePanel")});var i=new s({});new o({immersiveFrame:i,title:t.panelHeaderName,content:n.elements.container,autoCloseFlag:!1,height:140,width:500,minHeight:120,minWidth:365,resizableFlag:!0,modalFlag:!0,identifier:"WebUIPanelDocumentation_LibraryImportDialog",icon:t.panelHeaderIcon}).addEventListener("close",(function(e){n.options.modelEvents.publish({event:n.options.closePanelEvent,data:{restore:!0}}),n.destroy()})),n._buildBody().then(n._buildFooter.bind(n)).done((function(){n.options.modelEvents.publish({event:n.options.closePanelEvent,data:{html:i,keepOpacity:!0}})}))},destroy:function(){this._parent()},_buildBody:function(){var t=this;return new n((function(n,i){t.elements.content=e.createElement("div",{class:t.getClassNames("-content")}).inject(t.elements.container);var s={id:"IpClassifyImportFileInput"};if(t.options.accept&&(s.accept=t.options.accept),t.elements.fileController=new e.Controls.Input.File({attributes:s,button:{tag:"div",text:c.FileImportPanel_choseFile},events:{onChange:function(e){t.options.inputChanged&&t.options.modelEvents.publish({event:t.options.inputChanged,data:e.target.files[0]}),t.resetButtonEmphasize(!0)}}}).inject(t.elements.content),t.elements.fileController.getContent().setStyle("width","auto"),t.options.placeHolder){var a=t.elements.fileController.elements.content.getChildren()[0];a&&(a.setAttribute("style","opacity: 0.8; color: #b4b6ba"),a.textContent=t.options.placeHolder)}n()}))},_buildFooter:function(){var t=this;return new n((function(n,s){if(t.elements.footer=e.createElement("div",{class:t.getClassNames("-footer")}).inject(t.elements.container),t.options.validateFile){var a=t.elements.validateButton=new i({label:c.FileImportPanel_validateBtn,emphasize:"primary",touchMode:!0});a.addEventListener("buttonclick",(function(){t.processFile(!0)})),a.inject(t.elements.footer)}var o=t.elements.importButton=new i({label:t.options.importButton_label?t.options.importButton_label:c.FileImportPanel_importBtn,emphasize:t.elements.validateButton?"secondary":"primary",touchMode:!0,disabled:!(!t.options.importButton_state||"disabled"!=t.options.importButton_state)});o.addEventListener("buttonclick",(function(){t.processFile(!1)})),o.inject(t.elements.footer);var l=t.elements.closeButton=new i({label:t.options.cancelbtn_label?t.options.cancelbtn_label:c.FileImportPanel_cancelbtn,emphasize:"secondary",touchMode:!0});l.addEventListener("click",(function(){t.options.modelEvents.publish({event:t.options.closePanelEvent,data:{restore:!0}}),t.destroy()})),l.inject(t.elements.footer),n()}))},processFile:function(t,n){var i=this,s=i.elements.fileController.elements.input;if(s&&s.files||(s=document.getElementById("IpClassifyImportFileInput")),n&&(s=n),1===s.files.length){var a=s.files[0];if(e.log("File.type = "+a.type),"text/xml"===a.type||"application/x-zip-compressed"===a.type){var o=new FileReader;o.onload=function(e){if(t)r.mask(i.elements.container,i.options.validationInProgressMsg),i.options.validateFile({selectedFileContent:o.result,fileName:a.name}).then((function(e){l.displayNotification({message:e.message,className:e.success?"success":"error"}),e.success?i.resetButtonEmphasize(!1):i.resetButtonEmphasize(!0),r.unmask(i.elements.container)}));else{var n={selectedFileContent:o.result,fileName:a.name};"application/x-zip-compressed"===a.type&&(n={file:a}),i.options.modelEvents.publish({event:i.options.importFileEvent,data:n}),i.options.modelEvents.publish({event:i.options.closePanelEvent,data:{restore:!0}}),i.destroy()}},o.onerror=function(e){l.displayNotification({message:c.FileImportPanel_fileNotAccessible,className:"warning"}),i.elements.fileController.setValue(),i.resetButtonEmphasize(!0)},o.onloadend=function(){e.log("read file - onloadend !!")},o.readAsText(a)}else{var d="an XML";l.displayNotification({message:c.FileImportPanel_fileNotSupportedXML.replace("{file_type}",d),className:"warning"})}}else{d="an XML";l.displayNotification({message:c.FileImportPanel_noFileSelected.replace("{file_type}",d),className:"warning"})}},resetButtonEmphasize:function(e){var t=this;if(!t.elements.validateButton)return!0;e?(t.elements.validateButton.emphasize="primary",t.elements.importButton.emphasize="secondary"):(t.elements.validateButton.emphasize="secondary",t.elements.importButton.emphasize="primary")}})})),define("DS/IPClassifyUXUtil/private/ObjectsSearchInput",["UWA/Controls/Abstract","UWA/Class/Events","UWA/Event","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil","css!DS/IPClassifyUXUtil/IPClassifyUXUtil"],(function(e,t,n,i){"use strict";return e.extend(t,{name:"ipobjects-search-input",init:function(e){this._parent(e);this.elements.container=UWA.createElement("div",{class:this.getClassNames(e.className?e.className:"")}),this.elements.inner=UWA.createElement("div",{class:this.getClassNames("-inner")}).inject(this.elements.container);var t=UWA.createElement("div",{class:this.getClassNames("-input-container")}).inject(this.elements.inner);this.elements.input=UWA.createElement("input",{class:this.getClassNames("-input"),type:"text",placeholder:this.options.placeholder?this.options.placeholder:i.get("ObjectsSearchInput_Placeholder")}).inject(t);var n=UWA.createElement("div",{class:this.getClassNames("-right")}).inject(this.elements.inner),s=UWA.createElement("div",{class:this.getClassNames("-clear")+this.getClassNames("-btn")}).inject(n);this.elements.clearBtn=UWA.createElement("div",{class:this.getClassNames("-btnIcon wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-clear"),title:i.get("ObjectsSearchInput_ClearBtn")}).inject(s),this.elements.clearBtn.hide(),this.elements.clearBtn.addEventListener("click",this._onClearSearch.bind(this)),this.elements.input.addEventListener("keyup",this._onSearchInputKeyUp.bind(this)),this.elements.input.addEventListener("paste",this._onSearchInputPaste.bind(this)),this.elements.input.addEventListener("keydown",this._onSearchInputKeyDown.bind(this))},clear:function(e){this._onClearSearch(null,e)},_onSearch:function(e){this.elements.input.blur(),this.dispatchEvent("onSearch",{searchStr:this.elements.input.value})},_onClearSearch:function(e,t){this.elements.input.value="",this.elements.clearBtn.hide(),!0!==t&&this.dispatchEvent("onSearch",{searchStr:this.elements.input.value})},_onSearchInputKeyUp:function(e){this.elements.input.value?(this.elements.clearBtn.setStyle("display","inline-block"),this.dispatchEvent("onSearch",{searchStr:this.elements.input.value})):(this.elements.clearBtn.hide(),this.dispatchEvent("onSearch",{searchStr:this.elements.input.value}))},_onSearchInputPaste:function(e){var t=this;setTimeout(function(){t._onSearchInputKeyUp()}.bind(this),200)},_onSearchInputKeyDown:function(e){"return"===n.whichKey(e)||"Enter"===e.keyIdentifier||"return"===e.keyIdentifier?this._onSearch():"Escape"!==e.keyIdentifier&&"Escape"!=e.code||this.clear(!0),n.stopPropagation(e)}})})),define("DS/IPClassifyUXUtil/IPClassifyUXUtilities/IPSearchUtils",["UWA/Utils/InterCom","DS/Utilities/Utils","DS/IPClassifyUtil/IPSettingsMgr","DS/IPClassifyUtil/IPServicesMgr"],(function(e,t,n,i){"use strict";function s(){return"object"==typeof s.instance?s.instance:(s.instance=this,this)}return s.prototype.inAppsSearch=function(s){(n.isEmbeddedWidget()?window.parent:window).require(["UWA/Utils/InterCom"],(n=>{e=n,function(n){let s={mode:"furtive",default_with_precond:!0,widget_id:i.getWidgetId(),app_socket_id:"enosearchutils_"+i.getWidgetId(),idcard_activated:!1,tenant:i.getPlatformId()};var a=Object.assign(s,n),o=new e.Socket(a.app_socket_id,{dispacthRetryInterval:0});!0===n.debug_mode&&o.setDebugMode(!0);UWA.is(n.parent_window)?o.subscribeServer("SearchComServer",window):o.subscribeServer("SearchComServer"),o.dispatchEvent("RegisterContext",a),UWA.is(n.context_name)&&(a.context_title=n.context_name);a.default_search_criteria=n.fts_value,o.dispatchEvent("InContextSearch",a);var l,r=[];o.addListener("InContextSearch_Response",(function(e){e,r=e.selected_objects,l=e.selected_command}));var c=t.debounce((function(e){if("in_app_ok"===l)n.callback.call(null,r);else n.cancel&&n.cancel.call(null);o.removeListener("onCloseTransient",c),o.dispatchEvent("UnregisterContext",{widget_id:a.widget_id})}),200);o.addListener("InContextSearch_Response",c),o.addListener("onCloseTransient",c),o.addListener("onCloseTransient",(function(e){n.cancel&&n.cancel.call(null),o.dispatchEvent("UnregisterContext",{widget_id:a.widget_id})}))}(s)}))},new s})),define("DS/IPClassifyUXUtil/ProgressPaneImpl",["UWA/Core","UWA/Controls/Abstract","i18n!DS/IPClassifyUXUtil/assets/nls/ProgressPaneCommands","css!DS/IPClassifyUXUtil/IPClassifyUXUtil","DS/Controls/ProgressBar"],(function(e,t,n,i,s){"use strict";var a=e.Controls.Abstract.extend({name:"folder-progress",options:{className:""},init:function(){this._parent(),this.buildSkeleton()},getDestroyTimeout:function(){let e=window.progressPaneTimeout;return e=e||5e3,e},buildSkeleton:function(){var t=this;this.container=e.createElement("div",{class:t.getClassNames("-progresspane popover")});var i=e.createElement("div",{class:"progresspane-titlebar popover-title"});i.inject(this.container),(t.titleElement=e.createElement("div",{class:"progresspane-title",text:n.PROGRESS})).inject(i),t.titlebarclose=e.createElement("button",{class:"close fonticon fonticon-chevron-down",type:"button"}),t.titlebarclose.inject(i),t.titlebarclose.addEvent("click",(function(){t.titlebarclose.classList.contains("fonticon-chevron-down")?t.showMinimizededPanel():t.showMaximizedPanel()})),this.content=e.createElement("div",{class:"progresspane-content popover-content"}),this.content.inject(this.container),this.hide()},showMaximizedPanel:function(){this.titlebarclose.classList.remove("fonticon-chevron-up"),this.titlebarclose.classList.add("fonticon-chevron-down"),this.content.show()},showMinimizededPanel:function(){this.titlebarclose.classList.remove("fonticon-chevron-down"),this.titlebarclose.classList.add("fonticon-chevron-up"),this.content.hide()},show:function(){this.container.show()},hide:function(){this.container.hide(),this.totalSize=0,this.completedSize=0,this.ongoingSizes={},this.titleElement.setText(n.PROGRESS)},createElement:function(t){return e.createElement("div",{class:t})},createJobCancelerNEvent:function(t){let i=e.createElement("span",{class:"progresspane-jobcancel fonticon fonticon-close fonticon-clickable",title:n.Cancel});return i.addEvent("click",(function(){t.cancelled=!0,t.progressBar.update({reason:n.Cancelled})})),i},setJobStatus:function(e,t){t.setText(e),t.setAttribute("title",e)},addPendingSize:function(e){this.totalSize+=e},totalSize:0,completedSize:0,ongoingSizes:{},addProgress:function(e,{progressObj:t,max:i,count:o,title:l,cancel:r}){var c=this;c.show();var d=c.createElement("progresspane-job"),u=c.createElement("progresspane-jobtitle");u.innerText=l,u.title=l,u.inject(d);var h=c.createElement("progresspane-pane");h.inject(d);var p=new s({infiniteFlag:!0});p.inject(h);var m=c.createElement("progresspane-jobstatus");if(m.text=n.inProgress,m.title=n.inProgress,m.inject(d),r){var f=c.createJobCancelerNEvent(t);f.inject(d)}d.inject(c.content),c.showMaximizedPanel(),f.hide(),t.progressBar=d;var g=function(){p.hide(),h.hide(),m.show()};t.progressBar.update=function({reason:e,closeForFailure:s}){if(e&&e==n.Cancelled)f.hide(),c.setJobStatus(n.Cancelled,m),g();else if(m.getText()!=n.Cancelled){o=--o;var r=Math.round((i-o)/i*100);p.value=r,u.setText(l),0!=r&&(m.hide(),p.infiniteFlag=!1,p.show(),h.show(),f.show()),o<=1&&f.hide(),0==o&&(c.setJobStatus(n.Completed,m),t.completed=!0)}if(e&&e==n.Cancelled||0==o){let e=new CustomEvent("onEnd",{closeForFailure:s});t.progressBar.dispatchEvent(e),g(),setTimeout((function(){t.progressBar.destroy()}),a.destroyTimeout)}}}});return a.destroyTimeout=5e3,a})),define("DS/IPClassifyUXUtil/tagger/IPTaggerProxyAbstract",[],(function(){var e=[];return class{constructor(t){e.push(this),this._model=t,this._isActive=!1,this._wasActives=null,window.widget&&widget.addEvent("onResize",(()=>{"minimized"===widget.getView().type?(this._wasActives=this.isActive(),this.activate(!1)):null!==this._wasActives&&this.activate(this._wasActives)}))}setTaggerProxy(e){this._filter=e}activate(t){this._filter&&null!=t&&(e.forEach((e=>{t&&e!==this&&e.activate(!t)})),t?this._filter.activate():this._filter.deactivate(),this._isActive=t)}isActive(){return this._isActive}cleanProxy(){this._filter&&this._filter.cleanProxy&&this._filter.cleanProxy()}unsetTags(){this._filter&&this._filter.unsetTags&&this._filter.unsetTags()}getProxy(){return this._filter}}})),define("DS/IPClassifyUXUtil/ActionBar/IPClassifyTabBar",["UWA/Controls/Abstract","UWA/Class/Options","DS/Controls/TabBar"],(function(e,t,n){"use strict";return e.extend(t,{name:"IPClassifyTabBarController",init:function(e){this.tabIdCard_container=e.tabIdCard_container,this.dataProvider=e.dataProvider,this.tabBarProvider=e.tabBarProvider,this.tabDetailsShowView={},this._buildSkeleton(e)},_buildSkeleton:function(e){var t=this;this.tabBar=new n({displayStyle:"strip",centeredFlag:!1,showComboBoxFlag:!1,editableFlag:!1,multiSelFlag:!1,reorderFlag:!1}),this.tabBar.inject(t.tabIdCard_container);var i=t.tabBarProvider.getTabBars();for(var s in i)this.tabBar.add(i[s].tabOptions),t.tabDetailsShowView[i[s].tabOptions.value]=i[s].showTreeView;this.tabBar.value=[e.getCurrentWidgetTab()],this.tabBar.addEventListener("tabButtonClick",(function(n){n&&n.options&&(e.setCurrentWidgetTab(n.options.value,t.tabDetailsShowView[n.options.value]),e.notifyTabChange(),e.unsubscribeAll(),t.tabBarProvider.updateLayoutOnTabChange(n.options.value))}))}})})),define("DS/IPClassifyUXUtil/IPClassifyConfirmationWthCheckBx",["UWA/Class","DS/Controls/Toggle","DS/ENOFloatingPanel/ENOFloatingPanel","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil","DS/UIKIT/Input/Button"],(function(e,t,n,i,s){return e.singleton({name:"Library Confirmation With CheckBox",confirmModal:null,carryOverAttrs:!0,launch:function(e,a,o,l){var r=e.title,c=this;c.carryOverAttrs=!0;var d=UWA.createElement("div",{class:"attrsLostMsgBody"});e.infoTitle&&(d=UWA.createElement("div",{class:"attrsLostMsgBody",styles:{position:"absolute"}}));var u=new t({type:"checkbox",label:e.mainDivContent.checkBoxParams.label,value:0,checkFlag:!0});if(u.addEventListener("change",(function(e){c.carryOverAttrs=!c.carryOverAttrs,h&&(c.carryOverAttrs?h.setStyle("display","none"):h.setStyle("display",""))})),e.mainDivContent.divHeaderShow&&UWA.createElement("p",{text:e.mainDivContent.divHeaderShow}).inject(d),u.inject(d),e.mainDivContent.divFooterHide){UWA.createElement("br").inject(d);var h=UWA.createElement("div",{class:"attrsLostMsg"}).inject(d);h.setStyle("display","none"),UWA.createElement("p",{text:e.mainDivContent.divFooterHide,styles:{"font-weight":"bold"}}).inject(h)}if(e.infoTitle)UWA.createElement("span",{id:"InfoPanel",title:e.infoTitle,class:"fonticon fonticon-info",styles:{top:"55%",position:"fixed",right:"1%"}}).inject(d);var p=d,m=document.createElement("div"),f=new s({value:e.confirmLabel||i.confirmation_ok,className:"primary"}).inject(m);new s({value:e.cancelLabel||i.confirmation_cancel}).inject(m).addEvent("onClick",(function(e){l&&l(e),g._close()})),f.addEvent("onClick",(function(e){a&&a(e),g._close()}));var g=new n({className:"command_dialog move",title:r,footer:m,body:p,overlay:!0,closable:!0,animate:!0,resizable:!1,autocenter:!0,visible:!0,events:{onClose:function(){o&&o(event),this.destroy()}},limitParent:!0});g.inject(widget.body)},getChkBoxCheckedFlag:function(){return this.carryOverAttrs}})})),define("DS/IPClassifyUXUtil/OpenWithMenuBuilder",["DS/i3DXCompassPlatformServices/OpenWith","UWA/Promise","DS/IPClassifyUtil/IPServicesMgr","DS/WidgetServices/WidgetServices","DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/IPSettingsMgr"],(function(e,t,n,i,s,a,o){function l(e){return new t((t=>{var n={};e.forEach((function(e){n[e.options.type]=!0}));require(["DS/IPClassifyUXUtil/IPClassifyUXUtilities/IPTypesMgt"],(function(e){e.retrieveHierarchy(Object.keys(n),(function(e){t(e)}))}))}))}function r(){}var c;return r.prototype={getTypeInheritance:l,build3DXContent:function(e){return new t((a=>{let r=l(e),c=function(e){return new t((function(t){let n=[],i={};e.forEach((e=>{let t=!1;e.getAttributeValue&&(t=!!e.getAttributeValue("ds6w:kind")),t||(n.push(e.getID()),i[e.getID()]=e)})),n.length>0?s.fetch({ids:n,select_predicate:["ds6w:kind"],onComplete:e=>{if(e&&e.results&&e.results.length>0){for(var n=0;n<e.results.length;++n)for(var s=e.results[n],a=[],o=null,l=0;l<s.attributes.length;++l)"ds6w:kind"==s.attributes[l].name?a.push(s.attributes[l].value):"resourceid"==s.attributes[l].name&&(o=s.attributes[l].value);if(o&&a.length>0){let e=i[o];e&&e.setAttribute("ds6w:kind",a)}}t()},onFailure:function(){t(),console.log("Failure during object Kind retrieval")}}):t()}))}(e),d={};e.forEach((e=>d[e.getID()]=e)),t.all([r,c]).then((t=>{let s=t[0],l=null;s&&(l={protocol:"3DXContent",version:"2.1",source:widget&&widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):"ENOFOL3_AP",widgetId:n.getWidgetId(),data:{items:[]}},e.forEach((function(e){!0!==e.isGroupingNode&&l.data.items.push(function(e,t){var n,s=[e.options.type];t&&t[e.options.type]&&(s=t[e.options.type]).length>1&&s[0]===s[1]&&s.shift(),n=!0===e.isRelationsObjectNode?void 0:e.getOccurencePathWithType?e.getOccurencePathWithType():void 0;let a=e.getAttributeValue("serviceId");a=a||"3DSpace";let l=e.getAttributeValue("i3dx"),r=e.getAttributeValue("ds6w:kind");r=r||[],Array.isArray(r)||(r=[r]);let c={envId:i.getTenantID("OnPremise"),serviceId:a,contextId:widget.getValue("pad_security_ctx")?widget.getValue("pad_security_ctx"):o.getWebCredential(),objectId:e.getID(),objectType:e.options.type,objectTaxonomies:[...s,...r],displayName:e.options.display?e.options.display:e.getLabel(),displayType:e.options.grid?e.options.grid["ds6w:type"]:e.options.type,path:n};return l&&(c.i3dx=l),c}(e,s))}))),a(l)}))}))},openWithApps:function(n,i,s){return new t((async(t,l)=>{let r=await this.build3DXContent(n);var c=new e;r&&UWA.is(c.retrieveCompatibleApps,"function")&&!o.isCompassInacessible()?(c.set3DXContent(r,!0===i.overrideAppLaunch),c.retrieveCompatibleApps((function(e){var n=[],o=[];if(e.forEach((function(e){var t={type:"PushItem",title:e.text,action:{callback:()=>{s&&a.sendTrackerPageEvent(s,"Open with "+e.text),e.handler()}}};e.icon?t.icon="url("+e.icon+")":t.fonticon={content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+e.fonticon,family:WUXManagedFontIcons.Font3DS},o.push(t)})),o.length>0){var l=i.iconOpenWith;"string"==typeof i.iconOpenWith&&(l="url("+i.iconOpenWith+")");var r={type:"PushItem",icon:l,title:i.nlsOpenWith,submenu:o};n.push(r),n.push({type:"SeparatorItem"})}t(n)}))):t([])}))}},c||(c=new r),c})),define("DS/IPClassifyUXUtil/IPClassifyLoaderGlobal",["UWA/Class","DS/Controls/Loader","i18n!DS/IPClassifyUXUtil/assets/nls/ProgressPaneCommands"],(function(e,t,n){function i(e){console.log("%c"+e,"color: orange")}function s(){let e=new t({height:60,fadeDuration:0,showButtonFlag:!0}),n=new t({height:60,fadeDuration:0}),i={},s={container:null,cancellable:e,std:n,keyMapping:i,hasCancellableMessages:function(){return Object.values(i).filter((t=>t.loader===e)).length>0},hasMessages:function(){return Object.keys(i).length>0},next:function(){this.container&&(this.hasMessages()?this.show():this.hide())},show:function(){this.hasCancellableMessages()?(this.std.remove(),this.cancellable.inject(s.container)):(this.cancellable.remove(),this.std.inject(s.container)),s.container.style.display="flex"},hide:function(){s.container.style.display="none"}};return s}return e.singleton({init:function(){this.loader={global:s(),contentView:s(),treeView:s()}},setContainer:function(e,t){if(this.loader.hasOwnProperty(e)){let n=this.loader[e];n.container=t,n.next()}else i('The type of loader "'+e+'" is not defined.')},addComponentsToLoad:function(e,t,s){let a="";if("string"==typeof t){let e=t;(t={})[e]=""}let o=this.loader[e];if(o){for(var l in t){o.keyMapping[l]&&this.removeComponentToLoad(e,l),a=t[l]?t[l]:n.loadingText;let i=s&&s.withCancel?o.cancellable:o.std;if(i.on(a),o.keyMapping[l]={loader:i,message:a},s&&s.withCancel&&s.cancelObject){let t=()=>{s.cancelObject.cancel(),i.removeEventListener("buttonclick",t),this.removeComponentToLoad(e,l)};i.addEventListener("buttonclick",t),UWA.extend(o.keyMapping[l],{functionCancel:t})}}o.next()}else i('The type of loader "'+e+'" is not defined.');if(s&&s.withPercent)for(let n in t)this.updateComponentPercent(e,n,"0%")},updateComponentPercent:function(e,t,n){this.loader[e].keyMapping[t]&&this.loader[e].keyMapping[t].loader&&this.loader[e].keyMapping[t].loader.update(n)},removeComponentToLoad:function(e,t){let n=this.loader[e];if(n){let e=n.keyMapping[t];e&&(e.functionCancel&&n.cancellable.removeEventListener("buttonclick",e.functionCancel),e.loader.off(e.message),delete n.keyMapping[t]),n.next()}else i("The type of loader "+e+" is not defined.")}})})),define("DS/IPClassifyUXUtil/utils/CancellablePromise",[],(function(){class e{constructor(e,{rejectOnCancel:t}={}){if(this._onCancel=null,this._chained=!1,this._rejectOnCancel=null,this._cancelled=!1,this._queriesToCancel=[],e&&"AsyncFunction"===e.constructor.name){let t=e;e=e.length>0?new Promise(((e,n)=>{t(e,n)})):t()}let n=e;e instanceof Promise||!e||(n=new Promise(e.bind(this))),this._promise=new Promise(((e,i)=>{t&&(this._rejectOnCancel=i),n.then(e).catch(i)})),this._promise.catch((e=>{this._chained||console.log(e)}))}_createChained(t){let n=new e(t);return n.addLinkedQuery(this),n}_innerCallback(e){if((!this.isCancelled()||this._rejectOnCancel)&&e){let t=[...arguments];return t.shift(),e.apply(this,t)}}getPromise(){return this._promise}then(e,t){this._chained=!0;let n=t?this._innerCallback.bind(this,t):void 0,i=this._promise.then(this._innerCallback.bind(this,e),n);return this._createChained(i)}catch(e){let t=this._promise.catch(this._innerCallback.bind(this,e));return this._createChained(t)}finally(e){let t=this._promise.finally(this._innerCallback.bind(this,e));return this._createChained(t)}onCancel(e){this._onCancel=e}addLinkedQuery(e){e&&(this._cancelled&&e.cancel?e.cancel():this._queriesToCancel.push(e))}addLinkTo(e){return e.addLinkedQuery(this),this}cancel(){this._cancelled=!0,this._queriesToCancel.forEach((e=>{e.cancel&&e.cancel()})),this._queriesToCancel=[],this._onCancel&&this._onCancel(),this._rejectOnCancel&&this._rejectOnCancel({cancelled:!0})}isCancelled(){return this._cancelled}}return e.resolve=function(t){return new e((e=>e(t)))},e.reject=function(t){return new e(((e,n)=>n(t)))},e.all=function(t){let n=[];t.forEach((e=>{let t=e instanceof Promise?e:e.getPromise?e.getPromise():null;n.push(t)}));let i=new e(Promise.all(n));return t.forEach((e=>{i.addLinkedQuery(e)})),i},e})),define("DS/IPClassifyUXUtil/IPClassifyUXUtilities/IPTransactionManager",(function(){})),define("DS/IPClassifyUXUtil/ActionBar/BreadCrumbMenu",["UWA/Controls/Abstract","UWA/Class/Options","DS/UIKIT/DropdownMenu","DS/Controls/Button","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil"],(function(e,t,n,i,s,a){"use strict";var o=e.extend(t,{_dropDownCreated:!1,_dropdownElmt:null,_separator:null,_folderInfo:null,_subFolders:null,_activeIconFont:"",_unactiveIconFont:"",init:function({folderInfo:e,activeIconFont:t,unactiveIconFont:n,modelEvents:i}){this._parent.apply(this,arguments),this._folderInfo=e||null,this._activeIconFont=t||"fonticon-down-dir",this._unactiveIconFont=n||"fonticon-right-dir"},getSubFolder:function(e){return null===this._subFolders||e>=this._subFolders.length?null:this._subFolders[e]},addSubFolder:function(e,t){null===this._subFolders&&(this._subFolders=[]),t?this._subFolders.splice(0,0,e):this._subFolders.push(e),this._dropDownCreated=!1},removeSubFolder:function(e){if(null===this._subFolders||e>=this._subFolders.length)return!1;this._subFolders.splice(e,1);return this._dropDownCreated=!1,this._dropdownElmt&&this._dropdownElmt.isVisible&&this._dropdownElmt.hide(),!0},hide:function(){this._dropdownElmt&&this._dropdownElmt.isVisible&&(this._dropdownElmt.hide(),this._dropDownCreated=!1),this._separator&&this._separator.hide()},show:function(){this._separator&&this._separator.show()},isVisible:function(){return"none"!==this._separator.getStyle("display")},buildPathSeparatorElementBasic:function(){var e=this;return this._separator=UWA.createElement("div",{class:"separatorIdCard fonticon "+this._unactiveIconFont,styles:{cursor:"pointer"},events:{click:function(t){e._dropDownCreated||e._buildDropDownPath()}}}),this._separator},isMenu:function(){return this._unactiveIconFont.indexOf("menu")>=0},buildPathSeparatorElement:function(){if(this.isMenu()){var e=this,t=new i({displayStyle:"lite",icon:{iconName:"menu",fontIconFamily:1}});t.getContent().addEventListener("buttonclick",(function(t){e._dropDownCreated||e._buildDropDownPath()})),this._separator=t.getContent()}else this._separator=this.buildPathSeparatorElementBasic();return this._separator},flush:function(){this._clearDropDown,this._dropDownCreated=!1,this._subFolders=null},_clearDropDown:function(){this._dropdownElmt&&(this._dropdownElmt.destroy(),this._dropdownElmt=null)},_buildDropDownPath:function(){var e=this;if(null===this._subFolders&&null===this._folderInfo)return null;this._clearDropDown(),this._subFolders?(e._dropDownCreated=!0,this._buildDomDropdownElmt(this._subFolders)):this._folderInfo.getChildrenInfos({onComplete:function(t){e._dropDownCreated=!0,e._buildDomDropdownElmt(t)},onFailure:function(t){e._dropDownCreated=!1,s.displayNotification({message:a.get("breadcrumb_expandError"),className:"error"})}})},_buildDomDropdownElmt:function(e){var t=this,i=[];e.length>0&&(e.forEach((function(e){i.push({text:e.getLabel(),title:e.getLabel(),handler:function(){t._callExpandAndSelectRequest(e.getID(),e.getType(),e.getLabel())}})})),this._dropdownElmt=new n({target:this._separator,className:"folder_ctx_menu",items:i,position:"bottom left"}),this.isMenu()||this._dropdownElmt.addEvents({onShow:function(){t._separator.removeClassName(t._unactiveIconFont),t._separator.addClassName(t._activeIconFont)},onHide:function(){t._separator.removeClassName(t._activeIconFont),t._separator.addClassName(t._unactiveIconFont)}}),this._checkSizeOverflowDropdownMenu(),this._dropdownElmt.show())},resizeWidgetCallback:function(){this._dropdownElmt&&this._dropDownCreated&&(this._dropDownCreated=!1,this.isVisible()&&this._dropdownElmt.hide())},_checkSizeOverflowDropdownMenu:function(){var e,t,n,i,s,a,o,l,r,c,d;if(!this._dropdownElmt)return!1;a=this._dropdownElmt.elements.container,e=(o=this._dropdownElmt.options).target,n=document.documentElement.clientHeight||window.innerHeight,s=document.documentElement.clientWidth||window.innerWidth,a.isInjected()||(this._dropdownElmt.inject(o.renderTo?o.renderTo:document.body),a.setStyle("display","")),t=a.offsetHeight,i=a.offsetWidth,t>(l=n-(c=e.getOffsets().y+e.offsetHeight)-20>0?n-c-20:n-c)&&(a.setStyle("height",l),a.setStyle("overflow-y","auto"),i+=20,a.setStyle("width",i)),i>(r=s-(d=e.getOffsets().x+e.offsetWidth)-20>0?s-d-20:s-d)&&a.setStyle("width",r)},_callExpandAndSelectRequest:function(e,t,n){this.options.modelEvents.publish({event:"select_breadcrumb_object",data:{id:e,type:t,name:n}})}});return o})),define("DS/IPClassifyUXUtil/IPConfirmationDialog",["DS/WebappsUtils/WebappsUtils","DS/Windows/Dialog","DS/Controls/Button","css!DS/IPClassifyUXUtil/IPClassifyUXUtil.css"],((e,t,n)=>({confirmDialog:function({className:i,id:s,immersiveFrame:a,title:o,message:l,messageHTML:r,details:c,detailsHTML:d,type:u,buttonLabels:h,rejectOnCancel:p,buttons:m,closeButtonFlag:f}){let g=null,v=g=UWA.createElement("div");if("warning"===u){let t=e.getWebappsAssetUrl("IPClassifyUXUtil","icons/warning.png");UWA.createElement("img",{src:t,width:"35px",height:"30px"}).inject(v),g=UWA.createElement("div",{class:"textContainer"}).inject(v)}if(l){l.split("\n").forEach((e=>{UWA.createElement("div",{class:"confirmMessage",text:e}).inject(g)}))}else r.inject(g);return c?UWA.createElement("div",{text:c}).inject(g):d&&("function"==typeof d.inject?d.inject(g):g.innerHTML+=d),new Promise(((e,l)=>{let r={modalFlag:!0,domId:s,immersiveFrame:a,title:o,content:v,activeFlag:!1,closeButtonFlag:f||!0};!1!==m&&(r.buttons={No:new n({label:h&&h.No,onClick:function(e){c.close(),p&&l()}}),Yes:new n({label:h&&h.Yes,onClick:function(t){c.close(),e()}})});let c=new t(r);c.getContent().addClassName("IPConfirmDialog"),i&&c.getContent().addClassName(i)}))}}))),define("DS/IPClassifyUXUtil/IPClassifyConfirmation",["UWA/Class","DS/IPClassifyUtil/IPSettingsMgr","DS/ENOFloatingPanel/ENOFloatingPanel","DS/IPClassifyUX/utils/LoadCssUtil","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Toggle","DS/Controls/Button","DS/Core/WebUXGlobalEnums","DS/WebappsUtils/WebappsUtils","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","DS/DataGridView/DataGridView","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil","DS/UIKIT/Input/Button"],(function(e,t,n,i,s,a,o,l,r,c,d,u,h,p,m,f){return e.singleton({name:"Library Confirmation",confirmModal:null,launch:function(e,t,i,s){var a=e.title,o=e.content?e.content:e.contentTxt?e.contentTxt.escapeHTML():"",l=this,r=o||"Are you sure?",c=document.createElement("div"),d=new f({value:e.confirmLabel||m.confirmation_ok,className:"primary"}).inject(c);!0!==e.noClose&&new f({value:e.cancelLabel||m.confirmation_cancel}).inject(c).addEvent("onClick",(function(e){s&&s(e),l.confirmModal._close()}));var u=!1;d.addEvent("onClick",(function(e){u=!0,t&&t(e),l.confirmModal._close()})),l.confirmModal=new n({className:"command_dialog move",title:a,footer:c,body:r,overlay:!0,closable:!0!==e.noClose,animate:!0,resizable:!1,autocenter:!0,visible:!0,events:{onClose:function(){!u&&i&&i(event),this.destroy()}},limitParent:!0}),l.confirmModal.inject(widget.body)},confirmDialog:function(e,n,d,u,h){var p=this,f=c.getWebappsAssetUrl("IPClassifyUX","css/confirmationPanel.css");i._loadCSS(f),p.immersiveFrame=new s({}),p.components={},p.components.dialogContent=UWA.createElement("div",{class:"dialogContent",styles:{display:"flex","flex-direction":"column",height:"100%"}}),p.components.mainContainer=UWA.createElement("div",{class:"MainContainer",styles:{display:"flex","flex-direction":"column"}}).inject(p.components.dialogContent),p.components.mainContainerContent=UWA.createElement("div",{class:"mainContainerContent",styles:{display:"flex","margin-bottom":"6px"}}).inject(p.components.mainContainer),p.components.mainContainerFooter=UWA.createElement("div",{class:"mainContainerFooter"}).inject(p.components.mainContainer),p.components.warningImageContainer=UWA.createElement("div",{class:"warningImageContainer",styles:{margin:"5px","white-space":"normal"}}).inject(p.components.mainContainerContent),p.components.warningImageSrc=c.getWebappsAssetUrl("IPClassifyUXUtil","icons/warning.png"),p.components.warningImage=UWA.createElement("img",{src:p.components.warningImageSrc,class:"Delete-Dialog-WarningImage",alt:"Warning Image",width:"35px",height:"30px"}).inject(p.components.warningImageContainer),p.components.warningTextContainer=UWA.createElement("div",{class:"warningTextContainer",styles:{display:"flex","flex-direction":"column","flex-grow":"1","white-space":"normal"}}).inject(p.components.mainContainerContent),p.components.warningHeaderMsg1=UWA.createElement("div",{class:"warningHeaderMsg1",text:e.warningMessage?e.warningMessage+"\n":"",styles:{color:"#3d3d3d","font-size":"12px","flex-grow":"1","margin-bottom":"6px"}}).inject(p.components.warningTextContainer),p.components.warningHeaderMsg1.textContent=e.warningMessage?e.warningMessage+"\n":"",p.components.warningHeaderMsg2=UWA.createElement("div",{class:"warningHeaderMsg2",text:e.warningInfo?e.warningInfo:"",styles:{"white-space":"normal","flex-grow":"1","margin-bottom":"4px"}}).inject(p.components.warningTextContainer),p.components.warningText=UWA.createElement("div",{class:"warningText",styles:{"white-space":"normal","flex-grow":"1"}}).inject(p.components.warningTextContainer),p.components.warningText.textContent=e.moreInfo?e.moreInfo:"",p.components.confirmationDiv=UWA.createElement("div",{class:"confirmationBox",styles:{display:"flex","white-space":"normal","flex-grow":"1"}}).inject(p.components.warningTextContainer),p.components.confirmationToggle=new o({type:"checkbox",value:0,checkFlag:!1,domId:"confirmationToggle"}).inject(p.components.confirmationDiv),p.components.confirmationText=UWA.createElement("div",{class:"confirmationText",text:e.confirmationBoxText?e.confirmationBoxText:m.checkboxMsg}).inject(p.components.confirmationDiv),p.components.confirmationText.onclick=function(){0==p.components.confirmationToggle.checkFlag?p.components.confirmationToggle.checkFlag=!0:p.components.confirmationToggle.checkFlag=!1},e.enableConfirmationBox?p.components.confirmationToggle.addEventListener("change",(function(e){var t=e.dsModel;p.components.myDialog.buttons.Yes.disabled=!t.checkFlag})):p.components.confirmationDiv.hide(),e.showDGV&&p.prepareDGV(e);var g="";if(e.buttonColor&&"blue"==e.buttonColor&&(g="-Blue"),p.components.myDialog=new a({immersiveFrame:p.immersiveFrame,domId:"Delete-Dialog",title:e.titleLabel?e.titleLabel:m.confirmation_delete,content:p.components.dialogContent,activeFlag:!1,modalFlag:!0,resizableFlag:!1,buttons:{Yes:new l({label:e.deleteButtonLabel?e.deleteButtonLabel:m.confirmation_delete,domId:"Dialog-DeleteButton"+g,disabled:!!e.enableConfirmationBox,onClick:function(e){e.dsModel.dialog.destroy(),p.immersiveFrame.destroy(),e.dsModel=null,n&&n(u)},role:r.WUXCustomButtonRoleEnum.Validate}),Cancel:new l({label:m.confirmation_cancel,onClick:function(e){d&&d(h),e.dsModel.dialog.destroy(),p.immersiveFrame.destroy(),e.dsModel=null}})}}),p.components.myDialog.width=500,p.components.myDialog.addEventListener("close",(e=>{d&&d(h),e.dsModel.dialog&&e.dsModel.dialog.destroy(),p.immersiveFrame.destroy(),e.dsModel=null})),t.isWebInWin()){let e=document.querySelectorAll(".IP_SS_MainClassificationContainer")[0];e||(e=document.body),p.immersiveFrame.inject(e)}else p.immersiveFrame.inject(widget.body)},prepareDGV:function(e){var t=this,n=e.data,i=e.cols,s=new h,a=new d({dataModelSet:s});a.prepareUpdate();for(var o=0,l=n.length;o<l;o++){var r=n[o],c=u.createTreeNodeDataModel(s,{label:r.tree,grid:r});a.addChild(c)}a.expandAll(),a.pushUpdate(),t.components.gridView=UWA.createElement("div",{class:"DeleteDialog-gridview",styles:{"min-height":"90px","margin-bottom":"5px",position:"relative",height:"100%"}});var m=new p({identifier:"DeleteDialog-gridview",treeDocument:a,columns:i,showSelectionCheckBoxesFlag:!1,showOutlineFlag:!0});m.maxVisibleRowCount=6,t.components.gridView.inject(t.components.dialogContent),m.inject(t.components.gridView)}})})),define("DS/IPClassifyUXUtil/TempOpenWithMenuBuilder",["DS/IPClassifyUXUtil/OpenWithMenuBuilder"],(e=>e)),define("DS/IPClassifyUXUtil/IPClassifyUXUtilities/view/IPClassifyLevelSel",["UWA/Controls/Abstract","DS/UIKIT/Modal","DS/Controls/Button","DS/Controls/SpinBox"],(function(e,t,n,i){"use strict";return e.extend({name:"ipClassif_level_sel",defaultOptions:{current_level:1},init:function(e){this._parent(e);var s=this,a=UWA.createElement("div",{class:this.getClassNames()}),o=new i({value:s.options.current_level,minValue:1,stepValue:1,pageStepValue:1,typingFilter:!0,decimals:0}).inject(a);o.getContent().addClassName(this.getClassNames("_spinbox")),this.elements.level_selector=o,o.getContent().addEvent("change",this._updateDownState.bind(this));var l=new n({icon:"check",emphasize:"success"}).inject(a);l.getContent().addClassName(this.getClassNames("_okbtn")),l.getContent().setStyle("width","22px"),o.addEventListener("change",(function(e){s.options.current_level=parseInt(e.dsModel.value)})),o.elements.inputField&&o.elements.inputField.addEventListener("keyup",(function(e){if(13===e.keyCode){var t=s.options.current_level.toString();s.dispatchEvent("onApply",[t]),d.destroy()}})),l.addEventListener("click",(function(){var e=s.options.current_level.toString();s.dispatchEvent("onApply",[e]),d.destroy()}));var r,c=UWA.is(e.css_style)?" "+e.css_style:"",d=new t({className:this.getClassNames("_modal")+c,closable:!1,body:a,visible:!0});d.elements.wrapper.setStyle("padding-top","calc("+(r="500px",document.body.scrollHeight>40&&(r=document.body.scrollHeight+"px"),r+" - 80px)")),d.elements.scrollableContent&&d.elements.scrollableContent.setStyle("width","155px"),d.elements.container.addEventListener("click",(function(e){d.destroy()})),d.elements.content.addEventListener("click",(function(e){return e.preventDefault(),e.stopPropagation(),!1})),d.inject(document.body),this._updateDownState()},_updateDownState:function(){var e=this.elements.level_selector.value,t=this.elements.level_selector.minValue,n=this.elements.level_selector.elements.down;e<=t?n.addClassName("ipClassif_level_sel_down_arrow_disabled"):n.removeClassName("ipClassif_level_sel_down_arrow_disabled")}})})),define("DS/IPClassifyUXUtil/ajaxRequests/wwwAjaxRequests",["DS/EditPropWidget/ajaxRequests/ServicesAjaxRequests","DS/EditPropWidget/constants/EditPropConstants","DS/WebappsUtils/WebappsUtils","DS/IPClassifyUtil/IPClassifyModelEvents","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil"],(function(e,t,n,i,s){"use strict";function a(){return n.getWebappsAssetUrl("IPClassifyUXUtil","icons/I_LinkTemp.png")}return{commitModels:async function(e){var t=e.modelList,n=t.length;if(1===n&&t[0].get("type")&&t[0].get("type").contains("Document Proxy"))require(["DS/ENOXAttachmentsUX/ajaxRequests/DocPropertiesModel"],(function(t){t.commitModels(e)}));else if(n){let n=t[0],a=n.changedValues.Title,o=n.changedValues.URL,l=a?a.valueDB:null,r=o?o.valueDB:null,c=n.get("objectId"),d=n.getAllAttributes().URL.select;e.headers={Accept:"application/json"},e.model=n,e.withSC=!0,e.withChange="silent",e.source="3DSpace";var s={};if(s.id=d,s.url=r,r){const e=/^[A-Za-z]+:/;s.url=e.test(r)?r:`https://${r}`}s.urlTitle=l,s.members=[c],s.contentID=c,s.securityContext=e.securityContext,require(["DS/FolderEditor/service/FolderServices"],(function(t){t.editExternalLink(s).then((t=>{let a={results:[]},o={};if(t.error)a.UXMessage=[t.error.message?t.error.message:""];else{let e=s.url?s.url:n.get("URL").valueDB,l=s.urlTitle?s.urlTitle:n.get("Title").valueDB,r=t.contents[0].id;o[s.contentID]={attributes:{id:r,label:l},options:{grid:{uri:e,id:r,appdata:l,Link:e},resourceid:r,label:l}},n.set("objectId",r),i.publish({event:"updateContentNodes",data:{items:o}}),a.results.push({status:200,body:{physicalid:r,Title:{selectable:"Title",name:"Title",value:[l]},URL:{selectable:"URL",name:"URL",value:[e]},url:"model/bus/"+r,errors:[]}})}e.onComplete(a)})).catch((t=>{console.log(t),e.onComplete({results:[],UXMessage:[""]})}))}))}},checkFacetsVisibility:function(e){var n={};let i=!1;e.facets.every((e=>(i=e.name===t.FACET_PROPERTIES,!i)));let a=null;i&&!e.model.isMergedModel()?n[t.FACET_PROPERTIES]=!0:a={message:s.www_multisel_forbidden};let o={id:e.model.get("objectId"),facets:n,notification:a};e.onComplete.call(this,o)},getListOfAttributes:function(t){var n=t.modelList,i=n.length;if(1===i&&n[0].get("type")&&n[0].get("type").contains("Document Proxy"))require(["DS/ENOXAttachmentsUX/ajaxRequests/DocPropertiesModel"],(function(e){e.getListOfAttributes(t)}));else if(1===i&&!n[0].isMergedModel()){let i=n[0],l=i.get("objectId");t.headers={Accept:"application/json"};var o="/resources/v1/FolderManagement/Folder/"+l+"/getlinkProperties";t.model=i,t.withSC=!0,t.withChange="silent",t.source="3DSpace",t.onCompleteWS=e=>{var n={options:{autoExpand:!1},results:[{computed:{label:{path:"Title",name:"Title",value:[e.Title]}},data:[{path:"Title",nls:s.get("Title"),maxlength:0,name:"Title",readOnly:!1,type:"string",value:[e.Title],mandatory:!0,UIPosition:2},{path:"URL",select:e.OwnerID,nls:s.get("URL"),maxlength:0,name:"URL",readOnly:!1,type:"string",value:[e.URL],mandatory:!0,UIPosition:3}],physicalID:e.id,metatype:"bus",type:"VaultedObjectsLink",type_icon_large_url:a(),PLMParametersAvailable:!1,preview_url:"",success:!0,modifyAccess:!0,groupData:[]}]};t.onComplete(n)},e.createRequest(t,"GET",o,undefined)}},getPreviewUrl:function(e){var t=[];t.push({id:e.modelList[0]._attributes.objectId,preview:a()}),e.onComplete(t)}}})),define("DS/IPClassifyUXUtil/tagger/IPWebInWinTaggerProxy",["DS/TagNavigatorProxy/TaggerWebInWinProxy","UWA/Core","DS/CoreEvents/ModelEvents"],(function(e,t,n){"use strict";return e.extend(n,{init:function(e){e.proxyId=e.widgetId+e.name,this._parent.call(this,e)},_dispatchEvent:function(e){if(!t.is(e,"object")||!t.is(e.notif_name)||void 0===e.notif_parameters)throw console.log("E_INVALIDARG, expect to have parameters.notif_name arg & parameters.notif_parameters in _dispathTowin !!!"),"No parameters.notif_name arg & parameters.notif_parameters given to _dispathTowin method !";console.log("ResultWebInWin._dispathTowin for "+e.notif_name);var n=t.is(e.notif_parameters,"string")?e.notif_parameters:JSON.stringify(e.notif_parameters);"undefined"!=typeof dscef&&dscef.sendString(e.notif_name+"="+n)},getProxyId:function(){return this._proxyId}})})),define("DS/IPClassifyUXUtil/private/CredentialsConverter",[],(function(){"use strict";return{computeCredentials:function(e,t){return this._computeCredentials(e,t||{})},_computeCredentials:function(e,{defaultSC:t,withRoles:n}){var i,s,a=null;t&&"string"==typeof t&&(i=t.match("(ctx::)?([^.]*).([^.]*).(.*)"),s=null,i&&(s={role:i[2],org:i[3],cs:i[4]}),a=s);let o=[],l=null,r=null,c=null,d=!1,u=!1;return e.forEach((e=>{if(e.ctxname&&(n||e.prjname!==l||e.orgname!==r)){let t={...e,label:e.ctxtitle};a&&a.cs===e.prjname&&a.org===e.orgname&&(d=!0,u||(u=u||a.cs===e.prjname&&a.org===e.orgname&&a.role===e.rolename,c=t)),o.push(t),l=e.prjname,r=e.orgname}})),!c&&o.length>0&&(c=o[0]),{defaultMatches:d,credential:c,credentials:o}}}})),define("DS/IPClassifyUXUtil/ProgressPaneExecution",["DS/IPClassifyUXUtil/ProgressPaneImpl","UWA/Controls/Abstract","DS/IPClassifyUXUtil/utils/CancellablePromise","DS/IPClassifyUXUtil/IPClassifyLoaderGlobal","i18n!DS/IPClassifyUXUtil/assets/nls/ProgressPaneCommands"],(function(e,t,n,i,s){"use strict";var a,o=0;let l=0,r=t.extend({init:function({scope:e,progress:t,datas:n,keyNls:i}){this._parent(),this.progress=t,this.nbDatas=n.length,this.keyNls=i,this.events={},this.scope=e},update:function({closeForFailure:e}){this.progress.nbDone++;let t=this.progress.nbDone/this.nbDatas*100;if(i.updateComponentPercent(this.scope,this.keyNls,`${t}%`),this.progress.nbDone===this.nbDatas||e){i.removeComponentToLoad(this.scope,this.keyNls);let t=this.events.onEnd;t&&t.forEach((t=>{t({closeForFailure:e})}))}},addEventListener:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}});var c=t.singleton({name:"ipprogress",init:function(){null==a&&(a=new e).inject(widget.body)},_current:[],_queue:[],_launchOp:function(e){if(e)if(this._current.push(e),!1===e.progress.cancelled){let t=e.query.call(null,e.params),n=t.then((t=>{e.answers.push(t)})).catch((t=>{console.log(t),e.rejectOfPromise&&(e.rejectOfPromise(t),e.rejected=!0)}));e.promise.addLinkedQuery(t),n.finally((()=>{e.progress.progressBar.update({closeForFailure:e.rejected}),this._current.splice(this._current.indexOf(e)),e.nextQuery&&!e.rejected?this._launchOp(e.nextQuery):this.launchNext()}))}else this._current.splice(this._current.indexOf(e)),e.nextQuery?this._launchOp(e.nextQuery):this.launchNext();else 0===this._current.length&&this.finishJob()},launchNext:function(){if(this._current.length<6){var e=this._queue.shift();this._launchOp(e),e&&this.launchNext()}},execute:function({title:e,data:t,datas:a,loaderInfo:o,monoThread:c,rejectOnFailure:d}){let u,h;if(t&&(a=[t]),o){l++;let{scope:t,withPercent:n}=o,s={},c="LoaderNumber"+l;s[c]=e,u={loaderInfo:o,nbDone:0},u.progressBar=new r({scope:t,progress:u,datas:a,keyNls:c}),i.addComponentsToLoad(t,s,{withCancel:!0,withPercent:n,cancelObject:{cancel:()=>{h.cancel()}}})}else u=this.createProgress(e,a.length);let p=[],m=null;h=new n(((e,t)=>{m=t,u.progressBar.addEventListener("onEnd",(({closeForFailure:t})=>{t||e(p)}))})),o&&Object.defineProperty(u,"cancelled",{get:()=>h.isCancelled()});let f=null;return a.forEach(((e,t)=>{let n={...arguments[0]};n.progress=u,n.promise=h,n.answers=p,c&&d&&(n.rejectOfPromise=m),n.params=e,c&&0!==t&&(f.nextQuery=n),f=n,0!==t&&c||this._queue.push(n)})),this._length=this._queue.length,h.onCancel((()=>{u.progressBar.update({reason:s.Cancelled}),this._queue=this._queue.filter((e=>e.progress!==u)),u.loaderInfo&&i.removeComponentToLoad(u.progressBar.scope,u.progressBar.keyNls),0==this._queue.length&&this.finishJob()})),this.launchNext(),h},launchPanel:function(e,t,n,i,{monoThread:s}={}){return this.execute({title:e,datas:t,monoThread:s,query:e=>n(e,i)})},finishJob:function(){setTimeout((function(){0==a.getContent().getChildren()[1].getChildren().length&&a.hide()}),e.destroyTimeout)},createProgress:function(e,t){var n=++o,i={count:0,id:n,cancelled:!1};return a.addProgress(n,{progressObj:i,max:t,count:t,title:e,cancel:!0}),i}});return c})),define("DS/IPClassifyUXUtil/ActionBar/IPCommandManager",["DS/WebappsUtils/WebappsUtils","DS/Controls/TooltipModel","DS/CoreEvents/Events","DS/RuntimeView/NLSManager","DS/PADUtils/PADContext","DS/IPClassifyUtil/IPContext","DS/IPClassifyUXUtil/OpenWithMenuBuilder","DS/ApplicationFrame/CommandsManager","DS/WidgetServices/WidgetServices","DS/Menu/Menu","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil"],((e,t,n,i,s,a,o,l,r,c,d,u)=>{function h(e,{acceptNull:t}={acceptNull:!1}){var n;return t&&!e.icon||(e.icon&&-1!==e.icon.search(".png")?e.icon&&(n={iconPath:e.icon}):n={iconName:e.icon?e.icon:"alert",fontIconFamily:1}),n}function p(t,{defaultIcon:n,iconType:i}={}){let s=n;if(t){if("rich"===(i||S.iconType)&&t.rich){let n=t.rich.module,i=`icons/${t.rich.size?t.rich.size:"22"}/${t.rich.name}`;s=e.getWebappsAssetUrl(n,i)}!s&&t.icon&&(s=t.icon)}return s}function m(e){return p(S.iconFontToRich&&S.iconFontToRich[e])}function f(e,{defaultIcon:t,iconType:n}={}){return p(S&&S.commands&&S.commands[e],{defaultIcon:t,iconType:n})}function g(e,{defaultIcon:t,iconType:n}={}){return h({icon:f(e,{defaultIcon:t,iconType:n})},{acceptNull:!t})}function v(){return a.get()?a.get():null}function b(){return v()?v().toString():null}var y=null,C={},_=!1;let S={};var w=[],I=null;function P(e,t){this._switchRunning||!0!==t.options.checkByCommand||(e&&!1===t._enableByWidget?t.disable():!0===t._enableByWidget&&(w.push(t.getId()),clearTimeout(I),I=setTimeout((()=>{this.getModelEvents().publish({event:"command_visibility_updated",data:{commands:w}}),w=[]}),100)))}return{createIconObject:h,getIconObjectCommand:g,prepareIconOnMenu:function(e){e.forEach((e=>{let t=e.id||e.rawItem&&e.rawItem.id,n=this.getIconObjectCommand(t);if(!n&&e.fonticon&&e.fonticon.content){let t=e.fonticon.content.match(/wux-ui-3ds-(\S*)/);if(t){n=m(t[1])}}n&&(e.icon=n,delete e.fonticon),e.submenu&&prepareIconOnMenu(e.submenu)}))},waitForCommandsIcons:function(){return this._promiseIcons},init:function({iconType:e}={}){this._commandInit=null,this._promiseIcons=e?new Promise((t=>{require(["text!DS/IPClassifyUXUtil/assets/CommandIcons.json"],(n=>{let i=JSON.parse(n);S=i,S&&(S.iconType=e),t(i)}))})):Promise.resolve(),this._initPromise=new Promise(((e,t)=>{Promise.all([this.initialize(),this._promiseIcons]).then((([n,i])=>{var s=n.headers,a=[];for(var o in s){var l=s[o];l.ID=o,!l.icon&&i&&(l.icon=f(l.ID)),a.push(this.loadCommand(l)),a.push(this.loadTooltip(l))}Promise.all(a).then((()=>{e(n)})).catch(t)})).catch(t)}));let t=b();n.subscribe({event:"/WUX/AFR/CMD/"+t+"/DISABLE"},P.bind(this,!1)),n.subscribe({event:"/WUX/AFR/CMD/"+t+"/ENABLE"},P.bind(this,!0)),l.onCommandStart((e=>{y=e._bkTempSelection?e._bkTempSelection:null,e._bkTempSelection=null}),t)},getTempSelection:function(){return y},getCommandByContext:function(e){let t,n=b();if(n){let i=l.getCommands()[n];t=i&&e?l.getCommands()[n][e]:i}else t=l.getCommands(e);return t},getCmdCheckHeaderByContext:function(e){let t=b();return t?l.getCommandCheckHeader(e,t):l.getCommandCheckHeader(e)},getHeaderCtxMenu:function(e){var t=function(e){let t=e.noSizeToFit?e.noSizeToFit:[],n=!0;if(e&&e.cellInfos&&e.cellInfos.columnID&&e.collectionView){let i=e.collectionView.getColumnOrGroup(e.cellInfos.columnID);i&&(n=-1===t.indexOf(i.dataIndex))}var i={pin:!0,sizeColumnToFit:n,firstColumnsVisibility:!1,columnsManagement:!0===e.defaultColumnManagement};return e.collectionView.buildDefaultContextualMenu(e,i)}(e);return t},showLoadingMenu:function(e){var t=null;if(e&&e.data&&e.data.event){var n=[{title:u.Commands_Loading,type:"PushItem",state:"disabled"}];t=c.show(n,{display:void 0,input:"mouse",position:{x:e.data.event.pageX,y:e.data.event.pageY},submenu:"auto"})}return t},getPlaceholderCommands:async function(){let e=await this.getToolbarCommands(),t=[];return e.placeholder&&e.placeholder.forEach((n=>{if(n.Commands&&(n.command=null,n.Commands.every((e=>{let t=this.getCommand(e);return t&&t.isEnabled()&&(n.command=t),!n.command}))),"string"==typeof n){let e=this.getCommand(n);e&&e.isEnabled()&&(n={command:e})}if(n.command){let i=e.headers[n.command.getId()];n.header=i,t.push(n)}})),t},getKeyForProbes:function(){return"FolderWidget"},getContextualMenu:function(e,t,n){return n.isTree=t,n.noSizeToFit=this.noSizeToFit,new Promise((i=>{var s=null;_||(s=this.showLoadingMenu(n)),this.getToolbarCommands().then((a=>{_=!0;var l=!!n.cellInfos&&n.cellInfos.rowID<0,r=[],d=-1,p=null,f=a.ctxMenu;if(l)(r=this.getHeaderCtxMenu(n)).forEach((e=>{let t=null;e.ID&&(t=g(e.ID)),!t&&e.icon&&e.icon.iconName&&(t=m(e.icon.iconName)),t&&(e.icon=t)})),p={ColumnVisibility:!0},f=["ColumnVisibility"];else{var v=!n.cellInfos||!0===n.cellInfos.white_Click;if(t||v){var b=e&&e.length>0?e[0]:void 0;p=this._manageSwitchOfCommands(b,v?[]:void 0,!0,f)}else p=this._manageSwitchOfCommands(void 0,e,!0,f)}var y=Promise.resolve(),S=!1;f.forEach((t=>{if(p[t])if(S=!1,"openWith"===t)y=function(e,t,{keyProbe:n}){let i=g("OpenWith",{defaultIcon:"open-menu-dot"});return o.openWithApps(e,{iconOpenWith:i,nlsOpenWith:u.OpenWith,overrideAppLaunch:t},`${n}_contextual`)}(e,n.overrideAppLaunch,{keyProbe:this.getKeyForProbes()}),d=r.length;else if("DocumentCommands"==t)r.push("DocumentCommands");else{let o=this.getCommand(t);var i=C[t],s=a.headers[t];if(o&&i&&s){var l=h(s);let a=null;n.ipCmdContext&&(a=u["ctxMenu."+t+"."+n.ipCmdContext]),a=a||u["ctxMenu."+t];var c=a||(i.title?i.title:t),m={ID:t,title:c,icon:l,type:"PushItem",action:{callback:()=>{this.launchContextualCommand(t,e,n)}}};null!=s.accelerator&&(m.accelerator=u["ctxMenu."+s.accelerator]),r.push(m)}}else"sep"===t&&r.length>0&&!1===S&&(S=!0,r.push({type:"SeparatorItem"}))}));let w=[];this.getAdditionalCtxCommands&&(w=this.getAdditionalCtxCommands(e,t,n)),w.unshift(y),Promise.all(w).then((e=>{let t=e[0];t&&d>-1&&t.forEach((function(e){r.splice(d++,0,e)}));for(let t=1;t<e.length;t++){let n=e[t];if(n){let e=-1,t=n.ctxHeader;this.prepareIconOnMenu(n),t?(e=r.indexOf(t),e>-1&&(r.splice(e,1),n.forEach((function(t){r.splice(e++,0,t)})))):r=n?r.concat(n):r}}r.length>0&&"SeparatorItem"===r[r.length-1].type&&r.pop(),s&&c.hide(),i(r)}))}))}))},getToolbarCommands:function(){return this._initPromise},getTooltip:function(e){return C[e]},loadCommand:function(e){var t=new Promise((t=>{if(e.ClassName){var n=[e.ClassName];require(n,(n=>{(async()=>{e.context=v(),e.checkByCommand=!0===e.checkByCommand,e.context&&e.context.waitForCtxReady&&await e.context.waitForCtxReady();var i=new n(e);"CATAfrHeaderCheck"===e.Behavior&&i.onStateChange((t=>{this.getModelEvents().publish({event:"toolbar_switch_state",data:{commandID:e.ID,state:t}})})),t()})()}),t)}else t()}));return t.id=e.ClassName,t},loadTooltip:function(e){var n=Promise.resolve(),s=new t({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0,mouseRelativePosition:!1});return C[e.ID]=s,e.HelpResourceFile?(s.loadFromHelpRscFile(e.HelpResourceFile,e.ID),n=new Promise(((t,n)=>{var i,a=(i=e.HelpResourceFile,new Promise((e=>{var t=i.split("/"),n="i18n!"+t[0];t.splice(0,1),n+="/assets/help/"+t.join("/"),require([n],e,e)})));a.then((n=>{let i=e.accelerator?u["ctxMenu."+e.accelerator]:null;s.temp={title:n[e.ID+".Title"]},i&&(s.temp.postTitle=i),t()})).catch(n)}))):e.ResourceFile&&(i.loadResource({resourceFile:e.ResourceFile,language:r.getLanguage()}),n=new Promise((t=>{i.onResourceLoaded({resourceFile:e.ResourceFile},(function(){var n=this.getTitle({key:e.ID});s.setProperties({title:n}),s.temp={title:n,tooltip:n},t()}))}))),n.id=e.ID,n},getModelEvents:function(){},updateCommands:function(e,t){this._switchRunning=!0;let n=this._manageSwitchOfCommands(e,t);this.getModelEvents().publish({event:"check_command_availability",data:{nodes:t,commands:n}}),this._switchRunning=!1,this.getModelEvents().publish({event:"command_availability_updated",data:{nodes:t,treeNode:e}})},launchContextualCommand:function(e,t,n){(a.get()?a.get():s.get()).ctxInfo={nodes:t,options:n},this.launchCommand(e,t,null,"ContextualMenu")},launchCommand:function(e,t,n,i){"ContextualMenu"!==i&&(a.get()?delete a.get().ctxInfo:delete s.get().ctxInfo);var o=function(e){return e&&e.setState(!e.getState()),!!e}(this.getCmdCheckHeaderByContext(e));if(!o){var l=this.getCommandByContext(e);l.isEnabled()||"ContextualMenu"==i?(l._bkTempSelection=t?Array.isArray(t)?t:[t]:null,l.begin()):d.displayNotification({message:u.errorCommandUnavailable,className:"error"})}},getCommand:function(e){var t=this.getCommandByContext(e);return t=t||this.getCmdCheckHeaderByContext(e)},_switchCommand:function(e,t){y=null;var n=this.getCommand(e);if(n)try{n._enableByWidget=t,t?n.enable():n.disable()}catch(n){console.error("Error "+(t?"enabling":"disabling"),e,n)}}}})),define("DS/IPClassifyUXUtil/ObjectsSelectionPanel",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Promise","DS/IPClassifyUtil/IPSettingsMgr","DS/IPClassifyUXUtil/private/ObjectsSearchInput","DS/UIKIT/Iconbar","DS/Controls/Button","DS/Controls/Loader","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewLayout","DS/Utilities/Utils","DS/Windows/ImmersiveFrame","DS/Windows/Panel","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil"],(function(e,t,n,i,s,a,o,l,r,c,d,u,h,p,m,f){"use strict";var g=null,v=null;return t.extend({name:"ipclassify-objselection",defaultOptions:{selectedObjects:[],modelEvents:null,objectsView:null,objectsModel:null,objectsGrid:null,toolbar:null,dgvOptions:{defaultColumnDef:{width:"auto",typeRepresentation:"string"},showRowBorderFlag:!0,alternateBackgroundFlag:!1,placeholder:"",rowSelection:"none",cellSelection:"none",columns:[]},dgvLayoutOptions:{cellHeight:26,columnHeaderHeight:32,rowsHeader:!1}},init:function(t){this._parent(t),this.objectsToSkip=t.objectsToSkip||[],this.objectDataProvider=t.dataProvider,this.placeHolder=t.dataProvider.fetchPlaceHolder(),this.columnsData=t.dataProvider.fetchColumns(),this.checkBoxColumn=this.columnsData.checkBoxColumn,this.objectIdentifier=this.columnsData.objectIdentifier,this.newAttributeUI=t.newAttributeUI;var n=this;this.isReadOnly=t.isReadOnly,g=t.permission,v=t.isPermissionRestrictionEnabled;n.elements.container=e.createElement("div",{class:n.getClassNames("-immersivePanel")});var i=new p({});new m({immersiveFrame:i,title:t.panelHeader,content:n.elements.container,position:{my:"center",at:"center",of:i},height:400,width:800,resizableFlag:!0}).addEventListener("close",(function(e){n.options.modelEvents.publish({event:n.options.cancelOrCloseEventName,data:{restore:!0}})})),n._buildBody().then(n._buildFooter.bind(n)).done((function(){n.__setToolbarCmds(),e.is(n.elements.loader)||(n.elements.loaderDiv=e.createElement("div",{class:n.getClassNames("-loader")}).inject(n.elements.content),n.elements.loader=(new l).inject(n.elements.loaderDiv),n.elements.loader.getContent().addClassName("ipobjselect-loader")),n.elements.loaderDiv.removeClassName("hidden"),n.elements.nextButton.disabled=!0,n.elements.loader.on(),n._buildObjectsView().then((function(){n.elements.loaderDiv.addClassName("hidden"),n.elements.loader.off()})),n.options.modelEvents.publish({event:n.options.cancelOrCloseEventName,data:{html:i}})}))},destroy:function(){this.options.toolbar.destroy(),this.options.objectsGrid.destroy(),this.options.objectsGrid=null,this._parent()},_buildBody:function(){var t=this;return new n((function(n,i){var s=e.createElement("div",{class:t.getClassNames("-toolbar-container")}).inject(t.elements.container);t.elements.content=e.createElement("div",{class:t.getClassNames("-content")}).inject(t.elements.container),t._generateToolbar({renderTo:s}),n()}))},_buildFooter:function(){var t=this;return new n((function(n,i){t.elements.footer=e.createElement("div",{class:t.getClassNames("-footer")}).inject(t.elements.container);var s=t.elements.nextButton=new o({label:t.options.okButtonLabel||"Add",emphasize:"primary",touchMode:!0});s.addEventListener("buttonclick",(function(){t.options.modelEvents.publish({event:t.options.okEventName,data:{selectedObjects:t.options.selectedObjects}}),t.options.modelEvents.publish({event:t.options.cancelOrCloseEventName,data:{restore:!0}}),t.destroy()})),s.inject(t.elements.footer);var a=t.elements.closeButton=new o({label:t.options.cancelButtonLabel||"Cancel",emphasize:"secondary",touchMode:!0});a.addEventListener("click",(function(){t.options.modelEvents.publish({event:t.options.cancelOrCloseEventName,data:{restore:!0}}),t.destroy()})),a.inject(t.elements.footer),n()}))},_buildObjectsView:function(){var t=this;return new n((function(n){t.options.objectsView=e.createElement("div",{class:t.getClassNames("-objectsView ipclassify-objselection-chooser-view")});var s=e.createElement("div",{class:t.getClassNames("-objectsView-Dgv ipclassify-objselection-dgv-container")}).inject(t.options.objectsView);t.columnsData&&t.columnsData.columns&&(t.options.dgvOptions.columns=t.columnsData.columns),t.placeHolder&&(t.options.dgvOptions.placeholder=t.placeHolder);var a=e.extend({identifier:"ObjectsSelectionPanel-"+i.getUniqueId()},e.clone(t.options.dgvOptions));a.layout=new u(t.options.dgvLayoutOptions);var o=t.options.objectsGrid=new d(a);o.onContextualEvent=function(){return[]},o.getCellTooltip=function(e){var n=t.options.objectsGrid.getColumnOrGroup(e.columnID),i=n.dataIndex;return e.dataIndex=i,-1===e.rowID?{shortHelp:n.tooltip,updateModel:!1}:"tree"==i?{shortHelp:e.nodeModel.getLabel(),updateModel:!1}:{shortHelp:"attrSel"!==i?e.nodeModel.options.grid[i]:"",updateModel:!1}}.bind(this),t.options.objectsModel=new r({}),o.treeDocument=t.options.objectsModel,o.getContent().addClassName("ipobjselectdatagridview loading"),o.getContent().inject(s),t.options.objectsView.inject(t.elements.content),o.onReady((function(){t._updateObjectsViewModel().then((function(){o.getContent().removeClassName("loading"),o.sortModel=t.objectDataProvider.initialSortModel(),n()})),o.addEventListener("change",t._changeGridObjects.bind(t))}))}))},_changeGridObjects:function(e,t){var n=this.options.objectsGrid;if(t&&t.nodeModel&&t.nodeModel.options.grid&&n.layout.getDataIndexFromColumnIndex(t.columnID)===this.checkBoxColumn){for(var i=-1,s=0,a=this.options.selectedObjects.length;-1===i&&s<a;){if(this.options.selectedObjects[s].name===t.nodeModel.getReferenceValue(this.objectIdentifier)){i=s;break}s++}!0===t.nodeModel.options.grid[this.checkBoxColumn]?-1===i&&this.options.selectedObjects.push({name:t.nodeModel.getReferenceValue(this.objectIdentifier)}):-1!==i&&this.options.selectedObjects.splice(i,1),a=this.options.selectedObjects.length,this.elements.nextButton.disabled=0===a}},_generateToolbar:function(t){var n=this,i=h.debounce((function(e){n.options.objectsModel.withTransactionUpdate((function(){var t=e.searchStr,i=!0;n.options.filterInProgress=!0,n.options.objectsModel.search({match:function(e){var s=!0;if(n.currentSelectFilter){var a=e.nodeModel.getReferenceValue(n.checkBoxColumn);("selected"==n.currentSelectFilter&&0==a||"unselected"==n.currentSelectFilter&&1==a)&&(s=!1)}n.objectDataProvider.searchMatchCriteria(t,e)&&s?(e.nodeModel.show(),t.length>0&&i?(e.nodeModel.select(!0),e.nodeModel.matchSearch(),i=!1):(e.nodeModel.unmatchSearch(),e.nodeModel.unselect())):(e.nodeModel.unmatchSearch(),e.nodeModel.unselect(),e.nodeModel.hide())}}),n.options.filterInProgress=!1})),n.options.objectsModel.getXSO().onPostAdd((function(){})),n.options.objectsModel.getXSO().onPostRemove((function(){}))}),500);this.elements.toolbar=e.createElement("div",{class:this.getClassNames("-toolbar")}).inject(t.renderTo);var a=e.createElement("div",{class:this.getClassNames("-toolbar-input")}).inject(this.elements.toolbar);this.elements.toolbarIconbar=e.createElement("div",{class:this.getClassNames("-toolbar-iconbar")}).inject(this.elements.toolbar),this.elements.toolbarSearch=new s({events:{onSearch:i}}).inject(a)},__setToolbarCmds:function(){var e=this;e.currentSelectFilter="none";var t=function(){e.options.objectsModel.withTransactionUpdate((function(){for(var t=document.querySelector(".ipobjects-search-input-input"),n=e.options.objectsModel.getRoots(),i=e.currentSelectFilter,s=0;s<n.length;s++){var a=!0;switch(t&&""!=t.value&&(a=e.objectDataProvider.searchMatchCriteria(t.value,n[s]._getNodeInfos())),i){case"none":a?n[s].show():n[s].hide();break;case"selected":!0===n[s].getReferenceValue(e.checkBoxColumn)&&a?n[s].show():n[s].hide();break;case"unselected":!1===n[s].getReferenceValue(e.checkBoxColumn)&&a?n[s].show():n[s].hide()}}})),e.options.objectsModel.getXSO().onPostAdd((function(){})),e.options.objectsModel.getXSO().onPostRemove((function(){}))},n={fonticon:"filter",text:f.ObjectsSelectionPanel_FilterRows||"Filter Rows",name:"filter",content:{type:"dropdownmenu",options:{items:[{fonticon:"block",text:f.ObjectsSelectionPanel_FilterNone||"Show All",name:"none",selectable:!0,selected:!0},{fonticon:"checkbox-on",text:f.ObjectsSelectionPanel_FilterSelected||"Show selected",name:"selected",selectable:!0},{fonticon:"checkbox-off",text:f.ObjectsSelectionPanel_FilterNotSelected||"Show not selected",name:"unselected",selectable:!0}],events:{onClick:function(n,i){!function(n){e.currentSelectFilter=n;var i=document.querySelector("ul.iconbar-items-wrap.iconbar-items-icons li[name='filter']");i&&("selected"==n||"unselected"==n?i.classList.add("active"):i.classList.remove("active")),t()}(i.name)},onClickOutside:function(t,n){var i=document.querySelector("ul.iconbar-items-wrap.iconbar-items-icons li[name='filter']");i&&("selected"==e.currentSelectFilter||"unselected"==e.currentSelectFilter?i.classList.add("active"):i.classList.remove("active"))}}}}},i={fonticon:"plus",text:f.ObjectsSelectionPanel_NewAttributes||"New Attributes",name:"newAttributes",content:{type:"dropdownmenu",options:{items:[{id:"string",name:"String",text:f.ObjectsSelectionPanel_ATTRIBUTE_string||"String",selectable:!0,selected:!0},{id:"integer",name:"Integer",text:f.ObjectsSelectionPanel_ATTRIBUTE_integer||"Integer",selectable:!0},{id:"real",name:"Double",text:f.ObjectsSelectionPanel_ATTRIBUTE_real||"Real",selectable:!0},{id:"boolean",name:"Boolean",text:f.ObjectsSelectionPanel_ATTRIBUTE_boolean||"Boolean",selectable:!0},{id:"date",name:"Date",text:f.ObjectsSelectionPanel_ATTRIBUTE_date||"Date",selectable:!0},{id:"attrWithDim",name:"DoubleWithDim",text:f.ObjectsSelectionPanel_ATTRIBUTE_attrWithDim||"Attribute with dimension",selectable:!0}],events:{onClick:function(t,n){(new e.newAttributeUI).loadAttrCreatePanel({attrType:n.name,container:e.elements.container,changeGridObjects:e._changeGridObjects.bind(e),grid:e.options.objectsGrid})}}}}},s=(f.ObjectsSelectionPanel_ImportAttributes,{className:"divider"}),o=[];if(!this.options.toolbar){"Architect"!=g&&v||(o.push(s),o.push(i)),o.push(s),o.push(n);var l={renderTo:this.elements.toolbarIconbar,items:o};this.options.toolbar=new a(l),this.options.toolbar.elements.container.setStyle("display",void 0)}},_updateObjectsViewModel:function(){var e=this;return new n((function(t){e.objectDataProvider.fetchTheObjects().then((function(n){(n.objectsList||[]).forEach((function(t){if(!e.objectsToSkip[t.grid[e.objectIdentifier]]){var n=new c({label:t.label,icons:t.icons,grid:t.grid});e.options.objectsModel.addRoot(n,void 0)}})),t({})}))}))}})})),define("DS/IPClassifyUXUtil/service/IPClassifyUXUtilWebService",["UWA/Core","DS/WAFData/WAFData","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/IPSettingsMgr","DS/IPClassifyUtil/IPServicesMgr","DS/PADUtils/PADUtilsServices","DS/WidgetServices/WidgetServices","DS/PADUtils/PADSettingsMgt","DS/IPClassifyUXUtil/utils/CancellablePromise","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil","DS/ClassificationProp/utils/ClassifPropControl"],(function(e,t,n,i,s,a,o,l,r,c,d){"use strict";function u(e){let t=null,n=null;return e&&(n=new r((n=>{t=o._getServiceUrlAsync(e,{onComplete:n})})),n.addLinkedQuery(t)),n||r.resolve()}let h=null;var p={getSourceURI:u,getCSRF:function(){return h||(h=new r(((e,t)=>{this._executeQuery("/resources/v1/application/CSRF",{type:"json",inSource:"3DSpace"},"getCSRF").then((t=>{if(200!==t.statusCode)throw{err:c.csrfError};e(t.csrf)})).catch((e=>{h=null,t(e)}))})),h.onCancel((()=>{h=null}))),h},splitIdForSearch:function(e,t,n){n=n||0;let i=e+":(",s=0,a=[];return t.forEach((t=>{s++;let o=i.length;o+=n+8+t.length,o>16e3||s>=1e3?(i+=")",a.push(i),i=e+":(",s=0):i+=(1!==s?" OR ":"")+'"'+t+'"'})),s>0&&(i+=")",a.push(i)),a},getUserPreferencesX:function({repository:e,preferences:t,withTenant:i,formatAnswer:s}){let a=null;return a=this._executeQuery("/resources/AppsMngt/user/getPreferences",{method:"GET",inSource:"3DCompass",withoutTenant:!0,query:{name:t[0]+(i?n.getTenantId():"")},headers:{SecurityContext:void 0}}),a},canMembersCreateCS:function(){return this._executeQuery("/resources/v1/FolderManagement/Folder/membersCanCreateCS",{withoutSC:!0,type:"json",headers:{"Content-Type":"application/json"}})},setUserPreferences:function({repository:e,preferences:t,withTenant:i}){let s=null;return s=t[0].value.length>8e3?r.reject(c.error_maxLimit_pref):this._executeQuery("/resources/AppsMngt/user/preference",{method:"PUT",inSource:"3DCompass",withoutTenant:!0,headers:{SecurityContext:void 0,"Content-Type":"application/x-www-form-urlencoded"},data:{name:t[0].name+(i?n.getTenantId():""),value:t[0].value}}),s},getUserPreferences:function(e){let t=e.repository?e.repository:widget.getValue("x3dAppId");return this.getUserPreferencesX({withTenant:e.withTenant,repository:t,preferences:[e.name],formatAnswer:function(e){return e}})},saveUserPreferences:function(e){let t=e.repository?e.repository:widget.getValue("x3dAppId"),n=t+"_"+e.name;this._lastPrefToSave||(this._lastPrefToSave={}),this._lastPrefToSave[n]=e,this._lastRequests||(this._lastRequests={}),this._lastRequests[n]&&this._lastRequests[n].cancel(),this._lastRequests[n]=null;var i=this._lastPrefToSave[n];let s=r.resolve();return i&&(s=this._lastRequests[n]=this.setUserPreferences({withTenant:e.withTenant,repository:t,preferences:[{name:i.name,value:i.value}]}),delete this._lastPrefToSave[n]),s},getObjectContent:function(e){var t={};UWA.extend(t,e);t.payload={},t.payload.select_predicate=["physicalid"];var n=new Date,s=Math.random().toString(36).substring(2,9);t.payload.label=("getObjectContent"+s+"_"+n.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-");var o=widget.lang?widget.lang:widget.getValue("lang");t.payload.start=0,t.payload.nresults=1e3,t.payload.locale=o,t.payload.tenant=a.getPlatformId(),t.payload.with_Idx_Search="true",t.payload.with_indexing_date="true",t.payload.with_relationship_search=!1,t.filters&&(t.payload.refine=t.filters),t.payload.login={"3dspace":{SecurityContext:i.getWebCredential()||l.getSetting("pad_security_ctx")}},t.headers={"content-type":"application/json"},t.data=UWA.Json.encode(t.payload),t.method="POST",t.inSource="3DSearch",t.timeout=12e4;let r=t.elementsPerSource;if(t.pid){var c=[...t.pid],d=c;Array.isArray(c)||(d=[c]),r=[{ids:d,source:"3dspace",serviceId:"3DSpace",key:"physicalid"}]}let u=[];return r.forEach((e=>{let t=e.ids,n=e.key;this.splitIdForSearch(n,t).forEach((t=>{u.push({query:t,source:e.source,serviceId:e.serviceId,key:e.key})}))})),this._getObjectContent("/search",t,u)},_getObjectContent:function(e,t,i){var s=null,a=new r(((o,l)=>{let r=i.shift();r?(t.payload.query=r.query,t.payload.source=[r.source],t.data=UWA.Json.encode(t.payload),t.type="json",(s=this._executeQuery(e,t,"getObjectContent")).then((c=>{c.results&&c.results.forEach((e=>{e.query={source:r.source,serviceId:r.serviceId,key:r.key}})),(s=this._getObjectContent(e,t,i)).then((e=>{let t=n.concatJsonValue(e,c);o(t)})).catch(l),a.addLinkedQuery(s)})).catch(l)):o()}));return a.addLinkedQuery(s),a.cancel=s?s.cancel:()=>{},a},setPreferredSecurityContext:function(e){return this._executeQuery("/resources/pno/person/setsecuritycontext",{method:"POST",type:"json",query:{SecurityContext:e}},"setPreferredSecurityContext")},getscandcollab:function({tenant:e,onlyPreferred:t}){var n="/resources/modeler/pno/person?select=preferredcredentials"+(t?"":"&select=collabspaces");let i={};return i.query={current:!0,tenant:e},i.type="json",i.cache=-1,i.withoutSC=!0,this._executeQuery(n,i,"getscandcollab")},getConnectedUserInfo:function(){let e={};return e.withoutSC=!0,e.type="json",e.headers={"content-type":"application/json"},p._executeQuery("/resources/modeler/pno/person?current=true&select=firstname&select=lastname",e,"getUser").then((e=>{let t=null;return e&&(t={...e,firstName:e.firstname,lastName:e.lastname,login:e.name},s.setUser(t)),t}))},fetchSubTypes:function(e){let t=e;return t.type="json",t.method="POST",t.inSource="3DSpace",t.headers={"content-type":"application/json"},t.data=UWA.Json.encode(t.payload),t.timeout=12e4,p._executeQuery("/resources/v1/FolderManagement/Folder/getSubTypes",t,"getSubTypes")},getTypesHierarchy:function(e){var t={};UWA.extend(t,e);var n="/resources/enong/dico/gettypeshierarchy?tenant="+a.getPlatformId();return t.method="POST",t.inSource="3DSpace",t.headers={Accept:"application/json","Content-Type":"application/json"},t.data=JSON.stringify({types:e.types}),t.timeout=12e4,this._executeQuery(n,t,"getTypesHierarchy")},getAllUserCredentials:function({tenant:e}){return this._executeQuery("/resources/vplmte/getallctx",{query:{tenant:e},withoutSC:!0,type:"json"},"getAllCredentials")},getCreateCredentials:function({type:e,tenant:t}){let n=`/resources/vplmte/getcreatectx?type=${e}`;return this._executeQuery(n,{query:{tenant:t},withoutSC:!0,type:"json"},"getCreateCredentials")},_executeQuery:function(e,t,n){let i=[],s=null,a=null,o=null;t.inSource||e.startsWith("http")||(t.inSource="3DSpace"),t.inSource&&(s=u(t.inSource)),t.withCSRF&&(a=this.getCSRF()),t.withChangeCtx&&(o=new Promise((e=>{require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],(function(t){let n={};if(t)try{let e=t.get();n={"DS-Change-Authoring-Context":e.AuthoringContextHeader?e.AuthoringContextHeader["DS-Change-Authoring-Context"]:void 0,"DS-Configuration-Authoring-Context":e.AuthoringContextHeader?e.AuthoringContextHeader["DS-Configuration-Authoring-Context"]:void 0}}catch(e){console.log(e)}e(n)}))}))),i.push(s),i.push(a),i.push(o);let l=new r(((s,a)=>{Promise.all(i).then((i=>{let o=i[0],r=i[1],c=i[2];t.headers=t.headers?t.headers:{},o&&(e=o+e),r&&(t.headers[r.name]=r.value),c&&(t.headers={...t.headers,...c});var d;t.onTimeout=function(e){"object"!=typeof e&&(e={message:e}),e.timeout=!0,a({err:e})},t.onFailure=function(e,n){let i={err:e,serverErr:n};i=t.formatError?t.formatError(i):i,a(i)},t.onComplete=function(e){e=t.formatAnswer?t.formatAnswer(e):e,s(e)},d=this._executeRequest(e,t,n),l.addLinkedQuery(d)})).catch(a)}));return l.addLinkedQuery(s),l},_executeQueryWithError:function(e,t,n){var i={};UWA.extend(i,t);let s=this;return new r((function(a,o){let l=s._executeQuery(e,i,n).then((e=>{let n=function(e){let t=null;return e.hasOwnProperty("errors")&&e.errors.every((e=>{let n="UNKNOWN_META"===e.code;if(n){let n="",i=e.reason.match(/\[([^]*)\]/);if(i){let e=i[1].split(".");n=e[e.length-1]}t={...c.treeExpandUnknownMeta},t.subtitle=c.replace(t.subtitle,{attrName:n})}return!n})),t}(e);if(n)throw{serverErr:n,err:n};t.onComplete&&t.onComplete(e),a(e)})).catch((({err:e,serverErr:n})=>{t.onFailure&&t.onFailure(e,n),o({err:e,serverErr:n})}));this.addLinkedQuery(l)}))},_executeRequest:function(e,s,a){var r=Math.round(1e3*Math.random()).toString(),u=widget.id+"_"+widget.getTitle()+"_";window.performance.mark("Request_begin"+r);var h={};UWA.extend(h,s),h.method=h.method?h.method:"GET",UWA.is(h.onTimeout,"function")||(h.onTimeout=function(){var e={type:"timeout",toString:function(){return c.msg_InfoAction_Timeout}};h.onFailure(e)},h.onComplete=function(e){window.performance.mark("LibraryRequest_end"+r);var t=window.performance.getEntriesByName("LibraryRequest_begin"+r);t&&1===t.length&&(window.performance.measure(u+"_Request"+a,"Request_begin"+r,"Request_end"+r),window.performance.clearMarks("Request_end"+r),window.performance.clearMarks("Request_begin"+r)),s.onComplete&&s.onComplete(e)});var p={Accept:"application/json","Accept-Language":widget.lang?widget.lang:widget.getValue("lang")};let m=!!s.headers&&s.headers.SecurityContext;if(m||s.withoutSC&&!s.withSecurityToken||(m=s.SecurityContext||i.getWebCredential(),m||(m=l.getSetting("pad_security_ctx")||d.getContext()),m&&!s.withoutSC&&(p.SecurityContext=m)),s.headers?h.headers=UWA.extend(p,s.headers):h.headers=p,s.withSecurityToken&&(h.headers.SecurityToken=n.getUserLogin()+"|"+m+"|preferred"),s.plmNewContextProvider&&"function"==typeof s.plmNewContextProvider){let e=null;e=s.plmNewContextProvider(),e&&(p.SecurityContext=e)}UWA.is(h.query)||(h.query={}),h.query.tenant||!0===s.withoutTenant||(h.query.tenant=o.getTenantID());var f=e;return 0!==Object.keys(h.query).length&&(f+=(e.indexOf("?")<0?"?":"&")+UWA.Utils.toQueryString(h.query)),t.authenticatedRequest(f,h)}};return p})),define("DS/IPClassifyUXUtil/tagger/TaggerIPProxy",["DS/IPClassifyUtil/IPSettingsMgr","DS/IPClassifyUXUtil/tagger/IPTaggerProxyAbstract","DS/WidgetServices/WidgetServices","DS/TagNavigatorProxy/TagNavigatorProxy","DS/IPClassifyUtil/IPClassifyUtility","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/IPClassifyUXUtil/tagger/IPWebInWinTaggerProxy","DS/IPClassifyUXUtil/utils/CancellablePromise","DS/IPClassifyUXUtil/service/IPClassifyUXUtilWebService"],(function(e,t,n,i,s,a,o,l,r){function c(){return"BookmarkEditor"+Math.random().toString(36).substring(2,9)}function d(e){if(matchingIds=[],e){var t=e.results;if(t)for(let e=0;e<t.length;++e){let n=t[e].attributes;for(let e=0;e<n.length;++e)if("resourceid"===n[e].name){matchingIds.push(n[e].value);break}}}return matchingIds}function u(e,t){let n=t[e];return n||e}var h="R2019x";function p(e){let t=function(e){var t={};return e&&e.forEach((e=>{if(e.sixw&&"date"!==e.type){let n=e.sixw.lastIndexOf("/"),i=n>0?e.sixw.substring(n+1):e.sixw;e.nlsKey=i;let s=t[i];s||(s=t[i]=[]),Array.isArray(e.object)?e.object.forEach((t=>s.push({value:t,source:e.sources?e.sources:["3DSpace"]}))):s.push({value:e.object,source:e.sources?e.sources:["3DSpace"]})}})),t}(e);return new Promise((i=>{a.getNlsOfPropertiesValuesBySource(t,{tenantId:n.getTenantID(),lang:n.getLanguage(),apiVersion:h,onComplete:function(t){!function(e,t){e.forEach((e=>{if(e.nlsKey){let n=t[e.nlsKey];if(n){let t=[];Array.isArray(e.object)?e.object.forEach((e=>{t.push(u(e,n))})):t=u(e.object,n),e.dispValue=t}}}))}(e,t),i()},onFailure:function(e){console.warn("IP Cannot retrieve NLS"),i()}})}))}async function m(e,t,{withoutTranslation:n}={}){var i={},s=t;return!n&&s.facets&&await p(s.facets),e&&e.facets&&(e.facets.forEach((e=>{i[e.sixw+e.object]=e})),t.facets&&t.facets.forEach((e=>{let t=i[e.sixw+e.object];t?t.count+=e.count:i[e.sixw+e.object]=e})),s.facets=Object.values(i)),e=s,s}class f extends t{constructor(t,a){super(t),this._waitingPromises=[],this._filterTags={},this._appFilters={},this._onlyLocal=!0===a.onlyLocal,this._additionalProxies={},this._allIds=new Set,this._alreadyManagedIds={},this._isFocusOnObjects=!1,this._name=a.name,this._excludedIdsFromFiltering={},this._applyTaggerTags=!0;let l=!!window.widget&&e.isWebInWin(),r=null;r=window.isReplayODT?n.getTenantID():s.getTenantId(),"boolean"!=typeof r&&null!=r||(r="OnPremise");let d={appId:widget.getValue("x3dAppId"),tenant:r,widgetId:window.widget&&widget.id?widget.id:c(),name:this._name,filteringMode:"FilteringOnServer"};for(var u in a)d[u]=a[u];let h=null;l?(window.widgetId||(window.widgetId=c()),d.widgetId=window.widgetId,d.events.addFilterChangeListener=this.onFilterBIFilteringEvent.bind(this),d.events.addCriteriaChangeListener=this.onFilterBIFilteringEvent.bind(this),h=this.taggerProxy=new o(d)):h=this.taggerProxy=i.createProxy(d),window.widget&&widget.addEvent("onResize",(()=>{"fullscreen"!==widget.getView().type&&this.focusOnObjects()})),this.setTaggerProxy(h)}activate(e){this.resetTags(),super.activate(e),this.handleEvents()}enableTaggerTags(){this._applyTaggerTags=!0}disableTaggerTags(){this._applyTaggerTags=!1}async _concatFacets(e){return m(this._previousTags,e)}async addTags(e){if(e){let t=new l((async t=>{t(await this._concatFacets(e))})),n=t.then((e=>{this._setTags(e)}));this._waitingPromises.push(t),await n}}focusOnObjects(e){var t=widget.getView().type;e&&Object.keys(e).length>0&&"fullscreen"===t&&this.facetsComputationActives()?(this._selectionQuery=r.getObjectContent({elementsPerSource:e}),this._selectionQuery.then((async e=>{let t=function(e){var t={},n={};if(e)for(var i=0;i<e.length;i++){var s=e[i],a=s.attributes;let d=s.query,u=d.source,h=d.serviceId,p=d.key;var o=[];let m;for(var l=0;l<a.length;l++){var r=a[l];if("resourceid"==r.name)m=r.value;else if("ds6w_facet"==r.format){var c={};c.field=r.field,c.object=r.value,c.sixw=r.name,c.sources=[u],c.type=r.type,c.count=1,o.push(c)}}t[("physicalid"===p?"pid://":"")+m]=o,n[("physicalid"===p?"pid://":"")+m]=h}return{subjects:t,sources:n}}(e.results),n=e.facets;n&&await p(n),this._filter.setTags(t.subjects,n),this._filter.focusOnSubjects(Object.keys(t.subjects),void 0,t.sources),this._isFocusOnObjects=!0}))):this._isFocusOnObjects&&(this._filter.unfocus(),this._isFocusOnObjects=!1,this.resetTags())}clearTags(){this._allIds=new Set,this._alreadyManagedIds={},this.cancelTagQuery(),this._waitingPromises.forEach((e=>{e.cancel()})),this._waitingPromises=[],this.removeTags()}removeTags(){this._setTags({facets:[]}),this._filter.unsetTags()}resetTags(){this._filter.setTags(null,this._previousTags?this._previousTags.facets:[])}_setTags(e){this._previousTags=e,e&&e.facets&&e.facets.length>0?this._filter.setTags(null,e.facets):this._filter.unsetTags()}cancelTagQuery(){this._tagQuery&&this._tagQuery.cancel(),this._tagQuery=null}reloadObjects(){this._allIds.forEach((e=>{this._alreadyManagedIds[e]=!0}))}facetsComputationActives(){let e=!0,t=Object.values(this._additionalProxies);return t.length>0&&(e=!1,t.forEach((t=>{e=e||t.facetsComputationActives()}))),e}addObjectsTags(e,t){if(!this.facetsComputationActives())return Promise.resolve(e);var n=!0!==t,i=[],s=[];e.forEach((e=>{!0!==this._alreadyManagedIds[e]?(i.push(e),this._alreadyManagedIds[e]=!!n||1):s.push(e),this._allIds.add(e)}));let a=this.getFilterTags(),o=a&&Object.keys(a).length>0?s:null,l=Promise.resolve(o);return n&&i.length>0&&(this._tagQuery=r.getObjectContent({pid:i,filters:this.getFilterTags()}),l=new Promise(((e,t)=>{this._tagQuery.then((t=>{let n=this.getFilterTags(),i=null;if(n&&Object.keys(n).length>0){let e=d(t);i=[...s,...e]}e(i),this.addTags(t)})).catch(t)}))),l}setUpdateMode(e){this._updateMode=e}addTagsFromProxy(e){this._additionalProxies[e._name]=e}deleteTagsFromProxy(e){delete this._additionalProxies[e._name]}hasANDConditionInRefine(e,t){if(t&&e)for(var n in e){let i=t[n];if(i&&i.length>0){let t=e[n],a=!0;if(i.every((e=>(t.every((t=>(a=s.compareJsonValue(e,t),a))),a))),!a)return!0}}return!1}applyFilterIfAny(e){var t=this.getFilterTags();let i=t||[],s=!1;if(this._additionalProxies){for(var a in this._additionalProxies){let e=this._additionalProxies[a].getFilterTags();e&&(s=s||this.hasANDConditionInRefine(i,e),i={...i,...e})}Object.keys(i).length>0&&(t=i)}if(t&&(e||Object.keys(t).length>0)){var o=[];if(!1!==this._updateMode)o=Object.keys(this._alreadyManagedIds);else for(var a in this._alreadyManagedIds)!0===this._alreadyManagedIds[a]&&o.push(a);var l=Object.keys(t).length>0;let i=s?{results:[],infos:{}}:void 0;this._filterQuery=Promise.resolve(i),!i&&o.length>0&&(this._filterQuery=r.getObjectContent({pid:o,filters:t})),this._previousTags={},this._currentQueryCancel&&(this._currentQueryCancel.cancel(),this._currentQueryCancel=null);let c=this._currentQueryCancel=n.getCancelObject();this._filterQuery.then((t=>{if(c.isCancelled())return;var n=this._updateMode?o:void 0;if(t&&(t.results||l)){n=d(t);var i={};n.forEach((e=>{i[e]=this._alreadyManagedIds[e]})),this._alreadyManagedIds=i,e&&this.addTags(t)}this.getObjectsToRemoveFromFiltering(t&&t.infos).forEach((e=>{n.push(e)})),this._model.publish({event:"filterUpdated"+this._name,data:{matchingIds:n,hasFilter:l}})})).catch((e=>{console.log("Can't get object content for tagging:"),console.log(e)}))}}onFilterBIFilteringEvent(e){let t={};!this._onlyLocal&&e.allfilters&&0!==Object.keys(e.allfilters).length?t=e.allfilters:e.localfilters&&0!==Object.keys(e.localfilters).length&&(t=e.localfilters),s.compareJsonValue(t,this.getTaggerTags())?this.resetTags():(Object.keys(t).length>0&&this.enableTaggerTags(),this._filterTags=t,this._applyTaggerTags?this.applyFilterIfAny(!0):this.resetTags(),this._model.publish({event:"taggerUpdated"+this._name,data:{filter:t}}))}addObjectsToRemoveFromFiltering(e){for(let t in e)this._excludedIdsFromFiltering[t]=e[t]}_getExcludedIdsRemoveFromFiltering(){let e={...this._excludedIdsFromFiltering};if(this._additionalProxies)for(var t in this._additionalProxies){let n=this._additionalProxies[t]._getExcludedIdsRemoveFromFiltering();n&&(e={...e,...n})}return e}getObjectsToRemoveFromFiltering(e){let t=[],n=null;if(e&&e.sources){let t=e.sources.find((e=>"3DSpace"===e.service));t&&t.indexingDate&&(n=t.indexingDate.allvaultsacl)}if(n){let e=this._getExcludedIdsRemoveFromFiltering();for(let i in e)e[i].modified>n?t.push(i):delete this._excludedIdsFromFiltering[i]}return t}getTaggerTags(){return this._filterTags}mergeRefineTags(e,t){for(let n in t){let i=e[n],s=t[n],a=!i;if(s&&i){a=!0;let e=new Set;s.forEach((t=>{e.add(t.object)})),i.find((t=>e.has(t.object)))||(n+="_toFail")}a&&(e[n]=s)}return e}getFilterTags(){let e=this._applyTaggerTags?UWA.clone(this.getTaggerTags()):{},t=this._appFilters;return this.mergeRefineTags(e,t),e}setApplicationFilter(e){this._appFilters=e}setLocalFilter(e){this._filterTags=e,this.getProxy().setLocalFilter(e)}isFilterActives(){return!!this._filterTags&&Object.keys(this._filterTags).length>0}handleEvents(){this.isActive()?this._filter.addEvent("onFilterChange",this.onFilterBIFilteringEvent,this):this._filter.removeEvent("onFilterChange",this.onFilterBIFilteringEvent,this)}getAllTags(){return this._previousTags}}return f.IPConcatFacets=m,f})),define("DS/IPClassifyUXUtil/private/CredentialsManager",["DS/IPClassifyUXUtil/private/CredentialsConverter","DS/IPClassifyUXUtil/service/IPClassifyUXUtilWebService","DS/IPClassifyUtil/IPSettingsMgr"],(function(e,t,n){"use strict";return{getAvailableCredentials:async function({defaultSC:n,tenant:i,withPreferred:s}){let a=t.getAllUserCredentials({tenant:i});s&&!n&&(n=await async function({tenant:e}){let n=await t.getscandcollab({onlyPreferred:!0,tenant:e}),i=null;if(n.preferredcredentials){let e=n.preferredcredentials.collabspace,t=e?e.name:null,s=n.preferredcredentials.organization,a=s?s.name:null,o=n.preferredcredentials.role,l=o?o.name:null;t&&a&&l&&(i=`ctx::${l}.${a}.${t}`)}return i}({tenant:i}));let o=await a;return e.computeCredentials([...o.credentials],{defaultSC:n,withRoles:!0})},getCreateCredentials:async function({type:i,defaultSC:s,tenant:a}){let o=await t.getCreateCredentials({type:i,tenant:a});return s=s||n.getCredential(),e.computeCredentials(o.credentials,{defaultSC:s})}}})),define("DS/IPClassifyUXUtil/PlatformCredSelector",["UWA/Core","DS/Controls/ComboBox","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/IPClassifyUtil/IPClassifyModelEvents","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUXUtil/private/CredentialsManager","DS/IPClassifyUXUtil/utils/CancellablePromise","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSettingsMgt","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil","DS/IPClassifyUtil/IPSettingsMgr","css!DS/IPClassifyUXUtil/IPClassifyUXUtil"],(function(e,t,n,s,a,o,r,c,d,u,h,p,m){return PlatformCredSelector={setCredential:function(e,t){widget.setValue("pad_security_ctx",e.value),widget.setValue("xPref_CREDENTIAL",e.value?e.value.replace("ctx::",""):""),u.setSetting("pad_security_ctx",e.value),m.setSetting("pad_security_ctx",e.value),function(e){u.dispatchEvent("onPad_security_ctx",e),a.publish({event:"onPad_security_ctx",data:e})}(e.label),h.displayNotification({message:p.replace(p.credentialChanged,{credential:e.label}),className:"primary"})},render:async function(f,g){var v=this;let b=e.createElement("div");e.createElement("p",{text:f?p.replace(p.platformSelection_message,{name:d.getPlatformId()}):p.credentialSelection_message}).inject(b);let y=null,C=[],_=null,S=[];await new c((async(i,o)=>{if(f){let c=require("DS/IPClassifyUtil/IPServicesMgr");if(C=await c.getTenantsPref(),!C||0==C.length)return u.dispatchEvent("onNoPlatform"),a.publish({event:"onNoPlatform"}),void o();let d=-1,h=[];new Promise(((e,t)=>{for(let n=0;n<C.length;++n)r.getAvailableCredentials({tenant:C[n].value}).then((i=>{i&&i.credentials&&i.credentials.length>0?(h=i.credentials,d=n,e()):n===C.length-1&&(u.dispatchEvent("onNoSecurityContext"),a.publish({event:"onNoSecurityContext"}),t())}))})).then((function(){var c=this;(d<0||0===h.length)&&(u.dispatchEvent("onNoSecurityContext"),a.publish({event:"onNoSecurityContext"}),o()),y=C[d].value,c._tenantTreeDocument=new n;for(let e=d;e<C.length;++e){var m=new s({label:C[e].label,value:C[e].value});c._tenantTreeDocument.addRoot(m)}c._platformComboBox=new t({elementsTree:c._tenantTreeDocument,enableSearchFlag:!1}),c._platformComboBox.addEventListener("change",(function(e){let t=c._tenantTreeDocument.getRoots()[c._platformComboBox.selectedIndex];y=t.options.value,c._credentialsComboBox.elementsTree.removeRoots(),r.getAvailableCredentials({tenant:y}).then((e=>{if(e&&e.credentials&&e.credentials.length>0){S=e.credentials;for(let e=0;e<S.length;++e){var t=new s({label:S[e].label,value:S[e].ctxname});c._credentialsComboBox.elementsTree.addRoot(t)}c._credentialsComboBox.selectedIndex=0,c._credentialsComboBox._applySelectedIndex()}}))})),c._platformComboBox.getContent().addClassName("comboBox-PlatformCredSelector"),c._platformComboBox.inject(b),e.createElement("p",{text:p.credentialSelector,class:"para-PlatformCredSelector"}).inject(b),_=h[0],S=h,l.call(c),i()})).catch(o)}else r.getAvailableCredentials({tenant:y}).then((e=>{e&&e.credentials&&e.credentials.length>0?(_=e.credentials[0],S=e.credentials,l(),i()):(u.dispatchEvent("onNoSecurityContext"),a.publish({event:"onNoSecurityContext"}),o())}));function l(){var e=this;e._credentialTreeDocument=new n;for(let t=0;t<S.length;++t){var i=new s({label:S[t].label,value:S[t].ctxname});e._credentialTreeDocument.addRoot(i)}e._credentialsComboBox=new t({elementsTree:e._credentialTreeDocument,enableSearchFlag:!1}),e._credentialsComboBox.addEventListener("change",(function(t){let n=e._credentialTreeDocument.getRoots()[e._credentialsComboBox.selectedIndex];_={label:n.options.label,ctxname:n.options.value}})),e._credentialsComboBox.getContent().addClassName("comboBox-PlatformCredSelector"),e._credentialsComboBox.inject(b)}})),await new Promise((e=>{o.launch({title:f?p.platformSelection_title:p.credentialSelection_title,content:b,confirmLabel:p.confirmation_continue,noClose:!0},(function(){if(y&&(u.updateTenantSettings(y,C,!0),m.updateTenantSettings(y,C,!0),h.displayNotification({message:p.replace(p.tenantChanged,{tenant:y}),className:"primary"})),_){let e=-1;for(i=0,l=widget.preferences.length;i<l;i++)if("pad_security_ctx"===widget.preferences[i].name){e=i;break}let t=S.map((e=>({label:e.label,value:e.ctxname})));widget.addPreference({name:"pad_security_ctx",index:e,type:"list",label:"pad_security_ctx",defaultValue:_.ctxname,options:t}),v.setCredential({label:_.label,value:_.ctxname})}g&&g.onRefresh&&g.onRefresh({reInitialize:!0}),e()}))}))}}})),define("DS/IPClassifyUXUtil/CredentialsView",["DS/IPClassifyUXUtil/private/CredentialsManager","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUtil/IPClassifyModelEvents","DS/IPClassifyUtil/IPSettingsMgr","DS/PADUtils/PADSettingsMgt","DS/WebUAUtils/WebUAUtils","DS/IPClassifyUtil/IPServicesMgr","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil"],(function(e,t,n,i,s,a,o,l,r){function c(e,t){return Object.values(e[t].orgs).map((e=>({label:e.orgtitle,value:e.orgname})))}function d(e){return s.getWebCredential()}function u(){var e=s.getLegacyCredential();e=e&&"string"==typeof e?e.replace("ctx::",""):e,widget.setValue("xPref_CREDENTIAL",e)}function h(e){u(),i.publish({event:"onPad_security_ctx",data:e}),a.dispatchEvent("onPad_security_ctx",e)}function p(e){e=e&&!e.startsWith("ctx::")?"ctx::"+e:e,s.setSetting("pad_security_ctx",e,{widgetPreference:!0}),a.setSetting("pad_security_ctx",e),h(e)}function m({userCanCreateCS:e}){require(["DS/Windows/ImmersiveFrame","DS/IPClassifyUXUtil/IPConfirmationDialog"],((t,n)=>{let i=r.noCredDetails;if(e&&!s.isCompassInacessible()){window.openSpaceApp=function(){require(["DS/i3DXCompassServices/i3DXCompassPubSub"],(e=>{var t={appId:"X3DCSMA_AP",widgetId:l.getWidgetId()};e.publish("launchApp",t)}))};let e=r.noCredDetailsWithCreation.createProjectLink,t=UWA.createElement("a",{styles:{cursor:"pointer"},text:e,onclick:"openSpaceApp()"});i=r.replace(r.noCredDetailsWithCreation.mainSentence,{createProjectLink:t.outerHTML})}let a=new t;a.inject(widget.body),n.confirmDialog({className:"warningNoCreds",immersiveFrame:a,title:r.noCredTitle,message:r.noCredMessage,detailsHTML:i,closeButtonFlag:!1,type:"warning",buttons:!1})}))}i.subscribe({event:"onPad_tenant"},(function(){CredentialUI.render()})),a.addEvent("onPad_tenant",(function(){CredentialUI.render()}));var f=null,g=!1;let v=!1;return CredentialUI={getCredential:d,getCredentialFormFields:async function({creationType:t,defaultSC:n}){let i=await e.getCreateCredentials({type:t,defaultSC:n}),s={...i};if(i.credentials.length>0){let e={};i.credentials.forEach((t=>{let n=e[t.prjname];n||(n=e[t.prjname]={...t,orgs:{}}),n.orgs[t.orgname]||(n.orgs[t.orgname]=t)}));let t=Object.values(e).map((e=>({label:e.prjtitle,value:e.prjname}))),n={helpid:"credId",content:{"credId.WebHelp":"EXP3DBasicsUserMap/exp3dconcept-c-collaborative-spaces.htm"}},a=o.getMoreHelpCallback(n),l=c(e,i.credential.prjname),d=[{id:"prj",label:r.CredProject,requiredFlag:!0,helpText:i.defaultMatches?void 0:r.CredChanged,typeRepresentation:"enumString",value:i.defaultMatches||1===t.length?i.credential.prjname:void 0,onNodeUpdate:function(t){let n=t.value,i=this.getModelItem("org").value,s=c(e,n),a={visibleFlag:s.length>1,semantics:{possibleValues:s}};s.find((e=>e.value===i))||(a.value=s[0].value),this.updateModelItem("org",a)},moreInformation:{title:r.CredProject,...r.helpProject,moreHelpCB:a},semantics:{placeholder:r.SelectProject,possibleValues:t,disabled:t.length<=1}},{id:"org",label:r.CredOrg,requiredFlag:!0,visibleFlag:l.length>1,typeRepresentation:"enumString",value:i.credential.orgname,semantics:{possibleValues:l},moreInformation:{title:r.CredOrg,...r.helpOrg,moreHelpCB:a}}];s.fields=d}return s},getCredentialWhenReady:function(){return new Promise((e=>{this.getCredential()?e():(i.subscribeOnce({event:"onPad_security_ctx"},e),a.addEventOnce("onPad_security_ctx",e))}))},getLabelOfCredential:async function(t){let{credentials:n}=await e.getAvailableCredentials({withPreferred:!1});return n.find((e=>t===e.label))},initializeTenant:async function(){let e=!1,t=await l.getTenantsPref(),n=widget.getValue("x3dPlatformId");e=!t||0==t.length||t.filter((e=>e.value===n)).length<=0,e="OnPremise"!==n&&e,e&&await PlatformCredSelector.render(e)},setCredential:function(e){return new Promise((t=>{let i=Promise.resolve();v&&e&&(i=this.getLabelOfCredential(e)),i.then((function(){p(e),t(e)})).catch((function(e){console.log(e),n.displayNotification({message:r.setCredentialError,className:"error"}),t()}))}))},render:async function({withWarningDialog:s,withPreferred:o}={}){o=void 0!==o&&o,v=!0;var l=this.getCredential(),c=t.getUserId();c!==widget.getValue("dsUser")&&widget.setValue("pad_security_ctx",void 0),widget.setValue("dsUser",c),function({withPreferred:e}){g||(g=!0,widget.addEvent("onEdit",(function(){f||(f=d())})),widget.addEvent("endEdit",(function(){u();var n=d();if(n!==f){if(e&&n){let e=require("DS/IPClassifyUXUtil/service/IPClassifyUXUtilWebService").setPreferredSecurityContext(n);t.promiseCatcher(e)}h(n)}f=null})))}({withPreferred:o});try{let{credential:t,credentials:n}=await e.getAvailableCredentials({defaultSC:l,withPreferred:o}),s=n.length>0;var b,y;l=t?t.ctxname:"",s||(l="",i.publish({event:"onNoSecurityContext"}),a.dispatchEvent("onNoSecurityContext"));var C=-1;for(b=0,y=widget.preferences.length;b<y;b++)if("pad_security_ctx"===widget.preferences[b].name){C=b;break}widget.addPreference({name:"pad_security_ctx",index:C,type:"list",label:"pad_security_ctx",options:n.map((e=>({label:e.label,value:"ctx::"+e.ctxname})))}),p(l),f&&widget.dispatchEvent("onEdit")}catch(e){console.log(e),n.displayNotification({title:r.credentialError.title,subtitle:r.credentialError.subtitle,className:"error"})}return!l&&s&&(widget.setBody(" "),require(["DS/IPClassifyUXUtil/service/IPClassifyUXUtilWebService"],(e=>{e.canMembersCreateCS().then((e=>{m({userCanCreateCS:e&&!0===e.value})})).catch((e=>{console.log(e),m({userCanCreateCS:!1})}))}))),l}}})),define("DS/IPClassifyUXUtil/IPClassifyUXUtilities/IPClassifyMaturityUtils",["DS/IPClassifyUXUtil/CredentialsView","DS/PADServices/utils/PlatformURL","DS/WAFData/WAFData","DS/WidgetServices/WidgetServices"],(function(e,t,n,i){"use strict";var s=!0,a=[],o={},l=(Promise.resolve(),[]),r=null;function c(a){return s?new Promise(((o,l)=>{new Promise((e=>{r?e(!0):i.get3DSpaceUrlAsync({onComplete:function(t){e(!!(r=t))},onFailure:function(t){console.log("error while retriving space url",t),e(!1)}})})).then((()=>{let i,l=a.policies?a.policies:void 0,c=JSON.stringify({policies:l}),d={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",SecurityContext:"function"==typeof e.getCredential?e.getCredential():null},data:c,onComplete:e=>{e=JSON.parse(e),o(e)},onFailure:e=>{i&&i.xhr&&404===i.xhr.status&&(console.warn("Unknown WS: ["+r+"/resources/lifecycle/maturity/getStatesAttributes]"),s=!1),o({policies:[]})}},u=r+"/resources/lifecycle/maturity/getStatesAttributes?tenant="+t.getPlatformId();i=n.authenticatedRequest(u,d)}))})):Promise.resolve({})}function d(e,t,n){if(null===document.getElementById(e)){var i=document.createElement("style");i.type="text/css",i.id=e;let s=n||"."+e;i.innerHTML=s+t,document.getElementsByTagName("head")[0].appendChild(i)}}function u(e){return e.replace(/(\.| )/g,"-")}function h(){return"object"==typeof h.instance?h.instance:(h.instance=this,this)}return h.prototype.getAndCreateMaturityClass=function(e,t){if("string"!=typeof e)return console.warn("MaturityUtils## Maturity status must be a string "),"";let n="lc-status-"+u(e)+(t?"-withClass":""),i=[],s=e.split(".")[0];return-1===a.indexOf(s+(t?"-withClass":""))&&i.push(s),i.length&&this.addCSSMaturityClasses(i,t),n},h.prototype.addCSSMaturityClasses=function(e,t){Promise.all(l).then((()=>{let n=[];for(let t=0;t<e.length;t++)-1===a.indexOf(e[t])&&void 0===o[e[t]]&&n.push(e[t]);let i=Promise.resolve();n.length&&(i=new Promise((e=>{a=a.concat(n),l.push(c({policies:n}).then((t=>{let n=t.policies;for(let t=0;n&&t<n.length;t++){let i=n[t].policyName;o[i]=n[t].states,e()}})).catch((()=>{e()})))}))),i.then((()=>{for(let n=0;n<e.length;n++){let i=e[n];if(o[i]){let e=o[i];for(let n=0;n<e.length;n++){let s=e[n].activeColor,a="{color:"+("#FFFFFF"===s?"#000000":"#FFFFFF")+" ; background-color:"+s+";}",o=u(e[n].stateSysName),l="lc-status-"+u(i)+"-"+o+(t?"-withClass":"");d(l,a,"."+l+(t?" ."+t:""))}-1===a.indexOf(i+(t?"-withClass":""))&&a.push(i+(t?"-withClass":""))}}}))}))},new h})),define("DS/IPClassifyUXUtil/IPClassifyUXUtilities/IPTypesMgt",["DS/IPClassifyUtil/IPSettingsMgr","DS/IPClassifyUXUtil/service/IPClassifyUXUtilWebService"],(function(e,t){"use strict";var n={},i={authorized_types:[],type_kind:{},type_kind_setting:{},types_hierarchies:{},retrieveKind:function(e){var t;for(var n in i.type_kind)if(-1!==i.type_kind[n].indexOf(e)){t=n;break}if(!t){for(var s in i.type_kind_setting)if(-1!==i.type_kind_setting[s].indexOf(e)){t=s,i.type_kind[s]||(i.type_kind[s]=[]),i.type_kind[s].includes(e)||i.type_kind[s].push(e);break}t||(t="Product")}return t}};return n.isTypesAuthorized=function(n,s){var a=[],o=[],l={},r=e.getSetting("authorized_root_types");i.type_kind_setting=e.getSetting("type_kind");var c={},d=e.getSetting("unsupported_root_types");d||(d=[]),n.forEach((function(e){-1!==i.authorized_types.indexOf(e.type)||-1!==r.indexOf(e.type)?a.push(e.type):(o.push(e.type),l[e.type]=e.displayType)})),o.length?t.getTypesHierarchy({types:o}).then((e=>{(UWA.is(e,"string")?JSON.parse(e):e).types_hierarchies.forEach((function(e){let t=e.type;i.types_hierarchies[t]||(i.types_hierarchies[t]=e.hierarchy,i.types_hierarchies[t].push(t));for(var n,s=!1,o=0;o<e.hierarchy.length&&!1===s;o++){let a=e.hierarchy[o];if(-1!==r.indexOf(e.hierarchy[o]))if(-1!==d.indexOf(t))s=!1;else{s=!0,n=a;let e=i.retrieveKind(n);e&&(console.debug(t," add to ",e),i.type_kind[e]||(i.type_kind[e]=[]),i.type_kind[e].includes(t)||i.type_kind[e].push(t))}}!0===s&&(i.authorized_types.push(e.type),a.push(e.type))})),s(a,c)})).catch((e=>{s(a,c)})):s(a,c)},n.retrieveHierarchy=function(e,n){for(var s={},a=[],o=0;o<e.length;o++)i.types_hierarchies[e[o]]?s[e[o]]=UWA.clone(i.types_hierarchies[e[o]]):a.push(e[o]);a.length>0?t.getTypesHierarchy({types:a}).then((e=>{(UWA.is(e,"string")?JSON.parse(e):e).types_hierarchies.forEach((function(e){void 0===i.types_hierarchies[e.type]&&(i.types_hierarchies[e.type]=e.hierarchy,i.types_hierarchies[e.type].push(e.type)),s[e.type]=e.hierarchy,s[e.type].push(e.type),n(s)}))})).catch((e=>{console.warn("Cannot retrieve hierarchy"),a.forEach((function(e){s[e]=[e],n(s)}))})):n(s)},n})),define("DS/IPClassifyUXUtil/utils/DictionaryAccess",["UWA/Core","UWA/Promise","DS/Utilities/Utils","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/IPClassifyUXUtil/service/IPClassifyUXUtilWebService","i18n!DS/PADServices/assets/nls/PADServices.json","DS/PADServices/utils/PlatformURL","DS/PADServices/utils/ClassificationAttributes","DS/WidgetServices/WidgetServices"],(function(e,t,n,i,s,a,o,l,r){"use strict";var c={nodes2updateId:new Set,nodes2update:[],grpnodes2updateId:[],grpnodes2update:[],idx:0,idxGrp:0};const d=["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:modified","ds6w:responsible","ds6wg:revision","ds6w:status","owner","ds6w:created"];function u(e,t,n,i){e[t]||(e[t]=[]),-1===e[t].indexOf(n)&&e[t].push({value:n,source:[i]})}function h(t,n,i){for(var s=!1,a={grid:e.clone(t.options.grid)},o=0;o<n.length;o++)a.grid[n[o]]&&i[n[o]][a.grid[n[o]]]&&i[n[o]][a.grid[n[o]]]!==a.grid[n[o]]&&(s=!0,a.grid[n[o]]=i[n[o]][a.grid[n[o]]]);return{updated:s,options:a}}var p=n.debounce((function(t){f.idx=0;var n,s,a,l={},d=require("DS/IPClassifyUXUtil/IPClassifyUXUtilities/IPColumnAttributeMgt");let u=d.getAvailableColumns();for(n=0;n<t.length;n++){let e=t[n];a=e.getTreeDocument();var h=e.options.grid?Object.getOwnPropertyNames(e.options.grid):[];for(s=0;s<h.length;s++)if(d.hasNLS(h[s])&&-1!==u.indexOf(h[s])){var p=-1!==h[s].indexOf("-Instance")?h[s].substring(0,h[s].indexOf("-Instance")):h[s];void 0===l[p]&&(l[p]=[]);let t=e.options.gridValue&&e.options.gridValue[h[s]],n=t||e.options.grid[h[s]];if(-1===l[p].indexOf(n)){let t=e.getAttributeValue("serviceId");if("object"==typeof n&&n)for(const[e,i]of Object.entries(n))l[p].push({value:i,source:[t]});else l[p].push({value:n,source:[t]})}}}i.getNlsOfPropertiesValuesBySource(l,{tenantId:o.getPlatformId(),lang:r.getLanguage(),apiVersion:m,onComplete:function(i){var o=e.is(i,"string")?JSON.parse(i):i;function l(t){var n=!1,i={grid:e.clone(t.options.grid),gridValue:t.options.gridValue?e.clone(t.options.gridValue):{}},a=Object.keys(i.grid);for(s=0;s<a.length;s++){var l=-1!==a[s].indexOf("-Instance")?a[s].substring(0,a[s].indexOf("-Instance")):a[s];o[l]&&o[l][i.grid[a[s]]]&&o[l][i.grid[a[s]]]!==i.grid[a[s]]&&(n=!0,i.gridValue[a[s]]=i.grid[a[s]],i.grid[a[s]]=o[l][i.grid[a[s]]])}return{updated:n,options:i}}if(a)a.setUseChangeTransactionMode(!0),a.withTransactionUpdate((function(){for(n=0;n<t.length;n++){var e=t[n],i=l(e);!0===i.updated&&e.updateOptions(i.options),delete e._manageNLS,e.options.ensureNLS=!1}c.nodes2updateId=new Set,c.nodes2update=[]})),a.setUseChangeTransactionMode(!1);else{for(n=0;n<t.length;n++){var r=t[n],d=l(r);!0===d.updated&&r.updateOptions(d.options),delete r._manageNLS,r.options.ensureNLS=!1}c.nodes2updateId=new Set,c.nodes2update=[]}},onFailure:function(e){console.warn("Cannot retrieve NLS"),c.nodes2updateId=new Set,c.nodes2update=[]}})}),200),m="R2019x",f={__mapAttNameNLS:{},initNLS:function(){return this.retrieveDS6WNLS(d)},getAttNameNLS:function(e){return this.__mapAttNameNLS[e]?this.__mapAttNameNLS[e].label:a.columnsNLS[e]?a.columnsNLS[e]:e},fetchAttributesDimension:function(t){return s._executeQuery("/resources/v1/FolderManagement/Folder/dictionary/attributes",{type:"json",method:"POST",headers:{Accept:"application/json","content-type":"application/json"},data:e.Json.encode({attributes:t})})},retrieveDS6WNLS:async function(e){return new t(((t,n)=>{var s={tenantId:o.getPlatformId(),lang:r.getLanguage(),apiVersion:m,onComplete:e=>{for(let t=0;t<e.length;t++)this.__mapAttNameNLS[e[t].curi]=e[t];t(this.__mapAttNameNLS)},onFailure:()=>{t()}};i.getResourcesInfo(e.join(","),s)}))},updateColumnsWithNLS:async function(t,n){const i=this,s=[];if(i.completeResponse={},t.forEach((e=>{let t=e.ds6w||e.dataIndex;if(e.customisation&&!0===e.customisation.titleModified&&(t=null),t){let n=e.text||e.label;n?i.completeResponse[t]={nlsName:n,lang:r.getLanguage()}:-1!==t.indexOf(":")&&s.push(t)}})),s.length>0){let t=await i.getResourcesInfo(s);e.is(t,"array")&&t.forEach((e=>{let t=e.label;if(e.curi){if(t===e.curi.replace("ds6wg:","")){console.warn("No real label for attribute "+e.curi);const n=t.indexOf(".");n>0&&(t=t.substring(n+1))}}i.completeResponse[e.curi]={nlsName:t,lang:r.getLanguage(),kind:e.dataType}}))}t.forEach((e=>{let t=e.ds6w||e.dataIndex;e.noTitleColumn?e.text=void 0:t&&i.completeResponse[t]&&i.completeResponse[t].nlsName&&!e.noTitleColumn?e.text=i.completeResponse[t].nlsName:!t||-1===t.indexOf("ds6w")||e.customisation&&!0===e.customisation.titleModified||(console.warn("DictionaryAccess## ds6w attribute ["+t+"] not found by FedDictionaryAccessAPI.getResourcesInfo"),e.text=t)}));let a={status:"success",columns:t};return n&&n(a),a},updateNLS:function(e){var t=e.getOccurencePath();c.nodes2updateId.has(t)||(c.nodes2updateId.add(t),c.nodes2update.push(e),p(c.nodes2update))},getPredicatesNlsValues:function(n){let s={};return n.forEach((({key:e,value:t,service:n})=>{u(s,e,t,n)})),new t((t=>{i.getNlsOfPropertiesValuesBySource(s,{tenantId:o.getPlatformId(),lang:r.getLanguage(),apiVersion:"R2019x",onComplete:function(n){var i=e.is(n,"string")?JSON.parse(n):n;t(i)},onFailure:function(e){console.warn("Cannot retrieve NLS"),t()}})}))},updateNLSforexport:function(n,s){let a=s&&s.columns;var l=n.getAllDescendants();return new t((function(t,s){var c=function(e,{columns:t}){for(var n={},i=require("DS/IPClassifyUXUtil/IPClassifyUXUtilities/IPColumnAttributeMgt"),s=t||i.getAvailableColumns(),a=0;a<e.length;a++){var o=e[a];let t=o.getAttributeValue("serviceId");t=t||"3DSpace";for(var l=Object.keys(o.options.grid),r=0;r<l.length;r++){var c=l[r];i.hasNLS(c)&&-1!==s.indexOf(c)&&"ds6w:reserved"!==c&&"positionMatrix-Instance"!==c&&u(n,c,o.options.grid[c],t)}}return n}(l,{columns:a});i.getNlsOfPropertiesValuesBySource(c,{tenantId:o.getPlatformId(),lang:r.getLanguage(),apiVersion:"R2019x",onComplete:function(i){var s=function(e){for(var t={},n=Object.keys(e),i=0;i<n.length;i++)for(var s=e[n[i]],a=Object.keys(s),o=0;o<a.length;o++){var l=a[o],r=s[l];r&&l!==r&&0!==r.indexOf("emxFramework")&&(t[n[i]]||(t[n[i]]={}),t[n[i]][l]=r)}return t}(e.is(i,"string")?JSON.parse(i):i),a=Object.keys(s);n.setUseChangeTransactionMode(!0),n.withTransactionUpdate((function(){for(var e=0;e<l.length;e++){var t=l[e],n=h(t,a,s);!0===n.updated&&t.updateOptions(n.options)}})),n.setUseChangeTransactionMode(!1),t()},onFailure:function(e){console.warn("Cannot retrieve NLS"),t()}})}))},getPropertiesForClass:async function(e){const t=e.classURIs.split("\n");var n=[];for(let e=0;e<t.length;e+=100){const i=t.slice(e,e+100);let s=await this.__splittedPropertiesForClass(i.join("\n"));s&&(n=n.concat(s))}return n},getResourcesInfo:function(e){return new t((function(t,n){var s={tenantId:o.getPlatformId(),lang:r.getLanguage(),apiVersion:m,onComplete:function(e){t(e)},onFailure:function(n){console.warn("DictionaryAccess## FedDictionaryAccessAPI.getResourcesInfo failed for"+e.join(",")),n&&n.length?t(n):t()}};i.getResourcesInfo(e.join(","),s)}))},__splittedPropertiesForClass:async function(n){return new t((function(t,s){i.getPropertiesForClass(n,{tenantId:o.getPlatformId(),lang:r.getLanguage(),apiVersion:m,onComplete:function(n){var i=e.is(n,"string")?JSON.parse(n):n;t(i)},onFailure:function(e){console.warn("FedDictionaryAccessAPI.getPropertiesForClass failed"),s()}})}))}};return f})),define("DS/IPClassifyUXUtil/IPClassifyUXUtilities/IPColumnAttributeMgt",["DS/IPClassifyUXUtil/utils/DictionaryAccess","DS/IPClassifyUtil/DimensionUtils","DS/IPClassifyUtil/IPClassifyUtility","i18n!DS/IPTableMePreferences/assets/nls/IPTableMePreferences"],(function(e,t,n,i){"use strict";let s=null;return n.createSingleton(class{constructor(){this._attributesParams={},this._views={},this._viewMode=null,this._rowsHeader=null,this._currentView=null}getColumn(e){let t=e;"label"===e&&(t="tree");let n=this._attributesParams[t];return n||null}addAttributesParams(e){n.concatJsonValue(this._attributesParams,e)}addView(e,t){this._views[e]=t,this._currentView||this.setCurrentView(e)}setViewMode(e){this._viewMode=e}getViewMode(){return this._viewMode}setRowsHeader(e){this._rowsHeader=e}getRowsHeader(){return this._rowsHeader}setLocalView(e){let t=UWA.clone(e);this.addView("localView",{...t,local:!0,MP_UUID:"localView",MP_VIEW_NAME:e.MP_VIEW_NAME||i.commandMenu.widget,UUID_RELATED_VIEW:e.UUID_RELATED_VIEW||e.MP_UUID})}getLocalView(){return this.getAllViews().local[0]}getDefaultView(){return this._views._defaultView}updateViews(e){this._views=[];for(const[t,n]of Object.entries(e))this._views[t]=n}setCurrentView(e){this._currentView=e}setDefaultView(e){this.addView("_defaultView",{default:!0,MP_UUID:"_defaultView",MP_VIEW_NAME:i.views.MP_DEFAULT,...e})}isViewExist(e){return!!this._views[e]}getViewByID(e){return this._views[e]}getView(){return this._views[this._currentView]?this._views[this._currentView]:this._views._defaultView}getAllViews(){const e=this.getView(),t={local:[],admin:[],user:[]};for(let n in this._views)if(!n.startsWith("_")){let i,s=this._views[n];i=s.local?"local":s.MP_ADMIN?"admin":"user";const a=s.MP_UUID===e.MP_UUID?e:s;t[i].push(a)}return t}getAvailableColumns(){return this.getView().MP_SELECTED_COLS.map((e=>e.dataIndex||e.ds6w))}getAvailableColumnsOpts(){return this.getView().MP_SELECTED_COLS.map((e=>{if(!e.ds6w)return;let t=this._attributesParams[e.ds6w],i={};return n.concatJsonValue(i,t),n.concatJsonValue(i,e,{eraseUndefined:!0}),i.typeRepresentation=t&&t.typeRepresentation?t.typeRepresentation:i.typeRepresentation,i})).filter((e=>null!=e&&"integer"!==e.typeRepresentation))}async getColumnsCompleted(i){let a=[];i.forEach((e=>{let t=e.dataIndex||e.ds6w,n=this._attributesParams[t];n&&n.newPredicate&&(t=n.newPredicate,delete e.dataIndex,e.ds6w=t,n=this._attributesParams[t]),n||(n=this._attributesParams[t]={}),n.ds6w||n.dataIndex||(n.ds6w=e.ds6w,n.dataIndex=e.dataIndex),a.push(n)}));let o=async function(t){await e.updateColumnsWithNLS(t)}(a),l=async function(t){let n=t.filter((function(e){return void 0===e.kind&&e.ds6w})).map((function(e){return e.ds6w})),i=n.filter((function(e,t){return n.indexOf(e)===t}));if(i.length){let n=await e.getResourcesInfo(i),s={};n.forEach((function(e){s[e.curi]=e})),t.forEach((e=>{e.ds6w&&s[e.ds6w]&&(e.kind=s[e.ds6w].dataType)}))}return t}(a),r=async function(n){let i=t.getDimensions(),a={};await s;let o=n.filter((e=>e.attrDBName&&e.attrDBName.length>0&&!e.convertInfos)).map((e=>{let t=e.attrDBName[0].replace("attribute[","").replace("]","");return a[t]=e,t}));if(o.length>0){s=e.fetchAttributesDimension(o);let n=await s;await i,n.attributes.forEach((e=>{if(e.dimension){let n=e.name;e.owner&&(n=e.owner+"."+e.name);let i=a[n];if(i){let n={dimension:e.dimension.replace("DSDim_",""),manipulationUnit:e["property[ManipulationUnit].value"]},s=t.getUnitAndNLS(n.dimension,n.manipulationUnit);s&&(s.unit&&(n.unit=s.unit),s.nls&&(n.nls=s.nls),s.manipulationNls&&(n.manipulationNls=s.manipulationNls)),i.convertInfos=n}}}))}}(i);await Promise.all([o,l,r]);let c=[];return i.forEach((e=>{let t=e.dataIndex||e.ds6w;if(t){let i=this._attributesParams[t];i=i||{},i.customisation||(i.customisation={}),i.customisation.layout||(i.customisation.layout={});let s={};n.concatJsonValue(s,i),n.concatJsonValue(s,e,{eraseUndefined:!0}),s.typeRepresentation=i&&i.typeRepresentation?i.typeRepresentation:s.typeRepresentation,c.push(s)}})),c}getTreeColumn(){let e=this.getView().MP_SELECTED_COLS.find((e=>"tree"===e.dataIndex));return e&&e.ds6w?e.ds6w:"tree"}getSelectedTypes(){return this.getView().MP_SELECTED_TYPES}getSelectedExtensions(){return this.getView().MP_SELECTED_EXTS}updateSelectedParams({selectedExtensions:e,selectedTypes:t}){let n=this.getView();n.MP_SELECTED_TYPES=t,n.MP_SELECTED_EXTS=e}hasNLS(e){let t=this._attributesParams[e];return!t||!1!==t.hasNLS}})})),define("DS/IPClassifyUXUtil/IPClassifyUXUtilities/IPSearchView",["UWA/Core","UWA/Class/View","DS/PADUtils/PADCommandProxy","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtilities","DS/Handlebars/Handlebars","DS/IPClassifyUtil/IPSettingsMgr","DS/IPClassifyUXUtil/IPClassifyUXUtilities/IPTypesMgt","DS/IPClassifyUtil/IPContext","UWA/Event"],(function(e,t,n,i,s,a,o,l,r){"use strict";return t.extend({name:"IPSearchView",_searchTriggered:!1,className:"pad_global_ctn_search",_selected_paths:[],_insertReplaceNode:null,_insertParams:null,domEvents:{"click div.run_ctn_search":"_onSearch","click span.fonticon-check":"_onConfirmSelect","click div.clear_ctn_search":"_onClearSearch","click span.fonticon-up-open":"_onPrevious","click span.fonticon-down-open":"_onNext","keyup input.input_search":"_onSearchInputKeyUp","paste input.input_search":"_onSearchInputPaste","keydown input.input_search":"_onSearchInputKeyDown"},template:null,setup:function(e){var t=this;l.get().getPADTreeDocument()._insertFlag=!0,this.template=s.compile('<div class="left_ctn_search ctn_search"></div>    <div class="input_ctn_search ctn_search search_css_temp">        <div class="input_search_div" id="input_search_div">        <input class="input_search" id="input_search_input" type="text" placeholder="Search" ondrop="event.preventDefault ? event.preventDefault() : event.returnValue = false">        </div>        <div class="right_search">            <div class="clear_ctn_search ctn_search"><div class="clear_btn_search" style="display:none;"></div></div>            <div class="nav_ctn_search ctn_search"><span class="fonticon fonticon-check fonticon-1x"  style="opacity:0;"></span></div>            <div class="run_ctn_search ctn_search"><div class="run_btn_search"  style="opacity:0.1;"></div></div>            <div class="right_ctn_search ctn_search"></div>        </div>    </div>'),this._searchTriggered=!1,this._parent(e),this._commandProxy=n.create({events:{onSelect:function(e,n){if(l.get().getPADTreeDocument()._insertFlag&&!0===l.get().getPADTreeDocument().options.insert_replace&&e.paths[0]){var i=e.paths[0],s=i[i.length-1],a=[];a.push({type:e.attributes[s].type}),o.isTypesAuthorized(a,(function(n){n.length>0&&(t._selected_paths=e.paths[0],t._insertReplaceNode=t._selected_paths[t._selected_paths.length-1],t._insertParams={"ds6w:type":e.attributes[t._insertReplaceNode].type,"ds6w:label":e.attributes[t._insertReplaceNode].label},t._insertParams["ds6w:label"]&&(t.$clearSearchButton.style.display="inline-block",t.$searchInput.value=t._insertParams["ds6w:label"],t.input_text=t.$searchInput.value,t.$searchButton.style.opacity=1,t.$checkButton.style.opacity=1,l.get().getPADTreeDocument()._insertSelected=!0))}))}}}})},render:function(){var t=this.template();return this.container.setContent(t),function(t,n,i){var s,a,o;if(!e.is(t,"object"))return t;for(s=0,a=(o=Object.keys(t)).length;s<a;s++)n.call(i,t[o[s]],o[s],t)}({searchInput:"input.input_search",searchButton:"div.run_btn_search",checkButton:"span.fonticon-check",searchOptionButton:".option_ctn_search",clearSearchButton:"div.clear_btn_search",onprevious:"span.fonticon-up-open",onnext:"span.fonticon-down-open",padcount:"div.pad_count"},(function(e,t){this["$"+t]=this.getElement(e)}),this),this.$onprevious&&(this.$onprevious.title=i.IPSearchView_previous),this.$onnext&&(this.$onnext.title=i.IPSearchView_next),this.$clearSearchButton&&(this.$clearSearchButton.title=i.IPSearchView_clear),this.$searchButton&&(this.$searchButton.title=i.IPSearchView_search),this.$checkButton&&(this.$checkButton.title=i.IPSearchView_check),!0===l.get().getPADTreeDocument().options.insert_replace?(this.$searchInput.placeholder=i.IPSearchView_search_select,this.$searchInput.title=i.IPSearchView_search_select):(this.$searchInput.placeholder=i.IPSearchView_search,this.$searchInput.title=i.IPSearchView_search),setTimeout(function(){this.$searchInput.focus()}.bind(this),500),this},setCount:function(e){this.$padcount.setContent(e.index+"/"+e.total),null!==this.$onprevious&&null!==this.$onnext&&(this.$onprevious.setStyle("display","inline-block"),this.$onnext.setStyle("display","inline-block"))},_onConfirmSelect:function(e){var t=this;!0===l.get().getPADTreeDocument()._insertSelected&&(UWA.is(this.options.callbacks.onSearch,"function")&&this.options.callbacks.onSearch.call(null,[{search_value:this.$searchInput.value,resourceid:t._insertReplaceNode,"ds6w:type":t._insertParams["ds6w:type"],"ds6w:type_value":t._insertParams["ds6w:type"],"ds6w:label":t._insertParams["ds6w:label"]}]),l.get().getPADTreeDocument()._insertSelected=!1,l.get().getPADTreeDocument()._insertFlag=!1)},_onSearch:function(e){l.get().getPADTreeDocument()._insertSelected=!1,this.$searchInput.blur(),UWA.is(this.options.callbacks.onSearch,"function")&&this.options.callbacks.onSearch.call(null,{search_value:this.$searchInput.value}),l.get().getPADTreeDocument()._insertFlag=!1},_onClearSearch:function(e){this.$searchInput.value="",this.$clearSearchButton.hide(),this.$checkButton&&this.$checkButton.setStyle("opacity","0"),this.$searchButton.setStyle("opacity","0.1"),this._searchTriggered=!1,null!==this.$onprevious&&null!==this.$onnext&&null!==this.$padcount&&(this.$onprevious.hide(),this.$onnext.hide(),this.$padcount.setContent("")),UWA.is(this.options.callbacks.onClear,"function")&&this.options.callbacks.onClear.call(null)},_onSearchInputKeyUp:function(e){this.$searchInput.value?(this.$searchButton.setStyle("opacity","1"),this.$clearSearchButton.setStyle("display","inline-block"),null!==this.$onprevious&&null!==this.$onnext&&!0===this._searchTriggered&&(this.$onprevious.setStyle("display","inline-block"),this.$onnext.setStyle("display","inline-block"))):(this.$clearSearchButton.hide(),null!==this.$onprevious&&null!==this.$onnext&&null!==this.$padcount&&(this.$onprevious.hide(),this.$onnext.hide(),this.$padcount.setContent("")),this.$searchButton.setStyle("opacity","0.1")),this.$checkButton&&this.input_text!==this.$searchInput.value&&(l.get().getPADTreeDocument()._insertSelected=!1,this.$checkButton.setStyle("opacity","0.2"))},_onSearchInputPaste:function(e){var t=this;setTimeout((function(){t._onSearchInputKeyUp()}),200)},_onPrevious:function(){UWA.is(this.options.callbacks.onPrevious,"function")&&this.options.callbacks.onPrevious.call(null)},_onNext:function(){UWA.is(this.options.callbacks.onNext,"function")&&this.options.callbacks.onNext.call(null)},_onSearchInputKeyDown:function(e){var t=this;"return"!==r.whichKey(e)&&"Enter"!==e.keyIdentifier&&"return"!==e.keyIdentifier||(!0===l.get().getPADTreeDocument()._insertSelected?(UWA.is(this.options.callbacks.onSearch,"function")&&this.options.callbacks.onSearch.call(null,[{search_value:this.$searchInput.value,resourceid:t._insertReplaceNode,"ds6w:type":t._insertParams["ds6w:type"],"ds6w:type_value":t._insertParams["ds6w:type"],"ds6w:label":t._insertParams["ds6w:label"]}]),l.get().getPADTreeDocument()._insertSelected=!1,l.get().getPADTreeDocument()._insertFlag=!1):this._onSearch()),r.stopPropagation(e)}})})),define("DS/IPClassifyUXUtil/IPClassifyUXUtilities/view/IPClassifyModalChooser",["UWA/Class","UWA/Class/Options","DS/IPClassifyUXUtil/IPClassifyUXUtilities/IPSearchView","DS/UIKIT/Modal","DS/IPClassifyUtil/IPContext","DS/IPClassifyUXUtil/IPClassifyUXUtilities/IPSearchUtils"],(function(e,t,n,i,s,a){"use strict";return e.extend(t,{name:"ipClassifyChooser",_modal:null,options:{},init:function(e){this._parent(e),this.setOptions(e);var t=UWA.createElement("div"),a=this,o=new n({callbacks:{onSearch:this._onPADSearch.bind(this)}});o.render().inject(t),document.addEventListener("keyup",(function(e){27===e.code&&(a._modal.destroy(),s.get().getPADTreeDocument()._insertFlag=!1)})),this._modal=new i({className:this.name+"_modal",closable:!1,body:t,visible:!0,overlay:!UWA.is(this.getOption("overlay"))||this.getOption("overlay")}),this._modal.elements.container.addEventListener("click",(function(e){console.log("view click",e),a._modal.destroy(),s.get().getPADTreeDocument()._insertFlag=!1})),this._modal.elements.content.addEventListener("click",(function(e){return e.preventDefault(),e.stopPropagation(),!1})),this._modal.inject(e.renderTo),o.$searchInput.focus()},close:function(){this._modal.destroy()},_onPADSearch:function(e){var t=this;if(!0===s.get().getPADTreeDocument()._insertSelected)t._modal.destroy(),this.getOption("in_apps_search").in_apps_callback.call(null,e);else if(e.search_value.length){var n,i=this.getOption("in_apps_search");i&&(n=e.search_value,i.fts_value=n,i.callback=function(e){t._modal.destroy(),UWA.is(i.in_apps_callback,"function")&&i.in_apps_callback.call(null,e)},i.cancel=function(){t._modal.destroy()},a.inAppsSearch(i))}else this._modal.destroy()}})})),define("DS/IPClassifyUXUtil/ActionBar/BreadCrumb",["UWA/Controls/Abstract","UWA/Class/Options","DS/UIKIT/Input/Text","DS/IPClassifyUXUtil/ActionBar/BreadCrumbMenu"],(function(e,t,n,i){"use strict";var s=e.extend(t,{_ctxMenu:null,_ctxMenuWidth:14,_breadcrumb:null,_pathCont:null,_divPathSegmented:null,_divPathFullText:null,init:function({pathCont:e,pathNodes:t,containerCopy:i}){this._parent.apply(this,arguments),this._pathCont=e;var s=this;this._divPathSegmented=UWA.createElement("div",{class:"containerPathSegmented"}).inject(this._pathCont),this._divPathFullText=i,this._pathFullText=new n({className:"pathFullText",attributes:{multiline:!1,readonly:!0}}).inject(this._divPathFullText),this._pathFullText.elements.input.addEvent("blur",(function(){s._divPathFullText.hide(),s._divPathSegmented.show()})),this._buildCtxMenu(),this._breadcrumb=UWA.createElement("div",{class:"containerPathIdCard"}).inject(this._divPathSegmented),t&&t.length>0&&this._buildPathNavigator(t),this._pathCont.addEventListener("click",this._onClickDivPathCont.bind(this),!0)},flush:function(){for(this._ctxMenu.hide();this._breadcrumb.firstChild;)this._breadcrumb.removeChild(this._breadcrumb.firstChild);this._ctxMenu.flush()},_buildPathNavigator:function(e){if(UWA.is(e)){this._divPathFullText.hide(),this._divPathSegmented.show();for(var t=this._pathCont.offsetWidth-this._ctxMenuWidth-50,n=!1,s="",a=0;a<e.length;a++){s=e[a].getLabel()+(s?"\\":"")+s;var o,l=null,r=null,c=0,d=this._createFolderInfoPathElement(e[a]);if(o=d.getDimensions().outerWidth,a<e.length-1&&((l=(r=new i({folderInfo:e[a+1],modelEvents:this.options.modelEvents})).buildPathSeparatorElement()).FolderSeparator=r,l.inject(this._breadcrumb,"top"),c=l.getDimensions().outerWidth),o+c<t&&!n)t=t-o-c;else{n=!0,this._ctxMenu.isVisible()||this._ctxMenu.show(),l&&l.destroy();var u=d.nextSibling;u&&u.hasClassName("separatorIdCard")&&u.destroy(),d.remove(),this._ctxMenu.addSubFolder(e[a])}}this._pathFullText.setValue(s),this._resize()}},_buildCtxMenu:function(){this._ctxMenu=new i({folderInfo:null,modelEvents:this.options.modelEvents,activeIconFont:"fonticon-menu",unactiveIconFont:"fonticon-menu"});var e=this._ctxMenu.buildPathSeparatorElement();e.inject(this._divPathSegmented,"top"),this._ctxMenuWidth=e.getDimensions().outerWidth,this._ctxMenu.hide()},_resize:function(){var e,t=null;if(this._isOverflowed())for(this._ctxMenu.isVisible()||this._ctxMenu.show();this._isOverflowed()&&this._breadcrumb.hasChildNodes()&&(t=this._breadcrumb.firstChild);)t.FolderInfo&&(this._ctxMenu.addSubFolder(t.FolderInfo,!0),(e=t.nextSibling)&&e.hasClassName("separatorIdCard")&&e.destroy(),t.remove());else for(var n=!0,s=this._breadcrumb.getElementsByClassName("subLabelTextIdCard").length>0;n;)if(this._ctxMenu.isVisible()||(n=!1),t=this._ctxMenu.getSubFolder(0)){if(s){var a=new i({folderInfo:t,modelEvents:this.options.modelEvents});(e=a.buildPathSeparatorElement()).FolderSeparator=a,e.inject(this._breadcrumb,"top")}var o=this._createFolderInfoPathElement(t);s=!0,this._isOverflowed()?(e&&e.destroy(),o.remove(),n=!1):this._ctxMenu.removeSubFolder(0)}else this._ctxMenu.hide(),n=!1;this._ctxMenu.isVisible()&&this._ctxMenu.resizeWidgetCallback();var l,r,c,d=this._breadcrumb.getElementsByClassName("separatorIdCard");for(c=d.length,l=0;l<c;++l)(r=d[l].FolderSeparator)&&r.resizeWidgetCallback();return!0},_isOverflowed:function(){var e=this._pathCont.getParent(".idcard_middle");return this._breadcrumb.clientWidth+this._ctxMenuWidth>.5*e.clientWidth-50},_createFolderInfoPathElement:function(e){var t=this,n=UWA.createElement("div",{class:"subLabelTextIdCard",styles:{cursor:"pointer"},events:{click:function(e){t._callExpandAndSelectRequest(this.FolderInfo.getID(),this.FolderInfo.getType(),this.FolderInfo.getLabel())}}}).inject(this._breadcrumb,"top");return n.FolderInfo=e,n.setText(e.getLabel()),n},_callExpandAndSelectRequest:function(e,t,n){this.options.modelEvents.publish({event:"select_breadcrumb_object",data:{id:e,type:t,name:n}})},_onClickDivPathCont:function(e){return e.currentTarget===e.target&&this.switchPathForCopy(),!1},switchPathForCopy:function(){if(this._divPathFullText&&this._divPathFullText.isHidden()){this._divPathFullText.show(),this._divPathSegmented.hide();var e=this._pathFullText.elements.input;e.focus(),e.select()}}});return s})),define("DS/IPClassifyUXUtil/ActionBar/IPToolbar",["UWA/Controls/Abstract","DS/Utilities/Utils","DS/UIKIT/Tooltip","DS/UIKIT/Popover","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUXUtil/ActionBar/BreadCrumb","DS/Utilities/TouchUtils","DS/Tweakers/GeneratedToolbar","DS/Controls/LineEditor","DS/WebappsUtils/WebappsUtils","DS/Notifications/NotificationsManagerViewOnScreen","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil","css!DS/IPClassifyUXUtil/IPClassifyUXUtil","DS/Controls/TooltipModel"],((e,t,n,i,s,a,o,l,r,c,d,u,h,p)=>{function m(e,t,n){if(t){let i=t.getNodeModelByID(e);i.getReferenceValue("data")!==n&&(i._updatingNode=!0,t.updateNodeModel(e,{grid:{data:n}}),delete i._updatingNode)}}function f(e,t,n){var i=[];return e.forEach((e=>{var s=e.id,a=!0;if(e.submenu){var o=f.call(this,e.submenu,t,n);(a=o.length>0)&&((e={...e}).submenu=o)}else if(s){var l=this.getCommandManager().getCommand(s);l&&(!n||n.indexOf(s)>=0)&&(a=void 0!==t?t:l.isEnabled())}a&&i.push(e)})),i}var g={getExpandIcon:function(e){return{iconName:e?"expand-left":"expand-right",fontIconFamily:1}},getExpandTooltip:function(e){return e?h.collapse:h.expand},getExpandButtonEntry:function(e,t){return{id:"expandOneID",dataElements:{typeRepresentation:"functionIcon",icon:this.getExpandIcon(t),tooltip:this.getExpandTooltip(t),label:this.getExpandTooltip(t),position:"near",category:"Actions",value:t=>{"expand-left"===t.context.nodeModel.getAttributeValue("semantics").icon.iconName?e.publish({event:"welcome-panel-collapse"}):e.publish({event:"welcome-panel-expand"})}}}},getInformationIcon:function(e,t){var n=e.getIconObjectCommand("Information",{defaultIcon:"info"});return n.className=!0===t?n.iconName?"info":"check-active-rich":"",n},getInformationEntry:function(e,t,n){let i=e.getCommandManager(),s={icon:this.getInformationIcon(i),label:h.information},a={id:"info",dataElements:{typeRepresentation:"customBoolean",value:n,onNodeUpdate:function(e,{data:n}){void 0===n||e._updatingNode||function(e,t){e.publish({event:"information-panel-"+(t?"open":"close")})}(t,n)},possibleValues:[{...s,value:!0},{...s,value:!1}]}};return a},getSearchEntry:function(){let e=h.searchInFolder_search;return this.options&&this.options.libraryDataProvider&&this.options.libraryDataProvider.getSearchTooltip&&(e=this.options.libraryDataProvider.getSearchTooltip()),[{id:"searchButton",dataElements:{typeRepresentation:"functionIcon",tooltip:e,label:h.searchInFolder_search,icon:this.getCommandManager().getIconObjectCommand("Search",{defaultIcon:"search"}),value:this._toggleSearch.bind(this),position:"far",possibleValues:""}}]}};let v={};[{start:'"',end:'"'},{start:"'",end:"'"},{start:"{",end:"}"},{start:"[",end:"]"},{start:"(",end:")"}].forEach((e=>{v[e.start]=e}));let b=new Set;function y(e,{restrictScopes:t}={}){let n=null,i="",s="",a=!1,o=v;t&&(o={},t.forEach((e=>{o[e]=v[e]})));for(let t=0;t<e.length;t++){let l=e[t];if(n)n.end===l?(a||(s+=n.start+i+n.end),i="",n=!1):(i+=l,a=a||b.has(l));else{let e=o[l];e?(n=e,i="",a=!1):s+=l}}return s+=i,s}b.add(":"),b.add("<"),b.add(">"),b.add("=");var C=e.extend({getCommandManager:()=>{throw new Error("getCommandManager should be overrided")},addSubscriptionToken:function(e){this._subscriptionTokens.push(e)},_subscribe:function(e,t){let n=this.options.modelEvents.subscribe(e,t);this._subscriptionTokens.push(n)},init:function({leftOpened:e,rightOpened:t,modelEvents:o,searchInCurrentTab:l}){u.slide({top:28}),this._parent.apply(this,arguments),this._subscriptionTokens=[],l&&widget&&(widget.addEvent("onSearch",(e=>{this.switchSearch(!0),this.elements._inputText.value=e})),widget.addEvent("onResetSearch",(()=>{this.switchSearch(!1)})));var d=this.getClassNames();this.elements.container=UWA.createElement("div",{class:d+" ToolbarContainer"}),this.elements.flexToolbar=UWA.createElement("div",{class:"IPToolbar"}),this.elements.flexToolbar.inject(this.elements.container);let p={entries:[]};if(this.hasStableCommands=!1,0==this.isTreeViewVisible()||this.shouldMove()){let e=r.prototype.createTreeDocument(p),t=new r({overflowManagement:"dropdown",direction:"horizontal",items:e});this.toolbars={left:t}}else{p.entries.push(g.getExpandButtonEntry(o,e));let t=r.prototype.createTreeDocument(p),n=new r({overflowManagement:"dropdown",direction:"horizontal",items:t});var m=UWA.createElement("div",{class:"pageToolBarCommands_container centerMe"}).inject(this.elements.flexToolbar);n.inject(m),this.toolbars={left:n}}var f=this.elements.middleToolbar=UWA.createElement("div",{class:"idcard_middle"}).inject(this.elements.flexToolbar),v=UWA.createElement("div",{class:"breadCrumbCommands_container centerMe"}).inject(f);let b={path:{},search:{}},C=UWA.createElement("div",{class:"fonticon fonticon-attention fonticon-warning idcard_title_alertIcon"}).inject(v);C.hide(),this.options.modelEvents.subscribe({event:"update_toolbar_warning"},(e=>{let t=b[e.type];e.key&&(e.message?t[e.key]=e:delete t[e.key]);let n=Object.keys(t).length;if(n>0){let e="",i="";for(let s in t)e+=(n>1?"- ":"")+t[s].message+i,i=i||"\n";C.setAttribute("title",e),C.show()}else C.hide()})),this.elements.titleIdCard_container=UWA.createElement("div",{class:"title_IdCard"}).inject(v),this.buildTabBar&&this.buildTabBar(this.elements.titleIdCard_container),this.elements.searchSumIdCard_container=UWA.createElement("div",{class:"title_IdCard"}).hide().inject(v);var _=UWA.createElement("span",{class:"idcard_title_titleSearch"}).inject(this.elements.searchSumIdCard_container),S=UWA.createElement("span",{class:"idcard_title_DateSearch"}).inject(this.elements.searchSumIdCard_container);if(this.elements.elementRightCommands=UWA.createElement("div",{class:"rightCommands_container centerMe"}).inject(f),this.elements.elementRightCommands.addEventListener("click",this._clickOnRightCommandContainer.bind(this),!0),this.elements._inputText=new c({visibleFlag:!1,displayClearFieldButtonFlag:!0,placeholder:this._textPlaceholder,autoCommitFlag:!0}),this.elements._inputText.getContent().addClassName("inputSearch"),this.elements._inputText.addEventListener("change",(e=>{var t=this.elements._inputText.value;if(t.length>=0){if(!this._isSearchInputVisible()||t===this._textPlaceholder||t===this._prevInputValue)return;this._prevInputValue=t,null!=this._timerLastKey&&clearTimeout(this._timerLastKey),this.options.libraryDataProvider&&this.options.libraryDataProvider.getCurrentTabValue&&"1"==this.options.libraryDataProvider.getCurrentTabValue()?this._timerLastKey=setTimeout((()=>{a.notifyOnAttributesTabSearchQuery(t)}),1e3):this._timerLastKey=setTimeout((()=>{let e=this.getPredicateMapping();if(e){let n=y(t).matchAll(/(("[\w-\s]+")|([\w-]+))\s*(:|=|<|>|<=|>=)\s*/g),i=null,s=[];for(;null!==(i=n.next())&&i.value;){let t=i.value,n=t[2]||t[3],a=e[(n.startsWith('"')?n.substring(1,n.length-1):n).toLowerCase()];a&&s.push({section:t[0],replaceBy:t[0].replace(n,"["+a+"]")})}s.forEach((e=>{t=t.replace(e.section,e.replaceBy)}))}o.publish({event:"searchValueSet",data:t})}),1e3)}})),this.elements._inputText.addEventListener("keydown",(e=>{"esc"===UWA.Event.whichKey(e)&&(clearTimeout(this._timerLastKey),o.publish({event:"searchValueSet",data:null}),this.switchSearch(!1))})),this.getSearchWithinController&&this.getSearchWithinController()){var w=this;a.onContentSearchResult((function(e){if(e){var t=document.querySelectorAll(".search_close");if(t&&t.length>0){var a=Array.prototype.slice.call(t);a&&a.forEach((function(e){e.remove()}))}var l=UWA.createElement("span",{class:"close-btn my-btn fonticon fonticon-close search_close"}).inject(w.elements.searchSumIdCard_container);new n({position:"bottom",target:l,body:h.exit_search}),l.addEventListener("click",(function(){w._hideSearchInput(!0),o.publish({event:"searchValueSet",data:null})}));var r=e.numberHits;w.elements.titleIdCard_container.hide(),w.elements.searchSumIdCard_container.show();var c=h.replace(h.searchResultSum,{numberHits:r,s:r>1?"s":"",bookmarkname:w._currentPathNodes[0]._label});_.setText(c);var d=e.dateIndex,u="";if(d){var p=new Date;u=(p-d)/1e3/3600>24||d.getDay()!=p.getDay()?d.toLocaleString():d.toLocaleTimeString(),u=h["Last index:"]+" "+u}if(S.setText(u),w.elements.searchSumIdCard_container.offsetWidth<_.offsetWidth+S.offsetWidth){_.setText(""),S.setText("");var m=UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-clock"}).inject(_);m.setStyle("color","black");var f="hover focus";s.isTouchDevice()&&(f="touch"),new i({target:m,trigger:f,animate:"true",position:"bottom",body:c+". "+u,title:""})}}else w.elements.titleIdCard_container.show(),w.elements.searchSumIdCard_container.hide(),w.updateDisplayPath()}))}this.elements._middleSep=UWA.createElement("div",{class:"toolbar_sep centerMe"}),this.elements._middleSep.inject(this.elements.flexToolbar),this.elements._middleSep.hide(),this.elements.inputFlexContainer=UWA.createElement("div",{class:"searchFlex centerMe"}),this.elements._inputText.inject(this.elements.inputFlexContainer),this.elements.inputFlexContainer.inject(this.elements.flexToolbar),this.elements.elementStableCommands=UWA.createElement("div",{class:"stableAreaCommands_container centerMe"}).inject(this.elements.flexToolbar),this._subscribe({event:"update_selection_count"},(({count:e})=>{this.updateSelectionCount(e)})),this._subscribe({event:"command_availability_updated"},(e=>{this.manageSearchVisibility(e),this.updateCommandsVisibility()})),this._subscribe({event:"command_visibility_updated"},(e=>{e&&this.updateCommandsVisibility(e.commands,void 0,!0)})),this._subscribe({event:"check_command_availability"},(e=>{this.updateSeparatorVisibility(e.commands)})),this._subscribe({event:"switch_search"},(e=>{this.switchSearch(!e||!1!==e.show)})),this._subscribe({event:"toolbar_update_command"},(e=>{this.updateCommand(e.commandID,e.data)})),this._subscribe({event:"toolbar_switch_state"},(({commandID:e,state:t,refreshToolbar:n})=>{this._updateToggleCommand(e,t,{refreshToolbar:n})})),this._subscribe({event:"searchUpdated"},(e=>{if(e){this.elements.flexToolbar.addClassName("isSearchActive");var t=e?e.nhits:0;this.elements.titleIdCard_container.hide(),this.elements.searchSumIdCard_container.show();var n=h.replace(h.searchResultSum,{numberHits:t,s:t>1?"s":"",bookmarkname:e.objectName});_.setText(n),_.setAttribute("title",n);var i=e.lastIndexation,s="";if(i){var a=new Date;s=(a-i)/1e3/3600>24||i.getDay()!=a.getDay()?i.toLocaleString():i.toLocaleTimeString();s=h["Last index:"]+" "+s}_.setAttribute("title",n+"\n"+s),S.setText(s)}else this.elements.flexToolbar.removeClassName("isSearchActive"),this.elements._inputText.value="",this.elements.titleIdCard_container.show(),this.elements.searchSumIdCard_container.hide(),this.updateDisplayPath()})),this.getCommandManager().getToolbarCommands().then((async e=>{let n=await this.initializeCommands(e,t);var i=n.unstable;let s=r.prototype.createTreeDocument({entries:i||[]}),a=new r({overflowManagement:"dropdown",direction:"horizontal",items:s});this.toolbars.unstable=a;var o=n.stable;let l=r.prototype.createTreeDocument({entries:o||[]}),c=new r({overflowManagement:"dropdown",direction:"horizontal",items:l});this.toolbars.stable=c,o&&o.length>0&&(this.hasStableCommands=!0),this.getCommandManager().updateCommands(),a.inject(this.elements.elementRightCommands),c.inject(this.elements.elementStableCommands),widget.dispatchEvent("ontoolbarReady"),this.options.modelEvents.publish({event:"toolbar_ready_WebInWin",data:""})})).catch((function(e){console.log(e)}))},getPredicateMapping:function(){return null},destroy:function(){this._subscriptionTokens.forEach((e=>{this.options.modelEvents.unsubscribe(e)})),this._subscriptionTokens=[],this._parent()},_updateToggleCommand:function(e,t,{section:n,refreshToolbar:i}={}){let s=n;if(!n)for(let t in this.toolbars)if(this.toolbars[t].getNodeModelByID(e)){s=t;break}m(e,s&&this.toolbars[s],t),i&&this.toolbars[s]&&(this.toolbars[s].prepareUpdateView(),this.toolbars[s].pushUpdateView())},setTooltip:function(e,t,n){n=n||0;var i=e.dataElements?e.dataElements:e;let s=this.getCommandManager().getTooltip(t.ID);if(s){i.tooltip=s,i.tooltip.position=0===n?"bottom":"left";let t=null,a={};if(i.tooltip.temp?(e.dataElements?(t=e.dataElements,a.label=i.tooltip.temp.title):(t=e,a.title=i.tooltip.temp.title),i.tooltip.temp.postTitle&&(a.tooltip=i.tooltip,a.tooltip.postTitle=i.tooltip.temp.postTitle),i.tooltip.temp.tooltip&&(a.tooltip=i.tooltip.temp.tooltip)):i.tooltip.title&&(t=e,a.title=i.tooltip.title),t){(i.possibleValues?i.possibleValues:[t]).forEach((e=>{for(let t in a)e[t]=a[t]}))}}},createMenu:function(e,t,n){var i=null,s=null,a=[];return t.Commands.forEach((t=>{var o=null,l=null,r=null;if(t.Commands){let a=n+1;o=this.createMenu(e,t,a),i=i||o.command,s=s||o.details,t.Name&&(r=(r=h["CommandSection."+t.Name])||t.Name)}else r=(l=e[t])?l.Name:"",i=i||t,s=s||l;if(l||o){var c=t.Name?t.Name:o&&o.menu.length>0?o.menu[0].id+"_group":t,d={id:c,type:"PushItem"};r&&(d.title=r,d.tooltip=r),l&&(this.setTooltip(d,l,n),l.icon&&"none"!=l.displayIcon&&(d.icon=this.getCommandManager().createIconObject(l)),d.action={callback:this.getCommandManager().launchCommand.bind(this.getCommandManager(),l.ID,null)}),o&&(d.submenu=o.menu,o.details&&(d.icon=this.getCommandManager().createIconObject(o.details))),"subscribe"===c&&(d.icon=this.getCommandManager().getIconObjectCommand("MySubscriptionsHdr",{defaultIcon:"bell-list"})),a.push(d)}})),{details:s,command:i,menu:a}},getEntryForCommand:function(e){},initializeCommands:function(e,t){var n={},i="far",s=1;if(e){var a=e.headers;for(var o in e.toolbar)n[o]=[],e.toolbar[o].forEach((e=>{var l=this.getEntryForCommand(e);if("sep"===e)s++;else if("Search"===e){s++,g.getSearchEntry.bind(this)().forEach((t=>{t.dataElements.category=s,t.dataElements.position=i,n[o].push(t),this.setTooltip(t,{ID:e})})),0!=this.needSep()&&s++}else if("Information"===e&&0!=this.getInfoVisibility()){var r=g.getInformationEntry(this,this.options.modelEvents,t);this.setTooltip(r,{ID:e}),r.dataElements.category=s,r.dataElements.position=i,n[o].push(r)}else if(l)l.dataElements.category=s,l.dataElements.position=i,n[o].push(l);else if("layout"===e.type){var c=[],d=e,u=null,p="layout",m=null,f=null;(C=this.createMenu(a,e,1)).menu.forEach((e=>{c.push({value:e.id,label:e.title,icon:e.icon,id:e.id,tooltip:e.tooltip})})),f=e.default?c.find((t=>t.id===e.default.id)):c[0];var v={id:I=e.Name?e.Name:d,dataElements:{typeRepresentation:p,position:i,disabled:!1,category:s,value:f,possibleValues:c,tooltip:h["CommandSection.display"],label:h["CommandSection.display"],onNodeUpdate:e=>{let t=e.getAttributeValue("data"),n=t.id||t;this.getCommandManager().launchCommand.call(this.getCommandManager(),n,null)}}};n[o].push(v)}else{var b="menu"===e.type,y=(m=null,!1);b&&(!0===e.hasUAPanel&&this._commandManager&&this._commandManager.getDisplayNameForCommand?(m=this._commandManager.getDisplayNameForCommand(e),y=!0):e.Name="menu");d=e,u=null;var C,_=!!e.Commands,S=(p="functionIcon",null);if(_)if(e.Commands.length>0)p=b?"threeDotsMenu":"functionMenuIcon",S={menu:(C=this.createMenu(a,e,1)).menu},u=C.details,d=C.command,e.isAppSpecific&&e.Name&&this._commandManager&&this._commandManager.getToolTipFromNls?m=this._commandManager.getToolTipFromNls(e.Name):e.Name&&0==y&&(m=(m=h["CommandSection."+e.Name])||e.Name),b||"SelectAll"===d||C.menu.forEach((t=>{let n=t.action;n&&(t.action={callback:()=>{n.callback(),this.options.modelEvents.publish({event:"toolbar_update_command",data:{commandID:e.Name,data:{icon:t.icon}}})}})}));else e.isExternal=!0,p="functionMenuIcon",(u=e)&&(m=h["CommandSection."+e.Name],S={menu:e.Commands});else(u=a[e])&&(m=u.Name,S=this.getCommandManager().launchCommand.bind(this.getCommandManager(),u.ID,null));if(u){var w=b?"menu-dot":u.icon,I=e.Name?e.Name:d+(b||_?"_group":"");"SelectAll"===d&&(w=u.icon.indexOf(".png")>0?u.icon:"select-off",p="functionMenuIconCount"),u={...u,icon:w};var P=this.getCommandManager().createIconObject(u);if(e.cmdIcon?P=this.getCommandManager().getIconObjectCommand(e.cmdIcon):e.icon&&(P=this.getCommandManager().createIconObject({icon:e.icon})),(v={id:I,dataElements:{typeRepresentation:p,icon:P,position:i,category:s}}).isExternal=e.isExternal,m&&(v.dataElements.tooltip=m,v.dataElements.label=m),b||_||this.setTooltip(v,u),"CATAfrHeaderCheck"===u.Behavior){let e=this.getCommandManager().getCommand(I),t=e&&e.getState(),n=S;v.dataElements={...v.dataElements,typeRepresentation:"customBoolean",value:t,onNodeUpdate:function(t,{data:i}){if(void 0!==i){e.getState()!==i&&n()}},possibleValues:[{value:!0,icon:P},{value:!1,icon:P}]},v.dataElements.possibleValues.forEach((e=>{e.label=v.dataElements.label,e.tooltip=v.dataElements.tooltip})),delete v.dataElements.label,delete v.dataElements.tooltip,S=null}S&&(v.dataElements.value=S),n[o].push(v)}}}))}return Promise.resolve(n)},isSearchAvailable:function(){},_isSearchAvailableAsync:async function(){let e=this.isSearchAvailable.apply(this,arguments);return e.cancel&&(this._searchCheck&&this._searchCheck.cancel(),this._searchCheck=e),e},isAdvanceSearchAvailable:function(e){this.toolbars.stable&&this._libraryCSO&&(!1!==e&&"Library"==this._libraryCSO.getCurrentObject().getType()&&this.options.libraryDataProvider.advanceSearchWithinWidget&&1==this.options.libraryDataProvider.advanceSearchWithinWidget()?this.toolbars.stable.updateNodeModel("searchButton",{possibleValues:[{value:this._toggleSearch.bind(this),icon:{iconName:"search",fontIconFamily:1},label:h.searchInFolder_search,tooltip:this.options.libraryDataProvider.getSearchTooltip?this.options.libraryDataProvider.getSearchTooltip():h.searchInFolder_search},{value:this._advanceSearch.bind(this),icon:{iconName:"search-book",fontIconFamily:1},label:h.advance_search_within,tooltip:this.options.libraryDataProvider.getAdvanceSearchTooltip?this.options.libraryDataProvider.getAdvanceSearchTooltip():h.advance_search_within}]}):this.toolbars.stable.updateNodeModel("searchButton",{possibleValues:"",grid:{data:this._toggleSearch.bind(this)}}))},manageSearchVisibility:async function(e){await this._isSearchAvailableAsync(e?e.treeNode:null)?this.showSearch():this.hideSearch()},hideSearch:function(){this.showSearch(!1),this._hideSearchInput(!0)},showSearch:function(e){this.updateCommandsVisibility(["searchButton"],!1!==e),this.getSearchWithinController&&this.isAdvanceSearchAvailable(e),this.toolbars.stable&&widget.body.getSize().width>0&&(this.elements.elementStableCommands.setStyles({visibility:"hidden",position:"absolute",width:"100%"}),this.elements.inputFlexContainer.setStyle("visibility","hidden"),this.elements.elementRightCommands.setStyle("visibility","hidden"),setTimeout((()=>{var e=this.toolbars.stable.elements.farContainer.clientWidth,t=this.getStableAreaWidth(e);t||(t=this.toolbars.stable.elements.farContainer.clientWidth+10);this.elements.elementStableCommands.setStyles({visibility:"visible",position:"relative","flex-basis":t,width:"auto"}),this.elements.inputFlexContainer.setStyle("visibility","visible"),this.elements.elementRightCommands.setStyle("visibility","visible")})))},updateLeftPanelIcon:function(e){this.toolbars.left.updateNodeModel("expandOneID",{grid:{semantics:{icon:g.getExpandIcon(e)}},tooltip:g.getExpandTooltip(e),label:g.getExpandTooltip(e)})},updateRightPanelIcon:function(e){this.toolbars.stable&&this._updateToggleCommand("info",e,{section:"stable"})},updateSelectionCount:function(e){const t=0===e?{title:"",shortHelp:h.multiSelect.selectOff}:{title:h.multiSelect.selectOn,shortHelp:e};if(this.toolbars&&this.toolbars.stable){let n=this.getCommandManager().getIconObjectCommand("SelectAll",{defaultIcon:"select-on"});n.fontIconFamily&&(n.iconName=e?"select-on":"select-off"),this.toolbars.stable.updateNodeModel("select",{tooltip:t,count:e,grid:{semantics:{icon:n}}})}},updateCommandsVisibility:function(e,t,n){setTimeout((()=>{this.elements.container&&this._updateCommandsVisibility(e,t,n)}),0)},_updateCommandsVisibility:function(e,t,n){if(this.toolbars)for(var i in this.toolbars){var s=this.toolbars[i];s.prepareUpdateView(),s.items.getAllDescendants().forEach((i=>{if(!i.options.isExternal){var a=i.options.id;let u=null;u=i.options.icon?i.options.icon:i.options.grid.semantics.icon;var o=null,l=i.options.grid.data&&i.options.grid.data.menu;if(!l||e&&!n){if(!e||e.indexOf(a)>=0){var r=this.getCommandManager().getCommand(a);flag=void 0!==t?t:r?r.isEnabled():null,null!==flag&&s.updateNodeModel(a,{visibleFlag:flag})}}else{var c=i.options.menuSave;if(c||(c=i.options.menuSave=i.options.grid.data.menu),e){var d=[];i.options.menuSave.forEach((t=>{var n=t.id,i=e.indexOf(n)>=0;i||l.every((e=>(i=n===e.id,t=e,!i))),i&&d.push(t)})),c=d}if(o=f.call(this,c,t,e)){let e=[],t=!1,n=!0;o.forEach((i=>{i.icon&&(i.icon.iconName||i.icon.iconPath)&&u&&n&&!["menu","select","revise"].includes(a)&&(u.iconName&&u.iconName==i.icon.iconName||u.iconPath&&u.iconPath===i.icon.iconPath?(t=!1,n=!1):t=!0),e.push(i)})),t&&e.length>0&&this.options.modelEvents.publish({event:"toolbar_update_command",data:{commandID:a,data:{icon:e[0].icon}}})}s.updateNodeModel(a,{grid:{data:{menu:o}}})}!o||e&&!n||s.updateNodeModel(a,{visibleFlag:0!==o.length})}})),s.pushUpdateView()}},getToolbarCommand:function(e){var t=null,n=null;if(this.toolbars)for(var i in this.toolbars){var s=this.toolbars[i];if(s.items.getAllDescendants().every((n=>{var i=n.options.id;return e===i&&(t=n),!t})),t){n=s;break}}return{command:t,toolbar:n}},_updateCommand:function(e,t){this.getCommandManager().getToolbarCommands().then((()=>{var n=this.getToolbarCommand(e);if(n.command){var i=n.command,s=n.toolbar,a=i.options.id;if("layout"===i.getAttributeValue("typeRep")&&t.grid&&"string"==typeof t.grid.data&&i.options.possibleValues){let e=i.options.possibleValues.find((e=>e.id===t.grid.data));e&&(t.grid.data=e)}t&&t.grid&&t.grid.data&&t.grid.data.menu&&this.getCommandManager().prepareIconOnMenu(t.grid.data.menu),s.updateNodeModel(a,t)}})).catch((function(e){console.log(e)}))},updateCommand:function(e,t){setTimeout((()=>{this._updateCommand(e,t)}),0)},searchHasFocus:function(){return document.activeElement===this.elements._inputText.elements.inputField},getSearchValue:function(){return this.elements._inputText?this.elements._inputText.value:null},updateSeparatorVisibility:function(e){e&&-1!==Object.entries(e).find((e=>1==e))&&this.hasStableCommands?this.elements._middleSep.show():this.elements._middleSep.hide()},_isSearchInputVisible:function(){let e=!1;return this.elements._inputText&&(e=this.elements._inputText.visibleFlag),e},_toggleSearch:function(){s.sendTrackerPageEvent("Search","Search");let e=this._isSearchInputVisible();this.switchSearch(!e)},_advanceSearch:function(){s.sendTrackerPageEvent("Search","Advance Search Within");var e={CSOProvider:this.options.libraryCSODataProvider,LibraryDataProvider:this.options.libraryDataProvider};this.getSearchWithinController().loadUI(e,this)},switchSearch:function(e){e?this._showSearchInput():this._hideSearchInput(!0)},_focusOnSearchText:function(){setTimeout((()=>{this.elements._inputText.getContent().getElement("input").focus()}),0)},_hideSearchInput:function(e){e&&this.getSearchValue()&&this.clearSearchValue(),this.elements._inputText&&(this._isSearchInputVisible()&&this.options.modelEvents.publish({event:"searchValueSet",data:null}),this.elements._inputText.value="",this.elements._inputText.visibleFlag=!1)},_showSearchInput:function(){this.elements._inputText.visibleFlag=!0,this._focusOnSearchText()},clearSearchValue:function(){this._prevInputValue=null},createPathInfo:function(e){},isTreeViewVisible:function(){},shouldMove:function(){},getInfoVisibility:function(){},needSep:function(){},getStableAreaWidth:function(){},setCurrentLocation:function({objectPath:e}){if(0!=this.isTreeViewVisible()){var t,n,i;if(this._currentPathNodes=[],(i=e)&&i.length>0)for(t=i.length-1;t>=0;--t)n=i[t],this._currentPathNodes.push(this.createPathInfo(n));this._buildNavPath(this._currentPathNodes)}},_changePlaceholder:function(e){var t=h.replace(h.SearchInFolder,{folderName:e});this._textPlaceholder=t,this.elements._inputText.placeholder=this._textPlaceholder},_buildNavPath:function(e){this._breadCrumb?(this._breadCrumb.flush(),this._breadCrumb._buildPathNavigator(e)):this._breadCrumb=new o({pathCont:this.elements.titleIdCard_container,pathNodes:e,modelEvents:this.options.modelEvents,containerCopy:UWA.createElement("div",{class:"containerPath"}).inject(this.elements.middleToolbar)}),e.length>0&&this._changePlaceholder(e[0].getLabel())},updateDisplayPath:function(){let e=this.elements._inputText,t=e.getContent().hasAttribute("focused");this.elements.flexToolbar.clientWidth<600?(e.inject(this.elements.container),this.elements.container.addClassName("smallContainer")):(e.inject(this.elements.inputFlexContainer),this.elements.container.removeClassName("smallContainer")),t&&e.focus(),this._breadCrumb&&this._breadCrumb._resize(this._currentPathNodes)},_clickOnRightCommandContainer:function(e){var t=e.clientX,n=this.toolbars.unstable.elements.farContainer.getBoundingClientRect().x;this._breadCrumb&&t<n&&this._breadCrumb.switchPathForCopy()}});return C.updateToggleCommand=m,C.cleanSearchQuery=y,C}));