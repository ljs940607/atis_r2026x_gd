define("DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants",[],(function(){"use strict";return{SERVICE_3DSPACE_NAME:"3DSpace",SERVICE_3DSWYM_NAME:"3DSwym",APP_NAME:"Alternate_Substitute",CONSTANT_CONTEXT_COMMAND:"ContextMenu",CONSTANT_ALT_REF:"ALT_REF",CONSTANT_DS6W_STATUS:"ds6w:status",CONSTANT_ROWUID:"AlternateItemConnectionPhysicalId",CONSTANT_REF_ID:"PrimaryItemPhysicalId",CONSTANT_ALT_INFO:"AlternateItemInfo",CONSTANT_ALT_ID:"AlternateItemPhysicalId",CONSTANT_WORK_UNDER_CHANGE_ID:"WorkUnderChangeActionPhyId",CONSTANT_CHANGE_ID:"change_id",CONSTANT_REL_ALTERNATE_OF:"Alternate Of",CONSTANT_BUS_ALTERNATE_REFERENCE:"Alternate Reference",CONSTANT_ALT_REF_PHYSICALID:"AlternateReferencePhysicalId",CONSTANT_ALT_REF_TITLE:"AlternateReferenceTitle",CONSTANT_ALT_REF_REVISION:"AlternateReferenceRevision",CONSTANT_ALT_REF_OWNER:"owner",CONSTANT_ALT_REF_TYPE:"AlternateReferenceType",CONSTANT_USER_SELECTED_PRIMARY_ITEM_PHYSICALID_LIST:"UserSelectedPrimaryItemRevisionPhyIdList",CONSTANT_USER_SELECTED_INSTANCE_LOGICAL_ID_LIST:"UserSelectedInstanceLogicalPhyIdList",CONSTANT_USER_SELECTED_CONTEXT_REVISION_PHYSICAL_ID_LIST:"UserSelectedContextRevisionPhyIdList",CONSTANT_CARRY_OVER_ALTERNATE:"CarryOverAlternate",CONSTANT_CARRY_OVER_SUBSTITUTE:"CarryOverSubstitute",CONSTANT_CONFIRM_MODEL_CLASS:"alternateDlgConfirm_modal",CONSTANT_MENU_CMD_STATE_ENABLED:"enabled",CONSTANT_MENU_CMD_STATE_DISABLED:"disabled",CONSTANT_CTX_ITEM_ID:"SubstituteInstancePhysicalId",CONSTANT_INCLUDE_OTHER_CONTEXTS:"IncludeOtherContext",CONSTANT_CONSTRAINTS:"Constraints",CONSTANT_SYMMETRIC:"Symmetric",CONSTANT_REFERENCE_PHYSICAL_ID:"SubstituteReferencePhysicalId",CONSTANT_SYMMETRIC_EXCHANGE:"fonticon fonticon-exchange",CONSTANT_PRODUCT_ICON:"fonticon fonticon-product",CONSTANT_STATUS:"AlternateQualificationStatus",CONSTANT_NOT_APPLICABLE:"Not Applicable",CONSTANT_CURRENT:"current",CONSTANT_PROPOSED:"Proposed",CONSTANT_FROZEN:"Frozen",CONSTANT_QUALIFIED:"Qualified",CONSTANT_CHANGE_ATTACHED:"ChangeActionProposed",CONSTANT_OBSOLETE:"Obsolete",CONSTANT_APPROVE:"Approve",CONSTANT_REMOVE:"Remove",CONSTANT_STRICT:"Strict",CONSTANT_REJECTED:"Rejected",BUTTON_ADD:"Add",BUTTON_CANCEL:"Cancel",BUTTON_OK:"Ok",BUTTON_SAVE:"SaveAll",CONSTANT_TITLE:"Title",KEY_CONSTANT_TYPEREPRESENTATION:"typeRepresentation",CONSTANT_SEPERATOR:"--\x3e",CONSTANT_CONTEXT:"Context",CONSTANT_DS_LABEL:"ds6w:label",CONSTANT_DS_REVISION:"ds6wg:revision",CONSTANT_DS_TYPE:"ds6w:type",CONSTANT_DS_GLOBAL_TYPE:"ds6w:globalType",CONSTANT_DS_PART:"ds6w:Part",CONSTANT_REVISION:"revision",CONSTANT_FROM_REVISION:"from.revision",CONSTANT_TO_REVISION:"to.revision",CONSTANT_TYPE:"type",CONSTANT_PARTNUMBER:"PartNumber",CONSTANT_NONE:"None",CONSTANT_V_NAME:"attribute[PLMEntity.V_Name]",CONSTANT_FROM_V_NAME:"from.attribute[PLMEntity.V_Name]",CONSTANT_TO_V_NAME:"to.attribute[PLMEntity.V_Name]",CONSTANT_KINDOF_VPMREFERENCE:"type.kindof[VPMReference]",CONSTANT_KINDOF_VPMINSTANCE:"type.kindof[VPMInstance]",CONSTANT_TRUE:"TRUE",CONSTANT_PLM_EXTERNALID:"attribute[PLMInstance.PLM_ExternalID]",CONSTANT_FROM_PHYSICALID:"from.physicalid",CONSTANT_TO_PHYSICALID:"to.physicalid",CONSTANT_METATYPE:"metatype",CONSTANT_RELATIONSHIP:"relationship",CONSTANT_SELREFERENCEID:"selReferenceID",CONSTANT_PARENTID:"parentId",CONSTANT_BUSINESS_OBJECT:"businessobject",CONSTANT_INPUT_OBJECT:"input_object",CONSTANT_OUTPUTS:"outputs",CONSTANT_ALTERNATE_TOOLBAR_ADD_CMD:"Add",CONSTANT_ALTERNATE_TOOLBAR_ADD_TO_CHANGE_CMD:"AddToChange",CONSTANT_ALTERNATE_TOOLBAR_REMOVE_CMD:"Remove",CONSTANT_ALTERNATE_TOOLBAR_APPROVE_CMD:"Approve",CONSTANT_ALTERNATE_TOOLBAR_OBSELETE_CMD:"Obselete",CONSTANT_ALTERNATE_TOOLBAR_GROUP_BY:"GroupBy",CONSTANT_ALTERNATE_TOOLBAR_SWITCH_VIEW_CMD:"SwitchView",CONSTANT_ALTERNATE_TOOLBAR_MAKE_APPLICABLE_CMD:"MakeApplicable",CONSTANT_ALTERNATE_TOOLBAR_MULTISELECT_CMD:"MultiSelect",CONSTANT_ALTERNATE_TOOLBAR_CUSTOMIZE_TABLE_CMD:"CustomizeTable",CONSTANT_APPLICABILTY:"Applicability",CONSTANT_SPLIT:"InstanceSplitApplicability",CONSTANT_YES:"Yes",CONSTANT_NO:"No",ERROR:"error",SUCCESS:"success",CONSTANT_ACTION:"status",CONSTANT_TEXT_PRIMARY_ITEM:"primaryitem",CONSTANT_CONTEXT_COUNT:"contextCount",CONSTANT_AUTOCOMPLETE_SEARCH_TITLE:"Select Engineering Item",CONSTANTS_KEY_ICONS:"icons",CONSTANTS_ICON:"icon",CONSTANTS_ICON_NAME:"Icon_Name",CONSTANTS_THUMNAIL_NAME:"Thumbnail_2d_Name",CONSTANTS_KEY_TITLE:"Title",CONSTANTS_THUMNAIL:"thumbnail",CONSTANT_PARENT_ITEM_KEY:"parentItem",CONSTANT_INSTANCE_NAME_KEY:"instanceName",CONSTANT_OPERATION_KEY:"Operation",CONSTANT_COLUMN_ALTERNATE_REFERENCE_KEY:"AlternateReference",CONSTANT_COLUMN_ALTERNATE_INSTANCE_KEY:"AlternateInstance",CONSTANT_OPERATION_KEY_VALUE_ALTERNATE:"Alternate",CONSTANT_OPERATION_KEY_VALUE_INSTANCE_SUB:"InstanceSubstitute",CONSTANT_OTHER_CONTEXT_KEY:"OtherContexts",CONSTANT_OTHER_CONTEXT_SAME_STATUS_EXISTS:"SameStatusExistsInOtherContexts",CONSTANT_KEY_PHYSICALID:"physicalid",CONSTANT_KEY_ID:"id",CONSTANT_KEY_TYPE:"type",CONSTANT_KEY_REFERENCE_IDS:"referenceIds",CONSTANT_KEY_TYPE_REF_FILTER:"type_filter_rel",CONSTANT_PARENT_CONTEXT_TITLE:"ParentContextTitle",CONSTANT_PARENT_CONTEXT_REVISION:"ParentContextRevision",CONSTANT_INSTANCE_CONTEXT_TITLE:"InstanceContextTitle",CONSTANT_CARRYOVER_ALTERNATE:"CarryOverAlternate",CONSTANT_CARRYOVER_SUBSTITUTE:"CarryOverSubstitute",CONSTANT_OTHER_CONTEXT_APPLICABLE_DATA_EXISTS:"OtherContextsApplicableDataExists",CONSTANT_IS_NODE_EXPANDED:"isNodeExpanded",CONSTANT_OTHER_CONTEXT_APPLICABLE_ALTERNATE_REF_PHYSICALD:"OtherContextsApplicableAlternateRefIDS",CONSTANT_SELECTED_PRIMARY_ITEM_DIFFERENT_LOGICALID:"multipleLogicalID",CONSTANT_ALTERNATE_USAGE_POPUP_NOT_APPLICABLE_NAVIGATION:"notApplicableAlternate",CONSTANT_BASIC_ALTERNATE_ATTRIBUTES:"alternateBasicAttributes",CONSTANT_SAME_CONSTANT_ALTERNATES:"sameContextAlternteItems",CONSTANT_USER_SELECTED_INSTANCE_ID:"UserSelectedInstancePhysicalId",CONSTANT_USER_SELECTED_PRIMARY_ITEM_REVISION_IDS:"UserSelectedPrimaryItemRevisionList",CONSTANT_ALTERNATE_FILTER_PARAMS:"alternateFilterParams",CONSTANT_ALTERNATE_GROUPBY_OPTIONS:"alternateGroupByOptions",CONSTANT_ALTERNATE_SUGGESTION_FILTER:"alternateSuggestionFilterParams",CONSTANT_PROPOSE_FOR:"Proposefor",CONSTANT_PROPOSE_FOR_INSTANCE:"ProposeforInstance",CONSTANT_PROPOSE_FOR_REFERENCE:"ProposeforReference",CONSTANT_PROPOSE_FOR_ALL:"ProposeforAll",CONSTANT_CONTEXT_SEPARATOR:"  |  ",KEY_CONSTANT_MODEL_ID:"ModelPhysicalId",SUPPORTED_ALTERNATE_COUNT_ONPREMISE:200,SUPPORTED_ALTERNATE_COUNT_ONCLOUD:30,CONSTANT_ICON_SPLIT:"clock",CONSTANT_ICON_PROPOSED:"clock",CONSTANT_ICON_FROZEN:"ignore",CONSTANT_ICON_QUALIFIED:"status-ok",CONSTANT_ICON_OBSOLETE:"block",CONSTANT_ICON_WARNING:"attention",CONSTANT_ICON_NOT_APPLICABLE:"status-ko",CONSTANT_ICON_POINTER_DOWN:"expand-down",CONSTANT_ICON_POINTER_RIGHT:"expand-right",CONSTANT_PRODUCT_CUSTOMDIV_ICON:"product productIcon",CONSTANT_ICON_SPLIT_CLASS:"statusSplit",CONSTANT_ICON_PROPOSED_CLASS:"statusProposed",CONSTANT_ICON_FROZEN_CLASS:"statusFrozen",CONSTANT_ICON_QUALIFIED_CLASS:"statusQualified",CONSTANT_ICON_REJECTED_CLASS:"statusRejected",CONSTANT_ICON_SYMMETRIC_CLASS:"symmetricIcon",CONSTANT_ICON_OBSOLETE_CLASS:"statusObsolete",CONSTANT_ICON_OBSOLETE_WUC_CLASS:"statusObsoleteWUC",CONSTANT_ICON_WARNING_CLASS:"statusattention",CONSTANT_DATAGRID_COLUMN_TITLE:"Title",CONSTANT_DATAGRID_COLUMN_V_NAME:"V_Name",CONSTANT_DATAGRID_COLUMN_ALTERNATE:"ds6wg:Alternate",CONSTANT_DATAGRID_COLUMN_INTERCHANGEABILITY:"ds6wg:Alternate Reference",CONSTANT_DATAGRID_COLUMN_REVISION:"revision",CONSTANT_DATAGRID_COLUMN_STATUS:"Status",CONSTANT_WORK_UNDER_CHANGE:"WorkUnderChangeActionPhyId",CONSTANT_DATAGRID_USAGE_SCOPE:"UsageScope",CONSTANT_DATAGRID_THUMBNAIL:"Thumbnail",CONSTANT_DATAGRID_COLUMN_CHANGE:"ActiveChange",CONSTANT_DATAGRID_PART_NUMBER:"PartNumber",CONSTANT_DATAGRID_MATURITY_STATE:"AlternateItemCurrentState",CONSTANT_DATAGRID_MATURITY_STATE_DB_NAME:"AlternateItemCurrentStateDBName",CONSTANT_DATAGRID_COLUMN_HAS_CONFIG_CONTEXT:"HasConfigContext",CONSTANT_DATAGRID_LABEL:"label",CONSTANT_DATAGRID_MODEL:"HasConfigContext",CONSTANTS_TRUE:"true",CONSTANTS_URL:"url",CONSTANT_DATAGRID_AVAILABLE_CONTEXT:"AvaiableContexts",CONSTANT_DATAGRID_COLUMN_SOURCE:"Source",CONSTANT_DATAGRID_COLUMN_USAGE_COUNT:"UsageCount",CONSTANT_SUGGESTION_SELECT_USAGE:"SelectUsage",CONSTANT_SUGGESTION_DS6W_TYPE:"Type",CONSTANT_SUGGESTION_COLUMN_MATURITY_STATUS:"SuggestionMaturity",CONSTANT_SUGGESTION_COLUMN_REVISION:"SuggestionRevision",CONSTANT_SUGGESTION_COLUMN_STATUS:"SuggestionStatus",CONSTANT_DATAGRID_PRIMARY_USAGE_SCOPE:"PrimaryUsageScope",CONSTANT_USAGE_COLUMN_PRIMARY_ITEM_REVISION:"PrimaryItemRevision",CONSTANT_INTERCHANGEABILITY_TYPE:"InterchangeabilityType",CONSTANT_TILE_AVAILABLE_CONTEXT:"AvaiableContexts",RELATIONSHIP_ALTERNATE_ITEM:"Alternate Item",RELATIONSHIP_ALTERNATE_OF:"Alternate Of",PHYSICAL_ID:"physicalid",DS6W_LABEL:"ds6w:label",DS6W_RESPONSIBLE:"ds6w:responsible",DS6W_RESERVED:"ds6w:reserved",DS6W_RESERVEDBY:"ds6w:reservedBy",CONSTANT_RESERVEDBY:"reservedby",DS6W_DESCRIPTION:"ds6w:description",DS6W_IDENTIFIER:"ds6w:identifier",DS6W_TYPE:"ds6w:type",DS6WG_CUS_ALT_BOOL:"ds6wg:XP_Alternate Reference_Ext.Cus_ALT_Bool",DS6W_REVISION:"ds6wg:revision",DS6W_PARTNUMBER:"ds6wg:EnterpriseExtension.V_PartNumber",ALTERNATE_STATUS:"ALTERNATE_STATUS",OTHER_USAGE_ALTERNATE_STATUS_INFO:"OtherUsageStatusInfo",CONTEXT_SCOPE:"ContextScope",Operation_InstanceSubstitute:"InstanceSubstitute",Operation_ReferenceSubstitute:"ReferenceSubstitute",Operation_Alternate:"Alternate",UserSelectedInstanceTitle:"UserSelectedInstanceTitle",UserSelectedContextRevisionInformation:"UserSelectedContextRevisionInformation",UserSelectedContextParentPhysicalId:"UserSelectedContextParentPhysicalId",UserSelectedInstanceLogicalId:"UserSelectedInstanceLogicalId",UserSelectedContextApplicableParentPhysicalIds:"UserSelectedContextApplicableParentPhysicalIds",USER_SELECTED_CONTEXT_CONFIGURED_PRODUCT:"UserSelectedContextConfiguredProduct",APPLICABILITY_YES:"Yes",SPLIT_YES:"Yes",CONTEXTS:"Contexts",APPLICABILITY_NO:"No",SPLIT_NO:"No",SYMETRIC_NO:"No",OPERATION:"Operation",NOT_APPLICABLE:"Not Applicable",Element_1_PhysicalId:"Element_1_PhysicalId",Element_1_LogicalId:"Element_1_LogicalId",Element_2_PhysicalId:"Element_2_PhysicalId",Element_2_LogicalId:"Element_2_LogicalId",Element_3_PhysicalId:"Element_3_PhysicalId",Element_3_LogicalId:"Element_3_LogicalId",Element_2_type:"Element_2_type",Element_3_type:"Element_3_type",Constant_Products:"Products",Constant_VPMInstance:"VPMInstance",VALUE_QUANTITY_VIEW:"value-quantity-view",VALUE_MFG_VIEW:"ManufacturableView",VALUE_QUALIFIED_AS_FINAL_COMPONENT:"value_qualified_as_final_component",QUALIFIED_AS_FINAL_CMD:"QualifiedAsFinal",LEAF_MATERIALS_CMD:"LeafMaterials",CONSTANT_PARENT_CONTEXT_PHYSICALID:"ParentContextPhysicalid",CONSTANT_PARENT_CONTEXT_LOGICALID:"ParentContextLogicalid",CONSTANT_INSTANCE_CONTEXT_PHYSICALID:"InstanceContextPhysicalid",CONSTANT_INSTANCE_CONTEXT_LOGICALID:"InstanceContextLogicalid",CONSTANT_CONFIG_CONTEXT_PHYSICALID:"ConfigContextPhysicalId",CONSTANT_STATUS_ICON_CLASS:"StatusIconClass",TYPE_VPMREFERENCE:"VPMReference",INTERFACE_MEI:"ManufacturerEquivalentItemExtension",CONSTANT_INTERFACE:"interface",EVENT_LAUNCH_COMMAND:"show-light-component",OPEN_ENG_ITEM:"OpenProduct",MATURITY_GRAPH_CMD:"MaturityHdr",RELATEDOBJECTS_CMD:"RelatedObjectsHdr",CONST_SPEC_RELATION_COLUMN_DATAINDEX:"v6_specdoc_to",EVENT_COLUMN_PROVIDERS_LOADED:"event-column-providers-loaded",CONSTANT_INDEX_MODE_INPUT_PHYSICAL_IDS:"input_physical_ids",CONSTANT_INDEX_MODE_INPUT_LABEL:"label",CONTEXT_GRIDVIEW_SELCTION_COLUMN_TITLE:"Title",CONTEXT_GRIDVIEW_SELCTION_COLUMN_REVISION:"Revision",CONTEXT_GRIDVIEW_SELCTION_COLUMN_INSTANCE_NAME:"InstanceName",CONTEXT_GRIDVIEW_SELCTION_COLUMN_PARTNUMBER:"PartNumber",CONTEXT_GRIDVIEW_SELECTION_OPTIONS_LABEL_KEY:"ds6w:label",CONTEXT_GRIDVIEW_SELECTION_OPTIONS_REVISION_KEY:"ds6wg:revision",CONTEXT_GRIDVIEW_SELECTION_OPTIONS_PHYSICALID_KEY:"physicalid",CONTEXT_GRIDVIEW_SELECTION_OPTIONS_INSTANCEID_KEY:"instanceId",CONTEXT_GRIDVIEW_SELCTION_COLUMN_PARTNUMBER_KEY:"ds6wg:EnterpriseExtension.V_PartNumber",CONSTANT_AUTHORING_MODE:"authoring",CONSTANT_INDEX_MODE:"index",CONSTANT_USE_ONLY_DB:"use_only_DB",CONSTANT_AUTHORING_MODE_INFO:"Alternate_Facet_Authoring_Mode",CONSTANT_INTERVAL_TO_SWITCH:"intervalToSwitchMode",CONSTANT_ALTERNATE_VIEW_DATAGRID:"AlternateDataGridView",CONSTANT_SELECTED_INSTANCE_INFO:"selectedRelIds",CONSTANT_ALTERNATE_VIEW_TILES:"AlternateTilesView",TOOLBAR_SWITCH_VIEW:"enox-alternate-toolbar-switch-view-activated",RMB_EVENT_HANDLER:"enox-alternate-rmb-event",MULTI_SELECT_ENABLE_DISABLE_MAKE_APPLICABLE_CMD:"enox-alternate-toolbar-enable-disable-make-applicable-cmd",HIDE_SHOW_MAKE_APPLICABLE_CMD:"enox-alternate-toolbar-hide-show-make-applicable-cmd",MULTI_SELECT_ICON_UPDATE:"enox-alternate-toolbar-multiselect-icon-update",CONSTANT_RMB_CMD_OPEN:"open",CONSTANT_RMB_CMD_PROPOSE_FOR:"proposeFor",CONSTANT_RMB_CMD_QUALIFY:"qualify",CONSTANT_RMB_CMD_MANAGE_USAGES:"manageUsages",CONSTANT_RMB_CMD_MATURITY:"maturity",CONSTANT_RMB_CMD_RELATED_OBJECTS:"relatedObjects",CONSTANT_RMB_CMD_REMOVE:"remove",CONSTANT_RMB_CMD_OBSELETE:"obselete",CONSTANT_ENG_ITEM_LABEL:"ds6w:label",CONSTANT_ENG_ITEM_REVISION:"ds6wg:revision",CONSTANT_ENG_ITEM_INSTANCE:"ds6w:label-Instance",CONSTANT_DUPLICATE_IDS:"DuplicateIDs",CONSTANT_REVISION_IDS:"RevisionIDs",CONSTANT_BRANCH_IDS:"BranchIds",CONSTANT_BRANCH_FROM_IDS:"BranchFromIDs",CONSTANT_PREVIOUS_REVISION_IDS:"PreviousRevisionIDs",CONSTANT_OTHER_USAGE_IDS:"OtherUsageIDs",CONSTANT_SUGGESTION_DUPLICATE:"Duplicate",CONSTANT_SUGGESTION_REVISION:"Revision",CONSTANT_SUGGESTION_BRANCH:"Branch",CONSTANT_SUGGESTION_BRANCH_FROM:"BranchFrom",CONSTANT_SUGGESTION_PREVIOUS_REVISION:"PreviousRevision",CONSTANT_SUGGESTION_OTHER_USAGE:"OtherUsage",CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE:"AlternatesOfAlternate",CONSTANT_SUGGESTION_APPLICABLE_ALTERNATE:"primaryAlternates",CONSTANT_ALTERNATE_SUGGESTIONS_GROUPBY_OPTIONS:"alternateSuggestionsGroupByOptions",CONSTANT_SUGGESTION_CHANGE_USAGE:"ChangeUsage",CONSTANT_PRIMARY_ITEM_TITLE:"PrimaryItemTitle",CONSTANT_PRIMARY_ITEM_REVISION:"PrimaryItemRevision",CONSTANT_ALTERNATE_ITEM_TITLE:"AlternateItemTitle",CONSTANT_ALTERNATE_ITEM_REVISION:"AlternateItemRevision",CONSTANT_SUGGESTION_SOURCE_TITLE:"Title",CONSTANT_SUGGESTION_COLUMN_INFO:"SuggestionColumnInfo",CONSTANT_SUGGESTION_USAGE_COLUMN_INFO:"ColumnsOfUsageInfoPopup",CONSTANT_SUGGESTION_USAGE_COLUMN_OPTIONS:"ColumnsOptionsForUsageInfoPopup",CONSTANT_SUGGESTION_COLUMN_OPTIONS:"ColumnsOptionsForSuggestionPopup",CONSTANT_SUGGESTION_SETTINGS_COLUMN_OPTIONS:"ColumnsOptionsForSuggestionSettings",CONSTANT_SUGGESTION_SETTINGS_DATA:"AlternateSuggestionSettingsData",CONSTANT_SUGGESTION_FIND:"Find",CONSTANT_SUGGESTION_REVISION_EXPLORER:"RevisionExplorer",CONSTANT_SELECT_USAGE_ALL:"All Usage",CONSTANT_SELECT_USAGE_INSTANCE:"Selected Instance",CONSTANT_SELECT_USAGE_REFERENCE:"All Instance",CONSTANT_SUGGESTION_SOURCE_SETTINGS:"Alternate_Sugg_Source_Settings",CONSTANT_SUGGESTION_SETTINGS:"Settings",SHOW_HISTORY_CMD:"HistoryHdr",CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID:"alternate_primary_item_physical_id",CONSTANT_SUGGESTION_CUSTOM_TYPE_USAGE:"Usages",CONSTANT_SUGGESTION_CUSTOM_TYPE_SUBTYPE:"SubTypes",CONSTANT_SUGGESTION_CUSTOM_TYPE_OTHERVIEWS:"OtherViews",CONSTANT_SUGGESTION_CUSTOM_TYPE_REFERENCEVIEW:"referenceView",CONSTANT_SUGGESTION_CUSTOM_TYPE_OTHERUSAGES:"OtherUsages",CONSTANT_PROPERTIES_OBJECT_ID:"objectId",CONSTANT_PROPERTIES_TENANT_ID:"tenant",CONSTANT_FACET_PROPERTIES:"properties",CONST_SPEC_FACET_NAME:"relateddocuments_spec",CONSTANT_PROPERTIES_READ_ONLY:"readOnly",CONSTANT_SUGGESTION_VERSION_GRAPH_COPYFROM:"copyFrom",CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS:"ancestors",CONSTANT_SUGGESTION_VERSION_GRAPH_DERIVEDFROM:"V_DerivedFrom",CONSTANT_SUGGESTION_VERSION_GRAPH_VERSIONS:"versions",CONSTANT_SUGGESTION_VERSION_GRAPHS:"graphs",CONSTANT_SUGGESTION_VERSION_GRAPH_ID:"id",CONSTANT_SUGGESTION_VERSION_GRAPH_VID:"vid",CONSTANT_VERSION_GRAPH_ATTRIBUTES:"versionGraphAttributes",CONSTANT_SUGGESTION_VERSION_GRAPH_PAYLOAD:"graphRequests",CONSTANT_SUGGESTION_VERSION_GRAPH_PAYLOAD_ID:"id",CONSTANT_VERSION_GRAPH_PAYLOAD_ATTRIBUTE:"attributes",CHANGE_OWNER_CMD:"ActionBar_ChangeOwner",CONSTANT_APPLIACABLE:"Applicable",CONSTANT_NON_APPLIACABLE:"NON Applicable",CONSTANT_MIXED_APPLICABILITY:"Mixed",CONSTANT_CARRYOVER_ALT_REF_PHYSICALID:"AlternateReferencePhysicalId",CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD:"CarryOverFromRevisionsCommand",CONSTANT_CARRYOVER_ALTERNATES_COLUMNS_INFO:"CarryOverAlternatesColumnsInfo",CONSTANT_CARRYOVER_FROM_REVISION_EXPLORER:"CarryOverFromRevisionExplorer",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_OPTIONS:"ColumnsOptionsForCarryOverAlternatesPopup",CONSTANT_CARRYOVER_ALTERNATE_REVISIONS_COLUMN_OPTIONS:"ColumnsOptionsForCarryOverAlternateRevisionsPopup",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_REVISIONS_TITLE:"RevisionsTitle",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_ALTERNATE_TITLE:"AlternatesTitle",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_ALTERNATE_TITLE_DATAINDEX:"Title",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PART_NUMBER:"EnterpriseExtension.V_PartNumber",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY:"Maturity",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PRIMARY_ITEM_TITLE:"PrimaryItemTitle",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_INSTANCE_TITLE:"InstanceTitle",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_ALTERNATE_STATUS:"AlternateStatus",CONSTANT_CARRYOVER_REVISIONS_COLUMN_INFO:"CarryOverRevisionsColumnInfo",CONSTANT_CARRYOVER_REVISION_COLUMN_MATURITY_NLS:"maturity_nls",CONSTANT_CARRYOVER_REVISION_COLUMN_MODIFICATION_DATE:"modification",CONSTANT_CARRYOVER_REVISION_COLUMN_CREATION_DATE:"creation",CONSTANT_CARRYOVER_REVISIOND_COLUMN_DISCRIPTION:"description",CONSTANT_CARRYOVER_PARENT_PRODUCTS_PHYSICAL_ID:"parentProductPhysicalId",CONSTANT_CARRYOVER_SOURCE_PRODUCTS_PHYSICAL_ID:"sourceProductPhysicalId",CONSTANT_CARRYOVER_DEST_PRODUCTS_PHYSICAL_ID:"destProductPhysicalId",CONSTANT_CARRYOVER_REVISION_SEMANTIC:"E",CONSTANT_CARRYOVER_LIMIT:50}})),define("DS/ENOXAlternateSubstitute/facets/AlternateSpecificationsFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/EditPropWidget/facets/Common/FacetsBase","DS/ENOXSpecificationsUX/SpecificationsPane","DS/ENOXEngineer/utils/XEngineerConstants"],((e,t,n,a,i,r)=>t.extend(n,a,{init(e){this._parent(e),this.buildView(e)},buildView(t){const n=this;this.elements.container=e.createElement("div",{class:"relatedDocuments_spec"}),this.multiselDisplay=e.createElement("div",{class:"notSupported"}).inject(this.elements.container),this.iconHolder=e.createElement("span",{class:"blockIcon"}).inject(this.multiselDisplay),this.infoMsgH2Tag=e.createElement("h2",{class:"information_msg"}).inject(this.multiselDisplay),this.multiselDisplay.hide(),t.appContext.options.altAppCore.altSettingsManager.getAllPlatforms().then((e=>{const{includedTypes:a,excludedTypes:o}=t.appContext.options.altAppCore.altSettingsManager.getConfiguration("SpecificationTypes"),s={parentObject:{parentId:n.getUniqueSelectedNodeID()},connectorOptions:{fetchSecurityContext:()=>"ctx::"+t.appContext.options.altAppCore.altSettingsManager.getSecurityContext(),getWorkUnderHeaders:function(){return t.appContext.options&&t.appContext.options.altAppCore.altSettingsManager&&t.appContext.options.altAppCore.altSettingsManager.getWorkUnderHeaders&&t.appContext.options.altAppCore.altSettingsManager.getWorkUnderHeaders()},platformUrls:e[t.appContext.options.altAppCore.altSettingsManager.getPlatformId()]},supportedTypes:{includedTypes:a,excludedTypes:o},webinwin:!1};n.specificationsPane=new i(s),n.specificationsPane.modelEvents.subscribe({event:r.EVENT_UPLOAD_ATTACHMENT_COMPLETE},(function(){n.options.appContext.options.altAppCore.altSettingsManager.setAuthoringMode("authoring")})),n.specificationsPane.modelEvents.subscribe({event:r.EVENT_DETACH_ATTACHMENT_COMPLETE},(function(){n.options.appContext.options.altAppCore.altSettingsManager.setAuthoringMode("authoring")})),n.specificationsPane.modelEvents.subscribe({event:r.EVENT_ATTACH_ATTACHMENT_COMPLETE},(function(){n.options.appContext.options.altAppCore.altSettingsManager.setAuthoringMode("authoring")})),n.specificationsPane.inject(n.elements.container),n.multiselDisplay.isHidden()||n.specificationsPane.hide()}))},updateFacet(){const e=this.getUniqueSelectedNodeID();this.selectionModified(e)},getUniqueSelectedNodeID(){let e;const t=[this.options.appContext.objectId],n=[...new Set(t)];return 1===n.length&&([e]=n),e},destroyComponent(){},notApplicable(){this.infoMsgH2Tag.setText(this.options.appContext.i18nManager.get("notSupportedSelection")),this.iconHolder.addClassName("wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-block"),this.multiselDisplay.show(),this.specificationsPane&&this.specificationsPane.hide()},selectionModified(e){if(!e)return void this.notApplicable();this.multiselDisplay.hide();const t={parentId:e};this.specificationsPane&&(this.specificationsPane.show(),this.specificationsPane.options.parentObject.parentId!==e&&this.specificationsPane.setParentObject(t))},onResize(){},onRefresh(){}}))),define("DS/ENOXAlternateSubstitute/components/AlternateFilter",["DS/TreeModel/BaseFilter"],(function(e){return e.inherit({publishedProperties:{},isDataFiltered:function(e){if(this.isEmpty())return!1;var t=e.getAttributeValue(this.propertyId);return!(!this.filterModel||!this.filterModel.allowedRoles)&&-1===this.filterModel.allowedRoles.indexOf(t)},isEmpty:function(){return void 0===this.filterModel.allowedRoles||0==this.filterModel.allowedRoles.length}})})),define("DS/ENOXAlternateSubstitute/services/AlternateSettingsManager",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Controls/Abstract","DS/WebappsUtils/WebappsUtils","DS/ENOXEngineerCommonUtils/XENPlatform3DXSettings","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","text!DS/ENOXAlternateSubstitute/assets/config/AlternateManagement.conf.json"],(function(e,t,n,a,i,r,o,s,l,T){"use strict";var A=JSON.parse(T);return t.singleton(n,r,{initialize:function(e){this.altAppCore=e},getCommand:function(t){return e.is(t,"string")&&e.is(A.commands[t])?A.commands[t]:null},getConfiguration:function(t){return e.is(t,"string")&&e.is(A[t])?A[t]:null},getSecurityContext:function(){return widget&&widget.getValue&&widget.getValue("SC")?widget.getValue("SC"):this._preferredSC},getTenant:function(){return widget&&widget.getValue&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):this._platformId},getSmallIconPathFromIconSNResourceRepository:function(e){return this.getDefault3DSpaceUrl()+"/snresources/images/icons/small/"+e},getLargeIconPathFromIconSNResourceRepository:function(e){return this.getDefault3DSpaceUrl()+"/snresources/images/icons/large/"+e},getDefaultProductIcon:function(){return this.getDefault3DSpaceUrl()+"/snresources/images/icons/small/I_VPMNavProduct.png"},getDefaultProductThumbnail:function(e){if(!e)return i.getWebappsAssetUrl("ENOXEngineer","icons/32/I_VPMNavProduct108x144.png");const t=e.split("&").reduce(((e,t)=>{const n=t.split("=");return e[n[0]]=n[1],e}),{});switch(t.icon_95_2ddefaultthb_46_subtype||t.ipml_46_iconname){case"3DPart":return i.getWebappsAssetUrl("ENOXEngineer","img/I_3DPart108x144.png");case"I_VPMNavProduct":return i.getWebappsAssetUrl("ENOXEngineer","img/product.png");case"I_Part":return i.getWebappsAssetUrl("ENOXEngineer","img/I_Part108x144.png");default:return i.getWebappsAssetUrl("ENOXEngineer","icons/32/I_VPMNavProduct108x144.png")}},getChangeActionIcon:function(){return this.getDefault3DSpaceUrl()+"/snresources/images/icons/small/I_ECM_CA.png"},getCVRequestLabel:function(){return l.APP_NAME+"-"+this.getCurrentUser().id+"-"+(new Date).getTime()},isUsingDB:function(){if(this.altAppCore.appCore&&this.altAppCore.appCore.sessionManager&&this.altAppCore.appCore.sessionManager.isUsingDB)return this.altAppCore.appCore.sessionManager.isUsingDB();if(widget){var e=widget.getValue(l.CONSTANT_AUTHORING_MODE_INFO)?widget.getValue(l.CONSTANT_AUTHORING_MODE_INFO):null;if(!e)return!1;var t=(new Date).getTime();if(UWA.is(e.state,"string")&&UWA.is(e.last_editing,"number")){return e.state===l.CONSTANT_AUTHORING_MODE&&e.last_editing+18e4<t&&widget.setValue(l.CONSTANT_AUTHORING_MODE_INFO,{state:"index",last_editing:(new Date).getTime()}),!(e.last_editing+18e4<t)}}return!1},setAuthoringMode:function(e){if(this.altAppCore.appCore&&this.altAppCore.appCore.sessionManager&&this.altAppCore.appCore.sessionManager.setAuthoringMode)this.altAppCore.appCore.sessionManager.setAuthoringMode(e);else if(widget){var t={state:e,last_editing:(new Date).getTime()};widget.setValue(l.CONSTANT_AUTHORING_MODE_INFO,t)}},getWorkUnderHeaders:function(){return this.getAuthorizedChange(),this.authorizedChange&&this.authorizedChange.AuthoringContextHeader?Object.assign({},this.authorizedChange.AuthoringContextHeader):{}},getAuthorizedChange:function(){return this.authorizedChange=s.get(),this.authorizedChange},isChangeAuthorized:function(){var e=this.getAuthorizedChange().change&&this.getAuthorizedChange().change.id;return null!=e&&""!=e},_getUserPrefKey:function(e){return this.getPlatformId()+"_"+e},getUserImage:function(e){return this.getServiceURL(l.SERVICE_3DSWYM_NAME)+"/api/user/getpicture/login/"+e+"/format/normal"},get3DswymUrl:function(){return this.getServiceURL(l.SERVICE_3DSWYM_NAME)},isAuthoringAllowed:function(){return this.altAppCore.authoringAllowed}})})),define("DS/ENOXAlternateSubstitute/utils/AlternateHttpClient",["UWA/Core","DS/ENOXEngineerCommonUtils/XENGenericHttpClient","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOXEngineerCommonUtils/XENCommonConstants"],(function(e,t,n,a){"use strict";return Object.assign(e.clone(t,!0),{decorateWithAddtionnaloptions:function(e,t){t.noSecurityContextNeeded||t.targetService!==a.SERVICE_3DSPACE_NAME||(e.headers.SecurityContext=encodeURIComponent("ctx::"+n.getSecurityContext()),e.headers.SecurityToken=encodeURIComponent(n.getSecurityToken()))},buildChangeHeaders:function(e){return Object.assign(e,n.getWorkUnderHeaders())},buildUrl:function(e){var t=n.getServiceURL(e.targetService);return n.isTenantBasedService(e.targetService)?t=this.decorateUrlWithTenant(t+e.url):t+=e.url,e.sc_tenant_in_url&&(t=this.decorateUrlWithSecuritycontext(t)),e.queryParameters&&(t=this.decorateUrlWithQueryParameters(t,e.queryParameters)),t},decorateUrlWithTenant:function(e){var t=e||"",a=t.indexOf("?");return t=a>-1?t+"&tenant="+n.getPlatformId():t+"?tenant="+n.getPlatformId()},decorateUrlWithQueryParameters:function(e,t){if("string"==typeof e&&Array.isArray(t)){e+=`&${t.join("&")}`}return e},decorateUrlWithSecuritycontext:function(e){var t=n.getSecurityContext(),a=e||"";if(e&&t&&t.length>0){var i=a.indexOf("?");a=i>-1?a+"&SecurityContext="+encodeURIComponent("ctx::"+n.getSecurityContext()):a+"?SecurityContext="+encodeURIComponent("ctx::"+n.getSecurityContext())}return a}})})),define("DS/ENOXAlternateSubstitute/components/properties/js/AlternatePropertiesFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/UIKIT/Scroller","DS/EditPropWidget/facets/Common/FacetsBase","DS/Handlebars/Handlebars4","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","text!DS/ENOXAlternateSubstitute/components/properties/html/AlternateProperties.html","css!DS/ENOXAlternateSubstitute/components/properties/css/AlternateProperties.css"],(function(e,t,n,a,i,r,o,s,l,T,A,d,N){"use strict";var c={};return c[A.CONSTANT_PROPOSED]="eng.alternate.status.proposed",c[A.CONSTANT_FROZEN]="eng.alternate.status.frozen",c[A.CONSTANT_QUALIFIED]="eng.alternate.status.qualified",c[A.CONSTANT_OBSOLETE]="eng.alternate.status.obsolete",t.extend(n,i,{init:function(t){this._parent(t);this.elements.container||(this.elements.container=e.createElement("div",{class:"alternatePropertiesFacet"}))},getProvidedSC:function(){if(!T.getSecurityContext)return null;var e=T.getSecurityContext();return e?(e.startsWith("ctx::")&&(e=e.substring(5)),e):null},_buildView:function(t){var n=this;console.log("update facet"),n.wrapper=e.createElement("div",{class:"alternateSubstitute-content"}),n.elements.container.appendChild(n.wrapper);var i=!this.getProvidedSC(),s=T.getTenant();s&&"string"==typeof s&&T.setPlatformId(s),T.bindCommandsToABackend(i).then((function(){n.getAlternateProperties().then((function(e){if(e.hasOwnProperty(A.ERROR))o.errorAlert(e.response);else if(e.status==A.SUCCESS){var t=n.parseResponse(e),i=r.compile(N);n.wrapper.setHTML(i({attribute:t})),new a({element:n.wrapper}).inject(n.elements.container)}}))})).catch((function(e){console.error(e),o.errorAlert(d.get("error.contact.admin"))}))},parseResponse:function(e){for(var t=[],n=e.AlternateItemInfo,a=0;a<n.length;a++){var i={};i.label=d.get("eng.alternate.properties.primaryItem"),i.value=n[a].PrimaryItemTitle+" "+n[a].PrimaryItemRevision;var r={};r.label=d.get("eng.alternate.properties.alternateItem"),r.value=n[a].AlternateItemTitle+" "+n[a].AlternateItemRevision;var o={};o.label=d.get("eng.alternate.properties.usageDetails"),n[a][A.CONSTANT_PARENT_CONTEXT_TITLE]?n[a][A.CONSTANT_INSTANCE_CONTEXT_TITLE]?n[a][A.CONSTANT_PARENT_CONTEXT_TITLE]&&n[a][A.CONSTANT_INSTANCE_CONTEXT_TITLE]&&(o.value=d.get("eng.alternate.properties.usageDetails.instance").replace("$1",n[a][A.CONSTANT_INSTANCE_CONTEXT_TITLE]).replace("$2",n[a][A.CONSTANT_PARENT_CONTEXT_TITLE]).replace("$3",n[a][A.CONSTANT_PARENT_CONTEXT_REVISION])):o.value=d.get("eng.alternate.datagrid.column.usage.reference")+" "+n[a][A.CONSTANT_PARENT_CONTEXT_TITLE]+" "+n[a][A.CONSTANT_PARENT_CONTEXT_REVISION]:o.value=d.get("eng.alternate.usage.all");var s={};s.label=d.get("eng.alternate.properties.maturityState"),s.value=d.get(c[n[a][A.CONSTANT_STATUS]]),t.push(i),t.push(r),t.push(o),t.push(s)}return t},getAlternateProperties:function(){var e=T.getCommand("alternate_properties");e.url=e.url;var t={};return model&&(t[A.CONSTANT_ALT_REF_PHYSICALID]=[model.get("objectId")]),l.wrappedWithCancellablePromise((function(n,a){s.perform(e,t).then((function(e){return n(e)})).catch((function(e){n(e)}))}))},updateFacet:function(e){this._buildView(e)},destroyComponent:function(){console.warn("destroyComponent called")},onResize:function(){console.warn("onResize")},onRefresh:function(){},onAction:function(e){},isActionAvailable:function(e){}})})),define("DS/ENOXAlternateSubstitute/facets/AlternateFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/EditPropWidget/facets/Common/FacetsBase","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants"],(function(e,t,n,a,i,r,o,s){"use strict";return t.extend(n,a,{init:function(t){this._parent(t);this.elements.container||(this.elements.container=e.createElement("div",{class:"alternateSubstitute"})),this.appCore=this.options.appContext},_buildView:function(){var e,t=this;if(t.modid){if(!(e=t.getModel()))return!1;if(t.modid==e.get("objectId"))return}if(!t._alternateView){var n=r.getCommand("getUserSelectedPrimaryItemConfigurations"),a={};o.perform(n,"").then((function(e){a=e})).finally((function(){require(["DS/ENOXAlternateSubstitute/commands/AlternateFacetContentBuilder"],(function(e){t._alternateView=new e({readOnly:t.options.readOnly,authoringAllowed:!0,model:t.getModel(),appCore:t.options.appContext,activeEngItemTreeInfo:t.getXenTreeInfo(),viewInfo:t.getViewInfo(),alternateManagementConfigurations:a,altfacetContainer:widget.body}),t._alternateView.elements.container.inject(t.elements.container),t._alternateView.resizeToolbar(),t.refreshFacetView()}))}))}},getViewInfo:function(){var e=this,t={};e.appCore&&e.appCore.localStorage&&(t._isReferenceView=e.appCore.localStorage.getItem(s.VALUE_QUANTITY_VIEW),t._isFlatennedView=!(e.appCore.localStorage.getItem(s.VALUE_QUALIFIED_AS_FINAL_COMPONENT)!=s.QUALIFIED_AS_FINAL_CMD&&e.appCore.localStorage.getItem(s.VALUE_QUALIFIED_AS_FINAL_COMPONENT)!=s.LEAF_MATERIALS_CMD&&!e.appCore.localStorage.getItem(s.VALUE_MFG_VIEW)),t._isFlatView=!!(e.appCore&&e.appCore.sessionManager&&e.appCore.sessionManager.shouldShowFlatView&&e.appCore.sessionManager.shouldShowFlatView())&&e.appCore.sessionManager.shouldShowFlatView());var n=e.getXENTreeDoc(),a=n&&n.getSelectedNodes()&&n.getSelectedNodes()[0].getTreeDocument?n.getSelectedNodes()[0].getTreeDocument():null;return t._isGroupByView=a&&a.isViewGrouped?a.isViewGrouped():null,t._isReferenceOrFlattenedORGroupView=!!(t._isReferenceView||t._isFlatennedView||t._isGroupByView),t._isReferenceORGroupView=!(!t._isReferenceView&&!t._isGroupByView),t},getXENTreeDoc:function(){var e=this;return e.appCore&&e.appCore.contextManager&&e.appCore.contextManager.getXENTreeDocument()?e.appCore.contextManager.getXENTreeDocument():null},getXenTreeInfo:function(){var e=this,t={},n=e.getXENTreeDoc();if(t._selectedNodeId=n&&n.getSelectedNodes()&&n.getSelectedNodes()[0]?n.getSelectedNodes()[0].getID():null,t._selectedNodes=n&&n.getSelectedNodes()?n.getSelectedNodes():null,t._parentNode=e.appCore&&e.appCore.contextManager&&e.appCore.contextManager.getActiveEngItem()?e.appCore.contextManager.getActiveEngItem():t._selectedNodes?t._selectedNodes[0]:null,t._parentId=n&&n.getRoots()&&n.getRoots()[0]?n.getRoots()[0].getID():null,e.appCore.sessionManager&&e.appCore.sessionManager.shouldShowQuantityView&&e.appCore.sessionManager.shouldShowQuantityView()&&e.appCore.Factories&&t._selectedNodes[0]instanceof e.appCore.Factories.ListItemFactory.getReferenceClass()){let e=t._selectedNodes[0]&&t._selectedNodes[0].getOriginalParent?t._selectedNodes[0].getOriginalParent():t._parentNode;t._parentNode=e&&e.getID&&e.getID()&&""!=e.getID()?e:t._parentNode,t._parentId=e&&e.getID()?e.getID():t._parentId}else e.appCore.Factories&&t._selectedNodes[0]instanceof e.appCore.Factories.ListItemFactory.getListInstanceClass()&&(t._parentNode=t._selectedNodes[0].getParent()instanceof e.appCore.Factories.ListItemFactory.getListInstanceClass()?t._selectedNodes[0].getParent():e.appCore.contextManager.getActiveEngItem(),t._parentId=t._parentNode.getID());var a=t._parentNode&&t._parentNode.getPreferedAttachedConfigModel?t._parentNode.getPreferedAttachedConfigModel():null;return t._configModelVersionID=null!=a&&a._options.preferedVersion?a._options.preferedVersion.id:null,t},updateFacet:function(){var e=this,t=r.getTenant();return t&&"string"==typeof t&&r.setPlatformId(t),e._alternateView?e.refreshFacetView():e._buildView(),e.elements.container},checkIfSameInstance:function(e){var t=!0,n=e[0].getID(),a=e[0].getParent&&e[0].getParent()?e[0].getParent().getID&&e[0].getParent().getID():"";return e.forEach((function(e){var i=e.getParent&&e.getParent()?e.getParent().getID&&e.getParent().getID():"";if(e.getID()!=n||a!=i)return t=!1})),t},refreshFacetView:function(){var e=(t=this).appCore.contextManager.getXENTreeDocument().getSelectedNodes();if(0==e.length)console.error("Wrong number of selected object "+e.length);else if(e.length>1&&!t.checkIfSameInstance(e))console.error("Multiple selection not allowed"+e.length),this._alternateView.notApplicable("multipleSelection");else if(e[0].isEngineeringItem()){var t;(t=this)._alternateView.options.activeEngItemTreeInfo=t.getXenTreeInfo(),t._alternateView.options.viewInfo=t.getViewInfo(),t._alternateView.options.isFromRefreshFacet=!0,t._alternateView.selectionModified(t._alternateView.options.activeEngItemTreeInfo._selectedNodes,t._alternateView.options.activeEngItemTreeInfo._parentNode,t._alternateView.options.activeEngItemTreeInfo._selectedNodeId)}else this._alternateView.notApplicable("notSupported")},destroyComponent:function(){e.is(this.destroy,"function")&&this.destroy()}})})),define("DS/ENOXAlternateSubstitute/utils/AlternateDataParser",["UWA/Class","UWA/Core","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXEngineerCommonUtils/ExpandPayloadFactory","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n,a,i,r){return e.singleton({addIsApplicableData:function(e,t,n,a){var r=e[i.CONSTANT_ALT_ID];t[r]?t[r][i.CONSTANT_PARENT_CONTEXT_LOGICALID]==e[i.CONSTANT_PARENT_CONTEXT_LOGICALID]&&t[r][i.CONSTANT_INSTANCE_CONTEXT_LOGICALID]==e[i.CONSTANT_INSTANCE_CONTEXT_LOGICALID]?t[r][i.CONSTANT_STATUS]==i.CONSTANT_NOT_APPLICABLE?t[r]=e:e[i.CONSTANT_STATUS]!=i.CONSTANT_NOT_APPLICABLE&&(n[r]?n[r].push(e):(n[r]=[e],n[r].push(JSON.parse(JSON.stringify(t[r]))))):e[i.CONSTANT_STATUS]!=i.CONSTANT_NOT_APPLICABLE&&(t[r][i.CONSTANT_STATUS]==i.CONSTANT_NOT_APPLICABLE?t[r]=e:n[r]?n[r].push(e):(n[r]=[e],n[r].push(JSON.parse(JSON.stringify(t[r]))))):t[r]=e},mergeItemsOnAlternateCriteria:function(e,t){var n=this,a=[],r={},o=[],s={},l={},T={};return Array.isArray(e)&&e.forEach((function(e){var a=this.appInfo.altAppCore;data=n.basicOptionsBuilder(e,a);var T=data[i.CONSTANT_ALT_ID];data[i.CONSTANT_APPLICABILTY]==i.APPLICABILITY_YES||data[i.CONSTANT_SPLIT]==i.SPLIT_YES?data[i.CONSTANT_OPERATION_KEY]==i.Operation_Alternate?s[T]=data:n.addIsApplicableData(data,r,o,l):(this.appInfo.hasAlternatesInOtherContexts=!0,t&&(l.hasOwnProperty(T)?l[T].push(data):l[T]=[data]))})),Object.keys(s).forEach((function(e){n.createStatusObj(s[e],T)})),Object.keys(r).forEach((function(e){o.hasOwnProperty(e)&&(r[e][i.CONSTANT_OTHER_CONTEXT_KEY]=o[e],r[e][i.CONSTANT_OTHER_CONTEXT_APPLICABLE_DATA_EXISTS]=!0,r[e][i.CONSTANT_OTHER_CONTEXT_SAME_STATUS_EXISTS]=n.checkIfSameStatus(o[e],r[e][i.CONSTANT_STATUS]),delete o[e]),l.hasOwnProperty(e)&&(r[e][i.CONSTANT_OTHER_CONTEXT_KEY]||(r[e][i.CONSTANT_OTHER_CONTEXT_KEY]=[JSON.parse(JSON.stringify(r[e]))]),r[e][i.CONSTANT_OTHER_CONTEXT_KEY]=r[e][i.CONSTANT_OTHER_CONTEXT_KEY].concat(l[e]),delete l[e]),n.createStatusObj(r[e],T)})),a=n.changeOrderStatus(T),Object.keys(l).forEach((function(e){var t=JSON.parse(JSON.stringify(l[e][0]));t[i.CONSTANT_OTHER_CONTEXT_KEY]=JSON.parse(JSON.stringify(l[e])),a.push(t)})),a},createStatusObj:function(e,t){t.hasOwnProperty(e[i.CONSTANT_STATUS])?t[e[i.CONSTANT_STATUS]].push(e):t[e[i.CONSTANT_STATUS]]=[e]},checkIfSameStatus:function(e,t){for(var n in e)if(e[n][i.CONSTANT_APPLICABILTY]==i.APPLICABILITY_YES&&e[n].grid[i.CONSTANT_STATUS]!=t)return i.CONSTANT_NO;return i.CONSTANT_YES},changeOrderStatus:function(e){var t=[];return[i.CONSTANT_QUALIFIED,i.CONSTANT_PROPOSED,i.CONSTANT_FROZEN,i.CONSTANT_OBSOLETE,i.CONSTANT_NOT_APPLICABLE].forEach((function(n){e[n]&&(e[n].sort(((e,t)=>e.Title>t.Title?1:-1)),t=t.concat(e[n]))})),t},basicOptionsBuilder:function(e,t){return this.updateNLSValues(e,t),this.Options=Object.assign({grid:{}},e),this._fillAttributes(e),this.Options},getDefaultIcon:function(e,t){let n=e[i.CONSTANTS_ICON_NAME];return n?t.altSettingsManager.getSmallIconPathFromIconSNResourceRepository(n):t.altSettingsManager.getDefaultProductIcon()},getDefaultIconThumbnail:function(e,t){let n=e[i.CONSTANTS_THUMNAIL_NAME];return n?t.altSettingsManager.getLargeIconPathFromIconSNResourceRepository(n):t.altSettingsManager.getDefaultProductThumbnail()},updateNLSValues:function(e,t){var n=t.altDataServices.getNlsOfPropertiesValues();e[i.CONSTANT_DATAGRID_MATURITY_STATE_DB_NAME]=e[i.CONSTANT_DATAGRID_MATURITY_STATE],e[i.CONSTANTS_ICON]=e[i.CONSTANTS_ICON]?e[i.CONSTANTS_ICON]:this.getDefaultIcon(e,t),e[i.CONSTANTS_THUMNAIL]=e[i.CONSTANTS_THUMNAIL]?e[i.CONSTANTS_THUMNAIL]:this.getDefaultIconThumbnail(e,t),e[i.CONSTANT_DATAGRID_MATURITY_STATE]=n["ds6w:status"][e[i.CONSTANT_DATAGRID_MATURITY_STATE]],e[i.DS6W_TYPE]=n["ds6w:type"][e[i.DS6W_TYPE]]?n["ds6w:type"][e[i.DS6W_TYPE]]:e[i.DS6W_TYPE]},_fillAttributes:function(e){var t=this;return Object.keys(e).forEach((function(n){t.Options.grid[n]=e[n]})),this.Options},parseFetchedResult:function(e){var t=this,n=e.results,a=[];return n.forEach((function(e){a.push(t.attributesParser(e.attributes))})),a},attributesParser:function(e){for(var t={},n=0;n<e.length;n++)t[e[n].name]=e[n].value;return t},parseExpandResult:function(e){if(!e||!Array.isArray(e.results))throw new Error("Ouups ! invalid input");var n={nodes:{},paths:[],iconsSet:[]},a=this;return e.results.forEach((function(e){if(e.hasOwnProperty("attributes")){var i=a.attributesParser(e.attributes);t.is(i.did)&&(n.nodes[i.did]=i)}else e.hasOwnProperty("path")?n.paths.push(e.path):e.hasOwnProperty("icon__default_thumbnail_2d")&&(n.iconsSet=e.icon__default_thumbnail_2d)})),this.updateNodeWithIconsData(n),n},updateNodeWithIconsData:function(e){var t=e.iconsSet,n=e.nodes;Array.isArray(t)&&t.forEach((function(e){e.did.forEach((function(t){let a=n[t],i=e.icon;a.thumbnail=a.thumbnail?a.thumbnail:e.thumbnail_2d,a&&a.icons?a.icons.push(i):a.icons=[i]}))}))},parsedExpandV2Result:function(e){if(!e||!Array.isArray(e.results))throw new Error("Ouups ! invalid input");var t={nodes:{},paths:[],iconsSet:[]};return JSON.parse(JSON.stringify(e)).results.forEach((function(e){e.hasOwnProperty("Path")?t.paths.push(e.Path):(t.nodes[e.resourceid]=e,t.nodes[e.resourceid].physicalid=t.nodes[e.resourceid].resourceid,t.iconsSet.push({did:e.resourceid,icon:e.icon,thumbnail_2d:appInfo.altAppCore.altSettingsManager.getDefaultProductThumbnail(e.icon)}),delete t.nodes[e.resourceid].resourceid)})),t},doExpand:async function(e,t,i){const{executor:r,payloadAlreadyConverted:o}=t||{};if(!r||!e)throw new Error("invalid inputs");const s=i.altAppCore.altSettingsManager.getCommand(r);if(!s)throw new Error(`unknow expand command executor ${r}`);const l=o?e:a.convertPayloadTo(e,r);if(!l)throw new Error("fails to convert payload");const T=[];let A=null;try{A=await n.perform(s,JSON.stringify(l))}catch(e){T.push(e)}return a.postTreatAnswer(A,r),A}})})),define("DS/ENOXAlternateSubstitute/utils/AlternateUtils",["UWA/Core","UWA/Utils","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/TreeModel/TreeNodeModel","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOFilterBIUX/FilterBIComponentProxy","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXEngineerCommonUtils/XENCommonConstants"],(function(e,t,n,a,i,r,o,s){var l={getformatedDate:function(e){if(!this.dataFormatter){let e=localStorage.getItem(s.REGIONAL_FORMAT_LANGAUAGE)?localStorage.getItem(s.REGIONAL_FORMAT_LANGAUAGE):i.getLanguage();this.dataFormatter=new Intl.DateTimeFormat(e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}try{return this.dataFormatter.format(new Date(e)).replace(",","")}catch(t){return e}},mapSelectedAlternate:function(e){return{id:e[o.CONSTANT_ALT_ID]?e[o.CONSTANT_ALT_ID]:e.id,value:e[o.CONSTANT_ALT_ID]||e.resourceid,label:e[o.CONSTANT_DATAGRID_LABEL]+" "+e[o.CONSTANT_REVISION],icon:Array.isArray(e.icons)?e.icons[0]:e.type_icon_url}},isNodeFromModel:function(e){return e&&e.getNodeSource()===a.NODE_SOURCE.MODEL},prepareDragData:function(e,t){var n={protocol:"3DXContent",version:"1.1",source:o.APP_NAME,widgetId:i.getWidgetId(),data:{items:[]}},a=[];return Array.isArray(e)&&e.length>0&&e[0]&&e.forEach((function(e){var t={envId:i.getPlatformId(),serviceId:o.SERVICE_3DSPACE_NAME,contextId:"",objectId:e.getInterchangeabilityID(),objectType:e.getReferenceType(),displayName:e.getInterchangeabilityTitle(),displayType:e.getReferenceType()};a.push(t)})),n.data.items=a,JSON.stringify(n)},loadFiles:function(e,t){var n=new Promise((function(t,n){var a=function(e){n(e)};Array.isArray(e)?require(e,(function(){t(arguments)}),a):a(e)}));return n}};return l})),define("DS/ENOXAlternateSubstitute/views/AlternateItemModel",["UWA/Core","DS/TreeModel/TreeNodeModel","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n,a){function i(a){this.options={contextualMenu:[null],emptyStatusbarVisibleFlag:!0},this.options=e.extend(this.options,a),t.call(this,this.options),this.options.getAttributeValueForFiltering=e=>{switch(e){case"Status":return this.options.grid.AlternateQualificationStatus;case"UsageScope":return this.options.grid[n.CONSTANT_SPLIT]==n.CONSTANT_YES?this.options.grid.AvaiableContexts.split(":")[0]:this.options.grid.AvaiableContexts;case"ActiveChange":return this.options.grid[n.CONSTANT_WORK_UNDER_CHANGE_ID]&&""!=this.options.grid[n.CONSTANT_WORK_UNDER_CHANGE_ID]?"Enabled":"Disabled";case"ds6w:reserved":return this.getLockDataForFilter(e);default:return this.options.grid[e]}}}return i.prototype=Object.create(t.prototype),i.prototype.getOtherContextAlternteItems=function(){return this.options.OtherContexts?this.options.OtherContexts:[]},i.prototype.getOnClickContextAlternateItems=function(){var e=[],t=this.getOtherContextAlternteItems(),a=this.options;a[n.CONSTANT_APPLICABILTY]!=n.CONSTANT_YES&&0!=t.length||e.push(a);for(var i=0;i<t.length;i++)e.push(t[i]);return e},i.prototype.getReferenceVersion=function(){return this.options.grid[n.CONSTANT_REVISION]},i.prototype.getLockDataForFilter=function(e){const t=this.options.grid[e],n=this.options.grid["ds6w:reservedBy"];return t&&"FALSE"!==t?a.get("lockedBy").replace("{user}",n):a.get("notLocked")},i.prototype.getType=function(){return n.TYPE_VPMREFERENCE},i.prototype.getID=function(){return this.options.grid[n.CONSTANT_ALT_ID]},i.prototype.getInterchangeabilityID=function(){return this.options.grid[n.CONSTANT_ALT_REF_PHYSICALID]},i.prototype.getInterchangeabilityTitle=function(){return this.options.grid[n.CONSTANT_ALT_REF_TITLE]},i.prototype.getPhysicalID=function(){return this.options.grid[n.CONSTANT_KEY_PHYSICALID]},i.prototype.getLabel=function(){return this.options.grid[n.CONSTANTS_KEY_TITLE]},i.prototype.getDisplayName=function(){return this.getLabel()+" "+this.getReferenceVersion()},i.prototype.getUuid=function(){return this.getID()},i.prototype.getAlternateTilesViewOrderedAttribute=function(){var e=[];e.push({attrName:n.CONSTANT_DATAGRID_MATURITY_STATE,attrNls:"eng.alternate.column.maturityState",attrLabel:"eng.alternate.label.maturityState"}),e.push({attrName:n.CONSTANT_PARTNUMBER,attrNls:"eng.alternate.column.partNumber",attrLabel:"eng.alternate.label.partNumber"});var t=this,i=[];return e.forEach((function(e){var n={};n.attrName=e.attrName,n.name=a.get(e.attrNls),n.attrLabel=a.get(e.attrLabel),n.value=t.options.grid[e.attrName],i.push(n)})),i},i.prototype.getTypeForVersionGraph=function(){return this.getType()},i.prototype.getIdForVersionGraph=function(){return this.getID()},i.prototype.getRevision=function(){return this.getReferenceVersion()},i.prototype.getTitle=function(){return this.getLabel()},i.prototype.getReferenceType=function(){return this.options.grid[n.CONSTANT_INTERCHANGEABILITY_TYPE]},i.prototype.getTypeActualName=function(){return this.getType()},i.prototype.attributeRemoteLoadingNotStart=function(t){if(!e.is(t,"string"))return!1;var n=this.getAttributeValue(t);return"#queued#"===n||void 0===n},i.prototype.isAttributePending=function(t,n){if(!e.is(t,"string"))return!1;return Array.isArray(n)?-1!==(n.indexOf("#loading#")||n.indexOf("#queued#")):-1!==["#loading#","#queued#"].indexOf(this.getAttributeValue(t))},i.prototype.updateWithChangeSet=function(e){let t=!1;this.matchChangeSet(e)&&(Object.assign(this.options.grid,e.options.grid),t=!0),t&&this.updateOptions(this.options)},i.prototype.matchChangeSet=function(e){let t=function(e){let t=e.referenceId||e.instanceId||e.occurrenceId;return Array.isArray(t)?t.join("/"):t}(e);return this.matchIDs([t])},i.prototype.matchIDs=function(e){const t=this.getInterchangeabilityID?this.getInterchangeabilityID():null;return-1!==e.indexOf(t)},i})),define("DS/ENOXAlternateSubstitute/views/AlternateGridViewManager",["UWA/Class","DS/DataGridView/DataGridView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CoreEvents/ModelEvents","DS/ENOXAlternateSubstitute/views/AlternateItemModel","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/utils/AlternateUtils","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n,a,i,r,o,s,l,T,A){"use strict";const d={icon:{iconName:"lock-open wux-ui-3ds",fontIconFamily:1},label:"",url:"#UNEXISTANT_ID"},N={icon:{iconName:"key wux-ui-3ds",fontIconFamily:1},label:"",url:"#UNEXISTANT_ID"},c={icon:{iconName:"lock wux-ui-3ds",fontIconFamily:1},label:"",url:"#UNEXISTANT_ID"};var _=e.singleton({init:function(e){this._parent(e)},initialize:function(e){var t=this;this.options=e,this._loadColumnsProviders(),this.defaultColumnIndexes=[],this.options.updateCustomAttributeEvents=new i,this.options.updateCustomAttributeEvents.subscribe({event:"db_nodes_loaded"},(function(e){t.options.altAppCore.altSettingsManager.isUsingDB()&&t.options.altAppCore.altDicoServices.additionalColumnsAndBOs.additionalColumns&&t.options.altAppCore.altDicoServices.additionalColumnsAndBOs.additionalColumns.length&&t.publishNodesToRefresh(e,t.options.altAppCore.altDicoServices.additionalColumnsAndBOs.additionalColumns)}))},_columnConfiguration:function(e){var t=this,n=e.altSettingsManager.getCommand(T.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES).Alternate,a=[],i={children:[],dataIndex:T.CONSTANT_DATAGRID_COLUMN_INTERCHANGEABILITY,text:A.get("eng.alternate.column.interchangeability"),visibleFlag:!0,filterableFlag:!1},r={children:[],dataIndex:T.CONSTANT_DATAGRID_COLUMN_ALTERNATE,text:A.get("eng.alternate.column.alternate"),visibleFlag:!0,filterableFlag:!1};return[T.CONSTANT_DATAGRID_COLUMN_TITLE,T.CONSTANT_DATAGRID_PART_NUMBER,T.CONSTANT_DATAGRID_COLUMN_REVISION,T.CONSTANT_DATAGRID_MATURITY_STATE,T.CONSTANT_DATAGRID_THUMBNAIL,T.CONSTANT_DATAGRID_COLUMN_STATUS,T.CONSTANT_DATAGRID_USAGE_SCOPE,T.CONSTANT_DATAGRID_COLUMN_CHANGE,T.CONSTANT_DATAGRID_COLUMN_V_NAME].forEach((function(i){n.forEach((function(n){n.attrName===i&&t.getColumnConfiguration(n,a,e)}))})),t.getAllProvidedColumns().forEach((function(n){t.getAddtionalColumnConfiguration(n,a,e)})),a.forEach((e=>{0!=e.filterableFlag&&this.defaultColumnIndexes.push(e.dataIndex),e.interchangeabilityColumn?i.children.push(e):r.children.push(e)})),[r,i]},getColumnConfiguration:function(e,t,n){var a=this;switch(e.attrName){case T.CONSTANT_DATAGRID_COLUMN_TITLE:t.push({text:A.get(e.attrNls),dataIndex:"tree",width:e.width?e.width:"auto",pinned:e.pinned?e.pinned:"unpinned",alwaysVisibleFlag:T.CONSTANTS_TRUE,getCellValue:function(e){if(n.altItemFactory.checkIfHeaderNode(e.nodeModel)&&e.nodeModel.options.grid[T.CONSTANT_DATAGRID_COLUMN_TITLE]){var t=n.altItemFactory.getNodeCounterQuantity(e.nodeModel);return A.get("eng.alternate.header.title").replace("$1",e.nodeModel.options.grid[T.CONSTANT_DATAGRID_COLUMN_TITLE]).replace("$2",t)}return e.nodeModel.options.grid[T.CONSTANT_DATAGRID_COLUMN_TITLE]?e.nodeModel.options.grid[T.CONSTANT_DATAGRID_COLUMN_TITLE]:n.altItemFactory.getNlsOfGroupByTitle(e.nodeModel)},getCellValueAsStringForFind:function(e){if(e&&e.nodeModel)return e.nodeModel.options.grid[T.CONSTANT_DATAGRID_COLUMN_TITLE]?e.nodeModel.options.grid[T.CONSTANT_DATAGRID_COLUMN_TITLE]:n.altItemFactory.getNlsOfGroupByTitle(e.nodeModel)},getCellGroupingKey:t=>{if(t&&t.nodeModel)return t.nodeModel.options.grid[e.dataIndex]}});break;case T.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY:case T.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PRIMARY_ITEM_TITLE:case T.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PART_NUMBER:case T.CONSTANT_CARRYOVER_REVISION_COLUMN_MATURITY_NLS:case T.CONSTANT_CARRYOVER_REVISION_COLUMN_MODIFICATION_DATE:case T.CONSTANT_CARRYOVER_REVISION_COLUMN_CREATION_DATE:case T.CONSTANT_CARRYOVER_REVISIOND_COLUMN_DISCRIPTION:t.push({text:A.get(e.attrNls),dataIndex:e.dataIndex,width:e.width?e.width:"auto",pinned:e.pinned?e.pinned:"unpinned",allowUnsafeHTMLContent:T.CONSTANTS_TRUE,alwaysVisibleFlag:T.CONSTANTS_TRUE,getCellValue:function(t){return t.nodeModel.options.grid[e.dataIndex]},getCellGroupingKey:t=>{if(t&&t.nodeModel)return t.nodeModel.options.grid[e.dataIndex]}});break;case T.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_ALTERNATE_TITLE:case T.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_REVISIONS_TITLE:t.push({text:A.get(e.attrNls),dataIndex:"tree",width:e.width?e.width:"auto",pinned:e.pinned?e.pinned:"unpinned",alwaysVisibleFlag:T.CONSTANTS_TRUE,getCellValue:function(t){return t.nodeModel.options.grid[e.dataIndex]},getCellGroupingKey:t=>{if(t&&t.nodeModel)return t.nodeModel.options.grid[e.dataIndex]}});break;case T.CONSTANT_DATAGRID_COLUMN_STATUS:t.push({text:A.get(e.attrNls),dataIndex:e.attrName,interchangeabilityColumn:!0,sortableFlag:!0,width:e.width?e.width:"41px",allowUnsafeHTMLContent:T.CONSTANTS_TRUE,getCellValue:function(e){if(s.isNodeFromModel(e&&e.nodeModel))return n.altItemFactory.getValidStatus(e.nodeModel,!1).outerHTML},getCellGroupingKey:e=>{if(e&&e.nodeModel)return e.nodeModel.options.grid[T.CONSTANT_STATUS]},getCellValueForSort:e=>{if(e)return e.options.grid[T.CONSTANT_STATUS]}});break;case T.CONSTANT_USAGE_COLUMN_PRIMARY_ITEM_REVISION:case T.CONSTANT_SUGGESTION_COLUMN_MATURITY_STATUS:case T.CONSTANT_DATAGRID_COLUMN_REVISION:t.push({text:A.get(e.attrNls),dataIndex:e.dataIndex,width:e.width?e.width:"41px",getCellValue:function(t){if(s.isNodeFromModel(t&&t.nodeModel))return t.nodeModel.options.grid[e.dataIndex]},getCellGroupingKey:t=>{if(t&&t.nodeModel)return t.nodeModel.options.grid[e.dataIndex]}});break;case T.CONSTANT_SUGGESTION_COLUMN_REVISION:case T.CONSTANT_DATAGRID_COLUMN_USAGE_COUNT:case T.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_INSTANCE_TITLE:t.push({text:A.get(e.attrNls),dataIndex:e.dataIndex,width:e.width?e.width:"auto",typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(t){return{label:t.nodeModel.options.grid[e.dataIndex],url:"#UNEXISTANT_ID"}},getCellGroupingKey:t=>{if(t&&t.nodeModel)return t.nodeModel.options.grid[e.dataIndex]}});break;case T.CONSTANT_DATAGRID_MATURITY_STATE:t.push({text:A.get(e.attrNls),dataIndex:e.dataIndex,width:e.width?e.width:"auto",typeRepresentation:"tag",hyperlinkTarget:"_self",getCellValue:function(t){if(s.isNodeFromModel(t&&t.nodeModel))return t.nodeModel.options.grid[e.dataIndex]},getCellClassName:e=>{if(e&&e.nodeModel&&s.isNodeFromModel(e&&e.nodeModel)&&e.nodeModel){let t=e.nodeModel.options.grid[T.CONSTANT_DATAGRID_MATURITY_STATE_DB_NAME].toUpperCase();return t=t.replace(/(\.| )/g,"_"),`lc-status-VPLM_SMB_Definition_MajorRev-${t}-withClass`}},getCellGroupingKey:t=>{if(t&&t.nodeModel)return t.nodeModel.options.grid[e.dataIndex]}});break;case T.CONSTANT_DATAGRID_PART_NUMBER:t.push({text:A.get(e.attrNls),dataIndex:e.attrName,width:e.width?e.width:"81px",visibleFlag:!0,getCellValue:function(e){if(s.isNodeFromModel(e&&e.nodeModel))return e.nodeModel.options.grid[T.CONSTANT_DATAGRID_PART_NUMBER]},getCellGroupingKey:t=>{if(t&&t.nodeModel)return t.nodeModel.options.grid[e.dataIndex]}});break;case T.CONSTANT_DATAGRID_USAGE_SCOPE:t.push({text:A.get(e.attrNls),dataIndex:e.attrName,interchangeabilityColumn:!0,sortableFlag:!0,getCellValue:function(e){if(s.isNodeFromModel(e&&e.nodeModel))return e.nodeModel.options.grid[T.CONSTANT_DATAGRID_AVAILABLE_CONTEXT]},getCellGroupingKey:e=>{if(e&&e.nodeModel)return e.nodeModel.options.grid[T.CONSTANT_DATAGRID_AVAILABLE_CONTEXT]},getCellValueForSort:e=>{if(e)return e.options.grid[T.CONSTANT_DATAGRID_AVAILABLE_CONTEXT]}});break;case T.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_ALTERNATE_STATUS:case T.CONSTANT_SUGGESTION_COLUMN_STATUS:t.push({text:A.get(e.attrNls),dataIndex:e.dataIndex,sortableFlag:!0,width:e.width?e.width:"41px",allowUnsafeHTMLContent:T.CONSTANTS_TRUE,getCellValueAsStringForFind:function(e){return""},getCellValue:function(e){var t=n.altItemFactory.getStatus(e.nodeModel,!0);return t?n.altItemFactory.buildIconSpan(t[T.CONSTANT_STATUS_ICON_CLASS],t[T.CONSTANT_STATUS]).outerHTML:""},getCellGroupingKey:t=>{if(t&&t.nodeModel)return t.nodeModel.options.grid[e.dataIndex]}});break;case T.CONSTANT_DATAGRID_COLUMN_CHANGE:t.push({text:A.get(e.attrNls),dataIndex:e.dataIndex,sortableFlag:!0,groupableFlag:!0,filterableFlag:!0,interchangeabilityColumn:!0,width:"41px",typeRepresentation:"image",getCellValue:function(e){return e.nodeModel.options.grid.WorkUnderChangeActionPhyId&&""!=e.nodeModel.options.grid.WorkUnderChangeActionPhyId?n.altSettingsManager.getChangeActionIcon():"N/A"},getCellGroupingKey:e=>{if(e&&e.nodeModel)return e.nodeModel.options.grid[T.CONSTANT_WORK_UNDER_CHANGE_ID]&&""!=e.nodeModel.options.grid[T.CONSTANT_WORK_UNDER_CHANGE_ID]?"Enabled":"Disabled"},getCellValueForSort:e=>{if(e)return e.options.grid[T.CONSTANT_WORK_UNDER_CHANGE_ID]&&""!=e.options.grid[T.CONSTANT_WORK_UNDER_CHANGE_ID]?"Enabled":"Disabled"}});break;case T.CONSTANT_DATAGRID_THUMBNAIL:t.push({text:A.get(e.attrNls),dataIndex:e.dataIndex,sortableFlag:!1,groupableFlag:!1,filterableFlag:!1,visibleFlag:!1,width:"41px",typeRepresentation:"image",getCellValue:function(e){return e.nodeModel.options.grid[T.CONSTANTS_THUMNAIL]&&""!=e.nodeModel.options.grid[T.CONSTANTS_THUMNAIL]?e.nodeModel.options.grid[T.CONSTANTS_THUMNAIL]:"N/A"},getCellGroupingKey:e=>{if(e&&e.nodeModel)return e.nodeModel.options.grid[T.CONSTANTS_THUMNAIL]}});break;case T.CONSTANT_DATAGRID_COLUMN_SOURCE:t.push({text:A.get(e.attrNls),dataIndex:e.dataIndex,sortableFlag:!0,width:"41px",allowUnsafeHTMLContent:T.CONSTANTS_TRUE,getCellValueAsStringForFind:function(e){return""},getCellValue:function(e){var t=e.nodeModel.options.grid[T.CONSTANT_DATAGRID_COLUMN_SOURCE];return n.altItemFactory.buildIconSpan(a.getSuggestionSourceIcons(t),n.altItemFactory.getNLSPropertyMap(t)).outerHTML},getCellGroupingKey:t=>{if(t&&t.nodeModel)return t.nodeModel.options.grid[e.dataIndex]}});break;case T.CONSTANT_SUGGESTION_SELECT_USAGE:t.push({text:A.get(e.attrNls),dataIndex:e.dataIndex,sortableFlag:!0,editionPolicy:"EditionOnOver",width:"auto",getCellEditableState:function(e){return!0},getCellValueAsStringForFind:function(e){return""},setCellValue:function(e,t){t==A.get("eng.alternate.select.usage.all")?e.nodeModel.options.grid[T.CONSTANT_SUGGESTION_SELECT_USAGE]=T.CONSTANT_SELECT_USAGE_ALL:t==A.get("eng.alternate.select.usage.reference")?e.nodeModel.options.grid[T.CONSTANT_SUGGESTION_SELECT_USAGE]=T.CONSTANT_SELECT_USAGE_REFERENCE:t==A.get("eng.alternate.select.usage.instance")&&(e.nodeModel.options.grid[T.CONSTANT_SUGGESTION_SELECT_USAGE]=T.CONSTANT_SELECT_USAGE_INSTANCE),e.nodeModel.select()},getCellTypeRepresentation:function(e){return e.nodeModel&&e.nodeModel._isFromOriginalModel()?T.CONSTANT_SUGGESTION_CUSTOM_TYPE_USAGE:""},getCellValue:function(e){var t=e.nodeModel.options.grid[T.CONSTANT_SUGGESTION_SELECT_USAGE];return t===T.CONSTANT_SELECT_USAGE_ALL?A.get("eng.alternate.select.usage.all"):t===T.CONSTANT_SELECT_USAGE_REFERENCE?A.get("eng.alternate.select.usage.reference"):t===T.CONSTANT_SELECT_USAGE_INSTANCE?A.get("eng.alternate.select.usage.instance"):""},getCellGroupingKey:t=>{if(t&&t.nodeModel)return t.nodeModel.options.grid[e.dataIndex]}});break;case T.CONSTANT_DATAGRID_COLUMN_V_NAME:t.push({text:A.get(e.attrNls),dataIndex:e.dataIndex,sortableFlag:!0,editionPolicy:"EditionOnDoubleClick",editableFlag:n.altSettingsManager.isAuthoringAllowed(),width:"auto",interchangeabilityColumn:!0,dbName:T.CONSTANT_DATAGRID_COLUMN_V_NAME,visibleFlag:!1,getCellValue:function(e){if(e&&e.nodeModel)return e.nodeModel.options.grid[T.CONSTANT_ALT_REF_TITLE]},setCellValue:function(e,t){a._setCellValue(e,T.CONSTANT_ALT_REF_TITLE,t)},getCellGroupingKey:t=>{if(t&&t.nodeModel)return t.nodeModel.options.grid[e.dataIndex]}});break;case T.CONSTANT_SUGGESTION_DS6W_TYPE:t.push({text:A.get(e.attrNls),dataIndex:e.dataIndex,sortableFlag:!0,editionPolicy:"EditionOnOver",width:"auto",getCellEditableState:function(e){return!0},getCellValueAsStringForFind:function(e){return""},setCellValue:function(e,t){e.nodeModel.options.grid[T.CONSTANT_DS_TYPE]=t,e.nodeModel.select()},getCellTypeRepresentation:function(e){return e.nodeModel&&e.nodeModel._isFromOriginalModel()?T.CONSTANT_SUGGESTION_CUSTOM_TYPE_SUBTYPE:""},getCellValue:function(e){return e.nodeModel.options.grid[T.CONSTANT_DS_TYPE]},getCellGroupingKey:t=>{if(t&&t.nodeModel)return t.nodeModel.options.grid[e.dataIndex]}});break;case T.CONSTANT_PRIMARY_ITEM_TITLE:t.push({text:A.get(e.attrNls),dataIndex:e.dataIndex,getCellValue:function(e){return e.nodeModel.options.grid[T.CONSTANT_PRIMARY_ITEM_TITLE]},getCellGroupingKey:t=>{if(t&&t.nodeModel)return t.nodeModel.options.grid[e.dataIndex]}});break;case T.CONSTANT_DATAGRID_PRIMARY_USAGE_SCOPE:t.push({text:A.get(e.attrNls),dataIndex:T.CONSTANT_DATAGRID_USAGE_SCOPE,getCellValue:function(e){if(e.nodeModel.options.grid[T.CONSTANT_PARENT_CONTEXT_TITLE])if(e.nodeModel.options.grid[T.CONSTANT_INSTANCE_CONTEXT_TITLE]){if(e.nodeModel.options.grid[T.CONSTANT_PARENT_CONTEXT_TITLE]&&e.nodeModel.options.grid[T.CONSTANT_INSTANCE_CONTEXT_TITLE])t=A.get("eng.alternate.properties.usageDetails.instance").replace("$1",e.nodeModel.options.grid[T.CONSTANT_INSTANCE_CONTEXT_TITLE]).replace("$2",e.nodeModel.options.grid[T.CONSTANT_PARENT_CONTEXT_TITLE]).replace("$3",e.nodeModel.options.grid[T.CONSTANT_PARENT_CONTEXT_REVISION])}else var t=A.get("eng.alternate.datagrid.column.usage.reference")+" "+e.nodeModel.options.grid[T.CONSTANT_PARENT_CONTEXT_TITLE]+" "+e.nodeModel.options.grid[T.CONSTANT_PARENT_CONTEXT_REVISION];else var t=A.get("eng.alternate.usage.all");return t},getCellGroupingKey:t=>{if(t&&t.nodeModel)return t.nodeModel.options.grid[e.dataIndex]}})}},addDefaultCustomColumnCallback:function(e,t){const n=e.dataIndex;if(-1!==["datetime","timestamp"].indexOf(t.kind))e.typeRepresentation="datetime",e.getCellValue=e=>{if(!s.isNodeFromModel(e&&e.nodeModel))return;return s.getformatedDate(e.nodeModel.options.grid[n])},!0===e.editableFlag&&(e.setCellValue=(e,t)=>{null!==t&&(t=(t=new Date(t)).toGMTString(),this._setCellValue(e,n,t))},e.getCellEditableState=e=>s.isNodeFromModel(e&&e.nodeModel)&&e.nodeModel.options.grid[T.CONSTANT_SPLIT]==T.CONSTANT_NO),e.getCellGroupingKey=e=>{if(e&&e.nodeModel)return e.nodeModel.options.grid[n]};else if(this.isColumnWithRangeValue(t.uri,t.name))!0===e.editableFlag&&(e.getCellSemantics=this.getRangeCellSemantics.bind(this,t),e.setCellValue=(e,a)=>{const i=a?a.toString():"",r=this.getPossibleValues(t).getRoots().find((e=>e.options&&e.options.label===i)),o=r?r.options.value:i,s=null!=o?o.toString():"";this._setCellValue(e,n,s)},e.getCellEditableState=e=>s.isNodeFromModel(e&&e.nodeModel)&&e.nodeModel.options.grid[T.CONSTANT_SPLIT]==T.CONSTANT_NO),e.getCellValue=e=>{if(!s.isNodeFromModel(e&&e.nodeModel))return;return e.nodeModel.options.grid[n]},e.getCellGroupingKey=e=>{if(e&&e.nodeModel)return e.nodeModel.options.grid[n]};else if("ds6w:responsible"==n)e.typeRepresentation="url",e.hyperlinkTarget="_self",e.getCellValue=e=>{if(!s.isNodeFromModel(e&&e.nodeModel))return;let t=this.options.altAppCore.altSettingsManager.getCurrentUser&&this.options.altAppCore.altSettingsManager.getCurrentUser()&&this.options.altAppCore.altSettingsManager.getCurrentUser().id?this.options.altAppCore.altSettingsManager.getCurrentUser().id:null,a=e.nodeModel.options.grid.owner?e.nodeModel.options.grid.owner:t;return{icon:this.options.altAppCore.altSettingsManager.get3DswymUrl&&this.options.altAppCore.altSettingsManager.get3DswymUrl()&&a?this.options.altAppCore.altSettingsManager.getUserImage(a):"fonticon fonticon-user-alt",label:void 0===e.nodeModel.options.grid[n]?"":e.nodeModel.options.grid[n],url:"#UNEXISTANT_ID"}},e.getCellGroupingKey=e=>{if(e&&e.nodeModel)return e.nodeModel.options.grid[n]};else if("ds6w:reserved"==n)e.typeRepresentation="url",e.getCellValue=e=>{if(!s.isNodeFromModel(e&&e.nodeModel))return;const t=this.options.altAppCore.altSettingsManager.getUserName(),a=e.nodeModel.options.grid[n],i=e.nodeModel.options.grid["ds6w:reservedBy"];return a&&"FALSE"!==a?i==t?N:c:d},e.getCellGroupingKey=e=>{if(e&&e.nodeModel)return e.nodeModel.options.grid[n]},e.getCellClassName=e=>e&&e.nodeModel?"xeng-key xeng-lock":null,e.getCellTooltip=e=>{let t="";if(!(e.rowID<0)){if(void 0!==e.cellModel){const a=e.nodeModel.options.grid[n],i=e.nodeModel.options.grid["ds6w:reservedBy"];t=a&&"FALSE"!==a?A.get("lockedBy").replace("{user}",i).concat(this.options.altAppCore.altSettingsManager.isAuthoringAllowed()?0+A.get("clickToUnlock"):""):A.get("notLocked").concat(this.options.altAppCore.altSettingsManager.isAuthoringAllowed()?"\n"+A.get("clickToLock"):"")}return{shortHelp:t}}};else if(t.kind&&"boolean"===t.kind.toLowerCase()){let a=this.options.altAppCore.altDicoServices.isMultiValuedAttribute(t.uri,t.name)?"string":"boolean";e.typeRepresentation=a,e.getCellTypeRepresentation=e=>this.getCellTypeRepresentation(e,t,n,a),e.getCellValue=e=>{if(!s.isNodeFromModel(e&&e.nodeModel))return;return e.nodeModel.options.grid[n]},e.getCellGroupingKey=e=>{if(e&&e.nodeModel)return e.nodeModel.options.grid[n]},!0===e.editableFlag&&(e.getCellEditableState=e=>s.isNodeFromModel(e&&e.nodeModel)&&e.nodeModel.options.grid[T.CONSTANT_SPLIT]==T.CONSTANT_NO,e.setCellValue=(e,t)=>{null!==t&&this._setCellValue(e,n,t)})}else e.typeRepresentation=t.kind,e.getCellValue=e=>{if(!s.isNodeFromModel(e&&e.nodeModel))return;return e.nodeModel.options.grid[n]},e.getCellGroupingKey=e=>{if(e&&e.nodeModel)return e.nodeModel.options.grid[n]},!0===e.editableFlag&&(e.getCellEditableState=e=>s.isNodeFromModel(e&&e.nodeModel)&&e.nodeModel.options.grid[T.CONSTANT_SPLIT]==T.CONSTANT_NO,e.setCellValue=(e,t)=>{null!==t&&this._setCellValue(e,n,t)});return e},getAddtionalColumnConfiguration:function(e,t,n){e.dataIndex==T.CONST_SPEC_RELATION_COLUMN_DATAINDEX&&t.push({text:A.get(e.dataIndex),dataIndex:e.dataIndex,sortableFlag:!1,groupableFlag:!1,filterableFlag:!1,interchangeabilityColumn:!0,visibleFlag:!1,width:"41px",allowUnsafeHTMLContent:T.CONSTANTS_TRUE,typeRepresentation:"url",getCellValue:function(t){var n="";return t.nodeModel.options.grid[e.dataIndex]>0&&(n={iconName:"doc-log wux-ui-3ds",fontIconFamily:1}),{icon:n,label:"",url:"#UNEXISTANT_ID"}}})},getCellTypeRepresentation:function(e,t,n,a){if(!(t&&n&&e&&e.nodeModel))return a;return Array.isArray(e.nodeModel.options.grid[n])&&e.nodeModel.options.grid[n].length>1?"string":a},isColumnWithRangeValue:function(e,t){let n=this.options.altAppCore.altDicoServices.getRangeValueAttribute(e,t);return!!n&&(!n.type||"boolean"!==n.type)},getRangeCellSemantics:function(e){return{possibleValues:()=>this.getPossibleValues(e)}},getPossibleValues:function(e){const t=this.options.altAppCore.altDicoServices.getRangeValueAttribute(e.uri,e.name).AuthorizedValues,i=new n({}),r=t.sort().map((e=>new a({label:e,value:e})));return i.addRoot(r),i},publishNodesToRefresh:function(e,t){var n=this;if(Array.isArray(t)){let a=[],i=[],r=[];t.forEach((e=>{a.push(e),i.push(e.dataIndex)})),e.forEach((e=>{r.push(e.getInterchangeabilityID())})),n.options.altAppCore.altDataServices.fetchedUpdatedAttrInfo(r,a).then((function(t){t&&n.options.updateCustomAttributeColumn(e,i,t,a)}))}},_setCellValue:function(e,t,n){let a=e.nodeModel,i=this.getAttributeDefinition(t);i={...i};let r=a.getInterchangeabilityID();a.getID();void 0!==i.dbName&&(i.path=i.dbName);let s=[];s.push({attribute:i,referenceid:r,value:n.toString()}),this.options.altAppCore.altDataServices.updateAttributes(s).then((e=>{"success"==e.status&&(this.options.altAppCore.altSettingsManager.setAuthoringMode(T.CONSTANT_AUTHORING_MODE),o.sucessAlert(A.get("eng.alternate.setAlternateReferenceAttrValuesCmd.success.generic")),this.publishNodesToRefresh([a],[i]))})).catch((e=>{console.error(e)}))},getAttributeDefinition:function(e){let t;return this.options.instanciatedViews.AlternateDataGridView.columns.forEach((n=>{n.children&&n.children.forEach((n=>{n.dataIndex!==e||(t=n)})),n.dataIndex!==e||(t=n)})),t},_getDataGridColumns:function(e,t){var n=this,a=[];return e.forEach((function(e){n.getColumnConfiguration(e,a,t)})),a},getSuggestionSourceIcons:function(e){var t={};return t[T.CONSTANT_SUGGESTION_OTHER_USAGE]="fonticon fonticon-graph-linear enox-alternate-suggestion-source",t[T.CONSTANT_SUGGESTION_DUPLICATE]="fonticon fonticon-duplicate enox-alternate-suggestion-source",t[T.CONSTANT_SUGGESTION_BRANCH]="fonticon fonticon-flow-branch enox-alternate-suggestion-source",t[T.CONSTANT_SUGGESTION_BRANCH_FROM]="fonticon fonticon-flow-branch enox-alternate-suggestion-source",t[T.CONSTANT_SUGGESTION_REVISION]="fonticon fonticon-flow-line enox-alternate-suggestion-source",t[T.CONSTANT_SUGGESTION_PREVIOUS_REVISION]="fonticon fonticon-flow-line enox-alternate-suggestion-source",t[T.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE]="fonticon fonticon-exchange enox-alternate-suggestion-source",t[e]},_loadColumnsProviders:function(){var e=this;return e._cachedColProvPromise?e._cachedColProvPromise:l.wrappedWithPromise((function(t,n){if(e.loadedProviders)return t();e._cachedColProvPromise=s.loadFiles(e._getColumnsProvidersDefinitions().map((function(e){return e.loader}))).then((function(){for(var n=arguments[0],a=[],i={},r=0;r<n.length;r++){var o=e._getColumnsProvidersDefinitions()[r],s=n[r];o&&s&&(a.push(e._providerValidateAndRegister(s,o.ID,i)),o.isInternal&&"function"==typeof s.bindApp&&s.bindApp(e.options.altAppCore))}l.allSettled(a).then((function(){e.loadedProviders=[];e._getColumnsProvidersDefinitions().map((e=>e.ID)).forEach((t=>{i[t]&&e.loadedProviders.push({ID:t,instance:i[t]})})),t(!0)}))})).catch((function(e){n(e)}))}))},_providerValidateAndRegister:function(e,t,n){var a=this;return l.wrappedWithPromise((function(i,r){e.isAdditionalColumnsAvailable((function(r){!0===r&&(n[t||e.getName()]=e,"RelationsColumns"===e.getName()&&a.setAndDefineRelationMethods(e)),i()}))}))},setAndDefineRelationMethods:function(e){var t=[T.CONST_SPEC_RELATION_COLUMN_DATAINDEX];e.setPreferenceProxy({setPreference:function(e){self.widget.setValue("enx-relation-pref",e)},getPreference:function(){var e=self.widget.getValue("enx-relation-pref");return"null"===e&&(e=null),e},relationsColumnsList:t}),e.getAdditionalColumnsUX=function(n){t.forEach((function(t){var a=n.findIndex((function(e){return e.dataIndex===t}));a>=0?e.getAdditionalColumnsUXDGV(Array(n[a])):n.splice(a,0,{text:A.get(t),dataIndex:t,maxWidth:800,minWidth:20,width:200})}))}},getAllProvidedColumns:function(){return this._retrieveProvidedColumns().map((function(e){return{dataIndex:e.dataIndex,kind:"string",provider:e.provider,visibleFlag:!1,isAdditionalColumn:!0,customisation:{layout:{removableFromView:!0,groupingLocked:!0,removable:!1}}}}))},_retrieveProvidedColumns:function(){if(Array.isArray(this._cachedAdditionalCols)&&this._cachedAdditionalCols.length>0)return this._cachedAdditionalCols;var e=[];return this.getLoadedColumnProvidersAsArray().forEach((function(t){if(t&&t.instance&&"function"==typeof t.instance.getAdditionalColumnsUX){var n=[];t.instance.getAdditionalColumnsUX(n),e=e.concat(n.map((function(e){return e.provider=t.ID,e})))}})),this._cachedAdditionalCols=e,e},getLoadedColumnProvidersAsArray:function(){var e=this;return this.getLoadedColumnProvidersIDAsArray().map((function(t){return e.getColumnsProviderWithMetas(t)}))},getLoadedColumnProvidersIDAsArray:function(){return Array.isArray(this.loadedProviders)?this.loadedProviders.map((e=>e.ID)):[]},getColumnsProviderWithMetas:function(e){var t=this._getColumnsProvidersDefinitions().find((function(t){return t.ID===e}));if(t&&Array.isArray(this.loadedProviders)){const n=this.loadedProviders.find((t=>t.ID===e));return t.instance=n?n.instance:null,t}return null},_getColumnsProvidersDefinitions:function(){return this.options.altAppCore.altSettingsManager.getConfiguration("columnsProviders")}});return _})),define("DS/ENOXAlternateSubstitute/commands/GetAlternates",["UWA/Class","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXAlternateSubstitute/utils/AlternateDataParser","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n,a,i,r,o){var s,l,T;return e.singleton({getAlternates:function(e,t){return this.appInfo=e,this.primaryItemPhysicalId=t,this.getRelInfo(e),e.isParentMEI=!1,e.altAppCore.altSettingsManager.isUsingDB()?this.getAlternateUsingDBMode(t):this.getAlternateUsingIndexMode(t)},getAlternateUsingDBMode:function(e){var a=this,r=a.getAlternatePayload(e),o=a.appInfo.altAppCore.altSettingsManager.getCommand("get_alternate");return n.wrappedWithCancellablePromise((function(e,n){t.perform(o,r).then((function(n){o=a.appInfo.altAppCore.altSettingsManager.getCommand("get_PrimaryItemInfo"),t.perform(o,r).then((function(t){a.checkIfParentOrPrimaryItemIsMEI(t);var i=a.splitInstanceApplicability(n.AlternateItemInfo),r=a.splitUsage(i);return a.isSelectedPrimaryItemLogicallyIdentical(t.AlternateItemInfo),e(r)})).catch((function(t){console.error(t);var n=t.response&&t.response.message?t.response.message:t;return i.errorAlert(n),e({})}))})).catch((function(t){console.error(t);var n=t.response&&t.response.message?t.response.message:t;return i.errorAlert(n),e({})}))}))},getAlternateUsingIndexMode:function(e,i){var o=this,s=o.getAlternatePayload(e),A=o.appInfo.altAppCore.altSettingsManager.getCommand("get_PrimaryItemInfo");return n.wrappedWithCancellablePromise((function(n,d){t.perform(A,s).then((function(s){o.checkIfParentOrPrimaryItemIsMEI(s);var d=s.AlternateItemInfo;A=o.appInfo.altAppCore.altSettingsManager.getCommand("get_AlternateReference");var N=i||d[r.CONSTANT_USER_SELECTED_PRIMARY_ITEM_PHYSICALID_LIST];o.getIndexAlternatePayload(N).then((s=>{l=d[r.CONSTANT_CARRYOVER_ALTERNATE],T=d[r.CONSTANT_CARRYOVER_SUBSTITUTE],t.perform(A,s).then((function(t){var r=o.getReferenceIdForIndexData(t);if(!(r.length>0))return n([]);a.doExpand(o.appInfo.altAppCore.altDataServices.getCVServletPayload(r,o.appInfo),{executor:"cv_expand_v2"},o.appInfo).then((e=>{var t=o.parsedataforGridView(o.appInfo.parentNode&&o.appInfo.currentNodeId==o.appInfo.parentNode.getID(),d,a.parsedExpandV2Result(e,[]),o.appInfo,i),r=o.splitUsage(t);return o.isSelectedPrimaryItemLogicallyIdentical(d),n(r)})).catch((function(t){return n(o.getErrorResponseOfIndexMode(t,e,i))}))})).catch((function(t){return n(o.getErrorResponseOfIndexMode(t,e,i))}))})).catch((function(t){return n(o.getErrorResponseOfIndexMode(t,e,i))}))})).catch((function(t){return n(o.getErrorResponseOfIndexMode(t,e,i))}))}))},getErrorResponseOfIndexMode:function(e,t,n){return n?e:this.getAlternateUsingDBMode(t)},getReferenceIdForIndexData:function(e){var t=[];return this.primaryIds={},e.result.forEach(((e,n)=>{var a=e.outputs[r.CONSTANT_ALT_REF];if(a)for(n=0;n<a.length;n++)t.push(a[n][r.PHYSICAL_ID]),this.primaryIds[a[n][r.PHYSICAL_ID]]=a[n][r.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID]})),t},getIcons:function(e,t){for(var n=0;n<e.length;n++)if(-1!=e[n].did.indexOf(t.toString()))return e[n][r.CONSTANTS_ICON];return appInfo.altAppCore.altSettingsManager.getDefaultProductIcon()},getThumbnail:function(e,t){for(var n=0;n<e.length;n++)if(-1!=e[n].did.indexOf(t.toString()))return e[n].thumbnail_2d;return appInfo.altAppCore.altSettingsManager.getDefaultProductThumbnail()},getRelInfo:function(e){var t=e.selectedNode;s={};for(var n=[],a=0;a<t.length;a++)if(t[a].getRelationID){var i=e.selectedNode[a].getRelationID();n.push(i),s[i]=e.selectedNode[a].getInstanceName()}s[r.CONSTANT_SELECTED_INSTANCE_INFO]=n},parsedataforGridView:function(e,t,n,a,i){for(var o=[],s={},l=(n.nodes,0);l<n.paths.length;l++){var T=n.paths[l];if(T.length>1){var A=n.nodes[T[0]],d=T[1],N=n.nodes[T[2]];if(s[T[2]]=N,s[T[2]].Path=n.nodes[d],s[T[2]][r.CONSTANTS_ICON]=this.getIcons(n.iconsSet,T[2]),s[T[2]][r.CONSTANTS_THUMNAIL]=N[r.CONSTANTS_THUMNAIL]?N[r.CONSTANTS_THUMNAIL]:this.getThumbnail(n.iconsSet,T[2]),(e||null==e||null==e)&&s[T[2]].Path[r.Element_1_PhysicalId])continue;o.push(this.createAlternateResponse(t,s[T[2]],A,a,i))}}return o},createAlternateResponse:function(e,t,n,a,i){var o={},s=this.isApplicable(e,t,a);return o[r.CONSTANT_DATAGRID_COLUMN_TITLE]=t[r.DS6W_LABEL],o[r.CONSTANT_REVISION]=t[r.DS6W_REVISION],o[r.CONSTANT_PARTNUMBER]=t[r.DS6W_PARTNUMBER],o[r.CONSTANT_SYMMETRIC]=r.SYMETRIC_NO,o[r.CONSTANT_APPLICABILTY]=s[r.CONSTANT_APPLICABILTY],o[r.CONSTANT_SPLIT]=i?r.SPLIT_NO:s[r.CONSTANT_SPLIT],o[r.CONSTANT_ALT_ID]=t[r.PHYSICAL_ID],o[r.CONSTANT_DATAGRID_MATURITY_STATE]=t[r.CONSTANT_CURRENT],o[r.CONSTANT_ROWUID]=t.Path[r.PHYSICAL_ID],o[r.CONSTANTS_ICON]=t[r.CONSTANTS_ICON],o[r.CONSTANTS_THUMNAIL]=t[r.CONSTANTS_THUMNAIL_2D]?t[r.CONSTANTS_THUMNAIL_2D]:t[r.CONSTANTS_THUMNAIL],o[r.CONSTANT_WORK_UNDER_CHANGE_ID]=n[r.CONSTANT_CHANGE_ID],o[r.CONSTANT_STATUS]=s[r.CONSTANT_SPLIT]!=r.SPLIT_YES||i?n[r.CONSTANT_CURRENT]:r.CONSTANT_NOT_APPLICABLE,o[r.CONSTANT_ALT_REF_PHYSICALID]=n[r.PHYSICAL_ID],o[r.CONSTANT_ALT_REF_TITLE]=n[r.DS6W_LABEL],o[r.CONSTANT_ALT_REF_REVISION]=n[r.CONSTANT_DS_REVISION],o[r.CONSTANT_INTERCHANGEABILITY_TYPE]=n[r.CONSTANT_DS_TYPE],o[r.CONSTANT_ALT_REF_OWNER]=n[r.CONSTANT_ALT_REF_OWNER],this.updateNodeWithCustAttrValue(o,n),o[r.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID]=this.primaryIds[n[r.PHYSICAL_ID]],this.updateNodeWithContextInformation(e,t,o),o},updateNodeWithCustAttrValue:function(e,t){let n=this,a=this.appInfo.altOptions.altAppCore.altDicoServices.additionalColumnsAndBOs.additionalColumns?this.appInfo.altOptions.altAppCore.altDicoServices.additionalColumnsAndBOs.additionalColumns:[],i=this.appInfo.altOptions.altAppCore.altDicoServices.additionalColumnsAndBOs.additionalBOs?this.appInfo.altOptions.altAppCore.altDicoServices.additionalColumnsAndBOs.additionalBOs:[],r={};a.forEach((e=>{r[e.dataIndex]=e.name})),i.forEach((t=>{e[t]=""})),Object.keys(t).forEach((a=>{if(a.includes("ds6w")){let i=t[a],o=r[a];if(o){let e=n.appInfo.altAppCore.altDicoServices.isMultiValuedAttribute(a,o),t=n.appInfo.altAppCore.altDicoServices.isPredicateAttribute(a,o);(e||t)&&(i=i.split(","))}e[a]=i}}))},updateNodeWithContextInformation:function(e,t,n){var a=this,i=t.Path[r.Element_1_PhysicalId],o=t.Path[r.Element_2_PhysicalId],s=(e[r.UserSelectedContextRevisionInformation]&&e[r.UserSelectedContextRevisionInformation][i]&&JSON.parse(e[r.UserSelectedContextRevisionInformation][i]),n[r.CONSTANT_APPLICABILTY]&&a.primaryItemPhysicalId!=appInfo.options.activeEngItemTreeInfo._selectedNodeId),A=n[r.CONSTANT_APPLICABILTY]&&i!=appInfo.options.activeEngItemTreeInfo._parentId;if(i&&o)n[r.OPERATION]=r.Operation_InstanceSubstitute,n[r.CONSTANT_CARRYOVER_SUBSTITUTE]=A?T:null;else{if(!i)return n[r.OPERATION]=r.Operation_Alternate,n[r.CONSTANT_CARRYOVER_ALTERNATE]=s?l:null,n;n[r.OPERATION]=r.Operation_ReferenceSubstitute,n[r.CONSTANT_CARRYOVER_SUBSTITUTE]=A?T:null}return n[r.CONTEXT_SCOPE]=t.Path[r.CONTEXT_SCOPE],n[r.CONSTANT_PARENT_CONTEXT_PHYSICALID]=t.Path[r.Element_1_PhysicalId],n[r.CONSTANT_PARENT_CONTEXT_LOGICALID]=t.Path[r.Element_1_LogicalId],n[r.CONSTANT_INSTANCE_CONTEXT_PHYSICALID]=t.Path[r.Element_2_PhysicalId],n[r.CONSTANT_INSTANCE_CONTEXT_LOGICALID]=t.Path[r.Element_2_LogicalId],n[r.CONSTANT_INSTANCE_CONTEXT_TITLE]=a.getInstanceContextTitle(o),i&&a.getApplicableParentObjectTitleAndRevision(n,i),t.Path[r.Element_2_type]==r.Constant_Products&&(n[r.CONSTANT_CONFIG_CONTEXT_PHYSICALID]=t.Path[r.Element_2_PhysicalId]),t.Path[r.Element_3_type]==r.Constant_Products&&(n[r.CONSTANT_CONFIG_CONTEXT_PHYSICALID]=t.Path[r.Element_3_PhysicalId]),n},getInstanceContextTitle(e){var t=appInfo.options.activeEngItemTreeInfo._selectedNodes;if(e)for(var n of t)if(n.getRelationID&&n.getRelationID()==e)return n.getInstanceName();return""},splitUsage(e){var t={};for(var n in e)e[n][r.CONSTANT_STATUS]==r.CONSTANT_NOT_APPLICABLE&&(t[e[n][r.CONSTANT_ALT_ID]]?t[e[n][r.CONSTANT_ALT_ID]].push(e[n][r.CONSTANT_ALT_REF_PHYSICALID]):t[e[n][r.CONSTANT_ALT_ID]]=[e[n][r.CONSTANT_ALT_REF_PHYSICALID]],e[n][r.CONSTANT_OTHER_CONTEXT_APPLICABLE_ALTERNATE_REF_PHYSICALD]=t[e[n][r.CONSTANT_ALT_ID]]);return e},isSelectedPrimaryItemLogicallyIdentical(e){var t=!1;for(var n of e[r.CONSTANT_USER_SELECTED_INSTANCE_LOGICAL_ID_LIST])if(e[r.CONSTANT_USER_SELECTED_INSTANCE_LOGICAL_ID_LIST][0]!=n){t=!0;break}widget.setValue(r.CONSTANT_SELECTED_PRIMARY_ITEM_DIFFERENT_LOGICALID,!t)},getApplicableParentObjectTitleAndRevision:function(e,t){return e[r.CONSTANT_PARENT_CONTEXT_TITLE]=t?appInfo.options.activeEngItemTreeInfo._parentNode.getLabel():"",e[r.CONSTANT_PARENT_CONTEXT_REVISION]=t?appInfo.options.activeEngItemTreeInfo._parentNode.getReferenceVersion():"",e},isApplicable:function(e,t,n){s[r.CONSTANT_SELECTED_INSTANCE_INFO];var a=t.Path[r.Element_1_PhysicalId],i=null,o={};if(o[r.CONSTANT_APPLICABILTY]=r.APPLICABILITY_NO,o[r.CONSTANT_SPLIT]=r.SPLIT_NO,null==a||null==a)return o[r.CONSTANT_APPLICABILTY]=r.APPLICABILITY_YES,o;if(t.Path[r.Element_2_type]==r.Constant_VPMInstance)var l=t.Path[r.Element_2_LogicalId];t.Path[r.Element_2_type]==r.Constant_Products&&(i=t.Path[r.Element_2_PhysicalId]),t.Path[r.Element_3_LogicalId]&&(i=t.Path[r.Element_3_PhysicalId]);var T=n.options.activeEngItemTreeInfo._configModelVersionID;return n.options.viewInfo._isReferenceView&&l||(null==i||i==T)&&((null==l||null==l||e[r.CONSTANT_USER_SELECTED_INSTANCE_LOGICAL_ID_LIST].includes(l))&&(isApplicable=e[r.CONSTANT_USER_SELECTED_CONTEXT_REVISION_PHYSICAL_ID_LIST].includes(a),e[r.USER_SELECTED_CONTEXT_CONFIGURED_PRODUCT]&&t.Path&&t.Path.Element_2_PhysicalId&&(isApplicable=s.selectedRelIds.includes(t.Path.Element_2_PhysicalId)),o[r.CONSTANT_APPLICABILTY]=isApplicable?r.APPLICABILITY_YES:r.APPLICABILITY_NO),e[r.CONSTANT_USER_SELECTED_INSTANCE_LOGICAL_ID_LIST].includes(l)&&e[r.CONSTANT_USER_SELECTED_CONTEXT_REVISION_PHYSICAL_ID_LIST].includes(a)&&e[r.USER_SELECTED_CONTEXT_CONFIGURED_PRODUCT]&&!s.selectedRelIds.includes(t.Path.Element_2_PhysicalId)&&(o[r.CONSTANT_SPLIT]=r.SPLIT_YES)),o},splitInstanceApplicability(e){for(var t=0;t<e.length;t++)e[t][r.CONSTANT_APPLICABILTY]==r.APPLICABILITY_NO&&(e[t][r.CONSTANT_STATUS]=e[t][r.CONSTANT_SPLIT]==r.SPLIT_YES?r.CONSTANT_NOT_APPLICABLE:e[t][r.CONSTANT_STATUS]);return e},getIndexAlternatePayload:async function(e){var t=this;appInfo=t.appInfo;var n=appInfo.altAppCore.altDicoServices.interchangeabilityTypes.length?appInfo.altAppCore.altDicoServices.interchangeabilityTypes:await appInfo.altAppCore.altDicoServices.getTypesForClass(),a=t.appInfo.altAppCore.altSettingsManager.getConfiguration("getIndexModePayloadAttributes");return{input_physical_ids:e,primitives:[{navigate_from_rel:{id:1,filter:{rel_type:[r.CONSTANT_REL_ALTERNATE_OF]}}}],patterns:{ALT_REF:[{id:1}]},patternTypeFilters:{ALT_REF:{typesToReturn:n}},fileAttributes:[],attributes:a,flags:["returnMatches"],version:3,label:t.appInfo.altAppCore.altSettingsManager.getCVRequestLabel()}},getAlternatePayload:function(e){appInfo=this.appInfo;let t=appInfo.altAppCore.altDataServices.shouldShowInstanceAlternates(appInfo.selectedNode[0]);var n={};if(appInfo.options.viewInfo._isReferenceView||!t){var a=appInfo&&appInfo.parentNode&&appInfo.parentNode.getID?appInfo.parentNode.getID():"";n={[r.CONSTANT_REF_ID]:e,[r.CONSTANT_REFERENCE_PHYSICAL_ID]:a}}else{appInfo.selectedNode&&appInfo.selectedNode[0]&&appInfo.selectedNode[0].getRelationID&&appInfo.selectedNode[0].getRelationID();n={[r.CONSTANT_REF_ID]:e,[r.CONSTANT_CTX_ITEM_ID]:s[r.CONSTANT_SELECTED_INSTANCE_INFO],[r.CONSTANT_INCLUDE_OTHER_CONTEXTS]:!0}}return appInfo.options&&appInfo.options.activeEngItemTreeInfo&&null!=appInfo.options.activeEngItemTreeInfo._configModelVersionID&&(n[r.KEY_CONSTANT_MODEL_ID]=appInfo.options.activeEngItemTreeInfo._configModelVersionID),n},checkIfParentOrPrimaryItemIsMEI:function(e){if(e.AlternateItemInfo.UserSelectedMEIItems.length){if(e.AlternateItemInfo.UserSelectedMEIItems.includes(appInfo.selectedNode[0].getID()))return i.warningAlert(o.get("eng.alternate.selected.product.mei")),appInfo.notApplicable("notSupported"),[];e.AlternateItemInfo.UserSelectedMEIItems.includes(appInfo.parentNode.getID())&&(appInfo.isParentMEI=!0)}}})})),define("DS/ENOXAlternateSubstitute/utils/AlternateCommands",["UWA/Class","DS/Menu/Menu","DS/UIKIT/Iconbar","DS/CoreEvents/ModelEvents","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXAlternateSubstitute/views/AlternateGridViewManager","DS/ENOXAlternateSubstitute/commands/GetAlternates","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXEngineerCommonUtils/XENMask","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/utils/AlternateUtils","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n,a,i,r,o,s,l,T,A,d,N,c){"use strict";var _;return e.singleton({init:function(e){this._parent(e)},initialize:function(e){this.altOptions=e.altOptions,this.options=e.options,this.altOptions.alternateEnableDisableCommandEvents=new a,this.altOptions.customStringDefault=[]},showMenu:function(e,n){if(!e||!Array.isArray(n))throw new Error("unable to build the menu");t.show(n,{position:{x:e.left,y:e.bottom},submenu:"outside"})},buildIconSpan:function(e,t){return"<i class='fonticon fonticon-"+e+" "+t+"'></i>"},getDisplayApproveMessageName:function(e,t){var n=this.getDisplayMessageName(t);return"<p>"+this.buildIconSpan(i.CONSTANT_ICON_QUALIFIED,i.CONSTANT_ICON_QUALIFIED_CLASS)+e.replace("$1",n)+"</p><b><p>"+c.get("eng.alternate.approve.conformation.message1")+"</b><br><i>&ensp;"+c.get("eng.alternate.approve.conformation.message2")+"<br>&ensp;"+c.get("eng.alternate.approve.conformation.message3")+"</i></p>"},getDisplayRemoveMessageName:function(e,t){var n=this.buildIconSpan(i.CONSTANT_ICON_WARNING,i.CONSTANT_ICON_WARNING_CLASS),a=this.getDisplayMessageName(t);return"<p>"+n+e.replace("$1",a)+"</p>"},getDisplayObsoleteMessageName:function(e,t){var n=this.buildIconSpan(i.CONSTANT_ICON_OBSOLETE,i.CONSTANT_ICON_OBSOLETE_CLASS),a=this.getDisplayMessageName(t);return"<p>"+n+e.replace("$1",a)+"</p>"},getDisplayMessageName:function(e){var t=c.get("eng.alternate.confirmation.dialog.allSelected.msg");return 1==e.length&&(t=e[0].getDisplayName()),UWA.String.escapeHTML(t)},getToolbarCmds:function(e){var t=this,n=!0;t.altOptions.alternateCollectionToolBarModelEvents.subscribe({event:i.HIDE_SHOW_MAKE_APPLICABLE_CMD},(function(e){n=e}));var a=[];return a.push({id:i.CONSTANT_ALTERNATE_TOOLBAR_MULTISELECT_CMD,text:c.get("eng.alternate.multi.select"),fonticon:"select-off",className:"enox-alternate-toolbar-multiselect-icon",disabled:!1,readOnlyFacetVisibilty:!1,handler:function(e){t.showMenu(e.target.getBoundingClientRect(),t.getMultiSelMenu(n))}}),a.push({id:i.CONSTANT_ALTERNATE_TOOLBAR_ADD_CMD,text:c.get("eng.alternate.add"),fonticon:"plus",disabled:!1,readOnlyFacetVisibilty:!1,handler:function(t){e()}}),t.altOptions.getEnforcedChange()||a.push({id:i.CONSTANT_ALTERNATE_TOOLBAR_APPROVE_CMD,text:c.get("eng.alternate.approve"),fonticon:"check",disabled:!0,readOnlyFacetVisibilty:!1,className:"enox-alternate-toolbar-item-disable",handler:function(e){t.approveConfirmPopup()}}),a.push({id:i.CONSTANT_ALTERNATE_TOOLBAR_REMOVE_CMD,text:c.get("eng.alternate.remove"),fonticon:"fonticon fonticon-remove",disabled:!0,readOnlyFacetVisibilty:!1,className:"enox-alternate-toolbar-item-disable",handler:function(e){t.removeConfirmPopup()}}),a.push({id:i.CONSTANT_ALTERNATE_TOOLBAR_MAKE_APPLICABLE_CMD,text:c.get("eng.alternate.applicable"),fonticon:"checkbox-on",disabled:!0,readOnlyFacetVisibilty:!1,className:"enox-alternate-toolbar-item-disable ",handler:function(e){t.makeApplicable()}}),a.push({id:i.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD,text:c.get("eng.alternate.carryOver.command"),fonticon:"fonticon fonticon-flow-cascade-search",disabled:!1,readOnlyFacetVisibilty:!1,handler:function(e){t.altOptions.CarryOver.renderAlternatesDialog()}}),a.push({id:i.CONSTANT_ALTERNATE_TOOLBAR_CUSTOMIZE_TABLE_CMD,text:c.get("eng.alternate.customize.table"),fonticon:"fonticon fonticon-cog",disabled:!1,readOnlyFacetVisibilty:!0,handler:function(e){t.launchCustomViewManager()}}),a},getFilterMenu:function(e){return new n({renderTo:e,items:[{name:c.get("eng.alternate.filter"),fonticon:"list-filter",text:c.get("eng.alternate.filter"),handler:function(e){}}]})},removeConfirmPopup:function(){var e=this,t=e.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes();if(t.length>0&&e.altOptions.checkValidAlternates(t,c.get("eng.alternate.only.proposed.objects.removed"),[i.CONSTANT_PROPOSED],i.CONSTANT_REMOVE)){var n=e.getDisplayRemoveMessageName(c.get("eng.alternate.remove.confirmation.dialog.msg"),t),a=c.get("eng.alternate.remove.confirmation.dialog.title"),r=c.get("eng.alternate.remove.confirmation.dialog.confirm");e.altOptions.confirmToProceedDialog(a,n,i.CONSTANT_REMOVE,r)}},approveConfirmPopup:function(){var e=this,t=e.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes();if(t.length>0&&e.altOptions.checkValidAlternates(t,c.get("eng.alternate.only.proposed.objects.qualified"),[i.CONSTANT_PROPOSED,i.CONSTANT_FROZEN],i.CONSTANT_APPROVE)){var n=e.getDisplayApproveMessageName(c.get("eng.alternate.approve.confirmation.dialog.msg"),t),a=c.get("eng.alternate.qualify.confirmation.dialog.title"),r=c.get("eng.alternate.qualify.confirmation.dialog.confirm");e.altOptions.confirmToProceedDialog(a,n,i.CONSTANT_APPROVE,r)}},makeApplicable:function(){var e=this,t=[],n=[],a=e.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes();_=e.options.activeEngItemTreeInfo._selectedNodes;e.options.activeEngItemTreeInfo._configModelVersionID;for(var r=0;r<_.length;r++)t.push(_[r].getRelationID&&_[r].getRelationID());for(var o in a)n.push(N.mapSelectedAlternate(a[o].options));var s=e.altOptions.altAppCore&&e.altOptions.altAppCore.altSettingsManager&&e.altOptions.altAppCore.altSettingsManager.isCloud()?i.SUPPORTED_ALTERNATE_COUNT_ONCLOUD:i.SUPPORTED_ALTERNATE_COUNT_ONPREMISE;if(n&&n.length>s){var l=c.get("eng.alternate.make.applicable.maxcount.errormsg").replace("$1",s);d.errorAlert(l)}else require(["DS/ENOXAlternateSubstitute/commands/AddAlternate"],(function(e){e.addAlternateDataService(_[0],t,null,n).then((function(t){t.hasOwnProperty(i.ERROR)?d.errorAlert(t.response.message):t.status==i.SUCCESS&&e.addAlternateSuccessUXModification(c.get("eng.alternate.applicable.success.message"),t)}))}))},renderDropdownItems:function(e,t){for(var n=[],a=0;a<e.length;a++)n.push({id:e[a].id,text:c.get(e[a].title),tooltip:c.get(e[a].title),name:e[a].name,fonticon:e[a].fonticon?e[a].fonticon:"",selected:e[a].selected,className:"enox-filter-view",selectable:!0,items:e[a].items?this.renderDropdownItems(e[a].items):null}),e[a].selected&&(t[e[a].name]={filterId:"stringRole",filterModel:{allowedRoles:t[e[a].name]?t[e[a].name].filterModel.allowedRoles.push(e[a].id)&&t[e[a].name].filterModel.allowedRoles:[e[a].id]}});return n},getMultiSelMenu:function(e){var t=this,n=[];return n.push({title:c.get("eng.alternate.multi.select.all"),type:"PushItem",action:{this:t,context:!0,callback:t.updateNodeSelection.bind(this)}}),n.push({title:c.get("eng.alternate.multi.select.proposed"),type:"PushItem",action:{this:t,context:i.CONSTANT_PROPOSED,callback:t.updateNodeSelection.bind(this)}}),n.push({title:c.get("eng.alternate.multi.select.frozen"),type:"PushItem",action:{this:t,context:i.CONSTANT_FROZEN,callback:t.updateNodeSelection.bind(this)}}),n.push({title:c.get("eng.alternate.multi.select.qualified"),type:"PushItem",action:{this:t,context:i.CONSTANT_QUALIFIED,callback:t.updateNodeSelection.bind(this)}}),n.push({title:c.get("eng.alternate.multi.select.obsolete"),type:"PushItem",action:{this:t,context:i.CONSTANT_OBSOLETE,callback:t.updateNodeSelection.bind(this)}}),e&&n.push({title:c.get("eng.alternate.multi.select.not.applicable"),type:"PushItem",action:{this:t,context:i.CONSTANT_NOT_APPLICABLE,callback:t.updateNodeSelection.bind(this)}}),n.push({title:c.get("eng.alternate.multi.select.none"),type:"PushItem",action:{this:t,context:!1,callback:t.updateNodeSelection.bind(this)}}),n},updateNodeSelection:function(e){var t=this,n=[];t.altOptions._addAlternateUX.ALTERNATE.model._getTrueRoot().getTreeDocument().unselectAll(),t.altOptions._addAlternateUX.ALTERNATE.model.processDescendants({onlyVisibleNodes:!0,processNode:function(t){let a=t.nodeModel,r=a.getAllDescendants();if((a.options.grid[i.CONSTANT_STATUS]==e.context||1==e.context)&&n.push(a),r.length)for(var o of r)(o.options.grid[i.CONSTANT_STATUS]==e.context||1==e.context)&&n.push(o)}}),n.forEach((function(e){e.select()})),t.altOptions.alternateEnableDisableCommandEvents.publish({event:i.MULTI_SELECT_ENABLE_DISABLE_MAKE_APPLICABLE_CMD})},buildToolbarForSuggestions:function(e){var t=this,a=t.altOptions.options.activeEngItemTreeInfo._selectedNodes[0],r=a.options.grid[i.CONSTANT_DS_LABEL],o=a.options.grid[i.CONSTANT_DS_REVISION];return t.altSuggestionGroupBy=null,new n({renderTo:e.container,items:[{name:i.CONSTANT_SUGGESTION_FIND,fonticon:"fonticon fonticon-find",text:c.get("eng.alternate.suggestion.find"),handler:function(t){e.findCB()}},{name:i.CONSTANT_SUGGESTION_SETTINGS,fonticon:"fonticon fonticon-cog",text:c.get("eng.alternate.suggestion.settings"),handler:function(t){e.settingsCB()}},{name:i.CONSTANT_SUGGESTION_REVISION_EXPLORER,fonticon:"fonticon fonticon-flow-branch-list",text:c.get("eng.alternate.suggestion.toolBar.revision")+r+" "+o,handler:function(e){widget.appMediator.publish(i.EVENT_LAUNCH_COMMAND,{commandId:i.SHOW_HISTORY_CMD,context:{item:a}})}},{name:i.CONSTANT_SUGGESTION_CHANGE_USAGE,fonticon:"fonticon fonticon-pencil",text:c.get("eng.alternate.suggestion.change.usage"),handler:function(n){t.showMenu(n.target.getBoundingClientRect(),t.getChangeUsageMenu(e.model))}},{name:i.CONSTANT_ALTERNATE_TOOLBAR_GROUP_BY,text:c.get("eng.alternate.groupBy"),fonticon:"fonticon fonticon-group",handler:function(n){t.showMenu(n.target.getBoundingClientRect(),t.getSuggestionGroupByMenu(e.model))}}]})},getChangeUsageMenu:function(e){var t=this,n=[],a={usage:i.CONSTANT_SELECT_USAGE_ALL,model:e};n.push({title:c.get("eng.alternate.select.usage.all"),type:"RadioItem",action:{this:t,context:a,callback:t.massUpdateUsageSelection}});var r={usage:i.CONSTANT_SELECT_USAGE_REFERENCE,model:e};n.push({title:c.get("eng.alternate.select.usage.reference"),type:"RadioItem",action:{this:t,context:r,callback:t.massUpdateUsageSelection}});var o={usage:i.CONSTANT_SELECT_USAGE_INSTANCE,model:e};return n.push({title:c.get("eng.alternate.select.usage.instance"),type:"RadioItem",action:{this:t,context:o,callback:t.massUpdateUsageSelection}}),n},massUpdateUsageSelection:function(e){var t=this,n=e.context.model;n.getSelectedNodes().length>0&&""!=e.context.usage&&n.getSelectedNodes().forEach(((a,r)=>{a._isFromOriginalModel()&&(a.options.grid[i.CONSTANT_SUGGESTION_SELECT_USAGE]=e.context.usage,t.updateNodeInfo(a,n))}))},updateNodeInfo:function(e,t){var n=e&&e._getRowID&&e._getRowID(),a=e&&e._parentNode;if(a&&!a._isFromOriginalModel()){var i=n-a._getRowID();a.addChild(e,i-1),a.expand()}else t.addChild(e,n);e.select()},getSuggestionGroupByMenu:function(e){for(var t=[],n=this,a=n.altSuggestionGroupBy?n.altSuggestionGroupBy:"None",r=n.altOptions.altAppCore.altSettingsManager.getCommand(i.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[i.CONSTANT_ALTERNATE_SUGGESTIONS_GROUPBY_OPTIONS],o=0;o<r.length;o++){var s={option:i[r[o].context],model:e};t.push({title:c.get(r[o].title),type:r[o].type,state:a==s.option?"selected":"unselected",action:{this:n,context:s,callback:n.groupSuggestions}})}return t},groupSuggestions:function(e){"None"===e.context.option?e.context.model.ungroupRoots():(e.context.model.ungroupRoots(),e.context.model.groupRoots({propertiesToGroup:[e.context.option]})),this.altSuggestionGroupBy=e.context.option},moveToCmdHandler:function(){var e=this.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes(),t=[];e.forEach(((e,n)=>{let a=Object.assign(Object.create(Object.getPrototypeOf(e)),e);a.getID=function(){return a.getInterchangeabilityID()},a.getLabel=function(){return a.getInterchangeabilityTitle()},t.push(a)})),widget.appMediator.publish(i.EVENT_LAUNCH_COMMAND,{commandId:i.CHANGE_OWNER_CMD,context:{item:t}})},lockCmdHandler:function(){var e=this.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes(),t=[];e.forEach(((e,n)=>{let a=Object.assign(Object.create(Object.getPrototypeOf(e)),e);a.getID=function(){return a.getInterchangeabilityID()},a.getLabel=function(){return a.getInterchangeabilityTitle()},t.push(a)}));let n=null;n=e[0].options.grid[i.DS6W_RESERVED]&&"FALSE"!==e[0].options.grid[i.DS6W_RESERVED]?"UnreserveHdr":"ReserveHdr",widget.appMediator.publish(i.EVENT_LAUNCH_COMMAND,{commandId:n,context:{item:t}})},lifecycleCmdHandler:function(){var e=this.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes(),t=[];e.forEach(((e,n)=>{let a=Object.assign(Object.create(Object.getPrototypeOf(e)),e),r=a.options.grid[i.CONSTANT_ALT_REF_REVISION],o=a.options.grid[i.CONSTANT_INTERCHANGEABILITY_TYPE],s=a.options.grid[i.CONSTANT_ALT_REF_TITLE];a.object={name:s,revision:r,type:o},a.getID=function(){return a.getInterchangeabilityID()},a.getLabel=function(){return a.getInterchangeabilityTitle()},t.push(a)})),widget.appMediator.publish(i.EVENT_LAUNCH_COMMAND,{commandId:i.MATURITY_GRAPH_CMD,context:{item:t}})},launchCustomViewManager:async function(){l.mask(this.altOptions.elements.container),await this.altOptions.altAppCore.altDicoServices.updateColumnDefinition(),this.altOptions.alternateGridView.dsModel._contextualMenuBuilder._collectionView.showCustomViewsDialog(),l.unmask(this.altOptions.elements.container)}})})),define("DS/ENOXAlternateSubstitute/services/AlternateSubstituteServices",["UWA/Class","UWA/Core","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXEngineerCommonUtils/XENCommonConstants","require","text!DS/ENOXAlternateSubstitute/assets/config/AlternateManagement.conf.json","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n,a,i,r,o,s,l,T,A){"use strict";var d,N;return e.singleton({initialize:function(e){this.altAppCore=e,this.getNlsOfPropertiesValues(e.altSettingsManager.getConfiguration("nlsPropValue")),this.temporaryLoadEmptyView()},temporaryLoadEmptyView:function(e){return N?new N(e):n.wrappedWithPromise((function(e,t){l(["DS/ENOXEmptyContent/js/ENOXEmptyContent"],(function(t){N=t,e(!0)}),(function(e){t(e)}))}))},getRelatedItemsUsingVersionGraphServices:function(e){var t=this.altAppCore.altSettingsManager.getCommand("fetchRelatedItemIdsFromVersionGraph"),i=Object.assign({},t);return i.url=i.url+"?withThumbnail=1&withIsLastVersion=1&withAttributes=1&withCopyFrom=1",n.wrappedWithCancellablePromise((function(t,n){a.perform(i,e).then((function(e){return i=null,t(e)})).catch((function(e){t(e)}))}))},addAlternateItems:function(e){var t=this.altAppCore.altSettingsManager.getCommand("add_alternate"),i=Object.assign({},t);return i.url=i.url,n.wrappedWithCancellablePromise((function(t,n){a.perform(i,e).then((function(e){return i=null,t(e)})).catch((function(e){t(e)}))}))},addAlternteFromSuggestedItems:function(e,t,i){var r=this.altAppCore.altSettingsManager.getCommand("add_alternate");r.url=r.url;var s={[o.CONSTANT_REF_ID]:t.getID(),[o.CONSTANT_USER_SELECTED_INSTANCE_ID]:this.getInstanceId(t,i),[o.CONSTANT_ALT_INFO]:e};return n.wrappedWithCancellablePromise((function(e,t){a.perform(r,s).then((function(t){return e(t)})).catch((function(t){e(t)}))}))},removeAlternateItems:function(e){var t=this.altAppCore.altSettingsManager.getCommand("remove_alternate");t.url=t.url;var i=e._addAlternateUX.ALTERNATE.model.getSelectedNodes(),r=e.options.activeEngItemTreeInfo._selectedNodeId,s=this.getPayload(r,i,[o.CONSTANT_PROPOSED]);return n.wrappedWithCancellablePromise((function(e,n){a.perform(t,s).then((function(t){return e(t)})).catch((function(t){e(t)}))}))},approveAlternateItems:function(e){var t=this.altAppCore.altSettingsManager.getCommand("approve_alternate");t.url=t.url;var i=e._addAlternateUX.ALTERNATE.model.getSelectedNodes(),r=this.getPayload(e.currentNodeId,i,[o.CONSTANT_PROPOSED,o.CONSTANT_FROZEN]);return n.wrappedWithCancellablePromise((function(e,n){a.perform(t,r).then((function(t){return e(t)})).catch((function(t){e(t)}))}))},addAlternatePartToEngItem:function(e,t,a,r,o){var s=this;return n.wrappedWithPromise((function(n,l){s.fetchEngItem(e,t,a,r,o).then((function(e){n(e)})).catch((function(e){i.errorAlert(e.error||JSON.stringify(e)),n(e)}))}))},proposeAlternatePartToEngItem:function(e,t,i,r,s){var l=this.altAppCore.altSettingsManager.getCommand("modifyProposedFor"),T={[o.CONSTANT_REF_ID]:e.getID(),[o.CONSTANT_PROPOSE_FOR]:s,[o.CONSTANT_ALT_INFO]:this.createJSONForProposeFor(r,t,i)},A=Object.assign({},l);return A.url=A.url,n.wrappedWithCancellablePromise((function(e,t){a.perform(A,T).then((function(t){return A=null,e(t)})).catch((function(t){e(t)}))}))},fetchEngItem:function(e,t,a,i,r){var o=this,s=this.getPayloadForAdd(e,t,a,i,r);return n.wrappedWithPromise((function(e,t){e(o.addAlternateItems(s))}))},getPayloadForAdd:function(e,t,n,a,i){for(var r=[],s=0;s<i.length;s++){var l=null!=i[s].id?i[s].id:i[s].AlternateItemPhysicalId;r.push(l)}let T=t.alternateTypeDropDown?t.alternateTypeDropDown.value:o.CONSTANT_BUS_ALTERNATE_REFERENCE;return{[o.CONSTANT_REF_ID]:e.getID(),[o.CONSTANT_USER_SELECTED_INSTANCE_ID]:this.getInstanceId(e,t),[o.CONSTANT_ALT_INFO]:this.createJSON(r,n,a,T)}},shouldShowInstanceAlternates:function(e){return!(!e||!e.getRelationID)&&e.getRelationID()},getInstanceId:function(e,t){var n=null;return t.options.activeEngItemTreeInfo._parentNode&&e&&e.getRelationID?(e.getID()!=t.options.activeEngItemTreeInfo._parentNode.getID()&&(n=e.getRelationID()),n):n},createJSON:function(e,t,n,a){var i=[];e=this.removeDuplicates(e);if(null==n)for(var r in e){if(t.length)for(var s in t){(l={})[o.CONSTANT_ALT_ID]=e[r],l[o.CONSTANT_CTX_ITEM_ID]=t[s],l[o.CONSTANT_INTERCHANGEABILITY_TYPE]=a,i.push(l)}else(l={})[o.CONSTANT_ALT_ID]=e[r],l[o.CONSTANT_INTERCHANGEABILITY_TYPE]=a,i.push(l)}else for(var r in e){var l;(l={})[o.CONSTANT_ALT_ID]=e[r],l[o.CONSTANT_REFERENCE_PHYSICAL_ID]=n,l[o.CONSTANT_INTERCHANGEABILITY_TYPE]=a,i.push(l)}return i},createJSONForProposeFor:function(e,t,n){var a=[];e=this.removeDuplicates(e);for(var i in e){var r={},s=null!=e[i].id?e[i].id:e[i].AlternateItemPhysicalId,l=e[i][o.CONSTANT_ALT_REF_PHYSICALID];if(r[o.CONSTANT_ALT_ID]=s,r[o.CONSTANT_ALT_REF_PHYSICALID]=l,t&&t.length)for(var T in t){(r={})[o.CONSTANT_ALT_ID]=s,r[o.CONSTANT_ALT_REF_PHYSICALID]=l,r[o.CONSTANT_CTX_ITEM_ID]=t[T],a.push(r)}else n&&(r[o.CONSTANT_REFERENCE_PHYSICAL_ID]=n),a.push(r)}return a},getPayload:function(e,t,n){var a=this.createJSONForRemoveRejectQualify(this.getAlternateIds(t,n));return{[o.CONSTANT_REF_ID]:e,[o.CONSTANT_ALT_INFO]:a}},createJSONForRemoveRejectQualify:function(e){var t=[];for(var n in e){var a={[o.CONSTANT_ALT_REF_PHYSICALID]:e[n]};t.push(a)}return t},getAlternateIds:function(e,t){for(var n=[],a=0;a<e.length;a++)Array.isArray(t)&&t.includes(e[a].options.grid[o.CONSTANT_STATUS])&&!this.altAppCore.altItemFactory.checkIfHeaderNode(e[a])&&n.push(e[a].options[o.CONSTANT_ALT_REF_PHYSICALID]);return n},removeDuplicates:function(e){for(var t=[],n=0;n<e.length;n++)-1==t.indexOf(e[n])&&t.push(e[n]);return t},fetchEngItemAttributes:function(e){var t=this.altAppCore.altSettingsManager.getCommand("fetch_attributes");return n.wrappedWithCancellablePromise((function(n,i){a.perform(t,e).then((function(e){return n(e)})).catch((function(e){i(e)}))}))},getRootsForExpand:function(e){for(var t=[],n=0;n<e.length;n++){var a={id:e[n]};t.push(a)}return t},expandServicePayload:function(e,t){return{roots:this.getRootsForExpand(e),no_type_filter_rel:["XCADBaseDependency"],include_param_Attributes:!0,"q.iterative_filter_query_bo":'[ds6w:globalType]:"ds6w:Part"',level:t,intent:"explore_2D",source:"cstorage",authored:!0}},fetchExpandService:function(e,t){var i=this.expandServicePayload(e,t),r=this.altAppCore.altSettingsManager.getCommand("fetch_enopad_expand");return n.wrappedWithCancellablePromise((function(e,t){a.perform(r,i).then((function(t){return e(t)})).catch((function(e){t(e)}))}))},getPathsForAttributes:function(e){for(var t,n=0;n<e.length;n++)e[n].path&&(t=e[n].path);return t},getAttributeValues:function(e){for(var t={},n=0;n<e.length;n++)t[e[n].name]=e[n].value;return t},fetchedObjectInfo:function(e,t){var a=this;return n.wrappedWithCancellablePromise((function(n,i){a.fetchExpandService(e,t).then((function(e){if(e.results){var t=e.results,i=a.getPathsForAttributes(t),r={};if(i)for(var o=0;o<i.length;o++)if(t[i[o]].attributes){var s=t[i[o]].attributes,l=a.getAttributeValues(s);r[l.resourceid]=l}return n(r)}}))}))},fetchedUpdatedAttrInfo:function(e,t){var a=this;return n.wrappedWithCancellablePromise((function(n,i){a.fetchReferenceAttrService(e,t).then((function(e){if(e.results){var i=e.results,r=Reflect.ownKeys(i),o={};if(r)for(var s=0;s<r.length;s++){var l=i[r[s]],T=a.getReferenceAttributeValues(t,l);o[r[s]]=T}return n(o)}}))}))},getReferenceAttributeValues:function(e,t){let n={},a=Reflect.ownKeys(t);for(let i of a)for(let a of e){if(i.includes(a.dbName)){if("owner"==a.dbName){n[a.dataIndex]=t[a.dataIndex],n[a.dbName]=t[i];break}if("reserved"==i){n[a.dataIndex]=t[i],n[o.DS6W_RESERVEDBY]=t[o.CONSTANT_RESERVEDBY];break}n[a.dataIndex]=t[i];break}i==o.CONSTANT_WORK_UNDER_CHANGE&&(n[i]=t[i])}return n},fetchReferenceAttrService:function(e,t){var i=this.referenceAttrServicePayload(e,t),r=this.altAppCore.altSettingsManager.getCommand("get_alternate_reference_attr_values");return n.wrappedWithCancellablePromise((function(e,t){a.perform(r,i).then((function(t){return e(t)})).catch((function(e){t(e)}))}))},referenceAttrServicePayload:function(e,t){return{referenceIds:e,AttributeSelects:this.buildAttributeDBNameList(t)}},buildAttributeDBNameList:function(e){let t=[];for(let n of e)"basic"==n.nature?t.push(n.dbName):t.push(`attribute[${n.dbName}]`);return t.push(o.CONSTANT_WORK_UNDER_CHANGE_ID),t.push(o.CONSTANT_RESERVEDBY),t},getNlsOfPropertiesValues:function(e){var t=this;return d&&!e?d:n.wrappedWithCancellablePromise((function(n,a){r.getNlsOfPropertiesValues(JSON.stringify(e),{apiVersion:"R2020x",tenantId:t.altAppCore.altSettingsManager.getPlatformId(),lang:t.altAppCore.altSettingsManager.getLanguage(),onComplete:function(e){e&&(t.ds6wClassPropNls||(t.ds6wClassPropNls={}),UWA.extend(t.ds6wClassPropNls,e,!0),d=t.ds6wClassPropNls,n(t.ds6wClassPropNls))},onFailure:function(){console.warn("DictionaryAccess## FedDictionaryAccessAPI.getNlsOfPropertiesValues failed for"+e),n()}})}))},federadedSearch:function(e){if(!e.query)throw new Error("query is a mandatory parameter");var t=this,n=t.altAppCore.altSettingsManager.getCommand("fed_myEng"),i={label:t.altAppCore.altSettingsManager.getCVRequestLabel(),nresults:e.nresults||100,order_by:"desc",order_field:"ds6w:modified",query:e.query,select_predicate:e.predicates||t.altAppCore.altSettingsManager.getSetting("select_predicate"),select_file:["icon","thumbnail_2d"],start:"0",tenant:t.altAppCore.altSettingsManager.getPlatformId(),with_indexing_date:!0,with_nls:!0,source:e.source||n.source,login:{"3dspace":{SecurityContext:t.altAppCore.altSettingsManager.getSecurityContext()}}};return a.perform(n,JSON.stringify(i))},fireAutocompleteSearch:function(e){var t=this,a={predicates:["ds6w:label","physicalid","ds6wg:revision"],nresults:e.nresults,query:""};Array.isArray(e.sources)&&e.sources.length>0&&(a.sources=e.sources);var i=t.getAugmenttedQueryForSearch(e.criteria);if(Array.isArray(e.targetTypes)&&e.targetTypes.length>0){for(var r='flattenedtaxonomies:"types/'+e.targetTypes[0]+'"',o=1;o<e.targetTypes.length;o++){r+=' OR flattenedtaxonomies:"types/'+e.targetTypes[o]+'"'}a.query="("+r+")"}if(Array.isArray(e.invalidInterfaces)&&e.invalidInterfaces.length>0){var l=s.FLATTENDTAXONOMIES_INTERFACES+e.invalidInterfaces[0]+'"';for(o=1;o<e.invalidInterfaces.length;o++){const t=e.invalidInterfaces[o];l+=" OR "+s.FLATTENDTAXONOMIES_INTERFACES+t+'"'}a.query=a.query?a.query+" AND NOT ("+l+")":" NOT ("+l+")"}return a.query=a.query?a.query+" AND "+i:i,e.precond&&(a.query=e.precond+" AND "+a.query),n.wrappedWithPromise((function(e,n){t.federadedSearch(a).then((function(n){var a=t.parseFetchResult(n);e(a.results)})).catch((function(e){n(e)}))}))},getAugmenttedQueryForSearch:function(e){if(t.is(e,"string")&&e.trim().length>0){var n=e;return"*"!==e.charAt(0)&&(n="*"+e),"*"!==e.charAt(e.length-1)&&(n+="*"),n}return null},parseFetchResult:function(e,t){var n=e.results||[],a=[],i=this,r=null;return t&&(r={withNlsProp:t,classes:[],properties:{}}),n.forEach((function(e){0===e.attributes.length||e.sort&&"#DELETE#"===e.sort.sortType?a.push({deleted:!0}):a.push(i.attributesParser(e.attributes,r))})),{results:a,nlsTracker:r}},attributesParser:function(e){for(var t={},n=0;n<e.length;n++)t[e[n].name]=e[n].value;return t},getParentPointedAlternateReferenceIds:function(e){var t={};t[o.CONSTANT_CARRYOVER_PARENT_PRODUCTS_PHYSICAL_ID]=e;var i=this.altAppCore.altSettingsManager.getCommand("getParentPointedAlternateReferencePhyIds");return n.wrappedWithCancellablePromise((function(e,n){a.perform(i,t).then((function(t){return e(t)})).catch((function(t){e(t)}))}))},performCarryOverRevisions:function(e,t){var i={};i[o.CONSTANT_CARRYOVER_DEST_PRODUCTS_PHYSICAL_ID]=t,i[o.CONSTANT_CARRYOVER_SOURCE_PRODUCTS_PHYSICAL_ID]=e;var r=this.altAppCore.altSettingsManager.getCommand("carryOverAlternates");return n.wrappedWithCancellablePromise((function(e,t){a.perform(r,i).then((function(t){return e(t)})).catch((function(e){t(e)}))}))},getUsagesInfoForAlternates:function(e){var t=this.altAppCore.altSettingsManager.getCommand("alternate_properties");t.url=t.url;var i={};return i[o.CONSTANT_ALT_REF_PHYSICALID]=e,n.wrappedWithCancellablePromise((function(e,n){a.perform(t,i).then((function(t){return e(t)})).catch((function(t){e(t)}))}))},getSettingsForAlternateSources:function(e){if(!UWA.is(e))return null;var t=this.altAppCore.altSettingsManager.getCommand("my_app_getPreference"),i=Object.assign({},t);return i.url=i.url+"?name="+this.altAppCore.altSettingsManager._getUserPrefKey(e),n.wrappedWithCancellablePromise((function(e,t){a.perform(i).then((function(t){return i=null,t&&""===t.trim()?e(null):e(t)})).catch((function(e){t(e)}))}))},setSourceSettings:function(e,t){if(!UWA.is(e)||!UWA.is(t))return null;var i=this.altAppCore.altSettingsManager.getCommand("my_app_setPreference"),r=Object.assign({},i);let o="name="+this.altAppCore.altSettingsManager._getUserPrefKey(e)+"&value="+UWA.Utils.encodeUrl(t);return n.wrappedWithCancellablePromise((function(e,t){a.perform(r,o).then((function(t){return r=null,e(t)})).catch((function(e){t(e)}))}))},getSelectedAddToChangeAlternates:function(e){for(var t=[],n=0;n<e.length;n++){e[n];var a={activities:[{what:{operation:"ChangeStatus","target state":o.CONSTANT_PROPOSED==e[n][o.CONSTANT_STATUS]||o.CONSTANT_FROZEN==e[n][o.CONSTANT_STATUS]?"Release":o.CONSTANT_QUALIFIED==e[n][o.CONSTANT_STATUS]?"Obsolete":""},why:{comment:{}}}],operation:{name:"None"},where:{id:"pid:"+e[n][o.CONSTANT_KEY_PHYSICALID]},why:{comment:{}}};t.push(a)}return t},getCVServletPayload:function(e,t){var n=this,a=JSON.parse(T);let i=n.altAppCore.altDicoServices.additionalColumnsAndBOs.additionalBOs?n.altAppCore.altDicoServices.additionalColumnsAndBOs.additionalBOs:[];return{multi_root_physicalid:e,type_filter_rel:[o.RELATIONSHIP_ALTERNATE_ITEM],expand_iter:"1",no_type_filter_rel:["XCADBaseDependency"],select_bo:[...new Set(a.select_bo.concat(i))],select_rel:a.select_rel,compute_select_bo:a.compute_select_bo,label:n.altAppCore.altSettingsManager.getCVRequestLabel()}},updateAttributes:async function(e){if(!Array.isArray(e))return;const t=e.filter((e=>{const{referenceid:t,attribute:n}=e||{};return t&&n&&n.path})).map((({referenceid:e,attribute:t,value:n})=>({referenceid:e,attribute:t,attributePath:t.path,value:"string"==typeof n?n.replace("\r",""):n}))),n=this.buildPayloadForEditService(t);if(!n)throw new Error("build payload for set attribute failed");let r=null;try{const e=this.altAppCore.altSettingsManager.getCommand("set_alternate_reference_attr_values");if(r=await a.perform(e,JSON.stringify(n)),!r)throw new Error("invalid set Attribute command answer")}catch(e){throw e.response&&"error"==e.response.status&&i.errorAlert(e.response.message),e}return r},buildPayloadForEditService(e){if(!Array.isArray(e))return null;const t={};e.forEach((({referenceid:e,attributePath:n,value:a})=>{t[e]?t[e].push({[n]:a}):t[e]={[n]:a}}));return{AltRefPhyIdAndAttrValues:t}}})})),define("DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator",["UWA/Core","UWA/Class","DS/ENOXAlternateSubstitute/services/AlternateSubstituteServices","DS/ENOXAlternateSubstitute/views/AlternateItemModel","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXAlternateSubstitute/utils/AlternateUtils","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n,a,i,r,o,s){"use strict";return t.singleton({init:function(e){this._parent(e),this._nlsPropValues=n.getNlsOfPropertiesValues()},createRevisionsItem:function(e){e[r.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_REVISIONS_TITLE]=e[r.CONSTANT_DATAGRID_LABEL],e[r.CONSTANT_CARRYOVER_REVISION_COLUMN_CREATION_DATE]=o.getformatedDate(e[r.CONSTANT_CARRYOVER_REVISION_COLUMN_CREATION_DATE]),e[r.CONSTANT_CARRYOVER_REVISION_COLUMN_MODIFICATION_DATE]=o.getformatedDate(e[r.CONSTANT_CARRYOVER_REVISION_COLUMN_MODIFICATION_DATE]),e[r.CONSTANT_KEY_PHYSICALID]=e[r.CONSTANT_KEY_ID],e[r.CONSTANTS_KEY_ICONS]=e[r.CONSTANTS_ICON]?[e[r.CONSTANTS_ICON]]:[i.getDefaultProductIcon()];var t=this._optionsRetrievor(e),n=this.basicOptionsBuilder(t);return new a(n)},createAlternateItem:function(e){var t=this,n=t._nlsPropValues["ds6w:status"][e[r.CONSTANT_DATAGRID_MATURITY_STATE]];e[r.CONSTANTS_KEY_ICONS]=e[r.CONSTANTS_ICON]?[e[r.CONSTANTS_ICON]]:[i.getDefaultProductIcon()],e[r.CONSTANTS_THUMNAIL]=e[r.CONSTANTS_THUMNAIL],e[r.CONSTANT_DATAGRID_MATURITY_STATE]=n||e[r.CONSTANT_DATAGRID_MATURITY_STATE];var o=t._optionsRetrievor(e),s=t.basicOptionsBuilder(o);return new a(s)},createAlternateCarryOverItems:function(e){var t=this,n=t._nlsPropValues["ds6w:status"][e[r.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY]];e[r.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY]=n||e[r.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY],e[r.CONSTANTS_KEY_ICONS]=e[r.CONSTANTS_KEY_ICONS]?e[r.CONSTANTS_KEY_ICONS]:[i.getDefaultProductIcon()];var o=t._optionsRetrievor(e),s=t.basicOptionsBuilder(o);return new a(s)},basicOptionsBuilder:function(e){return this.Options={},e.grid?(e.grid[r.CONSTANT_DATAGRID_LABEL]=e[r.CONSTANT_DATAGRID_LABEL],e.grid[r.CONSTANT_DATAGRID_AVAILABLE_CONTEXT]=e[r.CONSTANT_DATAGRID_AVAILABLE_CONTEXT],e.grid[r.CONSTANT_DATAGRID_MODEL]=e[r.CONSTANT_DATAGRID_MODEL],this.Options=Object.assign({},e)):(this.Options=Object.assign({grid:{}},e),this._fillAttributes(e)),this.Options},_optionsRetrievor:function(e){return this.retrieveNodeData(e)},retrieveNodeData:function(e){return e[r.CONSTANT_DATAGRID_LABEL]=e[r.CONSTANT_TITLE],e[r.CONSTANT_DATAGRID_AVAILABLE_CONTEXT]=this.getContextColumnValue(e),e[r.CONSTANT_DATAGRID_MODEL]=this.getHasConfigContextColumnValue(e),e},_fillAttributes:function(e){var t=this;return Object.keys(e).forEach((function(n){t.Options.grid[n]=e[n]})),this.Options},createAlternateItemNodes:function(e){var t=this,n=[];return e.forEach((function(e){var a=t.createAlternateItem(e),i=[];e[r.CONSTANT_OTHER_CONTEXT_KEY]&&(e[r.CONSTANT_OTHER_CONTEXT_KEY].forEach((function(e){if(e[r.CONSTANT_APPLICABILTY]==r.APPLICABILITY_YES){var n=t.createAlternateItem(e);i.push(n)}})),i.length>1&&a.addChild(i)),e[r.CONSTANT_APPLICABILTY]!=r.APPLICABILITY_YES&&e[r.CONSTANT_SPLIT]!=r.SPLIT_YES||n.push(a)})),n},createAlternateItemWithNotApplicableData:function(e){var t=this,n=[];return e.forEach((function(e){var a=t.createAlternateItem(e);n.push(a)})),n},getContextColumnValue:function(e){if(e[r.CONSTANT_OTHER_CONTEXT_KEY]){var t=this.countStatusInfo(e[r.CONSTANT_OTHER_CONTEXT_KEY]),n=t.usage.split(","),a=t.count;if(n.length>1?e[r.CONSTANT_OTHER_CONTEXT_SAME_STATUS_EXISTS]=r.CONSTANT_NO:(e[r.CONSTANT_OTHER_CONTEXT_SAME_STATUS_EXISTS]=r.CONSTANT_YES,e.grid&&e.grid[r.CONSTANT_STATUS]?e.grid[r.CONSTANT_STATUS]=t[r.CONSTANT_STATUS]:e[r.CONSTANT_STATUS]=t[r.CONSTANT_STATUS]),1==a)return this.getContextInformation(e);var i=s.get("eng.alternate.column.applicable.availableContexts");return e[r.CONSTANT_OTHER_CONTEXT_SAME_STATUS_EXISTS]==r.CONSTANT_YES?a+" "+i:a+" "+i+(t.usage?" ( "+t.usage+" )":"")}return this.getContextInformation(e)},getHasConfigContextColumnValue:function(e){if(e[r.CONSTANT_APPLICABILTY]!=r.CONSTANT_YES&&e[r.CONSTANT_OTHER_CONTEXT_KEY]&&e[r.CONSTANT_SPLIT]!=r.SPLIT_YES){var t=s.get("eng.alternate.config.context.value.no");return e[r.CONSTANT_OTHER_CONTEXT_KEY].forEach((function(e){e[r.CONSTANT_CONFIG_CONTEXT_PHYSICALID]&&(t=s.get("eng.alternate.config.context.value.yes"))})),t}return e[r.CONSTANT_CONFIG_CONTEXT_PHYSICALID]?s.get("eng.alternate.config.context.value.yes"):s.get("eng.alternate.config.context.value.no")},getContextInformation:function(e){return e[r.CONSTANT_OPERATION_KEY]==r.CONSTANT_OPERATION_KEY_VALUE_ALTERNATE?s.get("eng.alternate.datagrid.column.usage.all"):e[r.CONSTANT_OPERATION_KEY]==r.CONSTANT_OPERATION_KEY_VALUE_INSTANCE_SUB?e[r.CONSTANT_SPLIT]==r.SPLIT_YES?s.get("eng.alternate.datagrid.column.usage.alternate.applicable.other.context")+e[r.CONSTANT_OTHER_CONTEXT_APPLICABLE_ALTERNATE_REF_PHYSICALD].length:s.get("eng.alternate.datagrid.column.usage.instance")+e[r.CONSTANT_INSTANCE_CONTEXT_TITLE]:s.get("eng.alternate.datagrid.column.usage.reference")+e[r.CONSTANT_PARENT_CONTEXT_TITLE]+" "+e[r.CONSTANT_PARENT_CONTEXT_REVISION]},countStatusInfo:function(e){var t={},n="",a="",i=0,o={};return e.forEach((function(e){t.hasOwnProperty(e.grid[r.CONSTANT_STATUS])?t[e.grid[r.CONSTANT_STATUS]].push(e):t[e.grid[r.CONSTANT_STATUS]]=[e]})),Object.keys(t).forEach((function(e){e==r.CONSTANT_PROPOSED?a=s.get("eng.alternate.status.proposed"):e==r.CONSTANT_FROZEN?a=s.get("eng.alternate.status.frozen"):e==r.CONSTANT_QUALIFIED?a=s.get("eng.alternate.status.qualified"):e==r.CONSTANT_OBSOLETE&&(a=s.get("eng.alternate.status.obsolete")),n+=t[e].length+" "+a+", ",i+=t[e].length,o[r.CONSTANT_STATUS]=e})),o.usage=n.substring(0,n.length-2),o.count=i,o}})})),define("DS/ENOXAlternateSubstitute/commands/GetSuggestionAlternateUsage",["UWA/Class","UWA/Core","DS/TreeModel/TreeDocument","DS/Controls/Button","DS/Windows/Dialog","DS/Handlebars/Handlebars4","DS/Windows/ImmersiveFrame","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXEngineerCommonUtils/XENMask","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","DS/ENOXAlternateSubstitute/views/AlternateGridViewManager","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","text!DS/ENOXAlternateSubstitute/views/html/SuggestionUsagesList.html","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","css!DS/ENOXAlternateSubstitute/styles/Alternate.css"],(function(e,t,n,a,i,r,o,s,l,T,A,d,N,c){return e.singleton({initialize:function(e){this.altOptions=e.altOptions},_initDivs:function(e){var n={alternatesuggestionUsageGridView:!0,usagesInfo:e.usagesInfo},a=r.compile(N);this._container=t.createElement("div",{class:"enox-alternate-suggestion-usage-wrapper"}),this._container.innerHTML=a(n),this._SuggestionUsageAlternateModal=this._container.querySelector(".enox-alternate-suggestion-usages"),this._SuggestionUsageToolbar=this._container.querySelector(".enox-alternare-suggestion-usage-toolbar"),this._SuggestionUsagedataGridViewDiv=this._container.querySelector(".enox-alternate-suggestion-usage-grid-view")},createsuggestionReferenceModel:function(e){this._initDivs(e.context?e.context:e);var n,a=e.context?e.context:e;n=a.navigation&&a.navigation==d.CONSTANT_ALTERNATE_USAGE_POPUP_NOT_APPLICABLE_NAVIGATION?c.get("eng.alternate.applicable.usage.popup.note"):c.get("eng.alternate.suggestion.usage.popup.note"),this._leftMenuContainer=this._SuggestionUsageToolbar?t.createElement("div",{class:"alternate_Suggestion_right_menu_container",text:n}).inject(this._SuggestionUsageToolbar):"",this.buildContextViewContent(e.context?e.context:e)},buildContextDialog:function(e){var t=this,n=new o;return n.inject(t.altOptions.getAltFacetMainContainer()),t.suggestionDialog=new i({title:c.get("eng.alternate.suggestion.parent.usage.history")+e,content:this._SuggestionUsageAlternateModal,immersiveFrame:n,resizableFlag:!0,width:550,height:450,position:{at:"center",my:"center"},modalFlag:!0,touchMode:!0,buttons:{Cancel:new a({onClick:function(e){e.dsModel.dialog.close()}})}}),t.suggestionDialog},buildContextViewContent:function(e){var t=this;this.suggestionReferenceModel=new n,t.alternateReferenceDialogbox=t.buildContextDialog(e.title),l.mask(t.alternateReferenceDialogbox.elements._contentDiv),t.altOptions.altAppCore.altDataServices.getUsagesInfoForAlternates(e.Alt_ref_ids).then((function(e){if(e.hasOwnProperty(d.ERROR)){var n=e.error.message?e.error.message:e;return n=e.response&&e.response.message?e.response.message:n,void s.errorAlert(n)}if(e.status==d.SUCCESS){l.unmask(t.alternateReferenceDialogbox.elements._contentDiv);var a=T.createAlternateItemWithNotApplicableData(e.AlternateItemInfo,!0);t.suggestionReferenceModel.addRoot(a),t.getDataGridView()}}))},getDataGridView:function(){var e=this,t=e.altOptions.altAppCore.altSettingsManager.getCommand(d.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[d.CONSTANT_SUGGESTION_USAGE_COLUMN_INFO],n=A._getDataGridColumns(t,e.altOptions.altAppCore),a=e.altOptions.altAppCore.altSettingsManager.getCommand(d.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[d.CONSTANT_SUGGESTION_USAGE_COLUMN_OPTIONS];e.alternateReferenceGridView=e.altOptions.createDataGridView(e.suggestionReferenceModel,n,a),e.alternateReferenceGridView.dsModel.layout.rowsHeader=!1,this._SuggestionUsageAlternateModal.appendChild(this._SuggestionUsagedataGridViewDiv),this.alternateReferenceGridView.show(),this.alternateReferenceGridView.inject(e._SuggestionUsagedataGridViewDiv)}})})),define("DS/ENOXAlternateSubstitute/views/PrimaryItemModel",["UWA/Core","DS/TreeModel/TreeNodeModel","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n,a){function i(n){this.options={contextualMenu:[null],emptyStatusbarVisibleFlag:!0},this.options=e.extend(this.options,n),t.call(this,this.options)}return i.prototype=Object.create(t.prototype),i.prototype.getID=function(){return this.options.referenceId},i.prototype.getReferenceVersion=function(){return this.options.grid["ds6wg:revision"]},i.prototype.getLabel=function(){return this.options.grid["ds6w:label"]},i.prototype.getDisplayName=function(){const e=void 0!==this.getReferenceVersion()?this.getReferenceVersion():"";return this.getLabel()+" "+e},i.prototype.getGlobalType=function(){return this.options.padgrid["ds6w:globalType"]},i.prototype.isEngineeringItem=function(){var e=!1;return"ds6w:Part"===this.getGlobalType()&&(e=!0),e},i.prototype.getParentID=function(){return this.options.grid.parentId},i})),define("DS/ENOXAlternateSubstitute/components/properties/js/PropertiesFacet",["UWA/Class","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/models/EditPropAttributeModel","DS/EditPropWidget/EditPropComponent","DS/ENOXEngineerCommonUtils/XENModal","DS/ENOXEngineerCommonUtils/XENMask","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXEngineer/utils/XEngineerConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n,a,i,r,o,s,l,T,A,d){"use strict";return e.singleton({_getPropertiesWidget:function(e){var t=[n.FACET_PROPERTIES,n.FACET_CHANGE,n.FACET_ALTERNATE,n.FACET_RELATIONS,n.FACET_SWYMCOMMENTS,n.FACET_GENERALHISTORY];this.alternateEditComp=new r({typeOfDisplay:n.ALL,selectionType:n.ALL_SELECTION,displayType:n.POPUP,facets:t,setCloseButton:!1,readOnly:e.context[T.CONSTANT_PROPERTIES_READ_ONLY],extraNotif:!0,editMode:!1,defaultFacetName:e.context.FACET,appId:l.getAppId()});var i=e.context[T.CONSTANT_PROPERTIES_OBJECT_ID],o=[],s=new a({tenant:e.context[T.CONSTANT_PROPERTIES_TENANT_ID],objectId:i});o.push(s),e.context[T.CONSTANT_PROPERTIES_READ_ONLY]||this.alternateEditComp.addFacets([{require:"DS/ENOXAlternateSubstitute/facets/AlternateSpecificationsFacet",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:T.CONST_SPEC_FACET_NAME,icon:"doc-log",text:d.get("v6_specdoc_to")},options:{appContext:e.context}}]),this.alternateEditComp.show(o)}})})),define("DS/ENOXAlternateSubstitute/services/AlternateItemsFactory",["UWA/Class","DS/ENOXAlternateSubstitute/views/AlternateItemModel","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","UWA/Utils/InterCom","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n,a,i,r){"use strict";return e.singleton({initialize:function(e){this.options=e},getValidStatus:function(e,t){if(e.options[i.CONSTANT_OTHER_CONTEXT_APPLICABLE_DATA_EXISTS]&&e.options[i.CONSTANT_OTHER_CONTEXT_SAME_STATUS_EXISTS]&&e.options[i.CONSTANT_OTHER_CONTEXT_SAME_STATUS_EXISTS]==i.CONSTANT_NO){var n=r.get("eng.alternate.column.status.multiple");return this.buildIconSpan(null,n,t)}var a=this.getStatus(e,!1);return a?this.buildIconSpan(a[i.CONSTANT_STATUS_ICON_CLASS],a[i.CONSTANT_STATUS],t):""},buildIconSpan:function(e,t,n){var a="enox-alternate-status",r="enox-alternate-status-text",o="16px";n&&(a="enox-alternate-tilesview-status",r="enox-alternate-tilesview-status-text",o="14px");var s=new UWA.createElement("div",{class:a});if(e===i.CONSTANT_ICON_OBSOLETE_WUC_CLASS)this.buildIconForObsoleteWUC(s,e);else if(e){var l=new UWA.createElement("div",{class:e});l.style.fontSize=o,s.append(l)}var T=new UWA.createElement("span",{class:r});return T.addContent(t),s.append(T),s},getChangeIcon:function(e){var t=UWA.createElement("span");if(e.options.grid.WorkUnderChangeActionPhyId&&""!=e.options.grid.WorkUnderChangeActionPhyId){t.setText(" | "),attributesDiv.appendChild(t);var n=new UWA.createElement("img",{class:"enox-alternate-statusIcon fonticon fonticon-change-action-proposed "+i.CONSTANT_ICON_QUALIFIED_CLASS});n.style.fontSize="16px",attributesDiv.appendChild(n)}},getStatus:function(e,t){var n,a=e.options.grid;return a[i.CONSTANT_STATUS]==i.CONSTANT_NOT_APPLICABLE?n=this.buildStatusIconClass(i.CONSTANT_ICON_SPLIT,i.CONSTANT_ICON_SPLIT_CLASS,r.get("eng.alternate.status.NotApplicable"),a,t):a[i.CONSTANT_STATUS]==i.CONSTANT_PROPOSED?n=this.buildStatusIconClass(i.CONSTANT_ICON_PROPOSED,i.CONSTANT_ICON_PROPOSED_CLASS,r.get("eng.alternate.status.proposed"),a,t):a[i.CONSTANT_STATUS]==i.CONSTANT_FROZEN?n=this.buildStatusIconClass(i.CONSTANT_ICON_FROZEN,i.CONSTANT_ICON_FROZEN_CLASS,r.get("eng.alternate.status.frozen"),a,t):a[i.CONSTANT_STATUS]!=i.CONSTANT_QUALIFIED||a[i.CONSTANT_WORK_UNDER_CHANGE]?a[i.CONSTANT_STATUS]==i.CONSTANT_OBSOLETE?n=this.buildStatusIconClass(i.CONSTANT_ICON_OBSOLETE,i.CONSTANT_ICON_OBSOLETE_CLASS,r.get("eng.alternate.status.obsolete"),a,t):(a[i.CONSTANT_STATUS]==i.CONSTANT_CHANGE_ATTACHED||a[i.CONSTANT_STATUS]==i.CONSTANT_QUALIFIED&&a[i.CONSTANT_WORK_UNDER_CHANGE])&&(n=this.buildStatusIconClass(i.CONSTANT_ICON_WARNING,i.CONSTANT_ICON_OBSOLETE_WUC_CLASS,r.get("eng.alternate.status.qualified"),a,t)):n=this.buildStatusIconClass(i.CONSTANT_ICON_QUALIFIED,i.CONSTANT_ICON_QUALIFIED_CLASS,r.get("eng.alternate.status.qualified"),a,t),n},buildIconForObsoleteWUC:function(e,t){var n=new UWA.createElement("div",{class:"fonticon fonticon-"+i.CONSTANT_ICON_QUALIFIED+" "+i.CONSTANT_ICON_QUALIFIED_CLASS});n.style.fontSize="14px",e.append(n);var a=new UWA.createElement("div",{class:"enox-alternate-statusIcon fonticon fonticon-"+i.CONSTANT_ICON_WARNING+" "+t});a.style.fontSize="10px",e.append(a)},buildStatusIconClass:function(e,t,n,a,o){new UWA.createElement("div",{class:"enox-alternate-status"});var s,l=n;if(o){var T=a[i.CONSTANT_OPERATION_KEY]==i.CONSTANT_OPERATION_KEY_VALUE_ALTERNATE?r.get("eng.alternate.status.context.applicable.all"):r.get("eng.alternate.status.context.applicable.this");l=a[i.CONSTANT_OPERATION_KEY]==i.CONSTANT_OPERATION_KEY_VALUE_ALTERNATE||o?n:r.get("eng.alternate.status.context.applicable.yes").replace("$1",n).replace("$2",T)}t===i.CONSTANT_ICON_OBSOLETE_WUC_CLASS?(s=t,l=r.get("eng.alternate.status.qualified.WUC").replace("$1",l)):s="enox-alternate-statusIcon fonticon fonticon-"+e+" "+t;var A={};return A[i.CONSTANT_STATUS_ICON_CLASS]=s,A[i.CONSTANT_STATUS]=l,A},getUsageDetails:function(e,t){var n="";if(this.checkIfHeaderNode(e)){var a=this.getNodeCounterQuantity(e),o=r.get("eng.alternate.views.tiles.header.usage").replace("$1"," "+a);n=t?o:""}else e.options.grid[i.CONSTANT_OPERATION_KEY]==i.Operation_Alternate?n=r.get("eng.alternate.datagrid.column.usage.all"):e.options.grid[i.CONSTANT_OPERATION_KEY]==i.Operation_InstanceSubstitute?n=e.options.grid[i.CONSTANT_SPLIT]==i.SPLIT_YES?r.get("eng.alternate.datagrid.column.usage.alternate.applicable.other.context")+e.options.grid[i.CONSTANT_OTHER_CONTEXT_APPLICABLE_ALTERNATE_REF_PHYSICALD].length:r.get("eng.alternate.datagrid.column.usage.instance")+e.options.grid[i.CONSTANT_INSTANCE_CONTEXT_TITLE]:e.options.grid[i.CONSTANT_OPERATION_KEY]==i.Operation_ReferenceSubstitute&&(n=r.get("eng.alternate.datagrid.column.usage.reference")+e.options.grid[i.CONSTANT_PARENT_CONTEXT_TITLE]+" "+e.options.grid[i.CONSTANT_PARENT_CONTEXT_REVISION]);return n},getNodeCounterQuantity:function(e){return e.getChildren()?e.getChildren().length:"0"},getNlsOfGroupByTitle:function(e){var t=e.getProperty(),n=e.getIdentifier(),a=e.getChildren&&e.getChildren()?e.getChildren().length:"0",o=e.getOriginalChildrenInformation&&e.getOriginalChildrenInformation()&&e.getOriginalChildrenInformation().notHiddenNotFilteredChildrenCount?e.getOriginalChildrenInformation().notHiddenNotFilteredChildrenCount:a,s="",l=this.getNLSPropertyMap(t);return s=t==i.CONSTANT_ALT_ID?e.getChildren()&&e.getChildren()[0].getDisplayName():this.getNLSPropertyMap(n),e.getNodeSource()&&(e._options.label=r.get("eng.alternate.groupBy.title").replace("$1",l).replace("$2",s).replace("$3",o)),r.get("eng.alternate.groupBy.title").replace("$1",l).replace("$2",s).replace("$3",o)},getNLSPropertyMap:function(e){var t={};return t[i.CONSTANT_STATUS]=r.get("eng.alternate.column.status"),t[i.CONSTANT_DATAGRID_COLUMN_REVISION]=r.get("eng.alternate.column.revision"),t[i.CONSTANT_DATAGRID_MATURITY_STATE]=r.get("eng.alternate.column.maturityState"),t[i.CONSTANT_DATAGRID_PART_NUMBER]=r.get("eng.alternate.column.partNumber"),t[i.CONSTANT_OPERATION_KEY]=r.get("eng.alternate.label.usageScope"),t[i.CONSTANT_ALT_ID]=r.get("eng.alternate.groupby.options.reference"),t[i.CONSTANT_SUGGESTION_SELECT_USAGE]=r.get("eng.alternate.suggestion.usage.details"),t[i.CONSTANT_DATAGRID_COLUMN_SOURCE]=r.get("eng.alternate.suggestion.source.details"),t[i.CONSTANT_PROPOSED]=r.get("eng.alternate.status.proposed"),t[i.CONSTANT_FROZEN]=r.get("eng.alternate.status.frozen"),t[i.CONSTANT_QUALIFIED]=r.get("eng.alternate.status.qualified"),t[i.CONSTANT_OBSOLETE]=r.get("eng.alternate.status.obsolete"),t[i.Operation_Alternate]=r.get("eng.alternate.usage.all"),t[i.Operation_InstanceSubstitute]=r.get("eng.alternate.usage.instance"),t[i.Operation_ReferenceSubstitute]=r.get("eng.alternate.usage.reference"),t[i.CONSTANT_SELECT_USAGE_ALL]=r.get("eng.alternate.select.usage.all"),t[i.CONSTANT_SELECT_USAGE_REFERENCE]=r.get("eng.alternate.select.usage.reference"),t[i.CONSTANT_SELECT_USAGE_INSTANCE]=r.get("eng.alternate.select.usage.instance"),t[i.CONSTANT_SUGGESTION_REVISION]=r.get("eng.alternate.suggestion.revision"),t[i.CONSTANT_SUGGESTION_PREVIOUS_REVISION]=r.get("eng.alternate.suggestion.previous.revision"),t[i.CONSTANT_SUGGESTION_BRANCH_FROM]=r.get("eng.alternate.suggestion.branch.from"),t[i.CONSTANT_SUGGESTION_BRANCH]=r.get("eng.alternate.suggestion.branch"),t[i.CONSTANT_SUGGESTION_DUPLICATE]=r.get("eng.alternate.suggestion.duplicate"),t[i.CONSTANT_SUGGESTION_OTHER_USAGE]=r.get("eng.alternate.suggestion.other.usages"),t[i.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE]=r.get("eng.alternate.suggestion.alternates.of.alternate"),t[e]?t[e]:e},checkIfHeaderNode:function(e){var n=e&&e.options[i.CONSTANT_OTHER_CONTEXT_KEY],a=!1,r=e&&e._parentNode;return n&&n.length>0&&!(r instanceof t)&&e instanceof t&&e.getVisibleChildren()&&(a=!0),a},checkIfAlternateChildNode:function(e){var n=!1;return(e&&e._parentNode)instanceof t&&(n=!0),n},updateAlternateNode:function(e){var t=e&&e._getRowID&&e._getRowID();if(this.checkIfAlternateChildNode(e)){var n=e&&e._parentNode,a=t-n._getRowID();n.addChild(e,a-1)}else this.options.altOptions._addAlternateUX.ALTERNATE.model.addChild(e,t)},updateGroupBy:function(){this.options.instanciatedViews.AlternateDataGridView.groupRows(this.options.instanciatedViews.AlternateDataGridView.getGroupingOptions())},removeChildFromParentNode:function(e,t){var a=[],r=e.options[i.CONSTANT_OTHER_CONTEXT_KEY];e.removeChild(t),r&&r.forEach((function(e){t.options.grid[i.CONSTANT_INSTANCE_CONTEXT_LOGICALID]!=e.grid[i.CONSTANT_INSTANCE_CONTEXT_LOGICALID]&&a.push(e)})),e.options[i.CONSTANT_OTHER_CONTEXT_KEY]=a,e.options.grid[i.CONSTANT_DATAGRID_AVAILABLE_CONTEXT]=n.getContextColumnValue(e.options)},getContentForCompassInteraction:function(e){var t=[];if(e){var n={objectId:e.getID(),objectType:e.getType(),displayName:e.getDisplayName(),displayType:e.getType(),facetName:"realized"};t.push(n)}else for(var a=this.options._addAlternateUX.ALTERNATE.model.getSelectedNodes(),i=0;i<a.length;i++){var r={objectId:a[i].getID(),objectType:a[i].getType(),displayName:a[i].getDisplayName(),displayType:a[i].getType(),facetName:"realized"};t.push(r)}var o=this.options.altAppCore.altSettingsManager.getSecurityContext(),s=[];return t.forEach((function(e){var t={envId:widget.getValue("x3dPlatformId"),serviceId:"3DSpace",contextId:o,objectId:e.objectId,objectType:e.objectType,displayName:e.displayName,displayType:e.displayType,facetName:e.facetName?e.facetName:"",path:[{resourceid:e.objectId,type:e.objectType}]};s.push(t)})),{protocol:"3DXContent",version:"1.1",source:widget.data.appId,widgetId:widget.id,data:{items:s}}},openItemWithCompass:function(){var e=this.options._addAlternateUX.ALTERNATE.model.getSelectedNodes(),t=UWA.is(widget)&&widget.id?"xEngAltCompassSocket_"+widget.id:"xEngAltCompassSocket";if(this._compass_socket||(this._compass_socket=new a.Socket(t),this._compass_socket.subscribeServer("com.ds.compass",window.parent)),e&&e.length>0){var n=this.getContentForCompassInteraction();this._compass_socket.dispatchEvent("onSetX3DContent",n,t)}else this._compass_socket.dispatchEvent("onResetX3DContent",{},t)},checkIfNodeSelected:function(e){var t=!1;return e&&(e.isSelected()&&this.options.activeView!==i.CONSTANT_ALTERNATE_VIEW_DATAGRID||!e.isSelected()&&this.options.activeView===i.CONSTANT_ALTERNATE_VIEW_DATAGRID)&&(t=!0),t}})})),define("DS/ENOXAlternateSubstitute/commands/CarryOverFromRevision",["UWA/Class","DS/Windows/ImmersiveFrame","DS/Handlebars/Handlebars4","DS/Controls/Button","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXEngineerCommonUtils/XENMask","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXAlternateSubstitute/utils/AlternateDataParser","DS/ENOXAlternateSubstitute/views/AlternateGridViewManager","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXAlternateSubstitute/commands/GetSuggestionAlternateUsage","DS/ENOXEngineerCommonUtils/xEngAlertManager","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","text!DS/ENOXAlternateSubstitute/views/html/CarryOverFromRevisions.html"],(function(e,t,n,a,i,r,o,s,l,T,A,d,N,c,_,u,S){"use strict";return e.singleton({initialize:function(e){this.options=e.options,this.altAppCore=e.altAppCore,this.altOptions=e.altOptions},_initDivs:function(){this.refreshView=!1,c.initialize(this);var e=n.compile(S);this._carryOverAlternatescontainer=UWA.createElement("div",{class:"enox-alternate-carryover-wrapper"}),this._carryOverAlternatescontainer.innerHTML=e(),this._primaryItemAlternatesModal=this._carryOverAlternatescontainer.querySelector(".enox-alternate-carryOver"),this._primaryItemAlternatesModalBodyDiv=this._carryOverAlternatescontainer.querySelector(".enox-alternate-carryOver-body"),this._primaryItemAlternatesModalBody=UWA.createElement("div",{class:"enox-alternate-carryOver-grid-view"}).inject(this._primaryItemAlternatesModalBodyDiv),this.buildContentModel()},renderAlternatesDialog:function(){var e=this;e.getAlternatesOfStructureUnderContextItem().then((function(t){e._initDivs(),e.buildAlternatesDialog(t)}))},renderAlternatesDialogOnCarryOver:function(e){var t=this;t.getCarriedAlternatesOfStructureUnderContextItem(e).then((function(e){t._initDivs(),t.buildAlternatesDialog(e),s.unmask(t.altOptions.getAltFacetMainContainer())}))},buildAlternatesDialog:function(e){var t=this,n=t.altOptions.altAppCore.altSettingsManager.getCommand(N.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES),a=n[N.CONSTANT_CARRYOVER_ALTERNATES_COLUMNS_INFO],i=n[N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_OPTIONS],o=A._getDataGridColumns(a,t.altOptions.altAppCore);t.AlternatesCarryOverRevisionsModel=new r({});var s=[];Array.isArray(e)&&e.forEach((e=>{s.push(d.createAlternateCarryOverItems(e))})),t.AlternatesCarryOverRevisionsModel.addRoot(s),t.alternatContextGridView=t.altOptions.createDataGridView(t.AlternatesCarryOverRevisionsModel,o,i),t.enableClickEvents(t.alternatContextGridView),t.alternatContextGridView.inject(t._primaryItemAlternatesModalBody)},enableClickEvents:function(e){e.dsModel.addEventListener("click",(function(e,t){if(null!=t&&t.nodeModel&&e.dsModel.layout.getDataIndexFromColumnIndex(t.columnID)==N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_INSTANCE_TITLE){var n=t.nodeModel.options[N.CONSTANT_ALT_REF_PHYSICALID];if(!Array.isArray(n))return;c.createsuggestionReferenceModel({Alt_ref_ids:n,title:t.nodeModel.getLabel(),usagesInfo:!1})}}))},buildContentModel:function(){var e=this,n=new t;return n.inject(e.altOptions.getAltFacetMainContainer()),e.alternatesDialog=new i({title:u.get("eng.alternate.carryOver.existingAlternates.from").replace("$1",this.altOptions.selectedNode[0].getDisplayName()),content:this._primaryItemAlternatesModal,className:"alternate-revisions-model",immersiveFrame:n,resizableFlag:!0,width:800,height:550,position:{at:"center",my:"center"},modalFlag:!0,touchMode:!0,buttons:{SaveAll:new a({label:u.get("eng.alternate.carryOver.close.label"),onClick:function(e){e.dsModel.dialog.close()}})}}),e.alternatesDialog},getCarriedAlternatesOfStructureUnderContextItem:function(e){var t=this;return o.wrappedWithCancellablePromise((function(n,a){t.altAppCore.altDataServices.getParentPointedAlternateReferenceIds(e).then((function(e){var a=e.referenceIds;if(!(a&&Array.isArray(a)&&a.length>0))return n();var i=e[N.CONSTANT_KEY_REFERENCE_IDS];if(!i||0==i.length)return n();var r={};r[N.CONSTANT_CARRYOVER_ALT_REF_PHYSICALID]=e[N.CONSTANT_KEY_REFERENCE_IDS];var o=t.altAppCore.altSettingsManager.getCommand("alternate_properties");l.perform(o,r).then((function(e){var a=t.buildAlternatesNodeDB(e[N.CONSTANT_ALT_INFO]);return n(a)})).catch((function(e){return s.unmask(t.altOptions.getAltFacetMainContainer()),console.log(e),n()}))})).catch((function(e){return s.unmask(t.altOptions.getAltFacetMainContainer()),n()}))}))},getAlternatesOfStructureUnderContextItem:function(){var e=this;return o.wrappedWithCancellablePromise((function(t,n){e.altAppCore.altDataServices.getParentPointedAlternateReferenceIds(e.altOptions.selectedNode[0].getID()).then((function(n){var a=n.referenceIds;if(a&&Array.isArray(a)&&a.length>0){var i=n[N.CONSTANT_KEY_REFERENCE_IDS];if(!i||0==i.length)return t();var r=e.altAppCore.altDataServices.getCVServletPayload(i);r[N.CONSTANT_KEY_TYPE_REF_FILTER].push(N.RELATIONSHIP_ALTERNATE_OF),T.doExpand(r,{executor:"cv_expand_v2"},e).then((function(n){var a=e.parsedataForAlternatesDailog(T.parsedExpandV2Result(n));return t(a)})).catch((function(e){return _.errorAlert(e.response),t()}))}else e.altOptions.CarryOverRevisions.renderRevisionsDialog()})).catch((function(e){return t()}))}))},updateNodeWithPrimaryItemInfo:function(e,t){return e[N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PRIMARY_ITEM_TITLE]=t[N.CONSTANT_DS_LABEL]+" "+t[N.CONSTANT_DS_REVISION],e[N.CONSTANT_REF_ID]=t[N.CONSTANT_KEY_PHYSICALID],e},parsedataForAlternatesDailog:function(e){var t=this,n=e.nodes,a=e.paths,i={},r=[],o={};return Array.isArray(a)||console.log("Wrong Response for carry Over"),a.forEach((function(e){if(!Array.isArray(a)||3!=e.length)return;let r=n[e[0]],s=n[e[1]],l=n[e[2]],T=r[N.CONSTANT_KEY_PHYSICALID],A=i[T]?i[T]:{};if(s[N.CONSTANT_KEY_TYPE]!=N.RELATIONSHIP_ALTERNATE_OF){if(A[N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_ALTERNATE_TITLE_DATAINDEX]=l[N.CONSTANT_DS_LABEL],A[N.CONSTANTS_KEY_ICONS]=l[N.CONSTANTS_KEY_ICONS],A[N.CONSTANT_REVISION]=l[N.DS6W_REVISION],A[N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PART_NUMBER]=l[N.DS6W_PARTNUMBER],A[N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY]=l[N.CONSTANT_CURRENT],A[N.CONSTANT_STATUS]=r[N.CONSTANT_CURRENT],A[N.CONSTANT_ALT_ID]=l[N.CONSTANT_KEY_PHYSICALID],A[N.CONSTANT_ALT_REF_PHYSICALID]=r[N.CONSTANT_KEY_PHYSICALID],A[N.Element_2_PhysicalId]=s[N.Element_2_PhysicalId],i[T]=A,A[N.CONSTANT_ALT_ID]&&A[N.CONSTANT_REF_ID]){let e=A[N.CONSTANT_ALT_ID]+"/"+A[N.CONSTANT_REF_ID];c=o[e];if(A[N.Element_2_PhysicalId])(d=c&&Array.isArray(c[N.CONSTANT_ALT_REF_PHYSICALID])?c[N.CONSTANT_ALT_REF_PHYSICALID]:[]).push(A[N.CONSTANT_ALT_REF_PHYSICALID]),A[N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_INSTANCE_TITLE]=d.length,A[N.CONSTANT_ALT_REF_PHYSICALID]=d;o[e]=A}}else if(i[T]=t.updateNodeWithPrimaryItemInfo(A,l),A[N.CONSTANT_ALT_ID]&&A[N.CONSTANT_REF_ID]){let e=A[N.CONSTANT_ALT_ID]+"/"+A[N.CONSTANT_REF_ID];var d,c=o[e];if(A[N.Element_2_PhysicalId])(d=c&&Array.isArray(c[N.CONSTANT_ALT_REF_PHYSICALID])?c[N.CONSTANT_ALT_REF_PHYSICALID]:[]).push(A[N.CONSTANT_ALT_REF_PHYSICALID]),A[N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_INSTANCE_TITLE]=d.length,A[N.CONSTANT_ALT_REF_PHYSICALID]=d;o[e]=A}})),Object.keys(o).forEach((function(e){r.push(o[e])})),r},buildAlternatesNodeDB:function(e){var t=[],n={};return Array.isArray(e)&&e.length>0&&e.forEach((function(e){var t={};e[N.CONSTANT_ALT_REF_PHYSICALID];t[N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PRIMARY_ITEM_TITLE]=e[N.CONSTANT_PRIMARY_ITEM_TITLE]+" "+e[N.CONSTANT_PRIMARY_ITEM_REVISION],t[N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_ALTERNATE_TITLE_DATAINDEX]=e[N.CONSTANT_ALTERNATE_ITEM_TITLE],t[N.CONSTANTS_KEY_ICONS]=e[N.CONSTANTS_KEY_ICONS],t[N.CONSTANT_REVISION]=e[N.CONSTANT_ALTERNATE_ITEM_REVISION],t[N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PART_NUMBER]=e[N.CONSTANT_PARTNUMBER],t[N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY]=e[N.CONSTANT_CURRENT],t[N.CONSTANT_STATUS]=e[N.CONSTANT_STATUS],t[N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY]=e[N.CONSTANT_DATAGRID_MATURITY_STATE],t[N.CONSTANT_ALT_ID]=e[N.CONSTANT_ALT_ID],t[N.CONSTANT_REF_ID]=e[N.CONSTANT_REF_ID],t[N.CONSTANT_ALT_REF_PHYSICALID]=[e[N.CONSTANT_ALT_REF_PHYSICALID]],t[N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_INSTANCE_TITLE]=e[N.CONSTANT_INSTANCE_CONTEXT_TITLE]?1:"";let a=t[N.CONSTANT_ALT_ID]+"/"+t[N.CONSTANT_REF_ID];var i=n[a];if(i){var r=i[N.CONSTANT_ALT_REF_PHYSICALID]?i[N.CONSTANT_ALT_REF_PHYSICALID]:[];r.push(e[N.CONSTANT_ALT_REF_PHYSICALID]),t[N.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_INSTANCE_TITLE]=r?r.length:1,t[N.CONSTANT_ALT_REF_PHYSICALID]=r}n[t[N.CONSTANT_ALT_ID]+"/"+t[N.CONSTANT_REF_ID]]=t})),Object.keys(n).forEach((function(e){t.push(n[e])})),t}})})),define("DS/ENOXAlternateSubstitute/views/PrimaryItemListModel",["DS/ENOXAlternateSubstitute/views/PrimaryItemModel","DS/ENOXEngineerCommonUtils/PromiseUtils","UWA/Core"],(function(e,t,n){function a(t){this.options={instanceId:""},this.options=n.extend(this.options,t),e.call(this,this.options)}return a.prototype=Object.create(e.prototype),a.prototype.getRelationID=function(){return this.options.instanceId},a.prototype.getInstanceName=function(){return this.options.grid["ds6w:label-Instance"]},a.prototype.getInstanceTypeNLS=function(){return this.options.grid.instanceTypeNLS?this.options.grid.instanceTypeNLS:this.options.instanceType},a})),define("DS/ENOXAlternateSubstitute/services/PrimaryItemsFactory",["UWA/Class","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants"],(function(e,t,n,a,i){"use strict";return e.singleton({initialize:function(e){this.options=e},buildParent:function(e){var t=this.basicOptionsBuilder(e);return t.children=e.children,t},buildChild:function(e){var t=this.retrieveNodeData(e);return this.basicOptionsBuilder(t),this.addInstanceOptionsBuilder(t)},retrieveNodeData:function(e){var t=e.instanceOf;return t.instanceId=e[i.PHYSICAL_ID],t[i.CONSTANT_ENG_ITEM_INSTANCE]=e[i.DS6W_LABEL],t.instanceType=e[i.CONSTANT_TYPE],t.instanceTypeNLS=this.options._alternateView.altAppCore.altDataServices.ds6wClassPropNls[i.DS6W_TYPE][e[i.CONSTANT_TYPE]],t},addInstanceOptionsBuilder:function(e){return this.rowOptions.instanceId=e.instanceId,this.rowOptions.instanceType=e.instanceType,this.rowOptions},basicOptionsBuilder:function(e){var n=this,a=i.CONSTANT_DS_PART;return a=e[i.CONSTANT_DS_GLOBAL_TYPE]?e[i.CONSTANT_DS_GLOBAL_TYPE]:e[i.CONSTANT_TYPE],this.rowOptions={type:e.type,isCut:!1,quantity:1,tenant:t.getTenant(),label:e[i.DS6W_LABEL],grid:{},padgrid:{"ds6w:globalType":a},showMoreInfo:!0,attributes:[],referenceId:e.physicalid},Object.keys(e).forEach((function(t){n.rowOptions.grid[t]=e[t]})),this.rowOptions},checkIfSameInstance:function(e,t){let n=!0;return(e.length>1||t.length>1)&&(n=!1),n},getPayload:function(e,t){var n={};return e.length&&(n.instanceIds=e),t.length&&(n.referenceIds=t),n},getAlternateFacetReadWriteAccess:async function(e){let t=null;try{t=await n.perform(e)}catch(e){t=e,console.error(e)}if(!t.hasOwnProperty("error"))return t;var i=t.response&&t.response.error.errorMessage?t.response.error.errorMessage:t.error;return a.errorAlert(i),{}},fetchUserSelectedNodeInfo:async function(e,t){let i=null;try{i=await n.perform(e,t)}catch(e){i=e,console.error(e)}if(!i.hasOwnProperty("error"))return i;var r=i.response&&i.response.error.errorMessage?i.response.error.errorMessage:i.error;return a.errorAlert(r),{}},buildInstanceNodeData:function(e){let t={},n={physicalid:e[i.PHYSICAL_ID],"ds6w:label":e[i.CONSTANT_PLM_EXTERNALID],type:e[i.CONSTANT_TYPE]},a={Parent:[{physicalid:e[i.CONSTANT_FROM_PHYSICALID],"ds6w:label":e[i.CONSTANT_FROM_V_NAME],"ds6wg:revision":e[i.CONSTANT_FROM_REVISION],revision:e[i.CONSTANT_FROM_REVISION]}],Child:[{physicalid:e[i.CONSTANT_TO_PHYSICALID],"ds6w:label":e[i.CONSTANT_TO_V_NAME],"ds6wg:revision":e[i.CONSTANT_TO_REVISION],"ds6w:globalType":e[i.CONSTANT_KINDOF_VPMINSTANCE]==i.CONSTANT_TRUE?i.CONSTANT_DS_PART:e[i.CONSTANT_TYPE],revision:e[i.CONSTANT_TO_REVISION]}]};return t[i.CONSTANT_INPUT_OBJECT]=n,t[i.CONSTANT_OUTPUTS]=a,t},buildReferenceNodeData:function(e){let t={},n=this.parseReferenceNodeData(e);return t[i.CONSTANT_INPUT_OBJECT]=n,t},buildReferenceChildNodeData:function(e,t){let n={},a={Parent:[this.parseReferenceNodeData(t)],Child:[this.parseReferenceNodeData(e)]};return n[i.CONSTANT_OUTPUTS]=a,n},parseReferenceNodeData:function(e){return{physicalid:e[i.PHYSICAL_ID],current:e[i.CONSTANT_CURRENT],"ds6w:label":e[i.CONSTANT_V_NAME],"ds6wg:revision":e[i.CONSTANT_REVISION],"ds6w:globalType":e[i.CONSTANT_KINDOF_VPMREFERENCE]==i.CONSTANT_TRUE?i.CONSTANT_DS_PART:e[i.CONSTANT_TYPE],revision:e[i.CONSTANT_REVISION],type:e[i.CONSTANT_TYPE]}}})})),define("DS/ENOXAlternateSubstitute/facets/GenericAlternateFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/EditPropWidget/facets/Common/FacetsBase","DS/ENOXAlternateSubstitute/views/PrimaryItemModel","DS/ENOXAlternateSubstitute/views/PrimaryItemListModel","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOXAlternateSubstitute/services/PrimaryItemsFactory","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants"],(function(e,t,n,a,i,r,o,s,l,T){"use strict";return t.extend(n,a,{init:function(t){this._parent(t);this.elements.container||(this.elements.container=e.createElement("div",{class:"alternateSubstitute"})),this.appCore=this.options.appContext},_buildView:function(){var e=this;if(!e.getModel())return!1;if(s.initialize(this),!e._alternateView){var t=o.getCommand("getUserSelectedPrimaryItemConfigurations"),n={};l.perform(t,"").then((function(e){n=e})).finally((function(){require(["DS/ENOXAlternateSubstitute/commands/AlternateFacetContentBuilder"],(function(t){e._alternateView=new t({readOnly:e.options.readOnly,authoringAllowed:"True"==e.readWriteAccessOnFacet.AuthoringAccessAssigned,model:e.getModel(),activeEngItemTreeInfo:e.getXenTreeInfo(),viewInfo:e.getViewInfo(),alternateManagementConfigurations:n,altfacetContainer:widget.body}),e._alternateView.elements.container.inject(e.elements.container),e._alternateView.resizeToolbar(),e.refreshFacetView()}))}))}},updateFacet:async function(){var e=this,t=o.getTenant();if(t&&"string"==typeof t&&o.setPlatformId(t),e._alternateView)e.refreshFacetView();else{let t=o.getCommand("get_AlternatesFacetPreprocessInfo");e.readWriteAccessOnFacet=await s.getAlternateFacetReadWriteAccess(t),e._buildView()}return e.elements.container},refreshFacetView:async function(){var e=this;e._alternateView.options.activeEngItemTreeInfo=await e.getXenTreeInfo(),e._alternateView.options.viewInfo=e.getViewInfo(),"True"!==e.readWriteAccessOnFacet.ReadAccessAssigned&&"True"!==e.readWriteAccessOnFacet.AuthoringAccessAssigned?this._alternateView.notApplicable("notSupported"):0==e._alternateView.options.activeEngItemTreeInfo._selectedNodes.length?(console.error("Wrong number of selected object "+e._alternateView.options.activeEngItemTreeInfo._selectedNodes.length),this._alternateView.notApplicable("noObjectSelected")):e._alternateView.options.activeEngItemTreeInfo._selectedNodes[0].isEngineeringItem()?e._alternateView.selectionModified(e._alternateView.options.activeEngItemTreeInfo._selectedNodes,e._alternateView.options.activeEngItemTreeInfo._parentNode,e._alternateView.options.activeEngItemTreeInfo._selectedNodeId):this._alternateView.notApplicable("notSupported")},getXenTreeInfo:async function(){var e={},t=await this.getXENTreeDoc();e._selectedNodeId=t&&t[0]?t[0].getID():null,e._selectedNodes=t||null,e._parentNode=e._selectedNodes&&e._selectedNodes[0]&&e._selectedNodes[0].getParent&&e._selectedNodes[0].getParent()?e._selectedNodes[0].getParent():e._selectedNodes?e._selectedNodes[0]:null,e._parentId=e._parentNode?e._parentNode.getID():null;var n=e._parentNode&&e._parentNode.getPreferedAttachedConfigModel?e._parentNode.getPreferedAttachedConfigModel():null;return e._configModelVersionID=null!=n&&n._options.preferedVersion?n._options.preferedVersion.id:null,e},getViewInfo:function(){var e={_isReferenceView:!1,_isFlatennedView:!1,_isFlatView:!1,_isGroupByView:null,_isReferenceOrFlattenedORGroupView:!1,_isReferenceORGroupView:!1};return e},getXENTreeDoc:async function(){var e=this.getOccurrence().getSharedInformationForFacet().infoForFacet.alternateFacetInfo;if(e){var t,n={},a={},l=[];let C={};var A=[],d=[],N=[],c=[];for(let t of e)t[T.CONSTANT_METATYPE]==T.CONSTANT_RELATIONSHIP?(A.push(t[T.CONSTANT_PROPERTIES_OBJECT_ID]),N.push(t[T.CONSTANT_SELREFERENCEID]),c.push(t[T.CONSTANT_PARENTID])):t[T.CONSTANT_METATYPE]==T.CONSTANT_BUSINESS_OBJECT&&(d.push(t[T.CONSTANT_PROPERTIES_OBJECT_ID]),a[t[T.CONSTANT_PROPERTIES_OBJECT_ID]]=t[T.CONSTANT_PROPERTIES_OBJECT_ID],t[T.CONSTANT_PARENTID]&&(d.push(t[T.CONSTANT_PARENTID]),n[t[T.CONSTANT_PROPERTIES_OBJECT_ID]]=t[T.CONSTANT_PARENTID]),N.push(t[T.CONSTANT_PROPERTIES_OBJECT_ID]),c.push(t[T.CONSTANT_PARENTID]));if(!s.checkIfSameInstance([...new Set(N)],[...new Set(c)]))return this._alternateView.notApplicable("multipleSelection"),[];C=s.getPayload(A,d);var _=o.getCommand("get_AlternatesFacetUserSelectedNodeInfo"),u=await s.fetchUserSelectedNodeInfo(_,C);if("success"==u.status){if(u.instanceIds)for(let e of A){let n=s.buildInstanceNodeData(u.instanceIds[e]);var S=s.buildParent(n.outputs.Parent[0]);t=new i(S);let a=structuredClone(n.input_object);a.instanceOf=structuredClone(n.outputs.Child[0]);let o=s.buildChild(a);l.push(new r(o)),t.addChild(l)}if(u.referenceIds)for(let e of d)if(n[e]){let a=s.buildReferenceChildNodeData(u.referenceIds[e],u.referenceIds[n[e]]);S=s.buildParent(a.outputs.Parent[0]);t=new i(S);let r=structuredClone(a.outputs.Child[0]),o=s.buildParent(r);l.push(new i(o)),t.addChild(l)}else if(a[e]){let t=s.buildReferenceNodeData(u.referenceIds[e]),n=s.buildParent(t.input_object);l.push(new i(n))}}return l}return[]},destroyComponent:function(){e.is(this.destroy,"function")&&this.destroy()}})})),define("DS/ENOXAlternateSubstitute/components/AlternateToolBar",["DS/UIKIT/Iconbar","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n){"use strict";function a(e){this.alternateCollectionToolBarModelEvents=e.modelEvents,this.toolbarContainer=this.createActionBarWrapper(),this.toolbarContainer.inject(e.container,"top"),this.altAppCore=e.ListView.altAppCore}return a.prototype.createActionBarWrapper=function(){return this.toolBarContainer=UWA.createElement("div",{id:"listview-toolbar",styles:{height:"40px",width:"100%"}}),this.toolBarActionsContainer=UWA.createElement("div",{class:"enox-alternate-toolbar-actions"}).inject(this.toolBarContainer),this.toolBarContainer},a.prototype.getToolBarActionCommands=function(){return this.options.actions},a.prototype.AddToolbarCommand=function(e){return null!=this._actionsIconBar&&this._actionsIconBar.addItem({id:e.id,fonticon:e.fonticon,className:e.className,text:e.text,handler:e.handler,selected:!1,allowSelectRetain:e.allowSelectRetain,disabled:e.disabled}),this},a.prototype.AddToolbarCommands=function(e){if(!Array.isArray(e))throw new Error("invalid input for AddToolbarCommands ");this.initializeIconbar();var t=this;return e.forEach((function(e){(t.altAppCore.altSettingsManager.isAuthoringAllowed()||e.readOnlyFacetVisibilty)&&t.AddToolbarCommand(e)})),t.altAppCore.altSettingsManager.isAuthoringAllowed()&&t.renderMultiselection(),this},a.prototype.renderMultiselection=function(){this.currentNbSelections=0,this._multiActionIcon=this.toolBarActionsContainer.querySelector("#MultiSelect"),this._multiActionIcon.getChildren()[0].setAttribute("id","alternate-select-on-multiSelect-action");var e=document.createElement("sub");e.setAttribute("class","enox-alternate-toolbar-multiselect-count"),this.numberOfSelection=document.createTextNode(""),this._updateIconMultiselectNumber(this.currentNbSelections),e.appendChild(this.numberOfSelection),this._multiActionIcon.appendChild(e);var t=document.createElement("span");t.setAttribute("class","fonticon fonticon-chevron-down"),t.setAttribute("id","alternate-down-chevron-multi-action"),this._multiActionIcon.appendChild(t),t.style.paddingLeft="8px"},a.prototype._updateIconMultiselectNumber=function(e){this.currentNbSelections=e,e>9999?(this.numberOfSelection.nodeValue=">9999",this._multiActionIcon.getChildren()[0].setAttribute("class","fonticon fonticon-select-on")):0===e?(this.numberOfSelection.nodeValue="",this._multiActionIcon.getChildren()[0].setAttribute("class","fonticon fonticon-select-off")):(this.numberOfSelection.nodeValue=e,this._multiActionIcon.getChildren()[0].setAttribute("class","fonticon fonticon-select-on"))},a.prototype.initializeIconbar=function(){this._actionsIconBar=new e({renderTo:this.toolBarActionsContainer,tooltipsTrigger:"touch"})},a})),define("DS/ENOXAlternateSubstitute/services/AlternateDicoServices",["UWA/Core","DS/ENOXAlternateSubstitute/views/AlternateGridViewManager","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXEngineerCommonUtils/XENMask","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/FedDictionaryAccess/FedDictionaryAccessAPI","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n,a,i,r,o,s){"use strict";return{initialize:function(e){this.altOptions=e.altOptions,this.options=e.options,this.mappingMultiValuatedAttributes=[],this.mappingRangeValueAttributes=[],this.mappingPredicateAttributes={},this.interchangeabilityTypes=[],this.getTypesForClass(),this.retrieveDicoCusto(),this.additionalColumnsAndBOs={}},restoreCustomViews:async function(e,t){await this.updateColumnDefinition();let n=e.customViews,a=e.currentCustomViewId;t.activeDataGridView.loadCustomViews(n,a),t.activeDataGridView.reapplySortModel(),t.activeDataGridView.sortModel=Array.isArray(e.columnsSortModel)?e.columnsSortModel:[],t.activeDataGridView.reapplySortModel(),this.applyCustomAttributes(n,a,t),this.additionalColumnsAndBOs.additionalColumns||(this.updateAdditionalColumnsAndBOs(),this.altOptions._updateAlternateItemView(this.options.activeEngItemTreeInfo._selectedNodes[0]))},updateAdditionalColumnsAndBOs:function(){let e=this.altOptions.alternateGridView.dsModel.columns,t=[],n=[];if(e.length)for(let a of e)if(a.children)for(let e of a.children)e.dataIndex.includes("ds6w")&&1==e.visibleFlag&&(t.push(e.dataIndex),n.push(e));else a.dataIndex.includes("ds6w")&&1==a.visibleFlag&&(t.push(a.dataIndex),n.push(a));this.additionalColumnsAndBOs.additionalColumns=n,this.additionalColumnsAndBOs.additionalBOs=t},updateColumnDefinition:async function(){let e=this,n=e.altOptions.alternateGridView.dsModel,a=[...e.altOptions.alternateGridView.dsModel.columns],i=[],o=[],l=[],T=await e.getTypesForClass();if(T){let t=await e.getInterfacesForClass(T);t&&t.results&&(t.results.forEach((function(e){for(let t of e.interfaces)o.push(t.name)})),o=[...new Set(o)])}T=[...T,...o],e.interfaces=[...new Set(T)];let A=e.altOptions.altAppCore.altSettingsManager.getConfiguration("nlsPropValue");A["ds6w:type"]=[...new Set([...T,...A["ds6w:type"]])];let d=await e.altOptions.altAppCore.altDataServices.getNlsOfPropertiesValues(A);for(let e of T)i.push({ds6w:"ds6wg:"+e,NLS:d["ds6w:type"][e]});if(i.length>0){var N=await e.getPropertyForClassGrid(T);if(N&&"[object Error]"!==Object.prototype.toString.call(N)){for(var c=N.classPredicates,_=0;_<i.length;_++)for(var u=0;u<c.length;u++){var S=c[u];if(i[_].ds6w===S.className){for(var C=[],g=S.vocabularyPredicateInfo,E=0;E<g.length;E++){var O=g[E];let n="";switch(O.range.dataTypes[0].substring(O.range.dataTypes[0].indexOf("#")+1)){case"string":default:n="string";break;case"boolean":n="boolean";break;case"integer":case"real":case"number":n="number";break;case"dateTime":case"timestamp":n="datetime"}O.kind=n;let a={dataIndex:O.uri,text:O.nlsName,editableFlag:!1,allowUnsafeHTMLContent:!1,range:O.hasOwnProperty("rangeValues"),visibleFlag:!1,dataType:n,nature:O.nature};("basic"==O.nature||"attribute"==O.nature||O.hasOwnProperty("userAccess")&&"ReadWrite"==O.userAccess)&&(a.editableFlag=!(e.isPredicateAttribute(O.uri,O.name)||e.isMultiValuedAttribute(O.uri,O.name)||"basic"==O.nature||"ReadWrite"!=O.userAccess||!e.altOptions.altAppCore.altSettingsManager.isAuthoringAllowed()),a.editionPolicy="EditionOnDoubleClick",a.dbName=O.selectable,a.name=O.name,t.addDefaultCustomColumnCallback(a,O),C.push(a)),a=null}var p={dataIndex:i[_].ds6w,text:i[_].NLS,visibleFlag:!1,children:C};l.push(p),p=null;break}}let r=e.removeAndGetcommonPredicatesFromAllTypes(l,a),o=!1;for(let t of r)e.isColumnAlreadyExist(n.columns,t)||n.addColumnOrGroup(t),this.altOptions.customStringDefault.push(t.dataIndex),o=!0;for(let t of l)!e.isColumnAlreadyExist(n.columns,t)&&t.children.length&&(n.addColumnOrGroup(t),o=!0)}else r.errorAlert(s.get("eng.alternate.custom.attr.fed.service.down"))}},applyCustomAttributes:async function(e,t,n){t=t||"Default View";let a=n.activeDataGridView,i=[];if(a.treeDocument.getAllDescendants().length>0){e.forEach((e=>{if(e.identifier==t){let t=e.columnsVisibleFlag;t&&(i=Object.keys(t).filter((e=>t[e])))}}));let n=[...this.altOptions.altAppCore.altGridViewManager.defaultColumnIndexes,...i];const r=this.getCustoColsDef(a,i).filter((e=>0!=e.filterableFlag));let o=a.treeDocument.getFilterManager().filterModel,s=this.altOptions.getCustomFilterModel(r);Object.keys(o).forEach((e=>{n.includes(e)||"label"===e||delete o[e]})),Object.keys(s).forEach((e=>{o[e]||(o[e]=s[e])})),a.treeDocument.setFilterModel(o)}},getCustoColsDef:function(e,t){let n=new Array;for(let a=0;a<e.columns.length;a++){let i=e.columns[a];if(t.includes(i.dataIndex))n.push(i);else if(i.children)for(let e=0;e<i.children.length;e++){let a=i.children[e];t.includes(a.dataIndex)&&n.push(a)}}return n},isMultiValuedAttribute:function(e,t){return this.getMultiValuedAtributes().find((function(n){return e===n.ds6w||t===n.Name}))},getMultiValuedAtributes:function(){return this.mappingMultiValuatedAttributes},isPredicateAttribute:function(e,t){let n=this,a=0;return this.getPredicateAtributes()[e]&&n.interfaces.forEach((t=>{a=n.getPredicateAtributes()[e][t]?a+n.getPredicateAtributes()[e][t].length:a})),a>1},getPredicateAtributes:function(){return this.mappingPredicateAttributes},isColumnAlreadyExist:function(e,t){let n=!1;for(let a=0;a<e.length;a++)if(e[a].dataIndex===t.dataIndex||e[a].uri===t.dataIndex){if(n=!0,e[a].children&&e[a].children.length||t.children&&t.children.length)if("ds6wg:Alternate Reference"==e[a].dataIndex&&e[a].children.length-5!=t.children.length)n=!1;else if("ds6wg:Alternate Reference"!=e[a].dataIndex&&e[a].children.length!=t.children.length)n=!1;else for(let i=0;i<t.children.length;i++){if(!e[a].children.find((e=>e.dataIndex==t.children[i].dataIndex||e.uri==t.children[i].dataIndex))){n=!1;break}}break}return n},getPropertyForClassGrid:function(e){let t=this;return new Promise((function(n,a){let i={tenantId:t.altOptions.altAppCore.altSettingsManager.getPlatformId(),lang:t.altOptions.altAppCore.altSettingsManager.getLanguage(),onComplete:function(e){n(e)},onFailure:function(e){n(e)}};o.getPropertiesForClass(e,i)}))},uniqueBy:function(e,t){return[...new Map(e.map((e=>[t(e),e]))).values()]},getTypesForClass:function(){var e=this;return n.wrappedWithCancellablePromise((function(t,n){var a=e.altOptions.altAppCore.altSettingsManager.getCommand("cust_attribute_type");i.perform(a,["Alternate Reference"]).then((function(n){let a=[...Object.keys(n)];e.interchangeabilityTypes=[...a],t(a)})).catch((function(n){r.errorAlert(n.response.error.Message);let a=["Alternate Reference"];e.interchangeabilityTypes=[...a],t(a)}))}))},getInterfacesForClass:function(e){var t=this;return n.wrappedWithCancellablePromise((function(n,a){var o={classes:e},s=t.altOptions.altAppCore.altSettingsManager.getCommand("cust_attribute_interface");i.perform(s,o).then((function(e){n(e)})).catch((function(e){r.errorAlert(e.response.error.Message),n({})}))}))},removeAndGetcommonPredicatesFromAllTypes:function(e,t){let n=this;for(let t of e)t.children=n.uniqueBy(t.children,(e=>e.dataIndex));for(let t=0;t<e.length;t++)for(let n=0;n<e[t].children.length;n++){let a=e[t].children[n],i=!1;for(let n=0;n<e.length;n++)if(n!==t)for(let t=0;t<e[n].children.length;t++)if(a.dataIndex===e[n].children[t].dataIndex||UWA.is(e[n].children[t].ds6wIndexMapping)&&a.dataIndex===e[n].children[t].ds6wIndexMapping){i=!0,e[n].children.splice(t,1);break}}return[]},getRangeValueAttribute:function(e,t){if("string"!=typeof e||!e.trim().length)return null;const n=this.getRangeValueAttributes().filter((n=>e===n.ds6w||t===n.Name));if(n.length){const t=n.reduce(((e,t)=>(e.type=t.type||t.Type,e.AuthorizedValues.push(...t.AuthorizedValues),e)),{AuthorizedValues:[]});return{ds6w:e,HasRangeDefined:"Yes",AuthorizedValues:[...new Set(t.AuthorizedValues)],type:t.type.toLowerCase()}}return null},getRangeValueAttributes:function(){return this.mappingRangeValueAttributes||[]},retrieveDicoCusto:function(){var e=this;return n.wrappedWithCancellablePromise((function(t,n){var a=e.altOptions.altAppCore.altSettingsManager.getCommand("dictionary_custo"),r=Object.assign({},a);r.url=r.url.replace("{displayAttributes}","true"),i.perform(r).then((function(n){e._completeMappingPredicateWithDico(n),t(n)})).catch((function(e){console.error(e),n(e)}))}))},_completeMappingPredicateWithDico:function(e){if(e&&e.Dictionary&&e.Dictionary.Interfaces){const t=e.Dictionary.Interfaces;for(let e in t){const n=t[e].ScopeTypes?t[e].ScopeTypes:t[e].ScopeRelationships;let a=this.retreiveParentTypesAttributes(e,t);this._completeMappingPredicateForTypes(n,a)}const n=e.Dictionary.Types;for(let e in n){let t=this.retreiveParentTypesAttributes(e,n);this._completeMappingPredicateForTypes([e],t)}const a=e.Dictionary.Relationships;for(let e in a){let t=this.retreiveParentTypesAttributes(e,a);this._completeMappingPredicateForTypes([e],t)}}},retreiveParentTypesAttributes:function(e,t){let n={};if(e&&t){let a=e;for(;t[a]&&t[a].Attributes&&(n=Object.assign(n,t[a].Attributes),t[a].Parent);)a=t[a].Parent}return n},_completeMappingPredicateForTypes:function(e,t){if(Array.isArray(e)&&t){var n=this;for(let a in t){let i=t[a].SixWPredicate;const r=t[a].Owner,o=t[a].Name;i||(i=`ds6wg:${r?`${r}.${o}`:o}`),i&&e.forEach((e=>{t[a].ds6w=i,"Yes"===t[a].MultiValuated&&n.mappingMultiValuatedAttributes.push(t[a]),"Yes"===t[a].HasRangeDefined&&n.mappingRangeValueAttributes.push(t[a]),t[a].SixWPredicate&&(this.mappingPredicateAttributes[t[a].SixWPredicate]?this.mappingPredicateAttributes[t[a].SixWPredicate][t[a].Owner]?this.mappingPredicateAttributes[t[a].SixWPredicate][t[a].Owner].push(t[a]):this.mappingPredicateAttributes[t[a].SixWPredicate][t[a].Owner]=[t[a]]:this.mappingPredicateAttributes[t[a].SixWPredicate]={[t[a].Owner]:[t[a]]})}))}}},filterAndUpdateColumnsState:function(e,t){if(Array.isArray(e)){var n=this.getAdditionalColumns(t).map((function(e){return e.dataIndex}));return e=e.filter((function(e){for(var t=0;t<n.length;t++){const a=n[t];if(e.attributeRemoteLoadingNotStart&&e.attributeRemoteLoadingNotStart(a))return!0}return!1})),this.altOptions.alternateModel.withTransactionUpdate((function(){e.forEach((function(e){var t={};n.forEach((function(n){e.attributeRemoteLoadingNotStart(n)&&(t[n]="#loading#")})),e.updateOptions({grid:t})}))})),e}},loadAChunk:function(e,t){var a=this;return n.wrappedWithCancellablePromise((function(i,r){if(0===(e=a.filterAndUpdateColumnsState(e,t)).length)return i();a.getColumnsProvidersDefinitionByPolicy(t).map((function(t){var i={},r=t.instance;return e.forEach((function(e){e.isGroupingNode||(!t.isTargetingOnlyInstance||e.getViewType&&"reference"!==e.getViewType())&&function(e,t,n){for(var i=n.getManagedColumnNames(),r={},o=0;o<i.length;o++){var s=i[o],l=e.isAttributePending(s)?void 0:e.options.grid[s];r[s]=l}if(!0===n.toBeUpdated(r)){void 0===t[n.getName()]&&(t[n.getName()]={pids:[],relids:[],occpaths:[]});var T=e.getInterchangeabilityID();if(-1===t[n.getName()].pids.indexOf(T)&&(e.getUsages&&Array.isArray(e.getUsages())&&e.getUsages().length>=1?e.getUsages().forEach((e=>{let a=e.getInterchangeabilityID(),i=n.getName();-1===t[i].pids.indexOf(a)&&t[i].pids.push(a)})):t[n.getName()].pids.push(T)),e.getRelationID&&"function"==typeof e.getRelationID?t=a.getAdditionalColumnsInfo(e,t,n):e.getUsages&&Array.isArray(e.getUsages())&&e.getUsages().length>=1&&e.getUsages().forEach((e=>{t=a.getAdditionalColumnsInfo(e,t,n)})),e.getOccurrencePath&&"function"==typeof e.getOccurrencePath){var A=e.getOccurrencePath();A&&t[n.getName()].occpaths.push(A)}}}(e,i,r)})),n.wrappedWithPromise((function(t,n){var o=setTimeout((function(){var t=r.getManagedColumnNames();a&&a.altOptions.alternateModel.withTransactionUpdate((function(){e.forEach((function(e){var n={};t.forEach((function(t){(e.isAttributePending(t)||void 0===e.getAttributeValue(t))&&(n[t]="#failed#")})),e.updateOptions({grid:n})}))})),console.warn("timeout reached"),n("timeout")}),6e4);r.updateAttributes(i[r.getName()],(function(n){var i=UWA.is(n,"string")?JSON.parse(n):n;a._applyAttributesInListContent(i,e),t(i),clearTimeout(o)}))}))}))}))},getAdditionalColumnsInfo:function(e,t,n){if(e.isDocument())return t;var a=e.getRelationID();if(a&&(-1===t[n.getName()].relids.indexOf(a)&&t[n.getName()].relids.push(a),e.getFirstLevelInstanceID&&"function"==typeof e.getFirstLevelInstanceID&&"CfgEffectivityColumns"===n.getName())){var i=e.getFirstLevelInstanceID();i&&t[n.getName()].relids.push(i),this._effInstanceIDs.push(a)}return t},_getProvidersForOnlyVisibleAttributes:function(){return this._getProvidersByPolicy("visible")},_getProvidersForWholeContentAttributes:function(){return this._getProvidersByPolicy("whole")},getColumnsProvidersInstancesByPolicy:function(e){return this.getColumnsProvidersDefinitionByPolicy(e).map((function(e){return e.instance}))},getColumnsProvidersDefinitionByPolicy:function(e){var t=null;switch(e){case"visible":t=this._getProvidersForOnlyVisibleAttributes();break;case"whole":t=this._getProvidersForWholeContentAttributes();break;default:t=this.getColumnsProviders()}return t||[]},_getProvidersByPolicy:function(e){return this.getColumnsProviders().filter((function(t){return t.loadingPolicy===e}))},getColumnsProviders:function(){if(Array.isArray(this.additionalColumnsProvidersDef)&&this.additionalColumnsProvidersDef.length>0)return this.additionalColumnsProvidersDef;var e=this.altOptions.altAppCore.altGridViewManager.getLoadedColumnProvidersAsArray();return this.additionalColumnsProvidersDef=e,e},getAdditionalColumns:function(e){var t=[];return this.getColumnsProvidersInstancesByPolicy(e).forEach((function(e){var n=e.getManagedColumnNames();n=n.map((function(e){return{dataIndex:e}})),e.getAdditionalColumnsUX(n),t=t.concat(n)})),t},_applyAttributesInListContent:function(e,t){if(!e)return;let n=[];if(e.hasOwnProperty("relids")){const t=e.relids,a=Object.getOwnPropertyNames(t).map((e=>({instanceId:e,options:{grid:t[e]}})));n=n.concat(a)}if(e.hasOwnProperty("pids")){const t=e.pids,a=Object.getOwnPropertyNames(t).filter((e=>!t[e].Effectivity&&!t[e].ProductConfiguration)).map((e=>({referenceId:e,options:{grid:t[e]}})));n=n.concat(a)}if(e.hasOwnProperty("occpaths")){const t=e.occpaths,a=Object.getOwnPropertyNames(t).map((e=>({occurrenceId:e.split(OccSrv.OccPathSep),options:{grid:t[e]}})));n=n.concat(a)}this.changeSetMerger(n,t)},changeSetMerger:function(e,t){if(!Array.isArray(e))return;let n=this;this.altOptions.alternateModel.prepareUpdate(),e.forEach((function(e){n.updateNodesWithChangeSet(e,t)})),this.altOptions.alternateModel.pushUpdate()},updateNodesWithChangeSet:function(e,t){(t&&t.length?t:this.getAllDescendants()).forEach((t=>{t.updateWithChangeSet(e)}))}}})),define("DS/ENOXAlternateSubstitute/commands/AlternateSuggestionSettings",["UWA/Class","UWA/Core","DS/TreeModel/TreeDocument","DS/Windows/Dialog","DS/TreeModel/TreeNodeModel","DS/Controls/Button","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/Handlebars/Handlebars4","DS/Windows/ImmersiveFrame","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","text!DS/ENOXAlternateSubstitute/views/html/EditSuggestionSettings.html","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","css!DS/ENOXAlternateSubstitute/styles/Alternate.css"],(function(e,t,n,a,i,r,o,s,l,T,A,d){return e.singleton({initialize:function(e){this.options=e,this.altOptions=e.altOptions},createSettingsDialogBox:function(e,n){var i=this,o={ediTHeaderSuggestionOptions:!0,editSettingsNote:!0},T=s.compile(A),N=o?t.clone(o,!1):{},c=t.createElement("div",{class:"enox-alternate-source-wrapper"});c.innerHTML=T(N);var _=c.querySelector(".enox-suggestion-settings-container");c.querySelector(".enox-suggestion-settings-note").innerHTML=d.get("eng.alternate.suggestion.settings.description");var u=new l;u.inject(e.elements.container),this.settingsDialogbox=new a({title:d.get("eng.alternate.suggestion.settings.title"),content:c,immersiveFrame:u,width:300,height:340,touchMode:!0,buttons:{Cancel:new r({label:d.get("eng.alternate.button.cancel"),onClick:function(e){i.settingsDialogbox.immersiveFrame.getModel().elements.container.destroy()}}),Ok:new r({label:d.get("eng.alternate.suggestion.settings.ok"),onClick:function(e){var t={};i.alternateSourceModel.getSelectedNodes().forEach(((e,n)=>{var a=e.options.grid.tree;t[a]=!0})),i.saveSourceOptions(t,n),i.settingsDialogbox.immersiveFrame.getModel().elements.container.destroy()}})}}),i.settingsDialogbox.addEventListener("close",(function(e){i.settingsDialogbox.immersiveFrame.getModel().elements.container.destroy()})),i.getDataGridViewForSettings(_)},getDataGridViewForSettings:function(e){var t=this;this.alternateSourceModel=new n({shouldBeSelected:function(e){return!0}});for(var a=t.altOptions.altAppCore.altSettingsManager.getCommand(T.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[T.CONSTANT_SUGGESTION_SETTINGS_DATA],r=0,o=a.length;r<o;r++){var s=a[r],l=new i({label:s.Title,grid:s});t.alternateSourceModel.addChild(l),(t.options.newSourceSettings&&t.options.newSourceSettings[s.tree]||!t.options.newSourceSettings&&s.tree!=T.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE)&&l.select()}var A=[{text:d.get("eng.alternate.suggestion.settings.header"),dataIndex:"tree",sortableFlag:!0,getCellValue:function(e){return t.altOptions.altAppCore.altItemFactory.getNLSPropertyMap(e.nodeModel.options.grid[T.CONSTANT_SUGGESTION_SOURCE_TITLE])}}],N=t.altOptions.altAppCore.altSettingsManager.getCommand(T.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[T.CONSTANT_SUGGESTION_SETTINGS_COLUMN_OPTIONS];t.alternateSourceGridView=t.options.createDataGridView(t.alternateSourceModel,A,N),t.alternateSourceGridView.dsModel.selectionBehavior.unselectAllOnEmptyArea=!1,t.alternateSourceGridView.dsModel.addEventListener("click",(function(e,n){null!=n&&(-1==n.columnID&&-1==n.rowID&&t.enableDisableSourceSaveButton(),n.nodeModel&&(n.nodeModel.onSelect((function(){t.enableDisableSourceSaveButton()})),n.nodeModel.onUnselect((function(){t.enableDisableSourceSaveButton()}))))})),this.alternateSourceGridView.show(),this.alternateSourceGridView.inject(e)},saveSourceOptions:function(e,t){var n=this;return o.wrappedWithPromise((function(a,i){n.altOptions.altAppCore.altDataServices.setSourceSettings(T.CONSTANT_SUGGESTION_SOURCE_SETTINGS,JSON.stringify(e)).then((function(i){n.options.newSourceSettings=e,t(),a(n.options.newSourceSettings)})).catch((function(e){i(e)}))}))},enableDisableSourceSaveButton:function(){var e=this;e.alternateSourceModel.getSelectedNodes().length>0?e.settingsDialogbox.buttons[T.BUTTON_OK].disabled=!1:e.settingsDialogbox.buttons[T.BUTTON_OK].disabled=!0}})})),define("DS/ENOXAlternateSubstitute/commands/AddSuggestionAlternate",["UWA/Class","UWA/Core","DS/Menu/Menu","DS/TreeModel/TreeDocument","DS/Controls/Find","DS/Windows/Dialog","DS/UIKIT/Iconbar","DS/TreeModel/TreeNodeModel","DS/Controls/Button","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/Handlebars/Handlebars4","DS/Windows/ImmersiveFrame","DS/DataGridView/DataGridView","DS/ENOXEngineerCommonUtils/XENMask","DS/ENOXAlternateSubstitute/components/AlternateFilter","DS/UIKIT/DropdownMenu","DS/ENOXAlternateSubstitute/components/properties/js/PropertiesFacet","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/utils/AlternateDataParser","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","DS/ENOXAlternateSubstitute/views/AlternateGridViewManager","DS/ENOXAlternateSubstitute/commands/GetAlternates","DS/ENOXAlternateSubstitute/utils/AlternateCommands","DS/ENOXAlternateSubstitute/commands/GetSuggestionAlternateUsage","DS/ENOXAlternateSubstitute/commands/AlternateSuggestionSettings","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","text!DS/ENOXAlternateSubstitute/views/html/AddSuggestionAlternate.html","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","css!DS/ENOXAlternateSubstitute/styles/Alternate.css"],(function(e,t,n,a,i,r,o,s,l,T,A,d,N,c,_,u,S,C,g,E,O,p,I,h,f,m,R,D){var M,L,b,v;return e.singleton({initialize:function(e){this.options=e,this.altOptions=e.altOptions},_initDivs:function(){h.initialize(this.options),f.initialize(this.options);var e=A.compile(R);this._suggestedAlternatescontainer=t.createElement("div",{class:"enox-alternate-suggestions-wrapper"}),this._suggestedAlternatescontainer.innerHTML=e(),this._referenceAlternateModal=this._suggestedAlternatescontainer.querySelector(".enox-alternate-suggestion"),this._suggestionSelectedUsageInfo=this._suggestedAlternatescontainer.querySelector(".enox-alternate-suggestion-instance-info"),this._referenceToolbar=this._suggestedAlternatescontainer.querySelector(".enox-alternare-suggestion-toolbar"),this._referencedataGridViewDiv=t.createElement("div",{class:"enox-alternate-suggestion-grid-view"}).inject(this._referenceAlternateModal),this._toolbarLeftContainer=this._suggestedAlternatescontainer.querySelector(".alternate_Suggestion_Toolbar_left_container"),this._toolbarRightContainer=this._suggestedAlternatescontainer.querySelector(".alternate_Suggestion_Toolbar_right_container"),this._suggestionfilterContainer=this._suggestedAlternatescontainer.querySelector(".alternate_Suggestion_Filter_container"),this._SearchMenuContainer=this._suggestedAlternatescontainer.querySelector(".alternate_Suggestion_search_container"),this._rightMenuContainer=this._suggestedAlternatescontainer.querySelector(".alternate_Suggestion_right_menu_container"),this.suggestionsFilterEmptyResultDOM=t.createElement("div",{class:"alternate-suggestion-empty-filter-result"}).inject(this._referenceAlternateModal),this.buildContent()},buildContent:function(){var e=this;M=e.options.options.activeEngItemTreeInfo._selectedNodes,L=e.options.options.activeEngItemTreeInfo._parentNode,b=e.options.options.viewInfo._isFlatennedView,v=e.options.options.viewInfo._isReferenceORGroupView;var t=M[0];this.contextTitle=t.options.grid[m.CONSTANT_DS_LABEL],this.contextRevision=t.options.grid[m.CONSTANT_DS_REVISION],e.applicableAlternateIds=[],e.initializeSuggestionUsageInfoDivs(this._suggestionSelectedUsageInfo),this.options._buildEmptyFilterDOM(this.suggestionsFilterEmptyResultDOM)},initializeSuggestionUsageInfoDivs:function(e){t.createElement("span",{class:"alternate_usageInfo_container_name"}).inject(e).innerText=D.get("eng.alternate.usage.info.title");var n=t.createElement("span",{class:"alternate_usageInfo_container_value"}).inject(e);this.options.renderSelectedPrimaryObjectInfo(n)},buildToolbar:function(){var e=this,t={container:e._rightMenuContainer,model:e.alternateSuggestionModel,findCB:function(){e._buildFindInDatagrid()},settingsCB:function(){f.createSettingsDialogBox(e.suggestionDialog,(function(){e._rightMenuContainerList.destroy(),e._suggestionfilterMenu.destroy(),e.refreshAlternateSuggestion()}))}};e._rightMenuContainerList=I.buildToolbarForSuggestions(t),this._suggestionfilterMenu=I.getFilterMenu(this._suggestionfilterContainer)},buildModal:function(e){var t=this,n=new d;return n.inject(t.altOptions.getAltFacetMainContainer()),t.suggestionDialog=new r({title:D.get("eng.alternate.previous.revision.add.title")+" - "+this.contextTitle+"  "+this.contextRevision,content:this._referenceAlternateModal,className:"alternate-suugestion-model",immersiveFrame:n,resizableFlag:!0,width:800,height:550,position:{at:"center",my:"center"},modalFlag:!0,touchMode:!0,buttons:{Reset:new l({label:D.get("eng.alternate.suggestion.button.back.label"),onClick:function(n){t.suggestionDialog.buttons[m.BUTTON_CANCEL].dialog.destroy(),e.show()}}),SaveAll:new l({label:D.get("eng.alternate.button.add.label"),onClick:function(n){var a=t.alternateSuggestionModel.getSelectedNodes(),i=t.validateSuggestedAlternates(a);i&&i.length>0&&(t.addSuggestedItems(i),t.suggestionDialog.buttons[m.BUTTON_CANCEL].dialog.destroy(),e.close())}}),Cancel:new l({onClick:function(n){t.suggestionDialog.buttons[m.BUTTON_CANCEL].dialog.destroy(),e.close()}})}}),t.suggestionDialog.buttons[m.BUTTON_SAVE].disabled=!0,t.suggestionDialog.addEventListener("close",(function(t){e.close()})),t.suggestionDialog},_buildFindInDatagrid:function(){var e=this,t=e.alternatSuggestionGridView.dsModel;e.findWidget&&e.findWidget.relatedWidget?(t.closeFind(),e.findWidget.destroy()):(e.findWidget=new i({displayMatchCaseToggle:!1,relatedWidget:t,onFindRequest:t.setFindStr,onFindPreviousResult:t.goToPreviousMatchingCell,onFindNextResult:t.goToNextMatchingCell,onFindClose:function(){t.closeFind(),e.findWidget.destroy()}}).inject(e._SearchMenuContainer),e.findWidget.getContent().style.position="relative",e.findWidget.focus())},getSuggestedItems:function(e){var t=this,n={},a={};return a[m.CONSTANT_SUGGESTION_VERSION_GRAPH_PAYLOAD_ID]=e,a[m.CONSTANT_VERSION_GRAPH_PAYLOAD_ATTRIBUTE]=t.altOptions.altAppCore.altSettingsManager.getCommand(m.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[m.CONSTANT_VERSION_GRAPH_ATTRIBUTES],n[m.CONSTANT_SUGGESTION_VERSION_GRAPH_PAYLOAD]=[a],T.wrappedWithCancellablePromise((function(e,a){t.altOptions.altAppCore.altDataServices.getRelatedItemsUsingVersionGraphServices(n).then((function(n){if(n.hasOwnProperty(m.ERROR)){var a=n.error.message?n.error.message:n;return a=n.response&&n.response.message?n.response.message:a,void C.errorAlert(a)}var i=t.splitPrimaryIdsWithSource(n);return e(i)}))})).catch((function(e){return resolve(e)}))},splitPrimaryIdsWithSource:function(e){var t=this,n={},a=[],i=[],r=[],o=[],s=[],l=[],T=e[m.CONSTANT_SUGGESTION_VERSION_GRAPHS];return T&&T.forEach(((e,n)=>{var T=e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_VERSIONS];e.item[m.CONSTANT_SUGGESTION_VERSION_GRAPH_VID];T.forEach(((e,n)=>{var T=e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_ID];!e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS]&&e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_COPYFROM]?(i.push(T),M[0].getID()==T&&i.push(e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_COPYFROM])):e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS]&&"S"===e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS][0].semantic?(o.push(T),M[0].getID()==T&&(s.push(e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS][0].id),t.removeIdFromBranchAndRevision(e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS][0].id,o,a))):(e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS]&&"E"===e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS][0].semantic||!e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_COPYFROM])&&(M[0].getID()===T&&e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_DERIVEDFROM]?(r.push(e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_DERIVEDFROM]),t.removeIdFromBranchAndRevision(e[m.CONSTANT_SUGGESTION_VERSION_GRAPH_DERIVEDFROM],o,a)):-1==s.indexOf(T)&&-1==r.indexOf(T)&&a.push(T)),M[0].getID()==T&&l.push(T)}))})),(t.options.newSourceSettings&&t.options.newSourceSettings[m.CONSTANT_REVISION_IDS]||!t.options.newSourceSettings)&&(n[m.CONSTANT_REVISION_IDS]=a,n[m.CONSTANT_PREVIOUS_REVISION_IDS]=r),(t.options.newSourceSettings&&t.options.newSourceSettings[m.CONSTANT_OTHER_USAGE_IDS]||!t.options.newSourceSettings)&&(n[m.CONSTANT_OTHER_USAGE_IDS]=l),(t.options.newSourceSettings&&t.options.newSourceSettings[m.CONSTANT_PREVIOUS_REVISION_IDS]||!t.options.newSourceSettings)&&(n[m.CONSTANT_PREVIOUS_REVISION_IDS]=r),(t.options.newSourceSettings&&t.options.newSourceSettings[m.CONSTANT_DUPLICATE_IDS]||!t.options.newSourceSettings)&&(n[m.CONSTANT_DUPLICATE_IDS]=i),(t.options.newSourceSettings&&t.options.newSourceSettings[m.CONSTANT_BRANCH_FROM_IDS]||!t.options.newSourceSettings)&&(n[m.CONSTANT_BRANCH_FROM_IDS]=s),(t.options.newSourceSettings&&t.options.newSourceSettings[m.CONSTANT_BRANCH_IDS]||!t.options.newSourceSettings)&&(n[m.CONSTANT_BRANCH_IDS]=o,n[m.CONSTANT_BRANCH_FROM_IDS]=s),n},removeIdFromBranchAndRevision:function(e,t,n){var a=n.indexOf(e);-1!=a&&n.splice(a,1);var i=t.indexOf(e);-1!=i&&t.splice(i,1)},registerAlternateFilter:function(){var e=this;this.altSuggestionFilterManager=e.alternateSuggestionModel.getFilterManager(),this.altSuggestionFilterManager.registerFilter("stringRole",_);var t={},n=e.altOptions.altAppCore.altSettingsManager.getCommand(m.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[m.CONSTANT_ALTERNATE_SUGGESTION_FILTER];new u({target:e._suggestionfilterContainer,multiSelect:!0,position:"bottom left",closeOnClick:!0,items:[],events:{onClick:function(n,a){var i=a.name;if(a.selected)t[i]={filterId:"stringRole",filterModel:{allowedRoles:t[a.name]?t[a.name].filterModel.allowedRoles.push(a.id)&&t[a.name].filterModel.allowedRoles:[a.id]}};else{var r=t[a.name].filterModel.allowedRoles.indexOf(a.id);t[a.name].filterModel.allowedRoles.length>1?t[a.name].filterModel.allowedRoles.splice(r,1):delete t[i]}e.altSuggestionFilterManager.filterModel={},e.alternateSuggestionModel.setFilterModel(t),0==Object.keys(t).length||0==e.alternateSuggestionModel._getTrueRoot().getNumberOfVisibleChildren()&&e.alternateSuggestionModel._getTrueRoot().getNumberOfDescendants()>0?(e._referencedataGridViewDiv.hide(),e.suggestionsFilterEmptyResultDOM.show()):(e._referencedataGridViewDiv.show(),e.suggestionsFilterEmptyResultDOM.hide())}.bind(e)}}).addItem(I.renderDropdownItems(n,t))},createAlternateSuggestionModel:function(e){this._initDivs(),this.suggestionDialog=this.buildModal(e),this.refreshAlternateSuggestion()},refreshAlternateSuggestion:function(){this.buildContextViewContent(),this.buildToolbar(),this.registerAlternateFilter()},addSuggestedItems:function(e){var t=this,n=t.getSuggestedAlternatePayload(e);t.altOptions.altAppCore.altDataServices.addAlternteFromSuggestedItems(n,M[0],t.options).then((function(e){if(e.hasOwnProperty(m.ERROR)){var n=e.error.message?e.error.message:e;return n=e.response&&e.response.message?e.response.message:n,void C.errorAlert(n)}if(e.status==m.SUCCESS){t.altOptions.altAppCore.altSettingsManager.setAuthoringMode(m.CONSTANT_AUTHORING_MODE);var a=t.altOptions._addAlternateUX.ALTERNATE.model.getAllDescendants(),i={},r=[],o=!1,s=E.createAlternateItemNodes(g.mergeItemsOnAlternateCriteria(e.AlternateItemInfo));for(var l in s)i[s[l].options[m.CONSTANT_ALT_ID]]=s[l];for(var T in a)i[a[T].options[m.CONSTANT_ALT_ID]]?r.push(a[T]):a[T].options[m.CONSTANT_STATUS]==m.CONSTANT_NOT_APPLICABLE&&(o=!0);t.altOptions.alternateCollectionToolBarModelEvents.publish({event:m.HIDE_SHOW_MAKE_APPLICABLE_CMD,data:o}),t.altOptions.updateCustomAttributeEvents.publish({event:"db_nodes_loaded",data:s}),r.length>0&&t.altOptions.removeDeletedRowFromView(r),t.altOptions._addAlternateUX.ALTERNATE.append(s),t.altOptions.updateAlternateColumnValues(s[0].options[m.CONSTANT_REF_ID]),C.sucessAlert(D.get("eng.alternate.add.success.message")),t.altOptions.switchView(t.altOptions.activeView),t.altOptions._addAlternateUX.ALTERNATE.model.isGroupedByView&&t.altOptions.groupAlternateNodes({context:t.altOptions._addAlternateUX.ALTERNATE.model.groupedByProperty})}}))},getSuggestedAlternatePayload:function(e){var t=[],n=L.options.grid[m.CONSTANT_KEY_PHYSICALID];return e&&e.forEach(((e,a)=>{if(e._isFromOriginalModel()){var i={},r=e.options.grid,o=null!=r.id?r.id:r[m.CONSTANT_ALT_ID];if(r[m.CONSTANT_SUGGESTION_SELECT_USAGE]==m.CONSTANT_SELECT_USAGE_REFERENCE)i[m.CONSTANT_ALT_ID]=o,i[m.CONSTANT_REFERENCE_PHYSICAL_ID]=n,i[m.CONSTANT_INTERCHANGEABILITY_TYPE]=r[m.CONSTANT_DS_TYPE],t.push(i);else if(r[m.CONSTANT_SUGGESTION_SELECT_USAGE]==m.CONSTANT_SELECT_USAGE_INSTANCE)for(var s in M){(i={})[m.CONSTANT_ALT_ID]=o,i[m.CONSTANT_CTX_ITEM_ID]=M[s].options.instanceId,i[m.CONSTANT_INTERCHANGEABILITY_TYPE]=r[m.CONSTANT_DS_TYPE],t.push(i)}else i[m.CONSTANT_ALT_ID]=o,i[m.CONSTANT_INTERCHANGEABILITY_TYPE]=r[m.CONSTANT_DS_TYPE],t.push(i)}})),t},validateSuggestedAlternates:function(e){for(var t=[],n=[],a=0;a<e.length;a++)if(e[a]._isFromOriginalModel()){if(!this.validateSelectedUsage(e[a]))return;var i=e[a].getID(),r=e[a].options.grid[m.CONSTANT_SUGGESTION_SELECT_USAGE],o=t.indexOf(i);if(-1==o)n.push(e[a]),t.push(i);else if(n[o].options.grid[m.CONSTANT_SUGGESTION_SELECT_USAGE]!=r)return void C.errorAlert(e[a].getDisplayName()+D.get("eng.alternate.suggestion.multiple.usage.error"))}return n},validateSelectedUsage:function(e){var t=!0;return L.getID()!=M[0].getID()&&!b||e.options.grid[m.CONSTANT_SUGGESTION_SELECT_USAGE]==m.CONSTANT_SELECT_USAGE_ALL?v&&e.options.grid[m.CONSTANT_SUGGESTION_SELECT_USAGE]===m.CONSTANT_SELECT_USAGE_INSTANCE?(C.errorAlert(e.getDisplayName()+D.get("eng.alternate.suggestion.reference.view.error")),t=!1):e.options[m.CONSTANT_DATAGRID_COLUMN_SOURCE]===m.CONSTANT_SUGGESTION_OTHER_USAGE&&e.options.grid[m.CONSTANT_SUGGESTION_SELECT_USAGE]===m.CONSTANT_SELECT_USAGE_ALL&&(C.errorAlert(e.getDisplayName()+D.get("eng.alternate.suggestion.other.usage.error")),t=!1):(C.errorAlert(e.getDisplayName()+D.get("eng.alternate.suggestion.flattened.view.error")),t=!1),t},getSuggestionAlternates:function(e,t){return p.getAlternateUsingIndexMode(e,t)},buildContextViewContent:function(){var e=this;this.alternateSuggestionModel=new a({shouldBeSelected:function(e){return!0}}),c.mask(e.suggestionDialog.elements._contentDiv);var t=M[0];e.getSuggestedItems(t.getID()).then((function(n){var a=e.mergeWithAlternateIds(n);e.getSuggestionAlternates(t.getID(),a).then((function(t){var a=e.buildAlternateSourceInfo(t,n),i=e.sortSourceByPreference(a),r=e.removeDuplicateIds(i,n),o=E.createAlternateItemWithNotApplicableData(r,!0);if(e.alternateSuggestionModel.addRoot(o),e.sources&&Object.keys(e.sources).length>1){var s={option:m.CONSTANT_DATAGRID_COLUMN_SOURCE,model:e.alternateSuggestionModel};I.groupSuggestions({context:s})}e.getDataGridView(),c.unmask(e.suggestionDialog.elements._contentDiv)})).catch((function(e){console.error(e)}))})).catch((function(e){console.error(e)}))},mergeWithAlternateIds:function(e){var t=this;t.applicableAlternateIds=[];var n=[];return t.altOptions.alternateModel&&t.altOptions.alternateModel.getAllDescendants().length>0&&t.altOptions.alternateModel.getAllDescendants().forEach(((e,n)=>{e._isFromOriginalModel()&&e.options[m.CONSTANT_STATUS]!=m.CONSTANT_NOT_APPLICABLE&&t.applicableAlternateIds.push(e.getID())})),t.options.newSourceSettings&&t.options.newSourceSettings[m.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE]&&(n=n.concat(t.applicableAlternateIds),e[m.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE]=t.applicableAlternateIds),e&&Object.keys(e).forEach(((t,a)=>{n=n.concat(e[t])})),n},sortSourceByPreference:function(e){var t=[];return[m.CONSTANT_SUGGESTION_PREVIOUS_REVISION,m.CONSTANT_SUGGESTION_REVISION,m.CONSTANT_SUGGESTION_BRANCH_FROM,m.CONSTANT_SUGGESTION_BRANCH,m.CONSTANT_SUGGESTION_DUPLICATE,m.CONSTANT_SUGGESTION_OTHER_USAGE,m.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE].forEach(((n,a)=>{e[n]&&(t=t.concat(e[n]))})),t},buildAlternateSourceInfo:function(e,t){var n=this,a={};return e&&e.length>0&&e.forEach((e=>{-1===n.applicableAlternateIds.indexOf(e[m.CONSTANT_ALT_ID])&&(t&&t[m.CONSTANT_OTHER_USAGE_IDS]&&-1!=t[m.CONSTANT_OTHER_USAGE_IDS].indexOf(e[m.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID])?e[m.CONSTANT_DATAGRID_COLUMN_SOURCE]=m.CONSTANT_SUGGESTION_OTHER_USAGE:t&&t[m.CONSTANT_BRANCH_FROM_IDS]&&-1!=t[m.CONSTANT_BRANCH_FROM_IDS].indexOf(e[m.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID])?e[m.CONSTANT_DATAGRID_COLUMN_SOURCE]=m.CONSTANT_SUGGESTION_BRANCH_FROM:t&&t[m.CONSTANT_BRANCH_IDS]&&-1!=t[m.CONSTANT_BRANCH_IDS].indexOf(e[m.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID])?e[m.CONSTANT_DATAGRID_COLUMN_SOURCE]=m.CONSTANT_SUGGESTION_BRANCH:t&&t[m.CONSTANT_PREVIOUS_REVISION_IDS]&&-1!=t[m.CONSTANT_PREVIOUS_REVISION_IDS].indexOf(e[m.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID])?e[m.CONSTANT_DATAGRID_COLUMN_SOURCE]=m.CONSTANT_SUGGESTION_PREVIOUS_REVISION:t&&t[m.CONSTANT_DUPLICATE_IDS]&&-1!=t[m.CONSTANT_DUPLICATE_IDS].indexOf(e[m.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID])?e[m.CONSTANT_DATAGRID_COLUMN_SOURCE]=m.CONSTANT_SUGGESTION_DUPLICATE:t&&t[m.CONSTANT_REVISION_IDS]&&-1!=t[m.CONSTANT_REVISION_IDS].indexOf(e[m.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID])?e[m.CONSTANT_DATAGRID_COLUMN_SOURCE]=m.CONSTANT_SUGGESTION_REVISION:t&&t[m.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE]&&-1!=t[m.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE].indexOf(e[m.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID])&&(e[m.CONSTANT_DATAGRID_COLUMN_SOURCE]=m.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE),n.getSelectUsageData(e),n.splitItemBasedonSource(e,a))})),a},splitItemBasedonSource:function(e,t){t.hasOwnProperty(e[m.CONSTANT_DATAGRID_COLUMN_SOURCE])?t[e[m.CONSTANT_DATAGRID_COLUMN_SOURCE]].push(e):t[e[m.CONSTANT_DATAGRID_COLUMN_SOURCE]]=[e]},removeDuplicateIds:function(e,t){var n=this,a=[],i=[];n.sources={},this.suggestedAltInfo={};for(var r=0;r<e.length;r++){var o=e[r][m.CONSTANT_ALT_ID]+e[r][m.CONSTANT_DATAGRID_COLUMN_SOURCE],s=a.indexOf(o);-1==s?(e[r][m.CONSTANT_DATAGRID_COLUMN_USAGE_COUNT]=1,i.push(e[r]),a.push(o),this.suggestedAltInfo[o]=[e[r][m.CONSTANT_ALT_REF_PHYSICALID]]):i[s]&&(i[s][m.CONSTANT_DATAGRID_COLUMN_USAGE_COUNT]++,this.suggestedAltInfo[o].push(e[r][m.CONSTANT_ALT_REF_PHYSICALID])),n.splitItemBasedonSource(e[r],n.sources)}return i},getSelectUsageData:function(e){var t={};t[m.Operation_Alternate]=m.CONSTANT_SELECT_USAGE_ALL,t[m.Operation_InstanceSubstitute]=m.CONSTANT_SELECT_USAGE_INSTANCE,t[m.Operation_ReferenceSubstitute]=m.CONSTANT_SELECT_USAGE_REFERENCE;var n=e[m.CONSTANT_OPERATION_KEY];e[m.CONSTANT_SUGGESTION_SELECT_USAGE]=t[n]},getDataGridView:function(){var e=this,t=e.altOptions.altAppCore.altSettingsManager.getCommand(m.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[m.CONSTANT_SUGGESTION_COLUMN_INFO],n=O._getDataGridColumns(t,e.altOptions.altAppCore),a=e.altOptions.altAppCore.altSettingsManager.getCommand(m.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[m.CONSTANT_SUGGESTION_COLUMN_OPTIONS];e.alternatSuggestionGridView=e.options.createDataGridView(e.alternateSuggestionModel,n,a),e.alternatSuggestionGridView.dsModel.selectionBehavior.unselectAllOnEmptyArea=!1,e.alternateSuggestionModel.expandAll(),e.alternatSuggestionGridView.dsModel.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(e.buildSelectUsageTypeRepresentation())),this._referenceAlternateModal.appendChild(this._referencedataGridViewDiv),e.alternatSuggestionGridView.dsModel.onContextualEvent=function(t){var n=[],a=t.cellInfos&&t.cellInfos.nodeModel?t.cellInfos.nodeModel:"";if(-1===(t.cellInfos?t.cellInfos.rowID:"")||!a)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(t,i):[];if(t&&t.collectionView&&a&&a._isFromOriginalModel()){var i={properties:!0,expandCollapse:!0},r={};r[m.CONSTANT_PROPERTIES_OBJECT_ID]=t.cellInfos.nodeModel.options[m.CONSTANT_ALT_ID],r[m.CONSTANT_PROPERTIES_TENANT_ID]=e.altOptions.altAppCore.altSettingsManager.getPlatformId(),n.push({title:D.get("eng.alternarte.rmb.menu.properties"),icon:"fonticon fonticon-attributes",type:"PushItem",action:{this:e,context:r,callback:e._displayPropertiesWidget.bind(this)}});var o=t.cellInfos.nodeModel.options[m.CONSTANT_ALT_ID]+t.cellInfos.nodeModel.options[m.CONSTANT_DATAGRID_COLUMN_SOURCE],s={Alt_ref_ids:e.suggestedAltInfo[o],usagesInfo:!0,title:t.cellInfos.nodeModel.getLabel()+" "+t.cellInfos.nodeModel.getReferenceVersion()};n.push({title:D.get("eng.alternarte.suggestion.rmb.menu.usages"),icon:"fonticon fonticon-table",type:"PushItem",action:{this:h,context:s,callback:h.createsuggestionReferenceModel}})}return n},e.alternatSuggestionGridView.dsModel.addEventListener("click",(function(t,n){if(null!=n){if(n.nodeModel)if(n.nodeModel._isFromOriginalModel()){var a=t.dsModel.layout.getDataIndexFromColumnIndex(n.columnID);if(a==m.CONSTANT_DATAGRID_COLUMN_USAGE_COUNT){var i=n.nodeModel.options[m.CONSTANT_ALT_ID]+n.nodeModel.options[m.CONSTANT_DATAGRID_COLUMN_SOURCE],r={Alt_ref_ids:e.suggestedAltInfo[i],usagesInfo:!0,title:n.nodeModel.getLabel()+" "+n.nodeModel.getReferenceVersion()};h.createsuggestionReferenceModel(r)}else a==m.CONSTANT_REVISION&&widget.appMediator.publish(m.EVENT_LAUNCH_COMMAND,{commandId:m.SHOW_HISTORY_CMD,context:{item:n.nodeModel}});n.nodeModel.onSelect((function(){e.enableDisableAddButton()})),n.nodeModel.onUnselect((function(){e.enableDisableAddButton()}))}else n.nodeModel.getChildren().length&&(n.nodeModel.onSelect((function(){n.nodeModel.getChildren()&&n.nodeModel.getChildren().forEach(((e,t)=>{e.select()})),e.enableDisableAddButton()})),n.nodeModel.onUnselect((function(){n.nodeModel.getChildren()&&n.nodeModel.getChildren().forEach(((e,t)=>{e.unselect()})),e.enableDisableAddButton()})));-1==n.columnID&&-1==n.rowID&&e.enableDisableAddButton()}})),e.alternatSuggestionGridView.dsModel.addEventListener("DSpointerdown",(function(t,n){n&&n.nodeModel&&(n.nodeModel.onSelect((function(){e.enableDisableAddButton()})),n.nodeModel.onUnselect((function(){e.enableDisableAddButton()})))})),this.alternatSuggestionGridView.show(),this.alternatSuggestionGridView.inject(e._referencedataGridViewDiv),e.enableDisableAddButton()},buildSelectUsageTypeRepresentation:function(){var e={},t={};let n=[],a=this.altOptions.altAppCore.altDataServices.getNlsOfPropertiesValues()[m.CONSTANT_DS_TYPE];return t[m.CONSTANT_SUGGESTION_CUSTOM_TYPE_USAGE]=[D.get("eng.alternate.select.usage.all"),D.get("eng.alternate.select.usage.reference"),D.get("eng.alternate.select.usage.instance")],this.altOptions.altAppCore.altDicoServices.interchangeabilityTypes.forEach((e=>{let t={label:a[e]?a[e]:e,value:e};n.push(t)})),n.sort(((e,t)=>e.label>t.label?1:-1)),t[m.CONSTANT_SUGGESTION_CUSTOM_TYPE_SUBTYPE]=[...n],Object.keys(t).forEach((function(n){e[n]={stdTemplate:"comboSelector",semantics:{possibleValues:t[n]}}})),e},enableDisableAddButton:function(){var e=this;e.alternateSuggestionModel.getSelectedNodes().length>0?e.suggestionDialog.buttons[m.BUTTON_SAVE].disabled=!1:e.suggestionDialog.buttons[m.BUTTON_SAVE].disabled=!0,e.enabledisableToolbar()},enabledisableToolbar:function(){var e=this,t=e._rightMenuContainerList.getItem(m.CONSTANT_SUGGESTION_CHANGE_USAGE);e.alternateSuggestionModel&&e.alternateSuggestionModel.getSelectedNodes().length>0?(t.elements.container.removeClassName("enox-alternate-toolbar-item-disable"),e._rightMenuContainerList.enableItem(t.id)):(t.elements.container.addClassName("enox-alternate-toolbar-item-disable"),e._rightMenuContainerList.disableItem(t.id))},_displayPropertiesWidget:function(e){S._getPropertiesWidget(e)}})})),define("DS/ENOXAlternateSubstitute/commands/AddAlternate",["UWA/Core","UWA/Class","DS/UIKIT/Alert","DS/Controls/Button","DS/Windows/Dialog","DS/UIKIT/Tooltip","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Handlebars/Handlebars4","DS/Windows/ImmersiveFrame","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXEngineer/utils/Search","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","DS/ENOXEngineer/componentsHelpers/XEngAutoComplete/XEngAutoComplete","DS/ENOXAlternateSubstitute/utils/AlternateDataParser","DS/ENOXAlternateSubstitute/commands/AddSuggestionAlternate","DS/ENOXEngineerCommonUtils/XENTracker","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","text!DS/ENOXAlternateSubstitute/views/html/AddAlternateModal.html"],(function(e,t,n,a,i,r,o,s,l,T,A,d,N,c,_,u,S,C,g,E,O){"use strict";return t.singleton({initialize:function(e){this.options=e.options,this.altAppCore=e.altAppCore,this.altOptions=e.altOptions,this.xenSearchMgmt=new d({multiSel:!1})},_initDivs:function(){var t=l.compile(O);this._container=e.createElement("div",{class:"enox-alternate-add-wrapper"}),this._container.innerHTML=t({contextLabel:!0,autocomplete:!0,alternateContextHeader:!0,alternateContext:!0,suggestionlink:!0,alternateType:!0}),this._container=this._container.querySelector(".enox-addAlternate"),this._contextLabel=this._container.querySelector(".enox-addAlternate-context-text"),this._mandatorySymbol=this._container.querySelector(".enox-addAlternate-context-mandatory-symbol"),this._autocompleteContainer=this._container.querySelector(".enox-addAlternate-autocomplete"),this._contextHeaderLabel=this._container.querySelector(".enox-addAlternate-context-header-label"),this._contextHeaderInfo=this._container.querySelector(".enox-addAlternate-context-header-info"),this._contextSelectionContainer=this._container.querySelector(".enox-addAlternate-context"),this._alternateAsAll=this._container.querySelector(".enox-addAlternate-context-selection-all"),this._alternateAsInstance=this._container.querySelector(".enox-addAlternate-context-selection-instance"),this._alternateAsReference=this._container.querySelector(".enox-addAlternate-context-selection-reference"),this._suggestionsLink=this._container.querySelector(".enox-addAlternate-suggestion-link"),this._alternateWithType=this._container.querySelector(".enox-addAlternate-type-dropDown"),this._alternateWithTypeLabel=this._container.querySelector(".enox-addAlternate-type-label"),this._alternateTypeWrapper=this._container.querySelector(".enox-addAlternate-type-wraper")},renderAddAlternateDialog:function(){var t=this;const n=this.options&&this.options.appCore&&this.options.appCore.sessionManager&&this.options.appCore.sessionManager.getCurrentViewOptions?this.options.appCore.sessionManager.getCurrentViewOptions():{};g.trackCommandLaunched("Alternate_Add",n),this._initDivs(),t.buildDialogboxContent(),t.buildAutoCompleteLabel(),this._contextHeaderLabel.innerText=E.get("eng.alternate.context.selection.header.label");var a=e.createElement("span",{class:"enox-addAlternate-header-tooltip fonticon fonticon-help",html:E.get("eng.alternate.context.selection.header.info").replace("$1",E.get("eng.alternate.status.proposed").bold())+"<br/><br/>"+E.get("eng.alternate.context.selection.header.subinfo").replace("$1",E.get("eng.alternate.status.qualified").bold()).replace("$2",E.get("eng.alternate.tooltip.released").bold())});new r({position:"bottom",trigger:"hover click touch",target:this._contextHeaderInfo,body:a}),this.buildItemSearchComponent(),this.buildSuggestionLink(),t.altAppCore.altDicoServices.interchangeabilityTypes.length>1&&this.buildAlternateType(),this.buildContextSelectionSettings()},buildSuggestionLink:function(){var t=this;this._suggestionsLinkText=e.createElement("a",{class:"enox-addAlternate-suggestion-link"}),this._suggestionsLinkText.innerText=E.get("eng.alternate.suggestion.link.label"),this._suggestionsLink.appendChild(this._suggestionsLinkText),this._suggestionsLink.onclick=function(){t.addAlternateDialogBox.hide(),C.createAlternateSuggestionModel(t.addAlternateDialogBox)}},buildAutoCompleteLabel:function(){this._contextLabelMandatorySymbol=e.createElement("span",{class:"enox-addAlternate-context-mandatory-symbol"}),this._contextLabel.innerText=E.get("eng.alternate.autocomplete.header.label"),this._contextLabelMandatorySymbol.innerText=E.get("eng.alternate.asteric"),this._contextLabel.appendChild(this._contextLabelMandatorySymbol)},buildDialogboxContent:function(){var e=this,t=new T;t.inject(e.altOptions.getAltFacetMainContainer()),e.addAlternateDialogBox=new i({title:E.get("eng.alternate.add.alternate.to").replace("$1",this.altOptions.selectedNode[0].getDisplayName()),content:e._container,immersiveFrame:t,resizableFlag:!0,width:550,height:400,modalFlag:!0,touchMode:!0,buttons:{Ok:new a({label:E.get("eng.alternate.button.add.label"),onClick:function(t){t.dsModel.dialog;e.selectedNodesFromSearch=e.itemSearchAutoComplete.selectedItems;var n=e.altAppCore&&e.altAppCore.altSettingsManager&&e.altAppCore.altSettingsManager.isCloud()?N.SUPPORTED_ALTERNATE_COUNT_ONCLOUD:N.SUPPORTED_ALTERNATE_COUNT_ONPREMISE;if(e.selectedNodesFromSearch&&e.selectedNodesFromSearch.length>n){var a=E.get("eng.alternate.add.maxcount.errormsg").replace("$1",n);A.errorAlert(a)}else 1==e.alternateAsAllRadioButton.checkFlag?e.addAsGlobal(e.itemSearchAutoComplete.selectedItems):1==e.alternateAsInstanceRadioButton.checkFlag?e.addAsInstance(e.itemSearchAutoComplete.selectedItems):1==e.alternateAsReferenceRadioButton.checkFlag&&e.addAsReference(e.itemSearchAutoComplete.selectedItems),e.addAlternateDialogBox.buttons[N.BUTTON_CANCEL].dialog.close()}}),Cancel:new a({onClick:function(e){e.dsModel.dialog.close()}})}}),e.addAlternateDialogBox.buttons[N.BUTTON_OK].disabled=!0},buildContextSelectionSettings:function(){var e=this;let t=this.altOptions.altAppCore.altDataServices.shouldShowInstanceAlternates(this.altOptions.selectedNode[0]);this.buildAlternateAsReference(),this.buildAlternteAsAll(),this.buildAlternateAsInstance(),this.altOptions.parentNode.getID()==this.altOptions.selectedNode[0].getID()||this.options.viewInfo._isFlatennedView||this.options.viewInfo._isFlatView||this.altOptions.isParentMEI?(this._alternateAsInstance.classList.add("disabledContent"),this._alternateAsReference.classList.add("disabledContent")):this.options.viewInfo._isReferenceORGroupView||!t?this._alternateAsInstance.classList.add("disabledContent"):1==this.altOptions.selectedNode.length?(e.alternateAsAllRadioButton.checkFlag=!1,e.alternateAsInstanceRadioButton.checkFlag=!0,e.alternateAsReferenceRadioButton.checkFlag=!1):this.altOptions.selectedNode.length>1&&(e.alternateAsAllRadioButton.checkFlag=!1,e.alternateAsInstanceRadioButton.checkFlag=!1,e.alternateAsReferenceRadioButton.checkFlag=!0),this.altOptions.isParentMEI&&A.warningAlert(E.get("eng.alternate.selected.product.parent.mei"))},buildRadioButton:function(t,n,a,i){var r=e.createElement("div",{class:"enox-addAlternate-"+t+"-button"}),o=e.createElement("div",{class:"enox-addAlternate-"+t+"-description"});o.addContent(n),a.inject(r),i.appendChild(r),i.appendChild(o)},buildDropDown:function(t,n,a){var i=e.createElement("div",{class:"enox-addAlternate-"+t+"-dropDown"});n.inject(i),a.appendChild(i)},buildAlternteAsAll:function(){var e=this,t=e.getEscapeHTMLString(this.altOptions.selectedNode[0].getDisplayName()).italics(),n=E.get("eng.alternate.radioButton.all.description").replace("$1",t);this.alternateAsAllRadioButton=new o({type:"radio",checkFlag:!0,label:E.get("eng.alternate.radioButton.all"),value:0}),e.buildRadioButton("addAll",n,this.alternateAsAllRadioButton,this._alternateAsAll),this.alternateAsAllRadioButton.addEventListener("click",(function(){e.alternateAsInstanceRadioButton.checkFlag=!1,e.alternateAsReferenceRadioButton.checkFlag=!1}))},buildAlternateAsInstance:function(){var e=this,t=e.getEscapeHTMLString(this.altOptions.selectedNode[0].getDisplayName()).italics(),n=(e.getEscapeHTMLString(this.altOptions.parentNode.getDisplayName()).italics(),E.get("eng.alternate.radioButton.instance.description").replace("$1",t).replace("$2",this.altOptions.selectedNode.length));this.alternateAsInstanceRadioButton=new o({type:"radio",checkFlag:!1,label:E.get("eng.alternate.radioButton.instance"),value:0}),e.buildRadioButton("addInstance",n,this.alternateAsInstanceRadioButton,this._alternateAsInstance),this.alternateAsInstanceRadioButton.addEventListener("click",(function(){e.alternateAsAllRadioButton.checkFlag=!1,e.alternateAsReferenceRadioButton.checkFlag=!1}))},buildAlternateAsReference:function(){var e=this,t=e.getEscapeHTMLString(this.altOptions.selectedNode[0].getDisplayName()).italics(),n=e.getEscapeHTMLString(this.altOptions.parentNode.getDisplayName()).italics(),a=E.get("eng.alternate.radioButton.reference.description").replace("$1",t).replace("$2",n);this.alternateAsReferenceRadioButton=new o({type:"radio",checkFlag:!1,label:E.get("eng.alternate.radioButton.reference")+this.altOptions.parentNode.getDisplayName(),value:0}),e.buildRadioButton("addReference",a,this.alternateAsReferenceRadioButton,this._alternateAsReference),this.alternateAsReferenceRadioButton.addEventListener("click",(function(){e.alternateAsAllRadioButton.checkFlag=!1,e.alternateAsInstanceRadioButton.checkFlag=!1}))},buildAlternateType:async function(){var e=[];let t=this.altAppCore.altDataServices.getNlsOfPropertiesValues()[N.CONSTANT_DS_TYPE];this.altAppCore.altDicoServices.interchangeabilityTypes.forEach((n=>{let a={label:t[n]?t[n]:n,value:n};e.push(a)})),e.sort(((e,t)=>e.label>t.label?1:-1)),this.alternateTypeDropDown=new s({elementsList:e,expanderIcon:"expand-down",selectAllOnFocus:!0,displayStyle:"normal",enableSearchFlag:!1,value:"Alternate Reference"}),this.buildDropDown("addType",this.alternateTypeDropDown,this._alternateWithType),this.buildAlternateTypeLabel()},buildAlternateTypeLabel:function(){this._alternateWithTypeMandatorySymbol=e.createElement("span",{class:"enox-addAlternate-context-mandatory-symbol"}),this._alternateWithTypeLabel.innerText="Type: ",this._alternateWithTypeMandatorySymbol.innerText=E.get("eng.alternate.asteric"),this._alternateWithTypeLabel.appendChild(this._alternateWithTypeMandatorySymbol)},buildItemSearchComponent:function(){var e=this,t={};t.dataService=e.altAppCore.altDataServices,this.itemSearchAutoComplete=new u({placeholder:E.get("eng.alternate.search.eng.item"),multiSelect:!0,datasetName:"alternate_model",targetTypes:[N.TYPE_VPMREFERENCE],invalidInterfaces:[N.INTERFACE_MEI],itemMultiSelect:!1,appCore:t,objectMapper:this._selectedAlternateItemMapper.bind(this)}),this.itemSearchAutoComplete.onSearchClick=this.launchSearch.bind(this),e.itemSearchAutoComplete.onUnselectXeng=function(t){e.enableOrDisableAddButton()},e.itemSearchAutoComplete.onSelectXeng=function(t){e.enableOrDisableAddButton()},this.itemSearchAutoComplete.inject(this._autocompleteContainer)},launchSearch:function(e){this.xenSearchMgmt.launchASearch({title:E.get("eng.alternate.select.engineering.item"),allowedTypes:[N.TYPE_VPMREFERENCE],invalidInterfaces:[N.INTERFACE_MEI],role:"",criteria:"",multiSel:!0,in_apps_callback:this.onSelectedFromSearchForAlternate.bind(this)})},onSelectedFromSearchForAlternate:function(e){var t=this,n=[],a=!0;if(t.itemSearchAutoComplete.selectedItems.length)for(var i in e){for(var r in a=!0,t.itemSearchAutoComplete.selectedItems)if(e[i].id==t.itemSearchAutoComplete.selectedItems[r].id){a=!1;break}a&&n.push(e[i])}else n=e;for(var i in n)t.itemSearchAutoComplete.onSelect(t._selectedAlternateItemMapper(n[i]),i);t.enableOrDisableAddButton()},_selectedAlternateItemMapper:function(e){return{id:e[N.CONSTANT_KEY_PHYSICALID]?e[N.CONSTANT_KEY_PHYSICALID]:e.id,value:e[N.CONSTANT_KEY_PHYSICALID]||e.resourceid,label:e[N.CONSTANT_DS_LABEL]+" "+e[N.CONSTANT_DS_REVISION],icon:Array.isArray(e.icons)?e.icons[0]:e.type_icon_url}},addAsGlobal:function(e){var t=this.options.activeEngItemTreeInfo._selectedNodes[0],n=e;this.addAlternateItem(t,[],null,n)},addAsReference:function(e,t){var n=this.options.activeEngItemTreeInfo._selectedNodes,a=this.options.activeEngItemTreeInfo._parentNode.getID(),i=e;this.addAlternateItem(n[0],[],a,i,t)},addAsInstance:function(e,t){for(var n=this.options.activeEngItemTreeInfo._selectedNodes,a=[],i=e,r=0;r<n.length;r++)a.push(n[r].getRelationID&&n[r].getRelationID());this.addAlternateItem(n[0],a,null,i,t)},addAlternateItem:function(e,t,n,a,i){var r=this;r.addAlternateDataService(e,t,n,a).then((function(e){e.hasOwnProperty(N.ERROR)?A.errorAlert(e.response.message):e.status==N.SUCCESS&&r.addAlternateSuccessUXModification(E.get("eng.alternate.add.success.message"),e,i)}))},addAlternateDataService:function(e,t,n,a){var i=this;return c.wrappedWithPromise((function(r,o){i.altAppCore.altDataServices.addAlternatePartToEngItem(e,i,t,n,a).then((function(e){r(e)}))}))},addAlternateSuccessUXModification:function(e,t,n){var a=this;a.altAppCore.altSettingsManager.setAuthoringMode(N.CONSTANT_AUTHORING_MODE);var i=a.altOptions._addAlternateUX.ALTERNATE.model.getAllDescendants(),r={},o=[],s=!1,l=_.createAlternateItemNodes(S.mergeItemsOnAlternateCriteria(t.AlternateItemInfo));for(var T in l)r[l[T].options[N.CONSTANT_ALT_ID]]=l[T];for(var d in i)r[i[d].options[N.CONSTANT_ALT_ID]]?o.push(i[d]):i[d].options[N.CONSTANT_STATUS]==N.CONSTANT_NOT_APPLICABLE&&(s=!0);a.altOptions.alternateCollectionToolBarModelEvents.publish({event:N.HIDE_SHOW_MAKE_APPLICABLE_CMD,data:s}),a.altOptions.updateCustomAttributeEvents.publish({event:"db_nodes_loaded",data:l}),n&&(l[0].options[N.CONSTANT_OTHER_CONTEXT_KEY]=n.options[N.CONSTANT_OTHER_CONTEXT_KEY],n.remove()),o.length>0&&a.altOptions.removeDeletedRowFromView(o),a.altOptions._addAlternateUX.ALTERNATE.append(l),a.altOptions.updateAlternateColumnValues(l[0].options[N.CONSTANT_REF_ID]),A.sucessAlert(e),a.altOptions.switchView(a.altOptions.activeView),a.altOptions._addAlternateUX.ALTERNATE.model.isGroupedByView&&a.altOptions.groupAlternateNodes({context:a.altOptions._addAlternateUX.ALTERNATE.model.groupedByProperty})},enableOrDisableAddButton:function(){null!=this.addAlternateDialogBox&&(this.itemSearchAutoComplete.selectedItems.length>0?this.addAlternateDialogBox.buttons[N.BUTTON_OK].disabled=!1:this.addAlternateDialogBox.buttons[N.BUTTON_OK].disabled=!0)},displayAlertMessage:function(e,t,a){var i={visible:!0,className:"altSub-param-alert",messageClassName:a,closable:!0,renderTo:e,autoHide:!0,hideDelay:2e3,fullWidth:!1};this.addAlternateAlertMsg=new n(i),this.addAlternateAlertMsg.add({message:t})},proposeAlternateItem:function(e,t,n,a,i){var r=this;r.altAppCore.altDataServices.proposeAlternatePartToEngItem(e,t,n,a,i).then((function(e){if(e.hasOwnProperty(N.ERROR))return e.response&&e.response.message&&e.response.message.contains("access")?void A.errorAlert(E.get("eng.alternate.modify.access.error")):void A.errorAlert(e.response.message);if(e.status==N.SUCCESS){r.altAppCore.altSettingsManager.setAuthoringMode(N.CONSTANT_AUTHORING_MODE);for(var t=r.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes(),n=0;n<t.length;n++)r.updateUsageDetails(t[n],i);r.altOptions.updateCustomAttributeEvents.publish({event:"db_nodes_loaded",data:t}),r.altOptions.updateAlternateColumnValues(t[0].options[N.CONSTANT_REF_ID]),A.sucessAlert(E.get("eng.alternate.propose.success.message")),r.altAppCore.altItemFactory.updateGroupBy()}}))},updateUsageDetails:function(e,t){var n=this,a=e._getRowID(),i=n.options.activeEngItemTreeInfo._parentNode,r=i.getLabel?i.getLabel():"",o=i.getReferenceVersion?i.getReferenceVersion():"",s=n.options.activeEngItemTreeInfo._selectedNodes[0].getInstanceName?n.options.activeEngItemTreeInfo._selectedNodes[0].getInstanceName():"";switch(t){case N.CONSTANT_PROPOSE_FOR_ALL:e.options.grid[N.CONSTANT_OPERATION_KEY]=N.Operation_Alternate;break;case N.CONSTANT_PROPOSE_FOR_INSTANCE:e.options.grid[N.CONSTANT_OPERATION_KEY]=N.Operation_InstanceSubstitute,e.options.grid[N.CONSTANT_INSTANCE_CONTEXT_TITLE]=s;break;case N.CONSTANT_PROPOSE_FOR_REFERENCE:e.options.grid[N.CONSTANT_OPERATION_KEY]=N.Operation_ReferenceSubstitute,e.options.grid[N.CONSTANT_PARENT_CONTEXT_TITLE]=r,e.options.grid[N.CONSTANT_PARENT_CONTEXT_REVISION]=o}e.options.grid[N.CONSTANT_DATAGRID_AVAILABLE_CONTEXT]=n.altAppCore.altItemFactory.getUsageDetails(e),n.altAppCore.altItemFactory.updateAlternateNode(e,a),e.select()},getEscapeHTMLString:function(t){return e.String.escapeHTML(t)}})})),define("DS/ENOXAlternateSubstitute/views/AlternateFacetDragandDrop",["UWA/Core","UWA/Class","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/commands/AddAlternate","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","DS/ENOXAlternateSubstitute/utils/AlternateDataParser","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n,a,i,r,o,s){"use strict";return t.singleton({init:function(e){this._parent(e)},initialize:function(e){this.options=e.options},_dropAlternateItem:function(e){var t=this;if(e.preventDefault(),e.stopPropagation(),this._dndCounter=0,this.elements.container.removeClassName("drag_over_alternate_item"),this._switchContainer("alternateItemsContent"),t.altAppCore.altSettingsManager.isAuthoringAllowed()){this.droppedAlternateItem=JSON.parse(e.dataTransfer.getData("text"));for(var i=[],l=0;l<this.droppedAlternateItem.data.items.length;l++)i.push(this.droppedAlternateItem.data.items[l].objectId);var T={authored:!0,include_param_Attributes:!0,intent:"XEN_attributes",label:t.altAppCore.altSettingsManager.getCVRequestLabel(),nresults:i.length,query:"physicalid:"+i.join(" OR physicalid:"),tenant:t.altAppCore.altSettingsManager.getPlatformId()};t.altAppCore.altDataServices.fetchEngItemAttributes(T).then((function(e){if(Array.isArray(e.results)&&e.results.length>0)for(let t in e.results)if("ds6w:Part"!=e.results[t].attributes.find((e=>"ds6w:globalType"==e.name)).value)return n.errorAlert(s.get("eng.alternate.dnd.add.onlyPhysicalProducts.error.message"));if(null==e.error){for(var i=r.parseFetchedResult(e),l=0;l<i.length;l++)i[l].id=i[l][o.CONSTANT_KEY_PHYSICALID];var T=t.options.activeEngItemTreeInfo._parentNode,A=t.options.activeEngItemTreeInfo._selectedNodes[0];if(T.getID()==A.getID()&&t.altAppCore.altDicoServices.interchangeabilityTypes.length<2){A=t.options.activeEngItemTreeInfo._selectedNodes[0];var d=[];i.forEach((function(e){d.push(a._selectedAlternateItemMapper(e))})),t.addAlternateDataService=a.addAlternateDataService,t.addAlternateSuccessUXModification=a.addAlternateSuccessUXModification,a.addAlternateItem.bind(t)(A,[],null,d)}else a.renderAddAlternateDialog(t),a.onSelectedFromSearchForAlternate(i)}else a.displayAlertMessage(a._contextLabel,s.get("eng.alternate.dnd.add.error.message"),"error")})).catch((function(e){n.errorAlert(s.get("eng.alternate.dnd.add.onlyPhysicalProducts.error.message"))}))}else n.errorAlert(s.get("eng.alternate.dnd.no.authoring.allowed.error.message"))}})})),define("DS/ENOXAlternateSubstitute/utils/AlternateRMBEventHandler",["UWA/Class","DS/WebappsUtils/WebappsUtils","DS/ENOXAlternateSubstitute/commands/AddAlternate","DS/ENOXAlternateSubstitute/utils/AlternateCommands","DS/ENOXEngineerCommonUtils/XENMask","DS/ENOXAlternateSubstitute/components/properties/js/PropertiesFacet","DS/i3DXCompassPlatformServices/OpenWith","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXAlternateSubstitute/commands/GetSuggestionAlternateUsage","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n,a,i,r,o,s,l,T,A){"use strict";var d,N,c,_,u,S,C,g,E,O="fonticon fonticon-open-menu-dot",p="fonticon fonticon-collaborative-lifecycle-management",I="fonticon fonticon-info-open-in-a-new-window";return e.singleton({initialize:function(e){this.options=e.options,this.altOptions=e.altOptions,T.initialize(e)},getRMBMenu:function(e){var t=this,n=e.cellInfos?e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel:null;d=t.options.activeEngItemTreeInfo._selectedNodes;var a=t.options.activeEngItemTreeInfo._parentNode;return c=a.getLabel(),N=a.getID(),_=e.cellInfos.nodeModel.getOnClickContextAlternateItems()[0],n.options.grid[l.CONSTANT_APPLICABILTY],u=n.options.grid[l.CONSTANT_STATUS],S=n.options.grid[l.CONSTANT_OPERATION_KEY],C=!(n.options[l.CONSTANT_OTHER_CONTEXT_KEY]&&(!n.options[l.CONSTANT_OTHER_CONTEXT_KEY]||0!=n.options[l.CONSTANT_OTHER_CONTEXT_KEY].length)),g=n.options[l.CONSTANT_OTHER_CONTEXT_APPLICABLE_DATA_EXISTS],E=t.altOptions.altAppCore.altItemFactory.checkIfAlternateChildNode(n),1==e.isMultiSelectMenu?t.getRMBMultiSelectMenu(e,n):t.getOpenWithRMBMenus(e,n).then((function(a){return t.renderRMBMenu(e,n,a)}))},getRMBMultiSelectMenu:function(e,t){return[this.getMaturityCMDForInterchangeabilityObject("enabled",t)]},renderRMBMenu:function(e,t,n){var i=this,r=[],o=(i.getQualifyState(t),i.getObsoleteState(t),i.getRemoveState()),s=i.getApplicableState(t),d=s==l.CONSTANT_MENU_CMD_STATE_ENABLED?l.CONSTANT_MENU_CMD_STATE_DISABLED:l.CONSTANT_MENU_CMD_STATE_ENABLED,N=l.CONSTANT_MENU_CMD_STATE_DISABLED,_=l.CONSTANT_MENU_CMD_STATE_DISABLED,u=l.CONSTANT_MENU_CMD_STATE_DISABLED,S=i.altOptions.altAppCore.altItemFactory.checkIfHeaderNode(t);if(this.activateProposeFor()&&(N=i.getReferenceState(),_=i.getInstanceState(),u=i.getAllUsageState()),null!=t||null!=t){if(t.select(),s!=l.CONSTANT_MENU_CMD_STATE_ENABLED&&r.push({title:A.get("eng.alternarte.rmb.menu.open.title"),icon:O,type:"PushItem",submenu:n}),!S){var C={};if(C[l.CONSTANT_PROPERTIES_OBJECT_ID]=e.cellInfos.nodeModel.options[l.CONSTANT_ALT_REF_PHYSICALID],C[l.CONSTANT_PROPERTIES_TENANT_ID]=i.altOptions.altAppCore.altSettingsManager.getPlatformId(),C.options=this.altOptions,C.FACET=l.CONSTANT_FACET_PROPERTIES,C[l.CONSTANT_PROPERTIES_READ_ONLY]=!i.altOptions.altAppCore.altSettingsManager.isAuthoringAllowed(),s!=l.CONSTANT_MENU_CMD_STATE_ENABLED&&(r.push({title:A.get("eng.alternarte.rmb.menu.properties.title"),icon:I,type:"PushItem",state:d,action:{this:i,context:C,callback:this._displayPropertiesWidget.bind(this)}}),i.altOptions.altAppCore.altSettingsManager.isAuthoringAllowed()&&(r.push({title:A.get("eng.alternate.rmb.menu.proposedfor.title"),icon:"plus",type:"PushItem",state:d,submenu:[{title:A.get("eng.alternate.add.context.all"),type:"PushItem",state:u,action:{this:i,context:e,callback:this._getAddAsGlobal.bind(this)}},{title:A.get("eng.alternate.add.context.reference").replace("$1",c),type:"PushItem",state:N,action:{this:i,context:e,callback:this._getAddAsReference.bind(this)}},{title:A.get("eng.alternate.add.context.instance"),type:"PushItem",state:_,action:{this:i,context:e,callback:this._getAddAsInstance.bind(this)}}]}),r.push({title:A.get("eng.alternate.remove"),icon:"remove",type:"PushItem",state:o,action:{this:a,context:t,callback:a.removeConfirmPopup}}))),s==l.CONSTANT_MENU_CMD_STATE_ENABLED&&(i.altOptions.altAppCore.altSettingsManager.isAuthoringAllowed()&&r.push({title:A.get("eng.alternate.applicable"),icon:"checkbox-on",type:"PushItem",state:widget.getValue(l.CONSTANT_SELECTED_PRIMARY_ITEM_DIFFERENT_LOGICALID)?l.CONSTANT_MENU_CMD_STATE_ENABLED:l.CONSTANT_MENU_CMD_STATE_DISABLED,action:{this:i,context:e,callback:a.makeApplicable}}),i.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes&&1==i.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes().length)){var g={Alt_ref_ids:e.cellInfos.nodeModel.options[l.CONSTANT_OTHER_CONTEXT_APPLICABLE_ALTERNATE_REF_PHYSICALD],usagesInfo:!0,title:e.cellInfos.nodeModel.getLabel()+" "+e.cellInfos.nodeModel.getReferenceVersion(),navigation:l.CONSTANT_ALTERNATE_USAGE_POPUP_NOT_APPLICABLE_NAVIGATION};r.push({title:A.get("eng.alternarte.suggestion.rmb.menu.usages"),icon:"fonticon fonticon-table",type:"PushItem",action:{this:T,context:g,callback:T.createsuggestionReferenceModel}})}s!=l.CONSTANT_MENU_CMD_STATE_ENABLED&&i.altOptions.altAppCore.altSettingsManager.isAuthoringAllowed()&&r.push({id:l.CHANGE_OWNER_CMD,title:A.get("eng.alternate.change_ownership"),icon:"move-to",type:"PushItem",state:d,action:{this:a,context:t,callback:a.moveToCmdHandler}})}s!=l.CONSTANT_MENU_CMD_STATE_ENABLED&&i.altOptions.altAppCore.altSettingsManager.isAuthoringAllowed()&&r.push(i.getMaturityCMDForInterchangeabilityObject(d,t))}return r},getMaturityCMDForInterchangeabilityObject:function(e,t){return{title:A.get("eng.alternarte.rmb.menu.interchangeabilityMaturity.title"),icon:p,type:"PushItem",state:e,action:{this:this,context:t,callback:a.lifecycleCmdHandler}}},getQualifyState:function(e){var t=l.CONSTANT_MENU_CMD_STATE_DISABLED,n=e.options.grid[l.CONSTANT_WORK_UNDER_CHANGE];return u!=l.CONSTANT_PROPOSED||n||(t=l.CONSTANT_MENU_CMD_STATE_ENABLED),g&&(t=l.CONSTANT_MENU_CMD_STATE_ENABLED),t},getRemoveState:function(){var e=l.CONSTANT_MENU_CMD_STATE_DISABLED;return(u==l.CONSTANT_PROPOSED||g)&&(e=l.CONSTANT_MENU_CMD_STATE_ENABLED),e},getObsoleteState:function(e){var t=l.CONSTANT_MENU_CMD_STATE_DISABLED,n=e.options.grid[l.CONSTANT_WORK_UNDER_CHANGE];return(u==l.CONSTANT_QUALIFIED&&!n||g)&&(t=l.CONSTANT_MENU_CMD_STATE_ENABLED),t},getApplicableState:function(e){var t=l.CONSTANT_MENU_CMD_STATE_DISABLED;return(u==l.CONSTANT_NOT_APPLICABLE||g)&&(t=l.CONSTANT_MENU_CMD_STATE_ENABLED),t},getReferenceState:function(){var e=l.CONSTANT_MENU_CMD_STATE_DISABLED;return u!=l.CONSTANT_PROPOSED||S!=l.Operation_Alternate&&(S!=l.Operation_InstanceSubstitute||!C||E)||this.options.viewInfo._isFlatView||(e=l.CONSTANT_MENU_CMD_STATE_ENABLED),d.length>1&&(e=l.CONSTANT_MENU_CMD_STATE_DISABLED),e},getInstanceState:function(){var e=l.CONSTANT_MENU_CMD_STATE_DISABLED;let t=this.altOptions.altAppCore.altDataServices.shouldShowInstanceAlternates(this.altOptions.selectedNode[0]);return u!=l.CONSTANT_PROPOSED||S!=l.Operation_Alternate&&S!=l.Operation_ReferenceSubstitute||this.options.viewInfo._isReferenceORGroupView||this.options.viewInfo._isFlatView||!t||(e=l.CONSTANT_MENU_CMD_STATE_ENABLED),d.length>1&&(e=l.CONSTANT_MENU_CMD_STATE_DISABLED),e},getAllUsageState:function(){var e=l.CONSTANT_MENU_CMD_STATE_DISABLED;return u!=l.CONSTANT_PROPOSED||S!=l.Operation_ReferenceSubstitute&&S!=l.Operation_InstanceSubstitute||!C||E||(e=l.CONSTANT_MENU_CMD_STATE_ENABLED),d.length>1&&(e=l.CONSTANT_MENU_CMD_STATE_DISABLED),e},activateProposeFor:function(){return!(d[0].getID()==N||this.options.viewInfo._isFlatennedView)},getEmptyMenu:function(){var e=[];return e.push({title:A.get("eng.alternate.rmb.menu.noactions.title"),type:"PushItem",state:l.CONSTANT_MENU_CMD_STATE_DISABLED}),e},getOpenWithRMBMenus:function(e,t){var n=this.altOptions.altAppCore.altItemFactory.getContentForCompassInteraction(t),a=new o;a.set3DXContent(n,!0);var i=[];if(UWA.is(a.retrieveCompatibleApps,"function"))return new Promise((function(e,n){UWA.is(a.retrieveCompatibleApps,"function")?a.retrieveCompatibleApps((function(n){n.forEach((function(e){i.push({id:e.text,title:e.text,icon:e.fonticon?e.fonticon:e.icon,type:"PushItem",multisel:!1,action:{context:t,callback:e.handler}})})),e(i)})):e([])}))},_getLifeCycleCmds:function(e){widget.appMediator.publish(l.EVENT_LAUNCH_COMMAND,{commandId:l.MATURITY_GRAPH_CMD,context:{item:e.context}})},_getRelatedObjects:function(e){widget.appMediator.publish(l.EVENT_LAUNCH_COMMAND,{commandId:l.RELATEDOBJECTS_CMD,context:{item:e.context}})},_getAvailableContexts:function(e){e.context.modelEvents.publish({event:l.CONSTANT_EVENT_TILESVIEW_CONTEXT_CMD,data:e.context.cellInfos.nodeModel})},checkIfValidAlternate:function(e){if(e.grid.WorkUnderChangeActionPhyId&&""!=e.grid.WorkUnderChangeActionPhyId&&!this.altOptions.altAppCore.altSettingsManager.isChangeAuthorized()){var t=A.get("eng.alternate.change.usage.error.msg").replace("$1",e.Title).replace("$2",e.revision);return s.errorAlert(t),!1}return!0},_getAddAsGlobal:function(e){this.checkIfValidAlternate(_)&&n.proposeAlternateItem(d[0],[],null,[_],l.CONSTANT_PROPOSE_FOR_ALL)},_getAddAsReference:function(e){this.checkIfValidAlternate(_)&&n.proposeAlternateItem(d[0],[],N,[_],l.CONSTANT_PROPOSE_FOR_REFERENCE)},_getAddAsInstance:function(e){for(var t=[],a=0;a<d.length;a++)t.push(d[a].getRelationID&&d[a].getRelationID());this.checkIfValidAlternate(_)&&n.proposeAlternateItem(d[0],t,null,[_],l.CONSTANT_PROPOSE_FOR_INSTANCE)},_displayPropertiesWidget:function(e){r._getPropertiesWidget(e)}})})),define("DS/ENOXAlternateSubstitute/commands/RevisionsExplorerForCarryOver",["UWA/Class","DS/Windows/ImmersiveFrame","DS/Handlebars/Handlebars4","DS/Controls/Button","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXEngineerCommonUtils/XENMask","DS/ENOXAlternateSubstitute/views/AlternateGridViewManager","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXAlternateSubstitute/utils/AlternateCommands","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXEngineerCommonUtils/xEngAlertManager","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","text!DS/ENOXAlternateSubstitute/views/html/CarryOverRevisionsDailog.html"],(function(e,t,n,a,i,r,o,s,l,T,A,d,N,c,_,u){return e.singleton({initialize:function(e){this.options=e.options,this.altAppCore=e.altAppCore,this.altOptions=e.altOptions},_initDailogDivs:function(){var e=n.compile(u);this._carryOverAlternateRevisionscontainer=UWA.createElement("div",{class:"enox-alternate-carryover-revisions-wrapper"}),this._carryOverAlternateRevisionscontainer.innerHTML=e({revisionsInfo:!0}),this.RevisionsModal=this._carryOverAlternateRevisionscontainer.querySelector(".enox-alternate-carryOver-revisions"),this._carryOverAlternateRevisionInfo=this._carryOverAlternateRevisionscontainer.querySelector(".enox-alternate-carryOver-revisions-header"),this._revisionsInfoheader=this._carryOverAlternateRevisionInfo?UWA.createElement("div",{class:"enox-alternate-carryOver-revisions-header-container",text:_.get("eng.alternate.carryOver.revisions.model.info")}).inject(this._carryOverAlternateRevisionInfo):"",this.buildRevisionsContent()},renderRevisionsDialog:function(){var e=this,t=e.altOptions.altAppCore.altSettingsManager.getCommand(A.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES),n=t[A.CONSTANT_CARRYOVER_REVISIONS_COLUMN_INFO],a=t[A.CONSTANT_CARRYOVER_ALTERNATE_REVISIONS_COLUMN_OPTIONS],i=l._getDataGridColumns(n,e.altOptions.altAppCore);this.ContextRevisionsModel=new r({shouldBeSelected:function(e){return!0}}),this.getRevisionsOfSelectedObject().then((function(t){var n=[];t.graphs.forEach((t=>{var a=e.altOptions.currentNodeId,i=t.versions;t.item;i.forEach((e=>{e&&e.versionid&&e.logicalid;a!=e.id&&n.push(T.createRevisionsItem(e))}))})),0==n.length?e.altOptions.CarryOver.renderAlternatesDialogOnCarryOver(e.altOptions.selectedNode[0].getID()):(e._initDailogDivs(),e.ContextRevisionsModel.addRoot(n),e.contextRevisionsGridView=e.altOptions.createDataGridView(e.ContextRevisionsModel,i,a),e.contextRevisionsGridView.show(),e.enableSelectEventsOnRevisions(e.contextRevisionsGridView),e.contextRevisionsGridView.inject(e.RevisionsModal))}))},getRevisionsOfSelectedObject:function(){var e=this,t=e.altOptions.currentNodeId;console.log("Inside Revisions of Context Item");var n={},a={};return a[A.CONSTANT_SUGGESTION_VERSION_GRAPH_PAYLOAD_ID]=t,a[A.CONSTANT_VERSION_GRAPH_PAYLOAD_ATTRIBUTE]=e.altOptions.altAppCore.altSettingsManager.getCommand(A.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[A.CONSTANT_VERSION_GRAPH_ATTRIBUTES],n[A.CONSTANT_SUGGESTION_VERSION_GRAPH_PAYLOAD]=[a],o.wrappedWithCancellablePromise((function(t,a){e.altOptions.altAppCore.altDataServices.getRelatedItemsUsingVersionGraphServices(n).then((function(e){if(!e.hasOwnProperty(A.ERROR))return t(e);var n=e.response&&e.response.message?e.response.message:n;c.errorAlert(n)}))})).catch((function(e){return resolve(e)}))},carryOverAlternatesFromSrcToDest:function(e){var t=this,n=e.getPhysicalID(),a=t.altOptions.selectedNode[0].getID();t.altAppCore.altDataServices.getParentPointedAlternateReferenceIds(n).then((function(e){e.referenceIds;s.mask(t.altOptions.getAltFacetMainContainer()),t.altAppCore.altDataServices.performCarryOverRevisions(n,a).then((function(e){"Yes"===e.isBackgroundJobCreated?(s.unmask(t.altOptions.getAltFacetMainContainer()),c.notifyAlert(_.get("eng.alternate.carryover.BG.submitted"))):(t.altOptions.altAppCore.altSettingsManager.setAuthoringMode(A.CONSTANT_AUTHORING_MODE),t.altOptions.CarryOver.renderAlternatesDialogOnCarryOver(a))})).catch((function(e){s.unmask(t.altOptions.getAltFacetMainContainer()),console.log(e);var n=e.response&&e.response.message?e.response.message:n;c.errorAlert(n)}))}))},buildRevisionsContent:function(){var e=this,n=new t;return n.inject(e.altOptions.getAltFacetMainContainer()),e.carryOverRevisionsDialog=new i({title:_.get("eng.alternate.CarryOver.from").replace("$1",this.altOptions.selectedNode[0].getDisplayName()),content:this.RevisionsModal,className:"alternate-revisions-model",immersiveFrame:n,resizableFlag:!0,width:600,height:400,position:{at:"center",my:"center"},modalFlag:!0,touchMode:!0,buttons:{Ok:new a({label:_.get("eng.alternate.button.add.label"),onClick:function(t){var n=e.ContextRevisionsModel.getSelectedNodes()[0];e.carryOverAlternatesFromSrcToDest(n),t.dsModel.dialog.close()}}),Cancel:new a({onClick:function(e){e.dsModel.dialog.close()}})}}),e.carryOverRevisionsDialog.buttons[A.BUTTON_OK].disabled=!0,e.carryOverRevisionsDialog},enableSelectEventsOnRevisions:function(e){var t=this;e.dsModel.addEventListener("click",(function(e,n){null!=n&&n.nodeModel&&(n.nodeModel.onSelect((function(){t.enableDisableAddButton()})),n.nodeModel.onUnselect((function(){t.enableDisableAddButton()})))}))},enableDisableAddButton:function(){var e=this;e.ContextRevisionsModel.getSelectedNodes().length>0?e.carryOverRevisionsDialog.buttons[A.BUTTON_OK].disabled=!1:e.carryOverRevisionsDialog.buttons[A.BUTTON_OK].disabled=!0}})})),define("DS/ENOXAlternateSubstitute/views/AlternateItemViewsManager",["UWA/Core","DS/CoreEvents/ModelEvents","DS/UIKIT/Input/Button","DS/TreeModel/TreeDocument","DS/DataGridView/DataGridView","DS/PlatformAPI/PlatformAPI","DS/Utilities/Utils","DS/ENOXAlternateSubstitute/commands/AddAlternate","DS/ENOXAlternateSubstitute/views/AlternateGridViewManager","DS/ENOXAlternateSubstitute/views/AlternateFacetDragandDrop","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/utils/AlternateUtils","DS/ENOXAlternateSubstitute/utils/AlternateRMBEventHandler","DS/ENOXAlternateSubstitute/utils/AlternateCommands","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],(function(e,t,n,a,i,r,o,s,l,T,A,d,N,c,_,u){"use strict";function S(e){this.buildContentViewer()}return S.prototype.switchView=function(e){var n=this;this.rmbModelEvents=new t,n.hidePreviousView&&n.hidePreviousView(),e==_.CONSTANT_ALTERNATE_VIEW_DATAGRID&&n.buildDataGridViewContent()},S.prototype.enableDisableToolbarCmdsOnUserSelections=function(e){var t=this,n="Mixed",a="",i=!1;if(0==e.length)t.disableToolbarCmds();else{a=a!=n?e[0].options.grid[_.CONSTANT_STATUS]:n;var r=!!e[0].options[_.CONSTANT_OTHER_CONTEXT_APPLICABLE_DATA_EXISTS],o=!!e[0].options.grid[_.CONSTANT_WORK_UNDER_CHANGE];i=e[0].options.grid[_.CONSTANT_STATUS]==_.CONSTANT_NOT_APPLICABLE;for(var s=1;s<e.length;s++){var l=e[s].options.grid[_.CONSTANT_STATUS];e[s].options[_.CONSTANT_OTHER_CONTEXT_APPLICABLE_DATA_EXISTS];e[s].options.grid[_.CONSTANT_WORK_UNDER_CHANGE]&&(o=!0),l==a||r||(a=n),l==_.CONSTANT_NOT_APPLICABLE&&(i=!0)}a==n?(t.disableToolbarCmds(),o||(i?this._enableDisableToolbarCmds(new Array(_.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD),!1):this._enableDisableToolbarCmds(new Array(_.CONSTANT_ALTERNATE_TOOLBAR_ADD_TO_CHANGE_CMD),!0))):(this.disableToolbarCmds(),r?this._enableDisableToolbarCmds(new Array(_.CONSTANT_ALTERNATE_TOOLBAR_REMOVE_CMD,_.CONSTANT_ALTERNATE_TOOLBAR_APPROVE_CMD,_.CONSTANT_ALTERNATE_TOOLBAR_OBSELETE_CMD),!0):t.enableToolbarCmds(a,o)),a==_.CONSTANT_NOT_APPLICABLE||i||this._enableDisableToolbarCmds(new Array(_.CHANGE_OWNER_CMD),!0)}},S.prototype._onContextualEventTilesView=function(e){var t=this;return e.modelEvents=this.alternateResonseTilesView._modelEvents,e.reference=t,t.enableDisableToolbarCmdsOnUserSelections(t.alternateModel.getSelectedNodes()),t.isMultipleNodesSelected()?t.getMultiSelectRMBMenu(e):N.getRMBMenu(e)},S.prototype.buildDataGridViewContent=function(){var e=this;if(this.options.isFromRefreshFacet){this.options.isFromRefreshFacet=!1;let n=l._columnConfiguration(this.altAppCore);var t={treeDocument:e.alternateModel,columns:n,rowSelection:"multiple",cellSelection:"multiple",identifier:"alternate_gridview",useWidgetPreferencesFlag:!0,showContextualMenuColumnFlag:!0,placeholder:e.getGridEmptyView(_.CONSTANT_ALTERNATE_VIEW_DATAGRID),defaultColumnDef:{width:"auto",typeRepresentation:"string",editionPolicy:"EditionOnDoubleClick"},filterViewOptions:{ignoreGroupingNodes:!0},rowGroupingOptions:{hideGroupedColumns:!1},rowDragEnabledFlag:!0,rowReorderEnabledFlag:!1,cellDragEnabledFlag:!0,onDragOverRowHeader:e=>{e.preventDefault()},onDropRowHeader:e=>{e.preventDefault()},onDragOverCell:e=>(e.preventDefault(),!0),onDragOverBlank:e=>{e.preventDefault()},onDropCell:T._dropAlternateItem.bind(e),onDropBlank:T._dropAlternateItem.bind(e)};this.alternateGridView=new i(t).getContent(),this.instanciatedViews[_.CONSTANT_ALTERNATE_VIEW_DATAGRID]=this.alternateGridView.dsModel,this.addFilterModel(n),this.altOptions.customViewOptions.defaultColumns=[...n],this.altOptions.customViewOptions.activeDataGridView=this.alternateGridView.dsModel,this.loadCustomColumns(),this.alternateGridView.dsModel.buildDefaultContextualMenu=function(t,n){var a=t.cellInfos&&t.cellInfos.nodeModel?t.cellInfos.nodeModel:null;return-1!==(t.cellInfos?t.cellInfos.rowID:null)&&a?(a.isSelected()||(this.unselectAll(),a&&a.select()),e.enableDisableToolbarCmdsOnUserSelections(e.alternateModel.getSelectedNodes()),t.modelEvents=e.alternateGridView.dsModel._modelEvents,t.reference=e,e.isMultipleNodesSelected()?e.getMultiSelectRMBMenu(t):a&&a._isFromOriginalModel()?N.getRMBMenu(t):void 0):this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(t,n):[]},this.alternateGridView.dsModel.addEventListener("click",(function(t,n){if(null==n)return e.alternateGridView.dsModel.unselectAll(),void e.disableToolbarCmds();if(n.rowID>-1){var a=t.dsModel.layout.getDataIndexFromColumnIndex(n.columnID);let r=n.nodeModel.options.grid[_.CONSTANT_STATUS]!==_.CONSTANT_NOT_APPLICABLE;if(a==_.CONSTANT_DATAGRID_MATURITY_STATE&&r&&e.altOptions.altAppCore.altSettingsManager.isAuthoringAllowed())e.alternateModel.unselectAll(),n.nodeModel.select(),e._alternateToolbar.alternateCollectionToolBarModelEvents.publish({event:_.MULTI_SELECT_ICON_UPDATE,data:e.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes().length}),r&&widget.appMediator.publish(_.EVENT_LAUNCH_COMMAND,{commandId:_.MATURITY_GRAPH_CMD,context:{item:n.nodeModel}});else if(a==_.CONST_SPEC_RELATION_COLUMN_DATAINDEX&&t.target.hasClassName("wux-tweakers-string-icon")&&r&&e.altOptions.altAppCore.altSettingsManager.isAuthoringAllowed()){e.alternateModel.unselectAll(),n.nodeModel.select(),e._alternateToolbar.alternateCollectionToolBarModelEvents.publish({event:_.MULTI_SELECT_ICON_UPDATE,data:e.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes().length});var i={};i[_.CONSTANT_PROPERTIES_OBJECT_ID]=n.nodeModel.options[_.CONSTANT_ALT_REF_PHYSICALID],i[_.CONSTANT_PROPERTIES_TENANT_ID]=e.altOptions.altAppCore.altSettingsManager.getPlatformId(),i.options=e.altOptions,i.FACET=_.CONST_SPEC_FACET_NAME,N._displayPropertiesWidget({context:i})}else a==_.DS6W_RESPONSIBLE&&"a"===t.target.getTagName()&&r&&e.altOptions.altAppCore.altSettingsManager.isAuthoringAllowed()?(e.alternateModel.unselectAll(),n.nodeModel.select(),e._alternateToolbar.alternateCollectionToolBarModelEvents.publish({event:_.MULTI_SELECT_ICON_UPDATE,data:e.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes().length}),c.moveToCmdHandler()):a==_.DS6W_RESERVED&&t.target.hasClassName("wux-tweakers-string-icon")&&r&&e.altOptions.altAppCore.altSettingsManager.isAuthoringAllowed()?(e.alternateModel.unselectAll(),n.nodeModel.select(),e._alternateToolbar.alternateCollectionToolBarModelEvents.publish({event:_.MULTI_SELECT_ICON_UPDATE,data:e.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes().length}),c.lockCmdHandler()):(n.nodeModel.onSelect((function(){e.enableDisableToolbarCmdsOnUserSelections(e.alternateModel.getSelectedNodes())})),n.nodeModel.onUnselect((function(){0==e.alternateModel.getSelectedNodes().length?e.disableToolbarCmds():e.enableDisableToolbarCmdsOnUserSelections(e.alternateModel.getSelectedNodes())})),-1===n.columnID&&(e.manageHeaderNodeSelection(n&&n.nodeModel),e.altAppCore.altItemFactory.openItemWithCompass(n&&n.nodeModel)))}else e.alternateModel.getSelectedNodes().length>0?e.enableDisableToolbarCmdsOnUserSelections(e.alternateModel.getSelectedNodes()):e.disableToolbarCmds()})),e.alternateGridView.dsModel.onDelayedModelDataRequest=o.debounce((function(t){if(t&&t.collectionView&&t.collectionView.model){var n=t.collectionView.model.slice(t.startNodeIndex,t.endNodeIndex+1);Array.isArray(n)&&n.length>0&&e.altAppCore.altDicoServices.loadAChunk(n)}}),1e3),e.alternateGridView.dsModel.onDragStartCell=(t,n)=>{n.nodeModel;t.dataTransfer.effectAllowed="all";const a=d.prepareDragData(e.alternateModel.getSelectedNodes());return t.dataTransfer.setData("Text",a),!1},this.instanciatedViews.AlternateDataGridView._customViewsManager.onCustomViewsSave=function(t,n){e.altAppCore.altDicoServices.updateAdditionalColumnsAndBOs(),e.altAppCore.altDicoServices.applyCustomAttributes(t,n,e.altOptions.customViewOptions);let a=[];e.alternateModel.getAllDescendants().forEach((e=>{d.isNodeFromModel(e)&&a.push(e)})),e.altAppCore.altGridViewManager.publishNodesToRefresh(a,e.altAppCore.altDicoServices.additionalColumnsAndBOs.additionalColumns),e.instanciatedViews.AlternateDataGridView.getTreeDocument().reapplyFilterModel()}}let n=this.getPreferences();if(n&&n.alternate_gridview){this.instanciatedViews.AlternateDataGridView.loadCustomViews(n.alternate_gridview.customViews,n.alternate_gridview.currentCustomViewId);let t=null;n.alternate_gridview.customViews&&n.alternate_gridview.customViews.forEach((e=>{e.identifier==n.alternate_gridview.currentCustomViewId&&(t=e.groupingOptions)})),e.instanciatedViews.AlternateDataGridView.groupRows(t),e.instanciatedViews.AlternateDataGridView.sortModel=Array.isArray(n.alternate_gridview.columnsSortModel)?n.alternate_gridview.columnsSortModel:[],e.instanciatedViews.AlternateDataGridView.reapplySortModel()}this.instanciatedViews.AlternateDataGridView.getTreeDocument().reapplyFilterModel(),this.alternateGridView.dsModel.elements.container.classList.add("visible"),this.alternateResonseTilesView&&this.alternateResonseTilesView.hide(),this.alternateGridView.show(),this.alternateGridView.inject(this._dataContainer),this.activeView=_.CONSTANT_ALTERNATE_VIEW_DATAGRID},S.prototype.loadCustomColumns=function(){let e=this.getPreferences();e&&e.alternate_gridview&&this.altAppCore.altDicoServices.restoreCustomViews(e.alternate_gridview,this.altOptions.customViewOptions)},S.prototype.getPreferences=function(){let e=widget.getValue("wux-collectionView-dataGridView");return e?JSON.parse(e):null},S.prototype.isMultipleNodesSelected=function(){var e=this._addAlternateUX.ALTERNATE.model.getSelectedNodes();return Array.isArray(e)&&e.length>1},S.prototype.getApplicablityOfNodesSelected=function(){var e=this._addAlternateUX.ALTERNATE.model.getSelectedNodes();let t=new Set;if(Array.isArray(e)&&e.length>1)for(var n=0;n<e.length;n++)e[n].options.grid[_.CONSTANT_STATUS]==_.CONSTANT_NOT_APPLICABLE?t.add(_.CONSTANT_NON_APPLIACABLE):t.add(_.CONSTANT_APPLIACABLE);let a=[...t];return a.length>1?_.CONSTANT_MIXED_APPLICABILITY:a[0]},S.prototype.getMultiSelectRMBMenu=function(e){let t=this.getApplicablityOfNodesSelected();return _.CONSTANT_APPLIACABLE===t?(e.isMultiSelectMenu=!0,N.getRMBMenu(e)):_.CONSTANT_NON_APPLIACABLE===t?(e.reference=this,N.getRMBMenu(e)):N.getEmptyMenu()},S.prototype.buildContentViewer=function(){var e=this;this.instanciatedViews={},null==e.alternateModel&&(e.alternateModel=new a({shouldBeSelected:function(e){return e.options.grid[_.CONSTANT_APPLICABILTY]==_.CONSTANT_YES||e.options.grid[_.CONSTANT_SPLIT]==_.CONSTANT_YES}})),e.alternateModel.collapseAll(),this._addAlternateUX.ALTERNATE={model:e.alternateModel,isInjected:!1,update:function(t){e._addAlternateUX.ALTERNATE.model.empty(),e._addAlternateUX.ALTERNATE.model.addRoot(t),e._addAlternateUX.ALTERNATE.model.isGroupedByView=!1},append:function(t){e._addAlternateUX.ALTERNATE.model.unselectAll(),e._addAlternateUX.ALTERNATE.model.addRoot(t),t.forEach((function(e){e.select()})),e.enableDisableToolbarCmdsOnUserSelections(e.alternateModel.getSelectedNodes())}},this.altOptions.customViewOptions={activeDataGridView:null,defaultColumns:[]},r.subscribe("DS/PADUtils/PADCommandProxy/refresh",(function(t){if(console.log("From Alternate"),t.data.authored&&t.data.authored.modified){console.log(t);let n=e.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes(),a=[],i=[];for(let e of n)t.data.authored.modified.includes(e.getInterchangeabilityID())&&(a.push(e.getInterchangeabilityID()),i.push(e));e.updateCustomAttributeEvents.publish({event:"db_nodes_loaded",data:i}),a.length>0?e.altAppCore.altDataServices.getUsagesInfoForAlternates(t.data.authored.modified).then((function(t){if(t){let n={};for(let e of t.AlternateItemInfo)n[e[_.CONSTANT_CARRYOVER_ALT_REF_PHYSICALID]]=e;e.updateInterchangeabilityMaturityColumn(e.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes(),n)}else console.log(t)})):e.altAppCore.altDataServices.fetchedObjectInfo(t.data.authored.modified,"0").then((function(t){t?e.updateMaturityColumn(n,t):console.log(t)}))}}))},S.prototype.removeEmptyView=function(){var e=this;if(e.emptyView){try{e.emptyView._containerEmptyContent&&(e._dataContainer.removeChild(e.emptyView._containerEmptyContent),e.emptyView._containerEmptyContent.innerHTML=""),e.emptyView.destroy()}catch(e){console.error(e)}e.emptyView=null}e._emptyViewRendered=!1},S.prototype.hidePreviousView=function(){var e=this;Object.keys(this.instanciatedViews).forEach((function(t){e.instanciatedViews[t].elements.container.classList.remove("visible")})),e._emptyViewRendered&&e.removeEmptyView()},S.prototype.getGridOptions=function(e){var t=new n({value:u.get("eng.alternate.views.tiles.addInstance.title"),className:"primary"});return{sentences:this._buildSentences(t),fontSize:"16px",orderedListType:"none",modelEvents:this._modelEvents}},S.prototype._buildSentences=function(e){let t=[];if(this.altOptions.altAppCore.altSettingsManager.isAuthoringAllowed())t.push({type:"drop",text:u.get("eng.alternate.views.tiles.dnd.title")},{type:"dom",DOMelement:e.getContent(),events:{onclick:function(){s.renderAddAlternateDialog()}}});else{let e=document.createElement("h2");e.innerText=u.get("eng.alternate.read.only.nodata.available"),e.style.color="#77797c",t.push({type:"dom",DOMelement:e})}return t},S.prototype.getGridEmptyView=function(e){return this._instanciateEmptyViewer(this.getGridOptions(e))},S.prototype._instanciateEmptyViewer=function(e){return this.altAppCore.altDataServices.temporaryLoadEmptyView(e)},S.prototype.refreshFilterView=function(){var e=this;e.altFilterManager.filterModel={},e._addAlternateUX.ALTERNATE.model._getTrueRoot().getTreeDocument().setFilterModel(e.filterModel),0==Object.keys(e.filterModel).length||0==e._addAlternateUX.ALTERNATE.model._getTrueRoot().getNumberOfVisibleChildren()&&e._addAlternateUX.ALTERNATE.model._getTrueRoot().getNumberOfDescendants()>0?(e._dataContainer.hide(),e.filterEmptyResultDOM.show()):(e._dataContainer.show(),e.filterEmptyResultDOM.hide())},S.prototype.groupAlternateNodes=function(e){var t=this;e.context==_.CONSTANT_NONE?(t.altOptions._addAlternateUX.ALTERNATE.model.ungroupRoots(),t.altOptions._addAlternateUX.ALTERNATE.model.isGroupedByView=!1):(t.altOptions._addAlternateUX.ALTERNATE.model.ungroupRoots(),t.altOptions._addAlternateUX.ALTERNATE.model.groupRoots({propertiesToGroup:[e.context]}),t.altOptions._addAlternateUX.ALTERNATE.model.isGroupedByView=!0,t.altOptions._addAlternateUX.ALTERNATE.model.groupedByProperty=e.context)},S.prototype.updateInterchangeabilityMaturityColumn=function(e,t){for(var n=this,a=0;a<e.length;a++)if(t&&t[e[a].getInterchangeabilityID()]){var i=t[e[a].getInterchangeabilityID()],r=i[_.CONSTANT_STATUS]!==_.CONSTANT_FROZEN?n.altAppCore.altDataServices.getNlsOfPropertiesValues()[_.CONSTANT_DS6W_STATUS][i[_.CONSTANT_STATUS]]:i[_.CONSTANT_STATUS];e[a].options.grid[_.CONSTANT_STATUS]=r,e[a].options[_.CONSTANT_STATUS]=r,n.altAppCore.altItemFactory.updateAlternateNode(e[a]),e[a].select()}n.instanciatedViews.AlternateDataGridView.treeDocument.reapplyFilterModel(),n.altAppCore.altItemFactory.updateGroupBy(),n.enableDisableToolbarCmdsOnUserSelections(e)},S.prototype.updateMaturityColumn=function(e,t){for(var n=this,a=0;a<e.length;a++)if(t&&t[e[a].getID()]){var i=t[e[a].getID()],r=(e[a]._getRowID(),n.altAppCore.altDataServices.getNlsOfPropertiesValues()[_.CONSTANT_DS6W_STATUS][i[_.CONSTANT_DS6W_STATUS]]);if(e[a].options.grid[_.CONSTANT_DATAGRID_MATURITY_STATE]=r,e[a].options.grid[_.CONSTANT_DATAGRID_MATURITY_STATE_DB_NAME]=i[_.CONSTANT_DS6W_STATUS],n.altAppCore.altItemFactory.checkIfAlternateChildNode(e[a])||n.altAppCore.altItemFactory.checkIfHeaderNode(e[a])){var o=n.altAppCore.altItemFactory.checkIfHeaderNode(e[a])?e[a]:e[a]._parentNode;o.options.grid[_.CONSTANT_DATAGRID_MATURITY_STATE]=r,o.getChildren().forEach((function(e){e.options.grid[_.CONSTANT_DATAGRID_MATURITY_STATE]=r}))}n.altAppCore.altItemFactory.updateAlternateNode(e[a]),e[a].select()}n.instanciatedViews.AlternateDataGridView.treeDocument.reapplyFilterModel(),n.altAppCore.altItemFactory.updateGroupBy()},S.prototype.updateCustomAttributeColumn=function(e,t,n,a){for(var i=this,r=0;r<e.length;r++){let l=e[r].isSelected();if(n&&n[e[r].getInterchangeabilityID()]){for(let l of t){var o=n[e[r].getInterchangeabilityID()],s=o[l];let t=a.filter((e=>e.dataIndex==l)),T=i.altAppCore.altDicoServices.isMultiValuedAttribute(t[0].dataIndex,t[0].name),A=i.altAppCore.altDicoServices.isPredicateAttribute(t[0].dataIndex,t[0].name);if((T||A)&&(s=(s=s.replace(/(\x07)/g,",")).split(",")),e[r].options.grid[l]=s,e[r].options[l]=s,l==_.DS6W_LABEL&&(e[r].options.grid[_.CONSTANT_ALT_REF_TITLE]=s,e[r].options[_.CONSTANT_ALT_REF_TITLE]=s),l==_.DS6W_RESPONSIBLE&&(e[r].options.grid[_.CONSTANT_ALT_REF_OWNER]=o[_.CONSTANT_ALT_REF_OWNER],e[r].options[_.CONSTANT_ALT_REF_OWNER]=o[_.CONSTANT_ALT_REF_OWNER]),l==_.DS6W_TYPE){let t=i.altAppCore.altDataServices.getNlsOfPropertiesValues()[_.DS6W_TYPE];e[r].options.grid[_.DS6W_TYPE]=t[s]?t[s]:s,e[r].options[_.DS6W_TYPE]=t[s]?t[s]:s}l==_.DS6W_RESERVED&&(e[r].options.grid[_.DS6W_RESERVEDBY]=o[_.DS6W_RESERVEDBY],e[r].options[_.DS6W_RESERVEDBY]=o[_.DS6W_RESERVEDBY])}e[r].options.grid[_.CONSTANT_WORK_UNDER_CHANGE_ID]=n[e[r].getInterchangeabilityID()][_.CONSTANT_WORK_UNDER_CHANGE_ID],e[r].options[_.CONSTANT_WORK_UNDER_CHANGE_ID]=n[e[r].getInterchangeabilityID()][_.CONSTANT_WORK_UNDER_CHANGE_ID],i.altAppCore.altItemFactory.updateAlternateNode(e[r])}l&&e[r].select()}i.instanciatedViews.AlternateDataGridView.treeDocument.reapplyFilterModel(),i.altAppCore.altItemFactory.updateGroupBy()},S.prototype.createDataGridView=function(e,t,n){var a={treeDocument:e,columns:t,rowSelection:n.rowSelection?n.rowSelection:"multiple",showSelectionCheckBoxesFlag:n.showSelectionCheckBoxesFlag?n.showSelectionCheckBoxesFlag:"OnOver",showRowIndexFlag:!n.hasOwnProperty("showRowIndexFlag")||n.showRowIndexFlag,cellSelection:n.cellSelection?n.cellSelection:"multiple",identifier:n.identifier?n.identifier:"XEN-DatagridView_alternate_gridView",defaultColumnDef:{width:"auto",typeRepresentation:"string"}};return new i(a).getContent()},S})),define("DS/ENOXAlternateSubstitute/commands/AlternateFacetContentBuilder",["UWA/Core","DS/CoreEvents/ModelEvents","UWA/Controls/Abstract","DS/Controls/Button","DS/UIKIT/Input/Toggle","DS/UIKIT/SuperModal","DS/Windows/ImmersiveFrame","DS/PlatformAPI/PlatformAPI","DS/ENOXAlternateSubstitute/components/AlternateFilter","DS/UIKIT/DropdownMenu","DS/UIKIT/Iconbar","DS/UIKIT/Tooltip","DS/ENOXEngineerCommonUtils/XENMask","DS/ResizeSensor/js/ResizeSensor","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/commands/AddAlternate","DS/ENOXAlternateSubstitute/commands/CarryOverFromRevision","DS/ENOXAlternateSubstitute/commands/RevisionsExplorerForCarryOver","DS/ENOXAlternateSubstitute/commands/GetAlternates","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOXAlternateSubstitute/services/AlternateSubstituteServices","DS/ENOXAlternateSubstitute/components/AlternateToolBar","DS/ENOXAlternateSubstitute/views/AlternateItemViewsManager","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","DS/ENOXAlternateSubstitute/views/AlternateFacetDragandDrop","DS/ENOXAlternateSubstitute/utils/AlternateCommands","DS/ENOXAlternateSubstitute/commands/AddSuggestionAlternate","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXAlternateSubstitute/utils/AlternateDataParser","DS/ENOXAlternateSubstitute/utils/AlternateRMBEventHandler","DS/ENOXAlternateSubstitute/services/AlternateItemsFactory","DS/ENOXAlternateSubstitute/views/AlternateGridViewManager","DS/ENOXAlternateSubstitute/services/AlternateDicoServices","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","css!DS/ENOXAlternateSubstitute/styles/Alternate.css"],(function(e,t,n,a,i,r,o,s,l,T,A,d,N,c,_,u,S,C,g,E,O,p,I,h,f,m,R,D,M,L,b,v,P,y,U){"use strict";return n.extend(h,{_addAlternateUX:{},_informationBox:null,_informationContainerBox:null,currentNodeId:null,selectionType:null,alternatesOnSelectedNode:null,alternateManagementConfigurations:{},isChangeEnforced:!1,hasAlternatesInOtherContexts:!1,existedAlternateItems:[],_dndCounter:0,activeView:null,init:function(t){this._parent(t),this.appCore=t.appCore,this.altAppCore={},this.altAppCore.altFacetMainContainer=document.getElementsByClassName("floatingPanelComponent").length>0&&document.getElementsByClassName("uwa-framed")&&document.getElementsByClassName("uwa-framed").length>0?document.getElementsByClassName("uwa-framed")[0]:t.altfacetContainer,this.altAppCore.altSettingsManager=O,O.initialize(t),this.altAppCore.altItemFactory=v,v.initialize(this),this.altAppCore.altDataServices=p,p.initialize(this.altAppCore),this.altOptions=this,this.altAppCore.altDicoServices=y,y.initialize(this),S.initialize(this),m.initialize(this),R.initialize(this),b.initialize(this),D.initialize(this),this.altAppCore.altGridViewManager=P,P.initialize(this),C.initialize(this),this.altOptions.CarryOver=C,g.initialize(this),this.altOptions.CarryOverRevisions=g,this.alternateManagementConfigurations=t.alternateManagementConfigurations,this.setEnforcedChange(),this.elements.container=e.createElement("div",{class:"alternate_container"}),this._selectedUsageInfo=e.createElement("div",{class:"alternate_usageInfo_container"}).inject(this.elements.container),this._toolBarContainer=e.createElement("div",{class:"alternate_ToolBar_container"}).inject(this.elements.container),this._filterContainer=e.createElement("div",{class:"alternate_Filter_container"}).inject(this._toolBarContainer),this._rightMenuContainer=e.createElement("div",{class:"alternate_ToolBar_commands_container"}).inject(this._toolBarContainer),this._dataContainer=e.createElement("div",{class:"alternate_Data_container"}).inject(this.elements.container),this.filterEmptyResultDOM=e.createElement("div",{class:"alternate-empty-filter-result"}).inject(this.elements.container),this._buildAlternateMessageDisplayContent(),this._buildEmptyFilterDOM(this.filterEmptyResultDOM),this._buildAlternateModel(),this._buildDnDEvents(),this.loadSourceOptions()},getAltFacetMainContainer:function(){return this.altAppCore.altFacetMainContainer},_buildDnDEvents:function(){},_buildEmptyFilterDOM:function(t){this.filterIconDom=e.createElement("span",{class:"fonticon fonticon-list-filter"});e.createElement("div",{class:"alternate-empty-filter-container",html:[e.createElement("div",{class:"alternate-empty-filter-label",html:U.get("eng.alternate.filter.empty.view.label")}),e.createElement("div",{class:"alternate-empty-filter-sublabel",html:U.get("eng.alternate.filter.empty.view.sublabel")+this.filterIconDom.outerHTML})]}).inject(t);t.hide()},_buildAlternateModel:function(){this.activeView=M.CONSTANT_ALTERNATE_VIEW_DATAGRID,this.initializeUsageInfoDivs(),this.initializeToolbar(),this.buildContentViewer()},addFilterModel:function(e){let t=this;const n=e.filter((e=>0!=e.filterableFlag&&"ContextualMenuColumn"!=e.dataIndex)),a=e.filter((e=>e.children));let i=n.reduce(((e,t)=>{switch(t.dataIndex){case"tree":e.label={filterId:"stringRegexp"};break;case"revision":case"AlternateItemCurrentState":e[t.dataIndex]={filterId:"set"};break;default:"boolean"===t.typeRepresentation?e[t.dataIndex]={filterId:"set"}:"string"===t.typeRepresentation?e[t.dataIndex]={filterId:"stringRegexp"}:"integer"===t.typeRepresentation||"float"===t.typeRepresentation?e[t.dataIndex]={filterId:"number"}:"datetime"===t.typeRepresentation?e[t.dataIndex]={filterId:"date"}:e[t.dataIndex]={filterId:"stringRegexp"}}return e}),{});a.forEach((e=>{let n=[];e.children.forEach((e=>{0!=e.filterableFlag&&n.push(e)})),i={...i,...t.getCustomFilterModel(n)}})),this.instanciatedViews.AlternateDataGridView.treeDocument.getFilterManager().filterModel,this.instanciatedViews.AlternateDataGridView.getTreeDocument().setFilterModel(i)},getCustomFilterModel:function(e){return e.reduce(((e,t)=>{switch(t.dataIndex){case"tree":e.label={filterId:"stringRegexp"};break;case"revision":case"AlternateItemCurrentState":case"Status":case"UsageScope":case"ds6w:type":case"ds6wg:revision":case"ActiveChange":case"ds6w:reservedBy":case"ds6w:responsible":e[t.dataIndex]={filterId:"set"};break;default:"boolean"===t.dataType?e[t.dataIndex]={filterId:"set"}:"string"===t.dataType?e[t.dataIndex]=t.range?{filterId:"set"}:{filterId:"stringRegexp"}:"integer"===t.dataType||"float"===t.dataType||"number"===t.dataType||"float"===t.dataType||"real"===t.dataType?e[t.dataIndex]={filterId:"number"}:"datetime"===t.dataType?e[t.dataIndex]={filterId:"date"}:e[t.dataIndex]={filterId:"stringRegexp"}}return e}),{})},initializeUsageInfoDivs:function(){this.nameDiv=e.createElement("span",{class:"alternate_usageInfo_container_name"}).inject(this._selectedUsageInfo),this.nameDiv.innerText=U.get("eng.alternate.usage.info.title"),this.valueDiv=e.createElement("span",{class:"alternate_usageInfo_container_value"}).inject(this._selectedUsageInfo)},renderSelectedPrimaryObjectInfo:function(t){var n="",a="";let i=this.altAppCore.altDataServices.shouldShowInstanceAlternates(this.selectedNode[0]);if(this.selectedNode[0].getID()==this.parentNode.getID())n=this.parentNode.getDisplayName(),a=U.get("eng.alternate.usage.info.reference");else if(this.options.viewInfo._isReferenceOrFlattenedORGroupView||!i)n=this.selectedNode[0].getDisplayName(),a=U.get("eng.alternate.usage.info.reference");else{let e=this.selectedNode[0].getInstanceTypeNLS&&this.selectedNode[0].getInstanceTypeNLS()?this.selectedNode[0].getInstanceTypeNLS():"";this.selectedNode.length>1?(a=U.get("eng.alternate.usage.info.instance.multiple").replace("$1",this.selectedNode.length).replace("$2",e),this.selectedNode.forEach((function(e){n+=e.getInstanceName()+", "})),n=n.substring(0,n.length-2)):(n=this.selectedNode[0].getInstanceName(),a=U.get("eng.alternate.usage.info.instance").replace("$1",this.selectedNode.length).replace("$2",e))}const r=e.String.escapeHTML(n);t.innerText="",t.addContent(a.bold()+" "+r),null==this.usageInfoTooltip&&(this.usageInfoTooltip=new d({position:"top",target:t}));var o=e.createElement("div",{class:"alternate_usageInfo_tooltip",html:a+" "+r});this.usageInfoTooltip.setBody(o)},initializeToolbar:function(){var e=this;this.alternateCollectionToolBarModelEvents=new t,this.eventsTokens=[],this.eventsTokens.push(e.alternateCollectionToolBarModelEvents.subscribe({event:M.TOOLBAR_SWITCH_VIEW},(function(t){console.warn("switching view to  alternate --\x3e "+t),e.switchView(t);let n=t==M.CONSTANT_ALTERNATE_VIEW_DATAGRID;e._showHideToolbarCmds(new Array(M.CONSTANT_ALTERNATE_TOOLBAR_CUSTOMIZE_TABLE_CMD),n)}))),this.eventsTokens.push(e.alternateCollectionToolBarModelEvents.subscribe({event:M.HIDE_SHOW_MAKE_APPLICABLE_CMD},(function(t){e._showHideToolbarCmds(new Array(M.CONSTANT_ALTERNATE_TOOLBAR_MAKE_APPLICABLE_CMD),t)}))),this.eventsTokens.push(e.altOptions.alternateEnableDisableCommandEvents.subscribe({event:M.MULTI_SELECT_ENABLE_DISABLE_MAKE_APPLICABLE_CMD},(function(){e.enableDisableToolbarCmdsOnUserSelections(e._addAlternateUX.ALTERNATE.model.getSelectedNodes())}))),this.eventsTokens.push(e.alternateCollectionToolBarModelEvents.subscribe({event:M.MULTI_SELECT_ICON_UPDATE},(function(t){e.altAppCore.altSettingsManager.isAuthoringAllowed()&&e._alternateToolbar._updateIconMultiselectNumber(t)}))),e._alternateToolbar=new I({modelEvents:this.alternateCollectionToolBarModelEvents,container:this._rightMenuContainer,ListView:e}),e.buildToolBar()},buildToolBar:function(){if(!this._alternateToolbar)throw new Error(" toolbar not yet initialized");this._alternateToolbar.AddToolbarCommands(this.getSupportedToolBarActions())},getSupportedToolBarActions:function(){return R.getToolbarCmds((function(){S.renderAddAlternateDialog()}))},setEnforcedChange:function(){var e=this.alternateManagementConfigurations;this.isChangeEnforced=e&&e.EnforceChangeRequired&&null!=e.EnforceChangeRequired&&null!=e.EnforceChangeRequired?e.EnforceChangeRequired:this.isChangeEnforced},getEnforcedChange:function(){return this.isChangeEnforced},manageHeaderNodeSelection:function(e){var t=this,n=e&&e._parentNode;t.altAppCore.altItemFactory.checkIfHeaderNode(e)?e.getChildren()&&e.getChildren().forEach((function(n){t.altAppCore.altItemFactory.checkIfNodeSelected(e)?n.select():n.unselect()})):t.altAppCore.altItemFactory.checkIfAlternateChildNode(e)&&(t.altAppCore.altItemFactory.checkIfNodeSelected(e)||n.unselect())},_showHideToolbarCmds:function(e,t){this._alternateToolbar._actionsIconBar.menu.items.forEach((function(n){for(var a=0;a<e.length;a++)if(n.id==e[a]){t?n.elements.container.removeClassName("enox-alternate-toolbar-item-hide"):n.elements.container.addClassName("enox-alternate-toolbar-item-hide");break}}))},_enableDisableToolbarCmds:function(e,t){var n=this;n._alternateToolbar._actionsIconBar.menu.items.forEach((function(a){for(var i=0;i<e.length;i++)if(a.id==e[i]){t?(a.elements.container.removeClassName("enox-alternate-toolbar-item-disable"),n._alternateToolbar._actionsIconBar.enableItem(a.id)):(a.elements.container.addClassName("enox-alternate-toolbar-item-disable"),n._alternateToolbar._actionsIconBar.disableItem(a.id));break}}))},disableToolbarCmds:function(){this._alternateToolbar.alternateCollectionToolBarModelEvents.publish({event:M.MULTI_SELECT_ICON_UPDATE,data:this.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes().length}),this._enableDisableToolbarCmds(new Array(M.CONSTANT_ALTERNATE_TOOLBAR_REMOVE_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_APPROVE_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_OBSELETE_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_ADD_TO_CHANGE_CMD,M.CHANGE_OWNER_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_MAKE_APPLICABLE_CMD),!1),this._enableDisableToolbarCmds(new Array(M.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD),!0)},enableToolbarCmds:function(e,t){this._enableDisableToolbarCmds(new Array(M.CHANGE_OWNER_CMD),!0),M.CONSTANT_PROPOSED==e?t?this._enableDisableToolbarCmds(new Array(M.CONSTANT_ALTERNATE_TOOLBAR_REMOVE_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD),!0):this._enableDisableToolbarCmds(new Array(M.CONSTANT_ALTERNATE_TOOLBAR_REMOVE_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_APPROVE_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_ADD_TO_CHANGE_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD),!0):M.CONSTANT_FROZEN==e?t||this._enableDisableToolbarCmds(new Array(M.CONSTANT_ALTERNATE_TOOLBAR_APPROVE_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_ADD_TO_CHANGE_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD),!0):M.CONSTANT_QUALIFIED==e?t||this._enableDisableToolbarCmds(new Array(M.CONSTANT_ALTERNATE_TOOLBAR_OBSELETE_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_ADD_TO_CHANGE_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD),!0):M.CONSTANT_NOT_APPLICABLE==e&&(this._enableDisableToolbarCmds(new Array(M.CONSTANT_ALTERNATE_TOOLBAR_REMOVE_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_APPROVE_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_OBSELETE_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_ADD_TO_CHANGE_CMD,M.CHANGE_OWNER_CMD,M.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD),!1),this._enableDisableToolbarCmds(new Array(M.CONSTANT_ALTERNATE_TOOLBAR_MAKE_APPLICABLE_CMD),widget.getValue(M.CONSTANT_SELECTED_PRIMARY_ITEM_DIFFERENT_LOGICALID)))},getTruncatedMessage:function(e){var t=e;return-1!=e.indexOf("Severity:")&&-1!=(t=t.replace(new RegExp("Severity:.*"),"")).indexOf(":")&&(t=t.replace(new RegExp(".*:"),"")),t},approveAlternate:function(){var e=this;e.altAppCore.altDataServices.approveAlternateItems(e).then((function(t){if(t[M.CONSTANT_ACTION]==M.SUCCESS){e.altAppCore.altSettingsManager.setAuthoringMode(M.CONSTANT_AUTHORING_MODE);var n=e._addAlternateUX.ALTERNATE.model.getSelectedNodes();e.updateStatusColumn(n,[M.CONSTANT_PROPOSED,M.CONSTANT_FROZEN]),e.enableDisableToolbarCmdsOnUserSelections(e.alternateModel.getSelectedNodes()),u.sucessAlert(U.get("eng.alternate.approve.success"))}else u.errorAlert(e.getTruncatedMessage(t.response.message))}))},removeAlternate:function(){var e=this;e.altAppCore.altDataServices.removeAlternateItems(e).then((function(t){if(t[M.CONSTANT_ACTION]==M.SUCCESS)e.removeDeletedRows(),e.altAppCore.altSettingsManager.setAuthoringMode(M.CONSTANT_AUTHORING_MODE),u.sucessAlert(U.get("eng.alternate.remove.success.message"));else{if(t.response&&t.response.message&&t.response.message.contains("access"))return void u.errorAlert(U.get("eng.alternate.modify.access.error"));u.errorAlert(e.getTruncatedMessage(t.response.message))}}))},selectionModified:function(e,t,n,a){var i=this;N.mask(this.elements.container),this.selectionType=a,this.currentNodeId=n,this.selectedNode=e,this.parentNode=t,i._switchContainer("alternateItemsContent"),i.renderSelectedPrimaryObjectInfo(this.valueDiv),i._updateAlternateItemView(e[0]),i.disableToolbarCmds()},_updateAlternateItemView:function(e){var t=this;E.getAlternates(t,e.getID()).then((function(e){t.hasAlternatesInOtherContexts=!1,t.alternatesOnSelectedNode=L.mergeItemsOnAlternateCriteria(e);var n=f.createAlternateItemNodes(t.alternatesOnSelectedNode);t._getMakeApplicableCmdFlag(t.alternatesOnSelectedNode),t._addAlternateUX.ALTERNATE.update(n),t._alternateToolbar.alternateCollectionToolBarModelEvents.publish({event:M.MULTI_SELECT_ICON_UPDATE,data:t.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes().length}),t.updateCustomAttributeEvents.publish({event:"db_nodes_loaded",data:n}),t.switchView(t.activeView);let a=t.activeView==M.CONSTANT_ALTERNATE_VIEW_DATAGRID;t._showHideToolbarCmds(new Array(M.CONSTANT_ALTERNATE_TOOLBAR_CUSTOMIZE_TABLE_CMD),a)})).catch((function(e){console.error(e)})).finally((function(){N.unmask(t.elements.container)}))},_getMakeApplicableCmdFlag:function(e){var t=!1;for(var n of e)if(n[M.CONSTANT_STATUS]==M.CONSTANT_NOT_APPLICABLE){t=!0,widget.getValue(M.CONSTANT_SELECTED_PRIMARY_ITEM_DIFFERENT_LOGICALID)||u.warningAlert(U.get("eng.alternate.primaryitem.multiselect.warning.message"));break}this._alternateToolbar.alternateCollectionToolBarModelEvents.publish({event:M.HIDE_SHOW_MAKE_APPLICABLE_CMD,data:t})},updateStatusColumn:function(e,t){for(var n=this,a=0;a<e.length;a++){if(!n.altAppCore.altItemFactory.checkIfHeaderNode(e[a])){e[a]._getRowID();n.updateStatusInGrid(e[a].options,t);e[a]._parentNode;n.altAppCore.altItemFactory.checkIfAlternateChildNode(e[a])&&n.updateParentNode(e[a],t),n.altAppCore.altItemFactory.updateAlternateNode(e[a]),e[a].select()}n.altAppCore.altItemFactory.updateGroupBy()}},updateParentNode:function(e,t){var n=this,a=e._parentNode,i=(a._getRowID(),a.options[M.CONSTANT_OTHER_CONTEXT_KEY]);i&&i.forEach((function(a){e.options.grid[M.CONSTANT_INSTANCE_CONTEXT_LOGICALID]===a.grid[M.CONSTANT_INSTANCE_CONTEXT_LOGICALID]&&n.updateStatusInGrid(a,t)})),a.options.grid[M.CONSTANT_DATAGRID_AVAILABLE_CONTEXT]=f.getContextColumnValue(a.options)},updateStatusInGrid:function(e,t){var n=e.grid[M.CONSTANT_STATUS];n==M.CONSTANT_PROPOSED&&t.includes(n)||n==M.CONSTANT_FROZEN&&t.includes(n)?e.grid[M.CONSTANT_STATUS]=M.CONSTANT_QUALIFIED:n==M.CONSTANT_QUALIFIED&&t.includes(n)&&(this.altAppCore.altSettingsManager.getAuthorizedChange().change&&this.altAppCore.altSettingsManager.getAuthorizedChange().change.id?e.grid[M.CONSTANT_STATUS]=M.CONSTANT_CHANGE_ATTACHED:e.grid[M.CONSTANT_STATUS]=M.CONSTANT_OBSOLETE)},removeDeletedRows:function(){var e=this,t=this._addAlternateUX.ALTERNATE.model.getSelectedNodes();e.removeDeletedRowFromView(t),e.altAppCore.altItemFactory.updateGroupBy();this._addAlternateUX.ALTERNATE.model.getRoots();e.altOptions.updateAlternateColumnValues(t[0].options[M.CONSTANT_REF_ID]),this.disableToolbarCmds()},removeDeletedRowFromView:function(e){for(var t=this,n=0;n<e.length;n++){var a=e[n]._parentNode,i=t.altAppCore.altItemFactory.checkIfHeaderNode(e[n]),r=t.altAppCore.altItemFactory.checkIfAlternateChildNode(e[n]);if(!i&&r){var o=a._getRowID();if(t.altAppCore.altItemFactory.removeChildFromParentNode(a,e[n]),1!=a.options[M.CONSTANT_OTHER_CONTEXT_KEY].length||a.getChildren()&&a.getChildren()[0].isSelected())a.options[M.CONSTANT_OTHER_CONTEXT_KEY].length>0&&!a.areAllChildrenSelected()?this._addAlternateUX.ALTERNATE.model.addChild(a,o):0===a.options[M.CONSTANT_OTHER_CONTEXT_KEY].length&&this._addAlternateUX.ALTERNATE.model.removeRoot(a);else{a.options[M.CONSTANT_OTHER_CONTEXT_KEY];var s=f.createAlternateItemNodes(a.options[M.CONSTANT_OTHER_CONTEXT_KEY]);a.removeChildren(),this._addAlternateUX.ALTERNATE.model.removeRoot(a),this._addAlternateUX.ALTERNATE.model.addChild(s[0],o)}}else i||this._addAlternateUX.ALTERNATE.model.removeRoot(e[n]);e[n].select(),this.instanciatedViews.AlternateDataGridView._groupingOptions&&this.instanciatedViews.AlternateDataGridView._groupingOptions.dataIndexesToGroup.length&&!i&&(!r||r&&0===a.options[M.CONSTANT_OTHER_CONTEXT_KEY].length)&&this._addAlternateUX.ALTERNATE.model.getRoots().forEach((function(t){t.removeChild(e[n]),r&&t.removeChild(a)}))}},updateChangeInGrid:function(e,t){e.grid[M.CONSTANT_WORK_UNDER_CHANGE_ID];null!=t&&null!=t&&""!=t&&(e.grid[M.CONSTANT_WORK_UNDER_CHANGE_ID]=t)},updateChangeColumn:function(e,t){for(var n=this,a=0;a<e.length;a++){if(!n.altAppCore.altItemFactory.checkIfHeaderNode(e[a])){e[a]._getRowID();n.updateChangeInGrid(e[a].options,t);e[a]._parentNode;n.altAppCore.altItemFactory.checkIfAlternateChildNode(e[a])&&n.updateParentNode(e[a],[t]),n.altAppCore.altItemFactory.updateAlternateNode(e[a]),e[a].select()}n.enableDisableToolbarCmdsOnUserSelections(e),n.altAppCore.altItemFactory.updateGroupBy()}},updateAlternateColumnValues:function(e){var t=this._addAlternateUX.ALTERNATE.model.getRoots().length>0?"Yes":"";s.publish("XEN/PUBLIC_EVENT/ENGINEERING_ITEM/ALTERNATE_UPDATED",[{physicalid:e,alternate:t}])},checkValidAlternates:function(e,t,n,a){var i=!0;for(var r in e){if(a==M.CONSTANT_REMOVE&&e[r].options.grid.WorkUnderChangeActionPhyId&&""!=e[r].options.grid.WorkUnderChangeActionPhyId&&!this.altAppCore.altSettingsManager.isChangeAuthorized()){i=!1;var o=U.get("eng.alternate.invalid.remove.error.msg").replace("$1",e[r].options.Title).replace("$2",e[r].options.revision);u.errorAlert(o);break}if(a==M.CONSTANT_APPROVE&&this.altAppCore.altSettingsManager.isChangeAuthorized()&&!e[r].options.grid.WorkUnderChangeActionPhyId){i=!1;o=U.get("eng.alternate.invalid.approveWithchange.error.msg").replace("$1",e[r].options.Title).replace("$2",e[r].options.revision);u.errorAlert(o);break}if(e[r].options[M.CONSTANT_OTHER_CONTEXT_APPLICABLE_DATA_EXISTS]&&!n.includes(e[r].options.grid[M.CONSTANT_STATUS])){var s=!1;if(e[r].options[M.CONSTANT_OTHER_CONTEXT_KEY].forEach((function(e){n.includes(e.grid[M.CONSTANT_STATUS])&&(s=!0)})),!s){i=!1;o=U.get("eng.alternate.invalid.status.error.msg").replace("$1",e[r].options.Title).replace("$2",e[r].options.revision).replace("$3",t);u.errorAlert(o);break}}else if(!n.includes(e[r].options.grid[M.CONSTANT_STATUS])){i=!1;o=U.get("eng.alternate.invalid.status.error.msg").replace("$1",e[r].options.Title).replace("$2",e[r].options.revision).replace("$3",t);u.errorAlert(o);break}}return i},performAction:function(e){e==M.CONSTANT_APPROVE?this.approveAlternate():e==M.CONSTANT_REMOVE&&this.removeAlternate()},getSuperModelDailog:function(e){return new r({className:M.CONSTANT_CONFIRM_MODEL_CLASS,closable:!0,okButtonText:e,animate:!0,renderTo:this.altOptions.getAltFacetMainContainer()})},getConfirmationDailog:function(t,n,a,i){var r=this;(new o).inject(r.altOptions.getAltFacetMainContainer());var s=new e.Element("div",{html:n}),l=this.getSuperModelDailog(i);return l.dialog({body:s,title:t,buttons:[{className:"primary",value:i,action:function(e){var t=r.displayToggle.isChecked();t&&localStorage.setItem(a+".displayConfirmMsg",t),r.performAction(a),e.hide()}},{value:U.get("eng.alternate.button.cancel"),action:function(e){e.hide()}}]}),l},confirmToProceedDialog:function(e,t,n,a){if("true"==localStorage.getItem(n+".displayConfirmMsg"))this.performAction(n);else{this.getConfirmationDailog(e,t,n,a);this.displayToggle=new i({type:"checkbox",label:U.get("eng.alternate.ui.DisplayToggle"),checked:!1});var r=document.querySelector("."+M.CONSTANT_CONFIRM_MODEL_CLASS+" .modal-footer");this.displayToggle.inject(r)}},_buildAlternateMessageDisplayContent:function(){this._informationContainerBox=e.createElement("div",{class:"alternate_substitute_container_information"}),this._informationBox=e.createElement("div",{class:"alternate_substitute_information"}).inject(this._informationContainerBox),e.createElement("span",{class:"alternate_substitute_information_icon wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-block"}).inject(this._informationBox),this._messageInformationBox=e.createElement("h2",{class:"alternate_substitute_information_msg"}).inject(this._informationBox),this._informationContainerBox.hide(),this._informationContainerBox.inject(this.elements.container)},notApplicable:function(e){this._emptyModels(),"multipleSelection"==e?(this._displayInformationBox("multipleSelection"),this._switchContainer("information")):"noObjectSelected"==e?(this._displayInformationBox("noObjectSelected"),this._switchContainer("information")):(this._displayInformationBox("notSupported"),this._switchContainer("information"))},_getAlternatePayload:function(e){return{[M.CONSTANT_REF_ID]:e}},_emptyModels:function(e){for(var t=e||Object.getOwnPropertyNames(this._addAlternateUX),n=0;n<t.length;n++)this._addAlternateUX[t[n]].model&&this._addAlternateUX[t[n]].model.empty()},_switchContainer:function(e){switch(e||this._activeContainer){case"information":this._informationContainerBox.show(),this._selectedUsageInfo.hide(),this._dataContainer.hide(),this.filterEmptyResultDOM.hide(),this._toolBarContainer.hide(),this._activeContainer="information";break;case"alternateItemsContent":this._informationContainerBox.hide(),this._selectedUsageInfo.show(),this._dataContainer.show(),this._toolBarContainer.show(),this._activeContainer="alternateItemsContent"}},_displayInformationBox:function(e){"notSupported"===e?this._messageInformationBox.setText(U.get("eng.alternate.notSupportedSelection")):"multipleSelection"===e?this._messageInformationBox.setText(U.get("eng.alternate.multipleSelection.msg")):"dragAlternateItem"===e?this._messageInformationBox.setText(U.get("eng.alternate.dnd.add.message")):"noObjectSelected"===e&&this._messageInformationBox.setText(U.get("eng.alternate.noObjectSelected"))},_applyAddProductIcon:function(){var e=this._informationBox.getElement(".alternate_substitute_information_icon");e&&e.hasClassName("wux-ui-3ds-block")&&(e.removeClassName("wux-ui-3ds-block"),e.addClassName("fonticon fonticon-part-add"))},loadSourceOptions:function(){var e=this;return e.altAppCore.altDataServices.getSettingsForAlternateSources(M.CONSTANT_SUGGESTION_SOURCE_SETTINGS).then((function(t){return e.newSourceSettings=t?JSON.parse(t):null,e.newSourceSettings})).catch((function(e){console.log(e)}))},resizeToolbar:function(){var e=this;this.resizor=new c(this._toolBarContainer,(function(){e._alternateToolbar._actionsIconBar.resize()}))}})}));