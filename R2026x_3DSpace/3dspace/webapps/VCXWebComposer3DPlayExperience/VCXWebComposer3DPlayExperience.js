define("DS/VCXWebComposer3DPlayExperience/VCXComposerPlayerApp",["DS/VCXWebComposer/VCXWebAppHelper","text!DS/VCXWebComposer3DPlayExperience/assets/base/VCXComposerManagersDescription.json","DS/VCXWebComposer/VCXWebDictionary","DS/VCXWebDressup/VCXWebDressupDictionary","DS/VCXWebSMGComponents/VCXSMGDictionary","DS/VCXWebDigger/VCXWebDiggerDictionary","DS/VCXWebSMGApp/VCXSMG3DPlayDictionary","DS/VCXWebGUI3DComposerPlayer/VCXGUIDictionary","DS/VCXWebGUI3DComposerPlayer/VCXGUIDescription"],(function(e,t,s,i,r,a,n,o,p){"use strict";return e.extend({init:function(e){this._parent(e),this.supportWebApplicationBase=!1,this.options=e,this.args=e},_prepareListManagers:function(){this._parent(),this._declareComposerManagers(t)},_setContextApp:function(){const e=this._parent();if(e){var t=this._experienceBase.getManager("VCXContextManager");if(t){t.setRootOptions({componentType:"VCXComponentOccurrenceSMG"}),t.setPlayerMode(),t.setExperienceIn3DPlay(),t.useTraverseGraph=!0;var s=void 0;return this.args&&this.args.input&&this.args.input.asset&&(this.args.input.asset.originalAsset?((s=this.args.input.asset.originalAsset.dtype)||(s=this.args.input.asset.originalAsset.type),"DriveFile"!==s&&"Document"!==s&&"XCADNonPSBaseRepReference"!==s||t.setExperienceInConnectedPlayer()):this.args.input.asset.tenant?(t.setExperienceInConnectedPlayer(),t.setSupported("_SMGFileOpenFromSwym",!0)):this.args.input.asset.requestsOptions&&t.setExperienceInConnectedPlayer()),this.args&&this.args.options&&!0===this.args.options.ODTModeRunAnimation&&t.setExperienceInConnectedPlayer(),t.setTrapSelectionRequirements({pick:!0,prePick:!0}),this.args&&this.args.options&&("false"===this.args.options.smgUI&&t.setSupported("DisplayUI",!1),"false"===this.args.options.smgUIAssemblyPanel&&t.setSupported("DisplayUIAssemblyPanel",!1),"false"===this.args.options.smgUIDressupsPanel&&t.setSupported("DisplayUIDressupsPanel",!1),"false"===this.args.options.smgUIScenariosPanel&&t.setSupported("DisplayUIScenariosPanel",!1),"false"===this.args.options.smgUIPropertiesPanel&&t.setSupported("DisplayUIPropertiesPanel",!1),"false"===this.args.options.smgPaper&&t.setSupported("Paper",!1),1!==this.args.options.smgScenarioPanelExpand&&0!==this.args.options.smgScenarioPanelExpand||(t.setSupported("PropAndScnPanelExpandOverride",!0),1===this.args.options.smgScenarioPanelExpand?t.setSupported("ScenarioPanelExpand",!0):t.setSupported("ScenarioPanelExpand",!1)),1!==this.args.options.smgPropertiesPanelExpand&&0!==this.args.options.smgPropertiesPanelExpand||(t.setSupported("PropAndScnPanelExpandOverride",!0),1===this.args.options.smgPropertiesPanelExpand?t.setSupported("PropertiesPanelExpand",!0):t.setSupported("PropertiesPanelExpand",!1))),t.getExperienceInConnectedPlayer()?t.setSupported("ImmersiveNavigation",!0):(t.setSupported("ImmersiveNavigation",!1),t.setSupported("DisplayPaperCtrlBtns",!1)),t.setSupported("PropertyPanelV2",!0),t.setSupported("Timeline",!0),t.setSupported("OpacityOverride",!1),t.setSupported("FrameUnboxing",!1),t.setSupported("RotateAroundPoint"),t.setSupported("GUIArchitectureV2"),t.setSupported("PropAndScnPanelExpandOverride",!0),!0}}return e},getOptions:function(){},getWorkBench:function(){},addDictionaries:async function(){await this._parent(),await this.AddDictionaryDescription(s),await this.AddDictionaryDescription(i),await this.AddDictionaryDescription(r),await this.AddDictionaryDescription(a),await this.AddDictionaryDescription(n),await this.AddDictionaryDescription(o)},addComposerManagers:function(){this._prepareListManagers();if(this._setContextApp()){this._parent(),this._experienceBase.getManager("VCXManipulatorManager").setManipulatorsRequirements({active:!0});this._experienceBase.getManager("VCXVisuManager").setDefaultAmbienceOptions({requestedMap:"defaultAmbienceEL",baseModule:"VCXWebSMGApp",baseFolder:"ambiences/",hasIBL:!0,hasRoughness:!0,hasBackGround:!1,hasGround:!1})}},SetHelperLifecycle:async function(){this._supportLifecycleExperienceBase},onPostCreate:async function(e){await this._parent(e),this._experienceBase=e,this.supportWebApplicationBase?this._experienceBase._parentBase?this.addComposerManagersExperienceBase():this.addComposerManagersWebApp():this.addComposerManagers(),this._supportLifecycleExperienceBase&&this.SetHelperLifecycle&&this.SetHelperLifecycle(e);const t=this._experienceBase.getManager("VCXGUIManager");return t&&await this._declareGUIComponents(t,p),this._experienceBase},onFinished:function(e){this._parent(e),WUX.setFullscreen(),this.options&&this.options.onAppInitialize&&(this.options.onAppInitialize(this,this._experienceBase),this.options.onAppInitialize=null),this._experienceBase&&this._experienceBase._ManagerSet&&this._experienceBase._ManagerSet.getVersions&&console.log(this._experienceBase._ManagerSet.getVersions())}})})),define("DS/VCXWebComposer3DPlayExperience/VCXWebPlayerIn3DPlayExperience",["DS/3DPlayExperienceModule/PlayExperience3D","UWA/Core","DS/VCXWebComposer/VCXWebAppHelper","DS/WAFData/WAFData","DS/VCXWebComposer3DPlayExperience/VCXComposerPlayerApp","DS/WebApplication/WebApplication"],(function(e,t,s,i,r,a){"use strict";return e.extend({init:function(e){this._parent(e),this.does3DPlayDoTheRequestNewExperienceBase=!1;var i=s.getOptions();e.commandApplication=!1;var r={composerExp:{workbenchs:[{name:"VCXWebPlayer3DPlayExperience",module:"VCXWebComposer3DPlayExperience"}],visu:i.viewerOptions,ui:{displayTree:!1,displayActionBar:!1}}}.composerExp;e.options.propertiesFacet={},this.args=t.extend(e,r,!0)},dispose:function(e){this._parent(e),this.webApplication&&this.webApplication.dispose()},requestNewExperienceBaseAsync:async function(){console.log("Dummy Function invoked: requestNewExperienceBaseAsync")},loadAsset:async function(e){if(e){var s=e.asset?e.asset:this.args.input.asset;if(s){this.promiseWebApplication=new Promise((e=>{this.webApplication?(this.first_instance=!1,e()):(this.first_instance=!0,this.webApplication=new a({...this.args,Async:!0,container:this.frmWindow.elements.container,frmWindow:this.frmWindow,application:"DS/VCXWebComposer3DPlayExperience/VCXComposerPlayerApp",onAppInitialize:t=>{console.log("ON APP INIT"),this._app=t,e(t)}}))})),await this.promiseWebApplication;var r=!1,n=e=>{},o=()=>{console.error("Error in WAFData request")},p=()=>{console.error("timeout error in WAFData request")},c=e=>{function s(s){s.getManager("VCXPlayManager").setPlayMode(!0),this.args&&this.args.options&&"true"===this.args.options.smgPaperSpaceVisible&&s.getManager("VCXPaperManager").setPaperVisibility(!0);const i=s.getManager("VCXGUIManager").getGettingStartedUI();i&&i.startLoadingExperience();const a=s.getManager("VCXContextManager").getMainViewer();return require([r?"DS/VCXWebInteropSMG/VCXSmgXMLExperienceLoader":"DS/VCXWebInteropSMG/VCXSmgLoader"],(t=>{const n=new t;n._experienceProgressCB=this.onModelLoadingProgression,this.onModelLoadingStarted(),this.autoReframe=!1;const o=()=>{this.onModelLoadingCompleted(),i&&i.endLoadingExperience(),n._experienceProgressCB=null};r?n.StartLoadingExperience(s,a,l,o):n.LoadFromArrayBuffer(s,a,e,o)}),(e=>t.Promise.reject(e)))}if(this.first_instance)return this._experienceBase=this._app._experienceBase,s.call(this,this._experienceBase);this.webApplication.requestNewExperienceBaseAsync().then((e=>(this._experienceBase=e,s.call(this,this._experienceBase))))},l="";if("FILE"===s.provider)if(s.format&&"smg"===s.format.toLowerCase()||s.mimetype&&"smg"===s.mimetype.toLowerCase()||s.format&&"smgs"===s.format.toLowerCase()||s.mimetype&&"smgs"===s.mimetype.toLowerCase()||s.format&&"smgxml"===s.format.toLowerCase()||s.mimetype&&"smgxml"===s.mimetype.toLowerCase()){l=s.filename||s.url,(s.format&&"smgxml"===s.format.toLowerCase()||s.mimetype&&"smgxml"===s.mimetype.toLowerCase())&&(r=!0);var d="";s.requestsOptions&&s.requestsOptions.authentication&&(d=s.requestsOptions.authentication),i.handleRequest(l,{method:"GET",authentication:d,responseType:"arraybuffer",type:"arraybuffer",onComplete:c,onProgress:n,onFailure:()=>{i.handleRequest(l,{method:"GET",authentication:"passport",responseType:"arraybuffer",type:"arraybuffer",onComplete:c,onProgress:n,onFailure:o})},onTimeout:()=>{i.handleRequest(l,{method:"GET",authentication:d,responseType:"arraybuffer",timeout:5e4,type:"arraybuffer",onComplete:c,onProgress:n,onFailure:o,onTimeout:p})}})}else alert("Format not supported:"+s.format);else if("BUFFER"===s.provider)c(s.data);else if("STREAM"===s.provider){var h=s.data[0];c(h.data)}else alert("Hoops it seems that the data is not an smg file")}}},addDictionaries:async function(){this.appHelper||(this.appHelper=new r(this.args)),this.appHelper._experienceBase=this._experienceBase,await this.appHelper.addDictionaries()},onPreCreate:function(e){},onPostCreate:function(e){},initExperienceBase:function(e,t){this._experienceBase=e,this.appHelper.onPostCreate(e),t(0)},onFinished:function(e){this.appHelper.onFinished(e)}})}));