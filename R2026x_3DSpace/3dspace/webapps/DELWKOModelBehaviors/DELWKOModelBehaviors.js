define("DS/DELWKOModelBehaviors/DELWKOModelBehaviorCloud",["UWA/Core","UWA/Promise","DS/DELPPWModelBehaviors_FD02/ModelBehavior","DS/DELPPWModelServices_FD02/BehaviorUtil"],(function(e,t,n,r){"use strict";return{plugins:["DatabasePlugin","ResourcePlugin","AttributePlugin","WebServicePlugin","DicoPlugin","BIPlugin"],creator:function(n,r,i,a,o,s,c,u){var l,g,f,d,p,m,y;return p=function(t,n,i,a,o){var s=i||{};!0===(!e.is(s.popupMessage)||s.popupMessage)?r.info(n,a):r.log(n,a),r.notify("stopProgress",t),e.is(s.onComplete,"function")&&s.onComplete.call(null,n,i,o)},m=function(t,n,i,a,o,s){var c=a||{},u=!e.is(c.popupMessage)||c.popupMessage;e.is(i)&&e.is(i.message,"string")&&(n+="\n"+i.message),!0===u?r.warn(n,o):r.log(n,o),r.notify("stopProgress",t),e.is(c.onFailure,"function")&&c.onFailure.call(null,n,s)},l=function(n,o,s,c,u,l){var g,f,d,y,L,h,I=a.getNLSValue("DeleteObject.Success"),b=a.getNLSValue("DeleteObject.Failure"),S=a.getNLSValue("DeleteObject.PatialFailure"),C=[],v=n?"Instance":"Reference",P={};if(l=!!e.is(l)&&l,s.popupMessage=!e.is(s)||!e.is(s.showConfirmation)||s.showConfirmation,g=function(e,t){L=a.getNLSValue(v,{objectLabel:e.get(c)},"Delete","Success"),r.log(L,y),e.isInstance()&&(d=i.getReferenceModelFromInstance(e)),t(d)},f=function(t,n,i){L=a.getNLSValue(v,{objectLabel:t.get(c)},"Delete","Failure"),e.is(i)&&e.is(i.message,"string")&&(L+="\n"+i.message),r.log(L,y),n()},e.is(o,"array")&&o.length>0){if(r.notify("startProgress",P),y=r.log(a.getNLSValue("DeleteObject.LogMessage")),h=i[n?"deleteInstance":"deleteReference"],!e.is(h,"function"))return void r.debug("delete function not found on database plugin.");o.forEach((function(i){C.push(new t((function(t,a){h(i.id,{deep:!!e.is(u)&&u,onComplete:function(){g(i,t),n&&r.notify("deleteInstance",i.toJSON())},onFailure:function(e,t){f(i,a,t)}})})))})),e.Promise.allSettled(C).then((function(t){var i=!1,a=0,o=0,c=[];for(a=0;a<t.length;a++)"rejected"!==t[a].state?e.is(t[a].value)&&c.push(t[a].value):o++;0===o?(p(P,I,s,y),i=!0):o===t.length?m(P,b,null,s,y):(m(P,S,null,s,y),i=!0),i&&n&&l&&r.notify("addToAuxiliaryView",[c,{askAddToAuxConfirmation:!l}])}))}},y=function(e,t){return i.isInstancePossible(e,t)},f=function(t,n){var o,s,c,u={},l={},g=!1;return n=n||{},e.is(n.securityContextOverride,"string")&&(c=n.securityContextOverride,delete n.securityContextOverride),e.is(n.silent,"boolean")&&(g=n.silent,delete n.silent),e.is(t)?e.is(t.V_Type)&&e.is(t.type)?(o=r.log(a.getNLSValue("ModelBehavior.createWorkOrderFromProcess.LogMessage",{title:t.V_Name,type:t.type})),r.notify("startProgress",u),s=i.createWorkOrderFromProcess(t,{onComplete:function(t){for(var i=t.instancesAndReferences,s=null,c=null,g=i.length,f=[],d=[],m=0;m<g;m++)null!=i[m]&&("WORKORDER"===i[m]._attributes.PPRTYPE&&(s=i[m]),"SYSTEM"===i[m]._attributes.PPRTYPE&&(c=i[m]),void 0===i[m]._attributes.isAggregatedBy?f.push(i[m]):d.push(i[m]));var y={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:f,instanceAttrs:d};n.newRef=s,e.is(s)&&p(u,a.getNLSValue("ModelBehavior.createWorkOrderFromProcess.Success",{name:s._attributes.V_Name,processname:c._attributes.V_Name}),n,o,y),r.notify("createReference",l)},onFailure:function(t,r){var i={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:null,instanceAttrs:null};m(u,a.getNLSValue("ModelBehavior.createWorkOrderFromProcess.Failure"),r,n,o,i)},securityContextOverride:c,silent:g})):r.debug("Type is required to create createWorkOrderFromProcess",s):r.debug("data is empty to addReference"),s},g=function(t,n){var o,s,c,u={},l={},g=!1;return n=n||{},e.is(n.securityContextOverride,"string")&&(c=n.securityContextOverride,delete n.securityContextOverride),e.is(n.silent,"boolean")&&(g=n.silent,delete n.silent),e.is(t)?e.is(t.V_Type)&&e.is(t.type)?(o=r.log(a.getNLSValue("ModelBehavior.CreateReference.LogMessage",{title:t.V_Name,type:t.type})),r.notify("startProgress",u),s=i.createReference(t,{onComplete:function(t){var i={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:t.toJSON(),instanceAttrs:null};n.newRef=t,p(u,a.getNLSValue("ModelBehavior.createWorkOrderFromProcess.Success",{name:t.get("PLM_ExternalID")}),n,o,i),r.notify("createReference",l)},onFailure:function(t,r){var i={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:null,instanceAttrs:null};m(u,a.getNLSValue("ModelBehavior.createWorkOrderFromProcess.Failure"),r,n,o,i)},securityContextOverride:c,silent:g})):r.debug("Type is required to create createReference",s):r.debug("data is empty to addReference"),s},d=function(t,n){var o,s,c={},u=!0;n=n||{},e.is(n.securityContextOverride,"string")&&(s=n.securityContextOverride,delete n.securityContextOverride),e.is(t)?e.is(t.isAggregatedBy)?(e.is(t.isInstanceOf)&&(u=y(i.getReference(t.isAggregatedBy),i.getReference(t.isInstanceOf))),u?(r.notify("startProgress",c),o=r.log(a.getNLSValue("ModelBehavior.CreateInstance.LogMessage")),i.createInstance(t,{onComplete:function(t){var s=i.getReferenceModelFromInstance(t),u={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:e.is(s)?s.toJSON():null,instanceAttrs:e.is(t)?t.toJSON():null};n.newInst=t,p(c,a.getNLSValue("ModelBehavior.CreateInstance.Success",{name:t.get("PLM_ExternalID")}),n,o,u),r.notify("createInstance",t.toJSON())},onFailure:function(t,r){var i={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:null,instanceAttrs:null};m(c,a.getNLSValue("ModelBehavior.CreateInstance.Failure"),r,n,o,i)},securityContextOverride:s})):r.debug("Instance object cannot be created between two selected Types")):r.debug("isAggregatedBy required to create instance"):r.debug("data is empty to createInstance")},{onStart:function(){},onStop:function(){},createWorkOrderFromProcess:function(t,n,i){var a,o={};if(e.is(t)){for(a in t)Object.prototype.hasOwnProperty.call(t,a)&&(o[a]=t[a]);f(o,i)}else r.debug("createWorkOrderFromProcess: No data to insert")},getMfgItemFromWorkOrderOnCloud:function(e){return i.getMfgItemFromWorkOrderOnCloud(e)},getProductionPlanFromWorkOrder:function(e){return i.getProductionPlanFromWorkOrder(e)},createRefOrInst:function(t,n,i){var a,o={};if(e.is(t)){for(a in t)Object.prototype.hasOwnProperty.call(t,a)&&(o[a]=t[a]);e.is(n,"string")?(o.isAggregatedBy=n,d(o,i)):g(o,i)}else r.debug("createRefOrInst: No data to insert")},deleteReference:function(t,n){var i,o,s="V_Name",c=r.getBehavior("UXFactoryBehavior"),u=a.getNLSValue("Delete.Confirmation.Title"),g=!(!e.is(n)||e.is(n.showConfirmation))||n.showConfirmation;e.is(c)?(n=n||{},e.is(t,"array")&&t.length>0&&(i=a.getNLSValue("DeleteReference.Confirmation.Message"),o=void 0,e.is(o)?g?c.showConfirmation(u,i,{attributes:[s],models:t},(function(r,i,a){e.is(r)&&r&&l(!1,t,n,s,a)}),{check:o,messageType:"Warning"}):l(!1,t,n,s,!0):g?c.showConfirmation(u,i,{attributes:[s],models:t},(function(r){e.is(r)&&r&&l(!1,t,n,s,!1)}),{messageType:"Warning"}):l(!1,t,n,s,!1))):r.debug("uxFactoryBehavior is not available.")},deleteInstance:function(t,n){var i,o,s,c="PLM_ExternalID",u=r.getBehavior("UXFactoryBehavior"),g=a.getNLSValue("Confirmation.addRefToAuxViewPostDelete");e.is(u)?(n=n||{},i=!e.is(n.askDeleteConfirmation)||n.askDeleteConfirmation,e.is(t,"array")&&t.length>0&&(i?(!!e.is(n.isDetachInstance)&&n.isDetachInstance?(s=a.getNLSValue("Detach.Confirmation.Title"),o=a.getNLSValue("DetachInstance.Confirmation.Message")):(s=a.getNLSValue("Delete.Confirmation.Title"),o=a.getNLSValue("DeleteInstance.Confirmation.Message")),u.showConfirmation(s,o,{attributes:[c],models:t},(function(r,i,a){e.is(r)&&r&&l(!0,t,n,c,!1,a)}),{check:g})):l(!0,t,n,c))):r.debug("uxFactoryBehavior is not available.")},fetchRoot:function(e,t){return i.fetchRoot(e,t)},fetchInstancesAndTheirReferences:function(e,t){return i.fetchInstancesAndTheirReferences(e,t)},isNavigateOnDemand:function(){return i.isNavigateOnDemand()},fetchInstance:function(e,t){return i.fetchInstance(e,t)},getReference:function(e){return i.getReference(e)},removeReference:function(e,t){i.removeReference(e,t)},getInstance:function(e){return i.getInstance(e)},getReferenceModelFromInstance:function(e){return i.getReferenceModelFromInstance(e)},getAggregatingReferenceModelFromInstance:function(e){return i.getAggregatingReferenceModelFromInstance(e)},getReferenceIdFromInstance:function(e){return i.getReferenceIdFromInstance(e)},getReferenceId:function(e){var t=e;return this.isInstance(e)&&(t=i.getReferenceIdFromInstance(e)),t},getInstancesFromCollection:function(e){return i.getInstancesFromCollection(e)},getParentInstancesFromCollection:function(e){return i.getParentInstancesFromCollection(e)},needToQueryForConnections:function(e){return i.needToQueryForConnections(e)},needToQueryForChildren:function(e){return i.needToQueryForChildren(e)},getDescendantsFromServer:function(e,t,n){i.getDescendantsFromServer(e,t,n)},getConnectionsFromServer:function(e,t,n){i.getConnectionsFromServer(e,t,n)},getAllChildrenFromCollection:function(e){return i.getAllChildrenFromCollection(e)},getImpactedConnections:function(t,n,r){var a,o=[];return e.is(t,"array")&&t.forEach((function(t){a=i.getImpacted(t,n,r),e.is(a)&&e.is(a,"array")&&a.length>0&&(o=o.concat(a))})),o},getReferenceModel:function(e){return i.getReferenceModel(e)},isReference:function(t){return e.is(this.getReference(t))},isInstance:function(t){return e.is(this.getInstance(t))},updateModelAttribute:function(t,n,s,c){var u,l,g,f,d,y,L,h,I,b,S,C,v,P,R,D,k,T,V=this,A=[],N=function(t){var n=t,r=function(t){return e.is(t,"string")?o.getFormattedDate(t):o.getFormattedDate(1e3*t)};return o.isDate(v)?n=Array.isArray(t)?t.map((function(e){return r(e)})):r(t):b&&!L&&(n=o.getValueAsString(t,o.getType(v))),n};e.is(n,"array")&&(n=n[0]),n=n||{},c=c||{},e.is(n.instOrRef)&&e.is(n.dataIndex)&&e.is(n.attributeInfo)&&e.is(n.objectToBeModified)&&e.is(n.attributeName)?(R=n.attributeName,v=n.attributeInfo,P=e.is(n.attributeDef)?n.attributeDef:{},d=o.getNLS(v),D=n.objectToBeModified,C=n.dataIndex,y="instance"===n.instOrRef,L=o.hasRangeDefined(v,P),h=o.isString(v),I=o.isInteger(v),b=o.isDouble(v),S=o.isMultiValuated(v),f=D.get(C),e.is(f)&&"NULL"!==f||(f=""),L&&!S&&(h||I||b)&&(f=o.getAuthorizedValue(v,P,f)),function(e,t,n,i){var o,s=N(n),c=r.getBehavior("UXFactoryBehavior"),u=c.getComponent("Button"),l=c.createElement("div",{class:"confirmation-dialog-content-container",html:"<p>"+a.getNLSValue("UpdateAttributeUI.Text",{prevValue:s})+"</p>"});(o=c.create("Dialog",{title:a.getNLSValue("UpdateAttributeUI.Header",{attributeName:d}),domId:"EditAttributeUI-Dialog",content:l,resizableFlag:!0,modalFlag:!0,buttons:{No:new u({onClick:function(){n===t&&k(e,i,n),o.close()}}),Yes:new u({disabled:!1,onClick:function(){k(e,t,n),o.close()}})}})).close=function(){this.destroy(),o=null}},T=function(t){var n=!1,i=s;return e.is(t)&&(g=t.get(C),L&&!S&&(h||I)&&(g=o.getAuthorizedValue(v,P,g)),o.isDate(v)&&!o.isMultiValuated(v)?(g=(g=new Date(g).getTime()/1e3).toString(),i=s=i.toString()):b&&o.hasMagnitude(v)&&!S&&(g=parseFloat(g),i=parseFloat(i),s=i.toString()),g!==i&&(o.doesAttributeExist(t,C)?n=!0:r.warn(a.getNLSValue("TableView.AvailabilityFailure",{key:d})))),n},e.is(t,"array")?t.forEach((function(e){u=y?V.getInstance(e):V.getReference(e),T(u)&&A.push(u.id)})):T(D)&&A.push(D.id),0!==A.length&&(1===A.length?(k=function(t,n,o){var s={previous:{}},u={},g={};delete s.previous;var f=i.getReference(t);if(e.is(f)){var L=f.getODMAttr(C,n);e.is(L)||(L=f.getODMAttr(R,n)),function t(n,r){Object.keys(r).forEach((i=>{e.is(n[i])||(n[i]={}),e.is(r[i])&&"object"!=typeof r[i]||null===r[i]?n[i]=r[i]:t(n[i],r[i])}))}(s,L)}l={data:s,forceUpdate:!0,onRevisionFailure:function(e,t){m(g,e.message,t,c)},onFailure:function(n,r){if(e.is(s)&&1===Object.keys(s).length&&e.is(n)){var o=i.getReference(t).get("V_Name");n=n.replace("item",o),m(g,a.getNLSValue("TableView.SingleUpdateODMFailure",{error:n}),r,c)}},onComplete:function(e,t){e.get(C);p(g,a.getNLSValue("TableView.SingleUpdateSuccess",{key:d,value:N(n)}),c),r.notify("editAttribute",u)},logMessage:a.getNLSValue("TableView.SingleUpdateLogMessage")},r.notify("startProgress",g),!0===y?i.updateInstance(t,l):i.updateReference(t,l)})(A[0],s,f):A.length>1&&function(e,t){var n={keyValues:{},pids:e},o={},s={};n.keyValues[R]=t,l={data:n,onFailure:function(e){m(s,a.getNLSValue("TableView.MassUpdateFailure",{key:d,value:N(t)}),e,c)},onComplete:function(n){n.length!==e.length?m(s,a.getNLSValue("TableView.UpdateWarning",{key:d})):(p(s,a.getNLSValue("TableView.MassUpdateSuccess",{key:d,value:N(t)}),c),r.notify("editAttribute",o))},logMessage:a.getNLSValue("TableView.MassUpdateLogMessage")},r.notify("startProgress",s),!0===y?i.updateInstances(C,l):i.updateReferences(C,l)}(A,s))):r.debug("Required attribute information is missing to update the model attribute")},updateModelAttribute_v2:function(t,n,s){var c,u,l,g,f,d,y,L,h,I=[],b=function(t){var n=t,r=function(t){return e.is(t,"string")?o.getFormattedDate(t):o.getFormattedDate(1e3*t)};return o.isDate(f)&&(n=Array.isArray(t)?t.map((function(e){return r(e)})):r(t)),n};if(e.is(n,"array")||(n=[n]),n=n||{},s=s||{},L=function(e,t,n,i){var o,s=b(n),c=r.getBehavior("UXFactoryBehavior"),u=c.getComponent("Button"),g=c.createElement("div",{class:"confirmation-dialog-content-container",html:"<p>"+a.getNLSValue("UpdateAttributeUI.Text",{prevValue:s})+"</p>"});(o=c.create("Dialog",{title:a.getNLSValue("UpdateAttributeUI.Header",{attributeName:l}),domId:"EditAttributeUI-Dialog",content:g,resizableFlag:!0,modalFlag:!0,buttons:{No:new u({onClick:function(){n===t&&d(e,i,n),o.close()}}),Yes:new u({disabled:!1,onClick:function(){d(e,t,n),o.close()}})}})).close=function(){this.destroy(),o=null}},h=function(t){var n=!1,i=t.newValue,s=t.dataIndex,c=(t.attributeName,t.attributeInfo),l=(e.is(t.attributeDef)&&t.attributeDef,o.getNLS(c)),g=(t.objectToBeModified,t.objectToBeModified);return e.is(g)&&(u=g.get(s),o.isDate(c)&&!o.isMultiValuated(c)&&(u=(u=new Date(u).getTime()/1e3).toString(),e.is(i)&&(i=i.toString())),u!==i&&(o.doesAttributeExist(g,s)?n=!0:r.warn(a.getNLSValue("TableView.AvailabilityFailure",{key:l})))),n},e.is(t,"array"),n.forEach((e=>{h(e)&&(I.includes(e.objectToBeModified.id)||I.push(e.objectToBeModified.id))})),0!==I.length)if(1===I.length)d=function(t,u,f){var d={previous:{}},y={},h={},I=function t(n,r){Object.keys(r).forEach((i=>{e.is(n[i])||(n[i]={}),e.is(r[i])&&"object"!=typeof r[i]||null===r[i]?n[i]=r[i]:t(n[i],r[i])}))};n.forEach((n=>{if(e.is(n.instOrRef)&&e.is(n.dataIndex)&&e.is(n.attributeInfo)&&e.is(n.objectToBeModified)&&e.is(n.attributeName)){var a=n.attributeName,s=n.attributeInfo,c=e.is(n.attributeDef)?n.attributeDef:{},u=(o.getNLS(s),n.objectToBeModified),l=n.dataIndex,g=(n.instOrRef,o.hasRangeDefined(s,c)),f=o.isString(s),p=o.isInteger(s),m=o.isDouble(s),y=o.isMultiValuated(s),L=u.get(l),h=n.newValue;e.is(L)&&"NULL"!==L||(L=""),g&&!y&&(f||p||m)&&(L=o.getAuthorizedValue(s,c,L)),delete d.previous;var b=i.getReference(t);if(e.is(b)){var S=b.getODMAttr(l,h);e.is(S)||(S=b.getODMAttr(a,h)),I(d,S)}}else r.debug("Required attribute information is missing to update the model attribute")})),c={data:d,forceUpdate:!0,onRevisionFailure:function(e,t){m(h,e.message,t,s)},onFailure:function(n,r){if(e.is(d)&&1===Object.keys(d).length)if(e.is(n)){var o=i.getReference(t).get("V_Name");n=n.replace("item",o),m(h,a.getNLSValue("TableView.SingleUpdateODMFailure",{error:n}),r,s)}else m(h,a.getNLSValue("TableView.SingleUpdateFailure",{key:l,value:b(u)}),r,s);else m(h,a.getNLSValue("TableView.MultipleAttributesUpdateFailure"),r,s)},onComplete:function(i,c){var I=i.get(g);if(e.is(d)){if(1===Object.keys(d).length&&"object"!=typeof d){var S=void 0,C=void 0;n.forEach((e=>{var t=e.attributeInfo,n=o.getNLS(t);S=n,C=e.newValue})),1===n.length?p(h,a.getNLSValue("TableView.SingleUpdateSuccess",{key:S,value:b(C)}),s):p(h,a.getNLSValue("TableView.MultipleAttributesUpdateSuccessCloud"),s)}else p(h,a.getNLSValue("TableView.MultipleAttributesUpdateSuccessCloud"),s);r.notify("editAttribute",y)}else e.is(c)&&e.is(c.isInSync)&&!c.isInSync?(m(h,a.getNLSValue("TableView.UpdateWarning",{key:l})),L(t,u,I,f)):e.is(i._changed.modified)?(p(h,a.getNLSValue("TableView.SingleUpdateSuccess",{key:l,value:b(I)}),s),r.notify("editAttribute",y)):m(h,a.getNLSValue("TableView.SingleUpdateFailure",{key:l,value:b(u)}),c,s);e.is(s)&&e.is(s.onComplete)&&s.onComplete()},logMessage:a.getNLSValue("TableView.SingleUpdateLogMessage")},r.notify("startProgress",h),i.updateReference(t,c)},d(I[0]);else if(I.length>1){var S=function t(n,r){Object.keys(r).forEach((i=>{e.is(n[i])||(n[i]={}),e.is(r[i])&&"object"!=typeof r[i]||null===r[i]?n[i]=r[i]:t(n[i],r[i])}))};y=function(t){var u=new Map;n.forEach((t=>{var n={previous:{}};if(e.is(t.instOrRef)&&e.is(t.dataIndex)&&e.is(t.attributeInfo)&&e.is(t.objectToBeModified)&&e.is(t.attributeName)){var i=t.attributeName,a=t.attributeInfo,s=e.is(t.attributeDef)?t.attributeDef:{},c=(o.getNLS(a),t.objectToBeModified),l=t.dataIndex,g=(t.instOrRef,o.hasRangeDefined(a,s)),f=o.isString(a),d=o.isInteger(a),p=o.isDouble(a),m=o.isMultiValuated(a),y=c.get(l),L=t.newValue;e.is(y)&&"NULL"!==y||(y=""),g&&!m&&(f||d||p)&&(y=o.getAuthorizedValue(a,s,y)),delete n.previous;var h=c;if(e.is(h)){var I=h.getODMAttr(l,L);if(e.is(I)||(I=h.getODMAttr(i,L)),S(n,I),n.id=h.get("id"),e.is(u.get(h.get("PPRTYPE")))){var b=u.get(h.get("PPRTYPE")),C=-1,v=0;e.is(b)&&b.length>0&&b.forEach((e=>{e.id===h.get("id")&&(C=v),v++})),C>-1?b[C]=e.merge(b[C],n):b.push(n)}else u.set(h.get("PPRTYPE"),[n])}}else r.debug("Required attribute information is missing to update the model attribute")}));var f={},d={};c={data:u,onFailure:function(e){m(d,a.getNLSValue("TableView.MassUpdateFailure",{key:l}),e,s)},onComplete:function(e){e.length!==t.length?m(d,a.getNLSValue("TableView.UpdateWarning",{key:l})):(p(d,a.getNLSValue("TableView.MassUpdateSuccessCloud"),s),r.notify("editAttribute",f))},logMessage:a.getNLSValue("TableView.MassUpdateLogMessage")},r.notify("startProgress",d),i.updateReferences(g,c)},y(I)}},getValidChildTypes:function(e){return i.getValidChildTypes(e)},isInstancePossible:function(e,t){return y(e,t)},isAKindOf:function(e,t){return c.isAKindOf(e,t)},getTypeHierarchy:function(e){return c.getTypeHierarchy(e)},getPPRType:function(e){return i.getPPRType(e)},getPPRTypeFromType:function(e){return c.getPPRType(e)},getParentTypes:function(e){return c.getParentTypes(e)},getReadOnlyTypes:function(){return c.getReadOnlyTypes()},isReferencesHasReadOnlyType:function(e){return c.isReferencesHasReadOnlyType(e)},isReadOnly:function(t,n,i,o){var c,u,l;u=function(e,t,n){r.debug("jsonData: "+e+" error:"+t+" options: "+n),o()},l=function(t){e.is(t.isReadOnly)&&t.isReadOnly&&(c=a.getNLSValue("Error.ObjNotInReadWrite.Title",{objectName:n})),i(c)},s.webServiceRequest({url:"dsmfg/private/V0/invoke/isReadOnly",method:"GET",data:{pid:t},onFailure:u,onTimeout:u,onCancel:u,onComplete:l})},getWhereUsedReferences:function(e,t,n){i.getWhereUsedReferences(e,t,n)},getRootReferenceFromInstance:function(e){return i.getRootReferenceFromInstance(e)},getTenant:function(){return s.getTenant()},getSecurityContext:function(){return s.getSecurityContext()},get3DSpaceUrl:function(){return s.get3DSpaceUrl()},isEntityInstance:function(e){return c.isEntityInstance(e)},getAcceptedBaseTypesForCreation:function(){var t=[],n=c.getAcceptedBaseTypesForActions();return e.is(n)&&e.is(n.CREATION,"array")&&(t=n.CREATION),t},getFilteredInstancesFromCollection:function(e,t){return i.getFilteredInstancesFromCollection(e,t)}}}}})),define("DS/DELWKOModelBehaviors/DELWKOLinkBehavior",["UWA/Core","UWA/Promise"],(function(e,t){"use strict";return{plugins:["DatabasePlugin","DicoPlugin","WebServicePlugin","AttributePlugin","ResourcePlugin","ImplementPlugin","SelectionPlugin","PlatformPlugin"],creator:function(n,r,i,a,o,s,c,u,l,g){var f=u.getScopeLinkType(),d=u.getImplementLinkType(),p="MfgProcessAlternate",m="HistorizationLinkRefRef";u.getScopeLinkType(),u.getImplementLinkType();var y,L,h,I,b,S,C,v,P;return y=function(t,n,i,a){i=i||{},e.is(n,"string")&&r.info(n,a),r.notify("stopProgress",t),e.is(i.onComplete,"function")&&i.onComplete.call(null,n)},L=function(t,n,i,a,o){a=a||{},e.is(i,"string")&&(n+="\n"+i),e.is(n,"string")&&(r.warn(n,o),r.debug(n)),r.notify("stopProgress",t),e.is(a.onFailure,"function")&&a.onFailure.call(null,n)},h=function(t){return new e.Promise((function(n){var a=[],o=function(t){var n,r;-1===a.indexOf(t)&&(n=i.getInstance(t),r=t,e.is(n)&&(r=n.get("isInstanceOf"),i.needToQueryForConnections(t)&&a.push(t)),-1===a.indexOf(r)&&i.needToQueryForConnections(r)&&a.push(r))};i.isNavigateOnDemand()||n({impactedList:[],relationsLoaded:!0}),(e.is(t)?t:l.getModuleSelections(r.getId())).forEach((function(e){o(e.id),Array.isArray(e.path)&&e.path.forEach((function(e){o(e)}))})),a.length>0?i.getConnectionsFromServer(a,(function(t){e.is(t)&&Array.isArray(t.connections)&&t.connections.length>0&&r.notify("addConnection",[t.connections]),n({impactedList:a,result:t,relationsLoaded:!0})})):n({impactedList:a,relationsLoaded:!0})}))},I=function(e){return h(e).then((function(e){var t=e.impactedList;t.length>0&&(r.notify("refreshImpacted",{impactedChildren:[],impactedObjects:t}),r.getBehavior("RefreshBehavior").onRefreshSelected({impactedChildren:[],impactedObjects:t}))}))},b=function(t,n){var r,o,s,u,l,g=!0,f={};return e.is(t.fromSideRefPID)&&e.is(t.toSideRefPID)?(n.contains("inverse")?(r=t.toSideRefPID,o=t.fromSideRefPID):(r=t.fromSideRefPID,o=t.toSideRefPID),s=i.getReference(r),u=i.getReference(o)):(g=!1,l=c.getNLSValue("LinkBehavior.canCreateOutputLinkError.InsufficentInfo")),g&&(a.isAKindOf(u,"Provide")||a.isAKindOf(s,"DELLmiHeaderWorkPlanReference")||a.isAKindOf(s,"DELLmiQtyControlProcessReference")?(g=!1,l=c.getNLSValue("LinkBehavior.canCreateOutputLinkError.ObjectTypeDoesntSupport")):i.hasConnection({from:r,to:o,type:"DELLmiProductionSystemOutputCnxToMBOM"})&&(g=!1,l=c.getNLSValue("LinkBehavior.canCreateOutputLinkError.LinkAlreadyExists"))),f={canCreateLink:g},g?f.data=e.merge({type:n,IDFrom:t.fromSideRefPID,IDTo:t.toSideRefPID,displayText:c.getNLSValue(n,null,"CreateLink"),buttonIdentifier:c.getNLSValue(n,null,"CreateLink")},e.clone(t)):f.errorMessage=l,f},S=function(t,n){var r,o,s,u,l,g=!0,f={};return e.is(t.fromSideRefPID)&&e.is(t.toSideRefPID)?(o=t.fromSideRefPID,s=t.toSideRefPID,u=i.getReference(o),l=i.getReference(s)):(g=!1,r=c.getNLSValue("LinkBehavior.canCreateOriginateLinkError.InsufficentInfo")),g&&(i.hasConnection({from:o,to:s,type:m})||i.hasConnection({from:s,to:o,type:m})?(g=!1,r=c.getNLSValue("LinkBehavior.canCreateOriginateLinkError.LinkAlreadyExists")):(a.isAKindOf(u,"DELLmiHeaderWorkPlanReference")||a.isAKindOf(l,"DELLmiHeaderWorkPlanReference"))&&(g=!1,r=c.getNLSValue("LinkBehavior.canCreateOriginateLinkError.ObjectTypeDoesntSupport"))),f={canCreateLink:g},g?f.data=e.merge({type:n,IDFrom:o,IDTo:s,displayText:c.getNLSValue(n,null,"CreateLink"),buttonIdentifier:c.getNLSValue(n,null,"CreateLink")},e.clone(t)):f.errorMessage=r,f},C=function(t,n){var r,a,o,s=!0,u={};return e.is(t.fromSideRefPID)&&e.is(t.toSideRefPID)?(r=t.fromSideRefPID,a=t.toSideRefPID,(i.hasConnection({from:r,to:a,type:p})||i.hasConnection({from:a,to:r,type:p}))&&(s=!1,o=c.getNLSValue("LinkBehavior.canCreateAlternateLinkError.LinkAlreadyExists"))):(s=!1,o=c.getNLSValue("LinkBehavior.canCreateAlternateLinkError.InsufficentInfo")),u={canCreateLink:s},s?u.data=e.merge({type:n,IDFrom:r,IDTo:a,displayText:c.getNLSValue(n,null,"CreateLink"),buttonIdentifier:c.getNLSValue(n,null,"CreateLink")},e.clone(t)):u.errorMessage=o,u},v=function(e){var t;switch(e.type){case"DELLmiProductionSystemOutputCnxToMBOM":case"DELLmiProductionSystemOutputCnxToMBOM_inverse":t=b(e,e.type);break;case"MfgProcessAlternate":t=C(e,e.type);break;case"HistorizationLinkRefRef":t=S(e,e.type);break;default:t={canCreateLink:!0}}return t},P=function(n,r,a){var o,s,c,u;return o=(n=n||{}).IDFrom,s=n.IDTo,c=n.type,n.type.endsWith("_inverse")?(n.IDFrom=e.is(s,"array")?s.toString():s,n.IDTo=e.is(o,"array")?o.toString():o,n.type=n.type.replace("_inverse","")):(n.IDFrom=e.is(o,"array")?o.toString():o,n.IDTo=e.is(s,"array")?s.toString():s),new t((function(t,a){var o=e.is(n.IDFrom,"array")?n.IDFrom[n.IDFrom.length-1]:n.IDFrom,s=e.is(n.IDTo,"array")?n.IDTo[n.IDTo.length-1]:n.IDTo,l={linkType:c,target:o,source:s},g=function(t,n){e.is(n)&&(l.errorMessage=n),a(l)};(u=v(n)).canCreateLink?(r=r||{},i.createConnection({IDFrom:n.IDFrom,IDTo:n.IDTo,type:n.type},e.merge({onFailure:g,onTimeout:g,onCancel:g,onComplete:function(){t(l)}},r))):(l.errorMessage=u.errorMessage,a(l))}))},{listenTo:function(){return{LoadRelations:function(e){var t;return Array.isArray(e)&&(t=e),I(t)}}},onStart:function(){},onStop:function(){},getPossibleRelationTypes:function(t){var n=r.getBehavior("ImplementBehavior"),o=r.getBehavior("ProductFlowLinkBehavior"),s=r.getBehavior("CapableResourceLinkBehaviour"),c=n.getScopeLinkType(),u=c+"_inverse",l=n.getImplementLinkType(),g=l+"_inverse",f=e.is(t.fromSideRefPID)?i.getReference(t.fromSideRefPID):null,d=e.is(t.toSideRefPID)?i.getReference(t.toSideRefPID):null,p=e.is(f)?f.get("type"):null,m=e.is(d)?d.get("type"):null,y={};return e.is(p)&&e.is(m)?(a.getPossibleRelations(p,m,"write").forEach((function(r){var i=t.fromSideAbsPath,a=t.toSideAbsPath,f=t.fromSideRefPID,d=t.toSideRefPID,p={};switch(r){case c:case u:p=n.canCreateScopeLink(t,r);break;case l:case g:p=n.canCreateImplementLink(i,a,r);break;case"ResultingProductLink":case"ResultingProductLink_inverse":p=n.canCreateResultingProductLink(f,d,r);break;case"DELLmiProductionSystemOutputCnxToMBOM":case"DELLmiProductionSystemOutputCnxToMBOM_inverse":p=b(t,r);break;case"MfgProcessAlternate":p=C(t,r);break;case"HistorizationLinkRefRef":p=S(t,r);break;case"DELAsmProcessCanUseCnx":case"DELAsmProcessCanUseCnx_inverse":p=s.canCreatePrimaryCapableRscLink(t,r);break;case"SecondaryCandidateResourceLink":case"SecondaryCandidateResourceLink_inverse":p=s.canCreateSecondaryCapableRscLink(t,r);break;case"DELLmiTimeConstraintCnx":case"DELLmiMaterialPathCnxCust":case"DELLmiExecTimeConstraintRelation":p=o.canCreateProductFlowLink(t,r);break;default:p={canCreateLink:!1}}p.canCreateLink&&(delete p.canCreateLink,p.data=e.is(p.data,"array")?p.data:[p.data],y[r]=p)})),y):(r.debug("No Types on models"),[])},isLinkPossible:function(e,t,n,r){return a.isLinkPossible(e,t,n,r)},webServiceRequest:function(e){o.webServiceRequest(e)},getConnection:function(e){return i.getConnection(e)},isExploreWebAppEnabled:function(){return!g.isCloud()},createConnectionsByType:function(e,t){var n=r.getBehavior("ImplementBehavior"),i=n.getScopeLinkType(),a=i+"_inverse",o=n.getImplementLinkType(),s=o+"_inverse",c=e.linkType,u=e.linksData;switch(c){case i:case a:n.createScopeLink(u,t);break;case o:case s:n.createImplementLink(u,t);break;default:this.createConnection(u,t)}},createConnection:function(t,n){var a,o={},s=[],u=r.getBehavior("ProductFlowLinkBehavior"),l=r.getBehavior("CapableResourceLinkBehaviour");e.is(t)&&e.is(t,"array")&&(r.notify("startProgress",o),a=r.log(c.getNLSValue("CreateLink.LogMessage")),s=t.map((function(e){var t;switch(e.type){case"DELAsmProcessCanUseCnx":case"DELAsmProcessCanUseCnx_inverse":case"SecondaryCandidateResourceLink":case"SecondaryCandidateResourceLink_inverse":t=l.createConnection(e,n);break;case"DELLmiTimeConstraintCnx":case"DELLmiMaterialPathCnxCust":case"DELLmiExecTimeConstraintRelation":t=u.createProductFlowLink(e,n);break;default:t=P(e,n)}return t})),e.Promise.allSettled(s).then((function(t){var s=0,u={},l={},g={success:u,failed:l};t.forEach((function(t,n){var i,a;"rejected"===t.state?(s++,a=l,i=t.reason,e.is(i.errorMessage,"string")&&r.debug(i.linkType+" creation failed :  "+i.errorMessage)):(a=u,i=t.value),e.is(a[i.linkType])||(a[i.linkType]={}),e.is(a[i.linkType][i.target])||(a[i.linkType][i.target]=[]),a[i.linkType][i.target].push(i.source)})),Object.keys(g).forEach((function(e){var t="success"===e,n=t?"CreateLink.Success":"CreateLink.Failure",o=g[e];Object.keys(o).forEach((function(e){var s=o[e];Object.keys(s).forEach((function(o){var u,l=s[o],g=[],f=i.getReferenceModel(o).get("V_Name");l.forEach((function(e){var t=i.getReferenceModel(e);g.push(t.get("V_Name"))})),u=c.getNLSValue(n,{linkType:c.getNLSValue(e),target:f,source:g.join(", ")}),t?r.info(u,a):(r.warn(u,a),r.debug(u))}))}))})),0===s?y(o,null,n,a):L(o,null,null,n,a)})))},canDeleteRelation:function(t){var n,r,o,s,c,u,l=!1;return n=this.getConnection(t),e.is(n)&&("CapableResourcesStructureLink"===(r=n.getAttribute("type"))?l=!1:"SecondaryCandidateResourceLink"===r?l=!0:(o=n.getAttribute("from"),s=i.getReferenceModel(o).get("type"),c=n.getAttribute("to"),u=i.getReferenceModel(c).get("type"),l=a.isRelationTypeConfigured(r,s,u,"write"))),l},deleteConnection:function(t,n){var a,o,s,g,p={},m=i.getConnection(t),h=m.getAttribute("type"),I=c.getNLSValue(h),b=null,S=r.getBehavior("ImplementBehavior");if(n=n||{},s=r.log(c.getNLSValue("DeleteLink.LogMessage",{linkType:I})),e.is(h)&&"PartialProductImplementLink"===h){const t=l.getSelectionsWithPaths(r.getId())[0];if(e.is(t,"array")&&t.length>0){const n=t;if(e.is(n,"array")&&n.length>0){const t=n[0].path,r=e.is(t)&&t.length>0?t:n.id;u.isPartialScoped(r)&&(e.is(r,"array")&&r.length>0?b=r:b.push(r))}if(e.is(b,"array")&&b.length>0)return S.managePartialScopeLink({implementingAbsPath:b,cmdAction:S.PartialScopeAction.DELETE_PARTIALSCOPE})}r.warn(c.getNLSValue("DeletePartialScopeLink.Failure"),s)}else r.notify("startProgress",p),a={onComplete:function(t,i){var a={};y(p,c.getNLSValue("DeleteLink.Success",{linkType:I}),n,s),e.is(t.preferred)&&(a.linkPID=t.preferred,a.state=!0,r.notify("updatePreferredLink",a)),e.is(i)?r.notify("deleteLink",[i.deletedConnections]):r.notify("deleteLink",m.toJSON())},onFailure:g=function(e,t){L(p,c.getNLSValue("DeleteLink.Failure",{linkType:I}),t,n,s)},onTimeout:g,onCancel:g},o=e.extend({},n),a=e.extend(o,a),f===h?u.deleteScopeLink(t,a):d===h?u.deleteImplementLink(t,a):i.deleteConnection(t,a)},addConnection:function(e,t){return i.addConnection(e,t)},updateLinkAttributes:function(e,t,n){var a,o,u,l,g,f,d,p=[],m={},h={},I={};for(t=t||{},n=n||{},a=0;a<t.length;a++)g=s.getNLS(t[a].attributeInfo),f=s.hasRangeDefined(t[a].attributeInfo,t[a].attributeDef)&&s.isInteger(t[a].attributeInfo),l=(d=t[a].objectToBeModified).get(t[a].dataIndex),u=t[a].newValue,f&&(l=s.getAuthorizedValueIndex(t[a].attributeInfo,t[a].attributeDef,l)),s.isDate(t[a].attributeInfo)&&(l=new Date(l).getTime()/1e3),l!==u&&(s.doesAttributeExist(d,t[a].dataIndex)?(t[a].previousValue=l,p.push(t[a])):r.warn(c.getNLSValue("TableView.AvailabilityFailure",{key:g})));if(0!==p.length){for(a=0;a<p.length;a++)m[p[a].attributeName]=p[a].newValue;o={data:m,onFailure:function(e){for(a=0;a<p.length;a++)e.set(p[a].dataIndex,p[a].previousValue);L(I,c.getNLSValue("AttributeUtil.SaveFailed"),e,n)},onComplete:function(){y(I,c.getNLSValue("AttributeUtil.SaveSucceeded"),n),r.notify("editLinkAttributes",h),r.notify("refreshImpacted")},logMessage:c.getNLSValue("AttributeUtil.EditAttributesLogMessage")},r.notify("startProgress",I),i.updateConnection(e,o)}},getConnectionsByModel:function(e,t,n){i.getConnectionsByModel(e,t,n)},getImpactedConnections:function(e,t,n){return i.getImpacted(e,t,n)},getConnectedObjects:function(t,n,a){var o,s,c,u,l=r.getBehavior("ImplementBehavior"),g=r.getBehavior("CapableResourceLinkBehaviour"),f=[];return o=i.getInstance(t),e.is(o)?(s=t,c=i.getReferenceModelFromInstance(o),u=c.get("PID")):(c=i.getReference(t),u=t),i.getImpacted(t,!1,a).forEach((function(e){var t,r=e.get("type"),i=e.get("from"),a=e.get("to");switch(r){case"ProcessImplementLink":case"PartialProcessImplementLink":case"ProcessImplementLinkOcc":case"ItemSpecOcc":case"PartialProductImplementLink":f=f.concat(l.getConnectedObjects(u,s,n,e)),t=i===u?a:i,f.push(t);break;case"CapableResourcesStructureLink":case"DELAsmProcessCanUseCnx":case"SecondaryCandidateResourceLink":case"DELLmiExecAsmProcessCanUseCnx":case"DELLmiExecAsmProcessCanUseCnxDetails":f=f.concat(g.getConnectedObjects(u,s,n,e));break;case"DELLmiProductionSystemOutputCnxToMBOM":case"MfgProcessAlternate":case"HistorizationLinkRefRef":case"DELIsSerializedFrom":case"AssetContextLink":t=i===u?a:i,f.push(t);break;case"DELIsSerializedFromOp":t=i===s?a:i,f.push(t);break;case"ProductImplementLink":case"ProductImplementLinkOcc":case"ResultingProductLink":case"DELLmiTimeConstraintCnx":case"DELLmiMaterialPathCnxCust":break;default:console.log("Invalid Type")}})),f},getXMLValues:function(e,t,n){return o.getXMLValues(e,t,n)},getRelations:function(t){return h(t).then((function(t){var n=t.result;return{isRelationsLoaded:t.relationsLoaded,connections:e.is(n)?n.connections:[]}}))},areRelationsLoaded:function(t){var n=!0;return t=Array.isArray(t)?t:[t],i.isNavigateOnDemand()&&(n=t.some((function(t){var n,r,a,o=i.getReferenceModel(t),s=o.id===t;return e.is(o)&&(s||(a=t),r=i.getInstance(a),n=e.is(r)?o.getAdditionalInfo("queriedForConnections")&&r.getAdditionalInfo("queriedForConnections"):o.getAdditionalInfo("queriedForConnections")),n}))),n},hasConnection:function(e){return i.hasConnection(e)},getLinkInfo:function(t){var n,r,i,o,u,l={NLS:null,type:null,subType:null,iconName:null};return e.is(t)&&("DELLmiTimeConstraintCnx"===(n=t.get("type"))?(i=a.getAttributeInfo("DELLmiTimeConstraintCnx.V_DependencyType"),"TRUE"===t.get("V_MaterialNeed")?r=n+"_ProductFlow":(o=t.get("V_DependencyType"),u=s.getAuthorizedValueIndex(i,null,o),r=n+"_"+s.getAuthorizedValueDB(i,u)),l.NLS=c.getNLSValue(r),l.type=n,l.subType=r,l.iconName=r):(l.NLS=c.getNLSValue(n),l.type=n,l.subType=t._attributes.kind||t._attributes.flowType,l.iconName=n)),l},getSecondaryRscLinksFromPrimaryLink:function(e){var t;return t=e.get("PID"),i.getImpacted(t,!1,{relationTypes:["SecondaryCandidateResourceLink"]})},cloneSecondaryCapableRscLinkWithFromAttr:function(t){var n=this.getConnection(t.get("from"));return e.is(n)&&(t=t.clone()).set("from",n.get("from")),t},getSecondaryResourceLinksInfo:function(t){var n,r=this,a=[],o=i.getConnection(t),s=this.getSecondaryRscLinksFromPrimaryLink(o);return n=function(t){var n=t.get("PID"),r=t.get("type"),a=t.get("V_IsPreferred"),o=t.get("from"),s=t.get("to"),c=i.getReference(o),u=i.getReference(s),l=e.is(c)?c.get("type"):null,g=e.is(u)?u.get("type"):null,f=e.is(c)?c.get("V_Name"):null,d=e.is(u)?u.get("V_Name"):null,p=e.is(t.get("ResourceUsage"))?t.get("ResourceUsage"):null,m=e.is(p)?i.getInstance(p):null;return{connPID:n,isPreferred:"DELAsmProcessCanUseCnx"===r?a:"",fromPID:o,toPID:s,fromType:l,toType:g,fromName:f,toName:d,resourceUsage:e.is(m)?m.get("PLM_ExternalID"):"",resourceUsagePID:p}},s.forEach((function(e){var t=r.cloneSecondaryCapableRscLinkWithFromAttr(e);a.push(n(t))})),a}}}}})),define("DS/DELWKOModelBehaviors/DELWKOCapableResourceLinkBehavior",["UWA/Core"],(function(e){"use strict";return{plugins:["DatabasePlugin","DicoPlugin","ResourcePlugin"],creator:function(t,n,r,i,a){const o="CapableResourcesStructureLink",s="DELAsmProcessCanUseCnx",c="SecondaryCandidateResourceLink",u="DELLmiExecAsmProcessCanUseCnx";var l,g,f,d,p;return d=function(t,r,i,a){i=i||{},n.info(r,a),n.notify("stopProgress",t),e.is(i.onComplete,"function")&&i.onComplete.call(null,r)},p=function(t,r,i,a,o){a=a||{},e.is(i,"string")&&(r+="\n"+i),n.warn(r,o),n.debug(r),n.notify("stopProgress",t),e.is(a.onFailure,"function")&&a.onFailure.call(null,r)},l=function(t){var n=t.get("PID"),i=t.get("type"),a=t.get("V_IsPreferred"),o=t.get("from"),c=t.get("to"),u=r.getReference(o),l=r.getReference(c),g=e.is(u)?u.get("type"):null,f=e.is(l)?l.get("type"):null,d=e.is(u)?u.get("V_Name"):null,p=e.is(l)?l.get("V_Name"):null,m=e.is(t.get("ResourceUsage"))?t.get("ResourceUsage"):null,y=e.is(m)?r.getInstance(m):null,L=e.is(y)?y.get("PLM_ExternalID"):"";return{connPID:n,isPreferred:i===s?a:"",fromPID:o,toPID:c,fromType:g,toType:f,fromName:d,toName:p,resourceUsage:L,resourceUsagePID:m}},g=function(e){var t=[];return r.getImpacted(e,!1,{relationTypes:[s]}).forEach((function(e){t.push(l(e))})),t},f=function(t,n,i){var a,o,s,c,u,l,g,f,d=!1;return a=e.is(i)?r.getInstance(i):null,o=e.is(a)?a.get("isAggregatedBy"):null,s=r.getReference(t),c=e.is(o)?r.getReference(o):null,u=r.getReference(n),l=s.get("PPRTYPE"),g=e.is(c)?c.get("PPRTYPE"):null,f=u.get("PPRTYPE"),"OPERATION"===l&&"SYSTEM"===g&&"RESOURCE"===f&&(d=!0),d},{listenTo:function(){},onStart:function(){},onStop:function(){},checkType:function(e,t){return r.getReference(e).get("PPRTYPE")===t},checkParentType:function(e,t){var n=r.getInstance(e).get("isAggregatedBy");return r.getReference(n).get("PPRTYPE")===t},getCapableRscStructureLinkOfAncestor:function(e){var t,n,i=[],a={relationTypes:[o]};for(t=e.length-2;t>=0&&1!==(i=r.getImpacted(e[t],!1,a)).length;t--);return e.length>0&&1!==i.length&&(n=r.getInstance(e[0]).get("isAggregatedBy"),i=r.getImpacted(n,!1,a)),1===i.length?i[0]:null},canCreateExecPrimaryCapableRscLink:function(t){var n,o,c,l,g,d,p,m,y,L,h=u,I=!0,b={};return n=t.fromSideRefPID,o=t.toSideRefPID,c=t.fromSideInstPID,l=t.toSideInstPID,g=t.fromSideAbsPath,d=t.toSideRootRefPID,y=r.getReferenceModel(n),i.isAKindOf(y,"DELLmiHeaderWorkPlanReference")?(I=!1,L=a.getNLSValue("CapableResourceLinkBehaviour.canCreatePrimaryCapableRscLinkError.ProcessIsHeaderWP")):r.hasConnection({from:n,to:o,type:s})&&(I=!1,L=a.getNLSValue("CapableResourceLinkBehaviour.canCreatePrimaryCapableRscLinkError.LinkAlreadyExists")),b={canCreateLink:I},I?(b.data=e.merge({type:h,displayText:a.getNLSValue(h,null,"CreateLink"),buttonIdentifier:a.getNLSValue(h,null,"CreateLink")},e.clone(t)),f(n,o,c)&&(p=this.getCapableRscStructureLinkOfAncestor(g),m=e.is(p)?p.get("to"):null,b.data.connectionParams={resourceAreaID:m,rscInstPID:e.is(m)&&m===d?l:null,operationRIRPath:e.is(m)?r.transformToRIROccurrencePath(g).toString():null})):b.errorMessage=L,b},canCreatePrimaryCapableRscLink:function(t){var n,o,c,u,l,g,d,p,m,y,L=s,h=!0,I={};return n=t.fromSideRefPID,o=t.toSideRefPID,c=t.fromSideInstPID,u=t.toSideInstPID,l=t.fromSideAbsPath,g=t.toSideRootRefPID,m=r.getReferenceModel(n),i.isAKindOf(m,"DELLmiHeaderWorkPlanReference")?(h=!1,y=a.getNLSValue("CapableResourceLinkBehaviour.canCreatePrimaryCapableRscLinkError.ProcessIsHeaderWP")):r.hasConnection({from:n,to:o,type:s})&&(h=!1,y=a.getNLSValue("CapableResourceLinkBehaviour.canCreatePrimaryCapableRscLinkError.LinkAlreadyExists")),I={canCreateLink:h},h?(I.data=e.merge({type:L,displayText:a.getNLSValue(L,null,"CreateLink"),buttonIdentifier:a.getNLSValue(L,null,"CreateLink")},e.clone(t)),f(n,o,c)&&(d=this.getCapableRscStructureLinkOfAncestor(l),p=e.is(d)?d.get("to"):null,I.data.connectionParams={resourceAreaID:p,rscInstPID:e.is(p)&&p===g?u:null,operationRIRPath:e.is(p)?r.transformToRIROccurrencePath(l).toString():null})):I.errorMessage=y,I},canCreateSecondaryCapableRscLink:function(t){var n,i,o,s,u,d,p,m,y=c,L=[],h={};return h={canCreateLink:!1,data:[]},n=t.fromSideRefPID,i=t.toSideRefPID,o=t.fromSideInstPID,s=t.fromSideAbsPath,p=f(n,i,o),u=this.getCapableRscStructureLinkOfAncestor(s),d=e.is(u)?u.get("to"):null,e.is(t.connectionParams)&&e.is(t.connectionParams.primaryResourceLinkPID)?(m=r.getConnection(t.connectionParams.primaryResourceLinkPID),L.push(l(m))):L=g(n),L.forEach((function(n){var o,c;i!==n.toPID&&(c={primaryResourceLinkPID:n.connPID},p&&(c=e.merge(c,{resourceAreaID:d,operationRIRPath:e.is(d)?r.transformToRIROccurrencePath(s).toString():null})),o=e.merge({type:y,displayText:a.getNLSValue(y,{primaryResource:n.toName},"CreateLink"),connectionParams:c,buttonIdentifier:n.connPID},e.clone(t)),h.data.push(o),h.canCreateLink||(h.canCreateLink=!0))})),h},canCreateCapableResourcesStructureLink:function(e){var t,n=!0;return t=r.getReferenceModel(e),(i.isAKindOf(t,"DELLmiWorkPlanSystemReference")||i.isAKindOf(t,"DELLmiQtyControlProcessReference "))&&r.getImpacted(e,!0,{relationTypes:[o]}).length>0&&(n=!1),n},addConnection:function(t,i,o,l){var g,f,d,p,m,y,L,h;switch(i=i||{},d=(t=t||{}).fromSideRefPID,p=t.toSideRefPID,m=t.type,y={linkType:m,target:d,source:p},L=function(t,i){var a;e.is(i.instancesAndReferences,"array")&&i.instancesAndReferences.length>0&&r.addInstance(i.instancesAndReferences[0]),t.get("type")!==s&&t.get("type")!==c||(a={linkPID:t.get("PID")},n.notify("updateResourceUsage",a)),e.is(o,"function")&&o(y)},h=function(){e.is(l,"function")&&l(y)},t.type){case s:f=this.canCreatePrimaryCapableRscLink(t);break;case c:f=this.canCreateSecondaryCapableRscLink(t),Array.isArray(f.data)&&f.data.length>=1&&(f.data=f.data[0]);break;case u:f=this.canCreateExecPrimaryCapableRscLink(t);break;default:f={canCreateLink:!1,errorMessage:a.getNLSValue("CapableResourceLinkBehaviour.createConnectionError.InvalidInputs")}}f.canCreateLink?(i=i||{},g={onFailure:h,onTimeout:h,onCancel:h,onComplete:L},r.createExecCanUseResourceLink({resourceId:d,workOrderOperationId:p,type:m},e.merge(g,i))):(y.errorMessage=f.errorMessage,h())},createConnection:function(t,i,o,u){var l,g,f,d,p,m,y,L;switch(i=i||{},f=(t=t||{}).fromSideRefPID,d=t.toSideRefPID,p=t.type,m={linkType:p,target:f,source:d},y=function(t,i){var a;e.is(i.instancesAndReferences,"array")&&i.instancesAndReferences.length>0&&r.addInstance(i.instancesAndReferences[0]),t.get("type")!==s&&t.get("type")!==c||(a={linkPID:t.get("PID")},n.notify("updateResourceUsage",a)),e.is(o,"function")&&o(m)},L=function(){e.is(u,"function")&&u(m)},t.type){case s:g=this.canCreatePrimaryCapableRscLink(t);break;case c:g=this.canCreateSecondaryCapableRscLink(t),Array.isArray(g.data)&&g.data.length>=1&&(g.data=g.data[0]);break;default:g={canCreateLink:!1,errorMessage:a.getNLSValue("CapableResourceLinkBehaviour.createConnectionError.InvalidInputs")}}g.canCreateLink?(i=i||{},l={onFailure:L,onTimeout:L,onCancel:L,onComplete:y},r.createConnection({IDFrom:f,IDTo:d,type:p,connectionParams:g.data.connectionParams},e.merge(l,i))):(m.errorMessage=g.errorMessage,L())},createCapableResourceStructureLink:function(t,i){var s,c,u,l={},g=o,f=function(e,t,n){return a.getNLSValue(e,{linkType:g,target:t,source:n})};return i=i||{},c={onFailure:function(){var e=r.getReferenceModel(t).get("V_Name");p(l,f("CreateLink.CapableResourcesStructureLink.Failure",e,null),null,i,u)},onComplete:function(e){var t=r.getReferenceModel(e.get("from")),n=r.getReferenceModel(e.get("to")),a=t.get("V_Name"),o=n.get("V_Name");d(l,f("CreateLink.Success",a,o),i,u)}},s={type:g,IDFrom:t},n.notify("startProgress",l),u=n.log(a.getNLSValue("CreateLink.LogMessage")),r.createConnection(s,e.merge(c,i))},packConnInfo:function(e){return l(e)},getPrimaryResourceLinksInfo:function(e){return g(e)},getConnectedObjects:function(t,i,a,l){var g=[];return e.is(l)&&(l=Array.isArray(l)?l:[l]).forEach((function(i){var a,l,f,d,p,m=i.get("type"),y=i.get("PID"),L=i.get("from"),h=i.get("to");switch(m){case o:p=L===t?h:L,g.push(p);break;case s:case u:case"DELLmiExecAsmProcessCanUseCnxDetails":a=L,l=h,f=i.get("ResourceUsage"),p=a===t?e.is(f)?f:l:a,g.push(p),r.getImpacted(y,!1,{relationTypes:[c]}).forEach((function(t){var n=t.get("to"),r=t.get("ResourceUsage");g.push(e.is(r)?r:n)}));break;case c:d=r.getConnection(L),e.is(d)&&(a=d.get("from"),g.push(a),l=d.get("to"),f=d.get("ResourceUsage"),g.push(e.is(f)?f:l));break;default:n.debug("Invalid Type")}})),g}}}}})),define("DS/DELWKOModelBehaviors/DELWKOModelBehavior",["UWA/Core","UWA/Promise","DS/DELPPWModelBehaviors_FD02/ModelBehavior","DS/DELPPWModelServices_FD02/BehaviorUtil"],(function(e,t,n,r){"use strict";return{plugins:["DatabasePlugin","ResourcePlugin","AttributePlugin","WebServicePlugin","DicoPlugin","BIPlugin"],creator:function(n,i,a,o,s,c,u,l){var g,f,d,p,m,y,L;return m=function(t,n,r,a,o){var s=r||{};!0===(!e.is(s.popupMessage)||s.popupMessage)?i.info(n,a):i.log(n,a),i.notify("stopProgress",t),e.is(s.onComplete,"function")&&s.onComplete.call(null,n,r,o)},y=function(t,n,r,a,o,s){var c=a||{},u=!e.is(c.popupMessage)||c.popupMessage;e.is(r)&&e.is(r.message,"string")&&(n+="\n"+r.message),!0===u?i.warn(n,o):i.log(n,o),i.notify("stopProgress",t),e.is(c.onFailure,"function")&&c.onFailure.call(null,n,s)},g=function(n,r,s,c,u,l){var g,f,d,p,L,h,I=o.getNLSValue("DeleteObject.Success"),b=o.getNLSValue("DeleteObject.Failure"),S=o.getNLSValue("DeleteObject.PatialFailure"),C=[],v=n?"Instance":"Reference",P={};if(l=!!e.is(l)&&l,s.popupMessage=!e.is(s)||!e.is(s.showConfirmation)||s.showConfirmation,g=function(e,t){L=o.getNLSValue(v,{objectLabel:e.get(c)},"Delete","Success"),i.log(L,p),e.isInstance()&&(d=a.getReferenceModelFromInstance(e)),t(d)},f=function(t,n,r){L=o.getNLSValue(v,{objectLabel:t.get(c)},"Delete","Failure"),e.is(r)&&e.is(r.message,"string")&&(L+="\n"+r.message),i.log(L,p),n()},e.is(r,"array")&&r.length>0){if(i.notify("startProgress",P),p=i.log(o.getNLSValue("DeleteObject.LogMessage")),h=a[n?"deleteInstance":"deleteReference"],!e.is(h,"function"))return void i.debug("delete function not found on database plugin.");r.forEach((function(r){C.push(new t((function(t,a){h(r.id,{deep:!!e.is(u)&&u,onComplete:function(){g(r,t),n&&i.notify("deleteInstance",r.toJSON())},onFailure:function(e,t){f(r,a,t)}})})))})),e.Promise.allSettled(C).then((function(t){var r=!1,a=0,o=0,c=[];for(a=0;a<t.length;a++)"rejected"!==t[a].state?e.is(t[a].value)&&c.push(t[a].value):o++;0===o?(m(P,I,s,p),r=!0):o===t.length?y(P,b,null,s,p):(y(P,S,null,s,p),r=!0),r&&n&&l&&i.notify("addToAuxiliaryView",[c,{askAddToAuxConfirmation:!l}])}))}},L=function(e,t){return a.isInstancePossible(e,t)},d=function(t,n){var r,s,c,u={},l={},g=!1;return n=n||{},e.is(n.securityContextOverride,"string")&&(c=n.securityContextOverride,delete n.securityContextOverride),e.is(n.silent,"boolean")&&(g=n.silent,delete n.silent),e.is(t)?e.is(t.V_Type)&&e.is(t.type)?(r=i.log(o.getNLSValue("ModelBehavior.createWorkOrderFromProcess.LogMessage",{title:t.V_Name,type:t.type})),i.notify("startProgress",u),s=a.createWorkOrderFromProcess(t,{onComplete:function(t){for(var a=t.instancesAndReferences,s=null,c=null,g=a.length,f=[],d=[],p=0;p<g;p++)null!=a[p]&&("WORKORDER"===a[p]._attributes.PPRTYPE&&(s=a[p]),"SYSTEM"===a[p]._attributes.PPRTYPE&&(c=a[p]),void 0===a[p]._attributes.isAggregatedBy?f.push(a[p]):d.push(a[p]));var y={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:f,instanceAttrs:d};n.newRef=s,e.is(s)&&m(u,o.getNLSValue("ModelBehavior.createWorkOrderFromProcess.Success",{name:s._attributes.V_Name,processname:c._attributes.V_Name}),n,r,y),i.notify("createReference",l)},onFailure:function(t,i){var a={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:null,instanceAttrs:null};y(u,o.getNLSValue("ModelBehavior.createWorkOrderFromProcess.Failure"),i,n,r,a)},securityContextOverride:c,silent:g})):i.debug("Type is required to create createWorkOrderFromProcess",s):i.debug("data is empty to addReference"),s},f=function(t,n){var r,s,c,u={},l={},g=!1;return n=n||{},e.is(n.securityContextOverride,"string")&&(c=n.securityContextOverride,delete n.securityContextOverride),e.is(n.silent,"boolean")&&(g=n.silent,delete n.silent),e.is(t)?e.is(t.V_Type)&&e.is(t.type)?(r=i.log(o.getNLSValue("ModelBehavior.CreateReference.LogMessage",{title:t.V_Name,type:t.type})),i.notify("startProgress",u),s=a.createReference(t,{onComplete:function(t){var a={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:t.toJSON(),instanceAttrs:null};n.newRef=t,m(u,o.getNLSValue("ModelBehavior.createWorkOrderFromProcess.Success",{name:t.get("PLM_ExternalID")}),n,r,a),i.notify("createReference",l)},onFailure:function(t,i){var a={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:null,instanceAttrs:null};y(u,o.getNLSValue("ModelBehavior.createWorkOrderFromProcess.Failure"),i,n,r,a)},securityContextOverride:c,silent:g})):i.debug("Type is required to create createReference",s):i.debug("data is empty to addReference"),s},p=function(t,n){var r,s,c={},u=!0;n=n||{},e.is(n.securityContextOverride,"string")&&(s=n.securityContextOverride,delete n.securityContextOverride),e.is(t)?e.is(t.isAggregatedBy)?(e.is(t.isInstanceOf)&&(u=L(a.getReference(t.isAggregatedBy),a.getReference(t.isInstanceOf))),u?(i.notify("startProgress",c),r=i.log(o.getNLSValue("ModelBehavior.CreateInstance.LogMessage")),a.createInstance(t,{onComplete:function(t){var s=a.getReferenceModelFromInstance(t),u={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:e.is(s)?s.toJSON():null,instanceAttrs:e.is(t)?t.toJSON():null};n.newInst=t,m(c,o.getNLSValue("ModelBehavior.CreateInstance.Success",{name:t.get("PLM_ExternalID")}),n,r,u),i.notify("createInstance",t.toJSON())},onFailure:function(t,i){var a={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:null,instanceAttrs:null};y(c,o.getNLSValue("ModelBehavior.CreateInstance.Failure"),i,n,r,a)},securityContextOverride:s})):i.debug("Instance object cannot be created between two selected Types")):i.debug("isAggregatedBy required to create instance"):i.debug("data is empty to createInstance")},{onStart:function(){},onStop:function(){},createWorkOrderFromProcess:function(t,n,r){var a,o={};if(e.is(t)){for(a in t)Object.prototype.hasOwnProperty.call(t,a)&&(o[a]=t[a]);d(o,r)}else i.debug("createWorkOrderFromProcess: No data to insert")},getMfgItemFromWorkOrderOnCloud:function(e){return a.getMfgItemFromWorkOrderOnCloud(e)},getProductionPlanFromWorkOrder:function(e){return a.getProductionPlanFromWorkOrder(e)},createRefOrInst:function(t,n,r){var a,o={};if(e.is(t)){for(a in t)Object.prototype.hasOwnProperty.call(t,a)&&(o[a]=t[a]);e.is(n,"string")?(o.isAggregatedBy=n,p(o,r)):f(o,r)}else i.debug("createRefOrInst: No data to insert")},deleteReference:function(t,n){var r,s,c,u="V_Name",l=i.getBehavior("UXFactoryBehavior"),f=o.getNLSValue("Delete.Confirmation.Title"),d=!(!e.is(n)||e.is(n.showConfirmation))||n.showConfirmation;if(e.is(l)){if(n=n||{},e.is(t,"array")&&t.length>0){for(s=o.getNLSValue("DeleteReference.Confirmation.Message"),r=0;r<t.length;r++)if(a.getInstancesFromCollection(t[r].id).length>0){c=o.getNLSValue("Confirmation.DeleteWholeStructure");break}e.is(c)?d?l.showConfirmation(f,s,{attributes:[u],models:t},(function(r,i,a){e.is(r)&&r&&g(!1,t,n,u,a)}),{check:c,messageType:"Warning"}):g(!1,t,n,u,!0):d?l.showConfirmation(f,s,{attributes:[u],models:t},(function(r){e.is(r)&&r&&g(!1,t,n,u,!1)}),{messageType:"Warning"}):g(!1,t,n,u,!1)}}else i.debug("uxFactoryBehavior is not available.")},deleteInstance:function(t,n){var r,a,s,c="PLM_ExternalID",u=i.getBehavior("UXFactoryBehavior"),l=o.getNLSValue("Confirmation.addRefToAuxViewPostDelete");e.is(u)?(n=n||{},r=!e.is(n.askDeleteConfirmation)||n.askDeleteConfirmation,e.is(t,"array")&&t.length>0&&(r?(!!e.is(n.isDetachInstance)&&n.isDetachInstance?(s=o.getNLSValue("Detach.Confirmation.Title"),a=o.getNLSValue("DetachInstance.Confirmation.Message")):(s=o.getNLSValue("Delete.Confirmation.Title"),a=o.getNLSValue("DeleteInstance.Confirmation.Message")),u.showConfirmation(s,a,{attributes:[c],models:t},(function(r,i,a){e.is(r)&&r&&g(!0,t,n,c,!1,a)}),{check:l})):g(!0,t,n,c))):i.debug("uxFactoryBehavior is not available.")},fetchRoot:function(e,t){return a.fetchRoot(e,t)},fetchInstancesAndTheirReferences:function(e,t){return a.fetchInstancesAndTheirReferences(e,t)},isNavigateOnDemand:function(){return a.isNavigateOnDemand()},fetchInstance:function(e,t){return a.fetchInstance(e,t)},getReference:function(e){return a.getReference(e)},removeReference:function(e,t){a.removeReference(e,t)},getInstance:function(e){return a.getInstance(e)},getReferenceModelFromInstance:function(e){return a.getReferenceModelFromInstance(e)},getAggregatingReferenceModelFromInstance:function(e){return a.getAggregatingReferenceModelFromInstance(e)},getReferenceIdFromInstance:function(e){return a.getReferenceIdFromInstance(e)},getReferenceId:function(e){var t=e;return this.isInstance(e)&&(t=a.getReferenceIdFromInstance(e)),t},getInstancesFromCollection:function(e){return a.getInstancesFromCollection(e)},getParentInstancesFromCollection:function(e){return a.getParentInstancesFromCollection(e)},needToQueryForConnections:function(e){return a.needToQueryForConnections(e)},needToQueryForChildren:function(e){return a.needToQueryForChildren(e)},getDescendantsFromServer:function(e,t,n){a.getDescendantsFromServer(e,t,n)},getConnectionsFromServer:function(e,t,n){a.getConnectionsFromServer(e,t,n)},getAllChildrenFromCollection:function(e){return a.getAllChildrenFromCollection(e)},getImpactedConnections:function(t,n,r){var i,o=[];return e.is(t,"array")&&t.forEach((function(t){i=a.getImpacted(t,n,r),e.is(i)&&e.is(i,"array")&&i.length>0&&(o=o.concat(i))})),o},getReferenceModel:function(e){return a.getReferenceModel(e)},isReference:function(t){return e.is(this.getReference(t))},isInstance:function(t){return e.is(this.getInstance(t))},updateModelAttribute:function(t,n,c,u){var l,g,f,d,p,L,h,I,b,S,C,v,P,R,D,k,T,V,A,N=this,F=[],O=function(t){var n=t,r=function(t){return e.is(t,"string")?s.getFormattedDate(t):s.getFormattedDate(1e3*t)};return s.isDate(P)?n=Array.isArray(t)?t.map((function(e){return r(e)})):r(t):S&&!h&&(n=s.getValueAsString(t,s.getType(P))),n};e.is(n,"array")&&(n=n[0]),n=n||{},u=u||{},e.is(n.instOrRef)&&e.is(n.dataIndex)&&e.is(n.attributeInfo)&&e.is(n.objectToBeModified)&&e.is(n.attributeName)?(D=n.attributeName,P=n.attributeInfo,R=e.is(n.attributeDef)?n.attributeDef:{},p=s.getNLS(P),k=n.objectToBeModified,v=n.dataIndex,L="instance"===n.instOrRef,h=s.hasRangeDefined(P,R),I=s.isString(P),b=s.isInteger(P),S=s.isDouble(P),C=s.isMultiValuated(P),d=k.get(v),e.is(d)&&"NULL"!==d||(d=""),h&&!C&&(I||b||S)&&(d=s.getAuthorizedValue(P,R,d)),V=function(e,t,n,r){var a,s=O(n),c=i.getBehavior("UXFactoryBehavior"),u=c.getComponent("Button"),l=c.createElement("div",{class:"confirmation-dialog-content-container",html:"<p>"+o.getNLSValue("UpdateAttributeUI.Text",{prevValue:s})+"</p>"});(a=c.create("Dialog",{title:o.getNLSValue("UpdateAttributeUI.Header",{attributeName:p}),domId:"EditAttributeUI-Dialog",content:l,resizableFlag:!0,modalFlag:!0,buttons:{No:new u({onClick:function(){n===t&&T(e,r,n),a.close()}}),Yes:new u({disabled:!1,onClick:function(){T(e,t,n),a.close()}})}})).close=function(){this.destroy(),a=null}},A=function(t){var n=!1,r=c;return e.is(t)&&(f=t.get(v),h&&!C&&(I||b)&&(f=s.getAuthorizedValue(P,R,f)),s.isDate(P)&&!s.isMultiValuated(P)?(f=(f=new Date(f).getTime()/1e3).toString(),r=c=r.toString()):S&&s.hasMagnitude(P)&&!C&&(f=parseFloat(f),r=parseFloat(r),c=r.toString()),f!==r&&(s.doesAttributeExist(t,v)?n=!0:i.warn(o.getNLSValue("TableView.AvailabilityFailure",{key:p})))),n},e.is(t,"array")?t.forEach((function(e){l=L?N.getInstance(e):N.getReference(e),A(l)&&F.push(l.id)})):A(k)&&F.push(k.id),0!==F.length&&(1===F.length?(T=function(t,n,s){var c={previous:{}},l={},f={};if(r.isCloud()){delete c.previous;var d=a.getReference(t);if(e.is(d)){var h=d.getODMAttr(v,n);e.is(h)||(h=d.getODMAttr(D,n)),function t(n,r){Object.keys(r).forEach((i=>{e.is(n[i])||(n[i]={}),e.is(r[i])&&"object"!=typeof r[i]||null===r[i]?n[i]=r[i]:t(n[i],r[i])}))}(c,h)}}else c.previous[D]=s,c[D]=n;g={data:c,forceUpdate:!0,onRevisionFailure:function(e,t){y(f,e.message,t,u)},onFailure:function(i,s){if(r.isCloud()){if(e.is(c)&&1===Object.keys(c).length&&e.is(i)){var l=a.getReference(t).get("V_Name");i=i.replace("item",l),y(f,o.getNLSValue("TableView.SingleUpdateODMFailure",{error:i}),s,u)}}else y(f,o.getNLSValue("TableView.SingleUpdateFailure",{key:p,value:O(n)}),s,u)},onComplete:function(a,c){var g=a.get(v);r.isCloud()?(m(f,o.getNLSValue("TableView.SingleUpdateSuccess",{key:p,value:O(n)}),u),i.notify("editAttribute",l)):e.is(c)&&e.is(c.isInSync)&&!c.isInSync?(y(f,o.getNLSValue("TableView.UpdateWarning",{key:p})),V(t,n,g,s)):e.is(a._changed.modified)?(m(f,o.getNLSValue("TableView.SingleUpdateSuccess",{key:p,value:O(g)}),u),i.notify("editAttribute",l)):y(f,o.getNLSValue("TableView.SingleUpdateFailure",{key:p,value:O(n)}),c,u)},logMessage:o.getNLSValue("TableView.SingleUpdateLogMessage")},i.notify("startProgress",f),!0===L?a.updateInstance(t,g):a.updateReference(t,g)},T(F[0],c,d)):F.length>1&&function(e,t){var n={keyValues:{},pids:e},r={},s={};n.keyValues[D]=t,g={data:n,onFailure:function(e){y(s,o.getNLSValue("TableView.MassUpdateFailure",{key:p,value:O(t)}),e,u)},onComplete:function(n){n.length!==e.length?y(s,o.getNLSValue("TableView.UpdateWarning",{key:p})):(m(s,o.getNLSValue("TableView.MassUpdateSuccess",{key:p,value:O(t)}),u),i.notify("editAttribute",r))},logMessage:o.getNLSValue("TableView.MassUpdateLogMessage")},i.notify("startProgress",s),!0===L?a.updateInstances(v,g):a.updateReferences(v,g)}(F,c))):i.debug("Required attribute information is missing to update the model attribute")},updateModelAttribute_v2:function(t,n,c){var u,l,g,f,d,p,L,h,I,b=this,S=[],C=function(t){var n=t,r=function(t){return e.is(t,"string")?s.getFormattedDate(t):s.getFormattedDate(1e3*t)};return s.isDate(p)&&(n=Array.isArray(t)?t.map((function(e){return r(e)})):r(t)),n};e.is(n,"array")||(n=[n]),n=n||{},c=c||{},h=function(e,t,n,r){var a,s=C(n),c=i.getBehavior("UXFactoryBehavior"),u=c.getComponent("Button"),l=c.createElement("div",{class:"confirmation-dialog-content-container",html:"<p>"+o.getNLSValue("UpdateAttributeUI.Text",{prevValue:s})+"</p>"});(a=c.create("Dialog",{title:o.getNLSValue("UpdateAttributeUI.Header",{attributeName:f}),domId:"EditAttributeUI-Dialog",content:l,resizableFlag:!0,modalFlag:!0,buttons:{No:new u({onClick:function(){n===t&&L(e,r,n),a.close()}}),Yes:new u({disabled:!1,onClick:function(){L(e,t,n),a.close()}})}})).close=function(){this.destroy(),a=null}},I=function(t){var n=!1,r=t.newValue,a=t.dataIndex,c=(t.attributeName,t.attributeInfo),u=(e.is(t.attributeDef)&&t.attributeDef,s.getNLS(c)),l=(t.objectToBeModified,t.objectToBeModified);return e.is(l)&&(g=l.get(a),s.isDate(c)&&!s.isMultiValuated(c)&&(g=(g=new Date(g).getTime()/1e3).toString(),e.is(r)&&(r=r.toString())),g!==r&&(s.doesAttributeExist(l,a)?n=!0:i.warn(o.getNLSValue("TableView.AvailabilityFailure",{key:u})))),n},e.is(t,"array")?t.forEach((function(e){u=b.getReference(e),I(u)&&S.push(u.id)})):n.forEach((e=>{I(e)&&(S.includes(e.objectToBeModified.id)||S.push(e.objectToBeModified.id))})),0!==S.length&&(1===S.length?(L=function(t,u,g){var p={previous:{}},L={},I={},b=function t(n,r){Object.keys(r).forEach((i=>{e.is(n[i])||(n[i]={}),e.is(r[i])&&"object"!=typeof r[i]||null===r[i]?n[i]=r[i]:t(n[i],r[i])}))};n.forEach((n=>{if(e.is(n.instOrRef)&&e.is(n.dataIndex)&&e.is(n.attributeInfo)&&e.is(n.objectToBeModified)&&e.is(n.attributeName)){var o=n.attributeName,c=n.attributeInfo,u=e.is(n.attributeDef)?n.attributeDef:{},l=(s.getNLS(c),n.objectToBeModified),f=n.dataIndex,d=(n.instOrRef,s.hasRangeDefined(c,u)),m=s.isString(c),y=s.isInteger(c),L=s.isDouble(c),h=s.isMultiValuated(c),I=l.get(f),S=n.newValue;if(e.is(I)&&"NULL"!==I||(I=""),d&&!h&&(m||y||L)&&(I=s.getAuthorizedValue(c,u,I)),r.isCloud()){delete p.previous;var C=a.getReference(t);if(e.is(C)){var v=C.getODMAttr(f,S);e.is(v)||(v=C.getODMAttr(o,S)),b(p,v)}}else p.previous[o]=g,p[o]=S}else i.debug("Required attribute information is missing to update the model attribute")})),l={data:p,forceUpdate:!0,onRevisionFailure:function(e,t){y(I,e.message,t,c)},onFailure:function(n,i){if(r.isCloud())if(e.is(p)&&1===Object.keys(p).length)if(e.is(n)){var s=a.getReference(t).get("V_Name");n=n.replace("item",s),y(I,o.getNLSValue("TableView.SingleUpdateODMFailure",{error:n}),i,c)}else y(I,o.getNLSValue("TableView.SingleUpdateFailure",{key:f,value:C(u)}),i,c);else y(I,o.getNLSValue("TableView.MultipleAttributesUpdateFailure"),i,c);else y(I,o.getNLSValue("TableView.SingleUpdateFailure",{key:f,value:C(u)}),i,c)},onComplete:function(a,l){var b=a.get(d);r.isCloud()?(e.is(p)&&1===Object.keys(p).length&&"object"!=typeof p?n.forEach((e=>{var t=e.attributeInfo,n=s.getNLS(t);m(I,o.getNLSValue("TableView.SingleUpdateSuccess",{key:n,value:C(e.newValue)}),c)})):m(I,o.getNLSValue("TableView.MultipleAttributesUpdateSuccess"),c),i.notify("editAttribute",L)):e.is(l)&&e.is(l.isInSync)&&!l.isInSync?(y(I,o.getNLSValue("TableView.UpdateWarning",{key:f})),h(t,u,b,g)):e.is(a._changed.modified)?(m(I,o.getNLSValue("TableView.SingleUpdateSuccess",{key:f,value:C(b)}),c),i.notify("editAttribute",L)):y(I,o.getNLSValue("TableView.SingleUpdateFailure",{key:f,value:C(u)}),l,c),e.is(c)&&e.is(c.onComplete)&&c.onComplete()},logMessage:o.getNLSValue("TableView.SingleUpdateLogMessage")},i.notify("startProgress",I),a.updateReference(t,l)},L(S[0])):S.length>1&&function(e,t){var n={keyValues:{},pids:e},r={},s={};n.keyValues[undefined]=t,l={data:n,onFailure:function(e){y(s,o.getNLSValue("TableView.MassUpdateFailure",{key:f,value:C(t)}),e,c)},onComplete:function(n){n.length!==e.length?y(s,o.getNLSValue("TableView.UpdateWarning",{key:f})):(m(s,o.getNLSValue("TableView.MassUpdateSuccess",{key:f,value:C(t)}),c),i.notify("editAttribute",r))},logMessage:o.getNLSValue("TableView.MassUpdateLogMessage")},i.notify("startProgress",s),a.updateReferences(d,l)}(S,iNewValue))},getValidChildTypes:function(e){return a.getValidChildTypes(e)},isInstancePossible:function(e,t){return L(e,t)},isAKindOf:function(e,t){return u.isAKindOf(e,t)},getTypeHierarchy:function(e){return u.getTypeHierarchy(e)},getPPRType:function(e){return a.getPPRType(e)},getPPRTypeFromType:function(e){return u.getPPRType(e)},getParentTypes:function(e){return u.getParentTypes(e)},getReadOnlyTypes:function(){return u.getReadOnlyTypes()},isReferencesHasReadOnlyType:function(e){return u.isReferencesHasReadOnlyType(e)},isReadOnly:function(t,n,r,a){var s,u,l;u=function(e,t,n){i.debug("jsonData: "+e+" error:"+t+" options: "+n),a()},l=function(t){e.is(t.isReadOnly)&&t.isReadOnly&&(s=o.getNLSValue("Error.ObjNotInReadWrite.Title",{objectName:n})),r(s)},c.webServiceRequest({url:"dsmfg/private/V0/invoke/isReadOnly",method:"GET",data:{pid:t},onFailure:u,onTimeout:u,onCancel:u,onComplete:l})},getWhereUsedReferences:function(e,t,n){a.getWhereUsedReferences(e,t,n)},getRootReferenceFromInstance:function(e){return a.getRootReferenceFromInstance(e)},getTenant:function(){return c.getTenant()},getSecurityContext:function(){return c.getSecurityContext()},get3DSpaceUrl:function(){return c.get3DSpaceUrl()},isEntityInstance:function(e){return u.isEntityInstance(e)},getAcceptedBaseTypesForCreation:function(){var t=[],n=u.getAcceptedBaseTypesForActions();return e.is(n)&&e.is(n.CREATION,"array")&&(t=n.CREATION),t},getFilteredInstancesFromCollection:function(e,t){return a.getFilteredInstancesFromCollection(e,t)}}}}})),define("DS/DELWKOModelBehaviors/DELWKOProductFlowBehavior",["UWA/Core","UWA/Promise"],(function(e,t){"use strict";return{plugins:["DatabasePlugin","DicoPlugin","WebServicePlugin","ResourcePlugin"],creator:function(n,r,i,a,o,s){var c,u,l=["DELLmiTimeConstraintCnx","DELLmiMaterialPathCnxCust","LinearProductFlowCnx","DELLmiExecTimeConstraintRelation","DELLmiExecTimeConstraintRelationOnStep"];return function(t,n,i,a){i=i||{},r.info(n,a),r.notify("stopProgress",t),e.is(i.onComplete,"function")&&i.onComplete.call(null,n)},function(t,n,i,a,o){a=a||{},e.is(i,"string")&&(n+="\n"+i),r.warn(n,o),r.debug(n),r.notify("stopProgress",t),e.is(a.onFailure,"function")&&a.onFailure.call(null,n)},u=function(t,n){var r,a,o;return o=t[t.length-1],!(!i.getImpacted(o,!1,{relationTypes:l}).some((function(r){return e.equals(r.get("from"),t)&&e.equals(r.get("to"),n)}))&&(r=!1,(a=function(n){var o,s,c,u=n[n.length-1],g=i.getImpacted(u,!1,{relationTypes:l});for(c=0;c<g.length&&(o=g[c],!0!==r);c++)if(e.equals(o.get("from"),n)){if(e.equals(o.get("to"),t)){r=!0;break}s=o.get("to"),a(s)}})(n),!r))},c=function(t,n){var r,a,o,s,c,u,l={},g={},f=!1;if(e.is(t,"array")&&e.is(n,"array")){for(r=t.length-1;r>=0;r--){for(o=t[r],a=i.getInstance(o).get("isAggregatedBy"),s=n.length-1;s>=0;s--)if(c=n[s],e.is(g[c])?u=g[c]:(u=i.getInstance(c).get("isAggregatedBy"),g[c]=u),a===u&&o!==c){f=!0;break}if(f)break}l.fromPath=t.slice(r),l.toPath=n.slice(s)}return l},{listenTo:function(){},onStart:function(){},onStop:function(){},canCreateProductFlowLink:function(t,n){var r,o,l,g,f,d,p,m,y=!0,L={};return d=function(){var t=!1,n=g.toString(),i=f.toString();return g.length>0&&f.length>0&&0!==n.indexOf(i)&&0!==i.indexOf(n)&&(r=c(g,f),t=e.is(r)&&Array.isArray(r.fromPath)&&r.fromPath.length>0&&Array.isArray(r.toPath)&&r.toPath.length>0),t},p=function(){var t,n,o=!1;return e.is(r)&&Array.isArray(r.fromPath)&&r.fromPath.length>0&&(n=i.getInstance(r.fromPath[0]),e.is(n)&&(t=i.getReference(n.get("isAggregatedBy")),o=a.isAKindOf(t,"DELLmiHeaderWorkPlanReference"))),o},m=function(){var e;return e=i.getInstance(g[g.length-1]),"Linear"===i.getReference(e.get("isAggregatedBy")).get("V_SequencingMode")},t=t||{},e.is(t.fromSideAbsPath)&&e.is(t.toSideAbsPath)?(g=t.fromSideAbsPath,f=t.toSideAbsPath,o=s.getNLSValue(n),d()?p()?(y=!1,l=s.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.CommonParentIsHeaderWP",{linkType:o})):m()?(y=!1,l=s.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.ParentisInLinearSeqMode",{linkType:o})):u(r.fromPath,r.toPath)&&(y=!1,l=s.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.ExistOrLoop",{linkType:o})):(y=!1,l=s.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.NoCommonParent",{linkType:o}))):(y=!1,l=s.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.InsufficentInfo")),L={canCreateLink:y},y?L.data=e.merge({type:n,fromSideOccPath:e.is(r,"object")?r.fromPath:null,toSideOccPath:e.is(r,"object")?r.toPath:null,displayText:e.is(o)?o:null,buttonIdentifier:e.is(o)?o:null},e.clone(t)):L.errorMessage=l,L},createProductFlowLink:function(n,r){var a=this;return new t((function(t,o){var s,c,u,l,g,f;n=n||{},u=a.canCreateProductFlowLink(n,n.type),l=n.fromSideOccPath[n.fromSideOccPath.length-1],g=n.toSideOccPath[n.toSideOccPath.length-1],f={linkType:n.type,target:l,source:g},u.canCreateLink?(s=function(){t(f)},c=function(t,n){e.is(n)&&(f.errorMessage=n),o(f)},i.createConnection({IDFrom:n.fromSideOccPath.toString(),IDTo:n.toSideOccPath.toString(),type:n.type},e.merge({onFailure:c,onTimeout:c,onCancel:c,onComplete:s},r||{}))):(f.errorMessage=u.errorMessage,o(f))}))},getProductFlowRelationTypes:function(){return l},getProductFlowRelationTypeByPPRType:function(e){return l["OPERATION"===e?0:1]}}}}}));