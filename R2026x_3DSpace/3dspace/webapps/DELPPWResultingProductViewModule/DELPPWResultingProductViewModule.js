define("DS/DELPPWResultingProductViewModule/ResultingProductViewUI",["UWA/Core"],(function(e){"use strict";return function(t,n,o,i,r){var a,d,c,l,s=i.getComponent("WUXDockAreaEnum"),u=i.getComponent("WUXFrameWindowsManager").getFrameWindow(t.getAppContext()).getImmersiveFrame();return a=function(a,u){var g=t.getElement(),f=i.createElement("div",{class:"tree-list-container"}),h=e.is(r)?r.getIconURLFromKey(u):"";f.inject(g),l=r.getNLSValue("View."+a+".Title")||"",n.loadDocument(o.getWUXNodeModel()),n.getContent().inject(f),(d=i.create("Panel",{position:{at:"right"},minWidth:300,minHeight:250,height:250,title:l,icon:h,side:s.RightDockArea,currentDockArea:s.RightDockArea,identifier:"panel-"+c,content:g,resizableFlag:!0,closeButtonFlag:!0,useBordersFlag:!0,visibleFlag:!1,collapsibleFlag:!0,verticallyStretchableFlag:!1})).close=function(){e.is(c)?t.notify("toggleCmdCheckHeaderState",{cmdName:c,cmdState:!1}):d.hide()}},{init:function(n,o,i){e.is(n,"string")?(c=n,a(o,i)):t.debug("ResultingProductViewUI","Command name is not defined to create action UI.")},destroy:function(){o.emptyNodeModel(),e.is(d)&&(d.destroy(),d=void 0)},toggle:function(t){var n;t.state&&!d.visibleFlag?(d.immersiveFrame=u,n=u.getDockingElement(d.currentDockArea),e.is(n)&&(n.collapseDockingZoneFlag=!1),d.show()):d.hide()},updateTitle:function(t){e.is(t)&&""!==t?d.title=l+" - "+t:d.title=l}}}})),define("DS/DELPPWResultingProductViewModule/ResultingProductViewModule",["UWA/Core","DS/DELPPWResultingProductViewModule/ResultingProductViewUI"],(function(e,t){"use strict";return{behaviors:["TreeListViewBehavior","ProductImplementBehavior","WUXNodeModelBehavior","UXFactoryBehavior","LinkBehavior","ModelBehavior","SelectionBehavior","SearchBehavior","ResourceBehavior","ViewBehavior"],creator:function(n,o,i,r,a,d,c,l,s,u,g){const f=["NONE","3D","3D-EIN","EIN"];var h,p,m,C,v,I=[],S=[],R=null,D=function(t){return!(!e.is(t)||!e.is(t.get))&&S.indexOf(t.get("type"))>-1},A=function(){return I.indexOf("PROCESS")>-1||I.indexOf("SERVICE")>-1||I.indexOf("CONSTRUCTION")>-1},y=function(t){var i={action:[],parameters:[]};e.is(t,"array")&&t.length>0?(t.forEach((function(e,t){i.action[t]="addRoot",i.parameters[t]={rootReferencePID:e.id}})),o.processDropEffect(i)):n.debug("No search results")},E=function(){var t,i,a=l.getSelections();r.emptyNodeModel(),e.is(a,"array")&&1===a[1].length?(i=a[1][0],e.is(i)?(R=i,t=c.getReferenceModel(i),e.is(t)?(p.updateTitle(c.getDisplayName(t)),d.getConnectionsByModel(t,null,{silentMode:!0,onComplete:function(n){var i;e.is(R)&&Array.isArray(n)&&n.length>0&&(r.prepareUpdate(),n.forEach((function(n){if(D(n)&&n.get("from")===t.get("PID")&&(i=c.getReference(n.get("to")),e.is(i)&&!r.isNodeAdded(i.get("PID")))){const e=o.getReferenceNodeOptions(i);e.children=[],e.grid.RP_USAGE=function(e){if(!Array.isArray(e))return f.includes(e)?e:"3D";const t=e.filter((e=>f.includes(e)));return Array.isArray(t)&&t.length>0?t[0]:"3D"}(n.get("V_usage")),e.grid.cellInfo={rpConnectionPID:n.get("PLM_ExternalID"),rpConnectionFakeID:n.get("PID")},C=r.addNodeModel(e);const t=!c.needToQueryForChildren(i);r.updateNodeState(C,t?"collapsed":"partiallyExpanded")}})),r.pushUpdate())},forceDBMode:d.isAuthoringMode()})):n.debug("Reference Model is empty for PID:"+i)):n.debug("No selection in mbom to load action view data.")):(R=null,p.updateTitle(""))};const N=function(t){if(e.is(t)&&e.owns(t,"data")&&e.owns(t.data,"nodeModel")){const i=t.data.nodeModel,a=i.getReferencePID(),d=c.getReference(a),l=function(){let t="";if(i.hasChildren())t="expanded";else{const n=c.getInstancesFromCollection(a);e.is(n,"array")&&n.length>0?(n.forEach((e=>{const t=c.getReferenceModel(e.get("PID")),n=o.getReferenceNodeOptions(t);n.children=[],n.instancePID=e.get("PID");const a=r.addNodeModel(n,i);r.updateNodeState(a,"noChildren")})),t="expanded"):t="noChildren"}i.preExpandDone(),r.updateNodeState(i,t)};if(!c.needToQueryForChildren(d))l();else{const e=function(){n.warn(u.getNLSValue("Error.ExpandFailed.Title")),d.setAdditionalInfo({queriedForChildren:!1}),r.updateNodeState(i,"partiallyExpanded")},t={ordered:!1,context:this,doNotExpand:!0,onFailure:e,onTimeout:e,onCancel:function(){n.warn(u.getNLSValue("Info.ExpandCanceled.Title")),d.setAdditionalInfo({queriedForChildren:!1}),r.updateNodeState(i,"partiallyExpanded")}};c.getDescendantsFromServer(d.get("PID"),l,t)}}},P=function(t){if(e.is(t)&&e.owns(t,"data")&&e.owns(t.data,"nodeModel")){const e=t.data.nodeModel;r.updateNodeState(e,"collapsed")}};return{listenTo:function(){return{referenceChanged:this.onChangeIRPC,connectionAdded:this.onAddConnection,connectionChanged:this.onChangeIRPC,connectionRemoved:this.onRemoveConnection,select:this.reloadUI,AlternateBL:this.onAlternateBL,CapableResourceBL:this.onCapableResourceBL,ActionRemove:this.onActionRemove,SearchAndAddCommand:this.onSearchAndAddCommand,refreshImpacted:this.reloadUI}},onStart:function(e){var i;I=(e=e||{}).pprTypes,S=e.linkTypes,h=e.relatedCmdId,m=e.moduleIcon,i=u.getNLSValue(h),(p=new t(n,o,r,a,u)).init(h,i,m),p.toggle({state:!0}),v=r.getWUXNodeModel(),r.removePreExpandListener(),v.onPreExpand(N),v.onPreCollapse(P),E()},onStop:function(){e.is(p)&&(p.destroy(),p=void 0),R=null},onBLCommands:function(t,n,o){var i,r=l.getSelections();e.is(r,"array")&&r.length>0&&1===r[1].length&&(i={url:t,method:"POST",context:this,onComplete:n,onFailure:o,data:e.Json.encode({pid:r[1]})},d.webServiceRequest(i))},onAlternateBL:function(){var e=this;e.onBLCommands("dsmfg/private/V0/invoke/getalternatefrombl",(function(t){0===t.referenceIDS.length?n.warn(u.getNLSValue("AlternateBL.Info.Empty")):s.activate("Alternate search",y.bind(e),[],t.referenceIDS)}),(function(e){n.debug(e),n.warn(u.getNLSValue("AlternateBL.Error.Failure"))}))},onCapableResourceBL:function(){var e=this;e.onBLCommands("dsmfg/private/V0/invoke/getResourcesFromBL",(function(t){0===t.resourceIDS.length?n.warn(u.getNLSValue("CapableResourceBL.Info.Empty")):s.activate("Capable resource search",y.bind(e),[],t.resourceIDS)}),(function(e){n.debug(e),n.warn(u.getNLSValue("CapableResourceBL.Error.Failure"))}))},onSearchAndAddCommand:function(){A()?s.activate(u.getNLSValue("InContextSearch.MBOM.Title"),y.bind(this)):I.indexOf("RESOURCE")>-1&&s.activate(u.getNLSValue("InContextSearch.EBOM.Title"),y.bind(this))},onActionRemove:function(){var t,o,i=l.getSelections();e.is(i,"array")&&i[0].length>0&&e.is(1===i[1].length)&&(o=c.getReferenceModel(i[1]),d.getConnectionsByModel(o,null,{onComplete:function(n){if(e.is(n,"array")&&n.length>0)for(t=0;t<i[0].length;t++)n.forEach((function(e){e.get("to")===i[0][t]&&d.deleteConnection(e.get("PID"))}))},onFailure:function(){n.debug("Getting connections failed")}}))},onChangeIRPC:function(t){var n;t=Array.isArray(t)?t:[t],n=l.getSelections(),e.is(n,"array")&&n.length>0&&1===n[1].length&&r.withTransactionUpdate((function(){t.forEach((function(e){A()&&r.updateAttributes(e)}))}))},onAddConnection:function(t){var n=function(t){var n,o,i,a;D(t)&&(i=t.get("to"),n=l.getSelections(),e.is(n,"array")&&1===n[1].length&&(o=c.getReferenceModel(n[1][0]),e.is(o)&&o.get("PID")!==i&&(a=c.getReferenceModel(i),e.is(a)&&(r.isNodeAdded(a.get("PID"))||r.addNode(a,{loadChildren:!1})))))};e.is(t,"array")?t.forEach((function(e){n(e)})):n(t)},onRemoveConnection:function(t){var n=[],o=Array.isArray(t)?t:[t];r.withTransactionUpdate((function(){o.forEach((function(t){var o,i=t.get("to");D(t)&&(o=c.getReferenceModel(i),e.is(o)&&n.push(o.get("PID")))})),n.length>0&&r.removeNodes(n)}))},reloadUI:function(t){e.is(t)&&E()}}}}}));