define("DS/DELPPWPXPBIModule/PXPBIAccoutabilityReport",["UWA/Core"],(function(e){"use strict";return function(t,n,o){let i,c,l,a,s=o.getNLSValue("BIPXPAccountability.Report.Title");const r=function(e){return{NotAssigned:"#E69F00",AssignedMoreThanOnce:"#CC79A7",AssociatedWithScope:"#009E73",AssignedDirectly:"#0072B2"}[e]||"transparent"},u=function(){i.innerHTML=""},d=function(){i.setContent(a),l.on()},b=function(e){u();const t=e.content["AccountabilityReportV1~1"].accountabilityReport,n=function(e){if(!e||!e.reports||0===e.reports.length)return void(document.getElementById("AssignmentStatusTable").innerHTML="No Assignment Status data available.");const t={};e.scopeContexts&&e.scopeContexts.forEach((e=>{t[e.scopeRef]={ScopedEngineeringItemName:e.ScopedEngineeringItemName,ScopingManufacturingItemName:e.ScopingManufacturingItemName}}));let n='\n              <div class = \'bi-table-wrapper\'>\n                <div class="bi-section-title">Assignment Status Table</div>\n                    <table class = "bi-table" border="1">\n                        <thead>\n                            <tr class = "bi-row">\n                                <th class = "bi-table-header">Engineering Occurrence</th>\n                                <th class = "bi-table-header">Engineering Type</th>\n                                <th class = "bi-table-header">Range</th>\n                                <th class = "bi-table-header">Status</th>\n                                <th class = "bi-table-header">Detail Range</th>\n                                <th class = "bi-table-header">Manufacturing Path</th>\n                                <th class = "bi-table-header">Manufacturing Type</th>\n                                <th class = "bi-table-header">Occurences</th>\n                                <th class = "bi-table-header">Scope Ref</th>\n                                <th class = "bi-table-header">Scope Eng Ref</th>\n                                <th class = "bi-table-header">Scope Mfg Ref</th>\n                            </tr>\n                        </thead>\n                    <tbody>';return e.reports.forEach((e=>{const o=e.engineeringData?.path?.join(", ")||"Unknown",i=e.engineeringData?.type||"Unknown";e.consumptions&&e.consumptions.length>0?e.consumptions.forEach((e=>{const c=e.rangeEff||"Unknown",l=e.status||"Unknown";if("To Skip"===e.status)return;const a=r(l),s=e.details||[];let u=s.reduce(((e,t)=>e+(t.manufacturingData?.length||1)),0)||1,d=!1;s.length>0?s.forEach((e=>{const s=e.rangeEff||"",r=e.occurences?.join(", ")||"",b=e.manufacturingData||[],g=b.length||1;b.forEach(((e,b)=>{const f=e?.path?.join(" > ")||"",h=e?.type||"",P=e.scopeRef||"",p=t[P]||{ScopedEngineeringItemName:"",ScopingManufacturingItemName:""};n+="<tr>",d||(n+=`<td class = "bi-row-cell" rowspan="${u}">${o}</td>\n                                              <td class = "bi-row-cell" rowspan="${u}">${i}</td>\n                                              <td class = "bi-row-cell" rowspan="${u}">${c}</td>\n                                              <td class = "bi-row-cell" rowspan="${u}" style="background-color:${a};">${l}</td>\n                                               `,d=!0),0===b&&(n+=`<td class = "bi-row-cell" rowspan="${g}">${s}</td>`),n+=`<td class = "bi-row-cell">${f}</td>\n                                          <td class = "bi-row-cell">${h}</td>\n                                          <td class = "bi-row-cell">${r}</td>\n                                          <td class = "bi-row-cell">${P}</td>\n                                          <td class = "bi-row-cell">${p.ScopedEngineeringItemName}</td>\n                                          <td class = "bi-row-cell">${p.ScopingManufacturingItemName}</td>\n                                        </tr>`})),0===b.length&&(n+=`<tr class = "bi-row">\n                                    ${d?"":`\n                                        <td class = "bi-row-cell" rowspan="${u}">${o}</td>\n                                        <td class = "bi-row-cell" rowspan="${u}">${i}</td>\n                                        <td class = "bi-row-cell" rowspan="${u}">${c}</td>\n                                        <td class = "bi-row-cell" rowspan="${u}" style="background-color:${a};">${l}</td>\n                                        `}\n                                    <td class = "bi-row-cell" >${s}</td>\n                                    <td class = "bi-row-cell" colspan="7">No manufacturing data</td>\n                                </tr>`,d=!0)})):n+=`<tr class = "bi-row">\n                            <td class = "bi-row-cell">${o}</td>\n                            <td class = "bi-row-cell">${i}</td>\n                            <td class = "bi-row-cell">${c}</td>\n                            <td class = "bi-row-cell" style="background-color:${a};">${l}</td>\n                            <td class = "bi-row-cell" colspan="7">No details available</td>\n                        </tr>`})):n+=`<tr class = "bi-row">\n                    <td class = "bi-row-cell">${o}</td>\n                    <td class = "bi-row-cell">${i}</td>\n                    <td class = "bi-row-cell" colspan="10">No consumptions available</td>\n                </tr>`})),n+="</tbody></table>",n+="</div>",n}(t),o=function(e){if(!e||!e.scopeContexts||0===e.scopeContexts.length)return void(document.getElementById("ScopeLinksTable").innerHTML="No scopeContext data available.");let t='\n                <div class = \'bi-table-wrapper\'>\n                    <div class="bi-section-title">Scope Links Table</div>\n                    <table class = "bi-table" border="1">\n                         <tr class = "bi-row">\n                            <th class = "bi-table-header">scopeRef</th>\n                            <th class = "bi-table-header">Scoped Engineering Item</th>\n                            <th class = "bi-table-header">Scoping Manufacturing Item</th>\n                        </tr>';return e.scopeContexts.forEach((e=>{t+=`<tr class = "bi-row">\n                        <td class = "bi-row-cell">${e.scopeRef}</td>\n                        <td class = "bi-row-cell">${e.ScopedEngineeringItemName}</td>\n                        <td class = "bi-row-cell">${e.ScopingManufacturingItemName}</td>\n                      </tr>`})),t+="</table>",t+="</div>",t}(t);i.innerHTML+=n,i.innerHTML+=o};return{buildSkeleton:function(r){if(e.is(c))return c.visibleFlag||c.show(),c.title=r,void d();a=e.createElement("div"),a.setStyles({display:"flex","justify-content":"center"}),l=n.create("WUXLoader",{text:o.getNLSValue("loading")}).inject(a);let b=e.createElement("div");b.className="job-status-header",b.setAttribute("id","bi-panel-header"),b.setStyles({left:"10px",position:"relative",width:"fit-content"});let g=e.createElement("div");g.className="header-base",g.setStyles({display:"flex","align-items":"center",height:"25px"}),b.setContent(g),i=e.createElement("div",{class:"bi-status-content-container"}),i.setStyles({display:"flex","flex-direction":"column","justify-content":"center"}),d();const f=n.getComponent("WUXFrameWindowsManager").getFrameWindow(t.getAppContext()).getImmersiveFrame(),h=n.create("Panel",{header:b,title:`${s} ${r}`,icon:o.getIconURLFromKey("BIEssentialsCmd"),immersiveFrame:f,content:i,width:1100,height:250,position:{my:"center",at:"center"},resizableFlag:!0,closeButtonFlag:!0,useBordersFlag:!0,visibleFlag:!1,collapsibleFlag:!0,verticallyStretchableFlag:!0});h.close=()=>{u(),h.hide()},h.show(),c=h},populatePanel:function(e){b(e)},closePanel:function(){c.close()},openPanel:function(){c.show()},updateTitle:function(t){e.is(t)&&""!==t?c.title=s+" - "+t:c.title=s}}}})),define("DS/DELPPWPXPBIModule/PXPBIAccountabilityUI",["UWA/Core"],(function(e){"use strict";return function(t,n,o,i){let c,l,a,s,r,u,d,b,g,f=o.getComponent("Button"),h=o.getComponent("TooltipModel"),P={dialogTitle:null,fromAccHeader:null,toAccHeader:null,modalFlag:null};const p="EBOM",S="MBOM",m=function(e,t){return e?g.set(p,t):g.set(S,t),g};return d=function(){a=o.createElement("div",{class:"AuthorLinksUI-Dialog"}),l=o.createElement("div",{class:"fromToDiv-section"}).inject(a),s=new f({label:n.getNLSValue("BIPXPAccountability.Dialog.Submit"),class:"AuthorLinksUI-SwitchBtn",tooltipInfos:new h({shortHelp:n.getNLSValue("BIPXPAccountability.Dialog.Submit")}),onClick:function(){i(g),c.close()}}),r=o.create("SelectionControl",{title:P.fromAccHeader,message:n.getNLSValue("AuthorLinks.SelectAnObject"),renderTo:l,multiSelection:!0}),u=o.create("SelectionControl",{title:P.toAccHeader,message:n.getNLSValue("AuthorLinks.SelectAnObject"),renderTo:l,multiSelection:!0}),s.disabled=!0,g=new Map,g.set(p,null),g.set(S,null),e.is(o)?(c=o.create("Dialog",{title:P.dialogTitle,domId:"PXPAccountability-UI",content:a,modalFlag:P.modalFlag,resizableFlag:!0,buttons:{Cancel:new f({onClick:function(){c.close()}}),Apply:s}}),c.close=function(){e.is(a)&&a.destroy(),this.destroy(),c=null,g=null}):t.debug("uxFactoryBehavior is not available.")},b=function(e,t){const n=t.isEbom(),o=t.getSelectedRefModel();n?r.updateLabel(o):u.updateLabel(o);!function(e){const t=e.get(p),n=e.get(S);s.disabled=null===t||null===n}(m(n,t))},{buildSkeleton:function(t){e.is(t)&&e.extend(P,t),e.is(c)||d()},updateSelection:function(e,t){b(0,t)},destryDialog:function(){e.is(c)&&(c.close(),c=null)},isDialogOpen:function(){return e.is(c)}}}})),define("DS/DELPPWPXPBIModule/DELPXPBISessionManager",[],(function(){"use strict";return function(){let e={};return{saveSession:async function(e,t){this.set(e,t)},set:function(t,n){t&&(e[t]=n||null)},getActiveSessionId:function(){const t=Object.keys(e);return t.length>0?t[0]:null},getSession:function(t){return e[t]},remove:function(t){delete e[t]},reset:function(){e={}}}}})),define("DS/DELPPWPXPBIModule/PXPBIConnector",["DS/DELPPWPXPBIModule/DELPXPBISessionManager","DS/DELPXPBIConnector/DELPXPBIAPI"],(function(e,t){"use strict";return function(){const n=new e;return{createPXPContext:async function(e){const o=n.getActiveSessionId();if(o){if(n.getSession(o).isConnected())return o}const i=t.getSessionId(),c=await t.conectToNode(i,e);return n.saveSession(i,c),i},fetchReport:function(e,o){const i=n.getSession(e);return t.fetchAccountabilityReport(i,o)}}}})),define("DS/DELPPWPXPBIModule/PXPBIModule",["UWA/Core","DS/DELPPWPXPBIModule/PXPBIAccountabilityUI","DS/DELPPWPXPBIModule/PXPBIConnector","DS/DELPPWPXPBIModule/PXPBIAccoutabilityReport"],(function(e,t,n,o){"use strict";const i="BAD_INPUT",c="PXP_ERROR",l={endpointIdentifier:"Accoutability"};function a(e,t,n,o){this._isEbom=e,this._riiPath=t,this._referenceModel=n,this._pid=o,this.isEbom=function(){return this._isEbom},this.getRIIPath=function(){return this._riiPath},this.getSelectedRefModel=function(){return this._referenceModel},this.getPID=function(){return this._pid}}return{behaviors:["UXFactoryBehavior","ResourceBehavior","ModelBehavior","SelectionBehavior"],creator:function(s,r,u,d,b){const g=new n,f=new o(s,r,u),h=function(e){return e.get("PLMEntity.V_Name")},P=new t(s,u,r,(async e=>{const t=e.get("EBOM"),n=e.get("MBOM");!function(e){f.buildSkeleton(e)}(`${h(t.getSelectedRefModel())} - ${h(n.getSelectedRefModel())}`);try{const e=await g.createPXPContext(l),o=await g.fetchReport(e,{ebom:t,mbom:n});!function(e,t){e.populatePanel(t)}(f,o)}catch(e){!function(e){switch(f.closePanel(),e){case i:s.warn(u.getNLSValue("BIPXPAccontability.BAD_INPUT"));break;case c:s.warn(u.getNLSValue("BIPXPAccontability.PXP_Error"));break;default:s.warn(u.getNLSValue("BIPXPAccontability.Generic_Error"))}}(e.type),console.log(e)}})),p=function(){const e={dialogTitle:u.getNLSValue("BIPXPAccountability.Dialog.Title"),fromAccHeader:u.getNLSValue("BIPXPAccountability.Dialog.From"),toAccHeader:u.getNLSValue("BIPXPAccountability.Dialog.To"),modalFlag:!1};P.buildSkeleton(e)},S=function(e){const t=e.path;if(0===t.length)return[e.id];const n=d.transformToRIROccurrencePath(t),o=[...t];return o.unshift(n[0]),o},m=e=>e>1,w=function(t){const n=b.getSelectionsWithPaths(),o=S(t?n[1][0]:n[0][0]);return i=o,e.is(c)||(c="|"),Array.isArray(i)&&i.length>0?i.reduce(((e,t)=>e.toString().length>0?`${e}${c}${t}`:t),""):"";var i,c},I=function(e){if(P.isDialogOpen()&&function(e){return e.changed.isSelected}(e)){const t=function(e){return"EBOM"===e.sourceId}(e),n=function(e){const t=e.changed.nodeId;return d.getReferenceModel(t)}(e),o=e.changed.nodeId;let i=null;if(t){if(m(b.getSelectedNodesCount()))return void s.warn(u.getNLSValue("BIPXPAccontability.EBOM.WrongSelection"));i=new a(t,w(t),n,o)}else{if(m(b.getSelectedNodesCount()))return void s.warn(u.getNLSValue("BIPXPAccontability.MBOM.WrongSelection"));i=new a(t,w(t),n,o)}P.updateSelection(e,i)}};return{listenTo:function(){return{select:I,Accountability:p}},onStart:function(){}}}}}));