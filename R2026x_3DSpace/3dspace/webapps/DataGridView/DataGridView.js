define("DS/DataGridView/DataGridViewFilterPopup",["UWA/Core","DS/Core/BaseComponent","DS/Utilities/Dom","DS/Core/PointerEvents","DS/Controls/Popup","DS/Controls/Accordeon","DS/Controls/Button","DS/TreeModel/ConditionAndSetBaseFilter","DS/Utilities/KeyboardUtils","i18n!DS/DataGridView/assets/nls/translation"],(function(e,t,i,n,o,l,s,r,a,u){"use strict";var d=function(){if(this.elements._popup)return;var t=this;let n=this.propertyId+"_popup_datagridview_filter";this.elements._popup=new o({identifier:n,target:this.getContent(),position:"bottom",offset:{x:0,y:4},alignment:"near",className:"wux-controls-popup wux-datagridview-filter-popup",constraint:"screen",overlap:!1,trigger:"click",beforeDisplayCallback:function(){t._refreshIconView()}});var l=new e.Element("div");i.onNodeRendered(this.elements._popup.getContent(),(()=>{t._initialPopupSize||(t._initialPopupSize={height:t.elements._popup.getContent().clientHeight,width:t.elements._popup.getContent().clientWidth})})),l.style.height="100%",l.style.display="flex",l.style.flexDirection="column";var s=h.call(this);s&&s.inject(l,"top"),this._footerDiv=g.call(this),this._footerDiv.inject(l,"bottom"),this.elements._popup.setBody(l);t=this;this.elements._popup.addEventListener("show",(function(e){if("popup"===e.dsModel.name){t._displayModalContainer(),t.refreshView();var i=t.getActiveFilterView();i&&i.focusContentView()}})),this.elements._popup.addEventListener("hide",(function(e){"popup"===e.dsModel.name&&(t._refreshIconView(),t._removeModalContainer())}))},c=function(e){const t=void 0!==e?e:this.filter.filterModel;return this.filter&&this.filterId!==this.filter.getFilterByValuesId()&&!Array.isArray(t)?"ByConditions":"ByValues"},h=function(){if(this.filter instanceof r){this._accordion=new l({exclusive:!0,collapsibleFlag:!1,style:"divided",stretchableChildrenFlag:!0,items:[{header:u.get("FilterView").FilterByValues,content:null,weight:1},{header:u.get("FilterView").FilterByConditions,content:null}]}),this._accordion.getContent().style.flex="1 1 0px";var e=this;i.addEventOnElement(this,this._accordion,"expand",(function(t){t&&t.options&&0==t.options.expanderIndex?(e.filterMode="ByValues",e.elements._popup.resizableFlag=!0,e.elements._popup.getContent().style.minHeight="320px"):(e.filterMode="ByConditions",e.elements._popup.resizableFlag=!1,e.elements._popup.getContent().style.minHeight="",e._initialPopupSize&&(e.elements._popup.getContent().style.width=e._initialPopupSize.width.toString()+"px",e.elements._popup.getContent().style.height=e._initialPopupSize.height.toString()+"px"));var i=e.getActiveFilterView();i&&i.focusContentView()})),0==this._accordion.expanderIndex?this.elements._popup.getContent().style.minHeight="320px":this.elements._popup.getContent().style.minHeight=""}else this._accordion=null;return this.filterMode=c.call(this),this._accordion},g=function(){var t=new e.Element("div",{class:"wux-datagridview-filter-footer"}),o=this;this._resetLabel=e.createElement("span",{class:"wux-datagridview-filter-reset"}),this._resetLabel.textContent=u.get("FilterView").Reset,this._resetLabel.inject(t),i.addEventOnElement(this,this._resetLabel,n.POINTERHIT,(function(e){if(o.filter){var t=o.getActiveFilterView();if(t){var i=t.buildFilterModelFromView();if(!o.filter.filterModelsAreEqual(o.filter.defaultFilterModel,i)){var n=c.call(o,o.filter.defaultFilterModel);o.filterMode!==n&&(o.filterMode=n,t=o.getActiveFilterView()),t&&t.refreshContentView(void 0!==o.filter.defaultFilterModel?o.filter.defaultFilterModel:null)}}}})),this._OKButton=new s({label:u.get("FilterView").OK,emphasize:"primary",onClick:function(e){o.validateView(),o.elements._popup&&(o.elements._popup.visibleFlag=!1)}});let l=e.createElement("div");l.addClassName("wux-datagridview-filter-buttons-container"),l.inject(t),this._OKButton.getContent().addClassName("wux-datagridview-filter-ok"),this._OKButton.inject(l);var r=new s({label:u.get("FilterView").Cancel,onClick:function(e){o.elements._popup&&(o.elements._popup.visibleFlag=!1)}});return r.getContent().addClassName("wux-datagridview-filter-cancel"),r.inject(l),i.addEventOnElement(this,this.elements._popup,"keydown",(function(e){a.ENTER===e.keyCode&&o._OKButton&&!o._OKButton.disabled&&o._OKButton.onClick()})),t};return t.inherit({name:"DataGridViewFilterPopup",publishedProperties:{filterViewManager:{defaultValue:void 0,type:"object",readOnly:!0},filterId:{defaultValue:"",type:"string",readOnly:!0},propertyId:{defaultValue:"",type:"string",readOnly:!0},validFlag:{defaultValue:!0,type:"boolean"},filter:{defaultValue:null,type:"object",readOnly:!0},filterMode:{defaultValue:"ByValues",type:"string"},filterViewOptions:{defaultValue:void 0,type:"object"}},destroy:function(){this._parent()},showPopup:function(){if(this.elements._popup||d.call(this),this.elements._popup){this._applyFilterMode();var e=this.getActiveFilterView();e&&(e._dataGridViewPossibleValues&&(this.elements._popup.resizableFlag=!0,this.elements._popup.getContent().style.minHeight="270px"),this.elements._popup.visibleFlag=!0,this._displayModalContainer(),e.focusContentView())}},refreshView:function(){var e=this.getActiveFilterView();e&&(e.filterViewOptions=this.filterViewOptions,e.refreshContentView()),this._refreshIconView()},validateView:function(){this.validFlag&&this._updateFilterModelFromView()},clearView:function(){this.validFlag=!0;var e=this.getActiveFilterView();e&&(e.clearFilterViewContent(),this._updateFilterModelFromView())},_build:function(){this._parent(),this.elements.container=new e.Element("div",{styles:{flex:"0 0 auto",display:"inline-block"}}),this.elements.container.dsModel=this,this._filterViewByValues=null,this._filterViewByConditions=null,this._OKButton=null,this.__decorationFlag=!1,this.handleEvents()},_postBuild:function(){const e=this.filterViewManager.view;if(e){const t=e.getColumnOrGroup("label"===this.propertyId?"tree":this.propertyId);this.__decorationFlag=t&&t.filterOptions&&t.filterOptions.readOnly}if(this.__decorationFlag)this.elements.container.setAttributeNode(document.createAttribute("decoration"));else{const e=t=>{this.showPopup(),i.removeEventOnElement(this,this.elements.container,n.POINTERHIT,e),t.stopPropagation()};i.addEventOnElement(this,this.elements.container,n.POINTERHIT,e)}this._refreshIconView()},handleEvents:function(){},getActiveFilterId:function(){if(this.filter)return"ByConditions"===this.filterMode?this.filter.getFilterByConditionId():this.filter.getFilterByValuesId()},getActiveFilterView:function(){return"ByValues"===this.filterMode?this._filterViewByValues:this._filterViewByConditions},_getOrCreateActiveFilterView:function(){var e=this.getActiveFilterView();if(!e&&this.filterViewManager&&this.elements._popup){var t=this.getActiveFilterId(),n=this.filterViewManager.getFilterViewClassName(t);if(n){var o=this.filter;(e=new n({filterViewManager:this.filterViewManager,propertyId:this.propertyId,filterId:t,filter:o,filterViewOptions:this.filterViewOptions})).elements._popup=this.elements._popup,e.buildContentView();var l=this;i.addEventOnElement(this,e,"validFlagChange",(function(){l._updateValidFlag()})),i.addEventOnElement(this,e,"change",(function(){l._updateResetState()})),o&&t===o.getFilterByValuesId()?this._filterViewByValues=e:this._filterViewByConditions=e}else console.log("Cannot create the filter view for Id: "+t)}return e},_updateFilterModelFromView:function(){var e=this.getActiveFilterView();if(e&&this.filterViewManager){var t=this.filterViewManager.filterManager;if(t){var i,n=e.buildFilterModelFromView();this.filterViewManager.disableUpdateView();var o=t.getFilters();if(o){var l=o[this.propertyId];l&&(i=l.filterOptions)}t.setPropertyFilterModel(this.propertyId,{filterId:this.filterId,filterModel:n,filterOptions:i},{isUserInteraction:!0}),(o=t.getFilters())&&o[this.propertyId]&&e.filter!==o[this.propertyId]&&(e.filter&&e.filter.destroy(),e.filter=o[this.propertyId]),this.filterViewManager.enableUpdateView(),this._refreshIconView()}}},_updateValidFlag:function(){var e=this.getActiveFilterView();e&&(this.validFlag=e.validFlag)},_updateResetState:function(){if(this.filter&&this._resetLabel){var e=this.getActiveFilterView();if(e){var t=e.buildFilterModelFromView();this.filter.filterModelsAreEqual(this.filter.defaultFilterModel,t)?this._resetLabel.setAttributeNode(document.createAttribute("disabled")):this._resetLabel.removeAttribute("disabled")}}},_refreshIconView:function(){var e;this.elements.container&&this.filter&&(this.filter.isEmpty()?this.elements._popup&&this.elements._popup.visibleFlag?(this.elements.container.className="wux-datagridview-columnheader-icons wux-datagridview-filter wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-search-filter",e=u.get("FilterView").FilterValues):this.elements.container.className="":this.__decorationFlag?(this.elements.container.className="wux-datagridview-columnheader-icons wux-datagridview-filter wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-filter",e=u.get("FilterView").ReadOnlyFilter):(this.elements.container.className="wux-datagridview-columnheader-icons wux-datagridview-filter wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-filter",e=u.get("FilterView").ModifyFilter),this.tooltipInfos={shortHelp:e})},_applyValidFlag:function(e){this._OKButton&&(this._OKButton.disabled=!this.validFlag)},_applyFilterMode:function(e){var t=this._getOrCreateActiveFilterView();if(t)if(t.refreshContentView(),this._accordion){var i="ByValues"===this.filterMode?0:1,n=t.getPopupContentDiv();n&&this._accordion.updateItem(i,{body:n}),this._accordion.expandItem(i)}else if(this.elements._popup&&this._footerDiv){var o=t===this._filterViewByValues?this._filterViewByConditions:this._filterViewByValues;if(o){var l=o.getPopupContentDiv();l&&l.remove()}var s=t.getPopupContentDiv();s&&s.inject(this._footerDiv,"before")}this._updateValidFlag(),this._updateResetState()},_applyProperties:function(e){this._parent()},_displayModalContainer:function(){if(this.filterViewManager){var e=this.filterViewManager.view;e&&e.displayModalContainer(null,{transparentFlag:!0})}},_removeModalContainer:function(){if(this.filterViewManager){var e=this.filterViewManager.view;e&&e.removeModalContainer()}}})})),define("DS/DataGridView/DataGridViewCustomViewsDialog",["UWA/Core","DS/Utilities/Dom","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Controls/Button","DS/Tweakers/TypeRepresentationFactory","DS/Tweakers/TweakerBoolean","DS/Tweakers/TypeUtils","DS/Tweakers/GeneratedToolbar","DS/Controls/ComboBox","DS/Controls/SelectionChips","DS/Core/PointerEvents","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","i18n!DS/DataGridView/assets/nls/translation"],(function(e,t,i,n,o,l,s,r,a,u,d,c,h,g,p,m){"use strict";let f="CustomConfiguration";const C=[{identifier:"DefaultConfiguration",label:m.get("DefaultView")}];function w(e){if(e)return"string"==typeof e?e:e.label?e.label:e.identifier}function _(t){let i;_.prototype._setSortModel=function(e){let t=this._customViewsDialog?this._customViewsDialog.dataGridView:null,i=this._customViewsDialog&&this._customViewsDialog._customViewsSortModels&&this._customViewsDialog._customViewsSortModels[this._customViewsDialog.getCurrentEditedCustomViewIndex()],n=(t&&t._rowModel?t._rowModel._originalSortModel:this._customViewsDialog.customViewsManager.getSortModel())||[];this._sortModel=[].concat(e||i||n);let o=t?t.sortOptions:void 0;const l=o?o.maxSortedColumnsCount:void 0;"number"==typeof l&&this._sortModel.length>l&&(this._sortModel.length=l)},_.prototype.reset=function(){for(;this._table.rows.length;)this._table.deleteRow(-1);this._selectedDataIndexMap.clear()},_.prototype.getComboBoxAtLine=function(e){return e<this._table.rows.length?this._table.rows[e].cells[0].firstElementChild.dsModel:void 0},_.prototype.getTweakerBooleanAtLine=function(e){return e<this._table.rows.length&&this._table.rows[e].cells.length>1?this._table.rows[e].cells[1].firstElementChild.dsModel:void 0},_.prototype.addLine=function(e){if(!this._customViewsDialog||!this._customViewsDialog.customViewsManager)return;let t=this._customViewsDialog?this._customViewsDialog.dataGridView:null,i=t?t.sortOptions:void 0;const n=i?i.maxSortedColumnsCount:void 0;if("number"==typeof n&&this._table.rows.length>=n)return;let o,l=this._table.insertRow(),s=!0;e&&(o=e.dataIndex,s=Boolean("asc"===e.sort));const u=[{label:"-- "+m.get("DataGridViewCustomViewsDialog").SortByComboxBoxFirstLine+" --",value:0}];let c=this._customViewsDialog.customViewsManager.getColumnModel();if(c){const e=c.getLeafColumns();for(let t=0;t<e.length;t++){const i=e[t];if(c.getColumnOptionValue(i.dataIndex,"sortableFlag")){const e=void 0!==i.text&&""!==i.text?i.text:i.dataIndex;u.push({label:e,value:i.dataIndex})}}}const h=new d({enableSearchFlag:!1,elementsList:u,value:o});h.getContent().classList.add("wux-datagridview-custom-views-combo"),h.inject(l.insertCell());let g="";const p=e=>{if(h.value!==g)if(this._selectedDataIndexMap.get(h.value))h.value=g;else{if(g&&this._selectedDataIndexMap.set(g,!1),l.cells.length>1&&l.deleteCell(1),h.value){let t=c.getColumnTypeRepresentation(h.selectedIndex-1),i=this._customViewsDialog.dataGridView?this._customViewsDialog.dataGridView.getTypeRepresentationFactory():null,n=a.getSortingIconDefinition(t,i,"asc"),o=a.getSortingIconDefinition(t,i,"desc"),s=new r({value:void 0===e||e,displayStyle:"toggleIcon",possibleValues:[{value:"true",icon:n},{value:"false",icon:o},{value:"undefined",icon:""}]});s.inject(l.insertCell()),s.addEventListener("change",(()=>{this._selectedDataIndexMap.set(h.value,s.value?"asc":"desc"),this._customViewsDialog._customViewsSortModels[this._customViewsDialog.getCurrentEditedCustomViewIndex()]=this.getSortModel(),this._customViewsDialog._updateButtonsState()})),this._selectedDataIndexMap.set(h.value,s.value?"asc":"desc"),0===g&&this.addLine()}else{let e=this._customViewsDialog?this._customViewsDialog.dataGridView:null,t=e?e.sortOptions:void 0;const i=t?t.maxSortedColumnsCount:void 0;if("number"==typeof i){if(i){let e=this.getComboBoxAtLine(this._table.rows.length-1);h!==e&&this._table.deleteRow(l.rowIndex),e.value&&this._table.rows.length===i-1&&this.addLine()}}else this._table.deleteRow(l.rowIndex)}g=h.value,this._customViewsDialog._updateButtonsState()}};o?p(s):(g=h.value,this._customViewsDialog._updateButtonsState()),h.addEventListener("change",(()=>{p(),this._customViewsDialog._customViewsSortModels[this._customViewsDialog.getCurrentEditedCustomViewIndex()]=this.getSortModel(),this._customViewsDialog._updateButtonsState()}))},_.prototype.loadSortModel=function(e){this.reset(),this._setSortModel(e);for(let e=0;e<this._sortModel.length;e++)this.addLine(this._sortModel[e]);this.addLine(),this._customViewsDialog._customViewsSortModels[this._customViewsDialog.getCurrentEditedCustomViewIndex()]=e},_.prototype.getSortModel=function(){let e=[];for(let t=0;t<this._table.rows.length;++t){let i=this.getComboBoxAtLine(t).value;i&&e.push({dataIndex:i,sort:this._selectedDataIndexMap.get(i)})}return e},_.prototype.inject=function(e){this._container.inject(e)},_.prototype.setUpdateFromCurrentView=function(e){this._statusVisualFeedback.style.backgroundColor=e?"#E87B00":"transparent"},_.prototype.setDisabledFlag=function(e){if(this._table)for(let t=0;t<this._table.rows.length;t++){let i=this.getComboBoxAtLine(t);i&&Boolean(i.disabled)!==e&&(i.disabled=e)}i&&(i.style.opacity=e?.5:1)},this._customViewsDialog=t,this._container=e.createElement("div",{class:"wux-datagridview-custom-views-part wux-datagridview-custom-views-sort-container"}),this._statusVisualFeedback=e.createElement("div",{class:"wux-datagridview-custom-sortmodel-status-feedback"}),this._statusVisualFeedback.inject(this._container),i=e.createElement("div",{class:"wux-datagridview-custom-sortmodel-label"}),i.innerHTML=m.get("DataGridViewCustomViewsDialog").SortByTitle,i.inject(this._container),this._table=e.createElement("table"),this._table.inject(this._container),this._selectedDataIndexMap=new Map,this._setSortModel()}return i.inherit({name:"DataGridViewCustomViewsDialog",publishedProperties:{customViewsManager:{defaultValue:null,type:"object",readOnly:!0},dataGridView:{defaultValue:null,type:"object",readOnly:!0},title:{defaultValue:m.get("DataGridViewCustomViewsDialog").Title,type:"string",category:"Appearance"},modalFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},autoCloseFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},resizableFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},activateButtonsIfActionPerformed:{defaultValue:!1,type:"boolean",category:"Behavior"},width:{defaultValue:600,type:"integer",category:"Appearance",advancedSetter:!0},height:{defaultValue:530,type:"integer",category:"Appearance",advancedSetter:!0},minWidth:{defaultValue:330,defaultTouchValue:330,advancedSetter:!0,type:"integer",category:"Appearance"}},_preBuild:function(){this._parent(),this._densityComboBox=null,this._editedCustomViews=[],this._selectedCustomView=null,this._treeDocuments=[],this._layoutDensities=[],this._customViewsGroupingOptions=[],this._customViewsSortModels=[],this._updateFromCurrentViewButton=null,this._sortModelView=null},_postBuildView:function(){this._parent();let n=this,o=e.createElement("div",{class:"wux-datagridview-custom-views-maindiv"});if(!this.customViewsManager)return void console.error("No valid customViewsManager has been passed to the constructor of DataGridViewCustomViewsDialog");this._warningContainer=e.createElement("div",{class:"wux-datagridview-warning-locked-view"}),this._warningContainer.style.color="orange",o.appendChild(this._warningContainer),(new s).generateView("",{typePath:"multilineString",semantics:{emphasize:"warning",icon:"attention"},context:"stdTemplate",touchMode:!1,readOnly:!0}).then((e=>{this._warningMessageView=e,e&&e.inject(this._warningContainer)}));let r=this.customViewsManager.getColumnModel();if(!r)return;let a=this.customViewsManager.getCurrentCustomViewIndex(),g=n._editedCustomViews[a];this._viewSelectionDiv=e.createElement("div",{});let p=m.get("DataGridViewCustomViewsDialog")||{};this.elements._toolbar=new u({items:u.prototype.createTreeDocument({entries:[{id:"ViewsInfo",dataElements:{typeRepresentation:"icon",value:{iconName:"info",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"12px"},tooltip:{shortHelp:p.ViewsInfo?p.ViewsInfo.ShortHelp:"",longHelp:p.ViewsInfo?p.ViewsInfo.LongHelp:""},label:p.SelectedView,displayLabel:!0}},{id:"ViewLabel",dataElements:{typeRepresentation:"customEnumMember",displayLabel:!0,value:void 0,possibleValues:n._getAllPossibleCustomViews(),onNodeUpdate:function(e){let t=n._getCustomViewIndex(e.getAttributeValue("data"));n.loadCustomView(t,!1);let i=n._editedCustomViews[t];n.elements._toolbar.updateNodeModel("RenameView",{disabled:!!(t<=0||i&&i.readOnly)}),n.elements._toolbar.updateNodeModel("DeleteView",{disabled:!!(t<=0||i&&i.readOnly)}),n._updateButtonsState()}}},{id:"EditLabel",dataElements:{typeRepresentation:"string",value:w(this._selectedCustomView),visibleFlag:!1,placeholder:p.RenameViewEditor?p.RenameViewEditor.placeHolder:"Enter a name",requiredFlag:!0,onNodeUpdate:function(t,i){if(i&&i.data){let i=e.String.unescapeHTML(t.getAttributeValue("data"));n._selectedCustomView&&""!==i&&w(n._selectedCustomView)!=i&&(n.getCustomViewFromLabel(i)?n._displayNotificationMessage(m.get("DataGridViewCustomViewsDialog.ViewAlreadyExists",{configurationLabel:i})):void 0!==n._selectedCustomView.label?n._selectedCustomView.label=i:n._selectedCustomView.identifier=i,n._updateModelFromCustomViews()),!0===t.options.visibleFlag&&(n.elements._toolbar.updateNodeModel("ViewLabel",{visibleFlag:!0}),n.elements._toolbar.updateNodeModel("EditLabel",{visibleFlag:!1}))}},onViewBlur:function(e){!0===e.options.visibleFlag&&(n.elements._toolbar.updateNodeModel("ViewLabel",{visibleFlag:!0}),n.elements._toolbar.updateNodeModel("EditLabel",{visibleFlag:!1}))}}},{id:"CreateView",dataElements:{typeRepresentation:"functionIcon",value:function(){n.createNewCustomView(),n.renameCurrentCustomView()},icon:{iconName:"plus",fontIconFamily:WUXManagedFontIcons.Font3DS},tooltip:{shortHelp:p.CreateView?p.CreateView.ShortHelp:"",longHelp:p.CreateView?p.CreateView.LongHelp:""}}},{id:"DuplicateView",dataElements:{typeRepresentation:"functionIcon",value:function(){n.createNewCustomView(n._selectedCustomView),n.renameCurrentCustomView()},icon:{iconName:"duplicate",fontIconFamily:WUXManagedFontIcons.Font3DS},tooltip:{shortHelp:p.DuplicateView?p.DuplicateView.ShortHelp:"",longHelp:p.DuplicateView?p.DuplicateView.LongHelp:""}}},{id:"RenameView",dataElements:{typeRepresentation:"functionIcon",value:function(){n.renameCurrentCustomView()},icon:{iconName:"pencil",fontIconFamily:WUXManagedFontIcons.Font3DS},disabled:!!(0===a||g&&g.readOnly),tooltip:{shortHelp:p.RenameView?p.RenameView.ShortHelp:"",longHelp:p.RenameView?p.RenameView.LongHelp:""}}},{id:"DeleteView",dataElements:{typeRepresentation:"functionIcon",value:function(){if(n._selectedCustomView){let t=new i({immersiveFrame:n.immersiveFrame,modalFlag:!0,title:p.DeleteView?p.DeleteView.ShortHelp:"Delete Configuration",content:m.get("DataGridViewCustomViewsDialog.DeleteView.ConfirmationQuestion",{configurationLabel:e.String.unescapeHTML(w(n._selectedCustomView))}),buttons:{Yes:new l({onClick:function(e){n.deleteCustomView(n.getCurrentEditedCustomViewIndex()),t.close()}}),No:new l({onClick:function(e){t.close()}})}})}},icon:{iconName:"trash",fontIconFamily:WUXManagedFontIcons.Font3DS},disabled:!!(0===a||g&&g.readOnly),tooltip:{shortHelp:p.DeleteView?p.DeleteView.ShortHelp:"",longHelp:p.DeleteView?p.DeleteView.LongHelp:""}}}]})}).inject(this._viewSelectionDiv),this._viewSelectionDiv.inject(o),this._descriptionDiv=e.createElement("div",{html:p.Description,class:"wux-datagridview-custom-views-part"}),this._descriptionDiv.inject(o);{let i=e.createElement("div",{class:"wux-datagridview-custom-views-part wux-datagridview-custom-views-datagridview"}),l=require("DS/DataGridView/DataGridView");this._attributesDataGridView=new l({identifier:this.customViewsManager.getIdentifier()+"_CustomViews",cellDragEnabledFlag:!0,rowDragEnabledFlag:!0,rowReorderEnabledFlag:!0,showRowIndexFlag:!1,showSelectionCheckBoxesFlag:!1,showOutlineFlag:!0,rowSelection:"none",cellSelection:"none",showModelChangesFlag:!0,columns:[{text:p.ColumnsName,dataIndex:"tree",editableFlag:!1,resizableFlag:!0,selectableFlag:!1,width:"auto",getCellClassName:function(e){if(e.nodeModel&&e.nodeModel.hasChildren())return"wux-datagridview-custom-views-column-group"}},{text:p.ColumnsVisibleFlag,dataIndex:"visibleFlag",typeRepresentation:"boolean",editionPolicy:"EditionInPlace",width:80,getCellEditableState:function(e){return n._getNodeModelVisibleFlagEditableState(e.nodeModel)},getCellValue:function(e){return n._getNodeModelVisibleFlag(e.nodeModel)}},{text:p.ColumnsWidth,dataIndex:"width",typeRepresentation:"integer",width:this._getCurrentTouchMode()?120:80,editionPolicy:"EditionOnDoubleClick",allowResetToUndefinedByUIFlag:!0,getCellEditableState:function(e){let t=!1;if(n._attributesDataGridView&&n._attributesDataGridView.columns&&n._attributesDataGridView.columns.length>e.columnID&&n._attributesDataGridView.columns[e.columnID]&&n._attributesDataGridView.columns[e.columnID].disabled)return!1;if(!e.nodeModel.hasChildren()){let i=e.nodeModel.getAttributeValue("dataIndex");t=r.getColumnOptionValue(i,"resizableFlag")}return t}},{text:p.ColumnsPinnedState,dataIndex:"pinned",typeRepresentation:"pinnedEnum",width:"auto",editionPolicy:"EditionOnOver",getCellValue:function(e){return n._getNodeModelPinned(e.nodeModel)}}],defaultColumnDef:{minWidth:30,editableFlag:!0,resizableFlag:!1,editionPolicy:"EditionOnOver",sortableFlag:!1,getCellKPIColor:function(e){let t;if(e.nodeModel&&!e.nodeModel.hasChildren()){let i=e.nodeModel.getAttributeValue("dataIndex");if(1===e.columnID&&e.nodeModel.getAttributeValue("visibleFlag")!==r.getColumnVisibleFlag(i))t="#e87b00";else if(2===e.columnID){let n=e.nodeModel.getAttributeValue("width"),o=r.getColumnWidth(i);n==o||void 0===n&&"auto"===o||(t="#e87b00")}else 3===e.columnID&&e.nodeModel.getAttributeValue("pinned")!==r.getColumnPinned(i)&&(t="#e87b00")}return t}}}),this._attributesDataGridView.buildDefaultContextualMenu=function(e,t){return n._attributesDataGridView._contextualMenuBuilder.buildMenu(e,{filter:!0,pin:!1,firstColumnsVisibility:!1,columnsManagement:!1,sizeColumnToFit:!1,insertRow:!1})};let s=function(e,t){if(t.droppedNodes&&t.droppedNodes.length>0){let i=t.droppedNodes[0],o=t.nodeModel,l="top"===t.dropPosition?"before":"after";if(i&&o){let s=i.getTreeDocument();s&&s.options.shouldAcceptDrop({dropPosition:t.dropPosition,draggedTreeNodeModel:i,dropNode:o})&&(s.prepareUpdate(),s.setUseChangeTransactionMode(!1),n._extractNodeModel(i),n._insertNodeModelNextTo(s,i,o,l),n._mergeChildren(s._getTrueRoot()),s.setUseChangeTransactionMode(!0),s.pushUpdate(),n._attributesDataGridView.flashEffectOnNodeModel("ui-modified",i),i.processDescendants({onlyVisibleNodes:!0,processNode:function(e){n._attributesDataGridView.flashEffectOnNodeModel("ui-modified",e.nodeModel)}}),e.preventDefault())}}};this._attributesDataGridView.onDropCell=function(e,t){return s(e,t)},this._attributesDataGridView.onDropRowHeader=function(e,t){return s(e,t)},t.addEventOnElement(this,this._attributesDataGridView,h.POINTERHIT,(function(e,t){2===e.multipleHitCount&&t&&t.nodeModel&&t.nodeModel.hasChildren()&&(t.nodeModel.isExpanded()?t.nodeModel.collapse():t.nodeModel.expand())}));let a={"":"unpinned"};a[p.LeftPinned]="left",a[p.RightPinned]="right",this._attributesDataGridView.getTypeRepresentationFactory().registerEnum("pinnedEnum",a),this._attributesDataGridView.inject(i),i.inject(o)}if(!this.dataGridView||this.dataGridView.rowGroupingEnabledFlag){let t=e.createElement("div",{class:"wux-datagridview-custom-views-part"});n._attributesDataGridView.onDragStartCell=function(e,t){return n._currentDndInfos=t,!0},n._attributesDataGridView.onDragStartRowHeader=function(e,t){return n._currentDndInfos=t,!0},n._attributesDataGridView.onDragEndRowHeader=function(e,t){return n._currentDndInfos=null,!0},n._attributesDataGridView.onDragEndCell=function(e,t){return n._currentDndInfos=null,!0};let i=function(e,t){let i=n._attributesDataGridView.getDraggedRowData(e);if(i){let e={label:i.label,value:i.grid.dataIndex,index:void 0},o=t.chipCellView?t.chipCellView.associatedModelItem:void 0;if(o){let i=t.dropPosition;"left"===i?e.index=n._groupingSelectionChips.getChipPosition(o.chipOptions.label):"right"===i&&(e.index=n._groupingSelectionChips.getChipPosition(o.chipOptions.label)+1)}n._groupingSelectionChips.addChip(e)}return e.preventDefault(),!0},l=function(e,t){if(n._currentDndInfos&&n._currentDndInfos.nodeModel){let t=n._currentDndInfos.nodeModel;if(t.getChildren()&&t.getChildren().length>0)return e.dataTransfer.dropEffect="none",!1;let i=n._groupingSelectionChips.getAllChipsOptions();for(let n=0;n<i.length;n++)if(i[n].label===t.options.label&&i[n].value===t.options.grid.dataIndex)return e.dataTransfer.dropEffect="none",!1;return!0}return!1};this._groupingSelectionChips=new c({placeholder:p.GroupingPlaceholder,onDropCell:function(e,t){return i(e,t)},onDropBlank:function(e,t){return i(e,t)},onDragOverCell:(e,t)=>l(e,t),onDragOverBlank:(e,t)=>l(e,t)}),this._groupingSelectionChips.addEventListener("change",(function(e){let t=n._groupingSelectionChips.getAllChipsOptions().map((function(e){return e.value}));n._customViewsGroupingOptions[n.getCurrentEditedCustomViewIndex()]={dataIndexesToGroup:t},n._updateButtonsState()})),this._groupingSelectionChips.inject(t),t.inject(o)}let f=e.createElement("div",{class:"wux-datagridview-custom-views-sub-container"});this._sortModelView=new _(this),this._sortModelView.inject(f);let C=e.createElement("div",{class:"wux-datagridview-custom-views-layout-density wux-datagridview-custom-views-part"});this._densityLabelDiv=e.createElement("div",{class:"wux-datagridview-custom-views-layout-density-label",html:p.LayoutDensity}),this._densityLabelDiv.inject(C),this._densityComboBox=new d({enableSearchFlag:!1}),this._densityComboBox.getContent().classList.add("wux-datagridview-custom-views-combo"),this._densityComboBox.elementsList=[p.Compact,p.Comfortable],this._densityComboBox.addEventListener("change",(function(){n._layoutDensities[n.getCurrentEditedCustomViewIndex()]=1===n._densityComboBox.selectedIndex?"comfortable":"compact",n._updateButtonsState()})),this._densityComboBox.inject(C),C.inject(f),f.inject(o);{let t=e.createElement("div",{class:"wux-datagridview-custom-views-part wux-datagridview-custom-views-footer"});this._resetToDefaultButton=new l({label:p.ResetPreferences,onClick:function(e){n.resetToDefault()}}),this._resetToDefaultButton.getContent().addClassName("wux-datagridview-custom-views-flushButton"),this._resetToDefaultButton.inject(t),this.dataGridView&&(this._updateFromCurrentViewButton=new l({label:p.UpdateFromCurrentView?p.UpdateFromCurrentView.Label:"Update from Table View",emphasize:"medium-attention"}),this._updateFromCurrentViewButton.getContent().classList.add("wux-datagridview-custom-views-update-button"),this._updateFromCurrentViewButton.tooltipInfos={shortHelp:p.UpdateFromCurrentView?p.UpdateFromCurrentView.ShortHelp:"",longHelp:p.UpdateFromCurrentView?p.UpdateFromCurrentView.LongHelp:""},this._updateFromCurrentViewButton.inject(t),this._updateFromCurrentViewButton.addEventListener("buttonclick",(function(e){n.updateFromCurrentView()}))),t.inject(o)}this.content=o,this.dataGridView?(this.buttons={Ok:new l({label:p.SaveAndApply,onClick:function(e){n.saveCustomViews(!0),n.visibleFlag=!1}}),Save:new l({onClick:function(e){n.saveCustomViews(),n.visibleFlag=!1}}),Cancel:new l({onClick:function(e){n.visibleFlag=!1}})},this.buttons.Save.emphasize="secondary"):this.buttons={Save:new l({onClick:function(e){n.saveCustomViews(),n.visibleFlag=!1}}),Cancel:new l({onClick:function(e){n.visibleFlag=!1}})},this.addEventListener("close",(function(e){n.visibleFlag=!1}))},_applyProperties:function(e){this._parent(e),this.isDirty("dataGridView")&&this._applyDataGridView(e.dataGridView)},_applyDataGridView:function(e){this.dataGridView&&this._properties&&this._properties.customViewsManager&&(this._properties.customViewsManager.value=this.dataGridView.getCustomViewsManager())},_applyVisibleFlag:function(e){this._parent(),this.visibleFlag||(this.elements._toolbar.updateNodeModel("ViewLabel",{visibleFlag:!0}),this.elements._toolbar.updateNodeModel("EditLabel",{visibleFlag:!1}))},loadCustomViews:function(){if(!this.customViewsManager)return;this._editedCustomViews=e.clone(this.customViewsManager.getCustomViews()),0===this._editedCustomViews.length&&(this._editedCustomViews=[...C]),this._layoutDensities=[],this._customViewsGroupingOptions=[],this._customViewsSortModels=[],this._treeDocuments=[];for(let e=0;e<this._editedCustomViews.length;e++)this._createNewTreeDocument();let t=this.customViewsManager.getCurrentCustomViewIndex();t<0&&(t=0),this.loadCustomView(t,!0),this._updateModelFromCustomViews()},_createNodeModelFromColumnOrGroup:function(e,t,i,n){let l;if(e){let s={dataIndex:e.dataIndex||""};e.children||(s.visibleFlag=t,s.width="auto"===i?void 0:i,s.pinned=n||"unpinned"),l=new o({label:e.text,icons:e.icon&&""!==e.icon?[e.icon]:[],grid:s})}return l},_generateTreeDocumentFromCustomView:function(e,t){if(!this.customViewsManager)return;let i=this.customViewsManager.getColumnModel();if(e&&t&&i){e.prepareUpdate();let n=i.getLeafColumns(),o=i.getOrderedColumnIndexesFromChanges(t),l=null;for(let s=0;s<n.length;s++){let r=n[o[s]];if(r){let n=r.dataIndex;if(i.getColumnOrGroup(n)){let o,s,a;o=t.columnsVisibleFlag&&void 0!==t.columnsVisibleFlag[n]?t.columnsVisibleFlag[n]:i.getOriginalColumnOptionValue(n,"visibleFlag"),s=t.columnsWidth&&void 0!==t.columnsWidth[n]?t.columnsWidth[n]:i.getOriginalColumnOptionValue(n,"width"),a=t.columnsPinnedState&&void 0!==t.columnsPinnedState[n]?t.columnsPinnedState[n]:i.getOriginalColumnOptionValue(n,"pinned");let u=this._createNodeModelFromColumnOrGroup(r,o,s,a);this._insertNodeModelNextTo(e,u,l,"after"),l=u}}}e.setUseChangeTransactionMode(!0),e.expandAll(),e.pushUpdate()}},_extractNodeModel:function(e){if(e){let t=e.getParent();if(t)for(t.removeChild(e,!0);t&&!t.hasChildren();){let e=t.getParent();e&&e.removeChild(t,!0),t=e}}},_getColumnOrGroupFromNodeModel:function(e){let t;if(e&&this.customViewsManager){let i=this.customViewsManager.getColumnModel();if(i){let n=e.getAttributeValue("dataIndex");t=i.getColumnOrGroup(n)}}return t},_insertNodeModelNextTo:function(e,t,i,n){if(e&&t){let o=this._getColumnOrGroupFromNodeModel(t);if(o){let l,s=o._parent;for(;s&&(!s.dataIndex||""===s.dataIndex);)s=s._parent;if(s){let o=t.getAttributeValue("pinned"),r=i?i.getAttributeValue("pinned"):void 0,a=null;if(l=i?i.getParent():null,o===r)for(a=l;a&&!this._isNodeModelMatchingColumnOrGroup(a,s)&&!(a&&a.getParent()&&a.getParent()._isTrueRoot());)a=a.getParent();let u=a;if(a&&this._isNodeModelMatchingColumnOrGroup(a,s))l=a;else{a=this._createNodeModelFromColumnOrGroup(s);let t=l?l.getParent():null,o=l?t&&!t._isTrueRoot()?t:l:null,r=s._parent;for(;r;){if(o&&this._isNodeModelMatchingColumnOrGroup(o,r)){o.addChild(a,"before"===n?0:void 0);break}if(r.dataIndex&&""!==r.dataIndex){let e;e=this._isNodeModelMatchingColumnOrGroup(u,r)?u:this._createNodeModelFromColumnOrGroup(r),a.getParent()?o&&e.addChild(o,"before"===n?0:void 0):e.addChild(a,"before"===n?0:void 0),e.expand(),o=e}if(!r._parent)break;r=r._parent}let d=this._getNodeModelLocalIdInHierarchy(i,e._getTrueRoot());void 0!==d&&"after"===n&&d++,!o||o.getParent()||o._isTrueRoot()?a.getParent()||e.addRoot(a,d):e.addRoot(o,d),l=a}}s&&l||(l=e._getTrueRoot());let r=this._getNodeModelLocalIdInHierarchy(i,l);void 0!==r&&"after"===n&&r++,l.addChild(t,r),l.expand()}}},_getNodeModelFromDataIndex:function(e,t){let i=null;return e&&e.processDescendants({processNode:function(e){if(e.nodeModel.getAttributeValue("dataIndex")===t)return i=e.nodeModel,{stopProcessing:!0}}}),i},_getNodeModelLocalIdInHierarchy:function(e,t){let i;if(e&&t){let n=e;for(;n;){if(n.getParent()===t){i=n._getLocalID();break}n=n.getParent()}}return i},_isNodeModelMatchingColumnOrGroup:function(e,t){let i=!1;for(;e&&t;){if(t.dataIndex&&""!==t.dataIndex){if(i=e.getAttributeValue("dataIndex")===t.dataIndex,!i)break;e=e.getParent()}t=t._parent}return i},_getNodeModelVisibleFlagEditableState:function(e){let t=this,i=!1;if(this.customViewsManager){let n=this.customViewsManager.getColumnModel();if(n)if(e.hasChildren())e.processDescendants({processNode:function(e){if(t._getNodeModelVisibleFlagEditableState(e.nodeModel))return i=!0,{stopProcessing:!0}}});else{let t=e.getAttributeValue("dataIndex");i=!n.getColumnAlwaysVisibleFlag(t)}}return i},_getNodeModelVisibleFlag:function(e){let t,i=this;return e&&(e.hasChildren()?e.processDescendants({processNode:function(e){let n=i._getNodeModelVisibleFlag(e.nodeModel);return void 0===n||void 0!==t&&t!==n?(t=void 0,{stopProcessing:!0}):void(t=n)}}):t=e.getAttributeValue("visibleFlag")),t},_getNodeModelPinned:function(e){let t="unpinned";return e&&(t=e.hasChildren()?this._getNodeModelPinned(e.getChildren()[0]):e.getAttributeValue("pinned")),t},_mergeChildren:function(e){if(e){let t=e.getChildren();if(t){if(t.length>1)for(let i=t.length-1;i>0;i--){let n=t[i],o=t[i-1];if(n&&n.hasChildren()&&o&&o.hasChildren()&&n.getAttributeValue("dataIndex")===o.getAttributeValue("dataIndex")){if(this._getNodeModelPinned(n)===this._getNodeModelPinned(o)){let t=n.getChildren().slice();for(let e=0;e<t.length;e++)o.addChild(t[e]);e.removeChild(n)}}}for(let e=0;e<t.length;e++)this._mergeChildren(t[e])}}},loadCustomView:function(e,t){if(this.customViewsManager){let i=this.customViewsManager.getColumnModel();if(i){let n=this._editedCustomViews[e];if(n&&(this._selectedCustomView!==n||t)){if(this._selectedCustomView=n,this._groupingSelectionChips){this._groupingSelectionChips.removeAllChips(),(!this._customViewsGroupingOptions[e]||this._customViewsGroupingOptions[e].dataIndexesToGroup&&0===this._customViewsGroupingOptions[e].dataIndexesToGroup.length)&&(this._customViewsGroupingOptions[e]=n.groupingOptions||{dataIndexesToGroup:[]});let t=this._customViewsGroupingOptions[e];if(t&&t.dataIndexesToGroup)for(let e=0;e<t.dataIndexesToGroup.length;e++){let n=t.dataIndexesToGroup[e];this._groupingSelectionChips.addChip({label:i.getColumnOptionValue(n,"text"),value:n})}}let t=this._treeDocuments[e];if(t){let e=t.getChildren();e&&0!==e.length||this._generateTreeDocumentFromCustomView(t,n)}this._attributesDataGridView.treeDocument=t,this._attributesDataGridView.setActiveCell(-1),this._attributesDataGridView.setScrollerPosition({x:0,y:0}),this._customViewsSortModels[e]||(this._customViewsSortModels[e]=n.columnsSortModel),this._sortModelView.loadSortModel(this._customViewsSortModels[e]),this._layoutDensities[e]||(this._layoutDensities[e]=n.layoutDensity||this.customViewsManager.getOriginalLayoutDensity());let o=this._layoutDensities[e];if(this._densityComboBox.selectedIndex="comfortable"===o?1:0,n&&this._attributesDataGridView.columns&&this._attributesDataGridView.columns.length){let e=Boolean(n.readOnly);Boolean(this._attributesDataGridView.rowReorderEnabledFlag)!==!e&&(this._attributesDataGridView.rowReorderEnabledFlag=!e),Boolean(this._attributesDataGridView.rowDragEnabledFlag)!==!e&&(this._attributesDataGridView.rowDragEnabledFlag=!e),Boolean(this._attributesDataGridView.cellDragEnabledFlag)!==!e&&(this._attributesDataGridView.cellDragEnabledFlag=!e),this._groupingSelectionChips&&Boolean(this._groupingSelectionChips.disabled)!==!e&&(this._groupingSelectionChips.disabled=e),Boolean(this._attributesDataGridView.layout.rowsHeader)!==!e&&(this._attributesDataGridView.layout.rowsHeader=!e),this._sortModelView&&this._sortModelView.setDisabledFlag(e),this._densityComboBox&&Boolean(this._densityComboBox.disabled)!==e&&(this._densityComboBox.disabled=e),this._densityLabelDiv&&(this._densityLabelDiv.style.opacity=e?.5:1),this._descriptionDiv&&(this._descriptionDiv.style.display=e?"none":"block"),this._attributesDataGridView.columns.forEach((t=>{t&&Boolean(t.disabled)!==e&&(t.disabled=e,t.editableFlag=!e,this._attributesDataGridView.updateColumnView(t.dataIndex,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}))}))}this._updateButtonsState()}}}},resetToDefault:function(){if(!this.customViewsManager)return;let e=this.customViewsManager.getColumnModel();if(e){let t=this._attributesDataGridView.getTreeDocument();if(t){t.prepareUpdate();let i=e.getLeafColumns();for(let n=0;n<i.length;n++){let o=i[n].dataIndex,l=this._getNodeModelFromDataIndex(t,o);if(l){let t=e.getOriginalColumnOptionValue(o,"visibleFlag"),i=e.getOriginalColumnOptionValue(o,"width"),n=e.getOriginalColumnOptionValue(o,"pinned");l.updateOptions({grid:{visibleFlag:t,width:"auto"===i?void 0:i,pinned:n||"unpinned"}})}}t._getTrueRoot().sortChildren({isRecursive:!0,sortFunction:function(t,i){for(;t.hasChildren();)t=t.getChildren()[0];for(;i.hasChildren();)i=i.getChildren()[0];let n=t.getAttributeValue("dataIndex"),o=i.getAttributeValue("dataIndex"),l=e.getColumnIndex(n),s=e.getColumnIndex(o),r=e.getOriginalOrderedColumnsReverseIndexes();return r[l]-r[s]}}),t.pushUpdate()}this._groupingSelectionChips&&this._groupingSelectionChips.removeAllChips(),this._customViewsSortModels[this.getCurrentEditedCustomViewIndex()]=[];let i=(this.dataGridView&&this.dataGridView._rowModel?this.dataGridView._rowModel._originalSortModel:this.customViewsManager.getSortModel())||[];this._sortModelView.loadSortModel(i),this._densityComboBox.selectedIndex="comfortable"===this.customViewsManager.getOriginalLayoutDensity()?1:0,this._resetToDefaultButton.disabled=!0}},updateFromCurrentView:function(){if(!this.dataGridView||!this.customViewsManager)return;let e=this.customViewsManager.getColumnModel(),t=this._attributesDataGridView.getTreeDocument();if(t&&e){t.prepareUpdate();let i=e.getLeafColumns();for(let n=0;n<i.length;n++){let o=i[n].dataIndex,l=this._getNodeModelFromDataIndex(t,o);if(l){let t=e.getColumnVisibleFlag(o),i=e.getColumnWidth(o),n=e.getColumnPinned(o);l.updateOptions({grid:{visibleFlag:t,width:"auto"===i||"fitVisibleContent"===i||"fitAllContent"===i?void 0:i,pinned:n||"unpinned"}})}}t._getTrueRoot().sortChildren({isRecursive:!0,sortFunction:function(t,i){if(t.hasChildren())return t._getRowID()-i._getRowID();{let n=t.getAttributeValue("dataIndex"),o=i.getAttributeValue("dataIndex"),l=e.getColumnIndex(n),s=e.getColumnIndex(o),r=e.getOrderedColumnsReverseIndexes();return r[l]-r[s]}}}),t.pushUpdate();let n=this.dataGridView?this.dataGridView.sortModel:this.customViewsManager.getSortModel();if(this._selectedCustomView&&(this._customViewsSortModels[this.getCurrentEditedCustomViewIndex()]=n),this._groupingSelectionChips){this._groupingSelectionChips.removeAllChips();let t=this.dataGridView?this.dataGridView.getGroupingOptions():null;if(t)for(let i=0;i<t.dataIndexesToGroup.length;i++){let n=t.dataIndexesToGroup[i];this._groupingSelectionChips.addChip({label:e.getColumnOptionValue(n,"text"),value:n})}}this._sortModelView.loadSortModel(n);let o=this.dataGridView?this.dataGridView.layout:null,l=o?o.layoutDensity:this.customViewsManager.getOriginalLayoutDensity();this._densityComboBox.selectedIndex="comfortable"===l?1:0,this._updateFromCurrentViewButton&&(this._updateFromCurrentViewButton.disabled=!0,this._updateFromCurrentViewButton.emphasize=void 0)}},_checkIfResetToDefaultIsPossible:function(){if(!this.customViewsManager)return!1;let e=this.customViewsManager.getColumnModel();if(!e)return!1;let t=!1,i=this._attributesDataGridView.getTreeDocument();if(i){let n=e.getOriginalOrderedColumnsIndexes(),o=0;i.processDescendants({processNode:function(i){if(i.nodeModel&&!i.nodeModel.hasChildren()){let l=i.nodeModel.getAttributeValue("dataIndex");if(n[o]!==e.getColumnIndex(l))return t=!0,{stopProcessing:!0};let s=i.nodeModel.getAttributeValue("visibleFlag"),r=i.nodeModel.getAttributeValue("width"),a=i.nodeModel.getAttributeValue("pinned");if(!t&&s!==e.getOriginalColumnOptionValue(l,"visibleFlag"))return t=!0,{stopProcessing:!0};if(!t){let i=e.getOriginalColumnOptionValue(l,"width");if(parseFloat(r)!=parseFloat(i)&&(void 0!==r||"auto"!==i))return t=!0,{stopProcessing:!0}}if(!t&&a!==e.getOriginalColumnOptionValue(l,"pinned"))return t=!0,{stopProcessing:!0};o++}}})}if(!t&&this._selectedCustomView){let e=(this.dataGridView&&this.dataGridView._rowModel?this.dataGridView._rowModel._originalSortModel:this.customViewsManager.getSortModel())||[],i=this._sortModelView.getSortModel();Array.isArray(i)&&Array.isArray(e)&&JSON.stringify(i)!==JSON.stringify(e)&&(t=!0)}if(!t&&this._groupingSelectionChips&&this._groupingSelectionChips.getNumberOfChips()>0&&(t=!0),!t){let e="comfortable"===this.customViewsManager.getOriginalLayoutDensity()?1:0;this._densityComboBox.selectedIndex!==e&&(t=!0)}return this._selectedCustomView&&this._selectedCustomView.readOnly&&(t=!1),this._resetToDefaultButton&&(this._resetToDefaultButton.disabled=!t),t},_checkIfUpdateFromCurrentViewIsPossible:function(){if(!this.dataGridView||!this.customViewsManager)return!1;let e=this.customViewsManager.getColumnModel();if(!e)return!1;let t=!1,i=[];if(this._groupingSelectionChips){let e=this._groupingSelectionChips.getAllChipsOptions();i=e.map((function(e){return e.value}))}let n=this._attributesDataGridView.getTreeDocument();if(n){let o=this,l=e.getOrderedColumnsIndexes(),s=0;n.processDescendants({processNode:function(n){if(n.nodeModel&&!n.nodeModel.hasChildren()){let r=n.nodeModel.getAttributeValue("dataIndex");if(l[s]!==e.getColumnIndex(r))return t=!0,{stopProcessing:!0};let a=!o.dataGridView||o.dataGridView.rowGroupingEnabledFlag,u=!o.dataGridView||!o.dataGridView.rowGroupingOptions||o.dataGridView.rowGroupingOptions.hideGroupedColumns,d=n.nodeModel.getAttributeValue("visibleFlag")&&(!a||!u||"tree"===r||i.indexOf(r)<0),c=n.nodeModel.getAttributeValue("width"),h=n.nodeModel.getAttributeValue("pinned");if(!t&&d!==e.getColumnVisibleFlag(r))return t=!0,{stopProcessing:!0};if(!t){let i=e.getColumnWidth(r);if(c!=i&&(void 0!==c||"auto"!==i))return t=!0,{stopProcessing:!0}}if(!t&&h!==e.getColumnPinned(r))return t=!0,{stopProcessing:!0};s++}}})}if(this._selectedCustomView){let e=this.dataGridView?this.dataGridView.sortModel:this.customViewsManager.getSortModel(),i=this._sortModelView.getSortModel();!e&&i&&i.length>0||!i&&e&&e.length>0||Array.isArray(e)&&Array.isArray(i)&&JSON.stringify(i)!==JSON.stringify(e)?(t=!0,this._sortModelView.setUpdateFromCurrentView(!0)):this._sortModelView.setUpdateFromCurrentView(!1)}if(!t&&this._groupingSelectionChips){let e=this._groupingSelectionChips.getAllChipsOptions();i=e.map((function(e){return e.value}));let n=this.dataGridView?this.dataGridView.getGroupingOptions():null;(!n&&i.length>0||n&&!n.dataIndexesToGroup.equals(i))&&(t=!0)}if(!t){let e=this.dataGridView?this.dataGridView.layout:null,i="comfortable"===(e?e.layoutDensity:this.customViewsManager.getOriginalLayoutDensity())?1:0;this._densityComboBox.selectedIndex!==i&&(t=!0)}return t&&this._selectedCustomView&&this._selectedCustomView.readOnly&&this._selectedCustomView.readOnlyWarningMessage&&this._warningContainer&&this._warningMessageView?(t=!1,this._warningMessageView.value=this._selectedCustomView.readOnlyWarningMessage,this._warningContainer.style.display="block",this._viewSelectionDiv.style.marginTop="10px"):(this._warningContainer.style.display="none",this._viewSelectionDiv.style.marginTop=""),this._updateFromCurrentViewButton&&(this._updateFromCurrentViewButton.disabled=!t,this._updateFromCurrentViewButton.emphasize=t?"medium-attention":void 0),t},_checkIfSaveAndApplyArePossible:function(){if(!this.customViewsManager)return!1;let e=this.customViewsManager.getColumnModel();if(!e)return!1;let t=!1,i=!1,n=[];if(this._groupingSelectionChips){let e=this._groupingSelectionChips.getAllChipsOptions();n=e.map((function(e){return e.value}));for(let e=0;e<this._editedCustomViews.length;++e){let i=this._editedCustomViews[e].groupingOptions||{dataIndexesToGroup:[]};if(i=JSON.stringify(i),void 0!==this._customViewsGroupingOptions[e]&&JSON.stringify(this._customViewsGroupingOptions[e])!==i){t=!0;break}}if(this.dataGridView){let e=this.dataGridView.getGroupingOptions()?JSON.stringify(this.dataGridView.getGroupingOptions()):JSON.stringify({dataIndexesToGroup:[]});(this._customViewsGroupingOptions[this.getCurrentEditedCustomViewIndex()]?JSON.stringify(this._customViewsGroupingOptions[this.getCurrentEditedCustomViewIndex()]):JSON.stringify({dataIndexesToGroup:[]}))!==e&&(i=!0)}}let o=this.dataGridView?this.dataGridView.layout:null;if(!t)for(let i=0;i<this._treeDocuments.length;i++){let n=this._treeDocuments[i],o=this._editedCustomViews[i];if(n&&o){let i=e.getOrderedColumnIndexesFromChanges(o),l=0;n.processDescendants({processNode:function(n){if(n.nodeModel&&!n.nodeModel.hasChildren()){let s=n.nodeModel.getAttributeValue("dataIndex"),r=n.nodeModel.getAttributeValue("pinned");if(i[l]!==e.getColumnIndex(s))return t=!0,{stopProcessing:!0};let a=n.nodeModel.getAttributeValue("visibleFlag");if(a!==e.getOriginalColumnOptionValue(s,"visibleFlag")&&(!o.columnsVisibleFlag||!o.columnsVisibleFlag.hasOwnProperty(s))||o.columnsVisibleFlag&&o.columnsVisibleFlag.hasOwnProperty(s)&&o.columnsVisibleFlag[s]!==a)return t=!0,{stopProcessing:!0};let u=n.nodeModel.getAttributeValue("width");if(void 0===u&&(u="auto"),u!=e.getOriginalColumnOptionValue(s,"width")&&(!o.columnsWidth||!o.columnsWidth.hasOwnProperty(s))||o.columnsWidth&&o.columnsWidth.hasOwnProperty(s)&&o.columnsWidth[s]!=u)return t=!0,{stopProcessing:!0};if(r!==e.getOriginalColumnOptionValue(s,"pinned")&&(!o.columnsPinnedState||!o.columnsPinnedState.hasOwnProperty(s))||o.columnsPinnedState&&o.columnsPinnedState.hasOwnProperty(s)&&o.columnsPinnedState[s]!==r)return t=!0,{stopProcessing:!0};l++}}})}}let l=(this.dataGridView&&this.dataGridView._rowModel?this.dataGridView._rowModel._originalSortModel:this.customViewsManager.getSortModel())||[],s=this._selectedCustomView.columnsSortModel||l,r=this._customViewsSortModels[this.getCurrentEditedCustomViewIndex()];Array.isArray(s)&&Array.isArray(r)&&JSON.stringify(s)!==JSON.stringify(r)&&(t=!0);let a=this.customViewsManager.getCurrentCustomViewIndex();this.getCurrentEditedCustomViewIndex()!==a&&a>=0&&(i=!0,this.dataGridView||(t=!0));let u=this.customViewsManager.getCustomViews();if(this._editedCustomViews.length!==u.length)t=!0;else for(let e=0;e<this._editedCustomViews.length;++e)if(this._editedCustomViews[e].identifier!==u[e].identifier||w(this._editedCustomViews[e])!==w(u[e])){t=!0;break}if(!t)for(let e=0;e<this._editedCustomViews.length;++e){let i=this._editedCustomViews[e].layoutDensity||this.customViewsManager.getOriginalLayoutDensity();void 0!==this._layoutDensities[e]&&this._layoutDensities[e]!==i&&(t=!0)}if(!i&&this.dataGridView){let e="comfortable"===(o?o.layoutDensity:this.customViewsManager.getOriginalLayoutDensity())?1:0;this._densityComboBox.selectedIndex!==e&&(i=!0)}if(!i&&this.dataGridView){let t=this._attributesDataGridView.getTreeDocument();if(t){let o=e.getOrderedColumnsIndexes(),l=0,s=this;t.processDescendants({processNode:function(t){if(t.nodeModel&&!t.nodeModel.hasChildren()){let r=t.nodeModel.getAttributeValue("dataIndex");if(o[l]!==e.getColumnIndex(r))return i=!0,{stopProcessing:!0};let a=!s.dataGridView||s.dataGridView.rowGroupingEnabledFlag,u=!s.dataGridView||!s.dataGridView.rowGroupingOptions||s.dataGridView.rowGroupingOptions.hideGroupedColumns,d=t.nodeModel.getAttributeValue("visibleFlag")&&t.nodeModel.getAttributeValue("visibleFlag")&&(!a||!u||"tree"===r||n.indexOf(r)<0),c=t.nodeModel.getAttributeValue("width"),h=t.nodeModel.getAttributeValue("pinned");if(!i&&d!==e.getColumnVisibleFlag(r))return i=!0,{stopProcessing:!0};if(!i){let t=e.getColumnWidth(r);if(c!=t&&(void 0!==c||"auto"!==t))return i=!0,{stopProcessing:!0}}if(!i&&h!==e.getColumnPinned(r))return i=!0,{stopProcessing:!0};l++}}})}if(!i&&this._selectedCustomView){let e=(this.dataGridView?this.dataGridView.sortModel:this.customViewsManager.getSortModel())||[],t=this._sortModelView.getSortModel();Array.isArray(e)&&Array.isArray(t)&&JSON.stringify(e)!==JSON.stringify(t)&&(i=!0)}}this._selectedCustomView&&this._selectedCustomView.readOnly&&(t=!1);let d=this.buttons.Ok;d&&(d.disabled=!i,d.label=t?m.get("DataGridViewCustomViewsDialog").SaveAndApply:m.get("DataGridViewCustomViewsDialog").Apply);let c=this.buttons.Save;return c&&(c.disabled=!t),t&&i},_displayNotificationMessage:function(e){p.getNotificationManager()||(p.setNotificationManager(g),p.setRemoveStackOnFirstTimeoutFlag(!0),p.setStackingPolicy(31)),g.addNotif({level:"info",subtitle:e})},_updateButtonsState:function(){this._checkIfResetToDefaultIsPossible(),this._checkIfUpdateFromCurrentViewIsPossible(),this._checkIfSaveAndApplyArePossible()},_createNewTreeDocument:function(){if(!this.customViewsManager)return;let e=this.customViewsManager.getColumnModel();if(!e)return;let t=this,i=new n({shouldAcceptDrop:function(e){if("middle"!==e.dropPosition&&e.draggedTreeNodeModel&&e.dropNode){let i=t._getNodeModelPinned(e.draggedTreeNodeModel);if(t._getNodeModelPinned(e.dropNode)===i&&!e.draggedTreeNodeModel.isAscendantOf(e.dropNode)&&!e.dropNode.isAscendantOf(e.draggedTreeNodeModel)){let i="top"===e.dropPosition?"before":"after",n=e.dropNode;for(;n&&n.hasChildren();)n=n.getChildren()[0],i="before";if(n){let o=t._getColumnOrGroupFromNodeModel(e.draggedTreeNodeModel),l=n.getAttributeValue("dataIndex"),s=t.customViewsManager.getColumnModel();if(!!s&&s.columnMoveIsPossible(o,l,i))return!0}}}return!1}});i.setFilterModel({label:{filterId:"string"},visibleFlag:{filterId:"set"},width:{filterId:"numberWithCondition"},pinned:{filterId:"set"}}),i.onUpdate((function(e){e.options.updateType!==WUXModelUpdateTypes.Selection&&e.options.updateType!==WUXModelUpdateTypes.PreSelection&&t._updateButtonsState()})),i.onNodeModelUpdate((function(i){if(!t._inNodeModelUpdate){t._inNodeModelUpdate=!0;let n=i.data.nodeModel,o=n.getTreeDocument();if(i.data&&i.data.attributes&&void 0!==i.data.attributes.pinned){let e=t._getTopNonSplittableGroupNodeModel(n);e&&(n=e),o.prepareUpdate(),n.hasChildren()&&n.processDescendants({treeTraversalOrder:"postOrder",processNode:function(e){e.nodeModel.setAttribute("pinned",i.data.attributes.pinned)}}),o.setUseChangeTransactionMode(!1),t._extractNodeModel(n);let l=null,s="before",r=t._getPreviousAndNextNodeModelInOriginalView(n,i.data.attributes.pinned);if(r)r.previous?(l=r.previous,s="after"):r.next&&(l=r.next);else if("left"===i.data.attributes.pinned||"unpinned"===i.data.attributes.pinned)if(l=t._getLastNodeModelWithPinnedState(o,"left"),l)s="after";else if(l=t._getFirstNodeModelWithPinnedState(o,"unpinned"),l)s="before";else{if(l=t._getFirstNodeModelWithPinnedState(o,"right"),!l)return;s="before"}else if("right"===i.data.attributes.pinned)if(l=t._getFirstNodeModelWithPinnedState(o,"right"),l)s="before";else if(l=t._getLastNodeModelWithPinnedState(o,"unpinned"),l)s="after";else{if(l=t._getLastNodeModelWithPinnedState(o,"left"),!l)return;s="after"}t._insertNodeModelNextTo(o,n,l,s),t._mergeChildren(o._getTrueRoot()),o.setUseChangeTransactionMode(!0),o.pushUpdate(),t._attributesDataGridView.ensureNodeModelVisible(n,!0,!1,void 0,!0),n.processDescendants({onlyVisibleNodes:!0,processNode:function(e){t._attributesDataGridView.flashEffectOnNodeModel("ui-modified",e.nodeModel)}})}else if(i.data&&i.data.attributes&&void 0!==i.data.attributes.visibleFlag){let l=t._attributesDataGridView.layout,s=l.getColumnIndex("visibleFlag"),r={updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1};if(n.hasChildren()){n.processDescendants({treeTraversalOrder:"postOrder",processNode:function(t){let n=t.nodeModel.getAttributeValue("dataIndex");e.getColumnAlwaysVisibleFlag(n)||t.nodeModel.setAttribute("visibleFlag",i.data.attributes.visibleFlag)}});let o=l.getCellIDFromCoordinates({rowID:n._getRowID(),columnID:s});t._attributesDataGridView.updateCellView(o,r)}let a=o._getTrueRoot(),u=n.getParent();for(;u&&u!==a;){let e=l.getCellIDFromCoordinates({rowID:u._getRowID(),columnID:s});t._attributesDataGridView.updateCellView(e,r),u=u.getParent()}}t._updateButtonsState(),t._inNodeModelUpdate=!1}})),this._treeDocuments.push(i)},_getPreviousAndNextNodeModelInOriginalView:function(e,t){let i=new n;this._generateTreeDocumentFromCustomView(i,{});let o=this._getNodeModelFromDataIndex(i,e.getAttributeValue("dataIndex")),l=o.getAttributeValue("pinned")||"unpinned";if(o&&l===t){let e,n,l=o;for(;l;){let i,n,o=l.getPreviousNode();if(!o)break;if(i=o.getAttributeValue("dataIndex"),n=o.getAttributeValue("pinned")||"unpinned",!i||n!==t)break;if(e=this._getNodeModelFromDataIndex(this._attributesDataGridView.getTreeDocument(),i),!e)break;if((e.getAttributeValue("pinned")||"unpinned")===t)break;l=o}for(l=o;l;){let e,i,o=l.getNextNode();if(!o)break;if(e=o.getAttributeValue("dataIndex"),i=o.getAttributeValue("pinned")||"unpinned",!e||i!==t)break;if(n=this._getNodeModelFromDataIndex(this._attributesDataGridView.getTreeDocument(),e),!n)break;if((n.getAttributeValue("pinned")||"unpinned")===t)break;l=o}return i.destroy(),!(!e&&!n)&&{previous:e,next:n}}return i.destroy(),!1},_clearCustomView:function(e){if(e)for(let t in e)e.hasOwnProperty(t)&&"identifier"!==t&&"label"!==t&&"readOnly"!==t&&"readOnlyWarningMessage"!==t&&delete e[t]},_setCustomViewPropertyValue:function(e,t,i,n){e&&(e[t]||(e[t]={}),e[t][i]=n)},getCurrentEditedCustomViewIndex:function(){return this._editedCustomViews.indexOf(this._selectedCustomView)},getEditedCustomView:function(e){let t;if("string"!=typeof e)return this._editedCustomViews[e];for(let i=0;i<this._editedCustomViews.length;i++){let n=this._editedCustomViews[i];if(n&&n.identifier===e){t=n;break}}return t},getCustomViewFromLabel:function(e){let t,i=e;"object"==typeof e&&(i=e.label);for(let e=0;e<this._editedCustomViews.length;e++){let n=this._editedCustomViews[e];if(n&&w(n)===i){t=n;break}}return t},_addEditedCustomView:function(e){const t=this._editedCustomViews.reduce(((e,t,i)=>(e[t.identifier]=i,e)),{}),i=e=>{void 0===t[e.identifier]&&this._editedCustomViews.push(e)};if(Array.isArray(e))for(const t of e)i(t);else i(e)},createNewCustomView:function(e){let t=1,i=f+t,n=this.getEditedCustomView(i);for(;n;)t++,i=f+t,n=this.getEditedCustomView(i);let o=m.get("CustomViewDefaultName"),l=1,s=o+" "+l;for(n=this.getCustomViewFromLabel(s);n;)l++,s=o+" "+l,n=this.getCustomViewFromLabel(s);let r={identifier:f+t,label:o+" "+l};if(e){let t=["identifier","readOnly","label","readOnlyWarningMessage"];for(let i in e)e.hasOwnProperty(i)&&-1===t.indexOf(i)&&(r[i]=JSON.parse(JSON.stringify(e[i])))}this._addEditedCustomView(r),this._createNewTreeDocument();let a=this._getCustomViewIndex(r.identifier);return this.loadCustomView(a),this._updateModelFromCustomViews(),r},renameCurrentCustomView:function(){this._selectedCustomView&&this.elements._toolbar&&(this.elements._toolbar.updateNodeModel("ViewLabel",{visibleFlag:!1}),this.elements._toolbar.updateNodeModel("EditLabel",{grid:{data:w(this._selectedCustomView)}}),this.elements._toolbar.updateNodeModel("EditLabel",{visibleFlag:!0}),this.elements._toolbar.giveFocusTo("EditLabel"))},deleteCustomView:function(e){let t=this.getEditedCustomView(e);this._editedCustomViews.splice(e,1),this._treeDocuments.splice(e,1),this._selectedCustomView===t&&(this._selectedCustomView=this._editedCustomViews.length>0?this._editedCustomViews[0]:null,this.loadCustomView(0,!0)),this._updateModelFromCustomViews()},saveCustomViews:function(t){if(!this.customViewsManager)return;let i=this.getCurrentEditedCustomViewIndex();this.dataGridView&&this.dataGridView.prepareUpdateView();for(let e=0;e<this._editedCustomViews.length;e++)this.saveCustomView(e,e===i&&t);let n=e.clone(this._editedCustomViews),o=n[this.getCurrentEditedCustomViewIndex()].identifier;if(this.customViewsManager.setCustomViews(n,o,t,!0),this.dataGridView){let e={};if((!this.dataGridView||this.dataGridView.rowGroupingEnabledFlag)&&this._groupingSelectionChips&&t){let t=this._groupingSelectionChips.getAllChipsOptions().map((function(e){return e.value}));this.dataGridView.getGroupingOptions()&&this.dataGridView.getGroupingOptions().dataIndexesToGroup.equals(t)||(e={updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0},this.dataGridView.groupRows({dataIndexesToGroup:t}))}this.dataGridView.pushUpdateView(e)}this._updateButtonsState()},saveCustomView:function(e,t){if(!this.customViewsManager)return;let i=this.customViewsManager.getColumnModel(),n=this._editedCustomViews[e];if(n&&i){let o=this.dataGridView?this.dataGridView.layout:null;t&&o&&o.deleteDataGridViewPreferences();let l=n.layoutDensity||this.customViewsManager.getOriginalLayoutDensity(),s=n.columnsSortModel,r=n.groupingOptions,a={},u=this._treeDocuments[e];if(u){let e=u.getChildren();e&&0!==e.length||this._generateTreeDocumentFromCustomView(u,n),this._clearCustomView(n);let t=0,o=this;u.processDescendants({processNode:function(e){if(e.nodeModel&&!e.nodeModel.hasChildren()){let l=e.nodeModel.getAttributeValue("dataIndex"),s=e.nodeModel.getAttributeValue("visibleFlag");s!==i.getOriginalColumnOptionValue(l,"visibleFlag")&&o._setCustomViewPropertyValue(n,"columnsVisibleFlag",l,s);let r=e.nodeModel.getAttributeValue("width");void 0===r&&(r="auto"),r!==i.getOriginalColumnOptionValue(l,"width")&&o._setCustomViewPropertyValue(n,"columnsWidth",l,r);let u=e.nodeModel.getAttributeValue("pinned");u!==i.getOriginalColumnOptionValue(l,"pinned")&&(o._setCustomViewPropertyValue(n,"columnsPinnedState",l,u),o._saveColumnOrderInCustomView(l,u,t,n));let d=(i?i.getOriginalOrderedColumnsReverseIndexes():[])[i.getColumnIndex(l)];t!==d&&a[t]!==d&&(a[d]=t,o._saveColumnOrderInCustomView(l,u,t,n)),t++}}})}if(this._groupingSelectionChips){let t=this._customViewsGroupingOptions[e]||r;void 0!==t&&Array.isArray(t.dataIndexesToGroup)&&t.dataIndexesToGroup.length>0&&(n.groupingOptions=t)}let d=(this.dataGridView&&this.dataGridView._rowModel?this.dataGridView._rowModel._originalSortModel:this.customViewsManager.getSortModel())||[],c=this._customViewsSortModels[e]||s;Array.isArray(d)&&Array.isArray(c)&&JSON.stringify(d)!==JSON.stringify(c)&&(n.columnsSortModel=c);let h=this._layoutDensities[e]||l;h!==this.customViewsManager.getOriginalLayoutDensity()&&(n.layoutDensity=h)}},_getTreeDocumentFromCustomView:function(e){let t=null,i=this._editedCustomViews.indexOf(e);return i>=0&&(t=this._treeDocuments[i]),t},_getFirstNodeModelWithPinnedState:function(e,t){let i=null;return e.processDescendants({processNode:function(e){if(i)return{stopProcessing:!0};if(e.nodeModel&&!e.nodeModel.hasChildren()){if(e.nodeModel.getAttributeValue("pinned")===t)return i=e.nodeModel,{stopProcessing:!0}}}}),i},_getLastNodeModelWithPinnedState:function(e,t){let i=null;return e.processDescendants({processNode:function(e){if(e.nodeModel&&!e.nodeModel.hasChildren()){let n=e.nodeModel.getAttributeValue("pinned");if(n===t)i=e.nodeModel;else if("left"===t||"unpinned"===t&&"right"===n)return{stopProcessing:!0}}}}),i},_getFirstOrLastUnpinnedColumnIndex:function(e,t){let i=0,n=0;return e.processDescendants({processNode:function(e){if(e.nodeModel&&!e.nodeModel.hasChildren()){let t=e.nodeModel.getAttributeValue("pinned");"left"===t?n++:"right"===t?0:i++}}}),"undefined"===t||"left"===t?n:"right"===t?n+i-1:-1},_getNumberOfColumnsToTheLeft:function(e){return{left:0,unpinned:this._getFirstOrLastUnpinnedColumnIndex(e,"left"),right:this._getFirstOrLastUnpinnedColumnIndex(e,"right")+1}},_getTopNonSplittableGroupNodeModel:function(e){let t,i=e;for(;i;){let e=this._getColumnOrGroupFromNodeModel(i);e&&!1===e.splittableFlag&&(t=i),i=i.getParent()}return t},_saveColumnOrderInCustomView:function(e,t,i,n){let o=this._getTreeDocumentFromCustomView(n);if(o){let l="unpinned"===t?"unpinnedColumnsOrder":"pinnedColumnsOrder",s=this._getNumberOfColumnsToTheLeft(o);this._setCustomViewPropertyValue(n,l,e,i-s[t])}},_getAllPossibleCustomViews:function(){let e=[];for(let t=0;t<this._editedCustomViews.length;t++)e.push({value:this._editedCustomViews[t].identifier,label:w(this._editedCustomViews[t]),icon:this._editedCustomViews[t].readOnly?{iconName:"lock-user",fontIconFamily:WUXManagedFontIcons.Font3DS}:void 0});return e},_updateModelFromCustomViews:function(){let e=this._getAllPossibleCustomViews();this.elements._toolbar.updateNodeModel("ViewLabel",{possibleValues:e,grid:{data:this._selectedCustomView.identifier}});let t=this.getCurrentEditedCustomViewIndex();this.elements._toolbar.updateNodeModel("RenameView",{disabled:!(0!==t&&!this._selectedCustomView.readOnly)}),this.elements._toolbar.updateNodeModel("DeleteView",{disabled:!(0!==t&&!this._selectedCustomView.readOnly)})},_getCustomViewIndex:function(e){if(this.elements._toolbar&&e){let t=this._getAllPossibleCustomViews();for(let i=0;i<t.length;i++)if(t[i].value===e)return i}return-1}})}));var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/DataGridView/DataGridViewBaseFilterView",["require","exports","DS/Controls/Abstract","UWA/Core","DS/Core/WebUXComponents"],(function(e,t,i,n,o){"use strict";var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{filterViewManager:{defaultValue:void 0,type:"object",readOnly:!0},filterId:{defaultValue:"",type:"string",readOnly:!0},propertyId:{defaultValue:"",type:"string",readOnly:!0},validFlag:{defaultValue:!0,type:"boolean"},filter:{defaultValue:null,type:"object"},filterViewOptions:{defaultValue:void 0,type:"object",noNeedToApplyFlag:!0}}},enumerable:!1,configurable:!0}),t.prototype.buildContentView=function(){},t.prototype.buildFilterModelFromView=function(){},t.prototype.clearFilterViewContent=function(){},t.prototype.refreshContentView=function(e){},t.prototype.focusContentView=function(){},t.prototype._preBuildView=function(e){this.elements.container=new n.Element("div"),this.elements.container.dsModel=this,this._popupContentDiv=new n.Element("div")},t.prototype._applyValidFlag=function(e){this.fire("validFlagChange")},t.prototype.getPopupContentDiv=function(){return this._popupContentDiv},t}(i);return o.addClass(l,"datagridviewbasefilterview"),l})),define("DS/DataGridView/typings/types",[],(()=>{})),define("DS/DataGridView/RowModelBase",["DS/CollectionView/ItemModelBase"],(function(e){"use strict";return e.inherit({name:"RowModelBase",_shouldUpdateCellWidth:function(e){if(!e)return!1;const t=this.collectionView,i=t.layout;return!!i.isAFitToContentColumn&&(!t._isCurrentlyCalledFromUIInteraction()&&Object.keys(e).some((e=>{if("label"===e&&(e="tree"),i.isAFitToContentColumn(e))return!0})))}})})),define("DS/DataGridView/DataGridViewContextualMenuBuilder",["DS/Utilities/Dom","DS/TreeModel/TreeNodeModel","DS/Windows/Dialog","DS/Controls/Button","DS/Tweakers/TypeRepresentationFactory","i18n!DS/DataGridView/assets/nls/translation"],(function(e,t,i,n,o,l){"use strict";var s=function(e){this._collectionView=e,this._supportedMenus=["filter","pin","sizeColumnToFit","wrapTextInColumn","firstColumnsVisibility","columnsManagement","expandCollapse","insertRow","deleteSelectedRows"]};return s.prototype.buildMenu=function(e,t){if(!this._collectionView)return console.log("A collection view is mandatory to build its contextual menu"),[];t=UWA.extend({filter:!0,pin:!0,firstColumnsVisibility:!0,columnsManagement:!0,sizeColumnToFit:!0,wrapTextInColumn:!0,expandCollapse:!1,insertRow:!1},t);var i=this,n=[];return this._supportedMenus.forEach((function(o){if(!0===t[o]){var l="_create"+(o.substring(0,1).toUpperCase()+o.substring(1,o.length))+"ContextualMenu";if(i[l]instanceof Function){var s=i[l](e);s.length>0&&n.length>0&&n.push({type:"SeparatorItem",title:""}),n=n.concat(s)}}})),n},s.prototype.showCustomViewsDialog=function(){this._collectionView.showCustomViewsDialog()},s.prototype._createFilterContextualMenu=function(e){var t=[];if(this._collectionView&&e.cellInfos&&-1===e.cellInfos.rowID&&e.cellInfos.columnID>-1){var i=this._collectionView.layout.getDataIndexFromColumnIndex(e.cellInfos.columnID),n=this._collectionView.getFilterViewManager();if(n){var o=n.filterManager;if(o){var s="tree"===i?"label":i;let a=o.getFilters(),u=a[s];if(u){var r=n.getFilterPopups()[s];if(r){let i={type:"PushItem",title:l.get("ContextualMenuBuilder").FilterColumn,icon:{iconName:"filter",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{context:{cellInfos:e.cellInfos},callback:function(e){r.showPopup()}}},n=this._collectionView.filterOptions?this._collectionView.filterOptions.maxAppliedFilterCount:void 0,o=u.canBeReset();if("number"==typeof n&&!o){let e=0;Object.keys(a).forEach((t=>{a[t].canBeReset()&&++e})),e>=n&&(i.state="disabled",i.tooltip=l.ContextualMenuBuilder.MaxFilterColumn)}t.push(i),o&&t.push({type:"PushItem",title:l.get("ContextualMenuBuilder").ResetColumnFilter,icon:{iconName:"filter-delete",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{context:{cellInfos:e.cellInfos},callback:function(e){e&&e.context&&e.context.cellInfos&&u.reset()}}})}}}}}return t},s.prototype._createPinContextualMenu=function(e){var t=this,i=[];if(e.cellInfos&&e.cellInfos.rowID<=-1&&e.cellInfos.columnID>-1){var n,o;-1===e.cellInfos.rowID?n=this._collectionView.layout.getColumnPinned(e.cellInfos.columnID):(o=t._collectionView.layout.getColumnOrGroupFromCoordinates({rowID:e.cellInfos.rowID,columnID:e.cellInfos.columnID}),n=this._collectionView.layout.getColumnOrGroupPinned(o));var s=[];s.push({type:"RadioItem",title:l.get("ContextualMenuBuilder").PinLeft,state:"left"===n?"selected":"unselected",action:{callback:function(i){o?t._collectionView.layout.setColumnOrGroupPinned(o,"left",{isUserInteraction:!0}):t._collectionView.layout.setColumnPinned(e.cellInfos.columnID,"left",{isUserInteraction:!0})}}}),s.push({type:"RadioItem",title:l.get("ContextualMenuBuilder").PinRight,state:"right"===n?"selected":"unselected",action:{callback:function(i){o?t._collectionView.layout.setColumnOrGroupPinned(o,"right",{isUserInteraction:!0}):t._collectionView.layout.setColumnPinned(e.cellInfos.columnID,"right",{isUserInteraction:!0})}}}),s.push({type:"RadioItem",title:l.get("ContextualMenuBuilder").NoPin,state:"left"!==n&&"right"!==n?"selected":"unselected",action:{callback:function(i){o?t._collectionView.layout.setColumnOrGroupPinned(o,"unpinned",{isUserInteraction:!0}):t._collectionView.layout.setColumnPinned(e.cellInfos.columnID,"unpinned",{isUserInteraction:!0})}}}),i.push({type:"PushItem",title:l.get("ContextualMenuBuilder").PinMenu,icon:{iconName:"pin",fontIconFamily:WUXManagedFontIcons.Font3DS},submenu:s})}return i},s.prototype._createFirstColumnsVisibilityContextualMenu=function(t){var i=[],n=t.cellInfos&&-1===t.cellInfos.rowID;if(!n&&t.infos&&t.infos.target&&(n=e.firstParentWithClass(t.infos.target,"wux-layouts-header")),n)for(var o=void 0,l=this._collectionView.layout,s=l.getLeafColumns(),r=l.getOrderedColumnsIndexes(),a=0;a<s.length&&a<8;a++){o=s[r[a]];var u=l.getColumnVisibleFlag(o.dataIndex)?"selected":"unselected";i.push({type:"CheckItem",title:o.text,icon:o.icon,state:l.getColumnAlwaysVisibleFlag(o.dataIndex)?"disabled|"+u:u,action:{callback:function(e){if(e&&e.context&&e.context.id){var t=l.getColumnVisibleFlag(e.context.id);l.setColumnVisibleFlag(e.context.id,!t,{isUserInteraction:!0})}},context:{id:o.dataIndex}}})}return i},s.prototype._createColumnsManagementContextualMenu=function(t){var i=this,n=[],o=t.cellInfos&&-1===t.cellInfos.rowID;return!o&&t.infos&&t.infos.target&&(o=e.firstParentWithClass(t.infos.target,"wux-layouts-header")),o&&n.push({type:"PushItem",title:l.get("ContextualMenuBuilder").CustomViews,action:{callback:function(e){i.showCustomViewsDialog()}}}),n},s.prototype._createSizeColumnToFitContextualMenu=function(t){var i=[],n=t.cellInfos&&-1===t.cellInfos.rowID;return!n&&t.infos&&t.infos.target&&(n=e.firstParentWithClass(t.infos.target,"wux-layouts-header")),n&&t.cellInfos&&(i.push({type:"PushItem",title:t.cellInfos.rowID<-1?l.get("ContextualMenuBuilder").SizeGroupToFit:l.get("ContextualMenuBuilder").SizeToFit,icon:{iconName:"table-column-size",fontIconFamily:WUXManagedFontIcons.Font3DS},state:!1===this._collectionView.layout.getColumnResizableFlag(t.cellInfos.columnID)?"disabled":"",action:{context:{cellInfos:t.cellInfos},callback:function(e){if(e&&e.context&&e.context.cellInfos){var t=e.context.cellInfos.manager,i=(t.layout,e.context.cellInfos.columnID),n=e.context.cellInfos.rowID;t&&i>=0&&t.sizeColumnOrGroupToFit(i,n,{isUserInteraction:!0,computeColumnHeader:!0})}}}}),i.push({type:"PushItem",title:l.get("ContextualMenuBuilder").SizeAllToFit,icon:{iconName:"table-column-size-all",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{context:{cellInfos:t.cellInfos},callback:function(e){e&&e.context&&e.context.cellInfos&&e.context.cellInfos.manager.sizeAllColumnsToFit({isUserInteraction:!0,computeColumnHeader:!0})}}})),i},s.prototype._createWrapTextInColumnContextualMenu=function(t){let o=[],s=t.cellInfos&&-1===t.cellInfos.rowID;if(!s&&t.infos&&t.infos.target&&(s=e.firstParentWithClass(t.infos.target,"wux-layouts-header")),s&&t.cellInfos){let e=this._collectionView.layout.getColumnOrGroup(t.cellInfos.columnID);if(e&&e.wrappableFlag){let s=!0===e.useWrappedView?"selected":"unselected";o.push({type:"CheckItem",title:l.get("ContextualMenuBuilder").WrapTextInColumn,icon:{iconName:"text-wrap",fontIconFamily:WUXManagedFontIcons.Font3DS},state:s,action:{context:{cellInfos:t.cellInfos},callback:function(t){let o=t.context.cellInfos.manager,s=t.context.cellInfos.columnID,r=o.layout;if(!0===e.useWrappedView)r.setColumnWrap(s,"no-wrap");else{let t="wrapTextInColumnConfirmationDialog",a=o.identifier?o.identifier+"_"+t:t;if(i.getCheckBoxInfoStateInPreferences(a))r.setColumnWrap(s,"wrap");else{let t=document.createElement("div");t.style.whiteSpace="pre-wrap",t.textContent=l.get("ContextualMenuBuilder").WrapTextDialogContent;let u=new i({identifier:a,immersiveFrame:o.getContainingImmersiveFrame(),modalFlag:!0,title:l.get("ContextualMenuBuilder").WrapTextDialogTitle+" - "+e.text,content:t,resizableFlag:!1,position:{my:"center",at:"center",of:o.getContainingImmersiveFrame()},buttons:{No:new n({onClick:function(e){u.close()}}),Yes:new n({onClick:function(e){u.close(),r.setColumnWrap(s,"wrap")}})},checkboxInfos:{label:l.get("ContextualMenuBuilder").WrapTextDialogCheckBoxLabel,checkFlag:!1,saveCheckStateInPreferences:!0}})}}}}})}}return o},s.prototype._createExpandCollapseContextualMenu=function(e){var t=[];return e.cellInfos&&e.cellInfos.columnID===e.collectionView.layout.getColumnIndex("tree")&&e.cellInfos.rowID>-1&&(e.cellInfos.nodeModel.canBeExpanded()&&(e.cellInfos.nodeModel.isExpanded()?t.push({type:"PushItem",title:l.get("Collapse"),action:{callback:function(t){e.cellInfos.nodeModel.collapse()}}}):t.push({type:"PushItem",title:l.get("Expand"),action:{callback:function(t){e.cellInfos.nodeModel.expand()}}})),e.cellInfos.nodeModel.canBeExpandedAll()&&(t.push({type:"PushItem",title:l.get("ExpandAll"),action:{callback:function(t){e.cellInfos.nodeModel.expandAll()}}}),t.push({type:"PushItem",title:l.get("CollapseAll"),action:{callback:function(t){e.cellInfos.nodeModel.collapseAll()}}}))),t},s.prototype._createInsertRowContextualMenu=function(e){var i=[];if(!e.cellInfos||e.cellInfos.rowID<=-1)return i;var n=function(i,n){if(i&&i.context&&i.context.cellInfos){var o=i.context.cellInfos.manager,l=o.getTreeDocument();l.prepareUpdate();var s=new t,r=i.context.cellInfos.nodeModel._getLocalID();i.context.cellInfos.nodeModel.getParent().addChild(s,"before"===n?r:r+1),l.pushUpdate(WUXModelUpdateTypes.Addition);var a=s._getRowID();o.insertRowCallback(s,a,e.cellInfos),o.ensureNodeModelVisible(s,!0),o.flashEffectOnNodeModel("ui-modified",s)}};return i.push({type:"PushItem",title:l.get("ContextualMenuBuilder").InsertRowBefore,action:{context:{cellInfos:e.cellInfos},callback:function(e){n(e,"before")}}}),i.push({type:"PushItem",title:l.get("ContextualMenuBuilder").InsertRowAfter,action:{context:{cellInfos:e.cellInfos},callback:function(e){n(e,"after")}}}),i},s.prototype._createDeleteSelectedRowsContextualMenu=function(e){var t=[];return!e.cellInfos||e.cellInfos.rowID<=-1?t:e.collectionView&&e.collectionView.getNodesXSO()&&!e.collectionView.getNodesXSO().isEmpty()?(t.push({type:"PushItem",title:l.get("ContextualMenuBuilder").DeleteSelectedRows,action:{context:{cellInfos:e.cellInfos},callback:function(e){e&&e.context&&e.context.cellInfos&&e.context.cellInfos.manager._askForDeletion()}}}),t):t},s})),define("DS/DataGridView/ModelMassUpdateDialog",["UWA/Core","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ButtonGroup","i18n!DS/DataGridView/assets/nls/translation"],(function(e,t,i,n,o,l,s,r){"use strict";return t.inherit({name:"ModelMassUpdateDialog",publishedProperties:{treeDocument:{defaultValue:null,type:"object"},attributes:{defaultValue:[],type:"array"},setNodeModelValueFunction:{defaultValue:null,type:"function"}},destroy:function(){this._dataGridView&&(this._dataGridView.destroy(),this._dataGridView=null),this._parent()},_postBuildView:function(){this._parent();var t=e.createElement("div",{class:"wux-model-mass-update-maindiv"}),i=e.createElement("div",{class:"wux-model-mass-update-description"});e.createElement("div",{html:r.get("ModelMassUpdate").Description,class:"wux-model-mass-update-description-label"}).inject(i),this._selectionButtonGroup=new s({type:"radio"}),this._selectionButtonGroup.getContent().addClassName("wux-model-mass-update-target"),this._selectionButtonGroup.addChild(new l({type:"radio",label:r.get("ModelMassUpdate").ApplyToSelected,value:0})),this._selectionButtonGroup.addChild(new l({type:"radio",label:r.get("ModelMassUpdate").ApplyToAll,value:1})),this._selectAttributes(),this._selectionButtonGroup.inject(i),i.inject(t),this._selectionButtonGroup.addEventListener("change",(e=>{this._updateButtonsDisableState()}));var n=require("DS/DataGridView/DataGridView");this._dataGridView=new n({identifier:this.identifier+"_DataGridView",height:"auto",treeDocument:null,columns:[{text:"Name",dataIndex:"tree",typeRepresentation:"string",alignment:"far",width:"250",minWidth:"50",alwaysVisibleFlag:!0,editableFlag:!1},{text:"Value",dataIndex:"value",getCellTypeRepresentation:function(e){return e.nodeModel?e.nodeModel.getAttributeValue("typeRepresentation"):"string"},getCellSemantics:function(e){if(e.nodeModel)return e.nodeModel.getAttributeValue("semantics")},resizableFlag:!1,width:"auto",minWidth:"100",alwaysVisibleFlag:!0,editableFlag:!0,editionPolicy:"EditionInPlace"}],cellSelection:"none",selectionBehavior:{selectNodeModelOnCellSelection:!1},focusNextEditableCellOnTabFlag:!0,showBackgroundFlag:!1,cellActivationFeedback:"none",cellPreselectionFeedback:"none",columnDragEnabledFlag:!1,showAlternateBackgroundFlag:!1,showRowIndexFlag:!1,showSelectionCheckBoxesFlag:!0,showRowHeaderBackgroundFlag:!1,defaultColumnDef:{minWidth:30,sortableFlag:!1}}),this._dataGridView.layout.columnsHeader=!1,this._dataGridView.layout.rowSpacing=6,this._applyAttributes(),this._dataGridView.addEventListener("liveChange",((e,t)=>{var i=this._dataGridView.model[t.rowID];i&&i.select()})),this._dataGridView.addEventListener("change",((e,t)=>{if(t.columnID===this._dataGridView.layout.getColumnIndex("value")){var i=this._dataGridView.model[t.rowID];i&&i.select()}})),this._dataGridView.inject(t),this.content=t,this.title=r.get("ModelMassUpdate").Title,this.buttons={Ok:new o({onClick:e=>{this.applyAttributesValues(),this.visibleFlag=!1}}),Apply:new o({onClick:e=>{this.applyAttributesValues()}}),Close:new o({onClick:e=>{this.visibleFlag=!1}})},this.addEventListener("close",(e=>{this.visibleFlag=!1}))},_applyProperties:function(e){this._parent(e),this.isDirty("treeDocument")&&this._applyTreeDocument(e.treeDocument),this.isDirty("attributes")&&this._applyAttributes(e.attributes)},_applyTreeDocument:function(e){if(this.treeDocument){var t=this.treeDocument.getXSO();if(t){var i=this;t.onPostAdd((function(e){i._updateButtonsDisableState()})),t.onPostRemove((function(e){i._updateButtonsDisableState()}))}}},_applyAttributes:function(e){if(this._dataGridView){var t=new i,o=this.attributes;if(o)for(var l=0;l<o.length;l++){var s=o[l],r=s.label?s.label:s.name,a=this._getDefaultValue(s.typeRepresentation,s.semantics);t.addRoot(new n({label:r,grid:{name:s.name,typeRepresentation:s.typeRepresentation,semantics:s.semantics,value:a}}))}this._dataGridView.treeDocument=t;var u=this.buttons.Ok;u&&(u.disabled=!0);var d=this.buttons.Apply;d&&(d.disabled=!0);var c=t.getXSO();c&&(c.onPostAdd((e=>{this._updateButtonsDisableState()})),c.onPostRemove((e=>{this._updateButtonsDisableState()})));var h=this._dataGridView.addEventListener("allCellsRendered",(()=>{this._dataGridView.removeEventListener("allCellsRendered",h),this._dataGridView.sizeColumnToFit("tree",{isUserInteraction:!1,computeAllRows:!0})}))}},_applyVisibleFlag:function(){this._selectAttributes(),this._parent()},_getDefaultValue:function(e,t){var i=void 0;if(this._dataGridView){var n,o,l=this._dataGridView.getTypeRepresentationFactory(),s=l.getRegisteredTypeRepresentation(e);s&&s.semantics&&s.semantics.possibleValues?(n=s.semantics.possibleValues,o=s.semantics.valueType):n=l.getRegisteredEnum(e),!n&&t&&(n=t.possibleValues,o=t.valueType),n&&(i=Array.isArray(n)?n[0].value||n[0]:"enumValueToProperty"===o?Object.keys(n)[0]:n[Object.keys(n)[0]])}return i},_selectAttributes:function(){this._selectionButtonGroup&&(this.treeDocument&&!this.treeDocument.getXSO().isEmpty()?this._selectionButtonGroup.value=0:this._selectionButtonGroup.value=1)},resetAttributesValues:function(){if(this._dataGridView){for(var e=0;e<this._dataGridView.model.length;e++){var t=this._dataGridView.model[e];if(t){var i=t.getAttributeValue("typeRepresentation"),n=this._getDefaultValue(i,t.getAttributeValue("semantics"));t.setAttribute("value",n)}}this._dataGridView.unselectAll()}},_applyAttributesValues:function(e,t){if(e&&t)if(this.setNodeModelValueFunction)for(let i=0;i<t.length;i++){let n=t[i];if(n){let t=n.getAttributeValue("name"),i=n.getAttributeValue("value");this.setNodeModelValueFunction(e,t,i)}}else{var i={grid:{}};for(let e=0;e<t.length;e++){let n=t[e];if(n){let e=n.getAttributeValue("name"),t=n.getAttributeValue("value");i.grid[e]=t}}e.updateOptions(i)}},applyAttributesValues:function(){if(this._dataGridView&&this.treeDocument){var e=1===this._selectionButtonGroup.value[0],t=this._dataGridView.getNodesXSO().get();if(t.length>0){var i=this;this.treeDocument.prepareUpdate(),e?this.treeDocument.processDescendants({onlyVisibleNodes:!0,processNode:function(e){i._applyAttributesValues(e.nodeModel,t)}}):this.treeDocument.processSelectedNodes({processNode:function(e){i._applyAttributesValues(e.nodeModel,t)}}),this.treeDocument.pushUpdate({updateType:WUXModelUpdateTypes.AttributesChange})}}},_updateButtonsDisableState:function(){var e=!0;if(this.treeDocument&&this._dataGridView&&this._dataGridView.treeDocument){var t=this.treeDocument.getXSO(),i=this._dataGridView.treeDocument.getXSO();if(t&&i)e=1===this._selectionButtonGroup.value[0]?i.isEmpty():t.isEmpty()||i.isEmpty()}var n=this.buttons.Ok;n&&(n.disabled=e);var o=this.buttons.Apply;o&&(o.disabled=e)}})}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/DataGridView/DataGridViewCell",["require","exports","DS/CollectionView/CollectionViewCell","UWA/Core","DS/Core/WebUXComponents","DS/Utilities/Utils"],(function(e,t,i,n,o,l){"use strict";var s=function(e){function t(t){var i=e.call(this,t)||this;return i.blackBoxFlag=!0,i}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{showKPIColorFlag:{defaultValue:!1,type:"boolean"},KPIColor:{defaultValue:void 0,type:"string"}}},enumerable:!1,configurable:!0}),t.prototype._applyShowKPIColorFlag=function(e){this._updateKPIColor()},t.prototype._applyKPIColor=function(e){this._updateKPIColor()},t.prototype._updateKPIColor=function(){this.showKPIColorFlag?(this.elements.KPIColorDiv?this.elements.KPIColorDiv.show():this.elements.KPIColorDiv=new n.Element("div",{class:"wux-layouts-datagridview-kpi-color"}),void 0!==this.KPIColor?(this.elements.KPIColorDiv.style.background=this.KPIColor,this.elements.KPIColorDiv.style.outlineColor=this.KPIColor,this.elements.KPIColorDiv.style.visibility=""):this.elements.KPIColorDiv.style.visibility="hidden",this.elements.KPIColorDiv.parentNode||this.elements.KPIColorDiv.inject(this.elements.container,"top")):this.elements.KPIColorDiv&&this.elements.KPIColorDiv.hide()},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("showKPIColorFlag")&&this._applyShowKPIColorFlag(t.showKPIColorFlag),this.isDirty("KPIColor")&&this._applyKPIColor(this.KPIColor)},t.prototype.getInitialClassName=function(){return e.prototype.getInitialClassName.call(this)+" wux-layouts-datagridview-cell"},t.prototype.getCleaningMode=function(){return 1},t.prototype.isRow=function(){return!1},t.prototype.getPrintableContent=function(){var e=this.getReusableContent();if(e){if(l.isUWAAbstract(e))return e.getContent().outerHTML;if(e instanceof HTMLElement)return e.outerHTML}},t}(i);return o.addClass(s,"DataGridViewCell"),s}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/DataGridView/DataGridViewPaginationManager",["require","exports","DS/CollectionView/CollectionViewPaginationManager","DS/Core/WebUXComponents"],(function(e,t,i,n){"use strict";var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{nodeDepth:{defaultValue:0,type:"integer"}}},enumerable:!1,configurable:!0}),t.prototype._applyNodeDepth=function(){this.updatePagination()},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("pageSize")||this.isDirty("currentPage")||!this.isDirty("nodeDepth")||this.updatePagination()},t.prototype.getPageNumber=function(){if(this._collectionView){var e=this._collectionView.getRowModelLength(this.nodeDepth);if(e)return Math.ceil(e/this.pageSize);if(0===e)return 1}},t.prototype.getNumberOfItemsOnPage=function(e){void 0===e&&(e=this.currentPage);var t=this._collectionView.getRowModelLength(this.nodeDepth),i=Math.max(Math.ceil(t/this.pageSize),1);return e>i||e<0?void 0:e===i?t-(i-1)*this.pageSize:this.pageSize},t}(i);return n.addClass(o,"dataGridViewPaginationManager"),o})),define("DS/DataGridView/DataGridViewServerSideBridge",["DS/CollectionView/CollectionViewServerSideBridge"],(function(e){"use strict";return class extends e{constructor(e,t,i,n,o){super(e,t,i,n,o)}answerToAServerRequest(e,t){if("WIN_getColumnsData"!==e&&"WIN_setColumnsData"!==e)return void super.answerToAServerRequest(e,t);let i;switch(e){case"WIN_getColumnsData":i=this.collectionView.columns;break;case"WIN_setColumnsData":this.collectionView?this.collectionView.columns=t:i={error:"No DataGridView"}}this._answer(e,t,i)}getType(){return"DataGridViewServerSideBridge"}}})),define("DS/DataGridView/ColumnModel",["require","exports","DS/Core/WebUXComponents","DS/Utilities/TreeUtils","DS/Utilities/Array","DS/Utilities/Utils","UWA/Core","DS/DataGridView/typings/types"],(function(e,t,i,n,o,l,s){"use strict";var r=function(){function e(){this._columns=[],this._leafColumns=[],this._originalLeafColumns=[],this._balancedColumnTree=[],this._columnItemsByDepth=[],this._orderedColumnsIndexes=[],this._originalOrderedColumnsIndexes=[],this._orderedColumnsReverseIndexes=[],this._originalOrderedColumnsReverseIndexes=[],this._autoRowHeightColumnIndexes=[],this._autoHeaderHeightColumnIndexes=[],this._hasAutoWidthColumnWithAutoRowHeightFlag=!1,this._fitAllContentIndexes=[],this._fitVisibleContentIndexes=[],this._columnTreeItemCount=0}return e.prototype.setDefaultColumnDef=function(e){if(e){var t={showTextFlag:!0,description:"",typeRepresentation:"string",getCellTypeRepresentation:function(e){var t=this.layout;return t?t.getColumnTypeRepresentation(e.columnID):"string"},width:"auto",minWidth:40,autoRowHeightFlag:!1,visibleFlag:!0,alwaysVisibleFlag:!1,editableFlag:!1,disabled:!1,editionPolicy:"EditionOnDoubleClick",resizableFlag:!0,selectableFlag:!0,sortableFlag:!0,findableFlag:!0,groupableFlag:!0,printableFlag:!0,massUpdateAllowedFlag:!0,pinned:"unpinned",autoSizePadding:0,allowUnsafeHTMLContent:!1,wrappableFlag:!1,useWrappedView:!1,shouldCellAllowUnsafeHTMLContentAt:function(e){var t=this.layout;return!!t&&t.getColumnAllowUnsafeHTMLContent(e.columnID)},allowResetToUndefinedByUIFlag:!1,className:"",getCellClassName:function(e){var t=this.layout;return!!(t&&e.rowID>=0)&&t.getColumnClassName(e.columnID)},getCellIcons:function(e){if(e.nodeModel&&e.nodeModel.getIcons)return e.nodeModel.getIcons()}};Object.keys(t).forEach((function(i){Object.prototype.hasOwnProperty.call(e,i)&&void 0!==e[i]||(e[i]=t[i])}))}this._defaultColumnDef=e},e.prototype.setColumns=function(e,t){var i=this._columns;this._columns=e,void 0!==t&&this.setDefaultColumnDef(t),this._balancedColumnTree=n.createBalancedTree(e),this._columnItemsByDepth=n.computeItemsByDepth(this._balancedColumnTree),this._leafColumns=[];var l=!!this._defaultColumnDef&&this._defaultColumnDef.autoRowHeightFlag;if(this._hasAutoWidthColumnWithAutoRowHeightFlag=!1,this._autoRowHeightColumnIndexes=[],this._autoHeaderHeightColumnIndexes=[],this._fitAllContentIndexes=[],this._fitVisibleContentIndexes=[],this._columnItemsByDepth&&this._columnItemsByDepth.length>0)for(var r=this._columnItemsByDepth[this._columnItemsByDepth.length-1],a=0;a<r.length;a++){var u=r[a];if(void 0!==u.dataIndex){void 0!==u.pinned&&"left"!==u.pinned&&"right"!==u.pinned&&"unpinned"!==u.pinned&&(u.pinned="unpinned"),this._leafColumns.push(u),(l||u.autoRowHeightFlag)&&(this._autoRowHeightColumnIndexes.push(a),"auto"===this.getColumnOptionValue(a,"width")&&(this._hasAutoWidthColumnWithAutoRowHeightFlag=!0));var d=u.width;"fitAllContent"===d?this._fitAllContentIndexes.push(a):"fitVisibleContent"===d&&this._fitVisibleContentIndexes.push(a),u.customHeader&&this._autoHeaderHeightColumnIndexes.push(a)}else console.warn("The leaf column at index "+a+" does not have a defined dataIndex")}if(this._columns!==i)this._originalLeafColumns=n.cloneTree(this._leafColumns);else if(this._originalLeafColumns&&this._leafColumns&&this._originalLeafColumns.length!==this._leafColumns.length){for(a=this._originalLeafColumns.length-1;a>=0;a--)-1===o.getIndexOfElement(this._leafColumns,"dataIndex",this._originalLeafColumns[a].dataIndex)&&this._originalLeafColumns.splice(a,1);for(a=0;a<this._leafColumns.length;a++)-1===o.getIndexOfElement(this._originalLeafColumns,"dataIndex",this._leafColumns[a].dataIndex)&&this._originalLeafColumns.splice(a,0,s.clone(this._leafColumns[a],!1))}this._computeOriginalOrderedColumnsIndexes(),this._createBalancedColumnTreeFromOrderedIndexes(),this._initColumnGroupsExpandedFlag()},e.prototype.getLeafColumns=function(){return this._leafColumns},e.prototype.getOriginalLeafColumns=function(){return this._originalLeafColumns},e.prototype.getBalancedColumnTree=function(){return this._balancedColumnTree},e.prototype.getOrderedColumnsIndexes=function(){return this._orderedColumnsIndexes},e.prototype.getVisibleOrderedColumnsIndexes=function(){for(var e=[],t=0;t<this._orderedColumnsIndexes.length;t++)this.getColumnVisibleState(this._orderedColumnsIndexes[t])&&e.push(this._orderedColumnsIndexes[t]);return e},e.prototype.getOriginalOrderedColumnsIndexes=function(){return this._originalOrderedColumnsIndexes},e.prototype.getOriginalOrderedColumnsReverseIndexes=function(){return this._originalOrderedColumnsReverseIndexes},e.prototype.getOrderedColumnsReverseIndexes=function(){return this._orderedColumnsReverseIndexes},e.prototype.getColumnItemsByDepth=function(){return this._columnItemsByDepth},e.prototype.getColumnTreeDepth=function(){return this._columnItemsByDepth?this._columnItemsByDepth.length:0},e.prototype.getColumnIdentifiers=function(e){var t,i;return"string"==typeof e?(i=e,t=this.getColumnIndex(e)):"object"==typeof e?"dataIndex"in e?(i=e.dataIndex,t=this.getColumnIndex(e.dataIndex)):"columnIndex"in e&&(i=this.getDataIndexFromColumnIndex(e.columnIndex),t=e.columnIndex):(i=this.getDataIndexFromColumnIndex(e),t=e),{dataIndex:i,columnIndex:t}},e.prototype.getColumnIndex=function(e){if(null!=e){var t=-1;return"string"==typeof e?(this._columnsReverseIndexes||this._computeColumnsReverseIndexes(),t=this._columnsReverseIndexes[e]):t=e,t}},e.prototype.getDataIndexFromColumnIndex=function(e){return e>=0&&e<this._leafColumns.length?this._leafColumns[e].dataIndex:"rowHeader"},e.prototype.getColumnOrGroup=function(e,t){var i="string"==typeof e?e:this.getColumnIdentifiers(e).dataIndex;return this.getColumnOrGroupInTree(this._balancedColumnTree,i,t)},e.prototype.getColumnOrGroupInTree=function(e,t,i){for(var n,o=0;o<e.length;o++){var l=e[o];if(l){if(!(l.dataIndex!==t||i&&i!==this.getColumnGroupIndexInItsRow(l))){n=l;break}if(l.children&&(n=this.getColumnOrGroupInTree(l.children,t,i)))break}}return n},e.prototype.getColumnOrGroupFromCoordinates=function(e){var t=null;if(-1===e.rowID){var i=this.getLeafColumns();i&&(t=i[e.columnID])}else{var n=this._columnItemsByDepth[this._columnItemsByDepth.length+e.rowID];n&&(t=n[e.columnID])}return t},e.prototype.getColumnOrGroupCellCoordinates=function(e){var t=-1,i=-1;if(e){var o=n.computeFirstBranchDepth(e);if(o>1){var l=this.getColumnTreeDepth(),s=this._columnItemsByDepth[l-o];if(s)for(var r=0;r<s.length;r++)if(s[r]===e){t=-o,i=r;break}}else t=-1,i=this.getColumnIndex(e.dataIndex)}return{rowID:t,columnID:i}},e.prototype.getColumnOptionValue=function(e,t){var i,n=this.getColumnIndex(e);if(n>-1){var o=this._leafColumns[n];o&&(i=o[t]),void 0===i&&this._defaultColumnDef&&(i=this._defaultColumnDef[t])}return i},e.prototype.getOriginalColumnOptionValue=function(e,t){var i,n=this.getColumnIdentifiers(e).columnIndex;if(n>-1){var o=this.getOriginalLeafColumns()[n];o&&(i=o[t]),void 0===i&&this._defaultColumnDef&&(i=this._defaultColumnDef[t])}return i},e.prototype.getColumnVisibleFlag=function(e){return this.getColumnOptionValue(e,"visibleFlag")},e.prototype.getColumnAlwaysVisibleFlag=function(e){return this.getColumnOptionValue(e,"alwaysVisibleFlag")},e.prototype.getColumnVisibleState=function(e){return this.getColumnAlwaysVisibleFlag(e)||this.getColumnVisibleFlag(e)&&this._isColumnDisplayedByHierarchy({rowID:-1,columnID:e})},e.prototype.getColumnOrGroupVisibleState=function(e){var t=!1;if(e)if(e.children)for(var i=0;i<e.children.length;i++){var n=e.children[i];if(t=this.getColumnOrGroupVisibleState(n))break}else t=this.getColumnVisibleState(e.dataIndex);return t},e.prototype.getColumnTypeRepresentation=function(e){return this.getColumnOptionValue(e,"typeRepresentation")},e.prototype.getColumnWidth=function(e){return this.getColumnOptionValue(e,"width")},e.prototype.getColumnPinned=function(e){return this.getColumnOptionValue(e,"pinned")},e.prototype.getColumnOrGroupPinned=function(e){var t;if(e)if(e.children){t=this.getColumnOrGroupPinned(e.children[0]);for(var i=1;i<e.children.length;i++)if(t!==this.getColumnOrGroupPinned(e.children[i]))return}else t=this.getColumnPinned(this.getColumnIndex(e.dataIndex));return t},e.prototype.setColumnOrGroupPinned=function(e,t,i){if(!e||!this.isGroupInBalancedTree(e))return console.warn("setColumnOrGroupPinned has been called on a column or Group that does not exist in the DataGridView"),-1;var o=0,l=this.getFirstLeafColumnIndex(e),s=this.getDataIndexFromColumnIndex(l);"right"!==t&&"left"!==t&&(t="unpinned");var r=this.getLeafColumns(),a=n.getLeafItems(e);if(r[l].pinned!==t){var u=this._getTopNonSplittableGroup(e);if(u)return this.setColumnOrGroupPinned(u,t,i);var d=this.getOrderedColumnsIndexes(),c=l;if("unpinned"===t){var h=i?i.unpinnedColumnOrderInPreferences:null;if(h&&"number"==typeof h[s]){var g=this.getNumberOfColumnsToTheLeft(),p=h[s]+g[t];"left"===r[l].pinned&&(p-=1),c=d[p]}else{var m=d[this.getOriginalOrderedColumnsReverseIndexes()[l]],f=this.getColumnPinned(m);if("unpinned"===f)c=m;else(C=this.getFirstOrLastUnpinnedColumnIndex(f,!0))>=0&&(f===r[l].pinned&&"left"===f?C-=1:f===r[l].pinned&&"right"===f&&(C+=1),c=d[C])}}else{var C;(C=this.getFirstOrLastUnpinnedColumnIndex(t,!0))>=0&&(c=d[C])}for(var w=0;w<a.length;w++)a[w].pinned=t;n.splitParentAtItemIndex(a[0],this._balancedColumnTree,"before"),n.splitParentAtItemIndex(a[a.length-1],this._balancedColumnTree,"after"),this.moveColumnOrGroup(e,c,i),i&&!1===i.mergeGroups||this._createBalancedColumnTreeFromOrderedIndexes(),o=1}return o},e.prototype.setColumnWrap=function(e,t){return!!this.getColumnOptionValue(this.getColumnOrGroupCellCoordinates(e).columnID,"wrappableFlag")&&(!(!0===e.useWrappedView&&"wrap"===t||!1===e.useWrappedView&&"no-wrap"===t)&&(!0===e.useWrappedView?e.useWrappedView=!1:e.useWrappedView=!0,!0))},e.prototype.getColumnWrap=function(e){return this.getColumnOptionValue(this.getColumnOrGroupCellCoordinates(e).columnID,"wrappableFlag")&&!0===e.useWrappedView?"wrap":"no-wrap"},e.prototype.isGroupInBalancedTree=function(e){return this.getColumnOrGroupCellCoordinates(e).columnID>=0},e.prototype.hasColumnGroups=function(){return this.getColumnTreeDepth()>1},e.prototype.hasColumnWithAutoRowHeightFlag=function(){return this._autoRowHeightColumnIndexes&&this._autoRowHeightColumnIndexes.length>0},e.prototype.getAutoRowHeightColumnIndexes=function(){return this._autoRowHeightColumnIndexes},e.prototype.getAutoHeaderHeightColumnIndexes=function(){return this._autoHeaderHeightColumnIndexes},e.prototype.getFitAllContentIndexes=function(){return this._fitAllContentIndexes},e.prototype.hasFitAllContentColumn=function(){return Boolean(this._fitAllContentIndexes.length)},e.prototype.getFitVisibleContentIndexes=function(){return this._fitVisibleContentIndexes},e.prototype.hasFitVisibleContentColumn=function(){return Boolean(this._fitVisibleContentIndexes.length)},e.prototype.hasFitContentColumn=function(){return this.hasFitAllContentColumn()||this.hasFitVisibleContentColumn()},e.prototype.hasAutoWidthColumn=function(){for(var e=!1,t=this.getLeafColumns(),i=0;i<t.length;i++){var n=this.getColumnPinned(i);if("left"!==n&&"right"!==n&&"auto"===this.getColumnWidth(i)&&this.getColumnVisibleState(i)){e=!0;break}}return e},e.prototype.hasAutoWidthColumnWithAutoRowHeightFlag=function(){return this._hasAutoWidthColumnWithAutoRowHeightFlag},e.prototype.getOrderedColumnIndexesFromChanges=function(e){var t,i=this._originalOrderedColumnsIndexes.slice(0),n=e.unpinnedColumnsOrder,o=e.pinnedColumnsOrder,s=e.columnsPinnedState;t=l.concatenateObjects(o,n);var r=[],a=[],u=[],d=this._getNumberOfColumnsToTheLeftFromChanges(e);for(var c in t){var h=void 0;if("left"===(h=s&&s.hasOwnProperty(c)?s[c]:this.getColumnPinned(c))){if(o&&void 0!==o[c]){var g=o[c];r.push({dataIndex:c,columnIndexInPref:g})}}else if("right"===h){if(o&&void 0!==o[c]){g=o[c];a.push({dataIndex:c,columnIndexInPref:g+d[h]})}}else if("unpinned"===h&&n&&void 0!==n[c]){g=n[c];u.push({dataIndex:c,columnIndexInPref:g+d[h]})}}var p=function(e,t){for(var i=0;i<e.length;i++)if(e[i]===t)return void e.splice(i,1)},m=r.concat(u).concat(a),f=[];for(var C in m)if(m.hasOwnProperty(C)&&this.getColumnIndex(m[C].dataIndex)>=0){var w=this.getColumnIndex(m[C].dataIndex);f[m[C].columnIndexInPref]=w,p(i,w)}for(var _=0;_<this._orderedColumnsIndexes.length;_++){if(f.length<_)return f.concat(i);void 0===f[_]&&i.length>0&&(f[_]=i[0],i.splice(0,1))}return f=f.filter((function(e){return void 0!==e}))},e.prototype.getColumnGroupIndexInItsRow=function(e){if(!this._columnItemsByDepth||!this._columnItemsByDepth.length)return-1;for(var t=0;t<this._columnItemsByDepth.length;t++)for(var i=this._columnItemsByDepth[t],n=0,o=0;o<i.length;o++){if(e===i[o])return n;e.dataIndex===i[o].dataIndex&&n++}return-1},e.prototype.getColumnOrGroupPositionData=function(e){for(var t=[],i=[],n=[],o=e._parent?e._parent.children.length:-1;e&&e.dataIndex;){if(e.children&&e.children.length>0){t.push(this._getDataIndexOccurrenceNumberInRow(e));var l=this.getColumnGroupIndexInItsRow(e);i.push(l),n.push(e.dataIndex)}e=e._parent}return{numberOfDataIndexOccurences:t,indexInParent:i,columnGroupDataIndexes:n,childrenCountInParent:o}},e.prototype.getColumnTreeItemCount=function(){return this._columnTreeItemCount},e.prototype.moveColumnOrGroup=function(e,t,i){if(!e)return!1;"string"==typeof t&&(t=this.getColumnIndex(t));var o=this.getLeafColumns()[t];if(!o)return!1;var l=this.getFirstLeafColumnIndex(e),s=this.getOrderedColumnsReverseIndexes(),r=s[l],a=s[t],u=i&&i.insertBeforeOrAfter?i.insertBeforeOrAfter:r<a?"after":"before";if(!this.columnMoveIsPossible(e,t,u))return!1;var d=n.getCommonParent(e,o);d||(d=this._balancedColumnTree);var c=n.extractItemHierarchy(e,d,!0);if(c){n.splitParentAtItemIndex(o,d,u);var h=n.getIndexInRootParent(o,d),g="after"===u?h+1:h;d&&d!==this._balancedColumnTree?n.addChild(d,c,g):this._balancedColumnTree.splice(g,0,c)}return this._mergeBalancedColumnTree(i?i.groupToIgnore:void 0),!0},e.prototype.columnMoveIsPossible=function(e,t,i){var o=!1;"string"==typeof t&&(t=this.getColumnIndex(t));var l=this.getLeafColumns()[t];if(l&&e){for(var s=n.getLeafItems(e),r=0;r<s.length;r++){if(s[r]===l)return!1}if("before"!==i&&"after"!==i){var a=this.getOrderedColumnsReverseIndexes();i=a[this.getFirstLeafColumnIndex(e)]<a[t]?"after":"before"}var u=n.getCommonParent(e,l);u||(u=this._balancedColumnTree);var d=n.getParents(e);for(r=d.length-1;r>=0;r--){var c=d[r];if(c===u)break;if(!1===c.splittableFlag)return!1}var h=n.getParents(l);for(r=h.length-1;r>=0;r--){var g=h[r];if(g===u)break;if(!1===g.splittableFlag&&("after"===i&&t!==this.getLastLeafColumnIndex(g)||"before"===i&&t!==this.getFirstLeafColumnIndex(g)))return!1}o=!0}return o},e.prototype.getFirstLeafColumnIndex=function(e,t){var i=-1;if(e)if(e.children){var n=null;if(t)for(var o=0;o<e.children.length;o++){var l=e.children[o];if(l&&this.getColumnOrGroupVisibleState(l)){n=l;break}}else n=e.children[0];n&&(i=this.getFirstLeafColumnIndex(n,t))}else i=this.getColumnIndex(e.dataIndex);return i},e.prototype.getLastLeafColumnIndex=function(e,t){var i=-1;if(e)if(e.children){var n=null;if(t)for(var o=e.children.length-1;o>=0;o--){var l=e.children[o];if(l&&this.getColumnOrGroupVisibleState(l)){n=l;break}}else n=e.children[e.children.length-1];n&&(i=this.getLastLeafColumnIndex(n,t))}else i=this.getColumnIndex(e.dataIndex);return i},e.prototype.getNextVisibleColumnID=function(e){var t=this.getColumnIndex(e);if(-1===t)return-1;var i=this.getOrderedColumnsReverseIndexes()[t];if(void 0===i||i===this._orderedColumnsIndexes.length-1)return-1;for(var n=i+1;n<this._orderedColumnsIndexes.length;){if(this.getColumnVisibleState(this._orderedColumnsIndexes[n]))return this._orderedColumnsIndexes[n];n+=1}return-1},e.prototype.getPreviousVisibleColumnID=function(e){if(-1===e)return-1;var t=this.getOrderedColumnsReverseIndexes()[e];if(void 0===t||0===t)return-1;for(var i=t-1;i>=0;){if(this.getColumnVisibleState(this._orderedColumnsIndexes[i]))return this._orderedColumnsIndexes[i];i-=1}return-1},e.prototype.getPreviousVisibleGroupOrColumnID=function(e,t){if(e>=-1)return this.getPreviousVisibleColumnID(t);for(var i=this.getColumnOrGroupFromCoordinates({rowID:e,columnID:t}),n=0;n<this._columnItemsByDepth.length;n++)for(var o=this._columnItemsByDepth[n],l=void 0,s=0;s<o.length;s++){if(o[s]===i)return l?this.getColumnOrGroupCellCoordinates(l).columnID:void 0;l=o[s]}},e.prototype.getNextVisibleGroupOrColumnID=function(e,t){if(e>=-1)return this.getNextVisibleColumnID(t);for(var i=this.getColumnOrGroupFromCoordinates({rowID:e,columnID:t}),n=0;n<this._columnItemsByDepth.length;n++)for(var o=this._columnItemsByDepth[n],l=void 0,s=o.length-1;s>=0;s--){if(o[s]===i)return l?this.getColumnOrGroupCellCoordinates(l).columnID:void 0;l=o[s]}},e.prototype.getFirstVisibleColumnID=function(){for(var e=0;e<this._orderedColumnsIndexes.length;){if(this.getColumnVisibleState(this._orderedColumnsIndexes[e]))return this._orderedColumnsIndexes[e];e+=1}return-1},e.prototype.getLastVisibleColumnID=function(){for(var e=this._orderedColumnsIndexes.length-1;e>=0;){if(this.getColumnVisibleState(this._orderedColumnsIndexes[e]))return this._orderedColumnsIndexes[e];e-=1}return-1},e.prototype.getListOfVisiblePinnedColumnIDs=function(e){for(var t=[],i="left"===e?this.getFirstVisibleColumnID():this.getLastVisibleColumnID(),n="left"===e?this.getNextVisibleColumnID:this.getPreviousVisibleColumnID;i>=0;){if(this.getColumnPinned(i)!==e)return t;t.push(i),i=n.call(this,i)}return t},e.prototype.getFirstOrLastUnpinnedColumnIndex=function(e,t){var i=-1;if("right"===e)for(var n=i=this._orderedColumnsIndexes.length-1;n>=0;n--){if("right"!==(o=this.getColumnPinned(this._orderedColumnsIndexes[n])))return"left"===o?t?i:-1:i;i--}else if("left"===e){i=0;for(n=0;n<this._orderedColumnsIndexes.length;n++){var o;if("left"!==(o=this.getColumnPinned(this._orderedColumnsIndexes[n])))return"right"===o?t?i:-1:i;i++}}return t?i:-1},e.prototype.getNumberOfColumnsToTheLeft=function(){return{left:0,unpinned:this.getFirstOrLastUnpinnedColumnIndex("left",!1),right:this.getFirstOrLastUnpinnedColumnIndex("right",!1)+1}},e.prototype._setOrderedColumnIndexes=function(e){e.length===this._leafColumns.length?(this._orderedColumnsIndexes=e,this._computeOrderedColumnsReverseIndexes(),this._createBalancedColumnTreeFromOrderedIndexes()):console.warn("DataGridView: The orderedColumnIndex array set does not have the correct dimension")},e.prototype._createBalancedColumnTreeFromOrderedIndexes=function(){for(var e=[],t=this.getOrderedColumnsIndexes(),i=0;i<t.length;i++){var o=t[i],l=this._leafColumns[o],s=n.extractItemHierarchy(l,this._balancedColumnTree,!1);s&&e.push(s)}this._balancedColumnTree=e,this._mergeBalancedColumnTree()},e.prototype._mergeBalancedColumnTree=function(e){this._mergeColumnGroups(this._balancedColumnTree,e),this._columnItemsByDepth=n.computeItemsByDepth(this._balancedColumnTree),this._columnTreeItemCount=n.countItem(this._balancedColumnTree),this._computeColumnsReverseIndexes(),this._computeOrderedColumnsIndexes()},e.prototype._mergeColumnGroups=function(e,t){if(e&&e.length>1)for(var i=e.length-1;i>0;i--){var n=e[i],o=e[i-1];if(n&&n.children&&o&&o.children&&n.dataIndex===o.dataIndex&&(!t||n!==t&&o!==t)){var l=this.getColumnOrGroupPinned(n),s=this.getColumnOrGroupPinned(o);if(l===s||void 0===l&&"unpinned"===s||"unpinned"===l&&void 0===s){o.children=o.children.concat(n.children);for(var r=0;r<n.children.length;r++)n.children[r]._parent=o;e.splice(i,1)}}}for(i=0;i<e.length;i++){var a=e[i];a&&a.children&&this._mergeColumnGroups(a.children,t)}},e.prototype._computeOrderedColumnsIndexes=function(){if(this._orderedColumnsIndexes=[],this._columnItemsByDepth&&this._columnItemsByDepth.length>0)for(var e=this._columnItemsByDepth[this._columnItemsByDepth.length-1],t=0;t<e.length;t++){var i=e[t];this._orderedColumnsIndexes.push(this.getColumnIndex(i.dataIndex))}this._computeOrderedColumnsReverseIndexes()},e.prototype._computeOrderedColumnsReverseIndexes=function(){this._orderedColumnsReverseIndexes=[];for(var e=0;e<this._orderedColumnsIndexes.length;e++)this._orderedColumnsReverseIndexes[this._orderedColumnsIndexes[e]]=e},e.prototype._computeColumnsReverseIndexes=function(){this._columnsReverseIndexes={};for(var e=0,t=this._leafColumns.length;e<t;e++){var i=this._leafColumns[e].dataIndex;void 0!==i&&(this._columnsReverseIndexes[i]=e)}this._columnsReverseIndexes.rowHeader=-1},e.prototype._computeOriginalOrderedColumnsIndexes=function(){for(var e=this.getOriginalLeafColumns().length,t=[],i=[],n=[],o=0;o<e;o++){var l=this.getColumnPinned(o);"left"===l?t.push(o):"right"===l?n.push(o):i.push(o)}this._orderedColumnsIndexes=t.concat(i).concat(n),this._originalOrderedColumnsIndexes=this._orderedColumnsIndexes.slice(0),this._computeOrderedColumnsReverseIndexes();var s=this.getOrderedColumnsReverseIndexes();this._originalOrderedColumnsReverseIndexes=s.slice(0)},e.prototype._isColumnDisplayedByHierarchy=function(e){var t=e.columnID,i=this.getColumnIndex(t),n=this.getColumnOrGroupFromCoordinates({rowID:e.rowID,columnID:i});if(n){if(!n._parent)return!0;var o=this.getColumnOrGroupCellCoordinates(n._parent);if(void 0===n.columnGroupShow)return this._isColumnDisplayedByHierarchy(o);if("open"===n.columnGroupShow)return(!0===n._parent.expandedFlag||!0===n._parent.isExpanderHidden)&&this._isColumnDisplayedByHierarchy(o);if("closed"===n.columnGroupShow)return(!1===n._parent.expandedFlag||!0===n._parent.isExpanderHidden)&&this._isColumnDisplayedByHierarchy(o)}return!1},e.prototype._getNumberOfColumnsToTheLeftFromChanges=function(e){if(!e)return{left:0,unpinned:0,right:0};for(var t=0,i=0,n=e.columnsPinnedState,o=0;o<this._leafColumns.length;o++){var l=this._leafColumns[o].dataIndex,s=void 0;"left"===(s=n&&n.hasOwnProperty(l)?n[l]:this.getOriginalColumnOptionValue(l,"pinned"))?i++:"right"===s?0:t++}return{left:0,unpinned:i,right:i+t}},e.prototype._getDataIndexOccurrenceNumberInRow=function(e){for(var t=0,i=0;i<this._columnItemsByDepth.length;i++){for(var n=this._columnItemsByDepth[i],o=0;o<n.length;o++)e.dataIndex===n[o].dataIndex&&t++;if(t>0)break}return t},e.prototype._getTopNonSplittableGroup=function(e){var t;if(e)for(var i=n.getParents(e),o=0;o<i.length;o++)if(i[o]&&!1===i[o].splittableFlag){t=i[o];break}return t},e.prototype._initColumnGroupsExpandedFlag=function(){if(this._columnItemsByDepth&&this._columnItemsByDepth.length>0)for(var e=0;e<this._columnItemsByDepth.length-1;e++)for(var t=this._columnItemsByDepth[e],i=0;i<t.length;i++){var n=t[i];if(n&&void 0===n.expandedFlag){var o=n.children;if(o&&o.length>0)for(var l=0;l<o.length;l++){var s=o[l];if("closed"===s.columnGroupShow||"open"===s.columnGroupShow){n.expandedFlag=!1;break}}}}},e}();return i.addClass(r,"ColumnModel"),r}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/DataGridView/DataGridViewTreeNodeCell",["require","exports","DS/DataGridView/DataGridViewCell","DS/Utilities/Dom","DS/Core/PointerEvents","UWA/Core","DS/Core/WebUXComponents"],(function(e,t,i,n,o,l,s){"use strict";var r=function(e){e.stopPropagation(),e.preventDefault()};function a(e){return e.getNodeDepth()}function u(e){if(e){var t=e.badges?l.clone(e.badges):{},i=this.nodeModel.getBadges();if(i){var n={};Object.keys(i).forEach((function(e){i[e]&&(n[e]=i[e])})),l.merge(t,n)}return t}return{}}function d(e){if(e){if(!this.nodeModel||!this.nodeModel.hasBadges())return this._latestAddedBadges={},e;var t;t="string"==typeof e?n.isAPath(e)?{iconPath:e}:{iconName:e}:l.clone(e);var i=u.call(this,e);return t.badges=i,this._latestAddedBadges=i,t}}var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{nodeModel:{defaultValue:null,type:"object",category:"Model"},readOnly:{defaultValue:!0,type:"boolean",category:"Model"},buildLinks:{defaultValue:!0,type:"boolean",category:"Appearance"},depthIncrement:{defaultValue:22,type:"integer"},showIconsFlag:{defaultValue:!0,type:"boolean"},expanderStyle:{defaultValue:"classic",type:"string"},flatTreeFlag:{defaultValue:!1,type:"boolean"},icons:{defaultValue:void 0,type:"Array"},getNodeDepth:{defaultValue:a,type:"function",noNeedToApplyFlag:!0}}},enumerable:!1,configurable:!0}),t.prototype._applyNodeModel=function(e){var t=this.nodeModel;t&&(this.__applyExpanderState(t.getState()),this.__applyDepth(this.getNodeDepth(t)))},t.prototype._applyReadOnly=function(e){this._reusableContent&&(this._reusableContent.readOnly=this.readOnly)},t.prototype._applyShowIconsFlag=function(e){this.elements.iconsContainer&&(this.showIconsFlag?this.elements.iconsContainer.show():this.elements.iconsContainer.hide())},t.prototype._applyFlatTreeFlag=function(e){!this.isDirty("nodeModel")&&this.nodeModel&&this.__applyDepth(this.nodeModel.getNodeDepth()),this.flatTreeFlag?this.elements.expanderContainer.hide():this.elements.expanderContainer.show()},t.prototype._applyExpanderStyle=function(e){this.elements.container.setAttribute("expander-style",this.expanderStyle)},t.prototype._applyBuildLinks=function(e){!this.isDirty("nodeModel")&&this.nodeModel&&this.__applyDepth(this.nodeModel.getNodeDepth()),!1===this.buildLinks?this.elements.expanderContainer.setAttributeNode(document.createAttribute("no-link")):this.elements.expanderContainer.removeAttribute("no-link")},t.prototype._applyProperties=function(t){this.isDirty("nodeModel")&&this._applyNodeModel(this.nodeModel),this.isDirty("icons")&&this._applyIcons(this.icons),this.isDirty("readOnly")&&this._applyReadOnly(t.readOnly),this.isDirty("showIconsFlag")&&this._applyShowIconsFlag(t.showIconsFlag),this.isDirty("flatTreeFlag")&&this._applyFlatTreeFlag(t.flatTreeFlag),this.isDirty("expanderStyle")&&this._applyExpanderStyle(t.expanderStyle),this.isDirty("buildLinks")&&this._applyBuildLinks(t.buildLinks),e.prototype._applyProperties.call(this,t)},t.prototype.buildView=function(){this.elements.linksContainer=new l.Element("div",{class:"wux-layouts-treeview-links"}).inject(this.elements.container),this.elements.expanderContainer=new l.Element("div",{class:"wux-layouts-treeview-expander"}).inject(this.elements.container),this.elements.tweakerContainer=new l.Element("div",{class:"wux-layouts-datagridview-tweaker-container"}).inject(this.elements.container),this.__observeEvents()},t.prototype._getContentContainer=function(){return this.elements.tweakerContainer},t.prototype.__observeEvents=function(){var e=this;this.elements.expanderContainer.addEvent(o.POINTERHIT,(function(t){t.stopPropagation(),"touchend"===t.type&&t.preventDefault(),1!==t.which&&"touchend"!==t.type||e.nodeModel.getChildren()&&"noExpandState"!==e.nodeModel._expandState&&"expandingState"!==e.nodeModel._expandState&&(e.nodeModel.isExpanded()&&"partiallyExpandedState"!==e.nodeModel._expandState?e.nodeModel.collapse():(e.__applyExpanderState("expanding"),e.nodeModel.expand()))})),this.elements.expanderContainer.addEventListener("contextmenu",r),this.elements.expanderContainer.addEventListener(o.LONGHOLD,r)},t.prototype.__applyDepth=function(e){var t=this.nodeModel,i=this.elements;void 0===e&&(e=t.getParents().length);var n=this.depthIncrement;if(this.buildLinks&&e>0){for(var o,l,s,r,a=t.isLastChild(),u=[t],d=t,c=1;c<e;c++)d=d?d.getParent():void 0,u.push(d);var h=0,g="";for(o=0;o<e;o++){var p=a&&o===e-1;s=(o===e-1?0:n)-1,r=(0===o?n:0)+h,""===(l=!p&&u[e-1-o]&&u[e-1-o].isLastChild()?"border-color:transparent":"")?(h=0,g=g+"<li"+(' data-depth="'+o+"/"+(e-1)+'"')+' style="'+l+";height: "+(p?"50%":"100%")+";margin-right:"+s+"px;margin-left:"+r+'px" class="wux-layouts-treeview-link"></li>'):h=s+r+1}g="<span>"+g+"</span>",i.linksContainer.innerHTML!==g&&(i.linksContainer.innerHTML=g)}else i.linksContainer.innerHTML="";var m=this.flatTreeFlag?0:this.collectionView.getCurrentRootMargin(),f=n*e;i.linksContainer.setStyles({"margin-left":m,"min-width":f}),this._nodeOffsetX=f+m+2,i.container.setAttribute("data-node-depth",e)},t.prototype.__applyExpanderState=function(e){this._displaysExpanderSign=!1,e&&(this._displaysExpanderSign=!0,e.indexOf("noChildren")>-1&&(e="noChildren",this._displaysExpanderSign=!1),this.elements.expanderContainer.setAttribute("data-wux-state",e))},t.prototype.__applyLabel=function(e){"number"==typeof e&&(e=e.toString()),this._reusableContent&&(this._reusableContent.disableEvents(),this._reusableContent.value=e,this._reusableContent.enableEvents())},t.prototype.checkBadges=function(){return!(!this.icons||this.icons.length<=0)&&(this._latestAddedBadges||(this._latestAddedBadges={}),!l.equals(u.call(this,this.icons[0]),this._latestAddedBadges))},t.prototype._applyIcons=function(e){var t=this;[this.elements.iconsContainer,this.elements.rightIconsContainer].forEach((function(e){if(e){e.removeAttribute("wux-icon-name");var t=e.getChildren();t&&t.forEach((function(e){e.hasClassName("wux-layouts-datagridview-icon")&&e.remove()}))}}));var i=this.icons;if(i&&(Array.isArray(i)&&i.length>0||"string"==typeof i&&""!==i)){if(this.elements.iconsContainer||(this.elements.iconsContainer=new l.Element("div",{class:"wux-layouts-treeview-icons"})),Array.isArray(i)&&i.length>0){var n=document.createDocumentFragment(),o=document.createDocumentFragment();i.forEach((function(e,l){var s=e;if(0===l&&(s=d.call(t,i[0])),s){var r=t.__buildIcon(s);!e.hasOwnProperty("position")||e.position&&"near"===e.position?n.appendChild(r):"far"===e.position&&o.appendChild(r)}})),this.elements.iconsContainer.appendChild(n),o.children.length>0&&(this.elements.rightIconsContainer||(this.elements.rightIconsContainer=new l.Element("div",{class:"wux-layouts-treeview-icons wux-layouts-treeview-right-icons"})),this.elements.rightIconsContainer.appendChild(o))}else if("string"==typeof i&&""!==i){var s=d.call(this,i);this.__addIcon(s,"css")}this._applyShowIconsFlag(),this.elements.iconsContainer.parentNode||(this.elements.tweakerContainer?this.elements.iconsContainer.inject(this.elements.tweakerContainer,"before"):this.elements.iconsContainer.inject(this.elements.container)),this.elements.rightIconsContainer&&!this.elements.rightIconsContainer.parentNode&&(this.elements.tweakerContainer?this.elements.rightIconsContainer.inject(this.elements.tweakerContainer,"after"):this.elements.rightIconsContainer.inject(this.elements.container))}else this.elements.iconsContainer&&this.elements.iconsContainer.hide()},t.prototype.__addIcon=function(e,t){var i=this.__buildIcon(e,t);this.elements.iconsContainer.appendChild(i)},t.prototype.__buildIcon=function(e,t){var i=n.createElement("div",{class:"wux-layouts-datagridview-icon"});if("css"===t)i.setAttribute("icon-type","css"),i.setAttribute("wux-icon-name",e.toString());else"string"==typeof e&&i.setAttribute("icon-type","css"),n.generateIcon(e,{target:i});return i},t.prototype.computeContentSize=function(){var e=0;if(this.elements.expanderContainer){var t=this.elements.expanderContainer.offsetWidth;t>0&&(e=t,this._displaysExpanderSign&&(e-=7))}var i=0;if(this.elements.iconsContainer){var n=this.elements.iconsContainer.offsetWidth;n&&(i=n+3)}var o=this._nodeOffsetX+e+i,l=this.getReusableContent();return l&&l.computeContentSize&&(o+=l.computeContentSize()),Math.ceil(o)},t.prototype.getFontSize=function(){var e=window.getComputedStyle(this.getContent(),null).getPropertyValue("font-size");return parseFloat(e)},t.prototype.getFontFamily=function(){return"arial"},t.prototype.getInitialClassName=function(){return e.prototype.getInitialClassName.call(this)+" wux-layouts-datagridview-tree-node-cell wux-tree-treelistview"},t.prototype.destroy=function(){this.elements&&this.elements.expanderContainer&&(this.elements.expanderContainer.removeEventListener("contextmenu",r),this.elements.expanderContainer.removeEventListener(o.LONGHOLD,r)),e.prototype.destroy.call(this)},t.prototype.getPrintableContent=function(){var e='<div style="display:flex;">';return this.elements.iconsContainer&&this.elements.iconsContainer.parentNode&&(e+=this.elements.iconsContainer.outerHTML),e+=this.elements.tweakerContainer.outerHTML,this.elements.rightIconsContainer&&this.elements.rightIconsContainer.parentNode&&(e+=this.elements.rightIconsContainer.outerHTML),e+="</div>"},t}(i);return s.addClass(c,"DataGridViewTreeNodeCell"),c})),define("DS/DataGridView/DataGridViewConditionBaseFilterView",["DS/DataGridView/DataGridViewBaseFilterView","DS/Utilities/Dom","DS/Core/PointerEvents","i18n!DS/DataGridView/assets/nls/translation"],(function(e,t,i,n){"use strict";function o(e){for(let t=e;t<this._numberOfConditionDisplayed;t++){const e=this._conditionsElements[t];e.container&&e.container.remove(),this.resetConditionElements(e)}this._numberOfConditionDisplayed=e,0===e&&this.displayConditionElements(0)}function l(){"and"===this._operator?this._operatorLabel.innerHTML=n.get("FilterView_Condition_All"):this._operatorLabel.innerHTML=n.get("FilterView_Condition_Any"),t.addEventOnElement(this,this._operatorLabel.querySelector("#conditionToggle"),i.POINTERHIT,(()=>{"and"===this._operator?this._operator="or":this._operator="and",l.call(this)}))}return e.inherit({name:"datagridviewconditionbasefilterview",publishedProperties:{},buildConditionElements:function(e){},refreshConditionElements:function(e,t){},resetConditionElements:function(e){},buildConditionFilterModel:function(e){},isConditionEmpty:function(e){return!0},focusConditionElements:function(e){},_build:function(){this._parent(),this._operatorLabel=null,this._conditionsElements=[],this._numberOfConditionDisplayed=0,this._operator="and"},buildContentView:function(){var e=this._popupContentDiv;e&&(e.addClassName("wux-datagridview-filter-conditions"),this._operatorLabel=document.createElement("div"),this._operatorLabel.classList.add("wux-datagridview-filter-operator"),e.appendChild(this._operatorLabel),this.refreshContentView())},hideConditionElements:function(e){const t=e>=0?e:this._numberOfConditionDisplayed-1;this._conditionsElements.length>0&&t>0&&this._numberOfConditionDisplayed>t&&this._conditionsElements.length>=this._numberOfConditionDisplayed&&o.call(this,t)},displayConditionElements:function(e){var t=this._popupContentDiv;if(t&&!(e>3)){if(this._conditionsElements.length<=e){const e=this.buildConditionElements(this._conditionsElements.length);return e.container.classList.add("wux-datagridview-filter-condition"),t.appendChild(e.container),this._conditionsElements.push(e),this._numberOfConditionDisplayed++,e}if(this._numberOfConditionDisplayed<=e){const e=this._conditionsElements[this._numberOfConditionDisplayed];return t.appendChild(e.container),this._numberOfConditionDisplayed++,e}return this._conditionsElements[e]}},isConditionElementsDisplayed:function(e){return e<this._numberOfConditionDisplayed},resetFilterViewContent:function(){this._operator="and",l.call(this),o.call(this,0)},clearFilterViewContent:function(){this.resetFilterViewContent()},refreshContentView:function(e){if(this.filter&&this.elements._popup){var t=void 0!==e?e:this.filter.filterModel;if(!t||Array.isArray(t))return void this.resetFilterViewContent();this._operator=t.operator||"and",l.call(this);const i=Object.keys(t).length-(void 0!==t.operator?1:0);for(let e=0;e<i;e++){const i=this.displayConditionElements(e);if(i){const n=t["condition"+(e+1)];this.refreshConditionElements(i,n)}}const n=this.displayConditionElements(i);this.resetConditionElements(n),i+1<this._conditionsElements.length&&o.call(this,i+1)}},focusContentView:function(){this._conditionsElements[0]&&this.focusConditionElements(this._conditionsElements[0])},buildFilterModelFromView:function(){if(0===this._numberOfConditionDisplayed)return this.filter&&this.filter.filterModel;let e={};for(let t=0;t<this._numberOfConditionDisplayed;t++){const i=this._conditionsElements[t];if(this.isConditionEmpty(i))break;e["condition"+(t+1)]=this.buildConditionFilterModel(i)}return Object.keys(e).length>=2&&(e.operator=this._operator),e}})})),define("DS/DataGridView/DataGridViewSetFilterView",["DS/Utilities/Utils","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CollectionView/CollectionViewStatusBar","DS/DataGridView/DataGridViewBaseFilterView","DS/Controls/LineEditor","DS/Controls/Toggle","DS/TreeModel/ModelUtils","DS/TreeModel/DataSourceBase","i18n!DS/DataGridView/assets/nls/translation"],(function(e,t,i,n,o,l,s,r,a,u){"use strict";function d(t,i){if(null===t&&null===i)return!0;if(void 0===t&&void 0===i)return!0;if(null==t)return!1;if(null==i)return!1;if("object"!=typeof t&&"object"!=typeof i)return t===i;if(Array.isArray(t)&&!Array.isArray(i))return!1;if(!Array.isArray(t)&&Array.isArray(i))return!1;if(Array.isArray(t)){if(t.length!==i.length)return!1;for(let e=0;e<t.length;e++)if(!d(t[e],i[e]))return!1;return!0}return e.areObjectsEqual(t,i)}class c{constructor(){this._set=new Set}get set(){return this._set}add(e){const t=[...this.set.values()].find((t=>d(t,e)));return t||(this.set.add(e),e)}}const h=function(){return Object.keys(this._mappedIdsStruct).length>0},g=function(e){let t=e;const i=u.get("FilterView")[e+""];"Blank"===e?t="("+i+")":void 0!==i&&(t=i);const n=h.call(this);let o=0;n?this._mappedIdsStruct[e].ids.forEach((e=>{o+=this._idsStruct[e].count})):o=this._idsStruct[e].count;const l=this._insertNewNode(t,o,e);n?this._mappedIdsStruct[e].nodeModel=l:this._idsStruct[e].nodeModel=l},p=function(){if(this._xsoListeningDisabled=!0,this._treeDocumentPossibleValues.prepareUpdate(),this._treeDocumentPossibleValues.empty(),h.call(this))for(let e in this._mappedIdsStruct)g.call(this,e);else for(let e in this._idsStruct)g.call(this,e);this._treeDocumentPossibleValues.pushUpdate(),this._xsoListeningDisabled=!1},m=function(e,t){if(e.length===t.length)for(var i=0;i<t.length;i++){const n=t[i],o=e[i];this._mappedIdsStruct[o]?this._mappedIdsStruct[o].ids.push(n):this._mappedIdsStruct[o]={ids:[n],nodeModel:null}}},f=async function(){this._mappedIdsStruct={};const e=this.filterViewManager.view;if(e){const t=e.getColumnOrGroup("label"===this.propertyId?"tree":this.propertyId);if(t&&t.filterOptions&&t.filterOptions.mapPossibleValues){const e=t.filterOptions.mapPossibleValues;if(e instanceof Function){const t=Object.keys(this._idsStruct),i=e.call(this,t);let n;if(i instanceof Promise){if(this._dataGridViewPossibleValues&&(this._dataGridViewPossibleValues.displayModalLoader(u.get("Loading")),this._dataGridViewPossibleValues.placeholder=""),n=await i,this._dataGridViewPossibleValues&&(this._dataGridViewPossibleValues.removeModalLoader(u.get("Loading")),this.elements._popup.fire("setFilterReady"),this._dataGridViewPossibleValues.placeholder=u.get("NoObjectsFound")),this._refreshInProgress>1)return this._refreshInProgress--,0}else n=i;m.call(this,n,t)}}}return 1},C=function(e){if(e&&this.filter){const t=this.filter.getListOfFilteredData();if(t)return t.includes(e)}return!1},w=async function(e){let t,i=[],n=!1;if(e&&e.filterOptions&&e.filterOptions.getCustomFilterSetValues){const o=e.filterOptions.getCustomFilterSetValues;o instanceof Function&&(t=o.call(this),n=t instanceof Promise,n||(i=t))}return n&&(this._dataGridViewPossibleValues&&(this._dataGridViewPossibleValues.displayModalLoader(u.get("Loading")),this._dataGridViewPossibleValues.placeholder=""),i=await t,this._dataGridViewPossibleValues&&(this._dataGridViewPossibleValues.removeModalLoader(u.get("Loading")),this.elements._popup.fire("setFilterReady"),this._dataGridViewPossibleValues.placeholder=u.get("NoObjectsFound"))),i},_=async function(e){const t=this.filterViewManager.view,n="label"===this.propertyId?"tree":this.propertyId,o=t.getColumnOrGroup(n);let l={timeStamp:e,unseenIdsStruct:{},idsStruct:{},notDisplayedAndNotFilteredByMe:[]};const s=this.filterViewManager.filterManager.model,r=await w.call(this,o);if(Array.isArray(r)&&r.length){for(const e of r)l.idsStruct[e]||(l.idsStruct[e]={values:new c,count:void 0,nodeModel:null},l.idsStruct[e].values.add(e));return l}if(s instanceof a)throw`Column with dataIndex "${this.propertyId}" does not implement filterOptions.getCustomFilterSetValues. No default way to retrieve values from a DataSource.`;const u=t.getTypeRepresentationFactory(),d=[];s.processDescendants({processNode:e=>{d.push((async()=>{const o=e.nodeModel;if(o._isHidden||!C.call(this,o)&&o.getFilteredCount()>=1)return;if(this.filterViewOptions?.ignoreGroupingNodes&&o.getNodeSource()!==i.NODE_SOURCE.MODEL)return;const s=o.options.getAttributeValueForFiltering.call(o,this.propertyId),r=null==(a=s)?[a]:Array.isArray(a)?Array.from(a):[a];var a;let d=[];const h=t.layout.getColumnIdentifiers(n),g=t.getCellInfosAt(t.layout.getCellIDFromCoordinates({rowID:o.getRowID(),columnID:h.columnIndex}));let p=t.layout.getColumnGetCellTypeRepresentation(h.columnIndex)?.call(t,g)||t.layout.getColumnTypeRepresentation(h.columnIndex);if(p)try{const e=await u.generateTweaker(r[0],{typeRep:{stdTemplate:p}});for(const t of r){const i=e.getStringFromValue(t);d.push(null!=i&&""!==i?i:t)}}catch{d=r}else d=r;const m=this._getIdsFromValues(d);for(let e=0;e<m.length;e++){const t=m[e];if(0===o.getFilteredCount()||1===o.getFilteredCount()&&C.call(this,o)){const i=l.idsStruct[t];i?i.count=(i.count||0)+1:l.idsStruct[t]={values:new c,count:1,nodeModel:null},l.idsStruct[t].values.add(r[e])}else C.call(this,o)||(l.unseenIdsStruct[t]||(l.unseenIdsStruct[t]=new c),l.unseenIdsStruct[t].add(r[e]))}})())}}),await Promise.all(d);for(const e in l.unseenIdsStruct)l.idsStruct[e]||l.notDisplayedAndNotFilteredByMe.push(...l.unseenIdsStruct[e].set);return l},D=function(){this._numberOfSelectedEntries=0;const e=this._dataGridViewPossibleValues.elements.statusBar.getNodeModelByID("selectedItems"),t=this._treeDocumentPossibleValues._numberOfNodesInDocument,i=this._treeDocumentPossibleValues.getXSO().get();this._filterOnlyOnVisibleNode?this._numberOfSelectedEntries=i.reduce(((e,t)=>t.isVisible()?++e:e),0):this._numberOfSelectedEntries=i.length,e.updateOptions({grid:{data:u.get("FilterView_NumberOfSelectedEntries",{numberOfSelectedEntries:this._numberOfSelectedEntries,numberTotalOfNodes:t})}}),this.validFlag=this._numberOfSelectedEntries>0},I=function(e){let t=[],i=null,n=()=>!1;const o=h.call(this);for(var l in o?(i=this._mappedIdsStruct,n=t=>this._mappedIdsStruct[t].ids.some((t=>this._shouldSelectPossibleValue(e,t)))):(i=this._idsStruct,n=t=>this._shouldSelectPossibleValue(e,t)),i){const e=i[l].nodeModel;e&&(n(l)&&t.push(e))}const s=r.getNodesToPreselectOrSelect(this._treeDocumentPossibleValues,t,t);s.length&&(t=t.concat(s)),this._treeDocumentPossibleValues.getXSO().add(t),D.call(this)};return o.inherit({name:"datagridviewsetfilterview",publishedProperties:{},_build:function(){this._parent(),this._treeDocumentPossibleValues=null,this._searchLineEditor=null,this._dataGridViewPossibleValues=null,this._refreshInProgress=0},buildContentView:function(){var e=this._popupContentDiv;if(!e)return;e.addClassName("wux-datagridview-filter-set"),this._searchLineEditor=new l({placeholder:u.get("FilterView").AttributeValuePlaceHolder,displayClearFieldButtonFlag:!0,tooltipInfos:{getAllInformationCB:()=>({model:{shortHelp:""!==this._searchLineEditor.valueToCommit?u.get("FilterView").AttributeValuePlaceHolder:void 0},updateModel:!1})}}).inject(e),this._searchLineEditor.getContent().addClassName("wux-datagridview-filter-set-editor"),this._searchLineEditor.addEventListener("uncommittedChange",(()=>{""!==this._searchLineEditor.valueToCommit?(e.setAttributeNode(document.createAttribute("refined-toggle-visible")),e.insertBefore(this._filterOnlyOnVisibleNodeToggle.getContent(),this._dataGridViewPossibleValues.getContent())):(e.removeAttribute("refined-toggle-visible"),this._filterOnlyOnVisibleNodeToggle.remove(),e.style.height=e.style.height),this._treeDocumentPossibleValues.setFilterModel({label:{filterId:"stringRegexp",filterModel:{condition1:{type:"contains",filter:this._searchLineEditor.valueToCommit}},filterOptions:{keepChildren:!0,onlyVisibleNodes:!0}}}),D.call(this),this._filterOnlyOnVisibleNode&&this.fire("change")})),this._filterOnlyOnVisibleNodeToggle=new s({label:u.get("FilterView").FilterOnlyRefinedValues,checkFlag:!1,tooltipInfos:{shortHelp:u.get("FilterView").FilterOnlyRefinedValuesTooltip}}),this._filterOnlyOnVisibleNodeToggle.getContent().addClassName("wux-datagridview-filter-set-toggle"),this._filterOnlyOnVisibleNodeToggle.addEventListener("change",(()=>{this._filterOnlyOnVisibleNode=this._filterOnlyOnVisibleNodeToggle.checkFlag,D.call(this),this.fire("change")})),this._idsStruct={},this._mappedIdsStruct={},this._notDisplayedAndNotFilteredByMe=[],this._treeDocumentPossibleValues=new t({shouldSelectDescendants:function(e){return!0},shouldUnselectDescendants:function(e){return!0},shouldSelectParents:function(e){return!0},shouldUnselectParents:function(e){return!0}});const i=this._treeDocumentPossibleValues.getXSO(),o=()=>{this._xsoListeningDisabled||(D.call(this),this.fire("change"))};i.onPostAdd(o),i.onPostRemove(o);const r=require("DS/DataGridView/DataGridView");this._dataGridViewPossibleValues=new r({treeDocument:this._treeDocumentPossibleValues,height:150,columns:[{text:u.get("FilterView").ValuesList,dataIndex:"tree",editableFlag:!1,resizableFlag:!1,width:"auto",filterOptions:{readOnly:!0}}],showRowIndexFlag:!1,showSelectionCheckBoxesFlag:!0,sortModel:[{dataIndex:"tree",sort:"asc"}],getCellTooltip:e=>e.rowID<0&&e.columnID<0?{getAllInformationCB:()=>({model:{shortHelp:""===this._searchLineEditor.valueToCommit?u.get("FilterView").SelectAll:u.get("FilterView").SelectAllRefinedResults},updateModel:!1})}:this._dataGridViewPossibleValues.getCellDefaultTooltip(e),onContextualEvent:function(){return[]},selectionBehavior:{toggle:!0,unselectAllOnEmptyArea:!1,unselectAllOnEscapeKey:!1,selectNodeModelOnCellSelection:!0,showMixedStateOnParents:!0},cellSelection:"none",rowSelection:"multiple",cellActivationFeedback:!1}).inject(e),this._dataGridViewPossibleValues.__selectAllOnlyOnVisibleNodes=!0,this._dataGridViewPossibleValues.buildStatusBar([{type:n.STATUS.CUSTOM,position:"near",id:"selectedItems",dataElements:{typeRepresentation:"string",value:u.get("FilterView").NoStatus,tooltip:"Selected filter entries"}}]),this.refreshContentView()},clearFilterViewContent:function(){this._treeDocumentPossibleValues.selectAll(),this._searchLineEditor&&(this._searchLineEditor.value="")},refreshContentView:function(e){this.filter&&this.elements._popup&&new Promise((async(t,i)=>{this._refreshLastTimeStamp=Date.now(),this._refreshInProgress++,this._unseenIdsStruct={},this._idsStruct={},this._notDisplayedAndNotFilteredByMe=[];const n=await _.call(this,this._refreshLastTimeStamp);if(!n||n.timeStamp!==this._refreshLastTimeStamp)return this._refreshInProgress--,void i();this._unseenIdsStruct=n.unseenIdsStruct,this._idsStruct=n.idsStruct,this._notDisplayedAndNotFilteredByMe=n.notDisplayedAndNotFilteredByMe;const o=await f.call(this);this._refreshInProgress--,!o||this._refreshInProgress>0?i():(this._cleanBeforeReset(),p.call(this),I.call(this,void 0!==e?e:this.filter.filterModel),this._dataGridViewPossibleValues&&this._dataGridViewPossibleValues.reapplySortModel(),this._searchLineEditor&&(this._searchLineEditor.value=""),t())})).catch((e=>{})).finally((()=>{this.fire("change")}))},focusContentView:function(){this._searchLineEditor&&this._searchLineEditor.focus()},buildFilterModelFromView:function(){if(!this._dataGridViewPossibleValues||this._refreshInProgress>0)return this.filter&&this.filter.filterModel;const e=this._treeDocumentPossibleValues.getXSO(),t=[];e.get().forEach((e=>{if(!(e&&e.options&&e.options instanceof Object))return;if(!e.options.hasOwnProperty("attributeId")||this._filterOnlyOnVisibleNode&&e.isFiltered())return;const i=e.options.attributeId;h.call(this)?this._mappedIdsStruct[i].ids.forEach((e=>{this._idsStruct&&this._idsStruct[e]&&this._idsStruct[e].values&&t.push(...this._idsStruct[e].values.set)})):this._idsStruct&&this._idsStruct[i]&&this._idsStruct[i].values&&t.push(...this._idsStruct[i].values.set)}));const i=new Set(t);this._filterOnlyOnVisibleNode||this._notDisplayedAndNotFilteredByMe.forEach((e=>i.add(e)));const n=Array.from(i);return this.filter.isEmpty(n)?[]:n},_cleanBeforeReset:function(){},_insertNewNode:function(e,t,n){if(!e||void 0!==t&&t<=0||!n||!this._treeDocumentPossibleValues)return;const o=new i({label:e+(void 0!==t&&t>0?" ("+t.toString()+")":""),attributeId:n});return this._treeDocumentPossibleValues&&this._treeDocumentPossibleValues.addRoot(o),o},_shouldSelectPossibleValue:function(t,i){if(!t||0===t.length||!Array.isArray(t))return!0;if("Blank"===i)return-1!==t.indexOf(void 0)||-1!==t.indexOf(null)||-1!==t.indexOf("");return[...this._idsStruct[i].values.set].some((i=>function(t,i){if(Array.isArray(t)){if(!e.isPlainObject(i))return-1!==t.indexOf(i);for(let e of t)if(d(e,i))return!0}return!1}(t,i)))},_getIdsFromValues:function(e){return Array.from(e,(e=>null==e||""===e?"Blank":e.toString()))}})})),define("DS/DataGridView/DataGridViewNumberFilterView",["DS/Utilities/Dom","DS/DataGridView/DataGridViewConditionBaseFilterView","DS/Controls/ComboBox","DS/Controls/SpinBox","i18n!DS/DataGridView/assets/nls/translation"],(function(e,t,i,n,o){"use strict";return t.inherit({name:"datagridviewnumberfilterview",publishedProperties:{},buildConditionElements:function(t){const l={container:null,chooser:null,editor:null,rangeLabels:[],rangeMaxEditor:null};l.container=document.createElement("div"),l.chooser=new i({enableSearchFlag:!1,elementsList:[{label:this.getConditionLabel("range"),value:"range"},{label:this.getConditionLabel("equal"),value:"equal"},{label:this.getConditionLabel("notEqual"),value:"notEqual"},{label:this.getConditionLabel("lessThan"),value:"lessThan"},{label:this.getConditionLabel("lessThanOrEqual"),value:"lessThanOrEqual"},{label:this.getConditionLabel("greaterThan"),value:"greaterThan"},{label:this.getConditionLabel("greaterThanOrEqual"),value:"greaterThanOrEqual"},{label:this.getConditionLabel("empty"),value:"empty"},{label:this.getConditionLabel("notEmpty"),value:"notEmpty"}],value:"range"}).inject(l.container);var s=this,r={allowUndefinedFlag:!0,value:void 0,placeholder:" "};this.filter&&void 0!==this.filter.filterOptions&&Object.assign(r,this.filter.filterOptions),l.editor=this.buildEditor(r),l.editor&&l.editor.inject(l.container);const a=()=>{""!==l.editor.valueToCommit&&void 0!==l.editor.valueToCommit&&("range"!==l.chooser.value||""!==l.rangeMaxEditor.valueToCommit&&void 0!==l.rangeMaxEditor.valueToCommit)?this.displayConditionElements(t+1):this.hideConditionElements(t+1),s.fire("change")},u=()=>{this.isConditionEmpty(l)?this.hideConditionElements(t+1):this.displayConditionElements(t+1),s.fire("change")};l.editor instanceof n&&l.editor.addEventListener("uncommittedChange",a),l.editor.addEventListener("change",u);const d=()=>{if("empty"===l.chooser.value||"notEmpty"===l.chooser.value?(l.editor.remove(),l.editor.value=void 0):l.editor.inject(l.container),"range"===l.chooser.value){if(null===l.rangeMaxEditor){l.rangeMaxEditor=this.buildEditor(r),l.rangeMaxEditor instanceof n&&l.rangeMaxEditor.addEventListener("uncommittedChange",a),l.rangeMaxEditor.addEventListener("change",u);const e=document.createElement("div");e.textContent=o.get("FilterView_Number_Range_From"),l.rangeLabels.push(e);const t=document.createElement("div");t.textContent=o.get("FilterView_Number_Range_To"),l.rangeLabels.push(t)}l.container.insertBefore(l.rangeLabels[0],l.editor.getContent()),l.container.appendChild(l.rangeLabels[1]),l.rangeMaxEditor.inject(l.container)}else null!==l.rangeMaxEditor&&(l.rangeLabels[0].remove(),l.rangeLabels[1].remove(),l.rangeMaxEditor.remove());s.fire("change"),u()};return e.addEventOnElement(this,l.chooser,"change",d),d(),l},refreshConditionElements:function(e,t){t?e.container&&(e.chooser.value=t.type,Array.isArray(t.filter)&&"range"===t.type?(e.editor.value=t.filter[0],e.rangeMaxEditor.value=t.filter[1]):e.editor.value=t.filter):this.resetConditionElements(e)},resetConditionElements:function(e){e&&e.container&&(e.chooser.selectedIndex=0,e.editor.value=void 0,e.rangeMaxEditor&&(e.rangeMaxEditor.value=void 0))},buildConditionFilterModel:function(e){const t={type:e.chooser.value};return"range"===t.type?t.filter=[e.editor.value,e.rangeMaxEditor.value]:"empty"!==t.type&&"notEmpty"!==t.type&&(t.filter=e.editor.value),t},isConditionEmpty:function(e){if(!e.container)return!0;if("empty"===e.chooser.value||"notEmpty"===e.chooser.value)return!1;if(void 0===e.editor.value||null===e.editor.value||""===e.editor.value)return!0;if("range"===e.chooser.value){if(void 0===e.rangeMaxEditor.value||null===e.rangeMaxEditor.value||""===e.rangeMaxEditor.value)return!0;if(e.rangeMaxEditor.value<e.editor.value)return!0}return!1},focusConditionElements:function(e){e&&e.editor&&e.editor.focus()},buildContentView:function(){var e=this._popupContentDiv;e&&(e.addClassName("wux-datagridview-filter-number"),this._parent())},buildEditor:function(e){return new n(e)},getConditionLabel:function(e){let t="";switch(e){case"range":t=o.get("FilterView_Number_Range");break;case"equal":t=o.get("FilterView_Number_Equals");break;case"notEqual":t=o.get("FilterView_Number_DoesNotEqual");break;case"lessThan":t=o.get("FilterView_Number_LessThan");break;case"lessThanOrEqual":t=o.get("FilterView_Number_LessThanOrEqual");break;case"greaterThan":t=o.get("FilterView_Number_GreaterThan");break;case"greaterThanOrEqual":t=o.get("FilterView_Number_GreaterThanOrEqual");break;case"empty":t=o.get("FilterView_Number_Empty");break;case"notEmpty":t=o.get("FilterView_Number_NotEmpty");break;default:return!0}return t}})})),define("DS/DataGridView/DataGridViewStringRegExpFilterView",["DS/DataGridView/DataGridViewConditionBaseFilterView","DS/Controls/ComboBox","DS/Controls/LineEditor","DS/Utilities/Dom","i18n!DS/DataGridView/assets/nls/translation"],(function(e,t,i,n,o){"use strict";return e.inherit({name:"datagridviewstringregexpfilterview",publishedProperties:{},buildConditionElements:function(e){var l=this;const s={container:null,chooser:null,editor:null};s.container=document.createElement("div"),s.chooser=new t({enableSearchFlag:!1,elementsList:[{label:o.get("FilterView_String_Contains"),value:"contains"},{label:o.get("FilterView_String_DoesNotContain"),value:"notContain"},{label:o.get("FilterView_String_Equals"),value:"equal"},{label:o.get("FilterView_String_DoesNotEqual"),value:"notEqual"},{label:o.get("FilterView_String_StartsWith"),value:"startsWith"},{label:o.get("FilterView_String_EndsWith"),value:"endsWith"},{label:o.get("FilterView_String_Empty"),value:"empty"},{label:o.get("FilterView_String_NotEmpty"),value:"notEmpty"}],value:"contains"}).inject(s.container);let r={};this.filter&&void 0!==this.filter.filterOptions&&Object.assign(r,this.filter.filterOptions),r.displayClearFieldButtonFlag=!0,s.editor=new i(r).inject(s.container);const a=t=>{this.isConditionEmpty(s)?l.hideConditionElements(e+1):l.displayConditionElements(e+1),l.fire("change")};n.addEventOnElement(this,s.editor,"uncommittedChange",a);return n.addEventOnElement(this,s.chooser,"change",(function(e){"empty"===s.chooser.value||"notEmpty"===s.chooser.value?(s.editor.remove(),s.editor.value=""):s.editor.inject(s.container),l.fire("change"),a()})),s},resetConditionElements:function(e){e&&e.container&&(e.chooser.value="contains",e.editor.value="")},refreshConditionElements:function(e,t){t?e.container&&(e.chooser.value=t.type,e.editor.value=t.filter):this.resetConditionElements(e)},buildConditionFilterModel:function(e){const t={type:e.chooser.value};return"empty"!==t.type&&"notEmpty"!==t.type&&(t.filter=e.editor.valueToCommit),t},isConditionEmpty:function(e){return"empty"!==e.chooser.value&&"notEmpty"!==e.chooser.value&&(void 0===e.editor.valueToCommit||null===e.editor.valueToCommit||""===e.editor.valueToCommit)},focusConditionElements:function(e){e&&e.editor&&e.editor.focus()},buildContentView:function(){var e=this._popupContentDiv;e&&(e.addClassName("wux-datagridview-filter-string"),this._parent())}})})),define("DS/DataGridView/DataGridViewDateSetFilterView",["DS/Utilities/LanguageUtils","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridViewSetFilterView","DS/Utilities/StringUtils","DS/Utilities/DateUtils"],(function(e,t,i,n,o){"use strict";return i.inherit({name:"datagridviewdatesetfilterview",publishedProperties:{},_build:function(){this._yearNodes={},this._monthFormat=new Intl.DateTimeFormat(e.regionalFormatLanguage,{month:"long"}),this._parent()},buildContentView:function(){this._parent();const e=new Intl.Collator;this._dataGridViewPossibleValues&&(this._dataGridViewPossibleValues.columns[0].compareFunction=function(t,i,o,l,s){return o.isRoot()?n.compareLocal(t,i,{intlCollator:e}):o.options.value-l.options.value})},_cleanBeforeReset:function(e){this._yearNodes={},this._parent(e)},_insertNewNode:function(e,i,n){if(!e||i<=0||!n||!this._treeDocumentPossibleValues)return;const o=new Date(n);if(o.getTime()==o.getTime()){let e=o.getFullYear(),l=null;this._yearNodes&&(l=this._yearNodes[e]),l||(l=new t({label:e.toString(),value:e}),this._yearNodes[e]=l,this._treeDocumentPossibleValues.addRoot(l));let s=o.getMonth(),r=this._getMonthNodeModel(l,s);r||(r=new t({label:this._monthFormat?this._monthFormat.format(o):s,value:s}),l.addChild(r),l.sortChildren({isRecursive:!1,sortFunction:function(e,t){return e.options.value-t.options.value}}));let a=o.getDate(),u=a;void 0!==i&&(u+=" ("+i+")");const d=new t({label:u,attributeId:n,value:a});return this._isDayAlreadyInMonth(r,u)||r.addChild(d),d}return this._parent(e,i,n)},_getMonthNodeModel:function(e,t){let i=null;if(e&&void 0!==t){let n=e.getChildren();if(n)for(let e=0;e<n.length;e++){let o=n[e];if(o&&o.options.value===t){i=o;break}}}return i},_isDayAlreadyInMonth(e,t){let i=e.getChildren(),n=i?i.length:0;for(let e=0;e<n;e++){if(i[e].options.label===t)return!0}return!1},_shouldSelectPossibleValue:function(e,t){if(!e)return!0;if(!Array.isArray(e))return!1;if(0===e.length)return!0;const i=o.convertToDate(t);return-1!==e.map((e=>Number(o.convertToDate(e)))).indexOf(Number(i))},_getIdsFromValues:function(e){return Array.from(e,(e=>{if(null==e||""===e)return"Blank";let t=o.convertToDate(e);return t&&(t=new Date(t.getFullYear(),t.getMonth(),t.getDate())),t.toString()}))}})}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/DataGridView/DataGridViewColumnHeaderCell",["require","exports","DS/DataGridView/DataGridViewCell","UWA/Core","DS/Core/WebUXComponents","DS/Utilities/Dom","DS/Controls/Toggle","DS/Core/PointerEvents","DS/Tweakers/TypeUtils"],(function(e,t,i,n,o,l,s,r,a){"use strict";var u="wux-layouts-datagridview-column-header-cell",d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{filterView:{defaultValue:void 0,type:"DS/DataGridView/DataGridViewBaseFilterView",category:"Appearance"},sortModel:{defaultValue:void 0,type:"Object",category:"Appearance"},customHeader:{defaultValue:void 0,type:"Object",category:"Appearance"},columnHeadersLayout:{defaultValue:0,type:"enum"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){this._getRightButtonsContainer()},t.prototype._getRightButtonsContainer=function(){return!this.elements.buttonsContainer&&this.elements.container&&(this.elements.buttonsContainer=new n.Element("div",{class:"wux-layouts-datagridview-column-header-icons"}).inject(this.elements.container,"bottom")),this.elements.buttonsContainer},t.prototype._applyColumnHeadersLayout=function(e){this.columnHeadersLayout!==e&&void 0!==e&&this.elements.container&&(this.columnHeadersLayout!==t.COLUMN_HEADERS_LAYOUT.SELECTION_FIRST||this.elements.leftButtonsContainer||(this.elements.leftButtonsContainer=new n.Element("div",{class:"wux-layouts-datagridview-column-header-left-icons"}).inject(this.elements.container,"top"),this.elements._selectionCheckBox&&(this.customHeader&&this.customHeader.getSelectionCheckBoxContainer?this._injectInContainer(this.elements._selectionCheckBox,0,this.customHeader.getSelectionCheckBoxContainer(this.getReusableContent())):this._injectInLeftButtonsContainer(this.elements._selectionCheckBox,0))))},t.prototype._applyFilterView=function(e){var t=this.filterView;if(t){if(e!==t){var i=this.customHeader&&this.customHeader.getFilterViewContainer?this.customHeader.getFilterViewContainer(this.getReusableContent()):this._getRightButtonsContainer();this._injectInContainer(t,1,i)}}else if(this.elements.buttonsContainer&&void 0!==e&&e.elements&&e.elements.container){var n=l.firstParentWithClass(e.getContent(),u);n&&n!==this.getContent()||e.remove()}},t.prototype._applySortModel=function(){if(this.sortModel&&this.sortModel.sortDirection&&this.collectionView){var e=this._createSortIconDefinition(this.sortModel);this.elements.sortIcon?(l.generateIcon(e,{target:this.elements.sortIcon}),this.customHeader&&this.customHeader.getSortIconContainer?this._injectInContainer(this.elements.sortIcon,0,this.customHeader.getSortIconContainer(this.getReusableContent())):this.elements.sortIcon.isInjected(this._getRightButtonsContainer())||this._injectInContainer(this.elements.sortIcon,3,this._getRightButtonsContainer())):(this.elements.sortIcon=l.generateIcon(e),this.customHeader&&this.customHeader.getSortIconContainer?this._injectInContainer(this.elements.sortIcon,0,this.customHeader.getSortIconContainer(this.getReusableContent())):this._injectInContainer(this.elements.sortIcon,3,this._getRightButtonsContainer())),this.getContent().setAttribute("sort-direction",this.sortModel.sortDirection),void 0!==this.sortModel.sortOrder?(this.elements.sortOrderNumber?this.elements.sortOrderNumber.setContent(this.sortModel.sortOrder+1):this.elements.sortOrderNumber=new n.Element("span",{content:this.sortModel.sortOrder+1,class:"wux-datagridview-columnheader-sortcount"}),this._injectInContainer(this.elements.sortOrderNumber,2,this._getRightButtonsContainer()),this.getContent().setAttribute("sort-order",(this.sortModel.sortOrder+1).toString())):this.elements.sortOrderNumber&&(this.elements.sortOrderNumber.remove(),this.getContent().removeAttribute("sort-order"))}else this.getContent().removeAttribute("sort-direction"),this.getContent().removeAttribute("sort-order"),this.elements.sortIcon&&this.elements.sortIcon.remove(),this.elements.sortOrderNumber&&this.elements.sortOrderNumber.remove()},t.prototype._createSortIconDefinition=function(e){var t;return e&&e.sortDirection&&this.collectionView&&((t=a.getSortingIconDefinition(e.typeRepresentation,this.collectionView.getTypeRepresentationFactory(),e.sortDirection)).className="wux-datagridview-columnheader-icons",t.fontIconSize="12px"),t},t.prototype._injectInContainer=function(e,t,i){(e.getContent?e.getContent():e)._dgv_expected_place=t;for(var n,o=i.children,l=0;l<o.length;l++){if(o[l]._dgv_expected_place>t){n=o[l];break}if(o[l]._dgv_expected_place===t){o[l].remove(),l<o.length&&(n=o[l]);break}}n?e.inject(n,"before"):e.inject(i)},t.prototype._injectInLeftButtonsContainer=function(e,t){this.elements.leftButtonsContainer||(this.elements.leftButtonsContainer=new n.Element("div",{class:"wux-layouts-datagridview-column-header-left-icons"}).inject(this.elements.container,"top")),this._injectInContainer(e,t,this.elements.leftButtonsContainer)},t.prototype._buildContentContainer=function(){!this.elements.tweakerContainer&&this.elements.container&&(this.elements.tweakerContainer=new n.Element("div",{class:"wux-layouts-datagridview-tweaker-container"}),this.elements.leftButtonsContainer?this.elements.tweakerContainer.inject(this.elements.leftButtonsContainer,"after"):this.elements.tweakerContainer.inject(this.elements.container,"top"))},t.prototype._getContentContainer=function(){return this.elements.tweakerContainer||this._buildContentContainer(),this.customHeader?this.elements.tweakerContainer.addClassName("wux-datagridview-custom-column-header"):this.elements.tweakerContainer.removeClassName("wux-datagridview-custom-column-header"),this.elements.tweakerContainer},t.prototype.buildSelectionCheckBox=function(){this.elements.container&&(this.elements._selectionCheckBox||(this.elements._selectionCheckBox=new s({type:"checkbox",checkFlag:!1,fireOnlyFromUIInteractionFlag:!0}),this.elements._selectionCheckBox.getContent().classList.add("wux-datagridview-selection-checkbox"),l.addEventOnElement(this,this.elements._selectionCheckBox,r.POINTERHIT,(function(e,t){e.stopPropagation()}))),this.customHeader&&this.customHeader.getSelectionCheckBoxContainer?this._injectInContainer(this.elements._selectionCheckBox,0,this.customHeader.getSelectionCheckBoxContainer(this.getReusableContent())):this.columnHeadersLayout===t.COLUMN_HEADERS_LAYOUT.DEFAULT?this._injectInContainer(this.elements._selectionCheckBox,0,this._getRightButtonsContainer()):this._injectInLeftButtonsContainer(this.elements._selectionCheckBox,0))},t.prototype.buildColumnGroupExpander=function(e,t){var i=t.expandedFlag;if(!this.elements._columnGroupExpander&&this.elements.container){if(void 0===i)return;var o=e,s=e.layout;this.elements._columnGroupExpander=new n.Element("div",{class:"wux-column-group-expander"}),this.elements.tweakerContainer?this.elements._columnGroupExpander.inject(this.elements.tweakerContainer,"after"):this.elements._columnGroupExpander.inject(this.elements.container,"top"),l.addEventOnElement(this,this.elements._columnGroupExpander,r.POINTERHIT,(function(e,t){var i=e.target;if(i){var n,l=i.getAttribute("expanded");if("true"===l?(n=!1,i.setAttribute("expanded","false")):"false"===l&&(n=!0,i.setAttribute("expanded","true")),void 0!==n)(t=o.getCellInfosFromHtmlElement(i))&&s.setColumnGroupExpandedFlag(t.rowID,t.columnID,n,{isUserInteraction:!0})}}))}t.isExpanderHidden=void 0,this.elements._columnGroupExpander.removeAttribute("expander");var a=t.children?t.children.length:0;if(!0===i||!1===i){for(var u=!1,d=!1,c=!1,h=0;h<a;h++){var g=e.layout.getColumnOrGroupVisibleState(t.children[h]);if(void 0===t.children[h].columnGroupShow&&g){if(u=!0,d||c)break}else if("open"===t.children[h].columnGroupShow&&!1!==t.children[h].visibleFlag){if(d=!0,u||c)break}else if("closed"===t.children[h].columnGroupShow&&!1!==t.children[h].visibleFlag&&(c=!0,d||u))break}!(u&&d||u&&c||d&&c)&&(this.elements._columnGroupExpander.setAttribute("expander","hidden"),t.isExpanderHidden=!0)}!0===i?this.elements._columnGroupExpander.setAttribute("expanded","true"):!1===i?this.elements._columnGroupExpander.setAttribute("expanded","false"):this.elements._columnGroupExpander.setAttribute("expanded","")},t.prototype.getInitialClassName=function(){return e.prototype.getInitialClassName.call(this)+" "+u},t.prototype._applyCustomHeader=function(e){this.customHeader?((this.customHeader.getSelectionCheckBoxContainer||this.customHeader.getFilterViewContainer||this.customHeader.getSortIconContainer)&&(this.elements.buttonsContainer&&this.elements.buttonsContainer.remove(),this.elements.buttonsContainer=void 0,this.elements.leftButtonsContainer&&this.elements.leftButtonsContainer.remove(),this.elements.leftButtonsContainer=void 0,this.elements._columnGroupExpander&&this.elements._columnGroupExpander.remove(),this.elements._columnGroupExpander=void 0,this.elements._selectionCheckBox=void 0),this.elements.tweakerContainer&&this.elements.tweakerContainer.addClassName("wux-datagridview-custom-column-header")):(this._getRightButtonsContainer(),this.elements.tweakerContainer&&this.elements.tweakerContainer.removeClassName("wux-datagridview-custom-column-header"))},t.prototype.clean=function(){this.filterView=void 0,this.elements&&this.elements._selectionCheckBox&&this.customHeader&&this.customHeader.getSelectionCheckBoxContainer&&(this.elements._selectionCheckBox=void 0)},t.prototype.updateSelectionCheckboxState=function(e){var t=this.elements._selectionCheckBox;if(t){var i=t.preventTriggeringChangeEvent;t.preventTriggeringChangeEvent=!0,t.mixedState=e.mixedState,t.checkFlag=e.checkFlag,t.disabled=e.disabled,t.preventTriggeringChangeEvent=i}},t}(i);return function(e){!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.SELECTION_FIRST=1]="SELECTION_FIRST"}(e.COLUMN_HEADERS_LAYOUT||(e.COLUMN_HEADERS_LAYOUT={}))}(d||(d={})),o.addClass(d,"DataGridViewColumnHeaderCell"),d}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/DataGridView/DataGridViewRow",["require","exports","DS/CollectionView/CollectionViewCell","DS/DataGridView/DataGridViewCell","DS/Utilities/ReusableContentsManager","DS/DataGridView/DataGridViewTreeNodeCell","DS/Core/WebUXComponents"],(function(e,t,i,n,o,l,s){"use strict";var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._postBuildView=function(){e.prototype._postBuildView.call(this),this._cellPool=new o;var t=this.collectionView,i=t&&t.cellClass?t.cellClass:n;this._registerPool("__item__",i);var s=t&&t.treeNodeCellOptions&&t.treeNodeCellOptions.cellClass?t.treeNodeCellOptions.cellClass:l;this._registerPool("__tree_item__",s)},t.prototype._registerPool=function(e,t){var i=this;this._cellPool.register({id:e,buildContent:function(){return new t({collectionView:i.collectionView,cellType:e})}})},t.prototype.destroy=function(){e.prototype.destroy.call(this),this._cellPool&&(this._cellPool.destroy(),this._cellPool=null)},t.prototype.getCellPool=function(){return this._cellPool},t.prototype.getInitialClassName=function(){return e.prototype.getInitialClassName.call(this)+" wux-layouts-datagridview-row"},t.prototype.getCleaningMode=function(){return 2},t.prototype.isRow=function(){return!0},t}(i);return s.addClass(r,"DataGridViewRow"),r})),define("DS/DataGridView/DataGridViewDateFilterView",["DS/Utilities/Dom","DS/DataGridView/DataGridViewNumberFilterView","DS/Controls/DatePicker","i18n!DS/DataGridView/assets/nls/translation"],(function(e,t,i,n){"use strict";return t.inherit({name:"datagridviewdatefilterview",publishedProperties:{},buildContentView:function(){var e=this._popupContentDiv;e&&(e.addClassName("wux-datagridview-filter-date"),this._parent())},buildEditor:function(e){return new i(e)},getConditionLabel:function(e){let t="";switch(e){case"range":t=n.get("FilterView_Date_Range");break;case"equal":t=n.get("FilterView_Number_Equals");break;case"notEqual":t=n.get("FilterView_Number_DoesNotEqual");break;case"lessThan":t=n.get("FilterView_Date_LessThan");break;case"lessThanOrEqual":t=n.get("FilterView_Date_LessThanOrEqual");break;case"greaterThan":t=n.get("FilterView_Date_GreaterThan");break;case"greaterThanOrEqual":t=n.get("FilterView_Date_GreaterThanOrEqual");break;case"empty":t=n.get("FilterView_Number_Empty");break;case"notEmpty":t=n.get("FilterView_Number_NotEmpty");break;default:return!0}return t}})})),define("DS/DataGridView/DataGridViewFilterViewManager",["DS/Core/BaseComponent","DS/DataGridView/DataGridViewFilterPopup","DS/DataGridView/DataGridViewStringRegExpFilterView","DS/DataGridView/DataGridViewSetFilterView","DS/DataGridView/DataGridViewDateSetFilterView","DS/DataGridView/DataGridViewNumberFilterView","DS/DataGridView/DataGridViewDateFilterView"],(function(e,t,i,n,o,l,s){"use strict";var r=function(e,i){var n=0,o=this._listOfFilterPopups[e];if(!i)return o&&(o.destroy(),this._listOfFilterPopups[e]=void 0,delete this._listOfFilterPopups[e]),0;if(void 0!==o){if(o.filterId===i.filterId)return o.filterViewOptions=this.view&&this.view.filterViewOptions?this.view.filterViewOptions:void 0,o.refreshView(),3;o.destroy(),this._listOfFilterPopups[e]=void 0,delete this._listOfFilterPopups[e],n=1}return this._listOfFilterPopups[e]=new t({filterViewManager:this,propertyId:e,filterId:i.filterId,filter:i,filterViewOptions:this.view&&this.view.filterViewOptions?this.view.filterViewOptions:void 0}),1+n};return e.inherit({name:"datagridviewfilterviewmanager",publishedProperties:{view:{defaultValue:void 0,type:"object",readOnly:!0},filterManager:{defaultValue:void 0,type:"object"}},registerFilterView:function(e,t){this.FILTERVIEWS_MAP[e]=t},refreshFilterViews:function(){if(this.filterManager){var e=this,t=Object.keys(this._listOfFilterPopups),i=this.filterManager.getFilters();Object.keys(i).forEach((function(n){r.call(e,n,i[n]);var o=t.indexOf(n);-1!==o&&t.splice(o,1)})),t.forEach((function(t){e._listOfFilterPopups[t].destroy(),delete e._listOfFilterPopups[t]}))}},getFilterPopups:function(){return this._listOfFilterPopups},getFilterViews:function(){var e={},t=this;return Object.keys(this._listOfFilterPopups).forEach((function(i){var n=t._listOfFilterPopups[i];if(n){var o=n.getActiveFilterView();o&&(e[i]=o)}})),e},isEmpty:function(){var e=this;return Object.keys(this._listOfFilterPopups).every((function(t){return!e._listOfFilterPopups[t].filter||e._listOfFilterPopups[t].filter.isEmpty()}))},disableUpdateView:function(){this._preventUpdateView++},enableUpdateView:function(){this._preventUpdateView--},getFilterViewClassName:function(e){return this.FILTERVIEWS_MAP[e]},_build:function(){this.FILTERVIEWS_MAP={set:n,dateSet:o,stringStdexp:i,stringRegexp:i,numberWithCondition:l,dateWithCondition:s},this._listOfFilterPopups={},this._onFilterModelChangeToken=void 0,this._preventUpdateView=0},_applyFilterManager:function(e){var t=this;this._onFilterModelChangeToken&&e&&e.unsubscribe(this._onFilterModelChangeToken);var i=Object.keys(this._listOfFilterPopups);i.length>0&&i.forEach((function(e){t._listOfFilterPopups[e].destroy(),delete t._listOfFilterPopups[e]})),this.filterManager&&(this._onFilterModelChangeToken=this.filterManager.subscribe("filterModelChange",(function(e){t._preventUpdateView>0||(e?r.call(t,e.propertyId,e.filter):t.refreshFilterViews())})),this.refreshFilterViews())},_applyProperties:function(e){this._parent(e),this.isDirty("filterManager")&&this._applyFilterManager(e.filterManager)}})})),define("DS/DataGridView/DataGridViewLayout",["DS/CollectionView/layouts/CollectionViewGridLayout","DS/DataGridView/ColumnModel","DS/Utilities/Utils","DS/Utilities/TreeUtils","DS/TreeModel/ModelUtils","DS/Utilities/Dom","DS/TreeModel/TreeNodeModel"],(function(e,t,i,n,o,l,s){"use strict";const r=26,a="wux-collectionView-dataGridView",u=e.inherit({name:"CollectionViewDataGridLayout",publishedProperties:{columns:{defaultValue:[],type:"array"},cellWidth:{defaultValue:100,type:"integer"},cellHeight:{defaultValue:r,type:"integer"},rowMaxHeight:{defaultValue:void 0,type:"integer"},layoutDensity:{defaultValue:"compact",type:"string"},columnsHeader:{defaultValue:!0,type:"boolean"},columnHeaderHeight:{defaultValue:27,type:"integer"},rowsHeader:{defaultValue:!0,type:"boolean"},rowSpacing:{defaultValue:0,type:"integer"},addCellCoordinates:{defaultValue:!1,type:"boolean"},useLastColumnWidthAutoFlag:{defaultValue:!1,type:"boolean"},preferencesToApply:{defaultValue:void 0,type:"string",readOnly:!0}},init:function(e){this._parent(e),this._columnModel=new t,this._leafColumnsCount=0,this._computedColumnsLayout=[],this._computedRows=[],this._computedHeadersHeights=new Map,this._columnHeaderCellCount=3+(this.rowsHeader?1:0)},destroy:function(){this._columnModel=null,this._parent()},_invalidate:function(e){if(e&&e.postUpdateCellWidth){const e=this.getColumnModel();e&&e.getFitAllContentIndexes().forEach((e=>{this._setFitContentColumnComputedWidth(e,void 0)})),e&&e.getFitVisibleContentIndexes().forEach((e=>{this._setFitContentColumnComputedWidth(e,void 0)}))}return this._parent(e)},_applyProperties:function(e){this._parent(e),this.isDirty("layoutDensity")&&this._applyLayoutDensity(e.layoutDensity)},prepareLayout:function(){const e=this.rowsHeader,t=this.getLeafColumns();this._leafColumnsCount=t.length+(e?1:0);let i=this._columnModel?this._columnModel.getColumnTreeItemCount():0;this._columnHeaderCellCount=i+(e?1:0)+3,this._computeColumnsWidth(),this._leftPinnedRowColumnID=e?-4:-3,this._unpinnedRowColumnID=e?-3:-2,this._rightPinnedRowColumnID=e?-2:-1,this._isInvalid=!1},_applyColumns:function(e,t){if(this._columnModel){this._columnModel.setColumns(this.columns,this.collectionView.defaultColumnDef);let e=this.rowsHeader,t=this._columnModel.getLeafColumns();this._leafColumnsCount=t.length+(e?1:0);let i=this._columnModel.getColumnTreeItemCount();this._columnHeaderCellCount=i+(e?1:0)+3;let n=this._columnModel.getAutoHeaderHeightColumnIndexes();if(this._columnModel.hasColumnWithAutoRowHeightFlag()||n.length>0)if(this.getRowHeightFunction)this.resetRowHeights();else{this.collectionView.virtuallyLoadAllModelItems&&this.collectionView._rowModel&&this.collectionView._rowModel._isServerSide()?(console.warn("Warning, autoRowHeightFlag is not supported with 'virtuallyLoadAllModelItems' mode. You should implement getRowHeightFunction function on DataGridView layout options"),this.getRowHeightFunction=null):this.getRowHeightFunction=this.getRowHeightFromCellContents}else this.getRowHeightFunction===this.getRowHeightFromCellContents&&(this.getRowHeightFunction=null);for(let e=0,i=t.length;e<i;e++){let i=t[e];i&&i.customHeader&&this.collectionView._registerColumnHeaderReusableCellContent(i)}this._columnModel.getFitAllContentIndexes().forEach((e=>{const t=this.getColumnMinWidth(e);this._setFitContentColumnComputedWidth(e,t)})),this._columnModel.getFitVisibleContentIndexes().forEach((e=>{const t=this.getColumnMinWidth(e);this._setFitContentColumnComputedWidth(e,t)}))}this._computeColumnsWidth(),this._applyPreferencesOnColumns(),(e&&e.length>0||t)&&this.invalidate({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})},applyColumns:function(){this.collectionView.prepareUpdateView(),this._applyColumns(),this.invalidate({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}),this.collectionView.pushUpdateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0},!0)},getColumnModel:function(){return this._columnModel},getColumnOrGroup:function(e,t){return this._columnModel?this._columnModel.getColumnOrGroup(e,t):null},_applyRowsHeader:function(e,t){this.invalidate({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})},getDefaultCellHeight:function(){return this.collectionView._getCurrentTouchMode()||"comfortable"===this.layoutDensity?40:r},_applyCellHeight:function(e,t){t<r?this.cellHeight=r:this.resetRowHeights()},_applyRowMaxHeight:function(e,t){t<r?this.rowMaxHeight=r:this.resetRowHeights()},_applyLayoutDensity:function(e,t){if(!this.collectionView||!this.collectionView._isCurrentlyCalledFromUIInteraction()&&!this.collectionView._currentlyCalledFromApplyPreferencesFlag){this._originalLayoutDensity=this.layoutDensity;let e=this.collectionView?this.collectionView.getCustomViewsManager():null;e&&e.setOriginalLayoutDensity(this._originalLayoutDensity)}this.collectionView&&this.collectionView.getContent()&&(this.collectionView.getContent().setAttribute("layout-density",this.layoutDensity),this.collectionView._applyMaxVisibleRowCount(void 0,this.collectionView.maxVisibleRowCount,!0)),this.invalidate({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})},_getOriginalLayoutDensity:function(){return this._originalLayoutDensity||this.layoutDensity},_applyColumnsHeader:function(e,t){this.invalidate({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})},_applyColumnHeaderHeight:function(e,t){t<27?this.columnHeaderHeight=27:(this.collectionView&&this.collectionView._applyMaxVisibleRowCount(),this.invalidate({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!1}))},_applyRowSpacing:function(e,t){this.invalidate({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})},_applyAddCellCoordinates:function(e,t){this.invalidate({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})},_applyUseLastColumnWidthAutoFlag:function(e,t){this.invalidate({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})},getLeafColumns:function(){return this._columnModel?this._columnModel.getLeafColumns():[]},getVisibleOrderedLeafColumns:function(){var e=[],t=this.getLeafColumns(),i=this.getVisibleOrderedColumnsIndexes();if(i)for(var n=0;n<i.length;n++){var o=t[i[n]];o&&e.push(o)}return e},getColumnOptionValue:function(e,t){return this._columnModel?this._columnModel.getColumnOptionValue(e,t):void 0},getOrderedColumnsIndexes:function(){return this._columnModel?this._columnModel.getOrderedColumnsIndexes():[]},getOrderedColumnsReverseIndexes:function(){return this._columnModel?this._columnModel.getOrderedColumnsReverseIndexes():[]},hasCellsInLeftContainer:function(){return void 0!==this._firstLeftPinnedColumnIndex},hasCellsInRightContainer:function(){return void 0!==this._firstRightPinnedColumnIndex},_computeColumnsWidth:function(){if(this._isComputingColumnsWidth)return;this._isComputingColumnsWidth=!0,this._firstUnpinnedColumnIndex=void 0,this._lastUnpinnedColumnIndex=void 0,this._firstLeftPinnedColumnIndex=void 0,this._lastLeftPinnedColumnIndex=void 0,this._firstRightPinnedColumnIndex=void 0,this._lastRightPinnedColumnIndex=void 0;const e=this.collectionView.getViewportDimensions();let t=this.collectionView.getDimensions();const n=this._getEstimatedVirtualHeight(!0)>e.height?i.getScrollbarWidth():0;let o=t.width-n-(this.rowsHeader?this.getRowHeaderWidth():0);this.getRightContainerWidth()>0&&o--,this.getLeftContainerWidth()>0&&o--;let l,s=this._columnModel?this._columnModel.getOrderedColumnsIndexes():[];if(this.useLastColumnWidthAutoFlag){let e=this.getColumnIndex("ContextualMenuColumn");for(let t=s.length-1;t>=0;t--){let i=s[t];if(i!==e){if(this.getColumnVisibleState(i)){let e=this.getColumnPinned(i);if("right"!==e&&"left"!==e){l=i;break}}}}}let r=0;const a=this.getLeafColumns();for(let e=0,i=a.length;e<i;e++){let i=!1,n=this.getColumnVisibleState(e),s=this.getColumnWidth(e);const u=this.isAFitToContentColumn(e);void 0===s&&(s="auto"),this.useLastColumnWidthAutoFlag&&e===l&&o>0&&!u&&(s="auto");let d=0;a[e].customHeader&&n&&(d=this._computeRenderedHeaderMinWidth(a[e].dataIndex));let c=this.getColumnMinWidth(e);if(n){if("string"==typeof s)if(u){const t="fitAllContent"===s;s=this._getFitContentColumnComputedWidth(e),!s&&this.collectionView._isReady&&(s=this.collectionView._computeColumnWidth(e,{computeAllRows:t}),"number"!=typeof s&&(s=this.getColumnMinWidth(e)),this._setFitContentColumnComputedWidth(e,s)),this.useLastColumnWidthAutoFlag&&e===l&&o>0&&s<o&&(s=o)}else"auto"===s?(s=0,i=!0,r++):s=s.indexOf("%")>-1?Math.floor(t.width*(parseInt(s,10)/100)):parseInt(s,10);s=Math.max(0,s),c&&!i&&(s=Math.max(c,s)),d&&"number"==typeof d&&(s=Math.max(s,d))}else s=0;o-=s,this._setColumnComputedWidth(e,s)}let u=this.cellWidth,d=0,c=0,h=0,g=0;for(let e=0;e<s.length;e++){let t=s[e],i=this.getColumnMinWidth(t),n=this.getColumnVisibleState(t),a=this.getColumnWidth(t);const p=this.isAFitToContentColumn(e);p&&(a=this.getColumnComputedWidth(t)),this.useLastColumnWidthAutoFlag&&t===l&&(o>0?p||(a="auto"):"number"==typeof a&&this._setColumnComputedWidth(t,a));let m=this.getColumnPinned(t);if("auto"===a&&n){let e=Math.floor(o/(r-g)),n=Math.max(u,e);i&&(n=Math.max(i,n)),o-=n,this._setColumnComputedWidth(t,n),g++}let f=0,C=this.getColumnComputedWidth(t);"left"===m?(f=d,d+=C,void 0===this._firstLeftPinnedColumnIndex&&n&&(this._firstLeftPinnedColumnIndex=t),n&&(this._lastLeftPinnedColumnIndex=t)):"right"===m?(f=c,c+=C,void 0===this._firstRightPinnedColumnIndex&&n&&(this._firstRightPinnedColumnIndex=t),n&&(this._lastRightPinnedColumnIndex=t)):(f=h,h+=C,void 0===this._firstUnpinnedColumnIndex&&n&&(this._firstUnpinnedColumnIndex=t),n&&(this._lastUnpinnedColumnIndex=t)),this._setColumnPosition(t,f)}this._isComputingColumnsWidth=!1},_setColumnPosition:function(e,t){this._computedColumnsLayout[e]||(this._computedColumnsLayout[e]={}),this._computedColumnsLayout[e].position=t},getColumnPosition:function(e){return this._computedColumnsLayout[e]?this._computedColumnsLayout[e].position:0},getColumnOrGroupPosition:function(e){var t=0;return e&&(t=e.children?this.getColumnOrGroupPosition(e.children[0]):this.getColumnPosition(this.getColumnIndex(e.dataIndex))),t},moveColumn:function(e,t,i){var n=this.getLeafColumns()[this.getColumnIndex(e)];return this.moveColumnOrGroup(n,t,i)},moveColumnOrGroup:function(e,t,i){let o=!1;if(!this._columnModel||!e)return!1;var l=n.getLeafItems(e);let s=this._columnModel.getColumnTreeItemCount(),r=this._columnModel.getFirstLeafColumnIndex(e),a=this._columnModel.getLastLeafColumnIndex(e),u=this._columnModel.getPreviousVisibleColumnID(r),d=this._columnModel.getNextVisibleColumnID(a);if(o=this._columnModel.moveColumnOrGroup(e,t,i),o){let n=this.getColumnPinned(t),o=this._columnModel.getOrderedColumnsIndexes(),a=this.getOrderedColumnsReverseIndexes(),p=a[r]<a[u]?r:d,m=a[r]<a[u]?u:r;for(let e=a[p];e<=a[m];e++){let t=o[e];if(this.getColumnVisibleState(t)){this.getColumnPinned(t)===n&&this.collectionView._freeUpColumnCells(t,1)}}if(i&&i.isUserInteraction){for(var c=0;c<l.length;c++)this._saveColumnOrderInPreferences(l[c].dataIndex);this._updateAllOrderInPreferences(e)}this.collectionView._updateColumnHeaderCells({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0});var h=!1;this._columnModel.getColumnTreeItemCount()!==s&&(h=!0);var g=!1;this.collectionView._draggedColumnOrGroup&&(g=!0),this.invalidate({updateCellContent:h,updateCellLayout:!0,updateCellAttributes:g}),this.collectionView.fire("columnOrderChange")}return o},getColumnShowTextFlag:function(e){return this.getColumnOptionValue(e,"showTextFlag")},getColumnAutoRowHeightFlag:function(e){return this.getColumnOptionValue(e,"autoRowHeightFlag")},setColumnAutoRowHeightFlag:function(e,t){var i=this.getColumnIndex(e),n=this.getLeafColumns();n[i].autoRowHeightFlag!==t&&(n[i].autoRowHeightFlag=t,this.applyColumns())},getColumnVisibleState:function(e){return!!this._columnModel&&this._columnModel.getColumnVisibleState(e)},getColumnVisibleFlag:function(e){return!!this._columnModel&&this._columnModel.getColumnVisibleFlag(e)},setColumnVisibleFlag:function(e,t,i){var n=this.getColumnIndex(e);if(!(n<0||void 0===n)){var o=this.getLeafColumns();if(o[n].visibleFlag!==t){if(!t&&this.getColumnAlwaysVisibleFlag(e))return;o[n].visibleFlag=t;let i=!!this._columnModel&&this._columnModel.hasAutoWidthColumnWithAutoRowHeightFlag();(this.getColumnAutoRowHeightFlag(n)||i)&&this.resetRowHeights({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!0}),t&&this.collectionView.requestDelayedModelData("OnShowColumn"),o[n].customHeader&&this.resetRowHeight(-1),this.getColumnAutoRowHeightFlag(n)||i||this.invalidate({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!0}),this.collectionView._updateAutoWidthStyle(),this.collectionView.findStr&&""!=this.collectionView.findStr&&!this.collectionView._muteFind&&this.collectionView.setFindStr(this.collectionView.findStr,this.collectionView.matchCase,this.collectionView._currentMatchingStringIndex,!0,!0),this.collectionView.fire("columnVisibleStateChange",{visibleState:t,columnID:e});var l=o[n]._parent;if(l&&void 0!==l.expandedFlag){var s=this.getColumnOrGroupCellCoordinates(l);this.collectionView.updateCellView(this.getCellIDFromCoordinates(s),{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}}i&&i.isUserInteraction&&this._saveColumnVisibleFlagInPreferences(n)}},_resetComputedRows:function(){this._computedHeadersHeights&&this._computedHeadersHeights.clear(),this._parent()},resetRowHeights:function(e){this._parent(e),this.collectionView&&this.collectionView._applyMaxVisibleRowCount()},resetRowHeight:function(e){if(e<0){let n=this._computedHeadersHeights.get(e);if(n){var t=n;if(this._computedHeadersHeights.set(e,void 0),this._computeColumnHeadersHeight(e)!==t){for(var i=e+1;i<0;i++)this._computedHeadersHeights.get(i)&&this._computedHeadersHeights.set(i,void 0);this.invalidate({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!0})}}}else this._parent(e),this.collectionView&&this.collectionView._applyMaxVisibleRowCount()},getColumnAlwaysVisibleFlag:function(e){return!!this._columnModel&&this._columnModel.getColumnAlwaysVisibleFlag(e)},getColumnOrGroupVisibleState:function(e){return!!this._columnModel&&this._columnModel.getColumnOrGroupVisibleState(e)},getColumnOrGroupSelectableState:function(e){var t=!1;if(e&&this.getColumnOrGroupVisibleState(e))if(e.children)for(var i=0;i<e.children.length;i++){var n=e.children[i];if(t=this.getColumnOrGroupSelectableState(n))break}else t=this.getColumnSelectableFlag(e.dataIndex);return t},getColumnOrGroupPrintableState:function(e){var t=!1;if(e&&this.getColumnOrGroupVisibleState(e))if(e.children)for(var i=0;i<e.children.length;i++){var n=e.children[i];if(t=this.getColumnOrGroupPrintableState(n))break}else t=this.getColumnPrintableFlag(e.dataIndex);return t},_getVisibleLeafCount:function(e){var t=0;if(e&&e.children)for(var i=0;i<e.children.length;i++){var n=e.children[i];n.children?t+=this._getVisibleLeafCount(n):this.getColumnOrGroupVisibleState(n)&&t++}return t},setColumnOrGroupProperties:function(e,t){var i=this.getColumnOrGroup(e);if(!t)return;const o=["text","icon","showTextFlag","resizableFlag","selectableFlag","autoSizePadding"],l=["dataIndex","editableFlag","editionPolicy","disabled","semantics","getCellValue","setCellValue","getCellValueForSort","getCellValueForExport","getCellGroupingKey","getCellTooltip","getCellSemantics","getCellKPIColor","getCellEditableState","getCellSelectableState","description","getCellTypeRepresentation","allowUnsafeHTMLContent","shouldCellAllowUnsafeHTMLContentAt","className","getCellClassName","getCellIcons","hasCellValue"],s=["children","columnGroupShow","alwaysVisibleFlag"],r=["groupableFlag","printableFlag","splittableFlag","massUpdateAllowedFlag","sortableFlag","findableFlag"];if(i){this.collectionView.prepareUpdateView();let c=!1,h=!1;for(const e of o)t.hasOwnProperty(e)&&(i[e]=t[e],h=!0);if(h){let e=this.getColumnOrGroupCellCoordinates(i);this.collectionView.updateRowView(e.rowID,{updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!1})}if(t.hasOwnProperty("expandedFlag")){var a=this.getColumnOrGroupCellCoordinates(i);this.setColumnGroupExpandedFlag(a.rowID,a.columnID,t.expandedFlag)}if(t.hasOwnProperty("pinned")&&this.setColumnPinned(e,t.pinned),t.hasOwnProperty("minWidth")&&this.setColumnMinWidth(e,t.minWidth),t.hasOwnProperty("width")&&this.setColumnWidth(e,t.width),t.hasOwnProperty("typeRepresentation")&&this.setColumnTypeRepresentation(e,t.typeRepresentation),t.hasOwnProperty("visibleFlag")&&this.setColumnVisibleFlag(e,t.visibleFlag),t.hasOwnProperty("autoRowHeightFlag")&&this.setColumnAutoRowHeightFlag(e,t.autoRowHeightFlag),t.hasOwnProperty("wrappableFlag")&&(i.wrappableFlag=t.wrappableFlag),t.hasOwnProperty("alignment")){var u=this.getColumnIndex(e);if(u<0)return;var d=this.getLeafColumns();d[u].alignment!==t.alignment&&(d[u].alignment=t.alignment),c=!0}for(const e of l)t.hasOwnProperty(e)&&(i[e]=t[e],c=!0);let g=!1;for(const e of s)t.hasOwnProperty(e)&&(i[e]=t[e],g=!0,"children"===e&&n.processTreeChildren(this.columns,(function(n){n.dataIndex===i.dataIndex&&(n.children=t[e])})));g&&this.applyColumns();for(const e of r)t.hasOwnProperty(e)&&(i[e]=t[e]);c&&this.collectionView.updateColumnView(e,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),this.collectionView.pushUpdateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}),t.hasOwnProperty("customHeader")&&(i.customHeader=t.customHeader,this.applyColumns(),this.resetRowHeight(-1))}},getColumnEditableFlag:function(e){return this.getColumnOptionValue(e,"editableFlag")},getColumnEditionPolicy:function(e){return this.getColumnOptionValue(e,"editionPolicy")},getColumnDisabled:function(e){return this.getColumnOptionValue(e,"disabled")},getColumnResizableFlag:function(e){return this.getColumnOptionValue(e,"resizableFlag")},getColumnSelectableFlag:function(e){return this.getColumnOptionValue(e,"selectableFlag")},getColumnSortableFlag:function(e){return this.getColumnOptionValue(e,"sortableFlag")},getColumnFindableFlag:function(e){return this.getColumnOptionValue(e,"findableFlag")},getColumnPrintableFlag:function(e){return this.getColumnOptionValue(e,"printableFlag")},getColumnMassUpdateAllowedFlag:function(e){return this.getColumnOptionValue(e,"massUpdateAllowedFlag")},getColumnCompareFunction:function(e){return this.getColumnOptionValue(e,"compareFunction")},getColumnIcon:function(e){return this.getColumnOptionValue(e,"icon")},getColumnWidth:function(e){let t=this._columnModel?this._columnModel.getColumnWidth(e):"auto";return this.collectionView.dataSource&&"fitAllContent"===t&&(t="auto"),t},_setColumnWidth:function(e,t,i,n){if(isNaN(t)&&"auto"!==t)return void console.log("The width given for column "+e+" is not a Number or not supported");if(this.isAFitToContentColumn(e))return;let o=t;var l=this.getColumnIndex(e),s=this.getLeafColumns(),r=this.getColumnMinWidth(l);if(r&&"number"==typeof t&&(t=Math.max(t,r)),s[l].width!==t||!n){n&&(s[l].width=o),"number"==typeof t?this._setColumnComputedWidth(l,t):this._computeColumnsWidth();var a=this.getColumnPinned(l);"left"!==a&&"right"!==a||this.collectionView._updateViewportDimensions();let r=!!this._columnModel&&this._columnModel.hasAutoWidthColumnWithAutoRowHeightFlag();i&&!i.isUserInteraction&&(this.getColumnAutoRowHeightFlag(l)||r)?this.resetRowHeights():this.invalidate({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1}),e===this._lastLeftPinnedColumnIndex&&this.collectionView.elements.leftScroller?this.collectionView.elements.leftScroller.setPosition({x:this.getLeftContainerWidth()},!0):e===this._firstRightPinnedColumnIndex&&this.collectionView.elements.rightScroller&&this.collectionView.elements.rightScroller.setPosition({x:0},!0),"left"!==a&&"right"!==a&&this.collectionView._updateAutoWidthStyle(),this.collectionView.fire("columnWidthChange",{columnID:e})}i&&i.isUserInteraction&&this._saveColumnWidthInPreferences(l)},setColumnWidth:function(e,t,i){this._setColumnWidth(e,t,i,!0)},setColumnOrGroupWidth:function(e,t){if(!e.children||0===e.children.length){var i=this.getColumnOrGroupCellCoordinates(e);return this.setColumnWidth(i.columnID,t)}for(var n=0,o=[],l=0;l<e.children.length;l++)this._isColumnOrGroupResizable(e.children[l],t)?(n++,o.push(1)):o.push(0);if(0!==n)for(var s=(t-this.getColumnOrGroupComputedWidth(e))/n,r=0;r<o.length;r++)1===o[r]&&this.setColumnOrGroupWidth(e.children[r],this.getColumnOrGroupComputedWidth(e.children[r])+s)},_isColumnOrGroupResizable:function(e,t){if(e.children){for(var i=0;i<e.children.length;i++){var n=e.children[i];if(this._isColumnOrGroupResizable(n,t))return!0}return!1}var o=this.getColumnMinWidth(e.dataIndex);return o&&"string"==typeof o&&(o=parseFloat(o,10)),!1!==e.resizableFlag&&(!o||o<=t)},setColumnsWidth:function(e,t){for(var i=this.getLeafColumns(),n=Object.keys(e),o=[],l=!1,s=!1,r=0;r<n.length;r++){var a=n[r],u=e[a];if(isNaN(u)&&"auto"!==u)return void console.log("The width given for column "+columnID+" is not a Number");var d=this.getColumnIndex(a),c=this.getColumnMinWidth(d);if(c&&"number"==typeof u&&(u=Math.max(u,c)),i[d].width!==u){if(i[d].width=u,"number"==typeof u?this._setColumnComputedWidth(d,u):this._computeColumnsWidth(),!l){var h=this.getColumnPinned(d);"left"!==h&&"right"!==h||(l=!0)}let e=!!this._columnModel&&this._columnModel.hasAutoWidthColumnWithAutoRowHeightFlag();s||!t||t.isUserInteraction||!this.getColumnAutoRowHeightFlag(d)&&!e||(s=!0),t&&t.isUserInteraction&&this._saveColumnWidthInPreferences(d),o.push(a)}}l&&this.collectionView._updateViewportDimensions(),this.collectionView._updateAutoWidthStyle(),s?this.resetRowHeights():this.invalidate({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1}),this.collectionView.fire("columnWidthChange",{columnIDs:o})},_setColumnComputedWidth:function(e,t){this._computedColumnsLayout[e]||(this._computedColumnsLayout[e]={}),this._computedColumnsLayout[e].width=t},_setFitContentColumnComputedWidth:function(e,t){this._computedColumnsLayout[e]||(this._computedColumnsLayout[e]={}),this._computedColumnsLayout[e].fitContentColumnWidth=t},_getFitContentColumnComputedWidth:function(e){if(this._computedColumnsLayout[e])return this._computedColumnsLayout[e].fitContentColumnWidth},isAFitToContentColumn:function(e){const t=this.getColumnWidth(e,"width");return(!this.collectionView.dataSource||"fitAllContent"!==t)&&("fitAllContent"===t||"fitVisibleContent"===t)},getColumnComputedWidth:function(e){var t=this.getColumnIndex(e);if(-1===t)return this.rowsHeader?this.getRowHeaderWidth():0;var i=this._computedColumnsLayout[t]?this._computedColumnsLayout[t].width:0;return void 0===i||isNaN(i)?0:i},getColumnOrGroupComputedWidth:function(e){var t=0;if(e)if(e.children)for(var i=0;i<e.children.length;i++){var n=e.children[i];t+=this.getColumnOrGroupComputedWidth(n)}else t=this.getColumnComputedWidth(e.dataIndex);return t},getColumnMinWidth:function(e){return this.getColumnOptionValue(e,"minWidth")},setColumnMinWidth:function(e,t){if(void 0!==t&&isNaN(t))return;let i=this.getColumnIndex(e);if(i<=-1)return;let n=this.getLeafColumns()[i];n.minWidth!==t&&(n.minWidth=t,this._setColumnWidth(e,this.getColumnComputedWidth(e),void 0,!1))},getColumnPinned:function(e){return this._columnModel?this._columnModel.getColumnPinned(e):"unpinned"},setColumnPinned:function(e,t,i){var n=this.getLeafColumns();if(n){var o=this.getColumnIndex(e);this.setColumnOrGroupPinned(n[o],t,i)}},setColumnOrGroupPinned:function(e,t,i){if(!this._columnModel)return!1;let o=n.getLeafItems(e);i||(i={}),i.unpinnedColumnOrderInPreferences=this._getUnpinnedColumnsOrderInPreferences();let l=this._columnModel.setColumnOrGroupPinned(e,t,i);if(l>0&&(this.collectionView._updateAutoWidthStyle(),this.collectionView._updateViewportDimensions(),this.invalidate({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})),l>=0&&i&&i.isUserInteraction){for(var s=0;s<o.length;s++){var r=this.getColumnIndex(o[s].dataIndex);this._saveColumnPinnedStateInPreferences(r),this._saveColumnOrderInPreferences(r)}this._updateAllOrderInPreferences()}return l},getColumnOrGroupPinned:function(e){return this._columnModel?this._columnModel.getColumnOrGroupPinned(e):"unpinned"},setColumnWrap:function(e,t){if(!this._columnModel)return;if(t===this.getColumnWrap(e))return;let i=this.getColumnOrGroup(e);if(i){this._columnModel.setColumnWrap(i,t)&&(this.setColumnAutoRowHeightFlag(e,"wrap"===t),this.resetRowHeights(),this.collectionView.fire("columnWrapChange",{wrapFlag:i.useWrappedView,columnID:e}))}},getColumnWrap:function(e){let t="no-wrap";if(!this._columnModel)return t;let i=this.getColumnOrGroup(e);return i?this._columnModel.getColumnWrap(i):t},getColumnAutoSizePadding:function(e){return this.getColumnOptionValue(e,"autoSizePadding")},getColumnAllowUnsafeHTMLContent:function(e){return this.getColumnOptionValue(e,"allowUnsafeHTMLContent")},getColumnWrappableFlag:function(e){return this.getColumnOptionValue(e,"wrappableFlag")},getColumnShouldCellAllowUnsafeHTMLContentAt:function(e){return this.getColumnOptionValue(e,"shouldCellAllowUnsafeHTMLContentAt")},getColumnTypeRepresentation:function(e){return this._columnModel?this._columnModel.getColumnTypeRepresentation(e):"string"},getColumnGetCellTypeRepresentation:function(e){return this.getColumnOptionValue(e,"getCellTypeRepresentation")},_getCellTypeRepresentation:function(e){if(e){if(e.nodeModel&&e.nodeModel.getNodeSource()===s.NODE_SOURCE.GROUPING)if("tree"===this.getDataIndexFromColumnIndex(e.columnID))return"string";var t=this.getColumnGetCellTypeRepresentation(e.columnID);return t?t.call(this.collectionView,e):void 0}},setColumnTypeRepresentation:function(e,t){var i=this.getColumnIndex(e),n=this.getLeafColumns();n[i].typeRepresentation!==t&&(n[i].typeRepresentation=t,this.getColumnAutoRowHeightFlag(e)&&this.collectionView._resetRowHeightsOnAllCellsRendered(),this.collectionView.updateColumnView(i,{updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}))},getColumnIsCellMatchingFind:function(e){this.getColumnIndex(e);return this.getColumnOptionValue(e,"isCellMatchingFind")},getColumnGetFindPositionsInCellString:function(e){this.getColumnIndex(e);return this.getColumnOptionValue(e,"getFindPositionsInCellString")},getColumnOnCellRequest:function(e){return this.getColumnOptionValue(e,"onCellRequest")},getColumnGetCellEditableState:function(e){return this.getColumnOptionValue(e,"getCellEditableState")},getColumnGetCellSelectableState:function(e){return this.getColumnOptionValue(e,"getCellSelectableState")},getColumnGetCellActivableState:function(e){return this.getColumnOptionValue(e,"getCellActivableState")},getColumnGetCellGroupingKey:function(e){return this.getColumnOptionValue(e,"getCellGroupingKey")},getColumnHasCellValue:function(e){return this.getColumnOptionValue(e,"hasCellValue")},getColumnGetCellValue:function(e){return this.getColumnOptionValue(e,"getCellValue")},getColumnSetCellValue:function(e){return this.getColumnOptionValue(e,"setCellValue")},getColumnGetCellTooltip:function(e){return this.getColumnOptionValue(e,"getCellTooltip")},getColumnGetCellIcons:function(e){return this.getColumnOptionValue(e,"getCellIcons")},getColumnGetCellSemantics:function(e){return this.getColumnOptionValue(e,"getCellSemantics")},getColumnSemantics:function(e){return this.getColumnOptionValue(e,"semantics")},getColumnGetCellKPIColor:function(e){return this.getColumnOptionValue(e,"getCellKPIColor")},getColumnClassName:function(e){return this.getColumnOptionValue(e,"className")},getColumnGetCellClassName:function(e){return this.getColumnOptionValue(e,"getCellClassName")},getColumnGetCellAttributes:function(e){return this.getColumnOptionValue(e,"getCellAttributes")},_getNumberOfColumnsToTheLeft:function(){return this._columnModel?this._columnModel.getNumberOfColumnsToTheLeft():{left:0,unpinned:0,right:0}},getVisibleOrderedColumnsIndexes:function(){return this._columnModel?this._columnModel.getVisibleOrderedColumnsIndexes():[]},getDisplayedColumnsIndexes:function(){if(!this._columnModel)return[];for(var e=-1,t=-1,i=this.collectionView.getViewportDimensions(),n=this.collectionView.getScrollerPosition(),o=n.x,l=n.x+i.width,s=this.getVisibleOrderedColumnsIndexes(),r=0;r<s.length;r++){var a=s[r],u=this.getColumnPinned(a);if("left"!==u&&"right"!==u){var d=this.getColumnPosition(a);if(d<=o&&(e=a),!(d<l))break;t=a}}var c=[];if(e>=0&&t>=0)for(var h=!0,g=e;g>=0&&h;){if(c.push(g),g===t){h=!1;break}g=this._columnModel.getNextVisibleColumnID(g)}return this._columnModel.getListOfVisiblePinnedColumnIDs("left").concat(c).concat(this._columnModel.getListOfVisiblePinnedColumnIDs("right"))},_getNumberOfInvisibleColumnsBetween:function(e,t){var i=Math.min(e,t),n=Math.max(e,t),o=0;let l=this._columnModel?this._columnModel.getOrderedColumnsIndexes():[];for(var s=i+1;s<n;s++)this.getColumnVisibleState(l[s])||o++;return o},_getLeafColumnsCount:function(){return this._leafColumnsCount},_getLeafChildrenFromGroup:function(e){if(!e)return[];let t=[],i=this.getLeafColumns();if(e.children)for(let i=0;i<e.children.length;i++)t=t.concat(this._getLeafChildrenFromGroup(e.children[i]));else i.indexOf(e)>-1&&t.push(e);return t},_getColumnHeaderCellCount:function(){return this._columnHeaderCellCount},getRowHeaderWidth:function(){var e=this.collectionView._getCurrentTouchMode(),t=this._cachedRowHeaderStringWidth?this._cachedRowHeaderStringWidth:0,i=this.collectionView.showSelectionCheckBoxesFlag;if(this.collectionView.showRowIndexFlag){if(this.isValid()&&this.collectionView.getModelLength()>0){var n=this.getMinMaxVisibleRowIDs();if(n){var o=this.collectionView.getCellInfosAt(this.getCellIDFromCoordinates({rowID:n.maxRowID,columnID:-1}));if(o){var s=12;e&&(s=14);t=4+Math.ceil(l.computeStringWidth(o.cellModel,s,"Arial",!1,!1))+4}}this._cachedRowHeaderStringWidth=t}i&&(e||"OnOver"!==i?t+=e?30:22:"OnOver"===i&&(t=Math.max(t,22)))}else this._cachedRowHeaderStringWidth=void 0,i&&(t=e?30:22);if(this.collectionView.showNodeKPIColorFlag&&(t+=6),this.collectionView.rowDragEnabledFlag&&(t+=e?20:16),i||this.collectionView.showRowIndexFlag||this.collectionView.rowDragEnabledFlag||!this.collectionView.showNodeKPIColorFlag){var r=this.collectionView._getCurrentTouchMode()?34:24;t=Math.max(t,r)}return t},_getXSORectangularShape:function(){let e=this.collectionView.getCellsXSO();if(e.isEmpty())return;let t,i,n,o,l,s,r=e.get(),a=this.getOrderedColumnsReverseIndexes();for(let e=0;e<r.length;e++){let u=r[e];if(u){let e={rowID:u.rowID,columnID:this.getColumnIndex(u.columnDataIndex)};if(void 0===t)o=a[e.columnID],i=a[e.columnID],l=e.columnID,s=e.columnID,n=e.rowID,t=e.rowID;else{let r=a[e.columnID];r>o&&(o=r,l=e.columnID),r<i&&(i=r,s=e.columnID),e.rowID>n&&(n=e.rowID),e.rowID<t&&(t=e.rowID)}}}let u=this._getNumberOfInvisibleColumnsBetween(s,l);return(o+1-i-u)*(n+1-t)===r.length?{minColumnID:s,width:o-i+1-u,minRowID:t,height:n-t+1}:void 0},getDataIndexFromColumnIndex:function(e){return this._columnModel?this._columnModel.getDataIndexFromColumnIndex(e):""},getColumnIndex:function(e){return this._columnModel?this._columnModel.getColumnIndex(e):-1},getColumnIdentifiers:function(e){return this._columnModel?this._columnModel.getColumnIdentifiers(e):{dataIndex:void 0,columnIndex:void 0}},getRowHeightFromCellHeight:function(){var e=this.getDefaultCellHeight();return Math.max(this.cellHeight,e)},getRowHeightFromCellContents:function(e){let t=this.getRowHeightFromCellHeight();if(this._columnModel){let o=e>=0?this._columnModel.getAutoRowHeightColumnIndexes():this._columnModel.getAutoHeaderHeightColumnIndexes();if(o)for(var i=0;i<o.length;i++){var n=o[i];if(this.getColumnVisibleState(n)){let i=this._computeRenderedCellHeight(e,n);t<i&&(t=i)}}}return t},_computeRenderedCellHeight:function(e,t){return this.__computeRenderedCellDimension(e,t,"height")},_computeRenderedHeaderMinWidth:function(e){return this.__computeRenderedCellDimension(-1,e,"minWidth")},__computeRenderedCellDimension:function(e,t,i){let n=0;var o=this.getCellIDFromCoordinates({rowID:e,columnID:t}),l=!1,s=this.collectionView._getRenderedCellAt(o);if(s||(s=this.collectionView._renderCell(o,{updateCellContent:!1,updateCellLayout:"ignore",updateCellAttributes:!1}),l=!0),s&&s.component){var r=s.component.getReusableContent();if(r){const o=s.component.getContent().style,l=o.width,a=this.getColumnComputedWidth(t);o.width=a+"px";const u=o.height,d=o.lineHeight,c=o.display,h=o.overflow;o.height="",o.lineHeight="",o.overflow="visible";let g=!!this.collectionView.columns[t]&&this.collectionView.columns[t].hasOnCellRequest;("tree"!==this.getDataIndexFromColumnIndex(t)||g||e<0)&&(o.display="block");let p=r;if(r.getContent&&(p=r.getContent()),"height"===i){const t=s.component.getContent().offsetHeight;let i=p.offsetHeight,o=p.querySelector("textarea");o&&(i=o.scrollHeight+2),i!==t&&-1!==e&&(i+=2),n=i}else"minWidth"===i&&(n=parseInt(window.getComputedStyle(p,null).getPropertyValue("min-width"),10));o.width=l,o.display=c,o.height=u,o.lineHeight=d,o.overflow=h}else if("height"===i){var a=this.collectionView.getCellInfosAt(o);this.collectionView.hasCellValue(a)&&this.collectionView._resetRowHeightsOnAllCellsRendered()}l&&this.collectionView._freeUpCell(o,1)}return n},getRowSpacing:function(){return this.rowSpacing},getDefaultRowHeight:function(){return this.getRowHeightFromCellHeight()},getRowPosition:function(e){if(e<0){let t=0;for(let i=-(this._columnModel?this._columnModel.getColumnTreeDepth():0);i<e;i++)t+=this._computeColumnHeadersHeight(i);return t}return this._parent(e)},_computeColumnHeadersHeight:function(e){let t=this._columnModel?this._columnModel.getAutoHeaderHeightColumnIndexes():null;if(-1!==e||!t||!t.length)return this.getColumnHeaderHeight();if(!this._computedHeadersHeights)throw"_computedHeadersHeights not defined on DataGridViewLayout";let i=this._computedHeadersHeights.get(e);if(!i){let t=this.getColumnHeaderHeight(),n=0;if("function"==typeof this.getRowHeightFunction){let i=this.getRowHeightFunction(e);n=void 0!==i?i:t}i=n||t,this.collectionView._initialized&&this._computedHeadersHeights.set(e,i)}return i},_getEstimatedVirtualHeight:function(e){var t=0,i=this.collectionView.getModelLength();if(0===i)return t=1;var n=this.rowSpacing,o=this._columnModel?this._columnModel.getAutoRowHeightColumnIndexes():null;if(this._useVariableRowHeight&&(!e||!o||0===o.length||this._computedRows[i-1]&&void 0!==this._computedRows[i-1].top)){for(var l=-1,s=this._computedRows.length-1;s>=0;s--)if(void 0!==this._computedRows[s].top&&void 0!==this._computedRows[s].height){l=s;break}var r=0,a=0;l>=0?(r=this._computedRows[l].top+this._computedRows[l].height+(this.collectionView.showRowBorderFlag?1:0),a=parseInt(r/(l+1))):a=this.getRowHeight()+n,t=r+(i-(l+1)==0?0:(i-(l+1))*a-n)}else{var u=this._getNumberOfItems();t=u*this.getRowHeight()+(u-1)*n}return t},_getNumberOfItems:function(){return this.collectionView.paginationManager?this.collectionView.paginationManager.getNumberOfItemsOnPage():this.collectionView.getRowModelLength()},getCellCoordinatesAt:function(e){var t=-1,i=-1,n=this.rowsHeader,o=(this.columnsHeader,this._getFirstCellIDInScroller());if(e<o){if(this._columnModel){let o=this._columnModel.getColumnItemsByDepth();if(e<0)t=-o.length-1,i=-4-(n?1:0);else{t=-o.length;var l=3+(n?1:0);if(e<l)i=e-l;else for(var s=0,r=0;r<o.length;r++){var a=o[r];if(e<s+a.length+l){i=e-s-l;break}t++,s+=a.length}}}}else{var u=this._getNumberOfColumns();t=Math.floor((e-o)/u),i=(e-o)%u-3-(n?1:0)}return{rowID:t,columnID:i}},getCellIDFromCoordinates:function(e){var t=-1,n=this.rowsHeader;if(e.columnID=this.getColumnIndex(e.columnID),!i.isUndefinedNullNaN(e.columnID)&&!i.isUndefinedNullNaN(e.rowID)){if(e.rowID<0){if(this._columnModel){let i=this._columnModel.getColumnItemsByDepth();if(e.columnID<0)t=e.rowID<-i.length?-1:e.columnID+3+(n?1:0);else{for(var o=3+(n?1:0),l=0,s=0;s<=i.length+e.rowID;s++){var r=i[s];s<i.length+e.rowID?l+=r.length:l+=e.columnID}t=o+l}}}else{var a=this._getNumberOfColumns();t=this._getFirstCellIDInScroller()+a*e.rowID+e.columnID+3+(n?1:0)}return t<-1&&(t=-1),t}},getColumnOrGroupFromCoordinates:function(e){return this._columnModel?this._columnModel.getColumnOrGroupFromCoordinates(e):null},getColumnOrGroupCellCoordinates:function(e){return this._columnModel?this._columnModel.getColumnOrGroupCellCoordinates(e):null},isRow:function(e){var t=this.getCellCoordinatesAt(e);return t.columnID===this._leftPinnedRowColumnID||t.columnID===this._unpinnedRowColumnID||t.columnID===this._rightPinnedRowColumnID},getContentDimensions:function(){for(var e=this._getEstimatedVirtualHeight(),t=0,i=this.getLeafColumns(),n=0;n<i.length;n++){var o=this.getColumnPinned(n);if("left"!==o&&"right"!==o)this.getColumnVisibleState(n)&&(t+=this.getColumnComputedWidth(n))}return{width:t,height:e}},getLayoutStylesForCellAt:function(e){var t={},i=this.getCellCoordinatesAt(e),n=i.columnID===this._leftPinnedRowColumnID||i.columnID===this._unpinnedRowColumnID||i.columnID===this._rightPinnedRowColumnID,o=this.collectionView.showRowBorderFlag?1:0,l=this.getDefaultCellHeight();if(n){var s=this.getRowHeight(i.rowID);s!==l+o&&(t.height=s+"px");var r=this.getRowPosition(i.rowID);t.transform="translateY("+r+"px)"}else{var a=0;if(i.columnID>-1){var u=this.getColumnOrGroupFromCoordinates(i);a=u?this.getColumnOrGroupPosition(u):this.getColumnPosition(i.columnID)}var d=this.getDimensionsForCellAt(e);t.width=d.width+"px";var c=-1===i.columnID?l+o:l;if(d.height!==c){var h=d.height+"px";t.height=h;var g=d.height-2;i.rowID<=-1&&(g+=1),t.lineHeight=g+"px"}if(i.columnID>=0&&i.rowID>=0)t.left=a+"px";else{r=this.getRowPosition(i.rowID);t.transform="translate3d("+a+"px,"+r+"px,0)"}}return t},getLayoutAttributesForCellAt:function(e){var t,i=this.getCellCoordinatesAt(e),n=this.getColumnOrGroupFromCoordinates(i),o=i.columnID===this._leftPinnedRowColumnID||i.columnID===this._unpinnedRowColumnID||i.columnID===this._rightPinnedRowColumnID,l={"cell-id":e},s=!1;if(this.addCellCoordinates?s=!0:window.__karma__&&window.__karma__.config&&window.__karma__.config.json?s=window.__karma__.config.json.ADD_CELL_COORDINATES:!window.__karma__&&navigator.webdriver&&(s=!0),s&&(l["row-id"]=i.rowID,l["column-id"]=i.columnID),this.rowsHeader&&-1===i.columnID&&(l["row-header"]=""),!o){if(i.rowID<=-1){l["column-header"]="";var r=n?this._columnModel?this._columnModel.getFirstLeafColumnIndex(n,!0):-1:i.columnID;r!==this._firstUnpinnedColumnIndex&&r!==this._firstLeftPinnedColumnIndex&&r!==this._firstRightPinnedColumnIndex||(l["first-column"]="")}if(i.rowID<=-1||this.collectionView.showColumnBorderFlag){var a=n?this._columnModel?this._columnModel.getLastLeafColumnIndex(n,!0):-1:i.columnID;a!==this._lastUnpinnedColumnIndex&&a!==this._lastLeftPinnedColumnIndex&&a!==this._lastRightPinnedColumnIndex||(l["last-column"]="")}this.getColumnAutoRowHeightFlag(i.columnID)&&(l["auto-height"]="")}return"left"!==(t=i.columnID===this._leftPinnedRowColumnID?"left":i.columnID===this._rightPinnedRowColumnID?"right":-1===i.columnID?"left":n?this.getColumnOrGroupPinned(n):this.getColumnPinned(i.columnID))&&"right"!==t||(l.pinned=t),o&&(i.rowID%2==0?l["even-row"]="":l["odd-row"]=""),l},_getFirstCellIDInScroller:function(){return this.columnsHeader?this._getColumnHeaderCellCount():0},_getNumberOfColumns:function(){return this._getLeafColumnsCount()+3},_getLastCellIDInScroller:function(){return this._getNumberOfItems()*this._getNumberOfColumns()-1},renderListOfVisibleCellsInViewport:function(e){if(e&&e.render){var t=this.collectionView;if(t&&t.elements&&t.elements.container){var n,o=!1,s=!1;e.allottedTime>0&&(n=window.performance?performance.now():Date.now());var r=this.getMinMaxVisibleCellIDs(),a=this.getCellCoordinatesAt(r.minCellID),u=this.getCellCoordinatesAt(r.maxCellID),d=this.columnsHeader,c=this.rowsHeader,h=this._getFirstCellIDInScroller();s,t._listOfRenderedCells.forEach((function(e,i){if(i<r.minCellID&&i>=h||i>r.maxCellID){var n=e&&e.component?e.component.getCleaningMode():1;if(t._freeUpCell(i,n),e&&e.component&&e.component.isRow()){var o=e.component;l.empty(o.getContent())}}}));for(var g=void 0!==this._firstLeftPinnedColumnIndex,p=void 0!==this._firstRightPinnedColumnIndex,m=a.rowID,f=u.rowID,C=m;C<=f;C++){if(g){var w=this.getCellIDFromCoordinates({rowID:C,columnID:this._leftPinnedRowColumnID});e.render(w,{cellType:C%2==0?"__left_even_row__":"__left_odd_row__"})}if(p){w=this.getCellIDFromCoordinates({rowID:C,columnID:this._rightPinnedRowColumnID});e.render(w,{cellType:C%2==0?"__right_even_row__":"__right_odd_row__"})}w=this.getCellIDFromCoordinates({rowID:C,columnID:this._unpinnedRowColumnID});e.render(w,{cellType:C%2==0?"__even_row__":"__odd_row__"})}if(d){c&&e.render(3,{cellType:"__topleft_row_header__"});var _=3+(this.rowsHeader?1:0),D=this.collectionView.getViewportDimensions(),I=this.collectionView.getScrollerPosition(),y=I.x,V=I.x+D.width,v=this.getLeafColumns();if(this._columnModel){let t=this._columnModel.getColumnItemsByDepth();for(C=0;C<t.length;C++)for(var b=t[C],x=0;x<b.length;x++){var M;if(M=C===t.length-1?v[x]:b[x],this.getColumnOrGroupVisibleState(M)){var F=!1;if((g||p)&&("left"!==(K=this.getColumnOrGroupPinned(M))&&"right"!==K||(F=!0)),!F){var O=this.getColumnOrGroupPosition(M);O+this.getColumnOrGroupComputedWidth(M)>=y&&O<V&&(F=!0)}if(F)j="left"===K?"__topleft_item__":"right"===K?"__topright_item__":"__top_item__",e.render(_,{cellType:j})}_++}}}if(c){for(var S=[],P=m;P<=f;P++){_=this.getCellIDFromCoordinates({rowID:P,columnID:-1});(J=e.render(_,{cellType:"__row_header__"}))&&J.component&&!J.component.getContent().parentNode&&S.push(J.component.getContent())}S.length>0&&i.appendToParent(t.elements.rowHeaderExtensionPoolContainer,S)}var R=this.getDisplayedColumnsIndexes(),A=[],G=[],E=[],T=[],N=[],L=[];for(P=m;P<=f;P++){var H,k,B=t._getViewAt(this.getCellIDFromCoordinates({rowID:P,columnID:this._unpinnedRowColumnID}));if(g&&(H=t._getViewAt(this.getCellIDFromCoordinates({rowID:P,columnID:this._leftPinnedRowColumnID}))),p&&(k=t._getViewAt(this.getCellIDFromCoordinates({rowID:P,columnID:this._rightPinnedRowColumnID}))),!e.lightRendering&&!o){if(e.allottedTime>0)(window.performance?performance.now():Date.now())-n>e.allottedTime&&(o=!0);if(!o){B&&(B.getContent().hasChildNodes()||B.getContent().remove()),H&&(H.getContent().hasChildNodes()||H.getContent().remove()),k&&(k.getContent().hasChildNodes()||k.getContent().remove());for(var U=0;U<R.length;U++){var W=R[U];if(W>-1){_=this.getCellIDFromCoordinates({rowID:P,columnID:W});var j,X,z,K=this.getColumnPinned(W);j="tree"===this.getDataIndexFromColumnIndex(W)?"__tree_item__":"__item__","left"===K?(X=H,z=N):"right"===K?(X=k,z=L):(X=B,z=T);var q=X&&"function"==typeof X.getCellPool?X.getCellPool():void 0,J=e.render(_,{cellType:j,cellPool:q});z&&J&&J.component&&J.component.getContent().parentNode!==X.getContent()&&z.push(J.component.getContent())}}B&&T.length>0&&(i.appendToParent(B.getContent(),T),T=[]),H&&N.length>0&&(i.appendToParent(H.getContent(),N),N=[]),k&&L.length>0&&(i.appendToParent(k.getContent(),L),L=[])}}A&&B&&!B.getContent().parentNode&&A.push(B.getContent()),G&&H&&!H.getContent().parentNode&&G.push(H.getContent()),E&&k&&!k.getContent().parentNode&&E.push(k.getContent())}return A.length>0&&i.appendToParent(t.elements.poolContainer,A),G.length>0&&i.appendToParent(t.elements.leftPoolContainer,G),E.length>0&&i.appendToParent(t.elements.rightPoolContainer,E),{taskInterrupted:o}}}},getCellType:function(e){var t,i=this.getCellCoordinatesAt(e);if(i.columnID>-1){var n=this.getColumnOrGroupFromCoordinates(i);t=n?this.getColumnOrGroupPinned(n):this.getColumnPinned(i.columnID)}var o=i.rowID%2==0;if(i.rowID<=-1)return-1===i.columnID?"__topleft_row_header__":"left"===t?"__topleft_item__":"right"===t?"__topright_item__":"__top_item__";if(i.columnID===this._leftPinnedRowColumnID)return o?"__left_even_row__":"__left_odd_row__";if(i.columnID===this._unpinnedRowColumnID)return o?"__even_row__":"__odd_row__";if(i.columnID===this._rightPinnedRowColumnID)return o?"__right_even_row__":"__right_odd_row__";if(-1===i.columnID)return"__row_header__";var l=this.getLeafColumns();return l[i.columnID]&&"tree"===l[i.columnID].dataIndex?"left"===t?"__left_tree_item__":"right"===t?"__right_tree_item__":"__tree_item__":"left"===t?"__left_item__":"right"===t?"__right_item__":"__item__"},getColumnHeaderHeight:function(e){if(void 0===e){var t=this.collectionView._getCurrentTouchMode()?40:r;return Math.max(this.columnHeaderHeight,t+1)}return this._computeColumnHeadersHeight(e)},getHeaderContainerHeight:function(){if(this.columnsHeader){let e=0;for(let t=-(this._columnModel?this._columnModel.getColumnTreeDepth():0);t<0;t++)e+=this._computeColumnHeadersHeight(t);return e}return 0},getLeftContainerWidth:function(){for(var e=0,t=this.getLeafColumns(),i=0;i<t.length;i++){if("left"===this.getColumnPinned(i))this.getColumnVisibleState(i)&&(e+=this.getColumnComputedWidth(i))}return e},getRightContainerWidth:function(){for(var e=0,t=this.getLeafColumns(),i=0;i<t.length;i++){if("right"===this.getColumnPinned(i))this.getColumnVisibleState(i)&&(e+=this.getColumnComputedWidth(i))}return e},computeCenterContainerSideMargin:function(e,t,i){var n;if("left"===e){var o=this.rowsHeader?this.getRowHeaderWidth():0;n=(l=t+o)>i+o?i+o:l}else if("right"===e){var l;n=(l=t)>i?i:l}return n},computeSideContainerMaxWidth:function(e,t,i,n){var o=this.rowsHeader?this.getRowHeaderWidth():0;return this._parent(e,t-o,i,n)},computeCenterContainerMinWidth:function(e,t,i){var n=this.rowsHeader?this.getRowHeaderWidth():0;return this._parent(e,t,i-n)},computeSideContainerWidth:function(e,t,i){var n=0;if("left"===e){n=t+(t?i||1:0)}else"right"===e&&(n=this._parent(e,t,i));return n},getPositionForCellAt:function(e){var t={top:0,left:0},i=this.getCellCoordinatesAt(e);if(t.top=this.getRowPosition(i.rowID),i.columnID>-1){var n=this.getColumnOrGroupFromCoordinates(i);t.left=n?this.getColumnOrGroupPosition(n):this.getColumnPosition(i.columnID)}return t},getCellIDFromPositionInView:function(e){var t=-1;if(e){var i=this.getHeaderContainerHeight();if(e.top>=i){var n=this._getRowIDFromPosition(e.top-i);if(n<this.collectionView.getModelLength()){var o=this.collectionView.getViewportDimensions(),l=this.rowsHeader?this.getRowHeaderWidth():0,s=this.getLeftContainerWidth(),r=(this.getRightContainerWidth(),0),a="unpinned";e.left<=l+s?(a="left",r=l):e.left>=l+s+o.width?(a="right",r=l+s+o.width):r=l+s;var u=-1;if(e.left>=r){let t=this._columnModel?this._columnModel.getOrderedColumnsIndexes():[];for(var d=0;d<t.length;d++){var c=t[d],h=this.getColumnVisibleState(c),g=this.getColumnPinned(c);if(h&&g===a&&(r+=this.getColumnComputedWidth(c),e.left<=r)){u=c;break}}}n>=0&&u>=0&&(t=this.getCellIDFromCoordinates({rowID:n,columnID:u}))}}}return t},getDimensionsForCellAt:function(e){var t=this.getCellCoordinatesAt(e),i=t.columnID===this._leftPinnedRowColumnID||t.columnID===this._unpinnedRowColumnID||t.columnID===this._rightPinnedRowColumnID,n=0;if(t.columnID>=-1){var o=this.getColumnOrGroupFromCoordinates(t);n=o?this.getColumnOrGroupComputedWidth(o):this.getColumnComputedWidth(t.columnID)}else if(t.columnID===this._leftPinnedRowColumnID)n=this.collectionView._leftContainerWidth;else if(t.columnID===this._unpinnedRowColumnID){n=this.collectionView.getViewportDimensions().width}else t.columnID===this._rightPinnedRowColumnID&&(n=this.collectionView._rightContainerWidth);var l,s=this.getRowHeight(t.rowID);if(i)l=s;else if(t.rowID<=-1)l=-1===t.columnID?this.getHeaderContainerHeight():this.getColumnHeaderHeight(t.rowID);else if(-1===t.columnID)l=s;else{l=s-(this.collectionView.showRowBorderFlag?1:0)}return{width:n,height:l}},computeCellRange:function(e,t){var i=[],n=this.getCellCoordinatesAt(e),o=this.getCellCoordinatesAt(t);n.columnID<0&&(n.columnID=0),o.columnID<0&&(o.columnID=0);let l=this.getOrderedColumnsReverseIndexes();var s=l[n.columnID],r=l[o.columnID];if(void 0===s||void 0===r)return;var a=Math.min(s,r),u=Math.max(s,r),d=Math.min(n.rowID,o.rowID),c=Math.max(n.rowID,o.rowID);let h=this._columnModel?this._columnModel.getOrderedColumnsIndexes():[];for(var g=d;g<=c;g++)for(var p=a;p<=u;p++){var m=h[p];if(this.getColumnVisibleState(m)){var f=this.getCellIDFromCoordinates({rowID:g,columnID:m});i.push(f)}}return i},isCellInRange:function(e,t,i){var n=!1,o=this.getCellCoordinatesAt(e),l=this.getCellCoordinatesAt(t),s=this.getCellCoordinatesAt(i),r=Math.min(l.rowID,s.rowID),a=Math.max(l.rowID,s.rowID);if(o.rowID>=r&&o.rowID<=a){var u=this._compareColumnIDs(l.columnID,s.columnID)<0?l.columnID:s.columnID,d=u===l.columnID?s.columnID:l.columnID;this._compareColumnIDs(o.columnID,u)>=0&&this._compareColumnIDs(o.columnID,d)<=0&&(n=!0)}return n},isNodeModelInRange:function(e,t,i){var n=!1;if(e){var o=e._getRowID(),l=this.getCellCoordinatesAt(t),s=this.getCellCoordinatesAt(i),r=Math.min(l.rowID,s.rowID),a=Math.max(l.rowID,s.rowID);n=o>=r&&o<=a}return n},getCellsFromNodeModel:function(e,t){var i=[];if(e){var n=e._getRowID();if(t){var o=this.getVisibleOrderedColumnsIndexes();for(s=0;s<o.length;s++)i.push(this.getCellIDFromCoordinates({rowID:n,columnID:o[s]}))}else for(var l=this.getLeafColumns().length,s=0;s<l;s++)i.push(this.getCellIDFromCoordinates({rowID:n,columnID:s}))}return i},_compareColumnIDs:function(e,t){var i=this.getColumnPinned(e),n=this.getColumnPinned(t);if(i===n){var o=this.getColumnIdentifiers(e),l=this.getColumnIdentifiers(t);return o.columnIndex===l.columnIndex?0:o.columnIndex<l.columnIndex?-1:1}return"left"===i?-1:"right"===i||"left"===n?1:-1},_computeCellIDFromCell:function(e,t,i,n){var o=e,l=this.getCellCoordinatesAt(e);if(l.rowID>=0&&l.columnID>=0&&this._columnModel){var s=-1,r=-1;if("up"===t)s=l.rowID>0?l.rowID-1:l.rowID,r=l.columnID;else if("right"===t)s=l.rowID,r="row"===this.collectionView.cellActivationFeedback?this.getColumnIndex("tree"):this._columnModel.getNextVisibleColumnID(l.columnID);else if("down"===t)s=l.rowID<this.collectionView.getModelLength()-1?l.rowID+1:l.rowID,r=l.columnID;else if("left"===t)s=l.rowID,r="row"===this.collectionView.cellActivationFeedback?this.getColumnIndex("tree"):this._columnModel.getPreviousVisibleColumnID(l.columnID);else if("tab"===t){if(n?(s=l.rowID,(r=this._columnModel.getPreviousVisibleColumnID(l.columnID))<0&&s>0&&(s--,r=this._columnModel.getLastVisibleColumnID())):(s=l.rowID,(r=this._columnModel.getNextVisibleColumnID(l.columnID))<0&&s<this.collectionView.getModelLength()-1&&(s++,r=this._columnModel.getFirstVisibleColumnID())),this.collectionView.focusNextEditableCellOnTabFlag){var a=this.getCellIDFromCoordinates({rowID:s,columnID:r});if(!this.collectionView.getCellEditableState(a))for(;;){var u=a;if((a=this._computeCellIDFromCell(a,t,i,n))===u){s=-1,r=-1;break}if(this.collectionView.getCellEditableState(a)){var d=this.getCellCoordinatesAt(a);s=d.rowID,r=d.columnID;break}}}}else if("pageup"===t){this.collectionView.getViewportDimensions();var c=(h=this.getMinMaxVisibleRowIDs()).maxRowID-h.minRowID;s=Math.max(0,l.rowID-c),r=l.columnID}else if("pagedown"===t){var h;this.collectionView.getViewportDimensions(),c=(h=this.getMinMaxVisibleRowIDs()).maxRowID-h.minRowID;s=Math.min(this.collectionView.getModelLength()-1,l.rowID+c),r=l.columnID}else if("home"===t)if(s=i||"row"===this.collectionView.cellActivationFeedback?0:l.rowID,"row"===this.collectionView.cellActivationFeedback){const e=this._getRowFirstVisibleCellWithActivableState(s);r=this.getCellCoordinatesAt(e).columnID}else r=this._columnModel.getFirstVisibleColumnID();else if("end"===t)if(s=i||"row"===this.collectionView.cellActivationFeedback?this.collectionView.getModelLength()-1:l.rowID,"row"===this.collectionView.cellActivationFeedback){const e=this._getRowFirstVisibleCellWithActivableState(s);r=this.getCellCoordinatesAt(e).columnID}else r=this._columnModel.getLastVisibleColumnID();else"enter"===t&&(s=l.rowID,r=l.columnID,this.collectionView.selectNextCellOnEnterFlag&&(n?s>0&&s--:s<this.collectionView.getModelLength()-1&&s++));s>=0&&r>=0&&(o=this.getCellIDFromCoordinates({rowID:s,columnID:r}))}return o},_hasValidIdentifier:function(){if(""!==this.identifier){var e=Math.floor(Number(this.identifier));return e<0||String(e)!==this.identifier}return!1},exportPreferencesInJson:function(e){return e&&e.onlyCustomViewsFlag?JSON.stringify({customViews:this._getDataFromPreferences("customViews")}):JSON.stringify(this._getDataFromPreferences(void 0))},importJsonPreferences:function(e,t){if(!e&&"string"!=typeof e)return;t||(t={importOnlyCustomViews:!1,importCurrentCustomViewId:!1});let i=JSON.parse(e);t.importOnlyCustomViews?(this.collectionView.getCustomViewsManager().addCustomView(i.customViews),this._saveDataInPreferences("customViews",this.collectionView.getCustomViewsManager()._customViews)):Object.keys(i).forEach((e=>{"customViews"===e?(this.collectionView.getCustomViewsManager().addCustomView(i.customViews),this._saveDataInPreferences("customViews",this.collectionView.getCustomViewsManager()._customViews)):(t.importCurrentCustomViewId||"currentCustomViewId"!==e)&&this._saveDataInPreferences(e,i[e])})),this._applyPreferencesOnColumns()},_getDataFromPreferences:function(e){var t=void 0;return this._hasValidIdentifier()&&(t=i.getDataInPreferences(this.collectionView,a,e,this.collectionView.useWidgetPreferencesFlag)),t},_saveDataInPreferences:function(e,t){if(this._hasValidIdentifier()){const n=!!this.collectionView&&this.collectionView.useWidgetPreferencesFlag;i.saveDataInPreferences(this.collectionView,a,e,t,n),this.collectionView&&this.collectionView.fire("userPreferencesChange")}},_saveColumnOptionValueInPreferences:function(e,t,i){var n=this._getDataFromPreferences(i);n||(n={});var o=this.getColumnIdentifiers(e);n[o.dataIndex]=this.getColumnOptionValue(o.columnIndex,t),this._saveDataInPreferences(i,n)},_saveParentColumnGroupsExpandedStateInPreferences:function(e){e&&(void 0!==e.columnGroupShow&&this._saveColumnGroupExpandedStateInPreferences(e),this._saveColumnGroupExpandedStateInPreferences(e._parent))},_saveColumnGroupExpandedStateInPreferences:function(e){if(e){var t=e.expandedFlag;if(void 0!==t){var i=this._columnModel?this._columnModel.getColumnGroupIndexInItsRow(e):-1;if(-1!==i){var n="columnGroupsExpandedStates",o=e.dataIndex+"_"+i,l=this._getDataFromPreferences(n);l||(l={}),l[o]=t?1:0,this._saveDataInPreferences(n,l)}}}},_updateColumnGroupExpandedStateInPreferences:function(e,t){for(var i="columnGroupsExpandedStates",n=0;n<e.numberOfDataIndexOccurences.length;n++)if(!(0===e.childrenCount&&0===t.childrenCount&&e.childrenCountInParent>1&&t.childrenCountInParent>1))if(e.numberOfDataIndexOccurences[n]<t.numberOfDataIndexOccurences[n]){(r=this._getDataFromPreferences(i))||(r={});for(var o=t.columnGroupDataIndexes[n],l=t.numberOfDataIndexOccurences[n]-1;l>=t.indexInParent[n];l--){if(void 0!==r[h=o+"_"+l.toString()]){var s=r[h];delete r[h],r[c=o+"_"+(l+1).toString()]=s,this._saveDataInPreferences(i,r)}}}else if(e.numberOfDataIndexOccurences[n]>t.numberOfDataIndexOccurences[n]){(r=this._getDataFromPreferences(i))||(r={});for(o=t.columnGroupDataIndexes[n],l=t.indexInParent[n];l<e.numberOfDataIndexOccurences[n];l++){if(void 0!==r[h=o+"_"+l.toString()]){s=r[h];delete r[h],r[c=o+"_"+(l-1).toString()]=s,this._saveDataInPreferences(i,r)}}}else{var r;(r=this._getDataFromPreferences(i))||(r={});var a=[],u=[],d=[];o=t.columnGroupDataIndexes[n];if(t.indexInParent[n]>e.indexInParent[n])for(l=t.indexInParent[n];l>=e.indexInParent[n];l--){if(void 0!==(s=r[h=o+"_"+(e.indexInParent[n]+t.indexInParent[n]-l).toString()])){a.push(h),d.push(s);var c=o+"_"+l.toString();u.push(c)}}else for(l=t.indexInParent[n];l<=e.indexInParent[n];l++){var h;if(void 0!==(s=r[h=o+"_"+(l===t.indexInParent[n]?e.indexInParent[n]:l-1).toString()])){a.push(h),d.push(s);c=o+"_"+l.toString();u.push(c)}}for(var g=0;g<a.length;g++)delete r[a[g]];for(g=0;g<u.length;g++)r[u[g]]=d[g];this._saveDataInPreferences(i,r)}},checkPresenceOfDataGridViewPreferences:function(){return!!this._hasValidIdentifier()&&i.checkPresenceOfPreferences(this.collectionView,a,this.collectionView.useWidgetPreferencesFlag)},deleteDataGridViewPreferences:function(){i.deleteDataFromPreferences(this.collectionView,a,this.collectionView.useWidgetPreferencesFlag)},deleteDataGridViewKeyPreference:function(e){i.deleteDataFromPreferences(this.collectionView,a,e,this.collectionView.useWidgetPreferencesFlag)},_getColumnsVisibleFlagInPreferences:function(){return this._getDataFromPreferences("columnsVisibleFlag")},_saveColumnVisibleFlagInPreferences:function(e){this._saveColumnOptionValueInPreferences(e,"visibleFlag","columnsVisibleFlag")},_getUnpinnedColumnsOrderInPreferences:function(){return this._getDataFromPreferences("unpinnedColumnsOrder")},_getPinnedColumnsOrderInPreferences:function(){return this._getDataFromPreferences("pinnedColumnsOrder")},_getColumnGroupsExpandedStatesInPreferences:function(){return this._getDataFromPreferences("columnGroupsExpandedStates")},_saveColumnOrderInPreferences:function(e){var t=this.getColumnPinned(e),i="unpinned"===t?this._getUnpinnedColumnsOrderInPreferences():this._getPinnedColumnsOrderInPreferences();i||(i={});var n=this._getNumberOfColumnsToTheLeft(),o=this.getColumnIdentifiers(e);var l=this.getOrderedColumnsReverseIndexes()[o.columnIndex];l-=n[t],i[o.dataIndex]=l;var s="unpinned"===t?"unpinnedColumnsOrder":"pinnedColumnsOrder";this._saveDataInPreferences(s,i)},_updateAllOrderInPreferences:function(e){var t=this._getUnpinnedColumnsOrderInPreferences(),i=this._getPinnedColumnsOrderInPreferences(),n=this._getNumberOfColumnsToTheLeft();let o=this._columnModel?this._columnModel.getOrderedColumnsIndexes():[];for(var l=0;l<o.length;l++){var s=o[l],r=this.getDataIndexFromColumnIndex(s),a=this.getColumnPinned(r);t&&"unpinned"===a&&null!=t[r]?t[r]=l-n[a]:i&&"unpinned"!==a&&null!=i[r]&&(i[r]=l-n[a])}this._saveDataInPreferences("unpinnedColumnsOrder",t),this._saveDataInPreferences("pinnedColumnsOrder",i)},isInGroup:function(e,t){var i=this.getColumnIdentifiers(e);if(t){if(!t.children)return t.dataIndex===i.dataIndex;for(var n=0;n<t.children.length;n++)if(this.isInGroup(e,t.children[n]))return!0}return!1},_getColumnsWidthInPreferences:function(){return this._getDataFromPreferences("columnsWidth")},_saveColumnWidthInPreferences:function(e){this._saveColumnOptionValueInPreferences(e,"width","columnsWidth")},_getColumnsPinnedStateInPreferences:function(){return this._getDataFromPreferences("columnsPinnedState")},_saveColumnPinnedStateInPreferences:function(e){this._saveColumnOptionValueInPreferences(e,"pinned","columnsPinnedState")},_getColumnsSortModelInPreferences:function(){return this._getDataFromPreferences("columnsSortModel")},saveColumnSortModelInPreferences:function(){this._saveDataInPreferences("columnsSortModel",this.collectionView.sortModel)},_saveColumnSortModelInPreferences:function(){this.saveColumnSortModelInPreferences()},_getGroupingOptionsInPreferences:function(){return this._getDataFromPreferences("groupingOptions")},_saveGroupingOptionsInPreferences:function(){this._saveDataInPreferences("groupingOptions",this.collectionView.getGroupingOptions())},getCurrentViewChanges:function(){var e={columnsVisibleFlag:void 0,columnsWidth:void 0,columnsPinnedState:void 0,columnsSortModel:void 0,layoutDensity:void 0,groupingOptions:void 0,unpinnedColumnsOrder:void 0,pinnedColumnsOrder:void 0,columnGroupsExpandedStates:void 0},t=this.collectionView.getCustomViewsManager().getCurrentCustomView();t&&(e.columnsVisibleFlag=t.columnsVisibleFlag,e.columnsWidth=t.columnsWidth,e.columnsPinnedState=t.columnsPinnedState,e.columnsSortModel=t.columnsSortModel,e.layoutDensity=t.layoutDensity,e.groupingOptions=t.groupingOptions,e.unpinnedColumnsOrder=t.unpinnedColumnsOrder,e.pinnedColumnsOrder=t.pinnedColumnsOrder);var n=this._getColumnsVisibleFlagInPreferences();(e.columnsVisibleFlag||n)&&(e.columnsVisibleFlag=i.concatenateObjects(e.columnsVisibleFlag,n));var o=this._getColumnsWidthInPreferences();(e.columnsWidth||o)&&(e.columnsWidth=i.concatenateObjects(e.columnsWidth,o));var l=this._getColumnsPinnedStateInPreferences();(e.columnsPinnedState||l)&&(e.columnsPinnedState=i.concatenateObjects(e.columnsPinnedState,l));var s=this._getColumnsSortModelInPreferences();e.columnsSortModel=s,e.layoutDensity||(e.layoutDensity=this._getOriginalLayoutDensity());var r=this._getGroupingOptionsInPreferences();(e.groupingOptions||r)&&(e.groupingOptions=i.concatenateObjects(e.groupingOptions,r));var a=this._getUnpinnedColumnsOrderInPreferences();(e.unpinnedColumnsOrder||a)&&(e.unpinnedColumnsOrder=i.concatenateObjects(e.unpinnedColumnsOrder,a));var u=this._getPinnedColumnsOrderInPreferences();(e.pinnedColumnsOrder||u)&&(e.pinnedColumnsOrder=i.concatenateObjects(e.pinnedColumnsOrder,u));var d=this._getColumnGroupsExpandedStatesInPreferences();return d&&(e.columnGroupsExpandedStates=d),e},_applyPreferencesOnColumns:function(){this.collectionView.getCustomViewsManager().getCustomViews();for(var e=this.getCurrentViewChanges(),t=!1,i=Object.keys(e).map((function(t){return e[t]})),n=0;n<i.length;n++)if(void 0!==i[n]){t=!0;break}if(this.collectionView.prepareUpdateView(),t){var l=this.getLeafColumns();for(n=0;n<l.length;n++)e.columnsVisibleFlag&&e.columnsVisibleFlag.hasOwnProperty(l[n].dataIndex)&&this.setColumnVisibleFlag(n,e.columnsVisibleFlag[l[n].dataIndex]),e.columnsWidth&&e.columnsWidth.hasOwnProperty(l[n].dataIndex)&&this.setColumnWidth(n,e.columnsWidth[l[n].dataIndex]),e.columnsPinnedState&&e.columnsPinnedState.hasOwnProperty(l[n].dataIndex)&&this.setColumnPinned(n,e.columnsPinnedState[l[n].dataIndex])}if(this._columnModel){let t=this._columnModel.getOrderedColumnIndexesFromChanges(e);this._columnModel._setOrderedColumnIndexes(t)}if(this.collectionView._currentlyCalledFromApplyPreferencesFlag=!0,e.columnsSortModel&&(!this.collectionView._useTreeDocumentRestoration||this.collectionView.sortModel&&0!==this.collectionView.sortModel.length||o.saveTreeDocumentOrder(this.collectionView.treeDocument),this.collectionView.sortModel=function(e,t){let i=[];for(let n=0;n<e.length;n++)d(e[n].dataIndex,t)||i.push(n);if(0===i.length)return e;let n=e.filter((function(e,t){return!(i.indexOf(t)>-1)}));return n}(e.columnsSortModel,this.collectionView.columns)),e.layoutDensity&&(this.layoutDensity=e.layoutDensity),e.groupingOptions){var s=e.groupingOptions.dataIndexesToGroup;this.collectionView._setGroupingOptions(e.groupingOptions),this.collectionView.getGroupingOptions()&&this.collectionView.getGroupingOptions().dataIndexesToGroup.equals(s)||this.collectionView.groupRows(e.groupingOptions)}if(e.columnGroupsExpandedStates)for(var r in e.columnGroupsExpandedStates){var a=0!==e.columnGroupsExpandedStates[r],u=r.split("_");if(u&&u.length>0){var c=u[u.length-1],h=u.slice(0,u.length-1).join("_"),g=this.getColumnOrGroup(h,parseInt(c,10));g&&(g.expandedFlag=a)}}this.collectionView._currentlyCalledFromApplyPreferencesFlag=!1,this.collectionView.__preferencesRestored=!0,this.collectionView.pushUpdateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0},!0)},_getRowFirstVisibleCellWithActivableState:function(e){let t=-1;if(this._columnModel){let i=0;for(;-1!==i&&(i>=0&&i>=0&&(t=this.getCellIDFromCoordinates({rowID:e,columnID:i})),!this.collectionView.getCellActivableState(t));)i=this._columnModel.getNextVisibleColumnID(i);-1===i&&(t=-1)}return t},getColumnGroupExpandedFlag:function(e,t){const i=this.getColumnOrGroupFromCoordinates({rowID:e,columnID:t});if(i)return i.expandedFlag},setColumnGroupExpandedFlag:function(e,t,i,n){var o=this.getColumnOrGroupFromCoordinates({rowID:e,columnID:t});if(o){o.expandedFlag=i;let l=!1,s=!1,r=this._getLeafChildrenFromGroup(o);for(let e=0;e<r.length;e++)if(r[e].customHeader){s=!0,l=!0;break}l&&this.resetRowHeight(-1),this.invalidate({updateCellContent:s,updateCellLayout:!0,updateCellAttributes:!0}),n&&n.isUserInteraction&&this._saveColumnGroupExpandedStateInPreferences(o),this.collectionView.fire("columnGroupExpandedState",{visibleState:i,rowID:e,columnID:t})}},_getColumnIDInLeafColumnHierarchyAtRowID:function(e,t){if(t>=-1)return e;var i=-1,n=this.getColumnOrGroupFromCoordinates({rowID:i,columnID:e});if(!n)return e;for(;;){if(i--,!(n=n._parent))return e;if(i===t)return this.getColumnOrGroupCellCoordinates(n).columnID}}});function d(e,t){for(let i=0;i<t.length;i++){if(t[i].dataIndex===e)return!0;if(t[i].children&&d(e,t[i].children))return!0}return!1}return Object.defineProperty(u.prototype,"_leafColumns",{get:function(){return this._columnModel?this._columnModel.getLeafColumns():[]}}),Object.defineProperty(u.prototype,"_originalLeafColumns",{get:function(){return this._columnModel?this._columnModel.getOriginalLeafColumns():[]}}),Object.defineProperty(u.prototype,"_balancedColumnTree",{get:function(){return this._columnModel?this._columnModel.getBalancedColumnTree():[]}}),Object.defineProperty(u.prototype,"_columnItemsByDepth",{get:function(){return this._columnModel?this._columnModel.getColumnItemsByDepth():[]}}),Object.defineProperty(u.prototype,"_orderedColumnsIndexes",{get:function(){return this._columnModel?this._columnModel.getOrderedColumnsIndexes():[]}}),u}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/DataGridView/DataGridViewRowHeaderCell",["require","exports","DS/DataGridView/DataGridViewCell","UWA/Core","DS/Core/WebUXComponents","DS/Utilities/Dom","DS/Controls/Toggle"],(function(e,t,i,n,o,l,s){"use strict";var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{rowIndex:{defaultValue:"",type:"string"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.cellContentLabel=new n.Element("div",{class:"wux-datagridview-selection-label"}),this.elements.cellContentLabel.inject(this.elements.container)},t.prototype.buildDragGrip=function(){this.elements._dragGrip||(this.elements._dragGrip=l.generateIcon({iconName:"drag-grip",fontIconFamily:WUXManagedFontIcons.Font3DS}),this.elements._dragGrip.classList.add("wux-datagridview-drag-grip"),this.elements._dragGrip.setAttribute("draggable",!0),this.elements.KPIColorDiv?this.elements._dragGrip.inject(this.elements.KPIColorDiv,"after"):this.elements._dragGrip.inject(this.elements.container,"top"))},t.prototype.buildSelectionCheckBox=function(){this.elements._selectionCheckBox||(this.elements._selectionCheckBox=new s({type:"checkbox",checkFlag:!1,fireOnlyFromUIInteractionFlag:!0}),this.elements._selectionCheckBox.getContent().classList.add("wux-datagridview-selection-checkbox"),this.elements._selectionCheckBox.inject(this.elements.container))},t.prototype.getInitialClassName=function(){return e.prototype.getInitialClassName.call(this)+" wux-layouts-datagridview-row-header-cell"},t.prototype.getCleaningMode=function(){return 2},t.prototype._updateKPIColor=function(){e.prototype._updateKPIColor.call(this),this.elements.KPIColorDiv&&this.elements.KPIColorDiv.addClassName("wux-layouts-datagridview-kpi-color-row-header-cell")},t.prototype.updateSelectionCheckboxState=function(e){var t=this.elements._selectionCheckBox;if(t){var i=t.preventTriggeringChangeEvent;t.preventTriggeringChangeEvent=!0,t.mixedState=e.mixedState,t.checkFlag=e.checkFlag,t.disabled=e.disabled,t.preventTriggeringChangeEvent=i}},t.prototype._applyRowIndex=function(){this.elements.cellContentLabel.textContent=this.rowIndex},t}(i);return o.addClass(r,"DataGridViewRowHeaderCell"),r})),define("DS/DataGridView/RowModelClientSide",["DS/DataGridView/RowModelBase","DS/DataGridView/DataGridViewFilterViewManager","DS/TreeModel/ModelUtils","DS/Utilities/StringUtils","DS/Utilities/Dom","i18n!DS/DataGridView/assets/nls/translation"],(function(e,t,i,n,o,l){"use strict";function s(e){return null==e||""===e}return e.inherit({name:"RowModelClientSide",publishedProperties:{treeDocument:{defaultValue:null,type:"object"},sortModel:{defaultValue:null,type:"array"}},_applyProperties:function(e){this._parent(e),this.isDirty("treeDocument")&&this._applyTreeDocument(e.treeDocument),this.isDirty("sortModel")&&this._applySortModel(e.sortModel)},_getTreeDocument:function(){return this.treeDocument},getVisibleNodeModel:function(e){return this.collectionView.getNodeModelAtRowID(e)},_isModelBeingFetched:function(){return!1},_applyTreeDocument:function(e){let i=this.collectionView;if(i&&i._rowModel&&i._rowModel._currentTreeDocumentUpdateCounter&&(i._updateCounter-=i._rowModel._currentTreeDocumentUpdateCounter,i._rowModel._currentTreeDocumentUpdateCounter=0,i._updateCounter<0&&console.warn("A call has been made on pushUpdateView without a previous call to prepareUpdateView")),this._removeModelEvents(e),this._removeXSOEventsListener(e),this.treeDocument){i&&(i._rowModel=this);var n=this.treeDocument.getFilterManager();n&&(this._filterViewManager?this._filterViewManager.filterManager=n:this._filterViewManager=new t({view:this.collectionView,filterManager:n})),this._listenToTreeDocument()}else this._syncModel()},_syncModel:function(e){var t=this.collectionView;t._hasFlatTreeState=!0;var i=[],n=0,o=this._getCurrentPaginationOptions();if(this._getTreeDocument()){this._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:!0,processNode:function(e){if(t.shouldNodeBeRepresented(e.nodeModel)){if(o){if(n<o.nodeMin)return-1===o.paginationNodeDepth||e.nodeModel.getNodeDepth()===o.paginationNodeDepth?(n++,{shouldProcessDescendants:-1===o.paginationNodeDepth}):void 0;if(n>o.nodeMax&&(-1===o.paginationNodeDepth||e.nodeModel.getNodeDepth()<=o.paginationNodeDepth))return{stopProcessing:!0};-1!==o.paginationNodeDepth&&e.nodeModel.getNodeDepth()!==o.paginationNodeDepth||n++}i.push(e.nodeModel),e.nodeModel.getChildren()&&(t._hasFlatTreeState=!1)}}}),t.prepareUpdateView();var l=!(!e||!(e.updateType&WUXModelUpdateTypes.Addition||e.updateType&WUXModelUpdateTypes.Removal||e.updateType&WUXModelUpdateTypes.Expand));l&&UWA.equals(t.model,i)?t.updateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}):e&&e.updateType&WUXModelUpdateTypes.Filtering&&UWA.equals(t.model,i)?t.updateRowView(-1,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}):t.model=i,l&&(t.updateView({updateCellWidth:!0}),t._applyMaxVisibleRowCount()),t._rowModel&&t.findStr&&""!==t.findStr&&!t._muteFind&&t.setFindStr(t.findStr,t.matchCase,t._rowModel._computeFindEditorCurrentValue(),!0,!0),t.pushUpdateView()}else UWA.equals(t.model,i)||(t.model=i,t._displayEmptyContentMessage())},_applySortModel:function(e){this._parent();var t=this.collectionView,i=this;if(i.sortModel&&i.sortModel.length>0){var o=i.treeDocument;if(o){for(var l=t.layout,r=[],a=new Intl.Collator,u=0;u<i.sortModel.length;u++){var d=i.sortModel[u].dataIndex,c=l.getColumnIndex(d);if(c>-1){var h=l.getColumnCompareFunction(c);h||h||(h=function(e,t,i,o,l){return"string"==typeof e&&"string"==typeof t?n.compareLocal(e,t,{intlCollator:a}):UWA.equals(e,t)||s(e)&&s(t)?0:e>t?1:e<t||s(e)&&!s(t)?-1:1});var g="desc"===i.sortModel[u].sort?-1:1;r.push({dataIndex:d,compareFunction:h,reverseFactor:g})}t.updateRowView(-1,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})}o._getTrueRoot().sortChildren({isRecursive:!0,sortFunction:function(e,i){for(var n=0,o=0;o<r.length&&0===n;){var l=r[o],s=t._getCellValueForSort(e,l.dataIndex),a=t._getCellValueForSort(i,l.dataIndex);n=l.reverseFactor*l.compareFunction(s,a,e,i,l.dataIndex),o++}return 0===n?e._getID()-i._getID():n}})}}else t.updateRowView(-1,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})},_doGroupingOnModel:function(e){const t=this,n=t.treeDocument,s=this.collectionView,r=s._isCurrentlyCalledFromUIInteraction();s.displayModalLoader(l.get("UpdatingGrouping"),(function(){n.prepareUpdate(),s.prepareUpdateView();const a=n.addEventListener("groupNodes",(()=>{n.removeEventListener(a),r&&o.pushUserInteractionContext(),i.destroyTreeDocumentOrderSnapshot(n),t._applySortModel(),r&&o.popUserInteractionContext(),n.pushUpdate(),s.pushUpdateView(),s.removeModalLoader(l.get("UpdatingGrouping"))})),u=function(e,t){const i=s.layout.getColumnGetCellValue(t);if(i){const n=s.layout.getColumnIdentifiers(t),o={cellID:s.layout.getCellIDFromCoordinates({rowID:e._getRowID(),columnID:n.columnIndex}),columnID:n.columnIndex,rowID:e._getRowID(),nodeModel:e};return i.call(s,o)}return e.getAttributeValue("tree"===t?"label":t)},d={propertiesToGroup:e.dataIndexesToGroup,canNodeBeGrouped:e=>!s.rowGroupingOptions.canNodeBeGrouped||s.rowGroupingOptions.canNodeBeGrouped(e),mapGroupingKeys:s.rowGroupingOptions.mapGroupingKeys,getNodeGroupingKey:function(e,t){var i=s.layout.getColumnGetCellGroupingKey(t);if(i){var n=s.layout.getColumnIdentifiers(t),o=s.layout.getCellIDFromCoordinates({rowID:e._getRowID(),columnID:n.columnIndex}),l=s.getLightCellInfosAt(o);return l.nodeModel=e,i.call(s,l,t)}return s.rowGroupingOptions.getNodeGroupingKey?s.rowGroupingOptions.getNodeGroupingKey(e,t):u(e,t)},updateGroupingNodeOptions:function(e){const t=this.getProperty();let i,n;if(s.rowGroupingOptions.getGroupingNodeLabel)i=s.rowGroupingOptions.getGroupingNodeLabel.call(s,this);else{let e=this.getIdentifier();"NA"===e&&(e=l.get("GroupingEmptyValueLabel"));const n=s.layout.getColumnOptionValue(t,"text");i=(n?n+": ":"")+e+" ("+this.getOriginalChildrenInformation().notHiddenNotFilteredChildrenCount+")"}s.rowGroupingOptions.getGroupingNodeIcons&&(n=s.rowGroupingOptions.getGroupingNodeIcons.call(s,this));const o={label:i,icons:n,grid:{}};s.rowGroupingOptions.getGroupingNodeOptions?o.grid=s.rowGroupingOptions.getGroupingNodeOptions.call(s,this,e):s.layout.getLeafColumns().forEach((function(t){var i=s.layout.getColumnOptionValue(t.dataIndex,"getGroupingNodeOptions");if(i)if("string"==typeof i)switch(i){case"sum":var n=0;e.forEach((function(e){n+=parseInt(u(e,t.dataIndex),10)})),o.grid[t.dataIndex]=n;break;case"avg":n=0;e.forEach((function(e){n+=parseInt(u(e,t.dataIndex),10)})),o.grid[t.dataIndex]=n/e.length;break;case"min":var l=void 0;e.forEach((function(e){var i=u(e,t.dataIndex);(void 0===l||i<l)&&(l=i)})),o.grid[t.dataIndex]=l;break;case"max":var r=void 0;e.forEach((function(e){var i=u(e,t.dataIndex);(void 0===r||i>r)&&(r=i)})),o.grid[t.dataIndex]=r;break;case"first":o.grid[t.dataIndex]=u(e[0],t.dataIndex);break;case"last":o.grid[t.dataIndex]=u(e[e.length-1],t.dataIndex)}else{var a=[];e.forEach((function(e){a.push(u(e,t.dataIndex))})),o.grid[t.dataIndex]=i.call(s,a)}})),this.updateOptions(o)}},c={maxDepth:s.rowGroupingOptions.maxDepth},h=s.rowGroupingOptions.depth;n.groupNodes(h,d,c)}))},_computeMatchingCellIDsCount:function(){return this.collectionView._matchingCellIDsArray.length},_computeMatchingNodeModelsCount:function(){return this.collectionView._matchingNodeModelsArray.length},_computeCurrentMatchingStringIndex:function(e,t){var i;return i=t>0?t-1:0,"cell"===e.findNavigationMode?e._getMatchingStringIndexFromMatchingCellIDIndex(i):"row"===e.findNavigationMode?e._getMatchingStringIndexFromMatchingRowIDIndex(i):i},_computeFindEditorCurrentValue:function(){return"substring"===this.collectionView.findNavigationMode?this.collectionView._currentMatchingStringIndex+1:"cell"===this.collectionView.findNavigationMode?this.collectionView._currentMatchingCellIDIndex+1:this.collectionView._currentMatchingRowIDIndex+1},_getNodeModelsToProcessFromMatchCaseChange:function(){return this.collectionView._matchingNodeModelsArray},_isServerSide:function(){return!1},_getNodeModelAtRowID:function(e){if(this.collectionView.model&&Array.isArray(this.collectionView.model))return this.collectionView.model[e]},_getCollectionViewModelDisplayedLength:function(){return this.collectionView.model&&Array.isArray(this.collectionView.model)?this.collectionView.model.length:0}})})),define("DS/DataGridView/RowModelServerSide",["DS/CollectionView/ItemModelServerSide","DS/Utilities/Object","DS/DataGridView/DataGridViewFilterViewManager"],(function(e,t,i){"use strict";return e.inherit({name:"RowModelServerSide",publishedProperties:{virtuallyLoadAllModelItems:{defaultValue:!1,type:"boolean"}},_applyVirtuallyLoadAllModelItems:function(){if(this.collectionView._isReady){if(this._getTreeDocument()){var e=this;this._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:!1,processNode:function(t){if(t.nodeModel){var i=[];if(e._loadedUnloadedNodesMap){var n=e._loadedUnloadedNodesMap.get(t.nodeModel.getParent());if(n)for(var o=1;o<n.length;o++)i.push(n[o]);e._rowRequestManager.clear(),e._loadedUnloadedNodesMap.clear(),e._viewRowIDNodeModelMapping.clear(),e._viewNodeModelRowIDMapping.clear()}e._updateMultipleNodesRep(t.nodeModel.getParent(),i)}}})}this._syncModel()}},_setFilterViewManager:function(){var e=this,n=this.getFilterManager();n&&(this._currentFilters=this._getFiltersModelData(this.dataSource),n.subscribe("filterModelChange",(function(i){var n=e._getFiltersModelData(e.dataSource);t.areEquals(e._currentFilters,n)||(e.collectionView.findCtx?e.collectionView.findCtx.close():e.collectionView.findWidget&&e.collectionView.findWidget.close(),e._resetTreeDocument()),e._currentFilters=n})),this._filterViewManager?this._filterViewManager.filterManager=n:this._filterViewManager=new i({view:this.collectionView,filterManager:n}))},_shouldUpdateCellWidth:function(e){if(!e)return!1;const t=this.collectionView,i=t.layout;return!!i.isAFitToContentColumn&&(!t._isCurrentlyCalledFromUIInteraction()&&Object.keys(e).some((e=>{if("label"===e&&(e="tree"),i.isAFitToContentColumn(e))return!0})))}})})),define("DS/DataGridView/CustomViewsManager",["DS/DataGridView/ColumnModel","DS/DataGridView/DataGridViewCustomViewsDialog","DS/Utilities/Utils","DS/TreeModel/ModelUtils","DS/Utilities/Dom","i18n!DS/DataGridView/assets/nls/translation"],(function(e,t,i,n,o,l){"use strict";let s="DefaultConfiguration",r=l.get(s);const a=[{identifier:s,label:r}];let u="CustomConfiguration";const d="wux-collectionView-dataGridView";let c=function(t){this.collectionView=t.collectionView?t.collectionView:void 0,this._identifier=this.collectionView?this.collectionView.identifier:t?t.identifier:void 0,this.name="CustomViewsManager",this._sortModel=this.collectionView?this.collectionView.sortModel:t?t.sortModel:[];let i=this.collectionView?this.collectionView.layout:null;this._columnModel=i?i.getColumnModel():new e,this._originalLayoutDensity=i?i._getOriginalLayoutDensity():t?t.layoutDensity:"compact",this._customViews=UWA.clone(a,!0),this._currentCustomViewIdentifier=s,this._customViewsDialog=void 0,this._prefsLoaded=!1};return c.prototype.getIdentifier=function(){return this._identifier},c.prototype.getColumnModel=function(){return this._columnModel},c.prototype.getSortModel=function(){return this._sortModel},c.prototype.getOriginalLayoutDensity=function(){return this._originalLayoutDensity},c.prototype.setOriginalLayoutDensity=function(e){this._originalLayoutDensity=e},c.prototype.getCustomViews=function(){return 0!==this._customViews.length&&!1!==this._prefsLoaded||this._loadCustomViewsFromPreferences(),this._customViews},c.prototype.getCustomView=function(e){return this._getCustomViewInArray(this._customViews,e)},c.prototype.getCurrentCustomView=function(){return this.getCustomView(this.getCurrentCustomViewIdentifier())},c.prototype.getCurrentCustomViewIdentifier=function(){return this._currentCustomViewIdentifier},c.prototype.getCurrentCustomViewIndex=function(){for(let e=0;e<this._customViews.length;e++)if(this._customViews[e].identifier===this.getCurrentCustomViewIdentifier())return e;return-1},c.prototype._setCustomViews=function(e){if(this._customViews=e,void 0!==this._currentCustomViewIdentifier){let e=!1;if(this._customViews)for(let t=0;t<this._customViews.length;t++)if(this._customViews[t].identifier===this._currentCustomViewIdentifier){e=!0;break}e||(this._currentCustomViewIdentifier=void 0)}const t=!!this.collectionView&&this.collectionView.useWidgetPreferencesFlag;i.saveDataInPreferences(this._identifier,d,"customViews",this._customViews,t)},c.prototype.setCurrentCustomView=function(e){this._currentCustomViewIdentifier=e;let t=this.getCustomView(e);if(t&&this.collectionView){let e=this.collectionView.layout;this.collectionView.prepareUpdateView();let i=!1,l=t.columnsVisibleFlag,s=t.columnsWidth,r=t.columnsPinnedState,a=e.getColumnModel(),u=e.getLeafColumns();for(let t=0;t<u.length;t++){let i=u[t].dataIndex,n=l?l[i]:void 0,o=!a||a.getOriginalColumnOptionValue(i,"visibleFlag"),d=e.getColumnVisibleFlag(i);void 0!==n&&n!==d?e.setColumnVisibleFlag(i,n,{isUserInteraction:!0}):void 0===n&&d!==o&&e.setColumnVisibleFlag(i,o);let c=s?s[i]:void 0,h=a?a.getOriginalColumnOptionValue(i,"width"):"auto",g=e.getColumnWidth(i);void 0!==c&&c!=g?e.setColumnWidth(i,c,{isUserInteraction:!0}):void 0===c&&g!=h&&e.setColumnWidth(i,h);let p=r?r[i]:void 0,m=a?a.getOriginalColumnOptionValue(i,"pinned"):"unpinned",f=e.getColumnPinned(i);void 0!==p&&p!==f?e.setColumnPinned(i,p,{isUserInteraction:!0}):void 0===p&&f!==m&&e.setColumnPinned(i,m)}let d=a?a.getOrderedColumnIndexesFromChanges(t):[],c=e.getOrderedColumnsIndexes();!UWA.equals(c,d)&&a&&(a._setOrderedColumnIndexes(d.slice(0)),this.collectionView.invalidateLayout(),i=!0);let h=this.collectionView._rowModel._originalSortModel||[],g=this.collectionView.sortModel||[],p=t.columnsSortModel,m=JSON.stringify(g),f=this.collectionView.sortModel;Array.isArray(g)&&Array.isArray(p)&&m!==JSON.stringify(p)?f=p:void 0===p&&m!==JSON.stringify(h)&&(f=h),o.isCurrentlyCalledFromUIInteraction()&&(this.collectionView.sortModel&&this.collectionView.sortModel.length>0&&(!f||0===f.length)?n.restoreTreeDocumentOrder(this.collectionView.treeDocument):f&&f.length>0&&(!this.collectionView.sortModel||0===this.collectionView.sortModel.length)&&n.saveTreeDocumentOrder(this.collectionView.treeDocument)),m!==JSON.stringify(f)&&(this.collectionView.sortModel=f,i=!0);let C=t.layoutDensity||e._getOriginalLayoutDensity();if(e.layoutDensity!==C&&(e.layoutDensity=C,this.collectionView.invalidateLayout(),i=!0),this.collectionView.rowGroupingEnabledFlag&&t.groupingOptions){let e=t.groupingOptions;this.collectionView.getGroupingOptions()&&this.collectionView.getGroupingOptions().dataIndexesToGroup.equals(e)||(i=!0,this.collectionView.groupRows(e))}let w={};i&&(w={updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}),this.collectionView.pushUpdateView(w)}const l=!!this.collectionView&&this.collectionView.useWidgetPreferencesFlag;i.saveDataInPreferences(this._identifier,d,"currentCustomViewId",this.getCurrentCustomViewIdentifier(),l),t&&this._saveCustomViewInPreferences(t)},c.prototype.createNewCustomView=function(){let e=1,t=u+e,i=this.getEditedCustomView(t);for(;i;)e++,t=u+e,i=this.getEditedCustomView(t);let n=l.get("CustomViewDefaultName"),o=1,s=n+" "+o;for(i=this.getCustomViewFromLabel(s);i;)o++,s=n+" "+o,i=this.getCustomViewFromLabel(s);let r={identifier:t,label:s};return this.addCustomView(r),this.setCurrentCustomView(r.identifier),r},c.prototype.addCustomView=function(e,t=!1){const n=this._customViews.reduce(((e,t,i)=>(e[t.identifier]=i,e)),{}),o=e=>{e.identifier&&e.identifier===r&&(e.identifier=s,e.label=r);const i=n[e.identifier];void 0===i?this._customViews.push(e):(!0===t||this._customViews[i].identifier===s&&1===Object.keys(this._customViews[i]).length)&&(this._customViews[i]=e)};if(Array.isArray(e))for(const t of e)o(t);else o(e);const l=!!this.collectionView&&this.collectionView.useWidgetPreferencesFlag;i.saveDataInPreferences(this._identifier,d,"customViews",this._customViews,l)},c.prototype.deleteCustomView=function(e){let t=0;for(;t<this._customViews.length&&this._customViews[t].identifier!==e;t++);this._customViews.splice(t,1);const n=!!this.collectionView&&this.collectionView.useWidgetPreferencesFlag;this._currentCustomViewIdentifier===e&&(this._currentCustomViewIdentifier=void 0,i.deleteDataFromPreferences(this._identifier,d,"currentCustomViewId",n)),i.saveDataInPreferences(this._identifier,d,"customViews",this._customViews,n)},c.prototype.setCustomViews=function(e,t,i,n){e&&(this._setCustomViews(e),!i&&this.collectionView||this.setCurrentCustomView(t),n&&(this.onCustomViewsSave&&this.onCustomViewsSave(e,t),this.collectionView&&this.collectionView.onCustomViewsSave&&this.collectionView.onCustomViewsSave.call(this,e,this.getCurrentCustomViewIndex())),i&&this.collectionView&&this.collectionView.layout._applyPreferencesOnColumns())},c.prototype._loadCustomViewsFromPreferences=function(){if((0===this._customViews.length||!1===this._prefsLoaded)&&this._identifier){const e=!!this.collectionView&&this.collectionView.useWidgetPreferencesFlag,t=i.getDataInPreferences(this._identifier,d,"customViews",e);t&&t.length>0&&this.addCustomView(t,!0),this._currentCustomViewIndex=-1;let n=i.getDataInPreferences(this._identifier,d,"currentCustomViewId",e);if(n)for(let e=0;e<this._customViews.length;e++){let t=this._customViews[e];if(t&&t.identifier===n){this._currentCustomViewIdentifier=n,this._currentCustomViewIndex=e;break}}this._prefsLoaded=!0}},c.prototype._getCustomViewInArray=function(e,t){let i;if(e)for(let n=0;n<e.length;n++){let o=e[n];if(o&&o.identifier===t){i=o;break}}return i},c.prototype._saveCustomViewInPreferences=function(e){if(e&&this._identifier){const t=!!this.collectionView&&this.collectionView.useWidgetPreferencesFlag;let n=this.collectionView?this.collectionView.sortModel:e.columnsSortModel;i.saveDataInPreferences(this._identifier,d,"columnsSortModel",n,t);let o=["columnsPinnedState","columnsVisibleFlag","columnsWidth","pinnedColumnsOrder","unpinnedColumnsOrder","columnsSortModel","readOnly","readOnlyWarningMessage"];for(let n=0;n<o.length;n++)i.deleteDataFromPreferences(this._identifier,d,o[n],t),e[o[n]]&&i.saveDataInPreferences(this._identifier,d,o[n],e[o[n]],t);this.collectionView&&this.collectionView.fire("userPreferencesChange")}},c.prototype.showCustomViewsDialog=function(){let e=this.collectionView&&this.collectionView.customViewsOptions&&this.collectionView.customViewsOptions.dialogMaximizedFlag,i=this.collectionView&&this.collectionView.getContainingImmersiveFrame?this.collectionView.getContainingImmersiveFrame():void 0;return this._customViewsDialog||(this._customViewsDialog=new t({identifier:this._identifier+"_CustomViewsDialog",customViewsManager:this,dataGridView:this.collectionView,maximizeButtonFlag:!0,allowMaximizeFlag:!0,maximizedFlag:e,immersiveFrame:i})),this._customViewsDialog.loadCustomViews(),this._customViewsDialog.immersiveFrame=i,this._customViewsDialog.visibleFlag=!0,this._customViewsDialog.maximizedFlag=e,this._customViewsDialog},c.prototype.destroy=function(){this._customViewsDialog&&(this._customViewsDialog.destroy(),this._customViewsDialog=null),this._customViews=void 0,this._currentCustomViewIdentifier=void 0,this.collectionView=void 0},c})),define("DS/DataGridView/DataGridView",["UWA/Core","UWA/Utils/Client","DS/CollectionView/CollectionView","DS/DataGridView/DataGridViewLayout","DS/DataGridView/RowModelClientSide","DS/DataGridView/RowModelServerSide","DS/Core/PointerEvents","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/ModelUtils","DS/Tweakers/TypeRepresentationFactory","DS/DataGridView/DataGridViewRow","DS/DataGridView/DataGridViewCell","DS/DataGridView/DataGridViewColumnHeaderCell","DS/DataGridView/DataGridViewRowHeaderCell","DS/DataGridView/DataGridViewTreeNodeCell","DS/DataGridView/CustomViewsManager","DS/Utilities/Dom","DS/Utilities/Utils","DS/Utilities/TreeUtils","DS/Menu/ContextualMenu","DS/DataGridView/DataGridViewContextualMenuBuilder","DS/Controls/SelectionChips","DS/Controls/Button","DS/Tweakers/GeneratedToolbar","DS/CollectionView/edition/CollectionViewEditionOnDoubleClick","DS/CollectionView/edition/CollectionViewEditionOnClick","DS/CollectionView/edition/CollectionViewDelayedEditionOnClick","DS/CollectionView/edition/CollectionViewEditionOnOver","DS/CollectionView/edition/CollectionViewEditionInPlace","i18n!DS/DataGridView/assets/nls/translation","DS/DataGridView/ModelMassUpdateDialog","DS/Windows/Dialog","DS/Selection/XSO","DS/WebappsUtils/WebappsUtils","DS/Core/WebUXComponents"],(function(e,t,i,n,o,l,s,r,a,u,d,c,h,g,p,m,f,C,w,_,D,I,y,V,v,b,x,M,F,O,S,P,R,A,G,E){"use strict";const T=t.Engine;let N,L,H,k,B=4,U=!1,W=!1,j=!1;function X(e){return"COLUMNHEADER_"+e}const z=Object.freeze({showIconsFlag:!0,buildLinks:!0,expanderStyle:"classic",depthIncrement:22,rootMargin:{mouse:18,touch:25},cellClass:m});function K(e,t){if(window.notifs){const i={level:"info",title:S[e],message:S[t],sticky:!1};window.notifs.addNotif(i)}}function q(t){const i=this.getTypeRepresentationFactory(),n=t.rowID<0?"string":this.layout._getCellTypeRepresentation(t),o=this.getCellSemantics(t);const l={touchMode:!1,typeRep:i.getRegisteredTypeRepresentation(n),readOnly:!0,semantics:o};let s=i.getTweakerStaticStringFromValue(t.cellModel,l,{context:"export"});if(!(s instanceof Promise)){if(void 0!==t.cellModel&&this.layout.getColumnAllowUnsafeHTMLContent(t.columnID)){const t=e.createElement("div");t.innerHTML=s,s=t.innerText}return s||void 0}}function J(e,t){let i;return i="object"==typeof e.cellModel&&null!==e.cellModel?e.cellModel instanceof Date?new Date(t):JSON.parse(t):t,i}function Y(e,t){let i;return i="tree"===t?e.options.label:e.options.grid[t],i instanceof Object&&i.hasOwnProperty("label")&&(i=i.label),i}function Q(t,i){if(j){const n=this.layout,o="middle"===t.dropPosition?n.getRowHeight(t.rowID):2;let l=0;l="top"===t.dropPosition?n.getRowPosition(t.rowID):"bottom"===t.dropPosition?n.getRowPosition(t.rowID)+n.getRowHeight(t.rowID):n.getRowPosition(t.rowID);const s=n.getHeaderContainerHeight()+l-this.getScrollerPosition().y,r=n.getColumnIndex("tree");let a,u,d=-1;if(void 0!==r){const e=n.getCellIDFromCoordinates({rowID:t.rowID,columnID:r}),i=this._getViewAt(e);if(i){const e=i.elements.linksContainer.getBoundingClientRect(),t=this.getContent().getBoundingClientRect();d=e.right-t.left+1}}this._rowReorderDnDInfos.elements.line||(this._rowReorderDnDInfos.elements.line=new e.Element("div",{class:"wux-datagridview-drag-row-feedback"}),this._rowReorderDnDInfos.elements.chip=new e.Element("div",{class:"wux-datagridview-drag-row-feedback-chip"}).inject(this._rowReorderDnDInfos.elements.line),this._rowReorderDnDInfos.elements.line.inject(this.getContent())),"middle"===t.dropPosition?(a="none",u=!0===i?"1px solid #368ec4":!1===i?"1px solid #844138":"1px solid #E87B00"):(a=!0===i?"#368ec4":!1===i?" #844138":"#E87B00",u="none"),this._rowReorderDnDInfos.elements.line.setStyles({display:"block",top:s,height:o,border:u,background:a}),this._rowReorderDnDInfos.elements.chip.setStyles({display:"middle"===t.dropPosition||-1===d?"none":"block",left:d,background:a})}}function $(){this._rowReorderDnDInfos.elements.line&&this._rowReorderDnDInfos.elements.line.hide()}function Z(e,t){let i;if(t.cellView){let n=0,o=0;const l=t.cellView.getContent().getBoundingClientRect();let s=!0;const r=this.getTreeDocument();if(r){const e=r.usesAsyncDndCallbacks(),i=Object.getPrototypeOf(this).__rowReorderDnDInfos;if(i&&i.nodes&&i.nodes.length>0)for(let n=0;n<i.nodes.length;n++){if(i.nodes[n].isAscendantOf(t.nodeModel)||!e&&"function"==typeof r.options.shouldAcceptDrop&&!r.options.shouldAcceptDrop({parentTreeNodeModel:t.nodeModel,draggedTreeNodeModel:i.nodes[n],draggedNodes:i.nodes,dropNode:t.nodeModel,dropPosition:"middle"})){s=!1;break}}}s?(n=l.top+l.height/3,o=l.top+2*l.height/3):n=o=l.top+l.height/2,i=e.clientY<n?"top":e.clientY>=o?"bottom":"middle"}return i}function ee(t,i){if(!(i.draggedNodes&&0!==i.draggedNodes.length||t.defaultPrevented))return!1;this._rowReorderDnDInfos.dropPosition=i.dropPosition;const n=this;let o=!1;const l=this.getTreeDocument();if(l&&i.draggedNodes){const s={parentTreeNodeModel:"middle"===i.dropPosition?i.nodeModel:i.nodeModel.getParent(),draggedNodes:i.draggedNodes,dropPosition:i.dropPosition,dropNode:i.nodeModel};if(e.equals(s,this._latestShouldAcceptDropOptions))o=this._rowReorderDnDInfos.dropAccepted;else{this._latestShouldAcceptDropOptions=s;if(l.usesAsyncDndCallbacks())o=null,new Promise((function(e,t){l.options.shouldAcceptDrop(s,e,t)})).then((function(e){e||(t.dataTransfer.dropEffect="none"),n._rowReorderDnDInfos.dropAccepted=e,Q.call(n,i,e)}));else{o=!0;for(let e=0;e<i.draggedNodes.length;e++){const t=i.draggedNodes[e].isAscendantOf(i.nodeModel);if(s.draggedTreeNodeModel=i.draggedNodes[e],t||"function"==typeof l.options.shouldAcceptDrop&&!l.options.shouldAcceptDrop(s)){o=!1;break}}}}}return this._rowReorderDnDInfos.dropAccepted=o,Q.call(this,i,o),this._rowReorderDnDInfos.dropAccepted}function te(e,t){const i=Object.getPrototypeOf(this).__rowReorderDnDInfos;if(!i||i.source!==this._uuid||!i.nodes)return!1;const n=this.getDraggedRowData(e);if(n&&n.rowID!==t.rowID&&this._rowReorderDnDInfos.dropAccepted){const e=t.nodeModel.getTreeDocument();if(e){e.prepareUpdate(),this.prepareUpdateView();const n=e.getUseChangeTransactionMode();e.setUseChangeTransactionMode(!1);const o="middle"===this._rowReorderDnDInfos.dropPosition?0:"top"===this._rowReorderDnDInfos.dropPosition?-1:1,l=u.moveNodes(i.nodes,t.nodeModel,{direction:o,ensureVisible:!0});if(e.pushUpdate(),this.sortModel=[],this.pushUpdateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}),l.isExpanded()||l._isTrueRoot()){for(let e=0;e<i.nodes.length;e++){const t=i.nodes[e];t&&this.flashEffectOnNodeModel("ui-modified",t)}this.ensureNodeModelVisible(i.nodes[0],!0,!0,.5)}else this.flashEffectOnNodeModel("ui-modified",l),this.ensureNodeModelVisible(l,!0,!0,.5);e.setUseChangeTransactionMode(n)}else this._flashEffectOnRow("ui-notmodified",n.rowID)}return!0}function ie(e,t){const i={},n={};let o;for(o=t.offsetParent,i.x=e.touches?e.touches[0].pageX:e.pageX,i.y=e.touches?e.touches[0].pageY:e.pageY,n.left=t.offsetLeft,n.top=t.offsetTop;o;)n.left+=o.offsetLeft,n.top+=o.offsetTop,o=o.offsetParent;return{x:i.x-n.left,y:i.y-n.top}}function ne(e){const t=this;this._disableAutoScroll();const i={x:e.x,y:e.y};this._autoScrollInfos.interval=setInterval((function(){i.x+=t._autoScrollInfos.moveX,i.y+=t._autoScrollInfos.moveY,t.setScrollerPosition(i)}),60)}function oe(){null!==this._autoScrollInfos.interval&&(clearInterval(this._autoScrollInfos.interval),this._autoScrollInfos.interval=null)}function le(e,t){const i=this._getScroller().getContent(),n=ie(e,i),o=this.getScrollerPosition();this._autoScrollInfos.moveY=0,this._autoScrollInfos.moveX=0;const l=this.elements.rowHeaderExtensionPoolContainer?this.elements.rowHeaderExtensionPoolContainer.getDimensions().width:0;if(n.x>=-(this._leftContainerWidth+l)&&n.x<=i.clientWidth+this._rightContainerWidth&&n.y>=0&&n.y<=i.clientHeight){const e=40;n.y<e&&0!==o.y?this._autoScrollInfos.moveY=n.y-e:n.y>i.clientHeight-e&&Math.abs(o.y+i.clientHeight-i.scrollHeight)>=1&&(this._autoScrollInfos.moveY=n.y-(i.clientHeight-e))}if(t&&t.rowID<0){const t=this.elements.headerScrollContainer,i=ie(e,t);if(i.x>=0&&i.x<=t.clientWidth){const e=60;i.x<e&&0!==o.x?this._autoScrollInfos.moveX=i.x-e:i.x>t.clientWidth-e&&Math.abs(o.x+t.clientWidth-t.scrollWidth)>=1&&(this._autoScrollInfos.moveX=i.x-(t.clientWidth-e))}const n=ie(e,this.getContent());if(n.x<0||n.y<0)return oe.call(this),!1}return this._autoScrollInfos.interval||0===this._autoScrollInfos.moveY&&0===this._autoScrollInfos.moveX||this._infoOnTouchDown&&(this._infoOnTouchDown.clientX===e.clientX||this._infoOnTouchDown.clientY===e.clientY)?0===this._autoScrollInfos.moveX&&0===this._autoScrollInfos.moveY&&oe.call(this):ne.call(this,o),0!==this._autoScrollInfos.moveY}function se(e){if(this._draggedColumnOrGroup&&this._draggedColumnOrGroup._isMoving){this._draggedColumnOrGroup._isMoving=!1,_.processTreeChildren(this._draggedColumnOrGroup.children,(function(e){e._isMoving=!1}));const t=_.getLeafItems(this._draggedColumnOrGroup);for(let e=0;e<t.length;e++){const i=t[e];0===e&&(i._isFirstColumnMoving=!1)}if(e){const e=this.layout;this._updateColumnHeaderCells({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0});for(let i=0;i<t.length;i++){const n=t[i],o=e.getColumnIndex(n.dataIndex);this.updateColumnView(o,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})}}}}function re(t){const i=S.Menu,n=this._getCurrentTouchMode(),o=n?14:12,l=n?28:14,s=Math.max(Math.ceil(C.computeStringWidth(i,o,"Arial",!1,!1))+l,45),r={completed:!0,text:i,dataIndex:"ContextualMenuColumn",pinned:"right",editableFlag:!1,sortableFlag:!1,groupableFlag:!1,resizableFlag:!1,selectableFlag:!1,printableFlag:!1,width:s,alignment:"center",getCellTooltip:function(e){if(e.nodeModel)return{shortHelp:i}},getCellValue:function(e){return{}}},a=e.merge(t,r);return a.typeRepresentation="chevronMenuIcon",a}function ae(t,i){const n=t.cellView;n.nodeModel!==i?n.nodeModel=i:n._applyNodeModel(i);const o=this.layout.getColumnGetCellIcons(t.columnID);if(o){const i=o(t);e.equals(n.icons,i)?n.nodeModel&&n.checkBadges()&&n._applyIcons():n.icons=i}}function ue(e){const t=this.layout.getColumnModel();return e&&e.updateCellWidth&&!e.postUpdateCellWidth&&t&&t.hasFitContentColumn()}const de=i.inherit({name:"dataGridView",publishedProperties:{useWidgetPreferencesFlag:{defaultValue:!1,type:"boolean",readOnly:!0},maxVisibleRowCount:{defaultValue:void 0,type:"number",category:"Behavior"},treeDocument:{defaultValue:null,type:"object"},dataSource:{defaultValue:null,type:"object"},layoutOptions:{defaultValue:null,type:"object",readOnly:!0},virtuallyLoadAllModelItems:{defaultValue:!1,type:"boolean"},syncClientModelOnDemand:{defaultValue:!1,type:"boolean"},cellSelection:{defaultValue:"multiple",type:"string"},defaultColumnDef:{defaultValue:{showTextFlag:!0,description:"",typeRepresentation:"string",getCellTypeRepresentation:function(e){const t=this.layout;return t?t.getColumnTypeRepresentation(e.columnID):"string"},width:"auto",minWidth:40,autoRowHeightFlag:!1,visibleFlag:!0,alwaysVisibleFlag:!1,editableFlag:!1,disabled:!1,editionPolicy:"EditionOnDoubleClick",resizableFlag:!0,selectableFlag:!0,sortableFlag:!0,groupableFlag:!0,printableFlag:!0,massUpdateAllowedFlag:!0,pinned:"unpinned",autoSizePadding:0,allowUnsafeHTMLContent:!1,allowWrapFlag:!1,shouldCellAllowUnsafeHTMLContentAt:function(e){const t=this.layout;return!!t&&t.getColumnAllowUnsafeHTMLContent(e.columnID)},allowResetToUndefinedByUIFlag:!1,className:"",getCellClassName:function(e){const t=this.layout;return!!(t&&e.rowID>=0)&&t.getColumnClassName(e.columnID)},getCellIcons:function(e){if(e.nodeModel&&e.nodeModel.getIcons)return e.nodeModel.getIcons()}},type:"object"},columns:{defaultValue:[],type:"array"},sortModel:{defaultValue:null,type:"array",advancedSetter:!0},sortOptions:{defaultValue:void 0,type:"object"},layout:{defaultValue:null,type:"object"},cellClass:{defaultValue:h,type:"object"},rowGroupingOptions:{defaultValue:{depth:0,maxDepth:void 0,hideGroupedColumns:!0,canNodeBeGrouped:null,getNodeGroupingKey:null,getGroupingNodeOptions:null,getGroupingNodeLabel:null,getGroupingNodeIcons:null,mapGroupingKeys:null},type:"object"},onContextualEvent:{defaultValue:function(e){let t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e)),t},type:"function"},columnSelection:{defaultValue:"none",type:"string"},rowReorderEnabledFlag:{defaultValue:!0,type:"boolean",noNeedToApplyFlag:!0},rowGroupingEnabledFlag:{defaultValue:!0,type:"boolean",noNeedToApplyFlag:!0},columnDragEnabledFlag:{defaultValue:!0,type:"boolean"},onDragStartColumnHeader:{defaultValue:void 0,type:"function"},onDragEndColumnHeader:{defaultValue:void 0,type:"function"},onDragEnterColumnHeader:{defaultValue:void 0,type:"function"},onDragLeaveColumnHeader:{defaultValue:void 0,type:"function"},onDragColumnHeader:{defaultValue:void 0,type:"function"},onDragOverColumnHeader:{defaultValue:void 0,type:"function"},onDropColumnHeader:{defaultValue:void 0,type:"function"},rowDragEnabledFlag:{defaultValue:!1,type:"boolean"},onDragStartRowHeader:{defaultValue:void 0,type:"function"},onDragEndRowHeader:{defaultValue:void 0,type:"function"},onDragEnterRowHeader:{defaultValue:void 0,type:"function"},onDragLeaveRowHeader:{defaultValue:void 0,type:"function"},onDragRowHeader:{defaultValue:void 0,type:"function"},onDragOverRowHeader:{defaultValue:void 0,type:"function"},onDropRowHeader:{defaultValue:void 0,type:"function"},cellDragEnabledFlag:{defaultValue:!1,type:"boolean"},onDragStartCell:{defaultValue:void 0,type:"function"},onDragEndCell:{defaultValue:void 0,type:"function"},onDragEnterCell:{defaultValue:void 0,type:"function"},onDragLeaveCell:{defaultValue:void 0,type:"function"},onDragCell:{defaultValue:void 0,type:"function"},onDragOverCell:{defaultValue:void 0,type:"function"},onDropCell:{defaultValue:void 0,type:"function"},onDragStartBlank:{defaultValue:void 0,type:"function"},onDragEndBlank:{defaultValue:void 0,type:"function"},onDragEnterBlank:{defaultValue:void 0,type:"function"},onDragLeaveBlank:{defaultValue:void 0,type:"function"},onDragBlank:{defaultValue:void 0,type:"function"},onDragOverBlank:{defaultValue:void 0,type:"function"},onDropBlank:{defaultValue:void 0,type:"function"},focusNextEditableCellOnTabFlag:{defaultValue:!1,type:"boolean",noNeedToApplyFlag:!0},selectNextCellOnEnterFlag:{defaultValue:!0,type:"boolean",noNeedToApplyFlag:!0},cellActivationFeedback:{defaultValue:"cell",type:"string"},showEditableFeedbackFlag:{defaultValue:!0,type:"boolean"},showRequiredFeedbackFlag:{defaultValue:!0,type:"boolean"},showColumnBorderFlag:{defaultValue:!1,type:"boolean"},showModelChangesFlag:{defaultValue:!1,type:"boolean"},showAlternateBackgroundFlag:{defaultValue:!0,type:"boolean"},showRowIndexFlag:{defaultValue:!0,type:"boolean"},showSelectionCheckBoxesFlag:{defaultValue:"OnOver",type:"string"},showOutlineFlag:{defaultValue:!1,type:"boolean"},showRowHeaderBackgroundFlag:{defaultValue:!0,type:"boolean"},showContextualMenuColumnFlag:{defaultValue:!1,type:"boolean"},treeNodeCellOptions:{defaultValue:void 0,type:"TreeNodeCellOptions",advancedSetter:!0},showNodeKPIColorFlag:{defaultValue:!1,type:"boolean"},placeholder:{defaultValue:S.get("NoObjectsFound"),type:"string"},getCellTooltip:{defaultValue:null,type:"function",noNeedToApplyFlag:!1},useAsyncPreExpand:{defaultValue:void 0,type:"boolean"},selectionStyle:{defaultValue:"",type:"string"},findNavigationMode:{defaultValue:"substring",type:"string"},showMatchingCellBackgroundFlag:{defaultValue:!1,type:"boolean"},shouldNodeBeRepresented:{defaultValue:function(e){return!0},type:"function",noNeedToApplyFlag:!0},customViewsOptions:{defaultValue:void 0,type:"object",noNeedToApplyFlag:!0},filterViewOptions:{defaultValue:void 0,type:"object"},deleteOptions:{defaultValue:void 0,type:"object",noNeedToApplyFlag:!0},columnHeadersLayout:{defaultValue:g.COLUMN_HEADERS_LAYOUT.DEFAULT,type:"enum"}},_useTreeDocumentRestoration:!0,_currentlyCalledFromApplyPreferencesFlag:!1,__preferencesRestored:!1,_manageKeyboard:function(){this._parent();const t=Object.assign({},this.commands),i=this.commands.deleteKeyPressed;e.extend(t,{rightMove:function(){const e=this.computeCellIDFromActiveCell("right");if("row"===this.cellActivationFeedback){const t=this.getCellInfosAt(e);t&&t.nodeModel&&t.nodeModel.getChildren()&&"noExpandState"!==t.nodeModel._expandState&&"expandingState"!==t.nodeModel._expandState&&(!t.nodeModel.isExpanded()||"partiallyExpandedState"===t.nodeModel._expandState)&&t.nodeModel.expand()}else this.selectionBehavior.toggle?this.setActiveCell(e):this.selectCell(e,!1,!1);return{preventDefault:!0}},leftMove:function(){const e=this.computeCellIDFromActiveCell("left");if("row"===this.cellActivationFeedback){const t=this.getCellInfosAt(e);t&&t.nodeModel&&t.nodeModel.getChildren()&&"noExpandState"!==t.nodeModel._expandState&&"expandingState"!==t.nodeModel._expandState&&t.nodeModel.isExpanded()&&"partiallyExpandedState"!==t.nodeModel._expandState&&t.nodeModel.collapse()}else this.selectionBehavior.toggle?this.setActiveCell(e):this.selectCell(e,!1,!1);return{preventDefault:!0}},deleteKeyPressed:function(){this.deleteOptions&&this.deleteOptions.deleteSelectionOnKeyPress&&this._askForDeletion(),i.call(this)}}),this.commands=t},getCurrentRootMargin:function(){return this._getCurrentTouchMode()?this.treeNodeCellOptions.rootMargin.touch:this.treeNodeCellOptions.rootMargin.mouse},_preBuildView:function(e){this._parent(e),this._initialized=!1,this._editionManagers=[],this._useClipboardFlag=!0,this._properties.layout.value=new n(e?e.layoutOptions:e),this._properties.treeNodeCellOptions.value=Object.assign({},z),this._contextualMenuBuilder=new I(this),this._selectAllCheckBoxListenChange=!0,this._hasFlatTreeState=!0,this._tweakerToGenerateCount=0,this._inOnAllCellsRendered=!1,this._resetRowHeightsOnAllCellsRenderedFlag=!1,this._modelMassUpdateDialog=null,this._asyncExpandSubscribed=!1,this._asyncExpandToken=null,this._customViewsManager=null,this._rowReorderDnDInfos={elements:{line:null,chip:null},direction:-1,dropAccepted:!1},this._disableRowReorderCpt=0,this._autoScrollInfos={interval:null,moveX:0,moveY:0},this._updateRowNeeded=!1,this._renderRowOptions={}},buildView:function(){this._parent(),this.getContent().classList.add("wux-layouts-datagridview"),this.elements.rowHeaderExtension=new e.Element("div",{class:"wux-datagridview-layouts-row-header-extension"}),this.elements.rowHeaderExtensionHeaderPoolContainer=new e.Element("div",{class:"wux-datagridview-layouts-row-header-extension-header-poolcontainer"}).inject(this.elements.rowHeaderExtension),this.elements.rowHeaderExtensionScrollContainer=new e.Element("div",{class:"wux-datagridview-layouts-row-header-extension-scroll-container"}),this.elements.rowHeaderExtensionPoolContainer=new e.Element("div",{class:"wux-datagridview-layouts-row-header-extension-poolcontainer"}).inject(this.elements.rowHeaderExtensionScrollContainer),this.elements.rowHeaderExtensionScrollContainer.inject(this.elements.rowHeaderExtension),this.elements.rowHeaderExtension.inject(this.elements.container)},_handleEvents:function(){this._parent();const e=this.elements.scroller;C.addEventOnElement(this,this.elements.rowHeaderExtensionPoolContainer,"wheel",(function(t){let i=t.deltaY;t.deltaMode&&1===t.deltaMode&&(i*=this.layout.cellHeight),e.setPosition({y:e.elements.container.scrollTop+i},!0)}));const t=function(e,t){if(this._isCurrentlyCalledFromUIInteraction()&&t&&t.columnID>=0&&("change"===e.type||"liveChange"===e.type&&!0===this.layout.getColumnOptionValue(t.columnID,"liveUpdateFlag"))&&t.cellView&&t.rowID>=0){ce.call(this);const e=t.cellView.getReusableContent();if(e){const i=e.value,n=e.referenceValue;this.setModelAt(t.cellID,i,n),this._matchingCellIDsArray&&!this._muteFind&&this.setFindStr(this.findStr,this.matchCase,this._rowModel._computeFindEditorCurrentValue(),!0,!0)}}};C.addEventOnElement(this,this,"change",t.bind(this)),C.addEventOnElement(this,this,"liveChange",t.bind(this))},_applyProperties:function(e){this.isDirty("maxVisibleRowCount")&&this._applyMaxVisibleRowCount(e.maxVisibleRowCount),this._parent(e),this.isDirty("virtuallyLoadAllModelItems")&&this._applyVirtuallyLoadAllModelItems(e.virtuallyLoadAllModelItems),this.isDirty("treeDocument")&&this._applyTreeDocument(e.treeDocument),this.isDirty("defaultColumnDef")&&this._applyDefaultColumnDef(e.defaultColumnDef),this.isDirty("layout")&&this._applyLayout(e.layout),this.isDirty("columns")&&this._applyColumns(e.columns),this.isDirty("showContextualMenuColumnFlag")&&this._applyShowContextualMenuColumnFlag(e.showContextualMenuColumnFlag),this.isDirty("sortModel")&&E._applyForAdvancedSetterProperty(this,"sortModel",e.sortModel,this.sortModel),this.isDirty("columnSelection")&&this._applyColumnSelection(e.columnSelection),this.isDirty("columnDragEnabledFlag")&&this._applyColumnDragEnabledFlag(e.columnDragEnabledFlag),this.isDirty("rowDragEnabledFlag")&&this._applyRowDragEnabledFlag(e.rowDragEnabledFlag),this.isDirty("cellDragEnabledFlag")&&this._applyCellDragEnabledFlag(e.cellDragEnabledFlag),this.isDirty("cellActivationFeedback")&&this._applyCellActivationFeedback(e.cellActivationFeedback),this.isDirty("showEditableFeedbackFlag")&&this._applyShowEditableFeedbackFlag(e.showEditableFeedbackFlag),this.isDirty("showRequiredFeedbackFlag")&&this._applyShowRequiredFeedbackFlag(e.showRequiredFeedbackFlag),this.isDirty("showRowBorderFlag")&&this._applyShowRowBorderFlag(e.showRowBorderFlag),this.isDirty("showColumnBorderFlag")&&this._applyShowColumnBorderFlag(e.showColumnBorderFlag),this.isDirty("showAlternateBackgroundFlag")&&this._applyShowAlternateBackgroundFlag(e.showAlternateBackgroundFlag),this.isDirty("showRowIndexFlag")&&this._applyShowRowIndexFlag(e.showRowIndexFlag),this.isDirty("showSelectionCheckBoxesFlag")&&this._applyShowSelectionCheckBoxesFlag(e.showSelectionCheckBoxesFlag),this.isDirty("showOutlineFlag")&&this._applyShowOutlineFlag(e.showOutlineFlag),this.isDirty("showRowHeaderBackgroundFlag")&&this._applyShowRowHeaderBackgroundFlag(e.showRowHeaderBackgroundFlag),this.isDirty("treeNodeCellOptions")&&E._applyForAdvancedSetterProperty(this,"treeNodeCellOptions",e.treeNodeCellOptions,this.treeNodeCellOptions),this.isDirty("showNodeKPIColorFlag")&&this._applyShowNodeKPIColorFlag(e.showNodeKPIColorFlag),this.isDirty("rowGroupingOptions")&&this._applyRowGroupingOptions(e.rowGroupingOptions),this.isDirty("placeholder")&&this._applyPlaceholder(e.placeholder),this.isDirty("useAsyncPreExpand")&&this._applyUseAsyncPreExpand(e.useAsyncPreExpand),this.isDirty("selectionStyle")&&this._applySelectionStyle(e.selectionStyle),this.isDirty("findNavigationMode")&&this._applyFindNavigationMode(e.findNavigationMode),this.isDirty("showMatchingCellBackgroundFlag")&&this._applyShowMatchingCellBackgroundFlag(e.showMatchingCellBackgroundFlag),this.isDirty("filterViewOptions")&&this._applyFilterViewOptions(e.filterViewOptions)},_applyColumnHeadersLayout:function(e){this.columnHeadersLayout!==e&&void 0!==e&&this.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})},_applyMaxVisibleRowCount:function(e){if(void 0!==this.maxVisibleRowCount){const e=this.getRowModelLength(),t=0===e?0:this.layout.getRowHeight(0),i=0===e?0:this.layout.rowSpacing,n=this.layout.getHeaderContainerHeight(),o=Math.min(this.maxVisibleRowCount,e);this._heightForGivenRowCount=t*o+i*(o-1)+n;const l=this.getStatusBarContainerHeight();this._heightForGivenRowCount+=l,this.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})}else e&&(this.height=void 0)},_applyTouchMode:function(){this._parent();const e=this._getCurrentTouchMode();B=e?8:4,this._isReady&&(void 0!==this.maxVisibleRowCount&&this._applyMaxVisibleRowCount(),this.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}))},_applyVirtualViewportSize:function(){this._parent(),void 0!==this.maxVisibleRowCount&&void 0!==this._heightForGivenRowCount&&(this._hasLeftContainerHorizontalOverflow||this._hasCenterContainerHorizontalOverflow||this._hasRightContainerHorizontalOverflow?this.height=this._heightForGivenRowCount+w.getScrollbarWidth():this.height=this._heightForGivenRowCount);const e=this.layout,t=this.getStatusBarContainerHeight();this.elements.rowHeaderExtension.setStyle("bottom",t+"px");const i=e.rowsHeader?e.getRowHeaderWidth():0;e.rowsHeader?(this.elements.rowHeaderExtension.removeAttribute("hideBorder"),this.elements.rowHeaderExtension.style.width=i+"px"):(this.elements.rowHeaderExtension.setAttribute("hideBorder",""),this.elements.rowHeaderExtension.style.width="0px");const n=this._headerContainerHeight;this._rowHeaderExtensionHeaderContainerHeight!==n&&(this._rowHeaderExtensionHeaderContainerHeight=n,this.elements.rowHeaderExtensionHeaderPoolContainer.setStyle("height",this._headerContainerHeight));const o=this.__cachedContentDimensions.height+(this._hasCenterContainerHorizontalOverflow?0:1);this._rowHeaderExtensionContainerHeight!==o&&(this._rowHeaderExtensionContainerHeight=o,this.elements.rowHeaderExtensionScrollContainer.setStyle("height",o),this.elements.rowHeaderExtensionPoolContainer.setStyle("height",o));const l=this.getScrollerPosition();if(this.elements.rowHeaderExtensionPoolContainer.setStyle("top",(l?-l.y:0)+"px"),this.hasLeftContainer()&&this._rowHeaderWidth!==i){this._rowHeaderWidth=i;const e=i;this.elements.leftHeaderScrollContainer.setStyle("left",e),this.elements.leftScrollContainer.setStyle("left",e),this.elements.leftSpacerContainer.setStyle("left",e)}},_applyModel:function(e){this._parent(e);const t=this.layout;if(t&&!this.virtuallyLoadAllModelItems){t.resetRowHeights();const e=t.getColumnModel();e&&e.hasColumnWithAutoRowHeightFlag()&&this._resetRowHeightsOnAllCellsRendered()}const i=this._activeCellStableID;this._updateXSOElements(),this._updateActiveCell(i)},_applyHeight:function(e){e!==this.height&&(this._parent(),"inherit"!==this.height&&(this.elements.container.style.position&&"static"!==this.elements.container.style.position||(this.elements.container.style.position="relative")))},_applyFilterViewOptions:function(e){const t=this.getFilterViewManager();t&&t.refreshFilterViews()},getFilterViewManager:function(){if(this._rowModel)return this._rowModel._filterViewManager||(this._rowModel._filterViewManager=new DataGridViewFilterViewManager({view:this})),this._rowModel._filterViewManager},getUseClipboardFlag:function(){return this._useClipboardFlag},setUseClipboardFlag:function(e){this._useClipboardFlag=e},_applyDataSource:function(e){if(this.dataSource&&e!==this.dataSource){void 0===this._rowModel&&(this._rowModel=new l({collectionView:this,sortModel:this.sortModel,rowGroupingOptions:this.rowGroupingOptions,virtuallyLoadAllModelItems:this.virtuallyLoadAllModelItems})),this._parent(e);const t=this.getTreeDocument();t&&this._subscribeToPreExpand(t)}},_applyVirtuallyLoadAllModelItems:function(e){this._rowModel&&this._rowModel.dataSource&&(this._rowModel.virtuallyLoadAllModelItems=this.virtuallyLoadAllModelItems)},_applyTreeDocument:function(e){const t=this.treeDocument;e&&t!==e&&(this._unsubscribeToPreExpand(e),this._useTreeDocumentRestoration&&u.destroyTreeDocumentOrderSnapshot(e)),t&&(void 0===this._rowModel?this._rowModel=new o({collectionView:this,sortModel:this.sortModel,rowGroupingOptions:this.rowGroupingOptions,treeDocument:t}):this._rowModel.treeDocument=t,t!==e&&this._subscribeToPreExpand(t),this.getGroupingOptions()&&this.groupRows(this.getGroupingOptions()))},_applyUseAsyncPreExpand:function(e){const t=this.getTreeDocument();t&&void 0!==this.useAsyncPreExpand&&(t.options.useAsyncPreExpand=this.useAsyncPreExpand)},_applySelectionStyle:function(e){"lightSelectionEdging"===this.selectionStyle?this.getContent().setAttribute("selection-style",this.selectionStyle):this.getContent().removeAttribute("selection-style")},_applyFindNavigationMode:function(e){if(this.getContent().setAttribute("find-navigation-mode",this.findNavigationMode),this.findStr&&""!==this.findStr&&!this._muteFind){const e=void 0===this._currentMatchingStringIndex?0:this._currentMatchingStringIndex+1;this.setFindStr(this.findStr,this.matchCase,e,!0,!0)}},_applyShowMatchingCellBackgroundFlag:function(e){this.showMatchingCellBackgroundFlag?this.getContent().setAttribute("show-matching-cell-background",""):this.getContent().removeAttribute("show-matching-cell-background")},_unsubscribeToPreExpand:function(e){e&&this._asyncExpandToken&&e.getModelEvents()&&e.getModelEvents().unsubscribe(this._asyncExpandToken),this._asyncExpandSubscribed=!1,this._asyncExpandToken=null},_subscribeToPreExpand:function(e){if(e&&!this._asyncExpandSubscribed){this._asyncExpandSubscribed=!0;const t=this;this._asyncExpandToken=e.getModelEvents().subscribe({event:"preExpandPrivate"},(function(i){if(e.options&&e.options.useAsyncPreExpand&&e.getExpandingCounter()<=1){const n=i.target,o=t.layout.getColumnIndex("tree");if(void 0!==o){const i=t.layout.getCellIDFromCoordinates({rowID:n._getRowID(),columnID:o}),l=t._getViewAt(i);l&&(l.elements.expanderContainer.setAttribute("data-wux-state","expanding"),e.getModelEvents().subscribeOnce({event:"PRE_EXPAND_DONE"},(function(e){const t=n.getChildren();"collapsed"===n.getState()?l.elements.expanderContainer.setAttribute("data-wux-state","collapsed"):t&&0!==t.length?"partiallyExpanded"===n.getState()?l.elements.expanderContainer.setAttribute("data-wux-state","partiallyExpanded"):l.elements.expanderContainer.setAttribute("data-wux-state","expanded"):l.elements.expanderContainer.setAttribute("data-wux-state","noChildren")})))}}}))}},hasFlatTreeState:function(){return this._hasFlatTreeState},_applyDefaultColumnDef:function(e){const t=this.layout.getColumnModel();t&&t.setDefaultColumnDef(this.defaultColumnDef)},_applyColumns:function(e){const t=this.layout;if(t){const e=t.getColumnModel();if(this.showContextualMenuColumnFlag&&e){let t=e.getColumnOrGroupInTree(this.columns,"ContextualMenuColumn");t?t.completed||re.call(this,t):(t=re.call(this,{}),this.columns.push(t))}t.columns!==this.columns?t.columns=this.columns:t._applyColumns(),this._updateAutoWidthStyle(),e&&e.hasColumnGroups()?this.getContent().setAttribute("has-column-groups",""):this.getContent().removeAttribute("has-column-groups")}},_updateAutoWidthStyle:function(){const e=this.layout;if(e){const t=e.getColumnModel();e.useLastColumnWidthAutoFlag||t&&t.hasAutoWidthColumn()?this.getContent().setAttribute("has-auto-width-column",""):this.getContent().removeAttribute("has-auto-width-column")}},_applyShowContextualMenuColumnFlag:function(e){const t=this.layout;if(!t)return;const i=t.getColumnModel();if(!i)return;const n=i.getColumnOrGroupInTree(this.columns,"ContextualMenuColumn");if(this.showContextualMenuColumnFlag&&!n&&this._applyColumns(this.columns),n){let e=this.showContextualMenuColumnFlag;if(e){const i=t.getCurrentViewChanges();i&&i.columnsVisibleFlag&&i.columnsVisibleFlag.hasOwnProperty("ContextualMenuColumn")&&(e=i.columnsVisibleFlag.ContextualMenuColumn)}t.setColumnVisibleFlag("ContextualMenuColumn",e)}},getColumnOrGroup:function(e,t){return this.layout.getColumnOrGroup(e,t)},_addColumnOrGroup:function(e,t,i){for(const n of t){let t=!1;if(n.dataIndex)for(const o of e)if(n.dataIndex===o.dataIndex){t=!0,n.children&&(o.children?this._addColumnOrGroup(o.children,n.children,i):o.children=n.children);break}if(!t){const t=void 0===i||i>e.length?e.length:i;e.splice(t,0,n)}}},addColumnOrGroup:function(e,t){let i=this.columns;i||(this.columns=[],i=this.columns),this._addColumnOrGroup(i,[e],t),this.layout.applyColumns(),this.requestDelayedModelData("OnAddColumn")},_removeColumnOrGroup:function(e,t){let i=0;for(let n=0;n<e.length;n++){const o=e[n];if(o){if(o.dataIndex===t){e.splice(n,1),o._parent=null,i=1;break}if(o.children&&(i=this._removeColumnOrGroup(o.children,t),i)){0===o.children.length&&delete o.children;break}}}return i},removeColumnOrGroup:function(e){const t=this.layout.getColumnIdentifiers(e).dataIndex;this._removeColumnOrGroup(this.columns,t)&&this.layout.applyColumns()},_preEditSortModel:function(e,t){const i=this.sortOptions?this.sortOptions.maxSortedColumnsCount:void 0;if(!(!t||"number"!=typeof i||t.length<=i)){const n=this.sortOptions.onOutOfBoundSortRequest;n&&C.isCurrentlyCalledFromUIInteraction()&&n({currentSortModel:e,rejectedSortModel:t});const o=[...t];return o.length=i,{validValue:o}}return!0},_applySortModel:function(e){this._rowModel&&(this._rowModel.sortModel=this.sortModel,this.fire("sortModelChange"))},_applySortOptions(e,t){if(t&&"number"==typeof t.maxSortedColumnsCount){const e=this.sortModel;!this.isDirty("sortModel")&&e&&e.length>t.maxSortedColumnsCount&&(e.length=t.maxSortedColumnsCount)}},_applyLayout:function(e){this._parent(e),e&&this._applyColumns()},_applyColumnSelection:function(){if(this.getContent().setAttribute("column-selection",this.columnSelection),"none"===this.columnSelection||this._columnsXSO)"none"===this.columnSelection&&this._columnsXSO&&this._columnsXSO.empty();else{const e=this;this._columnsXSO=new A({useUniqueID:!0,getElementID:this.getXSOColumnID}),this._columnsXSO.onPostAdd((function(t){if(t.forEach((function(t){const i=t;e.updateColumnView(i,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})})),e._updateColumnHeaderCells({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0}),e._modelMassUpdateDialog){const t=e._buildMassUpdateDialogAttributes();e._modelMassUpdateDialog.attributes=t,e._modelMassUpdateDialog.resetAttributesValues()}})),this._columnsXSO.onPostRemove((function(t){if(t.forEach((function(t){const i=t;e.updateColumnView(i,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})})),e._updateColumnHeaderCells({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0}),e._modelMassUpdateDialog){const t=e._buildMassUpdateDialogAttributes();e._modelMassUpdateDialog.attributes=t,e._modelMassUpdateDialog.resetAttributesValues()}}))}this._isReady&&this._renderViewport({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})},_applyColumnDragEnabledFlag:function(e){},_applyRowDragEnabledFlag:function(e){this._updateFromRowDragEnabledState(),this.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!1})},_applyCellDragEnabledFlag:function(e){},_applyCellActivationFeedback:function(e){this.cellActivationFeedback&&"none"!==this.cellActivationFeedback?this.getContent().setAttribute("cell-activation-feedback",this.cellActivationFeedback):this.getContent().removeAttribute("cell-activation-feedback")},_applyRowSelection:function(e){this._parent(e),this._applyCellPreselectionFeedback()},_applyCellSelection:function(e){this._parent(e),this._applyCellPreselectionFeedback()},_applyCellPreselectionFeedback:function(e){this._parent(e);const t=this.getUsedCellPreselectionFeedback();t&&"none"!==t?this.getContent().setAttribute("cell-preselection-feedback",t):this.getContent().removeAttribute("cell-preselection-feedback")},_applyShowEditableFeedbackFlag:function(e){this.invalidateLayout({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})},_applyShowRequiredFeedbackFlag:function(e){this.invalidateLayout({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})},_applyShowRowBorderFlag:function(e,t){this.showRowBorderFlag?this.getContent().setAttribute("show-row-border",""):this.getContent().removeAttribute("show-row-border"),this.layout&&this.layout.resetRowHeights()},_applyShowColumnBorderFlag:function(e,t){this.showColumnBorderFlag?this.getContent().setAttribute("show-column-border",""):this.getContent().removeAttribute("show-column-border")},_applyShowModelChangesFlag:function(e){this.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})},_applyShowAlternateBackgroundFlag:function(e){this.showAlternateBackgroundFlag?this.getContent().setAttribute("show-alternate-background",""):this.getContent().removeAttribute("show-alternate-background")},_applyShowRowIndexFlag:function(e){this.showRowIndexFlag?this.getContent().setAttribute("show-row-index",""):this.getContent().removeAttribute("show-row-index"),this.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})},_applyShowSelectionCheckBoxesFlag:function(e){const t=this._getCurrentTouchMode();!1!==this.showSelectionCheckBoxesFlag?this.getContent().setAttribute("show-selection-check-boxes",!!t||this.showSelectionCheckBoxesFlag):this.getContent().removeAttribute("show-selection-check-boxes"),this.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})},_applyShowOutlineFlag:function(e){this.showOutlineFlag?this.getContent().setAttribute("show-outline",""):this.getContent().removeAttribute("show-outline")},_applyShowRowHeaderBackgroundFlag:function(e){this.showRowHeaderBackgroundFlag?this.getContent().setAttribute("show-row-header-background",""):this.getContent().removeAttribute("show-row-header-background")},_preEditTreeNodeCellOptions:function(e,t){if(void 0===t)return{validValue:Object.assign({},z)};return{validValue:Object.assign({},z,e,t)}},_applyTreeNodeCellOptions:function(e){if(this._isReady){const e=this.layout.getColumnIndex("tree");e>=0&&this.updateColumnView(e,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}},_applyShowNodeKPIColorFlag:function(e){this.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})},_applyPlaceholder:function(e){this.model&&0===this.model.length&&(this._removeEmptyContentMessage(),this.placeholder&&""!==this.placeholder&&this._displayEmptyContentMessage())},_updateFromRowDragEnabledState:function(){this.rowDragEnabledFlag?this.getContent().setAttribute("row-drag-enabled",""):this.getContent().removeAttribute("row-drag-enabled")},reapplySortModel:function(){this._rowModel&&this._rowModel._applySortModel(this.sortModel)},initialize:function(){if(this._initialized)return;this._initialized=!0;this.getContent().setAttribute("layout-density",this.layout.layoutDensity),this._manageCellRequests(),this.treeDocument&&this._applyTreeDocument(),this.sortModel?this.reapplySortModel():this._rowModel&&this._rowModel._resetTreeDocument&&this._rowModel._resetTreeDocument(),!this.hasLeftContainer()&&this.layout.hasCellsInLeftContainer()&&this._createLeftFixedContainer(),!this.hasRightContainer()&&this.layout.hasCellsInRightContainer()&&this._createRightFixedContainer(),this._manageUserInteractions(),this._manageDragAndDrop(),this.paginationManager&&this.paginationManager.updatePagination(),void 0!==this.maxVisibleRowCount&&(this.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1}),this._updateDimensions())},getCustomViewsManager:function(){return this._customViewsManager||(this._customViewsManager=new f({collectionView:this})),this._customViewsManager},destroy:function(){this._unsubscribeToPreExpand(this.getTreeDocument()),this._modelMassUpdateDialog&&(this._modelMassUpdateDialog.destroy(),this._modelMassUpdateDialog=null),this._rowModel&&this._rowModel.destroy(),this._rowModel=null,this.layout.destroy(),this._toolbar=null,this._customViewsManager&&(this._customViewsManager.destroy(),this._customViewsManager=null),this._parent()},_registerPools:function(){this._parent(),this._registerPool("__row_header__",null,p),this._registerPool("__topleft_row_header__",this.elements.rowHeaderExtensionHeaderPoolContainer,p),this._registerPool("__top_item__",this.elements.headerPoolContainer,g);const e=this.treeNodeCellOptions&&this.treeNodeCellOptions.cellClass?this.treeNodeCellOptions.cellClass:m;this._registerPool("__tree_item__",this.elements.poolContainer,e),this._registerPool("__odd_row__",null,c),this._registerPool("__even_row__",null,c)},_createLeftFixedContainer:function(){this._parent(),this._registerPool("__topleft_item__",this.elements.leftHeaderPoolContainer,g);const e=this.treeNodeCellOptions&&this.treeNodeCellOptions.cellClass?this.treeNodeCellOptions.cellClass:m;this._registerPool("__left_tree_item__",this.elements.leftPoolContainer,e),this._registerPool("__left_odd_row__",null,c),this._registerPool("__left_even_row__",null,c)},_createRightFixedContainer:function(){this._parent(),this._registerPool("__topright_item__",this.elements.rightHeaderPoolContainer,g);const e=this.treeNodeCellOptions&&this.treeNodeCellOptions.cellClass?this.treeNodeCellOptions.cellClass:m;this._registerPool("__right_tree_item__",this.elements.rightPoolContainer,e),this._registerPool("__right_odd_row__",null,c),this._registerPool("__right_even_row__",null,c)},getTreeDocument:function(){return this._rowModel?this._rowModel._getTreeDocument():void 0},supportsKeyboardNavigation:function(){return!0},supportsSelection:function(){return!0},supportsLightRendering:function(){return!0},supportsCustomScrolling:function(){return!0},setToolbar:function(e){const t="object"==typeof e?e:JSON.parse(e),i=this.getTypeRepresentationFactory();if(t.enums)for(const e in t.enums)i.registerEnum(e,t.enums[e]);t.typeRepresentations&&i.registerTypeRepresentations(t.typeRepresentations);const n=v.prototype.createTreeDocument(t);return this._toolbar=new v({items:n,overflowManagement:"dropdown",direction:"horizontal",typeRepresentationFactory:i,executionContext:this}),this._toolbar},getToolbar:function(){return this._toolbar},getCellCssClassesAt:function(e){const t=this.layout;let i=this._parent(e);const n=t.getColumnGetCellClassName(e.columnID);if(n){const t=n.call(this,e);t&&""!==t&&(i+=" "+t)}return i},getCellAttributesAt:function(e){const t=this.layout,i=this._parent(e);if(e.rowID<=-1){if(this.columnDragEnabledFlag){i.draggable=!0;const n=this.columnSelection,o=t.getColumnOrGroupFromCoordinates(e);e.columnID>=0&&("single"===n&&e.rowID<-1||!t.getColumnOrGroupSelectableState(o))&&(i.unselectable=!0),this._draggedColumnOrGroup&&o&&o._isMoving&&(i["is-moving"]=!0)}if(-1===e.rowID){const n=t._getCellTypeRepresentation(e);n&&(i["type-representation"]=n)}}else{const n=this.getNodeModelAtRowID(e.rowID);if(n&&(n.getChangeStates()&WUXModelChangeStates.NodeToBeRemoved?i["to-be-removed"]=!0:n.getChangeStates()&WUXModelChangeStates.NodeAdded&&(i.added=!0),-1===e.columnID?this._rowModel&&!this._rowModel.shouldBeSelected(n)&&(i.unselectable=!0):e.columnID>=0&&this.cellDragEnabledFlag&&(this.isCellInEdition(e.cellID)||(i.draggable=!0)),!this._muteFind&&this._currentMatchingCellIDIndex>=0&&("row"===this.findNavigationMode?(this._currentMatchingRowIDIndex>=0&&this._matchingNodeModelsArray.length>this._currentMatchingRowIDIndex&&this._matchingNodeModelsArray[this._currentMatchingRowIDIndex]._getRowID()===e.rowID&&(i["current-matching-cell"]=""),this._matchingNodeModelsMap&&void 0!==this._matchingNodeModelsMap[e.rowID]&&(i["match-search"]="")):e.cellID===this._getMatchingCellID(this._currentMatchingCellIDIndex)&&(i["current-matching-cell"]=""),this._matchingCellIDsMap&&void 0!==this._matchingCellIDsMap[e.cellID]&&(i["match-search"]=""))),e.columnID>=0){const n=t.getColumnEditionPolicy(e.columnID);"EditionInPlace"!==n&&(i.lite=""),this.showRequiredFeedbackFlag&&this.getCellRequiredState(e.cellID)&&(i["is-required"]=""),this.showEditableFeedbackFlag&&"EditionInPlace"!==n&&this.getCellEditableState(e.cellID)&&(i["is-editable"]="")}if(this._draggedColumnOrGroup){const n=t.getLeafColumns()[e.columnID];n&&n._isMoving&&(i["is-moving"]=!0,n._isFirstColumnMoving&&(i["is-first-column-moving"]=!0))}const o=t.getColumnGetCellAttributes(e.columnID);if(o){const t=o.call(this,e),n=Object.keys(t);for(let e=0;e<n.length;e++)i[n[e]]=t[n[e]]}}return i},setPreselectedCell:function(e){if(this._getCurrentTouchMode()&&!1!==this._preventPreSelectionForTouchMode)return;const t=U?void 0:e,i=this.getPreselectedCellID();if(this._parent(t),i!==t){this._preselectedCellStableID=void 0!==t?this._getXSOElementFromCellID(t):void 0;const n=this._preselectedRowID;let o;if(void 0!==t){o=this.layout.getCellCoordinatesAt(t).rowID}n!==o&&(this._preselectedRowID=o,void 0!==n&&this._updateRenderedRowCellsAttributes(n),void 0!==this._preselectedRowID&&this._updateRenderedRowCellsAttributes(this._preselectedRowID));const l=this.getPreselectedCellID(),s=this.getUsedCellPreselectionFeedback();function r(e){const t=this.layout.getCellCoordinatesAt(e),i=this.layout.getCellIDFromCoordinates({rowID:-1,columnID:t.columnID}),n=this.layout.getCellIDFromCoordinates({rowID:t.rowID,columnID:-1});this._updateRenderedCellAttributes(i),this._updateRenderedCellAttributes(n)}i!==l&&"cell"===s&&(void 0!==n&&r.call(this,i),void 0!==l&&r.call(this,l))}},_updateRenderedRowCellsAttributes:function(e){const t=this.layout;let i=e<0;if(!i){const n=t.getMinMaxVisibleRowIDs();e>=n.minRowID&&e<=n.maxRowID&&(i=!0)}if(i){const i=t.getLeafColumns().length;for(let n=t._leftPinnedRowColumnID;n<i;n++)this._updateRenderedCellAttributes(t.getCellIDFromCoordinates({rowID:e,columnID:n}))}},_updateRenderedRowCheckboxState:function(e,t){if(this.layout.rowsHeader){const i=this._getViewAt(this.layout.getCellIDFromCoordinates({rowID:e,columnID:-1}));i&&i.updateSelectionCheckboxState(t)}},_updateRenderedActiveCell:function(e){if(this._updateRenderedCellAttributes(e),"row"===this.cellActivationFeedback){const t=this.layout,i=t.getCellCoordinatesAt(e);this._updateRenderedCellAttributes(t.getCellIDFromCoordinates({rowID:i.rowID,columnID:t._leftPinnedRowColumnID})),this._updateRenderedCellAttributes(t.getCellIDFromCoordinates({rowID:i.rowID,columnID:t._unpinnedRowColumnID})),this._updateRenderedCellAttributes(t.getCellIDFromCoordinates({rowID:i.rowID,columnID:t._rightPinnedRowColumnID}))}},pushUpdateView:function(e,t){if(this._updateCounter--,0===this._updateCounter){if((this._updateNeeded||t)&&this.updateView(e),this._updateRowNeeded)for(const e in this._renderRowOptions)this.updateRowView(parseInt(e),this._renderRowOptions[e]);this._modelEvents.publish({event:"LAST_PUSH_UPDATE_VIEW",context:this,data:{}})}},updateRenderedRow:function(e,t){return this.updateRowView(e,t)},_updateRenderRowOptions(e,t){this._renderRowOptions[e]?this._renderRowOptions[e]=this._updateRenderOptions(t,this._renderRowOptions[e]):this._renderRowOptions[e]=Object.assign({},t)},updateRowView:function(e,t){if(this._updateRenderRowOptions(e,t),this._updateCounter>0)return void(this._updateRowNeeded=!0);const i=this.layout;let n=e<0;if(!n){const t=i.getMinMaxVisibleRowIDs();e>=t.minRowID&&e<=t.maxRowID&&(n=!0)}if(n){this._isPrivateRendering(!0);const n=this.getActiveCellID(),o=i.getLeafColumns().length;for(let l=i._leftPinnedRowColumnID;l<o;l++){const o=i.getCellIDFromCoordinates({rowID:e,columnID:l});t&&t.ignoreActiveCell&&o===n||this.updateCellView(o,t)}this._isPrivateRendering(!1)}this._updateRowNeeded=!1,delete this._renderRowOptions[e]},updateRenderedColumn:function(e,t){return this.updateColumnView(e,t)},updateColumnView:function(e,t){this._isPrivateRendering(!0);const i=this.layout,n=i.getMinMaxVisibleRowIDs();for(let o=n.minRowID;o<=n.maxRowID;o++)this.updateCellView(i.getCellIDFromCoordinates({rowID:o,columnID:e}),t);this._isPrivateRendering(!1)},_updateColumnHeaderCells:function(e){const t=this.layout;let i=3+(t.rowsHeader?1:0);const n=t.getColumnModel();if(n){const t=n.getColumnItemsByDepth();for(let n=0;n<t.length;n++){const o=t[n];for(let t=0;t<o.length;t++)this.updateCellView(i,e),i++}}},_freeUpColumnCells:function(e,t){const i=this.layout,n=this.getModelLength();for(let o=i.columnsHeader?-1:0;o<n;o++)this._freeUpCell(i.getCellIDFromCoordinates({rowID:o,columnID:e}),t)},_endRendering:function(e){this._parent(e),0!==this._tweakerToGenerateCount||this._activeScroller?this._tweakerToGenerateCount&&ue.call(this,e)&&!this._delayedFitAllContent&&(this._delayedColumnWidthUpdate=!0):ue.call(this,e)?this.invalidateLayout({postUpdateCellWidth:!0}):this._onAllCellsRendered()},_onAllCellsRendered:function(){if(this._delayedColumnWidthUpdate)return this._delayedColumnWidthUpdate=!1,void this.invalidateLayout({postUpdateCellWidth:!0});!this._inOnAllCellsRendered&&this.isInitialized()&&(this._inOnAllCellsRendered=!0,this._resetRowHeightsOnAllCellsRenderedFlag&&(this._resetRowHeightsOnAllCellsRenderedFlag=!1,this.layout.resetRowHeights()),this._inOnAllCellsRendered=!1,this._parent())},_resetRowHeightsOnAllCellsRendered:function(){this._resetRowHeightsOnAllCellsRenderedFlag=!0},isCellHighlighted:function(e){return!!(e&&e.cellView&&e.cellView.isRow()&&e.nodeModel)&&e.nodeModel.isHighlighted()},isCellPreselected:function(e){let t=!1;if(this._getCurrentTouchMode()&&!1!==this._preventPreSelectionForTouchMode)return t;const i=this.layout,n=this.getUsedCellPreselectionFeedback(),o=i.getCellCoordinatesAt(e);if(o.rowID>-1)if("cell"===n)if(-1===o.columnID){const e=i.getCellCoordinatesAt(this.getPreselectedCellID());t=o.rowID===e.rowID}else t=this.getPreselectedCellID()===e;else if("row"===n){if(t=o.rowID===this._preselectedRowID,!t){const i=this.getNodeModelAt(e);if(i){const e=this.getNodesPXSO();e&&(t=e.isIn(i))}}}else t=o.rowID===this._preselectedRowID&&-1===o.columnID;else if(-1===o.rowID&&"cell"===n){const e=i.getCellCoordinatesAt(this.getPreselectedCellID());e.rowID>=-1&&(t=o.columnID===e.columnID)}else t=this.getPreselectedCellID()===e;return t},isCellActive:function(e){let t=!1;const i=this.getActiveCellID();if(i>=0)if("row"===this.cellActivationFeedback){const n=this.layout,o=n.getCellCoordinatesAt(e);if(o.columnID===n._leftPinnedRowColumnID||o.columnID===n._unpinnedRowColumnID||o.columnID===n._rightPinnedRowColumnID){const e=n.getCellCoordinatesAt(i);t=o.rowID===e.rowID}else t=e===i}else t=e===i;return t},_computeColumnWidth:function(e,t){this._isPrivateRendering(!0);const i=this._getMaxContentSizeInfo([e],t),n=i[Object.keys(i)[0]];if(this._isPrivateRendering(!1),void 0!==n.maxContentSize&&n.isWidthComputed)return n.maxContentSize},sizeColumnToFit:function(e,t){const i=this.layout,n=this._computeColumnWidth(e,t);return"number"==typeof n&&i.setColumnWidth(e,n,{isUserInteraction:Boolean(t&&t.isUserInteraction)}),n},sizeColumnOrGroupToFit:function(e,t,i){const n=this.layout;this.prepareUpdateView(),i||(i={}),i.minMax=n.getMinMaxVisibleRowIDs();const o=n.getColumnOrGroupFromCoordinates({rowID:t,columnID:e});if(o.children&&o.children.length)for(let e=0;e<o.children.length;e++){const l=n.getColumnOrGroupCellCoordinates(o.children[e]).columnID;this.sizeColumnOrGroupToFit(l,t+1,i)}else this.sizeColumnToFit(e,i);this.pushUpdateView({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1},!0)},sizeColumnsToFit:function(e,t){const i=this.layout;this._isPrivateRendering(!0);const n={},o=this._getMaxContentSizeInfo(e,t),l=Object.keys(o);for(let e=0;e<l.length;e++){const t=l[e];void 0!==o[t].maxContentSize&&o[t].isWidthComputed&&(n[t]=o[t].maxContentSize)}return this._isPrivateRendering(!1),i.setColumnsWidth(n,{isUserInteraction:Boolean(t&&t.isUserInteraction)}),n},_getMaxContentSizeInfo:function(t,i){const n=this.layout,o=this;let l;i=e.extend({isUserInteraction:!1,computeAllRows:!1,computeColumnHeader:!1},i),l=i.computeAllRows?{minRowID:0,maxRowID:this.getModelLength()-1}:i.minMax?i.minMax:n.getMinMaxVisibleRowIDs();const s={};for(let d=0;d<t.length;d++){const c=n.getColumnIdentifiers(t[d]),h=parseInt(n.getColumnMinWidth(c.columnIndex)),g=n.getColumnAutoSizePadding(c.columnIndex);s[c.dataIndex]={maxContentSize:h,autoSizePadding:g,isWidthComputed:!1}}let r=[],a=[];function u(e,t){const i=o.layout.getCellIDFromCoordinates({rowID:t,columnID:e});let n=o._getRenderedCellAt(i);n||(n=o._renderCell(i,{updateCellContent:!1,updateCellLayout:"ignore",updateCellAttributes:!1}),a.push(i)),r.push({cell:n,columnID:e})}if(l.minRowID>=0&&l.maxRowID>=0||i.computeColumnHeader){const p=500,m=(l.maxRowID+1-l.minRowID)*t.length,f=Math.ceil(m/p),C={columnIndex:0,rowID:l.minRowID};function w(){for(let e=0;e<p;e++){if(u(n.getColumnIdentifiers(t[C.columnIndex]).dataIndex,C.rowID),-1===C.rowID){if(C.columnIndex===t.length-1)break;C.columnIndex+=1,C.rowID=l.minRowID}else if(C.rowID===l.maxRowID)if(i.computeColumnHeader)C.rowID=-1;else{if(C.columnIndex===t.length-1)break;C.columnIndex+=1,C.rowID=l.minRowID}else C.rowID+=1}for(let e=0;e<r.length;e++){const t=r[e].columnID,i=r[e].cell;if(t&&i&&i.component){s[t].isWidthComputed=!0;const e=i.component.computeContentSize()+2+s[t].autoSizePadding;e>s[t].maxContentSize&&(s[t].maxContentSize=e)}}r=[];for(let e=0;e<a.length;e++)o._freeUpCell(a[e],1);a=[]}for(let _=0;_<f;_++)w()}return s},sizeAllColumnsToFit:function(e){const t=this.layout;t.isValid()||t.prepareLayout();const i=this.layout.getLeafColumns();this.prepareUpdateView(),e||(e={}),e.minMax=t.getMinMaxVisibleRowIDs(),this.sizeColumnsToFit(i,e),this.pushUpdateView({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1},!0)},_applyRowGroupingOptions:function(t){this._properties.rowGroupingOptions.value=e.extend({depth:0,maxDepth:void 0,hideGroupedColumns:!0,canNodeBeGrouped:null,getNodeGroupingKey:null,getGroupingNodeOptions:null,getGroupingNodeLabel:null,getGroupingNodeIcons:null,mapGroupingKeys:null},this.rowGroupingOptions)},getFindableAttributes:function(){return this.layout.getVisibleOrderedLeafColumns().map((e=>e.text?e.text:""))},_getCellValueAsStringForFind:function(e,t){if(t)return t.call(this,e);const i=this.layout.getColumnShouldCellAllowUnsafeHTMLContentAt(e.columnID).call(this,e),n=this.layout._getCellTypeRepresentation(e),o=this.getTypeRepresentationFactory(),l={touchMode:this._getCurrentTouchMode(),readOnly:!this.isCellInEdition(e.cellID),semantics:{showReferenceValueFlag:this.showModelChangesFlag,allowUnsafeHTMLContent:i}};let s=o.getRegisteredTypeRepresentation(n);s||(s={semantics:{possibleValues:o.getRegisteredEnum(n)}}),s.semantics&&(s.semantics.possibleValues&&(l.semantics.possibleValues=s.semantics.possibleValues),s.semantics.valueType&&(l.semantics.valueType=s.semantics.valueType)),l.typePath=n,l.context="inlinedTemplate",l.semantics.executionContext||(l.semantics.executionContext=e);const r=o._getTypeData(l.typePath,l.semantics,e.cellModel),a=d.getTemplateIdentifierFromTypeRep(r.typeRep,l.context),u=o.options.directory.getRegisteredTemplate(a);if(u&&u.src){const t=u.src.prototype;if(t._properties={},t.elements={},t.possibleValues=l.semantics.possibleValues,t.valueType=l.semantics.valueType,t.isValueDisplayedAsString(u.options.displayStyle)){t._properties={},t.elements={},t.possibleValues=l.semantics.possibleValues,t.valueType=l.semantics.valueType;const i=this.layout.getDataIndexFromColumnIndex(e.columnID),n=this.layout.getColumnTypeRepresentation(i),o="progress"===n?"%":"percentage"===n?" %":"",s=t.getStringFromValue(e.cellModel)+o;return t.possibleValues=void 0,t.valueType=void 0,t._properties=void 0,t.elements=void 0,s}}},groupRows:function(e){this._rowModel&&this._rowModel.groupRows(e)},reapplyRowGrouping:function(){this._rowModel&&this._rowModel._reapplyRowGrouping()},createGroupingUI:function(){const e=this;let t;const i=function(t,i){-1===e._draggedRowID&&e.rowGroupingEnabledFlag&&t.preventDefault()},n=function(i,n){const o=e.getDraggedColumnData(i);if(o&&-1===o.rowID&&e.layout.getColumnOptionValue(o.columnID,"groupableFlag")){const i={label:o.label,value:e.layout.getColumnOptionValue(o.columnID,"dataIndex"),index:void 0},l=n.chipCellView?n.chipCellView.associatedModelItem:void 0;if(l){const e=n.dropPosition;"left"===e?i.index=t.getChipPosition(l.chipOptions.label):"right"===e&&(i.index=t.getChipPosition(l.chipOptions.label)+1)}t.addChip(i)}return i.preventDefault(),!0};t=new y({placeholder:S.get("GroupingUIPlaceholder"),onDragOverCell:function(e,t){return i(e)},onDragOverBlank:function(e,t){return i(e)},onDropCell:function(e,t){return n(e,t)},onDropBlank:function(e,t){return n(e,t)}});let o=!0,l=!0;t.getContent().addEventListener("change",(function(t){if(t&&t.dsModel&&o){const i=[];t.dsModel.getAllChipsOptions().forEach((function(e){i.push(e.value)})),l=!1,e.groupRows({dataIndexesToGroup:i}),e.layout._saveGroupingOptionsInPreferences(),l=!0}})),t.getContent().addEventListener("onPostRemove",(function(t){C.isCurrentlyCalledFromUIInteraction()&&ce.call(e)}));const s=this.getTreeDocument();if(s){const e=()=>{if(l&&this.getGroupingOptions()&&this.getGroupingOptions().dataIndexesToGroup){o=!1,t.removeAllChips();for(let e=0;e<this.getGroupingOptions().dataIndexesToGroup.length;e++){const i=this.getGroupingOptions().dataIndexesToGroup[e];t.addChip({label:this.layout.getColumnOptionValue(i,"text"),value:i})}o=!0}};s.addEventListener("groupNodes",e),e()}return t},setCellInEdition:function(e){if(!this.getCellEditableState(e))return!1;const t=this.setActiveCell(e,!0);if(this._getViewAt(e)){const t=this._setEditionMode(e,!0);return this.setFocusOnCellContentFlag(!0),t}if(t){const t=this;return new Promise((function(i,n){t.subscribeOnceToAllCellsRendered((function(){const n=t._setEditionMode(e,!0);t.setFocusOnCellContentFlag(!0),i(n)}))}))}},getCellEditableState:function(e){const t=this.layout,i=t.getCellCoordinatesAt(e);if(-1===i.columnID||i.rowID<=-1)return!1;const n=t.getColumnGetCellEditableState(i.columnID),o=this.getNodeModelAtRowID(i.rowID);if(o){if(n){const t=this.getLightCellInfosAt(e);return t.nodeModel=o,n.call(this,t)}const t=o.getTreeDocument();if(t&&t.options&&t.options.shouldBeEditable&&!t.options.shouldBeEditable(o))return!1}return t.getColumnEditableFlag(i.columnID)},getCellActivableState:function(e){const t=this.layout,i=t.getCellCoordinatesAt(e);if(-1===i.columnID||i.rowID<=-1)return!0;const n=t.getColumnGetCellActivableState(i.columnID);if(n){const t=this.getLightCellInfosAt(e);return t.nodeModel=this.getNodeModelAtRowID(i.rowID),n.call(this,t)}return!0},_resetFocus:function(e){if(this._parent(e),!e||!C.isASystemEvent(e))return;const t=e.relatedTarget?e.relatedTarget:document.activeElement;if(!t||!C.isElementInside(t,this.getContent(),{lookInPopup:!0})){const e=this.getActiveCellID();e>=0&&this._setEditionMode(e,!1)}},getCellRequiredState:function(e){return!1},_getCellSemantics:function(e){const t=this.layout;if(e.columnID>-1&&e.rowID>-1){const i=t.getColumnGetCellSemantics(e.columnID);if(i)return i.call(this,e);return t.getColumnSemantics(e.columnID)}return null},_getCellKPIColor:function(e){const t=this.layout;if(e.columnID>-1&&e.rowID>-1){const i=t.getColumnGetCellKPIColor(e.columnID);if(i)return i.call(this,e)}return null},computeCellIDFromActiveCell:function(e,t,i){let n=this.getActiveCellID();return i&&this._getLastRangeCellID()>=0&&("up"===e||"right"===e||"down"===e||"left"===e||"pageup"===e||"pagedown"===e)&&(n=this._getLastRangeCellID()),this.layout._computeCellIDFromCell(n,e,t,i)},onDragStartCellDefault:function(e,t){this.getRowReorderEnabledState()&&(ce.call(this),this._serializeDragAndDropEvent(e,t))},onDragEndCellDefault:function(e,t){},onDragEnterCellDefault:function(e,t){if(t.nodeModel&&this.getRowReorderEnabledState()&&t.draggedNodes){const i=ee.call(this,e,t);(i||null===i)&&e.preventDefault()}},onDragLeaveCellDefault:function(e,t){$.call(this)},onDragCellDefault:function(e,t){},onDragOverCellDefault:function(e,t){if(t.nodeModel&&this.getRowReorderEnabledState()){const i=ee.call(this,e,t);(i||null===i)&&e.preventDefault()}else e.defaultPrevented&&(this._draggedColumnOrGroup?e.dataTransfer.dropEffect="none":(t.dropPosition="middle",Q.call(this,t,!0)))},onDragOverBlankDefault:function(e,t){this._draggedColumnOrGroup||(this.elements.scroller.elements.container.setAttribute("highlightTopBottom",""),this.hasLeftContainer()&&(""===this.elements.leftScrollContainer.getAttribute("empty")&&this.elements.scroller.elements.container.setAttribute("highlightLeft",""),this.elements.leftScrollContainer.setAttribute("highlight",""),this.elements.leftSpacerContainer.setAttribute("highlight","")),this.hasRightContainer()&&(""===this.elements.rightScrollContainer.getAttribute("empty")&&this.elements.scroller.elements.container.setAttribute("highlightRight",""),this.elements.rightScrollContainer.setAttribute("highlight",""),this.elements.rightSpacerContainer.setAttribute("highlight","")))},onDragLeaveBlankDefault:function(e,t){this.elements.scroller.elements.container.removeAttribute("highlightTopBottom"),this.elements.scroller.elements.container.removeAttribute("highlightLeft"),this.elements.scroller.elements.container.removeAttribute("highlightRight"),this.hasLeftContainer()&&(this.elements.leftScrollContainer.removeAttribute("highlight"),this.elements.leftSpacerContainer.removeAttribute("highlight")),this.hasRightContainer()&&(this.elements.rightScrollContainer.removeAttribute("highlight"),this.elements.rightSpacerContainer.removeAttribute("highlight"))},onDropBlankDefault:function(e,t){this.elements.scroller.elements.container.removeAttribute("highlightTopBottom"),this.elements.scroller.elements.container.removeAttribute("highlightLeft"),this.elements.scroller.elements.container.removeAttribute("highlightRight"),this.hasLeftContainer()&&(this.elements.leftScrollContainer.removeAttribute("highlight"),this.elements.leftSpacerContainer.removeAttribute("highlight")),this.hasRightContainer()&&(this.elements.rightScrollContainer.removeAttribute("highlight"),this.elements.rightSpacerContainer.removeAttribute("highlight"))},onDropCellDefault:function(e,t){if(t.nodeModel&&this.getRowReorderEnabledState()){if(te.call(this,e,t))return void e.preventDefault()}},getRowReorderEnabledState:function(){return this.rowDragEnabledFlag&&this.rowReorderEnabledFlag&&0===this._disableRowReorderCpt},enableRowReordering:function(){this._disableRowReorderCpt--},disableRowReordering:function(){this._disableRowReorderCpt++},_serializeDragAndDropEvent:function(t,i){if(i&&i.draggedNodes){let n;if(t.dataTransfer&&"string"==typeof t.dataTransfer.getData("text")&&t.dataTransfer.getData("text").length>0)try{n=JSON.parse(t.dataTransfer.getData("text"))}catch(t){return}const o=[];i.draggedNodes.forEach((function(e){o.push(e._getID())}));let l={source:{uuid:this._uuid,amd:"DS/DataGridView/DataGridView"},data:{DataGridView_Row_Options:{"dswebux/x-datagridview.rows+json":o,"dswebux/x-datagridview.row+number":i.nodeModel._getID(),"dswebux/x-datagridview.row.options.label+json":i.nodeModel.options.label,"dswebux/x-datagridview.row.options.icons+json":i.nodeModel.options.icons,"dswebux/x-datagridview.row.options.grid+json":i.nodeModel.options.grid,"dswebux/x-datagridview.row.id+json":i.rowID}}};n&&(l=e.extend(l,n,!0)),t.dataTransfer.setData("text",JSON.stringify(l))}},onDragStartRowHeaderDefault:function(e,t){if(this.rowDragEnabledFlag&&(ce.call(this),this._serializeDragAndDropEvent(e,t),e.dataTransfer.setDragImage)){const i=this.layout.getColumnIndex("tree");if(void 0!==i){const n=this.layout.getCellIDFromCoordinates({rowID:t.rowID,columnID:i});let o=!1,l=this._getRenderedCellAt(n);if(l||(l=this._renderCell(n,{updateCellContent:!1,updateCellLayout:"ignore",updateCellAttributes:!1}),o=!0),l&&l.component&&e.dataTransfer.setDragImage(l.component.getContent(),10,10),o){const e=this;setTimeout((function(){e._freeUpCell(n,1)}),0)}}}},onDragEndRowHeaderDefault:function(e,t){},onDragEnterRowHeaderDefault:function(e,t){},onDragLeaveRowHeaderDefault:function(e,t){$.call(this)},onDragRowHeaderDefault:function(e,t){},onDragOverRowHeaderDefault:function(e,t){if(t.nodeModel&&this.getRowReorderEnabledState()&&t.draggedNodes){ee.call(this,e,t)&&e.preventDefault()}},onDropRowHeaderDefault:function(e,t){if(t.nodeModel&&this.getRowReorderEnabledState()){if(te.call(this,e,t))return void e.preventDefault()}},onDragStartColumnHeaderDefault:function(e,t){if(this.columnDragEnabledFlag){const e=this.layout;this._draggedColumnOrGroup=e.getColumnOrGroupFromCoordinates({rowID:t.rowID,columnID:t.columnID});const i=e.getColumnModel();if(this._draggedColumnOrGroupPreviousPositionData=i?i.getColumnOrGroupPositionData(this._draggedColumnOrGroup):{numberOfDataIndexOccurences:0,indexInParent:0,columnGroupDataIndexes:[],childrenCountInParent:0},this._draggedRowID=t.rowID,this._draggedColumnOrGroup){this._draggedColumnOrGroup._isMoving=!0,_.processTreeChildren(this._draggedColumnOrGroup.children,(function(e){e._isMoving=!0})),this._updateColumnHeaderCells({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0});const t=_.getLeafItems(this._draggedColumnOrGroup);for(let i=0;i<t.length;i++){const n=t[i];0===i&&(n._isFirstColumnMoving=!0);const o=e.getColumnIndex(n.dataIndex);this.updateColumnView(o,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})}}}const i={source:{uuid:this._uuid,amd:"DS/DataGridView/DataGridView"},data:{DataGridView_Column_Options:{"dswebux/x-datagridview.column.label+json":t.cellModel,"dswebux/x-datagridview.row.id+json":t.rowID,"dswebux/x-datagridview.column.id+json":t.columnID}}};e.dataTransfer.setData("text",JSON.stringify(i))},onDragEndColumnHeaderDefault:function(e,t){if(this._draggedColumnOrGroup){const e=this.layout,t=e.getColumnModel();se.call(this,!1);const i=this._draggedColumnOrGroup;this._draggedColumnOrGroup=null;const n=t?t.getColumnTreeItemCount():0;t&&t._mergeBalancedColumnTree();const o=this._draggedColumnOrGroupPreviousPositionData,l=t?t.getColumnOrGroupPositionData(i):{numberOfDataIndexOccurences:0,indexInParent:0,columnGroupDataIndexes:[],childrenCountInParent:0};e._updateColumnGroupExpandedStateInPreferences(o,l),e._saveParentColumnGroupsExpandedStateInPreferences(i);let s=!1;(t?t.getColumnTreeItemCount():0)!==n&&(s=!0),this.invalidateLayout({updateCellContent:s,updateCellLayout:!0,updateCellAttributes:!0})}},onDragEnterColumnHeaderDefault:function(e,t){this._draggedColumnOrGroup&&(e.preventDefault(),e.dataTransfer.dropEffect="move"),$.call(this)},onDragLeaveColumnHeaderDefault:function(e,t){},onDragColumnHeaderDefault:function(e,t){ce.call(this)},onDragOverColumnHeaderDefault:function(e,t){if(this.columnDragEnabledFlag&&this._draggedColumnOrGroup&&(e.dataTransfer.dropEffect="move",e.preventDefault(),this._draggedColumnOrGroup)){const i=this.layout,n=i.getColumnModel();let o,l=!1;const s=i.getColumnOrGroupFromCoordinates({rowID:t.rowID,columnID:t.columnID}),r=function(e,t){const i=(t||e.target||e.srcElement).getBoundingClientRect();return{offsetX:e.clientX?e.clientX-i.left:0,offsetY:e.clientY?e.clientY-i.top:0}}(e).offsetX;let a;if(-1===t.rowID)o=t.columnID,a=r;else{let e=0;const t=_.getLeafItems(s);for(let n=0;n<t.length;n++){const l=t[n],s=i.getColumnIndex(l.dataIndex),u=i.getColumnComputedWidth(s);if(r<=e+u){o=s,a=r-e;break}e+=u}}if(void 0!==o){const t=i.getColumnOrGroupPinned(this._draggedColumnOrGroup),s=i.getColumnPinned(o),r=i.getColumnOrGroupComputedWidth(this._draggedColumnOrGroup),u=i.getColumnComputedWidth(o),d=n?n.getFirstLeafColumnIndex(this._draggedColumnOrGroup,!0):-1,c=i.getOrderedColumnsReverseIndexes(),h=c[d],g=c[o],p=a>u/2?"after":"before";(h<g&&a>u/2&&a>u-r||h>g&&a<u/2&&a<r||t!==s)&&(l=!0);const m=!!n&&n.columnMoveIsPossible(this._draggedColumnOrGroup,o,p);if(l&&m){if(t!==s){const e=_.computeFirstBranchDepth(this._draggedColumnOrGroup),t=i.getLeafColumns()[d];if(i.setColumnOrGroupPinned(this._draggedColumnOrGroup,s,{isUserInteraction:!0,mergeGroups:!1,groupToIgnore:this._draggedColumnOrGroup}),t){let i=t;for(let t=0;t<e-1&&i;t++)i=i._parent;i&&(this._draggedColumnOrGroup=i)}}i.moveColumnOrGroup(this._draggedColumnOrGroup,o,{insertBeforeOrAfter:p,isUserInteraction:!0,groupToIgnore:this._draggedColumnOrGroup})}if(!m){let t=!0;const n=i.getLeafColumns()[o],l=_.getLeafItems(this._draggedColumnOrGroup);for(let e=0;e<l.length;e++){if(l[e]===n){t=!1;break}}t&&(e.dataTransfer.dropEffect="none")}}}},onDropColumnHeaderDefault:function(e,t){e.preventDefault(),this._draggedColumnOrGroup&&this.onDragEndColumnHeaderDefault(e,t)},onDragEnterBlankDefault:function(e,t){$.call(this)},_processDragAndDropCallbacks:function(e,t){const i=t||{};if("dragstart"===e.type){if(j=!0,t){const i=this.getEditionManager(t.cellID);i&&i.onCellDragStart(t.cellID);const n=this.getTreeDocument();if(t.nodeModel&&n&&!n.options.shouldAcceptDrag(t.nodeModel))return void e.preventDefault()}if(e.dataTransfer){const i=e.target.getBoundingClientRect(),n=e.clientX-i.left,o=e.clientY-i.top;if("function"==typeof e.dataTransfer.setDragImage){let i=e.target;t.cellView&&(i=t.cellView.getContent()),e.dataTransfer.setDragImage(i,n,o)}}if(t&&t.rowID>=0){t.nodeModel&&!t.nodeModel.isSelected()&&this.selectNodeModel(t.nodeModel);let e=[];const n=this.getNodesXSO();n&&(e=n.get().concat(),u.sortNodesByRowID(e)),e&&0!==e.length||(e=[t.nodeModel]),i.draggedNodes=e,Object.getPrototypeOf(this).__rowReorderDnDInfos={source:this._uuid,nodes:e}}}else if("dragover"===e.type||"drag"===e.type||"dragenter"===e.type||"dragleave"===e.type){if(j=!0,"dragover"===e.type||"dragleave"===e.type||"dragenter"===e.type){if(le.call(this,e,t))return}const n=Object.getPrototypeOf(this).__rowReorderDnDInfos;n&&n.nodes&&(i.draggedNodes=n.nodes),i.dropPosition=Z.call(this,e,i)}else if("drop"===e.type){j=!1;const t=Object.getPrototypeOf(this).__rowReorderDnDInfos;t&&t.source===this._uuid&&(i.droppedNodes=t.nodes),i.dropPosition=Z.call(this,e,i),oe.call(this),$.call(this)}else if("dragend"===e.type){j=!1;const n=Object.getPrototypeOf(this).__rowReorderDnDInfos;n&&n.nodes&&(i.draggedNodes=n.nodes),this._rowReorderDnDInfos.dropAccepted||te.call(this,e,t),Object.getPrototypeOf(this).__rowReorderDnDInfos=null,oe.call(this),$.call(this)}const n={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"}[e.type],o=this;function l(t,n){let l=!0;const s=o[t+n],r=o[t+n+"Default"];s&&(l=s.call(o,e,i)),r&&l&&r.call(o,e,i)}t&&void 0!==t.columnID&&void 0!==t.rowID?-1===t.columnID?l(n,"RowHeader"):t.rowID<=-1?l(n,"ColumnHeader"):l(n,"Cell"):l(n,"Blank")},_manageExternalDnd:function(e){w.isMouseOverElement(this,{x:e.clientX,y:e.clientY})||(oe.call(this),$.call(this),this.onDragLeaveBlankDefault(e))},_manageDragAndDrop:function(){C.addEventOnElement(this,this,"dragstart",this._processDragAndDropCallbacks.bind(this)),C.addEventOnElement(this,this,"drop",this._processDragAndDropCallbacks.bind(this)),C.addEventOnElement(this,this,"dragover",this._processDragAndDropCallbacks.bind(this)),C.addEventOnElement(this,this,"drag",this._processDragAndDropCallbacks.bind(this)),C.addEventOnElement(this,this,"dragend",this._processDragAndDropCallbacks.bind(this)),C.addEventOnElement(this,this,"dragleave",this._processDragAndDropCallbacks.bind(this)),C.addEventOnElement(this,this,"dragenter",this._processDragAndDropCallbacks.bind(this));const e=C.getDocumentOwner.call(this);C.addEventOnElement(this,e.body,"dragleave",this._manageExternalDnd.bind(this))},getDraggedRowData:function(e){const t=e.dataTransfer.getData("text");try{if(void 0!==t&&""!==t){const e=JSON.parse(t);if(e&&e.data&&void 0!==e.data.DataGridView_Row_Options)return{uuid:e.source.uuid,listOfDumpedNodes:e.data.DataGridView_Row_Options["dswebux/x-datagridview.rows+json"],nodeModel:e.data.DataGridView_Row_Options["dswebux/x-datagridview.row+number"],label:e.data.DataGridView_Row_Options["dswebux/x-datagridview.row.options.label+json"],icons:e.data.DataGridView_Row_Options["dswebux/x-datagridview.row.options.icons+json"],grid:e.data.DataGridView_Row_Options["dswebux/x-datagridview.row.options.grid+json"],rowID:e.data.DataGridView_Row_Options["dswebux/x-datagridview.row.id+json"]}}}catch(e){console.warn('the element being in dataTransfer type "DataGridView_Row_Options" is not parsable usable JSON.parse')}},getDraggedColumnData:function(e){const t=e.dataTransfer.getData("text");try{if(void 0!==t&&""!==t){const e=JSON.parse(t);if(e&&void 0!==e.data.DataGridView_Column_Options)return{uuid:e.source.uuid,label:e.data.DataGridView_Column_Options["dswebux/x-datagridview.column.label+json"],rowID:e.data.DataGridView_Column_Options["dswebux/x-datagridview.row.id+json"],columnID:e.data.DataGridView_Column_Options["dswebux/x-datagridview.column.id+json"]}}}catch(e){console.warn('the element being in dataTransfer type "DataGridView_Column_Label" is not parsable usable JSON.parse')}},_getSelectionCheckBox:function(e){const t=this.layout.getCellIDFromCoordinates(e),i=this._getViewAt(t);if(i&&"function"==typeof i.getSelectionCheckBox){const e=i.getContent().querySelector(".wux-datagridview-selection-checkbox");if(e)return e.dsModel}},_getRowSelectionCheckBox:function(e){return this._getSelectionCheckBox({rowID:e,columnID:-1})},_getColumnSelectionCheckBox:function(e){return this._getSelectionCheckBox({rowID:-1,columnID:e})},_updateSelectAllCheckBox:function(){if(this.layout.columnsHeader){const e=this.getTreeDocument();if(e){const t={disabled:0===e.getRoots().length},i=e.getXSO();if(i){const e=i.isEmpty();t.checkFlag=!e;const n=this.isEveryVisibleNodeSelected();t.mixedState=!e&&!n}this._updateRenderedRowCheckboxState(-1,t)}}},_getCellTooltip:function(e){if(this.getCellTooltip)return this.getCellTooltip(e);const t=this.layout.getColumnGetCellTooltip(e.columnID);return t?t(e):this.getCellDefaultTooltip(e)},getCellDefaultTooltip:function(e,t){const i=this,n=t;return{getAllInformationCB:function(){const t=i.layout;let o,l=!0===n&&n,s="";if(e.rowID<0&&e.columnID<0&&!l)l=!0,s=e.cellModel?e.cellModel.toString():void 0;else if(e.rowID<0&&!l){const i=t.getColumnOrGroupFromCoordinates(e);i&&(i.description?(l=!0,s=i.description):(l=!t.getColumnShowTextFlag(e.columnID)&&t.getColumnIcon(e.columnID),l&&(s=i.text)))}if(!l&&!e.cellModel)return{model:{shortHelp:""},updateModel:!1};if(!l){const t=e.cellView.getReusableContent();if(t&&t.computeContentSize){let i,n;if(t.computeContentDimensions){const e=t.computeContentDimensions();i=e.width,n=e.height}else i=t.computeContentSize(),n=void 0;const o=t.getTweakerPadding();o>2&&(i=i-o+2);const s=e.cellView._getContentContainer();(s&&s.offsetWidth<i||void 0!==n&&s.offsetHeight<n)&&(l=!0)}}if(l){if(""===s){const t=e.cellView.getReusableContent();if(t){t.value instanceof Function||(s=t.getStringFromValue(t.value))}}const n=t.getColumnShouldCellAllowUnsafeHTMLContentAt(e.columnID);o=!1,n&&(o=w.getUnsafeHTMLContentValueToApply(n.call(i,e)))}return void 0!==o?{model:{shortHelp:s,allowUnsafeHTMLShortHelp:o,allowUnsafeHTMLLongHelp:o,allowUnsafeHTMLTitle:o},updateModel:!1}:{model:{shortHelp:s},updateModel:!1}}}},defaultOnCellRequest:function(e){const t=this.layout,i=t.getLeafColumns()[e.columnID];let n=!1;if(e.rowID>=0&&e.columnID>=0){const o=this.getNodeModelAtRowID(e.rowID);if("tree"===i.dataIndex){const t=e.cellView;t.setProperties(this.treeNodeCellOptions),t.flatTreeFlag=this.hasFlatTreeState(),ae.call(this,e,o),this._setTweakerForCell(e),n=!0}else{if(t._getCellTypeRepresentation(e))this._setTweakerForCell(e),n=!0;else{let i=e.cellModel;"number"==typeof i&&(i=String(i)),e.cellView.setReusableContent(null),w.getUnsafeHTMLContentValueToApply(t.getColumnShouldCellAllowUnsafeHTMLContentAt(e.columnID).call(this,e))?e.cellView.getContent().setHTML(i):e.cellView.getContent().textContent=i}}e.cellView.tooltipInfos=this._getCellTooltip(e)}else if(-1===e.columnID&&t.rowsHeader){if("none"!==this.rowSelection&&"function"==typeof e.cellView.buildSelectionCheckBox&&e.cellView.buildSelectionCheckBox(),this.rowDragEnabledFlag&&"function"==typeof e.cellView.buildDragGrip&&e.cellView.buildDragGrip(),e.cellView){const t=this.getNodesXSO();if(t)if(e.rowID>=0){const i=e.nodeModel&&t.isIn(e.nodeModel),n=this.selectionBehavior.showMixedStateOnParents&&e.nodeModel&&e.nodeModel._nbSelectedDescendants>0,o=i||Boolean(n),l=!i&&n;e.cellView.updateSelectionCheckboxState({checkFlag:o,mixedState:l})}else this._updateSelectAllCheckBox()}e.cellView.tooltipInfos=this._getCellTooltip(e),e.cellView.rowIndex=e.cellModel,e.cellView.showKPIColorFlag=this.showNodeKPIColorFlag,e.cellView.KPIColor=e.nodeModel?e.nodeModel.options.color:void 0}else e.rowID<=-1&&e.columnID>=0?n=this.defaultOnColumnHeaderRequest(e):e.cellView.setReusableContent(null);e.columnID>=0&&(n?e.cellView.getContent().removeAttribute("no-tweaker"):e.cellView.getContent().setAttribute("no-tweaker",""))},defaultOnColumnHeaderRequest:function(e){const t=this.layout,i=t.getLeafColumns()[e.columnID];let n,o=!0;if(e.cellView&&(e.cellView.customHeader=-1===e.rowID?i.customHeader:void 0,e.cellView.columnHeadersLayout=this.columnHeadersLayout),-1===e.rowID&&i.customHeader&&i.customHeader.buildContent){this._registerColumnHeaderReusableCellContent(i);const t=X(i.dataIndex),n=this.reuseCellContent(t);if(e.cellView.setReusableContent(n),i.customHeader.updateContent){let e;this.treeDocument?this.treeDocument.getFilterManager()&&(e=this.treeDocument.getFilterManager().filterModel):this._rowModel&&this._rowModel.getFilterManager()&&(e=this._rowModel.getFilterManager().filterModel);const t={sortModel:this.sortModel,filterModel:e};i.customHeader.updateContent(n,t)}}else{if(-1===e.rowID){const i=t.getColumnComputedWidth(e.columnID);e.cellView.getContent().style.width=i.toString()+"px"}this._setTweakerForCell(e),o=!0}if(-1===e.rowID&&this._rowModel&&this._rowModel._filterViewManager&&i){const e="tree"===i.dataIndex?"label":i.dataIndex;n=this._rowModel._filterViewManager.getFilterPopups()[e]}e.cellView.filterView=n,"none"!==this.columnSelection&&"function"==typeof e.cellView.buildSelectionCheckBox&&e.cellView.buildSelectionCheckBox();const l=t.getColumnOrGroupFromCoordinates(e);if(e.cellView&&this._columnsXSO){const t=this.isColumnOrGroupSelected(l),i=!1!==t,n="mixedState"===t;e.cellView.updateSelectionCheckboxState({checkFlag:i,mixedState:n})}let s;if(-1===e.rowID&&this.sortModel)for(let i=0;i<this.sortModel.length;i++)if(this.sortModel[i].dataIndex===t.getDataIndexFromColumnIndex(e.columnID)){s={sortDirection:this.sortModel[i].sort,sortOrder:1===this.sortModel.length?void 0:i,typeRepresentation:t.getColumnTypeRepresentation(e.columnID)};break}return e.cellView.sortModel=s,l&&"function"==typeof e.cellView.buildColumnGroupExpander&&e.cellView.buildColumnGroupExpander(this,l),e.cellView.tooltipInfos=this._getCellTooltip(e),o},_registerColumnHeaderReusableCellContent:function(e){const t=e.dataIndex,i=X(t),n=this;this.isReusableCellContentRegistered(i)||this.registerReusableCellContent({id:i,buildContent:function(){const i=n.layout.getCellIDFromCoordinates({rowID:-1,columnID:t}),o=n.getCellInfosAt(i);if(o.cellView=n._getViewAt(i),e.customHeader){if(!e.customHeader.buildContent)throw new Error("ERROR, customHeader is declared, but customHeader.buildContent function is not implemented!!!!!!");return e.customHeader.buildContent(o)}},cleanContent:function(e){const i=n.layout.getCellIDFromCoordinates({rowID:-1,columnID:t}),o=n.getCellInfosAt(i);o.cellView=n._getViewAt(i),o.cellView&&o.cellView.clean&&o.cellView.clean()}})},_manageCellRequests:function(){const e=this;e.onCellRequest((function(t){if(t.rowID>=0&&t.columnID>=0){const i=e.layout.getLeafColumns()[t.columnID],n=e.layout.getColumnOnCellRequest(t.columnID);if(n){if(i&&"tree"===i.dataIndex){const i=t.cellView;i.setProperties(e.treeNodeCellOptions),i.flatTreeFlag=e.hasFlatTreeState(),ae.call(this,t,t.nodeModel)}return n.call(e,t)}}e.defaultOnCellRequest(t)}))},__getTypeRepAndValueForHeader:function(e){let t,i=e.cellModel;const n=this.__getIconForHeader(e);return void 0===i&&void 0===n||(t=!0),{useTweaker:t,typeRepresentation:"string",value:i}},__getTypeRepAndValueForStandardCells:function(t){const i=this.layout;let n,o,l,s=t.cellModel,r=!1;{o=i._getCellTypeRepresentation(t);const a=this.getNodeModelAtRowID(t.rowID);if(a){const u=a.options.grid,d=i.getLeafColumns()[t.columnID],c=i.getColumnHasCellValue(t.columnID),h=c&&!c.call(this,t),g=i.getColumnGetCellValue(t.columnID);h||!u.hasOwnProperty(d.dataIndex)&&void 0===s&&!g||(n=!0,"tree"===d.dataIndex&&"string"===o&&void 0===g?(l=a.getReferenceLabel(),r=void 0!==l):(l=a.getReferenceValue(d.dataIndex),r=a.hasReferenceValue(d.dataIndex),void 0===l&&void 0!==s&&(r||(l=e.clone(s,!1)))))}}return{typeRepresentation:o,useTweaker:n,value:s,referenceValue:l}},__getIconForHeader(e){const t=this.layout;let i;const n=t.getColumnOrGroupFromCoordinates(e);return i=n?n.icon:t.getColumnIcon(e.columnID),i},_computeTweakerOptions:function(e,t){const i=this.layout,n=this._parent(e,t),o=this.getNodeModelAtRowID(e.rowID);let l=Object.assign({},e);if(o&&o.getNodeSource()===a.NODE_SOURCE.GROUPING&&"tree"===i.getDataIndexFromColumnIndex(e.columnID)){const t=o.getProperty();l=void 0!==i.getColumnIndex(t)?Object.assign({},e,{columnID:i.getColumnIndex(t)}):e}else n.readOnly=!this.isCellInEdition(e.cellID),n.semantics.allowResetToUndefinedByUIFlag=i.getColumnOptionValue(e.columnID,"allowResetToUndefinedByUIFlag"),l=e;const s=i.getColumnOptionValue(e.columnID,"allowResetToUndefinedByUIFlag");void 0!==s&&(n.semantics.allowResetToUndefinedByUIFlag=s);const r=i.getColumnOptionValue(e.columnID,"disabled");void 0!==r&&(n.semantics.disabled=r),n.semantics.allowUnsafeHTMLContent=i.getColumnShouldCellAllowUnsafeHTMLContentAt(l.columnID).call(this,l),n.semantics.hyperlinkTarget=i.getColumnOptionValue(l.columnID,"hyperlinkTarget");const u=this.layout.getColumnOrGroup(e.columnID);if(u&&(n.semantics.useWrappedView=u.useWrappedView),e.rowID<=-1&&e.columnID>=0){const t=this.__getIconForHeader(e);n.semantics.icon=t}if(e.rowID>-1){const t=i.getColumnOptionValue(e.columnID,"alignment");"near"!==t&&"center"!==t&&"far"!==t||(n.semantics.alignment=t)}return n},_isCellDraggable:function(e){return e.columnID>=0&&e.rowID>=0&&this.cellDragEnabledFlag},_getTypeRepAndValue:function(e){return e.rowID<=-1&&e.columnID>=0?this.__getTypeRepAndValueForHeader(e):this.__getTypeRepAndValueForStandardCells(e)},_manageUserInteractions:function(){const e=this;C.addEventOnElement(e,e,"buttonclick",(function(t,i){if(t.target.hasClassName("wux-datagridview-selection-checkbox")&&e._selectAllCheckBoxListenChange){const n=t.target.dsModel;if(n){if(i.rowID<0)if(i.columnID<0)n.checkFlag?e.selectAllVisibleNodes():e.unselectAll();else{const o=e.layout.getColumnOrGroupFromCoordinates(i);o&&(t.options.shiftKey||e.setActiveCell(i.cellID),n.checkFlag?e.selectColumnOrGroup(o,!0,t.options.shiftKey):e.unselectColumnOrGroup(o))}e._selectAllCheckBoxListenChange=!0}}})),C.addEventOnElement(e,e,"valueChangedByKeyPressed",((e,t)=>{e&&e.target&&t&&t.rowID>=0&&-1===t.columnID&&e.target.hasClassName("wux-datagridview-selection-checkbox")&&this._onPointerHit(e,t)})),this._managePointerEvents(),this._manageContextualMenu()},_manageContextualMenu:function(){const e=this;void 0===e._ctxMenuToken&&(e._ctxMenuToken=D.addEventListener(this.elements.container,{callback:function(t){if(oe.call(e),se.call(e,!0),t.info.target&&C.hasClass(t.info.target,"wux-datagridview-drag-grip"))return;C.pushUserInteractionContext();const i=e.getCellInfosFromHtmlElement(t.info.target);if(e.selectionBehavior.selectOnContextualEvent)if(i){e.setActiveCell(i.cellID,!0,!0);e.isCellSelected(i.cellID)||e.selectCell(i.cellID,!1)}else e.setActiveCell(-1);if(i&&t.data&&t.data.target&&t.data.target.getTagName&&e.isCellInEdition(i.cellID)){const e=t.data.target.getTagName();if(("input"===e||"textarea"===e)&&!t.data.target.hasAttribute("has-handler"))return}const n=e.onContextualEvent({context:t.context,collectionView:e,infos:t.info,data:t.data,cellInfos:i});return C.popUserInteractionContext(),n}}))},buildDefaultContextualMenu:function(e,t){return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e,t):[]},loadCustomViews:function(e,t){"number"==typeof t&&(t<e.length?t=e[t].identifier:console.log("You are trying to set a customView that does not exist")),this.getCustomViewsManager().setCustomViews(e,t,!0)},showCustomViewsDialog:function(){return this.getCustomViewsManager()?this.getCustomViewsManager().showCustomViewsDialog():null},_buildMassUpdateDialogAttributes:function(){const e=this.layout;let t,i;const n=e.getOrderedColumnsReverseIndexes();t=this._columnsXSO&&(i=[...this._columnsXSO.get()])&&i.length>0?i.sort(((e,t)=>n[e]-n[t])):e.getVisibleOrderedColumnsIndexes();const o=[],l=e.getLeafColumns();for(const i of t)if(e.getColumnEditableFlag(i)&&e.getColumnMassUpdateAllowedFlag(i)){const t=l[i];if(t){const n={name:t.dataIndex,label:t.text,typeRepresentation:e.getColumnTypeRepresentation(i),semantics:e.getColumnSemantics(i)};o.push(n)}}return o},showModelMassUpdateDialog:function(){if(!this._modelMassUpdateDialog){const e=this;this._modelMassUpdateDialog=new P({identifier:this.identifier+"_MassUpdate",immersiveFrame:this.getContainingImmersiveFrame(),treeDocument:this.getTreeDocument(),setNodeModelValueFunction:function(t,i,n){if("tree"===i||t.options.grid.hasOwnProperty(i)||void 0!==e.layout.getColumnGetCellValue(i)){const o=e.layout.getCellIDFromCoordinates({rowID:t._getRowID(),columnID:e.layout.getColumnIndex(i)});e.getCellEditableState(o)&&(e.setNodeModelValue(t,i,n),e.flashEffectOnCell("ui-modified",o))}},autoCloseFlag:!1,resizableFlag:!0,width:500,height:500})}const e=this._buildMassUpdateDialogAttributes();this._modelMassUpdateDialog.attributes=e,this._modelMassUpdateDialog.resetAttributesValues(),this._modelMassUpdateDialog.immersiveFrame=this.getContainingImmersiveFrame(),this._modelMassUpdateDialog.visibleFlag=!0,this._modelMassUpdateDialog.bringToFront()},getContainingImmersiveFrame:function(){const e=C.firstParentWithClass(this.getContent(),"wux-windows-immersive-frame");return e?e.dsModel:void 0},_onPrivateScrollEnd:function(){if(0===this._tweakerToGenerateCount&&!this._renderingTaskInterrupted&&this.elements&&this.elements.container){const e=this.layout.getColumnModel();if(e&&e.hasFitVisibleContentColumn()){if(!this.isInViewTransaction())return void this.invalidateLayout({postUpdateCellWidth:!0});this.updateView({updateCellWidth:!0})}this._onAllCellsRendered()}},_onPrivateReady:function(){0===this._tweakerToGenerateCount&&this._onAllCellsRendered()},_onEndResizeListener:function(){const e=this.layout;if(e){const t=e.getColumnModel();t&&t.hasAutoWidthColumnWithAutoRowHeightFlag()&&(e._computedRows=[])}this._parent()},requestDelayedModelData:function(e,t){const i=this;if(this.onDelayedModelDataRequest&&i._rowModel){const n=this.layout;if(i.getViewportDimensions().height>0||t){let o=0,l=0;if(t){o=0,l=i.getRowModelLength()-1}else{const e=n.getMinMaxVisibleRowIDs();o=e.minRowID,l=e.maxRowID}const s=t?n.getOrderedColumnsIndexes():n.getDisplayedColumnsIndexes();i._rowModel.prepareUpdate(),i.onDelayedModelDataRequest({collectionView:i,startNodeIndex:o,endNodeIndex:l,displayedColumnsIndexes:s,context:e}),i._rowModel.pushUpdate()}}},cellShouldBeSelected:function(e){const t=this.layout.getCellCoordinatesAt(e);return t.rowID>=0&&(!this.layout.rowsHeader||-1!==t.columnID)},getEditionManager:function(e){const t=this.layout.getCellCoordinatesAt(e),i=this.layout.getColumnEditionPolicy(t.columnID);if(!this._editionManagers[i]){if("EditionOnDoubleClick"===i)this._editionManagers[i]=new b;else if("EditionOnClick"===i)this._editionManagers[i]=new x;else if("DelayedEditionOnClick"===i)this._editionManagers[i]=new M;else if("EditionOnOver"===i)this._editionManagers[i]=new F;else{if("EditionInPlace"!==i)return null;this._editionManagers[i]=new O}this._editionManagers[i]&&(this._editionManagers[i].collectionView=this)}return this._editionManagers[i]},_onEditionModeChanged:function(e,t){const i=this.layout;let n=i.getCellCoordinatesAt(e);if(n.columnID>=0&&n.rowID>=0&&this.cellDragEnabledFlag){const i=this._getViewAt(e).getReusableContent(),n=i.getContent?i.getContent():i;n&&n.setAttribute("draggable",!t)}t||(n=i.getCellCoordinatesAt(e),i.isAFitToContentColumn(n.columnID)&&this.updateView({updateCellWidth:!0}),i.getColumnAutoRowHeightFlag(n.columnID)&&i.resetRowHeight(n.rowID))},_managePointerEvents:function(){const e=this;this._selectionHasBeenDoneOnDown=!1,C.addEventOnElement(this,this,s.POINTERDOWN,(function(t,i){e.callMethodFromUIInteraction("_onCapturePointerDown",t,i)}),!0),C.addEventOnElement(this,this,s.POINTERMOVE,(function(t,i){e.callMethodFromUIInteraction("_onPointerMove",t,i)}),!0),C.addEventOnElement(this,this,s.POINTERUP,(function(t,i){e.callMethodFromUIInteraction("_onPointerUp",t,i)})),C.addEventOnElement(this,this,s.POINTERHIT,(function(t,i){e.callMethodFromUIInteraction("_onPointerHit",t,i)})),C.addEventOnElement(this,this,"dblclick",(function(t,i){if(U){const t=e.layout,i=t.getLeafColumns();if(N>=0&&N<i.length&&!0===t.getColumnResizableFlag(N)){e.sizeColumnOrGroupToFit(N,L,{isUserInteraction:!0,computeColumnHeader:!0});const i=t.getColumnModel();(t.getColumnAutoRowHeightFlag(N)||i&&i.hasAutoWidthColumnWithAutoRowHeightFlag())&&t.resetRowHeights()}}}))},_onPointerHit:function(e,t){if(!(e.target.hasClassName&&e.target.hasClassName("wux-layouts-treeview-expander")||U)){if(this.PointerHitScope=!0,t&&t.rowID>-1&&t.columnID>-1&&(1!==e.multipleHitCount||this._selectionHasBeenDoneOnDown||this._manageCellSelection(e,t,"up")),this._selectionHasBeenDoneOnDown=!1,t&&-1===t.rowID){if(!U){const i=this.layout;if(i.getColumnSortableFlag(t.columnID)){ce.call(this);const n=i.getDataIndexFromColumnIndex(t.columnID),o=[];let l;const s=this.sortModel;let r=!1;if(s&&s.length>0)for(let t=0;t<s.length;t++)if(s[t].dataIndex===n){if(this._useTreeDocumentRestoration&&"desc"===s[t].sort){r=!0;continue}if(l="asc"===s[t].sort?"desc":"asc",o.push({dataIndex:n,sort:l}),!e.ctrlKey)break}else e.ctrlKey&&o.push(s[t]);0===o.length&&this._useTreeDocumentRestoration&&(r?u.restoreTreeDocumentOrder(this.treeDocument):s&&0!==s.length||u.saveTreeDocumentOrder(this.treeDocument)),void 0!==l||r||(l="asc",o.push({dataIndex:n,sort:l})),this.sortModel=o,i.saveColumnSortModelInPreferences()}}}else if(t&&-1===t.columnID&&this.showSelectionCheckBoxesFlag){if(t.nodeModel){if(this._selectAllCheckBoxListenChange=!1,t.rowID>=0){if(t.nodeModel.isSelected())this.unselectNodeModel(t.nodeModel);else{const i=this.getTreeDocument();i&&i.options.shouldBeSelected.call(i,t.nodeModel)&&(e.shiftKey||this.setActiveCell(t.cellID),this.selectNodeModel(t.nodeModel,!0,e.shiftKey))}}this._selectAllCheckBoxListenChange=!0}}else if((!t||t.columnID<-1)&&2!==e.multipleHitCount){let t=!1;if(e.target===this.elements.scroller.getContent()||this.hasRightContainer()&&e.target===this.elements.rightScroller.getContent()||this.hasLeftContainer()&&e.target===this.elements.leftScroller.getContent()){const i=e.target.getDimensions(),n=w.getScrollbarWidth();let o=!1,l=!1;if(e.target===this.elements.scroller.getContent()){const e=this.layout.getContentDimensions();o=i.width<e.width;l=0===this.layout.getRightContainerWidth()&&i.height<e.height}else if(this.hasRightContainer()&&e.target===this.elements.rightScroller.getContent()){const e=this.layout.getRightContainerWidth();o=i.width<e;const t=this.layout.getContentDimensions();l=i.height<t.height}else if(this.hasLeftContainer()&&e.target===this.elements.leftScroller.getContent()){const e=this.layout.getLeftContainerWidth();o=i.width<e,l=!1}(o&&e.offsetY>=i.height-n&&e.offsetY<=i.height||l&&e.offsetX>=i.width-n&&e.offsetX<=i.width)&&(t=!0)}t||(!this.selectionBehavior.unselectAllOnEmptyArea||e.ctrlKey||e.shiftKey||this.unselectAll(),this.setFocusOnCellContentFlag(!1),this.setActiveCell(-1))}this.PointerHitScope=!1}},_onPointerUp:function(e,t){if(W&&void 0!==N){const e=this.layout;if(e){const t=e.getColumnModel();e._saveColumnWidthInPreferences(N),(e.getColumnAutoRowHeightFlag(N)||t&&t.hasAutoWidthColumnWithAutoRowHeightFlag())&&e.resetRowHeights()}}W=!1,k=void 0,this.getContent().removeAttribute("is-resizing-column")},_onPointerMove:function(e,t){if(W&&void 0!==N){let t,i;L<-1?(t=this.layout.getColumnOrGroupFromCoordinates({columnID:N,rowID:L}),i=this.layout.getColumnOrGroupPinned(t)):i=this.layout.getColumnPinned(N);let n=0;return n="right"===i?k+(H-e.clientX):k+(e.clientX-H),n=Math.max(0,n),void(t?this.layout.setColumnOrGroupWidth(t,n):this.layout.setColumnWidth(N,n))}this._computeResizedColumnID(e,t)},_onCapturePointerDown:function(e,t){if(!e.target.hasClassName||!e.target.hasClassName("wux-layouts-treeview-expander")){if(this.PointerDownScope=!0,this._computeResizedColumnID(e,t),U&&void 0!==N&&N>=0)if(W=!0,e.preventDefault(),H=e.clientX,L<-1){const e=this.layout.getColumnOrGroupFromCoordinates({rowID:L,columnID:N});k=this.layout.getColumnOrGroupComputedWidth(e)}else k=this.layout.getColumnComputedWidth(N);else if(t&&-1!==t.rowID&&t.columnID>=-1){if(!e.ctrlKey&&!e.shiftKey){const e=this.getEditionManager(t.cellID);e&&e.onCellPointerDown(t.cellID)}this._selectionHasBeenDoneOnDown=!1,!(t.columnID>-1)||s.isTouchEvent(e)||this.selectionBehavior&&this.selectionBehavior.selectOnPointerUp||(this._selectionHasBeenDoneOnDown=this._manageCellSelection(e,t,"down"))}this.PointerDownScope=!1}},_manageCellSelection:function(e,t,i){const n=this.layout.getColumnGetCellSelectableState(t.columnID);if(n&&!n.call(this,t,e.target))return this.setActiveCell(t.cellID),!0;const o=this.selectionBehavior.toggle||e.ctrlKey,l={cellID:this.getActiveCellID(),nodeModel:this.getNodeModelAt(this.getActiveCellID())};if(!e.shiftKey&&t.cellView&&t.cellView._reusableContent&&t.cellView._reusableContent.manageSelection&&t.cellView._reusableContent.manageSelection(e,o,l))return this.setActiveCell(t.cellID),!0;const s=this.isCellSelected(t.cellID);return s&&(this.isCellInEdition(t.cellID)||"ContextualMenuColumn"===this.layout.getColumnIdentifiers(t.columnID).dataIndex)?(this.setActiveCell(t.cellID),!0):s&&o&&"up"===i?(this.unselectCell(t.cellID),this.setActiveCell(t.cellID),!0):!s||"up"===i||e.shiftKey?(this.selectCell(t.cellID,o,e.shiftKey),e.shiftKey&&t.cellView&&t.cellView._reusableContent&&t.cellView._reusableContent.manageSelection&&t.cellView._reusableContent.manageSelection(e,o,l),!0):(!s||e.shiftKey||e.ctrlKey||this.setActiveCell(t.cellID),!1)},_computeResizedColumnID:function(e,t){const i=this,n=this.layout,o=n.getColumnModel();if(t&&t.columnID>-1&&(t.rowID<=-1||t.columnID===n._lastLeftPinnedColumnIndex||t.columnID===n._firstRightPinnedColumnIndex||t.columnID===n._firstUnpinnedColumnIndex)){N=-1,L=-1;const i=n.getColumnOrGroupFromCoordinates(t);let l,s,r,a;const u=C.firstParentWithClass(e.target,"wux-layouts-collectionview-cell");if(u){const d=u.getBoundingClientRect().x;i?(l=n.getColumnOrGroupComputedWidth(i),s=n.getColumnOrGroupPinned(i),L=t.rowID,r=t.columnID,a=t.columnID):(l=n.getColumnComputedWidth(t.columnID),s=n.getColumnPinned(t.columnID),r=t.columnID,a=t.columnID),e.clientX-d>=-1&&e.clientX-d<=B?"right"===s?N=r:(t.rowID<=-1||t.columnID===n._firstUnpinnedColumnIndex)&&(N=o?o.getPreviousVisibleGroupOrColumnID(L,r):-1):e.clientX-d>=l-B&&e.clientX-d<=l&&("right"===s?t.rowID<=-1&&(N=o?o.getNextVisibleGroupOrColumnID(L,a):-1):(t.rowID<=-1||t.columnID===n._lastLeftPinnedColumnIndex)&&(N=a))}}else N=void 0,this.hasLeftContainer()&&(e.target===this.elements.leftHeaderScrollContainer||e.target===this.elements.leftScrollContainer||e.target===this.elements.leftScroller.getContent()||e.target===this.elements.leftSpacerContainer)&&e.offsetX>=this.elements.leftScrollContainer.clientWidth-B||e.target===this._getScroller().getContent()&&e.offsetX<=B?N=n._getColumnIDInLeafColumnHierarchyAtRowID(n._lastLeftPinnedColumnIndex,L):this.hasRightContainer()&&(e.target===this.elements.rightHeaderScrollContainer||e.target===this.elements.rightScrollContainer||e.target===this.elements.rightScroller.getContent()||e.target===this.elements.rightSpacerContainer)&&e.offsetX<=B&&(N=n._getColumnIDInLeafColumnHierarchyAtRowID(n._firstRightPinnedColumnIndex,L));N>=0&&n.getColumnResizableFlag(N)&&!n.isAFitToContentColumn(N)?(U=!0,i._preventScroll=!0,this.getContent().setAttribute("is-resizing-column","true")):(U=!1,i._preventScroll=!1,N=void 0,this.getContent().removeAttribute("is-resizing-column"))},getRowModelLength:function(e){return this._rowModel?this._rowModel.getRowModelLength(e):0},getNodeModelAt:function(e){const t=this.layout.getCellCoordinatesAt(e);if(this._rowModel)return this._rowModel.getVisibleNodeModel(t.rowID)},hasCellValue:function(e){let t=!1;const i=this.layout,n=e.nodeModel;if(n){const o=i.getDataIndexFromColumnIndex(e.columnID),l=i.getColumnGetCellValue(e.columnID);if("tree"===o||n.options.grid.hasOwnProperty(o)||l){t=!0;const n=i.getColumnHasCellValue(e.columnID);n&&(t=n.call(this,e))}}return t},getCellValue:function(e){const t=this.layout;if(!(e.rowID<=-1)){if(-1===e.columnID)return String(e.rowID+1);if(e.columnID>-1){if((e.nodeModel&&e.nodeModel.getNodeSource())===a.NODE_SOURCE.GROUPING){if("tree"===(e.nodeModel&&t.getDataIndexFromColumnIndex(e.columnID)))return e.nodeModel.options.label}const i=t.getColumnHasCellValue(e.columnID);if(!(i&&!i.call(this,e))){const i=t.getColumnGetCellValue(e.columnID);if(i)return i.call(this,e);const n=e.nodeModel;if(n){const i=t.getDataIndexFromColumnIndex(e.columnID);return"tree"===i&&void 0!==n.options.label?n.options.label:n.getAttributeValue(i)}this._rowModel&&this._rowModel.dataSource||window.console.log("!! No TreeNodeModel at rowID = "+e.rowID)}return""}return""}{const i=t.getColumnOrGroupFromCoordinates(e);if(i){let n="";return e.columnID>-1&&(e.rowID<-1||t.getColumnShowTextFlag(e.columnID)||!t.getColumnIcon(e.columnID))&&(n=i.text),n}}},getModelAt:function(e){const t=this.getLightCellInfosAt(e);return this.getCellValue(t)},setModelAt:function(e,t,i){const n=this.layout,o=n.getCellCoordinatesAt(e),l=this.getNodeModelAtRowID(o.rowID);if(l){const s=n.getDataIndexFromColumnIndex(o.columnID),r=this.setNodeModelValue(l,s,t,i);r&&r.updateCellView&&this.updateCellView(e,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}else-1!==o.rowID&&console.log("!! setModelAt NO TreeNodeModel at rowID = "+o.rowID+" cellID = "+e)},setNodeModelValue:function(t,i,n,o){if(t){const l=this.layout,s=t._getRowID(),r=l.getColumnIndex(i),a=l.getCellIDFromCoordinates({rowID:s,columnID:r}),u=l.getColumnSetCellValue(i);if(u){const l=this.getCellInfosAt(a);return void 0===o&&void 0===(o=t.getReferenceValue(i))&&void 0===(o=l.cellModel)&&(o=e.clone(n,!1)),t.setReferenceValue(i,o),u.call(this,l,n)}"tree"===i&&"string"==typeof n&&(t.setLabel(n),void 0!==o&&t.setReferenceLabel(o)),t.setAttribute(i,n)}},getCellInfosAt:function(e){const t=this.getModelAt(e),i=this.layout.getCellCoordinatesAt(e),n=this.getNodeModelAtRowID(i.rowID);return{cellID:e,columnID:i.columnID,rowID:i.rowID,cellModel:t,nodeModel:n}},getLightCellInfosAt:function(e){const t=this.layout.getCellCoordinatesAt(e),i=this.getNodeModelAtRowID(t.rowID);return{cellID:e,columnID:t.columnID,rowID:t.rowID,nodeModel:i}},getXSOElementID:function(e){return e?e.id:void 0},_getXSOElementFromCellID:function(e){const t=this.layout,i=t.getCellCoordinatesAt(e),n=t.getDataIndexFromColumnIndex(i.columnID),o=this.getNodeModelAtRowID(i.rowID);return{id:i.rowID+"_"+n,rowID:i.rowID,columnDataIndex:n,nodeModel:o}},getCellIDFromXSOElement:function(e){let t=-1;if(e){const i=e.rowID,n=this.layout,o=n.getColumnIndex(e.columnDataIndex);t=n.getCellIDFromCoordinates({rowID:i,columnID:o})}return t},_updateXSOElements:function(){const e=this.getCellsXSO();if(e){const t=e.get(),i=this;t.forEach((function(e){if(i.getNodeModelAtRowID(e.rowID)!==e.nodeModel&&(i.unselectCell(i.getCellIDFromXSOElement(e)),e.nodeModel.isVisible())){const t=i.layout.getCellIDFromCoordinates({rowID:e.nodeModel._getRowID(),columnID:i.layout.getColumnIndex(e.columnDataIndex)});i.selectCell(t,!0,!1,!1)}}))}},_updateActiveCell:function(e){if(e){if(!e.nodeModel)return void this.setActiveCell(-1);let t;if(e.rowID>=0&&e.rowID<this.getModelLength()&&(t=this.getNodeModelAtRowID(e.rowID)),t!==e.nodeModel)if(e.nodeModel.isVisible()){const t=this.layout.getCellIDFromCoordinates({rowID:e.nodeModel._getRowID(),columnID:this.layout.getColumnIndex(e.columnDataIndex)});this.setActiveCell(t,!1,!0)}else this.setActiveCell(-1)}},_shouldHandleCopy:function(e){if(!this._parent())return!1;const t=this.getActiveCellID();if(this.isCellInEdition(t)&&e.target.getTagName){const t=e.target.getTagName();if("input"===t||"textarea"===t)return!1}return!0},_copyToPlainText:function(){const e=this.getNodesXSO(),t=this;let i,n="";if(e.isEmpty()||(i=e.get().filter((function(e){return e.isVisible()}))),i&&i.length>0){u.sortNodesByRowID(i);for(let e=0;e<i.length;e++){const o=i[e],l=t.layout.getCellsFromNodeModel(o,!0);for(let e=0;e<l.length;e++){const i=t.getCellInfosAt(l[e]),o=t._getCellValueForCopy(i);void 0!==o&&(n+=o),e<l.length-1&&(n+="\t")}e<i.length-1&&(n+="\n")}}else{if(!this.getCellsXSO().isEmpty()){const e=t.layout._getXSORectangularShape();if(void 0===e)K("ClipboardError","ClipboardActionKoMultipleSelection");else for(let i=e.minRowID;i<e.minRowID+e.height;i++){let o=e.minColumnID;for(let l=0;l<e.width;l++){const s={rowID:i,columnID:o},r=t.layout.getCellIDFromCoordinates(s),a=t.getCellInfosAt(r),u=t._getCellValueForCopy(a);void 0!==u&&(n+=u),l<e.width-1&&(n+="\t");const d=this.layout.getColumnModel();o=d?d.getNextVisibleColumnID(o):-1}i<e.minRowID+e.height-1&&(n+="\n")}}}return n},_pasteFromPlainText:function(e){const t=function(e){"\n"===e[e.length-1]&&(e=e.slice(0,e.length-2));const t=e.split("\n");for(let e=0;e<t.length;e++)t[e]=t[e].split("\t");return t}(e);if(!(t&&t.length&&t[0]&&t[0].length))return;const i=t.length,n=t[0].length;for(let e=1;e<i;e++)if(t[e].length!==n)return void K("ClipboardError","InconsistentNbColumnsPerRowsInClipboard");const o=this,l=function(e,t){if(o.getCellEditableState(t)){const i=o.getCellInfosAt(t);o.setModelAt(t,o._processCellValueFromPaste(i,e)),o.flashEffectOnCell("ui-modified",t)}else o.flashEffectOnCell("ui-notmodified",t)},s=this.getNodesXSO();let r;if(s.isEmpty()||(r=s.get().filter((function(e){return e.isVisible()}))),r&&r.length>0){const e=this.layout.getVisibleOrderedColumnsIndexes();if(e.length!==n){if(1===n&&1===i){l(t[0][0],this.getActiveCellID())}else K("ClipboardError","NbColumnsOfClipboardNotEqualToNbVisibleColumns");return}u.sortNodesByRowID(r),this._rowModel.prepareUpdate(),this.prepareUpdateView();let o=0;for(let i=0;i<e.length;i++){const n=e[i];let s=0;for(let e=0;e<t.length;e++){const i={rowID:r[e+s]._rowID,columnID:n},a=this.layout.getCellIDFromCoordinates(i);if(l(t[e][o],a),e+s===r.length-1)break;e===t.length-1&&r.length>t.length&&(e=-1,s+=t.length)}o++}this._rowModel.pushUpdate(),this.pushUpdateView()}else{const e=this.getCellsXSO();let i=this.getActiveCellID();const n=e.get();let o;if(n.length>1){if(o=this.layout._getXSORectangularShape(),void 0===o)return void K("ClipboardError","MultipleSelection");i=this.layout.getCellIDFromCoordinates({rowID:o.minRowID,columnID:o.minColumnID})}else 1===n.length&&(i=this.getCellIDFromXSOElement(n[0]));this._rowModel.prepareUpdate(),this.prepareUpdateView();const s=this.layout.getCellCoordinatesAt(i);let r=0;for(let e=0;e<t.length;e++){let i=s.columnID;for(let n=0;n<t[e].length||o&&n<o.width;n++){const a={rowID:s.rowID+e+r,columnID:i},u=this.layout.getCellIDFromCoordinates(a);l(t[e][n%t[e].length],u);const d=this.layout.getColumnModel();if(i=d?d.getNextVisibleColumnID(i):-1,-1===i)break;if(o&&n>=o.width-1&&n>=o.width-1)break}if(o){if(e+r===o.height-1)break;e===t.length-1&&o.height>t.length&&(e=-1,r+=t.length)}}this._rowModel.pushUpdate(),this.pushUpdateView()}},getCellIDAsString:function(e){const t=this.layout,i=t.getCellCoordinatesAt(e);let n=-1;if(i.columnID>-1){n=t.getOrderedColumnsReverseIndexes()[i.columnID]}return i.rowID+":"+n},getAsCSV:function(e){const t=this.getNodesXSO(),i=this,n=this.layout,o=n.getColumnModel();let l,s="\ufeff";if(e&&e.onlySelectedRows)t&&!t.isEmpty()&&(l=t.get().slice(),u.sortNodesByRowID(l));else if(this.requestDelayedModelData("OnExport",!0),!e||void 0===e.onlyVisibleRows||e.onlyVisibleRows)l=i.model;else{const e=this.getTreeDocument();if(e&&this._rowModel){l=[];let t=0;const n=this._rowModel._getCurrentPaginationOptions();e._getTrueRoot().processDescendants({onlyVisibleNodes:!1,processNode:function(e){if(i.shouldNodeBeRepresented(e.nodeModel)){if(n){if(t<n.nodeMin)return-1===n.paginationNodeDepth||e.nodeModel.getNodeDepth()===n.paginationNodeDepth?(t++,{shouldProcessDescendants:-1===n.paginationNodeDepth}):void 0;if(t>n.nodeMax&&(-1===n.paginationNodeDepth||e.nodeModel.getNodeDepth()<=n.paginationNodeDepth))return{stopProcessing:!0};-1!==n.paginationNodeDepth&&e.nodeModel.getNodeDepth()!==n.paginationNodeDepth||t++}l.push(e.nodeModel)}}})}}if(!l)return;let r=e?e.columnKeys:void 0;const a=n.getLeafColumns();if(r)for(let e=0;e<r.length;e++)r[e]=n.getColumnIndex(r[e]);else if(e&&e.allColumns){r=new Array(a.length);for(let e=0;e<a.length;e++)r[e]=e}else r=n.getVisibleOrderedColumnsIndexes();const d=e&&e.columnSeparator?e.columnSeparator:",";if(!e||!e.skipColumnHeaders){let t,l,a,u,c,h=[];const g=[];for(t=0;t<r.length;t++){for(u=n.getColumnOrGroupFromCoordinates({rowID:-1,columnID:r[t]}),h=[],c=u;c;)h.push(c),c=c._parent;const s=o?o.getColumnTreeDepth():0;for(l=0;l<s;l++){if(g[l]||(g[l]="",e&&e.addLevelInformation&&(0===l?e&&e.forceQuotes?g[l]+='"'+S.get("Level")+'"':g[l]+=S.get("Level"):e&&e.forceQuotes&&(g[l]+='""'),g[l]+=d)),l>0)a=h[l]&&h[l].text?h[l].text:"";else{const e=n.getCellIDFromCoordinates({rowID:-1,columnID:r[t]}),o=i.getCellInfosAt(e),s=i._getCellValueForExport(o);a="string"==typeof s?s:h[l]&&h[l].text?h[l].text:""}let o=!1;const s=a.replace(/\"/g,'""');s!==a&&(a=s,o=!0),e&&e.forceQuotes||o||-1!==a.search(d)||a.indexOf("\n")>-1?g[l]+='"'+a+'"':g[l]+=a,t<r.length-1&&(g[l]+=d)}}for(let e=g.length-1;e>=0;e--)s+=g[e],s+="\n"}for(let t=0;t<l.length;t++){const o=l[t];if(!o||e&&"function"==typeof e.canNodeModelBeExported&&!e.canNodeModelBeExported(o))continue;let a=!1;for(let t=0;t<r.length;t++){const l=r[t];let u;if(!e||void 0===e.onlyVisibleRows||e.onlyVisibleRows||o.isVisible()){const e=n.getCellIDFromCoordinates({rowID:o._rowID,columnID:l});u=i.getCellInfosAt(e)}else{let e="";const t=n.getDataIndexFromColumnIndex(l);e="tree"===t&&void 0!==o.options.label?o.options.label:o.getAttributeValue(t),u={cellID:void 0,columnID:l,rowID:void 0,cellModel:e,nodeModel:o}}e&&e.addLevelInformation&&!a&&u&&u.nodeModel&&(a=!0,s+=u.nodeModel.getNodeDepth(),s+=d);let c=i._getCellValueForExport(u);if("string"==typeof c){let t=!1;const i=c.replace(/\"/g,'""');i!==c&&(c=i,t=!0),e&&e.forceQuotes||t||-1!==c.search(d)||c.indexOf("\n")>-1?s+='"'+c+'"':s+=c}t<r.length-1&&(s+=d)}t<l.length-1&&(s+="\n")}return s},isCellSelected:function(e){let t=!1;const i=this.layout,n=i.getCellCoordinatesAt(e);if(n.columnID===i._leftPinnedRowColumnID||n.columnID===i._unpinnedRowColumnID||n.columnID===i._rightPinnedRowColumnID||-1===n.columnID){const i=this.getNodeModelAt(e);if(i){const e=this.getNodesXSO();e&&(t=e.isIn(i))}}else t=this._parent(e);if(!t&&this.isColumnSelected(n.columnID)){const i=this.getNodeModelAt(e),n=this.getTreeDocument();i&&n&&n.options.shouldBeSelected.call(n,i)&&(t=!0)}return t},selectColumn:function(e,t,i){const n=this.layout,o=this.columnSelection;if(this._columnsXSO&&("single"===o||"multiple"===o)&&n.getColumnSelectableFlag(e)){const l=n.getColumnIndex(e);if(i&&"multiple"===o){const e=n.getOrderedColumnsIndexes();if(e&&e.length>0){let i=e[0];const o=this.getActiveCellID();o>=0&&(i=n.getCellCoordinatesAt(o).columnID);const s=n.getOrderedColumnsReverseIndexes(),r=Math.min(s[i],s[l]),a=Math.max(s[i],s[l]);if(!t){const e=[];this._columnsXSO.get().forEach((function(t){const i=t;(s[i]<r||s[i]>a)&&e.push(i)})),e.length>0&&this._columnsXSO.remove(e)}const u=[];for(let t=r;t<=a;t++){const i=e[t];!this._columnsXSO.isIn(i)&&n.getColumnSelectableFlag(i)&&u.push(i)}u.length>0&&this._columnsXSO.add(u)}}else t&&"multiple"===o?this._columnsXSO.add(l):this._columnsXSO.unique(l)}},unselectColumn:function(e){if(this._columnsXSO){const t=this.layout.getColumnIndex(e);this._columnsXSO.remove(t)}},selectColumnOrGroup:function(e,t,i){const n=this.layout,o=n.getColumnModel();if(!o||o.isGroupInBalancedTree(e))if(e&&e.children){if(n.getColumnOrGroupSelectableState(e)){const o=_.getLeafItems(e);for(let e=0;e<o.length;e++){const l=o[e];this.selectColumn(n.getColumnIndex(l.dataIndex),t,i)}}}else this.selectColumn(n.getColumnIndex(e.dataIndex),t,i);else console.warn("selectColumnOrGroup has been called on a column or Group that does not exist in the DataGridView")},unselectColumnOrGroup:function(e){const t=this.layout,i=t.getColumnModel();if(!i||i.isGroupInBalancedTree(e))if(e&&e.children){const i=_.getLeafItems(e);for(let e=0;e<i.length;e++){const n=i[e];this.unselectColumn(t.getColumnIndex(n.dataIndex))}}else this.unselectColumn(t.getColumnIndex(e.dataIndex));else console.warn("unselectColumnOrGroup has been called on a column or Group that does not exist in the DataGridView")},isColumnSelected:function(e){let t=!1;if(this._columnsXSO&&"none"!==this.columnSelection){const i=this.layout.getColumnIndex(e);this._columnsXSO.isIn(i)&&(t=!0)}return t},isColumnOrGroupSelected:function(e){let t=!1,i=!1;if(e&&e.children){const n=this.layout;if(n.getColumnOrGroupSelectableState(e)){t=void 0;for(let o=0;o<e.children.length;o++){const l=e.children[o];if(n.getColumnOrGroupSelectableState(l)){const e=this.isColumnOrGroupSelected(l);if(e?!1===t||"mixedState"===e?i=!0:t=!0:(t&&(i=!0),t=!1),i)break}}}}else e&&(t=this.isColumnSelected(e.dataIndex));return i?"mixedState":t},getColumnsXSO:function(){return this._columnsXSO},getXSOColumnID:function(e){return e},unselectAll:function(){this._parent(),this._columnsXSO&&this._columnsXSO.empty()},_getCellValueForExport:function(e){let t=this.layout.getColumnOptionValue(e.columnID,"getCellValueForExport");return t instanceof Function||(t=q),t.call(this,e)},_getCellValueForCopy:function(e){let t;return e.nodeModel&&!e.nodeModel._isFromOriginalModel()||(t=this.layout.getColumnOptionValue(e.columnID,"getCellValueForCopy")),t instanceof Function||(t=q),t.call(this,e)},_getCellValueForSort:function(e,t){let i=this.layout.getColumnOptionValue(t,"getCellValueForSort");return i instanceof Function||(i=Y),i.call(this,e,t)},_processCellValueFromPaste:function(e,t){let i;return e.nodeModel&&!e.nodeModel._isFromOriginalModel()||(i=this.layout.getColumnOptionValue(e.columnID,"processCellValueFromPaste")),i instanceof Function||(i=J),i.call(this,e,t)},insertRowCallback:function(e,t,i){},openPrintableViewWindow:function(e){const t=this;this.displayModalLoader(S.get("GeneratingPrintableView"),(function(){let i="<!DOCTYPE html>";i+=t.generatePrintableViewHTML();let n=G.getWebappsAssetUrl("DataGridView","index-datagridview-print.htm");n=n.replace("assets/","");let o,l=!1;if(navigator.userAgent&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(l=!0),e&&!l){const e=document.createElement("iframe");document.body.appendChild(e),e.src="#"+(new Date).getTime(),e.style.border=0,e.style.position="absolute",e.style.width="0px",e.style.height="0px",e.style.right="0px",e.style.top="0px",e.doc=null,e.doc=e.contentDocument?e.contentDocument:e.contentWindow?e.contentWindow.document:e.document,o={win:e.contentWindow,doc:e.doc,elem:e}}else{const e="scrollbars=yes,toolbar=yes,location=no,resizable=yes,width=1200,height=800",t=window.open(n,"_blank",e);t?o={win:t,doc:t.document,elem:t}:console.warn("Error in DataGridView.openPrintableViewWindow: cannot open the popup window")}if(o){o.doc.open("text/html","_blank");const n=window.document.styleSheets;for(let e=0;e<n.length;e++){const t=n[e];o.doc.write('<link rel="stylesheet" type="text/css" href="'+t.href+'" />')}if(o.doc.write(i),o.doc.close(),o.doc.title=S.get("PrintableView"),o.doc.body&&(o.doc.body.style.overflow="auto"),e){t.displayModalLoader(S.get("GeneratingPrintableView"));const e=function(){o.win.focus(),o.win.onafterprint=function(){o.elem&&o.elem.parentElement&&o.elem.parentElement.removeChild(iFrame)},t.removeModalLoader(S.get("GeneratingPrintableView")),o.win.print()};T.ie?setTimeout(e,1e3):o.win.onload=e}}t.removeModalLoader(S.get("GeneratingPrintableView"))}))},generatePrintableViewHTML:function(){this.requestDelayedModelData("OnPrint",!0);let e='<table class="wux-layouts-datagridview wux-print-datagridview-table">';e+=this._generatePrintableColumnHeaders();let t="<tbody>";for(let t=0;t<this.getModelLength();t++){e+=this._generatePrintableRow(t)}return t+="</tbody>",e+="</table>",e},_generatePrintableColumnHeaders:function(){const e=this.layout;let t="";const i=e.getColumnModel();if(i){t+="<thead>";const n=new g,o=i.getColumnItemsByDepth();for(let i=0;i<o.length;i++){const l=o[i];t+="<tr>",this.hasFlatTreeState()||(t+='<th class="wux-layouts-collectionview-cell wux-layouts-datagridview-cell wux-layouts-datagridview-column-header-cell" column-header>',i===o.length-1&&(t+=S.get("Level")),t+="</th>");for(let s=0;s<l.length;s++){const r=l[s];if(e.getColumnOrGroupPrintableState(r)){const l=-o.length+i;let a;a=l<-1?s:e.getColumnIndex(r.dataIndex);const u=e.getCellIDFromCoordinates({rowID:l,columnID:a}),d=this.getCellInfosAt(u);d.cellView=n,t+=this._generatePrintableCell(d)}}t+="</tr>"}t+="</thead>",n.setReusableContent(null),n.destroy()}return t},_generatePrintableRow:function(e){const t=this.layout,i=this.getNodeModelAtRowID(e),n=i.getNodeDepth();let o="<tr";if(0===n&&i.hasChildren()&&(o+=" root-node"),o+=">",!this.hasFlatTreeState()){o+='<td class="wux-layouts-collectionview-cell wux-layouts-datagridview-cell" align="center">';const e=i.hasChildren()&&(0===n||!i.isExpanded());if(n>0){if(e&&(o+='<div class="wux-print-datagridview-expander">'),o+='<div class="wux-tweakers wux-tweakers-string wux-tweakers-string-label">',o+=n,o+="</div>",e){const e=i.isExpanded()?"chevron-down":"chevron-right";o+=C.generateIcon({iconName:e,fontIconFamily:WUXManagedFontIcons.Font3DS}).outerHTML,o+="</div>"}}else if(e){const e=i.isExpanded()?"chevron-down":"chevron-right";o+=C.generateIcon({iconName:e,fontIconFamily:WUXManagedFontIcons.Font3DS}).outerHTML}o+="</td>"}const l=t.getVisibleOrderedColumnsIndexes();for(let i=0;i<l.length;i++){const n=l[i];if(t.getColumnPrintableFlag(n)){const i=t.getCellIDFromCoordinates({rowID:e,columnID:n}),l=this.getCellInfosAt(i);let s=null;const r=this.layout.getCellType(i),a=this._cellPool.use(r);a&&a.component&&(s=a.component),l.cellView=s,s instanceof m&&ae.call(this,l,l.nodeModel),o+=this._generatePrintableCell(l),s&&(s.setReusableContent(null),s.destroy())}}return o+="</tr>",o},_generatePrintableCell:function(e){let t;if(e){const i=this.layout,n=e.cellView?e.cellView.getInitialClassName():"wux-controls-abstract wux-layouts-collectionview-cell wux-layouts-datagridview-cell";if(e.rowID<0){t=`<th class="${n}" column-header`;const o=i.getColumnOrGroupFromCoordinates(e),l=i._getVisibleLeafCount(o);l>1&&(t+=' colspan="'+l+'"'),t+=">"}else{t=`<td class="${n}"`;const o=i.getColumnOptionValue(e.columnID,"alignment");"center"===o?t+=' align="center"':"far"===o&&(t+=' align="right"'),t+=">"}const o={readOnly:!0};this._setTweakerForCell(e,o);const l=e.cellView?e.cellView.getPrintableContent():"";l&&(t+=l),e.rowID<0?t+="</th>":t+="</td>"}return t},executePendingNotifications:function(e){if(this._rowModel&&this._rowModel._executePendingNotifications)return this._rowModel._executePendingNotifications(e)},flushPendingNotifications:function(){this._rowModel&&this._rowModel._flushPendingNotifications&&this._rowModel._flushPendingNotifications()},hasPendingNotifications:function(){if(this._rowModel&&this._rowModel._hasPendingNotifications)return this._rowModel._hasPendingNotifications()},getPendingNotifications:function(){if(this._rowModel&&this._rowModel._getPendingNotifications)return this._rowModel._getPendingNotifications()},getGroupingOptions:function(){return this._groupingOptions},_getScrollerFromCellID:function(e){const t=this.layout.getCellCoordinatesAt(e),i=this.layout.getColumnPinned(t.columnID);let n;return"left"===i?this.hasLeftContainer()&&(n=this.elements.leftScroller):"right"===i?this.hasRightContainer()&&(n=this.elements.rightScroller):n=this._getScroller(),n},_getVerticalScrollbarWidth(e){let t=this._scrollbarWidth?this._scrollbarWidth:this.getScrollbarWidth();return(e===this.elements.leftScroller||e===this._getScroller()&&this.layout.hasCellsInRightContainer())&&(t=0),t},_setGroupingOptions:function(e){this._groupingOptions=e},getNodeModelAtRowID:function(e){if(this._rowModel)return this._rowModel._getNodeModelAtRowID(e)},_updateModel:function(){this._rowModel&&this._rowModel._updateModel()},_hasUniformRowHeight:function(){return!this.columns.autoRowHeightFlag||!this.layout.getRowHeight},_getFindModel:function(){return this._rowModel},_askForDeletion:function(){this.deleteOptions&&this.deleteOptions.showConfirmationDialog?this.elements.deletionDialog?this.elements.deletionDialog.show():this.elements.deletionDialog=new R({title:S.get("DeleteDialogTitle"),identifier:this.identifier+"_DeletionDialog",immersiveFrame:this.getContainingImmersiveFrame(),content:S.get("DeleteDialogContent"),autoCloseFlag:!1,buttons:{Yes:new V({onClick:e=>{he.call(this),this.elements.deletionDialog.hide()}}),No:new V({onClick:e=>{this.elements.deletionDialog.hide()}})}}):he.call(this)},_onXSOPostAdd:function(e){const t=this,i=this.layout,n=this.getNodesXSO(),o=i.getMinMaxVisibleRowIDs();e.forEach((function(e){let i=e._getRowID();if("number"==typeof i&&i>=o.minRowID&&i<=o.maxRowID&&(t._updateRenderedRowCellsAttributes(i),t._updateRenderedRowCheckboxState(i,{checkFlag:!0,mixedState:!1})),!t.selectionBehavior.showMixedStateOnParents)return;const l=e.getParents(!1);let s;for(;s=l.shift();)s._nbSelectedDescendants?s._nbSelectedDescendants++:s._nbSelectedDescendants=1,i=s._getRowID(),"number"==typeof i&&i>=o.minRowID&&i<=o.maxRowID&&(n.isIn(s)||t._updateRenderedRowCheckboxState(i,{checkFlag:!0,mixedState:!0}),t._updateRenderedRowCellsAttributes(i))})),this._updateSelectAllCheckBox()},_onXSOPostRemove:function(e){const t=this,i=this.layout,n=this.getNodesXSO(),o=i.getMinMaxVisibleRowIDs();e.forEach((function(e){let i=e._getRowID();if("number"==typeof i&&i>=o.minRowID&&i<=o.maxRowID){t._updateRenderedRowCellsAttributes(i);const n=e._nbSelectedDescendants>0,o=e._nbSelectedDescendants>0;t._updateRenderedRowCheckboxState(i,{checkFlag:o,mixedState:n})}if(!t.selectionBehavior.showMixedStateOnParents)return;const l=e.getParents(!1);let s;for(;s=l.shift();)s._nbSelectedDescendants?s._nbSelectedDescendants--:s._nbSelectedDescendants=0,0!==s._nbSelectedDescendants||n.isIn(s)||(i=s._getRowID(),"number"==typeof i&&i>=o.minRowID&&i<=o.maxRowID&&(t._updateRenderedRowCellsAttributes(i),t._updateRenderedRowCheckboxState(i,{checkFlag:!1,mixedState:!1})))})),this._updateSelectAllCheckBox()},_onPXSOPostAdd:function(e){const t=this,i=this.layout.getMinMaxVisibleRowIDs();e.forEach((function(e){const n=e._getRowID();n>=i.minRowID&&n<=i.maxRowID&&t._updateRenderedRowCellsAttributes(n)}))},_onPXSOPostRemove:function(e){const t=this,i=this.layout.getMinMaxVisibleRowIDs();e.forEach((function(e){const n=e._getRowID();n>=i.minRowID&&n<=i.maxRowID&&t._updateRenderedRowCellsAttributes(n)}))}});function ce(){this._rowModel&&this._rowModel._isServerSide()&&(this.findWidget&&this.findWidget.close?this.findWidget.close():this.findCtx&&this.findCtx.findWidget&&(void 0!==this.findCtx.findWidget.visibleFlag?this.findCtx.findWidget.visibleFlag=!1:this.findCtx.findWidget.close instanceof Function&&this.findCtx.findWidget.close()))}function he(){const e=this.getTreeDocument();if(e){const t=e.getXSO().get();for(let e=0;e<t.length;e++)t[e].remove()}}return de.hasPreferences=function(e){return!(!e||"string"!=typeof e)&&w.checkPresenceOfPreferences(e,"wux-collectionView-dataGridView",!0)},de.importJsonPreferences=function(e,t){(t||"string"==typeof t)&&w.saveDataInPreferences(e,"wux-collectionView-dataGridView",void 0,JSON.parse(t),!1)},de}));