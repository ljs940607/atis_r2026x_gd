window.top.performance.mark("PIM_jsAppLoad"),
/*!  Copyright 2018 Dassault Systemes. All rights reserved. */
define("DS/PIMwebI3Dapp/PIMwebAppMain",["UWA/Core","DS/CATWebUXComponents/DMUFrameWindow","DS/PADUtils/PADSettingsMgt"],(function(e,t,n){"use strict";var i;let o,a;function r(e){var t=e.getValue("xsceneStoredObjects");return t&&"string"==typeof t||(t='{"products":{},"filters":{}}'),JSON.parse(t)}function s(e){e&&e.length&&(this.showWelcomePanel(!1),this.pad3DViewer.addRootNodesFromContent({json3DXContent:{protocol:"3DXContent",version:"1.1",source:"X3DSEAR_AP",data:{items:e.map((function(e){return{envId:require("DS/PADUtils/PADUtilsServices").getPlatformId(),objectId:e.id,objectType:e.type,displayName:e.displayName}}))}}}))}function d(e){s.call(this,e.map((function(e){return{id:e.resourceid,type:e["ds6w:type_value"],displayName:e["ds6w:label"]}})))}function l(e){if(e&&e.length){i.publish({event:"ENXViews/LandingPage/addOrRefresh",data:{objects:e.map((function(e){return{resourceid:e,openWithFilter:!1,loading:!0,fromCustom:!0}}))}});var t=setInterval(function(){this.isAppReady&&(clearInterval(t),require(["DS/PIMwebViewModel/PIMwebUtils"],function(t){t._fetchForWelcomePanel({ids:e,onComplete:function(e){var t=((e?JSON.parse(e):{}).results||[]).map(function(e){var t={};e.attributes.forEach((function(e){t[e.name]=e.value}));var n=t["ds6w:type"],i={resourceid:t.resourceid,label:t["ds6w:label"],icons:[t.type_icon_url],thumbnail:t.preview_url,grid:t,subLabel:t["ds6w:responsible"]+" | "+new Date(t["ds6w:modified"]).toLocaleString(),description:t["ds6w:identifier"],openWithFilter:!1,fromCustom:!0,loading:void 0,item2Load:{}};i.item2Load[i.resourceid]={};var o=!!this.pimCtrl&&this.pimCtrl.getLoadedData();return i.opened=!!o[i.resourceid]||Object.keys(o).some((function(e){return o[e].indexOf(i.resourceid)>=0})),"SIMItfSimulation"!==n&&"PLMPIMMetricReference"!==n||(i.addRemoveFromViewCtx=!0),i}.bind(this));i.publish({event:"ENXViews/LandingPage/addOrRefresh",data:{objects:t}})}.bind(this),onFailure:function(){}})}.bind(this)))}.bind(this),100)}}function p(e){this.isAppReady=!1,this.params=e,this.welcomePanel=this.pad3DViewer=this.pimCtrl=null,this.tokensWelcomePanel=[]}return p.prototype={constructor:p,initialize:function(){return new Promise(function(e){require(["DS/PADServices/views/LandingPage","DS/PADServices/utils/GlobalModelEvents","i18n!DS/PIMwebI3Dapp/assets/nls/PIMwebI3Dapp"],function(t,n,o){i=n,this.tokensWelcomePanel.push(i.subscribe({event:"ENXViews/LandingPage/refreshCustom"},function(e){var t=r(this.params.widget),n=[].concat(Object.keys(t.isr||{}),Object.keys(t.itf||{}));l.call(this,e.filter((function(e){return n.indexOf(e)>-1})))}.bind(this))),this.tokensWelcomePanel.push(i.subscribe({event:"ENXViews/LandingPage/openCustom"},function(e){var t=this.params.widget.getValue("xsceneStoredObjects"),n=[];t=t?JSON.parse(t):{},e.customitem2open.forEach((function(e){t.isr&&t.isr[e]?n.push({id:e,type:"SIMItfSimulation"}):t.itf&&t.itf[e]&&n.push({id:e,type:"PLMPIMMetricReference"})})),s.call(this,n)}.bind(this))),this.tokensWelcomePanel.push(i.subscribe({event:"ENXViews/LandingPage/removeFromView"},function(e){if(e&&e.customitem2remove&&e.customitem2remove.length){var t=this.pimCtrl.getLoadedData(),n=[];e.customitem2remove.forEach((function(e){t[e]&&-1===n.indexOf(e)?n.push(e):Object.keys(t).forEach((function(i){t[i].indexOf(e)>-1&&-1===n.indexOf(i)&&n.push(i)}))})),n.forEach(this.pimCtrl.removeIsr,this.pimCtrl)}}.bind(this))),this.tokensWelcomePanel.push(i.subscribe({event:"ENXViews/LandingPage/removeFromStore"},function(e){var t=this.params.widget.getValue("xsceneStoredObjects"),n=[];t=t?JSON.parse(t):{},e.customitem2remove.forEach((function(e){t.isr&&t.isr[e]&&-1===n.indexOf(e)?(n.push(e),delete t.isr[e]):t.itf&&t.itf[e]&&-1===n.indexOf(t.itf[e])&&(n.push(t.itf[e]),delete t.itf[e])})),this.params.widget.setValue("xsceneStoredObjects",JSON.stringify(t)),i.publish({event:"ENXViews/LandingPage/removeFromView",data:{customitem2remove:n}})}.bind(this))),this.tokensWelcomePanel.push(i.subscribe({event:"ENXViews/WelcomePanel/action/welcomePanelIsr"},function(){t.launchSearch({title:o.isr,precondition:'flattenedtaxonomies:"types/SIMItfSimulation"',showApplyButton:!1,ok:d.bind(this)})}.bind(this))),this.tokensWelcomePanel.push(i.subscribe({event:"ENXViews/WelcomePanel/action/welcomePanelItf"},function(){t.launchSearch({title:o.itf,precondition:'flattenedtaxonomies:"types/PLMPIMMetricReference"',showApplyButton:!1,ok:d.bind(this)})}.bind(this))),this.tokensWelcomePanel.push(i.subscribe({event:"ENXViews/WelcomePanel/action/welcomPanelPrefCmd"},function(){require(["DS/CATWebUXComponents/DMUCommandsManager","DS/CATWebUXPreferences/CATWebUXPreferencesManager"],function(e,t){let n=t.givePreferenceManager({context:this.pad3DViewer.getFrameWindow()});if(n)var i=n.subscribe("onPreferencesPanelDestroyed",function(){n.unsubscribe(i),this.showWelcomePanel(!0)}.bind(this));this.showWelcomePanel(!1),e&&e.getCommand("CATWebUXPreferencesHdr",this.pad3DViewer&&this.pad3DViewer.getCommandContext?this.pad3DViewer.getCommandContext():null).begin()}.bind(this))}.bind(this))),this.tokensWelcomePanel.push(i.subscribe({event:"ENXViews/WelcomePanel/action/userAssistance"},(function(){let e=require("DS/WebUAUtils/WebUAUtils");window.open(e.getHelpFullPath(a?o.userAssistanceURL_I3S:o.userAssistanceURL_I3D))}))),this.tokensWelcomePanel.push(i.subscribe({event:"ENXViews/WelcomePanel/action/whatsNew"},(function(){let e=require("DS/WebUAUtils/WebUAUtils");window.open(e.getEmbeddedHelpFullPath(a?o.whatsNewURL_I3S:o.whatsNewURL_I3D))})));var p=t.getDefaultActivities();p.activities[0].section.actions.splice(2,0,{id:"welcomePanelIsr",title:o.isr,icon:"interference-simulation"}),p.activities[0].section.actions.splice(3,0,{id:"welcomePanelItf",title:o.itf,icon:"interference-metric"}),p.activities.push({section:{id:"customizeAppSection",title:o.customApp,actions:[{id:"welcomPanelPrefCmd",title:o.prefs,icon:"cog"}]}}),p.activities.push({section:{id:"contentAndKnowledge",title:o.contentAndKnowledge,actions:[{id:"userAssistance",title:o.userAssistance,icon:"help"},{id:"whatsNew",title:o.whatsNew,icon:"megaphone"}]}}),this.welcomePanel=new t({widget:this.params.widget,readOnlyApp:!1,renderDiv:this.params.renderDiv,externalViewerMgt:!0,externalViewerMgtCB:function(e,t){!0!==t&&this.showWelcomePanel("viewer"!==e)}.bind(this),globalSearchPrecond:'flattenedtaxonomies:"types/SIMItfSimulation" OR flattenedtaxonomies:"types/PLMPIMMetricReference" OR flattenedtaxonomies:"types/VPMReference" OR flattenedtaxonomies:"types/VPMRepReference" OR flattenedtaxonomies:"types/ENOStrRefinementSpecification"',defaultActionId:p.defaultActionId,activities:p.activities,onLandingPageReady:this.params.onLandingPageReady}),this.welcomePanel.initialize().then(function(){var t=r(this.params.widget);l.call(this,[].concat(Object.keys(t.isr||{}),Object.keys(t.itf||{}))),e()}.bind(this))}.bind(this))}.bind(this))},setViewer:function(e){this.pad3DViewer=e,!this.params.initApp&&this.showWelcomePanel(!1);var t=e.render().getContent(),n=t.parentNode;t.style.position="relative",!this.params.renderDiv.parentNode&&n&&n!==this.params.renderDiv&&n.insertBefore(this.params.renderDiv,n.firstChild),this.params.renderDiv.insertBefore(t,this.params.renderDiv.firstChild),this.params.renderDiv.insertBefore(this.welcomePanel.elements.mainBody,this.params.renderDiv.firstChild),this.welcomePanel.setViewer(e,!this.params.initApp)},appReady:function(e){if(this.pimCtrl=e,this.isAppReady=!0,this.params.initApp){let a=this.params.widget.getValue("X3DContentId"),r=this.params.widget.id.indexOf("preview")>-1,s=this;if(this.params.widget.deleteValue("X3DContentId"),a)e.appInitFromTransition({x3dContent:JSON.parse(a),onNoActionDone:function(){s.showWelcomePanel(!1),this.addRootNodesFromContent({json3DXContent:JSON.parse(a),dispatch:!1})}.bind(this.pad3DViewer)});else if(!0===this.params.widget.getValue("autoreload")||!0===this.params.widget.getValue("autoreloadPreviewApp")&&!r){var t=this.params.widget.getValue("ItfSimuInSession");if((t=t?JSON.parse(t):null)&&!Array.isArray(t)&&"object"==typeof t){var n=Object.keys(t);if(1===n.length){var i={},o=n[0];Array.isArray(t[o])&&t[o].length?i.metricID=t[o]:i.isrID=o,this.showWelcomePanel(!1),e.load(i)}}}r?this.params.widget.setValue("autoreloadPreviewApp",!0):this.params.widget.deleteValue("autoreloadPreviewApp")}var a=this.welcomePanel.appReady();return this.welcomePanel.redraw(),a},dispose:function(){if(this.showWelcomePanel(!1),this.welcomePanel)return this.pad3DViewer=this.params=this.pimCtrl=null,this.tokensWelcomePanel.forEach(i.unsubscribe,i),this.tokensWelcomePanel.length=0,this.welcomePanel.dispose()},showWelcomePanel:function(e){this.welcomePanel&&(this.welcomePanel.elements.mainBody.style.position="relative",this.welcomePanel.elements.mainBody.style.display=e?"":"none",e&&this.welcomePanel.redraw())}},Object.freeze({getApp:function(i){if(!i||!i.data)throw new Error("App identification is missing! Unable to init app");if("I3D"!==i.data&&"I3S"!==i.data)throw new Error("Invalid app id: "+i.data);if("I3D"===i.data&&o)return o;if("I3S"===i.data&&a)return a;var r,s,d,l,u,c,f,m,w=[],g=i.widget,b=i.pad3DViewer,D=i.appMainDiv,P=b?b.getCommandContext():null,h={},v={module:"PIMweb"+i.data+"app",file:"PIMweb"+i.data+"appWkb.xml"};function A(e,t,n){window.top.performance.measure(g.id+e,n?g.id+t:t)}function I(e){window.top.performance.mark(g.id+e)}function S(){b&&b.getContentName({callbacks:{onComplete:function(e){g.setTitle(e.contentName)},onFailure:function(){}}})}function C(e){s&&r&&!l&&(d&&d(D),d=null,f.appReady(s),A("_PIM_Global widget creation time","PIM_jsAppLoad",!1),g.dispatchEvent("onWidgetAndAppReady","1"===g.getValue("widgetForODTReplay")?[{pad3DViewer:e}]:void 0))}""!==window.location.search&&(e.extend(h,e.Utils.parseQuery(window.location.search)),h.widgetDomain&&e.extend(h,e.Utils.parseQuery(h.widgetDomain))),"testWkb"in h&&(v={module:"PIMwebI3Dtst",file:"PIMwebI3DappTestWkb.xml"}),"I3S"===i.data&&require(["DS/PIMwebViewModel/PIMwebIsrMgr"].concat([]),(function(e){e.isUpdateSimulationAllowed({transAppID:i.data}).then((function(e){e&&(v={module:"PIMweb"+i.data+"app",file:"PIMweb"+i.data+"OnCloudappWkb.xml"})}))}));var M,y,V,_=function(){require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/PADUtils/PADCommandProxy"],(function(e,t){(M=e).renderDiv||M.initialize2(b.getFrameWindow().getViewerFrame(),t.appId(),g.getValue("changeControlActivation")?"show":"hide","top-right",(function(){M.addEvent("onAuthoringCtxVisible",(function(e){e.showAuthoringContext&&g.setValue("changeControlActivation",!0)}))}))}))},x=function(e){require(["DS/PADUtils/PADCommandProxy","DS/PADUtils/PADSharedSettings","i18n!DS/PADUtils/assets/nls/PADUtils"],(function(t,i,o){var a,r=[];V=function(){g.setPreferences([]),a.destroy(),r.forEach((function(e){e.cb&&n.removeEvent(e.cb,e.padFct)})),V=function(){}},y=function(){r.forEach((function(e){var t=e.preference.name,i=g.getValue(t),o=n.getSetting(t);(i="boolean"===e.preference.type&&"boolean"!=typeof i?"true"===i:i)!==o&&n.setSetting(t,i),e.fct&&e.fct(i)})),n.updateWidgetPreferences(),!a&&r.length&&(a=t.create({events:{onPreferenceModification:function(e){r.some((function(t){if(e.name===t.preference.name){if("boolean"!=typeof e.value&&"string"!=typeof e.value)throw new Error("Value must be a string or a boolean");if(n.getSetting(e.name)!==e.value){if("boolean"===t.preference.type&&"boolean"!=typeof e.value)throw new Error("Preference is a boolean type so value must be a boolean");t.debounce=!0,g.setValue(e.name,e.value),n.setSetting(e.name,e.value)}return t.fct&&t.fct(e.value),!0}}))}}}),r.forEach((function(e){e.cb&&n.addEvent(e.cb,e.padFct=function(t){e.debounce?e.debounce=!1:a.preferenceModification({name:e.preference.name,value:t})})})))},g.setPreferences([]),n.setSetting("syncAutoReload",!0),i.destroy(),i.addSharedSettings(g),r.push({preference:{name:"changeControlActivation",type:"boolean",label:o.changeControlActivation_label,defaultValue:!1},fct:function(e){M&&M[e?"show":"hide"]()},cb:"onChangeControlActivation",debounce:!1}),r.push({preference:{name:"changeControlPosition",type:"list",label:o.changeControlPosition_label,defaultValue:"top-right",options:[{label:o["top-right_label"],value:"top-right"},{label:o["top-left_label"],value:"top-left"},{label:o["bottom-left_label"],value:"bottom-left"},{label:o["bottom-right_label"],value:"bottom-right"}]},fct:function(e){M&&M.setPosition(e)}}),n.setSetting("authorizeChangeControl",!0),e&&_(),r.forEach((function(e){g.mergePreferences([e.preference])})),y(),require(["i18n!DS/ENOPAD3DViewer/assets/nls/PAD3DViewer"],(e=>{g.addEvent("onChangeFlexibleAssembliesSupport",(function(e,t){n.setSetting(e,t)}));var t=n.getSetting("enopad3dviewer_roles");let i=!0,o=require("DS/PADUtils/PADUtilsServices").isCloud(),a=require("DS/PADUtils/PADSession").isAuthoring();for(var r=0;r<t.length;r++)if("E19"===t[r].id&&(!t[r].platforms||t[r].platforms&&t[r].platforms.indexOf(require("DS/PADUtils/PADUtilsServices").getPlatformId())>-1)){i=!1;break}!i||o||a?(g.addPreference({name:"enopad3dviewer_flexibleAssemblySupportActivated",type:"hidden",defaultValue:!1,label:e.flexibleAssemblySupport,onchange:"onChangeFlexibleAssembliesSupport",value:!1}),n.setSetting("enopad3dviewer_flexibleAssemblySupportActivated",!1)):g.getPreference("enopad3dviewer_flexibleAssemblySupportActivated")||(g.addPreference({name:"enopad3dviewer_flexibleAssemblySupportActivated",type:"boolean",defaultValue:!1,label:e.flexibleAssemblySupport,onchange:"onChangeFlexibleAssembliesSupport",value:void 0!==g.getValue("enopad3dviewer_flexibleAssemblySupportActivated")&&g.getValue("enopad3dviewer_flexibleAssemblySupportActivated")}),n.setSetting("enopad3dviewer_flexibleAssemblySupportActivated",g.getValue("enopad3dviewer_flexibleAssemblySupportActivated"))),n.setSetting("enopad3dviewer_staticMappingSupportActivated",!a)})),g.addEvent("endEdit",y)}))};function U(e){e.unsubscribe(u),u=null,S(),_(),require("DS/PADUtils/PADUtilsServices").isCloud()&&!window.__preventPrefPanel&&e.getViewer().displayIntroductoryControlPreferencePanel(),I("_PIM_beforeAppComponentLoad"),require(["DS/PIMwebViewController/PIMwebItfCtrl"],(function(t){A("_PIM_AppComponentLoading","_PIM_beforeAppComponentLoad",!0),(s=t.getItfCtrl({pad3DViewer:e})).activate({readOnly:!1}),C(e)}))}function E(e){e.unsubscribe(c),c=null,I("_PIM_ownCommands"),A("_PIM_Action Bar merge app commands","_PIM_ownCommands",!0),I("_PIM_beforeDefaultCmdLoad"),P=b.getCommandContext(),(r=require("DS/CATWebUXComponents/DMUCommandsManager")).setDefaultCommand({ID:"PIMwebDefaultHdr",className:"DS/PIMwebViewController/PIMwebDefaultCmd",context:P});let t=r.getCommand("PIMwebEditItfHdr",P),n="Create";t.options&&t.options.arguments&&t.options.arguments[0]&&t.options.arguments[0].type&&(n=t.options.arguments[0].type),"Edit"===n&&(t.disable(),w.push(s.subscribe("onIsrAdded",(function(){t.enable()}))),w.push(s.subscribe("onItfAdded",(function(){t.enable()}))),w.push(s.subscribe("onIsrRemoved",(function(){t.disable()}))),(s.getLoadedIsr().length||s.isPIMDataLoaded())&&t.enable());let i=r.getCommand("PIMwebUpdateItfHdr",P);i&&(i.options&&i.options.arguments&&i.options.arguments[0]&&i.options.arguments[0].type&&(n=i.options.arguments[0].type),"Update"===n&&(i.disable(),w.push(s.subscribe("onIsrAdded",(function(){i.enable()}))),w.push(s.subscribe("onItfAdded",(function(){i.enable()}))),w.push(s.subscribe("onIsrRemoved",(function(){i.disable()}))),(s.getLoadedIsr().length||s.isPIMDataLoaded())&&i.enable())),A("_PIM_Default Cmd Init","_PIM_beforeDefaultCmdLoad",!0),C(e)}function W(e){A("_PIM_PAD3DViewer creation","_PIM_PAD3DViewerReady",!0),e.unsubscribe(l),l=null,C(e)}function N(t){return D||(D=e.createElement("div",{class:"appMain",styles:{width:"auto",height:"100%"}})),(f=new p({widget:g,readOnlyApp:!1,renderDiv:D,initApp:t&&t.initApp,onLandingPageReady:t&&t.onLandingPageReady})).initialize()}function L(){if(n&&(n.setSetting("activateWidgetLink",!0),n.setSetting("useNewUXGuidelinesWP",!0)),!b){A("_PIM_UWA widget loading","_PIM_widgetLoad",!0),I("_PIM_LoadJSPAD3DViewer");var o=new Promise((function(e){require(["DS/PADUtils/PADSharedSettings"],(t=>{t.addSharedSettings(g,["showWelcomePanel"]),N({initApp:!0,onLandingPageReady:function(){d(D),d=null}}).then(e)}))})),a=new Promise((function(e){require(["DS/ENOPAD3DViewer/PAD3DViewer","DS/CATWebUXPreferences/CATWebUXPreferencesManager","text!DS/PIMwebI3Dapp/assets/json/PIMwebI3DWindowOptions.json"],(function(t,n,i){A("_PIM_PAD3DViewer load JS","_PIM_LoadJSPAD3DViewer",!0),I("_PIM_PAD3DViewerReady"),m=n,e([t,i])}))})),r=new Promise((e=>{require(["DS/ENOXInterWdgCom/LinkManager"],(t=>{t.initializeWidgetLink(g,{appIds:[],uses:["ENXContent","ENXContentSync3D","ENXContentSync2D","ENXAuthoring2D","ENXAuthoring3D","ENXLandingPageSync"],implements:["ENXContent","ENXContentSync3D","ENXLandingPageSync"],open:!0}).then(e)}))}));Promise.all([o,a,r]).then((function(o){n=require("DS/PADUtils/PADSettingsMgt");var a=e.extend({context:"Default",workbench:v.file,workbenchModule:v.module},JSON.parse(o[1][1])),r={widget:g,windowOptions:a,enableFiltering:!0,binaryPrimitives:!0,enableSidePanel:!0,visuProgressiveTileModel:!0,readyCB:x};a.mouseProfile=require("DS/PADUtils/PADUtilsServices").isCloud()?window.__mouseProfile:"CATIA",b=new o[1][0](r),t.init(b),a.mouseProfile&&b.getViewpoint().setDefaultController(!0,a.mouseProfile),m.getPreferenceManager({context:b.getFrameWindow()}).removeAllPreferences(),f.setViewer(b),b.setOption("propertiesFacet",n.getSetting("propertiesFacet")),b.setAuthorizedRootTypes(n.getSetting("ups_authorized_root_types")),b.setDefaultContextualBarVisibility(!0),b.setDefaultContextualMenuVisibility(!0),b.setOpenWithMenuAvailability(!0),u=b.subscribe({event:"onViewerReady"},U),c=b.subscribe({event:"onActionBarReady"},E),l=b.subscribe({event:"onReady"},W),b.subscribe({event:"onRootAdded"},S),b.subscribe({event:"onRootRemoved"},S),b.subscribe({event:"onRootAttached"},S),b.subscribe({event:"onRootDetached"},S),b.subscribe({event:"onContentNameModified"},S),b.subscribe({event:"onBeginRootLoading"},(function(){var e=window.document.getElementsByClassName("DMULoadingPanelInfoDiv"),t=window.document.getElementsByClassName("DMULoadingPanel");e.length&&(e[0].dsModel.off(),e[0].dsModel.destroy(),e=null),t.length&&t[0].destroy()})),n.setSetting("settypes",!0),"1"===g.getValue("widgetForODTReplay")&&g.dispatchEvent("onPAD3DViewerCreated",[{pad3DViewer:b}]),i.done&&i.done({appMainDiv:D,pad3DViewer:b})}))}}function X(){!function(){var e=n.getSetting("enopad3dviewer_roles");let t=!0,i=require("DS/PADUtils/PADUtilsServices").isCloud(),o=require("DS/PADUtils/PADSession").isAuthoring();for(var a=0;a<e.length;a++)if("E19"===e[a].id&&(!e[a].platforms||e[a].platforms&&e[a].platforms.indexOf(require("DS/PADUtils/PADUtilsServices").getPlatformId())>-1)){t=!1;break}n.setSetting("enopad3dviewer_flexibleAssemblySupportActivated",t&&!i&&!o),n.setSetting("enopad3dviewer_staticMappingSupportActivated",!o)}(),b&&b.refresh()}function O(){f&&f.dispose(),f=null,s&&(w&&w.forEach(s.unsubscribe,s),s.dereference()),o=a=g=b=d=D=r=s=w=m=null,t.reset()}function R(e){b&&b.search({searchQuery:e})}b?g.addEvent("onDestroy",O):(A("_PIM_JS dependencies loading","PIM_jsAppLoad",!1),I("_PIM_widgetLoad"),i.viewerAttachment?(d=i.viewerAttachment,L()):(d=function(e){g.setBody(e)},g.addEvent("onLoad",L)),g.addEvent("onRefresh",X),g.addEvent("onDestroy",(function(){var e=b;O(),e&&e.destroy()})),g.addEvent("onSearch",R),g.setMetas({helpPath:"PIMwebI3Dapp/assets/help"}));var q=Object.freeze({setUp:function(e){Promise.all([r?Promise.resolve():new Promise((function(e){require(["DS/CATWebUXComponents/DMUCommandsManager"],(function(t){r=t,e()}))})),m?Promise.resolve():new Promise((function(e){require(["DS/CATWebUXPreferences/CATWebUXPreferencesManager"],(function(t){m=t,e()}))}))]).then((function(){g.addEvent("onRefresh",X),g.addEvent("onSearch",R),g.setMetas({helpPath:"PIMwebI3Dapp/assets/help"});var n={lastCommand:[],currentCommand:null,defaultCommand:null};P?r._commandsState[P]=n:r._commandsState=n,r.resetDefaultCommand(P),r._isCommandEnding=!1,r._ignoreCommandBeginWhileEndingCommand=!1,["_commands","_cmdCheckHeader"].forEach((function(e){var t=P?r[e][P]:r[e];Object.keys(t).forEach((function(e){var n=t[e];n&&n._destroy&&n._destroy(),delete t[e]}))})),e.sourceApp&&e.sourceApp.pad3DViewer!==b&&(s&&s.dereference(),s=null,b=e.sourceApp.pad3DViewer,t.init(b)),b.setOption("propertiesFacet",require("DS/PADUtils/PADSettingsMgt").getSetting("propertiesFacet")),b.getBIController().toggleBetweenStandaloneAndSlaveMode("DUAL"),x(b),S(),b.setDefaultContextualBarVisibility(!0),b.setDefaultContextualMenuVisibility(!0),b.setOpenWithMenuAvailability(!0),m.getPreferenceManager({context:b.getFrameWindow()}).removeAllPreferences();var i=new Promise((function(e){var t=b.subscribe({event:"onActionBarReady"},(function(){b.unsubscribe(t),r.setDefaultCommand({ID:"PIMwebDefaultHdr",className:"DS/PIMwebViewController/PIMwebDefaultCmd",context:P}),e()}));b.loadActionBar({merge:!1,file:v.file,module:v.module})}));require("DS/ENOXInterWdgCom/LinkManager").updateLinkability({appIds:[],open:!0,uses:["ENXContent","ENXContentSync3D","ENXContentSync2D","ENXAuthoring2D","ENXAuthoring3D","ENXLandingPageSync"],implements:["ENXContent","ENXContentSync3D","ENXLandingPageSync"]}),require("DS/PADUtils/PADSettingsMgt").setSetting("activateWidgetLink",!0),require("DS/PADUtils/PADSettingsMgt").setSetting("useNewUXGuidelinesWP",!0);var o=new Promise((function(e){s?e():require(["DS/PIMwebViewController/PIMwebItfCtrl"],(function(t){(s=t.giveItfCtrl({pad3DViewer:b}))||(g.deleteValue("ItfSimuInSession"),s=t.getItfCtrl({pad3DViewer:b})),e()}))})).then((function(){s.activate({readOnly:!1}),N().then((function(){f.setViewer(b),f.appReady(s)})),e.sourceApp&&e.sourceApp.issues&&e.sourceApp.issues.length>0&&s.appInitFromTransition({issues:e.sourceApp.issues,onNoActionDone:function(){}})}));Promise.all([i,o]).then((function(){e.done({appMainDiv:D,pad3DViewer:b})}))}))},dispose:function(e){if(g.removeEvent("onRefresh",X),g.removeEvent("onSearch",R),g.removeEvent("endEdit",y),V(),f&&f.dispose(),f=null,b&&b.setOpenWithMenuAvailability(!1),s&&s.deactivate(),e){var t=g.getValue("ItfSimuInSession");if((t=t?JSON.parse(t):null)&&!Array.isArray(t)&&"object"==typeof t)1===Object.keys(t).length&&(e.preferredType="SIMItfSimulation")}var n=m.givePreferenceManager({context:b.getFrameWindow()});n&&n.removeAllPreferences(),m.unreferencePreferenceManager({context:b.getFrameWindow()})},onWillLeave:function(){}});return"I3D"===i.data?o=q:a=q,q}})})),define("DS/PIMwebI3Dapp/PIMI3AppMain",["UWA/Core","DS/CATWebUXComponents/DMUFrameWindow","DS/PADUtils/PADSettingsMgt"],(function(e,t,n){"use strict";var i,o;let a,r=null,s=null;var d,l,p,u,c,f,m,w,g,b=[],D=u?u.getCommandContext():null,P={};function h(e,t,n){window.top.performance.measure(p.id+e,n?p.id+t:t)}function v(e){window.top.performance.mark(p.id+e)}function A(){u&&u.getContentName({callbacks:{onComplete:function(e){p.setTitle(e.contentName)},onFailure:function(){}}})}function I(e){l&&d&&(u.getLandingPageComponent().appReady&&u.getLandingPageComponent().appReady(l,((e,t)=>{e.addRootNodesFromContent({json3DXContent:t,dispatch:!1})})),h("_PIM_Global widget creation time","PIM_jsAppLoad",!1),p.dispatchEvent("onWidgetAndAppReady","1"===p.getValue("widgetForODTReplay")?[{pad3DViewer:e}]:void 0))}var S,C=function(){require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/PADUtils/PADCommandProxy"],(function(e,t){(S=e).renderDiv||S.initialize2(u.getFrameWindow().getViewerFrame(),t.appId(),p.getValue("changeControlActivation")?"show":"hide","top-right",(function(){S.addEvent("onAuthoringCtxVisible",(function(e){e.showAuthoringContext&&p.setValue("changeControlActivation",!0)}))}))}))};function M(e){e.unsubscribe(f),f=null,A(),C(),require("DS/PADUtils/PADUtilsServices").isCloud()&&!window.__preventPrefPanel&&e.getViewer().displayIntroductoryControlPreferencePanel(),v("_PIM_beforeAppComponentLoad"),require(["DS/PIMwebViewController/PIMwebItfCtrl"],(function(t){h("_PIM_AppComponentLoading","_PIM_beforeAppComponentLoad",!0),(l=t.getItfCtrl({pad3DViewer:e})).activate({readOnly:!1}),I(e)}))}function y(e){e.unsubscribe(m),m=null,v("_PIM_ownCommands"),h("_PIM_Action Bar merge app commands","_PIM_ownCommands",!0),v("_PIM_beforeDefaultCmdLoad"),D=u.getCommandContext(),(d=require("DS/CATWebUXComponents/DMUCommandsManager")).refreshCommandsManager(r.getExecutionContext()),s||d.setDefaultCommand({ID:"PIMwebDefaultHdr",className:"DS/PIMwebViewController/PIMwebDefaultCmd",context:D});let t=d.getCommand("PIMwebEditItfHdr",D),n=d.getCommand("PIMWebUXGenerateIssueHdr",D),i=d.getCommand("PIMWebUXGenerateIssueTemplateHdr",D),o=d.getCommand("PIMWebUXGenerateTaskHdr",D),a=d.getCommand("PIMWebUXGenerateCAHdr",D),p="Create";t.options&&t.options.arguments&&t.options.arguments[0]&&t.options.arguments[0].type&&(p=t.options.arguments[0].type),require(["DS/PIMwebViewController/PIMwebItfCtrl"],(function(e){(l=e.giveItfCtrl({pad3DViewer:u}))||(l=e.getItfCtrl({pad3DViewer:u})),"Edit"===p&&t.disable(),n.disable(),i.disable(),o.disable(),a.disable(),b.push(l.subscribe("onIsrAdded",(function(){t.enable(),n.enable(),i.enable(),o.enable(),a.enable()}))),b.push(l.subscribe("onItfAdded",(function(){t.enable(),n.enable(),i.enable(),o.enable(),a.enable()}))),b.push(l.subscribe("onIsrRemoved",(async function(){await t.disable(),await n.disable(),await i.disable(),await o.disable(),await a.disable()}))),(l.getLoadedIsr().length||l.isPIMDataLoaded())&&(t.enable(),n.enable(),i.enable(),o.enable(),a.enable());let r=d.getCommand("PIMwebUpdateItfHdr",D);r&&(r.options&&r.options.arguments&&r.options.arguments[0]&&r.options.arguments[0].type&&(p=r.options.arguments[0].type),"Update"===p&&(r.disable(),b.push(l.subscribe("onIsrAdded",(function(){r.enable()}))),b.push(l.subscribe("onItfAdded",(function(){r.enable()}))),b.push(l.subscribe("onIsrRemoved",(function(){r.disable()}))),(l.getLoadedIsr().length||l.isPIMDataLoaded())&&r.enable()))})),h("_PIM_Default Cmd Init","_PIM_beforeDefaultCmdLoad",!0),I(e)}function V(){if(n&&n.setSetting("useNewUXGuidelinesWP",!0),!u){h("_PIM_UWA widget loading","_PIM_widgetLoad",!0),v("_PIM_LoadJSPAD3DViewer");var i=new Promise((function(e){require(["DS/CATWebUXPreferences/CATWebUXPreferencesManager","text!DS/PIMwebI3Dapp/assets/json/PIMwebI3DWindowOptions.json"],(function(t,n){h("_PIM_PAD3DViewer load JS","_PIM_LoadJSPAD3DViewer",!0),v("_PIM_PAD3DViewerReady"),w=t,e([n])}))}));Promise.all([i]).then((function(i){n=require("DS/PADUtils/PADSettingsMgt");var o=e.extend({context:"Default",workbench:g.file,workbenchModule:g.module},JSON.parse(i[0][0]));require("DS/PADUtils/PADUtilsServices").isCloud()?(n.setSetting("mouseProfile",window.__mouseProfile),o.mouseProfile=window.__mouseProfile):(n.setSetting("mouseProfile","CATIA"),o.mouseProfile="CATIA"),u=r,t.init(u,{executionContext:s}),require(["DS/CATWebUXComponents/DMUCommandsManager"],(function(e){(d=e).dmuSetExecutionContext(r.getExecutionContext()),d.dmuSetHandlerComponent(r.getExecutionContext()),o.mouseProfile&&u.getViewpoint().setDefaultController(!0,o.mouseProfile),w.getPreferenceManager({context:u.getFrameWindow()}).removeAllPreferences(),u.setOption("propertiesFacet",n.getSetting("propertiesFacet")),u.setAuthorizedRootTypes(n.getSetting("ups_authorized_root_types")),u.setDefaultContextualBarVisibility(!0),u.setDefaultContextualMenuVisibility(!0),u.setOpenWithMenuAvailability(!0),s&&y(u),u.subscribe({event:"onRootAdded"},A),u.subscribe({event:"onRootRemoved"},A),u.subscribe({event:"onRootAttached"},A),u.subscribe({event:"onRootDetached"},A),u.subscribe({event:"onContentNameModified"},A),n.setSetting("settypes",!0),"1"===p.getValue("widgetForODTReplay")&&p.dispatchEvent("onPAD3DViewerCreated",[{pad3DViewer:u}]),a.done&&a.done({appMainDiv:c,pad3DViewer:u}),M(u)}))}))}}function _(){!function(){var e=n.getSetting("enopad3dviewer_roles");let t=!0,i=require("DS/PADUtils/PADUtilsServices").isCloud(),o=require("DS/PADUtils/PADSession").isAuthoring();for(var a=0;a<e.length;a++)if("E19"===e[a].id&&(!e[a].platforms||e[a].platforms&&e[a].platforms.indexOf(require("DS/PADUtils/PADUtilsServices").getPlatformId())>-1)){t=!1;break}n.setSetting("enopad3dviewer_flexibleAssemblySupportActivated",t&&!i&&!o),n.setSetting("enopad3dviewer_staticMappingSupportActivated",!o)}(),u&&u.refresh()}function x(){l&&(b&&b.forEach(l.unsubscribe,l),l.dereference()),i=o=p=u=c=d=l=w=null,b=[]}function U(){var e=u;x(),e&&e.destroy()}function E(e){u&&u.search({searchQuery:e})}return class{constructor(n){if(!n||!n.data)throw new Error("App identification is missing! Unable to init app");if("I3D"!==n.data&&"I3S"!==n.data)throw new Error("Invalid app id: "+n.data);return"I3D"===n.data&&i?i:"I3S"===n.data&&o?o:(a=n,p=n.widget,r=n.viewer,s=n.executionContext,c=n.appMainDiv,g={module:"PIMweb"+n.data+"app",file:"PIMweb"+n.data+"appWkb.xml"},""!==window.location.search&&(e.extend(P,e.Utils.parseQuery(window.location.search)),P.widgetDomain&&e.extend(P,e.Utils.parseQuery(P.widgetDomain))),"testWkb"in P&&(g={module:"PIMwebI3Dtst",file:"PIMwebI3DappTestWkb.xml"}),"I3S"===n.data&&require(["DS/PIMwebViewModel/PIMwebIsrMgr"].concat([]),(function(e){e.isUpdateSimulationAllowed().then((function(e){e&&s.switchApp(s.getSourceApp().getId(),"ENOI3S_AP_Cloud").then((()=>{h("_PIM_JS dependencies loading","PIM_jsAppLoad",!1),v("_PIM_widgetLoad"),p.addEvent("onLoad",V),p.addEvent("onRefresh",_),p.addEvent("onDestroy",U),p.addEvent("onSearch",E),p.setMetas({helpPath:"PIMwebI3Dapp/assets/help"}),y(u),M(u)}))}))})),u?(t.init(u,{executionContext:s}),p.addEvent("onDestroy",x)):(h("_PIM_JS dependencies loading","PIM_jsAppLoad",!1),v("_PIM_widgetLoad"),n.viewerAttachment?V():(p.viewerAttachment=function(e){e&&p.widget.setBody(e)},p.addEvent("onLoad",V)),p.addEvent("onRefresh",_),p.addEvent("onDestroy",U),p.addEvent("onSearch",E),p.setMetas({helpPath:"PIMwebI3Dapp/assets/help"})),this.setUp=function(e){n=e,Promise.all([d?Promise.resolve():new Promise((function(e){require(["DS/CATWebUXComponents/DMUCommandsManager"],(function(t){d=t,e()}))})),w?Promise.resolve():new Promise((function(e){require(["DS/CATWebUXPreferences/CATWebUXPreferencesManager"],(function(t){w=t,e()}))}))]).then((async function(){d.refreshCommandsManager(r.getExecutionContext()),p.addEvent("onRefresh",_),p.addEvent("onSearch",E),p.setMetas({helpPath:"PIMwebI3Dapp/assets/help"}),n.sourceApp&&n.sourceApp.pad3DViewer!==u&&(l&&l.dereference(),l=null,u=n.sourceApp.pad3DViewer,t.init(u,{executionContext:s})),u.setOption("propertiesFacet",require("DS/PADUtils/PADSettingsMgt").getSetting("propertiesFacet")),u.getBIController().toggleBetweenStandaloneAndSlaveMode("DUAL"),A(),u.setDefaultContextualBarVisibility(!0),u.setDefaultContextualMenuVisibility(!0),u.setOpenWithMenuAvailability(!0),w.getPreferenceManager({context:u.getFrameWindow()}).removeAllPreferences(),require("DS/ENOXInterWdgCom/LinkManager").updateLinkability({appIds:[],open:!0,uses:["ENXContent","ENXContentSync3D","ENXContentSync2D","ENXAuthoring2D","ENXAuthoring3D","ENXLandingPageSync"],implements:["ENXContent","ENXContentSync3D","ENXLandingPageSync"]}),require("DS/PADUtils/PADSettingsMgt").setSetting("activateWidgetLink",!0),require("DS/PADUtils/PADSettingsMgt").setSetting("useNewUXGuidelinesWP",!0),await new Promise((function(e){l?e():require(["DS/PIMwebViewController/PIMwebItfCtrl"],(function(t){(l=t.giveItfCtrl({pad3DViewer:u}))||(p.deleteValue("ItfSimuInSession"),l=t.getItfCtrl({pad3DViewer:u})),e()}))})).then((function(){l.activate({readOnly:!1});let e=u.getLandingPageComponent();e.setViewer(u),e.appReady(),n.sourceApp&&n.sourceApp.issues&&n.sourceApp.issues.length>0&&l.appInitFromTransition({issues:n.sourceApp.issues,onNoActionDone:function(){}}),n.done({appMainDiv:c,pad3DViewer:u})}))}))},this.dispose=function(e){if(p.removeEvent("onRefresh",_),p.removeEvent("onSearch",E),p.removeEvent("endEdit",undefined),u&&u.setOpenWithMenuAvailability(!1),l&&l.deactivate(),e){var n=p.getValue("ItfSimuInSession");if((n=n?JSON.parse(n):null)&&!Array.isArray(n)&&"object"==typeof n)1===Object.keys(n).length&&(e.preferredType="SIMItfSimulation")}var i=w.givePreferenceManager({context:u.getFrameWindow()});i&&i.removeAllPreferences(),w.unreferencePreferenceManager({context:u.getFrameWindow()});let o=u&&u.getExecutionContext&&u.getExecutionContext()&&u.getExecutionContext().getTargetApp?u.getExecutionContext().getTargetApp():void 0;t.reset(o&&"ENX3DIR_AP"===o.getAfrAppId()?u:void 0)},void(this.onWillLeave=function(){}))}}})),define("DS/PIMwebI3Dapp/PIMI3AppInit",["DS/WAfrContainer/App","UWA/Core","DS/Controls/Loader","i18n!DS/PIMwebI3Dapp/assets/nls/PIMwebI3Dapp"],(function(e,t,n,i){"use strict";var o,a,r={I3D:null,I3S:null};return e.extend({setUp:function(e){if(e.sourceApp&&this.options.id===e.sourceApp.options.id)return e.sourceApp.pad3DViewer&&(this.pad3DViewer=e.sourceApp.pad3DViewer),e.sourceApp.appMainDiv&&(this.appMainDiv=e.sourceApp.appMainDiv),Promise.resolve();var s=this;let d="ENOI3D_AP"===this.options.id?"I3D":"I3S";if(window.widget.getValue("X3DContentId")&&!e.sourceApp){var l="",p=JSON.parse(window.widget.getValue("X3DContentId"));p.data&&p.data.items&&p.data.items[0]&&p.data.items[0].displayName&&(l=p.data.items[0].displayName);var u=t.createElement("div",{class:"DMULoadingPanel"}).inject(document.body);(a=new n({text:i.loadingMessage+" "+l}).inject(u)).on(),a.getContent().addClassName("DMULoadingPanelInfoDiv");var c=a.elements.label.getSize().width,f=a.elements.progressBar.getContent().getSize().width,m=a.elements.progressBar.getContent().getSize().height,w=c+f;u.setStyles({position:"absolute",bottom:"0",left:"0","z-index":"40000","background-color":"rgba(255,255,255,1",height:"100%",width:"100%"}),a.getContent().setStyles({position:"absolute",left:"calc(50% - "+w/2+"px)",top:"calc(50% - "+m/2+"px)"})}return e.sourceApp?e.sourceApp.pad3DViewer?(this.pad3DViewer=e.sourceApp.pad3DViewer,this.appMainDiv=e.sourceApp.appMainDiv,void new Promise((function(t){r[d]?(e.done&&e.done(),t(r[d])):require(["DS/PIMwebI3Dapp/PIMI3AppMain"],(function(n){r[d]=new n({widget:window.widget,pad3DViewer:e.sourceApp.pad3DViewer,appMainDiv:e.sourceApp.appMainDiv,viewer:s.getExecutionContext().getComponent("Viewer"),executionContext:s.getExecutionContext(),data:d}),e.done&&e.done(),t(r[d])}))})).then((function(t){e.sourceApp&&!e.sourceApp.isDisposeCalled()&&e.sourceApp.dispose(e);var n=e.done;e.done=function(){var t;e.done=n,"ENX3DIR_AP"===e.sourceApp.options.id&&((t=s).switchApp&&require(["DS/CATWebUXComponents/CATWebUXInfoFlag","DS/CATWebUXSlideShow/CATWebUXSlideShowController","i18n!DS/PIMwebI3Dapp/assets/nls/PIMwebI3Dapp","DS/Utilities/TouchUtils"],(function(e,n,i,a){var r=new e({frameWindow:t.pad3DViewer.getFrameWindow(),viewer:t.pad3DViewer.getViewer(),dockingSide:"left"});r.display({label:i.backToIssue,style:"webUXStyle",fontIcon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-move-to-start",onClickCB:function(){o(),o=null,t.pad3DViewer.getExecutionContext().switchApp("ENX3DIR_AP")},compactDisplay:function(e){var t=document.querySelector(".pimWebOpacitySlider");if(t&&!t.isHidden())return e.flagOffset+e.flagWidth>.5*(e.freeZoneWidth-(a.getTouchMode()?470:398))}});var s,d=n.getSlideShowController({context:t.pad3DViewer.getFrameWindow(),id:"PIMwebSlideShow",params:{activateRotation:!0}});d&&(s=d.subscribe("onActiveStateModified",(function(e){r.setVisibleFlag(!e.state)}))),o=function(){r.clean();var e=n.giveSlideShowController({context:t.pad3DViewer.getFrameWindow(),id:"PIMwebSlideShow"});e&&e.unsubscribe(s)}}))),e.done()},t.setUp(e)}))):(window.console.log("pad3DViewer property must be valuated"),void e.done()):new Promise((t=>{require(["DS/PIMwebI3Dapp/PIMI3AppMain"],(function(t){r[d]=new t({widget:window.widget,viewer:s.getExecutionContext().getComponent("Viewer"),executionContext:s.getExecutionContext(),viewerAttachment:e.done,data:d,done:function(e){s.pad3DViewer=e.pad3DViewer,s.appMainDiv=e.appMainDiv}})})),e.done&&e.done(),t()}))},dispose:function(e,t){o&&o(),o=null;let n=t||(this.options.id&&this.options.id.includes("I3D")?"I3D":"I3S");r[n].dispose(e),a&&(a.destroy(),a=null);var i=window.document.getElementsByClassName("DMULoadingPanel");i.length&&i[0].destroy(),this._parent(e)},onWillEnter:function(e){return require(["DS/PIMwebViewModel/PIMwebUtils","DS/PADUtils/PADSettingsMgt"],(function(t,n){n.setSetting("enopad3dviewer_staticMappingSupportActivated",!0),t._sendUsageProbe("appTransitionFrom",e.options.id,"resolved")})),this._parent(e)},onWillLeave:function(e,t){return r[t]&&r[t].onWillLeave&&r[t].onWillLeave(e),require(["DS/PIMwebViewModel/PIMwebUtils"],(function(t){t._sendUsageProbe("appTransitionTo",e.options.id,"resolved")})),this._parent(e)}})})),define("DS/PIMwebI3Dapp/PIMwebI3DappInitAdapt",["DS/WAfrContainer/App","UWA/Core","DS/Controls/Loader","i18n!DS/PIMwebI3Dapp/assets/nls/PIMwebI3Dapp"],(function(e,t,n,i){"use strict";var o,a,r={I3D:null,I3S:null};return e.extend({setUp:function(e,s){var d=this;if(window.widget.getValue("X3DContentId")){var l="",p=JSON.parse(window.widget.getValue("X3DContentId"));p.data&&p.data.items&&p.data.items[0]&&p.data.items[0].displayName&&(l=p.data.items[0].displayName);var u=t.createElement("div",{class:"DMULoadingPanel"}).inject(document.body);(a=new n({text:i.loadingMessage+" "+l}).inject(u)).on(),a.getContent().addClassName("DMULoadingPanelInfoDiv");var c=a.elements.label.getSize().width,f=a.elements.progressBar.getContent().getSize().width,m=a.elements.progressBar.getContent().getSize().height,w=c+f;u.setStyles({position:"absolute",bottom:"0",left:"0","z-index":"40000","background-color":"rgba(255,255,255,1",height:"100%",width:"100%"}),a.getContent().setStyles({position:"absolute",left:"calc(50% - "+w/2+"px)",top:"calc(50% - "+m/2+"px)"})}if(e.sourceApp){if(!e.sourceApp.pad3DViewer)return window.console.log("pad3DViewer property must be valuated"),void e.done();this.pad3DViewer=e.sourceApp.pad3DViewer,this.appMainDiv=e.sourceApp.appMainDiv,new Promise((function(t){r[s]?t(r[s]):require(["DS/PIMwebI3Dapp/PIMwebAppMain"],(function(n){r[s]=n.getApp({widget:window.widget,pad3DViewer:e.sourceApp.pad3DViewer,appMainDiv:e.sourceApp.appMainDiv,data:s}),t(r[s])}))})).then((function(t){e.sourceApp&&!e.sourceApp.isDisposeCalled()&&e.sourceApp.dispose(e);var n=e.done;e.done=function(t){var i;d.appMainDiv||(d.appMainDiv=t.appMainDiv),e.done=n,"ENX3DIR_AP"===e.sourceApp.options.id&&((i=d).switchApp&&require(["DS/CATWebUXComponents/CATWebUXInfoFlag","DS/CATWebUXSlideShow/CATWebUXSlideShowController","i18n!DS/PIMwebI3Dapp/assets/nls/PIMwebI3Dapp","DS/Utilities/TouchUtils"],(function(e,t,n,a){var r=new e({frameWindow:i.pad3DViewer.getFrameWindow(),viewer:i.pad3DViewer.getViewer(),dockingSide:"left"});r.display({label:n.backToIssue,style:"webUXStyle",fontIcon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-move-to-start",onClickCB:function(){o(),o=null,i.switchApp("ENX3DIR_AP")},compactDisplay:function(e){var t=document.querySelector(".pimWebOpacitySlider");if(t&&!t.isHidden())return e.flagOffset+e.flagWidth>.5*(e.freeZoneWidth-(a.getTouchMode()?470:398))}});var s,d=t.getSlideShowController({context:i.pad3DViewer.getFrameWindow(),id:"PIMwebSlideShow",params:{activateRotation:!0}});d&&(s=d.subscribe("onActiveStateModified",(function(e){r.setVisibleFlag(!e.state)}))),o=function(){r.clean();var e=t.giveSlideShowController({context:i.pad3DViewer.getFrameWindow(),id:"PIMwebSlideShow"});e&&e.unsubscribe(s)}}))),e.done()},t.setUp(e)}))}else require(["DS/PIMwebI3Dapp/PIMwebAppMain"],(function(t){r[s]=t.getApp({widget:window.widget,viewerAttachment:e.done,data:s,done:function(e){d.pad3DViewer=e.pad3DViewer,d.appMainDiv=e.appMainDiv}})}))},dispose:function(e,t){o&&o(),o=null,r[t].dispose(e),a&&(a.destroy(),a=null);var n=window.document.getElementsByClassName("DMULoadingPanel");n.length&&n[0].destroy(),this._parent(e)},onWillEnter:function(e){return require(["DS/PIMwebViewModel/PIMwebUtils","DS/PADUtils/PADSettingsMgt"],(function(t,n){n.setSetting("enopad3dviewer_staticMappingSupportActivated",!0),t._sendUsageProbe("appTransitionFrom",e.options.id,"resolved")})),this._parent(e)},onWillLeave:function(e,t){return r[t]&&r[t].onWillLeave&&r[t].onWillLeave(e),require(["DS/PIMwebViewModel/PIMwebUtils"],(function(t){t._sendUsageProbe("appTransitionTo",e.options.id,"resolved")})),this._parent(e)}})})),define("DS/PIMwebI3Dapp/PIMwebI3DappInit",["DS/PIMwebI3Dapp/PIMwebI3DappInitAdapt"],(function(e){"use strict";return e.extend({setUp:function(e){this._parent(e,"I3D")},dispose:function(e){this._parent(e,"I3D")},onWillEnter:function(e){return this._parent(e,"I3D")},onWillLeave:function(e){return this._parent(e,"I3D")}})}));