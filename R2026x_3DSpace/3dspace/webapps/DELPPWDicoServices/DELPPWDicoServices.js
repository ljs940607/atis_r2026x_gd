define("DS/DELPPWDicoServices/ModelConfigExt",["UWA/Core","DS/DELPPWLoggerModel/LoggerUtils","DS/DELPPWWebServices/WebserviceUtils"],(function(e,t,i){"use strict";return{_pprTypes:[],_validChildTypesMap:{},_relationsList:{},_customRelationsList:{},retrievePPRTypes:function(e,t){var n=this;i.webServiceRequest({url:"dsmfg/private/V0/invoke/getPPRTypes",method:"GET",onComplete:function(t){n._pprTypes=t,e()},onFailure:function(e){n._pprTypes=[],t(e)},onTimeout:function(e){n._pprTypes=[],t(e)}})},retrieveValidChildTypes:function(e,t){var n=this,s=widget.getBool("oneDelmiaAggregationMode");i.webServiceRequest({url:"dsmfg/private/V0/invoke/getChildTypes",method:"GET",data:{oneDelmiaAggregationMode:s},onComplete:function(t){n._validChildTypesMap=t,e()},onFailure:function(e){n._validChildTypesMap=[],t(e)},onTimeout:function(e){n._validChildTypesMap=[],t(e)}})},retrieveModelRelations:function(e,t){var n=this;i.getXMLValues(n.options.modelRelationsXML,(function(t){n._relationsList=t.RelationsList,e()}),(function(e){t(e)}))},retrieveModelCustomRelations:function(t,n){var s=this;i.getXMLValues(s.options.modelCustomRelationsXML,(function(i){var n,o,r,a,u,c={},f={},p=[],l=0;if(e.is(i.CustomRelationsList.RelationConfig)){for(a=i.CustomRelationsList.RelationConfig,a=Array.isArray(a)?a:[a],n=0;n<a.length;n++){if(o=a[n].fromType,r=a[n].toType,u=a[n].Relation,p=[],e.is(f[o])||(f[o]={}),f[o][r]=!1,e.is(u))for(u=Array.isArray(u)?u:[u],l=0;l<u.length;l++)"Instance"===u[l].type?f[o][r]=!0===e.Json.decode(u[l].write):p.push(u[l]);e.is(c[o])||(c[o]={}),c[o][r]={Relation:p}}s._customRelationsList=c,s._processCustomInstanceConfig(f)}t()}),(function(e){n(e)}))},getPPRType:function(i){if(e.is(i))return this._pprTypes[i];t.debug(this.name,"type is undefined")},_processCustomInstanceConfig:function(t){var i,n,s,o,r,a;if(e.is(t))for(i in t)if(Object.prototype.hasOwnProperty.call(t,i))for(n in t[i])Object.prototype.hasOwnProperty.call(t[i],n)&&(s=t[i][n],r=this._validChildTypesMap,a=this._validChildTypesMap[i],e.is(a)?(o=a.indexOf(n))>=0?s||a.splice(o,1):s&&a.push(n):s&&(r[i]=[n]))},getValidChildTypes:function(i){if(e.is(i))return this._validChildTypesMap[i]||[];t.debug(this.name,"parentType is undefined")},_filterConfiguredRelationsByMode:function(t,i){var n,s=[],o=[],r=null;if(e.is(t)&&e.is(t.Relation))for(e.is(t.Relation.length)||(o.push(t.Relation),t.Relation=o),r=0;r<t.Relation.length;r++)n=t.Relation[r],e.is(n[i])&&!0===e.Json.decode(n[i])&&s.push(n.type);return s},getConfiguredRelations:function(t,i,n){var s,o=[];return e.is(t,"string")&&(s=this._relationsList[t],e.is(s)&&e.is(i,"string")&&e.is(s[i])&&(o=this._filterConfiguredRelationsByMode(s[i],n))),o},getAllConfiguredRelations:function(t,i){var n,s,o,r=t?this._relationsList[t]:[],a=[];if(t&&e.is(r,"object"))for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(o=this._filterConfiguredRelationsByMode(r[s],i),a.push.apply(a,o));for(n in this._relationsList)n!==t&&(r=this._relationsList[n],e.is(r,"object")&&Object.prototype.hasOwnProperty.call(r,t)&&(o=this._filterConfiguredRelationsByMode(r[t],i),a.push.apply(a,o)));return a},getConfiguredCustomRelations:function(i,n,s){var o,r=this._customRelationsList;if(e.is(i)&&e.is(n))return e.is(r)&&e.is(r[i])&&e.is(r[i][n])&&(o=this._filterConfiguredRelationsByMode(r[i][n],s)),o;t.debug(this.name,"fromType or toType is undefined")},getPossibleRelations:function(t,i,n){var s;return s=this.getConfiguredCustomRelations(t,i,n),e.is(s)||(s=this.getConfiguredRelations(this.getPPRType(t),this.getPPRType(i),n)),s}}})),define("DS/DELPPWDicoServices/AttributeConfigExt",["UWA/Core","DS/DELPPWLoggerModel/LoggerUtils","DS/DELPPWWebServices/WebserviceUtils","DS/DELPPWResourceServices/ResourceUtils","text!DS/DELPPWDicoServices/assets/json/PLMAttrInfos.json","text!DS/DELPPWDicoServices/assets/json/ProtectedAttributes.json"],(function(e,t,i,n,s,o){"use strict";return s=e.Json.decode(s),o=e.Json.decode(o),{_attributeInfo:{},_typeMaskInfo:{},_typeExtnInfo:{},_customAttribute:{},_custoServiceProcessRoles:{},retrieveDicoAttributeInfo:function(o,r){var a=this,u=[],c=function(e,t){i.webServiceRequest({url:"dsmfg/private/V0/invoke/WorkInstruction/getSignOffRoles",method:"GET",onComplete:e,onFailure:t,onTimeout:t})};u=[new Promise((function(t,n){var s;s=function(s){let o=new Promise((function(t,n){!function(t,n,s){var o=[];t.forEach((function(e){var t;e.info.forEach((function(e){"Double"===e.Type&&"Yes"===e.HasRangeDefined&&""!==e.ManipulationUnit&&(t=e.AuthorizedValues.map((function(e){return e.NLS})),o.push({unit:e.ManipulationUnit,values:t}))}))})),o.length>0?i.webServiceRequest({url:"dsmfg/private/V0/invoke/convertMKStoUnit",method:"POST",onComplete:n,onFailure:s,onTimeout:s,data:e.Json.encode(o)}):n()}(s,t,n)})),r=new Promise((function(e,t){!function(e,t,n){var s={};Array.isArray(e)&&e.forEach((function(e){var t=[];e.info.forEach((function(e){"Double"===e.Type&&""!==e.Magnitude&&t.push(e.Name)})),t.length>0&&(s[e.type]=t)})),Object.keys(s).length>0?i.webServiceRequest({url:"dsmfg/private/V0/invoke/getAttributeCustoProperties",method:"POST",onComplete:t,onFailure:n,onTimeout:n,data:JSON.stringify(s)}):t({})}(s,e,t)})),a=[o,r];Promise.all(a).then((function(i){let n=i[0],o=i[1];e.is(n)&&s.forEach((function(e){e.info.forEach((function(e){if("Double"===e.Type&&"Yes"===e.HasRangeDefined&&""!==e.ManipulationUnit){let t=n.shift();e.AuthorizedValues.forEach((function(e){e.NLS=t.shift()}))}}))})),e.is(o)&&s.forEach((function(t){var i=t.type;if(e.is(o[i])){let n=o[i];t.info.forEach((function(t){if(e.is(n[t.Name])){let i=n[t.Name];e.is(i["IPML.DisplayAsEntered"])&&(t["IPML.DisplayAsEntered"]=i["IPML.DisplayAsEntered"]),e.is(i.ManipulationUnit)&&""!==i.ManipulationUnit&&(t.ManipulationUnit=i.ManipulationUnit)}}))}})),t(s)}),n)},i.webServiceRequest({url:"dictionary/properties",method:"POST",onComplete:s,onFailure:n,onTimeout:n,data:JSON.stringify(a._modelAttrsJSON)})})),new Promise((function(e,t){i.fireGETWSInChunkIfTooBig({url:"dsmfg/private/V0/invoke/getAttributesMaskInfo",onComplete:e,onFailure:t,onTimeout:t,data:a._modelAttrsJSON})})),new Promise((function(e,t){i.webServiceRequest({url:"delmia/param/configuration/getParameters?domainID=DigitalManufacturing&familyID=CustomAttrLayoutView&paramID=CustomAttrLayoutTreeListView&argID=CustomAttrLayoutTreeListViewArg",method:"GET",onComplete:function(t){let i,s,o=n.getCountryCodesForLanguage(widget.lang),r=[];a._customAttribute=t,a._customAttribute.forEach((e=>{for(i in s=void 0,e)if(o.includes(i)){s=String(e[i]);break}let t=e.attributeName.split("."),a=t.length>1?t[1]:t[0];r["Attribute."+a+"."+e.attributeValue]=s||String(e.attributeValue),n.addNlsJSON(r,!0)})),e()},onFailure:t,onTimeout:t})}))],a._modelAttrsJSON.some((function(e){return"DELWkiSignOffReference"===e.type&&e.attributes.indexOf("V_WISignOff_Actors")>-1&&(u.push(new Promise(c)),!0)})),Promise.all(u).then((function(i){var r,c={},f={},p="DELRME_AP"===widget.getValue("appId")||"DELRMEC_AP"===widget.getValue("appId");function l(t,i,s){Array.isArray(i)&&i.length>0&&i.forEach((i=>{if(e.is(t[i])){t[i].AuthorizedValues||(t[i].AuthorizedValues=[],t[i].HasRangeDefined="Yes");let e=i.split(".")[1];t[i].AuthorizedValues.push({Name:s,NLS:n.getNLSValue("Attribute."+e+"."+s)})}}))}if(e.is(i,"array")&&i.length===u.length&&(r=i[0].map((function(t){var s,o={};return s={},i[1].filter((e=>e.type===t.type))[0].info.forEach((e=>s[e.Name]=e)),o.type=t.type,o.info=t.info.map((t=>{var i=t.Name;return e.is(s[i])?e.extend(s[i],t,!0):t})),o.info.forEach((function(t){var s,r;switch(e.is(i[2],"array")&&"DELWkiSignOffReference"===o.type&&"V_WISignOff_Actors"===t.Name&&(t.AuthorizedValues=[],t.HasRangeDefined="Yes",i[2].forEach((function(e){t.AuthorizedValues.push({NLS:e,Name:e})}))),t.Name){case"V_SequencingMode":t.NLS=n.getNLSValue("Attribute.DELLmiPPRSystemReference.V_SequencingMode");break;case"V_CapableRscGroupIndex":t.NLS=n.getNLSValue("Attribute.DELAsmProcessCanUseCnx.V_CapableRscGroupIndex");break;case"V_ContQuantity":t.NLS=n.getNLSValue("Attribute.Dimension.V_ContQuantity"),t.pattern="^([0-9]+.|)[0-9]+$";break;case"V_UseCase":p&&(t.NLS=n.getNLSValue("Attribute.DELFmiUseCaseExt.V_UseCase"));break;case"IsCompensation":t.NLS=n.getNLSValue("Attribute.Dimension.IsCompensation");break;case"V_ScrapQuantityRatio":t.NLS=n.getNLSValue("Attribute.DELLmiScrapQuantity_Ratio.V_ScrapQuantityRatio");break;case"V_WIPQuantityRatio":t.NLS=n.getNLSValue("Attribute.DELLmiWIPQuantity_Ratio.V_WIPQuantityRatio");break;case"V_IncrementQuantity":t.NLS=n.getNLSValue("Attribute.DELMBOMLotQuantityMgtMass.V_IncrementQuantity");break;case"V_MaxLotQuantity":t.NLS=n.getNLSValue("Attribute.DELMBOMLotQuantityMgtMass.V_MaxLotQuantity");break;case"V_MinLotQuantity":t.NLS=n.getNLSValue("Attribute.DELMBOMLotQuantityMgtMass.V_MinLotQuantity");break;case"V_YieldQuantity":t.NLS=n.getNLSValue("Attribute.DELFmiYieldQuantity_Ratio.V_YieldQuantity");break;case"V_LowerTolerance":t.NLS=n.getNLSValue("Attribute.DELFmiLimitQuantity_Mass.V_LowerTolerance");break;case"V_UpperTolerance":t.NLS=n.getNLSValue("Attribute.DELFmiLimitQuantity_Mass.V_UpperTolerance");break;case"V_DistributionRule":t.NLS=n.getNLSValue("Attribute.DELLmiHeaderOperationInstance.V_DistributionRule");break;case"V_TransferQuantity":t.NLS=n.getNLSValue("Attribute.DELLmiTimeConstraintQuantityDistribution.V_TransferQuantity");break;case"V_Priority":t.NLS=n.getNLSValue("Attribute.DELLmiTimeConstraintQuantityDistribution.V_Priority")}"DELLmiTimeConstraintCnx"===o.type?("V_MaterialNeed"===t.Name&&(t.NLS=n.getNLSValue("Attribute.DELLmiTimeConstraintCnx.V_MaterialNeed")),"V_DependencyType"===t.Name&&(s=["StartToFinish","PreviousCycle"],t.AuthorizedValues=t.AuthorizedValues.filter((function(e){return-1===s.indexOf(e.Name)})))):"DELFmiRatioOfDiscreteQuantity"===o.type&&"V_ContQuantity"===t.Name&&(t.ManipulationUnit=0!==t.ManipulationUnit.length?t.ManipulationUnit:"NONE"),r=o.type+"."+t.Name,f[r]=t.NLS,c[r]=function(t){return e.is(t)&&e.is(t.AuthorizedValues,"array")&&(t.AuthorizedValues=t.AuthorizedValues.map((function(t){return{Name:t.Name,NLS:e.is(t.NLS,"string")?t.NLS.trimEnd():t.NLS}})),e.is(t.DefaultValue,"string")&&(t.DefaultValue=t.DefaultValue.trimEnd())),t}(t)})),o}))),["PLMInstance.PLM_ExternalID","PLMReference.V_ApplicabilityDate","type","PLMReference.V_isLastVersion"].forEach((t=>{var i;!e.is(c[t])&&e.is(s[t])&&((i=s[t]).NLS=n.getNLSValue("Attribute."+t),c[t]=i,f[t]=i.NLS)})),t.debug(a.name,"Attributes info merged (dico and mask): ",JSON.stringify(r)),n.addNlsJSON(f),Array.isArray(a._customAttribute)&&a._customAttribute.length>0)for(let e=0;e<a._customAttribute.length;e++)switch(a._customAttribute[e].attributeName){case"V_RepairType":l(c,["DELServiceAssemblyReference.V_RepairType","DELServiceAttachingItemReference.V_RepairType","DELServicePartReference.V_RepairType"],a._customAttribute[e].attributeValue);break;default:l(c,[a._customAttribute[e].attributeName],a._customAttribute[e].attributeValue)}a.addAttributeInfo(c),o(r)}),r)},_retrieveAttrMaskInfoForOperationTypes:function(e,t){this.getAttributeMaskInfoOfType("OPERATION",e,t)},_retrieveAttrMaskInfoForSystemTypes:function(e,t){this.getAttributeMaskInfoOfType("SYSTEM",e,t)},_retrieveAttrMaskInfoForResourceTypes:function(e,t){this.getAttributeMaskInfoOfType("RESOURCE",e,t)},_retrieveAttrMaskInfoForProcessTypes:function(e,t){this.getAttributeMaskInfoOfType("PROCESS",e,t)},_retrieveAttrMaskInfoForProductTypes:function(e,t){this.getAttributeMaskInfoOfType("PRODUCT",e,t)},_retrieveAttrMaskInfoForPartTypes:function(e,t){this.getAttributeMaskInfoOfType("PART",e,t)},retrieveAttrMaskInfoForPPRTypes:function(i,n){var s=this,o=["PROCESS","RESOURCE","PRODUCT","PART","SYSTEM","OPERATION","SERVICE","CONSTRUCTION"],r=[];e.is(s.options)&&e.is(s.options.fetchConfig)&&e.is(s.options.fetchConfig.attrMaskInfo)&&(o=s.options.fetchConfig.attrMaskInfo),o.indexOf("PROCESS")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForProcessTypes.bind(this))),o.indexOf("RESOURCE")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForResourceTypes.bind(this))),o.indexOf("PRODUCT")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForProductTypes.bind(this))),o.indexOf("PART")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForPartTypes.bind(this))),o.indexOf("SYSTEM")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForSystemTypes.bind(this))),o.indexOf("OPERATION")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForOperationTypes.bind(this))),o.indexOf("SERVICE")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForOperationTypes.bind(this))),o.indexOf("CONSTRUCTION")>=0&&r.push(new Promise(this._retrieveAttrMaskInfoForOperationTypes.bind(this))),Promise.all(r).then((function(){i()}),(function(e){t.debug(s.name,"DicoUtils.retrieveAttrMaskInfoForPPRTypes FAILED !!!"),n(e)}))},_retrieveExtnInfoForRefTypes:function(t,i){var n=this,s=["PROCESS","PART","SYSTEM","OPERATION","SERVICE","WORKINSTRUCTION","CONSTRUCTION"];e.is(n.options)&&e.is(n.options.fetchConfig)&&e.is(n.options.fetchConfig.interfaces)&&(s=n.options.fetchConfig.interfaces),this.getExtnInfoOfTypes(this.getReferenceTypes(s),t,i)},_retrieveExtnInfoForInstTypes:function(t,i){var n=this,s=["PROCESS","PART","SYSTEM","OPERATION","SERVICE","WORKINSTRUCTION","CONSTRUCTION"];e.is(n.options)&&e.is(n.options.fetchConfig)&&e.is(n.options.fetchConfig.interfaces)&&(s=n.options.fetchConfig.interfaces),this.getExtnInfoOfTypes(this.getInstanceTypes(s),t,i)},_retrieveExtnInfoForLinkTypes:function(e,t){this.getExtnInfoOfTypes(["MfgProductionPlanning","DELLmiTimeConstraintCnx","DELAsmProcessCanUseCnx","PrimaryResourceLinkDetail"],e,t)},retrieveExtnInfoForClassTypes:function(e,i){var n=this,s=[];s.push(new Promise(this._retrieveExtnInfoForRefTypes.bind(this))),s.push(new Promise(this._retrieveExtnInfoForInstTypes.bind(this))),s.push(new Promise(this._retrieveExtnInfoForLinkTypes.bind(this))),Promise.all(s).then((function(){e()}),(function(e){t.debug(n.name,"DicoUtils.retrieveExtnInfoForClassTypes FAILED !!!"),i(e)}))},getAttributeMaskInfoOfType:function(t,n,s){var o=this;i.webServiceRequest({url:"dsmfg/private/V0/invoke/getTypesAttributesMaskInfo",method:"GET",data:{payload:JSON.stringify([t])},onComplete:function(t){var i;for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&o.addTypeMaskInfo(i,t[i]);e.is(n,"function")&&n()},onFailure:s,onTimeout:s})},getExtnInfoOfTypes:function(t,n,s){var o,r=this;o=function(e,t){var i,n,s=Math.ceil(e.length/t),o=[];for(n=0,i=0;n<s;n++,i+=t)o[n]=e.slice(i,i+t);return o}(t,100).map((function(t){return new Promise((function(n,s){i.webServiceRequest({url:"dictionary/interfaces?customerOnly=false",method:"POST",data:e.Json.encode({classes:t}),onComplete:function(t){!function(t){e.is(t)&&(t=t.results,Array.isArray(t)&&t.forEach((function(e){var t;t=e.interfaces.map((function(e){return e.name})),e.name="MfgProductionPlanning"===e.name?"ProcessImplementLinkOcc":e.name,r.addTypeExtnInfo(e.name,t)})))}(t),n()},onFailure:s,onTimeout:s})}))})),Promise.all(o).then((function(){e.is(n,"function")&&n()})).catch((function(){e.is(s,"function")&&s()}))},addTypeExtnInfo:function(e,t){this._typeExtnInfo[e]=t},addTypeExtnCustomInterface:function(t,i){e.is(this._typeExtnInfo[t],"array")?-1===this._typeExtnInfo[t].indexOf(i)&&this._typeExtnInfo[t].push(i):this._typeExtnInfo[t]=[i]},getProtectedAttributes:function(e){return o[e]},getTypeExtnInfo:function(e){return this._typeExtnInfo[e]},addAttributeInfo:function(t){e.extend(this._attributeInfo,t,!0)},getAttributeInfo:function(e,t){var i;return e&&(-1===e.indexOf(".")&&Object.keys(this._attributeInfo).some((function(t){var i;return(i=t.slice(t.lastIndexOf(".")+1,t.length)===e)&&(e=t),i})),(i=this._attributeInfo[e])&&(i.FullName=e,t&&(i=i[t]))),i},addTypeMaskInfo:function(e,t){this._typeMaskInfo[e]=t},getTypeMaskInfo:function(e){return this._typeMaskInfo[e]}}})),define("DS/DELPPWDicoServices/DimensionUtils",["UWA/Core","UWA/Class","DS/DELPPWWebServices/WebserviceUtils","DS/DELPPWLoggerModel/LoggerUtils"],(function(e,t,i,n){"use strict";return t.singleton({name:"DimensionUtils",_conversionInfos:{},init:function(){},retrieveDimensionConversionInfos:function(e,t){var n=this;i.webServiceRequest({url:"dsmfg/private/V0/invoke/getDimensionConversionInfos",method:"GET",onComplete:function(t){n._conversionInfos=t||{},e()},onFailure:t,onTimeout:t})},getMKSValueFromUnitValue:function(t,i,s){let o=s;if(e.is(this._conversionInfos[t])&&e.is(this._conversionInfos[t][i])){let n=this._conversionInfos[t][i];if(e.is(n)&&e.is(n.offset)&&e.is(n.multiplier)){let e=Number(s),t=Number(n.offset),i=Number(n.multiplier);isFinite(e)&&isFinite(t)&&isFinite(i)&&(o=e*i+t)}}else n.debug("DimensionUtils : ConversionInfos not avilable for Magnitude: "+t+" UnitName : "+i);return o}})})),define("DS/DELPPWDicoServices/CustoXmlUtils",["UWA/Core","UWA/Class"],(function(e,t){"use strict";const i=["current","description","isbestsofar","ispublished","locked","locker","majorrevision","minorrevision","modified","name","organization","originated","owner","physicalid","policy","project","reserved","reservedby","revision"];var n,s,o,r,a;return n=function(e){return Array.isArray(e)?[...e]:[e]},s=function(t,i,n){e.is(t)&&e.is(i)&&e.is(n)&&(e.is(t[i])||(t[i]=[]),-1===t[i].indexOf(n)&&t[i].push(n))},o=function(t,n){var o,r;e.is(t.name)&&(r=e.is(t.dicoType)?t.dicoType:i.indexOf(t.name)>-1?"BusinessType":null,o=t.name,s(n,r,o))},r=function(t,r){var a,u;e.is(t.dataIndex)?(u=e.is(t.dicoType)?t.dicoType:i.indexOf(t.dataIndex)>-1?"BusinessType":null,a=t.dataIndex,s(r,u,a)):e.is(t.Attribute)&&n(t.Attribute).forEach((function(e){o(e,r)}))},a=function e(t,i){for(const[s,r]of Object.entries(t))if("Attribute"===s){n(r).forEach((e=>o(e,i)))}else"object"==typeof r&&e(r,i)},t.singleton({name:"CustoXmlUtils",retrieveAttributesInfoFromXml:function(t,i){var n,s,o={};return e.is(t.type)&&e.is(t.rootNode)&&(n=t.type,s=t.rootNode,e.is(this[n],"function")&&(0,this[n])(i[s],o)),o},columnConfiguration:function(e,t){if(e.Label){n(e.Label).forEach((e=>r(e,t)))}if(e.Columns&&e.Columns.Column){n(e.Columns.Column).forEach((e=>r(e,t)))}},displayNameConfiguration:function(e,t){if(e.Type){n(e.Type).forEach((e=>r(e,t)))}},bomViewConfiguration:function(e,t){if(e.Preferences){const i=e.Preferences;if(i.BOMView){const e=i.BOMView;if(e.Color){const i=e.Color;if(i.AttributeDefinition){const e=i.AttributeDefinition;r(e,t)}}if(e.Content){const i=e.Content;if(i.Type){n(i.Type).forEach((e=>{if(e.Row){n(e.Row).forEach((e=>r(e,t)))}}))}}}}},insertFormConfiguration:function(e,t){if(e.Type){n(e.Type).forEach((e=>{n(e.Section).forEach((e=>{n(e.Attribute).forEach((e=>o(e,t)))}))}))}},editFormConfiguration:function(e,t){if(e.Type){n(e.Type).forEach((e=>{n(e.Attribute).forEach((e=>o(e,t)))}))}},toolTipFormConfiguration:function(e,t){if(e.Tooltip){n(e.Tooltip).forEach((e=>{n(e.Attribute).forEach((e=>o(e,t)))}))}},graphViewConfiguration:function(e,t){e.Preferences&&a(e.Preferences,t)}})})),define("DS/DELPPWDicoServices/DicoUtils",["UWA/Core","UWA/Class","DS/DELPPWWebServices/WebserviceUtils","DS/DELPPWDicoServices/ModelConfigExt","DS/DELPPWDicoServices/AttributeConfigExt","DS/DELPPWResourceServices/ResourceUtils","DS/DELPPWLoggerModel/LoggerUtils"],(function(e,t,i,n,s,o,r){"use strict";var a=t.singleton(n,s,{name:"DicoUtils",_modelAttrsJSON:[],_typeHierarchy:{},_readOnlyTypes:null,_acceptedPPRTypesForActions:null,_acceptedBaseTypesForActions:null,_isAutoCreateScopeOnHOP:!1,_predicatesInfos:{fullName:{},uri:{},uri_UOM:{}},_responseCustoServiceProcessRoles:[],_ootbServiceProcessRoles:["Procedure","Set-Up","Close-Up"],_modelTypeConfig:{_refTypesToPPRType:{},_refPPRTypeToTypes:{},_instTypesToPPRType:{},_instPPRTypeToTypes:{},_connectionTypes:[],_documentTypes:[],getReferenceTypes:function(t){var i;return e.is(t)?(i=[],(t=Array.isArray(t)?t:[t]).forEach((t=>{e.is(this._refPPRTypeToTypes[t])&&(i=i.concat(this._refPPRTypeToTypes[t]))})),i=i.filter(((e,t,i)=>i.indexOf(e)===t))):i=Object.keys(this._refTypesToPPRType),i},addDerivedReferenceTypes:function(t,i){var n;e.is(this._refTypesToPPRType[i])&&(n=e.clone(this._refTypesToPPRType[i]),this._refTypesToPPRType[t]=this._refTypesToPPRType[t]||[],n.forEach((e=>{this._refTypesToPPRType[t].indexOf(e)<0&&this._refTypesToPPRType[t].push(e),this._refPPRTypeToTypes[e]=this._refPPRTypeToTypes[e]||[],this._refPPRTypeToTypes[e].indexOf(t)<0&&this._refPPRTypeToTypes[e].push(t)})))},isInstanceTypes:function(e){return Object.keys(this._instTypesToPPRType).indexOf(e)>-1},getInstanceTypes:function(t){var i;return e.is(t)?(i=[],(t=Array.isArray(t)?t:[t]).forEach((t=>{e.is(this._instPPRTypeToTypes[t])&&(i=i.concat(this._instPPRTypeToTypes[t]))})),i=i.filter(((e,t,i)=>i.indexOf(e)===t))):i=Object.keys(this._instTypesToPPRType),i},addDerivedInstanceTypes:function(t,i){var n;e.is(this._instTypesToPPRType[i])&&(n=e.clone(this._instTypesToPPRType[i]),this._instTypesToPPRType[t]=this._instTypesToPPRType[t]||[],n.forEach((e=>{this._instTypesToPPRType[t].indexOf(e)<0&&this._instTypesToPPRType[t].push(e),this._instPPRTypeToTypes[e]=this._instPPRTypeToTypes[e]||[],this._instPPRTypeToTypes[e].indexOf(t)<0&&this._instPPRTypeToTypes[e].push(t)})))},getConnectionTypes:function(){return this._connectionTypes},getDocumentTypes:function(){return this._documentTypes}},init:function(t){var i,n,s=this;if(t=t||{},!e.is(t.modelRelationsXML)||!e.is(t.modelCustomRelationsXML))throw new Error("modelTypesPath or modelRelationsXML or modelCustomRelationsXML options not defined");s.options=t,(i=!!e.is(t.acceptedPPRTypesForActionsFilePath)&&t.acceptedPPRTypesForActionsFilePath)&&require(["text!"+i],(function(t){e.is(t)?s._acceptedPPRTypesForActions=e.is(t,"string")?e.Json.decode(t):t:r.debug("Accepted Types for DnD mapping is not defined.")})),(n=!!e.is(t.acceptedBaseTypesForActionsFilePath)&&t.acceptedBaseTypesForActionsFilePath)&&require(["text!"+n],(function(t){e.is(t)?s._acceptedBaseTypesForActions=e.is(t,"string")?e.Json.decode(t):t:r.debug("Accepted base types are not defined.")}))},setup:function(e){a._modelAttrsJSON=e.configuredAttribures||[],a._readOnlyTypes=e.readOnlyTypesConfig||new Set,this._initalizeModelTypeConfig(e.modelTypesConfig)},_initalizeModelTypeConfig:function(t){t=t||{};const i=function(e){const t={};for(const[i,n]of Object.entries(e))n.forEach((e=>{t[e]||(t[e]=[]),t[e].push(i)}));return t};e.is(t.reference)&&e.is(t.reference.types)&&(this._modelTypeConfig._refTypesToPPRType=t.reference.types,this._modelTypeConfig._refPPRTypeToTypes=i(t.reference.types)),e.is(t.instance)&&e.is(t.instance.types)&&(this._modelTypeConfig._instTypesToPPRType=t.instance.types,this._modelTypeConfig._instPPRTypeToTypes=i(t.instance.types)),e.is(t.connection)&&e.is(t.connection.types)&&(this._modelTypeConfig._connectionTypes=t.connection.types),e.is(t.document)&&e.is(t.document.types)&&(this._modelTypeConfig._documentTypes=t.document.types)},updateAggregationRules:function(e,t){this.retrieveValidChildTypes(e,t)},retrieveSharedIconPath:function(t,n){var s=o.getIconNames();e.is(s,"array")&&s.length>0?i.webServiceRequest({url:"dsmfg/private/V0/invoke/getSharedIconPath",method:"POST",data:JSON.stringify(s),onComplete:function(e){o.setSharedIconPath(e),t()},onFailure:n,onTimeout:n}):t()},retrieveDimensions:function(e,t){i.webServiceRequest({url:"dictionary/dimensions",method:"GET",onComplete:function(t){o.addDimensions(t.results),e()},onFailure:t,onTimeout:t})},_retrieveDicoType:function(t,n,s){var r=this;i.webServiceRequest({url:"dictionary/getTypeInfo?parentInfo=true",method:"POST",data:JSON.stringify(t),onComplete:function(t){n(),Object.keys(t).forEach((function(i){for(var n=[],s=e.is(t[i].parent)?t[i].parent:null;null!==s;)n.push(s),s=e.is(t[s].parent)?t[s].parent:null;n.length>0&&(n.reverse(),-1!==r.getReferenceTypes().indexOf(n[0])?r._modelTypeConfig.addDerivedReferenceTypes(i,n[0]):-1!==r.getInstanceTypes().indexOf(n[0])&&r._modelTypeConfig.addDerivedInstanceTypes(i,n[0]),-1!==r.getDocumentTypes().indexOf(n[0])&&r._modelTypeConfig._documentTypes.push(i),e.is(t[n[0]].derivedTypes,"array")||(t[n[0]].derivedTypes=[]),t[n[0]].derivedTypes.push(i)),t[i].inheritanceChain=n})),o.addIcons(t),r._typeHierarchy=e.merge(r._typeHierarchy,t)},onFailure:s,onTimeout:s})},retrieveCustomDicoType:function(e,t){var n=[];n=n.concat(this.getReferenceTypes(),this.getInstanceTypes()),i.webServiceRequest({url:"dsmfg/private/V0/invoke/getTypeNLS",method:"POST",data:JSON.stringify({kinds:["entity","interface"],types:n}),onComplete:function(t){o.addNlsJSON(t),e()},onFailure:t,onTimeout:t})},retrieveRefDicoType:function(e,t){this._retrieveDicoType(this.getReferenceTypes(),e,t)},retrieveInstDicoType:function(e,t){this._retrieveDicoType(this.getInstanceTypes(),e,t)},retrieveDocDicoType:function(e,t){this._retrieveDicoType(this.getDocumentTypes(),e,t)},retrieveResourceType:function(e,t){var n=this;i.webServiceRequest({url:"dictionary/getTypeInfo",method:"POST",data:JSON.stringify(["Resource"]),onComplete:function(t){var i=Object.keys(t).filter((function(e){return"Resource"!==e}));t.Resource.derivedTypes=i,t.Resource.inheritanceChain=[],n._typeHierarchy.Resource=t.Resource,e()},onFailure:t,onTimeout:t})},retrieveParameterIsAutoCreateScopeOnHOP:function(t,n){var s=this;i.webServiceRequest({url:"delmia/param/configuration/getParameters?domainID=DigitalManufacturing&familyID=ProcessBehaviors&paramID=AutoCreateScopeOnHOPCheckbox&argID=AutoCreateScopeOnHOPArg",method:"GET",onComplete:function(i){e.is(i)&&(s._isAutoCreateScopeOnHOP=1===i.length&&"Enabled"===i[0].value),t()},onFailure:n,onTimeout:n})},retrieveDicoTypesAttributesIndexMapping:function(t,n){var s=this,o=this._getDicoTypes(),a=function(e){r.error("Failed to retrieve attribute index mapping from server: "+e),n()};e.is(o,"array")&&o.length>0?i.webServiceRequest({url:"dsmfg/private/V0/invoke/getPredicates",method:"POST",data:JSON.stringify(o),onComplete:function(i){e.is(i,"array")&&i.forEach((t=>{e.is(t.fullName)&&(s._predicatesInfos.fullName[t.fullName.toLowerCase()]=t),e.is(t.uri)&&(s._predicatesInfos.uri[t.uri.toLowerCase()]=t),e.is(t.uri_UOM)&&(s._predicatesInfos.uri_UOM[t.uri_UOM.toLowerCase()]=t)})),t()},onFailure:a,onTimeout:a}):t()},_getDicoTypes:function(){var t=["PLMEntity","PLMInstance"];return function i(n){e.is(n,"object")?Object.keys(n).forEach((function(s){"dicoType"===s&&e.is(n[s],"string")?"BusinessType"===n[s]||t.includes(n[s])||t.push(n[s]):i(n[s])})):e.is(n,"array")&&n.forEach((function(e){i(e)}))}(i._xmlCache),t},getAcceptedPPRTypesForActions:function(){return this._acceptedPPRTypesForActions},getAcceptedBaseTypesForActions:function(){return this._acceptedBaseTypesForActions},getParentTypes:function(t){let i=[];return e.is(this._typeHierarchy[t])&&(i=this._typeHierarchy[t].inheritanceChain||[]),i},getReadOnlyTypes:function(){return this._readOnlyTypes},getTypeHierarchy:function(t){return e.is(this._typeHierarchy[t])&&Array.isArray(this._typeHierarchy[t].derivedTypes)?this._typeHierarchy[t].derivedTypes:[]},getTypeInfo:function(t){var i;return e.is(this._typeHierarchy[t])&&(i=this._typeHierarchy[t]),i},getReferenceTypes:function(e){return this._modelTypeConfig.getReferenceTypes(e)},getInstanceTypes:function(e){return this._modelTypeConfig.getInstanceTypes(e)},getDocumentTypes:function(){return this._modelTypeConfig.getDocumentTypes()},getConnectionTypes:function(){return this._modelTypeConfig.getConnectionTypes()},isEntityReference:function(e){return-1!==this.getReferenceTypes().indexOf(e)},isEntityInstance:function(e){return-1!==this.getInstanceTypes().indexOf(e)},isEntityConnection:function(e){return-1!==this.getConnectionTypes().indexOf(e)},isEntityDocument:function(e){return-1!==this.getDocumentTypes().indexOf(e)},isAutoCreateScopeOnHOP:function(){return this._isAutoCreateScopeOnHOP},isAKindOf:function(t,i){var n=!1,s=e.is(t)?e.is(t,"string")?t:e.is(t.get,"function")?t.get("type"):null:null,o=e.is(i,"string")&&0<i.length?a.getTypeHierarchy(i):null;return e.is(s,"string")&&e.is(i,"string")&&(i===s?n=!0:Array.isArray(o)&&(n=o.some((function(e){return s===e}),this))),n},getDicoTypeIndexesForAttribute:function(t,i){var n,s=[],o="";let r=t.toLowerCase();if(e.is(this._predicatesInfos)&&e.is(this._predicatesInfos.fullName)&&e.is(this._predicatesInfos.fullName[r]))if((n=this._predicatesInfos.fullName[r]).kind===i)s.push(n.uri);else if("interface"===n.kind){if(n.uri.startsWith("tbr."))switch(i){case"entity":o="bo"+n.uri.substring(3);break;case"relation":o="ro"+n.uri.substring(3);break;default:o=n.uri}else o=n.uri;s.push(o)}return s},getDicoTypeAttributesForIndex:function(t,i){var n,s=[];let o=t.toLowerCase();return e.is(this._predicatesInfos)&&e.is(this._predicatesInfos.uri)&&(e.is(this._predicatesInfos.uri[o])&&(n=this._predicatesInfos.uri[o]),e.is(n)||"entity"!==i&&"relation"!==i||(o="tbr"+o.substring(2),e.is(this._predicatesInfos.uri[o])&&(n=this._predicatesInfos.uri[o])),e.is(n)&&s.push(n.fullName)),s},getUomPredicateForAttribute:function(t){var i,n;let s=t.toLowerCase();return e.is(this._predicatesInfos)&&e.is(this._predicatesInfos.fullName)&&e.is(this._predicatesInfos.fullName[s])&&(n=this._predicatesInfos.fullName[s],e.is(n.uri_UOM)&&(i=n.uri_UOM)),i},getAttributeForUomPredicate:function(t){var i,n;let s=t.toLowerCase();return e.is(this._predicatesInfos)&&e.is(this._predicatesInfos.uri_UOM)&&e.is(this._predicatesInfos.uri_UOM[s])&&(n=this._predicatesInfos.uri_UOM[s],e.is(n.fullName)&&(i=n.fullName)),i},getPredicateInfosForUriPredicate:function(t){var i,n,s;let o=t.toLowerCase();return e.is(this._predicatesInfos)&&e.is(this._predicatesInfos.uri)&&(e.is(this._predicatesInfos.uri[o])&&(s=this._predicatesInfos.uri[o]),e.is(s)||(o="tbr"+o.substring(2),e.is(this._predicatesInfos.uri[o])&&(s=this._predicatesInfos.uri[o])),e.is(s)&&(i=s.fullName,e.is(s.uri_UOM)&&(n=s.uri_UOM))),[i,n]},fetchDicoAttributeInfo(e,t,i=(()=>{})){e.length>0&&e.forEach((e=>{let t=a._modelAttrsJSON.findIndex((function(t){return t.type===e.type}));-1!==t?a._modelAttrsJSON[t].attributes.push(...e.attributes):a._modelAttrsJSON.push(e)})),a.retrieveDicoAttributeInfo(t,i)},getCustoServiceProcessRoles:function(){return this._responseCustoServiceProcessRoles},getRoleOOTBFromRoleName:function(t){var i=this._responseCustoServiceProcessRoles,n=this._ootbServiceProcessRoles.includes(t)?t:null;return n||(n=i.find((e=>e.rolecusto===t)),n=e.is(n)?n.roleootb:null),n},getAllServiceProcessRoles:function(){var e=this._responseCustoServiceProcessRoles,t=this._ootbServiceProcessRoles.filter((t=>!e.find((e=>e.rolecusto===t)))),i=[];return t.forEach((e=>{i.push({role:e,roleootb:e,nlsText:o.getNLSValue("ServiceProcessRole."+e)})})),e.forEach((e=>{i.push({role:e.rolecusto,roleootb:e.roleootb,nlsText:o.getNLSValue("ServiceProcessRole."+e.rolecusto)})})),i},retrieveCustoServiceProcessRoles:function(t,n){var s=this;i.webServiceRequest({url:"delmia/param/configuration/getParameters?domainID=DigitalManufacturing&familyID=RolesOnProcessInstanceLayoutView&paramID=RolesOnProcessInstanceTreeListView&argID=RolesOnProcessInstanceTreeListViewArg",method:"GET",onComplete:function(i){var n,r,a=o.getCountryCodesForLanguage(widget.lang),u=[];s._responseCustoServiceProcessRoles=i,!e.is(i,"array")||!i.length>0||i.forEach((e=>{for(n in e)if(a.includes(n)){r=String(e[n]);break}u["ServiceProcessRole."+e.rolecusto]=r||String(e.rolecusto),o.addNlsJSON(u,!0),r=null})),t()},onFailure:function(){console.log("Failure to fetch custom roles"),n()}})}});return a}));