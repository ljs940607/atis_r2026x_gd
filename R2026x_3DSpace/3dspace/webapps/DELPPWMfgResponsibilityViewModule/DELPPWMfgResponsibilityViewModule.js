define("DS/DELPPWMfgResponsibilityViewModule/MfgResponsibilityViewUI",["UWA/Core"],(function(e){"use strict";return function(t,n,i,o,r){var a,c,d,l,s=o.getComponent("WUXDockAreaEnum"),g=o.getComponent("WUXFrameWindowsManager").getFrameWindow(t.getAppContext()).getImmersiveFrame();return a=function(a,g){var u=t.getElement(),f=o.createElement("div",{class:"tree-list-container"}),h=e.is(r)?r.getIconURLFromKey(g):"";f.inject(u),l=r.getNLSValue("View."+a+".Title")||"",n.loadDocument(i.getWUXNodeModel()),n.getContent().inject(f),(c=o.create("Panel",{position:{at:"right"},minWidth:300,minHeight:250,height:250,title:l,icon:h,side:s.RightDockArea,currentDockArea:s.RightDockArea,identifier:"panel-"+d,content:u,resizableFlag:!0,closeButtonFlag:!0,useBordersFlag:!0,visibleFlag:!1,collapsibleFlag:!0,verticallyStretchableFlag:!1})).close=function(){e.is(d)?t.notify("toggleCmdCheckHeaderState",{cmdName:d,cmdState:!1}):c.hide()}},{init:function(n,i,o){e.is(n,"string")?(d=n,a(i,o)):t.debug("MfgResponsibilityViewUI","Command name is not defined to create action UI.")},destroy:function(){i.emptyNodeModel(),e.is(c)&&(c.destroy(),c=void 0)},toggle:function(t){var n;t.state&&!c.visibleFlag?(c.immersiveFrame=g,n=g.getDockingElement(c.currentDockArea),e.is(n)&&(n.collapseDockingZoneFlag=!1),c.show()):c.hide()},updateTitle:function(t){e.is(t)&&""!==t?c.title=l+" - "+t:c.title=l}}}})),define("DS/DELPPWMfgResponsibilityViewModule/MfgResponsibilityViewModule",["UWA/Core","DS/DELPPWMfgResponsibilityViewModule/MfgResponsibilityViewUI"],(function(e,t){"use strict";return{behaviors:["TreeListViewBehavior","WUXNodeModelBehavior","UXFactoryBehavior","LinkBehavior","ModelBehavior","SelectionBehavior","SearchBehavior","ResourceBehavior"],creator:function(n,i,o,r,a,c,d,l,s){var g,u,f,h=[],m=[],p=null,v=function(t){return!(!e.is(t)||!e.is(t.get))&&m.indexOf(t.get("type"))>-1},C=function(){return h.indexOf("PROCESS")>-1||h.indexOf("SERVICE")>-1||h.indexOf("CONSTRUCTION")>-1},R=function(t){var o={action:[],parameters:[]};e.is(t,"array")&&t.length>0?(t.forEach((function(e,t){o.action[t]="addRoot",o.parameters[t]={rootReferencePID:e.id}})),i.processDropEffect(o)):n.debug("No search results")},y=function(){var t,i,r=d.getSelections();o.emptyNodeModel(),!e.is(r,"array")||1!==r[1].length&&1!==r[2].length?(p=null,u.updateTitle("")):(e.is(r[1][0])?i=r[1][0]:e.is(r[2][0])&&(i=r[2][0]),e.is(i)?(p=i,t=c.getReferenceModel(i),e.is(t)?(u.updateTitle(c.getDisplayName(t)),a.getConnectionsByModel(t,null,{silentMode:!0,onComplete:function(n){var i;e.is(p)&&Array.isArray(n)&&n.length>0&&(o.prepareUpdate(),n.forEach((function(n){v(n)&&n.get("from")===t.get("PID")&&(i=c.getReference(n.get("to")),e.is(i)&&(o.isNodeAdded(i.get("PID"))||o.addNode(i,{loadChildren:!1})))})),o.pushUpdate())}})):n.debug("Reference Model is empty for PID:"+i)):n.debug("No selection in mbom to load action view data."))};return{listenTo:function(){return{referenceChanged:this.onChangeIRPC,connectionAdded:this.onAddConnection,connectionChanged:this.onChangeIRPC,connectionRemoved:this.onRemoveConnection,select:this.reloadUI,ActionRemove:this.onActionRemove,SearchAndAddCommand:this.onSearchAndAddCommand,refreshImpacted:this.reloadUI}},onStart:function(e){var a;h=(e=e||{}).pprTypes,m=e.linkTypes,g=e.relatedCmdId,f=e.moduleIcon,a=s.getNLSValue(g),(u=new t(n,i,o,r,s)).init(g,a,f),u.toggle({state:!0}),y()},onStop:function(){e.is(u)&&(u.destroy(),u=void 0),p=null},onSearchAndAddCommand:function(){C()?l.activate(s.getNLSValue("InContextSearch.MBOM.Title"),R.bind(this)):h.indexOf("ORGANIZATION")>-1&&l.activate(s.getNLSValue("InContextSearch.RESP.Title"),R.bind(this))},onActionRemove:function(){var t,i,o=d.getSelections();e.is(o,"array")&&o[0].length>0&&(1===o[1].length||1===o[2].length)&&(e.is(o[1][0])?i=c.getReferenceModel(o[1]):e.is(o[2][0])&&(i=c.getReferenceModel(o[2])),a.getConnectionsByModel(i,null,{onComplete:function(n){if(e.is(n,"array")&&n.length>0)for(t=0;t<o[0].length;t++)n.forEach((function(e){e.get("to")===o[0][t]&&a.deleteConnection(e.get("PID"))}))},onFailure:function(){n.debug("Getting connections failed")}}))},onChangeIRPC:function(t){var n;t=Array.isArray(t)?t:[t],n=d.getSelections(),e.is(n,"array")&&n.length>0&&(1===n[1].length||1===n[2].length)&&o.withTransactionUpdate((function(){t.forEach((function(e){C()&&o.updateAttributes(e)}))}))},onAddConnection:function(t){var n=function(t){var n,i,r,a;v(t)&&(r=t.get("to"),n=d.getSelections(),!e.is(n,"array")||1!==n[1].length&&1!==n[2].length||(e.is(n[1][0])?i=c.getReferenceModel(n[1][0]):e.is(n[2][0])&&(i=c.getReferenceModel(n[2][0])),e.is(i)&&i.get("PID")!==r&&(a=c.getReferenceModel(r),e.is(a)&&(o.isNodeAdded(a.get("PID"))||o.addNode(a,{loadChildren:!1})))))};e.is(t,"array")?t.forEach((function(e){n(e)})):n(t)},onRemoveConnection:function(t){var n=[],i=function(t){var i,o=t.get("to");v(t)&&(i=c.getReferenceModel(o),e.is(i)&&n.push(i.get("PID")))};o.withTransactionUpdate((function(){e.is(t,"array")?t.forEach((function(e){i(e)})):i(t),n.length>0&&o.removeNodes(n)}))},reloadUI:function(t){e.is(t)&&y()}}}}}));