define("DS/DELPPWOperations3DViewerModule/ScopeMfgItemSelectionUI",["UWA/Core"],(function(e){"use strict";return function(t,i,n){const s="rootField",o="occField",a="scopedMfgItemField";var r,l,c,d,u=1,f=2,g=i.getComponent("Element"),p=i.getComponent("Accordeon"),I=i.getComponent("Button"),h=i.getComponent("ComboBox"),m=i.getComponent("TooltipModel"),P=null,S=null,v=null;return r=function(r){var l,c,d;l=function(i){switch(i){case u:return function(){S.close()};case f:return function(){var t=v[s],i=v[o],n=v[a];e.is(r,"function")&&e.is(t)&&e.is(i)&&e.is(n)&&r(t.value,i.value,n.value),S.close()};default:t.log("wrong option")}},c={No:new I({label:n.getNLSValue("ScopeMfgItemSelectionUI.Close.Title"),onClick:l(u)}),Yes:new I({disabled:!1,label:n.getNLSValue("ScopeMfgItemSelectionUI.Load.Title"),onClick:l(f)})},e.is(i)?(d={title:n.getNLSValue("ScopeMfgItemSelectionUI.Dialog.Title"),domId:"ScopeMfgItemSelectionUI-dialog",content:P,resizableFlag:!0,modalFlag:!1,minWidth:290,width:400,buttons:c,visibleFlag:!1},(S=i.create("Dialog",d)).close=function(){e.is(P)&&P.destroy(),this.destroy(),S=null,v=null}):t.debug("uxFactoryBehavior is not available.")},l=function(t){var i,n;return i=new e.Element("div",{class:"accordeon-section-container"}),n=new g("div",{class:"section-container"}),i.inject(P),new p({items:[{header:t,content:n,expandedFlag:!0}],style:"filled-separate"}).inject(i),n.addEvent("resize",(function(){var t,i,s;s=n.getElements(".wux-field-container"),n.clientWidth<290?(t="inline-container",i="block-container"):(t="block-container",i="inline-container"),e.is(s)&&s.forEach((function(e){e.removeClassName(t),e.addClassName(i)}))})),n},c=function(t,i){t.forEach((function(t){var n,s;n=new e.Element("div",{class:"wux-field-container inline-container"}),new e.Element("h6",{class:"wux-textElement",text:t.label}).inject(n).tooltipInfos=new m({shortHelp:t.label}),s=new h({elementsList:t.elementsList,actionOnClickFlag:!1,enableSearchFlag:!1,value:t.value,disabled:t.disabled}),e.is(t.onChange,"function")&&s.addEventListener("change",t.onChange.bind(null,v)),v[t.name]=s,s.inject(n),n.inject(i)}))},d=function(t){var i,r,d,u,f,g={},p={};Array.isArray(t)&&t.length>0&&(d={name:s,label:n.getNLSValue("ScopeMfgItemSelectionUI.Field.Root.Title"),elementsList:[],disabled:!0,onChange:function(t){var i,n,r,l,c,d,u;i=t[s],r=t[o],d=t[a],e.is(i)&&e.is(r)&&e.is(d)&&(n=i.value,e.is(g[n])&&(c=(l=g[n])[0].valueItem,r.setProperties({elementsList:l,value:c}),e.is(p[c])&&(u=p[c],d.setProperties({elementsList:u,value:u[0].valueItem}))))}},u={name:o,label:n.getNLSValue("ScopeMfgItemSelectionUI.Field.Occurence.Title"),elementsList:[],disabled:!0,onChange:function(t){var i,n,s,r;i=t[o],s=t[a],e.is(i)&&e.is(s)&&(n=i.value,e.is(p[n])&&(r=p[n],s.setProperties({elementsList:r,value:r[0].valueItem})))}},f={name:a,label:n.getNLSValue("ScopeMfgItemSelectionUI.Field.ScopedMfgItem.Title"),elementsList:[],disabled:!0},t.forEach((function(e){var t=[];e.occurences.forEach((function(e){var i=[];t.push({labelItem:e.label,valueItem:e.pid}),e.scopedMfgItems.forEach((function(e){i.push({labelItem:e.label,valueItem:e.pid})})),p[e.pid]=i})),g[e.pid]=t})),r=t[0],d.disabled=!1,d.value=r.pid,d.elementsList=t.map((function(e){return{labelItem:e.label,valueItem:e.pid}})),e.is(g[d.value])&&(u.disabled=!1,u.elementsList=g[d.value],u.value=u.elementsList[0].valueItem,e.is(p[u.value])&&(f.disabled=!1,f.elementsList=p[u.value],f.value=f.elementsList[0].valueItem)),v=[],i=l(n.getNLSValue("ScopeMfgItemSelectionUI.Section.Process.Title")),c([d,u],i),i=l(n.getNLSValue("ScopeMfgItemSelectionUI.Section.MfgItems.Title")),c([f],i))},{createDialog:function(t){!e.is(S)&&e.is(t)&&e.is(t.data)&&e.is(t.onSelectCallback)&&(P=new g("div",{class:"ScopeMfgItemSelectionUI-Container"}),r(t.onSelectCallback),d(t.data),S.show())},isActive:function(){return!!e.is(S)&&S.visibleFlag},destroyUI:function(){e.is(S)&&S.close()}}}})),define("DS/DELPPWOperations3DViewerModule/Operations3DViewerModule",["UWA/Core","DS/TransientWidget/TransientWidget","DS/DELPPWOperations3DViewerModule/ScopeMfgItemSelectionUI"],(function(e,t,i){"use strict";return{behaviors:["InterWidgetComBehavior","UXFactoryBehavior","ResourceBehavior","ModelBehavior","RootsBehavior","LinkBehavior","ProcessImplementBehavior","CapableResourceLinkBehaviour","SelectionBehavior","Operations3DViewerBehavior","BuildUpBehavior"],creator:function(n,s,o,a,r,l,c,d,u,f,g,p){const I="ProcessImplementLink",h="PartialProcessImplementLink",m="ProcessImplementLinkOcc",P="CapableResourcesStructureLink",S={commands:[{identifier:"DELWebOERToggleDataGridViewCmd",disable:!0}]};var v,D,b,E,R,O,y,M,L,C,V,w,T,U,A,x,N,W,F,B,j,k,Y,H,_,G,q,z,X,J,K,Q,Z,$,ee,te,ie,ne,se,oe,ae,re,le,ce,de,ue,fe,ge,pe=s.getOpViewerWidgetAppId(),Ie=null,he=null,me=[],Pe=[],Se=[],ve={};return b=function(){return g.getPreferences()},E=function(e,t,i){var s={loadedObjInfos:{sysPID:e,scopedMfgItemPID:t,resourceItemPID:i}};g.updatePreferences(s),n.notify("set3DVisibilityState",[{isVisible:!0,parentPID:t}])},R=function(t){var i,s=!!e.is(t)&&t;Se=[],D=b(),g.updatePreferences(),he=null,Ie=null,s?p.resetAllSessions.call(p):p.resetActiveSession.call(p),e.is(D)&&(i=D.loadedObjInfos,e.is(i)&&n.notify("set3DVisibilityState",[{isVisible:!1,parentPID:i.scopedMfgItemPID}]))},O=function(e){var t,i=[];if(1===e.length)i=e;else for(t=0;t<e.length;t++)t%2==1&&i.push(e[t]);return i},y=function(t){var i,n,s=t.absPath,o=[],a=s[s.length-1],l=e.is(a)?a:t.nodeId,d=null,u=r.getReference(l);if(e.is(u)||(n=r.getInstance(a),e.is(n)&&(u=r.getReferenceModelFromInstance(n),d=n.id,l=u.id)),e.is(l))switch(r.getPPRType(u)){case"OPERATION":case"SYSTEM":c.getImpactedObjects(e.is(d)?d:l,s,{relationTypes:[I,h,m]}).forEach((function(e){var t=r.transformToRIROccurrencePath(e);o.push(t)}));break;case"PROCESS":case"CONSTRUCTION":case"RESOURCE":case"SERVICE":i=r.transformToRIROccurrencePath(s.length>0?s:l),o.push(i)}return o},M=function(t){var i,n,o,a=!1;return s.isOpsViewerWidgetLinked()&&(n=b(),e.is(n)&&(o=n.loadedObjInfos,e.is(o.sysPID)&&(t===o.sysPID?a=!0:(i=r.getReference(t),"SYSTEM"===r.getPPRType(i)&&r.getInstancesFromCollection(t).forEach((function(e){r.getReferenceModelFromInstance(e).get("PID")===o.sysPID&&(a=!0)})))))),a},L=function(t){var i,n,o,a=!1;return s.isOpsViewerWidgetLinked()&&(n=b(),!e.is(n)&&e.is(D)&&(o=D.loadedObjInfos,e.is(o.sysPID)&&(t===o.sysPID?a=!0:(i=r.getReference(t),"SYSTEM"===r.getPPRType(i)&&r.getInstancesFromCollection(t).forEach((function(e){r.getReferenceModelFromInstance(e).get("PID")===o.sysPID&&(a=!0)})))))),a},C=function(t,i){var n=[];return Array.isArray(t)&&t.length>0&&t.forEach((function(t){var s,o,a,l,d=[],u=[];o=r.getReference(t),e.is(o)&&o.isSystem()&&(c.getImpactedObjects(t,null,{relationTypes:[I,P]}).forEach((function(e){var t=r.getReference(e);"PROCESS"===t.get("PPRTYPE")||"CONSTRUCTION"===t.get("PPRTYPE")||"SERVICE"===t.get("PPRTYPE")?d.push(e):"RESOURCE"===t.get("PPRTYPE")&&(a=e)})),d.length>0?(l=[],d.forEach((function(e){var t=r.getReference(e);l.push({pid:e,label:t.get("PLMEntity.V_Name")})})),e.is(a)||(e.is(i)?i:r.getInstancesFromCollection(t,{sort:!0})).some((function(e){var t,i;return t=r.getReferenceModelFromInstance(e).get("PID"),(i=c.getImpactedObjects(t,null,{relationTypes:[P]})).length>0&&(a=i[0],!0)})),s={pid:t,label:o.get("PLMEntity.V_Name"),occurences:[{pid:t,label:o.get("PLMEntity.V_Name"),scopedMfgItems:l,resource:a}]}):(e.is(i)?i:r.getInstancesFromCollection(t,{sort:!0})).forEach((function(e){var t,i,n=[];i=(t=r.getReferenceModelFromInstance(e)).get("PID"),c.getImpactedObjects(i,null,{relationTypes:[I,P]}).forEach((function(e){var t=r.getReference(e);"PROCESS"===t.get("PPRTYPE")||"CONSTRUCTION"===t.get("PPRTYPE")||"SERVICE"===t.get("PPRTYPE")?d.push(e):"RESOURCE"===t.get("PPRTYPE")&&(a=e)})),d.length>0&&(d.forEach((function(e){var t=r.getReference(e);n.push({pid:e,label:t.get("PLMEntity.V_Name")})})),u.push({pid:i,label:t.get("PLMEntity.V_Name"),scopedMfgItems:n,resource:a})),d=[]})),u.length>0&&(s={pid:t,label:o.get("PLMEntity.V_Name"),occurences:u})),e.is(s)&&n.push(s)})),n},V=function(t){var s,r,l,c,d;if(d=function(){var t,i;t=b(),e.is(t)&&(i=t.loadedObjInfos,e.is(i.scopedMfgItemPID)&&U(i.scopedMfgItemPID,i.resourceItemPID))},t.length>0){if(1===t.length&&(l=t[0],e.is(l.occurences)&&1===l.occurences.length&&(c=l.occurences[0],e.is(c.scopedMfgItems)&&1===c.scopedMfgItems.length)))return r=c.scopedMfgItems[0].pid,s=c.resource,d(),void T(c.pid,r,s);(v=new i(n,o,a)).createDialog({data:t,onSelectCallback:function(i,n,o){var a=!1;e.is(i)&&e.is(n)&&e.is(o)&&(d(),t.some((function(e){return e.pid===i&&e.occurences.some((function(e){return e.pid===n&&(s=e.resource,a=!0),a})),a})),T(n,o,s))}})}},w=function(t,i){e.is(t)&&s.publishEvent("DS/DELExternalWidgetCom/"+t,i)},T=function(t,i,n){var s,o=[];s=r.getReferenceModel(t),e.is(s)&&"SYSTEM"===r.getPPRType(s)&&(E(t,i,n),o.push({id:i}),n&&o.push({id:n}),w("LoadData",{items:o}))},U=function(t,i){var n=[],s=r.getReferenceModel(t),o=r.getReferenceModel(i);!e.is(s)||"PROCESS"!==r.getPPRType(s)&&"CONSTRUCTION"!==r.getPPRType(s)&&"SERVICE"!==r.getPPRType(s)||(R(),n.push({id:t}),e.is(o)&&"RESOURCE"===r.getPPRType(o)&&n.push({id:i}),w("RemoveRoots",{items:n}))},A=function(){w("RemoveAll"),R()},x=function(e){var t,i=b().loadedObjInfos;(t=e.indexOf(he))>-1&&(e.splice(0,t),Pe=p.getContextItemRIRPaths(),w("ActivateBuildUp",{id:he,scopedMfg:{id:i.scopedMfgItemPID},path:e,session:{id:Ie},context:Pe}))},N=function(e){var t;(t=e.indexOf(he))>-1&&(e.splice(0,t),w("DeactivateBuildUp",{path:e,session:{id:Ie}}))},W=function(t){var i,n,s,o,a,r;n=b(),e.is(n)&&e.is(n.loadedObjInfos)&&(s=n.loadedObjInfos,o=s.sysPID,a=s.scopedMfgItemPID,r=s.resourceItemPID,t.path=t.path.map((function(t){let i=0;return e.is(o)&&t.indexOf(o)>-1?i=t.indexOf(o):e.is(a)&&t.indexOf(a)>-1?i=t.indexOf(a):e.is(r)&&t.indexOf(r)>-1&&(i=t.indexOf(r)),t=t.slice(i)}))),t.path.length>0&&w(t.event,{path:t.path}),e.is(t.sysOrOperRIRPath)&&(i=p.getBuildUpCmd(),e.is(i)&&i.getState()&&(e.Array.equals(me,t.sysOrOperRIRPath)||x(t.sysOrOperRIRPath)))},F=function(){A()},B=function(t){var i,n,s;e.is(t)&&(t=Array.isArray(t)?t:t.impactedChildren).some((function(e){return L(e)}))&&(i=D.loadedObjInfos,n=c.getImpactedObjects(i.sysPID,null,{relationTypes:[I]}),s=c.getImpactedObjects(i.sysPID,null,{relationTypes:[P]}),n.indexOf(i.scopedMfgItemPID)>-1&&(s.indexOf(i.resourceItemPID)>-1&&T(i.sysPID,i.scopedMfgItemPID,i.resourceItemPID),T(i.sysPID,i.scopedMfgItemPID)))},j=function(){setTimeout((function(){w("GetAppStatus")}),100)},k=function(){var t={},i=[],s=p.getBuildUpCmd();e.is(v)&&v.isActive()&&v.destroyUI(),R(!0),e.is(s)&&s.getState()&&s.setState(!1),e.is(me)&&me.length>0&&(t={absPath:r.transformRIRToAbsolutePath(me),state:!1},i.push(t),n.notify("update3DBuildUpState",[i])),n.notify("widgetUnlinked")},Y=function(){var e,t;t=l.getRoots()[0],e=C(t),w("SetAppConfig",S),e.length>0&&V(e),n.notify("widgetLinked")},H=function(){s.isOpsViewerWidgetLinked()?n.warn(a.getNLSValue("Operations3DViewerModule.OpViewerIsAlreadyAvilable")):t.showWidget(pe,"",{},{mode:"transient"})},_=function(e){var t=!1,i=["PROCESS","SYSTEM","OPERATION","SERVICE","CONSTRUCTION"];s.isOpsViewerWidgetLinked()&&((e=Array.isArray(e)?e:[e]).forEach((function(e){var n;n=r.getReferenceModelFromInstance(e),i.indexOf(r.getPPRType(n))>-1&&(t=!0)})),t&&w("Highlight",{path:[],clear:!0}))},G=function(t){var i,n,o,a,l=[];s.isOpsViewerWidgetLinked()&&(i=b(),e.is(i)&&(n=i.loadedObjInfos,o=n.sysPID,a=n.scopedMfgItemPID,e.is(o)&&e.is(a)&&(t=Array.isArray(t)?t:[t]).forEach((function(e){e.get("type")===I||e.get("type")===h?e.get("from")===o&&e.get("to")===a?A():f.getSelectionsWithPaths()[0].length>0&&(r.findAllRIRPaths(e.get("from")).forEach((function(t){t.includes(o)&&r.findAllRIRPaths(e.get("to")).forEach((function(e){g.isAggregatingRootLoadedInViewer(e)&&l.push(e)}))})),l.length>0&&w("UnHighlight",{path:l})):e.get("type")===m&&f.getSelectionsWithPaths()[0].forEach((function(t){e.get("from").every((function(e){return t.path.includes(e)}))&&(y({absPath:e.get("to")}).forEach((function(e){r.findAllRIRPaths(e).forEach((function(e){g.isAggregatingRootLoadedInViewer(e)&&l.push(e)}))})),l.length>0&&w("UnHighlight",{path:l}))}))}))))},q=function(t){var i,n;s.isOpsViewerWidgetLinked()&&(n=b(),e.is(n)||(i=C([t]),V(i)))},z=function(t){var i,n;s.isOpsViewerWidgetLinked()&&(i=b(),e.is(i)&&(n=i.loadedObjInfos,t.some((function(e){let t=!1;return e.isSystem()?t=M(e.get("PID")):e.isProcess()&&(t=e.get("PID")===n.scopedMfgItemPID),t}))&&U(n.scopedMfgItemPID,n.resourceItemPID)))},X=function(){var t,i,n;s.isOpsViewerWidgetLinked()&&(l.getRoots()[0].some((function(e){return M(e)}))?(t=b().loadedObjInfos,i=c.getImpactedObjects(t.sysPID,null,{relationTypes:[I]}),n=c.getImpactedObjects(t.sysPID,null,{relationTypes:[P]}),i.indexOf(t.scopedMfgItemPID)>-1&&(!e.is(t.resourceItemPID)||n.indexOf(t.resourceItemPID)>-1)?T(t.sysPID,t.scopedMfgItemPID,t.resourceItemPID):R()):R())},J=function(){R()},Z=function(t){var i,s,o;e.is(t)&&e.is(t.items)&&e.is(t.items.length>0)&&t.items.forEach((function(t){s=function(){(i=r.getReferenceModel(t.id))&&(n.notify("referenceAdded",[i]),n.notify("HideLandingPage"))},o=function(){},i=r.getReferenceModel(t.id),e.is(i)?s():r.getDescendantsFromServer([t.id],s,{onFailure:o,silentMode:!0})}))},Q=function(t){var i,s,o,a,l,c,d,u,f=!1,g=!0;e.is(t)&&e.is(t.items)&&e.is(t.items.length>0)&&t.items.forEach((function(e){switch(e.pprType){case"MBOM":case"SBOM":d=e.id,f=e.ViewerContentLoaded;break;case"RESOURCE":u=e.id,f=e.ViewerContentLoaded;break;case"PROCESS":case"SERVICEPROCESS":c=e.id,f=e.ViewerContentLoaded}})),f&&(i=b(),e.is(i)&&(i=i.loadedObjInfos).scopedMfgItemPID===d&&(e.is(u)&&i.resourceItemPID!==u&&(g=!0),g=!1),g&&(a=function(){s=r.getReferenceModel(c),o=r.getReferenceModel(d),s?n.notify("referenceAdded",[s]):o&&n.notify("referenceAdded",[o]),E(c,d,u),n.notify("HideLandingPage")},l=function(){},s=r.getReferenceModel(c),e.is(c)&&!e.is(s)?r.getDescendantsFromServer([c],a,{onFailure:l,silentMode:!0}):e.is(d)&&!e.is(o)?r.getDescendantsFromServer([d],a,{onFailure:l,silentMode:!0}):a()))},K=function(){R()},$=function(t){var i,s,o,a,l,c,d,u={};if(i=this.isSelected,s=i?"selectNodes":"unSelectNodes",d=function(){i&&n.notify("addOccurrece",[o]),n.notify(s,[a])},e.is(t.path))if(o=t.path,a=[],l=[],c=[],o.forEach((function(n){var s=!1,o=n.filter((function(o,a){var c,d,u,f=!1,g=!1;return d=r.getPPRType(o),e.is(d)||(u=a%2!=0?n[a+1]:o,e.is(t.attributes)&&e.is(t.attributes[u])&&(d=r.getPPRTypeFromType(t.attributes[u].type))),"PROCESS"!==d&&"CONSTRUCTION"!==d&&"SERVICE"!==d&&"RESOURCE"!==d||(g=!0,a%2!=0&&(f=!0)),g&&i&&(c=a%2!=0?r.getInstance(o):r.getReferenceModel(o),e.is(c)||(l.push(o),s=!0)),f}));s&&c.push(n),0===o.length&&(o=n),a.push(o)})),c.length>0){let e=function(){d(),n.notify("stopProgress",u)},t=function(){n.debug("Fetching getDescendantsFromServer for missing occurence failed."),n.notify("stopProgress",u)};n.notify("startProgress",u),r.getDescendantsFromServer(l,e,{onFailure:t,silentMode:!0,expandLevel:0,forceDBMode:!0})}else d()},ee=function(t){var i,n,o,a,r,l=[],c=[];s.isOpsViewerWidgetLinked()&&(i=b(),e.is(i)&&e.is(i.loadedObjInfos)&&(n=i.loadedObjInfos,o=n.sysPID,a=n.scopedMfgItemPID,r=n.resourceItemPID),(t=Array.isArray(t)?t:[t]).forEach((function(t){let i,n=0;e.is(o)&&t.rirPath.indexOf(o)>-1?n=t.rirPath.indexOf(o):e.is(a)&&t.rirPath.indexOf(a)>-1?n=t.rirPath.indexOf(a):e.is(r)&&t.rirPath.indexOf(r)>-1&&(n=t.rirPath.indexOf(r)),i=t.rirPath.slice(n),t.isVisible?c.push(i):l.push(i)})),l.length>0&&w("Hide",{path:l}),c.length>0&&w("Show",{path:c}))},te=function(t){var i,s=this.isDisplayed,o={},a=[];e.is(t.attributes)&&(t.path.forEach((function(e){i=O(e),o={absPath:i,isVisible:s},a.push(o)})),n.notify("update3DVisibilityState",[a]))},ie=function(t){var i,n,o,a,l,c,d;s.isOpsViewerWidgetLinked()&&((a=t.absPath).length>0?(l=a[0],c=r.getInstance(l),d=r.getReferenceModelFromInstance(c)):d=r.getReference(t.nodeId),"SYSTEM"===r.getPPRType(d)&&(n=[d.get("PID")],e.is(c)&&(o=[c]),i=C(n,o),V(i)))},ne=function(e){var t,i,n=[];s.isOpsViewerWidgetLinked()&&(t=b(),i=t.loadedObjInfos,e.forEach((function(e){let t=0;t=e.indexOf(i.scopedMfgItemPID),t>-1&&(e=e.slice(t),n.push(e))})),n.length>0&&w("Reframe",{path:n}))},se=function(t,i){var s,o;s=b(),e.is(s)&&(o=s.loadedObjInfos).sysPID===t&&p.initBuildUpSession(o,ae).then((function(s){Ie=s[0],he=t;let l=s[1];p.isAuthoringMode()&&e.is(o.resourceItemPID)?n.info(a.getNLSValue("Operations3DViewerModule.BuildUpSessionCreationSuccessWithoutResources")):n.info(a.getNLSValue("Operations3DViewerModule.BuildUpSessionCreationSuccess")),l.forEach((function(e){Se=Se.concat(r.findAllRIRPaths(e))})),e.is(i)&&i.length>1&&-1!==i.indexOf(he)&&x(i)}),(function(){Ie=null,he=null,n.warn(a.getNLSValue("Operations3DViewerModule.BuildUpSessionCreationFailed"))}))},oe=function(t){var i,s,o=[],l=f.getSelectionsWithPaths()[0];if(i=b(),e.is(i)&&(s=i.loadedObjInfos),1===l.length&&(o=r.transformToRIROccurrencePath(l[0].path)),t.state){let e=s.sysPID;null===he?se(e,o):o.length>0&&-1!==o.indexOf(he)&&x(o),n.info(a.getNLSValue("Operations3DViewerModule.BuildUpReviewModeIsEnabled"))}else e.is(me)&&me.length>0&&(N(me),n.info(a.getNLSValue("Operations3DViewerModule.BuildUpReviewModeIsDisabled")))},ae=function(t){e.is(me)&&me.length>0&&(e.is(t)&&-1!==me.indexOf(t)?(N(me),n.info(a.getNLSValue("Operations3DViewerModule.BuildUpReviewModeIsDisabled"))):(x(me),n.info(a.getNLSValue("Operations3DViewerModule.BuildUpResultRefresh"))))},re=function(t){var i,o,l;s.isOpsViewerWidgetLinked()&&(i=b(),e.is(i)&&(o=i.loadedObjInfos),l=r.transformToRIROccurrencePath(t),null===he&&-1!==l.indexOf(o.sysPID)?se(o.sysPID,l):-1!==l.indexOf(he)?x(l):n.warn(a.getNLSValue("Operations3DViewerModule.BuildUpActivateFailed")))},le=function(t){var i,n,o;s.isOpsViewerWidgetLinked()&&(i=b(),e.is(i)&&(n=i.loadedObjInfos),-1!==(o=r.transformToRIROccurrencePath(t)).indexOf(n.sysPID)&&N(o))},ce=function(t){var i=b().loadedObjInfos,s=this.isActivated,o=O(t.path),a={},r=[];a={absPath:o,isActivated:s},r.push(a),e.is(me)&&me.length>0&&!e.Array.equals(t.path,me)&&(a={absPath:o=O(me),isActivated:!s},r.push(a)),n.notify("update3DBuildUpState",[r]),n.notify("set3DVisibilityState",[{isVisible:!0,parentPID:i.scopedMfgItemPID}]),me=s?t.path:[],fe(s)},de=function(){n.warn(a.getNLSValue("Operations3DViewerModule.BuildUpActivateFailed"))},ue=function(e){e.isActivated?re(e.absPath):le(e.absPath)},fe=function(e){var t=b().loadedObjInfos,i=!0===e?"Hide":"Show";Se.length>0&&(Se.forEach((function(e){let n=e.indexOf(t.resourceItemPID);e=e.slice(n),w(i,{path:e})})),e||w("Reframe",{path:[t.resourceItemPID]}))},ge=function(t){var i,s=b().loadedObjInfos;t===s.scopedMfgItemPID&&(i=l.getRootFilter(s.scopedMfgItemPID),console.log(i),e.is(me)&&me.length>0&&(N(me),n.info(a.getNLSValue("Operations3DViewerModule.BuildUpReviewModeIsDisabled"))),p.resetActiveSession(),he=null,Ie=null)},{listenTo:function(){return{addRootNode:q,hideRootNode:z,onRecentContentLoaded:X,LoadNewSession:J,refreshAll:F,onRefreshedAll:B,refreshImpacted:B,HideAll:F,instanceRemoved:_,connectionRemoved:G,toggle3DHighlight:W,toggle3DVisibility:ee,Show3DViewerCmd:H,LoadItemsIn3DViewer:ie,ReframeItemsIn3DViewer:ne,BuildUpReviewModeCmd:oe,toggle3DBuildUpColumnButton:ue,expandFilterUpdated:ge}},onStart:function(t,i){var o;ve=e.extend(ve,t),s.isOpsViewerWidgetLinked()?(n.notify("widgetLinked"),setTimeout((function(){w("GetAppStatus")}),100)):(o=p.getBuildUpCmd(),e.is(o)&&o.disable()),s.addEventListener("link",j),s.addEventListener("unlink",k),s.subscribeEvent("DS/DELExternalWidgetCom/onGetAppStatus",(function(e){!0===e.status?Y():s.subscribeEvent("DS/DELExternalWidgetCom/onAppReady",Y)})),s.subscribeEvent("DS/DELExternalWidgetCom/onDropData",Z),s.subscribeEvent("DS/DELExternalWidgetCom/onLoadDataComplete",Q),s.subscribeEvent("DS/DELExternalWidgetCom/onHome",K),s.subscribeEvent("DS/DELExternalWidgetCom/onSelect",$.bind({isSelected:!0})),s.subscribeEvent("DS/DELExternalWidgetCom/onUnSelect",$.bind({isSelected:!1})),s.subscribeEvent("DS/DELExternalWidgetCom/onUnHighlight",$.bind({isSelected:!1})),s.subscribeEvent("DS/DELExternalWidgetCom/onShow",te.bind({isDisplayed:!0})),s.subscribeEvent("DS/DELExternalWidgetCom/onHide",te.bind({isDisplayed:!1})),s.subscribeEvent("DS/DELExternalWidgetCom/onBuildUpActivated",ce.bind({isActivated:!0})),s.subscribeEvent("DS/DELExternalWidgetCom/onBuildUpDeactivated",ce.bind({isActivated:!1})),s.subscribeEvent("DS/DELExternalWidgetCom/onBuildUpActivateFailed",de),i()},onStop:function(){}}}}}));