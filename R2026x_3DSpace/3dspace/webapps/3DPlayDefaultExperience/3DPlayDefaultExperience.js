/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
var vcx=[];window.WebSystem||console.error("This file is loaded BEFORE 3DPlay runtime (3DPlayHelper) You may experience some issues"),window["3DPlay.AFRV2"]||vcx.push("DS/3DPlayDefaultExperience/PlayWebDictionary"),define("DS/3DPlayDefaultExperience/3DPlayDefaultExperience",["DS/3DPlayExperienceModule/PlayExperience3D","DS/Visualization/ThreeJS_DS","DS/Visualization/PathElement","DS/3DPlay/3DPlay","DS/3DPlay/3DPlayScenarioManager","DS/CoreEvents/Events","DS/3DPlayWAFRMigration/CommandsManager","DS/WebSystem/Rsc","DS/WebSystem/Nls","DS/Menu/ContextualMenu","DS/3DPlaySpecTree/3DPlaySpecTreePanel","DS/WebSystem/Settings","DS/WebSystem/Environment","DS/WebUtils/Tracker","DS/WebUtils/ContextedSingleton","DS/WebSystem/App","DS/3DPlayAnnotation3D/AnnotationManagerUtils","DS/3DPlayWAFRMigration/commandEnabler","DS/3DPlayCommands/ExplodeServices"].concat(vcx),(function(e,i,s,a,n,r,o,d,t,l,m,c,D,C,u,P,h,y,V,w){"use strict";return e.extend({init:function(e){var i=this;this._isSpecTreeAllowed=!0,D.isSet("3DPlay.DisableInherance")&&(e.commandApplication=!1,e.workbenchs=[{name:"3DPlayExperience3D",module:"3DPlayExperienceModule"}]),this.useSession=!0,this._parent(e),this.disposeFunctions.add((function(){i=null})),this.onload,this.EventDisposer.add(this.subscribe("ASSET/LOADINGFINISHED",(function(){var e=i.args&&i.args.input&&i.args.input.asset?i.args.input.asset:void 0;if("false"===c.get("3DPlay.SpecTree.Disabled","false")&&i.isSpecTreeAllowedForAsset(e)&&i.isSpecTreeAllowed()){var s=i.frmWindow,a=i.frmWindow.experience.getRootBag();if(void 0===i.specTreePanel){i.specTreePanel=new m({sceneRootBag:a,frameWindow:s}),i.specTreePanel.instanciateSpecTreePanel();var n=i.frmWindow&&i.frmWindow.getMAB();if(i.specTreePanel&&n){var r=!1;n.onVisibilityChangeSubscribe("PlayWeb-SpecTree",(function(e){!1===r&&"hidden"!==e?(i.specTreePanel&&i.specTreePanel._panelModel.panel.hide(),r=!0):!0===r&&"hidden"===e&&(i.specTreePanel&&i.specTreePanel._panelModel.panel.show(),r=!1)}))}}}}))),this.EventDisposer.add(this.subscribe("ASSET/LOADINGSTARTED",(function(){var e=i.frmWindow&&i.frmWindow.getMAB();e&&e.onVisibilityChangeUnsubscribe("PlayWeb-SpecTree")})))},clearView:function(){if(this.specTreePanel&&(this.specTreePanel.dispose(),this.specTreePanel=void 0),this.frmWindow){var e=this.frmWindow.getViewer();e&&0==e.getVisibleSpace()&&e.swapVisibleSpace()}this._parent()},isSpecTreeAllowed:function(e){return"boolean"==typeof e&&(this._isSpecTreeAllowed=e),this._isSpecTreeAllowed},isSpecTreeAllowedForAsset:function(e){return!(!(e=Array.isArray(e)?e[0]:e)||"3dxml"!==e.type||!(P.is3DDrive()||e.originalAsset&&"3DDRIVE"===e.originalAsset.provider)||"3dxml"!==e.originalType&&"catproduct"!==e.originalType&&void 0!==e.originalType)},addDictionaries:function(){if(w&&w.getNLSModules&&w.getNLSModules()&&(this._nlsToLoad||(this._nlsToLoad=[]),this._nlsToLoad=this._nlsToLoad.concat(w.getNLSModules())),w&&w.GetDictionary&&w.GetDictionary())return this._experienceBase.AddDictionaryDescription(w.GetDictionary())},dispose:function(e){this.specTreePanel&&(this.specTreePanel.dispose(),this.specTreePanel=void 0);var i=this.frmWindow&&this.frmWindow.getMAB();i&&i.onVisibilityChangeUnsubscribe("PlayWeb-SpecTree"),this.frmWindow.getContextualUIManager().unregister("3DPlayContextualID"),this.destroyAnnotationManager(),this._parent(e)},onPreCreate:function(){this.args&&(this.args.visu=this.args.visu||{},this.args.visu.showReferenceAxisSystem=!0),this.tabletMabModel={speeddial:[{id:"Reframe",rsc:"3DPlay/3DPlayExperience3D"},{id:"VisibilityCommands",rsc:"3DPlay/3DPlayExperience3D"},{id:"measure2CmdHdr",rsc:"DMUBaseCommands/3DPlayPro",hideAB:!0},{id:"section2CmdHdr",rsc:"DMUBaseCommands/3DPlayPro"},{id:"LockUnlockSectionHdr",rsc:"DMUBaseCommands/3DPlayPro"},{id:"AnnotationCommands",rsc:"3DPlay/3DPlayExperience3D"},{id:"AnnotationCommand3DText",rsc:"3DPlay/3DPlayExperience3D"}],sections:[{id:"Scenario",nls:"3DPlay/3DPlay",rsc:"3DPlay/3DPlay",hideAB:!0,showBack:!0},{id:"ViewSelector",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"EnhancedExplode",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"AnnotationTour",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"CameraViews",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuOrthographicView",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuPerspectiveView",rsc:"ViewerCommands/ViewerCommands"}]},{id:"Render",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuShading",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdgesNoSmoothEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdgesHiddenEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingMaterialEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingMaterial",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingIllustration",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuNoShadingEdges",rsc:"ViewerCommands/ViewerCommands"}]},{id:"Ambiance",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuPureWhiteOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuWhiteMirrorOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuWhiteReviewOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuWhiteExperienceOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuStudioOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuDarkMirrorOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuDarkReviewOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuWhiteDesignOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuBlueDesignOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuDarkDesignOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuIndoorOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuCityOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuRoadOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuOutdoorOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuBasicOCACmd",rsc:"ViewerCommands/ViewerCommands"}]},{id:"LineicFilter",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D"}]},this.mabModel={speeddial:[{id:"Reframe",rsc:"3DPlay/3DPlayExperience3D"},{id:"AnnotationCommands",rsc:"3DPlay/3DPlayExperience3D"},{id:"AnnotationCommand3DText",rsc:"3DPlay/3DPlayExperience3D"}],sections:[{id:"Scenario",nls:"3DPlay/3DPlay",rsc:"3DPlay/3DPlay",hideAB:!0,showBack:!0},{id:"ViewSelector",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"VisibilityCommands",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D"},{id:"EnhancedExplode",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"measure2CmdHdr",nls:"DMUBaseCommands/3DPlayPro",rsc:"DMUBaseCommands/3DPlayPro",hideAB:!0},{id:"section2CmdHdr",nls:"DMUBaseCommands/3DPlayPro",rsc:"DMUBaseCommands/3DPlayPro"},{id:"LockUnlockSectionHdr",nls:"DMUBaseCommands/3DPlayPro",rsc:"DMUBaseCommands/3DPlayPro"},{id:"AnnotationTour",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"CameraViews",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuOrthographicView",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuPerspectiveView",rsc:"ViewerCommands/ViewerCommands"}]},{id:"Render",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuShading",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdgesNoSmoothEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdgesHiddenEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingMaterialEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingMaterial",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingIllustration",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuNoShadingEdges",rsc:"ViewerCommands/ViewerCommands"}]},{id:"Ambiance",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuPureWhiteOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuWhiteMirrorOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuWhiteReviewOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuWhiteExperienceOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuStudioOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuDarkMirrorOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuDarkReviewOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuWhiteDesignOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuBlueDesignOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuDarkDesignOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuIndoorOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuCityOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuRoadOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuOutdoorOCACmd",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuBasicOCACmd",rsc:"ViewerCommands/ViewerCommands"}]},{id:"LineicFilter",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D"}]},this._hasLightbox||(this.mabModel.speeddial.push({id:"Share",icon:"3DPlay/assets/icons/32/I_3DSHAREShare.png",flyout:[]}),this.tabletMabModel.speeddial.push({id:"Share",icon:"3DPlay/assets/icons/32/I_3DSHAREShare.png",flyout:[]})),!0===D.isSet("3DPlay.NRPrototype.DebugCmd")&&(this.mabModel.speeddial[0]={id:"NR",rsc:"3DPlayWebNRCommands/3DPlayWebNRCommands",nls:"3DPlayWebNRCommands/3DPlayWebNRCommands"},this.tabletMabModel.speeddial[0]={id:"NR",rsc:"3DPlayWebNRCommands/3DPlayWebNRCommands",nls:"3DPlayWebNRCommands/3DPlayWebNRCommands"}),P.is3DPlay()&&!this._hasLightbox&&(this.mabModel.sections.push({id:"RightSidePanel",rsc:"PADUtils/PADUtils",nls:"PADUtils/PADUtils"}),this.tabletMabModel.sections.push({id:"RightSidePanel",rsc:"PADUtils/PADUtils",nls:"PADUtils/PADUtils"})),this.mabModelAR={speeddial:[{id:"AnnotationCommands",rsc:"3DPlay/3DPlayExperience3D"},{id:"Share",icon:"3DPlay/assets/icons/32/I_3DSHAREShare.png",flyout:[]}],sections:[{id:"Scenario",nls:"3DPlay/3DPlay",rsc:"3DPlay/3DPlay",hideAB:!0,showBack:!0},{id:"VisibilityCommands",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D"},{id:"EnhancedExplode",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"section2CmdHdr",nls:"DMUBaseCommands/3DPlayPro",rsc:"DMUBaseCommands/3DPlayPro"},{id:"LockUnlockSectionHdr",nls:"DMUBaseCommands/3DPlayPro",rsc:"DMUBaseCommands/3DPlayPro"},{id:"Render",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuShading",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdgesNoSmoothEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdgesHiddenEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingMaterialEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingMaterial",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingIllustration",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuNoShadingEdges",rsc:"ViewerCommands/ViewerCommands"}]}]},this._hasLightbox||(this.mabModel.speeddial[3].flyout=[{id:"ShareTo3DSwYm",rsc:"3DPlay/3DPlay"},{id:"SharePrint",rsc:"3DPlay/3DPlay"}],this.tabletMabModel.speeddial[7].flyout=[{id:"ShareTo3DSwYm",rsc:"3DPlay/3DPlay"},{id:"SharePrint",rsc:"3DPlay/3DPlay"}],(this.force3DComment||(P.is3DSwym()||P.is3DDrive()||P.is3DSpace()||P.is3DPlay())&&this.isCommentAvailable()&&!0!==this.share3DCommentHide)&&(this.mabModel.speeddial[3].flyout.unshift({id:"Share3DComment",rsc:"3DPlay/3DPlay"}),this.tabletMabModel.speeddial[7].flyout.unshift({id:"Share3DComment",rsc:"3DPlay/3DPlay"}))),navigator.userAgent.match(/Android|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i)||this._iOS||this._android||this.mabModel.sections[9].flyout.push({id:"VisuQMCommand",rsc:"ViewerCommands/ViewerCommands"}),D.isSet("3DPlay.VisuPanel")&&(this.mabModel.speeddial.push({id:"VisuViewPanelCommand",rsc:"ViewerCommands/ViewerCommands"}),this.tabletMabModel.speeddial.push({id:"VisuViewPanelCommand",rsc:"ViewerCommands/ViewerCommands"}))},onPostCreate:function(){var e=this,i=this.frmWindow.getViewer();V.init(this,i),this.commandEnabler.push(new y({cmdId:"EnhancedExplode",experience:this,event:"ASSET/LOADINGFINISHED/",callBack:V.isExplodeAvailable.bind(V)})),this.commandEnabler.push(new y({cmdId:"AnnotationTour",experience:this,event:"3DPLAY/ANNONATION/SESSION",defaultActivation:!1})),V.listenToSpread((function(){o.getCommand("EnhancedExplode",e.ctx).begin()}));let s=function(){var e=window.localStorage.getItem("3DPlay.TrackPadControl"),i="MouseControl";try{"true"===e?i="TrackPadControl":"false"===e&&(i="MouseControl");let s=o.getCommand(i,this.options.context);s?s.begin():console.log(`${i} not yet available`)}catch(e){console.log(`Unable to set controls (${i}) at experience launch:\n${e}`)}};this.frmWindow.onActionBarReady?this.frmWindow.onActionBarReady(s):s(),l.addEventListener(this.contextualMenuTarget(),{callback:e=>{var i=this.contextualMenuProps();if(i&&i.length&&this._enableCMenu&&this._rightClickIsInTheVoid(e.info.position))return new Promise((e=>{Promise.all(i).then((i=>{i.sort(((e,i)=>e.index-i.index)),i.forEach((e=>{e.submenu&&e.submenu.length&&e.submenu.sort(((e,i)=>e.index-i.index))})),e(i)})).catch((e=>{console.error("Failed to set 3DPlay contextual menu",e)}))})).catch((e=>{console.error("Failed to set 3DPlay contextual menu",e)}))}})},contextualMenuProps:function(){var e="true"==window.localStorage.getItem("3DPlay.TrackPadControl"),i=e?"mouse":"presentation-slide",s=e?"MouseControl":"TrackPadControl",a=this.mabModel.sections.find((e=>"Ambiance"==e.id));a.useRscIcon=!1;var n=[];return n.push(a),n.push({id:"VisuQMCommand",rsc:"ViewerCommands/ViewerCommands"}),navigator.userAgent.match(/Android|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i)||this._iOS||this._android||P.is3DSwym()||P.is3DDrive()||n.push({id:s,rsc:"3DPlay/3DPlayExperience3D",fonticon:{content:`wux-ui-3ds wux-ui-3ds-lg wux-ui-3ds-${i}`}}),n.map(((e,i)=>(e.index=i,e.submenu=e.flyout?e.flyout:[],e.submenu.forEach(((e,i)=>{e.index=i})),this.contextualMenuPropsFromCmd(e))))},contextualMenuPropsFromCmd:function(e){return void 0!==e.useRscIcon&&null!==e.useRscIcon||(e.useRscIcon=!0),new Promise(((i,s)=>{try{t.nls(e.rsc,e.id,(s=>{s||(s={});var a={id:e.id,index:e.index,type:"PushItem",title:s.Title,action:{callback:()=>{var i=o.getCommand(e.id,this.ctx);i?i.begin():console.log("Contextual menu: no command found")}}},n=()=>{e.fonticon?(a.fonticon=e.fonticon,i(a)):e.useRscIcon?d.rsc(e.rsc,{iconName:e.id,iconSize:"Normal"},(e=>{a.icon=e,i(a)})):i(a)};if(e.submenu&&e.submenu.length){var r=[];e.submenu.forEach((e=>{r.push(this.contextualMenuPropsFromCmd(e))})),Promise.all(r).then((e=>{a.submenu=e,n()}))}else n()}))}catch(e){s(e)}}))},contextualMenuTarget:function(){return this.frmWindow.getViewerFrame()},_rightClickIsInTheVoid:function(e){var s=this.frmWindow.getViewer(),a=o.getCommandCheckHeader("VCXVolatileGhostingCmd",this.ctx);if(!(a&&a._state||this._vcxVCXVolatileGhostingManager&&this._vcxVCXVolatileGhostingManager.hasVolatileGhostingToRestore())){var n=new i.Vector2(e.x,e.y),r=s.getMousePosition(n);return 0===s.pick(r,"mesh",!0).path.length}return!0},createAnnotationManager:function(){h.getAnnotationManager(this.ctx,this.frmWindow)},destroyAnnotationManager:function(){h.deleteAnnotationManager(this.ctx)},loadAsset:function(e,i,s,a){this.destroyAnnotationManager(),this.createAnnotationManager(),this._parent(e,i,s,a)}})})),define("DS/3DPlayDefaultExperience/PlayWebDictionary",[],(function(){"use strict";var e={VCXWebComponentOccurrence:{W3AISGNodeHolder:"DS/WebApplicationBase/W3AASGNodeHolder"},VCXVolatileGhostingManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"}},i={W3AIManager:"DS/WebApplicationBase/W3AIManager"},s={VCXVolatileGhostingManager:"DS/VCXWebVolatileGhosting/VCXVolatileGhostingManager"},a=["VCXWebVolatileGhosting/VCXWebVolatileGhosting"];return{GetDictionary:function(){return{interfaces:i,components:s,extensions:e}},getNLSModules:function(){return a}}}));