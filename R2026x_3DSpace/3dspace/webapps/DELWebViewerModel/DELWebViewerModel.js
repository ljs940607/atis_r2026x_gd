define("DS/DELWebViewerModel/Buildup/BuildUpSessionManager",["require","exports","DS/DELPXPProcessBuildUp/DELPXPProcessBuildUpAPI","DS/DELPXPSessionManager/DELPXPSessionManager"],(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this._sessionCache={},this._logger=e.getOption("logger")}async create(e){let t,r;this._logger.debug("DynamicBuildupOnCloud::creating session");try{t=e||(0,n.createPXPSession)(),r=await(0,i.connectProcessBuildUp)(t)}catch(e){throw this._logger.error("create PXP Session failed due to: "+e),e.code=e.message.includes("delmiamanufacturingcompute")?"DELVIEWER_W001":"DELVIEWER_E003",e}return this.set(t,r),this._logger.debug(`DynamicBuildupOnCloud::session created with session id: ${t}`),{id:t,session:r}}set(e,t){e&&(this._sessionCache[e]={session:t||null})}get(e){return this._sessionCache[e]}getNodeSessionInstance(e){let t=this._sessionCache[e]?this._sessionCache[e]:null;return t&&t.session?t.session:null}remove(e){delete this._sessionCache[e]}reset(){this._sessionCache={}}}})),define("DS/DELWebViewerModel/WKIModelService",["UWA/Core"],(function(e){"use strict";return function(t,i){const n="StepViewInfo";var r=i.getOption("mappingKeys"),s={getWKIContentPromise:function(n,s){return new e.Promise((function(o,a){e.is(n,"array")&&n.length>0&&s?t.getFileNameFromIndex(n,s).then((function(n){e.is(n,"string")?t.getFileContent(n,r.READERTYPE.TEXT).then(o).fail(a):r.FILETYPES.WKICONTENT===s?o(null):a(i.getNLSValue("FileNotFound",{fileType:s},"Error","Message"))})).fail(a):a(i.getNLSValue("Error.Message.InvalidInput"))}))},getCurrentStepViewInfo:function(){return t.get(n)},setCurrentStepViewInfo:function(e={}){e.viewInfo&&t.set(n,e.viewInfo)},getViewInfo:function(t){let i;if(t&&t.viewUUID){let n=s.getCurrentStepViewInfo();e.is(n,"array")&&(i=n.find((e=>e.UUID===t.viewUUID)))}return i},reset:function(){t.set(n)},destroy:function(){s.reset(),r=null}};return s}})),define("DS/DELWebViewerModel/WebService",["UWA/Core","DS/DELWebViewerUtils/DELWebViewerSettingsMgt","DS/WAFData/WAFData","DS/Logger/Logger","DS/DELWebViewerUtils/Utils","text!DS/DELWebViewerModel/assets/json/Webservices.json"],(function(e,t,i,n,r,s){"use strict";var o,a=function(){return{request:function(s){return new e.Promise((function(o,a){var l,u={Accept:"application/json, text/plain, application/octet-stream",SecurityContext:t.getSetting("pad_security_ctx")?t.getSetting("pad_security_ctx"):"preferred","Content-Type":"application/json"};e.is(s,"object")?(e.is(s.headers)&&Object.assign(u,s.headers),(l=new URL(s.url)).searchParams.set("tenant",r.getPlatformId()),i.authenticatedRequest(l.toString(),{method:s.method?s.method:"",type:s.dataType?s.dataType:"",data:s.payload?e.Json.encode(s.payload):"",headers:u,timeout:t.getSetting("webapi_timeout"),proxy:"none",onComplete:function(e){o(e)},onTimeout:function(e,t){n.error("WebService Call failed due to - "+e),a(t)},onFailure:function(e,t){n.error("WebService Call failed due to - "+e),a(t)}})):(n.error("WebService Request Input not found."),a("Error.InvalidInput.Message"))}))},getPublishedRepDocument:async function(e){let t,i=JSON.parse(s).getPublishedRepDocument;return e&&(i.payload.batch.expands[0].root.physical_id=e,i.url=r.get3DSpaceUrl()+i.url,t=await o.request(i)),t}}};return e.is(o)||(o=new a),o})),define("DS/DELWebViewerModel/Buildup/BuildUpSettings",["UWA/Core","DS/Logger/Logger","text!DS/DELWebViewerModel/assets/json/BuildUpCategoriesMap.json"],(function(e,t,i){"use strict";var n,r=function(){const n=JSON.parse(i),r="Color",s="WithTransparency",o="TransparencyCoefficient",a="IsDisplayed",l="WithColor",u="TRUE",d="FALSE",c="resource",p="all",f="all_onlyassignedresources",g="capableresource";return{getParsedBuildUpSettings:function(t){var i,n,s,o={};if(e.is(t,"object"))for(n in(i={...t}).DisplayOptions)i.DisplayOptions.hasOwnProperty(n)&&(s=n.toLowerCase(),e.is(o[s],"object")||(o[s]={}),o[s].visibility=i.DisplayOptions[n].IsDisplayed===u,o[s].opacity=i.DisplayOptions[n].WithTransparency===u?Number(i.DisplayOptions[n].TransparencyCoefficient):255,o[s].color=i.DisplayOptions[n].WithColor===u&&i.ColorOptions.WithColor===u?i.ColorOptions[r+n]:null,o[s].withColor=i.DisplayOptions[n].WithColor===u,o[s].filter=i.DisplayOptions[n].Filter?i.DisplayOptions[n].Filter:null);return o},getGraphicProperties:function(t,i){var n;return e.is(t,"object")&&i&&(n=i===p||i===f||i===g?t[c]:t[i]),n},getCategory:function(e){return e&&e===p||e===f||e===g?c:e},isBuildUpColorsEnabled:function(e){let t=!1;return e&&e.ColorOptions&&(t=e.ColorOptions.WithColor===u),t},getCategoryColor:function(e,t){if(e&&e.ColorOptions)return e.ColorOptions[`${r}${n[t]}`]},updateBuildUpColorSettings:function(e,t){return e&&e.ColorOptions&&(e.ColorOptions.WithColor=t?u:d),e},updateBuildUpDisplayCategorySettings:function(e,t,i){return e&&t&&i&&Object.keys(i).forEach((c=>{let p=n[t];if(p)switch(c){case"color":e.ColorOptions&&(e.ColorOptions[`${r}${p}`]=i[c]);break;case"opacity":e.DisplayOptions[`${p}`]&&(e.DisplayOptions[`${p}`][s]=u,e.DisplayOptions[`${p}`][o]=i[c]);break;case"visibility":e.DisplayOptions[`${p}`]&&(e.DisplayOptions[`${p}`][a]=i[c]?u:d);break;case"withColor":e.DisplayOptions[`${p}`]&&(e.DisplayOptions[`${p}`][l]=i[c]?u:d)}})),e},getFTAVisibility:function(e){let t=!1;return e&&e.GeneralOptions&&(t=e.GeneralOptions.WithFTA===u),t},updateGeneralOptions:function(e,t,i){e&&e.GeneralOptions&&e.GeneralOptions[t]&&(e.GeneralOptions[t]=i?u:d)},updateBuildUpOptions:function(e,t){switch(t.buildUpSettingsType){case"DisplayOptions":this.updateBuildUpDisplayCategorySettings(e,t.category,t.settings);break;case"GeneralOptions":this.updateGeneralOptions(e,t.option,t.value)}},getGraphicsPropertiesForFTA:function(e){return{color:{R:"0",G:"0",B:"0"},visibility:this.getFTAVisibility(e)}},isValidSettings:function(i){let n=!1;try{n=e.is(JSON.stringify(i))}catch(e){t.error(e),n=!1}return n}}};return e.is(n)||(n=new r),n})),define("DS/DELWebViewerModel/facets/DELWkiInstructionsFacetModel",["UWA/Core","DS/DELWebViewerModel/WebService","DS/DELWebViewerUtils/Utils","text!DS/DELWebViewerModel/assets/json/Webservices.json"],(function(e,t,i,n){"use strict";return function(){return{getData:async function(r){var s,o,a;return"businessobject"!==r.get("metatype")&&"bus"!==r.get("metatype")||(s=r.get("objectId"),o=await async function(n){var r=null,s=`${i.get3DSpaceUrl()}/cvservlet/fetch/v2`,o={label:"Fetch-V2-"+Date.now(),physicalid:[n],locale:"en",select_predicate:["ds6w:type"]},a=await t.request({url:s,method:"POST",dataType:"json",payload:o});return a&&e.is(a.results,"array")&&a.results.forEach((t=>{e.is(t.attributes,"array")&&t.attributes.forEach((e=>{"ds6w:type"===e.name&&(r=e.value)}))})),r}(s),a=await async function(e,r){var s,o,a=JSON.parse(n).WorkInstructionsTypes;return a[r]&&(s=`${i.get3DSpaceUrl()}${a[r].url.replace("{ID}",e)}`,o=await t.request({url:s,method:"GET",dataType:"json"})),{response:o,type:r}}(s,o)),a}}}}));var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/DELWebViewerModel/Buildup/AbstractBuildup",["require","exports","UWA/Core","DS/DELWebViewerModel/WebService","DS/DELWebViewerUtils/Utils","DS/DELWebViewerModel/Buildup/BuildUpSettings","text!DS/DELWebViewerModel/assets/json/GlobalBuildupSettings.json"],(function(e,t,i,n,r,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=__importDefault(o);class a{constructor(e,t){this._defaultBuildUpSettings=o.default,this.MAPPINGKEYS=t.getOption("mappingKeys"),this._logger=t.getOption("logger"),this._modelCtrlEventHnd=t.getOption("eventCollection").getModelCtrlEventHnd(),this._eventTokens=[],this._dataManager=e,this._options=t}_activateBuildUpPersistence(){this._eventTokens.forEach((e=>{this._modelCtrlEventHnd.unSubscribe(e)})),this._eventTokens.push(this._modelCtrlEventHnd.subscribe(this._modelCtrlEventHnd.events.onSetBuildUpGlobalSettingsComplete,(function(e){if(e){(0,r.getWidget)().setValue(a.BUILDUPENUM.buildUpGlobalSettings,JSON.stringify(e))}})))}_initializeBuildUpSettings(e={}){var t,i,n=this;if(this._options.getOption("persistBuildUpSettings")){let n=(0,r.getWidget)();this._activateBuildUpPersistence(),e.clear&&n.setValue(a.BUILDUPENUM.buildUpGlobalSettings),(i=n.getValue(a.BUILDUPENUM.buildUpGlobalSettings))&&(t=JSON.parse(i))}return t&&0!==Object.keys(t).length||"string"!=typeof n._defaultBuildUpSettings||(t=JSON.parse(n._defaultBuildUpSettings)[n.MAPPINGKEYS.BUILDUPKEYS.BUILDUPSETTINGS]),this.setBuildUpGlobalSettings({settings:t}),t}_makeRequest(e,t){return(0,n.request)({url:e,method:"POST",dataType:"json",payload:t})}_getBuildUpContext(e){let t=`${(0,r.get3DSpaceUrl)()}/resources/v2/delviewerservices/private/invoke/getBuildUpContext`,i=this,s=Object.assign({},e);return(0,n.request)({url:t,method:"POST",dataType:"json",payload:s}).then((function(e){return e&&e.results&&e.results.mfgContext&&i._dataManager.set("buildupContext",e.results.mfgContext),e&&e.results&&e.results.resourceContext&&i._dataManager.set("resourceContext",e.results.resourceContext),e}))}_initializeWKI(e){let t=this;2===t._options.getOption("viewerType")&&this._dataManager.loadProcess(e).fail((e=>{t._logger.warn(e)}))}_getPredecessors(){let e=[],t=this.getProcessInfo();return t&&t.predecessors&&t.predecessors.length>0&&t.predecessors.forEach((function(t){e.push({path:t,category:"previousfromprevioussystem",position:""})})),e}_getContext(e=[]){var t=this,n=this._dataManager.get("buildupContext")||[];return(0,i.is)(e,"array")&&e.length>0&&(n=[],e.forEach((function(e){(0,i.is)(e,"array")&&e.length>0&&n.push({[t.MAPPINGKEYS.BUILDUPKEYS.PATH]:e,[t.MAPPINGKEYS.BUILDUPKEYS.CATEGORY]:t.MAPPINGKEYS.BUILDUPCATEGORY.Context})}))),n}async _parseBuildupContent(e,t){var n=this,r=(this._dataManager.get("process"),[]),s=[],o=[],a=this._getContext(t),l=this._getPredecessors()||[],u=function(e,t,r){let s=[];return(0,i.is)(e,"array")&&e.length>0&&e.forEach((function(e){if((0,i.is)(e.objectinstancepath,"array")&&e.objectinstancepath.length>0){var o={},a=n.MAPPINGKEYS.BUILDUPCATEGORY[e.bucategory];o[n.MAPPINGKEYS.BUILDUPKEYS.PATH]=e.objectinstancepath,a&&(o[n.MAPPINGKEYS.BUILDUPKEYS.CATEGORY]=a),o[n.MAPPINGKEYS.BUILDUPKEYS.ISSYMBOLIC]=!(!e||!e.isSymbolic),o[n.MAPPINGKEYS.GRAPHICPROPERTIES.VISIBILITY]=!(!a&&!r)&&t,o[n.MAPPINGKEYS.GRAPHICPROPERTIES.VISIBILITYFREE]=!a&&!r||!t,o[n.MAPPINGKEYS.GRAPHICPROPERTIES.POSITION]=e[n.MAPPINGKEYS.GRAPHICPROPERTIES.OVERRIDEPOSITION]?e[n.MAPPINGKEYS.GRAPHICPROPERTIES.OVERRIDEPOSITION].toString():"",s.push(o)}})),s};return e&&(r=u(e[n.MAPPINGKEYS.BUILDUPKEYS.OBJECTSTOSHOW],!0,!1),s=u(e[n.MAPPINGKEYS.BUILDUPKEYS.OBJECTSTOHIDE],!1,!1),o=u(e[n.MAPPINGKEYS.BUILDUPKEYS.BUILDUPPOSITIONS],!0,!0)),{mfgAndResourceBuildup:s.concat((n._dataManager.get("resourceContext")||[]).map((function(e){return{path:e.path,visibility:!1,visibilityFree:!0}})),a,l,r,o),ftaBuildup:[]}}setBuildUpGlobalSettings(e={}){if(!e.settings||!(0,s.isValidSettings)(e.settings))throw this._logger.log("property settings is not available/ or is not a valid settings, please check the input"),new Error(this._options.getNLSValue("Error.InvalidInput.Message"));this._dataManager.set(a.BUILDUPENUM.buildUpGlobalSettings,e.settings),e.default&&(this._defaultBuildUpSettings=JSON.stringify({[this.MAPPINGKEYS.BUILDUPKEYS.BUILDUPSETTINGS]:e.settings}))}updateBuildUpSettings(e){return this._initializeBuildUpSettings(e)}getBuildUpGlobalSettings(){let e=this._dataManager.get(a.BUILDUPENUM.buildUpGlobalSettings);return e||this._initializeBuildUpSettings()}async initialize(e){let t=this;return this._options.getOption("dynamicBuildUp")?await UWA.Promise.all([t._getBuildUpContent(e),t._getBuildUpContext(e)]):(await t._getBuildUpContent(e),await t._getBuildUpContext(e)),t._initializeWKI(e),t._initializeBuildUpSettings(e)}async getBuildUp(e){let t=await this._fetchBuildUpContent(e);return this._parseBuildupContent(t,e.context)}getProcessInfo(){return this._dataManager.get("process")}setSessionId(e){return this._dataManager.set("processSessionId",e)}getSessionId(){return this._dataManager.get("processSessionId")}getFTAReqsPaths(){return[]}getScopedMfgsIds(){return[]}isBuildupAvailableForContext(e){return!1}getPathFromBuildupDef(e,t){return null}isObjectAvailable(e){return!1}reset(){this._dataManager.set("buildupContext",null),this._dataManager.set("buildupContent",null)}destroy(){this.reset()}}a.BUILDUPENUM={capableResource:"capableresource",buildUpGlobalSettings:"BuildUpGlobalSettings"},t.default=a})),define("DS/DELWebViewerModel/Zip",["UWA/Core","DS/ZipJS/zip-fs","DS/VisuUnstreamers/FileInZipStreamObject","DS/DELWebViewerUtils/Utils","DS/Logger/Logger","DS/DELWebViewerModel/WebService"],(function(e,t,i,n,r,s){"use strict";var o,a=function(){var o,a,l=function(){return new e.Promise((function(e,t){o?e():t("Error.ZipNotInit.Message")}))};return{init:function(e){var t=e.getOption("mappingKeys");t&&(o=t.DOCUMENTKEYS),a=e.getOption("logger")},fetchProcessData:function(t={}){var i=this,r=t.id,u=n.get3DSpaceUrl(),d=function(){return`timestamp=${(new Date).getTime()}`},c=function(){let i,n=t.publishedRep&&t.publishedRep.id;return i=n?e.Promise.resolve(n):s.getPublishedRepDocument(r).then((function(t){let i,n;return e.is(t,"object")&&e.is(t.results,"array")&&t.results.length>0&&(n=t.results.find((e=>e.type===o.DOCUMENTTYPE)),n&&(i=n.resourceid)),i})),i},p=function(t){return new e.Promise((function(i,n){var r;e.is(t)?(r=`${u}/resources/v1/modeler/documents/${t}/files/DownloadTicket?${d()}`,function(){var e=`${u}/resources/v1/application/CSRF?${d()}`;return s.request({url:e,method:"GET",dataType:"json"})}().then((function(e){return s.request({url:r,method:"PUT",dataType:"json",headers:{ENO_CSRF_TOKEN:e.csrf.value}})})).then(i).fail(n)):(a.debug("Document id not found. Ensure workplan is published correctly."),n("Error.PublishedContentNotFound.Message"))}))},f=function(t){return new e.Promise((function(n,r){e.is(t)&&e.is(t.data,"array")&&e.is(t.data[0].dataelements.ticketURL)?s.request({url:t.data[0].dataelements.ticketURL,method:"GET",dataType:"blob"}).then((function(s){var l;e.is(t.data[0].dataelements.fileNames,"array")?(l=t.data[0].dataelements.fileNames.find((function(e){return-1!==e.indexOf(o.FILETYPE)})),e.is(l)?i.getFileNameFromZipBlob(s,l).then((function(e){i.getFileContent(s,e,"BLOB").then(n).fail(r)})).fail(r):(a.debug("Viewer Zip content file not found. Ensure workplan is published correctly."),r("Error.PublishedContentNotFound.Message"))):(a.debug("File names not found. Ensure workplan is published correctly."),r("Error.PublishedContentNotFound.Message"))})).fail(r):(a.debug("FCS URL not found. Ensure workplan is published correctly."),r("Error.PublishedContentNotFound.Message"))}))},g=function(t){return new e.Promise((function(n,r){e.is(t)&&t.size>0?i.getFileNameFromZipBlob(t,o.INDEXFILESUFFIX).then((function(n){var r;return n?r=i.getFileContent(t,n,"TEXT"):(a.debug("Index file is invalid in published content. Ensure workplan is published correctly."),r=e.Promise.reject("Error.PublishedContentNotFound.Message")),r})).then((function(i){e.is(i)?n({zipBlob:t,indexFile:i}):(a.debug("Index file is invalid in published content. Ensure workplan is published correctly."),r("Error.PublishedContentNotFound.Message"))})).fail(r):(a.debug("Published content not found for given workplan. Ensure workplan is published correctly"),r("Error.PublishedContentNotFound.Message"))}))};return new e.Promise((function(e,t){r?l().then(c).then(p).then(f).then(g).then(e).fail(t):t("Error.InvalidInput.Message")}))},getFileContent:function(t,n,s){var o={BLOB:function(e,t){e.readAsBlob(t)},TEXT:function(e,t){e.readAsText(t)}};return new e.Promise((function(a,u){l().then((function(){var l,d=o[s];d?(d(l=new i(t,n),(function(t){try{"TEXT"===s&&(t=JSON.parse(t)),e.is(t)?a(t):u("Error.FileContentNotFound.Message")}catch(e){r.error("File content extraction failed due to - "+e),u("Error.FileContentExtractionFailed.Message")}})),l.close()):u("Error.InvalidReaderType.Message")})).fail(u)}))},getFileNameFromZipBlob:function(i,n){return new e.Promise((function(r,s){l().then((function(){i&&n?t.createReader(new t.BlobReader(i),(function(t){t.getEntries((function(t){t.length>0?r(function(t,i){var n,r;for(n=0;n<t.length;++n)if(e.is(t[n].filename)&&(t[n].filename===i.trim()||t[n].filename.indexOf(i)>0)){r=t[n].filename;break}return r}(t,n)):s("Error.NoEntriesInZipBlob.Message")}))}),s):s("Error.FilenameNotFound.Message")})).fail(s)}))},getFileName:function(t,i,n){return new e.Promise((function(r,s){l().then((function(){var s,o,a,l,u;if(e.is(t,"object")&&e.is(i,"array")&&i.length>0&&n&&(s=t.occurrences,e.is(s,"array")))for(o=0;o<s.length;o++)if(e.Array.equals(s[o].pathIds,i)){for(u=s[o].files,a=0;a<u.length;a++)if(u[a].type===n){l=u[a].name;break}break}r(l)})).fail(s)}))},getOperationPath:function(t,i){return new e.Promise((function(e,n){l().then((function(){var r;t&&i&&(r=t.occurrences.find((function(e){return!!(e.pathIds&&e.pathIds.length>1)&&(e.pathIds[e.pathIds.length-1]===i||e.pathIds[e.pathIds.length-2]===i)}))),r?e(r.pathIds):n("Error.StepPathInvalid.Message")})).fail(n)}))},dispose:function(){o=a=null}}};return e.is(o)||(o=new a),o}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/DELWebViewerModel/Buildup/PublishedBuildup",["require","exports","UWA/Core","DS/DELWebViewerModel/Buildup/AbstractBuildup"],(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importDefault(n);class r extends n.default{constructor(e,t){super(e,t),this._buildUpDef,this._mfgAndResourcePaths=[],this._ftaPaths=[],this.BUILDUPDEFKEYS=this.MAPPINGKEYS.BUILDUPKEYS.BUILDUPDEFKEYS,this.GRAPHICKEYS=this.MAPPINGKEYS.GRAPHICPROPERTIES}_cachePaths(e,t=[]){let n=this;n._buildUpDef&&(0,i.is)(e,"array")&&e.forEach((e=>{if((0,i.is)(n._buildUpDef[e],"object")){let r,s=Object.values(n._buildUpDef[e]);for(r of s){let e=r[n.MAPPINGKEYS.BUILDUPKEYS.PATHIDS];(0,i.is)(e,"array")&&e.length>0&&t.push(e.toString())}}}))}async _initializeBuildUpSettings(e={}){var t,i=this,n=e.id,r=i._options.getOption("persistBuildUpSettings");if(t=await super._initializeBuildUpSettings(e),!r||e.clear){let e,r=await i._dataManager.getFileNameFromIndex([n],i.MAPPINGKEYS.FILETYPES.BUILDUPSETTINGS);if(!r)throw new Error(i._options.getNLSValue("FileNotFound",{fileType:i.MAPPINGKEYS.FILETYPES.BUILDUPSETTINGS},"Error","Message"));e=await i._dataManager.getFileContent(r,i.MAPPINGKEYS.READERTYPE.TEXT),t=e[i.MAPPINGKEYS.BUILDUPKEYS.BUILDUPSETTINGS],i.setBuildUpGlobalSettings({settings:t})}return t}_initializeWKI(e){}async _getBuildUpContext(e){var t=this;let n=await new UWA.Promise((function(e,n){t._dataManager.getFileNameFromZipBlob(t.MAPPINGKEYS.FILENAMES.BUILDUPDEF+".").then((function(e){return e?t._dataManager.getFileContent(e,t.MAPPINGKEYS.READERTYPE.TEXT):UWA.Promise.reject(t._options.getNLSValue("FileNotFound",{fileType:t.MAPPINGKEYS.FILENAMES.BUILDUPDEF},"Error","Message"))})).then((function(r){var s;(0,i.is)(r,"object")?(t._buildUpDef=r,t._cachePaths(Object.values(t.BUILDUPDEFKEYS),t._mfgAndResourcePaths),e(r)):(s=t._options.getNLSValue("FileContentNotFound",{fileContentType:t.MAPPINGKEYS.FILENAMES.BUILDUPDEF+"Content"},"Error","Message"),t._logger.error(s),n(s))})).fail((function(e){t._logger.error(e),n(e)}))}));var r;await(r=n,new UWA.Promise((function(e,n){t._dataManager.getFileNameFromZipBlob(t.MAPPINGKEYS.FILETYPES.BUILDUPCONTEXT+".").then((function(e){return e?t._dataManager.getFileContent(e,t.MAPPINGKEYS.READERTYPE.TEXT):UWA.Promise.reject(t._options.getNLSValue("FileNotFound",{fileType:t.MAPPINGKEYS.FILETYPES.BUILDUPCONTEXT},"Error","Message"))})).then((function(s){var o,a=[];(0,i.is)(s,"object")?(s.mfgItemsBuildUp.forEach((function(e){var i=e.Id?e.Id:"",n={};n[t.MAPPINGKEYS.BUILDUPKEYS.PATH]=r[t.BUILDUPDEFKEYS.MFGITEMS][i][t.MAPPINGKEYS.BUILDUPKEYS.PATHIDS],n[t.MAPPINGKEYS.BUILDUPKEYS.CATEGORY]=e[t.MAPPINGKEYS.BUILDUPKEYS.CATEGORY],a.push(n)})),t._dataManager.set("buildupContext",a),e(a)):(o=t._options.getNLSValue("FileContentNotFound",{fileContentType:t.MAPPINGKEYS.FILETYPES.BUILDUPCONTEXT+"Content"},"Error","Message"),t._logger.error(o),n(o))})).fail((function(e){t._logger.error(e),n(e)}))})))}async _getBuildUpContent(e){await this._dataManager.loadProcess(e).catch((e=>{this._logger.error("Buildup initialization(_getBuildUpContent) failed due to: "+e);let t=new Error(e);throw t.code="DELVIEWER_W002",t}))}async _fetchBuildUpContent(e){let t=this;return await(n=t._buildUpDef,new UWA.Promise((function(r,s){var o,a=e.path;(0,i.is)(a,"array")&&a.length>0&&t._dataManager.getFileNameFromIndex(a,t.MAPPINGKEYS.FILETYPES.BUILDUPCONTENT).then((function(e){(0,i.is)(e,"string")?t._dataManager.getFileContent(e,t.MAPPINGKEYS.READERTYPE.TEXT).then((function(e){r({buildUp:e,buildUpDef:n})})).fail(s):(o=t._options.getNLSValue("FileNotFound",{fileType:t.MAPPINGKEYS.FILETYPES.BUILDUPCONTENT},"Error","Message"),t._logger.error(o),s(o))})).fail(s)})));var n}async _parseBuildupContent(e,t){let n=this,r=await(s=e,new UWA.Promise((function(e){var t,r,o=[],a=[],l=n._getContext(),u=n._getPredecessors()||[];let d=n.MAPPINGKEYS.BUILDUPKEYS.PATH,c=n.MAPPINGKEYS.BUILDUPKEYS.CATEGORY,p=n.MAPPINGKEYS.BUILDUPKEYS.POSITION,f=n.MAPPINGKEYS.BUILDUPKEYS.ISSYMBOLIC,g=n.MAPPINGKEYS.BUILDUPKEYS.TYPE,P=function(e={},t={},i){var r=t.Id?t.Id:"";r&&(e[d]=n.getPathFromBuildupDef(i,r),e[f]="TRUE"===t[f],e[c]=t[c],e[p]=t[n.MAPPINGKEYS.BUILDUPKEYS.MODEL.POSITION],e[g]=i)};if((0,i.is)(s.buildUp,"object")&&(0,i.is)(s.buildUpDef,"object")){for(t in n.BUILDUPDEFKEYS)n.BUILDUPDEFKEYS.hasOwnProperty(t)&&(r=n.BUILDUPDEFKEYS[t]+n.MAPPINGKEYS.BUILDUPKEYS.BUILDUP,(0,i.is)(s.buildUp[r],"array")&&s.buildUp[r].length>0&&s.buildUp[r].forEach((function(e){let i={};P(i,e,n.BUILDUPDEFKEYS[t]),o.push(i)})));if(!0===n._options.getOption("requirementFTA")){let e=n.MAPPINGKEYS.BUILDUPKEYS.FTAREQ,t=n.MAPPINGKEYS.BUILDUPKEYS.FTAREQ+n.MAPPINGKEYS.BUILDUPKEYS.BUILDUP,r=n.MAPPINGKEYS.BUILDUPKEYS.FTAGEOMID;n._ftaPaths.length>0||n._cachePaths([n.MAPPINGKEYS.BUILDUPKEYS.FTAREQ],n._ftaPaths),(0,i.is)(s.buildUp[t],"array")&&s.buildUp[t].length>0&&s.buildUp[t].forEach((function(t){let i={};P(i,t,e),i[r]=s.buildUpDef[e][t.Id][r],a.push(i)}))}e({mfgAndResourceBuildup:l.concat(u,o),ftaBuildup:a})}})));var s,o;return await(o=r,new UWA.Promise((function(e){(0,i.is)(o.mfgAndResourceBuildup,"array")&&(o.mfgAndResourceBuildup=o.mfgAndResourceBuildup.concat(function(){let e=o.mfgAndResourceBuildup,t=new Set,i=new Set,r=[];return e.forEach((e=>{let r=e[n.MAPPINGKEYS.BUILDUPKEYS.PATH].slice();t.add(r.toString());let s=r.splice(0,r.length-2);for(;s&&s.length>0;)i.add(s.toString()),s=s.splice(0,s.length-2)})),r=n._mfgAndResourcePaths.filter((e=>{let n=!1;if(n=t.has(e)||i.has(e),!0===n)return!n;let r=function(e){let t=e.split(",");return t.slice(0,t.length-2).toString()},s=r(e);for(;s&&s.length>0&&(n=t.has(s),!0!==n);)s=r(s);return!n})).map((e=>({[n.MAPPINGKEYS.BUILDUPKEYS.PATH]:e.split(","),[n.GRAPHICKEYS.VISIBILITY]:!1,[n.GRAPHICKEYS.VISIBILITYFREE]:!0}))),r}())),(0,i.is)(o.ftaBuildup,"array")&&(o.ftaBuildup=o.ftaBuildup.concat(function(){let e=o.ftaBuildup,t=new Set,i=[];return e.forEach((e=>{let i=e[n.MAPPINGKEYS.BUILDUPKEYS.PATH].slice();t.add(i.toString())})),i=n._ftaPaths.filter((e=>!t.has(e))).map((e=>({[n.MAPPINGKEYS.BUILDUPKEYS.PATH]:e.split(","),[n.GRAPHICKEYS.VISIBILITY]:!1,[n.GRAPHICKEYS.VISIBILITYFREE]:!0}))),i}())),e(o)})))}getFTAReqsPaths(){return this._ftaPaths.map((e=>e.split(",")))}getScopedMfgsIds(){let e;return this._buildUpDef&&(0,i.is)(this._buildUpDef[this.MAPPINGKEYS.BUILDUPKEYS.BUILDUPDEFKEYS.SCOPEDMBOMS],"array")&&(e=this._buildUpDef[this.MAPPINGKEYS.BUILDUPKEYS.BUILDUPDEFKEYS.SCOPEDMBOMS]),e}isBuildupAvailableForContext(e){let t=!1;return(0,i.is)(this._mfgAndResourcePaths,"array")&&this._mfgAndResourcePaths.length>0&&(t=this._mfgAndResourcePaths.some((t=>t.split(",")[0]===e))),t}getPathFromBuildupDef(e,t){return this._buildUpDef&&this._buildUpDef[e]&&this._buildUpDef[e][t]&&this._buildUpDef[e][t][this.MAPPINGKEYS.BUILDUPKEYS.PATHIDS]?this._buildUpDef[e][t][this.MAPPINGKEYS.BUILDUPKEYS.PATHIDS]:null}isObjectAvailable(e){return!!(this._buildUpDef&&this._buildUpDef[e]&&Object.keys(this._buildUpDef[e]).length>0)}reset(){this._buildUpDef=null,this._mfgAndResourcePaths=[],super.reset()}}t.default=r}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/DELWebViewerModel/Buildup/BuildupFromExternalContent",["require","exports","DS/DELWebViewerModel/Buildup/AbstractBuildup"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);class n extends i.default{_getBuildUpContent(e){}_fetchBuildUpContent(e){if(!e||!e.buildUpContent){let e=new Error("Viewer option useBuildFromExternalContent is used, but build up content is not provided in activate build up handler");throw e.code="DELVIEWER_E004",e}return e.buildUpContent}async _getBuildUpContext(e){}constructor(e,t){super(e,t),this._componentOptions=t}}t.default=n}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/DELWebViewerModel/Buildup/DynamicBuildupOnCloud",["require","exports","UWA/Core","DS/DELWebViewerUtils/Utils","DS/DELWebViewerModel/Buildup/AbstractBuildup","DS/DELPXPProcessBuildUp/DELPXPProcessBuildUpAPI","DS/DELPXPMfgModelers/DELPXPMfgModelersAPI","DS/DELWebViewerModel/Buildup/BuildUpSessionManager"],(function(e,t,i,n,r,s,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=__importDefault(r),a=__importDefault(a);class l extends r.default{constructor(e,t){super(e,t),this._buildUpParams=new s.DELPXPBuildUpParams,this._buildupSessionManager=new a.default(t),this._buildUpParams.setDiffOperator(!0),this._buildUpParams.setPositionSolver(!0)}async _getBuildUpContent(e){var t=this,i=Object.assign({},e);t._logger.debug("DynamicBuildupOnCloud::initialize method invoked with parameters : ",e);try{let e=await async function(){let e=`${(0,n.get3DSpaceUrl)()}/resources/v2/delviewerservices/private/invoke/initBuildup`;return t._makeRequest(e,i)}(),r=JSON.stringify(e),s=await t._buildupSessionManager.create(),a=(0,o.GetMfgModelers)(s.session);t.setSessionId(s.id),t._logger.debug(`DynamicBuildupOnCloud::initialize build up using ${r}`),await a.load(r),t._logger.debug("DynamicBuildupOnCloud::Build up initialized")}catch(e){throw t._logger.error("Buildup initialization failed. Failed to load Buildup due to: "+e),e.code||(e.code="DELVIEWER_E002"),e}}async _fetchBuildUpContent(e){let t,n,r,o=this,a=e||{},l=e.id,u=e.scopedMfg&&e.scopedMfg.id?e.scopedMfg.id:null,d=a.session&&a.session.id?a.session.id:null,c=a&&(0,i.is)(a.path,"array")?a.path:[],p=o._buildupSessionManager.getNodeSessionInstance(d);if(!p){p=(await o._buildupSessionManager.create(d)).session}r=(0,s.GetProcessBuildUpAPI)(p),t=new s.DELPXPBuildUpSelection([c],l,u,"","2.0");try{n=await r.queryBuildUpSelection(t,o._buildUpParams)}catch(e){throw o._buildupSessionManager.remove(d),o._logger.error("selection Call failed due to: "+e),e.code||(e.code="DELVIEWER_E003"),e}return n}}t.default=l})),define("DS/DELWebViewerModel/DataManager",["UWA/Core","DS/DELWebViewerModel/Zip"],(function(e,t){"use strict";return function(i){var n={zip:{}},r=i.getOption("eventCollection").getModelCtrlEventHnd();return t.init(i),{get:function(e){return n[e]?n[e]:null},set:function(t,i){e.is(t)&&(n[t]=i,r.publish(`onSet${t}Complete`,i))},reset:function(){n={zip:{}}},destroy:function(){n={zip:{}},t.dispose()},loadProcess:function(r={}){return new e.Promise((function(e,s){t.fetchProcessData(r).then((function(t){n.zip=t,e(t)})).fail((function(e){s(i.getNLSValue(e))}))}))},getFileNameFromIndex:function(r,s){return new e.Promise((function(e,o){t.getFileName(n.zip.indexFile,r,s).then(e).fail((function(e){o(i.getNLSValue(e))}))}))},getFileNameFromZipBlob:function(r){return new e.Promise((function(e,s){return t.getFileNameFromZipBlob(n.zip.zipBlob,r).then(e).fail((function(e){s(i.getNLSValue(e))}))}))},getFileContent:function(r,s){return new e.Promise((function(e,o){t.getFileContent(n.zip.zipBlob,r,s).then(e).fail((function(e){o(i.getNLSValue(e))}))}))},getOperationPath:function(r){return new e.Promise((function(e,s){n&&n.zip?t.getOperationPath(n.zip.indexFile,r).then(e).fail((function(e){s(i.getNLSValue(e))})):s(i.getNLSValue("Error.ProcessNotSet.Message"))}))}}}}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/DELWebViewerModel/Buildup/DynamicBuildupOnPremise",["require","exports","UWA/Core","DS/DELWebViewerUtils/Utils","DS/DELWebViewerModel/Buildup/AbstractBuildup"],(function(e,t,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=__importDefault(r);class s extends r.default{constructor(e,t){super(e,t)}async _getBuildUpContent(e){let t=this,i=`${(0,n.get3DSpaceUrl)()}/resources/v2/dsprcs/private/invoke/buildup`,r=Object.assign({},e);return t._makeRequest(i,r).then((function(e){return t._dataManager.set("buildupContent",e),e})).catch((e=>{throw t._logger.error("Buildup initialization failed due to: "+e),e.code="DELVIEWER_W003",e}))}async _fetchBuildUpContent(e){var t,n=e.path;return(0,i.is)(n,"array")&&n.length>0&&(t=this._dataManager.get("buildupContent")[n.join("/")]),t}}t.default=s})),define("DS/DELWebViewerModel/BuildUpModelService",["UWA/Core","DS/DELWebViewerModel/WebService","DS/DELWebViewerUtils/Utils","DS/DELWebViewerModel/Buildup/DynamicBuildupOnCloud","DS/DELWebViewerModel/Buildup/DynamicBuildupOnPremise","DS/DELWebViewerModel/Buildup/PublishedBuildup","DS/DELWebViewerModel/Buildup/BuildupFromExternalContent"],(function(e,t,i,n,r,s,o){"use strict";return function(t,a){var l,u=a.getOption("logger"),d=a.getOption("dynamicBuildUp"),c=a.getOption("NodeInfraBuildUp"),p=[],f=a.getOption("eventCollection").getViewerCtrlEventHnd(),g=function(){var e=function(){if(a.getOption("useBuildFromExternalContent"))return o.default;let e;return e=a.getOption("dynamicBuildUp")?!1===a.getOption("NodeInfraBuildUp")?i.isCloud()?n.default:r.default:n.default:s.default,e}();return l=null,new e(t,a)},P=function(t){t&&t.data&&e.is(t.data.useBuildFromExternalContent,"boolean")?u.error("Viewer Option useBuildFromExternalContent can not be updated once set"):(t&&t.data&&(e.is(t.data.dynamicBuildUp,"boolean")||e.is(t.data.NodeInfraBuildUp,"boolean"))&&a.getOption("dynamicBuildUp")!==d||a.getOption("NodeInfraBuildUp")!==c)&&(l=g(),e.is(t.data.dynamicBuildUp)&&(d=t.data.dynamicBuildUp),e.is(t.data.NodeInfraBuildUp)&&(c=t.data.NodeInfraBuildUp))};return function(){if(f){let e=[{name:f.events.onUpdateOptions,callback:P,handler:f}];for(let t of e)p.push({handler:t.handler,token:t.handler.subscribe(t.name,t.callback)})}}(),l=g(),{getBuildUpSettings:function(e){return l.getBuildUpSettings(e)},initialize:async function(e){return await l.initialize(e)},set:t.set,get:t.get,updateBuildUpSettings:async function(e={}){let t,i={...e,persistBuildUpSettings:a.getOption("persistBuildUpSettings")};return t=await l.updateBuildUpSettings(i),t},reset:function(){l&&l.reset()},destroy:function(){this.reset()},getCurrentBuildContent:function(){return this.get("currentBuildupContent")},getMfgAndResourceBuildup:function(){let t=this.getCurrentBuildContent();return t&&t.buildupData&&e.is(t.buildupData.mfgAndResourceBuildup,"array")?t.buildupData.mfgAndResourceBuildup:[]},getFTABuildup:function(){let t=this.getCurrentBuildContent();return t&&t.buildupData&&e.is(t.buildupData.ftaBuildup,"array")?t.buildupData.ftaBuildup:[]},getFTAReqsPaths:function(){return l.getFTAReqsPaths()},getScopedMfgsIds:function(){return l.getScopedMfgsIds()},isBuildupAvailableForContext:function(e){return l.isBuildupAvailableForContext(e)},getPathFromBuildupDef:function(e,t){return l.getPathFromBuildupDef(e,t)},getBuildUp:function(e){return l.getBuildUp(e)},getBuildUpGlobalSettings:function(e){let t;return l&&(t=l.getBuildUpGlobalSettings(e)),t},setBuildUpGlobalSettings:function(e){l&&l.setBuildUpGlobalSettings(e)},getProcessInfo:function(){let e;return l&&(e=l.getProcessInfo()),e},getSessionId:function(){return l&&l.getSessionId?l.getSessionId():null},isObjectAvailable:function(e){return l.isObjectAvailable(e)}}}})),define("DS/DELWebViewerModel/ModelFactory",["UWA/Core","DS/DELWebViewerModel/DataManager"],(function(e,t){"use strict";return function(i){var n,r={},s="ModelService",o={BuildUpBehavior:"DS/DELWebViewerModel/BuildUpModelService",WorkInstructionBehavior:"DS/DELWebViewerModel/WKIModelService"};return{getCreatePromise:function(a){return new e.Promise((function(l){var u,d={};n=e.is(a,"array")&&a.length>0?new t(i):null,u=[null,n,i].concat(Array.prototype.slice.call(arguments,1)),e.is(a,"array")&&a.length>0?(a.forEach((e=>{o[e]&&(d[e]=o[e])})),require(Object.values(d),(function(){var e=Array.prototype.slice.call(arguments),t=Object.keys(d);e.length>0&&e.forEach((function(e,i){r[t[i]+s]=new(Function.prototype.bind.apply(e,u))})),l(r)}))):l(r)}))},getInstance:function(e){return e&&r[e]?r[e]:null},getDataManager:function(){return n},destroy:function(){n&&n.destroy(),r=s=n=null}}}})),define("DS/DELWebViewerModel/ModelInterface",["UWA/Core","DS/DELWebViewerModel/ModelFactory","DS/DELWebViewerModel/WebService","DS/DELWebViewerUtils/Utils","DS/DELWebViewerUtils/DELWebViewerSettingsMgt","text!DS/DELWebViewerModel/assets/json/DrillPayloads.json","text!DS/DELWebViewerModel/assets/json/Webservices.json"],(function(e,t,i,n,r,s,o){"use strict";return function(a){var l="resourceid",u="ds6w:label",d="ds6w:type",c="matrixtxt",p="ds6w:globalType",f="Path",g="ds6w:Instance",P="boundingbox",E="taxonomies",S="resultingProductLink",h="pathsr",D="DELFmiProcessOutputPrereqMaterializationCnx",U=Object.freeze({PROCESS:"PROCESS",SERVICEPROCESS:"SERVICEPROCESS",RESOURCE:"RESOURCE",PRODUCT:"PRODUCT",MBOM:"MBOM",SBOM:"SBOM"}),I=Object.freeze({DELLmiServiceHeaderWorkPlanReference:U.SERVICEPROCESS,DELLmiServiceWorkPlanSystemReference:U.SERVICEPROCESS,DELLmiPPRSystemReference:U.PROCESS,DELFmiFunctionPPRServiceCreateReference:U.SBOM,DELFmiFunctionReference:U.MBOM,"interfaces/Resource":U.RESOURCE,VPMReference:U.PRODUCT,DELLmiPPRHeaderProcessReferenceAbstract:U.PROCESS}),b="taxonomies",B=new t(a),m=a.getOption("logger");return{getCreatePromise:function(e){return B.getCreatePromise(e)},getInstance:function(e){return B.getInstance(e)},getOperationPath:function(t){var i=B.getDataManager();return i?i.getOperationPath(t):e.Promise.reject(a.getNLSValue("Error.DataManagerNotFound.Message"))},getIndexingDate:function(t){var s={select_service:[t]};return new e.Promise((function(e,t){var o=r.getSetting("pad_security_ctx")?r.getSetting("pad_security_ctx"):"preferred",a=`${n.get3DSpaceUrl()}/cvservlet/indexingdate?SecurityContext=${o}`;i.request({url:a,method:"POST",dataType:"json",payload:s}).then((function(t){e(t)})).fail(t)}))},getProgressiveExpandData:function(t){var r=n.get3DSpaceUrl()+"/cvservlet/progressiveexpand/v2?output_format=cvjson";return new e.Promise((function(e,n){i.request({url:r,method:"POST",dataType:"json",payload:t}).then((function(t){e(t)})).fail(n)}))},getInstallContext:function(t){var r,s,l,u=JSON.parse(o).getMfgItemInstallDependencies;if(a&&t.installPath&&t.installPath.length>1){s=t.installPath[0],l=t.installPath[1];let o=`${n.get3DSpaceUrl()}${u.url}`,d=u.method,c=u.payload;c.assemblyid=s,c.installinstids=[l],t.filter&&(c.config=n.getObjectHavingProperty(t.filter,"config_filter")),r=i.request({url:o,method:d,dataType:"json",payload:c}).then((t=>{let i;return t&&(t.status&&m.error(JSON.stringify(t)),i=t[l]),i||e.Promise.reject(a.getNLSValue("Error.WebServiceCallFailed.Message"))}))}else r=e.Promise.reject(a.getNLSValue("Error.InvalidInput.Message"));return r},getInstallContextV2:function(t){var r=JSON.parse(o).getMfgItemInstallDependencies;let s=e.is(t.installPaths,"array")?t.installPaths:[],l=[];return a&&s.length>0?new e.Promise((function(o,a){let u=[];s.forEach((e=>{e.length>1&&(l.push(e[e.length-2]),u.push(function(e){let s=e[0],o=e[e.length-2],a=`${n.get3DSpaceUrl()}${r.url}`,l=r.method,u=Object.assign({},r.payload);return u.assemblyid=s,u.installinstids=[o],t.filter&&(u.config=n.getObjectHavingProperty(t.filter,"config_filter")),i.request({url:a,method:l,dataType:"json",payload:u})}(e)))})),e.Promise.all(u).then((t=>{let i={noDependecy:[],predecessors:[],successors:[]};t.forEach((t=>{let n=Object.values(t)[0];e.is(n.noDependecy,"array")&&n.noDependecy.forEach((e=>{let t=e.toString();-1!==i.noDependecy.indexOf(t)||l.some((e=>t.includes(e)))||i.noDependecy.push(t)})),e.is(n.predecessors,"array")&&n.predecessors.forEach((e=>{let t=e.toString();-1===i.predecessors.indexOf(t)&&i.predecessors.push(t)})),e.is(n.successors,"array")&&n.successors.forEach((e=>{let t=e.toString();-1!==i.successors.indexOf(t)||l.some((e=>t.includes(e)))||i.successors.push(t)}))})),i.noDependecy=i.noDependecy.filter((function(e){return!i.predecessors.includes(e)})),i.successors=i.successors.filter((function(e){return!i.predecessors.includes(e)})),i.noDependecy=i.noDependecy.map((e=>e.split(","))),i.successors=i.successors.map((e=>e.split(","))),i.predecessors=i.predecessors.map((e=>e.split(","))),o(i)})).fail(a)})):e.Promise.reject(a.getNLSValue("Error.InvalidInput.Message"))},getAttributeForIds:function(t,r,s){var o,a,l=function(e,t,i){return{label:"DrillAttributes-"+Date.now(),physicalid:e,locale:"en",select_predicate:t,select_file:i}},u=function(t,r,s){return new e.Promise(((o,a)=>{i.request({url:n.get3DSpaceUrl()+"/cvservlet/fetch/v2",method:"POST",dataType:"json",payload:l(t,r,s)}).then((function(t){t&&e.is(t.error)?a(t.error.errorMessage):o(t)})).fail((function(e){a(e)}))}))},d=[],c=[];const p=1e4;return e.is(t,"array")&&e.is(r,"array")?new e.Promise((function(i,n){if(t.length>p)for(o=0,a=t.length;o<a;o+=p)d=t.slice(o,o+p),c.push(u(d,r,s));else c.push(u(t,r,s));e.Promise.all(c).then((function(t){var n={};t.forEach((t=>{Object.assign(n,function(t){var i="string"==typeof t?JSON.parse(t).results:t.results,n={};return e.is(i,"array")&&i.forEach((t=>{var i=null,r={};e.is(t.attributes,"array")&&(t.attributes.forEach((t=>{"resourceid"===t.name?i=t.value:r[t.name]?(e.is(r[t.name],"array")||(r[t.name]=[r[t.name]]),r[t.name].push(t.value)):r[t.name]=t.value})),n[i]=r)})),n}(t))})),i(n)})).fail(n)})):e.Promise.reject("Invalid Input Provided")},getTaxonomies:function(t){return this.getAttributeForIds(t,[b]).then((function(t){var i={};if(t)for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]&&e.is(t[n][b],"array")?t[n][b].join("/"):t[n][b]);return i}))},getPPRType:function(t){var i;if(t){t=e.is(t,"array")?t.join("/"):t;for(const e of Object.keys(I))if(t.contains(e)){i=I[e];break}}return i},getDrillData:function(t){var i=this,n=JSON.parse(s),r=function(e,t,i){return e.batch.expands[0].root.physical_id=t,i&&(e.batch.expands[0].filter={and:{filters:[i]}}),e},o=function(e){return i.getProgressiveExpandData(r(n.resultingProduct,e,t.filter))};return t&&t.id?new e.Promise(((s,a)=>{var U;e.Promise.all([(U=t.id,i.getProgressiveExpandData(r(n.drills,U,t.filter))),o(t.id)]).then((function(t){var i,n,r=(i=t[0],n={references:{},instances:{},paths:[]},i&&e.is(i.results,"array")&&i.results.forEach((e=>{e[f]?n.paths.push(e[f]):e[p]===g?n.instances[e[l]]={instanceId:e[l],label:e[u],type:e[d],matrixtxt:e[c]?e[c]:null,pathsr:e[h]?e[h]:""}:n.references[e[l]]={referenceId:e[l],label:e[u],type:e[d],taxonomies:e[E],boundingbox:e[P]}})),n),o=function(t,i){var n=[];return t&&e.is(t.results,"array")&&t.results.forEach((e=>{e[p]===g&&e[d]===D&&i.references[e.from]&&(i.references[e.from][S]=!0,n.push(e.from))})),n}(t[1],r),a=function(t,i){var n={resultingProductDrillPaths:[],drillPaths:[]};return e.is(t,"array")&&t.length>0&&t.forEach((function(e){-1!==i.indexOf(e[e.length-1])?n.resultingProductDrillPaths.push(e):n.drillPaths.push(e)})),n}(r.paths,o);s(e.merge(r,a))})).fail(a)})):e.Promise.reject("Invalid Input Provided")},getRequirements:async function(e){let t=JSON.parse(o).getRequirements;return t.payload.input_physical_ids=e,t.url=n.get3DSpaceUrl()+t.url,await i.request(t)},getDataManager:function(){return B.getDataManager()},reset:function(){var e=this.getDataManager();e&&e.reset()},destroy:function(){B&&B.destroy(),B=null}}}}));