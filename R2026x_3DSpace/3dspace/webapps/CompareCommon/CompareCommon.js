define("DS/CompareCommon/Cycle",[],(function(){"function"!=typeof JSON.decycle&&(JSON.decycle=function(e,t,i){"use strict";var n=new WeakMap;return i=(i=i||[])instanceof String?[i]:i,function e(o,r){var s,a;return null!=t&&(o=t(o)),"object"!=typeof o||null===o||o instanceof Boolean||o instanceof Date||o instanceof Number||o instanceof RegExp||o instanceof String?o:void 0!==(s=n.get(o))?{$ref:s}:(n.set(o,r),Array.isArray(o)?(a=[],o.forEach((function(t,i){a[i]=e(t,r+"["+i+"]")}))):(a={},Object.keys(o).forEach((function(t){isNaN(+t)?-1===i.indexOf(t)&&(a[t]=e(o[t],r+"["+JSON.stringify(t)+"]")):console.log("Compare decycle, ignoring key name that seems to be a number: ",t)}))),a)}(e,"$")}),"function"!=typeof JSON.retrocycle&&(JSON.retrocycle=function retrocycle($){"use strict";var px=/^\$(?:\[(?:\d+|"(?:[^\\"\u0000-\u001f]|\\(?:[\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*")\])*$/;return function rez(value){value&&"object"==typeof value&&(Array.isArray(value)?value.forEach((function(element,i){if("object"==typeof element&&null!==element){var path=element.$ref;"string"==typeof path&&px.test(path)?value[i]=eval(path):rez(element)}})):Object.keys(value).forEach((function(name){var item=value[name];if("object"==typeof item&&null!==item){var path=item.$ref;"string"==typeof path&&px.test(path)?value[name]=eval(path):rez(item)}})))}($),$})})),define("DS/CompareCommon/Input/CompareInputFilterCmd",["DS/ENONextGenFilterCmd/commands/ENONextGenFilterCmd"],(function(e){"use strict";return e.extend({init:function(e){this._parent(e),this.root=e.root,this.NGFUXId=e.NGFUXId},setRoot:function(e){this.root=e},_getRootId:function(){return this.root.objId},_getRootLabel:function(){return this.root.displayName},_getNGFUXId:function(){return this.NGFUXId},getAppParams:function(){return{widgetId:widget.id,appId:widget.getValue("appId"),NGFUXId:this.NGFUXId,tenantId:this.root.tenant,securityContext:this.root.securityContext}},getSelectorManager:function(){return null},getRoots:function(){return[{id:this._getRootId(),label:this._getRootLabel(),filtered:0}]},getSelection:function(){return{path:[[this._getRootId()]],label:[[this._getRootLabel()]],directSelection:!0}}})})),define("DS/CompareCommon/CompareIdData",["UWA/Core"],(function(e){"use strict";return function(e,t,i){var n=this;function o(e,t){for(var i of e)if(null!=i&&void 0!==i.objectServices&&null!==i.objectServices&&void 0!==i.objectServices.displayName&&null!==i.objectServices.displayName)for(var n of t)if(i.objectServices.displayName.includes(n.toReplace)){let e=new RegExp(n.toReplace,"g"),t=i.objectServices.displayName.replace(e,n.replaceWith);i.objectServices.displayName=t}}this.listType=e||"modelIDList",this.items=t||[],null!=t&&t.length>=2&&null==i?this.areCompared=!0:this.areCompared=i||!1,n.getLeftID=function(){var e=n.items[0];return null!=e?e.objectId:null},n.getRightID=function(){var e=n.items[1];return null!=e?e.objectId:null},n.get_nonNullCount=function(){var e=0;return n.items.forEach((function(t){null!=t&&e++})),e},n.get_objIDList=function(){for(var e=[],t=0,i=0;i<n.items.length;i++){var o=n.items[i];null!=o&&(e[t]=o.objectId,t++)}return e},n.get_objServices=function(e){var t=[];if("left"===e||"right"===e){t[0]=null;let i=n.items["left"===e?0:1];null!=i&&null!=i&&(t[0]=i.objectServices)}else for(var i=0,o=0;o<n.items.length;o++){let e=n.items[o];null!=e&&void 0!==e.objectServices&&null!==e.objectServices&&(t[i]=e.objectServices,i++)}return t},n.get_allIDList=function(){for(var e=[],t=[],i=0;i<n.items.length;i++){var o=n.items[i];if(null!=o){e.push(o.objectId);var r=o.commands;if(null!=r)for(var s=r.length,a=0;a<s;a++){var l=r[a].inNode;null!=l&&t.push(l)}}}return t.forEach((function(t){e.push(t)})),e},n.areItemsIdentical=function(e,t){var i=!1,o="number"==typeof e?n.items[e]:e,r="number"==typeof t?n.items[t]:t;if(null!=o&&null!=r&&o.objectId===r.objectId)if(void 0!==o.filterData&&null!==o.filterData||void 0!==r.filterData&&null!==r.filterData){if(void 0!==o.filterData&&null!==o.filterData&&void 0!==r.filterData&&null!==r.filterData)if(void 0!==o.filterData.filterTitle&&null!==o.filterData.filterTitle&&""!==o.filterData.filterTitle&&void 0!==r.filterData.filterTitle&&null!==r.filterData.filterTitle&&""!==r.filterData.filterTitle&&o.filterData.filterTitle===r.filterData.filterTitle)i=!0;else if(void 0!==o.filterData.CVQuery&&null!==o.filterData.CVQuery&&void 0!==r.filterData.CVQuery&&null!==r.filterData.CVQuery){JSON.stringify(o.filterData.CVQuery)===JSON.stringify(r.filterData.CVQuery)&&(i=!0)}else if(void 0!==o.filterData.CVQuery3D&&null!==o.filterData.CVQuery3D&&void 0!==r.filterData.CVQuery3D&&null!==r.filterData.CVQuery3D){JSON.stringify(o.filterData.CVQuery3D)===JSON.stringify(r.filterData.CVQuery3D)&&(i=!0)}}else i=!0;return i},n.safeHtmlDisplayName=function(){o(n.items,[{toReplace:"<",replaceWith:"#LT#"},{toReplace:">",replaceWith:"#GT#"}])},n.restoreDisplayName=function(){o(n.items,[{toReplace:"#LT#",replaceWith:"<"},{toReplace:"#GT#",replaceWith:">"}])}}})),define("DS/CompareCommon/Probs/CompareAnalyticsProb",["UWA/Class","DS/ENOCollabToolsUI/tracker/ENOCollabTracker"],(function(e,t){return e.singleton({init:function(){this.pd17=null,this.pd18=null,this.pd19=null,this.compareLaunchBy=null,this.selectedObjects=[],this.actionName="Open",this.trackerEvent=null,this.UXName="Compare",this.activeViewActionName=null,this.activeViewName=null,this.UXMode=null},setUXMode:function(e){this.UXMode=e},getUXMode:function(){return this.UXMode},setActiveViewActionName:function(e){this.activeViewActionName=e},getActiveViewActionName:function(){return this.activeViewActionName},setActiveViewName:function(e){this.activeViewName=e},getActiveViewName:function(){return this.activeViewName},setTypeOfOpen:function(e){this.pd18=e},getTypeOfOpen:function(){return this.pd18},setCompareLaunchBy:function(e){this.compareLaunchBy=e},getCompareLaunchBy:function(){return this.compareLaunchBy},setSelectedObjects:function(e){this.selectedObjects=e},getSelectedObjects:function(){return this.selectedObjects},setActionName:function(e){this.actionName=e},getActionName:function(){return this.actionName},setActionTarget:function(e){this.pd18=e},getActionTarget:function(){return this.pd18},setActionAppliedOn:function(e){this.pd17=e},getActionAppliedOn:function(){return this.pd17},setDisplayedViews:function(e){this.pd19=e},getDisplayedViews:function(){return this.pd19},clearCompareInit:function(){this.pd18=null,this.compareLaunchBy=null,this.actionName=null,this.UXMode=null},clearEnableDisableAction:function(){this.pd17=null,this.pd18=null,this.pd19=null,this.actionName=null},clearActivatedView:function(){this.pd18=null,this.pd19=null,this.actionName=null,this.activeViewActionName=null,this.activeViewName=null},clearDisplayMode:function(){this.UXMode=null},trackDisplayMode:function(){try{if(!(null!==this.UXName&&void 0!==this.UXName&&null!==this.selectedObjects&&void 0!==this.selectedObjects&&0!==this.selectedObjects.length&&null!==this.UXMode&&void 0!==this.UXMode))throw new Error("some mandetory fields are missing");var e={UXName:this.UXName,UXMode:this.UXMode,models:this.selectedObjects};let i=t.createInitActionEvent(e,this.trackerEvent);t.checkAndTrackPageEvent(i),this.clearDisplayMode()}catch(e){console.log("Probs -- Compare display mode "+e)}},trackActivateView:function(){try{if(!(null!==this.UXName&&void 0!==this.UXName&&null!==this.selectedObjects&&void 0!==this.selectedObjects&&0!==this.selectedObjects.length&&null!==this.actionName&&void 0!==this.actionName&&null!==this.pd18&&void 0!==this.pd18&&null!==this.pd19&&void 0!==this.pd19))throw new Error("some mandetory fields are missing");var e={UXName:this.UXName,pd18:this.pd18,pd19:this.pd19,models:this.selectedObjects,actionName:this.actionName};let i=t.createInitActionEvent(e,this.trackerEvent);t.checkAndTrackPageEvent(i),this.clearActivatedView()}catch(e){console.log("Probs -- Compare activate view "+e)}},trackEnableDisableAction:function(){try{if(!(null!==this.UXName&&void 0!==this.UXName&&null!==this.selectedObjects&&void 0!==this.selectedObjects&&0!==this.selectedObjects.length&&null!==this.actionName&&void 0!==this.actionName&&null!==this.pd17&&void 0!==this.pd17&&null!==this.pd18&&void 0!==this.pd18&&null!==this.pd19&&void 0!==this.pd19))throw new Error("some mandetory fields are missing");var e={UXName:this.UXName,pd17:this.pd17,pd18:this.pd18,pd19:this.pd19,models:this.selectedObjects,actionName:this.actionName};let i=t.createInitActionEvent(e,this.trackerEvent);t.checkAndTrackPageEvent(i),this.clearEnableDisableAction()}catch(e){console.log("Probs -- Compare enable disable view action "+e)}},compareTrackerInit:function(){try{if(!(null!==this.UXName&&void 0!==this.UXName&&null!==this.selectedObjects&&void 0!==this.selectedObjects&&0!==this.selectedObjects.length&&null!==this.pd18&&void 0!==this.pd18&&null!==this.compareLaunchBy&&void 0!==this.compareLaunchBy&&null!==this.UXMode&&void 0!==this.UXMode))throw new Error("some mandetory fields are missing");var e={UXName:this.UXName,UXContext:this.compareLaunchBy,models:this.selectedObjects,pd18:this.pd18,actionName:this.actionName,UXMode:this.UXMode};this.trackerEvent=t.createInitActionEvent(e,this.trackerEvent),t.checkAndTrackPageEvent(this.trackerEvent),this.clearCompareInit()}catch(e){console.log("Probs -- Compare initialization trackInitAction "+e)}}})})),define("DS/CompareCommon/DragAndDrop",["DS/ENOjquery/ENOjquery","DS/DataDragAndDrop/DataDragAndDrop"],(function(e,t){var i=function(i,n,o,r,s,a,l){var c=this;c._target=i,c._dragInVizCB=o,c._dragOutVizCB=r,c._dragOverVizCB=a,c._dragDropCB=s,c._dragCBThis=n,c._dropIndex=l,c._dragInCount=0;var u=e("#"+i);t.on([],u,{enter:(e,t)=>c.handleDragEnter(t),over:(e,t)=>c.handleDragOver(t),leave:(e,t)=>c.handleDragLeave(t),drop:(e,t,i)=>c.handleDragDropped(i)})};return i.prototype.getObjs=function(e){let t=e.originalEvent&&e.originalEvent.dataTransfer||e.dataTransfer,i={objArray:[]};var n=null;if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){n=("function"==typeof t.types.indexOf?t.types.indexOf("text/searchitems")>=0:t.types.contains("text/searchitems"))?t.getData("text/searchitems"):t.getData("text/plain")}else{for(var o=UWA.is(t.types.indexOf,"function")?"indexOf":"contains",r="",s=["text/searchitems","text/plain","Text"],a=0;a<s.length&&""===r;a++){var l=t.types[o](s[a]);(UWA.is(l,"number")&&l>=0||UWA.is(l,"boolean")&&!0===l)&&(r=s[a])}""!=r&&(n=t.getData(r))}if(n&&""!=n){for(var c=JSON.parse(n),u=c.data,p=0;p<u.items.length;p++){var d=u.items[p];d.objectType&&"3DShape"===d.objectType&&null!=c.biProxyCtx||i.objArray.push(d)}i.filterProxy=c.biProxyCtx}return i},i.prototype.handleDragEnter=function(e){if(e.preventDefault(),this._dragInCount++,1==this._dragInCount){var t=this.getObjs(e);this._dragInVizCB.call(this._dragCBThis,e,t.objArray.length)}return!0},i.prototype.handleDragOver=function(e){e.preventDefault(),null!=this._dragOverVizCB&&this._dragOverVizCB(e)},i.prototype.handleDragLeave=function(e){return e.preventDefault(),this._dragInCount--,0==this._dragInCount&&this._dragOutVizCB.call(this._dragCBThis,e),!0},i.prototype.handleDragDropped=function(e){this._dragInCount=0,e.preventDefault(),this._dragOutVizCB.call(this._dragCBThis,e);var t=this.getObjs(e);if(t.objArray.length>0){let i=this._dropIndex;null!=this._dragDropCB&&this._dragDropCB.call(this._dragCBThis,e,t,i)}return!0},i.prototype.reset=function(){this._dragInCount=0},i.prototype.off=function(i){var n=e("#"+i);t.off([],n)},{_attachedObjects:[],attachObject:function(e,t,n,o,r,s,a){var l=new i(e,t,n,o,r,s,a),c=this._attachedObjects.findIndex((t=>t._target===e));-1===c?this._attachedObjects.push(l):this._attachedObjects[c]=l},detachObject:function(e){var t=this._attachedObjects.findIndex((t=>t._target===e));-1!==t&&this._attachedObjects[t].off(e)},reset:function(){for(const e of this._attachedObjects)e.reset()}}})),define("DS/CompareCommon/Input/SearchManager",["UWA/Core","UWA/Utils/InterCom","text!DS/CompareCommon/assets/search_config/search_config.json"],(function(e,t,i){"use strict";return{initialize:function(){this.socketName="search_socket_"+(new Date).getTime(),this.socket=new t.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var e=this.options();return this.socket.dispatchEvent("RegisterContext",e),this},options:function(e,t,i,n,o,r,s,a){var l={};return l.title=e,l.mode="furtive",l.app_socket_id=this.socketName,null!==widget&&void 0!==widget?l.widget_id=widget.id:l.widget_id="",l.default_with_precond=!0,l.show_precond=!1,l.idcard_activated=!1,l.multiSel=o,l.role=i,t&&(l.precond="flattenedtaxonomies:(",t.forEach((function(e,t){0!==t&&(l.precond+=" OR "),l.precond+='"types/'+e+'"'})),l.precond+=")",l.precond+=' OR [dsxpfl:flattenedTypesIndex]:("dsxpfl:PortfolioVersion" OR "dscpfl:SellableItem")'),r&&(l.precond?l.precond="( "+l.precond+") AND "+r:l.precond=r),s&&s.length>0&&(l.columns=s),l.tenant=a,l},destroy:function(){var e={};e.widget_id=widget.id,this.socket.dispatchEvent("unregisterSearchContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.disconnect(),delete this.socket},activate:function(e,t,i,n,o,r,s,a,l){var c=this.options(e,t,i,n,o,s,a,l);this.callback=r,this.socket.dispatchEvent("InContextSearch",c)},isAvailable:function(){return e.is(this.socket)},configureSearch:function(e){this.isAvailable()||this.initialize(e)},displaySearchPanel:function(e,t,n,o){var r=[];if(null!==n&&void 0!==n.OpenContentObjectTypes&&null!==n.OpenContentObjectTypes)if("string"==typeof n.OpenContentObjectTypes)r.push(n.OpenContentObjectTypes);else for(var s of n.OpenContentObjectTypes)r.push(s);else{var a=JSON.parse(i);for(var l in a)a.hasOwnProperty(l)&&"type_"===l.substring(0,5)&&r.push(a[l])}this.launchSearch({tenant:e,allowedTypes:r,role:"",criteria:i.type_act_physical,additionalQuery:"",bMultiSel:t,in_apps_callback:o})},launchSearch:function(e){var t=this;this._searchInProgress=!0,t.initialize(),t.activate("Compare Search",e.allowedTypes,e.role||"",e.criteria,e.bMultiSel,(function(i){t._searchInProgress&&(t._searchInProgress=!1,e.in_apps_callback(i))}),e.additionalQuery,e.selectable,e.tenant)},destroySearch:function(){this._searchInProgress&&(this._searchInProgress=!1,this.destroy())},objectsSelected:function(e){var t,i,n=[];if(this.callback){for(t=0,i=e.length;t<i;t++)n.push(e[t]);this.callback(n)}}}})),define("DS/CompareCommon/launchTree",[],(function(){var e=1e3,t=function(e,t,i){var n={id:e,phid:t};return i&&(n.CADOrigin=i),n},i=function(n,o,r){var s=e++;this.id=s.toString(),this.physID=n,this.show=!0,this.isObj=r,o&&(this.select=!0),this.children=[];var a=this;a.addChild=function(e,t,n){var o=new i(e,t,n);return a.children.push(o),o},a.getChild=function(e){var t=null;return e<a.children.length&&(t=a.children(e)),t},a.cleanse=function(){delete this.physID,delete this.isObj;for(var e=0;e<this.children.length;e++)this.children[e].cleanse()},a.makeResult=function(e){var i=a.isObj?"CATIAV5":null;e.push(new t(a.id,a.physID,i));a.children;for(var n=0;n<a.children.length;n++)a.children[n].makeResult(e)},a.findChild=function(e){for(var t=null,i=0;i<a.children.length;i++){var n=a.children[i];if(e==n.physID){t=n;break}}return t}},n=function(){var e=this;e.insert=function(t,n){if(null==e.root){var o=!1;0==t.length&&(o=!0),e.root=new i(t[0],o,!0)}for(var r=e.root,s=1;s<t.length;s++){var a=t[s],l=r.findChild(a);if(null==l){var c=s==t.length-1,u=s%2==0;r=r.addChild(a,c&&n,u)}else r=l}},e.cleanse=function(){e.root.cleanse()}};function o(e){return e.cleanse(),{structure:[e.root]}}function r(e,t,i){for(var o=new n,r=function(e,t){var i=e.length,n=t.length,o=new Array(i);for(o.fill(0),j=0;j<i;j++)for(var r=e[j],s=0;s<n;s++){var a=t[s];if(a.contains("_LEFT")&&(a=a.replace(/_LEFT/g,"")),a.contains("_RIGHT")&&(a=a.replace(/_RIGHT/g,"")),r==a){o[j]=2;break}if(r.startsWith(a)){o[j]=1;break}}return o}(t,i),s=r.length,a=0;a<s;a++)if(r[a]>0){var l=2==r[a];o.insert(e[a],l)}return o}var s=function(e){this._pathWithArray=function(e){for(var t=[],i=e.length,n=0;n<i;n++){var o=e[n].pathWith;t.push(o)}return t}(e),this._pathWithStrArray=[];for(var t=0;t<this._pathWithArray.length;t++)this._pathWithStrArray.push(this._pathWithArray[t].join())};return s.prototype.buildLaunchJSON=function(e){for(var t=null,i=[],n=0;n<e.length;n++){for(var s=[],a=e[n],l=0;l<a.length;l++)s.push(a[l].resourceid);i[n]=s.join()}var c=function(e,t,i){var n=null,s=r(e,t,i);return null!=s.root&&((n={version:"2.1",viewpoint:[],workUnder:{version:"1.0",AuthoringContextHeader:null,change:{id:"",name:"",context:[],title:"",description:"",severity:""},evolution:{id:"",displayExpression:"",expression:""}}}).results=function(e){var t=[];return e.root.makeResult(t),t}(s),n.structures=[o(s)]),n}(this._pathWithArray,this._pathWithStrArray,i);return null!=c&&(t=JSON.stringify(c)),t},s})),define("DS/CompareCommon/CompareMetaData",["UWA/Class","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],(function(e,t,i){"use strict";return e.singleton({init:function(){this.typeInfo={}},get:function(e,t){let i=this;return new Promise((function(n,o){i._has(e)?n(i.typeInfo[e.objectType]):i._load(e,t).then((function(t){n(i.typeInfo[e.objectType])}))}))},_has:function(e){let t=this;return!(void 0===t.typeInfo||null===t.typeInfo||void 0===t.typeInfo[e.objectType]||null===t.typeInfo[e.objectType])},_load:function(e,n){let o=this;return new Promise((function(r,s){i.getPlatformServices({onComplete:function(i){for(var s=-1,a=0;a<i.length&&-1===s;++a)i[a].platformId===e.envId&&(s=a);if(s>-1){var l=i[s][e.serviceId]+"/"+e.serviceId,c=l+"/compareMetaData/"+e.objectType;o.typeInfo[e.objectType]={serviceId:e.serviceId,url:l,b3DViewerSupported:!1};try{t.authenticatedRequest(c,{proxy:n,method:"GET",onComplete:function(t){try{var i=JSON.parse(t);o.typeInfo[e.objectType].structure=i.structure,o.typeInfo[e.objectType].attributes=i.attributes,void 0!==o.typeInfo[e.serviceId]&&null!==o.typeInfo[e.serviceId]||(o.typeInfo[e.serviceId]={serviceId:e.serviceId,url:l,b3DViewerSupported:!1},o.typeInfo[e.serviceId].structure=i.structure,o.typeInfo[e.serviceId].attributes=i.attributes),r()}catch(e){console.log("COMPARE compareMetaData invalid syntax"),r()}},onFailure:function(e){console.log("COMPARE failure getting compare metadata"),r()}})}catch(e){console.log("COMPARE failure calling compareMetaData service '"+c+"'"),r()}}else console.log("COMPARE failure identifying compareMetaData service URL for "+e.envId+" "+e.serviceId),r()},onFailure:function(){console.log("COMPARE failure retrieving compareMetaData service URL for "+e.envId+" "+e.serviceId),r()}})}))}})})),define("DS/CompareCommon/CompareViewerFocusOnCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ApplicationFrame/CommandsManager","DS/PADUtils/PADContext"],(function(e,t,i,n){"use strict";var o=t.extend({name:"CompareViewerFocusOnCmd",init:function(e){this._parent(e,{mode:"shared",isAsynchronous:!0}),this._context=n.get(this.options.context)},execute:function(){var e=this;require(["DS/Selection/CSOManager"],(function(t){var n=[],o=t.get();if(o.length&&o.forEach((function(t){var i=t.pathElement,o=e._context.streamPath(i);n.push(o)})),0==n.length)console.error("No path to focus on or call from another 3D widget reference");else{var r=i.getCommand("PAD3DViewerNavigateOnSelectionHdr",null);null!=r&&r.execute(n),jQuery("#compare-content").trigger("updateWidgetViewStateEvent",{buttonUpdateOnly:!1,forceGetSelections:!0,autoScrollToActive:!0})}e.end()}))}});return e.namespace("DS/CompareCommon/CompareViewerFocusOnCmd",o)})),define("DS/CompareCommon/CompareAlert",["DS/MessageBus/MessageBus","DS/PADUtils/views/PADAlert","css!DS/CompareCommon/CompareAlert.css"],(function(e,t){"use strict";return{doAlert:function(e){if(null!=e&&e.clearExistingFirst){var i=jQuery(".wux-notification-close"),n=document.createEvent("Event");n.initEvent("DSpointerup",!0,!0);for(var o=0;o<i.length;++o)i[o].dispatchEvent(n)}var r="(empty)",s="warning";try{r=e?e.msg:null;e.alertStyle&&(s="compare-alert-error"==e.alertStyle?"error":"compare-alert-success"==e.alertStyle?"success":"compare-alert-info"==e.alertStyle?"info":"warning"),null==r?console.log("%%%% CompareWidget: Blank alert "+s+" sent %%%%"):("error"==s&&console.error("%%%% CompareWidget "+s+": "+r),t.displayNotification({msg:e.msg,eventID:s}))}catch(e){console.log("%%%% CompareWidget: Failed to display alert "+s+" '"+r+"' %%%%")}}}})),define("DS/CompareCommon/CompareIdDataListItem",["UWA/Core"],(function(e){"use strict";return function(e,t){this.objectId=e,this.idType=t&&t.idType?t.idType:"modelID",this.commands=t&&t.commands?t.commands:[],this.objectServices=t||null,this.filterData=null}})),define("DS/CompareCommon/Utils",["UWA/Core","UWA/Class","DS/WAFData/WAFData","UWA/Promise","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/WidgetServices/WidgetServices","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleServicesSettings","DS/CompareCommon/CompareIdData","DS/Controls/TooltipModel","DS/ENOjquery/ENOjquery","UWA/Json","i18n!DS/CompareCommon/assets/nls/CompareCommon","i18n!DS/CompareCommon/assets/nls/CompareInput"],(function(e,t,i,n,o,r,s,a,l,c,u,p,d,h,f){"use strict";var m=864e5;let g="__CS_TS__";function v(e,t,n,o,s,a,l){var c=-1!=e.indexOf("?")?"&":"?",u=o.tenant?o.tenant:"OnPremise",p=o.url3DSpace+e+c+"tenant="+u,d={headers:{Accept:"application/json","Accept-Language":r.getLanguage(),"Content-Type":"application/json",SecurityContext:encodeURIComponent(o.securityContext)},method:1==t?"POST":"GET",type:"json",timeout:s,proxy:"passport",onComplete:a,onFailure:l};t&&(d.data=n),i.authenticatedRequest(p,d)}function y(e,t,i,n,o,r){var s=-1!=e.indexOf("?")?"&":"?",a=e;for(var l in t)a+=s+l+"="+t[l],s="&";v(a,!1,null,i,n,o,r)}function b(t,i,n,o,r,s){v(t,!0,e.Json.encode(i),n,o,r,s)}function C(e,t,i,n){y("/resources/compare/revisions2",{objectId:e},t,12e4,(function(t){for(var o=null,r=t.results,s=0;s<r.length;s++){var a=r[s];if(a.physicalid==e){o=a;break}}null==o&&null!=n&&n(),i(o)}),n)}function I(e,t,i,n){C(e.physicalid,t,(function(o){for(var r in o)e[r]=o[r];!function(e,t,i,n){b("/resources/FilterBIAPI/Filter/getFiltersFromIds",Array.isArray(e)?e:[e],t,12e4,(function(t){var o=null;if(null!=t.success)for(var r of t.success)if(null!=(o=r[e]))break;null==o&&null!=n&&n(),i(o)}),n)}(e.physicalid,t,(function(o){e.filter=o,C(o.rootPhysicalId,t,(function(t){o.rootObj=t,e.revision=t.name+" "+t.revision,i()}),n)}),n)}),n)}var D=t.singleton({init:function(){this._parent({})},augDroppedObject:function(e,t,i,n){e.isFilter?function(e,t,i,n){var o=e.filter;null==o?I(e,t,i,n):null==o.rootObj?C(o.rootPhysicalId,t,(function(e){o.rootObj=e,filterObj.revision=e.name+" "+e.revision,i()}),n):i()}(e,t,(function(){i(e.filter.rootObj)}),n):this._augNonFilterAsNeeded(e,t,(function(){i(e)}),n)},_augNonFilterAsNeeded:function(e,t,i,n){var o=this;null==e.type?"3dportfolio"===e.serviceId?(t.tenant=widget.getValue("x3dPlatformId"),t.url3DSpace=e.attributesUrl.url,y("/"+e.attributesUrl.attributes.url,{objectIds:e.physicalid},t,12e4,(function(n){var r=[];if(void 0!==n.results&&null!==n.results){if(1==(r=n.results).length)for(var s=0;s<r[0].data.length;++s)"Title"==r[0].data[s].displayName&&(e.Title=r[0].data[s].value),"Version"==r[0].data[s].displayName&&(e.revision=r[0].data[s].value),"dskern:nlsLabel"===r[0].data[s].name&&(e.Title=r[0].data[s].value),"dsxpfl:typeNLSPath"===r[0].data[s].name&&(e.displayType=r[0].data[s].value),"dslc:isVersionNumber"===r[0].data[s].name&&(e.revision=r[0].data[s].value),"preview_url"===r[0].data[s].name&&(e.preview_url=r[0].data[s].value);o.getFederatedAttributesPromise({objectIds:[e.physicalid],serviceIds:[e.serviceId],tenant:t.tenant,securityContext:t.securityContext}).then((function(t){if(void 0!==t.results&&null!==t.results&&t.results.length>0)e.preview_url=t.results[0].preview_url,e.type_icon_url=t.results[0].type_icon_url,e.type=t.results[0].data.find((function(e){return-1!==e.name.search(/ds6w:type$/)})).value;else{let t=h.federated_attributes_failed;void 0!==e.displayName&&null!==e.displayName&&""!==e.displayName&&(t=t+": "+e.displayName),o.showAlertBox(t,null,"warning")}i()}),(function(){let t=h.federated_attributes_failed;void 0!==e.displayName&&null!==e.displayName&&""!==e.displayName&&(t=t+": "+e.displayName),o.showAlertBox(t,null,"warning")}))}}),(function(e){console.log("COMPARE: failed getting object info")}))):"sourcing"===e.serviceId?(console.log("COMPARE: Ignoring getting extra object info for "+e.serviceId),i()):C(e.physicalid,t,(function(t){for(var n in t)e[n]=t[n];i()}),n):i()},getFederatedAttributesPromise:function(t){var s=l.getPlatformWSUrl("3DSearch",t.tenant,"/search");return new n((function(n,a){for(var l={with_indexing_date:!0,with_synthesis:!0,with_nls:!0,label:"ENOCompare-"+("compareWidgetOdtId"!==widget.id?Date.now().toString():"ODTFakeSearch"),select_predicate:[],with_synthesis_hierarchical:!0,select_file:["icon","thumbnail_2d"],query:"",nresults:40,start:"0",tenant:t.tenant},c=0;c<t.objectIds.length;c++)l.query+=(0===c?"":" OR ")+'[ds6w:resourceUid]:"'+t.objectIds[c]+'"';i.authenticatedRequest(s,{method:"POST",type:"json",proxy:"passport",timeout:3e4,data:e.Json.encode(l),headers:{Accept:"application/json",SecurityContext:encodeURIComponent(t.securityContext),"content-type":"application/json","Accept-Language":widget.lang},onComplete:function(e){var t=[],i={results:[]};if(void 0!==e.results)for(var s=0;s<e.results.length;s++){for(var a=e.results[s].attributes,c={data:[]},u=0;u<a.length;u++)if("type_icon_url"===a[u].name)c.type_icon_url=a[u].value;else if("preview_url"===a[u].name)c.preview_url=a[u].value;else if("resourceid"===a[u].name)c.physicalID=a[u].value;else if("sourceid"===a[u].name)c.sourceID=a[u].value;else{var p=a[u].name.split("/"),d=p[p.length-1];c.data.push({nls:d,value:a[u].value,name:a[u].name});for(var h=!1,f=0;!h&&f<t.length;++f)d===t[f]&&(h=!0);h||t.push(d)}i.results.push(c)}if(t.length>0){var m=t.join(",");o.getResourcesInfo(m,{tenantId:l.tenant,lang:r.getLanguage(),apiVersion:"R2018x",onComplete:function(e){for(var t=0;t<i.results.length;++t)for(var o=0;o<i.results[t].data.length;++o)for(var r=i.results[t].data[o],s=0;s<e.vocabularyElementNLSInfo.length;++s){var a=e.vocabularyElementNLSInfo[s].uri,l=e.vocabularyElementNLSInfo[s].nlsName;r.nls===a&&(r.nls=l)}n(i)},onFailure:function(e){console.log("COMPARE: Can't get ElementsNls "+e),n(i)}})}else n(i)},onFailure:function(e){a(t)}})}))},getEffectivityPromise2:function(e){return new n((t=>{this.loadEffectivities(e,(e=>{var i=this.formatEffectivities(e);t(i)}))}))},formatEffectivities:function(e){var t=[];if(null==e)return console.log("unexpected effectivity"),t;var i=e.expressions;if(null==i)return console.log("unexpected effectivity"),t;for(var n=Object.keys(i),o=n.length,r=0;r<o;r++){var s=n[r],a=i[s],l=a.hasEffectivity;if("ERROR"!=l)if("ERROR"!=a.status){var c=[],u={metatype:"effectivity",physicalID:s,data:c};t.push(u);var p="YES"==l?h.Yes:h.No;if(c.push({name:"Effectivity",nls:h.Effectivity,type:"string",value:[p]}),"NO"!=l){var d=a.content;if(null!=d){var f=d.Variant;null!=f&&c.push({name:"VariantOption",nls:h.VariantOption,type:"string",value:f});var m="",g="",v=d.Evolution;null!=v&&(m=null==v.Current?"":v.Current,g=null==v.Projected?"":v.Projected,c.push({name:"CurrentEvolution",nls:h.CurrentEvolution,type:"string",value:[m]}),c.push({name:"ProjectedEvolution",nls:h.ProjectedEvolution,type:"string",value:[g]}))}else console.log("unexpected effectivity")}}}return{results:t}},loadEffectivities:function(e,t){var i="/resources/modeler/configuration/navigationServices/getMultipleFilterableObjectInfo?timestamp="+(new Date).getTime().toString(),n=e.securityContext;null!=n&&""!==n||(n=widget.securityContext);var o={version:"2.0",output:{targetFormat:"TXT",withDescription:"YES",view:"ALL",domains:"ALL"},pidList:e.objectIds};D.doPost(i,o,widget.getValue("x3dPlatformId"),n,function(e){t(e)}.bind(this),function(e){t({expressions:{}})}.bind(this))},isTitleAttr:function(e,t){var i=e.name,n=e.value,o=this.getTitleAttrNames();return(!1!==t||"PLM_ExternalID"!==i&&"PLM_ExternalID"!==n)&&(-1!=o.indexOf(i)||-1!=o.indexOf(n))},generateTooltip:function(e,t){if(t.includes(".")){var i=t.split(".");t=i[i.length-1]}var n=new u({allowUnsafeHTMLLongHelp:!0});return n.loadFromHelpRscFile(e,t),n},getTitleAttrNames:function(){return["attribute[PLMEntity.V_Name]","V_Name","PLM_ExternalID","attribute[PLMInstance.PLM_ExternalID]","attribute[Title]","Title","dskern:nlsLabel","Synopsis"]},getObjState:function(e,t,i,n,o){var r=[];let s=!1;for(var a of t)a.envId!==t[0].envId&&(s=!0);if(s)for(var l=0;l<e.length;++l)r.push(this.getObjStatePromise(e[l],t[l],i));else r.push(this.getObjStatePromise(e.join(","),{envId:i,contextId:t[0].contextId},i));Promise.allSettled(r).then((e=>{var t=[];for(var i of e)if("fulfilled"===i.status)for(var o of i.value.results)t.push(o);n(t)}))},getObjStatePromise:function(e,t,i){var o={url3DSpace:l.get3DSpaceBaseUrl(t.envId),tenant:t.envId,securityContext:t.contextId};return new n((function(t,i){y("/resources/compare/getObjState",{objectIds:e},o,m,t,i)}))},accessRightsPromise:function(e,t,o,r){for(var s="",a=0;a<e.length;++a){var c=e[a];0==c.isSupportedType&&(""!==s&&(s+=","),s+='{"objectID":"'+c.physID+'","accessRight":[{"access":{"physical":"read"}}]}')}if(""!==s){var u=l.get3DSpaceWSUrl(t,"/resources/pno/ownership/checkaccess"),p='{"boAccessRights":['+s+"]}";return new n((function(e,t){i.authenticatedRequest(u,{method:"POST",type:"json",proxy:"passport",timeout:5e3,data:p,headers:{Accept:"application/json",SecurityContext:encodeURIComponent(o),"content-type":"application/json","Accept-Language":widget.lang},onComplete:function(e){r(e.success)},onFailure:function(e){r(e.success)}})}))}r(!0)},setSupportsEffectivityBasedRevisions:function(e,t,i){return new Promise((function(t,n){var o=e.map((e=>e.physID));a.getAllowedSemanticsPromise(o,i).then((function(i){for(var n of e)!0===a.isEffectivityBasedOrEffectivityBasedReuseMode(void 0,i)&&(n.supportsEffectivityBasedRevisions=!0);t()}))}))},getPrefFromSession:function(e){return d.decode(sessionStorage.getItem(e))},savePrefToSession:function(e,t){sessionStorage.setItem(e,d.encode(t))},getPrefTimestampFromSession:function(e){return Number(this.getPrefFromSession(`${e}[${g}]`))},savePrefTimestampToSession:function(e,t){this.savePrefToSession(`${e}[${g}]`,t.toString())},getPrefLastSavedTimestampFromDashboardPromise:function(e){return this.getUserPreferencesPromise(`${e}[${g}]`).then((e=>Promise.resolve(Number(e))))},savePrefTimestampToDashboardPromise:function(e,t){return this.saveUserPreferencesPromise(`${e}[${g}]`,t.toString())},getPrefFromSessionPromise:function(e){return Promise.resolve(this.getPrefFromSession(e))},loadPref:function(e,t,n){r.getCompassUrlAsync({onComplete:function(o){var r=o+"/resources/AppsMngt/user/getPreferences?name="+encodeURI(e);i.authenticatedRequest(r,{method:"GET",timeout:5e3,headers:{Accept:"application/json",SecurityContext:void 0},onComplete:function(e){t(e)},onFailure:function(e){"function"==typeof n?n(e):t("")},cache:!1})}})},savePref:function(e,t,n,o){r.getCompassUrlAsync({onComplete:function(r){var s=r+"/resources/AppsMngt/user/setPreferences?name="+encodeURI(e)+"&value="+encodeURI(t);i.authenticatedRequest(s,{method:"GET",timeout:5e3,headers:{Accept:"application/json",SecurityContext:void 0},cache:!1,onComplete:function(e){"function"==typeof n&&n(e)},onFailure:function(e){"function"==typeof o?o(e):onLoad("error")}})}})},saveUserPreferencesPromise:function(e,t){return new Promise((function(i,n){D.savePref(e,encodeURIComponent(d.encode(t)),i,n)}))},getUserPreferencesPromise:function(e){return new Promise((function(t,i){D.loadPref(e,(e=>{let i="";try{i=d.decode(decodeURIComponent(e))}catch{i=decodeURIComponent(e)}t(i)}),i)}))},setPreferencesToWidget:function(e,t,i){let n,o,r=[];"string"==typeof e?(n=[e],o=[t]):Array.isArray(e)&&Array.isArray(t)&&(n=e,o=t),Promise.allSettled(n.map((e=>D.getUserPreferencesPromise(e)))).then((e=>{e.forEach(((e,t)=>{"rejected"!==e.status&&e.value?"string"==typeof o[t]&&o[t].length&&null!=e.value&&""!=e.value&&(widget.setValue(o[t],e.value),r.push({[n[t]]:e.value})):console.info(" Compare Utils.setPreferencesToWidget: Failed to get preference and save to widget "+n[t])})),"function"==typeof i&&i(1===r.length?Object.values(r)[0]:r)}))},doPost:function(e,t,i,n,o,r){b(e,t,{url3DSpace:l.get3DSpaceBaseUrl(i),tenant:i,securityContext:n},m,o,r)},getExpressionPromise:function(e,t){return new n((function(i,n){y("/resources/compare/getExpressionValue",{expressionName:e},t,m,i,n)}))},determineListType:function(e){for(var t="unknown",i=!1,n=!1,o=!1,r=e.items,s=0;s<r.length;s++){var a=r[s];"snapshotID"==a.idType?o=!0:"modelID"==a.idType?i=!0:"IDPlusCommands"==a.idType?n=!0:null==a.idType?i=!0:console.error("COMPARE>> Unknown idtype in input")}return o?t="snapshotIDList":n?t="IDPlusCommandsList":i?t="modelIDList":console.error("COMPARE>> Unknown idType in input"),t},persistIDs:function(e){e.safeHtmlDisplayName(),widget.setValue("persistedIDs",JSON.stringify(e))},fetchPersistedIDs:function(){var e=null,t=widget.getValue("persistedIDs");if(t){var i=JSON.parse(t);(e=new c(i.listType,i.items,i.areCompared)).restoreDisplayName()}return e},clear_persistedIDs:function(){widget.setValue("persistedIDs",null)},getX3DContent:function(){return widget.getValue("X3DContentId")},fetchContentFromCompass:function(){var e=this.getX3DContent();return null!=e&&e.constructor==String&&(e=JSON.parse(e)),e},setCredentialsToWidget:function(e){var t=e.replace("ctx::","");widget.setValue("xPref_CREDENTIAL",t)},isRevBranchRevPattern:function(e,t){var i=!1,n="",o=e.match(/_/g);if(null!=o&&o.length>0?n="_":null!=(o=e.match(/\x2e/g))&&o.length>0&&(n="."),""!==n){t.separator=n,t.branches=[];var r=e.split(n);if(r.length>2){i=!0;for(var s=r.length-1;s>=0;s-=2)0===s?t.branches.push({branchId:"",revisionId:r[s]}):1===s?t.branches.push({branchId:"",revisionId:r[s-1]+n+r[s]}):t.branches.push({branchId:r[s-1],revisionId:r[s]})}}return i},__setUMPrefs:function(e,t){require(["DS/CompareWidget2/userSettings/UserSettingsManager"],(i=>{setTimeout((()=>{let n=!1;for(const[t,o]of Object.entries(e))i.hasPref(t)&&i.get(t)!==o&&(i.set(t,o),n=!0);t(n)}),0)}))},forceRequireIndex:function(e,t,i){widget.setValue("compareSettings.dataSource.useIndex",!0),this.__setUMPrefs({"compareSettings.dataSource.useIndex":!0},(n=>{!e&&n&&this.showAlertBox(t?"INDEX_REQ_ENABLING_FOR_CUSTOM_PROFILE":"INDEX_REQ_ENABLING",h,"warning"),"function"==typeof i&&i(n)}))},disableExternalRelationsComputation:function(e){this.__setUMPrefs({"compareSettings.includeFacets.externalRelations.showDocs":!1,"compareSettings.includeFacets.externalRelations.showOtherRels":!1},(t=>{t&&this.showAlertBox("DISABLE_EXTERNAL_RELATIONS",h,"warning"),"function"==typeof e&&e(t)}))},forceIndex_DisableOtherRelations_ForCustomProfilePromiseArray(){return[new Promise(((e,t)=>this.forceRequireIndex(!1,!0,e))),new Promise(((e,t)=>this.disableExternalRelationsComputation(e)))]},intersectionDifference:function(e,t,i,n){if(null==e&&(e=[]),null==t&&(t=[]),!Array.isArray(e)&&!Array.isArray(t))throw Error("ArrayUtils.setDifference: both inputs should be an array");for(var o=e.slice(),r=t.slice(),s={intersection:[],difference:void 0},a={intersection:[],difference:void 0},l=!0===n?o.length-1:0;!0===n?l>=0:l<o.length;l=!0===n?l-1:l+1)for(var c=!0===n?r.length-1:0;!0===n?c>=0:c<r.length;c=!0===n?c-1:c+1)if(i(o[l],r[c])){s.intersection.unshift(o.splice(l,1)[0]),a.intersection.unshift(r.splice(c,1)[0]),!n&&(l-=1);break}return s.difference=o,a.difference=r,[s,a]},checkIsAdminUserPromise:function(){return new Promise((e=>{s.getUser({onComplete:function(t){var i=!1,n=t.platforms;n&&n.length>0&&n.forEach((function(e){e.id===widget.getValue("x3dPlatformId")&&"admin"===e.role&&(i=!0)})),e({isAdminUser:i,id:t.id})},onFailure:function(e){console.error("FAILED TO GET compass services: "+e)}})}))},objectTypeNotAllowedForCompare:function(e,t){let i=!1;return"ENOStrRefinementVDRPSpec"===e&&(i=!0,!0!==t&&this.showAlertBox("CompareVDRPFilterNotSupported",f,"warning")),i},showAlertBox:function(e,t,i,n,o){var r="compare-alert-warning";switch(i){case"warning":default:r="compare-alert-warning";break;case"error":r="compare-alert-error";break;case"success":r="compare-alert-success";break;case"info":r="compare-alert-info"}require(["DS/CompareCommon/CompareAlert"],(function(i){null==t?i.doAlert({msg:e,alertStyle:r,clearExistingFirst:n}):require([t],(function(){var s=t[e];null==s?s=e+" (NLS message is missing)":""==s?s=e+"(NLS message is blank)":null!=o&&(s=t.replace(s,o)),i.doAlert({msg:s,alertStyle:r,clearExistingFirst:n})}),(function(){i.doAlert({msg:e+" (NLS file '"+t+"' cannot be found)",alertStyle:r})}))}),(function(t){e="%%%% CompareWidget:: Failed to show "+i+": '"+e+"', error:"+t,"error"==i?this.errout(e):this.warnout(e)}))},confirmDialog:function(e,t,i,n,o){this.confirmDialog2({message:e,fonticon:t,okButton:i,koButton:n,title:o})},confirmDialog2:function(t){require(["DS/UIKIT/SuperModal"],(function(i){var n="",o=new i({events:{onHide:function(){""===n&&void 0!==t.closeX&&null!==t.closeX&&null!==t.closeX.callback&&void 0!==t.closeX.callback&&"function"==typeof t.closeX.callback&&t.closeX.callback(),n=""}},renderTo:document.body}),r=document.createElement("div");r.innerHTML=t.message;var s=document.createElement("div");if(s.className="compare_popup_warning",null!=t.fonticon){let i="info"===t.fonticon?"fonticon fonticon-info fonticon-2x":"compare_warning_icon fonticon "+t.fonticon+" fonticon-2x",n=e.createElement("span",{class:i});s.appendChild(n)}else if(null!=t.iconpath&&t.iconpath.length>0){let i=e.createElement("div",{style:"height: 100%"}),n=e.createElement("img",{src:t.iconpath});i.appendChild(n),s.appendChild(i)}var a=document.createElement("div");a.appendChild(s),a.appendChild(r);var l=[];l.push({className:"primary compare-input-Ok",value:void 0!==t.okButton.label&&null!==t.okButton.label&&""!==t.okButton.label?t.okButton.label:null,action:function(e){n="ok",e.hide(),null!==t.okButton.callback&&void 0!==t.okButton.callback&&"function"==typeof t.okButton.callback&&t.okButton.callback()}}),null!==t.koButton&&l.push({className:"default compare-input-Cancel",value:void 0!==t.koButton.label&&null!==t.koButton.label&&""!==t.koButton.label?t.koButton.label:null,action:function(e){n="cancel",e.hide(),null!==t.koButton.callback&&void 0!==t.koButton.callback&&"function"==typeof t.koButton.callback&&t.koButton.callback()}}),o.dialog({title:null!=t.title?t.title:h.get("CompareDialogHeader"),body:a,buttons:l})}))},getPropertiesForClassPromise:function(e,t){return new n((function(i,n){require(["DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/WidgetServices/WidgetServices"],((o,r)=>{o.getPropertiesForClass(e,{tenantId:t,lang:r.getLanguage(),apiVersion:"R2019x",onComplete:function(e){i(e)},onFailure:function(e){n()}})}))}))}});return D})),define("DS/CompareCommon/WidgetPreferences",["UWA/Core","UWA/Class","DS/Controls/Toggle","DS/Controls/ComboBox","UWA/Json","DS/CompareCommon/Utils","i18n!DS/CompareWidget/assets/nls/CompareWidget"],(function(e,t,i,n,o,r,s,a){"use strict";return t.singleton({init:function(){this._parent({}),this.PREF_NAME="compare_widget_pref_webinwin",this.defaults={vizOverview:!0,vizLegend:!0,openness_revisions:!1,openness_duplicates:!1,useIndex:!0,viewer_display_mode:"select"}},loadDefaults:function(e,t){r.loadPref(e,(function(e){if(""!=e)try{for(var i=o.decode(e),n=0;n<widget.preferences.length;n++){var r=widget.preferences[n].name,s=i[r];null!=s&&widget.setValue(r,s)}}catch(e){console.log(e)}t()}))},addWidgetPrefs:function(e){var t=[{name:"credentialPrefName",type:"hidden",V1:!0,V2:!0},{name:"serverTimingVerbose",type:"hidden",defaultValue:"_serverTimingVerbose",V1:!0,V2:!0},{name:"vizStructPanel",type:"hidden",defaultValue:!0,V1:!0},{name:"vizAttrTable",type:"hidden",defaultValue:!1,V1:!0},{name:"vizViewerPanel",type:"hidden",defaultValue:!0,V1:!0},{name:"ratioStructPanel",type:"hidden",defaultValue:-1,V1:!0},{name:"ratioAttrTable",type:"hidden",defaultValue:-1,V1:!0},{name:"ratioViewerPanel",type:"hidden",defaultValue:-1,V1:!0},{name:"vizOverview",type:"boolean",label:s.showOverviewBar,defaultValue:!0,V1:!0},{name:"vizLegend",type:"boolean",label:s.showCompareStatusLegend,defaultValue:!0,V1:!0},{name:"openness_revisions",type:"boolean",label:s.opennessRevision,defaultValue:!1,V1:!0,V2Migrate:!0},{name:"openness_duplicates",type:"boolean",label:s.opennessDuplicates,defaultValue:!1,V1:!0,V2Migrate:!0},{name:"useIndex",type:"boolean",label:s.useIndex,defaultValue:!0,V1:!0,V2Migrate:!0},{name:"showDocs",type:"boolean",label:s.showDocs,defaultValue:!1,V1:!0,V2Migrate:!0},{name:"showOtherRels",type:"boolean",label:s.showOtherRels,defaultValue:!1,V1:!0,V2Migrate:!0},{name:"viewer_display_mode",type:"list",label:s.viewerDisplayMode,defaultValue:"V1"===e?"isolate":"select",options:[{label:s.selectInTreeIsolateInViewer,value:"isolate"},{label:s.selectInTreeSelectInViewer,value:"select"}],V1:!0,V2Migrate:!0},{name:"attributes_not_shown",type:"hidden",defaultValue:"",V1:!0,V2Migrate:!0},{name:"attributes_not_shown_INST",type:"hidden",defaultValue:"",V1:!0,V2Migrate:!0},{name:"attributes_not_shown_EFF",type:"hidden",defaultValue:"",V1:!0,V2Migrate:!0}];if(!e)throw Error("WidgetPreferences.addWidgetPreferences: need param name to set widget preferences");t.filter((t=>!0===t[e])).forEach((t=>{"V2Migrate"===e&&(t.type="hidden"),widget.addPreference(t)}))},addWidgetPreference:function(t,i,n){widget.addPreference(e.extend(i,{name:t})),null!=n&&widget.setValue(t,n)},isV1ToV2PrefMigrationComplete:function(e,t,i){let n=this;r.getUserPreferencesPromise(e+"[migratedToV2]").then((function(o){"true"===o||!0===o?t():widget.getValue("saveToWidgetOnly")?n.setV1ToV2PrefMigrationCompletedFlag(e).then(t):i()}),i)},setV1ToV2PrefMigrationCompletedFlag:function(e,t){return r.saveUserPreferencesPromise(e+"[migratedToV2]","boolean"!=typeof t||t)}})})),define("DS/CompareCommon/Input/FilterManager",["UWA/Core","DS/CompareCommon/Input/CompareInputFilterCmd","DS/ENOFilterBIUX/FilterBIComponentProxy"],(function(e,t,i){"use strict";return{initialize:function(e,t,n,o){if(null!=t&&""!==t){if(void 0===this._filterProxy||null===this._filterProxy){function s(e,t){let n=new i({appId:widget.getValue("appId"),widgetId:widget.id,NGFUXId:e,tenant:widget.getValue("x3dPlatformId"),securityContext:t,ExpandSynthesisON:!0,selectionFilterAvailable:!1,volumeFilterAvailable:!1,shareFilterSpec:!0});return null!==n&&(n.setNGFilterOptions({appID:widget.getValue("appId")}),null!=n.setDefaultSecurityContext&&n.setDefaultSecurityContext(t)),n}for(var r of(this._filterCmd=null,this._filterProxy=[],this._filterProxyId=[],void 0!==this._ctxt&&null!==this._ctxt||(this._ctxt=e),n))this._filterProxyId[r.whichOne]="CompareWidget_"+r.whichOne+Date.now().toString(),void 0!==this._filterProxy[r.whichOne]&&null!==this._filterProxy[r.whichOne]||(this._filterProxy[r.whichOne]=s(this._filterProxyId[r.whichOne],t))}this.setApplyCallback(e,n,o)}},setApplyCallback:function(e,t,i){for(var n of t)this._filterProxy&&void 0!==this._filterProxy[n.whichOne]&&null!==this._filterProxy[n.whichOne]&&(this._filterProxy[n.whichOne].removeEvent("ApplyNGFilter"),this._filterProxy[n.whichOne].addEvent("ApplyNGFilter",i,e))},isCtxt:function(e){return this._ctxt===e},activateProxy:function(e){void 0!==this._filterProxy[e]&&null!==this._filterProxy[e]?this._filterProxy[e].activate():console.log("Compare FilterManager: activateProxy() failed")},getFilterProxy:function(e){var t=null;return void 0!==this._filterProxy[e]&&null!==this._filterProxy[e]?t=this._filterProxy[e]:console.log("Compare FilterManager: getFilterProxy() failed"),t},executeFilterCmd:function(e,i){void 0!==this._filterCmd&&null!==this._filterCmd&&this._filterCmd.NGFUXId===this._filterProxyId[e]?this._filterCmd.setRoot(i):this._filterCmd=new t({ID:"DefineFilter",root:i,NGFUXId:this._filterProxyId[e]}),this._filterCmd.execute()},hasFilter:function(e,t){return!0===this._filterProxy[e].hasFilter(t).hasFilter},getFilterSpecificationPromise:function(e,t){var i=this;return new Promise((function(n,o){if("left"===e||"right"===e)if(void 0!==i._filterProxy[e]&&null!==i._filterProxy[e]){let o={rootId:t,NGFUXId:i._filterProxyId[e],widgetId:widget.id,eventName:"getFilterSpec-Compare-"+e};i._filterProxy[e].removeEvent(o.eventName),i._filterProxy[e].addEvent(o.eventName,(function(e){n(e)})),i._filterProxy[e].getPublicFilterSpecification(o)}else o();else o()}))},setFilterSpecificationPromise:function(e,t,i){var n=this;return new Promise((function(o,r){if("left"===e||"right"===e)if(void 0!==n._filterProxy[e]&&null!==n._filterProxy[e]){let r={rootId:t,specification:i,applyFilter:1,eventName:"setFilterSpec-Compare-"+e};n._filterProxy[e].removeEvent(r.eventName),n._filterProxy[e].addEvent(r.eventName,(function(e){o(e)})),n._filterProxy[e].setPublicFilterSpecification(r)}else r();else r()}))},clearFiltering:function(e,t){"left"!==e&&""!==e||void 0===this._filterProxy.left||null===this._filterProxy.left||this._filterProxy.left.removeRoot(t.left),"right"!==e&&""!==e||void 0===this._filterProxy.right||null===this._filterProxy.right||this._filterProxy.right.removeRoot(t.right)}}})),define("DS/CompareCommon/Input/RevisionsManager",["UWA/Core","DS/CompareCommon/Utils","i18n!DS/CompareCommon/assets/nls/CompareInput"],(function(e,t,i){"use strict";return{displayHistoryGraph:function(e,n,o,r){var s=this;require(["DS/ENOXVersionExplorerController/VersionExplorerController","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/LifecycleServices/LifecycleServices","DS/Utilities/TouchUtils","css!DS/CompareCommon/Input/CompareInputRevisionsModal.css"],(function(a,l,c,u,p){s.revisionsExplorer=new a({versionGraphContainer:null,widget:widget,autoUpdate:!1,useGlobalStorage:!0,globalStorageName:"historyUserSettings"}),s.revisionsExplorer.setSingleSelectionMode(),s.revisionsExplorer.disableCommands();var d=null,h=p.getTouchMode(),f={className:"CompareInputRevisionsModal"+(h?"_Touch":""),maximizable:!0,showMaximized:h,dlgTitle:o.dlgTitle,okButtonLabel:o.OKButtonLabel};s.revisionsExplorer.showDialog(f,void 0,!0);var m={displayLegend:!1};u.getHistoryConfigPromise().then((function(e){c.historyConfig=e,c.historyConfig&&c.historyConfig.settings&&(c.historyConfig.settings.defaultView&&(m.displayMode=l.DISPLAY_MODES[c.historyConfig.settings.defaultView]),c.historyConfig.settings.thumbnailGraph&&(c.historyConfig.settings.thumbnailGraph.thumbnailGraphLayout&&(m.thumbnailGraphLayout=c.historyConfig.settings.thumbnailGraph.thumbnailGraphLayout),c.historyConfig.settings.thumbnailGraph.displayThumbnailOverview&&(m.displayThumbnailOverview="true"===c.historyConfig.settings.thumbnailGraph.displayThumbnailOverview)),c.historyConfig.settings.subwayGraph&&(c.historyConfig.settings.subwayGraph.subwaySort&&(m.subwaySortAscending="asc"===c.historyConfig.settings.subwayGraph.subwaySort),"SUBWAY_COMPACT_VIEW"!==c.historyConfig.settings.subwayGraph.viewMode&&"SUBWAY_COMFORTABLE_VIEW"!==c.historyConfig.settings.subwayGraph.viewMode||(m.subwayViewMode=c.historyConfig.settings.subwayGraph.viewMode)))}),(function(){})).finally((function(){c.loadUserSettingsPromise(m,!1,!0,"historyUserSettings").then((function(){let t=l.DATA_MODEL_TYPES.MODEL_HISTORY;null!=o&&!1===o.allowDuplicates&&(t=l.DATA_MODEL_TYPES.MODEL_REVISION),s.revisionsExplorer.publishEvent("ENOXVersionExplorerLoadVersionModel",{id:e.objId,type:e.objType,tenantId:e.tenant,securityContext:e.securityContext,dataModelType:t,onComplete:function(){if(o&&o.disableRoot)s.revisionsExplorer.applyFilter((function(e){var t=!0;if(null!=n)if(Array.isArray(n))for(var i=0;i<n.length;++i)n[i]===e._options.id&&(t=!1);else n===e._options.id&&(t=!1);return t}));o&&o.disableRoot||(s.revisionsExplorer.publishEvent("ENOXVersionExplorerSetActiveVersion",{id:e.objId}),s.revisionsExplorer.select(e.objId))}})}))})),s.revisionsExplorer.subscribeEvent("ENOXVersionExplorerLoadCompleted",(function(e){if(widget&&widget.body&&o&&o.controlOKButton){var t=widget.body.querySelector(".CompareInputRevisionsModal");t&&(d=t.querySelector("._BTN_OK"))&&(d.disabled=!0)}}),!1),s.revisionsExplorer.subscribeEvent("select",(function(e){o&&o.controlOKButton&&d&&(d.disabled=!1)}),!1),s.revisionsExplorer.subscribeEvent("unselect",(function(e){o&&o.controlOKButton&&d&&(d.disabled=!0)}),!1),s.revisionsExplorer.subscribeEvent("ENOXVersionExplorerModalOK",(function(e){var n=s.revisionsExplorer.getSelectedNodes(),o=n.length;if(o>0){for(var a,l=0;l<o;++l)void 0===a&&(a=n[l].options.data);void 0!==a?r(a):t.showAlertBox("rootRevisionGraphSel",i,"warning")}else t.showAlertBox("noRevisionGraphSel",i,"warning");s.revisionsExplorer.cleanup(),s.revisionsExplorer=null}),!1),s.revisionsExplorer.subscribeEvent("ENOXVersionExplorerModalCancel",(function(e){t.showAlertBox("noRevisionGraphSel",i,"warning"),s.revisionsExplorer.cleanup(),s.revisionsExplorer=null}),!1)}))},closeHistoryGraphDialog:function(){null!==this.revisionsExplorer&&this.revisionsExplorer.hideDialog(),this.revisionsExplorer=null}}})),define("DS/CompareCommon/Input/CompareInput",["UWA/Core","DS/WAFData/WAFData","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Mask","DS/UIKIT/Iconbar","DS/Controls/Toggle","DS/Controls/ButtonGroup","DS/Controls/ResponsiveTileView","DS/Controls/TooltipModel","DS/Tweakers/GeneratedToolbar","DS/ENOXEmptyContent/js/ENOXEmptyContent","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/CompareImgSrc","DS/CompareCommon/CompareMetaData","DS/CompareCommon/DragAndDrop","DS/CompareCommon/Utils","DS/CompareCommon/CompareIdData","DS/CompareCommon/CompareIdDataListItem","DS/CompareCommon/Input/SearchManager","DS/CompareCommon/Input/RevisionsManager","DS/CompareCommon/Input/FilterManager","DS/ENOCollabToolsUI/tracker/ENOCollabTracker","DS/CompareCommon/Probs/CompareAnalyticsProb","i18n!DS/UIKIT/assets/nls/UIKIT","i18n!DS/CompareCommon/assets/nls/CompareInput","i18n!DS/CompareCommon/assets/nls/CompareCustomization","css!DS/PADServices/PADServices.css","css!DS/CompareCommon/Input/CompareInput.css"],(function(e,t,i,n,o,r,s,a,l,c,u,p,d,h,f,m,g,v,y,b,C,I,D,O,S,j,_,w){"use strict";var x=f.defaultThumbnailPath,L=f.getObjTypeIconPath("Default"),T=f.thumbnailUrlPath,P=f.iconUrlPath,E="",A=[];A.left="",A.right="";const N="left",F="right",R="compare-input-root",B="compare-input-drop-targets",V="compare-input-container",k=V+"-"+F,U="compare-input-drop-target",M=U+"-"+N,W=U+"-"+F,X="compare-input-middle-cmds",Q="compare-input-swap-button",G="compare-input-empty",z=G+"-"+N,H=G+"-"+F,q="compare-input-dropzone",J="compare-input-drop-label",K=J+"-"+N,Z=J+"-"+F,$="compare-input-panel",Y=$+"-root",ee=$+"-dropArea",te="addObjects",ie="addObjRev",ne="addObjFilter",oe=$+"-"+te,re=oe+"-"+N,se=oe+"-"+F,ae=$+"-"+ie,le=ae+"-"+N,ce=ae+"-"+F,ue=$+"-"+ne,pe=ue+"-"+N,de=ue+"-"+F,he="compare-input-tile",fe=he+"-"+N,me=he+"-"+F,ge="compare-input-search",ve=ge+"-"+N,ye=ge+"-"+F,be="compare-input-filterOf",Ce=be+"-"+N,Ie=be+"-"+F,De="compare-input-revsOf",Oe=De+"-"+N,Se=De+"-"+F;var je=function(e){};function _e(e,t){null!==e&&(e.shiftKey?(jQuery("."+ie).hide(),jQuery("."+ne).hide()):(jQuery("."+ie).show(),jQuery("."+ne).show()),jQuery("#"+G+"-"+t).addClass("compare-input-while-dragging"),jQuery("#"+q+"-"+t).show(),jQuery("#"+he+"-"+t).addClass("compare-input-while-dragging"))}function we(e,t,i){var n=t+"-"+i;E=n,jQuery("#"+n).children().addClass("zoneHighlighted")}function xe(e,t,i){var n=t+"-"+i;jQuery("#"+n).children().removeClass("zoneHighlighted"),n===E&&(jQuery("#"+G+"-"+i).removeClass("compare-input-while-dragging"),jQuery("#"+q+"-"+i).hide(),jQuery("#"+he+"-"+i).removeClass("compare-input-while-dragging"),E="")}function Le(e,t){var i=e["PLMEntity.V_Name"];return null!=i&&""!==i||(i=e.Title),null!=i&&""!==i||(i=e.displayName),null!=i&&""!==i||(i=e.name),1==t&&(i+=" "+e.revision),i}var Te=function(e,t){this.proxyType=e.proxyType||"passport",this.rootServiceURL=e.rootServiceURL||"",this.tenant="undefined"!=typeof widget&&widget?widget.getValue("x3dPlatformId"):null,null!=this.tenant&&""!=this.tenant||(this.tenant="OnPremise"),this.securityContext="uninitialized",this.runOptions={},this.loadFromCompassOK=!0,this._allowCompareFromDifferentTenants=!1!==e.allowCompareFromDifferentTenants,this._CCM=t,this.init(e)};function Pe(t,i,n,o){return e.createElement("div",{id:$+"-"+t+"-"+o,class:"enx-welcome-panel-dropZoneGlobal "+t,html:[{tag:"div",class:"enx-welcome-panel-dropZone "+t,html:[{tag:"div",class:"enx-welcome-panel-dropIconAndText "+t,html:[{tag:"i",styles:{"margin-left":"inherit"},class:"enx-welcome-panel_img wux-ui-3ds wux-ui-3ds-4x wux-ui-3ds-"+i,html:[]},{tag:"h5",class:"enx-welcome-panel_txt "+t,html:n}]}]}]})}function Ee(e,t){var i=!0;return null!=e&&void 0!==e.serviceId&&null!==e.serviceId&&""!==e.serviceId&&"3dspace"!==e.serviceId.toLowerCase()&&(i=!1),!0===t&&(i=!1),i}function Ae(e,t){var i=document.createElement("div");i.title=_.get("FilterBadgeTip"),"filter"===t.type&&void 0!==t.title&&null!==t.title&&""!==t.title&&(i.title=_.get("FilterBadgeTip")+" ("+t.title+")"),i.className="wux-button-icon-fi wux-ui-genereatedicon-fi wux-ui-genereatedicon-badge-bottom-right wux-ui-3ds","filter"===t.type&&(i.className+=" wux-ui-3ds-filter"),i.style="font-size: 2em; color: #aaa",(Array.isArray(e)?e:[e]).forEach((function(e){e.elements.picture.appendChild(i)}))}function Ne(e,t){var i=null;return null!=t&&void 0!==t.input&&null!==t.input&&t.input.length>0&&("left"===e?t.input.length>0&&void 0!==t.input[0].RevisionsDialogTitle&&null!==t.input[0].RevisionsDialogTitle&&""!==t.input[0].RevisionsDialogTitle&&(i=t.input[0].RevisionsDialogTitle):t.input.length>1&&void 0!==t.input[1].RevisionsDialogTitle&&null!==t.input[1].RevisionsDialogTitle&&""!==t.input[1].RevisionsDialogTitle&&(i=t.input[1].RevisionsDialogTitle)),i}return Te.prototype.init=function(){E="",this.idDataList=null,this.validateObj_stateData={},this.tile=[],this.tile.left=null,this.tile.right=null},Te.prototype.doInput=function(e,t,i,n){this.launchCompareCustomizationCB=n,this.doCompareCB=i,this.init(),this.buildSkeleton(e),this.setupDragAndDropHandling(),this.initializeData(t)},Te.prototype.buildSkeleton=function(t){this.displayOrientation=this.computeOrientation(t);var i="side-by-side"===this.displayOrientation?"row":"column",n=v.fetchContentFromCompass();null!=n&&void 0!==n.runOptions&&null!==n.runOptions&&void 0!==n.runOptions.cmdOptions&&null!==n.runOptions.cmdOptions&&(this.runOptions=n.runOptions.cmdOptions),this.inputRoot=e.createElement("div",{id:R,html:[]}),this.inputRoot.inject(t),this.inputRoot.hide(),this.buildSkeleton_Header(this.inputRoot),this.buildSkeleton_Body(this.inputRoot,i),this.buildSkeleton_Footer(this.inputRoot),window.addEventListener("resize",this.updateDisplayOrientation.bind(this))},Te.prototype.buildSkeleton_Header=function(t){var i=this,n=e.createElement("div",{id:"compare-input-header",html:[]}).inject(t),o=[];if(!0===widget.CV2EnableCustomProfile&&this.launchCompareCustomizationCB instanceof Function&&!1!==this.runOptions.SupportsCompareCustomization&&(o.push({id:"compareInputCustomizationProfile",dataElements:{domId:"compare-input-customization-profile",typeRepresentation:"customEnumMember",label:w.get("ComparisonProfileLabel"),displayLabel:"true",value:"",possibleValues:[""],position:"far",category:"1",visibleFlag:!1},onNodeUpdate:function(e){e.getAttributeValue("data")},hasTooltip:!0,tooltipInfos:v.generateTooltip("CompareWidget2/Tooltips","mainToolbarCustomizationProfile")}),o.push({id:"compareInputEditCustomization",dataElements:{domId:"compare-input-settings",typeRepresentation:"functionIcon",value:function(){i.launchCompareCustomizationCB(i.tenant,i.securityContext)},position:"far",icon:{iconName:"cog",fontIconFamily:1},category:1},hasTooltip:!0,tooltipInfos:v.generateTooltip("CompareWidget2/Tooltips","mainToolbarEditCustomization")})),o.length>0){let e=u.prototype.createTreeDocument({entries:o});this.mainToolbar=new u({items:e}).inject(n)}},Te.prototype.buildSkeleton_Body=function(t,i){var n=this,o=e.createElement("div",{id:"compare-input-body"}).inject(t),r=e.createElement("div",{id:"compare-input-drop"}).inject(o),s=e.createElement("div",{id:B,styles:{height:"100%","flex-direction":i}}).inject(r);this.buildSkeleton_Body_Input("left",s),this.buildSkeleton_MidCmds(s),this.buildSkeleton_Body_Input("right",s);jQuery("#"+ve).click((function(){n.searchButtonPressed("left")})),jQuery("#"+Oe).click((function(){n.revisionsOfButtonPressed("left")})),jQuery("#"+Ce).click((function(){n.filtersOfButtonPressed("left")})),jQuery("#"+ye).click((function(){n.searchButtonPressed("right")})),jQuery("#"+Se).click((function(){n.revisionsOfButtonPressed("right")})),jQuery("#"+Ie).click((function(){n.filtersOfButtonPressed("right")})),jQuery("#"+Q).click((function(){n.swapColumns()}))},Te.prototype._objSupportsRevisions=function(e){var t=!0;if(null!==e){var i=this.validateObj_stateData[e];null==i||Ee(i)||(t=!1)}return t},Te.prototype._objSupportsEffectivityBasedRevisions=function(e){var t=!1;if(null!==e){var i=this.validateObj_stateData[e];null!=i&&!0===i.supportsEffectivityBasedRevisions&&(t=!0)}return t},Te.prototype._supportsRevisions=function(e,t){var i=this._objSupportsRevisions(e),n=!0;return void 0!==this.runOptions.input&&null!==this.runOptions.input&&this.runOptions.input.length>0&&("left"===t||0===t?this.runOptions.input.length>0&&!0===this.runOptions.input[0].NoRevisionOf&&(n=!1):this.runOptions.input.length>1&&!0===this.runOptions.input[1].NoRevisionOf&&(n=!1)),i&&n},Te.prototype._objSupportsFilters=function(e,t){var i=!0;if(null!==e){var n=this.validateObj_stateData[e];null!=n&&(i=!!n.isFilterSupported)}return i},Te.prototype._supportsFilters=function(e,t){var i=this._objSupportsFilters(e),n=!0;return void 0!==this.runOptions.input&&null!==this.runOptions.input&&this.runOptions.input.length>0&&("left"===t||0===t?this.runOptions.input.length>0&&!0===this.runOptions.input[0].NoFilterOf&&(n=!1):this.runOptions.input.length>1&&!0===this.runOptions.input[1].NoFilterOf&&(n=!1)),i&&n},Te.prototype._supportsSwapping=function(){var e=!0;if(null!==this.idDataList){var t=this._supportsFilters(null,"left"),i=this._supportsFilters(null,"right"),n=this.idDataList.items[0],o=this.idDataList.items[1],r=!(!n||!n.filterData),s=!(!o||!o.filterData);(r&&!i||s&&!t)&&(e=!1)}return e},Te.prototype._supportsOpenContent=function(e){var t=!0;return void 0!==this.runOptions.input&&null!==this.runOptions.input&&this.runOptions.input.length>0&&("left"===e||0===e?this.runOptions.input.length>0&&!0===this.runOptions.input[0].NoOpenContent&&(t=!1):this.runOptions.input.length>1&&!0===this.runOptions.input[1].NoOpenContent&&(t=!1)),t},Te.prototype._supportsRemoveItem=function(e){var t=!0;return void 0!==this.runOptions.input&&null!==this.runOptions.input&&this.runOptions.input.length>0&&("left"===e||0===e?this.runOptions.input.length>0&&!0===this.runOptions.input[0].NoRemove&&(t=!1):this.runOptions.input.length>1&&!0===this.runOptions.input[1].NoRemove&&(t=!1)),t},Te.prototype._supportsDropZones=function(e){var t=!0;return void 0!==this.runOptions.input&&null!==this.runOptions.input&&this.runOptions.input.length>0&&("left"===e||0===e?this.runOptions.input.length>0&&!0===this.runOptions.input[0].NoDropZones&&(t=!1):this.runOptions.input.length>1&&!0===this.runOptions.input[1].NoDropZones&&(t=!1)),t},Te.prototype._setSupportsDropZones=function(e,t){void 0!==this.runOptions.input&&null!==this.runOptions.input&&this.runOptions.input.length>0&&("left"===e||0===e?this.runOptions.input.length>0&&(this.runOptions.input[0].NoDropZones=!t):this.runOptions.input.length>1&&(this.runOptions.input[1].NoDropZones=!t))},Te.prototype.buildSkeleton_Body_Input=function(t,n){var o=e.createElement("div",{id:V+"-"+t,styles:"left"!==t?{display:"none"}:{}}).inject(n),r=e.createElement("div",{id:U+"-"+t,class:"compare-input-drop-target",styles:"left"===t?{"min-width":"100px","overflow-x":"overlay",border:"none"}:{"overflow-y":"overlay","overflow-x":"overlay"}}).inject(o);(function(t,i,n){var o=null;if(null!=n&&(o=e.createElement("div").inject(i),void 0!==n.input&&null!==n.input&&n.input.length>0)){var r="";"left"===t?n.input.length>0&&void 0!==n.input[0].Label&&null!==n.input[0].Label&&""!==n.input[0].Label&&(r=n.input[0].Label):n.input.length>1&&void 0!==n.input[1].Label&&null!==n.input[1].Label&&""!==n.input[1].Label&&(r=n.input[1].Label),""!==r&&e.createElement("div",{class:J,id:"left"===t?K:Z,html:r}).inject(o)}})(t,r,this.runOptions),function(t,n,o){var r=new i({id:ge+"-"+t,icon:"open",value:_.get("left"===t?"addObjectsDZ":"searchButtonLabel"),className:"primary"});r.getContent().title=_.get("searchButtonTip"),null!=o&&!0===o.noOpenContent&&(r.getContent().style.display="none");var s=new i({id:De+"-"+t,icon:"flow-branch-list",value:_.get("revisionOfButtonLabel")});s.getContent().title=_.get("revisionOfButtonTip"),null!=o&&!0===o.noRevisionOf&&(s.getContent().style.display="none");var a=new i({id:be+"-"+t,icon:"filter-open",value:_.get("filterOfButtonLabel")});a.getContent().title=_.get("filterOfButtonTip"),null!=o&&!0===o.noFilterOf&&(a.getContent().style.display="none");var l=e.createElement("div",{id:"drop-target-iconlabel-"+t,class:"compare-input-drop-icon-label"}),c=[];c.push({type:"drop",text:_.get("dropHere"),DOMelement:l}),c.push({type:"dom",DOMelement:s.getContent()}),c.push({type:"dom",DOMelement:a.getContent()}),c.push({type:"dom",DOMelement:r.getContent()});var u=new p({sentences:c}),d=e.createElement("div",{id:G+"-"+t,class:G,html:u._containerEmptyContent.outerHTML}).inject(n);d.childNodes[0].childNodes[0].style.width="100%";var h=d.childNodes[0].childNodes[0].childNodes[0].childNodes;let f=null==o||!0!==o.noDropZones;h[0].style.display=f?"":"none";for(var m=1;m<h.length-1;++m)h[m].childNodes[0].childNodes[1].style.display="none"}(t,r,{noDropZones:!this._supportsDropZones(t),noFilterOf:"left"===t||!this._supportsFilters(null,t),noRevisionOf:"left"===t||!this._supportsRevisions(null,t),noOpenContent:!this._supportsOpenContent(t)}),function(t,i,n){var o=Pe(te,"open",_.get("open"),t),r=Pe(ie,"flow-branch-list",_.get("revisionOfObjectDZ"),t),s=Pe(ne,"filter-open",_.get("filterOfObjectDZ"),t),a=[];a.push(o),null!=n&&!0===n.noRevisionOf||a.push(r),null!=n&&!0===n.noFilterOf||a.push(s),e.createElement("div",{id:q+"-"+t,class:"compare-input-dropzone",styles:{display:"none"},html:[{tag:"div",id:Y+"-"+t,class:"enx-welcome-panel enx-welcome-panel-root",html:[{tag:"div",id:ee+"-"+t,class:"enx-welcome-panel-dropArea",html:a}]}]}).inject(i)}(t,r,{noDropZones:!this._supportsDropZones(t),noFilterOf:!this._supportsFilters(null,t),noRevisionOf:!this._supportsRevisions(null,t),noOpenContent:!this._supportsOpenContent(t)}),function(t,i,n){e.createElement("div",{id:he+"-"+t,class:"compare-input-tile-container",styles:{display:"none"},html:[]}).inject(i)}(t,r,this.runOptions);return o},Te.prototype.buildSkeleton_MidCmds=function(t){var n=e.createElement("div",{id:X,styles:{display:"none"}}).inject(t),o=e.createElement("div",{class:"compare-input-swap-vertcenter"}).inject(n);return this.swapButton=new i({id:Q,icon:"exchange"}).inject(o),o.tooltipInfos=new c({shortHelp:_.get("swapColumnsTip")}),this.swapButton.getContent().children[0].setStyle("margin","-4px 0px 0px 5px"),n},Te.prototype.buildSkeleton_Footer=function(t){var o=this;if(this.inputFooter=e.createElement("div",{id:"compare-input-footer",html:[]}).inject(t),void 0!==this.runOptions.settings&&null!==this.runOptions.settings&&this.runOptions.settings.length>0){let t=e.createElement("div",{class:"compare-input-drop-settings"}).inject(this.inputFooter);var r=null,l=0;for(var c of this.runOptions.settings)if(void 0!==c.Label&&null!==c.Label&&""!==c.Label){c.Id="compare-setting-"+l,++l;var u=new s({type:"checkbox",id:c.Id,label:c.Label,checkFlag:!0===c.Value});if(void 0!==c.Value&&null!==c.Value&&!1!==c.Value&&!0!==c.Value&&""!==c.Value){var p=c.Value;c.Id;require(["DS/CompareWidget2/userSettings/UserSettingsManager"],(e=>{var t=0;let i=setInterval((()=>{++t,e.hasPref(p)&&(clearInterval(i),c.Value=e.get(p),!0!==c.Value&&!1!==c.Value||(u.checkFlag=c.Value,u.addEventListener("change",(function(t){var i=t.dsModel;e.set(p,i.checkFlag)})))),t>20&&clearInterval(i)}),500)}))}null===r&&(r=new a({type:"checkbox"})),r.addChild(u)}null!==r&&r.inject(t)}var d=_.get("CompareStructures");void 0!==this.runOptions.CompareCmdLabel&&null!==this.runOptions.CompareCmdLabel&&""!==this.runOptions.CompareCmdLabel&&(d=this.runOptions.CompareCmdLabel);let h=[];this.compareBtn=new i({value:d,className:"primary",id:"compare-input-button-compare",events:{onClick:function(e,t){console.log("CompareInput Compare button was clicked"),o.doCompare()}}}),h.push(this.compareBtn),this.removeAllBtn=new i({value:_.get("RemoveAll"),id:"compare-input-button-cancel",events:{onClick:function(e,t){console.log("CompareInput Remove All button was clicked"),o.clearItem("all")}}}),h.push(this.removeAllBtn);var f=new n({buttons:h}).inject(this.inputFooter);this.compareBtn.getContent().title=_.get("CompareButtonTip"),this.removeAllBtn.getContent().title=_.get("CancelButtonTip"),this.inputFooter.hide(),f.elements.container.addClassName("compare-input-buttongroup"),this.compareBtn.elements.container.setStyles({"margin-right":"10px","border-radius":"4px"}),this.removeAllBtn.elements.container.setStyles({"border-radius":"4px"})},Te.prototype.setupDragAndDropHandling=function(){this._supportsDropZones("left")&&(g.attachObject(M,this,this.dragEnterPanelLeft,this.dragLeavePanelLeft,this.dropHandler,null,0),g.attachObject(re,this,this.dragEnterAddObjectsLeft,this.dragLeaveAddObjectsLeft,this.dropHandler,null,0),g.attachObject(le,this,this.dragEnterAddObjRevLeft,this.dragLeaveAddObjRevLeft,this.dropHandler,null,0),g.attachObject(pe,this,this.dragEnterAddObjFilterLeft,this.dragLeaveAddObjFilterLeft,this.dropHandler,null,0)),this._supportsDropZones("right")&&(g.attachObject(W,this,this.dragEnterPanelRight,this.dragLeavePanelRight,this.dropHandler,null,1),g.attachObject(se,this,this.dragEnterAddObjectsRight,this.dragLeaveAddObjectsRight,this.dropHandler,null,1),g.attachObject(ce,this,this.dragEnterAddObjRevRight,this.dragLeaveAddObjRevRight,this.dropHandler,null,1),g.attachObject(de,this,this.dragEnterAddObjFilterRight,this.dragLeaveAddObjFilterRight,this.dropHandler,null,1))},Te.prototype.shutdownDragAndDropHandling=function(){g.detachObject(M),g.detachObject(W),g.detachObject(re),g.detachObject(le),g.detachObject(pe),g.detachObject(se),g.detachObject(ce),g.detachObject(de)},Te.prototype.dropHandler=function(e,t,i){var n=this;g.reset();var o=e.currentTarget.id,r="drop-left"===i||0==i?"left":"right";D.clearFiltering(r,A),o.startsWith("compare-input-panel-addObjects-")?(console.log("CompareInput handle dropped object "+r),n.validateAndProcessObjDrop(t,r)):o.startsWith("compare-input-panel-addObjRev-")?(console.log("CompareInput handle Revisions of dropped object "+r),n.validateAndProcessRevisionOfDrop(t,r)):o.startsWith("compare-input-panel-addObjFilter-")&&(console.log("CompareInput handle Filters of dropped object "+r),n.validateAndProcessFilterOfDrop(t,r))},Te.prototype.dragEnterPanelLeft=function(e){_e(e,"left")},Te.prototype.dragEnterPanelRight=function(e){_e(e,"right")},Te.prototype.dragEnterAddObjectsLeft=function(e){we(0,oe,"left")},Te.prototype.dragEnterAddObjRevLeft=function(e){we(0,ae,"left")},Te.prototype.dragEnterAddObjFilterLeft=function(e){we(0,ue,"left")},Te.prototype.dragEnterAddObjectsRight=function(e){we(0,oe,"right")},Te.prototype.dragEnterAddObjRevRight=function(e){we(0,ae,"right")},Te.prototype.dragEnterAddObjFilterRight=function(e){we(0,ue,"right")},Te.prototype.dragLeavePanelLeft=function(e){},Te.prototype.dragLeavePanelRight=function(e){},Te.prototype.dragLeaveAddObjectsLeft=function(e){xe(0,oe,"left")},Te.prototype.dragLeaveAddObjRevLeft=function(e){xe(0,ae,"left")},Te.prototype.dragLeaveAddObjFilterLeft=function(e){xe(0,ue,"left")},Te.prototype.dragLeaveAddObjectsRight=function(e){xe(0,oe,"right")},Te.prototype.dragLeaveAddObjRevRight=function(e){xe(0,ae,"right")},Te.prototype.dragLeaveAddObjFilterRight=function(e){xe(0,ue,"right")},Te.prototype.initializeData=function(e){var t=this;this.tenant=widget.getValue("x3dPlatformId");var i=null==this.tenant?null:this.tenant,n=null==this.securityContext?null:this.securityContext;d.app_initialization((function(){h.getSecurityContextPromise(i,n).then((function(i){t.securityContext=i,t.initData(e)}))}))},Te.prototype.initData=function(e){var t=this;D.initialize(this,this.securityContext,[{whichOne:"left"},{whichOne:"right"}],this.onApplyNGFilter);var i=null!=e?e.idDataList:null;if(null==i&&null!=(i=v.fetchPersistedIDs())){var n=i.get_nonNullCount();if(n>0){console.log("CompareInput: initializing with "+n+" persisted ids");for(var r=0;r<i.items.length;++r)void 0!==i.items[r]&&null!==i.items[r]&&void 0!==i.items[r].filterSpec&&null!==i.items[r].filterSpec&&D.setFilterSpecificationPromise(0===r?"left":"right",i.items[r].objectId,i.items[r].filterSpec);v.fetchPersistedIDs()}}if(null!=i)if("modelIDList"===i.listType||"IDPlusCommandsList"===i.listType){let e="IDPlusCommandsList"===i.listType?i.get_allIDList():i.get_objIDList(),n=i.get_objServices();t.validateIdsPromise(e,n).then((function(){if(Array.isArray(n)&&n.length){for(var o of i.items)null!=o&&(o.objectServices.envId||(o.objectServices.envId=t.tenant),o.objectServices.contextId||(o.objectServices.contextId=t.securityContext));t.idDataList=i}else{t.idDataList=new y(i.listType);for(let i=0,n=e.length;i<n;i++){let n=e[i],o={serviceId:t.validateObj_stateData[n].serviceId,envId:t.tenant,objectId:n,objectType:t.validateObj_stateData[n].objectType,contextId:t.securityContext};t.idDataList.items.push(new b(n,o))}}console.log("probs -- compare input open flavor changes from "+S.getTypeOfOpen()+" to another"),S.setTypeOfOpen("another"),t.processValidatedIDs()}),(function(e){"OBJ_INACCESSIBLE"===e?v.showAlertBox("STORED_OBJ_INACCESSIBLE",_,"error"):v.showAlertBox(e,_,"error"),o.unmask(t.inputRoot.parentElement),t.inputRoot.show()}))}else console.log("CompareInput: failure initializing with an unknown type of id list"),this.inputRoot.show();else if(!this.loadFromCompassOK||null!=e&&void 0!==e.noCompassContent&&null!==e.noCompassContent&&!0===e.noCompassContent)t.inputRoot.show();else{var s=v.fetchContentFromCompass();if(null!=s){null!=s.useIndex&&widget.setValue("useIndex",s.useIndex);var a=s.envId;if(null==a&&null!=s.data&&null!=s.data.items&&s.data.items.length>0&&(a=s.data.items[0].envId),null!=a&&0!=a.length&&(t.tenant=a,widget.setValue("x3dPlatformId",t.tenant),je("CompareInput: compass data indicates tenant is now '"+t.tenant+"'")),void 0!==s.data&&null!==s.data){if(console.log("CompareInput: initializing with "+s.data.items.length+" from compass"),void 0!==s.data.items&&null!==s.data.items)for(var l of s.data.items)if(v.objectTypeNotAllowedForCompare(l.objectType))return void t.inputRoot.show();if(s.data.items.length>5)t.inputRoot.show(),v.showAlertBox("selectFiveOrFewer",_,"error");else{void 0!==t.runOptions.ImmediateCompare&&null!==t.runOptions.ImmediateCompare||(t.runOptions.ImmediateCompare=s.data.immediateCompare);var c=s.listType;if(null==c&&(c=v.determineListType(s.data)),"modelIDList"===c||"IDPlusCommandsList"===c){let e=[],i=[];s.data.items.forEach((function(n){if(null!=n){var o=n.contextId,r=null!=o&&o.constructor===String&&0!==o.length?o:t.securityContext;e.push(n.objectId),i.push({serviceId:n.serviceId,envId:n.envId,objectId:n.objectId,objectType:n.objectType,contextId:r,displayName:n.displayName,displayType:n.displayType,idType:n.idType,commands:n.commands,queryDef:n.filterQuery,filterSpec:n.filterSpec})}})),t.validateIdsThenCall(e,i,(function(){null==t.idDataList&&(t.idDataList=new y(c));for(var n=0;n<e.length;++n){null==i[n].objectType&&(i[n].objectType=t.validateObj_stateData[e[n]].objectType);var o=new b(e[n],i[n]);void 0!==i[n].filterSpec&&null!==i[n].filterSpec&&(o.filterSpec=i[n].filterSpec),void 0!==i[n].queryDef&&null!==i[n].queryDef&&(o.queryDef=i[n].queryDef),t.idDataList.items.push(o)}for(n=0;n<t.idDataList.items.length;++n)void 0!==t.idDataList.items[n]&&null!==t.idDataList.items[n]&&void 0!==t.idDataList.items[n].filterSpec&&null!==t.idDataList.items[n].filterSpec&&D.setFilterSpecificationPromise(0===n?"left":"right",t.idDataList.items[n].objectId,t.idDataList.items[n].filterSpec);var r=s.biProxyCtx;if(null!=r){var a=s.data.items.map((function(e){return e.objectId}));t.processIdsContainingFilters(a,r,!1,"left")}console.log("probs -- compare input open flavor changes from "+S.getTypeOfOpen()+" to another"),S.setTypeOfOpen("another"),t.processValidatedIDs()}))}}}else t.inputRoot.show()}else t.inputRoot.show()}},Te.prototype.searchButtonPressed=function(e){console.log("CompareInput: "+e+" Search button press handler");var t=this;C.displaySearchPanel(this.tenant,!0,this.runOptions,(function(i){t.onSelectedFromSearch(e,i)}))},Te.prototype.revisionsOfButtonPressed=function(e){console.log("CompareInput: Revisions of  "+e+" button press handler");var t=this;if("left"===e||"right"===e){var i=this.idDataList.get_objServices("left"===e?"right":"left");if(null!=i&&i.length>0)if(this._objSupportsEffectivityBasedRevisions(i[0].objectId))this.filtersOfButtonPressed(e);else{var n=t.validateObj_stateData[i[0].objectId],o={objId:n.isFilter?n.filter.rootObj.physicalid:i[0].objectId,objType:n.isFilter?n.filter.rootObj.internalType:i[0].objectType,tenant:this.tenant,securityContext:this.securityContext},r=null;t.runOptions.DisableRootInRevisionsDialog&&(r=o.objId);var s=Ne(e,t.runOptions);I.displayHistoryGraph(o,r,{allowDuplicates:t.runOptions.AllowDuplicatesInRevisionsDialog,disableRoot:t.runOptions.DisableRootInRevisionsDialog,controlOKButton:t.runOptions.ControlOKButtonInRevisionsDialog,OKButtonLabel:t.runOptions.RevisionsDialogOKButtonLabel,dlgTitle:s},(function(n){var o=[],r=n.physicalid;o.push(r);var s=[],a=void 0;null!=i&&i.length>0&&void 0!==i[0]&&null!==i[0]&&(a={envId:i[0].envId,objectId:r,objectType:n.type,serviceId:i[0].serviceId,contextId:i[0].contextId,displayName:n.displayName}),s.push(a),t.validateIdsThenCall(o,s,(function(){var i=new b(o[0],s[0]);"left"===e?t.idDataList.items[0]=i:t.idDataList.items.length>1?t.idDataList.items[1]=i:t.idDataList.items.push(i),"left"!==e&&"right"!==e||D.clearFiltering(e,A),console.log("probs -- compare input open flavor changes from "+S.getTypeOfOpen()+" to revision"),S.setTypeOfOpen("revision"),t.processValidatedIDs()}))}))}else console.log("CompareInput: revisionsOfButtonPressed failure")}else console.log("CompareInput: revisionsOfButtonPressed failure")},Te.prototype.filtersOfButtonPressed=function(e){console.log("CompareInput: Filters of  "+e+" button press handler");if("left"===e||"right"===e){var t=this.idDataList.get_objServices("left"===e?"right":"left");if(null!=t&&t.length>0){var i=this.validateObj_stateData[t[0].objectId],n={objId:i.isFilter?i.filter.rootObj.physicalid:t[0].objectId,objType:i.isFilter?i.filter.rootObj.internalType:t[0].objectType,tenant:this.tenant,securityContext:this.securityContext,displayName:Le(i.isFilter?i.filter.rootObj:i,!0)};this.displayFilterPanel(e,n)}else console.log("CompareInput: filtersOfButtonPressed failure")}else console.log("CompareInput: filtersOfButtonPressed failure")},Te.prototype.replaceWithRevisionOf=function(e){console.log("CompareInput Revision context menu handler reached");var t=this;if("left"===e||"right"===e){var i=this.idDataList.get_objServices(e);if(null!=i&&i.length>0){var n=t.validateObj_stateData[i[0].objectId],o={objId:n.isFilter?n.filter.rootObj.physicalid:i[0].objectId,objType:n.isFilter?n.filter.rootObj.internalType:i[0].objectType,tenant:this.tenant,securityContext:this.securityContext},r=null;t.runOptions.DisableRootInRevisionsDialog&&(r=o.objId);var s=Ne(e,t.runOptions);I.displayHistoryGraph(o,r,{allowDuplicates:t.runOptions.AllowDuplicatesInRevisionsDialog,disableRoot:t.runOptions.DisableRootInRevisionsDialog,controlOKButton:t.runOptions.ControlOKButtonInRevisionsDialog,OKButtonLabel:t.runOptions.RevisionsDialogOKButtonLabel,dlgTitle:s},(function(n){var o=[],r=n.physicalid;o.push(r);var s=[],a={envId:i[0].envId,objectId:r,objectType:i[0].objectType,serviceId:i[0].serviceId,contextId:i[0].contextId,displayName:n.displayName};s.push(a),t.validateIdsThenCall(o,s,(function(){var i=new b(o[0],s[0]);t.idDataList.items["left"===e?0:1]=i,"left"!==e&&"right"!==e||D.clearFiltering(e,A),t.processValidatedIDs()}))}))}else console.log("CompareInput: replaceWithRevisionOf failure")}else console.log("CompareInput: replaceWithRevisionOf failure")},Te.prototype.replaceWithFilterOf=function(e){console.log("CompareInput Filter context menu handler reached");if("left"===e||"right"===e){var t=this.idDataList.get_objServices(e);if(null!=t&&t.length>0){var i=this.validateObj_stateData[t[0].objectId],n={objId:i.isFilter?i.filter.rootObj.physicalid:t[0].objectId,objType:i.isFilter?i.filter.rootObj.internalType:t[0].objectType,tenant:this.tenant,securityContext:this.securityContext,displayName:Le(i.isFilter?i.filter.rootObj:i,!0)};this.displayFilterPanel(e,n)}else console.log("CompareInput: replaceWithFilterOf failure")}else console.log("CompareInput: replaceWithFilterOf failure")},Te.prototype.replaceWithSearch=function(e){console.log("CompareInput: "+e+" Open context menu handler reached");var t=this;C.displaySearchPanel(this.tenant,!0,this.runOptions,(function(i){t.onSelectedFromSearch(e,i)}))},Te.prototype.swapColumns=function(){if(console.log("CompareInput Swap Columns context menu handler reached"),A.left=null,A.right=null,void 0!==this.idDataList&&null!==this.idDataList){var e=this.idDataList.items[0];this.idDataList.items[0]=this.idDataList.items.length>1?this.idDataList.items[1]:null,this.idDataList.items[1]=e;var t={idDataList:this.idDataList};this.initData(t)}},Te.prototype.validateAndProcessObjDrop=function(e,t){this.validateAndProcessDrop(e,t)},Te.prototype.validateAndProcessDrop=function(e,t,i){var n=this,o=e.objArray,r=o.map((function(e){return e.objectId})),s=r.length,a=null!=i&&i.forRevisionOf,l=null!=i&&i.forFilterOf,c=!1;if(a){if(1!==s)return void v.showAlertBox("onlyOneObjForRevOf",_,"warning")}else if(l){if(1!==s)return void v.showAlertBox("onlyOneObjForFilterOf",_,"warning")}else{if(s+(null!=this.idDataList?this.idDataList.get_nonNullCount():0)>5)return v.showAlertBox("selectFiveOrFewer",_,"error"),void widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_immediateDone","CompareInput immediate state ready");if(s<1)return void console.warn("WARNING: unexpected drop count... no processing to be done");c=!0}for(var u of o)if(v.objectTypeNotAllowedForCompare(u.objectType))return;var p=o[0].envId;null!=p&&0!=p.length||(p=null);var d=widget.getValue("x3dPlatformId");if(null!=p){if(!this.checkAdjustTenant(s,t,d,p))return}else je("Dropped ID has no tenant info / value not changed, value remains "+d);var h=o.map((function(e){var t={};for(var i in e)t[i]=e[i];return t}));c&&(console.log("probs -- compare input open flavor changes from "+S.getTypeOfOpen()+" to another"),S.setTypeOfOpen("another")),this.validateIdsThenCall(r,h,(function(){a&&!0===n._objSupportsEffectivityBasedRevisions(h[0].objectId)?v.confirmDialog(_.get("CompareEffectivityBasedRevisions"),"info",{label:j.ok,callback:function(){a=!1,l=!0,n.validateAndProcessDrop_finish(r,h,t,e,i,a,l)}},{label:j.ko,callback:function(){n.validateAndProcessDrop_finish(r,h,t,e,i,!1,!1)}}):n.validateAndProcessDrop_finish(r,h,t,e,i,a,l)}))},Te.prototype.validateAndProcessDrop_finish=function(e,t,i,n,o,r,s){var a=this;r?a.processValidatedId_RevisionOf(e,t,i):a.processValidatedIds_Drop(e,t,i,n.filterProxy,o,(function(n){s&&-1!==i.indexOf(n)&&(a._supportsFilters(e[0],n)?a.processValidatedId_FilterOf(e,t,n):v.showAlertBox("filtersNotSupported",_,"warning"))}))},Te.prototype.processValidatedIds_Drop=function(e,t,i,n,o,r){if(null==this.idDataList&&(this.idDataList=new y("modelIDList")),e.length>1&&2===this.idDataList.items.length&&null===this.idDataList.items[0]&&null!==this.idDataList.items[1])console.log("CompareInput: Only 1 dropped object expected on left when right object is already specified.");else{for(var s=0;s<e.length;++s){var a=new b(e[s],t[s]);if(1===e.length)"left"===i?this.idDataList.items[0]=a:"right"===i&&(this.idDataList.items[1]=a);else{if(2===this.idDataList.items.length&&null!==this.idDataList.items[0]&&null===this.idDataList.items[1]){this.idDataList.items.pop()}this.idDataList.items.push(a)}}if(null!=n){var l=null!=o&&o.forFilterOf;this.processIdsContainingFilters(e,n,l,i)}}this.processValidatedIDs(r)},Te.prototype.processIdsContainingFilters=function(e,t,i,n){var o=this;let r=e.length;1===r?o.processIdContainingFilters(e[0],D.getFilterProxy(n),t,i,n):2===r&&"left"===n&&o.processIdContainingFilters(e[0],D.getFilterProxy("left"),t,i,"left").then((()=>{o.processIdContainingFilters(e[1],D.getFilterProxy("right"),t,i,"right")})).catch((e=>{console.log("CompareInput processIdContainingFilters failure")}))},Te.prototype.processIdContainingFilters=function(e,t,i,n,o){var r=this;return new Promise((function(s,a){if(null==t)console.log("CompareInput processIdContainingFilters: filter proxy not initialized"),a();else{t.activate();var l=[e];console.log("CompareInput processIdContainingFilters: "+o+": before areRootsSharable()?"),t.areRootsSharable(l,i).then((function(e){console.log("CompareInput processIdContainingFilters: "+o+": after areRootsSharable()?"),null!=e?(console.log("CompareInput processIdContainingFilters: "+o+": "+e.length+" rootsSharable"),e.forEach((function(e){!0===e.hasFilter?(console.log("CompareInput processIdContainingFilters: "+o+": rootsSharable and hasFilter, calling shareFilterSpec: "+e.rootId),t.shareFilterSpec({fromRootId:e.rootId,fromSourceCtx:i,fromDropOnFilter:n,callback:function(e){console.log("CompareInput processIdContainingFilters: "+o+": reached shareFilterSpec callback"),r.shareFilterSpecCB(e,o),s()}})):s()}))):s()}))}}))},Te.prototype.shareFilterSpecCB=function(e,t){var i=e.success;if(null!=i&&i.length>0)if(void 0!==i[0].filter&&null!==i[0].filter){console.log("CompareInput processIdContainingFilters: "+t+": shareFilter success, applied filter definition retrieved OK");var n=this.tile[t];let e="left"===t?0:1;i[0].rootId===this.idDataList.items[e].objectId&&null==this.idDataList.items[e].filterData?(this.idDataList.items[e].filterData=i[0].filter,console.log("CompareInput processIdContainingFilters: "+t+": SUCCESS applying applied filter")):console.log("CompareInput processIdContainingFilters: "+t+": error applying applied filter"),v.persistIDs(this.idDataList),null!=n&&Ae(n,{type:"filter",title:i[0].filter.filterTitle})}else void 0!==i[0].filterId&&null!==i[0].filterId&&i[0].filterId.length>0&&void 0!==i[0].filterId[0]&&null!==i[0].filterId[0]&&""!==i[0].filterId[0]?(console.log("CompareInput processIdContainingFilters: "+t+": filter definition FAIL, using filterId to retrieve definition instead"),("left"===t&&i[0].rootId===this.idDataList.items[0].objectId||"right"===t&&i[0].rootId===this.idDataList.items[1].objectId)&&(this.replaceIdWithFilterId(t,i[0].filterId[0]),console.log("CompareInput processIdContainingFilters: "+t+": shareFilter success, filter definition FAIL, filterId SUCCESS"))):console.log("CompareInput processIdContainingFilters: "+t+": shareFilter success, filter definition FAIL, filterId FAIL");else console.log("CompareInput processIdContainingFilters: "+t+": shareFilter NO success")},Te.prototype.replaceIdWithFilterId=function(e,t){var i=this,n=[t],o=[{envId:null,objectId:t,objectType:"ENOStrRefinementSpecification",serviceId:null}];i.validateIdsThenCall(n,o,(function(){var t=new b(n[0],o[0]);"left"===e?i.idDataList.items[0]=t:i.idDataList.items.length>1?i.idDataList.items[1]=t:i.idDataList.items.push(t),"left"!==e&&"right"!==e||D.clearFiltering(e,A),i.processValidatedIDs()}))},Te.prototype.validateIdsThenCall=function(e,t,i){this.validateIdsPromise(e,t).then((function(){i()}),(function(e){i()}))},Te.prototype.validateIdsPromise=function(e,t){var i=this;return new Promise((function(n,r){if(e.length>0)if(null!=t&&t.length>0&&void 0!==t[0]&&null!==t[0]&&!Ee(t[0])){o.mask(i.inputRoot.parentElement),m.get(t[0],i.proxyType).then((function(e){t.forEach((function(t){let n={physicalid:t.objectId,objectId:t.objectId,objectType:t.objectType,serviceId:t.serviceId,attributesUrl:{url:e.url,attributes:e.attributes}};i.updateValidatedObj_StateData(n)})),n()}))}else{if(e.join(",").includes("cid:"))for(var s of t){let e=_.get("OBJ_TYPE_UNSUPPORTED").replace("{msgData}",s.displayName);v.showAlertBox(e,null,"warning")}else{o.mask(i.inputRoot.parentElement);try{v.getObjState(e,t,i.tenant,(function(e){var t=e;null==t||"number"!=typeof t.length?v.showAlertBox("BAD_OBJDATA",_,"error"):v.setSupportsEffectivityBasedRevisions(t,i.tenant,i.securityContext).then((function(){v.accessRightsPromise(t,i.tenant,i.securityContext,(function(e){var o=!1;for(var r of t)!1===r.exists&&(o=!0),e||(r.notAccessible=!0,o=!0);if(!o)for(r of t)r.requiresIndex&&v.forceRequireIndex(!1),r.serviceId="3DSpace",i.updateValidatedObj_StateData(r);for(r of t){if(!1===r.exists){v.showAlertBox("OBJ_NOT_FOUND",_,"error"),widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_leftSideDone","CompareInput left side done"),widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_rightSideDone","CompareInput right side done");break}if(!0===r.notAccessible){v.showAlertBox("OBJ_INACCESSIBLE",_,"error"),widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_leftSideDone","CompareInput left side done"),widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_rightSideDone","CompareInput right side done");break}}o||n()}))}))}),(function(){console.log("CompareUtils.getObjState failed"),r("OBJ_INACCESSIBLE")}))}catch(e){console.log("Exception on '"+v.getObjState+"'")}}}}))},Te.prototype.checkAdjustTenant=function(e,t,i,n){var o=!0;return i===n?je("Tenant info for dropped ID same as current tenant / no change ("+i+", "+n+")"):1===e&&!1===this._allowCompareFromDifferentTenants&&(null!=this.idDataList&&null!=this.idDataList.getLeftID()&&"right"===t||null!=this.idDataList&&null!=this.idDataList.getRightID()&&"left"===t)?(v.showAlertBox("tenantMismatch",_,"error"),je("Both objects' tenants must match // "+i+" != "+n+"... rejecting dropped object"),o=!1):(v.showAlertBox("tenantChanged",_,"success"),je("Changing tenant, based upon dropped ID, from '"+i+"' to '"+n+"'"),widget.setValue("x3dPlatformId",n),this.tenant=n),o},Te.prototype.updateValidatedObj_StateData=function(e){var t=e.physID||e.physicalid;if(e.physicalid=t,null==this.validateObj_stateData[t])this.validateObj_stateData[t]=e;else for(var i in e)this.validateObj_stateData[t][i]=e[i]},Te.prototype.processValidatedIDs=function(e){var t=this,i=0;if(null!=t.idDataList&&(i=t.idDataList.get_nonNullCount()),0!==i)if(v.persistIDs(this.idDataList),this.loadFromCompassOK=!1,o.unmask(this.inputRoot.parentElement),this.idDataList.areCompared||i>2||2===i&&this.runOptions.ImmediateCompare||"IDPlusCommandsList"===this.idDataList.listType)console.log("CompareInput Starting an immediate comparison"),widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_immediateDone","CompareInput immediate state ready"),this.doCompare();else{var n=d.get3DSpaceBaseUrl(this.tenant),r=null==this.tenant?null:this.tenant,s=null==this.securityContext?null:this.securityContext,a="passport";d.app_initialization((function(){h.getSecurityContextPromise(r,s).then((function(i){t.inputRoot.show();var r=t.inputRoot.getElement("#"+fe),s=t.inputRoot.getElement("#"+z),l=t.idDataList.getLeftID();if(null!=l){var c=t.validateObj_stateData[l];let i=t.idDataList.get_objServices("left");null!=i&&i.length>0&&void 0!==i[0]&&null!==i[0]&&(void 0!==i[0].preview_url&&null!==i[0].preview_url&&""!==i[0].preview_url&&(c.preview_url=i[0].preview_url),void 0!==i[0].type_icon_url&&null!==i[0].type_icon_url&&""!==i[0].type_icon_url&&(c.type_icon_url=i[0].type_icon_url),void 0!==i[0].displayName&&null!==i[0].displayName&&""!==i[0].displayName&&(c.displayName=i[0].displayName),void 0!==i[0].displayType&&null!==i[0].displayType&&""!==i[0].displayType&&(c.displayType=i[0].displayType)),s.hide(),r.show();let p=t.inputRoot.getElement("div#"+r.parentElement.id);o.mask(p);var u={tenant:i[0].envId,securityContext:i[0].contextId,url3DSpace:d.get3DSpaceBaseUrl(i[0].envId)};v.augDroppedObject(c,u,(function(i){let s="",l=void 0!==t.idDataList.items[0].filterData&&null!==t.idDataList.items[0].filterData;l&&(s=t.idDataList.items[0].filterData.filterTitle);let d=void 0!==c.filter&&null!==c.filter,h=null;d&&(h=c.filter.rootObj,s=c.filter.filterTitle);let f=void 0!==t.idDataList.items[0].filterSpec&&null!==t.idDataList.items[0].filterSpec,m=void 0!==t.idDataList.items[0].queryDef&&null!==t.idDataList.items[0].queryDef;t.createOrigTile(r,d&&null!==h?h:c,u,n,a,{applyBadgeToImage:l||d||f||m?{type:"filter",title:s}:null}),t.updateUIforIdList(!0),o.unmask(p),null!=e&&"function"==typeof e&&e("left"),widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_leftSideDone","CompareInput left side done")}),(function(e){console.log("augDroppedObject error: "+e)}))}else s.show(),r.hide();var p=t.inputRoot.getElement("#"+me),h=t.inputRoot.getElement("#"+H),f=l;if(null!=(l=t.idDataList.getRightID())){var m=t.validateObj_stateData[l];let i=t.idDataList.get_objServices("right");null!=i&&i.length>0&&void 0!==i[0]&&null!==i[0]&&(void 0!==i[0].preview_url&&null!==i[0].preview_url&&""!==i[0].preview_url&&(m.preview_url=i[0].preview_url),void 0!==i[0].type_icon_url&&null!==i[0].type_icon_url&&""!==i[0].type_icon_url&&(m.type_icon_url=i[0].type_icon_url),void 0!==i[0].displayName&&null!==i[0].displayName&&""!==i[0].displayName&&(m.displayName=i[0].displayName),void 0!==i[0].displayType&&null!==i[0].displayType&&""!==i[0].displayType&&(m.displayType=i[0].displayType)),h.hide(),p.show();let r=t.inputRoot.getElement("#"+p.parentElement.id);o.mask(r);var g={tenant:i[0].envId,securityContext:i[0].contextId,url3DSpace:d.get3DSpaceBaseUrl(i[0].envId)};v.augDroppedObject(m,g,(function(i){let s="",l=void 0!==t.idDataList.items[1].filterData&&null!==t.idDataList.items[1].filterData;l&&(s=t.idDataList.items[1].filterData.filterTitle);let c=void 0!==m.filter&&null!==m.filter,u=null;c&&(u=m.filter.rootObj,s=m.filter.filterTitle);let d=void 0!==t.idDataList.items[1].filterSpec&&null!==t.idDataList.items[1].filterSpec,h=void 0!==t.idDataList.items[1].queryDef&&null!==t.idDataList.items[1].queryDef;t.createOrigTile(p,c&&null!==u?u:m,g,n,a,{applyBadgeToImage:l||c||d||h?{type:"filter",title:s}:null}),t.updateUIforIdList(!0),o.unmask(r),null!=e&&"function"==typeof e&&e("right"),widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_rightSideDone","CompareInput right side done")}),(function(e){console.log("augDroppedObject error: "+e)}))}else h.show(),p.hide(),""!==f&&!0===t.runOptions.ImmediateRevisionOf&&t.revisionsOfButtonPressed("right")}))}))}else console.error("CompareInput failed sanity check in processValidatedIDs")},Te.prototype.validateAndProcessRevisionOfDrop=function(e,t){var i=this;!function(e,t){var i=!1;return void 0!==e.filterProxy&&null!==e.filterProxy?i=!0:null!=e&&void 0!==e.objArray&&null!==e.objArray&&e.objArray.length>0&&"ENOStrRefinementSpecification"===e.objArray[0].objectType&&(i=!0),i}(e)?!function(e,t){var i=!0;return null!=e&&void 0!==e.objArray&&null!==e.objArray&&e.objArray.length>0&&!Ee(e.objArray[0])&&(i=!1,e.objArray[0].serviceId),i}(e)?v.confirmDialog(_.get("RevisionsNotSupported"),"fonticon-attention",{label:j.ok,callback:function(){i.validateAndProcessDrop(e,t)}},{label:j.ko,callback:function(){}}):this.validateAndProcessDrop(e,t,{forRevisionOf:!0}):v.confirmDialog(_.get("CantDropFilterOnRevisions"),"fonticon-attention",{label:j.ok,callback:function(){i.validateAndProcessDrop(e,t)}},{label:j.ko,callback:function(){}})},Te.prototype.processValidatedId_RevisionOf=function(e,t,i){console.log("CompareInput: Revisions of "+i+" dropped item handler");var n=this;if("left"===i||"right"===i){var r={objId:t[0].objectId,objType:t[0].objectType,tenant:this.tenant,securityContext:this.securityContext},s=null;n.runOptions.DisableRootInRevisionsDialog&&(s=r.objId);var a=Ne(i,n.runOptions);o.unmask(this.inputRoot.parentElement),I.displayHistoryGraph(r,s,{allowDuplicates:n.runOptions.AllowDuplicatesInRevisionsDialog,disableRoot:n.runOptions.DisableRootInRevisionsDialog,controlOKButton:n.runOptions.ControlOKButtonInRevisionsDialog,OKButtonLabel:n.runOptions.RevisionsDialogOKButtonLabel,dlgTitle:a},(function(e){var o=[],r=e.physicalid;o.push(r);var s=[],a={envId:t[0].envId,objectId:r,objectType:t[0].objectType,serviceId:t[0].serviceId,contextId:t[0].contextId,displayName:e.displayName};s.push(a),n.validateIdsThenCall(o,s,(function(){null==n.idDataList&&(n.idDataList=new y("modelIDList"));var e=new b(o[0],s[0]);"left"===i?n.idDataList.items[0]=e:n.idDataList.items.length>1?n.idDataList.items[1]=e:n.idDataList.items.push(e),D.clearFiltering(i,A),console.log("probs -- compare input open flavor changes from "+S.getTypeOfOpen()+" to revision"),S.setTypeOfOpen("revision"),n.processValidatedIDs()}))}))}else console.log("CompareInput: RevisionsOf Dropped Item failure")},Te.prototype.validateAndProcessFilterOfDrop=function(e,t){this.validateAndProcessDrop(e,t,{forFilterOf:!0})},Te.prototype.processValidatedId_FilterOf=function(e,t,i){console.log("CompareInput: Filters of "+i+" item handler");if("left"===i||"right"===i){var n=this.validateObj_stateData[t[0].objectId],o={objId:n.isFilter?n.filter.rootObj.physicalid:t[0].objectId,objType:n.isFilter?n.filter.rootObj.internalType:t[0].objectType,tenant:this.tenant,securityContext:this.securityContext,displayName:Le(n.isFilter?n.filter.rootObj:n,!0)};this.displayFilterPanel(i,o)}else console.log("CompareInput:FilterOf Dropped Item failure");widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_FilterDisplayDone","CompareInput filter display done")},Te.prototype.onSelectedFromSearch=function(e,t){var i=this;if(null!=t){if("left"===e&&t.length>5||"right"===e&&t.length>4)return void v.showAlertBox("selectFiveOrFewer",_,"error");var n=[],o=[];for(const e of t)if(null!=e){var r=e.id;n.push(r);var s=e.sourceid_value.split(":"),a={contextId:i.securityContext,displayName:e["ds6w:label_value"],displayType:e["ds6w:type"],envId:s.length>1?s[1]:i.tenant,objectId:e.id,objectType:e["ds6w:type_value"],serviceId:s[0],preview_url:e.preview_url_value,type_icon_url:e.type_icon_url_value};!v.objectTypeNotAllowedForCompare(a.objectType)&&o.push(a)}i.validateIdsThenCall(n,o,(function(){null==i.idDataList&&(i.idDataList=new y("modelIDList"));let t="left"===e?0:1;for(var r=0;r<n.length;++r,++t)i.idDataList.items[t]=new b(n[r],o[r]);"left"!==e&&"right"!==e||D.clearFiltering(e,A),console.log("probs -- compare input open flavor changes from "+S.getTypeOfOpen()+" to another"),S.setTypeOfOpen("another"),i.processValidatedIDs()}))}},Te.prototype.displayFilterPanel=function(e,t){D.setApplyCallback(this,[{whichOne:"left"},{whichOne:"right"}],this.onApplyNGFilter),D.activateProxy(e),D.executeFilterCmd(e,t)},Te.prototype.onFetchFilterBIFilteringEvent=function(e){},Te.prototype.onApplyNGFilter=function(t){var i=this,n=t||null,o=(n=e.is(n,"string")?JSON.parse(n):n).appId.startsWith("CompareWidget_right")?"right":"left",r=this.tile[o],s=n.filterRootIds[0],a=this.validateObj_stateData[s],l=this.inputRoot.getElement("#"+he+"-"+o);if(this.inputRoot.getElement("#"+G+"-"+o).hide(),l.show(),null==r){var c=d.get3DSpaceBaseUrl(this.tenant);this.createOrigTile(l,a,{},c,"passport",{applyBadgeToImage:{type:"filter",title:n.filterTitle},highlight:!0})}else n.empty?function(e){var t="wux-button-icon-fi wux-ui-genereatedicon-fi wux-ui-genereatedicon-badge-bottom-right wux-ui-3ds",i=e.elements.picture.getElementsByClassName(t);for(let t of i)e.elements.picture.removeChild(t)}(r):Ae(r,{type:"filter",title:n.filterTitle}),A[o]=a.physicalid;const u="left"===o?this.idDataList.getLeftID():this.idDataList.getRightID(),p="left"===o?0:1,h="left"===o?1:0;if(s!==u)for(var f in void 0!==this.idDataList.items[p]&&null!==this.idDataList.items[p]||(this.idDataList.items[p]={}),this.idDataList.items[h])this.idDataList.items[p][f]=this.idDataList.items[h][f];this.idDataList.items[p].filterData=n.empty?null:n,this.idDataList.items[p].requiresIndex=!n.empty,v.forceRequireIndex(!1),n.empty?(i.idDataList.items[p].filterSpec=null,v.persistIDs(i.idDataList)):D.getFilterSpecificationPromise(o,u).then((function(e){1===e.status&&(i.idDataList.items[p].filterSpec=e.publicSpec),v.persistIDs(i.idDataList)}),(function(){v.persistIDs(i.idDataList)})),console.log("probs -- compare input open flavor changes from "+S.getTypeOfOpen()+" to filter"),S.setTypeOfOpen("filter"),this.updateUIforIdList(!1)},Te.prototype.createOrigTile=function(e,i,n,o,r,s){var a=this,c="";if(e.id.endsWith("-left")?c="left":e.id.endsWith("-right")?c="right":console.log("CompareInput createOrigTile failure"),void 0!==e.children&&null!==e.children&&e.children.length>0)for(;e.children.length>0;){var u=e.children[e.children.length-1];e.removeChild(u)}var p=o+x,d=o+L,h=(e.id,Le(i,!1)),m=function(e){var t=e.displayType;return null!=t&&""!==t||(t=e.type),t}(i),g=i.revision;null!=s&&(void 0!==s.customTitle&&null!==s.customTitle&&""!==s.customTitle&&(h=s.customTitle),void 0!==s.customSubtitle&&null!==s.customSubtitle&&""!==s.customSubtitle&&(m=s.customSubtitle),void 0!==s.prependToSubtitle&&null!==s.prependToSubtitle&&""!==s.prependToSubtitle&&(m=s.prependToSubtitle+m),void 0!==s.customDescription&&null!==s.customDescription&&""!==s.customDescription&&(g=s.customDescription));var v=[],y=[];this._supportsRevisions(i.physicalid,c)&&(v.push(_.get("revisionCM")),y.push({contextId:"revision",menuIcon:"flow-branch-list",state:this._objSupportsEffectivityBasedRevisions(i.physicalid)?"disabled":"enabled",tooltip:_.get(this._objSupportsEffectivityBasedRevisions(i.physicalid)?"usesEffectivityBasedRevisionsTip":"revisionOfButtonTip")})),this._supportsFilters(i.physicalid,c)&&(v.push(_.get("filterCM")),y.push({contextId:"filter",menuIcon:"filter",state:"enabled",tooltip:_.get("filterOfButtonTip")})),this._supportsOpenContent(c)&&(v.push(_.get("openCM")),y.push({contextId:"open",menuIcon:"open",state:"enabled",tooltip:_.get("searchButtonTip")})),v.push(_.get("swapColumnsCM")),y.push({contextId:"swap",menuIcon:"exchange",state:"enabled",tooltip:_.get("swapColumnsTip")}),this._supportsRemoveItem(c)&&(v.push(_.get("removeCM")),y.push({contextId:"remove",menuIcon:"remove",state:"enabled",tooltip:_.get("removeCM")}));var b=new l({picture:p,icon:d,title:h,multipleTitleLineNumber:!1,subtitle:m,description:g,allowUnsafeHTMLContent:!1,statusbarIcons:[],contextualMenu:v,onContextMenuBuildCallback:function(e){var t=[];if(null!=e)for(var i=0;i<e.length;i++)("swap"!==y[i].contextId||a._supportsSwapping())&&t.push({type:"PushItem",title:e[i],icon:y[i].menuIcon,state:y[i].state,action:{context:y[i].contextId+"-"+c,callback:function(e){var t=e.context.indexOf("-"),i=e.context.substring(t+1);""!==i?e.context.startsWith("revision-")?a.replaceWithRevisionOf(i):e.context.startsWith("filter-")?a.replaceWithFilterOf(i):e.context.startsWith("open-")?a.replaceWithSearch(i):e.context.startsWith("swap-")?a.swapColumns():e.context.startsWith("remove-")?a.clearItem(i):console.log("CompareInput context menu callback UNKNOWN reached"):console.log("CompareInput context menu callback id failure")}},tooltip:{title:v[i],shortHelp:y[i].tooltip}});return t}}).inject(e);b.getContent().setStyle("width","100%"),null!=s&&(!0===s.highlight&&b.highlight(),void 0!==s.applyBadgeToImage&&null!==s.applyBadgeToImage&&Ae(b,s.applyBadgeToImage)),function(e,i,n,o,r,s,a){if(void 0===n.serviceId||null===n.serviceId||""===n.serviceId||"3dspace"===n.serviceId.toLowerCase())if(void 0!==n.preview_url&&null!==n.preview_url&&""!==n.preview_url)r.picture=n.preview_url;else if("Workspace"==a){var l=f.getObjTypeLargeIconPath(a);null!=l&&(r.picture=e+"/"+l)}else{var c=n.physicalid,u=o.tenant;null!=u&&""!=u||(u="undefined"!=typeof widget&&widget?widget.getValue("x3dPlatformId"):null),null!=u&&""!=u||(u="OnPremise");var p=o.url3DSpace;null==p&&(p=e);var d=p+T+c+"/?tenant="+u+"&root3DSpaceUrl="+p;t.authenticatedRequest(d,{ndx:0,proxy:i,onComplete:function(e){if(console.log("CompareInput getImage success"),e.endsWith("iconLargeDefault.png")){var t=f.getObjTypeLargeIconPath(a);null!=t&&(e=p+"/"+t)}r.picture=e},onFailure:function(){console.log("CompareInput getImage failed")}})}else r.picture=n.preview_url}(o,r,i,n,b,0,i.internalType),function(e,i,n,o,r,s,a){if(void 0===n.serviceId||null===n.serviceId||""===n.serviceId||"3dspace"===n.serviceId.toLowerCase())if(void 0!==n.type_icon_url&&null!==n.type_icon_url&&""!==n.type_icon_url)r.icon=n.type_icon_url;else if("Workspace"==a){var l=f.getObjTypeIconPath(a);null!=l&&(r.icon=e+"/"+l)}else{var c=n.physicalid,u=o.tenant;null!=u&&""!=u||(u="undefined"!=typeof widget&&widget?widget.getValue("x3dPlatformId"):null),null!=u&&""!=u||(u="OnPremise");var p=o.url3DSpace;null==p&&(p=e);var d=p+P+c+"/?tenant="+u+"&root3DSpaceUrl="+p;t.authenticatedRequest(d,{ndx:0,proxy:i,onComplete:function(t){if(console.log("CompareInput getIcon success"),t.endsWith("iconLargeDefault.png")){var i=f.getObjTypeIconPath(a);null!=i&&(t=e+"/"+i)}r.icon=t},onFailure:function(){console.log("CompareInput getIcon failed")}})}else r.icon=n.type_icon_url}(o,r,i,n,b,0,i.internalType);var C=null,I=null;if("left"===c?(C=jQuery("#"+Se),I=jQuery("#"+Ie)):"right"===c&&(C=jQuery("#"+Oe),I=jQuery("#"+Ce)),null!==C&&C.length>0){C[0].children[0].nextSibling.nodeValue=_.get("revisionOfButtonLabel").replace("{objname}",h)}if(null!==I&&I.length>0){I[0].children[0].nextSibling.nodeValue=_.get("filterOfButtonLabel").replace("{objname}",h)}A[c]=i.physicalid,this.tile[c]=b},Te.prototype.updateUIforIdList=function(e){var t=null!=this.idDataList?this.idDataList.get_nonNullCount():0;t<2?this.compareBtn.disable():(this.compareBtn.enable(),this.compareBtn.focus()),this.swapButton&&(this._supportsSwapping()?(this.swapButton.enable(),this.swapButton.getContent().getParent().tooltipInfos.shortHelp=_.get("swapColumnsTip")):(this.swapButton.disable(),this.swapButton.getContent().getParent().tooltipInfos.shortHelp=_.get("swapColumnsDisabledTip"))),this.inputFooter[0===t?"hide":"show"](),t>0?(jQuery("#"+k).show(),"side-by-side"===this.displayOrientation?jQuery("#"+X).show():jQuery("#"+X).hide()):(jQuery("#"+k).hide(),jQuery("#"+X).hide());let i=jQuery("."+J);(i.length>1&&(i[0].style.display=t>0?"":"none"),jQuery("#"+M).css("border",t>0?"":"none"),jQuery("#"+ve)[0].children[0].nextSibling.nodeValue=_.get(t>0?"searchButtonLabel":"addObjectsDZ"),this._tempBasicDropZone)&&(this._tempBasicDropZone=!1,jQuery("#"+z)[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].style.display="none",this._setSupportsDropZones("left",!1),this.shutdownDragAndDropHandling());if(null===this.idDataList||null===this.idDataList.getLeftID()){let n=t>0&&this._supportsRevisions(this.idDataList.getRightID(),"left"),o=t>0&&this._supportsFilters(this.idDataList.getRightID(),"left"),r=jQuery("#"+Oe);if(r[0].style.display=n?"":"none",r=jQuery("#"+Ce),r[0].style.display=o?"":"none",r=jQuery("#"+ve),r[0].style.display=this._supportsOpenContent("left")?"":"none","none"===r[0].style.display)if(!n&&!o&&!this._supportsDropZones("left"))this._tempBasicDropZone=!0,jQuery("#"+z)[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].style.display="",r[0].style.display="",this._setSupportsDropZones("left",!0),this.setupDragAndDropHandling()}if(null!==this.idDataList){function s(e,t,i){let n=jQuery("#"+("right"===e?Se:Oe));n[0].style.display=i._supportsRevisions(t,e)?"":"none",n[0].disabled=i._objSupportsEffectivityBasedRevisions(t),n[0].title=i._objSupportsEffectivityBasedRevisions(t)?_.get("usesEffectivityBasedRevisionsTip"):_.get("revisionOfButtonTip"),n=jQuery("#"+("right"===e?Ie:Ce)),n[0].style.display=i._supportsFilters(t,e)?"":"none",n=jQuery("#"+("right"===e?ye:ve)),n[0].style.display=i._supportsOpenContent(e)?"":"none"}null!==this.idDataList.getLeftID()&&null===this.idDataList.getRightID()?s("right",this.idDataList.getLeftID(),this):null===this.idDataList.getLeftID()&&null!==this.idDataList.getRightID()&&s("left",this.idDataList.getRightID(),this)}void 0!==this._CCM&&null!==this._CCM&&this.launchCompareCustomizationCB},Te.prototype.updateComparisonProfileDropdownUI=function(){require(["DS/CompareWidget2/framework/useCase","DS/CompareWidget2/support/objIDSpec"],((e,t)=>{}))},Te.prototype.computeOrientation=function(e){var t="";if(null!=e){var i=e.clientWidth,n=e.clientHeight;t=i<480&&n>i?"over-under":"side-by-side"}return t},Te.prototype.updateDisplayOrientation=function(){var e=jQuery("#"+R),t=this.computeOrientation(e[0]);if(t!==this.displayOrientation){this.displayOrientation=t;var i="side-by-side"===this.displayOrientation?"row":"column";jQuery("#"+B).css("flex-direction",i),"side-by-side"===this.displayOrientation?jQuery("#"+X).show():jQuery("#"+X).hide()}},Te.prototype.updateTenant=function(e,t){var i=this;!1!==this._allowCompareFromDifferentTenants?(this.tenant=e,v.showAlertBox("tenantChanged",_,"success"),t(!0)):null!=this.idDataList&&this.idDataList.get_nonNullCount()>0?v.confirmDialog(_.get("PlatformChange"),"fonticon-attention",{label:_.get("ChangeButton"),callback:function(){i.clearItem("all"),i.tenant=e,v.showAlertBox("tenantChanged",_,"success"),t(!0)}},{label:_.get("CancelButton"),callback:function(){t(!1)}}):(this.tenant=e,v.showAlertBox("tenantChanged",_,"success"),t(!0))},Te.prototype.clearItem=function(e){"left"==e?(this.idDataList.items.length>0&&(this.idDataList.items[0]=null),this.idDataList.get_nonNullCount()>0?(this.idDataList.areCompared=!1,v.persistIDs(this.idDataList)):(this.idDataList=null,v.clear_persistedIDs()),this.clearTileItem(e),D.clearFiltering(e,A),A[e]=""):"right"==e?(this.idDataList.items.length>1&&(this.idDataList.items[1]=null),this.idDataList.get_nonNullCount()>0?(this.idDataList.areCompared=!1,v.persistIDs(this.idDataList)):(this.idDataList=null,v.clear_persistedIDs()),this.clearTileItem(e),D.clearFiltering(e,A),A[e]=""):(this.idDataList=null,v.clear_persistedIDs(),this.clearTileItem("left"),this.clearTileItem("right"),D.clearFiltering("",A),A.left="",A.right="",this.inputRoot.show()),this.updateUIforIdList(!0)},Te.prototype.clearTileItem=function(e){var t=jQuery("#"+he+"-"+e);for(t.hide();t[0].children.length>0;){var i=t[0].children[t[0].children.length-1];t[0].removeChild(i)}jQuery("#"+G+"-"+e).show(),this.tile[e]=null},Te.prototype.doCompare=function(){var t=this;function i(){for(var e of(C.destroySearch(),t.clearTileItem("left"),t.clearTileItem("right"),t.idDataList.areCompared=!0,t.idDataList.items))e.supportsRevisions=t._objSupportsRevisions(e.objectId),e.supportsFilters=t._objSupportsFilters(e.objectId),e.supportsEffectivityBasedRevisions=t._objSupportsEffectivityBasedRevisions(e.objectId);if(v.persistIDs(t.idDataList),"function"==typeof t.doCompareCB){var i={idDataList:t.idDataList,validateObj_stateData:t.validateObj_stateData};let e=void 0!==widget?.data?.source?widget?.data?.source:widget?.data?.appId;console.log("probs -- compareLaunchBy changed from "+S.getCompareLaunchBy()+" to "+e),S.setCompareLaunchBy(e);let n=t.idDataList?.items.map((e=>({type:e?.objectServices?.objectType})));console.log("probs -- selectedObjects changed from "+JSON.stringify(S.getSelectedObjects())+" to "+JSON.stringify(n)),S.setSelectedObjects(n),t.doCompareCB(i)}}if(!0===this.idDataList.areCompared||"IDPlusCommandsList"===this.idDataList.listType||!0===this.runOptions.ImmediateCompare&&!1!==this.runOptions.AllowCompareOfIdentical||!this.idDataList.areItemsIdentical(0,1))i();else if(!1!==this.runOptions.AllowCompareOfIdentical){let t=e.String.escapeHTML(Le(this.validateObj_stateData[this.idDataList.items[0].objectId])),n=e.String.escapeHTML(Le(this.validateObj_stateData[this.idDataList.items[1].objectId]));v.confirmDialog(_.get("CompareWithItself").replace("{objname1}",t).replace("{objname2}",n),null,{label:_.get("CompareStructures"),callback:function(){i()}},{label:_.get("CancelButton"),callback:function(){}})}else v.showAlertBox("CompareWithItselfNotAllowed",_,"error"),this.clearItem("right")},Te}));