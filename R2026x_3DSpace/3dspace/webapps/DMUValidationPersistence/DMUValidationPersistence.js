define("DS/DMUValidationPersistence/DMUValidationPersistenceServices",["DS/DMUReadPersistence/DMUReviewPersistenceServicesSetting","UWA/Utils"],(function(e,t){"use strict";const i=e=>{try{JSON.parse(e)}catch(e){return!1}return!0};return{createReviewInDataBase:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/createValidation",config:{verb:"POST",data:JSON.stringify({sName:t.reviewName,sPLMexternalID:t.reviewPLMexternalID,sContextIds:t.contextIds,sListContextIds:t.listContextIds,sDescription:t.reviewDescription,sRestrictedEdition:t.restrictedEdition,sAddMarkup:t.createMarkup?"true":"false",sMarkupName:t.markupName,sPLMMarkupexternalID:t.markupPLMexternalID,sMarkupDescription:t.markupDescription,sContextAsValidated:t.contextAsValidated,sValidatedObjects:t.validatedObjects,sServiceID:t.serviceID,strURI:t.strURI?t.strURI:"",appData:t.appData?t.appData:"",sMultiReview:t.multiReview,listReq:t.checksList,oMembers:t.members,multiReviews:t.multiReviews})},platform:t.platform,onSuccess:function(e){t.onReviewCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){t.onReviewCreationFailed(e?i(e)?JSON.parse(e):e:{})}})},addChild:function(e){var t=JSON.parse(localStorage.getItem("currentValidation")?localStorage.getItem("currentValidation"):"{}");t.children.push({type:e.type,id:e.id,name:e.name,children:[]}),localStorage.setItem("currentValidation",JSON.stringify(t))},addMarkup:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/addMarkup",config:{verb:"POST",data:JSON.stringify({sName:t.mkpName,sValidationId:t.validationId,sPLMMarkupexternalID:t.markupPLMexternalID,sDescription:t.mkpDescription})},onSuccess:function(e){t.onMarkupCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){t.onMarkupCreationFailed(e?i(e)?JSON.parse(e):e:{})}})},saveReviewMarkup:function(i){var n=new Blob([i.jsonContent],{type:"application/json"}),a=t.getUUID().toString(),o="WebReviewContent",r="json",s=o+"."+r;(function(t){return new Promise((function(i){e.sendWebServiceCall({url:"resources/validationauthoring/service/getCheckinTicket",config:{verb:"POST",data:JSON.stringify({sObjectType:t.type,sObjectId:t.markupID,sValidationId:t.validationId})},platform:t.platform,onSuccess:function(e){i(e?JSON.parse(e):{})},onFailure:function(e){i(e)}})}))})({type:"VALReview",markupID:i.markupRepRefId,validationId:i.validationId,platform:i.platform}).then((function(t){var c,d=t.checkinTicket,l=t.actionURL;d&&l?(c={file:n,ticket:d,URL:l,correlationId:a,fileName:s},new Promise((function(e,t){var i=new FormData;i.append("__fcs__jobTicket",c.ticket),i.append("file_0",c.file,c.fileName);var n=new XMLHttpRequest;n.open("POST",c.URL,!0),n.onload=function(){200===n.status&&e(n.responseText)},n.onerror=function(){t(new Error("Error uploading file"))},n.send(i)}))).then((function(t){var n=t;n&&function(t){return new Promise((function(i,n){e.sendWebServiceCall({url:"resources/validationauthoring/service/checkinStreamInfo",config:{verb:"POST",data:JSON.stringify({sObjectId:t.ObjectId,sReceipt:t.receipt,sJsonStream:t.stream,sFileName:t.fileName,sPersistencyType:t.persistencyType,sPersistencyName:t.persistencyName})},platform:t.platform,onSuccess:function(e){i(e?JSON.parse(e):{})},onFailure:n})}))}({ObjectId:i.markupRepRefId,receipt:n,stream:i.jsonContent,fileName:s,persistencyName:o,persistencyType:r,platform:i.platform}).then((function(e){e&&i.onSaveReviewMarkupCompleted()})).catch(i.onSaveReviewMarkupFailed)})).catch(i.onSaveReviewMarkupFailed):i.onSaveReviewMarkupFailed()}))},saveValidatedObject:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/updateValidatedObjects",config:{verb:"POST",data:JSON.stringify({sValidatedId:t.validatedId,sValidatedObjectIds:t.validatedObjects,sServiceID:t.serviceId})},onSuccess:function(e){t.onSaveValidatedObjectsCompleted(e?JSON.parse(e):{}),t.validatedObjects.length?sessionStorage.setItem(t.validatedId,"true"):sessionStorage.setItem(t.validatedId,"false")},onFailure:function(e){t.onSaveValidatedObjectsFailed(e?i(e)?JSON.parse(e):e:{})}})},addChecks:function(t){let n=t.listObjects,a=t.validationId;e.sendWebServiceCall({url:"resources/validationauthoring/service/addValidationChecks",config:{verb:"POST",data:JSON.stringify({listObjects:n,sValidationId:a})},onSuccess:function(e){t.onCheckCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){t.onCheckCreationFailed(e?i(e)?JSON.parse(e):e:{})}})},addCheck:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/addValidationCheck",config:{verb:"POST",data:JSON.stringify({sValidationId:t.validationId,sRequirementDocId:t.requirementDocId,sName:t.checkName,sDescription:t.description,iCheckState:t.checkState})},onSuccess:function(e){t.onCheckCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){t.onCheckCreationFailed(e?i(e)?JSON.parse(e):e:{})}})},updateValidationMembers:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/updateValidationMembers",config:{verb:"POST",data:JSON.stringify({sValidationId:t.validationId,sMembers:t.membersUpdate})},platform:t.platform,onSuccess:function(e){t.onUpdateMembersSuccessful(e?JSON.parse(e):{})},onFailure:function(e){t.onUpdateMembersFailed(e?i(e)?JSON.parse(e):e:{})}})},setCheckRequirement:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/setCheckRequirement",config:{verb:"POST",data:JSON.stringify({sCheckId:t.checkId,sRequirementId:t.requirementId,sRemoveReq:t.removeReq})},onSuccess:function(e){t.onSetCheckRequirementComplete(e?JSON.parse(e):{})},onFailure:function(e){t.onSetCheckRequirementFailed(e?i(e)?JSON.parse(e):e:{})}})},setImpactedCheck:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/setImpactedCheckOnHighlight",config:{verb:"POST",data:JSON.stringify({sCheckIds:t.checksId,sHighlightId:t.highlightId})},onSuccess:function(e){t.onSetImpactedCheckComplete(e?JSON.parse(e):{})},onFailure:function(e){t.onSetImpactedCheckFailed(e?i(e)?JSON.parse(e):e:{})}})},removeImpactedCheck:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/removeImpactedCheckOnHighlight",config:{verb:"POST",data:JSON.stringify({sCheckId:t.checkId,sHighlightId:t.highlightId})},onSuccess:function(e){t.onRemoveImpactedCheckComplete(e?JSON.parse(e):{})},onFailure:function(e){t.onRemoveImpactedCheckFailed(e?i(e)?JSON.parse(e):e:{})}})},updateAttributes:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/modifyAttributes",config:{verb:"POST",data:JSON.stringify({sValidationId:t.validationId,listObjects:t.objectsToModify})},onSuccess:function(e){t.onAttributesSaveCompleted(e?JSON.parse(e):{})},onFailure:function(e){t.onAttributesSaveFailed(e?i(e)?JSON.parse(e):e:{})},platform:t.platform})},updateReviewContext:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/updateValidationContext",config:{verb:"POST",data:JSON.stringify({sValidationId:t.validationId,sProductId:t.contextId,sContextIds:t.contextIds,sServiceID:t.serviceID})},onSuccess:function(e){t.onUpdateReviewContextCompleted(e?JSON.parse(e):{})},onFailure:function(e){t.onUpdateReviewContextFailed(e?i(e)?JSON.parse(e):e:{})}})},deleteObject:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/deleteObject",config:{verb:"POST",data:JSON.stringify({sValidationId:t.validationId,sObjectIds:t.objectIds})},onSuccess:function(e){t.onObjectDeletionCompleted(e?JSON.parse(e):{})},onFailure:function(e){t.onObjectDeletionFailed(e?i(e)?JSON.parse(e):e:{})}})},addHighlight:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/addHighlight",config:{verb:"POST",data:JSON.stringify({sValidationId:t.validationId,sMarkupRepRefPathIds:t.markupRepRefPathIds,sName:t.highlightName,sDescription:t.description,sSlideId:t.slideId,iPresentationRating:t.rating})},onSuccess:function(e){t.onHighlightCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){t.onHighlightCreationFailed(e?i(e)?JSON.parse(e):e:{})}})},addReply:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/addValidationReply",config:{verb:"POST",data:JSON.stringify({sMarkupRefId:t.markupRefId,sName:t.name,sDescription:t.description,sValidationId:t.validationId})},onSuccess:function(e){t.onReplyCreationCompleted(e?JSON.parse(e):{})},onFailure:function(e){t.onReplyCreationFailed(e?i(e)?JSON.parse(e):e:{})}})},generateName:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/generateName",config:{verb:"POST",data:JSON.stringify({sListTypeName:t.sListTypeName})},platform:t.platform,onSuccess:function(e){t.onGenerateNameCompleted(e?JSON.parse(e):{})},onFailure:function(e){t.ononGenerateNameFailed(e?i(e)?JSON.parse(e):e:{})}})},notify:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/notify",config:{verb:"POST",data:JSON.stringify({sNotifId:t.notifId,sListUsers:t.listUsers,sValidationId:t.validationId,sContextId:t.contextId,sCommentId:t.commentId,sParentSlideID:t.parentSlideID,sRepliedSlideName:t.repliedSlideName,sCommentContent:t.commentContent,bAllMembers:t.allMembers})},onSuccess:function(){},onFailure:function(){}})},setCommentStatus:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/setCommentStatus",config:{verb:"POST",data:JSON.stringify({lCommentsID:t.commentsID,sCommentStatus:t.commentStatus,sValidationId:t.validationId})},onSuccess:function(e){t.onSetCommentStatusSuccess(e?JSON.parse(e):{})},onFailure:function(e){t.onSetCommentStatusFailed(e?i(e)?JSON.parse(e):e:{})}})},removeCommentStatus:function(t){e.sendWebServiceCall({url:"resources/validationauthoring/service/removeCommentStatus",config:{verb:"POST",data:JSON.stringify({lCommentsID:t.commentsID,sValidationId:t.validationId})},onSuccess:function(e){t.onRemoveCommentStatusSuccess(e?JSON.parse(e):{})},onFailure:function(e){t.onRemoveCommentStatusFailed(e?i(e)?JSON.parse(e):e:{})}})}}}));