define("DS/SpecGridView/SpecGridView",["UWA/Core","UWA/Class","DS/SpecGridView/model/GridTreeDocument","DS/SpecGridView/controller/TileViewManager","DS/SpecGridView/controller/GridViewManager","DS/XSRCommonComponents/utils/Constants","DS/SpecGridView/controller/GridCollectionToolBar","i18n!DS/SpecGridView/assets/nls/SpecGridView","css!DS/SpecGridView/SpecGridView.css"],(function(e,t,i,r,n,s,o,a){"use strict";return t.extend({init:function(t){this._parentView=t,this.itemId=t.itemId,this.container=t.container,this.enableCrossWidgetFeature=t.enableCrossWidgetFeature,this.appCore=t.appCore,this.modelEvents=t.appCore.specViewerModelEvents,this.basicModelEvents=t.appCore.basicModelEvents,this.currentTabKey=t.currentTabKey,this.dvgOpts=t.dvgOpts,this.parentModel=t.parentModel,this.enableInteractiveRightPanel=t.enableInteractiveRightPanel,this.preferredView=widget.getValue("grid-preferred-view-"+this.currentTabKey)||t.preferredView,this.toolbarContainer=e.createElement("div",{id:"multigrid-toolbar"}).inject(this.container),this.statusBarInfo=t.statusIconForTileView;var s=t.isColorized,a={appCore:this.appCore,preferredView:this.preferredView,currentTabKey:this.currentTabKey,container:this.container,parentModel:this.parentModel};this.toolbar=new o(a),this.multigrid=e.createElement("div",{id:"multigrid"}).inject(this.container),this.emptyMsg(),this.rowGroupingOptions=t.rowGroupingOptions,this.subscribeEvents();var d=this,l={modelEvents:d.modelEvents,enableCrossWidgetFeature:d.enableCrossWidgetFeature,currentTabKey:d.currentTabKey,isColorized:s,rowGroupingOptions:this.rowGroupingOptions,appCore:this.appCore,enableRightInteractivity:this.enableInteractiveRightPanel,parentModel:t.parentModel};this.gridTreeDocument=new i(l),this.model=this.gridTreeDocument.getTreeDocuments(),this.appCore.specRouteManager&&this.appCore.specRouteManager.setCurrentTreeDocument(this.model),this.tileManager=new r({container:d.multigrid,itemId:d.itemId,appCore:d.appCore,model:this.model,currentTabKey:d.currentTabKey}),this.tileManager.setStatusBarInfo(this.statusBarInfo),this.gridManager=new n({container:d.multigrid,itemId:d.itemId,appCore:d.appCore,model:this.model,currentTabKey:d.currentTabKey,dvgOpts:d.dvgOpts,parentModel:d.parentModel})},drawTileView:function(){var e=this;e.gridManager&&e.gridManager.hide(),e.tileManager?e.tileManager.show():(e.tileManager=new r({container:e.multigrid,itemId:e.itemId,appCore:e.appCore,model:e.model,columns:e.cols,currentTabKey:e.currentTabKey}),this.tileManager.setStatusBarInfo(this.statusBarInfo),e.tileManager.drawGrid())},drawGridView:function(){var e=this;e.tileManager&&e.tileManager.hide(),e.gridManager?e.gridManager.show():(e.gridManager=new n({container:e.multigrid,itemId:e.itemId,appCore:e.appCore,model:e.model,columns:e.cols,currentTabKey:e.currentTabKey,dvgOpts:e.dvgOpts}),e.gridManager.drawGrid())},unGroupRoots:function(){this.gridTreeDocument&&(this.gridTreeDocument.unGroupRoots(),this.removeGroupingTable(),this.getTreeDocument().acceptChanges())},subscribeEvents:function(){this.subs=[]},switchView:function(e){s.GRID_VIEW===e?(this.toolbar.enableCommands(["personalize","Wraptext","Unwraptext","ResetChanges"]),this.currentView=s.GRID_VIEW,this.drawGridView()):s.BIG_TILE===e&&(this.toolbar.disableCommands(["personalize","Wraptext","Unwraptext","ResetChanges"]),this.currentView=s.BIG_TILE,this.drawTileView(),this.currentTabKey===s.BOM_TAB&&this.model.collapseAll(),this.model&&this.model.getOriginalGridRoots().length<=0&&this._showEmptyView())},switchMadeFromItem:function(e){this.toolbar.disableCommands(["personalize","Wraptext","Unwraptext","ResetChanges"])},setToolBarActions:function(e,t){var i=e.actions;i=t?i:this.updateToolbarCmdsStatus(i),this.toolbar.setActions(i),this.toolbar.setCurrentModel(this.model),this.toolbar.draw(this.toolbarContainer),this.isTileViewRendered&&this.toolbar.disableCommands(["personalize","Wraptext","Unwraptext","ResetChanges"])},getGridNodes:function(){return this.model.getOriginalGridRoots()},getVisibleNodes:function(){let e=[];return this.model.processDescendants({onlyVisibleNodes:!0,processNode:function(t){e.push(t.nodeModel)}}),e},getGridNodeCount:function(){return this.model.getOriginalGridRoots().length},setColumns:function(e){return this.cols=e,this.gridManager?this.gridManager.setColumns(e):""},hideColumns:function(e,t){for(let i=0;i<e.length;i++)t.indexOf(e[i].dataIndex)>-1&&(e[i].visibleFlag=!1)},addColumn:function(e,t){var i=this;if(i.gridManager){var r=i.gridManager.columns.find((function(t){return t.dataIndex===e.dataIndex}));i.gridManager.addColumn(e,t,r)}},removeColumns:function(e){var t=this;t.gridManager&&e.forEach((function(e){var i=t.gridManager.columns.find((function(t){return t.dataIndex===e}));t.gridManager.removeColumn(e,i)}))},addChildColumns:function(e,t){this.gridManager&&this.gridManager.addChildColumns(e,t)},getGridViewInstance:function(){return this.gridView},render:function(e){var t=!this.preferredView||this.preferredView!==s.BIG_TILE;this.isTileViewRendered=!t,this.gridManager&&(this.gridManager.drawGrid(e,!t),this.gridManager.grid&&(this.gridView=this.gridManager.grid)),this.tileManager&&this.tileManager.drawGrid(e,t),this.currentView=t?s.GRID_VIEW:s.BIG_TILE},highlightCell:function(e,t){this.gridManager&&this.gridManager.highlightCell(e,t)},setColumnVisibilityFlag:function(e,t){var i=this;e.forEach((function(e){i.gridManager.setColumnVisibilityFlag(e,t)}))},addRootNodes:function(e,t,i){e&&(this.gridTreeDocument.addRoot(e,!1,i),this.model.getOriginalGridRoots().length>0&&this._hideEmptyView())},addTagger:function(){this.appCore.specTagsFilter&&(this.appCore.specTagsFilter.setWorkingContainer(this.container),this.appCore.specTagsFilter.addItemsToTagger(this.getTreeDocument().getOriginalGridRoots()))},updateItemsOnTagger:function(e){this.appCore.specTagsFilter&&this.appCore.specTagsFilter.addItemsToTagger(e)},removeItemsOnTagger:function(e){this.appCore.specTagsFilter&&this.appCore.specTagsFilter.removeItemsOnTagger(e)},checkAndUpdatePersistency:function(e){this.updateGroupByIfAny(e)},updateGroupByIfAny:function(e){if(e)this.groupRoots(e);else{var t=this.getGroupByColumns();t&&t.length>0&&this.groupRoots(t)}},getGroupByColumns:function(){let e=this.currentTabKey?"xsr-grid-propertiesToGroup-"+this.currentTabKey:"xsr-grid-propertiesToGroup";return widget.getValue(e)},setGroupByColumns:function(e){let t=this.currentTabKey?"xsr-grid-propertiesToGroup-"+this.currentTabKey:"xsr-grid-propertiesToGroup";widget.setValue(t,e)},removeRootNodes:function(e){e&&(this.gridTreeDocument.removeRoot(e),this.model.getOriginalGridRoots().length<=0&&this._showEmptyView())},removeGroupingTable:function(){this.model.removeFakeGridTable()},groupRoots:function(e){let t=this.getPreferredView();t?s.GRID_VIEW==t?this.gridManager.grid.getTreeDocument().getRoots().length>0&&this.gridManager.grid.groupRows({dataIndexesToGroup:Array.isArray(e)?e:[e]}):s.BIG_TILE==t&&this.gridTreeDocument.groupRoots(e):this.isTileViewRendered?this.gridTreeDocument.groupRoots(e):this.gridManager.grid.getTreeDocument().getRoots().length>0&&this.gridManager.grid.groupRows({dataIndexesToGroup:Array.isArray(e)?e:[e]})},getPreferredView:function(){var e="grid-preferred-view-"+this.currentTabKey;return null==widget.getValue(e)?s.GRID_VIEW:widget.getValue(e)},unselectAll:function(){this.model.unselectAll()},getTreeDocument:function(){return this.model},exportGrid:function(e){var t={fileName:e?e+"__"+(new Date).toString().split(" ").splice(1,4).join(" ")+".csv":this.currentTabKey+"_"+(new Date).toString().split(" ").splice(1,4).join(" ")+".csv",columnSeparator:widget.getValue("column-seperator")};this.gridManager.exportCSV(t)},personalize:function(){this.tileManager&&this.currentView===s.BIG_TILE||this.gridManager&&this.gridManager.personalizeColumns()},displayEmptyObjectView:function(){this.tileManager&&this.currentView===s.BIG_TILE&&this._showEmptyView()},_showEmptyView:function(){this.tileManager&&this.currentView===s.BIG_TILE&&(this._emptyContentMsg.setStyle("display","flex"),this.tileManager.hide())},_hideEmptyView:function(){this.tileManager&&this.currentView===s.BIG_TILE&&(this.tileManager.show(),this._emptyContentMsg.setStyle("display","none"))},emptyMsg:function(){this._emptyContentMsg=e.createElement("div",{class:"grid-empty-tile wux-datagridview-emptycontentmessage"});var t=e.createElement("div");t.innerHTML=a.NoObjectsFound,t.inject(this._emptyContentMsg),this._emptyContentMsg.setStyle("display","none"),this._emptyContentMsg.inject(this.multigrid)},destroy:function(){this.toolbar.destroy(),this.multigrid.destroy(),this.gridTreeDocument.destroy(),this.gridManager&&this.gridManager.destroy(),this.tileManager&&this.tileManager.destroy(),this.subs&&this.modelEvents&&this.modelEvents.unsubscribeList(this.subs),this.appCore.specTagsFilter&&this.appCore.specTagsFilter.resetFilterData()},updateToolbarCmdsStatus(e){if(!this.parentModel)return e;if(this.parentModel&&!this.parentModel.getMaturityBasedDisabledCommands)return e;const t=new Set(this.parentModel.getMaturityBasedDisabledCommands());for(let i of e)i.disabled=t.has(i.key);return e}})}));