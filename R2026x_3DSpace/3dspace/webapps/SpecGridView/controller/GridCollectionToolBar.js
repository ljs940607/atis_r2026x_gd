define("DS/SpecGridView/controller/GridCollectionToolBar",["UWA/Core","UWA/Class","DS/Menu/Menu","DS/XSRCommonComponents/utils/XSRMask","DS/XSRCommonComponents/utils/XspecEvents","DS/XSRCommonComponents/utils/TypeUtils","DS/XSRCommonComponents/utils/Constants","DS/ENOXCollectionToolBar/js/ENOXCollectionToolBar","DS/ENOXCollectionToolBar/js/ENOXCollectionToolBarV2","DS/Controls/TooltipModel","DS/XSRCommonComponents/utils/Notification","DS/XSRCommonComponents/utils/RequestUtil","i18n!DS/SpecGridView/assets/nls/SpecGridView"],(function(e,t,n,o,i,a,l,r,s,c,d,u,h){"use strict";return t.extend({init:function(e){this.indexSwitcherTimeout=null,this.appCore=e.appCore,this.modelEvents=e.appCore.specViewerModelEvents,this.currentTabKey=e.currentTabKey,this.target=e.target,this.preferredView=e.preferredView,this.container=e.container,this.toolBarEvents=new i,this.hiddenCmds=[],this.currentViewType,this._subscribeEvents(),this.parentModel=e.parentModel},draw:function(t){var n=this;t&&(this.target=t);var o={modelEvents:n.toolBarEvents,withmultisel:!0,showItemCount:!0,actions:n.actionCommands,multiselActions:null,multiselActionCallback:n.getMultipleActions.bind(this),filter:{multiselect:!1,enableCache:!1},sort:[],currentView:n.preferredView?n.preferredView:l.GRID_VIEW,views:n.currentTabKey===l.FACET_MBMF||l.MBMF_TAB||n.currentTabKey===l.FORMULABOM_TAB||"bom"===n.currentTabKey||"spec_mat"===n.currentTabKey||n.currentTabKey===l.COPY_CONTENT_TAB?[]:[{id:l.BIG_TILE,text:h.bigTile,fonticon:"view-big-tile"},{id:l.GRID_VIEW,text:h.DataGridView,fonticon:"tree-table"}],currentNbitems:0,currentNbSelections:0};this.collectionToolbar=new r(o);var i=require("DS/Windows/ImmersiveFrame"),a=require("DS/WebUAUtils/WebUAUtils"),s=new e.Element("div",{class:"wux-control-inline-container",style:{"vertical-align":"top"}});s.inject(widget.body);var d=new i;d.inject(s),a.setPanelHelpMode({immersiveFrame:d}),this.collectionToolbar.inject(t);let p=[],m=[],f=document.querySelectorAll("li#enox-collection-toolbar-search-id"),g=document.querySelectorAll("li#DefineFilter"),b=document.querySelectorAll("li#bomViews"),T=document.querySelectorAll("li#add"),w=document.querySelectorAll("li#removeitem"),M=document.querySelectorAll("li#deleteItem"),C=document.querySelectorAll("li#reorder"),y=document.querySelectorAll("li#Export"),v=document.querySelectorAll("li#removeMaterial"),I=document.querySelectorAll("li#addMBMFItem"),E=document.querySelectorAll("li#authormode"),S=document.querySelectorAll("li#indexmode"),L=document.querySelectorAll("li#personalize"),A=document.querySelectorAll("li#AuthPaste"),O=document.querySelectorAll("li#Wraptext"),R=document.querySelectorAll("li#Unwraptext"),x=document.querySelectorAll("li#recipeView"),_=document.querySelectorAll("li#bomView"),F=document.querySelectorAll("li#addMaterial");p.push(f),p.push(g),p.push(w),p.push(M),p.push(C),p.push(y),p.push(E),p.push(S),p.push(L),p.push(A),p.push(O),p.push(R),p.push(v),m.push("help-rc-searchtab"),m.push("help-rc-advancedfiltertab"),m.push("help-rc-detachcmdtab"),m.push("help-rc-deletehdr"),m.push("help-rc-reordercmdtab"),m.push("help-rc-exportcmdtab"),m.push("help-rc-authoringmodemdtab"),m.push("help-rc-indexmodemdtab"),m.push("help-rc-customviewcmdtab"),m.push("help-rc-pastecmdtab"),m.push("help-rc-wrapmdtab"),m.push("help-rc-unwrapmdtab"),m.push("help-rc-detachcmdtab");for(let e=0;e<p.length;e++){let t=p[e][0]?.querySelector("span")??void 0;t&&(t.tooltipInfos=new c({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0,mouseRelativePosition:!1}),t.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help",m[e]))}let B=widget.getValue("bomQuantityMode");if(0!=b.length){let e=b[0].querySelector("span");e.tooltipInfos=new c({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0,mouseRelativePosition:!1}),B?e.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help","help-rc-collapsedviewtab"):e.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help","help-rc-instancesviewtab")}if("bom"==this.currentTabKey&&0!=T.length){let e=T[0].querySelector("span");e.tooltipInfos=new c({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0,mouseRelativePosition:!1}),e.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help","help-rc-addcmdtab")}if("docs"==this.currentTabKey&&0!=T.length){let e=T[0].querySelector("span");e.tooltipInfos=new c({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0,mouseRelativePosition:!1}),e.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help","help-rc-adddoc")}if("spec_mei"==this.currentTabKey&&0!=T.length){let e=T[0].querySelector("span");e.tooltipInfos=new c({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0,mouseRelativePosition:!1}),e.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help","help-rc-addMEI")}if("spec_mat"==this.currentTabKey&&0!=T.length){let e=T[0].querySelector("span");e.tooltipInfos=new c({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0,mouseRelativePosition:!1}),e.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help","help-rc-addmaterial")}if("formulatedbom"==this.currentTabKey&&0!=T.length){let e=T[0].querySelector("span");e.tooltipInfos=new c({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0,mouseRelativePosition:!1}),e.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help","help-rc-addfrmtab")}if(0!=T.length&&"copy_content_tab"==this.currentTabKey&&u.isCloud()){let e=T[0].querySelector("span");e.tooltipInfos=new c({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0,mouseRelativePosition:!1}),e.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help","help-rc-newmastercopycmdtab")}if(0!=F.length){let e=F[0].querySelector("span");e.tooltipInfos=new c({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0,mouseRelativePosition:!1}),e.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help","help-rc-addcmdtab")}if(0!=I.length){let e=I[0].querySelector("span");e.tooltipInfos=new c({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0,mouseRelativePosition:!1}),e.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help","help-rc-MAKFROMcmdtab")}if(0!=x.length){let e=x[0].querySelector("span");e.tooltipInfos=new c({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0,mouseRelativePosition:!1}),e.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help","help-rc-viewrecipecmdtab")}if(0!=_.length){let e=_[0].querySelector("span");e.tooltipInfos=new c({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0,mouseRelativePosition:!1}),e.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help","help-rc-BOMviewmdtab")}if(this.hideCommand("ResetChanges"),this.hideCommand("Unwraptext"),"bom"===this.currentTabKey||this.currentTabKey===l.FORMULABOM_TAB)if(this.currentTabKey===l.FORMULABOM_TAB&&(this.hideCommand("resolveFormula"),u.isCloud()||this.hideCommand("linkRecipe")),"index"===widget.getValue("fetchmode"))parseInt(widget.getValue("intervalswitchpreference"))>0?this.hideCommand("authormode"):this.hideCommand("indexmode");else if(parseInt(widget.getValue("intervalswitchpreference"))>0){parseInt(widget.getValue("previousindexed"))+parseInt(widget.getValue("intervalswitchpreference"))<Math.floor(Date.now()/1e3)?(this.hideCommand("authormode"),widget.setValue("fetchmode","index")):(this.hideCommand("indexmode"),this.initiateTimer())}else this.hideCommand("indexmode")},initiateTimer(){let e=this;e.indexSwitcherTimeout&&clearTimeout(e.indexSwitcherTimeout);var t=parseInt(widget.getValue("intervalswitchpreference"))||.02;e.indexSwitcherTimeout=setTimeout((function(){e.indexSwitcherTimeout=null,e.hideCommand("authormode"),e.showCommand("indexmode"),parseInt(widget.getValue("intervalswitchpreference"))>0&&d.displayNotification({eventID:"info",msg:h.INDEX_MODE_ACTIVE}),widget.setValue("fetchmode","index"),e.launchCommand("authormode")}),1e3*t)},_subscribeEvents:function(e){var t=this;this.subscriptionList=[],this.modelEvents&&(this.subscriptionList.push(this.modelEvents.subscribe({event:l.UPDATE_ITEMVIEW_TOOLBOOR_COUNT},(function(e){var n=t.currentModel?t.currentModel.getSelectedNodes().length:0;n>0?t.toolBarEvents.publish({event:l.COLLECTION_TOOLBAR_CHECKBOX_CHECK_FLAG,data:{}}):t.toolBarEvents.publish({event:l.COLLECTION_TOOLBAR_CHECKBOX_UNCHECK_FLAG,data:{}}),t.toolBarEvents.publish({event:l.COLLECTION_TOOLBAR_SELECTIONS_COUNT_UPDATE,data:n}),t.toolBarEvents.publish({event:l.COLLECTION_TOOLBAR_EVENT_UPDATE_COUNT,data:n})}))),this.subscriptionList.push(t.modelEvents.subscribe({event:"xsr-toolbar-switch-fetch-mode-to-author"},(function(){t.switchToAuthorMode()}))),this.subscriptionList.push(t.modelEvents.subscribe({event:t.currentTabKey?"xsr-show-toolbar-reset-command-"+t.currentTabKey:"xsr-show-toolbar-reset-command"},(function(){t.showCommand("ResetChanges")}))),this.subscriptionList.push(t.modelEvents.subscribe({event:t.currentTabKey?"xsr-hide-toolbar-reset-command-"+t.currentTabKey:"xsr-show-toolbar-reset-command"},(function(){t.hideCommand("ResetChanges")}))),this.subscriptionList.push(t.modelEvents.subscribe({event:t.currentTabKey?"xsr-hide-toolbar-makeFrom-command-"+t.currentTabKey:null},(function(e){e&&(t.hideMBMFCommand=e.disableMBMFCmd,t.hideMBMFFPCommand=e.disableMBMFCmd)})))),t.toolBarEvents.subscribe({event:l.COLLECTION_TOOLBAR_EVENT_ALL_SELECTED},(function(e){t.currentModel.gridLayout.collectionView.selectAll(!0)})),t.toolBarEvents.subscribe({event:l.COLLECTION_TOOLBAR_EVENT_ALL_UNSELECTED},(function(e){t.currentModel.unselectAll()})),t.toolBarEvents.subscribe({event:l.COLLECTION_TOOLBAR_EVENT_VIEW_ACTIVATED},(function(e){e!==t.currentViewType&&(t.currentViewType=e,t.launchResetModelChanges(),t.switchView(e))})),t.toolBarEvents.subscribe({event:l.COLLECTION_TOOLBAR_SEARCH},(function(e){var n=t.currentModel;n.prepareUpdate();var o=n.getChildren();if(t.showAllNodes(o),t.parentModel.getAllDescendants().forEach((e=>{e._isHidden=!1})),!e.searchValue[0]||0===e.searchValue.length)return t.baseModel?void t.baseModel.pushUpdate():void n.pushUpdate();var i=[],a=[],r=[];n.search({match:function(n){var o,s=n.nodeModel;if(!s._canBeGrouped())return!1;if(!s.getTitle)return!0;if(s.getFreeSearchText)o=s.getFreeSearchText();else if(s.currentTabKey===l.MEI_TAB||void 0!==s.getMEIInterface&&s.getMEIInterface()===l.MEI_INTERFACE)o=s.getTitle()+" "+s.getMaturity()+" "+s.getType()+" "+s.getName()+" "+s.getRevision()+" "+s.getOriginatedDate()+" "+s.getModifedDate()+" "+s.getDescription()+" "+s.getMftPartNo()+" "+s.getManufacturer()+" "+s.getPartSource()+" "+s.getPartSourceURL()+" "+s.getOwner()+" "+s.getEqQualIsPreferred();else{let e=widget.getValue(l.PERSISTENCY_BOM_VIEW);var c=s.getPartNumber?s.getPartNumber():"",d=s.getAsRequired?s.getAsRequired():"",u=s.getInstanceCount?s.getInstanceCount():"",h=s.getUnit?s.getUnit():"",p=s.getMBMFReferenceName?s.getMBMFReferenceName():"",m=s.getCoreMat?s.getCoreMat():"",f=s.getAllAttributeValue?s.getAllAttributeValue():"";o=c+" "+d+" "+u+" "+h+" "+(s.getTitle?s.getTitle():"")+" "+(s.getMaturity?s.getMaturity():"")+" "+(s.getType?s.getType():"")+" "+(s.getName?s.getName():"")+" "+(s.getRevision?s.getRevision():"")+" "+(s.getModifedDate?s.getModifedDate():"")+" "+(s.getOriginatedDate?s.getOriginatedDate():"")+" "+(s.getDescription?s.getDescription():"")+" "+(s.getOwner?s.getOwner():"")+" "+p+" "+m+" "+f,!e&&s.getInstanceTitle&&(o+=s.getInstanceTitle())}if(e.searchValue[0]&&-1!==o.toUpperCase().indexOf(e.searchValue[0].toUpperCase())){if(s.setSearchFilterState&&s.setSearchFilterState(!0),"bom"===t.currentTabKey||"formulatedbom"===t.currentTabKey){let e=s.getParent();for(i.push(s.getID()),a.push(s),s.getInstanceId&&s.getInstanceId()&&r.push(s.getInstanceId());null!=e&&(e.getID&&(i.push(e.getID()),e.getInstanceId&&e.getInstanceId()&&r.push(e.getInstanceId())),e=e.getParent(),null!==e););s.getRoot()&&s.getRoot().getID()&&(i.push(s.getRoot().getID()),s.getRoot().getInstanceId&&s.getRoot().getInstanceId()&&r.push(s.getRoot().getInstanceId()))}return!1}return s.setSearchFilterState&&s.setSearchFilterState(!1),!0}}).forEach((function(e,t){e._canBeGrouped()&&e.getTitle&&(e.getID&&i.includes(e.getID())&&(!e.getInstanceId||e.getInstanceId&&!e.getInstanceId()||e.getInstanceId&&r.includes(e.getInstanceId()))||(e.unmatchSearch(),e.setSearchFilterState&&e.setSearchFilterState(!1),e.applyFilters&&e.applyFilters()))})),n.pushUpdate();let s="post-filter-search";t.currentTabKey&&(s+="-"+t.currentTabKey),n.xsrModelEvents.publish({event:s,data:a})}))},showAllNodes:function(e){var t=this;e&&Array.isArray(e)&&e.forEach((function(e,n){if(e._canBeGrouped()){if(e.setSearchFilterState&&e.setSearchFilterState(!0),e._options.children&&e._options.children.length>0){e._options.children.forEach((e=>{e.setSearchFilterState&&e.setSearchFilterState(!0),e._isHidden=!1}))}e.applyFilters&&e.applyFilters()}else t.showAllNodes(e.getChildren())}))},switchView:function(e){var t=this.currentTabKey?"grid-toolbar-switch-view-"+this.currentTabKey:"grid-toolbar-switch-view";this.modelEvents&&this.modelEvents.publish({event:t,data:e})},getMultipleActions:function(e){var t=this,n=t.currentTabKey?l.UPDATE_MULTI_TOOLBAR_MENU+"-"+t.currentTabKey:l.UPDATE_MULTI_TOOLBAR_MENU;this.modelEvents&&t.modelEvents.publish({event:n,data:{target:e}})},setActions:function(e){this.actionCommands=this.drawMenus(e)},setCurrentModel:function(e){this.currentModel=e,this.baseModel=e},setTooltip:function(e,t,n,o){if("bomViews"===e.id&&n&&e.tooltip){let n=widget.getValue(t);var i;i=void 0!==n?n?h.label_QuantityMode:h.label_InstanceMode:o?h.label_QuantityMode:h.label_InstanceMode,e.tooltip.getBody().setText(i)}},setDefaultTooltip:function(e,t,n,o){if("bomViews"===e&&o){let e=widget.getValue(n);return void 0!==e?e?h.label_QuantityMode:h.label_InstanceMode:t}},setCommandFontIcon:function(e,t,n,o){if("bomViews"===e.id&&n&&e.fonticon){let n,i,a=widget.getValue(t),l="fonticon fonticon-";void 0!==a?(n=a?"object-reference":"object-instance",i=a?l+"object-reference":l+"object-instance"):(n=o?"object-reference":"object-instance",i=o?l+"object-reference":l+"object-instance");let r=document.querySelectorAll("li#bomViews");if(0!=r.length){let e=r[0].querySelector("span");e.tooltipInfos=new c({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0,mouseRelativePosition:!1}),a?e.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help","help-rc-collapsedviewtab"):e.tooltipInfos.loadFromHelpRscFile("ENOSpecManagementApp/help","help-rc-instancesviewtab")}e.fonticon=n,e.elements.icon.className=i}},getCommandIcon:function(e,t,n){if("bomViews"===e){let e=widget.getValue(t);return void 0!==e?e?"object-reference":"object-instance":n}},drawMenus:function(e){var t=[],n=this;if(e.forEach((function(e){var o={};o.id=e.key;var i=e.persistencyKey,a=e.isSelectable;if(o.text=e.text,o.title=e.text,o.fonticon=e.fonticon,o.disabled=e.disabled,i&&a){let t=n.setDefaultTooltip(e.key,e.text,i,a);o.title=o.text=t;let l=n.getCommandIcon(e.key,i,o.fonticon);o.fonticon=l}var l=e.subMenu;o.handler=l?function(e){var t=e.target.getBoundingClientRect();n.drawSubMenu(t,l,this,i,a)}:n.launchCommand.bind(n,e.key),t.push(o)})),this.currentTabKey!==l.FACET_MBMF&&this.currentTabKey!==l.MBMF_TAB&&"test-method-facet"!==this.currentTabKey&&"requirements-facet"!=this.currentTabKey){var o={id:"Export"};o.text=h.ExportCSV,o.title=h.ExportCSV,o.fonticon="export",o.handler=n.launchCommand.bind(n,"Export"),t.push(o)}if("bom"===this.currentTabKey||this.currentTabKey===l.FORMULABOM_TAB){var i={id:"authormode"};i.text=h.AuthorMode,i.title=h.AuthorMode,i.fonticon="database-hourglass infoIconActive",i.handler=function(){n.hideCommand("authormode"),n.showCommand("indexmode"),parseInt(widget.getValue("intervalswitchpreference"))>0&&d.displayNotification({eventID:"info",msg:h.INDEX_MODE_ACTIVE}),n.indexSwitcherTimeout&&clearTimeout(n.indexSwitcherTimeout),widget.setValue("fetchmode","index"),n.launchCommand(i.id)},t.push(i);var a={id:"indexmode"};a.text=h.IndexMode,a.title=h.IndexMode,a.fonticon="database-refresh",a.handler=function(){n.switchToAuthorMode()},t.push(a)}if("test-method-facet"!==this.currentTabKey&&"requirements-facet"!=this.currentTabKey&&this.currentTabKey!=l.COPY_CONTENT_TAB){var r={id:"personalize"};r.text=h.PersonalizeView,r.title=h.PersonalizeView,r.fonticon="cog",r.handler=n.launchCommand.bind(n,"personalize"),t.push(r)}var s={id:"Wraptext"};s.text=h.Wrap,s.title=h.Wrap,s.fonticon="text-wrapping-ok",s.handler=n.launchWrapText.bind(n),t.push(s);var c={id:"Unwraptext"};c.text=h.Unwrap,c.title=h.Unwrap,c.fonticon="text-wrapping-off",c.handler=n.launchUnWrapText.bind(n),t.push(c);var u={id:"ResetChanges"};return u.text=h.ResetChanges,u.title=h.ResetChanges,u.fonticon="reset",u.handler=n.launchResetModelChanges.bind(n),t.push(u),t},switchToAuthorMode:function(){var e=this;e.hideCommand("indexmode"),e.showCommand("authormode"),e.launchCommand("indexmode"),parseInt(widget.getValue("intervalswitchpreference"))>0>0?"index"===widget.getValue("fetchmode")&&(d.displayNotification({eventID:"info",msg:h.AUTHOR_MODE_ACTIVE}),widget.setValue("fetchmode","author"),widget.setValue("previousindexed",Math.floor(Date.now()/1e3)),e.initiateTimer()):(widget.setValue("fetchmode","author"),widget.setValue("previousindexed",Math.floor(Date.now()/1e3)))},launchResetModelChanges:function(){this.currentModel&&(this.currentModel.cancelChanges(),this.hideCommand("ResetChanges"))},launchWrapText:function(){o.maskLoader(this.container,h.WrapLoader);try{this.currentModel.gridLayout.collectionView.prepareUpdateView();for(var e=this.currentModel.gridLayout.columns,t=0;t<e.length;t++){var n=e[t];if(n.children)for(let e=0;e<n.children.length;e++)this.coreWrapOperation(n.children[e]);else this.coreWrapOperation(n)}this.currentModel.gridLayout.collectionView.pushUpdateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0},!0),this.hideCommand("Wraptext"),this.showCommand("Unwraptext"),o.unmaskLoader(this.container)}catch(e){console.error("Wraping failed!! "+e),o.unmaskLoader(this.container)}},coreWrapOperation:function(e){var t=e.dataIndex;"tree"!==e.typeRepresentation&&"string"!==e.typeRepresentation||(e._defaulttypeRepresentation=e.typeRepresentation,this.currentModel.gridLayout.setColumnTypeRepresentation(t,"textBlock")),"url"===e.typeRepresentation&&this.currentModel.gridLayout.setColumnTypeRepresentation(t,"urlBlock"),this.currentModel.gridLayout.setColumnAutoRowHeightFlag(t,!0)},launchUnWrapText:function(){o.maskLoader(this.container,h.UnwrapLoader);try{this.currentModel.gridLayout.collectionView.prepareUpdateView();for(var e=this.currentModel.gridLayout.columns,t=0;t<e.length;t++){var n=e[t];if(n.children)for(let e=0;e<n.children.length;e++)this.coreUnwrapOperation(n.children[e]);else this.coreUnwrapOperation(n)}this.currentModel.gridLayout.collectionView.pushUpdateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0},!0),this.hideCommand("Unwraptext"),this.showCommand("Wraptext"),o.unmaskLoader(this.container)}catch(e){console.error("Unwraping failed!! "+e),o.unmaskLoader(this.container)}},coreUnwrapOperation:function(e){var t=e.dataIndex;"textBlock"===e.typeRepresentation&&(e.typeRepresentation=e._defaulttypeRepresentation),"urlBlock"===e.typeRepresentation&&this.currentModel.gridLayout.setColumnTypeRepresentation(t,"url"),this.currentModel.gridLayout.setColumnAutoRowHeightFlag(t,!1)},hideCommand:function(e){var t=this.target?this.target.getElementsByTagName("li")[e]:void 0;t&&(t.setStyle("display","none"),-1===this.hiddenCmds.indexOf(e)&&this.hiddenCmds.push(e))},showCommand:function(e){var t=this.target?this.target.getElementsByTagName("li")[e]:void 0;t&&(t.setStyle("display","inline-block"),this.hiddenCmds.splice(this.hiddenCmds.indexOf(e),1))},drawSubMenu:function(e,t,o,i,r){var s=this;if(s.currentTabKey===l.BOM_TAB&&s.currentModel&&1===s.currentModel.getSelectedNodes().length){let e=s.currentModel.getSelectedNodes()[0].getTypeActualName();e&&a.isRawMaterial(e)&&(s.hideMBMFCommand=!0,s.hideMBMFFPCommand=!0),e&&a.isFormulatedProduct(e)&&(s.hideMBMFFPCommand=!0)}if(t){var c=function(e){var t=[];return e.forEach((function(e){var n={};if(n.title=e.text,"CheckItem"==e.type?n.type=e.type:n.type=e.type&&"separator"===e.type?"TitleItem":"PushItem",!s.hideMBMFCommand||"addMBMFItem"!==e.key&&"addMBMFRawMat"!==e.key||(n.state="disabled"),s.hideMBMFFPCommand&&"addMBMFFP"===e.key&&(n.state="disabled"),"resolveFormula"===e.key&&(n.state=widget.getValue("isRecipeAssociated")?"enabled":"disabled"),i){let t=widget.getValue(i);null!=t?e.isDefault?n.state=t?"selected":"unselected":n.state=t?"unselected":"selected":(e.isDefault,n.state=e.isDefault?"selected":"unselected")}if(e.subMenu){e.fonticon&&(n.fonticon={family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-"+e.fonticon}),n.action={this:this,callback:function(t){s.launchCommand(e.key)}};var a=c(e.subMenu);n.submenu=a}else"PushItem"!==n.type&&"CheckItem"!==n.type||(e.fonticon&&(n.fonticon={family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-"+e.fonticon}),n.action={this:this,callback:function(t){!e.isDefault&&r?widget.setValue(i,!1):e.isDefault&&r&&widget.setValue(i,!0),s.setTooltip(o,i,r,e.isDefault),s.setCommandFontIcon(o,i,r,e.isDefault),s.launchCommand(e.key),["expandall","expandNLevel","collapseall"].includes(e.key)&&s.changeTooltipFontIcon(o,e)}});t.push(n)})),t};s.subMenus=c(t),n.show(s.subMenus,{position:{x:e.left,y:e.bottom}})}},disableCommands:function(e){for(var t=0;t<e.length;t++){var n=e[t];this.toolBarEvents.publish({event:l.COLLECTION_TOOLBAR_COMMAND_DISABLE,data:n}),this.hiddenCmds.indexOf(n)>=0&&this.hideCommand(n)}},enableCommands:function(e){for(var t=0;t<e.length;t++){var n=e[t];this.toolBarEvents.publish({event:l.COLLECTION_TOOLBAR_COMMAND_ENABLE,data:n}),this.hiddenCmds.indexOf(n)>=0&&this.hideCommand(n)}},launchCommand:function(e){var t=this.currentTabKey?"grid-toolbar-action-click-"+this.currentTabKey:"grid-toolbar-action-click";this.modelEvents&&this.modelEvents.publish({event:t,data:e})},changeTooltipFontIcon:function(e,t){console.log(e,t),e.tooltip.getBody().setText(t.text),e.fonticon="fonticon fonticon-"+t.fonticon,e.elements.icon.className="fonticon fonticon-"+t.fonticon},destroy:function(){this.subscriptionList&&this.modelEvents&&this.modelEvents.unsubscribeList(this.subscriptionList),this.indexSwitcherTimeout&&clearTimeout(this.indexSwitcherTimeout),this.toolBarEvents.unsubscribeAll()},hideMultiSelector:function(){this.toolBarEvents.publish({event:l.COLLECTION_TOOLBAR_SELECTIONS_COUNT_UPDATE,data:0})}})}));