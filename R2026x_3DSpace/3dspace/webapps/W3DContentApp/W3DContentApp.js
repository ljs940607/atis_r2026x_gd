define("DS/W3DContentApp/Views/InodeDetailView/inodeDetailViewFunc",["UWA/Class/View","UWA/Core","UWA/String","UWA/Array","DS/UIKIT/Tooltip","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o,r){"use strict";function s(e,t){return!e.action||t.isActionIdoK(e.action)}function a(e){const i=t.createElement("li",{class:"navigation__header",html:[{tag:"span",class:"navigation__icon fonticon "+n.format("fonticon-{0}",e.icon||"")},{tag:"span","data-key":e.key||"",class:"navigation__data"}]});return new o({target:i,body:e.nls}),e.selected&&i.classList.add("navigation__header--selected"),i}return{createHeader:function(e,n){let i;const s=t.createElement("div",{class:"inode-detail__header",html:[t.createElement("span",{class:"inode-detail__header-title",text:e.get("alias")?e.get("alias"):e.get("title")}),i]});return n&&"function"==typeof n.onClickCloseIcon&&(i=t.createElement("span",{class:"fonticon fonticon-close inode-detail__header-icon"}),new o({target:i,body:r.close}),i.addEventListener("click",n.onClickCloseIcon),s.insertBefore(i,s.firstChild)),s.destroy=function(){n&&"function"==typeof n.onClickCloseIcon&&i.removeEventListener("click",n.onClickCloseIcon)},s},refreshHeader:function(e,t){return e.classList.contains("inode-detail__header-title")||(e=e.querySelector(".inode-detail__header-title")),e?(e.innerText=t,e):e},createCloseIcon:function(e,n){let i;return n&&"function"==typeof n.onClickCloseIcon&&(i=t.createElement("span",{class:"fonticon fonticon-close inode-detail__header-closeIcon"}),new o({target:i,body:r.close}),i.addEventListener("click",n.onClickCloseIcon)),i.destroy=function(){n&&"function"==typeof n.onClickCloseIcon&&i.removeEventListener("click",n.onClickCloseIcon)},i},getNavigationHeaderKey:function(e){if(e&&e.nodeType===Node.ELEMENT_NODE&&(e.classList.contains("navigation__data")||(e=e.querySelector(".navigation__data"))))return e.getAttribute("data-key")},getViewKey:function(e,t,n){if(e){var o=i.detect(n.detailViewsList,(function(t){return e===t.key}));if(o&&s(o,t))return o.key}return n.defaultView},createNavigation:function(e,t,n){var i=n.filter((function(e){return s(e,t)})).map((function(t){return t.selected=e===t.key,t})).map(a);i.length>2&&(i[0].classList.add("navigation__header--left"),i[i.length-1].classList.add("navigation__header--right"));var o=function(e){var t=document.createElement("ul");return t.classList.add("navigation"),[].concat(e).map((function(e){t.appendChild(e)})),t}(i);return o.classList.add("inode-detail__navigation"),o},refreshNavigation:function(e,t){var n=function(e,t){var n=e.querySelector(".navigation__data[data-key="+t+"]");if(n)return n.parentNode}(e,t);if(n){var i=n.parentNode.parentNode.querySelector(".navigation__header--selected");i&&n!==i&&(i&&i.classList.remove("navigation__header--selected"),n.classList.add("navigation__header--selected"))}},getBodyElemKey:function(e){return e.getAttribute("data-key")},wrapBody:function(e){var t=document.createElement("div");return t.classList.add("inode-detail__body-wrapper"),t.appendChild(e),t},createBody:function(e,t){if(!e)throw new Error("Missing input");var n=e.view;if("function"==typeof n){var i=n(t);return i.container.classList.add("inode-detail__body"),i.container.setAttribute("data-key",e.key),i}},refreshBodyWithView:function(e,t){e.classList.contains("inode-detail__body")||(e=e.querySelector(".inode-detail__body"));var n=e.parentNode;return n.removeChild(e),n.appendChild(t.container),t.render(),t},getView:function(t){var n=new e(t);return n.container.classList.add("inode-detail"),n}}})),define("DS/W3DContentApp/Views/InodeDetailView/versionsView",["DS/WebAppsFoundations/Views/CollectionView","DS/W3DXComponents/Views/EmptyView","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n){"use strict";return function(i){if(!i||!i.collection||!i.itemView)throw new Error("Missing input");var o=new e({className:"w3ddrive versions w3dx tiles relaxed",collection:i.collection,emptyView:new t({icon:"navigation-history",title:n.noHistory})});return Object.assign(o,{_buildItemView:function(e){return i.itemView({model:e})}})}})),define("DS/W3DContentApp/Metas/permission",["DS/WebappsUtils/WebappsUtils"],(function(e){"use strict";return function(){return{actionPubIds:{removePermission:"removePermission",makeReader:"makeReader",makeWriter:"makeWriter",makeWriterShare:"makeWriterShare",makeReaderShare:"makeReaderShare",enableShare:"enableShare",disableShare:"disableShare",transferOwnership:"transferOwnership",makeContributor:"makeContributor",makeAuthor:"makeAuthor",makeLeader:"makeLeader",makeLeaderOwner:"makeLeaderOwner",makeOwner:"makeOwner",makeMainOwner:"makeMainOwner",makePublicReader:"makePublicReader"},thumbnails:{people:e.getWebappsAssetUrl("W3DContentApp","thumbnails/default-people.png")}}}})),define("DS/W3DContentApp/Metas/errors",[],(function(){"use strict";return function(){return{xmlhttprequestCodes:{BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,CONFLICT:409,PRECONDITION_FAILED:410,INTERNAL_SERVER_ERROR:500},w3ddrive:{ressourceAccess:"res_acc_err",noToken:"no_token_err",duplication:"duplication",inodeAccessError:"inodeAccessError"}}}})),define("DS/W3DContentApp/Utils/createTasksSession",["UWA/Class/Promise","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t){"use strict";function n(e){e.returnValue=t.get("onBeforeUnload")}return function(t){var i,o=t||7,r=(i=[],{push:function(e){return e=[].concat(e).filter((function(e){return"function"==typeof e})),i.push(e),i.length},shift:function(){var e=i[0];if(e){var t=e.shift();return e.length||i.splice(0,1),t}}});function s(){if(!(o<=0)){var e=r.shift();e&&(e().then(s),s())}}return function(t){var i=(t=[].concat(t).filter((function(e){return"function"==typeof e}))).map((function(){return e.deferred()})),a=t.map((function(e,t){return function(){var n=e();return--o,n.then((function(){++o,i[t].resolve(Array.prototype.slice.apply(arguments))}),(function(){++o,i[t].reject(Array.prototype.slice.apply(arguments))}))}}));r.push(a),s(),window.addEventListener("beforeunload",n);var l=[],c=[];return i.reduce((function(e,t){return e.then((function(){return t.promise.then((function(){l.push(arguments[0])}),(function(){c.push(arguments[0])}))}))}),e.resolve()).then(d,d);function d(){return window.removeEventListener("beforeunload",n),c.length?e.reject(c.reduce((function(e,t){return e.concat(t)}),[])):e.resolve(l.reduce((function(e,t){return e.concat(t)}),[]))}}}})),define("DS/W3DContentApp/Metas/inode",["DS/WebappsUtils/WebappsUtils"],(function(e){"use strict";const t=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/SWV1_Part.svg"),n=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/SWV1_Assembly.svg"),i=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/SWV1_Drawing.svg"),o=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/CATV5_Assembly.svg"),r=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/CATV5_Drawing.svg"),s=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/CATV5_Part.svg"),a=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/EASM.svg"),l=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/EDRW.svg"),c=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/EPRT.svg"),d=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/STL.svg"),u=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/3DXML.svg"),p=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/DWG.svg"),m=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/IGES.svg"),f=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/DXF.svg"),g=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/OBJ.svg"),h=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/STEP.svg"),v=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/VRML.svg"),D=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/3MF.svg"),w=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/3PDF.svg"),b=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/SLDX.svg"),C=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/ComposerSmg.svg"),S=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/AxF.png"),y=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpac2DGrid.svg"),A=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacBlockModel.svg"),W=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacBlockModelConstraint.svg"),I=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacDataRecorderConfiguration.svg"),E=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacDTM.svg"),x=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacExperimentalVariogram.svg"),V=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacGeologyDatabase.svg"),T=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacGraphicsStyles.svg"),_=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacScript.svg"),L=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacPlot.svg"),P=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacPluginBlockModel.svg"),U=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacRange.svg"),O=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacString.svg"),N=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacSurpacWorkArea.svg"),k=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacSurveyDatabase.svg"),M=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASurpacVariogram.svg"),F=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/GEOVIASDM.svg"),R=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/MineSched.svg"),B=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/MineSchedAnimation.svg"),j=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/SpreadsheetDocument.svg"),q=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/PresentationDocument.svg"),H=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/RichTextDocument.svg"),K=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/DIAG.svg"),z=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/PROJ.svg"),X=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/PDF.svg"),G=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/Image.svg"),$=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/Video.svg"),J=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/Audio.svg"),Q=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/Revit.png"),Y=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/TextDoc.svg"),Z=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/ZIP.svg"),ee=e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/Email.svg");return function(){return{mimeType:{folder:"text/directory",pdf:"application/pdf",collabSpace:"collaborative Space"},ids:{trueRoot:"trueRootId",sharedWithMe:"sharedwithme"},actionPubIds:{share:"share",shareWithUsers:"shareWithUsers",publishTo3DSwym:"publishTo3DSwym",shareContent:"shareContent",moveTo:"moveTo",copy:"copy",changeProperties:"changeProperties",editTitle:"editTitle",editDescription:"editDescription",editDocument:"editDocument",del:"delete",delFinal:"deletefinal",createFolder:"createFolder",uploadFolder:"uploadFolder",upload:"upload",download:"download",preview:"preview",openWith:"openWith",insert:"insert",comment:"comment",viewInformation:"viewInformation",viewAccesses:"viewAccesses",viewHistory:"viewHistory",createCollabSpace:"createCollabSpace",update:"update",editCS:"editCS",addMember:"addMember",addMemberRestricted:"addMemberRestricted",changeThumbnail:"changeThumbnail",addContent:"addContent",moveToCS:"moveToCS",editContent:"editContent",deleteContent:"deleteContent",viewAnalytics:"viewAnalytics",downloadVersion:"downloadVersion",restoreVersion:"restoreVersion",restore:"restore",addToMyDrive:"addToMyDrive",changeAlias:"changeAlias",removeFromMyDrive:"removeFromMyDrive",removeOwnAccess:"removeOwnAccess",addToFavorites:"addToFavorites",removeFromFavorites:"removeFromFavorites",openFileLocation:"openFileLocation",getLink:"getLink"},thumbnails:{content:e.getWebappsAssetUrl("W3DContentApp","thumbnails/media/UnknownFile.svg"),folder:e.getWebappsAssetUrl("W3DContentApp","thumbnails/folder.svg"),sharedFolder:e.getWebappsAssetUrl("W3DContentApp","thumbnails/folder-shared.svg"),sldprt:t,sldasm:n,slddrw:i,eprt:c,easm:a,edrw:l,catpart:s,catproduct:o,catdrawing:r,"3dxml":u,"3mf":D,dwg:p,dxf:f,sldxml:b,u3d:w,iges:m,igs:m,obj:g,stp:h,step:h,stpa:h,stpx:h,stpz:h,stpxz:h,stl:d,vrml:v,smg:C,smggeom:C,smgxml:C,smgview:C,smgsce:C,axf:S,bmf:P,bpr2:P,con:W,ddb:V,dm:P,dms:P,dtm:E,evg:x,grid:y,mdl:A,minesched:R,mineschedanimation:B,pf:L,rng:U,sdb:k,ssi:T,str:O,swa:N,sdm:F,sdf:I,tbc:_,tcl:_,vgm:M,xls:j,xlsb:j,xlsm:j,xlsx:j,xlt:j,xltm:j,xltx:j,numbers:j,csv:j,ods:j,pot:q,potm:q,potx:q,pps:q,ppsm:q,ppsx:q,ppt:q,pptm:q,pptx:q,keynote:q,odp:q,txt:Y,log:Y,doc:H,docm:H,docx:H,dot:H,dotm:H,dotx:H,rtf:H,odt:H,msg:ee,mpp:z,vsd:K,vsdx:K,pdf:X,svg:G,png:G,jpg:G,jpeg:G,gif:G,tiff:G,tif:G,bmp:G,psd:G,ai:G,wmv:$,mp4:$,mov:$,avi:$,webm:$,mkv:$,ogv:$,mpg:J,wma:J,mp3:J,wav:J,rvt:Q,zip:Z},icons:{folder:"folder",sharedFolder:"folderShare"},mediaType:{sldprt:"3dmodel",sldasm:"3dmodel",slddrw:"3dmodel",eprt:"3dmodel",easm:"3dmodel",edrw:"3dmodel",catpart:"3dmodel",catproduct:"3dmodel",catdrawing:"3dmodel","3dxml":"3dmodel","3mf":"3dmodel",dwg:"3dmodel",dxf:"3dmodel",sldxml:"3dmodel",u3d:"3dmodel",iges:"3dmodel",igs:"3dmodel",obj:"3dmodel",stp:"3dmodel",step:"3dmodel",stpa:"3dmodel",stpx:"3dmodel",stpz:"3dmodel",stpxz:"3dmodel",stl:"3dmodel",vrml:"3dmodel",smg:"3dmodel",smggeom:"3dmodel",smgxml:"3dmodel",smgview:"3dmodel",smgsce:"3dmodel",axf:"3dmodel",grid:"3dmodel",mdl:"3dmodel",con:"3dmodel",sdf:"3dmodel",dtm:"3dmodel",evg:"3dmodel",ddb:"3dmodel",ssi:"3dmodel",minesched:"3dmodel",mineschedanimation:"3dmodel",tcl:"3dmodel",tbc:"3dmodel",pf:"3dmodel",dm:"3dmodel",dms:"3dmodel",bmf:"3dmodel",bpr2:"3dmodel",rng:"3dmodel",str:"3dmodel",swa:"3dmodel",sdb:"3dmodel",vgm:"3dmodel",sdm:"3dmodel",rvt:"3dmodel",xls:"document",xlsx:"document",xlsm:"document",numbers:"document",csv:"document",ppt:"document",pptx:"document",keynote:"document",txt:"document",log:"document",doc:"document",docx:"document",msg:"document",mpp:"document",vsd:"document",vsdx:"document",pdf:"document",odt:"document",ods:"document",odp:"document",png:"picture",jpg:"picture",jpeg:"picture",gif:"picture",tiff:"picture",tif:"picture",bmp:"picture",psd:"picture",ai:"picture",wmv:"video",mp4:"video",mov:"video",avi:"video",mpg:"audio",wma:"audio",mp3:"audio",wav:"audio",zip:"document"}}}})),define("DS/W3DContentApp/Components/CopyLinkToClipboard",["DS/UIKIT/Input/Button","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t){"use strict";return e.extend({link:"",init:function(e,{footerMode:n=!1,disabled:i=!1}={}){const o=this;this.link=e,this._parent({className:n?"copy-link__footer-mode":"copy-link",value:t.get("copyLink"),disabled:i,events:{onClick:function(){navigator.clipboard.writeText(o.link).then((()=>{this.dispatchEvent("onLinkCopied")}))}}})},updateLink:function(e){this.link=e}})})),define("DS/W3DContentApp/Metas/drive",[],(function(){"use strict";return function(){return{ids:{dropbox:"dropbox",google2:"google2",google:"google",drivesHub:"drivesHub",onedrive:"onedrive",box:"box"},actionPubIds:{storage:"storage",disconnect:"disconnect"}}}})),define("DS/W3DContentApp/Views/Lightbox/lightboxPreviewVideo",["UWA/Class/Promise","css!DS/W3DContentApp/W3DContentApp.css"],(function(e){"use strict";var t;return{init:function(o){function r(i){return i?i.getFileUrl().then((function(e){return n(t,e)})).catch((function(){return n(t,i.getDefaultThumbnail())})):e.resolve()}if(o=o||{},t)return r(o.inode),t;return t=Object.assign(i(),{refresh:r}),r(o.inode),t},pauseVideo:function(){document.pictureInPictureElement&&document.exitPictureInPicture();if(t)return t.pause();return}};function n(t,n){var i=function(e,t){var n=e;return n.classList.contains(t)||(n=n.querySelector("."+t)),n}(t,"video-source");return new e((function(e){i.setAttribute("src",n.url||""),i.setAttribute("type","video/"+n.extension||""),t.load(),e(t)}))}function i(){var e=document.createElement("video");e.setAttribute("controls",""),e.setAttribute("autoplay",!0),e.setAttribute("muted",!1),e.setAttribute("preload","auto"),e.setAttribute("width","100%"),e.setAttribute("height","100%"),e.setAttribute("controlslist","nodownload");var t=document.createElement("source");return t.classList.add("video-source"),e.appendChild(t),e}})),define("DS/W3DContentApp/Views/SuperModal",["DS/UIKIT/SuperModal","css!DS/UIKIT/UIKIT.css"],(function(e){"use strict";var t=new e({className:"w3ddrive",closable:!0,renderTo:document.body}),n=t.modalFactory,i=function(e){e.stopPropagation()};return t.modalFactory=function(){var e=n.apply(this,arguments),o=e.elements.container;return e.onShowModal=function(){t.next(),o.addEventListener("click",i)},e.onHide=function(){setTimeout((function(){o.removeEventListener("click",i)}))},e},t})),define("DS/W3DContentApp/BusEvent",["UWA/Class/Events"],(function(e){"use strict";return new e})),define("DS/W3DContentApp/Utils/IntegrationHelper",["DS/W3DDrive/widget","DS/W3DDrive/Metas/DSDrive/inode"],(function(e,t){"use strict";var n=t(),i={};window.parent.swxDriveService&&(i.SWIntegration=window.parent.swxDriveService);var o=e.getValue("addinmode");return"catiav5"===o?i.CATIAV5=!0:"solidworks"===o&&(i.SW=!0),i.SWIntegration&&(i.SWCheckShared=function(e){for(var t=e;t&&t.collection;)if((t=t.collection.dot()).id===n.ids.sharedWithMe)return!0;return!1}),i})),define("DS/W3DContentApp/Views/UploadInodesView/taskViewSet",["DS/WebAppsFoundations/Views/Plugins/Set"],(function(e){"use strict";return new e})),define("DS/W3DContentApp/Utils/Store",[],(function(){"use strict";return{resetStore:function(){this.currentTenant=null,this.features={},this.servicesUrl={}},currentTenant:null,features:{},servicesUrl:{}}})),define("DS/W3DContentApp/Models/Stub",[],(function(){"use strict";function e(e,t){if(t){var n=t.onComplete,i="function"==typeof e.toJSON?e.toJSON():{};"function"==typeof n&&n(e,i,t),"function"==typeof e.dispatchEvent&&e.dispatchEvent("onSync",[e,i,t])}}return{fetch:function(t){e(this,t)},save:function(t,n,i){e(this,i)}}})),define("DS/W3DContentApp/Utils/getKeyboardeventKey",[],(function(){"use strict";var e,t={3:"Cancel",6:"Help",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",28:"Convert",29:"NonConvert",30:"Accept",31:"ModeChange",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",41:"Select",42:"Print",43:"Execute",44:"PrintScreen",45:"Insert",46:"Delete",48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],91:"OS",93:"ContextMenu",144:"NumLock",145:"ScrollLock",181:"VolumeMute",182:"VolumeDown",183:"VolumeUp",186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"'],224:"Meta",225:"AltGraph",246:"Attn",247:"CrSel",248:"ExSel",249:"EraseEof",250:"Play",251:"ZoomOut"};for(e=1;e<25;e++)t[111+e]="F"+e;var n="";for(e=65;e<91;e++)n=String.fromCharCode(e),t[e]=[n.toLowerCase(),n.toUpperCase()];return function(e){if(e.key)return e.key;var n=t[e.which||e.keyCode];return Array.isArray(n)&&(n=n[+e.shiftKey]),n}})),define("DS/W3DContentApp/Views/UploadInodesView/taskView",["UWA/Core","UWA/Class/View","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n){"use strict";function i(e,t,i){if(!(e instanceof window.HTMLElement&&t))return!1;var o,r,s=t.progress,a=t.isCancelled,l=t.isError,c=0===s,d=100===s,u=e.querySelector(".status");if(Array.isArray(u)||(u=u?[u]:[]),d){var p=!(o=i.get("createdDate"),r=i.get("modifiedDate"),Math.abs(o-r)<=5e3)||i.collection&&i.collection.get(i.id)?n.updated:n.completed;return u.forEach((function(e){e.setText(p)})),e.removeClassName("processing"),e.addClassName("completed"),!0}if(a){var m=e.querySelector(".cancel-btn");return u.forEach((function(e){e.setText(n.cancelled)})),e.removeClassName("processing"),e.addClassName("cancelled"),m.addClassName("hidden"),!0}return l?(u.forEach((function(e){e.setText(n.error)})),e.removeClassName("processing"),e.addClassName("error"),!0):c?(u.forEach((function(e){e.setText(n.pending)})),e.removeClassName("processing"),e.addClassName("pending"),!0):void 0}return function(n,o){var r=new t(Object.assign({className:"w3ddrive task-view"},n)),s={isCancelled:!1},a=r.destroy;function l(){var e=i(r.container,Object.assign({},s,n),o);return e&&r.dispatchEvent("onFinish",[r]),e}function c(){return function(e,t){if(!(e instanceof window.HTMLElement&&t))return!1;var n=t.progress,i=e.querySelector("progress"),o=i.parentElement,r=e.querySelector(".cancel-btn");return 0<n&&n<100&&o.classList.add("processing"),n>0&&n<.9&&r.classList.remove("hidden"),n>=.9&&r.classList.add("hidden"),!!(i?[i]:[]).map((function(e){e.value=n}))}(r.container,n)}function d(){return function(e,t){if(!(e instanceof window.HTMLElement&&t))return!1;var n=t.title,i=e.querySelector(".title");return Array.isArray(i)||(i=i?[i]:[]),!!i.map((function(e){e.textContent=n}))}(r.container,n)}function u(){s.isCancelled=!0,function(e){!e||!e.dispatchEvent||(e.inode&&e.inode._dispatchers&&e.inode._dispatchers.onCancel&&e.inode._dispatchers.onCancel.bindings&&e.inode._dispatchers.onCancel.bindings.length?e.inode.dispatchEvent("onCancel"):e.inode.uploadCancelled=!0)}(r)}return r.inode=o,r.delegateDOMEvents({"click .cancel-btn":function(){var e=n.progress;e>0&&e<.9&&u()}}),Object.assign(r,{render:function(){r.container.setContent([e.createElement("div",{class:"title"}),e.createElement("progress"),e.createElement("div",{class:"status"}),e.createElement("div",{class:"cancel-wrapper",html:e.createElement("i",{class:"fonticon fonticon-status-ko cancel-btn hidden"})})]),l(),d(),c()},refreshStatus:l,refreshProgress:c,refreshTitle:d,cancelUpload:u,refreshError:function(e){e&&(s.isError=Boolean(e),l())},destroy:function(){return r.stopListening(),r.container=null,r.model=null,r.undelegateDOMEvents(),a.apply(r,arguments)}})}})),define("DS/W3DContentApp/Collections/Stub",[],(function(){"use strict";return{comparator:null,fetch:function(e){!function(e,t){if(t){var n=t.onComplete,i="function"==typeof e.toJSON?e.toJSON():{};"function"==typeof n&&n(e,i,t),"function"==typeof e.dispatchEvent&&e.dispatchEvent("onSync",[e,i,t])}}(this,e)}}})),define("DS/W3DContentApp/Utils/drivesInputs",["i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e){"use strict";return function(t){if(!t)return{};var n={forbiddenChars:{},maxchars:{},maxcharsDesc:{}},i=n.maxchars,o=n.maxcharsDesc,r=n.forbiddenChars;switch(t.drive.id){case"box":case"dropbox":i.maxLength=255,i.maxLengthText=t.isFolder()?e.replace(e.get("folderMaxLength"),{length:"255"}):e.replace(e.get("fileMaxLength"),{length:"255"}),r.regex="^((?!/)(?!\\\\).)*$",r.text=e.replace(e.get("forbiddenChars"),{chars:"/ \\"});break;case"google":i.maxLength=255,i.maxLengthText=t.isFolder()?e.replace(e.get("folderMaxLength"),{length:"255"}):e.replace(e.get("fileMaxLength"),{length:"255"}),r.regex="(.)*",r.text=e.get("requiredField");break;case"onedrive":i.maxLength=255,i.maxLengthText=t.isFolder()?e.replace(e.get("folderMaxLength"),{length:"255"}):e.replace(e.get("fileMaxLength"),{length:"255"}),r.regex='^((?!<)(?!>)(?!/)(?!\\\\)(?!:)(?!\\?)(?!\\*)(?!")(?!\\|)(?!\\.$).)*$',r.text=e.replace(e.get("forbiddenChars"),{chars:'< > / \\ : ? * " |'});break;default:"myCollabSpaces"===t.id||"myCollabSpaces"===t.get("parentId")?(i.maxLength=32,i.maxLengthText=e.replace(e.get("csMaxLength"),{length:i.maxLength}),o.maxLength=255,r.regex="([!   & \\x28 \\x29 + 0-9 = A-Z ^-z \\x7B \\x7D ~  \\x2D])+",r.text=e.get("csForbiddenChars"),r.spaces=e.get("csDoubleSpaces")):t.isFolder()?(i.maxLength=255,i.maxLengthText=e.get("folderMaxLength",{length:i.maxLength}),r.regex='^((?!<)(?!>)(?!/)(?!\\\\)(?!:)(?!\\?)(?!\\*)(?!")(?!\\|)(?!\\.$).)*$',r.text=e.get("forbiddenChars",{chars:'< > / \\ : ? * " |'})):(i.maxLength=255,i.maxLengthText=e.replace(e.get("fileMaxLength"),{length:i.maxLength}),r.regex='^((?!<)(?!>)(?!/)(?!\\\\)(?!:)(?!\\?)(?!\\*)(?!")(?!\\|).)*$',r.text=e.replace(e.get("forbiddenChars"),{chars:'< > / \\ : ? * " |'}),r.notEmpty=e.get("notEmpty"))}return n}})),define("DS/W3DContentApp/Utils/stopPropagationDropdownMenu",["DS/UIKIT/DropdownMenu"],(function(e){"use strict";return e.extend({_handleItemClick:function(e,t){this._parent(e,t),e.stopPropagation()}})})),define("DS/W3DContentApp/Utils/Helpers",["UWA/Core","DS/W3DDrive/widget","DS/TransientWidget/TransientWidget","DS/PlatformAPI/PlatformAPI","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o){"use strict";var r={result:function(t,n){var i;return t&&(i=t[n],e.is(i,"function")&&(i=i.call(t))),i},replaceWith:function(e,t){if(e){var n=e.getParent();if(n)return t?n.replaceChild(t,e):e.destroy(),t}return!1},filterXSS:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},isTransientWidget:function(){return n.isWidgetOpen()},isExternalDrivesDisabled:function(){return"true"===i.getApplicationConfiguration("app.3ddrive.disableExternalDrives")},computeFileExtension:function(e){if(!("string"==typeof e||e instanceof String))return"";const t={catanalysis:"CATAnalysis",catdrawing:"CATDrawing",catmaterial:"CATMaterial",catpart:"CATPart",catprocess:"CATProcess",catproduct:"CATProduct",catshape:"CATShape",catsystem:"CATSystem"};return t.hasOwnProperty(e.toLowerCase())?t[e.toLowerCase()]:e.toUpperCase()},computeNLSSize:function(e){let t,n;e=Number(e);if(isNaN(e))throw new Error("Size input is not a number");if(e<0)throw new Error("Size input is negative");if(0===e)t=0,n=0;else{if(n=Math.floor(Math.log(e)/Math.log(1024)),n>5)throw new Error("Size input is too big");const i=e/Math.pow(2,10*n),o=Math.pow(10,n>0?2:0);t=Math.round(i*o)/o,1024===t&&n<8&&(t=1,n++)}return o.replace(o[["sizeB","sizeKB","sizeMB","sizeGB","sizeTB","sizePB"][n]],{size:t})},getActionIds:function(e){if(!e)return[];if(!(e=[].concat(e)).length)return[];var t=e.map((function(t){return t.getActionIds(e.length>1)}));return t.length?t.reduce((function(e,t){return e.filter((function(e){return-1!==t.indexOf(e)}))})):t},listenToHierarchy:function(e,t,n){t.collection&&t.collection._parentInode&&(e.listenTo(t.collection._parentInode,n),r.listenToHierarchy(e,t.collection._parentInode,n))},getDateStr:function(e,n){if(!e)throw new Error("Missing input");const i=new Date(e),o=i.toLocaleString(t.lang,{year:"numeric",month:"short",day:"2-digit"}),r=i.toLocaleString(t.lang,{hour:"2-digit",minute:"2-digit",second:"2-digit",hourCycle:"h23"});return n?o:o+" - "+r},getTimeStr:function(e){if(!e)return null;return new Date(e).toLocaleString(t.lang,{hour:"2-digit",minute:"2-digit",second:"2-digit",hourCycle:"h23"})},isToday:function(e){if(!e)return!1;const t=new Date;return(e=new Date(e)).getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()},getAppBehaviour:function(e){var t=window.parent.location.search.substring(1);if(t)for(var n=t.split("&"),i=0;i<n.length;i++){var o=n[i].split("=");if(2===o.length&&o[0]===e)return o[1]}},getQueryHashParameter:function(e,t){const n=window.parent.location.hash.substring(1);let i;if(n){n.split("/").forEach((n=>{if(2===(n=n.split(":")).length&&n[0]===e){n[1].split("&").forEach((e=>{2===(e=e.split("=")).length&&e[0]===t&&(i=e[1])}))}}))}return i},isOfficeDocumentSupported:function(e){return["doc","docx","rtf"].includes(e)||["xls","xlsx","csv"].includes(e)||["ppt","pptx"].includes(e)},isTouchDevice:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},isAndroidOrIphone:function(){return/(android|iPhone|iPod)/i.test(navigator.userAgent)},getSortConfiguration:function(){const e=[];return e["title-a"]={id:"title-a",attributeName:"title",fonticon:"alpha-sorting-a-z",asc:!0},e["title-d"]={id:"title-d",attributeName:"title",fonticon:"alpha-sorting-z-a",asc:!1},e["modifiedDate-a"]={id:"modifiedDate-a",attributeName:"modifiedDate",fonticon:"date-sorting-1-31",asc:!0},e["modifiedDate-d"]={id:"modifiedDate-d",attributeName:"modifiedDate",fonticon:"date-sorting-31-1",asc:!1},e["createdDate-a"]={id:"createdDate-a",attributeName:"createdDate",fonticon:"date-sorting-1-31",asc:!0},e["createdDate-d"]={id:"createdDate-d",attributeName:"createdDate",fonticon:"date-sorting-31-1",asc:!1},e["size-a"]={id:"size-a",attributeName:"size",fonticon:"num-sorting-1-2",asc:!0},e["size-d"]={id:"size-d",attributeName:"size",fonticon:"num-sorting-2-1",asc:!1},e["type-a"]={id:"type-a",attributeName:"type",fonticon:"alpha-sorting-a-z",asc:!0},e["type-d"]={id:"type-d",attributeName:"type",fonticon:"alpha-sorting-z-a",asc:!1},e["creator-a"]={id:"creator-a",attributeName:"creator",fonticon:"alpha-sorting-a-z",asc:!0},e["creator-d"]={id:"creator-d",attributeName:"creator",fonticon:"alpha-sorting-z-a",asc:!1},e}};return r})),define("DS/W3DContentApp/Utils/drawerOrchestrator",[],(function(){"use strict";return function(e){var t=0;function n(){t<=0?e.children[0].style.visibility="hidden":(e.children[0].style.width=t+"px",e.children[0].style["margin-right"]="auto",e.children[0].style["margin-left"]=0)}return e.parentNode.getBoundingClientRect().width,e.style.position="absolute",e.style.width="2000px",e.style.left="100%",e.style["will-change"]="transform",{refreshInnerDrawer:n,translateNoAnim:function(i){t!==i?(0!==i&&(e.children[0].style.visibility="visible"),e.classList.remove("animate-on-transforms"),e.style.transform="translateX(-"+i+"px)",t=i,requestAnimationFrame(n)):t<=0&&(e.children[0].style.visibility="hidden")},translateAnim:function(i){t!==i&&(0!==i&&(e.children[0].style.visibility="visible"),e.classList.add("animate-on-transforms"),e.style.transform="translateX(-"+i+"px)",t=i,e.addEventListener("transitionend",(function t(){e.removeEventListener("transitionend",t),e.classList.remove("animate-on-transforms"),requestAnimationFrame(n)})))},getOpenedWidth:function(){return t}}}})),define("DS/W3DContentApp/Utils/EventHelpers",[],(function(){"use strict";return{hasFilesType:function(e){return!!(e||e instanceof DataTransfer)&&e.types.some((e=>"Files"===e))},getFiles:function(e){if(!(e||e instanceof DataTransfer))return[];const t=[],n=[],i=e.files,o=e.items;if(i&&i.length>0){for(let e=0;e<i.length;e++)t.push(i.item(e));for(let e=0;e<o.length;e++)"file"===o[e].kind&&n.push(o[e]);return t.filter(((e,t)=>{const i=n[t];if(!e||!i)return!1;const o=i.webkitGetAsEntry();return!!o&&!o.isDirectory}))}return t}}})),define("DS/W3DContentApp/Utils/dropdownContextmenu",["DS/UIKIT/DropdownMenu"],(function(e){"use strict";return e.extend({_handleEvents:function(){var e,t,n,i=this.options;i.contextual&&(this.events.target={contextmenu:function(e){e.preventDefault(),this.updatePosition(e)}.bind(this)},e=this.events.target,t=i.target,n=!0,Object.keys(e).forEach((function(i){t.addEventListener(i,e[i],n)})))}})})),define("DS/W3DContentApp/Models/DriveTreeNodeModel",["UWA/Core","DS/TreeModel/TreeNodeModel"],(function(e,t){"use strict";let n;return n=function(i={}){var o,r;const s=i.inode,a=s&&s.inodeTable;if(!s&&!a)throw new Error("An input options is invalid");const l=["recents","favorites","TRASH"].some((e=>e===s.get("id"))),c={onRemove:function(){g(!0),o.remove()},"onChange:title":m("label"),"onChange:alias":m("label"),"onChange:iconLink":m("icons")},d={onAdd:f,onReset:function(){o.removeChildren(),a.toArray().map((function(e){f(e,a)}))},onSync:function(){o.preExpandDone(),(o.getChildren()&&0===o.getChildren().length||l)&&o.setState({state:"noChildren"});o.sortChildren({isRecursive:!1,sortFunction:function(e,t){return e.getNodeDepth()>1?e.options.label.localeCompare(t.options.label,void 0,{numeric:!1})>=1?1:-1:0}})}};function u(){return{label:s.get("alias")||s.get("title"),icons:(e=>[{iconName:e.get("iconLink")}])(s),children:l?[]:a.filterFiles().filter((e=>!(i.hiddenRootInodes||[]).includes(e.id))).map((e=>new n({inode:e,hiddenRootInodes:i.hiddenRootInodes}))),useAsyncPreExpand:!0}}function p(e){var t;t=u(),o.prepareUpdate(),o.options[e]=t[e],o.pushUpdate()}function m(e){return p.bind(this,e)}function f(e,t){var r;if(e.isContainer()){r=new n({inode:e,hiddenRootInodes:i.hiddenRootInodes});var s=t.filter((function(e){return e.isFolder()})).indexOf(e);o.addChild(r,s)}}function g(e){var t;s[(t=e?"remove":"add")+"Events"](c),a[t+"Events"](d)}return o=new t(e.merge(i,u())),s.isFolder()&&!l||o.setState({state:"noChildren"}),r={inode:s,getChildWithInode:function(e){var t,n;if(t=o.getChildren())return t.forEach((function(t){t.inode!==e||(n=t)})),n}},e.extend(o,r),g(),o},n})),define("DS/W3DContentApp/Utils/AdvancedHelpers",["DS/WAFData/WAFData","UWA/String"],(function(e,t){"use strict";return{isMemberOfUserGroups:function(n,i){const o=n.get("auth").platform;let r,s,a;return new Promise((function(l){if(o)if(r="3DDrive-"+o.id+"-groups",s=JSON.parse(window.localStorage.getItem(r))||[],a=s&&s.find((function(e){return e.name===i})),""===i)l(!0);else if(void 0===i)l(!1);else if(a){let e=new Date(a.cacheDate);Math.abs(Date.now()-e.getTime())/36e5>12?c():l(a.isMember)}else c();else l(!1);function c(){const c=t.format("{0}/search",o.urls3DSearch);e.authenticatedRequest(c,{method:"POST",type:"json",headers:{"Content-Type":"application/json"},data:JSON.stringify({with_synthesis_hierarchical:!1,with_synthesis:!1,with_synthesis_attribute:!1,source:["usersgroup"],query:'[ds6w:label]:"'+i+'"',select_predicate:["ds6w:hasMember","ds6w:responsible"],label:"bot",tenant:o.id}),onComplete:function(e){const t=n.get("user").displayName;let o=!1,c=[];if(e&&e.results){e.results.forEach((function(e){c=c.concat(e.attributes)}));o=c.filter((function(e){return"ds6w:hasMember"===e.name&&e.value===t||"ds6w:responsible"===e.name&&e.value===t})).length>0}else o=!1;a?(a.isMember=o,a.cacheDate=(new Date).toISOString()):s.push({name:i,isMember:o,cacheDate:(new Date).toISOString()}),window.localStorage.setItem(r,JSON.stringify(s)),l(o)},onFailure:function(){l(!1)}})}}))},isODEFeatureEnabled:function(e){if(!e)throw new Error("Input is missing");return new Promise((t=>{e.isDsDrive?require(["DS/OfficeDocumentEditorClient/Editor"],(n=>{n.isGranted?n.isGranted({platformId:e.id}).then((()=>{t(!0)}),(()=>{t(!1)})):t(!1)})):t(!1)}))}}})),define("DS/W3DContentApp/SearchProxy",["UWA/Core","UWA/Class/Events"],(function(e,t){"use strict";let n=new t;return n=e.extend(n,{getQuery:function(){return this._query},setQuery:function(e){this._query=e,this.dispatchEvent("onSetQuery",[e])},resetQuery:function(e){e=e||{},delete this._query,e.silent||this.dispatchEvent("onResetQuery")}}),n})),define("DS/W3DContentApp/Collections/Pagination",["UWA/Core"],(function(e){"use strict";return function(t){return t.extend({finiteInt:function(t,n){if("number"!==e.typeOf(t)||isNaN(t)||!isFinite(t)||~~t!==t)throw new TypeError("`"+n+"` must be a finite integer");return t},_computeTotalPages:function(e,t){return Math.ceil(e/t)},_checkState:function(e){if(e){var t=e.totalRecords,n=e.pageSize,i=e.currentPage,o=e.firstPage,r=e.totalPages;if(null!=t&&null!=n&&null!=i&&null!=o){if(t=this.finiteInt(t,"totalRecords"),n=this.finiteInt(n,"pageSize"),i=this.finiteInt(i,"currentPage"),o=this.finiteInt(o,"firstPage"),n<1)throw new RangeError("`pageSize` must be >= 1");if(r=e.totalPages=this._computeTotalPages(t,n),o<0||o>1)throw new RangeError("`firstPage must be 0 or 1`");if(e.lastPage=0===o?Math.max(0,r-1):r||o,i<o||r>0&&(o?i>r:i>=r))throw new RangeError("`currentPage` must be firstPage <= currentPage "+(o?"<=":"<")+" totalPages if "+o+"-based. Got "+i+".")}return e}},hasPreviousPage:function(){var e=this.state;return(e?e.currentPage:void 0)>e.firstPage},hasNextPage:function(){var e=this.state;return(e?e.currentPage:void 0)<(e?e.lastPage:void 0)},getFirstPage:function(e){return this.getPage("first",e)},getPreviousPage:function(e){return this.getPage("prev",e)},getNextPage:function(e){return this.getPage("next",e)},getLastPage:function(e){return this.getPage("last",e)},getPage:function(t,n){var i=this,o=i.state,r=o?o.currentPage:void 0,s=o?o.firstPage:void 0,a=o?o.lastPage:void 0,l=t;switch(n=n||{},t){case"first":l=s;break;case"prev":l=r-1;break;case"next":l=r+1;break;case"last":l=a;break;default:l=this.finiteInt(t,"index")}return i.state=i._checkState(e.extend(o,{currentPage:l})),n.from=r,n.to=l,n.permissions?(n.permissions.state=i.state,n.permissions.fetch(n)):i.fetch(n)}})}})),define("DS/W3DContentApp/Views/Lightbox/lightboxPreviewImg",["UWA/Core","UWA/Class/Promise","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n){"use strict";let i,o,r;const s=(e,n,i)=>new t((t=>{o.src=n;o.onload=n=>{(e=>!(!e||!e.src)&&Boolean(e.src.contains("/assets/thumbnails")))(n.target)?r.classList.remove("hidden"):r.classList.add("hidden"),t(e)},o.onerror=()=>{o.src=i,r.classList.add("hidden"),t(e)}}));return{init:a=>{const l=e=>{if(!e)return t.resolve();const n=e.getDefaultThumbnail();return e.getThumbnailLink().then((e=>s(i,e.medium,n)),(()=>s(i,n)))};return a=a||{},i?(l(a.inode),i):(i=Object.assign((o=e.createElement("img"),r=e.createElement("div",{class:"preview-img__description-container",html:[{tag:"p",class:"preview-img__title",text:n.get("previewNotAvailable")},{tag:"p",class:"preview-img__description",text:n.get("extensionNotSupported")}]}),e.createElement("div",{class:"preview-img",html:[o,r]})),{refresh:l}),l(a.inode),i)}}})),define("DS/W3DContentApp/Utils/SetOfSelectedView",["UWA/Core","DS/WebAppsFoundations/Views/Plugins/Set"],(function(e,t){"use strict";const n="oneToOne";return t.extend({mode:n,init:function(e,t={}){this.enable();const n=this._parent.apply(this,arguments);return t.disabled&&(this._enabled=!1),n},enable:function(){return this._enabled=!0,this},disable:function(){return this._enabled=!1,this},set:function(e,t={}){if(t.force||this._enabled)return this._parent.apply(this,arguments)},add:function(t,i={}){const o=this.mode;if(Array.isArray(t)||(t=t?[t]:[]),!i.force&&o===n){if(t.length&&t.length>1)throw new Error("Use the force option if you want an unexpected mode behaviour");return this.set(t,e.extend({merge:!1},i))}return this._parent.apply(this,arguments)}})})),define("DS/W3DContentApp/Views/DriveView/driveViewPattern",["UWA/Core","UWA/Class/View"],(function(e,t){"use strict";return function(e){var n=e.model,i=new t({model:n,className:"w3ddrive drive"}),o=e.header,r=e.authenticatedBody,s=i.render,a=i.destroy;return i.listenTo(n,{"onChange:authenticated":function(){i.render()}}),Object.assign(i,{render:function(){return i.container.setContent(o),n.get("authenticated")&&(i.container.addContent(r),r.render()),o.render(),s.apply(i,arguments)},destroy:function(){return i.stopListening(),o.destroy(),r.destroy(),a.apply(i,arguments)}})}})),define("DS/W3DContentApp/Utils/Actions/Iterations/Base",["DS/W3DContentApp/BusEvent"],(function(e){"use strict";return function(t){var n={actions:[],init:function(e){var t=Object.assign({},e);this.model=t.model},toJSON:function(){var e=this.model,t=this.actions.filter((function(t){return e.isActionAllowed(t.id)}));return t.length?t:null},dispatchIterationActions:function(t,n){e.dispatchEvent("iteration:"+t,n)}};return n.init(t),n}})),define("DS/W3DContentApp/Views/InodeDetailView/inodeFileHistoryView",["UWA/Class/View","DS/UIKIT/Scroller","DS/UIKIT/Spinner","DS/W3DContentApp/Views/InodeDetailView/versionsView","DS/W3DContentApp/BusEvent"],(function(e,t,n,i,o){"use strict";return function(r){if(!r||!r.model||!r.itemView)throw new Error("Missing input");var s=new e,a=s.destroy,l=new n({className:"inode-version__spinner"}).show(),c=r.model,d=c.inodeVersions,u=i({collection:d,itemView:r.itemView}).render();return s.container.setContent([l,u]),s.listenTo(d,{onReset:function(){l&&l.hide()}}),s.listenTo(c,{"onChange:thumbnail":function(){o.dispatchEvent("inodeFileHistoryView:onVersions",[c])}}),s.container.classList.add("inode-detail__body"),s.container.classList.add("inode-versions"),o.dispatchEvent("inodeFileHistoryView:onVersions",[c]),new t({element:s.container}),Object.assign(s,{destroy:function(){l&&l.destroy(),u&&u.destroy(),a.apply(s,arguments),s.container=null,s.stopListening()}})}})),define("DS/W3DContentApp/Views/errorDetailsModal",["DS/W3DContentApp/Views/SuperModal","DS/UIKIT/Scroller","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/UIKIT/UIKIT.css","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n){"use strict";return function(i){var o=i.title?i.title:n.details,r=i.message?i.message:"",s="",a=i.items,l=document.createElement("div"),c=document.createElement("div");c.classList.add("errorDetail"),a.map((function(e){return s=s.concat("- ").concat(e).concat("</br>")})),c.innerHTML=s,new t({element:c}).inject(l);var d=document.createElement("div");d.innerHTML=r,d.appendChild(l);var u={title:o,body:d,buttons:[{value:n.close,action:function(e){e.hide()}}]};e.dialog(u)}})),define("DS/W3DContentApp/Utils/Actions/delete",["DS/W3DContentApp/Views/SuperModal","DS/W3DDrive/Utils/StructureNavigation","DS/W3DDrive/Metas/DSDrive/inode","DS/UIKIT/Input/Toggle","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o){"use strict";var r=n();return function(n,a){void 0===(a=a||{}).isPermanent&&(a.isPermanent=!1);var l={};if(Array.isArray(n)||!0!==n.isCollabSpace())return Array.isArray(n)&&n.length>0?n[0].drive.getInode(r.ids.trash,{noCreate:!0})&&n[0].get("parentId")!==r.ids.trash||(a.isPermanent=!0):n.drive.getInode(r.ids.trash,{noCreate:!0})&&n.get("parentId")!==r.ids.trash||(a.isPermanent=!0),l=!0!==a.isPermanent&&t.isLinkedFile(n)?function(e,t){var n=t.dispatchEvent,r=o.get("deleteElem",{name:e.get("title")}),s=document.createElement("span");s.innerHTML=o.get("confirmDeletion");var a=document.createElement("div");a.innerHTML=o.get("options"),a.classList.add("deleteview__label-options");var l={name:"deleteType",className:"primary"},c=new i(Object.assign({},l,{value:"all",label:o.get("deleteLinkedFiles")})).check(),d=new i(Object.assign({},l,{value:"one",label:o.get("deleteFileOnly")})),u=document.createElement("div");return u.classList.add("deleteview"),u.appendChild(s),u.appendChild(a),u.appendChild(c.elements.container),u.appendChild(d.elements.container),{title:r,body:u,buttons:[{className:"primary",value:o.get("deleteText"),action:function(t){t.hide();var i={};c.isChecked()&&(i.queryStrings={expand:"true"}),n("onDelete",[e,i])}},{value:o.get("cancel"),action:function(e){e.hide()}}]}}(n,a):s(n,a),e.dialog(l);n.doesItHaveContent().then((function(t){return l=t.contentTotal>0?function(e,t){var n="",i="",r=e;n=o.get("deleteElem",{name:r.get("title")}),e.drive.isCollabSpace&&"myCollabSpaces"===e.get("parentId")&&(i=o.get("InfoCSNotEmpty"));return{title:n,body:i,buttons:[{value:o.get("ok"),action:function(e){e.hide()}}]}}(n):s(n,a),e.dialog(l)}))};function s(e,t){var n=t.dispatchEvent,i="",r="";if(Array.isArray(e))i=o.get("deleteElems"),r=e.length>0&&e[0].drive.get("isDrivesHubProvider")?o.get("confirmDeleteElemsExternalService"):!0===t.isPermanent?o.get("confirmPermaDeletionElems"):o.get("confirmDeleteElems");else{var s=e;i=o.get("deleteElem",{name:s.get("title")}),r=e.drive.isCollabSpace&&"myCollabSpaces"===e.get("parentId")?o.get("confirmCSDeletion"):e.drive.get("isDrivesHubProvider")?o.get("confirmDeletionExternalService"):!0===t.isPermanent?o.get("confirmPermaDeletion"):o.get("confirmDeletion")}return{title:i,body:r,buttons:[{className:"primary",value:o.get("deleteText"),action:function(i){i.hide();var o={notrash:!!t.isPermanent};n("onDelete",[e,o])}},{value:o.get("cancel"),action:function(e){e.hide()}}]}}})),define("DS/W3DContentApp/Views/InodeDetailView/inodePropertiesView",["UWA/Class/View","DS/W3DContentApp/Utils/Helpers","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t){"use strict";function n(e,t,n){const i=e.querySelector('*[model-key="'+t+'"]');if(!i)return;Boolean(n)?(i.parentElement.classList.add("property-row--visible"),n instanceof HTMLElement?i.appendChild(n):i.textContent=n):i.parentElement.classList.remove("property-row--visible")}function i(e,t,i){var o=document.createElement("div"),r=function(e){var t=document.createElement("div");return t.textContent=e,t}(t),s=function(e){var t=document.createElement("div");return t.setAttribute("model-key",e),t}(e);return r.classList.add("property-row__cell"),r.classList.add("property-row__cell--label"),s.classList.add("property-row__cell"),s.classList.add("property-row__cell--value"),o.classList.add("property-row"),o.classList.add("inode-properties-table__property-row"),[r,s].map(o.appendChild.bind(o)),n(o,e,i),o}function o(e,n){var i;switch(i=e.value?e.value(n):n.get(e.attribute),e.type){case"string":case"element":break;case"date":i=i?t.getDateStr(i):"";break;case"bytes":i=void 0===i||i<0||n.isFolder()?"":t.computeNLSSize(i);break;default:throw new Error("Missing attribute type")}return i}return function(t){var r=t.model,s=t.listProperties,a=new e(t),l=a.destroy,c=function(e,t){var i={};return e.forEach((function(e){i["onChange:"+e.attribute]=function(i,r){r=o(e,i),n(t.container,e.key,r)}})),i}(s,a);return a.container.classList.add("inode-detail-properties"),Object.assign(a,{render:function(){a.stopListening(),a.listenTo(r,c);var e,t,n=a.container,l=function(e,t){return"trueRootId"===t.get("parentId")&&(e=e.filter((function(e){return"type"===e.key}))),e.map((function(e){const n=o(e,t);return{key:e.key,txt:e.nls,val:n}}))}(s,r);return n.childNodes.length<1&&n.appendChild((e=l,(t=document.createElement("div")).classList.add("properties-table"),t.classList.add("inode-properties-table"),(e=e.map((function(e){return i(e.key,e.txt,e.val)}))).map(t.appendChild.bind(t)),t)),a},destroy:function(){a.stopListening(),r=null,c=null,l.apply(a,arguments),a.container=null,a.model=null,t=null}})}})),define("DS/W3DContentApp/Utils/contextHelpers",["UWA/Utils/Client","DS/W3DContentApp/Metas/inode","DS/W3DContentApp/Utils/IntegrationHelper"],(function(e,t,n){"use strict";var i,o,r,s={},a=t();return(s={contexts:{iOSContext:{id:"iOSContext",isActive:!(!e.Platform.hasOwnProperty("ios")||!0!==e.Platform.ios)},CATIAV5:{id:"CATIAV5",isActive:!!n.CATIAV5}}}).actionsFilters=(i={},o={iOSFilter:{context:s.contexts.iOSContext.id,forbiddenActions:[],filter:function(e){return"object"==typeof e&&(e=e.id),-1===this.forbiddenActions.indexOf(e)}},CATIAV5Filter:{context:s.contexts.CATIAV5.id,forbiddenActions:[a.actionPubIds.preview],filter:function(e){return"object"==typeof e&&(e=e.id),-1===this.forbiddenActions.indexOf(e)}}},r=function(e,t){return t.filter((function(t){return e.filter(t)}))},i.apply=function(e,t){return!!o.hasOwnProperty(e)&&r(o[filerName],t)},i.applyContext=function(e,t){return Object.keys(o).map((function(n){o[n].context===e&&(t=r(o[n],t))})),t},i.applyCurrentContexts=function(e){var t=function(){var e=[];return Object.keys(s.contexts).map((function(t){("function"==typeof s.contexts[t].isActive&&!0===s.contexts[t].isActive()||"boolean"==typeof s.contexts[t].isActive&&!0===s.contexts[t].isActive)&&e.push(s.contexts[t].id)})),e}();return Object.keys(o).map((function(n){-1!==t.indexOf(o[n].context)&&(e=r(o[n],e))})),e},i),s})),define("DS/W3DContentApp/Metas/actions",["DS/W3DContentApp/Metas/inode","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t){"use strict";var n=e(),i=[{id:n.actionPubIds.viewInformation,text:t.get("viewInformation"),icon:"info",fonticon:"info"},{id:n.actionPubIds.preview,text:t.get("preview"),icon:"eye",fonticon:"eye"},{id:n.actionPubIds.openFileLocation,text:t.get("OpenFileLocation"),icon:"folder-opening",fonticon:"folder-opening"},{id:n.actionPubIds.share,text:t.get("share"),icon:"share-alt",fonticon:"share-alt"},{id:n.actionPubIds.getLink,text:t.get("getLink"),icon:"link",fonticon:"link"},{id:n.actionPubIds.shareContent,text:t.get("share"),icon:"share-alt",fonticon:"share-alt"},{id:n.actionPubIds.editDocument,text:t.get("editDocument"),icon:"pencil",fonticon:"pencil"},{id:n.actionPubIds.addToFavorites,text:t.get("AddToFavorites"),icon:"favorite-add",fonticon:"favorite-add"},{id:n.actionPubIds.removeFromFavorites,text:t.get("RemoveFromFavorites"),icon:"favorite-delete",fonticon:"favorite-delete"},{id:n.actionPubIds.moveTo,text:t.get("moveTo"),icon:"move-to",fonticon:"move-to"},{id:n.actionPubIds.copy,text:t.get("copyTo"),icon:"docs",fonticon:"docs"},{id:n.actionPubIds.changeProperties,text:t.get("changeProperties"),icon:"properties-pencil",fonticon:"properties-pencil"},{id:n.actionPubIds.createFolder,text:t.get("createFolder"),icon:"folder-add",fonticon:"folder-add"},{id:n.actionPubIds.uploadFolder,text:t.get("uploadFolder"),icon:"folder-upload",fonticon:"folder-upload"},{id:n.actionPubIds.upload,text:t.get("uploadFile"),icon:"doc-upload",fonticon:"doc-upload"},{id:n.actionPubIds.download,text:t.get("download"),icon:"download",fonticon:"download"},{id:n.actionPubIds.openWith,text:n.actionPubIds.openWith,icon:"export",fonticon:"export"},{id:n.actionPubIds.insert,text:t.get("insert"),icon:"import",fonticon:"import"},{id:n.actionPubIds.update,text:t.get("update"),icon:"update",fonticon:"update"},{id:n.actionPubIds.createCollabSpace,text:t.get("newCollabSpace"),icon:"folder-add",fonticon:"folder-add"},{id:n.actionPubIds.addContent,text:t.get("addContent"),icon:"upload",fonticon:"upload"},{id:n.actionPubIds.addMember,text:t.get("addMember"),icon:"user-add",fonticon:"user-add"},{id:n.actionPubIds.addMemberRestricted,text:t.get("addMember"),icon:"user-add",fonticon:"user-add"},{id:n.actionPubIds.editCS,text:t.get("EditProperties"),icon:"pencil",fonticon:"pencil"},{id:n.actionPubIds.changeThumbnail,text:t.get("changeThumbnail"),icon:"picture",fonticon:"picture"},{id:n.actionPubIds.del,text:t.get("deleteText"),icon:"trash",fonticon:"trash"},{id:n.actionPubIds.deleteSpace,text:t.get("deleteText"),icon:"trash",fonticon:"trash"},{id:n.actionPubIds.delFinal,text:t.get("deleteText"),icon:"trash",fonticon:"trash"},{id:n.actionPubIds.moveToCS,text:t.get("moveTo"),icon:"move-to",fonticon:"move-to"},{id:n.actionPubIds.editContent,text:t.get("EditProperties"),icon:"pencil",fonticon:"pencil"},{id:n.actionPubIds.deleteContent,text:t.get("deleteText"),icon:"trash",fonticon:"trash"},{id:n.actionPubIds.downloadVersion,text:t.get("download"),icon:"download",fonticon:"download"},{id:n.actionPubIds.restoreVersion,text:t.get("restore"),icon:"rotate-ccw",fonticon:"rotate-ccw "},{id:n.actionPubIds.restore,text:t.get("restore"),icon:"rotate-ccw",fonticon:"rotate-ccw "},{id:n.actionPubIds.addToMyDrive,text:t.get("addToMyDrive"),icon:"drive-add",fonticon:"drive-add"},{id:n.actionPubIds.removeFromMyDrive,text:t.get("removeFromMyDrive"),icon:"drive-delete",fonticon:"drive-delete"},{id:n.actionPubIds.removeOwnAccess,text:t.get("revokeAccess"),icon:"block",fonticon:"block"}];return i.map((function(e){return Object.freeze(e)})),function(){return i.slice()}})),define("DS/W3DContentApp/Actions/Utils/actionsUtils",["UWA/Core","DS/W3DContentApp/Views/SuperModal","DS/UIKIT/Alert","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i){"use strict";return{showGenericConfirmationModal:function(e,n,o,r){return t.dialog({title:e,body:n,buttons:[{className:"warning",value:o,action:function(e){r(),e.hide()}},{value:i.cancel,action:function(e){e.hide()}}]})},getConfirmationModal:function(e,n,o,r,s){var a=document.createElement("div");a.className="proceed-modal";var l=i.fileIntelligenceError+"<br>",c=n.length;l+="<ul>";for(var d=0;d<c;d++)l+="<li>"+n[d]+"</li>";return l+="</ul><br>",s||(l+=i.replace(i.waitOrAction,{action:o.toLowerCase()})),a.innerHTML=l,t.dialog({title:e,body:a,buttons:[{className:"warning",value:i.proceedAnyway,action:function(e){r(),e.hide()}},{value:i.cancel,action:function(e){e.hide()}}]})},showMoreInfoPopup:function(e,o){var r=e.length,s=document.createElement("div"),a=i.get(o),l=i.replace(i.filesHaveNotbeen,{action:a}),c=document.createElement("span");c.innerHTML=l+".";var d=document.createElement("span");d.innerHTML=i.moreInfo,d.className="download-more-info",d.onclick=function(){var n=document.createElement("div");n.className="more-info-modal";for(var o=i.moreInfoDesc1+"<br><ul>",s=0;s<r;s++)o+="<li>"+e[s]+"</li>";return o+="</ul><br>",o+=i.replace(i.moreInfoDesc2,{action:a}),n.innerHTML=o,t.dialog({title:i.moreInfo,body:n,buttons:[{value:i.close,action:function(e){e.hide()}}]})},s.appendChild(c),s.appendChild(d),new n({closable:!0,renderTo:document.querySelector(".w3ddrive.alert.alert-root"),visible:!0,autoHide:!0,hideDelay:5e3}).add({message:s,className:"primary download-info-alert"})}}})),define("DS/W3DContentApp/Utils/Alert",["DS/UIKIT/Alert","DS/W3DContentApp/Utils/Helpers","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/UIKIT/UIKIT.css"],(function(e,t,n){"use strict";var i,o,r=(i=new e({className:"w3ddrive",autoHide:!0,closable:!0,visible:!0,renderTo:document.body})).add;return i.add=function(e){return"error"!==e.className&&"warning"!==e.className||(i.options.hideDelay=1e4),e.message=t.filterXSS(e.message),r.call(i,e)},i.addWithLink=function(e,n){return"error"!==e.className&&"warning"!==e.className||(i.options.hideDelay=1e4),e.message=t.filterXSS(e.message),n.message=t.filterXSS(n.message),e.message+='<a href="'+n.url+'" target="_blank">'+n.message+" </a>",n.help&&(n.help=t.filterXSS(n.help),e.message+=n.help),r.call(i,e)},i.addAndCallback=function(e){var s={};o=e.callback,"error"!==e.className&&"warning"!==e.className||(i.options.hideDelay=1e4),s.className=e.className,s.message=t.filterXSS(e.message);var a=document.createElement("div");return a.className="btn-link",a.innerText=n.moreDetails,s.message+=a.outerHTML,r.call(i,s)},i.onClick=function(e,t){t.getElementsByClassName("btn-link").length>0&&o&&"function"==typeof o&&o()},i})),define("DS/W3DContentApp/Views/Lightbox/lightboxPreview3DPlay",["UWA/Class/Promise","DS/W3DContentApp/BusEvent","DS/W3DContentApp/Utils/Alert","DS/3DPlayHelper/3DPlayHelper","DS/W3DContentApp/Utils/Store","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o,r){"use strict";var s,a,l;return{init:function(e={}){if(a)return d(e.inode),a;return l=c(),a=Object.assign(l,{refresh:d}),d(e.inode),a},hide3DPlayViewer:function(){s&&(s.informActiveState(!1),s.dispose(),s=null)}};function c(){var e=document.createElement("div");return e.classList.add("preview-3d"),e}function d(c,d={}){if(!c)return e.resolve();function u(){const e=c.get3DPlayOptions(),u=c.get("play360"),p=[],m={loading:"autoplay",callback:{onAnnotationShared:function(e){t.dispatchEvent("lightbox:onAnnotationShared",[e])}},behaviors:p};if(c.get("annotation")&&(e.annotation=c.get("annotation").data.annotationFile,c.unset("annotation")),o.features.isGuestCommentsEnabled&&p.push("comment"),s&&s.instance){const t=s.instance.loadAssetInfo,i=t.originalAsset,o=t&&i&&i.physicalid===c.get("id"),a="PlayExperience3D"===s.getExperience().name;if(s.isReady()&&(!o||o&&!d.previousLightboxVisibility||u||a&&e.annotation))s.informActiveState(!0),s.load({input:e,options:m});else if(e.annotation){let t,i=!1;setTimeout((()=>{clearTimeout(t),i||n.add({message:r.get("annotationLoadError"),className:"error"})}),25e3),function n(){s.isReady()?(i=!0,s.loadAnnotations({annotation:e.annotation},{clean:!0})):t=setTimeout(n,100)}()}}else s=new i({container:l,input:e,options:m});return a}return c.drive.isCollabSpace?c.get("type")&&c.collection&&c.collection._parentInode&&c.collection._parentInode.get("contexts")?u():new e((function(e,t){c.fetch({onComplete:function(){return e(u())}})})):c.getFileUrl().then(u)}})),define("DS/W3DContentApp/Views/PublishTo3DSwymService",["UWA/Class/View","UWA/Core","DS/UIKIT/Spinner","DS/W3DContentApp/Views/SuperModal","DS/W3DContentApp/Utils/Alert","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o,r){"use strict";return e.extend({spinner:null,publishFormView:null,setup:function(e){if(!e)throw new Error("Missing input");this.inode=e},render:function(){this.spinner=new n({className:"spinner-center",visible:!0});const e=t.createElement("div",{class:"sharetoswym",html:[{tag:"div",class:"shareview__description",html:r.publishTo3DSwymDescription},this.spinner,this._createPublishFormView(this.inode).then((t=>{this.spinner.hide(),e.appendChild(t)}))]});return e},destroy:function(){this.stopListening(),this.publishFormView&&this.publishFormView.destroy()},_createPublishFormView:function(e){const t=this;return new Promise((i=>{let s;require(["DS/SwymPublishForm/script/publish-form-view"],(function(a){t.publishFormView=new a({mode:"jsevent",platformId:e._auth.platformId,contentTitle:e.get("title")}),t.publishFormView.addEvent("StartUpload",(function(i){const a=JSON.parse(i),l=new Promise((function(e,t){setTimeout(t,1e4,"long transaction")})),c=new Promise((function(i,o){e.uploadFileToSwym(a).then((function(e){s=e.mediaid,i(),void 0!==s?t.publishFormView.createContent(s):n(r.mediaUploadTo3DSwymError)}),(function(t){if(t&&t.name)if("timeout"===t.name)n(r.replace(r.shareSwymTimeout,{tagName:e.get("title")}));else if(t.message&&t.message.errorID&&void 0!==t.message.errorID){const i=t.message.errorID;let o=r.get(i);o=o?r.replace(o,{tagName:e.get("title")}):r.contentCreationTo3DSwymError,n(o)}else n(r.contentCreationTo3DSwymError);i()}))}));Promise.race([l,c]).then((function(){}),(function(){if(t.publishFormView){if(t.publishFormView.container.hasClassName("masked")){const e=t.publishFormView.container.querySelector(".mask");o.add({className:"warning",message:r.publishTo3DSwymLongTransaction}).inject(e)}}}))})),t.publishFormView.addEvent("ContentCreated",(function(n="{}"){const i=JSON.parse(n);o.addWithLink({message:"",className:"success"},{message:e.get("title"),url:i.contentUrl,help:r.publishTo3DSwymSuccess}),t._closeModal()})),t.publishFormView.addEvent("CancelShare",(function(){t._closeModal()})),t.publishFormView.render(),i(t.publishFormView.getContent())}))}));function n(e){o.add({className:"error",message:e}),t._closeModal()}},_closeModal:function(){const e=i.modals.current;e&&e.hide()}})})),define("DS/W3DContentApp/Utils/formFactory",["UWA/Core","DS/W3DContentApp/Views/SuperModal","DS/UIKIT/Input/Text","DS/UIKIT/Input/Select","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o){"use strict";return{createForm:function(t=[],n={}){let i="form-vertical form form-root";n.className&&(i+=" "+n.className);return e.createElement("form",{class:i,html:t})},createTextError:function(e,t){var n=document.createElement("span");return Object.assign(n,t,{className:"form__message-error",textContent:e})},createTextInput:function(e){var t=document.createElement("input");return Object.assign(t,{autofocus:"true",className:"form-control form-control-root",label:"Title",name:"newContainerName",placeholder:o.title,type:"text",autocomplete:"off"},e)},createTextArea:function(e){return new n(Object.assign({className:"",multiline:!0,rows:4,maxlength:255,required:!1},e))},createSelectInput:function(e){var t=new i({placeholder:!1});return e.options.map((function(e){var n={};n.value=e.value,n.name=e.name,n.id=e.id,n.label=e.label,n.innerText=e.label,n.selected=e.selected,n.disabled=e.disabled,t.add(n)})),t},createTextLabel:function(e,t){var n=document.createElement("span");return Object.assign(n,t,{className:"form__message-label",textContent:e})},createWarningLabel:function(e,t){var n=document.createElement("span");return Object.assign(n,t,{className:"form__message-warning",textContent:e})},disableValidationButton:d,enableValidationButton:u,invalidateInput:r,invalidateInputAndShowErrorMessage:function(e,t,n){return r(e),l(t,n),{input:e,errorMessageElement:t}},onCheckInput:function(e,t,n,i,o){(function(e,t,n,i){-1!==t.maxLength&&t.value.length>=e?c(n,i):function(e){e.classList.remove("form__message--warning")}(n)})(e,t,n,i.maxLengthText),function(e,t,n,i){e.checkValidity()?(s(e),function(e){e.classList.remove("form__message-error--active"),e.classList.add("form__message-error")}(t),document.getElementsByClassName("form__message-error form__message-error--active").length>0?d(i):u(i)):(r(e),l(t,n),d(i))}(t,n,i.chars,o)},showWarningMessage:c,validateInput:s};function r(e){return e.classList.add("form__input--error"),e}function s(e){return e.classList.remove("form__input--error"),e}function a(e){return e.textContent=null,e.classList.remove("form__message-error--active"),e.classList.remove("form__message--warning"),e}function l(e,t){return(e=a(e)).classList.add("form__message-error--active"),e.textContent=t,e}function c(e,t){return(e=a(e)).textContent=t,e.classList.add("form__message--warning"),e}function d(e){const n=t.modals.current.getFooter().getElement(e);n.disabled||(n.disabled=!0)}function u(e){if(!t.modals.current)return;const n=t.modals.current.getFooter().getElement(e);n.disabled&&(n.disabled=!1)}})),define("DS/W3DContentApp/Utils/shareFactory",["UWA/Core","UWA/String","DS/W3DXComponents/Views/Item/PanelAddMemberView","DS/W3DContentApp/Utils/formFactory","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o){"use strict";return{createInvitationView:function(e,i={}){if(!Array.isArray(e))throw new Error("You should provide a categories array input");for(var o,s,a,l,c,d,u,p,m,f,g,h,v=[],D=[],w=0;w<e.length;w++)e[w].id.contains("restricted")?v.push(e[w]):D.push(e[w]);i&&i.inode&&-1!==i.inode.get("actions").indexOf("add.members.restricted")&&(D=v);d={categories:D,suggestFormat:"{fname} {lname}",suggestKey:"login",labelFormat:"{fname} {lname}",placeholder:i.placeholder,typeDelay:500,minLength:2,getSuggestions:S,saveProcess:C},(p=new n(Object.assign(d,i))).elements.buttons.classList.add("shareview__footer"),s=p.render,a=p.destroy,f=Object.assign(p,{render:function(){var e=s.apply(p,arguments),t=p.container.querySelector("input.temp-autocomplete-input");return t&&t.focus(),p.show(),e},destroy:function(){return"function"==typeof o&&o(),a.apply(this,arguments)}}),i&&i.inode&&-1===i.inode.get("actions").indexOf("add.members.restricted")&&v.length>1?(u={categories:v,suggestFormat:"{fname} {lname}",suggestKey:"login",labelFormat:"{fname} {lname}",placeholder:"",typeDelay:500,minLength:2,getSuggestions:S,saveProcess:C},(m=new n(Object.assign(u,i))).elements.buttons.classList.add("shareview__footer"),l=m.render,c=m.destroy,g=Object.assign(m,{renderRestrictedRoles:function(){var e=l.apply(m,arguments),t=m.container.querySelector("input.temp-autocomplete-input");return t&&t.focus(),m.show(),e},destroyRestrictedRoles:function(){return"function"==typeof o&&o(),c.apply(this,arguments)}}),h=[f,g]):h=f;return h;function b(e){var n=e.item,i=n.email;return!i&&t.isEmail(e.selection)&&(i=e.selection),{displayName:n.name||i,emailAddress:i,fname:n.fname,pid:n.id,lname:n.lname,personID:e.selection,picture:n.picture,role:r([e.categoryId]).role,isRestricted:r([e.categoryId]).restricted}}function C(e){return e.map(b)}function S(e,n,i){if(o=function(){Object.keys(n).map((function(e){delete n[e]}))},e)return n[e]?i(n[e]):t.isEmail(e)?i([{login:e,fname:e,lname:"",email:e,role:null}]):i([])}},createMessageElement:function(){const t=e.createElement("span",{class:"js-share-inode_message-label",text:o.get("labelWithCharactersCounter",{label:o.get("addMessage"),nbChars:0,totalChars:255})}),n=i.createTextArea({className:"js-share-inode_message",maxlength:255,required:!1,placeholder:o.get("shareMessage")});return n.getContent().addEventListener("keyup",(()=>{const e=n.getValue().length||0;t.textContent=o.get("labelWithCharactersCounter",{label:o.get("addMessage"),nbChars:e,totalChars:255})})),[t,n].reduce(((e,t)=>(t.tagName?e.appendChild(t):t.inject(e),e)),document.createDocumentFragment())},makeElement:function(e){var t=e||{},n=t.element||"div";"string"==typeof t&&(n=t);var i=t.classes||[],o=document.createElement(n);if("string"==typeof i)return o.classList.add(i),o;for(var r=0;r<i.length;r+=1)o.classList.add(i[r]);return o},onEmailAddress:function(e){return{resourceid:e,label:e,email:e}}};function r(e,t){var n,i,o=t||"reader";return e?(-1!==(e=[].concat(e)).indexOf("giveReadAccess")&&(o="reader"),-1!==e.indexOf("giveEditAccess")&&(o="writer"),-1!==e.indexOf("Reader")&&(o="Reader"),-1!==e.indexOf("PublicReader")&&(o="PublicReader"),-1!==e.indexOf("Contributor")&&(o="Contributor"),-1!==e.indexOf("Author")&&(o="Author"),-1!==e.indexOf("Leader")&&(o="Leader",i=!1),-1!==e.indexOf("Owner")&&(o="Owner",i=!0),-1!==e.indexOf("LeaderOwner")&&(o="Leader",i=!0),-1!==e.indexOf("Readerrestricted")&&(o="Reader",n=!0),-1!==e.indexOf("Contributorrestricted")&&(o="Contributor",n=!0),-1!==e.indexOf("Authorrestricted")&&(o="Author",n=!0),-1!==e.indexOf("Leaderrestricted")&&(o="Leader",n=!0,i=!1),-1!==e.indexOf("Ownerrestricted")&&(o="Owner",n=!0,i=!0),-1!==e.indexOf("LeaderOwnerrestricted")&&(o="Leader",n=!0,i=!0),-1!==e.indexOf("giveShareAccess")&&(o+="Sharer"),{role:o,restricted:n,isAdmin:i}):t}})),define("DS/W3DContentApp/Views/itemView",["UWA/Core","UWA/Class/View","DS/WAFData/WAFData","UWA/Utils/Client","DS/i3DXCompassPlatformServices/OpenWith","DS/W3DContentApp/Utils/dropdownContextmenu","DS/UIKIT/Tooltip","DS/W3DContentApp/Utils/Helpers","DS/W3DDrive/Utils/CompassHelpers","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o,r,s,a,l){"use strict";return function(c){const d=new t({model:c.model,className:"w3ddrive item"}),u=c.viewConf||{},p=d.destroy,m="selected",f={selected:!1};let g,h,v;function D(){const t=c.image,i=c.icon;if(t){const i=c.model.getDefaultThumbnail?c.model.getDefaultThumbnail():"";return e.createElement("div",{class:"image",html:[{tag:"img",src:n.proxifyUrl(t),draggable:!1,onerror:"this.src='"+n.proxifyUrl(i)+"'; this.onerror = null;"}]})}if(i)return e.createElement("div",{class:"image",html:{tag:"span",class:i}})}function w(e,t,n={}){if(!Array.isArray(e)||!t)return null;if(i.Platform.ios||i.Platform.android||i.Platform.ipad||i.Platform.tablet){const t=e.findIndex((e=>"uploadFolder"===e.id));-1!==t&&e.splice(t,1)}const s=e.map((e=>({className:e.className||"",text:e.text||"",fonticon:e.icon,handler:e.handler&&d?e.handler.bind(d):null}))),a=!!n.hasOwnProperty("contextualActionsMenu")&&n.contextualActionsMenu,u=new r({target:a?d.container:t,items:s,contextual:a,className:"item-view-actions-menu"});return u.getItem("openWith")&&(u.removeItem("openWith"),function(e){const t=l.get3DXContent([c.model]);c.model.isContainer()||(c.model.drive.isCollabSpace?""!==c.model.get("taxonomies")[0]?t.data.items[0].objectTaxonomies=c.model.get("taxonomies"):t.data.items[0].objectTaxonomies=c.model.get("type"):t.data.items[0].objectTaxonomies=[c.model.get("fileExtension").toLowerCase()]);(new o).set3DXContent(t).render(e)}(u)),u}function b(){const t=c.actions;if(!t||!t.length)return null;const n=u.actionsFonticon?u.actionsFonticon:"chevron-down",i=e.createElement("div",{class:"actions fonticon fonticon-"+n});return u.actionsIconTooltip&&new s({target:i,body:u.actionsIconTooltip,position:"bottom"}),i}function C(){const t=[],n=c.iconType,i=c.title,o=c.metas;return n&&t.push({tag:"img",src:n}),i&&t.push({class:"header",text:i}),c.attributes&&Object.keys(c.attributes).forEach((e=>{t.push({class:e,html:c.attributes[e]||""})})),o&&t.push({tag:"div",class:"meta",html:[].concat(o).filter(Boolean).map((e=>({tag:"span",text:e})))}),e.createElement("div",{class:"content",html:t})}function S(e,t={}){const n=d.container.actionsDropdownMenu;n&&n.remove(),d.container.actionsDropdownMenu=w(e,v,t)}function y(e){void 0!==e&&(f.selected=Boolean(e)),f.selected?d.container.addClassName(m):d.container.removeClassName(m)}return d.delegateDOMEvents({"click .actions":function(e){const t=c.actions;if(u.noActionsMenu&&1===t.length)t[0].handler();else{if(d.container.actionsDropdownMenu&&d.container.actionsDropdownMenu.isVisible)return void d.container.parentElement.click();S(t),d.container.actionsDropdownMenu.show(!1,e)}}}),y(c.selected),Object.assign(d,{render:function(){d.container.empty(),g=null,h=null,g=D(),v||(v=b()),h=C();const t=[g,h,v];c.withSelectionIcon&&t.splice(0,0,e.createElement("span",{class:"item__selection_icon fonticon fonticon-check"})),d.container.setContent(t.filter(Boolean));const n=!u.hasOwnProperty("draggable")||u.draggable;return d.container.setAttribute("draggable",n),d},refreshImg:function(){const e=D();return g?a.replaceWith(g,e):h&&e.inject(h,"before"),g=e,d},refreshActionsDropdownMenu:S,toggleActionsElemVisibility:function(e=!0){v&&(v.style.visibility=e?"visible":"hidden")},refreshContent:function(){const e=C();return a.replaceWith(h,e),h=e,!v&&c.actions&&c.actions.length>0&&(v=b(),d.container&&v.inject(d.container)),(!c.actions||!c.actions.length&&v)&&(v.parentNode.removeChild(v),v=null),d},refreshSelected:y,destroy:function(){return d.undelegateDOMEvents(),d.container.removeEvents(),g=null,h=null,v=null,p.apply(d,arguments)}})}})),define("DS/W3DContentApp/Utils/inodeItemViewAttributes",["DS/W3DContentApp/Utils/Helpers","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t){"use strict";return function(n){if(!n)return[];let i=[];return i=n.drive.isDsDrive||n.drive.isDrivesHubDrive?"recents"===n.get("id")?[{classname:"title",key:"title",nls:t.get("title"),value:function(e){return[{tag:"span",text:e.get("alias")||e.get("title")},e.isShared()&&!e.isFolder()?{tag:"span",class:"fonticon fonticon-users"}:"",e.isFavorite()?{tag:"span",class:"fonticon fonticon-favorite-on"}:""]}},{classname:"interaction",key:"interaction",nls:t.get("LastAction"),value:function(e){return e.get("interaction")}},{classname:"interactionDate",key:"interactionDate",nls:t.get("Date"),value:function(n){const i=n.get("interactionDate");return e.isToday(i)?t.get("Today")+", "+e.getTimeStr(i):i?e.getDateStr(i,!0):null}},{classname:"size--recent",key:"size",nls:t.get("Size"),value:function(t){return t.isFolder()?"-":e.computeNLSSize(t.get("size"))}},{classname:"type--recent",key:"type",nls:t.get("Type"),value:function(e){return e.getNLSType()}}]:[{classname:"title",key:"title",nls:t.get("title"),value:function(e){return[{tag:"span",text:e.get("alias")||e.get("title")},e.isShared()&&!e.isFolder()?{tag:"span",class:"fonticon fonticon-users"}:"",e.isFavorite()?{tag:"span",class:"fonticon fonticon-favorite-on"}:""]},sortable:!0},{classname:"modifiedDate",key:"modifiedDate",nls:t.get("Modified"),value:function(t){const n=t.get("modifiedDate");return n?e.getDateStr(n,!0):null},sortable:!0},{classname:"size",key:"size",nls:t.get("Size"),value:function(t){return t.isFolder()?"-":e.computeNLSSize(t.get("size"))},sortable:!0},{classname:"type",key:"type",nls:t.get("Type"),value:function(e){return e.getNLSType()},sortable:!0},{classname:"creator",key:"creator",nls:t.get("Creator"),value:function(e){return e.getCreator()},sortable:!0}]:"myCollabSpaces"===n.id?[{classname:"title",key:"title",nls:t.get("title"),value:function(e){return[{tag:"span",text:e.get("title")}]},sortable:!0},{classname:"modifiedDate",key:"modifiedDate",nls:t.get("Modified"),value:function(t){const n=t.get("modifiedDate");return n?e.getDateStr(n,!0):null},sortable:!0},{classname:"visibility",key:"visibility",nls:t.get("Visibility"),value:function(e){return e.get("visibility")?e.get("visibility").name:""}},{classname:"family",key:"family",nls:t.get("Family"),value:function(e){return e.get("family")?e.get("family").name:""}}]:[{classname:"title",key:"title",nls:t.get("title"),value:function(e){return[{tag:"span",text:e.get("title")}]},sortable:!0},{classname:"modifiedDate",key:"modifiedDate",nls:t.get("Modified"),value:function(t){const n=t.get("modifiedDate");return n?e.getDateStr(n,!0):null},sortable:!0},{classname:"type",key:"type",nls:t.get("Type"),value:function(e){return e.get("type")?e.get("type").name:""}},{classname:"maturity",key:"maturity",nls:t.get("MaturityState"),value:function(e){return e.get("maturity")?e.get("maturity").name:""}},{classname:"owner",key:"owner",nls:t.get("owner"),value:function(e){return e.getOwnerNames()}}],i}})),define("DS/W3DContentApp/Views/InodeDetailView/inodeDetailView",["UWA/Utils","DS/W3DContentApp/Views/InodeDetailView/inodeDetailViewFunc","DS/W3DDrive/widget","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n){"use strict";return function(i={}){const o=t.getView(i),r=i.model,s=o.destroy,a=i.viewSpecs;if(!a||!a.detailViewsList||!a.defaultView)throw new Error("Missing input");a.detailViewsList.forEach((e=>{if(!(e&&e.key&&e.view&&e.icon))throw new Error("Missing input")}));const l={"onChange:title":function(e,n){t.refreshHeader(o.container,e.get("alias")?e.get("alias"):n)},"onChange:alias":function(e,n){t.refreshHeader(o.container,n)},"onChange:actions":function(){o.elements.bodyView=void 0,p()}},c={"onChange:shareWithExternal":function(){p()}};let d=!1;function u(n){const i=o.elements.bodyView;if(i){if(n===t.getBodyElemKey(i.container))return i;e.setImmediate((function(){i.destroy()}))}const s=a.detailViewsList.find((e=>e.key===n));return o.elements.bodyView=t.createBody(s,{model:r}),o.elements.bodyView}function p(){if(o.stopListening(),o.listenTo(r,l),r.drive&&o.listenTo(r.drive,c),d)for(;o.container.firstChild;)o.container.removeChild(o.container.firstChild);else;const e=t.getViewKey(n.getValue("inodeDetailViewKey"),r,a),s=u(e);if(n.getValue("is3DSpaceWidget"))if(r.isCollabSpace())o.container.setContent([t.createHeader(r,i.headerOptions),t.createNavigation(e,r,a.detailViewsList),t.wrapBody(s.container)]);else if("myCollabSpaces"===r.id)o.container.setContent([t.createHeader(r,i.headerOptions)]);else if(n.getValue("saved-fragment").contains("preview"))o.container.setContent([t.wrapBody(s.container)]);else{o.container.setContent([t.createCloseIcon(r,i.headerOptions),t.wrapBody(s.container)]),document.getElementsByClassName("inode-detail inode-panel__detail")[0].addClassName("inode-detail__bodySpaceContent")}else o.container.setContent([t.createHeader(r,i.headerOptions),t.createNavigation(e,r,a.detailViewsList),t.wrapBody(s.container)]);return s.render(),d=!0,o}return o.delegateDOMEvents({"click .navigation__header":function(e){let i=t.getNavigationHeaderKey(e.target);i=t.getViewKey(i,r,a),t.refreshNavigation(o.container,i),t.refreshBodyWithView(o.container,u(i)),n.dispatchEvent("onUpdateInodeDetailViewKey",i)}}),Object.assign(o,{render:p,destroy:function(){o.stopListening(),d=!1,o.undelegateDOMEvents(),s.apply(o,arguments),o.container=null,o.model=null},navigateToTab:function(e){const i=t.getViewKey("inode-detail-"+e,r,a);t.refreshNavigation(o.container,i),t.refreshBodyWithView(o.container,u(i)),n.dispatchEvent("onUpdateInodeDetailViewKey",i)},isTabActive:function(e){return Boolean(o.container.querySelector('.navigation__header.navigation__header--selected > span[data-key="inode-detail-'+e+'"]'))}})}})),define("DS/W3DContentApp/Utils/Platform",["UWA/Class/Promise","DS/W3DDrive/widget","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/Utils/Alert","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o,r){"use strict";let s,a,l=[],c=!1;const d=()=>{const e=t.getValue("driveId"),n=i.getQueryHashParameter("content","saved-fragment");let o;"string"==typeof n&&(o=n.replace(/%252F|%2F/g,"/").split("/")[1]);const r=decodeURIComponent(i.getQueryHashParameter("content","X3DContentId"));let s;const a=new RegExp(/("envId":)"([^"]*)"/gi);return a.test(r)&&(s=r.match(a)[0].replace(/"/g,"").split(":")[1]),e||o||s||t.getValue("x3dPlatformId")};function u(){return new e(((s,a)=>c?s(l):(c=!0,n.getPlatformServices({onComplete:function(n){n.length?(n=>{const o=i.getAppBehaviour("driveServiceUrl")?decodeURIComponent(i.getAppBehaviour("driveServiceUrl")):null;return new e((i=>{if(n){const r=n.filter((e=>"true"===t.getValue("is3DSpaceWidget")?e["3DSpace"]:e["3DDrive"])).map((e=>({id:e.platformId,displayName:e.displayName,url:o||e["3DDrive"],urlSwym:e["3DSwym"],url3DSpace:e["3DSpace"],urlUsersGroup:e.usersgroup,urls3DSearch:e["3DSearch"],urlDrivesHub:e.driveshub,urlDashboard:e["3DDashboard"],urlDfcs:e.distributedfilestore,urlPassport:e["3dpassportnta"],urlODE:e.officedocumenteditor})));e.all(r).then((e=>{i(e)}))}}))})(n).then((e=>{if((e=>{if(!i.isTransientWidget()){const n=[];!t.showAllPlatforms&&e.length>1&&e.forEach((e=>{n.push({value:e.id,label:e.displayName})})),("true"!==t.getValue("is3DSpaceWidget")||"true"===t.getValue("is3DSpaceWidget")&&n.length>1)&&(n.sort(((e,t)=>e.label.localeCompare(t.label))),t.addPreference({type:"list",name:"selectedPlatform",label:"3DEXPERIENCE Platform",options:n}),t.setValue("selectedPlatform",d()))}})(e),document.dispatchEvent(new CustomEvent("all-platforms-available",{detail:{platforms:e}})),!t.showAllPlatforms&&d()){const n=e.find((e=>e.id===d()));n?l=[n]:(l=[e[0]],o.add({className:"warning",message:r.get("platformNotAccessible",{platformId:d()})}),t.deleteValue("x3dPlatformId"))}else l=e;s(l)})):s([])},onFailure:a}))))}return{getSelectedPlatformId:d,getAllPlatforms:function(){return new e(((e,t)=>this.getCurrentPlatform().then((t=>{u(),e(t?[t]:[])})).catch((e=>t(e)))))},getCurrentPlatform:function(){const o=i.getAppBehaviour("driveServiceUrl")?decodeURIComponent(i.getAppBehaviour("driveServiceUrl")):null;return new e(((e,i)=>{const r=d(),s=l.find((e=>e.id===r));return s?e(s):n.getPlatformServices({platformId:r,onComplete:function(n){if(n&&("true"===t.getValue("is3DSpaceWidget")&&n["3DSpace"]||n["3DDrive"])){const t={id:n.platformId,displayName:n.displayName,url:o||n["3DDrive"],urlSwym:n["3DSwym"],url3DSpace:n["3DSpace"],urlUsersGroup:n.usersgroup,urls3DSearch:n["3DSearch"],urlDrivesHub:n.driveshub,urlDashboard:n["3DDashboard"],urlDfcs:n.distributedfilestore,urlPassport:n["3dpassportnta"],urlODE:n.officedocumenteditor};l.push(t),e(t)}else u().then((t=>e(t[0])))},onFailure:i})}))},resetPlatformsCache:function(){l=[]},getPassportUrl:function(){const t=this;return new e((e=>a?e(a):t.getAllPlatforms().then((t=>{const n=t.filter((e=>e.urlPassport)),i=n.find((e=>e.id===d()));i?a=i.urlPassport:n.forEach((e=>{a||(a=e.urlPassport)})),e(a)}))))},getDrivesHubUrl:function(){const t=this;return new e((e=>s?e(s):t.getAllPlatforms().then((t=>{const n=t.filter((e=>e.urlDrivesHub)),i=n.find((e=>e.id===d()));i?s=i.urlDrivesHub:n.forEach((e=>{s||(s=e.urlDrivesHub)})),e(s)}))))}}})),define("DS/W3DContentApp/Utils/RequestHelper",["DS/WAFData/WAFData","UWA/Data","UWA/String","UWA/Services/Auth","DS/W3DContentApp/Utils/Platform","DS/W3DDrive/widget","DS/W3DContentApp/Metas/errors","DS/W3DContentApp/Utils/Alert","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o,r,s,a,l){"use strict";const c=Boolean(r.getValue("isStandalone")),d=s().xmlhttprequestCodes;let u;const p={_tenant:null,_baseUrl:null,_uuid:r.getValue("3ddrive_uuid"),setTenant:function(e){this._tenant=e},getTenant:function(){return this._tenant},hasTenant:function(){return Boolean(this._tenant)},setBaseUrl:function(e){this._baseUrl=e},getBaseUrl:function(e){let t=this._baseUrl||e;return c?n.format("{0}/resources/3ddrive/v1/shared/bos",t):n.format("{0}/resources/3ddrive/v1/bos",t)},manageFailure:function(e,t,n,i){if(n&&"function"==typeof n)n(e,t,i);else if(e===d.CONFLICT)a.add({message:l.get("duplicationError",{msg:t.error.message,fileName:t.error.filename}),className:"error"});else a.add({message:l.get("unexpectedError"),className:"error"})},performRequest:function(e,t,n,i,o,s){r.getValue("is3DSpaceWidget")||(e+=-1!==e.indexOf("?")?"&":"?",e+="lastmodifier="+p._uuid);var a=p.performRequestWithOptions(e,{type:o||"json",method:s||"get",data:i||null,onComplete:t||null,onFailure:function(e,t){p.manageFailure(a.xhr.status,t,n,{xhr:a.xhr})}});return a},performExternalRequestWithOptions:function(e,n){return t.request(e,n)},performRequestWithOptions:function(t,n={}){let s;t=p.addQueryStrings({url:t,queryStrings:{tenant:o.getSelectedPlatformId()||p._tenant}}),!n.auth||n.auth instanceof i||(!1===p.hasTenant()&&n.auth&&!r.getValue("x3dPlatformId")&&(t=p.addQueryStrings({url:t,queryStrings:{tenant:n.auth.platformId}})),n.headers||(n.headers={}),n.headers["X-DS-CSRFTOKEN"]=u||"",s=n.onComplete,n.onComplete=function(e,t,n){var i=Object.keys(t).filter((function(e){return-1!==e.search(/x-ds-csrftoken/i)}));u=i.length>0?t[i[0]]:u,"function"==typeof s&&s(e,t,n)}),n.type||(n.type="json");var a=null;let l;var d;if(n.onFailure&&(a=n.onFailure),n.onFailure=function(e,t){p.manageFailure(l.xhr.status,t,a,{xhr:l.xhr})},c&&-1!==t.indexOf("shared")&&(t=p.addQueryStrings({url:t,queryStrings:{token:r.getValue("token")}})),!r.getValue("is3DSpaceWidget"))if(n.data)if("string"==typeof n.data){try{d=JSON.parse(n.data)}catch(e){d={}}d.lastmodifier=p._uuid,n.data=JSON.stringify(d)}else(d=n.data?n.data:{}).lastmodifier=p._uuid,n.data=d;else t+=-1!==t.indexOf("?")?"&":"?",t+="lastmodifier="+p._uuid;return delete n.auth,l=e.authenticatedRequest(t,n),l},getRequestMethod:function(e,t){return!0===t||e.ajax&&e.ajax==p.performExternalRequestWithOptions?p.performExternalRequestWithOptions:p.performRequestWithOptions},addQueryStrings:function(e={}){if(!e.url)return"";let t=e.url.includes("?")?e.url:e.url+"?";const n=e.queryStrings;return n&&Object.keys(n).forEach((e=>{let i="&"+e;const o=n[e];void 0!==o&&(i+="string"==typeof o?"="+o:"","?"===t[t.length-1]&&(i=i.substring(1,i.length)),t+=i)})),t}};return p})),define("DS/W3DContentApp/Utils/Rerouter",["UWA/String","DS/W3DContentApp/Metas/inode","DS/W3DDrive/Metas/DSDrive/inode","DS/W3DContentApp/Metas/errors","DS/W3DContentApp/Utils/RequestHelper","DS/W3DContentApp/Utils/Store"],(function(e,t,n,i,o,r){"use strict";var s=i().xmlhttprequestCodes,a=i().w3ddrive,l={Router:null,setRouter:function(e){this.Router=e},_getRessource:function(e,t){return new Promise(((n,i)=>{const a=o.performRequestWithOptions(`${e}/share/v1/guest/${encodeURIComponent(t)}`,{onComplete:function(e){o.setTenant(e.tenant),o.setBaseUrl(`${e.url.split("/enovia")[0]}/enovia`),e?new Promise((t=>{o.performRequestWithOptions(`${e.url.split("/enovia")[0]}/enovia/resources/3ddrive/v1/shared/admin/config`,{onComplete:function(e={}){const n="true"===e.guestcomments;t(n)},onFailure:function(){t()}})})).then((t=>{o.performRequestWithOptions(`${e.url.split("/enovia")[0]}/enovia/resources/guest/share/accesses/${e.objectid}`,{onComplete:function(i={}){r.features.isGuestCommentsEnabled=t&&i.comment,n(e)},onFailure:function(){n(e)}})})):i({status:s.NOT_FOUND})},onFailure:function(e,t){var n;t&&!0===t.hasOwnProperty("error")&&(n=t.error),i({status:a.xhr.status,msg:n})}})}))},_getContent:function(e,t){return this._getRessource(e,t).then((function(e){const t=e.url;return new Promise((function(n,i){var r=o.performRequest(t,(function(t){t?(t.tenant=e.tenant,n(t)):i({status:s.NOT_FOUND})}),(function(e,t){var n;t&&!0===t.hasOwnProperty("error")&&(n=t.error),i({status:r.xhr.status,msg:n})}))}))}),(function(e){return new Promise((function(t,n){n(e)}))}))},rerouteFromSharedToken:function(i,o){o?l._getContent(i,o).then((function(i){var o,r=t().mimeType.folder;o=i.mimetype===n().mimeType.folder?e.format("drives/{0}/mimetype/{1}/inode/{2}/content",i.tenant,encodeURIComponent(r),i.id):e.format("drives/{0}/mimetype/{1}/inode/{2}/content/{3}/preview",i.tenant,encodeURIComponent(r),i.parentid,i.id),l.Router.navigate(o,{trigger:!0})}),(function(t){var n;if(t.status===s.NOT_FOUND)n=e.format("error/{0}/{1}/{2}",a.ressourceAccess,t.status,encodeURIComponent(t.msg));else n=e.format("error/{0}/$/{1}",a.ressourceAccess,encodeURIComponent(t.msg));l.Router.navigate(n,{trigger:!0})})):l.Router.navigate(e.format("error/{0}/$/$",a.noToken),{trigger:!0})}};return l})),define("DS/W3DContentApp/Components/UsersInvitation",["UWA/Class/View","UWA/Core","UWA/Promise","UWA/String","DS/W3DContentApp/Utils/RequestHelper","DS/UIKIT/Autocomplete","DS/W3DDrive/widget","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o,r,s,a){"use strict";return e.extend({setup:function(e,t){this.actionIds=e,this.inodes=t},render:function(){return t.createElement("div",{class:"user-invitation",html:[{tag:"div",class:"outer_box",html:[this.createInviteField("giveReadAccess","can_view",this.readSelection),this.createInviteField("giveEditAccess","can_edit",this.editSelection)]}]})},createInviteField:function(e,n,i){if(!this.actionIds.includes(e))return[];return[t.createElement("div",{class:"invite-field",html:[{tag:"div",class:"invite-field-title",html:a[n]},i.call(this,{inodes:this.inodes})]})]},getConfiguration:function(e){return{templateEngine:function(e,t,n){let i='<img class="people-search-img" src="'+n.preview_url+'"/>';e.addClassName("default-template people-search-template with-sub-label"),e.setHTML(i+'<div class="item-label">'+n.label+'</div> <div class="sub-label">'+(n.subLabel?n.subLabel:"")+"</div>")},remoteSearchEngine:function(t,r){let a={};const l=e.inodes,c=`3DDrive-${l.drive.get("user").id}-${Date.now()}`,d=l._auth.platformId,u=i.format("{0}/search",l._auth.platform.urls3DSearch),p=JSON.stringify({source:["swym","usersgroup"],specific_source_parameter:{usersgroup:{additional_query:`AND ([ds6w:label]:"${i.escapeRegExp(r)}" OR [ds6w:label]:(${i.escapeRegExp(r)}*))`},swym:{additional_query:`AND personOrGroup:(${r.trim()})`}},query:'[ds6w:type]:("foaf:Group" OR "pno:Person")',order_by:"asc",order_field:"ds6w:label",select_predicate:["ds6w:label","ds6w:type","ds6w:identifier","dsaccess:groupMemberCount","ds6w:resourceUid"],nresults:8,label:c,with_synthesis:!1,with_synthesis_attribute:!1,tenant:d,locale:s.lang});return new n((function(e,n){o.performRequestWithOptions(u,{type:"json",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},auth:l._auth,data:p,onComplete:function(n){n=n.results||[],a={dataset:t,matchingItems:n&&t.dataParser&&t.dataParser.call(this,t,n,r)},e(a)},onFailure:function(e){e.type="error",e.dataset=t,n(e)},onTimeout:function(e){e.type="timeout",e.dataset=t,n(e)}})})).then((function(e){return e}))},dataParser:function(t,n,o){const r=e.inodes,s=r.get("owners")[0].id,l=r.drive.get("user").id;let c=n.filter((e=>e.hasOwnProperty("attributes"))).map((e=>e.attributes.filter((e=>e.hasOwnProperty("name")&&e.hasOwnProperty("value"))).filter((e=>"dsbase:TemplateInstance"!==e.value)).map((e=>(-1!==e.name.indexOf("ds6w:")&&(e.name=e.name.split("ds6w:")[e.name.split("ds6w:").length-1]),"resourceid"===e.name&&(e.value=e.value.split("iam:")[e.value.split("iam:").length-1]),-1!==e.name.indexOf("dsaccess:")&&(e.name=e.name.split("dsaccess:")[e.name.split("dsaccess:").length-1]),"type"===e.name&&(-1!==e.value.indexOf("pno:")&&(e.value=e.value.split("pno:")[e.value.split("pno:").length-1]),-1!==e.value.indexOf("foaf:")&&(e.value=e.value.split("foaf:")[e.value.split("foaf:").length-1])),e))).filter((e=>"resourceid"===e.name||"label"===e.name||"type"===e.name||"groupMemberCount"===e.name||"resourceUid"===e.name||"preview_url"===e.name||"hash_key"===e.name||"login"===e.name||"ut_state"===e.name||"job_title"===e.name)).reduce(((e,t)=>(e[t.name]=t.value,e)),{}))).map((e=>{if("Group"===e.type){const t=e.groupMemberCount||0,n=1===t?a.get("groupMemberCount"):a.get("groupMembersCount");e.label+=` (${a.replace(n,{total:t})})`}else-1!==e.resourceid.indexOf("mailto:")&&(e.label+=` (${a.get("pending")})`);return e})).filter((e=>(e.value=e.resourceid,e.resourceid!==l&&e.resourceid!==s)));return r.drive.get("shareWithinvitation")&&0===c.length&&i.isEmail(o)&&c.push({label:o,resourceid:o,value:o,preview_url:i.format("{0}/api/user/getpicture/login/{1}",r._auth.platform.urlSwym,o),type:"Person"}),c}}},readSelection:function(e){const t=this;return t.canView=new r({required:!0,datasets:[{configuration:t.getConfiguration(e)}],className:"read-autocomplete",typeDelayBeforeSearch:300,minLengthBeforeSearch:3,placeholder:"Enter a name or a login",multiSelect:!0,events:{onSelect:function(e){if(this.elements.container.getElementsByClassName("autocomplete-searchbox")[0].getElementsByClassName("badge-default").length&&(t.readList=!0,t.shareButtonVisibility()),this.dispatchEvent("onHideSuggests"),t.canEdit&&t.canEdit.badges){const n=t.canEdit.badges.findIndex((t=>t.options.content===e.label));n>-1&&t.canEdit.badges[n].dispatchEvent("onClose")}},onUnselect:function(){this.elements.container.getElementsByClassName("autocomplete-searchbox")[0].getElementsByClassName("badge-default").length<1&&(t.readList=!1,t.shareButtonVisibility()),this.dispatchEvent("onHideSuggests")}}}),t.canView},editSelection:function(e){const t=this;return t.canEdit=new r({required:!0,datasets:[{configuration:t.getConfiguration(e)}],className:"edit-autocomplete",typeDelayBeforeSearch:300,minLengthBeforeSearch:3,placeholder:"Enter a name or a login",multiSelect:!0,events:{onSelect:function(e){if(this.elements.container.getElementsByClassName("autocomplete-searchbox")[0].getElementsByClassName("badge-default").length&&(t.writeList=!0,t.shareButtonVisibility()),this.dispatchEvent("onHideSuggests"),t.canView&&t.canView.badges){const n=t.canView.badges.findIndex((t=>t.options.content===e.label));n>-1&&t.canView.badges[n].dispatchEvent("onClose")}},onUnselect:function(){this.elements.container.getElementsByClassName("autocomplete-searchbox")[0].getElementsByClassName("badge-default").length<1&&(t.writeList=!1,t.shareButtonVisibility()),this.dispatchEvent("onHideSuggests")}}}),t.canEdit},shareButtonVisibility:function(){this.readList||this.writeList?this.dispatchEvent("enableShare"):this.dispatchEvent("disableShare")}})})),define("DS/W3DContentApp/Utils/Metrics",["DS/Usage/TrackerAPI","DS/W3DDrive/widget","DS/W3DContentApp/Utils/RequestHelper"],(function(e,t,n){"use strict";return{trackAction:function(e){if(!e.model)throw new Error("A model is mandatory to track an action.");var n=e.model,o=t.data.is3DSpaceWidget?"X3DCSMA_AP":"X3DDRIV_AP",r=n.drive?n.drive.id:"",s="X3DCSMA_AP"===o?"3dspace.action":"3ddrive.action",a=n.drive?n.drive.title:"",l=e.contextView?e.contextView.replace("-view",""):"",c=e.appContext||(t.getValue("isStandalone")?"guestapp":""),d=n.get("fileExtension"),u="";u="X3DCSMA_AP"===o?n.isContainer()?"collabspace":n.get("type")?n.get("type").value:"":n.isFolder()?"folder":"file";var p={pd1:a,pd2:l,pd3:c,pd4:d,pd5:e.hasLinkedFiles,pd6:u,pd7:e.recursiveDownload};i({tenantID:r,eventCategory:s,eventAction:e.eventAction,eventLabel:e.eventLabel,eventValue:e.eventValue,eventDimensions:p})},trackNavigation:function(e){var o=e.model,r=t.data.is3DSpaceWidget?"X3DCSMA_AP":"X3DDRIV_AP",s="",a="";s=e.tenant?e.tenant?e.tenant:"":t.getValue("saved-fragment")?t.getValue("saved-fragment").split("/")[1]:t.getValue("isStandalone")?n.getTenant():t.getValue("x3dPlatformId");var l="X3DCSMA_AP"===r?"3dspace.navigation":"3ddrive.navigation",c=e.appContext||(t.getValue("isStandalone")?"guestapp":"");let d="";o&&(a="X3DCSMA_AP"===r?o.isContainer()?"collabspace":o.get("type")?o.get("type").value:"":o.isFolder()?"folder":"file",d=o.get("fileExtension"));var u={pd3:c,pd4:d,pd6:a,pd8:e.startingRouteType};i({tenantID:s,eventCategory:l,eventAction:e.eventAction,eventLabel:e.eventLabel,eventValue:e.eventValue,eventDimensions:u})}};function i(n){var i=t.data.is3DSpaceWidget?"X3DCSMA_AP":"X3DDRIV_AP",o=n.tenantID||"",r=n.eventDimensions||{};return function(e){for(var t in e)e[t]?e[t]=e[t].toString():delete e[t]}(r),e.trackPageEvent({eventCategory:n.eventCategory,eventAction:n.eventAction,eventLabel:n.eventLabel,eventValue:n.eventValue,appID:i,tenant:o,persDim:r})}})),define("DS/W3DContentApp/Views/InodeDetailView/inodeDetailSocialView",["DS/W3DXComponents/Views/Layout/ScrollView","DS/W3DContentApp/BusEvent","DS/SocialToolbar/SocialToolbar","DS/W3DDrive/widget","DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/Utils/RequestHelper","DS/W3DContentApp/Utils/Metrics","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o,r,s){"use strict";return function(a={}){let l,c=a.model;const d=a.focusComment||!1;let u,p=!1;i.getValue("isStandalone")?(l=r._baseUrl?`${r._baseUrl}/resources/guest`:"",u=r.getTenant()?r.getTenant():""):(l=`${i.getValue("is3DSpaceWidget")?c._auth.platform.url3DSpace:c._auth.platform.url}/resources`,u=c.drive.get("auth").platformId);const m={subjectURI:(i.getValue("is3DSpaceWidget")?"pid:":"driveid:")+c.id,tenantId:u,enableCommentLike:!0,commentProxyToken:{header:"X-DS-CSRFTOKEN"},serviceURL:l,enableShare:!1,events:{onMediaClick:function(e){e&&"annotation"===e.type&&!p&&(p=!0,setTimeout((()=>{p=!1}),800),t.dispatchEvent("socialToolbar:onPreviewAnnotation",[c,e]))}}};if(i.getValue("isStandalone")&&(m.customHeaders={"X-DS-SHARETOKEN":i.getValue("token")}),d){const e=new RegExp(/(driveid:)(.*)(:comment:)(.*)/);let t=decodeURIComponent(o.getQueryHashParameter("content","commentURI"));t=t&&e.test(t)?t:"";let n=decodeURIComponent(o.getQueryHashParameter("content","replyURI"));n=n&&e.test(n)?n:"";t.match(e)&&t.match(e)[2]===c.id&&(m.commentToScrollToAtInit=n?{parentCommentUri:t,commentUri:n}:{commentUri:t})}let f=new n(m);f.addEvent("onCommentCreated",(()=>{s.trackAction({model:c,eventAction:"commentCreated"})})),f.addEvent("onCommentEdited",(()=>{s.trackAction({model:c,eventAction:"commentEdited"})})),f.addEvent("onCommentDeleted",(()=>{s.trackAction({model:c,eventAction:"commentDeleted"})})),f.addEvent("onSubjectLiked",(()=>{s.trackAction({model:c,eventAction:"contentLiked"})})),f.addEvent("onSubjectUnliked",(()=>{s.trackAction({model:c,eventAction:"contentUnliked"})}));let g=new e({className:"w3ddrive socialtoolbar-scroll",useInfiniteScroll:!1,usePullToRefresh:!1,view:f});const h=g.destroy;return g.destroy=function(){h.apply(g,arguments),f=null,c=null,g.container=null},g}})),define("DS/W3DContentApp/Components/SearchFilterAccesses",["UWA/Class/View","UWA/Core","DS/UIKIT/DropdownMenu","DS/UIKIT/Input/Text","DS/UIKIT/Tooltip","DS/W3DContentApp/Utils/Metrics","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o,r,s){"use strict";return e.extend({tagName:"div",className:"search-filter-view",setup:function(e){if(!e||!e.collection||!e.filterConfig)throw new Error("Missing input");this.options=e,this.collection=e.collection,this.filters={title:"",accessright:"",type:""},this._buildSearchElement(e.searchConfig),this._buildFilterElement(e.filterConfig)},render:function(){return this.elements.searchElement&&this.elements.searchElement.inject(this.container),this.elements.filterElement&&this.elements.filterElement.inject(this.container),this},_buildSearchElement:function(e){const n=this;let a,l,c;this.elements.searchElement=t.createElement("div",{class:"search-container",html:[{tag:"span",class:"item fonticon fonticon-search fonticon-clickable",events:{click:function(){n.elements.searchElement.hasClassName("expanded")||(l.destroy(),n.elements.searchElement.toggleClassName("expanded"),a.focus(),r.trackAction({model:n.collection._parentInode,eventAction:"searchMembers"}))}}},{tag:"span",class:"fonticon fonticon-clear fonticon-clickable",events:{click:function(){a.setValue(""),a.focus(),a.dispatchEvent("onKeyDown")}}}]}),a=new i({placeholder:s.get("SearchMembers"),events:{onKeyDown:function(){setTimeout((function(){const t=a.getValue();n.elements.searchElement.toggleClassName("active",Boolean(t)),clearTimeout(c),t!==n.filters.title&&(c=setTimeout((function(){n.filters.title=t,e.handler&&e.handler.call(n)}),1e3))}))}}}).inject(this.elements.searchElement,"top"),l=new o({target:this.elements.searchElement.querySelector("span.fonticon-search"),body:s.get("SearchMembers"),position:"left"}),new o({target:this.elements.searchElement.querySelector(".fonticon-clear"),body:s.get("Clear"),position:"left"})},_buildFilterElement:function(e){const i=this;this.elements.filterElement=t.createElement("span",{class:"item fonticon fonticon-filter fonticon-clickable"}),this.elements.filterMenu=new n({target:this.elements.filterElement,multiSelect:e.multiSelect,items:e.items,events:{onClick:function(){const t=this.getSelectedItems();i.elements.filterElement.toggleClassName("active",Boolean(t.length));const n=t.filter((e=>"type"===e.category));if(i.options.is3DDrive){const e=this.items.filter((e=>"accessright"===e.category));2===t.filter((e=>"accessright"===e.category)).length?e.forEach((e=>{e.selected||this.disableItem(e.id)})):e.forEach((e=>{this.enableItem(e.id)}))}if(i.options.is3DSpace){const e=t.filter((e=>"role"===e.category));"role"===arguments[1].category&&e.forEach((e=>{e.id!==arguments[1].id&&this.toggleSelection(e)})),r.trackAction({model:i.collection._parentInode,eventAction:"filterMembers"})}"type"===arguments[1].category&&n.forEach((e=>{e.id!==arguments[1].id&&this.toggleSelection(e)})),e.handler&&e.handler.call(i)}}}),new o({target:this.elements.filterElement,body:s.get("Filter"),position:"left"})}})})),define("DS/W3DContentApp/Views/UploadInodesView/tasksView",["UWA/Core","UWA/Class/View","DS/W3DContentApp/Views/UploadInodesView/taskViewSet","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/UIKIT/UIKIT.css"],(function(e,t,n,i){"use strict";function o(e){e instanceof window.HTMLElement&&(e.parentNode||e).classList[e.firstChild?"remove":"add"]("hidden")}function r(e,t){e instanceof window.HTMLElement&&((t=Array.isArray(t)?t:[t]).map((function(t){return e.appendChild(t)})),o(e))}return function(s){const a=new t(Object.assign({className:"w3ddrive tasks-view popover"},s,{domEvents:{"click .cancel-all-btn":function(){n._items.filter((e=>e.state.progress<100)).forEach((e=>{e.cancelUpload()}))},"click .minimize-btn":function(){var e=a.container.getElement(".minimize-btn"),t=e.hasClassName("fonticon-down-open");e[(t?"remove":"add")+"ClassName"]("fonticon-down-open"),e[(t?"add":"remove")+"ClassName"]("fonticon-up-open"),a.container.toggleClassName("minimized")}}}));function l(){return a.container.getElement(".popover-body")}return Object.assign(a,{render:function(){a.container.setContent([e.createElement("div",{class:"popover-arrow"}),e.createElement("div",{class:"popover-title",html:[{tag:"div",class:"title",text:s.title||""},{tag:"div",class:"cancel-all-btn",text:i.cancelAll},{tag:"i",class:"minimize-btn fonticon fonticon-clickable fonticon-down-open"}]}),e.createElement("div",{class:"popover-body",html:s.children})]),o(l())},addChildren:function(e){return r(l(),e)},removeChildren:function(e){return function(e,t){e instanceof window.HTMLElement&&(t=Array.isArray(t)?t:[t]).filter((function(t){return e.contains(t)})).map((function(t,n,i){setTimeout((function(){e&&e.removeChild(t),n===i.length-1&&o(e)}),3e3)}))}(l(),e)},resetChildren:function(e){return function(e,t){e instanceof window.HTMLElement&&(e.childNodes.map((function(t){e.removeChild(t)})),r(e,t))}(l(),e)}})}})),define("DS/W3DContentApp/Views/InodePanelView/inodeItemView",["UWA/Utils","DS/W3DContentApp/Metas/inode","DS/W3DDrive/InodeActions","DS/W3DDrive/inodesActions","DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/Views/itemView","DS/W3DContentApp/BusEvent","DS/W3DContentApp/Utils/inodeItemViewAttributes","DS/W3DContentApp/Utils/EventHelpers"],(function(e,t,n,i,o,r,s,a,l){"use strict";const c=t();return function(t={}){if(!t.model)throw new Error("Missing input");const d=t.model,u=d.collection&&d.collection._parentInode,p=u&&u.configuration,m=!p||(p.canMultiselect||void 0===p.canMultiselect),f={model:d,cid:d.cid,withSelectionIcon:m};let g,h,v=new n({model:d,context:"item-view"});const D=a(u),w=d.isAtLeastOneActionIdOk([c.actionPubIds.upload,c.actionPubIds.uploadFolder])||d.collection._parentInode.isAtLeastOneActionIdOk([c.actionPubIds.upload,c.actionPubIds.uploadFolder,c.actionPubIds.addContent]);function b(){var e={id:"id",image:function(e){var t=e.get("thumbnailLink");return t&&(t=t.medium),t},metas:function(e){var t=[],n=e.get("modifiedDate");return n&&t.push(o.getDateStr(n,!0)),t.push(e.getCreator()),t},iconType:"icon"};f.attributes={},D.forEach((function(e){f.attributes[e.classname]=e.value(d)})),Object.keys(e).forEach((function(t){var n;n="function"==typeof e[t]?e[t](d):d.get(e[t]),f[t]=n})),v=new n({model:d,context:"item-view"}),f.actions=v.toJSON()}b(),g=r(f),h=g.destroy;const C=(e,t={contextualActionsMenu:!1})=>{e.preventDefault(),e.stopPropagation(),require(["DS/W3DContentApp/Views/InodePanelView/inodePanelViewFunc"],(function(o){const r=d.collection._parentInode.inodeTable;o.isElemSelected(o.getElemOf(document.querySelector(".inode-table"),d))||s.dispatchEvent("inodePanelView:selectItemAmongItems",[d,{unselectAllItemsBefore:!0}]);const a=o.getSelectedModelsOf(document.querySelector(".inode-table"),r),l=a.length>1?i.getActionsJSON(a):new n({model:d,context:"item-view"}).toJSON();g.container.parentElement.click(),g.refreshActionsDropdownMenu(l,t),g.container.actionsDropdownMenu.show(!0,e)}))};return g.delegateDOMEvents({"click .actions":function(e){g.container.actionsDropdownMenu&&g.container.actionsDropdownMenu.isVisible?g.container.parentElement.click():C(e)}}),g.container.addEvents({contextmenu:function(e){C(e,{contextualActionsMenu:!0})},dragstart:function(e){e.dataTransfer.dropEffect="none"},dragenter:function(e){const t=e.dataTransfer;d&&(l.hasFilesType(t)&&d.isAtLeastOneActionIdOk([c.actionPubIds.upload,c.actionPubIds.uploadFolder])||d.enableDrop(t.types))&&(e.target.classList.contains("drag-over")||e.target.classList.contains("drag-start")||e.target.classList.add("drag-over"))},dragover:function(e){e.preventDefault();const t=e.dataTransfer;d&&l.hasFilesType(t)&&w?t.dropEffect="copy":d&&d.enableDrop(t.types)&&!e.target.classList.contains("drag-start")?t.dropEffect="move":t.dropEffect="none",e.stopPropagation()},dragleave:function(e){e.target.classList.contains("drag-over")&&e.target.classList.remove("drag-over")},drop:function(e){if(e.preventDefault(),d.isFolder()){e.stopPropagation();const t=e.dataTransfer;if(function(e){let t=e.parentElement;for(;t&&!t.classList.contains("inode-table-scroll");)t=t.parentElement;t&&t.classList.toggle("drag-over",!1)}(e.currentTarget),d&&d.enableDrop(t.types)&&!e.target.classList.contains("drag-start")){const e=t.files,n=JSON.parse(t.getData("text")||"{}");if((!e||0===e.length)&&"3DXContent"===n.protocol){const e=[];n.data.items.forEach((t=>e.push(t.objectId))),s.dispatchEvent("inodesActions:onDnDMove",[e,d])}}else if(d&&l.hasFilesType(t)&&w){const e=l.getFiles(t),n=e.length,i=t.items.length;n>0&&s.dispatchEvent("inodeScrollTableView:onDrop",[d.inodeTable,e]),n<i&&s.dispatchEvent("inodeScrollTableView:onFolderDrop",[d,t])}}e.target.classList.contains("drag-over")&&e.target.classList.remove("drag-over")}}),g.listenTo(d,{"onChange:thumbnailLink":function(){e.setImmediate((function(){g.refreshImg()}))},"onChange:actions":function(){var i=new n({model:t.model,context:"item-view"}).toJSON();e.setImmediate((function(){g.refreshActionsDropdownMenu(i)}))},onChange:function(){b(),e.setImmediate((function(){g.refreshContent()}))},"inodeItemView:toggleActionsElemVisibility":function(e){g.toggleActionsElemVisibility(e)}}),g.container.addClassName("inode-item"),g.container.dataset.model_cid=d.cid,g.container.dataset.view_cid=g.cid,Object.assign(g,{destroy:function(){return g.undelegateDOMEvents(),g.container.removeEvents(),g.stopListening(),h.apply(g,arguments)}})}})),define("DS/W3DContentApp/Utils/scheduleTasksToGlobalSession",["DS/W3DContentApp/Utils/createTasksSession"],(function(e){"use strict";return e(6)})),define("DS/W3DContentApp/Collections/AuthCollection",["UWA/Core","UWA/Promise","UWA/Class/Collection","DS/W3DContentApp/Utils/RequestHelper"],(function(e,t,n,i){"use strict";return n.extend({_prepareModel:function(e,t){return(t=Object.assign({},t,{})).auth=this._auth,this._parent(e,t)},setup:function(e,t){t&&(this._auth=t.auth)},sync:function(t,n,o){return(o=e.clone(o||{},!1)).ajax=o.ajax||i.getRequestMethod(o),o.auth=this._auth,this._parent(t,n,o)},createMany:function(e,n){if(!Array.isArray(e))throw new Error("createMany should be used with an array for attributes param");const i=this,o=e.map((function(e){return new t((function(t,o){n=n||{};const r=Object.assign({},n);r.onComplete=function(e,i){t(e),"function"==typeof n.onComplete&&n.onComplete(e,i,n)},r.onFailure=function(e,t){o(e),"function"==typeof n.onFailure&&n.onFailure(e,t,n)},i.create(e,r)}))}));return t.resolve(o)}})})),define("DS/W3DContentApp/Views/UploadInodesView/uploadInodeTaskView",["DS/W3DContentApp/Views/UploadInodesView/taskView"],(function(e){"use strict";return function(t){var n,i=t.model,o={title:i.get("title"),progress:0},r=e(o,i);r.state=o,n={onProgress:function(e){e.lengthComputable&&(o.progress=Math.ceil(100*e.loaded/e.total)/100,r.refreshProgress())}},r.listenTo(i,n);var s={onDestroy:function(){r.stopListening(i,n),r.refreshError(!0)},onError:function(){r.stopListening(i,n),r.refreshError(!0)},onUpdateCompleted:function(){o.progress=100,r.refreshStatus(),r.stopListening(i,n)}};return s["onChange:"+i.idAttribute]=function(){o.progress=100,r.refreshStatus(),r.stopListening(i,n)},r.listenToOnce(i,s),r}})),define("DS/W3DContentApp/Views/DriveView/driveTreeView",["UWA/Class/View","DS/Tree/FileTreeView","DS/W3DContentApp/BusEvent","DS/W3DContentApp/Utils/Alert","DS/W3DContentApp/Utils/EventHelpers","DS/W3DContentApp/Utils/dropdownContextmenu","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o,r,s){"use strict";return function(a={}){let l,c,d;const u=a.conf||{},p=new t({treeDocument:a.treeDocument,selection:{toggle:!1,canMultiSelect:!1},enableExpandOnDoubleClick:!0,height:"inherit",enableDragAndDrop:!0,shouldAcceptDrag:function(){return!1},onContextualEvent:u.contextMenu?{callback:function(e={}){require(["DS/W3DDrive/InodeActions","DS/W3DContentApp/Metas/inode"],(function(t,n){if(e.treeview&&e.treeview.nodeModel){e.treeview.manager.elements.container.click();const i=n(),o=new t({model:e.treeview.nodeModel.inode,context:"treeview-contextmenu"}).toJSON().filter((e=>[i.actionPubIds.createFolder,i.actionPubIds.changeProperties].includes(e.id))).map((e=>({className:e.className||"",text:e.text||"",fonticon:e.icon,handler:e.handler})));d=new r({target:e.infos.target,items:o,contextual:!0}),d.show(!1,e.data.event)}}))}}:null,onDragEnterCell:function(e,t){const n=t.nodeModel;n.inode&&u.expandFolderOnOver&&(clearTimeout(l),c=!0,l=setTimeout((()=>{c=!1,n.isExpanded()||n.expand()}),1500))},onDragLeaveCell:function(){c||clearTimeout(l)},onDragOverCell:function(e,t){const n=t.cellModel.options.value._options.inode,i=e.dataTransfer,r=i.types;return n&&o.hasFilesType(i)&&n.isActionIdoK("upload")?i.dropEffect="copy":n&&n.enableDrop(r)?i.dropEffect="move":i.dropEffect="none",!0},onDropCell:function(e,t){clearTimeout(l);const r=e.dataTransfer,a=r.types,c=t.cellModel.options.value._options.inode;if(c&&o.hasFilesType(r)){const t=o.getFiles(r),i=t.length,s=r.items.length;i>0&&n.dispatchEvent("inodeScrollTableView:onDrop",[c.inodeTable,t]),i<s&&n.dispatchEvent("inodeScrollTableView:onFolderDrop",[c,e.dataTransfer])}else if(c&&c.enableDrop(a)){const e=r.files,t=JSON.parse(r.getData("text")||"{}");if(0===e.length&&"3DXContent"===t.protocol){const e=[];"favorites"===c.get("id")?(t.data.items.map((t=>e.push({inodeId:t.objectId,rootId:t.objectRootId}))),n.dispatchEvent("inodesActions:onAddToFavorites",[e,{isDnD:!0,favoritesRootInode:c}])):(t.data.items.map((t=>e.push(t.objectId))),n.dispatchEvent("inodesActions:onDnDMove",[e,c]))}}else i.add({message:s.get("dropError",{title:c.get("title")}),className:"error"})}}),m=new e({container:p.elements.container}),f=p.getManager().getDocument();return p.onNodeClick((function(e){const t=e.nodeModel.inode;n.dispatchEvent("driveTreeView:onNodeClick",[t])})),p.onPreExpand((function(e){const t=e.data.nodeModel.inode;n.dispatchEvent("driveTreeView:onPreExpand",[t])})),m.container.addClassName("w3ddrive drive-tree"),Object.assign(m,{getXSO:f.getXSO.bind(f),reverseExpand:function(e){if(!e)return[];const t=e.getParent();return!t||e.isRoot()?m:t.isExpanded()?void 0:(t.expand(),m.reverseExpand(t))}})}})),define("DS/W3DContentApp/Collections/Inodes",["DS/W3DContentApp/Collections/AuthCollection","DS/W3DContentApp/Collections/Pagination"],(function(e,t){"use strict";let n=e.extend({_sorting:{logic:{attributeName:"title",asc:!0}},init:function(e,t={}){const n=t.parentInode;if(!n||!n.id)throw new Error("You must specify a valid parentInode options");return this._parentInode=n,this._parent.apply(this,arguments)},sort:function(e={}){return e.sorting&&(this._sorting=e.sorting),this._parent.apply(this,arguments)},_sortById:function(e,t){return e.get("id")>t.get("id")?1:-1},_sortByTitle:function(e,t){const n=e.get("title").toUpperCase(),i=t.get("title").toUpperCase().localeCompare(n);return 0===i?this._sortById(e,t):i},_sortByCreatedDate:function(e,t){const n=e.get("createdDate"),i=t.get("createdDate");return n===i?this._sortByTitle(e,t):n>=i?-1:1},_sortByModifiedDate:function(e,t){const n=e.get("modifiedDate"),i=t.get("modifiedDate");return n===i?this._sortByTitle(e,t):n>=i?-1:1},_sortBySize:function(e,t){const n=e.get("size"),i=t.get("size");return n===i?this._sortByTitle(e,t):n>=i?-1:1},_sortByType:function(e,t){const n=e.get("fileExtension"),i=t.get("fileExtension").localeCompare(n);return 0===i?this._sortByTitle(e,t):i},_sortByCreator:function(e,t){const n=e.get("originator"),i=t.get("originator").localeCompare(n);return 0===i?this._sortByTitle(e,t):i},_sortByAttrName:function(){let e;switch(this._sorting.logic.attributeName){case"title":e=this._sortByTitle;break;case"createdDate":e=this._sortByCreatedDate;break;case"modifiedDate":e=this._sortByModifiedDate;break;case"size":e=this._sortBySize;break;case"type":e=this._sortByType;break;case"creator":e=this._sortByCreator;break;default:return}return e=e.apply(this,arguments),this._sorting.logic.asc?-e:e},getInode:function(e){return this.get(e)?this.get(e):(this.map((t=>{if(t.inodeTable){const n=t.inodeTable.getInode(e);if(n)return n}})),null)},comparator:function(e,t){const n=e.isContainer(),i=t.isContainer();return n&&!i?-1:!n&&i?1:this._sortByAttrName.apply(this,arguments)},filterFiles:function(){return this.filter((e=>e.isContainer()))}});return n=t(n),n})),define("DS/W3DContentApp/Actions/upload-manager/upload-manager",["UWA/Class/Promise","DS/W3DContentApp/Utils/scheduleTasksToGlobalSession","DS/W3DContentApp/Views/UploadInodesView/taskViewSet","DS/W3DContentApp/Views/UploadInodesView/uploadInodeTaskView","DS/W3DContentApp/Utils/Alert","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o,r){"use strict";return{askForFolderCreation:function(n,i,s){const a=function(t,n,i){if(!t||!n)return null;if(["<",">","/","\\",":","?","*",'"',"|"].some((function(e){return n.includes(e)})))return o.add({message:r.replace(r.get("forbiddenChars"),{chars:'< > / \\ : ? * " |'}),className:"error"});{const o=t.inodeTable;return Boolean(o)&&"function"==typeof o.create?(i=Object.assign({},i,{wait:!0}),function(){return new e((function(e,o){const r=i.onComplete,s=i.onFailure;i.onComplete=function(){"function"==typeof r&&r.apply(this,arguments),e()},i.onFailure=function(){"function"==typeof s&&s.apply(this,arguments),o()},t.inodeTable.create({parentId:t.id,title:n,mimeType:"text/directory"},i)}))}):null}}(n,i,s);return t(a)},askForUpload:function(o,r,s){const a=Object.keys(r).filter((function(e){return"object"==typeof r[e]})).map((function(e){return r[e]})).map((function(t){return function(t,o,r){if(!t||!o)return null;const s=t.inodeTable;let a=Boolean(s);if(a=a&&"function"==typeof s.create,a=a&&"function"==typeof s._prepareModel,!a)return null;r=Object.assign({},r,{file:o,wait:!0});const l=s._prepareModel({parentId:t.id,title:o.name||"",mimeType:o.type,description:o.description});return n.add(i({model:l})),function(){return new e((function(e,t){const n=r.onComplete,i=r.onFailure;r.onComplete=function(){"function"==typeof n&&n.apply(this,arguments),e()},r.onFailure=function(){"function"==typeof i&&i.apply(this,arguments),t()},s.create(l,r)}))}}(o,t,s)}));return t(a)},addUploadTask:function(e){n.add(i({model:e}))}}})),define("DS/W3DContentApp/Utils/History",["UWA/Class","UWA/Class/Events","UWA/Class/Listener","UWA/String","DS/W3DDrive/widget","DS/W3DContentApp/Utils/Metrics"],(function(e,t,n,i,o,r){"use strict";let s,a=/^\/+|\/+$/g,l=!1;const c="saved-fragment";let d="";return s=e.extend(t,n,{_getSavedFragment:function(){let e="";const t=o.getValue("driveId"),n=o.getValue("contentId"),i=o.getValue("contentType");if(o.getValue("X3DContentId")){const t=JSON.parse(o.getValue("X3DContentId"));if("X3DDRIV_AP"!==t.source&&t.data&&t.data.items&&t.data.items.length){const n=t.data.items[0],i="DriveFolder"===n.objectType;"3DDrive"===n.serviceId&&(e=`drives/${n.envId}/mimetype/text%2Fdirectory/inode/${n.objectId}`,e=i?`${e}/content`:`${e}/preview`,r.trackNavigation({eventAction:"load",startingRouteType:"open-with"}))}}else if(t&&i&&n){e=`drives/${t}/mimetype/text%2Fdirectory/inode/${n}`,"true"===o.getValue("showInFolderMode")?e=`${e}/content/focus`:"folder"===i?e=`${e}/content`:"file"===i&&(e=`${e}/preview`),r.trackNavigation({eventAction:"load",startingRouteType:"direct-link"})}else o.getValue("enablePinNavigation")?(e=o.getValue("savedPinNavigation"),r.trackNavigation({eventAction:"load",startingRouteType:"pin-navigation"})):(e=o.getValue(c),r.trackNavigation({eventAction:"load",startingRouteType:"default"}));return e?(e&&e.length>0&&-1===e.indexOf("/")&&(e=decodeURIComponent(e)),e):null},_saveFragment:function(e){if(!o.getValue("isStandalone"))return o.setValue(c,e)},_loadUrl:function(e,t){e=this.fragment=this.getFragment(e);var n=this.handlers.some((function(t){if(i.test(e,t.route))return t.callback(e),!0}));return n||(console.log('No handler can be found for route = "'+e+'"'),!0===t)?n:this._loadUrl(d,!0)},init:function(){return this.handlers=[],this},setBaseURI:function(e){0!==e.indexOf("/")&&(e="/"+e),d=e},getFragment:function(e){return void 0===e&&(e=""),e.replace(a,"")},route:function(e,t){this.handlers.unshift({route:e,callback:t})},navigate:function(e,t){return!!l&&(t&&!0!==t||(t={trigger:!!t}),t.hasOwnProperty("loadBaseUri")&&!0===t.loadBaseUri&&(e=d),e=this.getFragment(e||""),this.fragment!==e||!0===t.force?(this.fragment=e,this._saveFragment(e),t.trigger?this._loadUrl(e):void 0):void 0)},start:function(e){if(e=e||{},l)throw new Error("Backbone.history has already been started");this.root=this._getSavedFragment()||e.root||d,this.root=("/"+this.root+"/").replace(a,"/"),l=!0,e.silent||this._loadUrl(this.root)},stop:function(){l=!1}}),s.singleton()})),define("DS/W3DContentApp/Utils/Router",["DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/Utils/History","UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","UWA/Class/Options"],(function(e,t,n,i,o,r,s){"use strict";const a=["routes"],l=/\((.*?)\)/g,c=/(\(\?)?:\w+/g,d=/\*\w+/g,u=/[\-{}\[\]+?.,\\\^$|#\s]/g;return i.extend(s,o,r,{init:function(e){let t;e=n.clone(e||{},!1);for(let n=a.length-1;n>=0;n--)t=a[n],e.hasOwnProperty(t)&&(this[t]=e[t],delete e[t]);this._bindRoutes(),this.setup.apply(this,arguments)},setup:function(){},_routeToRegExp:function(e){return e=e.replace(u,"\\$&").replace(l,"(?:$1)?").replace(c,(function(e,t){return t?e:"([^/?]+)"})).replace(d,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n;return(n=e.exec(t).slice(1)).map((function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null}))},_bindRoutes:function(){var t,n;if(this.routes)for(this.routes=e.result(this,"routes"),n=Object.keys(this.routes);null!=(t=n.pop());)this.route(t,this.routes[t])},execute:function(e,t){e&&e.apply(this,t)},getLastFragment:function(){return t.fragment},navigate:function(e,n){return t.navigate(e,n),this},setBaseURI:function(e){return t.setBaseURI(e)},route:function(e,i,o){var r,s;return r=this,n.is(e,"regexp")||(s=this._routeToRegExp(e)),n.is(i,"function")&&(o=i,i=""),o||(o=this[i]),t.route(s,(function(n){var a,l={};a=r._extractParameters(s,n).map((function(t){if(t){var n=c.exec(e);n&&(l[n[0]]=t)}})),c.lastIndex=0,r.execute(o,l,i),r.dispatchEvent.apply(r,["onRoute:"+i].concat(a)),r.dispatchEvent("onRoute",i,a),t.dispatchEvent("onRoute",r,i,a)})),this}})})),define("DS/W3DContentApp/Views/panelSlider",["UWA/Core","UWA/Class/View","UWA/String","DS/UIKIT/Tooltip","DS/W3DContentApp/BusEvent","DS/W3DDrive/widget","i18n!DS/W3DDrive/assets/nls/W3DDrive","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o,r,s){"use strict";let a=!1,l=0;function c(e){document.body.classList.contains("collapsed")&&!e?document.body.classList.remove("collapsed"):!1!==e&&document.body.classList.add("collapsed")}return function(d={}){const u=(d.panels||[]).slice();let p=d.activePanel;const m=(e,t)=>{if(a){const n=e.touches?e.touches[0].clientX:e.x,i=t.container.querySelector(".left-panel-resizer"),o=t.container.querySelector(".panel.left .drives-panel"),r=t.container.querySelector(".panel.right"),s=t.container.offsetWidth;i&&o&&n>280&&(n<s/2||l>s/2)&&(i.style.left=`calc(${n}px - 0.5em)`,o.style.maxWidth=n+"px",r.style.marginLeft=n+"px",r.style.maxWidth="calc(100% - "+n+"px)",l=n)}},f=new t({className:"w3ddrive panel-slider",domEvents:{"click .panel.left":function(e){e.target.classList.contains("left","panel")&&r.dispatchEvent("onToggleDrivePanelSideBarCollapsed")},mouseup:function(){a=!1},touchend:function(){a=!1},mousemove:function(e){m(e,this)},touchmove:function(e){m(e,this)}}}),g=f.render,h=f.destroy;let v;const D=[];let w;function b(e){const t=D[e];t&&p!==e&&(p=e,D.forEach((e=>{e.removeClassName("active")})),t.addClassName("active"))}function C(e,t){const n=D[e];if(n)return t?(u.splice(e,1,t),n.setContent(t)):(u.splice(e,1),n.empty()),v&&e?(v.inject(n,"top"),f):f}function S(){document.documentElement.clientWidth<560&&!document.body.classList.contains("collapsed")&&r.dispatchEvent("onToggleDrivePanelSideBarCollapsed")}return Object.assign(f,{refreshPanel:C,slideTo:b,render:function(t={}){w||(f.listenTo(r,{onDrivePanelSideBarCollapsedToggled:function(e){c(e)}}),f.listenTo(o,{"driveView:onNodeClick":S,"driveTreeView:onNodeClick":S})),f.container.empty(),c(r.getBool("isDrivePanelSideBarCollapsed")),t.viewSpecs.hideController||(v=function(){const t=e.createElement("div",{class:"controller",events:{click:function(e){r.dispatchEvent("onToggleDrivePanelSideBarCollapsed"),e.stopPropagation()}},html:[{tag:"span",class:"fonticon fonticon-menu"}]});return new i({target:t,body:s.get("menu")}),t}());const l=e=>(a=!0,(e=e||window.event).stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1,!1);return e.createElement("div",{class:"left-panel-resizer",events:{mousedown:function(e){l(e)},touchstart:function(e){l(e)}},html:[{tag:"span",class:"fonticon fonticon-arrow-combo-horizontal resizer"}]}).inject(f.container),[0,1].forEach((t=>{var i;D[t]=(i=t,e.createElement("div",{class:n.format("panel {0}",i?"right":"left")})),C(t,u[t]),f.container.addContent(D[t])})),b(p||0),w=!0,g.apply(f,arguments)},destroy:function(){return u.forEach((function(e){e.destroy()})),f.stopListening(),h.apply(f,arguments)}})}})),define("DS/W3DContentApp/Models/AuthModel",["UWA/Core","UWA/Class/Model","DS/W3DContentApp/Utils/RequestHelper"],(function(e,t,n){"use strict";return t.extend({init:function(e,t){let n;return t&&(this._auth=t.auth),n=this._parent.apply(this,arguments),n},sync:function(t,i,o){if(!0!==(o=e.clone(o||{},!1)).noSync)return o.ajax=o.ajax||n.getRequestMethod(o),o.auth=this._auth,this._parent(t,i,o)}})})),define("DS/W3DContentApp/Utils/UIElementsFactory",["DS/W3DContentApp/Views/SuperModal","UWA/Core","DS/UIKIT/Form","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i){"use strict";function o(){return e.modals.current.getFooter().getElement(".btn-primary")}function r(e){if((e=e.elements?e.elements.input:e)&&e.closest(".form-group")){const t=e.closest(".form-group");t.classList.toggle("has-error",!1),t.classList.toggle("has-warning",!1)}}return{getModalSubmitButton:o,enableModalSubmitButton:function(){o().disabled=!1},disableModalSubmitButton:function(){o().disabled=!0},unvalidateInput:function(e,{customMessage:t,type:n="error"}={}){r(e=e.elements?e.elements.input:e),t&&(e.nextSibling.textContent=t);let i="has-error";switch(n){case"error":i="has-error";break;case"warning":i="has-warning";break;default:return}if(e&&e.closest(".form-group")){e.closest(".form-group").classList.toggle(i,!0)}},resetInput:r,createInputWithExtension:function(e,n={}){return t.createElement("div",{class:"form-control form__input-extension",html:[Object.assign({tag:"input",maxlength:255,autocomplete:"off",spellcheck:!1},n),{tag:"span",text:e}]})},createTextAreaWithCharsCounter:function({name:e="message",label:t="",placeholder:o="",maxlength:r=255,disabled:s=!1}={}){const a=new n({fields:[{type:"textarea",name:e,label:t,placeholder:o,required:!1,spellcheck:!1,maxlength:r,rows:4,disabled:s,helperText:i.get("charactersCounter",{count:0,max:r})}]});return a.getContent().addEventListener("keyup",(()=>{const t=a.getInput(e).getValue().length||0,n=a.getField(e).nextSibling;a.getField(e).nextSibling&&a.getField(e).nextSibling.classList.contains("form-control-helper-text")&&(n.textContent=i.get("charactersCounter",{count:t,max:r}))})),a}}})),define("DS/W3DContentApp/Components/OfficeDocumentEditor",["UWA/Core","UWA/String","DS/WAFData/WAFData","DS/UIKIT/Mask","DS/OfficeDocumentEditorClient/Editor","DS/W3DContentApp/BusEvent","DS/W3DContentApp/Utils/Alert","DS/W3DContentApp/Views/SuperModal","DS/W3DContentApp/Actions/upload-manager/upload-manager","DS/W3DContentApp/Utils/RequestHelper","DS/W3DContentApp/Utils/formFactory","DS/W3DContentApp/Utils/UIElementsFactory","DS/W3DDrive/widget","DS/W3DContentApp/Utils/Metrics","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o,r,s,a,l,c,d,u,p,m,f){"use strict";const g={};let h,v,D,w={inode:null,title:null,extension:null,fileUrl:null};const b={docx:f.get("Document"),pptx:f.get("Presentation"),xlsx:f.get("Spreadsheet")},C="DOCUMENT_CREATION_FAILURE",S=e=>{w.inode&&(w.inode.editMode=e)},y=()=>Boolean(w.inode&&w.inode.editMode);return g.init=function(t){function i(e){return e?(S(!1),e.getFileUrl().then((t=>{g.launch({inode:e,fileUrl:n.proxifyUrl(t.url),title:e.get("title"),extension:e.get("fileExtension")})})),h):Promise.resolve()}return t=t||{},h?(i(t.inode),h):(v=e.createElement("div",{class:"ode-container"}),h=Object.assign(v,{refresh:i}),i(t.inode),h)},g.destroy=function(){D&&(D.informActiveState(!1),D.dispose(),D=null),o.close(),S(!1)},g.launch=function(e={}){if(!(e.inode&&e.title&&e.extension&&e.fileUrl))throw new Error("Missing input");w.inode=e.inode,w.title=e.title,w.extension=e.extension,w.fileUrl=e.fileUrl,m.trackAction({model:w.inode,eventAction:y()?"ode-edit":"ode-preview"});const t=w.inode.get3DPlayOptions();o.init({title:w.title,ext:w.extension,url:w.fileUrl,readOnly:!y(),docKeyToUse:"3ddrive_"+w.inode.get("id"),useIframe:!0,rootElem:v,platformId:w.inode.drive?w.inode.drive.id:"",playerConfig:{input:t,options:{callback:{onAnnotationShared:e=>{r.dispatchEvent("lightbox:onAnnotationShared",[e])}}}},on3DPlayerReady:function(e){D=e;const t=w.inode;if(!y()&&t.get("annotation")){let n,i=!1;const o=t.get("annotation");t.unset("annotation");const r=()=>{e.isReady()?(i=!0,e.loadAnnotations({annotation:o.data.annotationFile},{clean:!0})):n=setTimeout(r,100)};setTimeout((()=>{clearTimeout(n),i||s.add({message:f.get("annotationLoadError"),className:"error"})}),25e3),r()}}}).then((()=>{}),(e=>{switch(e){case o.ERROR.NO_DOCUMENT_URL_PROVIDED:s.add({message:f.get("noDocumentUrlProvided"),className:"error"});break;case o.ERROR.SERVICE_NOT_FOUND:s.add({message:f.get("serviceNotFound"),className:"error"});break;default:s.add({message:f.get("unknownError"),className:"error"})}}))},g.launchInEditMode=function(){return S(!0),g.launch(w)},g.createDocument=function(e,t){const i=b[t],r="."+t,c=i+"."+t,p=255-t.length,g=f.get("forbiddenChars",{chars:'< > / \\ : ? * " |'}),h=u.createInputWithExtension(r,{placeholder:f.get("enterTitle"),required:!0,maxlength:p,pattern:'^((?!<)(?!>)(?!/)(?!\\\\)(?!:)(?!\\?)(?!\\*)(?!")(?!\\|).)*$',title:g,name:"title"}),v=h.getElement("input");v.addEventListener("keyup",(function(e){"Escape"!==e.key&&S()}));const D=d.createTextArea({maxlength:255,required:!1,placeholder:f.get("enterDescription"),name:"description"});D.elements.input.addEventListener("keyup",(function(e){"Escape"!==e.key&&(u.resetInput(D),this.value.length>=255&&u.unvalidateInput(D,{customMessage:f.get("charsLimitReached"),type:"warning"}))}));const w=d.createForm([{tag:"div",class:"form-group",html:[{tag:"label",html:[f.get("title"),{tag:"span",class:"label-field-required",text:" *"}]},h,{tag:"span",class:"form-control-error-text"}]},{tag:"div",class:"form-group",html:[{tag:"label",text:f.get("Description")},D,{tag:"span",class:"form-control-error-text"}]}]);function S(){u.resetInput(h),v.value.length>=p&&u.unvalidateInput(h,{customMessage:f.get("charsLimitReached"),type:"warning"}),v.checkValidity()?u.enableModalSubmitButton():(u.unvalidateInput(h,{customMessage:g,type:"error"}),u.disableModalSubmitButton())}w.addEventListener("submit",(function(i){i.preventDefault();const c=(v.value||"").trim(),d=(D.getContent().value||"").trim();c&&v.checkValidity()&&e.inodeTable.autoname(c+r).then((i=>{if(i&&i.iteration)window.setTimeout((function(){u.unvalidateInput(v,{customMessage:f.get("titleNotUnique"),type:"error"}),u.disableModalSubmitButton()}),100);else{!function(e,t,i,r){const a=e=>{e===C&&s.add({className:"error",message:f.get("documentCreationFailed")})};o.getDocumentTemplatesURL({platformId:e.drive?e.drive.id:""}).then((o=>{n.authenticatedRequest(o[i],{method:"GET",responseType:"blob",onComplete:n=>{const o=new File([n],t.concat(".",i));o.description=r,l.askForUpload(e,[o],{onComplete:e=>{m.trackAction({model:e,eventAction:"ode-create"}),require(["DS/W3DContentApp/w3DDriveView"],(function(t){e.editMode=!0,t.showLightbox({inode:e})}))},onFailure:(e,t)=>{if(t){let n=f.get("uploadError",{name:e.get("title")||""});t&&t.error&&"quotaExceed"===t.error.errorCode?n+=": "+f.get("allocatedDiskSpaceExceeded"):"Access denied"===t.message&&(n+=": "+f.get("accessDenied")),s.add({message:n,className:"error"})}e&&e.destroy&&e.destroy()}})},onFailure:()=>{a(C)}})}),(()=>{a(C)}))}(e,c,t,d);const i=a.modals.current;i&&i.hide()}}))})),a.dialog({title:f.get("NewDocumentType",{documentType:i.toLowerCase()}),body:w,buttons:[{className:"primary",value:f.get("create"),action:function(){w.dispatchEvent(new Event("submit",{cancelable:!0}))}},{value:f.get("cancel"),action:function(e){e.hide()}}]}),e.drive&&e.drive.isDsDrive&&e.inodeTable.autoname(c).then((e=>{v.value=e.iteration?f.get("documentAutoname",{title:i,iteration:e.iteration}):i,v.focus(),v.setSelectionRange(0,v.value.length),S()}))},g.saveDocument=function(){m.trackAction({model:w.inode,eventAction:"ode-save"}),document.dispatchEvent(new Event("disableSaveButton")),i.mask(v,f.get("saving"));const r=w.inode;(function(e){return new Promise(((i,o)=>{const r=t.format("{0}/ticket?id={1}",c.getBaseUrl(e._auth.platform.url),window.Date.now());n.authenticatedRequest(r,{method:"GET",type:"json",onComplete:(e,t)=>{e.csrf=t["x-ds-csrftoken"],i(e)},onFailure:o})}))})(r).then((a=>{o.save({callbackUrl:a.actionurl,params:{"file-name":w.title,"file-title":w.title,"file-description":w.title,[a.jobticket]:a.ticket},headers:{},filenameForUpload:"file_0"}).then((o=>{if(o&&o.success)if(o.endpoint_body){(function(e,i){const o=w.inode,r=t.format("{0}/{1}",c.getBaseUrl(o._auth.platform.url),o.get("id"));return new Promise(((t,o)=>{n.authenticatedRequest(r,{method:"PUT",type:"json",headers:e,data:JSON.stringify(i),onComplete:e=>{t(e)},onFailure:o})}))})({"X-DS-CSRFTOKEN":a.csrf,Accept:"application/json","Content-Type":"application/json"},{receipt:function(t){const n=e.createElement("div").setHTML(t);return n.getElement('[name="__fcs__jobReceipt"]').value}(o.endpoint_body),lastmodifier:p.getValue("3ddrive_uuid")||"",title:w.title}).then((e=>{e&&(r.set(r.parse(e)),s.add({message:f.get("saveDocumentSuccess"),className:"success"}))}),(()=>{s.add({message:f.get("saveDocumentError"),className:"error"})}))}else o.success;else s.add({message:f.get("saveDocumentError"),className:"error"});document.dispatchEvent(new Event("enableSaveButton")),i.unmask(v)}),(()=>{document.dispatchEvent(new Event("enableSaveButton")),i.unmask(v),s.add({message:f.get("saveDocumentError"),className:"error"})}))}))},g.closeDocument=function(){return new Promise((e=>{const t=()=>{S(!1),w={},e(!0)};if(y()){const e=()=>a.confirm({title:f.get("closeDocumentTitle"),message:f.get("closeDocumentConfirmation"),callback:function(e){e&&t()}});o.state().then((n=>{n&&n.is_modified?e():t()}),(()=>{e()}))}else t()}))},g})),define("DS/W3DContentApp/Models/Inode",["UWA/Utils","DS/W3DDrive/widget","DS/W3DContentApp/Metas/inode","DS/W3DContentApp/Models/AuthModel","DS/W3DContentApp/Utils/Helpers","UWA/Class/Promise","DS/W3DContentApp/Utils/Alert","i18n!DS/W3DDrive/assets/nls/W3DDrive"],(function(e,t,n,i,o,r,s,a){"use strict";var l=n();return i.extend({defaults:{id:void 0,name:void 0,parentId:void 0,title:"",mimeType:"",downloadUrl:"",fileExtension:"",size:"",description:"",createdDate:"",modifiedDate:"",modifiedByMeDate:"",sharedWithMeDate:"",iconLink:"",thumbnailLink:{small:l.thumbnails.content,medium:l.thumbnails.content,large:l.thumbnails.content},owners:[],lastModifyingUser:{},shared:!1},isContainer:function(){return this.isFolder()||this.isCollabSpace()},isCollabSpace:function(){return!1},isFolder:function(){return"text/directory"===this.get("mimeType")},isFavorite:function(){return this.get("favorite")},isShared:function(){return!1},isPlayable:function(){var e=(this.get("fileExtension")||"").toLowerCase();return e&&("jpg"===e||"jpeg"===e)},getURI:function(){return e.parseUrl(o.result(this,"url")).path},getOwnerNames:function(){return""},getCreator:function(){return this.getOwnerNames()},getLastModifyingUserName:function(){var e;if(e=this.get("lastModifyingUser"))return e.displayName||""},getFileUrl:function(){var e=this.get("fileUrl");return new r((function(t,n){t(e)}))},getDownloadUrl:function(){var e=this.get("downloadUrl");return new r((function(t,n){t({url:e,method:"GET"})}))},getNLSType:function(){if(this.isFolder())return a.get("folder");{const e=this.get("fileExtension");return e?o.computeFileExtension(e):""}},get3DPlayOptions:function(e){e=e||{};var t={},n={};return n=Object.assign(n,e),this.get("play360")&&(this.set("play360",!1),t.provider="FILE",t.filename="DS/3DPlay360Experiences/3DPlay360Experience",n.experience=Object.assign(t,e.experience)),n},getThumbnailLink:function(){var e=this.get("thumbnailLink");return new r((function(t,n){t(e)}))},getDefaultThumbnail:function(){if(this.isFolder())return l.thumbnails.folder;var e=this.get("fileExtension");return e&&l.thumbnails[e.toLowerCase()]||l.thumbnails.content},getActionIds:function(){return[]},getDirectLink:function(){return null},isActionIdoK:function(e){return-1!==this.getActionIds().indexOf(e)},enableDrop:function(e){if(this.isFolder()&&e&&e.includes(this.getDropDataType())){var t=[].concat(this),n=function(e){var t={};return e&&e.length?(t[l.ids.sharedWithMe]=!0,t[l.ids.trueRoot]=!0,t):[]}(t),i=t.reduce((function(e,t){return e&&function(e,t){var n=e.get("id");return!t[n]&&"TRASH"!=n}(t,n)}),!0);return!!i}return!1},getDragDataType:function(){return!0===this.isActionIdoK("moveTo")||this.isActionIdoK("addToFavorites")?(t.getValue("appId")+"_"+t.id+"_"+this.drive.id).toLowerCase():null},getDropDataType:function(){return!0===this.isActionIdoK("upload")?(t.getValue("appId")+"_"+t.id+"_"+this.drive.id).toLowerCase():null},isAtLeastOneActionIdOk:function(e){if(!Array.isArray(e))throw new Error("The parameter is not an Array.");var t=this.getActionIds();return e.some((function(e){return-1!==t.indexOf(e)}))},doesExistInBackend:function(){var e=this;return new r((function(n){!0!==t.getValue("isStandalone")?e.sync("GET",e,{onComplete:function(t){e.drive.set("blockactions",t.blockactions),t.title?n(!0):(n(!1),e.destroy({noSync:!0}))},onFailure:function(t){t.error&&t.error.code&&s.add({message:a.replace(a.tenantAccessError,{errorMsg:t.error.message}),className:"warning"}),n(!1),e.destroy({noSync:!0})}}):n(!0)}))}})})),define("DS/W3DContentApp/Utils/Tagger6WProxy",["UWA/Core","UWA/Class/Model","UWA/Date","DS/TagNavigatorProxy/TagNavigatorProxy","DS/W3DContentApp/Collections/Inodes","DS/W3DContentApp/Models/Inode","UWA/Class/View","DS/W3DContentApp/Utils/Helpers","DS/W3DDrive/widget","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o,r,s,a,l,c){"use strict";let d,u=new t;return u=e.extend(u,{_currentTagger:void 0,_currentDriveId:void 0,isSet:function(e){return e.id===this._currentDriveId},setTaggerProxy:function(t){var n;t.isCollabSpace?(this._inodeTableView&&this._inodeTableView.collection&&(this._inodeTableView.collection.filterTagObj=null,this._inodeTableView.collection.isNewFilter=!0),this.isSet(t)?this._currentTagger&&this._currentTagger.clearLocalFilter():(this._currentTagger&&(this._currentTagger.die(),delete this._currentTagger),n={filteringMode:"FilteringOnServer",events:{},widgetId:l.id,tenant:t.id},this._currentTagger=i.createProxy(n),this.listenTo(this._currentTagger,{onFilterChange:this.onFilterChange}),this._currentDriveId=t.id)):this.isSet(t)||(this._currentTagger&&(this._currentTagger.die(),delete this._currentTagger),t.isDsDrive&&l.id&&(n={filteringMode:"WithFilteringServices",widgetId:l.id,pod:"6WTags"},t.isDsDrive&&(n=e.merge({tenant:t.id},n)),this._currentTagger=i.createProxy(n),this.listenTo(this._currentTagger,{onFilterSubjectsChange:this._onFilterSubjectsChange})),this._currentDriveId=t.id)},_parseToTags:function(e){let t={};return e instanceof r&&(e=[e]),Array.isArray(e)||e instanceof o?e.forEach((e=>{t[this._parseInodeToSubjectURI(e)]=this._parseInodeToTags(e)})):t=e,t},_parseToSubjectURIs:function(e){return e instanceof r?[this._parseInodeToSubjectURI(e)]:e.map((function(e){return e instanceof r&&(e=this._parseInodeToSubjectURI(e)),e instanceof s&&(e=this._parseInodeToSubjectURI(e.model)),e}),this)},_parseInodeToTags:function(e){var t,i,o,r,s,l,d,u;return t=[],i=e.getOwnerNames(),o=e.getCreator(),e.isFolder()?l=c.get("folder"):(l=c.get("file"),u=a.computeFileExtension(e.get("fileExtension"))),e.drive&&(d=e.drive.get("title")),r=this._parseDate(e.get("modifiedDate")),s=""!==e.get("createdDate")?this._parseDate(e.get("createdDate")):this._parseDate(e.get("modifiedDate")),i&&t.push({object:i,sixw:"ds6w:who/ds6w:responsible",dispValue:i}),o&&t.push({object:o,sixw:"ds6w:who/ds6w:responsible/ds6w:originator",dispValue:o}),r&&t.push({object:n.strftime(r,"%Y/%m/%d"),sixw:"ds6w:when/ds6w:modified",type:"date"}),s&&t.push({object:n.strftime(s,"%Y/%m/%d"),sixw:"ds6w:when/ds6w:created",type:"date"}),l&&t.push({object:l,sixw:"ds6w:what/ds6w:type",dispValue:l}),u&&t.push({object:u,sixw:"ds6w:what/ds6w:docExtension",dispValue:u}),d&&t.push({object:d,sixw:"ds6w:where/ds6w:source/ds6w:dataSource",dispValue:d}),t},_parseDate:function(e){return"number"==typeof e?new Date(parseInt(e,10)):new Date(e)},_parseInodeToSubjectURI:function(e){if(e)return(l.getValue("is3DSpaceWidget")?"pid://":"driveid:")+e.get("id")},_onAdd:function(e){this.addSubjectsTags(e)},_onRemove:function(e,t){this.setSubjectsTags(t)},_onReset:function(e){this.setSubjectsTags(e)},onFilterChange:function(e){this._inodeTableView.collection.filterTagObj=e,this._inodeTableView.collection.isNewFilter=!0,this._currentTagger.setTags({},[]);var t,n={reset:!0,type:"json",evnt:"onFilterChange"};t=n.onComplete,n.onComplete=function(){t&&t(arguments)},this._inodeTableView.collection.getFirstPage(n)},_onFilterSubjectsChange:function(e){var t;t=e.filteredSubjectList,d=t.length===this._inodeTableView.collection.length||0===Object.keys(e.allfilters).length?void 0:t,this.dispatchEvent("onFilterSubjectsChange",e)},getFilteredSubjectList:function(){return d},setInodeTable:function(e){e&&e!==this.inodeTableView&&(this.unSetInodeTable(),this._inodeTableView=e,"true"===l.getValue("is3DSpaceWidget")?(this.listenTo(e.collection,{onFilterChange:this.onFilterChange,onAdd:this._onAdd,onRemove:this._onRemove,onReset:this._onReset}),this.setSubjectsTags(e.collection)):(this.listenTo(e.collection,{onAdd:this._onAdd,onRemove:this._onRemove,onReset:this._onReset}),this.setSubjectsTags(e.collection)))},updateSubjectsTags:function(){d=void 0,this._currentTagger&&(this._currentTagger.unsetTags(),this.addSubjectsTags(this._inodeTableView.visibleItems))},unSetInodeTable:function(){this._inodeTableView&&this.stopListening(this._inodeTableView.collection),delete this._inodeTableView,d=void 0,this._currentTagger&&this._currentTagger.unsetTags()},addSubjectsTags:function(e){if(this._currentTagger)return"true"===l.getValue("is3DSpaceWidget")?this._currentTagger.addSubjects(e):this._currentTagger.addSubjectsTags(this._parseToTags(e))},setSubjectsTags:function(e){if(this._currentTagger)return"true"===l.getValue("is3DSpaceWidget")?this._currentTagger.addSubjects(e):this._currentTagger.setSubjectsTags(this._parseToTags(e))},focusOnSubjectsWithInode:function(e){if(this._currentTagger)return this._currentTagger.focusOnSubjects(this._parseToSubjectURIs(e))},unfocus:function(){this._currentTagger&&this._currentTagger.unfocus(arguments)},deactivate:function(){this._currentTagger&&this._currentTagger.deactivate()},activate:function(){this._currentTagger&&this._currentTagger.activate()}}),u})),define("DS/W3DContentApp/Actions/Accesses/Base",["DS/W3DContentApp/Views/SuperModal","DS/W3DContentApp/BusEvent","i18n!DS/W3DDrive/assets/nls/W3DDrive"],(function(e,t,n){"use strict";return function(i){var o={actions:[],init:function(e){e=e||{},this.model=e.model},toJSON:function(){var e=this.model,t=this.actions.filter((function(t){return e.isActionAllowed(t.id)}),this);return t.length?t:[]},openDialog:function(t){var i=document.createElement("div"),o=t.title,r=t.body,s=t.confirmAction;return r.reduce((function(e,t){return e.appendChild(t),e}),i),e.dialog({title:o,body:i,buttons:[{className:"primary",value:s.title,action:function(e){e.hide(),s.handler()}},{value:n.cancel,action:function(e){e.hide()}}]})},dispatchAccessActions:function(e,n){t.dispatchEvent("access:"+e,n)}};return o.init(i),o}})),define("DS/W3DContentApp/Views/InodePanelView/inodesViewFunc",["DS/WebAppsFoundations/Views/CollectionView","DS/W3DContentApp/SearchProxy","DS/W3DContentApp/Utils/Tagger6WProxy"],(function(e,t,n){"use strict";function i(e){return Array.isArray(e)?e:[e]}function o(e=""){return"string"==typeof e?e.toUpperCase():e}function r(e,t,n){var o;return e=i(e),o="function"==typeof t?function(e){return t(e,n)}:function(e){return e===t},e.some(o)}function s(e,t){return r(e,(function(e,n){return e==="driveid:"+t.get("id")}),t)}function a(e,t){return i(t).filter((function(e){return"function"==typeof e})).reduce((function(t,n){return t&&n(e)}),!0)}return{getView:function(t){var n=new e(Object.assign({},t));return n.container.addClassName("w3ddrive inodes"),n},filtererWith3DDProxys:function(e){return a(e,[function(e){var t=n.getFilteredSubjectList();return!t||s(t,e)},function(e){return void 0===t.getQuery()||function(e,t){return r(e,(function(e,t){const n=o(t.get("alias")).includes(o(e)),i=o(t.get("title")).includes(o(e));return n||i}),t)}(t.getQuery(),e)}])},filtererWithTagProxy:function(e){return a(e,[function(e){var t=n.getFilteredSubjectList();return!t||s(t,e)},function(e){return!0}])}}})),define("DS/W3DContentApp/Views/InodePanelView/inodeTableViewFunc",["UWA/Core","DS/W3DDrive/widget","DS/W3DContentApp/BusEvent","DS/W3DContentApp/Views/InodePanelView/inodesViewFunc","DS/W3DContentApp/Views/InodePanelView/inodeItemView","DS/W3DContentApp/Utils/inodeItemViewAttributes","DS/W3DContentApp/Utils/Helpers","DS/W3DXComponents/Views/EmptyView","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o,r,s,a,l){"use strict";const c="thumbnailsLayout",d="tilesLayout";let u;function p(e,t){return new a({icon:e||"picture",title:t||l.noContent})}function m(e,t){if(!e)throw new Error("Missing input");const n=e.classList.contains("thumbnails"),i=e.classList.contains("tiles"),o=e.classList.contains("list");return t===c?(n||e.classList.add("thumbnails"),e.classList.remove("tiles"),e.classList.remove("list")):t===d?(i||e.classList.add("tiles"),e.classList.remove("thumbnails"),e.classList.remove("list")):(o||e.classList.add("list"),e.classList.remove("thumbnails"),e.classList.remove("tiles")),e}return{getEmptyView:p,wrapWithLayout:m,getView:function(a){var l,c=Object.assign({emptyView:p(),ItemView:function(e){return o(Object.assign(e,{}))},filterer:"none"===a.filterType?i.filtererWithTagProxy:i.filtererWith3DDProxys},a);const d=a.collection&&a.collection._parentInode,f=d&&d.configuration,g=f&&f.defaultLayout;u=g||t.getValue("inodeTableLayoutKey");var h=i.getView(c);const v=r(a.collection._parentInode);var D=h.destroy;return h.destroy=function(){l&&window.cancelAnimationFrame(l),l=null,c&&c.emptyView&&(c.emptyView.destroy(),c.emptyView=null),D.apply(h,arguments),h.container=null,h.stopListening(),h.model=null,c=null},h.onRender=function(){if(c.collection&&c.collection.length){const i=[],o=c.collection._parentInode,r=o&&o.configuration;(!r||(r.canMultiselect||void 0===r.canMultiselect))&&i.push({tag:"div",class:"item__selection_icon fonticon fonticon-check"});const a=s.getSortConfiguration()[c.sorting]||{},l=t.getValue("inodesSorting")?t.getValue("inodesSorting").logic:a,d="fonticon-expand-up",u="fonticon-expand-down";v.forEach((e=>{let t=e.classname;e.sortable&&(t=t.concat(" ","sortable"),e.key===l.attributeName&&(t=t.concat(" ","active"))),i.push({tag:"div",class:t,category:e.key,html:e.sortable?[{tag:"span",text:e.nls},{tag:"span",class:"fonticon-clickable fonticon "+(l&&l.asc?d:u)}]:{tag:"span",text:e.nls},events:{click:function(){const e=this.getElement("span.fonticon"),t=this.getAttribute("category");let i="";if(e){const o=e.classList;o.contains(u)?(o.replace(u,d),i=i.concat(t,"-a")):o.contains(d)&&(o.replace(d,u),i=i.concat(t,"-d"));const r="active";Array.from(this.parentElement.getElementsByClassName(r)).forEach((e=>{e.removeClassName(r)})),this.addClassName(r),n.dispatchEvent("inodePanelView:onSort",[{id:i,logic:s.getSortConfiguration()[i]}])}}}})})),h.container.prepend(e.createElement("div",{class:"list__header",html:i}))}},h.container.addClassName("w3ddrive inode-table w3dx link reveal"),m(h.container,u),l=window.requestAnimationFrame((function e(){if(h&&h.container){var t=h.container,n=t.getBoundingClientRect().width,i=t.classList.contains("content-view--small"),o=t.classList.contains("content-view--medium"),r=t.classList.contains("content-view--large");n<380?(i||t.classList.add("content-view--small"),t.classList.remove("content-view--medium"),t.classList.remove("content-view--large")):n<580?(o||t.classList.add("content-view--medium"),t.classList.remove("content-view--small"),t.classList.remove("content-view--large")):n<850?(r||t.classList.add("content-view--large"),t.classList.remove("content-view--small"),t.classList.remove("content-view--medium")):(t.classList.remove("content-view--small"),t.classList.remove("content-view--medium"),t.classList.remove("content-view--large")),l=window.requestAnimationFrame(e)}})),h},thumbnailsLayoutKey:c,tilesLayoutKey:d,listLayoutKey:"listLayout"}})),define("DS/W3DContentApp/Views/InodeDetailView/inodeDetailNewSocialView",["DS/W3DXComponents/Views/Layout/ScrollView","DS/W3DContentApp/BusEvent","DS/SocialToolbarVue/SocialToolbarVueUWAView","DS/W3DDrive/widget","DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/Utils/RequestHelper","DS/W3DContentApp/Utils/Metrics","UWA/Class/View","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o,r,s,a){"use strict";return function(l={}){let c,d=l.model;const u=l.focusComment||!1;let p,m=!1;i.getValue("isStandalone")?(c=r._baseUrl?`${r._baseUrl}/resources/guest`:"",p=r.getTenant()?r.getTenant():""):(c=`${i.getValue("is3DSpaceWidget")?d._auth.platform.url3DSpace:d._auth.platform.url}/resources`,p=d.drive.get("auth").platformId);let f={props:{disableFeatures:{disableShare:!0,disableLike:!1,disableDisplayMedia:!1,disableAddMedia:!1},subjectUri:(i.getValue("is3DSpaceWidget")?"pid:":"driveid:")+d.id,platformId:p,urls:{service:c,serviceCSRF:{name:"X-DS-CSRFTOKEN"}},atInit:{nbCommentsToLoad:10}}};if(i.getValue("isStandalone")&&(f.props.disableFeatures.disableDisplayMedia=!0,f.props.disableFeatures.disableAddMedia=!0,f.props.disableFeatures.disableRichUserTooltip=!0,f.props.urls.customHeaders={"X-DS-SHARETOKEN":i.getValue("token")}),u){const e=new RegExp(/(driveid:)(.*)(:comment:)(.*)/);let t=decodeURIComponent(o.getQueryHashParameter("content","commentURI"));t=t&&e.test(t)?t:"";let n=decodeURIComponent(o.getQueryHashParameter("content","replyURI"));n=n&&e.test(n)?n:"";t.match(e)&&t.match(e)[2]===d.id&&(f.props.commentToScrollTo=n?{replyUri:n,commentUri:t}:{commentUri:t})}let g=(new n).render(f);g.listenTo(g,{onClickOnMedia(e){e&&e.annotation&&e.annotation.screenshot&&e.annotation.annotation&&!m&&(e.file=e.annotation.screenshot,e.data={annotationFile:e.annotation.annotation},m=!0,setTimeout((()=>{m=!1}),800),t.dispatchEvent("socialToolbar:onPreviewAnnotation",[d,e]))}}),g.addEvent("onCommentCreated",(()=>{s.trackAction({model:d,eventAction:"commentCreated"})})),g.addEvent("onCommentEdited",(()=>{s.trackAction({model:d,eventAction:"commentEdited"})})),g.addEvent("onCommentDeleted",(()=>{s.trackAction({model:d,eventAction:"commentDeleted"})})),g.addEvent("onSubjectLiked",(()=>{s.trackAction({model:d,eventAction:"contentLiked"})})),g.addEvent("onSubjectUnliked",(()=>{s.trackAction({model:d,eventAction:"contentUnliked"})}));let h=new(a.extend({className:"w3ddrive-socialtoolbar-view",tagName:"div",render:function(){return g.inject(this.container),this.elements.socialToolbar=g,this._successFullInit=!0,this}})),v=new e({className:"w3ddrive socialtoolbar-scroll",useInfiniteScroll:!1,usePullToRefresh:!1,view:h});const D=v.destroy;return v.destroy=function(){D.apply(v,arguments),g=null,h=null,d=null,v.container=null},v}})),define("DS/W3DContentApp/Views/UploadInodesView/uploadInodeTasksView",["DS/W3DContentApp/Views/UploadInodesView/tasksView","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t){"use strict";return function(n){var i,o=n.children,r=e({title:t.uploads,children:o.toArray().map((function(e){return e.render(),e.container}))}),s=r.destroy;return i={onFinish:function(e){r.removeChildren(e.container)},onAdd:function(e){e.render(),r.addChildren(e.container)},onRemove:function(e){r.removeChildren(e.container)},onReset:function(e){r.resetChildren(e.toArray().map((function(e){return e.render(),e.container})))}},r.listenTo(o,i),r.container.addClassName("upload bottom"),Object.assign(r,{destroy:function(){r.undelegateDOMEvents(),s.apply(r,arguments),r.stopListening(),r.container=null,o=null,i=null,n=null}})}})),define("DS/W3DContentApp/Utils/DSAuth",["UWA/Class","DS/W3DContentApp/Utils/Platform"],(function(e,t){"use strict";return e.extend({init:function(e,t){if(t&&t.id!==e)throw new Error("Invalid id in DSAuth");this.platform=t,this.platformId=e},getStorage:function(){return this.platform},getSwymService:function(){if(this.platform)return this.platform.urlSwym},clearIdentity:function(e,t){return this.platform=void 0,e()},hasIdentity:function(e,n){if(this.platform)return e();var i=this;t.getAllPlatforms().then((function(t){t.map((function(e){e.id===i.platformId&&(i.platform=e)})),e()})).catch(n)},authenticate:function(e,t){this.hasIdentity.apply(this,arguments)}})})),define("DS/W3DContentApp/Views/setOfSelectedItemView",["UWA/Array","DS/W3DContentApp/Utils/SetOfSelectedView"],(function(e,t){"use strict";return function(n){const i=new t(n);return i.addEvents({onAdd:function(e){e.refreshSelected(!0)},onRemove:function(e){e.refreshSelected(!1)},onReset:function(t,n){n.previousItems.forEach((e=>{e.refreshSelected(!1)})),e.invoke(i,"refreshSelected",!0)}}),i}})),define("DS/W3DContentApp/Actions/Accesses/accessActionsFactory",["DS/W3DContentApp/Actions/Accesses/Base"],(function(e){"use strict";return function(t){if(!t||!t.access||!t.shareAccessActions)throw new Error("Options are missing.");return function(){var n=new e({model:t.access});for(var i in arguments){if(arguments.hasOwnProperty(i))(0,arguments[i])(n)}return n}(t.shareAccessActions)}})),define("DS/W3DContentApp/Views/InodePanelView/sortView",["DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/BusEvent","DS/W3DDrive/widget","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i){"use strict";const o=e.getSortConfiguration();let r;function s(e,t){let n="item";return e===t&&(n+=" selected"),n}function a(e){let t="fonticon fonticon-"+o[e].fonticon;return r===e&&(t+=" selected"),t}function l(e){return{tag:"span",class:a(e),events:{click:n=>{const i=n.target||n.srcElement;i.parentElement.parentElement.getElements(".selected").forEach((e=>{e.removeClassName("selected")})),i.parentElement.addClassName("selected"),i.addClassName("selected"),t.dispatchEvent("inodePanelView:onSort",[{id:e,logic:o[e]}])}}}}return function(t={}){const o=t.sortingList||[],a=e.getSortConfiguration()[t.sorting]||{},c=n.getValue("inodesSorting")?n.getValue("inodesSorting").logic:a;r=c.id;const d=c.attributeName,u=[],p=(e,t)=>({tag:"li",class:s(d,e),html:[{tag:"span",class:"item-text",text:t},l(e+"-a"),l(e+"-d")]});return o.includes("title")&&u.push(p("title",i.get("title"))),o.includes("modifiedDate")&&u.push(p("modifiedDate",i.get("modificationDate"))),o.includes("createdDate")&&u.push(p("createdDate",i.get("creationDate"))),o.includes("size")&&u.push(p("size",i.get("Size"))),o.includes("type")&&u.push(p("type",i.get("Type"))),o.includes("creator")&&u.push(p("creator",i.get("Creator"))),{tag:"ul",html:u}}})),define("DS/W3DContentApp/Views/InodePanelView/inodeTableView",["DS/W3DContentApp/Views/InodePanelView/inodeTableViewFunc","DS/W3DDrive/widget"],(function(e,t){"use strict";return function(n){if(!n||!n.collection)throw new Error("Missing input");var i=n.collection,o=e.getView(n),r=o.destroy,s={onSort:function(){o.render()}};return o.listenTo(t,{onInodeTableLayoutKeyUpdated:function(t){e.wrapWithLayout(o.container,t)}}),i.addEvents(s),Object.assign(o,{destroy:function(){return i.removeEvents(s),o.stopListening(),r.apply(o,arguments)}})}})),define("DS/W3DContentApp/Views/DriveView/driveDetailViewFunc",["UWA/Core","UWA/Class/View","UWA/String","DS/W3DContentApp/Utils/Helpers","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o){"use strict";return{toSizeStr:function(e){return e=e||0,i.computeNLSSize(e)},toPercentStr:function(e,t){return n.format("{0} %",t?Math.round(100*e/t):0)},createLegal:function(e){return new Promise((function(t,n){var i=document.createElement("div"),r=document.createElement("h5"),s=document.createElement("div");i.classList.add("legal"),e.getLegalInfo().then((function(e){e&&(r.textContent=o.legalTitle,s.innerHTML=e),i.appendChild(r),i.appendChild(s),t(i)}),(function(){t(null)}))}))},createAccountDetailElem:function(t){var n=e.createElement("div",{class:"account-detail"});if(!t||"function"!=typeof t.get)return n;var i=t.get("user"),r="",s="";return i&&(r=i.displayName||"",s=i.emailAddress||""),n.setContent([{tag:"h5",text:o.account},{tag:"div",class:"name",text:r},{tag:"div",class:"email",text:s}]),n},createAccountElem:function(t,n,i){var o=e.createElement("div",{class:"account"});if(!t||"function"!=typeof t.get||"function"!=typeof n)return o;var r=[n(t)];return i&&r.push(i),o.setContent(r),o},createStorageElem:function(t,n,i){var r=e.createElement("div",{class:"storage"});if(!t||"function"!=typeof t.get||"function"!=typeof n||"function"!=typeof i)return r;var s=t.get("quotaBytes"),a=0,l=0;s&&(a=s.used||0,l=parseInt(s.total)||0);var c=[{tag:"span",class:"used",text:n(a)}];return 0!==l&&c.push({tag:"span",class:"total",text:n(l)},{tag:"span",class:"percent",text:i(a,l)}),r.setContent([{tag:"h5",text:o.storage},{tag:"div",html:c}]),r},getRefreshElem:function(e,t,n){return function(){if(!(e&&e.container instanceof window.HTMLElement&&"function"==typeof t))return e;var o=e.container.querySelector(String(n));return o?(i.replaceWith(o,t()),e):e}},getView:function(e,n,i){var o=new t(Object.assign({},e));o.container.addClassName("w3ddrive drive-detail");var r=e.model;if(!r)return o;var s={};return"function"==typeof n&&(s["onChange:user"]=n),"function"==typeof i&&(s["onChange:quotaBytes"]=i),o.listenTo(r,s),o.destroy=function(){o.stopListening(),o.container=null,o.model=null,e=null},o}}})),define("DS/W3DContentApp/Models/Drive",["UWA/Core","UWA/Class/Model","UWA/Class/Promise","UWA/Utils","UWA/String","DS/W3DContentApp/Utils/DSAuth","DS/W3DContentApp/Metas/inode","DS/W3DContentApp/Utils/Alert","DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/Utils/RequestHelper"],(function(e,t,n,i,o,r,s,a,l,c){"use strict";const d=s();function u(e,t){const n=e[t];if(!n)throw new Error("The object has no defined value for "+t);return n}return t.extend({_Inodes:void 0,_Permissions:void 0,_createInodeTable:function(t,n,i){return new(u(this,"_Inodes"))(n||[],e.merge({parentInode:t,auth:this.hasAuth()},i))},fetch:function(e){return(e=e||{}).ajax=c.getRequestMethod(e),this._parent.apply(this,arguments)},_createShareWiths:function(t,n,i){return new(u(this,"_Permissions"))(n||[],e.merge({parentInode:t,auth:this.hasAuth()},i))},_indexInode:function(e,t){let n,i,o,r,s;!(t=t||{}).hasOwnProperty("shouldIndex")||t.shouldIndex;if(n=e.id,void 0===n)throw new Error("You can't index an inode with no id");if(e.drive=this,i=this._index,o=i[n],o){if(e===o)return o;o.collection,s=o.permissions,r=o.inodeTable}else e.isContainer()&&(r=this._createInodeTable(e,this._lsIndexedInodes(n)),this._onResetInodes(r),r.dotDot=function(){const e=this.dot().collection;return e?e.dot():null},this.listenTo(r,{onAdd:this._indexInode,onReset:this._onResetInodes,"onChange:parentId":this._onChangeParentId}),this.listenTo(e,"onDestroy",this._onDestroyInode),this.listenTo(e,"onChange:"+this.inodeIdAttr,this._onChangeId));return s||(s=this._createShareWiths(e)),e.permissions=s,e.isContainer()?(r.dot=function(){return e},e.inodeTable=r,i[n]=e,e):e},_lsIndexedInodes:function(e){const t=[],n=this._index;let i,o,r;for(i in n)n.hasOwnProperty(i)&&(o=n[i],r=o.get("parentId"),r&&r===e&&t.push(o));return t},_onResetInodes:function(e,t){e.forEach((function(e){this._indexInode(e,t)}),this)},_onChangeId:function(e,t){const n=e.previous(this.inodeIdAttr);this._index[t]=this.getInode(n),delete this._index[n]},_onChangeParentId:function(e,t){const n=this.getInode(t);let o,r;n&&n.isContainer()&&(o=e.collection,r=n.inodeTable,i.setImmediate((function(){o.remove(e),r.add(e)})))},_onDestroyInode:function(e){let t;this.stopListening(e),e.isContainer()&&(t=e.inodeTable,delete e.inodeTable,this.stopListening(t),delete e.permissions,t.forEach(this._onDestroyInode,this)),delete this._index[e.id]},defaults:{id:"",title:"",iconLink:"",thumbnailLink:"",modified:"",quotaBytes:{total:"",used:""},user:{displayName:"",emailAddress:""},authenticated:void 0,granted:void 0},auth:void 0,init:function(){const e=u(this,"_Inodes").prototype.model;let t;return this._index={},t=e.prototype.idAttribute,null==t&&(t="id"),this.inodeIdAttr=t,this._parent.apply(this,arguments)},hasAuth:function(){return this.get("auth")||this.set({auth:new r(this.id)}),this.get("auth")},sync:function(e,t,i){let o=i.attrs;const r=this;let s,d;const u=this._parent;let p,m;return i.ajax=c.getRequestMethod(i),o||(o=t.toJSON?t.toJSON():t),s=o.auth||this.hasAuth(),d=function(e){return function(){return new n((function(t,n){e.hasIdentity((function(){t(!0)}),(function(){t(!1)}))}))}}(s),"read"===e?p=d().then((function(e){return Object.assign(o||{},{granted:!0,authenticated:e})})).then((function(o){return o.authenticated&&l.result(t,"url")?o.isDrivesHubProvider?o:new n((function(n,r){u(e,t,Object.assign({},i,{auth:s,onComplete:function(e){["quotaBytes","user"].map((function(e){delete o[e]})),n(Object.assign({},e,o))},onFailure:function(e){a.add({message:e.error?e.error.message:"",className:"error"}),r(e)}}))})):o})):"update"===e&&(m=new n((function(e,i){var s=function(e){return function(){return new n((function(t,n){e.authenticate((function(){t.apply(this,arguments)}),(function(){n.apply(this,arguments)}))}))}}(r.get("auth")),a=function(e){return function(){return new n((function(t,n){e.clearIdentity((function(){t.apply(this,arguments)}),(function(){n.apply(this,arguments)}))}))}}(r.get("auth")),l=o.authenticated;if(void 0===o.authenticated)return e();l?s().then((function(){e.apply(this,arguments)}),(function(){i.apply(this,arguments)})):a().then((function(){o=Object.assign(t.defaults,{granted:o.granted,authenticated:o.authenticated,id:t.id}),t.isDrivesHubDrive&&(o=Object.assign({},o,t.getDefaultsAttributes())),e.apply(this,arguments)}),(function(){i.apply(this,arguments)}))})),p=m.then((function(e){return e&&void 0!==e.email&&(o.user.emailAddress=e.email),o}))),p.then(i.onComplete,i.onFailure)},getLegalInfo:function(){return new n((function(e,t){t()}))},getInode:function(t,n){let i,o,r,s,a,l=this.inodeIdAttr;if(!t)return null;if(t.hasOwnProperty&&t.hasOwnProperty(l))o=t;else if(e.is(t,"string"))o={},o[l]=t;else if(t.toJSON)o=t.toJSON();else{if(!e.is(t,"object"))return null;o={},o[l]=t}if(r=o[l],!r)return null;if(s=this._index,a=s[r],a)return a;if(t&&t.containerToSearchIn){const e=Object.keys(s).find((e=>e.toLowerCase()===t.containerToSearchIn.toLowerCase()));if(e){const t=s[e].inodeTable.getInode(r);if(t)return t}}else for(let e in s){const t=s[e].inodeTable.getInode(r);if(t)return t}return n&&n.hasOwnProperty("noCreate")&&!0===n.noCreate?null:(i=u(this,"_Inodes").prototype.model,a=new i(o,e.merge({auth:this.hasAuth()})),this._indexInode(a),a)},getTrueRootInode:function(){const e={};return e.mimeType=d.mimeType.folder,e[this.inodeIdAttr]=d.ids.trueRoot,this.getInode(e)},getRootInodes:function(e){const t=this;if(!0===e)return new n((function(e,n){const i=t.getTrueRootInode();i.inodeTable.fetch({onComplete:function(){e(i.inodeTable)},onFailure:n})}));return this.getTrueRootInode().inodeTable},getParentInode:function(e,t){const i=this;return new n((function(n,o){var r,s,a=i.getInode(e),l=a.inodeTable.dotDot();return l||a===i.getTrueRootInode()?n(l):void 0!==(r=a.get("parentId"))?((s={mimeType:d.mimeType.folder})[i.inodeIdAttr]=r,(l=i.getInode(s)).inodeTable.add(a),n(l)):t?o():a.fetch({onComplete:function(){i.getParentInode(e,!0).then(n,o)},onFailure:o})}))},getInodesPath:function(e,t){const i=this;return function e(t,o){var r,s;return void 0===o&&(o=t,t=void 0),r=i.getInode(o),(s=i.getInode(t))||(s=i.getTrueRootInode()),new n((function(t,n){return r===s?t([s]):i.getParentInode(r).then(e.bind(void 0,s),n).then((function(e=[]){e.push(r),t(e)}))}))}(e,t).then((function(e){return e.map((function(e){return i._index[e.id]}))}))},getInodePanelURI:function(e,t={}){const n="drives";return e?o.format("/{0}/{1}/mimetype/{2}/inode/{3}",n,window.encodeURIComponent(e.drive.id),window.encodeURIComponent(t.containerType?t.containerType:e.get("mimeType")),window.encodeURIComponent(t.containerId?t.containerId:e.id)):n},getInodePanelContentURI:function(e,t={}){return o.format("{0}/content",this.getInodePanelURI(e,t))},getInodePreviewURI:function(e,t={}){return o.format("{0}/{1}/preview",this.getInodePanelContentURI(e.collection.dot(),t),window.encodeURIComponent(e.id))},destroy:function(){this.getTrueRootInode().destroy()}})})),define("DS/W3DContentApp/Models/DriveAbstract",["UWA/Core","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/W3DContentApp/Metas/inode","DS/W3DContentApp/Models/Drive","DS/WebappsUtils/WebappsUtils"],(function(e,t,n,i,o){"use strict";const r=n(),s=i.prototype.defaults;return i.extend({_Inodes:void 0,_Permissions:void 0,url:"",defaults:e.merge({title:"3DEXPERIENCE",thumbnailLink:o.getWebappsAssetUrl("W3DDrive","3DDrive_40x30.png"),iconLink:o.getWebappsAssetUrl("W3DDrive","3DDrive_80x60.png"),shareWithinvitation:!1},s),getInodePanelURI:function(e){return!e||""!=e.get("mimeType")&&e.get("mimeType")||e.set("mimeType",r.mimeType.folder),this._parent.apply(this,arguments)},init:function(){const e=this;this._parent.apply(this,arguments),t.getPlatformConfig({key:"share",platformId:e.id,onComplete:function(t){e.set("shareWithinvitation",t)}}),t.getUser({onComplete:function(t){e.set("user",{displayName:t.firstname+" "+t.lastname,emailAddress:t.email,id:t.id})}})}})})),define("DS/W3DContentApp/Views/DriveView/driveDetailView",["UWA/Utils","DS/W3DContentApp/Views/DriveView/driveDetailViewFunc","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t){"use strict";return function(n){var i,o=n.model,r=function(){return t.createAccountElem(o,t.createAccountDetailElem)},s=function(){return t.createStorageElem(o,t.toSizeStr,t.toPercentStr)},a=function(){return t.createLegal(o)};function l(){e.setImmediate(t.getRefreshElem(i,r,".account"))}function c(){e.setImmediate(t.getRefreshElem(i,s,".storage"))}var d=(i=t.getView(n,l,c,(function(){e.setImmediate(t.getRefreshElem(i,a,".legal"))}))).destroy;return Object.assign(i,{render:function(){return a().then((function(e){i.container.setContent([r(),s(),e])})),i},destroy:function(){return o=null,r=null,a=null,s=null,l=null,c=null,i.stopListening(),d.apply(i,arguments)}})}})),define("DS/W3DContentApp/Views/accessItemView",["UWA/Utils","UWA/String","DS/W3DContentApp/Views/itemView","DS/W3DContentApp/Actions/Accesses/accessActionsFactory","DS/W3DDrive/widget","DS/UIKIT/Modal","DS/WebappsUtils/WebappsUtils","DS/W3DContentApp/Utils/RequestHelper","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o,r,s,a,l){"use strict";return function(c){if(!c||!c.model||!c.shareAccessActions)throw new Error("Missing input");var d,u,p=c.model,m=c.shareAccessActions,f={model:p};let g="permission-item";var h=i({access:p,shareAccessActions:m});function v(){var n;if(p.isGroup&&p.isGroup()){const r=(e=0)=>{const t=Number(e),n=1===t?l.get("groupMemberCount"):l.get("groupMembersCount");return l.replace(n,{total:t})};("OnPremise"!==p.collection._auth.platformId&&void 0===p.get("title")||void 0===p.get("picture"))&&(g+=" hidden",function(){if(!p)throw new Error("Missing input");const e=p._auth.platformId,n=p.collection._parentInode.drive.get("user").id,i=Date.now(),r=(o.getValue("is3DSpaceWidget")?"X3DCSMA_AP":"X3DDRIV_AP").concat("-",n,"-",i),s=t.format("{0}/search",p._auth.platform.urls3DSearch);return new Promise(((t,n)=>{a.performRequestWithOptions(s,{type:"json",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({source:"usersgroup",query:'[ds6w:type]:("foaf:Group") AND ([ds6w:resourceUid]:"'+p.get("id")+'")',select_predicate:["ds6w:label","ds6w:type","dsaccess:groupMemberCount","dsusergroup:groupMaturity"],nresults:8,order_by:"desc",order_field:"relevance",with_synthesis:!1,with_synthesis_attribute:!1,tenant:e,locale:o.lang,label:r}),onComplete:e=>{let n,i=[];e.hasOwnProperty("results")&&(i=e.results.filter((e=>e.hasOwnProperty("attributes"))).map((e=>e.attributes.filter((e=>e.hasOwnProperty("name")&&e.hasOwnProperty("value"))).map((e=>(e.name.contains("ds6w:")&&(e.name=e.name.split("ds6w:").pop()),e.name.contains("dsaccess:")&&(e.name=e.name.split("dsaccess:").pop()),e.name.contains("dsusergroup:")&&(e.name=e.name.split("dsusergroup:").pop()),"type"===e.name&&e.value.contains("foaf:")&&(e.value=e.value.split("foaf:").pop()),e))).filter((e=>"resourceid"===e.name||"label"===e.name||"type"===e.name||"groupMemberCount"===e.name||"groupMaturity"===e.name)).reduce(((e,t)=>("groupMaturity"===t.name&&(t.value=t.value.split("dsusergroup:State.").pop()),e[t.name]=t.value,e)),{})))),i.length>0&&(n=i[0]),t(n)},onFailure:n})}))}().then((t=>{t?(d.container.classList.remove("hidden"),f.title=t.label,f.metas[1]=r(t.groupMemberCount),f.image="Private"===t.groupMaturity?s.getWebappsAssetUrl("W3DContentApp","thumbnails/default-private-group.svg"):s.getWebappsAssetUrl("W3DContentApp","thumbnails/default-group.svg"),e.setImmediate((function(){d.refreshImg(),d.refreshContent()})),void 0===p.get("title")&&(p.set("title",t.label),void 0===p.get("members")&&p.set("members",t.groupMemberCount),p.set("picture",f.image))):d.destroy()}),(()=>{d.destroy()}))),void 0!==p.get("picture")?f.image=p.get("picture"):f.image=s.getWebappsAssetUrl("W3DContentApp","default-group.svg"),n={id:"id",title:"title",metas:function(e){let t=[];return t.push(i(e.get("accessright"))),t.push(r(e.get("members"))),t}}}else n={id:"id",image:"picture",title:function(e){let t=e.get("title")||e.get("emailAddress");return e.isPending&&e.isPending()&&(t+=" ("+l.get("pending")+")"),t},metas:function(e){let t=[];return t.push(i(e.get("accessright"))),t}};function i(e){const t={owner:l.get("owner"),read:l.get("can_view"),edit:l.get("can_edit"),read_share:l.get("can_view_share"),edit_share:l.get("can_edit_share")};return t[e]?t[e]:l.get(e)}Object.keys(n).forEach((function(e){let t;t="function"==typeof n[e]?n[e](p):p.get(n[e]),f[e]=t})),f.viewConf={draggable:!1},f.actions=h.toJSON(),f.actions&&p.isGroup&&p.isGroup()&&f.actions.push({handler:function(){require(["DS/i3DXRDFGroupViewer/js/GroupViewer"],(function(e){const t=new e({platformId:f.model._auth.platformId,groupId:f.model.get("id"),language:o.lang});new r({renderTo:document.body,className:"group-viewer",visible:!0,closable:!0,header:l.get("viewGroupMembersTitle"),body:t.render()})}))},icon:"fonticon fonticon-user-eye",id:"viewMembers",text:l.get("viewMembers")})}return v(),d=n(f),u=d.destroy,d.listenTo(p,{"onChange:accessright":function(){v(),e.setImmediate((function(){d.refreshContent(),d.refreshActionsDropdownMenu(f.actions)}))}}),d.container.addClassName(g),Object.assign(d,{destroy:function(){u.apply(d,arguments),p=null,h.model=null,d.stopListening()}})}})),define("DS/W3DContentApp/Utils/Actions/drive",["UWA/Class/Events","DS/W3DContentApp/Views/SuperModal","DS/W3DContentApp/Metas/drive","DS/W3DContentApp/Views/DriveView/driveDetailView","DS/W3DContentApp/BusEvent","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o,r){"use strict";const s=n();function a(e,t){o.dispatchEvent("driveActions:"+e,t)}return function(n){const o=new e(n),l=n.model,c=[{id:s.actionPubIds.storage,text:r.get("storage"),icon:"database",handler:()=>{const e=i({model:l});e.render(),t.dialog({title:l.get("title"),body:e.container}),a("onStorage",[l])}},{id:s.actionPubIds.disconnect,text:r.get("disconnect"),icon:"box-times",handler:()=>{a("onDisconnect",[l])}}];return Object.assign(o,{toJSON:function(e){return function(e,t){const n=[];return t.forEach((function(t){(function(e,t){return t.isActionIdoK(e.id)})(t,e)&&n.push(t)}),this),n}(l,c)}})}})),define("DS/W3DContentApp/Views/InodeDetailView/accessesView",["DS/WebAppsFoundations/Views/CollectionView","DS/W3DContentApp/Views/accessItemView","DS/W3DXComponents/Views/EmptyView","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i){"use strict";return function(o){var r=o.emptyView&&o.emptyView.icon||"search",s=o.emptyView&&o.emptyView.title||i.noMemberRetreived,a=new e({className:"w3ddrive permissions w3dx tiles relaxed",collection:o.collection,emptyView:new n({icon:r,title:s})});return Object.assign(a,{_buildItemView:function(e){return t({model:e,shareAccessActions:o.shareAccessActions})}})}})),define("DS/W3DContentApp/Views/InodeDetailView/inodeAllAccessesView",["UWA/Class/View","DS/UIKIT/Spinner","DS/W3DXComponents/Views/Layout/ScrollView","DS/W3DContentApp/Views/InodeDetailView/accessesView","DS/W3DContentApp/BusEvent"],(function(e,t,n,i,o){"use strict";function r(e){var t=e.container,n=e.elements.spinner;t.classList.add("loading"),n.show()}function s(e,t){var n=t.elements.scrollView,i=t.elements.spinner;e?(n.container.addClassName("loading"),i.show()):setTimeout((function(){n.container.removeClassName("loading"),i.hide()}),150)}return function(a){var l=a.model,c=l.permissions,d=new e(a),u=d.destroy;return d.elements.spinner=new t({className:"inode-access__spinner"}),d.elements.scrollView=new n({className:"inode-access__scroll",usePullToRefresh:!1,view:i({collection:c,shareAccessActions:a.shareAccessActions,emptyView:{title:a.emptyView.title,icon:a.emptyView.icon}}),events:{onInfiniteScroll:function(){c.state&&"function"==typeof c.hasNextPage&&c.hasNextPage()?o.dispatchEvent("inodeAllAccessesView:onNextPage",c):d.elements.scrollView.useInfiniteScroll(!1)}}}),d.listenTo(c,{onSync:function(){!function(e){setTimeout((function(){var t=e.container,n=e.elements.spinner;t.classList.remove("loading"),n&&n.hide()}),80)}(d)},onReset:function(){r(d)}}),d.elements.scrollView.listenTo(c,{onSync:function(){d.elements.scrollView.endLoading(),s(!1,d),c.state&&d.elements.scrollView.useInfiniteScroll(!0)},onReset:function(){s(!0,d)}}),c.isEmpty()&&r(d),o.dispatchEvent("inodeDetailAccessesView:onAccesses",[l]),Object.assign(d,{render:function(){return d.elements.scrollView.render(),d.container.setContent([d.elements.spinner,d.elements.scrollView]),d},destroy:function(){d.elements.scrollView.stopListening(),d.stopListening(),u.apply(d,arguments)}})}})),define("DS/W3DContentApp/Views/DriveView/driveItemView",["UWA/Utils","DS/W3DContentApp/Utils/Actions/drive","DS/W3DContentApp/Views/itemView","DS/W3DContentApp/BusEvent","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o){"use strict";return function(r={}){if(!r.model)throw new Error("Missing input");const s=r.model;let a,l,c={model:s},d=t({model:s}).toJSON();function u(){const e={id:"id",image:"thumbnailLink",icon:"iconLink",title:"title",metas:function(e){return e.getMeta()}};Object.keys(e).forEach((t=>{const n="function"==typeof e[t]?e[t](s):s.get(e[t]);c[t]=n})),c.actions=d}function p(e,t,n){return e.classList.contains(t)?n||e.classList.remove(t):!1!==n&&e.classList.add(t),e}function m(e){return p(a.container,"expanded",e)}function f(e){return p(a.container,"authenticated",e)}return u(),c.viewConf={noActionsMenu:1===d.length,actionsFonticon:1===d.length?d[0].icon:"cog",actionsIconTooltip:1===d.length?d[0].text:o.get("manageStorage")},a=n(c),l=a.destroy,a.container.addEvent("click",(function(e){(e.target||e.srcElement)!==a.container.getElement(".actions")&&(a.dispatchEvent("onClick",[s]),i.dispatchEvent("driveView:onClick",[s]))})),a.listenTo(s,{"onChange:thumbnailLink":function(){e.setImmediate((function(){a.refreshImg()}))},"onChange:authenticated":function(){f(s.get("authenticated"))},onChange:function(){u(),e.setImmediate((function(){a.refreshContent()}))}}),a.container.addClassName("drive-item w3dx tile half relaxed"),f(s.get("authenticated")),Object.assign(a,{toggleExpand:m,expand:function(){return m(!0)},collapse:function(){return m(!1)},destroy:function(){return d=null,c=null,a.model=null,a.stopListening(),l.apply(a,arguments)}})}})),define("DS/W3DContentApp/Views/InodePanelView/inodeTopBarViewFunc",["UWA/Core","UWA/Class/View","UWA/Utils/Client","DS/W3DDrive/InodeActions","DS/W3DContentApp/Views/InodePanelView/inodeTableViewFunc","DS/W3DContentApp/Views/InodePanelView/sortView","DS/W3DContentApp/Utils/Helpers","DS/W3DDrive/widget","DS/W3DContentApp/Utils/Store","DS/W3DContentApp/Utils/Alert","DS/UIKIT/Iconbar","DS/UIKIT/Input/Button","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o,r,s,a,l,c,d,u,p){"use strict";function m(e){var t=(e=e||{}).target,n=e.uri;if(t=t.querySelector('.breadcrumb__elem-title[href="'+n+'"]'))return t.parentNode}function f(t={}){let n=t.target;const i=t.opts;if(!n||!i)return;if(!n.classList.contains("breadcrumb")&&(n=n.querySelector(".breadcrumb"),!n))return;for(;n.lastElementChild;)n.removeChild(n.lastElementChild);Object.keys(i).map((e=>({uri:e,elem:m({target:n,uri:e}),...i[e]}))).map((t=>function(t){var n=(t=t||{}).uri,i=t.title,o=Boolean(t.shared);const r=e.createElement("div",{class:"breadcrumb__elem"});return[e.createElement("div",{class:"breadcrumb__elem-divider fonticon"}),e.createElement("div",{class:o?"breadcrumb__elem-icon fonticon breadcrumb__elem-icon_share":"breadcrumb__elem-icon fonticon"}),e.createElement("a",{class:"breadcrumb__elem-title",href:n,draggable:!1,text:i,target:"_blank"}),e.createElement("div",{class:"breadcrumb__elem-icon fonticon breadcrumb__elem-open-down hidden"})].reduce((function(e,t){return t&&e.appendChild(t),e}),r)}(t))).reverse().reduce(((e,t)=>(e.appendChild(t),e)),n)}function g(e,t,n){n=n||{};var i=e.querySelector(t);return i.firstChild&&i.removeChild(i.firstChild),n.iconbarElem&&i.appendChild(n.iconbarElem),e}function h(e,t){var n;e&&(n=e.querySelector?e.querySelector(".iconbar__item--info"):e.elements.container.querySelector(".iconbar__item--info"))&&(t?n.classList.add("item-info--opened"):n.classList.remove("item-info--opened"))}return{getBreadcrumbElem:m,refreshBreadcrumbElem:function(e){const t=(e=e||{}).target;if(t&&e.title){const n=t.querySelector(".breadcrumb__elem-title");n&&(n.textContent=e.title)}if(t&&void 0!==e.shared){const n=t.querySelector(".breadcrumb__elem-icon");n&&(e.shared?n.classList.add("breadcrumb__elem-icon_share"):n.classList.contains("breadcrumb__elem-icon_share")&&n.classList.remove("breadcrumb__elem-icon_share"))}return e},refreshBreadcrumb:f,createBreadcrumb:function(t={}){const n=e.createElement("div",{class:"breadcrumb"});return f({target:n,opts:t.opts}),n},getIconBarContainer:function(e){const t=document.createElement("div");return t.classList.add("top-bar__iconbar-container"),e&&t.appendChild(e),t},refreshIconBarContainer:function(e,t){return g(e,".top-bar__iconbar-container",t)},getFixedIconBarContainer:function(e){const t=document.createElement("div");return t.classList.add("top-bar__iconbar-container--fixed"),e&&t.appendChild(e),t},refreshFixedIconBarContainer:function(e,t){return g(e,".top-bar__iconbar-container--fixed",t)},getIconbarItems:function(e){if(!e)return[];Array.isArray(e)||(e=[].concat(e));const t=["openWith","viewInformation"];return e.filter((function(e){return e&&-1===t.indexOf(e.id)})).map((function(e){return Object.assign({index:1},e)})).reverse()},createIconbar:function(e){return new d({className:"top-bar__iconbar",items:[].concat(e),tooltipsPosition:"bottom"})},createFixedIconbar:function(e,t){const n=!t||(t.canMultiselect||void 0===t.canMultiselect),i=!t||(t.canChangeLayout||void 0===t.canChangeLayout),l=!t||(t.canSort||void 0===t.canSort),c=t&&t.defaultLayout;let u=[{className:"divider"}];const m=(e,t)=>{let n=e.target;n=n.classList.contains("fonticon")?n.parentElement:n,n.classList.toggle("item--active",t)};if(n&&(u=u.concat([{text:p.multiSelection,fonticon:"select-on",className:"iconbar__item--select-on"},{fonticon:"open-down",className:"iconbar__item--select-on-option",innerComponent:{type:"dropdownmenu",options:{className:"item-select-on__dropdown",items:[{text:p.selectAll,fonticon:"select-all",className:"dropdown__item--select-all",handler:function(){}},{text:p.unselectAll,fonticon:"select-none",className:"dropdown__item--select-none",handler:function(){}}]}}}])),i){const e=c||a.getValue("inodeTableLayoutKey")||"listLayout",t={listLayout:"view-list",thumbnailsLayout:"view-small-thb",tilesLayout:"view-small-tile"};u.push({fonticon:t[e],text:p.get("View"),className:"iconbar__item--layout",content:{type:"dropdownmenu",options:{items:[{fonticon:"view-list",text:p.get("ListView"),selectable:!0,selected:e===o.listLayoutKey,handler:function(){a.dispatchEvent("onUpdateInodeTableLayoutKey",o.listLayoutKey)}},{fonticon:"view-small-thb",text:p.get("ThumbnailsView"),selectable:!0,selected:e===o.thumbnailsLayoutKey,handler:function(){a.dispatchEvent("onUpdateInodeTableLayoutKey",o.thumbnailsLayoutKey)}},{fonticon:"view-small-tile",text:p.get("TilesView"),selectable:!0,selected:e===o.tilesLayoutKey,handler:function(){a.dispatchEvent("onUpdateInodeTableLayoutKey",o.tilesLayoutKey)}}],events:{onClick:function(e,t){this.options.target.children[0].className=t.elements.icon.className,this.options.target.classList.toggle("item--active",!1)},onClickOutside:function(){this.options.target.classList.toggle("item--active",!1)}}}},handler:function(e){m(e,!0)}})}if(l){const t=s.getSortConfiguration()[e.sorting]||{},n=a.getValue("inodesSorting")?a.getValue("inodesSorting").logic:t;u.push({text:p.get("sort"),fonticon:n.fonticon,className:"iconbar__item--sort",content:{type:"dropdown",options:{className:"sort-dropdown-menu",body:r({sortingList:e.sortingList,sorting:e.sorting}),events:{onClick:function(e){const t=e.target||e.srcElement;t&&t.classList.contains("fonticon")&&this.options.target.children[0].classList.replace(this.options.target.children[0].classList[1],t.classList[1])},onClickOutside:function(){this.options.target.classList.toggle("item--active",!1)}}}},handler:function(e){m(e,!0)}})}const f=new d({className:"top-bar__iconbar top-bar__iconbar--fixed",items:u.concat([{text:p.get("Information"),fonticon:"info",className:"iconbar__item--info",handler:function(){a.dispatchEvent("onToggleInodePanelSideBarVisibility")}}]),tooltipsPosition:"bottom"});return h(f,a.getBool("isInodePanelSideBarOpened")),f},getView:function(e){var n=new t(e);return n.container.classList.add("top-bar"),n},updateIconbarInfoColor:h,wrapActionBar:function(){var e=document.createElement("div");return e.classList.add("inode-panel__action-bar"),e},createNewButtonContainer:function(){return e.createElement("div",{class:"top-bar__new-btn"})},refreshNewButtonContainer:function(e){const t=e.target.querySelector(".top-bar__new-btn"),o=e.model;let r;t.querySelector("button")&&t.querySelector("button").parentElement.removeChild(t.querySelector("button"));const d=new i({model:o,context:"topbar"}).toJSON();if(0===d.length)return;const m=d.find((e=>"upload"===e.id)),f=d.find((e=>"createFolder"===e.id)),g=d.find((e=>"uploadFolder"===e.id)),h=d.find((e=>"createCollabSpace"===e.id));if(m||f||g||h){if(a.getValue("is3DSpaceWidget"))h&&(r=new u({value:p.newCollabSpace,icon:"plus",className:"primary btn-sm",events:{onClick:function(){h.handler()}}}));else{const e=[];f&&e.push({name:"newfolder",text:f.text,fonticon:f.fonticon,handler:f.handler});const t=n.Platform.ios||n.Platform.android||n.Platform.ipad||n.Platform.tablet;g&&!t&&e.push({name:"uploadfolder",text:g.text,fonticon:g.fonticon,handler:g.handler}),m&&e.push({name:"addcontent",text:m.text,fonticon:m.fonticon,handler:m.handler}),r=new u({value:p.get("new"),icon:"plus",className:"primary btn-sm",dropdown:{items:e},events:{onClick:function(){var e=this.elements.container.parentElement.getBoundingClientRect();this.dropdown.options.altPosition={x:e.x,y:e.bottom}}}}),l.features.isODEFeatureAvailable&&!o.drive.get("blockactions")&&require(["DS/W3DContentApp/Components/OfficeDocumentEditor"],(function(t){const n=e=>{s.isAndroidOrIphone()?c.add({message:p.get("ODdisabledActions"),className:"primary"}):t.createDocument(o,e)};e.push({className:"divider"}),e.push({text:p.get("CreateDocument"),fonticon:"doc-word",handler:function(){n("docx")}}),e.push({text:p.get("CreatePresentation"),fonticon:"doc-powerpoint",handler:function(){n("pptx")}}),e.push({text:p.get("CreateSpreadsheet"),fonticon:"doc-excel",handler:function(){n("xlsx")}}),r.setDropdown({items:e},!1)}))}r.inject(t)}},refreshNewButtonState:function(e,t){e.querySelector(".top-bar__new-btn").classList.toggle("hidden",!t)}}})),define("DS/W3DContentApp/Views/Lightbox/lightboxPreviewBody",["UWA/Class/Promise","DS/3DPlaySupport/AssetSupport","DS/W3DContentApp/Views/Lightbox/lightboxPreviewImg","DS/W3DContentApp/Views/Lightbox/lightboxPreviewVideo","DS/W3DContentApp/Utils/Helpers","DS/UIKIT/Spinner","DS/W3DDrive/widget","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o,r,s){"use strict";let a,l;return{hidePreviewBody:p,init:function(m={}){if(c)return c;var f,g,h=new r({className:"preview-body__spinner"}),v=(f=[h.elements.container],(g=document.createElement("div")).classList.add("preview-body"),function(e,t){return(t=[].concat(t)).reduce((function(e,t){return e.appendChild(t),e}),e)}(g,f));return c=Object.assign(v,{refresh:D,toggleInteraction:function(e){return d(v,e)}}),D(m.inode),c;function D(r,d=!1,m={}){return h.show(),u(c),p(),r?t.checkSupport(r.get3DPlayOptions().asset,{usage:"preview"},(function(t){const f="VIEWER_3DPLAY",g="VIEWER_ODE",v=t=>{if(!t)throw new Error("Missing viewerType attribute");return new e((i=>{switch(t){case f:i(new e((e=>{require(["DS/W3DContentApp/Views/Lightbox/lightboxPreview3DPlay"],(function(t){a=t,e(a)}))})));break;case g:i(new e((e=>{require(["DS/W3DContentApp/Components/OfficeDocumentEditor"],(function(t){l=t,e(l)}))})));break;default:i(n)}}))};return new e((e=>{if(r&&r.drive.isCollabSpace)e(v(f));else{if(d)return r.set("play360",!0),void e(v(f));if(!function(e){const t=document.createElement("video");return!s.getValue("is3DSpaceWidget")&&["probably","maybe"].includes(t.canPlayType("video/"+e))}(r.get("fileExtension")))return r&&r.drive&&r.drive.isDsDrive&&!s.getValue("isStandalone")&&r.drive.get("auth").platform.urlODE&&o.isOfficeDocumentSupported(r.get("fileExtension"))?(p({destroy3DPlayViewer:!0}),void e(v(g))):void e(t?v(f):n);e(i)}})).then((e=>{const t=e.init();return function(e,t){if(e.contains(t))return t;t.classList.add("preview-body__adapter"),e.appendChild(t)}(c,t),t.refresh(r,m)})).then((e=>{u(c,e),h.hide()}))})):e.resolve()}},getPreviewOfficeDocument:function(){return l}};var c;function d(e,t){var n=function(e,t){var n=e;return n.classList.contains(t)||(n=n.querySelector("."+t)),n}(e,"preview-body");return t?n.classList.add("preview-body--interactive"):n.classList.remove("preview-body--interactive"),e}function u(e,t){var n=e.querySelectorAll(".preview-body__adapter");return d(e,Array.prototype.map.call(n,(function(e){return e===t?(e.classList.add("preview-body__adapter--visible"),!0):(e.classList.remove("preview-body__adapter--visible"),!1)})).reduce((function(e,t){return e||t}),!1)),e}function p(e={destroy3DPlayViewer:!1}){a&&e.destroy3DPlayViewer&&a.hide3DPlayViewer(),l&&l.destroy(),i&&i.pauseVideo()}})),define("DS/W3DContentApp/Views/InodePanelView/inodeTopBarView",["DS/W3DDrive/InodeActions","DS/W3DContentApp/Utils/stopPropagationDropdownMenu","DS/W3DContentApp/Views/InodePanelView/inodeTopBarViewFunc","DS/W3DContentApp/Utils/Helpers","DS/W3DDrive/widget","UWA/Utils/Client","DS/W3DContentApp/BusEvent","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o,r,s){"use strict";return function(a){let l=a.model,c=l.drive;const d=a.viewSpecs;let u;const p=n.getView(a),m=p.destroy;let f=!1;p.elements.fixediconbar=n.createFixedIconbar(d,l.configuration),p.elements.actionBarWrapper=n.wrapActionBar();const g={"onChange:shared":function(e,t){v(e,{shared:t})},"onChange:title":function(e,t){v(e,{title:t})},"onChange:alias":function(e,t){v(e,{title:t})},"onChange:actions":function(i,o){(n=>{if(n){p.elements.dropdown&&(p.elements.dropdown.destroy(),p.elements.dropdown=null,delete p.elements.dropdown);const n=p.container.querySelector(".breadcrumb__elem-open-down"),i=new e({model:l,context:"topbar"}).toJSON();i.length&&n&&(n.classList.toggle("hidden",!1),p.elements.dropdown=new t({target:n,items:i}))}})(o),n.refreshNewButtonContainer({target:p.elements.actionBarWrapper,model:i})},"onChange:parentId":function(){setTimeout((function(){b()}),1e3)}},h={onSync:function(e){const t=e._parentInode?e._parentInode:e.collection._parentInode;n.refreshNewButtonContainer({target:p.elements.actionBarWrapper,model:t})},onRemove:function(e){const t=e.collection._parentInode;n.refreshNewButtonContainer({target:p.elements.actionBarWrapper,model:t})}};function v(e,t){var i=c[e.isContainer()?"getInodePanelContentURI":"getInodePreviewURI"](e);n.refreshBreadcrumbElem(Object.assign({target:n.getBreadcrumbElem({target:p.container,uri:i})},t)),D()}function D(){function e(){const e=p.elements.iconbar;e&&e.resize()}window.requestAnimationFrame?u=requestAnimationFrame(e):setTimeout(e)}function w(e){n.updateIconbarInfoColor(p.elements.actionBarWrapper.querySelector(".top-bar__iconbar-container--fixed"),e)}function b(){if(p.stopListening(),p.stopListening(l),p.stopListening(l,g),p.stopListening(c),p.listenTo(l,g),p.listenTo(l.inodeTable,h),p.listenTo(s,{driveFeaturesList:function(e){n.refreshNewButtonContainer({target:p.elements.actionBarWrapper,model:e})}}),setTimeout((function(){f&&i.listenToHierarchy(p,l,g)}),1e3),f)for(;p.container.firstChild;)p.container.removeChild(p.container.firstChild);const o=l.isContainer()?l:l.collection.dot();return c.getInodesPath(o.id).then((function(i){const o=new e({model:l,context:"topbar"}).toJSON(),s=o.map((function(e){return e.id})).indexOf("uploadFolder"),a=r.Platform.ios||r.Platform.android||r.Platform.ipad||r.Platform.tablet;-1!==s&&a&&o.splice(s,1),i.shift();var d=i.reduce((function(e,t,n){var r=c.getInodePanelContentURI(t),s=n===i.length-1;return e[r]={title:t.get("alias")||t.get("title"),withOpenDown:s&&o.length>0,shared:t.get("shared")},e}),{});n.refreshNewButtonContainer({target:p.elements.actionBarWrapper,model:l}),n.refreshBreadcrumb({target:p.container,opts:d});const u=p.container.querySelector(".breadcrumb__elem-open-down");o.length&&u&&(u.classList.toggle("hidden",!1),p.elements.dropdown=new t({target:u,items:o})),n.refreshFixedIconBarContainer(p.container,{iconbarElem:p.elements.fixediconbar&&p.elements.fixediconbar.elements.container}),D()})),[n.createNewButtonContainer(),n.getIconBarContainer(),n.getFixedIconBarContainer()].reduce((function(e,t){return e.appendChild(t),e}),p.elements.actionBarWrapper),[n.createBreadcrumb(),p.elements.actionBarWrapper].reduce((function(e,t){return e.appendChild(t),e}),p.container),f=!0,p}return p.delegateDOMEvents({"click .breadcrumb__elem-title":function(e){e.preventDefault()}}),o.addEvent("onInodePanelSideBarVisibilityToggled",w),Object.assign(p,{refreshIconBarActions:async function(e){let t,i;e=[].concat(e),p.elements.iconbar&&(p.elements.iconbar.destroy(),p.elements.iconbar=null,delete p.elements.iconbar),i=p.elements.fixediconbar=n.createFixedIconbar(d,l.configuration),n.refreshFixedIconBarContainer(p.container,{iconbarElem:i&&i.elements.container}),e.length&&(t=p.elements.iconbar=n.createIconbar(n.getIconbarItems(e))),t&&n.refreshIconBarContainer(p.container,{iconbarElem:t&&t.elements.container})},toggleNewButtonState:function(e){n.refreshNewButtonState(p.elements.actionBarWrapper,e)},render:b,destroy:function(){u&&window.cancelAnimationFrame(u),u=null,this.stopListening(),this.undelegateDOMEvents(),f=!1,p.elements.actionBarWrapper.parentNode&&p.elements.actionBarWrapper.parentNode.removeChild(p.elements.actionBarWrapper),delete p.elements.actionBarWrapper,m.apply(p,arguments),this.elements=null,this.model=null,a=null,c=null,l=null,this.container=null,o.removeEvent("onInodePanelSideBarVisibilityToggled",w)}})}})),define("DS/W3DContentApp/Views/Lightbox/lightbox",["DS/vue/vue","text!DS/W3DContentApp/Views/Lightbox/Lightbox.html","UWA/Class/Promise","DS/W3DDrive/InodeActions","DS/W3DContentApp/Views/InodeDetailView/inodeDetailView","DS/W3DContentApp/Views/Lightbox/lightboxPreviewBody","DS/W3DContentApp/Views/InodeDetailView/inodeDetailNewSocialView","DS/W3DContentApp/BusEvent","DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/Utils/Alert","DS/W3DContentApp/Metas/inode","DS/W3DDrive/widget","DS/W3DContentApp/Utils/Store","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o,r,s,a,l,c,d,u,p,m){"use strict";let f,g,h,v,D,w;const b=d(),C=()=>{if(!w||!w.collection)return!1;return w.collection.filter((e=>!e.isFolder())).length>1};function S(e){const t=new n((t=>{requestAnimationFrame((()=>{const n=g.$refs.lightboxInformationPanel,i=n.firstChild;n&&i&&(n.replaceChild(e.container,i),requestAnimationFrame((()=>{i.destroy()}))),t()}))})),i=new n((t=>{requestAnimationFrame((()=>{e.render(),t()}))}));return e.container.classList.add("lightbox__preview-properties"),n.all([t,i])}return{init:function(d={}){if(!d.viewSpecs||!d.inode)throw new Error("Missing input");function y(e,t){return new s({model:e,focusComment:t})}function A(e){const t=["inode-detail-properties","inode-detail-history","inode-detail-accesses","inode-detail-access-link"],n=JSON.parse(JSON.stringify(f));return n.detailViewSpecs.detailViewsList.forEach((e=>{const t=f.detailViewSpecs.detailViewsList.find((t=>t.key===e.key));e.view=t.view})),n.detailViewSpecs.detailViewsList=n.detailViewSpecs.detailViewsList.filter((e=>t.includes(e.key))),new o({model:e,viewSpecs:n.detailViewSpecs})}f=d.viewSpecs,w=d.inode,D=r.init(),w&&!w.drive.isDrivesHubDrive&&w.getActionIds().includes("comment")&&(h=y(w)),v=A();const W=function(){const n="vue-lightbox";let o;document.getElementById(n)||(o=document.createElement("div"),o.id=n,u.getValue("isStandalone")?document.body.prepend(o):document.body.querySelector(".w3ddrive.panel-slider").parentElement.appendChild(o));const s=e=>[{name:"edit-document",fonticon:"pencil",label:m.get("EditDocument"),hidden:!0},{name:"save-document",fonticon:"floppy",label:m.get("Save"),hidden:!0},{name:"comment",fonticon:"comment",label:m.get("Comments"),hidden:!0,selected:!1},{name:"share",fonticon:"share-alt",label:m.get("share"),hidden:!0,handler:()=>{const t=e.availableActions.find((e=>["share","shareContent"].includes(e.name)));t&&t.handler()}},{name:"download",fonticon:"download",label:m.get("Download"),hidden:!0,handler:()=>{const t=e.availableActions.find((e=>"download"===e.name));t&&t.handler()}},{name:"information",fonticon:"info",label:m.get("Information")}],d=()=>C()?[{name:"previous",fonticon:"chevron-left",label:m.get("Previous"),disabled:!1},{name:"next",fonticon:"chevron-right",label:m.get("Next"),disabled:!1}]:[];return g=new e({el:"#"+n,template:t,data(){return{show:!0,isWidget:!u.getValue("isStandalone"),title:"",mediaType:"picture",availableActions:[],primaryActions:s(this),sideActions:d(),moreActionsLabel:m.get("More"),closeLabel:m.get("close"),panels:[{name:"comments",title:m.get("Comments"),show:!1,showClose:!0},{name:"information",title:m.get("Information"),show:!1,showClose:!0}],navigation:{previous:null,next:null}}},computed:{menuActions(){return this.availableActions.filter((e=>!this.primaryActions.find((t=>t.name===e.name||"shareContent"===e.name))))},isLightboxVisible(){return this.show},isCommentsPanelVisible(){return this.panels.find((e=>"comments"===e.name)).show}},methods:{refreshTitle(){this.title=w.get("alias")||w.get("title"),w&&w.drive&&w.drive.isCollabSpace?this.mediaType=w.get("type")&&"Document"===w.get("type").name?"document":"3dmodel":this.mediaType=w?b.mediaType[w.get("fileExtension")]:"picture"},toggleVisibility(e){this.show=void 0!==e?e:!this.show},refreshContent(e){null!=this.navigation[e]&&(a.dispatchEvent("lightbox:onArrowClick",[this.navigation[e]]),this.refreshNavigation())},refreshNavigation(){if(C()){const e=w.collection,t=e.get(w),n=e.indexOf(t),i=e.length>n-1?e.at(n-1):null,o=e.length>n+1?e.at(n+1):null;this.navigation.previous=i&&!i.isFolder()?i.drive.getInodePreviewURI(i):null,this.navigation.next=o&&!o.isFolder()?o.drive.getInodePreviewURI(o):null,this.sideActions[0].disabled=!i||i.isFolder(),this.sideActions[1].disabled=!o||o.isFolder()}},refreshActions(){this.$data.primaryActions=s(this),this.$data.sideActions=d();let e=new i({model:w,context:"lightbox"}).toJSON();const t=["viewInformation","preview","delete","deleteContent","deletefinal","moveTo","openWith","moveToCS","update","removeOwnAccess","openFileLocation","editDocument"];e=e.filter((e=>!t.find((t=>t===e.id))));const n=[];if(e.forEach((e=>{n.push({name:e.id,fonticon:e.fonticon,text:e.text,handler:e.handler})})),w.isPlayable()&&n.push({name:"play-360",fonticon:"media-360",text:m.get("play"),handler:()=>{a.dispatchEvent("lightbox:onPlay",[w])}}),this.availableActions=n,this.availableActions.find((e=>["share","shareContent"].includes(e.name)))&&(this.primaryActions.find((e=>"share"===e.name)).hidden=!1),this.availableActions.find((e=>"download"===e.name))&&(this.primaryActions.find((e=>"download"===e.name)).hidden=!1),w.getActionIds().includes("comment")){const e=this.primaryActions.find((e=>"comment"===e.name));e.hidden=!1;const t=this.panels.find((e=>"comments"===e.name));e.selected=t.show}const o=this.primaryActions.find((e=>"information"===e.name)),r=this.panels.find((e=>"information"===e.name));o.selected=r.show;const c=this.primaryActions.find((e=>"edit-document"===e.name)),u=this.primaryActions.find((e=>"save-document"===e.name)),f=["edit","edit_share"].includes(w.get("accessright"));p.features.isODEFeatureAvailable&&f&&l.isOfficeDocumentSupported(w.get("fileExtension"))&&(w.editMode?(c.hidden=!0,u.hidden=!1):c.hidden=!1)},toggleInformationPanel(e){const t=this.panels.find((e=>"comments"===e.name)),n=this.primaryActions.find((e=>"comment"===e.name));t.show=!1,n.selected=!1;const i=this.panels.find((e=>"information"===e.name)),o=this.primaryActions.find((e=>"information"===e.name));"boolean"==typeof e&&e||!i.show?(i.show=!0,o.selected=!0):(i.show=!1,o.selected=!1)},comments(e){const t=this.panels.find((e=>"information"===e.name)),n=this.primaryActions.find((e=>"information"===e.name));t.show=!1,n.selected=!1;const i=this.panels.find((e=>"comments"===e.name)),o=this.primaryActions.find((e=>"comment"===e.name));"boolean"==typeof e&&e||!i.show?(i.show=!0,o.selected=!0):(i.show=!1,o.selected=!1)},editDocument(){l.isAndroidOrIphone()?c.add({message:m.get("ODdisabledActions"),className:"primary"}):(this.primaryActions.find((e=>"edit-document"===e.name)).hidden=!0,this.primaryActions.find((e=>"save-document"===e.name)).hidden=!1,r.getPreviewOfficeDocument().launchInEditMode())},saveDocument(){r.getPreviewOfficeDocument().saveDocument()},closeLightbox(){const e=()=>{this.panels.forEach((e=>e.show=!1)),this.toggleVisibility(),a.dispatchEvent("lightbox:onCancelClick",[w.drive.getInodePanelContentURI(w.collection?w.collection.dot():null)])};p.features.isODEFeatureAvailable&&l.isOfficeDocumentSupported(w.get("fileExtension"))?r.getPreviewOfficeDocument().closeDocument().then((()=>{e()})):e()},toggleSaveButtonState(e){this.primaryActions.find((e=>"save-document"===e.name)).disabled=!e}},mounted(){this.$nextTick((()=>{this.$refs.lightboxContent.appendChild(D),w&&!w.drive.isDrivesHubDrive&&w.getActionIds().includes("comment")&&this.$refs.lightboxCommentsPanel.appendChild(h.container),this.$refs.lightboxInformationPanel.appendChild(v.container)}))}}),o}();return Object.assign(W,{refresh:function(e={}){g.toggleVisibility(!0);const t=!!e.inode&&w.id===e.inode.id;if(w=e.inode,!Boolean(w)&&!0!==e.force)return;const i={"onChange:title":()=>{g&&g.isLightboxVisible&&g.refreshTitle()},"onChange:actions":e=>{g&&g.isLightboxVisible&&g.refreshActions(),s(e)},"onChange:fileExtension":()=>{const e=l.isOfficeDocumentSupported(w.get("fileExtension"));(!e||e&&!w.editMode)&&D.refresh(w)}},o=w.collection,r={onSync:()=>{g.refreshActions(),g.refreshNavigation()}};function s(e){if(e&&!e.drive.isDrivesHubDrive&&e.getActionIds().includes("comment")){const i=!!t&&Boolean(l.getQueryHashParameter("content","commentURI"));h=y(e,i),function(e){const t=new n((t=>{requestAnimationFrame((()=>{const n=g.$refs.lightboxCommentsPanel,i=n.firstChild;n&&(i?(n.replaceChild(e.container,i),requestAnimationFrame((()=>{i.destroy()}))):n.appendChild(e.container)),t()}))})),i=new n((t=>{requestAnimationFrame((()=>{e.render(),t()}))}));return e.container.classList.add("lightbox__preview-properties"),n.all([t,i])}(h).then((()=>{i&&g.comments(!0)}))}}w.addEvents(i),o&&o.addEvents(r),s(w),v=A(w),function(){S.apply(this,arguments).then((()=>{}))}(v),D.refresh(w,null,e),g.refreshTitle(),g.refreshActions(),g.refreshNavigation(),document.addEventListener("enableSaveButton",(()=>{g.toggleSaveButtonState(!0)})),document.addEventListener("disableSaveButton",(()=>{g.toggleSaveButtonState(!1)}))},updatePreviewBody:(e,t)=>{D.refresh(e,t)},hideLightbox:()=>{g.toggleVisibility(!1),r.hidePreviewBody()},isLightboxVisible:()=>g&&g.isLightboxVisible,getCommentsPanel:()=>h,showCommentsPanel:e=>g&&g.comments(e),isCommentsPanelVisible:()=>g&&g.isCommentsPanelVisible,getContainer:()=>g})}}})),define("DS/W3DContentApp/Collections/DriveTreeDocument",["UWA/Core","DS/TreeModel/TreeDocument","DS/W3DContentApp/Models/DriveTreeNodeModel"],(function(e,t,n){"use strict";return function(i={}){const o=new t(e.merge(i,{useAsyncPreExpand:!1,shouldAcceptDrop:function(){return!1}})),r=o._getTrueRoot();function s(e,t){var n;return t||(t=r),[].concat(t.getChildren()).some((function(t){if(t&&t.inode===e)return n=t,!0})),n}return Object.assign(o,{searchWithInode:s,buildNodesPath:function(e,t,i={}){const a=e.slice(),l=a.shift();t||(t=r);const c=(i.hiddenRootInodes||[]).includes(l&&l.id);if(!e.length||c)return[t];let d=s(l,t);return d||(d=new n({inode:l,hiddenRootInodes:i.hiddenRootInodes}),t.addChild(d)),[d].concat(o.buildNodesPath(a,d,{hiddenRootInodes:i.hiddenRootInodes}))}})}})),define("DS/W3DContentApp/Views/DriveView/driveTreeViewWithDocument",["DS/W3DContentApp/Metas/inode","DS/W3DContentApp/Collections/DriveTreeDocument","DS/W3DContentApp/Views/DriveView/driveTreeView","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n){"use strict";const i=e();return function(e={}){const o=new t({hiddenRootInodes:e.hiddenRootInodes}),r=n({treeDocument:o,model:e&&e.model?e.model:null,conf:e.conf&&e.conf.treeView});return Object.assign(r,{expandInodesPath:function(t,n=!0){if(!t.length)return;const s=o.buildNodesPath(t,null,e),a=s[0];return a&&a.inode&&a.inode.id===i.ids.trueRoot?r.container.addClassName("with-true-root"):r.container.removeClassName("with-true-root"),n&&r.reverseExpand(s[s.length-1]),s}})}})),define("DS/W3DContentApp/Views/InodePanelView/inodeTableScrollViewFunc",["DS/W3DContentApp/Utils/dropdownContextmenu"],(function(e){"use strict";return{createActionsDD:function(t,n){if(!Array.isArray(t))throw new Error("Wrong type");var i=t.map((function(e){return{className:e.className||"",text:e.text||"",fonticon:e.icon,handler:e.handler&&n?e.handler.bind(n):null}})),o=n.container;return new e({className:"folder-contextmenu",target:o,items:i,removeOnHide:!1,contextual:!0})}}})),define("DS/W3DContentApp/Utils/dialogTree",["UWA/Core","DS/UIKIT/Scroller","DS/W3DContentApp/Views/DriveView/driveTreeViewWithDocument","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i){"use strict";return function(o,r={}){const s=n({hiddenRootInodes:r.hiddenRootInodes}),a=s.getXSO(),l=e.createElement("div",{class:"modal__content-tree-wrapper",html:s.container}),c=e.createElement("div",{class:"modal__content-tree",html:[l,e.createElement("span",{class:"form__message-error",text:" "})]});a.onAdd(function(e={}){return function(){const t=e.xso,n=e.modalContentTree,o=e.excludeInodes||[];var r=function(e){return e.get().map((e=>e.inode))}(t),s=n.querySelector(".form__message-error"),a=n.parentElement.parentElement.querySelector(".js-validation-button"),l=r.reduce((function(e,t){return e&&function(e,t=[]){return"myCollabSpaces"!==e.get("id")&&!t.includes(e.get("id"))}(t,o)}),!0);l||function(e,t){if(!e||!t)return;widget.getValue("is3DSpaceWidget")?e.textContent=i.get("operationNotPossibleOnCS",{CSname:t.get("title")}):e.textContent=i.get("operationNotPossibleOnFolder",{name:t.get("title")})}(s,r[0]);var c=l;c&&e.checkForm&&(c=e.checkForm(!0)),function(e,t){if(!e)return;e.classList.toggle("disabled",t)}(a,!c),function(e,t){if(!e)return;e.classList.toggle("form__message-error--active",t)}(s,!l)}}({xso:a,modalContentTree:c,excludeInodes:r.excludeInodes,checkForm:r.checkForm}));const d=new t({element:l});return o.forEach((function(e,t){const n=!e.isContainer();n&&(e=e.collection.dot()),e.drive.getInodesPath(r.inodeFrom,e).then((function(e){const i=s.expandInodesPath(e,0===t);if(!i||!i.length)return;const o=i[i.length-1];if(n)if("myCollabSpaces"===o.inode.get("parentId")){o.hide();var r=o._parentNode.getChildren(),a=["VPLMProjectLeader","VPLMCreator"];r.map((function(e){var t=e.inode.get("contexts")[0].role?e.inode.get("contexts")[0].role:e.inode.get("contexts")[1].split(".")[0];-1===a.indexOf(t)&&e.hide()}))}else n&&0===t&&o.expand();else o.hide()}))})),{xso:a,scroller:d,treeView:s,modalContentTree:c}}})),define("DS/W3DContentApp/Utils/Actions/moveAndCopy",["UWA/Core","DS/W3DDrive/Metas/DSDrive/inode","DS/W3DContentApp/Utils/drivesInputs","DS/W3DContentApp/Utils/dialogTree","DS/W3DContentApp/Utils/formFactory","DS/W3DContentApp/Views/SuperModal","DS/W3DDrive/Utils/StructureNavigation","DS/UIKIT/Input/Toggle","i18n!DS/W3DContentApp/assets/nls/W3DContentApp"],(function(e,t,n,i,o,r,s,a,l){"use strict";const c=t();let d;return function(t,p={}){const m=[].concat(t);p.excludeInodes=function(e,t={}){if(!e||!e.length)return[];const n=[c.ids.sharedWithMe,c.ids.recents,c.ids.favorites,c.ids.trash];t.duplicate||e.forEach((e=>{const t=e.collection.dot();t&&n.push(t.get("id"))}));return n}(m,p),p.hiddenRootInodes=[c.ids.recents,c.ids.favorites,c.ids.trash];let f="",g="",h="";const v=[];let D=!1;const w={};if(p.duplicate)f=l.get("copy"),h=l.get("copy"),v.push({label:l.get("copyLinkedFiles")}),v.push({label:l.get("copyFileOnly")});else if(p.restore){f=l.get("restore"),g=l.replace(1===p.errorCode?l.get("restoreNotAvailableParent"):l.get("restoreNotUniqueName"),{name:t.get("title")}),h=l.get("restore"),p.checkForm=function(e){e&&(D=!0);var n=document.getElementById("inputName"),i=u(y.xso);return"true"===n.getAttribute("validity")&&""!==n.value&&(2!==p.errorCode||n.value!==t.get("title")||i[0].id!==t.get("oldparentid"))&&(d=n.value,!0)};const i=n(t),r=i.maxchars;var b=o.createTextInput(Object.assign({pattern:i.forbiddenChars.regex,required:!0,title:i.forbiddenChars.text||"",value:t.get("title"),id:"inputName"},r)),C=o.createTextError({text:i.forbiddenChars.text}),S={chars:i.forbiddenChars.text,maxLengthText:r?r.maxLengthText:void 0};b.classList.add("modal_inputName"),b.setAttribute("validity",!0),b.onkeyup=function(){b.setAttribute("validity",this.checkValidity()),o.onCheckInput(r.maxLength,b,C,S,".js-validation-button");var e=b.parentElement.parentElement.parentElement.querySelector(".js-validation-button");D&&p.checkForm()?e.classList.remove("disabled"):e.classList.add("disabled")},w.modalNewTitle=b,w.header=e.createElement("div",{html:g,class:"shareview__header-text"}),w.textErrorInputName=C}else f=1===m.length?l.get("move"):l.get("moveElems",{count:m.length}),h=l.get("move"),v.push({label:l.get("moveLinkedFiles")}),v.push({label:l.get("moveFileOnly")});let y=i(m,p);if(!p.restore&&s.isLinkedFile(t)){const e=function(e={}){if(!e.toggleItems)throw new Error("You must specify a valid options object with a toggleItems properties");const t=e.toggleItems,n={name:"transfertType",className:"primary"},i=new a(Object.assign({},n,{value:"all",label:t[0].label})).check(),o=new a(Object.assign({},n,{value:"one",label:t[1].label}));var r=document.createElement("div");return r.appendChild(i.elements.container),r.appendChild(o.elements.container),{container:r,toggleLinked:i,toggleOne:o}}({toggleItems:v});y=Object.assign(y,e),y.modalContentTree.appendChild(y.container)}const A=Object.assign({},w,y);r.dialog({title:f,body:[A.header,A.modalNewTitle,A.textErrorInputName,A.modalContentTree],buttons:[{className:"primary js-validation-button",value:h,action:function(e){e.hide(),function(e){const t=e.model,n=e.components,i=e.dispatchEvent,o=e.callback,r=e.fallback,s={data:{}};n.toggleLinked&&n.toggleLinked.isChecked()&&(s.queryStrings={expand:"true"});const a=u(n.xso);if(s.data.parentid=a[0].id,e.duplicate)return void i("onCopy",[t,a[0],s]);if(e.restore)return void t.restore({parentid:a[0].id,title:d}).then(o,r);s.itemView=e.itemView,i("onMove",[t].concat(a[0],s))}(Object.assign({},{model:t,components:y},p))}},{value:l.get("cancel"),action:function(e){e.hide()}}]});const W=r.modals.current.elements;W.footer.getElement(".js-validation-button").addClassName("disabled"),W.scroller=A.scroller,W.treeView=A.treeView};function u(e){return e.get().map((function(e){return e.inode}))}})),define("DS/W3DContentApp/Views/DriveView/driveView",["DS/W3DContentApp/Views/DriveView/driveItemView","DS/W3DContentApp/Views/DriveView/driveTreeViewWithDocument","DS/W3DContentApp/Views/DriveView/driveViewPattern","DS/W3DContentApp/BusEvent"],(function(e,t,n,i){"use strict";return function(o={}){var r=o.model,s=e({model:r}),a=t(o),l=n({model:r,header:s,authenticatedBody:a}),c=a.getXSO();return c.onAdd((function(){var e=c.get().filter((function(e){return e.isSelectionChangeFromUI()}));e.length&&i.dispatchEvent("driveView:onNodeClick",e.map((function(e){return e.inode})))})),Object.assign(l,{refreshSelected:s.refreshSelected,expandInodesPath:a.expandInodesPath,toggleExpand:s.toggleExpand,expand:s.expand,collapse:s.collapse})}})),define("DS/W3DContentApp/Views/InodePanelView/inodeTableScrollView",["DS/W3DXComponents/Views/Layout/ScrollView","DS/W3DContentApp/Views/InodePanelView/inodeTableScrollViewFunc","DS/W3DContentApp/Metas/inode","DS/W3DContentApp/Views/InodePanelView/inodeTableView","DS/W3DContentApp/Views/InodePanelView/inodeTableViewFunc","DS/W3DContentApp/BusEvent","DS/W3DContentApp/Utils/Alert","DS/W3DDrive/InodeActions","DS/UIKIT/Spinner","UWA/Utils/Client","DS/W3DContentApp/Utils/EventHelpers","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o,r,s,a,l,c,d,u){"use strict";const p=n();return function(n){if(!n||!n.inode||!n.viewSpecs)throw new Error("Missing input");const m=n.inode,f=n.viewSpecs;if(!m.isContainer())throw new Error("The inode should be a container");let g=!1,h=m.inodeTable;const v=()=>m.isAtLeastOneActionIdOk([p.actionPubIds.upload,p.actionPubIds.uploadFolder,p.actionPubIds.addContent]),D=m.configuration&&m.configuration.emptyView;let w=function(e={}){return e.emptyView?e.emptyView({isDnD:e.isDnd,icon:e.icon,title:e.title}):o.getEmptyView(e.icon,e.title)}({isDnd:v(),emptyView:f.contentViewSpecs&&f.contentViewSpecs.emptyView,icon:D&&D.icon,title:D&&D.title}),b=i({collection:h,emptyView:w,filterType:f.contentViewSpecs&&f.contentViewSpecs.filterType,sorting:f.sorting}),C=new e({view:b,usePullToRefresh:!1,events:{onInfiniteScroll:function(){"function"==typeof h.hasNextPage&&h.hasNextPage()?r.dispatchEvent("inodeTableScrollView:onNextPage",[h]):C.useInfiniteScroll(!1)}}});const S=e=>{const t=new a({model:e}).toJSON(),n=t.find((e=>"uploadFolder"===e.id)),i=c.Platform.ios||c.Platform.android||c.Platform.ipad||c.Platform.tablet;return n&&i&&t.splice(t.findIndex((e=>"uploadFolder"===e.id)),1),t},y=e=>{C.container.click(),C.dropdownMenu.show(!1,e)};let A=new l;const W=C.render,I=C.destroy;return C.container.classList.add("inode-table-scroll"),C.container.classList.add("w3ddrive"),C.listenTo(m,{"onChange:actions":function(e,n){n&&(v()&&(x(),w.toggleDnDView&&w.toggleDnDView(!0)),this.dropdownMenu&&(this.dropdownMenu=null,delete this.dropdownMenu,this.container.removeEventListener("contextmenu",y)),n.length&&(this.dropdownMenu=t.createActionsDD(S(m),this),this.container.addEventListener("contextmenu",y)))}}),C.listenTo(h,{onRequest:function(e){e._models&&V(!0)},onSync:function(){g&&(C.endLoading(),V(!1),C.useInfiniteScroll(!0))},onReset:function(){V(!0)},onError:function(){V(!1)}}),x(),Object.assign(C,{render:function(){return this.container.empty(),W.apply(this,arguments),A.inject(this.container,"top"),g=!0,this.dropdownMenu=t.createActionsDD(S(m),C),C.container.addEventListener("contextmenu",y),this},destroy:function(){g=!1,w&&(w.destroy(),w=null),C&&(I.apply(C,arguments),C.container.removeEvents(),C.stopListening(),C.container=null,C=null),A&&(A.destroy(),A=null),h=null}});function E(e){b._toggleElement(w.container,e)}function x(){C.container.removeEvents();const e=m.isAtLeastOneActionIdOk([p.actionPubIds.upload,p.actionPubIds.uploadFolder,p.actionPubIds.addContent]);C.container.addEvent("dragenter",(function(t){d.hasFilesType(t.dataTransfer)&&e&&(C.container.classList.add("drag-over"),E(!0),t.preventDefault())})),C.container.addEvent("dragover",(function(t){t.preventDefault(),(d.hasFilesType(t.dataTransfer)||m.enableDrop(t.dataTransfer.types))&&e||(t.dataTransfer.dropEffect="none")})),C.container.addEvent("dragleave",(function(e){d.hasFilesType(e.dataTransfer)&&(e.currentTarget.contains(e.relatedTarget)||(C.container.classList.remove("drag-over"),E(b.visibleItems&&!b.visibleItems.length),e.preventDefault()))})),C.container.addEvent("drop",(function(t){if(t.preventDefault(),C.container.classList.remove("drag-over"),E(!1),m.drive.get("blockactions"))return void s.add({message:u.get("allocatedSpaceExceeded"),className:"warning"});if(!e){E(0===h.length);const e=m&&m.drive&&m.drive.get("blockactions")?u.get("allocatedSpaceExceeded"):u.get("permissionUploadForbidden");return void s.add({className:"error",message:e})}const n=t.dataTransfer,i=d.getFiles(n),o=i.length,a=n.items.length;o>0&&r.dispatchEvent("inodeScrollTableView:onDrop",[h,i]),o<a&&r.dispatchEvent("inodeScrollTableView:onFolderDrop",[m,n])}))}function V(e){e?(C.container.addClassName("loading"),A.show()):(C&&C.container&&C.container.removeClassName("loading"),A&&A.hide())}}})),define("DS/W3DContentApp/Views/DrivesPanelView/drivesView",["DS/WebAppsFoundations/Views/CollectionView","DS/W3DContentApp/Views/setOfSelectedItemView","DS/W3DContentApp/Views/DriveView/driveView","DS/W3DContentApp/BusEvent","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i){"use strict";return function(o={}){const r=o.collection,s=new e({className:"w3ddrive drives",collection:r,filterer:function(e){return e.get("granted")}}),a=t();function l(){s.children.forEach((e=>{e.collapse()})),a.forEach((e=>{e.expand()}))}return s.listenTo(r,"onChange:granted",s.filter),s.listenTo(r,"onChange:authenticated",(function(e){const t=s.findChildViewByModel(e);a.contains(t)&&!e.get("authenticated")&&a.remove(t)})),s.listenTo(a,{onAdd:l,onReset:l,onRemove:l}),s.listenTo(i,"driveView:onClick",(function(e){const t=s.findChildViewByModel(e);a.contains(t)?t.toggleExpand():i.dispatchEvent("drivesView:onWannaChangeSelection",[e])})),Object.assign(s,{_buildItemView:function(e){return n({model:e,conf:o.conf})},selectedChildren:a})}})),define("DS/W3DContentApp/Views/InodePanelView/inodePanelViewFunc",["UWA/Class/View","DS/W3DContentApp/Views/InodeDetailView/inodeDetailView","DS/W3DContentApp/Views/InodePanelView/inodeTableScrollView","DS/W3DContentApp/Views/InodePanelView/inodeTopBarView","DS/W3DDrive/widget"],(function(e,t,n,i,o){"use strict";var r=Object.freeze({multiSelection:"inode-panel--multi-select-active",ctrlSelection:"inode-panel--ctrl-select-active",shiftSelection:"inode-panel--shift-select-active",item:"inode-item",focusedItem:"inode-item--focused",selectedItem:"selected"});function s(e,t,n){if(!e||!t)throw new Error("you must specify valid classList and className");return e.contains(t)?!n&&(e.remove(t),!0):!1!==n&&(e.add(t),!0)}function a(e){return!(!e||!e.classList)&&e.classList.contains(r.multiSelection)}function l(e){return!(!e||!e.classList)&&e.classList.contains(r.ctrlSelection)}function c(e){return!(!e||!e.classList)&&e.classList.contains(r.shiftSelection)}function d(e){if(!e)return[];var t=r.selectedItem;return Array.prototype.slice.call(e.querySelectorAll("."+t))}function u(e,t){if(e&&e.dataset&&t&&t.get)return t.get(e.dataset.model_cid)}function p(e){if(!e||!e.classList)throw new Error("you must specify a valid elem");return e.classList.contains(r.selectedItem)}function m(e,t){if(!e||!e.classList)throw new Error("you must specify a valid elem");return s(e.classList,r.selectedItem,t)}function f(e){if(!e||!e.classList)throw new Error("you must specify a valid target");var t,n=e.parentElement;n&&(t=n.querySelector("."+r.focusedItem)),e.classList.add(r.focusedItem),t&&t!==e&&t.classList.remove(r.focusedItem)}function g(e){if(!e)return[];var t=r.item;return Array.prototype.map.call(e.querySelectorAll("."+t),(function(e){return m(e,!1)&&e}))}return{isMultiSelectionModeActive:a,isShifSelectionModeActive:c,toggleCtrlSelectionMode:function(e,t){if(!e||!e.classList)throw new Error("you must specify a valid target");return s(e.classList,r.ctrlSelection,t)},isCtrlSelectionModeActive:l,toggleMultiSelectionMode:function(e,t){if(!e||!e.classList)throw new Error("you must specify a valid target");return s(e.classList,r.multiSelection,t)},toggleShiftSelectionMode:function(e,t){if(!e||!e.classList)throw new Error("you must specify a valid target");return s(e.classList,r.shiftSelection,t)},isElemSelected:p,getSelectedOf:d,getFirstSelectedOf:function(e){if(e)return e.querySelector("."+r.selectedItem)},getModelOf:u,getElemOf:function(e,t){if(t&&e)return e.querySelector("."+r.item+'[data-model_cid="'+t.cid+'"]')},getSelectedModelsOf:function(e,t){return d(e).map((function(e){return u(e,t)})).filter((function(e){return Boolean(e)}))},selectAll:function(e){return e?Array.prototype.filter.call(e.querySelectorAll("."+r.item),(function(e){return e.offsetParent})).map((function(e){return m(e,!0)&&e})):[]},unSelectAll:g,selectAmongItems:function(e,t,n){if(e){if(!c(t))return a(t)||l(t)?(m(e,n),void f(e)):void function(e,t){if(e){var n=e.parentElement,i=p(e),o=[];n&&(o=g(n).filter((function(e){return e}))),m(e,o.length>1||!i||Boolean(t)),f(e)}}(e,n);!function(e){if(e){var t=e.parentElement;if(t){var n=t.querySelector("."+r.focusedItem),i=Array.prototype.slice.call(t.querySelectorAll("."+r.item)),o=i.indexOf(n),s=i.indexOf(e),a=Math.min(o,s),l=Math.max(o,s);for(g(t);a<=l;)m(i[a],!0),a+=1}}}(e)}},createTopBar:function(e,t){var n=i({model:e,viewSpecs:t});return n.container.classList.add("inode-panel__top-bar"),n},createDetail:function(e,n){var i=t({model:e,headerOptions:{onClickCloseIcon:function(){o.dispatchEvent("onToggleInodePanelSideBarVisibility")}},viewSpecs:n});return i.container.classList.add("inode-panel__detail"),i},refreshDetailWithView:function(e,t,n){if(e.classList.contains("inode-panel__detail")||(e=e.querySelector(".inode-panel__detail")),e&&e!==t.container){var i=e.parentNode;return i.removeChild(e),i.appendChild(t.container),t.render(),n.refreshInnerDrawer(),t}},createContent:function(e,t){var i=n({inode:e,viewSpecs:t});return i.container.classList.add("inode-panel__content"),i},wrapSideBar:function(e){var t=document.createElement("div");return t.classList.add("inode-panel__side-bar"),e&&t.appendChild(e),t},getView:function(t){return new e(Object.assign({className:"inode-panel w3ddrive",attributes:{cid:t.model.cid}},t))},refreshSideBar:function(e,t,n,i){var r;r=o.getValue("is3DSpaceWidget")?n?399:0:n?293:0,t[i?"translateNoAnim":"translateAnim"](r),e.style["margin-right"]=r+"px"}}})),define("DS/W3DContentApp/Views/DrivesPanelView/drivesScrollView",["DS/W3DContentApp/Views/DrivesPanelView/drivesView","DS/W3DXComponents/Views/Layout/ScrollView","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t){"use strict";return function(n={}){const i=e({collection:n.collection,conf:n.conf}),o=new t({className:"w3ddrive drives-scroll",useInfiniteScroll:!1,usePullToRefresh:!1,view:i});return Object.assign(o,{selectedChildren:i.selectedChildren,children:i.children,findChildViewByModel:i.findChildViewByModel})}})),define("DS/W3DContentApp/Views/InodePanelView/inodePanelView",["UWA/Utils","UWA/Core","DS/W3DDrive/InodeActions","DS/W3DDrive/inodesActions","DS/W3DDrive/Utils/CompassHelpers","DS/W3DContentApp/Utils/drawerOrchestrator","DS/W3DContentApp/Utils/getKeyboardeventKey","DS/W3DContentApp/Views/InodePanelView/inodePanelViewFunc","DS/W3DContentApp/BusEvent","DS/W3DContentApp/SearchProxy","DS/W3DContentApp/Utils/Tagger6WProxy","DS/W3DDrive/widget","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o,r,s,a,l,c,d,u){"use strict";const p="inode-panel__content--responsive",m="side-bar--responsive",f="action-bar--responsive";function g(e){return a.toggleMultiSelectionMode(document.querySelector(".inode-panel"),e)}function h(e){return a.toggleCtrlSelectionMode(document.querySelector(".inode-panel"),e)}function v(e){return a.toggleShiftSelectionMode(document.querySelector(".inode-panel"),e)}function D(){return a.selectAll(document.querySelector(".inode-table"))}function w(){return a.unSelectAll(document.querySelector(".inode-table"))}function b(e,t){return a.selectAmongItems(e,document.querySelector(".inode-panel"),t)}function C(){a.getSelectedOf(document.querySelector(".inode-table")).length>1?g(!0):g(!1)}function S(e){"Control"===s(e)?(h(),C(),document.removeEventListener("keyup",S),document.removeEventListener("keydown",A)):document.addEventListener("keydown",A)}function y(e){"Shift"===s(e)&&(v(!1),C(),document.removeEventListener("keyup",y))}function A(e){const t=s(e);var n;if("Control"!==t&&(n=document.activeElement.nodeName,!["input","textarea"].some((e=>n.toLowerCase()===e)))&&(document.removeEventListener("keydown",A),"a"===t.toLowerCase())){const t=document.querySelector(".inode-panel");t.addClassName("multi-select--select-all"),t.click(),D(),l.dispatchEvent("inodePanelView:CtrlA"),e.preventDefault()}}function W(e){if(document.querySelector(".modal"))return;document.removeEventListener("keydown",W);const t=s(e);"Control"===t&&(h(!0),document.addEventListener("keyup",S),document.addEventListener("keydown",A)),"Shift"===t&&(v(!0),document.addEventListener("keyup",y))}function I(){document.addEventListener("keydown",W)}return(e=>{let t,n;document.body.addEventListener("click",(e=>{const i=e.target;if(i)return i&&i.parentElement&&i.parentElement.classList.contains("inode-item")&&i.classList.contains("item__selection_icon")?(a.isElemSelected(i.parentElement)||g(!0),void b(i.parentElement)):i&&i.classList.contains("inode-item")&&t!==i?(clearTimeout(n),t=i,n=setTimeout((()=>{t=null}),510),void b(i)):i.classList.contains("breadcrumb__elem-title")?(l.dispatchEvent("inodePanelView:onPathClick",[i.getAttribute("href")]),void e.preventDefault()):void((i.classList.contains("iconbar__item--select-on")||i.parentElement&&i.parentElement.classList.contains("iconbar__item--select-on"))&&(document.querySelector(".inode-panel").removeClassName("multi-select--select-all"),g(),l.dispatchEvent("inodePanelView:ontoggleMultiSelectionMode")))}))})(),function(s){if(!s||!s.viewSpecs||!s.model)throw new Error("Missing input");const h=s.model,v=h.inodeTable,C=s.viewSpecs,S=a.getView(s),y=S.destroy;let A,E,x,V=!1;S.elements.topBarView=a.createTopBar(h,C),S.elements.detailView=a.createDetail(h,C.detailViewSpecs),S.elements.contentView=a.createContent(h,C),S.elements.detailViewWrapper=a.wrapSideBar(S.elements.detailView.container);const T=h&&h.configuration;let _,L,P;(!T||(T.canMultiselect||void 0===T.canMultiselect))&&(document.addEventListener("keyup",I),document.addEventListener("keydown",W));const U=C.contentViewSpecs;if(U&&U.quotaExceededView){const e=U.quotaExceededView;P=new e({inode:h,container:S.container,contentView:S})}function O(e){const t=S.elements&&S.elements.topBarView;if(!t)return null;e||(e=a.getSelectedModelsOf(document.querySelector(".inode-table"),v));const o=1===e.length?new n({model:e[0],context:"topbar"}).toJSON():i.getActionsJSON(e);return t.refreshIconBarActions(o)}function N(t,o={}){const r=document.querySelector(".inode-table");let s;s=t&&a.isElemSelected(t)?t:a.getFirstSelectedOf(r),s=a.getModelOf(s,v)||h;const c=a.getSelectedModelsOf(r,v);!function(e){const t=S.elements&&S.elements.topBarView;t&&t.toggleNewButtonState(e)}(!c.length>0),e.setImmediate((()=>{O(c)})),e.setImmediate((()=>{u.getValue("isInodePanelSideBarOpened")&&function(t){const n=S.elements&&S.elements.detailView;n&&e.setImmediate((()=>{n.destroy()})),S.elements.detailView=a.createDetail(t,C.detailViewSpecs),a.refreshDetailWithView(S.container,S.elements.detailView,A)}(s)}));if((o.previousSelectedModels||[]).forEach((e=>{e.dispatchEvent("inodeItemView:toggleActionsElemVisibility",e.getActionIds()&&e.getActionIds().length>0)})),t){const e=a.getModelOf(t,v);e.dispatchEvent("inodeItemView:toggleActionsElemVisibility",e.getActionIds()&&e.getActionIds().length>0)}const d=1===c.length?new n({model:c[0],context:"item-view"}).toJSON():i.getActionsJSON(c);c.forEach((e=>{e.dispatchEvent("inodeItemView:toggleActionsElemVisibility",d.length>0)})),l.dispatchEvent("inodePaneView:onChangeSelection",[s,c])}function k(){const e=a.getSelectedModelsOf(document.querySelector(".inode-table"),v);w(),N(null,{previousSelectedModels:e})}function M(e){const t=e.target;if(t&&t.parentElement&&t.parentElement.classList.contains("list__header")&&t.classList.contains("item__selection_icon")){const e=a.getSelectedModelsOf(document.querySelector(".inode-table"),v);return g(!0),S.container.toggleClassName("multi-select--select-all"),S.container.hasClassName("multi-select--select-all")?D():w(),void N(null,{previousSelectedModels:e})}return t.classList.contains("inode-item")?(x=t,clearTimeout(L),_===t?(_=null,void l.dispatchEvent("inodeView:onDblClick",[a.getModelOf(t,v)])):(_=t,L=setTimeout((()=>{_=null}),500),void N(t))):t.classList.contains("item__selection_icon")?(x=t.parentElement,void N(t.parentElement)):t.classList.contains("dropdown__item--select-all")||t.parentElement&&t.parentElement.classList.contains("dropdown__item--select-all")?(D(),g(!0),N(),void S.container.addClassName("multi-select--select-all")):void((t.classList.contains("dropdown__item--select-none")||t.parentElement&&t.parentElement.classList.contains("dropdown__item--select-none"))&&(k(),S.container.removeClassName("multi-select--select-all")))}function F(){const e=S.elements.contentView;k(),e.view.filter()}function R(e){const t=document.querySelector(".inode-table");return a.getElemOf(t,e)}function B(e,t=!0){const n=R(e);b(n,t),N(n)}const j=Object.assign(S,{render:function(){if(V)for(;S.container.firstChild;)S.container.removeChild(S.container.firstChild);else document.addEventListener("click",M),S.listenTo(v,{onRemove:e=>{const t=R(e);t&&!a.isElemSelected(t)||N()},onReset:()=>{N()},"onChange:actions":()=>{O(a.getSelectedModelsOf(document.querySelector(".inode-table"),v))}}),S.listenTo(l,{"inodePanelView:CtrlA":()=>{N()},"inodePanelView:ontoggleMultiSelectionMode":()=>{a.isMultiSelectionModeActive(document.querySelector(".inode-panel"))||k()},"inodePanelView:selectItemAmongItems":function(e,t={}){const n=Boolean(t.selectItemIfNoItemsSelected),i=Boolean(t.unselectAllItemsBefore),o=Boolean(t.scrollToItem),r=a.getSelectedModelsOf(document.querySelector(".inode-table"),v);if(i&&k(),n&&0===r.length||!n){B(e);const t=R(e);o&&t&&t.scrollIntoView({block:"nearest"})}}}),S.listenTo(u,{onInodePanelSideBarVisibilityToggled:e=>{a.refreshSideBar(S.elements.contentView.container,A,e),e&&x&&N(x)}}),S.listenTo(d,{onFilterSubjectsChange:()=>{F()}}),S.listenTo(c,{onSetQuery:e=>{F(),"true"!==u.getValue("is3DSpaceWidget")&&d.updateSubjectsTags(),"function"==typeof v.onSearch&&v.onSearch(e)},onResetQuery:()=>{F(),d.setSubjectsTags(v),"function"==typeof v.onSearch&&v.onSearch()}});const e=S.elements.topBarView,n=S.elements.contentView,i=S.elements.detailView,s=S.elements.detailViewWrapper;return[e.container,n.container,s].forEach((e=>{S.container.appendChild(e)})),S.container.addEvent("dragstart",(e=>{const n=document.querySelector(".inode-table");let i=[],r=[];i=a.getSelectedOf(n,v),r=a.getSelectedModelsOf(n,v);const s=document.querySelector(".w3ddrive.item:hover"),l=a.getModelOf(s,v);if(l&&!r.includes(l)&&(r.push(l),i.push(s)),r.length&&(i.forEach((e=>{e.classList.add("drag-start")})),e.dataTransfer.setData("text",JSON.stringify(o.get3DXContent(r))),e.dataTransfer.setData(r[0].getDragDataType(),""),r.length>1)){const n=function(e,n){const i=Math.min(n.getSize().width,200),o=t.createElement("div",{class:"drag-ghost-container",styles:{width:i},html:[{tag:"div",class:"drag-ghost-panel",html:[{tag:"div",class:"drag-ghost-title",styles:{width:i},text:e[0].get("title")}]},{tag:"span",class:"drag-ghost-counter",styles:{left:i},text:e.length}]});return document.body.appendChild(o),o}(r,e.target);e.dataTransfer.setDragImage(n,0,0)}})),S.container.addEvent("dragend",(e=>{e.target.classList.contains("drag-start")&&e.target.classList.remove("drag-start");const t=document.querySelector(".inode-table");let n=[],i=[];C.multisel&&(n=a.getSelectedOf(t,v),i=a.getSelectedModelsOf(t,v),i.length&&n.forEach((e=>{e.classList.contains("drag-start")&&e.classList.remove("drag-start")})));const o=document.getElementsByClassName("drag-ghost-container");o&&Array.prototype.forEach.call(o,(e=>{document.body.removeChild(e)}))})),A=null,A=r(s),a.refreshSideBar(n.container,A,u.getBool("isInodePanelSideBarOpened"),!0),e.render(),n.render(),i.render(),n.container.addEventListener("contextmenu",(()=>{k()})),V=!0,E=window.requestAnimationFrame((function e(){if(S&&S.container){if(function(e,t){if(!t.elements)return!1;const n=document.querySelector(".quota-alert-wrapper");e?(t.elements.detailViewWrapper.classList.add(m),t.elements.contentView.container.classList.add(p),null!==n&&n.hasChildNodes()?(t.elements.contentView.container.style.removeProperty("paddingTop"),n.classList.add("responsive_view"),t.elements.contentView.container.classList.add("quota_exceeded")):t.elements.contentView.container.classList.remove("quota_exceeded"),t.elements.topBarView&&t.elements.topBarView.container.childNodes[1]&&t.elements.topBarView.container.childNodes[1].classList.add(f)):(t.elements.detailViewWrapper.classList.remove(m),t.elements.contentView.container.classList.remove(p),null!==n&&n.hasChildNodes()?(n.classList.remove("responsive_view"),t.elements.contentView.container.classList.add("quota_exceeded")):t.elements.contentView.container.classList.remove("quota_exceeded"),t.elements.topBarView&&t.elements.topBarView.container.childNodes[1]&&t.elements.topBarView.container.childNodes[1].classList.remove(f))}(S.container.getBoundingClientRect().width<560,S),!V)return;setTimeout((()=>{E=window.requestAnimationFrame(e)}),500)}})),P&&P.render(),S},destroy:function(){document.removeEventListener("keyup",I),document.removeEventListener("keydown",W),S.stopListening(),S.undelegateDOMEvents(),document.removeEventListener("click",M),E&&window.cancelAnimationFrame(E),E=null,y.apply(S,arguments),V=!1,S.elements.topBarView=null,S.elements.contentView=null,S.elements.detailView=null,S.elements=null,S.container.empty(),S.container=null,P&&(P.destroy(),P=null)},getElementFromModel:R,handleItemSelection:B,refreshTopBarView:O});return j}})),define("DS/W3DContentApp/Views/DrivesPanelView/drivesPanelView",["UWA/Core","UWA/Class/View","UWA/Utils/Client","DS/UIKIT/Input/Button","DS/UIKIT/Tooltip","DS/W3DContentApp/Views/DrivesPanelView/drivesScrollView","DS/W3DDrive/widget","DS/W3DContentApp/BusEvent","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o,r,s,a,l){"use strict";return function(c={}){const d=c.collection,u=new t({className:"w3ddrive drives-panel"});let p;const m=u.destroy,f=r({collection:d,conf:c.conf}),g=[(()=>{const t=e.createElement("div",{class:"controller",html:[{tag:"span",class:"fonticon fonticon-close"}],events:{click:function(e){s.dispatchEvent("onToggleDrivePanelSideBarCollapsed"),e.stopPropagation()}}});return new o({target:t,body:l.get("close")}),t})(),f.container];let h;return!s.getValue("is3DSpaceWidget")&&n.Platform.windows&&(h=new i({value:l.get("checkingInstall"),className:"link block download-app",icon:"install"}),g.push(h.elements.container),require(["DS/i3DXCompassServices/i3DXCompassPubSub"],(function(e){const t=(e={})=>{e.icon&&h.setIcon(e.icon),h.setValue(e.nls),h.setClassName(e.style),h.elements.container.addClassName("btn-block download-app "+e.classVariation),h.elements.container.addEventListener("click",(()=>{a.dispatchEvent("driveActions:"+e.handler)}))};let n=setTimeout((()=>{t({nls:l.get("installNativeApp"),style:"primary",handler:"onInstallApp"})}),25e3);e.publish("detectInstallApp",{appId:"X3DDRVN_AP"},(e=>{clearTimeout(n),e&&!e.error?t({icon:"refresh",nls:l.get("configureNativeApp"),style:"default",classVariation:"transparent",handler:"onLaunchApp"}):e&&"recommended_update"===e.error?t({nls:l.get("updateInstallNativeApp"),style:"info",handler:"onInstallApp"}):e&&"mandatory_update"===e.error?t({nls:l.get("updateInstallNativeApp"),style:"warning",handler:"onInstallApp"}):t({nls:l.get("installNativeApp"),style:"default",handler:"onInstallApp"})}))}))),Object.assign(u,{selectedChildren:f.selectedChildren,children:f.children,findChildViewByModel:f.findChildViewByModel,render:function(){const e=u.container;if(p)for(;e.firstChild;)e.removeChild(e.firstChild);return e.setContent(g),f.render(),p=!0,u},destroy:function(){return f.destroy(),m.apply(u,arguments)}})}})),define("DS/W3DContentApp/w3DDriveView",["UWA/Class/View","DS/UIKIT/Mask","DS/W3DContentApp/Utils/Helpers","DS/W3DContentApp/Views/panelSlider","DS/W3DDrive/Utils/drives","DS/W3DContentApp/Views/DrivesPanelView/drivesPanelView","DS/W3DContentApp/Views/InodePanelView/inodePanelView","DS/W3DContentApp/Views/Lightbox/lightbox","DS/W3DContentApp/Views/UploadInodesView/taskViewSet","DS/W3DContentApp/Views/UploadInodesView/uploadInodeTasksView","DS/W3DXComponents/Views/EmptyView","i18n!DS/W3DContentApp/assets/nls/W3DContentApp","css!DS/W3DContentApp/W3DContentApp.css"],(function(e,t,n,i,o,r,s,a,l,c,d,u){"use strict";var p,m,f,g,h,v=i(),D=new e({container:v.container}),w=D.render,b=D.destroy,C=c({children:l});return Object.assign(D,{getFirstPanel:function(){return f.hideFirstPanel?null:p},getSecondPanel:function(){return m},getLightbox:function(){return h},render:function(e={}){if(!e.viewSpecs)throw new Error("Missing input");return f=e.viewSpecs,v.render({viewSpecs:{hideController:f.hideFirstPanel}}),t.mask(v.container),f.hideFirstPanel||(p=r({collection:o,conf:f.drivesPanelView}),v.refreshPanel(0,p.container),p.render()),C.render(),C.inject(v.container),w.apply(D,arguments)},showEmptyView:function(){g||(g=new d({icon:"picture",title:u.get("noContent")})),g.render().inject(D.container)},hideEmptyView:function(){g&&g.destroy()},showSecondPanel:function(e){var n;if(m){if(m.model===e)return v.slideTo(1),D;n=m,m.container.remove(),n.destroy(),n=null,m=null}return e?(m=s({model:e,viewSpecs:f.inodePanelView}),v.refreshPanel(1,m.container).slideTo(1),m.render(),t.unmask(v.container),D):(m=null,D)},showFirstPanel:function(){return f.hideFirstPanel||v.slideTo(0),D},showLightbox:function(e){h||(h=a.init({inode:e.inode,viewSpecs:f.lightboxView})),h.animationFrameId=window.requestAnimationFrame((function(){h.refresh({...e,previousLightboxVisibility:h.isLightboxVisible()})}))},hideLightbox:function(){h.animationFrameId&&(window.cancelAnimationFrame(h.animationFrameId),h.animationFrameId=null),h.hideLightbox()},updateLightbox:function(e,t){h.updatePreviewBody(e,t)},destroy:function(){return v.destroy(),C.destroy(),b.apply(D,arguments)}})}));