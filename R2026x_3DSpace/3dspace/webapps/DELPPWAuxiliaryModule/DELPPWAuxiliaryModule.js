define("DS/DELPPWAuxiliaryModule/AuxiliaryModule",["UWA/Core"],(function(e){"use strict";return{behaviors:["WUXNodeModelBehavior","UXFactoryBehavior","TreeListViewBehavior","ModelBehavior","LinkBehavior","ResourceBehavior","SearchBehavior","RefreshBehavior","ViewBehavior","LoadObjectBehavior","MfgProcessBehavior","RootsBehavior"],creator:function(t,n,i,o,a,r,d,s,l,c,g,u,f){var p,h,A,y,v,m,w=[],R=[],C=function(t){var n,i=function(t){var i=!1;return e.is(t)&&e.is(t.get,"function")&&(t.isConnection()?i=R.indexOf(t.get("type"))>-1:(n=a.getPPRType(t),i=w.indexOf(n)>-1)),i};return Array.isArray(t,"array")?t.every((function(e){return i(e)})):i(t)},S=function(){return w.indexOf("PROCESS")>-1||w.indexOf("SERVICE")>-1||w.indexOf("CONSTRUCTION")>-1},I=function(i){var o,r,d,s={forceDBMode:!0,silent:!0,onComplete:function(n){e.is(n)?a.createRefOrInst({isInstanceOf:n.get("PID")},d.get("PID")):t.debug("Child reference fetch failed")}};o=n.getSelectedNodes(),e.is(o,"array")&&e.is(i)&&(r=o[0].getID(),d=a.getReferenceModel(r),i.forEach((function(e){a.fetchRoot(e.id,s)})))},T=function(e){u.generateIndustryRecipeFromFBOM({PID:e})};return{listenTo:function(){return{addToAuxiliaryView:this.addToAuxiliaryView,instanceAdded:this.onAddInstance,connectionRemoved:this.onRemoveConnection,referenceRemoved:this.onRemoveRefOrInst,instanceRemoved:this.onRemoveRefOrInst,connectionAdded:this.onAddConnection,referenceChanged:this.onChangeIRPC,referenceAdded:this.onAddReference,searchAndAddInstance:this.onSearchAndAddInstance,InsertAsCopy:this.onInsertAsCopy,reparent:this.onReparentInstances,reparentBegin:this.onReparentBegin,reparentEnd:this.onReparentEnd,toggleAuxPanel:this.onToggleAuxPanel,expandAll:this.onExpandAll,collapseAll:this.onCollapseAll,widgetLayoutChanged:this.onWidgetLayoutChanged,GenerateRecipeFromFBOM:T}},onStart:function(a){var r,s=t.getElement(),l=s.getElementsByClassName("tree-list-container")[0],g=i.getComponent("WUXFrameWindowsManager").getFrameWindow(t.getAppContext()),u=e.is(widget.getValue("isMFNToggleAuxiliaryViewVisible"))?"MFN":"MGA";widget.getValue("isViewPersistanceOn");if(v=i.getComponent("WUXDockAreaEnum"),!e.is(a.pprTypes)||!e.is(a.linkTypes))throw new Error(t.getId()+": TreeListAuthoringModule initialization failed");w=a.pprTypes,R=a.linkTypes,p=e.is(a.displayBadgeProductScope)?a.displayBadgeProductScope:null,h=e.is(a.displayBadgeProcessScope)?a.displayBadgeProcessScope:null,A=e.is(a.displayBadgePartialProductScope)?a.displayBadgePartialProductScope:null,y=e.is(a.displayBadgePartialProcessScope)?a.displayBadgePartialProcessScope:null,m=i.create("Panel",{title:d.getNLSValue("View.AUXILIARY.Title"),identifier:"AuxiliaryPanel",minWidth:300,minHeight:250,height:250,width:300,immersiveFrame:g.getImmersiveFrame(),content:s,visibleFlag:!1,resizableFlag:!0,closeButtonFlag:!1,useBordersFlag:!0,collapsibleFlag:!1,verticallyStretchableFlag:!0}),o.loadDocument(n.getWUXNodeModel()),o.getContent().inject(l),c.registerViewforWidgetLayout({viewID:t.getId(),viewType:"treeListView",dockArea:v.LeftDockArea}),r=widget.getValue("is"+u+"ToggleAuxiliaryViewVisible"),t.notify("toggleCmdCheckHeaderState",{cmdName:"ToggleAuxiliaryView",cmdState:r})},onStop:function(){e.is(m)&&(m.remove(),m=void 0),c.unregisterViewforWidgetLayout(t.getId(),"treeListView")},onAddReference:function(t){t=e.is(t,"array")?t:[t],n.withTransactionUpdate((function(){t.forEach((function(t){!function(t){C(t)&&e.is(t.get("PID"))&&n.isNodeAdded(t.get("PID"))&&n.addNode(t,{silentMode:!0,withLinksResolved:!1})}(t)}))}))},onAddInstance:function(t){var i={silentMode:!0,withLinksResolved:!1},o=function(e){n.addNode(e,i)};e.is(t,"array")?n.withTransactionUpdate((function(){t.forEach((function(e){o(e)}))})):o(t)},onAddConnection:function(t){var i=function(t){var i,o;C(t)&&(o=t.get("from"),i=t.get("type"),e.is(p)&&p.linkType===i?n.updateBadge(o,p.badgeIcon):e.is(h)&&h.linkType===i?n.updateBadge(o,h.badgeIcon):e.is(A)&&A.linkType===i?n.updateBadge(o,A.badgeIcon):e.is(y)&&y.linkType===i&&n.updateBadge(o,y.badgeIcon))};e.is(t,"array")?n.withTransactionUpdate((function(){t.forEach((function(e){i(e)}))})):i(t)},onChangeIRPC:function(t){var i=function(e){C(e)&&n.updateAttributes(e)};e.is(t,"array")?n.withTransactionUpdate((function(){t.forEach((function(e){i(e)}))})):i(t)},onRemoveRefOrInst:function(e){var t=[];e=Array.isArray(e)?e:[e],n.withTransactionUpdate((function(){e.forEach((function(e){t.push(e.get("PID"))})),t.length>0&&n.removeNodes(t)}))},onRemoveConnection:function(i){var o=[],a=function(n){var i,a;C(n)&&(i=n.get("type"),e.is(i,"string")?(a=n.get("from"),(e.is(p)&&p.linkType===i||e.is(h)&&h.linkType===i||e.is(A)&&A.linkType===i||e.is(y)&&y.linkType===i)&&o.push(a)):t.debug("Could not get connection type"))};n.withTransactionUpdate((function(){e.is(i,"array")?i.forEach((function(e){a(e)})):a(i),o.length>0&&n.updateBadge(o,null)}))},onToggleAuxPanel:function(e){var t,i,o,a=widget.getValue("widgetLayoutStateValues");i=function(){m.visibleFlag||(m._getPositionFromPreferences()||(m.currentDockArea=v.LeftDockArea),m.show()),(t=m.immersiveFrame.getDockingElement(m.currentDockArea))&&(t.collapseDockingZoneFlag=!1)},o=function(){m.visibleFlag&&(m.hide(),n.unSelectAll())},!0===e.state?(i(),a.AUXILIARY.display=!0):(o(),a.AUXILIARY.display=!1),widget.setValue("widgetLayoutStateValues",a)},onExpandAll:function(){var t=n.getSelectedNodes();e.is(t,"array")&&t.length>0&&n.expandAll(t)},onCollapseAll:function(){var t=n.getSelectedNodes();e.is(t,"array")&&t.length>0&&n.collapseAll(t)},onWidgetLayoutChanged:function(){var n,i,o=function(){var n,i=t.getId(),o=!1,a=t.getPreferenceValue("widgetLayoutStateValues");return e.is(a)&&(o=""!==(n=e.is(a,"string")?e.Json.decode(a):a)[i]&&n[i].display),o}();m.currentDockArea=v.LeftDockArea,m._saveDockAreaInPreferences(),n=m.currentDockArea,(i=m.immersiveFrame.getDockingElement(n)).getContainedVisibleWindows().length<=0&&(i.visibleDockingZoneFlag=!1),t.notify("toggleCmdCheckHeaderState",{cmdName:"ToggleAuxiliaryView",cmdState:o}),t.notify("AuxLayoutCommandsToggled")},onReparentInstances:function(e){n.reparent(e)},onReparentBegin:function(e){n.isNodeAdded(e)&&(n.showOverlay(),n.unSelectAll())},onReparentEnd:function(e){n.isNodeAdded(e)&&n.removeOverlay()},addToAuxiliaryView:function(o,a){var r,s,l,c,g,u,f=a||{},p={},h="PLMEntity.V_Name",A=d.getNLSValue(t.getId()),y=0,v=!!e.is(f.forceDBMode)&&f.forceDBMode,w=!!e.is(f.askAddToAuxConfirmation)&&f.askAddToAuxConfirmation,R={withLinksResolved:!1,forceDBMode:v,onAddToTreeListComplete:function(e){y++,t.log(d.getNLSValue("AuxiliaryModule.AddRoot.Title",{objectName:e.get(h),view:A}),g),y===o.length&&(m.visibleFlag||t.notify("toggleCmdCheckHeaderState",{cmdName:"ToggleAuxiliaryView",cmdState:!0}),0===y&&t.info(d.getNLSValue("AuxiliaryModule.AddRootSuccess.Title",{view:A}),g))}};o=e.is(o,"array")?o:[o],r=function(){g=t.log(d.getNLSValue("AuxiliaryModule.AddRoot.LogMessage",{view:A})),o.forEach((function(i){u=n.validate(i),e.is(u)?(p[u.param]=u.paramValue,c=d.getNLSValue(u.key,p,"ValidationError"),t.log(c,g),y++):n.addNode(i,R)}))},e.is(o)&&(w?(s=d.getNLSValue("Confirmation.AddAsNewRoot"),l=d.getNLSValue("Confirmation.AreYouSure"),i.showConfirmation(l,s,{attributes:[h],models:o},(function(t){e.is(t)&&t&&r()}))):r())},onSearchAndAddInstance:function(){var e,t,i=n.getSelectedNodesInfo();1===i.length&&S()&&(t="RESOURCE"!==(e=a.getReferenceModel(i[0].id,!0)).get("PPRTYPE")?a.getValidChildTypes(e):["VPMReference"],s.showSearchDialoguAndActivate(I,{types:t}))},onInsertAsCopy:function(){var e,t=n.getSelectedNodesInfo();1===t.length&&S()&&(e=a.getReferenceModel(t[0].id,!0),s.showSearchDialoguAndActivate(I,{types:a.getValidChildTypes(e),command:"duplicate"}))}}}}}));