/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/DMUValidationWebApp/DMUValidationWebAppOptions",["UWA/Core","UWA/Class","UWA/Class/Options","UWA/Utils"],(function(e,t,i,o){"use strict";return t.singleton(i,{init:function(){var t={};""!==window.location.search&&(e.extend(t,o.parseQuery(window.location.search)),t.widgetDomain&&e.extend(t,o.parseQuery(t.widgetDomain))),("debug_me"in t||window.debug)&&(t.debug=!0),("testWkb"in t||window.testWkb)&&(t.testWkb=!0),("testMbom"in t||window.testMbom)&&(t.testMbom=!0),this.setOptions(t)}})})),define("DS/DMUValidationWebApp/DMUValidationWebAppDefaultCmd",["DS/CATWebUXComponents/DMUCommand","DS/DMUValWebAppController/DMUValWebAppController","DS/PADUtils/PADContext"],(function(e,t,i){"use strict";return e.extend({init:function(e){var o=e||{};this._parent(o,{mode:"exclusive",isAsynchronous:!0}),this.beginExecute=function(){var e=t.giveController({context:i.get()});e&&e.enableDMUContextualBar(),this.done()},this.endExecute=function(){var e=t.giveController({context:i.get()});e&&e.disableDMUContextualBar(),this.done()}}})})),
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/DMUValidationWebApp/DMUValidationAppInit",["DS/WAfrContainer/App","DS/DMUBaseExperience/DMUContextManager","UWA/Core","DS/Controls/Loader","DS/DMUMeasurable/DMUToolsSceneGraph","i18n!DS/DMUValidationWebApp/assets/nls/DMUValidationWebApp"],(function(e,t,i,o,n,a){"use strict";let p,l;var r,d={wkb2D:{type:"2D",wkb:[{file:"DMUDesignValidationWidget2D.xml",module:"DMUValidationWebApp"}]},wkb2DFL:{type:"2DFL",wkb:[{file:"DMUDesignValidationWidget2DFL.xml",module:"DMUValidationWebApp"}]},wkb2DFLFormats:{type:"2DFLFormats",wkb:[{file:"DMUValidation2DFormats.xml",module:"DMUValidationWebApp"}]},wkb2DFormats:{type:"2DFormats",wkb:[{file:"DMUValidation2DFormats.xml",module:"DMUValidationWebApp"}]},wkb3D:{type:"3D",wkb:[{file:"DMUValidationWebApp.xml",module:"DMUValidationWebApp"}]},wkb3DFormats:{type:"3DFormats",wkb:[{file:"DMUValidation3DFormats.xml",module:"DMUValidationWebApp"}]},wkb3DTst:{type:"3DFormats",wkb:[{file:"DMUValidationWebApp_TST.xml",module:"DMUValidationTestWebApp"}]},wkbDocument:{type:"Document",wkb:[{file:"DMUDesignValidationWidgetDocument.xml",module:"DMUValidationWebApp"}]},wkbDocumentTst:{type:"Document",wkb:[{file:"DMU3DReviewWidgetDocument_TST.xml",module:"DMUValidationTestWebApp"}]},wkbRequirement:{type:"Requirement",wkb:[{file:"DMUDesignValidationWidgetRequirement.xml",module:"DMUValidationWebApp"}]},wkbRequirementTst:{type:"Requirement",wkb:[{file:"DMUDesignValidationWidgetRequirement_TST.xml",module:"DMUValidationTestWebApp"}]},"wkbRequirement Specification":{type:"Requirement Specification",wkb:[{file:"DMUDesignValidationWidgetRequirement.xml",module:"DMUValidationWebApp"}]},"wkbRequirement SpecificationTst":{type:"Requirement Specification",wkb:[{file:"DMUDesignValidationWidgetRequirement_TST.xml",module:"DMUValidationTestWebApp"}]},wkbITF:{type:"ITF",wkb:[{file:"DMUDesignValidationWidgetITF.xml",module:"DMUValidationWebApp"}]},wkbITFFormats:{type:"ITFFormats",wkb:[{file:"DMUValidation3DFormats.xml",module:"DMUValidationWebApp"}]},wkbITFTst:{type:"ITFFormats",wkb:[{file:"DMUValidationITFWebApp_TST.xml",module:"DMUValidationTestWebApp"}]},wkbMSR:{type:"MSR",wkb:[{file:"DMUDesignValidationWidgetMSR.xml",module:"DMUValidationWebApp"}]},wkbR2V:{type:"R2V",wkb:[{file:"DMUDesignValidationWidgetR2V.xml",module:"DMUValidationWebApp"}]},wkbR2VFormats:{type:"R2VFormats",wkb:[{file:"DMUValidationR2VFormats.xml",module:"DMUValidationWebApp"}]},wkbMSRFormats:{type:"MSRFormats",wkb:[{file:"DMUValidationMSRFormats.xml",module:"DMUValidationWebApp"}]},wkbReviewNoContext:{type:"ReviewNoContext",wkb:[{file:"DMUDesignValidationWidgetReviewNoContext.xml",module:"DMUValidationWebApp"}]}};return e.extend({setUp:function(e){var t=this;if(window.widget.getValue("X3DContentId")&&!e.sourceApp){var n="",s=JSON.parse(window.widget.getValue("X3DContentId"));s.data&&s.data.items&&s.data.items[0]&&s.data.items[0].displayName&&(n=s.data.items[0].displayName);var D=i.createElement("div",{class:"DMULoadingPanel"}).inject(document.body);(r=new o({text:a.loadingMessage+" "+n}).inject(D)).on(),r.getContent().addClassName("DMULoadingPanelInfoDiv");var m=r.elements.label.getSize().width,u=r.elements.progressBar.getContent().getSize().width,b=r.elements.progressBar.getContent().getSize().height,w=m+u;D.setStyles({position:"absolute",bottom:"0",left:"0","z-index":"40000","background-color":"rgba(255,255,255,1",height:"100%",width:"100%"}),r.getContent().setStyles({position:"absolute",left:"calc(50% - "+w/2+"px)",top:"calc(50% - "+b/2+"px)"})}e.sourceApp?e.sourceApp.pad3DViewer?(l=e.sourceApp.pad3DViewer,this.pad3DViewer=e.sourceApp.pad3DViewer,this.appMainDiv=e.sourceApp.appMainDiv,new Promise((function(t){require(["DS/DMUReviewCommonWebApp/DMUCommonWebAppMain"],(function(i){p=new i({widget:window.widget,data:d,controller:"DS/DMUValWebAppController/DMUValWebAppController",appId:"R3V",pad3DViewer:e.sourceApp.pad3DViewer,appMainDiv:e.sourceApp.appMainDiv}),t()}))})).then((function(){e.sourceApp&&!e.sourceApp.isDisposeCalled()&&e.sourceApp.dispose();var i=e.done;e.done=function(o){t.appMainDiv||(t.appMainDiv=o.appMainDiv),e.done=i,e.done()},p.setUp(e)}))):e.done():require(["DS/DMUReviewCommonWebApp/DMUCommonWebAppMain"],(function(i){p=new i({widget:window.widget,viewerAttachment:e.done,data:d,controller:"DS/DMUValWebAppController/DMUValWebAppController",appId:"R3V",done:function(e){l=e.pad3DViewer,t.pad3DViewer=e.pad3DViewer,t.appMainDiv=e.appMainDiv}})}))},dispose:function(e){e&&(e.preferredType="DMUValidationValidation"),p&&p.dispose&&p.dispose(e),r&&(r.destroy(),r=null);var t=window.document.getElementsByClassName("DMULoadingPanel");t.length&&t[0].destroy(),this._parent(e)},onWillEnter:function(e){return p&&p.onWillEnter&&p.onWillEnter(e),require(["DS/DMUBaseExperience/EXPUtils","DS/DMUValWebAppController/DMUValWebAppController","DS/PADUtils/PADSettingsMgt"],(function(t,i,o){o.setSetting("enopad3dviewer_staticMappingSupportActivated",!0);var n=i.getController({context:e.pad3DViewer});"X3DPLAW_AP"!==e&&"ENOR3R_AP"!==e||n.setappTransition(!0),t._sendUsageProbe("appTransitionFrom",e.options.id,"resolved")})),this._parent(e)},onWillLeave:function(e){var i=n.getRoots(l),o=["Drawing","Document","DIFLayout","DIFSheet"];["X3DPLAW_AP","ENOR3R_AP","ENOR3V_AP","ENOR3D_AP"].indexOf(e.options.id)<0&&o.push("DesignSight");for(var a=0;a<i.length;a++)if(-1!==o.indexOf(n.getNodeType(i[a]))){var r=n.getNodeID(i[a]);t.getReviewContext({context:this.pad3DViewer})&&t.getReviewContext({context:this.pad3DViewer}).getCurrentSessionMarkup()||l.removeRoots({pids:[r]})}return e.options&&"ENOR3R_AP"===e.options.id&&require(["DS/DMUValWebAppController/DMUValWebAppController"],(function(t){var i=t.getController({context:e.pad3DViewer});i&&i.setappTransition(!0)})),require(["DS/CATWebUXPreferences/CATWebUXPreferencesManager"],(function(i){var o=i.getPreferenceManager({context:l.getFrameWindow()});if(o&&("CATC3D_AP"===e.options.id||"CATA3I_AP"===e.options.id||"ENOI3D_AP"===e.options.id)){o.removeAllPreferences();let i=t.getReviewContext({context:l});"CATA3I_AP"===e.options.id&&i&&i.getCurrentSessionMarkup()&&i.getCurrentSessionMarkup().setActiveFlag(!1)}})),p&&p.onWillLeave&&p.onWillLeave(e),require(["DS/DMUBaseExperience/EXPUtils"],(function(t){t._sendUsageProbe("appTransitionTo",e.options.id,"resolved")})),this._parent(e)}})})),
/*!  Copyright 2015 Dassault Systemes. All rights reserved. */
define("DS/DMUValidationWebApp/ENOR3VAppInit",["DS/WAfrContainer/App","DS/DMUBaseExperience/DMUContextManager","UWA/Core","DS/Controls/Loader","DS/DMUMeasurable/DMUToolsSceneGraph","i18n!DS/DMUValidationWebApp/assets/nls/DMUValidationWebApp"],(function(e,t,i,o,n,a){"use strict";let p,l;var r,d={wkb2D:{type:"2D",wkb:[{file:"DMUDesignValidationWidget2D.xml",module:"DMUValidationWebApp"}]},wkb2DFL:{type:"2DFL",wkb:[{file:"DMUDesignValidationWidget2DFL.xml",module:"DMUValidationWebApp"}]},wkb2DFLFormats:{type:"2DFLFormats",wkb:[{file:"DMUValidation2DFormats.xml",module:"DMUValidationWebApp"}]},wkb2DFormats:{type:"2DFormats",wkb:[{file:"DMUValidation2DFormats.xml",module:"DMUValidationWebApp"}]},wkb3D:{type:"3D",wkb:[{file:"DMUValidationWebApp.xml",module:"DMUValidationWebApp"}]},wkb3DFormats:{type:"3DFormats",wkb:[{file:"DMUValidation3DFormats.xml",module:"DMUValidationWebApp"}]},wkb3DTst:{type:"3DFormats",wkb:[{file:"DMUValidationWebApp_TST.xml",module:"DMUValidationTestWebApp"}]},wkbDocument:{type:"Document",wkb:[{file:"DMUDesignValidationWidgetDocument.xml",module:"DMUValidationWebApp"}]},wkbDocumentTst:{type:"Document",wkb:[{file:"DMU3DReviewWidgetDocument_TST.xml",module:"DMUValidationTestWebApp"}]},wkbRequirement:{type:"Requirement",wkb:[{file:"DMUDesignValidationWidgetRequirement.xml",module:"DMUValidationWebApp"}]},wkbRequirementTst:{type:"Requirement",wkb:[{file:"DMUDesignValidationWidgetRequirement_TST.xml",module:"DMUValidationTestWebApp"}]},"wkbRequirement Specification":{type:"Requirement Specification",wkb:[{file:"DMUDesignValidationWidgetRequirement.xml",module:"DMUValidationWebApp"}]},"wkbRequirement SpecificationTst":{type:"Requirement Specification",wkb:[{file:"DMUDesignValidationWidgetRequirement_TST.xml",module:"DMUValidationTestWebApp"}]},wkbITF:{type:"ITF",wkb:[{file:"DMUDesignValidationWidgetITF.xml",module:"DMUValidationWebApp"}]},wkbITFFormats:{type:"ITFFormats",wkb:[{file:"DMUValidation3DFormats.xml",module:"DMUValidationWebApp"}]},wkbITFTst:{type:"ITFFormats",wkb:[{file:"DMUValidationITFWebApp_TST.xml",module:"DMUValidationTestWebApp"}]},wkbMSR:{type:"MSR",wkb:[{file:"DMUDesignValidationWidgetMSR.xml",module:"DMUValidationWebApp"}]},wkbR2V:{type:"R2V",wkb:[{file:"DMUDesignValidationWidgetR2V.xml",module:"DMUValidationWebApp"}]},wkbR2VFormats:{type:"R2VFormats",wkb:[{file:"DMUValidationR2VFormats.xml",module:"DMUValidationWebApp"}]},wkbMSRFormats:{type:"MSRFormats",wkb:[{file:"DMUValidationMSRFormats.xml",module:"DMUValidationWebApp"}]},wkbReviewNoContext:{type:"ReviewNoContext",wkb:[{file:"DMUDesignValidationWidgetReviewNoContext.xml",module:"DMUValidationWebApp"}]}};return e.extend({setUp:function(e){if(e.sourceApp&&this.options.id===e.sourceApp.options.id)return e.sourceApp.pad3DViewer&&(this.pad3DViewer=e.sourceApp.pad3DViewer),e.sourceApp.appMainDiv&&(this.appMainDiv=e.sourceApp.appMainDiv),Promise.resolve();var t=this;if(window.widget.getValue("X3DContentId")&&!e.sourceApp){var n="",s=JSON.parse(window.widget.getValue("X3DContentId"));s.data&&s.data.items&&s.data.items[0]&&s.data.items[0].displayName&&(n=s.data.items[0].displayName);var D=i.createElement("div",{class:"DMULoadingPanel"}).inject(document.body);(r=new o({text:a.loadingMessage+" "+n}).inject(D)).on(),r.getContent().addClassName("DMULoadingPanelInfoDiv");var m=r.elements.label.getSize().width,u=r.elements.progressBar.getContent().getSize().width,b=r.elements.progressBar.getContent().getSize().height,w=m+u;D.setStyles({position:"absolute",bottom:"0",left:"0","z-index":"40000","background-color":"rgba(255,255,255,1",height:"100%",width:"100%"}),r.getContent().setStyles({position:"absolute",left:"calc(50% - "+w/2+"px)",top:"calc(50% - "+b/2+"px)"})}return e.sourceApp?e.sourceApp.pad3DViewer?(l=e.sourceApp.pad3DViewer,this.pad3DViewer=e.sourceApp.pad3DViewer,this.appMainDiv=e.sourceApp.appMainDiv,new Promise((function(i){require(["DS/DMUReviewCommonWebApp/ENOR3CommonAppMain"],(function(o){p=new o({widget:window.widget,pad3DViewer:t.getExecutionContext?t.getExecutionContext().getComponent("Viewer"):e.sourceApp.pad3DViewer,executionContext:t.getExecutionContext(),data:d,controller:"DS/DMUValWebAppController/DMUValWebAppController",appId:"R3V",appMainDiv:e.sourceApp.appMainDiv}),e.done&&e.done(),i()}))})).then((function(){e.sourceApp&&!e.sourceApp.isDisposeCalled()&&e.sourceApp.dispose();var i=e.done;e.done=function(o){t.appMainDiv||(t.appMainDiv=o.appMainDiv),e.done=i,e.done()},p.setUp(e)}))):void e.done():new Promise((i=>{require(["DS/DMUReviewCommonWebApp/ENOR3CommonAppMain"],(function(i){p=new i({widget:window.widget,viewer:t.getExecutionContext().getComponent("Viewer"),executionContext:t.getExecutionContext(),viewerAttachment:e.done,data:d,controller:"DS/DMUValWebAppController/DMUValWebAppController",appId:"R3V",done:function(e){l=e.pad3DViewer,t.pad3DViewer=e.pad3DViewer,t.appMainDiv=e.appMainDiv}})})),e.done&&e.done(),i()}))},dispose:function(e){if(l){if(l&&l.getExecutionContext){let e=l.getExecutionContext(),t=e.getSourceApp(),i=e.getTargetApp();if(t&&i&&t.options.id===i.options.id)return}e&&(e.preferredType="DMUValidationValidation"),p&&p.dispose&&p.dispose(e),r&&(r.destroy(),r=null);var t=window.document.getElementsByClassName("DMULoadingPanel");t.length&&t[0].destroy(),l=void 0,this._parent(e)}},onWillEnter:function(e){if(this.options.id===e.options.id)return Promise.resolve();if(p&&p.onWillEnter&&p.onWillEnter(e),e&&e.pad3DViewer&&t.getReviewContext({context:e.pad3DViewer})&&t.getReviewContext({context:e.pad3DViewer}).getValidation){let i,o=t.getReviewContext({context:e.pad3DViewer}).getValidation(),n=t.getReviewContext({context:e.pad3DViewer}).getTransientReviewBag();n&&(i=n.getDMUObjects()),o||i.length||t.removeReviewContext({context:e.pad3DViewer})}return require(["DS/DMUBaseExperience/EXPUtils","DS/DMUValWebAppController/DMUValWebAppController","DS/PADUtils/PADSettingsMgt"],(function(t,i,o){o.setSetting("enopad3dviewer_staticMappingSupportActivated",!0);var n=i.getController({context:e.pad3DViewer});"X3DPLAW_AP"!==e&&"ENOR3R_AP"!==e||n.setappTransition(!0),t._sendUsageProbe("appTransitionFrom",e.options.id,"resolved")})),this._parent(e)},onWillLeave:function(e){if(this.options.id===e.options.id)return Promise.resolve();var i=n.getRoots(l),o=["Drawing","Document","DIFLayout","DIFSheet"];["X3DPLAW_AP","ENOR3R_AP","ENOR3V_AP","ENOR3D_AP","ENX3DIR_AP"].indexOf(e.options.id)<0&&o.push("DesignSight","R2V_Activity");for(var a=0;a<i.length;a++)if(-1!==o.indexOf(n.getNodeType(i[a]))){var r=n.getNodeID(i[a]);r&&l.removeRoots({pids:[r]})}return e.options&&"ENOR3R_AP"===e.options.id&&require(["DS/DMUValWebAppController/DMUValWebAppController"],(function(t){var i=t.getController({context:e.pad3DViewer});i&&i.setappTransition(!0)})),require(["DS/CATWebUXPreferences/CATWebUXPreferencesManager"],(function(i){var o=i.getPreferenceManager({context:l.getFrameWindow()});if(o&&("CATC3D_AP"===e.options.id||"CATA3I_AP"===e.options.id||"ENOI3D_AP"===e.options.id)){o.removeAllPreferences();let i=t.getReviewContext({context:l});"CATA3I_AP"===e.options.id&&i&&i.getCurrentSessionMarkup()&&i.getCurrentSessionMarkup().setActiveFlag(!1)}})),p&&p.onWillLeave&&p.onWillLeave(e),require(["DS/DMUBaseExperience/EXPUtils"],(function(t){t._sendUsageProbe("appTransitionTo",e.options.id,"resolved")})),this._parent(e)}})})),define("DS/DMUValidationWebApp/DMUValidationWebAppDefaultCmdV2",["DS/DMUValWebAppController/DMUValWebAppController","DS/PADUtils/PADContext"],(function(e,t){"use strict";return class{constructor(){this.beginExecute=function(){var i=e.giveController({context:t.get()});i&&i.enableDMUContextualBar()},this.endExecute=function(){var i=e.giveController({context:t.get()});i&&i.disableDMUContextualBar(),this.done()}}}}));