define("DS/DELPPWProcessMILModule/MfgProcessMILBaseUI",["UWA/Core"],(function(e){"use strict";return function(t,n,o,i,l,a){var s,c,r,u={className:""},d=null;return s=function(s){var I,p,g=n.create("Element","div",{class:"mil-panel-container"}),m=n.create("Element","div",{class:"mil-tree-container"}).inject(g),L=n.getComponent("Button"),f=s.cancelButtonLabel||l.getNLSValue("PanelButton.Cancel"),P=s.manageInconsistentLinksCmdId;r=e.is(s.cleanup,"function")?s.cleanup:null,I=i.getWUXNodeModel(),o.loadDocument(I),o.getContent().inject(m),p={shouldBeSelected:function(t){const n=t.options.milStatus;let o=!0;return e.is(n)&&(o="success"!==n),o}},e.extend(I.options,p),(d=n.create("Dialog",{identifier:"MIL-UI",domId:"MILUI-dialog",title:l.getNLSValue("ManageInconsistentLinksUI.PanelTitle"),resizableFlag:!0,visibleFlag:!1,modalFlag:!0,content:g,height:315,width:600,snappableFlag:!1,buttons:{Ok:new L({disabled:!0,label:l.getNLSValue("MIL.PanelOkButton"),emphasize:"primary",onClick:function(){e.is(u.onApplyCallBack,"function")&&u.onApplyCallBack()}}),Cancel:new L({label:f,onClick:function(){d.close()}})}})).close=function(){a.getBICmdState()||a.resetBIModelCollection(),e.is(P)?t.notify("toggleCmdCheckHeaderState",{cmdName:P,cmdState:!1}):c()}},c=function(){d.hide()},{buildSkeleton:function(t){u=e.extend(u,t),s(u)},destroy:function(t){!!e.is(t,"boolean")&&t?e.is(r,"function")&&r():this.isActive()&&c(),e.is(i)&&i.emptyNodeModel(),e.is(d)&&(d.destroy(),d=null)},isActive:function(){return!!e.is(d)&&d.visibleFlag},loadUI:function(){e.is(d)&&!1===d.visibleFlag&&d.show()},setApplyButtonState:function(){var e=!1;i.getSelectedNodesInfo().length>0&&(e=!0),d.buttons.Ok.disabled=!e},updateApplyButtonState:function(t){const n=!!e.is(t,"boolean")&&t;d.buttons.Ok.disabled=!n}}}})),define("DS/DELPPWProcessMILModule/MILMfgProcessNItemUI",["UWA/Core","DS/DELPPWProcessMILModule/MfgProcessMILBaseUI"],(function(e,t){"use strict";return function(n,o,i,l,a,s,c,r,u,d){var I,p,g,m,L,f,P,h,k,M,v,S=new t(n,o,i,l,c,u),D={className:""},R=[],b=[],_={},N=[];return p=function(){var e;return e=r.getRoots(),R=e[0],b=e[1],!(!R||Array.isArray(R)&&R.length<=0)&&!(!b||Array.isArray(b)&&b.length<=0)},g=function(){I={Reroute_ScopeLink:{label:c.getNLSValue("MIL.Reroute.ScopeLink"),value:1,tooltip:c.getNLSValue("MIL.ToolTip.RerouteScope"),getLabel:function(){return this.tooltip}},Delete_ScopeLink:{label:c.getNLSValue("MIL.Delete.ScopeLink"),value:7,tooltip:c.getNLSValue("MIL.ToolTip.DeleteScope"),getLabel:function(){return this.tooltip}},Reroute_ImplementLink:{label:c.getNLSValue("MIL.Reroute.ImplementLink"),value:2,tooltip:c.getNLSValue("MIL.ToolTip.RerouteImplement"),getLabel:function(){return this.tooltip}},Add_ImplementLink:{label:c.getNLSValue("MIL.Add.ImplementLink"),value:6,tooltip:c.getNLSValue("MIL.ToolTip.AddImplement"),getLabel:function(){return this.tooltip}},RemoveLink:{label:c.getNLSValue("MIL.RemoveLink"),value:3,tooltip:c.getNLSValue("MIL.ToolTip.RemoveLink"),getLabel:function(){return this.tooltip}},Reroute_UsagePointLink:{label:c.getNLSValue("MIL.Reroute.UsagePointLink"),value:8,tooltip:c.getNLSValue("MIL.ToolTip.RerouteUsagePoint"),getLabel:function(){return this.tooltip}},Delete_UsagePointLink:{label:c.getNLSValue("MIL.Delete.UsagePointLink"),value:9,tooltip:c.getNLSValue("MIL.ToolTip.DeleteUsagePoint"),getLabel:function(){return this.tooltip}},Delete:{label:c.getNLSValue("MIL.Delete"),value:4,tooltip:c.getNLSValue("MIL.ToolTip.Delete"),getLabel:function(){return this.tooltip}},Ignore:{label:c.getNLSValue("MIL.Ignore"),value:5,getLabel:function(){return this.label}}}},L=function(t,n,o,i){var a=[],r=[],u={labelItem:I.Reroute_ScopeLink.label,valueItem:I.Reroute_ScopeLink.value,tooltip:I.Reroute_ScopeLink.tooltip},d={labelItem:I.Delete_ScopeLink.label,valueItem:I.Delete_ScopeLink.value,tooltip:I.Delete_ScopeLink.tooltip},p={labelItem:I.Reroute_ImplementLink.label,valueItem:I.Reroute_ImplementLink.value,tooltip:I.Reroute_ImplementLink.tooltip},g={labelItem:I.Add_ImplementLink.label,valueItem:I.Add_ImplementLink.value,tooltip:I.Add_ImplementLink.tooltip},m={labelItem:I.Reroute_UsagePointLink.label,valueItem:I.Reroute_UsagePointLink.value,tooltip:I.Reroute_UsagePointLink.tooltip},L={labelItem:I.Delete_UsagePointLink.label,valueItem:I.Delete_UsagePointLink.value,tooltip:I.Delete_UsagePointLink.tooltip},f={labelItem:I.Delete.label,valueItem:I.Delete.value,tooltip:I.Delete.tooltip},h={labelItem:I.RemoveLink.label,valueItem:I.RemoveLink.value,tooltip:I.RemoveLink.tooltip},k={labelItem:I.Ignore.label,valueItem:I.Ignore.value};l.emptyNodeModel(),l.prepareUpdate(),Object.values(t).forEach((function(t){var n,o,i,a,r,p,g,m,L,f,h=[],M=[];t.candidates.length>0?(M.push(u,d,k),m=I.Reroute_ScopeLink,t.candidates.forEach((function(t){var n=s.getReference(t.candidateRefPID);i=e.is(n)?P(n,null):t.candidateRefPID,h.push({labelItem:i,valueItem:t.candidateRefPID,tooltip:i})}))):(M.push(d,k),m=I.Ignore,i=c.getNLSValue("MIL.RerouteNone"),h.push({labelItem:i,valueItem:"",tooltip:i})),L=s.getReference(t.pointedRefPID),e.is(L)?(p=P(L,null),g=c.getIconURLFromKey(L.get("type"))):p=t.pointedRefPID,f=s.getReference(t.implementedRefPID),e.is(f)&&(a=P(f,null),r=c.getIconURLFromKey(f.get("type"))),n={MIL_suggestion:m,MIL_rerouting:h[0],MIL_previous:e.is(p)?p:c.getNLSValue("MIL.PrevisionUnknown"),MIL_manufactured:a,MIL_status:"",cellInfo:{suggestionToPerformEntries:M,candidateEntries:h,PreviousProdIconUrl:g,MfgItemIconUrl:r,action:m.value,mfgprocessId:t.implementedRefPID,pointedPaths:t.pointedRefPID}},o={referencePID:t.linkPID,linkPID:t.linkPID,linkInfos:t,linkType:"ScopeLink",grid:n,milStatus:null},l.addNodeModel(o)})),Object.values(n).forEach((function(t){var n,o,i,u,d,m,L,M,v,S,D,R,b,_,N,O,U,y,V,E,A,B,T,F,C,w=[],x=[],j=!0;if(N=(_=t.implementedOccPath.split(","))[_.length-1],O=s.getInstance(N),(T=!!e.is(t.isLinkBroken)&&t.isLinkBroken)||(E=t.pointedOccPath.split(","),A=s.getInstance(E[0]),e.is(A)&&(B=A.get("isAggregatedBy"))),t.candidates.length>0){if(x.push(p,h,f,k),v=I.Reroute_ImplementLink,y=s.getImpactedConnections([N],null,{relationTypes:["ProcessImplementLinkOcc"]}),V=[],y.forEach((function(e){V.push(e.get("to").toString())})),t.candidates.forEach((function(t){var n,o,i,l=t.candidateOccPath.split(","),a=l[l.length-1],c=s.getInstance(a);!T&&j&&(o=s.getInstance(l[0]),e.is(o)&&(i=o.get("isAggregatedBy")),B!==i&&(j=!1)),V.indexOf(t.candidateOccPath)>-1||(e.is(c)?(n=s.getReferenceModelFromInstance(c),u=P(n,c)):u=t.candidateOccPath,w.push({labelItem:u,valueItem:t.candidateOccPath,tooltip:u}))})),0===w.length)return;!T&&j&&(x.unshift(g),v=I.Add_ImplementLink)}else x.push(h,f,k),v=I.RemoveLink,u=c.getNLSValue("MIL.RerouteNone"),w.push({labelItem:u,valueItem:"",tooltip:u});D=(S=t.pointedOccPath.split(","))[S.length-1],R=s.getInstance(D),e.is(R)?(b=s.getReferenceModelFromInstance(R),L=P(b,R),M=c.getIconURLFromKey(b.get("type"))):L="",e.is(O)&&(U=s.getReferenceModelFromInstance(O),d=P(U,O),m=c.getIconURLFromKey(U.get("type"))),F=e.is(t.custorole)&&""!==t.custorole?c.getNLSValue("Role."+t.custorole):e.is(t.role)?t.role:"",C=[],e.is(t.actions)&&(C=t.actions.map((e=>{let t=c.getNLSValue("Action."+e);return t==="Action."+e?"__"+e:t})).join(c.getNLSValue("LinksUI.Link.JoinPattern"))),o={MIL_suggestion:v,MIL_rerouting:w[0],MIL_previous:e.is(L)?L:c.getNLSValue("MIL.PrevisionUnknown"),MIL_manufactured:d,MIL_role:F,MIL_actions:C,MIL_status:"",cellInfo:{suggestionToPerformEntries:x,candidateEntries:w,PreviousProdIconUrl:M,MfgItemIconUrl:m,action:v.value,actions:t.actions,mfgprocessId:N,mfgProcessOccPath:t.implementedOccPath,linkPID:t.linkPID,pointedPaths:t.pointedOccPath}},i={referencePID:t.linkPID,linkPID:t.linkPID,linkInfos:t,linkType:"OccOccIMplementLink",grid:o,milStatus:null},n=l.addNodeModel(i),v===I.Delete&&(a.push(n),r.push(t.linkPID))})),Object.values(o).forEach((function(t){var n,o,i,u,d,m,L,M,v,S,D,R,b,_,N,O,U,y,V,E,A,B,T,F=[],C=[],w=!0;if(_=t.implementedOccPath,N=s.getReference(_),(A=!!e.is(t.isLinkBroken)&&t.isLinkBroken)||(y=t.pointedOccPath.split(","),V=s.getInstance(y[0]),e.is(V)&&(E=V.get("isAggregatedBy"))),t.candidates.length>0){if(C.push(p,h,f,k),v=I.Reroute_ImplementLink,O=s.getImpactedConnections([_],null,{relationTypes:["ProcessImplementLinkOcc"]}),U=[],O.forEach((function(e){U.push(e.get("to").toString())})),t.candidates.forEach((function(t){var n,o,i,l=t.candidateOccPath.split(","),a=l[l.length-1],c=s.getInstance(a);!A&&w&&(o=s.getInstance(l[0]),e.is(o)&&(i=o.get("isAggregatedBy")),E!==i&&(w=!1)),U.indexOf(t.candidateOccPath)>-1||(e.is(c)?(n=s.getReferenceModelFromInstance(c),u=P(n,c)):u=t.candidateOccPath,F.push({labelItem:u,valueItem:t.candidateOccPath,tooltip:u}))})),0===F.length)return;!A&&w&&(C.unshift(g),v=I.Add_ImplementLink)}else C.push(h,f,k),v=I.RemoveLink,u=c.getNLSValue("MIL.RerouteNone"),F.push({labelItem:u,valueItem:"",tooltip:u});D=(S=t.pointedOccPath.split(","))[S.length-1],R=s.getInstance(D),e.is(R)?(b=s.getReferenceModelFromInstance(R),L=P(b,R),M=c.getIconURLFromKey(b.get("type"))):L="",e.is(N)&&(d=P(N),m=c.getIconURLFromKey(N.get("type"))),B=e.is(t.custorole)&&""!==t.custorole?c.getNLSValue("Role."+t.custorole):e.is(t.role)?t.role:"",T=[],e.is(t.actions)&&(T=t.actions.map((e=>{let t=c.getNLSValue("Action."+e);return t==="Action."+e?"__"+e:t})).join(c.getNLSValue("LinksUI.Link.JoinPattern"))),o={MIL_suggestion:v,MIL_rerouting:F[0],MIL_previous:e.is(L)?L:c.getNLSValue("MIL.PrevisionUnknown"),MIL_manufactured:d,MIL_role:B,MIL_actions:T,MIL_status:"",cellInfo:{suggestionToPerformEntries:C,candidateEntries:F,PreviousProdIconUrl:M,MfgItemIconUrl:m,action:v.value,actions:t.actions,mfgprocessId:_,mfgProcessOccPath:t.implementedOccPath,linkPID:t.linkPID,pointedPaths:t.pointedOccPath}},i={referencePID:t.linkPID,linkPID:t.linkPID,linkInfos:t,linkType:"OccOccIMplementLink",grid:o,milStatus:null},n=l.addNodeModel(i),v===I.Delete&&(a.push(n),r.push(t.linkPID))})),Object.values(i).forEach((function(t){var n,o,i,a,r,u,d,p,g,f,h,M,v=[],S=[];t.candidates.length>0?(t.pointedOccPath&&(h=t.pointedOccPath.split(","),S.push(m,L,k),p=I.Reroute_UsagePointLink,f=s.getInstance(h[h.length-1])),t.candidates.forEach((function(t){var n,o,l;t.candidateInstPID&&(o=t.candidateInstPID.split(","),l=s.getInstance(o[o.length-1]),n=e.is(l)?s.getReference(l.get("isInstanceOf")):null,i=e.is(l)&&e.is(n)?P(n,l):t.candidateItemInst,v.push({labelItem:i,valueItem:t.candidateInstPID,tooltip:i}))}))):(S.push(L,k),p=I.Delete_UsagePointLink,i=c.getNLSValue("MIL.RerouteNone"),v.push({labelItem:i,valueItem:"",tooltip:i})),e.is(f)?(g=s.getReference(f.get("isInstanceOf")),u=e.is(g)?P(g,f):t.pointedInstPID,d=e.is(g)?c.getIconURLFromKey(g.get("type")):null):u="",M=s.getReference(t.implementedRefPID),e.is(M)&&(a=P(M,null),r=c.getIconURLFromKey(M.get("type"))),n={MIL_suggestion:p,MIL_rerouting:v[0],MIL_previous:e.is(u)?u:c.getNLSValue("MIL.PrevisionUnknown"),MIL_manufactured:a,MIL_status:"",cellInfo:{suggestionToPerformEntries:S,candidateEntries:v,PreviousProdIconUrl:d,MfgItemIconUrl:r,action:p.value,mfgprocessId:t.implementedRefPID,pointedPaths:t.pointedRefPID,pointedOccPaths:t.pointedOccPath}},o={referencePID:t.linkPID,linkPID:t.linkPID,linkInfos:t,linkType:"UsagePoint",grid:n,milStatus:null},l.addNodeModel(o)})),l.getAllDescendants().forEach((function(e){var t;-1===r.indexOf(e.options.linkPID)&&"OccOccIMplementLink"===e.options.linkType&&(t=e.options.linkInfos.implementedOccPath.split(","),a.some((function(n){var o,i=n.options.linkInfos.implementedOccPath.split(","),a=i[i.length-1],s=t.indexOf(a);return s>-1&&s<t.length?(e.options.grid.MIL_status=c.getNLSValue("MIL.Status.Ignore.ImpactedObjDelete",{objectTitle:n.options.grid.MIL_manufactured}),e.options.grid.MIL_suggestion=I.Ignore,e.options.milStatus="ignore",l.updateNode(e.options.linkPID,e.options),o=!0):o=!1,o})))})),l.pushUpdate()},f=function(t){var n=[],o=[],i={},l={},a={},c={},r=[];t.forEach((function(t){t.has("impactedScopes")&&t.get("impactedScopes").forEach((function(t){var o=s.getReference(t.implementedRefPID);e.is(o)&&(t.candidates.forEach((function(t){var o=s.getReference(t.candidateRefPID);e.is(o)||n.push(t.candidateRefPID)})),i[t.linkPID]=t)})),t.has("impactedOccOccImplementLinks")&&t.get("impactedOccOccImplementLinks").forEach((function(t){var n=t.implementedOccPath.split(","),i=n[n.length-1],a=s.getInstance(i);e.is(a)&&(t.candidates.forEach((function(t){var n=t.candidateOccPath.split(","),i=n[n.length-1],l=s.getInstance(i);e.is(l)||o.push(i)})),l[t.linkPID]=t)})),t.has("impactedRefOccImplementLinks")&&t.get("impactedRefOccImplementLinks").forEach((function(t){var n=t.implementedOccPath.split(","),i=n[n.length-1],l=s.getReference(i);e.is(l)&&(t.candidates.forEach((function(t){var n=t.candidateOccPath.split(","),i=n[n.length-1],l=s.getInstance(i);e.is(l)||o.push(i)})),a[t.linkPID]=t)})),t.has("impactedUsagePoints")&&t.get("impactedUsagePoints").forEach((function(t){var n=s.getReference(t.implementedRefPID);e.is(n)&&(t.candidates.forEach((function(t){var n,i=t.candidateInstPID.split(","),l=i[i.length-1];l&&(n=s.getInstance(l),e.is(n)||o.push(t.candidateInstPID))})),c[t.usagePointSID]=t)}))})),n.length>0&&r.push(new Promise((function(e,t){s.fetchRoot(n,{silent:!0,onComplete:e,onFailure:t})}))),o.length>0&&r.push(new Promise((function(e,t){s.fetchInstancesAndTheirReferences(o,{silent:!0,onComplete:e,onFailure:t})}))),e.Promise.allSettled(r).then((function(){L(i,l,a,c)})).catch((function(){}))},m=function(){var t,o,i=l.getSelectedNodes(),s=[],r=c.getNLSValue("MIL.LogMessage"),u=!1,p="RerouteIL",g="AddIL",m="RerouteSL",L="DeleteSL",f="RerouteUP",P="DeleteUP",h="Delete",k="RemoveLink";i.forEach((function(n){var o;switch((t=n.options.grid.cellInfo).action){case I.Reroute_ScopeLink.value:o=m;break;case I.Delete_ScopeLink.value:o=L;break;case I.Reroute_UsagePointLink.value:o=f;break;case I.Delete_UsagePointLink.value:o=P;break;case I.RemoveLink.value:o=k;break;case I.Delete.value:o=h;break;case I.Reroute_ImplementLink.value:o=p;break;case I.Add_ImplementLink.value:o=g}e.is(o)&&"ignore"!==n.options.milStatus&&(s.push({MfgProcessUpdateAction:o,mfgProcessOccPath:e.is(t.mfgProcessOccPath)?t.mfgProcessOccPath:t.mfgprocessId,pointedPaths:t.pointedPaths,pointedOccPaths:t.pointedOccPaths,candidatePaths:n.options.grid.MIL_rerouting.valueItem,custoRole:d.getCustoRoleFromNLS(n.options.grid.MIL_role),role:d.getOotbRoleFromCustoRole(n.options.grid.MIL_role),actions:t.actions,linkPID:n.options.linkPID,dimension:n.options.linkInfos.dimension,quantity:n.options.linkInfos.quantity,scrapRate:n.options.linkInfos.scrapRate}),o===f&&(u=!0))})),o=n.log(r),a.webservice("rerouteLink",null,s,(function(t){var a,s,d;l.prepareUpdate(),a=t.succeeded,s=t.failed,d=t.deletedConnections,i.forEach((function(e){var t,i,r=e.options.linkPID,u=d.indexOf(r);u>-1&&d.splice(u,1),a.indexOf(r)>-1?(e.options.grid.MIL_status=c.getNLSValue("MIL.Status.Success"),e.options.milStatus="success",l.unSelectNode(r),l.updateNode(r,e.options),t=c.getNLSValue("MIL.Message.Success",{suggestion:e.options.grid.MIL_suggestion.label,mfg:e.options.grid.MIL_manufactured}),n.log(t,o)):s.indexOf(r)>-1&&(e.options.milStatus="fail",l.updateNode(r,e.options),i=c.getNLSValue("MIL.Message.Failure",{suggestion:e.options.grid.MIL_suggestion.label,mfg:e.options.grid.MIL_manufactured}),n.log(i,o))})),e.is(d)&&d.length>0&&l.removeNodes(d),l.pushUpdate(),s.length>0?n.warn(c.getNLSValue("MIL.Failure"),o):(n.info(c.getNLSValue("MIL.Success"),o),u&&n.info(c.getNLSValue("MIL.Success.RerouteUsagePoint"),o)),n.log(r+" "+c.getNLSValue("completed"),o)}))},P=function(t,n){var o=t.get("PLMEntity.V_Name")+" "+t.get("revision");return e.is(n)&&(o=o+"("+n.get("PLMInstance.PLM_ExternalID")+")"),o},h=function(t){var n,o,i=t.data.nodeModel;"MIL_suggestion"===t.data.changedAttribute&&e.is(i.options.linkInfos.implementedOccPath)&&(n=i.options.linkInfos.implementedOccPath.split(","),o=n[n.length-1],l.prepareUpdate(),t.data.nodeModel.getBrothers().forEach((function(n){var a,s=n.options.linkInfos.implementedOccPath.split(","),r=s.indexOf(o);r>-1&&r<s.length&&(t.data.changedAttributeValue.label===I.Delete.label&&null===n.options.milStatus?a="applyIgnore":"ignore"===n.options.milStatus&&(a="removeIgnore")),e.is(a)&&("applyIgnore"===a?(n.options.grid.MIL_status=c.getNLSValue("MIL.Status.Ignore.ImpactedObjDelete",{objectTitle:i.options.grid.MIL_manufactured}),n.options.grid.MIL_suggestion=I.Ignore,n.options.milStatus="ignore"):(n.options.grid.MIL_status="",n.options.milStatus=null),l.unSelectNode(n.options.linkPID),l.updateNode(n.options.linkPID,n.options))})),l.pushUpdate())},k=function(){N.push(l.addEventListener("attributeChanged",h))},M=function(){N.forEach((function(e){l.removeEventListener(e)}))},v=S.destroy,e.extend(S,{init:function(t){(D=e.extend(D,t)).onApplyCallBack=m,p()&&(g(),this.buildSkeleton(D),n.notify("startProgress",_),a.getBrokenMfgProcessStatus({rootSystems:b,rootItems:R},(function(e){f(e),k(),n.notify("stopProgress",_)})))},destroy:function(){v.call(this),M()}})}})),define("DS/DELPPWProcessMILModule/MILMfgProcessNItemModule",["DS/DELPPWProcessMILModule/MILMfgProcessNItemUI"],(function(e){"use strict";return{behaviors:["UXFactoryBehavior","TreeListViewBehavior","WUXNodeModelBehavior","MfgProcessBehavior","ModelBehavior","ResourceBehavior","RootsBehavior","BIBehavior","ProcessImplementBehavior"],creator:function(t,n,o,i,l,a,s,c,r,u){var d=null,I=function(){d.setApplyButtonState()};return{name:"MILMfgProcessNItemModule",listenTo:function(){return{select:I}},onStart:function(I){(d=new e(t,n,o,i,l,a,s,c,r,u)).init(I),d.loadUI()},onStop:function(){d.destroy(),d=void 0}}}}}));