var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/layouts/CollectionViewLayout",["require","exports","DS/Core/BaseComponent","DS/Utilities/Utils","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils","UWA/Core","DS/Utilities/typings/types"],(function(e,t,i,o,n,l,r){"use strict";var s=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var o=e.apply(this,t)||this;return l.extendingClassFlag||(o._rightScrollContainerBorderSize=0),o}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{cellHeight:{defaultValue:30,type:"integer"},scrollPaddingBottom:{defaultValue:0,type:"integer"}}},enumerable:!1,configurable:!0}),t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("scrollPaddingBottom")&&this._applyScrollPaddingBottom(t.scrollPaddingBottom),this.invalidate()},t.prototype._applyScrollPaddingBottom=function(e,t){if(this.collectionView){var i=this;this.collectionView.getAllScrollers().forEach((function(e){e&&e.elements.container&&(e.elements.container.style.paddingBottom=i.scrollPaddingBottom+"px")}))}},t.prototype.prepareLayout=function(){this._isInvalid=!1},t.prototype.postRender=function(){},t.prototype._invalidate=function(e){return void 0===e&&(e={freePool:!0}),this._isInvalid=e,e},t.prototype._getInvalidationContext=function(){return this._isInvalid},t.prototype.invalidate=function(e){var t=this._invalidate(e);this.collectionView&&this.collectionView.invalidateLayout(t)},t.prototype.isValid=function(){return!this._isInvalid},t.prototype.isCellSyncedAt=function(e){return!1},t.prototype.getCellType=function(e){var t="__item__";return this.isCellSyncedAt(e)&&(t="__sync_item__"),t},t.prototype.cellTypeCanChangeOnScroll=function(e){return!1},t.prototype.getHeaderContainerHeight=function(){return 0},t.prototype._getFirstCellIDInScroller=function(){return 0},t.prototype.getLeftContainerWidth=function(){return 0},t.prototype.getRightContainerWidth=function(){return 0},t.prototype.getPositionForCellAt=function(e){return{top:e*this.cellHeight,left:0}},t.prototype.getDimensionsForCellAt=function(e){return{width:this.getContentDimensions().width,height:this.cellHeight}},t.prototype.getBoundingBoxForCellAt=function(e){return r.extend(this.getPositionForCellAt(e),this.getDimensionsForCellAt(e))},t.prototype.getContentDimensions=function(){var e=this.collectionView.getViewportDimensions(),t=this.collectionView.getModelLength()*this.cellHeight,i=e.height>t?0:o.getScrollbarWidth();return{width:e.width-i,height:t}},t.prototype.renderListOfVisibleCellsInViewport=function(e){void 0===e&&(e={});var t=this.collectionView.getViewportDimensions(),i=this.collectionView.getScrollerPosition(),o=Math.floor(i.y/this.cellHeight),n=Math.floor((i.y+t.height)/this.cellHeight);o=Math.max(0,o),n=Math.min(n,this.collectionView.getModelLength()-1);for(var l=o;l<=n;l++)e.render(l)},t.prototype.getLayoutStylesForCellAt=function(e){var t=this.getPositionForCellAt(e);return{transform:"translate("+t.left+"px,"+t.top+"px)"}},t.prototype.getLayoutAttributesForCellAt=function(e){return{"cell-id":e}},t.prototype.isCellLayoutValidAt=function(e){return!0},t.prototype.computeCellRange=function(e,t){for(var i=[],o=Math.min(e,t),n=Math.max(e,t),l=o;l<=n;l++)this.collectionView.cellShouldBeSelected(l)&&i.push(l);return i},t.prototype.isCellInRange=function(e,t,i){var o=Math.min(t,i),n=Math.max(t,i);return e>=o&&e<=n},t.prototype.isNodeModelInRange=function(e,t,i){var o=!1;if(e){var n=e._getRowID();o=this.isCellInRange(n,t,i)}return o},t.prototype.getCellsFromNodeModel=function(e,t){var i=[];if(e){var o=e._getRowID();i.push(o)}return i},t.prototype.computeCenterContainerSideMargin=function(e,t,i){var o=t>i?i:t;return"right"===e&&(o+=t?-this._rightScrollContainerBorderSize:0),o},t.prototype.computeSideContainerMaxWidth=function(e,t,i,o){var n={left:{containerWidth:i,oppositeContainerWidth:o},right:{containerWidth:o,oppositeContainerWidth:i}}[e];if(!n)return 0;var l=0;return n.containerWidth>0&&(l=n.oppositeContainerWidth>0?Math.floor((t-100)/2):Math.floor(t-100)),l},t.prototype.computeCenterContainerMinWidth=function(e,t,i){var o=i-e-t;return e<=0&&t<=0&&(o=100),o},t.prototype.computeSideContainerWidth=function(e,t,i){var o=0;if("left"===e){var n=i||2;o=t+(t?n:0)}else if("right"===e){n=i||1;o=t+(t?n:0)}return o},t.prototype.hasCellsInLeftContainer=function(){return!1},t.prototype.hasCellsInRightContainer=function(){return!1},t.prototype.importJsonPreferences=function(e,t){},t.prototype.getLeafColumns=function(){},t.prototype.getCellCoordinatesAt=function(e){},t.prototype._getColumnWidth=function(){},t.prototype.getRowHeight=function(){},t}(i);return n.addClass(s,"CollectionViewLayout"),s})),define("DS/CollectionView/CollectionViewServerSideBridge",["DS/TreeModel/DataSourceBase","DS/Utilities/UUID","DS/Utilities/Debug","DS/Utilities/Dom"],(function(e,t,i,o){"use strict";return class{constructor(t,i,n,l,r){this.collectionView=t,this.modelId=n,this.communicationComponent=i,this.requestsMap={},this._xsoListeningDisabled=0,this._modelChangeListeningDisabled=0,this._onNodeModelUpdateCB=l;let s=new e;s.getModelItems=e=>{this._request("ModelItems",e)},s.hasModelStructureRequest=()=>!0,s.getModelStructure=e=>{this._request("ModelStructure",e)},s.getGroupedModelItems=e=>{this._request("ModelItems",e)},this._onNodeModelUpdateCB&&(s.onNodeModelUpdate=this._onNodeModelUpdateCB),this.collectionView.dataSource=s,t.addEventListener("allCellsRendered",(()=>{this._centerViewOnNodePath&&this._onServerViewUpdate(this._centerViewOnNodePath);this._sendInfo("allCellsRendered",{request:{}})}));const a=t.getTreeDocument();a&&(a.onNodeModelUpdate((e=>{if(this._modelChangeListeningDisabled>0)return;const t=function(e){if(e&&"nodesChanged"===e.operationType&&Array.isArray(e.nodes)&&e.nodes.length>0){a.prepareUpdate(),this._modelChangeListeningDisabled++;for(let t=0;t<e.nodes.length;t++){const i=e.nodes[t];if(i){const e=a.getNodeFromStructurePath(i.indexPath);e&&e.updateOptions({grid:i.properties})}}this._modelChangeListeningDisabled--,a.pushUpdate()}},i=e.data.nodeModel;if(i){const o={request:{operationType:"nodesChanged",nodes:[{indexPath:this.buildStructureIndexArray(i),properties:e.data.attributes}]},successCallback:t.bind(this)};this._request("ModelChange",o)}})),a.onPreCollapse((e=>{if(!e||!e.data||!e.data.nodeModel)return;if(this._modelChangeListeningDisabled>0)return;const t={request:{nodesToCollapse:[e.data.nodeModel.buildStringIdentifierArray()]},successCallback:function(e){e&&((e.nodesToExpand||[]).forEach((e=>{const t=a.getNodeFromStructurePath(e);t&&t.expand()})),e.nodesToCollapse&&e.nodesToCollapse.length&&window.console.warn("Error in collapseCorrection"))}};this._request("ModelCollapseExpand",t)})));const d=e=>{const t=[];return e.forEach((e=>{const i=this.buildStructureIndexArray(e);t.push(i)})),t},c=e=>{this._handleSelectionChange(e)},u=t.getNodesXSO();u&&(u.onPostAdd((e=>{if(this._xsoListeningDisabled)return;const t={request:{addedNodes:d(e)},successCallback:c};this._request("SelectionChange",t)})),u.onPostRemove((e=>{if(this._xsoListeningDisabled)return;const t={request:{removedNodes:d(e)},successCallback:c};this._request("SelectionChange",t)})));const h=t.getCellsXSO();if(h){function p(e,i){if(this._xsoListeningDisabled)return;const o={request:{[i]:(e=>{const i=[];return e.forEach((function(e){i.push(t.getCellIDFromXSOElement(e))})),i})(e)},successCallback:c};this._request("SelectionChange",o)}h.onPostAdd((e=>{p(e,"addedCells")})),h.onPostRemove((e=>{p(e,"removedCells")}))}o.addEventOnElement(t,t,"activeCellChange",(()=>{const e=t.getActiveCellID(),i=t.getCellInfosAt(e);if(i&&i.columnID>-1){const e=t?.layout?.getDataIndexFromColumnIndex?t.layout.getDataIndexFromColumnIndex(i.columnID):void 0;if(e&&i.nodeModel){const t={request:{node:this.buildStructureIndexArray(i.nodeModel),dataIndex:e}};this._request("ActiveCellChange",t)}}})),r&&(t.onContextualEvent=e=>{if(!e||!e.cellInfos)return;return new Promise((i=>{const o=t.layout&&t.layout.getDataIndexFromColumnIndex?t.layout.getDataIndexFromColumnIndex(e.cellInfos.columnID):void 0;this.requestPointerEvent({nodeModel:e.cellInfos.nodeModel,button:2,dataIndex:o},(function(e){i(e&&e.menu)}))}))})}_handleSelectionChange(e){if(e&&this.collectionView){let t=this.collectionView.getTreeDocument();if(t){let i=this.collectionView.getNodesXSO();if(i){let o=[],n=[],l=e.addedNodes;if(l)for(let e=0;e<l.length;e++){let i=l[e],n=t.getNodeFromStructurePath(i);n&&o.push(n)}let r=e.removedNodes;if(r)for(let e=0;e<r.length;e++){let i=r[e],o=t.getNodeFromStructurePath(i);o&&n.push(o)}this._xsoListeningDisabled++,o.length>0&&i.add(o),n.length>0&&i.remove(n),this._xsoListeningDisabled--}}}}_handleViewUpdate(e){e&&e.centerNode&&this._onServerViewUpdate(e.centerNode)}_onServerViewUpdate(e){if(!e||!this.collectionView)return;let t=this.collectionView.getTreeDocument();if(t){let i=t.getNodeFromStructurePath(e);i?(this._centerViewOnNodePath=void 0,this.collectionView.ensureNodeModelVisible(i,!0,!0,.5,!0)):this._centerViewOnNodePath=e}}answerToAServerRequest(e,t){if("WIN_ModelChange"===e){if(this.collectionView&&t){let i=t.data;if(Array.isArray(i))for(let e=0;e<i.length;e++){let t=i[e];if(t&&"nodesChanged"===t.operationType&&Array.isArray(t.nodes)&&t.nodes.length>0){let e=t.nodes[0];e&&(t.nodesNumber=1,t.nodesPath=e.indexPath,t.modifications=e.properties)}}this._modelChangeListeningDisabled++,this._xsoListeningDisabled++,this.collectionView.dataSource.pushUpdatesNotifications(t.data,function(i){this._answer(e,t,i),this._modelChangeListeningDisabled--,this._modelChangeListeningDisabled<0&&(window.console.warn("Error in WIN_ModelChange : this._modelChangeListeningDisabled = "+this._modelChangeListeningDisabled),this._modelChangeListeningDisabled=0),this._xsoListeningDisabled--}.bind(this))}return}let i;switch(e){case"WIN_getLoadedRows":i=this.collectionView&&this.collectionView.getTreeDocument()?this.collectionView.getTreeDocument().dump():{error:"No TreeDocument"};break;case"WIN_SelectionChange":t?this._handleSelectionChange(t):i={error:"No selection input"};break;case"WIN_ViewUpdate":t&&t.data&&this._handleViewUpdate(t.data)}this._answer(e,t,i)}serverRequest(e,t){if(e.includes("WIN_"))this.answerToAServerRequest(e,t);else switch(e){case"WEB_ModelItems_ANSWER":case"WEB_ModelStructure_ANSWER":case"WEB_ModelChange_ANSWER":case"WEB_SelectionChange_ANSWER":this._xsoListeningDisabled++,this._modelChangeListeningDisabled++,this._receiveAnswer(e,t),this._modelChangeListeningDisabled--,this._xsoListeningDisabled--;break;default:this._receiveAnswer(e,t)}}_sendInfo(e,i){i.successCallback&&(i.request.uuid=t.createUUID(),this.requestsMap[i.request.uuid]=i);let o=i?i.request:{};this.communicationComponent&&this.communicationComponent.sendCommand(this,"WEBInfo_"+e,o,this.modelId)}_request(e,i){i.successCallback&&(i.request.uuid=t.createUUID(),this.requestsMap[i.request.uuid]=i),this.communicationComponent&&this.communicationComponent.sendCommand(this,"WEB_"+e,i.request,this.modelId)}_answer(e,t,o){let n={data:o};if(t&&t.winId)return n.winId=t.winId,void(this.communicationComponent&&this.communicationComponent.sendCommand(this,e+"_ANSWER",n,this.modelId));i.log("WUXViewServerSideBridge","[View ServerSideBridge] "+e+" has no input")}_receiveAnswer(e,t){t&&t.uuid&&this.requestsMap[t.uuid]&&(this.requestsMap[t.uuid].successCallback(t),delete this.requestsMap[t.uuid])}buildStructureIndexArray(e){let t=e.getStructurePath().split("/");t=t.slice(0,t.length-1);let i=[];return t.forEach((e=>i.push(Number(e)))),i}requestPointerEvent(e,t){if(!e)return;let i={idsPath:e.nodeModel?e.nodeModel.buildStringIdentifierArray():[],dataIndex:e.dataIndex};["type","pointerType","button","hitCount"].forEach((t=>{e.hasOwnProperty(t)&&(i[t]=e[t])}));let o=0;e.shiftKey&&(o|=1),e.altKey&&(o|=2),e.ctrlKey&&(o|=4),o&&(i.modifiers=o);let n={request:i};t&&(n.successCallback=t),this._request("PointerEvent",n)}getType(){return"CollectionViewServerSideBridge"}}}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/CollectionViewCell",["require","exports","DS/Controls/Abstract","DS/Core/WebUXComponents","DS/Utilities/Utils"],(function(e,t,i,o,n){"use strict";var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(t){this.collectionView=t&&void 0!==t.collectionView?t.collectionView:null,this.cellType=t&&void 0!==t.cellType?t.cellType:"",this._reusableContent=null,this.__cachedAttributes={},this.__cachedStyles={},this.__cachedCssClasses=null,e.prototype.init.call(this,t)},t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t),this.elements.container.addClassName("wux-layouts-collectionview-cell")},t.prototype._getContentContainer=function(){return this.getContent()},t.prototype._getReusableContent=function(){return this.getReusableContent()},t.prototype.getReusableContent=function(){return this._reusableContent},t.prototype._setReusableContent=function(e){this.setReusableContent(e)},t.prototype.setReusableContent=function(e){if(this._reusableContent!==e&&this.elements.container){var t=this._getContentContainer();if(t){if(this._reusableContent){var i=n.isUWAAbstract(this._reusableContent)?this._reusableContent.getContent():this._reusableContent;if(e){var o=n.isUWAAbstract(e)?e.getContent():e;null===i.parentElement?t.appendChild(o):t.replaceChild(o,i)}else t.innerHTML="";this._reusableContent.__disposable__&&this._reusableContent.__disposable__.dispose()}else if(e){o=n.isUWAAbstract(e)?e.getContent():e;t.appendChild(o)}this._reusableContent=e}}},t.prototype.reuseCellContent=function(e){var t=this.collectionView.reuseCellContent(e);this.setReusableContent(t)},t.prototype.computeContentSize=function(){var e,t=0;if(this._reusableContent&&(this._reusableContent.computeContentSize?t+=this._reusableContent.computeContentSize():n.isHTMLElement(this._reusableContent)?e=this._reusableContent:this._reusableContent.elements&&this._reusableContent.elements.container&&n.isHTMLElement(this._reusableContent.elements.container)&&(e=this._reusableContent.elements.container)),e){var i=this.getContent().style,o=i.lineHeight,l=i.display;i.lineHeight="",i.display="block",t+=e.offsetWidth,i.display=l,i.lineHeight=o}return Math.ceil(t)},t.prototype._updateTooltip=function(e){this.tooltipInfos=void 0===e?void 0:e},t.prototype.getInitialClassName=function(){return"wux-controls-abstract wux-layouts-collectionview-cell"},t.prototype.destroy=function(){this._reusableContent&&this._reusableContent.__disposable__&&this._reusableContent.__disposable__.destroy(),e.prototype.destroy.call(this)},t}(i);return o.addClass(l,"CollectionViewCell"),l})),define("DS/CollectionView/ModelBase",["DS/Core/BaseComponent","DS/TreeModel/TreeDocument","DS/Utilities/StringUtils"],(function(e,t,i){"use strict";return e.inherit({name:"ModelBase",publishedProperties:{collectionView:{defaultValue:null,type:"object"},treeDocument:{defaultValue:null,type:"object"}},collectionView:{},_applyProperties:function(e){this._parent(e),this.isDirty("collectionView")&&this._applyCollectionView(e.collectionView)},_applyCollectionView:function(e){},_applyTreeDocument:function(e){},_getTreeDocument:function(){return this.treeDocument},_computeMatchingStringsCount:function(){let e=0;for(let t=0;t<this.collectionView._matchingFoundArrays.length;t++)e+=this.collectionView._matchingFoundArrays[t].length;return e},_findAndDisplayAllCellIDsMatchingFindStr:function(e,t,i,o,n,l,r){const s=this,a=this.collectionView,d=performance.now();s._lastFindRequestTimeStamp=d;const c=function(i,n,r){n||s._findAllCellIDsMatchingFindStrInClientSide(e,t,o),l.call(a,i,r)};n?c.call(s,i,r):this._updateClientModelFromFind(e,t,i,c,r)},_updateClientModelFromFind:function(e,t,i,o,n,l){return o?o.call(this,i,n,l):0},_findAllCellIDsMatchingFindStrInClientSide:function(e,i,o){const n=this.collectionView;if(n._matchingFoundArrays=[],n._matchingCellIDsArray=[],n._matchingCellIDsMap={},n._matchingNodeModelsArray=[],n._matchingNodeModelsMap={},n._matchingAllNodeModelsArray=[],!o){const l=n.getNodeModelToProcessForFind;if(l)o=l.call(n,e,i);else{o=[];const e=this._getTreeDocument();n.modelProvider?(o=n.modelProvider.flattenApplicativeModel(n.applicativeModel),n.getTreeDocument()instanceof t&&(o=o.filter((e=>!1===e.isHidden()&&!1===e.isFiltered())))):e._getTrueRoot().processDescendants({onlyVisibleNodes:!1,processNode:function(e){const t=e.nodeModel;t&&!1===t.isHidden()&&!1===t.isFiltered()&&o.push(t)}})}}0!==o.length&&this._processNodeModelsForFind(o,e,i)},_processNodeModelsForFind:function(e,t,o){const n=this.collectionView,l=i.toComparable(n.findStr.toString(),{toLowerCase:!o});for(let t=0;t<e.length;t++){const r=e[t];if(r&&(r.hasRowID&&r.hasRowID()/*!nodeModel.hasNoRepresentation()*/||!r.hasRowID)){const e=!r.isVisible||r.isVisible(),s=n.getCellInfosAt(t),a=!1===e?-1:s.cellID,d=n._getCellValueAsStringForFind(s);if(d&&UWA.is(d,"string")){const e=i.toComparable(d.toString(),{toLowerCase:!o}),t=n._getIndexesOfMatchingString(e,l);if(t.length>0){n._matchingFoundArrays.push(t),n._matchingCellIDsArray.push(a);const e=r.buildStringIdentifierArray;r._idForFind=e,n._matchingAllNodeModelsArray.push(r),-1!==a&&(n._matchingCellIDsMap[a]=n._matchingCellIDsArray.length-1),-1===n._matchingNodeModelsArray.indexOf(r)&&n._matchingNodeModelsArray.push(r),r._getRowID&&void 0!==r._getRowID()&&null!==r._getRowID()&&void 0===n._matchingNodeModelsMap[r._getRowID()]&&(n._matchingNodeModelsMap[r._getRowID()]=n._matchingNodeModelsArray.length-1)}}}}},_computeCurrentMatchingStringIndex:function(e,t){let i;return i=t>0?t-1:0,i},_computeFindEditorCurrentValue:function(){let e;return"substring"===this.collectionView.findNavigationMode&&(e=this.collectionView._currentMatchingStringIndex+1),e},_computeMatchingNodeModelsCount:function(){return this.collectionView._matchingNodeModelsArray.length},_computeNextMatchingData:function(e,t){let i=-1;if("substring"===e.findNavigationMode)i=e._currentMatchingStringIndex===this._computeMatchingStringsCount(t)-1?0:e._currentMatchingStringIndex+1;else if("cell"===e.findNavigationMode){let t=e._currentMatchingCellIDIndex;t===e._matchingCellIDsArray.length-1?t=0:t+=1,i=e._getMatchingStringIndexFromMatchingCellIDIndex(t)}return i},_computePreviousMatchingData:function(e){let t=-1;if("substring"===e.findNavigationMode)t=0===e._currentMatchingStringIndex?e.matchingStringCount-1:e._currentMatchingStringIndex-1;else if("cell"===e.findNavigationMode){let i=e._currentMatchingCellIDIndex;0===i?i=e._matchingCellIDsArray.length-1:i-=1,t=e._getMatchingStringIndexFromMatchingCellIDIndex(i)}else{let i=e._currentMatchingRowIDIndex;0===i?i=e._matchingNodeModelsArray.length-1:i-=1,t=e._getMatchingStringIndexFromMatchingRowIDIndex(i)}return t},_isServerSide:function(){return!1}})}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/CollectionViewPaginationManager",["require","exports","DS/Controls/Abstract","DS/Core/WebUXComponents"],(function(e,t,i,o){"use strict";var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{pageSize:{defaultValue:100,type:"number"},currentPage:{defaultValue:1,type:"integer",advancedSetter:!0}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.prototype.init.apply(this,t),this._id=0},t.prototype.updatePagination=function(){if(this._collectionView&&this._collectionView._onPaginationChangeAsyncLoadModelCB){var e=this;this._asyncPaginationTimeout&&clearTimeout(this._asyncPaginationTimeout),this._asyncPaginationTimeout=setTimeout((function(){e._collectionView._modelEvents.subscribeOnce({event:"paginationChangeAsyncDone"},(function(){e._collectionView._asyncPaginationInitialized=!0,e._collectionView.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!1}),e._broadcastPaginationUpdate()})),e._collectionView._onPaginationChangeAsyncLoadModelCB.call(e._collectionView,{pageSize:e.pageSize,currentPage:e.currentPage})}),800)}else this._collectionView&&this._collectionView._updateModel(),this._broadcastPaginationUpdate()},t.prototype._applyPageSize=function(){this.updatePagination()},t.prototype._preEditCurrentPage=function(e,t){return parseInt(t)===t&&t>=1},t.prototype._applyCurrentPage=function(){this.updatePagination()},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),(this.isDirty("pageSize")||this.isDirty("currentPage"))&&this.updatePagination()},t.prototype._broadcastPaginationUpdate=function(){if(this._paginationUpdateSubscribers&&this._paginationUpdateSubscribers.length)for(var e=0;e<this._paginationUpdateSubscribers.length;e++){var t=this._paginationUpdateSubscribers[e];t.methodToCall.call(t.instance)}},t.prototype.subscribeToPaginationUpdate=function(e,t){return this._paginationUpdateSubscribers||(this._paginationUpdateSubscribers=[]),this._paginationUpdateSubscribers.push({instance:e,methodToCall:t,id:this._id++}),this._id},t.prototype.unsubscribeToPaginationUpdate=function(e){if(!this._paginationUpdateSubscribers||e>this._id||e<0)return console.warn("Trying to unsubscribe from pagination update an id that has not been subscribed before"),!1;for(var t=0;t<this._paginationUpdateSubscribers.length;t++)if(this._paginationUpdateSubscribers[t].id===e)return this._paginationUpdateSubscribers.splice(t,1),!0;return!1},t.prototype.pageNumberModified=function(){this._collectionView&&this._broadcastPaginationUpdate()},t.prototype.getPageNumber=function(){if(this._collectionView){var e=this._collectionView.getModelLength();if(e)return Math.ceil(e/this.pageSize);if(0===e)return 1}},t.prototype.getNumberOfItemsOnPage=function(e){void 0===e&&(e=this.currentPage);var t=this._collectionView.getModelLength(),i=Math.max(Math.ceil(t/this.pageSize),1);return e>i||e<0?void 0:e===i?t-(i-1)*this.pageSize:this.pageSize},t}(i);return o.addClass(n,"CollectionViewPaginationManager"),n})),define("DS/CollectionView/typings/types",[],(()=>{})),define("DS/CollectionView/CollectionViewStatusBar",["DS/TreeModel/TreeDocument","DS/Tweakers/GeneratedToolbar","i18n!DS/CollectionView/assets/nls/collectionviewstatusbar"],(function(e,t,i){"use strict";function o(e,t){return t?{grid:{data:e}}:{id:this._defaultStatusCpt++,dataElements:{typeRepresentation:"string",value:e}}}function n(e,t){var n=i.get("TotalRows")+e;return o.call(this,n,t)}function l(e,t){var n=i.get("TotalVisibleRows")+e;return o.call(this,n,t)}function r(e,t){var n=i.get("SelectedRows")+e;return o.call(this,n,t)}function s(e,t,n){var l=i.get("SelectedCountOfTotalCount",{selectedCount:e,totalCount:t});return o.call(this,l,n)}function a(e,t){var n=i.get("SelectedCells")+e;return o.call(this,n,t)}function d(e,t){var n=e>-1?this.collectionView.getCellIDAsString(e):i.get("NoActiveCell"),l=o.call(this,n,t);return!t&&l&&l.dataElements&&(l.dataElements.tooltip=i.get("ActiveCellTooltip")),l}function c(e){var t=this;if(t.collectionView&&t.collectionView.paginationManager){var i=t.collectionView.paginationManager.currentPage,o=t.collectionView.paginationManager.getPageNumber();return i>o&&(i=o),e?{grid:{data:i},minValue:1,maxValue:o}:{id:t._defaultStatusCpt++,dataElements:{typeRepresentation:"pagination",value:i,readOnly:!1,minValue:1,maxValue:o}}}}function u(e){var t={position:e.position||"near",readOnly:!0};switch(e.type){case h.STATUS.NB_ITEMS:var i=this._isCollectionViewUsingATreeDocument&&!this.collectionView.virtuallyLoadAllModelItems?this.collectionView.getTreeDocument().getAllDescendants().length:this.collectionView.getModelLength();UWA.extend(t,n.call(this,i)),this._listOfTotalRowsStatusNode.push(t.id);break;case h.STATUS.NB_VISIBLE_ITEMS:i=this._isCollectionViewUsingATreeDocument&&!this.collectionView.virtuallyLoadAllModelItems?this.collectionView.getTreeDocument().getNumberOfVisibleDescendants():this.collectionView.getModelLength();UWA.extend(t,l.call(this,i)),this._listOfTotalVisibleRowsStatusNode.push(t.id);break;case h.STATUS.NB_SELECTED_ROWS:if(!(u=this.collectionView.getNodesXSO()))return;UWA.extend(t,r.call(this,u.get().length)),this._listOfSelectedRowsStatusNode.push(t.id);break;case h.STATUS.NB_SELECTED_CELLS:var o=this.collectionView.getCellsXSO();if(!o)return;UWA.extend(t,a.call(this,o.get().length)),this._listOfSelectedCellsStatusNode.push(t.id);break;case h.STATUS.NB_SELECTED_AND_TOTAL_ROWS:var u;if(!(u=this.collectionView.getNodesXSO()))return;i=this._isCollectionViewUsingATreeDocument&&!this.collectionView.virtuallyLoadAllModelItems?this.collectionView.getTreeDocument().getAllDescendants().length:this.collectionView.getModelLength();UWA.extend(t,s.call(this,u.get().length,i)),this._listOfSelectedAndTotalRowsStatusNode.push(t.id);break;case h.STATUS.ACTIVE_CELL:var p=this.collectionView.getActiveCellID();UWA.extend(t,d.call(this,p)),this._listOfActiveCellStatusNode.push(t.id);break;case h.STATUS.PAGINATION:UWA.extend(t,c.call(this)),this._listOfPaginationNode.push(t.id);break;case h.STATUS.CUSTOM:default:UWA.extend(t,e)}return t}var h=t.inherit({publishedProperties:{overflowManagement:{defaultValue:"dropdown",type:"string",category:"Behavior"},height:{defaultValue:"auto",type:"string"},collectionView:{defaultValue:null,type:"DS/CollectionView/CollectionView",readOnly:!0,noNeedToApplyFlag:!0}},updateActiveCellID:function(e){var t=d.call(this,e,!0);this._listOfActiveCellStatusNode.forEach((function(e){e.updateOptions(t)}))},updateTotalRows:function(){let e=this.collectionView,t=e.virtuallyLoadAllModelItems?e.getModelLength():this._isCollectionViewUsingATreeDocument?e.getTreeDocument().getAllDescendants().length:e.getModelLength();var i=n.call(this,t,!0);this._listOfTotalRowsStatusNode.forEach((function(e){e.updateOptions(i)}))},updateTotalVisibleRows:function(){let e=this.collectionView,t=e.virtuallyLoadAllModelItems?e.getModelLength():this._isCollectionViewUsingATreeDocument?e.getTreeDocument().getNumberOfVisibleDescendants():e.getModelLength(),i=l.call(this,t,!0);this._listOfTotalVisibleRowsStatusNode.forEach((function(e){e.updateOptions(i)}))},updatePagination:function(e){var t=c.call(this,!0);this._listOfPaginationNode.forEach((function(e){e.updateOptions(t)}))},setModel:function(e){this._clean();var t=[],i=this;e.forEach((function(e){var o=u.call(i,e);o&&o.dataElements&&t.push(o)})),i.updateModel({entries:t}),this._listOfTotalRowsStatusNode.forEach((function(e,t){i._listOfTotalRowsStatusNode[t]=i.getNodeModelByID(e)})),this._listOfSelectedRowsStatusNode.forEach((function(e,t){i._listOfSelectedRowsStatusNode[t]=i.getNodeModelByID(e)})),this._listOfSelectedAndTotalRowsStatusNode.forEach((function(e,t){i._listOfSelectedAndTotalRowsStatusNode[t]=i.getNodeModelByID(e)})),this._listOfSelectedCellsStatusNode.forEach((function(e,t){i._listOfSelectedCellsStatusNode[t]=i.getNodeModelByID(e)})),this._listOfActiveCellStatusNode.forEach((function(e,t){i._listOfActiveCellStatusNode[t]=i.getNodeModelByID(e)})),this._listOfPaginationNode.forEach((function(e,t){i._listOfPaginationNode[t]=i.getNodeModelByID(e)})),this._listOfTotalVisibleRowsStatusNode.forEach((function(e,t){i._listOfTotalVisibleRowsStatusNode[t]=i.getNodeModelByID(e)}));var o=this.collectionView.paginationManager;o&&(i._listOfPaginationNode.forEach((function(e){e.addEventListener("nodeModelUpdate",(function(){o.currentPage=e.options.grid.data}))})),o.subscribeToPaginationUpdate(i,(function(){i.updatePagination()})))},_preBuildView:function(t){t.items||(t.items=new e,this._properties.items.value=t.items),this._parent(t)},buildView:function(){this._parent(),this.getContent().addClassName("wux-collectionview-statusBar"),this._clean(),this._isCollectionViewUsingATreeDocument=!1},_postBuildView:function(){if(this._parent(),this.collectionView){var e=this,t=this.collectionView,i=this.collectionView.getNodesXSO();if(i){var o=function(o){if(e._listOfSelectedRowsStatusNode.length>0){var n=r.call(e,i.get().length,!0);e._listOfSelectedRowsStatusNode.forEach((function(e){e.updateOptions(n)}))}if(e._listOfSelectedAndTotalRowsStatusNode.length>0){var l=t.virtuallyLoadAllModelItems?t.getModelLength():t.getTreeDocument().getAllDescendants().length;n=s.call(e,i.get().length,l,!0);e._listOfSelectedAndTotalRowsStatusNode.forEach((function(e){e.updateOptions(n)}))}};i.onPostAdd(o),i.onPostRemove(o)}var n=this.collectionView.getCellsXSO();if(n){var l=function(t){var i=a.call(this,n.get().length,!0);e._listOfSelectedCellsStatusNode.forEach((function(e){e.updateOptions(i)}))};n.onPostAdd(l),n.onPostRemove(l)}var d=this.collectionView.getTreeDocument();if(d){this._isCollectionViewUsingATreeDocument=!0;var c=!1;d.onUpdate((function(){c&&(c=!1,e.updateTotalRows(),e.updateTotalVisibleRows())}));var u=function(){c=!0};d.addEventListener("addChild",u),d.addEventListener("removeChild",u),d.onPostExpand(this.updateTotalVisibleRows.call(this)),d.onPostCollapse(this.updateTotalVisibleRows.call(this))}}},_clean:function(){this._defaultStatusCpt=0,this._listOfTotalRowsStatusNode=[],this._listOfTotalVisibleRowsStatusNode=[],this._listOfSelectedRowsStatusNode=[],this._listOfSelectedAndTotalRowsStatusNode=[],this._listOfSelectedCellsStatusNode=[],this._listOfActiveCellStatusNode=[],this._listOfPaginationNode=[]},_applyHeight:function(e){this.getContent().setStyle("height",this.height)},_applyProperties:function(e){this._parent(e),this.isDirty("height")&&this._applyHeight(e.height)}});return h.STATUS={CUSTOM:0,NB_ITEMS:1,NB_SELECTED_ROWS:2,NB_SELECTED_CELLS:3,ACTIVE_CELL:4,PAGINATION:5,NB_VISIBLE_ITEMS:6,NB_SELECTED_AND_TOTAL_ROWS:7},h}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/edition/CollectionViewEdition",["require","exports","DS/Core/BaseComponent","DS/Utilities/KeyboardUtils"],(function(e,t,i,o){"use strict";var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onCellActivate=function(e){return 0},t.prototype.onCellUnactivate=function(e){return 0},t.prototype.onCellPreselect=function(e){return 0},t.prototype.onCellEndPreselect=function(e){return 0},t.prototype.onCellPointerDown=function(e){return 0},t.prototype.onCellDoubleClick=function(e){return 0},t.prototype.onCellDragStart=function(e){return 0},t.prototype.onF2=function(e){return 0},t.prototype.onEscape=function(e){return 0},t.prototype.onEnter=function(e){return 0},t.prototype.onKeyEvent=function(e,t){return!this.collectionView.editOnKeyPressFlag||this.collectionView.getFocusOnCellContentFlag()||"keydown"!==t.type||t.ctrlKey||t.altKey||t.keyCode===o.SHIFT||!(t.keyCode<o.F1||t.keyCode>o.F12)?{stopPropagation:!1}:(this.collectionView._setEditionMode(e,!0),this.collectionView.setFocusOnCellContentFlag(!0),{stopPropagation:!0})},t.prototype.isCellAlwaysInEdition=function(e){return!1},t}(i);return n})),define("DS/CollectionView/modelProviders/CollectionViewModelProvider",["require","exports","DS/Selection/XSO"],(function(e,t,i){"use strict";return function(){function e(){this.modelEventsListener=[]}return e.prototype._pushUpdateView=function(e,t){var i=this.collectionView;i&&(i._updateCounter--,0===i._updateCounter&&(i._updateNeeded||t)&&this.updateView(e,t))},e.prototype.getModelClass=function(){},e.prototype.addModelEvents=function(){},e.prototype.removeModelEvents=function(){},e.prototype.flattenApplicativeModel=function(e){throw new Error("No implementation found for flattenApplicativeModel method.")},e.prototype.fillApplicativeModelFromViewModel=function(e,t){throw new Error("No implementation found for fillApplicativeModelFromArrayModel method.")},e.prototype.getNodeModelRowID=function(e,t){return this.collectionView.model.indexOf(e)},e.prototype.selectNode=function(e,t){var i=this.getNodesXSO();i&&(t?i.unique(e):this.isNodeSelected(e)||i.add(e))},e.prototype.unSelectNode=function(e){var t=this.getNodesXSO();t&&this.isNodeSelected(e)&&t.remove(e)},e.prototype.isNodeSelected=function(e){var t=this.getNodesXSO();return!!t&&t.isIn(e)},e.prototype.selectAllVisibleNodes=function(){throw new Error("No implementation found for selectAllVisibleNodes method.")},e.prototype.unselectAll=function(){var e=this.getNodesXSO();e&&e.empty()},e.prototype.isNodeVisible=function(e){return!0},e.prototype.isNodeModelInRange=function(e,t,i){var o=!1;if(e){var n=this.getNodeModelRowID(e);o=this.isCellInRange(n,t,i)}return o},e.prototype.isCellInRange=function(e,t,i){var o=Math.min(t,i),n=Math.max(t,i);return e>=o&&e<=n},e.prototype.shouldAcceptDrag=function(e){return!0},e.prototype.dumpNodeModel=function(e,t){throw new Error("No implementation found for dumpNodeModel method.")},e.prototype.getNodesXSO=function(){return this.collectionView.supportsSelection()?(this.selectionModel||(this.selectionModel=new i({getElementID:this.getXSOElementID,useUniqueID:!0,areEquals:this.areXSONodesEquals}),this.collectionView._addModelEvents()),this.selectionModel):null},e.prototype.getXSOElementID=function(e){throw new Error("No implementation of getXSOElementID is found.")},e.prototype.areXSONodesEquals=function(e,t){return e.getXSOElementID()===t.getXSOElementID()},e.prototype.getPropertyValue=function(e,t){return""},e.prototype.updateView=function(e,t){var i=this.collectionView;i&&i._isReady&&i._renderViewport(e)},e}()})),define("DS/CollectionView/commands/CollectionViewCommands",["require","exports"],(function(e,t){"use strict";return{copy:function(){return this.onCopy()},paste:function(){return this.onPaste()},cut:function(){return this.onCut()},deleteKeyPressed:function(){var e=this.getTreeDocument?this.getTreeDocument():void 0;return e&&e.getXSO()&&this._modelEvents.publish({event:"deleteKeyPressed",data:e.getXSO().get()}),{stopPropagation:!1}},selectAll:function(){return this.selectAllVisibleNodes(),{preventDefault:!0}},escape:function(){var e=!1,t=this.getActiveCellID();if(-1!==t){var i=this.getEditionManager(t);i&&(e=1===i.onEscape(t))}return this.selectionBehavior.unselectAllOnEscapeKey&&!e&&this.unselectAll(),{stopPropagation:e}},enter:function(){var e=this.getActiveCellID();if(-1!==e){var t=this.getEditionManager(e);return t&&t.onEnter(e),this.selectCell(this.computeCellIDFromActiveCell("enter"),!1,!1),{preventDefault:!0}}return{preventDefault:!0,stopPropagation:!1}},shiftEnter:function(){var e=this.getEditionManager(this.getActiveCellID());return e&&e.onEnter(this.getActiveCellID()),this.selectCell(this.computeCellIDFromActiveCell("enter",!1,!0),!1,!1),{preventDefault:!0}},ctrlSpaceKeyPressed:function(e){if(!e.actionPerformed){var t=this.getActiveCellID();return void 0!==t&&(this.isCellSelected(t)?this.unselectCell(t):this.selectCell(t,!0,!1)),{preventDefault:!0}}},upMove:function(){var e=this.computeCellIDFromActiveCell("up");return this.selectionBehavior.toggle?this.setActiveCell(e):this.selectCell(e,!1,!1),{preventDefault:!0}},rightMove:function(){var e=this.computeCellIDFromActiveCell("right");return this.selectionBehavior.toggle?this.setActiveCell(e):this.selectCell(e,!1,!1),{preventDefault:!0}},downMove:function(){var e=this.computeCellIDFromActiveCell("down");return this.selectionBehavior.toggle?this.setActiveCell(e):this.selectCell(e,!1,!1),{preventDefault:!0}},leftMove:function(){var e=this.computeCellIDFromActiveCell("left");return this.selectionBehavior.toggle?this.setActiveCell(e):this.selectCell(e,!1,!1),{preventDefault:!0}},ctrlUp:function(){return this.setActiveCell(this.computeCellIDFromActiveCell("up",!0)),{preventDefault:!0}},ctrlRight:function(){return this.setActiveCell(this.computeCellIDFromActiveCell("right",!0)),{preventDefault:!0}},ctrlDown:function(){return this.setActiveCell(this.computeCellIDFromActiveCell("down",!0)),{preventDefault:!0}},ctrlLeft:function(){return this.setActiveCell(this.computeCellIDFromActiveCell("left",!0)),{preventDefault:!0}},shiftUp:function(){return this.selectCell(this.computeCellIDFromActiveCell("up",!1,!0),!1,!0),{preventDefault:!0}},shiftRight:function(){return this.selectCell(this.computeCellIDFromActiveCell("right",!1,!0),!1,!0),{preventDefault:!0}},shiftDown:function(){return this.selectCell(this.computeCellIDFromActiveCell("down",!1,!0),!1,!0),{preventDefault:!0}},shiftLeft:function(){return this.selectCell(this.computeCellIDFromActiveCell("left",!1,!0),!1,!0),{preventDefault:!0}},tab:function(){return this.selectCell(this.computeCellIDFromActiveCell("tab"),!1,!1),{preventDefault:!0}},shiftTab:function(){return this.selectCell(this.computeCellIDFromActiveCell("tab",!1,!0),!1,!1),{preventDefault:!0}},pageup:function(){return this.selectCell(this.computeCellIDFromActiveCell("pageup"),!1,!1),{preventDefault:!0}},pagedown:function(){return this.selectCell(this.computeCellIDFromActiveCell("pagedown"),!1,!1),{preventDefault:!0}},shiftPageup:function(){return this.selectCell(this.computeCellIDFromActiveCell("pageup",!1,!0),!1,!0),{preventDefault:!0}},shiftPagedown:function(){return this.selectCell(this.computeCellIDFromActiveCell("pagedown",!1,!0),!1,!0),{preventDefault:!0}},home:function(){return this.selectCell(this.computeCellIDFromActiveCell("home"),!1,!1),{preventDefault:!0}},end:function(){return this.selectCell(this.computeCellIDFromActiveCell("end"),!1,!1),{preventDefault:!0}},ctrlHome:function(){return this.setActiveCell(this.computeCellIDFromActiveCell("home",!0),!0,!1),{preventDefault:!0}},ctrlEnd:function(){return this.setActiveCell(this.computeCellIDFromActiveCell("end",!0),!0,!1),{preventDefault:!0}},shiftHome:function(){return this.selectCell(this.computeCellIDFromActiveCell("home",!1,!0),!1,!0),{preventDefault:!0}},shiftEnd:function(){return this.selectCell(this.computeCellIDFromActiveCell("end",!1,!0),!1,!0),{preventDefault:!0}},f2:function(){var e=this.getEditionManager(this.getActiveCellID());return e&&e.onF2(this.getActiveCellID()),{preventDefault:!0}},plus:function(e){if(this._onPlusKeyPressed&&this._onPlusKeyPressed(e),e.actionPerformed)return{preventDefault:!0};this.commands.defaultKeyEventCallback.call(this,e)},minus:function(e){if(this._onMinusKeyPressed&&this._onMinusKeyPressed(e),e.actionPerformed)return{preventDefault:!0};this.commands.defaultKeyEventCallback.call(this,e)},asterisk:function(e){if(this._onAsteriskKeyPressed&&this._onAsteriskKeyPressed(e),e.actionPerformed)return{preventDefault:!0};this.commands.defaultKeyEventCallback.call(this,e)},slash:function(e){if(this._onSlashKeyPressed&&this._onSlashKeyPressed(e),e.actionPerformed)return{preventDefault:!0};this.commands.defaultKeyEventCallback.call(this,e)},defaultKeyEventCallback:function(e){var t=this.getActiveCellID(),i=this.getEditionManager(t);return i?i.onKeyEvent(t,e):{stopPropagation:!1}}}})),define("DS/CollectionView/modelProviders/IconChooserBaseModelProvider",["require","exports","DS/UWAUtils/WUXUWAUtils2"],(function(e,t,i){"use strict";var o=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.modelEventsListener=[]}return e.prototype.addModelEvents=function(e){},e.prototype.removeModelEvents=function(e){},e.prototype.areItemsEquals=function(e,t){return JSON.stringify(e)===JSON.stringify(t)},e.prototype.flattenModel=function(e){return e},e.prototype.getIconDefinition=function(e){return e.icon?e.icon:e},e.prototype.getTooltip=function(e){return e.description?e.description:null},e.inherit=i.inherit,e.extend=i.extend,e}();return o}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/edition/CollectionViewDelayedEditionOnClick",["require","exports","DS/CollectionView/edition/CollectionViewEdition"],(function(e,t,i){"use strict";var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onCellUnactivate=function(t){return this.collectionView._setEditionMode(t,!1),this._avoidCellEdition(),e.prototype.onCellUnactivate.call(this,t)},t.prototype.onCellActivate=function(t){return this.collectionView.getFocusOnCellContentFlag()&&!0!==this.collectionView.PointerDownScope&&!0!==this.collectionView.PointerHitScope?(this.collectionView._setEditionMode(t,!0),this.collectionView._focusActiveCellContent()):this.collectionView.getContent().focus({preventScroll:!0}),e.prototype.onCellActivate.call(this,t)},t.prototype.onCellPointerDown=function(t){var i=this.collectionView;if(i.isCellSelected(t)&&i.isCellActive(t)){var o,n=i.rowSelection,l=i.cellSelection;if("single"===l||"multiple"===l?o=i.getCellsXSO():"single"!==n&&"multiple"!==n||(o=i.getNodesXSO()),o&&o.get().length>1);else{this._avoidCellEdition(),this._editionTimeout=setTimeout((function(){i._setEditionMode(t,!0),i.setFocusOnCellContentFlag(!0)}),500)}}else i.setFocusOnCellContentFlag(!1);return i.__latestPointerDown__={cellID:t,timestamp:Date.now()},e.prototype.onCellPointerDown.call(this,t)},t.prototype.onCellDoubleClick=function(t){return this._avoidCellEdition(),e.prototype.onCellDoubleClick.call(this,t)},t.prototype.onCellDragStart=function(t){return this._avoidCellEdition(),e.prototype.onCellDragStart.call(this,t)},t.prototype.onF2=function(t){return this.collectionView._setEditionMode(t,!0),this.collectionView.setFocusOnCellContentFlag(!0),e.prototype.onF2.call(this,t)},t.prototype.onEscape=function(e){return this._avoidCellEdition(),this.collectionView.getFocusOnCellContentFlag()?(this.collectionView.setFocusOnCellContentFlag(!1),this.collectionView._setEditionMode(e,!1),1):0},t.prototype.onEnter=function(t){return this.collectionView.setFocusOnCellContentFlag(!1),this.collectionView._setEditionMode(t,!1),e.prototype.onEnter.call(this,t)},t.prototype._avoidCellEdition=function(){this._editionTimeout&&(clearTimeout(this._editionTimeout),this._editionTimeout=void 0)},t}(i);return o}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/edition/CollectionViewEditionOnClick",["require","exports","DS/CollectionView/edition/CollectionViewEdition"],(function(e,t,i){"use strict";var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onCellUnactivate=function(t){return this.collectionView._setEditionMode(t,!1),e.prototype.onCellUnactivate.call(this,t)},t.prototype.onCellActivate=function(t){return this.collectionView._setEditionMode(t,!0),this.collectionView.getFocusOnCellContentFlag()&&this.collectionView._focusActiveCellContent(),e.prototype.onCellActivate.call(this,t)},t.prototype.onCellPointerDown=function(t){return this.collectionView.setFocusOnCellContentFlag(!0),e.prototype.onCellPointerDown.call(this,t)},t.prototype.onF2=function(e){return this.onCellPointerDown(e)},t.prototype.onEscape=function(e){return this.collectionView.getFocusOnCellContentFlag()?(this.collectionView.setFocusOnCellContentFlag(!1),1):0},t.prototype.onEnter=function(t){return this.collectionView.setFocusOnCellContentFlag(!1),e.prototype.onEnter.call(this,t)},t}(i);return o}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/modelProviders/CollectionViewUWACollectionModelProvider",["require","exports","UWA/Core","UWA/Class/Collection","DS/CollectionView/modelProviders/CollectionViewModelProvider"],(function(e,t,i,o,n){"use strict";var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getModelClass=function(){return o},t.prototype._updateModel=function(e,t,i){var o=this.collectionView,n=this,l=this.modelProvider;!1!==i&&o&&o._updateCounter>0?o._updateNeeded=!0:("update"===e&&(n=this.collectionView.applicativeModel,l=this),"onAdd"!==e&&"onRemove"!==e&&"onChange"!==e&&"onReset"!==e&&"onSort"!==e&&"update"!==e||(o.model=l.flattenApplicativeModel(n),o.invalidateLayout({updateCellContent:!0})))},t.prototype.addModelEvents=function(){var e=this.collectionView.applicativeModel;e&&(e.addEvent("onAnyEvent",this._updateModel),e.collectionView=this.collectionView,e.modelProvider=this)},t.prototype.removeModelEvents=function(){var e=this.collectionView.applicativeModel;e&&e.removeEvent("onAnyEvent",this._updateModel,this)},t.prototype.flattenApplicativeModel=function(e){return e.toArray()},t.prototype.fillApplicativeModelFromViewModel=function(e,t){e&&t&&e.reset(t,{silent:!0})},t.prototype.selectAllVisibleNodes=function(){var e=this.collectionView.applicativeModel;if(e){var t=[],i=this.getNodesXSO();if(!i)return;for(var o=0;o<e.size();o++)t.push(e.at(o));i.empty(),i.add(t),this.collectionView.model&&this.collectionView.model.length&&this.collectionView.setActiveNode(this.collectionView.model[this.collectionView.model.length-1],!1)}},t.prototype.getXSOElementID=function(e){return e.cid},t.prototype.shouldAcceptDrag=function(e){return!0},t.prototype.dumpNodeModel=function(e,t){var o={};return(t=i.extend({properties:[function(){return{property:"label",value:e.get("label")}},function(){return{property:"icons",value:e.get("icons")}}]},t)).properties.forEach((function(t){if("function"===i.typeOf(t)){var n=t.call(e);o[n.property]=n.value}})),o},t.prototype.getPropertyValue=function(e,t){return e.get(t)},t.prototype.updateView=function(e,t){this.collectionView&&this._updateModel("update",void 0,!1)},t}(n);return l})),define("DS/CollectionView/edition/CollectionViewEditionOnDoubleClick",["UWA/Core","DS/CollectionView/edition/CollectionViewEdition"],(function(e,t){"use strict";return t.inherit({onCellActivate:function(e){this.collectionView.getFocusOnCellContentFlag()?(this.collectionView._setEditionMode(e,!0),this.collectionView._focusActiveCellContent()):this.collectionView.getContent().focus({preventScroll:!0})},onCellUnactivate:function(e){this.collectionView._setEditionMode(e,!1)},onCellPreselect:function(e){},onCellEndPreselect:function(e){},onCellPointerDown:function(e){this.collectionView.getActiveCellID()!==e&&this.collectionView.setFocusOnCellContentFlag(!1)},onCellDoubleClick:function(e){this.collectionView._setEditionMode(e,!0),this.collectionView.setFocusOnCellContentFlag(!0)},onF2:function(e){this.onCellDoubleClick(e)},onEscape:function(e){return this.collectionView.getFocusOnCellContentFlag()?(this.collectionView.setFocusOnCellContentFlag(!1),this.collectionView._setEditionMode(e,!1),1):0},onEnter:function(e){this.collectionView.setFocusOnCellContentFlag(!1),this.collectionView._setEditionMode(e,!1)}})}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/edition/CollectionViewEditionInPlace",["require","exports","DS/CollectionView/edition/CollectionViewEdition"],(function(e,t,i){"use strict";var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onCellActivate=function(t){return this.collectionView.PointerDownScope||this.collectionView._focusActiveCellContent(),e.prototype.onCellActivate.call(this,t)},t.prototype.onCellPointerDown=function(t){return this.collectionView.setFocusOnCellContentFlag(!0),e.prototype.onCellPointerDown.call(this,t)},t.prototype.onF2=function(t){return this.onCellPointerDown(t),e.prototype.onF2.call(this,t)},t.prototype.onEscape=function(e){return this.collectionView.getFocusOnCellContentFlag()?(this.collectionView.setFocusOnCellContentFlag(!1),1):0},t.prototype.onEnter=function(t){return this.collectionView.selectNextCellOnEnterFlag&&this.collectionView.setFocusOnCellContentFlag(!1),e.prototype.onEnter.call(this,t)},t.prototype.isCellAlwaysInEdition=function(e){return!0},t}(i);return o})),define("DS/CollectionView/edition/CollectionViewEditionOnOver",["UWA/Core","DS/CollectionView/edition/CollectionViewEdition"],(function(e,t){"use strict";return t.inherit({publishedProperties:{},onCellUnactivate:function(e){this.collectionView.getPreselectedCellID()!==e&&this.collectionView._setEditionMode(e,!1)},onCellActivate:function(e){this.collectionView._setEditionMode(e,!0),this.collectionView.getFocusOnCellContentFlag()&&!0!==this.collectionView.PointerDownScope&&this.collectionView._focusActiveCellContent()},onCellEndPreselect:function(e){this.collectionView.getActiveCellID()!==e&&this.collectionView._setEditionMode(e,!1)},onCellPreselect:function(e){this.collectionView._setEditionMode(e,!0)},onCellPointerDown:function(e){this.collectionView.setFocusOnCellContentFlag(!0)},onCellDoubleClick:function(e){},onF2:function(e){this.onCellPointerDown(e)},onEscape:function(e){return this.collectionView.getFocusOnCellContentFlag()?(this.collectionView.setFocusOnCellContentFlag(!1),1):0},onEnter:function(e){this.collectionView.setFocusOnCellContentFlag(!1)}})}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/layouts/CollectionViewGridLayout",["require","exports","DS/CollectionView/layouts/CollectionViewLayout","DS/Core/WebUXComponents"],(function(e,t,i,o){"use strict";var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{gutter:{defaultValue:0,type:"integer"},layoutMargins:{defaultValue:{marginTop:0,marginBottom:0,marginLeft:0,marginRight:0},type:"object"},direction:{defaultValue:"vertical",type:"string"},columnMaxWidth:{defaultValue:140,type:"integer"},rowMaxHeight:{defaultValue:140,type:"integer"},useDynamicColumnWidth:{defaultValue:!0,type:"boolean"},useDynamicRowHeight:{defaultValue:!1,type:"boolean"},getRowHeightFunction:{defaultValue:null,type:"function"}}},enumerable:!1,configurable:!0}),t.responsiveMap=function(e,t,i){var o,n=e.collectionView.getViewportDimensions(!0);for(var l in i){if(!(t>=parseFloat(l)))break;var r=i[l];if("string"==typeof r){var s=parseFloat(e.rowMaxHeight);r=(n.height-e.gutter-e.layoutMargins.marginTop)/100*s}o=r}return o},t.prototype._applyGutter=function(e){this.layoutMargins!==e&&this.collectionView._onGutterOrMarginsChange()},t.prototype._applyLayoutMargins=function(e){this.layoutMargins!==e&&this.collectionView._onGutterOrMarginsChange()},t.prototype._applyGetRowHeightFunction=function(e,t){this._useVariableRowHeight=void 0!==this.getRowHeightFunction&&null!==this.getRowHeightFunction,this.resetRowHeights()},t.prototype._computeRowHeight=function(e){if(this._computedRows[e]||(this._computedRows[e]={}),void 0===this._computedRows[e].height){var t=this.getDefaultRowHeight(),i=0;if("function"==typeof this.getRowHeightFunction){var o=this.getRowHeightFunction(e);i=void 0!==o?o:t}this._computedRows[e]||(this._computedRows[e]={}),this._computedRows[e].height=i||t}return this._computedRows[e].height},t.prototype.resetRowHeights=function(e){this._resetComputedRows();var t=e||{updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1};this.invalidate(t)},t.prototype._resetComputedRows=function(){this._computedRows=[]},t.prototype.resetRowHeight=function(e){if(this._computedRows[e]&&void 0!==this._computedRows[e].height){var t=this._computedRows[e].height;if(this._computedRows[e].height=void 0,this.getRowHeight(e)!==t){for(var i=e+1;i<this._computedRows.length;i++)this._computedRows[i]&&(this._computedRows[i].top=void 0);this.invalidate({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})}}},t.prototype._computeRowHeightAndPosition=function(e){this._computeRowPosition(e),this._computeRowHeight(e)},t.prototype.isSectionAt=function(e){return this.collectionView.getNodeModelAtRowID(e).options&&"fake"===this.collectionView.getNodeModelAtRowID(e).options.nodeCategory},t.prototype.init=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.prototype.init.apply(this,t),this._useVariableRowHeight=Boolean(this._useVariableRowHeight)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("getRowHeightFunction")&&this._applyGetRowHeightFunction(t.getRowHeightFunction)},t.prototype.prepareLayout=function(){e.prototype.prepareLayout.call(this);var t=this,i=t.collectionView.getViewportDimensions(!0),o=t._getColumnMaxWidthInPixel(i),n=t._getRowHeightInPixel(i);!function(){var e=(i.width-t.gutter-t.layoutMargins.marginLeft-t.layoutMargins.marginRight)/(o+t.gutter);t._numberOfColumns=Math.max(Math.floor(e),1);var l=(i.height-t.gutter-t.layoutMargins.marginTop-t.layoutMargins.marginBottom)/(n+t.gutter);t._numberOfRows=Math.max(Math.floor(l),1)}();var l=function(e){this.useDynamicColumnWidth?(this._columnWidth=Math.floor((i.width-(this._numberOfColumns+1)*this.gutter-this.layoutMargins.marginLeft-this.layoutMargins.marginRight)/this._numberOfColumns),this._columnWidthUsedForRowHeight=this._columnWidth,t.collectionView.getViewportDimensions(!0).width!==i.width&&("number"==typeof this.columnMaxWidth?this._columnWidthUsedForRowHeight=Math.min(e,this.columnMaxWidth):this._columnWidthUsedForRowHeight=e)):(this._columnWidth=Math.floor(o),this._columnWidthUsedForRowHeight=this._columnWidth);this.useDynamicRowHeight?this._rowHeight=Math.floor((i.height-(this._numberOfRows+1)*this.gutter-this.layoutMargins.marginTop-this.layoutMargins.marginBottom)/this._numberOfRows):this._rowHeight=Math.floor(n);var r=!1;this._columnWidth>this.columnMaxWidth&&(this._numberOfColumns++,r=!0),this._rowHeight>this.rowMaxHeight&&(this._numberOfRows++,r=!0),r&&l.call(this,e)};l.call(this,this._columnWidth)},t.prototype.getCellCoordinatesAt=function(e){var t;if("vertical"===this.direction){var i=this._getNumberOfColumns();t={rowID:Math.floor(e/i),columnID:e%i}}else{var o=this._numberOfRows;t={rowID:e%o,columnID:Math.floor(e/o)}}return t},t.prototype.getCellIDFromCoordinates=function(e){return this._numberOfColumns*e.rowID+e.columnID},t.prototype._getPositionForCellAt=function(e){var t=this.getCellCoordinatesAt(e);if(t)return{left:t.columnID*(this._getColumnWidth()+this.gutter)+this.gutter+this.layoutMargins.marginLeft,top:this.getRowPosition(t.rowID)}},t.prototype.getPositionForCellAt=function(e){return this._getPositionForCellAt(e)},t.prototype.getCellIDFromPositionInView=function(e){var t=-1;if(e){var i=this.getHeaderContainerHeight();if(e.top>=i){var o=this.gutter,n=this._getRowIDFromPosition(e.top),l=Math.floor((e.left-this.layoutMargins.marginLeft)/(this._getColumnWidth()+o));if(n>=0&&l>=0){var r=e.top-this.getRowPosition(n),s=e.left-this.layoutMargins.marginLeft-l*(this._getColumnWidth()+o);r>=0&&s>=o&&(t=this.getCellIDFromCoordinates({rowID:n,columnID:l}))}}}return t},t.prototype.getDimensionsForCellAt=function(e){return{width:this._getColumnWidth(),height:this.getRowHeight(e)}},t.prototype._getRowIDFromPosition=function(e,t){var i=-1,o=this.getRowSpacing();if(this._useVariableRowHeight){if(e>=0){for(var n=this.collectionView.getModelLength()-1,l=0;l<=n;l++){if(e<this.getRowPosition(l)){i=Math.max(0,l-1),t&&i+1<=n&&i++;break}}-1===i&&(i=n)}}else i=t?Math.ceil(e/(this.getRowHeight()+o)):Math.floor(e/(this.getRowHeight()+o));return i},t.prototype._getColumnIDFromPosition=function(e,t){var i=-1;if(this._useVariableRowHeight){if(e>=0){for(var o=this.collectionView.getModelLength()-1,n=0;n<=o;n++){if(e<=this._getColumnPosition(n)){i=Math.max(0,n-1),t&&i+1<=o&&i++;break}}-1===i&&(i=o)}}else{var l=this.gutter;i=t?Math.ceil(e/(this._getColumnWidth()+l)):Math.floor(e/(this._getColumnWidth()+l))}return i},t.prototype._getColumnMaxWidthInPixel=function(e){var i,o;switch(typeof this.columnMaxWidth){case"string":o=parseFloat(this.columnMaxWidth),i=Math.floor((e.width-this.gutter-this.layoutMargins.marginLeft)/100*o);break;case"number":i=this.columnMaxWidth;break;case"object":i=t.responsiveMap(this,e.width,this.columnMaxWidth)}return i},t.prototype._getRowHeightInPixel=function(e){var i,o;switch(typeof this.rowMaxHeight){case"string":o=parseFloat(this.rowMaxHeight),i=Math.round((e.height-this.gutter-this.layoutMargins.marginTop)/100*o);break;case"number":i=this.rowMaxHeight;break;case"object":i=t.responsiveMap(this,e.height,this.rowMaxHeight)}return i},t.prototype._getColumnWidth=function(){return this._columnWidth},t.prototype.getRowHeight=function(e){var t=0;return t=this._useVariableRowHeight&&void 0!==e&&e>=0?this._computeRowHeight(e):this.getDefaultRowHeight(),this.collectionView.showRowBorderFlag&&t++,void 0!==this.rowMaxHeight&&t>this.rowMaxHeight&&(t=this.rowMaxHeight),t},t.prototype._computeRowPosition=function(e,t){if(this._computedRows[e]||(this._computedRows[e]={}),void 0===this._computedRows[e].top){if(!t)for(var i=0;i<e;i++)this._computeRowPosition(i,!0),this._computeRowHeight(i);var o=this.layoutMargins.marginTop+this.gutter;this._computedRows[e].top=e>0?this.getRowPosition(e-1)+this.getRowHeight(e-1)+this.getRowSpacing()+o:o}return this._computedRows[e].top},t.prototype.getRowPosition=function(e){var t=0;if(e>=0)if(this._useVariableRowHeight&&void 0!==e)this._computedRows[e]&&void 0!==this._computedRows[e].top||this._computeRowHeightAndPosition(e),this._computedRows[e]&&void 0!==this._computedRows[e].top&&(t=this._computedRows[e].top);else{var i=this.layoutMargins.marginTop+this.gutter;t=(this.getRowHeight()+this.getRowSpacing())*e+i}return t},t.prototype.getRowSpacing=function(){return this.gutter},t.prototype.getDefaultRowHeight=function(){return this._rowHeight?this._rowHeight:this.rowMaxHeight},t.prototype._getColumnPosition=function(e){return e*(this._getColumnWidth()+this.gutter)+this.gutter+this.layoutMargins.marginLeft},t.prototype.getContentDimensions=function(){var e=this.collectionView.getViewportDimensions(),t=this._getLastCellIDInScroller(),i=this.getPositionForCellAt(t),o=this.getDimensionsForCellAt(t);if(i){var n={height:i.top+o.height+this.gutter+this.layoutMargins.marginBottom,width:i.left+o.width+this.gutter+this.layoutMargins.marginRight},l=this.collectionView.getScrollbarWidth();if("vertical"===this.direction)return{width:n.height>e.height?e.width-l:e.width,height:n.height};var r=n.width>e.width?e.height-l:e.height;return{width:n.width,height:r}}},t.prototype.getMinMaxVisibleRowIDs=function(){this.isValid()||this.collectionView._isRendering()||this.prepareLayout();var e=this.collectionView.getViewportDimensions(),t=this.collectionView.getScrollerPosition(),i=this._getRowIDFromPosition(t.y),o=this._getRowIDFromPosition(t.y+e.height,!0),n=this._getNumberOfItems(),l=n-1;return(o<=-1||o>=l)&&t.y+e.height>0&&(o=l),0===n&&(i=-1,o=-1),{minRowID:i,maxRowID:o}},t.prototype.getMinMaxVisibleColumnIDs=function(){this.isValid()||this.collectionView._isRendering()||this.prepareLayout();var e=this.collectionView.getViewportDimensions(),t=this.collectionView.getScrollerPosition(),i=this._getColumnIDFromPosition(t.x),o=this._getColumnIDFromPosition(t.x+e.width,!0),n=this._getNumberOfItems(),l=n-1;return(o<=-1||o>=l)&&t.x+e.width>0&&(o=l),0===n&&(i=-1,o=-1),{minColumnID:i,maxColumnID:o}},t.prototype.getMinMaxVisibleCellIDs=function(){this.isValid()||this.collectionView._isRendering()||this.prepareLayout();var e,t,i=this._getFirstCellIDInScroller();if("horizontal"===this.direction){var o=this.getMinMaxVisibleColumnIDs(),n=this._getNumberOfRows();e=i+o.minColumnID*n-0*n,t=i+(o.maxColumnID+1)*n+0*n-1}else{o=this.getMinMaxVisibleRowIDs();var l=this._getNumberOfColumns();e=i+o.minRowID*l-0*l,t=i+(o.maxRowID+1)*l+0*l-1}return{minCellID:e=Math.max(i,e),maxCellID:t=Math.min(t,i+this._getLastCellIDInScroller())}},t.prototype._getLastCellIDInScroller=function(){return this._getNumberOfItems()-1},t.prototype._getNumberOfColumns=function(){return this._numberOfColumns},t.prototype._getNumberOfRows=function(){return this._numberOfRows},t.prototype._computeMinCellID=function(){var e=0,t=this.collectionView.getViewportDimensions(!0),i=this.collectionView.getScrollerPosition();return e="vertical"===this.direction?Math.max(Math.floor((i.y-this.layoutMargins.marginTop)/(this.getRowHeight()+this.gutter)),0)*Math.floor((t.width-this.layoutMargins.marginLeft-this.layoutMargins.marginRight)/(this._getColumnWidth()+this.gutter)):Math.max(Math.floor((i.x-this.layoutMargins.marginLeft)/(this._getColumnWidth()+this.gutter)),0)*Math.floor((t.height-this.layoutMargins.marginTop-this.layoutMargins.marginBottom)/(this.getRowHeight()+this.gutter)),e=Math.min(e,this._getNumberOfItems()-1)},t.prototype.renderListOfVisibleCellsInViewport=function(e){var t=this.getMinMaxVisibleCellIDs(),i=t.minCellID,o=t.maxCellID;if(!isNaN(i)&&i>=0)for(var n=i;n<=o;n++)e.render(n)},t.prototype.getLayoutStylesForCellAt=function(e){var t=this.getPositionForCellAt(e),i=this.getDimensionsForCellAt(e);if(t){var o=i.height+"px";return{transform:"translate3d("+Math.round(t.left)+"px,"+Math.round(t.top)+"px,0)",width:i.width+"px",height:o,lineHeight:o}}return{}},t.prototype.getLayoutAttributesForCellAt=function(e){var t=this.getCellCoordinatesAt(e);return{"cell-id":e,"row-id":t?t.rowID:void 0,"column-id":t?t.columnID:void 0}},t.prototype._getNumberOfItems=function(){return this.collectionView.paginationManager?this.collectionView.paginationManager.getNumberOfItemsOnPage():this.collectionView.getModelLength()},t}(i);return o.addClass(n,"CollectionViewGridLayout"),n}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/layouts/CollectionViewListLayout",["require","exports","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Core/WebUXComponents"],(function(e,t,i,o){"use strict";var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{rowMaxHeight:{defaultValue:40,type:"integer"},columnMaxWidth:{defaultValue:"100%",type:"integer"}}},enumerable:!1,configurable:!0}),t}(i);return o.addClass(n,"CollectionViewListLayout"),n}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/layouts/CollectionViewWallFlowLayout",["require","exports","DS/Core/WebUXComponents","UWA/Core","DS/CollectionView/layouts/CollectionViewLayout"],(function(e,t,i,o,n){"use strict";function l(e,t){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)}var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{cellHeight:{defaultValue:30,type:"integer"},preComputeLayout:{defaultValue:!1,type:"boolean"},gutter:{defaultValue:20,type:"integer"},direction:{defaultValue:"vertical",type:"string"},aggregate:{defaultValue:!1,type:"boolean"},columnMaxWidth:{defaultValue:400,type:"integer"}}},enumerable:!1,configurable:!0}),t.prototype._postBuild=function(){e.prototype._postBuild.call(this),this._listOfCellPositions={},this._listOfCellSpan={},this._listOfCellDimensions={},this._listOfColumnsProperties=[]},t.prototype._applyColumns=function(){this._listOfColumnsProperties=[];for(var e=0;e<this._numberOfColumns;e++)this._listOfColumnsProperties.push({filledHeight:0})},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this._applyColumns(),this.invalidate(!0)},t.prototype.prepareLayout=function(){var e=this.collectionView.getViewportDimensions(!0),t=this.columnMaxWidth;if("string"==typeof t){var i=parseFloat(t);t=(e.width-this.gutter)/100*i}var o=(e.width-this.gutter)/(t+this.gutter);this._numberOfColumns=Math.max(Math.ceil(o),1),this._columnWidth=Math.floor((e.width-(this._numberOfColumns+1)*this.gutter)/this._numberOfColumns),this._applyColumns(),this._computePositions(0,this.collectionView.getModelLength()-1)},t.prototype.postRender=function(){for(var t in this.collectionView._visibleCellsInViewport){var i=parseInt(t,10),o=this.collectionView.getCellInfosAt(i);o.cellView=this.collectionView._getViewAt(i),this.collectionView._layoutCell(o)}e.prototype.postRender.call(this)},t.prototype.getPositionForCellAt=function(e){return this._listOfCellPositions[e]},t.prototype._getColumnPrivateProperties=function(e){return this._listOfColumnsProperties[e]},t.prototype._getLessFilledColumn=function(){for(var e=this._getColumnPrivateProperties(0).filledHeight,t=0,i=!1,o=0;!i&&o<this._numberOfColumns;o++){var n=this._getColumnPrivateProperties(o).filledHeight;n<e&&(e=n,t=o,0===n&&(i=!0))}return t},t.prototype._getMoreFilledColumn=function(){var e=this;if(e._getColumnPrivateProperties(0)){for(var t=e._getColumnPrivateProperties(0).filledHeight,i=0,o=0;o<this._numberOfColumns;o++){var n=e._getColumnPrivateProperties(o).filledHeight;n>=t&&(t=n,i=o)}return i}return-1},t.prototype._computePositions=function(e,t){void 0===e&&(e=0),void 0===t&&(t=this.collectionView.getModelLength()-1);for(var i=e;i<=t;i++){var o=this.getDimensionsForCellAt(i);if(o&&void 0!==o.width&&void 0!==o.height){var n=this._getLessFilledColumn(),l=this._getColumnPrivateProperties(n).filledHeight,r=n,s=n,a=s-r+1;a<this._numberOfColumns?this._listOfCellSpan[i]=a:(this._listOfCellSpan[i]=1,s=r);var d=this._getColumnPosition(n);this._listOfCellPositions[i]={top:l+this.gutter,left:d};for(var c=r;c<=s;c++)this._getColumnPrivateProperties(c).filledHeight=l+o.height+this.gutter}}},t.prototype._getColumnWidth=function(e){return this._columnWidth},t.prototype._getColumnPosition=function(e){return e*(this._getColumnWidth()+this.gutter)+this.gutter},t.prototype._getCellSpan=function(e){return void 0!==this._listOfCellSpan[e]?this._listOfCellSpan[e]:1},t.prototype.getDimensionsForCellAt=function(e){var t=this._getColumnWidth();return void 0===this._listOfCellDimensions[e]&&(this._listOfCellDimensions[e]={width:0,height:0}),this._listOfCellDimensions[e].width=t*this._getCellSpan(e)+this.gutter*(this._getCellSpan(e)-1),this._listOfCellDimensions[e]},t.prototype.getContentDimensions=function(){var e=this.collectionView.getViewportDimensions(),t=this._getMoreFilledColumn();if(t>-1){var i=this._getColumnPrivateProperties(t).filledHeight,n=e.height>i?0:o.Utils.Client.getScrollbarWidth();return{width:e.width-n,height:i}}return{width:e.width,height:e.height}},t.prototype.renderListOfVisibleCellsInViewport=function(e){void 0===e&&(e={});var t=this.collectionView.getViewportDimensions(),i=this.collectionView.getScrollerPosition(),o=(Math.floor(i.y/this.cellHeight),Math.floor((i.y+t.height)/this.cellHeight));o=this.collectionView.getModelLength()-1;var n={};n.top=i.y,n.left=i.x,n.right=n.left+t.width,n.bottom=n.top+t.height;for(var r=!1,s=!1,a=0;(!s||this.preComputeLayout)&&a<=o;a++){var d=this._listOfCellPositions[a];if(void 0!==d){var c=this.getDimensionsForCellAt(a);d.right=d.left+c.width,d.bottom=d.top+c.height,r=l(d,n)}else r=!0;if(r&&e.render&&(e.render(a),void 0===this._listOfCellDimensions[a]||void 0===this._listOfCellDimensions[a].width||void 0===this._listOfCellDimensions[a].height)){var u=this.collectionView._getViewAt(a);u&&(this._listOfCellDimensions[a]=u.getContent().getDimensions()),this._computePositions(a);var h=this._listOfCellPositions[a];c=this._listOfCellDimensions[a];h.right=h.left+c.width,h.bottom=h.top+c.height;var p=this.collectionView.getViewportDimensions(!0),g=this.collectionView.getScrollerPosition(),f={};f.top=g.y,f.left=g.x,f.right=f.left+p.width,f.bottom=f.top+p.height,l(h,f)||(s=!0)}}},t.prototype.getLayoutStylesForCellAt=function(e){var t=this.getPositionForCellAt(e),i=this.getDimensionsForCellAt(e);return t?{position:"absolute",transform:"translate3d("+t.left+"px,"+t.top+"px,0)",width:i.width+"px",height:void 0!==i.height?i.height+"px":""}:{position:"absolute",width:i.width+"px",height:void 0!==i.height?i.height+"px":""}},t}(n);return i.addClass(r,"CollectionViewWallFlowLayout"),r}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/layouts/CollectionViewListFlowLayout",["require","exports","DS/Core/WebUXComponents","DS/CollectionView/layouts/CollectionViewWallFlowLayout"],(function(e,t,i,o){"use strict";var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{columnMaxWidth:{defaultValue:"100%",type:"integer"}}},enumerable:!1,configurable:!0}),t}(o);return i.addClass(n,"CollectionViewListFlowLayout"),n}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/modelProviders/CollectionViewTreeDocumentModelProvider",["require","exports","UWA/Core","DS/CollectionView/modelProviders/CollectionViewModelProvider","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/UWAUtils/WUXUWAUtils2"],(function(e,t,i,o,n,l,r){"use strict";var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getModelClass=function(){return n},t.prototype.addModelEvents=function(){var e=this,t=this.collectionView.applicativeModel;if(t){var i=0,o=t.addModelEventListener("prepareUpdate",(function(e){i++}));this.modelEventsListener.push(o),o=t.addModelEventListener("pushUpdate",(function(t){if(--i<0&&console.error("You pushed too many updates"),0===i){if(e.collectionView.keyboardMutePoolrefresh||t&&t.options&&(t.options.updateType===window.WUXModelUpdateTypes.PreSelection||t.options.updateType===window.WUXModelUpdateTypes.Selection))return;!0===e.collectionView._cellUISelectionAction||!0===e.collectionView.modelUISelectionAction?e.collectionView._updateAllPoolSelectedViews():(e.collectionView.model=e.flattenApplicativeModel(e.collectionView.applicativeModel),e.collectionView.invalidateLayout({updateCellContent:!0}))}})),this.modelEventsListener.push(o),o=t.onNodeModelUpdate((function(t){0===i&&(e.collectionView.model=e.flattenApplicativeModel(e.collectionView.applicativeModel),e.collectionView.invalidateLayout({updateCellContent:!0}))})),this.modelEventsListener.push(o);var n=function(t){var i=t.target;if(i){var o=i._getRowID();e.collectionView.updateCellView(o,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})}};o=t.addModelEventListener("highlight",n),this.modelEventsListener.push(o),o=t.addModelEventListener("unhighlight",n),this.modelEventsListener.push(o)}},t.prototype.removeModelEvents=function(){var e=this.collectionView,t=e.applicativeModel;if(t&&e._rowModel&&e._rowModel._currentTreeDocumentUpdateCounter&&(e._updateCounter-=e._rowModel._currentTreeDocumentUpdateCounter,e._rowModel._currentTreeDocumentUpdateCounter=0,e._updateCounter<0&&console.warn("A call has been made on pushUpdateView without a previous call to prepareUpdateView")),t&&t.getModelEvents()){for(var i=0;i<this.modelEventsListener.length;i++)t.getModelEvents().unsubscribe(this.modelEventsListener[i]);this.modelEventsListener.splice(0,this.modelEventsListener.length)}},t.prototype.flattenApplicativeModel=function(e){var t;return e&&(t=e.getAllDescendants({onlyVisibleNodes:!0})),t},t.prototype.fillApplicativeModelFromViewModel=function(e,t){if(e&&t)for(var i=0;i<t.length;i++){var o=t[i];o instanceof l&&e.addRoot(o)}},t.prototype.getNodeModelRowID=function(e,t){return e._getRowID(t)},t.prototype.selectAllVisibleNodes=function(){var e=this.collectionView.applicativeModel?this.collectionView.applicativeModel:this.collectionView.getTreeDocument();if(e){var t=[],i=this.getNodesXSO();e.withTransactionUpdate((function(){e._getTrueRoot().processDescendants({onlyVisibleNodes:!0,processNode:function(e){t.push(e.nodeModel)}}),i.empty(),i.add(t)})),this.collectionView.model&&this.collectionView.model.length&&this.collectionView.setActiveNode(this.collectionView.model[this.collectionView.model.length-1],!1)}},t.prototype.unselectAll=function(){var e=this.collectionView.applicativeModel?this.collectionView.applicativeModel:this.collectionView.getTreeDocument();e&&e.unselectAll()},t.prototype.isNodeVisible=function(e){return e.isVisible()},t.prototype.shouldAcceptDrag=function(e){return e.getTreeDocument().options.shouldAcceptDrag(e)},t.prototype.dumpNodeModel=function(e,t){return e.dump({properties:[function(){return{property:"label",value:this.options.label}},function(){return{property:"grid",value:this.options.grid}},function(){return{property:"description",value:this.options.description}},function(){return{property:"statusbarIcons",value:this.options.statusbarIcons}}]})},t.prototype.selectNode=function(t,i){var o=this.collectionView.applicativeModel?this.collectionView.applicativeModel:this.collectionView.getTreeDocument();if(o){var n=this.getNodesXSO();n&&(o.getXSO()===n?t.select(i):e.prototype.selectNode.call(this,t,i))}},t.prototype.unSelectNode=function(t){var i=this.collectionView.applicativeModel?this.collectionView.applicativeModel:this.collectionView.getTreeDocument();if(i){var o=this.getNodesXSO();o&&(i.getXSO()===o?t.unselect():e.prototype.unSelectNode.call(this,t))}},t.prototype.isNodeSelected=function(t){var i=this.collectionView.applicativeModel?this.collectionView.applicativeModel:this.collectionView.getTreeDocument();if(i){var o=this.getNodesXSO();if(o)return i.getXSO()===o?t.isSelected():e.prototype.isNodeSelected.call(this,t)}},t.prototype.getNodesXSO=function(){if(!this.collectionView.supportsSelection())return null;if(this.collectionView.selectionManagedByView)this.selectionModel=e.prototype.getNodesXSO.call(this);else{var t=this.collectionView.applicativeModel?this.collectionView.applicativeModel:this.collectionView.getTreeDocument();t&&(this.selectionModel=t.getXSO())}return this.selectionModel},t.prototype.getXSOElementID=function(e){return e._getID()},t.prototype.getPropertyValue=function(e,t){var o;return t&&(o=void 0!==e.options[t]?e.options[t]:e.options.grid&&e.options.grid[t]?e.options.grid[t]:void 0),"badges"==t?e.getBadges():"icon"==t?e.options.icons&&e.options.icons.length?e.options.icons[0]:null:"picture"==t?e.options.thumbnail?e.options.thumbnail:e.options.grid&&e.options.grid.thumbnail?e.options.grid.thumbnail:void 0:"propertiesList"==t||"progressValueData"==t||"statusbarIcons"==t||"statusbarLabelsWidthRatios"==t||"statusbarIconsTooltips"==t||"contextualMenu"==t?i.clone(o):o},t.inherit=r.inherit,t.extend=r.extend,t}(o);return s}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/modelProviders/IconChooserTreeDocumentModelProvider",["require","exports","DS/CollectionView/modelProviders/IconChooserBaseModelProvider"],(function(e,t,i){"use strict";var o=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return e.apply(this,t)||this}return __extends(t,e),t.prototype.addModelEvents=function(e){var t=this;if(e){var i=0,o=e.addModelEventListener("prepareUpdate",(function(e){i++}));this.modelEventsListener.push(o),o=e.addModelEventListener("pushUpdate",(function(e){--i<0&&window.console.error("You pushed too many updates"),0===i&&t.iconChooser.updateView()})),this.modelEventsListener.push(o),o=e.onNodeModelUpdate((function(e){0===i&&t.iconChooser.updateView()})),this.modelEventsListener.push(o)}},t.prototype.flattenModel=function(e){return e?e.getAllDescendants():[]},t.prototype.getIconDefinition=function(e){return e.options&&e.options.icon?e.options.icon:""},t.prototype.getTooltip=function(e){return e.options.description?e.options.description:null},t.prototype.removeModelEvents=function(e){if(e&&e.getModelEvents()){for(var t=0;t<this.modelEventsListener.length;t++)e.getModelEvents().unsubscribe(this.modelEventsListener[t]);this.modelEventsListener.splice(0,this.modelEventsListener.length)}},t.prototype.areItemsEquals=function(e,t){return e._getID()===t._getID()},t}(i);return o})),define("DS/CollectionView/ItemModelBase",["DS/TreeModel/ModelUtils","DS/Utilities/StringUtils","DS/CollectionView/ModelBase"],(function(e,t,i){"use strict";return i.inherit({name:"ItemModelBase",_currentTreeDocumentUpdateCounter:0,_privateProperties:{virtuallyLoadAllModelItems:{defaultValue:!1,type:"boolean",category:"Behavior"}},_applySortModel:function(e){const t=this.collectionView;t._isCurrentlyCalledFromUIInteraction()||t._currentlyCalledFromApplyPreferencesFlag||t.__preferencesRestored||(this._originalSortModel=this.sortModel?[].concat(this.sortModel):this.sortModel)},_preBuild:function(){this.modelEventsListener=[],this.xsoEventsListener=[],this.pxsoEventsListener=[],this._latestGroupingOptions=[]},_updateModel:function(){this._syncModel({updateType:WUXModelUpdateTypes.Addition})},_getCurrentPaginationOptions:function(){const e=this.collectionView;let t;if(e&&e.paginationManager){t={};const i=e.paginationManager.pageSize;t.nodeMin=(e.paginationManager.currentPage-1)*i,t.nodeMax=t.nodeMin+i-1,t.paginationNodeDepth=e.paginationManager.nodeDepth,t.currentPage=e.paginationManager.currentPage,t.pageSize=i}return t},getRowModelLength:function(e){if(void 0===e)return this.collectionView.getModelLength();if(!this._rowModelLength){let t=0;this._getTreeDocument()&&this._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:!0,processNode:function(i){if(-1===e)t++;else if(i.nodeModel.getNodeDepth()===e)return t++,{shouldProcessDescendants:!1}}}),this._rowModelLength=t}return this._rowModelLength},modelLengthModified:function(){this._rowModelLength=void 0},shouldBeSelected:function(e){const t=this._getTreeDocument();return!(t&&!t.options.shouldBeSelected.call(t,e))},_reapplyRowGrouping:function(){const e=this._getGroupingOptions();e&&e.dataIndexesToGroup&&(this._doGroupingOnModel(e),this.modelLengthModified())},_getGroupingOptions:function(){return this.collectionView?this.collectionView.getGroupingOptions():void 0},groupRows:function(e){const t=this,i=this.collectionView;if(e&&e.dataIndexesToGroup){e.dataIndexesToGroup=e.dataIndexesToGroup.filter((function(e){return i.layout.getColumnOptionValue(e,"groupableFlag")}));const o=this._latestGroupingOptions||[];if(t.collectionView._setGroupingOptions(e),0===e.dataIndexesToGroup.length&&0===o.length)return;e.dataIndexesToGroup.length>0&&0===o.length?i.disableRowReordering():0===e.dataIndexesToGroup.length&&o.length>0&&i.enableRowReordering(),i.rowGroupingOptions.hideGroupedColumns&&(e.dataIndexesToGroup.forEach((function(e){if("tree"===e)return;const t=o.indexOf(e);-1!==t&&o.splice(t,1),i.layout.setColumnVisibleFlag(e,!1)})),o.forEach((function(e){i.layout.setColumnVisibleFlag(e,!0)}))),this._latestGroupingOptions=e.dataIndexesToGroup||[],this._reapplyRowGrouping()}},_shouldUpdateCellWidth:function(e){return!1},_listenToTreeDocument:function(){const t=this,i=this.collectionView,o=this._getTreeDocument();if(!o)return;let n=o.onUpdate((function(e){let o=!0;e.options.updateType===WUXModelUpdateTypes.Expand&&(o=!1),e.options.updateType&&(e.options.updateType&WUXModelUpdateTypes.Addition||e.options.updateType&WUXModelUpdateTypes.Removal||e.options.updateType&WUXModelUpdateTypes.Expand||e.options.updateType&WUXModelUpdateTypes.VisibilityChange)&&t.modelLengthModified(),e.options.updateType!==WUXModelUpdateTypes.Selection&&e.options.updateType!==WUXModelUpdateTypes.PreSelection&&e.options.updateType!==WUXModelUpdateTypes.AttributesChange&&t._syncModel(e.options,o),t._isModelBeingFetched()||(i.model&&0===i.getModelLength()?i._displayEmptyContentMessage():i._removeEmptyContentMessage()),t._mustClearViewSelection&&(i.getCellsXSO().empty(),t._mustClearViewSelection=!1)}));this.modelEventsListener.push(n),t._syncModel({updateType:WUXModelUpdateTypes.Addition}),t._isModelBeingFetched()||(i.model&&0===i.getModelLength()?i._displayEmptyContentMessage():i._removeEmptyContentMessage());const l=(e,t)=>{if(e){const o=i.layout,n=e._getRowID(),l=i.getActiveCellID();let r=t&&Object.keys(t).length>0&&l>=0&&i.isCellInEdition(l);if(t)for(const e in t)if(t.hasOwnProperty(e)){const t=o.getCellIDFromCoordinates({rowID:n,columnID:e});if(t>=0&&t===l){r=!1;break}}const s={updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0,ignoreActiveCell:r};this._shouldUpdateCellWidth(t)?(s.updateCellWidth=!0,i.updateView(s)):i.updateRowView(n,s),o._useVariableRowHeight&&o.resetRowHeight(n)}};let r=new Map,s=null;n=o.onNodeModelUpdate((function(e){if(i.isInViewTransaction())return r.set(e.data.nodeModel,Object.assign({},r.get(e.data.nodeModel),e.data.attributes)),void(s||(s=i.onLastPushUpdateViewOnce((()=>{i.prepareUpdateView(),r.forEach(((e,t)=>{l(t,e)})),i.pushUpdateView(),r=new Map,s=null}))));l(e.data.nodeModel,e.data.attributes)})),this.modelEventsListener.push(n);const a=function(e){if(i._updateCounter>0)return void(i._updateNeeded=!0);const t=e.target;if(t&&!t._isTrueRoot()&&!t.isExpanded()){const o=t.getChildren();if("addChild"===e.event&&o&&1===o.length||"removeChild"===e.event&&(!o||0===o.length)){const e=i.layout.getColumnIndex("tree");if(void 0===e)return;i.updateCellView(i.layout.getCellIDFromCoordinates({rowID:t._getRowID(),columnID:e}),{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}}},d=function(e){const t=e.target;t&&i.updateCellView(i.layout.getCellIDFromCoordinates({rowID:t._getRowID(),columnID:i.layout.getColumnIndex("tree")}),{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})},c=function(e,t){const o=e.target;if(o){const e=o._getRowID();i.updateRowView(e,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})}};n=o.addModelEventListener("addChild",a),this.modelEventsListener.push(n),n=o.addModelEventListener("removeChild",a),this.modelEventsListener.push(n),n=o.addModelEventListener("highlight",c),this.modelEventsListener.push(n),n=o.addModelEventListener("unhighlight",c),this.modelEventsListener.push(n),n=o.addModelEventListener("matchSearch",d),this.modelEventsListener.push(n),n=o.addModelEventListener("unmatchSearch",d),this.modelEventsListener.push(n),n=o.addModelEventListener("documentRemoveRoots",(function(t){e.destroyTreeDocumentOrderSnapshot(o)})),this.modelEventsListener.push(n),n=o.addEventListener("prepareUpdate",(()=>{t._currentTreeDocumentUpdateCounter++,i.prepareUpdateView()})),this.modelEventsListener.push(n),n=o.addEventListener("pushUpdate",(()=>{t._currentTreeDocumentUpdateCounter--,i.pushUpdateView()})),this.modelEventsListener.push(n),n=o.addEventListener("preDestroyDocument",(()=>{this.treeDocument=void 0})),this.modelEventsListener.push(n),this._manageTreeDocumentSelection(),this._manageTreeDocumentPreSelection()},_manageTreeDocumentSelection:function(){const e=this.collectionView,t=e.getNodesXSO();let i=t.onAdd((function(t){e._onXSOAdd(t)}));this.xsoEventsListener.push(i),i=t.onPostAdd((function(t){e._onXSOPostAdd(t)})),this.xsoEventsListener.push(i),i=t.onRemove((function(t){e._onXSORemove(t)})),this.xsoEventsListener.push(i),i=t.onPostRemove((function(t){e._onXSOPostRemove(t)})),this.xsoEventsListener.push(i)},_manageTreeDocumentPreSelection:function(){const e=this.collectionView,t=e.getNodesPXSO();let i=t.onPostAdd((function(t){e._onPXSOPostAdd(t)}));this.pxsoEventsListener.push(i),i=t.onPostRemove((function(t){e._onPXSOPostRemove(t)})),this.pxsoEventsListener.push(i)},prepareUpdate:function(){this._getTreeDocument().prepareUpdate()},pushUpdate:function(){this._getTreeDocument().pushUpdate()},_removeModelEvents:function(e){if(e&&e.getModelEvents()){for(let t=0;t<this.modelEventsListener.length;t++)e.getModelEvents().unsubscribe(this.modelEventsListener[t]);this.modelEventsListener.splice(0,this.modelEventsListener.length)}},_removeXSOEventsListener:function(e){const t=e?e.getXSO():null;if(t){for(let e=0;e<this.xsoEventsListener.length;e++)t.unsubscribe(this.xsoEventsListener[e]);this.xsoEventsListener.splice(0,this.xsoEventsListener.length)}},_removePXSOEventsListener:function(e){const t=e?e.getPXSO():null;if(t){for(let e=0;e<this.pxsoEventsListener.length;e++)t.unsubscribe(this.pxsoEventsListener[e]);this.pxsoEventsListener.splice(0,this.pxsoEventsListener.length)}},destroy:function(){this._removeModelEvents(this._getTreeDocument()),this._removeXSOEventsListener(this._getTreeDocument()),this._removePXSOEventsListener(this._getTreeDocument()),this._parent()},_findAllCellIDsMatchingFindStrInClientSide:function(e,i,o){const n=this.collectionView,l=n.layout;if(n._matchingFoundArrays=[],n._matchingCellIDsArray=[],n._matchingCellIDsMap={},n._matchingNodeModelsArray=[],n._matchingNodeModelsMap={},n._matchingAllNodeModelsArray=[],!o){const t=n.getNodeModelToProcessForFind;if(t)o=t.call(n,e,i);else{o=[];this._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:!1,processNode:function(e){const t=e.nodeModel;t&&!1===t.isHidden()&&!1===t.isFiltered()&&o.push(t)}})}}if(0===o.length)return;const r=this._getColumnsToProcessForFindData(n,e,i),s=r.findableColumnsDataIndexes,a=r.areFindableColumnsModified,d=t.toComparable(n.findStr.toString(),{toLowerCase:!i}),c=[],u=[];for(let e=0;e<o.length;e++){const r=o[e];if(r&&r.hasRowID()/*!nodeModel.hasNoRepresentation()*/){const e=r.isVisible(),o=!(!e||null!==r._getRowID())||void 0,h=r._getRowID(o);for(let o=0;o<s.length;o++){const p=s[o];if(!0===a&&-1===s.indexOf(p))continue;let g;c[o]?g=c[o]:(g=l.getColumnIndex(p),c[o]=g);const f=l.getCellIDFromCoordinates({rowID:h,columnID:g}),m=!1===e?-1:f,_=this._getNodeCellInfos(r,e,f,n,l,g);let v;u[o]?v=u[o]:(v=n.layout.getColumnOptionValue(g,"getCellValueAsStringForFind"),u[o]=v);const y=n._getCellValueAsStringForFind(_,v);let C=[];const w=l.getColumnIsCellMatchingFind(g);if(w)w(_,d)&&C.push(void 0);else if(y&&"string"==typeof y){const e=t.toComparable(y.toString(),{toLowerCase:!i}),o=l.getColumnGetFindPositionsInCellString(g);if(o){const t=[];o(e,d,t),t&&(C=t)}else if(l.getLeafColumns()[g]){let t=d;const i=l.getLeafColumns()[g].allowUnsafeHTMLContent;i&&(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),C=n._getIndexesOfMatchingString(e,t);const o=[];if(i){const t=/(<([^>]+)>)/gi;let i;for(;i=t.exec(e);)o.push({start:i.index,end:t.lastIndex-1});const n=[];let l=0;for(let e=0;e<C.length;){const t=C[e];if(l>=o.length){n.push(...C.slice(t)),e++;continue}const i=o[l];t<i.start?(n.push(t),e++):t<i.end?e++:l++}C=n}}}if(C.length>0){n._matchingFoundArrays.push(C),n._matchingCellIDsArray.push(m);const e=r.buildStringIdentifierArray;r._idForFind=e,n._matchingAllNodeModelsArray.push(r),-1!==m&&(n._matchingCellIDsMap[m]=n._matchingCellIDsArray.length-1),-1===n._matchingNodeModelsArray.indexOf(r)&&n._matchingNodeModelsArray.push(r),void 0!==r._getRowID()&&null!==r._getRowID()&&void 0===n._matchingNodeModelsMap[r._getRowID()]&&(n._matchingNodeModelsMap[r._getRowID()]=n._matchingNodeModelsArray.length-1)}}}}},_getNodeCellInfos:function(e,t,i,o,n,l){const r=!1===t?-1:i;if(-1!==r)return o.getCellInfosAt(r);const s={columnID:l,nodeModel:e};let a;const d=n.getColumnHasCellValue(l);if(!d||d.call(o,s)){const e=n.getColumnGetCellValue(l);e&&(a=e.call(o,s))}if(e&&!a){const t=n.getDataIndexFromColumnIndex(l);if("tree"===t){"string"===n._getCellTypeRepresentation({columnID:s.columnID,cellModel:e.options.label,nodeModel:e})&&(a=e.options.label)}a||(a=e.getAttributeValue(t))}return s.cellModel=a,s},_updateClientModelFromFind:function(e,t,i,o,n,l){return o?o.call(this,i,n,l):0},_computeNextMatchingData:function(e,t){let i=-1;if("substring"===e.findNavigationMode)i=e._currentMatchingStringIndex===this._computeMatchingStringsCount(t)-1?0:e._currentMatchingStringIndex+1;else if("cell"===e.findNavigationMode){let t=e._currentMatchingCellIDIndex;t===e._matchingCellIDsArray.length-1?t=0:t+=1,i=e._getMatchingStringIndexFromMatchingCellIDIndex(t)}else{let t=e._currentMatchingRowIDIndex;t===e._matchingNodeModelsArray.length-1?t=0:t+=1,i=e._getMatchingStringIndexFromMatchingRowIDIndex(t)}return i},_computeMatchingStringsCount:function(){let e=0;for(let t=0;t<this.collectionView._matchingFoundArrays.length;t++)e+=this.collectionView._matchingFoundArrays[t].length;return e},_computePreviousMatchingData:function(e){let t=-1;if("substring"===e.findNavigationMode)t=0===e._currentMatchingStringIndex?e.matchingStringCount-1:e._currentMatchingStringIndex-1;else if("cell"===e.findNavigationMode){let i=e._currentMatchingCellIDIndex;0===i?i=e._matchingCellIDsArray.length-1:i-=1,t=e._getMatchingStringIndexFromMatchingCellIDIndex(i)}else{let i=e._currentMatchingRowIDIndex;0===i?i=e._matchingNodeModelsArray.length-1:i-=1,t=e._getMatchingStringIndexFromMatchingRowIDIndex(i)}return t},_getColumnsToProcessForFindData:function(e,t,i){let o=!1;const n=e.getColumnsToProcessForFind;let l=[];if(n&&(l=n.call(e,t,i),o=!0),!1===o){const t=e.layout.getVisibleOrderedLeafColumns(),i=[];for(let e=0;e<t.length;e++)!1!==t[e].findableFlag&&i.push(t[e].dataIndex);l=i}return{areFindableColumnsModified:o,findableColumnsDataIndexes:l}}})}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/layouts/CollectionViewSectionGridLayout",["require","exports","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Core/WebUXComponents"],(function(e,t,i,o){"use strict";var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{sectionHeight:{defaultValue:40,type:"integer"}}},enumerable:!1,configurable:!0}),t.prototype.isSectionAt=function(e){return!(!this.collectionView.getModelLength()||!this.collectionView.getNodeModelAtRowID(e))&&(this.collectionView.getNodeModelAtRowID(e).options&&"fake"===this.collectionView.getNodeModelAtRowID(e).options.nodeCategory)},t.prototype._preBuild=function(t){e.prototype._preBuild.call(this,t),this._listOfSectionsReverseIndexes={},this._listOfSections=[],this._listOfItemsInfos=[],this.__currentPreviousStackedSection=-1,this.__currentNextStackedSection=0,this.__currentStackedSection=0},t.prototype.prepareLayout=function(){var t=this;this._listOfSectionsReverseIndexes={},this._listOfSections=[],this._listOfItemsInfos=[],this.__currentPreviousStackedSection=-1,this.__currentNextStackedSection=0,this.__currentStackedSection=0;var i=this.collectionView.getViewportDimensions(),o=this.getContentDimensions(),n=i.height<o.height?this.collectionView.getScrollbarWidth():0,l=i.width-n,r=this._getColumnMaxWidthInPixel(i),s=(l-this.gutter-this.layoutMargins.marginLeft-this.layoutMargins.marginRight)/(r+this.gutter),a=Math.max(this.useDynamicColumnWidth?Math.round(s):Math.floor(s),1),d=Math.floor((l-(a+1)*this.gutter-this.layoutMargins.marginLeft-this.layoutMargins.marginRight)/a);d>r&&(this.useDynamicColumnWidth?(a++,d=Math.floor((l-(a+1)*this.gutter-this.layoutMargins.marginLeft-this.layoutMargins.marginRight)/a)):d=r),this._columnWidth=d,this._numberOfColumns=a;var c=0,u=0,h=0,p=0,g=!1;this.collectionView.model.forEach((function(e,i){var o=t.isSectionAt(i);o&&(t._listOfSections.push({cellID:i}),u=0,t._listOfSectionsReverseIndexes[i]=p,p++,!g&&c>0&&c++),o||u>a-1&&(u=0,c++),t._listOfItemsInfos.push({sectionsBefore:h,coordinates:{rowID:c,columnID:u}}),o||u++,o&&(c++,u=0,h++),g=o})),e.prototype.prepareLayout.call(this)},t.prototype.getCellCoordinatesAt=function(t){var i;return this._listOfSections&&0===this._listOfSections.length?i=e.prototype.getCellCoordinatesAt.call(this,t):this._listOfItemsInfos&&(i=this._listOfItemsInfos[t].coordinates),i},t.prototype._getPositionForCellAt=function(t){var i={top:0,left:0},o=this.getCellCoordinatesAt(t);if(o){var n=0;if(this._listOfItemsInfos){var l=this._listOfItemsInfos[t];l&&(n=l.sectionsBefore)}if(this.isSectionAt(t))i.left=this.gutter+this.layoutMargins.marginLeft;else{var r=e.prototype._getPositionForCellAt.call(this,t);i.left=r?r.left:0}i.top=(o.rowID-n)*(this.getRowHeight()+this.gutter)+n*(this.sectionHeight+this.gutter)+this.gutter+this.layoutMargins.marginTop}return i},t.prototype.getPositionForCellAt=function(t){var i={top:0,left:0};return t>=0&&(i=e.prototype.getPositionForCellAt.call(this,t),this.isCellSyncedAt(t)?i.top=0:this.__currentPreviousStackedSection===t&&this.__currentPreviousStackedSection<this.__currentStackedSection&&(i.top=this._getPositionForCellAt(this.__currentStackedSection).top-this.getDimensionsForCellAt(t).height)),i},t.prototype.getDimensionsForCellAt=function(t){return this.isSectionAt(t)?{width:this._numberOfColumns*this._getColumnWidth()+this._numberOfColumns*this.gutter,height:this.sectionHeight}:e.prototype.getDimensionsForCellAt.call(this,t)},t.prototype.getContentDimensions=function(){var e,t,i=this.collectionView.getViewportDimensions(),o=this.collectionView.getModelLength()-1,n=this.getPositionForCellAt(o),l=this.getDimensionsForCellAt(o),r=this.collectionView.getScrollbarWidth()>=0?this.collectionView.getScrollbarWidth():0;if(this._listOfSections&&this._listOfSections.length>0)return{width:t=(e={height:n.top+l.height+this.gutter+this.layoutMargins.marginBottom,width:this._numberOfColumns*(this._getColumnWidth()+this.gutter)+this.gutter+this.layoutMargins.marginRight}).height>i.height?i.width-r:i.width,height:e.height};if(t=(e={height:n.top+l.height+this.gutter+this.layoutMargins.marginBottom,width:n.left+l.width+this.gutter+this.layoutMargins.marginRight}).height>i.height?i.width-r:i.width,"vertical"===this.direction)return{width:t,height:e.height};var s=e.width>i.width?i.height-r:i.height;return{width:e.width,height:s}},t.prototype._computeMinCellID=function(){var e,t=this.collectionView.getScrollerPosition();e="vertical"===this.direction?{pos:"top",scrollPos:"y",size:"height"}:{pos:"left",scrollPos:"x",size:"width"};var i=0;if(this._getPositionForCellAt(i)[e.pos]<=t[e.scrollPos]){for(;i<this.collectionView.getModelLength()-1&&this._getPositionForCellAt(i)[e.pos]<t[e.scrollPos];)i++;i=Math.max(0,i-this._numberOfColumns)}else if(this._getPositionForCellAt(i)[e.pos]>t[e.scrollPos])for(;i>0&&this._getPositionForCellAt(i)[e.pos]>t[e.scrollPos];)i--;return i},t.prototype.renderListOfVisibleCellsInViewport=function(t){var i=this,o=i.collectionView.getScrollerDeltaPosition().y,n={},l=t.render;return t.render=function(e){var r=i._getPositionForCellAt(e).top,s=i.collectionView.getScrollerPosition().y;if(n[e]=!0,i.isSectionAt(e))o>0?r<s+i.getDimensionsForCellAt(i.__currentStackedSection).height&&e>i.__currentStackedSection&&i.__currentStackedSection!==i.__currentPreviousStackedSection&&(i.__currentPreviousStackedSection=i.__currentStackedSection,i.__currentStackedSection=e):i._getPositionForCellAt(i.__currentStackedSection).top-i.getDimensionsForCellAt(i.__currentStackedSection).height>s&&e<i.__currentStackedSection&&i.__currentStackedSection!==i.__currentPreviousStackedSection&&(i.__currentPreviousStackedSection=i.__currentStackedSection,i.__currentStackedSection=e);else if(i._listOfItemsInfos[e]){var a=i._listOfItemsInfos[e].sectionsBefore-1;if(a>-1){var d=i._listOfSections[a].cellID;void 0===n[d]&&t.render(d)}}l.call(this,e)},i.__currentPreviousStackedSection>-1&&l.call(this,i.__currentPreviousStackedSection),void 0!==i.__currentStackedSection&&l.call(this,i.__currentStackedSection),e.prototype.renderListOfVisibleCellsInViewport.call(this,t)},t.prototype._isPreviousSection=function(e){var t=this._listOfSectionsReverseIndexes[this.__currentStackedSection]-1;return t>=0&&t===e},t.prototype._getPreviousSectionID=function(){var e=this._listOfSectionsReverseIndexes[this.__currentNextStackedSection]-1;if(e>-1)return this._listOfSections[e].cellID},t.prototype.isCellSyncedAt=function(e){var t=!1;this.__currentStackedSection===e&&(this._getPositionForCellAt(this.__currentStackedSection).top>=this.collectionView.getScrollerPosition().y||(t=this.isSectionAt(e)));return t},t.prototype.cellTypeCanChangeOnScroll=function(e){return this.isSectionAt(e)},t.prototype.getLayoutStylesForCellAt=function(t){var i=e.prototype.getLayoutStylesForCellAt.call(this,t);return i.zIndex=this.isSectionAt(t)?(1e6+t).toString():"",i},t.prototype.getLayoutAttributesForCellAt=function(t){var i=e.prototype.getLayoutAttributesForCellAt.call(this,t);return i["is-current"]=this.__currentStackedSection===t,i["is-section"]=this.isSectionAt(t),i["is-stacked"]=this.isCellSyncedAt(t),i},t}(i);return o.addClass(n,"CollectionViewSectionGridLayout"),n}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/layouts/CollectionViewSectionListLayout",["require","exports","DS/CollectionView/layouts/CollectionViewSectionGridLayout","DS/Core/WebUXComponents"],(function(e,t,i,o){"use strict";var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{columnMaxWidth:{defaultValue:"100%",type:"integer"}}},enumerable:!1,configurable:!0}),t}(i);return o.addClass(n,"CollectionViewSectionListLayout"),n})),define("DS/CollectionView/ItemModelServerSide",["DS/CollectionView/ItemModelBase","DS/TreeModel/TreeNodeModel","DS/Utilities/Object","UWA/Core","DS/TreeModel/FilterManager","i18n!DS/CollectionView/assets/nls/translation"],(function(e,t,i,o,n,l){"use strict";function r(e){return e._treeDocument&&e._treeDocument.options.nodeModelClass?e._treeDocument.options.nodeModelClass:t}function s(e){let t=e.groupedRequests,o=e.startRow,n=e.parentNode,s=e.rowModel,a=s.collectionView;void 0===e.currentCounter&&(e.currentCounter=s._lastModelStructureRequestCounter);let d=e.currentCounter;if(!t||!t.length){t=[];let e={request:{}};e.request.startRow=o,e.parentNode=n,t.push(e)}return{successCallback:(e,c,u)=>{if(!a.elements||!a.elements.container)return;if(d&&d<s._lastModelStructureRequestCounter)return;let h,p=-1,g=0,f={},m=0;if(e instanceof Array)h=e,p=c,g=u,m=1,f.rows=[h],f.lastRow=[p],f.numberOfChildren=[g];else if(e.groupedRequestResult){if(m=e.groupedRequestResult.rows?e.groupedRequestResult.rows.length:0,t.length!==m)throw new Error("ERROR: returned grouped request result count does not match input request count.");f=e.groupedRequestResult}else h=e.rows,p=e.lastRow,g=e.numberOfChildren,m=1,f.rows=h,f.lastRow=p,f.numberOfChildren=g;let _=!1,v=r(s),y=s._treeDocument.getUseChangeTransactionMode();s._treeDocument.setUseChangeTransactionMode(!1);let C=[];for(let e=0;e<m;e++){let l=t&&e<t.length?t[e].parentNode:n;if(!l||!l.getParent()&&!l._isTrueRoot())continue;let r=t&&e<t.length?t[e].request.startRow:o,d=f.rows[e],c=f.lastRow?f.lastRow[e]:void 0,u=f.numberOfChildren[e];if(0!==u&&0!==c){let e=r,t=[],o=[];if(!0===s.virtuallyLoadAllModelItems){if(void 0===u)throw new Error("Error : need to provide total number of children (numberOfChildren) for all nodes when virtuallyLoadAllModelItems is set to true.");if(s._getCurrentPaginationOptions()&&(r-=s._getCurrentPaginationOptions().nodeMin),s.collectionView.model.length&&(e=s._getRealPositionInParentNode(l,r)),s._loadedUnloadedNodesMap){let e=s._loadedUnloadedNodesMap.get(l);if(e)for(let t=1;t<e.length;t++)o.push(e[t])}t=s._updateLoadedUnloadedData(l,u,r,d.length,s._loadedUnloadedNodesMap)}let n=e;_||(s.prepareUpdate(),s.collectionView.prepareUpdateView(),_=!0);let h=[];for(let e=0;e<d.length;e++){let t=r+e;h.push(s._getFakeNodeExpandedChildrenInClientModel(l,t))}let p=l.getChildren()?l.getChildren().length:0,g=[],f=[],m=[],y=0,S=new Map;for(let e=0;e<p;e++){let t=l.getChildren()[e];if(void 0!==t.options.multipleNodesRep){if((t.hasChildren()||t.getChildren()&&0===t.getChildren().length)&&S.set(y,!0),y+=t.options.multipleNodesRep,t.isExpanded()){g.push(t),f.push(y);let e=t.buildStringIdentifierArray().join(";");m.push(e)}}else y++}for(let e=0;e<d.length;e++){let t=d[e],a=r+e,c=l.getChildren()?l.getChildren().length:0,u=!0===s.virtuallyLoadAllModelItems?s._isNodeAlreadyLoaded(a,o):r+e<c;S.get(e)&&(t.wux_group=!0);let p=s._createNodeModelFromData(t,v);if(h[e]){for(let t=h[e].length-1;t>=0;t--){let i=h[e][t];if(i){let e=i.getParent();if(e){let t=s._loadedUnloadedNodesMap.get(e);t&&(s._loadedUnloadedNodesMap.set(p,t),s._rowRequestManager.set(p,t))}p.addChild(i,0)}}p.setState({state:"expanded"})}if(u){if(!s._currentMatchingNodeModel||!i.areEquals(s._currentMatchingNodeModel.options.grid,p.options.grid)){var w=s._getNodeInClientModel(l,a);w&&s.dataSource.onNodeModelUpdate(w,t,!1),p.destroy&&p.destroy(),n++;continue}l.removeChild(s._currentMatchingNodeModel),s._currentMatchingNodeModel=p}s.dataSource.onNodeModelUpdate(p,t,!0),l.addChild(p,n),n++;let _=p.buildStringIdentifierArray().join(";"),y=m.indexOf(_);if(-1!==y&&(g.splice(y,1),f.splice(y,1),m.splice(y,1)),t.wux_isSelected&&C.push(p),t.isExpanded&&p.getChildren()&&!p.getChildren().length&&p.expand(),s._providePushNotifVisualFeedBack){let e=p._getRowID();null!=e&&s.collectionView._flashEffectOnRow("ui-modified-push-notif",e)}}s._providePushNotifVisualFeedBack=!1,!0===s.virtuallyLoadAllModelItems&&s._updateMultipleNodesRep(l,t),s._insertBackFakeExpandedNodes(l,g,f);let b=s._rowRequestManager.get(l);if(s.virtuallyLoadAllModelItems||void 0!==b&&s._rowRequestManager.set(l,Math.min(b,l.getNumberOfChildren(!0)-s.dataSource.rowsOffsetToTriggerRequest)),u&&(l._dgv_numberOfChildren=u,a.paginationManager&&l===s._getTreeDocument()._getTrueRoot()&&a.paginationManager.pageNumberModified()),c>-1&&((!s.virtuallyLoadAllModelItems||1===t.length&&t[0]===u)&&(l._dgv_allRowsLoaded=!0),!l._dgv_numberOfChildren&&l===s._getTreeDocument()._getTrueRoot())){let e=s._getCurrentPaginationOptions();if(e){let t=(e.currentPage-1)*e.pageSize;l._dgv_numberOfChildren=l._options.children?l._options.children.length:0,l._dgv_numberOfChildren+=t,a.paginationManager.pageNumberModified()}else l._dgv_numberOfChildren=l._options.children?l._options.children.length:0}0===e&&l.preExpandDone()}}for(let e=0;e<C.length;e++){let t=C[e];t&&t.select()}if(_){if(s._treeDocument._indexRowIndexes(),s._syncModel({updateType:WUXModelUpdateTypes.Addition}),a.layout._useVariableRowHeight){a.layout.resetRowHeights();let e=s._viewRowIDNodeModelMapping.size-1;a.layout.getRowPosition(e)}!0===s._modalLoaderDisplayed&&(a.removeModalLoader(l.get("ServerSide_Loading")),s._modalLoaderDisplayed=!1),a.model&&0===a.model.length?a._displayEmptyContentMessage():a._removeEmptyContentMessage(),s._gettingRowsFlag=!1,s._treeDocument.setUseChangeTransactionMode(y),s._getGroupingOptions()&&s._getGroupingOptions().dataIndexesToGroup&&s._getTreeDocument().getModelEvents().publish({event:"groupNodes"}),s.pushUpdate(),s.collectionView.pushUpdateView()}else!0===s._modalLoaderDisplayed&&(a.removeModalLoader(l.get("ServerSide_Loading")),s._modalLoaderDisplayed=!1)},failCallback:function(e){!0===s._modalLoaderDisplayed&&(a.removeModalLoader(l.get("ServerSide_Loading")),s._modalLoaderDisplayed=!1),e&&console.warn(e),s._gettingRowsFlag=!1}}}return e.inherit({name:"ItemModelServerSide",publishedProperties:{dataSource:{defaultValue:null,type:"object"},sortModel:{defaultValue:null,type:"array"},virtuallyLoadAllModelItems:{defaultValue:!0,type:"boolean"}},_preBuild:function(){this._parent(),this._rowRequestManager=new Map,this._loadedUnloadedNodesMap=new Map,this._viewRowIDNodeModelMapping=new Map,this._viewNodeModelRowIDMapping=new Map,this._lastModelStructureRequestCounter=0},_applyProperties:function(e){this._parent(e),this.isDirty("dataSource")&&this._applyDataSource(e.dataSource),this.isDirty("sortModel")&&this._applySortModel(e.sortModel)},_updateModel:function(){this._resetTreeDocument()},_loadGroupOfRows:function(e){let t=this.collectionView,i=[],o=t.layout.getMinMaxVisibleRowIDs(),n=Math.max(o.minRowID-this.dataSource.rowsOffsetToTriggerRequest,0),r=Math.min(o.maxRowID+this.dataSource.rowsOffsetToTriggerRequest,this.getRowModelLength()-1);r<n&&(r=n),n*=this.collectionView.getNodeModelCountPerRow(),r*=this.collectionView.getNodeModelCountPerRow();for(let t=0;t<e.length;t++){let o=e[t],l=o.parentNode;if(l._dgv_allRowsLoaded)continue;if(!l||!l.getParent()&&!l._isTrueRoot())continue;let s=l._getRowID(),u=o.requestData.startRow,h=o.requestData.endRow,p=s+u,g=s+h;"number"==typeof o.requestData.absoluteStartRow&&(p=o.requestData.absoluteStartRow,g=p+Math.abs(h-u));let f=Math.min(p,g),m=!1;if((Math.max(p,g)<n||f>r)&&(m=!0),m){var a,d=this._loadedUnloadedNodesMap.get(l);if(d){a=[];for(var c=0;c<d.length;c++)a.push(d[c])}this._rowRequestManager.set(l,a);continue}let _=l.buildStringIdentifierArray(),v={startRow:u,endRow:h,sortModel:this.sortModel,rowGrouping:this._getGroupingOptions(),groupKeys:_,filterModel:this.getFilterManager()?this.getFilterManager().filterModel:void 0};i.push({request:v,parentNode:l})}let u=i.sort((function(e,t){let i=e.request.groupKeys.length,o=t.request.groupKeys.length;return i>o?-1:o>i?1:0}));if(u.length>0){let e={},i=[];for(let e=0;e<u.length;e++)i.push(u[e].request);e.groupedRequest=i;let o=s({groupedRequests:u,rowModel:this});this._gettingRowsFlag=!0,0!==t.model.length||this._modalLoaderDisplayed||(t.displayModalLoader(l.get("ServerSide_Loading")),this._modalLoaderDisplayed=!0),this.dataSource.getGroupedModelItems({request:e,successCallback:o.successCallback,failCallback:o.failCallback})}return!0},_syncModel:function(e,t){var i=this.collectionView,n=this;i._hasFlatTreeState=!0;var l=[];n._viewRowIDNodeModelMapping.clear(),n._viewNodeModelRowIDMapping.clear();var r=0;if(n._getTreeDocument()){n._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:!0,processNode:function(e){var t=e.nodeModel;if(t&&(!i.shouldNodeBeRepresented||i.shouldNodeBeRepresented(t))){if(l.push(t),void 0!==t.options.multipleNodesRep)for(var o=0;o<t.options.multipleNodesRep;o++)n._viewRowIDNodeModelMapping.set(r,t),0===o&&n._viewNodeModelRowIDMapping.set(t,r),r++;else n._viewRowIDNodeModelMapping.set(r,t),n._viewNodeModelRowIDMapping.set(t,r),r++;t.getChildren()&&(i._hasFlatTreeState=!1)}}}),i.prepareUpdateView();var s=!(!e||!(e.updateType&WUXModelUpdateTypes.Addition||e.updateType&WUXModelUpdateTypes.Removal||e.updateType&WUXModelUpdateTypes.Expand));s&&!n._isModelBeingFetched()&&o.equals(i.model,l)?i.updateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}):e&&e.updateType&WUXModelUpdateTypes.Filtering&&o.equals(i.model,l)?i.updateRowView(-1,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}):i.model=l,s&&i.updateView({updateCellWidth:!0}),s&&i._applyMaxVisibleRowCount&&i._applyMaxVisibleRowCount(void 0,i.maxVisibleRowCount,!0),!i.findStr||""===i.findStr||i._muteFind||t||i.setFindStr(i.findStr,i.matchCase,i._rowModel._computeFindEditorCurrentValue(),!0,!0,!0),i.pushUpdateView(undefined,undefined)}},_loadRows:function(e,t,i,o){if(!this._treeDocument)return!1;if(e||(e=this._treeDocument._getTrueRoot()),!e)return!1;void 0===i&&(i=0,this._providePushNotifVisualFeedBack=!1);var n=this.collectionView,r=this;if(e._dgv_allRowsLoaded&&(!n.paginationManager||e!==r._getTreeDocument()._getTrueRoot()))return!1;var a,d,c=e.buildStringIdentifierArray(),u=this._getCurrentPaginationOptions();if(u&&e===this._treeDocument._getTrueRoot()){var h=(u.currentPage-1)*u.pageSize;if(d=(a=o?o.startRow+h:e.getChildren()?e.getChildren().length+h:h)+r.dataSource.numberOfRowsPerRequest-1,a=a<u.nodeMin?u.nodeMin:a,(d=d>u.nodeMax?u.nodeMax:d)<a)return!1;if(e===r._getTreeDocument()._getTrueRoot()&&e._dgv_numberOfChildren){if(a===e._dgv_numberOfChildren)return!1;d=d>e._dgv_numberOfChildren?e._dgv_numberOfChildren:d}}else!0===this.virtuallyLoadAllModelItems&&void 0!==o?(a=o.startRow,d=o.endRow):d=(a=e.getChildren()?e.getChildren().length:0)+r.dataSource.numberOfRowsPerRequest-1;var p={startRow:a,endRow:d,sortModel:r.sortModel,rowGrouping:r._getGroupingOptions(),groupKeys:c,filterModel:this.getFilterManager()?this.getFilterManager().filterModel:void 0};!0===this.virtuallyLoadAllModelItems&&(p.requestDataForVirtualLoading={});let g=s({startRow:a,parentNode:e,currentCounter:t,rowModel:this});return r._gettingRowsFlag=!0,0!==n.model.length||r._modalLoaderDisplayed||(n.displayModalLoader(l.get("ServerSide_Loading")),r._modalLoaderDisplayed=!0),r.dataSource.getModelItems({request:p,successCallback:g.successCallback,failCallback:g.failCallback}),!0},getRowModelLength:function(){var e=this._getTreeDocument();if(e){var t=e._getTrueRoot();if(t){if(!this.virtuallyLoadAllModelItems||this._getCurrentPaginationOptions()){if(void 0!==t._dgv_numberOfChildren)return t._dgv_numberOfChildren;var i=this._getCurrentPaginationOptions();return i?(i.currentPage-1)*i.pageSize+this.collectionView.model.length:this.collectionView.model.length}var o=0;return this._loadedUnloadedNodesMap.forEach((function(e,i){i&&(i===t||i.isVisible()&&i.isExpanded())&&(o+=i.getAllDirectChildrenCount())})),o}}return 0},getVisibleNodeModel:function(e,t){if(!(e<0||this._preventNodesLoading)){var i=this.collectionView,o=void 0,n=i.model;e<this._getCollectionViewModelDisplayedLength()&&(o=this._getNodeModelAtRowID(e));var l=o;!l&&n.length&&(l=n[n.length-1]);var r=void 0;if(o&&(r=l.getParent()),r||(r=this._treeDocument._getTrueRoot()),l&&r){let i=this._getVirtualLocalIDInParentNodeFromRowID(e);if(void 0===i)return;let o=this._rowRequestManager.get(r);this.virtuallyLoadAllModelItems||void 0!==o||(o=this.dataSource.numberOfRowsPerRequest-this.dataSource.rowsOffsetToTriggerRequest);let n,l=!1;if(this.virtuallyLoadAllModelItems){let t=!1,i=this._needToLoadRows(e,r,this.dataSource.numberOfRowsPerRequest,t);l=i.needLoadingRequest,n=i.requestData}else l=i>o;if(!0===l)if(this.virtuallyLoadAllModelItems){var s=this._getUnloadedItemsAfterIncludingRowID(e,r,this.dataSource.numberOfRowsPerRequest,this._rowRequestManager.get(r)),a=this._getUnloadedItemsBefore(e,r,this.dataSource.numberOfRowsPerRequest,this._rowRequestManager.get(r)),d=s.number,c=a.number,u=d>0&&c>0?this.dataSource.rowsOffsetToTriggerRequest:0,h=void 0!==r._getRowID()&&null!==r._getRowID()?r._getRowID()+1:0,p=Math.max(h,e-u),g=this._needToLoadRows(p,r,this.dataSource.numberOfRowsPerRequest);if(l=g.needLoadingRequest,n=g.requestData,!0===g.needLoadingRequest){this._requestToDo||(this._requestToDo=[]),this._parentNodesArray||(this._parentNodesArray=[]);var f={parentNode:r,rowID:e,rowIDToLoad:p,currentCounter:t,requestData:n};if(this._requestToDo.push(f),this._parentNodesArray.push(r),this._requestToDo.length>1&&this.dataSource.hasModelStructureRequest())return;var m=this;setTimeout((function(){if(m.dataSource.hasModelStructureRequest())m._loadGroupOfRows(m._requestToDo),m._parentNodesArray=[],m._requestToDo=[];else{if(m._requestToDo.length>1)return void m._requestToDo.splice(0,1);if(1===m._parentNodesArray.length){var e=m._requestToDo[0];m._parentNodesArray=[],m._requestToDo=[],m._loadRows(e.parentNode,e.currentCounter,e.rowIDToLoad,e.requestData)}else{for(var t=0;t<m._parentNodesArray.length;t++){var i=m._loadedUnloadedNodesMap.get(m._parentNodesArray[t]);if(i)for(var o=[],l=0;l<i.length;l++)o.push(i[l]);m._rowRequestManager.set(m._parentNodesArray[t],o)}var r=m._parentNodesArray[m._parentNodesArray.length-1];m._parentNodesArray=[];e=m._requestToDo[0];var s=m._getUnloadedItemsAfterIncludingRowID(e.rowID,r,m.dataSource.numberOfRowsPerRequest,m._rowRequestManager.get(r)),a=m._getUnloadedItemsBefore(e.rowID,r,m.dataSource.numberOfRowsPerRequest,m._rowRequestManager.get(r)),d=s.number,c=a.number,u=d>0&&c>0?m.dataSource.rowsOffsetToTriggerRequest:0,h=void 0!==r._getRowID()&&null!==r._getRowID()?r._getRowID()+1:0,p=Math.max(h,e.rowID-u),g=m._needToLoadRows(e.rowIDToLoad,e.parentNode,m.dataSource.numberOfRowsPerRequest);m._requestToDo=[],n=g.requestData,m._loadRows(e.parentNode,e.currentCounter,p,n)}}}),300)}}else this._rowRequestManager.set(r,r.getNumberOfChildren(!0)+(this.dataSource.numberOfRowsPerRequest-this.dataSource.rowsOffsetToTriggerRequest)),this._loadRows(r,t,e,n)}else if(!o||o!=l){var _=this._getCurrentPaginationOptions();if(!_||_.nodeMax-_.nodeMin>=i.model.length){let i=!1,o=this._rowRequestManager.get(r);if(this.virtuallyLoadAllModelItems){i=this._needToLoadRows(e,r,this.dataSource.numberOfRowsPerRequest,!1).needLoadingRequest}else void 0===o&&(this._rowRequestManager.set(r,r.getNumberOfChildren(!0)+(this.dataSource.numberOfRowsPerRequest-this.dataSource.rowsOffsetToTriggerRequest)),i=!0);i&&this._loadRows(r,t,e)}}return o}},_isModelBeingFetched:function(){return this._gettingRowsFlag},_getTreeDocument:function(){if(!this._treeDocument){this._treeDocument=new this.collectionView.documentClassForServerSide({useAsyncPreExpand:!0,nodeModelClass:this.collectionView.nodeModelClass||this.collectionView.documentClassForServerSide.prototype.defaultOptions.nodeModelClass||t}),this._listenToTreeDocument();var e=this;this._treeDocument.onPreExpand((function(t){var i=!1,o=t.target;if(o&&void 0!==o.getChildren()&&0===o.getChildren().length){o.setState({state:"expanding"});let n=t.data&&t.data.expandAll?-1:t.data.numberOfLevelsToExpand;i=e._requestModelStructure(o,n)}i||o.preExpandDone()})),this._treeDocument.onPostExpand((t=>{const i=t.target;e._updateLoadedNodeWithoutChildExpander(i)})),this._treeDocument.onPostCollapse((t=>{const i=t.target;e._updateLoadedNodeWithoutChildExpander(i)}))}return this._treeDocument},_resetTreeDocument:function(){let e=this.collectionView.getCellsXSO();e&&e.empty();let t=this.collectionView.getNodesXSO();t&&t.empty(),this._rowRequestManager.clear(),this._loadedUnloadedNodesMap.clear(),this._viewRowIDNodeModelMapping.clear(),this._viewNodeModelRowIDMapping.clear(),this._requestToDo=[],this._parentNodesArray=[];let i=!0;const o=()=>{if(this._getCurrentPaginationOptions())this.getVisibleNodeModel(0);else{const e=++this._lastModelStructureRequestCounter;this._requestModelStructure(this._getTreeDocument()._getTrueRoot(),void 0,e)}this._preventNodesLoading=!1};if(this._treeDocument){var n=this._treeDocument.getUseChangeTransactionMode();if(this._treeDocument.setUseChangeTransactionMode(!1),this._treeDocument._getTrueRoot()._dgv_allRowsLoaded=!1,this._getCurrentPaginationOptions()||(this._treeDocument._getTrueRoot()._dgv_numberOfChildren=void 0),this._treeDocument.isInTransaction()){i=!1;const e=this._treeDocument.onUpdate((()=>{this._treeDocument.unsubscribe(e),o()}))}this._treeDocument.empty(),this._treeDocument.setUseChangeTransactionMode(n)}this.dataSource&&(this._getTreeDocument(),i&&o())},_applyDataSource:function(e){var t=this;this.collectionView._isReady&&this._resetTreeDocument(),e&&e._modelEvents&&this._dataSourceModelEventListenerArray&&(this._cleanDataSourceEventListener(),e._getRowModelFilterManager=void 0),this.dataSource&&(this._rowRequestManager.clear(),this._loadedUnloadedNodesMap.clear(),this._viewRowIDNodeModelMapping.clear(),this._viewNodeModelRowIDMapping.clear(),this._dataSourceModelEventListenerArray||(this._dataSourceModelEventListenerArray=[]),this._dataSourceModelEventListenerArray.push(this.dataSource._modelEvents.subscribe({event:"pushUpdatesNotifications"},(function(e){t._onPushUpdatesNotifications(e.dataToUpdateArray,e.callback)}))),this._dataSourceModelEventListenerArray.push(this.dataSource._modelEvents.subscribe({event:"executePendingNotifications"},(function(){t.collectionView.executePendingNotifications()}))),this._dataSourceModelEventListenerArray.push(this.dataSource._modelEvents.subscribe({event:"flushPendingNotifications"},(function(){t.collectionView.flushPendingNotifications()}))),this._dataSourceModelEventListenerArray.push(this.dataSource._modelEvents.subscribe({event:"filterModelChange"},(function(e){t.setFilterModel(e.filterModel)}))),this._dataSourceModelEventListenerArray.push(this.dataSource._modelEvents.subscribe({event:"reapplyFilterModel"},(function(){t.reapplyFilterModel()}))),this.dataSource._getRowModelFilterManager=this.getFilterManager.bind(this),this._setFilterViewManager())},_applyVirtuallyLoadAllModelItems:function(){if(this.collectionView._isReady){if(this._getTreeDocument()){var e=this;this._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:!1,processNode:function(t){if(t.nodeModel){var i=[];if(e._loadedUnloadedNodesMap){var o=e._loadedUnloadedNodesMap.get(t.nodeModel.getParent());if(o)for(var n=1;n<o.length;n++)i.push(o[n]);e._rowRequestManager.clear(),e._loadedUnloadedNodesMap.clear(),e._viewRowIDNodeModelMapping.clear(),e._viewNodeModelRowIDMapping.clear()}e._updateMultipleNodesRep(t.nodeModel.getParent(),i)}}})}this._syncModel()}},_applySortModel:function(e){this._parent(),this.collectionView._isReady&&this._resetTreeDocument()},_doGroupingOnModel:function(e){this.collectionView._isReady&&this._resetTreeDocument()},_updateLoadedUnloadedData:function(e,t,i,o,n,l){var r=n.get(e),s=[];if(r)for(var a=1;a<r.length;a++)s.push(r[a]);var d=[];if(0===s.length){var c;if(i>0)d.push(0),d.push(i),d.push(o),(c=t-o-i)>0&&d.push(c);else d.push(Math.min(o,t)),(c=t-o)>0&&d.push(c)}else{for(var u=[],h=[],p=o,g=0,f=0,m=i,_=0;_<s.length;_++){var v;if(f=g,g+=s[_],_%2==0){if(u.push(s[_]),m<g&&p>0)p-=v=Math.min(g-m,p),m=g}else if(m<g&&p>0)p-=v=Math.min(g-m,p),m-f>0?(h.push(m-f),u.push(v)):u[u.length-1]+=v,h.push(g-(m+v)),m=g;else h.push(s[_])}d=this._removeNullValues(void 0,u,h)}d.unshift(t),!1!==l&&n.set(e,d);for(var y=[],C=1;C<d.length;C++)y.push(d[C]);return y},_removeNullValues:function(e,t,i){if(!t){t=[],i=[];for(var o=0;o<e.length;o++)o%2==0?t.push(e[o]):i.push(e[o])}for(var n=[],l=!1,r=!1,s=0;s<t.length;s++)!1===l?0!==t[s]||0===s?n.push(t[s]):r=!0:(n[n.length-1]+=t[s],l=!1),s<i.length?!1===r?0!==i[s]?n.push(i[s]):l=!0:(n[n.length-1]+=i[s],r=!1):l=!0;return n},_modifyLoadedUnloadedNodes:function(e,t,i,o,n){var l=n.get(e);l||(l=[0,0]);var r=[],s=l[0];if(0===s&&!1===i)return-1;for(var a=1;a<l.length;a++)r.push(l[a]);for(var d=0,c=!1,u=0;u<r.length;u++)if((d+=r[u])>=t){if(u%2==0){let e=[];if(i)o?r[u]=r[u]+1:(e.push(r[u]-(d-t)),e.push(1),e.push(d-t),r.splice(u,1,e[0]),r.splice(u+1,0,e[1]),r.splice(u+2,0,e[2]),r=this._removeNullValues(r));else{if(d===t)continue;if(1===r[u])if(0===u)r[u]=0;else{var h=u+1<r.length?r[u+1]:0,p=r[u-1]+h;r.splice(u-1,3,p)}else r[u]>0?r[u]=r[u]-1:(u<r.length-1&&(r[u+1]=r[u+1]-1),r=this._removeNullValues(r))}c=!0;break}if(i)o?(r.splice(u,1,r[u]-(d-t)),r.splice(u+1,0,1),r.splice(u+2,0,d-t),r=this._removeNullValues(r)):r[u]=r[u]+1;else{if(d===t)continue;if(1===r[u]){h=u+1<r.length?r[u+1]:0,p=r[u-1]+h;r.splice(u-1,3,p)}else r[u]=r[u]-1}c=!0;break}var g=s;return!1===c?console.log("Warning, trying to insert or remove a node at location",t," whereas parentNode called ",e.options.label," only owns ",d," items (loaded or unloaded)"):(g=i?s+1:s-1)?(r.unshift(g),n.set(e,r)):(n.delete(e),delete e._dgv_allRowsLoaded),g},_addItemInLoadedUnloadedData:function(){},_insertBackFakeExpandedNodes:function(e,t,i){let o=r(this);for(let n=0;n<t.length;n++){let l=t[n],r=i[n],s=e.getChildren()?e.getChildren():[],a=0,d=0;for(let t=0;t<s.length;t++){let i=s[t];if(void 0!==i.options.multipleNodesRep){if(a+i.options.multipleNodesRep>=r){let t=r-a-1,n=i.options.multipleNodesRep-t-1;if(i.options.multipleNodesRep=t,e.addChild(l,d+1),n>0){let t=new o({label:"",multipleNodesRep:n});e.addChild(t,d+2)}let s=this._loadedUnloadedNodesMap.get(l);s&&this._rowRequestManager.set(l,s);break}a+=i.options.multipleNodesRep}else a++;d++}for(let t=s.length-1;t>=0;t--){let i=s[t];void 0!==i.options.multipleNodesRep&&0===i.options.multipleNodesRep&&e.removeChild(i)}}},_updateMultipleNodesRep:function(e,t){this.prepareUpdate();let i=e.isExpanded();var o=e.getChildren();if(o)for(var n=o.length-1;n>=0;n--){var l=o[n];void 0!==l.options.multipleNodesRep&&e.removeChild(l)}if(!0===this.virtuallyLoadAllModelItems)for(var s=r(this),a=0,d=0;d<t.length;d++)if(d%2==0)a+=t[d];else{var c=new s({label:"",multipleNodesRep:t[d]});e.addChild(c,a),a+=1}i&&e.setState({state:"expanded"}),this.pushUpdate()},_getTotalChildrenCount:function(e){let t=e.getChildren(),i=0;if(t)for(let e=0;e<t.length;e++)i+=void 0!==t[e].options.multipleNodesRep?t[e].options.multipleNodesRep:1;return i},_getVirtualLocalIDInParentNodeFromRowID:function(e){var t=this.collectionView.model;if(this.virtuallyLoadAllModelItems){var i;if(!(i=this._getNodeModelAtRowID(e)))return;if(!i.getParent())return;for(var o=i.getParent().getChildren(),n=0,l=0,r=0;r<o.length;r++){if(o[r]===i){n=l;break}void 0===o[r].options.multipleNodesRep?l++:l+=o[r].options.multipleNodesRep}return e-this._viewNodeModelRowIDMapping.get(i)+n}return(i=t[e])?i._getLocalID():void 0},_getRealPositionInParentNode:function(e,t){var i=e.getChildren(),o=0;if(!i||0===i.length)return 0;for(var n=0;n<=i.length;n++){if(t<=o)return n;if(n===i.length)return t;void 0===i[n].options.multipleNodesRep?o++:o+=i[n].options.multipleNodesRep}},_needToLoadRows:function(e,t,i,o){var n=this._computeRowsToLoad(e,t,i,this._rowRequestManager.get(t)),l=n.startRow;const r=n.numberToLoad?n.numberToLoad:n.endRow-l==0?0:n.endRow-l+1;if(r<=0)return{needLoadingRequest:!1};let s=this._getCurrentPaginationOptions(),a=this._loadedUnloadedNodesMap.get(t);if(!a&&!s)return{needLoadingRequest:!0,requestData:n};const d=this._loadedUnloadedNodesMap.get(t)?this._loadedUnloadedNodesMap.get(t)[0]:s?s.pageSize:0;a=this._rowRequestManager.get(t);let c=[];if(a)for(var u=1;u<a.length;u++)c.push(a[u]);else c=this._updateLoadedUnloadedData(t,d,l,0,this._rowRequestManager);let h=0;return c.findIndex(((e,t)=>(h+=e,t<c.length-1?l<h+c[t+1]:l<h)))%2==0?(this._updateLoadedUnloadedData(t,d,l,r,this._rowRequestManager,o),{needLoadingRequest:!0,requestData:n}):{needLoadingRequest:!1}},_getUnloadedItemsBefore:function(e,t,i,o){var n=0,l=e,r=e,s=e,a=e,d=this._getCollectionViewModelDisplayedLength();if(this.collectionView&&this.collectionView.model&&e<d){for(var c=i+this.dataSource.rowsOffsetToTriggerRequest,u=Math.max(0,e-1-c),h=e-1;h>=u;h--){var p=this._getNodeModelAtRowID(h);if(this._isNodeLoadedOrLoading(p,t,h,o)||p.getParent()!==t){if(n)break}else 0===n&&(r=h),l=h,n++;if(p.getParent()!==t)break;if(h<=e-this.dataSource.rowsOffsetToTriggerRequest&&0===n){n=0;break}}s=this._getVirtualLocalIDInParentNodeFromRowID(l),a=this._getVirtualLocalIDInParentNodeFromRowID(r)}return{number:n,startingRowID:s,endingRowID:a,absoluteStartRowID:l,absoluteEndRowID:r}},_getUnloadedItemsAfterIncludingRowID:function(e,t,i,o){var n=0,l=e,r=e,s=e,a=e,d=this._getCollectionViewModelDisplayedLength();if(this.collectionView&&this.collectionView.model&&e<d){for(var c=i+this.dataSource.rowsOffsetToTriggerRequest,u=Math.min(d,e+c),h=e;h<u;h++){var p=this._getNodeModelAtRowID(h);if(this._isNodeLoadedOrLoading(p,t,h,o)||p.getParent()!==t){if(n)break}else 0===n&&(l=h),r=h,n++;if(p.getParent()!==t)break;if(h>=e+this.dataSource.rowsOffsetToTriggerRequest&&0===n){n=0;break}}s=this._getVirtualLocalIDInParentNodeFromRowID(l),a=this._getVirtualLocalIDInParentNodeFromRowID(r)}return{number:n,startingRowID:s,endingRowID:a,absoluteStartRowID:l,absoluteEndRowID:r}},_computeRowsToLoad:function(e,t,i,o){if(o&&o.length>2){var n=this._getUnloadedItemsAfterIncludingRowID(e,t,i,o);if(n.number>=i)return{absoluteStartRow:n.absoluteStartRowID,startRow:n.startingRowID,endRow:n.startingRowID+i-1};var l=this._getUnloadedItemsBefore(e,t,i,o);if(n.number>0){if(l.number>0&&l.endingRowID===n.startingRowID-1){let e=Math.max(l.startingRowID,n.endingRowID-i+1);return{startRow:e,endRow:n.endingRowID,absoluteStartRow:n.absoluteEndRowID-(n.endingRowID-e)}}return{absoluteStartRow:n.absoluteStartRowID,startRow:n.startingRowID,endRow:Math.min(n.startingRowID+i-1,n.endingRowID),numberToLoad:n.number}}let r=Math.max(l.endingRowID-i+1,l.startingRowID);return{startRow:r,endRow:l.endingRowID,absoluteStartRow:l.absoluteEndRowID-(l.endingRowID-r)}}return o&&2===o.length?{startRow:0,endRow:0}:{absoluteStartRow:e,startRow:0,endRow:i-1}},_isNodeLoadedOrLoading:function(e,t,i,o){if(e.options.multipleNodesRep){if(!o)return!1;for(var n=this._getVirtualLocalIDInParentNodeFromRowID(i),l=0,r=1;r<o.length;r++)if(n<(l+=o[r]))return r%2==1;return!1}return!0},_updateClientModelFromFind:function(e,t,i,o,n,s){if(e!==this._findStr&&(this._findCurrentResultValue=void 0,this._findStr=e),!this._isRequestNeededForNextFindValue(i,t))return this._findCurrentResultValue=i,this._parent(e,t,i,o,!0,!0);this._findMatchCase=t,this._findCurrentResultValue=i;var a=this;a._launchServerFindTimeout&&clearTimeout(a._launchServerFindTimeout),a._launchServerFindTimeout=setTimeout((function(){if(a._launchServerFindTimeout=null,!0!==a.virtuallyLoadAllModelItems)throw'Error : Find cannot be launched on a Server side model if "virtuallyLoadAllModelItems" of collectionView is not applied.';var n=a.collectionView,s=a._getColumnsToProcessForFindData(n,e,t).findableColumnsDataIndexes,d={findStr:e,matchCase:t,findCurrentValue:i,findNavigationMode:a.collectionView.findNavigationMode,sortModel:a.sortModel,rowGrouping:a._getGroupingOptions(),requestDataForFindOnServer:{findCurrentValue:i,findRequestTimeStamp:a._lastFindRequestTimeStamp},filterModel:a.getFilterManager()?a.getFilterManager().filterModel:void 0,findableColumnsDataIndexes:s};let c=function(e){let t=e.rowModel,i=e.rowModel.collectionView,o=e.applyFindOnClientModelCB;return{successCallback:function(e,n,s,a,d,c){if(c.findRequestTimeStamp===t._lastFindRequestTimeStamp){var u=c.findCurrentValue;if(u>=a&&(u=0),t._findCurrentResultValue=u,t._findcurrentValueIndexInRow=d,e&&Array.isArray(e)&&e.length>0){if(e.length!==n.length||n.length!==s.length)throw"ERROR in Find server side returned values : all returned array must have the same length. Please check your returned arrays.";var h=t._treeDocument.getUseChangeTransactionMode();t._treeDocument.setUseChangeTransactionMode(!1);var p=t._getTreeDocument()._getTrueRoot();t.prepareUpdate(),t.collectionView.prepareUpdateView();for(var g=r(t),f=0;f<e.length;f++){var m=e[f],_=n[f],v=s[f],y=t._getNodeInClientModel(p,_);if(y)p=y;else{var C=t._updateLoadedUnloadedData(p,v,_,1,t._loadedUnloadedNodesMap);t._updateLoadedUnloadedData(p,v,_,1,t._rowRequestManager);var w=t.collectionView.getGroupingOptions(),S=w&&w.dataIndexesToGroup?w.dataIndexesToGroup.length:0;let i;i=t._treeDocument.createModelNode?t._treeDocument.createModelNode({label:m.tree,icons:m.icons,grid:m,children:f!==e.length-1||f<S?[]:void 0}):new g({label:m.tree,icons:m.icons,grid:m,children:f!==e.length-1||f<S?[]:void 0}),m.stringIdentifier&&(i.stringIdentifier=m.stringIdentifier);var b=_;t.collectionView.model.length&&(b=t._getRealPositionInParentNode(p,_)),p.addChild(i,b),t._updateMultipleNodesRep(p,C),p=i}p&&f==e.length-1&&(t._currentMatchingNodeModel=p)}if(t._treeDocument._indexRowIndexes(),t._syncModel({updateType:WUXModelUpdateTypes.Addition},!0),i.layout._useVariableRowHeight){i.layout.resetRowHeights();let e=t._viewRowIDNodeModelMapping.size-1;i.layout.getRowPosition(e)}!0===t._modalLoaderDisplayed&&(i.removeModalLoader(l.get("ServerSide_Loading")),t._modalLoaderDisplayed=!1),i.model&&0===i.model.length?i._displayEmptyContentMessage():i._removeEmptyContentMessage(),t._gettingRowsFlag=!1,t._treeDocument.setUseChangeTransactionMode(h),t.pushUpdate(),t.collectionView.pushUpdateView(),t._getGroupingOptions()&&t._getGroupingOptions().dataIndexesToGroup&&t._getTreeDocument().getModelEvents().publish({event:"groupNodes"})}t._findResultNumber=a,t._matchingStringCount=a,"cell"===t.collectionView.findNavigationMode?t._matchingCellIDsCount=a:"row"===t.collectionView.findNavigationMode&&(t._matchingRowsCount=a),o&&o.call(t,u)}},failCallback:function(e){!0===t._modalLoaderDisplayed&&(i.removeModalLoader(l.get("ServerSide_Loading")),t._modalLoaderDisplayed=!1),e&&console.warn(e),t._gettingRowsFlag=!1}}}({rowModel:a,applyFindOnClientModelCB:o});a._gettingRowsFlag=!0,0!==n.model.length||a._modalLoaderDisplayed||(n.displayModalLoader(l.get("ServerSide_Loading")),a._modalLoaderDisplayed=!0),a.dataSource.getCurrentFindResult({request:d,successCallback:c.successCallback,failCallback:c.failCallback})}),500)},_getNodeInClientModel:function(e,t){var i=e.getChildren(),o=-1;if(i)for(var n=0;n<i.length;n++)if(void 0===i[n].options.multipleNodesRep||1===i[n].options.multipleNodesRep&&i[n].isExpanded()){if(++o===t)return i[n]}else if((o+=i[n].options.multipleNodesRep)>=t)return},_getFakeNodeExpandedChildrenInClientModel(e,t){let i=e.getChildren(),o=-1;if(i)for(let e=0;e<i.length;e++)if(void 0===i[e].options.multipleNodesRep){if(o++,o===t)return}else if(o+=i[e].options.multipleNodesRep,o===t)return i[e].isExpanded()?i[e].getChildren():void 0},_isNodeAlreadyLoaded:function(e,t){for(var i=0,o=0;o<t.length;o++)if(i+=t[o],o%2==0){if(e<i)return!0}else if(e<i)return!1},_computeMatchingStringsCount:function(e){return e?this._parent(e):this._matchingStringCount},_computeMatchingCellIDsCount:function(){return this._matchingCellIDsCount},_computeMatchingNodeModelsCount:function(){return this._matchingRowsCount},_computeCurrentMatchingStringIndex:function(e,t){return this._getCurrentSubstringAndCellIDIndexFromNodeModelOccurrence(e,this._currentMatchingNodeModel,this._findcurrentValueIndexInRow)},_getCurrentSubstringAndCellIDIndexFromNodeModelOccurrence:function(e,t,i){var o=e._matchingAllNodeModelsArray.indexOf(t);if(-1===o)throw"ERROR : given nodeModel is not found among found nodeModels.";var n,l=0;if("cell"===e.findNavigationMode){for(var r=0;r<e._matchingCellIDsArray.length;r++){var s=e._matchingCellIDsArray[r];if(e.getCellInfosAt(s).nodeModel===t)break;l++}var a=l+i;n=e._getMatchingStringIndexFromMatchingCellIDIndex(a)}else if("row"===e.findNavigationMode)l=e._matchingNodeModelsArray.indexOf(t),n=e._getMatchingStringIndexFromMatchingRowIDIndex(l);else{for(r=0;r<o;r++)l+=e._matchingFoundArrays[r].length;n=l+i}return n},_computeNextMatchingData:function(e,t){return t?this._parent(e,t):this._getCurrentSubstringAndCellIDIndexFromNodeModelOccurrence(this.collectionView,this._currentMatchingNodeModel,this._findcurrentValueIndexInRow)},_computePreviousMatchingData:function(e,t){return t?this._parent(e):this._getCurrentSubstringAndCellIDIndexFromNodeModelOccurrence(this.collectionView,this._currentMatchingNodeModel,this._findcurrentValueIndexInRow)},_computeFindEditorCurrentValue:function(){return this._findCurrentResultValue+1},_getNodeModelsToProcessFromMatchCaseChange:function(){},_isRequestNeededForNextFindValue:function(e,t){var i=this._findCurrentResultValue;if(void 0===i)return!0;if(this._findMatchCase!==t)return!0;var o,n=this.collectionView,l=e-i;if(0===l)return!1;if(1===l||i===this._findResultNumber-1&&0===e)o=this._computeNextMatchingData(n,!0);else{if(-1!==l&&(0!==i||e!==this._findResultNumber-1))throw"Find increment is not possible : problem!!!!!!";o=this._computePreviousMatchingData(n,!0)}if(o===n._currentMatchingStringIndex)return!0;var r,s,a=n._getMatchingCellIDIndexFromMatchingStringIndex(o);if((a-n._currentMatchingCellIDIndex)*l<0)return!0;var d=n._getMatchingCellID(n._currentMatchingCellIDIndex),c=n._getMatchingCellID(a);if(a>n._currentMatchingCellIDIndex?(r=n.getNodeModelAt(d),s=n.getNodeModelAt(c)):(r=n.getNodeModelAt(c),s=n.getNodeModelAt(d)),!r||!s)return!0;if(r._getID()===s._getID())return!1;var u=!1,h=!1,p=!1;return this._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:!1,processNode:function(e){var t=e.nodeModel;if(t)if(t._getID()===r._getID()){if(h=!0,Array.isArray(t._options.children)&&0===t._options.children.length)return u=!0,p=!0,{stopProcessing:!0}}else{if(t._getID()===s._getID()&&!p)return u=!1,p=!0,{stopProcessing:!0};if(!0===h&&!p&&(void 0!==t.options.multipleNodesRep||Array.isArray(t._options.children)&&0===t._options.children.length))return u=!0,p=!0,{stopProcessing:!0}}}}),u},_isServerSide:function(){return!0},_setFilterViewManager:function(){},_getFiltersModelData:function(){var e={};if(this.getFilterManager()&&this.getFilterManager().getFilters())for(var t in this.getFilterManager().getFilters())e[t]=o.clone(this.getFilterManager().getFilters()[t].filterModel,!0);return e},setFilterModel:function(e){if(this._filterManager&&o.equals(this._filterManager.filterModel,e))return;this.getFilterManager().filterModel=e,this.collectionView.updateRowView(-1,{updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})},getFilterManager:function(){return this._filterManager||this._createFilterManager(),this._filterManager},reapplyFilterModel:function(){if(this._filterManager){var e=this._filterManager.filterModel;this._filterManager.filterModel={},this._filterManager.filterModel=e}},_createFilterManager:function(e){this._filterManager||(this._filterManager=new n({model:this.dataSource,filterModel:e||{}}))},_updateLoadedNodeWithoutChildExpander:function(e){if(e&&!0===e._dgv_allRowsLoaded&&(null===e.getChildren()||0===e.getChildren().length)){var t=this.collectionView;this.collectionView.updateCellView(t.layout.getCellIDFromCoordinates({rowID:e._getRowID(),columnID:t.layout.getColumnIndex("tree")}),{updateCellContent:!0})}},destroy:function(){this._cleanDataSourceEventListener(),this._parent()},_cleanDataSourceEventListener:function(){if(this._dataSourceModelEventListenerArray)for(var e=0;e<this._dataSourceModelEventListenerArray.length;e++)this.dataSource._modelEvents.unsubscribe(this._dataSourceModelEventListenerArray[e])},_onPushUpdatesNotifications:function(e,t){var i=0;if(e&&Array.isArray(e))if(this.collectionView.syncClientModelOnDemand){this._pendingPushNotificationsArray||(this._pendingPushNotificationsArray=[]);for(var o=0;o<e.length;o++)this._pendingPushNotificationsArray.push(e[o])}else{var n=this.dataSource.convertPushUpdatesNotificationsWithContext(e,{sortModel:this.sortModel,filterModel:this.getFilterManager()?this.getFilterManager().filterModel:void 0,rowGrouping:this.collectionView.getGroupingOptions()});i=this._synchronizeTreeDocumentFromDataSourceUpdate(n)}t&&t.call(this.dataSource,{treatedNotificationsNodesNumber:i})},_hasPendingNotifications:function(){return this._pendingPushNotificationsArray&&this._pendingPushNotificationsArray.length>0},_getPendingNotifications:function(){return this._pendingPushNotificationsArray},_synchronizeTreeDocumentFromDataSourceUpdate:function(e){let t=0;if(e&&e.length>0){this.collectionView.findCtx?this.collectionView.findCtx.close():this.collectionView.findWidget&&this.collectionView.findWidget.close();let o=[],n=null;this._parentNodeMapForNodesAdding?this._parentNodeMapForNodesAdding.clear():this._parentNodeMapForNodesAdding=new Map,this.prepareUpdate(),this.collectionView.prepareUpdateView();let l=this._treeDocument.getUseChangeTransactionMode();this._treeDocument.setUseChangeTransactionMode(!1),this._providePushNotifVisualFeedBack=!1;for(let a=0;a<e.length;a++){let d=this._treatNotification(e[a]);if(d){if(d.treatedNotificationsNodesNumber&&(t+=d.treatedNotificationsNodesNumber),d.modifiedNodes&&(o=o.concat(d.modifiedNodes)),d.nodesToRemove){n||(n=new Set);for(let c=0;c<d.nodesToRemove.length;c++)n.add(d.nodesToRemove[c])}this._syncModel(),"nodesRemoved"!==e[a].operationType&&(this._providePushNotifVisualFeedBack=!0)}}function r(e,t){return e-t}for(const[u,h]of this._parentNodeMapForNodesAdding){let p=h.sort(r),g=[],f=[];g.push(f);for(let m=0;m<p.length;m++)if(0===m&&g[0].push(p[0]),p[m+1])if(p[m+1]-p[m]==1)g[g.length-1].push(p[m+1]);else{let _=[p[m+1]];g.push(_)}for(let v=g.length-1;v>=0;v--)for(let y=0;y<g[v].length;y++)this._addNodeToParentAtPosition(u,g[v][y])}this._parentNodeMapForNodesAdding.clear(),n&&n.forEach((e=>{e&&e.getParent()&&this._removeNode(e)})),this._treeDocument.setUseChangeTransactionMode(l);let s="ui-removed";for(let C=0;C<o.length;C++){let w=o[C];null!=w&&this.collectionView._flashEffectOnRow(s,w)}this.collectionView.pushUpdateView(),this.pushUpdate();var i=this;setTimeout((function(){i._providePushNotifVisualFeedBack=!1}),2e3)}return t},_executePendingNotifications:function(e){if(this._pendingPushNotificationsArray&&Array.isArray(this._pendingPushNotificationsArray)){var t=this.dataSource.convertPushUpdatesNotificationsWithContext(this._pendingPushNotificationsArray,{sortModel:this.sortModel,filterModel:this.getFilterManager()?this.getFilterManager().filterModel:void 0,rowGrouping:this.collectionView.getGroupingOptions()}),i=0;t&&Array.isArray(t)&&(i=this._synchronizeTreeDocumentFromDataSourceUpdate(t)),this._flushPendingNotifications()}e&&e.call(this.dataSource,{treatedNotificationsNodesNumber:i})},_flushPendingNotifications:function(){this._pendingPushNotificationsArray=[]},_treatNotification:function(e){if(e)switch(e.operationType){case"nodesAdded":return this._addNodesFromDataSourceRequest(e.nodesNumber,e.nodesPath);case"nodesRemoved":return this._removeNodesFromDataSourceRequest(e.nodesNumber,e.nodesPath);case"nodesChanged":return this._changeNodesFromDataSourceRequest(e);case"reset":return this._resetTreeDocument(),!0;default:console.warn("Warning in ItemModelServerSide._treatNotification ; notification.operationType unknown : "+e.operationType)}},_getNodeLocationData:function(e){var t,i,o=this._getTreeDocument()._getTrueRoot();if(!e.length)return{node:o};for(var n=0;n<e.length;n++){i=e[n];var l=this._getNodeInClientModel(o,i);if(!l){n!==e.length-1&&(o=void 0);break}n<e.length-1?o=l:n===e.length-1&&(t=l)}return{parentNode:o,node:t,indexInParentNode:i}},_addNodesFromDataSourceRequest:function(e,t){return this._modifyNodesFromDataSourceRequest(e,t,"add")},_modifyNodesFromDataSourceRequest:function(e,t,i,o){if(!e)return{treatedNotificationsNodesNumber:0};let n=e,l=this._getNodeLocationData(t),r=l.parentNode,s=Boolean(r),a=l.indexInParentNode,d=[];if(r&&Array.isArray(r.getChildren())&&0===r.getChildren().length&&(s=!1),s)for(var c=0;c<e;c++){let e=this._loadedUnloadedNodesMap.get(r)?this._loadedUnloadedNodesMap.get(r)[0]:0;if(a<0||a>("add"===i?e+c:e-1))console.warn("Warning, given index is outside parent bounds."),n--;else if("add"===i){let e=this._parentNodeMapForNodesAdding.get(r);e||(e=[]),e.push(a),this._parentNodeMapForNodesAdding.set(r,e),a++}else if("remove"===i){let e=this._preRemoveNode(r,a);void 0!==e&&(d.push(e),a++)}else if(this._removeNodeAtLocation(r,a),o){if(void 0===o[c]){for(var u=[],h=0;h<t.length;h++)h!==t.length-1?u.push(t[h]):u.push(a+c);o[c]=u}}else this._addNodeToParentAtPosition(r,a),a++}if(o){var p=o.sort((function(e,t){for(var i=Math.min(e.length,t.length),o=0;o<i;o++){if(e[o]<t[o])return-1;if(e[o]>t[o])return 1}}));for(c=0;c<p.length;c++){var g=p[c];this._modifyNodesFromDataSourceRequest(1,g,"add")}}return{treatedNotificationsNodesNumber:n,nodesToRemove:d}},_addNodeToParentAtPosition:function(e,t){var i=this._modifyLoadedUnloadedNodes(e,t,!0,!1,this._loadedUnloadedNodesMap);return this._modifyLoadedUnloadedNodes(e,t,!0,!1,this._rowRequestManager),e._dgv_numberOfChildren=i,e._dgv_allRowsLoaded=!1,this._updateRealAndUnloadedDataAfterUnitOperation(e),[]},_updateRealAndUnloadedDataAfterUnitOperation:function(e){let t=this._loadedUnloadedNodesMap.get(e),i=[],o=t?t.length:0;for(var n=1;n<o;n++)i.push(t[n]);let l=e.getChildren()?e.getChildren().length:0,r=[],s=[],a=0;for(let t=0;t<l;t++){let i=e.getChildren()[t];void 0!==i.options.multipleNodesRep?(a+=i.options.multipleNodesRep,i.isExpanded()&&(r.push(i),s.push(a))):a++}this._updateMultipleNodesRep(e,i),this._insertBackFakeExpandedNodes(e,r,s),this._treeDocument._indexRowIndexes()},_removeNodesFromDataSourceRequest:function(e,t){return e&&t.length?this._modifyNodesFromDataSourceRequest(e,t,"remove"):{treatedNotificationsNodesNumber:0}},_preRemoveNode:function(e,t){var i,o=this._getNodeInClientModel(e,t);if(t<(this._loadedUnloadedNodesMap.get(e)?this._loadedUnloadedNodesMap.get(e)[0]:0)){if(void 0!==o){var n=t;this.collectionView.model.length&&(n=this._getRealPositionInParentNode(e,t));var l=e.getChildren()[n];l&&(i=l)}i||(this._modifyLoadedUnloadedNodes(e,t,!1,void 0,this._loadedUnloadedNodesMap),this._modifyLoadedUnloadedNodes(e,t,!1,void 0,this._rowRequestManager),this._updateRealAndUnloadedDataAfterUnitOperation(e))}return i},_removeNode:function(e){if(!e)return;let t=e.getParent(),i=e._getLocalID();t&&t.removeChild(e),this._modifyLoadedUnloadedNodes(t,i,!1,void 0,this._loadedUnloadedNodesMap),this._modifyLoadedUnloadedNodes(t,i,!1,void 0,this._rowRequestManager),this._updateRealAndUnloadedDataAfterUnitOperation(t)},_removeNodeAtLocation:function(e,t){var i,o=this._getNodeInClientModel(e,t);if(t<(this._loadedUnloadedNodesMap.get(e)?this._loadedUnloadedNodesMap.get(e)[0]:0)){if(void 0!==o){var n=t;this.collectionView.model.length&&(n=this._getRealPositionInParentNode(e,t));var l=e.getChildren()[n];l&&(l.isVisible()&&(i=l._getRowID()),e.removeChild(l))}this._modifyLoadedUnloadedNodes(e,t,!1,void 0,this._loadedUnloadedNodesMap),this._modifyLoadedUnloadedNodes(e,t,!1,void 0,this._rowRequestManager),this._updateRealAndUnloadedDataAfterUnitOperation(e)}return i},_changeNodesFromDataSourceRequest:function(e){let t=e.nodesNumber,i=e.nodesPath,o=e.childrenOrder,n=e.nodesLocationsArrayAfterChange;if(!t||!i.length&&!o)return{treatedNotificationsNodesNumber:0};if(e.modifications){let t={},o=this._getNodeLocationData(i).node;if(o){for(const i of Object.keys(e.modifications)){if("wux_group"===i)if(e.modifications[i])o.getChildren()||o.setHasAsyncChildren(!0);else{let e=o.getChildren();e&&e.length||o.setHasAsyncChildren(!1)}else{if("isExpanded"===i){!0!==e.modifications[i]||o.isExpanded()?!1===e.modifications[i]&&o.isExpanded()&&o.collapse():o.expand();continue}"tree"===i?t.label=e.modifications[i]:"icons"===i&&(t[i]=e.modifications[i])}t.grid||(t.grid={}),t.grid[i]=e.modifications[i]}o.updateOptions(t),this.dataSource.onNodeModelUpdate(o,t.grid,!1)}return[]}if(o){let e=this._getNodeLocationData(i).node;if(!e)return{treatedNotificationsNodesNumber:0};let t=0;return e.withTransactionUpdate((()=>{let i=e.getChildren(),n=this._loadedUnloadedNodesMap.get(e),l=n&&n.length?n[0]:0;if(!l||l!==o.length)return;let r=[],s=!1;r.length=l;for(let e=0;e<i.length;++e){let t=i[e];if(!t.stringIdentifier||void 0!==t.options.multipleNodesRep)continue;let n=o.indexOf(t.stringIdentifier);if(-1!==n){if(r[n]&&window.console.error("At least 2 children share the same stringIdentifier"),r[n]=t,i.length===l&&n===e)continue;s=!0}else window.console.error("A node with an id is not in the new nodes order")}if(s){i.length=0,this._loadedUnloadedNodesMap.delete(e),this._rowRequestManager.delete(e);for(let t=e.stringIdentifier?this._requestToDo.length-1:-1;t>=0;--t){this._requestToDo[t].parentNode.stringIdentifier===e.stringIdentifier&&(this._requestToDo.splice(t,1),this._parentNodesArray.splice(t,1))}for(let t=0;t<l;++t){let o=r[t];o?(i.push(o),this._modifyLoadedUnloadedNodes(e,t,!0,!0,this._loadedUnloadedNodesMap),this._modifyLoadedUnloadedNodes(e,t,!0,!0,this._rowRequestManager)):this._addNodeToParentAtPosition(e,t)}return this._treeDocument._indexRowIndexes(),t=l,{updateType:WUXModelUpdateTypes.Sorting}}})),{treatedNotificationsNodesNumber:t}}return this._modifyNodesFromDataSourceRequest(t,i,"change",n)},_getCollectionViewModelDisplayedLength:function(){if(!this.collectionView.model||!Array.isArray(this.collectionView.model))return 0;if(!1===this.collectionView.virtuallyLoadAllModelItems)return this.collectionView.model.length;var e=0;this.collectionView.model.forEach((function(t){t&&(void 0!==t.options.multipleNodesRep?e+=t.options.multipleNodesRep:t.isHidden()||(e+=1))}));let t=this._getCurrentPaginationOptions();return t&&t.pageSize<e?t.pageSize:e},_getNodeModelAtRowID:function(e){if(this.collectionView.model&&Array.isArray(this.collectionView.model))return!1===this.virtuallyLoadAllModelItems?this.collectionView.model[e]:this._viewRowIDNodeModelMapping?this._viewRowIDNodeModelMapping.get(e):void 0},_createNodeModelFromData:function(e,t){let i;return i=this._treeDocument.createModelNode?this._treeDocument.createModelNode({label:e.tree,icons:e.icons,nodeType:e.nodeType,grid:e,children:e.wux_group?[]:void 0}):new t({label:e.tree,icons:e.icons,grid:e,children:e.wux_group?[]:void 0}),void 0!==e.stringIdentifier&&(i.stringIdentifier=e.stringIdentifier),e.dragTransferData&&(i.dragTransferData=e.dragTransferData),i},_createNodeModelsFromStructure:function(e,t){let i=t.numberOfChildren;void 0===i&&(i=0);let o,n=!!e._isTrueRoot()||t.isExpanded;if(i>0){this._updateLoadedUnloadedData(e,i,0,0,this._loadedUnloadedNodesMap);let o=t.children;o&&n||(o=[]);let l=0==o.length?i:0;for(let t=0;t<o.length;t++){let i=o[t];if(i)if(i.wux_group){l>0&&(this.__createFakeNode(e,{stringIdentifier:void 0,wux_group:!1},l),l=0);let t=this.__createFakeNode(e,i,1);this._createNodeModelsFromStructure(t,i)}else{l+=i.nodeRepCount&&!isNaN(i.nodeRepCount)?i.nodeRepCount:1}}l>0&&this.__createFakeNode(e,{stringIdentifier:void 0,wux_group:!1},l,n)}else o="noChildren";e.preExpandDone({state:o})},__createFakeNode:function(e,t,i,o){void 0===o&&(o=!0);let n=r(this);const l="DefaultObject";let s;return s=this._treeDocument.createModelNode?this._treeDocument.createModelNode({label:(t.stringIdentifier,""),children:t.wux_group?[]:void 0,nodeType:l}):new n({label:(t.stringIdentifier,""),children:t.wux_group?[]:void 0,nodeType:l}),s.options.multipleNodesRep=i,s.stringIdentifier=t.stringIdentifier,e.addChild(s),o&&e.setState({state:"expanded"}),s},_requestModelStructure:function(e,t,i){if(void 0!==i&&(this._lastModelStructureRequestCounter=i),this.dataSource.hasModelStructureRequest()){if(!this.virtuallyLoadAllModelItems)throw'Error : getModelStructure function cannot be launched on a Server side model if "virtuallyLoadAllModelItems" of collectionView is not applied.';let n=this.collectionView,r=function(e){let t=e.parentNode,i=e.rowModel,o=e.rowModel.collectionView,n=e.currentCounter;return{successCallback:function(e){n&&n<i._lastModelStructureRequestCounter||(o.prepareUpdateView(),i.prepareUpdate(),i._createNodeModelsFromStructure(t,e),i.pushUpdate(),o.pushUpdateView(),!0===i._modalLoaderDisplayed&&(o.removeModalLoader(l.get("ServerSide_Loading")),i._modalLoaderDisplayed=!1),o.model&&0===o.model.length?o._displayEmptyContentMessage():o._removeEmptyContentMessage(),i._readyForGroupedRequests=!0)},failCallback:function(e){!0===i._modalLoaderDisplayed&&(o.removeModalLoader(l.get("ServerSide_Loading")),i._modalLoaderDisplayed=!1),e&&console.warn(e)}}}({rowModel:this,parentNode:e,currentCounter:i});var o={groupKeys:e?e.buildStringIdentifierArray():[],expandNLevels:t,sortModel:this.sortModel,rowGrouping:this._getGroupingOptions(),filterModel:this.getFilterManager()?this.getFilterManager().filterModel:void 0};return 0!==n.model.length||this._modalLoaderDisplayed||(n.displayModalLoader(l.get("ServerSide_Loading")),this._modalLoaderDisplayed=!0),this.dataSource.getModelStructure({request:o,successCallback:r.successCallback,failCallback:r.failCallback}),!0}return this._loadRows(e,i)}})}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/CollectionView",["require","exports","UWA/Core","DS/CoreEvents/ModelEvents","DS/Core/PointerEvents","DS/Controls/Scroller","DS/Utilities/Dom","DS/Utilities/Utils","UWA/Utils/Client","DS/Utilities/RAFDispatcher","DS/Utilities/ReusableContentsManager","DS/Controls/Abstract","DS/CollectionView/layouts/CollectionViewGridLayout","DS/CollectionView/CollectionViewCell","DS/CollectionView/commands/CollectionViewCommands","DS/CollectionView/CollectionViewStatusBar","DS/Selection/XSO","DS/Utilities/DeviceUtils","DS/Controls/ModalContainer","DS/Controls/ModalLoader","DS/Core/WebUXComponents","DS/CollectionView/ModelBase","DS/CollectionView/ItemModelServerSide","DS/TreeModel/TreeDocument","DS/Tweakers/TypeRepresentationFactory","./typings/types","DS/Tweakers/typings/types"],(function(e,t,i,o,n,l,r,s,a,d,c,u,h,p,g,f,m,_,v,y,C,w,S,b,M){"use strict";var D=new M,V=a.Engine,I=!0,R=Object.freeze({toggle:!1,unselectAllOnEmptyArea:!0,unselectAllOnEscapeKey:!1,selectNodeModelOnCellSelection:!0,selectOnContextualEvent:!0,selectOnPointerUp:!1,showMixedStateOnParents:!1});function A(e,t){var i={},o={};for(var n in t)e[n]!==t[n]&&(i[n]=t[n]);for(var l in e)void 0===t[l]&&(o[l]=t[l]);return{toAdd:i,toRemove:o}}var P=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var o=e.apply(this,t)||this;return o.getColumnsToProcessForFind=void 0,o._tweakerToGenerateCount=0,o}return __extends(t,e),t.prototype._updateAllPoolSelectedViews=function(){},t.prototype.setActiveNode=function(e,t){},t.prototype._addModelEvents=function(){},t.prototype.getTypeRepresentationFactory=function(){return D},t.prototype.getCellSemantics=function(e){return this._getCellSemantics(e)},t.prototype._getCellSemantics=function(e){},t.prototype._computeTweakerOptions=function(e,t){return{touchMode:this._getCurrentTouchMode(),readOnly:!this.isCellInEdition(e.cellID),semantics:{showReferenceValueFlag:this.showModelChangesFlag,allowUnsafeHTMLContent:!1,referenceValue:t}}},Object.defineProperty(t,"publishedProperties",{get:function(){return{model:{defaultValue:[],type:"array"},dataSource:{defaultValue:null,type:"object"},nodeModelClass:{defaultValue:void 0,type:"function",noNeedToApplyFlag:!0},documentClassForServerSide:{defaultValue:b,type:"function",noNeedToApplyFlag:!0},cellClass:{defaultValue:p,type:"object"},layout:{defaultValue:void 0,type:"object"},height:{defaultValue:"inherit",type:"integer"},width:{defaultValue:void 0,type:"integer"},showScrollbarsOnHover:{defaultValue:!1,type:"boolean"},rowSelection:{defaultValue:"multiple",type:"string"},cellPreselectionFeedback:{defaultValue:"cell",type:"string"},cellSelection:{defaultValue:"none",type:"string"},selectionBehavior:{defaultValue:void 0,type:"object",advancedSetter:!0},onDelayedModelDataRequest:{defaultValue:null,type:"function"},pageScrollValueTriggeringInfiniteScroll:{defaultValue:void 0,type:"object"},showBackgroundFlag:{defaultValue:!0,type:"boolean"},editOnKeyPressFlag:{defaultValue:!0,type:"boolean"},paginationManager:{defaultValue:void 0,type:"object"},getScrollbarWidth:{defaultValue:function(e){return s.getScrollbarWidth(e)},type:"function"},findNavigationMode:{defaultValue:"substring",type:"string"},showRowBorderFlag:{defaultValue:!1,type:"boolean"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{virtuallyLoadAllModelItems:{defaultValue:!1,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){this._uuid=i.Utils.getUUID(),this._properties.selectionBehavior.value=Object.assign({},R),this._isInitialized=!1,this._reusableCellContentManager=new c,this._cellPool=new c,this._listOfRenderedCells=new Map,this._updateCounter=0,this._updateNeeded=!1,this._visibleCellsInViewport={},this._rightContainerWidth=0,this._modelEvents=new o,t&&void 0!==t.layout||void 0!==this._properties.layout.value||(this._properties.layout.value=new h),this._manageKeyboard(),e.prototype._preBuildView.call(this,t)},t.prototype.buildView=function(){e.prototype.buildView.call(this),this._buildLayout(),this.elements.container.setAttribute("tabindex","0")},t.prototype._handleEvents=function(){e.prototype._handleEvents.call(this),this._manageSelection()},t.prototype._applyIdentifier=function(e){this.identifier&&this.getContent().setAttribute("wux-identifier",this.identifier)},t.prototype.getUUID=function(){return this._uuid},t.prototype.supportsKeyboardNavigation=function(){return!1},t.prototype.supportsSelection=function(){return!1},t.prototype.supportsLightRendering=function(){return!1},t.prototype.supportsCustomScrolling=function(){return!1},t.prototype.getXSOElementID=function(e){return e},t.prototype._getXSOElementFromCellID=function(e){return e},t.prototype.getCellIDFromXSOElement=function(e){return e},t.prototype.isCellSelected=function(e){var t=!1,i=this.cellSelection;if("single"!==i&&"multiple"!==i||(t=this._XSO&&this._XSO.isIn(this._getXSOElementFromCellID(e))),!t){var o=this.rowSelection;if("single"===o||"multiple"===o){var n=this.getNodeModelAt(e);if(n)if(n.isSelected)t=n.isSelected();else{var l=this.getNodesXSO();l&&(t=l.isIn(n))}}}return t},t.prototype.isCellPreselected=function(e){return this.getPreselectedCellID()===e},t.prototype.isCellHighlighted=function(e){return!(!e.nodeModel||!e.nodeModel.isHighlighted)&&e.nodeModel.isHighlighted()},t.prototype.isCellInFindResults=function(e){return!!this._matchingCellIDsArray&&this._matchingCellIDsArray.includes(e.cellID)},t.prototype.isCellActive=function(e){return this.getActiveCellID()===e},t.prototype._hasSelectedDescendants=function(e){var t=this.getNodeModelAt(e);return Boolean(t&&t._nbSelectedDescendants>0)},t.prototype.setActiveCell=function(e,t,i){var o=!1,n=this.getActiveCellID();if(n!==e){var l;if(n>=0)(l=this.getEditionManager(n))&&(r.pushUserInteractionContext(),l.onCellUnactivate(n),r.popUserInteractionContext());if(this.getCellActivableState(e)||(e=-1),this._activeCellStableID=this._getXSOElementFromCellID(e),n>=0&&this._updateRenderedActiveCell(n),e>=0)(l=this.getEditionManager(e))&&!i&&l.onCellActivate(e),this._updateRenderedActiveCell(e),!1!==t&&(o=this.ensureCellVisible(e));this.elements.statusBar&&this.elements.statusBar.updateActiveCellID(e),this.fire("activeCellChange")}return this._setLastRangeCell(e,t),o},t.prototype.getCellEditableState=function(e){return!1},t.prototype.getCellActivableState=function(e){return!0},t.prototype.getEditionManager=function(e){return null},t.prototype._addCellInEdition=function(e){this._cellInEdition||(this._cellInEdition={}),this._cellInEdition[e]=!0},t.prototype._removeCellInEdition=function(e){this._cellInEdition&&delete this._cellInEdition[e]},t.prototype.isCellInEdition=function(e){if(!this.getCellEditableState(e))return!1;if(this._cellInEdition&&this._cellInEdition[e])return!0;var t=this.getEditionManager(e);return!!t&&t.isCellAlwaysInEdition(e)},t.prototype._setEditionMode=function(e,t){if(this.isCellInEdition(e)===t||t&&!this.getCellEditableState(e))return!1;if(!t){var i=this.getEditionManager(e);if(!i||i.isCellAlwaysInEdition(e))return!1}var o=this._getViewAt(e);return o&&o._reusableContent&&(t?(this._addCellInEdition(e),o._reusableContent.getContent&&o._reusableContent.getContent()&&o._reusableContent.getContent().setAttribute("tabindex",-1)):(this._removeCellInEdition(e),o._reusableContent.getContent&&o._reusableContent.getContent()&&o._reusableContent.getContent().removeAttribute("tabindex"),document.activeElement&&r.isActiveElementInContainer(o.getContent(),{lookInPopup:!0})&&document.activeElement.blur()),void 0!==o._reusableContent.readOnly&&o._reusableContent.readOnly===!t||(void 0!==o._reusableContent.readOnly&&(o._reusableContent.readOnly=!t),this._onEditionModeChanged(e,t),this.updateCellView(e,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0}))),!0},t.prototype._onEditionModeChanged=function(e,t){},t.prototype.setFocusOnCellContentFlag=function(e){e?(this._focusActiveCellContent(),this._focusOnCellMode=!0):this._focusOnCellMode&&(this.getContent().focus({preventScroll:!0}),this._focusOnCellMode=!1)},t.prototype.getFocusOnCellContentFlag=function(){return this._focusOnCellMode},t.prototype._focusActiveCellContent=function(){var e=this._getViewAt(this.getActiveCellID());if(e&&e._reusableContent&&e._reusableContent.focus){e._reusableContent.focus({preventScroll:!0});var t=e._reusableContent.getContent?e._reusableContent.getContent():e._reusableContent;r.isActiveElementInContainer(t,{lookInPopup:!0})||this.getContent().focus({preventScroll:!0})}else this.getContent().focus({preventScroll:!0})},t.prototype.getActiveCellID=function(){return this.getCellIDFromXSOElement(this._activeCellStableID)},t.prototype._setLastRangeCell=function(e,t){this._lastRangeCellID!==e&&(this._lastRangeCellID=e,!1!==t&&this.ensureCellVisible(e))},t.prototype._getLastRangeCellID=function(){return this._lastRangeCellID},t.prototype.computeCellIDFromActiveCell=function(e,t,i){return-1},t.prototype._applyRowSelection=function(e){this.getContent().setAttribute("row-selection",this.rowSelection),this.unselectAll(),this._isReady&&this._renderViewport({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})},t.prototype.getUsedCellPreselectionFeedback=function(){if(void 0===this._usedCellPreselectionFeedback){var e=this.cellPreselectionFeedback;if("cell"===e){var t=this.cellSelection;"single"!==t&&"multiple"!==t&&(e="row")}this._usedCellPreselectionFeedback=e}return this._usedCellPreselectionFeedback},t.prototype._applyCellPreselectionFeedback=function(e){this._usedCellPreselectionFeedback=void 0},t.prototype._applyCellSelection=function(e){this.getContent().setAttribute("cell-selection",this.cellSelection),this.unselectAll()},t.prototype.getNodesXSO=function(){var e=null,t=this.getTreeDocument();return t&&(e=t.getXSO()),e},t.prototype.getNodesPXSO=function(){var e=null,t=this.getTreeDocument();return t&&(e=t.getPXSO()),e},t.prototype.getCellsXSO=function(){return this._XSO},t.prototype.selectNodeModel=function(e,t,i){var o=this.model;if(e&&o&&o.length>0){var n=this.rowSelection;if("single"===n||"multiple"===n)if(i&&"multiple"===n){var l=this.getTreeDocument();if(l){var r=l.getXSO();if(r){var s=0,a=this.getActiveCellID();if(a>=0){var d=this.getNodeModelAt(a);d&&(s=d._getRowID())}var c=e._getRowID(),u=Math.min(s,c),h=Math.max(s,c);if(!t){var p=[];r.get().forEach((function(e){var t=e._getRowID();(t<u||t>h)&&p.push(e)})),p.length>0&&r.remove(p)}for(var g=[],f=u;f<=h;f++){var m=this.getNodeModelAtRowID(f);m&&!r.isIn(m)&&l.options.shouldBeSelected.call(l,m)&&g.push(m),l.options.shouldSelectDescendants.call(l,m)&&m.processDescendants({processNode:function(e){l.options.shouldBeSelected.call(l,e.nodeModel)&&g.push(e.nodeModel)}})}g.length>0&&r.add(g)}}}else t&&"multiple"===n?e.select(!1):e.select(!0)}},t.prototype.unselectNodeModel=function(e){e&&e.unselect()},t.prototype.selectCell=function(e,t,i,o){var n=this.rowSelection,l=this.cellSelection;if(!this.cellShouldBeSelected(e)||"single"!==n&&"multiple"!==n&&"single"!==l&&"multiple"!==l)this.setActiveCell(e,o);else{var r=this,s=this.layout;if(i?this._setLastRangeCell(e,o):this.setActiveCell(e,o),"single"===l||"multiple"===l){if(this._XSO)if(i&&"multiple"===l){var a=this.getActiveCellID(),d=s.computeCellRange(a,e);if(d){var c=[];this._XSO.get().forEach((function(t){s.isCellInRange(r.getCellIDFromXSOElement(t),a,e)||c.push(t)})),c.length>0&&this._XSO.remove(c);for(var u=this.getTreeDocument(),h=[],p=0;p<d.length;p++){var g=d[p];(f=this.getNodeModelAt(g))&&(!u||u&&u.options.shouldBeSelected.call(u,f))&&h.push(this._getXSOElementFromCellID(g))}this._XSO.add(h)}}else{u=this.getTreeDocument();(f=this.getNodeModelAt(e))&&(!u||u&&u.options.shouldBeSelected.call(u,f))?t&&"multiple"===l?this._XSO.add(this._getXSOElementFromCellID(e)):this._XSO.unique(this._getXSOElementFromCellID(e)):t||this._XSO.empty()}}else if(!1!==this.selectionBehavior.selectNodeModelOnCellSelection){var f;(f=this.getNodeModelAt(e))&&this.selectNodeModel(f,t,i)}}},t.prototype.unselectCell=function(e){var t=this.cellSelection;if("single"===t||"multiple"===t)this._XSO&&this._XSO.remove(this._getXSOElementFromCellID(e));else{var i=this.rowSelection;if("single"===i||"multiple"===i){var o=this.getNodeModelAt(e);o&&o.unselect()}}},t.prototype.selectAll=function(e){var t=this,i=this.rowSelection,o=this.cellSelection;if("multiple"===i||"multiple"===o){var n=this.getTreeDocument();if(n){var l=this.layout,r=[],s=[];void 0===e&&(e=!1),n.withTransactionUpdate((function(){return n.processDescendants({onlyVisibleNodes:e||t.__selectAllOnlyOnVisibleNodes,processNode:function(a){if(n.options.shouldBeSelected.call(n,a.nodeModel))if("multiple"===i)r.push(a.nodeModel);else if("multiple"===o){var d=l.getCellsFromNodeModel(a.nodeModel,e);if(d&&d.length>0)for(var c=0;c<d.length;c++)s.push(t._getXSOElementFromCellID(d[c]))}}}),"multiple"===i?(t.__selectAllOnlyOnVisibleNodes||n.getXSO().empty(),n.getXSO().add(r)):"multiple"===o&&t._XSO&&(t._XSO.empty(),t._XSO.add(s)),{updateType:window.WUXModelUpdateTypes.Selection}}))}}},t.prototype.selectAllVisibleNodes=function(){this.selectAll(!0)},t.prototype.unselectAll=function(){var e=this;if(this.__selectAllOnlyOnVisibleNodes){var t=this.layout,i=[],o=[];(n=this.getTreeDocument())&&(n.processDescendants({onlyVisibleNodes:!0,processNode:function(n){i.push(n.nodeModel);var l=t.getCellsFromNodeModel(n.nodeModel,!0);o.push.apply(o,Array.from(l,(function(t){return e._getXSOElementFromCellID(t)})))}}),n.getXSO().remove(i),this._XSO&&this._XSO.remove(o))}else{var n;this._XSO&&this._XSO.empty(),(n=this.getTreeDocument())&&n.unselectAll()}},t.prototype.isEveryVisibleNodeSelected=function(){var e=!1,t=this.getTreeDocument();if(t){var i=t.getXSO();if(i){var o=this.model;if(i.get().length){e=!0;for(var n=t.options.shouldBeSelected!==t.defaultOptions.shouldBeSelected,l=0;l<o.length;l++){var r=this.getNodeModelAtRowID(l);if((!n||t.options.shouldBeSelected.call(t,r))&&!i.isIn(r)){e=!1;break}}}}}return e},t.prototype.cellShouldBeSelected=function(e){return e>=0&&e<this.getModelLength()},t.prototype.setPreselectedCell=function(e){var t=this.getPreselectedCellID();if(t!==e){var i,o;if(this._preselectedCellStableID=void 0!==e?this._getXSOElementFromCellID(e):void 0,t>=0)(i=this.getNodeModelAt(t))&&i.unPreSelect&&i.unPreSelect(),this._updateRenderedCellAttributes(t),(o=this.getEditionManager(t))&&o.onCellEndPreselect(t);if(e>=0)(i=this.getNodeModelAt(e))&&i.preSelect&&i.preSelect(),this._updateRenderedCellAttributes(e),(o=this.getEditionManager(e))&&o.onCellPreselect(e);this.fire("preselectedCellChange")}},t.prototype.getPreselectedCellID=function(){return void 0!==this._preselectedCellStableID?this.getCellIDFromXSOElement(this._preselectedCellStableID):void 0},t.prototype._shouldHandleCopy=function(e){return!!this._useClipboardFlag&&!!this._isFocused()},t.prototype._shouldHandlePaste=function(e){return this._shouldHandleCopy(e)},t.prototype._manageSelection=function(){var e,t=this;this.supportsSelection()&&(this._XSO=new m({useUniqueID:!0,getElementID:this.getXSOElementID}),this._XSO.onPostAdd((function(e){e.forEach((function(e){var i=t.getCellIDFromXSOElement(e);t._updateRenderedCellAttributes(i)}))})),this._XSO.onPostRemove((function(e){e.forEach((function(e){var i=t.getCellIDFromXSOElement(e);t._updateRenderedCellAttributes(i)}))})),r.addEventOnElement(this,this,n.POINTERMOVE,(function(i,o){n.isTouchEvent(i)?(t._preventSelectionForTouchScroll=!0,clearTimeout(e),e=setTimeout((function(){t._preventSelectionForTouchScroll=!1}),2e3),t._preventPreSelectionForTouchMode=!0):t._preventPreSelectionForTouchMode=!1,o?o.cellView&&o.cellView.getReusableContent()&&o.cellView.getReusableContent().managePreselection&&o.cellView.getReusableContent().managePreselection(i)?t.setPreselectedCell(void 0):t.setPreselectedCell(o.cellID):t.setPreselectedCell(void 0)})),r.addEventOnElement(this,this,"mouseleave",(function(){t.setPreselectedCell(void 0)})),r.addEventOnElement(this,this,n.POINTERHIT,(function(e,i){if(2===e.multipleHitCount&&i){e.preventDefault();var o=t.getEditionManager(i.cellID);o&&o.onCellDoubleClick(i.cellID)}})),r.addEventOnElement(this,this.getContent(),"copy",(function(e){if(t._shouldHandleCopy(e)){var i=t._copyToPlainText();if(e&&e.clipboardData)e.clipboardData.setData("text/plain",i);else{var o=window.clipboardData;o&&o.setData("Text",i)}e.preventDefault(),t._hiddenInput&&(t._hiddenInput.destroy(),t._hiddenInput=null,t._oldActiveElement&&(t._oldActiveElement.focus({preventScroll:!0}),t._oldActiveElement=null))}})),r.addEventOnElement(this,this.getContent(),"paste",(function(e){if(t._shouldHandlePaste(e)){var i=null;if(e.clipboardData?i=e.clipboardData:(i=window.clipboardData)&&t._pasteFromPlainText(i.getData("Text")),i&&i.items)for(var o=0;o<i.items.length;o++){var n=i.items[o];if("text/plain"===n.type){n.getAsString((function(e){t._pasteFromPlainText(e)}));break}}e.preventDefault(),t._hiddenInput&&(t._hiddenInput.destroy(),t._hiddenInput=null,t._oldActiveElement&&(t._oldActiveElement.focus({preventScroll:!0}),t._oldActiveElement=null))}})))},t.prototype.onCopyDefault=function(){if(!this._useClipboardFlag){var e=this.getTreeDocument?this.getTreeDocument():void 0;return e&&e.getXSO()&&this._modelEvents.publish({event:"copy",data:e.getXSO().get()}),{preventDefault:!0}}this._activateHiddenInput()},t.prototype.onCopy=function(){this.onCopyDefault()},t.prototype.onPasteDefault=function(){if(!this._useClipboardFlag){var e=this.getTreeDocument?this.getTreeDocument():void 0;return e&&e.getXSO()&&this._modelEvents.publish({event:"paste",data:e.getXSO().get()}),{preventDefault:!0}}this._activateHiddenInput()},t.prototype.onPaste=function(){this.onPasteDefault()},t.prototype.onCutDefault=function(){if(!this._useClipboardFlag){var e=this.getTreeDocument?this.getTreeDocument():void 0;return e&&e.getXSO()&&this._modelEvents.publish({event:"cut",data:e.getXSO().get()}),{preventDefault:!0}}},t.prototype.onCut=function(){this.onCutDefault()},t.prototype._activateHiddenInput=function(){this._hiddenInput||(this._hiddenInput=new i.Element("input",{styles:{width:"1px",height:"1px",top:"0px",left:"0px",position:"absolute",opacity:0}}),this._hiddenInput.setAttribute("type","text"),this._hiddenInput.inject(this.elements.container)),this._oldActiveElement=document.activeElement,this._hiddenInput.value=" ",this._hiddenInput.focus({preventScroll:!0}),this._hiddenInput.select()},t.prototype._copyToPlainText=function(){},t.prototype._pasteFromPlainText=function(e){},t.prototype._manageKeyboard=function(){if(this.supportsKeyboardNavigation()){this.keymaps={"ctrl+c":"copy","ctrl+v":"paste","ctrl+x":"cut",del:"deleteKeyPressed","ctrl+a":"selectAll",esc:{keydown:"escape"},"shift+return":"shiftEnter",return:"enter","ctrl+space":"ctrlSpaceKeyPressed",up:"upMove",right:"rightMove",down:"downMove",left:"leftMove","ctrl+up":"ctrlUp","ctrl+right":"ctrlRight","ctrl+down":"ctrlDown","ctrl+left":"ctrlLeft","shift+up":"shiftUp","shift+right":"shiftRight","shift+down":"shiftDown","shift+left":"shiftLeft","ctrl+shift+up":"shiftUp","ctrl+shift+right":"shiftRight","ctrl+shift+down":"shiftDown","ctrl+shift+left":"shiftLeft","shift+ctrl+up":"shiftUp","shift+ctrl+right":"shiftRight","shift+ctrl+down":"shiftDown","shift+ctrl+left":"shiftLeft",tab:"tab","shift+tab":"shiftTab",pageup:"pageup",pagedown:"pagedown","shift+pageup":"shiftPageup","shift+pagedown":"shiftPagedown",home:"home",end:"end","ctrl+home":"ctrlHome","ctrl+end":"ctrlEnd","shift+home":"shiftHome","shift+end":"shiftEnd",f2:"f2","+":"plus","-":"minus","*":"asterisk","/":"slash",defaultKey:"defaultKeyEventCallback"},this.commands=g}},t.prototype._onPlusKeyPressed=function(e){var t=this.getActiveCellID();if(t){var i=this.getNodeModelAt(t);i&&i.canBeExpanded()&&(i.isExpanded()||i.expand(),e.actionPerformed=!0)}},t.prototype._onMinusKeyPressed=function(e){var t=this.getActiveCellID();if(t){var i=this.getNodeModelAt(t);i&&i.canBeExpanded()&&(i.isExpanded()&&i.collapse(),e.actionPerformed=!0)}},t.prototype._onAsteriskKeyPressed=function(e){var t=this.getActiveCellID();if(t){var i=this.getNodeModelAt(t);i&&i.canBeExpanded()&&(i.expandAll(),e.actionPerformed=!0)}},t.prototype._onSlashKeyPressed=function(e){var t=this.getActiveCellID();if(t){var i=this.getNodeModelAt(t);i&&i.canBeExpanded()&&(i.collapseAll(),e.actionPerformed=!0)}},t.prototype._registerPool=function(e,t,i){var o=this;this._cellPool.register({id:e,buildContent:function(){var n=new i({collectionView:o,cellType:e});return n.getContent().setAttribute("is-visible",!1),t&&n.getContent().inject(t),n},cleanContent:function(e){e.clean&&e.clean()}})},t.prototype._registerPools=function(){var e=this.cellClass;this._registerPool("__item__",this.elements.poolContainer,e),this._registerPool("__sync_item__",this.elements.poolContainerSyncRel,e),this._registerPool("__top_item__",this.elements.headerPoolContainer,e)},t.prototype.initialize=function(){this.paginationManager&&this.paginationManager.updatePagination(),this.dataSource&&this._applyDataSource()},t.prototype.__forceOnReadyForIOS=function(){var e=this;_.isMobileiOS()&&setTimeout((function(){e._onNodeRendered_IOS_Interval=window.setInterval((function(){if(e._isReady)return e._onNodeRendered_IOS_Interval&&window.clearInterval(e._onNodeRendered_IOS_Interval),void delete e._onNodeRendered_IOS_Interval;e._getScroller().getContent()&&(e._getScroller().getContent().style.display="none",e._getScroller().getContent().offsetHeight,e._getScroller().getContent().style.display="")}),200)}),500)},t.prototype._postBuildView=function(){var e=this;this._registerPools(),this.layout.collectionView=this,this.layout.preferencesToApply&&this.layout.importJsonPreferences(this.layout.preferencesToApply,{importCurrentCustomViewId:!0}),this._renderViewportOptions={},this._isReady=!1,this.__forceOnReadyForIOS(),r.onNodeRendered(this._getScroller().getContent(),(function(){if(e._isReady)e._updateDimensions(),e.getAllScrollers().forEach((function(t){t&&(t._updatePosition(),e._onScrollBegin(t),e._onScroll(t),e._onScrollEnd(t))})),e.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1,updateCellWidth:!0});else{e._isReady=!0,e._updateDimensions(),e.initialize(),e._initialize();var t=s.debounce((function(t){e.requestDelayedModelData(t)}),1);r.addEndResizeListener(e.elements.container,(function(){e._onEndResizeListener()}),200),r.addResizeListener(e._getScroller().elements.container,(function(){e.getAllScrollers().forEach((function(e){e&&e._updatePosition()})),e._updateDimensions(),e.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1}),e._onEndResizeOrOnReadyModelCompletionRequest("OnEndResize"),t("OnResize"),e._modelEvents.publish({event:"ENDRESIZE",context:e})}),100),e._applyVirtualViewportSize(),e._updateDimensions(),e.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!0,updateCellWidth:!0}),e._onEndResizeOrOnReadyModelCompletionRequest("OnReady"),e.requestDelayedModelData("OnReady"),e._isInitialized=!0,e._onPrivateReady(),e._modelEvents.publish({event:"READY",context:e})}}))},t.prototype.getAllScrollers=function(){var e=[];return this.hasLeftContainer()&&e.push(this.elements.leftScroller),e.push(this.elements.scroller),this.hasRightContainer()&&e.push(this.elements.rightScroller),e},t.prototype.onReady=function(e){if(!this._isReady)return this._modelEvents.subscribe({event:"READY"},e);e()},t.prototype._onEndResizeListener=function(){this._updateDimensions(),this.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})},t.prototype.getCellInfosFromHtmlElement=function(e){var t=r.firstParentWithClass(e,"wux-layouts-collectionview-cell");if(t){var i=parseInt(t.getAttribute("cell-id"),10),o=this.getCellInfosAt(i);return o.cellView=this._getViewAt(i),o.manager=this,o}},t.prototype.addEventListener=function(e,t,i){var o=this,n=function(e){if(!o._isRequestingCell){e.dsModel=o;var i=r.firstParentWithClass(e.target,"wux-layouts-collectionview-cell");if(i){var n=parseInt(i.getAttribute("cell-id"),10);if(!isNaN(n)){var l=o.getCellInfosAt(n);l.cellView=o._getViewAt(n),t(e,l)}}else t(e)}};return this.getContent().addEventListener(e,n,i),n},t.prototype._onEndResizeOrOnReadyModelCompletionRequest=function(e){var t=this;this._onEndResizeOrOnReadyModelRequestCB&&(this._isRequestingEndResizeOrOnReadyModelUpdate||(this._isRequestingEndResizeOrOnReadyModelUpdate=!0,setTimeout((function(){t._modelEvents.subscribeOnce({event:"endResizeOrOnReadyModelRequestDone"},(function(){t.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}),t._isRequestingEndResizeOrOnReadyModelUpdate=!1}));var i=t.getViewportDimensions(),o=Math.floor((i.width-t.layout.gutter)/(t.layout._getColumnWidth()+t.layout.gutter)),n=Math.ceil((i.height-t.layout.gutter)/(t.layout.getRowHeight()+t.layout.gutter));t._onEndResizeOrOnReadyModelRequestCB({model:t.model,RowMaxNumber:n,ColumnsMaxNumber:o,viewportDimensions:i,event:e})}),1)))},t.prototype._onEndResize=function(e){return this._modelEvents.subscribe({event:"ENDRESIZE"},e)},t.prototype.getCellIDAsString=function(e){return String(e)},t.prototype.getStatusBarContainerHeight=function(){return this.elements.statusBar?0===this.elements.statusBar.items.getRoots().length?0:this._getCurrentTouchMode()?41:27:0},t.prototype.buildStatusBar=function(e){var t=this.elements.statusBar;if(!t&&e.length>0&&((t=new f({collectionView:this})).inject(this.getContent()),this.elements.statusBar=t),t){var i=t.items.getRoots().length;t.setModel(e),(0===i&&e.length>0||i>0&&0===e.length)&&this.invalidateLayout({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!1})}},t.prototype._applyHeight=function(e){this.elements.container.style.height="inherit"===this.height?"":this.height+"px";var t={};"inherit"===this.height?(t={position:"absolute",top:0,left:0,bottom:0},this.width||(t.width="100%")):(t={position:"",top:"",left:"",bottom:""},this.width||(t.width="")),this.elements.container.setStyles(t),this.fire("dimensionsChanged")},t.prototype._applyWidth=function(e){this.elements.container.style.width=void 0===this.width?"100%":this.width+"px",this.fire("dimensionsChanged")},t.prototype._buildLayout=function(){this.elements.container.addClassName("wux-layouts-collectionview"),r.setStyles(this.elements.container,{overflow:"hidden",width:"100%",position:"relative",height:"inherit"===this.height?"":this.height}),this.elements.container.setAttribute("platform-name",a.Platform.name),"inherit"===this.height&&r.setStyles(this.elements.container,{position:"absolute",top:0,left:0,bottom:0,width:"100%"}),this.elements.header=new i.Element("div",{class:"wux-layouts-header"}).inject(this.elements.container),this.elements.headerScrollContainer=new i.Element("div",{class:"wux-layouts-header-scroller-container"}).inject(this.elements.header),this.elements.headerPoolContainer=new i.Element("div",{class:"wux-layouts-header-poolcontainer"}).inject(this.elements.headerScrollContainer),this.elements.body=new i.Element("div",{class:"wux-layouts-body"}).inject(this.elements.container),this.elements.centerSpacerContainer=new i.Element("div",{class:"wux-layouts-center-spacer-container"}).inject(this.elements.body,"after"),this.elements.scrollContainerRel=new i.Element("div",{class:"wux-layouts-gridengine-scroller-container","show-at-hover":this.showScrollbarsOnHover}).inject(this.elements.body),this.elements.poolContainer=new i.Element("div",{class:"wux-layouts-gridengine-poolcontainer-rel"});var e={scrollEndTimeout:200,scrollDebounceTimeout:0,useRequestAnimationFrame:I};this.elements.scroller=new l(this.elements.poolContainer,e).inject(this.elements.scrollContainerRel),this.elements.scroller._id="center",this.elements.poolContainerSync=new i.Element("div",{class:"wux-layouts-gridengine-poolcontainer-sync"}),this.elements.poolContainerSyncRel=new i.Element("div",{class:"wux-layouts-gridengine-poolcontainer-sync-rel"}),this.elements.poolContainerSyncRel.inject(this.elements.poolContainerSync),this.elements.poolContainerSync.inject(this.elements.scrollContainerRel)},t.prototype._createLeftFixedContainer=function(){this.elements.leftHeaderScrollContainer=new i.Element("div",{class:"wux-layouts-left-header-scroller-container"}).inject(this.elements.headerScrollContainer,"before"),this.elements.leftHeaderPoolContainer=new i.Element("div",{class:"wux-layouts-left-header-poolcontainer"}).inject(this.elements.leftHeaderScrollContainer),this.elements.leftScrollContainer=new i.Element("div",{class:"wux-layouts-left-scroller-container"}).inject(this.elements.body,"before"),this.elements.leftSpacerContainer=new i.Element("div",{class:"wux-layouts-left-spacer-container"}).inject(this.elements.body,"before"),this.elements.leftPoolContainer=new i.Element("div",{class:"wux-layouts-left-poolcontainer"}).inject(this.elements.leftScrollContainer);var e={scrollEndTimeout:200,scrollDebounceTimeout:0,useRequestAnimationFrame:I};this.elements.leftScroller=new l(this.elements.leftPoolContainer,e).inject(this.elements.leftScrollContainer),this.elements.leftScroller._id="left",this._initializeScroller(this.elements.leftScroller),this._registerPool("__topleft_item__",this.elements.leftHeaderPoolContainer,this.cellClass),this._registerPool("__left_item__",this.elements.leftPoolContainer,this.cellClass)},t.prototype.hasLeftContainer=function(){return Boolean(this.elements.leftScroller)},t.prototype._createRightFixedContainer=function(){this.elements.rightHeaderScrollContainer=new i.Element("div",{class:"wux-layouts-right-header-scroller-container"}).inject(this.elements.header),this.elements.rightHeaderPoolContainer=new i.Element("div",{class:"wux-layouts-right-header-poolcontainer"}).inject(this.elements.rightHeaderScrollContainer),this.elements.rightScrollContainer=new i.Element("div",{class:"wux-layouts-right-scroller-container"}).inject(this.elements.container),this.elements.rightSpacerContainer=new i.Element("div",{class:"wux-layouts-right-spacer-container"}).inject(this.elements.container),this.elements.rightPoolContainer=new i.Element("div",{class:"wux-layouts-right-poolcontainer"});var e={scrollEndTimeout:200,scrollDebounceTimeout:0,useRequestAnimationFrame:I};this.elements.rightScroller=new l(this.elements.rightPoolContainer,e).inject(this.elements.rightScrollContainer),this.elements.rightScroller._id="right",this._initializeScroller(this.elements.rightScroller),this._registerPool("__topright_item__",this.elements.rightHeaderPoolContainer,this.cellClass),this._registerPool("__right_item__",this.elements.rightPoolContainer,this.cellClass)},t.prototype.hasRightContainer=function(){return Boolean(this.elements.rightScroller)},t.prototype._displayEmptyContentMessage=function(){if(!this.elements.poolContainerSync.querySelector(".wux-datagridview-emptycontentmessage")){var e=i.createElement("div",{class:"wux-datagridview-emptycontentmessage"}),t=i.createElement("div");void 0!==this.placeholder&&null!==this.placeholder||(this.placeholder=""),"string"==typeof this.placeholder?t.textContent=this.placeholder:(i.is(this.placeholder,"element")&&(this.placeholder=new i.extendElement(this.placeholder)),this.placeholder.inject(t)),t.inject(e),e.inject(this.elements.poolContainerSync)}},t.prototype._removeEmptyContentMessage=function(){var e=this.elements.poolContainerSync.querySelector(".wux-datagridview-emptycontentmessage");e&&e.parentElement&&e.parentElement.removeChild(e)},t.prototype._updateDimensions=function(){this.elements.container&&this._updateViewportDimensions()},t.prototype.getDimensions=function(e){return this._dimensions&&!e||this._updateDimensions(),this._dimensions},t.prototype._updateViewportDimensions=function(){var e=this.elements.scrollContainerRel.getDimensions();if(this._dimensions=this.getContent().getDimensions(),e.height>0)this._viewportDimensions=e;else{var t=this.layout;this._viewportDimensions=i.clone(this._dimensions),this._viewportDimensions.height-=this.layout.getHeaderContainerHeight();var o=Math.floor(t.getLeftContainerWidth()),n=Math.ceil(t.computeSideContainerWidth("left",o,this._leftScrollContainerBorderSize?this._leftScrollContainerBorderSize:0)),l=Math.floor(t.getRightContainerWidth()),r=t.computeSideContainerWidth("right",l,this._rightScrollContainerBorderSize?this._rightScrollContainerBorderSize:0),s=t.getContentDimensions();this._viewportDimensions.height<s.height&&r>0&&(this._scrollbarWidth||(this._scrollbarWidth=this.getScrollbarWidth()),r+=this._scrollbarWidth);var a=t.computeSideContainerMaxWidth("left",this._dimensions.width,n,r),d=t.computeSideContainerMaxWidth("right",this._dimensions.width,n,r),c=Math.min(n,a),u=Math.min(r,d),h=t.computeCenterContainerSideMargin("left",c,a),p=t.computeCenterContainerMinWidth(a,d,this._dimensions.width);this._viewportDimensions.width=Math.max(this._dimensions.width-h-u,p)}},t.prototype.getViewportDimensions=function(e){if(e){var t=this.layout.getContentDimensions();this._scrollbarWidth||(this._scrollbarWidth=this.getScrollbarWidth());var i=t.width>this._viewportDimensions.width?this._scrollbarWidth:0,o=t.height>this._viewportDimensions.height?this._scrollbarWidth:0;return{width:this._viewportDimensions.width-o,height:this._viewportDimensions.height-i}}return this._viewportDimensions||(this._viewportDimensions=this._getScroller().getContent().getDimensions()),this._viewportDimensions},t.prototype._getScroller=function(){return this.elements.scroller},t.prototype.getScrollerDeltaPosition=function(){return this.__cachedDeltaScrollPos},t.prototype.getScrollerPosition=function(e){var t=this._getScroller();if(t){var i=t.getPosition(e);return{x:i.x,y:i.y}}return{x:0,y:0}},t.prototype.setScrollerPosition=function(e,t,o){var n=this,l=o||this._getScroller(),r=o?o.elements.container:l.elements.container,s=o?o.getPosition():this.getScrollerPosition();if((e=i.extend({x:s.x,y:s.y,animate:!1},e)).animate){var a=function(e,t,i,o){return(e/=o/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},c=r.scrollLeft,u=e.x-c,h=r.scrollTop,p=e.y-h,g=Date.now(),f=function(){d.addTask({callback:function(){var i=Date.now()-g;r.scrollLeft=a(i,c,u,500),r.scrollTop=a(i,h,p,500),i<500?f():l.setPosition(e,void 0===t||t)},taskArgs:[]})};f()}else l.setPosition(e,void 0===t||t),V.firefox&&(this._scrollTimeout&&clearTimeout(this._scrollTimeout),this._scrollTimeout=setTimeout((function(){l._updatePosition();var e=n._activeScroller;e||n._onScrollBegin(l),n._onScroll(l),e||n._onScrollEnd(l),n._scrollTimeout=null}),100))},t.prototype._onScrollBegin=function(e){this._activeScroller||!this._synchronizedScrollers||this._synchronizedScrollers.includes(e)||(this._activeScroller=e,this._scrollDistanceFromBeginning=0),this._preventSelectionForTouchScroll=!0},t.prototype._onScroll=function(e){var t=this;if(this.isInitialized())if(this.elements.scroller&&this._activeScroller&&this._activeScroller===e){if(this.hasLeftContainer()&&e===this.elements.leftScroller){var o=this.elements.leftScroller.getPosition();this.elements.leftHeaderPoolContainer.setStyle("left",-o.x+"px")}if(this.hasRightContainer()&&e===this.elements.rightScroller){var n=this.elements.rightScroller.getPosition();this.elements.rightHeaderPoolContainer.setStyle("left",-n.x+"px")}var l=this._activeScroller.getPosition(),r={x:this.elements.scroller.getPosition().x,y:l.y};if(this.__cachedScrollDistance=Math.sqrt((r.x-this.__previousScrollPos.x)*(r.x-this.__previousScrollPos.x)+(r.y-this.__previousScrollPos.y)*(r.y-this.__previousScrollPos.y)),this._scrollDistanceFromBeginning+=this.__cachedScrollDistance,this.__cachedDeltaScrollPos={x:r.x-this.__previousScrollPos.x,y:r.y-this.__previousScrollPos.y},this.__previousScrollPos=r,0!==this.__cachedDeltaScrollPos.x||0!==this.__cachedDeltaScrollPos.y){if(this.getAllScrollers().forEach((function(i){e!==i&&i&&i.elements.container.scrollTop!==r.y&&(t._synchronizedScrollers&&!t._synchronizedScrollers.includes(i)&&t._synchronizedScrollers.push(i),i.setPosition({y:r.y},"immediate"))})),this.elements.headerPoolContainer.setStyle("left",-r.x+"px"),this._onInfiniteScrollCB&&(this.__cachedDeltaScrollPos.x>0||this.__cachedDeltaScrollPos.y>0)){var s=this.getViewportDimensions(),a=this.__cachedContentDimensions,d=a.height-s.height-2;d-this._infiniteScrollingVerticalDistance>0&&(d-=this._infiniteScrollingVerticalDistance);var c=a.width-s.width-2;c-this._infiniteScrollingHorizontalDistance>0&&(c-=this._infiniteScrollingHorizontalDistance);var u=!1,h=!1,p=!1,g=!1,f=this.pageScrollValueTriggeringInfiniteScroll;if(void 0!==f){if("number"==typeof f){if(f<=0||f>=1)throw new Error("You gave a wrong value for pageScrollValueTriggeringInfiniteScroll option. Please provide a value strictly between 0 and 1.");h=Math.abs(r.y)+f*s.height>=f*a.height,g=Math.abs(r.y)>=d&&d>0,u=Math.abs(r.x)>=c&&c>0}else if(i.is(f,"object")){if(void 0!==f.x){if(f.x<=0||f.x>=1)throw new Error("You gave a wrong value for pageScrollValueTriggeringInfiniteScroll.x publish property. Please provide a value strictly between 0 and 1.");u=Math.abs(r.x)+f.x*s.width>=f.x*a.width,p=Math.abs(r.x)>=c&&c>0}else u=Math.abs(r.x)>=c&&c>0;if(void 0!==f.y){if(f.y<=0||f.y>=1)throw new Error("You gave a wrong value for pageScrollValueTriggeringInfiniteScroll.y publish property. Please provide a value strictly between 0 and 1.");h=Math.abs(r.y)+f.y*s.height>=f.y*a.height,g=Math.abs(r.y)>=d&&d>0}else h=Math.abs(r.y)>=d&&d>0}}else u=Math.abs(r.x)>=c&&c>0,h=Math.abs(r.y)>=d&&d>0;(h||u)&&(this._isRequestingModelUpdate||(this._isRequestingModelUpdate=!0,setTimeout((function(){t._modelEvents.subscribeOnce({event:"infiniteScrollDone"},(function(){t.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1}),t._isRequestingModelUpdate=!1})),t._onInfiniteScrollCB({reachBottom:h,reachRight:u,isVeryCloseFromRight:p,isVeryCloseFromBottom:g})}),1)))}var m=!this.layout.isCellLayoutValidAt(0),_=this._renderViewport({updateCellContent:!1,updateCellLayout:m,updateCellAttributes:!1,allottedTime:80});_&&void 0!==_.taskInterrupted&&(this._renderingTaskInterrupted=_.taskInterrupted)}}else if(this._synchronizedScrollers){var v=this._synchronizedScrollers.indexOf(e);v>-1&&this._synchronizedScrollers.splice(v,1)}},t.prototype._onPrivateScrollEnd=function(){},t.prototype._onScrollEnd=function(e){if(this._activeScroller===e&&(this._activeScroller=null,!0===this._waitForScrollEndAfterLimitReached&&(this._waitForScrollEndAfterLimitReached=!1,this._scrollEndAfterLimitReachedOccurred=!0),this.requestDelayedModelData("OnScrollEnd"),this._onPrivateScrollEnd(),this._renderingTaskInterrupted&&!this._infoOnTouchDown)){var t=!this.layout.isCellLayoutValidAt(0);this._renderViewport({updateCellContent:!1,updateCellLayout:t,updateCellAttributes:!1}),this._renderingTaskInterrupted=!1}this._preventSelectionForTouchScroll=!1},t.prototype._hasUniformRowHeight=function(){return!1},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype._initialize=function(){this._isRendering(!1),this.__previousScrollPos={x:0,y:0},this.__cachedDeltaScrollPos={x:0,y:0},this.__cachedScrollDistance=0,this._renderingTaskInterrupted=!1,this._scrollDistanceFromBeginning=0,this._activeScroller=null,this._synchronizedScrollers=[],this._initializeScroller(this.elements.scroller)},t.prototype._initializeScroller=function(e){var t=this;if(this._initializedScrollers||(this._initializedScrollers=[]),!this._initializedScrollers.includes(e)){this._initializedScrollers.push(e),e.onScrollBegin((function(i){t._onScrollBegin(e)})),e.onScroll((function(i){t._onScroll(e)})),e.onScrollEnd((function(i){t._onScrollEnd(e)}));var i=function(i){t._activeScroller=e,t._synchronizedScrollers=[];var o=!1;if(!i.shiftKey&&!i.ctrlKey){var n=function(i){var n,l=-1*Math.max(-1,Math.min(1,i.wheelDelta||-i.detail));l=0===l?1:l/Math.abs(l);var r=0;if(t._hasUniformRowHeight()){var s=e.elements.container.scrollTop%t.layout.cellHeight;0===s||(r=t.layout.cellHeight-s)}var a=void 0;if(i.deltaMode&&1===i.deltaMode)a=Math.abs(i.deltaY);else{a=Math.round(Math.abs(i.deltaY)/33.33)}var d=Math.floor(t.getViewportDimensions().height/t.layout.cellHeight),c=Math.min(a,d);return n=l*(c*t.layout.cellHeight)+r,(o=n<0&&0===e.elements.container.scrollTop||n>0&&e.elements.container.scrollTop+n+t.getViewportDimensions().height>=e.getContent().getChildren()[0].offsetHeight)&&(n=l*((c||1)*t.layout.cellHeight)+r),n}(i);o?!0===t._scrollEndAfterLimitReachedOccurred?t._activeScroller=null:t._waitForScrollEndAfterLimitReached=!0:(i.preventDefault(),i.stopPropagation(),t._scrollEndAfterLimitReachedOccurred=!1),0!==n&&e.setPosition({y:e.elements.container.scrollTop+n},!0)}},o=void 0;switch(e._id){case"left":o=this.elements.leftPoolContainer;break;case"center":o=this.elements.poolContainer;break;case"right":o=this.elements.rightPoolContainer}if(r.addEventOnElement(this,o,"wheel",i),this.supportsCustomScrolling()){this.getContent().addClassName("supportsCustomScrolling");var n=function(o){if(t._scrollDirection=null,t._infoOnTouchDown=null,t._previousTouch=null,clearInterval(t._inertiaInterval),t._inertiaInterval=null,t._previousTouch||(t._previousTouch={}),o.touches.length<=1){var n=void 0;n=t.hasLeftContainer()&&o.currentTarget===t.elements.leftScrollContainer?t.elements.leftScroller.elements.container.scrollLeft:t.hasRightContainer()&&o.currentTarget===t.elements.rightScrollContainer?t.elements.rightScroller.elements.container.scrollLeft:t.elements.scroller.elements.container.scrollLeft,t._infoOnTouchDown={clientX:o.touches[0].clientX,clientY:o.touches[0].clientY,scrollLeft:n,scrollTop:e.elements.container.scrollTop,firstTarget:o.currentTarget},r.addEventOnElement(t,document,"touchmove",l,{passive:!1}),r.addEventOnElement(t,document,"touchend",a),r.addEventOnElement(t,document,"touchcancel",a),o.currentTarget!==t.elements.leftPoolContainer&&o.currentTarget!==t.elements.poolContainer&&o.currentTarget!==t.elements.rightPoolContainer||(t.hasLeftContainer()&&r.removeEventOnElement(t,t.elements.leftPoolContainer,"wheel",i),r.removeEventOnElement(t,t.elements.poolContainer,"wheel",i),t.hasRightContainer()&&r.removeEventOnElement(t,t.elements.rightPoolContainer,"wheel",i),t._touchStartELRemoved=!0),_.isMobileiOS()&&e.showScrollingFeedbacks()}},l=function(e){if(!t._preventScroll&&e.touches.length<=1&&!e.defaultPrevented&&(t._previousTouch||(t._previousTouch={}),t._infoOnTouchDown)){if(!t._scrollDirection)if(Math.abs(e.touches[0].clientY-t._infoOnTouchDown.clientY)>5)t._scrollDirection="y";else{if(!(Math.abs(e.touches[0].clientX-t._infoOnTouchDown.clientX)>5||e.firstTarget===t.elements.headerPoolContainer))return;t._scrollDirection="x"}e.preventDefault(),s("y"===t._scrollDirection?e.touches[0].clientY:e.touches[0].clientX)}},s=function(i){var o=(new Date).getTime();if(t._infoOnTouchDown){if("y"===t._scrollDirection&&t._infoOnTouchDown.firstTarget!==t.elements.headerPoolContainer){var n=t._infoOnTouchDown.scrollTop-(i-t._infoOnTouchDown.clientY);e.elements.container.scrollTop!==n&&(t._previousTouch.direction=e.elements.container.scrollTop<n,e.setPosition({y:n},!0)),t._previousTouch.timeStamp&&t._previousTouch.timeStamp!==o&&e.elements.container.scrollTop!==t._previousTouch.scroll&&(t._speed=(e.elements.container.scrollTop-t._previousTouch.scroll)/(o-t._previousTouch.timeStamp)),t._previousTouch.scroll=e.elements.container.scrollTop}else if("x"===t._scrollDirection){n=t._infoOnTouchDown.scrollLeft-(i-t._infoOnTouchDown.clientX);var l=null;t._infoOnTouchDown.firstTarget===e.getContent()||t._infoOnTouchDown.firstTarget===t.elements.headerPoolContainer?l=t.elements.scroller:t.hasLeftContainer()&&t._infoOnTouchDown.firstTarget===t.elements.leftScrollContainer?l=t.elements.leftScroller:t.hasRightContainer()&&t._infoOnTouchDown.firstTarget===t.elements.rightScrollContainer&&(l=t.elements.rightScroller),l&&(l.elements.container.scrollLeft!==n&&(t._previousTouch.direction=l.elements.container.scrollLeft<n,l.setPosition({x:n},!0)),t._previousTouch.timeStamp&&t._previousTouch.timeStamp!==o&&l.elements.container.scrollLeft!==t._previousTouch.scroll&&(t._speed=(l.elements.container.scrollLeft-t._previousTouch.scroll)/(o-t._previousTouch.timeStamp)),t._previousTouch.scroll=l.elements.container.scrollLeft)}t._previousTouch.client=i,t._previousTouch.timeStamp=o}},a=function(o){if(r.removeEventOnElement(t,document,"touchmove",l,{passive:!1}),r.removeEventOnElement(t,document,"touchend",a),r.removeEventOnElement(t,document,"touchcancel",a),t._touchStartELRemoved&&(t._touchStartELRemoved=void 0,t.hasLeftContainer()&&r.addEventOnElement(t,t.elements.leftPoolContainer,"wheel",i),r.addEventOnElement(t,t.elements.poolContainer,"wheel",i),t.hasRightContainer()&&r.addEventOnElement(t,t.elements.rightPoolContainer,"wheel",i)),Math.abs(t._speed)>=.5){var n=t._speed,d=t._previousTouch.client,c=(new Date).getTime(),u=t._previousTouch.timeStamp,h=Math.min(1e3*Math.abs(n)/2,1500),p=function(){var i=(new Date).getTime();if(i-c>=h){if(t._scrollDirection=null,t._infoOnTouchDown=null,t._previousTouch=null,clearInterval(t._inertiaInterval),t._inertiaInterval=null,t._speed=0,_.isMobileiOS()&&e.hideScrollingFeedbacks(),t._renderingTaskInterrupted){var o=!t.layout.isCellLayoutValidAt(0);t._renderViewport({updateCellContent:!1,updateCellLayout:o,updateCellAttributes:!1}),t._renderingTaskInterrupted=!1}}else{var l=d-(i-u)*n*(1-(i-c)/h);s(l),d=l,u=i}};t._inertiaInterval&&clearInterval(t._inertiaInterval),t._inertiaInterval=setInterval(p,5),p()}else if(t._scrollDirection=null,t._infoOnTouchDown=null,t._previousTouch=null,t._speed=0,_.isMobileiOS()&&e.hideScrollingFeedbacks(),t._renderingTaskInterrupted){var g=!t.layout.isCellLayoutValidAt(0);t._renderViewport({updateCellContent:!1,updateCellLayout:g,updateCellAttributes:!1}),t._renderingTaskInterrupted=!1}},d=void 0;switch(e._id){case"left":d=this.elements.leftScrollContainer;break;case"center":d=e.getContent();break;case"right":d=this.elements.rightScrollContainer}r.addEventOnElement(this,d,"touchstart",n),"center"===e._id&&r.addEventOnElement(this,this.elements.headerPoolContainer,"touchstart",n)}var c=this.layout;c&&c.scrollPaddingBottom>0&&(e.elements.container.style.paddingBottom=c.scrollPaddingBottom+"px")}},t.prototype._onPrivateReady=function(){},t.prototype.lockUI=function(){this._getScroller()&&this._getScroller().getContent().classList.add("wux-ui-locked")},t.prototype.unlockUI=function(){this._getScroller()&&this._getScroller().getContent().classList.remove("wux-ui-locked")},t.prototype.unsubscribe=function(e){this._modelEvents.unsubscribe(e)},t.prototype.onPostUpdateView=function(e){return this._modelEvents.subscribe({event:"UPDATE_VIEW_COMPLETED"},e)},t.prototype.onPostUpdateViewOnce=function(e){return this._modelEvents.subscribeOnce({event:"UPDATE_VIEW_COMPLETED"},e)},t.prototype.onLastPushUpdateView=function(e){return this._modelEvents.subscribe({event:"LAST_PUSH_UPDATE_VIEW"},e)},t.prototype.onLastPushUpdateViewOnce=function(e){return this._modelEvents.subscribeOnce({event:"LAST_PUSH_UPDATE_VIEW"},e)},t.prototype._freeUpCell=function(e,t){var i=this._getRenderedCellAt(e);if(i){switch(t){default:case 0:break;case 1:i.component.getContent().setAttribute("is-visible",!1);break;case 2:i.component.getContent().remove()}i.component.__disposable__.dispose(),this._listOfRenderedCells.delete(e)}},t.prototype._freeUpPool=function(e){var t=this;void 0===e&&(e=1),this._listOfRenderedCells.forEach((function(i,o){t._freeUpCell(o,e)})),this._listOfRenderedCells.clear()},t.prototype._applyVirtualViewportSize=function(){var e=this.layout;if(e.isValid()||e.prepareLayout(),this._dimensions){var t=s.getGlobalWindow(window),i=this._zoomRefValue!==t.innerWidth;if(i||this.hasLeftContainer()&&!this._leftScrollContainerBorderSize||this.hasRightContainer()&&!this._rightScrollContainerBorderSize||!this._scrollbarWidth){if(this._leftScrollContainerBorderSize=0,this.hasLeftContainer()){var o=window.getComputedStyle(this.elements.leftScrollContainer);o&&(this._leftScrollContainerBorderSize+=parseFloat(o.getPropertyValue("border-left-width").replace("px","")),this._leftScrollContainerBorderSize+=parseFloat(o.getPropertyValue("border-right-width").replace("px","")))}if(this._rightScrollContainerBorderSize=0,this.hasRightContainer()){var n=window.getComputedStyle(this.elements.rightScrollContainer);n&&(this._rightScrollContainerBorderSize+=parseFloat(n.getPropertyValue("border-left-width").replace("px","")),this._rightScrollContainerBorderSize+=parseFloat(n.getPropertyValue("border-right-width").replace("px","")))}this._scrollbarWidth&&!i||(this._scrollbarWidth=this.getScrollbarWidth(i))}var l=0,r=Math.floor(e.getLeftContainerWidth()),a=Math.ceil(e.computeSideContainerWidth("left",r,this._leftScrollContainerBorderSize)),d=Math.floor(e.getRightContainerWidth()),c=e.computeSideContainerWidth("right",d,this._rightScrollContainerBorderSize);this.hasLeftContainer()&&(0===r?(this.elements.leftScrollContainer.setAttribute("empty",""),this.elements.leftHeaderScrollContainer.setAttribute("empty",""),this.elements.leftSpacerContainer.setAttribute("empty","")):(this.elements.leftScrollContainer.removeAttribute("empty"),this.elements.leftHeaderScrollContainer.removeAttribute("empty",""),this.elements.leftSpacerContainer.removeAttribute("empty","")),l=e.computeSideContainerMaxWidth("left",this._dimensions.width,a,c));var u=0;if(this.hasRightContainer()&&(0===d?(this.elements.rightScrollContainer.setAttribute("empty",""),this.elements.rightHeaderScrollContainer.setAttribute("empty",""),this.elements.rightSpacerContainer.setAttribute("empty","")):(this.elements.rightScrollContainer.removeAttribute("empty"),this.elements.rightHeaderScrollContainer.removeAttribute("empty",""),this.elements.rightSpacerContainer.removeAttribute("empty","")),u=e.computeSideContainerMaxWidth("right",this._dimensions.width,a,c)),(l>0||u>0)&&(this._leftMaxWidth!==l||this._rightMaxWidth!==u)){var h=e.computeCenterContainerMinWidth(l,u,this._dimensions.width);this.elements.centerSpacerContainer.setStyle("min-width",h)}this.hasLeftContainer()&&l>=0&&this._leftMaxWidth!==l&&(this._leftMaxWidth=l,this.elements.leftHeaderScrollContainer.setStyle("max-width",l),this.elements.leftScrollContainer.setStyle("max-width",l),this.elements.leftSpacerContainer.setStyle("max-width",l)),this.hasRightContainer()&&u>=0&&this._rightMaxWidth!==u&&(this._rightMaxWidth=u,this.elements.rightHeaderScrollContainer.setStyle("max-width",u),this.elements.rightScrollContainer.setStyle("max-width",u),this.elements.rightSpacerContainer.setStyle("max-width",u));var p=this.getViewportDimensions(),g=e.getContentDimensions(),f=p.width<g.width,m=p.height<g.height;m?this.getContent().setAttribute("has-vertical-overflow",""):this.getContent().removeAttribute("has-vertical-overflow");var _=d,v=c;m&&v>0&&(_+=this._scrollbarWidth,v+=this._scrollbarWidth),v=Math.ceil(v);var y,C,w=m&&0===c;if(this._zoomRefValue!==t.innerWidth||!this.__cachedContentDimensions||this.__cachedContentDimensions.width!==g.width||this.__cachedContentDimensions.height!==g.height||this._leftContainerWidth!==a||this._rightContainerWidth!==v||this._hasCenterContainerHorizontalOverflow!==f){this.__cachedContentDimensions=g,this.elements.poolContainerSync.setStyle("bottom",f?this._scrollbarWidth+"px":"0px"),this.elements.poolContainerSync.setStyle("right",w?this._scrollbarWidth+"px":"0px");var S=g.width+"px";f?this.elements.poolContainer.setStyle("width",S):this.elements.poolContainer.setStyle("width","100%"),this.elements.poolContainerSyncRel.setStyle("width",S),this.elements.headerPoolContainer.setStyle("width",S);var b=g.height+"px";this.elements.poolContainer.setStyle("height",b),this.elements.poolContainerSyncRel.setStyle("height",b),this.hasLeftContainer()&&this.elements.leftPoolContainer.setStyle("height",b),this.hasRightContainer()&&this.elements.rightPoolContainer.setStyle("height",b);var M=Boolean(this.elements.scrollContainerRel.getAttribute("has-overflow-x"));this.elements.scrollContainerRel.setAttribute("has-overflow-x",Boolean(f)),f&&this.showScrollbarsOnHover?(this.elements.scrollContainerRel.setStyle("height","calc(100% + "+this._scrollbarWidth+"px)"),this.elements.scrollContainerRel.setStyle("margin-bottom","-"+this._scrollbarWidth+"px")):this.showScrollbarsOnHover&&!f&&M&&(this.elements.scrollContainerRel.setStyle("height","100%"),this.elements.scrollContainerRel.setStyle("margin-bottom","0px"));var D=Boolean(this.elements.scrollContainerRel.getAttribute("has-overflow-y"));this.elements.scrollContainerRel.setAttribute("has-overflow-y",Boolean(w)),w&&this.showScrollbarsOnHover?this.elements.scrollContainerRel.setStyle("margin-right","-"+this._scrollbarWidth+"px"):this.showScrollbarsOnHover&&!w&&D&&this.elements.scrollContainerRel.setStyle("margin-right","0px")}if(l>=0){var V=e.computeCenterContainerSideMargin("left",a,l);this._marginLeft!==V&&(this._marginLeft=V,this.elements.headerScrollContainer.setStyle("margin-left",V),this.elements.body.setStyle("margin-left",V),this.elements.centerSpacerContainer.setStyle("margin-left",V))}if(this.hasLeftContainer()&&this._leftContainerWidth!==a&&(this._leftContainerWidth=a,this.elements.leftHeaderScrollContainer.setStyle("width",a),this.elements.leftScrollContainer.setStyle("width",a),this.elements.leftSpacerContainer.setStyle("width",a),this.elements.leftHeaderPoolContainer.setStyle("width",r),this.elements.leftPoolContainer.setStyle("width",r)),u>=0){var I=e.computeCenterContainerSideMargin("right",v,u);this._marginRight!==I&&(this._marginRight=I,this.elements.headerScrollContainer.setStyle("margin-right",I),this.elements.body.setStyle("margin-right",I),this.elements.centerSpacerContainer.setStyle("margin-right",I))}if(this.hasRightContainer()&&this._rightContainerWidth!==v){var R=this._rightContainerWidth;this._rightContainerWidth=v,this.elements.rightHeaderScrollContainer.setStyle("width",v),this.elements.rightScrollContainer.setStyle("width",v),this.elements.rightSpacerContainer.setStyle("width",v),this.elements.rightHeaderPoolContainer.setStyle("width",_),this.elements.rightPoolContainer.setStyle("width",d);var A=d>0?"hidden":"auto";if(this.elements.scroller.getContent().setStyle("overflow-y",A),R<=0&&this._rightContainerWidth>0){var P=this.getScrollerPosition();this.elements.rightScroller.setPosition({y:P.y},!0)}}this.hasLeftContainer()&&((y=l>=0&&l<a)?this.elements.leftScroller.getContent().setStyle("overflow-x","scroll"):this.elements.leftScroller.getContent().setStyle("overflow-x","hidden")),this.hasRightContainer()&&((C=u>=0&&u<v)?this.elements.rightScroller.getContent().setStyle("overflow-x","scroll"):this.elements.rightScroller.getContent().setStyle("overflow-x","hidden"));var x=e.getHeaderContainerHeight(),O=this.getStatusBarContainerHeight();if(this._zoomRefValue!==t.innerWidth||this._headerContainerHeight!==x||this._statusBarContainerHeight!==O||this.hasLeftContainer()&&this._hasLeftContainerHorizontalOverflow!==y||this._hasCenterContainerHorizontalOverflow!==f||this.hasRightContainer()&&this._hasRightContainerHorizontalOverflow!==C){this._headerContainerHeight=x,this._statusBarContainerHeight=O;var T=x+"px";if(this.elements.header.setStyle("height",T),0===x?this.elements.header.setAttribute("empty",""):this.elements.header.removeAttribute("empty"),this.elements.statusBar){var N=O+"px";this.elements.statusBar.height=N}var E=0;if(this.hasLeftContainer()){y||!f&&!C||(E=this._scrollbarWidth);var F="calc(100% - "+(x+O+E)+"px)";this.elements.leftScrollContainer.setStyle("height",F),this.elements.leftSpacerContainer.setStyle("height",E+"px"),this.elements.leftSpacerContainer.setStyle("bottom",O+"px")}var L=0;if(this.hasRightContainer()){C||!y&&!f||(L=this._scrollbarWidth);var k="calc(100% - "+(x+O+L)+"px)";this.elements.rightScrollContainer.setStyle("height",k),this.elements.rightScrollContainer.setStyle("top",x),this.elements.rightSpacerContainer.setStyle("height",L+"px"),this.elements.rightSpacerContainer.setStyle("bottom",O+"px")}var U=0;f||!y&&!C||(U=this._scrollbarWidth);var W="calc(100% - "+(x+O+U)+"px)";this.elements.body.setStyle("height",W),this.elements.centerSpacerContainer.setStyle("height",U+"px")}this._hasLeftContainerHorizontalOverflow=y,this._hasCenterContainerHorizontalOverflow=f,this._hasRightContainerHorizontalOverflow=C,this._zoomRefValue=t.innerWidth}},t.prototype.getCellInfosAt=function(e){var t=this.getModelAt(e);return{cellID:e,cellModel:t,nodeModel:t}},t.prototype.getLightCellInfosAt=function(e){return{cellID:e}},t.prototype.getVisibleCellsInViewport=function(){return this._visibleCellsInViewport},t.prototype._getViewAt=function(e){var t=this._getRenderedCellAt(e);return t?t.component:null},t.prototype.getTreeDocument=function(){return this._rowModel?this._rowModel._getTreeDocument():void 0},t.prototype.getNodeModelAt=function(e){return this._rowModel?this._rowModel.getVisibleNodeModel(e):e>=0&&e<this.getModelLength()?this.getNodeModelAtRowID(e):void 0},t.prototype.getModelAt=function(e){return this.getNodeModelAt(e)},t.prototype.getNodeModelCountPerRow=function(){return 1},t.prototype._getModelAt=function(e){return this.getModelAt(e)},t.prototype._getRenderedCellAt=function(e){return this._listOfRenderedCells.get(e)},t.prototype._setRenderedCellAt=function(e,t){this._listOfRenderedCells.set(e,t)},t.prototype.updateView=function(e){if(this._isReady)return this._renderViewport(e)},t.prototype.prepareUpdateView=function(){this._updateCounter++},t.prototype.pushUpdateView=function(e,t){this._updateCounter--,0===this._updateCounter&&((this._updateNeeded||t)&&this.updateView(e),this._modelEvents.publish({event:"LAST_PUSH_UPDATE_VIEW",context:this,data:{}}))},t.prototype.isInViewTransaction=function(){return this._updateCounter>0},t.prototype.invalidateLayout=function(e){this.layout._invalidate(e),this._isReady&&(e||(e={}),this._renderViewport(e))},t.prototype.updateCellView=function(e,t){if(t&&(t.updateCellContent||!0===t.updateCellLayout||t.updateCellAttributes||t.updateCellVisibility)){var i=this._getViewAt(e);if(i){var o=void 0;(o=t.updateCellContent||!0===t.updateCellLayout?this.getCellInfosAt(e):this.getLightCellInfosAt(e)).cellView=i,t.updateCellContent&&(this.getCellEditableState(e)||this._removeCellInEdition(e),this._requestCellContent(o)),!0===t.updateCellLayout&&this._layoutCell(o),(t.updateCellContent||!0===t.updateCellLayout)&&this._applyCssClassesOnCell(o),t.updateCellAttributes&&this._applyAttributesOnCell(o),t.updateCellVisibility&&i.getContent().setAttribute("is-visible",!0)}}},t.prototype._updateRenderedCellAttributes=function(e){this.updateCellView(e,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})},t.prototype._updateRenderedActiveCell=function(e){return this._updateRenderedCellAttributes(e)},t.prototype._renderCell=function(e,t){var i=this.layout,o=t;this._visibleCellsInViewport[e]=e;var n=this._getRenderedCellAt(e);if(!n||t&&(t.updateCellContent||t.updateCellLayout||t.updateCellAttributes||t.updateCellVisibility)||i.cellTypeCanChangeOnScroll(e)){var l=t&&void 0!==t.cellType?t.cellType:i.getCellType(e);if(void 0===n||n.component.cellType!==l)n&&n.component.cellType!==l&&this._freeUpCell(e,1),n=(t&&t.cellPool?t.cellPool:this._cellPool).use(l),this._setRenderedCellAt(e,n),o={updateCellContent:!0,updateCellLayout:!(t&&"ignore"===t.updateCellLayout),updateCellAttributes:!0,updateCellVisibility:void 0===t.updateCellVisibility||t.updateCellVisibility};return this.updateCellView(e,o),n}},t.prototype._updateRenderOptions=function(e,t){if(!e)return t;var i=Object.assign({},e,t),o=function(o,n){var l=e[o];if(void 0!==l){var r=-1,s=t[o];if(void 0!==s&&(r=n.indexOf(s)),r===n.length-1)return;n.indexOf(l)>r&&(i[o]=l)}};return o("updateCellContent",["ignore",!1,!0]),o("updateCellLayout",["ignore",!1,!0]),o("updateCellAttributes",["ignore",!1,!0]),o("freePool",[!1,!0]),function(o,n){var l=e[o];if(void 0!==l){var r=t[o];(void 0===r||1===n&&l>r||-1===n&&l<r)&&(i[o]=l)}}("allottedTime",1),i},t.prototype._renderViewport=function(e){var t=this,o=this.layout,n={taskInterrupted:!1};if(this._renderViewportOptions=this._updateRenderOptions(e,this._renderViewportOptions),this._updateCounter>0)return this._updateNeeded=!0,n;if(!this.elements||!this.elements.container)return n;if(!1===this._isRendering()){var l=i.clone(this._renderViewportOptions,!0);l=i.extend({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!0,allottedTime:void 0,freePool:!1},l),this._isRendering(!0),o.isValid()||(o.prepareLayout(),l.updateCellLayout=!0,l.freePool&&this._freeUpPool(1)),this._visibleCellsInViewport={};var r=i.clone(l);r.render=function(e,i){return l.cellType=i&&void 0!==i.cellType?i.cellType:void 0,l.cellPool=i&&void 0!==i.cellPool?i.cellPool:void 0,l.updateCellVisibility=i&&void 0!==i.updateCellVisibility?i.updateCellVisibility:void 0,t._renderCell(e,l)};var s=!1;!this.hasLeftContainer()&&o.hasCellsInLeftContainer()&&(s=!0,this._createLeftFixedContainer());var a=!1;if(!this.hasRightContainer()&&o.hasCellsInRightContainer()&&(a=!0,this._createRightFixedContainer()),(n=o.renderListOfVisibleCellsInViewport(r))&&n.taskInterrupted&&(l.taskInterrupted=!0),this._postRender(l),s){var d=this.getScrollerPosition();this.setScrollerPosition({x:0,y:d.y},!0,this.elements.leftScroller)}if(a){d=this.getScrollerPosition();this.setScrollerPosition({x:0,y:d.y},!0,this.elements.rightScroller)}this._isRendering(!1),this._updateNeeded=!1,this._renderViewportOptions={},this._endRendering(l)}return n},t.prototype._postRender=function(e){var t=this,i=this.layout;i.postRender(),this._applyVirtualViewportSize(),e&&(e.lightRendering||e.taskInterrupted)||this._listOfRenderedCells.forEach((function(e,i){void 0===t._visibleCellsInViewport[i]&&t._freeUpCell(i,1)})),this._modelEvents.publish({event:"UPDATE_VIEW_COMPLETED",context:this,data:{hasAborted:!1,renderingOptions:e}})},t.prototype._isRendering=function(e){if(void 0===e)return void 0!==this.__isRendering&&this.__isRendering;this.__isRendering=e},t.prototype.onInfiniteScroll=function(e,t){t=i.extend({horizontalTolerance:10,verticalTolerance:10},t),this._infiniteScrollingHorizontalDistance=t.horizontalTolerance,this._infiniteScrollingVerticalDistance=t.verticalTolerance,this._onInfiniteScrollCB=e},t.prototype.infiniteScrollProcessDone=function(){this._modelEvents.publish({event:"infiniteScrollDone",context:this})},t.prototype.onEndResizeOrOnReadyModelRequest=function(e){this._onEndResizeOrOnReadyModelRequestCB=e},t.prototype.EndResizeOrOnReadyModelRequestDone=function(){this._modelEvents.publish({event:"endResizeOrOnReadyModelRequestDone",context:this})},t.prototype._requestCellContent=function(e){this._onCellRequest&&this._onCellRequest(e),this._onPostRequestCellCB&&this._onPostRequestCellCB(e)},t.prototype._layoutCell=function(e){var t=this.layout.getLayoutStylesForCellAt(e.cellID)||{},i=e.cellView,o=i.getReusableContent(),n=A(i.__cachedStyles,t);i.__cachedStyles=t;var l=i.getContent();for(var r in n.toAdd)l.style[r]=n.toAdd[r];for(var s in n.toRemove)l.style[s]="";var a=!1;if(e.rowID>=0&&e.columnID>=0&&l.parentNode&&o&&o.getContent&&o.getContent()&&o.usesTextWrapping&&o.usesTextWrapping()){var d=l.offsetHeight;(o.computeContentHeight?o.computeContentHeight():o.getContent().offsetHeight)>d&&(a=!0)}a?l.setAttribute("has-vertical-overflow",""):l.removeAttribute("has-vertical-overflow")},t.prototype.getCellCssClassesAt=function(e){var t="";return e.cellView&&(t=e.cellView.getInitialClassName()),t},t.prototype._applyCssClassesOnCell=function(e){var t=this.getCellCssClassesAt(e);e.cellView.__cachedCssClasses!==t&&(e.cellView.__cachedCssClasses=t,e.cellView.getContent().className=t)},t.prototype.getCellAttributesAt=function(e){var t={};return this.isCellPreselected(e.cellID)&&(t["is-preselected"]=!0,this.getPreselectedCellID()===e.cellID&&(t.hover=!0)),this.isCellSelected(e.cellID)&&(t["is-selected"]=!0),this.isCellHighlighted(e)&&(t["is-highlighted"]=!0),this.isCellActive(e.cellID)&&(t["is-active"]=!0),this.isCellInEdition(e.cellID)&&(t["is-in-edition"]=!0),this.selectionBehavior.showMixedStateOnParents&&this._hasSelectedDescendants(e.cellID)&&(t["has-selected-descendants"]=""),t},t.prototype._applyAttributesOnCell=function(e){var t=this.getCellAttributesAt(e),o=this.layout.getLayoutAttributesForCellAt(e.cellID);i.extend(t,o);var n=A(e.cellView.__cachedAttributes,t);e.cellView.__cachedAttributes=t;for(var l=0,r=Object.entries(n.toAdd);l<r.length;l++){var s=r[l],a=s[0],d=s[1];e.cellView.getContent().setAttribute(a,d)}for(var c=0,u=Object.keys(n.toRemove);c<u.length;c++){a=u[c];e.cellView.getContent().removeAttribute(a)}},t.prototype.registerReusableCellContent=function(e){this._reusableCellContentManager.register(e)},t.prototype.isReusableCellContentRegistered=function(e){return this._reusableCellContentManager.isRegistered(e)},t.prototype._reuseCellContent=function(e,t){var i=t.getReusableContent();i&&i.__disposable__&&i.__disposable__.identifier===e||(i&&i.__disposable__,i=this._reusableCellContentManager.use(e).component,t.setReusableContent(i));return i},t.prototype.reuseCellContent=function(e){var t=this._reusableCellContentManager.use(e);return t?t.component:null},t.prototype.onCellRequest=function(e){this._onCellRequest=e},t.prototype.onPostCellRequest=function(e){this._onPostRequestCellCB=e},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("selectionBehavior")&&C._applyForAdvancedSetterProperty(this,"selectionBehavior",t.selectionBehavior,this.selectionBehavior),this.isDirty("layout")&&this._applyLayout(t.layout),this.isDirty("height")&&this._applyHeight(t.height),this.isDirty("width")&&this._applyWidth(t.width),this.isDirty("rowSelection")&&this._applyRowSelection(t.rowSelection),this.isDirty("cellPreselectionFeedback")&&this._applyCellPreselectionFeedback(t.cellPreselectionFeedback),this.isDirty("cellSelection")&&this._applyCellSelection(t.cellSelection),this.isDirty("showScrollbarsOnHover")&&this._applyShowScrollbarsOnHover(t.showScrollbarsOnHover),this.isDirty("showBackgroundFlag")&&this._applyShowBackgroundFlag(t.showBackgroundFlag),this.isDirty("dataSource")&&this._applyDataSource(t.dataSource),this.isDirty("paginationManager")&&this._applyPaginationManager(t.paginationManager)},t.prototype._applyLayout=function(e){this.layout.collectionView=this,this.getContent().setAttribute("layout",this.layout.name),this._isReady&&(this.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}),this.setScrollerPosition({x:0,y:0}))},t.prototype._applyModel=function(e){this._isReady&&(this._isRendering(!1),this.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}),this.requestDelayedModelData("OnSyncModel"),this.elements.statusBar&&(this.elements.statusBar.updateTotalRows(),this.elements.statusBar.updateTotalVisibleRows()))},t.prototype._applyDataSource=function(e){this.dataSource&&e!==this.dataSource&&(void 0===this._rowModel&&(this.virtuallyLoadAllModelItems=!0,this._rowModel=new S({collectionView:this,virtuallyLoadAllModelItems:!0})),this.dataSource&&this.dataSource!==this._rowModel.dataSource?this._rowModel.dataSource=this.dataSource:this.dataSource&&this._isReady&&this.resetTreeDocument(),this.getTreeDocument(),this.getGroupingOptions()&&this.groupRows(this.getGroupingOptions()))},t.prototype.requestDelayedModelData=function(e,t){},t.prototype._applyShowScrollbarsOnHover=function(e){this.elements.scrollContainerRel&&this.elements.scrollContainerRel.setAttribute("show-at-hover",Boolean(this.showScrollbarsOnHover))},t.prototype._applyShowBackgroundFlag=function(e){this.showBackgroundFlag?this.getContent().removeAttribute("no-background"):this.getContent().setAttribute("no-background","")},t.prototype._applyPaginationManager=function(e){e&&e._collectionView===this&&(e._collectionView=void 0),this.paginationManager?(this.paginationManager._collectionView=this,this._isReady&&this.paginationManager.updatePagination()):this._isReady&&this._updateModel()},t.prototype._endRendering=function(e){},t.prototype._onAllCellsRendered=function(){if(this._allCellsRenderedCallBacks)for(var e=this._allCellsRenderedCallBacks.length-1;e>=0;e--){var t=this._allCellsRenderedCallBacks[e];this._allCellsRenderedCallBacks.pop(),t&&t.call(this)}this.fire("allCellsRendered")},t.prototype.subscribeOnceToAllCellsRendered=function(e){this._allCellsRenderedCallBacks||(this._allCellsRenderedCallBacks=[]),this._allCellsRenderedCallBacks.unshift(e)},t.prototype._updateRenderedRowCellsAttributes=function(e){},t.prototype.scrollToCellAt=function(e){var t;t="number"==typeof e?{cellID:e}:e,t=i.extend({animate:!1},t);var o=this.layout.getPositionForCellAt(t.cellID),n=o.left,l=o.top;this.setScrollerPosition({x:n,y:l,animate:t.animate})},t.prototype.getGroupingOptions=function(){},t.prototype._setGroupingOptions=function(e){this._groupingOptions=e},t.prototype.resetTreeDocument=function(){if(this._rowModel&&this._rowModel._isServerSide())return this._rowModel._resetTreeDocument()},t.prototype.ensureCellVisible=function(e,t,i){if(-1===e)return!1;var o=this.layout,n=o.getPositionForCellAt(e),l=o.getDimensionsForCellAt(e),r=o.getContentDimensions();if(this.__cachedContentDimensions&&(void 0!==this.__cachedContentDimensions.width&&this.__cachedContentDimensions.width!==r.width||void 0!==this.__cachedContentDimensions.height&&this.__cachedContentDimensions.height!==r.height)&&this._applyVirtualViewportSize(),o.getCellCoordinatesAt){var s=o.getCellCoordinatesAt(e);if(o.getColumnVisibleState&&!o.getColumnVisibleState(s.columnID))return!1}var a=this._getScrollerFromCellID(e);if(!a)return!1;var d=a.getPosition(),c=a.getContent().getDimensions();this._scrollbarWidth||(this._scrollbarWidth=this.getScrollbarWidth());var u=a.areScrollbarsDisplayed(),h=u.horizontal&&c.width<r.width?this._scrollbarWidth:0,p=this._getVerticalScrollbarWidth(a),g=u.vertical&&c.height<r.height?p:0,f=o.gutter||0,m={x:d.x,y:d.y},_=o.getCellType(e);if(u.vertical&&("__item__"===_||"__left_item__"===_||"__right_item__"===_||"__tree_item__"===_||"__left_tree_item__"===_||"__right_tree_item__"===_)){var v=o.sectionHeight?o.sectionHeight:0;m.y+c.height-h<n.top+l.height+f&&(m.y=n.top+l.height+f-c.height+h),m.y>n.top-f-v&&(m.y=n.top-f-v)}if(u.horizontal&&"__row_header__"!==_&&"__topleft_row_header__"!==_&&(m.x+c.width-g<n.left+l.width+f&&(m.x=n.left+l.width+f-c.width+g),m.x>n.left-f&&(m.x=n.left-f)),void 0!==i&&i>=0&&i<=1){var y=this.getViewportDimensions(),C=0,w=0;d.x<m.x?C=(1-i)*(y.width-l.width):d.x>m.x&&(C=-i*(y.width-l.width)),d.y<m.y?w=(1-i)*(y.height-l.height):d.y>m.y&&(w=-i*(y.height-l.height)),m={x:m.x+C,y:m.y+w}}return(d.x!==m.x||d.y!==m.y)&&(this._activeScroller=a,this.setScrollerPosition({x:m.x,y:m.y,animate:t},void 0,a),!0)},t.prototype.ensureNodeModelVisible=function(e,t,i,o,n){var l=this,r=this.layout;if(!e)return!1;var s=this.getTreeDocument();if(s&&(e.getTreeDocument&&e.getTreeDocument()!==s||!e.getTreeDocument))return!1;if(!1===e.isVisible()&&!0===i&&s){s.prepareUpdate();for(var a=e;a&&!1===a.isVisible()&&a.getParent();)a.getParent().expand(),a=a.getParent();s.pushUpdate()}var d=r.getCellsFromNodeModel(e,!0);if(d&&d.length>0){var c=this.ensureCellVisible(d[0],t,o);return n&&(c?this.subscribeOnceToAllCellsRendered((function(){l.flashEffectOnNodeModel("ui-modified",e)})):this.flashEffectOnNodeModel("ui-modified",e)),c}return!1},t.prototype.flashEffectOnNodeModel=function(e,t){if(t){var i=this.layout.getCellsFromNodeModel(t,!0);if(i&&i.length>0)for(var o=0;o<i.length;o++)this.flashEffectOnCell(e,i[o])}},t.prototype.flashEffectOnCell=function(e,t){var i=this._getViewAt(t);if(i){if(i.getContent().classList.contains(e)){i.getContent().classList.remove(e);i.getContent().offsetWidth}i.getContent().classList.add(e),i.getContent().addEventListener("animationend",(function(t){t.target.classList.remove(e)}),{once:!0})}},t.prototype._flashEffectOnRow=function(e,t){var i=this.getNodeModelAtRowID(t);i&&this.flashEffectOnNodeModel(e,i)},t.prototype._getScrollerFromCellID=function(e){return this._getScroller()},t.prototype._getVerticalScrollbarWidth=function(e){return this._scrollbarWidth?this._scrollbarWidth:this.getScrollbarWidth()},t.prototype._processPoolCells=function(e){var t=this;this._listOfRenderedCells.forEach((function(i,o){e.call(t,{cellView:i})}))},t.prototype._enableAutoScroll=function(e,t){var i=this;this._autoScrollDistance=e||{x:0,y:0},this._autoScrollPeriod=t||20,this._disableAutoScroll(),void 0===this._autoScrollInterval&&(this._autoScrollInterval=window.setInterval((function(){var e=i._getScroller(),t=e.elements.container.scrollTop,o=e.elements.container.scrollLeft;t>=0&&e.setPosition({y:t+i._autoScrollDistance.y},!0),o>=0&&e.setPosition({x:o+i._autoScrollDistance.x},!0)}),this._autoScrollPeriod))},t.prototype._setAutoScrollVelocity=function(e){this._autoScrollDistance=e||{x:0,y:0}},t.prototype._disableAutoScroll=function(){void 0!==this._autoScrollInterval&&(window.clearInterval(this._autoScrollInterval),delete this._autoScrollInterval)},t.prototype._onGutterOrMarginsChange=function(){},t.prototype.displayModalContainer=function(e,t){(!e||this._modalContainerCreated||this._loaderDisplayed)&&v.removeModal(this.getContent()),v.createModal(this.getContent(),e,t),this._modalContainerCreated=!0},t.prototype.removeModalContainer=function(){this._modalContainerCreated&&(v.removeModal(this.getContent()),this._modalContainerCreated=!1)},t.prototype.displayModalLoader=function(e,t){y.displayModalLoader(this.getContent(),e,t)},t.prototype.removeModalLoader=function(e){y.removeModalLoader(this.getContent(),e)},t.prototype.getNodeModelAtRowID=function(e){return this._rowModel?this._rowModel._getNodeModelAtRowID(e):this.model&&Array.isArray(this.model)?this.model[e]:void 0},t.prototype.getModelLength=function(){return this._rowModel?this._rowModel._getCurrentPaginationOptions()&&this._onPaginationChangeAsyncLoadModelCB?this._asyncPaginationInitialized?this.getWholeModelLengthForAsyncPagination():0:this._rowModel._getCollectionViewModelDisplayedLength():this.model&&Array.isArray(this.model)?this.model.length:0},t.prototype.destroy=function(){this._freeUpPool(1),this._cellPool&&(this._cellPool.destroy(),this._cellPool=null),e.prototype.destroy.call(this)},t.prototype._updateModel=function(){throw new Error("Function is not implemented on CollectionView base class!!!")},t.prototype.onPaginationChangeAsyncLoadModel=function(e){this._onPaginationChangeAsyncLoadModelCB=e},t.prototype.paginationChangeAsyncProcessDone=function(){this._modelEvents.publish({event:"paginationChangeAsyncDone",context:this})},t.prototype._setScrollbarsHidden=function(e){if(e){var t={};e.hasOwnProperty("horizontal")&&(t.horizontal=e.horizontal?"hidden":void 0),e.hasOwnProperty("vertical")&&(t.vertical=e.vertical?"hidden":void 0),this._getScroller()._setOverflow(t)}},t.prototype._preEditSelectionBehavior=function(e,t){return!!t&&{validValue:Object.assign({},e,t)}},t.prototype.onFindRequest=function(e,t){if(this.findCtx||(this.findCtx={opts:{}}),this.findCtx.opts=Object.assign({},e),this.findCtx.actionCompleted=t,e.findInContentSelected&&Array.isArray(e.findInContentSelected)&&e.findInContentSelected.length>0){for(var i={},o=0,n=this.layout.getLeafColumns();o<n.length;o++){var l=n[o];i[l.text]=l.dataIndex}var r=e.findInContentSelected.map((function(e){return i[e]}));this.getColumnsToProcessForFind=function(){return r}}else this.getColumnsToProcessForFind=void 0;var s=this._muteFind;this._muteFind=!0,this.findNavigationMode=e.navigationMode,this._muteFind=s,this.setFindStr(e.findStr,e.matchCase,e.currentValue,void 0,!0)},t.prototype.setFindStr=function(e,t,i,o,n,l,r){var s=this;if(this._onSetFindStr=!0,this._muteFind||this.findStr!==e||t!==this.matchCase||n){this._findModel=this._getFindModel();var a=!1;!0===this._muteFind&&this._findModel._isServerSide()&&(a=!0),this._muteFind=!1;var d=this.findStr,c=this.matchCase;this.matchCase=t,(this.findStr!==e||a)&&this._initFindVariables(),this.findStr=e,this.oldFindValue=d,this._hasARegExpFilter=r,void 0===i&&this.findWidget&&this.findWidget.setLoadingState&&this.findWidget.setLoadingState(!0);var u=function(){if(s._findModel){if(s.matchingStringCount=s._findModel._computeMatchingStringsCount(),s.findCtx||s.findWidget){s.findWidget&&(s.findWidget.count=-1);var e=void 0;"substring"===s.findNavigationMode?e=s.matchingStringCount:"cell"===s.findNavigationMode?(s._matchingCellIDsCount=s._findModel._computeMatchingCellIDsCount(),e=s._matchingCellIDsCount):(s._matchingRowsCount=s._findModel._computeMatchingNodeModelsCount(),e=s._matchingRowsCount),s.findCtx?s.findCtx.opts.count=e:s.findWidget&&(s.findWidget.count=e)}if(s._matchingCellIDsArray.length>0){if(void 0===i)s._currentMatchingStringIndex=0,s._currentMatchingCellIDIndex=0,s._currentMatchingRowIDIndex=0;else{var t=s._findModel._computeCurrentMatchingStringIndex(s,i);if(s._currentMatchingStringIndex=t,s._currentMatchingCellIDIndex=s._getMatchingCellIDIndexFromMatchingStringIndex(s._currentMatchingStringIndex),s._currentMatchingRowIDIndex=s._getMatchingRowIDIndexFromMatchingStringIndex(s._currentMatchingStringIndex),s.findCtx)s.findCtx.currentValue=s._findModel._computeFindEditorCurrentValue();else if(s.findWidget){var n=s._findModel._computeFindEditorCurrentValue();s.findWidget.setCurrentValue(n)}}if(s._currentMatchingRowIDIndex>=0&&(s._findModel._currentMatchingNodeModel=s._matchingNodeModelsArray[s._currentMatchingRowIDIndex]),!o){var l=s._matchingAllNodeModelsArray[s._currentMatchingCellIDIndex];l&&s.ensureNodeModelVisible(l,!1,!0,.5),s.ensureCellVisible(s._matchingCellIDsArray[s._currentMatchingCellIDIndex],!1,.5)}}s._updateViewAfterFind(),s._rowModel&&s._rowModel._isServerSide()&&s.findCtx&&s.findCtx.opts&&s.findCtx.opts.autoSelect&&s.onFindAutoSelect(s.findCtx.opts),s.findCtx&&s.findCtx.actionCompleted?s.findCtx.actionCompleted(Object.assign({},s.findCtx.opts)):s.findWidget&&s.findWidget.setLoadingState&&s.findWidget.setLoadingState(!1)}};if(""!==this.findStr){var h=void 0;d===this.findStr&&this.matchCase!==c&&!0===this.matchCase&&this._findModel&&(h=this._findModel._getNodeModelsToProcessFromMatchCaseChange());var p=0;this.findCtx&&this.findCtx.opts.currentValue&&void 0!==i?p=this.findCtx.opts.currentValue-1:this.findWidget&&this.findWidget.currentValue&&void 0!==i&&(p=this.findWidget.currentValue-1),this._findAllCellIDsMatchingFindStr(this.findStr,this.matchCase,p,h,l,u)}else u.call(this);this._onSetFindStr=!1}else this._onSetFindStr=!1},t.prototype._initFindVariables=function(){this._matchingFoundArrays=[],this._matchingCellIDsArray=[],this._matchingCellIDsMap={},this._matchingNodeModelsArray=[],this._matchingNodeModelsMap={},this._currentMatchingCellIDIndex=-1,this._currentMatchingRowIDIndex=-1,this.matchingStringCount=0,this._findModel&&(this._findModel._findResultNumber=0,this._findModel._findCurrentResultValue=void 0,this._findModel._matchingStringCount=0,this._findModel._matchingCellIDsCount=0,this._findModel._matchingRowsCount=0,this._findModel._currentMatchingNodeModel=void 0)},t.prototype._getFindModel=function(){return this._findModel||(this._findModel=new w({collectionView:this,treeDocument:this.getTreeDocument()})),this._findModel},t.getIndexesOfMatchingString=function(e,t){for(var i=[],o=e.indexOf(t);-1!==o;)i.push(o),o=e.indexOf(t,o+t.length);return i},t.prototype._getIndexesOfMatchingString=function(e,i){return t.getIndexesOfMatchingString(e,i)},t.prototype._getMatchingCellIDIndexFromMatchingStringIndex=function(e){for(var t=0,i=0;i<this._matchingFoundArrays.length;i++)if((t+=this._matchingFoundArrays[i].length)>e)return i;return-1},t.prototype._getMatchingStringIndexFromMatchingCellIDIndex=function(e){if(e>=0&&e<this._matchingFoundArrays.length){for(var t=0,i=0;i<e;i++)t+=this._matchingFoundArrays[i].length;return t}return-1},t.prototype._getMatchingRowIDIndexFromMatchingStringIndex=function(e){for(var t=0,i=0;i<this._matchingFoundArrays.length;i++){if(t>=e){var o=this._matchingAllNodeModelsArray[i];return this._matchingNodeModelsArray.indexOf(o)}t+=this._matchingFoundArrays[i].length}return-1},t.prototype.onFindReset=function(){this.findCtx||(this.findCtx={opts:{}}),this.setFindStr("",!1,0,void 0,!0)},t.prototype._updateViewAfterFind=function(){var e=this.oldFindValue;if(e&&""!==e)this.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0});else for(var t=0;t<this._matchingCellIDsArray.length;t++)this.updateCellView(this._matchingCellIDsArray[t],{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})},t.prototype._computeHighlightModelForFind=function(e){var t=void 0;if(!this._muteFind&&this._matchingCellIDsArray&&this._matchingCellIDsArray.length>0){var i;(i=this._matchingCellIDsMap[e.cellID])>=0&&(t={label:this.findStr,isARegExp:this._hasARegExpFilter,indexes:this._matchingFoundArrays[i],selectedIndex:this._getSelectedIndexFromMatchingCellIDIndex(i)})}return t},t.prototype._getSelectedIndexFromMatchingCellIDIndex=function(e){for(var t=0,i=0;i<this._matchingFoundArrays.length&&!(i>e||t>this._currentMatchingStringIndex);i++){var o=t;if(t+=this._matchingFoundArrays[i].length,i===e&&t>this._currentMatchingStringIndex)return this._currentMatchingStringIndex-o}return-1},t.prototype._getMatchingCellID=function(e){var t=-1;return this._matchingCellIDsArray&&e>=0&&e<this._matchingCellIDsArray.length&&(t=this._matchingCellIDsArray[e]),t},t.prototype.onFindNextResult=function(e,t){this.findCtx||(this.findCtx={opts:{}}),this.findCtx.opts=Object.assign({},e),this.findCtx.actionCompleted=t,this.goToNextMatchingCell()},t.prototype.goToNextMatchingCell=function(){this.findStr&&""!==this.findStr&&this.matchingStringCount>0&&(!0===this._muteFind&&(this._muteFind=!1,this.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})),this._onSetFindStr=!0,this._setCurrentMatchingCell(1),this._onSetFindStr=!1)},t.prototype._setCurrentMatchingCell=function(e){var t=this,i=this._getFindModel();this.findWidget&&this.findWidget.setLoadingState&&this.findWidget.setLoadingState(!0);var o;this.findCtx?o=this.findCtx.opts.currentValue-1:this.findWidget&&(o=this.findWidget.currentValue-1),this._findAllCellIDsMatchingFindStr(this.findStr,this.matchCase,o,void 0,!1,(function(o,n){var l;if(l=1===e?i._computeNextMatchingData(t,n):i._computePreviousMatchingData(t,n),t._currentMatchingStringIndex!==l||i._isServerSide()){var r=t.layout,s=t._currentMatchingStringIndex,a=t._getMatchingCellIDIndexFromMatchingStringIndex(s),d=t._getMatchingCellID(a),c=l,u=t._getMatchingCellIDIndexFromMatchingStringIndex(c),h=t._getMatchingCellID(u);if(t._currentMatchingStringIndex=c,t._currentMatchingCellIDIndex=u,t._currentMatchingRowIDIndex=t._getMatchingRowIDIndexFromMatchingStringIndex(t._currentMatchingStringIndex),t._currentMatchingRowIDIndex>=0&&(i._currentMatchingNodeModel=t._matchingNodeModelsArray[t._currentMatchingRowIDIndex]),t._currentMatchingCellIDIndex>=0){var p=t._matchingAllNodeModelsArray[t._currentMatchingCellIDIndex];if(p&&t.ensureNodeModelVisible(p,!1,!0,.5),t.updateCellView(h,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0}),"row"===t.findNavigationMode){var g=r.getCellCoordinatesAt(h).rowID;t._updateRenderedRowCellsAttributes(g)}t.ensureCellVisible(h,!1,.5)}if((void 0!==d||null!==d)&&(t.updateCellView(d,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0}),"row"===t.findNavigationMode)){g=r.getCellCoordinatesAt(d).rowID;t._updateRenderedRowCellsAttributes(g)}t.findCtx&&t.findCtx.actionCompleted?t.findCtx.actionCompleted(Object.assign({},t.findCtx.opts)):t.findWidget&&t.findWidget.setLoadingState&&t.findWidget.setLoadingState(!1)}else t.findCtx&&t.findCtx.actionCompleted?t.findCtx.actionCompleted(Object.assign({},t.findCtx.opts)):t.findWidget&&t.findWidget.setLoadingState&&t.findWidget.setLoadingState(!1)}),!0)},t.prototype.onFindPreviousResult=function(e,t){this.findCtx||(this.findCtx={}),this.findCtx.opts=Object.assign({},e),this.findCtx.actionCompleted=t,this.goToPreviousMatchingCell()},t.prototype.goToPreviousMatchingCell=function(){this.findStr&&""!==this.findStr&&this.matchingStringCount>0&&(!0===this._muteFind&&(this._muteFind=!1,this.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})),this._onSetFindStr=!0,this._setCurrentMatchingCell(-1),this._onSetFindStr=!1)},t.prototype.onFindInit=function(e){this._onFind=!0,this.findCtx||(this.findCtx={opts:{}}),this.findCtx.close=e},t.prototype.onFindClose=function(){this._onFind=!1,this.closeFind(),this.findCtx=null},t.prototype.onFindAutoSelect=function(e,t){if(this.findCtx||(this.findCtx={opts:{}}),this.findCtx.opts=Object.assign({},e),this.findCtx.actionCompleted=t,this.findCtx.opts&&this.findCtx.opts.autoSelect&&(this.findCtx.opts.autoSelect.modified&&this.unselectAll(),this.findCtx.opts.autoSelect.value))for(var i=0,o=this._matchingNodeModelsArray;i<o.length;i++){var n=o[i];this.selectNodeModel(n,!0)}this.findCtx&&this.findCtx.actionCompleted&&this.findCtx.actionCompleted()},t.prototype.closeFind=function(){!1===this._muteFind&&(this._muteFind=!0,this.findStr&&""!==this.findStr&&this.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})),this._resetFindVariables()},t.prototype._resetFindVariables=function(){this._initFindVariables()},t.prototype._getCellValueAsStringForFind=function(e,t){},t.prototype._getMatchingStringIndexFromMatchingRowIDIndex=function(e){if(e>=0&&e<this._matchingNodeModelsArray.length){var t=0,i=this._matchingNodeModelsArray[e];if(i)for(var o=0;o<this._matchingAllNodeModelsArray.length&&this._matchingAllNodeModelsArray[o]!==i;o++)t+=this._matchingFoundArrays[o].length;return t}return-1},t.prototype.getMatchingFindNodeModelArray=function(){return this._matchingNodeModelsArray},t.prototype.getMatchingFindCurrentNodeModel=function(){return this._rowModel?this._rowModel._currentMatchingNodeModel:void 0},t.prototype._findAllCellIDsMatchingFindStr=function(e,t,i,o,n,l,r){var s=this._getFindModel();s&&s._findAndDisplayAllCellIDsMatchingFindStr(e,t,i,o,n,l,r)},t.prototype._updateHighlight=function(e){},t.prototype._onXSOAdd=function(e){},t.prototype._onXSOPostAdd=function(e){},t.prototype._onXSOPostRemove=function(e){},t.prototype._onXSORemove=function(e){},t.prototype._onPXSOPostAdd=function(e){},t.prototype._onPXSOPostRemove=function(e){},t.prototype.getWholeModelLengthForAsyncPagination=function(){return 0},t.prototype.getCellValue=function(e){},t.prototype._setTweakerForCell=function(e,t){var o,n,l,a,d=this,c=this.getTypeRepresentationFactory(),u=e.cellModel;o=this._getTypeRepAndValue(e),n=o.typeRepresentation,a=o.useTweaker,u=o.value,l=o.referenceValue;var h=Date.now();if(e.cellView&&(e.cellView._currentTimeStamp=h),n&&a){var p=void 0,g=e.cellView?e.cellView.getReusableContent():null;if(g&&g.__disposable__){var f=c.getRegisteredTypeRepresentation(n);f||(f={semantics:{possibleValues:c.getRegisteredEnum(n)}}),p=M.getTemplateIdentifierFromTypeRep(f,"inlinedTemplate")}var m=this._computeTweakerOptions(e,l),_=this.getCellSemantics(e);_&&(_=i.clone(_,!1),m.semantics=i.merge(_,m.semantics)),t&&(m=i.merge(t,m)),m.semantics.executionContext||(m.semantics.executionContext=e);var v=void 0;if(!this._muteFind&&this._matchingCellIDsArray&&this._matchingCellIDsArray.length>0){var y;(y=this._matchingCellIDsMap[e.cellID])>=0&&(v={label:this.findStr,isARegExp:this._hasARegExpFilter,indexes:this._matchingFoundArrays[y],selectedIndex:this._getSelectedIndexFromMatchingCellIDIndex(y)})}m.semantics.highlightModel=v,g&&g.__disposable__&&g.__disposable__.identifier===p?(g.disableEvents(),m.semantics.value=u,m.semantics.readOnly=m.readOnly,r.callOutsideUserinteraction((function(){s.setTweakerProperties(g,m.semantics,n,c)})),g.enableEvents()):(m.typePath=n,m.context="inlinedTemplate",m.semantics.executionContext||(m.semantics.executionContext=e),m.needToCreateViewAfterRequireEnded=function(){return!(!e.cellView||e.cellView._currentTimeStamp!==h)},this._addTweakerToGenerate(),m.onViewCreated=function(t){if(e.cellView&&e.cellView.setReusableContent(t),d._isCellDraggable(e)&&!d.isCellInEdition(e.cellID)){var i=t.getContent?t.getContent():t;i&&i.setAttribute("draggable",!0)}d._removeTweakerToGenerate()},m.onFailure=function(e){d._removeTweakerToGenerate()},r.callOutsideUserinteraction((function(){c.generateView(u,m)})))}else e.cellView&&e.cellView.setReusableContent(null);if(e.cellView){var C=this._getCellKPIColor(e);C?(e.cellView.KPIColor=C,e.cellView.showKPIColorFlag=!0):e.cellView.showKPIColorFlag=!1}},t.prototype._getTypeRepAndValue=function(e){return{useTweaker:!1,value:this.getCellValue(e)}},t.prototype._addTweakerToGenerate=function(){this._tweakerToGenerateCount++},t.prototype._removeTweakerToGenerate=function(){this._tweakerToGenerateCount--,this._isRendering()||this._isPrivateRendering()||0!==this._tweakerToGenerateCount||this._onAllCellsRendered()},t.prototype._isPrivateRendering=function(e){if(void 0===e)return void 0!==this.__isPrivateRendering&&this.__isPrivateRendering;this.__isPrivateRendering=e},t.prototype.hasPendingCellsToRender=function(){return this._isRendering()||this._tweakerToGenerateCount>0&&!this._isPrivateRendering()},t.prototype._getCellKPIColor=function(e){},t.prototype._isCellDraggable=function(e){return this.cellDragEnabledFlag},t.prototype.groupRows=function(e){},t.prototype.currentlyFindingString=function(){return this._onFind||this._onSetFindStr||""!==this.findStr},t}(u);return P.prototype.blackBoxFlag=!0,C.addClass(P,"CollectionView"),P}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/IconChooser",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/TreeModel/TreeDocument","DS/Utilities/WUXUWAUtils","DS/Controls/Button","DS/Controls/Popup","DS/CollectionView/CollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Tweakers/GeneratedToolbar","DS/CollectionView/CollectionViewCell","DS/Tweakers/TypeRepresentationFactory","DS/CollectionView/modelProviders/IconChooserBaseModelProvider","DS/CollectionView/modelProviders/IconChooserTreeDocumentModelProvider","DS/CoreBase/WebUXGlobalEnums","DS/CoreBase/WebUXGlobalEnums"],(function(e,t,i,o,n,l,r,s,a,d,c,u,h,p,g,f,m,_,v){"use strict";function y(e){e.disabled||(e._isDropped()?(e.elements.popup.visibleFlag=!1,e.elements.container.removeAttribute("active")):e._showPopup())}function C(e){var t=e.elements.gridView.getActiveCellID();t>-1&&e.elements.gridView.selectCell(t),e.elements.button.focus(),!0===e.elements.button.checkFlag&&e.elements.container.removeAttribute("active"),e.elements.container.setAttribute("fakefocus",!0)}var w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t),this.getContent().addClassName("wux-layouts-iconchooser-cell"),this.getContent().setAttribute("draggable","false")},t.prototype.getInitialClassName=function(){return"wux-controls-abstract wux-layouts-collectionview-cell wux-layouts-iconchooser-cell"},t}(g),S=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var o=e.apply(this,t)||this;return a.extendingClassFlag,o}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:void 0,type:"string",category:"Behavior"},gridViewModel:{defaultValue:[],type:"array",category:"Behavior"},iconSize:{defaultValue:void 0,type:"string",category:"Appearance"},headerModel:{defaultValue:[],type:"array",category:"Behavior"},filterValue:{defaultValue:void 0,type:"string",category:"Behavior"},flyoutDirection:{defaultValue:"right",type:"string",category:"Appearance"},columnMaxCount:{defaultValue:5,type:"number",category:"Appearance"},rowMaxCount:{defaultValue:5,type:"number",category:"Appearance"},buildItemView:{defaultValue:function(e){return this.buildDefaultItemView(e)},type:"function"},buildValueItem:{defaultValue:function(e){return this.buildDefaultValueItemView(e)},type:"function"},onItemSelected:{defaultValue:void 0,type:"function",category:"Behavior"},onFilterChanged:{defaultValue:void 0,type:"function",category:"Behavior"},getTooltip:{defaultValue:function(e){return this.getDefaultTooltip(e)},type:"function"},modelProvider:{defaultValue:null,type:"object"},actionOnClickFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},getHeaderIconName:{defaultValue:function(e){return this.getHeaderDefaultIconName(e)},type:"function"},getHeaderTooltip:{defaultValue:function(e){return this.getHeaderDefaultTooltip(e)},type:"function"},getScrollbarWidth:{defaultValue:function(){return i.Utils.Client.getScrollbarWidth()},type:"function"}}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){this.elements.container=new i.Element("div",{class:"wux-controls-iconchooser",tabindex:0}),e.prototype._preBuildView.call(this,t)},t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.currentElement=new i.Element("div",{class:"wux-controls-iconchooser-current-element"}),this.elements.currentElement.inject(this.elements.container),this.elements.button=new d({icon:{iconName:"expand-down",fontIconFamily:v.WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},type:"check"}),this.elements.button.preventTriggeringChangeEvent=!0,this.elements.button.getContent().addClassName("wux-controls-iconchooser-button"),this.elements.button.inject(this.elements.container),this.actionOnClickFlag&&this.elements.button.addClassName("wux-action-flag")},t.prototype.handleEvents=function(){var e=this;l.addEventOnElement(this,this.elements.currentElement,"click",(function(t){e.actionOnClickFlag?(e.elements.popup&&(e.elements.popup.visibleFlag=!1),t.dsModel=e,e.elements.button.checkFlag=!0,e.elements.container.setAttribute("active",!0)):(t.stopPropagation(),y(e),e.elements.button.checkFlag?e.elements.button.checkFlag=!1:e.elements.button.checkFlag=!0)})),l.addEventOnElement(this,this.elements.button,"click",(function(e){e.stopPropagation()})),this.elements.button.onClick=function(t){t.stopPropagation(),y(e)},l.addEventOnElement(this,this.elements.container,"blur",(function(t){e.elements.container.removeAttribute("active"),e.elements.container.removeAttribute("fakefocus"),e.elements.button.checkFlag=!1})),l.addEventOnElement(this,this.elements.button,"blur",(function(t){!1!==e.elements.button.checkFlag||e.actionOnClickFlag&&e.elements.container.getAttribute("active")||(e.elements.container.removeAttribute("active"),e.elements.container.removeAttribute("fakefocus")),e.actionOnClickFlag&&e.elements.container.getAttribute("active")&&(e.elements.button.checkFlag=!0)}))},t.prototype._applyFlyoutDirection=function(e){var t=b(this.flyoutDirection);this.elements.popup&&(this.elements.popup.alignment=t)},t.prototype._applyGridViewModel=function(e){e&&this.modelProvider&&this.modelProvider.removeModelEvents(e),this.gridViewModel instanceof s&&(this.modelProvider||(this.modelProvider=new _)),this.modelProvider||(this.modelProvider=new m),this.modelProvider.addModelEvents(this.gridViewModel),this._applyRowMaxCount(void 0),this.elements.gridView&&this.elements.gridView._updateDimensions(),this._buildHeaderAndGridViewFromModels()},t.prototype._applyHeaderModel=function(e){this._needToolbarUpdate=!0,this._buildHeaderAndGridViewFromModels()},t.prototype._buildHeaderAndGridViewFromModels=function(){this._buildHeaderCells(),this.elements.gridView&&(this.elements.gridView.model=this.modelProvider.flattenModel(this.gridViewModel),this._updateSelectedItemInCollectionView())},t.prototype._applyValue=function(e){if(this.elements.currentElement&&(this.elements.currentElement.innerHTML="",this.value)){var t=this.buildValueItem(this.value);this.elements.currentElement.appendChild(t),!0===this._getCurrentTouchMode()&&t.setAttributeNode(document.createAttribute("touch-mode"))}this._updateSelectedItemInCollectionView(),e!==this.value&&this.fire("change")},t.prototype._applyFilterValue=function(e){if(this.headerModel&&this.elements.generatedToolbar){var t=this.headerModel.indexOf(this.filterValue);if(t<0||isNaN(t))return;var i="iconChooserHeaderModelItem_"+t.toString(),o=!!this.filterValue;this.elements.generatedToolbar.updateNodeModel(i,{grid:{data:o}})}},t.prototype._applyOnItemSelected=function(e){e&&l.removeEventOnElement(this,this,"selectionChanged",e),this.onItemSelected&&l.addEventOnElement(this,this,"selectionChanged",this.onItemSelected)},t.prototype._applyOnFilterChanged=function(e){e&&l.removeEventOnElement(this,this,"filterChanged",e),this.onFilterChanged&&l.addEventOnElement(this,this,"filterChanged",this.onFilterChanged)},t.prototype._applyIconSize=function(e){this.elements.gridView&&(this._applyColumnMaxCount(void 0),this._applyRowMaxCount(void 0),this.updateView())},t.prototype._applyColumnMaxCount=function(e){if(this.elements.gridView){var t=this._computeColumnWidth(),i=this.columnMaxCount*t+(this.columnMaxCount+1)*this.elements.gridView.layout.gutter+this.elements.gridView.layout.layoutMargins.marginLeft+this.elements.gridView.layout.layoutMargins.marginRight;this.elements.gridView.layout.columnMaxWidth=t;var o=this.modelProvider.flattenModel(this.gridViewModel).length;i+=this.columnMaxCount&&o/this.columnMaxCount>this.rowMaxCount?this.getScrollbarWidth():0;var n=o*t+(o+1)*this.elements.gridView.layout.gutter+this.elements.gridView.layout.layoutMargins.marginLeft+this.elements.gridView.layout.layoutMargins.marginRight;this.elements.popup.popupBody.style.width=Math.min(n,i).toString()+"px",void 0!==e&&this._applyRowMaxCount(void 0)}},t.prototype._applyRowMaxCount=function(e){if(this.elements.gridView){var t=this._getCurrentTouchMode(),i=this._computeRowHeight(),o=this._computeColumnWidth(),n=t?50:33,l=this.headerModel&&this.headerModel.length?n:0,r=l+this.rowMaxCount*i+(this.rowMaxCount+1)*this.elements.gridView.layout.gutter+this.elements.gridView.layout.layoutMargins.marginTop+this.elements.gridView.layout.layoutMargins.marginBottom;this.elements.gridView.layout.rowMaxHeight=i;var s=this.columnMaxCount*o+(this.columnMaxCount+1)*this.elements.gridView.layout.gutter+this.elements.gridView.layout.layoutMargins.marginLeft+this.elements.gridView.layout.layoutMargins.marginRight,a=this.modelProvider.flattenModel(this.gridViewModel).length;s+=this.columnMaxCount&&a/this.columnMaxCount>this.rowMaxCount?this.getScrollbarWidth():0;var d=a*o+(a+1)*this.elements.gridView.layout.gutter+this.elements.gridView.layout.layoutMargins.marginLeft+this.elements.gridView.layout.layoutMargins.marginRight,c=this.columnMaxCount;d<=s&&(c=a);var u=Math.ceil(a/c)*i+(Math.ceil(a/c)+1)*this.elements.gridView.layout.gutter+this.elements.gridView.layout.layoutMargins.marginTop+this.elements.gridView.layout.layoutMargins.marginBottom+l,h=0===this.rowMaxCount?i:Math.min(u,r);this.elements.gridView.height=h-l,this.elements.popup.popupBody.style.height=h.toString()+"px",void 0!==e&&this._applyColumnMaxCount(void 0)}},t.prototype._applyModelProvider=function(e){var t=this.modelProvider;t&&(t.iconChooser=this)},t.prototype._applyActionOnClickFlag=function(e){this.elements.button&&(this.actionOnClickFlag?this.elements.button.getContent().addClassName("wux-action-flag"):this.elements.button.getContent().removeClassName("wux-action-flag"))},t.prototype._applyTouchMode=function(t){(e.prototype._applyTouchMode.call(this,t),this.elements.currentElement)&&(!0===this._getCurrentTouchMode()?(this.elements.currentElement.setAttributeNode(document.createAttribute("touch-mode")),this.elements.currentElement.children&&this.elements.currentElement.children.length>0&&this.elements.currentElement.children[0].setAttributeNode(document.createAttribute("touch-mode"))):(this.elements.currentElement.removeAttribute("touch-mode"),this.elements.currentElement.children&&this.elements.currentElement.children.length>0&&this.elements.currentElement.children[0].removeAttribute("touch-mode")))},t.prototype._computeColumnWidth=function(){var e=this._getCurrentTouchMode();return this.iconSize?this._parseIconSize(this.iconSize,e)[0]+(e?19:8):e?38:24},t.prototype._parseIconSize=function(e,t){var i=t?[19,19]:[16,16];if("string"!=typeof e)return window.console.warn("Type of parameter for iconSize is expected to be string in format '40' or '40 60' for instance"),i;var o=e.split(" ").filter((function(e){return null!=e&&""!=e}));if(null==o||o.length>2)return i;var n=Number.parseInt(o[0].endsWith("px")?o[0].slice(0,-2):o[0]),l=n,r=!1,s=!1;if(void 0===l)return i;if(l<(t?19:16)?(r=!0,l=t?19:16):l>114&&(s=!0,l=114),i[0]=l,o.length>1){var a=Number.parseInt(o[1].endsWith("px")?o[1].slice(0,-2):o[1]);if(void 0===a)return i[1]=l,i;r?a=Math.floor((t?19:16)*a/n):s?a=Math.floor(114*a/n):a<(t?19:16)?a=t?19:16:a>114&&(a=114),i[1]=a}else i[1]=l;return i},t.prototype._computeRowHeight=function(){var e=this._getCurrentTouchMode();return this.iconSize?this._parseIconSize(this.iconSize,e)[1]+(e?19:8):e?38:24},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("modelProvider")&&this._applyModelProvider(t.modelProvider),this.isDirty("flyoutDirection")&&this._applyFlyoutDirection(t.flyoutDirection),this.isDirty("columnMaxCount")&&this._applyColumnMaxCount(t.columnMaxCount),this.isDirty("rowMaxCount")&&this._applyRowMaxCount(t.rowMaxCount),this.isDirty("gridViewModel")&&this._applyGridViewModel(t.gridViewModel),this.isDirty("headerModel")&&this._applyHeaderModel(t.headerModel),this.isDirty("value")&&this._applyValue(t.value),this.isDirty("iconSize")&&this._applyIconSize(t.iconSize),this.isDirty("actionOnClickFlag")&&this._applyActionOnClickFlag(t.actionOnClickFlag),this.isDirty("filterValue")&&this._applyFilterValue(t.filterValue),this.isDirty("onItemSelected")&&this._applyOnItemSelected(t.onItemSelected),this.isDirty("onFilterChanged")&&this._applyOnFilterChanged(t.onFilterChanged)},t.prototype.buildDefaultItemView=function(e){var t=this.modelProvider.getIconDefinition(e.model);if(this.iconSize){if("string"==typeof t){var i={iconName:t,fontIconSize:this._parseIconSize(this.iconSize,this.touchMode)[0]+"px"};return l.generateIcon(i)}var o=JSON.parse(JSON.stringify(t)),n=this._parseIconSize(this.iconSize,this.touchMode);return o.fontIconSize=this._parseIconSize(this.iconSize,this.touchMode)[0]+"px",o.iconSize={height:n[1]+"px",width:n[0]+"px"},l.generateIcon(o)}return l.generateIcon(t)},t.prototype.buildDefaultValueItemView=function(e){var t;if("string"==typeof e)t=l.generateIcon(e);else{var i=this.modelProvider.getIconDefinition(e);t=l.generateIcon(i)}return t.classList.add("wux-iconchooser-value"),t},t.prototype.getDefaultTooltip=function(e){return this.modelProvider.getTooltip(e)},t.prototype._buildHeaderCells=function(){var e=this;if(this.elements.headerCellsMainDiv){var t=this._getCurrentTouchMode();if(!0===t?this.elements.headerCellsMainDiv.setAttributeNode(document.createAttribute("touch-mode")):this.elements.headerCellsMainDiv.removeAttribute("touch-mode"),this.elements.headerCellsMainDiv.style.display="none",this.headerModel&&0!==this.headerModel.length){if(this.elements.headerCellsMainDiv.style.display="",this._needToolbarUpdate){this._needToolbarUpdate=!1,this.elements.headerCellsContainer||(this.elements.headerCellsBackground=new i.Element("div",{class:"wux-controls-iconchooser-headercellsbackground"}),this.elements.headerCellsBackground.inject(this.elements.headerCellsMainDiv),this.elements.headerCellsContainer=new i.Element("div",{class:"wux-controls-iconchooser-headercellscontainer"}),this.elements.headerCellsContainer.inject(this.elements.headerCellsBackground),this._onGeneratedToolbarClick=function(t){if(!this.__updateRunning){var i=null==t?void 0:t._getLocalID();e.filterValue=e.headerModel[i];for(var o=t.getBrothers(),n=0;n<o.length;n++)if(o[n].options.grid&&!0===o[n].options.grid.data){this.__updateRunning=!0,o[n].updateOptions({grid:{data:!1}}),this.__updateRunning=!1;break}e.elements.gridView.getCellsXSO().empty(),e.elements.gridView.setActiveCell(-1),e.fire("filterChanged",{modelItem:e.filterValue,clickItemIndex:i,isChecked:t.options.grid.data})}}),this.elements.headerCellsContainer.innerHTML="";var o={entries:[]};(new f).registerTypeRepresentations({buttonToggle:{stdTemplate:"toggleIcon",semantics:{possibleValues:[{value:"false",icon:{iconName:"",fontIconFamily:1}},{value:"true",icon:{iconName:"",fontIconFamily:1}}]}}});for(var n=0;n<this.headerModel.length;n++){var l={},r={};this.getHeaderIconName(this.headerModel[n])?(l={iconName:this.getHeaderIconName(this.headerModel[n])?this.getHeaderIconName(this.headerModel[n]):void 0},r={iconName:this.getHeaderIconName(this.headerModel[n])?this.getHeaderIconName(this.headerModel[n]):void 0}):(Object.assign(l,this.headerModel[n]),Object.assign(r,this.headerModel[n])),l.fontIconFamily=1,l.className=t?"wux-iconchooser-gridview-header-touch":"wux-iconchooser-gridview-header",r.fontIconFamily=1,r.className=t?"wux-iconchooser-gridview-active-header-touch":"wux-iconchooser-gridview-active-header",o.entries.push({id:"iconChooserHeaderModelItem_"+n.toString(),dataElements:{typeRepresentation:"buttonToggle",possibleValues:[{value:"false",icon:l},{value:"true",icon:r}],value:this.headerModel[n]==e.filterValue,func:this._onGeneratedToolbarClick,position:"near",category:"view",tooltip:this.getHeaderTooltip(this.headerModel[n])},onNodeUpdate:this._onGeneratedToolbarClick})}var s=p.prototype.createTreeDocument(o);this.elements.generatedToolbar=new p({overflowManagement:"dropdown",direction:"horizontal",items:s}),this.elements.generatedToolbar.inject(this.elements.headerCellsContainer),this.elements.generatedToolbar.getContent().style.height="100%"}this.elements.headerCellsMainDiv.innerHTML="",this.elements.headerCellsBackground.inject(this.elements.headerCellsMainDiv)}}},t.prototype._isDropped=function(){return this.elements&&this.elements.popup&&this.elements.popup.visibleFlag},t.prototype._showPopup=function(){var e=this,t=this;if(!this.elements.popup){var o={target:this.elements.container,position:"bottom",offset:{x:0,y:6},forceKeepOrientation:!0,alignment:b(this.flyoutDirection),className:"wux-controls-iconchooser-popup wux-controls-popup",constraint:"screen",overlap:!1,trigger:""};this.elements.popup=new c(o),this.elements.popup.getContent().setStyle("visibility","hidden"),this.elements.popup.popupBody=new i.Element("div"),this.elements.popup.setBody(this.elements.popup.popupBody),this.elements.popup._getElementToFocus=function(){return t.elements.gridView.getContent()};var r=function(e){if(t.elements.popup.visibleFlag&&(!l.firstParentWithClass(e.target,"wux-controls-iconchooser-popup")&&!l.firstParentWithClass(e.target,"wux-toolbar-popup"))){var i=l.firstParentWithClass(e.target,"wux-controls-iconchooser");!!i&&i.dsModel===t||(t.elements.popup.visibleFlag=!1,t.elements.button.checkFlag=!1,t.elements.container.removeAttribute("active"),t.elements.container.removeAttribute("fakefocus"))}},s=document;this.getContent()&&this.getContent().ownerDocument&&(s=this.getContent().ownerDocument),l.addEventOnElement(this,s.body,"mousedown",r,!0),l.addEventOnElement(this,s.body,"touchstart",r,!0),l.addEventOnElement(this,s.defaultView,"focusout",(function(t){l.firstParentWithClass(t.target,"wux-controls-iconchooser")===e.getContent()&&l.firstParentWithClass(s.activeElement,"wux-controls-iconchooser")!==e.getContent()&&r(t)}));var a=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.supportsSelection=function(){return!0},o.prototype.supportsKeyboardNavigation=function(){return!0},o.prototype.computeCellIDFromActiveCell=function(e,i,o){if(!t.gridViewModel||!t.modelProvider.flattenModel(t.gridViewModel).length)return-1;var n=this.getActiveCellID(),l=n,r=t.modelProvider.flattenModel(t.gridViewModel).length,s=r-1;switch(e){case"down":return l+t.columnMaxCount>=r?l/t.columnMaxCount<Math.floor((r-1)/t.columnMaxCount)?s:n:n+t.columnMaxCount;case"up":return l-t.columnMaxCount<0?n:n-t.columnMaxCount;case"right":return l+1>=r?n:n+1;case"left":return l-1<0?n:n-1;case"home":return 0;case"end":return r-1;default:return}},o.prototype._manageKeyboard=function(){e.prototype._manageKeyboard.call(this);var o=Object.assign({},this.commands);i.extend(o,{space:function(){return C(t),{stopPropagation:!0,preventDefault:!0}},enter:function(){C(t)},escape:function(){t.elements.button.fire("buttonclick"),t.elements.button.checkFlag=!1,t.elements.button.focus(),t.elements.container.removeAttribute("active"),t.elements.container.setAttribute("fakefocus",!0)},leftMove:function(){var e=this.computeCellIDFromActiveCell("left");return this.setActiveCell(e,!0,!0),{preventDefault:!0}},rightMove:function(){var e=this.computeCellIDFromActiveCell("right");return this.setActiveCell(e,!0,!0),{preventDefault:!0}},upMove:function(){var e=this.computeCellIDFromActiveCell("up");return this.setActiveCell(e,!0,!0),{preventDefault:!0}},downMove:function(){var e=this.computeCellIDFromActiveCell("down");return this.setActiveCell(e,!0,!0),{preventDefault:!0}},home:function(){var e=this.computeCellIDFromActiveCell("home");return this.setActiveCell(e,!0,!0),{preventDefault:!0}},end:function(){var e=this.computeCellIDFromActiveCell("end");return this.setActiveCell(e,!0,!0),{preventDefault:!0}}}),this.commands=o,this.keymaps.space="space"},o}(u);this.elements.popupMainDiv=new i.Element("div"),this.elements.headerCellsMainDiv=new i.Element("div",{class:"wux-layouts-iconchooser-header-cell"}).inject(this.elements.popupMainDiv),this._buildHeaderCells();var d=this._getCurrentTouchMode(),p=this._computeRowHeight(),g=this._computeColumnWidth();this.elements.gridView=new a({cellClass:w,layout:new h({gutter:5,rowMaxHeight:p,columnMaxWidth:g,useDynamicColumnWidth:!1,layoutMargins:{marginTop:2,marginBottom:2,marginLeft:2,marginRight:2}}),height:"inherit",rowSelection:"single",cellSelection:"single",getScrollbarWidth:function(){return t.getScrollbarWidth()}}),this.elements.gridView.getContent().addClassName("wux-iconchooser-gridview"),this._applyIconSize(void 0),this._applyGridViewModel(void 0),this._applyHeaderModel(void 0),this._applyValue(void 0),this._applyFilterValue(void 0),this.elements.gridView.getContent().inject(this.elements.popupMainDiv),this.elements.popupMainDiv.inject(this.elements.popup.popupBody),this.elements.gridView.onReady((function(){if(t.gridViewModel&&t.modelProvider.flattenModel(t.gridViewModel).length){var e=t.modelProvider.flattenModel(t.gridViewModel),i=-1;if(t.value)for(var o=0;o<e.length;o++)if(t.modelProvider.areItemsEquals(e[o],t.value)){i=o;break}t.elements.gridView.setActiveCell(i)}t.elements.gridView.getCellsXSO().onPostAdd((function(e){if(e&&1===e.length){var i=t.modelProvider.flattenModel(t.gridViewModel)[e[0]];t.value=i;var o=t.getTooltip(i);if(o){var n=t.tooltipInfos;n||(n={}),"string"==typeof o?n.shortHelp=o:(n.title=o.title,n.shortHelp=o.shortHelp,n.longHelp=o.longHelp),t.tooltipInfos=n}t.fire("selectionChanged",{selectedItem:i})}})),d&&t.elements.gridView.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})})),this.elements.gridView.onPostUpdateViewOnce((function(){setTimeout((function(){t.elements.popup.getContent().setStyle("visibility","visible"),t.fire("popupVisibilityChange"),t.elements.popup.focus(),t.elements.button.checkFlag=!0,t.elements.container.setAttribute("active",!0)}),100)})),this.elements.gridView.onCellRequest((function(e){var i=t.elements.gridView.layout.getCellCoordinatesAt(e.cellID),o=t.buildItemView.call(t,{model:e.cellModel,rowID:i.rowID,columnID:i.columnID}),n=t.modelProvider.getTooltip(e.cellModel);n&&(e.cellView.tooltipInfos||(e.cellView.tooltipInfos={}),"string"==typeof n?e.cellView.tooltipInfos.shortHelp=n:"object"==typeof n&&(e.cellView.tooltipInfos.title=n.title,e.cellView.tooltipInfos.shortHelp=n.shortHelp,e.cellView.tooltipInfos.longHelp=n.longHelp)),o.classList.add("wux-gridview-cell-content"),l.setContent(e.cellView.getContent(),o,!0),0!==e.cellView.getContent().getElementsByTagName("img").length?e.cellView.getContent().setAttribute("hasimg",""):e.cellView.getContent().removeAttribute("hasimg","")})),this.elements.gridView._onCellClick=function(e,i){i&&i.cellModel&&i.cellView&&(t.elements.gridView.selectCell(i.cellID,!1),t.elements.popup.visibleFlag=!1,t.elements.button.checkFlag=!1,setTimeout((function(){t.elements.button.focus(),t.elements.container.removeAttribute("active"),t.elements.container.setAttribute("fakefocus",!0)}),0),t.fire("click"))},this.elements.gridView.addEventListener(n.POINTERHIT,this.elements.gridView._onCellClick,!1)}this.elements.popup.visibleFlag=!0,setTimeout((function(){t.elements.container.setAttribute("active",!0)}),0),this.elements.gridView._isReady&&this.elements.popup.focus();var f=this.elements.gridView.getCellsXSO();if(f){this._updateSelectedItemInCollectionView();var m=this;this.elements.gridView.onPostUpdateViewOnce((function(){var e=f.get();e&&e.length>0&&m.elements.gridView.ensureCellVisible(e[0])}))}},t.prototype._updateSelectedItemInCollectionView=function(){if(this.elements.gridView&&this.elements.popup.visibleFlag){var e=this.elements.gridView.getCellsXSO();if(e){var t=e.get();if(t)if(this.value){var i=this.elements.gridView.model.indexOf(this.value);if(i>-1){if(t.length>0)for(var o=0;o<t.length;o++)t[o]!==i&&e.remove(t[o]);e.add(i),this.elements.gridView.setActiveCell(i)}else e.empty(),this.elements.gridView.setActiveCell(-1)}else e.empty(),this.elements.gridView.setActiveCell(-1)}}},t.prototype.getHeaderDefaultIconName=function(e){return"string"==typeof e?e:e.iconName?e.iconName:""},t.prototype.getHeaderDefaultTooltip=function(e){return e.description?e.description:null},t.prototype.updateView=function(){this.elements.gridView&&this.elements.gridView.invalidateLayout({updateCellContent:!0})},t.prototype.destroy=function(){this.modelProvider&&this.modelProvider.removeModelEvents(this.gridViewModel),e.prototype.destroy.call(this)},t}(o);function b(e){var t;switch(e){case"left":default:t="far";break;case"right":t="near";break;case"middle":t="center"}return t}return r.addClass(S,"iconChooser"),S}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/ResponsiveCollectionView",["require","exports","UWA/Core","DS/CollectionView/CollectionView","DS/Core/PointerEvents","DS/Menu/ContextualMenu","DS/CollectionView/modelProviders/CollectionViewTreeDocumentModelProvider","DS/Utilities/Color","DS/Core/WebUXComponents","./typings/types","DS/WUXTypings/typings/UWA","DS/TreeModel/typings/types"],(function(e,t,i,o,n,l,r,s,a){"use strict";var d=function(e){},c=function(e){},u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectionManagedByView=!1,t._applyModelPending=!1,t._interactiveCumulativeSelection=!1,t}return __extends(t,e),t.prototype._disableInteractiveMultiSelMode=function(){},Object.defineProperty(t,"publishedProperties",{get:function(){return{layout:{defaultValue:null,type:"object"},height:{defaultValue:"inherit",type:"integer"},modelProvider:{defaultValue:null,type:"object"},model:{defaultValue:[],type:"array"},selectionBehavior:{defaultValue:{},type:"object"},useDragAndDrop:{defaultValue:!1,type:"boolean"},onContextualEvent:{defaultValue:void 0,type:"function",noNeedToApplyFlag:!0},onDragStartCell:{defaultValue:function(e,t){if("dragstart"===e.type&&"function"==typeof e.dataTransfer.setDragImage&&n.isLastEventTouch()){t.manager.__draggedNode&&(t.manager.__draggedNode.remove(),t.manager.__draggedNode=void 0);var i=e.target;t.manager.__draggedNode=i.cloneNode(!0),t.manager.__draggedNode.style.transform="",t.manager.__draggedNode.style.position="absolute",i.parentElement.appendChild(t.manager.__draggedNode);var o=i.getBoundingClientRect(),l=i.parentElement.getBoundingClientRect();t.manager.__draggedNode.style.zIndex="-10000000",t.manager.__draggedNode.style.left=o.left-l.left+"px",t.manager.__draggedNode.style.top=o.top-l.top+"px";var r=e.clientX-o.left,s=e.clientY-o.top;e.dataTransfer.setDragImage(t.manager.__draggedNode,r,s)}return this.onDragStartCellDefault(e,t)},type:"function"},onDragCell:{defaultValue:function(e,t){return this.onDragCellDefault(e,t)},type:"function"},onDragEndCell:{defaultValue:function(e,t){return t.manager.__draggedNode&&(t.manager.__draggedNode.remove(),t.manager.__draggedNode=void 0),this.onDragEndCellDefault(e,t)},type:"function"},onDragEnterBlank:{defaultValue:function(e,t){return this.onDragEnterBlankDefault(e,t)},type:"function"},onDragOverBlank:{defaultValue:function(e,t){return this.onDragOverBlankDefault(e,t)},type:"function"},onDragLeaveBlank:{defaultValue:function(e,t){return this.onDragLeaveBlankDefault(e,t)},type:"function"},onDragEnterCell:{defaultValue:function(e,t){return this.onDragEnterCellDefault(e,t)},type:"function"},onDragOverCell:{defaultValue:function(e,t){return this.onDragOverCellDefault(e,t)},type:"function"},onDragLeaveCell:{defaultValue:function(e,t){return this.onDragLeaveCellDefault(e,t)},type:"function"},onDropBlank:{defaultValue:function(e,t){return t.manager.__draggedNode&&(t.manager.__draggedNode.remove(),t.manager.__draggedNode=void 0),this.onDropBlankDefault(e,t)},type:"function"},onDropCell:{defaultValue:function(e,t){return t.manager.__draggedNode&&(t.manager.__draggedNode.remove(),t.manager.__draggedNode=void 0),this.onDropCellDefault(e,t)},type:"function"},allowUnsafeHTMLContent:{defaultValue:void 0,type:"boolean",noNeedToApplyFlag:!0},shouldCellAllowUnsafeHTMLContentAt:{defaultValue:function(e,t){return this.allowUnsafeHTMLContent},type:"function",noNeedToApplyFlag:!0}}},enumerable:!1,configurable:!0}),t.prototype.onDragStartCellDefault=function(e,t){var i=t.nodeModel,o=t.manager,n=o.getNodesXSO().isIn(i),l=o.modelProvider;if(l.shouldAcceptDrag(i)&&n){var r=o.getNodesXSO().get().map((function(e){return l.dumpNodeModel(e)})),s={identifier:o.identifier,draggedNode:l.dumpNodeModel(i),selectedNodes:r};e.dataTransfer.setData("Text",JSON.stringify(s)),e.dataTransfer.effectAllowed="move"}else e.preventDefault();e._webUXpreventDefault=e.defaultPrevented},t.prototype.onDragCellDefault=function(e,t){e._webUXpreventDefault=e.defaultPrevented},t.prototype.onDragEnterBlankDefault=function(e,t){t.manager._getScroller().getContent().addClassName("wux-ui-state-drag-over"),e._webUXpreventDefault=e.defaultPrevented},t.prototype.onDragLeaveBlankDefault=function(e,t){this&&this._hideDndFeedbacks(),t.manager._getScroller().getContent().removeClassName("wux-ui-state-drag-over"),e._webUXpreventDefault=e.defaultPrevented},t.prototype.onDragEnterCellDefault=function(e,t){e.preventDefault(),e._webUXpreventDefault=e.defaultPrevented},t.prototype.onDragOverCellDefault=function(e,t){this&&this._showDndFeedbacks(e,t),e.preventDefault(),e._webUXpreventDefault=e.defaultPrevented},t.prototype.onDragLeaveCellDefault=function(e,t){this&&this._hideDndFeedbacks(),e.preventDefault(),e._webUXpreventDefault=e.defaultPrevented},t.prototype.onDragOverBlankDefault=function(e,t){this&&this._showDndFeedbacks(e,t),e.preventDefault(),e._webUXpreventDefault=e.defaultPrevented},t.prototype.onDragEndCellDefault=function(e,t){this&&this._hideDndFeedbacks(),e.preventDefault(),e._webUXpreventDefault=e.defaultPrevented},t.prototype.onDropBlankDefault=function(e,t){return this&&this._hideDndFeedbacks(),t.manager._getScroller().getContent().removeClassName("wux-ui-state-drag-over"),e.preventDefault(),e._webUXpreventDefault=e.defaultPrevented,!1},t.prototype.onDropCellDefault=function(e,t){return this&&this._hideDndFeedbacks(),e.preventDefault(),e._webUXpreventDefault=e.defaultPrevented,!1},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("modelProvider")&&this._applyModelProvider(t.modelProvider),this._applyModel(t.model),this.isDirty("useDragAndDrop")&&this._applyUseDragAndDrop(t.useDragAndDrop)},t.prototype._applyUseDragAndDrop=function(e){this.useDragAndDrop!==e&&this._processPoolCells((function(e){var t=e.cellView.component;t&&(!0===this.useDragAndDrop?t.elements.container.setAttribute("draggable","true"):t.elements.container.setAttribute("draggable","false"))}))},t.prototype.getTreeDocument=function(){return this.applicativeModel?this.applicativeModel:e.prototype.getTreeDocument.call(this)},t.prototype._applyModelProvider=function(e){if(!this.modelProvider)throw new Error("modelProvider is mandatory for CollectionView model representation. Please provide a not null modelProvider.");this.modelProvider.collectionView=this},t.prototype._applyModel=function(t){if(this.model!==t){if(!0===this._applyModelPending)return;if(this._applyModelPending=!0,!this.dataSource)if(this.applicativeModel)this.model instanceof this.modelProvider.getModelClass()&&(this._removeModelEvents(),this.activeNode=null,this.TreedocModel=null,this.applicativeModel=null,this.loadApplicativeModel(this.model),this.setScrollerPosition({x:0,y:0})),this.model||(this.unloadApplicativeModel(),this.setScrollerPosition({x:0,y:0}));else if(this.model instanceof this.modelProvider.getModelClass())this.loadApplicativeModel(this.model);else if(this.model&&0!==this.model.length){var i=new(this.modelProvider.getModelClass());this.modelProvider.fillApplicativeModelFromViewModel(i,this.model),this.loadApplicativeModel(i)}e.prototype._applyModel.call(this,t),this._applyModelPending=!1}},t.prototype._preBuildView=function(t){this._xsoEventsListener=[],this.modelProvider=new r,this._needToSelectAtRelease=!1,e.prototype._preBuildView.call(this,t),this._properties.selectionBehavior.value={unselectAllOnEmptyArea:!0,toggle:!0,canMultiSelect:!0,canInteractiveMultiselectWithCheckboxClick:!0,enableShiftSelection:!0,enableFeedbackForActiveCell:!0}},t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-layouts-responsivecollectionview")},t.prototype._manageKeyboard=function(){e.prototype._manageKeyboard.call(this);var t=this.commands.shiftUp,o=this.commands.shiftRight,n=this.commands.shiftDown,l=this.commands.shiftLeft,r=this.commands.shiftPageup,s=this.commands.shiftPagedown,a=this.commands.shiftHome,d=this.commands.shiftEnd,c=Object.assign({},this.commands);i.extend(c,{copy:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"copy",data:e?e.get():null})},paste:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"paste",data:e?e.get():null})},cut:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"cut",data:e?e.get():null})},escape:function(e){return this._modelEvents.publish({event:"escapeKeyPressed",data:{event:e}}),{stopPropagation:!1}},deleteKeyPressed:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"deleteKeyPressed",data:e?e.get():null})},spaceKeyPressed:function(){this.activeNode&&(this.modelProvider.isNodeSelected(this.activeNode)?this.modelProvider.unSelectNode(this.activeNode):this.modelProvider.selectNode(this.activeNode))},ctrlSpaceKeyPressed:function(){this.activeNode&&(this.modelProvider.isNodeSelected(this.activeNode)?this.modelProvider.unSelectNode(this.activeNode):this.modelProvider.selectNode(this.activeNode))},tab:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"tab",data:e?e.get():null})},shiftTab:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"tab",data:e?e.get():null})},f2:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"f2",data:e?e.get():null})},enter:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"enter",data:e?e.get():null})},upMove:function(){var e=this.computeCellIDFromActiveCell("up");return this.selectCell(e,!1,!1),{preventDefault:!0}},rightMove:function(){var e=this.computeCellIDFromActiveCell("right");return this.selectCell(e,!1,!1),{preventDefault:!0}},downMove:function(){var e=this.computeCellIDFromActiveCell("down");return this.selectCell(e,!1,!1),{preventDefault:!0}},leftMove:function(){var e=this.computeCellIDFromActiveCell("left");return this.selectCell(e,!1,!1),{preventDefault:!0}},shiftUp:function(){this._modeIsShiftSel?t.call(this):this.commands.upMove.call(this)},shiftRight:function(){this._modeIsShiftSel?o.call(this):this.commands.rightMove.call(this)},shiftDown:function(){this._modeIsShiftSel?n.call(this):this.commands.downMove.call(this)},shiftLeft:function(){this._modeIsShiftSel?l.call(this):this.commands.leftMove.call(this)},shiftPageup:function(){this._modeIsShiftSel?r.call(this):this.commands.pageup.call(this)},shiftPagedown:function(){this._modeIsShiftSel?s.call(this):this.commands.pagedown.call(this)},shiftHome:function(){this._modeIsShiftSel?a.call(this):this.commands.home.call(this)},shiftEnd:function(){this._modeIsShiftSel?d.call(this):this.commands.end.call(this)}}),this.commands=c},t.prototype._postBuildView=function(){e.prototype._postBuildView.call(this),this._onGutterOrMarginsChange()},t.prototype._handleEvents=function(){e.prototype._handleEvents.call(this);var t=this;t.addEventListener(n.POINTERDOWN,t._onCellPointerDown,!1),t.addEventListener("click",t._onCellClick,!1),this._observeDragAndDropEvents(),this._observeSelMultiSel(),this._observeDoubleClickEvent(),this._observeContextualMenuEvent()},t.prototype.supportsKeyboardNavigation=function(){return!0},t.prototype.getUsedCellPreselectionFeedback=function(){if(void 0===this._usedCellPreselectionFeedback){var e=this.cellPreselectionFeedback;"none"!==e&&(e="cell"),this._usedCellPreselectionFeedback=e}return this._usedCellPreselectionFeedback},t.prototype.supportsSelection=function(){return!0},t.prototype.getNodesXSO=function(){return this.modelProvider.getNodesXSO()},t.prototype.getNodeModelCountPerRow=function(){return this.layout?this.layout._numberOfColumns:0},t.prototype.loadApplicativeModel=function(e){if(e){if(this.applicativeModel===e)return;this.applicativeModel=e,this.TreedocModel=e,this.model=this.modelProvider.flattenApplicativeModel(e),this.model&&this.model.length&&(this.lastSelectedNode=this.model[0],this.activeNode=null),this._addModelEvents()}},t.prototype.unloadApplicativeModel=function(){this._removeModelEvents(),this.activeNode=null,this.applicativeModel=null,this.TreedocModel=null,this.model=[]},t.prototype.loadGridViewModel=function(e){this.loadApplicativeModel(e),e&&(this.TreedocModel=e)},t.prototype.unloadGridViewModel=function(){this.unloadApplicativeModel(),this.TreedocModel=null},t.prototype.requestDelayedModelData=function(e,t){if(this.onDelayedModelDataRequest){var i=this,o=this.layout,n=i.getViewportDimensions();if(n.height>0){var l=o._computeMinCellID(),r=l+Math.floor((n.width-i.layout.gutter-i.layout.layoutMargins.marginLeft-i.layout.layoutMargins.marginRight)/(i.layout._getColumnWidth()+i.layout.gutter))*Math.ceil((n.height-i.layout.gutter-i.layout.layoutMargins.marginTop-i.layout.layoutMargins.marginBottom)/(i.layout.getRowHeight()+i.layout.gutter))-1,s=i.getTreeDocument();s&&s.prepareUpdate(),i.onDelayedModelDataRequest({collectionView:i,startNodeIndex:l,endNodeIndex:r,context:e}),s&&s.pushUpdate()}}},t.prototype.pushUpdateView=function(e,t){this.modelProvider&&this.modelProvider._pushUpdateView(e,t)},t.prototype.updateView=function(e){this.modelProvider&&this.modelProvider.updateView(e)},t.prototype.onSelectionAdd=function(e){return this._modelEvents.subscribe({event:"selectionAdded"},e)},t.prototype.onSelectionRemove=function(e){return this._modelEvents.subscribe({event:"selectionRemoved"},e)},t.prototype.onCellDoubleClick=function(e){return this._modelEvents.subscribe({event:"dblclick"},e)},t.prototype.onCellTitleClick=function(e){return this._modelEvents.subscribe({event:"cellTitleClick"},e)},t.prototype.onCellsCopy=function(e){return this._modelEvents.subscribe({event:"copy"},e)},t.prototype.onCellsPaste=function(e){return this._modelEvents.subscribe({event:"paste"},e)},t.prototype.onCellsCut=function(e){return this._modelEvents.subscribe({event:"cut"},e)},t.prototype.onCellsEscape=function(e){return this._modelEvents.subscribe({event:"escapeKeyPressed"},e)},t.prototype.onEnterPressed=function(e){return this._modelEvents.subscribe({event:"enter"},e)},t.prototype.onDeleteKeyPressed=function(e){return this._modelEvents.subscribe({event:"deleteKeyPressed"},e)},t.prototype.onTabKeyPressed=function(e){return this._modelEvents.subscribe({event:"tab"},e)},t.prototype.onf2Pressed=function(e){return this._modelEvents.subscribe({event:"f2"},e)},t.prototype.onInteractiveCumulativeSelectionChanged=function(e){return this._modelEvents.subscribe({event:"interactiveCumulativeSelectionChanged"},e)},t.prototype.selectCell=function(t,i,o){this.keyboardMutePoolrefresh=!0,!0===o&&(this._shiftKeyboardSelection=!0),e.prototype.selectCell.call(this,t,i,o),this.keyboardMutePoolrefresh=!1,this._shiftKeyboardSelection=!1,t>=0&&t<this.model.length&&this._setActiveNode(this.model[t],!0),o||(this.lastSelectedNode=this.activeNode)},t.prototype.selectNodeModel=function(e,t,i){if(e){var o=this,n=this.layout;if(i){var l=n.computeCellRange(this.modelProvider.getNodeModelRowID(o.lastSelectedNode,!0),this.modelProvider.getNodeModelRowID(e,!0));if(l){var r=this.getNodesXSO();if(r){var s=[];r.get().forEach((function(t){n.isNodeModelInRange(t,o.modelProvider.getNodeModelRowID(o.lastSelectedNode),o.modelProvider.getNodeModelRowID(e))||s.push(t)})),s.length>0&&r.remove(s);for(var a=[],d=0;d<l.length;d++){var c=this.getNodeModelAt(l[d]);c&&!r.isIn(c)&&a.push(c)}a.length>0&&r.add(a)}}}else t?this.modelProvider.selectNode(e):this.modelProvider.selectNode(e,!0)}},t.prototype.selectAllVisibleNodes=function(){if(!0===this.selectionBehavior.canMultiSelect)return this.modelProvider.selectAllVisibleNodes()},t.prototype.unselectAll=function(){return this.modelProvider.unselectAll()},t.prototype.setActiveNode=function(e,t){return this._setActiveNode(e,t)},t.prototype.getLabel=function(e){return this.modelProvider.getPropertyValue(e,"label")},t.prototype.getBadges=function(e){return this.modelProvider.getPropertyValue(e,"badges")},t.prototype.getDisabled=function(e){return this.modelProvider.getPropertyValue(e,"disabled")},t.prototype.getSubLabel=function(e){return this.modelProvider.getPropertyValue(e,"subLabel")},t.prototype.getDescription=function(e){return this.modelProvider.getPropertyValue(e,"description")},t.prototype.getCustomTooltip=function(e){return this.modelProvider.getPropertyValue(e,"customTooltip")},t.prototype.getMultipleTitleLineNumber=function(e){return this.modelProvider.getPropertyValue(e,"multipleTitleLineNumber")},t.prototype.getPropertiesList=function(e){return this.modelProvider.getPropertyValue(e,"propertiesList")},t.prototype.getThumbnail=function(e){return this.modelProvider.getPropertyValue(e,"picture")},t.prototype.getIcon=function(e){return this.modelProvider.getPropertyValue(e,"icon")},t.prototype.getStatusbarIconsTooltips=function(e){return this.modelProvider.getPropertyValue(e,"statusbarIconsTooltips")},t.prototype.getStatusbarIcons=function(e){return this.modelProvider.getPropertyValue(e,"statusbarIcons")},t.prototype.getStatusbarLabelsWidthRatios=function(e){return this.modelProvider.getPropertyValue(e,"statusbarLabelsWidthRatios")},t.prototype.getActiveFlag=function(e){return this.modelProvider.getPropertyValue(e,"activeFlag")},t.prototype.getEmptyStatusbarVisibleFlag=function(e){return this.modelProvider.getPropertyValue(e,"emptyStatusbarVisibleFlag")},t.prototype.getContextualMenu=function(e){return this.modelProvider.getPropertyValue(e,"contextualMenu")},t.prototype.getColor=function(e){return this.modelProvider.getPropertyValue(e,"color")},t.prototype.getClickableTitle=function(e){return this.modelProvider.getPropertyValue(e,"clickableTitle")},t.prototype._applyCssClassesOnCell=function(e){},t.prototype._addModelEvents=function(){var e=this;if(!this._modelEventsAlreadyAdded){this._modelEventsAlreadyAdded=!0;var t=this.getNodesXSO();if(t){var i=t.onAdd((function(t){e._onXSOAdd(t)}));this._xsoEventsListener.push(i),i=t.onPostAdd((function(t){e._onXSOPostAdd(t)})),this._xsoEventsListener.push(i),i=t.onRemove((function(t){e._onXSORemove(t)})),this._xsoEventsListener.push(i),i=t.onPostRemove((function(t){e._onXSOPostRemove(t)})),this._xsoEventsListener.push(i),this._modelEvents.subscribe({event:"active"},(function(t){e._updateAllPoolSelectedViews()}))}return this.modelProvider.addModelEvents()}},t.prototype._removeModelEvents=function(){this._modelEventsAlreadyAdded=!1;var e=this.getNodesXSO();if(e){for(var t=0;t<this._xsoEventsListener.length;t++)e.unsubscribe(this._xsoEventsListener[t]);this._xsoEventsListener.splice(0,this._xsoEventsListener.length)}return this.modelProvider.removeModelEvents()},t.prototype._observeSelMultiSel=function(){var e=this;e._isInteractiveMultiSelMode=!1,e._modeIsMultiSel=!1,e._modeIsShiftSel=!1,i.Element.addEvent.call(document,"keydown",(function(t){var o=i.Event.whichKey(t);!e.selectionBehavior.enableShiftSelection||"shift"!==o&&"ctrl+shift"!==o&&"meta+["!==o?!e.selectionBehavior.canMultiSelect||"ctrl"!==o&&"shift+ctrl"!==o&&"meta+["!==o||(e._modeIsMultiSel=!0,e._modeIsShiftSel=!1,e._combinedSelModifiers="shift+ctrl"===o):(e._modeIsShiftSel=!0,e._modeIsMultiSel=!1,e._combinedSelModifiers="ctrl+shift"===o),"ctrl+pageup"!==o&&"ctrl+pagedown"!==o||t.preventDefault()})),i.Element.addEvent.call(document,"keyup",(function(t){var o=i.Event.whichKey(t);"ctrl"!==o&&"meta+["!==o||(e._modeIsMultiSel=!1),"shift"!==o&&"meta+["!==o||(e._modeIsShiftSel=!1),"ctrl+shift"===o&&(e._modeIsShiftSel=!1,e._modeIsMultiSel=e.selectionBehavior.canMultiSelect,e._combinedSelModifiers=!0),"shift+ctrl"===o&&(e._modeIsMultiSel=!1,e._modeIsShiftSel=e.selectionBehavior.enableShiftSelection,e._combinedSelModifiers=!1)}))},t.prototype._observeDoubleClickEvent=function(){var e=this;this.elements.container.addEventListener(n.POINTERHIT,(function(t){if(2===t.multipleHitCount){var i=e._firstParentWithClass(t.target,"wux-layouts-collectionview-cell");if(1===t.which&&i){var o=e.getCellInfosFromHtmlElement(i);o.event=t,void 0!==o.cellModel&&e._modelEvents.publish({event:"dblclick",context:o.cellModel,data:o})}}}))},t.prototype._observeContextualMenuEvent=function(){var e=this,t=e.onContextualEvent;t&&l.addEventListener(this.elements.container,{callback:function(i){var o=Boolean(e._cellCtxMenuRequired);return e._cellCtxMenuRequired=!1,o?[]:t.callback.call(t.this,{context:i.context,infos:i.info,data:i.data,cellInfos:void 0,infoContext:i.context})}})},t.prototype._firstParentWithClass=function(e,t){var i=e;if(i)return(" "+i.className+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1?i:this._firstParentWithClass(i.parentNode,t)},t.prototype._onCellClickForTouchOrPointerDownForMouse=function(e,t,i){e._cellUISelectionAction=!0;var o=e.getNodesXSO();if(o)if(t&&t.cellView){if(e._needToSelectAtRelease=!1,e._pointerDownOnBlank=!1,e.getDisabled(t.nodeModel))return e._isInMultiSelection()||e._modeIsShiftSel||o.empty(),e._setActiveNode(t.cellModel,!0),e._modeIsShiftSel||(e.lastSelectedNode=t.cellModel),void(e._cellUISelectionAction=!1);if(e.modelProvider.isNodeSelected(t.cellModel)&&!e._modeIsShiftSel){if(!n.isTouchEvent(i))return e._needToSelectAtRelease=!0,void(e._cellUISelectionAction=!1);e.selectionBehavior.toggle&&e.modelProvider.unSelectNode(t.cellModel),e._cellUISelectionAction=!1}else e._isInMultiSelection()||e._modeIsShiftSel||this._combinedSelModifiers||o.empty(),e.modelProvider.selectNode(t.cellModel),e._setActiveNode(t.cellModel,!1),e._modeIsShiftSel||(e.lastSelectedNode=t.cellModel),e._cellUISelectionAction=!1;if(e._modeIsShiftSel){e._cellUISelectionAction=!0,e._shiftKeyboardSelection=!0,this._combinedSelModifiers||o.empty();var l=e.lastSelectedNode,r=t.cellModel;if(l&&r){var s=e.modelProvider.getNodeModelRowID(l,!0),a=e.modelProvider.getNodeModelRowID(r,!0),d=a>s?s:a,c=d===s?a:s,u=e.model,h=0,p=[];for(h=d;h<=c;h++){var g=this._rowModel?this._rowModel._getNodeModelAtRowID(h):u[h];!e.modelProvider.isNodeVisible(g)||e.modelProvider.isNodeSelected(g)||e.getDisabled(g)||p.push(g)}o.add(p),e._setActiveNode(t.cellModel,!1)}e._shiftKeyboardSelection=!1,e._cellUISelectionAction=!1}}else e._cellUISelectionAction=!1,e._pointerDownOnBlank=!0,n.isTouchEvent(i)&&e._onClickOnEmptyArea(e,i)},t.prototype._onCellPointerDown=function(e,t){var i=e.dsModel;if(i.getNodesXSO()&&!(n.isTouchEvent(e)||i.selectionBehavior&&i.selectionBehavior.selectOnPointerUp))return i._onCellClickForTouchOrPointerDownForMouse(i,t,e)},t.prototype._onClickOnEmptyArea=function(e,t){var i=e.getNodesXSO();if(i&&!0===e.selectionBehavior.unselectAllOnEmptyArea){e._cellUISelectionAction=!0;var o=e.getViewportDimensions(),n=e.layout.getContentDimensions(),l=0;t.target===e.elements.scroller.getContent()&&("vertical"===e.layout.direction?l=o.height<n.height?18:0:"horizontal"===e.layout.direction&&(l=o.width<n.width?18:0));var r=Math.max(n.width,o.width-l),s=Math.max(n.height,o.height-l);t.offsetX<r&&t.offsetY<s&&(e._disableInteractiveMultiSelMode(),i.empty(),e._updatePoolSelectedViews()),e._cellUISelectionAction=!1}},t.prototype._onCellClick=function(e,t){var i=e.dsModel,o=i.getNodesXSO();if(o)return n.isTouchEvent(e)||i.selectionBehavior&&i.selectionBehavior.selectOnPointerUp?i._onCellClickForTouchOrPointerDownForMouse(i,t,e):void(t&&t.cellView?(i._cellUISelectionAction=!0,i._pointerDownOnBlank=!1,!0===i._needToSelectAtRelease&&(!1===i._isInMultiSelection()?(o.empty(),i.selectionBehavior.toggle?i._setActiveNode(t.cellModel,!0):(i.modelProvider.selectNode(t.cellModel),i.lastSelectedNode=t.cellModel,i._setActiveNode(t.cellModel,!1))):i.selectionBehavior.toggle&&i.modelProvider.unSelectNode(t.cellModel)),i._cellUISelectionAction=!1,i._needToSelectAtRelease=!1):(i._pointerDownOnBlank&&i._onClickOnEmptyArea(i,e),i._pointerDownOnBlank=!1))},t.prototype._isInMultiSelection=function(){return this._modeIsMultiSel||this._isInteractiveMultiSelMode},t.prototype._getNewActiveNodeInfos=function(e,t){for(var i=this,o=i.modelProvider.getNodeModelRowID(e,!0),n=o+t,l=0!==t?void 0:e,r=Math.ceil(i.model.length/i.layout._numberOfColumns),s=Math.ceil((o+1)/i.layout._numberOfColumns),a=i.layout._numberOfColumns===t&&r===s||-i.layout._numberOfColumns===t&&1===s;0!==t&&(l=n<i.model.length?i.model[n]:void 0,!a)&&!l;)t>0?(t--,n--):(t++,n++);return{index:n,node:l}},t.prototype._onCellTitleClick=function(e){this._modelEvents.publish({event:"cellTitleClick",context:e,data:e})},t.prototype._computeIncrementToMove=function(e){var t=this,i=t.activeNode?t.activeNode:t.lastSelectedNode;if(i){var o=t.modelProvider.getNodeModelRowID(i,!0),n=t.getScrollerPosition(),l=t._getScroller().getContent().getDimensions(),r=n.y,s=n.x,a=void 0,d=void 0;"vertical"===t.layout.direction?(a=Math.round(l.height/(t.layout.getRowHeight()+t.layout.gutter)),d=t.layout._numberOfColumns):"horizontal"===t.layout.direction&&(a=t.layout._numberOfRows,d=Math.round(l.width/(t.layout._columnWidth+t.layout.gutter)));var c=0,u=0,h=0,p=1,g=0;if("vertical"===t.layout.direction?(u=(o-o%t.layout._numberOfColumns)*(t.layout.getRowHeight()+t.layout.gutter)/t.layout._numberOfColumns-r,h=Math.round(u/(t.layout.getRowHeight()+t.layout.gutter))):"horizontal"===t.layout.direction&&(u=(o-o%t.layout._numberOfRows)*(t.layout._columnWidth+t.layout.gutter)/t.layout._numberOfRows-s,h=Math.round(u/(t.layout._columnWidth+t.layout.gutter))),"up"===e){if("vertical"===t.layout.direction)return-d;if("horizontal"===t.layout.direction)return-1}else if("right"===e){if("vertical"===t.layout.direction)return 1;if("horizontal"===t.layout.direction)return a}else if("down"===e){if("vertical"===t.layout.direction)return d;if("horizontal"===t.layout.direction)return 1}else if("left"===e){if("vertical"===t.layout.direction)return-1;if("horizontal"===t.layout.direction)return-a}else{if("home"===e)return-o;if("end"===e)return t.model.length-1-o;if("pageup"===e){if("vertical"===t.layout.direction){if(0===(c=-h*t.layout._numberOfColumns)){for(p=1,g=0,p=1;p<=a-1;p++)if(g=p,o-t.layout._numberOfColumns*p<0){g--;break}c=-t.layout._numberOfColumns*g}}else if("horizontal"===t.layout.direction&&0===(c=-h*t.layout._numberOfRows)){for(p=1,g=0,p=1;p<=d-1;p++)if(g=p,o-t.layout._numberOfRows*p<0){g--;break}c=-t.layout._numberOfRows*g}return c}if("pagedown"===e){if("vertical"===t.layout.direction){if(0===(c=(a-h-1)*t.layout._numberOfColumns)){for(p=1,g=0,p=1;p<=a-1;p++)if(g=p,o+t.layout._numberOfColumns*p>=t.model.length){g--;break}0===(c=t.layout._numberOfColumns*g)&&(t.model.length-1)%t.layout._numberOfColumns<o%t.layout._numberOfColumns&&(c=t.layout._numberOfColumns)}}else if("horizontal"===t.layout.direction&&0===(c=(d-h-1)*a)){for(p=1,g=0,p=1;p<=d-1;p++)if(g=p,o+t.layout._numberOfRows*p>=t.model.length){g--;break}c=t.layout._numberOfRows*g}return c}}}return 0},t.prototype.computeCellIDFromActiveCell=function(e,t,i){var o=this,n=-1,l=o.activeNode?o.activeNode:o.lastSelectedNode;if(l){var r=o._computeIncrementToMove(e),s=o._getNewActiveNodeInfos(l,r);s.node&&(n=s.index)}return n},t.prototype._setActiveNode=function(e,t){if(this.activeNode!==e){this.activeNode=e;var i=-1;if(e){if(!((i=this.modelProvider.getNodeModelRowID(e,!0))<this.model.length))return;this.setActiveCell(i)}!0===t&&this.selectionBehavior.enableFeedbackForActiveCell&&this._modelEvents.publish({event:"active",context:e})}},t.prototype.setActiveCell=function(t,i,o){var n=!1;if(-1!==t){n=e.prototype.setActiveCell.call(this,t);var l=this.getNodeModelAt(t);this._setActiveNode(l,!0)}return n},t.prototype.isCellHighlighted=function(e){var t=e.cellID>=0?this.getCellInfosAt(e.cellID):e;return!(!t.nodeModel||!t.nodeModel.isHighlighted)&&t.nodeModel.isHighlighted()},t.prototype._updatePoolSelectedViews=function(e){this._processPoolCells((function(e){var t=e.cellView.component.collectionView,i=e.cellView.component;if(i){var o=t.getCellInfosFromHtmlElement(i.elements.container);if(o){var n=o.cellModel;void 0!==n&&(this.selectionBehavior.enableFeedbackForActiveCell&&(n===this.activeNode?i.contentView&&i.contentView.activate&&i.contentView.activate():i.contentView&&i.contentView.deactivate&&i.contentView.deactivate()),this._applyAttributesOnCell(o),this.modelProvider.isNodeSelected(n)?i.contentView&&i.contentView.highlight&&i.contentView.highlight():i.contentView&&i.contentView.unhighlight&&i.contentView.unhighlight())}}}))},t.prototype._updateAllPoolSelectedViews=function(){this._processPoolCells((function(e){var t=e.cellView.component.collectionView,i=e.cellView.component;if(i){var o=t.getCellInfosFromHtmlElement(i.elements.container);if(o){var n=o.cellModel;void 0!==n&&(this.selectionBehavior.enableFeedbackForActiveCell&&(n===this.activeNode?i.contentView&&i.contentView.activate&&i.contentView.activate():i.contentView&&i.contentView.deactivate&&i.contentView.deactivate()),this._applyAttributesOnCell(o),t.modelProvider.isNodeSelected(n)?i.contentView&&i.contentView.highlight&&i.contentView.highlight():i.contentView&&i.contentView.unhighlight&&i.contentView.unhighlight())}}}))},t.prototype._observeDragAndDropEvents=function(){this.elements.container.addEvent("dragstart",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("drop",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("dragover",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("drag",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("dragend",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("dragleave",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("dragenter",this._processDragAndDropCallback.bind(this))},t.prototype._processDragAndDropCallback=function(e){var t=this,i=this._firstParentWithClass(e.target,"wux-layouts-collectionview-cell"),o={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"}[e.type],n={manager:this};if(i){n=t.getCellInfosFromHtmlElement(i);var l=function(e,t){var i;if(t.cellView){var o=t.cellView.getContent().getBoundingClientRect();i=e.clientX<o.left+o.width/10?"left":e.clientX>=o.left+9*o.width/10?"right":"middle"}return i}(e,n);n.dropPosition=l}function r(i,o){var l=!1,r=t[i+o];r?(l=r.call(n.manager,e,n),"onDragOver"!==i&&d("[dnd]",i+o,">",l,e.target)):d("[dnd]","cannot find",i+o,"callback");var s=t[i+o+"Default"];s&&(void 0===r||r&&l)&&(d("\t>[dnd]",r&&l?"dev want to continue to the default behavior for ":"use the default behavior for ",i+o," callback"),s.call(n.manager,e,n))}n.cellView?r(o,"Cell"):r(o,"Blank")},t.prototype._isOverBlank=function(e,t){var i=!0;if(t.cellView){var o=t.cellView.getContent().getBoundingClientRect();e.clientX<o.left||e.clientX>o.left+o.width||e.clientY<o.top||e.clientY>o.top+o.height||(i=!1)}return i},t.prototype._hideDndFeedbacks=function(){this&&this._dnDInfos&&this._dnDInfos.elements&&this._dnDInfos.elements.dndFeedback&&this._dnDInfos.elements.dndFeedback.hide()},t.prototype.getCellViewMinWidth=function(){return 150},t.prototype.getCellViewMinHeight=function(){},t.prototype._showDndFeedbacks=function(e,t){if(this&&void 0!==t.cellID){this._dnDInfos||(this._dnDInfos={elements:{dndFeedback:null},dropAccepted:!1}),this._dnDInfos.elements.dndFeedback||(this._dnDInfos.elements.dndFeedback=new i.Element("div",{class:"wux-layouts-responsivecollectionview-drag-item-feedback"}),this._dnDInfos.elements.dndFeedback.inject(this.getContent()));var o,n=this.layout,l=this.elements.container.getBoundingClientRect(),r=t.cellView.getContent().getBoundingClientRect(),a=t.dropPosition,d=r.height,c=-l.top+r.top,u=-l.left+r.left;"left"===a?(c+=-1-n.gutter/2+1,u+=-1-n.gutter/2,d+=n.gutter,o=2):"right"===a?(c+=-1-n.gutter/2+1,u+=-1+r.width+n.gutter/2,d+=n.gutter,o=2):o=r.width;var h=!0,p=this.getTreeDocument();p&&p.options&&"function"==typeof p.options.shouldAcceptDrop&&(h=p.options.shouldAcceptDrop(t)),this._dnDInfos.elements.dndFeedback.setStyles({display:"block",left:u,top:c,width:o,height:d,border:"none",background:h?s.COLORS_3DEXPERIENCE.COLOR_DARK_BLUE:s.COLORS_3DEXPERIENCE.COLOR_DARK_RED})}},t.prototype._onGutterOrMarginsChange=function(){var e=this.layout.layoutMargins.marginLeft+this.layout.gutter+this.getCellViewMinWidth()+this.layout.gutter+this.layout.layoutMargins.marginRight;this.getContent().style.minWidth=e.toString()+"px"},t.prototype._updateModel=function(){if(this.modelProvider){var e=this._getCurrentPaginationOptions(),t=this.modelProvider.flattenApplicativeModel(this.applicativeModel),i=[];if(t){if(e)for(var o=e.nodeMax-e.nodeMin+1,n=e.nodeMin;n<t.length&&(t[n]&&t[n].isVisible()&&i.push(t[n]),i.length!==o);n++);else i=t;this.model=i,this.invalidateLayout({updateCellContent:!0})}}},t.prototype._getCurrentPaginationOptions=function(){var e;if(this.paginationManager){e={};var t=this.paginationManager.pageSize;e.nodeMin=(this.paginationManager.currentPage-1)*t,e.nodeMax=e.nodeMin+t-1,e.currentPage=this.paginationManager.currentPage,e.pageSize=t}return e},t.prototype.getModelLength=function(){if(this._getCurrentPaginationOptions()){if(this._onPaginationChangeAsyncLoadModelCB)return this._asyncPaginationInitialized?this.getWholeModelLengthForAsyncPagination():0;var t=[];return this.modelProvider&&(t=this.modelProvider.flattenApplicativeModel(this.applicativeModel)),t?t.length:0}return e.prototype.getModelLength.call(this)},t.prototype._hasUniformRowHeight=function(){return!0},t.prototype._onXSOAdd=function(e){c("onAdd"),this.modelUISelectionAction=!0,this._modelEvents.publish({event:"selectionAdded",context:e,data:e}),this.activeNode&&this.modelProvider.isNodeSelected(this.activeNode)||this._shiftKeyboardSelection||this._setActiveNode(e)},t.prototype._onXSOPostAdd=function(e){this._updatePoolSelectedViews(e),this.modelUISelectionAction=!1},t.prototype._onXSORemove=function(e){c("onRemove"),this.modelUISelectionAction=!0,this._modelEvents.publish({event:"selectionRemoved",context:e,data:e})},t.prototype._onXSOPostRemove=function(e){this._updatePoolSelectedViews(e),this.modelUISelectionAction=!1},t.prototype._onPrivateScrollEnd=function(){!this._renderingTaskInterrupted&&this.elements&&this.elements.container&&this._onAllCellsRendered()},t.prototype._endRendering=function(t){e.prototype._endRendering.call(this,t),this._activeScroller||this._onAllCellsRendered()},t.prototype._onPrivateReady=function(){this._onAllCellsRendered()},t.prototype._updateHighlight=function(e){if(this.currentlyFindingString()){var t=this._computeHighlightModelForFind(e);e.cellView.contentView._setHighlightModel&&e.cellView.contentView._setHighlightModel(t)}},t}(o);return u.prototype.blackBoxFlag=!0,a.addClass(u,"ResponsiveCollectionView"),u}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/ResponsiveTweakersCollectionView",["require","exports","DS/CollectionView/ResponsiveCollectionView","DS/Core/WebUXComponents","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Tweakers/TypeRepresentationFactory","DS/Utilities/TouchUtils","./typings/types"],(function(e,t,i,o,n,l,r){"use strict";var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getRowHeight=function(){var t=this.collectionView.getTypeRepresentationFactory(),i=this.collectionView.getCellTypeRepresentation({}),o=this.collectionView.touchMode;void 0===o&&(o=r.getTouchMode());var n={touchMode:o,typeRep:t.getRegisteredTypeRepresentation(i)},l=t.getTweakerStaticHeight(n,this._columnWidthUsedForRowHeight);return!l||l instanceof Promise?e.prototype.getRowHeight.call(this):l},t}(n);o.addClass(s,"ResponsiveTweakersCollectionViewLayout");var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getCellTypeRepresentation=function(e){return"string"},t.getCellValue=function(e){var t;return null===(t=null==e?void 0:e.cellModel)||void 0===t?void 0:t.getAttributeValue("label")},t}return __extends(t,e),t.prototype._preBuildView=function(t){this._properties.layout.value||(this._properties.layout.value=new s({columnMaxWidth:320,gutter:5})),e.prototype._preBuildView.call(this,t)},t.prototype._getCellSemantics=function(e){},t.prototype._getTypeRepAndValue=function(e){return{useTweaker:!0,typeRepresentation:this.getCellTypeRepresentation(e),value:this.getCellValue(e)}},t.prototype._postBuildView=function(){e.prototype._postBuildView.call(this),this.onCellRequest(this._setTweakerForCell.bind(this))},t.prototype._getCellValueAsStringForFind=function(e){var t=this.getCellTypeRepresentation(e),i=this.getTypeRepresentationFactory(),o={touchMode:this._getCurrentTouchMode(),readOnly:!this.isCellInEdition(e.cellID),semantics:{showReferenceValueFlag:this.showModelChangesFlag}},n=i.getRegisteredTypeRepresentation(t);n||(n={semantics:{possibleValues:i.getRegisteredEnum(t)}}),n.semantics&&(n.semantics.possibleValues&&(o.semantics.possibleValues=n.semantics.possibleValues),n.semantics.valueType&&(o.semantics.valueType=n.semantics.valueType)),o.typePath=t,o.context="inlinedTemplate",o.semantics.executionContext||(o.semantics.executionContext=e);var r=i._getTypeData(o.typePath,o.semantics,e.cellModel),s=l.getTemplateIdentifierFromTypeRep(r.typeRep,o.context),a=i.options.directory.getRegisteredTemplate(s);if(a&&a.src){var d=a.src.prototype;if(d._properties={},d.elements={},d.possibleValues=o.semantics.possibleValues,d.valueType=o.semantics.valueType,d.isValueDisplayedAsString(a.options.displayStyle)){d._properties={},d.elements={},d.possibleValues=o.semantics.possibleValues,d.valueType=o.semantics.valueType;var c="progress"===t?"%":"percentage"===t?" %":"",u=this.getCellValue(e),h=d.getStringFromValue(u)+c;return d.possibleValues=void 0,d.valueType=void 0,d._properties=void 0,d.elements=void 0,h}}},t}(i);return o.addClass(a,"ResponsiveTweakersCollectionView"),a}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/ResponsiveTilesAdaptorCollectionView",["require","exports","DS/CollectionView/ResponsiveCollectionView","DS/Core/WebUXComponents","DS/Utilities/Utils"],(function(e,t,i,o,n){"use strict";var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{displayedOptionalCellProperties:{defaultValue:["All"],type:"array"},displayTitleTooltip:{defaultValue:!0,type:"boolean"},displayPropertiesTooltip:{defaultValue:!0,type:"boolean"},displayStatusbarTooltip:{defaultValue:!0,type:"boolean"}}},enumerable:!1,configurable:!0}),t.prototype._getCellValueAsStringForFind=function(e){for(var t=e.nodeModel,i=this.allowUnsafeHTMLContent?n.extractTextContentsFromHTMLString(this.getLabel(t)):this.getLabel(t),o=this.allowUnsafeHTMLContent?n.extractTextContentsFromHTMLString(this.getSubLabel(t)):this.getSubLabel(t),l=this.allowUnsafeHTMLContent?n.extractTextContentsFromHTMLString(this.getDescription(t)):this.getDescription(t),r=this.getStatusbarIcons(t)||[],s=[],a=0;a<r.length;a++){var d=r[a]&&r[a].label;d&&s.push(this.allowUnsafeHTMLContent?n.extractTextContentsFromHTMLString(d):d)}return i+""+o+""+l+""+s.join("")},t.prototype._applyDisplayedOptionalCellProperties=function(){if(this._displayedOptionalCellProperties=[],0!==this.displayedOptionalCellProperties.length){if(this.displayedOptionalCellProperties.length>=1){if(-1!==this.displayedOptionalCellProperties.indexOf("All"))return void(this._displayedOptionalCellProperties=["All"]);if(-1!==this.displayedOptionalCellProperties.indexOf("None"))return void(this._displayedOptionalCellProperties=["None"])}for(var e=0;e<this.displayedOptionalCellProperties.length;e++)"contextualMenu"!==this.displayedOptionalCellProperties[e]&&"description"!==this.displayedOptionalCellProperties[e]&&"propertiesList"!==this.displayedOptionalCellProperties[e]&&"statusbarIcons"!==this.displayedOptionalCellProperties[e]&&"activeFlag"!==this.displayedOptionalCellProperties[e]||this._displayedOptionalCellProperties.push(this.displayedOptionalCellProperties[e])}else this._displayedOptionalCellProperties=["All"]},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("displayedOptionalCellProperties")&&this._applyDisplayedOptionalCellProperties(),this.isDirty("displayTitleTooltip")&&this._applyDisplayTitleTooltip(),this.isDirty("displayPropertiesTooltip")&&this._applyDisplayPropertiesTooltip(),this.isDirty("displayStatusbarTooltip")&&this._applyDisplayStatusbarTooltip()},t.prototype._applyDisplayTitleTooltip=function(){this.invalidateLayout()},t.prototype._applyDisplayPropertiesTooltip=function(){this.invalidateLayout()},t.prototype._applyDisplayStatusbarTooltip=function(){this.invalidateLayout()},t}(i);return o.addClass(l,"ResponsiveTilesAdaptorCollectionView"),l}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/ResponsiveTilesCollectionView",["require","exports","DS/CollectionView/ResponsiveTilesAdaptorCollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Controls/ResponsiveTileView","DS/Core/WebUXComponents"],(function(e,t,i,o,n,l){"use strict";var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.isNodeModelInRange=function(e,t,i){return this.collectionView.modelProvider.isNodeModelInRange(e,t,i)},t.prototype.getRowHeight=function(){var e=this.collectionView._getPictureHeight();return-1===this.collectionView._displayedOptionalCellProperties.indexOf("All")&&-1===this.collectionView._displayedOptionalCellProperties.indexOf("statusbarIcons")||(e+=this.collectionView._getStatusbarHeight()),e},t.prototype.getContentDimensions=function(){var t=e.prototype.getContentDimensions.call(this);return t.width=t.width-2,t},t}(o);l.addClass(r,"ResponsiveTilesCollectionViewLayout");var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{allowLargeItems:{defaultValue:!1,type:"boolean"}}},enumerable:!1,configurable:!0}),t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("allowLargeItems")&&this._applyAllowLargeItems(t.allowLargeItems)},t.prototype._applyAllowLargeItems=function(e){this.allowLargeItems?(this.cellStyleOverload="wux-cell-responsivetile-large-allow",this.elements.container.addClassName("wux-layout-largetilecollectionView")):(this.cellStyleOverload="wux-cell-responsivetile",this.elements.container.removeClassName("wux-layout-largetilecollectionView")),this.invalidateLayout()},t.prototype._preBuildView=function(t){this._properties.layout.value||(this._properties.layout.value=new r({columnMaxWidth:540,gutter:10})),e.prototype._preBuildView.call(this,t)},t.prototype._postBuildView=function(){this.cellClassForView=n,e.prototype._postBuildView.call(this);var t=this,i=this;t.registerReusableCellContent({id:"Tile",buildContent:function(){var e=new t.cellClassForView({layoutingCollection:i});return i._onEndResize((function(){this._processPoolCells((function(e){var t=e.cellView.component.contentView;t&&(t._onTileResize(),this._updateHighlight(t.cellInfos))}))})),e}}),t.onCellRequest((function(e){var i=t.reuseCellContent("Tile");e.cellView.collectionView=t,e.cellView.contentView=i,i.cellInfos=e,i.unPrehighlight(),!0===t.useDragAndDrop?e.cellView.elements.container.setAttribute("draggable","true"):e.cellView.elements.container.setAttribute("draggable","false"),e.cellView.elements.container.dsView=e.cellView,e.cellView.getContent().addClassName(t.cellStyleOverload),i.getContent().setStyles({width:"100%",height:"100%"});var o=e.cellModel;if("All"===t.displayedOptionalCellProperties[0])i.setProperties({title:t.getLabel(o),customTooltip:t.getCustomTooltip(o),clickableTitle:t.getClickableTitle(o),multipleTitleLineNumber:t.getMultipleTitleLineNumber(o),subtitle:t.getSubLabel(o),description:t.getDescription(o),propertiesList:t.getPropertiesList(o),picture:t.getThumbnail(o),icon:t.getIcon(o),emptyStatusbarVisibleFlag:t.getEmptyStatusbarVisibleFlag(o),statusbarIconsTooltips:t.getStatusbarIconsTooltips(o),activeFlag:t.getActiveFlag(o),statusbarIcons:t.getStatusbarIcons(o),statusbarLabelsWidthRatios:t.getStatusbarLabelsWidthRatios(o),contextualMenu:t.getContextualMenu(o),color:t.getColor(o),disabled:t.getDisabled(o)});else if("None"===t.displayedOptionalCellProperties[0])i.setProperties({title:t.getLabel(o),customTooltip:t.getCustomTooltip(o),clickableTitle:t.getClickableTitle(o),multipleTitleLineNumber:t.getMultipleTitleLineNumber(o),subtitle:t.getSubLabel(o),picture:t.getThumbnail(o),icon:t.getIcon(o),description:void 0,propertiesList:void 0,activeFlag:void 0,contextualMenu:void 0,emptyStatusbarVisibleFlag:!1,statusbarIcons:void 0,statusbarIconsTooltips:t.getStatusbarIconsTooltips(o),color:t.getColor(o),disabled:t.getDisabled(o)});else{var n=-1!==t._displayedOptionalCellProperties.indexOf("statusbarIcons"),l={title:t.getLabel(o),customTooltip:t.getCustomTooltip(o),clickableTitle:t.getClickableTitle(o),multipleTitleLineNumber:t.getMultipleTitleLineNumber(o),subtitle:t.getSubLabel(o),picture:t.getThumbnail(o),icon:t.getIcon(o),emptyStatusbarVisibleFlag:!!n&&t.getEmptyStatusbarVisibleFlag(o),statusbarIcons:n?t.getStatusbarIcons(o):void 0,statusbarLabelsWidthRatios:t.getStatusbarLabelsWidthRatios(o),statusbarIconsTooltips:t.getStatusbarIconsTooltips(o),color:t.getColor(o),disabled:t.getDisabled(o),description:-1!==t._displayedOptionalCellProperties.indexOf("description")?t.getDescription(o):void 0,propertiesList:-1!==t._displayedOptionalCellProperties.indexOf("propertiesList")?t.getPropertiesList(o):void 0,activeFlag:-1!==t._displayedOptionalCellProperties.indexOf("activeFlag")?t.getActiveFlag(o):void 0,contextualMenu:-1!==t._displayedOptionalCellProperties.indexOf("contextualMenu")?t.getContextualMenu(o):void 0};i.setProperties(l)}e.cellView._setReusableContent(i),this.selectionBehavior.enableFeedbackForActiveCell&&(o===this.activeNode?i.activate():i.deactivate()),this.modelProvider.isNodeSelected(o)?i.highlight():i.unhighlight(),this._updateHighlight(e)}))},t.prototype._getPictureHeight=function(){return 70},t.prototype._getStatusbarHeight=function(){return 28},t.prototype.activateInteractiveCumulativeSelection=function(){this._interactiveCumulativeSelectionByAPI=!0,this._enableInteractiveMultiSelMode(),this._interactiveCumulativeSelectionByAPI=!1},t.prototype.isInInteractiveCumulativeSelectionFlag=function(){return this._interactiveCumulativeSelection},t.prototype.deactivateInteractiveCumulativeSelection=function(){this._disableInteractiveMultiSelMode()},t.prototype._enableInteractiveMultiSelMode=function(){!this.selectionBehavior.canInteractiveMultiselectWithCheckboxClick&&!0!==this._interactiveCumulativeSelectionByAPI||-1!==this.elements.container.className.indexOf("wux-multiselmode-responsivetilecollectionView")||!1===this._isInteractiveMultiSelMode&&(this._isInteractiveMultiSelMode=!0,this.elements.container.addClassName("wux-multiselmode-responsivetilecollectionView"),this._interactiveCumulativeSelection=!0,this._modelEvents.publish({event:"interactiveCumulativeSelectionChanged",data:{responsiveCollectionView:this,cumulativeSelection:!0}}))},t.prototype._disableInteractiveMultiSelMode=function(){this.elements.container.className.indexOf("wux-multiselmode-responsivetilecollectionView")&&!0===this._isInteractiveMultiSelMode&&(this._isInteractiveMultiSelMode=!1,this.elements.container.removeClassName("wux-multiselmode-responsivetilecollectionView"),this._interactiveCumulativeSelection=!1,this._modelEvents.publish({event:"interactiveCumulativeSelectionChanged",data:{responsiveCollectionView:this,cumulativeSelection:!1}}))},t.prototype.getCellViewMinWidth=function(){return 260},t.prototype.getCellViewMinHeight=function(){},t}(i);return l.addClass(s,"ResponsiveTilesCollectionView"),s}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/ResponsiveLargeTilesCollectionView",["require","exports","UWA/Core","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Utilities/Color","DS/Core/WebUXComponents"],(function(e,t,i,o,n,l,r){"use strict";var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.isNodeModelInRange=function(e,t,i){return this.collectionView.modelProvider.isNodeModelInRange(e,t,i)},t.prototype.getRowHeight=function(){var e=70;return-1===this.collectionView._displayedOptionalCellProperties.indexOf("All")&&-1===this.collectionView._displayedOptionalCellProperties.indexOf("statusbarIcons")||(e+=20),e},t.prototype.getContentDimensions=function(){var t=e.prototype.getContentDimensions.call(this);return t.width=t.width-2,t},t}(n);r.addClass(s,"ResponsiveLargeTilesCollectionViewLayout");var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{height:{defaultValue:"inherit",type:"integer"}}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){this._properties.layout.value||(this._properties.layout.value=new s({columnMaxWidth:"100%",gutter:10})),e.prototype._preBuildView.call(this,t)},t.prototype._postBuildView=function(){e.prototype._postBuildView.call(this),this.cellStyleOverload="wux-cell-responsivelargetile",this.elements.container.addClassName("wux-layout-largetilecollectionView")},t.prototype._showDndFeedbacks=function(e,t){if(this&&void 0!==t.cellID){this._dnDInfos||(this._dnDInfos={elements:{dndFeedback:null},dropAccepted:!1}),this._dnDInfos.elements.dndFeedback||(this._dnDInfos.elements.dndFeedback=new i.Element("div",{class:"wux-layouts-responsivecollectionview-drag-item-feedback"}),this._dnDInfos.elements.dndFeedback.inject(this.getContent()));var o,n,r=this.layout,s=this.elements.container.getBoundingClientRect(),a=t.cellView.getContent().getBoundingClientRect();t.cellView&&(o=e.clientY<a.top+a.height/10?"top":e.clientY>=a.top+9*a.height/10?"bottom":"middle");var d=a.width,c=-s.left+a.left,u=-s.top+a.top;"top"===o?(c+=-1-r.gutter/2+1,u+=-1-r.gutter/2,d+=r.gutter,n=2):"bottom"===o?(c+=-1-r.gutter/2+1,u+=-1+a.height+r.gutter/2,d+=r.gutter,n=2):n=a.height;var h=!0,p=this.getTreeDocument();p&&p.options&&"function"==typeof p.options.shouldAcceptDrop&&(h=p.options.shouldAcceptDrop(t)),this._dnDInfos.elements.dndFeedback.setStyles({display:"block",left:c,top:u,width:d,height:n,border:"none",background:h?l.COLORS_3DEXPERIENCE.COLOR_DARK_BLUE:l.COLORS_3DEXPERIENCE.COLOR_DARK_RED})}},t}(o);return r.addClass(a,"ResponsiveLargeTilesCollectionView"),a}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/ResponsiveLargeTextualTilesCollectionView",["require","exports","DS/Utilities/Utils","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Controls/ResponsiveTextualTileView","DS/Core/WebUXComponents"],(function(e,t,i,o,n,l,r){"use strict";var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sideGutter=60,t}return __extends(t,e),t.prototype.isNodeModelInRange=function(e,t,i){return this.collectionView.modelProvider.isNodeModelInRange(e,t,i)},t.prototype.getRowHeight=function(){var e=130;return-1===this.collectionView._displayedOptionalCellProperties.indexOf("All")&&-1===this.collectionView._displayedOptionalCellProperties.indexOf("statusbarIcons")||(e+=16),e},t.prototype.prepareLayout=function(){var e=this,t=e.collectionView.getViewportDimensions(!0);t.width<640?this.sideGutter=e.collectionView.sideGutter.small:this.sideGutter=e.collectionView.sideGutter.big,e._numberOfColumns=1;var i=e._getRowHeightInPixel(t),o=(t.height-e.gutter-e.layoutMargins.marginTop-e.layoutMargins.marginBottom)/(i+e.gutter);e._numberOfRows=Math.max(Math.floor(o),1);var n=function(){this._columnWidth=Math.floor(t.width-2*this.sideGutter-this.layoutMargins.marginLeft-this.layoutMargins.marginRight),this.useDynamicRowHeight?this._rowHeight=Math.floor((t.height-(this._numberOfRows+1)*this.gutter-this.layoutMargins.marginTop-this.layoutMargins.marginBottom)/this._numberOfRows):this._rowHeight=Math.floor(i);var e=!1;this._rowHeight>this.rowMaxHeight&&(this._numberOfRows++,e=!0),e&&n.call(this)};n.call(this)},t.prototype._getPositionForCellAt=function(e){var t=this.getCellCoordinatesAt(e);return{left:this.sideGutter+this.layoutMargins.marginLeft,top:t.rowID*(this.getRowHeight()+this.gutter)+this.gutter+this.layoutMargins.marginTop}},t.prototype._getColumnMaxWidthInPixel=function(e){var t,i;switch(typeof this.columnMaxWidth){case"string":t=parseFloat(this.columnMaxWidth),i=Math.round((e.width-this.sideGutter-this.layoutMargins.marginLeft)/100*t);break;case"number":i=this.columnMaxWidth;break;case"object":i=n.responsiveMap(this,e.width,this.columnMaxWidth)}return i},t.prototype._getColumnPosition=function(e){return e*(this._getColumnWidth()+this.sideGutter)+this.sideGutter+this.layoutMargins.marginLeft},t.prototype.getContentDimensions=function(){var e=this.collectionView.getViewportDimensions(),t=this.collectionView.model.length-1,o=this.getPositionForCellAt(t),n=this.getDimensionsForCellAt(t),l={height:o.top+this.gutter+n.height+this.gutter+this.layoutMargins.marginBottom,width:o.left+this.sideGutter+n.width+this.sideGutter+this.layoutMargins.marginRight-2},r=i.getScrollbarWidth();if("vertical"===this.direction)return{width:l.height>e.height?e.width-r:e.width,height:l.height};var s=l.width>e.width?e.height-r:e.height;return{width:l.width,height:s}},t.prototype._computeMinCellID=function(){var e=0,t=this.collectionView.getViewportDimensions(),i=this.collectionView.getScrollerPosition();return e="vertical"===this.direction?Math.max(Math.floor((i.y-this.layoutMargins.marginTop)/(this.getRowHeight()+this.gutter)),0)*Math.floor((t.width-this.layoutMargins.marginLeft-this.layoutMargins.marginRight)/(this._getColumnWidth()+this.sideGutter)):Math.max(Math.floor((i.x-this.layoutMargins.marginLeft)/(this._getColumnWidth()+this.sideGutter)),0)*Math.floor((t.height-this.layoutMargins.marginTop-this.layoutMargins.marginBottom)/(this.getRowHeight()+this.gutter)),e=Math.min(e,this.collectionView.model.length-1)},t}(n);r.addClass(s,"ResponsiveLargeTextualTilesCollectionViewLayout");var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{sideGutter:{defaultValue:{small:10,big:60},type:"object"}}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){this._properties.layout.value||(this._properties.layout.value=new s({columnMaxWidth:"100%",gutter:10})),e.prototype._preBuildView.call(this,t)},t.prototype._postBuildView=function(){e.prototype._postBuildView.call(this),this.cellClassForView=l,this.cellStyleOverload="wux-cell-responsivelargetile",this.elements.container.addClassName("wux-layout-largetilecollectionView")},t}(o);return r.addClass(a,"ResponsiveLargeTextualTilesCollectionView"),a}));__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();define("DS/CollectionView/ResponsiveThumbnailsCollectionView",["require","exports","DS/CollectionView/ResponsiveTilesAdaptorCollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Controls/ResponsiveThumbnailView","DS/Core/WebUXComponents"],(function(e,t,i,o,n,l){"use strict";var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.isNodeModelInRange=function(e,t,i){return this.collectionView.modelProvider.isNodeModelInRange(e,t,i)},t.prototype.getRowHeight=function(){var e=this.collectionView._getPictureHeight()+this.collectionView._getMainContentHeight();-1===this.collectionView._displayedOptionalCellProperties.indexOf("All")&&-1===this.collectionView._displayedOptionalCellProperties.indexOf("description")&&-1===this.collectionView._displayedOptionalCellProperties.indexOf("propertiesList")||(e+=this.collectionView.descriptionLinesNumber*this.collectionView._getDescriptionLineHeight()+this.collectionView._getDescriptionTopBottomMargins());return!0===this.collectionView.useProgressBar&&(e+=this.collectionView._getProgressBarContainerHeight()),-1===this.collectionView._displayedOptionalCellProperties.indexOf("All")&&-1===this.collectionView._displayedOptionalCellProperties.indexOf("statusbarIcons")||(e+=this.collectionView._getStatusbarHeight()),e},t.prototype.getContentDimensions=function(){var t=e.prototype.getContentDimensions.call(this);return t.width=t.width-2,t},t}(o);l.addClass(r,"ResponsiveThumbnailsCollectionViewLayout");var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{descriptionLinesNumber:{defaultValue:7,type:"integer"},useProgressBar:{defaultValue:!1,type:"boolean",category:"Appearance"}}},enumerable:!1,configurable:!0}),t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("descriptionLinesNumber")&&this._applyDescriptionLinesNumber(t.descriptionLinesNumber),this.isDirty("useProgressBar")&&this._applyUseProgressBar(t.useProgressBar)},t.prototype._applyDescriptionLinesNumber=function(e){e!==this.descriptionLinesNumber&&this.invalidateLayout()},t.prototype._applyUseProgressBar=function(e){e!==this.useProgressBar&&this.invalidateLayout({updateCellContent:!0})},t.prototype._preBuildView=function(t){this._properties.layout.value||(this._properties.layout.value=new r({columnMaxWidth:{0:320,420:240},gutter:10})),e.prototype._preBuildView.call(this,t)},t.prototype._postBuildView=function(){e.prototype._postBuildView.call(this),this.cellStyleOverload="wux-cell-responsivethumbnail";var t=this,i=this;t.registerReusableCellContent({id:"Thumbnail",buildContent:function(){var e=new(i._getResponsiveThumbnailViewClass())({layoutingCollection:i});return i._onEndResize((function(){this._processPoolCells((function(e){var t=e.cellView.component.contentView;t&&(t._onViewResize(),this._updateHighlight(t.cellInfos))}))})),e}}),t.onCellRequest((function(e){var i=t.reuseCellContent("Thumbnail");e.cellView.collectionView=t,e.cellView.contentView=i,i.cellInfos=e,i.unPrehighlight(),!0===t.useDragAndDrop?e.cellView.elements.container.setAttribute("draggable","true"):e.cellView.elements.container.setAttribute("draggable","false"),e.cellView.elements.container.dsView=e.cellView,e.cellView.getContent().addClassName(t.cellStyleOverload),i.getContent().setStyles({width:"100%",height:"100%"});var o=e.cellModel,n=[],l=t.getBadges(o);if(l&&(l.topRight&&n.push(l.topRight),l.bottomRight&&n.push(l.bottomRight)),"All"===t.displayedOptionalCellProperties[0])i.setProperties({title:t.getLabel(o),customTooltip:t.getCustomTooltip(o),clickableTitle:t.getClickableTitle(o),multipleTitleLineNumber:t.getMultipleTitleLineNumber(o),subtitle:t.getSubLabel(o),progressValueData:t.useProgressBar?t.getprogressValueData(o):void 0,description:t.getDescription(o),propertiesList:t.getPropertiesList(o),picture:t.getThumbnail(o),icon:t.getIcon(o),emptyStatusbarVisibleFlag:t.getEmptyStatusbarVisibleFlag(o),statusbarIconsTooltips:t.getStatusbarIconsTooltips(o),activeFlag:t.getActiveFlag(o),statusbarIcons:t.getStatusbarIcons(o),statusbarLabelsWidthRatios:t.getStatusbarLabelsWidthRatios(o),badges:n,contextualMenu:t.getContextualMenu(o),color:t.getColor(o),disabled:t.getDisabled(o)});else if("None"===t.displayedOptionalCellProperties[0])i.setProperties({title:t.getLabel(o),customTooltip:t.getCustomTooltip(o),clickableTitle:t.getClickableTitle(o),multipleTitleLineNumber:t.getMultipleTitleLineNumber(o),subtitle:t.getSubLabel(o),progressValueData:t.useProgressBar?t.getprogressValueData(o):void 0,picture:t.getThumbnail(o),icon:t.getIcon(o),badges:void 0,description:void 0,propertiesList:void 0,activeFlag:void 0,contextualMenu:void 0,emptyStatusbarVisibleFlag:!1,statusbarIcons:void 0,statusbarIconsTooltips:t.getStatusbarIconsTooltips(o),color:t.getColor(o),disabled:t.getDisabled(o)});else{var r=-1!==t._displayedOptionalCellProperties.indexOf("statusbarIcons"),s={title:t.getLabel(o),customTooltip:t.getCustomTooltip(o),clickableTitle:t.getClickableTitle(o),multipleTitleLineNumber:t.getMultipleTitleLineNumber(o),subtitle:t.getSubLabel(o),progressValueData:t.useProgressBar?t.getprogressValueData(o):void 0,picture:t.getThumbnail(o),icon:t.getIcon(o),emptyStatusbarVisibleFlag:!!r&&t.getEmptyStatusbarVisibleFlag(o),badges:r?n:void 0,statusbarIcons:r?t.getStatusbarIcons(o):void 0,statusbarLabelsWidthRatios:t.getStatusbarLabelsWidthRatios(o),statusbarIconsTooltips:t.getStatusbarIconsTooltips(o),color:t.getColor(o),disabled:t.getDisabled(o),description:-1!==t._displayedOptionalCellProperties.indexOf("description")?t.getDescription(o):void 0,propertiesList:-1!==t._displayedOptionalCellProperties.indexOf("propertiesList")?t.getPropertiesList(o):void 0,activeFlag:-1!==t._displayedOptionalCellProperties.indexOf("activeFlag")?t.getActiveFlag(o):void 0,contextualMenu:-1!==t._displayedOptionalCellProperties.indexOf("contextualMenu")?t.getContextualMenu(o):void 0};i.setProperties(s)}e.cellView._setReusableContent(i),this.selectionBehavior.enableFeedbackForActiveCell&&(o===this.activeNode?i.activate():i.deactivate()),this.modelProvider.isNodeSelected(o)?i.highlight():i.unhighlight(),this._updateHighlight(e)}))},t.prototype._getPictureHeight=function(){return this.layout._columnWidthUsedForRowHeight?3*this.layout._columnWidthUsedForRowHeight/4:3*this.layout.columnMaxWidth/4},t.prototype._getMainContentHeight=function(){return 70},t.prototype._getProgressBarContainerHeight=function(){return 46},t.prototype._getStatusbarHeight=function(){return 28},t.prototype._getDescriptionLineHeight=function(){return 13},t.prototype._getDescriptionTopBottomMargins=function(){return 24},t.prototype._getDescriptionBottomMargins=function(){return 14},t.prototype.activateInteractiveCumulativeSelection=function(){this._interactiveCumulativeSelectionByAPI=!0,this._enableInteractiveMultiSelMode(),this._interactiveCumulativeSelectionByAPI=!1},t.prototype.isInInteractiveCumulativeSelectionFlag=function(){return this._interactiveCumulativeSelection},t.prototype.deactivateInteractiveCumulativeSelection=function(){this._disableInteractiveMultiSelMode()},t.prototype.getprogressValueData=function(e){return this.modelProvider.getPropertyValue(e,"progressValueData")},t.prototype._enableInteractiveMultiSelMode=function(){!this.selectionBehavior.canInteractiveMultiselectWithCheckboxClick&&!0!==this._interactiveCumulativeSelectionByAPI||-1!==this.elements.container.className.indexOf("wux-multiselmode-responsivethumbnailcollectionView")||!1===this._isInteractiveMultiSelMode&&(this._isInteractiveMultiSelMode=!0,this.elements.container.addClassName("wux-multiselmode-responsivethumbnailcollectionView"),this._interactiveCumulativeSelection=!0,this._modelEvents.publish({event:"interactiveCumulativeSelectionChanged",data:{responsiveCollectionView:this,cumulativeSelection:!0}}))},t.prototype._disableInteractiveMultiSelMode=function(){this.elements.container.className.indexOf("wux-multiselmode-responsivethumbnailcollectionView")&&!0===this._isInteractiveMultiSelMode&&(this._isInteractiveMultiSelMode=!1,this.elements.container.removeClassName("wux-multiselmode-responsivethumbnailcollectionView"),this._interactiveCumulativeSelection=!1,this._modelEvents.publish({event:"interactiveCumulativeSelectionChanged",data:{responsiveCollectionView:this,cumulativeSelection:!1}}))},t.prototype._getResponsiveThumbnailViewClass=function(){return n},t.prototype.getCellViewMinWidth=function(){return 150},t.prototype.getCellViewMinHeight=function(){},t}(i);return l.addClass(s,"ResponsiveThumbnailsCollectionView"),s})),define("DS/CollectionView/CarouselView",["UWA/Core","DS/Controls/Abstract","DS/Windows/DockingElement","DS/Tweakers/TypeRepresentationFactory","DS/Utilities/Utils","DS/Controls/Button","DS/Core/PointerEvents","DS/Utilities/Dom","DS/CollectionView/ResponsiveThumbnailsCollectionView","DS/Menu/ContextualMenu","DS/Controls/ResponsiveThumbnailView","i18n!DS/CollectionView/assets/nls/carousel.json"],(function(e,t,i,o,n,l,r,s,a,d,c,u){"use strict";var h=c.inherit({prehighlight:function(){var e=this;e.isPreHighlighted||(e.elements.container.addClassName("wux-ui-state-prehighlighted"),e.elements.highlightBorder.addClassName("wux-ui-state-prehighlighted"),e.isPreHighlighted=!0)},unPrehighlight:function(){var e=this;e.isPreHighlighted&&(e.elements.container.removeClassName("wux-ui-state-prehighlighted"),e.elements.highlightBorder.removeClassName("wux-ui-state-prehighlighted"),e.isPreHighlighted=!1)},highlight:function(){this.activeFlag=!0},unhighlight:function(){this.activeFlag=!1}}),p=a.inherit({_getResponsiveThumbnailViewClass:function(){return h}});p.onSelectionAdd=function(e){e&&(e.activeFlag=!0)},p.onSelectionRemove=function(e){e&&(e.activeFlag=!1)};var g=function(t){if(t.target.classList.contains("wux-layouts-carousel-main-content")){var i=e.Event.wheelDelta(t);i<0&&m(t.currentTarget._mouseWheelArg),i>0&&f(t.currentTarget._mouseWheelArg)}else s.firstParentWithClass(t.target,"wux-layouts-carousel-bottom-content")&&t.stopPropagation()},f=function(e){if(e.treeDocument){var t=e.treeDocument.getXSO().get();if(0===t.length&&e.treeDocument.getRoots()[0].select(),t.length>0){var i=t[t.length-1].getPreviousVisibleNode();i&&i.select(!0)}}},m=function(e){if(e.treeDocument){var t=e.treeDocument.getXSO().get();if(0===t.length&&e.treeDocument.getRoots()[0].select(),t.length>0){var i=t[t.length-1].getNextVisibleNode();i&&i.select(!0)}}},_=new o;return t.inherit({name:"carousel",publishedProperties:{treeDocument:{defaultValue:null,type:"object",category:"Model"},intervalTimer:{defaultValue:1,type:"number",category:"Appearance"},height:{defaultValue:"auto",type:"number",category:"Appearance"},onTitleRequest:{defaultValue:function(e){e.nodeView.setContent(e.nodeModel.options.label)},type:"function",category:"Appearance"},onSubtitleRequest:{defaultValue:function(e){e.nodeView.setContent(e.nodeModel.options.subLabel)},type:"function",category:"Appearance"},onRightViewRequest:{defaultValue:function(e){_.generateView(e.nodeModel.options.grid,{typePath:"object",readOnly:!0,onViewCreated:function(t){e.nodeView.setContent(t)}})},type:"function",category:"Appearance"},bigPicturePath:{defaultValue:function(e){return e.nodeModel.options.thumbnail},type:"function",category:"Appearance"},onMainViewRequest:{defaultValue:function(e){e.nodeView.setStyles({backgroundImage:"url("+e.view.bigPicturePath(e)+")",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"50% 50%"})},type:"function",category:"Appearance"},toolbar:{defaultValue:[],type:"array",category:"behavior"},scrollOnMainViewMouseWheel:{defaultValue:!0,type:"boolean",category:"behavior"}},buildView:function(){this.elements.container=new e.Element("div",{class:"wux-layouts-carousel",tabindex:0}),this.elements.container.setAttribute("carousel-display-mode","maxWidthDisplay"),this.elements.header=new e.Element("div",{class:"wux-layouts-carousel-header"}).inject(this.elements.container),this.elements.headerMainContainer=new e.Element("div",{class:"wux-layouts-carousel-header-main-container"}).inject(this.elements.header),this.elements.headerTitleBar=new e.Element("ul",{class:"wux-layouts-carousel-header-titlebar"}).inject(this.elements.headerMainContainer),this.elements.headerTitle=new e.Element("span",{class:"wux-layouts-carousel-header-title",html:"document title"}).inject(this.elements.headerTitleBar),this.elements.headerSubtitle=new e.Element("span",{class:"wux-layouts-carousel-header-subtitle",html:"document subtitle"}).inject(this.elements.headerTitleBar),this.elements.headerToolbar=new e.Element("ul",{class:"wux-layouts-carousel-header-toolbar"}).inject(this.elements.headerMainContainer),this.elements.containerRel=new e.Element("div",{class:"wux-layouts-carousel-rel",styles:{position:"relative",height:"calc( 100% - 70px)",width:"100%"}}).inject(this.getContent()),this.elements.collectionView=new p({displayedOptionalCellProperties:["contextualMenu"],showScrollbarsOnHover:!0}),e.extend(this.elements.collectionView.selectionBehavior,{canInteractiveMultiselectWithCheckboxClick:!1,canMultiSelect:!1,enableShiftSelection:!1}),this.elements.collectionView.layout.direction="horizontal",this.elements.collectionView.layout.columnMaxWidth=175,this.elements.collectionView.layout.rowMaxHeight=210,this.elements.collectionView.layout.useDynamicRowHeight=!1,this.elements.collectionView.layout.useDynamicColumnWidth=!1,this.elements.collectionView.getContent().setAttribute("carouselview-status-bar","false"),this.elements.collectionView.getContent().setStyles({top:1,height:"auto",bottom:"-2px","z-index":"100001"}),this.elements.rightViewContent=new e.Element("div",{class:"wux-layouts-carousel-right-content"}),this.elements.dockingZoneContentForBottom=new e.Element("div",{class:"wux-layouts-carousel-main-content wux-layouts-carousel-bottom-content",html:this.elements.collectionView,styles:{height:"100%",position:"relative"}}),this.elements.mainView=new e.Element("div",{class:"wux-layouts-carousel-main"}),this.elements.bottomDockingElement=new i({side:WUXDockAreaEnum.BottomDockArea,dockingZoneContent:this.elements.dockingZoneContentForBottom,dockingZoneSize:242,resizableFlag:!1,useBordersFlag:!1,collapsibleFlag:!1,collapseDockingZoneFlag:!1,visibleDockingZoneFlag:!0}),this.rollVisibleFlag=!0,this.sidePanelVisibleFlag=!0,this.elements.rightDockingElement=new i({side:WUXDockAreaEnum.RightDockArea,dockingZoneContent:this.elements.rightViewContent,dockingZoneSize:482,resizableFlag:!1,useBordersFlag:!1,collapsibleFlag:!1,collapseDockingZoneFlag:!1,visibleDockingZoneFlag:!0}),this.elements.bottomDockingElement.freeZoneContent=this.elements.mainView,this.elements.rightDockingElement.freeZoneContent=this.elements.bottomDockingElement,this.elements.mainViewContent=new e.Element("div",{class:"wux-layouts-carousel-main-content"}).inject(this.elements.mainView),this.elements.mainViewLeftArrow=new l({icon:{iconName:"open-left",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:{shortHelp:u.previous,mouseRelativePosition:!1},clickMode:1}),this.elements.mainViewRightArrow=new l({icon:{iconName:"open-right",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:{shortHelp:u.next,mouseRelativePosition:!1},clickMode:1}),this.elements.bottomViewLeftArrow=new e.Element("div",{class:"wux-layouts-carousel-bottom-prev wux-layouts-carousel-bottom-prev-collectiondimensions  wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-left"}).inject(this.elements.dockingZoneContentForBottom),this.elements.bottomViewRightArrow=new e.Element("div",{class:"wux-layouts-carousel-bottom-next wux-layouts-carousel-bottom-next-collectiondimensions wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-right"}).inject(this.elements.dockingZoneContentForBottom),this._observeEvents(),this.elements.containerRel.appendChild(this.elements.rightDockingElement.elements.container),this.elements.collectionView._getScroller().elements.container.addEventListener("wheel",(function(e){e.stopPropagation()}),!0)},_postBuildView:function(){var e=this;this._parent(),this._isReady=!1,s.onNodeRendered(this.getContent(),(function(){!0!==e._isReady&&(e._isReady=!0,e._updateCarouselLayout())})),s.addEndResizeListener(this.elements.container,(function(){e._updateCarouselLayout()}),10)},_updateCarouselLayout:function(){var e=this,t=e.elements.container.getDimensions(),i=e.elements.container.getAttribute("carousel-display-mode");if(t.width<965&&"middleWidthDisplay"!==i?(e.elements.container.setAttribute("carousel-display-mode","middleWidthDisplay"),e.elements.bottomDockingElement.dockingZoneContent=null,!0===e.sidePanelVisibleFlag?(e.elements.bottomDockingElement.dockingZoneContent=e.elements.rightViewContent,e.elements.bottomDockingElement.visibleDockingZoneFlag=!0):!0===e.rollVisibleFlag?(e.elements.bottomDockingElement.dockingZoneContent=e.elements.dockingZoneContentForBottom,e.elements.bottomDockingElement.visibleDockingZoneFlag=!0):e.elements.bottomDockingElement.visibleDockingZoneFlag=!1,e.elements.rightDockingElement.visibleDockingZoneFlag=!1):t.width>=965&&"maxWidthDisplay"!==i&&(e.elements.container.setAttribute("carousel-display-mode","maxWidthDisplay"),!0===e.sidePanelVisibleFlag?e.elements.rightDockingElement.visibleDockingZoneFlag=!0:e.elements.rightDockingElement.visibleDockingZoneFlag=!1,e.elements.rightDockingElement.dockingZoneContent=null,e.elements.bottomDockingElement.dockingZoneContent=e.elements.dockingZoneContentForBottom,e.elements.rightDockingElement.dockingZoneContent=e.elements.rightViewContent,!0===e.rollVisibleFlag?e.elements.bottomDockingElement.visibleDockingZoneFlag=!0:e.elements.bottomDockingElement.visibleDockingZoneFlag=!1),"middleWidthDisplay"===i){var o=0;(!0===e.rollVisibleFlag&&!1===e.sidePanelVisibleFlag||!0===e.sidePanelVisibleFlag&&(o=t.height-58-3*t.width/4)<242)&&(o=242),e.elements.bottomDockingElement.dockingZoneSize=o}e._updateToolbarLayout()},_observeEvents:function(){var e,t,i=this,o=function(){e&&clearInterval(e),t&&clearInterval(t),i.getGridView()._disableAutoScroll()};this.elements.mainViewLeftArrow.addEventListener("buttonclick",(function(){o(),f(i),t=setTimeout((function(){e=setInterval(f,i,i.intervalTimer)}),500)})),this.elements.mainViewRightArrow.addEventListener("buttonclick",(function(){o(),m(i),t=setTimeout((function(){e=setInterval(m,i,i.intervalTimer)}),500)})),this.elements.bottomViewLeftArrow.addEvent(r.POINTERDOWN,(function(e){e.preventDefault(),e.stopPropagation(),i.getGridView()._enableAutoScroll({x:-10,y:0},10)})),this.elements.bottomViewRightArrow.addEvent(r.POINTERDOWN,(function(e){e.preventDefault(),e.stopPropagation(),i.getGridView()._enableAutoScroll({x:10,y:0},10)}));var n=function(e,t,o){!0,i.getGridView().onPostUpdateViewOnce((function(){!1,o&&o.call(i)})),e.call(i,i)};this._manageKeyboardNavigation({throttleTime:50,keymap:{left:function(){n(f)},right:function(){n(m)}}});var l=function(e){e.preventDefault()};this.elements.container.addEventListener("MSHoldVisual",l,!1),this.elements.container.addEventListener("contextmenu",l,!1),this.elements.mainViewLeftArrow.addEvent("mouseleave",o),this.elements.mainViewRightArrow.addEvent("mouseleave",o),this.elements.bottomViewLeftArrow.addEvent("mouseleave",o),this.elements.bottomViewRightArrow.addEvent("mouseleave",o),this.elements.bottomViewLeftArrow.addEvent(r.POINTERUP,o),this.elements.bottomViewRightArrow.addEvent(r.POINTERUP,o),document.body.addEventListener("mouseup",o),document.body.addEventListener("mouseleave",o)},_manageKeyboardNavigation:function(t){var i=this;e.Element.addEvent.call(this.getContent(),"keydown",n.throttle((function(o){if(void 0==={input:!0,textarea:!0}[o.target.tagName.toLowerCase()]&&(s.hasClass(o.target,"wux-layouts-carousel")?o.target:s.firstParentWithClass(o.target,"wux-layouts-carousel"))===i.getContent()){var n=e.Event.whichKey(o);void 0!==t.keymap[n]&&t.keymap[n].call(i)}}),t.throttleTime))},_applyHeight:function(e){"auto"===this.height?this.elements.container.setStyles({position:"absolute",top:0,bottom:0,right:0,left:0}):"number"==typeof this.height&&this.elements.container.setStyles({position:"",height:this.height}),this.elements.container.style.overflow="auto",this._parent(e)},_applyThemeStyle:function(e){this.themeStyle!=e&&("dark"===this.themeStyle?(this.elements.container&&this.elements.container.setAttribute("theme-style","dark"),this.elements.header&&this.elements.header.setAttribute("theme-style","dark"),this.elements.collectionView&&this.elements.collectionView.getContent().setAttribute("theme-style","dark"),this.elements.bottomViewLeftArrow&&this.elements.bottomViewLeftArrow.setAttribute("theme-style","dark"),this.elements.bottomViewRightArrow&&this.elements.bottomViewRightArrow.setAttribute("theme-style","dark")):"white"===this.themeStyle&&(this.elements.container&&this.elements.container.setAttribute("theme-style","white"),this.elements.header&&this.elements.header.setAttribute("theme-style","white"),this.elements.collectionView&&this.elements.collectionView.getContent().setAttribute("theme-style","white"),this.elements.bottomViewLeftArrow&&this.elements.bottomViewLeftArrow.setAttribute("theme-style","white"),this.elements.bottomViewRightArrow&&this.elements.bottomViewRightArrow.setAttribute("theme-style","white")))},_updateVisibleDescendants:function(){this._listOfVisibleDescendants=this.treeDocument._getTrueRoot().getAllDescendants([],{onlyVisibleNodes:!0}),console.log(this._listOfVisibleDescendants)},_applyTreeDocument:function(e){if(this.elements.collectionView.loadGridViewModel(this.treeDocument),this.treeDocument){var t=this,i=this.treeDocument.getXSO(),o=n.debounce((function(e){t.onRightViewRequest(e)}),100),l=function(){var e=i.get(),n=e[e.length-1];t.onMainViewRequest({nodeModel:n,nodeView:t.elements.mainViewContent,view:t}),o.call(t,{nodeModel:n,nodeView:t.elements.rightViewContent,view:t}),t.onTitleRequest({nodeModel:n,nodeView:t.elements.headerTitle,view:t}),t.onSubtitleRequest({nodeModel:n,nodeView:t.elements.headerSubtitle,view:t}),t.elements.collectionView._setActiveNode(n,!0)};i.get().length>0&&l.call(i),i.onAdd(l);var r=this.treeDocument.getRoots();0===i.get().length&&r.length&&this.treeDocument.getRoots()[0].select()}this._parent(e)},_applyDisabled:function(){this._parent(),this.disabled?this.elements.container.setAttribute("tabindex",-1):this.elements.container.setAttribute("tabindex",0)},_applyToolBar:function(){var e=this;e.elements.headerToolbar.empty(),this.toolbar.forEach((function(t){t.icon.fontIconSize="2x",t.icon.fontIconFamily=WUXManagedFontIcons.Font3DS,new l({type:t.type,tooltipInfos:t.tooltipInfos,icon:t.icon,value:"1",displayStyle:"lite-borders",touchMode:!0,clickMode:1}).inject(e.elements.headerToolbar).addEventListener("click",(function(e){e.stopPropagation(),t.callback&&t.callback()}))})),this.getRollVisibleFlag()&&(this.elements.mainViewLeftArrow.inject(this.elements.headerToolbar),this.elements.mainViewRightArrow.inject(this.elements.headerToolbar))},_applyScrollOnMainViewMouseWheel:function(t){if(this.scrollOnMainViewMouseWheel!==t){this.scrollOnMainViewMouseWheel?(this._mouseWheelsubscriptionDoneOneTimeAtLeast=!0,e.Element.addEvent.call(this.elements.container,"mousewheel",g),this.elements.container._mouseWheelArg=this):!0===this._mouseWheelsubscriptionDoneOneTimeAtLeast&&(this._mouseWheelsubscriptionDoneOneTimeAtLeast=!1,e.Element.removeEvent.call(this.elements.container,"mousewheel",g),this.elements.container._mouseWheelArg=this)}},_applyProperties:function(e){this._parent(e),this._applyHeight(),this._applyTreeDocument(),this._applyToolBar(),this._applyScrollOnMainViewMouseWheel(e.scrollOnMainViewMouseWheel),this._applyThemeStyle()},_updateToolbarLayout:function(){var e=this.elements.container.getDimensions().width-this.elements.headerTitleBar.getDimensions().width-30;e<190&&(e=190);var t=!1===this.rollVisibleFlag?1:3,i=this.toolbar?40*(this.toolbar.length+t)+30:0,o=!1===this.rollVisibleFlag?2:4,n=[];!0===this.rollVisibleFlag&&(n.push(this.elements.mainViewLeftArrow.getContent()),n.push(this.elements.mainViewRightArrow.getContent())),n.push(this._closeButton.getContent());var r=0,s=[];if(i>e){r=Math.floor(e/40)-o,s=this.buildToolbarAdditionalButtons(r);for(var a=[],c=0;c<this.toolbar.length;c++)-1===s.indexOf(this.toolbar[c])&&a.push(this.toolbar[c]);if(this.buttonsForContextMenu=a,a.length>=1){if(!this._dotMenuButtonIcon){this._dotMenuButtonIcon=new l({icon:{iconName:"menu-dot",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:{shortHelp:u.dotMenu,mouseRelativePosition:!1},clickMode:1}),this._dotMenuButtonIcon.getContent().addEventListener("click",(function(e){var t=document.createEvent("HTMLEvents");t.initEvent("contextmenu",!0,!1),t.pageX=e.pageX,t.pageY=e.pageY,this.dispatchEvent(t),e.stopPropagation()}));var h=this;d.addEventListener(this._dotMenuButtonIcon.getContent(),{callback:function(e){return h.getContextMenuForButtons(h.buttonsForContextMenu)}})}n.push(this._dotMenuButtonIcon.getContent())}}else s=this.toolbar;this.elements.headerToolbar.empty();h=this;s.forEach((function(e){e.icon.fontIconSize="2x",e.icon.fontIconFamily=WUXManagedFontIcons.Font3DS,new l({type:e.type,tooltipInfos:e.tooltipInfos,icon:e.icon,value:"1",displayStyle:"lite-borders",touchMode:!0,clickMode:1}).inject(h.elements.headerToolbar).addEventListener("click",(function(t){t.stopPropagation(),e.callback&&e.callback()}))}));for(var p=0;p<n.length;p++)this.elements.headerToolbar.appendChild(n[p])},buildToolbarAdditionalButtons:function(e){var t=[];if(!this.toolbar||this.toolbar.length<e)return t;for(var i=0;i<e;i++)t.push(this.toolbar[i]);return t},getContextMenuForButtons:function(e){for(var t=[],i=0;i<e.length;i++){var o=e[i];t.push({type:"PushItem",title:o.text,fonticon:{family:o.icon.fontIconFamily,content:"wux-ui-3ds wux-ui-3ds-"+o.icon.iconName},action:{callback:function(e){var t=e.context;t.callback.call(t)},context:o}})}return t},getGridView:function(){return this.elements.collectionView},getRightDockingElement:function(){return this.elements.rightDockingElement},getBottomDockingElement:function(){return this.elements.bottomDockingElement},getRollVisibleFlag:function(){return this.rollVisibleFlag},setRollVisibleFlag:function(e){var t=this;"middleWidthDisplay"===t.elements.container.getAttribute("carousel-display-mode")?e?(t.elements.bottomDockingElement.dockingZoneContent=t.elements.dockingZoneContentForBottom,t.rollVisibleFlag=!0,t.elements.bottomDockingElement.visibleDockingZoneFlag=!0):(t.sidePanelVisibleFlag?(t.elements.bottomDockingElement.dockingZoneContent=t.elements.rightViewContent,t.elements.bottomDockingElement.visibleDockingZoneFlag=!0):t.elements.bottomDockingElement.visibleDockingZoneFlag=!1,t.rollVisibleFlag=!1):e?(t.rollVisibleFlag=!0,t.elements.bottomDockingElement.visibleDockingZoneFlag=!0):(t.rollVisibleFlag=!1,t.elements.bottomDockingElement.visibleDockingZoneFlag=!1),t._updateCarouselLayout()},getSidePanelVisibleFlag:function(){return this.sidePanelVisibleFlag},setSidePanelVisibleFlag:function(e){var t=this;"middleWidthDisplay"===t.elements.container.getAttribute("carousel-display-mode")?e?(t.sidePanelVisibleFlag=!0,t.elements.bottomDockingElement.dockingZoneContent=t.elements.rightViewContent,t.elements.bottomDockingElement.visibleDockingZoneFlag=!0):(t.sidePanelVisibleFlag=!1,t.rollVisibleFlag?(t.sidePanelVisibleFlag=!1,t.elements.bottomDockingElement.visibleDockingZoneFlag=!0,t.elements.bottomDockingElement.dockingZoneContent=t.elements.dockingZoneContentForBottom):t.elements.bottomDockingElement.visibleDockingZoneFlag=!1):e?(t.sidePanelVisibleFlag=!0,t.elements.rightDockingElement.visibleDockingZoneFlag=!0):(t.sidePanelVisibleFlag=!1,t.elements.rightDockingElement.visibleDockingZoneFlag=!1),t._updateCarouselLayout()},setCarouselHeaderVisibleFlag:function(e){!0===e?this.elements.header.style.display="":!1===e&&(this.elements.header.style.display="none")}})})),define("DS/CollectionView/LightBoxView",["UWA/Core","DS/CollectionView/CarouselView","DS/Controls/Button","i18n!DS/CollectionView/assets/nls/carousel.json"],(function(e,t,i,o){"use strict";return t.inherit({name:"lightbox",publishedProperties:{target:{defaultValue:document.body,type:"HTMLElement"},themeStyle:{defaultValue:"dark",type:"string"}},_postBuildView:function(){window._lb=this,this._parent(),this.elements.container.addClassName("wux-layouts-lightbox"),this._applyVisibleFlag()},_applyVisibleFlag:function(t){this.visibleFlag?this.elements.wrapper||(this.elements.wrapper=new e.Element("div",{class:"wux-layouts-lightbox-overlay",html:this.getContent()}),this.elements.wrapper.inject(this.target)):this.elements.wrapper&&(this.elements.wrapper.remove(),this.elements.wrapper=void 0,this.fire("close")),this._parent(t)},_applyToolBar:function(){this._parent();var e=this,t=new i({icon:{iconName:"close",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:{shortHelp:o.close,mouseRelativePosition:!1},clickMode:1}).inject(this.elements.headerToolbar);t.addEventListener("click",(function(t){t.stopPropagation(),e.visibleFlag=!1})),this._closeButton=t}})}));