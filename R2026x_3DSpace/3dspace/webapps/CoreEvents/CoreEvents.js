define("DS/CoreEvents/ModelEvents",["require","exports","UWA/Core","DS/UWAUtils/WUXUWAUtils2"],(function(t,s,i,n){"use strict";function e(t){return t.length=0,t=null}var o={parent:null,target:null,asyncPropagation:!1,callMode:"desc",debug:{delay:0}},r=function(){function t(t){if(!n.extendingClassFlag){this.options=i.extend(i.clone(o),t),this._target=this.options.target,this._listOfParents=[],this.options.parent&&this._setParent(this.options.parent);var s=this;this._pubsub={ongoingtopics:{},topics:{},subUid:-1,publish:function(t,i,n){if(this._spyEvents&&(console.warn("!!!"),this._spyEvents.call(t,i,n)),!this.topics[i])return!1;var e=this.topics[i],o=e?e.length:0;if("desc"===s.options.callMode)for(;o--;)e[o]&&e[o].func&&e[o].func.call(t,n,e[o].token);else if("asc"===s.options.callMode){for(this.ongoingtopics[i]=[];e[0];){e[0].func.call(t,n,e[0].token);var r=e.shift();r&&this.ongoingtopics[i].push(r)}this.topics[i]=this.ongoingtopics[i],this.ongoingtopics[i]=[]}return this},subscribe:function(t,s){this.topics[t]||(this.topics[t]=[]);var i=(++this.subUid).toString();return this.topics[t].push({token:i,func:s}),i},unsubscribe:function(t){for(var s=0,i=this.ongoingtopics.length;s<i;s++)this.ongoingtopics[s]&&this.ongoingtopics[s].token===t&&(this.ongoingtopics.splice(s,1),i--);for(var n in this.topics)if(this.topics[n])for(s=0,i=this.topics[n].length;s<i;s++)this.topics[n][s]&&this.topics[n][s].token===t&&(this.topics[n].splice(s,1),i--);return this}},this.init.apply(this,arguments)}}return t.prototype.init=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s]},t.prototype._setParent=function(t){this._listOfParents=[],this._addParent(t)},t.prototype._addParent=function(t){Array.isArray(t)?this._listOfParents=t:null!==t&&this._listOfParents.push(t)},t.prototype._unsetParent=function(t){var s=this._listOfParents.indexOf(t);-1!==s&&this._listOfParents.splice(s,1)},t.prototype._formatEvent=function(t){return("/"+t+"/").replace(/(\/+)/g,"/")},t.prototype._canPublishEvent=function(){if(this.__disableEventsCounter)return!1;for(var t=this._listOfParents,s=0;s<t.length;s++)if(t[s]._canPublishEvent())return!0;return void 0===this.__disableEventsCounter||0===this.__disableEventsCounter},t.prototype.disableEvents=function(){void 0!==this.__disableEventsCounter?this.__disableEventsCounter++:this.__disableEventsCounter=1},t.prototype.enableEvents=function(){void 0!==this.__disableEventsCounter&&this.__disableEventsCounter--},t.prototype.publish=function(t){if(this._canPublishEvent()){var s={context:t.context,event:t.event,formattedEvent:void 0===t.formattedEvent?this._formatEvent(t.event):t.formattedEvent,data:t.data,options:t.options,propagate:void 0===t.propagate||t.propagate,target:void 0===t.target?this._target:t.target,parent:void 0===t.parent?this._target:t.parent},i=this;if(s.target){var n={event:s.event,formattedEvent:s.formattedEvent,parent:s.parent,target:s.target,data:s.data,options:t.options,propagate:s.propagate,stopPropagation:function(){n.propagate=!1}};if(i.options.debug&&i.options.debug.delay?setTimeout((function(){i._pubsub.publish(s.context,n.formattedEvent,n)}),i.options.debug.delay):this._pubsub.publish(s.context,n.formattedEvent,n),n.propagate){var e=this._listOfParents;1===e.length?i._propagate(e[0],s):e.forEach((function(t){i._propagate(t,s)}))}}else this._pubsub.publish(s.context,s.formattedEvent,s.data)}},t.prototype._propagate=function(t,s){this.options.asyncPropagation?setTimeout((function(){t.publish(s)}),0):t.publish(s)},t.prototype.subscribe=function(t,s){var n={event:null};i.extend(n,t);var e=this._formatEvent(n.event);return this._pubsub.subscribe(e,s)},t.prototype.unsubscribeAll=function(t){var s=this;if(t){var i=this._formatEvent(t.event);this._pubsub.topics[i]&&this._pubsub.topics[i].forEach((function(t){s._pubsub.unsubscribe(t.token)}))}else for(var n in this._pubsub.topics)this._pubsub.topics[n]&&(this._pubsub.topics[n].forEach((function(t){s._pubsub.unsubscribe(t.token)})),e(this._pubsub.topics[n]))},t.prototype.destroy=function(){this.unsubscribeAll(),delete this._pubsub.topics,delete this._pubsub,delete this._target,e(this._listOfParents),delete this.options},t.prototype.addEventListener=function(t,s){return this.subscribe({event:t},s)},t.prototype.subscribeOnce=function(t,s){var i=this,n=this.subscribe(t,(function(t){i.unsubscribe(n),s.call(this,t)}));return n},t.prototype.unsubscribe=function(t){this._pubsub&&this._pubsub.unsubscribe(t)},t.prototype._beginSpyEvents=function(t){this._pubsub._spyEvents=t},t.prototype._endSpyEvents=function(){this._pubsub._spyEvents=null},t.extend=n.extend,t.inherit=n.inherit,t.singleton=n.singleton,t}();return r})),define("DS/CoreEvents/Events",["UWA/Core","UWA/Class"],(function(t,s){"use strict";var i={topics:{},subUid:-1,publish:function(t,s){if(!this.topics[t])return!1;for(var i=this.topics[t],n=i?i.length:0;n--;)i[n]&&i[n].func&&i[n].func(s);return this},subscribe:function(t,s){this.topics[t]||(this.topics[t]=[]);var i=(++this.subUid).toString();return this.topics[t].push({token:i,func:s}),i},unsubscribe:function(t){for(var s in this.topics)if(this.topics[s])for(var i=0,n=this.topics[s].length;i<n;i++)this.topics[s][i]&&this.topics[s][i].token===t&&(this.topics[s].splice(i,1),n--);return this}},n=s.singleton({init:function(t){this._parent(!1)},_formatEvent:function(t){return t=("/"+t+"/").replace(/(\/+)/g,"/")},publish:function(s){var n={event:null,data:null,useFullInfos:!1};t.extend(n,s),n.event=this._formatEvent(n.event),n.useFullInfos?i.publish(n.event,n):i.publish(n.event,n.data)},subscribe:function(s,n,e){void 0===e&&(e=!1);var o={event:null};t.extend(o,s);var r=this._formatEvent(o.event);return i.subscribe(r,n)},subscribeOnce:function(t,s){var i=this,n=this.subscribe(t,(function(t){i.unsubscribe(n),s.call(this,t)}));return n},unsubscribe:function(t){i.unsubscribe(t)}});return t.namespace("WUX/Events",n)}));