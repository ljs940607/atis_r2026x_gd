define("DS/CAT3DWModels/CAT3DWloaderSequencer",["DS/Visualization/ModelLoader","DS/CAT3DWInfra/CAT3DWMutex","DS/CAT3DWInfra/CAT3DWPreferenceManager"],(function(e,t,i){"use strict";const n=new t;return function(){this.LoadModel=async function(t,o,r){const a=await n.lock();await function(t,n,o){return new Promise((r=>{let a,d=n.getView();d&&d.getModelNode&&(a=d.getModelNode());var l=new e;"whiteboard"===i.getPreferenceValue("appMode")&&l.setViewer&&l.setViewer(t.viewer),l.setOnLoadedCallback((function(){d.initialize(),o&&(o(n),r())})),l.setOnErrorCallback((function(e){console.error(e),o&&(o(n),r())})),null!==t.extension?l.loadModel({filename:t.url,proxyurl:"none",format:t.extension,withCredentials:i.getPreferenceValue("UseCredentials"),viewer:t.viewer},a):l.loadModel({filename:t.url,proxyurl:"none",withCredentials:i.getPreferenceValue("UseCredentials")},a)}))}(t,o,r),a()}}})),define("DS/CAT3DWModels/CAT3DWModelView",["DS/CAT3DWInfra/CAT3DWPreferenceManager","DS/CAT3DWMedia/CAT3DWMediaView","DS/Visualization/Node3D","DS/Visualization/ThreeJS_DS","DS/Visualization/SceneGraphFactory","UWA/Core"],(function(e,t,i,n,o,r){"use strict";var a=t.extend({init:function(e,t){this._parent(e,t),this._model3DNode=new i("3dobjet"),this.addChild(this._model3DNode)},initialize:function(t){this._mediaID=t,this._model3DNode.mediaID=t;for(var i=this.getBoundingBox().center(),r=(new n.Matrix4).makeTranslation(-i.x,-i.y,-i.z),d=0;d<this.children.length;d++)this.children[d].applyMatrix(r);if("whiteboard"===e.getPreferenceValue("appMode")){let e=100/this.parents[0].getBoundingSphere().radius,t=(new n.Matrix4).makeScale(e,e,e),i=this.getMatrix();i.multiplyMatrices(t,i),this.setMatrix(i,!0);let r=this.getBoundingBox();this.cuboid=o.createCuboidNode({cornerPoint:r.min,firstAxis:new n.Vector3(r.max.x-r.min.x,0,0),secondAxis:new n.Vector3(0,r.max.y-r.min.y,0),thirdAxis:new n.Vector3(0,0,r.max.z-r.min.z),fill:!0,material:a._invisibleMaterial}),t=(new n.Matrix4).makeScale(.8,.8,.8),this.cuboid.applyMatrix(t),this.addChild(this.cuboid)}this._parent()},getMediaID:function(){return this._mediaID},getModelNode:function(){return this._model3DNode},getCorners:function(){for(var e=this.getCorners3D(),t=[],i=0;i<e.length;i++)t.push(this._viewer.currentViewpoint.project(e[i]));var o=Math.min(t[0].x,t[1].x,t[2].x,t[3].x,t[4].x,t[5].x,t[6].x,t[7].x),r=Math.max(t[0].x,t[1].x,t[2].x,t[3].x,t[4].x,t[5].x,t[6].x,t[7].x),a=Math.min(t[0].y,t[1].y,t[2].y,t[3].y,t[4].y,t[5].y,t[6].y,t[7].y),d=Math.max(t[0].y,t[1].y,t[2].y,t[3].y,t[4].y,t[5].y,t[6].y,t[7].y),l=new n.Plane(new n.Vector3(0,0,1),50),s=this._viewer.currentViewpoint.create3DRayFrom2DPoint(new n.Vector2(o,a));return{topLeft:s.intersectPlane(l),topRight:(s=this._viewer.currentViewpoint.create3DRayFrom2DPoint(new n.Vector2(r,a))).intersectPlane(l),bottomRight:(s=this._viewer.currentViewpoint.create3DRayFrom2DPoint(new n.Vector2(r,d))).intersectPlane(l),bottomLeft:(s=this._viewer.currentViewpoint.create3DRayFrom2DPoint(new n.Vector2(o,d))).intersectPlane(l)}},getCorners3D:function(){var e=this.getMatrixWorld(),t=this.getBoundingBox();return[t.min.clone().applyMatrix4(e),new n.Vector3(t.min.x,t.max.y,t.min.z).applyMatrix4(e),new n.Vector3(t.max.x,t.max.y,t.min.z).applyMatrix4(e),new n.Vector3(t.max.x,t.min.y,t.min.z).applyMatrix4(e),t.max.clone().applyMatrix4(e),new n.Vector3(t.max.x,t.min.y,t.max.z).applyMatrix4(e),new n.Vector3(t.min.x,t.min.y,t.max.z).applyMatrix4(e),new n.Vector3(t.min.x,t.max.y,t.max.z).applyMatrix4(e)]},dispose:function(){this.remove(this._model3DNode),this._model3DNode=null,this._parent()},removeModel:function(){this._model3DNode&&this._model3DNode.children&&this._model3DNode.children[0]&&(this._model3DNode.removeChild(this._model3DNode.children[0]),this.cuboid&&this.removeChild(this.cuboid))}});return a._invisibleMaterial=new n.MeshBasicMaterial({color:new n.Color(255),transparent:!0,opacity:0}),a._invisibleMaterial.force=!0,r.namespace("DS/CAT3DWModels/CAT3DWModelView",a)})),define("DS/CAT3DWModels/CAT3DWModel",["DS/CAT3DWMedia/CAT3DWMedia","DS/CAT3DWModels/CAT3DWModelView","UWA/Core"],(function(e,t,i){"use strict";var n=e.extend({init:function(e){this._parent(e)},createMediaView:function(e){return new t(this,e)},getType:function(){return"CAT3DWModel"}});return i.namespace("DS/CAT3DWModels/CAT3DWModel",n)})),define("DS/CAT3DWModels/CAT3DWModelsManager",["DS/CAT3DWMedia/CAT3DWMediaManager","DS/CAT3DWModels/CAT3DWModel","DS/Visualization/Node3D","DS/CAT3DWVisu/CAT3DWPickingControllerFactory"],(function(e,t,i,n){"use strict";return e.extend({init:function(){this._parent()},initialize:function(){this._parent();const e=this._viewer.getRootNode(),t=n.getRootModelNodeName(),o=n.getRootImageNodeName();this._rootNode=e.getChildByName(o),this._rootNode||(this._rootNode=new i(o),e.addChild(this._rootNode)),this._modelRootNode=e.getChildByName(t),this._modelRootNode||(this._modelRootNode=new i(t),e.addChild(this._modelRootNode))},createMediaObject:function(e){return e.modelParentNode=this._modelRootNode,new t(e)},getResetEvent:function(){return"CAT3DWModelsManagerReset"}})}));