define("DS/DMUBaseCtxCommands/DMUGenerateIssueFromSelectionCmd",["DS/CATWebUXComponents/DMUCommand","DS/PADUtils/PADContext","DS/DMUBaseExperience/DMUContextManager","DS/Selection/CSOManager","DS/DMUControls/DMUInfoModalDiv","DS/CATWebUXComponents/DMUCommandsManager","i18n!DS/DMUBaseCtxCommands/assets/nls/DMUBaseCtxCommands"],(function(e,t,n,a,i,r,o){"use strict";return e.extend({init:function(e){e.mode="shared";var s,l=this;this._parent(e),this.beginExecute=function(){var e=t.get(),d=n.giveEventsController({viewer:l.getFrameWindow().getViewer()}),g=n.getReviewContext({viewer:l.getFrameWindow().getViewer()});(s=new i).display({modal:!0,frmWindow:l.getFrameWindow(),type:"load",message:o.GeneratingIssue});var m,C=g.getValidation().getHighlights(),u=g.getValidation().getMarkups(),c=a.get();if(1===c.length)var v=c[0].pathElement.getLastElement(!0);if(v.getDMUType&&("DMUSlide"===v.getDMUType()||"DMUComment"===v.getDMUType()))for(let e=0;e<C.length;e++)if(!C[e]._lIssuesIDs.length)for(let t=0;t<u.length;t++){var D=u[t].getRepRef().getMarkupContent()?u[t].getRepRef().getMarkupContent().getSlides():[];for(let t=0;t<D.length;t++)if(D[t].getNode()===v&&C[e].getPresentationSlideID()===D[t].getAttribute("sUuid")&&(m=C[e]),D[t].getDMUObjects&&D[t].getDMUObjects().length){var p=D[t].getDMUObjects();for(let t=0;t<p.length;t++)if(p[t].getDMUComments()&&p[t].getDMUComments().length){var f=p[t].getDMUComments();for(let t=0;t<f.length;t++)f[t].getNode()===v&&C[e].getPresentationSlideID()===f[t].getAttribute("sUuid")&&(m=C[e])}}}if(m){var h=d.addEvent("onHighlightSelectionCompleted",(function(){d.removeEvent(h);var t,n=m.getPlmID();(t="issueTemplate"===localStorage.getItem("issueCreationType")?r.getCommand("CATWebUXGenerateIssueTemplateHdr",e.getCommandContext()):r.getCommand("CATWebUXGenerateIssueHdr",e.getCommandContext()))&&t.begin();const a=d.addEvent("onTICCreationComplete",(function(e){d.fireEvent("onTICFromSelectionCreationComplete",e),d.fireEvent("onIssueDataRequested",{physicalId:e.ticID,onComplete:function(e){var t={description:e.issueDescription,name:e.issueTitle,priority:e.issuePriority,objectId:n};d.fireEvent("updateHighlightAttributes",t)}}),d.removeEvent(a),l.end()})),i=d.addEvent("onTICCreationCancel",(function(){(event&&event.target&&"create-view-footer-cancel-btn"===event.target.id||event&&event.target&&event.target.title&&"Close"===event.target.title)&&d.removeEvent(a),d.removeEvent(i)}))}));d.fireEvent("onExpanderSelectRequested",{type:"Highlight",id:m.getPlmID()})}else{var S=r.getCommand("DMUAddHighlightHdr",e.getCommandContext());S&&(S.options.arguments[0].Rating="Undefined",S.begin());const t=d.addEvent("onHighlightCreationCompleted",(function(n){S.options.arguments[0].Rating="Low";var a,i=n.id;(a="issueTemplate"===localStorage.getItem("issueCreationType")?r.getCommand("CATWebUXGenerateIssueTemplateHdr",e.getCommandContext()):r.getCommand("CATWebUXGenerateIssueHdr",e.getCommandContext()))&&a.begin();const o=d.addEvent("onTICCreationComplete",(function(e){d.fireEvent("onTICFromSelectionCreationComplete",e),d.fireEvent("onIssueDataRequested",{physicalId:e.ticID,onComplete:function(e){var t={description:e.issueDescription,name:e.issueTitle,priority:e.issuePriority,objectId:i};d.fireEvent("updateHighlightAttributes",t)}}),d.removeEvent(o),l.end()})),s=d.addEvent("onTICCreationCancel",(function(){(event&&event.target&&"create-view-footer-cancel-btn"===event.target.id||event&&event.target&&event.target.title&&"Close"===event.target.title)&&d.removeEvent(o),d.removeEvent(s)}));d.removeEvent(t)}))}};var d=this._destroy.bind(this);this._destroy=function(){s&&(s.destroy(),s=null),l.end?l.end():l.done(),d()}}})})),define("DS/DMUBaseCtxCommands/DMUGenerateTaskFromSelectionCmd",["DS/CATWebUXComponents/DMUCommand","DS/PADUtils/PADContext","DS/DMUBaseExperience/DMUContextManager","DS/Selection/CSOManager","DS/DMUControls/DMUInfoModalDiv","DS/CATWebUXComponents/DMUCommandsManager","i18n!DS/DMUBaseCtxCommands/assets/nls/DMUBaseCtxCommands"],(function(e,t,n,a,i,r,o){"use strict";return e.extend({init:function(e){e.mode="shared";var s,l=this;this._parent(e),this.beginExecute=function(){var e=t.get(),d=n.giveEventsController({viewer:l.getFrameWindow().getViewer()}),g=n.getReviewContext({viewer:l.getFrameWindow().getViewer()});(s=new i).display({modal:!0,frmWindow:l.getFrameWindow(),type:"load",message:o.GeneratingTask});var m,C=g.getValidation().getHighlights(),u=g.getValidation().getMarkups(),c=a.get();if(1===c.length)var v=c[0].pathElement.getLastElement(!0);if(v.getDMUType&&("DMUSlide"===v.getDMUType()||"DMUComment"===v.getDMUType()))for(let e=0;e<C.length;e++)if(!C[e]._lTasksIDs.length)for(let t=0;t<u.length;t++){var D=u[t].getRepRef().getMarkupContent()?u[t].getRepRef().getMarkupContent().getSlides():[];for(let t=0;t<D.length;t++)if(D[t].getNode()===v&&C[e].getPresentationSlideID()===D[t].getAttribute("sUuid")&&(m=C[e]),D[t].getDMUObjects&&D[t].getDMUObjects().length){var p=D[t].getDMUObjects();for(let t=0;t<p.length;t++)if(p[t].getDMUComments()&&p[t].getDMUComments().length){var f=p[t].getDMUComments();for(let t=0;t<f.length;t++)f[t].getNode()===v&&C[e].getPresentationSlideID()===f[t].getAttribute("sUuid")&&(m=C[e])}}}if(m){var h=d.addEvent("onHighlightSelectionCompleted",(function(){d.removeEvent(h);var t=m.getPlmID(),n=r.getCommand("CATWebUXGenerateTaskHdr",e.getCommandContext());n&&n.begin();const a=d.addEvent("onTICCreationComplete",(function(e){d.fireEvent("onTICFromSelectionCreationComplete",e),d.fireEvent("onTaskDataRequested",{physicalId:e.ticID,onComplete:function(e){var n={description:e.taskDescription,name:e.taskTitle,objectId:t};d.fireEvent("updateHighlightAttributes",n)}}),d.removeEvent(a),l.end()})),i=d.addEvent("onTICCreationCancel",(function(){(event&&event.target&&"create-view-footer-cancel-btn"===event.target.id||event&&event.target&&event.target.title&&"Close"===event.target.title)&&d.removeEvent(a),d.removeEvent(i)}))}));d.fireEvent("onExpanderSelectRequested",{type:"Highlight",id:m.getPlmID()})}else{var S=r.getCommand("DMUAddHighlightHdr",e.getCommandContext());S&&(S.options.arguments[0].Rating="Undefined",S.begin());const t=d.addEvent("onHighlightCreationCompleted",(function(n){S.options.arguments[0].Rating="Low";var a=n.id,i=r.getCommand("CATWebUXGenerateTaskHdr",e.getCommandContext());i&&i.begin();const o=d.addEvent("onTICCreationComplete",(function(e){d.fireEvent("onTICFromSelectionCreationComplete",e),d.fireEvent("onTaskDataRequested",{physicalId:e.ticID,onComplete:function(e){var t={description:e.taskDescription,name:e.taskTitle,objectId:a};d.fireEvent("updateHighlightAttributes",t)}}),d.removeEvent(o),l.end()})),s=d.addEvent("onTICCreationCancel",(function(){(event&&event.target&&"create-view-footer-cancel-btn"===event.target.id||event&&event.target&&event.target.title&&"Close"===event.target.title)&&d.removeEvent(o),d.removeEvent(s)}));d.removeEvent(t)}))}};var d=this._destroy.bind(this);this._destroy=function(){s&&(s.destroy(),s=null),l.end?l.end():l.done(),d()}}})})),define("DS/DMUBaseCtxCommands/DMUGenerateTaskFromSelection",["DS/CATWebUXComponents/DMUCommand","DS/PADUtils/PADContext","DS/DMUBaseExperience/DMUContextManager","DS/Selection/CSOManager","DS/CoreEvents/Events","DS/DMUControls/DMUInfoModalDiv","DS/CATWebUXComponents/DMUCommandsManager","i18n!DS/DMUBaseCtxCommands/assets/nls/DMUBaseCtxCommands"],(function(e,t,n,a,i,r,o,s){"use strict";return{generateTaskFromSelection:function(){var e,i=t.get(),l=n.giveEventsController({viewer:i.getViewer()}),d=n.getReviewContext({viewer:i.getViewer()});(e=new r).display({modal:!0,frmWindow:i.getFrameWindow(),type:"load",message:s.CreatingHighlight});var g,m=d.getValidation().getHighlights(),C=d.getValidation().getMarkups(),u=a.get();if(1===u.length)var c=u[0].pathElement.getLastElement(!0);if(c.getDMUType&&("DMUSlide"===c.getDMUType()||"DMUComment"===c.getDMUType()))for(let e=0;e<m.length;e++)if(!m[e]._lTasksIDs.length)for(let t=0;t<C.length;t++){var v=C[t].getRepRef().getMarkupContent()?C[t].getRepRef().getMarkupContent().getSlides():[];for(let t=0;t<v.length;t++)if(v[t].getNode()===c&&m[e].getPresentationSlideID()===v[t].getAttribute("sUuid")&&(g=m[e]),v[t].getDMUObjects&&v[t].getDMUObjects().length){var D=v[t].getDMUObjects();for(let t=0;t<D.length;t++)if(D[t].getDMUComments()&&D[t].getDMUComments().length){var p=D[t].getDMUComments();for(let t=0;t<p.length;t++)p[t].getNode()===c&&m[e].getPresentationSlideID()===p[t].getAttribute("sUuid")&&(g=m[e])}}}if(g){var f=l.addEvent("onHighlightSelectionCompleted",(function(){l.removeEvent(f);var t=g.getPlmID(),n=o.getCommand("CATWebUXGenerateTaskHdr",i.getCommandContext());n&&n.begin(),e&&(e.destroy(),e=null);const a=l.addEvent("onTICCreationComplete",(function(n){l.fireEvent("onTICFromSelectionCreationComplete",n),l.fireEvent("onTaskDataRequested",{physicalId:n.ticID,onComplete:function(n){var a={description:n.taskDescription,name:n.taskTitle,objectId:t};l.fireEvent("updateHighlightAttributes",a),e&&(e.destroy(),e=null)}}),l.removeEvent(a)})),r=l.addEvent("onTICCreationCancel",(function(){(event&&event.target&&"create-view-footer-cancel-btn"===event.target.id||event&&event.target&&event.target.title&&"Close"===event.target.title)&&l.removeEvent(a),l.removeEvent(r),e&&(e.destroy(),e=null)}))}));l.fireEvent("onExpanderSelectRequested",{type:"Highlight",id:g.getPlmID()})}else{var h=o.getCommand("DMUAddHighlightHdr",i.getCommandContext());h&&(h.options.arguments.Rating="Undefined",h.begin());const t=l.addEvent("onHighlightCreationCompleted",(function(n){h.options.arguments.Rating="Low";var a=n.id,r=o.getCommand("CATWebUXGenerateTaskHdr",i.getCommandContext());r&&r.begin(),e&&(e.destroy(),e=null);const s=l.addEvent("onTICCreationComplete",(function(t){l.fireEvent("onTICFromSelectionCreationComplete",t),l.fireEvent("onTaskDataRequested",{physicalId:t.ticID,onComplete:function(t){var n={description:t.taskDescription,name:t.taskTitle,objectId:a};l.fireEvent("updateHighlightAttributes",n),e&&(e.destroy(),e=null)}}),l.removeEvent(s)})),d=l.addEvent("onTICCreationCancel",(function(){(event&&event.target&&"create-view-footer-cancel-btn"===event.target.id||event&&event.target&&event.target.title&&"Close"===event.target.title)&&l.removeEvent(s),l.removeEvent(d),e&&(e.destroy(),e=null)}));l.removeEvent(t)}))}}}})),define("DS/DMUBaseCtxCommands/DMUGenerateIssueFromSelection",["DS/CATWebUXComponents/DMUCommand","DS/PADUtils/PADContext","DS/DMUBaseExperience/DMUContextManager","DS/Selection/CSOManager","DS/CoreEvents/Events","DS/DMUControls/DMUInfoModalDiv","DS/CATWebUXComponents/DMUCommandsManager","i18n!DS/DMUBaseCtxCommands/assets/nls/DMUBaseCtxCommands"],(function(e,t,n,a,i,r,o,s){"use strict";return{generateIssueFromSelection:function(){var e,i=t.get(),l=n.giveEventsController({viewer:i.getViewer()}),d=n.getReviewContext({viewer:i.getViewer()});(e=new r).display({modal:!0,frmWindow:i.getFrameWindow(),type:"load",message:s.CreatingHighlight});var g,m=d.getValidation().getHighlights(),C=d.getValidation().getMarkups(),u=a.get();if(1===u.length)var c=u[0].pathElement.getLastElement(!0);if(c.getDMUType&&("DMUSlide"===c.getDMUType()||"DMUComment"===c.getDMUType()))for(let e=0;e<m.length;e++)if(!m[e]._lIssuesIDs.length)for(let t=0;t<C.length;t++){var v=C[t].getRepRef().getMarkupContent()?C[t].getRepRef().getMarkupContent().getSlides():[];for(let t=0;t<v.length;t++)if(v[t].getNode()===c&&m[e].getPresentationSlideID()===v[t].getAttribute("sUuid")&&(g=m[e]),v[t].getDMUObjects&&v[t].getDMUObjects().length){var D=v[t].getDMUObjects();for(let t=0;t<D.length;t++)if(D[t].getDMUComments()&&D[t].getDMUComments().length){var p=D[t].getDMUComments();for(let t=0;t<p.length;t++)p[t].getNode()===c&&m[e].getPresentationSlideID()===p[t].getAttribute("sUuid")&&(g=m[e])}}}if(g){var f=l.addEvent("onHighlightSelectionCompleted",(function(){l.removeEvent(f);var t,n=g.getPlmID();(t="issueTemplate"===localStorage.getItem("issueCreationType")?o.getCommand("CATWebUXGenerateIssueTemplateHdr",i.getCommandContext()):o.getCommand("CATWebUXGenerateIssueHdr",i.getCommandContext()))&&t.begin(),e&&(e.destroy(),e=null);const a=l.addEvent("onTICCreationComplete",(function(t){l.fireEvent("onTICFromSelectionCreationComplete",t),l.fireEvent("onIssueDataRequested",{physicalId:t.ticID,onComplete:function(t){var a={description:t.issueDescription,name:t.issueTitle,priority:t.issuePriority,objectId:n};l.fireEvent("updateHighlightAttributes",a),e&&(e.destroy(),e=null)}}),l.removeEvent(a)})),r=l.addEvent("onTICCreationCancel",(function(){(event&&event.target&&"create-view-footer-cancel-btn"===event.target.id||event&&event.target&&event.target.title&&"Close"===event.target.title)&&l.removeEvent(a),l.removeEvent(r),e&&(e.destroy(),e=null)}))}));l.fireEvent("onExpanderSelectRequested",{type:"Highlight",id:g.getPlmID()})}else{var h=o.getCommand("DMUAddHighlightHdr",i.getCommandContext());h&&(h.options.arguments.Rating="Undefined",h.begin());const t=l.addEvent("onHighlightCreationCompleted",(function(n){h.options.arguments.Rating="Low";var a,r=n.id;(a="issueTemplate"===localStorage.getItem("issueCreationType")?o.getCommand("CATWebUXGenerateIssueTemplateHdr",i.getCommandContext()):o.getCommand("CATWebUXGenerateIssueHdr",i.getCommandContext()))&&a.begin(),e&&(e.destroy(),e=null);const s=l.addEvent("onTICCreationComplete",(function(t){l.fireEvent("onTICFromSelectionCreationComplete",t),l.fireEvent("onIssueDataRequested",{physicalId:t.ticID,onComplete:function(t){var n={description:t.issueDescription,name:t.issueTitle,priority:t.issuePriority,objectId:r};l.fireEvent("updateHighlightAttributes",n),e&&(e.destroy(),e=null)}}),l.removeEvent(s)})),d=l.addEvent("onTICCreationCancel",(function(){(event&&event.target&&"create-view-footer-cancel-btn"===event.target.id||event&&event.target&&event.target.title&&"Close"===event.target.title)&&l.removeEvent(s),l.removeEvent(d),e&&(e.destroy(),e=null)}));l.removeEvent(t)}))}}}})),define("DS/DMUBaseCtxCommands/DMUPropertiesCmd",["UWA/Core","DS/CATWebUXComponents/DMUCommand","DS/DMUBaseExperience/DMUContextManager","DS/DMUBaseExperience/DMUToolsClipping","DS/Selection/CSOManager","DS/Windows/Dialog","DS/Controls/Button","i18n!DS/DMUBaseCtxCommands/assets/nls/DMUBaseCtxCommands"],(function(e,t,n,a,i,r,o,s){"use strict";return t.extend({init:function(t){t.mode="shared",this._parent(t);var l=this;this.beginExecute=function(){var t,d=n.getReviewContext({viewer:l.getFrameWindow().getViewer()});if(d){var g=[],m=[];if("DMUClippingPropertiesHdr"===this._id){let e=a.retriveClippingObjsFromSlide(d);e&&1===e.length&&(g.push(e[0].getType()),m.push(e[0]))}else for(var C=i.get(),u=0;u<C.length;u++){var c=d.getDMUObjectFromPathElement(C[u].pathElement);c&&(-1===g.indexOf(c.getType())?(0===g.length&&m.push(c),g.push(c.getType())):m.push(c))}if(1===g.length&&m.length>0&&m[0]&&m[0].getPropertiesObject){var v=m[0].getPropertiesObject();if(v){var D=null,p=e.createElement("div");v.getPropertiesDisplay(m,p),v.getCustomParameter&&(D=v.getCustomParameter());var f=function(){var e=v.getPropertiesToSet();if(e.length>0){for(var t=0;t<m.length;t++)m[t].setAttributes(e);v.afterSetProperties(m,e);var a=n.giveEventsController({viewer:l.getFrameWindow().getViewer()});a&&a.fireEvent("onSaveRequested")}},h=new o({emphasize:"primary",label:s.propertiesPanel.okLabel,onClick:function(){f(),t.close?t.close():t.destroy()}}),S=new o({label:s.propertiesPanel.applyLabel,onClick:f}),M=new o({label:s.propertiesPanel.closeLabel,onClick:function(){t.close?t.close():t.destroy()}});if((t=new r({modalFlag:!0,ensureHeightDefinitionOnHierarchy:!0,title:s.propertiesPanel.title,content:p,immersiveFrame:this.getFrameWindow().getImmersiveFrame(),buttons:{Abort:M,Ok:h,Apply:S},resizableFlag:!(!D||!D.resizableFlag)&&D.resizableFlag})).addEventListener("close",(function(){l.end()})),D&&D.heightToWidthRatio&&t.getContent){var U=t.getContent();if(U&&U.getSize){var b=U.getSize();b.height&&b.width&&(t.height=b.width*D.heightToWidthRatio,t.fire("resize"))}}}}}this.done()}}})})),define("DS/DMUBaseCtxCommands/DMUSetIssueCreationTypeCmd",["DS/CATWebUXComponents/DMUCommand","DS/DMUBaseExperience/DMUContextManager","DS/Selection/CSOManager"],(function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e);var a=this;a._bCmdState=!1;var i=(e.frameWindow||this.getFrameWindow()).getViewer();this.beginExecute=function(){var e=n.get();for(let t=0;t<e.length;t++)e[t].pathElement.getLastElement().getDMUType&&"Highlights"===e[t].pathElement.getLastElement().getDMUType()&&("DMUSetIssueCreationTypeHdr"===a.options.ID?e[t].pathElement.getLastElement().getOwner().setIssueCreationType("issue"):e[t].pathElement.getLastElement().getOwner().setIssueCreationType("issueTemplate"));var r=t.giveEventsController({viewer:i}),o="DMUSetIssueCreationTypeHdr"===a.options.ID?"issue":"issueTemplate";r&&r.fireEvent("onSetIssueCreationTypeRequested",{type:o}),a.cancel()},this.getState=function(){return a._bCmdState},this.setState=function(e){a._bCmdState=e},this.initStatusBarState=function(){"DMUSetIssueCreationTypeHdr"===a.options.ID?this.setState(!0):this.setState(!1)},this.initStatusBarState()}})})),define("DS/DMUBaseCtxCommands/DMUContextCmd",["DS/CATWebUXComponents/DMUCommand","DS/Selection/CSOManager","DS/DMUBaseExperience/DMUContextManager"],(function(e,t,n){"use strict";return e.extend({init:function(e){var t=e||{};t.mode="shared",this._parent(t),this._bCmdState=!1,this.getState=function(){return this._bCmdState},this.setState=function(e){this._bCmdState=e}},beginExecute:function(e){this._parent(e);for(var a=t.get(),i=[],r=[],o=n.getReviewContext({viewer:this.getFrameWindow().getViewer()}),s=0;s<a.length;s++){var l=o.getDMUObjectFromPathElement(a[s].pathElement);l&&i.push(l)}switch(this._id){case"DMUNoLeaderHdr":r.push({name:"bHasALeader",value:!1});break;case"DMUArrowLeaderHdr":r.push({name:"bHasALeader",value:!0}),r.push({name:"sLeaderEndType",value:"Arrow"});break;case"DMUBubbleLeaderHdr":r.push({name:"bHasALeader",value:!0}),r.push({name:"sLeaderEndType",value:"Bubble"});break;case"DMUCrossLeaderHdr":r.push({name:"bHasALeader",value:!0}),r.push({name:"sLeaderEndType",value:"Cross"});break;case"DMUSquareLeaderHdr":r.push({name:"bHasALeader",value:!0}),r.push({name:"sLeaderEndType",value:"Square"});break;case"DMUNoEndLeaderHdr":r.push({name:"bHasALeader",value:!0}),r.push({name:"sLeaderEndType",value:"No end"})}r.length>0&&i.forEach((function(e){for(var t=[],n=0;n<r.length;n++)void 0!==e.getAttribute(r[n].name)&&t.push(r[n]);t.length>0&&(e.setAttributes(t),e.refreshNode())})),this.getFrameWindow().getViewer().render(),o&&o.getCurrentSessionMarkup()&&o.getCurrentSessionMarkup().getCurrentSlide()&&o.getCurrentSessionMarkup().getCurrentSlide().fireEvent("onSlidePreviewRefreshRequired",{dmuObject:o.getCurrentSessionMarkup().getCurrentSlide()}),this.done()}})})),define("DS/DMUBaseCtxCommands/DMUBaseContextCmd",["DS/CATWebUXComponents/DMUCommand","DS/Visualization/ThreeJS_DS","DS/Selection/CSOManager","DS/DMUBaseExperience/DMUContextManager","DS/DMUBaseExperience/EXPToolsVisualization"],(function(e,t,n,a,i){"use strict";let r=e.extend({init:function(e){var t=e||{};t.mode="shared",this._parent(t)},beginExecute:function(e){this._parent(e);var r,o=this;if(this.options&&this.options.args&&this.options.args.onOpenCtxBar)o.cancel();else{var s=n.get(),l=this._id.replace("Marker_","").replace("Measure_","").replace("Section_",""),d=a.getReviewContext({viewer:this.getFrameWindow().getViewer()});if(d){var g;for(r=0;r<s.length;r++)if(g=d.getDMUObjectFromPathElement(s[r].pathElement)){if("Marker3DStamp"!==g.getAttribute("sType"))switch(l){case"DMUDefaultStyleHdr":g.hasAttribute("sFontStyle")&&-1===g.getType().indexOf("Picture")&&(g.setAttributes([{name:"fOpacity",value:1},{name:"cFontColor",value:new t.Color("#000000")},{name:"sFontStyle",value:"normal"},{name:"cFillStyleColor",value:new t.Color("#ffffff")},{name:"bIsFilled",value:!0},{name:"bHasBorder",value:!0},{name:"fLineStyleThicknessIndex",value:0},{name:"sLineStylePattern",value:"1"},{name:"cLineStyleColor",value:new t.Color("#afafaf")},{name:"fLeaderStyleThicknessIndex",value:0},{name:"sLeaderStylePattern",value:"1"},{name:"cLeaderStyleColor",value:new t.Color("#3d3d3d")}]),g.refreshNode(),m());break;case"DMUMeasureStyleHdr":g.hasAttribute("sFontStyle")&&-1===g.getType().indexOf("Picture")&&(g.setAttributes([{name:"fOpacity",value:1},{name:"cFontColor",value:new t.Color("#ffffff")},{name:"sFontStyle",value:"normal"},{name:"cFillStyleColor",value:new t.Color("#368ec4")},{name:"bIsFilled",value:!0},{name:"bHasBorder",value:!1},{name:"fLineStyleThicknessIndex",value:0},{name:"sLineStylePattern",value:"1"},{name:"cLineStyleColor",value:new t.Color("#3d3d3d")},{name:"fLeaderStyleThicknessIndex",value:0},{name:"sLeaderStylePattern",value:"1"},{name:"cLeaderStyleColor",value:new t.Color("#3d3d3d")}]),g.refreshNode(),m());break;case"DMUPostitStyleHdr":g.hasAttribute("sFontStyle")&&-1===g.getType().indexOf("Picture")&&(g.setAttributes([{name:"fOpacity",value:1},{name:"cFontColor",value:new t.Color("#000000")},{name:"sFontStyle",value:"italic"},{name:"cFillStyleColor",value:new t.Color("#fee000")},{name:"bIsFilled",value:!0},{name:"bHasBorder",value:!1},{name:"fLineStyleThicknessIndex",value:0},{name:"sLineStylePattern",value:"1"},{name:"cLineStyleColor",value:new t.Color("#ff8a2e")},{name:"fLeaderStyleThicknessIndex",value:0},{name:"sLeaderStylePattern",value:"1"},{name:"cLeaderStyleColor",value:new t.Color("#ff8a2e")}]),g.refreshNode(),m());break;case"DMUValidateStyleHdr":g.hasAttribute("sFontStyle")&&-1===g.getType().indexOf("Picture")&&(g.setAttributes([{name:"fOpacity",value:1},{name:"cFontColor",value:new t.Color("#ffffff")},{name:"sFontStyle",value:"normal"},{name:"cFillStyleColor",value:new t.Color("#57b847")},{name:"bIsFilled",value:!0},{name:"bHasBorder",value:!1},{name:"fLineStyleThicknessIndex",value:0},{name:"sLineStylePattern",value:"1"},{name:"cLineStyleColor",value:new t.Color("#477738")},{name:"fLeaderStyleThicknessIndex",value:0},{name:"sLeaderStylePattern",value:"1"},{name:"cLeaderStyleColor",value:new t.Color("#477738")}]),g.refreshNode(),m());break;case"DMUWarningStyleHdr":g.hasAttribute("sFontStyle")&&-1===g.getType().indexOf("Picture")&&(g.setAttributes([{name:"fOpacity",value:1},{name:"cFontColor",value:new t.Color("#ffffff")},{name:"sFontStyle",value:"normal"},{name:"cFillStyleColor",value:new t.Color("#ff8a2e")},{name:"bIsFilled",value:!0},{name:"bHasBorder",value:!1},{name:"fLineStyleThicknessIndex",value:0},{name:"sLineStylePattern",value:"1"},{name:"cLineStyleColor",value:new t.Color("#8f4c00")},{name:"fLeaderStyleThicknessIndex",value:0},{name:"sLeaderStylePattern",value:"1"},{name:"cLeaderStyleColor",value:new t.Color("#8f4c00")}]),g.refreshNode(),m());break;case"DMUCautionStyleHdr":g.hasAttribute("sFontStyle")&&-1===g.getType().indexOf("Picture")&&(g.setAttributes([{name:"fOpacity",value:1},{name:"cFontColor",value:new t.Color("#ffffff")},{name:"sFontStyle",value:"bold"},{name:"cFillStyleColor",value:new t.Color("#cc092f")},{name:"bIsFilled",value:!0},{name:"bHasBorder",value:!1},{name:"fLineStyleThicknessIndex",value:0},{name:"sLineStylePattern",value:"1"},{name:"cLineStyleColor",value:new t.Color("#6d2828")},{name:"fLeaderStyleThicknessIndex",value:0},{name:"sLeaderStylePattern",value:"1"},{name:"cLeaderStyleColor",value:new t.Color("#6d2828")}]),g.refreshNode(),m());break;case"DMULightStyleHdr":g.hasAttribute("sFontStyle")&&-1===g.getType().indexOf("Picture")&&(g.setAttributes([{name:"fOpacity",value:1},{name:"cFontColor",value:new t.Color("#000000")},{name:"sFontStyle",value:"normal"},{name:"cFillStyleColor",value:new t.Color("#ffffff")},{name:"bIsFilled",value:!1},{name:"bHasBorder",value:!1},{name:"fLineStyleThicknessIndex",value:0},{name:"sLineStylePattern",value:"1"},{name:"cLineStyleColor",value:new t.Color("#3d3d3d")},{name:"fLeaderStyleThicknessIndex",value:0},{name:"sLeaderStylePattern",value:"1"},{name:"cLeaderStyleColor",value:new t.Color("#3d3d3d")}]),g.refreshNode(),m())}switch(l){case"DMUIncreaseFontSizeHdr":C(g,"Increase");break;case"DMUDecreaseFontSizeHdr":C(g,"Decrease")}}this.cancel()}else this.getFrameWindow().getExecutionContext?this.done():this.end()}function m(){o.getFrameWindow().getViewer().render(),function(){var e=a.getReviewContext({viewer:o.getFrameWindow().getViewer()});e&&e.getCurrentSessionMarkup()&&e.getCurrentSessionMarkup().isVisible()&&e.getCurrentSessionMarkup().getCurrentSlide()&&e.getCurrentSessionMarkup().getCurrentSlide().fireEvent("onSlidePreviewRefreshRequired",{dmuObject:e.getCurrentSessionMarkup().getCurrentSlide()})}()}function C(e,t){if(e&&e.hasAttribute("fFontSize")&&-1===e.getType().indexOf("Picture")){var n=e.getAttribute("iFontSize");n=n?i.convertPixelToModel({sizeInPixels:n,viewer:e._viewer}):e.getAttribute("fFontSize"),"Increase"===t?e.setAttribute("fFontSize",n+1):n-1>0&&e.setAttribute("fFontSize",n-1),e.refreshNode(),m()}}}});return r.setMarkerStyle=function(e,t){if(t&&t.executionContext){let e=t.executionContext.getComponent(WAfrStandardComponentKey.HandlerComponent);e&&t&&t.id&&e.executeHandler({id:t.id})}e&&e()},r.resetMarkerStyle=function(e){e&&e()},r})),define("DS/DMUBaseCtxCommands/DMUExpandCollapseAllCmd",["DS/CATWebUXComponents/DMUCommand","DS/DMUBaseExperience/DMUContextManager","DS/Selection/CSOManager"],(function(e,t,n){"use strict";return e.extend({init:function(e){e.mode="shared",e.repeatMode=!1,e.isAsynchronous=!0,this._parent(e);var a,i=this,r=(e.frameWindow||this.getFrameWindow()).getViewer();this.beginExecute=function(){var e,o=n.get();if(a=t.getEventsController({viewer:r}),e=r._executionContext?this.options.args.action:this.options.arguments[0].Value,o.length){for(let t=0;t<o.length;t++){var s=o[t].pathElement.getLastElement().getDMUType();"Checks"===s&&"Expand"===e?a.fireEvent("onExpandRequested","DMUValidationCheck"):"Checks"===s&&"Collapse"===e?a.fireEvent("onCollapseRequested","DMUValidationCheck"):"Highlights"===s&&"Expand"===e?a.fireEvent("onExpandRequested","DMUValidationExposedPresentation"):"Highlights"===s&&"Collapse"===e&&a.fireEvent("onCollapseRequested","DMUValidationExposedPresentation")}i.cancel()}this.done()}}})})),define("DS/DMUBaseCtxCommands/DMUContextPointExtremityTypeCmd",["DS/CATWebUXComponents/DMUCommand","DS/DMUBaseExperience/DMUContextManager","DS/Selection/CSOManager"],(function(e,t,n){"use strict";return e.extend({init:function(e){e.mode="shared",this._parent(e);var a=this;a._bCmdState=!1,this.beginExecute=function(){var e=t.getReviewContext({viewer:a.getFrameWindow().getViewer()});if(e){var i=n.get();if(i.length>0){var r="NA",o="NA";switch(this._id.includes("PointTypeHdr")?o="PointType":this._id.includes("ExtremityTypeHdr")&&(o="ExtremityType"),this._id){case"DMUCross"+o+"Hdr":r="Cross";break;case"DMUPlus"+o+"Hdr":r="Plus";break;case"DMUConcentric"+o+"Hdr":r="Concentric";break;case"DMUCoincident"+o+"Hdr":r="Coincident";break;case"DMUFullCircle"+o+"Hdr":r="FullCircle";break;case"DMUFullSquare"+o+"Hdr":r="FullSquare";break;case"DMUStar"+o+"Hdr":r="Star";break;case"DMUDot"+o+"Hdr":r="Dot";break;case"DMUSmallDot"+o+"Hdr":r="SmallDot";break;case"DMUNone"+o+"Hdr":r="None"}for(var s=0;s<i.length;s++){var l=e.getDMUObjectFromPathElement(i[s].pathElement);l&&"NA"!==r&&void 0!==l.getAttribute("s"+o)&&(l.setAttribute("s"+o,r),l.refreshNode())}a.getFrameWindow().getViewer().render()}}a.cancel()},this.getState=function(){return a._bCmdState},this.setState=function(e){a._bCmdState=e}}})})),define("DS/DMUBaseCtxCommands/DMUHideShowCmd",["DS/CATWebUXComponents/DMUCommand","DS/DMUBaseExperience/DMUContextManager","DS/Selection/CSOManager","DS/DMUBaseUIControllers/DMUSceneDisplayController"],(function(e,t,n,a){"use strict";return e.extend({init:function(e){e.mode="shared",this._parent(e);var i=this;this.beginExecute=function(){var e=t.getReviewContext({viewer:i.getFrameWindow().getViewer()}),r=e.getCurrentSessionMarkup();if((!r||r&&!r.getActiveFlag()||r&&r.getActiveFlag()&&r.isReadOnly()||r&&r.getActiveFlag()&&!r.isReadOnly()&&!r.getCurrentSlide())&&(r=e.getTransientReviewBag()),e&&!e.isReadOnly()&&r&&!r.isReadOnly()){var o,s=n.get(),l=[],d=[];for(o=0;o<s.length;o++){var g=e.getDMUObjectFromPathElement(s[o].pathElement);if(g){if(g.getType&&"DMUClipping"===g.getType())continue;l.push(g)}else d.push(s[o].pathElement)}var m=a.giveDMUSceneDisplayController({context:t.getContextViewer({viewer:i.getFrameWindow().getViewer()})});m&&d&&d.length&&m.toggleVisibility(d);var C,u=[];for(o=0;o<l.length;o++){var c=l[o].getAttribute("bVisible");C=null!=c&&!c,"DMUOccurrenceOverloader"===l[o].getType()?u.push({state:{bVisible:C},target:l[o]}):(l[o].setAttribute("bVisible",C),l[o].refreshNode())}i.getFrameWindow().getViewer().render();var v=t.giveEventsController({viewer:i.getFrameWindow().getViewer()});v&&(u.length&&v.fireEvent("onDMUOverloadPropertiesChanged",{overloads:u}),(l.length||d.length)&&v.fireEvent("onSaveRequested",{})),n.empty()}i.cancel()}}})})),define("DS/DMUBaseCtxCommands/DMUDeleteCmd",["DS/CATWebUXComponents/DMUCommand","DS/DMUBaseExperience/DMUContextManager","DS/Selection/CSOManager","DS/DMUControls/DMUWarningPanel","DS/DMUControls/EXPNotify","DS/DMUBaseUIControllers/DMUSlidesController","DS/DMUBaseUIControllers/DMUCommentsController","i18n!DS/DMUBaseCtxCommands/assets/nls/DMUBaseCtxCommands"],(function(e,t,n,a,i,r,o,s){"use strict";var l,d;return e.extend({init:function(e){e.mode="shared",this._parent(e);let i=this;this.frmWindow=e.executionContext&&e.executionContext.getComponent?e.executionContext.getComponent("Viewer").getFrameWindow():this.getFrameWindow(),this.beginExecute=function(){let e=!0;if(l)return void i.end();var d=t.getReviewContext({viewer:i.getFrameWindow().getViewer()});if(!d)return void i.end();let g,m=[],C=[],u=d.getCurrentSessionMarkup();(!u||u&&!u.getActiveFlag()||u&&u.getActiveFlag()&&u.isReadOnly()||u&&u.getActiveFlag()&&!u.isReadOnly()&&!u.getCurrentSlide())&&(u=d.getTransientReviewBag());let c=o.giveDMUCommentsController({context:i.getFrameWindow()}),v=d.getValidation();var D=n.get();if(D.length)for(let t=D.length-1;t>=0;t--){let n=d.getDMUObjectFromPathElement(D[t].pathElement);if(!n&&c&&(n=c.getDMUObjectFromPathElement(D[t].pathElement)),n&&!n.isReadOnly()&&C.push(n),D[t].pathElement.getLastElement(!0).getDMUType&&"DMUMarkup"===D[0].pathElement.getLastElement(!0).getDMUType())if(v.getContext()&&v.getContext().getJsonContextTypes()&&"Document"===v.getContext().getJsonContextTypes()[0]&&1===v.getMarkups().length)this._sendNotify("warning",s.DeleteLastMarkupWarning),e=!1;else if(v){let e=D[t].pathElement;v.getMarkups().forEach((t=>{let n=t.getRepRef();n.getMarkupContent()&&n.getMarkupContent().getNode()===e.getLastElement(!0)&&m.push(t)}))}!D[t].pathElement.getLastElement(!0).getDMUType||"DMUValidationCheck"!==D[t].pathElement.getLastElement(!0).getDMUType()&&"DMUValidationExposedPresentation"!==D[t].pathElement.getLastElement(!0).getDMUType()||D[t].pathElement.getLastElement(!0).getOwner().isEditable()&&m.push(D[t].pathElement.getLastElement(!0).getOwner())}const p=e=>{if(!e)return;let t=e.getMarkupOwner();if(t){let e=t.getParent();if(e&&"Reply"===e.getType())return e}};if(m.length||C.length){const t=function(e){if("boolean"==typeof e&&localStorage.setItem("DMUDeleteWarningPanelCheckboxFlag",e),m.length)m[0].fireEvent("onValidationObjectDeleted",{dmuObject:m});else{let t,n,a=!1;for(let i=C.length-1;i>=0;i--){const r=C[i];if(g=r.getParent(),"DMUMarkup"===g.getType()){const i=r.getType(),o=d.getValidation()&&"Activated"===d.getValidation().getRestrictedEditionFlag();if("DMUFormat"===i||"DMUSlide"===i){a=a||u===g;if(1===C.length&&g.getCurrentSlide()===r&&(n="DMUFormat"===i?g.getFormats():g.getSlides(),u===g&&(t=n.indexOf(r))),"DMUFormat"===i)g.removeFormat(r);else{const e=p(g);e&&1===g.getSlides().length?e.fireEvent("onValidationObjectDeleted",{dmuObject:[e]}):o&&!e?r.setAttribute("bMarkedAsDeleted",!0):g.deleteSlide({object:r})}}else if(c&&"DMUComment"===i){const t=p(g);t&&1===g.getComments().length?t.fireEvent("onValidationObjectDeleted",{dmuObject:[t]}):c.removeComment(r,e||r.hasAlertFlag())}else"DMUClipping"===i||"DMUSection"===i?(g.getCurrentSlide().removeDMUObject(r),r.manageClippingCmd&&r.manageClippingCmd()):g.getCurrentSlide().removeDMUObject(r)}else g.removeDMUObjects&&"DMUClipping"!==r.getType()&&g.removeDMUObjects([r])}if(a){let e,a=0;if(void 0===t){e=d.getUIManager().getFormatEditionModeFlag()?g.getFormats()[a]:g.getSlides()[a]}else a=t===n.length-1?n.length-2:t+1,e=n[a];let o=r.giveDMUSlidesController({context:i.getFrameWindow()});o&&o.setActiveSlide(e)}}};if(-1===this._id.indexOf("Quick")){var f=C.filter((function(e){if("DMUComment"===e.getType()&&!e.isReply()&&!e.hasAlertFlag()){var t=e.getNode().getParents()[0],n=t?t.getDMUType():null;return n&&"DMUCommentPositioned"!==n&&"DMUCommentHighlight"!==n&&"DMUCommentOnTable"!==n}return!1})).length>0,h=localStorage.getItem("DMUDeleteWarningPanelCheckboxFlag");e&&(l=new a({title:s.deleteWarningPanel.title,message:s.deleteWarningPanel.message,checkboxMessage:f?s.deleteWarningPanel.checkboxMessage:null,checked:h&&"true"===h,frmWindow:this.getFrameWindow(),callbacks:{onValidateCB:function(e){t(e),i.end(),l=null},onCancelCB:function(){i.end(),l=null},onCloseCB:function(){i.end(),l=null}}}))}else t("true"===localStorage.getItem("DMUDeleteWarningPanelCheckboxFlag")),this.end();this.getFrameWindow().getContextualUIManager().getContextualBar().hide()}else this.cancel()}},_sendNotify:function(e,t){d&&(d.destroy(),d=null),d=new i({body:this.getFrameWindow().getUIFrame(),type:e,message:t})},_destroy:function(){l&&l.destroy(),this._parent()}})})),define("DS/DMUBaseCtxCommands/DMUGraphicPropertiesPanelCmd",["DS/CATWebUXComponents/DMUCommand","DS/PADUtils/PADContext","DS/DMUBaseUIControllers/DMUGraphicPropertiesCtr"],(function(e,t,n){"use strict";return e.extend({init:function(e){var a=e||{};a.mode="shared",this._parent(a);var i=this,r=t.get();this.beginExecute=function(){var e=n.getDMUGraphicPropsController({context:r});e&&e.setActiveState(!0),i.cancel()};var o=this._destroy;this._destroy=function(){o.call(i),i=r=null}}})}));