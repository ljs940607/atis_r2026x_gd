define("DS/WebApplicationBase/W3AASGNodeHolder",["UWA/Class","DS/Visualization/ThreeJS_DS","DS/Visualization/PathElement"],(function(e,t,i){"use strict";return e.extend({init:function(){this._sgNode=null},buildSGNode:function(){console.error("Should be overridden and parent not called")},giveSGNode:function(){return this._sgNode},getSGNode:function(){return this._sgNode||(this._pathElement?this._sgNode=this._pathElement.getLastElement():this._sgNode=this.buildSGNode()),this._sgNode},update:function(e){return!(!this._sgNode||!this._sgNode.update)&&(this._sgNode.update(e),this._sgNode.Dirty)},preRender:function(e){if(this._sgNode&&this._sgNode.preRender)return this._sgNode.preRender(e)},postRender:function(e){if(this._sgNode&&this._sgNode.postRender)return this._sgNode.postRender(e)},postUpdate:function(e){if(this._sgNode)return!(!this._sgNode||!this._sgNode.postUpdate)&&this._sgNode.postUpdate(e)},unreferenceSGNode:function(){this._pathElement=null,this._sgNode=null},Dispose:function(){this.unreferenceSGNode()},setSGNodeDirty:function(e){var t=e;void 0===t&&(t=!0),this._sgNode&&(this._sgNode.Dirty=t)},isSGNodeUpToDate:function(){if(this._sgNode)return!this._sgNode.Dirty},setPathElement:function(e){this.isSelfManagedPathElement()?console.warn("isSelfManagedPathElement is set. This method shouldn't be used. Instead, set _pathElement directly"):this._pathElement=e},getPathElement:function(){return this._pathElement?this._pathElement:null},getRelativePathElement:function(e){var t=e.QueryInterface("W3AISGNodeHolder");if(t){var n,r=t.getPathElement(),o=this._pathElement.externalPath.concat([]),s=r.externalPath;o.indexOf(s[s.length-1]);for(n=0;n<s.length;n++)if(s[n]!==o[n])return this._pathElement;o.splice(0,s.length);var a=new i;return a.setFromArray(o),a}return this._pathElement},getPathOfIDs:function(){return this._pathOIDs},setPathOfIDs:function(e){this._pathOIDs=e},getMatrix:function(e){return e||console.warn("without a viewer getMatrix method could return unexpected result"),this.getPathElement().getMatrix(e)},getWorldMatrix:function(e){return this.getPathElement()?(e||console.error("without a viewer getWorldMatrix method could return unexpected result"),this.getPathElement().getWorldMatrix(e)):null},getMatrixInLCS:function(e,i,n){return this.getPathElement()?i?(n&&this._invWorldMatrix||(this._invWorldMatrix=(new t.Matrix4).getInverse(this.getWorldMatrix(e))),(new t.Matrix4).multiplyMatrices(this._invWorldMatrix,i)):this.getMatrix(e):null},getPositionInLCS:function(e,i,n){return this.getPathElement()?i?(n&&this._invWorldMatrix||(this._invWorldMatrix=(new t.Matrix4).getInverse(this.getWorldMatrix(e))),i.clone().applyMatrix4(this._invWorldMatrix)):(new t.Vector3).getPositionFromMatrix(this.getMatrix(e)):null},getDirectionInLCS:function(e,i,n){return this.getPathElement()?(i||console.error("You have to provide an input direction"),n&&this._invWorldMatrix3||(this._invWorldMatrix3=(new t.Matrix3).getInverse(this.getWorldMatrix(e))),i.clone().applyMatrix3(this._invWorldMatrix3)):null},getMatrixInWCS:function(e,t){if(!this.getPathElement())return null;if(!t)return this.getWorldMatrix(e);var i=this.getWorldMatrix(e);return i?i.clone().multiply(t):t.clone()},getPositionInWCS:function(e,i){return this.getPathElement()?i?i.clone().applyMatrix4(this.getWorldMatrix(e)):(new t.Vector3).getPositionFromMatrix(this.getWorldMatrix(e)):null},getDirectionInWCS:function(e,i){return this.getPathElement()?(i||console.error("You have to provide an input direction"),i.clone().applyMatrix3((new t.Matrix3).copy(this.getWorldMatrix(e)))):null},isSelfManagedPathElement:function(){return!1}})})),define("DS/WebApplicationBase/W3AISGNodeHolder",["require","exports"],(function(e,t){"use strict";var i;return function(e){e.interfaceName="W3AISGNodeHolder"}(i||(i={})),i})),define("DS/WebApplicationBase/VCXIReadiness",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("DS/WebApplicationBase/W3AIManager",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("DS/WebApplicationBase/W3AAManager",["UWA/Class"],(function(e){"use strict";var t=e.extend({init:function(){this._uuid="ID"},getUpdatePriority:function(){return this.GetObject&&this.GetObject()!==this&&this.GetObject().getUpdatePriority?this.GetObject().getUpdatePriority():0},getInitPhase:function(){if(this.GetObject&&this.GetObject()!==this&&this.GetObject().getInitPhase)return this.GetObject().getInitPhase()},GetUUID:function(){return this._uuid},SetUUID:function(e){if(!e){let t=(new Date).getTime();e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?i:3&i|8).toString(16)}))}this._uuid=e},initialize:function(){if(this.GetObject&&this.GetObject()!==this&&this.GetObject().initialize)return this.GetObject().initialize()},unInitialize:function(){if(this.GetObject&&this.GetObject()!==this&&this.GetObject().unInitialize)return this.GetObject().unInitialize()},postInitialize:function(){if(this.GetObject&&this.GetObject()!==this&&this.GetObject().postInitialize)return this.GetObject().postInitialize()},GetType:function(){return this.GetObject&&this.GetObject()&&this.GetObject()!==this&&this.GetObject().GetType?this.GetObject().GetType():this.GetObject&&this.GetObject()&&this.GetObject().componentType||this.componentType},update:function(e){if(this.GetObject&&this.GetObject()!==this&&this.GetObject().update)return this.GetObject().update(e)},preRender:function(e){if(this.GetObject&&this.GetObject()!==this&&this.GetObject().preRender)return this.GetObject().preRender(e)},postRender:function(e){if(this.GetObject&&this.GetObject()!==this&&this.GetObject().postRender)return this.GetObject().postRender(e)},postUpdate:function(e){if(this.GetObject&&this.GetObject()!==this&&this.GetObject().postUpdate)return this.GetObject().postUpdate(e)},getVersion:function(){return this.GetObject&&this.GetObject()!==this&&this.GetObject().getVersion?this.GetObject().getVersion():"0.0"}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"W3AAManager"}}),t})),define("DS/WebApplicationBase/VCXIModelNavigable",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}));var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/WebApplicationBase/VCXAModelNavigable",["require","exports","DS/WebComponentModeler/WebExtensionBase","DS/WebComponentModeler/WebComponentBase"],(function(e,t,i,n){"use strict";i=__importDefault(i),n=__importDefault(n);n.default;class r extends i.default{constructor(){super(),this._father=null,this._childrenList=[]}getParent(){return this._father}GetObject(){return super.GetObject()}setParent(e){this.getParent()&&this.getParent()?.removeChild(this),e&&e.addChild(this)}setInternalParent(e){this._father=e}getChildren(){return this._childrenList}isAncestorOf(e){if(e&&e.QueryInterface("VCXIModelNavigable")===e){if(this===e)return!0;for(var t=e.getParent();t;){if(this===t)return!0;t=t.getParent()}return!1}}addChild(e){this.getChildren().push(e),e.setInternalParent(this)}addChildren(e){this._childrenList=this._childrenList.concat(e);for(var t=0;t<e.length;t++){var i=e[t];i&&i.setInternalParent(this)}}removeChild(e){if(e){for(var t=-1,i=this.getChildren(),n=0;n<i.length;n++){var r=i[n];if(r){var o=r.GetObject().GetID();e.GetObject().GetID()===o&&(t=n)}}t>=0&&(this.getChildren()[t].setInternalParent(null),this.getChildren().splice(t,1))}}setWorkingRoot(e){this._workingRoot=e}getWorkingRoot(){return!this._workingRoot&&this.getParent()&&(this._workingRoot=this.getParent()?.getWorkingRoot()),this._workingRoot}setAssetNavigable(e){this._assetNavigable=e}getAssetNavigable(){return!this._assetNavigable&&this.getParent()&&(this._assetNavigable=this.getParent()?.getAssetNavigable()),this._assetNavigable}isSelfOrganized(){return!1}traverse(e,t,i){i&&i.childrenFirst||e(this,t,i);var n=this.getChildren(),r=n.length;let o=!0;for(let s=0;s<r&&o;++s){n[s].traverse(e,t,i),o=!i||!i.stop}i&&i.childrenFirst&&e(this,t,i)}Dispose(){this._father&&this._father.removeChild(this),this._father=null,this._childrenList=[],this._workingRoot=null,this._assetNavigable=null}clear(){for(var e=this.getChildren(),t=e.length,i=0;i<t;++i){var n=e[i];n&&"function"==typeof n.clear&&n.clear()}var r=this.GetObject();if(r){var o=r.QueryInterface("CATI3DExperienceObject");o&&o._GetExpDataObject()?this.Dispose():r.CallDispose()}}}return r})),define("DS/WebApplicationBase/W3AManagerSet",["UWA/Class","DS/CoreEvents/Events"],(function(e,t){"use strict";const i={initialize:{color:"#990000",background:"#ffffff"},postInitialize:{color:"#0000ff",background:"#ffffff"},update:{color:"#339933",background:"#000000"},preRender:{color:"#ff3399",background:"#000000"},postUpdate:{color:"#ff9900",background:"#000000"},unInitialize:{color:"#000000",background:"#ffffff"},render:{color:"#ffff00",background:"#000000"}};return e.extend({init:function(){this._UpdateArray=[],this._InitArray=[],this._ManagerSet={}},checkManagerMode:function(e,t,i){if(!i)return!1;if(e.GetObject().GetExpBaseMode){const i=e.GetObject().GetExpBaseMode(),n=this._experienceBase.CheckNoChildYet();return"unInitialize"===t&&0===i||!n&&("initialize"===t||"postInitialize"===t)&&0===i}},dealWithInitArray:async function(e){const t=e.iMethodToCall,n=e.iASync,r=e.reverse,o=e.methodToCallArgs,s=e.isSupportingWebAppBase;var a=null,l=()=>{for(var e=(e,i)=>Promise.race([e,Promise.resolve({myTestFunction:!0})]).then((e=>{e&&e.myTestFunction&&console.warn(this.managerNames[i]+" still pending on "+t)})).catch((e=>{console.error(new Error("Can't load "+Object.keys(this.managerNames)[i]))})),i=0;i<this.requirePromises.length;i++)e(this.requirePromises[i],i);a=setTimeout(l,1e3)},h=this._InitArray;if(r&&(h=this._InitArray.reverse()),n){for(const e in h)if(e){const n=h[e];var p,u=[],d=[];for(this.managerNames=d,this.requirePromises=u,a=setTimeout(l,1e3),p=0;p<n.length;p++)if(n[p]&&n[p][t]){if(this.checkManagerMode(n[p],t,s))continue;if(localStorage.getItem("DebugSupportWebApplicationBase")){const e=n[p].GetObject().GetID();if("initialize"===t||"unInitialize"===t){const i="initialize"===t?"b":"e",r=n[p].GetUUID();this._experienceBase.AddEventHelperLifecycle(e,r,i)}var c="background:"+i[t].color+";color:"+i[t].background;console.log("%c"+n[p].GetObject().GetID()+" -> "+t+" -> "+n[p].GetObject().GetExpBaseMode(),c)}u.push(UWA.Promise.resolve(n[p][t](o))),d.push(n[p].GetType&&n[p].GetType())}const r=await UWA.Promise.allSettled(u);if(r&&r.length)for(var f=0;f<r.length;f++){var m=r[f];m&&"rejected"===m.state&&(console.error("Error in "+t+" of manager "+d[f]),console.error(m.reason))}a&&(clearTimeout(a),a=null)}}else h.forEach((e=>{e.forEach((e=>{e[t]&&e[t](o)}))}));return UWA.Promise.resolve()},initialize:function(e,t){let i={iMethodToCall:"initialize"};return i.iASync=e,i.isSupportingWebAppBase=t,this.initializePromise=this.dealWithInitArray(i),this.initializePromise},postInitialize:function(e,t){this._firstStep=!0;let i={iMethodToCall:"postInitialize"};return i.iASync=e,i.isSupportingWebAppBase=t,this.postInitializePromise=this.dealWithInitArray(i).then((()=>{this._loopReady=!0})),this.postInitializePromise},unInitialize:function(e,t,i){this._loopReady=!!i;let n={iMethodToCall:"unInitialize"};return n.iASync=e,n.reverse=!0,n.isSupportingWebAppBase=t,this.unInitializePromise=this.dealWithInitArray(n),this.unInitializePromise},getManager:function(e){var t=this._ManagerSet[e];return t&&t.GetObject()},addManager:function(e,t,i){if(e){var n=t.QueryInterface("W3AIManager");if(n){var r=n.getInitPhase&&n.getInitPhase()||i||5;return this._ManagerSet[e]?(console.warn("The manager "+e+" already exists!"),2):(this._ManagerSet[e]=n,this._InitArray[r]||(this._InitArray[r]=[]),this._InitArray[r].push(n),this._UpdateArray.push(n),n.GetObject()._ManagerSet=this,n._ManagerSet=this,n._experienceBase=n.GetObject()._experienceBase,n._experienceBase&&(n.SetUUID(null),void 0===this._experienceBase&&(this._experienceBase=n._experienceBase)),this._UpdateArray.sort(((e,t)=>e.getUpdatePriority()>t.getUpdatePriority()?1:e.getUpdatePriority()<t.getUpdatePriority()?-1:0)),this._InitArray[r].sort(((e,t)=>e.getUpdatePriority()>t.getUpdatePriority()?1:e.getUpdatePriority()<t.getUpdatePriority()?-1:0)),0)}}return console.warn("The manager "+e+" have not been added to the managerSet!"),1},removeManager:function(e,t){if(e){var i=this._ManagerSet[e];if(i){var n=!1;this._InitArray.every((e=>{for(var t=0;t<e.length&&!n;t++)i===e[t]&&(e.splice(t,1),n=!0);return!n})),n=!1;for(var r=0;r<this._UpdateArray.length&&!n;r++)i===this._UpdateArray[r]&&(this._UpdateArray.splice(r,1),n=!0);t||i.unInitialize(),delete this._ManagerSet[e]}}},update:function(e){if(this._firstStep&&(this._firstStep=!1,t.publish({event:"/W3A/ManagerSet/RunLoopStarted"})),this._loopReady){if(e&&e.viewer&&!e.viewpoint)if(e.viewer.currentViewpoint)e.viewpoint=e.viewer.currentViewpoint;else{var i=e.viewer.getViewpoints();i&&(e.viewpoint=i[0],e.viewer.currentViewpoint=i[0])}var n;for(n=0;n<this._UpdateArray.length;n++){var r=this._UpdateArray[n];r.update&&r.update(e)}}else console.warn("Loop is not ready!")},preRender:function(e){var t;if(this._loopReady){if(!(e.viewer&&e.viewer.div&&e.viewer.div.style&&"hidden"===e.viewer.div.style.visibility))for(t=0;t<this._UpdateArray.length;t++){var i=this._UpdateArray[t];i.preRender&&i.preRender(e)}}else console.warn("Loop is not ready!")},postRender:function(e){var t;if(this._loopReady)for(t=this._UpdateArray.length-1;t>=0;t--){var i=this._UpdateArray[t];i.postRender&&i.postRender(e)}else console.warn("Loop is not ready!")},postUpdate:function(e){var t;if(this._loopReady)for(t=this._UpdateArray.length-1;t>=0;t--){var i=this._UpdateArray[t];i.postUpdate&&i.postUpdate(e)}else console.warn("Loop is not ready!")},getVersions:function(){var e,t=[];for(e=0;e<this._UpdateArray.length;e++){var i=this._UpdateArray[e];if(i&&i.QueryInterface&&i.GetType){var n=i.QueryInterface("W3AIManager");n&&n.getUpdatePriority&&t.push({Type:i.GetType(),Priority:n.getUpdatePriority()})}}return t}})})),define("DS/WebApplicationBase/VCXGroupByHelper",["require","exports"],(function(e,t){"use strict";class i{constructor(e){this.filterMethod=e,this.results=new Map}getResults(){return this.results}getResultsByName(e){return this.results.get(e)}getResultsKeys(){return Array.from(this.results.keys())}addComponents(e){e.forEach((e=>this.addComponent(e)))}clear(){this.results.clear()}addComponent(e){this._performFilter(e)}_performFilter(e){let t=this.filterMethod(e);if(null!==t)if(Array.isArray(t))t.forEach((t=>{let i=this.results.get(t);i||(i=new Set,this.results.set(t,i)),i.add(e)}));else{let i=this.results.get(t);i||(i=new Set,this.results.set(t,i)),i.add(e)}}removeComponent(e){let t,i=this.results.values();for(;t=i.next(),!t.done;)t.value.delete(e)}}return i.GLOBAL_CATEGORIES="global",i}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/WebApplicationBase/VCXAReadiness",["require","exports","DS/WebComponentModeler/WebExtensionBase","DS/WebComponentModeler/WebComponentBase"],(function(e,t,i,n){"use strict";i=__importDefault(i),n=__importDefault(n);n.default;class r extends i.default{constructor(){super(),this._promises=new Map,this._objects=[]}GetObject(){return super.GetObject()}Dispose(){this._promises.clear(),this._objects=[]}getObjects(){return this._objects}registerObject(e){this._objects.push(e)}clearObjects(){this._objects=[]}registerDomainPromise(e,t){let i=this._promises.get(e)??[];i.push(t),this._promises.set(e,i),t.finally((()=>{if(this._promises){let i=this._promises.get(e);if(void 0===i)return;let n=i.indexOf(t);n>=0&&i.splice(n,1)}}))}registerPromise(e){return this.registerDomainPromise("main",e)}clearPromises(){this._promises.clear()}isReady(e="main"){var t=[];let i="all"===e?[...this._promises.values()].flatMap((e=>e)):this._promises.get(e)??[];return i.length&&t.push(Promise.allSettled(i)),this.getObjects().forEach((i=>{var n=i&&i.QueryInterface&&i.QueryInterface("VCXIReadiness")&&i.QueryInterface("VCXIReadiness")?.isReady(e);n&&t.push(n)})),t.length?Promise.allSettled(t):null}}return r}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/WebApplicationBase/WebComponentsMap",["require","exports","UWA/Utils","DS/WebApplicationBase/VCXGroupByHelper"],(function(e,t,i,n){"use strict";n=__importDefault(n);class r{constructor(e){this.groupByHelper=e,this.invalidateCache=new Set,this.invalidateCacheAll=!1}}class o{constructor(){this._ComponentTable={},this._aliasTable={key:new Map,value:new Map},this._ComponentTableSorted=new Map,this._hashTree={},this._ComponentsToDispose={},this._componentToHash=new Set,this.registerFilter("sortByType",(e=>e.GetTypes()))}Clean(){for(var e in console.log(">> CallDispose on TOS_ComponentTable"),this._ComponentTable)if(this._ComponentTable.hasOwnProperty(e)){var t=this._ComponentTable[e];t.CallDispose&&t.CallDispose()}this._ComponentTable={},this._ComponentTableSorted.clear(),this._componentToHash.clear(),this._aliasTable.key.clear(),this._aliasTable.value.clear(),this._hashTree={},this.CallDispose()}GetComponentTable(){return this._ComponentTable}GetComponentsToDispose(){var e=[];for(var t in this._ComponentsToDispose)if(this._ComponentsToDispose.hasOwnProperty(t)){const i=this._ComponentsToDispose[t];e.push(i)}return e}CallDispose(){for(var e in console.log(">> CallDispose on TOS_ComponentsToDispose"),this._ComponentsToDispose)if(this._ComponentsToDispose.hasOwnProperty(e)){var t=this._ComponentsToDispose[e];t.CallDispose&&t.CallDispose()}this._ComponentsToDispose={}}AddComponent(e){if(e){var t=e.GetID();if(t){if(this._ComponentTable[t])return!1}else t=i.getUUID().substr(0,18),e.SetID(t.toString());return this._ComponentTable[t]=e,this._addToFilters(e),delete this._ComponentsToDispose[t],this._componentToHash.add(e),!0}return console.warn("WARNING -> WebComponentsMap::AddComponent FAILED"),!1}_getIdsPath(e){const t=e.QueryInterface("W3AISGNodeHolder"),i=t?.getPathOfIDs();let n=i?.ids||[];if(0===n.length){const e=t?.getPathElement();e?.externalPath?.forEach((e=>{n.push(e.id)}))}return n}addToHashTree(e){let t=this._getIdsPath(e);if(t.length>0){let i=this._hashTree;return t.forEach((e=>{i.children||(i.children={}),i.children[e]||(i.children[e]={}),i=i.children[e]})),i.component=e,!0}return!1}removeToHashTree(e){let t=this._getIdsPath(e);if(t.length>0){let i=this._hashTree;return t.forEach((e=>{i.children||(i.children={}),i.children[e]||(i.children[e]={}),i=i.children[e]})),i.component=e,!0}return!1}getComponentFromIDPath(e,t){let i=this._hashTree;return e.every((e=>(i=i?.children&&i?.children[t?e:e.id],!!i))),i&&i.component?i.component:null}RemoveComponent(e,t=!0){let i=this._ComponentTable[e];if(i){t&&(this._ComponentsToDispose[e]=i),delete this._ComponentTable[e],this._removeFromFilters(i),this._componentToHash.delete(i),this.removeToHashTree(i);let n=this._aliasTable.value.get(e);return n&&(this._aliasTable.value.delete(e),this._aliasTable.key.delete(n)),!0}return console.log("RemoveComponent: this ID is not in the TOS "+e),!1}SetAlias(e,t){this._aliasTable.key.set(t,e.GetID()),this._aliasTable.value.set(e.GetID(),t)}GetComponentFromID(e){var t=this._ComponentTable[e];if(!t){let t=this._aliasTable.key.get(e);if(t)return this.GetComponentFromID(t)}return t??null}GetComponentsFromIDs(e){for(var t=[],i=0;i<e.length;++i){var n=e[i],r=this.GetComponentFromID(n);r&&t.push(r)}return t}GetComponentFromType(e){let t=this.getFilterFromName("sortByType"),i=t?.getResultsByName(e);return i?Array.from(i.values()):[]}GetComponentFromOtherType(e){let t=this.GetComponentsFromFilterMethod((t=>!t.IsKindOf(e)));if(t)return t;throw new Error("Illegal Argument")}registerFilter(e,t){let i=new n.default(t),o=new r(i);this._ComponentTableSorted.set(e,o),i.addComponents(Object.values(this._ComponentTable))}unregisterFilter(e){return this._ComponentTableSorted.delete(e)}getFilterFromName(e){let t=this._ComponentTableSorted.get(e);return t&&this._performFilterAllIfNeeded(t),t?.groupByHelper}invalidateAll(e){let t=this._ComponentTableSorted.get(e);t&&(t.invalidateCacheAll=!0)}invalidateElement(e,t){let i=this._ComponentTableSorted.get(e);i&&i.invalidateCache.add(t)}_performFilterAllIfNeeded(e){if(e.invalidateCacheAll)return e.invalidateCache.clear(),e.groupByHelper.clear(),void e.groupByHelper.addComponents(Object.values(this._ComponentTable));let t,i=e.invalidateCache.values();for(;t=i.next(),!t.done;)e.groupByHelper.removeComponent(t.value),e.groupByHelper.addComponent(t.value);e.invalidateCache.clear()}FindComponentFromTypeAndFilter(e,t){let i=this.getFilterFromName("sortByType"),n=i?.getResultsByName(e);if(n){let e,i=n.values();for(;e=i.next(),!e.done;)if(!t||t(e.value))return e.value}return null}FindComponentsFromFilterMethod(e){if("function"!=typeof e)return console.warn("GetComponentsFromFilterMethod needs a function as unique argument."),null;for(var t in this._ComponentTable)if(this._ComponentTable.hasOwnProperty(t)){var i=this._ComponentTable[t];if(e(i))return i}return null}GetComponentsFromFilterMethod(e){if("function"!=typeof e)return console.warn("GetComponentsFromFilterMethod needs a function as unique argument."),null;var t=[];for(var i in this._ComponentTable)if(this._ComponentTable.hasOwnProperty(i)){var n=this._ComponentTable[i];e(n)&&t.push(n)}return t}GetComponentFromLink(e){if(e){var t=e.GetValue();return this.GetComponentFromID(t)}return null}InitHashTable(){let e=Array.from(this._componentToHash.values());this._componentToHash.clear();for(const t of e)this.addToHashTree(t);return!0}BuildHashingFromPathElement(e){return e&&e.externalPath?this.BuildHashingFromExternalPath(e.externalPath):e&&e.ids?this.BuildHashingPOid(e.ids):""}BuildHashingFromExternalPath(e){for(var t="",i=e.length,n=0;n<i;n++){var r=e[n];r&&(t+=r.id),n<i-1&&(t+=".")}return t}BuildHashingPOid(e){for(var t="",i=e.length,n=0;n<i;n++){var r=e[n];r&&(t+=r),n<i-1&&(t+=".")}return t}GetComponentFromPathElement(e){if(e){if(e&&e.externalPath){if(window.widget?.enopadViewer){const t=this.GetEnopadController()?.buildArrayFromPath(e);let i=t&&t.length>0&&this.GetComponentFromExternalPath(t,!0);if(i)return i}return this.GetComponentFromExternalPath(e.externalPath,!1)}if(e&&e.ids)return this.GetComponentFromExternalPath(e.ids,!0)}return null}GetComponentsFromPathElements(e){if(!Array.isArray(e))return null;for(var t=[],i=0;i<e.length;++i){var n=e[i];const r=n&&this.GetComponentFromPathElement(n);r&&t.push(r)}return t}GetComponentFromExternalPath(e,t){return this._componentToHash.size>0&&this.InitHashTable(),this.getComponentFromIDPath(e,t)}GetEnopadController(){if(!this._enopadController){const e=window.widget?.enopadViewer;this._enopadController=e&&e.getController()}return this._enopadController}_removeFromFilters(e){let t,i=this._ComponentTableSorted.values();for(;t=i.next(),!t.done;){let i=t.value;i.groupByHelper.removeComponent(e),i.invalidateCache.delete(e)}}_addToFilters(e){let t,i=this._ComponentTableSorted.values();for(;t=i.next(),!t.done;){t.value.groupByHelper.addComponent(e)}}}return o._enopad3dviewer_lightNodeModel=!0,o})),define("DS/WebApplicationBase/WebApplicationBase",["DS/WebApplicationBase/WebComponentsMap","DS/WebComponentModeler/WebComponentModelerBase","DS/WebApplicationBase/W3AManagerSet"],(function(e,t,i){"use strict";return t.extend({init:function(){this._parent(),this._ManagerSet=new i;var t=new e;Object.defineProperty(this,"ComponentsMap",{enumerable:!0,configurable:!0,get:function(){return t}})},Clean:function(){this._parent(),this.ComponentsMap.Clean()},BuildComponentsFromNode:function(e,t){!0!==this.deprecatedDisplayed&&(console.warn("BuildComponentsFromNode is DEPRECATED since R420 please use BuildComponentsFromNodeEXT instead"),this.deprecatedDisplayed=!0);for(var i=e.getChildren(),n=0;n<i.length;n++){var r=i[n],o=t.clone();if(o.addElement(r),"Reference3D"!==r.productType&&"InstanceRep"!==r.productType)(s=this.Factory.BuildComponent("VCXWebComponentOccurrence"))&&(s.QueryInterface("W3AISGNodeHolder").setPathElement(o),this.ComponentsMap.AddComponent(s));else if("Experience"===r.name){var s;(s=this.Factory.BuildComponent("VCXWebComponentOccurrence"))&&(s.QueryInterface("W3AISGNodeHolder").setPathElement(o),s.SetID("VCX_Root"),s.SetPersistency(0)),this.ComponentsMap.AddComponent(s)}"InstanceRep"!==r.productType&&this.BuildComponentsFromNode(r,o)}},BuildComponentsFromNodeEXT:function(e,t,i,n){for(var r=e.getChildren(),o=0;o<r.length;o++){var s=r[o],a=t.clone();a.addElement(s);var l=null;void 0!==s.VCX_ROOT_ID||(l=n.componentTypeFromFunction?n.componentTypeFromFunction(s):void 0!==s[n.attributeToUse]&&""!==s[n.attributeToUse]?n[s[n.attributeToUse]]:n.defaultType);var h=null;if(null!=l){var p=!1;"VCXComponentMesh"===l&&(l="VCXComponentOccurrenceComposer",p=!0);var u=this.Factory.BuildComponent(l);if(u){p&&u.SetIsMesh&&u.SetIsMesh(p);var d=s.name;d&&(u.name=d),(h=u.QueryInterface("VCXIModelNavigable"))&&i&&h.setParent(i);var c=u.QueryInterface("W3AISGNodeHolder");c&&c.setPathElement(a),this.ComponentsMap.AddComponent(u)}}h?this.BuildComponentsFromNodeEXT(s,a,h,n):this.BuildComponentsFromNodeEXT(s,a,i,n)}},getManager:function(e){return this._ManagerSet&&this._ManagerSet.getManager(e)}})}));