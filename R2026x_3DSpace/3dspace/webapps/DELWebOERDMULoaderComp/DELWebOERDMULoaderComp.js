define("DS/DELWebOERDMULoaderComp/DMULoaderComp",["DS/DELWebOERCommonUtils/DELWebBaseComponent","DS/DELWebOERCommonUtils/mixins/ProgressBarMixin","i18n!DS/DELWebOERDMULoaderComp/assets/nls/DELWebOER3DMarkUp"],(function(e,t,i){"use strict";const a="DELOER",n="PROCESS",r="ds6w:type",s="3DSpace",o="ds6w:label",p="ds6w:description",h="owner",l=["InternalDS","MGA","PMR","SVR","PQA"];class c extends e{constructor(e){super(e)}async initialize(){let e=this;this.eventTokens=[],await super.initialize(),[{eventName:"DS/DELGraphViewer/onActivateGraphViewCompleted",callback:this._onGraphViewActivatedOrDeactivated},{eventName:"DS/DELGraphViewer/onDeactivateGraphViewCompleted",callback:this._onGraphViewActivatedOrDeactivated}].forEach((t=>{this.eventTokens.push(e.subscribe(t.eventName,t.callback.bind(this)))}))}_onGraphViewActivatedOrDeactivated(e){e&&e.path&&"DMU"!==e.from&&this.publish({event:"onApplicativeContextChanged",data:{id:a}})}_getActivatedGraphViewPath(){let e=[],t=this.getComponentFromIdentifier("DELGraphViewer");return t&&t.getGraphs&&Array.isArray(t.getGraphs())&&t.getGraphs().length>0&&(e=t.getGraphs()[0]&&Array.isArray(t.getGraphs()[0].path)&&t.getGraphs()[0].path.length>0?t.getGraphs()[0].path:[]),e}_activateGraphView(e){let t=this,i=[],a=t.getComponentFromIdentifier(WAfrStandardComponentKey.HandlerComponent),n=function(a,n){a&&a.path&&a.path.toString()===e.path.toString()&&(i.forEach(t.unsubscribe.bind(t)),n?e.onComplete({path:a.path}):e.onFailure({path:a.path}))};[{eventName:"DS/DELGraphViewer/onActivateGraphViewFailed",callback:e=>n(e,!1)},{eventName:"DS/DELGraphViewer/onActivateGraphViewCompleted",callback:e=>n(e,!0)}].forEach((e=>{i.push(t.subscribe(e.eventName,e.callback.bind(t)))})),e&&e.path&&a.hasHandler("DELWebOERSharedActivateGraphView")&&a.executeHandler({id:"DELWebOERSharedActivateGraphView",args:{path:e.path,from:e.from,reframe:e.reframe}})}subscribe(e,t){let i,a=this.getExecutionContext().getComponent(WAfrStandardComponentKey.ModelEvents);return a&&e&&t&&(i=a.subscribe({event:e},t.bind(this))),i}unsubscribe(e){let t=this.getExecutionContext().getComponent(WAfrStandardComponentKey.ModelEvents);t&&t.unsubscribe(e)}async load(e={}){let t=this,a=[];[{eventName:"on2DRootAdded",callback:function(i){i&&i.origin&&i.origin===n&&i.data&&i.data.id&&(a.forEach(t.unsubscribe.bind(t)),delete i.origin,t._activateGraphView({path:[i.data.id],onComplete:function(){t.removeProgressBar(),e.onComplete()},onFailure:function(){t.removeProgressBar(),e.onFailure()}}))}},{eventName:"onDidContextualComponentsUpdate",callback:async function(){try{let r={...e},s=r.items.map((e=>({...e,pprType:n,scopedMfg:[]}))),o=t.getComponentFromIdentifier(n),p=t.getComponentFromIdentifier("DELCommonUtilsServices");if(await p.hasRoles(l))o.addRoots({...r,items:s});else{t.getNotificationManager().addNotif({level:"error",message:i.get("Error.RolesNotFound.message")}),a.forEach(t.unsubscribe.bind(t)),t.removeProgressBar(),e.onFailure({error:"Make sure that at least one of the PMR, PQA, MGA, or SVR roles is assigned to enable the graph view feature."})}}catch(i){a.forEach(t.unsubscribe.bind(t)),t.removeProgressBar(),e.onFailure(i)}}}].forEach((e=>{a.push(t.subscribe(e.eventName,e.callback.bind(t)))})),t.showProgressBar({stepValue:1,simulateProgressInStep:!0,fullBarForEachStep:!0,steps:[{weight:100,text:i.get("ProgressBar.Text.Loading")}]}),t.getExecutionContext().setContext("graphView",!0)}remove(e){let t=this,i=[],a=[{eventName:"onDidContextualComponentsUpdate",callback:function(){let a=this.getExecutionContext().getContext("graphView");a&&"true"!==a.graphView&&(i.forEach(t.unsubscribe.bind(t)),i=[],e.onComplete())}}];try{a.forEach((e=>{i.push(t.subscribe(e.eventName,e.callback.bind(t)))})),this.eventTokens.forEach(t.unsubscribe.bind(t)),this.eventTokens=[],this.getExecutionContext().setContext("graphView",!1)}catch(t){e.onFailure()}}empty(){this.publish({event:"onModelChange:roots",data:null})}async clean(){await super.clean()}async destroy(){this.remove(),await super.destroy()}displayAppContainerState(e){let t=this,i=this._getActivatedGraphViewPath();e&&e.state?e.state.context&&Array.isArray(e.state.context.operationPath)&&e.state.context.operationPath.length>0?e.state.context.operationPath.toString()!==i.toString()?t._activateGraphView({path:e.state.context.operationPath,reframe:!1,from:"DMU",onComplete:e.callback,onFailure:()=>{t.logger.error("PERT view of Operation failed")}}):e.callback({path:i}):t.logger.error("Invalid Input Provided"):e.callback({path:i})}getCurrentAppContainerState(){let e,t=this._getActivatedGraphViewPath();return t&&t.length>0&&(e={version:1,context:{operationPath:t,viewType:"2D"}}),e}getApplicativeContainerID(){return a}setMinimalUIFlag(e){let t=this.getComponentFromIdentifier(n);"boolean"==typeof e&&t&&t.getPanel&&(e?t.getPanel().hide():t.getPanel().show())}getMinimalUIFlag(){let e,t=this.getComponentFromIdentifier(n);return t&&t.getPanel&&(e=!t.getPanel().visibleFlag),e}async getAppContainerTICInfo(e,t,i){let a=this,l={priority:"Low",assignees:[],reportedAgainst:[],contexts:[],attachments:[]},c=this.getComponentFromIdentifier(n);var d;c&&c.getRoots&&Array.isArray(c.getRoots())&&c.getRoots().length>0&&((d=c.getRoots())&&d.forEach((function(e){l.contexts.push(e.id)})),function(){let e=a._getActivatedGraphViewPath();Array.isArray(e)&&e.length>0&&l.reportedAgainst.push(e[e.length-1])}(),l=await async function(t){let i=[...new Set([...t.reportedAgainst,...t.contexts])],n=a.getComponentFromIdentifier("DELCommonUtilsServices"),l=await n.getAttributeForIds(i,[r,o,p,h]),c=function(t){let i;return i="CA"===e?t:{physicalId:t,serviceId:s,objectType:l&&l[t]?l[t][r]:null},i};return(0===t.reportedAgainst.length?t.contexts:t.reportedAgainst).forEach((function(e){l&&l[e]&&(t.title=l[e][o],t.description=l[e][p]?l[e][p]:l[e][o],t.assignees.push(l[e][h]))})),t.reportedAgainst=t.reportedAgainst.map(c),t.contexts=t.contexts.map(c),t}(l),i(l))}updateAppContainer(){}getOrderedAppContainerStates(){}getCurrentAppContainerStateTitle(){}setAppSectionPlanesVisibleFlag(){}setAppViewpointManipFlag(){}getAppViewpointManipFlag(){}getActiveState(){return!0}getExposedComponent(){return this.publicAPI={},this.publicAPI.load=this.load.bind(this),this.publicAPI.remove=this.remove.bind(this),this.publicAPI.subscribe=this.subscribe.bind(this),this.publicAPI.unsubscribe=this.unsubscribe.bind(this),this.publicAPI.empty=this.empty.bind(this),this.publicAPI.updateAppContainer=this.updateAppContainer.bind(this),this.publicAPI.displayAppContainerState=this.displayAppContainerState.bind(this),this.publicAPI.getCurrentAppContainerState=this.getCurrentAppContainerState.bind(this),this.publicAPI.getApplicativeContainerID=this.getApplicativeContainerID.bind(this),this.publicAPI.setMinimalUIFlag=this.setMinimalUIFlag.bind(this),this.publicAPI.getMinimalUIFlag=this.getMinimalUIFlag.bind(this),this.publicAPI.getOrderedAppContainerStates=this.getOrderedAppContainerStates.bind(this),this.publicAPI.getCurrentAppContainerStateTitle=this.getCurrentAppContainerStateTitle.bind(this),this.publicAPI.setAppSectionPlanesVisibleFlag=this.setAppSectionPlanesVisibleFlag.bind(this),this.publicAPI.setAppViewpointManipFlag=this.setAppViewpointManipFlag.bind(this),this.publicAPI.getAppViewpointManipFlag=this.getAppViewpointManipFlag.bind(this),this.publicAPI.getAppContainerTICInfo=this.getAppContainerTICInfo.bind(this),this.publicAPI.getActiveState=this.getActiveState.bind(this),this.publicAPI.clean=this.clean.bind(this),this.publicAPI.destroy=this.destroy.bind(this),this.publicAPI}}return c.prototype.mixinProperties(c,t),c}));