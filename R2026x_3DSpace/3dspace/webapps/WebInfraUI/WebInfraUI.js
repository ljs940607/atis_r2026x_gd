/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
define("DS/WebInfraUI/Notification",[],(function(){"use strict";return{info:"info",fatal:"fatal",error:"error",warning:"warning",success:"success",assistance:"assistance"}})),define("DS/WebInfraUI/MobileActionBar",["css!DS/WebInfraUI/MobileActionBar.css","UWA/Class","DS/VisuEvents/EventsManager","DS/CoreEvents/Events","DS/WebappsUtils/WebappsUtils","DS/WebSystem/Nls","DS/WebSystem/Rsc","DS/WebSystem/Environment"].concat(["DS/3DPlayWAFRMigration/CommandsManager"]),(function(e,t,n,i,o,s,a,r,l){"use strict";var c=function(e,t){let n=l.searchCommand(e,t);n&&(n.toggleState?n.toggleState():n.begin())};return t.extend({removeCommdFromMab:function(e){[this.modelTablet,this.model].forEach((t=>{Object.keys(t).forEach((n=>{t[n].forEach(((t,n,i)=>{t.id===e&&i.splice(n,1)}))}))}))},init:function(e){this.state={visible:!1,open:!1,mode:"hidden",flyout:0,menuOpen:!1,toolMenuOpen:!1,alwaysOn:!!l.getExecutionContext()||e.alwaysOn,pdf:e.pdf,actionBarBlackout:e.actionBarBlackout,video:e.video,viewerFrame:{height:e.frameWnd.getViewerFrame().clientHeight,width:e.frameWnd.getViewerFrame().clientWidth}};var t=null,r=!1,d=e.frameWnd.getUIFrame(),u=e.frameWnd.getViewerFrame(),h=e.frameWnd.experience,p=null;e.frameWnd.getContextualUIManager&&(p=e.frameWnd.getContextualUIManager());var m=null;e.frameWnd.getActionBar&&(m=e.frameWnd.getActionBar());var f=e.actionBar,v={panelManager:e.panelManager};console.error("to do is there a better container ??");var g=f&&f.elements?f.elements.container.parentElement:f.args.container;if(d.parentElement&&d.parentElement.parentElement&&d.parentElement.parentElement.childNodes&&d.parentElement.parentElement.childNodes.length)for(var b=0;b<d.parentElement.parentElement.childNodes.length;b++){var C=d.parentElement.parentElement.childNodes[b];if(C&&C.dataset&&"action-bar"==C.dataset.type){C.childNodes&&C.childNodes.length>0&&(g=C.childNodes[0]);break}}e.actionBarContainer&&(g=e.actionBarContainer);var y=e.ctx,w=e.model;e.modelTablet&&(this.modelTablet=e.modelTablet),this.model=w;var S=null,E=null,_=null,k=(h=e.exp,!1);this.backCB=null,this.backOldCB=null;var B=this;this.getCurrentModel=function(){return this.currentModel};var x=document.createElement("div");x.className="PlayWeb-MAB-container font-3dsregular",e.ios&&g.addClassName("iOS"),e.video&&(x.className=x.className+" VideoMabOption");var P=document.createElement("div");P.className="PlayWeb-MAB-section-container";var T=document.createElement("div");T.className="PlayWeb-MAB-tool-menu",x.appendChild(T);var D=document.createElement("div");D.className="PlayWeb-MAB-cmd-container",x.appendChild(D);var N=document.createElement("div");N.className="trigger-bckgd",D.appendChild(N);var M=document.createElement("div");M.className="PlayWeb-MAB-speed-dial",D.appendChild(M);var A=document.createElement("div");A.className="PlayWeb-center_container",M.appendChild(A);var W=document.createElement("div");W.className="PlayWeb-MAB-flyout",W.style.display="none",D.appendChild(W);var I=document.createElement("div");I.className="PlayWeb-center_container",W.appendChild(I);var L=document.createElement("div");L.className="PlayWeb-MAB-flyout",L.style.display="none",D.appendChild(L);var O=document.createElement("div");O.className="PlayWeb-center_container",L.appendChild(O);var U=document.createElement("div");U.className="PlayWeb-MAB-flyout-custom",U.style.display="none",D.appendChild(U);var F=document.createElement("div");F.className="PlayWeb-MAB-flyout-custom",F.style.display="none",D.appendChild(F);var V=document.createElement("div"),H=document.createElement("span"),j=document.createElement("span"),R=document.createElement("span"),z=document.createElement("span"),Y=document.createElement("span");V.appendChild(H),V.appendChild(j),V.appendChild(R),V.appendChild(z),V.appendChild(Y),V.className="PlayWeb-MAB-trigger menu-bar",e.video&&(V.style.zIndex=5);var X=document.createElement("div");X.className="PlayWeb-MAB-burger fonticon fonticon-menu-dot ";var J=[],K=[],q=function(e,i,d,u,h,p,m,f){var b,C=document.createElement("div");if(C.id="MAB-"+d.id,d.title?C.appendChild(document.createTextNode(d.title)):d.nls&&s.nls(d.nls,d.id,(function(e){var t=e&&e.Title?e.Title:"Title not found";f?C.tmp=document.createTextNode(t):C.appendChild(document.createTextNode(t))}),void 0,!0),d.rsc){var w=d.iconSize||"Normal";if(a.rsc(d.rsc,{iconName:d.id,iconSize:w},(function(e){C.style.backgroundImage="url("+e+")"})),!d.flyout){let e=l.searchCommand(d.id,y);e&&0==e.isEnabled()&&(u+=" disabled")}}else d.icon&&(C.style.backgroundImage="url("+o.getWebappsBaseUrl()+d.icon+")");C.className=u,d.flyout?b=function(){P.className="PlayWeb-MAB-section-container",B.showFlyout(p,d.flyout,void 0,d,d.updateIcon?this:void 0)}:d.toggle?(t=C,b=function(){r?(a.rsc(d.toggle[0].rsc,{iconName:d.toggle[0].id,iconSize:w},(function(e){C.style.backgroundImage="url("+e+")"})),c(d.toggle[0].id,y),r=!1):(a.rsc(d.toggle[1].rsc,{iconName:d.toggle[1].id,iconSize:w},(function(e){C.style.backgroundImage="url("+e+")"})),c(d.toggle[1].id,y),r=!0)}):b=function(){d.hideAB?B.toggleMainView():(P.className="PlayWeb-MAB-section-container",B.state.menuOpen=!1),!0===d.isAction?(!0!==d.keepFlyout&&B.showFlyout(0),d.tool&&d.func?v[d.tool][d.func]():d.cb()):(c(d.id,y),f&&(f.style.backgroundImage=C.style.backgroundImage,C.tmp&&(f.innerHTML=C.tmp.nodeValue)),d.showBack&&(g.classList.contains("MabEnhancement")?"EnhancedExplode"===d.id?V.className="PlayWeb-MAB-trigger fonticon wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check":(V.className="PlayWeb-MAB-trigger fonticon wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check",V.style.left="50%"):V.className="PlayWeb-MAB-trigger menu-bar active back",B.state.showBack=!0,B.backCB=function(){try{var e=l.searchCommand(l.getCurrentCmdId(y),y);e&&e.cancel()}catch(e){console.error("commandmanager ",e)}B.state.showBack&&(B.state.showBack=!1,ae(!0)),!1===B.state.open?B.toggleMainView():B.state.flyout>0&&B.showFlyout(0)}))},n.addEvent(C,"onTap",b),n.addEvent(C,"onLeftMouseDown",b),i.appendChild(C),e.push({container:C,event:h,cb:b,isScenario:m})},G=function(e){e.container.parentElement&&e.container.parentElement.removeChild(e.container),n.removeEvent("onTap",e.cb),n.removeEvent("onLeftMouseDown",e.cb)};this.updateToggle=function(e,n,i){t&&(a.rsc(n,{iconName:e,iconSize:"Normal"},(function(e){t.style.backgroundImage="url("+e+")"})),r=i)};var Z=function(e,t){if(e.monoCmd){k=!0,V.className="PlayWeb-MAB-trigger cmd";var i=e.monoCmd.iconSize||"Normal";a.rsc(e.monoCmd.rsc,{iconName:e.monoCmd.id,iconSize:i},(function(e){V.style.backgroundImage="url("+e+")"})),J.triggerClick=function(){c(e.monoCmd.id,y)}}else n.removeEvent(V,"onTap",J.triggerClick),n.removeEvent(V,"onLeftMouseUp",J.triggerClick),k=!1,J.triggerClick=function(){let e=l.getCurrentCmdId(y);e&&(e=l.searchCommand(e,y)),e&&e.cancel,B.backCB?(B.backCB(),B.backCB=null):0!==B.state.flyout?(B.state.flyout-1==0&&(e&&e.cancel&&e.cancel(),B.state.showBack&&(B.state.showBack=!1,ae(!0))),0!==B.state.flyout&&B.showFlyout(B.state.flyout-1)):B.toggleMainView()},e&&e.sections?(X.style.display="",e.sections.forEach((function(e){q(J,P,e,"PlayWeb-MAB-cmd PlayWeb_PO_"+e.id,"onLeftClick",1,t)}))):X.style.display="none",e&&e.speeddial&&(A.style.setProperty("--nbCmdMab",e.speeddial.length+1),e.speeddial.forEach((function(e){q(J,A,e,"PlayWeb-MAB-cmd PlayWeb_PO_"+e.id,"onLeftClick",1,void 0,e.flyout)})));n.addEvent(V,"onTap",J.triggerClick),n.addEvent(V,"onLeftMouseUp",J.triggerClick),A.appendChild(X),B.currentModel=e};Z(w);var Q=function(e,t,n){for(var i=0;i<e.children.length;i++)if(t[i]&&t[i].id&&!t[i].flyout&&!t[i].toggle){let o=t[i].id;if(!n||o===n.ID){let t=l.searchCommand(o,n?.context),s="";t&&!t.isEnabled()&&(s=" disabled"),e.children[i].setAttribute("class","PlayWeb-MAB-cmd"+s+" PlayWeb_PO_"+o)}}},$=function(e){let t=e?.options;w&&w.sections&&P&&P.children.length==w.sections.length?Q(P,w.sections,t):this.modelTablet&&this.modelTablet.sections&&P&&P.children.length==this.modelTablet.sections.length&&Q(P,this.modelTablet.sections,t),w&&w.speeddial&&M.firstChild.children.length-1==w.speeddial.length?Q(M.firstChild,w.speeddial,t):this.modelTablet&&this.modelTablet.speeddial&&M&&M.firstChild.children.length-1==this.modelTablet.speeddial.length&&Q(M.firstChild,this.modelTablet.speeddial,t)}.bind(this),ee=function(){var e=null,t=null;E?(e=E,t=L.firstChild):S&&(e=S,t=W.firstChild),e&&Q(t,e)},te=h.subscribe("3DPLAY/2DEXP/MAB/SCROLL/NAVIGATIONSTATEUPDATE",$),ne=h.subscribe("3DPLAY/UDLEXP/MAB/SCROLL/NAVIGATIONSTATEUPDATE",$);this.eventToken=[],this.eventToken.push(i.subscribe({event:"3DPLAY/MAB/FLYOUTSTATEUPDATE"},ee)),this.eventToken.push(i.subscribe({event:"/WUX/AFR/CMD/Default/ENABLE"},$)),this.eventToken.push(i.subscribe({event:"/WUX/AFR/CMD/Default/DISABLE"},$)),this.eventToken.push(i.subscribe({event:"/WUX/AFR/CMD/Default/ENABLE"},ee)),this.eventToken.push(i.subscribe({event:"/WUX/AFR/CMD/Default/DISABLE"},ee)),J.burgerClick=function(){!0===B.state.menuOpen?(P.className="PlayWeb-MAB-section-container",B.state.menuOpen=!1):($(),P.scrollTo&&P.scrollTo(0,0),P.className="PlayWeb-MAB-section-container active",B.state.menuOpen=!0)},n.addEvent(X,"onTap",J.burgerClick),n.addEvent(X,"onLeftMouseDown",J.burgerClick),w.sections||(X.style.display="none"),J.documentClick=function(e){if(B&&B.state.menuOpen&&e&&e.from&&e.from[0]&&e.from[0].event&&e.from[0].event.path){for(var t=!0,n=e.from[0].event.path,i=0;i<n.length;i++)if(n[i]&&(n[i]===P||n[i]===X)){t=!1;break}t&&(P.className="PlayWeb-MAB-section-container",B.state.menuOpen=!1)}},n.addEvent(window.document,"onTap",J.documentClick),n.addEvent(window.document,"onLeftMouseDown",J.documentClick),J.onPinch=function(e){for(var t=e.gesture.getEvents(),n=0;n<t.length;n++)t[n].event.preventDefault()},J.onSwipe=function(e){if(e&&e.gesture&&e.from&&Array.isArray(e.from)&&e.from[0]&&e.from[0].view)if(e.from[0].view.parentNode===P||e.from[0].view.parentNode===W||e.from[0].view.parentNode===L);else if(e.from[0].view!==P&&e.from[0].view!==W&&e.from[0].view!==L)for(var t=e.gesture.getEvents(),n=0;n<t.length;n++)t[n]&&t[n].event&&"function"==typeof t[n].event.preventDefault&&t[n].event.preventDefault()},n.addEvent(g,"onPinch",J.onPinch),n.addEvent(V,"onSwipe",J.onSwipe);var ie=document.createElement("div");ie.id="Mab_Container",ie.appendChild(P),ie.appendChild(x),ie.appendChild(V),g.appendChild(ie),this.toggleMainView=function(){!1===B.state.open?(D.style.transform="translate(0em,0em)",V.className="PlayWeb-MAB-trigger menu-bar active",B.state.open=!0):(B.showFlyout(0),D.style.transform="",V.className="PlayWeb-MAB-trigger menu-bar",B.state.open=!1)};var oe={};this.onVisibilityChangeSubscribe=function(e,t){oe[e]=t,oe[e](B.state.mode)},this.onVisibilityChangeUnsubscribe=function(e){delete oe[e]};var se=function(e){for(var t in this.state.mode=e,oe)oe[t](e)}.bind(this);this.hide=function(e){P.className="PlayWeb-MAB-section-container",B.state.menuOpen=!1,g.removeClassName("PlayWebMobile"),g.removeClassName("PlayWebMobileForced"),d.removeClassName("PlayWebMobile"),d.removeClassName("PlayWebStamp"),"hidden"!==this.state.mode&&h&&h.showRefAxis&&h.showRefAxis(),se("hidden"),B.state.visible=!1,p&&p.activateContextualMenuOnRightClic(),m&&(m.show(),e||(m.toggle(),m.toggle())),i.publish({event:"3DPLAY/MOBILEACTIONBAR/ENABLE",data:{}})},this.show=function(){(!this.state.actionBarBlackout||this.state.actionBarBlackout&&this.commandInBlackout)&&(d.addClassName("PlayWebMobile"),g.addClassName("PlayWebMobile"),g.removeClassName("PlayWebMobileForced"),d.removeClassName("PlayWebStamp"),"hidden"===this.state.mode&&h&&h.hideRefAxis&&h.hideRefAxis(),se("mobile"),B.state.visible=!0,p&&p.deactivateContextualMenuOnRightClic(),m&&m.hide(),i.publish({event:"3DPLAY/MOBILEACTIONBAR/DISABLE",data:{}}))},this.showNone=function(){"undefined"!=typeof widget&&widget.body.offsetHeight<140&&d.addClassName("PlayWebStamp"),g.removeClassName("PlayWebMobileForced"),g.removeClassName("PlayWebMobile"),d.removeClassName("PlayWebMobile"),"hidden"===this.state.mode&&h&&h.hideRefAxis&&h.hideRefAxis(),se("stamp"),B.state.visible=!1,m&&m.hide(),p&&p.deactivateContextualMenuOnRightClic()},this.showFlyout=function(e,t,n,i,o){if(!0!==k){if(P.className="PlayWeb-MAB-section-container",B.state.menuOpen=!1,B.hideToolMenu(),!1===this.state.open&&this.toggleMainView(),0===e){for(B.backCB=null,B.backOldCB=null,V.className="PlayWeb-MAB-trigger menu-bar active",W.style.transform="",L.style.transform="",M.style.transform="",W.style.display="none",L.style.display="none",x.offsetWidth-124<42*A.children.length?D.classList.add("PlayWeb-MAB-overflow"):D.classList.remove("PlayWeb-MAB-overflow"),M.style.display="",U.style.display="none",F.style.display="none";K.length>0;)G(K.pop());S=E=null,g.classList.contains("MabEnhancement")&&(x.style.width=90*A.children.length+5+"px")}else if(1===e){if(B.backCB=t&&t.backCB?t.backCB:B.backOldCB,B.backOldCB=null,M.style.transform="translate(0em,4em)",t?(x.offsetWidth-124<42*t.length?D.classList.add("PlayWeb-MAB-overflow"):D.classList.remove("PlayWeb-MAB-overflow"),I.innerHTML="",I.style.setProperty("--nbCmdMab",t.length),t.forEach((function(e){e.uxElt?I.appendChild(e.uxElt):q(K,I,e,"PlayWeb-MAB-cmd PlayWeb_PO_"+e.id,"onLeftClick",2,void 0,this&&this.view?this.view[0]:void 0)}),o),S=t):S=null,E=null,n?(U.style.display="",U.style.transform="translate(0em,0em)",W.style.transform="",W.style.display="none"):(W.style.transform="translate(0em,0em)",W.style.display="",U.style.display="none",U.style.transform=""),F.style.display="none",L.style.transform="",L.style.display="none",g.classList.contains("MabEnhancement")){V.className="PlayWeb-MAB-trigger fonticon wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check ";var s=l.getCurrentCmdId(y);!n||s&&"EnhancedExplode"!=s&&"QualityManager"!=s?I.children.length<7&&0!==I.children.length?(x.style.width=90*I.children.length+5+"px",V.style.left="calc(50% + "+(I.children.length/2*90+5)+"px)"):V.style.left="calc("+window.getComputedStyle(x).marginLeft+" + "+x.style.width+")":(x.style.width="350px",U.style.marginLeft="34px",V.style.left="calc("+window.getComputedStyle(x).marginLeft+" +  350px)")}else V.className="PlayWeb-MAB-trigger menu-bar active back",U.style.marginLeft="68px";M.style.display="none"}else if(2===e){for(B.backOldCB=B.backCB,B.backCB=t&&t.backCB?t.backCB:null;K.length>3;)G(K.pop());t&&(O.innerHTML="",x.offsetWidth-124<42*t.length?D.classList.add("PlayWeb-MAB-overflow"):D.classList.remove("PlayWeb-MAB-overflow"),O.style.setProperty("--nbCmdMab",t.length),t.forEach((function(e){e.uxElt?O.appendChild(e.uxElt):q(K,O,e,"PlayWeb-MAB-cmd PlayWeb_PO_"+t.id,"onLeftClick",3)})),E=t),W.style.transform="",L.style.transform="translate(0em,0em)",L.style.display="",M.style.display="none",W.style.display="none"}B.state.flyout=e,B.state.flyoutcustom=n}},this.showCustomFlyout=function(e,t){1===e?(U.innerHTML="",U.appendChild(t)):(F.innerHTML="",F.appendChild(t)),this.showFlyout(e,null,!0)},this.showToolMenu=function(e){B.state.toolMenuOpen=!0,e=e||[],T.innerHTML="";for(var t=0;t<e.length;t++)T.appendChild(e[t].btnMAB);g.classList.contains("MabEnhancement")?T.style.width=40*e.length+5+"px":T.style.width="",T.style.transform="translate(0em,0em)"},this.hideToolMenu=function(){B.state.toolMenuOpen=!1,T.innerHTML="",T.style.transform=""};var ae=function(e){if(this.model&&0===Object.keys(this.model).length)this.state.alwaysOn||u.offsetWidth<=480||u.offsetHeight<=290?this.showNone():this.hide(e);else if((this.state.viewerFrame.height!=u.clientHeight||this.state.viewerFrame.width!=u.clientWidth||!0===e)&&(this.state.viewerFrame.height=u.clientHeight,this.state.viewerFrame.width=u.clientWidth,(!B.state.alwaysOn||!B.state.pdf)&&f&&g&&u)){if(!0!==B.state.flyoutcustom){var t=A;1===B.state.flyout?t=I:B.state.flyout>=2&&(t=O),x.offsetWidth-124<42*t.children.length?D.classList.add("PlayWeb-MAB-overflow"):D.classList.remove("PlayWeb-MAB-overflow")}if(u.offsetHeight<=270?P.style.maxHeight="calc("+u.offsetHeight+"px - 52px)":P.style.maxHeight="",u.offsetHeight>140&&d.removeClassName("PlayWebStamp"),u.offsetHeight<=240||u.offsetWidth<=240||"3DWhiteboard"===h.args.input.mode)B.showNone();else if(u.offsetWidth<=480||u.offsetHeight<=290){if(g.classList.contains("MabEnhancement")){for(n.removeEvent(V,"onTap",J.triggerClick),n.removeEvent(V,"onLeftMouseUp",J.triggerClick);J.length>0;)G(J.pop());for(;K.length>0;)G(K.pop());Z(w),_&&this.loadScenarioWb(_,!0),g.removeClassName("MabEnhancement"),B.state.showBack&&(V.classList.add("menu-bar","active","back"),V.classList.remove("fonticon","wux-ui-3ds","wux-ui-3ds-1x","wux-ui-3ds-check")),x.style.width="100%",V.style.left="0"}B.show()}else if(B.state.alwaysOn){for(n.removeEvent(V,"onTap",J.triggerClick),n.removeEvent(V,"onLeftMouseUp",J.triggerClick);J.length>0;)G(J.pop());for(;K.length>0;)G(K.pop());if(u.offsetWidth>=800&&this.modelTablet){if(Z(this.modelTablet),g.addClassName("MabEnhancement"),B.state.showBack){V.classList.remove("menu-bar","active","back"),V.classList.add("fonticon","wux-ui-3ds","wux-ui-3ds-1x","wux-ui-3ds-check");let e=l.getCurrentCmdId(y);e&&(e=l.searchCommand(e,y),e&&"EnhancedExplode"!==e.id&&"QualityManager"!==e.id?V.style.left="50%":V.style.left="")}B.state.showBack||B.showFlyout(0),x.style.width=90*A.children.length+5+"px"}else Z(w),g.removeClassName("MabEnhancement"),B.state.showBack&&(V.classList.add("menu-bar","active","back"),V.classList.remove("fonticon","wux-ui-3ds","wux-ui-3ds-1x","wux-ui-3ds-check")),x.style.width="100%",V.style.left="";_&&this.loadScenarioWb(_,!0),B.state.showBack||B.show(),g.addClassName("PlayWebMobileForced")}else B.hide(e)}}.bind(this);function re(){ae(),i.publish({event:"3DPLAY/MOBILEACTIONBAR/UPDATE/COMPLETE/ON/RESIZE",data:{}})}ae(!0),f&&g&&u.addEvent("resize",re);this.eventToken.push(i.subscribe({event:"/"+y+"/WUX/ContextualBar/Show/"},(function(e){var t=[];t.backCB=e.backCB;for(var n=0;n<e["@children"].length;n++)for(var i=e["@children"][n],o=0;o<i["@children"].length;o++){var s=i["@children"][o];if("CATCmdStarter"===s["@tag"]&&s["@viewMAB"])s["@viewMAB"].elements.container?t.push({uxElt:s["@viewMAB"].elements.container}):t.push({uxElt:s["@viewMAB"]});else if("CATCmdContainer"===s["@tag"])for(var a=0;a<s["@children"].length;a++){var r=s["@children"][a];r["@viewMAB"]&&(r["@viewMAB"].elements.container?t.push({uxElt:r["@viewMAB"].elements.container}):t.push({uxElt:r["@viewMAB"]}))}}B.showFlyout(1,t)}))),this.eventToken.push(i.subscribe({event:"/"+y+"/WUX/ContextualBar/Hide/"},(function(){B.showFlyout(0)})));var le=function(e){for(V.className="PlayWeb-MAB-trigger menu-bar",V.style.backgroundImage="",n.removeEvent(V,"onTap",J.triggerClick),n.removeEvent(V,"onLeftMouseUp",J.triggerClick),e&&!0===this.state.open&&B.toggleMainView();J.length>0;)G(J.pop());for(;K.length>0;)G(K.pop())}.bind(this);this.update=function(e,t){e&&0===Object.keys(e).length||(le(t),Z(e))},this.resetScenario=function(){if(!1===B.state.open?B.toggleMainView():B.state.flyout>0&&B.showFlyout(0),_)if(!1===_.isMerged)le(),Z(w),_=null;else for(var e=0;e<J.length;)J[e].isScenario?(G(J[e]),J.splice(e,1)):e++},this.loadScenarioWb=function(e,t){!0!==t?le():_&&B.resetScenario(),(_=e).isMerged=!0===t,Z(_,!0)},this.dispose=function(){for(this.currentModel=null,g.removeClassName("PlayWebMobile"),d.removeClassName("PlayWebMobile");J.length>0;)G(J.pop());for(;K.length>0;)G(K.pop());n.removeEvent("onTap",J.triggerClick),n.removeEvent("onLeftMouseDown",J.triggerClick),n.removeEvent("onTap",J.burgerClick),n.removeEvent("onLeftMouseDown",J.burgerClick),n.removeEvent("onTap",J.documentClick),n.removeEvent("onLeftMouseDown",J.documentClick),u.removeEvent("resize",re),n.removeEvent("onPinch",J.onPinch),n.removeEvent("onSwipe",J.onSwipe),this.eventToken.forEach(i.unsubscribe),this.eventToken=[],h.unsubscribe(te),h.unsubscribe(ne);try{ie.removeChild(P),ie.removeChild(x),ie.removeChild(V),g.removeChild(ie),P=null,x=null,V=null}catch(e){}this.backCB=null,this.backOldCB=null,S=null,E=null,d=null,u=null,p=null,g=null,f.MAB=null,f=null,y=null,w=null,_=null,h=null,B=null},e.ios?g.addClassName("PlayWeb-MAB-iOS"):function(){if("Microsoft Internet Explorer"===navigator.appName)return!0;if("Netscape"===navigator.appName){var e=navigator.userAgent;if(null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(e))return!0}return!1}()&&g.addClassName("PlayWeb-MAB-IE")}})})),define("DS/WebInfraUI/ColorButton",["UWA/Core","DS/Core/PointerEvents"],(function(e,t){"use strict";var n=e.Class.extend({init:function(n){this._parent(n),this._callback=n.callback,this._name=n.name,this._container=new e.Element("div",{class:"CAT3DPlayAction-container "+this._name}),this.isChecked=!1,this._value=n.value,this._id=n.id,this._radio=new e.Element("div",{class:"CAT3DPlayRadioButton"}).inject(this._container),this._container.addEventListener(t.POINTERDOWN,this.onClick.bind(this)),this._radio.setAttribute("value",this._value),this._selected_UI=new e.Element("div",{class:"CAT3DPlayRadioButton-current-white sketch3d-large"}).inject(this._radio),this._halo=new e.Element("div",{class:"CAT3DPlayRadioButton-current-halo"}).inject(this._radio)},setColor:function(e){this._radio.setStyles({"background-color":e}),this._halo.setStyles({"border-color":e})},isON:function(){return this.isChecked},toggleON:function(){this.isChecked=!0,this._radio.children[0].removeClassName("visible"),this._radio.children[0].offsetWidth,this._radio.children[0].addClassName("visible"),this._radio.children[1].removeClassName("visible"),this._radio.children[1].offsetWidth,this._radio.children[1].addClassName("visible"),this._parent()},toggleOFF:function(){this.isChecked=!1,this._radio.children[0].removeClassName("visible"),this._radio.children[1].removeClassName("visible"),this._parent()},onClick:function(e){e.preventDefault&&e.preventDefault(),this._callback(this)},setValue:function(e){this._value=e,this._radio.setAttribute("value",this._value)},getValue:function(){return this._value},getId:function(){return this._id},getHTMLElement:function(){return this._container}});return e.namespace("DS/WebInfraUI/ColorButton",n)})),define("DS/WebInfraUI/DOMGraph",["UWA/Class"],(function(e){"use strict";function t(e){var t=document.createElement("span");return t.style.cssText="width:1px;height:30px;float:left;background-color:#"+e,t}return e.extend({init:function(e){this.maxValue=0,this.max=100,this.name=e.name,this.caption=void 0===e.caption||e.caption,this.updateSize=e.updateSize,this.updateLegend=e.updateLegend||"";var n=e.length?e.length:100,i=e.color?e.color:"200";this.container=document.createElement("div"),this.container.id=this.name||"none",this.container.style.cssText="z-index:1234;width:"+n+"px;top:0px;left:10px;opacity:0.6;position:relative;",this.caption&&(this.tittle=function(e,t,n){var i=document.createElement("div");return i.id=e,i.style.cssText="font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px;color:#"+t+";background-color:#"+n,i}("Tittle",i,"131"),this.container.appendChild(this.tittle)),this.dom=function(e,n,i,o,s,a){o=o||a,s=s||30;var r=document.createElement("div");for(r.id=e,r.style.cssText="position:relative;height:"+s+"px;background-color:#"+n+" ;width:"+o+"px";r.children.length<a;)r.appendChild(t(i));return r}("Graph",i,"131",void 0,void 0,n),this.container.appendChild(this.dom),e.container&&e.container.appendChild(this.container)},refresh:function(e){var t=this.max;this.max=e;for(var n=[],i=0,o=this.dom.children.length;i<o;i++){var s=30-this.dom.children[i].clientHeight;n.push(Math.floor(s*t/30))}for(i=0,o=n.length;i<o;i++)this.update(n[i])},getContainer:function(){return this.container},dispose:function(){this.container.parentNode.removeChild(this.container),this.container=null,this.dom=null,this.tittle=null},update:function(e){if(void 0===this.minValue&&(this.minValue=e),this.updateSize&&!this.isrefreshing&&this.maxValue<e&&(this.isrefreshing=!0,this.refresh(e),this.maxValue=e,this.isrefreshing=!1),this.dom.firstChild){var t=Math.min(30,30-e/this.max*30);this.dom.appendChild(this.dom.firstChild).style.height=t+"px",this.caption&&("function"==typeof this.caption?this.tittle.textContent=this.caption():this.tittle.textContent=this.name+" "+e+" "+this.updateLegend+" ("+this.minValue+" - "+this.maxValue+")")}}})})),
/*! Copyright 2014 Dassault Systï¿½mes */
define("DS/WebInfraUI/Touch",["DS/UIKIT/Touch","DS/WebSystem/Environment"],(function(e,t){"use strict";var n;return t.isSet("3DPlay.Hammer.1010")?(function(e,t){var i=function(e,t){return new i.Instance(e,t||{})};i.VERSION="1.0.10",i.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},i.HAS_POINTEREVENTS=e.navigator.pointerEnabled||e.navigator.msPointerEnabled,i.HAS_TOUCHEVENTS="ontouchstart"in e,i.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,i.NO_MOUSEEVENTS=i.HAS_TOUCHEVENTS&&e.navigator.userAgent.match(i.MOBILE_REGEX),i.EVENT_TYPES={},i.UPDATE_VELOCITY_INTERVAL=16,i.DOCUMENT=e.document;var o=i.DIRECTION_DOWN="down",s=i.DIRECTION_LEFT="left",a=i.DIRECTION_UP="up",r=i.DIRECTION_RIGHT="right",l=i.POINTER_MOUSE="mouse",c=i.POINTER_TOUCH="touch",d=i.POINTER_PEN="pen",u=i.EVENT_START="start",h=i.EVENT_MOVE="move",p=i.EVENT_END="end";i.plugins=i.plugins||{},i.gestures=i.gestures||{},i.READY=!1;var m=i.utils={extend:function(e,n,i){for(var o in n)e[o]!==t&&i||(e[o]=n[o]);return e},each:function(e,n,i){var o,s;if("forEach"in e)e.forEach(n,i);else if(e.length!==t){for(o=-1;s=e[++o];)if(!1===n.call(i,s,o,e))return}else for(o in e)if(e.hasOwnProperty(o)&&!1===n.call(i,e[o],o,e))return},inStr:function(e,t){return e.indexOf(t)>-1},hasParent:function(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1},getCenter:function(e){var t=[],n=[],i=[],o=[],s=Math.min,a=Math.max;return 1===e.length?{pageX:e[0].pageX,pageY:e[0].pageY,clientX:e[0].clientX,clientY:e[0].clientY}:(m.each(e,(function(e){t.push(e.pageX),n.push(e.pageY),i.push(e.clientX),o.push(e.clientY)})),{pageX:(s.apply(Math,t)+a.apply(Math,t))/2,pageY:(s.apply(Math,n)+a.apply(Math,n))/2,clientX:(s.apply(Math,i)+a.apply(Math,i))/2,clientY:(s.apply(Math,o)+a.apply(Math,o))/2})},getVelocity:function(e,t,n){return{x:Math.abs(t/e)||0,y:Math.abs(n/e)||0}},getAngle:function(e,t){var n=t.clientX-e.clientX,i=t.clientY-e.clientY;return 180*Math.atan2(i,n)/Math.PI},getDirection:function(e,t){return Math.abs(e.clientX-t.clientX)>=Math.abs(e.clientY-t.clientY)?e.clientX-t.clientX>0?s:r:e.clientY-t.clientY>0?a:o},getDistance:function(e,t){var n=t.clientX-e.clientX,i=t.clientY-e.clientY;return Math.sqrt(n*n+i*i)},getScale:function(e,t){return e.length>=2&&t.length>=2?this.getDistance(t[0],t[1])/this.getDistance(e[0],e[1]):1},getRotation:function(e,t){return e.length>=2&&t.length>=2?this.getAngle(t[1],t[0])-this.getAngle(e[1],e[0]):0},isVertical:function(e){return e==a||e==o},toggleDefaultBehavior:function(e,t,n){if(t&&e&&e.style){m.each(["webkit","moz","Moz","ms","o",""],(function(i){m.each(t,(function(t,o){i&&(o=i+o.substring(0,1).toUpperCase()+o.substring(1)),o in e.style&&(e.style[o]=!n&&t)}))}));var i=function(){return!1};"none"==t.userSelect&&(e.onselectstart=!n&&i),"none"==t.userDrag&&(e.ondragstart=!n&&i)}}};i.Instance=function(e,t){var n=this;return i.READY||(b.determineEventTypes(),m.each(i.gestures,(function(e){y.register(e)})),b.onTouch(i.DOCUMENT,h,y.detect),b.onTouch(i.DOCUMENT,p,y.detect),i.READY=!0),this.element=e,this.enabled=!0,this.options=m.extend(m.extend({},i.defaults),t||{}),this.options.stop_browser_behavior&&m.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!1),this.eventStartHandler=b.onTouch(e,u,(function(e){n.enabled&&y.startDetect(n,e)})),this.eventHandlers=[],this},i.Instance.prototype={on:function(e,t){var n=e.split(" ");return m.each(n,(function(e){this.element.addEventListener(e,t,!1),this.eventHandlers.push({gesture:e,handler:t})}),this),this},off:function(e,t){var n,i,o=e.split(" ");return m.each(o,(function(e){for(this.element.removeEventListener(e,t,!1),n=-1;i=this.eventHandlers[++n];)i.gesture===e&&i.handler===t&&this.eventHandlers.splice(n,1)}),this),this},trigger:function(e,t){t||(t={});var n=i.DOCUMENT.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t;var o=this.element;return m.hasParent(t.target,o)&&(o=t.target),o.dispatchEvent(n),this},enable:function(e){return this.enabled=e,this},dispose:function(){var e,t;for(this.options.stop_browser_behavior&&m.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!0),e=-1;t=this.eventHandlers[++e];)this.element.removeEventListener(t.gesture,t.handler,!1);return this.eventHandlers=[],b.unbindDom(this.element,i.EVENT_TYPES[u],this.eventStartHandler),null}};var f=null,v=!1,g=!1,b=i.event={bindDom:function(e,t,n){var i=t.split(" ");m.each(i,(function(t){e.addEventListener(t,n,!1)}))},unbindDom:function(e,t,n){var i=t.split(" ");m.each(i,(function(t){e.removeEventListener(t,n,!1)}))},onTouch:function(e,t,n){var o=this,s=function(s){var a=s.type.toLowerCase();if(!m.inStr(a,"mouse")||!g){m.inStr(a,"touch")||m.inStr(a,"pointerdown")||m.inStr(a,"mouse")&&1===s.which?v=!0:m.inStr(a,"mouse")&&!s.which&&(v=!1),(m.inStr(a,"touch")||m.inStr(a,"pointer"))&&(g=!0);var r=0;v&&(i.HAS_POINTEREVENTS&&t!=p?r=C.updatePointer(t,s):m.inStr(a,"touch")?r=s.touches.length:g||(r=m.inStr(a,"up")?0:1),r>0&&t==p?t=h:r||(t=p),(r||null===f)&&(f=s),n.call(y,o.collectEventData(e,t,o.getTouchList(f,t),s)),i.HAS_POINTEREVENTS&&t==p&&(r=C.updatePointer(t,s))),r||(f=null,v=!1,g=!1,C.reset())}};return this.bindDom(e,i.EVENT_TYPES[t],s),s},determineEventTypes:function(){var e;e=i.HAS_POINTEREVENTS?C.getEvents():i.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],i.EVENT_TYPES[u]=e[0],i.EVENT_TYPES[h]=e[1],i.EVENT_TYPES[p]=e[2]},getTouchList:function(e){return i.HAS_POINTEREVENTS?C.getTouchList():e.touches?e.touches:(e.identifier=1,[e])},collectEventData:function(e,t,n,i){var o=c;return(m.inStr(i.type,"mouse")||C.matchType(l,i))&&(o=l),{center:m.getCenter(n),timeStamp:Date.now(),target:i.target,touches:n,eventType:t,pointerType:o,srcEvent:i,preventDefault:function(){var e=this.srcEvent;e.preventManipulation&&e.preventManipulation(),e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return y.stopDetect()}}}},C=i.PointerEvent={pointers:{},getTouchList:function(){var e=[];return m.each(this.pointers,(function(t){e.push(t)})),e},updatePointer:function(e,t){return e==p?delete this.pointers[t.pointerId]:(t.identifier=t.pointerId,this.pointers[t.pointerId]=t),Object.keys(this.pointers).length},matchType:function(e,t){if(!t.pointerType)return!1;var n=t.pointerType,i={};return i[l]=n===l,i[c]=n===c,i[d]=n===d,i[e]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},y=i.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(e,t){this.current||(this.stopped=!1,this.current={inst:e,startEvent:m.extend({},t),lastEvent:!1,lastVelocityEvent:!1,velocity:!1,name:""},this.detect(t))},detect:function(e){if(this.current&&!this.stopped){e=this.extendEventData(e);var t=this.current.inst,n=t.options;return m.each(this.gestures,(function(i){return this.stopped||!1===n[i.name]||!1===t.enabled||!1!==i.handler.call(i,e,t)?void 0:(this.stopDetect(),!1)}),this),this.current&&(this.current.lastEvent=e),e.eventType==p&&!e.touches.length-1&&this.stopDetect(),e}},stopDetect:function(){this.previous=m.extend({},this.current),this.current=null,this.stopped=!0},getVelocityData:function(e,t,n,o){var s=this.current,a=s.lastVelocityEvent,r=s.velocity;a&&e.timeStamp-a.timeStamp>i.UPDATE_VELOCITY_INTERVAL?(r=m.getVelocity(e.timeStamp-a.timeStamp,e.center.clientX-a.center.clientX,e.center.clientY-a.center.clientY),s.lastVelocityEvent=e):s.velocity||(r=m.getVelocity(t,n,o),s.lastVelocityEvent=e),s.velocity=r,e.velocityX=r.x,e.velocityY=r.y},getInterimData:function(e){var t,n,i=this.current.lastEvent;e.eventType==p?(t=i&&i.interimAngle,n=i&&i.interimDirection):(t=i&&m.getAngle(i.center,e.center),n=i&&m.getDirection(i.center,e.center)),e.interimAngle=t,e.interimDirection=n},extendEventData:function(e){var t=this.current.startEvent;(e.touches.length!=t.touches.length||e.touches===t.touches)&&(t.touches=[],m.each(e.touches,(function(e){t.touches.push(m.extend({},e))})));var n=e.timeStamp-t.timeStamp,i=e.center.clientX-t.center.clientX,o=e.center.clientY-t.center.clientY;return this.getVelocityData(e,n,i,o),this.getInterimData(e),m.extend(e,{startEvent:t,deltaTime:n,deltaX:i,deltaY:o,distance:m.getDistance(t.center,e.center),angle:m.getAngle(t.center,e.center),direction:m.getDirection(t.center,e.center),scale:m.getScale(t.touches,e.touches),rotation:m.getRotation(t.touches,e.touches)}),e},register:function(e){var n=e.defaults||{};return n[e.name]===t&&(n[e.name]=!0),m.extend(i.defaults,n,!0),e.index=e.index||1e3,this.gestures.push(e),this.gestures.sort((function(e,t){return e.index<t.index?-1:e.index>t.index?1:0})),this.gestures}};i.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(e,t){var n=y.current;if(n.name!=this.name&&this.triggered)return t.trigger(this.name+"end",e),void(this.triggered=!1);if(!(t.options.drag_max_touches>0&&e.touches.length>t.options.drag_max_touches))switch(e.eventType){case u:this.triggered=!1;break;case h:if(e.distance<t.options.drag_min_distance&&n.name!=this.name)return;var i=n.startEvent.center;if(n.name!=this.name&&(n.name=this.name,t.options.correct_for_drag_min_distance&&e.distance>0)){var l=Math.abs(t.options.drag_min_distance/e.distance);i.pageX+=e.deltaX*l,i.pageY+=e.deltaY*l,i.clientX+=e.deltaX*l,i.clientY+=e.deltaY*l,e=y.extendEventData(e)}(n.lastEvent.drag_locked_to_axis||t.options.drag_lock_to_axis&&t.options.drag_lock_min_distance<=e.distance)&&(e.drag_locked_to_axis=!0);var c=n.lastEvent.direction;e.drag_locked_to_axis&&c!==e.direction&&(e.direction=m.isVertical(c)?e.deltaY<0?a:o:e.deltaX<0?s:r),this.triggered||(t.trigger(this.name+"start",e),this.triggered=!0),t.trigger(this.name,e),t.trigger(this.name+e.direction,e);var d=m.isVertical(e.direction);(t.options.drag_block_vertical&&d||t.options.drag_block_horizontal&&!d)&&e.preventDefault();break;case p:this.triggered&&t.trigger(this.name+"end",e),this.triggered=!1}}},i.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:2},timer:null,handler:function(e,t){switch(e.eventType){case u:clearTimeout(this.timer),y.current.name=this.name,this.timer=setTimeout((function(){"hold"==y.current.name&&t.trigger("hold",e)}),t.options.hold_timeout);break;case h:e.distance>t.options.hold_threshold&&clearTimeout(this.timer);break;case p:clearTimeout(this.timer)}}},i.gestures.Release={name:"release",index:1/0,handler:function(e,t){e.eventType==p&&t.trigger(this.name,e)}},i.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(e,t){if(e.eventType==p){if(e.touches.length<t.options.swipe_min_touches||e.touches.length>t.options.swipe_max_touches)return;(e.velocityX>t.options.swipe_velocity||e.velocityY>t.options.swipe_velocity)&&(t.trigger(this.name,e),t.trigger(this.name+e.direction,e))}}},i.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},has_moved:!1,handler:function(e,t){var n,i,o;e.eventType==u?this.has_moved=!1:e.eventType!=h||this.moved?e.eventType==p&&"touchcancel"!=e.srcEvent.type&&e.deltaTime<t.options.tap_max_touchtime&&!this.has_moved&&(i=(n=y.previous)&&n.lastEvent&&e.timeStamp-n.lastEvent.timeStamp,o=!1,n&&"tap"==n.name&&i&&i<t.options.doubletap_interval&&e.distance<t.options.doubletap_distance&&(t.trigger("doubletap",e),o=!0),(!o||t.options.tap_always)&&(y.current.name="tap",t.trigger(y.current.name,e))):this.has_moved=e.distance>t.options.tap_max_distance}},i.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(e,t){return t.options.prevent_mouseevents&&e.pointerType==l?void e.stopDetect():(t.options.prevent_default&&e.preventDefault(),void(e.eventType==u&&t.trigger(this.name,e)))}},i.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1,transform_within_instance:!1},triggered:!1,handler:function(e,t){if(y.current.name!=this.name&&this.triggered)return t.trigger(this.name+"end",e),void(this.triggered=!1);if(!(e.touches.length<2)){if(t.options.transform_always_block&&e.preventDefault(),t.options.transform_within_instance)for(var n=-1;e.touches[++n];)if(!m.hasParent(e.touches[n].target,t.element))return;switch(e.eventType){case u:this.triggered=!1;break;case h:var i=Math.abs(1-e.scale),o=Math.abs(e.rotation);if(i<t.options.transform_min_scale&&o<t.options.transform_min_rotation)return;y.current.name=this.name,this.triggered||(t.trigger(this.name+"start",e),this.triggered=!0),t.trigger(this.name,e),o>t.options.transform_min_rotation&&t.trigger("rotate",e),i>t.options.transform_min_scale&&(t.trigger("pinch",e),t.trigger("pinch"+(e.scale<1?"in":"out"),e));break;case p:this.triggered&&t.trigger(this.name+"end",e),this.triggered=!1}}}},n=i}(window),n.defaults.stop_browser_behavior.touchAction="pan-y",n):e})),define("DS/WebInfraUI/SubMenuPicker",["UWA/Core","DS/Core/PointerEvents"],(function(e,t){"use strict";var n=e.Class.extend({init:function(t){this._onFirstClick=t.onFirstClick,this._onSecondClick=t.onSecondClick;var n=t.values;this._container=new e.Element("div",{class:"CAT3DPlaySubMenu-container contextual "}),this._containerS=new e.Element("div",{class:"sketch3d-contextual-smallSubMenuPicker closed",html:[{tag:"div",class:"sketch3d-contextual-smallSubMenuPicker-current"},{tag:"div",class:"sketch3d-contextual-smallSubMenuPicker-picker closed"}]}).inject(this._container),this._containerS.setAttribute("state","close"),this.createStandardOption({parent:this._containerS.children[0],id:t.name,fontID:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-menu-dot"});for(var i=0;i<n.length;i++)this.createStandardOption({parent:this._containerS.children[1],id:n[i].id,fontID:n[i].fontID})},createStandardOption:function(n){var i=new e.Element("div",{class:"CAT3DPlayAction-container available"}).inject(n.parent),o=new e.Element("div",{class:"CAT3DPlayButton-container",id:n.id}).inject(i);o.addEventListener(t.POINTERDOWN,this._onSmallClick.bind(this)),new e.Element("span",{class:"CAT3DPlayButton-icon"}).inject(o).addClassName(n.fontID)},_onSmallClick:function(e){"open"==this._containerS.getAttribute("state")?("subMenu3DPlay"==e.currentTarget.id&&this._onSecondClick(e.currentTarget.id),this.closeSmallUI(),this._onFirstClick(e.currentTarget.id)):(this.openSmallUI(),this._onSecondClick(e.currentTarget.id))},openSmallUI:function(){this._containerS.removeClassName("closed"),this._containerS.hasClassName("opened")||this._containerS.addClassName("opened"),this._containerS.children[1].removeClassName("closed"),this._containerS.children[1].hasClassName("opened")||this._containerS.children[1].addClassName("opened"),this._containerS.setAttribute("state","open")},closeSmallUI:function(){this._containerS.hasClassName("closed")||this._containerS.addClassName("closed"),this._containerS.removeClassName("opened"),this._containerS.children[1].hasClassName("closed")||this._containerS.children[1].addClassName("closed"),this._containerS.children[1].removeClassName("opened"),this._containerS.setAttribute("state","close")},getHTMLElement:function(){return this._container}});return e.namespace("DS/WebInfraUI/SubMenuPicker",n)})),define("DS/WebInfraUI/ConfirmBox",["UWA/Core","DS/WebappsUtils/WebappsUtils","DS/UIKIT/SuperModal","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle"],(function(e,t,n,i,o){"use strict";return function(t){var s=new n({renderTo:t.container}),a=[],r=e.createElement("div"),l=e.createElement("div",{styles:{float:"left"}}),c=e.createElement("div",{styles:{"margin-left":"2em"}}),d=s.modalFactory({visible:!1,closable:void 0!==t.closable&&t.closable});d.setHeader({tag:"h4",text:t.caption}),l.addClassName("fonticon fonticon-attention"),r.appendChild(l);var u,h=function(e){d.hide(),e?(t.checkBox&&t.checkBox.callback.apply(t.this,[u.isChecked()]),t.confirm.callback.apply(t.this)):t.cancel.callback.apply(t.this),s=null,a=null,d=null,r=null,h=null,l=null,u=null,t=null};if(Array.isArray(t.info))for(var p=0;p<t.info.length;p++)c.appendChild(document.createTextNode(t.info[p])),c.appendChild(e.createElement("br"));else c.appendChild(document.createTextNode(t.info));t.checkBox&&(u=new o({type:"checkbox",label:t.checkBox.text,value:t.checkBox.text,checked:!1}),c.appendChild(u.elements.container)),r.appendChild(c),d.elements.body.addContent(r),a.push(new i({value:t.confirm.text,label:t.confirm.text,className:"primary"})),a[0].addEvent("onClick",(function(){h(!0)})),a.push(new i({value:t.cancel.text,label:t.cancel.text})),a[1].addEvent("onClick",(function(){h(!1)})),d.setFooter(a),d.dispatchEvent("onShowModal")}})),define("DS/WebInfraUI/SliderPanel",["UWA/Core","UWA/Controls/Abstract","DS/Controls/Slider","DS/Controls/Popup","css!DS/WebInfraUI/SliderPanel"],(function(e,t,n,i){var o=n.extend({init:function(e){this._parent(e),e.customValues&&(this.customValues=e.customValues,this.minValue=0,this.maxValue=e.customValues.length-1,this.stepValue=1),e.withStepMarkers&&this._updateStepMarkers()},getTextFromValue:function(){return this.customValues?this.customValues[this.value]:this._parent()},_updateStepMarkers:function(){this._linesContainer?this._linesContainer.empty():this._linesContainer=new e.Element("div",{class:"CAT3DPlay-Slider-LinesContainer"}).inject(this.getContent().querySelector(".wux-controls-slider-container"),"top");for(var t=Math.floor((this.maxValue-this.minValue)/this.stepValue),n=0;n<=t;n++)new e.Element("div",{class:"CAT3DPlay-Slider-Line"}).inject(this._linesContainer)}});return t.extend({defaultOptions:{text:"",className:"CAT3DPlay-Slider-Container"},init:function(e){this._parent(e),this.slider=null,this.leftButtons=[],this.rightButtons=[],this.buildSkeleton(e)},buildSkeleton:function(t){if(this.elements.container=new e.Element("div",{class:"CAT3DPlay-SliderPanel-Container"}),this.slider=new o(t),this.slider.getContent().addClassName("CAT3DPlay-Slider-Container"),this.slider.getContent().addClassName("CAT3DPlay-SliderPanel-Element"),this.slider.inject(this.elements.container),t.leftButtons)for(var n=0;n<t.leftButtons.length;n++)this.leftButtons.push(this._createButton(t.leftButtons[n]).inject(this.elements.container,"top"));if(t.rightButtons)for(n=0;n<t.rightButtons.length;n++)this.rightButtons.push(this._createButton(t.rightButtons[n]).inject(this.elements.container,"bottom"))},_createButton:function(t){var n=new e.Element("a",{class:"CAT3DPlay-SliderPanel-Button CAT3DPlay-SliderPanel-Element"});return new e.Element("div",{class:`CAT3DPlay-SliderPanel-ButtonIcon fonticon fonticon-${t.fonticon}`}).inject(n),t.popup&&this._popup(t.popup,n),n.addEventListener("pointerdown",t.onClick),n},_popup:function(t,n){return new i({className:"wux-controls-popup wux-slider-tooltip",arrowBoxFlag:!0,overlap:!1,target:n,position:"top",constraint:"screen",alignment:"center",trigger:"hover",forceKeepOrientation:!0}).setBody(new e.Element("span",{class:"wux-slider-span-tooltip",text:t}))}})})),define("DS/WebInfraUI/CmdScenarioUI",["UWA/Core","DS/CoreEvents/Events","css!DS/WebInfraUI/CmdScenario.css","DS/Core/PointerEvents","DS/WebSystem/DetectBrowser"],(function(e,t,n,i,o){"use strict";var s,a,r,l,c,d,u,h,p,m,f,v,g,b,C=!1,y=function(){var t=[],n=new e.Element("div",{class:"PlayWeb-Scroller",styles:{overflow:"hidden"}}),o=new e.Element("table",{id:"PlayWeb-ScrollContainer",styles:{margin:"0 auto",left:0,position:"relative"}}).inject(n),s=new e.Element("tr",{id:"PlayWeb-ScrollList",styles:{position:"relative","justify-content":"center"}}).inject(o),a=new e.Element("a",{class:"fonticon fonticon-chevron-left Scrolling-Arrow "+c,styles:{left:0},events:{click:function(){h("left")}}}).inject(n),r=new e.Element("a",{class:"fonticon fonticon-chevron-right Scrolling-Arrow "+c,styles:{right:0},events:{click:function(){h("right")}}}).inject(n),l=!1,u=0,h=function(e){var t=n.offsetWidth-o.scrollWidth,i=parseFloat(o.getStyle("left")),s=o.scrollWidth-(Math.abs(i)+n.offsetWidth),a=Math.abs(i)%d,r=0;r=0===i||0===a?Math.min(s,d):a;var l=i;if("left"===e?l+=r:"right"===e&&(l-=r),l<=0&&l>=t){o.setStyle("transition","left 0.6s ease-in-out 0s");var c=function(){p(),o.removeEventListener("transitionend",c,!0),o.setStyle("transition","")};o.addEventListener("transitionend",c,!0),o.setStyle("left",l)}},p=function(){var e=parseFloat(o.getStyle("left")),t=n.offsetWidth-o.scrollWidth;t>=0?(r.setStyle("display","none"),a.setStyle("display","none")):e>=0?(r.setStyle("display","inline"),a.setStyle("display","none")):e<=t?(r.setStyle("display","none"),a.setStyle("display","inline")):(r.setStyle("display","inline"),a.setStyle("display","inline"))};n.addEvent(i.POINTERDOWN,(function(e){o.scrollWidth>n.offsetWidth&&(l=!0,u=e.clientX)}),!0),n.addEvent(i.POINTERMOVE,(function(e){if(!0===l){var t=u;u=e.clientX;var i=n.offsetWidth-o.scrollWidth,s=parseFloat(o.getStyle("left"))+(u-t);s<=0&&s>=i&&(o.setStyle("left",s),p())}}),!0),n.addEvent(i.POINTERUP,(function(){l=!1}),!0),o.inject(n),this.appendTo=function(e){n.inject(e),requestAnimationFrame(p)},this.addScrollItem=function(n,i){var o=new e.Element("td",{});if(i){var a=new e.Element("tr",{id:"PlayWeb-ScrollList",styles:{position:"relative","justify-content":"center"}});o.inject(a),o=a}o.inject(s),n.appendTo(o),t.push(o)}},w=function(){var t=new e.Element("div",{class:"PlayWeb-ScenarioItemSepartor",styles:{width:"3px","background-image":"radial-gradient(#d4d4d4, white)",margin:"20px",height:a+"px"}});this.appendTo=function(e){t.inject(e)}},S=function(t){d=s;var n="#d1d4d4";t.selected&&(n="#89CFF0");var i=new e.Element("div",{class:"PlayWeb-ScenarioItem",styles:{position:"relative",cursor:"pointer",margin:"20px",width:s+"px",height:a+"px"},events:{click:function(){t.onSelectCB&&t.onSelectCB(t.data)}}});if(g<320){var c=new e.Element("img",{class:"PlayWeb-ScenarioThumbnail",src:t.thumbnail,styles:{height:"100%",width:"100%","pointer-events":"none"}}).inject(i);"ie"===o().browser.name?(c.setStyle("background-repeat","no-repeat"),c.setStyle("background-position","center"),c.setStyle("background-size","contain")):c.setStyle("object-fit","scale-down")}else{new e.Element("div",{class:"PlayWeb-ScenarioItemBack1",styles:{width:s+"px",height:a+"px",position:"absolute","background-color":"white",border:"1px solid "+n,top:"-10px",left:"-10px","pointer-events":"none"}}).inject(i),new e.Element("div",{class:"PlayWeb-ScenarioItemBack2",styles:{width:s+"px",height:a+"px",position:"absolute","background-color":"white",border:"1px solid "+n,top:"-5px",left:"-5px","pointer-events":"none"}}).inject(i);var u=new e.Element("div",{class:"PlayWeb-ScenarioItemFront",styles:{width:s+"px",height:a+"px",position:"absolute","background-color":"white",border:"1px solid "+n,top:"0px",left:"0px",display:"flex","flex-direction":"column","align-items":"center","pointer-events":"none"}}).inject(i),h=new e.Element("img",{class:"PlayWeb-ScenarioThumbnail",src:t.thumbnail,styles:{height:r+"px",width:"100%","background-color":"#f4f5f6",border:"3px solid "+n,"pointer-events":"none"}}).inject(u);"ie"===o().browser.name?(h.setStyle("background-repeat","no-repeat"),h.setStyle("background-position","center"),h.setStyle("background-size","contain")):h.setStyle("object-fit","scale-down");var p=new e.Element("div",{class:"PlayWeb-ScenarioNameContainer",styles:{height:l+"px","line-height":l-5+"px",border:"2px solid white","text-align":"center","pointer-events":"none",width:"100%"}}).inject(u);new e.Element("span",{class:"PlayWeb-ScenarioName",html:t.name,styles:{"font-family":"3ds","font-size":"16px",color:"#368ec4",width:"100%","pointer-events":"none",display:"inline-block","vertical-align":"middle","line-height":"normal"}}).inject(p)}this.appendTo=function(e){i.inject(e)}},E=function(t){var n=new e.Element("div",{class:"PlayWeb-ScenarioChooserMainPanel",styles:{"z-index":5,position:"absolute","background-color":"#f4f5f6",opacity:.9,border:"1px solid #d1d4d4","font-family":"3ds",width:t.width+"px",height:t.height+"px"}});if(t.showTopBar){var i=new e.Element("div",{id:"PlayWeb-ScenarioChooserTopBar",styles:{position:"relative"}}).inject(n);new e.Element("span",{class:"fonticon fonticon-close",styles:{cursor:"pointer",margin:"10px",position:"absolute",right:0,top:0},events:{click:function(){t.onCloseCB&&t.onCloseCB()}}}).inject(i)}var o=new e.Element("div",{id:"PlayWeb-ScenarioChooserContent",styles:{display:"flex","flex-direction":"column","justify-content":"center",width:"100%",height:"100%"}}).inject(n);new e.Element("p",{id:"PlayWeb-ScenarioChooserTitle",styles:{color:"black","font-size":"20px","font-weight":"bold",margin:"10px"}}).inject(o).setContent(t.title);new e.Element("span",{class:"fonticon fonticon-close",styles:{cursor:"pointer",margin:"10px",position:"absolute",right:0,top:0},events:{click:function(e){t.onCloseCB&&t.onCloseCB()}}}).inject(o);for(var a=new y,r=0;r<t.scenarios.length;r++){var l=new S(t.scenarios[r]);if(a.addScrollItem(l,t.vertical),r<t.scenarios.length-1&&t.showSeparator){var c=new w;a.addScrollItem(c),d=s+80+3}}a.appendTo(o),this.appendTo=function(e){n.inject(e)},this.getPosition=function(){return{top:n.offsetTop,left:n.offsetLeft}},this.setPosition=function(e,t){n.setStyles({top:e,left:t})},this.getDimensions=function(){return{height:n.offsetHeight,width:n.offsetWidth}},this.setDimensions=function(e,t){n.setStyles({height:e,width:t})},this.destroy=function(){n.remove()}},_=function(){if(h&&(h.destroy(),h=void 0),u&&(u.remove(),u=null),C&&(f.getViewerFrame().removeEvent("resize",v),C=null),p&&(t.unsubscribe(p),p=null),f){let e=f.getMAB();e&&!1===e.state.visible&&t.publish({event:"3DPLAY/SPECTREE/ENABLE",data:{}}),f=null}};return{dispose:_,create:function(n){t.publish({event:"3DPLAY/SPECTREE/DISABLE",data:{}}),f&&_(),(f=n.frmWnd)||console.error("options.frmWnd missing"),m=f.getViewerFrame(),v=function(){n.endcb(),_()},f.getViewer().SCREEN_WIDTH||f.getViewer().SCREEN_HEIGHT||(f.getViewerFrame().addEvent("resize",v),C=!0),g=f.getViewer().SCREEN_WIDTH||f.getViewer().getContainer().offsetWidth;var i=(b=f.getViewer().SCREEN_HEIGHT||f.getViewer().getContainer().offsetHeight)>g;i?(s=160,a=120,r=70,l=45,c="fonticon-2x"):g>=800?(s=200,a=150,r=100,l=45,c="fonticon-3x"):g>=540&&g<800?(s=160,a=120,r=70,l=45,c="fonticon-2x"):g>=320&&g<540?(s=135,a=110,r=60,l=45,c="fonticon-2x"):(s=80,a=60,c=""),(u=new e.Element("div",{class:"PlayWeb-ScenarioChooserBackgroundPanel",styles:{position:"absolute",width:g+"px",height:b+"px"},events:{click:function(){n.endcb(),_()}}})).inject(f.getUIFrame());var o=g<480?b:300,d=g;let y=f.getMAB();(h=new E({vertical:i,title:n.title,scenarios:n.listchooser,height:o,width:d,mab:y&&y.state.visible,onCloseCB:function(){_(),n.endcb()},showSeparator:g>=540,showTopBar:g<540})).appendTo(f.getUIFrame());var w=h.getDimensions(),S=.5*m.offsetHeight-.5*w.height+"px";h.setPosition(S,"0px"),p=t.subscribe({event:"/VISU/onWindowResized"},(function(e){"@onWindowResized"===e.eventType&&v()}))}}})),define("DS/WebInfraUI/Progress",["css!DS/WebInfraUI/Progress.css","UWA/Core","UWA/Class"],(function(e,t,n){"use strict";return n.extend({init:function(e){this.state={visible:!1,indeterminate:!0,disposed:!1,value:-1},e&&(this.mode=e.mode),this.spinnerContainer=new t.Element("div",{class:"PlayWeb-Progress-Container"}),this.progressBar=new t.Element("div",{class:"PlayWeb-Progress"}).inject(this.spinnerContainer),new t.Element("span",{}).inject(this.progressBar)},dispose:function(){this.state.disposed=!0;try{this.spinnerContainer.getParent().removeChild(this.spinnerContainer)}catch(e){}this.spinnerContainer=null,this.progressBar=null},getContent:function(){return this.spinnerContainer},hide:function(){if(!1===this.state.disposed){this.state.visible=!1,this.spinnerContainer.style.transition="height 1s linear 0.5s",this.spinnerContainer.style.height=0;var e=this;this.hidingTimoutID=setTimeout((function(){e.spinnerContainer&&(e.spinnerContainer.style.transition="",e.spinnerContainer.style.display="none",e.spinnerContainer.style.height=""),e.hidingTimoutID=null,e=null}),2e3)}},visible:function(){!1===this.state.disposed&&(this.hidingTimoutID&&clearTimeout(this.hidingTimoutID),this.spinnerContainer.style.transition="",this.spinnerContainer.style.height="",void 0!==this.state.value&&(this.progressBar.style.transitionDuration="0s",this.updateProgression(this.state.value),this.progressBar.style.transitionDuration=""),this.state.visible=!0,"3DWhiteboard"!==this.mode&&(this.spinnerContainer.style.display="block"))},updateProgression:function(e){!1===this.state.disposed&&(this.state.value=e,-1===this.state.value?(this.state.indeterminate=!0,this.spinnerContainer.addClassName("indeterminate")):(this.state.indeterminate&&(this.state.indeterminate=!1,this.spinnerContainer.removeClassName("indeterminate")),this.progressBar.style.width=Math.max(this.state.value,1)+"%"))},getProgressBarState:function(){return this.state.visible}})}));var webux="DS/ControlsEx/LoadingPanel";define("DS/WebInfraUI/LoadingPanel",[webux],(function(e){"use strict";return e.extend({init:function(e){this.progressDiv=UWA.Element("div",{id:"3DPlayUpload_Progress",styles:{"text-align":"center","z-index":1600,position:"absolute",top:"10px",width:"100%","user-select":"none","pointer-events":"none"}}).inject(e.container);var t={value:0,showButtonsFlag:e.showButtonsFlag};if(e.info&&(t.info=e.info),this._parent(t),this.elements.container.style.display="inline-block",this.elements.container.style.textAlign="initial",this.elements.container.style.pointerEvents="all",this.inject(this.progressDiv),e.title){let t=this.getContent().firstChild;this.title=UWA.Element("div",{styles:{"font-weight":"bold"},html:e.title}),t.insertBefore(this.title,t.firstChild)}},setTitleString:function(e){if(!this.title)throw"no title set in ctor";this.title.innerHTML=e},setInfoString:function(e){let t=this.getContent().getElementsByClassName("wux-controls-loading-panel-label")[0];t&&(t.innerHTML=e)},setCloseButtonCB:function(e){this.unSetCloseButtonCB(),this.closeCB=e,this.elements._stopButton.addEventListener("buttonclick",this.closeCB)},unSetCloseButtonCB:function(){this.closeCB&&(this.elements._stopButton.removeEventListener("buttonclick",this.closeCB),this.closeCB=null)},dispose:function(){this.unSetCloseButtonCB(),this.progressDiv.getParent().removeChild(this.progressDiv),this.progressDiv=null,this._parent()},on:function(){this._parent(),this.elements.container.style.display="inline-block"}})})),define("DS/WebInfraUI/3DPlayModal",["UWA/Core","UWA/Element","UWA/Event","UWA/Utils/Client","UWA/Controls/Abstract","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text","DS/UIKIT/Form","i18n!DS/UIKIT/assets/nls/UIKIT"],(function(e,t,n,i,o,s,a,r,l,c){"use strict";var d={defaultOptions:{className:"",animate:!1,closable:!0,overlay:!0,okButtonText:c.ok,koButtonText:c.ko,typeOfText:"text"},modals:{current:null,queue:[]},init:function(e){this._parent(e)},prompt:function(t){var n,i,o,s,r,d,u,h,p,m,f,v,g,b=[],C=e.merge({visible:!1},this.options);function y(t){return function(){t&&(t=v.getContent().getElement("input").value),v.preventEvent=!0,v.hide(),e.is(s,"function")&&s(t)}}C.closable=!1!==this.options.closable,n=t.message,i=t.errormessage,o=t.title,s=t.callback,r=t.okButtonText,d=t.koButtonText,u=t.placeholder,h=t.required,p=t.typeOfText,m=t.value,f=Math.max(0,t.maxlength)||!1,C.events={onHide:function(){!v.preventEvent&&e.is(s,"function")&&s()},onShow:function(){g.getField("input-confirm").focus()}},v=this.modalFactory(C),g=new l({fields:[{type:p||C.typeOfText,required:!0===h,value:m||"",placeholder:u||C.placeholder||c.response,name:"input-confirm",label:n,maxlength:f}],events:{onSubmit:y(!0)}});var w="";if(i&&(w=i),e.is(w,"string")){var S=new e.Element("p",{styles:{color:"#FF0000"},text:w});v.elements.body.addContent(S,g)}e.is(o,"string")?v.setHeader({tag:"h4",text:o}):(v.getHeader().hide(),s||(s=o)),!e.is(s,"function")&&this.options.callback&&(s=this.options.callback),b.push(new a({value:r||C.okButtonText,className:"primary"})),b[0].addEvent("onClick",(function(){g.submit()})),b.push(new a({value:d||C.koButtonText})),b[1].addEvent("onClick",y(!1)),v.setFooter(b),v.dispatchEvent("onShowModal")},next:function(){this.modals.current&&this.modals.current.hide()},dispose:function(){this.modals&&this.modals.current&&this.modals.current.destroy()},modalFactory:function(t){var n,i=this;return(n=new s(t)).addEvents({onShowModal:function(){i.modals.current?i.modals.queue.push(this):(i.modals.current=this,i.lastFocus=document.activeElement,this.show())},onShow:function(){i.dispatchEvent("onShow")},onHide:function(){var t,n=i.modals.queue;i.dispatchEvent("onHide"),this.destroy(),n&&n.length>0?(t=n.splice(0,1)[0]).elements&&(t.show(),i.modals.current=t):(i.modals.current=null,i.lastFocus&&e.is(i.lastFocus.focus,"function")&&i.lastFocus.focus())}}),n.inject(t.renderTo||document.body),n}};return o.extend(d)})),
/*! Copyright 2014 Dassault SystÃ¨mes */
"object"==typeof nipplejs?define("DS/VENNippleJS",nipplejs):-1===require.toUrl("DS/VENNippleJS").indexOf("0.6.8/nipplejs.min")&&(NIPPLEJS_BASEPATH=require.toUrl("DS/VENNippleJS/0.6.8/"),NIPPLEJS_BASEPATH.indexOf("?")>-1&&(NIPPLEJS_BASEPATH=NIPPLEJS_BASEPATH.substring(0,NIPPLEJS_BASEPATH.indexOf("?"))),require.config({paths:{"DS/VENNippleJS":NIPPLEJS_BASEPATH+"nipplejs.min"},shim:{"DS/VENNippleJS":{exports:"nipplejs"}}})),define("DS/WebInfraUI/Joystick",["DS/VENNippleJS"],(function(e){"use strict";return e})),define("DS/WebInfraUI/NavigationArrows",["UWA/Class","UWA/Core","DS/WebInfraUI/Touch","css!WebInfraUI/NavigationArrows.css","DS/WebappsUtils/WebappsUtils"],(function(e,t,n,i,o){"use strict";var s=o.getWebappsBaseUrl()+"WebInfraUI/assets/icons/128/",a=function(e,i,o){var a,r;this.id=e;"clockwise"===e||"counterClockwise"===e?(a=s+"I_3DPlay_Rotate_CW_Disabled.png",r=s+"I_3DPlay_Rotate_CW.png"):(a=s+"I_3DPlay_FlickArrow_Disabled.png",r=s+"I_3DPlay_FlickArrow.png"),this.arrowContainer=new t.Element("div",{id:"navigate3DPlay-arrow-"+this.id,class:"navigate3DPlay-arrow",styles:{position:"absolute","background-image":"url("+a+")",opacity:1},events:{onclick:function(e){return e.preventDefault(),!1},mousemove:function(e){this.arrowContainer.style.transition="background-image 0s linear .2s",this.arrowContainer.style.backgroundImage="url("+r+")"}.bind(this),mouseleave:function(e){this.arrowContainer.style.backgroundImage="url("+a+")"}.bind(this),touchstart:function(e){this.arrowContainer.style.transition="background-image 0s linear",this.arrowContainer.style.backgroundImage="url("+r+")",e.preventDefault()}.bind(this),touchend:function(e){this.arrowContainer.style.transition="background-image 0s linear",this.arrowContainer.style.backgroundImage="url("+a+")",e.preventDefault()}.bind(this)}}).inject(i),this.arrowContainer.style.backgroundImage="url("+r+")",setTimeout(function(){this.arrowContainer.style.transition="background-image .2s linear .2s",this.arrowContainer.style.backgroundImage="url("+a+")"}.bind(this),200),this.onclickCB=function(e){o(e),e&&e.preventDefault&&e.preventDefault(),e&&e.srcEvent&&e.srcEvent.stopPropagation&&e.srcEvent.stopPropagation()},n(this.arrowContainer).on("tap",this.onclickCB),window.__karma__&&(this.arrowContainer.onclick=this.onclickCB),this.dispose=function(){n(this.arrowContainer).off("tap",this.onclickCB),this.arrowContainer.remove(),this.arrowContainer=null,this.onclickCB=null,this.id=null}};return e.extend({init:function(e,t){this._parent(t),this._arrowsList={},this._container=t.container,this._frmWindow=t.frmWindow;var i=this._frmWindow.getUIFrame();for(var o in this._gestureList=e.gestureCB,e.arrowCB){var s=new a(o,this._container,e.arrowCB[o]);this._arrowsList[o]=s}for(var r in n.defaults.touchAction="none",this.uiFrameTouch=n(i),this.uiFrameTouch.get("swipe").set({direction:Hammer.DIRECTION_ALL,threshold:1,velocity:.1}),this._gestureList)"rotate"===r?(this.uiFrameTouch.get("rotate").set({enable:!0}),this.uiFrameTouch.on("rotate",this._gestureList[r])):this.uiFrameTouch.on(r,this._gestureList[r]);this._checkKeyCB=function(e){return this._checkKey(e)}.bind(this),document.addEventListener("keydown",this._checkKeyCB);var l=this._frmWindow.getViewerFrame();t.toNotListenResize||(this._resizeCB=function(e){return this._onViewerResize(e)}.bind(this),l.addEvent("resize",this._resizeCB)),this._onViewerResize()},_checkKey:function(e){var t=e;(37===t.keyCode||100===t.keyCode)&&!1===t.ctrlKey&&this._arrowsList.left&&this._arrowsList.left.onclickCB?this._arrowsList.left.onclickCB(t):(39===t.keyCode||102===t.keyCode)&&!1===t.ctrlKey&&this._arrowsList.right&&this._arrowsList.right.onclickCB?this._arrowsList.right.onclickCB(t):(38===t.keyCode||104===t.keyCode)&&!1===t.ctrlKey&&this._arrowsList.up&&this._arrowsList.up.onclickCB?this._arrowsList.up.onclickCB(t):(40===t.keyCode||98===t.keyCode)&&!1===t.ctrlKey&&this._arrowsList.down&&this._arrowsList.down.onclickCB?this._arrowsList.down.onclickCB(t):(39===t.keyCode&&!0===t.ctrlKey||99===t.keyCode)&&this._arrowsList.down&&this._arrowsList.down.onclickCB?this._arrowsList.clockwise.onclickCB(t):(37===t.keyCode&&!0===t.ctrlKey||97===t.keyCode)&&this._arrowsList.down&&this._arrowsList.down.onclickCB&&this._arrowsList.counterClockwise.onclickCB(t)},_onViewerResize:function(){var e=this._frmWindow.getViewer(),t=(this._frmWindow.getViewerFrame(),this._container.getBoundingClientRect()),n=e.SCREEN_HEIGHT||t.height,i=e.SCREEN_WIDTH||t.width,o=(this._frmWindow&&this._frmWindow.getMAB()).state.visible;if(e.getCurrentSheet){var s=e.getCurrentSheet();n=s.currentHeight,i=s.currentWidth}var a=Math.max(64,Math.min(128,.08*n)),r=n/2-a,l=i/2-a;for(var c in this._arrowsList)switch(this._arrowsList[c].arrowContainer.setStyles({height:2*a,width:2*a}),this._arrowsList[c].id){case"left":this._arrowsList[c].arrowContainer.setStyles({top:r,left:"-35px"});break;case"right":this._arrowsList[c].arrowContainer.setStyles({top:r,right:"-35px"});break;case"up":this._arrowsList[c].arrowContainer.setStyles({left:l,top:"-35px"});break;case"down":this._arrowsList[c].arrowContainer.setStyles({left:l,bottom:"-80px"});break;case"clockwise":if(o){this._arrowsList[c].arrowContainer.setStyles({left:"-15px",bottom:"-15px"});break}this._arrowsList[c].arrowContainer.setStyles({left:"5px",bottom:"-80px"});break;case"counterClockwise":if(o){this._arrowsList[c].arrowContainer.setStyles({right:"-15px",bottom:"-15px"});break}this._arrowsList[c].arrowContainer.setStyles({right:"5px",bottom:"-80px"})}},dispose:function(){n.defaults.touchAction="pan-y";var e=this._frmWindow.getViewerFrame();for(var t in this._resizeCB&&e.removeEvent("resize",this._resizeCB),document.removeEventListener("keydown",this._checkKeyCB),this._arrowsList)this._arrowsList[t].dispose();for(var i in this._gestureList)this.uiFrameTouch.off(i,this._gestureList[i]);this.uiFrameTouch=null,this._gestureList=null,this._arrowsList=null,this._container=null,this._frmWindow=null}})})),define("DS/WebInfraUI/ContextualBar",["UWA/Core","UWA/Class","DS/WebSystem/Nls","DS/WebSystem/Rsc","DS/WebInfraUI/Touch","css!WebInfraUI/ContextualBar.css"],(function(e,t,n,i,o,s){"use strict";var a,r,l=function(t){var s=this,r=t.content;this.id=r.id,this.token=t.token,this.visible=!0,this.btnSelectedStyle=r.btnSelectedStyleSquare?"ContextualBar_IconDiv_On_Square":"ContextualBar_IconDiv_On_Side",this.customSelectorCB=r.customSelectorCB,this.buttonDiv=new e.Element("div",{id:r.id,class:"ContextualBar_Button"}),this.buttonDivMAB=new e.Element("div",{id:r.id,class:"PlayWeb-MAB-cmd",styles:{"z-index":0}}),this.toggleSelected=function(){!0===s.buttonDiv.selected?s.setSelected(!1):!1===s.buttonDiv.selected&&s.setSelected(!0)},this.disable=function(e){this.visible=e,this.visible?s.buttonDivMAB.style.opacity=.5:s.buttonDivMAB.style.opacity=1},this.setSelected=function(e){!0===e?(s.buttonDiv.addClassName(s.btnSelectedStyle),s.buttonDivMAB.addClassName("PlayWeb-MAB-cmd-selected"),s.buttonDiv.selected=!0):(s.buttonDiv.removeClassName(s.btnSelectedStyle),s.buttonDivMAB.removeClassName("PlayWeb-MAB-cmd-selected"),s.buttonDiv.selected=!1),a&&a({id:s.id,token:s.token,state:s.buttonDiv.selected})},this.onClick=function(e){var n,i;e&&(n=e.target.offsetTop+e.target.offsetParent.offsetTop+e.target.offsetParent.offsetParent.offsetTop,i=e.target.offsetLeft+e.target.offsetParent.offsetLeft+e.target.offsetParent.offsetParent.offsetLeft),t.onClickCB({event:e,id:s.id,token:s.token,position:{top:n,left:i}}),e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation()},o(this.buttonDiv).on("tap",s.onClick),o(this.buttonDivMAB).on("tap",s.onClick),window.__karma__&&(this.buttonDiv.onclick=this.onClick),this.dispose=function(){o(s.buttonDiv).off("tap",s.onClick),o(this.buttonDivMAB).off("tap",s.onClick),s.buttonDiv.remove(),s.buttonDivMAB.remove(),s.buttonDiv=void 0,s.buttonDivMAB=void 0,s=void 0},this.getSelected=function(){return s.buttonDiv?s.buttonDiv.selected:null},this.updateButton=function(e){e&&"function"==typeof e&&(s.buttonDiv&&s.buttonDiv.btnCustomContent&&(s.buttonDiv.btnCustomContent.remove(),s.buttonDiv.btnCustomContent=void 0,s.buttonDivMAB.btnCustomContent.remove(),s.buttonDivMAB.btnCustomContent=void 0),s.buttonDiv.btnCustomContent=e(),s.buttonDivMAB.btnCustomContent=e(),s.buttonDiv.btnCustomContent&&(s.buttonDiv.btnCustomContent.inject(s.buttonDiv),s.buttonDivMAB.btnCustomContent.inject(s.buttonDivMAB)))};var l=r.iconSize||"Normal";i.rsc(r.rsc,{iconName:r.id,iconSize:l},(function(i){if(s&&s.buttonDiv){var o=new e.Element("div",{id:"icon_"+r.id,class:t.buttonStyle||"ContextualBar_IconDiv",styles:{backgroundImage:"url("+i+")"},events:{mousemove:function(){o.style.cursor="pointer"},mouseleave:function(){o.style.cursor="default"}}}).inject(s.buttonDiv),a=new e.Element("div",{class:t.buttonStyle||"ContextualBar_IconDiv",styles:{backgroundImage:"url("+i+")"}}).inject(s.buttonDivMAB);void 0===r.selected||!1===r.selected?s.setSelected(!1):s.setSelected(!0),n.nls(r.nls,r.id,(function(e){void 0!==e?(o.setAttribute("title",e.Title),a.setAttribute("title",e.Title)):(o.setAttribute("title","undefined"),a.setAttribute("title","undefined"))}))}}))},c=function(e){var t,n=this,i=e.onclickCB;this.button=new l({content:e,token:e.token,buttonStyle:"ContextualBar_MasterIconDiv",onClickCB:function(e){n.onClick(e)}}),this.onClick=function(e){t=setTimeout((function(){i&&i({id:e.id,token:e.token})}),100)},this.dispose=function(){t&&(clearTimeout(t),t=void 0),n.button.dispose(),n=void 0}},d=function(e){var t,n=this,i=e.onclickCB;this.button=new l({content:e,token:e.token,buttonStyle:"ContextualBar_MasterIconDiv",onClickCB:function(e){n.onClick(e)}}),this.onClick=function(e){n.button.toggleSelected(),t=setTimeout((function(){i&&i({id:e.id,token:e.token,state:n.button.getSelected(),position:e.position,uncheck:n.button.toggleSelected})}),100)},this.dispose=function(){t&&(clearTimeout(t),t=void 0),n.button.dispose(),n=void 0}},u=function(e){var t,n=this,i=e.onclickCB;this.button=new l({content:e,token:e.token,onClickCB:function(e){n.onClick(e)}}),this.onClick=function(e){n.button.toggleSelected(),t=setTimeout((function(){i&&i({id:e.id,token:e.token,state:n.button.getSelected(),position:e.position,uncheck:n.button.toggleSelected})}),100)},this.setSelected=function(e){n.button.setSelected(e.state)},this.dispose=function(){t&&(clearTimeout(t),t=void 0),n.button.dispose(),n=void 0}},h=function(t){var n,i,o=this,s=t.onclickCB;this.buttons=[],this.buttonGroup=new e.Element("div",{id:t.groupName+"_group",class:"ContextualBar_ButtonGroup"}),this.onClick=function(e){for(var t,i=e.id,o=this,a=0;a<o.buttons.length;++a){var r=o.buttons[a];i===r.id?!1===r.getSelected()&&(r.setSelected(!0),t=r.getSelected()):r.setSelected(!1)}null!==t&&(n=setTimeout((function(){s&&s({id:e.id,token:e.token,state:!0,position:e.position,setSelected:o.setSelected})}),100))},this.setSelected=function(e){if(o&&o.buttons&&o.buttons.length){for(var t=0;t<o.buttons.length;++t)e.id===o.buttons[t].id?o.buttons[t].setSelected(!0):o.buttons[t].setSelected(!1);return!0}return!1};for(var a=0;a<t.content.length;++a){var r=new l({content:t.content[a],token:t.token,onClickCB:function(e){o.onClick(e)}});!0===r.getSelected()&&(i=this.buttons.length),this.buttons.push(r),this.buttonGroup.appendChild(r.buttonDiv)}void 0===i&&this.buttons[0].setSelected(!0),o.dispose=function(){n&&(clearTimeout(n),n=void 0);for(var e=0;e<o.buttons.length;e++)o.buttons[e].dispose();o.buttonGroup.remove(),o.buttonGroup=void 0,o=void 0}},p=function(t,n){var i,o,s=this,a=t.onclickCB;this._frmWindow=n.frmWindow,this.button=new l({content:t,token:t.token,onClickCB:function(e){s.onClick(e)}}),this.deleteExpandedPanel=function(){if(o&&(clearTimeout(o),o=void 0),s.container){if(Touch(document).off("tap",s.checkOnClickExpandedPanel),document.removeEventListener("onMouseOut",s.onEventCloseExpandedPanel),document.removeEventListener("onKeyDown",s.onEventCloseExpandedPanel),s.container.buttons)for(var e=0;e<s.container.buttons.length;e++)s.container.buttons[e].dispose();s.container.remove(),s.container=void 0}},this.createExpandedPanel=function(t,n){var i=s.frmWindow.getUIFrame();s.holdingContainer&&(i=s.holdingContainer),this.container=new e.Element("div",{class:"ContextualBar_ExpandedContainer ContextualBar_Background"}).inject(i);var a=document.getElementsByClassName("ContextualBar_MainContainer").item(0);s.container.style.top=2+a.offsetTop+n.offsetTop+"px",s.container.buttons=[],m(t.content,s.container,s._frmWindow),s.checkOnClickExpandedPanel=function(e){var t="ContextualBar_ExpandedContainer ContextualBar_Background";e.target.className!==t&&e.target.parentNode&&e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className!==t&&e.target.parentNode.parentNode.parentNode&&e.target.parentNode.parentNode.parentNode.className!==t&&s.closePanel()},s.onEventCloseExpandedPanel=function(e){var t=e.from[0].event;("BODY"===t.target.tagName||t.target.activeElement&&"BODY"===t.target.activeElement.tagName)&&s.closePanel()},o=setTimeout((function(){Touch(document).on("tap",s.checkOnClickExpandedPanel),document.addEventListener("onMouseOut",s.onEventCloseExpandedPanel),document.addEventListener("onKeyDown",s.onEventCloseExpandedPanel)}),100)},this.closePanel=function(){this.button.setSelected(!1),this.deleteExpandedPanel()},this.onClick=function(e){!0===this.button.getSelected()?this.closePanel():(this.button.setSelected(!0),i=setTimeout((function(){if(a){var t=a({id:e.id,token:e.token,state:this.button.getSelected(),position:e.position});t&&e.event&&this.createExpandedPanel(t,e.event.target.parentNode)}}),100))},this.setSelected=function(){},this.dispose=function(){i&&(clearTimeout(i),i=void 0),s.deleteExpandedPanel(),s.button.dispose(),s=void 0}};function m(e,t,n){for(var i=0;i<e.length;i++){var o,s=e[i];if(1===s.type)o=new h(s),t.buttons.push(o),t.appendChild(o.buttonGroup);else if(3===s.type){o=new c(s),t.masterButton=o;var a=t.querySelector("#ContextualBar_MasterButtonContainer");a.style.display="block",a.appendChild(o.button.buttonDiv),t.querySelector("#ContextualBar_MasterButtonSeparator").style.display="inline-block"}else if(4===s.type){o=new d(s);var r=t.querySelector("#ContextualBar_MasterButtonContainer");r.style.display="block",r.appendChild(o.button.buttonDiv),t.querySelector("#ContextualBar_MasterButtonSeparator").style.display="inline-block"}else if(5===s.type);else{if(0===s.type)o=new u(s);else if(2===s.type){if(0===document.getElementsByClassName("ContextualBar_ExpandedContainer").length)o=new p(s,{frmWindow:n})}o&&(t.buttons.push(o),t.appendChild(o.button.buttonDiv))}}}return t.extend({init:function(e,t){return this.frmWindow=t.frameWindow,this.holdingContainer=t.container,r=t.UIHandlerCB,this.panel=this._createPanel(e,t),this.flyoutMAB=this._createFlyoutMAB(this.container.buttons,this.container.masterButton,t.mab||{}),a=t.updateSelectedCB,this.panel},_createFlyoutMAB:function(e,t,n){var i=this.frmWindow.getMAB();if(i)if(!0===n.isDispose)i.showFlyout(0);else{var o,s,a=[];for(o=0;o<e.length;o++)if(e[o].buttons)for(s=0;s<e[o].buttons.length;s++)a.push({uxElt:e[o].buttons[s].buttonDivMAB});else e[o].button&&a.push({uxElt:e[o].button.buttonDivMAB});a.backCB=n.backCB||t&&t.button?t.button.onClick:void 0,i.showFlyout(n.flyoutLevel||1,a)}},_createPanel:function(t,n){var i=this.frmWindow.getUIFrame();this.holdingContainer&&(i=this.holdingContainer);var o=new e.Element("div",{class:"ContextualBar_Panel"});this.parentContainer=new e.Element("div",{class:"parentContainer_contextualBar"}).inject(o),this.container=new e.Element("div",{class:"ContextualBar_MainContainer"}).inject(this.parentContainer),this.masterButtonContainer=new e.Element("div",{id:"ContextualBar_MasterButtonContainer",styles:{display:"none"}}).inject(this.container);var s=new e.Element("div",{id:"ContextualBar_MasterButtonSeparator",styles:{display:"none"}}).inject(this.container);new e.Element("span",{class:"fonticon fonticon-menu-dot",styles:{transform:"rotate(90deg)",opacity:"0.4"}}).inject(s),n.showContextBarBackground&&this.addDefaultBackground(),this.container.buttons=[],this.container.masterButton=null,m(t,this.container,this.frmWindow);var a=new e.Element("div",{id:"ContextualBar_subOptionButtonSeparator",styles:{display:"none"}}).inject(this.container);new e.Element("span",{class:"fonticon fonticon-menu-dot",styles:{transform:"rotate(90deg)",opacity:"0.4"}}).inject(a),this.subOptionButtonContainer=new e.Element("div",{id:"ContextualBar_subOptionButtonContainer",styles:{display:"none"}}).inject(this.container),function(e,t,n){for(var i=0;i<e.length;i++){var o,s=e[i];if(5===s.type){o=new d(s);var a=t.querySelector("#ContextualBar_subOptionButtonContainer");a.style.display="block",a.appendChild(o.button.buttonDiv),t.querySelector("#ContextualBar_subOptionButtonSeparator").style.display="inline-block"}}}(t,this.container,this.frmWindow);var r=this.frmWindow.getMAB();r&&(r.state.visible&&(o.style.display="none"),r.onVisibilityChangeSubscribe("PlayWeb-ContextualBar",(function(e){o.style.display="hidden"!==e?"none":""}))),o.inject(i),this.viewerFrame=this.frmWindow.getViewerFrame(),this._setContexualBarMidframe=function(){this.holdingContainer?this.container.style.top=this.holdingContainer.offsetHeight/2-this.container.clientHeight/2+"px":this.container.style.top=this.viewerFrame.offsetHeight/2-this.container.clientHeight/2+"px",this.container.style.transition="top .2s ease-in"}.bind(this),this._setContexualBarMidframe(),this.viewerFrame.addEvent("resize",this._setContexualBarMidframe);var l=this.frmWindow.getImmersiveFrame();return this.freeZoneResize=this._updatePanelPosition.bind(this),l.addEventListener("freeZoneResize",this.freeZoneResize),this._updatePanelPosition(),o},setCustomPosition:function(e){var t=e.position,n=e.value;this.container.style[t]=n},_updatePanelPosition:function(){if(this.container){var e=this.container,t=0,n=this.frmWindow.getImmersiveFrame().getDockingElement(WUXDockAreaEnum.RightDockArea),i=n.getContainedWindows();if(i&&i.length&&(i[0].isAWindowGroup()&&i[0].getEmbeddedWindows().length||!i[0].isAWindowGroup())){for(var o=i[0].getEmbeddedWindows?i[0].getEmbeddedWindows():i,s=!1,a=0;a<o.length;a++)o[a].visibleFlag&&(s=!0);t=s&&!n.collapseDockingZoneFlag?n.dockingZoneSize+n._collapserSize:n._collapserSize}else n.interactiveDockAreaVisibleFlag&&(t=n.dockingZoneSize+n._collapserSize);e.setStyles({right:t+"px"}),this.holdingContainer?e.style.top=this.holdingContainer.offsetHeight/2-e.clientHeight/2+"px":e.style.top=this.frmWindow.getViewerFrame().offsetHeight/2-e.clientHeight/2+"px",e.style.transition="top .2s ease-in",r&&r(t)}},remove:function(){if(this.container&&this.container.buttons){for(var e=0;e<this.container.buttons.length;e++)this.container.buttons[e].dispose();this.container.buttons=void 0,this.container.masterButton=null,this.container.remove(),this.container=void 0}this.viewerFrame.removeEvent("resize",this._setContexualBarMidframe),this.frmWindow.getImmersiveFrame().removeEventListener("freeZoneResize",this.freeZoneResize),a=void 0,r=void 0,this.panel.remove(),this.panel=void 0;let t=this.frmWindow.getMAB();t&&t.onVisibilityChangeUnsubscribe("PlayWeb-ContextualBar"),this.frmWindow=void 0,this.viewerFrame=void 0},setSelected:function(e){if(this.container&&this.container.buttons)for(var t=0;t<this.container.buttons.length;++t){var n=this.container.buttons[t];if(n.buttons)for(var i=0;i<n.buttons.length;++i)n.buttons[i].id===e.id&&n.setSelected(e);else n.button&&n.button.id===e.id&&n.setSelected(e)}},updateButton:function(e){if(this.container&&this.container.buttons)for(var t=0;t<this.container.buttons.length;++t){var n=this.container.buttons[t];if(n.buttons)for(var i=0;i<n.buttons.length;++i)n.buttons[i].id===e.id&&n.buttons[i].updateButton(e.getButtonContent);else n.button&&n.button.id===e.id&&n.button.updateButton(e.getButtonContent)}},addDefaultBackground:function(){this.container.addClassName("ContextualBar_Background")},removeBackground:function(){this.container.removeClassName("ContextualBar_Background")}})})),define("DS/WebInfraUI/ContextualBarManager",["DS/WebInfraUI/ContextualBar","UWA/Class"],(function(e,t){"use strict";return t.extend({Toolbar:{New:0,Append:1},Button:{Check:0,Radio:1,Expander:2,Master:3,MasterCheck:4,SubOptionCheck:5},init:function(e){this.panelJSON=[],this.token=0,this.panel=null,this.frmWindow=e.frameWindow,this.container=e.container,this.viewer=this.frmWindow.getViewer(),this.UIHandlerCB=e.UIHandlerCB},addButtons:function(e,t){return this.token++,0===this.panelJSON.length?this.panelJSON[0]={}:0===t.barType&&(this.panelJSON[this.panelJSON.length]={}),this.panelJSON[this.panelJSON.length-1][this.token]={token:this.token,content:e},this._deletePanel(),this._rebuildPanel(t),this.token},setSelected:function(e){this.panel.setSelected(e)},updateButton:function(e){this.panel.updateButton(e)},_rebuildPanel:function(t){var n=this;if(this.panelJSON&&0!==this.panelJSON.length){var i=this.panelJSON.length,o=[];for(var s in this.panelJSON[i-1])for(var a=this.panelJSON[i-1][s].content,r=this.panelJSON[i-1][s].token,l=0;l<a.length;l++)a[l].token=r,o.push(a[l]);if(this.panel=new e(o,{frameWindow:this.frmWindow,container:this.container,updateSelectedCB:function(e){n._updateSelected(e)},showContextBarBackground:t.showContextBarBackground,mab:t.mab,UIHandlerCB:this.UIHandlerCB}),this.viewer.setContextualBarPosition){var c=this.viewer.setContextualBarPosition();c&&this.customContextualBarPosition(c)}}},customContextualBarPosition:function(e){this.panel.setCustomPosition(e)},_deletePanel:function(){this.panel&&(this.panel.remove(),this.panel=void 0)},_deleteToken:function(e){for(var t=!1,n=this.panelJSON.length-1;n>=0;n--){for(var i in this.panelJSON[n]){if(parseInt(i)===e&&this.panelJSON[n][e]){this.panelJSON[n][e]=null,delete this.panelJSON[n][e],0===Object.keys(this.panelJSON[n]).length&&this.panelJSON.splice(n,1),t=!0;break}}if(!0===t)break}},_updateSelected:function(e){for(var t=this.panelJSON.length-1;t>=0;t--)for(var n in this.panelJSON[t]){if(parseInt(n)===e.token){var i=this.panelJSON[t][e.token];if(i){var o=i.content;if(o)for(var s=0;s<o.length;++s){var a=o[s];if(a&&a.type===this.Button.Check&&a.id===e.id)return void(a.selected=e.state);if(a&&a.type===this.Button.Radio&&a.content)for(var r=0;r<a.content.length;++r){var l=a.content[r];if(l&&l.id===e.id)return void(l.selected=e.state)}}}}}},removeButtons:function(e,t){this._deletePanel(),this._deleteToken(e),this._rebuildPanel({showContextBarBackground:!0,mab:{isDispose:t}})},dispose:function(){this._deletePanel(),this.panelJSON=void 0,this.token=void 0,this.frmWindow=void 0}})})),define("DS/WebInfraUI/ColorPicker",["UWA/Core","DS/WebInfraUI/ColorButton"],(function(e,t){"use strict";var n=e.Class.extend({init:function(n){this._onFirstClick=n.onFirstClick,this._onSecondClick=n.onSecondClick;var i=n.values;this.topShift=n.topShift,this._pickersArray=[],this._currentSmallPicker=null,this._container=new e.Element("div",{class:"CAT3DPlayPicker-container contextual "+n.name}),this._containerS=new e.Element("div",{class:"sketch3d-contextual-smallColorPicker closed",html:[{tag:"div",class:"sketch3d-contextual-smallColorPicker-current"},{tag:"div",class:"sketch3d-contextual-smallColorPicker-picker closed"}]}).inject(this._container),this._containerS.style.position="relative",this._containerS.setAttribute("state","close");for(var o=null,s=!1,a=null,r=0;r<i.length;r++)o=i[r].value,s=i[r].isDefault,this._pickersArray[r]={},(a=new t({value:o,callback:this._onSmallClick.bind(this),id:"smallpicker_"+r})).setColor(o),a.getHTMLElement().inject(this._containerS.children[1]),this._pickersArray[r].small=a,s&&a.getHTMLElement().inject(this._containerS.children[0]),s?(a.toggleON(),this._currentSmallPicker=a):a.toggleOFF()},updateCurrentPicker:function(e){this._currentSmallPicker.setColor(e)},getCurrentVisiblePicker:function(){return this._currentSmallPicker},_onSmallClick:function(e){"open"==this._containerS.getAttribute("state")?(e.isON()&&this._onSecondClick(this._currentSmallPicker),this._updatePickers(e.getId()),this.closeSmallUI(),this._onFirstClick(e.getValue())):(this.openSmallUI(),this._onSecondClick(this._currentSmallPicker))},_updatePickers:function(e){for(var t=null,n=0;n<this._pickersArray.length;n++)this._pickersArray[n].small.getId()==e&&(t=n);this._containerS.children[0].empty(),this._containerS.children[1].empty();for(n=0;n<this._pickersArray.length;n++)n==t?(this._pickersArray[n].small.getHTMLElement().inject(this._containerS.children[0]),this._pickersArray[n].small.toggleON(),this._currentSmallPicker=this._pickersArray[n].small):(this._pickersArray[n].small.getHTMLElement().inject(this._containerS.children[1]),this._pickersArray[n].small.toggleOFF())},openSmallUI:function(){this._containerS.removeClassName("closed"),this._containerS.hasClassName("opened")||this._containerS.addClassName("opened"),this._containerS.children[1].removeClassName("closed"),this._containerS.children[1].hasClassName("opened")||this._containerS.children[1].addClassName("opened"),this._containerS.setAttribute("state","open"),this._containerS.style.top=-1*this.topShift+"px"},closeSmallUI:function(){this._containerS.hasClassName("closed")||this._containerS.addClassName("closed"),this._containerS.removeClassName("opened"),this._containerS.children[1].hasClassName("closed")||this._containerS.children[1].addClassName("closed"),this._containerS.children[1].removeClassName("opened"),this._containerS.setAttribute("state","close"),this._containerS.style.top="0px"},getHTMLElement:function(){return this._container}});return e.namespace("DS/WebInfraUI/ColorPicker",n)})),define("DS/WebInfraUI/FloatingBarManager",["UWA/Class","css!WebInfraUI/FloatingBar.css","DS/Core/PointerEvents","UWA/Core","DS/WebInfraUI/ColorPicker","DS/WebInfraUI/SubMenuPicker"],(function(e,t,n,i,o,s){"use strict";var a={Edit3DPlay:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-pencil",Delete3DPlay:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash",subMenu3DPlay:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-menu-dot"};return e.extend({init:function(e){this.bar=null,this.frmWindow=e.frameWindow,this.container=e.container},addCommands:function(e,t){this._deleteBar(),this._rebuildBar(e,t)},_rebuildBar:function(e,t){if(e&&0!==e.length){var n,a,r=52*e.length,l=52;n=t.top>57?t.top-5-l:this.container.clientHeight-t.top-t.height>57?t.top+t.height+5:0,(a=t.left+t.width/2-r/2)<0&&(a=0),a+r>this.container.clientWidth&&(a=this.container.clientWidth-r);var c=this._getextraVerticalSpan(e),d=this.getColors(),u=0;if(l+c+42>this.container.clientHeight)for(var h=0;h<e.length;h++)if("Color3DPlay"==e[h].id){c=42*((d=this.getTimmedColors(e[h].color.toUpperCase())).length-1);break}if(n+l+c>this.container.clientHeight){var p=n+l+c-this.container.clientHeight;u=42*Math.ceil(p/42)}this.bar=new i.Element("div",{class:"CAT3DPlay-FloatingMenuContainer",styles:{left:a+"px",top:n+"px","z-index":10}}).inject(this.container);for(h=0;h<e.length;h++)if("Color3DPlay"==e[h].id){for(var m=e[h],f=0;f<d.length;f++)if(d[f].value==e[h].color.toUpperCase()){d[f].isDefault=!0;break}this.colorPicker=new o({name:e[h].id,values:d,topShift:u,onFirstClick:function(e){m.onclick({id:m.id,color:e})}.bind(this),onSecondClick:function(e){}.bind(this)}),this.colorPicker.getHTMLElement().inject(this.bar)}else if("subMenu3DPlay"==e[h].id){var v=e[h],g=v.menu;this.subMenuPicker=new s({name:e[h].id,values:g,onFirstClick:function(e){v.onclick({id:e})}.bind(this),onSecondClick:function(e){}.bind(this)}),this.subMenuPicker.getHTMLElement().inject(this.bar)}else this.createStandardOption({content:e[h],parent:this.bar})}},_getextraVerticalSpan:function(e){var t=0;if(e&&e.length)for(var n=0;n<e.length;n++){var i=0;"Color3DPlay"==e[n].id?i=42*(this.getColors().length-1):"subMenu3DPlay"==e[n].id&&(i=52*e[n].menu.length),i>t&&(t=i)}return t},getColors:function(){return[{value:"#FF0000",colorName:"red"},{value:"#FF9900",colorName:"orange"},{value:"#FFFF00",colorName:"yellow"},{value:"#00CC00",colorName:"green"},{value:"#0033CC",colorName:"blue"},{value:"#660099",colorName:"purple"},{value:"#000000",colorName:"black"},{value:"#FFFFFF",colorName:"white"}]},getTimmedColors:function(e){for(var t=[{value:"#FF0000",colorName:"red"},{value:"#FFFF00",colorName:"yellow"},{value:"#00CC00",colorName:"green"},{value:"#0033CC",colorName:"blue"},{value:"#000000",colorName:"black"}],n=!1,i=0;i<t.length;i++)if(t[i].value==e){n=!0;break}if(0==n)for(i=0;i<t.length;i++)if("yellow"==t[i].colorName){t[i].colorName="current",t[i].value=e;break}return t},createStandardOption:function(e){var t=new i.Element("div",{class:"CAT3DPlayAction-container available"}).inject(e.parent),o=new i.Element("div",{class:"CAT3DPlayButton-container",id:e.content.id}).inject(t);o.addEventListener(n.POINTERDOWN,(function(t){e.content.onclick({id:t.currentTarget.id})})),new i.Element("span",{class:"CAT3DPlayButton-icon"}).inject(o).addClassName(a[e.content.id])},_deleteBar:function(){this.bar&&(this.bar.remove(),this.bar=void 0)},dispose:function(){this._deleteBar(),this.frmWindow=void 0}})}));