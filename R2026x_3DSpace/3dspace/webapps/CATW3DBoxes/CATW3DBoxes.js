/*!  Copyright 2014 Dassault Systemes. All rights reserved. */
define("DS/CATW3DBoxes/CATW3DBoxController",["UWA/Class","DS/Visualization/ThreeJS_DS","DS/Selection/CSOManager","DS/CATW3DMoveManager/CATW3DMoveManager","DS/CATW3DMoveManager/CATW3DMoveReferent","DS/CoreEvents/Events","DS/ENOPAD3DViewer/utils/PAD3DViewerModelServices","DS/CATWebUXPreferences/CATWebUXPreferencesManager"],(function(e,t,n,i,o,r,a,s){"use strict";var l=e.extend({init:function(e){var l=e||{};this._parent(l);var c,d,u,f,h=this,p=[],m=[],g=l.ctxViewer,v=!1,b=!0,x=null,C=null,y=null,w=function(e){return a.isPLMNode(e)},V=function(e){if(1===p.length){x=e.pathElement;var t=g.getFrameWindow().getContextualUIManager();if(t.hideContextualMenus(),x){var i=[];w(x.getLastElement(!0))&&w(x.getParentPath().getLastElement(!0))&&i.push({name:"CATW3DBoxesLevelSelectorStr",line:1,hdr_list:["LevelSelectorHdr"],type:"handler",identifier:"LevelSelectorHdr"});for(var o=!1,r=n.get(),a=0;a<r.length;a++){var s=r[a].pathElement;if(s=y.getMoveReferent(s)){var l=s.getMatrix();if(1!==l.elements[0]||1!==l.elements[5]||1!==l.elements[10]||1!==l.elements[15]||0!==l.elements[1]||0!==l.elements[2]||0!==l.elements[3]||0!==l.elements[4]||0!==l.elements[6]||0!==l.elements[7]||0!==l.elements[8]||0!==l.elements[9]||0!==l.elements[11]||0!==l.elements[12]||0!==l.elements[13]||0!==l.elements[14]){o=!0;break}}}o&&i.push({name:"CATW3DBoxesIdentityPositionStr",line:1,hdr_list:["CATW3DSetIdentityPositionHdr"],type:"handler",identifier:"CATW3DSetIdentityPositionHdr"}),i.length>0&&(g.getExecutionContext?t._showContextualBar({hideWithDistance:!0,fillingList:[{onContextualBarReady:function(){return{WAfrCtxBarRow1:{model:i}}},context:g.getCommandContext?g.getCommandContext():null,workbenchName:"CATW3DCommands",module:"CATW3DCommands",cmdPrefix:""}]}):t.showContextualBar({hideWithDistance:!0,fillingList:[{onContextualBarReady:function(){return{cmdList:i}},context:g.getCommandContext?g.getCommandContext():null,workbenchName:"CATW3DCommands",module:"CATW3DCommands",cmdPrefix:""}]}))}}},S=function(){for(var e=0;e<p.length;e++)p[e].setVisibleFlag(!1);g.getViewer().render()},B=function(){for(var e=0;e<p.length;e++)p[e].setVisibleFlag(!0);g.getViewer().render()},A=function(e){if(d){var i=g.getViewer(),o=i.getVisibleSpace(),r=e.getBoundingBox(null,i,o?"visibleSpace":"invisibleSpace");if(r&&!r.isNaN()){var a=e.getWorldMatrix(i),s=new t.Vector3(r.min.x,r.min.y,r.min.z),l=new t.Vector3(r.max.x,r.min.y,r.min.z),h=new t.Vector3(r.min.x,r.max.y,r.min.z),m=new t.Vector3(r.min.x,r.min.y,r.max.z),x=new t.Vector3(l.x-s.x,l.y-s.y,l.z-s.z),C=new t.Vector3(h.x-s.x,h.y-s.y,h.z-s.z),y=new t.Vector3(m.x-s.x,m.y-s.y,m.z-s.z),w=new d({pathElement:e,edgeMaterial:f,cornerPoint:s,fstAxis:x,sndAxis:C,thdAxis:y,matrix:a,rootBagPath:g.getRootBagPath().clone(),viewer:i});w.show(),p.push(w);var A={};A.onClick=w.subscribe("onBoxClick",V),A.onBeginManipulate=w.subscribe("onBoxBeginManipulate",S),A.onEndManipulate=w.subscribe("onBoxEndManipulate",B),c.boxTokens.push(A)}}else require(["DS/CATW3DBoxes/CATW3DBoxManipulator"],(function(e){if(d=e,b&&v)for(var t=n.get(),i=0;i<t.length;i++)u(t[i].pathElement)}))};u=function(e){if(p.length<50){var t=e?y.getMoveReferent(e):null;!t||p.some((function(e){return t.isEqual(e.getAssociatedPath())}))||A(t)}};var D=function(e){v&&u(e.pathElement)},T=function(e,t){if(t&&v)h.refreshBoxes();else if(!t&&(m=[],p.length&&e&&Array.isArray(e)))for(var n=[],i=0;i<e.length;i++){var o=e[i];if(o=y.getMoveReferent(o))for(var r=0;r<p.length;r++){var a=p[r].getAssociatedPath();o.isAParentOf(a)&&-1===n.indexOf(r)&&(p[r].setVisibleFlag(!1),n.push(r),m.push(a))}}},M=function(e){c&&c.boxTokens&&c.boxTokens[e]&&(p[e].unsubscribe(c.boxTokens[e].onClick),p[e].unsubscribe(c.boxTokens[e].onBeginManipulate),p[e].unsubscribe(c.boxTokens[e].onEndManipulate),c.boxTokens.splice(e,1)),p[e].hide(),p.splice(e,1)},E=function(e){if(v&&p&&0!==p.length){var t,i,o=[];if(e){for(t=0;t<p.length;t++)if((i=y.getMoveReferent(e.pathElement))&&i.isEqual(p[t].getAssociatedPath())){o.push(t);break}}else{var r=n.get();for(t=0;t<p.length;t++){for(var a=!0,s=0;s<r.length;s++)if(i=r[s].pathElement,(i=y.getMoveReferent(i))&&i.isEqual(p[t].getAssociatedPath())){a=!1;break}a&&o.push(t)}}o.sort((function(e,t){return e-t}));for(var l=o.length-1;l>=0;l--)M(o[l])}},P=function(){if(!c){c={boxTokens:[]},C=i.giveMoveManager({context:g}),y=o.getMoveReferentManager({context:g}),c.onAdd=n.onAdd(D),c.onRemove=n.onRemove(E),c.onEmpty=n.onEmpty(E),c.Move=C?C.subscribe("Move",(function(e){if(v){var t=[];e.objectsMoved.forEach((function(e){e.path&&t.push(e.path)})),t.length&&T(t,!1)}})):null,c.MoveEnd=C?C.subscribe("MoveEnd",(function(){if(v){for(var e=0;e<m.length;e++){for(var t=!0,n=0;n<p.length;n++)if(m[e].isEqual(p[n].getAssociatedPath())&&(t=!1,!p[n].getVisibleFlag())){var i=p[n].getAssociatedPath().getWorldMatrix(g.getViewer());p[n].setMatrix(i),p[n].setVisibleFlag(!0),g.getViewer().render()}t&&A(m[e])}m=[]}})):null,c.onRootRemoved=g.subscribe({event:"onRootRemoved"},(function(e){v&&T([e.path],!0)})),c.onRootDetached=g.subscribe({event:"onRootDetached"},(function(e){v&&T([e.path],!0)})),c.onHide=g.subscribe({event:"onHide"},(function(e){v&&T(e.paths,!0)})),c.onShow=g.subscribe({event:"onShow"},h.refreshBoxes),c.onEndMatriceUpdate=g.subscribe({event:"onEndMatriceUpdate"},h.refreshBoxes),c.swapVisibleSpace=g.getViewer()&&g.getViewer().onSwapVisibleSpace?g.getViewer().onSwapVisibleSpace(h.refreshBoxes):null,c.onPreferencesChanged=s.getPreferenceManager({context:g.getFrameWindow()}).subscribe("onPreferencesChanged",(function(e){if(e&&e.some((function(e){return"defaultMoveReferent"===e.id}))){for(var t=p.length-1;t>=0;t--)M(t);for(var i=n.get(),o=0;o<i.length;o++)u(i[o].pathElement)}}));var e=!1;c.VISU=r.subscribe({event:"/VISU/"},(function(t){var n;if(v&&p.length)if("@onViewpointBeginMove"===t.eventType)e=!0;else if("@onViewpointChange"===t.eventType){if(e){for(n=0;n<p.length;n++)p[n].setVisibleFlag(!1);g.getViewer().render(),e=!1}}else if("@onViewpointEndMove"===t.eventType){for(n=0;n<p.length;n++)p[n].setVisibleFlag(!0);g.getViewer().render(),e=!1}}))}},I=function(){if(c){c.VISU&&r.unsubscribe(c.VISU),c.onShow&&g.unsubscribe(c.onShow),c.onHide&&g.unsubscribe(c.onHide),c.onRootDetached&&g.unsubscribe(c.onRootDetached),c.onRootRemoved&&g.unsubscribe(c.onRootRemoved),c.onEndMatriceUpdate&&g.unsubscribe(c.onEndMatriceUpdate),c.MoveEnd&&C&&C.unsubscribe(c.MoveEnd),c.Move&&C&&C.unsubscribe(c.Move),c.onAdd&&n.unsubscribe(c.onAdd),c.onRemove&&n.unsubscribe(c.onRemove),c.onEmpty&&n.unsubscribe(c.onEmpty),c.swapVisibleSpace&&g.getViewer()&&g.getViewer().unsubscribe(c.swapVisibleSpace),c.onPreferencesChanged&&s.getPreferenceManager({context:g.getFrameWindow()}).unsubscribe(c.onPreferencesChanged);for(var e=p.length-1;e>=0;e--)M(e);m=[],c=null}};this.setActiveState=function(e){if(v!==e&&(v=e,b))if(v){P(),f||(f=new t.LineBasicMaterial({color:16744990,opacity:1}));for(var i=n.get(),o=0;o<i.length;o++)u(i[o].pathElement)}else I(),f=null},this.displayBoxes=function(e){if(b!==e)if((b=e)&&v){P();for(var t=n.get(),i=0;i<t.length;i++)u(t[i].pathElement)}else I()},this.getDisplayState=function(){return b},this.clearController=function(){this.setActiveState(!1),this.displayBoxes(!1),p=c=m=g=C=y=x=h=null},this.refreshBoxes=function(){var e;if(b&&v){for(e=p.length-1;e>=0;e--)M(e);var t=n.get();for(e=0;e<t.length;e++)u(t[e].pathElement)}}}}),c=[];return e.singleton({init:function(){},getBoxController:function(e){var t;if(e&&e.context){for(var n=0;n<c.length;n++)if(c[n].context===e.context){t=c[n].boxController;break}if(!t){var i=new l({ctxViewer:e.context});c.push({context:e.context,boxController:i}),t=i}}return t},unregisterBoxController:function(e){if(e&&e.context)for(var t=0;t<c.length;t++)if(c[t].context===e.context){c[t].boxController.clearController(),c.splice(t,1);break}}})})),define("DS/CATW3DBoxes/CATW3DBoxManipulator",["UWA/Class","DS/Visualization/ThreeJS_DS","DS/Visualization/Node3D","DS/CoreEvents/ModelEvents","DS/Mesh/MeshUtils","DS/Visualization/SceneGraphFactory","DS/Manipulators/Manipulator","DS/CATW3DAnims/CATW3DAnimation","DS/SceneGraphOverrides/SceneGraphOverrideSet"],(function(e,t,n,i,o,r,a,s,l){"use strict";var c=a.extend({init:function(e){var t=e||{};this._parent(t),this._manipulation=0,this.setExclusive(!0)},PrimaryPointerClick:function(e,t,n){this._parent(e,t,n);var i={element:e,event:t,intersection:n};this.publish("BoxClick",i)},BeginManipulate:function(e,t,n){this._parent(e,t,n),this._manipulation=0},Manipulate:function(e,t,n){if(this._parent(e,t,n),this._manipulation++,3===this._manipulation){var i={element:e,event:t,intersection:n};this.publish("BoxBeginManipulate",i)}},EndManipulate:function(e,t,n){if(this._parent(e,t,n),this._manipulation>3){var i={element:e,event:t,intersection:n};this.publish("BoxEndManipulate",i)}},BeginPreactivate:function(e,t,n){this._parent(e,t,n);var i={element:e,event:t,intersection:n};this.publish("BoxBeginPreactivate",i)},EndPreactivate:function(e,t,n){this._parent(e,t,n);var i={element:e,event:t,intersection:n};this.publish("BoxEndPreactivate",i)}});return e.extend({init:function(e){var a=e||{};this._parent(a);var d=a.fstAxis,u=d.length(),f=a.sndAxis,h=f.length(),p=a.thdAxis,m=p.length(),g=a.cornerPoint,v=a.pathElement,b=a.matrix||new t.Matrix4,x=a.rootBagPath,C=a.viewer,y=new n;y.name="boxManipulatorNode",y.setNoZ(!0),y.setVisibilityInTree(!1),y.setVisibility(Boolean(C.getVisibleSpace())),y.side=t.DoubleSide,y.exludeFromBounding(!0),y._getExcludeFromCSO=function(){return!0};var w=new n;w.name="lineicPreviewRepsBag",w.setPickable(o.PICKTHROUGH);var V=new n;V.name="boxPreviewNodeBag",V.setPickable(o.PICKTHROUGH);var S=null,B=new i,A=!1,D=16744448,T=new t.MeshBasicMaterial({side:t.DoubleSide,color:16744448,transparent:!0}),M=a.edgeMaterial,E=!1,P=null,I=null,W=null,k=new o.VertexComponent;k.component=o.VertexComponentEnum.POSITION,k.nbVertices=2,k.nbValuesPerVertex=3,k.format=o.DataTypeEnum.FLOAT,k.cardinality=0,k.bufferId=0,k.indices=new o.IndexArray,k.indices.format=o.DataTypeEnum.UINT,k.indices.bufferId=1,k.indices.offset=0;var F=new o.Buffer;F.indexBuffer=!0,F.size=2,F.format=o.DataTypeEnum.UINT,F.dimension=1,F.data=new Uint16Array(2),F.data[0]=0,F.data[1]=1;var O=new o.FillAttributes,R=new o.LineAttributes,U=new o.PointAttributes,N=null,_=null,z=null,L=null,H=null,G=function(e,t){if(e){e.material&&(e.material.map&&t&&e.material.map.dispose(),e.material.dispose());for(var n=e.children.length-1;n>=0;n--)G(e.children[n]);e.removeChildren()}},q=function(e){if(!P&&x){P=new l(x.externalPath[0]),C.getSceneGraphOverrideSetManager().pushSceneGraphOverrideSet(P);var t=P.createOverride(v);t.setColor(D,!0),e&&(t.setOpacity(1,!0),(t=P.createOverride(x)).setColor("white",!1),t.setOpacity(.1,!1))}},X=function(){P&&(C.getSceneGraphOverrideSetManager().removeSceneGraphOverrideSet(P),P=null)},J=function(e,n){var i=new o.PrimitiveGroup;i.fillAttr=O,i.lineAttr=R,i.pointAttr=U,i.noz=!1;var a=new o.Buffer;a.size=6,a.component=o.VertexComponentEnum.POSITION,a.format=o.DataTypeEnum.FLOAT,a.dimension=3,a.data=new Float32Array(6),i.addBuffer(0,a),i.addBuffer(1,F);var s=a.data,l=0;s[l++]=e.x,s[l++]=e.y,s[l++]=e.z;var c=(new t.Vector3).copy(e).add(n);s[l++]=c.x,s[l++]=c.y,s[l++]=c.z;var d=new o.Primitive;d.nbIndices=2,d.connectivity=o.ConnectivityTypeEnum.LINE_STRIP,d.attr={fill:O,line:R,point:U},d.material=M,d.addVertexComponent(k),i.addPrimitive(d);var u=r.createMeshNode(i);return u.setSSAO(!1),u.setShadow(!1,!1),u.excludeFromCSO(!0),u.excludeFromHighlight(!0,!0),u},K=function(e,n,i,a){var s=new o.PrimitiveGroup;s.noz=!1,s.fillAttr=O,s.lineAttr=R,s.pointAttr=U;var l=new o.Buffer;l.size=12,l.component=o.VertexComponentEnum.POSITION,l.format=o.DataTypeEnum.FLOAT,l.dimension=3,l.data=new Float32Array(12),z||((z=new o.Buffer).indexBuffer=!0,z.size=4,z.format=o.DataTypeEnum.UINT,z.dimension=1,z.data=new Uint16Array(4),z.data[0]=0,z.data[1]=1,z.data[2]=3,z.data[3]=2),L||((L=new o.Buffer).size=3,L.component=o.VertexComponentEnum.NORMAL,L.format=o.DataTypeEnum.FLOAT,L.dimension=3,L.data=new Float32Array(3),L.data[0]=0,L.data[1]=0,L.data[2]=1),H||((H=new o.Buffer).indexBuffer=!0,H.size=4,H.format=o.DataTypeEnum.UINT,H.dimension=1,H.data=new Uint16Array(4),H.data[0]=0,H.data[1]=0,H.data[2]=0,H.data[3]=0),s.addBuffer(0,l),s.addBuffer(1,z),s.addBuffer(2,L),s.addBuffer(3,H);var c=l.data,d=0;c[d++]=e.x,c[d++]=e.y,c[d++]=e.z;var u=(new t.Vector3).copy(e).add(n);c[d++]=u.x,c[d++]=u.y,c[d++]=u.z,u=(new t.Vector3).copy(e).add(n).add(i),c[d++]=u.x,c[d++]=u.y,c[d++]=u.z,u=(new t.Vector3).copy(e).add(i),c[d++]=u.x,c[d++]=u.y,c[d++]=u.z;var f=new o.Primitive;f.nbIndices=4,f.connectivity=o.ConnectivityTypeEnum.TRIANGLE_STRIP,T.opacity=a/10,T.needsUpdate=!0,f.material=T,N||((N=new o.VertexComponent).component=o.VertexComponentEnum.POSITION,N.nbVertices=4,N.nbValuesPerVertex=3,N.format=o.DataTypeEnum.FLOAT,N.cardinality=0,N.bufferId=0,N.indices=new o.IndexArray,N.indices.format=o.DataTypeEnum.UINT,N.indices.bufferId=1,N.indices.offset=0),_||((_=new o.VertexComponent).component=o.VertexComponentEnum.NORMAL,_.nbVertices=4,_.nbValuesPerVertex=3,_.format=o.DataTypeEnum.FLOAT,_.cardinality=0,_.bufferId=2,_.indices=new o.IndexArray,_.indices.format=o.DataTypeEnum.UINT,_.indices.bufferId=3,_.indices.offset=0),f.addVertexComponent(N),f.addVertexComponent(_),s.addPrimitive(f);var h=r.createMeshNode(s);return h.setSSAO(!1),h.setShadow(!1,!1),h.excludeFromCSO(!0),h.excludeFromHighlight(!0,!0),h},j=function(e,n){for(var i=0;i<6;i++){var o,r,a,s,l,c,v;switch(i){case 0:o=g,r=f,a=d,s=h,l=u;break;case 1:o=g,r=p,a=f,s=m,l=h;break;case 2:o=g,r=d,a=p,s=u,l=m;break;case 3:o=(new t.Vector3).copy(g).add(d),r=f,a=p,s=h,l=m;break;case 4:o=(new t.Vector3).copy(g).add(f),r=p,a=d,s=m,l=u;break;default:o=(new t.Vector3).copy(g).add(p),r=d,a=f,s=u,l=h}if(s>=.001&&l>=.001)if(1!==n){var b=.5*n;v=(new t.Vector3).copy(o);var x=(new t.Vector3).copy(r).setLength(s*b);c=J(v,x),e.addChild(c),v=(new t.Vector3).copy(o).add(r),x=(new t.Vector3).copy(a).setLength(l*b),c=J(v,x),e.addChild(c),v=(new t.Vector3).copy(o).add(r).add(a),x=(new t.Vector3).copy(r).setLength(s*b).multiplyScalar(-1),c=J(v,x),e.addChild(c),v=(new t.Vector3).copy(o).add(a),x=(new t.Vector3).copy(a).setLength(l*b).multiplyScalar(-1),c=J(v,x),e.addChild(c)}else c=J(o,r),e.addChild(c),v=(new t.Vector3).copy(o).add(r),c=J(v,a),e.addChild(c)}},Z=function(e){T.opacity=Math.round(e/12)/100,T.needsUpdate=!0;for(var t=e/(100/(w.children.length-1)),n=0;n<w.children.length;n++)n===t?(w.children[n].setVisibility(Boolean(C.getVisibleSpace())),w.children[n].setVisibilityFree(!1)):(w.children[n].setVisibility(!1),w.children[n].setVisibilityFree(!0));C.render()},Q=function(){for(var e=.5,i=null,o=0;o<6;o++)(i=new n).setVisibility(!1),i.setVisibilityFree(!0),j(i,e),w.addChild(i),e=Math.round(10*e+1)/10;y.addChild(w),function(e,n){if(e)for(var i=0;i<6;i++){var o=null,r=null,a=null;switch(i){case 0:o=g,r=f,a=d;break;case 1:o=g,r=p,a=f;break;case 2:o=g,r=d,a=p;break;case 3:o=(new t.Vector3).copy(g).add(d),r=f,a=p;break;case 4:o=(new t.Vector3).copy(g).add(f),r=p,a=d;break;default:o=(new t.Vector3).copy(g).add(p),r=d,a=f}e.addChild(K(o,r,a,n))}}(V,D),y.addChild(V)},Y=function(e){var t={pathElement:v,position:e.event.from[0].currentPosition};B.publish({event:"onBoxClick",data:t})},$=function(){E=!0,A=!1,q(!0),I.animate(1),C.currentViewpoint.getControl()._changeState(3),(W={}).eyePosition=C.currentViewpoint.getEyePosition(),W.upDirection=C.currentViewpoint.getUpDirection(),W.sightDirection=C.currentViewpoint.getSightDirection(),W.distanceToTarget=C.currentViewpoint.getTargetDistance(),B.publish({event:"onBoxBeginManipulate",data:{pathElement:v}})},ee=function(){X(),C.setCursor("auto"),E=!1,I.animate(0),C.currentViewpoint.moveTo({eyePosition:W.eyePosition,upDirection:W.upDirection,sightDirection:W.sightDirection,distanceToTarget:W.distanceToTarget,duration:100}),W=null,B.publish({event:"onBoxEndManipulate",data:{pathElement:v}})},te=function(){E||(C.setCursor("pointer"),A=!0,q(!1),I.animate(1))},ne=function(){E||(C.setCursor("auto"),A=!1,X(),I.animate(0))};this.show=function(){j(y,.5),C.addNode(y,!1),I=new s({animationTime:5,nbSteps:5,onBeforeFirstAnimation:Q,onAnimation:Z,onAnimationEnd:function(){Z(E||A?100:0)}}),S||((S=new c).subscribe("BoxClick",Y),S.subscribe("BoxBeginManipulate",$),S.subscribe("BoxEndManipulate",ee),S.subscribe("BoxBeginPreactivate",te),S.subscribe("BoxEndPreactivate",ne),S.linkToNode(y)),y.setMatrix(b),C.render()},this.hide=function(){X(),y.setVisibility(!1),y.setVisibilityFree(!0),S=null,G(y,!0),C.removeNode(y)},this.setMatrix=function(e){b.copy(e),y.setMatrix(b)},this.setVisibleFlag=function(e){!e&&E||(e?(y.setVisibility(Boolean(C.getVisibleSpace())),y.setVisibilityFree(!1)):(y.setVisibility(!1),y.setVisibilityFree(!0)))},this.getVisibleFlag=function(){return!!y&&!y.visibilityFree},this.getAssociatedPath=function(){return v},this.subscribe=function(e,t){return"onBoxClick"===e||"onBoxBeginManipulate"===e||"onBoxEndManipulate"===e?B.subscribe({event:e},t):void 0},this.unsubscribe=function(e){B.unsubscribe(e)}}})})),define("DS/CATW3DBoxes/CATW3DBoxesCmd",["DS/CATWebUXComponents/DMUCommandCheckHeader","DS/CATW3DBoxes/CATW3DBoxController","DS/PADUtils/PADContext"],(function(e,t,n){"use strict";var i=null,o=e.extend({init:function(e){this._parent(e,{});var n=this,r=this.onStateChange((function(){n.getState()?o.DisplayBoxes():o.HideBoxes()})),a=this._destroy;this._destroy=function(){i&&t.unregisterBoxController({context:i}),n._modelEvents.unsubscribe(r),a.call(n)};var s=localStorage.getItem("CATW3DBoxesCmd");s="false"!==s,this.setState(s,!0)},_destroy:function(){this._parent()}});return o.DisplayBoxes=function(e,o){!i&&o?i=o.executionContext.getComponent("Viewer"):i||o||(i=n.get()),t.getBoxController({context:i}).displayBoxes(!0),localStorage.setItem("CATW3DBoxesCmd","true"),e&&e()},o.HideBoxes=function(e,o){!i&&o?i=o.executionContext.getComponent("Viewer"):i||o||(i=n.get()),t.getBoxController({context:i}).displayBoxes(!1),localStorage.setItem("CATW3DBoxesCmd","false"),e&&e()},o}));