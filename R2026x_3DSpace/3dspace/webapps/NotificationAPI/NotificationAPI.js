define("DS/NotificationAPI/NotificationAPI",["UWA/Class/View","i18n!DS/NotificationAPI/assets/nls/feed","css!DS/NotificationAPI/NotificationAPI.css"],(function(i,t){"use strict";var n=window.Notification||window.mozNotification||window.webkitNotification,o=i.extend({tagName:"span",className:"notificationAPICloseIcon fonticon fonticon-cancel"});return i.extend({tagName:"div",className:"notificationAPIContainer",init:function(i){this.forceHideCached=i&&i.forceHideCached||!1,this.forceHideCached&&i&&!i.forceHide?this.forceHide=window.localStorage.getItem("hidePermissionNotifMsg")||!1:this.forceHide=i&&i.forceHide||!1,this.displayIfBlocked=i&&i.displayIfBlocked||!1,this.cancelButton=i&&i.cancelButton||!1,this._parent()},setup:function(){window&&window.ds&&"MOBILE"==window.ds.env?UWA.log("Mobile app does not receive desktop notifications"):"Notification"in window?this.permission=n.permission:UWA.log("Browser does not support desktop notifications")},render:function(){return this.container.setContent([{tag:"div",class:"notificationAPIBannerIcon",html:[{tag:"div",class:"notificationAPICircle",html:[{tag:"span",class:"notificationAPINotifIcon fonticon fonticon-bell-off"},{tag:"span",class:"notificationAPINotifIcon fonticon fonticon-bell"}]}]},{tag:"div",class:"notificationAPIBannerBody",html:[{tag:"div",class:"notificationAPIBannerBodyText",html:[{tag:"p",class:"notificationAPIBannerTitle",text:t.permissionBannerTitle},{tag:"p",class:"notificationAPIBannerText",html:[{tag:"span",text:t.permissionBannerText}]}]}]}]),this.container.addEventListener("click",(i=>{this._requestPermission(),i.stopPropagation()})),this.cancelButton&&((new o).render().inject(this.container.getElement(".notificationAPIBannerBody")),this.container.getElement(".notificationAPICloseIcon").addEventListener("click",(i=>{this._toggleDisplay(!0),this.forceHideCached&&window.localStorage.setItem("hidePermissionNotifMsg","true"),i.stopPropagation()}))),this._toggleDisplay(this.forceHide),this},_toggleDisplay:function(i){this.permission&&"denied"==this.permission?this.displayIfBlocked?this.container.toggleClassName("notificationAPIContainerHidden",!1):this.container.toggleClassName("notificationAPIContainerHidden",!0):!this.permission||i||"default"!=this.permission?this.container.toggleClassName("notificationAPIContainerHidden",!0):this.container.toggleClassName("notificationAPIContainerHidden",!1)},_handlePermission:function(i){this.permission=i,"permission"in n||(n.permission=i),this._toggleDisplay(!1)},_requestPermission:function(){try{n.requestPermission().then((i=>this._handlePermission(i)))}catch(i){i instanceof TypeError?n.requestPermission((i=>{this._handlePermission(i)})):UWA.log(i)}}})}));