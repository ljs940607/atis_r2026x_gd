define("DS/IPClassifyUX/events/IPClassifyEvents",["UWA/Class","DS/CoreEvents/ModelEvents"],(function(e,t){return e.singleton({EVT_CURRENT_LIBRARY_CHANGE:"/LIBRARY_EDITOR/CURRENTLIBRARY_CHANGE",EVT_NODEMODEL_MODIFY:"/LIBRARY_EDITOR/NODEMODEL_MODIFY",EVT_LIBRARY_LOADINGSTART:"/LIBRARY_EDITOR/LIBRARY_LOADINGSTART",EVT_LIBRARY_LOADINGEND:"/LIBRARY_EDITOR/LIBRARY_LOADINGEND",EVT_CURRENT_LIBRARY_FILTER_CHANGE:"/LIBRARY_EDITOR/CURRENTLIBRARY_FILTER_CHANGE",EVT_CURRENT_LIBRARY_COLUMN_CHANGE:"/LIBRARY_EDITOR/CURRENT_LIBRARY_COLUMN_CHANGE",EVT_LIBRARY_TREELISTVIEW_SCROLL_END:"/LIBRARY_EDITOR/LIBRARY_TREELISTVIEW_SCROLL_END",EVT_LIBRARY_TAGGER_OPEN:"/LIBRARY_EDITOR/LIBRARY_TAGGER_OPEN",EVT_LIBRARY_TAGGER_CLOSE:"/LIBRARY_EDITOR/LIBRARY_TAGGER_CLOSE",EVT_LIBRARY_PAGETOOLBAR_EXPAND:"welcome-panel-expand",EVT_LIBRARY_PAGETOOLBAR_EXPANDED:"welcome-panel-expanded",EVT_LIBRARY_PAGETOOLBAR_COLLAPSE:"welcome-panel-collapse",EVT_LIBRARY_PAGETOOLBAR_COLLAPSED:"welcome-panel-collapsed",EVT_LIBRARY_PAGEINFO_EXPAND:"information-panel-open",EVT_LIBRARY_PAGEINFO_EXPANDED:"information-panel-visible",EVT_LIBRARY_PAGEINFO_COLLAPSE:"information-panel-close",EVT_LIBRARY_PAGEINFO_COLLAPSED:"information-panel-hidden",EVT_COLUMN_SORT_CHANGE:"/LIBRARY_EDITOR/COLUMN_SORT_CHANGE",EVT_REMOVENODE_CONTENT:"/LIBRARY_EDITOR/REMOVENODE_CONTENT",EVT_UPDATE_SEARCH_VISIBILITY:"/LIBRARY_EDITOR/UPDATE_SEARCH_VISIBILITY",EVT_EXPANDTREE_AND_SELECT:"/LIBRARY_EDITOR/EXPANDTREE_AND_SELECT",EVT_LIBRARYSELECT:"/LIBRARY_EDITOR/SELECT",EVT_ACTIVATE_TREE_ITEM:"/LIBRARY_EDITOR/ACTIVATE_TREE_ITEM",EVT_TREE_SORT_CHANGE:"/LIBRARY_EDITOR/TREE_SORT_CHANGE",EVT_CONTENT_SEARCH_RESULT:"/LIBRARY_EDITOR/CONTENT_SEARCH_RESULT",EVT_CONTENT_SEARCH_CHANGE:"/LIBRARY_EDITOR/CONTENT_SEARCH_CHANGE",EVT_CONTENT_TAB_CHANGE:"/LIBRARY_EDITOR/CONTENT_TAB_CHANGE",EVT_FAVORITE_SECTION_EMPTY:"/LIBRARY_EDITOR/EVT_FAVORITE_SECTION_EMPTY",EVT_CONTENT_READY:"/LIBRARY_EDITOR/EVT_CONTENT_READY",EVT_SWITCH_MODE:"/LIBRARY_EDITOR/INDEX_DB_MODE_CHANGE",EVT_TAB_CHANGE:"/LIBRARY_EDITOR/TAB_CHANGE",_modelEvents:null,init:function(e){this._parent(e),this._modelEvents=new t},getModelEvents:function(){return this._modelEvents},notifyupdateRefreshTime:function(e){if(!UWA.is(e,"object"))throw new Error("input parameter should be object");this._modelEvents.publish({event:"REFRESH_TIME_UPDATED",data:e})},onUpdateRefreshTime:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:"REFRESH_TIME_UPDATED"},e)},notifyLibraryLoadingStart:function(e){if(!UWA.is(e))throw new Error("input parameter should be a TreeNodeModel");this._modelEvents.publish({event:this.EVT_LIBRARY_LOADINGSTART,context:e,data:e})},onLibraryLoadingStart:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_LOADINGSTART},e)},notifyLibraryLoadingEnd:function(e){if(!UWA.is(e))throw new Error("input parameter should be a TreeNodeModel");this._modelEvents.publish({event:this.EVT_LIBRARY_LOADINGEND,context:e,data:e})},onLibraryLoadingEnd:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_LOADINGEND},e)},notifyLibraryRename:function(e){if(!UWA.is(e,"object"))throw new Error("input parameter should be object");this._modelEvents.publish({event:this.EVT_NODEMODEL_MODIFY,context:e.oldNode,data:e})},onLibraryRename:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_NODEMODEL_MODIFY},e)},notifyRemoveNodeInContent:function(e){this._modelEvents.publish({event:this.EVT_REMOVENODE_CONTENT,data:e})},onRemoveNodeInContent:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_REMOVENODE_CONTENT},e)},notifyUpdateSearchVisibility:function(e){this._modelEvents.publish({event:this.EVT_UPDATE_SEARCH_VISIBILITY,data:e})},onUpdateSearchVisibility:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_UPDATE_SEARCH_VISIBILITY},e)},notifyExpandTreeAndSelect:function(e){this._modelEvents.publish({event:this.EVT_EXPANDTREE_AND_SELECT,data:e})},onExpandTreeAndSelect:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_EXPANDTREE_AND_SELECT},e)},notifyLibrarySelected:function(e){this._modelEvents.publish({event:this.EVT_LIBRARYSELECT,data:e})},onLibrarySelected:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARYSELECT},e)},notifyActivateTreeItem:function(e){this._modelEvents.publish({event:this.EVT_ACTIVATE_TREE_ITEM,data:e})},onActivateTreeItem:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_ACTIVATE_TREE_ITEM},e)},notifyTreeSortChange:function(e){this._modelEvents.publish({event:this.EVT_TREE_SORT_CHANGE,data:e})},onTreeSortChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_TREE_SORT_CHANGE},e)},notifyContentSearchResult:function(e){this._modelEvents.publish({event:this.EVT_CONTENT_SEARCH_RESULT,data:e})},onContentSearchResult:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CONTENT_SEARCH_RESULT},e)},notifyContentSearchChange:function(){this._modelEvents.publish({event:this.EVT_CONTENT_SEARCH_CHANGE})},onContentSearchChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CONTENT_SEARCH_CHANGE},e)},onEmptySearchQuery:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:"EmptySearchQuery"},e)},notifyOnEmptySearchQuery:function(){this._modelEvents.publish({event:"EmptySearchQuery"})},onAttributesTabSearchQuery:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:"searchValueSetAttributesTab"},e)},notifyOnAttributesTabSearchQuery:function(e){this._modelEvents.publish({event:"searchValueSetAttributesTab",data:e})},notifyContentTabChange:function(){this._modelEvents.publish({event:this.EVT_CONTENT_TAB_CHANGE})},onContentTabChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CONTENT_TAB_CHANGE},e)},notifyCurrentLibraryChange:function(e){if(!UWA.is(e,"object"))throw new Error("input parameter should be object");if(!e.currentNode)throw new Error("input object should have currentNode");this._modelEvents.publish({event:this.EVT_CURRENT_LIBRARY_CHANGE,context:e.currentNode,data:e})},onCurrentLibraryChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CURRENT_LIBRARY_CHANGE},e)},notifyCurrentLibraryFilterChange:function(){this._modelEvents.publish({event:this.EVT_CURRENT_LIBRARY_FILTER_CHANGE})},onCurrentLibraryFilterChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CURRENT_LIBRARY_FILTER_CHANGE},e)},notifyCurrentLibraryColumnChange:function(){this._modelEvents.publish({event:this.EVT_CURRENT_LIBRARY_COLUMN_CHANGE})},onCurrentLibraryColumnChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CURRENT_LIBRARY_COLUMN_CHANGE},e)},notifyColumnSortChange:function(){this._modelEvents.publish({event:this.EVT_COLUMN_SORT_CHANGE})},onColumnSortChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_COLUMN_SORT_CHANGE},e)},notifyScrollEnd:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_TREELISTVIEW_SCROLL_END})},onScrollEnd:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_TREELISTVIEW_SCROLL_END},e)},notifyTaggerOpen:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_TAGGER_OPEN})},onTaggerOpen:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_TAGGER_OPEN},e)},notifyTaggerClose:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_TAGGER_CLOSE})},onTaggerClose:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_TAGGER_CLOSE},e)},notifyPageToolBarExpand:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGETOOLBAR_EXPAND})},onPageToolBarExpand:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_PAGETOOLBAR_EXPAND},e)},notifyPageToolBarExpanded:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGETOOLBAR_EXPANDED})},onPageToolBarCollapse:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_PAGETOOLBAR_COLLAPSE},e)},notifyPageToolBarCollapse:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGETOOLBAR_COLLAPSED})},notifyInfoExpand:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGEINFO_EXPAND})},onInfoExpand:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_PAGEINFO_EXPAND},e)},notifyInfoExpanded:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGEINFO_EXPANDED})},notifyInfoCollapse:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGEINFO_COLLAPSE})},onInfoCollapse:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_PAGEINFO_COLLAPSE},e)},notifyInfoCollapsed:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGEINFO_COLLAPSED})},notifyContentReady:function(){this._modelEvents.publish({event:this.EVT_CONTENT_READY})},onContentReady:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CONTENT_READY},e)},notifyFavoriteSectionEmpty:function(){this._modelEvents.publish({event:this.EVT_FAVORITE_SECTION_EMPTY})},onFavoriteSectionEmpty:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_FAVORITE_SECTION_EMPTY},e)},notifyModeChange:function(e){if(!UWA.is(e,"object"))throw new Error("input parameter should be object");this._modelEvents.publish({event:this.EVT_SWITCH_MODE,data:e})},onModeChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_SWITCH_MODE},e)},notifyTabChange:function(e){this._modelEvents.publish({event:this.EVT_TAB_CHANGE})},onTabChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_TAB_CHANGE},e)},unsubscribeAll:function(){this._modelEvents.unsubscribeAll()}})})),define("DS/IPClassifyUX/views/additionalData/ThumbnailAttribute",["UWA/Class","DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassifyUtil/IPClassifyUtility"],(function(e,t,i){"use strict";var n=function(){return"thumbnail"};return e.singleton({init:function(e){this.alwaysUpdate=!0,this._parent(e)},setCheckToShowThumbnail:function(e){this._toShowThumbnailCheck=e},getName:n,getManagedColumnNames:()=>["thumbnail","isThumbnailSet"],toBeUpdated:function(e,t){if(i.isIndexedMode())return!1;if(this._toShowThumbnailCheck){if(!this._toShowThumbnailCheck(this.getName()))return!1}return!e.isThumbnailSet},updateAttributes:function(e,i){t.loadThumbnails({ids:e.pids,onComplete:e=>{if(e){var t=e.results,n={};t&&(t.forEach((function(e){var t=e.attributes,i=null,r=null;t.every((function(e){if("preview_url"===e.name){if(r=(r=e.value).indexOf("snresources")<0?r:null,i||!r)return!1}else if("resourceid"===e.name&&(i=e.value,r))return!1;return!0})),n[i]={isThumbnailSet:!0},i&&r&&(n[i]={thumbnail:"url("+r+")",isThumbnailSet:!0,_root:{thumbnail:r}})})),i({pids:n}))}},onFailure:function(){i({}),console.log("Failure during thumbnail retrieval")}})}})})),define("DS/IPClassifyUX/facets/AttachmentsFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/IPClassifyUtil/IPClassifyAlert","DS/EditPropWidget/facets/Common/FacetsBase","DS/ENOXAttachmentsUX/AttachmentsPane","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],(function(e,t,i,n,r,o,a){return t.extend(i,r,{init:function(e){this._parent(e),this.componentRefresh=!1,this.buildView(e)},buildView:function(t){var i=this;this.elements.container=e.createElement("div",{class:"attachments"}),this.multiselDisplay=e.createElement("div",{class:"notSupported"}).inject(this.elements.container),this.iconHolder=e.createElement("span",{class:"blockIcon"}).inject(this.multiselDisplay),this.infoMsgH2Tag=e.createElement("h2",{class:"information_msg"}).inject(this.multiselDisplay),this.multiselDisplay.hide();var r={parentObject:{parentId:t.appContext.getDocumentId()},connectorOptions:{fetchSecurityContext:function(){return t.appContext.options.securityContext},platformUrls:t.appContext.options.platformUrls},readonly:t.appContext.readonly};i.attachmentsPane=new o(r),i.attachmentsPane.inject(i.elements.container),i.attachmentsPane.modelEvents.subscribe({event:"context-menu-requested"},(function(e){var t;if(e.contextMenu.items.forEach((function(e){e.name&&e.name.startsWith("open-with")&&(t=e)})),t){var i=[];e.contextMenu.items.forEach((function(e){e.parentItemId&&e.parentItemId==t.id&&i.push(e)})),i.length>0&&1==i.length&&"ENXWDOC_AP"==i[0].name&&e.contextMenu.removeItem([t.id,i[0].name])}})),i.attachmentsPane.modelEvents.subscribe({event:"user-selects-files-for-upload"},(function(e){t.appContext.isOwnerRole&&(e.cancelled=!0,n.displayNotification({message:a.UploadNewAttachmentActionFail,className:"error"}))})),i.multiselDisplay.isHidden()||i.attachmentsPane.hide()},updateFacet:function(){this.selectionModified(this.options.appContext.getDocumentId())},notApplicable:function(){this.infoMsgH2Tag.setText(this.options.appContext.i18nManager.get("notSupportedSelection")),this.iconHolder.addClassName("wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-block"),this.multiselDisplay.show(),this.attachmentsPane&&this.attachmentsPane.hide()},selectionModified:function(e){if(e){this.multiselDisplay.hide();var t={parentId:e};this.attachmentsPane&&this.attachmentsPane.getParentObject().parentId!==e&&(this.attachmentsPane.show(),this.attachmentsPane.setParentObject(t)),this.componentRefresh=!0}else this.notApplicable()},onResize:function(){},onRefresh:function(){}})})),define("DS/IPClassifyUX/views/IPClassifyWebInWinTaggerProxy",["DS/SNResultUX/webinwin/WebInWinTaggerProxy","UWA/Core","DS/CoreEvents/ModelEvents"],(function(e,t,i){"use strict";return e.extend(i,{init:function(e){e.proxyId=e.widgetId+"LibraryEditor_WebInWin",this._parent.call(this,e)},_dispatchEvent:function(e){if(!t.is(e,"object")||!t.is(e.notif_name)||void 0===e.notif_parameters)throw console.log("E_INVALIDARG, expect to have parameters.notif_name arg & parameters.notif_parameters in _dispathTowin !!!"),"No parameters.notif_name arg & parameters.notif_parameters given to _dispathTowin method !";console.log("ResultWebInWin._dispathTowin for "+e.notif_name);var i=t.is(e.notif_parameters,"string")?e.notif_parameters:JSON.stringify(e.notif_parameters);"undefined"!=typeof dscef&&dscef.sendString(e.notif_name+"="+i)}})})),define("DS/IPClassifyUX/service/LibraryDnDService",["UWA/Class","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/PADUtils/PADUtilsServices","DS/WidgetServices/WidgetServices","DS/IPClassifyUtil/IPClassifyCommunication","DS/IPClassifyUtil/IPClassifyUtility"],(function(e,t,i,n,r,o,a){return e.singleton({setDragData:function(e,t,i,n){if(r.isNatifEnvironnement()&&!r.isWebInWinEnvironment()){var a=i.getSelectedNodesID();o.publish("setDragData",{ids:a})}var s=i.getSelectedNodes(),l=i.getCurrentObject(),d="";l&&!l.isRoot()&&n.isValidType(l.plmType)&&(d=l.getID());var c={protocol:"3DXContent",version:"1.1",source:"LibraryEditor",widgetId:widget.id,data:{items:[]}},u=widget.getValue("x3dPlatformId");u||(u="OnPremise");var h=widget.getPreference("pad_security_ctx");h&&h.value&&(h=h.value.split("::")[1]);var g=[];s.forEach((function(e){var t={envId:u,serviceId:"3DSpace",contextId:h,objectId:e._options.physicalid,objectType:e._options.type,displayName:e._options.label,displayType:e._options.type,libraryId:d};g.push(t)})),c.data.items=g,e.dataTransfer&&e.dataTransfer.setData&&e.dataTransfer.setData("text/plain",JSON.stringify(c))},cleanDragData:function(){r.isNatifEnvironnement()&&!r.isWebInWinEnvironment()&&o.publish("cleanDragData")},shouldAcceptDrop:function(){return!1},performDropOnLibraryEditorNode:function(e,n,r){var o=null;try{o=this.retrieveDroppedDataFromDropEvent(n)}catch(e){o=null,t.displayNotification({message:i.msg_warning_dndnotsupported,className:"warning"})}o&&e&&this.processDroppedDataOnLibraryEditorNode(e,o,r,n)},retrieveDroppedDataFromDropEvent:function(e){for(var t,i=UWA.is(e.dataTransfer.types.indexOf,"function")?"indexOf":"contains",n="",r=["text/searchitems","text/plain","Text"],o=0;o<r.length&&""===n;o++){var a=e.dataTransfer.types[i](r[o]);(UWA.is(a,"number")&&a>=0||UWA.is(a,"boolean")&&!0===a)&&(n=r[o])}if(""===n)throw new Error("Unknown type in DnD");return t=e.dataTransfer.getData(n),JSON.parse(t)},processDroppedDataOnLibraryEditorNode:function(e,r,o,a){function s(e){if(Array.isArray(e)&&e.length>0)for(var t=n.getPlatformId(),i=e.length-1;i>=0;i--){var r=e[i];if(r&&r.droppedItem_tenantId!==t)return!1}return!0}if(r&&e){var l=this.isExternalDroppedDataOnLibraryEditor(r),d=o.getDroppedData(r),c=d.RootLibrary_itemList,u=d.Library_itemList,h=d.Content_itemList;if(!s(c)||!s(u)||!s(h))return void t.displayNotification({message:i.msg_warning_dndnotsupported_from_different_tenant,className:"warning"});if(o.inFamilyLibrary(e.plmType)){if(Array.isArray(u)&&u.length>0)for(;u.length>0&&u[0];){for(var g=u[0].droppedSourceLibrary_id,f=[],p=u.length-1;p>=0;p--){(m=u[p])?m.droppedSourceLibrary_id===g&&(f.push(m.droppedItem_id),u.splice(p,1)):u.splice(p,1)}o.addClassesInLibrary(e,g,f,l,!1)}if(Array.isArray(h)&&h.length>0)for(;h.length>0&&h[0];){g=h[0].droppedSourceLibrary_id,f=[];var _=UWA.clone(h);for(p=h.length-1;p>=0;p--){var m;(m=h[p])?m.droppedSourceLibrary_id===g&&(f.push(m.droppedItem_id),h.splice(p,1)):h.splice(p,1)}o.addContentInObject(e,g,f,l,_)}}}else console.warn("  LibraryDnDService processDroppedDataOnLibraryEditorNode invalid argument(s)")},isExternalDroppedDataOnLibraryEditor:function(e){var t=!0;return e&&e.widgetId&&e.widgetId==this.getWidgetId()&&(t=!1),t},getWidgetId:function(){return self.widget.id}})})),define("DS/IPClassifyUX/models/LibraryInfo",["UWA/Controls/Abstract","UWA/Class/Options"],(function(e,t){"use strict";var i=e.extend(t,{_id:null,_type:null,_label:null,init:function(e){this._parent(e),this._id=e.id,this._type=e.type,this._label=e.label,this._getChildrenInfos=e.getChildrenInfos},getID:function(){return this._id},getType:function(){return this._type},getLabel:function(){return this._label},getChildrenInfos:function(e){this._getChildrenInfos(this._id).then((function(t){var n=[];t.forEach((function(e){n.push(new i({id:e.getID(),type:e.plmType,label:e.getLabel()}))})),e.onComplete(n)}))}});return i})),define("DS/IPClassifyUX/utils/IPClassifyWidgetData",["UWA/Class","DS/IPClassifyUtil/IPClassifyPreference"],(function(e,t){"use strict";return e.singleton({init:function(e){this._widgetData={currentTab:0,showTreeView:!0,currentWidgetTab:0,isEditMode:!1,isReadOnly:!1,permission:"Specialist",isPermissionRestrictionEnabled:!1}},getWidgetData:function(){return this._widgetData},setCurrentTab:function(e){null==e?this._widgetData.currentTab=0:0==e?(t.set("lib_currentSubTab",{currentSubTab:e},!0,!1),this._widgetData.currentTab=0):(t.set("lib_currentSubTab",{currentSubTab:e},!0,!1),this._widgetData.currentTab=e)},getCurrentSubTab:function(){let e;return t.get("lib_currentSubTab",(function(t){e=t&&t.hasOwnProperty("currentSubTab")?t.currentSubTab:0}),!0),this._widgetData.currentTab=e,this._widgetData.currentTab},setReadOnly:function(e){this._widgetData.isReadOnly=e},setPermission:function(e){this._widgetData.permission=e},getPermission:function(){return this._widgetData.permission},setIsPermissionRestrictionEnabled:function(e){this._widgetData.isPermissionRestrictionEnabled=e},getIsPermissionRestrictionEnabled:function(){return this._widgetData.isPermissionRestrictionEnabled},getCurrentWidgetTab:function(){return this._widgetData.currentWidgetTab},setCurrentWidgetTab:function(e,t){e?(this._widgetData.currentWidgetTab=e,this._widgetData.showTreeView=t):(this._widgetData.currentWidgetTab=0,this._widgetData.showTreeView=t)},getIsEditModeEnabled:function(){return this._widgetData.isEditMode},setIsEditModeEnabled:function(e){this._widgetData.isEditMode=e}})})),define("DS/IPClassifyUX/utils/LoadCssUtil",["UWA/Class"],(function(e){"use strict";return e.singleton({init:function(e){},_loadCSS:function(e){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.head.appendChild(t)}})})),define("DS/IPClassifyUX/service/SettingsManagement",["UWA/Class"],(function(e){"use strict";return e.singleton({init:function(){this.isPlatformInitialized=!0},addSetting:function(e,t){if(!this.isPlatformInitialized)throw new Error("Platformservices not initialized");widget[e]&&console.log("Setting is already in use"),widget[e]=t},getSetting:function(e){return widget[e]||""},getPlatformURLs:function(){return this.getSetting("platformServices")}})})),define("DS/IPClassifyUX/views/LibraryThumbnailGridView",["DS/IPClassifyNav/views/xNavResponsiveThumbnailsView","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],(function(e,t,i){"use strict";return e.extend({init:function(e){this._parent(e),this.options.grid.infiniteScrolling=!0;var i=this;UWA.is(this.options.grid.onCellDoubleClick,"function")&&this.options.grid.onCellDoubleClick((function(e){var i=e.nodeModel;t.notifyActivateTreeItem({resourceid:i.options.resourceid,mxid:i.options.mxid,type:i.options.type,label:i.options.label})})),this.options.grid.onInfiniteScroll((function(e){e.reachBottom?t.notifyScrollEnd():e.reachRight&&i.options.grid.infiniteScrollProcessDone()})),this.options.grid.getCustomTooltip=e=>{let t=["ds6w:label","ds6wg:revision","ds6w:type","ds6w:status","ds6w:description","ds6w:responsible","ds6w:modified","ds6w:created","ds6w:identifier"],i=this.options.dataprovider.getAdditionalTooltipAttribute?this.options.dataprovider.getAdditionalTooltipAttribute():null,n="";if(i)for(let e of i)t.splice(e.order-1,0,e.label);for(let i of t)n+=this.showTooltip(i,e);return n}},showTooltip:(e,t)=>t.options.grid[e]?i.ViewTooltip[e]+":"+t.options.grid[e]+"\n":"",showTooltipDate:(e,t)=>{if(t.options.grid[e]){let r=new Date(Date.parse(t.options.grid[e])),o=r.toLocaleTimeString().replace(/([\d]+:[\d]{2})(:[\d]{2})(.*)/,"$1$3");var n=r.toLocaleString("default",{month:"short"})+" "+r.getUTCDate()+","+r.getUTCFullYear()+", "+o;return i.ViewTooltip[e]+":"+n+"\n"}return""},getSortingOrder:e=>{var t={};if(e&&e.getSortByCommandData){var i=e.getSortByCommandData();return t.order_by=i.sortOrder,t.order_field=i.sortField,t}return t}})})),define("DS/IPClassifyUX/views/LibraryDataGridView",["DS/IPClassifyNav/views/xNavDataGridView","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewLayout","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/IPContext","DS/PADUtils/Configuration","DS/PADServices/utils/GlobalUtils","DS/PADUtils/PADCommandProxy","DS/PADServices/utils/AttributesMgtV2","DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUtil/IPClassifyPreference","UWA/Controls/Abstract","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/Core/PointerEvents","DS/ApplicationFrame/CommandsManager"],(function(e,t,i,n,r,o,a,s,l,d,c,u,h,g,f,p){"use strict";var _="ipcGridViewID_v1",m=h.extend({name:"LibraryDataGridView",init:function(e){this._parent(e),this.onContextualMenuReady=e.context.onContextualMenuReady,this.gridPlaceHolder=e.context.getPlaceHolder(),this.dataProvider=e.context.dataProvider},initialize:function(){var e=this;return new Promise((function(r){var s=UWA.clone(a.getConfig("dgvOptions"));e.options.viewMode=s.viewMode,e.options.clickEvent=null;var d=e.fetchGridViewID(),u=[e.buildDGVOpts(),d];Promise.all(u).then((function(a){var d=a[0],u=a[1],h=UWA.extend({identifier:"DataGridView-"+e.name+"-"+u},d);if("undefined"!==s.dgvLayout){var g=UWA.clone(s.dgvLayout);void 0!==d.defaultCellHeight&&(g.cellHeight=d.defaultCellHeight,delete d.defaultCellHeight),void 0!==d.rowsHeader&&(g.rowsHeader=d.rowsHeader,delete d.rowsHeader),h.layout=e.options.dgvLayout=new i(g),h.layout.useLastColumnWidthAutoFlag=!0}h.onContextualEvent=e.onContextualMenuReady,h.getCellTooltip=e._provideDisplayTooltip.bind(e),h.columnDragEnabledFlag=!1,h.placeholder=e.gridPlaceHolder,h.defaultColumnDef.allowUnsafeHTMLContent=!1,e.options.dataGridPlaceHolder=h.placeholder,e.options.viewMode=d.viewMode?d.viewMode:"comfortable",h.showModelChangesFlag=!(!s.dgv||!s.dgv.showModelChangesFlag)&&s.dgv.showModelChangesFlag,h&&!0===h.isAttributesTab||(h.showContextualMenuColumnFlag=!0),h.rowDragEnabledFlag=!0,h.rowReorderEnabledFlag=!0,h.cellDragEnabledFlag=!0,h.selectionMode="row";var _=e.options.dgv=new t(h);if(e.options.additionalColumnsModules)for(var m=0;m<e.options.additionalColumnsModules.length;m++)if(e.options.additionalColumnsModules[m].getTypeRepresentations){var b=e.options.additionalColumnsModules[m].getTypeRepresentations();_.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(b))}if(["ctrl+a","alt+return","ctrl+f","f2"].forEach((function(e){_._keymapManager.registerKeymap(e,void 0)})),_.addEventListener(f.POINTERHIT,(function(t,i){if(1===t.multipleHitCount){var r;let t=o.get()?o.get().toString():void 0;var a=e.getManager();if(i&&_.getColumnOrGroup(i.columnID)&&_.getColumnOrGroup(i.columnID).dataIndex&&i.nodeModel){if("ds6w:status"===_.getColumnOrGroup(i.columnID).dataIndex)r=p.getCommand("MaturityState",t)||p.getCommand("MaturityHdr",t);r&&r.begin()}}if(2===t.multipleHitCount){var s=_.layout.getColumnIndex("tree");if(i&&i.columnID==s&&i.nodeModel&&i.nodeModel.isFavorite){var l=_.layout.getCellsFromNodeModel(i.nodeModel)[s],d=_.getEditionManager(l);d.onEscape&&d.onEscape(l)}if(i&&i.nodeModel){var c=i.nodeModel;n.notifyActivateTreeItem({resourceid:c.options.physicalid,mxid:c.options.mxid,type:c.plmType,label:c.options.label})}if(e.dataProvider.launchCommandOnDoubleClick)if((a=e.getManager())&&a._preselectedCellStableID&&a._preselectedCellStableID.columnDataIndex){var u=a._preselectedCellStableID.columnDataIndex;e.dataProvider.launchCommandOnDoubleClick(u)}}})),_._modelEvents.subscribe({event:"READY"},(function(){n.notifyContentReady(),e.setSortingForComputedAttrs()})),_.addEventListener("sortModelChange",(function(){n.notifyColumnSortChange()})),_.onDelayedModelDataRequest){var v=_.onDelayedModelDataRequest;_.onDelayedModelDataRequest=function(t){e.dataProvider.updateAttributesDelayedForUnits&&e.dataProvider.updateAttributesDelayedForUnits(t,e.getManager()),v(t)}}_.onInfiniteScroll((function(e){e.reachBottom?n.notifyScrollEnd():e.reachRight&&_.infiniteScrollProcessDone()})),e._commandProxy=l.create(),_.getContent().addClassName(e.name),e.options.renderTo&&!0===e.options.isActiveView&&_.inject(e.options.renderTo),c.getModelEvents().subscribe({event:"IPClassifyColumnCusto/AttributesCustomization/columnModification"},(function(t){switch(t.what){case"addRemoveColumns":t.removedColumns&&e.removeColumn(t.removedColumns),t.addedColumns&&e.addColumn(UWA.clone(t.addedColumns));break;case"reset":e.resetColumn()}})),r()}))}))},fetchGridViewID:function(){return new Promise((function(e){widget&&widget.id?e(widget.id):u.get(_,(function(t){if(t&&t.GridViewID)e(t.GridViewID);else{var i=s.uid();u.set(_,{GridViewID:i},!1),e(i)}}),!1)}))},_provideDisplayTooltip:function(e){if(e&&e.rowID<0&&this.dataProvider.getTooltipIfDynamicColumn){var t=this.options.dgv.getColumnOrGroup(e.columnID),i=this.dataProvider.getTooltipIfDynamicColumn(e,t);if(i)return{longHelp:i}}return this.options.dgv.getCellDefaultTooltip(e)},getManager:function(){return this.options.dgv},addColumn:function(e){this.dataProvider.onAddColumn&&this.dataProvider.onAddColumn(e),n.notifyCurrentLibraryColumnChange()},removeColumn:function(e){this.dataProvider.onRemoveColumn&&this.dataProvider.onRemoveColumn(e)},resetColumn:function(e){this.dataProvider.onResetColumn&&this.dataProvider.onResetColumn(d.getAvailableColumnsOpts(),d.getTreeColumn()),n.notifyCurrentLibraryColumnChange()},getDefaultSortModel:function(){var e=this.getManager(),t=[];if(e)for(var i=e.layout.getLeafColumns(),n=0;n<i.length;++n){var r=i[n];r.defaultSortOrder&&(t=[{dataIndex:r.dataIndex,sort:r.defaultSortOrder}])}return t},getSortingOrder:function(e){var t={},i=this.getManager(),n=this.getDefaultSortModel(),r=null,o=null;if(n.length>0&&(r=n[0].dataIndex,o=n[0].sort),i){var a=i.sortModel,s=r,l=o;a&&a.length>0&&null!=a[0].dataIndex&&null!=a[0].dataIndex?(s=a[0].dataIndex,l=a[0].sort):this._setColumnOrderState(s,l),t.order_by=l;var d=i.layout.getLeafColumns()[i.layout.getColumnIndex(s)];d?d.isHidden?this._setColumnOrderState(r,o):(d.dataIndex&&(t.order_field=d.dataIndex,"tree"===d.dataIndex&&(t.order_field=d.ds6w)),e&&d.dbAttribute&&(t.order_field=d.dbAttribute)):r&&(this._setColumnOrderState(r,o),t.order_by=o,t.order_field=r)}return t},setSortingForComputedAttrs:function(){var e=r.isIndexedMode(),t=["tree","ds6w:description"],i=!!e;this.dataProvider&&this.dataProvider.isColumnSortableInAuthoring&&(i=this.dataProvider.isColumnSortableInAuthoring(i));for(var n=0;n<t.length;++n)this._setColumnSortable(t[n],i);var o,a=[];if(this.dataProvider.getAuthModeNoSortColumns&&(a=this.dataProvider.getAuthModeNoSortColumns(this.getManager().layout.getLeafColumns())),!1===e){var s=this.getSortingOrder(!0).order_field;if("ds6w:label"===(o=s)||"tree"===o||"ds6w:description"===o||-1!==a.indexOf(s)){var l=this.getDefaultSortModel();l.length>0&&this._setColumnOrderState(l[0].dataIndex,l[0].sort)}}var d=this,c=["thumbnail"];a.forEach((function(e){c&&-1!==c.indexOf(e)||d._setColumnSortable(e,i)}))},_setColumnSortable:function(e,t){var i=this.getManager(),n=i.layout.getColumnIndex(e);if(!(n<0||null==n)){var r=i.layout.getLeafColumns();r[n].sortableFlag!==t&&(r[n].sortableFlag=t)}},setTreeColumnEditable:function(e){var t=this.getManager(),i=t.layout.getColumnIndex("tree");if(!(i<0)){var n=t.layout.getLeafColumns();n[i].editableFlag!==e&&(n[i].editableFlag=e)}},_setColumnOrderState:function(e,t){var i=this.getManager();i.sortModel=[{dataIndex:e,sort:t}],i.layout._saveColumnSortModelInPreferences()},setColumnOrderState:function(e){var t=this.getManager();t.sortModel=e,t.layout._saveColumnSortModelInPreferences()},getDatagridPlaceHolder:function(){return this.options.dataGridPlaceHolder},removeColumnPreferences:function(e){if(e&&0!==e.length){var t=this.getManager(),i=t.layout._getUnpinnedColumnsOrderInPreferences();if(i){for(var n=0;n<e.length;++n)delete i[e[n]];t.layout._saveDataInPreferences("unpinnedColumnsOrder",i)}}},isColumnAvailable:function(e){return this.getManager().layout.getColumnVisibleState(e)}}),b=m.prototype.initialize;return m.prototype=Object.assign(m.prototype,e.prototype),m.prototype.initialize=b,m})),define("DS/IPClassifyUX/views/LibraryTileGridView",["DS/IPClassifyNav/views/xNavResponsiveTilesView","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],(function(e,t,i){"use strict";return e.extend({init:function(e){this._parent(e),this.options.grid.infiniteScrolling=!0;var i=this;UWA.is(this.options.grid.onCellDoubleClick,"function")&&this.options.grid.onCellDoubleClick((function(e){var i=e.nodeModel;t.notifyActivateTreeItem({resourceid:i.options.resourceid,mxid:i.options.mxid,type:i.options.type,label:i.options.label})})),this.options.grid.onInfiniteScroll((function(e){e.reachBottom?t.notifyScrollEnd():e.reachRight&&i.options.grid.infiniteScrollProcessDone()})),this.options.grid.getCustomTooltip=e=>{let t=["ds6w:label","ds6wg:revision","ds6w:type","ds6w:status","ds6w:description","ds6w:responsible","ds6w:modified","ds6w:created","ds6w:identifier"],i=this.options.dataprovider.getAdditionalTooltipAttribute?this.options.dataprovider.getAdditionalTooltipAttribute():null,n="";if(i)for(let e of i)t.splice(e.order-1,0,e.label);for(let i of t)n+=this.showTooltip(i,e);return n}},showTooltip:(e,t)=>t.options.grid[e]?i.ViewTooltip[e]+":"+t.options.grid[e]+"\n":"",showTooltipDate:(e,t)=>{if(t.options.grid[e]){let r=new Date(Date.parse(t.options.grid[e])),o=r.toLocaleTimeString().replace(/([\d]+:[\d]{2})(:[\d]{2})(.*)/,"$1$3");var n=r.toLocaleString("default",{month:"short"})+" "+r.getUTCDate()+","+r.getUTCFullYear()+", "+o;return i.ViewTooltip[e]+":"+n+"\n"}return""},getSortingOrder:e=>{var t={},i=e.getSortByCommandData();return t.order_by=i.sortOrder,t.order_field=i.sortField,t}})})),define("DS/IPClassifyUX/models/LibrarySearchModel",["UWA/Class","DS/IPClassifyUX/events/IPClassifyEvents"],(function(e,t){"use strict";return e.singleton({init:function(){this._currentSearch=null,this._indexInfo=null,this._lListener=[],this._isAdvanceSearch},onSearchChange:function(e){"function"==typeof e&&this._lListener.push(e)},onClearListener:function(){this._lListener=[]},_notifyChange:function(e){if(this.isSearchActive()||e){var i=this;e||(e=i._currentSearch),this._lListener.forEach((function(e){e.call(null,i._currentSearch)})),t.notifyContentSearchChange()}},changeSearch:function(e,t,i){if(""===e&&(e=null),this._isAdvanceSearch=i,this._currentSearch!==e||!e){this.setInfoIndex(null,!e);var n=this._currentSearch;this._currentSearch=e,this._notifyChange(n)}},isAdvanceSearchActive:function(){return this._isAdvanceSearch},clearSearch:function(){this.changeSearch("",!0)},setInfoIndex:function(e,i){if(this._indexInfo=e,!1!==i){var n=null;e&&((n={}).numberHits=this.getNumberHits(),n.dateIndex=this.getDateLastIndexation()),t.notifyContentSearchResult(n)}},getInfoIndex:function(){return this._indexInfo},getNumberLastResult:function(){return this._indexInfo?this._indexInfo.nresults:0},getNumberHits:function(){return this._indexInfo?this._indexInfo.nhits:0},getDateLastIndexation:function(){var e=null,t=this.getInfoIndex();if(t&&t.sources){var i=null;t.sources.forEach((function(e){if(e.indexingDate)var t=e.indexingDate;for(var n in t)t[n]&&-1!==t[n]&&(i?t[n]<i&&(i=t[n]):i=t[n])})),i&&(e=new Date(1e3*i))}return e},isSearchActive:function(){return!!this.getSearchValue()},isSearchInProgress:function(){return this._indexInfo&&this._currentSearch},getSearchValue:function(){return this._currentSearch}})})),define("DS/IPClassifyUX/views/LibrarySearchInContext",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Autocomplete","DS/IPClassifyUX/models/LibrarySearchModel","DS/UIKIT/Tooltip","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/SNResultUX/assets/nls/SNResultUX","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],(function(e,t,i,n,r,o,a,s,l){"use strict";var d=13,c=38,u=40,h=function(){if(!e.is(localStorage.LibSearchBoxStore)){localStorage.LibSearchBoxStore=JSON.stringify([])}return{insertSuggestion:function(t){if(null!=t&&null!=t&&""!=t&&e.is(localStorage.LibSearchBoxStore)){var i=JSON.parse(localStorage.LibSearchBoxStore);if(-1===i.indexOf(t))i.length>=100&&i.shift(),i.push(t),localStorage.LibSearchBoxStore=JSON.stringify(i);else if(i.indexOf(t)>-1){var n=i.indexOf(t),r=i[n];i.splice(n,1),i.push(r),localStorage.LibSearchBoxStore=JSON.stringify(i)}}},getSuggestions:function(t,i){var n=[];if(e.is(localStorage.LibSearchBoxStore))for(var r=JSON.parse(localStorage.LibSearchBoxStore),a=r.length-1;a>=0&&n.length!=i;--a){var s=r[a];if(null!=s&&null!=s&&""!=s&&s.toLowerCase().startsWith(t.toLowerCase())){var l={};l.label=s,l.value=s,l.id=o.stringEncode(s),n.push(l)}}return n}}}();return t.extend({switchSearch:function(e){e?this._showSearchInput():this._hideSearchInput(!0)},_hideSearchInput:function(e){e&&this.getValue()&&this.clearValue(),this.getValue()||(this.elements.inputHolder.show(),this.elements.input.hide(),this.dispatchEvent("onSearchSwitch",!1))},_showSearchInput:function(){this.elements.input.show(),this.elements.inputHolder.hide(),this.dispatchEvent("onSearchSwitch",!0)},init:function(e){var t=this;this._parent(e),this._placeholder=null;var o=document.querySelectorAll(".searchInContext_container");if(o&&o.length>0){var g=Array.prototype.slice.call(o);g&&g.forEach((function(e){e.remove()}))}this.elements.container=UWA.createElement("div",{class:"searchInContext_container"}),this.elements.inputHolder=new UWA.createElement("div",{class:"searchInContext_holder fonticon-2x fonticon fonticon-search",attributes:{title:l.get("searchInLibrary_search")},events:{click:function(){t._showSearchInput()}}}).inject(this.elements.container),new r({position:"left",target:this.elements.inputHolder}),this.elements.input=new i({multiSelect:!1,className:"ipc-searchwithin",showSuggestsOnFocus:!1,placeholder:"Search In Context",disabled:!1,allowFreeInput:!0,minLengthBeforeSearch:3,maxSuggestsToDisplay:4,noResultsMessage:null,events:{onSelect:function(e,i){this.resetCache(),h.insertSuggestion(e.value),t._launchSearch(e.value)},onKeyDown:function(e){this.resetCache();var i=e.which;e.ODTENVKeyName&&(i=e.ODTENVKeyName),i===d?(this._updateKeyboardIndex("reset"),this.dispatchEvent("onHideSuggests"),this.elements.input.value&&1==this.elements.input.value.trim().length?a.displayNotification({message:s.warning_twochars,className:"error"}):(h.insertSuggestion(this.elements.input.value),t._launchSearch(this.elements.input.value))):i===c?(this._updateKeyboardIndex("up"),this.elements.input.value=this._getActiveItem().value,this._updateKeyboardIndex("down")):i===u&&(this._updateKeyboardIndex("down"),this.elements.input.value=this._getActiveItem().value,this._updateKeyboardIndex("up"))},onClickOutside:function(e){null!=this.elements.input.value&&null!=this.elements.input.value&&""!==this.elements.input.value||(t._changePlaceholder(t._placeholder),t._launchSearch("")),this.resetCache(),t._hideSearchInput()}},datasets:{configuration:{searchEngine:function(e,i){return i?h.getSuggestions(i,this.options.maxSuggestsToDisplay):(t._launchSearch(""),[])}}}}).inject(this.elements.container),n.onSearchChange((function(e){t.elements.input.elements.input.value=e,h.insertSuggestion(e),t._showSearchInput()})),widget&&(widget.addEvent("onSearch",(function(e){n.changeSearch(e,!0)})),widget.addEvent("onResetSearch",(function(){n.clearSearch(),t._hideSearchInput()})))},changeLibraryPlaceholder:function(e){var t=l.replace(l.SearchInLibrary,{libraryName:e});this._changePlaceholder(t),this._placeholder=t},_changePlaceholder:function(e){this.elements.input.elements.input&&(this.elements.input.elements.input.setAttribute("placeholder",e),this.elements.input.elements.input.setAttribute("title",e))},_launchSearch:function(e){e=e.trim(),n.changeSearch(e,!0)},getValue:function(){return this.elements.input.elements.input.value},clearValue:function(){n.clearSearch()}})})),define("DS/IPClassifyUX/utils/IPClassifyModeManager",["UWA/Utils","UWA/Core","UWA/Class","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUtil/IPClassifyUtility","DS/PADUtils/PADSession","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],(function(e,t,i,n,r,o,a,s){"use strict";var l=null,d=i.singleton({init:function(e){this._parent(e),this.modeInformation={last_refreshed:(new Date).getTime()}},isModeSwitcherEnabled:function(){return this.modeSwitcherEnabled},determineAuthoringMode:function(){return o.determineAuthoringMode()},_isUsingIndex:function(){return"index"===this.determineAuthoringMode()},_getWaitingTimeBeforeSwitchToIndexMode:function(){return parseInt(widget.getValue("intervalToSwitchMode"))},determineCurrentModeState:function(){var e=this.determineAuthoringMode();const t=this._getWaitingTimeBeforeSwitchToIndexMode();return"authoring"!==e||widget.getValue("useIndexAccleration")?"authoring"!==e||t||(e="neverIndexMode"):e="useOnlyAuthoring",e},getFullViewLoadInfo:function(){return this.modeInformation},setAuthoringMode:function(e,t,i,o){var c=this,u=this._getWaitingTimeBeforeSwitchToIndexMode(),h=u||.02;if(i){const e=widget.getValue("IPClassify_ModeInfo")||{};if(e&&UWA.is(e.last_editing,"number")){const t=(new Date).getTime();var g=(e.last_editing+1e3*u-t)/1e3;g>0&&(h=g)}}else{if(t)if(this._isUsingIndex()&&"authoring"===e&&(u||0===u))if("none"===t)n.displayNotification({title:s.get("msg_database_mode_activated"),subtitle:s.get("msg_database_mode_activated_details")+" "+s.get("msg_tagger_not_available"),className:"info"});else{var f=s.get("msg_database_mode_activated")+"<br>"+s.get("msg_database_mode_activated_details")+" "+s.get("msg_tagger_not_available");n.displayNotification({title:t,subtitle:f,className:"success"})}else"none"!==t&&n.displayNotification({message:t,className:"success"});var p={state:e,last_editing:(new Date).getTime()};widget.setValue("IPClassify_ModeInfo",p),r.notifyModeChange({switchMode:e}),o||("authoring"===e?(c.updateTaggerAndComputeColumns(!1),a.setAuthoringState(!0)):(c.updateTaggerAndComputeColumns(!0),a.setAuthoringState(!1)))}l&&(clearTimeout(l),l=null);var _=c.determineCurrentModeState();"authoring"===e&&u&&"useOnlyAuthoring"!==_&&(l=setTimeout((function(){n.displayNotification({title:s.get("msg_index_mode_activated"),subtitle:s.get("msg_index_mode_activated_details"),className:"info"}),r.notifyModeChange({switchMode:"index"}),c.updateTaggerAndComputeColumns(!0),a.setAuthoringState(!1),c.updateRefreshTime(),d.refreshViewOfWidget(),l=null}),1e3*h))},updateRefreshTime:function(){var e={modeInformation:{last_refreshed:(new Date).getTime()}};r.notifyupdateRefreshTime(e)},updateLastIndexTime:function(e){e&&e.sources&&(this._lastIndexedData=e)},getLastIndexedTime:function(){if(this._lastIndexedData){var e=this.extractLastIndexation(this._lastIndexedData);if(e&&null!=e)return this._previousIndexTime=e,e}return this._previousIndexTime||s.text_not_available},extractLastIndexation:function(e){var t=null;if(e&&e.sources){var i=null;if(e.sources.forEach((function(e){if(e.indexingDate)var t=e.indexingDate;for(var n in t)t[n]&&-1!==t[n]&&(i?t[n]<i&&(i=t[n]):i=t[n])})),i){var n=new Date(1e3*i),r="";if(n){var o=new Date;r=(o-n)/1e3/3600>24||n.getDay()!=o.getDay()?n.toLocaleString():n.toLocaleTimeString()}t=r}}return t},addModeIntervalPreferences:function(e){var t=this;t.modeSwitcherEnabled=!0,t.refreshViewOfWidget=e.refreshView,t.updateTaggerAndComputeColumns=e.updateTaggerAndComputeColumns,widget.addPreference({name:"useIndexAccleration",defaultValue:!0,type:"boolean",label:"useIndexAccleration_label",onchange:"onUseOnlyDBChange"}),widget.addEvent("onUseOnlyDBChange",t.onUseOnlyDBChange.bind(t)),t.setIntervalSwitch(),widget.addEvent("endEdit",(function(e){if(!(!e||!e.submitted&&!e.needRefresh)){var i=widget.getValue("useIndexAccleration")?"index":"authoring";t.setAuthoringMode(i,!1,!1,!0)}t.setIntervalSwitch()}))},setIntervalSwitch:function(e){var t={name:"intervalToSwitchMode",defaultValue:"180",type:"list",label:"label_interval_to_switch_mode",options:[{label:"label_back2index_time_never",value:"0"},{label:"label_back2index_time_one_min",value:"60"},{label:"label_back2index_time_three_mins",value:"180"},{label:"label_back2index_time_five_mins",value:"300"},{label:"label_back2index_time_ten_min",value:"600"}]};e||widget.getValue("useIndexAccleration")||(t.disabled="true"),widget.addPreference(t)},onUseOnlyDBChange:function(e,t){this.setIntervalSwitch(t),widget.dispatchEvent("onEdit")}});return d})),define("DS/IPClassifyUX/views/IPClassifyModeSwitch",["UWA/Core","UWA/Controls/Abstract","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],(function(e,t,i,n,r){"use strict";return t.extend({init:function(e){var t=this;this._parent(e);var o=document.querySelectorAll(".switchMode_container");if(o&&o.length>0){var a=Array.prototype.slice.call(o);a&&a.forEach((function(e){e.remove()}))}this.switchModeContainer=UWA.createElement("div",{class:"switchMode_container"}).inject(e.idCardContainer),this.elements.modeSwitchHolder=new UWA.createElement("div",{class:"generic-icon",attributes:{title:r.command_Index_Auth_mode_switch},events:{click:function(){const e=t.switchModeContainer.querySelector(".generic-icon");e&&!e.hasClassName("disable")&&(e.hasClassName("fonticon-database-refresh")?(i.setAuthoringMode("authoring"),i.refreshViewOfWidget()):(e.hasClassName("fonticon-database-hourglass")||e.hasClassName("fonticon-database"))&&(i.setAuthoringMode("index"),i.refreshViewOfWidget()))}}}).inject(t.switchModeContainer);var s=this.switchModeContainer.getElement(".generic-icon");if(s){var l=i.determineCurrentModeState();"index"===l?s.addClassName("fonticon fonticon-database-refresh"):"authoring"===l?(s.addClassName("fonticon fonticon-database-hourglass"),s.addClassName("hoverGlass"),i.setAuthoringMode("authoring",!1,!0)):"neverIndexMode"===l?(s.addClassName("fonticon fonticon-database"),s.addClassName("hoverGlass")):"useOnlyAuthoring"===l&&(s.addClassName("fonticon fonticon-database"),s.addClassName("hoverGlass"),s.addClassName("disable")),t.setIndexDbIconTooltip(s)}n.onModeChange((function(e){var n=e.switchMode;const r=i.determineCurrentModeState();n&&("authoring"===n&&"neverIndexMode"===r?t.setNeverIndexModeIcon():"useOnlyAuthoring"===r?t.setOnlyAuthoringModeIcon():"authoring"===n?t.setAuthoringModeIcon():t.setIndexModeIcon())}))},setIndexDbIconTooltip(e){e.onmouseover=function(t){const n=i.determineCurrentModeState(),o=i.determineAuthoringMode();let a,s=(new Date).getTime()-i.getFullViewLoadInfo().last_refreshed;if(s>=6e4)var l=Math.abs(Math.round(s/6e4));else var d=Math.abs(Math.round(s/1e3));s=void 0!==l?l:d;let c=i.getLastIndexedTime();"index"===n&&"authoring"!==o?(a=void 0!==l?r.get("tooltip_index_mode_last_update_minute"):r.get("tooltip_index_mode_last_update_seconds"),l&&l>1&&(a=r.get("tooltip_index_mode_last_update_minutes")),e.title=r.replace(a,{time:s,lastIndexed:c})):"authoring"===o&&"neverIndexMode"===n||"authoring"===o&&"useOnlyAuthoring"===n?(a=void 0!==l?r.get("tooltip_never_use_index_minute"):r.get("tooltip_never_use_index_seconds"),l&&l>1&&(a=r.get("tooltip_never_use_index_minutes")),e.title=r.replace(a,{time:s,lastIndexed:c})):"authoring"===o&&(a=void 0!==l?r.get("tooltip_authoring_mode_back2index_minute"):r.get("tooltip_authoring_mode_back2index_seconds"),l&&l>1&&(a=r.get("tooltip_authoring_mode_back2index_minutes")),e.title=r.replace(a,{time:s,indexTime:widget.getValue("intervalToSwitchMode")/60,lastIndexed:c}))}},setAuthoringModeIcon(){let e=this.switchModeContainer.querySelector(".generic-icon");null!==e&&(e.classList.remove("fonticon-database-refresh"),e.classList.remove("fonticon-database"),e.classList.remove("disable"),e.classList.add("fonticon-database-hourglass"),e.classList.add("hoverGlass"))},setIndexModeIcon(){let e=this.switchModeContainer.querySelector(".generic-icon");null!==e&&(e.classList.remove("fonticon-database-hourglass"),e.classList.remove("hoverGlass"),e.classList.remove("fonticon-database"),e.classList.remove("disable"),e.classList.add("fonticon-database-refresh"))},setNeverIndexModeIcon(){let e=this.switchModeContainer.querySelector(".generic-icon");null!==e&&(e.classList.remove("fonticon-database-hourglass"),e.classList.remove("fonticon-database-refresh"),e.classList.remove("disable"),e.classList.add("fonticon-database"),e.classList.add("hoverGlass"))},setOnlyAuthoringModeIcon(){let e=this.switchModeContainer.querySelector(".generic-icon");null!==e&&(e.classList.remove("fonticon-database-hourglass"),e.classList.remove("fonticon-database-refresh"),e.classList.add("fonticon-database"),e.classList.add("hoverGlass"),e.classList.add("disable"))}})})),define("DS/IPClassifyUX/views/LibraryTreeDocumentView",["DS/Logger/Logger","DS/IPClassifyNav/models/xNavDocument","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/Utilities/Utils","DS/PADUtils/PADContext","DS/IPClassifyUtil/IPContext","DS/PADUtils/PADPredicatesNls"],(function(e,t,i,n,r,o,a,s){"use strict";var l=t.extend({name:"LibraryTreeDocumentView",_doNotAddLibrary:!1,init:function(t){t.authorize_setStructure=!0,this._parent(t),this.onNodeModelUpdate(widget.TreeDocumentDataProvider.onContentUpdate),this._logger=e.getLogger(l),this._logger.log("init");var i=this;this.selection_broadcast_fn=function(){if(!i._doNotAddLibrary){var e=i.getXSO().get();if(e&&e.length>0){var t=e[0];t.getID||(t.getID=function(){return this.id}),t.getType||(t.getType=function(){return this.plmType})}widget.TreeDocumentCSOProvider&&widget.TreeDocumentCSOProvider.addInCSO(e,"CONTENT")}};let n=r.debounce((function(){i.selection_broadcast_fn()}),20);this.getXSO().onChange(n),this.getXSO().onEmpty((function(){i._doNotAddLibrary=!1,n()})),this.getXSO().onPreEmpty((function(){i._doNotAddLibrary=!0}))},_buildSelectData:function(){var e=this._parent();if(e){var t=widget.TreeDocumentCSOProvider.getCurrentObject();if(Array.isArray(e.paths)&&e.paths.length>=1){if(t&&widget.TreeDocumentDataProvider.isValidType(t.plmType)){for(var i=widget.TreeDocumentCSOProvider.getCurrentObjectPath(),n=[],r=Array.isArray(i)?i.length:0,o=0;o<r;o++)n.push({resourceid:i[o].id,type:i[o].type});e.libraryPath=n}}else if(t&&widget.TreeDocumentDataProvider.isValidType(t.plmType)){i=widget.TreeDocumentCSOProvider.getCurrentObjectPath();var a=[];for(r=Array.isArray(i)?i.length:0,o=0;o<r-1;o++)a.push({resourceid:i[o].id,type:i[o].type});var s={};if(r>=1){var l=r-1;i[l].id&&(s[i[l].id]={type:i[l].type,label:i[l].label})}e.paths=[[t.id]],e.attributes=s,e.libraryPath=a}}return e},withBroadcastSelect:function(e){this.prepareBroadcastSelect(),e(),this.pushBroadcastSelect()},prepareBroadcastSelect:function(){this._doNotAddLibrary=!0,this._parent()},pushBroadcastSelect:function(){this._doNotAddLibrary=!1,this.selection_broadcast_fn(),this._parent()},keepExpandedState:function(){for(var e=this.getRoots(),t=0;t<e.length;t++)if(e[t].isExpanded()){libraryContent._refreshProductStructure=!0;break}},refreshNodeById:function(e){var t=this,r=n.isModeSwitcherEnabled();if((!r||widget.id!==e.widgetId)&&i.isIndexedMode())return;var l=e.modified;e.modified=[];var d=e.fromRenameOp;if(l.length>0){var c=a.get()?a.get():o.get(),u=c.options.views?c.options.views.datagridview:null,h=u?u.options.dgvLayout.getLeafColumns():null;widget.TreeDocumentDataProvider&&widget.TreeDocumentDataProvider.getObjectsForRefresh&&h&&widget.TreeDocumentDataProvider.getObjectsForRefresh(l,h).then((function(o){o&&o.length>0&&(r&&!d&&widget.id===e.widgetId&&i.isIndexedMode()&&(widget.TreeDocumentDataProvider.canSwitchToAuthoringOnEdit?widget.TreeDocumentDataProvider.canSwitchToAuthoringOnEdit()&&(n.setAuthoringMode("authoring","none"),n.updateRefreshTime()):(n.setAuthoringMode("authoring","none"),n.updateRefreshTime())),o.forEach((function(e){var i=t.searchRootById(e.physicalid);i&&(t.wrapInTransaction((function(){i.updateOptions(e)})),!0===i.options._manageNLS&&s.updateNLS(i))})))}))}this._parent(e)}});return l})),define("DS/IPClassifyUX/models/LibraryTreeModel",["UWA/Class","DS/IPClassifyUtil/IPClassifyPreference","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/IPClassifyUtil/IPClassifyUtility","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUtil/IPClassifyAlert"],(function(e,t,i,n,r,o){"use strict";var a,s,l,d,c,u=(a={},{toFetchDataFromCache:function(e){var t=a[e];return null!=t},clean:function(){a={}},children:function(e){var t=a[e];if(t){var i=[];for(var n in t)t.hasOwnProperty(n)&&i.push(t[n]);t=i}return a[e]=null,t},updateCache:function(e,t,i){if(e&&t&&!(e.length<=0)){for(var n=[],r=0;r<e.length;++r)for(var o=e[r],s=1;s<o.length;++s){var l=o[s-1],d=t[o[s]],c=o[s];a[l]||(a[l]={}),a[l][c]=d,s===o.length-1&&-1===i&&n.push(o[s])}-1===i&&(i=n);for(var u=0;u<i.length;++u){var h=i[u];a[h]||(a[h]={})}}}}),h={TREE_SELECTED_NODE:"ipcTreeSelectedNode_v1",TREE_STRUCTURE:"ipcTreeStrucure_v1",getTreeSelectedNode:function(){return n.getTenantAwarePreferenceName(this.TREE_SELECTED_NODE)},getTreeStructure:function(){return n.getTenantAwarePreferenceName(this.TREE_STRUCTURE)}},g=(s=function(e){return e||(e={root:{e:!0,c:{}}}),e},l={_items:[],_isProcessing:!1,OPERATIONS:{ADD:"add",REMOVE:"remove"},_process:function(){var e=this;if(0!=this._items.length){var t=this._items[0];this._items.shift(),t.operation==e.OPERATIONS.ADD?d(t.pathId,t.childIds,(function(){e._process()})):t.operation==e.OPERATIONS.REMOVE&&c(t.pathId,(function(){e._process()}))}else this._isProcessing=!1},add:function(e){this._items.push(e),0==this._isProcessing&&(this._isProcessing=!0,this._process())}},d=function(e,i,n){t.get(h.getTreeStructure(),(function(r){var o=r=s(r),a=e.split(","),l=a.splice(a.length-1)[0];if(a.forEach((function(e){o[e]||(o[e]={e:!0,c:{}}),o=o[e].c})),o[l]||(o[l]={e:!0,c:{}}),o[l].e=!0,UWA.is(i,"array")){var d=o[l].c,c={};i.forEach((function(e){d[e]&&(c[e]=d[e])})),o[l].c=c}t.set(h.getTreeStructure(),r),n()}))},c=function(e,i){t.get(h.getTreeStructure(),(function(n){var r=n=s(n),o=e.split(","),a=o.splice(o.length-1)[0];o.forEach((function(e){r[e]||(r[e]={e:!0,c:{}}),r=r[e].c})),r[a]||(r[a]={e:!0,c:{}}),r[a].e=!1,0===r[a].c.length&&delete r[a],t.set(h.getTreeStructure(),n),i()}))},{add:function(e,t){l.add({pathId:e,childIds:t,operation:l.OPERATIONS.ADD})},remove:function(e){l.add({pathId:e,operation:l.OPERATIONS.REMOVE})},addExpandAllPaths:function(e,i){i.length<=0||t.get(h.getTreeStructure(),(function(n){var r=n=s(n),o=e.split(","),a=o.splice(o.length-1)[0];o.forEach((function(e){r[e]||(r[e]={e:!0,c:{}}),r=r[e].c})),r[a]={e:!0,c:{}};for(var l=0;l<i.length;++l)for(var d=r,c=i[l],u=1;u<c.length;++u){var g=c[u],f=c[u-1];d[f].c[g]||(d[f].c[g]={e:!0,c:{}}),d=d[f].c}t.set(h.getTreeStructure(),n)}))},isExpanded:function(e,i){t.get(h.getTreeStructure(),(function(t){var n=t=s(t),r=e.split(","),o=r.splice(r.length-1)[0];r.forEach((function(e){n[e]||(n[e]={e:!0,c:{}}),n=n[e].c}));var a=!1;n[o]&&void 0!==n[o].e&&(a=n[o].e),i.call(window,a)}))},select:function(e){var i={path:e};t.set(h.getTreeSelectedNode(),i)},isSelected:function(e,i,n){t.get(h.getTreeSelectedNode(),(function(t){var r=!0;t&&(t=t.path),t||e!=="root,"+i?t!=e&&(r=!1):r=!0,n.call(window,r)}))},getExpandedChildren:function(e,i){t.get(h.getTreeStructure(),(function(t){var n=[],r=t=s(t),o=e.split(","),a=o.splice(o.length-1)[0];o.forEach((function(e){r[e]||(r[e]={e:!0,c:{}}),r=r[e].c}));var l=[];l.push(r[a]);for(var d=0;d<l.length;++d){var c=l[d];if(c)for(var u in c.c)c.c.hasOwnProperty(u)&&!0===c.c[u].e&&(n.push(u),0!=Object.keys(c.c[u].c).length&&l.push(c.c[u]))}i.call(window,n)}))},scrollAfterSelect:function(e){widget.setValue("scrollToNode",e)},doScrollAfterSelect:function(e){return widget.getValue("scrollToNode")===e}}),f=e.singleton({setExpandAllOperation:function(e){this._expandAllOp=!1,e&&!0===e&&(this._expandAllOp=!0)},_isOperationExpandAll:function(){return this._expandAllOp},fetchLibraryContents:function(e,t){var i=this;return new Promise((function(n,r){if(u.toFetchDataFromCache(e.parentNodeID)){var o=u.children(e.parentNodeID);n(o)}else u.clean(),i._isOperationExpandAll()?i._expand(e,null,t).then((function(e){n(e)}),(function(e){r(e)})):g.getExpandedChildren(e.parentPath,(function(o){i._expand(e,o,t).then((function(e){n(e)}),(function(e){r(e)}))}))}))},_expand:function(e,t,i){var n=this;return new Promise((function(r,o){i({pid:e.parentNodeID,mxid:e.parentNodeMXID,children:t,isExpandAll:n._isOperationExpandAll()}).then((function(i){i.paths&&i.paths.length<=0&&i.objects&&i.objects.length<=0?r([]):(n._isOperationExpandAll()&&(t=-1,g.addExpandAllPaths(e.parentPath,i.paths)),u.updateCache(i.paths,i.objects,t),i.childIds?(g.add(e.parentPath,i.childIds),r(i.objects)):r(u.children(e.parentNodeID)))}),(function(e){o(e)}))}))},fetchAllLibraries:function(e,t){var n=this;return new Promise((function(a,s){t().then((function(t){if(t&&t.infos&&(i.updateLastIndexTime(t.infos),t.infos.sources&&t.infos.sources.length>0&&t.infos.sources[0].error)){var s=t.infos.sources[0],l=s.error.errorMessage;console.error("Error with federated search: ["+s.error.errorCode+"] "+l),o.displayNotification({title:r.msg_error_with_federated_search_title,message:r.msg_error_with_federated_search_message,className:"error"})}n._isOperationExpandAll()&&g.add(e,t.ids),a(t.objects)}),(function(e){s(e)}))}))},getFavorites:function(e,i){function n(e){return e.id}t.get(e.getPreferenceSectionName(),(function(r){r&&r.length>0?e.getPreferenceSectionContents({ids:r.map(n)}).then((function(n){var o=[],a=!1;n.length!==r.length&&(a=!0);for(var s=0;s<n.length;++s){for(var l=0;l<r.length;++l)r[l].id===n[s].physicalid&&(n[s].label=r[l].name);a&&o.push({id:n[s].physicalid,name:n[s].label})}if(a&&t.set(e.getPreferenceSectionName(),o,!1,!1),i.onComplete){var d=n,c=r.slice(),u=[];function g(e){for(var t=0;t<d.length;t++)d[t].physicalid===e&&d.splice(t,1)}for(var h=0;h<c.length;h++)n.forEach((function(e,t){e.physicalid===c[h].id&&(u.push(e),g(e.physicalid))}));d.length>0&&d.forEach(((e,t)=>{u.concat(e)})),i.onComplete(u)}}),(function(e){i.onFailure&&i.onFailure(e)})):i.onComplete&&i.onComplete([])}),!1,!1)},setFavorites:function(e,i){function n(e){for(var t=0;t<this.length;++t)if(this[t].id==e.id)return!1;return!0}function r(e){return e.id}var o=Array.isArray(i.favoriteLibraries)?i.favoriteLibraries:[i.favoriteLibraries];t.get(e.getPreferenceSectionName(),(function(a){if((a=Array.isArray(a)?a:[]).length>0){if(!0===i.renamed)for(var s=0;s<a.length;++s)for(var l=0;l<o.length;++l){a[s].id===o[l].id&&(a[s].name=o[l].name);break}o=o.filter(n,a)}a=a.concat(o),t.set(e.getPreferenceSectionName(),a,!1,!1),o.length>0?e.getPreferenceSectionContents({ids:o.map(r)}).then((function(e){i.onComplete&&i.onComplete(e)}),(function(e){i.onFailure&&i.onFailure(e)})):i.onComplete&&i.onComplete([])}),!1,!1)},reorderFavoritePreference:function(e,i){var n=Array.isArray(i.favoriteLibraries)?i.favoriteLibraries:[i.favoriteLibraries];t.set(e.getPreferenceSectionName(),n,!1,!1),n.length>0?e.getPreferenceSectionContents({ids:n.map((function(e){return e.id}))}).then((function(e){i.onComplete&&i.onComplete(e)}),(function(e){i.onFailure&&i.onFailure(e)})):i.onComplete&&i.onComplete([])},removeFromFavorites:function(e,i){function n(e){for(var t=0;t<this.length;++t)if(this[t]==e.id)return!1;return!0}var r,o=Array.isArray(i.favoritesToRemove)?i.favoritesToRemove:[i.favoritesToRemove];t.get(e.getPreferenceSectionName(),(function(a){a.length>0&&(r=1!==a.length,a=a.filter(n,o)),t.set(e.getPreferenceSectionName(),a,!1,!1),i.onComplete&&i.onComplete(r)}),!1,!1)},getLibraryPathLength:function(e,t){e({ids:[t.pid]}).then((function(e){t.onComplete&&t.onComplete(e)}),(function(e){t.onFailure&&t.onFailure(e)}))},getLibraryPath:function(e,t){e({depth:t.depth,pid:t.pid}).then((function(e){t.onComplete&&t.onComplete(e)}),(function(e){t.onFailure&&t.onFailure(e)}))},libraryStructurePreference:g});return{setExpandAllOperation:f.setExpandAllOperation.bind(f),fetchLibraryContents:f.fetchLibraryContents.bind(f),fetchAllLibraries:f.fetchAllLibraries.bind(f),getFavorites:f.getFavorites.bind(f),setFavorites:f.setFavorites.bind(f),removeFromFavorites:f.removeFromFavorites.bind(f),libraryStructurePreference:f.libraryStructurePreference,getLibraryPathLength:f.getLibraryPathLength.bind(f),getLibraryPath:f.getLibraryPath.bind(f),reorderFavoritePreference:f.reorderFavoritePreference.bind(f)}})),define("DS/IPClassifyUX/service/PlatformServices",["UWA/Core","UWA/Promise","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/IPClassifyUX/service/SettingsManagement"],(function(e,t,i,n){"use strict";var r=function(){};return r.prototype.initializePlatform=function(e){var t=this;i.getPlatformServices({onComplete:function(i){if(null===i){i.options=e;var r=e.onFailure;r&&r("cannot retrieve platform data")}else{for(var o={},a=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",s=0;s<i.length;s++)i[s].platformId===a&&(t.platformurls=o.platformurls=i[s]);n.addSetting("platformServices",t),o.options,(0,e.onComplete)(o)}},onFailure:function(t){var i=e.onFailure;i&&i(t)}})},r})),define("DS/IPClassifyUX/views/LibraryMode",["UWA/Controls/Abstract","DS/Controls/TooltipModel","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUX/models/LibrarySearchModel","DS/IPClassifyUtil/IPClassifyAlert","DS/PADUtils/PADSession","DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/utils/IPClassifyModeManager"],(function(e,t,i,n,r,o,a,s,l,d){"use strict";var c=null,u=null,h=null,g=null;function f(){return{icon:{iconName:widget.getValue("useIndexAccleration")?0==widget.getValue("intervalToSwitchMode")?"database hoverGlass":"database-hourglass":"database hoverGlass",fontIconFamily:1,className:"check-active"},disabled:!widget.getValue("useIndexAccleration")}}var p=e.singleton({_currentModeType:"index",_instantTime:null,_lastRefreshMode:null,_lastIndexInfo:i.text_not_available,_modeInformation:{},init:function(e){this._parent(e),this._tooltip=new t,this._modeInformation={last_refreshed:(new Date).getTime()},this.subscribeToEvents()},subscribeToEvents:function(){var e=this;a.getModelEvents().subscribe({event:"switch_to_author"},this.switchtoAuthoringMode.bind(this)),setInterval((()=>{this.updateToolTip()}),1e4),l.onUpdateRefreshTime((function(t){e._modeInformation=t.modeInformation,e.updateToolTip()})),l.onModeChange((function(t){e.setCurrentMode(t.switchMode),p.updateIconAndSettings()}))},setLibraryDataProvider:function(e){g=e},setLibraryControl:function(e){h=e},getToolbarEntry:function(){var e=p.determineCurrentModeState();this._tooltip.title=i.get("tooltip_title_indexMode"),this._tooltip.shortHelp="index"===e?i.get("msg_index_mode_activated"):i.get("msg_database_mode_activated");var t=require("DS/WebUAUtils/WebUAUtils"),n={helpid:"indexMode"};g&&g.getIndexModePanelHelp?n.content={"indexMode.PanelHelp":g.getIndexModePanelHelp()}:n.content={"indexMode.PanelHelp":"Lbc3DDashUAPanelMap/lbc3ddash-c-index-database-mode.htm"};var r=t.getMoreHelpCallback(n);this._tooltip.moreHelpCB=r;var o="index"==e?{icon:{iconName:"database-refresh",fontIconFamily:1,className:""},disabled:!1}:f(),a={id:"indexMode",dataElements:{typeRepresentation:"functionIcon",tooltip:this._tooltip,label:i.indexMode.Label,action:{module:"DS/IPClassifyUX/views/LibraryMode",func:"switchModeButtonUI"},visibleFlag:!0}};for(var s in o)a[s]=o[s];return a},switchModeButtonUI:function(){s.sendTrackerPageEvent("LibraryWidget_iconBar","Active Mode");var e;e=300,clearTimeout(u),u=setTimeout((function(){n.isSearchActive()&&(n.clearSearch(),h.getIdCardCont().switchSearch(!1));try{"index"==p.getCurrentModeType()?d.setAuthoringMode("authoring"):d.setAuthoringMode("index"),p.updateIconAndSettings(),d.refreshViewOfWidget(),p.setLastIndexTime(d.getLastIndexedTime())}catch(e){console.error(e)}}),e)},updateIconAndSettings:function(e){if((e||!0)&&this._registerTimeandModeOfRefresh(this.getCurrentModeType()),"index"==this.getCurrentModeType()&&this._enableIndexModeSwitch(),"authoring"==this.getCurrentModeType())if(widget.getValue("useIndexAccleration")){var t=widget.getValue(widget.getValue("intervalToSwitchMode"));this._enableAuthoringMode(),p.setIndexModeAfterTimeInterval(t)}else this._enableAuthoringMode();this.updateToolTip()},_enableAuthoringMode:function(){if(h.getIdCardCont()){var e=f();h.getIdCardCont().updateCommand("indexMode",e)}},_enableIndexModeSwitch:function(){if(h.getIdCardCont()){var e={icon:{iconName:"database-refresh",fontIconFamily:1,className:""},disabled:!1};h.getIdCardCont().updateCommand("indexMode",e)}},getCurrentModeType:function(){return s.determineAuthoringMode()},setCurrentModeType:function(e){this._currentModeType==e&&"authoring"!=this._currentModeType||("index"==e?this._enableIndexModeSwitch():this._enableAuthoringMode()),this._currentModeType=e,"index"==e?(o.setAuthoringState(!1),o.setUseIndexPreference(!0)):(o.setAuthoringState(!0),o.setUseIndexPreference(!1))},_getWaitingTimeBeforeSwitchToIndexMode:function(){return parseInt(widget.getValue("intervalToSwitchMode"))},determineCurrentModeState:function(){var e=this.getCurrentModeType();const t=this._getWaitingTimeBeforeSwitchToIndexMode();return"authoring"!==e||widget.getValue("useIndexAccleration")?"authoring"!==e||t||(e="neverIndexMode"):e="useOnlyAuthoring",e},getFullViewLoadInfo:function(){return this._modeInformation},setLastIndexTime:function(e){this._lastIndexInfo=e},getLastIndexedTime:function(){return this._lastIndexInfo?this._lastIndexInfo:d.getLastIndexedTime()},_registerTimeandModeOfRefresh:function(e){this._instantTime=(new Date).getTime(),this._lastRefreshMode=e},updateToolTip:function(){const e=this.determineCurrentModeState(),t=this.getCurrentModeType();let n,r=(new Date).getTime()-this.getFullViewLoadInfo().last_refreshed;if(r>=6e4)var o=Math.abs(Math.round(r/6e4));else var a=Math.abs(Math.round(r/1e3));r=void 0!==o?o:a;let s=this.getLastIndexedTime();if("index"===e&&"authoring"!==t){n=void 0!==o?i.get("tooltip_index_mode_last_update_minute"):i.get("tooltip_index_mode_last_update_seconds"),o&&o>1&&(n=i.get("tooltip_index_mode_last_update_minutes"));var l=i.replace(n,{time:r,lastIndexed:s});this._tooltip.setProperties({shortHelp:l})}else"authoring"===t&&"neverIndexMode"===e||"authoring"===t&&"useOnlyAuthoring"===e?(n=void 0!==o?i.get("tooltip_never_use_index_minute"):i.get("tooltip_never_use_index_seconds"),o&&o>1&&(n=i.get("tooltip_never_use_index_minutes")),this._tooltip.shortHelp=i.replace(n,{time:r,lastIndexed:s})):"authoring"===t&&(n=void 0!==o?i.get("tooltip_authoring_mode_back2index_minute"):i.get("tooltip_authoring_mode_back2index_seconds"),o&&o>1&&(n=i.get("tooltip_authoring_mode_back2index_minutes")),this._tooltip.shortHelp=i.replace(n,{time:r,indexTime:widget.getValue("intervalToSwitchMode")/60,lastIndexed:s}))},setIndexModeAfterTimeInterval:function(e){var t=this;if(this.stopRefresh(),!isNaN(e)){var n=parseInt(e);c=setTimeout((function(){t.setCurrentMode("index"),t.updateIconAndSettings(),r.displayNotification({message:i.indexMode.info_msg_DataNotUptoDate,className:"info"})}),60*n*1e3)}},stopRefresh:function(){c&&clearTimeout(c)},setCurrentMode:function(e){"authoring"==e&&(n.isSearchActive()&&(n.clearSearch(),h.getIdCardCont().switchSearch(!1)),"index"==this._currentModeType&&r.displayNotification({message:i.indexMode.msg_Authoring,className:"info"})),this.setCurrentModeType(e)},switchtoAuthoringMode:function(){"index"==p.getCurrentModeType()&&(n.isSearchActive()&&(n.clearSearch(),h.getIdCardCont().switchSearch(!1)),p.setCurrentMode("authoring"),r.displayNotification({message:i.indexMode.msg_Authoring,className:"info"}),p.updateIconAndSettings())}});return p})),define("DS/IPClassifyUX/views/IPClassifyTagger",["UWA/Class","DS/IPClassifyUX/events/IPClassifyEvents","DS/TagNavigatorProxy/TagNavigatorProxy","DS/IPClassifyUX/views/IPClassifyWebInWinTaggerProxy","DS/WidgetServices/WidgetServices","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUtil/IPClassifyUtility","DS/FedDictionaryAccess/FedDictionaryAccessAPI"],(function(e,t,i,n,r,o,a,s,l){"use strict";var d={},c={},u={};return e.extend({CONTENT_TYPES:{EMPTY:"empty"},_initTaggerProxy:function(){var e=this;if(r.isNatifEnvironnement()){window.widgetId||(window.widgetId="LibraryEditor"+Math.random().toString(36).substr(2,9)),(o=a(window.widgetId)).events.addFilterChangeListener=e.onFilterChange.bind(e),o.events.addCriteriaChangeListener=e.onFilterChange.bind(e),e.taggerProxy=new n(o)}else{var o=a(widget.id);(e.taggerProxy=i.createProxy(o)).addEvent("onFilterChange",e.onFilterChange.bind(e)),t.onTabChange((function(){e.taggerProxy.clearLocalFilter(),e.unsetTags(),e.deactivateTaggerProxy()}))}function a(t){return{widgetId:t,filteringMode:"FilteringOnServer",colorize:!1,exclude:!0,events:{addOpenTaggerListener:e.onOpenTagger.bind(e),addCloseTaggerListener:e.onCloseTagger.bind(e)}}}},_setSubjectTags:function(e,t,i,n){if(this.containerType=t,t===this.CONTENT_TYPES.EMPTY)this._setTagsForFavourites(e);else this._setTagsForLibraries(e,i,n)},getTranslationOfObject:function(e,t){let i=t[e];return i||e},applyTranslation:function(e,t){e.forEach((e=>{if(e.nlsKey){let i=t[e.nlsKey];if(i){let t=[];Array.isArray(e.object)?e.object.forEach((e=>{t.push(this.getTranslationOfObject(e,i))})):t=this.getTranslationOfObject(e.object,i),e.dispValue=t}}}))},prepareForTranslation:function(e){var t={};return e&&e.forEach((e=>{if(e.sixw&&"date"!==e.type){let i=e.sixw.lastIndexOf("/"),n=i>0?e.sixw.substring(i+1):e.sixw;e.nlsKey=n;let r=t[n];r||(r=t[n]=[]),Array.isArray(e.object)?e.object.forEach((e=>r.push(e))):r.push(e.object)}})),t},translatePredicates:function(e){if(0===Object.keys(e).length)return;let t=this.prepareForTranslation(e);var i=this;return new Promise((n=>{l.getNlsOfPropertiesValues(JSON.stringify(t),{tenantId:r.getTenantID(),lang:r.getLanguage(),apiVersion:"R2019x",onComplete:function(t){i.applyTranslation(e,t),n()},onFailure:function(e){console.warn("IP Cannot retrieve NLS"),n()}})}))},_setTagsForLibraries:async function(e,t,i){if(this.taggerProxy)if(e){var n={};for(var r in e){var l=e[r];if(n[l.sixw])n[l.sixw][l.object]=l;else{var u={};u[l.object]=l,n[l.sixw]=u}}var h=[];for(var g in n)for(var f in d[g]||(c[g]=n[g]),c[g])h.push(c[g][f]);i&&this.taggerProxy.configurePredicates(i),t?(await this.translatePredicates(e),this.taggerProxy.setTags(null,e)):(await this.translatePredicates(h),this.taggerProxy.setTags(null,h))}else{this.taggerProxy.setTags({});let e=this.taggerProxy.getCurrentFilter();!(!e||!e.allfilters||0===Object.keys(e.allfilters).length)&&s.isIndexedMode()&&o.displayNotification({message:a.msg_warning_emptyResult_with_selected_tags,className:"warning"})}},_setTagsForFavourites:function(e){if(this.taggerProxy){this.taggerProxy.setTags({})}},activateTaggerProxy:function(){var e=this.taggerProxy;e&&e.activate()},deactivateTaggerProxy:function(){var e=this.taggerProxy;e&&e.deactivate()},unsetTags:function(){var e=this.taggerProxy;e&&e.unsetTags()},onFilterChange:function(e){if(e){for(var i in d={},e.allfilters)d[i]=[];return u=e.allfilters,t.notifyCurrentLibraryFilterChange(),!0}},onOpenTagger:function(){t.notifyTaggerOpen()},onCloseTagger:function(){t.notifyTaggerClose()},_getCurrentFilter:function(){return u}})})),define("DS/IPClassifyUX/models/LibraryBreadcrumbModel",["UWA/Class","DS/IPClassifyUX/models/LibraryInfo"],(function(e,t){"use strict";var i=e.singleton({_currentPathNodes:null,getNewPathNodes:function(e){this._currentPathNodes=[];var i=e.CSOProvider.getCurrentObjectPath();if(i&&i.length>0)for(var n=i.length-1;n>=0;--n){var r=i[n];this._currentPathNodes.push(new t({id:r.id,mxid:r.mxid,type:r.type,label:r.label,getChildrenInfos:e.getChildrenInfos}))}return this._currentPathNodes},getPathNodes:function(){return this._currentPathNodes}});return{getNewPathNodes:i.getNewPathNodes.bind(i),getPathNodes:i.getPathNodes.bind(i)}})),define("DS/IPClassifyUX/views/InformationsPanelView",["UWA/Controls/Abstract","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/PADUtils/PADContext","DS/IPClassifyUtil/IPContext","DS/WidgetServices/commandProxy/CommandProxy","DS/PADServices/utils/GlobalModelEvents","DS/PADUtils/PADSettingsMgt","DS/IPClassifyUtil/IPSettingsMgr"],(function(e,t,i,n,r,o,a,s,l){"use strict";return e.extend({_context:null,_propertiesWdg:null,_callbackAdd:!1,_modelEv:null,_libraryEditorUtil:null,_libraryControl:null,init:function(e){this._parent(e,{}),this._context=r.get()?r.get():n.get();var o=this;this._propertiesWdg=null,this._callbackAdd=!1,this._modelEv=a.getModelEvents(),e.dataProvider&&(this._libraryEditorUtil=e.dataProvider.getLibraryEditorUtil&&e.dataProvider.getLibraryEditorUtil(),this._libraryControl=e.dataProvider.getLibraryControl&&e.dataProvider.getLibraryControl()),o.CSOProvider=e.CSOProvider,e.padshell&&(null==o._propertiesWdg&&require(["DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants"],(function(n,r){if(null==o._propertiesWdg){o._propertiesWdg=new n({className:"enxpropertiestab",setEditButton:!0,readOnly:!1,typeOfDisplay:r.ALL,selectionType:r.RESTRICTED_SELECTION,multiselection:!1,collapseTabs:!1,context:{getSecurityContext:function(){return{SecurityContext:s.getSetting("pad_security_ctx")||l.getSetting("pad_security_ctx")}}}});let c=[{require:"DS/EditPropWidget/facets/GeneralHistory/History",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"history",icon:"clock",text:i.get("history_tab")},options:{appContext:{options:e,getDocumentId:function(){return e.CSOProvider.getSelectedNodesID()[0]}}}},{position:1,require:"DS/ENORIPE_Relations/views/RelationsTab",facet:{name:"relations",text:i.get("relations_tab"),icon:"object-related"}},{position:2,require:"DS/IPClassifyUX/facets/AttachmentsFacet",alwaysVisible:!1,supportMerge:!1,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"attachments",text:i.get("attachments"),icon:"attach"},options:{appContext:{options:e,getDocumentId:function(){return e.CSOProvider.getSelectedNodesID()[0]},readonly:e.readOnly}}},{position:3,require:"DS/ClassificationsFacet/ClassificationFacet",alwaysVisible:!1,facet:{name:"Classification",text:i.get("Classification"),icon:"classification-book"},options:e}];o.options.dataProvider.getAdditionalFacets&&c.push(...o.options.dataProvider.getAdditionalFacets(o.options)),o._propertiesWdg.addFacets(c),o._propertiesWdg.removeFacets([r.FACET_VIEWS]);var a=e.padshell.getRightPanelContent();o._propertiesWdg.inject(a),o._propertiesWdg.stopSelection(!0);var d=null;o._libraryEditorUtil.getRightPanelStatus().then((function(i){d=i,1!==o._libraryEditorUtil.CURRENT_TAB_VALUE&&d&&d.rightPanelState&&(o._context.togglePanel("right"),o._selectionChange(),o.show(e.padshell),t.notifyInfoExpanded(),o.setPreferences(),o._modelEv.publish({event:"information-panel-visible"}))})),o._propertiesWdg.elements.container.getContent().addEvent("resize",(function(){o.size=e.padshell._currentRight;var t={rightPanelState:e.padshell.getRightOpen(),size:o.size};o._libraryEditorUtil&&o._libraryEditorUtil.setRightPanelStatus(t)}))}o.addCallback(e)})),t.onInfoExpand((function(){o.show(e.padshell),t.notifyInfoExpanded()})),t.onInfoCollapse((function(){e.padshell._modelEvents.publish({event:"triptych-hide-panel",data:"right"}),t.notifyInfoCollapsed()})),t.onLibrarySelected((function(){e.padshell.getRightOpen()&&(o.show(e.padshell),t.notifyInfoExpanded())})))},updatePanelVisibility:function(e,t){"right"===t&&this._libraryControl&&this._libraryControl.getIdCardCont()&&this._libraryControl.getIdCardCont().updateRightPanelIcon(e)},show:function(e){var t=this;require(["DS/EditPropWidget/utils/EditPropUtils"],(function(i){t._selectionChange(i,e)}))},addCallback:function(e){var i=this;!1===i._callbackAdd&&i._context.elements.padshell&&i._context.elements.padshell._modelEvents&&(i._context.elements.padshell._modelEvents.subscribe({event:"triptych-panel-hidden"},i.updatePanelVisibility.bind(this,!1)),i._context.elements.padshell._modelEvents.subscribe({event:"triptych-panel-visible"},i.updatePanelVisibility.bind(this,!0)),this._modelEv.subscribe({event:"information-panel-open"},(function(){i.show(e.padshell),t.notifyInfoExpanded(),i.setPreferences()})),this._modelEv.subscribe({event:"information-panel-close"},(function(){i._context.elements.padshell.getRightOpen()&&(i._context.togglePanel("right"),t.notifyInfoCollapsed(),i._selectionChange(),i.setPreferences())})),i._callbackAdd=!0)},_selectionChange:function(e,t){if(e){var i=this,n=i.CSOProvider.getSelectedNodes();if(i._propertiesWdg.elements.UI._lFacets.forEach((function(e){"history"===e.facet.name&&n.length>1?e.alwaysVisible=!1:"history"===e.facet.name&&1===n.length&&(e.alwaysVisible=!0)})),i.CSOProvider.enableEditProperty){let e=i.CSOProvider.enableEditProperty(n);this._propertiesWdg.controller.skeleton._sharedOptions.readOnly=!e}var r=[];n.length&&n.forEach((function(t){if(e.getModelFromSelectedNode){var n=e.getModelFromSelectedNode(t);n&&(i.options.dataProvider.checkTypesForActiveThumbnails&&(n._attributes.activeThumbnail=i.options.dataProvider.checkTypesForActiveThumbnails(n._attributes.type)),r.push(n))}})),i._propertiesWdg.initDatas(r),i._context.elements.padshell._modelEvents.publish({event:"triptych-show-panel",data:"right"})}},setPreferences:function(){var e=this._context.elements.padshell.getRightOpen(),t={rightPanelState:e,size:this.size};this._libraryEditorUtil.setRightPanelStatus(t),e?this._modelEv.publish({event:"information-panel-visible"}):this._modelEv.publish({event:"information-panel-hidden"})}})})),define("DS/IPClassifyUX/views/LibraryOrderCmdView",["UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUX/events/IPClassifyEvents"],(function(e,t,i,n,r){"use strict";return e.extend(t,i,{_name:"library_orderTools",_defaultOptions:{sortMode:"alpha",sortOrder:"asc"},init:function(e){this._parent(e),this.sortMode=widget.getValue("sortMode")||this._defaultOptions.sortMode,this.sortOrder=widget.getValue("order")||this._defaultOptions.sortOrder,this._buildSkeleton()},getSortModel:function(e){let t=this;var i=this._getalphaIcon(),r=this._getdateSortingIcon();let o=i;return"date"===t.sortMode&&(o=r),{id:"alphaSortingContainer",dataElements:{label:n.fonticon_sort,typeRepresentation:"functionMenuIcon",value:{menu:[{id:"alphaSort",type:"PushItem",title:n.alpha_sorting,icon:"alpha-sorting-a-z"==i.iconName?{iconName:"alpha-sorting-z-a",fontIconFamily:1}:i,action:{callback:function(){t.changeAlphaIcon(e,i)}}},{id:"dateSort",type:"PushItem",title:n.date_sorting,icon:r,action:{callback:function(){t.changeDateIcon(e)}}}]},icon:o,position:"far",category:"1"}}},_buildSkeleton:function(){this.elements.container=UWA.createElement("div",{id:"library_orderTools"})},changeDateIcon:function(e){var t=this._getdateSortingIcon();e.leftToolbar.updateNodeModel("dateSort",{icon:t}),this.toggleButtonDate(),t=this._getdateSortingIcon(),e.leftToolbar.updateNodeModel("alphaSortingContainer",{icon:t})},changeAlphaIcon:function(e){var t=this._getalphaIcon();e.leftToolbar.updateNodeModel("alphaSort",{icon:t}),this.toggleButton(),t=this._getalphaIcon(),e.leftToolbar.updateNodeModel("alphaSortingContainer",{icon:t})},toggleButton:function(){this.sortMode="alpha",this.sortOrder&&("asc"===this.sortOrder?this.sortOrder="desc":this.sortOrder="asc"),widget.setValue("sortMode",this.sortMode),widget.setValue("order",this.sortOrder),this.sortingNodesUnsensitiveCase()},toggleButtonDate:function(){this.sortMode="date",this.sortOrder&&("asc"===this.sortOrder?this.sortOrder="desc":this.sortOrder="asc"),widget.setValue("sortMode",this.sortMode),widget.setValue("order",this.sortOrder),this.sortingNodesUnsensitiveCase()},getSortMode:function(){return this.sortMode},_getalphaIcon:function(){return{iconName:"desc"==this.sortOrder?"alpha-sorting-z-a":"alpha-sorting-a-z",fontIconFamily:1}},_getdateSortingIcon:function(){return{iconName:"desc"==this.sortOrder?"num-sorting-2-1":"num-sorting-1-2",fontIconFamily:1}},sortingNodesUnsensitiveCase:function(){r.notifyTreeSortChange({sortOrder:this.sortOrder,sortMode:this.sortMode})}})})),define("DS/IPClassifyUX/models/LibraryContentModel",["UWA/Class","UWA/Class/Promise","DS/IPClassifyUtil/IPClassifyPreference","DS/IPClassifyUX/utils/IPClassifyWidgetData"],(function(e,t,i,n){"use strict";var r,o,a,s,l=(r=void 0,o=0,a=!1,s=!1,{reset:function(){r=void 0,o=0},updateStartIndexAfterFetch:function(e){if(a=!1,e.infos&&e.infos.next_start){r=e.infos.next_start;var t=parseInt(r.slice(0,r.indexOf(" ")));(o+=e.infos.nresults)<e.infos.nhits&&t<e.infos.nhits&&(a=!0)}},isMoreDataToFetch:function(){return a},isFetchInProgress:function(){return s},setFetchInProgress:function(e){s=e},getNextStart:function(){return r}}),d=void 0,c=e.singleton({fetchLibraryContents:function(e,i){var r,o;return e.isStartFromBeg&&(l.reset(),d=e.dynamicattributes.filter((function(e,t,i){return i.indexOf(e)===t}))),e.sortOrder&&(r=e.sortOrder.order_field,o=e.sortOrder.order_by),new t((function(t,a){i({pid:e.containerId,mxid:e.containerMXID,searchQuery:e.searchQuery,isExactSearch:e.isExactSearch,selectedType:e.selectedType,dynamicattributes:d,attributesDimMap:e.attributesDimMap,filters:e.filters,start:e.isStartFromBeg?0:void 0,next_start:l.getNextStart(),order_field:r,order_by:o,physicalId:e.physicalId,isAuthoringMode:e.isAuthoringMode,grid:e.grid,widgetData:n.getWidgetData()}).then((function(e){l.setFetchInProgress(!1),l.updateStartIndexAfterFetch(e),t(e)}),(function(e){a(e)}))}))},fetchAllLibraries:function(e,i){var r,o;return e.isStartFromBeg&&l.reset(),e.sortOrder&&(r=e.sortOrder.order_field,o=e.sortOrder.order_by),new t((function(t,a){i({filters:e.filters,start:e.isStartFromBeg?0:void 0,next_start:l.getNextStart(),order_field:r,order_by:o,searchQuery:e.searchQuery,isCleanColumns:e.isCleanColumns,widgetData:n.getWidgetData()}).then((function(e){l.setFetchInProgress(!1),l.updateStartIndexAfterFetch(e),t(e)}),(function(){a()}))}))},fetchAllFavorites:function(e){return new t((function(t,r){function o(e){return e.id}i.get(e.getPreferenceSectionName(),(function(a){a.length>0?e.getPreferenceSectionContents({ids:a.map(o),widgetData:n.getWidgetData()}).then((function(n){var r=[],o=!1;n.length!==a.length&&(o=!0);for(var s=0;s<n.length;++s){for(var l=0;l<a.length;++l)a[l].id===n[s].physicalid&&(n[s].label=a[l].name);o&&r.push({id:n[s].physicalid,name:n[s].label})}o&&i.set(e.getPreferenceSectionName(),r,!1,!1),t(n)}),(function(){r()})):t([])}),!1,!1)}))}});return{fetchLibraryContents:c.fetchLibraryContents.bind(c),fetchAllLibraries:c.fetchAllLibraries.bind(c),fetchAllFavorites:c.fetchAllFavorites.bind(c),isMoreDataToFetch:l.isMoreDataToFetch,isFetchInProgress:l.isFetchInProgress,setFetchInProgress:l.setFetchInProgress}})),define("DS/IPClassifyUX/IPClassifyUXEvents",["UWA/Class","DS/IPClassifyUX/events/IPClassifyEvents"],(function(e,t){return e.singleton({notifyLibrarySelected:function(e){t.notifyLibrarySelected(e)},onLibrarySelected:function(e){t.onLibrarySelected(e)},onContentSearchChange:function(e){t.onContentSearchChange(e)},notifyCurrentLibraryChange:function(e){t.notifyCurrentLibraryChange(e)}})})),define("DS/IPClassifyUX/LibraryIdCardCont",["DS/IPClassifyUXUtil/ActionBar/IPToolbar","UWA/Class/Options","DS/IPClassifyUX/views/LibraryMode","DS/IPClassifyUX/models/LibraryInfo","DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUX/models/LibrarySearchModel","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUXUtil/OpenWithMenuBuilder","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUXUtil/ActionBar/IPClassifyTabBar","DS/IPClassifyUX/IPClassifyUXEvents"],(function(e,t,i,n,r,o,a,s,l,d,c,u){"use strict";var h=null,g=void 0,f=e.extend(t,{name:"LibraryIdCardController",_probeLoadElmt:null,_commandManager:null,_libraryControl:null,_libraryCSO:null,_libraryTypeService:null,getCommandManager:function(){return this._commandManager},needSep:function(){return!h.needSep||h.needSep()},getInfoVisibility:function(){return!h.showInformationCommand||h.showInformationCommand()},getStableAreaWidth:function(e){var t=this._libraryCSO.getCurrentObject();return h.getStableAreaWidth?h.getStableAreaWidth(this.isSearchAvailable(),t,e):void 0},shouldMove:function(){return g},isTreeViewVisible:function(){var e=d.getWidgetData();return e&&e.showTreeView},getSearchWithinController:function(){return h.getSearchWithinController?h.getSearchWithinController():null},handleChange:function(){return o.changeSearch.bind(o)},handleChangeAttributesTab:function(){if(h.getClassAttributeSearch)return h.getClassAttributeSearch.bind(h)},createPathInfo:e=>new n({id:e.id,mxid:e.mxid,type:e.type,label:e.label,getChildrenInfos:h.getChildrenInfos}),getEntryForCommand:e=>{var t=null,n=d.getWidgetData().currentWidgetTab;return"IndexMode"===e&&(0==n||h.isIndexModeVisible&&h.isIndexModeVisible(n))&&(t=i.getToolbarEntry()),"openWith"===e&&(t={id:"openWith",plmType:"",dataElements:{typeRepresentation:"functionMenuIconCount",tooltip:s.OpenWith,label:s.OpenWith,icon:{iconName:"open-menu-dot",fontIconFamily:1},value:{menu:[]},position:"far"}}),t},buildOpenWithMenuItems:function(e,t){if(Array.isArray(t)&&0!=t.length&&null!=t[0]&&null!=t[0]&&1!=t[0].noTree&&"Attribute"!=t[0].plmType&&t[0].getLabel()){var i=this;t||(t=this._libraryCSO.getSelectedNodes());var n="";try{t[0].options&&(n=t[0].options.type),n&&!["General Library","Part Library","RootLibrary","General Class","Library"].includes(n)||(n="CLASSIFICATION_NODE")}catch(e){console.log(e),n="CLASSIFICATION_NODE"}if(i.toolbars.unstable){var r={data:{menu:[]}};if(1==t.length&&(i.toShow=!0),!e||t.length>1||!t[0].options||!t[0].options.mxid)t.length>1&&(i.toShow=!1),i.toolbars.unstable.updateNodeModel("openWith",{grid:r,visibleFlag:!1,menuSave:r.data.menu,visitedType:n});else{var o=i.toolbars.unstable.getNodeModelByID("openWith"),a=o.options.visitedType;if(n!=a||0==o.options.grid.data.menu.length)l.openWithApps(t,{iconOpenWith:{iconName:"open-menu-dot",fontIconFamily:1},nlsOpenWith:s.OpenWith},"ClassificationEditorWidget_openwith").then((function(e){1==i.toShow&&(e[0]&&e[0].submenu&&e[0].submenu.forEach((function(e){r.data.menu.push(e)})),i.toolbars.unstable.updateNodeModel("openWith",{grid:r,menuSave:r.data.menu,visibleFlag:r.data.menu.length>0,visitedType:n}))}))}}}},getSizes:function(){var e=[];return e=widget.getValue("x3dSharedId").startsWith("ClassificationEditor")?["102px","102px"]:this.isSearchAvailable()?["176px","175px"]:["147px","147px"],this._parent(e)},buildTabBar(e){var t=this;t.tabProvider&&(this.IPClassifyTabBar=new c({tabIdCard_container:t.defaultTabIdCardCont?t.defaultTabIdCardCont:e,dataProvider:h,tabBarProvider:t.tabProvider,unsubscribeAll:a.unsubscribeAll.bind(a),notifyTabChange:a.notifyTabChange.bind(a),getCurrentWidgetTab:d.getCurrentWidgetTab.bind(d),setCurrentWidgetTab:d.setCurrentWidgetTab.bind(d)}),g||(this.IPClassifyTabBar.tabBar.elements.container.style.height="0px"))},init:function(e){this._libraryCSO=e.libraryCSODataProvider,h=e.libraryDataProvider,g=e.canMoveBreadCrumb,this._commandManager=h.getCommandManager&&h.getCommandManager(),this._libraryControl=h.getLibraryControl&&h.getLibraryControl(),this._libraryTypeService=h.getLibraryTypeService&&h.getLibraryTypeService(),this._libraryControl.setIdCardCont(this),this.tabProvider=e.TabBarProvider,this.defaultTabIdCardCont=e.TabCont,i.setLibraryControl(this._libraryControl),i.setLibraryDataProvider(h),widget.addEvent("ontoolbarReady",(()=>{this._libraryIdCardView=this._libraryControl.getContent().getView();var t=this._libraryIdCardView.getActiveView(),i=this._commandManager.getCommand(t);i&&i.options.icon&&e.modelEvents.publish({event:"toolbar_update_command",data:{commandID:"display",data:{icon:{iconName:i.options.icon,fontIconFamily:1}}}})}));var t=this,n=e.leftState,o=e.rightState;if(e.leftOpened=n&&n.leftPanelState,e.rightOpened=o&&o.rightPanelState,e.modelEvents=r.getModelEvents(),e.searchInCurrentTab=!0,this._parent(e),e.modelEvents.subscribe({event:"searchValueSet"},t.handleChange()),h&&h.getCurrentTabValue&&a.onAttributesTabSearchQuery(t.handleChangeAttributesTab()),u.onLibrarySelected((()=>{t.getCommandManager().updateCommands()})),a.onEmptySearchQuery((function(){e.modelEvents.publish({event:"searchUpdated",data:null}),e.modelEvents.publish({event:"searchValueSet",data:null})})),a.onContentTabChange((function(){t.getCommandManager().updateCommands()})),a.onCurrentLibraryChange((function(e){t.setCurrentLocation()})),e.modelEvents.subscribe({event:"build_openwith"},(e=>{t.toolbars.unstable&&t.toolbars.unstable.getNodeModelByID("openWith")&&t.buildOpenWithMenuItems(e.visible,e.nodes)})),t.dispatchEvent.call(this,"onReady"),1==g)this.elements.elementStableCommands.setStyles({"flex-basis":"auto"}),this.elements.flexToolbar.getChildren()[0].getChildren()[0].setStyles({width:"70%"});else if(this.tabProvider){this.elements.container.getParent().style.height="60px";var s=document.querySelector(".wux-controls-buttongroup.wux-controls-abstract");if(s){var l=s.getChildren();for(let e=0;l&&e<l.length>0;e++)l[e].setStyles({"font-size":"14px",color:"#878787","font-family":"Arial,sans-serif"})}}h.isSearchBoxAvailable&&0==h.isSearchBoxAvailable()&&document.querySelector(".searchFlex.centerMe").setStyles({display:"none"})},inject:function(){this._parent.apply(this,arguments),this.setCurrentLocation()},setCurrentLocation:function(){var e=this._libraryCSO.getCurrentObjectPath();this._parent({objectPath:e})},isSearchAvailable:function(e){return h.showSeachCommand?h.showSeachCommand():(e||(e=this._libraryCSO.getCurrentObject()),!(!e||1==e.noTree)&&(!this._libraryTypeService.isSection(e.getType())&&e.options.mxid))},render:function(){return this}});return f})),define("DS/IPClassifyUX/views/LibraryPlaceHolder",["DS/ApplicationFrame/CommandsManager","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUtil/IPContext","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/models/LibrarySearchModel","UWA/Controls/Abstract","DS/Controls/Button","DS/IPClassifyUX/utils/IPClassifyWidgetData"],(function(e,t,i,n,r,o,a,s){"use strict";return o.extend({init:function(e){this._parent(e),this._buttonComponents=null,this.text={},this.dataProvider=e.commandContext.dataProvider,this.CSOProvider=e.commandContext.CSOProvider,this.isMultiplePlaceholders=e.commandContext.placeholderData.multiplePlaceholders,this.buildSkeleton()},buildSkeleton:function(){var e=this,t=null,i="LibrarySection_AllLibraries";e.CSOProvider.getCurrentObject()&&(i=e.CSOProvider.getCurrentObject().noTree?"noTree":e.CSOProvider.getCurrentObject().plmType),n.onCurrentLibraryChange((function(i){var n=s.getWidgetData().currentTab;e._removeButtonComponent(),(t=e._getComponentToReplace(i.currentNode.plmType,n))&&t.inject(e.elements.container)})),r.onSearchChange((function(i,n){if(e.dataProvider.showSearchPlaceHolder&&e.dataProvider.showSearchPlaceHolder()){var r=e.CSOProvider.getCurrentObject()?e.CSOProvider.getCurrentObject().noTree?"noTree":e.CSOProvider.getCurrentObject().plmType:"LibrarySection_AllLibraries";e._removeButtonComponent(),(t=e._getComponentToReplace(r))&&t.inject(e.elements.container)}})),n.onContentTabChange((function(i){var n=s.getWidgetData().currentTab;e._removeButtonComponent(),(t=e._getComponentToReplace(i,n))&&t.inject(e.elements.container)})),this.elements.container=UWA.createElement("div",{class:"content-placeholder",html:{tag:"div",text:"",class:"content-placeholder-description"}});var o=s.getCurrentSubTab();(t=e._getComponentToReplace(i,o))&&t.inject(e.elements.container)},_removeButtonComponent:function(){this.getContent().getElementsByClassName("content-placeholder-common-command")[0]&&this.getContent().getElementsByClassName("content-placeholder-common-command")[0].remove()},_getComponentToReplace:function(e,t){var i=this._getButtonComponents();if(null===i){var n=this._getOptions();i=this._buttonComponents=this._buildButtonComponents(n)}return r.isSearchActive()?(this._getText(this.text.blankSection),i.blankSection):this.isMultiplePlaceholders?1===s.getWidgetData().currentWidgetTab?(this._getText(this.text.newClassAttributesSection),i.newClassAttributesSection):"LibrarySection_favorite"===e?(this._getText(this.text.favoriteSection),i.favoriteSection):"LibrarySection_AllLibraries"===e?(this._getText(this.text.librariesSection),i.librariesSection):"RootLibrary"===e?(this._getText(this.text.librarySection),i.librarySection):"Library"!==e&&e?void 0:1===t?(this._getText(this.text.classAttributesSection),i.classAttributesSection):(this._getText(this.text.classSection),i.classSection):"noTree"===e?(this._getText(this.text.blankSection),i.blankSection):(this._getText(this.text.commonSection),i.commonSection)},_getButtonComponents:function(){return this._buttonComponents},_getText:function(e){null==e&&(e=""),this.getContent().getElementsByClassName("content-placeholder-description")[0].innerText=e},_getOptions:function(){var t=this;let n=i.get()?i.get().toString():void 0;if(this.isMultiplePlaceholders)return{favoriteSection:{text:t.options.commandContext.placeholderData.placeholders.favoriteSection.labelNLS,commands:[]},librariesSection:{text:t.options.commandContext.placeholderData.placeholders.createNewDefinitionLibrary.labelNLS,commands:[{name:t.options.commandContext.placeholderData.placeholders.createNewDefinitionLibrary.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.createNewDefinitionLibrary.command,n);i&&i.begin()}},{name:t.options.commandContext.placeholderData.placeholders.createNewStandardLibrary.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.createNewStandardLibrary.command,n);i&&i.begin()}}]},librarySection:{text:t.options.commandContext.placeholderData.placeholders.createNewClass.labelNLS,commands:[{name:t.options.commandContext.placeholderData.placeholders.createNewClass.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.createNewClass.command,n);i&&i.begin()}}]},classSection:{text:t.options.commandContext.placeholderData.placeholders.createNewClass.labelNLS_Cls,commands:[{name:t.options.commandContext.placeholderData.placeholders.createNewClass.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.createNewClass.command,n);i&&i.begin()}}]},classAttributesSection:{text:t.options.commandContext.placeholderData.placeholders.addClassAttributes.labelNLS,commands:[{name:t.options.commandContext.placeholderData.placeholders.addClassAttributes.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.addClassAttributes.command,n);i&&i.begin()}}]},newClassAttributesSection:{text:t.options.commandContext.placeholderData.placeholders.newClassAttributes.labelNLS,commands:[]}};{let i={commonSection:{text:t.options.commandContext.placeholderData.placeholders.addExistingCI.labelNLS,commands:[{name:t.options.commandContext.placeholderData.placeholders.addExistingCI.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.addExistingCI.command,n);i&&i.begin()}}]}};return t.options.commandContext.placeholderData.placeholders.NoObjectsFound&&(i.blankSection={text:t.options.commandContext.placeholderData.placeholders.NoObjectsFound.labelNLS,commands:[]}),i}},_buildButtonComponents:function(e){var t=[];function i(e,t){var i=e.commands[t].callback,n={label:e.commands[t].name,emphasize:e.commands[t].emphasize};if("Add Existing Attributes"==e.commands[t].name&&s&&"Specialist"==s.getPermission()&&1==s.getIsPermissionRestrictionEnabled())return null;var r=new a(n);return r.getContent().addEventListener("buttonclick",(function(){i()})),r}function n(e,t){if(e.commands)for(var n=0;n<e.commands.length;n++){var r=i(e,n);r&&r.inject(t)}}for(var r in e){var o=UWA.createElement("div",{class:"content-placeholder-common-command"});n(e[r],o),t[r]=o,this.text[r]=e[r].text}return t}})})),define("DS/IPClassifyUX/views/LibraryTreeView",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","DS/Tree/Tree","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Tree/TreeNodeView","DS/WebappsUtils/WebappsUtils","DS/IPClassifyUX/models/LibraryTreeModel","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADUtilsServices","DS/IPClassifyUX/views/LibraryOrderCmdView","DS/IPClassifyUX/service/LibraryDnDService","DS/IPClassifyUtil/IPClassifyAlert","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewLayout","DS/PADUtils/Configuration","DS/WidgetServices/WidgetServices","DS/Tweakers/GeneratedToolbar"],(function(e,t,i,n,r,o,a,s,l,d,c,u,h,g,f,p,_,m,b,v,C){"use strict";function y(e){return e._modelEvents}return t.extend(i,n,{name:"LibraryTreeView",_libraries_TreeDocument:null,_libraries_TreeView:null,_libraries_SortElmt:null,_rootNodeFavorite:null,_rootNodeLibraries:null,_commandProxy:null,_libraries_dgvTreeDocument:null,_timerDragEnter:null,_dndDropPosition:null,_currentDragEnterLibrary:null,_typeService:null,init:function(e,t){var i=this;i._parent(e),this.CSOProvider=e.CSOProvider,this.DnDProvider=e.DnDProvider,this.dataProvider=e.dataProvider,i._commandProxy=u.create(),i._buildSkeleton(),i._libraries_SortElmt=new g;let n=i._libraries_SortElmt.getSortModel(i);i.model={entries:[]},this.dataProvider.getStatesFilterModel&&i.model.entries.push(this.dataProvider.getStatesFilterModel()),i.model.entries.push(n);var r=C.prototype.createTreeDocument(i.model);i.leftToolbar=new C({overflowManagement:"dropdown",direction:"horizontal",items:r}).inject(i._libraries_SortElmt.elements.container);this._libraries_dgvTreeDocument;var o=this._libraries_TreeView?this._libraries_TreeView.getTreeDocument():void 0;this._libraries_TreeDocument=o,o&&(o.options.shouldBeEditable=this.dataProvider.shouldBeEditable,o.onNodeModelUpdate(this.dataProvider.onContentUpdate),o.options.shouldAcceptDrag=this._shouldAcceptDrag.bind(this),o.options.shouldAcceptDrop=this._shouldAcceptDrop.bind(this),i._libraries_TreeDocument.onPreExpand(t._onPreExpandTreeNode.bind(t)),i._libraries_TreeDocument.getXSO().onChange((function(e){var t=i._libraries_TreeDocument.getXSO().get();if(t&&t.length>0){var n=t[t.length-1];n.getID||(n.getID=function(){return this.id}),n.getType||(n.getType=function(){return this.plmType}),i.CSOProvider.getCurrentObject()!==n&&i.CSOProvider.addInCSO(n,"TREE")}})))},createLibrarySections:function(e){var t=this;e.forEach((function(e){var i={useAsyncPreExpand:!0};i.label=e.label,i.icons=[e.icon],i.children=[],i.id="",i.plmType=e.plmType,t.dataProvider.isPreferenceSection(e.plmType)?t._rootNodeFavorite=t._createTreeNodeModel(i,t._libraries_TreeDocument):(t.defaultSelectedSection=e.plmType,t._rootNodeLibraries=t._createTreeNodeModel(i,t._libraries_TreeDocument))}))},_buildSkeleton:function(){var t=this;if(!e.is(this.elements.container)){this.elements.container=UWA.createElement("div",{class:this.getClassNames()+"_container"}),this.getOption("css_view_class")&&this.elements.container.addClassName(this.getOption("css_view_class")),this.elements.libraryTreeView_container=UWA.createElement("div",{class:this.getClassNames()+"_treeview_container"}).inject(this.elements.container);var i=UWA.clone(b.getConfig("dgvOptions")),n=i&&i.dgv?i.dgv:{};n.selectionBehavior.toggle=v.isTouchDevice(),n.selectionBehavior.unselectAllOnEmptyArea=!1,n.infiniteScrolling=!0,n.onContextualEvent=t._onContextualEvent.bind(t),n.rowSelection="single",n.showRowBorderFlag=!1,n.columns=[{dataIndex:"tree",sortableFlag:!1,typeRepresentation:"string",getCellEditableState:function(e){return!!(e&&e.nodeModel&&t.dataProvider.isTreeNodeEditable)&&t.dataProvider.isTreeNodeEditable(e)},editionPolicy:"DelayedEditionOnClick",setCellValue:function(e,t){if(e.nodeModel){var i=e.nodeModel;i.getTreeDocument().withTransactionUpdate((function(){var e={};e.label=t,e.display=t,e.oldLabel=i.options.label,i.updateOptions(e)}))}},compareFunction:function(e,i,n,r,o){return t.dataProvider.comparator(n,r)},onCellRequest:function(e){e.isHeader||(e.nodeModel&&e.nodeModel.options.isBeingCut?e.cellView.getContent().addClassName("library-state-is-being-cut"):e.cellView.getContent().removeClassName("library-state-is-being-cut")),this.defaultOnCellRequest(e)}}];var r=UWA.extend({identifier:"DataGridView-"+t.name+"-"+widget.id},n);i.dgvLayout.rowsHeader=!1;var a=UWA.clone(i.dgvLayout);r.layout=new m(a),r.layout.useLastColumnWidthAutoFlag=!0,r.layout.columnsHeader=!1;var s=new o;r.treeDocument=s,r.rowDragEnabledFlag=!0,r.useAsyncPreExpand=!0;var l=new _(r).inject(this.elements.libraryTreeView_container);this._libraries_TreeView=l,l.showAlternateBackgroundFlag=!1,l.treeNodeCellOptions.depthIncrement=14,l.treeNodeCellOptions.buildLinks=!0,l.treeNodeCellOptions.expanderStyle="triangle",l.onDragEndCell=this._onDragEndCell.bind(this),l.onDragOverCell=this._onDragOverCell.bind(this),l.onDragLeaveCell=this._onDragLeaveCell.bind(this),l.onDropCell=this._onDropCell.bind(this),l.onDragEnterBlank=this._onDragEnterBlank.bind(this),l.onDragOverBlank=this._onDragOverBlank.bind(this),l.onDropBlank=this._onDropBlank.bind(this),l.addEventListener("dblclick",(function(e,i){e&&i&&-1!==i.rowID&&t._switchExpandStatus(i)}))}},_switchExpandStatus:function(e){!0===e.nodeModel._isExpanded?e.nodeModel.collapse():e.nodeModel.expand()},_onContextualEvent:function(e){var t=this;return e&&e.cellInfos&&e.cellInfos.nodeModel.select(),new Promise((function(i){t.onContextualMenuReady(e).then((function(e){i(e)}))}))},_onDragOver:function(e){},_onDragOverCell:function(e,t){var i=this;e.preventDefault();t.nodeModel;return t&&!t.nodeModel.isFavorite&&(t.dropPosition="middle"),this._dndDropPosition=t.dropPosition,i._currentDragEnterLibrary&&i._timerDragEnter&&i._currentDragEnterLibrary!==t.nodeModel.getID()&&(clearTimeout(i._timerDragEnter),i._timerDragEnter=null),i._currentDragEnterLibrary===t.nodeModel.getID()||t.nodeModel.isExpanded()||"expanding"===t.nodeModel.getState()||(i._timerDragEnter=setTimeout((function(){t.nodeModel.expand()}),i.time_to_expand_node)),i._currentDragEnterLibrary=t.nodeModel.getID(),!0},_onDropCell:function(e,t){if(e.preventDefault(),"middle"!==t.dropPosition)return!0;if(this.dataProvider.isDNDSupported()){var i=t.nodeModel;if(i&&this.DnDProvider.shouldAcceptDrop(i)){var n=this;n._timerDragEnter&&(clearTimeout(n._timerDragEnter),n._timerDragEnter=null),n._currentDragEnterLibrary=null;try{f.performDropOnLibraryEditorNode(i,e,this.DnDProvider)}catch(e){p.displayNotification({message:c.msg_warning_dndnotsupported,className:"warning"})}}else p.displayNotification({message:c.msg_warning_dndnotsupported,className:"warning"})}else p.displayNotification({message:c.msg_warning_dndnotsupported,className:"warning"})},_onDropBlank:function(e,t){this.dataProvider.isDNDSupported()||p.displayNotification({message:c.msg_warning_dndnotsupported,className:"warning"})},_onDragEndCell:function(e,t){e.preventDefault();var i=this;if("middle"!==this._dndDropPosition&&t&&t.nodeModel.isFavorite){var n=[];this._libraries_TreeDocument.getRoots()[0].getAllDescendants().forEach((function(e){n.push(e.id)})),d.getFavorites(i.dataProvider,{onComplete:function(e){var t=e,r=[];function o(e){for(var i=0;i<t.length;i++)t[i].physicalid===e&&t.splice(i,1)}for(var a=0;a<n.length;a++)e.forEach((function(e,t){e.physicalid===n[a]&&(r.push({id:e.physicalid,name:e.label}),o(e.physicalid))}));t.length>0&&t.forEach(((e,t)=>{r.concat({id:e.physicalid,name:e.label})})),d.reorderFavoritePreference(i.dataProvider,{favoriteLibraries:r,onComplete:function(e){console.log("Re-arrange of favorite node is successful"),p.displayNotification({message:c.get("msg_success_favoriteReordered"),className:"success"})},onFailure:function(e){console.log("WebService setFavorites Err : "+e),p.displayNotification({title:c.msg_error_favoriteReordered.title,subtitle:c.msg_error_favoriteReordered.subtitle,className:"error"})}})},onFailure:function(e){console.log(e)}})}return!1},_onDragLeaveCell:function(e,t){var i=this;return i._timerDragEnter&&(clearTimeout(i._timerDragEnter),i._timerDragEnter=null),i._currentDragEnterLibrary=null,!0},_onDragEnterBlank:function(e,t){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="none"),t.dropPosition="middle";return this._dndDropPosition=t.dropPosition,!0},_onDragOverBlank:function(e,t){},_populateContentSection:function(e,t){var i=this;e.forEach((function(e){var n={useAsyncPreExpand:!0};n.label=e.label,n.icons=e.icons,n.children=[],n.id=e.physicalid,n.mxid=e.mxid,n.plmType=e.plmType,n.created=e.created,n.type=e.type,n.grid=e.grid,UWA.is(e.publishOnConnect)&&(n.publishOnConnect=e.publishOnConnect);i._createTreeNodeModel(n,t)})),i._libraries_SortElmt.sortingNodesUnsensitiveCase()},_populateAllLibrariesSection:function(e,t){var i=this;e.forEach((function(e){var n={useAsyncPreExpand:!0};n.label=e.label,n.icons=e.icons,n.children=[],n.id=e.physicalid,n.mxid=e.mxid,n.plmType=e.plmType,n.created=e.created,n.type=e.type,n.grid=e.grid,UWA.is(e.publishOnConnect)&&(n.publishOnConnect=e.publishOnConnect);i._createTreeNodeModel(n,t)})),i._libraries_SortElmt.sortingNodesUnsensitiveCase()},_populateFavoriteSection:function(e){var t=this,i={useAsyncPreExpand:!1};e.forEach((function(e){i.label=e.label,i.icons=e.icons,i.children=null,i.id=e.physicalid,i.mxid=e.mxid,i.plmType=e.plmType,i.isFavorite=!0,i.type=e.type,i.grid=e.grid,t._createTreeNodeModel(i,t._rootNodeFavorite).setState({state:"noChildren"})}))},_addFavouriteNode:function(e){var t={useAsyncPreExpand:!1};t.label=e.label,t.icons=e.icons,t.mxid=e.mxid,t.children=null,t.id=e.physicalid,t.plmType=e.plmType,t.type=e.type,e.grid&&(t.status=e.grid["ds6w:status"],t.usage=e.grid["ds6w:classificationUsage"]),t.isFavorite=!0,this._createTreeNodeModel(t,this._rootNodeFavorite).setState({state:"noChildren"})},addNewNode:function(e,t){var i=this,n={useAsyncPreExpand:!1};n.label=e.label,n.icons=e.icons,e.usage&&(n.usage=e.usage),n.mxid=e.mxid,n.children=[],n.id=e.physicalid,n.plmType=e.plmType,n.type=e.type,t?i._createTreeNodeModel(n,t):i._createTreeNodeModel(n,i._rootNodeLibraries)},_createTreeNodeModel:function(e,t,i){var n=this,r=t instanceof o,s=e.publishOnConnect;delete e.publishOnConnect;var c=new a(e);if(c.id=e.id,c.mxid=e.mxid,c.plmType=e.plmType,e.usage?c.options.usage=e.usage:e.grid&&(c.options.usage=e.grid["ds6w:classificationUsage"]),e.grid?c.options.status=e.grid["ds6w:status"]:c.options.status=e.status,e.isFavorite&&(c.isFavorite=!0),e.created&&(c.created=e.created),c._instanceType="LibraryEditor/TreeNodeModel",c._loadingcounter=0,c.getID=function(){var e=this.id;return e&&""!==e||(e=this.plmType),e},c.getMXID=function(){var e=this.mxid;return e&&""!==e||(e=this.plmType),e},c.options.oldLabel=e.label,c.pathId=(r?"root":t.pathId)+","+c.getID(),"TRUE"===s){var u=l.getWebappsAssetUrl("LibraryEditor","icons/libraryPublishBadge.png");c.updateOptions({badges:{bottomRight:u}})}c.onPostExpand((function(e){if(!e.data||!e.data.expandAll){var t=[];if(this&&this.getChildren){var i=this.getChildren();UWA.is(i,"array")&&i.forEach((function(e){t.push(e.getID())}))}d.libraryStructurePreference.add(this.pathId,t)}})),c.onPostCollapse((function(e){d.libraryStructurePreference.remove(this.pathId)})),y(c).subscribe({event:"removeChild"},(function(e){if(c.isExpanded()&&c.isVisible()){var t=e.nodeModel;!t&&e.data&&(t=e.data.nodeModel),t&&d.libraryStructurePreference.remove(t.pathId)}})),y(c).subscribe({event:"addChild"},(function(e){if(c.isExpanded()&&c.isVisible()){var t=e.nodeModel;!t&&e.data&&(t=e.data.nodeModel),t&&t._isExpanded&&d.libraryStructurePreference.add(t.pathId)}})),r?t.addRoot(c):t.addChild(c,i);var h=function(e){r?c[e]():t.isExpanded()?(c.isVisible()&&"select"===e&&n._libraries_TreeDocument.getXSO().empty(),("expand"!==e||!c.isExpanded()&&"expanding"!==c.getState())&&c[e]()):y(t).subscribeOnce({event:"postExpand"},(function(t){"expanding"!==c.getState()&&("select"===e&&n._libraries_TreeDocument.getXSO().empty(),c[e]())}))},g=widget?widget.defaultSelectionPathFromWin:null;return d.libraryStructurePreference.isExpanded(c.pathId,(function(e){(e||g&&-1!=g.indexOf(c.pathId))&&(n.dataProvider.isPreferenceSection(c.plmType)&&!n._rootNodeFavorite&&(n._rootNodeFavorite=c),h("expand"))})),g?g==c.pathId&&h("select"):d.libraryStructurePreference.isSelected(c.pathId,n.defaultSelectedSection,(function(e){e?h("select"):c.pathId===n._TreeNodeToBeAddedtoLibraryCSOWithoutSelection_pathId&&(n.CSOProvider.addInCSO(c,"TREE"),n._TreeNodeToBeAddedtoLibraryCSOWithoutSelection_pathId=void 0)})),c},_scrollToVisibleNode:function(e){var t=this._libraries_TreeView,i=t.layout.getColumnIndex("tree"),n=t.layout.getCellsFromNodeModel(e)[i];t.scrollToCellAt({cellID:n})},_scrollOnPostUpdateView:function(e){var t=this,i=this._libraries_TreeView?this._libraries_TreeView:null,n=d.libraryStructurePreference.doScrollAfterSelect(e.getID());i&&n&&i.onPostUpdateViewOnce((function(){d.libraryStructurePreference.doScrollAfterSelect(e.getID())&&(t._scrollToVisibleNode(e),d.libraryStructurePreference.scrollAfterSelect(""))}))},onContextualMenuReady:function(e){var t=this;return new Promise((function(i){var n=e.cellInfos,r=void 0;try{r=n.nodeModel?n.nodeModel:n.cellModel}catch(e){}if(r)if(r&&t.dataProvider.getContextualMenu){var o=t.CSOProvider.getSelectedNodes(),a=[];o.length&&o.forEach((function(e){a.push(e)})),a.length&&a.forEach((function(e){e.unselect()}));var s=!1;if(n.nodeModel)if(!1===n.nodeModel._isSelected&&(n.nodeModel._isSelected=!0,n.nodeModel.select(!0)),!0===n.nodeModel._isSelected)(n.nodeModel?n.nodeModel:n.cellModel)&&(s=!0);s?t.dataProvider.getContextualMenu(n).then((function(e){e&&e.forEach((function(e){"separator"===e.type||"SeparatorItem"===e.type?e.type="SeparatorItem":e.label&&(e.title=e.label,e.action={callback:e.callback},e.type="PushItem")})),i(e)})):i([])}else i([]);else i([])}))},onViewChange:function(e){this.elements.container.removeClassName(e.previous.type),this.elements.container.addClassName(e.type)},getSortingContainer:function(){return this._libraries_SortElmt.elements.container},setObjectOnCompass:function(e){h.setObject_on_compass({nodes_2_open:e})},render:function(){return this},isTreeNodeModelInstance:function(e){return e instanceof a},_shouldAcceptDrag:function(e){var t=this.CSOProvider.getCurrentObject();return!(!t||!t.isFavorite)},_shouldAcceptDrop:function(e){return!e||"middle"!==e.dropPosition||"Library"!==e.draggedNodes[0].plmType||!e.draggedNodes[0].isFavorite}})})),define("DS/IPClassifyUX/LibraryTree",["UWA/Class","DS/Logger/Logger","DS/IPClassifyUX/views/LibraryTreeView","DS/IPClassifyUX/models/LibraryTreeModel","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/PlatformAPI/PlatformAPI","css!DS/IPClassifyUX/IPClassifyUX","DS/WidgetServices/WidgetServices","DS/IPClassifyUX/models/LibrarySearchModel","UWA/Controls/Abstract","DS/PADServices/utils/GlobalModelEvents"],(function(e,t,i,n,r,o,a,s,l,d,c,u,h){"use strict";var g=u.extend({name:"LibraryTreeController",_libraryTreeView:null,_logger:null,_libraryContentView:null,init:function(e){this._parent(e),this.dataProvider=e.dataProvider,this.CSOProvider=e.CSOProvider,this._libraryTreeView=new i(e,this),this._libraryTreeView.createLibrarySections(this.dataProvider.getSectionsData()),this._libraryTreeView.getSortingContainer().inject(this._libraryTreeView.elements.container),this._OnTreeComponentReady(),this.dispatchEvent.call(this,"onReady"),this._logger=t.getLogger(g)},_OnTreeComponentReady:function(){var e=this;o.onCurrentLibraryChange((function(t){if(n.libraryStructurePreference.select(this.pathId),this.id&&""!==this.id&&e.dataProvider.isValidType(this.plmType)){for(var i=e.CSOProvider.getCurrentObjectPath(),r=[],o=Array.isArray(i)?i.length:0,a=0;a<o-1;a++)r.push({resourceid:i[a].id,type:i[a].type});var l={};if(o>=1){var c=o-1;i[c].id&&(l[i[c].id]={type:i[c].type,label:i[c].label})}var u=[];t.currentNode&&!e.dataProvider.isSection(t.currentNode.getType())&&(t.currentNode.systemType=i[o-1].type,u=[t.currentNode]),e._libraryTreeView.setObjectOnCompass(u),d.isNatifEnvironnement()||e._libraryTreeView._commandProxy.select({paths:[[this.id]],attributes:l,libraryPath:r,doNotSetOnCompass:!0})}else e.dataProvider.isSection(this.plmType)&&e._libraryTreeView._commandProxy.select({paths:[],attributes:{},libraryPath:[],doNotSetOnCompass:!0});e._libraryTreeView._scrollOnPostUpdateView(t.currentNode);var h=JSON.stringify(e.dataProvider.getSecurityContextAndData());s.publish("LibraryEditor.CurrentLibrary",h)})),o.onExpandTreeAndSelect((function(t){e.expandTreeAndSelectLibrary(t)})),h.getModelEvents().subscribe({event:"select_breadcrumb_object"},(function(t){e.expandTreeAndSelectLibrary({libraryToFindAndSelect:t,onComplete:function(e){console.log(" expandTreeAndSelectLibrary:onComplete")},onGiveUp:function(e){console.log(" expandTreeAndSelectLibrary:onGiveUp")},onFailure:function(e){r.displayNotification({message:e instanceof Error?e.message:e,className:"error"})}})})),o.onTreeSortChange((function(t){if(e.getView()._libraries_TreeView){var i=e.getView()._libraries_TreeView;i.sortModel=[{dataIndex:"tree",sort:"asc"===t.sortOrder?"asc":"desc",sortFunction:e.dataProvider.comparator}],i.reapplySortModel()}})),o.onActivateTreeItem((function(t){var i=t.resourceid,n=t.mxid,o=t.type,s=t.label;i&&e.dataProvider.isValidType(o)?e.expandTreeAndSelectLibrary({libraryToFindAndSelect:{id:i,mxid:n,type:o,name:s},onComplete:function(e){console.log(" expandTreeAndSelectLibrary:onComplete")},onGiveUp:function(e){console.log(" expandTreeAndSelectLibrary:onGiveUp")},onFailure:function(e){r.displayNotification({message:a.replace(a.get("msg_error_LibraryActivate"),{name1:s}),className:"error"})}}):console.log("Selected (Double Clicked) object is not library")})),o.onLibraryRename((function(t){var i=JSON.stringify(t,(()=>{const e=new WeakSet;return(t,i)=>{if("object"==typeof i&&null!==i){if(e.has(i))return;e.add(i)}return i}})()),n=JSON.parse(i).oldNode.id,r=JSON.parse(i).newLabel;e.updateNodeLabel(n,r)}))},updateNodeLabel:function(e,t){var i,n=[],r=UWA.is(e,"string")?e:e.physicalid?e.physicalid:null;(n=r?this._getNodesById(r):[e]).length>0&&t&&(i=t,n.forEach((function(e){if(e.getLabel()!==i){e._lastUpdateTime=Date.now();var t=UWA.extend(e.options,{label:i,oldLabel:i},!0);e.withTransactionUpdate((function(){e.updateOptions(t)}))}})))},_getNodesById:function(e,t){var i=[],n=[],r=this;t?i=[t]:r.getView()._libraries_TreeDocument.getRoots().forEach((function(e){e&&"LibrarySection_favorite"!=e.plmType&&i.push(e)}));return i.forEach((function(t){t.getID()==e&&n.push(t);var i=t.getChildren();UWA.is(i,"array")&&i.forEach((function(t){r._getNodesById(e,t).forEach((function(e){n.push(e)}))}))})),n},destroy:function(){this._logger.log("destroy"),this._parent()},_onPreExpandTreeNode:function(e){var t=e.data.nodeModel;if(!t.preExpandInProgress){t.preExpandInProgress=!0;var i=this,r=t.options.id,o=t.options.id;n.setExpandAllOperation(e.data.expandAll),i.dataProvider.isValidType(t.plmType)&&!t.isFavorite?(t.removeChildren(),n.fetchLibraryContents({parentNodeID:r,parentNodeMXID:o,parentPath:t.pathId},i.dataProvider.expandObject).then((function(e){e&&e.length>0&&i._libraryTreeView._populateContentSection(e,t),null===t.options.children&&(t.options.children=[]),a()}),(function(e){a(),i._logger.log("WebService libraries Err : "+e)}))):i.dataProvider.isPreferenceSection(t.plmType)?(t.removeChildren(),i._refreshFavoriteSection({onComplete:function(){a()}})):i.dataProvider.isSection(t.plmType)?(t.removeChildren(),n.fetchAllLibraries(t.pathId,i.dataProvider.getRootSectionContents).then((function(e){i._libraryTreeView._populateAllLibrariesSection(e,t),a()}),(function(e){a(),i._logger.log("WebService roots Err : "+e)}))):a()}function a(){t.preExpandInProgress=!1,t.preExpandDone(),"expanded"===t.getState()&&t.setState({state:"expanded"})}},_refreshFavoriteSection:function(e){var t=this;t._libraryTreeView._rootNodeFavorite?n.getFavorites(t.dataProvider,{onComplete:function(i){t._libraryTreeView._populateFavoriteSection(i),e&&e.onComplete&&e.onComplete()},onFailure:function(i){t._logger.warn("LibraryTreeCont : unable to initialize list of Favorite Libraries",i),r.displayNotification({message:a.msg_error_nopreferences,className:"error"}),e&&e.onFailure&&e.onFailure(i)}}):(t._logger.log("LibraryTreeCont : LibrarySection_favorite node does not yet exist"),e&&e.onFailure&&e.onFailure(new Error("LibrarySection_favorite node does not yet exist")))},isLibraryAmongFavoriteLibraries:function(e){var t=!1;if(e){var i=this._libraryTreeView._rootNodeFavorite.getChildren();if(i)for(var n=0;n<i.length;++n){if(e==i[n].id){t=!0;break}}}return t},addFavorite:function(e){if(e){var t=this,i=Array.isArray(e)?e:[e];n.setFavorites(t.dataProvider,{favoriteLibraries:i,onComplete:function(e){for(var i=0;i<e.length;++i){var n=e[i];t._libraryTreeView._addFavouriteNode(n);var o=n.label?n.label:"";r.displayNotification({message:a.replace(a.get("msg_info_favoriteadded"),{name1:o}),className:"primary"})}},onFailure:function(e){t._logger.warn("WebService setFavorites Err : "+e)}})}else t._logger.log("LibraryTreeCont unable to addFavorite, newFavoriteLibrary(s) is not define")},addNewNode:function(e){var t=null;e.parentid&&(t=this._getNodesById(e.parentid)[0]);this._libraryTreeView.addNewNode(e,t)},removeFavorite:function(e){for(var t,i=this,s=!1,l=i._libraryTreeView._rootNodeFavorite.getChildren(),d=Array.isArray(l)?l.length:0,c=0;c<d;++c){var u=l[c];if(e.id==u.id){s=u.isSelected(),t=e.name?e.name:"",i._libraryTreeView._rootNodeFavorite.removeChild(u),!1===i._libraryTreeView._rootNodeFavorite.hasChildren()&&i._libraryTreeView._rootNodeFavorite.withTransactionUpdate((function(){i._libraryTreeView._rootNodeFavorite.removeChildren(),i._libraryTreeView._rootNodeFavorite.setState({state:"collapsed"})}));break}}var h="";i.CSOProvider.getCurrentObject()&&(h=i.CSOProvider.getCurrentObject().getType()),i.dataProvider.isPreferenceSection(h)&&o.notifyRemoveNodeInContent(e.id),n.removeFromFavorites(i.dataProvider,{favoritesToRemove:e.id,onComplete:function(e){e||o.notifyFavoriteSectionEmpty(),r.displayNotification({message:a.replace(a.get("msg_info_favoriteremoved"),{name1:t}),className:"primary"}),s&&i._libraryTreeView._rootNodeFavorite.select()},onFailure:function(e){i._logger.warn("WebService getFavorites Err : "+e),r.displayNotification({message:a.msg_error_nopreferences,className:"error"})}})},renameFavorite:function(e,t,i){var s=this;function l(e,t){e.prepareUpdate(),e.setLabel(t),e.pushUpdate()}function d(){i&&l(i,e.name),r.displayNotification({title:a.replace(a.get("msg_error_rename").title,{name1:e.name}),subtitle:a.msg_error_rename.subtitle,className:"error"})}n.getFavorites(s.dataProvider,{onComplete:function(c){for(var u,h=c,g=0,f=0;f<h.length;++f)if(u=h[f],e.id==u.physicalid){u.label=t,g=1;break}g?n.setFavorites(s.dataProvider,{favoriteLibraries:[{id:u.physicalid,name:u.label}],renamed:!0,onComplete:function(n){i&&i._instanceType&&"LibraryEditor/TreeNodeModel"==i._instanceType||s._libraryTreeView._rootNodeFavorite.getChildren().forEach((function(i){i&&e.id==i.id&&l(i,t)}));r.displayNotification({message:a.replace(a.get("msg_info_favoriterenamed"),{name1:e.name,name2:t}),className:"primary"}),o.notifyLibraryRename({oldNode:e,newLabel:t})},onFailure:function(e){s._logger.warn("WebService setFavorites Err : "+e),d()}}):(s._logger.warn("LibraryTreeCont favorite library to rename, not found in list"),d())},onFailure:function(e){s._logger.warn("WebService getFavorites Err : "+e),r.displayNotification({message:a.msg_error_nopreferences,className:"error"}),d()}})},expandTreeAndSelectLibrary:function(e){var t=e&&e.libraryToFindAndSelect?e.libraryToFindAndSelect.id:void 0,i=this;if(t){var r=i._getVisibleNodeById(t,null);if(r){i.CSOProvider.getCurrentObject();if(e.doNotSelectInTree?i.CSOProvider.addInCSO(r,"TREE"):(i._libraryTreeView._scrollToVisibleNode(r),r.select(!0)),e.onComplete){var o={libraryToFindAndSelect:e.libraryToFindAndSelect,correspondingTreeNodeModel:r};e.onComplete(o)}}else{var s=i.CSOProvider.getCurrentObject(),l=i.CSOProvider.getCurrentObjectPath(),d=l.length;if(1===d&&i.dataProvider.isPreferenceSection(l[0].type)||e.isInvisible||c.isSearchActive())n.getLibraryPathLength(i.dataProvider.getObjectPathLength,{pid:t,onComplete:function(e){d=e,f()},onFailure:function(e){}});else if(1===d&&i.dataProvider.isSection(l[0].type)){var u="root,"+l[0].type,h=u+","+t;n.libraryStructurePreference.add(u),n.libraryStructurePreference.select(h),n.libraryStructurePreference.scrollAfterSelect(t),n.libraryStructurePreference.remove(h);var g=i._libraryTreeView._rootNodeLibraries;"expanding"!==g.getState()&&g.expand()}else f()}}else i._logger.log("expandTreeAndSelectLibrary error : libraryToFindAndSelect is undefined"),e.onFailure&&e.onFailure(new Error("Tree exploration stopped, libraryToFindAndSelect is undefined"));function f(){n.getLibraryPath(i.dataProvider.getObjectPath,{depth:d,pid:t,onComplete:function(r){if(!function(e){var t=!1;if(i.CSOProvider.getCurrentObject()!==s&&(t=!0,e.onGiveUp)){var n={libraryToFindAndSelect:e.libraryToFindAndSelect};e.onGiveUp(n)}return t}(e))if(i._libraryTreeView._rootNodeLibraries){var o=null,l=null,d=i._libraryTreeView._rootNodeLibraries,c=d.pathId;i.dataProvider.resetFilterIfNodeIsNotCompliant&&i.dataProvider.resetFilterIfNodeIsNotCompliant(r);for(var u=0;u<r.length;++u){var h=r[u],g=h.physicalid;if(i.dataProvider.isRoot(h)&&(l=g),g){if(!o){var f=i._getVisibleNodeById(g,d);f&&f.isVisible()?(d=f,c=f.pathId):o=d}if(o){var p=c;n.libraryStructurePreference.add(p),d=null,c=c+","+g}}else i._logger.log("unexpected undefined parentObjectId")}if(l)if(o){var _=p+","+t;if(e.doNotSelectInTree?(n.libraryStructurePreference.select(""),n.libraryStructurePreference.scrollAfterSelect(""),i._TreeNodeToBeAddedtoLibraryCSOWithoutSelection_pathId=_):(n.libraryStructurePreference.select(_),n.libraryStructurePreference.scrollAfterSelect(t)),n.libraryStructurePreference.remove(_),"expanding"!==o.getState()&&o.expand(),e.onComplete){var m={libraryToFindAndSelect:e.libraryToFindAndSelect};e.onComplete(m)}}else console.log("   Damnation, no firstUnexpandedTreeNodeModelParentFound"),e.onFailure&&e.onFailure(new Error(a.msg_error_TreeExpandCancelledInternalError));else e.onFailure&&e.onFailure(new Error(i.dataProvider.getObjectNotVisiblemessage()))}else i._logger.log("  No LibrarySection_AllLibraries to start expandTreeAndSelectLibrary"),e.onFailure&&e.onFailure(new Error(a.msg_error_TreeExpandCancelledNotReady))},onFailure:function(t){i._logger.log("WebService getLibraryPath Err : "+t),e.onFailure&&e.onFailure(t)}})}},_getVisibleNodeById:function(e,t){var i=t||this._libraryTreeView._rootNodeLibraries,n=null;if(i&&i.isVisible())if(i.getID()===e)n=i;else if(i.isExpanded()){var r=i.getChildren();if(Array.isArray(r)&&r.length>=1)for(var o=0;o<r.length;o++){var a=r[o];if(a){if(a.id==e){n=a;break}var s=this._getVisibleNodeById(e,a);if(s&&s.isVisible()){n=s;break}}}}return n},refreshLibraryTree:function(){var e=this;e._libraryTreeView._rootNodeFavorite.isExpanded()&&(e._libraryTreeView._rootNodeFavorite.collapse(),e._libraryTreeView._rootNodeFavorite.expand()),e._libraryTreeView._rootNodeLibraries.isExpanded()&&(e._libraryTreeView._rootNodeLibraries.collapse(),e._libraryTreeView._rootNodeLibraries.expand())},switchLibraryTreeNodeLabelToWriteView:function(e){var t=!1;if(e.getTreeDocument()===this._libraryTreeView._libraries_TreeDocument&&this._libraryTreeView._libraries_TreeView){var i=this._libraryTreeView._libraries_TreeView;if(i){var n=i.getCell(e._getRowID(),"tree"),r=n?n.getView():void 0;r&&(r.switchToWriteView(),t=!0)}}return t},getView:function(){return this._libraryTreeView},performOperationOnNode:function(e,t){e[t]()}});return g})),define("DS/IPClassifyUX/views/LibraryContentView",["UWA/Core","DS/WebappsUtils/WebappsUtils","DS/ENOIPClassify/IPClassifyComponent","DS/IPClassifyNav/models/xNavNodeModel","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/models/LibrarySearchModel","DS/UIKIT/Mask","DS/UIKIT/Native/Dropdown","DS/WidgetServices/WidgetServices","DS/IPClassifyUtil/IPClassifyCommunication","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/views/LibraryPlaceHolder","DS/IPClassifyUtil/IPContext","DS/IPClassifyUX/service/LibraryDnDService","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/Controls/TabBar","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUtil/IPClassifyPreference","DS/Menu/ContextualMenu","DS/Controls/Loader","DS/Controls/ModalContainer"],(function(e,t,i,n,r,o,a,s,l,d,c,u,h,g,f,p,_,m,b,v,C){"use strict";var y=null,S=null;let P=!1,w=null;var T="ipcColumnSort_v1";return i.extend({name:"LibraryContentView",defaultOptions:{x3dAppId:"LibraryEditor",amd_custo:{TreeDocument:"DS/IPClassifyUX/views/LibraryTreeDocumentView",DataGridView:"DS/IPClassifyUX/views/LibraryDataGridView",TileGridView:"DS/IPClassifyUX/views/LibraryTileGridView",ThumbnailGridView:"DS/IPClassifyUX/views/LibraryThumbnailGridView"},active_view:"datagridview",layout:{keyboard_inputs:!1,root_panel:!1,action_bar:!1,statusInfo:!1,slidder:!1,title_update:!1,drop_invite:"none",triptychOpts:{borderLeft:!0,left:{withClose:!1,originalState:"close"},right:{withClose:!0}},amdTreeView:"datagridview"}},_contentDiv:null,_isEditable:null,init:function(e){var t=this;if(this._contentDiv=e.renderTo,this.leftTriptychElem=e.leftTriptychElem,widget.TreeDocumentCSOProvider=this.CSOProvider=e.CSOProvider,widget.TreeDocumentDataProvider=this.dataProvider=e.dataProvider,this.showBreadcrumb=e.showBreadcrumb,this.DnDProvider=e.DnDProvider,this.placeholderData=e.placeholderData,t._columnsCache={},e._libraryBreadcrumbView&&(this._libraryBreadcrumbView=e._libraryBreadcrumbView),this._isEditable=e.dataProvider.checkEditable?e.dataProvider.checkEditable:null,y=e.dataProvider.getContextualMenu,e.DisabledDropInvit=!0,e.layout&&e.layout.view_customization&&e.layout.view_customization.columnsOptimized){var i=t.removeClassAttrsFromColumnCusto(e.layout.view_customization.columnsOptimized);e.layout.view_customization.columnsOptimized=i}(l.isNatifEnvironnement()||this.dataProvider.showContentPlaceholder&&this.dataProvider.showContentPlaceholder(this.leftTriptychElem)&&(t._placeHolder=new u({commandContext:this}),t._gridPlaceHolder=new u({commandContext:this})),this.dataProvider.refreshOnLBCDelete)&&require("DS/PADServices/utils/GlobalModelEvents").subscribe({event:"IPClassify/LBCDelete"},this.dataProvider.refreshOnLBCDelete);this.setOptions(e),this._parent(this.options),require(["DS/PADUtils/views/PADStatusInfos"],(function(e){t.elements.padstatus=new e({renderTo:t._contentDiv,events:{onShow:function(){t.elements.padstatus.setStatus(e.buildStatus({tree_content:{nbObjectsInTree:t.options.model.getAllDescendants().length,nbObjectsSelected:t.options.model.getSelectedNodes().length}}))}}})}))},createRootListSlidder2:function(){return this.leftTriptychElem},showBreadCrumb:function(){this._libraryBreadcrumbView.showBreadCrumb(this.elements)},addTabPages:function(){var e=this;if(this.dataProvider.getPageTabs){var t=this.elements.container.querySelector(".xnav_viewmain");this.elements.pageTab_container=UWA.createElement("div",{class:"LibraryEditor_pageTab"}).inject(t);var i=new p({displayStyle:"strip"});i.inject(this.elements.pageTab_container);var n=this.dataProvider.getPageTabs();for(var o in n)i.add(n[o]);i.addEventListener("tabButtonClick",(function(t){t&&t.options&&(_.setCurrentTab(t.options.value),e._lastTabID=t.options.value,r.notifyContentTabChange())})),this.elements.pageTab_container.hide()}},setFilterModel:function(e){e&&this.getPADTreeDocument().setFilterModel(e)},setTabsVis:function(e){if(this.dataProvider.getPageTabs&&this.elements.pageTab_container){var t=!this.elements.pageTab_container.isHidden();if(this.dataProvider.rebuildTabPages&&this.dataProvider.rebuildTabPages()&&e)_.setCurrentTab(_.getCurrentSubTab()),this.elements.pageTab_container.remove(),this.addTabPages(),this.elements.pageTab_container.show();else{if(t===e)return;e&&(this.elements.pageTab_container.show(),_.setCurrentTab(_.getCurrentSubTab()))}e||(this.elements.pageTab_container.hide(),_.setCurrentTab()),this.setTabStyleOnView(),this.loadNewColumns()}},setTabStyleOnView:function(){if(this.dataProvider.getPageTabs){var e=null;(e="datagridview"===this.getActiveView()?this.elements.container.querySelector(".LibraryDataGridView"):this.elements.container.querySelector(".wux-layouts-responsivecollectionview"))&&e.setStyle("top",this.elements.pageTab_container.clientHeight)}},_addStyleOnTreeCont:function(e){var t=this.elements.padshell._getLeftWidth();t=e&&e>t?e:t,l.addNewStyles("treeContResize",{".LibraryTreeView-root_container":{overflow:"hidden"},".LibraryTreeView-root_treeview_container":{width:t+"px !important"}},!0)},removeClassAttrsFromColumnCusto:function(e){for(var t=[],i=0;i<e.length;++i)-1==e[i].dataIndex.indexOf("attribute[")&&t.push(e[i]);return t},saveSortModelInCache:function(){if(this.dataProvider.getPageTabs){this._currentSortModel||(this._currentSortModel={});var e=this.getPADTreeListView().getManager(),t=e.sortModel;if(t&&t.length>0&&null!=t[0].dataIndex&&null!=t[0].dataIndex){var i=_.getWidgetData();if(e.layout.getLeafColumns()[e.layout.getColumnIndex(t[0].dataIndex)]){this._currentSortModel[i.currentTab]=e.sortModel;var n=T+(0==i.currentWidgetTab?i.currentTab:"exceptions_tab");m.set(n,e.sortModel,!0)}}}},setSortOnColumn:function(){var e=this;return new Promise((function(t,i){if(e.dataProvider.getPageTabs){e._loadedColTabs||(e._loadedColTabs={});var n=_.getWidgetData();if(e._loadedColTabs[n.currentTab])e.getPADTreeListView().setColumnOrderState(e._currentSortModel[n.currentTab]),t();else{e._loadedColTabs[n.currentTab]=!0;var r=T+(0==n.currentWidgetTab?n.currentTab:"exceptions_tab");m.get(r,(function(i){var n=e.getPADTreeListView().getDefaultSortModel();Object.keys(i).length&&(n=i),e.getPADTreeListView().setColumnOrderState(n);var r=e.getPADTreeListView().getManager().sortModel;n.dataIndex==r.dataIndex&&n.sort==r.sort&&e.saveSortModelInCache(),t()}),!0)}}else t()}))},loadNewColumns:function(){if("datagridview"===this.getActiveView()){var e=this,t=e.getPADTreeListView().getManager(),i=_.getWidgetData();this._currentSortModel||(this._currentSortModel={}),e.removeAllColumns();for(var n=e.dataProvider.getColumnConfig(i),r=0;r<n.length;++r)e._columnsCache[n[r].dataIndex]?t.addColumnOrGroup(e._columnsCache[n[r].dataIndex]):t.addColumnOrGroup(n[r]);e.setSortOnColumn()}},removeAllColumns:function(){for(var e=this.getPADTreeListView().getManager(),t=e.layout.getLeafColumns(),i=0;i<t.length;++i)"tree"!==t[i].dataIndex&&(this._columnsCache[t[i].dataIndex]=t[i],e.removeColumnOrGroup(t[i].dataIndex))},cleanColumns:function(){for(var e=this.getPADTreeListView().getManager().layout.getLeafColumns(),t=[],i=[],n=0;n<e.length;++n)e[n].isDynamic&&(t.push(e[n].dataIndex),i.push(e[n]));this.getPADTreeListView().removeColumnCB(i),this.getPADTreeListView().removeColumnPreferences(t)},toShowThumbnail:function(e){return!this._isTreeViewType()||this.getPADTreeListView().isColumnAvailable(e)},_addCtxItem:function(e,t,i){var n=this;if("DS/ResultWebInWin/ResultWebInWinAction"==t.sourcejs){let r=t.image,o=i&&i[r]?i[r]:"",a={type:"PushItem",title:t.title,icon:o,action:{callback:()=>{n.CSOProvider.getSelectedNodes();var e=n.CSOProvider.getSelectedNodesID();d.publish("onActionContextualMenu",{header:t.id,ids:e,repeatMode:n.dataProvider.getRepeatMode?n.dataProvider.getRepeatMode():null})}}},s=[];t.items&&(t.items.forEach((e=>{this._addCtxItem(s,e)})),a.submenu=s),e.push(a)}},showWebInWinCtxMenu:function(e,t){var i=t;if(i&&i.actions){var n=[];i.actions.forEach((e=>{e.actions&&e.actions.forEach((e=>{this._addCtxItem(n,e,t.images)}))})),this._initDropDown(n)}},_initDropDown:function(e){if(!S)return;P=!0;let t=b.addEventListener(S,{callback:function(){return e}});b.buildAndDisplayContextualMenu(S,{clientX:w.x,clientY:w.y}),b.removeEventListener(S,t),P=!1},setLibraryCommunicationChannel:function(){},getOnContextualEvent:function(){return{this:this,callback:function(e){var t=this;return new Promise((function(i){t.onContextualMenuReady(e).then((function(e){i(e)}))}))}}},onContextualMenuReady:function(e){var t=e.cellInfos;e.data&&(S=e.data.target),null==t&&(t={}),e.data&&e.data.event&&(w={x:e.data.event.pageX,y:e.data.event.pageY});var i={};t.cellView?t.rowID?i.virtualRowID=t.rowID:i.virtualRowID=1:t.white_Click=!0;var n=t.nodeModel,r=!0;return-1===i.virtualRowID&&(r=!1),P?Promise.resolve([]):new Promise((function(o,a){var s;if(r&&l.isNatifEnvironnement()&&!l.isWebInWinEnvironment())d.publish("Create_ContextMenu",{ids:n?[n.id]:[]}),n&&!1===n.isSelected()&&n.select(!0),o(s);else{if(y||o(s),t.white_Click&&e&&e.treeview){var c=e.treeview?e.treeview.manager.getScroller():null;if(c&&e.data.target!=c.getContent())return}n&&"Busy"===n.plmType&&o(s);var u=_.getWidgetData(),h=!1;t.white_Click||-1===i.virtualRowID?h=!0:n&&(!1===n.isSelected()&&n.select(!0),!0===n.isSelected()&&(h=!0)),h&&y(t,"CONTENT",u,e).then((function(e){e.forEach((function(e){"separator"===e.type||"SeparatorItem"===e.type?e.type="SeparatorItem":e.label&&(e.title=e.label,e.action={callback:e.callback},e.type="PushItem")})),o(e)}))}}))},getActiveView:function(){return this._parent()},getPADTreeListView:function(){return this.options.views.datagridview},getPlaceHolder:function(){return this._gridPlaceHolder},enableTreeColumnEdit:function(e){return this.options.views.datagridview.setTreeColumnEditable(e)},removeNodesInContent:function(){var e=this.getPADTreeDocument();if(e){var t=e.getRoots(!0).slice(0);e.wrapInTransaction((function(){e.withTransactionUpdate((function(){var i,n=t.length;for(e.unselectAll(),i=0;i<n;++i)e.removeRoot(t[i],!0,!1)}))}))}},getSortingOrder:function(e){return"datagridview"===this.options.active_view?this.getPADTreeListView().getSortingOrder(e):"tileview"===this.options.active_view?this.getPADTileGridView().getSortingOrder(this.dataProvider):"thumbnailview"===this.options.active_view?this.getPADThumbnailGridView().getSortingOrder(this.dataProvider):void 0},setSortingForComputedAttrs:function(){this.getPADTreeListView().setSortingForComputedAttrs()},displayDynamicAttributes:function(e,t,i){var n=this;0==i||n.cleanColumns();var r=e.dynamicattributesName,o=e.dynamicattributesForUIView,a=e.dynamicattributes,s=e.dynamicattributesType;let l=e.dynamicattributesIndex;var d=e.dynamicattributesValueType,c=(e.dynamicattributesUnit,e.dynamicattributesRange?e.dynamicattributesRange:null),u=e.convUnitInfos,h=[];if(u&&(h=u.attrsToConvert),!n._isTreeViewType()||!r||r.length<1||!o||o.length<1)return new Promise((function(e){e()}));var g=n.getPADTreeListView(),f={};let p=[];for(var _=0;_<r.length;++_)if(null!=r[_]&&null!=r[_]){if(!t){if(f[a[_]])continue;f[a[_]]=a[_]}var m=this.getPADTreeListView().getManager(),b={dataIndex:a[_],text:o[_],width:"auto",minWidth:30,isVisible:!0,isDynamic:!0,editableFlag:!0,dbAttribute:r[_],customisation:{layout:{removable:!1,removableFromView:!1,pinEditable:!1,movable:!1},exportable:{lock:!0,value:!1}},dynamicattributesIndex:l?l[_]:l,getCellEditableState:function(e){var t=!!e.nodeModel&&e.nodeModel.plmType,i=!1;if(t&&e.nodeModel.options){var r=e.nodeModel.options;i=r.grid["ds6w:reserved"]?r.grid["ds6w:reserved"]:!(!r.padgrid||!r.padgrid["ds6w:reserved"])&&r.padgrid["ds6w:reserved"]}return!!n._isEditable&&n._isEditable(t,i)}};"multiline"==s[_]?(b.typeRepresentation="editor",b.editionPolicy="EditionOnOver"):b.typeRepresentation=s[_];a[_];c&&n._isEditable&&c[_].length>0&&"multival"!==d[_]&&(b.editionPolicy="EditionOnClick",b.hasNLS=!1,b.getCellSemantics=function(e){if(e&&e.nodeModel){var t=m.layout.getDataIndexFromColumnIndex(e.columnID);let o=[];var i=n.dataProvider.getDeprecatedRangeValues[e.nodeModel.options.physicalid][t],r=n.dataProvider.dynamicAttributeRangeNlsMap[t];if(r){for(let e in r)o.push({label:r[e].label,value:r[e].value,icon:r[e].icon});if(i&&i.length>0)for(let e in i)o.push({label:i[e].label,value:i[e].value,icon:i[e].icon});return{possibleValues:o}}}},b.typeRepresentation="string"),d&&"multival"==d[_]&&(b.typeRepresentation="string",c&&n._isEditable&&c[_].length>0?(b.hasNLS=!1,b.getCellSemantics=function(e){if(e&&e.nodeModel){var t=m.layout.getDataIndexFromColumnIndex(e.columnID);let o=[];var i=n.dataProvider.getDeprecatedRangeValues[e.nodeModel.options.physicalid][t],r=n.dataProvider.dynamicAttributeRangeNlsMap[t];if(r){for(let e in r)o.push({label:r[e].label,value:r[e].value,icon:r[e].icon});if(i&&i.length>0)for(let e in i)o.push({label:i[e].label,value:i[e].value,icon:i[e].icon})}return{allowMultipleValuesFlag:!0,possibleValues:o}}}):n._isEditable&&(b.editionPolicy="EditionOnClick",b.semantics={allowMultipleValuesFlag:!0}));var v={};if(h.indexOf(r[_])>-1){v.dimension=u[r[_]+".dimension"];var C=u[r[_]+".manipulationUnit"];C&&C.length>0&&(v.manipulationUnit=C),b.convertInfos=v}p.push(b)}return new Promise((function(e){g.addColumnCB(p).then((function(){e()}))}))},_getColumnOptions:function(e){var t,i=this.getPADTreeListView().getManager()?this.getPADTreeListView().getManager().layout:null;if(i){var n=i.getColumnIndex(e);if(n>-1)t=i.getLeafColumns()[n]}return t},displayContentNodes:function(e,i,r,o,a){var s=this;o&&s.removeNodesInContent();var l=[],d=[];e.forEach((function(e){var o=null;i&&i.forEach((function(t){(t.id||t.getID())===e.id&&(o=t)}));s.getPADTreeListView();if(null==o){var a=e,c=new n(a);if(s._isEditable&&s.dataProvider.getAttributesInfo){var u=s.dataProvider.getAttributesInfo().rangeAttributes,h={},g=s.dataProvider.getAttributesInfo().predicates,f=function(e){const t={};for(const[i,n]of Object.entries(e))t[n]=i;return t}(g),p=Object.keys(g);if(u){s.dataProvider.getDeprecatedRangeValues[c.options.physicalid]={};for(let e in u)if(u.hasOwnProperty(e)){var _=f[e],m=c.options.grid[_];m&&(Array.isArray(m)?m.forEach((t=>{u[e][t]||(s.dataProvider.getDeprecatedRangeValues[c.options.physicalid][_]=[],s.dataProvider.getDeprecatedRangeValues[c.options.physicalid][_].push({label:t+"    (Deprecated)",value:t,icon:{iconName:"attention",className:"warningIconColor"}}))})):u[e][m]||(s.dataProvider.getDeprecatedRangeValues[c.options.physicalid][_]=[],s.dataProvider.getDeprecatedRangeValues[c.options.physicalid][_].push({label:m+"    (Deprecated)",value:m,icon:{iconName:"attention",className:"warningIconColor"}})))}}if(p.length>0)for(var b=0;b<p.length;b++)h[p[b]]=e.grid[p[b]];c.attributeValue=h}if(c.options.grid.thumbnail="url("+a.thumbnail+")",c.plmType=a.plmType,c.id=a.physicalid,c.mxid=a.mxid,a.status?c.options.status=a.status:c.options.status=a.grid["ds6w:status"],a.usage&&(c.options.usage=a.usage),c._ischeckout=e.Documentlocked,"TRUE"===c._ischeckout){var v=t.getWebappsAssetUrl("LibraryEditor","icons/32/I_CheckOutDocument.png");c.updateOptions({badges:{bottomRight:v}})}if("TRUE"===e.publishOnConnect){var C=t.getWebappsAssetUrl("LibraryEditor","icons/libraryPublishBadge.png");c.updateOptions({badges:{bottomRight:C}})}s.dataProvider.setIconsForLibraries&&s.dataProvider.setIconsForLibraries(c,s.getActiveView()),c.options.oldLabel=a.label,c._manageNLS=c.options._manageNLS=!0,l.push(c),"Attribute"!=c.plmType&&(UWA.is(r,"array")?r.indexOf(c.id)>=0:c.id===r)&&d.push(c)}else{l.push(o),roots_PS_toRefresh.push(o);var y=o.id||o.getID();(UWA.is(r,"array")?r.indexOf(y)>=0:y===r)&&d.push(o)}})),s._endRefreshAndAddNodes(d,l);var c=null;return d.length>0&&(c=d[d.length-1],a&&s.dataProvider.getTreeCellEditionValue&&1==s.dataProvider.getTreeCellEditionValue(d)&&s._defaultEnableNameEdit(d[d.length-1])),s._sortContent(),c},_defaultEnableNameEdit:function(e){setTimeout(function(){this._switchNameToEdit(e)}.bind(this),1e3)},_switchNameToEdit:function(e){try{var t=this.getPADTreeListView().getManager(),i=t.layout.getColumnIndex("tree"),n=t.layout.getCellsFromNodeModel(e)[i];t.scrollToCellAt({cellID:n});t.getCellInfosAt(n);t.setCellInEdition(n)}catch(e){}},_sortContent:function(){this.getPADTreeDocument()._getTrueRoot().sortChildren({isRecursive:!0,sortFunction:this.dataProvider.comparator})},displayFavouriteNodes:function(e,t){var i=this;i.removeNodesInContent();var r=[],o=[];e.forEach((function(e){var a=new n(e);a.plmType=e.plmType?e.plmType:"Library",a.id=e.physicalid,a.isFavorite=!0,a.options.oldLabel=e.label,a.options.status=e.grid["ds6w:status"],a.options.grid.thumbnail="url("+e.thumbnail+")",i.dataProvider.setIconsForLibraries&&i.dataProvider.setIconsForLibraries(a,i.getActiveView()),a.options.physicalid=e.physicalid,a.options.mxid=e.mxid,a.options.type=e.type,a._manageNLS=!0,(UWA.is(t,"array")?t.indexOf(e.physicalid)>=0:e.physicalid===t)&&o.push(a),r.push(a)})),i._endRefreshAndAddNodes(o,r)},_endRefreshAndAddNodes:function(e,t){var i=this;i._isTreeViewType()&&i._listenEndUIRefreshEvent(),i.addRootNodes(t),i._endRefreshView(),e.length>0&&e.forEach((function(e){e.select()}))},_isTreeViewType:function(){return"datagridview"===this.getActiveView()&&null!==this.getPADTreeListView()},_endLoadAndSelect:function(){var e=this.CSOProvider.getCurrentObject();null==e||e.noTree||r.notifyUpdateSearchVisibility(e)},_endContentSelect:function(){this.contentHandleRequest=null,this.infiniteScrollDone()},infiniteScrollDone:function(){var e=this.getActiveView();if("datagridview"===e){var t=this.getPADTreeListView(),i=t?t.getManager():null;i&&i.infiniteScrollProcessDone()}else{var n=null;"tileview"===e?n=this.getPADTileGridView().options.grid:"thumbnailview"===e&&(n=this.getPADThumbnailGridView().options.grid),n&&n.infiniteScrollProcessDone()}},_listenEndUIRefreshEvent:function(){var e=this.getPADTreeListView();e&&e.getManager().onPostUpdateViewOnce((function(){this.elements.columnsHeaderContainer&&this.elements.columnsHeaderContainer.setStyle("left",0)}))},maskContentDiv:function(e){var t=this._contentDiv,i=t;t&&(i=t.getElement(".xnav_viewmain")),e?a.mask(i):a.isMasked(i)&&a.unmask(i)},webUXLoader:function(e,t){null!=t&&(this.attributePanelLoader=new v({text:t,showButtonFlag:!1})),e?(this.isLoaderActive=!0,this.attributePanelLoader.on(),C.createModal(widget.body,this.attributePanelLoader)):(C.removeModal(widget.body),this.isLoaderActive&&this.attributePanelLoader.off())},checkLoaderActive:function(){return!!this.isLoaderActive},_endRefreshView:function(){this.maskContentDiv(!1),null==this.CSOProvider.getCurrentObject()||this.CSOProvider.getCurrentObject().noTree||this.dispatchEvent("onCompleteRefreshNodes",this.CSOProvider.getCurrentObject().getID()),this.CSOProvider.getCurrentObject().noTree&&this.dispatchEvent("onCompleteRefreshNodes",null),l.isWebInWinEnvironment()&&d.publish("onLibraryEditorUIReady","")},removeNodeInContent:function(e){var t=this.getPADTreeDocument();t.getRoots().forEach((function(i){(i.id||i.getID()||"Attribute"===i.plmType&&i.getLabel())===e&&t.removeRoot(i)}))},onDragStartCell:function(t,i){if(!this.DnDProvider.shouldAcceptDrag()||!e.is(i)||!0===i.isHeader)return t.preventDefault(),void t.stopPropagation();g.setDragData(t,i,this.CSOProvider,this.dataProvider)},onDragOverBlank:function(e){this._onDragOver(e)},onDragOverCell:function(e){this._onDragOver(e)},onDragOverColumnHeader:function(e){this._onDragOver(e)},_onDragOver:function(e){return e.preventDefault(),!0},onDropCell:function(e,t){if(this.dataProvider.isDNDSupported()){var i=t.nodeModel;this.DnDProvider.shouldAcceptDrop(i)?(g.performDropOnLibraryEditorNode(i,e,this.DnDProvider),e.preventDefault(),g.cleanDragData()):this.onDropBlank(e,t)}else c.displayNotification({message:f.msg_warning_dndnotsupported,className:"warning"})},onDropBlank:function(e,t){if(this.dataProvider.isDNDSupported()){var i=this.CSOProvider.getCurrentObject();if(i&&this.DnDProvider.shouldAcceptDrop()){try{g.performDropOnLibraryEditorNode(i,e,this.DnDProvider)}catch(e){c.displayNotification({message:f.msg_warning_dndnotsupported,className:"warning"})}e.preventDefault(),g.cleanDragData()}else c.displayNotification({message:f.msg_warning_dndnotsupported,className:"warning"}),e.preventDefault()}else c.displayNotification({message:f.msg_warning_dndnotsupported,className:"warning"})},onDropColumnHeader:function(e,t){return g.cleanDragData(),!0},_addPlaceHolder:function(){if(!l.isNatifEnvironnement()&&this.dataProvider.showContentPlaceholder&&this.dataProvider.showContentPlaceholder(this.leftTriptychElem)){var e=this,t=e.getActiveView(),i=o.isSearchActive(),n=e.CSOProvider.getCurrentObject().noTree?e.CSOProvider.getCurrentObject():e.CSOProvider.getCurrentObject().getType();if("datagridview"!==t){if((!i||i&&this.dataProvider.showSearchPlaceHolder&&this.dataProvider.showSearchPlaceHolder())&&("Library"===n||n.noTree)){var r;"tileview"===t?r=e.getPADTileGridView().options.grid.elements.scroller:"thumbnailview"===t&&(r=e.getPADThumbnailGridView().options.grid.elements.scroller);var a=r?r.getContent():null;a&&e._placeHolder&&e._placeHolder.elements.container.inject(a)}}else{var s=e.getPADTreeListView().getDatagridPlaceHolder()?e.getPADTreeListView().getDatagridPlaceHolder().getContent():null;s&&(i?i&&this.dataProvider.showSearchPlaceHolder&&this.dataProvider.showSearchPlaceHolder()&&s.isHidden()&&s.show():s.isHidden()&&s.show())}}},removePlaceHolder:function(){if(!l.isNatifEnvironnement()&&(this.dataProvider.showContentPlaceholder&&this.dataProvider.showContentPlaceholder(this.leftTriptychElem)))if("datagridview"!==this.getActiveView()){var e=document.querySelectorAll(".content-placeholder");if(e&&e.length>0){var t=Array.prototype.slice.call(e);t&&t.forEach((function(e){e.remove()}))}}else{var i=this.getPADTreeListView().getDatagridPlaceHolder()?this.getPADTreeListView().getDatagridPlaceHolder().getContent():null;i&&(i.isHidden()||i.hide())}}})})),define("DS/IPClassifyUX/views/LibrarySearchWithinView",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","DS/IPClassifyUX/utils/LoadCssUtil","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/WebappsUtils/WebappsUtils","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/ComboBox","DS/Controls/Popup","DS/Controls/LineEditor","UWA/Date","DS/Controls/DatePicker","DS/IPClassifyUX/models/LibrarySearchModel","DS/IPClassifyUtil/IPClassifyAlert"],(function(e,t,i,n,r,o,a,s,l,d,c,u,h,g,f,p,_,m,b){"use strict";return t.extend(i,n,{name:"LibrarySearchWithinView",_searchInNode:null,_librarySearchWithinDialog:null,_title:l.advance_search_within_title+" ",_output:{},_outputArr:[],_conditionNode:function(e,t){this.value=e,this.id=t},_id:0,_singleConditionId:null,_logicalOperator:"AND",_eachGroupLogicalOperator:{},_setVisible:!1,_titleContainer:null,_bodyContainer:null,_queryBuilderContainer:null,_restrictQueryContainer:null,_blockButtonContainer:null,_andOrBlockContainer:null,_selectAllorany:null,_currentDateTime:null,_attributesInfo:null,_classificationAttributePredicates:{},_nlsUnitData:null,init:function(e){var t=this;t._parent(e),this.CSOProvider=e.CSOProvider,this.dataProvider=e.dataProvider,this._classificationAttributePredicates=e._classificationAttributePredicates,this._attributesInfo=e._attributesInfo,this._nlsUnitData=e._nlsUnitData;var i=s.getWebappsAssetUrl("IPClassifyUX","css/LibrarySearchWithin.css");r._loadCSS(i),t._singleConditionId=new Set,t._singleConditionId.add(t._id),t._conditionNode.prototype.updateValue=function(e,t){this.value=e,this.id=t},t._conditionNode.prototype.getValue=function(){return this.value},t._buildUI()},_buildUI:function(){var t=this;let i=t.CSOProvider.getCurrentObject().getLabel();var n=document.querySelectorAll(".LibrarySearchWithinView");if(n&&n.length>0){var r=Array.prototype.slice.call(n);r&&r.forEach((function(e){e.remove()}))}t._titleContainer&&t._bodyContainer&&t._restrictQueryContainer&&t._blockButtonContainer&&t._andOrBlockContainer&&t._queryBuilderContainer||(t._bodyContainer=new UWA.createElement("div",{class:"searchWithinBody"}),t._titleContainer=new UWA.createElement("div",{class:"searchWithinTitle",text:t._updateSearchInNode(i)}),t._restrictQueryContainer=new UWA.createElement("div",{class:"restrictQueryContainer"}),t._blockButtonContainer=new UWA.createElement("div",{class:"blockButtonContainer"}),t._queryBuilderContainer=new UWA.createElement("div",{class:"queryBuilderContainer",id:"queryBuilderContainer"})),e.is(this.elements.container)||(this.elements.container=UWA.createElement("div",{class:this.getClassNames()}),t._librarySearchWithinDialog=new c({activeFlag:!1,resizableFlag:!0,domId:"librarySearchWithinDialog",modalFlag:!0,position:{my:"center",at:"center"},height:400,width:800,buttons:{Cancel:new u({onClick:function(e){const i=t._output;for(var n=Object.getOwnPropertyNames(t._output),r=0;r<n.length;r++)delete i[n[r]];t._librarySearchWithinDialog.close()}}),Yes:new u({label:l.get("advance_search_within_text_search"),onClick:function(e){let i=Object.keys(t._output);const n=t._output;let r=" ";var o=0;for(let e of i)if(++o,n[e]instanceof t._conditionNode&&!e.includes("group_"))""!==n[e].getValue().trim()&&(r=r+"("+n[e].getValue().trim()+") "+(o!==i.length?t._logicalOperator+" ":""));else{let s=t._eachGroupLogicalOperator[e],l=Object.keys(n[e]).length;r=r+"( "+a(n[e],"",t._eachGroupLogicalOperator[e],s,l)+"  "+(o!==i.length?t._logicalOperator+" ":"")}function a(e,i,n,r,o){let s=0,l=Object.keys(e);for(let d in e)++s,e.hasOwnProperty(d)&&(e[d]instanceof Array&&0!==e[d].length&&(l.splice(0,1),i+="(",i=a(e[d],i,t._eachGroupLogicalOperator[d],r,o)),e[d]instanceof t._conditionNode&&""!==e[d].getValue().trim()&&(l.splice(0,1),i=i+e[d].getValue().trim()+" "+(l.length>0?n+" ":"")));return i=i+") "+(s!==o?r:" ")+" "}let s=function(e){for(var t=/and/gi,i=[];n=t.exec(e);)i.push(n.index);for(let t of i)")"===e[t+4]&&'"'!==e[t+3]&&(console.log(!0),e=e.substr(0,t)+e.substr(t+3,e.length));var n;for(t=/or/gi,i=[];n=t.exec(e);)i.push(n.index);for(let t of i)")"===e[t+4]&&'"'!==e[t+3]&&(console.log(!0),e=e.substr(0,t)+e.substr(t+3,e.length));let r="";e=e.split("").reverse().join("");for(let t=0;t<e.length;t++)if(r+=e[t],")"===e[t]){let i=e.substring(t+2,t+5),n=e.substring(t+2,t+4);"AND"===i.split("").reverse().join("")&&(t+=5),"OR"===n.split("").reverse().join("")&&(t+=4)}return r=r.split("").reverse().join(""),r}(r.trim());var d=Object.getOwnPropertyNames(t._output);for(o=0;o<d.length;o++)delete n[d[o]];t._isCriteriaValueNull(s)?b.displayNotification({message:l.msg_no_criteria,className:"warning"}):(console.log(s),m.changeSearch(s,!0,!0)),t._librarySearchWithinDialog.close()}})}}),t._titleContainer.inject(t._librarySearchWithinDialog.elements._titleP),t._bodyContainer.inject(t._librarySearchWithinDialog.elements._contentDiv),t._restrictQueryContainer.inject(t._bodyContainer),t._queryBuilderContainer.inject(t._bodyContainer),t._singleConditionUIblock(t._queryBuilderContainer,t._id),t._blockButtonContainer.inject(t._bodyContainer),t._restrictQueryOnObject(),t._blockButtonContainerUI(),t._customizeStyle(),this.elements.container.inject(widget.body))},_isCriteriaValueNull:function(e){if(!e)return!0;let t=e,i=t.split("").reduce(((e,t,i)=>("="===t&&e.push(i),e)),[]);for(let e of i)if(")"===t[e+1])return console.log("No value"),!0;let n=t.split(" "),r=n.reduce(((e,t,i)=>("("===t&&e.push(i),e)),[]);for(let e of r)if(")"===n[e+1])return console.log("No value"),!0;return!1},_customizeStyle:function(){var e=this;e._librarySearchWithinDialog.elements._titleBarDiv.setStyles({padding:"4px 0 4px 0"}),e._librarySearchWithinDialog.elements._titlebarButtonsDiv.addClassName("headerCloseButton"),e._librarySearchWithinDialog.elements._titlebarButtonsDiv.firstElementChild.setStyles({"font-size":"12px",color:"#77797c"})},_updateSearchInNode:function(e){var t=this;return t._searchInNode=e?t._title+e:t._title+"Context",t._librarySearchWithinDialog&&(t._titleContainer.textContent=t._searchInNode),t._searchInNode},_restrictQueryOnObject:function(){var e=this;const t=new UWA.createElement("span",{class:"labelSearchWithin",text:l.get("advance_search_within_text_search")});let i=new UWA.createElement("span",{class:"selectObjectType",text:l.get("advance_search_within_text_All_objects")});i.addEvents({click:e._chooseObjectType});const n=new UWA.createElement("span",{class:"labelSearchWithin",text:l.get("advance_search_within_text_with")});e._andOrBlockContainer=new UWA.createElement("div",{class:"andOrBlockContainer"}),e._selectAllorany=new UWA.createElement("a",{class:"selectConditionType",text:l.get("advance_search_within_text_all"),title:l.get("msg_all_any")}),e._selectAllorany.addEventListener("click",(function(){e._switchLogicalOperator()})),e._selectAllorany.inject(e._andOrBlockContainer);new UWA.createElement("span",{class:"labelSearchWithin",text:l.get("advance_search_within_text_ofthefollowing")+" :"}).inject(e._andOrBlockContainer),new Promise(((i,n)=>{t.inject(e._restrictQueryContainer),i([])})).then((()=>{i.inject(e._restrictQueryContainer)})).then((()=>{n.inject(e._restrictQueryContainer)})).then((()=>{e._andOrBlockContainer.inject(e._restrictQueryContainer)})).then((()=>{e._setVisible||(e._andOrBlockContainer.style.visibility="hidden")}))},_singleConditionUIblock:async function(e,t,i){var n=this,r=new n._conditionNode("",t);const s=n._addGroupToObject.bind(n);if(i)s(n._output,i," ",r);else{const e="single_"+t;n._output[e]=r}console.log(e);var d=new UWA.createElement("div",{class:"singleConditionBlockContainer",id:"singleConditionBlockContainer_"+t});d.inject(e);var c=null,p="=",m="",b=n._getOperatorString.bind(n),v=(n._hideAndAnySpan.bind(n),n._fliterSingleIdList.bind(n)),C=(n._buildDateSection.bind(n),n._resetTimeOfDate.bind(n)),y=new o,S=new o,P=null;for(let e in n._classificationAttributePredicates){var w=!1;n._classificationAttributePredicates[e].authRange&&(w=!0);var T=new a({isRangeAttr:w,name:n._classificationAttributePredicates[e].name,label:e,type:"timestamp"===n._classificationAttributePredicates[e].type?"date":n._classificationAttributePredicates[e].type});y.addRoot(T)}y.expandAll();var I=new UWA.createElement("div",{class:"attributeComboContainer",id:"attributeComboContainer_"+t}),E=new h({enableSearchFlag:!0,domId:"attributeCombo_"+t,placeholder:l.get("msg_select_attribute"),popupSizeAdjustPolicy:g.SizeAdjustPolicyEnum.AdjustToVisibleContents,elementsTree:y,reachablePlaceholderFlag:!0});E.inject(I),I.inject(d);var D=new UWA.createElement("div",{class:"operatorComboContainer",id:"operatorComboContainer_"+t});const A=l.searchWithinOperator,L=Object.keys(A).map((e=>[A[e]])),x=[].concat(...L);var O=new h({domId:"operatorCombo_"+t,enableSearchFlag:!1,elementsList:x,displayStyle:"normal",popupSizeAdjustPolicy:g.SizeAdjustPolicyEnum.AdjustToVisibleContents,value:"equals to"});O.inject(D),D.inject(d),D.style.visibility="hidden";var N=function(){if(E.value){if(c=E.value,c="["+n._classificationAttributePredicates[E.value].predicate+"]",P=n._classificationAttributePredicates[E.value].predicate,r.updateValue(c.toString()+p+m,t),!i){const e="single_"+t;n._output[e]=r}console.group("Output Object"),console.table(n._output),console.groupEnd();let T="attribute["+n._classificationAttributePredicates[E.value].name+"]";if(n._nlsUnitData[T]){R.style.display="inline",S.removeRoots();for(let t in n._nlsUnitData[T].nlsToUnits){var e=new a({label:t});S.addRoot(e)}W.getContent().addEventListener("change",(function(e){let i=e.dsModel.value.trim();""!==m||m||(m=0);let o=Number(m)*n._nlsUnitData[T].nlsToUnits[i].factor+Number(n._nlsUnitData[T].nlsToUnits[i].offset);console.log(i),r.updateValue(c.toString()+p+o,t)}))}else R.style.display="none";let I=E.elementsTree.getSelectedNodes();if(I&&"string"===I[0]._options.type||"boolean"===I[0]._options.type){let e=[].concat(...L);O.elementsList=[].concat(e[0])}else O.elementsList=x;if(M){M.remove(),m="";var s=n._attributesInfo.rangeAttributes;if(I&&"date"===I[0]._options.type){var d=C(new Date(Date.now()));(M=new _({domId:"singleattrValue_"+t,timePickerFlag:!0,timePickerPrecision:"sec",value:d})).inject(U);let e=d.toLocaleTimeString().replace(/([\d]+:[\d]{2})(:[\d]{2})(.*)/,"$1$3");var u=d.getMonth()+1,b=d.getUTCDate()+1,v=d.getUTCFullYear();m=`"${m=v+"/"+u+"/"+b+" "+e}"`,r.updateValue(c.toString()+p+m,t),M.getContent().addEventListener("change",(function(e){var i;let n=(i=e.dsModel.value).toLocaleTimeString().replace(/([\d]+:[\d]{2})(:[\d]{2})(.*)/,"$1$3");var o=i.getMonth()+1,a=i.getUTCDate()+1,s=i.getUTCFullYear();m=`"${m=s+"/"+o+"/"+a+" "+n}"`,r.updateValue(c.toString()+p+m.toString(),t),console.log(m)}))}else if(I&&(I[0]._options.isRangeAttr||"boolean"==I[0]._options.type)){var y=[];y="boolean"==I[0]._options.type?["TRUE","FALSE"]:n._classificationAttributePredicates[I[0]._options.label].authRange;var w=new o;M.remove();for(let t in y){e=new a({label:y[t],type:"string"});w.addRoot(e)}w.expandAll(),(M=new h({enableSearchFlag:!0,domId:"attributeCombo_"+t,placeholder:"select value",popupSizeAdjustPolicy:g.SizeAdjustPolicyEnum.AdjustToVisibleContents,elementsTree:w,reachablePlaceholderFlag:!0})).inject(U),M.getContent().addEventListener("change",(function(e){m=e.dsModel.value;var i=E.value,o=n._classificationAttributePredicates[i].name;if(s[o])if(Array.isArray(m)){for(var a=0;a<m.length;a++)if(!s[o][m[a]]){var l=Object.keys(s[o]).find((e=>s[o][e]===m[a]));m[a]=l}}else s[o][m]||(m=Object.keys(s[o]).find((e=>s[o][e]==m)));m=`"${m}"`,r.updateValue(c.toString()+p+m,t)}))}else{(M=new f({placeholder:l.get("enter_attribute_value"),domId:"singleattrValue_"+t,displayClearFieldButtonFlag:!0})).inject(U);let e="real"===I[0]._options.type;M.pattern=e?"^(([-+]?[0-9]+.[0-9]+)|([0-9]+))$":"",M.getContent().addEventListener("change",(function(i){let o=(m=i.dsModel.value.trim()).split(" ");o.length>1&&!e?(M.pattern="",m=`"${m}"`):e&&n._nlsUnitData[P]?m=o[0]:Number.isNaN(m)?(M.pattern="",m=Number(m)):(M.pattern="",m=`"${m}"`),r.updateValue(c.toString()+p+m,t),console.log(m)})),r.updateValue(c.toString()+p+m,t)}}D.style.visibility="visible",F.style.visibility="visible",U.style.visibility="visible"}else console.log("Please Choose an attribute"),c=null,D.style.visibility="hidden",F.style.visibility="hidden",U.style.visibility="hidden"},V=function(){if(O.value&&(p=b(O.value,x),r.updateValue(c.toString()+p+m,t),!i)){const e="single_"+t;n._output[e]=r}};E.addEventListener("change",N),E.addEventListener("preselectionChange",N),O.addEventListener("change",V),O.addEventListener("preselectionChange",V);var U=new UWA.createElement("div",{class:"operatorCombo_",id:"attributeValueHolderContainer_"+t}),M=new f({placeholder:l.get("enter_attribute_value"),domId:"singleattrValue_"+t,displayClearFieldButtonFlag:!0});M.inject(U),U.inject(d),U.style.visibility="hidden",M.getContent().addEventListener("change",(function(e){console.log(e.dsModel.value)}));var R=new UWA.createElement("div",{class:"operatorComboContainer",id:"unitComboHolderContainer_"+t}),W=new h({enableSearchFlag:!0,domId:"unitCombo_"+t,placeholder:l.get("msg_select_unit"),popupSizeAdjustPolicy:g.SizeAdjustPolicyEnum.AdjustToVisibleContents,elementsTree:S,reachablePlaceholderFlag:!0});W.inject(R),R.inject(d),R.style.display="none";var F=new UWA.createElement("div",{class:"deleteButtonHolder",title:l.get("msg_delete_block")}),B=new u(n._getBlockButtonStyle("trash wux-ui-3ds"));B.inject(F),F.inject(R,"after"),F.style.visibility="hidden",B.getContent().addEventListener("buttonclick",(function(){if(c=null,p="=",m="",r.updateValue("",t),F.style.visibility="hidden",U.style.visibility="hidden",R.style.display="none",!i){const e="single_"+t;n._output[e]=r}0===t?(E.selectedIndex=-1,v(t)):(E.selectedIndex=-1,d.remove(),v(t))}))},_groupConditionUIblock:async function(e,t,i){var n=this,r="AND";let o="group_"+t;n._eachGroupLogicalOperator[o]=r;const a=n._addGroupToObject.bind(n);i?a(n._output,i,o):n._output[o]=[];var s=n._fliterSingleIdList.bind(n),d=new UWA.createElement("div",{class:"groupHolder",id:"groupHolder_"+t}),c=new UWA.createElement("div",{class:"groupConditionBlockContainer",id:"groupConditionBlockContainer_"+t}),h=new UWA.createElement("div",{class:"blockButtonContainer"});d.inject(e),c.inject(d);var g=new UWA.createElement("div",{class:"deleteButtonHolder",title:l.get("msg_delete_block")});g.inject(d);var f=new u(n._getBlockButtonStyle("trash wux-ui-3ds"));f.inject(g);const p=new UWA.createElement("div",{class:"grouprestrictQueryContainer",title:l.get("msg_all_any")});p.inject(c);const _=new UWA.createElement("span",{class:"labelSearchWithin",text:l.get("advance_search_within_text_with")}),m=new UWA.createElement("a",{class:"selectConditionType",text:l.get("advance_search_within_text_all")});m.addEventListener("click",(function(){r="AND"===r?"OR":"AND",m.text="AND"===r?l.get("advance_search_within_text_all"):l.get("advance_search_within_text_any"),n._eachGroupLogicalOperator[o]=r}));const b=new UWA.createElement("span",{class:"labelSearchWithin",text:l.get("advance_search_within_text_ofthefollowing")+" :"}),v=n._blockButtonContainerUI.bind(n);new Promise(((e,t)=>{_.inject(p),e([""])})).then((()=>{m.inject(p)})).then((()=>{b.inject(p)}));var C=new UWA.createElement("div",{class:"inlineConditionContainer",id:"inlineConditionContainer_"+t});C.inject(c),n._singleConditionUIblock(C,0,o),f.getContent().addEventListener("buttonclick",(function(){d.remove(),s(t),i?a(n._output,i,o):delete n._output[o]})),h.inject(c),v(h,C,o)},_blockButtonContainerUI:function(e,t,i){var n=this;const r=new u(n._getBlockButtonStyle("plus wux-ui-3ds"));r.elements.container.title=l.get("msg_add_single_condition");const o=new u(n._getBlockButtonStyle("group-add wux-ui-3ds"));o.elements.container.title=l.get("msg_add_group_condition"),new Promise(((t,i)=>{r.inject(e||n._blockButtonContainer),t([""])})).then((()=>{o.inject(e||n._blockButtonContainer)})),r.getContent().addEventListener("buttonclick",(function(){n._blockButtonOnClick("single",t||"",i)})),o.getContent().addEventListener("buttonclick",(function(){n._blockButtonOnClick("group",t||"",i)}))},_chooseObjectType:function(e){e.preventDefault(),console.log("Need to render the combobox here...")},_switchLogicalOperator:function(){var e=this,t="AND"===e._logicalOperator?"OR":"AND";e._logicalOperator=t,e._selectAllorany.text="AND"===e._logicalOperator?l.get("advance_search_within_text_all"):l.get("advance_search_within_text_any")},_getBlockButtonStyle:function(e){return{displayStyle:"icon",showLabelFlag:!1,icon:this._getIconByName(e)}},_getIconByName:function(e){return{iconName:e,fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"}},_blockButtonOnClick:function(e,t,i){var n=this;switch(e){case"single":n._setVisible||(n._setVisible=!0,n._andOrBlockContainer.style.visibility="visible"),n._updateSingleId(),n._singleConditionUIblock(""===t?n._queryBuilderContainer:t,n._id,i);break;case"group":console.log("add group condition to ",t),n._setVisible||(n._setVisible=!0,n._andOrBlockContainer.style.visibility="visible"),n._updateSingleId(),n._groupConditionUIblock(""===t?n._queryBuilderContainer:t,n._id,i);break;default:console.log(e)}},_hideAndAnySpan:function(){this._setVisible=!1,this._andOrBlockContainer.style.visibility="hidden"},_updateSingleId:function(){var e=this,t=[];for(let i=0;i<e._singleConditionId.size;i++)t[i]=!1;for(const i of e._singleConditionId)t[i]=!0;var i=0,n=!1;for(let e=0;e<t.length;e++)if(!1===t[e]){n=!0,i=e;break}console.log(t),n?(e._id=i,e._singleConditionId.add(e._id)):(e._id=e._singleConditionId.size,e._singleConditionId.add(e._id)),console.log(e._singleConditionId)},_fliterSingleIdList:function(e){var t=this;t._singleConditionId.has(e)&&0!==e&&t._singleConditionId.delete(e),t._id=e,console.log("filtered Set : ",t._singleConditionId),1===t._singleConditionId.size&&t._hideAndAnySpan()},_buildDateSection:function(e,t,i){var n,r=this;n=t?new p(p.parse(t)):this._resetTimeOfDate(new Date(Date.now()));var o=new _({domId:e,timePickerFlag:!0,timePickerPrecision:"sec",value:n});function a(t){var i;r._currentDateTime=t,i=(i=r._currentDateTime.toISOString()).substring(0,i.lastIndexOf("."))+"Z",r.model.set(e,i)}return o.inject(i),a("on",o.value),o.getContent().addEventListener("change",(function(e){a("on",e.dsModel.value)})),o},_resetTimeOfDate:function(e){var t=new Date(e);return t.setHours(0,0,0,0),t},_getOperatorString:function(e,t){var i={};console.log("before string check",l.searchWithinOperator.equals_to);for(let e=0;e<t.length;e++)switch(t[e]){case l.searchWithinOperator.equals_to:i[t[e]]="=";break;case l.searchWithinOperator.is_greater_than:i[t[e]]=">";break;case l.searchWithinOperator.is_greater_or_equal_to:i[t[e]]=">=";break;case l.searchWithinOperator.is_lower_than:i[t[e]]="<";break;case l.searchWithinOperator.is_lower_than_or_equal_to:i[t[e]]="<=";break;default:console.log("Type not supported!")}return console.log(i),i[e]},_saveUItoState:async function(e){let t=(new XMLSerializer).serializeToString(e);localStorage.setItem("librarysearchquery",t)},_addGroupToObject:function(e,t,i,n){!function e(r){for(let o in r)if(r.hasOwnProperty(o)){if(console.log(o+": "+r[o]),o===t){if(console.log("--found id")," "!==i){r[o][i]=[];break}r[o].push(n),r[o]===i&&console.log("----found porop",o,", ",r[o])}r[o]instanceof Array&&e(r[o])}}(e)}})})),define("DS/IPClassifyUX/LibrarySearchWithinController",["UWA/Class","DS/Logger/Logger","DS/IPClassifyUX/views/LibrarySearchWithinView","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUXUtil/IPClassifyConfirmation"],(function(e,t,i,n,r,o){"use strict";var a=e.singleton({name:"LibrarySearchWithinController",_LibrarySearchWithinView:null,_logger:null,_libraryContentView:null,_classificationAttributePredicates:{},_attributesInfo:null,_nlsUnitData:null,init:function(e){e&&(this.dataProvider=e.dataProvider,this.CSOProvider=e.CSOProvider),this._logger=t.getLogger(a)},loadUI:function(e){0===Object.keys(this._classificationAttributePredicates).length?r.displayNotification({message:n.get("msg_error_advancesearch_zero_attribute_class"),className:"warning"}):(e._classificationAttributePredicates=this._classificationAttributePredicates,e._nlsUnitData=this._nlsUnitData,e._attributesInfo=this._attributesInfo,this._LibrarySearchWithinView=new i(e,this))},feedClassificationAttributes:function(e){let t={};for(let i of e)t[i.nls_label]={predicate:i.predicate,type:i.type,name:i.name,authRange:i.authRange};e._attributesInfo&&(this._attributesInfo=e._attributesInfo),this._classificationAttributePredicates=t},feedUnitManipulationDatas:function(e){this._nlsUnitData=e}});return a})),define("DS/IPClassifyUX/views/LibraryPathSeparator",["UWA/Controls/Abstract","UWA/Class/Options","DS/IPClassifyUX/events/IPClassifyEvents","DS/UIKIT/DropdownMenu","DS/IPClassifyUtil/IPClassifyAlert"],(function(e,t,i,n,r){"use strict";return e.extend(t,{_dropDownCreated:!1,_dropdownElmt:null,_separator:null,_libraryInfo:null,_subLibraries:null,_activeIconFont:"",_unactiveIconFont:"",init:function(e){this._parent(e),this._libraryInfo=e.libraryInfo||null,this._activeIconFont=e.activeIconFont||"fonticon-down-dir",this._unactiveIconFont=e.unactiveIconFont||"fonticon-right-dir"},getSubLibrary:function(e){return null===this._subLibraries||e>=this._subLibraries.length?null:this._subLibraries[e]},addSubLibrary:function(e,t){null===this._subLibraries&&(this._subLibraries=[]),t?this._subLibraries.splice(0,0,e):this._subLibraries.push(e),this._dropDownCreated=!1},removeSubLibrary:function(e){if(null===this._subLibraries||e>=this._subLibraries.length)return!1;this._subLibraries.splice(e,1);return this._dropDownCreated=!1,this._dropdownElmt&&this._dropdownElmt.isVisible&&this._dropdownElmt.hide(),!0},hide:function(){this._dropdownElmt&&this._dropdownElmt.isVisible&&(this._dropdownElmt.hide(),this._dropDownCreated=!1),this._separator&&this._separator.hide()},show:function(){this._separator&&this._separator.show()},isVisible:function(){return"none"!==this._separator.getStyle("display")},buildPathSeparatorElement:function(){var e=this;return this._separator=UWA.createElement("div",{class:"separatorIdCard fonticon "+this._unactiveIconFont,styles:{cursor:"pointer"},events:{click:function(t){e._dropDownCreated||e._buildDropDownPath()}}}),this._separator},flush:function(){this._clearDropDown,this._dropDownCreated=!1,this._subLibraries=null},_clearDropDown:function(){this._dropdownElmt&&(this._dropdownElmt.destroy(),this._dropdownElmt=null)},_buildDropDownPath:function(){var e=this;if(null===this._subLibraries&&null===this._libraryInfo)return null;this._clearDropDown(),this._subLibraries?(e._dropDownCreated=!0,this._buildDomDropdownElmt(this._subLibraries)):this._libraryInfo.getChildrenInfos({onComplete:function(t){e._dropDownCreated=!0,e._buildDomDropdownElmt(t)},onFailure:function(t){e._dropDownCreated=!1,r.displayNotification({message:Nls.replace(Nls.get("msg_error_LibraryActivate"),{name1:name}),className:"error"})}})},_buildDomDropdownElmt:function(e){var t=this,r=[];e.length>0&&(e.forEach((function(e){r.push({text:e.getLabel(),title:e.getLabel(),handler:function(){i.notifyExpandTreeAndSelect({libraryToFindAndSelect:{id:e.getID(),type:e.getType(),name:e.getLabel()}})}})})),this._dropdownElmt=new n({target:this._separator,className:"library_ctx_menu",items:r,position:"bottom left",events:{onShow:function(){t._separator.removeClassName(t._unactiveIconFont),t._separator.addClassName(t._activeIconFont)},onHide:function(){t._separator.removeClassName(t._activeIconFont),t._separator.addClassName(t._unactiveIconFont)}}}),this._checkSizeOverflowDropdownMenu(),this._dropdownElmt.show())},resizeWidgetCallback:function(){this._dropdownElmt&&this._dropDownCreated&&(this._dropDownCreated=!1,this.isVisible()&&this._dropdownElmt.hide())},_checkSizeOverflowDropdownMenu:function(){var e,t,i,n,r,o,a,s,l,d,c;if(!this._dropdownElmt)return!1;o=this._dropdownElmt.elements.container,e=(a=this._dropdownElmt.options).target,i=document.documentElement.clientHeight||window.innerHeight,r=document.documentElement.clientWidth||window.innerWidth,o.isInjected()||(this._dropdownElmt.inject(a.renderTo?a.renderTo:document.body),o.setStyle("display","")),t=o.offsetHeight,n=o.offsetWidth,t>(s=i-(d=e.getOffsets().y+e.offsetHeight)-20>0?i-d-20:i-d)&&(o.setStyle("height",s),o.setStyle("overflow-y","auto"),n+=20,o.setStyle("width",n)),n>(l=r-(c=e.getOffsets().x+e.offsetWidth)-20>0?r-c-20:r-c)&&o.setStyle("width",l)}})})),define("DS/IPClassifyUX/views/LibraryLeftSidePanelView",["UWA/Core","UWA/Controls/Abstract","DS/PADUtils/PADContext","DS/IPClassifyUtil/IPContext","DS/IPClassifyUX/events/IPClassifyEvents","DS/PADServices/utils/GlobalModelEvents"],(function(e,t,i,n,r,o){"use strict";return t.extend({_callbackAdd:!1,_context:null,_padshell:null,_modelEvent:null,_libraryEditorUtil:null,_libraryControl:null,_dataProvider:null,init:function(e){this._parent(e,{}),this._context=n.get()?n.get():i.get(),this._padshell=e.padshell,this._modelEvent=o.getModelEvents(),this._libraryEditorUtil=e.dataProvider.getLibraryEditorUtil&&e.dataProvider.getLibraryEditorUtil(),this._libraryControl=e.dataProvider.getLibraryControl&&e.dataProvider.getLibraryControl(),this._dataProvider=e.dataProvider,this.addCallback(e)},updatePanelVisibility:function(e,t){"left"===t&&(this.setPreferences(),this._libraryControl&&this._libraryControl.getIdCardCont()&&this._libraryControl.getIdCardCont().updateLeftPanelIcon(e))},addCallback:function(){var e=this;!1===e._callbackAdd&&this._padshell&&this._padshell._modelEvents&&(this._padshell._modelEvents.subscribe({event:"triptych-panel-hidden"},e.updatePanelVisibility.bind(this,!1)),this._padshell._modelEvents.subscribe({event:"triptych-panel-visible"},e.updatePanelVisibility.bind(this,!0)),this._modelEvent.subscribe({event:"welcome-panel-collapse"},(function(){e._mode="close",e._padshell.togglePanel("left"),e._modelEvent.publish({event:"welcome-panel-collapsed"}),e.setPreferences()})),this._modelEvent.subscribe({event:"welcome-panel-expand"},(function(){e._mode="open",e._padshell.togglePanel("left"),e._modelEvent.publish({event:"welcome-panel-expanded"}),e.setPreferences()})),r.onTaggerOpen((function(){e._padshell._modelEvents.publish({event:"triptych-hide-panel",data:"left"}),e._modelEvent.publish({event:"welcome-panel-collapsed"})})),r.onTaggerClose((function(){e._mode&&"open"!==e._mode||!e._dataProvider.hasWelcomePanel||!e._dataProvider.hasWelcomePanel()?(e._padshell._modelEvents.publish({event:"triptych-hide-panel",data:"left"}),e._modelEvent.publish({event:"welcome-panel-collapsed"}),r.notifyPageToolBarCollapse()):(e._padshell._modelEvents.publish({event:"triptych-show-panel",data:"left"}),e._modelEvent.publish({event:"welcome-panel-expanded"}),r.notifyPageToolBarExpanded())})),this._callbackAdd=!0)},setPreferences:function(){var e=this._context.elements.padshell.getLeftOpen(),t={leftPanelState:e,isWelcomePanelCollapsed:!e};this._libraryEditorUtil&&this._libraryEditorUtil.setLeftPanelStatus&&this._libraryEditorUtil.setLeftPanelStatus(t),e?this._modelEvent.publish({event:"welcome-panel-expanded"}):this._modelEvent.publish({event:"welcome-panel-collapsed"})}})})),define("DS/IPClassifyUX/views/LibraryPathNavigator",["UWA/Controls/Abstract","UWA/Class/Options","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/views/LibraryPathSeparator"],(function(e,t,i,n){"use strict";return e.extend(t,{_ctxMenu:null,_ctxMenuWidth:4,_breadcrumb:null,_pathCont:null,init:function(e){this._parent(e),this._pathCont=e.pathCont,this.CSOProvider=e.CSOProvider,this._buildCtxMenu(),this._breadcrumb=UWA.createElement("div",{class:"containerPathIdCard"}).inject(this._pathCont),e.pathNodes&&e.pathNodes.length>0&&this._buildPathNavigator(e.pathNodes)},flush:function(){for(this._ctxMenu.hide();this._breadcrumb.firstChild;)this._breadcrumb.removeChild(this._breadcrumb.firstChild);this._ctxMenu.flush()},_buildPathNavigator:function(e){if(UWA.is(e))for(var t=this._pathCont.offsetWidth,i=!1,r=0;r<e.length;r++){var o,a=null,s=null,l=0,d=this._createLibraryInfoPathElement(e[r]);if(o=d.getDimensions().outerWidth,r<e.length-1&&((a=(s=new n({libraryInfo:e[r+1]})).buildPathSeparatorElement()).LibrarySeparator=s,a.inject(this._breadcrumb,"top"),l=a.getDimensions().outerWidth),o+l<t&&!i)t=t-o-l;else{i=!0,this._ctxMenu.isVisible()||this._ctxMenu.show(),a&&a.destroy();var c=d.nextSibling;c&&c.hasClassName("separatorIdCard")&&c.destroy(),d.remove(),this._ctxMenu.addSubLibrary(e[r])}}},_buildCtxMenu:function(){this._ctxMenu=new n({libraryInfo:null,activeIconFont:"fonticon-menu",unactiveIconFont:"fonticon-menu"});var e=this._ctxMenu.buildPathSeparatorElement();e.inject(this._pathCont,"top"),this._ctxMenuWidth=e.getDimensions().outerWidth,this._ctxMenu.hide()},_resize:function(){var e,t=null;if(this._isOverflowed(this._pathCont))for(this._ctxMenu.isVisible()||this._ctxMenu.show();this._isOverflowed(this._pathCont)&&this._breadcrumb.hasChildNodes()&&(t=this._breadcrumb.firstChild);)t.LibraryInfo&&(this._ctxMenu.addSubLibrary(t.LibraryInfo,!0),(e=t.nextSibling)&&e.hasClassName("separatorIdCard")&&e.destroy(),t.remove());else for(var i=!0,r=this._breadcrumb.getElementsByClassName("subLabelTextIdCard").length>0;i;)if(this._ctxMenu.isVisible()||(i=!1),t=this._ctxMenu.getSubLibrary(0)){if(r){var o=new n({libraryInfo:t});(e=o.buildPathSeparatorElement()).LibrarySeparator=o,e.inject(this._breadcrumb,"top");e.getDimensions().outerWidth}var a=this._createLibraryInfoPathElement(t);a.getDimensions().outerWidth;r=!0,this._isOverflowed(this._pathCont)?(e&&e.destroy(),a.remove(),i=!1):this._ctxMenu.removeSubLibrary(0)}else this._ctxMenu.hide(),i=!1;this._ctxMenu.isVisible()&&this._ctxMenu.resizeWidgetCallback();var s,l,d,c=this._breadcrumb.getElementsByClassName("separatorIdCard");for(d=c.length,s=0;s<d;++s)(l=c[s].LibrarySeparator)&&l.resizeWidgetCallback();return!0},_isOverflowed:function(e){return e.scrollHeight-1>e.clientHeight||e.scrollWidth>e.clientWidth},_createLibraryInfoPathElement:function(e){var t=e.getID()===this.CSOProvider.getCurrentObject().getID(),n=UWA.createElement("div",{class:"subLabelTextIdCard",styles:{cursor:"pointer"},events:{click:function(e){i.notifyExpandTreeAndSelect({libraryToFindAndSelect:{id:this.LibraryInfo.getID(),type:this.LibraryInfo.getType(),name:this.LibraryInfo.getLabel()}})}}}).inject(this._breadcrumb,"top");return n.LibraryInfo=e,n.setAttribute("current",t),n.setText(e.getLabel()),n}})})),define("DS/IPClassifyUX/views/LibraryBreadcrumbView",["UWA/Class","DS/IPClassifyUX/views/LibraryPathNavigator","DS/IPClassifyUX/models/LibraryBreadcrumbModel","DS/IPClassifyUX/events/IPClassifyEvents","DS/ENOXPageToolBar/js/PageToolBar"],(function(e,t,i,n,r){"use strict";return e.extend({init:function(e){this.dataProvider=e.dataProvider,this.CSOProvider=e.CSOProvider,this._elements=null},showBreadCrumb:function(e){var t=this;t._elements=e;var i=t._elements.container.querySelector(".xnav_viewmain");i.querySelector(".LibraryDataGridView").style.top="38px",t._elements.breadCrumb_container=UWA.createElement("div",{class:"LibraryEditor_breadCrumb"}).inject(i);var o={withInformationButton:!1,withWelcomePanelButton:!0,parentContainer:t._elements.breadCrumb_container,modelEvents:n.getModelEvents()};this._pageToolBar=new r(o),this._pageToolBar.render().inject(t._elements.breadCrumb_container),t._elements.breadCrumb_container_content=UWA.createElement("div",{class:"LibraryEditor_title_IdCard"});var a=this._pageToolBar.getBodyContent();t._elements.breadCrumb_container_content.inject(a)},_buildLibraryPath:function(e){this._LibraryPathNavigator?(this._LibraryPathNavigator.flush(),this._LibraryPathNavigator._buildPathNavigator(e)):this._LibraryPathNavigator=new t({pathCont:this._elements.breadCrumb_container_content,pathNodes:e,CSOProvider:this.CSOProvider}),e.length>0&&this._elements.searchInContext&&this._elements.searchInContext.changeLibraryPlaceholder(e[0].getLabel())},setCurrentLocation:function(e){this._elements=e;var t=i.getNewPathNodes({getChildrenInfos:this.dataProvider.getChildrenInfos,CSOProvider:this.CSOProvider}),n=t[0],r=this.CSOProvider.getCurrentObject();r&&null!=r&&r.getID()===n.getID()&&!r.options.mxid&&(r.options.mxid=n.options.mxid),this._buildLibraryPath(t)},_isSearchAvailable:function(e){return e||(e=this.CSOProvider.getCurrentObject()),!!e&&(!this.dataProvider.isSection(e.getType())&&e.options.mxid&&!1!==e.options.contentAvailable)}})})),define("DS/IPClassifyUX/LibraryContent",["UWA/Class","DS/Logger/Logger","DS/IPClassifyUX/views/LibraryContentView","DS/IPClassifyUX/models/LibraryContentModel","DS/IPClassifyUX/views/IPClassifyTagger","DS/IPClassifyUX/events/IPClassifyEvents","DS/WidgetServices/WidgetServices","DS/PADServices/utils/AttributesMgtV2","DS/IPClassifyUtil/IPSettingsMgr","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUtil/IPClassifyUtility","DS/PADUtils/PADSession","DS/PADUtils/PADSettingsMgt","DS/IPClassifyUX/views/InformationsPanelView","DS/IPClassifyUX/service/PlatformServices","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","i18n!DS/SNResultUX/assets/nls/SNResultUX","DS/IPClassifyUX/models/LibrarySearchModel","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUX/utils/IPClassifyModeManager","css!DS/IPClassifyUX/IPClassifyUX","DS/IPClassifyUX/views/additionalData/ThumbnailAttribute","DS/IPClassifyUX/views/LibraryLeftSidePanelView","DS/IPClassifyUX/views/LibraryBreadcrumbView"],(function(e,t,i,n,r,o,a,s,l,d,c,u,h,g,f,p,_,m,b,v,C,y,S,P){"use strict";var w=e.extend({name:"LibraryContentController",_tagNavigator:null,_libraryContentView:null,_infoPanelView:null,_refreshProductStructure:!1,_LibraryLeftPanel:null,init:function(e){this.leftTriptychElem=e.leftTriptychElem;var n=this;e.additionalColumnsModules||(e.additionalColumnsModules=[]),e.thumbnailAttributeDelayed&&e.additionalColumnsModules.push(y),this.dataProvider=e.dataProvider,this.leftState=e.leftState,this.rightState=e.rightState,this.showBreadcrumb=e.showBreadcrumb,this.CSOProvider=e.CSOProvider,o.onContentReady((function(){n._OnPADComponentReady()})),this.showBreadcrumb&&(e._libraryBreadcrumbView=this._libraryBreadcrumbView=new P(e)),this._libraryContentView=new i(e),this._logger=t.getLogger(w)},_OnPADComponentReady:function(){var e=this;e._LibraryLeftPanel=new S({padshell:e._libraryContentView.elements.padshell,dataProvider:e.dataProvider}),e._LibraryLeftPanel._libraryEditorUtil.getLeftPanelStatus().then((function(t){t.leftPanelState||1==e._LibraryLeftPanel._libraryEditorUtil.CURRENT_TAB_VALUE||2==e._LibraryLeftPanel._libraryEditorUtil.CURRENT_TAB_VALUE||3==e._LibraryLeftPanel._libraryEditorUtil.CURRENT_TAB_VALUE||(e.getView().elements.padshell.togglePanel("left"),e.showBreadcrumb&&e._libraryBreadcrumbView.setCurrentLocation(e._libraryContentView.elements))})),e._mode="load",o.onPageToolBarExpand((function(){"load"!=e._mode&&(e._mode="open",e.getView().elements.padshell.togglePanel("left"),o.notifyPageToolBarExpanded())})),o.onPageToolBarCollapse((function(){e._mode="close",e.getView().elements.padshell.togglePanel("left"),o.notifyPageToolBarCollapse()})),o.onTaggerOpen((function(){e.getView().elements.padshell._modelEvents.publish({event:"triptych-hide-panel",data:"left"}),o.notifyPageToolBarCollapse()})),o.onTaggerClose((function(){"open"===e._mode?(e.getView().elements.padshell._modelEvents.publish({event:"triptych-show-panel",data:"left"}),o.notifyPageToolBarExpanded()):(e.getView().elements.padshell._modelEvents.publish({event:"triptych-hide-panel",data:"left"}),o.notifyPageToolBarCollapse())})),e._tagNavigator=new r,e._tagNavigator._initTaggerProxy(),this.dataProvider.showClassTabs&&this.dataProvider.showClassTabs()&&e._libraryContentView.addTabPages(),e.showBreadcrumb&&e._libraryContentView.showBreadCrumb(),e._libraryContentView.cleanColumns(),y.setCheckToShowThumbnail(e._libraryContentView.toShowThumbnail.bind(e._libraryContentView)),e._libraryContentView.addEvent("onToggleView",(function(){e._libraryContentView.setTabStyleOnView(),e.loadContentAndSelect()})),s.getAvailableColumnsOpts()&&e.dataProvider.setColumnNames&&e.dataProvider.setColumnNames(s.getAvailableColumnsOpts(),s.getTreeColumn()),m.onSearchChange((function(t,i){null==t||t.length>=2?e.loadContentAndSelect():d.displayNotification({message:p.minimum_2_characters_search,className:"warning"})})),o.onCurrentLibraryChange((function(t){e._libraryContentView.options.model.getModelEvents().publish({event:"titleRecalc",data:t.currentNode.getLabel()}),m.getSearchValue()&&o.notifyOnEmptySearchQuery(),e._isColumnUnderProcessing=!0,e.dataProvider.getTabsVisOnSelectionChange&&e._libraryContentView.setTabsVis(e.dataProvider.getTabsVisOnSelectionChange()),e._isColumnUnderProcessing=!1,e.loadContentAndSelect(this),e.showBreadcrumb&&e._libraryBreadcrumbView.setCurrentLocation(e._libraryContentView.elements)})),o.onLibraryRename((function(t){var i=t.oldNode.getLabel();null!=e.CSOProvider.getCurrentObject()&&t.oldNode.id===e.CSOProvider.getCurrentObject().getID()&&UWA.is(widget)&&e._libraryContentView.options.model.getModelEvents().publish({event:"titleRecalc",data:i})})),o.onCurrentLibraryFilterChange((function(){e.loadContentAndSelect(null,null,!1,!0)})),o.onCurrentLibraryColumnChange((function(){e.loadContentAndSelect(null,null)})),o.onRemoveNodeInContent((function(t){e.getView().removeNodeInContent(t)})),o.onScrollEnd((function(){n.isMoreDataToFetch()?n.isFetchInProgress()||(n.setFetchInProgress(!0),e.loadContentAndSelect(null,null,!0,void 0,void 0,!1)):e._libraryContentView.infiniteScrollDone()})),o.onContentTabChange((function(){e._isColumnUnderProcessing=!0,e._libraryContentView.removeNodesInContent(),e._libraryContentView.toggleView("treeview"),e._libraryContentView.loadNewColumns(),e._isColumnUnderProcessing=!1,e.loadContentAndSelect(null,null)})),o.onColumnSortChange((function(){if(e.dataProvider.isPreferenceSection&&e.CSOProvider.getCurrentObject()){let t=e.CSOProvider.getCurrentObject().getType();if(1==e.dataProvider.isPreferenceSection(t))return}e._libraryContentView.saveSortModelInCache(),e.dataProvider.reloadAfterSort&&0==e.dataProvider.reloadAfterSort()||e.loadContentAndSelect(null,null,void 0,void 0,void 0,!1)})),o.onFavoriteSectionEmpty((function(){e.managePlaceholderDisplay(0)&&e.getView()._addPlaceHolder()})),e._libraryContentView.setSortOnColumn().then((function(){var t=e.CSOProvider.getCurrentObject();null!=t&&(t.noTree||(e.dataProvider.getTabsVisOnSelectionChange&&e._libraryContentView.setTabsVis(e.dataProvider.getTabsVisOnSelectionChange()),e._libraryContentView.options.model.getModelEvents().publish({event:"titleRecalc",data:e.CSOProvider.getCurrentObject().getLabel()})),e.loadContentAndSelect(t))}));var t=c.isIndexedMode();u.setAuthoringState(!t),e.dataProvider.hasLibrarianRole().then((function(t){(new f).initializePlatform({onComplete:function(i){e._infoPanelView=new g({padshell:e._libraryContentView.elements.padshell,CSOProvider:e.CSOProvider,securityContext:h.getSetting("pad_security_ctx")||l.getSetting("pad_security_ctx"),platformUrls:i.platformurls,readOnly:t.readOnly,dataProvider:e.dataProvider})}})})).catch((function(e){console.log(e)}));var i=widget.getValue("customLeftWidth");e._libraryContentView._addStyleOnTreeCont(i),null!=i&&e._libraryContentView.elements.padshell._modelEvents.publish({event:"triptych-set-size",data:{side:"left",size:i}}),e._libraryContentView.elements.padshell._modelEvents.subscribe({event:"triptych-panel-show-started"},(function(t){"left"===t&&e._libraryContentView._addStyleOnTreeCont()})),e._libraryContentView.elements.padshell._modelEvents.subscribe({event:"triptych-panel-visible"},(function(e){"left"===e&&a.clearJSStylesheet("treeContResize")})),e._libraryContentView.elements.padshell._modelEvents.subscribe({event:"triptych-resized"},(function(e){"left"===e.side&&widget.setValue("customLeftWidth",e.width)})),o.notifyPageToolBarExpand(),null!=this.leftTriptychElem?this.getView().elements.padshell._modelEvents.publish({event:"triptych-show-panel",data:"left"}):this.getView().elements.padshell._modelEvents.publish({event:"triptych-hide-panel",data:"left"}),this.dataProvider.getFilterOptions&&this._libraryContentView.setFilterModel(this.dataProvider.getFilterOptions())},webInWinCtxMenu:function(e,t){this._libraryContentView.showWebInWinCtxMenu(e,t)},onWebInWinFilterChange:function(e){this._tagNavigator.onFilterChange(e.data)},updateFilterBI:function(e){e?this._tagNavigator||(this._tagNavigator=new r,this._tagNavigator._initTaggerProxy()):this._tagNavigator&&this._tagNavigator.unsetTags(),u.setAuthoringState(!e);var t=this._libraryContentView.getPADTreeDocument();null!==t&&(t.options.filterBIComponentProxy=this._tagNavigator)},updateComputedColumns:function(){this._libraryContentView.setSortingForComputedAttrs()},loadContentAndSelect:function(e,t,i,n,r,o){var a,s,l,d=this;if(!d._isColumnUnderProcessing)return!0!==i&&(i=!1),!0!==n&&(n=!1),!0!==r&&(r=!1),d._libraryContentView.enableTreeColumnEdit(!1),d.dataProvider.initColumns&&d.dataProvider.initColumns(d._libraryContentView.getPADTreeListView().getManager().layout.getLeafColumns()),e||(e=d.CSOProvider.getCurrentObject()),e&&!e.noTree&&(e.getType&&(a=e.getType()),e.getID&&(s=e.getID()),l=e.options.mxid?e.options.mxid:""),new Promise((function(h,g){var f=null,p=b.getWidgetData();d.dataProvider.toEnableTreeColumnEdit&&d.dataProvider.toEnableTreeColumnEdit(a,p)&&d._libraryContentView.enableTreeColumnEdit(!0),u.setAuthoringState(!c.isIndexedMode()),null==d.leftTriptychElem?d.displayAllContents({idsToSelect:t,isPaginationOperation:i,isFilterOperation:n,isNewInsertMode:r,isCleanColumns:o}).then((function(e){v.updateRefreshTime(),h(e)})):d.dataProvider.isValidType(a)&&s?(f=d.displayLibraryContents({containerType:a,containerId:s,containerMXID:l,idsToSelect:t,newCurrentContainer:e,isPaginationOperation:i,isFilterOperation:n,isNewInsertMode:r,isCleanColumns:o}),v.updateRefreshTime(),h(f)):d.dataProvider.isPaginatedSection(a)?(d.managePlaceholderDisplay()||d.getView().removePlaceHolder(),d._libraryContentView.cleanColumns(),d.displayAllLibraries({idsToSelect:t,isPaginationOperation:i,isFilterOperation:n,isNewInsertMode:r},a).then((function(e){v.updateRefreshTime(),h(e)}))):d.dataProvider.isPreferenceSection(a)?(d.managePlaceholderDisplay()||d.getView().removePlaceHolder(),d._libraryContentView.cleanColumns(),d.displayFavouriteLibraries(t,a),v.updateRefreshTime(),h(f)):(d._libraryContentView.cleanColumns(),m.isSearchActive()&&m.clearSearch(),d._libraryContentView.removeNodesInContent(),d._libraryContentView.maskContentDiv(!1),d._libraryContentView._endLoadAndSelect(),v.updateRefreshTime(),h(f))}))},displayLibraryContents:function(e){var t=this;t._libraryContentView.maskContentDiv(!0);var i=e.containerType,n=m.getSearchValue(),r=n?e.newCurrentContainer.options.mxid:e.containerId,o=!1;function a(){var e=!1;return(t.dataProvider.isAuthoring&&t.dataProvider.isAuthoring(i)||"Library"===i&&!1===c.isIndexedMode())&&(e=!0),e}!n||m.isAdvanceSearchActive()||-1==n.indexOf(":")&&-1==n.indexOf("=")&&-1==n.indexOf(">")&&-1==n.indexOf("<")||(o=!0);var s=a()&&(null==n||""===n);function l(l,d){var c=[],u=[];l&&(s?l.dynamicattributesName&&(u=l.dynamicattributesName):l.dynamicattributes&&(u=l.dynamicattributes),c.push(new Promise((function(e){t._libraryContentView.displayDynamicAttributes(l,s,d).then((function(t){e()}))}))),l.unitPredicates&&(u=u.concat(l.unitPredicates)));var h={};t._libraryContentView.getPADTreeListView().getManager().layout.getLeafColumns().forEach((function(e){if(e.convertInfos){var t=e.convertInfos,i=e.dataIndex;h[i]=t.dimension}})),Promise.all(c).then((function(){t.getContentOfLibraryOrClass({containerId:r,containerMXID:e.containerMXID,searchQuery:n,isExactSearch:o,selectedType:i,isStartFromBeg:!e.isPaginationOperation,dynamicattributes:u,libraryData:e,isAuthMode:s,isNewInsertMode:e.isNewInsertMode,attributesDimMap:h},a())}))}e.isPaginationOperation||!this.dataProvider.getObjectDynamicAttributes?l():this.dataProvider.getObjectDynamicAttributes({id:r,type:i},s).then((function(i){i||t._libraryContentView.cleanColumns(),l(i,e.isCleanColumns)}),(function(){l()}))},getContentOfLibraryOrClass:function(e,t){var i=this,r=!1===t&&i._tagNavigator?i._tagNavigator._getCurrentFilter():null,o=i._libraryContentView.getSortingOrder(e.isAuthMode);n.fetchLibraryContents({containerId:e.containerId,containerMXID:e.containerMXID,searchQuery:e.searchQuery,isExactSearch:e.isExactSearch,selectedType:e.selectedType,filters:r,isStartFromBeg:e.isStartFromBeg,dynamicattributes:e.dynamicattributes,sortOrder:o,physicalId:e.libraryData.containerId,attributesDimMap:e.attributesDimMap,isAuthoringMode:e.isAuthMode,grid:e.libraryData.newCurrentContainer._options.grid},i.dataProvider.getObjectContents).then((function(n){var r=n.contents,o=n.infos,a=n.facets;if(o&&v.updateLastIndexTime(o),i.managePlaceholderDisplay(n.contents.length)?i.getView()._addPlaceHolder():i.getView().removePlaceHolder(),i._tagNavigator)if(t)i._tagNavigator.unsetTags();else if(!e.libraryData.isPaginationOperation){var s;i.dataProvider.getConfigurePredicates&&(s=i.dataProvider.getConfigurePredicates(n.facets));var l=!e.libraryData.isFilterOperation;i._tagNavigator._setSubjectTags(a,e.libraryData.containerType,l,s),i._tagNavigator.activateTaggerProxy()}var d=m.isSearchInProgress();e.searchQuery&&o&&(m.setInfoIndex(o),e.libraryData.newCurrentContainer.options.contentAvailable=!0),i._libraryContentView._endContentSelect();var c=null;if(i.CSOProvider.getCurrentObject()&&(c=i.CSOProvider.getCurrentObject().getID(),e.searchQuery&&(c=i.CSOProvider.getCurrentObject().options.mxid)),c!==e.containerId)return i._libraryContentView._endRefreshView(),void i._libraryContentView._endLoadAndSelect();var u=null;if(null==r)d||i._libraryContentView.removeNodesInContent(),i._libraryContentView.maskContentDiv(!1);else{var h=[];if(i._refreshProductStructure){var g=i._libraryContentView.getPADTreeDocument().getRoots(),f=0,p=g.length;for(f=0;f<p;f++){var _=g[f];_.options.type;g[f].isExpanded()&&h.push(_)}}var b=!e.libraryData.isPaginationOperation;if(u=i._libraryContentView.displayContentNodes(r,h,e.libraryData.idsToSelect,b,e.isNewInsertMode),i._refreshProductStructure&&h.length>0){i._refreshProductStructure=!1;var C=i._libraryContentView.getPADTreeListView();i._libraryContentView.getPADTreeDocument().refresh({treelist:C,roots:[],cb:function(e){i._logger.log("Refresh PS : "+e.msg)}})}}return i._libraryContentView._endLoadAndSelect(),u}),(function(e){var n,r=e.err,o=e.serverErr;i._logger.log("WebService content, Err : "+r),i._libraryContentView.removeNodesInContent(),i._tagNavigator&&t&&i._tagNavigator.unsetTags(),n=r&&"timeout"===r.type?p.msg_error_timeout:m.isSearchActive()&&o&&"object"==typeof o&&o.error&&o.error.errorCode?_.get(o.error.errorCode):e.msg,d.displayNotification({message:n,className:"error"}),i._libraryContentView.maskContentDiv(!1),i._libraryContentView._endLoadAndSelect()}))},displayFavouriteLibraries:function(e,t){var i=this;i._libraryContentView.maskContentDiv(!0),n.fetchAllFavorites(this.dataProvider).then((function(n){i.managePlaceholderDisplay(n.length)?i.getView()._addPlaceHolder():i.getView().removePlaceHolder();var r="";(i.CSOProvider.getCurrentObject()&&(r=i.CSOProvider.getCurrentObject().getType()),r==t)?(i._libraryContentView.displayFavouriteNodes(n,e),i._tagNavigator&&(i.dataProvider.getConfigurePredicates&&i.dataProvider.getConfigurePredicates(n.facets),i._tagNavigator._setSubjectTags({},i._tagNavigator.CONTENT_TYPES.EMPTY,!0),i._tagNavigator.activateTaggerProxy())):i._libraryContentView._endRefreshView();i._libraryContentView.maskContentDiv(!1),i._libraryContentView._endLoadAndSelect()}),(function(e){i._logger.log("getFavorites, Err : "+e),i._libraryContentView.maskContentDiv(!1),i._libraryContentView._endLoadAndSelect()}))},displayAllLibraries:function(e,t){var i=this,r=e.idsToSelect,o=e.isPaginationOperation,a=e.isNewInsertMode,s=m.getSearchValue();i._libraryContentView.maskContentDiv(!0);var l=i._libraryContentView.getSortingOrder();return new Promise((function(c){n.fetchAllLibraries({filters:i._tagNavigator?i._tagNavigator._getCurrentFilter():null,isStartFromBeg:!o,searchQuery:s,sortOrder:l},i.dataProvider.getPaginatedSectionContents).then((function(n){if(n&&n.infos&&(v.updateLastIndexTime(n.infos),n.infos.sources&&n.infos.sources.length>0&&n.infos.sources[0].error)){var s=n.infos.sources[0],l=s.error.errorMessage;console.error("Error with federated search: ["+s.error.errorCode+"] "+l),d.displayNotification({title:p.msg_error_with_federated_search_title,message:p.msg_error_with_federated_search_message,className:"error"})}i.managePlaceholderDisplay(n.results.length)?i.getView()._addPlaceHolder():i.getView().removePlaceHolder();var u="";if(i.CSOProvider.getCurrentObject()&&(u=i.CSOProvider.getCurrentObject().getType()),u==t){var h=(n="string"==typeof n?JSON.parse(n):n).results?n.results:[];if(i._tagNavigator&&!o){var g=!e.isFilterOperation;i._tagNavigator._setSubjectTags(n.facets,t,g),i._tagNavigator.activateTaggerProxy()}i._libraryContentView._endContentSelect();var f=!e.isPaginationOperation,_=i._libraryContentView.displayContentNodes(h,null,r,f,a)}else i._libraryContentView._endRefreshView();i._libraryContentView._endLoadAndSelect(),c(_)}),(function(e){i._logger.log("WebService roots, Err : "+e),i._libraryContentView._endLoadAndSelect(),c(null)}))}))},displayAllContents:function(e,t){var i=this,r=e.idsToSelect,o=e.isPaginationOperation,a=e.isNewInsertMode,s=m.getSearchValue();0!=i._libraryContentView.checkLoaderActive()&&null!=i._libraryContentView.checkLoaderActive()||i._libraryContentView.webUXLoader(!0,p.Loading);var l=i._libraryContentView.getSortingOrder();return new Promise((function(c){n.fetchAllLibraries({filters:i._tagNavigator?i._tagNavigator._getCurrentFilter():null,isStartFromBeg:!o,searchQuery:s,sortOrder:l,isCleanColumns:e.isCleanColumns},i.dataProvider.getExceptionTabContents).then((function(n){if(n&&n.infos&&(v.updateLastIndexTime(n.infos),n.infos.sources&&n.infos.sources.length>0&&n.infos.sources[0].error)){var s=n.infos.sources[0],l=s.error.errorMessage;console.error("Error with federated search: ["+s.error.errorCode+"] "+l),d.displayNotification({title:p.msg_error_with_federated_search_title,message:p.msg_error_with_federated_search_message,className:"error"})}var u=(n="string"==typeof n?JSON.parse(n):n).results?n.results:[];if(i.managePlaceholderDisplay(n.results.length)?i.getView()._addPlaceHolder():i.getView().removePlaceHolder(),i._tagNavigator&&!o){var h,g=e.isFilterOperation;i.dataProvider.getConfigurePredicates&&(h=i.dataProvider.getConfigurePredicates(n.facets)),i._tagNavigator._setSubjectTags(n.facets,t,g,h),i._tagNavigator.activateTaggerProxy()}i._libraryContentView._endContentSelect();var f=!e.isPaginationOperation,_=i._libraryContentView.displayContentNodes(u,null,r,f,a);i._libraryContentView._endLoadAndSelect(),i._libraryContentView.webUXLoader(!1),c(_)}),(function(e){i._logger.log("WebService roots, Err : "+e),i._libraryContentView.webUXLoader(!1),i._libraryContentView._endLoadAndSelect(),c(null)}))}))},refreshLibraryContent:function(e,t,i,n,r,o){var a=this,s=a.getView().getPADTreeDocument();s&&s.keepExpandedState();var l=a.CSOProvider.getCurrentObject();if(null!=l)if(1==l.noTree)a.loadContentAndSelect(e,t,i,n,r,o);else{var d=l.getType();(!l.isVisible()&&!l.isFavorite||a.dataProvider.isSection(d))&&a.loadContentAndSelect(l)}},switchLibraryTreeNodeLabelToWriteView:function(e){var t=!1;if(this._libraryContentView.getPADTreeDocument()&&e.getTreeDocument()===this._libraryContentView.getPADTreeDocument()){var i;"datagridview"===this._libraryContentView.getActiveView()&&(i=this._libraryContentView.getPADTreeListView());var n=i?i.getManager():void 0;if(n){var r=n.layout.getColumnIndex("tree"),o=n.layout.getCellsFromNodeModel(e)[r],a=n.getEditionManager(o);a.onF2&&(n.setActiveCell(o),a.onF2(o),t=!0)}}return t},getView:function(){return this._libraryContentView},managePlaceholderDisplay:function(e){if(a.isNatifEnvironnement())return!1;if(null!=this.CSOProvider.getCurrentObject()){var t=this.CSOProvider.getCurrentObject().getType(),i=b.getWidgetData();return!!this.dataProvider.isValidTypeForPlaceholder(t,i)&&(m.isSearchActive()?!(!this.dataProvider.showSearchPlaceHolder||!this.dataProvider.showSearchPlaceHolder()):0===e)}},displayDynamicAttributes:function(e,t,i){this._libraryContentView.displayDynamicAttributes(e,t,i)}});return w}));