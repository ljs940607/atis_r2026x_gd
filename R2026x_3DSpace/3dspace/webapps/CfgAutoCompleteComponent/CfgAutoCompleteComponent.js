define("DS/CfgAutoCompleteComponent/Presenter/CfgAutoCompleteUtils",["UWA/Core","DS/CfgDictionary/CfgDictionaryTypeEnum","DS/CfgDictionary/CfgDictionaryOperatorEnum"],(function(e,t,a){"use strict";var r={};return r.getDatasetItemFromId=function(e,t){var a=0,r=0;for(a=0;a<e.datasets.length;a+=1)for(r=0;r<e.datasets[a].items.length;r+=1)if(e.datasets[a].items[r].id_===t)return e.datasets[a].items[r];return null},r.getDatasetItemFrom=function(t,a){var r=0,o=0;for(r=0;r<t.datasets.length;r+=1)for(o=0;o<t.datasets[r].items.length;o+=1){if(t.datasets[r].items[o].id_===a||e.is(t.datasets[r].items[o].value,"string")&&(t.datasets[r].items[o].value&&t.datasets[r].items[o].value.toUpperCase()===a.toUpperCase()||t.datasets[r].items[o].name&&t.datasets[r].items[o].name.toUpperCase()===a.toUpperCase()))return t.datasets[r].items[o];if(a===t.datasets[r].items[o].label)return t.datasets[r].items[o]}return null},r.getFlatListOfIds=function(t){var a,r=[];if(a=t.dataTransfer.getData("Text"),!(a=JSON.parse(a)))return[];var o=0,n=0;if("2.0"===a._version||2===a._version){if(e.is(a.variantClasses,"array"))for(o=0;o<a.variantClasses.length;o+=1)if(a.variantClasses[o].variants&&a.variantClasses[o].variants.length>0)for(n=0;n<a.variantClasses[o].variants.length;n+=1)r.push(a.variantClasses[o].variants[n].id);else r.push(a.variantClasses[o].id);if(e.is(a.options,"array"))for(o=0;o<a.options.length;o+=1)r.push(a.options[o].id);if(a.packs)for(o=0;o<a.packs.length;o+=1)r.push(a.packs[o].id)}else if(e.is(a.features,"array"))for(o=0;o<a.features.length;o+=1)if(a.features[o].options&&a.features[o].options.length>0)for(n=0;n<a.features[o].options.length;n+=1)r.push(a.features[o].options[n].id);else r.push(a.features[o].id);return r},r.getRelativeBadgeAndIndexOnLeft=function(e,t){return 0===e?null:-1===e?t.length>0?{badge:t[t.length-1],index:t.length-1}:null:{badge:t[e-1],index:e-1}},r.getEvalContextPosition=function(t,r){-1===t&&(t=r.length);for(var o=0,n=void 0,i=-1,s=t;s--&&e.is(r[s],"object");)if(r[s].type===a.closing_separator)o--;else if(r[s].type===a.opening_separator)o++;else if(r[s].type===a.eval_function&&o>=0){n=s;break}if(e.is(n,"number")){o=0;for(var l=n;l<r.length;l++)if(r[l].type===a.closing_separator?o--:r[l].type===a.opening_separator&&o++,r[l].type===a.closing_separator&&0===o){i=l;break}if(n<=t&&(-1===i||i>=t))return{startPosition:n,endPosition:i}}},r.isClosingSeparatorEndOfEval=function(e,t){-1===e&&(e=t.length);for(var r=0,o=!1,n=e;n--;)if(t[n].type===a.closing_separator)r--;else if(t[n].type===a.opening_separator)r++;else if(t[n].type===a.eval_function&&1===r){o=!0;break}return o},r.selectedItemsToString=function(e){var t="";return e.forEach((e=>{t+=" "+e.label})),t},r.hasBadgeTypeInEval=function(e,t,a){var r=!1;return this._checkInEval(t,a,((a,o)=>{r||(r=a.type===e&&o!==t)})),r},r.isParameterInCurrentEval=function(e,a){var r=!1;return this._checkInEval(e,a,((o,n)=>{r||(r=n!==e&&e<a.length&&o.type===t.PARAMETER&&o.value===a[e].value)})),r},r.getParametersInCurrentEval=function(e,t){var a=[];return this._checkInEval(e,t,(e=>{a.push(e.value)})),a},r.getCurrentParameterUnit=function(e,a,r){var o=void 0;return this._checkInEval(e,a,(e=>{if(e.type===t.PARAMETER){var a=r[e.id_].min.split(" ");o=a[1]?a[1]:""}})),o},r._checkInEval=function(t,a,r){t=-1===t?a.length:t;var o=this.getEvalContextPosition(t,a);if(e.is(o,"object"))for(var n=-1===o.endPosition?a.length-1:o.endPosition,i=o.startPosition+2;i<n;i++)r(a[i],i)},r.hasParametersWithSameUnit=function(e,a,r){var o=void 0,n=void 0,i=!0;return this._checkInEval(e,a,(e=>{e.type===t.PARAMETER&&(o=(o=r[e.id_].min.split(" ")[1])||"",void 0===n?n=o:n!==o&&(i=!1))})),i},r.getRelativeContext=function(e,a){var r=this.getRelativeBadgeAndIndexOnLeft(e,a);if(!r)return null;var o,n,i,s=r.badge,l=r.index;if(s.type===t.VALUE)for(o=s.parent_,i=(n=l-1)>=0;i;){switch(a[n].type){case t.VALUE:if(o!==a[n].parent_)return null;break;case t.VARIANT:return o===a[n].id_?a[n]:null;default:return null}--n<0&&(i=!1)}else{if(s.type!==t.OPTION)return s;for(o=s.parent_,i=(n=l-1)>=0;i;){switch(a[n].type){case t.OPTION:if(o!==a[n].parent_)return null;break;case t.VARIABILITY_GROUP:return o===a[n].id_?a[n]:null;default:return null}--n<0&&(i=!1)}}return null},r._isBadgeAllowedAfterClosingSeparator=function(t,r,o){return!e.is(this.getEvalContextPosition(r,o,"object"))&&(t===a.binary_operator_id||t===a.closing_separator_id)},r._isBadgeAllowedAfterOpeningSeparator=function(r,o,n){return e.is(this.getEvalContextPosition(o,n,"object"))?r===t.PARAMETER||r===t.NUMBER||r===t.FRACTION||r===a.arithmetic_operator_id:r!==a.binary_operator_id&&r!==a.closing_separator_id&&r!==t.PARAMETER&&r!==t.NUMBER&&r!==t.FRACTION&&r!==a.arithmetic_operator_id},r._isBadgeAllowedAfterArithmeticOperator=function(e){return e===t.PARAMETER||e===t.FRACTION||e===t.NUMBER},r._isBadgeAllowedAfterComparisonOperator=function(e){return e===t.PARAMETER||e===a.arithmetic_operator_id||e===t.FRACTION||e===t.NUMBER},r._isBadgeAllowedAfterEvalFunction=function(e,t){return(!t||t.badge.type!==a.opening_separator)&&e===a.opening_separator_id},r._isBadgeAllowedAfterUnaryOperator=function(r,o,n){return!e.is(this.getEvalContextPosition(o,n),"object")&&r!==a.binary_operator_id&&r!==a.closing_separator_id&&r!==a.comparison_operator_id&&r!==a.arithmetic_operator_id&&r!==t.PARAMETER&&r!==t.FRACTION&&r!==t.NUMBER},r._isBadgeAllowedAfterBinaryOperator=function(r,o,n){return!e.is(this.getEvalContextPosition(o,n),"object")&&r!==a.binary_operator_id&&r!==a.closing_separator_id&&r!==a.comparison_operator_id&&r!==a.arithmetic_operator_id&&r!==t.PARAMETER&&r!==t.FRACTION&&r!==t.NUMBER},r._isBadgeAllowedAfterValueAndOption=function(t,r,o,n){var i=!0;return this.getRelativeContext(r,o)&&(i=t===n.badge.parent_||t===a.binary_operator_id||t===a.closing_separator_id),e.is(this.getEvalContextPosition(r,o),"object")&&(i=!1),i},r._isBadgeAllowedAfterNumberAndFraction=function(e,r,o){return e===a.comparison_operator_id&&!this.hasBadgeTypeInEval(a.comparison_operator,r,o)||e===a.arithmetic_operator_id||e===t.PARAMETER||e===a.closing_separator_id},r._isBadgeAllowedAfterParameter=function(e,t,r){return e===a.comparison_operator_id&&!this.hasBadgeTypeInEval(a.comparison_operator,t,r)||e===a.arithmetic_operator_id||e===a.closing_separator_id},r._isBadgeAllowedAfterVariantOrOptionGroup=function(t,r,o,n){return!e.is(this.getEvalContextPosition(r,n),"object")&&(t===o||t===a.binary_operator_id||t===a.closing_separator_id)},r._isBadgeAllowedAfterBadgeType=function(e,r,o,n,i){var s=!0;switch(e.badge.type){case t.VARIANT:case t.VARIABILITY_GROUP:s=this._isBadgeAllowedAfterVariantOrOptionGroup(o,n,e.badge.id_autocomplete,i);break;case t.PARAMETER:s=this._isBadgeAllowedAfterParameter(o,n,i);break;case t.FRACTION:case t.NUMBER:s=this._isBadgeAllowedAfterNumberAndFraction(o,n,i);break;case t.VALUE:case t.OPTION:case t.PACK:s=this._isBadgeAllowedAfterValueAndOption(o,n,i,e);break;case a.binary_operator:s=this._isBadgeAllowedAfterBinaryOperator(o,n,i);break;case a.unary_operator:s=this._isBadgeAllowedAfterUnaryOperator(o,n,i);break;case a.eval_function:s=this._isBadgeAllowedAfterEvalFunction(o,r);break;case a.comparison_operator:s=this._isBadgeAllowedAfterComparisonOperator(o);break;case a.arithmetic_operator:s=this._isBadgeAllowedAfterArithmeticOperator(o);break;case a.opening_separator:s=this._isBadgeAllowedAfterOpeningSeparator(o,n,i);break;case a.closing_separator:s=this._isBadgeAllowedAfterClosingSeparator(o,n,i)}return s},r.isBadgeAllowedInContext=function(r,o,n,i,s,l=void 0){if(!e.is(n,"number"))return o!==a.binary_operator_id&&o!==a.closing_separator_id;var c=this.getRelativeBadgeAndIndexOnLeft(n,i),p=-1===n?null:this.getRelativeBadgeAndIndexOnLeft(n+1,i),u=r.isA||r.type,d=!0;if(c?(u!==t.VARIANT&&u!==t.VARIABILITY_GROUP||c.badge.type!==t.VARIANT&&c.badge.type!==t.VALUE&&c.badge.type!==t.VARIABILITY_GROUP&&c.badge.type!==t.OPTION||s(),d=this._isBadgeAllowedAfterBadgeType(c,p,o,n,i)):d=o!==a.binary_operator_id&&o!==a.closing_separator_id&&o!==a.comparison_operator_id&&o!==a.arithmetic_operator_id&&o!==t.PARAMETER&&o!==t.FRACTION&&o!==t.NUMBER,d&&(p&&p.badge&&p.badge.type===a.eval_function&&(d=d&&o!==a.eval_function_id),o===t.PARAMETER&&l)){var m=this.getCurrentParameterUnit(n,i,l),_=r.id_||r.id,g=l[_].min.split(" ")[1];if(g=g||"",e.is(m,"string")&&g!==m)d=!1;else this.getParametersInCurrentEval(n,i).includes(l[_].title)&&(d=!1)}return d},r})),define("DS/CfgAutoCompleteComponent/Presenter/CfgAutoCompleteChecks",["UWA/Core","DS/CfgDictionary/CfgDictionaryTypeEnum","DS/CfgDictionary/CfgDictionaryOperatorEnum","DS/CfgAutoCompleteComponent/Presenter/CfgAutoCompleteUtils","i18n!DS/CfgAutoCompleteComponent/assets/nls/CfgAutoCompleteComponent"],(function(e,t,a,r,o){"use strict";var n="S_OK",i="ERROR",s={dicoCheck:function(e,a,r){var s,l={};l._rc=n,l.discrepancyElements=[];var c=[],p={};for(s in e)e.hasOwnProperty(s)&&(c.push(s),p[e[s].name]="operand");for(s in a)a.hasOwnProperty(s)&&(c.push(s),p[a[s].value]="operator");var u=0;if(r&&r.selectedItems)for(u=0;u<r.selectedItems.length;u+=1){var d=r.selectedItems[u].value,m=r.selectedItems[u].id_;if(!m||-1===c.indexOf(m)&&!m.startsWith(t.NUMBER+"_")&&!m.startsWith(t.FRACTION+"_")){l._rc=i;var _=d+" "+o.isUnknown;l.discrepancyElements.push({id:null,idx:u,description:_})}}if(r&&r.badges)for(u=0;u<r.badges.length;u+=1)r.badges[u].elements.container.classList.remove("badge-operator"),r.badges[u].elements.container.classList.remove("badge-operand"),r.badges[u].elements.container.classList.remove("badge-unknown"),"operator"===p[r.selectedItems[u].value]?r.badges[u].elements.container.classList.add("badge-operator"):"operand"===p[r.selectedItems[u].value]?r.badges[u].elements.container.classList.add("badge-operand"):r.selectedItems[u].type===t.NUMBER||r.selectedItems[u].type===t.FRACTION?r.badges[u].elements.container.classList.add("badge-number"):r.badges[u].elements.container.classList.add("badge-unknown");return l},_checkNextTypeUnknown:function(e){var t,a=!1;return e&&e.id_||(a=!0,t=o.unknown),{error:a,nextType:t}},_grammarCheckForFirstBadge:function(e,r,n,i){var l,c,p=!1;switch(r.type){case t.VARIANT:case t.VARIABILITY_GROUP:case t.OPTION:case a.opening_separator:case a.eval_function:break;case a.unary_operator:if(1===e.selectedItems.length)p=!0,c=o.unknown;else{n=e.selectedItems[i+1];var u=s._checkNextTypeUnknown(n);p=u.error,c=u.nextType,p||n.type===t.OPTION||n.type===t.VARIANT||n.type===t.VARIABILITY_GROUP||n.type===a.opening_separator||n.type===a.unary_operator||n.type===a.eval_function||(p=!0,c=n.label)}break;case t.PARAMETER:case t.NUMBER:case t.FRACTION:case a.arithmetic_operator:case a.comparison_operator:p=!0,l=o.notExpectedOutOfEval;break;case a.binary_operator:p=!0,l=o.cannotStartExpressionWith+" "+r.label;break;default:p=!0}return{error:p,errorMessage:l,nextType:c}},_grammarCheckForValueAndOption:function(n,i,s,l){var c,p,u=!1;if(e.is(r.getEvalContextPosition(l,n.selectedItems),"object"))u=!0,c=o.notExpectedInEval;else{switch(i.type){case t.VALUE:case t.OPTION:i.parent_!==s.parent_&&(u=!0);break;case t.VARIANT:case t.VARIABILITY_GROUP:i.id_!==s.parent_&&(u=!0);break;default:u=!0}var d=n.selectedItems[l+1];!d||d.type!==t.PARAMETER&&d.type!==t.NUMBER&&d.type!==t.FRACTION&&d.type!==a.comparison_operator&&d.type!==a.arithmetic_operator||(u=!0,p=d.label)}return{error:u,errorMessage:c,nextType:p}},_grammarCheckForComparisonOperator:function(n,i,l){var c,p,u=!1,d=n.selectedItems[l+1];if(e.is(r.getEvalContextPosition(l,n.selectedItems),"object"))if(r.hasBadgeTypeInEval(a.comparison_operator,l,n.selectedItems))u=!0,c=o.notExpectingSeveralComparisonOperatorsInEval;else if(i.type!==t.PARAMETER&&i.type!==t.NUMBER&&i.type!==t.FRACTION)u=!0;else{var m=s._checkNextTypeUnknown(d);u=m.error,p=m.nextType,u||d.type===t.PARAMETER||d.type===t.NUMBER||d.type===t.FRACTION||d.type===a.arithmetic_operator||(u=!0,p=d.label)}else u=!0,c=o.notExpectedOutOfEval;return{error:u,errorMessage:c,nextType:p}},_grammarCheckForArithmeticOperator:function(n,i,l){var c,p,u=!1,d=n.selectedItems[l+1];if(e.is(r.getEvalContextPosition(l,n.selectedItems),"object"))if(i.type!==t.PARAMETER&&i.type!==t.NUMBER&&i.type!==t.FRACTION&&i.type!==a.opening_separator&&i.type!==a.comparison_operator)u=!0;else{var m=s._checkNextTypeUnknown(d);u=m.error,p=m.nextType,u||d.type===t.PARAMETER||d.type===t.FRACTION||d.type===t.NUMBER||(u=!0,p=d.label)}else u=!0,c=o.notExpectedOutOfEval;return{error:u,errorMessage:c,nextType:p}},_grammarCheckForEvalFunction:function(t,n,i){var l,c,p=!1,u=t.selectedItems[i+1];if(e.is(r.getEvalContextPosition(i,t.selectedItems),"object"))p=!0,l=o.notExpectedInEval;else if(n.type!==a.binary_operator&&n.type!==a.unary_operator&&n.type!==a.opening_separator)p=!0;else{var d=s._checkNextTypeUnknown(u);p=d.error,c=d.nextType,p||u.type===a.opening_separator||(p=!0,c=u.label)}return{error:p,errorMessage:l,nextType:c}},_grammarCheckForClosingSeparator:function(n,i,s,l){var c,p=!1;return e.is(r.getEvalContextPosition(s,n.selectedItems),"object")?r.isClosingSeparatorEndOfEval(s,n.selectedItems)?(l=void 0,i.type!==t.PARAMETER&&i.type!==t.FRACTION&&i.type!==t.NUMBER?p=!0:r.hasBadgeTypeInEval(t.PARAMETER,s,n.selectedItems)?r.hasBadgeTypeInEval(a.comparison_operator,s,n.selectedItems)||(p=!0,c=o.missingComparisonOperatorInEval):(p=!0,c=o.missingParameterInEval)):(p=!0,c=o.notExpectedInEval):i.type!==t.OPTION&&i.type!==t.VARIANT&&i.type!==t.VARIABILITY_GROUP&&i.type!==t.VALUE&&i.type!==a.closing_separator&&(p=!0),{error:p,errorMessage:c,hasParametersWithSameUnit:l}},_grammarCheckForOpeningSeparator:function(n,i,l){var c,p=n.selectedItems[l+1],u=s._checkNextTypeUnknown(p),d=u.error,m=u.nextType;return e.is(r.getEvalContextPosition(l-1,n.selectedItems),"object")?(d=!0,c=o.notExpectedInEval):l>0&&n.selectedItems[l-1].type===a.eval_function?d||p.type===a.arithmetic_operator||p.type===t.PARAMETER||p.type===t.FRACTION||p.type===t.NUMBER||(d=!0,m=p.label):i.type!==a.binary_operator&&i.type!==a.opening_separator&&i.type!==a.unary_operator?d=!0:d||p.type===t.OPTION||p.type===t.VARIANT||p.type===t.VARIABILITY_GROUP||p.type===a.opening_separator||p.type===a.unary_operator||p.type===a.eval_function||(d=!0,m=p.label),{error:d,errorMessage:c,nextType:m}},_grammarCheckForUnaryOperator:function(n,i,l){var c,p,u=!1,d=n.selectedItems[l+1];if(e.is(r.getEvalContextPosition(l,n.selectedItems),"object"))u=!0,c=o.notExpectedInEval;else if(i.type!==a.binary_operator&&i.type!==a.opening_separator&&i.type!==a.unary_operator)u=!0;else{var m=s._checkNextTypeUnknown(d);u=m.error,p=m.nextType,u||d.type===t.OPTION||d.type===t.VARIANT||d.type===t.VARIABILITY_GROUP||d.type===a.opening_separator||d.type===a.unary_operator||d.type===a.eval_function||(u=!0,p=d.label)}return{error:u,errorMessage:c,nextType:p}},_grammarCheckForBinaryOperator:function(n,i,l){var c,p,u=!1,d=n.selectedItems[l+1];if(e.is(r.getEvalContextPosition(l,n.selectedItems),"object"))u=!0,c=o.notExpectedInEval;else if(i.type!==t.OPTION&&i.type!==t.VARIANT&&i.type!==t.VARIABILITY_GROUP&&i.type!==t.VALUE&&i.type!==a.closing_separator)u=!0;else{var m=s._checkNextTypeUnknown(d);u=m.error,p=m.nextType,u||d.type===t.VARIANT||d.type===t.VARIABILITY_GROUP||d.type===a.opening_separator||d.type===a.unary_operator||d.type===a.eval_function||(u=!0,p=d.label)}return{error:u,errorMessage:c,nextType:p}},_grammarCheckForNumberAndFraction:function(n,i,l){var c,p,u=!1,d=n.selectedItems[l+1];if(e.is(r.getEvalContextPosition(l,n.selectedItems),"object"))if(i.type!==a.opening_separator&&i.type!==a.comparison_operator&&i.type!==a.arithmetic_operator)u=!0;else{var m=s._checkNextTypeUnknown(d);u=m.error,p=m.nextType,u||d.type===a.comparison_operator||d.type===a.arithmetic_operator||d.type===a.closing_separator||d.type===t.PARAMETER||(u=!0,p=d.label)}else u=!0,c=o.notExpectedOutOfEval;return{error:u,errorMessage:c,nextType:p}},_grammarCheckForParameter:function(n,i,l,c,p){var u,d,m=!1,_=n.selectedItems[l+1];if(e.is(r.getEvalContextPosition(l,n.selectedItems),"object"))if(void 0===c&&(c=r.hasParametersWithSameUnit(l,n.selectedItems,p)),c)if(i.type!==a.opening_separator&&i.type!==t.NUMBER&&i.type!==t.FRACTION&&i.type!==a.comparison_operator&&i.type!==a.arithmetic_operator)m=!0;else{var g=s._checkNextTypeUnknown(_);m=g.error,d=g.nextType,m||_.type===a.comparison_operator||_.type===a.arithmetic_operator||_.type===a.closing_separator?r.isParameterInCurrentEval(l,n.selectedItems)&&(m=!0,u=o.parameterCannotBeComparedToItself):(m=!0,d=_.label)}else m=!0,u=o.parametersShouldHaveTheSameUnit;else m=!0,u=o.notExpectedOutOfEval;return{error:m,errorMessage:u,nextType:d,hasParametersWithSameUnit:c}},_grammarCheckForVariantAndOptionGroup:function(n,i,s){var l,c,p=!1,u=n.selectedItems[s+1];return e.is(r.getEvalContextPosition(s,n.selectedItems),"object")?(p=!0,l=o.notExpectedInEval):i.type!==a.opening_separator&&i.type!==a.unary_operator&&i.type!==a.binary_operator&&(p=!0),!u||u.type!==t.PARAMETER&&u.type!==t.NUMBER&&u.type!==t.FRACTION&&u.type!==a.comparison_operator&&u.type!==a.arithmetic_operator||(p=!0,c=u.label),{error:p,errorMessage:l,nextType:c}},_grammarCheckByBadgeType:function(e,r,o,n,i,l){var c;switch(r.type){case t.VALUE:case t.OPTION:c=s._grammarCheckForValueAndOption(o,n,r,i);break;case t.VARIANT:case t.VARIABILITY_GROUP:c=s._grammarCheckForVariantAndOptionGroup(o,n,i);break;case t.PARAMETER:c=s._grammarCheckForParameter(o,n,i,l,e);break;case t.FRACTION:case t.NUMBER:c=s._grammarCheckForNumberAndFraction(o,n,i);break;case a.binary_operator:c=s._grammarCheckForBinaryOperator(o,n,i);break;case a.unary_operator:c=s._grammarCheckForUnaryOperator(o,n,i);break;case a.opening_separator:c=s._grammarCheckForOpeningSeparator(o,n,i);break;case a.closing_separator:c=s._grammarCheckForClosingSeparator(o,n,i,l);break;case a.eval_function:c=s._grammarCheckForEvalFunction(o,n,i);break;case a.arithmetic_operator:c=s._grammarCheckForArithmeticOperator(o,n,i);break;case a.comparison_operator:c=s._grammarCheckForComparisonOperator(o,n,i);break;default:c={error:!0,unknown:!0}}return c},grammarCheck:function(e,t){var r={};r._rc=n,r.discrepancyElements=[];var c=!1,u=null,d=!1,m=null,_=[];if(t&&t.selectedItems){var g=0;for(g=0;g<t.selectedItems.length;g+=1){c=!1,u=null,d=!1,m=null;var f=t.selectedItems[g],v=null,h=void 0;if(g>0&&(v=t.selectedItems[g-1]),v){var y=s._grammarCheckByBadgeType(e,f,t,v,g,h);c=y.error,m=y.errorMessage,u=y.nextType,h=y.hasParametersWithSameUnit,d=y.unknown}else{var I=s._grammarCheckForFirstBadge(t,f,null,g);c=I.error,m=I.errorMessage,u=I.nextType}if(c){_.push(g),r._rc=i;var A=f.id_,E=v&&v.value?o.inContextOF+" : "+v.label:o.error;m?E=m:u?E=o.notExpectingToBeFollowedBy+" : "+u:d&&(E=f.value+" "+o.isUnknownFromDictionary),r.discrepancyElements.push({id:A,idx:g,description:E})}}var C=l(t);if(C._rc===i)for(r._rc=i,g=0,g=0;g<C.discrepancyElements.length;g+=1){var b=C.discrepancyElements[g].idx,R=p(r,b);R?R.description+=" "+C.discrepancyElements[g].description:(r.discrepancyElements.push(C.discrepancyElements[g]),b>0&&!p(r,b-1)&&t.selectedItems[b-1].type===a.eval_function&&r.discrepancyElements.push({id:a.eval_function_id,idx:b-1,description:r.discrepancyElements[r.discrepancyElements.length-1].description}))}}return r},dicoAndGrammarCheckAndUpdateUI:function(e,t,a){var r=s.dicoCheck(e,t,a),o=s.grammarCheck(e,a),l={};return l._rc=n,l._rc=r._rc===i?i:l._rc,l._rc=o._rc===i?i:l._rc,l.discrepancyElements=r.discrepancyElements.concat(o.discrepancyElements),c(l,a,"badge-error"),l},getGlobalErrorCounts:function(e,t,a){var r=s.dicoCheck(e,t,a),o=s.grammarCheck(e,a),l={};l._rc=n,l._rc=r._rc===i?i:l._rc,l._rc=r._rc===i?i:l._rc;var c=[],p=0;for(p=0;p<r.discrepancyElements.length;p+=1)c.push(r.discrepancyElements[p].idx);var u=[];for(p=0;p<o.discrepancyElements.length;p+=1)u.push(o.discrepancyElements[p].idx);var d=c.concat(u);return(d=d.filter((function(e,t){return d.indexOf(e)===t}))).length}},l=function(e){var t={};t._rc=n,t.discrepancyElements=[];var r=e.selectedItems.length,s=[],l=[],c=0,p=0,u=0;for(p=0;p<r;p+=1)if(e.selectedItems[p].type===a.opening_separator){for(c=1,u=p+1;u<r;u+=1)if(e.selectedItems[u].type===a.opening_separator?c+=1:e.selectedItems[u].type===a.closing_separator&&(c-=1),0===c){s.push(p),l.push(u);break}0!==c&&(t._rc=i,t.discrepancyElements.push({id:e.selectedItems[p].id_,idx:p,description:o.correspondingClosingOperatorNotFound}))}for(p=0;p<r;p+=1)e.selectedItems[p].type===a.closing_separator&&-1===l.indexOf(p)&&(t._rc=i,t.discrepancyElements.push({id:e.selectedItems[p].id_,idx:p,description:o.correspondingOpeningOperatorNotFound}));return t},c=function(e,t,a){var r=0;for(r=0;r<t.badges.length;r+=1)t.badges[r].getContent().title="",t.badges[r].getContent().classList.remove(a),t.badges[r].getContent().classList.remove("badge-default"),t.badges[r].getContent().classList.remove("badge-closable"),t.badges[r].getContent().classList.remove("badge-selected"),null!==p(e,r)?(t.badges[p(e,r).idx].getContent().classList.add(a),t.badges[r].getContent().title=p(e,r).description):t.badges[r].getContent().classList.add("badge-default");return e.discrepancyElements},p=function(e,t){var a=0;for(a=0;a<e.discrepancyElements.length;a+=1)if(e.discrepancyElements[a].idx===t)return e.discrepancyElements[a];return null};return s})),define("DS/CfgAutoCompleteComponent/Presenter/CfgAutoCompletePresenter",["UWA/Core","UWA/Class/View","UWA/Class/Model","DS/Handlebars/Handlebars","DS/CfgAutoCompleteComponent/Presenter/CfgAutoCompleteChecks","DS/CfgAutoCompleteComponent/Presenter/CfgAutoCompleteUtils","DS/UIKIT/Autocomplete","DS/CfgDictionary/CfgDictionaryMapperUtils","DS/CfgDictionary/CfgDictionaryOperatorEnum","DS/CfgDictionary/CfgDictionaryOperatorMapper","DS/CfgDictionary/CfgDictionaryTypeEnum","text!DS/CfgAutoCompleteComponent/assets/NumericalParameterConstants.json","i18n!DS/CfgAutoCompleteComponent/assets/nls/CfgAutoCompleteComponent","text!DS/CfgAutoCompleteComponent/View/CfgAutoCompleteTemplate.html","css!DS/CfgAutoCompleteComponent/View/CfgAutoComplete.css","css!DS/UIKIT/UIKIT.css"],(function(e,t,a,r,o,n,i,s,l,c,p,u,d,m){"use strict";const _=JSON.parse(u);var g=!1,f="S_OK",v=r.compile(m);return t.extend({name:"autocomplete-rule-view",tagName:"div",init:function(t){var a=this;for(var r in t)t.hasOwnProperty(r)&&(this[r]=t[r]);this._minLengthBeforeSearch=e.is(t.minLengthBeforeSearch,"number")?t.minLengthBeforeSearch:1,this._showOptionGroup=t.showOptionGroup,this._parent(t),this.container.setHTML(v(t)),a._autocomplete.inject(a.container.getElement(".autocomplete-rule-content-section")),a.container.getElement(".autocomplete-rule-content-section").ondrop=function(t){t.preventDefault();var r;r=n.getFlatListOfIds(t);var i=null,s=0,l=t.target,c=-1;for(s=0;s<a._autocomplete.innerInputs.length;s+=1)if(l===a._autocomplete.innerInputs[s]){c=s;break}var u=c>=0?c:a._autocomplete.badges.length;for(s=0;s<r.length;s+=1)if(i=r[s]){var d=n.getDatasetItemFromId(a._autocomplete,i);if(d){if(d.type===p.VALUE){var m=n.getRelativeContext(u,a._autocomplete.selectedItems);if(m&&m.id_===d.parent_)a._autocomplete.onSelect(d,u),u+=1;else{a._autocomplete.onSelect(d,u);var _=n.getDatasetItemFromId(a._autocomplete,d.parent_);a._autocomplete.onSelect(_,u),u+=2}}else a._autocomplete.onSelect(d,u),u+=1;var g=o.dicoAndGrammarCheckAndUpdateUI(a._mapDico,a._mapOperator,a._autocomplete);a._errorDicoOrGrammar=g._rc!==f,a.updateExpression(),a._localModelEvent&&a._localModelEvent.publish({event:"onChangeExpression",data:null})}else e.log("object with id "+i+" not found in dictionary")}else e.log("object dropped not supported");a._autocomplete.onHideSuggests()},a.container.getElement(".autocomplete-rule-content-section").onpaste=function(t){e.log("paste");var r=[];t.clipboardData?r=t.clipboardData.getData("text/plain").split("|"):window.clipboardData&&(r=window.clipboardData.getData("text").split("|"));var i=t.target,s=-1,l=0;for(l=0;l<a._autocomplete.innerInputs.length;l+=1)if(i===a._autocomplete.innerInputs[l]){s=l;break}var c,p=s>=0?s:a._autocomplete.badges.length,u=0;for(u=0;u<r.length;u+=1){var d=n.getDatasetItemFrom(a._autocomplete,r[u]);d?a._autocomplete.onSelect(d,p):(c=a._getNumberOrFractionWithoutUnnecessaryZeroAndWhitespace(r[u]),a._isCorrectNumber(c)?a._selectNumber(c,p):a._isCorrectFraction(c)?a._selectFraction(c,p):a._autocomplete.onSelect({label:r[u],value:r[u],id_:null},p)),p>=0&&(p+=1)}var m=o.dicoAndGrammarCheckAndUpdateUI(a._mapDico,a._mapOperator,a._autocomplete);a._errorDicoOrGrammar=m._rc!==f,a.updateExpression(),a._localModelEvent&&r.length>0&&a._localModelEvent.publish({event:"onChangeExpression",data:null}),t.preventDefault(),a._autocomplete.currentPosition+=r.length-1,a._autocomplete.innerInputs[a._autocomplete.currentPosition]?(a._autocomplete.innerInputs[a._autocomplete.currentPosition].focus(),a._autocomplete.innerInputs[a._autocomplete.currentPosition].select()):(a.container.querySelector(".autocomplete-input").focus(),a.container.querySelector(".autocomplete-input").select())},a.createInitialExpression(),a._autocomplete.onHideSuggests(),a.currentInput=a._autocomplete.elements.input},setup:function(t){var r=this;r._mapDico={},r._mapOperator={},r._errorDicoOrGrammar=!0,r._editable=t.editable,r.container.addClassName(this.getClassNames("-container")),r._context=null,r._badgeOnLeft=null,r._lastPosition=void 0,r.model=new a(t),r._localModelEvent=t._localModelEvent,r._withAdvancedOperator=!e.is(t.withAdvancedOperator,"boolean")||t.withAdvancedOperator;r._localModelEvent&&r._editable&&r._localModelEvent.subscribe({event:"onPlus"},(function(t){if(t.clickedId){var a=n.getDatasetItemFromId(r._autocomplete,t.clickedId);if(a){var i=e.is(r._lastPosition)?r._lastPosition:r._autocomplete.currentPosition;if(a.type===p.VALUE||a.type===p.OPTION){var s,l=n.getRelativeContext(i,r._autocomplete.selectedItems);l&&l.id_===a.parent_?(r._autocomplete.onSelect(a,i),i++):(s=n.getDatasetItemFromId(r._autocomplete,a.parent_),r._autocomplete.onSelect(s,i),i>=0&&i++,r._autocomplete.onSelect(a,i),i>=0&&i++)}else r._autocomplete.onSelect(a,i),i>=0&&i++;var c=o.dicoAndGrammarCheckAndUpdateUI(r._mapDico,r._mapOperator,r._autocomplete);r._errorDicoOrGrammar=c._rc!==f,r.updateExpression(),r._localModelEvent&&r._localModelEvent.publish({event:"onChangeExpression",data:null})}else e.log("object with id "+t.clickedId+" not found in dictionary")}r._autocomplete.onHideSuggests()}));var s=function(e){if(e.items[0].disabled=!1,n.isBadgeAllowedInContext(e.items[0],e.id_autocomplete,r._autocomplete.currentPosition,r._autocomplete.selectedItems,(()=>{e.items[0].disabled=!0}))){if(e.id_autocomplete===p.PARAMETER){var t=e.suggestions.filter((t=>n.isBadgeAllowedInContext(t,e.id_autocomplete,r._autocomplete.currentPosition,r._autocomplete.selectedItems,(()=>{e.items[0].disabled=!0}),r._mapDico)));e.suggestions=t}return e}},c=!1;0===r._minLengthBeforeSearch&&(c=!0),r._autocomplete=new i({showSuggestsOnFocus:c,minLengthBeforeSearch:r._minLengthBeforeSearch,floatingSuggestions:!0,multiSelect:!0,itemMultiSelect:!0,placeholder:"",noResultsMessage:!1,closableItems:!1,allowFreeInput:!0,filterEngine:function(e){if(r._withAdvancedOperator&&r.currentInput){var t=r._autocomplete.getDataset("dataset"+l.comparison_operator);if(e[0]&&r._isCorrectNumber(r.currentInput.value)){var a=e.find((e=>e.name==="datasetname"+p.NUMBER&&e.suggestions[0].value===r.currentInput.value));(e=e.filter((e=>e.name!=="datasetname"+p.NUMBER))).unshift(a),e[0].id_autocomplete=p.NUMBER}else if(e[0]&&r._isCorrectFraction(r.currentInput.value)){var o=e.find((e=>e.name==="datasetname"+p.FRACTION&&e.suggestions[0].value===r.currentInput.value));(e=e.filter((e=>e.name!=="datasetname"+p.FRACTION))).unshift(o),e[0].id_autocomplete=p.FRACTION}else switch(r.currentInput.value){case"+":case"-":var n;(e=e.filter((e=>e.id_autocomplete!==l.arithmetic_operator_id||(n=e,!1)))).unshift(n);break;case"=":(e=[t])[0].suggestions=t.items.filter((e=>e.id_===l.equal_id||e.id_===l.not_equal_id));break;case"≠":(e=[t])[0].suggestions=t.items.filter((e=>e.id_===l.not_equal_id));break;case"<":(e=[t])[0].suggestions=t.items.filter((e=>e.id_===l.lower_id||e.id_===l.lower_equal_id));break;case"≤":case"<=":(e=[t])[0].suggestions=t.items.filter((e=>e.id_===l.lower_equal_id));break;case">":(e=[t])[0].suggestions=t.items.filter((e=>e.id_===l.greater_id||e.id_===l.greater_equal_id));break;case"≥":case">=":(e=[t])[0].suggestions=t.items.filter((e=>e.id_===l.greater_equal_id))}}return e=e.filter(s)},events:{onSelectBadge:function(){r._autocomplete.onHideSuggests()},onSelect:function(e){var t=document.activeElement;r._correctExpressionItem(r._autocomplete.currentPosition,e),r._autocomplete.onHideSuggests();var a=o.dicoAndGrammarCheckAndUpdateUI(r._mapDico,r._mapOperator,r._autocomplete);r._errorDicoOrGrammar=a._rc!==f,r.updateExpression(),t.focus(),r._localModelEvent&&r._localModelEvent.publish({event:"onChangeExpression",data:null})},onUnselect:function(e,t){var a=n.getRelativeBadgeAndIndexOnLeft(t,r._autocomplete.selectedItems),i=n.getRelativeBadgeAndIndexOnLeft(t+1,r._autocomplete.selectedItems);i&&(e.type!==l.opening_separator||!a||!a.badge||a.badge.type!==l.eval_function||i.badge&&i.badge.type===l.opening_separator?e.type===l.eval_function&&i.badge&&i.badge.type===l.opening_separator&&r._autocomplete.onUnselect(i.badge,i.index):r._autocomplete.onUnselect(a.badge,a.index));var s=o.dicoAndGrammarCheckAndUpdateUI(r._mapDico,r._mapOperator,r._autocomplete);r._errorDicoOrGrammar=s._rc!==f,r.updateExpression(),r._localModelEvent&&r._localModelEvent.publish({event:"onChangeExpression",data:null})},onBlur:function(){r._lastPosition=r._autocomplete.currentPosition},onFocus:function(){r._lastPosition=void 0},onKeyUp:function(e){r.currentInput=e.target;var t=r.currentInput.value.replaceAll(/\s/g,"");if(r._withAdvancedOperator&&r._isCorrectNumber(t)){r.currentInput.value=t;var a=r._autocomplete.getDataset("datasetname"+p.NUMBER),o=r._getNumberOrFractionWithoutUnnecessaryZeroAndWhitespace(r.currentInput.value);r.currentInput.value!==o&&(r.currentInput.value=o,r.currentInput.setSelectionRange(r.currentInputPosition,r.currentInputPosition),r.currentInput.focus()),a.items=[],r._autocomplete.addItems([{type:p.NUMBER,label:r.currentInput.value,value:r.currentInput.value,id_:p.NUMBER+"_"+r.currentInput.value,subLabel:"(number)"}],a),a.dataCache[r.currentInput.value]&&0!==a.dataCache[r.currentInput.value].length||(a.dataCache[r.currentInput.value]=a.items)}else if(r._withAdvancedOperator&&r._isCorrectFraction(t)){r.currentInput.value=t;var n=r._autocomplete.getDataset("datasetname"+p.FRACTION),i=r._getNumberOrFractionWithoutUnnecessaryZeroAndWhitespace(r.currentInput.value);r.currentInput.value!==i&&(r.currentInput.value=i,r.currentInput.setSelectionRange(r.currentInputPosition,r.currentInputPosition),r.currentInput.focus()),n.items=[],r._autocomplete.addItems([{type:p.FRACTION,label:r.currentInput.value,value:r.currentInput.value,id_:p.FRACTION+"_"+r.currentInput.value,subLabel:"(fraction)"}],n),n.dataCache[r.currentInput.value]&&0!==n.dataCache[r.currentInput.value].length||(n.dataCache[r.currentInput.value]=n.items)}else"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||r._localModelEvent.publish({event:"refreshDictionary"});e.stopPropagation()}}}),r.createMapDico(),r.createDataSet(r._withAdvancedOperator),!1===r._editable&&r._autocomplete.disable(),r._autocomplete.elements.inputContainer.addEventListener("click",(function(){r._localModelEvent&&r._localModelEvent.publish({event:"refreshDictionary"})}))},createMapDico:function(){this._mapDico=s.dicoMinifiedV3ToMap(this.model.get("dictionary"))},createDataSet:function(e){var t,a,r,o=this,n=0,i=o._mapDico,s=null,u=[],d={name:"datasetname"+p.PARAMETER,id_autocomplete:p.PARAMETER,id_:p.PARAMETER,displayName:g,items:[]},m={name:"datasetname"+p.NUMBER,id_autocomplete:p.NUMBER,id_:p.NUMBER,displayName:g,items:[]},_={name:"datasetname"+p.FRACTION,id_autocomplete:p.FRACTION,id_:p.FRACTION,displayName:g,items:[]},f=null;for(s in i)if(i.hasOwnProperty(s)){switch(i[s].type){case p.VALUE:break;case p.VARIANT:for((f={}).name="datasetname"+i[s].title,f.id_autocomplete=s,f.id_=s,f.displayName=g,f.items=[],f.items.push({value:i[s].title,id_autocomplete:s,id_:s,type:p.VARIANT}),f.items[0].items=[],n=0;n<i[s].values.length;n+=1)t=i[s].values[n],f.items[0].items.push({parent_:s,value:i[t].title,id_:t,type:p.VALUE});break;case p.PARAMETER:d.items.push({value:i[s].title,id_autocomplete:s,id_:s,type:p.PARAMETER});break;case p.VARIABILITY_GROUP:for((f={}).name="datasetname"+i[s].title,f.id_autocomplete=s,f.id_=s,f.displayName=g,f.items=[],f.items.push({value:i[s].title,id_autocomplete:s,id_:s,type:p.VARIABILITY_GROUP}),f.items[0].items=[],n=0;n<i[s].content.length;n+=1)t=i[s].content[n],f.items[0].items.push({parent_:s,value:i[t].title,id_:t,type:p.OPTION})}null!==f&&(u.push(f),f=null)}for(d.items.length>0&&u.push(d),u.push(m),u.push(_),n=0;n<u.length;n+=1)o._autocomplete.addDataset(u[n]);!1===e&&(delete c[l.eval_function],delete c[l.comparison_operator],delete c[l.arithmetic_operator],c[l.binary_operator].operators=c[l.binary_operator].operators.filter((e=>e.id_!==l.imply_id&&e.id_!==l.eqvlt_id))),Object.entries(c).forEach((([e,t])=>{(r=t.operators).forEach((t=>{t.type=e,o._mapOperator[t.id_]={value:t.value,type:t.type},t.label&&(o._mapOperator[t.id_].label=t.label)})),a={name:"dataset"+e,displayName:g,id_autocomplete:t.id,items:r},o._autocomplete.addDataset(a)}))},updateExpression:function(){var e=this,t=e._autocomplete.selectedItems,a=0,r=[];for(a=0;a<t.length;a+=1){var o={};o.id=t[a].id_?t[a].id_:"undefined",o.label=t[a].label?t[a].label:"undefined",o.type=t[a].type?t[a].type:"dummy",o.value=t[a].value?t[a].value:"undefined",r.push(o)}var n=e.model.get("currentExpression");null==n&&(n={}),n.items=r,r.length>0?e.container.querySelector(".autocomplete-input").placeholder="":e.container.querySelector(".autocomplete-input").placeholder=d._type_expression+"...",e.model.set("currentExpression",n)},_correctExpressions:function(){if(e.is(this._autocomplete.selectedItems,"array"))var t=0;for(;t<this._autocomplete.selectedItems.length;)this._correctExpressionItem(t,this._autocomplete.selectedItems[t]),t++},_correctExpressionItem:function(t,a){if(e.is(a,"object")&&e.is(a.value)){var r=this,o=()=>{var e;-1!==t?(e=n.getDatasetItemFromId(r._autocomplete,a.parent_),r._autocomplete.onSelect(e,t),t+=1):(e=n.getDatasetItemFromId(r._autocomplete,a.parent_),r._autocomplete.onSelect(e,r._autocomplete.badges.length-1),t=-1)};if(a.type)switch(a.type){case p.VALUE:null!==n.getRelativeContext(t,this._autocomplete.selectedItems)&&n.getRelativeContext(t,this._autocomplete.selectedItems).type===p.VARIANT&&n.getRelativeContext(t,this._autocomplete.selectedItems).id_===a.parent_||o();break;case p.OPTION:null!==n.getRelativeContext(t,this._autocomplete.selectedItems)&&n.getRelativeContext(t,this._autocomplete.selectedItems).type===p.VARIABILITY_GROUP&&n.getRelativeContext(t,this._autocomplete.selectedItems).id_===a.parent_||o();break;case l.eval_function:var i=this._autocomplete.selectedItems[t+1];if(!e.is(i,"object")||i.type!==l.opening_separator){t=-1!==t?t+1:-1;var s=this._autocomplete.getDataset("dataset"+l.opening_separator);this._autocomplete.onSelect(s.items.find((e=>e.id_===l.open_id)),t)}}else if(this._withAdvancedOperator){var c=this._getNumberOrFractionWithoutUnnecessaryZeroAndWhitespace(a.value);if(this._isCorrectNumber(c))this._autocomplete.onUnselect(a,t),this._selectNumber(c,t);else if(this._isCorrectFraction(c))this._autocomplete.onUnselect(a,t),this._selectFraction(c,t);else{var u=this._autocomplete.getDataset("dataset"+l.comparison_operator);"<="===a.value?(this._autocomplete.onUnselect(a),this._autocomplete.onSelect(u.items.find((e=>e.id_===l.lower_equal_id)),t),t=-1!==t?t+1:-1):">="===a.value&&(this._autocomplete.onUnselect(a),this._autocomplete.onSelect(u.items.find((e=>e.id_===l.greater_equal_id)),t),t=-1!==t?t+1:-1)}}r._autocomplete.currentPosition=t}},getExpression:function(){var e=this.model.get("currentExpression");return e&&e.items?e.items:[]},setExpression:function(e){this.model.set("currentExpression",e)},_getNumberOrFractionWithoutUnnecessaryZeroAndWhitespace:function(e){var t=e.replaceAll(/\s/g,"");if(e.contains("/")){var a=t.split("/");return parseInt(a[0])+"/"+parseInt(a[1])}return parseInt(t).toString()},_isCorrectNumber:function(e){return!!(/^[0-9]+$/.test(e)&&e<=_.numberMaxValue)},_isCorrectFraction:function(e){if(/^[0-9]+\/[0-9]+$/.test(e)){var t=e.split("/");if(t[0]<=_.fractionMaxValue&&t[1]<=_.fractionMaxValue&&t[1]>0)return!0}return!1},_selectNumber:function(e,t){var a=this._autocomplete.getDataset("datasetname"+p.NUMBER);a.items=[],this._autocomplete.addItems([{type:p.NUMBER,label:e,value:e,id_:p.NUMBER+"_"+e,subLabel:"(number)"}],a),this._autocomplete.onSelect(a.items[0],t)},_selectFraction:function(e,t){var a=this._autocomplete.getDataset("datasetname"+p.FRACTION);a.items=[],this._autocomplete.addItems([{type:p.FRACTION,label:e,value:e,id_:p.FRACTION+"_"+e,subLabel:"(fraction)"}],a),this._autocomplete.onSelect(a.items[0],t)},_isPlusOperatorNecessary:function(e,t){if(t>0)switch(e[t-1].type){case l.opening_separator:case l.comparison_operator:case l.arithmetic_operator:return!1}return!0},_createNumberOrFractionFromInitialExpression:function(e,t,a){var r,o=this,i=e.items[t].value.substring(0,1);for(var s of c[l.arithmetic_operator].operators)if(i===s.value&&(s.id_!==l.plus_id||s.id_===l.plus_id&&o._isPlusOperatorNecessary(o._autocomplete.selectedItems,o._autocomplete.badges.length))&&(r=n.getDatasetItemFromId(o._autocomplete,s.id_))){o._autocomplete.onSelect(r,o._autocomplete.badges.length);break}switch(a){case p.NUMBER:var u=e.items[t].value.substring(1);o._selectNumber(u,o._autocomplete.badges.length);break;case p.FRACTION:var d=e.items[t].value.substring(1);o._selectFraction(d,o._autocomplete.badges.length)}return r},createInitialExpression:function(){var t=this;t._autocomplete.unselectAll();var a=t.model.get("currentExpression"),r=JSON.parse(JSON.stringify(a));if(a&&a.items&&0!==a.items.length){var i,s=0;for(t.container.querySelector(".autocomplete-input").placeholder="",s=0;s<r.items.length;s+=1){var u=t._autocomplete.badges.length;if(u>0&&r.items[s].type===p.PARAMETER&&t._autocomplete.selectedItems[u-1].type===p.NUMBER&&"1"===t._autocomplete.selectedItems[u-1].value&&t._autocomplete.onUnselect(r.items[s-1],t._autocomplete.badges.length-1),!r.items[s].type||r.items[s].type.toLowerCase()!==p.NUMBER&&r.items[s].type.toLowerCase()!==p.FRACTION){if(i=n.getDatasetItemFromId(t._autocomplete,r.items[s].id))t._autocomplete.onSelect(i,t._autocomplete.badges.length);else if(c[l.comparison_operator]&&c[l.comparison_operator].operators){for(var m of c[l.comparison_operator].operators)if(a.items[s].value===m.value){i=n.getDatasetItemFromId(t._autocomplete,m.id_);break}i?t._autocomplete.onSelect(i,t._autocomplete.badges.length):t._autocomplete.onSelect({label:a.items[s].value,value:a.items[s].value,id_:null},t._autocomplete.badges.length)}}else i=t._createNumberOrFractionFromInitialExpression(r,s,r.items[s].type.toLowerCase());i=void 0}}else e.is(t.container.querySelector(".autocomplete-input"))&&(t.container.querySelector(".autocomplete-input").placeholder=d._type_expression+"...");t._correctExpressions();var _=o.dicoAndGrammarCheckAndUpdateUI(t._mapDico,t._mapOperator,t._autocomplete);t._errorDicoOrGrammar=_._rc!==f},getErrorsCount:function(){var e=this;return o.getGlobalErrorCounts(e._mapDico,e._mapOperator,e._autocomplete)},isThereError:function(){return this._errorDicoOrGrammar},getAutocomplete:function(){return this._autocomplete}})}));