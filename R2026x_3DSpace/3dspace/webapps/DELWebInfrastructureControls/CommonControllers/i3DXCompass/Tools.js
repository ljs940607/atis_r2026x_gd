define("DS/DELWebInfrastructureControls/CommonControllers/i3DXCompass/Tools",["UWA/Core","DS/DELWebInfrastructureControls/CommonControllers/i3DXCompass/Utils"],(function(e,t,n,o){"use strict";var i,r,s=!1,a=!1,c=null,l=!1,u=[],f=!0,d=null,p="en",h={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},g={os:null,browser:null,FEATURE_BETA_ACTIVATION:{},detectOs:function(){var e=g.getUserAgent().toLowerCase();e.indexOf("windows")>-1?g.os=e.indexOf("windows nt 10")>-1?"windows10":"windows":e.match(/(ipad|iphone|ipod)/g)?g.os="ios":e.indexOf("mac")>-1?g.os="macos":e.indexOf("android")>-1?g.os="android":e.indexOf("linux")>-1?g.os="linux":g.os="unknown"},isIphone:function(){var e=g.getUserAgent().toLowerCase();return/iphone/i.test(e)},_detectBrowser:function(){var e,t,n,o,i,r,s=(r=self.navigator.userAgent.toLowerCase()||"",o="ie"===(t=r.match(/(opera|ie|firefox|chrome|version)[\s/:]([\w\d.]+)[\s/:](safari|version)[\s/:]([\w\d.]+)[\s/:](vivaldi|opr|mms|edg)[\s/:]([\w\d.]+)/)||r.match(/(opera|ie|firefox|chrome|version)[\s/:]([\w\d.]+)?.*?(safari|version[\s/:]([\w\d.]+)|$)/)||r.match(/(webkit)\s\/:(\w\d\.+)/)||r.match(/(trident)\/.*rv:([\d.]+)/)||(global.process?[null,"nodeJS",global.process.version]:[null,"unknown",0]))[1]&&hasDocument&&document.documentMode||("opera"===t[1]&&t[4]?t[4]:t[2]),i=parseInt(o,10),t[5]&&t[6]?(n=t[5],o=t[6],i=parseInt(o,10)):n="version"===t[1]?t[3]:t[1],"trident"===n?n="ie":"opr"===n?n="opera":"mms"===n?n="opera-neon":"edg"===n&&(n="edge"),(e={name:n,version:i,fullVersion:o})[n]=i,e[n+i]=!0,e.webkit=Boolean(r.match(/webkit/)),e);self.navigator.userAgent.indexOf("Edge")>-1?g.browser="edge":s.ie?g.browser="internet explorer":g.browser=s.name},_fetchOsDistribution:function(){var e=g.getUserAgent().toLowerCase().match(/.* (\(.*)\) .*/m),t=null;if(e.length>1){var n=e[1].split(";");n.length>1&&-1===n[1].indexOf("linux")&&(t=n[1].trim())}return t},getOs:function(){return g.os||g.detectOs(),g.os},getOsDistribution:function(){return g.osDistribution||(g.osDistribution=g._fetchOsDistribution()),g.osDistribution},getBrowser:function(){return g.browser||g._detectBrowser(),g.browser},getMajorIosVersion:function(){if(!g.iosVersion&&/iP(hone|od|ad)/.test(navigator.platform)){var t=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);g.iosVersion=[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3]||0,10)],e.log("iOS version = "+g.iosVersion[0]+"."+g.iosVersion[1]+"."+g.iosVersion[2])}return g.iosVersion&&g.iosVersion[0]},getUserAgent:function(){return navigator.userAgent},arrayFind:function(e,t,n){var o;return e.some((function(e){if(t.call(n,e))return o=e,!0})),o},forEachOwnProperty:function(e,t,n){Object.keys(e).forEach((function(o){t.call(n,e[o],o)}))},pushUnique:function(e,t){-1===e.indexOf(t)&&e.push(t)},unshiftUnique:function(e,t){-1===e.indexOf(t)&&e.unshift(t)},moveToFirst:function(e,t){var n=e.indexOf(t);-1!==n&&e.unshift(e.splice(n,1)[0])},includes:function(e,t){return t.every((function(t){return-1!==e.indexOf(t)}))},intersection:function(e,t){return e.filter((function(e){return-1!==t.indexOf(e)}))},removeDoublons:function(e){var t=[];return e.forEach((function(e){g.pushUnique(t,e)})),t},customLaunchWebApp:function(){return!1},enableWidgetDrag:function(){},instanciateWidget:function(){},onRoleChange:function(){},setCustomFunction:function(e,t){["customLaunchWebApp","enableWidgetDrag","instanciateWidget","onRoleChange"].indexOf(e)>-1&&(g[e]=t)},disableSelect:function(){t.setStyles.call(document.body,{"-webkit-touch-callout":"none","-webkit-tap-highlight-color":"rgba(0, 0, 0, 0)","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"})},enableSelect:function(){t.setStyles.call(document.body,{"-webkit-touch-callout":"","-webkit-tap-highlight-color":"","-webkit-user-select":"","-moz-user-select":"","-ms-user-select":"","user-select":""})},isOverElement:function(e,t,n){return e.x>t.x&&e.x<t.x+n.width&&e.y>t.y&&e.y<t.y+n.height},isSameApp:function(e,t){return!!n.matchUrl(e,t)&&(n.parseUrl(e).directoryPath||"/").split("/")[1]===(n.parseUrl(t).directoryPath||"/").split("/")[1]},isBase64:function(e){return new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$").test(e)},isBase64Image:function(e){return e.indexOf("data:image")>-1&&e.indexOf(";base64,")>-1&&(e=e.split(";base64,")[1]),this.isBase64(e)},htmlEntityDecode:function(t){return e.createElement("div",{html:t}).getText()},now:Date.now||function(){return(new Date).getTime()},debounce:function(e,t,n){var o,i,r,s,a,c=function(){var l=g.now()-s;l<t&&l>=0?o=setTimeout(c,t-l):(o=null,n||(a=e.apply(r,i),o||(r=i=null)))};return function(){r=this,i=arguments,s=g.now();var l=n&&!o;return o||(o=setTimeout(c,t)),l&&(a=e.apply(r,i),r=i=null),a}},compareVersion:function(e,t){var n,o,i;for(e=e.split("."),t=t.split("."),o=Math.min(e.length,t.length),n=0;n<o;n++)if(0!==(i=parseInt(e[n],10)-parseInt(t[n],10)))return i;return e.length-t.length},i18n:function(t){var n=e.i18n(t);return n&&(n=n.replace("3DEXPERIENCE","<b>3D</b>EXPERIENCE")),n},isSmartphone:function(){return n.Client.getSize().width<959&&n.Client.getSize().height<570},isCarouselSmallSize:function(){return n.Client.getSize().width<1292&&n.Client.getSize().width>691},isValidMarketAppUrl:function(e){return/^[a-z]*:\/\/\?-.*/.test(e)},isOpenFullSize:function(){return this.isCompassV2()?n.Client.getSize().width<959:n.Client.getSize().width<641},isBetaModeActivated:function(t){var n=!1,o="3DCompass-"+t;if(void 0===this.FEATURE_BETA_ACTIVATION[o])try{n=!!e.is(localStorage.getItem(o)),this.FEATURE_BETA_ACTIVATION[o]=n}catch(t){e.log(t)}else n=this.FEATURE_BETA_ACTIVATION[o];return n},setCompassVersion:function(e){i=e||"V1"},isCompassV2:function(){return"V2"===this.getCompassVersion()},isDisableGoBack:function(){return self.location.search.indexOf&&self.location.search.toLowerCase().indexOf("role=true")>-1||self.location.pathname.indexOf("rootroles")>-1},isCompassV3:function(){return self.location.search.indexOf&&self.location.search.toLowerCase().indexOf("3dcompass_v3")>-1||"V3"===this.getCompassVersion()||"V32"===this.getCompassVersion()||"V34"===this.getCompassVersion()},isCompassV32:function(){return self.location.search.indexOf&&self.location.search.toLowerCase().indexOf("3dcompass_v3.2")>-1||self.location.search.toLowerCase().indexOf("3dcompass_v3.4")>-1||"V32"===this.getCompassVersion()||"V34"===this.getCompassVersion()},isCompassV34:function(){return self.location.search.indexOf&&self.location.search.toLowerCase().indexOf("3dcompass_v3.4")>-1||"V34"===this.getCompassVersion()},isCompassV34_debug:function(){return self.location.search.indexOf&&self.location.search.toLowerCase().indexOf("3dcompass_v3.4")>-1||"V34"===this.getCompassVersion()},isPlaygroundVisible:function(){return!(self.location.search.indexOf&&self.location.search.toLowerCase().indexOf("playground=false")>-1)},isCompassV3MainStream:function(){return self.location.search.indexOf&&self.location.search.toLowerCase().indexOf("3dcompass_v3_main")>-1},isCompassV3ActiveGroup:function(){return self.location.search.indexOf&&self.location.search.toLowerCase().indexOf("3dcompass_v3_activeGroup")>-1},isSupportQuickLink:function(){return self.location.search.indexOf&&self.location.search.toLowerCase().indexOf("3dcompass_v3_supportquicklink")>-1||!0===s},isSupportAddToFavorite:function(){return self.location.search.indexOf&&self.location.search.toLowerCase().indexOf("3dcompass_addtofavorite")>-1},isSupportQuickLinkFixMobileApp:function(){return document.querySelector("body.support-quick-link-fix-mobile-app")||!0===a},getCompassVersion:function(){return i},setCurrentQuadrant:function(e){r=e||this.isCompassV3()?e:"north"},setSupportQuickLink:function(e){s="V2"===e},setSupportQuickLinkFixMobileApp:function(e){a=e},getCurrentQuadrant:function(){return r},setShowCustom:function(e){f=e},getShowCustom:function(){return f||self.location.search.indexOf&&self.location.search.toLowerCase().indexOf("3dcp_show_custom")>-1},setIsMultiTenant:function(e){c=e},getIsMultiTenant:function(){return c},setTenantList:function(e){u=e},getTenantList:function(){return u},setPortfolioUrl:function(e){d=e},setBusinessExperienceAvailable:function(e){l=e},isBusinessExperienceAvailable:function(){return l},getPortfolioAssetTemplateUrl:function(t,n){if(d&&""!==d){if(-1===n.indexOf(d))return d+e.String.format("/assets/{0}/{1}",t,n)}else if(this.isCompassV34_debug()&&-1===n.indexOf("https://my3dexperience-portfolio.3dexperience.3ds.com"))return e.String.format("https://my3dexperience-portfolio.3dexperience.3ds.com/public/{0}/{1}",t,n);return n},getPortfolioApiTemplateUrl:function(t){return d&&""!==d?d+e.String.format("/data/{0}_{1}.json",t,p):e.String.format("https://my3dexperience-portfolio.3dexperience.3ds.com/api/v1/categories/type/{0}",t)},getPortfolioApiTemplateUrlNoNLS:function(t){return d&&""!==d?d+e.String.format("/data/{0}.json",t):e.String.format("https://my3dexperience-portfolio.3dexperience.3ds.com/api/v1/categories/type/{0}",t)},setLang:function(e){p=e},getAddinModeURL:function(){var e="";return self.location.search.indexOf&&self.location.search.toLowerCase().indexOf("addinmode=catiav5")>-1?e={value:"catiav5"}:self.location.search.indexOf&&self.location.search.toLowerCase().indexOf("addinmode=solidworks")>-1?e={value:"solidworks"}:self.location.search.indexOf&&self.location.search.toLowerCase().indexOf("addinmode=xvl")>-1&&(e={value:"xvl"}),e},manageSeoTags:function(e,t){var n=null,o=null,i=null;if(e){n=e.get?e.get("title"):e.title,(o=e.get?e.get("tagLine"):e.tagLine)||(o=e.get?e.get("description"):e.description)&&(o=o.substring(0,150));var r=e.collection&&e.collection.url;"function"==typeof r&&(r=r()),-1===(i=r?(this.getFullRootPath()+"rootroles/"+(t||this.toSeoUrl(n))).replace(/\/\//g,"/"):self.location.href.replace(self.location.search,"")).indexOf("://")&&(i=i.replace(":/","://"))}require(["DS/PlatformAPI/PlatformAPI"],(function(e){e.publish("mde.navigation.update.seo",{title:n,description:o,canonical:i})}))},publishFullScreenSeo:function(){require(["DS/PlatformAPI/PlatformAPI"],(function(e){e.publish("mde.navigation.update.seo",{fullPage:!0})}))},getFullRootPath:function(){return self.location.origin+this.getRootPath()},getRootPath:function(){return self.location.pathname.split("compass-world")[0]+"/compass-world/"||"/compass-world/"},toSeoUrl:function(e){var t=e.toString();return"function"==typeof t.normalize&&(t=t.normalize("NFD")),t.replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"-").toLowerCase().replace(/&/g,"-and-").replace(/[^a-z0-9\-]/g,"").replace(/-+/g,"-").replace(/^-*/,"").replace(/-*$/,"")},hasWebpSupport:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))&&0==e.toDataURL("image/webp").indexOf("data:image/webp")},_supportBigUrl:function(e){var t=this.getBrowser();return!(("internet explorer"===t||"edge"===t)&&e.length>2045)},dispatchLauncherErrorEvent:function(e){switch(e.returnCode){case 100:o.dispatchEvent("onShowMessage",g.i18n("launcherbusyretry"));break;case 141:o.dispatchEvent("onShowMessage",g.i18n("errorcode141"));break;case 152:o.dispatchEvent("onShowMessage",g.i18n("installationerroraccess"));break;case 155:o.dispatchEvent("onShowMessage",g.i18n("installationerrordiskspace"));break;case 157:o.dispatchEvent("onShowMessage",g.i18n("installationcancelled"));break;case 225:o.dispatchEvent("onShowMessage",g.i18n("errorcode225"));break;case 227:o.dispatchEvent("onShowMessage",g.i18n("errorcode227"));break;default:o.dispatchEvent("onShowMessage",g.i18n("installationerror"))}o.dispatchEvent("onHideMessage",5e3)},escape:function(e){var t;for(t in h)h.hasOwnProperty(t)&&e&&(e=e.replace(new RegExp(t,"g"),h[t]));return e},unescape:function(e){var t;for(t in h)h.hasOwnProperty(t)&&e&&(e=e.replace(new RegExp(h[t],"g"),t));return e},getTextFromHtml:function(t){var n=document.createElement("div");return e.is(t,"string")&&""!==t&&(t=this.unescape(t),t=this.escape(t),n.innerHTML=t,t=n.childNodes[0].nodeValue),t}};return g}));