define("DS/DELWebInfrastructureControls/DELWebSpecificationsFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/EditPropWidget/facets/Common/FacetsBase","DS/DELWebInfrastructureControls/DELWebAjaxModel","DS/ENOXSpecificationsUX/SpecificationsPane"],(function(t,e,n,o,i,c){"use strict";return e.extend(n,o,{init:function(t){this._parent(t),this._buildView(t)},_buildView:function(){var e=this;this.elements.container=t.createElement("div",{class:"SpecificationDocuments"}),i.getPlatformServices().then((function(n){!n.platformId&&window.widget.data&&(n.platformId=window.widget.data.x3dPlatformId);const o={parentObject:{parentId:e.getSelectedRefId()},connectorOptions:{fetchSecurityContext:function(){return e.options.collabSpace||window.widget.getValue("pad_security_ctx")||window.widget.getValue("collabSpace")},platformUrls:n,getWorkUnderHeaders:function(){var n={};return e.options.authoringCtx&&(n=t.is(e.options.authoringCtx)&&t.is(e.options.authoringCtx.AuthoringContextHeader)?e.options.authoringCtx.AuthoringContextHeader:{}),n}},webinwin:!1},i=c.extend({onRemoved:function(){}});e.SpecificationsPane=new i(o),e.SpecificationsPane.modelEvents.subscribe({event:"upload-attachment-complete"},e.addDocument.bind(e)),e.SpecificationsPane.modelEvents.subscribe({event:"attach-attachment-complete"},e.addDocument.bind(e)),e.SpecificationsPane.modelEvents.subscribe({event:"detach-attachment-complete"},e.deleteDocument.bind(e)),e.SpecificationsPane.inject(e.elements.container)}))},getSelectedRefId:function(){var e=this.getModel();if(e){if("relationship"!==e.get("metatype"))return e.get("objectId");t.log("getSelectedRefId FIX ME")}return e.get("objectId")},updateFacet:function(){const t=this.getSelectedRefId();if(!t)return void this.notApplicable();const e={parentId:t};this.SpecificationsPane&&(this.SpecificationsPane.show(),this.SpecificationsPane.options.parentObject.parentId!==t&&this.SpecificationsPane.setParentObject(e))},destroyComponent:function(){this.SpecificationsPane.destroy()},onResize:function(){this.updateFacet()},onRefresh:function(){this.updateFacet()},addDocument:function(t){const e=this;let n={};t.documents&&t.documents.length>0?n=t.documents[0]:t.document&&(n=t.document),e.options.appContext&&e.options.appContext.addDocument?e.options.appContext.addDocument(t.parentObject.parentId,n):e.options.addDocument&&e.options.addDocument(t.parentObject.parentId,n)},deleteDocument:function(t){const e=this;e.options.appContext&&e.options.appContext.deleteDocument?e.options.appContext.deleteDocument(t.parentObject.parentId,t.id):e.options.deleteDocument&&e.options.deleteDocument(t.parentObject.parentId,t.id)}})}));