window.define&&define("DS/DELWebInfrastructureControls/DELWebResourceFactoryPlant/DELWebResourceFactoryPlantModel",["DS/DELWebInfrastructureControls/UWAUtils","UWA/Class","UWA/Promise","DS/DELWebInfrastructureControls/DELWebIndexAuthoringMgmt","DS/DELWebInfrastructureControls/DELWebAjaxModel","i18n!DS/DELWebInfrastructureControls/assets/nls/DELWebInfrastructureControls"],(function(e,a,t,s,i,n){"use strict";var c={},r=window.Configuration&&window.Configuration.webroot?window.Configuration.webroot:i.setupWebRoot()||".";window.Fam&&window.Fam.Model&&window.Fam.Model.Platform&&window.Fam.Model.Platform.webroot&&(r=window.Fam.Model.Platform.webroot);var o=a.singleton({init:function(){c=i.getCacheObject()},setCacheObject:function(a){if(a&&e.Object.isPlainObject(a)){var t=i.getCacheObject();e.Object.isEmptyObject(c)||c===t||(a=Object.assign(a,c)),e.Object.isEmptyObject(t)||(a=Object.assign(a,t)),i.setCacheObject(a),c=i.getCacheObject()}},getCacheObject:function(){return c},get3DSearchString:function(){return"flattenedtaxonomies:types/DELResourceParameterListReference"},getAssociatedPlantsForFactoryLayout:function(a){var s=this;return new t((function(t,n){if(a&&(a.physicalid||a.allCached||a.QueryList)){var r={};if(c.plant_assoc&&!a.blnForceRefresh){if(a.physicalid&&c.plant_assoc[a.physicalid]&&!e.Object.isEmptyObject(c.plant_assoc[a.physicalid]))return r[a.physicalid]||(r[a.physicalid]={}),e.each(c.plant_assoc[a.physicalid],(function(e,t){r[a.physicalid][t.connectionPhysicalid||e]=t.plant||t})),void t(e.clone(r));if(a.QueryList){var o=!0;if(e.each(a.QueryList,(function(a,t){return(o=t&&t.physicalid&&c.plant_assoc[t.physicalid])&&e.each(c.plant_assoc[t.physicalid],(function(e,a){r[t.physicalid]||(r[t.physicalid]={}),r[t.physicalid][a.connectionPhysicalid||e]=a.plant||a})),o})),o)return void t(e.clone(r))}}i.getServiceUrl({serviceName:"3DSpace"}).then((function(r){if(r&&"string"==typeof r){var o={};if(a.physicalid)o.resourcePhysicalid=a.physicalid;else if(a.QueryList){var l=[];e.each(a.QueryList,(function(e,a){a&&(a.physicalid?l.push({physicalid:a.physicalid}):l.push(a))})),o.resourceQueryList=JSON.stringify(l)}var u=r+"/resources/DELWebInfrastructureLite/v0/plant/getFromResource?getAssociatedPlantsForFactoryLayout";i.callAuthenticatedRequest(u,"json","GET",o).then((function(r){if(r){var o=i.commonAjaxJsonResponseOK(r,n);if(!o)return o;c.plant_assoc||(c.plant_assoc={}),c.plant||(c.plant={});var l=r.Data||{};i.useFixtures()&&c.plant_assoc[a.physicalid]&&!a.blnForceRefresh?l=c.plant_assoc:a.blnForceRefresh&&c.plant_assoc[a.physicalid]&&delete c.plant_assoc[a.physicalid],e.each(l,(function(t,i){a.physicalid&&t===a.physicalid&&e.each(i,(function(e,t){if(t){t&&t&&t.physicalid&&t.physicalid}s._cacheFactoryLayoutToPlantAssoc(a,t,{connectionPhysicalid:t.connectionPhysicalid}),t&&t.physicalid&&!c.plant[t.physicalid]&&(c.plant[t.physicalid]=t)}))})),a.physicalid?(c.plant_assoc[a.physicalid]||(c.plant_assoc[a.physicalid]={}),t(e.clone(c.plant_assoc[a.physicalid]))):(a.QueryList&&e.each(a.QueryList,(function(e,a){a&&a.physicalid&&(c.plant_assoc[a.physicalid]||(c.plant_assoc[a.physicalid]={}),l||(l[a.physicalid]={}))})),t(e.clone(l)))}else n(new Error("invalid server response"))}),n)}else n(new Error("invalid 3DSpace URL"))}),n)}else n(new Error("invalid parameters"))}))},isPlmObjectAProdPlan:function(a,t,s){var i=this,n=!1;if(!a||!e.Object.isPlainObject(a)||e.Object.isEmptyObject(a))return steal.dev.log("Fam.Model.ExecutionProductionPlan::isPlmObjectAProdPlan - invalid input dsModel"),!1;var c=e.Object.extend(!0,{},i._FindProductionPlanObjectInCache(a,["V_TimeZone"])||a);return n=c&&("DELLmiProductionPlanReference"===c.plmObjectTypeInternal||"DELLmiProductionPlanReference"===c.type||c._objAttributesFromOrderDataMgmt),t&&(n||1===window.Foe.Model.Asset.isATypedResource(a.OXID||a.physicalid||a)?t(n):(c=e.Object.extend(!0,c||{},a,{Minimum:["V_TimeZone"]}),i.getOne(c,(function(e){n=i.isPlmObjectAProdPlan(e),t(n)}),s))),n},getUnassociatedPlants:function(a){return new t((function(t,s){if(a&&(a.physicalid||a.QueryList||a.allCached)){var n={};if(!a.blnForceRefresh&&(a.allCached||c.unassoc_plants))return c.unassoc_plants&&(n=Object.assign(n,c.unassoc_plants)),void t(n);i.getServiceUrl({serviceName:"3DSpace"}).then((function(a){if(a&&"string"==typeof a){var r=a+"/resources/DELWebInfrastructureLite/v0/plant/getAllUnassociated?getUnassociatedPlants";i.callAuthenticatedRequest(r,"json","GET",{}).then((function(a){if(a&&a.Data){var r=i.commonAjaxJsonResponseOK(a,s);if(!r)return r;n=a.Data||{},c.unassoc_plants=n,c.plant?e.each(n,(function(e,a){c.plant[a.physicalid]=Object.assign(c.plant[a.physicalid]||{},a)})):c.plant=n,t(e.clone(n))}else s(new Error("invalid server response"))}),s)}else s(new Error("invalid 3DSpace URL"))}),s)}else s(new Error("invalid parameters"))}))},getOne:function(a){return new t((function(t,n){if(a&&e.Object.isPlainObject(a))if(a.physicalid||a.id){var r=a.physicalid||a.id||"";if(r&&c.plant&&c.plant[r])c.plant[r]&&t(e.Object.extend(!0,{},c.plant[r]));else{var o=a.physicalid||a.id,l=("depth"in a&&a.depth,{physicalid:a.physicalid,type:a.class_name||a.type||"Plant",name:a.search_str||a.name||"*",revision:a.revision||"*",Minimum:a.Minimum?a.Minimum:"False"});a.searchByAttribute&&(l.searchByAttribute=a.searchByAttribute),!a.physicalid&&a.id&&(l.physicalid=a.id),l.Minimum instanceof Array&&(l.Minimum=JSON.stringify(l.Minimum)),i.getServiceUrl({serviceName:"3DSpace"}).then((function(a){if(a&&"string"==typeof a){var r=a+"/resources/DELWebInfrastructure/v0/business/finder?getOne";i.callAuthenticatedRequest(r,"json","GET",l).then((function(a){if(a){var r=i.commonAjaxJsonResponseOK(a,n);if(!r)return r;s.setDatabase();var l="data";a&&e.Object.isPlainObject(a)&&a[l]&&(c.plant||(c.plant={}),e.each(a[l],(function(){var a=this;a.name=a.name||a.V_Name||a.PLM_ExternalID||a.id,c.plant[a.physicalid]||(c.plant[a.physicalid]={}),c.plant[a.physicalid]=e.Object.extend(!0,c.plant[a.id],a)})),o&&c.plant&&c.plant[o]&&t&&t(e.Object.extend(!0,{},c.plant[o])))}else n(new Error("invalid server response"))}),n)}else n(new Error("invalid 3DSpace URL"))}),n)}}else n(new Error("no id provided!"));else n(new Error("invalid parameters"))}))},associateFactoryLayoutToPlant:function(a){var n=this;return new t((function(t,r){a&&e.Object.isPlainObject(a)?a.plant["attribute.Title"]||a.plant.name||a.plant.V_Name?i.getServiceUrl({serviceName:"3DSpace"}).then((function(o){if(o&&"string"==typeof o){var l={plant:{},resource:{}};a.plant&&a.plant.physicalid&&(l.plant.physicalid=a.plant.physicalid),l.plant=JSON.stringify(l.plant),a.resource&&a.resource.physicalid&&(l.resource.physicalid=a.resource.physicalid),l.resource=JSON.stringify(l.resource);var u=o+"/resources/DELWebInfrastructureLite/v0/plant/factoryResource?associateFactoryLayoutToPlant";i.callAuthenticatedRequest(u,"json","POST",l).then((function(a){if(a){var o=i.commonAjaxJsonResponseOK(a,r);if(!o)return o;s.setDatabase();var l=a.Data.SuccessfullyAssociated||{},u=[],p=[];e.each(l,(function(a,t){if(u.push(t),t&&e.Object.isPlainObject(t)){var s=t.resourcePhysicalId||t.resource.physicalid,i=t.plantPhysicalId||t.plant.physicalid;t.connectionPhysicalid;i&&s?(n._cacheFactoryLayoutToPlantAssoc(t.resource||{physicalid:s},t.plant||{physicalid:i},t),c.unassoc_plants&&i&&delete c.unassoc_plants[i],p.push({event:"Plant.associated",data:Object.assign({},t)})):e.log("DELWebResourceFactoryPlantModel::associateFactoryLayoutToPlant - invalid connection!  idxData = "+a+", valData = "+t)}})),e.each(p,(function(e,a){i.publishEvent(a.event,a.data)})),t(u.slice(0))}else r(new Error("invalid server response"))}),r)}else r(new Error("invalid 3DSpace URL"))}),r):r(new Error("No name provided!")):r(new Error("invalid parameters"))}))},unassociateFactoryLayoutFromPlant:function(a){var c=this;return new t((function(t,r){a&&e.Object.isPlainObject(a)?i.getServiceUrl({serviceName:"3DSpace"}).then((function(o){if(o&&"string"==typeof o){var l=a,u=o+"/resources/DELWebInfrastructureLite/v0/plant/factoryResource?unassociateFactoryLayoutFromPlant";i.callAuthenticatedRequest(u,"json","DELETE",l).then((function(o){if(o){var l=i.commonAjaxJsonResponseOK(o,r);if(!l)return l;s.setDatabase();var p=o.Data||{},d=[],y=!0;e.each(p,(function(t,s){if("SuccessfullyUnassociated"===t||"AlreadyUnassociated"===t)e.each(s,(function(a,t){t&&e.Object.isPlainObject(t)&&!e.Object.isEmptyObject(t)?(y=!0,c._cacheFactoryLayoutToPlantUnassoc(t),d.push({event:"Plant.unassociated",data:t})):e.log("DELWebResourceFactoryPlantModel::unassociateFactoryLayoutFromPlant - invalid response from "+u)}));else if("FailedUnassociated"===t){var i=e.clone(p);i=Object.assign(i,a),e.each(s,(function(a,s){0===a.indexOf("[")?i.plantOXID=a:i.resourceParameterListphysicalid=a,e.each(s,(function(e,a){0===a.indexOf("[")?i.target_OXID=a:i.target_physicalid=a,d.push({event:"Plant.unassociated.error",data:i}),y=!1,r(t,i)}))}))}else e.log("unknown response key: "+t)})),e.each(d,(function(e,a){i.publishEvent(a.event,a.data)})),y&&(p&&!e.Object.isEmptyObject(p)?t(e.clone(p)):r(new Error(n.get("Error"))))}else r(new Error("invalid server response"))}),r)}else r(new Error("invalid 3DSpace URL"))}),r):r(new Error("invalid parameters"))}))},_cacheFactoryLayoutToPlantAssoc:function(e,a,t){c.plant_assoc||(c.plant_assoc={});var s=c.plant_assoc;if(a&&e&&(t&&t||a.connectionPhysicalid)&&(a.OXID||a.physicalid)&&(e.OXID||e.physicalid)&&(e.physicalid||(e.physicalid=i.getPhysicalIDForOXID(e.OXID)),a.physicalid||(a.physicalid=i.getPhysicalIDForOXID(a.OXID)),s[e.physicalid]||(s[e.physicalid]={}),t&&t.connectionPhysicalid&&(a.connectionPhysicalid=t.connectionPhysicalid),a.connectionPhysicalid))if(s[e.physicalid][a.connectionPhysicalid]){var n=Object.assign(s[e.physicalid][a.connectionPhysicalid],a);s[e.physicalid][a.connectionPhysicalid]=n}else s[e.physicalid][a.connectionPhysicalid]=a},getAssociatedFactoryLayoutForPlant:function(a){var s=this;return new t((function(t,n){a&&(a.physicalid||a.allCached||a.QueryList)?c.plant_assoc&&c.plant_assoc[a.physicalid]&&!a.blnForceRefresh?t(e.clone(c.plant_assoc[a.physicalid])):i.getServiceUrl({serviceName:"3DSpace"}).then((function(r){if(r&&"string"==typeof r){var o={};if(a.physicalid)o.plantPhysicalid=a.physicalid;else if(a.QueryList){var l=[];e.each(a.QueryList,(function(e,a){a&&(a.physicalid?l.push({physicalid:a.physicalid}):l.push(a))})),o.plantQueryList=JSON.stringify(l)}var u=r+"/resources/DELWebInfrastructureLite/v0/plant/factoryResource?getAssociatedFactoryLayoutForPlant";i.callAuthenticatedRequest(u,"json","GET",o).then((function(r){if(r){var o=i.commonAjaxJsonResponseOK(r,n);if(!o)return o;c.plant_assoc||(c.plant_assoc={}),c.plant||(c.plant={});var l=r.Data||{};i.useFixtures()&&c.plant_assoc[a.physicalid]&&!a.blnForceRefresh?l=c.plant_assoc[a.physicalid]:a.blnForceRefresh&&c.plant_assoc[a.physicalid]&&delete c.plant_assoc[a.physicalid],e.each(l,(function(a,t){e.each(t,(function(e,t){t&&s._cacheFactoryLayoutToPlantAssoc({physicalid:a},t,{connectionPhysicalid:e})}))})),a.physicalid?t(e.clone(c.plant_assoc[a.physicalid])):t(e.clone(l))}else n(new Error("invalid server response"))}),n)}else n(new Error("invalid 3DSpace URL"))}),n):n(new Error("invalid parameters"))}))},_cacheFactoryLayoutToPlantUnassoc:function(a){if(a){if(c.plant_assoc)if(a&&a.resource&&a.resource.physicalid&&a.plant&&a.plant.physicalid){if(c.plant_assoc[a.resource.physicalid]&&c.plant_assoc[a.resource.physicalid][a.plant.physicalid]&&delete c.plant_assoc[a.resource.physicalid][a.plant.physicalid],c.unassoc_plants&&(c.unassoc_plants[a.plant.physicalid]=a.plant),c.plant&&c.plant[a.plant.physicalid])for(var t=c.plant[a.plant.physicalid];t.associatedResources&&t.associatedResources.length&&t.associatedResources.indexOf(a.resource.physicalid)>=0;)t.associatedResources.splice(t.associatedResources.indexOf(a.resource.physicalid),1)}else e.log("DELWebResourceFactoryPlantModel::_cacheFactoryLayoutToPlantUnassoc - invalid params!")}else e.log("DELWebResourceFactoryPlantModel::_cacheFactoryLayoutToPlantUnassoc - missing input parameters!")},_FindPLMObjectInCache:function(a,t){var s=Object.assign({},a);if(e.each(s,(function(a,t){(e.Object.isPlainObject(t)||Array.isArray(t))&&delete s[a]})),!s.OXID&&!s.physicalid&&!s.PLM_ExternalID){if(!s.id)return null;s.PLM_ExternalID=s.id}s.OXID&&!s.physicalid&&(s.physicalid=i.getPhysicalIDForOXID(s.OXID));var n=null;return e.each(["plant","resource"],(function(a,i){var r=c[i];if(r){if(n||!s.OXID&&!s.physicalid||!(n=r[s.physicalid||s.OXID])&&s.OXID&&(n=r[s.OXID])&&s.physicalid&&(r[s.physicalid]=r[s.OXID]),n)if(s.ForceCache?n.ForceCache=s.ForceCache:s.bForceCache&&(n.ForceCache=s.bForceCache),t&&t instanceof Array){o=n,l=t,u=!0,e.each(l,(function(a,t){return t&&"string"!=typeof t&&t.dataIndex&&(t=t.dataIndex),!(u=o.hasOwnProperty(t))&&0===t.indexOf("V_")&&Object.keys&&e.each(Object.keys(o),(function(e,a){return(u=a.indexOf(")."+t)>0&&0===a.indexOf("Ext("))&&(t=a),!u})),!u&&t.indexOf("__Ref_")<0&&"VPMInstance"===o.plmObjectType&&(u=o.hasOwnProperty("__Ref_"+t))&&(t="__Ref_"+t),u})),u||(n=null)}else t&&"false"!==t.toLowerCase()||n.AllAttributesRetrieved||n.ForceCache||(n=null);var o,l,u;return!n}})),n},getPlantIconPath:function(a,t){var s=this,n=null;return a&&e.Object.isPlainObject(a)&&!e.Object.isEmptyObject(a)?i.getServiceUrl({serviceName:"3DSpace"}).then((function(e){if(a.IconPath)n=(window.Configuration.ODT_E4AllDir||e)+a.IconPath,a.IconPath.indexOf("I_ENOVIA_RscOrganisation")>0&&(n=(window.Configuration.ODT_E4AllDir||e)+"/snresources/images/icons/small/iconSmallOrganization.gif");else if(a.preview_url||a.type_icon_url)n=a.small?a.type_icon_url||a.preview_url:a.preview_url||a.type_icon_url;else{if(a.iconName){n=(window.Configuration.ODT_E4AllDir||e||window.Configuration.webroot)+"/snresources/images/icons/";var i=a.iconName;return"iconManufacturingPlant144"!==i||a.small?n+="small/":(n+="large/",i+="108x144"),n+=i+".png",t&&t(n),n}if(!("iconName"in a))return a.iconName||a.IconPath||(a.iconName="iconManufacturingPlant144"),s.getPlantIconPath(a,t)}return t&&t(n),n})):a&&t&&t(n),n},getPlantList:function(a){return new t((function(t,r){if(a&&e.Object.isPlainObject(a)){var o=a.physicalid||a.id||"";if(o&&c.plant&&c.plant[o])c.plant[o]&&t(e.Object.extend(!0,{},c.plant[o]));else{"depth"in a&&a.depth;var l={boid:o,physicalid:a.physicalid,type:a.class_name||a.type||"Plant",name:a.search_str||a.name||"*",revision:a.revision||"*",Minimum:a.Minimum?a.Minimum:"False"};l.Minimum instanceof Array&&(l.Minimum=JSON.stringify(l.Minimum)),i.getServiceUrl({serviceName:"3DSpace"}).then((function(a){if(a&&"string"==typeof a){var c=a+"/resources/DELWebInfrastructure/v0/business/finder?getPlantList";JSON.stringify(l);i.callAuthenticatedRequest(c,"json","GET",l).then((function(a){if(a){var c=i.commonAjaxJsonResponseOK(a,r);if(!c)return c;s.setDatabase();var o="data";if(a&&e.Object.isPlainObject(a)&&a[o]){var l=[];e.each(a[o],(function(){var e=this;e.name=e.name||e.V_Name||e.PLM_ExternalID||e.id,e.V_Name=e.name,l.push(e)})),t&&t(l)}else r&&r(n.get("Error getting {0} list",{0:n.get("Plant")}));return!0}r(new Error("invalid server response"))}))}else r(new Error("invalid 3DSpace URL"))}),r)}}else r(new Error("invalid parameters"))}))}});if(i.useFixtures()){window.Configuration&&window.Configuration.fixtureDelay&&(window.can.fixture.delay=window.Configuration.fixtureDelay),i.addFixture({type:"GET",url:r+"/resources/DELWebInfrastructureLite/v0/plant/getFromResource?getAssociatedPlantsForFactoryLayout"},"../DELWebInfrastructureUI.tst/fixtures/plantResourceLink_getPlantsForResource.json"),i.addFixture({type:"GET",url:r+"/resources/DELWebInfrastructureLite/v0/plant/factoryResource?getAssociatedFactoryLayoutForPlant"},"../DELWebInfrastructureUI.tst/fixtures/plantResourceLink_getResourcesForPlant.json"),i.addFixture({type:"DELETE",url:r+"/resources/DELWebInfrastructureLite/v0/plant/factoryResource?unassociateFactoryLayoutFromPlant"},(function(a){var t=i.request("../DELWebInfrastructureUI.tst/fixtures/unassociateFactoryLayoutFromPlant.json",{onComplete:function(s){"string"==typeof s&&(s=JSON.parse(s));var n=a.data;if("string"==typeof n&&(n=JSON.parse(n)),n&&n.plant&&"string"==typeof n.plant&&(n.plant=JSON.parse(n.plant)),n&&n.resource&&"string"==typeof n.resource&&(n.resource=JSON.parse(n.resource)),n&&n.resource&&n.resource.physicalid&&n.plant&&n.plant.physicalid){var r=n.resource.physicalid;if(c.plant_assoc&&r&&c.plant_assoc[r]){var o=s.Data.SuccessfullyUnassociated;s.Data.SuccessfullyUnassociated={},c.plant&&c.plant[n.plant.physicalid]&&(n.plant=Object.assign(n.plant,c.plant[n.plant.physicalid]));var l=null;c.plant_assoc&&c.plant_assoc[r]&&c.plant_assoc[r][n.plant.physicalid]&&(l=e.clone(c.plant_assoc[r][n.plant.physicalid])),l||e.each(o,(function(e,a){a&&a.resource&&(l=a,Foe&&Foe.Model&&Foe.Model.Asset&&Foe.Model.Asset.getOne?Foe.Model.Asset.getOne({physicalid:r,Minimum:"True"},(function(e){l.resource=e})):i.getReference({physicalid:r,blnCachedOk:!0,Minimum:"True"}).then((function(e){l.resource=e})))})),s.Data.SuccessfullyUnassociated[l.connectionPhysicalid]=l,i.useFixtures()&&c.plant_assoc&&r&&c.plant_assoc[r]&&(c.plant_assoc[r]={})}}t.responseText=JSON.stringify(s),a.complete(t,t.statusText||(t.xhr?t.xhr.statusText:"success"))}})})),i.addFixture({type:"POST",url:r+"/resources/DELWebInfrastructureLite/v0/plant/factoryResource?associateFactoryLayoutToPlant"},(function(a){var t=o,s=i.request("../DELWebInfrastructureUI.tst/fixtures/plantResourceLink_associationSuccess.json",{onComplete:function(n){"string"==typeof n&&(n=JSON.parse(n));var r=a.data;if("string"==typeof r&&(r=JSON.parse(r)),r&&r.plant&&"string"==typeof r.plant&&(r.plant=JSON.parse(r.plant)),r&&r.resource&&"string"==typeof r.resource&&(r.resource=JSON.parse(r.resource)),r.resource.physicalid){var o=r.resource.physicalid;if(c.plant_assoc&&o){c.plant_assoc[o]||(c.plant_assoc[o]={});var l=null;if(r&&r.plant&&r.plant.physicalid){var u="SuccessfullyAssociated";if(delete n.Data.AlreadyAssociated,l=n.Data[u],n.Data[u]={},r.plant&&r.plant.physicalid){n.Data.SuccessfullyAssociated={};var p={physicalid:o};c.plant&&c.plant[r.plant.physicalid]&&(r.plant=Object.assign(r.plant,c.plant[r.plant.physicalid]));var d=null;e.each(l,(function(e,a){var s;a&&a.resource&&((d=a).connectionPhysicalid=(s=Math.random().toString()).substr(s.indexOf(".")+1),Foe&&Foe.Model&&Foe.Model.Asset&&Foe.Model.Asset.getOne?Foe.Model.Asset.getOne({physicalid:o,blnCachedOk:!0},(function(e){d.resource=e,p.physicalid!==d.resource.physicalid&&(d.resource.physicalid=p.physicalid)})):i.getReference({physicalid:o,blnCachedOk:!0,Minimum:"True"}).then((function(e){d.resource=e,p.physicalid!==d.resource.physicalid&&(d.resource.physicalid=p.physicalid)})),d.plant=t._FindPLMObjectInCache(r.plant)||r.plant,p.physicalid!==d.resource.physicalid&&(d.resource.physicalid=p.physicalid),n.Data[u][d.connectionPhysicalid]=d)}))}}}}s.responseText=JSON.stringify(n),a.complete(s,s.statusText||(s.xhr?s.xhr.statusText:"success"))}})})),i.addFixture({type:"GET",url:r+"/resources/DELWebInfrastructure/v0/business/finder?getOne"},"../DELWebInfrastructureUI.tst/fixtures/BusinessObjectFinder_Plants.json"),i.addFixture({type:"GET",url:r+"/resources/DELWebInfrastructure/v0/business/finder?getPlantList"},"../DELWebInfrastructureUI.tst/fixtures/BusinessObjectFinder_Plants.json"),i.addFixture({type:"GET",url:r+"/resources/DELWebInfrastructureLite/v0/plant/getAllUnassociated?getUnassociatedPlants"},"../DELWebInfrastructureUI.tst/fixtures/getAllUnassociatedPlants.json"),i.addFixture({type:"POST",url:r.substr(0,r.lastIndexOf("/"))+"/federated/search?searchForPlantData"},(function(a){var t=i.request("../DELWebInfrastructureUI.tst/fixtures/getResourceParameterListSearchData.json",{onComplete:function(i){if("string"==typeof i&&(i=JSON.parse(i)),c&&c.plant&&!e.Object.isEmptyObject(c.plant)){var n=[];e.each(i.results,(function(a,t){e.each(t.attributes,(function(e,a){return"resourceid"!==a.name||(n.push(a.value),!1)}))}));var r=i.results[0].attributes;e.each(c.plant,(function(a,t){if(a===t.physicalid&&!(n.indexOf(t.physicalid)>=0)){n.push(t.physicalid);var c=[];e.each(r,(function(a,i){var n=e.Object.extend(!0,{},i),r=s.convertSearchPredicateToAttr(n.name.replace(":snippet",""));if(r){switch(r){case"resourceid":n.value=t.physicalid||null;break;case"ds6w:identifier":n.value=t.PLM_ExternalID||null;break;case"label":n.value=t.V_Name||null;break;default:n.value=t[r]||n.value||null}c.push(n)}else e.log("DELWebResourceFactoryPlantModel::getResourceParameterListSearchData fixture- unknown attribute = "+n.name)})),i.results.push({attributes:c})}}))}t.responseText=JSON.stringify(i),a.complete(t,t.statusText||(t.xhr?t.xhr.statusText:"success"))}})}))}return o}));