define("DS/VCXWebUnits/VCXUnitType",["UWA/Class"],(function(e){"use strict";var t=e.extend({init:function(e){this._name=e,this._units={},this._formaterOptions={},this._symbolDisplay=t.ESymbolDisplay.Short,this._decimalSeparator=!0,this._precision=2,this._languageDisplay=t.ELanguageDisplay.local,this._displayInPreference=!0},getFormater:function(){if(!this._formater&&this._formaterClass){var e;(e=this.getDisplayUnit()&&this.getDisplayUnit().FormaterOptions?UWA.merge(this.getDisplayUnit().FormaterOptions,this.FormaterOptions):UWA.clone(this.FormaterOptions)).minimumFractionDigits=this.Precision,e.maximumFractionDigits=this.Precision,e.useGrouping=this.DecimalSeparator;var n=navigator.language;this._languageDisplay===t.ELanguageDisplay.fr?n="fr":this._languageDisplay===t.ELanguageDisplay.en&&(n="en"),this._formater=new this._formaterClass(n,e)}return this._formater},addUnit:function(e){this._units[e.Name]=e},getDisplayUnit:function(){return this._displayUnit},getInternUnit:function(){return this._internUnit},internToDisplayUnitValue:function(e){console.error("Should be overriden")},displayToInternUnitValue:function(e){console.error("Should be overriden")},getString:function(e){var n=this.internToDisplayUnitValue(e),i=this.getDisplayUnit();if(i){var r="";if("number"==typeof n){r+=this.getFormater()?this.getFormater().format(n):""+n;var a="";this.SymbolDisplay!==t.ESymbolDisplay.None&&(a=i.ShortSymbol,this.SymbolDisplay===t.ESymbolDisplay.Long&&i.LongSymbol&&(a=i.LongSymbol)),a&&(r+=" "+a)}return r}}});return t.ESymbolDisplay={Short:0,Long:1,None:2},t.ELanguageDisplay={local:0,fr:1,en:2},Object.defineProperty(t.prototype,"Name",{enumerable:!0,get:function(){return this._name}}),Object.defineProperty(t.prototype,"SymbolDisplay",{enumerable:!0,get:function(){return this._symbolDisplay},set:function(e){this._symbolDisplay=e}}),Object.defineProperty(t.prototype,"LanguageDisplay",{enumerable:!0,get:function(){return this._languageDisplay},set:function(e){this._formater&&delete this._formater,this._languageDisplay=e}}),Object.defineProperty(t.prototype,"Precision",{enumerable:!0,get:function(){return this._precision},set:function(e){this._formater&&delete this._formater,this._precision=e}}),Object.defineProperty(t.prototype,"DecimalSeparator",{enumerable:!0,get:function(){return this._decimalSeparator},set:function(e){this._formater&&delete this._formater,this._decimalSeparator=e}}),Object.defineProperty(t.prototype,"FormaterClass",{enumerable:!0,get:function(){return this._formaterClass},set:function(e){this._formater&&delete this._formater,this._formaterClass=e}}),Object.defineProperty(t.prototype,"FormaterOptions",{enumerable:!0,get:function(){return this._formaterOptions},set:function(e){this._formater&&delete this._formater,this._formaterOptions=e}}),Object.defineProperty(t.prototype,"DisplayUnit",{enumerable:!0,get:function(){if(this._displayUnit)return this._displayUnit.Name;for(var e in this._units)return this._units[e]},set:function(e){this._formater&&delete this._formater,this._displayUnit=this._units[e],this._displayInPreference&&window.widget&&window.widget&&window.widget.setValue(this.Name+"_DisplayUnit",e)}}),Object.defineProperty(t.prototype,"InternUnit",{enumerable:!0,get:function(){if(this._internUnit)return this._internUnit.Name;for(var e in this._units)return this._units[e]},set:function(e){this._formater&&delete this._formater,this._internUnit=this._units[e]}}),t})),define("DS/VCXWebUnits/VCXUnit",["UWA/Class"],(function(e){"use strict";var t=e.extend({init:function(e){this._name=e}});return t.ESymbolPosition={Before:0,Decimal:1,After:2},Object.defineProperty(t.prototype,"Name",{enumerable:!0,get:function(){return this._name}}),Object.defineProperty(t.prototype,"ConversionData",{enumerable:!0,get:function(){return this._conversionData},set:function(e){this._conversionData=e}}),Object.defineProperty(t.prototype,"LongSymbol",{enumerable:!0,get:function(){return this._longSymbol},set:function(e){this._longSymbol=e}}),Object.defineProperty(t.prototype,"ShortSymbol",{enumerable:!0,get:function(){return this._shortSymbol},set:function(e){this._shortSymbol=e}}),Object.defineProperty(t.prototype,"FormaterOptions",{enumerable:!0,get:function(){return this._formaterOptions},set:function(e){this._formaterOptions=e}}),t})),define("DS/VCXWebUnits/VCXUnitManagerModifiable",["DS/VCXWebModifiables/VCXModifiable","DS/VCXWebUnits/VCXUnitType","DS/VCXWebUnits/VCXUnit","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXPropertyValueBoolean","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables","i18n!DS/VCXWebUnits/assets/nls/VCXWebUnits"],(function(e,t,n,i,r,a,s,o,l,p,u,y){"use strict";return e.extend({init:function(){this._parent(),this._actorName="UnitManager"},initialize:function(){this._unitTypes={}},OnChangeProperty:function(e,t,n){if(n||(n={}),n.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;var i=e.indexOf(".",10),r=e.substr(0,i),a=e.substr(i+1),s=this.GetObject().getUnitType(a);if(s){switch(r){case"Unit.Type.SymbolDisplay":s.SymbolDisplay=t.Value;break;case"Unit.Type.LanguageDisplay":s.LanguageDisplay=t.Value;break;case"Unit.Type.Precision":s.Precision=t.Value;break;case"Unit.Type.DecimalSeparator":s.DecimalSeparator=t.Value;break;case"Unit.Type.DisplayUnit":s.DisplayUnit=t.Value;break;case"Unit.Type.InternUnit":s.InternUnit=t.Value;break;default:return n.fromChildClass=!0,this._parent(e,t,n)}return!0}return!1},GetProperty:function(e){var n=null,d=e.indexOf(".",10),h=e.substr(0,d),U=e.substr(d+1),f=this.GetObject().getUnitType(U),c="Group.Unit.Type."+U;if("Actor.Name"===e){var m=new s(this._actorName),D=new r(e,r.EBehaviorType.Singleton,!0,u);n=new i(D,m)}else if("Unit.Type.SymbolDisplay"===h){(m=new l).SetValue(f.SymbolDisplay),(b=new a(e,r.EBehaviorType.Singleton,!0,y)).AddOrModifyChoice(t.ESymbolDisplay.None,"Unit.ESymbolDisplay.None"),b.AddOrModifyChoice(t.ESymbolDisplay.Short,"Unit.ESymbolDisplay.Short"),b.AddOrModifyChoice(t.ESymbolDisplay.Long,"Unit.ESymbolDisplay.Long"),b.SetGroupId(c),n=new i(b,m)}else if("Unit.Type.LanguageDisplay"===h){(m=new l).SetValue(f.LanguageDisplay),(b=new a(e,r.EBehaviorType.Singleton,!0,y)).AddOrModifyChoice(t.ELanguageDisplay.local,"Unit.ELanguageDisplay.local"),b.AddOrModifyChoice(t.ELanguageDisplay.fr,"Unit.ELanguageDisplay.fr"),b.AddOrModifyChoice(t.ELanguageDisplay.en,"Unit.ELanguageDisplay.en"),b.SetGroupId(c),n=new i(b,m)}else if("Unit.Type.Precision"===h){(m=new o).SetValue(f.Precision),(b=new r(e,r.EBehaviorType.Singleton,!0,y)).SetGroupId(c),n=new i(b,m)}else if("Unit.Type.DecimalSeparator"===h){(m=new p).SetValue(f.DecimalSeparator),(b=new r(e,r.EBehaviorType.Singleton,!0,y)).SetGroupId(c),n=new i(b,m)}else if("Unit.Type.DisplayUnit"===h){(m=new s).SetValue(f.DisplayUnit);var b=new a(e,r.EBehaviorType.Singleton,!0,y);for(var g in f._units)b.AddOrModifyChoice(g,U+"."+g+".Long");b.SetGroupId(c),n=new i(b,m)}else if("Unit.Type.InternUnit"===h){(m=new s).SetValue(f.InternUnit);b=new a(e,r.EBehaviorType.Singleton,!0,y);for(var g in f._units)b.AddOrModifyChoice(g,U+"."+g+".Long");b.SetGroupId(c),n=new i(b,m)}else n=this._parent(e);return n},GetProperties:function(){var e=this._parent();for(var t in this.GetObject()._unitTypes)e.AddOrModifyProperty(this.GetProperty("Unit.Type.SymbolDisplay."+t)),e.AddOrModifyProperty(this.GetProperty("Unit.Type.LanguageDisplay."+t)),e.AddOrModifyProperty(this.GetProperty("Unit.Type.Precision."+t)),e.AddOrModifyProperty(this.GetProperty("Unit.Type.DecimalSeparator."+t)),e.AddOrModifyProperty(this.GetProperty("Unit.Type.DisplayUnit."+t)),e.AddOrModifyProperty(this.GetProperty("Unit.Type.InternUnit."+t));return e.AddOrModifyProperty(this.GetProperty("Actor.Name")),e},OnChangePropertiesEnd:function(){this._parent(),this.GetObject()._experienceBase.getManager("VCXDressupManager").RefreshVisuAfterDressupChange()}})})),define("DS/VCXWebUnits/VCXProportionalUnitType",["DS/VCXWebUnits/VCXUnitType"],(function(e){"use strict";return e.extend({init:function(e){this._parent(e)},GetType:function(){return"VCXProportionalUnitType"},_valueConversion:function(e,t){var n=this.getDisplayUnit(),i=this.getInternUnit();if(n&&i){var r=n.ConversionData&&n.ConversionData.a||1,a=n.ConversionData&&n.ConversionData.b||0,s=i.ConversionData&&i.ConversionData.a||1,o=i.ConversionData&&i.ConversionData.b||0;return t?e*(s/r)+(o-a)/r:e*(r/s)+(a-o)/s}return 0},internToDisplayUnitValue:function(e){return this._valueConversion(e)},displayToInternUnitValue:function(e){return this._valueConversion(e,!0)}})})),define("DS/VCXWebUnits/VCXUnitManager",["UWA/Class","DS/VCXWebUnits/VCXUnitType","DS/VCXWebUnits/VCXProportionalUnitType","DS/VCXWebUnits/VCXUnit","i18n!DS/VCXWebUnits/assets/nls/VCXWebUnits"],(function(e,t,n,i,r){"use strict";var a=e.extend({initialize:function(){this._unitTypes={}},postInitialize:function(){(r=new n("Length"))._displayInPreference=!0,window.Intl&&(r.FormaterClass=window.Intl.NumberFormat),e=new i("Micrometers"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:1e6,b:0},e=new i("PT"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:2834.65,b:0},e=new i("Millimeters"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:1e3,b:0},e=new i("Centimeters"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:100,b:0},e=new i("Decimeters"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:10,b:0},e=new i("Meters"),r.addUnit(e),this._setUnitNLS(r,e),e=new i("Kilometers"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:.001,b:0},e=new i("Inches"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:39.37007874,b:0},e=new i("Feet"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:3.28084,b:0},e=new i("Yards"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:1.09361,b:0},r.InternUnit="Millimeters",r.DisplayUnit="Centimeters",r.SymbolDisplay=t.ESymbolDisplay.Long,r.LanguageDisplay=t.ELanguageDisplay.en,r.Precision=2,r.DecimalSeparator=!0,this.addUnitType(r),(r=new n("Area"))._displayInPreference=!1,window.Intl&&(r.FormaterClass=window.Intl.NumberFormat),e=new i("SquareMicrometers"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:1e12,b:0},e=new i("SquareMillimeters"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:1e6,b:0},e=new i("SquareCentimeters"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:1e4,b:0},e=new i("SquareDecimeters"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:100,b:0};var e=new i("SquareMeters");r.addUnit(e),this._setUnitNLS(r,e),e=new i("SquareInches"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:1550.0030999938,b:0},e=new i("SquareFeet"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:10.7639111056,b:0},r.InternUnit="SquareCentimeters",r.DisplayUnit="SquareInches",this.addUnitType(r),(r=new n("Volume"))._displayInPreference=!1,window.Intl&&(r.FormaterClass=window.Intl.NumberFormat),e=new i("CubicMicrometers"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:1e18,b:0},e=new i("CubicMillimeters"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:1e9,b:0},e=new i("CubicCentimeters"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:1e6,b:0},e=new i("CubicDecimeters"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:1e3,b:0};e=new i("CubicMeters");r.addUnit(e),this._setUnitNLS(r,e),e=new i("CubicInches"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:61023.744094,b:0},e=new i("CubicFeet"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:35.3146701116967,b:0},r.InternUnit="CubicCentimeters",r.DisplayUnit="CubicInches",this.addUnitType(r),(r=new n("Angle"))._displayInPreference=!0,window.Intl&&(r.FormaterClass=window.Intl.NumberFormat);var r;e=new i("Radians");r.addUnit(e),this._setUnitNLS(r,e),e=new i("Degrees"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:180/Math.PI,b:0},e=new i("Turns"),r.addUnit(e),e.ConversionData={a:1/(2*Math.PI),b:0},e.FormaterOptions={style:"percent"},e=new i("Grades"),r.addUnit(e),e.ConversionData={a:200/Math.PI,b:0},r.InternUnit="Radians",r.DisplayUnit="Degrees","undefined"!=typeof widget&&widget.getValue("AngleUnit")&&(r.DisplayUnit=widget.getValue("AngleUnit")),this.addUnitType(r),(r=new n("Temperature"))._displayInPreference=!1,window.Intl&&(r.FormaterClass=window.Intl.NumberFormat),e=new i("Kelvin"),r.addUnit(e),this._setUnitNLS(r,e),e=new i("Celsius"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:1,b:-273.15},e=new i("Fahrenheit"),r.addUnit(e),this._setUnitNLS(r,e),e.ConversionData={a:1.8,b:-459.67},r.InternUnit="Kelvin",r.DisplayUnit="Celsius",this.addUnitType(r),(r=new n("Currency"))._displayInPreference=!1,window.Intl&&(r.FormaterClass=window.Intl.NumberFormat),e.FormaterOptions={style:"currency"},e=new i("USD"),r.addUnit(e),e.FormaterOptions={currency:"USD"},e=new i("EUR"),r.addUnit(e),e.ConversionData={a:.917431193,b:0},e.FormaterOptions={currency:"EUR"},r.InternUnit="EUR",r.DisplayUnit="EUR",this.addUnitType(r)},_updateFromWidget:function(){for(var e in this._unitTypes){var t=this._unitTypes[e];if(t._displayInPreference){var n=window.widget.getValue(e+"_DisplayUnit");null!==n&&t.DisplayUnit!==n&&(t.DisplayUnit=n,localStorage.setItem("DS_VCX_"+e+"_DISPLAYUNIT",n))}}},_updateToWidget:function(){for(var e in this._unitTypes){var t=this._unitTypes[e];t._displayInPreference&&window.widget.setValue(e+"_DisplayUnit",t.DisplayUnit)}},addWidgetParameters:function(){if(window.widget){for(var e in this._unitTypes){var t=this._unitTypes[e];if(t._displayInPreference){var n=[];for(var i in t._units)n.push({label:r[e+"."+t._units[i]._name+".Long"],value:i});var a=localStorage.getItem("DS_VCX_"+e+"_DISPLAYUNIT");a?t._userDefined=!0:a=t.DisplayUnit}}var s=this;this._widgetEvents=window.widget.addEvents&&window.widget.addEvents({endEdit:function(e){e.submitted&&s._updateFromWidget()}})}},_setUnitNLS:function(e,t){var n=r[e.Name+"."+t.Name+".Short"];n&&(t.ShortSymbol=n);var i=r.get(e.Name+"."+t.Name+".Long");i&&(t.LongSymbol=i)},addUnitType:function(e){this._unitTypes[e.Name]=e},getUnitType:function(e){return this._unitTypes[e]},unInitialize:function(){this._parent(),this._widgetEvents&&window.widget&&window.widget.removeEvents(this._widgetEvents)},internToDisplayUnitValue:function(e,t){var n=this._unitTypes[t];if(n)return n.internToDisplayUnitValue(e)},displayToInternUnitValue:function(e,t){var n=this._unitTypes[t];if(n)return n.displayToInternUnitValue(e)},getString:function(e,t){var n=this._unitTypes[t];if(n)return n.getString(e)},getUpdatePriority:function(){return-1}});return Object.defineProperty(a.prototype,"componentType",{enumerable:!0,get:function(){return"VCXUnitManager"}}),a}));