define("DS/DELPPWProcedureViewModule/ProcedureViewComponent",["UWA/Core"],(function(e){"use strict";return function(t,n){const i={ROUTINGS:{headerBackground:"#4d4d4d",headerText:"white"},MANUFACTURING:{headerBackground:"#009ddb",headerText:"white"},RESOURCES:{headerBackground:"#ffcd00",headerText:"black"}};var o,r,a,s,l,c,d,u,g,f,p,I,h,m,P,E=t.getComponent("SwimLaneChart"),R="transparent";return s=e.is(n.identifier)?n.identifier:"",a=e.is(n.columnOptions)?n.columnOptions:[],e.is(n.nodeOptions)?n.nodeOptions:[],I=e.is(n.onNodeDoubleClick,"function")?n.onNodeDoubleClick:null,h=e.is(n.onChartNodeSelectionChange,"function")?n.onChartNodeSelectionChange:null,P=e.is(n.getNodeContextMenu,"function")?n.getNodeContextMenu:null,m=function(t){var n;if(e.is(r)&&e.is(t)&&P)return(n=r.swimLaneChartdocument.getSelectedNodes()).length>0&&n.forEach((function(e){h(null,e),r.swimLaneChartdocument.unSelectNode(e.id)})),r.swimLaneChartdocument.selectNode(t.id),h(t,null),P(t)},c=function(){o=e.createElement("div",{class:"canvas-cv",id:"canvas-"+s})},f=function(t,n){var o,r=structuredClone(t.tileInfo),a=r.header,s=r.body;return o={id:r.id,isCollapsible:!!e.is(r.isCollapsible,"boolean")&&r.isCollapsible,isPinnable:!!e.is(r.isPinnable,"boolean")&&r.isPinnable},e.is(a)&&(o.header={},o.header.textWrap="wrap",o.header.collapsibleIcon=!!e.is(o.isCollapsible,"boolean")&&o.isCollapsible,e.is(a.strokeColor)&&(o.header.strokeColor=a.strokeColor,delete a.strokeColor),e.is(a.backgroundColour)?(o.header.color=a.backgroundColour,delete a.backgroundColor):o.header.color=i[n].headerBackground,o.header.text=e.is(a.text)?a.text:"",o.header.leftIcon=e.is(a.icon)?a.icon:null),e.is(s)&&(o.content={},e.is(s.strokeColor)&&(o.content.strokeColor=s.strokeColor,delete s.strokeColor),e.is(s.backgroundColour)&&(o.content.backgroundColor=s.backgroundColour,o.content.color=s.backgroundColour,delete s.backgroundColour),o.content.childElement=function(t){var n=new e.Element("img",{class:"row-node-icon"}),i=new e.Element("p",{class:"row-node-text"}),o=new e.Element("div",{class:"node-content"}),r=new e.Element("div",{class:"node-richtext"});if(e.is(t)&&Object.keys(t).length>0){let a=[];Object.entries(t).forEach((([t,i])=>{if(!e.is(i))return;let o=i.indexOf("<body>"),s=i.indexOf("</body>");"icon"===t?n.src=i:o>-1&&s>-1?(i=i.slice(o+6,s),r.innerHTML=i):a.push(i)})),e.is(n.src)&&""!==n.src&&n.inject(o),e.is(a,"array")&&a.length>0&&(i.setText(a.join(" ")),i.inject(o)),e.is(r.innerHTML)&&""!==r.innerHTML&&r.inject(o)}return o.style.position="relative",o}(s)),e.is(t.parentId)&&(o.parentId=t.parentId),o},p=function(t,n,i){var o=[],r=t.id.replace("column_",""),s=(Object.keys(a).indexOf(r),{id:t.id,title:t.title,weight:t.weight,color:"#ffffff"});return n.forEach((function(t){var n,a;n=f(t,r),o.push(n),e.is(t.tileInfo.group)&&((a=i.find((e=>e.id==="group_"+t.tileInfo.group)))||(a={id:"group_"+t.tileInfo.group,elements:[],color:R},i.push(a)),a.elements.push(n.id),n.groupId=a.id)})),o.length>0&&(s.nodes=o),s},g=function(){var e=[],t=[];Object.values(a).forEach((function(n){var i,o=n.columnInfo,r=n.nodesInfo;i=p(o,r,t),e.push(i)})),t.sort(((e,t)=>e-t)),l=t,r.model={columns:e,groups:t}},u=function(){var e=new E({title:"ProcedureView",searchBar:!1,onNodeDblSelect:function(e){I&&I(e)},onNodeSelect:function(e){h&&h(e,null)},onNodeUnSelect:function(e){h&&h(null,e)},onContextMenu:function(e){return m(e)}});return o.appendChild(e),e},d=function(){e.is(r)||(r=u(),g())},{init:function(){c()},inject:function(e){o.inject(e)},createViewComponent:function(){d()},destroy:function(){e.is(o)&&e.is(r)&&(o.remove(),o.destroy(),o=void 0)},getSelectedNodes:function(){if(e.is(r))return r.swimLaneChartdocument.getSelectedNodes()},selectNodes:function(t){e.is(r)&&r.swimLaneChartdocument.selectNodes(t,!1)},unselectNodes:function(t){e.is(r)&&r.swimLaneChartdocument.unSelectNodes(t)},unSelectAllNodes:function(){e.is(r)&&r.swimLaneChartdocument.unSelectAllNodes()},expandAllNodes:function(){e.is(r)&&r.swimLaneChartdocument.expandAll()},collapseAllNodes:function(){e.is(r)&&r.swimLaneChartdocument.collapseAll()},expandAll:function(t){e.is(r)&&r.swimLaneChartdocument.expandAll(t)},collapseAll:function(t){e.is(r)&&r.swimLaneChartdocument.collapseAll(t)},expandNode:function(t){e.is(r)&&r.swimLaneChartdocument.expandNode(t)},collapseNode:function(t){e.is(r)&&r.swimLaneChartdocument.collapseNode(t)},deleteNode:function(t){e.is(r)&&r.swimLaneChartdocument.deleteNode(t)},deleteGroup:function(t){var n="group_"+t,i=l.find((e=>e.id===n));e.is(r)&&e.is(i)&&r.swimLaneChartdocument.deleteGroup(i.id)},updateColumn:function(t){var n;e.is(r)&&(n=p(t.columnInfo,t.nodesInfo,l),r.swimLaneChartdocument.updateColumn(n))},updateNode:function(t,n){var i;e.is(r)&&(i=f(t,n),r.swimLaneChartdocument.updateNode(i))},updateGroup:function(t){var n=t.id,i=t.color;e.is(r)&&e.is(n)&&r.swimLaneChartdocument.updateGroup({id:"group_"+n,color:e.is(i)?i:R})},updateGroupsOrder:function(t){e.is(r)&&e.is(t,"array")&&t.length>0&&r.swimLaneChartdocument.setGroupsOrder(t)}}}})),define("DS/DELPPWProcedureViewModule/ViewPanel",["UWA/Core"],(function(e){"use strict";return function(t,n){var i,o,r,a,s,l,c=n.getComponent("WUXFrameWindowsManager").getFrameWindow(t.getAppContext()),d=n.create("Element","div",{class:"EProcedureView-panel-container"}),u=c.getImmersiveFrame(),g={};return i=function(){(o=n.create("Panel",{identifier:"panel-EProcedureView"+r,position:{my:"center",at:"center"},title:a,immersiveFrame:u,content:d,minWidth:800,minHeight:250,height:250,snappableFlag:!1,resizableFlag:!0,closeButtonFlag:!0,useBordersFlag:!0,visibleFlag:!1,collapsibleFlag:!0,verticallyStretchableFlag:!0})).close=function(){s?s():o.hide()}},{init:function(t){g=e.extend(g,t),r=e.is(t.identifier)?t.identifier:"",a=e.is(t.title)?t.title:"",s=e.is(t.onClose,"function")?t.onClose:null,l=e.is(t.className)?t.className:""},destroy:function(){e.is(o)&&(o.destroy(),o=void 0)},show:function(){var t;e.is(o)&&!1===o.visibleFlag&&o.show(),(t=o.immersiveFrame.getDockingElement(o.currentDockArea))&&(t.collapseDockingZoneFlag=!1)},hide:function(){o.hide()},getContainer:function(){return d},buildSkeleton:function(){i(),d.addClassName(l)}}}})),define("DS/DELPPWProcedureViewModule/ProcedureViewModule",["UWA/Core","DS/DELPPWProcedureViewModule/ViewPanel","DS/DELPPWProcedureViewModule/ProcedureViewComponent","text!DS/DELPPWProcedureViewModule/assets/json/ProcedureViewDefaultParams.json"],(function(e,t,n,i){"use strict";return{behaviors:["UXFactoryBehavior","ResourceBehavior","ModelBehavior","SelectionBehavior","RootsBehavior","LinkBehavior","ProcessImplementBehavior","CapableResourceLinkBehaviour","ProcedureViewBehavior","TreeListViewBehavior","AppPreferencesBehavior","EditAttributeBehavior"],creator:function(o,r,a,s,l,c,d,u,g,f,p,I,h){const m="ROUTINGS",P="RESOURCES",E="MANUFACTURING",R=["MANUFACTURING","ROUTINGS","RESOURCES"],C="ProcessImplementLinkOcc",S="PartialProcessImplementLink",y="DELAsmProcessCanUseCnx",N=["DELWkiDataCollectChecklistReference","DELResourceParameterPlanReference","DELWkiDataCollectPlanReference","DELWkiDataCollectReference"],b={[m]:{SWP_TYPE:["DELLmiServiceWorkPlanSystemReference","DELLmiServiceWorkPlanOperationalReference","DELLmiServiceWorkPlanRectifyingReference","DELLmiServiceWorkPlanSupportingTaskReference"],HOP_TYPE:["DELLmiHeaderOperationReference"],CAUTION_TYPE:["DELWkiAlertCautionReference"],WARNING_TYPE:["DELWkiAlertWarningReference"],TEXT_TYPE:["DELWkiInstructionReference"],ALERT_TYPE:["DELWkiAlertReference"],SIGNOFF_TYPE:["DELWkiSignOffReference"],STEP_OPERATIONS:["OPERATION"]},[E]:{SCOPE_TYPE:["ProcessImplementLink","PartialProcessImplementLink"],IMPL_TYPE:[C]},[P]:{RESS_TYPE:[y,"SecondaryCandidateResourceLink"]}},T={[m]:["SYSTEM","OPERATION"],[E]:["PROCESS","SERVICE"],[P]:["RESOURCE"],WKITYPES:["WORKINSTRUCTION"]};var L,v,A,k,O,w,U,x,D,M,V,F,G={},W=!1,_=!1,Y="V_TreeOrder",B="DELLmiRichText.V_RichText",j="DELServiceProcessRoleExt.V_CustoRole",K="Procedure",H="PROCEDUREVIEW",q=["DELAsmProcessCanUseCnx","SecondaryCandidateResourceLink","ProcessImplementLinkOcc","ProcessImplementLink","PartialProcessImplementLink"],X=["CapableResourcesStructureLink","DELAsmProcessCanUseCnx","SecondaryCandidateResourceLink"],z=[j,"DELLmiServiceWorkPlanSystemReference.V_CodeInfo","DELServiceMaintenanceLevelExt.V_MaintenanceLevel"],Q=r.getComponent("GeneratedToolbar"),J=r.getComponent("TooltipModel"),Z=r.getComponent("WUXCommandsManager"),$=function(){var t=[];return e.is(O)&&Object.keys(O).forEach((function(e){t.push(...O[e].nodesInfo)})),t},ee=function(){var e=O[m].nodesInfo,t=[];return e.forEach((e=>{-1===t.indexOf(e.group)&&t.push(e.group)})),t},te=function(t,n){var i,o,r,a,l,d;if(e.is(t)&&(d=e.is(t.get("to"),"array")?t.get("to")[t.get("to").length-1]:t.get("to"),e.is(d)&&(a=s.findAllInstsPaths(d)[0][0],r=e.is(a)?s.getInstance(a):s.getInstance(n),e.is(r)&&(i=s.getAggregatingReferenceModelFromInstance(r),e.is(i)))))if(o=c.getRootFilter(i.get("PID")),e.is(o)&&e.is(o.originalFilterQuery)){if(o=o.originalFilterQuery,s.isInstance(n)?l=s.getInstance(n).get("isAggregatedBy"):(n=(n=s.findAllInstsPaths(n)[0])[n.length-1],e.is(n)&&(l=s.getInstance(n).get("isAggregatedBy"))),!s.getFilteredInstancesFromCollection(l,o,{sort:!0}).some((e=>e.get("PID")===n)))return!1}else o=void 0;return!0},ne=function(t){var n=$();return e.is(t)?n.find((e=>e.referenceId===t)):null},ie=function(t){var n=$();return e.is(t)?n.find((e=>e.tileInfo.id===t)):null},oe=function(t){var n=[];return t.forEach((function(t){var i,o,r,a,l,c,d,g=t.get("type"),f=e.is(t.get("from"),"array")?t.get("from")[t.get("from").length-1]:t.get("from"),p=e.is(t.get("to"),"array")?t.get("to")[t.get("to").length-1]:t.get("to");if(e.is(p)&&e.is(f)){if(g===C&&(a=t,l=!1,c=u.findUpperScopeLinks(a.get("from")),d=u.findUpperScopeLinks([a.get("to")[0]]),r=e.is(c)||(c=u.findUpperPartialScopeLinks(a.get("from")),l=(d=u.findUpperPartialScopeLinks([a.get("to")[0]])).scopeLinks.some((e=>e.get("type")===S)),e.is(c)||!l)?e.is(c)&&e.is(d)?c.scopeLinks.filter((function(e){return d.scopeLinks.some((t=>e.get("PID")===t.get("PID")))})):void 0:u.findUpperScopeLinks([a.get("to")[0]]).scopeLinks),e.is(r)&&r.length>0){if(!te(r[0],p))return}else if(X.includes(g)&&!te(t,p))return;i=s.getReferenceModel(p),s.isInstance(p)&&(o=s.getInstance(p)),n.push({refModel:i,instModel:o,connModel:t})}})),n},re=function(){var t,n,i,o=k.getSelectedNodes(),r=function(t,n){e.is(U)&&U.updateNodeModel(t,{disabled:n})};r("information",!0),r("editTextAttribute",!0),r("editServiceAttributes",!0),r("orderBySequence",!0),r("insertNew",!0),r("insertExisting",!0),1===o.length&&(t=ie(o[0].id),n=e.is(t.instanceId)?s.getInstance(t.instanceId):s.getReference(t.referenceId),i=Te(n).length>0,e.is(t.isRoleGroup)&&t.isRoleGroup||t.category!==m?t.category!==E&&t.category!==P||r("information",!1):b.ROUTINGS.SWP_TYPE.includes(t.type)||b.ROUTINGS.SWP_TYPE.some((e=>f.isMdlAKindOf(t.type,e)))?(r("information",!1),r("editTextAttribute",!1),r("editServiceAttributes",!i),e.is(t.isRoot)&&t.isRoot&&(r("orderBySequence",!1),r("insertNew",!1),r("insertExisting",!1))):e.is(t.attrName)&&t.attrName===B?r("editTextAttribute",!1):T.WKITYPES.includes(t.PPRType)?(r("information",!1),r("editTextAttribute",!1),r("editServiceAttributes",!i)):(r("information",!1),r("editTextAttribute",!1),r("editServiceAttributes",!i),r("insertNew",!1),r("insertExisting",!1)))},ae=function(t,n){var i,o,r=t.tileInfo.id,a=O[n].nodesInfo.findIndex((e=>e.tileInfo.id===r)),s=e.is(t.parentId)?ie(t.parentId):null;e.is(a)&&-1!==a&&(O[n].nodesInfo.splice(a,1),k.deleteNode(r),e.is(s.children,"array")&&(s.children=s.children.filter((e=>e.id!==t.id))),n===m&&(i=t.group,o=[],Object.keys(O).forEach((function(e){o.push(...O[e].nodesInfo.filter((e=>e.group===i))),O[e].nodesInfo=O[e].nodesInfo.filter((e=>e.group!==i))})),e.is(o)&&o.forEach((function(e){k.deleteNode(e.tileInfo.id)})),k.deleteGroup(i)),O[n].nodesInfo=O[n].nodesInfo.filter((e=>e.parentId!==r)))},se=function(t,n){var i=!1,o=k.getSelectedNodes().map((e=>e.id));t.forEach((function(t){O[n].nodesInfo=O[n].nodesInfo.map((function(e){return e.tileInfo.id===t.tileInfo.id?(i=!0,t):e})),i||O[n].nodesInfo.push(t),function(t,n){var i=function(t,n){var i=t.treeOrder||0,o=n.treeOrder||0,r=t.group,a=n.group;return r!==a?r-a:0!==i||0!==!o?i-o:e.is(t.order)&&e.is(n.order)?t.order-n.order:0};t===m?n.nodesInfo=[n.nodesInfo[0],...function t(n){var o=n.children,r=[];if(e.is(o,"array")){let n=o.filter((t=>e.is(t.attrName))),a=new Set(n.map((e=>e.attrName))),s=o.filter((t=>!e.is(t.attrName)));a.forEach((t=>{let i,o,a=n.filter((e=>e.attrName===t));e.is(a,"array")&&(i=a.find((e=>e.isRefAttr)),o=a.find((e=>!e.isRefAttr)),i&&r.push(i),o&&r.push(o))})),s=s.sort(((e,t)=>i(e,t))),s.forEach((e=>{r.push(e),r.push(...t(e))}))}return r}(n.nodesInfo[0])]:n.nodesInfo.sort(((e,t)=>i(e,t)))}(n,O[n])})),k.updateColumn(O[n]),k.updateGroupsOrder(ee().sort(((e,t)=>e-t))),k.selectNodes(o)},le=function(t){(t=Array.isArray(t)?t:[t]).some((function(e){let t=!1;return[Y,j,"DELServiceProcessRoleExt.V_OOTBRole"].forEach((n=>{Pe(e)&&Object.prototype.hasOwnProperty.call(e._changed,n)&&(t=!0)})),t}))?we():t.forEach((function(t){var n,i,o,r=t;if(Pe(t)&&(s.isInstance(t.get("PID"))&&(r=s.getReferenceModel(t.get("PID")),n=t),o=ne(r.get("PID")),e.is(o))){let a,l,c,u,g,f=[],p=[],I=ie(o.parentId),h={category:o.category,group:o.group,parentId:o.parentId,isRoot:o.isRoot};if(e.is(n)||(n=e.is(o.instanceId)?s.getInstance(o.instanceId):null),e.is(o.linkId)&&(i=d.getConnection(o.linkId)),a=Ie(r,n,i,h),f.push(a),g=e.is(I.children,"array")?I.children.findIndex((e=>e.id===a.id)):-1,I.children.length>0&&-1!==g){let e=I.children[g].children.filter((e=>!a.children.some((t=>t.id===e.id))));a.children.push(...e),I.children[g]=a}u=Object.keys(b[a.category]).find((e=>b[a.category][e].includes(r.get("type")))),l=e.is(u)?G[a.category][u]:a.category===m?G[m].OPERATION:null,c=e.is(l)?l.body.attributeNodeList:[],c=e.is(c,"array")?c:[],p=Object.keys(t._changed).filter((e=>c.some((t=>t.name===e)))),e.is(p,"array")&&p.length>0&&p.forEach((e=>{let n=o.tileInfo.id+"##attribute_"+e+(s.isInstance(t.get("PID"))?"#inst":"#ref");f.push(a.children.find((e=>e.tileInfo.id===n)))})),f.forEach((e=>function(e,t){var n=O[t].nodesInfo.map((e=>e.tileInfo.id)).indexOf(e.tileInfo.id);n>-1?(O[t].nodesInfo[n]=e,k.updateNode(e,t)):se([e],t)}(e,e.category)))}}))},ce=function(t){(t=Array.isArray(t)?t:[t]).forEach((function(t){var n,i,o=t,r={[m]:[],[E]:[],[P]:[]},a=[];if(!Pe(t))return;if(!s.isInstance(t.get("PID")))return;o=s.getReferenceModel(t.get("PID"));let l,c,d,u=ne((i=t).get("isAggregatedBy")),g={},f=ee(),p=[],I={};if(e.is(u)){if(e.is(u.isRoot)&&u.isRoot){let t;p=u.children,t=e.is(p,"array")&&p.length>0?p[p.length-1]:null,e.is(t)&&t.role===K||(t=pe(K,K,D.next(),u.id),r.ROUTINGS.push(t),u.children.push(t),f.push(t.group)),u=t}p=u.children,c=e.is(p,"array")&&p.length>0?p[p.length-1].group:u.group,d=e.is(f[f.indexOf(c)+1])?f[f.indexOf(c)+1]:f[f.indexOf(c)]+1,l=(c+d)/2,a.push(l),I={group:l,parentId:u.tileInfo.id,category:m},n=Ie(o,i,null,I),r.ROUTINGS.push(n),r.ROUTINGS.push(...n.children),p.push(n),I.category===m&&(g=he(o,i.get("PID"),n,O),r.MANUFACTURING.push(...g.MANUFACTURING),r.RESOURCES.push(...g.RESOURCES),n.linkedObjects={[E]:[...g[E]],[P]:[...g[P]]})}Object.keys(r).forEach((e=>{e.length>0&&se(r[e],e)})),a.forEach((t=>{var n;n=t,e.is(n)&&k.updateGroup({id:n})}))}))},de=function(t){(t=Array.isArray(t)?t:[t]).forEach((function(t){var n,i=e.is(t.get("isInstanceOf"))?t.get("isInstanceOf"):t.get("PID");if(n=ne(i),e.is(n)){let e=n.category;ae(n,e)}}))},ue=function(t){var n,i,o,r=t.changed,a=r.absPath.toString();""===a?a=r.nodeId:a.contains(",")&&(o=a.split(","),a=o[o.length-1]),s.isInstance(a)&&(a=s.getReferenceIdFromInstance(a)),n=ne(a),e.is(n)&&e.is(k)&&(i=n.tileInfo.id,r.isSelected?W?W=!1:(e.is(F)||(F=t.sourceId),k.selectNodes([i])):_?_=!1:k.unselectNodes([i])),re()},ge=function(t){var n=ie(t.id);e.is(n.attrName)&&n.attrName===B&&ye()},fe=function(t,n){var i,r,a,c=[],d={},u=l.getSelections(),g=e.is(t)?ie(t.id):null,f=e.is(n)?ie(n.id):null;e.is(f)&&(_=!0,r=f.referenceId,(c=u.flat()).push(r)),e.is(g)&&(u[0].indexOf(M.id)>-1&&c.push(M.id),i=g.referenceId,0===(a=s.findAllInstsPaths(i)[0]).length&&(a=null),W=!0,d.changed={nodeId:i,childOccurencePath:e.is(g.occurencePath,"array")&&g.occurencePath.length>0?g.occurencePath:a,isSelected:!0}),d.selectedNodeIds=c,o.notify("EGraphNodeSelect",d),re()},pe=function(e,t,n,i){return{role:e,isRoleGroup:!0,category:m,id:"group_"+n+"##role_"+e,group:n,children:[],tileInfo:{isPinnable:!0,id:"group_"+n+"##role_"+e,isCollapsible:G.SERVICE_ROLES[t].isCollapsible,header:{backgroundColour:G.SERVICE_ROLES[t].header.backgroundColour,text:a.getNLSValue("ServiceProcessRole."+e)},body:{backgroundColour:G.SERVICE_ROLES[t].header.backgroundColour}},parentId:i}},Ie=function(t,n,i,o){var r,l;return o=o||{},r={referenceId:t.get("PID"),instanceId:e.is(n)?n.get("PID"):null,linkId:e.is(i)?i.get("PID"):null,PPRType:t.get("PPRTYPE"),type:t.get("type"),group:o.group,category:o.category,parentId:e.is(o.parentId)?o.parentId:null,isRoot:e.is(o.isRoot)?o.isRoot:null,isValid:!0,tileInfo:null,treeOrder:e.is(n)?n.get(Y):0},l=function(t,n,i,o,r){var l,c,g,f,p={},I=[],h=o.type,R=null,C=function(o,r,s){var l,c,u=s?i:r?t:n;return l=u.get(o),"type"===o&&(l=a.getNLSValue(l)),l="NULL"!==l&&e.is(l)?l:null,l=!e.is(l)&&T.WKITYPES.includes(u.get("PPRTYPE"))?"":l,e.is(l)&&(c=d.getAttributeNLSForUnit(o),e.is(c)&&""!==c&&(l=l.split(" ")[0]+" "+c)),l};if(r=r||{},T.ROUTINGS.includes(o.PPRType)||T.WKITYPES.includes(o.PPRType)?(l=Object.keys(b.ROUTINGS).find((e=>b.ROUTINGS[e].includes(h))),c=e.is(l)?G[m][l]:G[m].OPERATION):T.MANUFACTURING.includes(o.PPRType)&&e.is(i)?(l=Object.keys(b.MANUFACTURING).find((e=>b.MANUFACTURING[e].includes(i.get("type")))),c=G[E][l]):T.RESOURCES.includes(o.PPRType)&&e.is(i)&&(l=Object.keys(b.RESOURCES).find((e=>b.RESOURCES[e].includes(i.get("type")))),c=G[P][l]),p.id="group_"+r.group+"##node_"+(e.is(n)?n.get("PID"):t.get("PID")),p.isCollapsible=!!e.is(c.isCollapsible,"boolean")&&c.isCollapsible,p.group=r.group,e.is(c.header)&&(p.header={},g=c.header,p.header.backgroundColour=r.isRoot?g.rootBackgroundColour:g.backgroundColour,p.header.strokeColor=r.isRoot?g.rootStrokeColor:g.strokeColor,g.displayIcon&&(p.header.icon=a.getIconURLFromKey(h)),p.header.text=s.getDisplayName(e.is(n)?n:t)),e.is(c.body)){if(p.body={},f=c.body,p.body.backgroundColour=r.isRoot?f.rootBackgroundColour:f.backgroundColour,p.body.strokeColor=r.isRoot?f.rootStrokeColor:f.strokeColor,f.displayIcon&&(p.body.icon=a.getIconURLFromKey(h)),e.is(f.attributeList,"array")&&f.attributeList.length>0)if(o.category===E&&i.get("type")===b.MANUFACTURING.IMPL_TYPE[0]){let e,t,n=[];f.attributeList.some((e=>"PLMEntity.V_usage"===e.name))&&(e=u.getRoleFromModelOrComputed(i.get("PID"))),f.attributeList.some((e=>"ImplementLinkUsageFamily.V_Action"===e.name))&&(n=u.getActionsFromConnection(i.get("PID"))),f.attributeList.some((e=>"type"===e.name))&&(t=C("type",null,!0),p.body.type=t),n=n.map((e=>e.nlsText)),n.unshift(e.nlsText),p.body.attrOnImplLink="("+n.join(a.getNLSValue("LinksUI.Link.JoinPattern"))+")"}else f.attributeList.forEach((e=>{p.body[e.name]=C(e.name,e.isReferenceAttribute,e.isConnectionAttribute)}));e.is(f.attributeNodeList,"array")&&f.attributeNodeList.length>0&&(R=[],f.attributeNodeList.forEach((t=>{if(!t.isReferenceAttribute&&!t.isConnectionAttribute&&!e.is(n))return;let i=e.is(t.isReferenceAttribute)&&t.isReferenceAttribute,l=e.is(t.isConnectionAttribute)&&t.isConnectionAttribute,c={category:o.category,group:o.group,attrName:t.name,order:t.order,parentId:p.id,isRefAttr:i,isConnAttr:l,tileInfo:{isCollapsible:!1,parentId:p.id,id:p.id+"##attribute_"+t.name+"#"+(l?"conn":i?"ref":"inst"),body:{text:C(t.name,i,l),backgroundColour:t.backgroundColour}}};if(e.is(c.tileInfo.body.text))if(b.ROUTINGS.SWP_TYPE.includes(h)&&!e.is(r.isRoot)&&(c.isValid=!i),"usagePoint"===t.name){let n=C(t.name,i,l);e.is(n,"array")&&n.length>0&&n.forEach((n=>{if(e.is(n,"array")&&n.length>0){let i={category:o.category,attrName:t.name,parentId:p.id,tileInfo:{isCollapsible:!1,parentId:p.id,id:p.id+"##attribute_"+t.name,body:{backgroundColour:t.backgroundColour}}},r=s.getInstance(n[n.length-1]),l=e.is(r)?s.getReferenceModelFromInstance(r):null;e.is(l)&&(i.tileInfo.id+="#"+r.get("PID"),i.tileInfo.header={backgroundColour:"transparent",icon:a.getIconURLFromKey(l.get("type")),text:s.getDisplayName(r)},i.tileInfo.body.text=a.getNLSValue("ProcedureViewModule.UsagePoint"),R.push(i))}}))}else R.push(c)})),R.length>0&&(I=[...R]))}return{tileInfo:p,subNodes:I}}(t,n,i,r,o),r.tileInfo=l.tileInfo,r.id=l.tileInfo.id,r.children=[...l.subNodes],r},he=function(t,n,i){var o,r,a=[],s=[],l=[],c={[E]:[],[P]:[]};return s=d.getImpactedConnections(t.get("PID"),!1,{relationTypes:q}),e.is(n)&&s.push(...d.getImpactedConnections(n,!1,{relationTypes:q})),e.is(s,"array")&&s.length>0&&(l.push(...s),r=s.filter((e=>e.get("type")===y)),e.is(r,"array")&&r.length>0&&(r.forEach((e=>a.push(...d.getSecondaryRscLinksFromPrimaryLink(e)))),a.length>0&&l.push(...a))),e.is(l,"array")&&l.length>0&&(l=[...new Set(l)],o=oe(l),e.is(o)&&o.length>0&&o.forEach((function(t){var n,o,r=t.refModel,a={group:i.group,category:null,parentId:null},s=null;if(e.is(r)){for([n,o]of Object.entries(T))if(o.includes(r.get("PPRTYPE"))){a.category=n;break}s=Ie(r,t.instModel,t.connModel,a),T.MANUFACTURING.includes(r.get("PPRTYPE"))?(c[E].push(s),c[E].push(...s.children)):T.RESOURCES.includes(r.get("PPRTYPE"))&&(c[P].push(s),c[P].push(...s.children))}}))),c},me=function(e){var t=s.isReference(e)?e:s.getReferenceModelFromInstance(e);return!N.some((e=>f.isMdlAKindOf(t,e)))},Pe=function(t){var n=s.isReference(t)?t:s.getReferenceModelFromInstance(t),i=!0;return e.is(n)&&(T.ROUTINGS.includes(n.get("PPRTYPE"))||T.WKITYPES.includes(n.get("PPRTYPE")))&&me(n)||(i=!1),i},Ee=function(t,n){var i,r,d,u,g,p,I={sort:!0},h={},C=[];if(i=s.getReferenceModel(t),b.ROUTINGS.SWP_TYPE.includes(i.get("type"))&&b.ROUTINGS.SWP_TYPE.some((e=>f.isMdlAKindOf(i,e))))return e.is(V)?u=V:e.is(M)&&(0===M.path.length?g=M.id:(p=s.getInstance(M.path[0]),g=(p=s.getReference(p.get("isAggregatedBy"))).get("PID")),g&&(u=c.getRootFilter(g),u=e.is(u)&&e.is(u.originalFilterQuery)?u.originalFilterQuery:void 0)),V=u,R.forEach((function(t){var n;h[t]={columnInfo:(n=t,{id:"column_"+n,title:a.getNLSValue("ProcedureViewModule.Column."+n+".Title"),weight:e.is(G[n].weight)?G[n].weight:1}),nodesInfo:[]}})),(f.areChildrenFetched(i)?Promise.resolve():function(t){var n,i,r={},l=new Promise((e=>{i=e})),c=function(){o.warn(a.getNLSValue("Error.ExpandFailed.Title")),t.setAdditionalInfo({queriedForChildren:!1}),o.notify("stopProgress",r)},d={ordered:!1,context:o.getAppContext(),doNotExpand:!0,onFailure:c,onTimeout:c,onCancel:function(){o.warn(a.getNLSValue("Info.ExpandCanceled.Title")),t.setAdditionalInfo({queriedForChildren:!1}),o.notify("stopProgress",r)},expandLevel:2,forceIndexMode:!1,includeXcadDrawings:o.getPreferenceValue("includeXcadDrawingsInEBOMView")};return e.is(t)&&(o.notify("startProgress",r),n=f.areChildrenFetched(t),e.is(n)&&!n&&s.getDescendantsFromServer(t.get("PID"),(function(){o.notify("stopProgress",r),o.notify("expandedFromProcedureView",t.get("PID")),i()}),d)),l}(i)).then((()=>{if(d=V?s.getAllFilteredChildrenFromCollection(i.get("PID"),V):s.getAllChildrenFromCollection(i.get("PID")),e.is(d)&&e.is(d.instancesPID,"array")&&d.instancesPID.length>0&&e.is(d.referencesPID,"array")&&d.referencesPID.length>0){d.instancesPID.map((e=>s.getInstance(e))).forEach((e=>{let t=s.getReferenceModelFromInstance(e);t.isWorkInstruction()&&me(t)&&(C.push(f.fetchModelAttributes(e)),C.push(f.fetchModelAttributes(t)))}))}return r=V?s.getFilteredInstancesFromCollection(i.get("PID"),V,I):s.getInstancesFromCollection(i.get("PID"),I),Promise.allSettled(C).then((function(){var t,o,a,c,d;return d=0,t={category:m,group:(D={next:()=>++d,setGroupAtValue:e=>{d=e}}).next(),isRoot:!0},o=Ie(i,null,null,t),x=o.tileInfo.id,a={role:"",nodeId:""},o.occurencePath=n,o.isRoot=!0,o.role=null,o.tileInfo.isPinnable=!1,h.ROUTINGS.nodesInfo.push(o),h.ROUTINGS.nodesInfo.push(...o.children),c=he(i,null,o,h),o.linkedOjects={[E]:[...c[E]],[P]:[...c[P]]},h.MANUFACTURING.nodesInfo.push(...c[E]),h.RESOURCES.nodesInfo.push(...c[P]),r.forEach((function(t,r){var c,d,u,g;Pe(t)&&(c=t.get(j)||K,d=f.getServiceOotbRoleFromCustoRole(c),0!==r&&c===a.role||(u=pe(c,d,D.next(),o.tileInfo.id),h.ROUTINGS.nodesInfo.push(u),o.children.push(u),a=u),g=function t(o,r){var a,c,d=o.get("PID"),u=e.is(r.parentAbsolutePath)?r.parentAbsolutePath.concat([d]):n.concat([d]),g=s.getReferenceModelFromInstance(o),f={},p={},I={group:r.group||D.next(),category:r.category||m,parentId:r.parentId};if((a=Ie(g,o,null,I)).preSelected=(c=d,l.getSelectedInsts().findIndex((function(e){return e.get("isAggregatedBy")===i.get("PID")&&e.get("PID")===c}))>-1),a.occurencePath=u,a.role=e.is(r.serviceRole)?r.serviceRole:null,h.ROUTINGS.nodesInfo.push(a),h.ROUTINGS.nodesInfo.push(...a.children),T.ROUTINGS.includes(g.get("PPRTYPE"))&&(p=he(g,d,a,h),h.MANUFACTURING.nodesInfo.push(...p[E]),h.RESOURCES.nodesInfo.push(...p[P]),a.linkedObjects={[E]:[...p[E]],[P]:[...p[P]]}),"SYSTEM"!==g.get("PPRTYPE")&&"WORKINSTRUCTION"!==g.get("PPRTYPE")&&(f=V?s.getFilteredInstancesFromCollection(g.get("PID"),V,{sort:!0}):s.getInstancesFromCollection(g.get("PID"),{sort:!0}),e.is(f,"array")&&f.length>0&&!b.ROUTINGS.SWP_TYPE.includes(g.get("type")))){let e=[];f.forEach((t=>{Pe(t)&&e.push(t)})),e.length>0&&e.forEach((e=>{let n,i;n={parentId:a.tileInfo.id,serviceRole:a.role,parentAbsolutePath:a.occurencePath},i=t(e,n),a.children.push(i)}))}return a}(t,{parentId:a.id,serviceRole:a.role,parentAbsolutePath:n}),a.children.push(g))})),{columns:h}}))}))},Re=function(){e.is(k)&&(k.destroy(),k=void 0)},Ce=function(){var t=o.getAppContext(),n=Z.getCommandCheckHeader("DisplayProperties",t),i=k.getSelectedNodes()[0],r=ie(i.id);e.is(n)&&!1===n.getState()&&e.is(r)&&(n.options.node={referencePID:r.referenceId,instancePID:r.instanceId,absPath:r.occurencePath},n.toggleState())},Se=function(){var e,t,n=k.getSelectedNodes();1===n.length&&(t=ie(n[0].id).instanceId,e=s.getReferenceModel(t),f.editInstructionAttribute(t,e))},ye=function(){var t,n,i,o,r=k.getSelectedNodes(),a={},s=[];if(1===r.length){if(t=ie(r[0].id),e.is(t)&&(o=t.instanceId,i=t.referenceId,s=t.occurencePath),e.is(t.attrName)&&t.attrName===B&&(n=t,s=(t=ie(t.parentId)).occurencePath,n.tileInfo.id.contains("#ref")?i=e.is(t.referenceId)?t.referenceId:null:n.tileInfo.id.contains("#inst")&&(o=e.is(t.instanceId)?t.instanceId:null)),b.ROUTINGS.SWP_TYPE.includes(t.type)&&(o=e.is(o)&&t.isRoot?null:o,i=e.is(i)&&t.isRoot?i:null),!e.is(o)&&!e.is(i))return;a.attributeInfo=f.getAttributeInfo(B),a.objectToBeModified=undefined,a.attributeName=B,h.editRichTextAttribute([{referencePID:i,instancePID:o,absPath:s}],a)}},Ne=function(){var t,n,i=k.getSelectedNodes();1===i.length&&(t=ie(i[0].id),e.is(t.instanceId)||e.is(t.referenceId)||(t=ie(t.parentId)),n=s.getReferenceModel(e.is(t.instanceId)?t.instanceId:t.referenceId),T.WKITYPES.includes(n.get("PPRTYPE"))?Se():T.ROUTINGS.includes(n.get("PPRTYPE"))&&ye())},be=function(){var t,n,i=k.getSelectedNodes(),o=[];1===i.length&&(t=ie(i[0].id),n=e.is(t.instanceId)?s.getInstance(t.instanceId):s.getReference(t.referenceId),Te(n).forEach((e=>{o.push({attributeName:e,dataIndex:e.split(".")[1],attributeInfo:f.getAttributeInfo(e),instOrRef:s.isInstance(n)?"instance":"reference",value:n.get(e),objectToBeModified:n})})),h.editAttribute({referencePID:t.referenceId,instancePID:t.instandeId,id:s.isInstance(n)?t.instanceId:t.referneceId},o))},Te=function(e){return z.filter((t=>{var n=f.isAttrApplicableForMdl(e,t);return n&&t===j&&(n=e.get("isAggregatedBy")===$().find((e=>e.isRoot)).referenceId),n}))},Le=function(){let t,n,i=[];return L.contextualCommands.insertCommands.forEach((function(t){var n;if(e.is(t,"object")&&e.is(t.headerName))i.push({type:"TitleItem",title:a.getNLSValue(t.headerName,null,"ContextMenu.Header","Title")});else{let i,r,s=Z.getCommand(t,o.getAppContext());e.is(s)||(s=Z.getCommandCheckHeader(t,o.getAppContext())),e.is(s)&&(i=s.isEnabled()?"enabled":"disabled"),r=function(t){let n=Z.getCommand(t,o.getAppContext());e.is(n)&&(n.beginExecute(),n.execute({sourceModuleId:"ROUTINGS"}),n.endExecute())}.bind(null,t),n={type:"PushItem",icon:"url("+a.getIconURLFromKey(t)+")",title:a.getNLSValue(t,null,"Cmd","Title"),sensitivity:i,state:i,action:{callback:r}}}e.is(n)&&i.push(n)})),i=i.filter((function(e){return"TitleItem"===e.type||"enabled"===e.state})),i=i.filter((function(t,n){let o=!1;return o=!("TitleItem"!==t.type||!e.is(i[n+1])||"TitleItem"===i[n+1].type)||"PushItem"===t.type,o})),n=a.getNLSValue("InsertObject",null,"Cmd","Title"),t=0===i.length?{icon:"url("+a.getIconURLFromKey("InsertObject")+")",type:"PushItem",title:n,label:n,state:"disabled"}:{icon:"url("+a.getIconURLFromKey("InsertObject")+")",type:"PushItem",title:n,label:n,state:"enabled",submenu:i},t},ve=function(){var t=o.getAppContext(),n=Z.getCommand("SearchAndAddInstanceCommand",t);e.is(n)&&(n.beginExecute(),n.execute({sourceModuleId:"ROUTINGS"}),n.endExecute())},Ae=function(t){var n,i=[],o=e.is(t)?ie(t.id):null;return e.is(o)&&(n=e.is(o.instanceId)?s.getInstance(o.instanceId):s.getReference(o.referenceId),t.id.contains("attribute")||(i.push({type:"PushItem",icon:"url("+a.getIconURLFromKey("DisplayProperties")+")",title:a.getNLSValue("ProcedureViewModule.Information.Title"),action:{callback:function(){Ce()}}}),e.is(o.isRoot)&&o.isRoot||i.push({type:"PushItem",icon:"url("+a.getIconURLFromKey("GeneralDelete")+")",title:e.is(o.linkId)?a.getNLSValue("LinksUI.DeleteLink"):a.getNLSValue("LinksUI.Delete"),action:{callback:function(){!function(){var t,n,i,o,r=k.getSelectedNodes();1===r.length&&((i=ie(r[0].id)).linkId?(o=i.linkId,t=d.getConnection(o),e.is(t)&&d.deleteConnection(o)):(o=i.instanceId,e.is(o)&&(n=s.getInstance(o),e.is(n)&&s.deleteInstance([n],{askDeleteConfirmation:!1}))))}()}}})),T.WKITYPES.includes(o.PPRType)&&i.push({type:"PushItem",icon:"url("+a.getIconURLFromKey(o.type)+")",title:a.getNLSValue("Cmd.EditWorkInstruction.Title"),action:{callback:function(){Se()}}}),(T.ROUTINGS.includes(o.PPRType)||t.id.contains(B))&&i.push({type:"PushItem",icon:"pen-lines",title:a.getNLSValue("Cmd.EditRichText.Title"),action:{callback:function(){ye()}}}),T.ROUTINGS.includes(o.PPRType)&&(b.ROUTINGS.SWP_TYPE.includes(o.type)&&!o.isRoot||(i.push(Le()),i.push({type:"PushItem",icon:"url("+a.getIconURLFromKey("SearchAndInsertInstance")+")",title:a.getNLSValue("ProcedureViewModule.InsertExisting.Title"),action:{callback:function(){ve()}}}))),e.is(o.category)&&o.category===m&&!t.id.contains("attribute")&&(i.push({type:"PushItem",icon:"url("+a.getIconURLFromKey("ExpandNode")+")",title:a.getNLSValue("ProcedureViewModule.ExpandNode.Title"),action:{callback:function(){k.expandNode(t.id)}}}),i.push({type:"PushItem",icon:"url("+a.getIconURLFromKey("CollapseNode")+")",title:a.getNLSValue("ProcedureViewModule.CollapseNode.Title"),action:{callback:function(){k.collapseNode(t.id)}}}),i.push({type:"PushItem",icon:"url("+a.getIconURLFromKey("ExpandAll")+")",title:a.getNLSValue("ProcedureViewModule.ExpandAll.Title"),action:{callback:function(){k.expandAll(t.id)}}}),i.push({type:"PushItem",icon:"url("+a.getIconURLFromKey("CollapseAll")+")",title:a.getNLSValue("ProcedureViewModule.CollapseAll.Title"),action:{callback:function(){k.collapseAll(t.id)}}}),Te(n).length>0&&i.push({type:"PushItem",icon:"url("+a.getIconURLFromKey("EditAttribute")+")",title:a.getNLSValue("ProcedureViewModule.EditServiceAttributes.Title"),action:{callback:function(){be()}}}))),i},ke=function(){e.is(w)&&(w.destroy(),w=void 0)},Oe=function(n){var i,c,d=l.getSelections()[0],u=s.getReferenceModel(d);n.showPanel&&(i=a.getNLSValue(n.titleGraph),(v=new t(o,r)).init({title:i+" - "+s.getDisplayName(u),identifier:H,className:"ProcedureView-panel-container",onClose:function(){e.is(n.toggleCmdId)?o.notify("toggleCmdCheckHeaderState",{cmdName:n.toggleCmdId,cmdState:!1}):v.hide()}}),L=n,A=v.getContainer(),c=l.getSelectionsWithPaths()[0][0],M={id:c.id,path:c.path},v.buildSkeleton(),v.show(),Ve())},we=function(){ke(),Re(),Ve()},Ue=function(){e.is(U)&&(f.isOpsViewerWidgetLinked()?U.updateNodeModel("buildUp",{disabled:!1}):U.updateNodeModel("buildUp",{disabled:!0}))},xe=function(){var t=o.getAppContext(),n=Z.getCommandCheckHeader("OrderBySequence",t);e.is(n)?n.toggleState():o.notify("orderBySequence")},De=function(){var t=o.getAppContext(),n=Z.getCommandCheckHeader("BuildUpReviewModeCmd",t);e.is(n)&&n.toggleState()},Me=function(){var t,n={entries:[]},i=function(){return{dataElements:{typeRepresentation:"functionIcon",icon:{fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"2x",className:"toolbar-action"},position:"far",category:"view"}}};ke(),w=e.createElement("div",{class:"procedureView-toolbar"}),k&&(n.entries.push(function(){let e=i();return e.id="refresh",e.dataElements.category="view",e.dataElements.icon.iconName="refresh",e.dataElements.tooltip=new J({title:a.getNLSValue("ProcedureViewModule.Refresh.Title")}),e.dataElements.value=we,e}()),n.entries.push(function(){let e=i();return e.id="expandAll",e.dataElements.category="view",e.dataElements.icon.iconName="double-chevron-down",e.dataElements.tooltip=new J({title:a.getNLSValue("ProcedureViewModule.ExpandAll.Title")}),e.dataElements.value=k.expandAllNodes,e}()),n.entries.push(function(){let e=i();return e.id="collapseAll",e.dataElements.category="view",e.dataElements.icon.iconName="double-chevron-up",e.dataElements.tooltip=new J({title:a.getNLSValue("ProcedureViewModule.CollapseAll.Title")}),e.dataElements.value=k.collapseAllNodes,e}()),n.entries.push(function(){let e=i();return e.id="information",e.dataElements.icon.iconName="topbar-info",e.dataElements.category="authoring",e.dataElements.disabled=!0,e.dataElements.tooltip=new J({title:a.getNLSValue("ProcedureViewModule.Information.Title")}),e.dataElements.value=Ce,e}()),n.entries.push(function(){let e=i();return e.id="editTextAttribute",e.dataElements.icon.iconName="pen-lines",e.dataElements.category="authoring",e.dataElements.disabled=!0,e.dataElements.tooltip=new J({title:a.getNLSValue("ProcedureViewModule.Edit.Title")}),e.dataElements.value=Ne,e}()),n.entries.push(function(){let t,n=i(),o=k.getSelectedNodes();if(n.id="editServiceAttributes",1===o.length){let i=ie(o[0].id);t=e.is(i.instanceId)?s.getInstance(i.instanceId):s.getReference(i.referenceId),n.dataElements.disabled=Te(t).length>0}else n.dataElements.disabled=!0;return n.dataElements.category="authoring",n.dataElements.icon.iconName="attributes",n.dataElements.tooltip=new J({title:a.getNLSValue("ProcedureViewModule.EditServiceAttributes.Title")}),n.dataElements.value=be,n}()),n.entries.push(function(){let e=i(),t=k.getSelectedNodes();if(e.id="orderBySequence",e.dataElements.icon.iconName="num-sorting-1-2",e.dataElements.category="authoring",1===t.length){let n=ie(t[0].id);b.ROUTINGS.SWP_TYPE.includes(n.type)&&(e.dataElements.disabled=!1)}else e.dataElements.disabled=!0;return e.dataElements.tooltip=new J({title:a.getNLSValue("ProcedureViewModule.OrderBySequence.Title")}),e.dataElements.value=xe,e}()),n.entries.push(function(){let e=i();return e.id="buildUp",e.dataElements.category="authoring",e.dataElements.icon.iconName="3d-object",e.dataElements.disabled=!f.isOpsViewerWidgetLinked(),e.dataElements.tooltip=new J({title:a.getNLSValue("ProcedureViewModule.BuildUpReviewMode.Title")}),e.dataElements.value=De,e}()),n.entries.push(function(){let t=(n=Le().submenu,i=[],o={dataElements:{typeRepresentation:"functionMenuIcon",disabled:!0,icon:{fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"2x",className:"toolbar-action"},position:"far",category:"view",value:{}}},e.is(n,"array")&&n.length>0&&(n.forEach((t=>{let n={type:t.type,title:t.title,icon:t.icon};e.is(t.action)&&(n.action=t.action),i.push(n)})),o.dataElements.value.menu=i,o.dataElements.disabled=!1),o);var n,i,o;return t.id="insertNew",t.dataElements.category="authoring",t.dataElements.icon.iconName="plus",t.dataElements.tooltip=new J({title:a.getNLSValue("InsertObject",null,"Cmd","Title")}),t}()),n.entries.push(function(){let e=i();return e.id="insertExisting",e.dataElements.category="authoring",e.dataElements.icon.iconName="insert",e.dataElements.tooltip=new J({title:a.getNLSValue("ProcedureViewModule.InsertExisting.Title")}),e.dataElements.value=ve,e}()),t=Q.prototype.createTreeDocument(n),(U=new Q({overflowManagement:"dropdown",direction:"horizontal",items:t})).elements.container.addClassName("procedureView-actions"),U.inject(w)),w.inject(A,"top")},Ve=function(){return V=null,Ee(M.id,M.path).then((function(e){O=e.columns,Re(),(k=new n(r,{identifier:H,columnOptions:O,nodeOptions:G,onChartNodeSelectionChange:fe,getNodeContextMenu:Ae,onNodeDoubleClick:ge})).init()})).then((function(){k.inject(A),k.createViewComponent(),Me(),k.selectNodes([x])}))};return{name:"ProcedureViewModule",listenTo:function(){return{select:ue,referenceAdded:ce,instanceAdded:ce,instanceRemoved:de,referenceRemoved:de,referenceChanged:le,instanceChanged:le,reparent:we,ExpandFilterApplied:we,expandFilterUpdated:we,ExpandFilterRemoved:we,replaced:we,refreshSwimLaneChart:we,reorder:we,widgetLinked:Ue,widgetUnlinked:Ue}},onStart:function(t,n){var o=e.Json.decode(i);G.MANUFACTURING=o.MANUFACTURING,G.RESOURCES=o.RESOURCES,G.WKITYPES=o.WKITYPES,G.ROUTINGS=o.ROUTINGS,G.SERVICE_ROLES=o.SERVICE_ROLES,Oe(t),n()},onStop:function(){e.is(k)&&(k.destroy(),k=void 0),e.is(v)&&(v.destroy(),v=void 0)}}}}}));