define("DS/DocumentMultiFilePreview/eventHandlers/FilesEvents",["UWA/Class"],(function(e){"use strict";return e.extend({init:function(e){this.ctrl=e},connect:function(e,t,n){var o=this;this.ctrl.events.addEventListener("user-dropped-files",(function(e){})),this.ctrl.events.addEventListener("user-selects-files-for-upload",(function(e){})),this.ctrl.events.addEventListener("enox-files-collection-count-changed",(function(t){e.switchView(e.view)})),this.ctrl.events.addEventListener("enox-file-node-selection-changed",(function(e){})),this.ctrl.events.addEventListener("enox-docfiles-switch-view",(function(t){e.switchView(t)})),this.ctrl.events.addEventListener("search-toggle-change",(function(e){t.selectionChanged()})),this.ctrl.events.addEventListener("left-navigationPanel-Expanded",(function(e){t.selectionChanged()})),this.ctrl.events.addEventListener("enox-files-parent-changed",(function(e){t.selectionChanged(),o.ctrl.events.publish({event:"reset-search-textbox"})}))}})})),define("DS/DocumentMultiFilePreview/containers/TopNavBarContent/CustomPreviewActions/Download",["UWA/Core","i18n!DS/DocumentMultiFilePreview/assets/nls/DocumentPreview","css!DS/DocumentPreview/DocumentPreview.css"],(function(e,t){"use strict";var n=function(e){return{id:"CustomPreviewDownload",dataElements:{docV2Public:!0,typeRepresentation:"functionMenuIcon",icon:{iconName:"download",fontIconFamily:1},label:t.get("Download"),tooltip:{shortHelp:t.get("Download")},position:"far",priority:6,value:{menu:[{type:"PushItem",title:t.get("Download_File"),icon:{iconName:"download",fontIconFamily:1},tooltip:{shortHelp:t.get("Download_File")},action:{callback:function(){console.log("File Download Initiated!"),n.DownloadFile(e)}}},{type:"PushItem",title:t.get("Download_Document"),tooltip:{shortHelp:t.get("Download_Document")},icon:{iconName:"download",fontIconFamily:1},action:{callback:function(){console.log("Document Download Initiated!"),n.DownloadDocument(e)}}}]},visibleFlag:!0},updateForSelection:function(t,n){var o=e.previewedDocumentStatusModel.getPreviewedDocumentFiles().length>1;t({visibleFlag:1==e.getSelectedNodes().length&&o})}}};return n.DownloadDocument=function(e){require(["DS/DocumentCommands/V2/Actions/Download"],(function(t){e.DocumentDownloadInstance=new t(e.DocCmdOptions),e.DocumentDownloadInstance.execute()}))},n.DownloadFile=function(e){require(["DS/DocumentCommands/V2/FileActions/Download"],(function(t){e.FileDownloadInstance=new t(e),e.FileDownloadInstance.execute()}))},n.execute=function(e){console.warn("Strange! I should not be here.")},n})),define("DS/DocumentMultiFilePreview/containers/rightSideContent/RightInformationPanelContainer",["UWA/Core","UWA/Controls/Abstract","UWA/Element","DS/CoreEvents/ModelEvents","css!DS/DocumentMultiFilePreview/css/RightInformationPanelContainer.css"],(function(e,t,n,o,i){return t.extend({name:"docm-preview-right-container",options:{className:""},init:function(e){e.rightContainerContentControl=this,this.events=e.options.events||new o,delete e.options.events,this._parent(e.options),e.options.events=this.events,this.buildSkeleton()},buildSkeleton:function(){var t=this;this.elements.container=e.createElement("div",{class:this.getClassNames()}),this.elements.content=e.createElement("div",{class:this.getClassNames("-content")}).inject(this.elements.container),this.elements.info=e.createElement("div",{class:this.getClassNames("-content-info")}).inject(this.elements.content),this.elements.info.hide(),t.options.skeleton.rightContainerContent.setHTML(t.elements.container),t.loadPanel()},loadPanel:function(){}})})),define("DS/DocumentMultiFilePreview/containers/centerContent/PreviewProvider",["UWA/Core","UWA/Utils","DS/3DPlayHelper/3DPlayHelper","DS/WebappsUtils/WebappsUtils","DS/DocumentCommonInfra/TrackerAPI","i18n!DS/DocumentPreview/assets/nls/DocumentPreview"],(function(e,t,n,o,i,l){"use strict";return function(a,s){var r,c={build:function(t,o){this.ctrl=t,this._3dplayhelper=n,t.options.document&&t.options.document.relateddata&&e.is(t.options.document.relateddata.files,"array")?this.files=t.options.document.relateddata.files:this.files=[],this.selectedFileId=t.options.selectedFileId;var i=this;if(null!=this.selectedFileId){var a=this.files.find((function(e){return e.id==i.selectedFileId}));null!=a?(this.selectedFile=a,t.options.selectedFileId=void 0):t.parentCtrl.helper.showNotification("error",l.get("CANNOTACCESSFILE_TITLE"),"",l.get("CANNOTACCESSFILE_MESSAGE"),!0)}if(null==this.selectedFile&&this.files.length>0&&(this.selectedFile=this.ctrl.options.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile()||this.files[0]),this.playdata={asset:{provider:"EV6",dtype:"DOCUMENTS",serverurl:t.options.platformUrls["3DSpace"],tenant:t.options.platformUrls.platformId||t.options.tenant,contextId:t.options.securityContext}},this.container=o,this.fillFilebar(),this.canvas=e.createElement("div",{class:"viewer-canvas"}),this.canvas.inject(this.container),null!=this.selectedFile&&this.files.length>1){c.documentId=t.options.document.id,c.playdata.asset.physicalid=t.options.document.id;var s={asset:c.playdata.asset,physicalId:this.selectedFile.id,renderTo:c.canvas,fileName:this.selectedFile.dataelements.title,docId:t.options.document.id,docType:t.options.document.type,fileCount:this.files.length};c.fileid=this.selectedFile.id,c.filename=this.selectedFile.dataelements.title,c.play(s)}else{c.documentId=t.options.document.id,c.playdata.asset.physicalid=t.options.document.id;s={asset:c.playdata.asset,physicalId:t.options.document.id,renderTo:c.canvas,docId:t.options.document.id,docType:t.options.document.type,fileCount:1};c.play(s)}},fillFilebar:function(){var e=this;a.options.previewedDocumentStatusModel.addEvent("onChange:previewedDocumentSelectedFileId",(function(t,n){if(console.log(t),null!=n&&t.getPreviewedDocumentFiles().length>1){c.playdata.asset.physicalid=t.getPreviewedDocument().id;var o={asset:c.playdata.asset,physicalId:n||t.getPreviewedDocumentSelectedFile().id,renderTo:c.canvas,fileName:t.getPreviewedDocumentSelectedFile().dataelements.title,docId:t.getPreviewedDocument().id,docType:t.getPreviewedDocument().type,fileCount:1};e._3dplayhelperaccess=void 0,c.fileid=n,c.filename=t.getPreviewedDocumentSelectedFile().dataelements.title,c.play(o)}else{c.playdata.asset.physicalid=t.getPreviewedDocument().id;o={asset:c.playdata.asset,physicalId:t.getPreviewedDocument().id,renderTo:c.canvas,docId:t.getPreviewedDocument().id,docType:t.getPreviewedDocument().type,fileCount:1};c.play(o)}})),a.options.previewedDocumentStatusModel.addEvent("onChange:previewedDocument",(function(t,n){if(console.log(t),n.id!=c.documentId){if(null!=t.getPreviewedDocumentSelectedFile()&&t.getPreviewedDocumentFiles().length>1){c.documentId=a.options.document.id,c.playdata.asset.physicalid=n.id;var o={asset:c.playdata.asset,physicalId:t.getPreviewedDocumentSelectedFileId()||t.getPreviewedDocumentSelectedFile().id,renderTo:c.canvas,fileName:t.getPreviewedDocumentSelectedFile().dataelements.title,docId:n.id,docType:n.type,fileCount:1};c.fileid=t.getPreviewedDocumentSelectedFileId()||t.getPreviewedDocumentSelectedFile().id,c.filename=t.getPreviewedDocumentSelectedFile().dataelements.title,c.play(o)}else{c.documentId=a.options.document.id,c.playdata.asset.physicalid=n.id;o={asset:c.playdata.asset,physicalId:n.id,renderTo:c.canvas,docId:n.id,docType:n.type,fileCount:1};c.play(o)}e._3dplayhelperaccess=void 0}}))},play:function(n){var l=this;n.asset.physicalid=n.physicalId,n.renderTo.empty(),n.renderTo.setAttribute("fileName",n.fileName),r&&r.dispose&&r.dispose(),r=void 0;var s={input:{asset:n.asset},options:{loading:"autoplay"}};l.playerToken="ENO-Docm-Preview-"+t.getUUID();var c=l.player=e.createElement("iframe").inject(n.renderTo);c.style.position="absolute",c.style.width="100%",c.style.height="100%",c.style.border="0px",c.style.top="0px",c.style.left="0px",c.id=l.playerToken,c.allowFullScreen=c.mozAllowFullScreen=c.webkitAllowFullScreen=!0,c.setAttribute("allowFullScreen",""),c.addEventListener("load",(function(e){try{function t(e,t){const n=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0});n.dataTransfer=t.dataTransfer,l.container.dispatchEvent(n)}e.target.contentDocument.getElementById("canvas-div").style.backgroundColor="white",c.contentDocument&&(c.contentDocument.addEventListener("drop",(function(e){try{e.preventDefault(),t("drop",e)}catch(e){}})),c.contentDocument.addEventListener("dragover",(function(e){try{e.preventDefault(),t("dragover",e)}catch(e){}})),c.contentDocument.addEventListener("dragStart",(function(e){try{t("dragStart",e)}catch(e){}})),c.contentDocument.addEventListener("dragend",(function(e){try{t("dragend",e)}catch(e){}})),c.contentDocument.addEventListener("dragleave",(function(e){try{t("dragleave",e)}catch(e){}})))}catch(n){}})),window&&window.top&&window.top.document&&window.top.document.addEventListener("3DPLAYLOADINGFINISHED",(function(e){e&&e.detail&&e.detail.helper&&e.detail.helper.instance&&(console.log("Document Multifile Preview viewer Loaded!"),l._3dplayhelperaccess=e.detail.helper.instance,l.register3DPlayHelperEvents(),a.events.publish({event:"ENO-DOCM-MultiFilePreview-Loaded",data:{_3dplayhelperaccess:l._3dplayhelperaccess}}))}),{once:!0});var d=o.getProxifiedWebappsBaseUrl();d||(d=o.getWebappsBaseUrl()),c.src=(d.endsWith("/")?d:d+"/")+"3DPlayHelper/3DPlaySyndication.html?params="+encodeURIComponent(JSON.stringify(s));var u=new Date-window.previewLoadStart;i.sendTrackerPageEvent({category:"docm.command.preview2",action:"click",label:"Document Preview",pd:{docId:n.docId,docType:n.docType,source:a.options.uaSource},pv:{totalTimeTaken:u,success:1,fileCount:n.fileCount}})},register3DPlayHelperEvents:function(){var e=this;e._3DPlayHelperEventToken&&a.events.unsubscribe(e._3DPlayHelperEventToken),e._3DPlayHelperEventToken=a.events.addEventListener("3DPlay-DocumentManagement-Execute-3DPlayHelper-Action",(t=>{var n=t.command;t.action;switch(console.log(`So you want to ${n}`),n){case"PrintScreenShot":e._3dplayhelperaccess.executeScriptingFunction("SharePrint");break;case"SaveScreenShot":e._3dplayhelperaccess.executeScriptingFunction("ShareDownload");break;case"PublishTo3DSwym":e._3dplayhelperaccess.executeScriptingFunction("ShareTo3DSwYm")}})),e._3DPlayCommentAnnotationHelperEventToken&&a.events.unsubscribe(e._3DPlayCommentAnnotationHelperEventToken),e._3DPlayCommentAnnotationHelperEventToken=a.events.addEventListener("facet-opened-in-properties",(t=>{var n=t.facetName,o=t.editPropertiesView,i=a.options.isOnCloud;if("social"==n&&o&&e._3dplayhelperaccess&&e._3dplayhelperaccess.PanelManager&&i){var l=e._3dplayhelperaccess.PanelManager.experience;e._3dplayhelperaccess.PanelManager._pictureFlash((()=>{var n=function(e,n){var o=new Blob([n],{type:"application/json"});e.getScreenShot({width:240,height:180,type:"jpeg",onSuccess:function(n){var i={screenshot:n,annotation:o};t.editPropertiesView.addAnnotationData(i),e=null}})},o=l.frmWindow.getViewer(),i=o&&o.getCurrentState?o.getCurrentState():void 0;if(i){var a=l.annotationManager;n(l,a.saveAnnotationsToJSON(null,i))}else l.updateSession().then((function(){n(l,JSON.stringify(e._3dplayhelperaccess.PanelManager.getSession()))}))}))}}))},destroy:function(){r&&r.dispose&&r.dispose(),r=void 0,this.container.empty(!0)}};return c.build(a,s),c}})),define("DS/DocumentMultiFilePreview/containers/TopNavBarContent/CustomPreviewActions/Information",["UWA/Core","i18n!DS/DocumentMultiFilePreview/assets/nls/DocumentPreview","css!DS/DocumentMultiFilePreview/css/TopNavBarContainer.css"],(function(e,t){"use strict";var n=function(e){return{id:"CustomPreviewInformation",dataElements:{docV2Public:!0,typeRepresentation:"functionIcon",icon:{iconName:"info",fontIconFamily:1},label:t.get("INFORMATION"),tooltip:t.get("INFORMATION"),position:"far",priority:8,value:function(t){t.options=e,n.execute(t)},visibleFlag:!0},execute:function(t,o){n.execute({options:e},t,o)},updateForSelection:function(t,n){var o=!1;e.ctrl.rightContainerContentControl&&(null==e.ctrl.rightContainerContentControl.elements.info||e.ctrl.rightContainerContentControl.elements.info.isHidden()||(o=!0)),t({visibleFlag:1==e.getSelectedNodes().length,icon:{iconName:"info",fontIconFamily:1,className:o?"info-active":""}})}}};return n.execute=function(e,t,n){var o=e.options.ctrl.rightContainerContentControl,i=e.options;(e.options.keepOpen||o.elements.info.isHidden())&&(e.options.keepOpen=!0,null==o.propertiesComponent?(o.options.nodeModels=[o.options.nodeModel],o.options.documents=[o.options.document],t&&(o.options.facetName=t),"ReadMode"==e.options.ctrl.options.mode&&(o.options.readMode=!0,o.options.requiredCustomFacets=!1,o.options.customizeDefaultFacets=t=>t.filter((t=>"properties"==t||"social"==t&&e.options.ctrl.options.isOnCloud))),require(["DS/DocumentPreview/PropertiesComponent"],(function(t){o.propertiesComponent=new t(o.options),o.propertiesComponent.events.unsubscribeAll({event:"close-document-properties"}),o.propertiesComponent.events.subscribe({event:"close-document-properties"},(function(){o.elements.info.hide(),o.options.skeleton.setCollapseFlagFromUIInteraction("right",!0),e.options.ctrl.topbarControl.toolbar.selectionChanged()})),e.options.ctrl.previewedDocumentStatusModel.addEvent("onChange:previewedDocumentFiles",(function(e,t){o.propertiesComponent.nodeModels=[o.options.nodeModel],o.propertiesComponent.setSelection([o.options.document])})),o.propertiesComponent.events.subscribe({event:"edit-prop-property-change"},(function(e){if("Title"===e.attribute){var t=e.attribute,n=e.editprop._attributes[t].value;i.ctrl.navBar.updateDocumentName(n)}})),o.propertiesComponent.inject(o.elements.info)}))):(o.propertiesComponent.nodeModels=[o.options.nodeModel],o.propertiesComponent.setSelection([o.options.document],t))),o.elements.info.isHidden()?(o.elements.info.show(),o.options.skeleton.setCollapseFlagFromUIInteraction("right",!1)):n||e.options.keepOpen&&(o.elements.info.hide(),o.options.skeleton.setCollapseFlagFromUIInteraction("right",!0)),e.options.ctrl.navBar.toolbar.selectionChanged()},n})),define("DS/DocumentMultiFilePreview/models/PreviewedDocumentStatusModel",["UWA/Class/Model","UWA/Class/Debug"],(function(e,t){return e.extend(t,{defaults:{previewedDocument:void 0,previewedDocumentFiles:[],previewedDocumentSelectedFile:void 0,previewedDocumentSelectedFileId:void 0,selectedFileModifiedToken:(new Date).toISOString()},getPreviewedDocument:function(){return this.get("previewedDocument")},getPreviewedDocumentFiles:function(){return this.get("previewedDocumentFiles")},getPreviewedDocumentSelectedFile:function(){return this.get("previewedDocumentSelectedFile")},getPreviewedDocumentSelectedFileId:function(){return this.get("previewedDocumentSelectedFileId")},appendNewFileInToPreviewedDocument:function(e){var t=[...this.get("previewedDocumentFiles"),e];this.set({previewedDocumentFiles:t})},appendNewFilesInToPreviewedDocument:function(e){var t=[...this.get("previewedDocumentFiles"),...e];this.set({previewedDocumentFiles:t})},changePreviewedDocumentSelectedFile:function(e){this.set({previewedDocumentSelectedFile:e})},changePreviewedDocumentSelectedFileId:function(e){this.set({previewedDocumentSelectedFileId:e})},changePreviewedDocument:function(e){this.set({previewedDocument:e})},changePreviewedDocumentFilesArray:function(e){this.set({previewedDocumentFiles:e})},changePreviewedDocumentSelectedFileWithId:function(e){var t=this.get("previewedDocumentFiles").filter((t=>t.id==e));t.length>0&&this.set({previewedDocumentSelectedFile:t[0]})},removeFileFromPreviewedDocumentFiles:function(e){var t=this.getPreviewedDocumentFiles().length,n=this.getPreviewedDocumentFiles().filter((t=>t.id!==e));n.length<t&&(this.set({previewedDocumentFiles:n}),this.handlePreviewedDocumentSelectedFile())},removeFilesFromPreviewedDocumentFiles:function(e){var t=this.getPreviewedDocumentFiles().length,n=this.getPreviewedDocumentFiles().filter((t=>!e.includes(t.id)));n.length<t&&this.set({previewedDocumentFiles:n})},updateFileInPreviewedDocumentFiles:function(e,t){const n=this.get("previewedDocumentFiles").map((n=>n.id===e?t:n));this.set({previewedDocumentFiles:n})},handlePreviewedDocumentSelectedFile:function(){var e=this.getPreviewedDocumentFiles(),t=this.getPreviewedDocumentSelectedFile();e.find((e=>e.id==t.id))||(e.length>0?this.set({previewedDocumentSelectedFile:e[0]}):this.set({previewedDocumentSelectedFile:void 0}))},refreshSelectedFileModifiedToken:function(){this.set({selectedFileModifiedToken:(new Date).toISOString()})},getSelectedFileModifiedToken:function(){return this.get("selectedFileModifiedToken")}})})),define("DS/DocumentMultiFilePreview/MultiFilePreviewEvents",["UWA/Class"],(function(e){"use strict";return e.extend({init:function(e){this.ctrl=e,this.connect()},connect:function(){var e=this;if(!this.ctrl.events.addSingletonEventListener){var t={};e.ctrl.events.addSingletonEventListener=function(n,o,i){t[n]&&e.ctrl.events.unsubscribe(t[n]),t[n]=e.ctrl.events.addEventListener(o,i)}}this.ctrl.events.addEventListener("enox-file-node-selection-add",(function(t){e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFileWithId(t.options.data.id),e.ctrl._updateSelectedNodeCache(t)})),this.ctrl.events.addEventListener("show-facet-in-properties",(function(t){console.log("Launch of Comment Panel Initiated."),e.ctrl.topbarControl.toolbar.privateDocumentCommands.commands.CustomPreviewInformation.execute(t.facetName,!0)})),e.ctrl.events.addSingletonEventListener("doc-cmd-evts-show-notification","docv2-show-notification",(function(t){e.ctrl.controller.helper.showNotification(t.level,t.title,t.subtitle,t.message,t.sticky,t.allowUnsafeHTML)})),this.ctrl.events.addEventListener("3DPlay-DocumentManagement-Execute-Action",(function(t){var n=t.command;t.action;switch(n){case"information":console.log("I got an order to execute information command"),e.ctrl.topbarControl.toolbar.privateDocumentCommands.commands.CustomPreviewInformation.execute();break;case"copylink":console.log("I got an order to execute copy link command"),e.ctrl.topbarControl.toolbar.publicDocumentCommands.commands.CopyLink.execute();break;case"download-file":console.log("I got an order to execute download-file command");try{e.ctrl.topbarControl.toolbar.fileCommands.commands.CustomPreviewDownload.grid.data.menu[0].action.callback()}catch(e){console.error("Document Management : Failed To Execute Download File Command.")}break;case"download-document":console.log("I got an order to execute download-document command");try{e.ctrl.topbarControl.toolbar.fileCommands.commands.CustomPreviewDownload.grid.data.menu[1].action.callback()}catch(e){console.error("Document Management : Failed To Execute Download Document Command.")}}}))}})})),define("DS/DocumentMultiFilePreview/Data",["UWA/Class","UWA/Promise","DS/WAFData/WAFData"],(function(e,t,n){"use strict";return e.extend({init:function(e){this.ctrl=e},getDocument:function(e){var o=this;return new t((function(t,i){var l=o.ctrl.options.fetchSecurityContext(),a=o.ctrl.options.platformUrls["3DSpace"];n.authenticatedRequest(a+"/resources/v1/modeler/documents",{method:"POST",type:"json",headers:{Accept:"application/json","Accept-Language":widget.lang,SecurityContext:encodeURIComponent(l)},data:`$ids=${e}`,onComplete:function(e){e.success&&(Array.isArray(e.data)||i(e),t(e.data))},onFailure:function(e){i(e)}})}))}})})),define("DS/DocumentMultiFilePreview/eventHandlers/PreviewedDocumentModelEvents",["UWA/Class"],(function(e){"use strict";return e.extend({init:function(e){this.ctrl=e,this.connect(),this.ctrl.options.documentManagedByPreview&&this.hookGlobalFileEvents()},connect:function(){var e=this;this.ctrl.previewedDocumentStatusModel.addEvent("onChange:previewedDocumentFiles",(function(t,n){var o=n.length;o>1&&!e.ctrl.leftPanelLoaded?e.ctrl.reCreateLeftNavigationPanel():o<2&&e.ctrl.destroyLeftNavigationPanel()})),this.ctrl.previewedDocumentStatusModel.addEvent("onChange:previewedDocumentSelectedFile",(function(e,t){e.refreshSelectedFileModifiedToken(),t?e.changePreviewedDocumentSelectedFileId(t.id):e.changePreviewedDocumentSelectedFileId(void 0)}))},hookGlobalFileEvents:function(){var e=this;require(["DS/PlatformAPI/PlatformAPI"],(function(t){e.docmFileAddedToDocumentToken=t.subscribe("docm-file-added-to-document",(function(t){t.platformId==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.documentId&&(e.ctrl.controller.files.addFiles(t.newFiles,"left Panel event"),e.ctrl.previewedDocumentStatusModel.appendNewFilesInToPreviewedDocument(t.newFiles),e.ctrl.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile()||e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFile(e.ctrl.previewedDocumentStatusModel.getPreviewedDocumentFiles()[0]),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel())})),e.docmFilesDeletedFromDocumentToken=t.subscribe("docm-files-deleted-from-document",(function(t){t.platformId==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.documentId&&(e.ctrl.controller.files.removeFilesByIds(t.deletedFileIds),e.ctrl.previewedDocumentStatusModel.removeFilesFromPreviewedDocumentFiles(t.deletedFileIds),t.deletedFileIds.includes(e.ctrl.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile().id)&&e.ctrl.previewedDocumentStatusModel.handlePreviewedDocumentSelectedFile(),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel())})),e.docmFilesUpdatedDocumentToken=t.subscribe("docm-file-updated-to-document",(function(t){t.platformId==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.documentId&&e.ctrl.controller.files.treeDocument.getRoots().forEach((n=>{n.options.data.id==t.oldFileId&&(n.options.updateData(t.updatedFile),e.ctrl.previewedDocumentStatusModel.updateFileInPreviewedDocumentFiles(t.oldFileId,t.updatedFile),e.ctrl.previewedDocumentStatusModel.get("previewedDocumentSelectedFile").id==t.oldFileId&&e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFileWithId(t.updatedFile.id),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel())}))})),e.docmFileEditedDocumentToken=t.subscribe("docm-file-edited-in-document",(function(t){t.platformId==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.documentId&&e.ctrl.controller.files.treeDocument.getRoots().forEach((n=>{n.options.data.id==t.file.id&&(n.options.updateData(t.file),e.ctrl.previewedDocumentStatusModel.updateFileInPreviewedDocumentFiles(t.file.id,t.file),e.ctrl.previewedDocumentStatusModel.get("previewedDocumentSelectedFile").id==t.file.id&&e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFileWithId(t.file.id),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel())}))})),e.docmFileUndoeditedDocumentToken=t.subscribe("docm-file-undoedited-in-document",(function(t){t.platformId==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.documentId&&e.ctrl.controller.files.treeDocument.getRoots().forEach((n=>{n.options.data.id==t.file.id&&(n.options.updateData(t.file),e.ctrl.previewedDocumentStatusModel.updateFileInPreviewedDocumentFiles(t.file.id,t.file),e.ctrl.previewedDocumentStatusModel.get("previewedDocumentSelectedFile").id==t.file.id&&e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFileWithId(t.file.id),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel())}))})),e.docmFileLockDocumentToken=t.subscribe("docm-file-locked-in-document",(function(t){t.platformId==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.documentId&&e.ctrl.controller.files.treeDocument.getRoots().forEach((n=>{n.options.data.id==t.file.id&&(n.options.updateData(t.file),e.ctrl.previewedDocumentStatusModel.updateFileInPreviewedDocumentFiles(t.file.id,t.file),e.ctrl.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile().id==t.file.id&&e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFileWithId(t.file.id),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel())}))})),e.docmFileUnlockDocumentToken=t.subscribe("docm-file-unlocked-in-document",(function(t){t.platformId==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.documentId&&e.ctrl.controller.files.treeDocument.getRoots().forEach((n=>{n.options.data.id==t.file.id&&(n.options.updateData(t.file),e.ctrl.previewedDocumentStatusModel.updateFileInPreviewedDocumentFiles(t.file.id,t.file),e.ctrl.previewedDocumentStatusModel.get("previewedDocumentSelectedFile").id==t.file.id&&e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFileWithId(t.file.id),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel())}))})),e.docmFileLifeCycleChangeDocumentToken=t.subscribe("Lifecycle.Modification",(function(t){((t="string"==typeof t?JSON.parse(t):t).Refresh.modified&&t.Refresh.modified[0]&&"RestoreIteration"==t.Refresh.modified[0].operation||t.Refresh.created&&t.Refresh.created[0]&&"RestoreIteration"==t.Refresh.created[0].operation)&&t.tenant==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.Refresh.modified[0].physicalid&&e.ctrl.controller.data.getFiles(t.Refresh.modified[0].physicalid).then((t=>{var n=t.files,o=e.ctrl.previewedDocumentStatusModel.getPreviewedDocumentFiles();const i=new Set(o.map((e=>e.id))),l=new Set(n.map((e=>e.id))),a=[...l].filter((e=>!i.has(e))),s=[...i].filter((e=>!l.has(e)));if(1===a.length&&1===s.length){const t=a[0],o=s[0],i=n.find((e=>e.id===t));e.ctrl.controller.files.treeDocument.getRoots().forEach((t=>{t.options.data.id==o&&(t.options.updateData(i),e.ctrl.previewedDocumentStatusModel.updateFileInPreviewedDocumentFiles(o,i))})),e.ctrl.previewedDocumentStatusModel.get("previewedDocumentSelectedFile").id==o&&e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFile(i),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel()}}))}))}))},unHookGlobalFileEvents:function(){var e=this;require(["DS/PlatformAPI/PlatformAPI"],(function(t){e.docmFileAddedToDocumentToken&&t.unsubscribe(e.docmFileAddedToDocumentToken),e.docmFilesDeletedFromDocumentToken&&t.unsubscribe(e.docmFilesDeletedFromDocumentToken),e.docmFilesUpdatedDocumentToken&&t.unsubscribe(e.docmFilesUpdatedDocumentToken),e.docmFileEditedDocumentToken&&t.unsubscribe(e.docmFileEditedDocumentToken),e.docmFileUndoeditedDocumentToken&&t.unsubscribe(e.docmFileUndoeditedDocumentToken),e.docmFileLockDocumentToken&&t.unsubscribe(e.docmFileLockDocumentToken),e.docmFileUnlockDocumentToken&&t.unsubscribe(e.docmFileUnlockDocumentToken),e.docmFileLifeCycleChangeDocumentToken&&t.unsubscribe(e.docmFileLifeCycleChangeDocumentToken)}))}})})),define("DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationTopbarActions/CollapsePanel",["UWA/Core","i18n!DS/DocumentMultiFilePreview/assets/nls/DocumentPreview"],(function(e,t){"use strict";var n=function(e){return{id:"closeButton",dataElements:{docV2Private:!0,typeRepresentation:"functionIcon",icon:{iconName:"close",fontIconFamily:1},label:t.get("Close"),tooltip:t.get("Close"),position:"far",category:"resize",value:function(t){t.options=e,n.execute(t)},visibleFlag:!0,priority:6},updateForSelection:function(e,t){},execute:function(){n.execute({options:e})}}};return n.execute=function(e){e.options.skeleton.setCollapseFlagFromUIInteraction("left",!0),e.options.events.publish({event:"left-navigationPanel-Expanded",data:!1})},n})),define("DS/DocumentMultiFilePreview/containers/TopNavBarContent/CustomPreviewActions/Comment",["UWA/Core","i18n!DS/DocumentMultiFilePreview/assets/nls/DocumentPreview","css!DS/DocumentPreview/DocumentPreview.css"],(function(e,t){"use strict";var n=function(e){return{id:"CustomPreviewComment",dataElements:{docV2Public:!0,typeRepresentation:"functionIcon",icon:{iconName:"topbar-comment",fontIconFamily:1},label:t.get("COMMENTS"),tooltip:t.get("COMMENTS"),position:"far",priority:7,value:function(t){t.options=e,n.execute(t)},visibleFlag:!0},execute:function(){n.execute({options:e})},updateForSelection:function(e,t){}}};return n.execute=function(e){e.options.events.publish({event:"show-facet-in-properties",data:{facetName:"social"}})},n})),define("DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationTopbarActions/PanelExpander",["UWA/Core","i18n!DS/DocumentMultiFilePreview/assets/nls/DocumentPreview"],(function(e,t){"use strict";var n=function(e){return{id:"PanelExpander",dataElements:{docV2Private:!0,typeRepresentation:"functionIcon",icon:{iconName:"resize-full",fontIconFamily:1},label:t.get("Maximize"),tooltip:t.get("Maximize"),position:"far",category:"resize",value:function(t){t.options=e,n.execute(t)},visibleFlag:!0,priority:5},updateForSelection:function(n,o){n({icon:{iconName:"left"==e.skeleton._maximizedSide?"resize-small":"resize-full",fontIconFamily:1},label:"left"==e.skeleton._maximizedSide?t.get("Restore"):t.get("Maximize"),tooltip:"left"==e.skeleton._maximizedSide?t.get("Restore"):t.get("Maximize")})},execute:function(){n.execute({options:e})}}};return n.execute=function(e){"left"==e.options.skeleton._maximizedSide?(e.options.skeleton.maximizeSide("left",!1),e.options.events.publish({event:"left-navigationPanel-Expanded",data:!1})):(e.options.skeleton.maximizeSide("left",!0),e.options.events.publish({event:"left-navigationPanel-Expanded",data:!0}))},n})),define("DS/DocumentMultiFilePreview/containers/TopNavBarContent/PreviewCommands",["UWA/Core","UWA/Class","DS/DocumentMultiFilePreview/containers/TopNavBarContent/CustomPreviewActions/Information","DS/DocumentMultiFilePreview/containers/TopNavBarContent/CustomPreviewActions/Comment"],(function(e,t,n,o){"use strict";return t.extend({init:function(e){this.options=e,this.commands={Information:new n(e),Comment:new o(e)}},commands:[],connectToWebUXToolbar:function(e){e.items.getRoots().forEach((e=>{e.options.docV2Preview&&e.options.extend&&e.options.extend(e),e.options.docV2Private&&e.options.extend&&e.options.extend(e)}))},selectionChangedForWebUXToolbar:function(e){e.items.getRoots().forEach((e=>{e.options.docV2Preview&&(e.options.grid.action=e,e.options.updateForSelection&&e.options.updateForSelection((function(t){e.updateOptions(t)}))),e.options.docV2Private&&(e.options.grid.action=e,e.options.updateForSelection&&e.options.updateForSelection((function(t){e.updateOptions(t)})))}))},getWebUXContextMenuItemsForCurrentSelection:function(t,n){var o=this,i=[],l=t[0].dataElements.category;return t.forEach((t=>{t.updateForSelection&&t.updateForSelection((function(n){t.dataElements=e.extend(t.dataElements,n,!0)}))})),t.forEach((e=>{e.dataElements.visibleFlag&&(n&&l!=e.dataElements.category&&i.push({type:"SeparatorItem"}),i.push({rawItem:e,type:"PushItem",title:e.dataElements.label,fonticon:{content:"wux-ui-3ds wux-ui-3ds-"+e.dataElements.icon.iconName},action:{callback:e.dataElements.value||function(e,t,n){console.error("This command doesnt have value")},context:{options:o.options}},recId:e.id,category:e.dataElements.category}),l=e.dataElements.category)})),i},getUIKitItemsForCurrentSelection:function(t,n){var o=[],i=t[0].dataElements.category;return t.forEach((t=>{t.updateForSelection&&t.updateForSelection((function(n){t.dataElements=e.extend(t.dataElements,n,!0)}))})),t.forEach((e=>{e.dataElements.visibleFlag&&(n&&i!=e.dataElements.category&&o.push({className:"divider"}),o.push({rawItem:e,type:"PushItem",title:e.dataElements.label,name:e.id,text:e.dataElements.label,fonticon:e.dataElements.icon.iconName,handler:e.execute||function(e,t,n){console.error("This command doesnt have value")},category:e.dataElements.category}),i=e.dataElements.category)})),o}})})),define("DS/DocumentMultiFilePreview/containers/centerContent/CenterPreviewContainer",["UWA/Core","UWA/Controls/Abstract","DS/CoreEvents/ModelEvents","DS/DocumentMultiFilePreview/containers/centerContent/PreviewProvider","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],(function(e,t,n,o,i,l){"use strict";return t.extend({name:"docm-preview-center-container",options:{className:""},_options:{},modelEvents:void 0,init:function(e){this.parentCtrl=e,e.centerContainerContentControl=this,this.events=e.events||e.options.events||new n,delete e.options.events,this._parent(e.options),e.options.events=this.events,this.notificationManager=i,l.setNotificationManager(this.notificationManager),l.setStackingPolicy(5),this.buildSkeleton()},buildSkeleton:function(){this.elements.container=e.createElement("div",{class:this.getClassNames()}),this.elements.preview=e.createElement("div",{class:this.getClassNames("-preview")}),this.elements.preview.inject(this.elements.container),this.options.skeleton.centerContainerContent.setHTML(this.elements.container),this.previewProvider=new o(this,this.elements.preview)}})})),define("DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationToolbarCommands",["UWA/Core","UWA/Class","DS/DocumentFiles/actions/SearchTextBox","DS/DocumentFiles/actions/SearchToggle","DS/DocumentFiles/actions/SortSwitcher","DS/DocumentFiles/actions/ViewSwitcher","DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationTopbarActions/PanelExpander","DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationTopbarActions/CollapsePanel"],(function(e,t,n,o,i,l,a,s){"use strict";return t.extend({init:function(e){this.commands={SearchTextBox:new n(e),SearchToggle:new o(e),SortSwitcher:new i(e),ViewSwitcher:new l(e),PanelExpander:new a(e),CollapsePanel:new s(e)}},commands:[],connectToWebUXToolbar:function(e){e.items.prepareUpdate(),e.items.getRoots().forEach((e=>{e.options.docV2Private&&e.options.extend&&e.options.extend(e)})),e.items.pushUpdate()},selectionChangedForWebUXToolbar:function(t){t.items.getRoots().forEach((t=>{t.options.docV2Private&&(t.options.grid.action=t,t.options.grid.data&&(t.options.grid.data.argument&&(t.options.grid.data.argument.action=t),t.options.grid.data.value&&!e.is(t.options.grid.data.value,"string")&&(t.options.grid.data.value.action=t)),t.options.updateForSelection&&t.options.updateForSelection((function(e){t.updateOptions(e)})))}))}})})),define("DS/DocumentMultiFilePreview/containers/TopNavBarContent/Toolbar",["UWA/Core","UWA/Class","DS/Tweakers/GeneratedToolbar","DS/DocumentPreview/PreviewCommandsV2","DS/DocumentCommands/DocumentCommandsV2","DS/DocumentCommands/DocumentFileCommandsV2","DS/DocumentMultiFilePreview/containers/TopNavBarContent/CustomPreviewActions/Information","DS/DocumentMultiFilePreview/containers/TopNavBarContent/CustomPreviewActions/Download","DS/DocumentMultiFilePreview/containers/TopNavBarContent/CustomPreviewActions/Comment","DS/DocumentCommands/V2/Actions/Download"],(function(e,t,n,o,i,l,a,s,r,c){"use strict";return t.extend({init:function(t,d){var u=this;let m,p;t.toolbar=this;let v={entries:[]},h={entries:[]},f={entries:[]},D={entries:[]};this.DocCmdOptions=t.toolbar.DocCmdOptions={fetchSecurityContext:function(){return t.options.fetchSecurityContext()},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return t.options.document?[t.options.nodeModel]:[]},getDocumentFromNodeModel:function(e){return t.options.document},getOrigin:function(){return{source:e.is(widget.data.appId)?widget.data.appId:widget&&widget.environment&&widget.environment.data&&widget.environment.data._data&&widget.environment.data._data._x_appId?widget.environment.data._data._x_appId:"DocumentManagement",widgetId:widget.id,component:"MultiFilePreviewtoolbar"}},skeleton:t.parentCtrl.mySkeletonlayout,platformUrls:t.options.platformUrls||u.ctrl.options.platformServices,events:t.options.events,previewedDocumentStatusModel:t.parentCtrl.previewedDocumentStatusModel,container:t.elements.container,ctrl:t.parentCtrl.controller.ctrl,uaSource:"Preview"},this.FileCmdOptions=t.toolbar.FileCmdOptions={fetchSecurityContext:function(){return t.options.fetchSecurityContext()},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){var e=t.parentCtrl.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile();if(e){var n=t.parentCtrl.controller.files.treeDocument.getRoots().find((t=>t.options.data.id===e.id));return n?[n]:[]}return[]},getDocumentFromNodeModel:function(e){return e.options.data},getParentDocument:function(){if(t.parentCtrl.previewedDocumentStatusModel.getPreviewedDocument())return t.parentCtrl.previewedDocumentStatusModel.getPreviewedDocument().id;t.options.document.id},getModifyAccess:function(){if(t.parentCtrl.previewedDocumentStatusModel.getPreviewedDocument())return t.parentCtrl.previewedDocumentStatusModel.getPreviewedDocument().dataelements.hasModifyAccess;t.options.document.dataelements.hasModifyAccess},getOrigin:function(){return{source:e.is(widget.data.appId)?widget.data.appId:widget&&widget.environment&&widget.environment.data&&widget.environment.data._data&&widget.environment.data._data._x_appId?widget.environment.data._data._x_appId:"DocumentManagement",widgetId:widget.id,component:"MultiFilePreviewtoolbar"}},skeleton:t.parentCtrl.mySkeletonlayout,previewedDocumentStatusModel:t.parentCtrl.previewedDocumentStatusModel,platformUrls:t.options.platformUrls||u.ctrl.options.platformServices,events:t.options.events,container:t.elements.container,ctrl:t.parentCtrl.controller.ctrl,uaSource:"Preview"},u.privateDocumentCommands=new o(this.DocCmdOptions),u.privateDocumentCommands.commands.CustomPreviewInformation=new a(this.DocCmdOptions),u.privateDocumentCommands.commands.CustomPreviewComment=new r(this.DocCmdOptions);var w=u.privateDocumentCommands.commands;u.publicDocumentCommands=new i(this.DocCmdOptions);u.publicDocumentCommands.commands;u.fileCommands=new l(this.FileCmdOptions),u.fileCommands.commands.DocumentDownload=new c(this.DocCmdOptions),u.fileCommands.commands.CustomPreviewDownload=new s({...this.FileCmdOptions,DocCmdOptions:this.DocCmdOptions});var g=u.fileCommands.commands;D.entries=[g.OfficeWebEdition,g.Edit,g.LockAndDownload,g.Lock,g.UndoEdit,g.Unlock,g.Update,g.UpdateAndUnlock,g.CopyLink,g.DocumentDownload,g.CustomPreviewDownload],D.entries.forEach((function(e){e.dataElements.category="fileCommands"})),t.options.events.publish({event:"preview-toolbar-items-prepared",data:{documentCommandsModel:f}}),f.entries.push(w.CustomPreviewComment),f.entries.push(w.CustomPreviewInformation),f.entries.forEach((function(e){e.dataElements.category="DocCommands",e.dataElements.docV2Public=!0})),h.entries=[...D.entries,...f.entries];var C=["OfficeWebEdition","Edit","LockAndDownload","Lock","UndoEdit","Unlock","Update","UpdateAndUnlock","Favorite"];"ReadMode"==t.options.mode&&(h.entries=h.entries.filter((e=>!C.includes(e.id)))),v.entries=[w.Previous,w.Next,w.Close],m=u.DynamicToolbarTreeDocument=n.prototype.createTreeDocument(h);let S=u.DynamicToolbar=new n({items:m,direction:"horizontal",overflowManagement:"dropdown"});S.elements.container.setStyles({"max-width":"250px"}),u.privateDocumentCommands.connectToWebUXToolbar(S),S.inject(d),e.createElement("div",{class:"toolbarSeperator"}).inject(d),p=u.FixedToolbarTreeDocument=n.prototype.createTreeDocument(v);let P=u.FixedToolbar=new n({items:p});u.privateDocumentCommands.connectToWebUXToolbar(P),P.inject(d),this.selectionChanged()},selectionChanged:function(){var e=this;e.fileCommands.selectionChangedForWebUXToolbar(e.DynamicToolbar),e.privateDocumentCommands.selectionChangedForWebUXToolbar(e.FixedToolbar)},enterOverflowMode:function(){this.DynamicToolbar.elements.container.addClassName("overFlowMode")},exitOverflowMode:function(){this.DynamicToolbar.elements.container.removeClassName("overFlowMode")}})})),define("DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationToolbar",["UWA/Core","UWA/Class","DS/Tweakers/GeneratedToolbar","DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationToolbarCommands","DS/Utilities/Utils"],(function(e,t,n,o,i){"use strict";return t.extend({init:function(e){var t=this;t.ctrl=e,e.toolbar=this,t.selectionChanged=i.debounce((function(){t.navigationToolbarCommands.selectionChangedForWebUXToolbar(t.GeneratedToolbar)}),10),t.ctrl.events.subscribe({event:"selection-add"},(function(){t.selectionChanged()})),t.ctrl.events.subscribe({event:"selection-remove"},(function(){t.selectionChanged()}))},build:function(t){var i=this;let l,a={entries:[]};var s={fetchSecurityContext:function(){return i.ctrl.options.fetchSecurityContext()||widget.getValue("credentials")},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return i.ctrl.controller.files.treeDocument.getSelectedNodes()},getParentDocument:function(){return i.previewedDocumentStatusModel.getPreviewedDocument()||i.options.document},getModifyAccess:function(){return i.ctrl.options.previewedDocumentStatusModel.getPreviewedDocument()?i.ctrl.options.previewedDocumentStatusModel.getPreviewedDocument().dataelements.hasModifyAccess:i.ctrl.options.document.dataelements.hasModifyAccess},getDocumentFromNodeModel:function(e){return e.options.data},getOrigin:function(){return{source:e.is(widget.data.appId)?widget.data.appId:widget&&widget.environment&&widget.environment.data&&widget.environment.data._data&&widget.environment.data._data._x_appId?widget.environment.data._data._x_appId:"DocumentManagement",widgetId:widget.id,component:"toolbar"}},skeleton:i.ctrl.options.skeleton,platformUrls:i.ctrl.options.platformUrls||i.ctrl.options.platformServices,events:i.ctrl.options.events,ctrl:i.ctrl.controller.ctrl,uaSource:"Preview"};i.navigationToolbarCommands=new o(s);var r=i.navigationToolbarCommands.commands;a.entries=[r.SearchTextBox,r.SearchToggle,r.SortSwitcher,r.ViewSwitcher,r.PanelExpander,r.CollapsePanel],l=i.ToolbarTreeDocument=n.prototype.createTreeDocument(a);let c=i.GeneratedToolbar=new n({items:l,direction:"horizontal",overflowManagement:"dropdown",executionContext:{}});return i.navigationToolbarCommands.connectToWebUXToolbar(c),c.inject(t),i.selectionChanged(),c},selectionChanged:void 0})})),define("DS/DocumentMultiFilePreview/containers/TopNavBarContent/TopNavBarContainer",["UWA/Core","UWA/Controls/Abstract","DS/CoreEvents/ModelEvents","DS/DocumentMultiFilePreview/containers/TopNavBarContent/Toolbar","DS/Controls/TooltipModel","css!DS/DocumentMultiFilePreview/css/TopNavBarContainer.css"],(function(e,t,n,o,i,l){"use strict";return t.extend({name:"docm-preview-topnavbar-container",options:{className:""},init:function(e){this.parentCtrl=e,this.events=e.options.events||new n,delete e.options.events,this._parent(e.options),e.topbarControl=this,this.options.events=this.events,e.options.events=this.events,this.build()},build:function(){var t=this;this.elements.container=e.createElement("div",{class:this.getClassNames()}),this.imgDiv=e.createElement("div",{class:"topbar-image-container"}).inject(this.elements.container),this.img=e.createElement("div",{class:"topbar-image"}).inject(this.imgDiv),this.docTitle=e.createElement("div",{class:"topbar-title-container-documentTitle"}).inject(this.elements.container),new o(t,t.elements.container),this.syncTitleData(t.options.previewedDocumentStatusModel.getPreviewedDocument(),t.options.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile()),this.connectPreviewedStatusModel()},connectPreviewedStatusModel:function(){var e=this;this.options.previewedDocumentStatusModel.addEvent("onChange",(function(t,n){e.syncTitleData(t.getPreviewedDocument(),t.getPreviewedDocumentSelectedFile()),e.toolbar&&e.toolbar.selectionChanged()}))},updateDocumentName:function(e){var t="";t=""==this.docTitle.fileName?e:e+" | "+this.docTitle.fileName,this.docTitle.setText(t),this.docTitle.fullTitle=t,this.docTitle.docName=e,this.docTitle.tooltipInfos=new i({shortHelp:t,mouseRelativePosition:!0})},updateTitle:function(e,t){var n="";n=""==t?e:e+" | "+t,this.docTitle.setText(n),this.docTitle.fullTitle=n,this.docTitle.docName=e,this.docTitle.fileName=t,this.docTitle.tooltipInfos=new i({shortHelp:n,mouseRelativePosition:!0})},getTitleValues:function(){return titleObject={documentTitle:this.docTitle.title,fileTitle:this.fileTitle.title}},extractTitleFromDocument:function(e){return e?e.title||e.name||e.dataelements.title||e.dataelements.name:""},extractFileName:function(e){return e?e.dataelements.title||e.dataelements.name:""},syncTitleData:function(e,t){var n=this,o=(e=n.options.previewedDocumentStatusModel.getPreviewedDocument(),this.extractTitleFromDocument(e)),i=this.extractFileName(n.options.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile());this.updateTitle(o,i),e&&(n.img.style.backgroundImage="url("+(e.typeicon||e.dataelements.indexedTypeicon||e.dataelements.typeicon)+")")},resize:function(e){e.newSkeletonDimensions.width<640?this.toolbar.enterOverflowMode():this.toolbar.exitOverflowMode()}})})),define("DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationTopbar",["UWA/Core","UWA/Controls/Abstract","DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationToolbar"],(function(e,t,n){"use strict";return t.extend({name:"enox-preview-left-container",options:{className:""},_options:{},init:function(e){e.navigationTopbar=this,this.ctrl=e,this.events=e.events,this._parent({})},build:function(t){var o=this;o.elements.container=e.createElement("div",{class:this.getClassNames("-topbar")}),o.ctrl.elements&&(o.ctrl.elements.toolbarcontainer=o.elements.container),o.elements.toolbar=new n(o.ctrl),o.elements.toolbar.build(o.elements.container),o.elements.container.inject(t)},updateToolbar:function(){this.elements.toolbar.selectionChanged()}})})),define("DS/DocumentMultiFilePreview/containers/leftSideContent/LeftNavigationContainer",["UWA/Core","UWA/Controls/Abstract","UWA/Promise","DS/CoreEvents/ModelEvents","DS/DocumentFiles/data/Controller","DS/DocumentFiles/views/Topbar","DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationTopbar","DS/DocumentFiles/views/UploadPane","DS/DocumentFiles/views/GridPane","DS/DocumentFiles/views/TilePane","DS/DocumentFiles/ContextMenu","DS/DocumentMultiFilePreview/eventHandlers/FilesEvents","DS/DocumentFiles/utils/DnDManager","DS/Controls/Loader","DS/Controls/ModalContainer","css!DS/DocumentMultiFilePreview/css/LeftNavigationContainer.css"],(function(e,t,n,o,i,l,a,s,r,c,d,u,m,p,v,h){"use strict";return t.extend({name:"docm-preview-left-container",options:{className:""},_options:{},modelEvents:void 0,init:function(e){e.leftContainerContentControl=this,this.parentCtrl=e,this.inputFiles=e.options.files,this.events=e.events||e.options.events||new o,delete e.options.events,this._parent(e.options),e.options.events=this.events,this.options.events=this.events,this.options.restrictDND=!0,this.controller=this.options.controller=e.controller,this.buildSkeleton()},buildSkeleton:function(){var t=this;this.elements.container=e.createElement("div",{class:this.getClassNames()}),this.elements.content=e.createElement("div",{class:this.getClassNames("-content")}),this.elements.content.inject(this.elements.container),this.loader=new p,this.startLoading(),this.options.customization=this.makefilePaneOptions().customization,this.e6wDocument=this.options.document,this.controller.ready.promise.then((function(){new a(t).build(t.elements.content),t.buildContentPanes(),t.controller.ctrl.tilePane=t.tilePane,t.controller.ctrl.gridPane=t.gridPane,t.controller.ctrl.uploadPane=t.uploadPane,t.controller.ctrl.dndManager=t.dndManager,t.controller.ctrl.tilesRCV=t.tilesRCV,t.tilePane.rcv.rowSelection="single",t.tilePane.rcv.selectionBehavior.canMultiSelect=!1,t.tilePane.rcv.selectionBehavior.canInteractiveMultiselectWithCheckboxClick=!1,t.tilePane.rcv.selectionBehavior.enableShiftSelection=!1,t.gridPane.datagridview.rowSelection="single",t.contextMenu=new d(t),new u(t).connect(t.controller,t.toolbar,t.contextMenu),t.connectPreviewedDocumentModel(),t.options.skeleton.leftContainerContent=t.elements.container,t.parentCtrl._syncSelectionInLeftPanel()}))},buildContentPanes:function(){this.elements.panes=e.createElement("div",{class:this.getClassNames("-panes")}),this.elements.panes.inject(this.elements.content),new s(this).build(this.elements.panes),new r(this).build(this.elements.panes),new c(this).build(this.elements.panes)},connectPreviewedDocumentModel:function(){var e=this;e.setDefaultParentIdAndFiles(this.options.previewedDocumentStatusModel.get("previewedDocument")),this.options.previewedDocumentStatusModel.addEvent("onChange:previewedDocument",(function(t,n){console.log(t),console.log(n),e.setDefaultParentIdAndFiles(n),e.parentCtrl._syncSelectionInLeftPanel()}))},initialize:function(){var e=[];if(this.inputFiles)for(let t=0;t<this.inputFiles.length;t++)e.push(this.inputFiles[t]);this.controller.showPreselectedFiles(e)},setDefaultParentIdAndFiles:function(e){this.parentId=e.id,this.controller.switchView(this.controller.view),this.finishLoading()},setParentId:function(e){this.parentId=e,this.finishLoading(),this.startLoading(),this.controller.clearAll(),this.controller.loadFiles(),this.events.publish({event:"enox-files-parent-changed"})},getParentId:function(){return this.parentId},startLoading:function(){this.loader.on(),v.createModal(this.elements.container,this.loader.elements.container)},finishLoading:function(){this.loader.off(),v.removeModal(this.elements.container)},makefilePaneOptions:function(e){return{customization:{selectionChangedForWebUXToolbar:function(e,t){console.log("selectionChangedForWebUXToolbar",e,t)},postToolbarItemsPreparation:function(e,t,n){console.warn("variables printed below would have been modified by the time you expand them. Better to put a breakpoint and print and then expand immediately"),console.log("postToolbarItemsPreparation",e,t,n),console.log(e);var o=["Preview","SearchTextBox","SearchToggle","FileIterations","UploadFile","Delete","SortSwitcher","ViewSwitcher"];n&&"ReadMode"==n.mode&&(o=[...o,"OfficeWebEdition","Edit","LockAndDownload","Lock","UndoEdit","Unlock","Update","UpdateAndUnlock"]);for(var i=e.length-1;i>=0;i--)o.includes(e[i].id)&&e.splice(i,1);console.log(e)},connectToWebUXToolbar:function(e,t,n){console.log("connectToWebUXToolbar",e,t,n)},postContextMenuItemsPreparation:function(e,t,n){console.warn("variables printed below would have been modified by the time you expand them. Better to put a breakpoint and print and then expand immediately"),console.log("postContextMenuItemsPreparation",e,t,n);var o=["Preview","SearchTextBox","SearchToggle","FileIterations","UploadFile","Delete","SortSwitcher","ViewSwitcher"];n&&"ReadMode"==n.mode&&(o=[...o,"OfficeWebEdition","Edit","LockAndDownload","Lock","UndoEdit","Unlock","Update","UpdateAndUnlock"]);for(var i=e.length-1;i>=0;i--)o.includes(e[i].id)&&e.splice(i,1);console.log(e)},preDataGridColumnBinding:function(e,t){console.log("preDataGridColumnBinding",e,t)}}}}})})),define("DS/DocumentMultiFilePreview/MultiFilePreviewComponent",["UWA/Core","UWA/Controls/Abstract","DS/CoreEvents/ModelEvents","DS/Skeleton/SkeletonLayout","DS/Skeleton/SkeletonUtils","DS/DocumentMultiFilePreview/containers/leftSideContent/LeftNavigationContainer","DS/DocumentMultiFilePreview/containers/centerContent/CenterPreviewContainer","DS/DocumentMultiFilePreview/containers/rightSideContent/RightInformationPanelContainer","DS/DocumentMultiFilePreview/containers/TopNavBarContent/TopNavBarContainer","DS/DocumentFiles/data/Controller","DS/DocumentMultiFilePreview/models/PreviewedDocumentStatusModel","DS/DocumentMultiFilePreview/eventHandlers/PreviewedDocumentModelEvents","DS/DocumentMultiFilePreview/MultiFilePreviewEvents","DS/DocumentMultiFilePreview/Data","DS/Controls/Loader","DS/Controls/ModalContainer","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","css!DS/DocumentMultiFilePreview/css/MultiFilePreviewComponent.css"],(function(e,t,n,o,i,l,a,s,r,c,d,u,m,p,v,h,f,D,w){"use strict";return t.extend({name:"multifile-preview",options:{className:""},init:function(e){var t=this;this._parent(e),this.events=e.modelEvents||new n,this.options.events=e.modelEvents||new n,this.options._DocumentManagmentPreview=!0,this.options.context={securityContext:t.options.securityContext?t.options.securityContext:void 0,getSecurityContext:function(){return this.securityContext}},this.options.fetchSecurityContext=function(){if(t.options.context&&t.options.context.getSecurityContext())return t.options.context.getSecurityContext()},this.options.tenant&&"onpremise"!=this.options.tenant.toLowerCase()&&(this.options.isOnCloud=!0),this.options.platformUrls.platformId||(this.options.platformUrls.platformId=this.options.tenant),0!=this.options.toolBarVisibility&&(this.options.toolBarVisibility=!0),this.data=new p(this),this.loader=new v,this.notificationManager=f,D.setNotificationManager(this.notificationManager),D.setStackingPolicy(5),this.mySkeletonlayout=void 0,this.leftPanelLoaded=!0,this.buildSkeleton()},buildSkeleton:function(){var t=this;this.elements.container=e.createElement("div",{class:this.getClassNames()}),this.elements.container.dsModel=this,this.elements.content=e.createElement("div",{class:this.getClassNames("-content")}).inject(this.elements.container),this.previewedDocumentStatusModel=this.options.previewedDocumentStatusModel=new d,this.previewedDocumentModelEvents=this.options.previewedDocumentModelEvents=new u(this),this.multifilePreviewEvents=this.options.multifilePreviewEvents=new m(this),this.options.filePanelHelperOptions={localStorageName:"ENOXMultiFilePreviewUXViewMode",prefix:"MultiFilePreview_"},t.startLoading(),new c(t);var n=!0;"string"==e.typeOf(t.options.document)&&(n=t.data.getDocument(t.options.document).then((e=>{if(!Array.isArray(e)&&0!=e.length)throw new Error("Failed to fetch the document details.");t.options.document=e[0]})).catch((e=>{console.error(e)}))),this.controller.ready.promise.then((()=>n)).then((async function(){if(t.finishLoading(),t.navBar=new r(t),t.navBar.inject(t.elements.content),t.options.toolBarVisibility||t.navBar.hide(),t.mySkeletonlayout=new o({leftContainerContent:new e.Element("div",{html:"Loading...",id:"Enox-Preview-LeftContent",class:"Enox-Preview-LeftContent",title:"Left Side Title"}),centerContainerContent:new e.Element("div",{html:"Center Space",id:"Enox-Preview-CenterContent",class:"Enox-Preview-CenterContent"}),statusContainerContent:null,idCardContainerContent:null,leftContainerCollapsedFlag:!0,rightContainerCollapsedFlag:!0,leftContainerWidth:320,leftContainerMinWidth:320,leftContainerMaxWidth:480,rightContainerWidth:320,rightContainerMinWidth:320,rightContainerMaxWidth:480,navigationContainerVisibleFlag:!1,idCardContainerVisibleFlag:!1,statusContainerVisibleFlag:!1,identifier:"EnoxDocumentPreviewSkeletonLayout"}),t.mySkeletonlayout.rightContainerCollapsedFlag=!0,t.mySkeletonlayout.rightContainerContent=i.createSideContentWithTitleBar({skeleton:t.mySkeletonlayout,title:"Loading",close:!0,maximize:!0,content:new e.Element("div",{html:".",id:"Enox-Preview-RightContent",class:"Enox-Preview-RightContent"}),commands:[]}),t.leftContainerTemplate=new e.Element("div",{html:"Loading...",id:"LeftContent",class:"Enox-Preview-LeftContent",title:"Left Side Title"}),t.mySkeletonlayout.leftContainerContent=t.leftContainerTemplate,t.skeleton=t.options.skeleton=t.mySkeletonlayout,await t.updateDocument(t.options.document,t.options.selectedFileId),t.options.document.relateddata.files&&t.options.document.relateddata.files.length<2)t.destroyLeftNavigationPanel();else{t.mySkeletonlayout.leftContainerCollapsedFlag=!1,t.mySkeletonlayout.leftContainerMinWidth=320,t.mySkeletonlayout.leftContainerWidth=320;new l(t);t.leftPanelLoaded=!0}new a(t),new s(t);t.mySkeletonlayout.inject(t.elements.content),t.events.publish({event:"onPreviewLoaded"}),t.elements.container.addEvent("resize",t.resize.bind(t)),t.mySkeletonlayout.addEventListener("leftContainerCollapse",(function(e){t._syncSelectionInLeftPanel()})),t.mySkeletonlayout.addEventListener("rightContainerCollapse",(function(e){t.events.publish({event:"close-document-properties"}),t.events.publish({event:"Docm-MultiFilePreview-rightContainer",data:{action:"Collapsed"}})})),t.mySkeletonlayout.addEventListener("rightContainerExpand",(function(e){t.events.publish({event:"Docm-MultiFilePreview-rightContainer",data:{action:"Expanded"}})})),t.mySkeletonlayout.addEventListener("skeletonResized",(function(e){t.topbarControl&&t.topbarControl.resize(e.options)}))}))},getSkeletonBuild:function(){return this.mySkeletonlayout},updateDocument:async function(t,n){var o=this;o.startLoading();var i=new Promise(((n,i)=>{"string"==e.typeOf(t)?o.data.getDocument(t).then((e=>{if(!Array.isArray(e)&&0!=e.length)throw new Error("Failed to fetch the document details.");o.options.document=t=e[0],n(!0)})).catch((e=>{console.error(e)})):n(!0)}));if(await i,o.finishLoading(),n||o.selectedNodeCache&&o.selectedNodeCache.options&&(n=o.selectedNodeCache.options.data.id),this.selectedNodeCacheModifiedToken=void 0,this.selectedNodeCache=void 0,t=o.applySorting(e.clone(t,"true")),o.updateChildOptions(),t){if(t.relateddata.files){o.leftContainerContentControl&&o.leftContainerContentControl.startLoading();var l=t.relateddata.files;o.controller.clearAll(),o.controller.files.addFiles(l,"left panel"),o.leftContainerContentControl&&o.leftContainerContentControl.finishLoading(),o.previewedDocumentStatusModel.changePreviewedDocumentFilesArray(t.relateddata.files)}if(t.relateddata.files&&t.relateddata.files.length>0){var a=t.relateddata.files;if(n){var s;(s=a.filter((e=>e.id==n))).length>0?o.previewedDocumentStatusModel.changePreviewedDocumentSelectedFile(s[0]):o.previewedDocumentStatusModel.changePreviewedDocumentSelectedFile(a[0])}else o.previewedDocumentStatusModel.changePreviewedDocumentSelectedFile(a[0])}else o.previewedDocumentStatusModel.changePreviewedDocumentSelectedFile(void 0);o.previewedDocumentStatusModel.changePreviewedDocument(t),this._syncSelectionInLeftPanel()}},applySorting:function(e){return e&&e.relateddata&&e.relateddata.files&&(e.relateddata.files=e.relateddata.files.sort(((e,t)=>new Date(t.dataelements.modified)-new Date(e.dataelements.modified)))),e},updateChildOptions:function(){var e=this;e.centerContainerContentControl&&e.centerContainerContentControl.setOptions({document:e.options.document,platformUrls:e.options.platformUrls,modelEvents:e.options.events,tenant:e.options.platformUrls.platformId,securityContext:e.options.fetchSecurityContext(),nodeModel:e.options.nodeModel,enableFavoriteToggle:e.options.enableFavoriteToggle,readOnly:e.options.readOnly}),e.leftContainerContentControl&&e.leftContainerContentControl.setOptions({document:e.options.document,platformUrls:e.options.platformUrls,modelEvents:e.options.events,tenant:e.options.platformUrls.platformId,securityContext:e.options.fetchSecurityContext(),nodeModel:e.options.nodeModel,enableFavoriteToggle:e.options.enableFavoriteToggle,readOnly:e.options.readOnly}),e.navBar&&e.navBar.setOptions({document:e.options.document,platformUrls:e.options.platformUrls,modelEvents:e.options.events,tenant:e.options.platformUrls.platformId,securityContext:e.options.fetchSecurityContext(),nodeModel:e.options.nodeModel,enableFavoriteToggle:e.options.enableFavoriteToggle,readOnly:e.options.readOnly}),e.rightContainerContentControl&&e.rightContainerContentControl.setOptions({document:e.options.document,platformUrls:e.options.platformUrls,modelEvents:e.options.events,tenant:e.options.platformUrls.platformId,securityContext:e.options.fetchSecurityContext(),nodeModel:e.options.nodeModel,enableFavoriteToggle:e.options.enableFavoriteToggle,readOnly:e.options.readOnly})},destroyLeftNavigationPanel:function(){var e=this;e.leftPanelLoaded=!1,e.mySkeletonlayout.leftContainerCollapsedFlag=!0,e.mySkeletonlayout.leftContainerContent=null,e.mySkeletonlayout.leftContainerMinWidth=0,e.mySkeletonlayout.leftContainerWidth=0},reCreateLeftNavigationPanel:function(){var e=this;e.mySkeletonlayout.leftContainerContent=e.leftContainerTemplate,e.mySkeletonlayout.leftContainerCollapsedFlag=!1,e.mySkeletonlayout.leftContainerMinWidth=320,e.mySkeletonlayout.leftContainerWidth=320;new l(e);e.leftPanelLoaded=!0},_syncSelectionInLeftPanel:function(){this.selectedNodeCacheModifiedToken==this.previewedDocumentStatusModel.getSelectedFileModifiedToken()?this.selectedNodeCache&&(this.controller.files.treeDocument.getXSO().empty(),this.controller.files.treeDocument.getXSO().add(this.selectedNodeCache)):0==this.controller.files.treeDocument.getXSO().get().length&&this.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile()&&(this.selectedNodeCache=this.controller.files.treeDocument.getRoots().find((e=>e.options.data.id===this.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile().id)),this.selectedNodeCache&&(this.controller.files.treeDocument.getXSO().add(this.selectedNodeCache),this.selectedNodeCacheModifiedToken=this.previewedDocumentStatusModel.getSelectedFileModifiedToken()))},_updateSelectedNodeCache:function(e){this.selectedNodeCache=e,this.selectedNodeCacheModifiedToken=this.previewedDocumentStatusModel.getSelectedFileModifiedToken()},startLoading:function(){this.isLoadingInProgress=!0,this.loader.on(),h.createModal(this.elements.container,this.loader.elements.container)},finishLoading:function(){this.isLoadingInProgress=!1,this.loader.off(),h.removeModal(this.elements.container)},resize:function(e){}})})),define("DS/DocumentMultiFilePreview/3DPlayWrapper/3DPlayMultiFileDocumentExperience",["UWA/Core","DS/3DPlay/3DPlay","DS/3DPlayExperienceModule/3DPlayExperience","DS/ApplicationFrame/FrameWindow3D","DS/DocumentMultiFilePreview/MultiFilePreviewComponent","DS/CoreEvents/ModelEvents","i18n!DS/DocumentMultiFilePreview/assets/nls/DocumentPreview"],(function(e,t,n,o,i,l,a){return n.extend({init:function(e){var t=this;widget&&(widget.previewExperience=this),e.FrameWindow=o,this._parent(e),this.documentModelEvents=new l,t.originalAssetObj=e.input.asset.originalAsset,t.progress.visible(!0),this.multiFilePreviewComponent=new i({document:t.originalAssetObj.physicalid,platformUrls:{"3DSpace":t.originalAssetObj.serverurl},modelEvents:this.documentModelEvents,tenant:t.originalAssetObj.tenant,securityContext:t.originalAssetObj.contextid||t.originalAssetObj.contextId,documentManagedByPreview:!0,hideNextPrev:!0,enableFavoriteToggle:!1,toolBarVisibility:!1,mode:"ReadMode",uaSource:"3DPlay"}),this.multiFilePreviewComponent.elements.container.setStyles({background:"white",width:"100%",height:"100%"}),this.multiFilePreviewComponent.close=function(){t.multiFilePreviewComponent.destroy(),t.multiFilePreviewComponent=void 0},this.multiFilePreviewComponent.inject(e.container)},isOnCloud:function(){return!(!this.originalAssetObj.tenant||"onpremise"==this.originalAssetObj.tenant.toLowerCase())},loadAsset:function(e,t){var n=this;this.updateRequired&&(n.progress.visible(!0),n.originalAssetObj=e.asset.originalAsset,n.multiFilePreviewComponent.setOptions({document:n.originalAssetObj.physicalid,platformUrls:{"3DSpace":n.originalAssetObj.serverurl},modelEvents:n.documentModelEvents,tenant:n.originalAssetObj.tenant,securityContext:n.originalAssetObj.contextid||n.originalAssetObj.contextId}),n.multiFilePreviewComponent.updateDocument(n.originalAssetObj.physicalid,void 0)),this.frmWindow.getTree().hide(),this.frmWindow.getActionBar().hide(),this.updateRequired=!0,this.toggleSplash(!1)},onPreCreate:function(e,t,n){this.createToolBarActions()},onPostCreate:function(e,t,n){this.addPreviewEvents(),this.refreshPreviewTitle()},dispose:function(){this.EventDisposer.dispose(),this.EventDisposer=null,this.disposeFunctions=null,t.removeCallbacks(this.args.ctx),void 0!==this.frmWindow&&null!==this.frmWindow&&(void 0!==this.frmWindow.dispose&&null!==this.frmWindow.dispose&&this.frmWindow.dispose(),this.frmWindow=null),void 0!==this.PanelManager&&null!==this.PanelManager&&void 0!==this.PanelManager.dispose&&null!==this.PanelManager.dispose&&this.PanelManager.dispose(),this.multiFilePreviewComponent.close(),this.triptych&&this.triptych.getContent().destroy(),this.UIManager.dispose(),this.UIManager=null},addPreviewEvents:function(){var e=this;this.multiFilePreviewComponent.previewedDocumentStatusModel.addEvent("onChange",(function(t,n){e.refreshPreviewTitle(t)})),this.documentModelEvents.addEventListener("enox-file-node-selection-changed",(t=>{e._3dplayhelperaccess=void 0,e.refreshPreviewTitle(void 0),e.progress.hide()})),this.documentModelEvents.addEventListener("ENO-DOCM-MultiFilePreview-Loaded",(t=>{e._3dplayhelperaccess=t._3dplayhelperaccess,e.refreshPreviewTitle(void 0),e.progress.hide(),e.hideDefaultInformation()})),this.documentModelEvents.addEventListener("Docm-MultiFilePreview-rightContainer",(t=>{e.lightBoxInformationCommandAccess&&e.lightbox&&("Collapsed"==t.action&&(e.lightBoxInformationCommandAccess.selected=!1),"Expanded"==t.action&&(e.lightBoxInformationCommandAccess.selected=!0),e.lightbox.update())}))},hideDefaultInformation:function(){var e=this;if(e._3dplayhelperaccess&&e._3dplayhelperaccess.frmWindow&&e._3dplayhelperaccess.frmWindow.getActionBar){var t=e._3dplayhelperaccess.frmWindow.getActionBar();t&&t.onActionBarOpen((function(){if(t._afr||t._afr.getCurrentSection){var e=t._afr.getCurrentSection();(e||Array.isArray(e._items))&&e._items.forEach((e=>{e.options&&"RightSidePanel"==e.options.Name&&e.hide()}))}}))}},refreshPreviewTitle:function(e){var t=this;e||(e=this.multiFilePreviewComponent.previewedDocumentStatusModel);var n=e.getPreviewedDocument(),o=e.getPreviewedDocumentSelectedFile(),i="",l="";n&&(i=n.title||n.name||n.dataelements.title||n.dataelements.name),o&&(l=o.dataelements.title||o.dataelements.name),t.lightbox&&t.lightbox._lightbox&&(t.lightbox._lightbox.title=i+" | "+l)},createToolBarActions:function(){var e=this;this.onLightboxReady=()=>{this.lightbox.useDefaultActions(!1),e.isOnCloud()&&this.lightbox.addAction({name:a.get("COMMENTS"),text:a.get("COMMENTS"),fonticon:"comment",handler:t=>{e.documentModelEvents.publish({event:"show-facet-in-properties",data:{facetName:"social"}})}}),this.lightbox.addAction({name:a.get("COPY_LINK"),text:a.get("COPY_LINK"),fonticon:"link",handler:t=>{e.documentModelEvents.publish({event:"3DPlay-DocumentManagement-Execute-Action",data:{command:"copylink"}})}}),this.lightbox.addAction({name:a.get("SHARE"),text:a.get("SHARE"),fonticon:"share-alt",handler:t=>{e.documentModelEvents.publish({event:"3DPlay-DocumentManagement-Execute-3DPlayHelper-Action",data:{command:"PublishTo3DSwym"}})}}),this.lightbox.addAction({name:a.get("DOWNLOAD"),text:a.get("DOWNLOAD"),fonticon:"download",items:[{text:a.get("DOWNLOAD_FILE"),name:a.get("DOWNLOAD_FILE"),fonticon:"download",handler:t=>{e.documentModelEvents.publish({event:"3DPlay-DocumentManagement-Execute-Action",data:{command:"download-file"}})}},{text:a.get("DOWNLOAD_DOCUMENT"),name:a.get("DOWNLOAD_DOCUMENT"),fonticon:"download",handler:t=>{e.documentModelEvents.publish({event:"3DPlay-DocumentManagement-Execute-Action",data:{command:"download-document"}})}}]}),this.lightbox.addAction({name:a.get("INFORMATION"),text:a.get("INFORMATION"),fonticon:"info",handler:t=>{e.lightBoxInformationCommandAccess=t,e.documentModelEvents.publish({event:"3DPlay-DocumentManagement-Execute-Action",data:{command:"information",action:"Open"}})}}),this.lightbox.addAction({name:a.get("MORE"),text:a.get("MORE"),fonticon:"chevron-down",items:[{text:a.get("SAVE_SCREENSHOT"),name:a.get("SAVE_SCREENSHOT"),fonticon:"picture-export",handler:t=>{e.documentModelEvents.publish({event:"3DPlay-DocumentManagement-Execute-3DPlayHelper-Action",data:{command:"SaveScreenShot"}})}},{text:a.get("PRINT_SCREENSHOT"),name:a.get("PRINT_SCREENSHOT"),fonticon:"print",handler:t=>{e.documentModelEvents.publish({event:"3DPlay-DocumentManagement-Execute-3DPlayHelper-Action",data:{command:"PrintScreenShot"}})}}]}),e.refreshPreviewTitle(void 0)}}})}));