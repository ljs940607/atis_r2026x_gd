define("DS/AfrHomePageV3/AfrHomePage",["DS/Controls/Button","i18n!DS/AfrHomePageV3/assets/nls/afr-home-page","DS/AfrCollectionExplorerView/AfrCollectionExplorer","css!DS/Core/wux.css","css!DS/AfrHomePageV3/afr-home-page-v3.css","css!DS/Core/wux-3ds-fonticons.css"],(function(e,t,i){"use strict";function s(e,t,...i){let s=null;s="function"==typeof e?new e:document.createElement(e);for(const e in t){const i=t[e];if("function"==typeof i){const t=e.replace(/-([a-z])/g,(e=>e[1].toUpperCase()));s[t]=i}else s.setAttribute(e,i)}return i.forEach((e=>{null!==e&&null!=e&&("string"==typeof e?s.appendChild(document.createTextNode(e)):s.appendChild(e))})),s}function r(e,t){if(!(e&&e.title&&e.id&&e.icon))throw new Error("Missing parameter(s)");const i=s("button",{class:"afr-home-page-guidance-button"},s("i",{class:`wux-ui-3ds-${e.icon} wux-ui-3ds`}),e.title),r=e.controller.onAction.bind(e.controller,t),a="click";return i.addEventListener(a,r),[i,a,r]}function a(e,t){if(!(e&&e.title&&e.icon&&e.id))throw new Error("Missing parameter(s)");let i=s("button",{class:"afr-home-page-navigation-button"},s("i",{class:`wux-ui-3ds-${e.icon?e.icon:"collection"} wux-ui-3ds`}),s("span",{class:"afr-home-page-navigation-button-label"},e.title)),r=()=>t._selectCollection(e.id),a="click";return i.addEventListener(a,r),[i,a,r]}function o(t,i){let s={label:t.title,showLabelFlag:!0,emphasize:t.emphasize?t.emphasize:"secondary",icon:{iconName:t.icon,fontIconFamily:WUXManagedFontIcons.Font3DS},touchMode:!0},r=new e(s),a=t.controller.onAction.bind(t.controller,i),o="buttonclick";return r.addEventListener(o,a),[r.getContent(),o,a]}function n(e){return[s("li",null,s("a",{href:e.url,target:"_blank"},s("i",{class:`wux-ui-3ds-${e.icon} wux-ui-3ds`}),e.title))]}const l={CATIA:"blue",GEOVIA:"blue",SIMULIA:"blue",DELMIA:"yellow",SOLIDWORKS:"red",BIOVIA:"green",MEDIDATA:"green",ENOVIA:"orange",NETVIBES:"orange","3DEXCITE":"black","3DVIA":"black","CENTRIC PLM":"black",GENERIC:"default",TST_BRAND:"pink"};function c(e){let t=l.GENERIC,i=e.toUpperCase();return Object.hasOwn(l,i)&&(t=l[i]),t}function h(e){if(e&&e.size>0&&e){for(let[t,i]of e)i.event&&i.view.removeEventListener(i.event,i.callback),i.view.parentNode&&i.view.parentNode.removeChild(i.view),i.controller&&i.controller.destroy(),i.view.dsModel&&i.view.dsModel.destroy(),i.view=null,i.callback=null,i.event=null;e.clear()}}Object.freeze(l);class d{constructor(e){if(this._private=Object.create(null),e.touchStrategy)throw new Error("DEPRECATED USE");this._private.selectedCollection=null,this._private.selectionInProgress=null,this._private.selectionLock=Promise.resolve(),this._buildView(e),this._setDragAndDropController(e.dragAndDropController)}getDOM(){let e=null;return this._private.views&&this._private.views.container&&(e=this._private.views.container),e}show(){this.getDOM().classList.remove("afr-home-page-hidden")}hide(){this.getDOM().classList.add("afr-home-page-hidden")}isVisible(){return!this.getDOM().classList.contains("afr-home-page-hidden")}_setApplicationIcon(e){const t=this._private.views.applicationIcon;t.style.backgroundImage=e?`url(${e})`:""}_setGuidance(e){if(e&&e.items)return this._setViewMap("guidance",e.items,r,this)}setCollections(e){if(e&&e.items){if(!Array.isArray(e.items))throw new Error("parameter should be an array",e);this._private.collectionExplorer=new i(e),this._setViewMap("collections",this._private.collectionExplorer.getItems(),a,this)}this._private.collectionExplorer&&this._private.collectionExplorer.getItems().length>0&&this._selectCollection(this._private.collectionExplorer.getItems()[0].id)}hasCollection(e){return Boolean(this._private.collections&&this._private.collections.get(e))}_getCollectionTitle(e){return this.hasCollection(e)?this._private.collections.get(e).title:""}addCollection(e,t){if(!e)throw new Error("Invalid parameter",e);const i=this._private.collections;if(i&&0!==i.size){let i=this._private.collectionExplorer.addCollection(e);this._addViewMapItem("collections",i,a,t,this),t&&"first"===t.anchor&&this._selectCollection(i.id)}else this.setCollections([e])}fillCollection(e,t){if(!this.hasCollection(e))throw new Error("Invalid collection identifier",e);let s=this._private.collectionExplorer;void 0===s&&(s=new i(this._private.collections)),s.setItems(e,t,this._getCollectionTitle(e)),s.buildView(e)}removeCollection(e){if(!this.hasCollection(e))throw new Error("Invalid collection identifier",e);this._private.collections.get(e)}async _unselectCollection(){const e=this._private.selectedCollection||this._private.selectionInProgress;if(!e)return;if(!this._private.collections)return;const t=this._private.collections.get(e);if(t)try{await t.controller.onUnselect(),t.view.removeAttribute("checked"),this._setCustomContent(null);const e=this.getDOM();e.classList.remove("afr-home-page-navigate"),e.classList.remove("afr-home-page-side-panel-collapsed"),e.classList.remove("afr-home-page-content-overlay")}catch(e){console.error("Impossible to unselect the collection:",e)}}_selectCollection(e){return this._private.selectionLock=this._private.selectionLock.then((()=>this._selectCollectionImpl(e))),this._private.selectionLock}async _selectCollectionImpl(e){if(e===this._private.selectedCollection||e===this._private.selectionInProgress)return;if(this._private.selectionInProgress=e,await this._unselectCollection(),!e)return void(this._private.selectionInProgress=null);if(!this._private.collections)return;const t=this._private.collections.get(e);if(!t)return console.error("Collection not found:",e),void(this._private.selectionInProgress=null);try{await t.controller.onSelect();t.view.setAttribute("checked",""),this._private.selectedCollection=e;const i=await this._private.collectionExplorer.getDOM(e);this._setCustomContent(i);const s=this.getDOM();s.classList.add("afr-home-page-navigate"),(this._private.collectionExplorer.getItemsCount(e)>0||this._private.collectionExplorer.isCollectionCustom(e))&&s.classList.add("afr-home-page-content-overlay")}catch(e){console.error("Error selecting collection:",e)}finally{this._private.selectionInProgress=null}}_setCustomContent(e){const t=this._private.views.content,i=this._private.views.customContent;if(e){if(i.children&&i.children.length>0)throw new Error("The previous custom content was not removed from the DOM");i.appendChild(e),t.classList.remove("afr-home-page-custom-content-hidden")}else t.classList.add("afr-home-page-custom-content-hidden"),i.innerHTML=""}setCommands(e){if(e&&e.items)return this._setViewMap("commands",e.items,o,this)}hasCommand(e){return Boolean(this._private.commands&&this._private.commands.get(e))}addCommand(e,t){if(!e)throw new Error("Invalid parameter",e);const i=this._private.commands;if(i&&0!==i.size)this._addViewMapItem("commands",e,o,t,this);else{let t={items:[e]};this.setCommands(t)}}_setLinks(e){if(e&&e.items){if(!Array.isArray(e.items)||e.items.length>2)throw new Error("links must be an array and must contain a maximum of 2 array");const t=e.items&&e.items.length?e.items.length:0;t>0?(this._private.views.linksC1.classList.remove("afr-home-page-side-panel-links-hidden"),t>1?this._private.views.linksC2.classList.remove("afr-home-page-side-panel-links-hidden"):this._private.views.linksC2.classList.add("afr-home-page-side-panel-links-hidden")):(this._private.views.linksC1.classList.add("afr-home-page-side-panel-links-hidden"),this._private.views.linksC2.classList.add("afr-home-page-side-panel-links-hidden"));const i=t>0?e.items[0]:null,s=t>1?e.items[1]:null;this._setViewMap("linksC1",i,n),this._setViewMap("linksC2",s,n)}}_setViewMap(e,t,i,s){let r=this._private[e];if(h(r),t){if(!Array.isArray(t))throw new Error("items must be an array.");if(t.length>0){if(!this._private.views[e])throw new Error(`Impossible to retrieve the ${r} view.`);const a=this._private.views[e];r||(r=new Map,this._private[e]=r);for(const o of t){if(!o.id)throw new Error("Missing identifier for item",o);if(r.has(o.id))throw new Error("Identifier already used for item.",o.id);let[t,n,l]=i(o,s),c="collections"===e?o.collectionController:o.controller;r.set(o.id,{view:t,event:n,controller:c,callback:l}),a.appendChild(t)}}}}_addViewMapItem(e,t,i,s,r){const a=this._private[e],o=this._private.views[e];if(!t.id)throw new Error("Missing identifier for item",t);if(a.has(t.id))throw new Error("Identifier already used for item.",t.id);let[n,l,c]=i(t,r),h="collections"===e?t.collectionController:t.controller;if(a.set(t.id,{view:n,event:l,controller:h,callback:c,title:t.title}),s&&"last"!==s.anchor)if("first"===s.anchor)o.firstElementChild?o.insertBefore(n,o.firstElementChild):o.appendChild(n);else{const e=a.get(s.reference);if(!e)throw new Error("reference not found",s.reference);if("before"===s.anchor)o.insertBefore(n,e.view);else{if("after"!==s.anchor)throw new Error("Wrong parameter anchor",s.anchor);o.insertBefore(n,e.view.nextSibling)}}else o.appendChild(n)}setHideHPBehavior(e){const t=document.getElementsByClassName("afr-home-page-hide-button")[0];t.classList.remove("afr-home-page-hide-button-hidden");const i={view:t,event:"click",callback:()=>{e.call(),this.hide()}};i.view.addEventListener(i.event,i.callback),this._private.buttons.set("hideHP",i)}_buildView(e){this._private.views=Object.create(null);let i="NLS_DropMessage",r="NLS_NoContent",a="NLS_DnDPlaceholder";i=t.get(i)||i,r=t.get(r)||r,a=t.get(a)||a;const o=s("div",{class:"afr-home-page-v3 afr-home-page-container"+(e.background?" afr-home-page-container-background":""),style:`background-image: url(${e.background?e.background:""})`},s("button",{class:"afr-home-page-side-panel-show-button"}),s("button",{class:"afr-home-page-side-panel-back-button"}),s("aside",{class:"afr-home-page-side-panel"},s("button",{class:"afr-home-page-side-panel-hide-button"}),s("div",{class:"afr-home-page-side-panel-content"},s("header",{class:"afr-home-page-header"},s("div",{class:`afr-home-page-application-icon afr-home-page-application-icon-${c(e.brand)}`},s("div",{class:"afr-home-page-application-icon-placeholder"})),s("h1",{class:"afr-home-page-title"},e.title),s("h2",{class:"afr-home-page-subtitle"},e.subtitle)),s("div",{class:"afr-home-page-side-panel-guidance"},s("menu",{class:"afr-home-page-side-panel-guidance-menu"})),s("nav",{class:"afr-home-page-side-panel-navigation"}),s("menu",{class:"afr-home-page-side-panel-menu"}),s("footer",{class:"afr-home-page-side-panel-footer"},s("span",{class:"afr-home-page-side-panel-drop-message"},i),s("nav",{class:"afr-home-page-side-panel-footer-navigation"},s("ol",{class:"afr-home-page-side-panel-links afr-home-page-side-panel-links-hidden"}),s("ol",{class:"afr-home-page-side-panel-links afr-home-page-side-panel-links-hidden"}))))),s("section",{class:"afr-home-page-content afr-home-page-custom-content-hidden"},s("article",{class:"afr-home-page-content-placeholder"},s("i",{class:"afr-home-page-content-placeholder-icon"}),s("span",null,r),s("span",null,a)),s("article",{class:"afr-home-page-custom-content"}),s("button",{class:"afr-home-page-hide-button"})),s("div",{class:"afr-home-page-overlay"}));this._private.views.container=o,this._private.buttons=new Map;const n={view:o.getElementsByClassName("afr-home-page-side-panel-hide-button")[0],event:"click",callback:()=>{o.classList.add("afr-home-page-side-panel-collapsed")}};n.view.addEventListener(n.event,n.callback),this._private.buttons.set("collapse",n);const l={view:o.getElementsByClassName("afr-home-page-side-panel-show-button")[0],event:"click",callback:()=>{o.classList.remove("afr-home-page-side-panel-collapsed")}};l.view.addEventListener(l.event,l.callback),this._private.buttons.set("expand",l);const h={view:o.getElementsByClassName("afr-home-page-side-panel-back-button")[0],event:"click",callback:()=>{this._unselectCollection(),o.classList.remove("afr-home-page-side-panel-collapsed")}};h.view.addEventListener(h.event,h.callback),this._private.buttons.set("back",h);o.getElementsByClassName("afr-home-page-hide-button")[0].classList.add("afr-home-page-hide-button-hidden"),this._private.views.applicationIcon=o.getElementsByClassName("afr-home-page-application-icon-placeholder")[0],this._setApplicationIcon(e.icon),this._private.views.guidance=o.getElementsByClassName("afr-home-page-side-panel-guidance-menu")[0],this._setGuidance(e.guidance),this._private.views.collections=o.getElementsByClassName("afr-home-page-side-panel-navigation")[0],e.collections&&(e.defaulViewMode&&(e.collections.defaultViewMode=e.defaulViewMode),this.setCollections(e.collections)),this._private.views.content=o.getElementsByClassName("afr-home-page-content")[0],this._private.views.customContent=o.getElementsByClassName("afr-home-page-custom-content")[0],this._private.views.commands=o.getElementsByClassName("afr-home-page-side-panel-menu")[0],this.setCommands(e.commands),this._private.views.dragAndDropMessage=o.getElementsByClassName("afr-home-page-side-panel-drop-message")[0],this._private.views.links=o.getElementsByClassName("afr-home-page-side-panel-footer-navigation")[0],this._private.views.linksC1=this._private.views.links.firstElementChild,this._private.views.linksC2=this._private.views.links.lastElementChild,this._setLinks(e.links);const d=o.getElementsByClassName("afr-home-page-overlay")[0];this._private.views.overlay=d}_setDragAndDropController(e){const t=this._getOverlay();if(this._private.dragAndDrop){let e=this._private.dragAndDrop.subscriptions;for(const t of e)t.view.removeEventListener(t.event,t.cb);e.splice(0,e.length),this._private.dragAndDrop.controller&&this._private.dragAndDrop.controller.hasOverlay(t.firstChild)&&this.hideOverlay(),this._private.dragAndDrop.hideOverlayTimeout&&(clearTimeout(this._private.dragAndDrop.hideOverlayTimeout),this._private.dragAndDrop.hideOverlayTimeout=null)}else this._private.dragAndDrop=Object.create(null),this._private.dragAndDrop.controller=null,this._private.dragAndDrop.subscriptions=[],this._private.dragAndDrop.hideOverlayTimeout=null;const i=this._private.dragAndDrop.subscriptions,s=this.getDOM();if(e){this._private.views.dragAndDropMessage.classList.remove("afr-home-page-side-panel-drop-message-hidden");{const t={event:"dragenter",view:s,cb:t=>{this.hasOverlay()||e.onDragEnter(t).then((e=>{this.showOverlay(e)}))}};t.view.addEventListener(t.event,t.cb),i.push(t)}{const r={event:"dragleave",view:s,cb:()=>{this._private.dragAndDrop.hideOverlayTimeout=setTimeout((()=>{e.hasOverlay(t.firstChild)&&this.hideOverlay()}),300)}};r.view.addEventListener(r.event,r.cb),i.push(r)}{const e={event:"dragover",view:s,cb:e=>{e.stopPropagation(),e.preventDefault(),clearTimeout(this._private.dragAndDrop.hideOverlayTimeout),this._private.dragAndDrop.hideOverlayTimeout=null}};e.view.addEventListener(e.event,e.cb),i.push(e)}{const t=t=>{if(t.stopPropagation(),t.preventDefault(),this.hasOverlay()){const i=this._getOverlay();e.hasOverlay(i.firstChild)&&e.onDrop(t).then((()=>{this.hideOverlay()}))}},r={event:"drop",view:s,cb:t};r.view.addEventListener(r.event,r.cb),i.push(r)}}else this._private.views.dragAndDropMessage.classList.add("afr-home-page-side-panel-drop-message-hidden")}showOverlay(e){if(!e)throw new Error("No content to display in the overlay");this._private.views.overlay.appendChild(e);this.getDOM().classList.add("afr-home-page-overlay-show")}hideOverlay(){this.getDOM().classList.remove("afr-home-page-overlay-show");const e=this._getOverlay();let t=null;return e.hasChildNodes()&&(t=e.firstChild,e.removeChild(t)),t}hasOverlay(){return this.getDOM().classList.contains("afr-home-page-overlay-show")}_getOverlay(){return this._private.views.overlay}destroy(){const e=this._private.views.container;e.parentNode&&e.parentNode.removeChild(e),this._setDragAndDropController(null),delete this._private.dragAndDrop,h(this._private.buttons),this._setGuidance({items:[]}),delete this._private.guidance,this.setCollections({items:[]}),delete this._private.collections,this.setCommands({items:[]}),delete this._private.commands,delete this._private.views.dragAndDropMessage,this._setLinks({items:null}),delete this._private.linksC1,delete this._private.linksC2,this.hideOverlay(),delete this._private.views.overlay,delete this._private.views.customContent,delete this._private.views.container}}return d.RSC={I_Overview:"eye-windowed",I_GuidedTour:"touch",I_WhatsNew:"megaphone",I_UserAssistance:"i-question",I_Training:"graduation-cap",I_Tutorial:"video",I_UserCommunity:"topbar-users",get:function(e){return this[e]}},d.NLS=t,d})),define("DS/AfrHomePageV3/mod_AfrHomePageControllers",[],(function(){"use strict";class e{constructor(e){if(!e||!e.onDragEnter||!e.onDrop)throw new Error("Missing parameters");this._private=Object.create(null),this._private.overlays=Object.create(null),this._private.onDragEnter=e.onDragEnter,this._private.onDrop=e.onDrop,e.destroy&&(this._private.destroy=e.destroy)}get onDragEnter(){return e=>{if(!this._private.onDragEnter)throw new Error("No onDragEnter callback registered in HomePageDragAndDropController");return Promise.resolve(this._private.onDragEnter.call(this,e)).then((e=>{let t=null;return e?(this._private.overlays.authorized||(t=document.createElement("div"),t.setAttribute("class","afr-home-page-overlay-dnd afr-home-page-overlay-dnd-authorized"),this._private.overlays.authorized=t),t=this._private.overlays.authorized):(this._private.overlays.forbidden||(t=document.createElement("div"),t.setAttribute("class","afr-home-page-overlay-dnd afr-home-page-overlay-dnd-forbidden"),this._private.overlays.forbidden=t),t=this._private.overlays.forbidden),t}))}}get onDrop(){return e=>{if(!this._private.onDrop)throw new Error("No onDrop callback registered in HomePageDragAndDropController");return Promise.resolve(this._private.onDrop.call(this,e))}}hasOverlay(e){return Boolean(e===this._private.overlays.authorized||e===this._private.overlays.forbidden)}destroy(){this._private.destroy&&this._private.destroy.call(this)}}return e.OverlayTypes={forbidden:0,authorized:1},{HomePageButtonController:class{constructor(e){if(!e||!e.onAction)throw new Error("Missing parameters");this._private=Object.create(null),this._private.onAction=e.onAction,e.destroy&&(this._private.destroy=e.destroy)}get onAction(){return e=>Promise.resolve(this._private.onAction.call(this,e))}destroy(){this._private.destroy&&this._private.destroy.call(this)}},HomePageDragAndDropController:e}}));