define("DS/ENOChangeActionUX/scripts/CAPreferencesManager",["UWA/Class","DS/ENOChgServices/scripts/services/ChgApplicationPreferencesManager"],(function(e,t){"use strict";return e.singleton({_prefStructure:{ChangeAction:{"CASummary.IDCard.Size":void 0,"CASummary.CA.Selection":void 0,"CASummary.Filter.Selection":void 0,"CASummary.View.Selection":void 0,"CASummary.Delete.PID":[],"CASummary.last.Index.Time":void 0,"CASummary.Mobile":void 0,"CASummary.Desktop":void 0,"IDCard.SlideIn.Size":void 0,"IDCard.Dependency.SlideIn.Size":void 0,"IDCard.Applicability.SlideIn.Size":void 0,"IDCard.Attachment.SlideIn.Size":void 0,"IDCard.FlowdownProposed.SlideIn.Size":void 0,"IDCard.Flowdown.SlideIn.upCA":void 0,"IDCard.Approval.Task.SlideIn":void 0}},_APP_KEY:"ChangeAction",_CASUMMARY_IDCARD_SIZE:"CASummary.IDCard.Size",_CASUMMARY_CA_SELECTION:"CASummary.CA.Selection",_CASUMMARY_FILTER_SELECTION:"CASummary.Filter.Selection",_CASUMMARY_VIEW_SELECTION:"CASummary.View.Selection",_CASUMMARY_DELETE_PID:"CASummary.Delete.PID",_CASUMMARY_LAST_INDEX_TIME:"CASummary.last.Index.Time",_CASUMMARY_LAST_DELETE_TIME:"CASummary.last.Delete.Time",_CASUMMARY_MOBILE:"CASummary.Mobile",_CASUMMARY_DESKTOP:"CASummary.Desktop",_IDCARD_SLIDEIN_SIZE:"IDCard.SlideIn.Size",_IDCARD_DEPENDENCY_SLIDEIN_SIZE:"IDCard.Dependency.SlideIn.Size",_IDCARD_APPLICABILITY_SLIDEIN_SIZE:"IDCard.Applicability.SlideIn.Size",_IDCARD_ATTACHMENT_SLIDEIN_SIZE:"IDCard.Attachment.SlideIn.Size",_IDCARD_FLOWDOWNPROPOSED_SLIDEIN_SIZE:"IDCard.FlowdownProposed.SlideIn.Size",_IDCARD_FLOWDOWN_SLIDEIN_UPCA:"IDCard.Flowdown.SlideIn.upCA",_IDCARD_APPROVAL_TASK_SLIDEIN:"IDCard.Approval.Task.SlideIn",initialize:function(){t.initialize(this._APP_KEY,this._prefStructure,!0,!0)},updatePreference:function(e,i){t.updatePreference(e,i)},getPreference:function(e){return t.getPreference(e)},updateIDCardSize:function(e){this.updatePreference(this._CASUMMARY_IDCARD_SIZE,e)},getIDCardSize:function(){return this.getPreference(this._CASUMMARY_IDCARD_SIZE)},updateCASelection:function(e){this.updatePreference(this._CASUMMARY_CA_SELECTION,e)},getCASelection:function(){return this.getPreference(this._CASUMMARY_CA_SELECTION)},updateCASummaryFilterSelection:function(e){this.updatePreference(this._CASUMMARY_FILTER_SELECTION,e)},getCASummaryFilterSelection:function(){return this.getPreference(this._CASUMMARY_FILTER_SELECTION)},updateCASummaryViewSelection:function(e){this.updatePreference(this._CASUMMARY_VIEW_SELECTION,e)},getCASummaryViewSelection:function(){return this.getPreference(this._CASUMMARY_VIEW_SELECTION)},updateIDCardSlideInSize:function(e){switch(e.type){case"applicability":this.updateApplicabilitySlideInSize(e);break;case"dependency":this.updateDependencySlideInSize(e);break;case"attachment":this.updateAttachmentSlideInSize(e);break;case"flowdownProposed":this.updateflowdownProposedSlideInSize(e);break;case"approvals":this.updateApprovalTaskSlideInSize(e);break;default:console.log("Wrong Facet Selected")}},getIDCardSlideInSize:function(e){var t=null;switch(e.type){case"applicability":t=this.getApplicabilitySlideInSize();break;case"dependency":t=this.getDependencySlideInSize();break;case"attachment":t=this.getAttachmentSlideInSize();break;case"flowdownProposed":t=this.getflowdownProposedSlideInSize();break;case"approvals":t=this.getApprovalTaskSlideInSize();break;default:console.log("Wrong Facet Selected")}return t},addToCASummaryDeletePID:function(e){var t=this.getCASummaryViewSelection();null==t&&(t=[]),t.push(e),this.updatePreference(this._CASUMMARY_DELETE_PID,t)},removeFromCASummaryDeletePID:function(e){this.updatePreference(this._CASUMMARY_DELETE_PID,e)},getCASummaryViewSelection:function(){return this.getPreference(this._CASUMMARY_DELETE_PID)},getLastIndexTime:function(){return this.getPreference(this._CASUMMARY_LAST_INDEX_TIME)},updateLastIndexTime:function(e){this.updatePreference(this._CASUMMARY_LAST_INDEX_TIME,e)},getLastDeleteTime:function(){return this.getPreference(this._CASUMMARY_LAST_DELETE_TIME)},updateLastDeleteTime:function(e){this.updatePreference(this._CASUMMARY_LAST_DELETE_TIME,e)},getCASummaryViewDesktop:function(){return this.getPreference(this._CASUMMARY_DESKTOP)},updateCASummaryViewDesktop:function(e){this.updatePreference(this._CASUMMARY_DESKTOP,e)},getCASummaryViewMobile:function(){return this.getPreference(this._CASUMMARY_MOBILE)},updateCASummaryViewMobile:function(e){this.updatePreference(this._CASUMMARY_MOBILE,e)},getDependencySlideInSize:function(){return this.getPreference(this._IDCARD_DEPENDENCY_SLIDEIN_SIZE)},updateDependencySlideInSize:function(e){this.updatePreference(this._IDCARD_DEPENDENCY_SLIDEIN_SIZE,e)},getApplicabilitySlideInSize:function(){return this.getPreference(this._IDCARD_APPLICABILITY_SLIDEIN_SIZE)},updateApplicabilitySlideInSize:function(e){this.updatePreference(this._IDCARD_APPLICABILITY_SLIDEIN_SIZE,e)},getAttachmentSlideInSize:function(){return this.getPreference(this._IDCARD_ATTACHMENT_SLIDEIN_SIZE)},updateAttachmentSlideInSize:function(e){this.updatePreference(this._IDCARD_ATTACHMENT_SLIDEIN_SIZE,e)},getApprovalTaskSlideInSize:function(){return this.getPreference(this._IDCARD_APPROVAL_TASK_SLIDEIN)},updateApprovalTaskSlideInSize:function(e){this.updatePreference(this._IDCARD_APPROVAL_TASK_SLIDEIN,e)},updateflowdownProposedSlideInSize:function(e){this.updatePreference(this._IDCARD_FLOWDOWNPROPOSED_SLIDEIN_SIZE,e)},getflowdownProposedSlideInSize:function(){return this.getPreference(this._IDCARD_FLOWDOWNPROPOSED_SLIDEIN_SIZE)},getFlowdownSlideInUpCA:function(){return this.getPreference(this._IDCARD_FLOWDOWN_SLIDEIN_UPCA)},updateFlowdownSlideInUpCA:function(e){this.updatePreference(this._IDCARD_FLOWDOWN_SLIDEIN_UPCA,e)}})})),define("DS/ENOChangeActionUX/scripts/Services/ChgChangeActionServices",["DS/Foundation/WidgetUwaUtils","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService"],(function(e,t,i,n,o,a){"use strict";return{URL:null,_SCPreferred:null,_theListSC:null,_theListSC_NLS:null,_SCPreferredDB:null,getExpressionValue:function(){return new Promise((function(e,t){a.makeWSCall("/resources/v2/e6w/service/ExpresssionSearch/CHG*,ECM*","GET","enovia","application/json","",(function(t){var i=["CHG_CHANGE_MATURITY","CHG_OPEN_WITH_COLLAB","CHG_CREATE_CA_AUTO_PROMOTE","CHG_ADD_MASS_PROPOSED","CHG_OPENWITH","CHG_CA_VIEWS_ENHANCEMENT","CHG_CHANGE_GROUP","CHG_ChangeImpact_IR_RolledUP","CHG_ChangeImpact_IR_MassUpdate","CHG_TRANSFER_REALIZED_CUST_TYPE","CHG_IA_COLUMN_ASSESSMENT","CHG_IA_CUSTOM_VIEW","CHG_IA_COLUMN_ASSESSMEN","ECMEnableDefaultChangeAnalysis","CHG_OLD_CA_CREATE","CHG_NATIVE_BREADCRUMB","CHG_ADD_IA_FROM_PARENT_CR","CHG_CA_REALIZED_REFRESH","ECM_SearchRouteTemplateEnforcementForCA","ECM_EnableRouteTemplateEnforcementForCA","ECM_EnableChangeImpactsEnforcementForCR","ECM_EnableExploreInCollabNApprovalForNative","ECM_EnableAddMemberGenericComponent","CHG_CR_DUPLICATE","CHG_APPROVAL_COLUMN","CHG_INVESTIGATION_REQUEST","CHG_EnableNonChangeGovernedToCA","ECMEnableChangeAnalysisActivity_InWork","ECM_EnableChangeControlGranularity"];t&&t.data&&t.data.forEach((function(e){if(e.dataelements){var t=Object.keys(e.dataelements);for(var n in t)i.indexOf(t[n])>=0&&e.dataelements&&(o.getGlobalVariable()[t[n]]=e.dataelements[t[n]])}})),e()}),t,!0)}))},getJSONForCACreation:function(e){var t,i=this,n={version:"v0",changeaction:{cestamp:"0000",title:e.title,description:e.description,severity:e.severity,add:{proposed:[],context:[],people:[],referentials:[]}}};return n.version=e.version,e.changeorder&&null!=e.changeorder&&""!=e.changeorder&&(n.changeaction.changeorder=e.changeorder),(t=e.context).length>0&&(n.changeaction.add.context=t),(t=e.referential).length>0&&(n.changeaction.add.referentials=t),(t=e.assignee).length>0&&t.forEach((function(e){var t=i.getAssigneeBlockToAdd(e);n.changeaction.add.people.push(t)})),(t=e.reviewer).length>0&&t.forEach((function(e){var t=i.getReviewerBlockToAdd(e);n.changeaction.add.people.push(t)})),(t=e.follower).length>0&&t.forEach((function(e){var t=i.getFollowerBlockToAdd(e);n.changeaction.add.people.push(t)})),(t=e.proposed).length>0&&(n.changeaction.add.proposed=t),n},getAssigneeBlockToAdd:function(e){var t={name:"",role:"contributor"};return t.name=e,t},getReviewerBlockToAdd:function(e){var t={name:"",role:"reviewer"};return t.name=e,t},getFollowerBlockToAdd:function(e){var t={name:"",role:"follower"};return t.name=e,t}}})),define("DS/ENOChangeActionUX/scripts/Views/EmptyView",["UWA/Core","UWA/Class/View"],(function(e,t){"use strict";return t.extend({tagName:"div",className:"chg-empty-text-view",render:function(t){var i=e.createElement("div",{class:"chg-empty-text text-center",text:t});return this.container.setContent(i),this}})})),define("DS/ENOChangeActionUX/scripts/CASpinner",["DS/UIKIT/Mask"],(function(e){"use strict";var t={wait:!1,keepActive:!1,is3DSpace:!1,doWait:function(i,n){if(!1===t.keepActive&&t.isWaiting())t.endWait(i);else if(t.isWaiting())return;e.mask(i,n),t.wait=!0},endWait:function(i){t.isWaiting()&&(e.unmask(i),t.wait=!1,t.keepActive=!1)},set3DSpace:function(e){t.is3DSpace=e},if3DSpace:function(){return t.is3DSpace},isWaiting:function(){return t.wait}};return t})),define("DS/ENOChangeActionUX/scripts/Views/CAFlowdownInfoPopOverBodyView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","UWA/Promise","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","DS/DataGridView/DataGridView","DS/i3DXCompassPlatformServices/OpenWith","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgPropertiesServices","require"],(function(e,t,i,n,o,a,s,r,l,c,d,p,u){"use strict";return e.extend({init:function(e){this.options=e,this._parent.call(this,e)},setup:function(){this.dataModel=this.buildFlwodownInforModel()},render:function(){this.options.container.empty();var e=UWA.createElement("div",{class:"ppoover-body-container-component"}),t=this.buildDatagridView();return e.setContent(t),e.inject(this.options.container),this},buildFlwodownInforModel:function(){var e=this.options.objectsSelected,t=new r,i=this.treeDocument=new a({dataModelSet:t,useAsyncPreExpand:!0});if("flowdownFrom"===this.options.bodyFor)for(var n in e){if(l=e[n]){var o={id:l.caID,title:l.caTitle,type:"Change Action",typeNLS:"Change Action",icon:l.icon},s=this.createTreeModel(t,o);i.addChild(s)}}else if("flowdownFor"===this.options.bodyFor)for(var n in e){var l;if(l=e[n]){o={id:l.id,title:l.info["display name"],type:l.info.type,typeNLS:l.info.typeNLS,icon:l.info.icon},s=this.createTreeModel(t,o);i.addChild(s)}}return i.prepareUpdate(),i.pushUpdate(),i},createTreeModel:function(e,t){var i,n;d.getGlobalVariable();return new s.createTreeNodeDataModel(e,{label:t.title,children:[],icons:(i=t,n=[],n.push(i.icon),n),grid:{},data:{forObject:t},idData:{forID:t.id}})},buildDatagridView:function(){var e=this.dataModel;this.options.bodyFor;var i=this.dataGridView=new l({columns:[{text:t.ECM_CA_Table_Header_Title,dataIndex:"tree",width:"91%"}],treeDocument:e,showModelChangesFlag:!1,autoRowHeightFlag:!0});return i.rowSelection="single",i.cellSelection="none",this.setDefaultProperties(i),i},setDefaultProperties:function(e){var t=this;e.onContextualEvent=function(e){return e.cellInfos&&e.cellInfos.rowID>-1?t.showRMBMenu(e.cellInfos).then((function(e){return e})):[]}},openWith:function(e,i){return new o((async function(n,o){var a=null,s=u("DS/ENOChgServices/scripts/services/ChgDataService");i.objectTaxonomies&&i.objectTaxonomies.length>0?await s.getTypesHierarchy({types:[i.objectType]}).then((e=>{i.objectTaxonomies=Array.from(new Set(i.objectTaxonomies.concat(e.types_hierarchies[0].hierarchy)))})):await s.getTypesHierarchy({types:[i.objectType]}).then((e=>{i.objectTaxonomies=Array.from(new Set([i.objectType].concat(e.types_hierarchies[0].hierarchy)))}));var r=[];r.push(i);var l=e.getContentForCompassInteraction(r),p=new c;p.set3DXContent(l);var h=[];UWA.is(p.retrieveCompatibleApps,"function")&&p.retrieveCompatibleApps((function(e){e.forEach((function(e){h.push({type:"PushItem",title:e.text,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+e.fonticon},action:{callback:function(t){e.handler()}}})}));var i=d.getGlobalVariable();h.length>0&&i.isNative?"true"==i.CHG_OPENWITH&&(a={type:"PushItem",title:t.ECM_CA_Command_OpenWith_RichClient,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-export"},submenu:h}):h.length>0&&(a={type:"PushItem",title:t.ECM_CA_Command_OpenWith,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-export"},submenu:h}),n(a)}))}))},showRMBMenu:function(e){var i=this;return new o((function(n,a){var s=u("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices"),r=[],l={objectId:e.nodeModel.options.data.forObject.id.replace("pid:",""),objectType:e.nodeModel.options.data.forObject.type,displayName:e.nodeModel.options.data.forObject.title,displayType:e.nodeModel.options.data.forObject.typeNLS,facetName:"proposed"},c=s.openWith(l),p=[];p.push(c),o.all(p).then((function(e){e[0]&&r.push(e[0]),d.getGlobalVariable().CHG_OPEN_WITH_COLLAB,r.push({type:"PushItem",title:t.ECM_CA_Properties,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attributes"},action:{callback:function(e){i.showPropertyPanel()}}}),n(r)}))}))},showPropertyPanel:function(){var e=this.treeDocument.getSelectedNodes()[0].options.idData.forID;e=e.slice(4,e.length),p.createPropertiesComponent(e)},destroy:function(){this.dataGridView.destroy()}})})),define("DS/ENOChangeActionUX/scripts/Views/CASlideInFormView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Input/Button","DS/UIKIT/Form","UWA/Class/Model","DS/UIKIT/Scroller","DS/PlatformAPI/PlatformAPI","DS/ENOChgRouter5/scripts/ChgRouter"],(function(e,t,i,n,o,a,s,r,l,c,d){"use strict";return e.extend({slideinContainer:"",skeletonContainer:"",form:"",invokedFrom:"",isSlideOpen:!1,setup:function(e){var t=this;if(UWA.is(e)&&(this.invokedFrom=e.invokedFrom),"gov"==this.invokedFrom){var i=d.getDependency("xChangeApp");d.getDependency("applicationChannel").subscribe({event:"triptych-panel-hidden"},(function(e){"right"===e&&1==t.isSlideOpen&&t.hideSlideIn()}));for(var o=i.infoPanel.childNodes,a=0;a<o.length;a++){var s=o[a].className;UWA.is(s)&&"secondmainContainer-sidepanel"===s?(o[a].empty(),this.slideinContainer=o[a],o[a].style.display="block"):o[a].style.display="none"}this.skeletonContainer=n.extendElement(document.body).getElement(".triptych-main")}else this.slideinContainer=n.extendElement(document.body).getElement("#slidein-container"),this.skeletonContainer=n.extendElement(document.body).getElement("#skeleton-container"),this.slideinContainer.innerHTML=""},render:function(){return this},buildSlideIn:function(e){if(UWA.is(this.slideinContainer)){this.form=e;var t=UWA.createElement("div",{id:"slideInContent",styles:{display:"table",height:"100%",width:"100%"}});t.setAttribute("data-rec-id","slideInContentCA"),this.getHeader().inject(t),this.getBody().inject(t),this.getFooter().inject(t),e.slideInReference=this,t.inject(this.slideinContainer);var i=this;widget.addEvent("onResize",(function(){setTimeout((function(){var e=i.slideinContainer.getElement("#slideInBody .form .form-group .object-list");i.slideinContainer.clientWidth>0&&(window.matchMedia("(max-width: 768px)").matches?(i.slideinContainer.style.width="100%",e&&e.setStyle("width","100%")):(i.slideinContainer.style.width="400px",e&&e.setStyle("width","378px")))}),100)})),c.subscribe("ca-back-to-summary-hide-slidein",(function(){i.hideSlideIn()}))}},getHeader:function(){var e=this.form.getHeading(),t=UWA.createElement("div",{id:"slideInHeader",styles:{padding:"2px 14px",borderBottom:"1px solid #d1d4d4"},html:[{tag:"div",styles:{width:"100%"},html:{tag:"h5",html:e}},{tag:"div",styles:{top:"0",right:"0",height:"35px",width:"50px",position:"fixed"}}]});return t.setAttribute("data-rec-id","slideInHeaderCA"),t},getFooter:function(){var e=UWA.createElement("div",{id:"slideInFooterRow",styles:{display:"flex",flexDirection:"row",justifyContent:"flex-end"},html:this.form.getFooter()});e.setAttribute("data-rec-id","slideInFooterRowCA");var i=UWA.createElement("div",{id:"slideInFooter",styles:{display:"table-footer-group"},html:e});return i.setAttribute("data-rec-id","slideInFooterCA"),new a({value:t.ECM_CA_Cancel,className:"proposedButtons add-cancel-btn"}).inject(e).addEvent("onClick",this.onCancelButtonClick.bind(this)),i},onCancelButtonClick:function(){this.hideSlideIn()},getBody:function(){var e=UWA.createElement("div",{id:"slideInBody"});return this.form.getBody().inject(e),e},showSlideIn:function(){if(UWA.is(this.slideinContainer)){var e=this.slideinContainer.getElement("#slideInBody .form .form-group .object-list");window.matchMedia("(max-width: 768px)").matches?(this.slideinContainer.style.width="100%","gov"!=this.invokedFrom&&(this.skeletonContainer.style.marginRight="100%"),e&&e.setStyle("width","100% !important")):(this.slideinContainer.style.width="400px","gov"!=this.invokedFrom&&(this.skeletonContainer.style.marginRight="400px"),e&&e.setStyle("width","378px !important")),this.slideinContainer.style.borderLeftWidth="1px",this.skeletonContainer.style.opacity=".5",this.skeletonContainer.style.pointerEvents="none"}if("gov"==this.invokedFrom){this.isSlideOpen=!0;var t=d.getDependency("applicationChannel");t.publish({event:"triptych-show-panel",data:"right"}),t.publish({event:"information-panel-visible",data:null})}},hideSlideIn:function(){if(UWA.is(this.slideinContainer)){this.slideinContainer.innerHTML="",this.slideinContainer.style.width="0",this.slideinContainer.style.borderLeftWidth="0",this.skeletonContainer.style.marginRight="0",this.skeletonContainer.style.opacity="1",this.skeletonContainer.style.pointerEvents="inherit";"gov"!=this.invokedFrom&&this.skeletonContainer.setStyle("width","calc( 100% - 0px )")}"gov"==this.invokedFrom&&(this.isSlideOpen=!1,d.getDependency("applicationChannel").publish({event:"triptych-hide-panel",data:"right"}))}})})),define("DS/ENOChangeActionUX/scripts/Models/CARealizedActivityModel",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],(function(e,t){"use strict";return e.extend({idAttribute:"id",setup:function(){},fetch:function(e){console.log("fetch called")},parse:function(e){var i="Cannot be found",n="Access denied",o={};o.id=e.id,o.activityName=[],o.activityName=e.operation[0].split(" "),o.status=e.status;var a={},s={};if(UWA.is(e.after)){a.id=e.after.id,UWA.is(e.after.owner)&&(a.owner=e.after.owner);var r=e.after.info;UWA.is(r)||(r=e.after.instanceof.info,a.id=e.after.instanceof.id,a.Instanceid=e.after.id),a.Access=!0,UWA.is(e.after.name)&&(a.instanceName=e.after.name),a.type=r.typeNLS,a.objectType=r.type,a.type==n?(a.title=t.ECM_CA_Access_Denied,a.name=t.ECM_CA_Access_Denied,a.instanceName="",r.revision=""):a.type==i?(a.title=t.ECM_CA_Cannot_be_found,a.name=t.ECM_CA_Cannot_be_found,a.instanceName="",r.revision=""):(a.title=r["display name"],a.name=r["display name"]),a.revision=r.revision,""!=a.revision&&a.revision!=i&&a.revision!=n&&null!=a.revision||(a.revision=""),a.maturity=r.currentNLS,a.NameRevison=a.name+"  "+a.revision,""!=a.maturity&&a.maturity!=i&&a.maturity!=n&&null!=a.maturity||(a.Access=!1),o.Afterobject=a}if(UWA.is(e.before)){s.id=e.before.id,UWA.is(e.before.owner)&&(s.owner=e.before.owner),s.type=e.before.typeNLS,s.objectType=e.before.type;r=e.before.info;UWA.is(r)||(r=e.before.instanceof.info,s.id=e.before.instanceof.id,s.Instanceid=e.before.id),s.Access=!0,UWA.is(e.before.name)&&(s.instanceName=e.before.name),s.type=r.typeNLS,s.objectType=r.type,s.type==n?(s.title=t.ECM_CA_Access_Denied,s.name=t.ECM_CA_Access_Denied,s.instanceName="",r.revision=""):s.type==i?(s.title=t.ECM_CA_Cannot_be_found,s.name=t.ECM_CA_Cannot_be_found,s.instanceName="",r.revision=""):(s.title=r["display name"],s.name=r["display name"]),s.revision=r.revision,""!=s.revision&&s.revision!=i&&s.revision!=n&&null!=s.revision||(s.revision=""),s.maturity=r.currentNLS,s.NameRevison=s.name+"  "+s.revision,""!=s.maturity&&s.maturity!=i&&s.maturity!=n&&null!=s.maturity||(s.Access=!1),o.Beforeobject=s}return UWA.is(e.receivingChangeAction)&&(o.receivingChangeAction=e.receivingChangeAction),o.transferReason=UWA.is(e.transferReason)?e.transferReason:"",o.transferReasonNLS="",UWA.is(e.transferReason)&&("simple"==o.transferReason?o.transferReasonNLS=t.ECM_CA_Realized_Transfer_Move:o.transferReasonNLS="early"==o.transferReason?t.ECM_CA_Realized_Transfer_EarlyCompl:t.ECM_CA_Realized_Transfer_DelayedCompl),this.UpdateGrammar(o),o},UpdateGrammar:function(e){var i=e.activityName,n=e.status,o=e.receivingChangeAction,a=e.transferReason,s=e.transferReasonNLS,r=e.id;e.ActivityDetails=[],e.OriginalActivityDetails=[],UWA.is(i)&&Array.isArray(i)&&i.forEach((function(i){if(""!=i){var l={id:r,actName:i,NLSName:i,BeforeExists:!1,AfterExists:!1,BeforeGrammar:"",AfterGrammar:"",status:n,receivingChangeAction:o,transferReason:a,transferReasonNLS:s,sameAsWhere:!1,launchREOnWhere:!1,launchREAccess:!0};if("Add"==i)l.NLSName=t.ECM_CA_NewRealized_Add_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("Cut"==i)l.NLSName=t.ECM_CA_NewRealized_Cut_Operation,l.BeforeExists=!0,l.launchREOnWhere=!0;else if("AddAlternate"==i)l.NLSName=t.ECM_CA_NewRealized_AddAlternate_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("AltSubFor"==i)l.NLSName=t.ECM_CA_NewRealized_AltSubFor_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("AddSubstitute"==i)l.NLSName=t.ECM_CA_NewRealized_AddSubstitute_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("SubstitutionContextAdded"==i)l.NLSName=t.ECM_CA_NewRealized_SubstitutionContextAdded_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("SubtitutionContextRemoved"==i)l.NLSName=t.ECM_CA_NewRealized_SubtitutionContextRemoved_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("AltQualified"==i)l.NLSName=t.ECM_CA_NewRealized_AltQualified_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("AltObsolete"==i)l.NLSName=t.ECM_CA_NewRealized_AltObsolete_Operation,l.AfterExists=!0,l.launchREOnWhere=!0;else if("Replace"==i)l.NLSName=t.ECM_CA_NewRealized_Replace_Operation,l.BeforeExists=!0,l.AfterExists=!0,l.BeforeGrammar=t.ECM_CA_Replace_Before,l.AfterGrammar=t.ECM_CA_Replace_After,l.launchREOnWhere=!0;else if("AddInFamily"==i)l.NLSName=t.ECM_CA_NewRealized_AddInFamily_Operation,l.AfterExists=!0,e.Beforeobject&&(l.BeforeGrammar=t.ECM_CA_AddInFamily_Before,l.BeforeExists=!0),l.launchREOnWhere=!0;else if("Modify"==i)l.NLSName=t.ECM_CA_NewRealized_Modified,e.Afterobject&&e.Afterobject.owner&&e.Afterobject.id!=e.Afterobject.owner.id?(l.NLSName=t.ECM_CA_NewRealized_ModifiedUsage,l.AfterExists=!0):l.sameAsWhere=!0,l.launchREOnWhere=!0;else if("EditVariant"===i)l.NLSName=t.ECM_CA_REALIZED_EDITVARIANT,e.Afterobject&&e.Afterobject.owner&&e.Afterobject.id!=e.Afterobject.owner.id?(l.NLSName=t.ECM_CA_REALIZED_EDITVARIANT,l.AfterExists=!0):l.sameAsWhere=!0;else if("ConfiguredEditVariant"===i)l.NLSName=t.ECM_CA_REALIZED_CONFIGUREDEDITVARIANT,e.Afterobject&&e.Afterobject.owner&&e.Afterobject.id!=e.Afterobject.owner.id?(l.NLSName=t.ECM_CA_REALIZED_CONFIGUREDEDITVARIANT,l.AfterExists=!0):l.sameAsWhere=!0;else if("Move"==i)l.NLSName=t.ECM_CA_NewRealized_Moved,e.Afterobject&&e.Afterobject.owner&&e.Afterobject.id!=e.Afterobject.owner.id&&(l.AfterExists=!0),l.launchREOnWhere=!0;else if(i.contains("ChangeStatus")){var c=i.substring(13);l.NLSName=t.ECM_CA_NewRealized_ChangedStatus,i.contains("#")&&c&&"unknown"!=c&&(c=c.replace("_"," "),l.AfterGrammar=t.ECM_CA_NewRealized_Current_Maturity,l.AfterMaturity=c,l.AfterExists=!0,l.sameAsWhere=!0),l.launchREOnWhere=!0}else if(i.contains("FileAdded")){var d=i.split("#")[1];l.NLSName=t.ECM_CA_NewRealized_FileAdded,"unknown"!=d&&(l.AfterGrammar=t.ECM_CA_NewRealized_File_Name,l.AfterMaturity=d.replace(/<\?>/g," "),l.AfterExists=!0,l.sameAsWhere=!0),l.launchREOnWhere=!0}else if(i.contains("FileModified")){d=i.split("#")[1];l.NLSName=t.ECM_CA_NewRealized_FileModified,"unknown"!=d&&(l.AfterGrammar=t.ECM_CA_NewRealized_File_Name,l.AfterMaturity=d.replace(/<\?>/g," "),l.AfterExists=!0,l.sameAsWhere=!0),l.launchREOnWhere=!0}else if(i.contains("FileRemoved")){d=i.split("#")[1];l.NLSName=t.ECM_CA_NewRealized_FileRemoved,"unknown"!=d&&(l.AfterGrammar=t.ECM_CA_NewRealized_File_Name,l.AfterMaturity=d.replace(/<\?>/g," "),l.AfterExists=!0,l.sameAsWhere=!0),l.launchREOnWhere=!0}else"TransferOwnership"==i||"ChangeResponsible"==i?(l.NLSName=t.ECM_CA_NewRealized_transferownership,l.sameAsWhere=!0,l.launchREOnWhere=!0):"ConfiguredDelete"==i?(l.NLSName=t.ECM_CA_NewRealized_ConfiguredDelete,l.BeforeExists=!0,l.launchREOnWhere=!0):"ConfiguredReplace"==i?(l.NLSName=t.ECM_CA_NewRealized_ConfiguredReplace,l.BeforeExists=!0,l.AfterExists=!0,l.BeforeGrammar=t.ECM_CA_Replace_Before,l.AfterGrammar=t.ECM_CA_Replace_After,l.launchREOnWhere=!0):"EvolveInstance"==i?(l.NLSName=t.ECM_CA_NewRealized_EvolveInstance,l.BeforeExists=!0):"ConfiguredMove"==i?(l.NLSName=t.ECM_CA_NewRealized_ConfiguredMove,l.BeforeExists=!0,l.launchREOnWhere=!0):"NewMinorVersion"==i?(l.NLSName=t.ECM_CA_NewRealized_NewMinorVersion_OperationSuffix,l.BeforeExists=!0,l.BeforeGrammar=t.ECM_CA_Previous_Revision,l.sameAsWhere=!0):"NewVersion"==i?(l.NLSName=t.ECM_CA_NewRealized_NewVersion_OperationSuffix,l.BeforeExists=!0,l.BeforeGrammar=t.ECM_CA_Previous_Revision,l.sameAsWhere=!0):"Clone"==i?(l.NLSName=t.ECM_CA_NewRealized_Clone_OperationSuffix,l.BeforeExists=!0,l.BeforeGrammar=t.ECM_CA_Original_Object,l.sameAsWhere=!0):"Evolve"==i?(l.NLSName=t.ECM_CA_NewRealized_Evolve_OperationSuffix,l.BeforeExists=!0,l.BeforeGrammar=t.ECM_CA_Original_Object,l.sameAsWhere=!0):"NewEvolution"==i?(l.NLSName=t.ECM_CA_NewRealized_NewEvolution_OperationSuffix,l.BeforeExists=!0,l.BeforeGrammar=t.ECM_CA_Original_Object,l.sameAsWhere=!0):"Create"==i?(l.NLSName=t.ECM_CA_NewRealized_Create_Operation,l.launchREAccess=!0,l.launchREOnWhere=!0):"Extend"==i?(l.NLSName=t.ECM_CA_NewRealized_Extend_Operation,l.AfterExists=!0):"Delete"==i?(l.sameAsWhere=!0,l.NLSName=t.ECM_CA_NewRealized_Delete_Operation,l.launchREAccess=!1):l.NLSName=i;l.taggerId=l.NLSName+l.id,UWA.is(e.Afterobject)&&l.AfterExists&&(l.After=e.Afterobject),UWA.is(e.Beforeobject)&&l.BeforeExists&&(l.Before=e.Beforeobject),e.ActivityDetails.push(l)}})),e.OriginalActivityDetails=e.ActivityDetails}})})),define("DS/ENOChangeActionUX/scripts/Models/CATransRealDispModel",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgErrors"],(function(e,t,i,n,o,a,s){"use strict";return e.extend({idAttribute:"id",setup:function(){},parse:function(e){this.set("canEdit",!0),this.set("caType",{displayValue:"Change Action",actualValue:e.defaultCATypeNLS}),this.set("reasonForChangeForActivity",{displayValue:t.ECM_CA_Realized_Transfer_Move,actualValue:"simple"});var i=e;if(this.set("canEdit",!0),this.set("mode",e.mode),UWA.is(i.id)){var n={};this.set("id",i.id),i.set("objectId",i.id),n.objectType=i.get("objectType")?i.get("objectType"):"",n.objectName=i.get("objectTitle"),n.objectRev=i.get("revision")?i.get("revision"):"",n.objectName=n.objectName+" "+n.objectRev,n.objectID=i.get("objectId")?i.get("objectId").replace("pid:",""):"",n.id="pid:"+n.objectID,n.maturity=i.get("maturity")?i.get("maturity"):"",n.policy=i.get("policy")?i.get("policy"):"",n.image={imageValue:i.get("icon")?i.get("icon"):""},this.set("objectName",n.objectName),this.set("changeaction",n)}},add:function(e,t,n){var o={id:"pid:"+t},a=this,s=t,r=[s];i.getAdditionObjectInfo(r).then((function(t){o.objectType=t.additionObjectInfo[s].type,o.objectName=t.additionObjectInfo[s].objectTitle,o.objectRev=t.additionObjectInfo[s].revision,o.objectName=o.objectName+" "+o.objectRev,o.objectID=t.additionObjectInfo[s].pid,o.id="pid:"+o.objectID,o.policy=t.additionObjectInfo[s].policy,o.image={imageValue:t.additionObjectInfo[s].icon};var i=a.get(e);UWA.is(i,"object")&&a.unset(e),a.set(e,o)}),(function(e){return console.log("Populate Security Context failed"),Promise.reject(e)}))},remove:function(e,t,i){var n=this.get(e),o=this.get("reasonForChangeForActivity");UWA.is(n,"object")&&(this.unset("reasonForChangeForActivity",{silent:!0}),this.unset(e)),this.set("reasonForChangeForActivity",o)},proposedTypeAheadCallback:function(e,t,n){var r=t.trim()+"*",l=i.getCurrentModel(),c=l?l.get("id"):"",d="";""!=c&&(d="NOT (physicalid:"+(c=c.replace("pid:",""))+")");var p="";p=""!==d?'(flattenedtaxonomies:"types/Change Action")'+d+'AND (current:Prepare OR current:"In Work") AND (NOT flattenedtaxonomies:"interfaces/Change On Hold"':'(flattenedtaxonomies:"types/Change Action") AND (current:Prepare OR current:"In Work") AND (NOT flattenedtaxonomies:"interfaces/Change On Hold"',"*"!=r&&(p+=" AND "+r);var u={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname"],select_file:["icon","thumbnail_2d"],query:p+=")",order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:o.getGlobalVariable().tenant,login:{"3dspace":{SecurityContext:o.getGlobalVariable().getSecurityContext()}}};u=JSON.stringify(u);a.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",u,(function(e){if(e&&e.results){var t=e.results,i=[];Array.isArray(t)&&t.forEach((function(e){var t=e.attributes;if(Array.isArray(t)){var n="",o="",a="",s="",r="";t.forEach((function(e){e.name.indexOf("resourceid")>=0&&(n=e.value),e.name.indexOf("label")>=0&&(a=e.value),e.name.indexOf("identifier")>=0&&(o=e.value),e.name.indexOf("type_icon_url")>=0&&(s=e.value),void 0!==(r=a)&&""!==r||(r=o)})),i.push({value:n,label:r,image:s})}})),n(i)}}),(function(e,t){s.error(t.error.errorMessage),n([])}),{isfederated:!0})}})})),define("DS/ENOChangeActionUX/scripts/Views/CACustomSwitchView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],(function(e,t,i,n,o){"use strict";var a=t.extend({tagName:"div",domEvents:{},id:function(){return"CACustomSwitchView_"+this.cid},setup:function(e){this._parent.apply(this,arguments)},render:function(){this.container.empty(!0);var t=this;this.toggleDiv&&this.toggleDiv.destroy(),this.toggleDiv=e.createElement("div",{class:"proposed-toggle",html:[{tag:"h5",html:o.ECM_CA_Proposed_Object_Add,styles:{"margin-right":"10px"}}]}),(this.existingBtn||this.newBtn)&&(this.existingBtn&&this.existingBtn.destroy(),this.newBtn&&this.newBtn.destroy());var a=this.existingBtn=new i({value:o.ECM_CA_Proposed_Object_Add_Existing,id:"Existing",active:!0}),s=this.newBtn=new i({value:o.ECM_CA_Proposed_Object_Add_New,id:"New"});"TRUE"===t.model.get("createNewToggle")?(a.setClassName("small"),s.setClassName("primary small")):(a.setClassName("primary small"),s.setClassName("small"));var r=new n({type:"radio",name:"toggle-proposed",id:"toggle-proposed",buttons:[a,s],events:{onClick:function(e,t){this.dispatchEvent("onButtonClick",t)}}}),l=this.ButtonEvents={onButtonClick:function(e){"Existing"===e.getId()?t.model.set("createNewToggle","FALSE"):t.model.set("createNewToggle","TRUE")}};return this.listenTo(r,l),r.inject(this.toggleDiv),this.toggleDiv.inject(this.container),this},destroy:function(){this._parent.apply(this,arguments)}});return a})),define("DS/ENOChangeActionUX/scripts/Search",["DS/ENOjquery/ENOjquery","UWA/Core","UWA/Utils/InterCom","UWA/Class/Model","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","require"],(function(e,t,i,n,o,a){"use strict";var s=function(e,t){e&&e.precond&&(this.precond=e.precond),e&&e.excludeList&&(this.excludeList=e.excludeList),e&&"realized"===e.from&&(this.fromRealized=!0),this.socketName="search_socket_"+(new Date).getTime(),this.socket=new i.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var n=this.options(e);t&&(n.idcard_activated=!0),this.socket.dispatchEvent("RegisterContext",n)};return s.prototype.destroy=function(){var e={};e.widget_id=widget?widget.id:null,this.socket.dispatchEvent("unregisterSearchContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.disconnect()},s.prototype.options=function(t,i,n,a,s,r){var l={multiSel:!1};return l.title=t.title,l.mode="furtive",l.app_socket_id=this.socketName,l.widget_id=widget?widget.id:null,l.default_with_precond=!0,l.show_precond=!1,l.idcard_activated=!1,l.select_result_max_idcard=!1,l.source=["3dspace"],l.tenant=o.getGlobalVariable().tenant,l.role=enoviaServer.role,t.types&&(l.precond="(",n=t.types.split(","),e.each(n,(function(e,t){0!==e&&(l.precond+=" OR "),l.precond+='flattenedtaxonomies:"types/'+t.trim()+'"'})),l.precond+=")",t.excludedSearchTypes&&(l.precond+=t.excludedSearchTypes)),t.default_search_criteria&&(l.default_search_criteria=t.default_search_criteria),l},s.prototype.activate=function(e,i,n,r,l,c,d){var p=this;if(o.getGlobalVariable().isNative)if(!0===this.fromRealized){var u=a("DS/ENOChgServices/scripts/services/ChgNativeInitService");a("DS/ENOChangeActionUX/scripts/Views/CANewRealizedView")._tempReferenceToWinSearchCallback=e.callback;var h="SearchCA";u.DispatchEventToWin(h,p.precond)}else{u=a("DS/ENOChgServices/scripts/services/ChgNativeInitService");var m=a("DS/ENOChangeActionUX/scripts/Views/OperationForm");e&&e.callback&&(m.prototype._tempReferenceToWinSearchCallback=e.callback);h="Add_Proposed";u.DispatchEventToWin(h,"NewProposedChange")}else if(o.getGlobalVariable().is3DSpace){window.addEventListener("storage",(function(e){if(e.storageArea===sessionStorage)if(null!=sessionStorage.searchList&&""!=sessionStorage.searchList){var t=sessionStorage.searchList.split(",");s._tempReferenceTo3DSpaceSearchCallback(t),sessionStorage.removeItem("searchList")}else console.log("inside EVENT ******************************************")}));showChooser("../common/emxFullSearch.jsp?field=TYPES=type_ChangeAction:ECM_CHANGE_ONHOLD!=True:CURRENT=policy_ChangeAction.state_Prepare,policy_ChangeAction.state_InWork&table=AEFGeneralSearchResults&selection=single&formName=BCform&submitAction=refreshCaller&hideHeader=true&HelpMarker=emxhelpfullsearch&submitURL=../enterprisechangemgtapp/ECMWebSearchUtil.jsp?fromOperation=searchDependency",850,630),s._tempReferenceTo3DSpaceSearchCallback=e.callback}else{var g=this.options(e);t.is(e.callback,"function")||(g.mode="default"),e&&e.callback&&(this.callback=e.callback);var f={};f.widget_id=widget?widget.id:null,this.socket.dispatchEvent("unregisterSearchContext",f),this.socket.dispatchEvent("RegisterContext",g),this.socket.dispatchEvent("InContextSearch",g);p=this;this.socket.addListener("onCloseTransient",(function(e){p.socket.dispatchEvent("UnregisterContext",{widget_id:f.widget_id})}))}},s.prototype.isAvailable=function(){return t.is(this.socket)},s.prototype.objectsSelected=function(e){var t=[];if(this.callback){for(var i=0;i<e.length;i++){var o=new n(e[i]);t.push(o.get("id"))}this.callback(t)}},s})),define("DS/ENOChangeActionUX/scripts/Views/CASlideInTransferRealizedView",["UWA/Class/View","DS/PlatformAPI/PlatformAPI","DS/ENOChgRouter5/scripts/ChgRouter","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core"],(function(e,t,i,n,o,a){"use strict";return e.extend({slideinContainer:"",skeletonContainer:"",invokedFrom:"",isSlideOpen:!1,setup:function(e){var t=this;if(UWA.is(e)&&(this.invokedFrom=e.invokedFrom),"gov"==this.invokedFrom){var n=i.getDependency("xChangeApp");i.getDependency("applicationChannel").subscribe({event:"triptych-panel-hidden"},(function(e){"right"===e&&1==t.isSlideOpen&&t.hideSlideIn()}));for(var o=n.infoPanel.childNodes,s=0;s<o.length;s++){var r=o[s].className;UWA.is(r)&&"secondmainContainer-sidepanel"===r?(o[s].empty(),this.slideinContainer=o[s],o[s].style.display="block"):o[s].style.display="none"}this.skeletonContainer=a.extendElement(document.body).getElement(".triptych-main")}else this.slideinContainer=a.extendElement(document.body).getElement("#slidein-container"),this.skeletonContainer=a.extendElement(document.body).getElement("#skeleton-container"),this.slideinContainer.innerHTML=""},render:function(){return this},buildSlideIn:function(e){if(UWA.is(this.slideinContainer)&&UWA.is(e)){this.form=e;var i=UWA.createElement("div",{id:"slideInContent",styles:{display:"table",height:"100%",width:"100%"}});i.setAttribute("data-rec-id","slideInContentCA"),this.getHeader().inject(i),this.getBody().inject(i),this.getFooter().inject(i),e.slideInReference=this,i.inject(this.slideinContainer);var n=this;widget.addEvent("onResize",(function(){setTimeout((function(){n.slideinContainer.clientWidth>0&&(window.matchMedia("(max-width: 768px)").matches?n.slideinContainer.style.width="100%":n.slideinContainer.style.width="400px")}),100)})),t.subscribe("ca-back-to-summary-hide-slidein",(function(){n.hideSlideIn()}))}},getHeader:function(){var e=this.form.getHeading(),t=UWA.createElement("div",{id:"slideInHeader",styles:{padding:"2px 14px",borderBottom:"1px solid #d1d4d4"},html:[{tag:"div",styles:{width:"100%",marginRight:"50px"},html:{tag:"h5",html:e}}]});return t.setAttribute("data-rec-id","slideInHeaderCA"),t},getFooter:function(){var e=UWA.createElement("div",{id:"slideInFooterRow",styles:{display:"flex",flexDirection:"row",justifyContent:"flex-end"},html:{tag:"div",html:this.form.getFooter()}});e.setAttribute("data-rec-id","slideInFooterRowCA");var t=UWA.createElement("div",{id:"slideInFooter",styles:{display:"table-footer-group"},html:e});return t.setAttribute("data-rec-id","slideInFooterCA"),t},getBody:function(){var e=UWA.createElement("div",{id:"slideInBody"});return e.setAttribute("data-rec-id","slideInBodyCA"),this.form.getBody().inject(e),e},showSlideIn:function(){UWA.is(this.slideinContainer)&&(window.matchMedia("(max-width: 768px)").matches?this.slideinContainer.style.width="100%":this.slideinContainer.style.width="400px",this.slideinContainer.style.borderLeftWidth="1px",this.skeletonContainer.style.opacity=".5",this.skeletonContainer.style.pointerEvents="none");if("gov"==this.invokedFrom){this.isSlideOpen=!0;var e=i.getDependency("applicationChannel");e.publish({event:"triptych-show-panel",data:"right"}),e.publish({event:"information-panel-visible",data:null})}},hideSlideIn:function(){(UWA.is(this.slideinContainer)&&(this.slideinContainer.innerHTML="",this.slideinContainer.style.width="0",this.slideinContainer.style.borderLeftWidth="0",this.skeletonContainer.style.opacity="1",this.skeletonContainer.style.pointerEvents="inherit",this.destroy()),"gov"==this.invokedFrom)&&(this.isSlideOpen=!1,i.getDependency("applicationChannel").publish({event:"triptych-hide-panel",data:"right"}))},destroy:function(){this.slideinContainer=null,this.skeletonContainer=null}})})),define("DS/ENOChangeActionUX/scripts/Views/CAProposedSearchFilterView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4"],(function(e,t,i,n,o){"use strict";var a=e.extend({name:"searchfilter",tagName:"div",className:"operations-filter",setup:function(){this.template='                                                <div class="'+this.getClassNames("-container")+'">                                                  <div class="'+this.getClassNames("-sub-container")+'">                                                    <div class="'+this.getClassNames("-input-container")+' border-without-focus">                                                      <input type="text" class="form-control form-control-root filtertext" placeholder="{{placeholder}}">                                                      <div class="clear-filter fonticon fonticon-cancel-circled"></div>                                                      <span class="search-span"><i id="filtersearch" class="fonticon fonticon-search"></i></span>                                                    </div>                                                  </div>                                                </div>',this.renderer=this.getTemplate(this.template)},init:function(e){e=n.clone(e||{},!1),this._parent.call(this,e)},render:function(){this.name,this.cid;this.container.empty();var e=this.container,t=UWA.createElement("div",{class:"search-main-container hidden",styles:{width:"99.5%",height:"10%"}});t.setAttribute("data-rec-id","search-main-container-CA");var i=this.renderer();return t.addContent(i),t.inject(e),this},injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e){var t=o.compile(e),i=this;return i.data={placeholder:i.options.placeholder},function(){return t(i.data)}},domEvents:{"keyup .filtertext":function(e){var t=e.target.value,i=this.container.getElement(".clear-filter");t.length>0?i.setStyle("visibility","visible"):i.setStyle("visibility","hidden"),this.dispatchEvent("keyup",arguments)},"click .clear-filter":function(e){this.container.getElement(".clear-filter").setStyle("visibility","hidden");var t=this.container.getElement(".filtertext");if(t){t.value=""}this.dispatchEvent("keyup",{target:{value:""}})},"focus .filtertext":function(){var e=document.getElementsByClassName("searchfiler-input-container");e.addClassName("highlighted-border"),e.removeClassName("border-without-focus")}}});return a})),define("DS/ENOChangeActionUX/scripts/Views/CAProposedActivitiesView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/UIKIT/DropdownMenu","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices"],(function(e,t,i,n,o,a,s,r,l,c){"use strict";o.registerHelper("getChangeMaturity",(function(e,i){if(e){var n="";if(e===t.ECM_CA_Proposed_Activity_ChangeStatus){var o="";"Release"===i?o=t.ECM_CA_Proposed_Activity_State_Release:"Obsolete"===i?o=t.ECM_CA_Proposed_Activity_State_Obsolete:"Restore"===i&&(o=t.ECM_CA_Proposed_Activity_State_Restore),n='<span style="color:#B4B6BA;">'+t.ECM_CA_Proposed_ChangeMaturityTo+" </span>"+o}return n}})),o.registerHelper("getActivityName",(function(e){if(e)return e===t.ECM_CA_Proposed_Activity_ChangeStatus&&(e=t.ECM_CA_Proposed_ActivityName_ChangeMaturity),e})),o.registerHelper("getReasonForChange",(function(e){return e=e?'<span style="color:#B4B6BA;">'+t.ECM_CA_Proposed_Activity_Description+' :</span> <span title="'+e+'">'+e+"</span>":'<span style="color:#B4B6BA;">'+t.ECM_CA_Proposed_Activity_Description+" : </span>"}));var d={selUnselAllContainer:null,selUnselMultisel:null,_createView_TestProposed:function(i,n,p){return e.extend({name:"proposedActivities",className:"proposed-activities-activities-holder",activityModel:n,activityIdx:p,setup:function(){this.template='                                            <div class="proposed-activities-container">                                                <div class="proposed-activities">                                                    <div class="activitues-header">                                                        <div class="activities-chevron icon-class" id="chevron-'+this.activityIdx+'">                                                            <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-expand-down" id={{@index}}></span></div>                                                        </div>                                                        <div class="'+this.getClassNames("-activities-counter")+'">                                                            <span class="'+this.getClassNames("-activities-title")+'">{{title}}</span>                                                            <span class="'+this.getClassNames("-activities-count")+'">{{activityNum}}</span>                                                        </div>                                                        \x3c!--<div class="'+this.getClassNames("-actions")+'"></div>--\x3e                                                        \x3c!--<div class="'+this.getClassNames("-activitiesMultisel")+'"></div>--\x3e                                                    </div>                                                    <div class="activity-content">                                                        {{#each activities}}                                                            <div class="activity-indivisual-container" id="act-indi-cont-{{@index}}">                                                            <div class="activity-indivisual" id="act-indi-{{@index}}">                                                                <div class="act-chk-container"><input type="checkbox" class="chkbox-act hidden" id="act-chk-{{@index}}"></div>                                                                <div class="activity-name" id="act-name-{{@index}}"> {{#getActivityName activityName}}{{/getActivityName}}</div>                                                                <div class="activity-change-status" id="act-change-status-{{@index}}">{{#getChangeMaturity activityName activityTargetState}}{{/getChangeMaturity}}</div>                                                                <div class="activity-desc activity-ellipsis-info-1" id="act-desc-{{@index}}">{{#getReasonForChange activityDesc}}{{/getReasonForChange}}</div>                                                              </div>                                                                <div class="activity-actions">                                                                    <div class="activity-action-container" id="activity-action-container-{{@index}}">                                                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                                                    </div>                                                                </div>                                                            </div>                                                        {{/each}}                                                    <div>                                                </div>                                                </div>',this._initActionsView(),this._initMultiSelView(),this.renderer=this.getTemplate(this.template,this.activityModel)},render:function(){this.container.empty();var e=i?widget.body:this.container,t=UWA.createElement("div",{class:"main-proposed-activities-container"});t.setAttribute("data-rec-id","main-proposed-activities-container-CA");var n=this.renderer();t.addContent(n),t.inject(e),(this.data.activities.length>0&&"Restore"!=this.data.activities[0].activityTargetState||0==this.data.activities.length)&&this.injectSubView(this.actionsView,"."+this.name+"-actions"),this.injectSubView(this.proposedMultiSelView,"."+this.name+"-activitiesMultisel");for(var o=this.data.activityNum,a=this,s=0;s<o;s++){var r=this.container.getElement("#activity-action-container-"+s);if(r){r.addEvent("click",(function(e){var t=e.currentTarget.id.split("-")[3];t=parseInt(t),a._initDropDown(this,a.data.activities[t])}))}}return d.container=a,this.activitiesToRemove=[],this.selectedActivityItems=[],this},_initActionsView:function(){var e=[],i={id:"add",title:t.ECM_CA_Proposed_Add_Activity,icon:"plus",overflow:!1},n={id:"selectAll",title:t.SelectAll,icon:"select-all",overflow:!1},o={id:"unSelectAll",title:t.UnSelectAll,icon:"select-none",overflow:!1};e.push(n),e.push(o);var r=!0,l=c.getCurrentModel();if(UWA.is(l)&&UWA.is(l.get("userAccess"))){var p=l.get("userAccess");(p&&p.AddProposed&&"false"===p.AddProposed||!p.AddProposed)&&(r=!1)}r&&e.unshift(i);var u=new s(e);this.actionsView=new a({collection:u});var h=this,m=this._actionsViewEvents={onActionClick:function(){d.selUnselAllContainer=this.container,d.selUnselMultisel=this.proposedMultiSelView,h.dispatchEvent("onActionClickActivities",arguments)}};this.listenTo(this.actionsView,m)},_initMultiSelView:function(){var e=this,i={collection:new s,withMultisel:!0,useInfiniteScroll:!1,usePullToRefresh:!1,buildMultiselActions:function(i){var n=!0,o=c.getCurrentModel();if(UWA.is(o)&&UWA.is(o.get("userAccess"))){var a=o.get("userAccess");(a&&a.DeleteProposed&&"false"===a.DeleteProposed||!a.DeleteProposed)&&(n=!1)}var s=[],r={id:"remove",text:t.ECM_CA_Referential_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:!0,handler:function(t){e.dispatchEvent("removeMultiSelActvities",[t])}};return n&&s.push(r),s},events:{onMultiselOff:function(){d.container=e.container;for(var t=e.container.getElements(".activity-indivisual-container"),i=0;i<t.length;i++)t[i].removeClassName("selected-border");e.selectedActivityItems.length=0,e.activitiesToRemove.length=0,d.deactivateMultisel(e.container)},onMultiselOn:function(){d.container=e.container,d.activateMultisel(e.container)}}};d.multiSelView=this.proposedMultiSelView=new r(i)},_initDropDown:function(e,i){var n=this,o=[],a={text:t.ECM_CA_Action_Edit,icon:"fonticon fonticon-pencil",handler:function(t){t.preventDefault(),n.dispatchEvent("editActivity",[e,i,arguments[0]])}},s={text:t.ECM_CA_Referential_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",handler:function(t){t.preventDefault(),n.dispatchEvent("deleteActivity",[e,i,arguments[0]])}},r=!0,d=c.getCurrentModel();UWA.is(d)&&UWA.is(d.get("userAccess"))&&(((p=d.get("userAccess"))&&p.DeleteProposed&&"false"===p.DeleteProposed||!p.DeleteProposed)&&(r=!1));var p,u=!0;UWA.is(d)&&UWA.is(d.get("userAccess"))&&(((p=d.get("userAccess"))&&p.AddProposed&&"false"===p.AddProposed||!p.AddProposed)&&(u=!1));(r||u)&&(o.push(a),o.push(s)),this.dropDown?(this.dropDown.destroy(),this.dropDown=null):(this.dropDown=new l({target:e,items:o}),this.dropDown.show())},injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e,i){var n=o.compile(e),a=[];i.forEach((function(e){var t={};t.activityName=e.get("activityName"),t.activityDesc=e.get("activityDesc"),t.activityTargetState=e.get("targetState"),t.operationId=e.get("operationId"),t.objectId=e.get("objectId"),t.id=e.get("id"),t.activityActual=e.get("activityActual"),a.push(t)})),this.data={activityNum:a.length,title:t.ECM_CA_Proposed_Change_Activities_Label,activities:a};var s=this;return function(){return n(s.data)}},domEvents:{"click .activities-chevron":function(e){e.target.id;var t=e.target.className;t.indexOf("expand-right")>0?e.target.className=t.replace("right","down").trim():t.indexOf("expand-down")>0&&(e.target.className=t.replace("down","right").trim());var i=this.container.getElement(".activity-content");i.hasClassName("hidden")?i.removeClassName("hidden"):i.addClassName("hidden")},"click .activity-indivisual":function(e){},"click .chkbox-act":function(e){e.target;var t=e.target.id.split("-"),i=t[t.length-1],n=parseInt(i),o=this.activityModel.at(n),a=this.container.getElement("#act-indi-cont-"+i);a.hasClassName("selected-border")?a.removeClassName("selected-border"):a.addClassName("selected-border");var s=this.selectedActivityItems.indexOf(o.cid);if(-1===s?(this.selectedActivityItems.push(o.cid),this.activitiesToRemove.push(o),d.activateMultisel(this.container)):(this.selectedActivityItems.splice(s,1),this.activitiesToRemove.splice(s,1),0===this.activitiesToRemove.length&&d.deactivateMultisel(this.container)),this.proposedMultiSelView){var r={isActive:!0};r.selectedObjects=this.activitiesToRemove,this.proposedMultiSelView.buildMultisel(r)}}}})},deactivateMultisel:function(e){e.getElements(".activity-action-container").forEach((function(e){e.removeClassName("hidden")})),e.getElements(".chkbox-act").forEach((function(e){e.checked&&(e.checked=!1),e.addClassName("hidden")}))},activateMultisel:function(e){e.getElements(".activity-action-container").forEach((function(e){e.addClassName("hidden")})),e.getElements(".chkbox-act").forEach((function(e){e.removeClassName("hidden")}))},selectAll:function(){var e=d.selUnselAllContainer;if(e){d.activateMultisel(e);for(var t=e.getElements(".chkbox-act"),i=0;i<t.length;i++){var n=t[i];n.checked||n.click()}}},unselectAll:function(){d.selUnselMultisel&&(d.selUnselMultisel.exitMultisel(),d.selUnselMultisel.dispatchEvent("onMultiselOff",[d.selUnselMultisel,!1]))},resizeActivites:function(e){}};return d})),define("DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController",["UWA/Core","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/Core/Core","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/UIKIT/SuperModal","UWA/Class","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassPlatformServices/OpenWith","DS/CollectionView/CollectionViewStatusBar","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgDependencyServices","DS/ENOChgServices/scripts/services/ChgPropertiesServices","DS/ENOChgServices/scripts/services/ChgDataProcess","DS/UIKIT/Input/Text","DS/UIKIT/Input/Button","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/UIKIT/DropdownMenu","DS/UIKIT/Dropdown","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgGovernanceUX/scripts/util/ChgDataGridUtil","DS/ENOChgProbes/scripts/ChgCloudProbeUtils","DS/ENOChgGovernanceUX/scripts/util/ChgGovGlobalSubscriber","DS/RouteWebAppUX/scripts/RouteWebAppApprovalStatusUX","require"],(function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,y,b,S,E,_){"use strict";var D={dependencyElem:{},dependencyType:null,setCADependencyModel:function(e){D.caDependencyModel=e},buildUpstreamDependencyModel:function(e,i,n,o){return e&&e.forEach((function(n){if(n&&n.id===i){var o={};o.id=n.id,o.state=n.current,o.stateNLS=n.currentNLS,o.dueDate=n.duedate,o.responsible=n.owner,o.responsibleFullName=n.ownerFullName,o.name=n.name,o.title=n.title,o.type=n.type,o.dependencyLinks=[],o.chgDecompose=[],o.codependencyLinks=[],o.stacking=[],o.icon=[],o.policy=n.policy,Array.isArray(n.prereq)&&n.prereq.length>0&&n.prereq.forEach((function(i){var n={};n.linkId=i.id,n.toID=i.toId,n.consumed=i.consumed,e.forEach((function(e){e.id===i.toId&&(n.id=e.id,n.state=e.current,n.stateNLS=e.currentNLS,n.dueDate=e.duedate,n.responsible=e.owner,n.responsibleFullName=e.ownerFullName,n.name=e.name,n.title=e.title,n.type=e.type,n.dependencyType=t.ECM_CA_Depend_Label_New,n.dependencyValueType="Dependency",n.icon=e.icon,n.policy=e.policy)})),o.dependencyLinks.push(n)})),Array.isArray(n.coreq)&&n.coreq.length>0&&n.coreq.forEach((function(n){var a={};a.linkId=n.id,a.toID=n.toId,a.consumed=n.consumed,e.forEach((function(e){e.id===n.toId&&(a.id=e.id,a.state=e.current,a.stateNLS=e.currentNLS,a.dueDate=e.duedate,a.responsible=e.owner,a.responsibleFullName=e.ownerFullName,a.name=e.name,a.title=e.title,a.type=e.type,a.dependencyType=t.ECM_CA_CO_Depend_Label,a.dependencyValueType="Co-Dependency",a.icon=e.icon,a.policy=e.policy)})),D.caDependencyModel?a.id!=D.caDependencyModel.get("caId")&&a.id!=i&&o.dependencyLinks.push(a):o.dependencyLinks.push(a)})),Array.isArray(n.flowdownFrom)&&n.flowdownFrom.length>0&&n.flowdownFrom.forEach((function(i){var n={};n.linkId=i.id,n.toID=i.toId,n.consumed=i.consumed,e.forEach((function(e){e.id===i.toId&&(n.id=e.id,n.state=e.current,n.stateNLS=e.currentNLS,n.dueDate=e.duedate,n.responsible=e.owner,n.responsibleFullName=e.ownerFullName,n.name=e.name,n.title=e.title,n.type=e.type,n.dependencyType=t.ECM_CA_FLOW_Depend_Label,n.dependencyValueType="Flowdown",n.icon=e.icon,n.policy=e.policy)})),o.dependencyLinks.push(n)})),Array.isArray(n.group)&&n.group.length>0&&"true"==d.getGlobalVariable().CHG_CHANGE_GROUP&&n.group.forEach((function(i){var n={};n.linkId=i.id,n.toID=i.toId,n.consumed=i.consumed,e.forEach((function(e){e.id===i.toId&&(n.id=e.id,n.state=e.current,n.stateNLS=e.currentNLS,n.dueDate=e.duedate,n.responsible=e.owner,n.responsibleFullName=e.ownerFullName,n.name=e.name,n.title=e.title,n.type=e.type,n.dependencyType=t.ECM_CA_Group_Dependency,n.dependencyValueType="Group Dependency",n.icon=e.icon,n.policy=e.policy)})),o.dependencyLinks.push(n)})),D.dependencyElem=o}})),D.dependencyElem},buildDownstreamDependencyModel:function(e,i,n,o){return e&&e.forEach((function(n){if(n&&n.id===i){var o={};o.id=n.id,o.state=n.current,o.stateNLS=n.currentNLS,o.dueDate=n.duedate,o.responsible=n.owner,o.responsibleFullName=n.ownerFullName,o.name=n.name,o.title=n.title,o.type=n.type,o.dependencyLinks=[],o.chgDecompose=[],o.codependencyLinks=[],o.stacking=[],o.policy=n.policy,e.forEach((function(e){if(e&&e.id!==i){if(Array.isArray(e.prereq)&&e.prereq.length>0){var a=e;e.prereq.forEach((function(e){if(e.toId===i){var s={};s.linkId=e.id,s.toID=e.toId,s.consumed=e.consumed,s.id=a.id,s.state=a.current,s.stateNLS=a.currentNLS,s.dueDate=a.duedate,s.responsible=a.owner,s.responsibleFullName=n.ownerFullName,s.name=a.name,s.title=a.title,s.type=a.type,s.dependencyType=t.ECM_CA_Depend_Label_New,s.dependencyValueType="Dependency",s.icon=a.icon,s.policy=a.policy,o.dependencyLinks.push(s)}}))}if(Array.isArray(e.flowdownFrom)&&e.flowdownFrom.length>0){a=e;e.flowdownFrom.forEach((function(e){if(e.toId===i){var s={};s.linkId=e.id,s.toID=e.toId,s.consumed=e.consumed,s.id=a.id,s.state=a.current,s.stateNLS=a.currentNLS,s.dueDate=a.duedate,s.responsible=a.owner,s.responsibleFullName=a.ownerFullName,s.name=a.name,s.title=a.title,s.type=a.type,s.dependencyType=t.ECM_CA_FLOW_Depend_Label,s.dependencyValueType="Flowdown",s.icon=n.icon,s.policy=n.policy,o.dependencyLinks.push(s)}}))}Array.isArray(e.group)&&e.group.length>0&&"true"==d.getGlobalVariable().CHG_CHANGE_GROUP&&e.group.forEach((function(a){var s=e;if(a.toId===i){var r={};r.linkId=a.id,r.toID=a.toId,r.consumed=a.consumed,r.id=s.id,r.state=s.current,r.stateNLS=s.currentNLS,r.dueDate=s.duedate,r.responsible=s.owner,r.responsibleFullName=s.ownerFullName,r.name=s.name,r.title=s.title,r.type=s.type,r.dependencyType=t.ECM_CA_Group_Dependency,r.dependencyValueType="Group Dependency",r.icon=n.icon,r.policy=n.policy,o.dependencyLinks.push(r)}}))}})),Array.isArray(n.coreq)&&n.coreq.length>0&&n.coreq.forEach((function(n){var a={};a.linkId=n.id,a.toID=n.toId,a.consumed=n.consumed,e.forEach((function(e){e.id===n.toId&&(a.id=e.id,a.state=e.current,a.stateNLS=e.currentNLS,a.dueDate=e.duedate,a.responsible=e.owner,a.responsibleFullName=e.ownerFullName,a.name=e.name,a.title=e.title,a.type=e.type,a.dependencyType=t.ECM_CA_CO_Depend_Label,a.dependencyValueType="Co-Dependency",a.icon=e.icon,a.policy=e.policy)})),D.caDependencyModel?a.id!=D.caDependencyModel.get("caId")&&a.id!=i&&o.dependencyLinks.push(a):o.dependencyLinks.push(a)})),D.dependencyElem=o}})),D.dependencyElem},getTreeModelForDataGridView:async function(){var e=new n({useAsyncPreExpand:!0}),t=null;if((t="Downstream"==D.caDependencyModel.get("stream")?D.caDependencyModel.get("downstreamDependencyObjects"):D.caDependencyModel.get("upstreamDependencyObjects"))&&t.dependencyLinks&&0===t.dependencyLinks.length);else if(t&&t.dependencyLinks){let i=[];await E.getColumnApprovalStatusValue(h.createPayloadApprovalStatusValue(t.dependencyLinks)).then((function(e){e&&i.push(e)})),t.dependencyLinks.forEach((function(t){var n=D.createTreeNodeModel(t,i);e.addRoot(n)}))}return e},getChildNodesOfTarget:function(e){D.caDependencyModel.getTargetDependencies(e.options.data.objectId),r.subscribe("dependency:ChildNodes:ready"+widget.id,(async function(){var t=[],i=null;if((i="Downstream"==D.caDependencyModel.get("stream")?D.caDependencyModel.get("downstreamChildNodes"):D.caDependencyModel.get("upstreamChildNodes"))&&i.dependencyLinks&&0===i.dependencyLinks.length);else if(i&&i.dependencyLinks){let n=[];await E.getColumnApprovalStatusValue(h.createPayloadApprovalStatusValue(i.dependencyLinks)).then((function(e){e&&n.push(e)})),i.dependencyLinks.forEach((function(i){if(e.getParent().options.resourceid!=i.id){var o=D.createTreeNodeModel(i,n);t.push(o)}}))}e.addChild(t),e.preExpandDone(),r.unsubscribe("dependency:ChildNodes:ready"+widget.id)}))},createTreeNodeModel:function(e,t){var i=e.title,n=d.getGlobalVariable();const a=d.getGlobalVariable().changeActionSubTypes.map((e=>e.value));var s,r=e.dependencyType;s="Dependency"===e.dependencyValueType?"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-dependency":"Co-Dependency"===e.dependencyValueType?"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-codependency":"Group Dependency"===e.dependencyValueType?"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-group-add":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-down";var l=new UWA.Element("i",{id:"dependencyTypeIconDiv",class:"contextMenuImages "+s+" dependencyFontIconCustom",title:r}),c={id:e.responsible,fullName:e.responsibleFullName},p=(h.createCustomOwnerField(c),{id:e.id.replace("pid:",""),name:e.name+l.outerHTML,maturity:e.state,maturityWithBadge:e.stateNLS,policy:e.policy,owner:e.responsible,ownerFullName:e.responsibleFullName,dependency:e.dependencyType,dependencyValueType:e.dependencyValueType});let u=e.id.replace("pid:","");t&&t[0]&&t[0][u]&&(p.ApprovalStatus=t[0][u].approvalStatus,p.approvalStatusModel=t[0][u].approvalStatusModel);return""!=e.dueDate&&(e.dueDate=new UWA.Date(e.dueDate).strftime("%Y-%m-%d"),p.dueDate=e.dueDate),new o({label:i,children:[],icons:function(e){var t=[];return e.icon?t.push(e.icon):"Change Action"===e.type?t.push(n.baseURL+"/common/images/iconSmallChangeAction.png"):a.includes(e.type)?t.push(n.baseURL+`/common/images/iconSmall${e.type}.png`):"Change Order"===e.type&&t.push(n.baseURL+"/common/images/iconSmallChangeOrder.png"),t}(e),badges:function(e){var t={};return!0===e.consumed&&"Flowdown"!=e.dependencyValueType?t.bottomRight="http://upload.wikimedia.org/wikipedia/commons/0/00/Lock_icon_blue.gif":t.bottomRight="",t}(e),grid:p,data:{modelID:e.id,objectId:e.id,objectType:e.type,displayName:i,displayType:e.type,dependencyType:e.dependencyType,dependencyValueType:e.dependencyValueType,owner:e.responsible,ownerFullName:e.responsibleFullName,caName:e.name},resourceid:e.id,linkid:e.linkId,useAsyncPreExpand:!0})},showRMBMenu:function(e,i){return new Promise((function(e,n){var o=_("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices"),a=D.caDependencyModel.get("userAccess"),s=[],r=i.nodeModel.options.data.objectId.replace("pid:",""),l=i.nodeModel.options.data.objectType,c=i.nodeModel.options.data.displayName,u=i.nodeModel.options.data.displayType,h={objectId:r,objectType:l,displayName:c,displayType:u,facetName:"dependency"},m=o.openWith(h),g=p.getDependUserAccess(i.nodeModel.options.data.objectId),f=[];f.push(m),f.push(g);try{if(i.nodeModel.options.grid.approvalStatusModel){var C=E.getColumnApprovalStatusMenu(i.nodeModel.options.grid.approvalStatusModel);f.push(C)}}catch(e){console.error(e)}Promise.all(f).then((function(n){n[0]&&s.push(n[0]);var l=d.getGlobalVariable();if("false"!=l.CHG_OPEN_WITH_COLLAB&&s.push({type:"PushItem",title:t.ECM_CA_Explore_With_Central,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-in-a-new-window"},action:{callback:function(e){D.openIn3DSpace()}}}),l.isNative){var c={};i.nodeModel._options.grid.id=i.nodeModel._options.data.objectId.replace("pid:",""),c.objectID=i.nodeModel._options.grid.id,s.push(o.getOpenCAMenu(that,c))}s.push({type:"PushItem",title:t.ECM_CA_Properties,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attributes"},action:{callback:function(e){D.showPropertyPanel()}}});let p=[];i.nodeModel._options.grid.id=i.nodeModel._options.data.objectId.replace("pid:",""),i.nodeModel._options.grid.title=i.nodeModel._options.data.displayName,p.push(i.nodeModel),s.push(w.getCopyLink(p));var u=new Array(r);const h={};h.selectedNodeIDs=u,s.push(y.getRelationalExplorerMenu(h)),"true"==n[1].dependUserAccess.Synchronization&&s.push({type:"PushItem",title:t.ECM_COLLABORATE_CHG_DEPENDENCY,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-change-action-sync"},action:{callback:function(e){D.syncChangeDependency()}}}),"false"!==a.dependUserAccess.edit&&s.push({type:"PushItem",title:t.ECM_CA_Remove_Referential,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove"},action:{callback:function(e){D.removeDependency()}}}),n[2]&&n[2].length>0&&n[2].forEach((e=>{s.push(e)})),e(s)}))}))},openWith:function(e,i){return new Promise((async function(n,o){var a=null,s=_("DS/ENOChgServices/scripts/services/ChgDataService");i.objectTaxonomies&&i.objectTaxonomies.length>0?await s.getTypesHierarchy({types:[i.objectType]}).then((e=>{i.objectTaxonomies=Array.from(new Set(i.objectTaxonomies.concat(e.types_hierarchies[0].hierarchy)))})):await s.getTypesHierarchy({types:[i.objectType]}).then((e=>{i.objectTaxonomies=Array.from(new Set([i.objectType].concat(e.types_hierarchies[0].hierarchy)))}));var r=[];r.push(i);var c=e.getContentForCompassInteraction(r),p=new l;p.set3DXContent(c);var u=[];UWA.is(p.retrieveCompatibleApps,"function")&&p.retrieveCompatibleApps((function(e){e.forEach((function(e){u.push({type:"PushItem",title:e.text,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+e.fonticon},action:{callback:function(t){e.handler()}}})}));var i=d.getGlobalVariable();u.length>0&&i.isNative?"true"==i.CHG_OPENWITH&&(a={type:"PushItem",title:t.ECM_CA_Command_OpenWith_RichClient,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-export"},submenu:u}):u.length>0&&(a={type:"PushItem",title:t.ECM_CA_Command_OpenWith,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-export"},submenu:u}),n(a)}))}))},showNotification:function(e,t,i,n,o,a,s){var r={level:e,title:t,subtitle:i,message:n,sticky:o,allowUnsafeHTML:s||!1};window.notifs||(window.notifs=f,C.setNotificationManager(window.notifs)),a?C.inject(a):C.elements.container.isInjected()||C.inject(),window.notifs.addNotif(r)},openIn3DSpace:function(){var e=_("DS/ENOChgServices/scripts/services/ChgNativeInitService"),t=D.caDependencyModel.get("dataGridView").getTreeDocument().getSelectedNodes()[0].options.resourceid;t=t.slice(4,t.length);var i=d.getGlobalVariable();if(i.isNative)e.DispatchEventToWin("ExploreInCollabNApproval",t);else{var n="/common/emxTree.jsp?mode=insert&objectId="+t,o=i.getSecurityContext().replace("ctx::",""),a=i.computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+o+"&forwardUrl="+n),s=window.open();s.opener=null,s.location.href=a}},showPropertyPanel:function(){var e=D.caDependencyModel.get("dataGridView").getTreeDocument().getSelectedNodes()[0].options.resourceid;e=e.slice(4,e.length),u.createPropertiesComponent(e)},syncChangeDependency:function(){var e=_("DS/ENOChgServices/scripts/services/ChgErrors"),i=D.caDependencyModel.get("dataGridView").getTreeDocument();p.syncDependency(i).then((function(e){var i,n=new a({closable:!0,renderTo:widget.body});i="<p>\t\t\t\t\t\t\t\t\x3c!--h6></h6--\x3e\t\t\t\t\t\t\t\t<ul>\t\t\t\t\t\t\t\t\t<li>"+t.ECM_CA_EBOMSync_Successful+"</li>\t\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t</p>",n.dialog({body:i,title:t.ECM_CA_Action_EBOMSync_CollabStatus,buttons:[{className:"primary",value:t.ECM_CA_Collab_Dialog_Done,action:function(e){e.hide()}}]})}),(function(i){i?e.error(i):e.error(t.ECM_CA_Action_EBOMSync_Failed)}))},removeDependency:function(){var e=_("DS/ENOChgServices/scripts/services/ChgErrors"),i=D.caDependencyModel.get("dataGridView").getTreeDocument();(n=i.getSelectedNodes()[0])||e.error(t.ECM_NO_NODE_SELECTED);var n,o={},a=D.caDependencyModel._attributes.stream,s=D.caDependencyModel._attributes.contextParentType,l=i.getSelectedNodes()[0]._options.grid.dependencyValueType;"Upstream"===a&&"Change Action"===s?"Dependency"===l?o.commandInfo={type:"Change Action",facet:"Dependency",action:"CA>Dependency>Upstream>Remove Dependency"}:"Co-Dependency"===l?o.commandInfo={type:"Change Action",facet:"Dependency",action:"CA>Dependency>Upstream>Remove Co-Dependency"}:"Group Dependency"===l&&(o.commandInfo={type:"Change Action",facet:"Dependency",action:"CA>Dependency>Upstream>Remove Dependency"}):"Downstream"===a&&"Change Action"===s?"Dependency"===l?o.commandInfo={type:"Change Action",facet:"Dependency",action:"CA>Dependency>Downstream>Remove Dependency"}:"Co-Dependency"===l?o.commandInfo={type:"Change Action",facet:"Dependency",action:"CA>Dependency>Downstream>Remove Co-Dependency"}:"Flowdown"===l?o.commandInfo={type:"Change Action",facet:"Dependency",action:"CA>Dependency>Downstream>Remove Flowdown"}:"Group Dependency"===l&&(o.commandInfo={type:"Change Action",facet:"Dependency",action:"CA>Dependency>Downstream>Remove Dependency"}):"Upstream"===a&&"Change Order"===s?"Dependency"===l?o.commandInfo={type:"Change Order",facet:"Dependency",action:"CO>Dependency>Upstream>Remove Dependency"}:"Co-Dependency"===l&&(o.commandInfo={type:"Change Order",facet:"Dependency",action:"CO>Dependency>Upstream>Remove Co-Dependency"}):"Downstream"===a&&"Change Order"===s&&("Dependency"===l?o.commandInfo={type:"Change Order",facet:"Dependency",action:"CO>Dependency>Downstream>Remove Dependency"}:"Co-Dependency"===l&&(o.commandInfo={type:"Change Order",facet:"Dependency",action:"CO>Dependency>Downstream>Remove Co-Dependency"})),0!=Object.entries(o).length&&b.cloudProbeUtils.genericCommandClickEventForAnalytics({inputJSON:o}),(n=i.getSelectedNodes()[0])?"Group Dependency"==n.options.grid.dependencyValueType?e.error(t.ECM_CA_REMOVE_GROUP_DEPENDENCY_ERROR):p.removeDependencyLink(i,n).then((function(){if(n.isRoot()){if(i.removeRoot(n),"Upstream"==D.caDependencyModel.get("stream")){if(D.caDependencyModel.get("upstreamDependencyObjects").dependencyLinks.forEach((function(e,t,i){e.id==n.options.resourceid&&e.dependencyValueType==n.options.data.dependencyValueType&&i.splice(t,1)})),"Co-Dependency"==n.options.data.dependencyValueType)D.caDependencyModel.get("downstreamDependencyObjects").dependencyLinks.forEach((function(e,t,i){e.id==n.options.resourceid&&"Co-Dependency"==e.dependencyValueType&&i.splice(t,1)}))}else if(D.caDependencyModel.get("downstreamDependencyObjects").dependencyLinks.forEach((function(e,t,i){e.id==n.options.resourceid&&e.dependencyValueType==n.options.data.dependencyValueType&&i.splice(t,1)})),"Co-Dependency"==n.options.data.dependencyValueType)D.caDependencyModel.get("upstreamDependencyObjects").dependencyLinks.forEach((function(e,t,i){e.id==n.options.resourceid&&"Co-Dependency"==e.dependencyValueType&&i.splice(t,1)}));if(D.caDependencyModel.get("upstreamDependencyObjects").dependencyLinks.length+D.caDependencyModel.get("downstreamDependencyObjects").dependencyLinks.length===0){var e=D.caDependencyModel.get("caId").substring(4);r.publish("dependency:data:ready"+widget.id,e)}}else{n.getParent().removeChild(n)}}),(function(e){console.log("Remove link failed")})):e.error(t.ECM_NO_NODE_SELECTED)},updateStatusBar:function(e){e.buildStatusBar([{type:c.STATUS.NB_ITEMS},{type:c.STATUS.NB_SELECTED_ROWS}])},createExcludeListForSearch:function(e){let t="";return t=t+"NOT (physicalid:"+e.split(":")[1]+") ",t},addDependency:function(e){var t={},i=D.caDependencyModel._attributes.stream,n=D.caDependencyModel._attributes.contextParentType;"Upstream"===i&&"Change Action"===n?"Dependency"===e.type?t.commandInfo={type:"Change Action",facet:"Dependency",action:"CA>Dependency>Upstream>Add Dependency"}:"CoDependency"===e.type&&(t.commandInfo={type:"Change Action",facet:"Dependency",action:"CA>Dependency>Upstream>Add Co-Dependency"}):"Downstream"===i&&"Change Action"===n?"Dependency"===e.type?t.commandInfo={type:"Change Action",facet:"Dependency",action:"CA>Dependency>Downstream>Add Dependency"}:"CoDependency"===e.type&&(t.commandInfo={type:"Change Action",facet:"Dependency",action:"CA>Dependency>Downstream>Add Co-Dependency"}):"Upstream"===i&&"Change Order"===n?"Dependency"===e.type?t.commandInfo={type:"Change Order",facet:"Dependency",action:"CO>Dependency>Upstream>Add Dependency"}:"CoDependency"===e.type&&(t.commandInfo={type:"Change Order",facet:"Dependency",action:"CO>Dependency>Upstream>Add Co-Dependency"}):"Downstream"===i&&"Change Order"===n&&("Dependency"===e.type?t.commandInfo={type:"Change Order",facet:"Dependency",action:"CO>Dependency>Downstream>Add Dependency"}:"CoDependency"===e.type&&(t.commandInfo={type:"Change Order",facet:"Dependency",action:"CO>Dependency>Downstream>Add Co-Dependency"})),0!=Object.entries(t).length&&b.cloudProbeUtils.genericCommandClickEventForAnalytics({inputJSON:t});var o=_("DS/ENOChgServices/scripts/services/ChgNativeInitService"),a=_("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices");window.addEventListener("storage",(function(e){if(e.storageArea===sessionStorage)if(null!=sessionStorage.searchList&&""!=sessionStorage.searchList){for(var t=sessionStorage.searchList.split(","),i=0;i<t.length;i++){var n={};n.value=t[i],n.label="";var o={0:[n.value]};D.OnSearchComplete(o)}sessionStorage.removeItem("searchList")}else console.log("inside EVENT ******************************************")})),D.dependencyType=e.type;var s=d.getGlobalVariable();let r={condition:"addExistingDependancy",extendedQuery:D.createExcludeListForSearch(D.caDependencyModel._attributes.caId)};var l;if(s.isNative)l="Dependency"==D.dependencyType?"Add_Dependency":"Add_CoDependency",o.DispatchEventToWin(l,"Add_Dependency");else if(s.is3DSpace){showChooser("../common/emxFullSearch.jsp?field=TYPES=type_ChangeOrder,type_ChangeAction:ECM_CHANGE_ON_HOLD!=TRUE:CURRENT!=policy_Cancelled.state_Cancelled&table=AEFGeneralSearchResults&selection=single&formName=BCform&submitAction=refreshCaller&hideHeader=true&HelpMarker=emxhelpfullsearch&submitURL=../enterprisechangemgtapp/ECMWebSearchUtil.jsp?fromOperation=searchDependency",850,630)}else{var c=a.activateSearch(!1);a.search("Dependency","Change Action, Change Order",D.OnSearchComplete,"Depend",c,void 0,void 0,r)}},OnSearchComplete:function(e){var t,i,n={},o=D.caDependencyModel.get("stream"),a=D.caDependencyModel.get("dataGridView").getTreeDocument(),s=D.caDependencyModel.get("caId"),l=a.getSelectedNodes()[0];t=UWA.is(l)?l.options.resourceid:s,i=d.getGlobalVariable().isNative?"pid:"+(e=e.split(","))[0]:"pid:"+e[0][0];var c="Dependency"===D.dependencyType?"prerequisite":"corequisite";n="prerequisite"==c?"Upstream"==o?{version:"v0",type:c,to:i,from:t}:{version:"v0",type:c,to:t,from:i}:{version:"v0",type:c,to:i,from:t},p.addDependencyLink(JSON.stringify(n)).then((async function(e){let t=_("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices");const i=e.elements.map((e=>e.id.replace("pid:",""))),n=await t.getAdditionObjectInfo(i);if(e.elements.forEach((e=>{const t=e.id.replace("pid:",""),i=n.additionObjectInfo&&n.additionObjectInfo[t]?n.additionObjectInfo[t].icon:"";e.icon=i;const o=n.additionObjectInfo&&n.additionObjectInfo[t]?n.additionObjectInfo[t].policy:"";e.policy=o})),y.fetchMaturityStateCSS(e.elements),UWA.is(l)){d=[];"Upstream"==o?(a=D.buildUpstreamDependencyModel(e.elements,e.originid),d=D.getNewlyAddedDependencyElem(a,l)):d=(a=D.buildDownstreamDependencyModel(e.elements,l.options.resourceid)).dependencyLinks;u=[];let t=[];await E.getColumnApprovalStatusValue(h.createPayloadApprovalStatusValue(d)).then((function(e){e&&t.push(e)})),d.forEach((function(e){var i=D.createTreeNodeModel(e,t);u.push(i)})),l.addChild(u),l.expand()}else{var a,c=D.caDependencyModel.get("dataGridView"),d=[];if("Upstream"==o)a=D.buildUpstreamDependencyModel(e.elements,s),d=D.getNewlyAddedDependencyElem(a,c.treeDocument),D.caDependencyModel.set("upstreamDependencyObjects",a),"Co-Dependency"==d[0].dependencyValueType&&(a=D.buildDownstreamDependencyModel(e.elements,s),D.caDependencyModel.set("downstreamDependencyObjects",a));else{a=D.buildDownstreamDependencyModel(e.elements,s),d=D.getNewlyAddedDependencyElem(a,c.treeDocument);var p=D.caDependencyModel.get("downstreamDependencyObjects");p.dependencyLinks.push(d[0]),D.caDependencyModel.set("downstreamDependencyObjects",p),"Co-Dependency"==d[0].dependencyValueType&&(a=D.buildUpstreamDependencyModel(e.elements,s),D.caDependencyModel.set("upstreamDependencyObjects",a))}var u=[];let t=[];await E.getColumnApprovalStatusValue(h.createPayloadApprovalStatusValue(d)).then((function(e){e&&t.push(e)})),d.forEach((function(e){var i=D.createTreeNodeModel(e,t);u.push(i)})),c.treeDocument.addRoot(u);var m=D.caDependencyModel.get("upstreamDependencyObjects").dependencyLinks.length+D.caDependencyModel.get("downstreamDependencyObjects").dependencyLinks.length;if(1==m||2==m){var g=s.substring(4);r.publish("dependency:data:ready"+widget.id,g)}}}),(function(e){console.log("Add link failed in view")}))},getNewlyAddedDependencyElem:function(e,t){var i=[];return e.dependencyLinks.forEach((function(e){var n=!0,o=e.id,a=e.dependencyValueType;t.getChildren().forEach((function(e){var t=e.options.resourceid,i=e.options.grid.dependencyValueType;o==t&&a==i&&(n=!1)})),n&&i.push(e)})),i},updateUX:async function(){var e=D.caDependencyModel,t=e.get("stream"),i=e.get("dataGridView"),n=e.get("caId");p.changeActionDependencyModel.set("stream",t),p.changeActionDependencyModel.set("dataGridView",i),p.changeActionDependencyModel.set("caId",n),D.setCADependencyModel(p.changeActionDependencyModel);var o=await D.getTreeModelForDataGridView();D.caDependencyModel.get("dataGridView").treeDocument=o},globalSubscribeForCADependenciesGridView:function(){S.addObserver("CADependenciesGridView","Lifecycle.Modification",this.handleForMaturityUpdate)},handleForMaturityUpdate:async function(e){if(e&&D.caDependencyModel){let n=D.caDependencyModel.get("dataGridView").getTreeDocument().getSelectedNodes();await y.getHandleForMaturityUpdate(JSON.parse(e),n);var t=[];n.forEach((e=>t.push({id:e.options.grid.id})));var i=await E.getColumnApprovalStatusValue(h.createPayloadApprovalStatusValue(t));if(i&&i[n[0].options.grid.id])n[0].updateOptions({grid:{ApprovalStatus:i[n[0].options.grid.id].approvalStatus,approvalStatusModel:i[n[0].options.grid.id].approvalStatusModel}}),D.caDependencyModel.get("upstreamDependencyObjects").dependencyLinks.forEach((e=>{e.id.replace("pid:","")==n[0].options.grid.id&&(e.state=n[0].options.grid.maturity,e.stateNLS=n[0].options.grid.maturityNLS,e.ApprovalStatus=n[0].options.grid.ApprovalStatus,e.approvalStatusModel=n[0].options.grid.approvalStatusModel)})),D.caDependencyModel.get("downstreamDependencyObjects").dependencyLinks.forEach((e=>{e.id.replace("pid:","")==n[0].options.grid.id&&(e.state=n[0].options.grid.maturity,e.stateNLS=n[0].options.grid.maturityNLS,e.ApprovalStatus=n[0].options.grid.ApprovalStatus,e.approvalStatusModel=n[0].options.grid.approvalStatusModel)}))}}};return D.globalSubscribeForCADependenciesGridView(),D})),define("DS/ENOChangeActionUX/scripts/CACommonIgnore",["UWA/Core","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgErrors","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChgServices/scripts/services/ChgInfodialog","DS/UIKIT/Mask","require"],(function(e,t,i,n,o,a,s){"use strict";return{ignoreNodes:function(e,i,s,r){var l=n.ECM_CA_Realized_Ignore_Change_Content+"<br><br>",c=[{label:n.ECM_CA_OK_Button_Label,handler:function(){"undefined"!=i&&null!=i&&a.mask(i),t.ignoreChangeRealized(e,s,r),o.closeDialog()},className:"primary"},{label:n.ECM_CA_Cancel,handler:function(){o.closeDialog()},className:"default"}],d={title:n.ECM_CA_Realized_Ignore_Change,content:l,buttonArray:c};o.launchInfoDailog(d)}}})),define("DS/ENOChangeActionUX/scripts/Views/CACustomSeverityView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],(function(e,t,i,n,o){"use strict";var a=t.extend({tagName:"div",domEvents:{},id:function(){return"CACustomSeverityView_"+this.cid},setup:function(e){this._parent.apply(this,arguments)},render:function(){this.container.empty(!0);var t=this;t.model.set("severity","Low"),this.SevButtonGroupDiv=e.createElement("div",{class:"form-group",html:[{tag:"h5",html:o.ECM_CA_Severity,styles:{"margin-bottom":"3px"}}]});var a=new n({type:"radio",name:"Severity",id:"Severity",buttons:[new i({value:o.ECM_CA_Severity_Low,id:"Low",className:"success small",active:!0}),new i({value:o.ECM_CA_Severity_Medium,id:"Medium",className:"warning small"}),new i({value:o.ECM_CA_Severity_High,id:"High",className:"error small"})],events:{onClick:function(e,t){this.dispatchEvent("onButtonClick",t),console.log(t)}}});a.inject(this.SevButtonGroupDiv);var s=this.ButtonEvents={onButtonClick:function(e){t.model.set("severity",e.getValue())}};return this.listenTo(a,s),this.SevButtonGroupDiv.inject(this.container),this},destroy:function(){this._parent.apply(this,arguments)}});return a})),define("DS/ENOChangeActionUX/scripts/CAMakeDroppable",["DS/DataDragAndDrop/DataDragAndDrop","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/UIKIT/Mask","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],(function(e,t,i,n,o){"use strict";var a={makeDroppable:function(n,s){e.droppable(n,{drop:function(e,r,l){if(l.stopPropagation&&l.stopPropagation(),l.preventDefault&&l.preventDefault(),l.dataTransfer&&l.dataTransfer.dropEffect&&(l.dataTransfer.dropEffect="copy"),UWA.is(e)&&""!=e){var c=JSON.parse(e),d=i.checkTenantInforamation(c);if(0!=d.TenantInfoMissing.length)t.error(o.CHG_GOV_Pref_PlatformMissing_Error);else if(0!=d.DiffTenantData.length)t.error(o.CHG_GOV_Pref_PlatformDoesNotMatch_Error);else{c=i.removeDuplicatesToBeDroppedObjects(c);var p=i.filterBasedOnServiceId(c);if(p.incorrectServiceInfo&&Array.isArray(p.incorrectServiceInfo)&&p.incorrectServiceInfo.length>0){var u=o.CHG_GOV_WARN_DROP_SKIPPED+"<br/>";for(var h in p.incorrectServiceInfo)u+=p.incorrectServiceInfo[h]+"<br/>";t.warn(u,"false")}a.ExecuteDrop(c,s)}}else t.error(o.CHG_GOV_Drop_Not_Supported);n.setStyle("borderWidth","0px")},over:function(){arguments[0].setStyles({borderStyle:"solid",borderColor:"#368ec4",borderWidth:"1px"})},leave:function(){arguments[0].setStyle("borderWidth","0px")}})},ExecuteDrop:function(e,i){if(e){var n=e.data.items;UWA.is(n)&&UWA.is(n.length)&&n.length>0&&i(n)}else t.error(o.CHG_GOV_Drop_Not_Supported)}};return a})),define("DS/ENOChangeActionUX/scripts/Models/CAActivityModelForDisplayView",["UWA/Class/Model","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","UWA/Core"],(function(e,t,i,n){"use strict";return e.extend({idAttribute:"id",setup:function(){this.addEvent("onChange:activityDisplaySelect",(function(e){this.updateActivityDisplayInfo(e)})),this.addEvent("onChange:activityActual",(function(e){this.updateActivityDisplaySelectInfo(e)}))},parse:function(e){var t=e.model;this.set("canEdit",!0),this.set("operationId",t.get("operationId")),this.set("operationIdx",t.get("operationIdx"));var i={};i.objectID=t.get("objectId").replace("pid:",""),this.set("proposedObject",i),this.updateAllowedActivityInfo(this),UWA.is(t.id)&&(this.set("id",t.id),this.set("isEdit",!0),this.set("activityActual","ChangeStatus"==t.get("activityActual")?t.get("targetState"):t.get("activityActual")),this.updateActivityDisplaySelectInfo(this),this.set("reasonForChange",UWA.String.unescapeHTML(t.get("activityDesc"))))},updateAllowedActivityInfo:function(e){UWA.is(e.get("proposedObject"))&&UWA.is(e.get("proposedObject").objectID)?require(["DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/ENOChgServices/scripts/services/ChgProposedServices"],(function(n,o){var a=e.get("proposedObject").objectID,s=e.get("operationId"),r=[];r.push("pid:"+a);let l=t.getGlobalVariable().IDCard.model.id;o.getAllowedOperationActivity(r,l,s).then((function(t){var o=[];if(t.allowedOperationActivity[a].allowedActivity.forEach((function(e){var s=t.allowedOperationActivity[a].allowedOperation,r=n.getOperationNameOnUI(e);"Release"==e||"Obsolete"==e?r=i.ECM_CA_Proposed_Activity_ChangeMaturity+": "+r:"Modify"==e&&s.includes("Restore")&&(r=i.ECM_CA_Proposed_Activity_ChangeMaturity+": "+i.ECM_CA_Proposed_Activity_State_Restore),"Modify"==e&&s.includes("Restore")?o.push({displayValue:r,actualValue:"Restore"}):o.push({displayValue:r,actualValue:e})})),e.set("activityDisplayOptions",o),!e.get("isEdit")){var s=t.allowedOperationActivity[a].defaultActivity;UWA.is(s)||(s=1==o.length?o[0].actualValue:void 0),e.set("activityActual",s)}}),(function(e){return console.log("Get allowed operation/activity failed"),Promise.reject(e)}))})):(e.unset("activityDisplayOptions"),e.unset("activityActual"))},updateActivityDisplaySelectInfo:function(e){var t=e.get("activityActual");require(["DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices"],(function(n){var o=n.getOperationNameOnUI(t);"Release"!=t&&"Obsolete"!=t||(o=i.ECM_CA_Proposed_Activity_ChangeMaturity+": "+o),"Release(Demote)"==t&&(o=i.ECM_CA_Proposed_Activity_ChangeMaturity+": "+t),"Restore"==t&&(o=i.ECM_CA_Proposed_Activity_ChangeMaturity+": "+t),e.set("activityDisplaySelect",{displayValue:o,actualValue:t},{silent:!0}),e.set("activityDisplay",o)}))},updateActivityDisplayInfo:function(e){var t=e.get("activityDisplaySelect");if(UWA.is(t)&&UWA.is(t.actualValue)){t.actualValue;e.set("activityActual",t.actualValue,{silent:!0}),e.set("activityDisplay",t.displayValue)}}})})),define("DS/ENOChangeActionUX/scripts/Views/CAPopOverBodyView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/UIKIT/Scroller","text!DS/ENOChangeActionUX/scripts/Templates/CAMultipleSelectedProposedTemplate.html"],(function(e,t,i,n,o,a,s){"use strict";return e.extend({init:function(e){this.options=e,this._parent.call(this,e)},setup:function(){"multipleSelectedProposed"===this.options.bodyOf?this.template=s:"flowdownFromMultiple"===this.options.bodyOf&&(this.template=CAFlowdownFromMultipleTemplate)},render:function(){this.options.container.empty(),this.renderer=this.getTemplate(s,this.options.objectsSelected);var e=this.renderer(),t=UWA.createElement("div",{class:"ppoover-body-container-component"});return t.setContent(e),t.inject(this.options.container),this},domEvents:{"click .supp-icon":function(e){var t=e.target.id.split("-")[2].replace("pid:",""),i=this.container.getElement("#selected-proposed-label-obejct-"+t),n=this.container.getElement(".proposed-popover-body");this.dispatchEvent("crossClicked",[t]),setTimeout((function(){i&&n&&n.removeChild(i)}),100)}},getTemplate:function(e,t){var i=o.compile(e),n=[];for(var a in t){var s={},r={},l=t[a];l&&(r={displayText:l.proposedTitle+" "+l.proposedRevision,id:l.proposedId.replace("pid:","")}),s.details=r,n.push(s)}var c={changes:n};return function(){return i(c)}}})})),define("DS/ENOChangeActionUX/scripts/Models/CAFlowDownModel",["UWA/Class/Model","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService"],(function(e,t,i,n,o){"use strict";return e.extend({idAttribute:"id",setup:function(){},parse:function(e){var t=e.model;if(this.set("canEdit",!0),this.set("mode",e.mode),this.set("caType",{displayValue:"Change Action",actualValue:e.defaultCATypeNLS}),UWA.is(t.id)){var i={};this.set("id",t.id),t.set("objectId",t.id),i.objectType=t.get("objectType")?t.get("objectType"):"",i.objectActualName=t.get("synopsis"),void 0!==i.objectActualName&&""!==i.objectActualName||(i.objectActualName=t.get("objectName")),i.objectRev=t.get("revision")?t.get("revision"):"",i.objectName=i.objectActualName+" "+i.objectRev,i.objectID=t.get("objectId")?t.get("objectId").replace("pid:",""):"",i.maturity=t.get("maturity")?t.get("maturity"):"",i.policy=t.get("policy")?t.get("policy"):"",i.image={imageValue:t.get("icon")?t.get("icon"):""},this.set("objectName",i.objectName),this.set("proposedObject",i)}},add:function(e,i,n){var o={},a=this,s=i,r=[s];t.getAdditionObjectInfo(r).then((function(t){o.objectType=t.additionObjectInfo[s].type,o.objectActualName=t.additionObjectInfo[s].synopsis,void 0!==o.objectActualName&&""!==o.objectActualName||(o.objectActualName=t.additionObjectInfo[s].objectName),o.objectRev=t.additionObjectInfo[s].revision,o.objectName=o.objectActualName+" "+o.objectRev,o.objectID=t.additionObjectInfo[s].pid,o.policy=t.additionObjectInfo[s].policy,o.image={imageValue:t.additionObjectInfo[s].icon};var i=a.get(e);UWA.is(i,"object")&&a.unset(e),a.set(e,o)}),(function(e){return console.log("Populate Security Context failed"),Promise.reject(e)}))},remove:function(e,t,i){var n=this.get(e);UWA.is(n,"object")&&(this.unset("operationActual",{silent:!0}),this.unset(e))}})})),define("DS/ENOChangeActionUX/scripts/Views/CACustomTitleView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/UIKIT/Input/Text","UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],(function(e,t,i,n,o){"use strict";var a=t.extend({tagName:"div",domEvents:{},id:function(){return"CACustomSeverityView_"+this.cid},setup:function(e){this._parent.apply(this,arguments)},render:function(){this.container.empty(!0);var t=this;this.TitleDiv=e.createElement("div",{class:"form-group",html:[{tag:"label",html:[{tag:"div",html:[{tag:"sup",html:"*",class:"required-field",styles:{color:"#e87b00","padding-left":"5px",display:"inline"}},{tag:"span",html:o.ECM_CA_Abstract,styles:{display:"inline"}}]}]}]});var n=new i({name:"CA_Title",id:"CA_Title",className:"mandatory_input",value:"",multiline:!1,rows:1,required:!0,placeholder:o.ECM_CA_Abstract_PlaceHolder});return n.elements.input.onkeyup=function(){var e=n.elements.input.value;t.model.set("createObjectTitle",e)},n.elements.input.onblur=function(){var e=n.elements.input;""==e.value?e.style.borderColor="red":e.style.borderColor=""},n.inject(this.TitleDiv),this.TitleDiv.inject(this.container),this},destroy:function(){this._parent.apply(this,arguments)}});return a})),define("DS/ENOChangeActionUX/scripts/Models/CAProposedActivityModel",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChgServices/scripts/services/ChgDataProcess"],(function(e,t,i){"use strict";return e.extend({idAttribute:"id",setup:function(){},fetch:function(e){console.log("fetch called")},parse:function(e){var t={};if(t.id=e.id,t.operationId=e.operationId,t.operationIdx="",t.status=e.status,t.activityActual=e.what.operation,t.activityName=this.getOperationNameOnUI(e.what.operation),t.objectId=e.objectId,e.what["target state"]&&(t.targetState=e.what["target state"]),e.why.comment&&e.why.comment.text){var i=UWA.String.escapeHTML(e.why.comment.text);t.activityDesc=i}else t.activityDesc="";return t},getOperationNameOnUI:function(e){var i="";switch(e){case"None":case"Modify":i=t.ECM_CA_Proposed_Activity_Modify;break;case"NewVersion":i=t.ECM_CA_Proposed_Operation_Revision;break;case"NewMinorVersion":i=t.ECM_CA_Proposed_Operation_MinorRevision;break;case"NewEvolution":i=t.ECM_CA_Proposed_Operation_Evolution;break;case"Create":i=t.ECM_CA_Proposed_Operation_Create;break;case"ChangeStatus":i=t.ECM_CA_Proposed_Activity_ChangeStatus;break;case"Release":i=t.ECM_CA_Proposed_Activity_State_Release;break;case"Obsolete":i=t.ECM_CA_Proposed_Activity_State_Obsolete;break;default:i="??Something went wrong??"}return i}})})),define("DS/ENOChangeActionUX/scripts/CAWidgetConfiguration",["DS/ENOjquery/ENOjquery","DS/MessageBus/MessageBus","DS/PlatformAPI/PlatformAPI","DS/EditPropWidget/models/EditPropModel","DS/ENOChgServices/scripts/services/ChgPropertiesServices","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgNativeInitService"],(function(e,t,i,n,o,a,s){"use strict";var r={setupIntercomConnections:function(e,t,i){t.compassSocketName=i+"EventSocket",t.compassSocket=new t.InterCom.Socket(t.compassSocketName),t.compassSocket.subscribeServer("com.ds.compass",window.parent),t.prefIntercomServer=new t.InterCom.Server("changeaction.intercom.server"),t.prefIntercomServer.addListener("onAddPref",(function(i,n){if("RefreshMe"!=i.name){i.value?e.setValue(i.name,i.value):e.deleteValue(i.name);i.name.split("changeaction-preference_")}else t.onRefresh()}))},onClickItem:function(t,r){var l,c,d,p,u,h,m=a.getGlobalVariable().collabspace;d=(p=e(this)).hasClass("selected"),c=p.attr("data-pid"),p.attr("data-type"),h=p.attr("data-selectedItem");var g=JSON.parse(h);if(UWA.is(g.Instanceid)&&(c=g.Instanceid),d){-1===a.getGlobalVariable().arrOid.indexOf(c)&&a.getGlobalVariable().arrOid.push(c),c=a.getGlobalVariable().arrOid[a.getGlobalVariable().arrOid.length-1]}else{for(var f in a.getGlobalVariable().arrOid)if(a.getGlobalVariable().arrOid[f]===c){a.getGlobalVariable().arrOid.splice(f,1);break}if(0==a.getGlobalVariable().arrOid.length){if(u=null,c=null,s.DispatchEventToWin("Add_to_CSO",a.getGlobalVariable().arrOid.toString()),a.getGlobalVariable().is3DSpace)if(C=window.top)(v=C.findFrame(window.top,"detailsDisplay"))&&(v.ids=""),getTopWindow().ds&&emxUICore.setIdtoCompass()}else c=a.getGlobalVariable().arrOid[a.getGlobalVariable().arrOid.length-1]}if(c){var C,v;if(u=c,a.getGlobalVariable().is3DSpace)if(C=window.top)(v=C.findFrame(window.top,"detailsDisplay"))&&(v.ids="",v.ids="~|"+c+"~"),getTopWindow().ds&&emxUICore.setIdtoCompass();l={objectId:c,envId:a.getGlobalVariable().tenant,contextId:null!=m?m.replace("ctx::",""):""},r.compassSocket.dispatchEvent("onSetObject",l,r.compassSocketName),s.DispatchEventToWin("Add_to_CSO",a.getGlobalVariable().arrOid.toString())}else r.compassSocket.dispatchEvent("onResetObject",{},r.compassSocketName),s.DispatchEventToWin("Remove_From_CSO",c);if(a.getGlobalVariable().is3DSpace){var A=new n({tenant:a.getGlobalVariable().tenant,objectId:u}),w=[];u&&w.push(A);var y=o.getPropertiesComponent();y&&y.initData(w)}else{var b=[];null!=u&&b.push(u);var S={data:{paths:[]}};if(b.length>0&&S.data.paths.push(b),i.publish("DS/PADUtils/PADCommandProxy/select",S),d&&h){var E=JSON.parse(h),_={[E.id]:{id:E.id,name:E.name,title:E.title,type:E.type}},D={metadata:{appId:t.id,appName:t.getValue("appId"),timestamp:Math.floor(Date.now())},data:{paths:[E.id],attributes:_},version:"1.0"};i.publish("DS/Object/select",D);var O={operation:"select",operationVersion:"1.0",appId:t.id,appName:t.getValue("appId"),content:{version:"1.1",id:E.id,name:E.name,title:E.title,type:E.type}};i.publish("webinwin:web:notification",JSON.stringify(O))}}}};return window.CAWidgetConfiguration=r,r})),define("DS/ENOChangeActionUX/scripts/Models/CARealizedModel",["UWA/Class/Model","DS/ENOChangeActionUX/scripts/Models/CARealizedActivityModel","UWA/Class/Promise","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],(function(e,t,i,n){"use strict";var o="Cannot be found";return e.extend({idAttribute:"id",fetch:function(e){var i="Access denied",a=this;this.set("Access",!0),this.id=this.get("where").id;var s=this.get("where").info;this.set("id",this.get("where").id),this.set("operation","Modified"),s.currentNLS!=o&&this.set("maturity",s.currentNLS),s["display name"]!=o&&s["display name"]!=i?(this.set("name",s["display name"]),this.set("objectName",s["display name"]),this.set("objectTitle",s["display name"])):s["display name"]==o?(this.set("name",s.typeNLS),this.set("objectName",s.typeNLS),this.set("objectTitle",n.ECM_CA_Cannot_be_found)):(this.set("name",s.typeNLS),this.set("objectName",s.typeNLS),this.set("objectTitle",n.ECM_CA_Access_Denied)),s.revision!=o?this.set("revision",s.revision):this.set("revision",""),this.set("type",s.typeNLS),this.set("objectType",s.type),""!=this.get("maturity")&&this.get("maturity")!=i&&"Cannot be found"!=this.get("maturity")&&null!=this.get("maturity")||this.set("Access",!1);var r=UWA.is(s.isConfigured)?s.isConfigured:"false";if(this.set("isConfigured",r),UWA.is(this.get("amo"))){var l=new UWA.Class.Collection,c=this.get("amo"),d=this.get("id");Array.isArray(c)&&(c.forEach((function(e){if(null!=l.get(e.id));else{var i=new t(e,{parse:!0});UWA.is(i.get("Afterobject"))&&i.get("Afterobject").id!=d&&(i.get("ActivityDetails")[0].AfterExists=!0,i.get("ActivityDetails")[0].After=i.get("Afterobject")),UWA.is(i.get("Beforeobject"))&&i.get("Beforeobject").id!=d&&(UWA.is(i.get("Afterobject"))?UWA.is(i.get("Afterobject"))&&i.get("Afterobject").id!=i.get("Beforeobject").id&&(i.get("ActivityDetails")[0].BeforeExists=!0,i.get("ActivityDetails")[0].Before=i.get("Beforeobject")):(i.get("ActivityDetails")[0].BeforeExists=!0,i.get("ActivityDetails")[0].Before=i.get("Beforeobject"))),i.get("ActivityDetails")[0].AfterExists||i.get("ActivityDetails")[0].BeforeExists||(i.get("ActivityDetails")[0].sameAsWhere=!0),"false"==a.get("isConfigured")?(a.set("status",i.get("status"),{silent:!0}),a.set("receivingChangeAction",i.get("receivingChangeAction"),{silent:!0}),a.set("transferReason",i.get("transferReason"),{silent:!0}),a.set("transferReasonNLS",i.get("transferReasonNLS"),{silent:!0})):i.get("ActivityDetails").forEach((function(e){e.TransferExists=!0})),l.add(i)}})),this.set("activities",l,{silent:!0}))}return e.ajax=function(e,t){t.onComplete({})},e.url="dummyURL",this._parent(e)},parse:function(e){var t="Access denied",i=[],a=this.get("activities");UWA.is(a)?(a.forEach((function(e,t){UWA.is(e.get("Afterobject"))&&UWA.is(e.get("Afterobject").id)&&i.push(e.get("Afterobject").id.replace("pid:","")),UWA.is(e.get("Beforeobject"))&&e.get("Beforeobject").id&&i.push(e.get("Beforeobject").id.replace("pid:",""))})),UWA.is(e)&&UWA.is(e.additionObjectInfo)&&(i.forEach((function(i){a.forEach((function(a,s){UWA.is(a.get("Afterobject"))&&(UWA.is(a.get("Afterobject").id)&&i==a.get("Afterobject").id.replace("pid:","")&&UWA.is(e.additionObjectInfo[i])?(a.get("Afterobject").name=e.additionObjectInfo[i].objectName,a.get("Afterobject").title==o?a.get("Afterobject").title=n.ECM_CA_Cannot_be_found:a.get("Afterobject").title==t?a.get("Afterobject").title=n.ECM_CA_Access_Denied:a.get("Afterobject").title=e.additionObjectInfo[i].objectTitle,a.get("Afterobject").icon=e.additionObjectInfo[i].icon,a.get("Afterobject").collabSpace=e.additionObjectInfo[i].collabSpace,a.get("Afterobject").ownerFullname=e.additionObjectInfo[i].ownerFullname):UWA.is(a.get("Afterobject").id)||(a.get("Afterobject").title=n.ECM_CA_Cannot_be_found)),UWA.is(a.get("Beforeobject"))&&(UWA.is(a.get("Beforeobject").id)&&i==a.get("Beforeobject").id.replace("pid:","")&&UWA.is(e.additionObjectInfo[i])?(a.get("Beforeobject").name=e.additionObjectInfo[i].objectName,a.get("Beforeobject").title==o?a.get("Beforeobject").title=n.ECM_CA_Cannot_be_found:a.get("Beforeobject").title==t?a.get("Beforeobject").title=n.ECM_CA_Access_Denied:a.get("Beforeobject").title=e.additionObjectInfo[i].objectTitle,a.get("Beforeobject").icon=e.additionObjectInfo[i].icon,a.get("Beforeobject").collabSpace=e.additionObjectInfo[i].collabSpace,a.get("Beforeobject").ownerFullname=e.additionObjectInfo[i].ownerFullname):UWA.is(a.get("Beforeobject").id)||(a.get("Beforeobject").title=n.ECM_CA_Cannot_be_found))}))})),this.unset("activities",{silent:!0}),this.set("activities",a))):(this.set("amo",e.amo),this.set("where",e.where));return this},enrichActivities:function(e){return new i((function(t,n){var o=[];e.get("activities").forEach((function(e,t){UWA.is(e.get("Afterobject"))&&UWA.is(e.get("Afterobject").id)&&1==e.get("Afterobject").Access&&o.push(e.get("Afterobject").id.replace("pid:","")),UWA.is(e.get("Beforeobject"))&&UWA.is(e.get("Beforeobject").id)&&1==e.get("Beforeobject").Access&&o.push(e.get("Beforeobject").id.replace("pid:",""))})),o.length>0&&require(["DS/ENOChgServices/scripts/services/ChgIDCardCommonServices"],(function(e){e.getAdditionObjectInfo(o).then((function(e){t(e)}),(function(e){return console.log("failed from getting additional info"),i.reject(e)}))}))}))}})})),define("DS/ENOChangeActionUX/scripts/Collection/CARealizedCollection",["UWA/Core","UWA/Class/Collection","DS/ENOChangeActionUX/scripts/Models/CARealizedModel"],(function(e,t,i){"use strict";return t.extend({model:i,setup:function(){},fetch:function(e){var t;return t=e.data=this.operations=e.RealizedArr,e.ajax=function(e,i){i.onComplete(t)},this.url="dummyURL",this._parent(e)}})})),define("DS/ENOChangeActionUX/scripts/Views/CAFlowDownRealizedForm",["DS/E6WCommonUI/Views/DetailsDisplayView","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","UWA/Date","UWA/Controls/Abstract","DS/PlatformAPI/PlatformAPI","DS/UIKIT/Input/Button","DS/ENOChangeActionUX/scripts/Search","DS/ENOChangeActionUX/scripts/Models/CAFlowDownModel","DS/ENOChangeActionUX/scripts/Views/CACustomTitleView","DS/ENOChangeActionUX/scripts/Views/CACustomSeverityView","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgErrors","DS/TransientWidget/TransientWidget","DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController","require"],(function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A){"use strict";var w=a.extend({displayViewModel:null,proposedCallback:null,selectedOperation:null,detailsView:null,allCATypes:[],init:function(t){var i=this;i.allCATypes=[],1==h.getGlobalVariable().changeActionSubTypePresent&&h.getGlobalVariable().changeActionSubTypes.forEach((function(e){var n={};n.actualValue=e.value,n.displayValue=e.label,"Change Action"==e.value&&(t.defaultCATypeNLS=e.label),i.allCATypes.push(n)})),this.proposedCallback=t.callback,this.displayViewModel=new c(t,{parse:!0}),this.detailsView=new e,this.options=t},getHeading:function(){return"Existing"===this.displayViewModel.get("mode")?t.ECM_CA_FLOWDOWN_TO_EXISTING:"NewCA"===this.displayViewModel.get("mode")?t.ECM_CA_FLOWDOWN_TO_NEW:void 0},getBody:function(){var e=this,t=UWA.createElement("div",{id:"formBody"}),i=UWA.Class.View.extend({setup:function(){"Existing"===e.options.mode&&this.listenTo(this.model,"onChange",this.render),this.listenTo(this.model,"onChange:createObjectTitle",e.updateBtnState)},render:function(){t.setContent(""),e.detailsView.setConfig(e.getConfig()),e.detailsView.model=e.displayViewModel,e.detailsView.tenant=h.getGlobalVariable().tenant,e.detailsView.context=enoviaServer.context,e.detailsView.render().inject(t),arguments&&arguments.length>0&&e.updateBtnState(arguments[0])}});new i({model:e.displayViewModel}).render();return t},getConfig:function(){var e,i=[];e=new Date;var n,o="";o=o+"NOT ("+this.options.contextCAId.replace("pid","physicalid")+")";var a=new l({title:"Change Action",precond:n='AND (current:Prepare OR current:"In Work") AND (NOT flattenedtaxonomies:"interfaces/Change On Hold")',excludeList:o,from:"realized",types:"Change Action"},!1);return"Existing"===this.displayViewModel.get("mode")&&i.push({readWrite:!UWA.is(this.displayViewModel.id),type:"object",name:"proposedObject",label:t.ECM_CA_Widget_Title,attributeToDisplay:"objectName",singleObjectOnly:!0,searchTitle:t.ECM_CA_Widget_Title,searchTypes:"Change Action",required:!UWA.is(this.displayViewModel.id),imageAttribute:"image",typeAheadCallback:this.displayViewModel.proposedTypeAheadCallback,fieldHTMLId:"proposedObject",excludeSearchTypes:o+n,search:a}),"NewCA"===this.displayViewModel.get("mode")&&(1==h.getGlobalVariable().changeActionSubTypePresent&&i.push({required:!0,readWrite:"true",name:"caType",label:t.ECM_CA_Type,type:"select",values:this.allCATypes}),i.push({required:!0,label:t.ECM_CA_Pref_Title_Label,name:"createObjectTitle",customView:d}),i.push({readWrite:"true",name:"descriptionOfObj",label:t.ECM_CA_Realized_Transfer_Description,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3}),i.push({label:t.ECM_CA_Realized_Transfer_Severity,name:"severity",customView:p}),i.push({label:t.ECM_CA_Realized_Transfer_DueDate,name:"dueDate",readWrite:"true",type:"date",min:e})),i},getFooter:function(){var e=this,i=w.footer=UWA.Element("div",{});new r({value:t.ECM_CA_Realized_Flowdown_OK,className:"primary proposedButtons",disabled:!0}).inject(i).elements.input.onclick=function(){e.onSaveButtonClick()};new r({value:t.ECM_CA_Realized_Transfer_Cancel,className:"proposedButtons"}).inject(i);return i},onSaveButtonClick:function(){s.subscribe("dependency:update:UX"+widget.id,(function(){v.updateUX(),s.unsubscribe("dependency:update:UX"+widget.id)}));var e=function(e){try{let t=A("DS/ENOChgProbes/scripts/ChgCloudProbeUtils");var i;i="attribute_EstimatedCompletionDate"==e.changeaction.attributes[2].name?{type:e.changeaction.type,isKindOfType:"Change Action",dueDate:e.changeaction.attributes[2].value}:{type:e.changeaction.type,isKindOfType:"Change Action",dueDate:""},t.cloudProbeUtils.sendChgObjectCreateTrackerEvent({createData:i,View:"Flowdown"})}catch(e){console.log(e)}var n=g.getCurrentModel(),o="";o=n?n.get("synopsis"):"attribute_Synopsis"==e.changeaction.attributes[0].name?e.changeaction.attributes[0].value:"",e&&e.changeaction&&f.success(t.ECM_DOWNSTREAM_FLOWDOWN_DEPENDENCY_SUCCESS+": "+o,!1),u.endWait(widget.body)};if(this.detailsView.isModelValid()){if("NewCA"===this.displayViewModel.get("mode")){var i=this.getCreateEditData(this.displayViewModel),n=this.getFlowDownData(this.displayViewModel);i.originChangeActionId=this.options.contextCAId,m.flowDownToNewChangeAction(i,n,e)}else if("Existing"===this.displayViewModel.get("mode")){n=this.getFlowDownData(this.displayViewModel);var o={id:"pid:"+this.displayViewModel.get("proposedObject").objectID,name:this.displayViewModel.get("proposedObject").objectActualName,originChangeActionId:this.options.contextCAId};m.flowDownToExistingChangeAction(o,n,e)}u.doWait(widget.body)}else f.error(t.ECM_CA_Realized_Transfer_MandAttrErr)},getCreateEditData:function(e){var t="";if(UWA.is(e)){var i=e.get("createObjectTitle"),n=e.get("descriptionOfObj");n||(n="");var a=e.get("severity"),s="";if(UWA.is(e.get("dueDate"))){var r,l;r=e.get("dueDate").actualValue,s=(l=new Date(r)).getMonth()+1+"/"+l.getDate()+"/"+l.getFullYear();var c=o.strftime(new Date(s),"%Y-%m-%d")}var d="Change Action";1==h.getGlobalVariable().changeActionSubTypePresent&&(d=e.get("caType").actualValue),t={type:d,description:n,synopsis:i,severity:a,scheduledCompletionDate:c}}return t},getFlowDownData:function(e){return{idsToFlowdown:this.options.ids}},updateBtnState:function(){var e=arguments[0];if(e){var t,i=e.get("createObjectTitle"),n=e.get("proposedObject");if(i&&""!=i.trim()||n&&""!=n.objectID){if(w.footer)(t=w.footer).firstChild.disabled=!1,t.firstChild.removeClassName("disabled")}else if(w.footer)(t=w.footer).firstChild.disabled=!0,t.firstChild.addClassName("disabled")}}});return w})),define("DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChangeActionUX/scripts/Collection/CARealizedCollection","DS/ENOChangeActionUX/scripts/Models/CARealizedModel","DS/ENORIPE_Relations/RelationsTabSettings","DS/ENORIPE_Relations/views/RelationsTab","DS/ENOFloatingPanel/ENOFloatingPanel","DS/ENOChangeActionUX/scripts/Views/CAFlowDownRealizedForm","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgDataService","DS/UIKIT/Popover","DS/ENOChangeActionUX/scripts/Views/CAPopOverBodyView","DS/PlatformAPI/PlatformAPI","UWA/Utils/InterCom","DS/ENOChgServices/scripts/services/ChgErrors","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],(function(e,t,i,n,o,a,s,r,t,l,c,d,p,u,h,m,g,f){var C={proposedFlowdownMapping:{},selectedProposedItems:{},flowdownForInfo:[],flowdownandForInfo:[],createRealizedCollection_space:function(e,t){var i=new UWA.Class.Collection;return Array.isArray(e)&&e.forEach((function(e){if(null!=i.get(e.where.id));else{var t=new n(e);t.fetch({}),i.add(t)}})),i},createRealizedCollection:function(e,n){if(t.getGlobalVariable().is3DSpace)return this.createRealizedCollection_space(e,n);var o={RealizedArr:e},a=new i;return a.fetch(o),a.forEach((function(e){e.fetch(o)})),a},loadRelationsExplorer:function(e){let i=[e.model.get("id").substr(4)],n=t.getGlobalVariable().getSecurityContext(),o=widget.id,a="ENORIPE-InApp-"+o,s=a+"/onOK",r=a+"/onCancel";h.unsubscribe(s),h.unsubscribe(r);let l=[];i.forEach((function(e){var i={envId:t.getGlobalVariable().tenant,serviceId:"3DSpace",contextId:n,objectId:e.replace("pid:","")};l.push(i)}));var c=widget.getValue("appId");c||(c="ENOWCHA_AP"),h.subscribe(s,(function(t){var i=[];let n=[];for(let e in t)n.push(t[e].id);d.getObjectInfo(n,["type","name","title","revision"]).then((function(t){console.log(t);for(let e in t){var n=t[e],o={proposedId:n.id,proposedTitle:n.dataelements.title,objName:n.dataelements.name,proposedRevision:n.dataelements.revision};i.push(o)}if(C[e.idToSetObjs]){C[e.idToSetObjs].fromRelationsTab||(C[e.idToSetObjs].fromRelationsTab=[]);var a=C[e.idToSetObjs].fromRelationsTab.map((function(e){return e.proposedId}));for(var s in i){(o=i[s])&&a&&-1===a.indexOf(o.proposedId)&&C[e.idToSetObjs].fromRelationsTab.push(o)}}else C[e.idToSetObjs]={fromRelationsTab:i};e.callback(C[e.idToSetObjs])}))})),h.subscribe(r,(function(e){console.log("Cancel button clicked...!")}));var p={protocol:"3DXContent",version:"1.1",source:c,widgetId:widget.id,inAppMode:!0,inAppOptions:{relationSet:"AutoModeProfile",localUID:o},data:{items:l}},u=UWA.is(widget)&&widget.id?"caCompassSocket_"+widget.id:"caCcompassSocket";this._compass_socket||(this._compass_socket=new m.Socket(u),this._compass_socket.subscribeServer("com.ds.compass",t.getGlobalVariable().compassWindow)),this._compass_socket.dispatchEvent("onSetX3DContent",p,u);var g={appId:"ENORIPE_AP"};this._compass_socket.dispatchEvent("onLaunchApp",g,u)},loadRelationsTab:function(e){h.unsubscribe("DS/PADUtils/PADCommandProxy/select");var i=this,n=e.model.get("id").substr(4),r=new UWA.Class.Model({source:"3DSpace",tenant:t.getGlobalVariable().tenant,objectId:n,id:n}),l={getPlatformID:function(){return t.getGlobalVariable().tenant},getServiceID:function(){return"3DSpace"}};o.isAvailable(l,{isDraggable:!0,isProfilesVisible:!0,appID:"ENORIPE_ECM",isExternal:!0}).then((function(t){var n=e.model.get("objectInfo"),o=new s({animate:!0,autocenter:!0,closable:!0,limitParent:!1,overlay:!1,resizable:!0,visible:!0,header:"<h4>"+f.ECA_CA_RELATIONAL_EXPLORER_HEADING+" - "+n+"</h4>",footer:"<button type='button' class='btn btn-primary'>"+f.ECM_CA_Close+"</button> ",events:{onClose:function(){}}});o.getContent().getElements(".btn").forEach((function(e){e.addEvent("click",(function(){o.hide()}))}));var l=new UWA.createElement("div",{styles:{height:"500px",width:"500px"}});l.inject(o.elements.body),o.inject(widget.body).show(),i.facetRelationsModule=new a,i.facetRelationsModule.updateFacetExternal(r),i.facetRelationsModule.elements.container.inject(l),h.subscribe("DS/PADUtils/PADCommandProxy/select",(function(t){if(widget&&t&&t.data){var i=t.data.paths;if(i&&Array.isArray(i)){var n=[];for(var o in i){var a=i[o],s=t.data.attrData;if(s)for(var r in s){var l=s[r];if(l.id===a[0]){var c={proposedId:l.id,proposedTitle:l.name,objName:l.name,proposedRevision:l.revision};n.push(c)}}}if(C[e.idToSetObjs]){C[e.idToSetObjs].fromRelationsTab||(C[e.idToSetObjs].fromRelationsTab=[]);var d=C[e.idToSetObjs].fromRelationsTab.map((function(e){return e.proposedId}));for(var o in n){(c=n[o])&&d&&-1===d.indexOf(c.proposedId)&&C[e.idToSetObjs].fromRelationsTab.push(c)}}else C[e.idToSetObjs]={fromRelationsTab:n};e.callback(C[e.idToSetObjs])}}}))}))},launchSearchForSelectedProposed:function(e){if(t.getGlobalVariable().isNative){this.callbackForAddSelectedProposed=e.callback,this.objectIDSelected=e.idToSetObjs;c.DispatchEventToWin("Search_Flowdown_Proposed","SearchFlowdownProposed")}else{C.OnSearchComplete=C.OnSearchComplete.bind(this),this.callbackForAddSelectedProposed=e.callback,this.objectIDSelected=e.idToSetObjs;var i=C.SearchObj=l.activateSearch(t.getGlobalVariable().proposedSearchType,"multiple_proposed");l.search(f.ECM_SELECTED_PROPOSED_OBJECTS,t.getGlobalVariable().proposedSearchType,C.OnSearchComplete,"multiple_proposed",i)}},OnSearchComplete:function(e){if(t.getGlobalVariable().isNative){for(var i=e.split("~"),n=[],o=0;o<i.length;o++)n.push(i[o]);for(var a=[],s=0;s<i.length;s++)a.push(n[s].split(","));var r=[];for(o=0;o<a.length;o++){var l={proposedId:(c=a[o])[0],objName:c[1],proposedTitle:c[2],proposedRevision:c[3]?c[3]:""};r.push(l)}}else for(r=[],o=0;o<e.length;o++){var c;l={objName:(c=e[o])[1],proposedId:c[0],proposedTitle:c[5],proposedRevision:c[6]?c[6]:""};r.push(l)}C[this.objectIDSelected]?(C[this.objectIDSelected].fromFreeSearch||(C[this.objectIDSelected].fromFreeSearch=[]),C[this.objectIDSelected].fromFreeSearch=C[this.objectIDSelected].fromFreeSearch.concat(r)):C[this.objectIDSelected]={fromFreeSearch:r},this.callbackForAddSelectedProposed(C[this.objectIDSelected])},buildPanelForFlowdownRealized:function(t){var i=t.contextObj,n=t.moreInfo;if(n){var o={ids:n.ids,contextCAId:i.model.get("id"),mode:n.mode,Entity:"ChangeAction",model:new UWA.Class.Model};o.callback=i.AfterSaveTransReal;var a=new r(o),l=new s({animate:!0,autocenter:!0,closable:!0,limitParent:!1,overlay:!1,resizable:!0,visible:!0,header:"<h4> Flowdown to new Change Action</h4>",footer:"<button type='button' class='btn btn-primary'>Close</button> ",events:{onClose:function(){}}});l.getContent().getElements(".btn").forEach((function(e){e.addEvent("click",(function(){l.hide()}))}));var c=new UWA.createElement("div",{styles:{height:"500px",width:"500px"}});c.inject(l.elements.body);e.extendElement(document.body).getElement("#skeleton-container");l.inject(widget.body).show(),a.getBody().inject(c)}},setSelectedProposedPerRealizedObject:function(e){this.selectedproposedObjectsArr=[],this.selectedproposedObjectsArr=e},getSelectedProposedPerRealizedObject:function(){return this.selectedproposedObjectsArr},setFlowdownForInfo:function(e){this.flowdownForInfo.push(e)},getFlowdownForInfo:function(){return this.flowdownForInfo},setInfoForSelectedItem:function(e){var t=Object.keys(e);for(var i in t){var n=e[t[i]];this.flowdownandForInfo[t[i]]=n}},getInfoForSelectedItem:function(){return this.flowdownandForInfo},setSelectedObjectIds:function(e){this.selectedObjectIds||(this.selectedObjectIds=[]),-1===this.selectedObjectIds.indexOf(e)&&this.selectedObjectIds.push(e)},getSelectedObjectIds:function(){return this.selectedObjectIds},setflowdownActivityPointer:function(e){this._flowdownActivityPointer=e},getflowdownActivityPointer:function(){return this._flowdownActivityPointer},setflowdownOperationPointer:function(e){this._flowdownOperationPointer=e},getflowdownOperationPointer:function(){return this._flowdownOperationPointer}};return C})),define("DS/ENOChangeActionUX/scripts/CreateCAForm",["DS/UIKIT/Input/Text","UWA/Core","UWA/Date","DS/UIKIT/Form","DS/UIKIT/Input/Button","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/UIKIT/Modal","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Input/Date","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOjquery/ENOjquery","DS/UIKIT/Input/Select","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices","DS/ENOChangeActionUX/scripts/Services/ChgChangeActionServices","DS/ENOChgServices/scripts/services/ChgProposedServices","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS","css!DS/ENOChangeActionUX/ENOChangeActionUX"],(function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w){"use strict";var y={CACreateModal:void 0,onCloseCallback:null,severityButtonGroup:null,currentModelObjectForRefresh:void 0,createOrEditFlag:!0,calendarOnClickDueDate:function(e){t.extendElement(document.body).getElement("#DueDate").click()},pushFormContentOnHide:function(){y.formFieldContent.reset(),y.formFieldContent.unvalidate(),null!=y.onCloseCallback&&null!=y.onCloseCallback&&event&&event.srcElement&&event.srcElement.className&&event.srcElement.className.contains("fonticon-cancel")&&y.onCloseCallback()},dueDateOnChange:function(){var e=t.extendElement(document.body).getElement("#DueDate"),n=t.extendElement(document.body).getElement("#DueDate_hidden");if(e.value){var o="%m/%d/%Y";n.value=i.strftime(this.getDate(),o),o="%Y-%m-%d",e.value=i.strftime(this.getDate(),o)}else e.value="",n.value="";var a=u("#duedatecancel"),s=u("#calenderspan");a&&(a.css("display","block"),a.css("visibility","visible")),s&&s.css("display","none")},createBody:function(e){var t=e&&e.changeaction?e.changeaction.title:void 0,i=e&&e.changeaction?e.changeaction.description:void 0,n=!0,s=!1,l=!1;switch(e&&e.changeaction?e.changeaction.severity:void 0){case"Medium":n=!1,s=!0;break;case"High":n=!1,l=!0}var c=UWA.createElement("div",{html:[{tag:"div",id:"AbstractDiv",styles:{"margin-bottom":"15px","font-size":"14px"},html:[{tag:"div",class:"label-container",html:[{tag:"h5",html:a.ECM_CA_Abstract},{tag:"span",class:"mand-asterisk fonticon fonticon-asterisk-alt"}]},{tag:"div",html:UWA.createElement("div",{class:"form-group",html:y.createTextField("Abstract",t)})}]},{tag:"div",id:"DescriptionDiv",styles:{"margin-bottom":"15px","font-size":"14px"},html:[{tag:"div",class:"label-container",html:[{tag:"h5",html:a.ECM_CA_Description}]},{tag:"div",html:UWA.createElement("div",{class:"form-group",html:y.createTextField("Description",i)})}]},{tag:"div",id:"SeverityDiv",styles:{"margin-bottom":"15px","font-size":"14px"},html:[{tag:"h5",html:a.ECM_CA_Severity},{tag:"div",html:UWA.createElement("div",{class:"form-group",html:y.severityButtonGroup=new r({type:"radio",name:"Severity",id:"Severity",buttons:[new o({value:a.ECM_CA_Severity_Low,id:"Low",className:"success small",active:n}),new o({value:a.ECM_CA_Severity_Medium,id:"Medium",className:"warning small",active:s}),new o({value:a.ECM_CA_Severity_High,id:"High",className:"error small",active:l})]})})}]},{tag:"div",id:"DueDateDiv",styles:{"margin-bottom":"15px","font-size":"14px"},html:[{tag:"h5",html:a.ECM_CA_DueDate},{tag:"span",class:"due-date-span",html:y.createDueDateElem()},{tag:"input",type:"hidden",name:"DueDate_hidden",id:"DueDate_hidden",value:""}]}]});if(t&&""!==t.trim()?(y.doneBtn.elements.input.disabled=!1,y.doneBtn.elements.input.removeClassName("disabled"),y.beginWorkBtn.elements.input.disabled=!1,y.beginWorkBtn.elements.input.removeClassName("disabled")):(y.doneBtn.elements.input.disabled=!0,y.doneBtn.elements.input.addClassName("disabled"),y.beginWorkBtn.elements.input.disabled=!0,y.beginWorkBtn.elements.input.addClassName("disabled")),1==p.getGlobalVariable().changeActionSubTypePresent){var d=y.createSubTypeField();c.prepend(d)}return c},createSubTypeField:function(){var e=p.getGlobalVariable().changeActionSubTypes;return UWA.createElement("div",{id:"TypeDiv",styles:{"margin-bottom":"15px","font-size":"14px"},html:[{tag:"div",class:"label-container",html:[{tag:"h5",html:a.ECM_CA_Type},{tag:"span",class:"mand-asterisk fonticon fonticon-asterisk-alt"}]},{tag:"div",html:new h({required:!0,id:"CATypeSelect",name:"CATypeSelect",custom:!1,placeholder:!1,options:e})}]})},createTextField:function(t,i){var n=new e({name:t,id:t,className:"Abstract"===t?"mandatory_input":"",value:i||"",multiline:"Abstract"!==t,rows:"Abstract"===t?1:2,required:"Abstract"===t,placeholder:"Abstract"===t?a.ECM_CA_Abstract_PlaceHolder:a.ECM_CA_Description_PlaceHolder});return n.elements.input.onkeyup=function(){var e=y.formFieldContent.getValue("Abstract");e&&""!=e.trim()?(y.doneBtn.elements.input.disabled=!1,y.doneBtn.elements.input.removeClassName("disabled"),y.beginWorkBtn.elements.input.disabled=!1,y.beginWorkBtn.elements.input.removeClassName("disabled")):(y.doneBtn.elements.input.disabled=!0,y.doneBtn.elements.input.addClassName("disabled"),y.beginWorkBtn.elements.input.disabled=!0,y.beginWorkBtn.elements.input.addClassName("disabled"))},n},createDueDateElem:function(){return[{styles:{border:"1px solid #b4b6ba","border-radius":"5px",display:"flex","background-color":"#f4f5f6"},html:UWA.createElement("span",{class:"date-input-container",html:[new l({name:"DueDate",id:"DueDate",required:!1,min:new Date,value:"",placeholder:a.ECM_CA_Date_PlaceHolder,events:{onChange:y.dueDateOnChange}}),{tag:"span",class:"cancel-span",html:y.createCancelBtnSpan()},{tag:"span",class:"calendar-span",html:y.createCalenderSpan()}]})}]},createCalenderSpan:function(){var e=UWA.createElement("span",{class:"fonticon fonticon-calendar",id:"calenderspan"});return e.set({events:{click:function(e){t.extendElement(document.body).getElement("#DueDate").click()}}}),[{html:e}]},createCancelBtnSpan:function(){var e=UWA.createElement("span",{class:"clear-filter fonticon fonticon-cancel-circled",id:"duedatecancel"});return e.set({events:{click:function(e){var t=u("#DueDate"),i=u("#DueDate_Hidden");t&&t.val(""),i&&i.val("");var n=u("#duedatecancel"),o=u("#calenderspan");n&&n.css("display","none"),o&&o.css("display","block")}}}),[{html:e}]},formFieldContent:new n({fields:[{type:"html",name:"CAFormBody",id:"CAFormBody",html:"<div id='CAFormDiv'></div>"}],events:{onInvalid:function(){m.error(a.ECM_CA_MandFieldMissing_error)}}}),physicalIDContainer:new e({name:"PhysicalID",id:"PhysicalID",required:!1,value:"",hide:!0}),CANameContainer:new e({name:"CAName",id:"CAName",required:!1,value:"",hide:!0}),cancelButton:new o({value:a.ECM_CA_Cancel,events:{onClick:function(){y.CACreateModal.hide();var e=y.physicalIDContainer.getValue();""!=e&&y.createOrEditFlag&&(y.createIDCardEdit(e),y.physicalIDContainer.setValue(""))}}}),createCAFromActionBar:function(e,i,n){var o=this,r="",l=p.getGlobalVariable();return new Promise((function(c,p){var u=function(){y.caSubTypesFetched().then((function(l){r=C.getJSONForCACreation(e),o.CACreateModal=null,o.onCloseCallback=n,o.CACreateModal=new s({closable:!0,header:"<h4>"+a.ECM_CA_ChangeAction_Definition+"</h4>",body:y.formFieldContent,footer:[y.createAndAddButton(r,i),y.beginWorkButton(r,i),y.cancelButton],events:{onHide:y.pushFormContentOnHide.bind(y.CACreateModal)}}),o.CACreateModal.inject(widget.body).show();var d=t.extendElement(document.body).getElement("#CAFormDiv");d.innerHTML="",o.createBody(r).inject(d);var p=document.getElementById("Abstract");p&&p.focus();var u=t.extendElement(document.body).getElement("#EditCADiv");u&&u.hide(),y.doneBtn.show(),y.beginWorkBtn.show(),c(y)}),(function(e){console.log("Issue in retrieving subtypes")}))};if(l.tenant||(l.tenant=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise"),l.tenantMappings){for(var h=l.tenantMappings,g=0;g<h.length;g++)l.tenant==h[g].platformId&&(l.baseURL=h[g]["3DSpace"],l.federatedURL=h[g]["3DSearch"]);""!=l.mySecurityContext?u():m.error(A.ECM_CA_Use_Preferences)}else d.populate3DSpaceURL().then((function(e){""!=l.mySecurityContext?u():m.error(A.ECM_CA_Use_Preferences)}),(function(e){console.log("ENOChgActionCMDs: populate base URL failed")}))}))},getCACreateData_v0:function(e){var t=y.getCreateEditData("v0");return null!=e&&(e.changeaction.add.proposed.length>0&&e.changeaction.add.proposed.forEach((function(e){var i={where:{id:"pid:"+e},operation:{name:"Default"}};t.changeaction.proposed.push(i)})),e.changeaction.add.context.length>0&&e.changeaction.add.context.forEach((function(e){t.changeaction.context.push("pid:"+e)})),e.changeaction.add.people.length>0&&(t.changeaction.people=e.changeaction.add.people),e.changeaction.add.referentials.length>0&&e.changeaction.add.referentials.forEach((function(e){t.changeaction.referentials.push("pid:"+e)})),e.changeaction.changeorder&&(t.changeaction.changeorder="pid:"+e.changeaction.changeorder)),t},getCACreateData_v1:function(e){var t=y.getCreateEditData("v1");return null!=e&&(e.changeaction.add.proposed.length>0&&e.changeaction.add.proposed.forEach((function(e){var i={id:e.id,type:e.type,service:e.service};t.data[0].proposed.push(i)})),e.changeaction.add.context.length>0&&e.changeaction.add.context.forEach((function(e){var i={id:e.id,type:e.type,service:e.service};t.data[0].context.push(i)})),e.changeaction.add.people.length>0&&(t.data[0].people=e.changeaction.add.people),e.changeaction.add.referentials.length>0&&e.changeaction.add.referentials.forEach((function(e){var i={id:e.id,type:e.type,service:e.service};t.data[0].referentials.push(i)})),e.changeaction.changeorder&&t.data[0].changeorder.push(e.changeaction.changeorder)),t},createAndAddButton:function(e,t){return y.doneBtn=new o({value:a.ECM_CA_Create,className:"primary",disabled:!0,onCompleteCallback:function(i){c.endWait(y.CACreateModal.getBody()),y.CACreateModal.hide();var n=i;"v1"==e.version&&(n={changeaction:{id:i.data[0].id,type:i.data[0].type}}),t(n)},onFailureCallback:function(e,i){c.endWait(y.CACreateModal.getBody()),t({changeaction:void 0})}}),y.doneBtn.elements.input.onclick=function(){if(y.formFieldContent.validate(!1,!1))if(c.doWait(y.CACreateModal.getBody()),"v0"==e.version){var t=y.getCACreateData_v0(e);d.createCA(JSON.stringify(t),y.doneBtn.options.onCompleteCallback,y.doneBtn.options.onFailureCallback)}else if("v1"==e.version){t=y.getCACreateData_v1(e);d.createCA_v1(JSON.stringify(t),y.doneBtn.options.onCompleteCallback,y.doneBtn.options.onFailureCallback)}},y.doneBtn},cancelButton:new o({value:a.ECM_CA_Cancel,events:{onClick:function(){y.CACreateModal.hide();var e=y.physicalIDContainer.getValue();""!=e&&y.createOrEditFlag&&(y.createIDCardEdit(e),y.physicalIDContainer.setValue("")),null!=y.onCloseCallback&&null!=y.onCloseCallback&&y.onCloseCallback()}}}),beginWorkButton:function(e,t){return y.beginWorkBtn=new o({value:a.ECM_CA_Begin_Work,disabled:!0,onCompleteCallback:function(i){var n=i;"v1"==e.version&&(n={changeaction:{id:i.data[0].id,type:i.data[0].type}});var o=n.changeaction.id.replace("pid:","");f.promoteChangeAction(o,"In Work").then((function(e){if(n.changeaction&&n.changeaction.attributes){var i=n.changeaction.attributes;UWA.is(i)&&i.forEach((function(t){"current"===t.name&&(t.value="In Work"),"currentNLS"===t.name&&(t.value=e.maturity)}))}t(n),c.endWait(y.CACreateModal.getBody()),y.CACreateModal.hide()}),(function(e){return c.endWait(y.CACreateModal.getBody()),y.CACreateModal.hide(),t(n),Promise.reject(e)}))},onFailureCallback:function(e,i){c.endWait(y.CACreateModal.getBody()),t({changeaction:void 0})}}),y.beginWorkBtn.elements.input.onclick=function(){if(y.formFieldContent.validate(!1,!1))if(c.doWait(y.CACreateModal.getBody()),"v0"==e.version){var t=y.getCACreateData_v0(e);d.createCA(JSON.stringify(t),y.beginWorkBtn.options.onCompleteCallback,y.beginWorkBtn.options.onFailureCallback)}else if("v1"==e.version){t=y.getCACreateData_v1(e);d.createCA_v1(JSON.stringify(t),y.beginWorkBtn.options.onCompleteCallback,y.beginWorkBtn.options.onFailureCallback)}},y.beginWorkBtn},addZero:function(e){return e<10&&(e="0"+e),e},getCreateEditData:function(e){y.formFieldContent.getValues();var t=g.sanitizeText(y.formFieldContent.getValue("Abstract")),i=y.formFieldContent.getValue("Description"),n=y.severityButtonGroup.getActive()[0].getId(),o=y.formFieldContent.getValue("DueDate_hidden");if(o&&""!=o&&3==o.split("/").length){var a=o.split("/"),s=new Date;o=a[2]+"/"+a[0]+"/"+a[1]+"@"+y.addZero(s.getUTCHours())+":"+y.addZero(s.getUTCMinutes())+":"+y.addZero(s.getUTCSeconds())+":GMT"}y.formFieldContent.getValue("EstimatedStartDate_hidden"),y.formFieldContent.getValue("ChangeOrder_hidden");var r=y.formFieldContent.getValue("CATypeSelect"),l="";return"v0"==e?l={version:"v0",changeaction:{name:"",revision:"-",type:r=g.sanitizeText(null==r||"Change Action"==r?"type_ChangeAction":"type_"+r),description:i,attributes:[{name:"Synopsis",value:t},{name:"Change.Completion Date Estimated",value:o},{name:"Severity",value:n}],context:[],referentials:[],proposed:[]}}:"v1"==e&&(l={data:[{basic:[{type:r=g.sanitizeText(null==r?"Change Action":r),title:t,sev:n,description:i,dueDate:o}],proposed:[],context:[],referentials:[],people:[]}]}),l},caSubTypesFetched:function(){return new Promise((function(e,t){null!=p.getGlobalVariable().changeActionSubTypes?e():d.fetchCASubTypes(e,t)}))}};return y})),define("DS/ENOChangeActionUX/scripts/Services/CADependenciesViewServices",["UWA/Core","DS/UIKIT/Mask","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOFloatingPanel/ENOFloatingPanel","DS/ENOChangeActionUX/scripts/Views/CAFlowDownRealizedForm","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgErrors","DS/TransientWidget/TransientWidget","require","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],(function(e,t,i,n,o,a,s,r,l,c,d,p){"use strict";var u={addFlowdownDependency:function(e){let t=d("DS/ENOChgProbes/scripts/ChgCloudProbeUtils");var i={},n=e.options.moreInfo.mode;i.commandInfo=n&&"NewCA"===n?{type:"Change Action",facet:"Dependency",action:"CA>Dependency>Add Flowdown>New Change Action"}:{type:"Change Action",facet:"Dependency",action:"CA>Dependency>Add Flowdown>Existing Change Action"},t.cloudProbeUtils.genericCommandClickEventForAnalytics({inputJSON:i}),u.options=e;var o=e.options.moreInfo;s.caDependencyModel.get("dataGridView").getTreeDocument().getSelectedNodes()[0]?l.warn(p.ECM_CA_FLOWDOWN_ADD_TO_CO_ERR_MSG):o&&"NewCA"===o.mode?u.buildPanelForToCreateFlowdownDependency(e):u.addExistingflowdown(e)},buildPanelForToCreateFlowdownDependency:function(e){var t=e.options.contextCAId,a=e.options.moreInfo;if(a){var s={ids:a.ids,contextCAId:t,mode:a.mode,Entity:"ChangeAction",model:new UWA.Class.Model,callback:function(){alert("testing...")}},r=new o(s),l=new n({animate:!0,autocenter:!0,closable:!0,limitParent:!1,overlay:!1,resizable:!0,visible:!0,footer:"",events:{onClose:function(){}}}),c=new UWA.createElement("div");"NewCA"===a.mode&&c.setStyles({height:"500px",width:"auto",overflow:"auto"}),c.inject(l.elements.body),l.inject(widget.body).show(),r.getBody().inject(c),l.elements.header.innerHTML='                    <div class="floatingPanel_Header">                        <div class="floatingPanel_RightButtons">                            <span class="right-actions  fonticon fonticon-cancel" title="Close"></span>                        </div>                        <span class="floatingPanel_title">                            <span>'+r.getHeading()+"</span>                        </span>                    </div>",r.getFooter().inject(l.elements.footer),l.getContent().getElements(".proposedButtons").forEach((function(e){e.addEvent("click",(function(){l.hide()}))})),l.getContent().getElements(".fonticon-cancel").forEach((function(e){e.addEvent("click",(function(){l.hide()}))})),i.getGlobalVariable().isNative&&l.elements.body.getParent(".floatingPanelComponent")&&l.elements.body.getParent(".floatingPanelComponent").setStyle("z-index","9999")}},addExistingflowdown:function(e){var t=d("DS/ENOChgServices/scripts/services/ChgNativeInitService"),n=d("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices");r.subscribe("dependency:update:UX"+widget.id,(function(){s.updateUX(),r.unsubscribe("dependency:update:UX"+widget.id)})),window.addEventListener("storage",(function(e){if(e.storageArea===sessionStorage)if(null!=sessionStorage.searchList&&""!=sessionStorage.searchList){for(var t=sessionStorage.searchList.split(","),i=0;i<t.length;i++){var n={};n.value=t[i],n.label="";var o={0:[n.value]};u.OnSearchComplete(o)}sessionStorage.removeItem("searchList")}else console.log("inside EVENT ******************************************")}));var o=i.getGlobalVariable();if(o.isNative){t.DispatchEventToWin("Add_Flowdown_Dependency","Add_Flowdown_Dependency")}else if(o.is3DSpace){showChooser("../common/emxFullSearch.jsp?field=TYPES=type_ChangeAction:ECM_CHANGE_ON_HOLD!=TRUE:CURRENT!=policy_Cancelled.state_Cancelled&table=AEFGeneralSearchResults&selection=single&formName=BCform&submitAction=refreshCaller&hideHeader=true&HelpMarker=emxhelpfullsearch&submitURL=../enterprisechangemgtapp/ECMWebSearchUtil.jsp?fromOperation=searchDependency",850,630)}else{var a=n.activateSearch("Change Action","Flowdown");n.search("Flowdown","Change Action",u.OnSearchComplete,"Flowdown",a)}},OnSearchComplete:function(e){var t={};if(i.getGlobalVariable().isNative){for(var n=e.split("~"),o=[],s=0;s<n.length;s++)o.push(n[s]);for(var r=[],l=0;l<n.length;l++)r.push(o[l].split(","));var c=[];for(s=0;s<r.length;s++){var d=r[s];c.push("pid:"+d[0])}}else for(c=[],s=0;s<e.length;s++){d=e[s];c.push("pid:"+d[0]),t[c[s]]=d[5]}var p={idsToFlowdown:void 0},h={id:c[0],name:t[c[0]],originChangeActionId:u.options.options.contextCAId};a.flowDownToExistingChangeAction(h,p,u.onSuccessCallback)},onSuccessCallback:function(e){var i=d("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices").getCurrentModel(),n="";n=i?i.get("synopsis"):e.caName?e.caName:"",e&&e.changeaction&&(u.data=e,l.success(p.ECM_DOWNSTREAM_FLOWDOWN_DEPENDENCY_SUCCESS+": "+n,!1)),t.unmask(widget.body)}};return u})),define("DS/ENOChangeActionUX/scripts/Views/CARealizedActivitiesView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/ENOChangeActionUX/scripts/CAWidgetConfiguration","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/ENOChangeActionUX/scripts/CASpinner","DS/TransientWidget/TransientWidget","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgRouter5/scripts/ChgRouter","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENOChangeActionUX/scripts/CACommonIgnore"],(function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v){"use strict";o.registerHelper("getActivityDetails",(function(e,i){var n="Cannot be found",o="";if(p.getGlobalVariable().is3DSpace,UWA.is(e)){if(e.BeforeExists&&e.AfterExists?o+='<div class="Realized-activity-tile-newline">':o+='<div class="Realized-activity-tile-inline">',o+='<div class="Realized-activity-tile">',"AddInFamily"==e.actName){if(e.AfterExists){if(o+='<div class="Realized-activity-After">',UWA.is(e.AfterGrammar)&&""!=e.AfterGrammar&&(o=o+'<div class="Realized-activity-After-Grammar">'+e.AfterGrammar+"</div>"),UWA.is(e.AfterMaturity)&&""!=e.AfterMaturity)o=o+'<div class="Realized-activity-After-Maturity">'+e.AfterMaturity+"</div>";else if(UWA.is(e.After)){var a=UWA.is(e.After.id)?e.After.id.substr(4):"",s=UWA.is(e.After.Instanceid)?e.After.Instanceid.substr(4):a,r=e.After.title.replace("<","&lt;");UWA.is(r)&&""!=r||(r=e.After.name.replace("<","&lt;"));var l=UWA.is(e.After.instanceName)&&""!=e.After.instanceName?"("+e.After.instanceName.replace("<","&lt;")+")":"";o=o+'<div class="Activity-box Access'+e.After.Access+' id="drag-'+e.After.id+'" draggable="true" >',UWA.is(e.After.type)&&e.After.type!=n&&(o=o+'<div class="Realized-checked-action"><input type="checkbox" class="checkbox-Before" id="checkbox-Before-'+e.After.id+'"Instanceid='+s+"></div>",o=(o+='<div class="Realized-activity-After-icon-div">')+'<img class="Realized-activity-After-icon" id="Realized-activity-After-icon-'+e.After.id+'" src ='+e.After.icon+"></img></div>"),o=(o=(o=o+'<div class="Realized-activity-desc-After" id="Realized-activity-desc-After-{{@index}}" title="'+r+" "+e.After.revision+'">'+r+"</div>")+'<div class="Realized-activity-revision-After" id="Realized-activity-revision-After-{{@index}}">'+e.After.revision+"</div>")+'<div class="Realized-activity-desc-After" id="Realized-activity-desc-After-{{@index}}" title="'+l+'">'+l+"</div>",UWA.is(e.After.type)&&e.After.type!=n&&(o=o+'<div class="Realized-activity-action-open fonticon fonticon-2x fonticon-down-open" id="Realized-activity-action-open-'+a+'"Instanceid='+s+"></div>"),o+="</div>"}o+="</div>"}e.BeforeExists&&(o+='<div class="Realized-activity-Before">',UWA.is(e.BeforeGrammar)&&""!=e.BeforeGrammar&&(o=o+'<div class="Realized-activity-Before-Grammar">'+e.BeforeGrammar+"</div>"),UWA.is(e.Before)&&(a=UWA.is(e.Before.id)?e.Before.id.substr(4):"",s=UWA.is(e.Before.Instanceid)?e.Before.Instanceid.substr(4):a,r=e.Before.title.replace("<","&lt;"),UWA.is(r)&&""!=r||(r=e.Before.name.replace("<","&lt;")),l=UWA.is(e.Before.instanceName)&&""!=e.Before.instanceName?"("+e.Before.instanceName.replace("<","&lt;")+")":"",o=o+'<div class="Activity-box Access'+e.Before.Access+'" id="drag-'+e.Before.id+'"  draggable="true">',UWA.is(e.Before.type)&&e.Before.type!=n&&(o=o+'<div class="Realized-checked-action"><input type="checkbox" class="checkbox-Before" id="checkbox-Before-'+e.Before.id+'"Instanceid='+s+"></div>",o=(o+='<div class="Realized-activity-Before-icon-div">')+'<img class="Realized-activity-Before-icon" id="Realized-activity-Before-icon-'+e.Before.id+'" src ='+e.Before.icon+"></img></div>"),o=(o=(o=o+'<div class="Realized-activity-desc-Before" id="Realized-activity-desc-Before-{{@index}}" title="'+r+" "+e.Before.revision+'">'+r+"</div>")+'<div class="Realized-activity-revision-Before" id="Realized-activity-revision-Before-{{@index}}">'+e.Before.revision+"</div>")+'<div class="Realized-activity-desc-Before" id="Realized-activity-desc-Before-{{@index}}" title="'+l+'">'+l+"</div>",UWA.is(e.Before.type)&&e.Before.type!=n&&(o=o+'<div class="Realized-activity-action-open fonticon fonticon-2x fonticon-down-open" id="Realized-activity-action-open-'+a+'"Instanceid='+s+"></div>"),o+="</div>"),o+="</div>")}else e.BeforeExists&&(o+='<div class="Realized-activity-Before">',UWA.is(e.BeforeGrammar)&&""!=e.BeforeGrammar&&(o=o+'<div class="Realized-activity-Before-Grammar">'+e.BeforeGrammar+"</div>"),UWA.is(e.Before)&&(a=UWA.is(e.Before.id)?e.Before.id.substr(4):"",s=UWA.is(e.Before.Instanceid)?e.Before.Instanceid.substr(4):a,r=e.Before.title.replace("<","&lt;"),UWA.is(r)&&""!=r||(r=e.Before.name.replace("<","&lt;")),l=UWA.is(e.Before.instanceName)&&""!=e.Before.instanceName?"("+e.Before.instanceName.replace("<","&lt;")+")":"",o=o+'<div class="Activity-box Access'+e.Before.Access+'" id="drag-'+e.Before.id+'"  draggable="true">',UWA.is(e.Before.type)&&e.Before.type!=n&&(o=o+'<div class="Realized-checked-action"><input type="checkbox" class="checkbox-Before" id="checkbox-Before-'+e.Before.id+'"Instanceid='+s+"></div>",o=(o+='<div class="Realized-activity-Before-icon-div">')+'<img class="Realized-activity-Before-icon" id="Realized-activity-Before-icon-'+e.Before.id+'" src ='+e.Before.icon+"></img></div>"),o=(o=(o=o+'<div class="Realized-activity-desc-Before" id="Realized-activity-desc-Before-{{@index}}" title="'+r+" "+e.Before.revision+'">'+r+"</div>")+'<div class="Realized-activity-revision-Before" id="Realized-activity-revision-Before-{{@index}}">'+e.Before.revision+"</div>")+'<div class="Realized-activity-desc-Before" id="Realized-activity-desc-Before-{{@index}}" title="'+l+'">'+l+"</div>",UWA.is(e.Before.type)&&e.Before.type!=n&&(o=o+'<div class="Realized-activity-action-open fonticon fonticon-2x fonticon-down-open" id="Realized-activity-action-open-'+a+'"Instanceid='+s+"></div>"),o+="</div>"),o+="</div>"),e.AfterExists&&(o+='<div class="Realized-activity-After">',UWA.is(e.AfterGrammar)&&""!=e.AfterGrammar&&(o=o+'<div class="Realized-activity-After-Grammar">'+e.AfterGrammar+"</div>"),UWA.is(e.AfterMaturity)&&""!=e.AfterMaturity?o=o+'<div class="Realized-activity-After-Maturity">'+e.AfterMaturity+"</div>":UWA.is(e.After)&&(a=UWA.is(e.After.id)?e.After.id.substr(4):"",s=UWA.is(e.After.Instanceid)?e.After.Instanceid.substr(4):a,r=e.After.title.replace("<","&lt;"),UWA.is(r)&&""!=r||(r=e.After.name.replace("<","&lt;")),l=UWA.is(e.After.instanceName)&&""!=e.After.instanceName?"("+e.After.instanceName.replace("<","&lt;")+")":"",o=o+'<div class="Activity-box Access'+e.After.Access+' id="drag-'+e.After.id+'" draggable="true" >',UWA.is(e.After.type)&&e.After.type!=n&&(o=o+'<div class="Realized-checked-action"><input type="checkbox" class="checkbox-Before" id="checkbox-Before-'+e.After.id+'"Instanceid='+s+"></div>",o=(o+='<div class="Realized-activity-After-icon-div">')+'<img class="Realized-activity-After-icon" id="Realized-activity-After-icon-'+e.After.id+'" src ='+e.After.icon+"></img></div>"),o=(o=(o=o+'<div class="Realized-activity-desc-After" id="Realized-activity-desc-After-{{@index}}" title="'+r+" "+e.After.revision+'">'+r+"</div>")+'<div class="Realized-activity-revision-After" id="Realized-activity-revision-After-{{@index}}">'+e.After.revision+"</div>")+'<div class="Realized-activity-desc-After" id="Realized-activity-desc-After-{{@index}}" title="'+l+'">'+l+"</div>",UWA.is(e.After.type)&&e.After.type!=n&&(o=o+'<div class="Realized-activity-action-open fonticon fonticon-2x fonticon-down-open" id="Realized-activity-action-open-'+a+'"Instanceid='+s+"></div>"),o+="</div>"),o+="</div>");o+="</div>",e.TransferExists&&"Transferred"==e.status&&UWA.is(e.receivingChangeAction)&&(r=e.receivingChangeAction.synopsis.replace("<","&lt;"),e.BeforeExists&&e.AfterExists,o=(o+='<div class="Realized-activity-individual-transfer" id="Realized-activity-individual-transfer-{{@index}}">')+'<div class="Realized-activity-transfer-tile">                                         <div class="Realized-activity-transferTo">'+t.ECM_CA_Realized_TransferTo+':</div>                                         <div class="Realized-activity-transferToCAName" id="'+e.receivingChangeAction.id+'" title="'+r+'">'+r+'</div></div>                                         <div class="Realized-activity-transfer-Reason-tile">                                         <div class="Realized-activity-transferReasonText">'+t.ECM_CA_Realized_Transfer_Reason+': </div>                                         <div class="Realized-activity-transferReasonNLS" title="'+e.transferReasonNLS+'" >'+e.transferReasonNLS+"</div></div>",o+="</div>"),o+="</div>"}return o})),o.registerHelper("isValidForSelection",(function(e){var t="",i="act-chk-"+this.id;return this.Details.sameAsWhere||(t+='<input type="checkbox" class="chkbox-act hidden" id="'+i+'"}}">'),t}));var A={activitiesToExplore:[],actions:[],validateModelSelection:function(e){var t,i,n,o=!1;return(t=e.get("ActivityDetails"))&&(o=!0,(i=t[0].After)?i.Access||(o=!1):(n=t[0].Before)&&n.Access||(o=!1)),o},_createView_NewRealizedActivity:function(i){return e.extend({tagName:"div",className:"realized-activity-details",name:"RealizedActivities",activityModel:i.activityModels,idcardView:i.idcardView,activityIdx:i.activityIdx,caModel:i.caModel,isFromFlowDown:i.flowdownOptions.isFromFlowDown,flowdownOptions:i.flowdownOptions,selectedModelsForDrag:{},selectedActivityItems:[],activitiesToRemove:[],setup:function(){this.template='<div class="Realized-activities-container">                                                    <div class="Realized-activities">                                                        <div class="Realized-activitues-header">                                                        <div class="Realized-activities-chevron Realized-icon-class" id="activities-chevron-'+this.activityIdx+'">                                                                <div>                                                                <div class="Realized-action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-expand-down" id={{@index}}></span></div>                                                                </div>                                                            </div>                                                            <div class="Real-activities-counter"><span class="realized-counter"> {{RealizedactivityNls}}</span> <span class="realized-counter-num"> {{activityNum}} </span></div>                                                        <div class="'+this.getClassNames("-actions")+'"></div>                                                        <div class="'+this.getClassNames("-activitiesMultisel")+'"></div>                                                        </div>                                                        <div class="Realized-activity-content">                                                            {{#each activities}}                                                                <div class="Realized-activity-individual" id="Realized-activity-individual-{{id}}">                                                                \x3c!--div class="Realized-activity-name-container"><div class="act-chk-container"><input type="checkbox" class="chkbox-act hidden" id="act-chk-{{id}}"></div--\x3e                                                                <div class="Realized-activity-name-container"><div class="act-chk-container">{{#isValidForSelection id}} {{/isValidForSelection}}</div>                                                                <div class="Realized-activity-name"> {{activityDesc}}</div></div>                                                                <div class="Realized-activity-individual-details"> {{#getActivityDetails Details}}{{/getActivityDetails}}</div>                                                            </div>                                                            {{/each}}                                                        <div>                                                    </div>                                                </div>',this._initActionsView(),this._initMultiSelView(),this.renderer=this.getTemplate(this.template,this.activityModel);this.activityModel.get("activities");this.listenTo(this.activityModel,"onChange:activities",this.render)},render:function(){this.container.empty(),c.doWait(widget.body);var e=this.idcarView?widget.body:this.container,t=UWA.createElement("div",{class:"main-Realized-activities-container"}),i=this.renderer();t.addContent(i),t.inject(e),("true"==this.activityModel.get("isConfigured")||p.getGlobalVariable().isNative)&&(this.injectSubView(this.actionsView,"."+this.name+"-actions"),this.injectSubView(this.realizedMultiSelView,"."+this.name+"-activitiesMultisel"),this.actionsView&&this.actionsView.dispatchEvent("onShow"),this.realizedMultiSelView&&this.realizedMultiSelView.dispatchEvent("onShow"));for(var n=this.data.activityNum,o=this,s=0;s<n;s++){var r=this.container.getElement("#activity-action-container-"+s);if(r){r.addEvent("click",(function(e){e.currentTarget.id.split("-")[3]}))}}var l=this.container.getElements(".checkbox-Before");for(s=0;s<l.length;s++)if(l[s]){l[s].addEvent("click",(function(e){var t=e.target.checked,i=document.createElement("input"),n=e.target.id.replace("checkbox-Before-",""),s=e.target,r={};if(r.Instanceid=s.getAttribute("Instanceid"),t){var l=o.getModelFromSelectedID(n);o.selectedModelsForDrag[l.get("id")]=l,r.id=l.get("id").replace("pid:",""),r.name=l.get("objectName"),r.title=l.get("objectTitle"),r.type=l.get("objectType")}else{var c=Object.keys(o.selectedModelsForDrag);for(var d in c)c[d]===n&&delete o.selectedModelsForDrag[c[d]]}i.setAttribute("data-pid",e.target.id.replace("checkbox-Before-pid:","")),i.setAttribute("data-selectedItem",JSON.stringify(r)),t&&i.setAttribute("class","selected"),a.onClickItem.call(i,widget,p.getGlobalVariable());for(var u=this;u&&u.parentNode;)if((u=u.parentElement)&&u.className&&u.className.contains("Activity-box")){t?u.addClassName&&u.addClassName("selected-border"):u.removeClassName&&u.removeClassName("selected-border");break}let h=o.caModel.id.slice(4),m=[];c=Object.keys(o.selectedModelsForDrag);for(let e=0;e<c.length;e++){let t=o.selectedModelsForDrag[c[e]],i={id:t._attributes.id.slice(4),type:t._attributes.objectType},n=new C({grid:i});m.push(n)}if(0==c.length){let e=new C({});m.push(e)}(new f).addRoot(m),0!=c.length&&m[0].getTreeDocument().selectAll(),g.getDependency("applicationChannel").publish({event:"update-property-panel-data",data:{context:m[0],PhysicalID:h,type:"ChangeAction",load:!0}})}))}return c.endWait(widget.body),this},TransferRealized:function(e){var i=this;if(this.activitiesToRemove.length){var n=[],o=[];if(this.activitiesToRemove.forEach((function(e,t){var a;i.validateSelection(e)&&"Transferred"!=e.get("status")?(a=UWA.is(e.get("Afterobject"))?UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id:UWA.is(e.get("Beforeobject"))?UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id:e.get("id"),n.push(a)):o.push(e.get("id"))})),n.length>0){var a={selectedIDs:n,transferMode:e};i.dispatchEvent("transferSelectedItems",[a])}o.length>0&&(o.length==i.activitiesToRemove.length?m.error(t.ECM_CA_Invalid_Selection_Error):m.warn(t.ECM_CA_Invalid_Selection_Warning))}},AfterSaveTransReal:function(e){},_initMultiSelView:function(){var e=this,t={collection:new r,withMultisel:!0,useInfiniteScroll:!1,usePullToRefresh:!1,buildMultiselActions:function(t){return e.getMultiselActions(t)},events:{onMultiselOff:function(){e.deactivateMultisel()},onMultiselOn:function(){e.activateMultisel()},onActionClickDotted:function(){widget.body.getParent("body").addClassName("for-mobile")}}};this.multiSelView&&this.multiSelView.destroy(),this.realizedMultiSelView=A.multiSelView=new l(t)},validateSelection:function(e){var t,i,n,o=!1;return(t=e.get("ActivityDetails"))&&(o=!0,(i=t[0].After)?i.Access||(o=!1):(n=t[0].Before)&&n.Access||(o=!1)),o},getMultiselActions:function(e){var i=this,n=[];UWA.is(e)&&p.getGlobalVariable().isNative&&n.push({id:null,text:t.ECM_CA_Command_ExploreWith,fonticon:null,icon:null,multisel:!0,items:[{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreInContextHdr",icon:"I_FindInContext",multisel:!0,text:t.ECM_CA_Command_ExploreContext,handler:function(e){var i=[];p.getGlobalVariable().allSelectedActivity.forEach((function(e,t){var n;UWA.is(e.get("Afterobject"))&&(n=UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id,i.push(n.replace("pid:",""))),UWA.is(e.get("Beforeobject"))&&(n=UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id,i.push(n.replace("pid:","")))})),i&&i.length>0?u.DispatchEventToWin("MultiSelMenu_ExploreInContext_New",i):m.error(t.ECM_CA_Realized_Invalid_Explore_Selection)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInMSB",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:t.ECM_CA_Command_ExploreMSB,handler:function(e){var i=[];p.getGlobalVariable().allSelectedActivity.forEach((function(e,t){var n;UWA.is(e.get("Afterobject"))&&(n=UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id,i.push(n.replace("pid:",""))),UWA.is(e.get("Beforeobject"))&&(n=UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id,i.push(n.replace("pid:","")))})),i&&i.length>0?u.DispatchEventToWin("ExploreInMSB",i):m.error(t.ECM_CA_Realized_Invalid_Explore_Selection)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreParentsHdr",icon:"I_GetParents",multisel:!0,text:t.ECM_CA_Command_ExploreParents,handler:function(e){var t=[];p.getGlobalVariable().allSelectedActivity.forEach((function(e,i){var n;UWA.is(e.get("Afterobject"))&&(n=UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id,t.push(n.replace("pid:",""))),UWA.is(e.get("Beforeobject"))&&(n=UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id,t.push(n.replace("pid:","")))})),u.DispatchEventToWin("ExploreParents",t)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInPPR",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:t.ECM_CA_Command_ExploreMfg,handler:function(e){var t=[];p.getGlobalVariable().allSelectedActivity.forEach((function(e,i){var n;UWA.is(e.get("Afterobject"))&&(n=UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id,t.push(n.replace("pid:",""))),UWA.is(e.get("Beforeobject"))&&(n=UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id,t.push(n.replace("pid:","")))})),u.DispatchEventToWin("ExploreInPPR",t)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmMultiDagExploreInCmd",icon:"I_ExploreInRFLPNavigator",multisel:!0,text:t.ECM_CA_Command_ExploreSys,handler:function(e){var t=[];p.getGlobalVariable().allSelectedActivity.forEach((function(e,i){var n;UWA.is(e.get("Afterobject"))&&(n=UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id,t.push(n.replace("pid:",""))),UWA.is(e.get("Beforeobject"))&&(n=UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id,t.push(n.replace("pid:","")))})),u.DispatchEventToWin("ExploreInRFLP",t)}}]});var o=window.matchMedia("(max-width: 768px)"),a=t.ECM_CA_Realized_Transfer_ExistingCA,s=t.ECM_CA_Realized_Transfer_NewCA,r=t.ECM_CA_Realized_Transfer;if(o.matches&&(a=t.ECM_CA_Existing,s=t.ECM_CA_New,r=t.ECM_CA_Realized_Mobile_Transfer),"true"==this.activityModel.get("isConfigured")){var l={id:"ignore",text:t.ECM_CA_Realized_Ignore_Change,fonticon:"ignore",icon:"I_ChangeIgnore_22",multisel:!0,handler:function(e){var n=[],o=[];let a="";if(i.activitiesToRemove.length){i.activitiesToRemove.forEach((function(e,t){var o;i.validateSelection(e)&&(o=UWA.is(e.get("Afterobject"))?UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id:UWA.is(e.get("Beforeobject"))?UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id:e.get("id"),n.push(o))})),p.getGlobalVariable().is3DSpace||(a=i.caModel.id),n.length>0&&(o={originChangeActionId:a,idsToReject:n});v.ignoreNodes(o,widget.body,(function(e){"success"===e.status&&(i.dispatchEvent("ignoreSelectedItems",[e]),m.success(t.ECM_CA_Realized_Ignore_Success),c.endWait(widget.body))}),(function(e,i){c.endWait(widget.body),i&&i.errorMessage?m.error(i.errorMessage):m.error(t.ECM_CA_Realized_Ignore_ERR_MSG)}))}}};(d=i.caModel.get("userAccess"))&&"true"===d.RealizedReject&&n.push(l);var d,h={id:"transfer",text:r,fonticon:"sync",icon:"transfer_realized_new",multisel:!0,items:[{id:"Transfer_NewCA",text:s,fonticon:"new-create",icon:"I_FlowDownToNewCA",multisel:!0,handler:function(e){m.info(t.ECM_CA_Realized_Activity_Selection_Info);i.TransferRealized("New")}},{id:"Transfer_existingca",text:a,fonticon:"plus",icon:"I_FlowDownToExisting",multisel:!0,handler:function(e){m.info(t.ECM_CA_Realized_Activity_Selection_Info),i.TransferRealized("Existing")}}]};(d=i.caModel.get("userAccess"))&&"true"===d.MoveRealizedChange&&n.push(h)}return n},_initActionsView:function(){var e=this,i=[{id:"SelectAll",title:t.SelectAll,icon:"select-all",overflow:!1},{id:"UnSelectAll",title:t.UnSelectAll,icon:"select-none",overflow:!1}],n=new r(i);this.actionsView&&this.actionsView.destroy(),this.actionsView=new s({collection:n});var o=this._actionsViewEvents={onActionClick:function(){switch(arguments[1].model.get("id")){case"SelectAll":this.realizedMultiSelView&&e.selectAll();break;case"UnSelectAll":this.realizedMultiSelView&&e.UnselectAll()}}};this.listenTo(this.actionsView,o)},injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e,i){var n=o.compile(e),a=[];i.get("activities").forEach((function(e){e.get("ActivityDetails").forEach((function(t){if(UWA.is(t)&&""!=t){var i={};i.activityDesc=t.NLSName,i.id=e.id.replace("pid:",""),i.Details=t,a.push(i)}}))})),this.data={RealizedactivityNls:t.ECM_CA_RealizedActivities,activityNum:a.length,activities:a};var s=this;return function(){return n(s.data)}},domEvents:{"click .Realized-activities-chevron":function(e){e.target.id;var t=e.target.className;t.indexOf("expand-right")>0?e.target.className=t.replace("right","down").trim():t.indexOf("expand-down")>0&&(e.target.className=t.replace("down","right").trim());var i=this.container.getElement(".Realized-activity-content");i.hasClassName("hidden")?i.removeClassName("hidden"):i.addClassName("hidden")},"click .activity-individual":function(e){},"click .Realized-activity-action-open":function(e){var t=e.target.id,i=e.target,n="pid:"+(t=t.replace("Realized-activity-action-open-","")),o=this.getModelFromSelectedID(n);i&&(i.getParent().hasClassName("Accessfalse")?i.Access=!1:i.Access=!0,i.modelid=t,i.model=o,i.Instanceid=i.getAttribute("Instanceid"),this.itemView=i,this.dispatchEvent("onContextMenu",i))},"click .chkbox-act":function(e){e.target;for(var t=e.target.id.split("-"),i=t[t.length-1],n=this.container.getElements("#Realized-activity-individual-"+i),o=this.container.getElements("#act-chk-"+i),a=0;a<n.length;a++){var s=n[a],r=o[a];s.hasClassName("selected-border")?(s.removeClassName("selected-border"),r.checked=!1):(s.addClassName("selected-border"),r.checked=!0)}var l=this.activityModel.get("activities").findWhere({id:"pid:"+i}),c=this.selectedActivityItems.indexOf(l.cid);if(-1===c)this.selectedActivityItems.push(l.cid),this.activitiesToRemove.push(l),this.activateMultisel(this.container),p.getGlobalVariable().allSelectedActivity.push(l),p.getGlobalVariable().allSelectedActivityId.push(l.cid);else{this.selectedActivityItems.splice(c,1),this.activitiesToRemove.splice(c,1),0===this.activitiesToRemove.length&&this.deactivateMultisel(this.container);var d=p.getGlobalVariable().allSelectedActivityId.indexOf(l.cid);-1!=d&&(p.getGlobalVariable().allSelectedActivity.splice(d,1),p.getGlobalVariable().allSelectedActivityId.splice(d,1))}if(this.realizedMultiSelView){var u={isActive:!0};u.selectedObjects=this.activitiesToRemove,this.realizedMultiSelView.destroyDropDown();this.realizedMultiSelView.buildMultisel(u)}},"click .Realized-activity-transferToCAName":function(e){var t=e.target.id;if(t=t.replace("pid:",""),p.getGlobalVariable().is3DSpace){var i=widget.getUrl(),n=(i=i.substring(0,i.indexOf("/enterprisechangemgt")))+"/common/emxTree.jsp?mode=insert&objectId="+t;window.open(n)}else if(p.getGlobalVariable().isNative){var o={TransientCAPid:t};u.DispatchEventToWin("OpenCATransferTo",t)}else{o={TransientCAPid:t};d.showWidget("ENOWCHA_AP","",o,{mode:"panel",height:800,width:650})}},"dragstart .Activity-box":function(e){var t=e.target.id.substr(5),i=!1,n=Object.keys(this.selectedModelsForDrag);for(key in n)if(n[key]===t){i=!0;break}var o={};if(!1===i){var a=this.getModelFromSelectedID(t);o[a.get("id")]=a}else o=this.selectedModelsForDrag;Array.prototype.unshift.call(arguments,o),Array.prototype.unshift.call(arguments,{}),this.dispatchEvent("onItemViewDrag",arguments)}},getModelFromSelectedID:function(e){for(var t=null,i=this.activityModel.get("activities"),n=0;n<i.length;n++){var o=i.at(n);if(o){var a=o.get("Beforeobject");if(a&&a.id===e){t=a;break}var s=o.get("Afterobject");if(s&&s.id===e){t=s;break}}}var r=new UWA.Class.Model;return r.set("id",t.id),r.set("objectName",t.name),r.set("type",t.type),r.set("title",t.title),r.set("revision",t.revision),r.set("objectTitle",t.title),r.set("objectType",t.objectType),r.set("Access",t.Access),r},deactivateMultisel:function(){for(var e=this.container,t=e.getElements(".Realized-actions-container"),i=0;i<t.length;i++){t[i].removeClassName("no-actions")}var n=e.getElements(".checkbox-Before"),o=e.getElements(".chkbox-act");for(i=0;i<n.length;i++){n[i].removeClassName("hidden")}for(i=0;i<o.length;i++){var a=o[i],s=a.getAttribute("id").replace("act-chk-",""),r=this.activityModel.get("activities").findWhere({id:"pid:"+s}),l=p.getGlobalVariable().allSelectedActivityId.indexOf(r.cid);-1!=l&&(p.getGlobalVariable().allSelectedActivity.splice(l,1),p.getGlobalVariable().allSelectedActivityId.splice(l,1)),a.checked&&(a.checked=!1),a.addClassName("hidden")}var c=e.getElements(".Realized-activity-individual");for(i=0;i<c.length;i++){c[i].removeClassName("selected-border")}},activateMultisel:function(){for(var e=this.container,t=e.getElements(".Realized-actions-container"),i=0;i<t.length;i++){t[i].addClassName("no-actions")}var n=e.getElements(".checkbox-Before"),o=e.getElements(".chkbox-act");for(i=0;i<n.length;i++){var a=n[i];a.checked&&a.click(),a.addClassName("hidden")}for(i=0;i<o.length;i++){o[i].removeClassName("hidden")}},selectAll:function(){this.activateMultisel();for(var e=this.container.getElements(".chkbox-act"),t=0;t<e.length;t++){var i=e[t];i.checked||i.click()}},UnselectAll:function(){this.activateMultisel();for(var e=this.container.getElements(".chkbox-act"),t=0;t<e.length;t++){var i=e[t];i.checked&&i.click()}}})},calledFromNativeInterop:function(e){var i=e.refPid,n=[];p.getGlobalVariable().allSelectedActivity.forEach((function(e,t){var o,a;UWA.is(e.get("Afterobject"))&&((a=e.get("Afterobject").id)&&(a=a.replace("pid:","")),i.indexOf(a)>=0&&(o=UWA.is(e.get("Afterobject").Instanceid)?e.get("Afterobject").Instanceid:e.get("Afterobject").id,n.push(o.replace("pid:",""))));UWA.is(e.get("Beforeobject"))&&((a=e.get("Beforeobject").id)&&(a=a.replace("pid:","")),i.indexOf(a)>=0&&(o=UWA.is(e.get("Beforeobject").Instanceid)?e.get("Beforeobject").Instanceid:e.get("Beforeobject").id,n.push(o.replace("pid:",""))))})),n&&n.length>0?u.DispatchEventToWin("MultiSelMenu_ExploreInContext_New",n):m.error(t.ECM_CA_Realized_Invalid_Explore_Selection)}};return A})),define("DS/ENOChangeActionUX/scripts/Views/CARealizedOperationView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/ENOChangeActionUX/scripts/Views/CARealizedActivitiesView","DS/UIKIT/Scroller","DS/TransientWidget/TransientWidget","DS/i3DXCompassPlatformServices/OpenWith","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgPropertiesServices","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/UIKIT/Popover","DS/ENOChangeActionUX/scripts/Views/CAPopOverBodyView","text!DS/ENOChangeActionUX/scripts/Templates/CARealizedOpeationForFlowdownTemplate.html","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChgGovernanceUX/scripts/util/DocumentUtils","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgGovernanceUX/scripts/components/ChangeImpactsView/ChgChangeImpactsHandler","i18n!DS/ENOChgGovernanceUX/assets/nls/ENOChgGovernanceNLS"],(function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,y,b){"use strict";o.registerHelper("equalsToOne",(function(e){return 1===e.length})),o.registerHelper("isContextualMenuAvailable",(function(e){return'<div class="context-actions-container">                                            <div class="action-icon-wrapper"><span class="Realized-operation-action-open fonticon fonticon-2x fonticon-down-open" id="Realized-Op-Clicked-'+e.displayId+'"></span></div>                                    </div>'})),o.registerHelper("getWhereDetails",(function(e,i){var n=window.matchMedia("(max-width: 768px)"),o=(e.id.substr(4),'<div class="Realized-change-info-text" id="info-text-'+i+'">');return UWA.is(e)&&(o=o+'<div class="Realized-change-TNR-text" id="TNR-text-'+i+'">                                                    <div class="Realized-change-TNR-text_sub">                                                    <div class="Realized-change-TNR-Preference" id="TNR-Preference-'+i+'">',UWA.is(e.icon)&&""!=e.icon&&(o=o+'<img class="Realized-change-info-icon" id="info-icon-'+i+'" src ='+e.icon+"></img>"),UWA.is(e.name)&&""!=e.name&&(o=o+'<div class="Realized-name-title" id="Realized-name-title-'+i+'" title="'+e.name+" "+e.revision+'">                                                       <span class="Realized-name-span" id="Realized-name-span-'+i+'">'+e.name+'</span>                                                        <span class="Realized-revision-span" id="Realized-revision-span-'+i+'">'+e.revision+"</span>                                                       </div>"),o+="</div>",!n.matches&&UWA.is(e.maturity)&&""!=e.maturity&&(o=o+'<div class="Realized-Mobile-Maturity hidden" id="Realized-Mobile-Maturity-'+i+'">                                                       <span class="Realized-Maturity-span" id="Realized-Maturity-span-'+i+'">'+e.maturity+"</span>                                                       </div>"),n.matches&&UWA.is(e.maturity)&&""!=e.maturity&&(o=o+'<div class="Realized-Mobile-Maturity" id="Realized-Mobile-Maturity-'+i+'">                                                       <span class="Realized-Maturity-span" id="Realized-Maturity-span-'+i+'">'+e.maturity+"</span>                                                       </div>"),o+="</div >",n.matches||(o=(o=o+'<div class="Realized-title-Operation hidden" id="Realized-title-Operation-'+i+'">                                                       <span class="Realized-Operation-span" id="Realized-Operation-span-'+i+'">'+e.activities+"</span>                                                       </div>")+'<div class="Realized-title-name" id="Realized-title-name-'+i+'" title="'+e.title+'">                                                       <span class="Realized-title-span" id="Realized-title-span-'+i+'">'+e.title+"</span>                                                       </div>"),n.matches&&(o=(o=o+'<div class="Realized-title-Operation" id="Realized-title-Operation-'+i+'" title="'+e.activities+'">                                                       <span class="Realized-Operation-span" id="Realized-Operation-span-'+i+'">'+e.activities+"</span>                                                       </div>")+'<div class="Realized-title-name hidden" id="Realized-title-name-'+i+'">                                                       <span class="Realized-title-span" id="Realized-title-span-'+i+'">'+e.title+"</span>                                                       </div>"),o+="</div>",o=n.matches?o+'<div class="Realized-change-info-text-1 hidden" id="Realized-change-info-text-1-'+i+'">':o+'<div class="Realized-change-info-text-1 " id="Realized-change-info-text-1-'+i+'">',UWA.is(e.maturity)&&""!=e.maturity&&(o=(o=o+'<div class="Realized-change-info-text-2 " id="Realized-change-info-text-2-'+i+'>"')+'<p class="emptypara">                                                        <span class="empty"></span>                                                    </p>                                                    <p class="Realized-change-maturity" id="Realized-change-maturity-'+i+'">                                                        <span class="Realized-change-maturity-span" id="mat-span-'+i+'">'+e.maturityNLS+' :</span>                                                        <span class="Realized-change-maturityValue-span" id="matval-span-'+i+'">'+e.maturity+"</span>                                                    </p>                                                   </div>"),UWA.is(e.collabspace)&&(o=o+'<div class="Realized-change-info-text-3" id="info-text-3-'+i+'">                                                    <p class="emptypara">                                                        <span class="empty"></span>                                                    </p>                                                    <p class="Realized-change-collabspace" id="collabspace-'+i+'">                                                        <span class="Realized-change-collabspace-span" id="collab-span-'+i+'">'+e.collabspaceNLS+' :</span>                                                        <span class="Realized-change-collabspace-value-span" id="collab-span-value-'+i+'">'+e.collabspace+"</span>                                                    </p> </div>"),o=(o+="</div>")+'<div class="Realized-transfer-info-text-1 " id="Realized-transfer-info-text-1-'+i+'">',UWA.is(e.status)&&"Transferred"==e.status&&(UWA.is(e.targetCA)&&(o=o+'<div class="Realized-transfer-info-text-3" id="info-text-3-'+i+'">                                                    <p class="emptypara">                                                        <span class="empty"></span>                                                    </p>                                        <p class="Realized-change-targetCA" id="targetCA-'+i+'">                                        <span class="Realized-change-targetCA-span" id="targetCA-span-'+i+'">'+t.ECM_CA_Realized_TransferTo+' :</span>                                        <span class="Realized-change-targetCA-value-span" id="'+e.targetCAID+'">'+e.targetCA+"</span>                                  </p> </div>"),UWA.is(e.transferReasonNLS)&&(o=o+'<div class="Realized-transfer-info-text-4" id="info-text-4-'+i+'">                                                    <p class="emptypara">                                                        <span class="empty"></span>                                                    </p>                                                        <p class="Realized-change-transferComment" id="transferComment-'+i+'">                                                        <span class="Realized-change-transferComment-span" id="transferComment-span-'+i+'">'+t.ECM_CA_Realized_Transfer_Reason+' :</span>                                                        <span class="Realized-change-transferComment-value-span" id="transferComment-value-'+i+'">'+e.transferReasonNLS+"</span>                                                    </p> </div>")),o+="</div>"),o+"</div>"})),o.registerHelper("ifDraggableRealized",(function(e){return!1===e?"draggable='false'":"draggable='true'"}));var S={_createView_NewRealized:function(i){return e.extend({tagName:i.viewTagName,className:i.className,idcardView:i.idcardView,name:"RealizedOperation",RealizedModel:i.realizedModel,caModel:i.caModel,isFromFlowDown:i.flowdownOptions.isFromFlowDown,flowdownOptions:i.flowdownOptions,container:null,selectedTilesIDs:[],setup:function(){this.RealizedModel.get("id");this.flowdownOptions&&this.flowdownOptions.isFromProposedFlowdown?this.template=C:this.template='<div class="'+this.getClassNames("-container")+'">                                            {{#each changes}}                                            <div class="'+this.getClassNames("-sub-container")+'">                                                <div class="Realized-tile-collapsed" id="Realized-collapsed-{{@index}}" \t\t\t\t\t\t\t\t\t\t\t\t{{#ifDraggableRealized Details.access}}{{/ifDraggableRealized}}>                                                    <div class="Realized-accordion-div Realized-icon-class" id="Realized-accordion-div-{{@index}}"><div>                                                    <div class="Realized-action-icon-wrapper Realized-accordion-div-inner" id="Realized-accordion-div-inner-{{@index}}"><span class="fonticon fonticon-2x fonticon-expand-right" id={{@index}}></span></div>                                                    <div class="Realized-checked-action"><input type="checkbox" class="Realized-checkbox-accord hidden" id="Realized-checkbox-accord-{{Details.id}}"></div>                                                </div>                                            </div>                                            <div class="Realized-tile-inner" id="inner-{{@index}}">{{#getWhereDetails Details @index}}{{/getWhereDetails}}</div>                                                <div class="Realized-actions-container Realized-icon-class-1" id="Realized-operation-action-container-{{Details.displayId}}">{{#isContextualMenuAvailable Details}}{{/isContextualMenuAvailable}}</div>                                            </div>                                            <div class="Realized-tile-expanded hidden" id="Realized-expanded-{{@index}}"></div>                                            </div>                                            {{/each}}                                        </div>',S.selectedTilesIDs=[],this.listenTo(this.RealizedModel,"onChange:selectedProposed",this.render),this._parent.apply(this,arguments)},render:function(){this.container.empty(),this.selectedProposedArr=[],this.flowdownOptions.isFromProposedFlowdown?this.renderer=this.buildTemplateForProposedFlowdown(this.template,this.RealizedModel):this.renderer=this.getTemplate(this.template,this.RealizedModel);var e=this.idcardView?widget.body:this.container,t=UWA.createElement("div",{class:"main-Realized-operation-container"}),i=UWA.createElement("div",{class:"ChangeComponent"}),n=this.renderer();i.setContent(n),t.addContent(i),new s({element:t}).inject(e);var o=this;return S.container=o,setTimeout((function(){S.onResize()}),0),o.selectedProposedArr.forEach((function(e){var t=e.idx,i=o.container.getElement("#inner-"+t);i&&!e.ifExists&&i.setStyle("flex","1")})),d.setCallbacksForOpenWith("realized"),v.isWaiting()&&v.endWait(widget.body),this},injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},_initActivitiesView:function(e,t){var i,n=this,o={idcardView:!1,activityModels:e,activityIdx:t,caModel:this.caModel,flowdownOptions:this.flowdownOptions};i=new(a._createView_NewRealizedActivity(o));var s=this.ActivityEvents={onContextMenu:function(e){S.itemView=e,S.itemView.Access&&c.getGlobalVariable().isNative?p.DispatchEventToWin("Realized_ContextMenu",S.itemView.modelid):S.DisplayContextMenu([])},onItemViewDrag:function(){n.dispatchEvent("onItemViewDrag",arguments)},activityCheckBoxClicked:function(){n.dispatchEvent("activityCheckBoxClicked",arguments)},flowDownActivityObjects:function(){n.dispatchEvent("flowDownActivityObjects",arguments)},transferSelectedItems:function(){n.dispatchEvent("transferSelectedItems",arguments)}};this.listenTo(i,s),this.activitiesViewArr.push(i)},buildDataForTemplate:function(e){var i=[];this.activitiesViewArr=[];UWA.is(e)&&(e.forEach((function(e,n){var o={},a={maturityNLS:t.ECM_CA_Maturity,collabspaceNLS:t.ECM_CA_CollabSpace,statusNLS:t.ECM_CA_Realized_statusNLS,TransferNLS:t.ECM_CA_Realized_TransferNLS,maturity:e.get("maturity"),collabspace:e.get("collabSpaceTitle"),name:UWA.is(e.get("objectName"))?e.get("objectName"):e.get("name"),revision:e.get("revision"),title:UWA.is(e.get("objectTitle"))?e.get("objectTitle"):e.get("name"),icon:e.get("icon"),id:e.get("id"),access:e.get("Access"),displayId:e.get("id").substr(4),changeReason:e.get("changeReason"),status:e.get("status"),isConfigured:e.get("isConfigured"),transferReasonNLS:UWA.is(e.get("transferReasonNLS"))?e.get("transferReasonNLS"):"",targetCAID:UWA.is(e.get("receivingChangeAction"))?e.get("receivingChangeAction").id:"",targetCA:UWA.is(e.get("receivingChangeAction"))?e.get("receivingChangeAction").name:"",selectedProposedText:t.ECM_PROPOSED_SELECTED_PROPOSED,flowdownStatusText:t.ECM_PROPOSED_FLOWDOWN_STATUS,selectedProposedExists:!1,transferred:"Transferred"===e.get("status"),transferredText:t.ECM_CA_FLOWDOWN_TRANSFERRED_REALIZED_WARNING},s=[];e.get("activities").forEach((function(e){e.get("ActivityDetails").forEach((function(e){UWA.is(e)&&""!=e&&s.indexOf(e.NLSName)<0&&s.push(e.NLSName)}))})),a.activities=s.toString();var r=UWA.is(e.get("objectTitle"))?e.get("objectTitle"):e.get("name"),l=UWA.is(e.get("objectName"))?e.get("objectName"):e.get("name"),c=UWA.is(e.get("receivingChangeAction"))?e.get("receivingChangeAction").synopsis:"";a.name=r.replace("<","&lt;"),a.title=l.replace("<","&lt;"),a.targetCA=c.replace("<","&lt;"),o.Details=a,i.push(o)})),m.setSelectedProposedPerRealizedObject({})),this.data={RealizedNls:t.ECM_CA_RealizedChanges,RealizedNum:i.length,changes:i}},buildTemplateForProposedFlowdown:function(e,t){var i=o.compile(e);this.buildDataForTemplate(t);var n=this;return function(){return i(n.data)}},getTemplate:function(e,t){var i=o.compile(e);this.buildDataForTemplate(t);var n=this;return function(){return i(n.data)}},domEvents:{"click .Realized-accordion-div-inner":function(e){var t=e.target.id,i=e.target.className;i.indexOf("expand-right")>0?e.target.className=i.replace("right","down").trim():i.indexOf("expand-down")>0&&(e.target.className=i.replace("down","right").trim()),S.expandTile(t,i)},"click .Realized-tile-inner":function(e){if(!(e.target.className.indexOf("down-open")>=0||0==e.target.className.indexOf("Realized-change-targetCA-value-span")||e.target.className.indexOf("supp-icon")>=0||e.target.className.indexOf("multiple-proposed")>=0)){var t=e.target.id.split("-"),i=t[t.length-1],n=this.container.getElement("#Realized-accordion-div-inner-"+i);if(n)if(n.className.indexOf("hidden")>0)return;var o=n.getElementsByTagName("span")[0].className;o.indexOf("expand-right")>0?n.getElementsByTagName("span")[0].className=o.replace("right","down").trim():o.indexOf("expand-down")>0&&(n.getElementsByTagName("span")[0].className=o.replace("down","right").trim()),S.expandTile(i)}},"click .Realized-checkbox-accord":function(e){for(var t=e.target.checked,i=e.target,n=0;i&&i.parentNode;)(i=i.parentElement)&&i.className&&i.className.contains("Realized-tile-collapsed")&&(n=i.id,t?i.addClassName("selected-border"):i.removeClassName("selected-border"));var o=n.split("-"),a=o[o.length-1],s=parseInt(a),r=this.RealizedModel.at(s),l=document.createElement("input");l.setAttribute("data-pid",e.target.id.replace("Realized-checkbox-accord-pid:","")),t&&l.setAttribute("class","selected");var d={};d.id=r.get("id").replace("pid:",""),d.name=r.get("objectName"),d.title=r.get("objectTitle"),d.type=r.get("objectType"),l.setAttribute("data-selectedItem",JSON.stringify(d)),CAWidgetConfiguration.onClickItem.call(l,widget,c.getGlobalVariable()),Array.prototype.unshift.call(arguments,r),this.dispatchEvent("onCheckboxClick",arguments)},"click .checkbox-Before":function(e){var t=e.target.outerHTML,i=t.indexOf("instanceid"),n=t.substring(i);n="pid:"+(n=n.replace(/instanceid=\"|">/g,"")),this.dispatchEvent("onCheckboxClickNative",n)},"click .Realized-operation-action-open":function(e){var t=e.target.id,i=this.container.getElement("#"+t);t=t.replace("Realized-Op-Clicked-","");var n=this.RealizedModel.findWhere({id:"pid:"+t});UWA.is(n)&&(i.model=n),i.modelid=t,S.itemView=i,S.itemView.model.get("Access")&&c.getGlobalVariable().isNative?p.DispatchEventToWin("Realized_ContextMenu",t):S.DisplayContextMenu([])},"click .Realized-operation-related-object":function(e){},"dragstart .Realized-tile-collapsed":function(e){var t=this.RealizedModel,i=(e.target,e.target.id.split("-")),n=i[i.length-1],o=parseInt(n),a=t.at(o),s={};s[a.get("id")]=a,Array.prototype.unshift.call(arguments,s),Array.prototype.unshift.call(arguments,{}),this.dispatchEvent("onItemViewDrag",arguments)},"click .Realized-change-targetCA-value-span":function(e){var t=e.target.id;if(t=t.replace("pid:",""),c.getGlobalVariable().is3DSpace){var i=widget.getUrl(),n=(i=i.substring(0,i.indexOf("/enterprisechangemgt")))+"/common/emxTree.jsp?mode=insert&objectId="+t;window.open(n)}else if(c.getGlobalVariable().isNative){var o={TransientCAPid:t};p.DispatchEventToWin("OpenCATransferTo",t)}else{o={X3DContentId:JSON.stringify({protocol:"3DXContent",source:widget.name,data:{items:[{envId:c.getGlobalVariable().tenant,serviceId:"3DSpace",objectId:t}]}}),x3dPlatformId:c.getGlobalVariable().tenant};widget.getValue("appId")&&"ENOWCHG_AP"==widget.getValue("appId")?r.showWidget("ENOWCHG_AP","",o,{mode:"panel",height:800,width:650}):r.showWidget("ENOWCHA_AP","",o,{mode:"panel",height:800,width:650})}}},destroy:function(){this.flowdownActivitiesView&&this.flowdownActivitiesView.destroy(),this._parent.apply(this,arguments)}})},DisplayContextMenu:function(e){var i=this,n=[];if(i.itemView&&i.itemView.model&&i.itemView.model.get("Access")){var o={objectId:i.itemView.model.get("id").replace("pid:",""),objectType:i.itemView.model.get("objectType"),displayName:i.itemView.model.get("objectTitle"),displayType:i.itemView.model.get("type"),facetName:"realized"},a={facetName:"realized",selectedItem:o};d.setSelectedItem(a);var s=[];s.push(o);var r=d.getContentForCompassInteraction(s),p=new l;p.set3DXContent(r,!0);var h=[];if(UWA.is(p.retrieveCompatibleApps,"function")){if(c.getGlobalVariable().is3DSpace&&!window.x3DPlatformServices&&!window.COMPASS_CONFIG){const e=getTopWindow().document.createElement("div");e.id="hiddenDivForCompassInNewWindow",e.style.display="none",getTopWindow().document.body.appendChild(e),window.COMPASS_CONFIG={myAppsBaseUrl:c.getGlobalVariable().baseURL,userId:"",lang:navigator.language,compassTarget:e.id}}p.retrieveCompatibleApps((function(o){o.forEach((function(e){h.push({text:e.text,fonticon:e.fonticon,multisel:!1,handler:e.handler})})),h.length>0&&c.getGlobalVariable().isNative?"true"==c.getGlobalVariable().CHG_OPENWITH&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith_RichClient,fonticon:"export",icon:"fonticon-export",multisel:!1,items:h}):h.length>0&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith,fonticon:"export",icon:"fonticon-export",multisel:!1,items:h}),c.getGlobalVariable().isNative||"false"==c.getGlobalVariable().CHG_OPEN_WITH_COLLAB||n.push({id:"Details",text:t.ECM_CA_Explore_With_Central,fonticon:"window",icon:"fonticon-window",multisel:!0,handler:function(){if(c.getGlobalVariable().is3DSpace){var e=i.itemView.modelid,t=widget.getUrl(),n=(t=t.substring(0,t.indexOf("/enterprisechangemgt")))+"/common/emxTree.jsp?objectId="+e;(o=window.open()).opener=null,o.location.href=n}else{n="/common/emxTree.jsp?mode=insert&objectId="+(e=i.itemView.modelid);var o,a=c.getGlobalVariable().getSecurityContext().replace("ctx::",""),s=c.getGlobalVariable().computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+a+"&forwardUrl="+n);(o=window.open()).opener=null,o.location.href=s}}});var a={id:"Compare",text:t.ECM_COMPARE_PREVIOUS,fonticon:"compare-on",icon:"I_Compare",multisel:!1,handler:function(e){var t=UWA.is(i.itemView.Instanceid)?i.itemView.Instanceid:i.itemView.modelid,n=[];n.push(t);i.itemView.model.get("amo").forEach((function(e){e.operation.forEach((function(t){if((t=t.trim()).indexOf("NewMinorVersion")>-1||t.indexOf("NewVersion")>-1||t.indexOf("Clone")>-1||t.indexOf("NewEvolution")>-1){var i=e.before&&e.before.id?e.before.id.replace("pid:",""):"";return n.push(i),void!0}}))})),d.openCompareApp(n)}};i.itemView.model&&!0===i.isCompareCmdAllowed()&&1!=c.getGlobalVariable().isNative&&1!=c.getGlobalVariable().is3DSpace&&n.push(a);var s={id:"Properties",text:t.ECM_CA_Properties,fonticon:"fonticon fonticon-info-open-in-a-new-window",icon:"I_ChangeCnxObjProps",multisel:!0,handler:function(e){var t=UWA.is(i.itemView.Instanceid)?i.itemView.Instanceid:i.itemView.modelid;u.createPropertiesComponent(t)}};n.push(s);let r=b.CHG_Change_Impact_Command_Label;UWA.is(i.itemView.Instanceid)&&(r=b.CHG_Change_Impact_Instance_Command_Label);var l={id:"ChangeImpacts",text:r,fonticon:"change",icon:"ChangeImpact",handler:function(e){let t={};t.objectID=UWA.is(i.itemView.Instanceid)?i.itemView.Instanceid:i.itemView.modelid,t.label=i.itemView.model._attributes.objectTitle,t.objectRevision=i.itemView.model._previousAttributes.revision,t.objectType=i.itemView.model._attributes.objectType,t.serviceId="3DSpace",y.launchImpactsView(t)}};(i.itemView.model._attributes.Access="true")&&n.push(l),A.getDocuments([i.itemView.model.get("id").slice("4")]).then((function(o){var a={id:"download",text:t.ECM_CA_Download,fonticon:"download",icon:"I_ChangeCnxObjDownload",multisel:!0,handler:function(e){var t=i.itemView.model.get("id").slice("4"),n=[];n.push(t);A.download(n)}},s={id:"preview",text:t.ECM_CA_Preview,fonticon:"eye",icon:"I_ChgPreviewIcon",multisel:!0,handler:function(e){var t=i.itemView.model.get("id").slice("4"),n=[];n.push(t),A.preview(n)}};i.itemView&&i.itemView.model&&"TRUE"===o[0].dataelements.isDocumentType&&(n.push(a),n.push(s)),n.push.apply(n,e),d._initDropDown(n,S.itemView)}))}))}}},isCompareCmdAllowed:function(){var e=!1,t=this.itemView.model.get("amo");return t?(t.forEach((function(t){t.operation.forEach((function(t){((t=t.trim()).indexOf("NewMinorVersion")>-1||t.indexOf("NewVersion")>-1||t.indexOf("Clone")>-1||t.indexOf("NewEvolution")>-1)&&(e=!0)}))})),e):e},expandTile:function(e){this.makeActivitiesView(this.container.RealizedModel.at(e),e);var t=this.container.getElement("#Realized-expanded-"+e);if(t){var i=t.className;if(i.indexOf("hidden")>0){t.className=i.replace("hidden","").trim(),this.selectedTilesIDs.push(e);var n=t.getElement(".Realized-title-name");UWA.is(n)&&(n.className=n.className.replace("hidden","").trim())}else if(t.className=i+" hidden",UWA.is(this.selectedTilesIDs))for(var o=this.selectedTilesIDs.length-1;o>=0;o--)if(this.selectedTilesIDs[o]===e){this.selectedTilesIDs.splice(o,1);break}}var a=this.container.getElement("#Realized-collapsed-"+e);a&&(a.style.borderBottom.indexOf("hidden")>=0?a.style.borderBottom="":a.style.borderBottom="hidden"),window.matchMedia("(max-width: 768px)").matches&&S.resizeForMobile(e)},makeActivitiesView:function(e,t){var i=this,n="#Realized-expanded-"+t,o=this.container.getElement(n);if(o){if(o.getElement(".realized-activity-details"))return;var s,r={idcardView:!1,activityModels:e,activityIdx:t,caModel:this.container.caModel,flowdownOptions:this.container.flowdownOptions};s=new(a._createView_NewRealizedActivity(r));var l={onContextMenu:function(e){S.itemView=e,S.itemView.Access&&c.getGlobalVariable().isNative?p.DispatchEventToWin("Realized_ContextMenu",S.itemView.modelid):S.DisplayContextMenu([])},onItemViewDrag:function(){i.dispatchEvent("onItemViewDrag",arguments)},activityCheckBoxClicked:function(){i.dispatchEvent("activityCheckBoxClicked",arguments)},flowDownActivityObjects:function(){i.dispatchEvent("flowDownActivityObjects",arguments)},transferSelectedItems:function(){this.dispatchEvent("transferSelectedItems",arguments)},ignoreSelectedItems:function(){this.dispatchEvent("ignoreSelectedItems",arguments)}};this.container.listenTo(s,l),i.container.injectSubView(s,n)}},resizeForMobile:function(e){var t,i=this.container.getElement("#info-text-"+e);(i&&i.setStyles({"flex-direction":"column"}),i=this.container.getElement("#Realized-change-info-text-1-"+e))&&((t=i.className).indexOf("hidden")>0?i.className=t.replace("hidden","").trim():i.className=t+" hidden");(i=this.container.getElement("#Realized-transfer-info-text-1-"+e))&&((t=i.className).indexOf("hidden")>0?i.className=t.replace("hidden","").trim():i.className=t+" hidden");(i=this.container.getElement("#Realized-title-name-"+e))&&((t=i.className).indexOf("hidden")>0?i.className=t.replace("hidden","").trim():i.className=t+" hidden");(i=this.container.getElement("#Realized-Mobile-Maturity-"+e))&&((t=i.className).indexOf("hidden")>0?i.className=t.replace("hidden","").trim():i.className=t+" hidden");(i=this.container.getElement("#Realized-title-Operation-"+e))&&((t=i.className).indexOf("hidden")>0?i.className=t.replace("hidden","").trim():i.className=t+" hidden")},collapseTiles:function(){if(this.container){for(var e=this.container.getElements(".Realized-tile-expanded"),t=0;t<e.length;t++){(o=(n=e[t]).className).indexOf("hidden")>0||(n.className=o+" hidden")}UWA.is(this.selectedTilesIDs)&&(this.selectedTilesIDs=[]);var i=window.matchMedia("(max-width: 768px)").matches;for(e=this.container.getElements(".Realized-change-info-text"),t=0;t<e.length;t++){var n=e[t];i?n.setStyles({"flex-direction":"column"}):n.setStyles({"flex-direction":"row"})}e=this.container.getElements(".Realized-change-info-text-1");for(t=0;t<e.length;t++){(o=(n=e[t]).className).indexOf("hidden")>0&&!i?n.className=o.replace("hidden","").trim():o.indexOf("hidden")<=0&&i&&(n.className=o+" hidden")}e=this.container.getElements(".Realized-transfer-info-text-1");for(t=0;t<e.length;t++){(o=(n=e[t]).className).indexOf("hidden")>0&&!i?n.className=o.replace("hidden","").trim():o.indexOf("hidden")<=0&&i&&(n.className=o+" hidden")}for(e=this.container.getElements(".Realized-title-name"),t=0;t<e.length;t++){(o=(n=e[t]).className).indexOf("hidden")>0&&!i?n.className=o.replace("hidden","").trim():o.indexOf("hidden")<=0&&i&&(n.className=o+" hidden")}for(e=this.container.getElements(".Realized-Mobile-Maturity"),t=0;t<e.length;t++){(o=(n=e[t]).className).indexOf("hidden")>0&&i?n.className=o.replace("hidden","").trim():o.indexOf("hidden")<=0&&!i&&(n.className=o+" hidden")}for(e=this.container.getElements(".Realized-title-Operation"),t=0;t<e.length;t++){var o;(o=(n=e[t]).className).indexOf("hidden")>0&&i?n.className=o.replace("hidden","").trim():o.indexOf("hidden")<=0&&!i&&(n.className=o+" hidden")}}},deactivateMultisel:function(){for(var e=S.container.container,t=e.getElements(".Realized-actions-container"),i=0;i<t.length;i++){t[i].removeClassName("no-actions")}var n=e.getElements(".Realized-accordion-div-inner"),o=e.getElements(".Realized-checkbox-accord");for(i=0;i<n.length;i++){var a=n[i];a.removeClassName("hidden");var s=a.getElementsByTagName("span")[0].className;s.indexOf("expand-down")>0&&(a.getElementsByTagName("span")[0].className=s.replace("down","right").trim());var r=o[i];r.checked&&(r.click(),r.checked=!1),r.addClassName("hidden")}var l=e.getElements(".Realized-tile-collapsed");for(i=0;i<l.length;i++){l[i].removeClassName("selected-border")}},activateMultisel:function(){for(var e=S.container.container,t=e.getElements(".Realized-actions-container"),i=0;i<t.length;i++){t[i].addClassName("no-actions")}var n=e.getElements(".Realized-accordion-div-inner"),o=e.getElements(".Realized-checkbox-accord");for(i=0;i<n.length;i++){var a=n[i];o[i].removeClassName("hidden"),a.addClassName("hidden")}var s=e.getElements(".Realized-tile-collapsed");for(i=0;i<s.length;i++){s[i].style.borderBottom=""}},selectAll:function(){this.activateMultisel();var e=S.container.container,t=e.getElements(".Realized-checkbox-accord"),i=e.getElements(".checkbox-Before"),n=e.getElements(".Realized-tile-expanded.hidden");if(i.length>0&&0==n.length)for(var o=0;o<i.length;o++){(a=i[o]).checked||a.click()}else for(o=0;o<t.length;o++){var a;(a=t[o]).checked||a.click()}},UnselectAll:function(){var e=S.container.container,t=e.getElements(".Realized-checkbox-accord"),i=e.getElements(".checkbox-Before"),n=e.getElements(".Realized-tile-expanded.hidden");if(i.length>0&&0==n.length)for(var o=0;o<i.length;o++){(a=i[o]).checked&&a.click()}else for(o=0;o<t.length;o++){var a;(a=t[o]).checked&&a.click()}},onResize:function(){var e=this.selectedTilesIDs;S.collapseTiles(),UWA.is(e)&&e.forEach((function(e,t){S.expandTile(e)}))},expandAllActivity:function(){for(var e=S.container.container,t=e.getElements(".Realized-accordion-div-inner"),i=e.getElements(".Realized-tile-expanded.hidden"),n=[],o=0;o<t.length;o++){var a=t[o];(a.children[0].className.indexOf("expand-right")>0||i.length>0)&&a.children[0].click(),n.push(a.children[0].id)}setTimeout((function(){for(var t=0;t<n.length;t++){var i=n[t];e.getElements("#Realized-expanded-"+i)[0].getElements(".fonticon-select-all")}}),500)},collapseAllActivity:function(){for(var e=S.container.container,t=e.getElements(".Realized-accordion-div-inner"),i=e.getElements(".Realized-tile-expanded.hidden"),n=0;n<t.length;n++){var o=t[n];(o.children[0].className.indexOf("expand-down")>0||0==i.length)&&o.children[0].click();var a=o.children[0].id;e.getElements("#Realized-expanded-"+a)[0].getElements(".fonticon-select-none")}}};return S})),define("DS/ENOChangeActionUX/scripts/Views/CAProposedFlowdownPopoverView",["UWA/Class/View","DS/UIKIT/Popover","DS/ENOChangeActionUX/scripts/Views/CAFlowdownInfoPopOverBodyView"],(function(e,t,i){"use strict";return e.extend({init:function(e){this.options=e,this._parent.call(this,e)},setup:function(){},render:function(){return this.container.empty(),this.launchMultiplePopover(),this},launchMultiplePopover:function(){this.proposedPopover&&this.proposedPopover.destroy();var e=this.options.target,n=this.proposedPopover=new t({className:"flowdown-items",target:e,position:"right",trigger:"click touch",autoHideOnClickOutside:!0,title:"flowdown info"}).show(),o={objectsSelected:this.options.data,container:n.elements.body,bodyOf:"multipleFlowdownInformation",bodyFor:this.options.popoverFor};this.popOverBodyview&&this.popOverBodyview.destroy(),(this.popOverBodyview=new i(o)).render()}})})),define("DS/ENOChangeActionUX/scripts/Views/CADependenciesGridView",["UWA/Class/View","UWA/Core","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/DataGridView/DataGridView","DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController","DS/CollectionView/CollectionViewStatusBar","DS/ENOChgServices/scripts/services/ChgDependencyServices","DS/ENOChangeActionUX/scripts/Services/CADependenciesViewServices","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/Tweakers/GeneratedToolbar","DS/ENOChangeActionUX/scripts/CAMakeDroppable","DS/PlatformAPI/PlatformAPI","DS/ENOChgRouter5/scripts/ChgRouter","DS/ENOChgGovernanceUX/scripts/config/ChgGovAppGlobalConfig","DS/ENOChgServices/scripts/services/ChgDataProcess","DS/Core/PointerEvents","DS/ENOChgGovernanceUX/scripts/util/ChgDataGridUtil","DS/RouteWebAppUX/scripts/RouteWebAppApprovalStatusUX","DS/CoreEvents/ModelEvents","DS/ENOChgServices/scripts/services/ChgNativeInitService","require"],(function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w){"use strict";var y=e.extend({name:"dependViewGrid",tag:"div",className:"dependenciesView",stream:i.ECM_CA_UPSTREAM_DEPENDENCY,caDependencyModel:null,init:function(e){y.caDependencyModel=s.changeActionDependencyModel,e&&(y.caId=e.id,y.caDependencyModel.set("caId",e.id),y.caDependencyModel.set("showFlowdown",e.showFlowdown)),this._modelEvents=null,null!=e&&null!=e.modelEvents?this._modelEvents=e.modelEvents:this._modelEvents=new v;var t=this._modelEvents;widget.addEvents({onSearch:function(e){t.publish({event:"chg-dependency-DataGrid-on-search",data:{query:e},context:that})},onResetSearch:function(e){t.publish({event:"chg-dependency-DataGrid-on-reset-search",data:{query:e},context:that})}}),this._parent.call(this,e.id)},setup:function(){},render:async function(e){var t=this;this.container&&this.container.empty(),this.containerReference=this.container;var i=new UWA.Element("div");i.setAttributes({id:"dependencyView-main-container"}),i.inject(this.containerReference),this.caDependencyDatagridViewHeader=UWA.createElement("div",{id:"dependViewGrid-header-container",class:"dependViewGrid-header-container"}),this.caDependencyDatagridViewContent=UWA.createElement("div",{id:"dependViewGrid-content-container",class:"dependViewGrid-content-container"}),y.caDependencyModel.set("contextParentType",e),o.setCADependencyModel(y.caDependencyModel),!y.caDependencyModel.get("upstreamDependencyObjects").dependencyLinks.length&&y.caDependencyModel.get("downstreamDependencyObjects").dependencyLinks.length?y.caDependencyModel.set("stream","Downstream"):y.caDependencyModel.set("stream","Upstream");var n=await o.getTreeModelForDataGridView();this.setTreeModelDefaultProperties(n),this.subscribeToModelEvents(n);var a=this.gridView=this.buildDependencyGridView(n);y.caDependencyModel.set("dataGridView",a),a.inject(this.caDependencyDatagridViewContent);var s=y.caDependencyModel.get("userAccess").dependUserAccess.edit;"false"==l.getGlobalVariable().isFullLicence&&(s="false");var r=this.buildGridToolbar(a,y.caDependencyModel.get("stream"),s);r.inject(this.caDependencyDatagridViewHeader),this.setDependencyGridDefaultProperties(a,r),"true"===s&&d.makeDroppable(this.caDependencyDatagridViewContent,this.dropHandler),this.caDependencyDatagridViewHeader.inject(i),this.caDependencyDatagridViewContent.inject(i),a.addEventListener(g.POINTERHIT,(function(e,i){t.onItemClick(e,i)})),this.onItemClick=function(e,t){if(t&&t.nodeModel&&t.nodeModel.options.grid)if(2==e.multipleHitCount);else if(t&&2==t.columnID){var i={};i.cellInfos=t,f.executeMaturity(i)}},this._modelEvents.subscribe({event:"chg-dependency-DataGrid-on-search"},(function(e){if("true"==l.getGlobalVariable().slidePanelTagger){var i=e.query;if(i){var n=t.gridView.getTreeDocument();n.withTransactionUpdate((function(){n.getAllDescendants().forEach((function(e){var t=0;e.options.data.displayName&&(e.options.data.displayName.toUpperCase().contains(i.toUpperCase())||e.options.data.caName.toLowerCase().contains(i.toLowerCase()))?e.show():e.__children&&e.__children.length>0?e.__children.forEach((function(n){n.options&&n.options.data&&n.options.data.displayName&&n.options.data.caName&&(n.options.data.caName.toLowerCase().contains(i.toLowerCase())||n.options.data.displayName.toUpperCase().contains(i.toUpperCase()))?(t++,e.show()):n.__children&&n.__children.length>0?n.__children.forEach((function(n){n.options&&n.options.data&&n.options.data.displayName&&n.options.data.caName&&(n.options.data.caName.toLowerCase().contains(i.toLowerCase())||n.options.data.displayName.toUpperCase().contains(i.toUpperCase()))?(t++,e.show()):0==t&&e.hide()})):0==t&&e.hide()})):e.hide()}))}))}}})),this._modelEvents.subscribe({event:"chg-dependency-DataGrid-on-reset-search"},(function(e){var i=t.gridView.getTreeDocument();i.withTransactionUpdate((function(){i.getAllDescendants().forEach((function(e){e.isVisible()||e.show()}))}))}))},subscribeToModelEvents:function(e){p.unsubscribe("updateRouteContent-"+widget.id),p.subscribe("updateRouteContent-"+widget.id,(async function(e){e="string"==typeof results?JSON.parse(e):e,e=C.getApprovalStatusValue(e);const t=Object.entries(e),i=t[0][0],n=t[0][1];var o=y.caDependencyModel.get("dataGridView").getTreeDocument().getSelectedNodes(),a=e[o[0].options.grid.id];i==o[0].options.grid.id&&o[0].updateOptions({grid:{ApprovalStatus:n.approvalStatus,approvalStatusModel:n.approvalStatusModel,maturity:a.maturity,maturityNLS:a.maturity_NLS,maturityWithBadge:a.maturity,current:a.maturity,currentNLS:a.maturity_NLS}}),y.caDependencyModel.get("upstreamDependencyObjects").dependencyLinks.forEach((e=>{e.id.replace("pid:","")==o[0].options.grid.id&&(e.state=o[0].options.grid.maturity,e.stateNLS=o[0].options.grid.maturityNLS,e.ApprovalStatus=o[0].options.grid.ApprovalStatus,e.approvalStatusModel=o[0].options.grid.approvalStatusModel)})),y.caDependencyModel.get("downstreamDependencyObjects").dependencyLinks.forEach((e=>{e.id.replace("pid:","")==o[0].options.grid.id&&(e.state=o[0].options.grid.maturity,e.stateNLS=o[0].options.grid.maturityNLS,e.ApprovalStatus=o[0].options.grid.ApprovalStatus,e.approvalStatusModel=o[0].options.grid.approvalStatusModel)}))}))},dropHandler(e){console.log("dropHandler called"+e);for(var t=[],i=[],n=0;n<e.length;n++)(i=[]).push(e[n].objectId),i.push(e[n].displayType),i.push(e[n].serviceId),t.push(i);o.OnSearchComplete(t)},buildDependencyGridView:function(e){var t=[{text:i.ECM_CA_Table_Header_Title,dataIndex:"tree",width:"150",pinned:"left",filterId:"stringRegexp",filterModel:""},{text:i.ECM_CA_Pref_Name_Label,dataIndex:"name",width:"180",typeRepresentation:"string",allowUnsafeHTMLContent:!0,filterId:"stringRegexp",filterModel:"",getCellGroupingKey:function(e){return e.nodeModel.options.data.caName}},f.getColumnDefinition({dataIndex:"maturityWithBadge"}),{text:i.ECM_CA_Depend_Label,dataIndex:"dependency",width:"150",typeRepresentation:"string",filterId:"set",filterModel:[]},f.getColumnDefinition({dataIndex:"ApprovalStatus"}),{text:i.ECM_CA_Summary_Owner,dataIndex:"ownerFullName",editableFlag:!1,visibleFlag:!0,alwaysVisibleFlag:!1,typeRepresentation:"user",filterId:"set",filterModel:[],getCellValue:function(e){if(e.nodeModel){if(l.getGlobalVariable().isSwymInstalled){var t="/api/user/getpicture/login/"+e.nodeModel.getAttributeValue("owner")+"/format/normal";return{icon:t=l.getGlobalVariable().computeSwymUrl(t),label:e.nodeModel.getAttributeValue("ownerFullName")}}return{label:e.nodeModel.getAttributeValue("ownerFullName")}}},getCellGroupingKey:function(e){return e.nodeModel.options.data.ownerFullName}},{text:i.ECM_CA_DueDate,dataIndex:"estimatedEndDate",typeRepresentation:"date",editableFlag:!1}],o=new n({treeDocument:e,columns:t,showModelChangesFlag:!1,autoRowHeightFlag:!0,identifier:"chgDependencyGrid"}),a=m.getDefaultFilter(t);e.setFilterModel(a);return o.addEventListener(g.POINTERHIT,(function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.multipleHitCount&&(t.nodeModel.select(!0),p.publish("launch_change_action"+(widget?widget.id:""),{id:t.nodeModel.options.data.objectId.slice(4),objectType:t.nodeModel.options.data.displayType}))})),o},getJSONToolbar:function(e,t){var n={entries:[],typeRepresentations:{"stream-combo":{stdTemplate:"comboSelector",semantics:{possibleValues:[{value:i.ECM_CA_UPSTREAM_DEPENDENCY},{value:i.ECM_CA_DOWNSTREAM_DEPENDENCY}]}}}},o={id:"stream-combo",dataElements:{typeRepresentation:"stream-combo",value:e,displayLabel:!0,label:i.ECM_CA_DEPENDENCY_COMBO_LABEL}},a={id:"add-main",dataElements:{typeRepresentation:"functionMenuIcon",icon:{iconName:"plus",fontIconFamily:1},tooltip:i.ECM_CA_Button_Label_Add,position:"far"},children:[]},s={id:"flow-down-main",title:i.ECA_CA_ADD_FLOWDOWN_LABEL,dataElements:{typeRepresentation:"PushItem",icon:{iconName:"flow-down",fontIconFamily:1},tooltip:i.ECA_CA_ADD_FLOWDOWN_LABEL,position:"far"},children:[]},r={type:"PushItem",title:i.ECM_CA_ChangeAction_Definition,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-new-create"},action:{module:"DS/ENOChangeActionUX/scripts/Services/CADependenciesViewServices",func:"addFlowdownDependency",argument:{options:{contextCAId:y.caId,moreInfo:{mode:"NewCA"}}}}},c={type:"PushItem",title:i.ECM_CA_Realized_Transfer_ExistingCA,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-plus"},action:{module:"DS/ENOChangeActionUX/scripts/Services/CADependenciesViewServices",func:"addFlowdownDependency",argument:{options:{contextCAId:y.caId,moreInfo:{mode:"Existing"}}}}};s.children.push(r),s.children.push(c);var d={id:"add-dep",title:i.ECM_CA_ADD_DEPENDENCY,dataElements:{typeRepresentation:"PushItem",icon:{iconName:"dependency",fontIconFamily:1},action:{module:"DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController",func:"addDependency",argument:{type:"Dependency"}},tooltip:i.ECM_CA_ADD_DEPENDENCY,position:"far"}},p={id:"add-co-dep",title:i.ECM_CA_ADD_CO_DEPENDENCY,dataElements:{typeRepresentation:"PushItem",icon:{iconName:"codependency",fontIconFamily:1},action:{module:"DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController",func:"addDependency",argument:{type:"CoDependency"}},tooltip:i.ECM_CA_ADD_CO_DEPENDENCY,position:"far"}},u={id:"remove",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"remove",fontIconFamily:1},action:{module:"DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController",func:"removeDependency"},tooltip:i.ECM_CA_REMOVE_DEPENDENCY,position:"far"}};n.entries.push(o),"true"==t&&(a.children.push(d),a.children.push(p));var h=y.caDependencyModel.get("showFlowdown");return"true"==l.getGlobalVariable().isLiteLicence&&"false"==l.getGlobalVariable().isFullLicence&&(h="false"),"true"==h&&a.children.push(s),a.children.length>0&&n.entries.push(a),"true"==t&&n.entries.push(u),n},buildGridToolbar:function(e,t,n){var a=this,s=i.ECM_CA_UPSTREAM_DEPENDENCY;"Downstream"===t&&(s=i.ECM_CA_DOWNSTREAM_DEPENDENCY);var r=this.getJSONToolbar(s,n),l=this.toolbar=e.setToolbar(JSON.stringify(r));if("Upstream"===t)try{e.getToolbar().getNodeModelByID("add-main").options.grid.data.menu.find(((t,i)=>{if("flow-down-main"===t.id)return e.getToolbar().getNodeModelByID("add-main").options.grid.data.menu.splice(i,1),!0})),0==e.getToolbar().getNodeModelByID("add-main").options.grid.data.menu.length?e.getToolbar().updateNodeModel("add-main",{disabled:!0}):console.log("")}catch(e){}var c=l.getNodeModelByID("stream-combo");return c.options.grid.data==i.ECM_CA_UPSTREAM_DEPENDENCY?c.updateOptions({tooltip:i.ECM_CA_UPSTREAM_DEPENDENCY_TOOLTIP}):c.updateOptions({tooltip:i.ECM_CA_DOWNSTREAM_DEPENDENCY_TOOLTIP}),c.onAttributeChange((async function(e){var t,n="Upstream";e.data.changedAttributeValue==i.ECM_CA_UPSTREAM_DEPENDENCY?t=i.ECM_CA_UPSTREAM_DEPENDENCY_TOOLTIP:(t=i.ECM_CA_DOWNSTREAM_DEPENDENCY_TOOLTIP,n="Downstream"),e.target.updateOptions({tooltip:t}),o.caDependencyModel.set("stream",n);var s=await o.getTreeModelForDataGridView();a.setTreeModelDefaultProperties(s);var r=o.caDependencyModel.get("dataGridView");r.treeDocument=s;try{if(y.caDependencyModel.get("showFlowdown"))if("Downstream"==n){var l=a.getFlowdownMenu();r.getToolbar().getNodeModelByID("add-main").options.grid.data.menu.push(l),r.getToolbar().updateNodeModel("add-main",{disabled:!1})}else r.getToolbar().getNodeModelByID("add-main").options.grid.data.menu.find(((e,t)=>{if("flow-down-main"===e.id)return r.getToolbar().getNodeModelByID("add-main").options.grid.data.menu.splice(t,1),!0})),0==r.getToolbar().getNodeModelByID("add-main").options.grid.data.menu.length?r.getToolbar().updateNodeModel("add-main",{disabled:!0}):console.log("")}catch(e){}})),l},setDependencyGridDefaultProperties:function(e,t){e.addEventListener("allCellsRendered",(function(){e.buildStatusBar([{type:a.STATUS.CUSTOM,id:"totalItems",dataElements:{typeRepresentation:"string",value:i.CHG_GOV_StatusBar_TotalItems+e.getTreeDocument().getNumberOfVisibleDescendants()}},{type:a.STATUS.CUSTOM,id:"selectedGridCount",dataElements:{typeRepresentation:"string",value:i.CHG_GOV_StatusBar_SelectedItems+e.getTreeDocument().getSelectedNodes().length}}])})),e.getTreeDocument().getXSO().onRemove((function(t){if(e.elements.statusBar.getNodeModelByID("selectedGridCount").updateOptions({grid:{data:i.CHG_GOV_StatusBar_SelectedItems+t.getTreeDocument().getSelectedNodes().length}}),l.getGlobalVariable().isNative){let t=[];t=e.getTreeDocument().getSelectedNodes();let i=[];for(let e=0;e<t.length;e++)i.push(t[e].options.grid.id);A.DispatchEventToWin("Add_to_CSO",i.toString())}})),e.getTreeDocument().getXSO().onAdd((function(t){if(e.elements.statusBar.getNodeModelByID("selectedGridCount").updateOptions({grid:{data:i.CHG_GOV_StatusBar_SelectedItems+t.getTreeDocument().getSelectedNodes().length}}),l.getGlobalVariable().isNative){let t=[];t=e.getTreeDocument().getSelectedNodes();let i=[];for(let e=0;e<t.length;e++)i.push(t[e].options.grid.id);A.DispatchEventToWin("Add_to_CSO",i.toString())}})),e.onContextualEvent=function(e){var t=[];if(!e.cellInfos)return t;if(e.cellInfos.rowID>-1)return o.showRMBMenu(y.caId,e.cellInfos).then((function(e){return e}));e.collectionView.columns.length,e.cellInfos.columnID;return t=e.collectionView.buildDefaultContextualMenu(e,{pin:!0,firstColumnsVisibility:!0,columnsManagement:!0,sizeColumnToFit:!1})},e.rowSelection="single",e.cellSelection="none"},setTreeModelDefaultProperties:function(e){e.onPreExpand((function(e){e.target.hasChildren()?e.target.preExpandDone():o.getChildNodesOfTarget(e.target)}))},getFlowdownMenu:function(){var e={id:"flow-down-main",title:i.ECA_CA_ADD_FLOWDOWN_LABEL,type:"PushItem",icon:{iconName:"flow-down",fontIconFamily:1},tooltip:i.ECA_CA_ADD_FLOWDOWN_LABEL,position:"far",submenu:[]},t={type:"PushItem",title:i.ECM_CA_ChangeAction_Definition,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-new-create"},action:{module:"DS/ENOChangeActionUX/scripts/Services/CADependenciesViewServices",func:"addFlowdownDependency",argument:{options:{contextCAId:y.caId,moreInfo:{mode:"NewCA"}}}}},n={type:"PushItem",title:i.ECM_CA_Realized_Transfer_ExistingCA,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-plus"},action:{module:"DS/ENOChangeActionUX/scripts/Services/CADependenciesViewServices",func:"addFlowdownDependency",argument:{options:{contextCAId:y.caId,moreInfo:{mode:"Existing"}}}}};return e.submenu.push(t),e.submenu.push(n),e}});return y})),define("DS/ENOChangeActionUX/scripts/Views/CATransferRealizedForm",["UWA/Controls/Abstract","DS/ENOChangeActionUX/scripts/Models/CATransRealDispModel","DS/E6WCommonUI/Views/DetailsDisplayView","DS/UIKIT/Input/Button","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/Views/CACustomTitleView","DS/ENOChangeActionUX/scripts/Search","DS/ENOChangeActionUX/scripts/Views/CACustomSeverityView","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgErrors"],(function(e,t,i,n,o,a,s,r,l,c,d,p){var u=e.extend({displayViewModel:null,SaveTransRealCallback:null,slideInReference:null,selectedOperation:null,detailsView:null,that:this,options:null,allCATypes:[],init:function(e){var n=this;n.allCATypes=[],1==c.getGlobalVariable().changeActionSubTypePresent&&c.getGlobalVariable().changeActionSubTypes.forEach((function(t){var i={};i.actualValue=t.value,i.displayValue=t.label,"Change Action"==t.value&&(e.defaultCATypeNLS=t.label),n.allCATypes.push(i)})),UWA.is(e)&&(this.SaveTransRealCallback=e.callback,this.displayViewModel=new t(e,{parse:!0}),this.detailsView=new i,this.options=e)},getHeading:function(){return"Existing"===this.options.Mode?o.ECM_CA_Realized_Transfer_Heading_ExistingCA:"New"===this.options.Mode?o.ECM_CA_Realized_Transfer_NewCA:void 0},getBody:function(){var e=this,t=UWA.createElement("div",{id:"formBody"});t.setAttribute("data-rec-id","formBodyCA");var i=UWA.Class.View.extend({setup:function(){"Existing"===e.options.Mode&&this.listenTo(this.model,"onChange",this.render),this.listenTo(this.model,"onChange:createObjectTitle",e.updateBtnState)},render:function(){t.setContent(""),e.detailsView.setConfig(e.getConfig()),e.detailsView.model=e.displayViewModel,e.detailsView.tenant=c.getGlobalVariable().tenant,e.detailsView.context=enoviaServer.context,e.detailsView.render().inject(t),arguments&&arguments.length>0&&e.updateBtnState(arguments[0])}});new i({model:e.displayViewModel}).render();return t},getFooter:function(){var e=this,t=u.footer=UWA.Element("div",{});return new n({value:o.ECM_CA_Realized_Transfer_Save,className:"primary proposedButtons",disabled:!0}).inject(t).elements.input.onclick=function(){e.onSaveButtonClick()},new n({value:o.ECM_CA_Realized_Transfer_Cancel,className:"proposedButtons"}).inject(t).addEvent("onClick",this.onCancelButtonClick.bind(this)),t},getCreateEditData:function(e){var t="";if(UWA.is(e)){var i=e.get("createObjectTitle"),n=e.get("descriptionOfObj");n||(n="");var o=e.get("severity"),a="",s="Change Action";if(1==c.getGlobalVariable().changeActionSubTypePresent&&(s=e.get("caType").actualValue),UWA.is(e.get("dueDate"))){var r,l;r=e.get("dueDate").actualValue;var d=(l=new Date(r)).getMonth()+1,p=l.getDate();a=l.getFullYear()+"-"+d+"-"+p}t={type:s,description:n,synopsis:i,severity:o,scheduledCompletionDate:a}}return t},getTransferRealizedData:function(e){return{transferPurpose:e.get("reasonForChangeForActivity").actualValue,transferComment:"textofTransfer",idsToTransfer:this.options.ids}},onSaveButtonClick:function(){var e=this,t=function(t){e.slideInReference.hideSlideIn(),a.endWait(widget.body),p.success(o.ECM_CA_Realized_Transfer_Success),e.SaveTransRealCallback(t)};if(this.detailsView.isModelValid()){if("New"===this.options.Mode){var i=this.getCreateEditData(this.displayViewModel),n=this.getTransferRealizedData(this.displayViewModel);a.doWait(widget.body),d.createCAAndTransferRealized(i,n,t,(function(t){a.endWait(widget.body),e.slideInReference.hideSlideIn()}))}else if("Existing"===this.options.Mode){i=this.getTransferData(this.displayViewModel),n=this.getTransferRealizedData(this.displayViewModel);a.doWait(widget.body),d.transferRealized(i,n,t)}}else p.error(o.ECM_CA_Realized_Transfer_MandAttrErr)},onCancelButtonClick:function(){this.slideInReference.hideSlideIn()},getConfig:function(){var e,t=[];if(e=new Date,"New"===this.options.Mode&&(1==c.getGlobalVariable().changeActionSubTypePresent&&"true"==c.getGlobalVariable().CHG_TRANSFER_REALIZED_CUST_TYPE&&t.push({required:!0,readWrite:"true",name:"caType",label:o.ECM_CA_Type,type:"select",values:this.allCATypes}),t.push({required:!0,label:"Title",name:"createObjectTitle",customView:s}),t.push({readWrite:"true",name:"descriptionOfObj",label:o.ECM_CA_Realized_Transfer_Description,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3}),t.push({label:o.ECM_CA_Realized_Transfer_Severity,name:"severity",customView:l}),t.push({label:o.ECM_CA_Realized_Transfer_DueDate,name:"dueDate",readWrite:"true",type:"date",min:e}),t.push({readWrite:"true",name:"reasonForChangeForActivity",label:o.ECM_CA_Realized_Transfer_ReasonForTransfer,type:"select",values:this.getTransferOptionsValues()})),"Existing"===this.options.Mode){var i,n="";n=n+"NOT ("+this.options.contextCAId.replace("pid","physicalid")+")";var a=new r({title:"Change Action",precond:i='AND (current:Prepare OR current:"In Work") AND (NOT flattenedtaxonomies:"interfaces/Change On Hold")',excludeList:n,from:"realized",types:"Change Action"},!1);t.push({readWrite:!UWA.is(this.displayViewModel.id),type:"object",name:"changeaction",label:o.ECM_CA_Widget_Title,attributeToDisplay:"objectName",singleObjectOnly:!0,searchTitle:o.ECM_CA_Widget_Title,searchTypes:"Change Action",required:!UWA.is(this.displayViewModel.id),imageAttribute:"image",typeAheadCallback:this.displayViewModel.proposedTypeAheadCallback,fieldHTMLId:"changeaction",excludeSearchTypes:n+i,search:a}),t.push({readWrite:"true",name:"reasonForChangeForActivity",label:o.ECM_CA_Realized_Transfer_ReasonForTransfer,type:"select",values:this.getTransferOptionsValues()})}return t},getTransferData:function(e){return{version:"v0",changeaction:e.get("changeaction")}},updateBtnState:function(){var e=arguments[0];if(e){var t,i=e.get("createObjectTitle"),n=e.get("changeaction");if(i&&""!=i.trim()||n&&""!=n.objectID){if(u.footer)(t=u.footer).firstChild.disabled=!1,t.firstChild.removeClassName("disabled")}else if(u.footer)(t=u.footer).firstChild.disabled=!0,t.firstChild.addClassName("disabled")}},getTransferOptionsValues:function(){var e=[];return"true"===this.options.RealizedTransferBit&&e.push({displayValue:o.ECM_CA_Realized_Transfer_EarlyCompl,actualValue:"early"},{displayValue:o.ECM_CA_Realized_Transfer_DelayedCompl,actualValue:"late"}),e.push({displayValue:o.ECM_CA_Realized_Transfer_Move,actualValue:"simple"}),e}});return u})),define("DS/ENOChangeActionUX/scripts/Views/CANewRealizedView",["UWA/Class/View","DS/ENOChangeActionUX/scripts/Views/CARealizedOperationView","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/W3DXComponents/Views/Item/CounterView","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/ENOChangeActionUX/scripts/Collection/CARealizedCollection","DS/ENOChangeActionUX/scripts/Views/CAProposedSearchFilterView","DS/ENOChangeActionUX/scripts/Views/CASlideInTransferRealizedView","DS/ENOChangeActionUX/scripts/Views/CATransferRealizedForm","DS/ENOChangeActionUX/scripts/Views/CAFlowDownRealizedForm","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgRouter5/scripts/ChgRouter","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/PlatformAPI/PlatformAPI","DS/ENOChgGovernanceUX/scripts/wrapper/ChgGovBIFilter","DS/UIKIT/DropdownMenu","DS/ENOChangeActionUX/scripts/CACommonIgnore","DS/ENOChgServices/scripts/services/ChgDataService","require","DS/ENOChgGovernanceUX/scripts/util/DocumentUtils","DS/ENOChgServices/scripts/services/UserPreferenceUtil","DS/ENOChgServices/scripts/services/DefaultPreferencesManager","DS/Controls/Loader","DS/ENOChgGovernanceUX/scripts/util/ChgDataGridUtil"],(function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,y,b,S,E,_,D,O,N,M,I,x,T,R,V,P,U){"use strict";var W={sortingFirstTime:!0,filteredText:"",_tempReferenceToWinSearchCallback:null,realizedCollection:new d,invokedFrom:"",filteredObjectIds:null,filteredActivities:null,groupid:void 0,_createView_NewRealized:function(n,o,d,m,I){return W.caModel_OldUX=m,e.extend({name:"changeView",tagName:n,className:o,currModel:null,model:m,flowdownOptions:I,filteredText:I.objNametoFilterforFlowDown,RealizedModel:null,modelsToRemove:[],selectedOperationItems:[],setup:function(){var e=this;W.options_copy=I,W.Realized_Filter_Map=y.getCARealizedFilterMapping(),W.lastFilterView=null,W.isGroupSelectionActive=!1,W.groupid=void 0,W.filteredObjectIds=void 0,W.filteredActivities=void 0,D.unsubscribe("ca-realized-collection-updated"+widget.id+this.model.id),D.unsubscribe("ca-IDCard-on-change-refresh"),D.unsubscribe("ca-IDCard-on-change-maturity"),D.subscribe("ca-realized-collection-updated"+widget.id+this.model.id,(function(t){e.render(),e.resetText()})),D.subscribe("ca-IDCard-on-change-refresh",(function(e){W.updateRealizedCollection(e)})),D.unsubscribe("ECM_GOV_RealizedDGV_ON_3DSpace"),D.subscribe("ECM_GOV_RealizedDGV_ON_3DSpace",(function(e){require(["DS/ENOChgGovernanceUX/scripts/view/changeAction/facets/realizedChanges/ChgCARealizedChangesController"],(function(t){e.init_options.target=document.querySelector("."+e.init_options.targetclassName),e.init_options.target.empty(),new t(e.init_options).createRealizedChangesView()}))})),D.unsubscribe("ECM_GOV_Realized_LTV_ON_3DSpace"),D.subscribe("ECM_GOV_Realized_LTV_ON_3DSpace",(function(){var e=new(W._createView_NewRealized("div","test-realized-facet",!0,W.caModel_OldUX,W.options_copy));e.container=document.querySelector("."+W.options_copy.init_options.targetclassName),e.container.empty(),e.render()})),D.unsubscribe("ECM_GOV_Realized_LTV_ON_Dashboard"),D.subscribe("ECM_GOV_Realized_LTV_ON_Dashboard",(function(){var e=new(W._createView_NewRealized("div","test-realized-facet",!0,W.caModel_OldUX,W.options_copy));e.container=document.querySelector("."+W.options_copy.init_options.targetclassName),e.container.empty(),e.render()})),D.unsubscribe(`caRealizedChanges:${widget.id}`),D.unsubscribe(`caRealizedChanges of ${widget.id}`),D.subscribe(`caRealizedChanges:${widget.id}`,(function(){"false"==C.getGlobalVariable().slidePanelTagger&&require(["DS/ENOChgGovernanceUX/scripts/wrapper/ChgGovBIFilter"],(function(e){e._initializationPromiseBIFilter||e.initializeBIFilter(),e._cleanBIFilterProxy(),e.cleanPathTag();for(var t=[],i=W.getRealizedCollection(),n=0;n<i.length;n++){var o=i.at(n);if(o){var a=o.get("id");a=a.replace("pid:",""),t.push(a),o.get("activities").forEach((function(e){e.get("ActivityDetails").forEach((function(e){if(!e.sameAsWhere){if(e.AfterExists){var i=e.After.id;i=i.replace("pid:",""),t.push(i)}if(e.BeforeExists){var n=e.Before.id;n=n.replace("pid:",""),t.push(n)}}}))}))}}e._onSetPathTagsForProposedRealized(t,{options:{id:"caRealizedChanges"}})}))})),D.subscribe(`caRealizedChanges of ${widget.id}`,(function(t){for(var i=t.matchingIDs,n=[],o=0;o<i.length;o++)n.push("pid:"+i[o]);W.filteredObjectIds=n,e.filterRealizedCollection()})),D.subscribe("ca-IDCard-on-change-maturity",(function(e){W.updateRealizedCollection(e)})),g.isWaiting()||g.doWait(widget.body),this.template='                                            <div class="'+this.getClassNames("-container")+'">                                            <div class="Realized-Operations-header">                                                     <div class="'+this.getClassNames("-RealizedCounter")+'"></div>                                                    <div class="'+this.getClassNames("-RealizedActions")+'"></div>                                                    <div class="'+this.getClassNames("-realizedMultisel")+'"></div>                                               </div>                                               <div class="'+this.getClassNames("-Search-container")+'"></div>                                              <div class="'+this.getClassNames("-Realizedoperation-container")+'"></div>                                            <div>',W.invokedFrom=this.model.invokedFrom,W.id=this.model.id,this.loader=(new P).inject(I.init_options.target),this.loadFilteredRealizedData(W.Realized_Filter_Map.DEFAULT)},initSubViews:function(){this._initActionsView(),this._initCounterView(),null!=W.lastFilterView&&"DEFAULT"!==W.lastFilterView||this._initMultiSelView(),this._initSearchFilterView(this.originalRealizedCollection),this._initOperationView(this.originalRealizedCollection)},resetText:function(){this.filteredText="",this.filteredRealizedCollection=new UWA.Class.Collection(this.originalRealizedCollection.toArray())},render:function(){console.log("Realized Rendering Started"),C.getGlobalVariable().allSelectedActivity=[],C.getGlobalVariable().allSelectedActivityId=[],this.currModel=this.model,A.setCurrModel(this.model);var e=W.getRealizedCollection(),n=this;"gov"!=W.invokedFrom&&(this.listenTo(this.currModel,"onChange:realized",this.render),e&&this.listenTo(this.currModel,"onChange:realized",this.resetText)),this.originalRealizedCollection=e,n.initSubViews(),this.renderer=this.getTemplate(this.template);var o=this.name,a=(this.cid,null);UWA.is(this.containerReference)&&(a=this.containerReference.getElement(".main-Realized-change-container"),UWA.is(a)&&(a.empty(),a.destroy(),a=null)),this.containerReference=this.container,UWA.is(a)||(a=this.mainContainerDiv=UWA.createElement("div",{class:"main-Realized-change-container",styles:{width:"100%",height:"100%"}})),a.addEvent("resize",(function(){setTimeout((function(){t.onResize()}),50)}));var s=this.renderer();a.addContent(s),a.inject(this.containerReference),this.injectSubView(this.counterView,"."+o+"-RealizedCounter"),this.injectSubView(this.actionsView,"."+o+"-RealizedActions"),this.injectSubView(this.searchFilterView,"."+o+"-Search-container"),this.injectSubView(this.operationView,"."+o+"-Realizedoperation-container"),this.actionsView&&this.actionsView.dispatchEvent("onShow"),this.counterView&&this.counterView.dispatchEvent("onShow"),null!=W.lastFilterView&&"DEFAULT"!==W.lastFilterView||(this.injectSubView(this.realizedMultiSelView,"."+o+"-realizedMultisel"),this.realizedMultiSelView&&this.realizedMultiSelView.dispatchEvent("onShow"));n=this;W.filterViewMenu=new N({target:a.querySelector("div.changeView-RealizedActions span.fonticon-list-filter"),multiSelect:!1,closeOnClick:!0,items:[{name:"DEFAULT",text:i.ECM_CA_Filter_Realized_Menu_Default,selected:null==W.lastFilterView||"DEFAULT"===W.lastFilterView,selectable:!0},{name:"TRANSFERRED",text:i.ECM_CA_Filter_Realized_Menu_Transferred,selected:"TRANSFERRED"===W.lastFilterView,selectable:!0},{name:"IGNORED",text:i.ECM_CA_Filter_Realized_Menu_Ignored,selected:"IGNORED"===W.lastFilterView,selectable:!0}],events:{onClick:function(e,t){t=W.filterViewMenu.getSelectedItems()[0];var i=1;switch(W.lastFilterView=t.name,t.name){case"DEFAULT":i=W.Realized_Filter_Map.DEFAULT;break;case"TRANSFERRED":i=W.Realized_Filter_Map.TRANSFERRED;break;case"IGNORED":i=W.Realized_Filter_Map.IGNORED}n.loadFilteredRealizedData(i)}}}),W.switchViewMenu=new N({target:a.querySelector("div.changeView-RealizedActions span.fonticon-view-big-tile"),multiSelect:!1,closeOnClick:!0,items:[{name:"LTV",text:i.ECM_CA_LTV,fonticon:"view-big-tile",selected:!0,selectable:!0},{name:"DGV",text:i.ECM_CA_DGV,fonticon:"view-list",selected:!1,selectable:!0}],events:{onClick:function(e,t){switch(W.switchViewMenu.getSelectedItems()[0].name){case"LTV":break;case"DGV":W.options_copy.init_options.target.empty(),!0===C.getGlobalVariable().is3DSpace||D.publish("ECM_GOV_Realized_DGV_ON:"+widget.id,W.options_copy)}}}});var r=[];W.getFilterValuesByOperation().forEach((function(e,t){r.push({name:t,text:e.actDisplayName,selected:!1,selectable:!0})})),W.filterOperationViewMenu=new N({target:a.querySelector("div.changeView-RealizedActions span.fonticon-filter"),multiSelect:!0,closeOnClick:!0,items:r,events:{onClick:function(e,t){var i=W.filterOperationViewMenu.getSelectedItems(),o=[];i.forEach((function(e,t){o.push(e.name)})),W.filteredActivities=o,n.filterRealizedCollection()}}}),U.hideLoader(W.options_copy.init_options.target,this.loader)},loadFilteredRealizedData:function(e){U.showLoader(W.options_copy.init_options.target,this.loader);var t=this;y.getCARealizedData(this.model.id,e).then((function(e){if(e.changeaction.group&&e.changeaction.group.id&&(W.groupid=e.changeaction.group.id),Array.isArray(e.changeaction.context)&&e.changeaction.context.length>0&&(W.context=e.changeaction.context),UWA.is(e.changeaction.realized)){var i=f.createRealizedCollection(e.changeaction.realized);y.enrichCollectionForRealized(i).then((function(e){t.model&&(W.setRealizedCollection(e,t.model.id),(t.model.isSelected||t.model.get("isSelected")&&"false"==C.getGlobalVariable().slidePanelTagger)&&require(["DS/ENOChgGovernanceUX/scripts/wrapper/ChgGovBIFilter"],(function(e){e._initializationPromiseBIFilter||e.initializeBIFilter(),e._cleanBIFilterProxy(),e.cleanPathTag();for(var t=[],i=W.getRealizedCollection(),n=0;n<i.length;n++){var o=i.at(n);if(o){var a=o.get("id");a=a.replace("pid:",""),t.push(a),o.get("activities").forEach((function(e){e.get("ActivityDetails").forEach((function(e){if(!e.sameAsWhere){if(e.AfterExists){var i=e.After.id;i=i.replace("pid:",""),t.push(i)}if(e.BeforeExists){var n=e.Before.id;n=n.replace("pid:",""),t.push(n)}}}))}))}}e._onSetPathTagsForProposedRealized(t,{options:{id:"caRealizedChanges"}})})))}))}}),(function(e,i){U.hideLoader(W.options_copy.init_options.target,t.loader)}))},injectSubView:function(e,t){var i=this.containerReference.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e){var t=a.compile(e),n=[];this.activitiesViewArr=[],UWA.is(this.originalRealizedCollection)&&this.originalRealizedCollection.forEach((function(e,t){n.push({})})),this.data={RealizedNls:i.ECM_CA_RealizedChanges,RealizedNum:n.length,changes:n};var o=this;return function(){return t(o.data)}},_initCounterView:function(e){this.counterView&&this.counterView.destroy(),this.counterView=new s({title:i.ECM_CA_RealizedChanges,collection:UWA.is(e)?e:this.originalRealizedCollection})},_initActionsView:function(){var e=i.ECM_CA_Sort_ProposedChanges_Title,n=[];A.getCurrentModel();W.groupid&&"true"==C.getGlobalVariable().CHG_CHANGE_GROUP&&0==C.getGlobalVariable().is3DSpace&&n.push({id:"contextRealized",title:1==W.isGroupSelectionActive?i.ECM_CA_REALIZED_CONTEXT_REALIZED_TOOLTIP:i.ECM_CA_REALIZED_GROUP_REALIZED_TOOLTIP,icon:1==W.isGroupSelectionActive?"checkbox-on":"select-all-checkboxes",overflow:!1}),n.push({id:"search",title:i.ECM_CA_Search_RealizedChanges,icon:"search",overflow:!1},{id:"sort",title:e,icon:"sort-alpha-asc",overflow:!1},{id:"ExpandMenu",title:i.ECM_CA_Expand,icon:"flow-tree-expand-down",overflow:!1}),null!=W.lastFilterView&&"DEFAULT"!==W.lastFilterView||n.push({id:"SelectAll",title:i.SelectAll,icon:"select-all",overflow:!1},{id:"UnSelectAll",title:i.UnSelectAll,icon:"select-none",overflow:!1},{id:"filterOperationView",title:i.ECM_CA_Filter_Realized_Operations,icon:"filter",overflow:!1}),n.push({id:"filterView",title:i.ECM_CA_Filter_Realized,icon:"list-filter",overflow:!1}),UWA.is(C.getGlobalVariable().is3DSpace)&&!0===C.getGlobalVariable().is3DSpace||n.push({id:"switchView",title:i.ECM_CA_SWITCH_VIEW,icon:"view-big-tile",overflow:!1});var o=new l(n);this.actionsView&&this.actionsView.destroy(),this.actionsView=new r({collection:o});var a=this._actionsViewEvents={onActionClick:function(){var e=arguments[1].model.get("id"),i=(arguments[1].model.get("title"),document.getElementsByClassName("fonticon fonticon-flow-tree-expand-down")),n=!0;switch(0!=i.length?n=!1:i=document.getElementsByClassName("fonticon fonticon-flow-tree-expand-up"),e){case"contextRealized":this.handleGroupRealized();break;case"sort":this.sortRealized();break;case"search":this.searchRealized(this);break;case"ExpandMenu":if(this.multiSelView){var o=document.getElementsByClassName("fonticon fonticon-select-all"),a=document.getElementsByClassName("fonticon fonticon-select-none");if(0!=o.length&&0!=a)var s=this.disableIcon(o,"select-all"),r=this.disableIcon(a,"select-none");"Expand All"===this.actionTitle?(this.expand=!1,this.actionTitle="Collapse All",C.getGlobalVariable().isNative||0!=o.length&&0!=a.length&&(s.removeAttribute("style"),r.removeAttribute("style")),t.collapseAllActivity()):(this.expand=!0,this.actionTitle="Expand All",C.getGlobalVariable().isNative||0!=o.length&&0!=a.length&&(this.disableIconStyle(s),this.disableIconStyle(r)),t.expandAllActivity()),this.changeExpandIcon(i,n)}break;case"SelectAll":if(this.multiSelView){if(O._deactivate(),0!=(c=document.getElementsByClassName("fonticon fonticon-flow-tree-expand-down")).length){var l=this.disableIcon(c,"expand-down");this.disableIconStyle(l)}t.selectAll()}break;case"UnSelectAll":var c;if(this.multiSelView)if(O._activate(),t.UnselectAll(),this.multiSelView.exitMultisel(),this.multiSelView.dispatchEvent("onMultiselOff",[this.multiSelView,!1]),0!=(c=document.getElementsByClassName("fonticon fonticon-flow-tree-expand-down")).length)(l=this.disableIcon(c,"expand-down")).removeAttribute("style");break;case"filterView":W.filterViewMenu.show();break;case"switchView":W.switchViewMenu.show();break;case"filterOperationView":W.filterOperationViewMenu.show()}}};this.listenTo(this.actionsView,a)},TransferRealized:function(e){var t=this,n=t.model.get("userAccess");if(e&&e.ids.length>0){var o={ids:e.ids,contextCAId:t.model.get("id"),Mode:e.mode,Entity:"ChangeAction",RealizedTransferBit:n.RealizedTransfer,callback:function(){C.getGlobalVariable().arrOid=[],t.loadFilteredRealizedData(W.Realized_Filter_Map.DEFAULT)}},a=new h(o),s=new u({invokedFrom:W.invokedFrom});s.buildSlideIn(a),s.showSlideIn()}e&&e.incorrectSelectedIds&&e.incorrectSelectedIds.length>0&&(e.incorrectSelectedIds.length==t.modelsToRemove.length?v.error(i.ECM_CA_Invalid_Selection_Error):v.warn(i.ECM_CA_Invalid_Selection_Warning))},handleGroupRealized:function(){var e=document.getElementsByClassName("fonticon fonticon-select-all-checkboxes");g.doWait(widget.body);var t=A.getCurrentModel();t.get("id").replace("pid:","");0!=e.length&&W.groupid?(W.isGroupSelectionActive=!0,y.getGroupCARealizedData(W.groupid).then((function(e){if(UWA.is(e.realized)){var i=f.createRealizedCollection(e.realized);y.enrichCollectionForRealized(i).then((function(e){W.setRealizedCollection(e,t.id)}))}}))):(W.isGroupSelectionActive=!1,y.getCARealizedData(t.id,W.Realized_Filter_Map.DEFAULT).then((function(e){if(W.lastFilterView="DEFAULT",UWA.is(e.changeaction.realized)){var i=f.createRealizedCollection(e.changeaction.realized);y.enrichCollectionForRealized(i).then((function(e){W.setRealizedCollection(e,t.id)}))}})))},changeShowGroupIcon:function(e,t){e.length>0&&(e[0].className=t?"fonticon fonticon-select-all-checkboxes":"fonticon fonticon-checkbox-on")},sortRealized:function(){var e=new UWA.Class.Collection,t=document.getElementsByClassName("fonticon fonticon-sort-alpha-asc"),i=!0;0!=t.length?i=!1:t=document.getElementsByClassName("fonticon fonticon-sort-alpha-desc");var n,o=[],a=[],s=[],r={};if((n=(c=this).filteredRealizedCollection?c.filteredRealizedCollection:c.originalRealizedCollection).length>0){var l=[];n.sortBy((function(e,t,i){var l=e.get("objectTitle"),c=e.get("revision").toLowerCase(),d=l.toLowerCase()+c;r[d]=l,a.push(d),a.sort(),i.length-1===t&&a.forEach((function(e){var t=r[e];s=n.where({objectTitle:t}),Array.isArray(s)&&s.forEach((function(t){(t&&null==t.get("IdentifierWithRevision")||t&&t.get("IdentifierWithRevision")&&t.get("IdentifierWithRevision").toLowerCase()===e)&&o.push(t)}))}))})),l=o,i||1==W.sortingFirstTime||l.reverse();e=new UWA.Class.Collection(l);this.filteredRealizedCollection?this.filteredRealizedCollection=e:this.originalRealizedCollection=e,document.querySelector(".Realized-operations-details").innerHTML="";var c=this;g.doWait(widget.body),setTimeout((function(){c.operationView.destroy();c.operationView=c._initOperationView(e);c.injectSubView(c.operationView,"."+c.name+"-Realizedoperation-container"),g.endWait(widget.body)}),100),this.RealizedModel=e,null!=W.lastFilterView&&"DEFAULT"!==W.lastFilterView||(this.realizedMultiSelView.destroy(),this._initMultiSelView(),this.injectSubView(this.realizedMultiSelView,"."+this.name+"-realizedMultisel"),this.selectedOperationItems.splice(0,this.selectedOperationItems.length),this.modelsToRemove.splice(0,this.modelsToRemove.length)),!1===W.sortingFirstTime&&this.changeSortIcon(t,i),W.sortingFirstTime=!1}},changeSortIcon:function(e,t){e.length>0&&(e[0].className=t?"fonticon fonticon-sort-alpha-asc":"fonticon fonticon-sort-alpha-desc")},changeExpandIcon:function(e,t){e.length>0&&(e[0].className=t?"fonticon fonticon-flow-tree-expand-down":"fonticon fonticon-flow-tree-expand-up")},disableIconStyle:function(e){e.setStyle("pointer-events","none"),e.setStyle("color","#b4b6ba")},disableIcon:function(e,t){for(var i=0;i<=e.length;i++){var n=0;if(e[i].offsetParent&&e[i].outerHTML.includes(t)&&e[i].offsetParent.outerHTML.includes("action-container")){n=i;break}}return e[n].closest(".action-container")},searchRealized:function(e){document.getElementsByClassName("search-main-container");var t=e.containerReference.getElement(".search-main-container");if(t.hasClassName("hidden")){t.removeClassName("hidden");var i=t.getElement(".searchfilter-input-container");i.addClassName("highlighted-border"),i.removeClassName("border-without-focus"),t.getElement("input").focus()}else t.addClassName("hidden");var n=t.hasClassName("hidden"),o=e.containerReference.getElement(".changeView-Realizedoperation-container");!n&&o?o.setStyle("height","calc(100% - 97px)"):o&&o.setStyle("height","calc(100% - 46px)")},_initOperationView:function(e){this.operationView&&this.operationView.destroy();var i={tagName:"div",className:"Realized-operations-details",idcarView:!1,caModel:this.model,realizedModel:e,flowdownOptions:this.flowdownOptions},n=this.operationView=new(t._createView_NewRealized(i)),o=this,a=this._operationsEvents={onCheckboxClick:function(e){var i=this.selectedOperationItems.indexOf(e.cid);if(-1===i)this.selectedOperationItems.push(e.cid),this.modelsToRemove.push(e),O._deactivate();else if(this.selectedOperationItems.splice(i,1),this.modelsToRemove.splice(i,1),0===this.modelsToRemove.length){t.deactivateMultisel(),O._activate();var n=document.getElementsByClassName("fonticon fonticon-flow-tree-expand-down");if(0!=n.length)this.disableIcon(n,"expand-down").removeAttribute("style")}if(this.multiSelView){var o={isActive:!0};o.selectedObjects=this.modelsToRemove,this.multiSelView.destroyDropDown();var a=[];if(C.getGlobalVariable().isNative){for(var s=0;s<o.selectedObjects.length;s++){var r;r=o.selectedObjects[s].id,a.push(r.replace("pid:",""))}W.operationsToExplore=this.modelsToRemove,b.DispatchEventToWin("MultiSel_ExpInCtx_RealizedOperation_CmdChk",a)}else this.multiSelView.buildMultisel(o);let e=W.id.slice(4),t=[];for(let e=0;e<o.selectedObjects.length;e++){let i=o.selectedObjects[e],n={id:i.id.slice(4),type:i._attributes.objectType},a=new _({grid:n});t.push(a)}if(0==o.selectedObjects.length){let e=new _({});t.push(e)}(new E).addRoot(t),0!=o.selectedObjects.length&&t[0].getTreeDocument().selectAll(),S.getDependency("applicationChannel").publish({event:"update-property-panel-data",data:{context:t[0],PhysicalID:e,type:"ChangeAction",load:!0}})}},onItemViewDrag:function(){var e;e=this.buildStructureToDragForOperation(arguments),arguments[1]=e;var t=W.context,i=[];Array.isArray(t)&&t.forEach((function(e){var t=e.id;t&&i.push(t.substr(4))}));var n={caId:o.model.get("id"),caContextIds:i,typeOfDrag:"Realized"};A.onItemViewDragForContents(arguments,n)},transferSelectedItems:function(){var e=arguments[0];if(e&&e.selectedIDs.length>0){var t={ids:e.selectedIDs,mode:e.transferMode};o.TransferRealized(t)}},ignoreSelectedItems:function(){o.loadFilteredRealizedData(W.Realized_Filter_Map.DEFAULT)},onCheckboxClickNative:function(e){if(this.multiSelView){var t={isActive:!0};this.modelsToRemove.push(e),t.selectedObjects=this.modelsToRemove,this.multiSelView.destroyDropDown(),C.getGlobalVariable().isNative&&this.multiSelView.buildMultisel(t)}}};return this.listenTo(n,a),n},buildStructureToDragForOperation:function(e){var t={};if(this.modelsToRemove.length)for(var i in this.modelsToRemove){var n=this.modelsToRemove[i];n&&(t[n.get("id")]=n)}else t=e[1];return t},AfterSaveTransReal:function(e){},_initSearchFilterView:function(){this.searchFilterView&&this.searchFilterView.destroy();var e=this.searchFilterView=new p({fromIDCard:!1,collection:this.originalRealizedCollection,placeholder:i.ECM_CA_Searchby_NameTitle}),t=this._operationsEvents={keyup:function(e){this.refineRealized(e)}};this.listenTo(e,t)},refineRealized:function(e){var t=e.target.value;W.enteredText=t,this.filterRealized()},filterRealized:function(){this.filteredRealizedCollection&&this.filteredRealizedCollection.length&&this.filteredRealizedCollection.reset();var e=this.originalRealizedCollection.filter(this.filterNameBased);this.filteredRealizedCollection=new UWA.Class.Collection(e);var t=document.querySelector(".Realized-operations-details");t||t.destroy();var i=this;if(g.doWait(widget.body),setTimeout((function(){i.operationView.destroy();i.operationView=i._initOperationView(i.filteredRealizedCollection);i.injectSubView(i.operationView,"."+i.name+"-Realizedoperation-container"),g.endWait(widget.body)}),100),this.counterView.destroy(),this._initCounterView(this.filteredRealizedCollection),this.injectSubView(this.counterView,"."+this.name+"-RealizedCounter"),null!=W.lastFilterView&&"DEFAULT"!==W.lastFilterView||(this.realizedMultiSelView.destroy(),this._initMultiSelView(),this.injectSubView(this.realizedMultiSelView,"."+this.name+"-realizedMultisel"),this.selectedOperationItems.splice(0,this.selectedOperationItems.length),this.modelsToRemove.splice(0,this.modelsToRemove.length)),!C.getGlobalVariable().is3DSpace)this.filteredRealizedCollection},filterNameBased:function(e){var t=!1,i=e.get("objectName"),n=e.get("objectTitle"),o=W.enteredText;if(o&&o.length){O._deactivate(),i&&(i=i.toLowerCase()),n&&(n=n.toLowerCase()),o=o.toLowerCase();var a=i.indexOf(o);if(a<0&&(a=n.indexOf(o)),t=a>=0,""===W.filteredText)e.get("activities").forEach((function(e){var i=[],n=e.get("OriginalActivityDetails")[0];if(1==t&&n.sameAsWhere)i.push(n);else{var a=-1;if(n.AfterExists){var s=e.get("Afterobject"),r=s.name,l=s.title;if(r&&(r=r.toLowerCase()),l&&(l=l.toLowerCase()),(a=r.indexOf(o))<0&&(a=l.indexOf(o)),a<0&&s.instanceName)a=s.instanceName.toLowerCase().indexOf(o.toLowerCase())}if(a<0&&n.BeforeExists){var c=e.get("Beforeobject");r=c.name,l=c.title;if(r&&(r=r.toLowerCase()),l&&(l=l.toLowerCase()),(a=r.indexOf(o))<0&&(a=l.indexOf(o)),a<0&&c.instanceName)a=c.instanceName.toLowerCase().indexOf(o.toLowerCase())}a>=0&&i.push(n)}i.length>0&&(t=!0),e.set("ActivityDetails",i,{silent:!0})}))}void 0!==o&&0!==o.length||(e.get("activities").forEach((function(e){var t=e.get("OriginalActivityDetails");e.set("ActivityDetails",t,{silent:!0})})),t=!0,O._activate());if(1==t)return e},_initMultiSelView:function(){var e=this,i={collection:new l,withMultisel:!0,useInfiniteScroll:!1,usePullToRefresh:!1,buildMultiselActions:function(t){return e.getMultiselActions(t)},events:{onMultiselOff:function(){O._activate(),t.deactivateMultisel(),e.modelsToRemove.splice(0,e.modelsToRemove.length),e.selectedOperationItems.splice(0,e.selectedOperationItems.length),this.isInMultiselMode=!1;var i=document.getElementsByClassName("fonticon fonticon-flow-tree-expand-down");0!=i.length&&e.disableIcon(i,"expand-down").removeAttribute("style")},onMultiselOn:function(){O._deactivate(),t.activateMultisel(),this.isInMultiselMode=!0;var i=document.getElementsByClassName("fonticon fonticon-flow-tree-expand-down");if(0!=i.length){var n=e.disableIcon(i,"expand-down");e.disableIconStyle(n)}},onActionClickDotted:function(){var e=widget.body.getParent("body");e&&e.addClassName("for-mobile")}}};this.multiSelView&&this.multiSelView.destroy(),this.modelsToRemove.splice(0,this.modelsToRemove.length),this.selectedOperationItems.splice(0,this.selectedOperationItems.length),this.multiSelView=this.realizedMultiSelView=new c(i),W.multiSelView=this.multiSelView},getMultiselActions:function(e){var t,n=this,o=[],a=C.getGlobalVariable().isNative;if(a&&e.result&&(t=!0),t||!a){var s={id:"ignore",text:i.ECM_CA_Realized_Ignore_Change,fonticon:"ignore",icon:"I_ChangeIgnore_22",multisel:!0,handler:function(e){var t=[];n.modelsToRemove.length&&n.modelsToRemove.forEach((function(e,i){t.push(e.get("id"))}));var o={originChangeActionId:A.getCurrentModel().id,idsToReject:t};M.ignoreNodes(o,widget.body,(function(e){"success"===e.status&&(C.getGlobalVariable().arrOid=[],n.loadFilteredRealizedData(W.Realized_Filter_Map.DEFAULT),v.success(i.ECM_CA_Realized_Ignore_Success),g.endWait(widget.body))}),(function(e,t){g.endWait(widget.body),t&&t.errorMessage?v.error(t.errorMessage):v.error(i.ECM_CA_Realized_Ignore_ERR_MSG)}))}};(p=n.model.get("userAccess"))&&"true"===p.RealizedReject&&o.push(s);var r=window.matchMedia("(max-width: 768px)"),l=i.ECM_CA_Realized_Transfer_ExistingCA,c=i.ECM_CA_Realized_Transfer_NewCA,d=i.ECM_CA_Realized_Transfer;r.matches&&(l=i.ECM_CA_Existing,c=i.ECM_CA_New,d=i.ECM_CA_Realized_Mobile_Transfer);var p,u={id:"transfer",text:d,fonticon:"sync",icon:"transfer_realized_new",multisel:!0,items:[{id:"Transfer_NewCA",text:c,fonticon:"new-create",icon:"I_FlowDownToNewCA",multisel:!0,handler:function(e){if(n.modelsToRemove.length){var t=[],i=[];n.modelsToRemove.forEach((function(e,n){e.get("Access")&&"Transferred"!=e.get("status")?t.push(e.get("id")):i.push(e.get("id"))}))}var o={ids:t,mode:"New",incorrectSelectedIds:i};n.TransferRealized(o)}},{id:"Transfer_existingca",text:l,fonticon:"plus",icon:"I_FlowDownToExisting",multisel:!0,handler:function(e){if(n.modelsToRemove.length){var t=[],i=[];n.modelsToRemove.forEach((function(e,n){e.get("Access")&&"Transferred"!=e.get("status")?t.push(e.get("id")):i.push(e.get("id"))}))}var o={ids:t,mode:"Existing",incorrectSelectedIds:i};n.TransferRealized(o)}}]};(p=n.model.get("userAccess"))&&"true"===p.MoveRealizedChange&&o.push(u);var h={id:"download",text:i.ECM_CA_Download,fonticon:"download",icon:"I_ChangeCnxObjDownload",multisel:!0,handler:function(e){var t=[];C.getGlobalVariable().isNative&&(e=e.selectedObjs),e.forEach((function(e){t.push(e.get("id").slice(4))}));var n=[];T.getDocuments(t).then((function(e){e.forEach((function(e){"TRUE"===e.dataelements.isDocumentType&&n.push(e.id)})),n.length<t.length&&v.info(i.ECM_CA_Download_Skipped),T.download(n)}))}};o.push(h)}var m={id:"changematurity",text:i.ECM_CA_Change_Maturity,fonticon:"promote",icon:"I_ChangeCnxObjPromote",multisel:!0,handler:function(e){w.changeMaturity(e,n.model)}};if("false"!=C.getGlobalVariable().CHG_CHANGE_MATURITY&&o.push(m),UWA.is(e)&&C.getGlobalVariable().isNative){var f=[];if(null==e.result){for(var y=0;y<e.length;y++){var S;S=e[y],f.push(S.replace("pid:",""))}n.exploreRefIds=f}else""!=e.result&&(n.exploreRefIds=e.result.refPid);o.push({id:null,text:i.ECM_CA_Command_ExploreWith,fonticon:null,icon:null,multisel:!0,items:[{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreInContextHdr",icon:"I_FindInContext",multisel:!0,text:i.ECM_CA_Command_ExploreContext,handler:function(e){var t=[],o=[],a=(o=n.exploreRefIds)[0].includes("pid:");a&&n.modelsToRemove.forEach((function(e,i){var n=e.get("id");n&&(n=n.replace("pid:","")),o.indexOf(n)>=0&&t.push(e.get("id").replace("pid:",""))})),a||(t=o),t&&t.length>0?b.DispatchEventToWin("MultiSelMenu_ExploreInContext_New",t):v.error(i.ECM_CA_Realized_Invalid_Explore_Selection)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInMSB",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:i.ECM_CA_Command_ExploreMSB,handler:function(e){var t=[],o=[],a=(o=n.exploreRefIds)[0].includes("pid:");a&&n.modelsToRemove.forEach((function(e,i){var n=e.get("id");n&&(n=n.replace("pid:","")),o.indexOf(n)>=0&&t.push(e.get("id").replace("pid:",""))})),a||(t=o),t&&t.length>0?b.DispatchEventToWin("ExploreInMSB",t):v.error(i.ECM_CA_Realized_Invalid_Explore_Selection)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreParentsHdr",icon:"I_GetParents",multisel:!0,text:i.ECM_CA_Command_ExploreParents,handler:function(e){var t=[],i=[],o=(i=n.exploreRefIds)[0].includes("pid:");o&&n.modelsToRemove.forEach((function(e,n){var o=e.get("id");o&&(o=o.replace("pid:","")),i.indexOf(o)>=0&&t.push(e.get("id").replace("pid:",""))})),o||(t=i),b.DispatchEventToWin("ExploreParents",t)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInPPR",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:i.ECM_CA_Command_ExploreMfg,handler:function(e){var t=[],i=[],o=(i=n.exploreRefIds)[0].includes("pid:");o&&n.modelsToRemove.forEach((function(e,n){var o=e.get("id");o&&(o=o.replace("pid:","")),i.indexOf(o)>=0&&t.push(e.get("id").replace("pid:",""))})),o||(t=i),b.DispatchEventToWin("ExploreInPPR",t)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmMultiDagExploreInCmd",icon:"I_ExploreInRFLPNavigator",multisel:!0,text:i.ECM_CA_Command_ExploreSys,handler:function(e){var t=[],i=[],o=(i=n.exploreRefIds)[0].includes("pid:");o&&n.modelsToRemove.forEach((function(e,n){var o=e.get("id");o&&(o=o.replace("pid:","")),i.indexOf(o)>=0&&t.push(e.get("id").replace("pid:",""))})),o||(t=i),b.DispatchEventToWin("ExploreInRFLP",t)}}]}),o.push({accelerator:"",availabilityMode:null,id:null,icon:null,items:[{accelerator:"Ctrl+O",availabilityMode:"Normal=YES CommandSet=YES Editability=YES SmallScale=YES LargeScale=YES ",id:"OpenFromCA",icon:"I_OpenDB",multisel:!0,text:i.ECM_CA_Command_Open,handler:function(e){var t=[],i=[],o=(i=n.exploreRefIds)[0].includes("pid:");o&&n.modelsToRemove.forEach((function(e,n){var o=e.get("id");o&&(o=o.replace("pid:","")),i.indexOf(o)>=0&&t.push(e.get("id").replace("pid:",""))})),o||(t=i),b.DispatchEventToWin("Open",t)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInCentral",icon:"I_ExploreInCentral_normal",multisel:!0,text:i.ECM_CA_Command_Explore3DSpace,handler:function(e){var t=[],i=[],o=(i=n.exploreRefIds)[0].includes("pid:");o&&n.modelsToRemove.forEach((function(e,n){var o=e.get("id");o&&(o=o.replace("pid:","")),i.indexOf(o)>=0&&t.push(e.get("id").replace("pid:",""))})),o||(t=i),b.DispatchEventToWin("ExploreInCollabNApproval",t)}},{accelerator:"Ctrl+Shift+O",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ENOVIA_Open_OpenAdvanced",icon:"I_OpenAdvDB",multisel:!0,text:i.ECM_CA_Command_OpenAdv,handler:function(e){var t=[],i=[],o=(i=n.exploreRefIds)[0].includes("pid:");o&&n.modelsToRemove.forEach((function(e,n){var o=e.get("id");o&&(o=o.replace("pid:","")),i.indexOf(o)>=0&&t.push(e.get("id").replace("pid:",""))})),o||(t=i),b.DispatchEventToWin("OpenAdv",t)}}],multisel:!0,text:i.ECM_CA_Command_OpenWith})}return o},domEvents:{"click .Realized-accordion-div":function(e){}},destroy:function(){this.modelsToRemove.splice(0,this.modelsToRemove.length),this.selectedOperationItems.splice(0,this.selectedOperationItems.length),this.stopListening(),this.model=null,this._parent()},filterRealizedCollection:function(){this.filteredRealizedCollection&&this.filteredRealizedCollection.length&&this.filteredRealizedCollection.reset();var e=W.filteredObjectIds,i=W.filteredActivities,n=[];this.originalRealizedCollection.toArray().forEach((function(t){var o=!1;e&&e.indexOf(t.get("id"))>=0||null==e?t.get("activities").forEach((function(e){var t=e.get("OriginalActivityDetails"),n=[];t.forEach((function(e){(i&&(i.indexOf(e.actName.split("#")[0])>=0||0==i.length)||null==i)&&n.push(e)})),n.length>0&&(o=!0),e.set("ActivityDetails",n,{silent:!0})})):t.get("activities").forEach((function(t){var n=t.get("OriginalActivityDetails"),a=[];n.forEach((function(t){if(!t.sameAsWhere&&(i&&(i.indexOf(t.actName.split("#")[0])>=0||0==i.length)||null==i)){if(t.AfterExists){var n=t.After.id;e&&e.indexOf(n)>=0&&a.push(t)}if(t.BeforeExists){var o=t.Before.id;e&&e.indexOf(o)>=0&&a.push(t)}}})),a.length>0&&(o=!0),t.set("ActivityDetails",a,{silent:!0})}));t&&o&&n.push(t)}));var o=new UWA.Class.Collection(n);document.querySelector(".Realized-operations-details").innerHTML="",this.operationView.destroy();this.operationView=this._initOperationView(o);if(this.injectSubView(this.operationView,"."+this.name+"-Realizedoperation-container"),this.filteredText&&o){var a=this;o.forEach((function(e,i){var n=a.container.getElement("#Realized-accordion-div-inner-"+i);if(n){var o=n.getElementsByTagName("span")[0].className;o.indexOf("expand-right")>0&&(n.getElementsByTagName("span")[0].className=o.replace("right","down").trim())}t.expandTile(i)}));this.container.getElements(".fonticon-expand-right")}this.containerReference.getElement(".realized-counter-num");this.counterView.destroy(),this._initCounterView(o),this.injectSubView(this.counterView,"."+this.name+"-RealizedCounter"),null!=W.lastFilterView&&"DEFAULT"!==W.lastFilterView||(this.realizedMultiSelView.destroy(),this._initMultiSelView(),this.injectSubView(this.realizedMultiSelView,"."+this.name+"-realizedMultisel"),this.selectedOperationItems.splice(0,this.selectedOperationItems.length),this.modelsToRemove.splice(0,this.modelsToRemove.length))}})},updateRealizedCollection:function(e){let t=e.id,i=e.groupId;1==W.isGroupSelectionActive?y.getGroupCARealizedData(i).then((function(e){if(UWA.is(e.realized)){var i=f.createRealizedCollection(e.realized);y.enrichCollectionForRealized(i).then((function(e){W.setRealizedCollection(e,t)}))}})):y.getCARealizedData(t,W.Realized_Filter_Map.DEFAULT).then((function(e){if(W.lastFilterView="DEFAULT",UWA.is(e.changeaction.realized)){var i=f.createRealizedCollection(e.changeaction.realized);y.enrichCollectionForRealized(i).then((function(e){W.setRealizedCollection(e,t)}))}}))},getRealizedCollection:function(){return this.realizedCollection},setRealizedCollection:function(e,t){this.realizedCollection=e,D.publish("ca-realized-collection-updated"+widget.id+t,{})},OnSearchComplete:function(e){var t=e.replace(",",""),i=[];i.push(t),W._tempReferenceToWinSearchCallback(i)},calledFromNativeInterop:function(e){var t={isActive:!0};t.selectedObjects={selectedObjs:W.operationsToExplore,result:e,length:W.operationsToExplore.length},W.multiSelView.buildMultisel(t)},getFilterValuesByOperation:function(){for(var e=this.getRealizedCollection(),t=new Map,i=0;i<e.length;i++){var n=e.at(i);if(n)n.get("activities").forEach((function(e){e.get("ActivityDetails").forEach((function(e){t.set(e.actName.split("#")[0],{actDisplayName:e.NLSName})}))}))}return t}};return W})),define("DS/ENOChangeActionUX/scripts/Models/CADependencyModel",["UWA/Class/Model","DS/ENOChgServices/scripts/services/ChgDependencyServices","DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController","DS/PlatformAPI/PlatformAPI","DS/ENOChgGovernanceUX/scripts/util/ChgDataGridUtil","require"],(function(e,t,i,n,o,a){"use strict";return e.extend({defaults:function(){return{id:"",userAccess:null}},fetchDependency:function(e){let o=this;return new Promise((function(a,s){i.caDependencyModel&&i.caDependencyModel.set("caId",e),o.fetch(e).then((function(){t.changeActionDependenciesLoaded=!0,t.changeActionDependencyModel=o;var i=e.substring(4);n.publish("dependency:data:ready"+widget.id,i),n.publish("dependency:update:UX"+widget.id);var s={Physicalid:e};n.publish("dependency:update:View"+widget.id,s),a()}))}))},setup:function(){var e=this;n.unsubscribe("load-dependency"+widget.id),n.subscribe("load-dependency"+widget.id,(function(t){e.fetchDependency(t)})),n.unsubscribe("ca-IDCard-on-change-maturity"),n.subscribe("ca-IDCard-on-change-maturity",(function(e){t.changeActionDependencyModel&&t.changeActionDependencyModel.updateDependUserAccess(e.id)})),n.unsubscribe("ca-IDCard-on-change-transfer-responsibility"),n.subscribe("ca-IDCard-on-change-transfer-responsibility",(function(e){t.changeActionDependencyModel&&t.changeActionDependencyModel.updateDependUserAccess(e.id)})),n.unsubscribe("ca-IDCard-on-change-holdValue"),n.subscribe("ca-IDCard-on-change-holdValue",(function(e){t.changeActionDependencyModel&&t.changeActionDependencyModel.updateDependUserAccess(e.id)}))},fetch:function(e){var n=this;return new Promise((function(s,r){var l=t.getDependUserAccess(e),c=t.getCADependencies(e),d=[];d.push(l),d.push(c),Promise.all(d).then((async function(e){var r=e[0];n.set("userAccess",r);var l=e[1];if(l&&l.elements){let e=a("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices");const r=l.elements.map((e=>e.id.replace("pid:",""))),c=await e.getAdditionObjectInfo(r);l.elements.forEach((e=>{const t=e.id.replace("pid:",""),i=c.additionObjectInfo&&c.additionObjectInfo[t]?c.additionObjectInfo[t].icon:"";e.icon=i;const n=c.additionObjectInfo&&c.additionObjectInfo[t]?c.additionObjectInfo[t].policy:"";e.policy=n})),t.getDependencyOwnerFullName(l.elements).then((function(e){o.fetchMaturityStateCSS(e);var t=i.buildUpstreamDependencyModel(e,l.originid);n.set("upstreamDependencyObjects",t);var a=0;t&&t.dependencyLinks&&Array.isArray(t.dependencyLinks)&&t.dependencyLinks.forEach((function(e,t){"Flowdown"===e.dependencyValueType&&a++}));n.set("flowdownDependencyCount",a),t=i.buildDownstreamDependencyModel(e,l.originid),n.set("downstreamDependencyObjects",t),s()}))}else s()}))}))},parse:function(e){},getTargetDependencies:function(e){var o=this;t.getCADependencies(e).then((async function(e){if(e&&e.elements){let s=a("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices");const r=e.elements.map((e=>e.id.replace("pid:",""))),l=await s.getAdditionObjectInfo(r);e.elements.forEach((e=>{const t=e.id.replace("pid:",""),i=l.additionObjectInfo&&l.additionObjectInfo[t]?l.additionObjectInfo[t].icon:"";e.icon=i;const n=l.additionObjectInfo&&l.additionObjectInfo[t]?l.additionObjectInfo[t].policy:"";e.policy=n})),t.getDependencyOwnerFullName(e.elements).then((function(t){var a=i.buildUpstreamDependencyModel(t,e.originid);o.set("upstreamChildNodes",a),a=i.buildDownstreamDependencyModel(t,e.originid),o.set("downstreamChildNodes",a),n.publish("dependency:ChildNodes:ready"+widget.id)}))}else n.publish("dependency:ChildNodes:ready"+widget.id)}))},updateDependUserAccess:function(e){var i=this;t.getDependUserAccess(e).then((function(e){var t=e;i.set("userAccess",t)}))}})})),define("DS/ENOChangeActionUX/scripts/Models/CAModel",["UWA/Class/Model","DS/WebappsUtils/WebappsUtils","DS/ENOChangeActionUX/scripts/Models/CARealizedModel","DS/ENOChangeActionUX/scripts/Collection/CARealizedCollection","DS/ENOChangeActionUX/scripts/CASpinner","UWA/Date","UWA/Class/Promise","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","text!DS/ENOChgServices/assets/ChangeActionMapping.json","require","DS/ENOChangeActionUX/scripts/Models/CADependencyModel","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgApplicabilityServices","DS/ENOChgServices/scripts/services/ChgDependencyServices","DS/ENOChgServices/scripts/services/ChgDataProcess"],(function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g){"use strict";return e.extend({idAttribute:"id",setup:function(){var e=JSON.parse(l).Show_Accept_Task;e&&"true"===e?this.set("showAcceptTask",!0):this.set("showAcceptTask",!1),this.addEvent("onChange:severity",(function(e){e.set("severityDisplay",r.get("ECM_CA_Severity_"+e.get("severity")))})),this.addEvent("onChange:ownerDisplayName",(function(e){this.refreshCAHeader(e);var t={id:e.id,newOwner:e.get("ownerDisplayName"),userName:e.get("owner")};p.publish("ca-IDCard-on-change-transfer-responsibility",t)}))}})})),define("DS/ENOChangeActionUX/scripts/Views/CARealizedView",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events","DS/ENOChangeActionUX/scripts/Views/CANewRealizedView","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices","text!DS/ENOChangeActionUX/scripts/Templates/CARealizedViewTemplate.html"],(function(e,t,i,n,o,a,s){return t.extend(i,n,{init:function(e){this._options=e,console.log(e),this._options.template=s},buildRealizedView:function(){return this.realizedView=o._createView_NewRealized("div","test-realized-facet",!0,this._options.caModel,this._options),this.realizedView}})})),define("DS/ENOChangeActionUX/scripts/Views/ActivityForm",["i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Input/Button","DS/ENOChgServices/scripts/services/ChgErrors","DS/E6WCommonUI/Views/DetailsDisplayView","DS/ENOChangeActionUX/scripts/Models/CAActivityModelForDisplayView","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],(function(e,t,i,n,o,a,s,r,l){"use strict";var c=n.extend({cloneModel:null,activityCallback:null,slideInReference:null,detailsView:null,init:function(e){UWA.is(e)&&(this.activityCallback=e.callback,this.cloneModel=new r(e,{parse:!0}))},getHeading:function(){return this.cloneModel.id?e.ECM_CA_Proposed_Activity_Heading_Edit:e.ECM_CA_Proposed_Activity_Heading_Add},getBody:function(){var e=this,t=UWA.createElement("div",{id:"formBody"});t.setAttribute("data-rec-id","formBodyCA");var i=UWA.Class.View.extend({setup:function(){this.listenTo(this.model,"onChange",this.render)},render:function(){UWA.is(arguments[0])&&arguments[0].hasChanged("reasonForChange")||(t.setContent(""),e.detailsView=new s,e.detailsView.setConfig(e.getConfig()),e.detailsView.model=e.cloneModel,e.detailsView.tenant=l.getGlobalVariable().tenant,e.detailsView.context=enoviaServer.context,e.detailsView.render().inject(t))}});new i({model:e.cloneModel}).render();return t},getConfig:function(){var t=[];return t.push({readWrite:!0,name:"activityDisplaySelect",label:e.ECM_CA_Proposed_Change_Activity,type:"select",required:!0,values:this.cloneModel.get("activityDisplayOptions")}),t.push({readWrite:"true",name:"reasonForChange",label:e.ECM_CA_Proposed_Activity_Description,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3}),t},getFooter:function(){var t=UWA.Element("div",{});if(UWA.is(this.cloneModel.id)){if(UWA.is(this.cloneModel.id)){new o({value:e.ECM_CA_Button_Label_Save,className:"primary proposedButtons"}).inject(t).addEvent("onClick",this.onSaveButtonClick.bind(this))}}else new o({value:e.ECM_CA_Button_Label_Add,className:"primary proposedButtons"}).inject(t).addEvent("onClick",this.onAddButtonClick.bind(this)),new o({value:e.ECM_CA_Button_Label_AddAnother,className:"proposedButtons"}).inject(t).addEvent("onClick",this.onAddAnotherButtonClick.bind(this));return t},onAddButtonClick:function(){this.detailsView.isModelValid()?(this.activityCallback(this.cloneModel),this.slideInReference.hideSlideIn()):a.error(e.ECM_CA_MandFieldMissing_error)},onAddAnotherButtonClick:function(){this.detailsView.isModelValid()?(this.activityCallback(this.cloneModel),this.cloneModel.set("reasonForChange",""),this.cloneModel.set("canEdit",!0)):a.error(e.ECM_CA_MandFieldMissing_error)},onSaveButtonClick:function(){this.detailsView.isModelValid()?(this.activityCallback(this.cloneModel),this.slideInReference.hideSlideIn()):a.error(e.ECM_CA_MandFieldMissing_error)}});return c})),define("DS/ENOChangeActionUX/scripts/Views/CAProposedOperationView",["UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/UIKIT/Scroller","DS/ENOChangeActionUX/scripts/Views/CAProposedActivitiesView","DS/ENOChangeActionUX/scripts/Views/CAProposedFlowdownPopoverView","DS/ENOChangeActionUX/scripts/CAWidgetConfiguration","DS/ENOjquery/ENOjquery","DS/TransientWidget/TransientWidget","DS/i3DXCompassPlatformServices/OpenWith","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgPropertiesServices","DS/ENOXVersionExplorerController/VersionExplorerController","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/ENOChgServices/scripts/services/ChgProposedServices","DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/ENOChgGovernanceUX/scripts/util/DocumentUtils","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgGovernanceUX/scripts/components/ChangeImpactsView/ChgChangeImpactsHandler","i18n!DS/ENOChgGovernanceUX/assets/nls/ENOChgGovernanceNLS"],(function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,y,b,S,E){"use strict";var _="Cannot be found",D="Access Denied";o.registerHelper("getMoreText",(function(){return t.ECM_CA_Proposed_More_Reason})),o.registerHelper("ifNotCreate",(function(e,i){return e===t.ECM_CA_Proposed_Operation_Create?'<span style="visibility:hidden">'+i+"</span>":"<label>"+t.ECM_CA_Maturity+" : </label>                            <span>"+i+"</span>"})),o.registerHelper("ifDraggable",(function(e,i){return e===t.ECM_CA_Proposed_Operation_Create||!1===i?"draggable='false'":"draggable='true'"})),o.registerHelper("fillMiddleContainer",(function(e,i){var n="";n='<div class="proposedOperation-sub-container-second">';var o=function(e,i){var n="";if(e.status||e.solution){if(n='<div class="proposedOperation-status-solution-container flex-container add-margin-left">',e.status&&(n+='                        <div class="proposedOperation-status-container">                            <label> '+t.ECM_CA_PROPOSED_PROPOSAL_STATUS+'</label>                            <span class="proposed-status-value">'+e.statusNLS+"</span>                        </div>"),e.solution){var o=e.solution.isReleased,a='                        <div class="proposedOperation-solution-container add-margin-left">                            <label>'+t.ECM_CA_PROPOSED_RESOLUTION+'</label>                            <div class="proposed-solution-value-with-action flex-container">                                <span class="proposed-solution-value" title="'+e.solution.displayString+'" id="'+e.solution.id+'">'+e.solution.displayString+"</span>";o||(a+='<span class="fonticon fonticon-attention attention-superscript" title=" '+t.ECM_CA_RESOLUTION_NON_RELEASED_OBJECT_WARNING+'"></span>'),n+=a+='<div class="proposedOperation-solutions-actions-container solution-icon-class" id="solution-action-container-'+i+'">                                    <div class="context-actions-container">                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                    </div>                                </div>                            </div>                        </div>'}n+="</div>"}return n}(e,i);n+=o,n+='<div class="proposedOperation-flowdown-info-container flex-container add-margin-left" id="flowdown-info-container-'+i+'"></div>';var a=function(e,i){var n="";return UWA.is(e.changeReason)&&""!=e.changeReason&&(n='                    <div class="proposedOperation-change-reason-container flex-container add-margin-left">                        <label class="proposedOperation-reason-label-container">'+t.ECM_CA_REASON_CHANGE_LABEL+'</label>                        <div class="proposedOperation-reason-text-container" title="'+e.changeReason+'">'+e.changeReason+' </div>                        <div class="proposedOperation-more-container" id="more-container-'+i+'">'+t.ECM_CA_Proposed_More_Reason+"</div>                    </div>"),n}(e,i);return n+=a,n+="</div>"}));var O={activitiesToRemove:[],selectedActivityItems:[],proOpnView:null,_createView_TestProposed:function(i,n,s,d,p){return e.extend({name:"proposedOperation",tagName:i,className:n,proposedModel:d,contextCAId:p.get("id"),contextCAName:p.get("title"),contextCAModel:p,setup:function(){this.template='                                    <div class="'+this.getClassNames("-main-main-container")+'">                                    {{#each changes}}                                        <div class="'+this.getClassNames("-main-container")+'" id="main-container-{{@index}}">                                            <div class="'+this.getClassNames("-collpased-container")+'" id="collapsed-{{@index}}" {{#ifDraggable operation access}}{{/ifDraggable}}>                                                <div class="'+this.getClassNames("-accordion-container icon-class expander")+' accordion-div" id="accordion-div-{{@index}}">                                                    <div>                                                        <div class="action-icon-wrapper accordion-div-inner"><span class="fonticon fonticon-2x fonticon-expand-right" id={{@index}}></span></div>                                                        <div class="checked-action"><input type="checkbox" class="checkbox-accord hidden" id="checkbox-accord-{{@index}}"></div>                                                    </div>                                                </div>                                                <div class="'+this.getClassNames("-container")+'" id="proposedOp-container-{{@index}}">                                                    <div class="'+this.getClassNames("-sub-container-first")+'">                                                        <div class="'+this.getClassNames("-name-revision-container")+' ellipsis-info" title="{{name}} {{revision}}">                                                            {{#if icon}}<div class="'+this.getClassNames("-icon-container")+'"><img class="Realized-change-info-icon" id="info-icon-{{@index}}" src ={{icon}}></img></div>{{/if}}                                                            <div class="'+this.getClassNames("-name-container")+'">{{name}}</div>                                                            <div class="'+this.getClassNames("-revision-container")+'"><span>{{revision}}<span></div>                                                            {{#if isLastVersion}}<div class="'+this.getClassNames("-higher-revision-container")+' fonticon fonticon-flow-branch-list" title="'+t.ECM_PROPOSED_HIGHER_REVISION_EXISTS+'" id="highrevision-container-{{@index}}"></div>{{/if}}                                                        </div>                                                        <div class="'+this.getClassNames("-more-info-container")+'">                                                            <div class="'+this.getClassNames("-desc-op-container")+' mobile-hidden">                                                                {{#if nameBoolean}}<div class="'+this.getClassNames("-desc-container")+' ellipsis-info-1" title="{{desc}}" id="op-title-desc-{{@index}}">                                                                    <label>'+t.ECM_CA_Proposed_Operation_Name+' : </label>                                                                    <span>{{desc}}</span>                                                                </div>{{/if}}                                                                {{#if nameBoolean}}<div class="'+this.getClassNames("-op-container")+'" id="op-op-desc-{{@index}}">                                                                    <label>'+t.ECM_CA_Proposed_Operation_Operation+' :</label>                                                                    <span>{{operation}}</span>                                                                </div>{{/if}}                                                        </div>                                                        <div class="'+this.getClassNames("-mat-collab-container")+'">                                                            {{#if nameBoolean}}<div class="'+this.getClassNames("-mat-container")+'">{{#ifNotCreate operation maturity}}{{/ifNotCreate}}</div>{{/if}}                                                            {{#if nameBoolean}}<div class="'+this.getClassNames("-collab-container")+' ellipsis-info-1">                                                                <label>'+t.ECM_CA_COLLABSPACE_TAG+' :</label>                                                                <span>{{collabspace}}</span>                                                            </div>{{/if}}                                                        </div>                                                        {{#if nameBoolean}}<div class="'+this.getClassNames("-collab-container-op-container")+' monitor-hidden">                                                                <label>'+t.ECM_CA_Proposed_Operation_Operation+' :</label>                                                                <span>{{operation}}</span>                                                            </div>{{/if}}                                                        </div>                                                    </div>                                                {{#fillMiddleContainer this @index}}{{/fillMiddleContainer}}                                            </div>                                                <div class="'+this.getClassNames("-actions-container icon-class-1")+'" id="operation-action-container-{{@index}}">                                                    <div class="context-actions-container">                                                        <div class="action-icon-wrapper"><span class="fonticon fonticon-2x fonticon-down-open"></span></div>                                                    </div>                                                </div>                                            </div>                                        <div class="proposed-tile-expanded hidden" id="expanded-{{@index}}"></div>                                        </div>                                    {{/each}}                                    </div>',this.myProposedModel=d;var e=this;widget.addEvent("onResize",(function(){setTimeout((function(){O.onResize()}),100)})),O.selectedTilesMap={forEach:function(t){for(var i=0;i<e.proposedModel.length;i++)UWA.is(this[i])&&t(this[i],i,this)},set:function(e,t){this[e]=t}},O.selectedTilesIDMap={forEach:function(t){for(var i=0;i<e.proposedModel.length;i++)UWA.is(this[i])&&t(this[i],i,this)},set:function(e,t){this[e]=t}}},render:function(){this.container.empty(),h.setCurrModel(this.contextCAModel),this.renderer=this.getTemplate(this.template,this.myProposedModel);s?widget.body:this.container;var e=UWA.createElement("div",{class:"operations-main-container"});e.setAttribute("data-rec-id","operations-main-container-CA"),e.setStyle("height","calc(100% - 50px)"),e.setStyle("overflow","auto");var t;t=this.renderer(),e.addContent(t),new a({element:e}).inject(this.container);for(var i=O.proOpnView=this,n=0;n<i.data.changes.length;n++){var o=this.container.getElement("#operation-action-container-"+n);if(o){o.addEvent("click",(function(e){var t=e.currentTarget.id.split("-")[3];t=parseInt(t);var n=i.data.changes[t].id,o=i.proposedModel.findWhere({id:n});UWA.is(o)&&(this.model=o),O.itemView=this,"Create"!=o.get("operationActual")&&o.get("Access")&&u.getGlobalVariable().isNative?m.DispatchEventToWin("Proposed_ContextMenu",o.get("objectId").replace("pid:","")):O.DisplayContextMenu([])}))}var r=this.container.getElement("#solution-action-container-"+n);if(r){r.addEvent("click",(function(e){var t=e.currentTarget.id.split("-")[3];t=parseInt(t);var n=i.data.changes[t].id,o=i.proposedModel.findWhere({id:n});if(UWA.is(o)&&(this.model=o),O.itemView=this,"Create"!=o.get("operationActual")&&o.get("Access")&&u.getGlobalVariable().isNative){var a="",s=o.get("resolutionItems");if(UWA.is(s)&&Array.isArray(s))for(var r=0;r<s.length;r++){var l=s[r];l&&(a=l.id.replace("pid:",""))}m.DispatchEventToWin("Resolution_ContextMenu",a)}else O.displayContextualMenuForSolutionItem([])}))}var l=this.container.getElement("#flowdown-info-container-"+n),c=i.data.changes[n].flowdownInfo;if(c&&l){var d={parentContainer:l,data:c,index:n,name:i.data.changes[n].name};i._buildFlowdownView(d)}}return O.container=i,h.setCallbacksForOpenWith("proposed"),this},injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},_buildFlowdownView:function(e){var i=e.parentContainer,n=e.data,o=e.index,a=e.name,s=!0;if(n.flowdownFor&&n.flowdownFrom&&1===n.flowdownFor.length&&1===n.flowdownFrom.length){var r="";n.flowdownFor[0].info["display name"]==_?(r=t.ECM_CA_Cannot_be_found,s=!1):n.flowdownFor[0].info["display name"]==D?(r=t.ECM_CA_Access_Denied,s=!1):(r=n.flowdownFor[0].info["display name"],s=!0);var l={flowDownFromName:n.flowdownFrom[0].caName,flowDownFromID:n.flowdownFrom[0].caID,flowDownFromTitle:n.flowdownFrom[0].caTitle,flowDownFromIcon:n.flowdownFrom[0].icon,flowDownFromImage:n.flowdownFrom[0].image,flowdownForObjectId:n.flowdownFor[0].id,flowdownForObjectTitle:r,flowdownForObjectType:n.flowdownFor[0].info.type,flowdownForObjectTypeNLS:n.flowdownFor[0].info.typeNLS,flowDownForIcon:n.flowdownFor[0].info.icon,flowDownForImage:n.flowdownFor[0].info.image,name:a,flowdownBoolean:s},c="";c=UWA.is(l.flowDownFromIcon)&&""!=l.flowDownFromIcon?'                            <span><img class="Realized-change-info-icon" src="'+l.flowDownFromIcon+'"></img></span>                            <span                            class="proposed-flowdown-from-value"                             title="'+l.flowDownFromTitle+'"                            id= "'+l.flowDownFromID+"-"+o+'"                            objname = "'+l.name+'" >                                '+l.flowDownFromTitle+"                            </span>":'                            <span                            class="proposed-flowdown-from-value"                             title="'+l.flowDownFromTitle+'"                            id= "'+l.flowDownFromID+"-"+o+'"                            objname = "'+l.name+'" >                                '+l.flowDownFromTitle+"                            </span>";var d="";d=UWA.is(l.flowDownForIcon)&&""!=l.flowDownForIcon?'                            <span><img class="Realized-change-info-icon" src="'+l.flowDownForIcon+'"></img></span>                            <span                            class="proposed-flowdown-for-value"                            title="'+l.flowdownForObjectTitle+'"                            id= "'+l.flowdownForObjectId+"-"+o+'">                                '+l.flowdownForObjectTitle+"                            </span>":'                            <span                            class="proposed-flowdown-for-value"                            title="'+l.flowdownForObjectTitle+'"                            id= "'+l.flowdownForObjectId+"-"+o+'">                                '+l.flowdownForObjectTitle+"                            </span>";var p="";"Cannot be found"!=l.flowDownFromName&&""!=l.flowDownFromName&&(p='                            <div class="proposedOperation-solutions-actions-container flowdown-action-container solution-icon-class" id="flowdown-from-action-container-'+o+'"                                 info="'+l.name+"~"+l.flowDownFromName+'">                                <div class="context-actions-container">                                    <div class="action-icon-wrapper">                                        <span class="fonticon fonticon-2x fonticon-down-open" id= "'+l.flowDownFromID+"-"+o+'"></span>                                    </div>                                </div>                            </div>');var u="";"Cannot be found"!=l.flowdownForObjectTitle&&""!=l.flowdownForObjectTitle&&(u='                            <div class="proposedOperation-solutions-actions-container flowdown-action-container solution-icon-class" id="flowdown-for-action-container-'+o+'"                                info="'+l.flowdownForObjectTitle+"~"+l.flowdownForObjectType+"~ "+l.flowdownForObjectTypeNLS+'">                                <div class="context-actions-container">                                    <div class="action-icon-wrapper">                                                <span class="fonticon fonticon-2x fonticon-down-open" id= "'+l.flowdownForObjectId+"-"+o+'"></span>                                    </div>                                </div>                            </div>');var h='                        <div class="proposedOperation-flowdown-info-container flex-container">                            <div class="proposedOperation-flowdown-from-container flex-container">                                <label>'+t.ECM_CA_FLOWDOWN_FROM_LABEL+'</label>                                <div class="proposed-flowdownfrom-value-with-action flex-container">                                    '+c+"                                    "+p+'                                </div>                            </div>                            <div class="proposedOperation-flowdown-for-container flex-container">                                <label>'+t.ECM_CA_FLOWDOWN_FOR_LABEL+'</label>                                <div class="proposed-flowdownfor-value-with-action flex-container">                                    '+d+"                                    "+u+"                                </div>                            </div>                        </div>"}else l={flowDownFromLength:n.flowdownFrom.length,flowdownForLength:n.flowdownFor.length},h='                        <div class="proposedOperation-flowdown-info-container flex-container">                            <div class="proposedOperation-flowdown-from-container flex-container">                                <label>'+t.ECM_CA_FLOWDOWN_FROM_LABEL+'</label>                                <div class="proposed-flowdownfrom-value-with-action flex-container">                                    <a                                    class="proposed-flowdown-from-value flowdown-from-value-link"                                     id="flowdown-from-value-link-'+o+'"                                    title="'+l.flowDownFromLength+'"                                    >                                        '+l.flowDownFromLength+" "+t.ECM_SELECTED_PROPOSED_ITEMS_LABEL+'                                    </a>                                </div>                            </div>                            <div class="proposedOperation-flowdown-for-container flex-container add-margin-left">                                <label>'+t.ECM_CA_FLOWDOWN_FOR_LABEL+'</label>                                <div class="proposed-flowdownfor-value-with-action flex-container">                                    <a                                    class="proposed-flowdown-for-value flowdown-for-value-link"                                    id="flowdown-for-value-link-'+o+'"                                    title="'+l.flowdownForLength+'"                                    >                                        '+l.flowdownForLength+" "+t.ECM_SELECTED_PROPOSED_ITEMS_LABEL+"                                    </a>                                </div>                            </div>                        </div>";i&&""!=h&&s&&(i.empty(),i.addContent(h))},getTemplate:function(e,i){var n=o.compile(e),a=this,s=[];this.activitiesViewArr=[];O.proposedModel;return i.forEach((function(e,i){"Create"!=e.get("operationActual")&&"Flowdown"!=e.get("operationActual")&&e.get("Access");var n=!1;UWA.is(e.get("isLastVersion"))&&(n=!!(n="true"!==e.get("isLastVersion")));var o=!0;UWA.is(e.get("objectTitle"))&&(o=e.get("objectTitle")!==t.ECM_CA_Access_Denied&&e.get("objectTitle")!==t.ECM_CA_Cannot_be_found);var r={operation:e.get("operationDisplay"),operationActual:e.get("operationActual"),maturity:e.get("maturity"),name:UWA.is(e.get("objectName"))?e.get("objectName"):e.get("name"),icon:e.get("icon"),revision:e.get("revision"),changeReason:e.get("changeReason"),id:e.get("id"),objectId:e.get("objectId"),desc:e.get("objectTitle"),access:e.get("Access"),collabspace:e.get("collabSpaceTitle"),isLastVersion:n,status:e.get("status"),statusNLS:e.get("statusNLS"),nameBoolean:o};if("Flowdown"===e.get("operationActual")){var l="";l=e.get("flowdownForObjectTitle")==_?t.ECM_CA_Cannot_be_found:e.get("flowdownForObjectTitle")==D?t.ECM_CA_Access_Denied:e.get("flowdownForObjectTitle");var c={flowdownFor:[],flowdownFrom:[]};c.flowdownFrom.push({caID:e.get("flowDownFromId"),caTitle:e.get("flowDownFromTitle"),caName:e.get("flowDownFromName"),icon:e.get("flowdownFromIcon"),image:e.get("flowdownFromImage")}),c.flowdownFor.push({id:e.get("flowdownForObjectId"),info:{"display name":l,type:e.get("flowdownForObjectType"),typeNLS:e.get("flowdownForObjectTypeNLS"),icon:e.get("flowdownForIcon"),image:e.get("flowdownForImage")}}),r.flowdownInfo=a.flowdownInfo=c}else r.flowdownInfo=a.flowdownInfo=e.get("flowdownInfo");if(UWA.is(e.get("resolutionItems"))){var d=e.get("resolutionItems");for(i=0;i<d.length;i++){var p=d[i];if(p){var u=p.info["display name"]==_?t.ECM_CA_Cannot_be_found:p.info["display name"]==D?t.ECM_CA_Access_Denied:p.info["display name"],h=p.info.revision,m=p.info.current,g=!1;"RELEASED"!=m&&"Release"!=m||(g=!0);var f=u+" "+h;""!=f&&(r.solution={id:p.id,displayString:f,isReleased:g})}}}r.operation=e.get("Access")?e.get("operationDisplay"):void 0,r.name=e.get("objectTitle"),r.desc=UWA.is(e.get("objectName"))?e.get("objectName"):e.get("name"),s.push(r)})),this.data={changes:s},function(){return n(a.data)}},domEvents:{"click .proposed-flowdown-from-value":function(e){var t=e.target.id.split("-")[e.target.id.split("-").length-1],i=this.data.changes[t].flowdownInfo.flowdownFrom;if(i){var n={target:e.target,data:i,popoverFor:"flowdownFrom"};this.flowdownFromPopoverView&&this.flowdownFromPopoverView.destroy(),(this.flowdownFromPopoverView=new r(n)).render()}},"click .proposed-flowdown-for-value":function(e){var t=e.target.id.split("-")[e.target.id.split("-").length-1],i=this.data.changes[t].flowdownInfo.flowdownFor;if(i){var n={target:e.target,data:i,popoverFor:"flowdownFor"};this.flowdownForPopoverView&&this.flowdownForPopoverView.destroy(),(this.flowdownForPopoverView=new r(n)).render()}},"click .flowdown-action-container":function(e){e.target.id;var t=e.target.getParent(".flowdown-action-container"),i=t.getAttribute("info"),n=t.id.split("-")[1];if("from"===n)var o=i.split("~")[1],a="Change Action",s="Change Action";else if("for"===n)o=i.split("~")[0],a=i.split("~")[1],s=i.split("~")[2];var r=t.getElement(".fonticon-down-open").id.split("-")[0],l=t.id.split("-")[4];l=parseInt(l);var c=this.data.changes[l].id,d=this.proposedModel.findWhere({id:c});UWA.is(d)&&(this.model=d),O.itemView=this,O.parentContainer=t;var p={elemId:r.replace("pid:",""),fromName:o,typeNLS:a,type:s};if(O.setFlowdownContextOptions(p),"Create"!=d.get("operationActual")&&d.get("Access")&&u.getGlobalVariable().isNative){var h=r.replace("pid:","");m.DispatchEventToWin("FlowdownFrom_ContextMenu",h)}else O.displayContextualMenuForFlowdownForItem([])},"click .accordion-div-inner":function(e){var t=e.target.id,i=(this.container.getElement("#proposedOp-container-"+t),e.target.className);i.indexOf("expand-right")>0?e.target.className=i.replace("right","down").trim():i.indexOf("expand-down")>0&&(e.target.className=i.replace("down","right").trim()),O.accordionClassName=e.target.className,O.expandTile(t,i)},"click .proposedOperation-collpased-container":function(e){if(!(e.target.className.indexOf("down")>=0||e.target.className.indexOf("right")>=0||e.target.className.indexOf("checkbox")>=0||e.target.className.indexOf("more-container")>=0||e.target.className.indexOf("higher-revision-container")>=0||e.target.className.indexOf("multiple-flowdown")>=0||e.target.className.indexOf("actions-container")>=0)){var t=e.target,i=(t.className.indexOf("proposedOperation-collpased-container")>=0?t:function(e){for(;(e=e.parentNode)&&!e.classList.contains("proposedOperation-collpased-container"););return e}(t)).id.split("-"),n=i[i.length-1],o=this.container.getElement("#checkbox-accord-"+n);o&&!o.hasClassName("hidden")||O.changeAccordIconAndExpandTile(n)}},"click .checkbox-accord":function(e){var t=this.myProposedModel,i=(e.target,e.target.id.split("-")),n=i[i.length-1],o=parseInt(n),a=t.at(o);(s=this.container.getElement("#main-container-"+n)).hasClassName("selected-border")?s.removeClassName("selected-border"):s.addClassName("selected-border");var s=document.createElement("input"),r={};r.id=a.get("objectId").replace("pid:",""),r.name=a.get("objectName"),r.title=a.get("objectTitle"),r.type=a.get("objectType"),s.setAttribute("data-pid",a.get("objectId").replace("pid:","")),s.setAttribute("data-type",a.get("type")),s.setAttribute("data-selectedItem",JSON.stringify(r)),e.target.checked?(s.setAttribute("class","selected"),l.onClickItem.call(s,widget,u.getGlobalVariable())):l.onClickItem.call(s,widget,u.getGlobalVariable()),Array.prototype.unshift.call(arguments,a),this.dispatchEvent("onCheckboxClick",arguments)},"click .proposedOperation-more-container":function(e){var i=e.target.id.split("-"),n=i[i.length-1],o=this.container.getElement("#collapsed-"+n),a="";o&&(a=o.id);var s=c("#"+a).find(".proposedOperation-reason-text-container");s&&("none"===s.css("max-height")?(s.css("max-height","3.6em"),s.css("overflow","auto"),s.css("white-space","inherit")):(s.css("max-height","none"),s.css("overflow","hidden"),s.css("white-space","nowrap")));var r=c("#"+a).find(".proposedOperation-more-container");r&&(r.text()===t.ECM_CA_Proposed_Less_Reason?r.text(t.ECM_CA_Proposed_More_Reason):r.text(t.ECM_CA_Proposed_Less_Reason))},dragstart:function(e){var t=this.myProposedModel,i=(e.target,e.target.id.split("-")),n=i[i.length-1],o=parseInt(n),a=t.at(o);Array.prototype.unshift.call(arguments,a),Array.prototype.unshift.call(arguments,{}),this.dispatchEvent("onItemViewDrag",arguments)},"click .proposedOperation-higher-revision-container":function(e){var t=this.myProposedModel,i=(e.target,e.target.id.split("-")),n=i[i.length-1],o=parseInt(n),a=t.at(o);"Complete"!=a.get("status")&&O.launchRevisionExplorerForSolutionItems(a,!1)}},destroy:function(){return this.activitiesView&&this.stopListening(this.activitiesView,this._actvitiesEvents),this.stopListening(this.myProposedModel),this.myProposedModel=null,this._parent.apply(this,arguments)}})},displayContextualMenuForFlowdownForItem:function(e){var i=this,n=[],o=O.getFlowdownContextOptions();if(i.itemView&&i.itemView.model&&i.itemView.model.get("Access")){var a=o.elemId,s=o.typeNLS,r=o.fromName,l=o.type,c={objectId:a,objectType:s,displayName:r,displayType:l,facetName:"proposed"};o={facetName:"proposed",selectedItem:c};h.setSelectedItem(o);var d=[];d.push(c);var f=h.getContentForCompassInteraction(d),C=new p;C.set3DXContent(f,!0);var v=[];UWA.is(C.retrieveCompatibleApps,"function")&&C.retrieveCompatibleApps((function(o){o.forEach((function(e){v.push({text:e.text,fonticon:e.fonticon,multisel:!1,handler:e.handler})})),v.length>0&&u.getGlobalVariable().isNative?"true"==u.getGlobalVariable().CHG_OPENWITH&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith_RichClient,fonticon:"export",icon:"fonticon-export",multisel:!1,items:v}):v.length>0&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith,fonticon:"export",icon:"fonticon-export",multisel:!1,items:v});var s=i.itemView.model;u.getGlobalVariable().isNative||"false"==u.getGlobalVariable().CHG_OPEN_WITH_COLLAB||"Create"==s.get("operationActual")||n.push({id:"Details",text:t.ECM_CA_Explore_With_Central,fonticon:"window",icon:"fonticon-window",multisel:!0,handler:function(e){var t="/common/emxTree.jsp?mode=insert&objectId="+a,i=u.getGlobalVariable().getSecurityContext().replace("ctx::",""),n=u.getGlobalVariable().computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+i+"&forwardUrl="+t),o=window.open();o.opener=null,o.location.href=n}});var r={id:"Properties",text:t.ECM_CA_Properties,fonticon:"fonticon fonticon-info-open-in-a-new-window",icon:"I_ChangeCnxObjProps",multisel:!0,handler:function(e){var t=a;g.createPropertiesComponent(t)}},l={id:"ChangeAssessment",text:t.ECM_CA_Proposed_Change_Assessment,fonticon:"component",icon:"I_ChangeCnxObjProps",multisel:!0,handler:function(e){var t=[a];u.getGlobalVariable().isNative?m.DispatchEventToWin("ChangeAssessment",itemID.replace("pid:","")):h.openRelationalExplorer(t)}};1==s.get("Access")&&(n.push(r),n.push(l)),e.push.apply(e,n),h._initDropDown(e,O.parentContainer)}))}},displayContextualMenuForSolutionItem:function(e){var i=this,n=[];if(i.itemView&&i.itemView.model&&i.itemView.model.get("Access")){var o="",a="",s="",r="",l=null,c=i.itemView.model.get("resolutionItems");if(UWA.is(c)&&Array.isArray(c))for(var d=0;d<c.length;d++){(l=c[d])&&(o=l.id.replace("pid:",""),a=l.info.type,s=l.info["display name"],r=l.info.typeNLS)}var m={objectId:o,objectType:a,displayName:s,displayType:r,facetName:"proposed"},f={facetName:"proposed",selectedItem:m};h.setSelectedItem(f);var C=[];C.push(m);var v=h.getContentForCompassInteraction(C),A=new p;A.set3DXContent(v,!0);var w=[];UWA.is(A.retrieveCompatibleApps,"function")&&A.retrieveCompatibleApps((function(a){a.forEach((function(e){w.push({id:e.text,text:e.text,fonticon:e.fonticon,multisel:!1,handler:e.handler})})),w.length>0&&u.getGlobalVariable().isNative?"true"==u.getGlobalVariable().CHG_OPENWITH&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith_RichClient,fonticon:"export",icon:"fonticon-export",multisel:!1,items:w}):w.length>0&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith,fonticon:"export",icon:"fonticon-export",multisel:!1,items:w});var s=i.itemView.model;u.getGlobalVariable().isNative||"false"==u.getGlobalVariable().CHG_OPEN_WITH_COLLAB||"Create"==s.get("operationActual")||n.push({id:"Details",text:t.ECM_CA_Explore_With_Central,fonticon:"window",icon:"fonticon-window",multisel:!0,handler:function(e){var t="/common/emxTree.jsp?mode=insert&objectId="+o,i=u.getGlobalVariable().getSecurityContext().replace("ctx::",""),n=u.getGlobalVariable().computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+i+"&forwardUrl="+t),a=window.open();a.opener=null,a.location.href=n}});var r={id:"Properties",text:t.ECM_CA_Properties,fonticon:"fonticon fonticon-info-open-in-a-new-window",icon:"I_ChangeCnxObjProps",multisel:!0,handler:function(e){var t=o;g.createPropertiesComponent(t)}};1==s.get("Access")&&"Create"!=s.get("operationActual")&&n.push(r);var l={id:"Resolution-Remove",text:t.ECM_CA_Remove_Proposed_Changes,fonticon:"trash",icon:"I_ChangeCnxObjTrash",handler:function(e){if("Flowdown"!=i.itemView.model.get("operationActual")){var t={proposedId:i.itemView.model.get("id"),selectedObjID:""},n=O.getJSONForAddResolution(t);O.proOpnView.dispatchEvent("OnAddResolutionItem",[n])}}},c=!0,d=h.getCurrentModel();if(UWA.is(d)&&UWA.is(d.get("userAccess"))){var p=d.get("userAccess");(p&&p.DeleteProposed&&"false"===p.DeleteProposed||!p.DeleteProposed)&&(c=!1)}1==c&&n.push(l),e.push.apply(e,n),h._initDropDown(e,O.itemView)}))}},DisplayContextMenu:function(e){var i=this,n=[];if(i.itemView&&i.itemView.model&&i.itemView.model.get("Access")){var o={objectId:i.itemView.model.get("objectId").replace("pid:",""),objectType:i.itemView.model.get("objectType"),displayName:i.itemView.model.get("objectTitle"),displayType:i.itemView.model.get("type"),facetName:"proposed"},a={facetName:"proposed",selectedItem:o};h.setSelectedItem(a);var s=[];s.push(o);var r=h.getContentForCompassInteraction(s),l=new p;l.set3DXContent(r,!0);var c=[];UWA.is(l.retrieveCompatibleApps,"function")&&l.retrieveCompatibleApps((function(o){o.forEach((function(e){c.push({id:e.text,text:e.text,fonticon:e.fonticon,multisel:!1,handler:e.handler})})),c.length>0&&u.getGlobalVariable().isNative?"true"==u.getGlobalVariable().CHG_OPENWITH&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith_RichClient,fonticon:"export",icon:"fonticon-export",multisel:!1,items:c}):c.length>0&&n.push({id:"OpenWith",text:t.ECM_CA_Command_OpenWith,fonticon:"export",icon:"fonticon-export",multisel:!1,items:c});var a=i.itemView.model;u.getGlobalVariable().isNative||"false"==u.getGlobalVariable().CHG_OPEN_WITH_COLLAB||"Create"==a.get("operationActual")||n.push({id:"Details",text:t.ECM_CA_Explore_With_Central,fonticon:"window",icon:"fonticon-window",multisel:!0,handler:function(e){var t="/common/emxTree.jsp?mode=insert&objectId="+i.itemView.model.get("objectId").replace("pid:",""),n=u.getGlobalVariable().getSecurityContext().replace("ctx::",""),o=u.getGlobalVariable().computeUrl("/common/emxFrameworkContextManager.jsp?SecurityContext="+n+"&forwardUrl="+t),a=window.open();a.opener=null,a.location.href=o}});var s=[];s.push({id:"identifybyVersionSearch",text:t.ECM_CA_PROPOSED_IDENTIFY_SOLUTION_VERSIONS,fonticon:"flow-branch-list",icon:"I_ChangeCnxObjVersionSearch",handler:function(){i.launchRevisionExplorerForSolutionItems(i.itemView.model,!0)}}),s.push({id:"identifybySearch",text:t.ECM_CA_PROPOSED_IDENTIFY_SOLUTION_SEARCH,fonticon:"search",icon:"I_ChangeCnxObjSearch",handler:function(){i.launchSearchForSolutionItems(i.itemView.model)}});var r={text:t.ECM_CA_PROPOSED_IDENTIFY_SOLUTION,fonticon:"target-add",icon:"I_ChangeCnxObjEdit",items:s},l=!0,d=h.getCurrentModel();if(UWA.is(d)&&UWA.is(d.get("userAccess"))){var p=d.get("userAccess");(p&&p.AddProposed&&"false"===p.AddProposed||!p.AddProposed)&&(l=!1)}var f=!0,C=i.itemView.model.get("operationActual");"None"!=C&&"Flowdown"!=C&&(f=!1);var v=i.itemView.model.get("activities");v&&v.length>0&&f&&v.forEach((function(e){e&&f&&("Modify"!=e.get("activityActual")&&(f=!1))}));var A=i.itemView.model.get("status");1==a.get("Access")&&l&&f&&"Complete"!=A&&"true"===u.getGlobalVariable().isFullLicence&&n.push(r);var w;if((w=O._getStatusCommands(i.itemView.model)).length>0){var b={text:t.ECM_CA_PROPOSED_PROPOSAL_STATUS,items:w};1==a.get("Access")&&n.push(b)}var _={text:t.ECM_CA_Edit_Proposed_Changs,fonticon:"pencil",icon:"I_ChangeCnxObjEdit",handler:function(){var e=[];i.itemView.model.id;a&&e.push(a),i.proOpnView.dispatchEvent("editProposed",[i.itemView,e,arguments[0]])}};1==a.get("Access")&&l&&"Flowdown"!=C&&n.push(_),n.push.apply(n,e);var D={id:"Properties",text:t.ECM_CA_Properties,fonticon:"fonticon fonticon-info-open-in-a-new-window",icon:"I_ChangeCnxObjProps",multisel:!0,handler:function(e){var t=i.itemView.model.get("objectId").replace("pid:","");g.createPropertiesComponent(t)}},N={id:"ChangeImpacts",text:E.CHG_Change_Impact_Command_Label,fonticon:"change",icon:"ChangeImpact",handler:function(e){let t={};t.objectID=i.itemView.model.get("objectId").replace("pid:",""),t.label=i.itemView.model._attributes.objectTitle,t.objectRevision=i.itemView.model._attributes.revision,t.objectType=i.itemView.model._attributes.type,t.serviceId="3DSpace",S.launchImpactsView(t)}};1==a.get("Access")&&("Create"!=a.get("operationActual")&&n.push(D),n.push(N)),y.getDocuments([i.itemView.model.get("objectId").slice("4")]).then((function(e){var o={id:"download",text:t.ECM_CA_Download,fonticon:"download",icon:"I_ChangeCnxObjDownload",multisel:!0,handler:function(e){var t=i.itemView.model.get("objectId").slice("4"),n=[];n.push(t);y.download(n)}},s={id:"preview",text:t.ECM_CA_Preview,fonticon:"eye",icon:"I_ChgPreviewIcon",multisel:!0,handler:function(e){var t=i.itemView.model.get("objectId").slice("4"),n=[];n.push(t),y.preview(n)}};i.itemView&&i.itemView.model&&"TRUE"===e[0].dataelements.isDocumentType&&"Flowdown"!=C&&(n.push(o),n.push(s));var r={id:"ChangeAssessment",text:t.ECM_CA_Proposed_Change_Assessment,fonticon:"component",icon:"I_ChangeCnxObjProps",multisel:!0,handler:function(e){var t=i.itemView.model.get("objectId"),n=[t];u.getGlobalVariable().isNative?m.DispatchEventToWin("ChangeAssessment",t.replace("pid:","")):h.openRelationalExplorer(n)}};l&&n.push(r);var c={text:t.ECM_CA_Remove_Proposed_Changes,fonticon:"trash",icon:"I_ChangeCnxObjTrash",handler:function(e){var t=[],n=(i.itemView.model.id,i.itemView.model);n&&t.push(n),i.proOpnView.dispatchEvent("deleteProposed",[i.itemView,t,arguments[0]])}},d=!0,p=h.getCurrentModel();if(UWA.is(p)&&UWA.is(p.get("userAccess"))){var g=p.get("userAccess");(g&&g.DeleteProposed&&"false"===g.DeleteProposed||!g.DeleteProposed)&&(d=!1)}1==d&&"Flowdown"!=a.get("operationActual")&&n.push(c),h._initDropDown(n,O.itemView)}))}))}},_getStatusCommands:function(e){var i=e.get("operationActual"),n=[],o=this,a=!0,s=!0,r=!0,l=!0,c=!0,d=h.getCurrentModel();if(UWA.is(d)&&UWA.is(d.get("userAccess"))){var p=d.get("userAccess");(p&&p.proposedStatusAsComplete&&"false"===p.proposedStatusAsComplete||!p.proposedStatusAsComplete)&&(a=!1),(p&&p.proposedStatusAsPartial&&"false"===p.proposedStatusAsPartial||!p.proposedStatusAsPartial)&&(s=!1),(p&&p.proposedStatusAsIgnored&&"false"===p.proposedStatusAsIgnored||!p.proposedStatusAsIgnored)&&!1,(p&&p.proposedStatusAsNotStarted&&"false"===p.proposedStatusAsNotStarted||!p.proposedStatusAsNotStarted)&&(r=!1),(p&&p.proposedStatusAsRejected&&"false"===p.proposedStatusAsRejected||!p.proposedStatusAsRejected)&&(l=!1),(p&&p.proposedStatusAsStarted&&"false"===p.proposedStatusAsStarted||!p.proposedStatusAsStarted)&&(c=!1)}return"Flowdown"!=i&&r&&n.push({id:"status-not-started",text:t.ECM_PROPOSED_STATUS_NOT_STARTED_COMMAND,handler:function(){o.updateProposedStatus(e,"Not Started")}}),c&&n.push({id:"status-started",text:t.ECM_PROPOSED_STATUS_STARTED_COMMAND,handler:function(){o.updateProposedStatus(e,"Started")}}),a&&n.push({id:"status-complete",text:t.ECM_PROPOSED_STATUS_COMPLETE_COMMAND,handler:function(){o.updateProposedStatus(e,"Complete")}}),s&&n.push({id:"status-partial",text:t.ECM_PROPOSED_STATUS_PARTIAL_COMMAND,handler:function(){o.updateProposedStatus(e,"Partial")}}),l&&n.push({id:"status-rejected",text:t.ECM_PROPOSED_STATUS_REJECT_COMMAND,handler:function(){o.updateProposedStatus(e,"Rejected")}}),n},OnSearchComplete:function(e){var t=O.itemView.model,i="";if(u.getGlobalVariable().isNative){for(var n=e.split("~"),o=[],a=0;a<n.length;a++)o.push(n[a]);for(var s=[],r=0;r<n.length;r++)s.push(o[r].split(","));var l=[];for(a=0;a<s.length;a++){var c=s[a];l.push(c[0])}i=l[0]}else if(e){var d=e[0];d&&Array.isArray(d)&&(i=d[0])}if(i&&""!=i){var p={proposedId:t.get("id"),selectedObjID:i},h=O.getJSONForAddResolution(p);O.proOpnView.dispatchEvent("OnAddResolutionItem",[h])}},updateProposedStatus:function(e,t){e.get("operationActual");var i={selectedIDs:[e.get("id")],status:t},n=O.getJSONForUpdateStatus(i);this.proOpnView.dispatchEvent("OnUpdateProposedStatus",[n])},launchSearchForSolutionItems:function(e){if(u.getGlobalVariable().isNative){m.DispatchEventToWin("Add_Resolution","AddResolutionItem")}else{var t=h.activateSearch(u.getGlobalVariable().proposedSearchType,"resolutionItems");h.search("Identify Solutions",u.getGlobalVariable().proposedSearchType,this.OnSearchComplete,"resolutionItems",t)}},launchRevisionExplorerForSolutionItems:function(e,i){var n=this,o=e.get("objectId"),a=e.get("objectType");this._versionExplorerContainer=UWA.createElement("div",{styles:{height:"100%",width:"100%"}}),this.versionExplorer=new f({versionGraphContainer:this._versionExplorerContainer,selectionMode:C.SELECTION_MODES.SINGLE_SELECT_ONLY,autoUpdate:!0,showToolbar:!1,displayMode:C.DISPLAY_MODES.SUBWAY_VIEW,widget:widget});var s={};s.displayMode=C.DISPLAY_MODES.SUBWAY_VIEW,v.loadUserSettingsPromise(s).then((function(){n.versionExplorer.publishEvent("ENOXVersionExplorerLoadVersionModel",{id:o,tenantId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",type:a,securityContext:u.getGlobalVariable().getSecurityContext().replace("ctx::",""),dataModelType:C.DATA_MODEL_TYPES.MODEL_ER}),n.versionExplorer.subscribeEvent("ENOXVersionExplorerModalOK",(function(o){var a=[],s=o;if(s&&Array.isArray(s))for(var r=0;r<s.length;r++){var l=s[r];if(l&&l._options&&l._options.data){var c=l._options.data.id;a.push(c)}}if(a.length>0)if(i){var d={proposedId:e.get("id"),selectedObjID:a[0]},p=O.getJSONForAddResolution(d);n.proOpnView.dispatchEvent("OnAddResolutionItem",[p])}else{if("Complete"===e.get("status"))b.error(t.ECM_CA_PROPOSED_STATUS_COMPLETED_ERR);else{d={};a[0]="pid:"+a[0],d.objectsToAddArr=a,d.proposedToRemove=e,n.proOpnView.dispatchEvent("onHigherRevisionSelected",[d])}}else b.warn(t.ECM_CA_RESOLUTION_NO_OBJECT_SELECTED_WARNING)})),n.versionExplorer.subscribeEvent("ENOXVersionExplorerModalCancel",(function(){}))})),this.versionExplorer.showDialog({clientX:0,clientY:0},widget.body,!0)},changeAccordIconAndExpandTile:function(e){var t=this.container.getElement("#accordion-div-"+e),i=t.getElementsByTagName("span")[0].className;i.indexOf("expand-right")>0?t.getElementsByTagName("span")[0].className=i.replace("right","down").trim():i.indexOf("expand-down")>0&&(t.getElementsByTagName("span")[0].className=i.replace("down","right").trim()),O.accordionClassName=t.getElementsByTagName("span")[0].className,O.expandTile(e)},expandTile:function(e){this.makeActivitiesView(this.container.myProposedModel.at(e),e);var t=document.getElementById("expanded-"+e);if(t){var i=t.className;if(i.indexOf("hidden")>0){t.className=i.replace("hidden","").trim();if(t&&t.getElement){t.getElement(".activity-content");var n=t.getElement(".activities-chevron").children[0].children[0],o=n.className;o.indexOf("expand-right")>0&&(n.className=o.replace("right","down").trim())}}else t.className=i+" hidden"}var a=document.getElementById("collapsed-"+e);a&&(a.style.borderBottom.indexOf("hidden")>=0?a.style.borderBottom="":a.style.borderBottom="hidden"),O.selectedTilesIDMap.set(e,e),O.selectedTilesMap.set(e,a),O.onResize(e)},makeActivitiesView:function(e,t){var i=e.get("activities"),n="#expanded-"+t,o=this.container.getElement(n);if(o){if(o.getElement(".proposed-activities-activities-holder"))return;this.activitiesView=new(s._createView_TestProposed(!1,i,t)),this._actvitiesEvents={deleteActivity:function(){var e={};e.operationIdx=t,this.dispatchEvent("deleteActivity",[arguments[1],e])},editActivity:function(){var e={};e.operationIdx=t,this.dispatchEvent("editActivity",[arguments[1],e])}};this.container.listenTo(this.activitiesView,this._actvitiesEvents),this.container.injectSubView(this.activitiesView,n)}},deactivateMultisel:function(){for(var e=O.container.container,t=e.getElements(".proposedOperation-actions-container"),i=0;i<t.length;i++){t[i].removeClassName("no-actions")}var n=e.getElements(".accordion-div-inner"),o=e.getElements(".checkbox-accord");for(i=0;i<n.length;i++){var a=n[i];a.removeClassName("hidden");var s=a.getElementsByTagName("span")[0].className;s.indexOf("expand-down")>0&&(a.getElementsByTagName("span")[0].className=s.replace("down","right").trim());var r=o[i];r.checked&&(r.checked=!1),r.addClassName("hidden")}var l=e.getElements(".proposedOperation-main-container");for(i=0;i<l.length;i++){l[i].removeClassName("selected-border")}O.onResize()},activateMultisel:function(){for(var e=O.container.container,t=e.getElements(".proposedOperation-actions-container"),i=0;i<t.length;i++){t[i].addClassName("no-actions")}var n=e.getElements(".accordion-div-inner"),o=e.getElements(".checkbox-accord");for(i=0;i<n.length;i++){var a=n[i];o[i].removeClassName("hidden"),a.addClassName("hidden")}var s=e.getElements(".proposed-tile-expanded");for(i=0;i<s.length;i++){var r=s[i];!1===r.hasClassName("hidden")&&r.addClassName("hidden")}var l=e.getElements(".proposed-tile-collapsed");for(i=0;i<l.length;i++){l[i].style.borderBottom=""}O.onResize()},resizeForTabletView:function(e,t){e.middleSubContainer&&(t.indexOf("expand-right")>=0?e.middleSubContainer.css("display","none"):t.indexOf("expand-down")>=0&&(e.middleSubContainer.css("display","block"),e.middleSubContainer.css("padding-top","3px"),e.middleSubContainer.css("border-right","none"))),e.secondSubContainer&&e.secondSubContainer.css("flex-basis","auto"),null!=e.matCollabContainerElem&&e.matCollabContainerElem.css("display","block"),null!=e.matContainerElem&&e.matContainerElem.css("margin-right","0px"),null!=e.collabContainerElem&&e.collabContainerElem.css("margin-left","0px"),null!=e.moreInfoContainerElem&&(e.moreInfoContainerElem.css("flex-direction","row"),e.moreInfoContainerElem.css("-webkit-flex-direction","row"),e.moreInfoContainerElem.css("-ms-flex-direction","row"),t.indexOf("expand-down")>=0?e.moreInfoContainerElem.css("padding-bottom","10px"):t.indexOf("expand-right")>=0&&(e.moreInfoContainerElem.css("border-bottom","none"),e.moreInfoContainerElem.css("padding-bottom","0px"))),e.flowDownContainer&&(t.indexOf("expand-right")>=0&&e.flowDownContainer.css("display","none"),t.indexOf("expand-down")>=0&&e.flowDownContainer.css("display","flex")),e.statusResolutionContainer&&(t.indexOf("expand-right")>=0&&e.statusResolutionContainer.css("display","none"),t.indexOf("expand-down")>=0&&e.statusResolutionContainer.css("display","flex")),e.collapsedOperationContainer&&e.collapsedOperationContainer.css("display","none"),e.nameOperationContainer&&e.nameOperationContainer.css("display","block"),null!=e.reasonElem[0]&&(t.indexOf("expand-right")>=0?(e.reasonElem.css("display","none"),e.flowDownElem&&e.flowDownElem.css("display","none"),e.moreElem&&e.moreElem.css("display","none")):t.indexOf("expand-down")>=0&&(e.reasonElem.css("display","-webkit-box"),e.reasonElem.css("display","flex"),e.reasonElem.css("display","-moz-box"),e.reasonElem.css("display","-webkit-flexbox"),e.reasonElem.css("display","-ms-flexbox"),e.reasonElem.css("display","-webkit-flex"),e.reasonElem.css("display","flex"),e.reasonElem.css("margin-top","10px"),e.flowDownElem&&(e.flowDownElem.css("display","-webkit-box"),e.flowDownElem.css("display","flex"),e.flowDownElem.css("display","-moz-box"),e.flowDownElem.css("display","-webkit-flexbox"),e.flowDownElem.css("display","-ms-flexbox"),e.flowDownElem.css("display","-webkit-flex"),e.flowDownElem.css("display","flex"),e.flowDownElem.css("margin-top","10px")),e.moreElem&&0!=e.reasonElem[0].clientHeight&&(e.reasonElem[0].clientHeight<e.reasonElem[0].scrollHeight||"none"===e.reasonElem.css("max-height"))&&(e.moreElem.css("display","-webkit-box"),e.moreElem.css("display","-moz-box"),e.moreElem.css("display","-webkit-flexbox"),e.moreElem.css("display","-ms-flexbox"),e.moreElem.css("display","-webkit-flex"),e.moreElem.css("display","flex"))))},resizeForMobileView:function(e,t){e.collapsedOperationContainer&&(t.indexOf("expand-down")>=0?e.collapsedOperationContainer.css("display","none"):t.indexOf("expand-right")>=0&&e.collapsedOperationContainer.css("display","flex")),e.nameOperationContainer&&(t.indexOf("expand-down")>=0?e.nameOperationContainer.css("display","block"):t.indexOf("expand-right")>=0&&e.nameOperationContainer.css("display","none")),e.matCollabContainerElem&&(t.indexOf("expand-down")>=0?e.matCollabContainerElem.css("display","block"):t.indexOf("expand-right")>=0&&e.matCollabContainerElem.css("display","none")),e.middleSubContainer&&(t.indexOf("expand-right")>=0?e.middleSubContainer.css("display","none"):t.indexOf("expand-down")>=0&&(e.middleSubContainer.css("display","block"),e.middleSubContainer.css("padding-top","3px"),e.middleSubContainer.css("border-right","none"))),e.secondSubContainer&&e.secondSubContainer.css("flex-basis","auto"),e.moreInfoContainerElem&&(t.indexOf("expand-down")>=0||t.indexOf("expand-right")>=0&&e.matCollabContainerElem.css("display","none")),e.flowDownContainer&&(t.indexOf("expand-right")>=0&&e.flowDownContainer.css("display","none"),t.indexOf("expand-down")>=0&&e.flowDownContainer.css("display","flex")),e.statusResolutionContainer&&(t.indexOf("expand-right")>=0&&e.statusResolutionContainer.css("display","none"),t.indexOf("expand-down")>=0&&e.statusResolutionContainer.css("display","flex")),e.reasonElem[0]&&(t.indexOf("expand-right")>=0?(e.reasonElem.css("display","none"),e.flowDownElem&&e.flowDownElem.css("display","none"),e.moreElem&&e.moreElem.css("display","none")):t.indexOf("expand-down")>=0?(e.reasonElem.css("display","-webkit-box"),e.reasonElem.css("display","-moz-box"),e.reasonElem.css("display","-webkit-flexbox"),e.reasonElem.css("display","-ms-flexbox"),e.reasonElem.css("display","-webkit-flex"),e.reasonElem.css("display","flex"),e.reasonElem.css("margin-top","5px"),e.flowDownElem&&(e.flowDownElem.css("display","-webkit-box"),e.flowDownElem.css("display","-moz-box"),e.flowDownElem.css("display","-webkit-flexbox"),e.flowDownElem.css("display","-ms-flexbox"),e.flowDownElem.css("display","-webkit-flex"),e.flowDownElem.css("display","flex"),e.flowDownElem.css("margin-top","5px")),e.moreElem&&0!=e.reasonElem[0].clientHeight&&(e.reasonElem[0].clientHeight<e.reasonElem[0].scrollHeight||"none"===e.reasonElem.css("max-height"))&&(e.moreElem.css("display","-webkit-box"),e.moreElem.css("display","-moz-box"),e.moreElem.css("display","-webkit-flexbox"),e.moreElem.css("display","-ms-flexbox"),e.moreElem.css("display","-webkit-flex"),e.moreElem.css("display","flex"),e.moreElem.css("margin-top","5px"))):""===t&&e.reasonElem.css("display","none"))},resizeForOthers:function(e,t){e.middleSubContainer&&(e.middleSubContainer.css("display","block"),e.middleSubContainer.css("border-right","2px solid #d1d4d4")),e.secondSubContainer&&(e.secondSubContainer.css("-webkit-box-flex","1"),e.secondSubContainer.css("-moz-box-flex","1"),e.secondSubContainer.css("-ms-flex","1"),e.secondSubContainer.css("-webkit-flex","1"),e.secondSubContainer.css("flex","1")),e.reasonElem&&(e.reasonElem.css("margin-top","0px"),e.reasonElem.css("display","-webkit-box"),e.reasonElem.css("display","-ms-flexbox"),e.reasonElem.css("display","-moz-box"),e.reasonElem.css("display","-webkit-flexbox"),e.reasonElem.css("display","-ms-flexbox"),e.reasonElem.css("display","-webkit-flex"),e.reasonElem.css("display","flex")),e.flowDownElem&&(e.flowDownElem.css("margin-top","0px"),e.flowDownElem.css("display","-webkit-box"),e.flowDownElem.css("max-height","3.6em"),e.flowDownElem.css("display","-ms-flexbox"),e.flowDownElem.css("display","-moz-box"),e.flowDownElem.css("display","-webkit-flexbox"),e.flowDownElem.css("display","-ms-flexbox"),e.flowDownElem.css("display","-webkit-flex"),e.flowDownElem.css("display","flex"),e.flowDownElem.css("align-items","center")),e.moreElem&&e.moreElem.css("display","none"),e.firstSubContainer&&(e.firstSubContainer.css("border-bottom","none"),e.firstSubContainer.css("padding-bottom","0px")),e.secondSubContainer&&e.secondSubContainer.css("margin-right","30px"),e.matCollabContainerElem&&e.matCollabContainerElem.css("display","block"),e.matContainerElem&&e.matContainerElem.css("margin-right","0px"),e.collabContainerElem&&e.collabContainerElem.css("margin-left","0px"),e.moreInfoContainerElem&&(e.moreInfoContainerElem.css("flex-direction","row"),e.moreInfoContainerElem.css("-webkit-flex-direction","row"),e.moreInfoContainerElem.css("-ms-flex-direction","row"),e.moreInfoContainerElem.css("border-bottom","none"),e.moreInfoContainerElem.css("padding-bottom","0px")),e.changeReasonText&&(e.changeReasonText.css("max-height","none"),e.changeReasonText.css("overflow","hidden"),e.changeReasonText.css("white-space","nowrap")),e.flowDownContainer&&e.flowDownContainer.css("display","flex"),e.statusResolutionContainer&&e.statusResolutionContainer.css("display","flex"),e.nameOperationContainer&&e.nameOperationContainer.css("display","block"),e.collapsedOperationContainer&&e.collapsedOperationContainer.css("display","none")},resizeProposedOperations:function(e,t){void 0===e&&(e=O.collapsedTile);var i={};if(e){var n=e.id.trim();i.reasonElem=c("#"+n).find(".proposedOperation-change-reason-container"),i.flowDownElem=c("#"+n).find(".proposedOperation-flowdown-from"),i.moreElem=c("#"+n).find(".proposedOperation-more-container"),i.firstSubContainer=c("#"+n).find(".proposedOperation-sub-container-first"),i.middleSubContainer=c("#"+n).find(".proposedOperation-sub-container-middle"),i.secondSubContainer=c("#"+n).find(".proposedOperation-sub-container-second"),i.matCollabContainerElem=c("#"+n).find(".proposedOperation-mat-collab-container"),i.matContainerElem=c("#"+n).find(".proposedOperation-mat-container"),i.collabContainerElem=c("#"+n).find(".proposedOperation-collab-container"),i.moreInfoContainerElem=c("#"+n).find(".proposedOperation-more-info-container"),i.proposedOpActionsContainerElem=c(".proposedview-proposedActions"),i.statusResolutionContainer=c("#"+n).find(".proposedOperation-status-solution-container"),i.flowDownContainer=c("#"+n).find(".proposedOperation-flowdown-info-container"),i.changeReasonText=c("#"+n).find(".proposedOperation-reason-text-container"),i.nameOperationContainer=c("#"+n).find(".proposedOperation-desc-op-container"),i.collapsedOperationContainer=c("#"+n).find(".proposedOperation-collab-container-op-container")}var o="laptop",a=window.matchMedia("(max-width: 992px) and (min-width: 768px)"),s=window.matchMedia("(max-width: 768px)");switch(a.matches&&(o="tablet"),s.matches&&(o="mobile"),o){case"tablet":O.resizeForTabletView(i,t);break;case"mobile":O.resizeForMobileView(i,t);break;case"laptop":O.resizeForOthers(i,t);break;default:console.log("invalid viewport selected")}},onResize:function(e){O.selectedTilesMap.forEach((function(e,t){var i="",n="";e&&(n=e.id);var o=c("#"+n).find(".fonticon");o&&(i=o[0].className),O.resizeProposedOperations(e,i)}))},getJSONForUpdateStatus:function(e){var t=O.getJSONForModifyProposed(),i="";if(""!=e.status&&(i=e.status),UWA.is(e.selectedIDs)&&Array.isArray(e.selectedIDs))for(var n=0;n<e.selectedIDs.length;n++){var o=e.selectedIDs[n];if(""!=o){var a={id:o,status:i};t.changeaction.modify.proposed.push(a)}}return t},getJSONForAddResolution:function(e){var t=O.getJSONForModifyProposed(),i=[];""!=e.selectedObjID&&i.push("pid:"+e.selectedObjID);var n={id:e.proposedId,resolution:i};return t.changeaction.modify.proposed.push(n),t},getJSONForModifyOperation:function(e){var t=O.getCABaseJSONForOperations(),i=!1,n=!1,o=e.operation,a=e.operationWHY,s=e.status,r=e.activityActual;UWA.is(r)&&"NoSelection"!=r&&(t.changeaction.add.proposed=[],i=!0),(UWA.is(o)&&"NoSelection"!=o||UWA.is(a)&&""!=a||UWA.is(s)&&"NoSelection"!=s)&&(t.changeaction.modify.proposed=[],n=!0);var l="",c="";if("Create"==o)l={id:e.pid,operation:{name:o,type:e.objectType,"display name":e.objectName},why:{comment:{text:a}}},t.changeaction.modify.proposed.push(l);else for(var d=e.proposedIDArr,p=0;p<d.length;p++){var u=d[p];if(n&&("NoSelection"==o?l={id:u,why:{comment:{text:a}},status:s}:(l={id:u,operation:{name:o},why:{comment:{text:a}}}).operation["evolution name"]=e.evolutionName,t.changeaction.modify.proposed.push(l)),i){c={id:u,activities:[]};var h="";"Modify"==e.activityActual?h={what:{operation:"Modify"},why:{comment:{text:e.reasonForChangeForActivity}}}:"Release"==e.activityActual?h={what:{operation:"ChangeStatus","target state":"Release"},why:{comment:{text:e.reasonForChangeForActivity}}}:"Obsolete"==e.activityActual?h={what:{operation:"ChangeStatus","target state":"Obsolete"},why:{comment:{text:e.reasonForChangeForActivity}}}:"Restore"==e.activityActual&&(h={what:{operation:"ChangeStatus","target state":"Restore"},why:{comment:{text:e.reasonForChangeForActivity}}}),c.activities.push(h),t.changeaction.add.proposed.push(c)}}return t},getJSONForModifyProposed:function(){var e=O.getCABaseJSONForOperations();return e.changeaction.modify={proposed:[]},e},getJSONForAddProposed:function(){var e=O.getCABaseJSONForOperations();return e.changeaction.add={proposed:[]},e},getCABaseJSONForOperations:function(){return JSON.parse(JSON.stringify({version:"v0",changeaction:{cestamp:"0000",add:{},delete:{},modify:{}}}))},getFlowdownContextOptions:function(){return O.flowdownForContextOptions},setFlowdownContextOptions:function(e){O.flowdownForContextOptions=e}};return O})),define("DS/ENOChangeActionUX/scripts/Views/CAProposedHeaderView",["UWA/Class/View","DS/ENOChangeActionUX/scripts/Views/CAProposedOperationView","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/Handlebars/Handlebars4","DS/W3DXComponents/Views/Item/CounterView","DS/W3DXComponents/Views/Item/ActionsInlineView","DS/W3DXComponents/Collections/ActionsCollection","DS/W3DXComponents/Views/Item/MultiselView","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgGovernanceUX/scripts/util/DocumentUtils"],(function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m){"use strict";var g={_createView_TestHeader:function(n,o,f,C,v,A){return e.extend({name:"proposedview",tagName:n,className:o,currModel:null,proposedModel:C,caModel:A,model:A,setup:function(){this.template='                                            <div class="'+this.getClassNames("-header")+'">                                                    <div class="'+this.getClassNames("-proposedCounter")+'"></div>                                                    <div class="'+this.getClassNames("-proposedActions")+'"></div>                                                    <div class="'+this.getClassNames("-proposedMultisel")+'"></div>                                            <div>',this.myProposedModel=C,this._initCounterView(),this._initActionsView(v),this._initMultiSelView(),this.renderer=this.getTemplate(this.template);var e=this;widget.addEvent("onResize",(function(){setTimeout((function(){if(UWA.is(e.actionsView)){e.actionsView.destroy();var t=e.container.getElement(".proposedview-proposedActions");e._initActionsView(v),e.actionsView&&t&&(t.empty(),t.grab(e.actionsView.render().getContent()),e.actionsView&&e.actionsView.dispatchEvent("onShow"))}}),100)}))},render:function(){var e=this.name;this.caModel&&u.setCurrModel(this.caModel);this.cid;this.container.empty();var t=this.container,i=UWA.createElement("div",{class:"proposedview-counter-details",styles:{width:"99.5%",height:"10%"}});i.setAttribute("data-rec-id","proposedview-counter-details-CA");var n=this.renderer();return i.addContent(n),i.inject(t),this.injectSubView(this.counterView,"."+e+"-proposedCounter"),this.injectSubView(this.actionsView,"."+e+"-proposedActions"),this.injectSubView(this.proposedMultiSelView,"."+e+"-proposedMultisel"),this.actionsView&&this.actionsView.dispatchEvent("onShow"),this.counterView&&this.counterView.dispatchEvent("onShow"),this.proposedMultiSelView&&this.proposedMultiSelView.dispatchEvent("onShow"),this},_initCounterView:function(){this.counterView=new s({title:i.ECM_CA_ProposedChanges,collection:this.myProposedModel})},_initActionsView:function(e){var t;t="asc"==e?"sort-alpha-desc":"sort-alpha-asc";var n=i.ECM_CA_Sort_ProposedChanges_Title,o=[{id:"search",title:i.ECM_CA_Search_ProposedChanges,icon:"search",overflow:!1},{id:"sort",title:n,icon:t,overflow:!1}],a={id:"filterOperationView",title:i.ECM_CA_Filter_Realized_Operations,icon:"filter",overflow:!1},s={id:"selectAll",title:i.SelectAll,icon:"select-all",overflow:!1},c={id:"unSelectAll",title:i.UnSelectAll,icon:"select-none",overflow:!1},p={id:"switchView",title:i.ECM_CA_SWITCH_VIEW,icon:"view-big-tile",overflow:!1},h=!0,m=u.getCurrentModel();if(UWA.is(m)&&UWA.is(m.get("userAccess"))){var g=m.get("userAccess");(g&&g.AddProposed&&"false"===g.AddProposed||!g.AddProposed)&&(h=!1)}h&&("true"===d.getGlobalVariable().CHG_ADD_MASS_PROPOSED?(o.unshift({id:"define",title:i.ECM_CA_Define_ProposedChange,icon:"plus",overflow:!1}),o.unshift({id:"add",title:i.ECM_CA_Add_ProposedChanges,icon:"list-add",overflow:!1})):o.unshift({id:"define",title:i.ECM_CA_Add_ProposedChanges,icon:"plus",overflow:!1})),o.push(a),o.push(s),o.push(c),o.push(p);var f=new l(o);this.actionsView=new r({collection:f});var C=this._actionsViewEvents={onActionClick:function(){Array.prototype.unshift.call(arguments,this.actionsView),this.dispatchEvent("onActionClick",arguments)}};this.listenTo(this.actionsView,C)},_initMultiSelView:function(){var e=this,n={collection:new l,withMultisel:!0,useInfiniteScroll:!1,usePullToRefresh:!1,buildMultiselActions:function(t){var n=[],o=!0,a=u.getCurrentModel();UWA.is(t)&&null!=t&&null!=t&&d.getGlobalVariable().isNative&&(n.push({id:null,text:i.ECM_CA_Command_ExploreWith,fonticon:null,icon:null,multisel:!0,items:[{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreInContextHdr",icon:"I_FindInContext",multisel:!0,text:i.ECM_CA_Command_ExploreContext,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("exploreInContext",arguments)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInMSB",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:i.ECM_CA_Command_ExploreMSB,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("exploreInMsb",arguments)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreParentsHdr",icon:"I_GetParents",multisel:!0,text:i.ECM_CA_Command_ExploreParents,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("exploreInParents",arguments)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInPPR",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:i.ECM_CA_Command_ExploreMfg,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("exploreInPPR",arguments)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmMultiDagExploreInCmd",icon:"I_ExploreInRFLPNavigator",multisel:!0,text:i.ECM_CA_Command_ExploreSys,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("exploreInRFLP",arguments)}}]}),n.push({accelerator:"",availabilityMode:null,id:null,icon:null,items:[{accelerator:"Ctrl+O",availabilityMode:"Normal=YES CommandSet=YES Editability=YES SmallScale=YES LargeScale=YES ",id:"OpenFromCA",icon:"I_OpenDB",multisel:!0,text:i.ECM_CA_Command_Open,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("open",arguments)}},{accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInCentral",icon:"I_ExploreInCentral_normal",multisel:!0,text:i.ECM_CA_Command_Explore3DSpace,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("exploreInCollabNApproval",arguments)}},{accelerator:"Ctrl+Shift+O",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ENOVIA_Open_OpenAdvanced",icon:"I_OpenAdvDB",multisel:!0,text:i.ECM_CA_Command_OpenAdv,handler:function(i){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("openAdv",arguments)}}],multisel:!0,text:i.ECM_CA_Command_OpenWith}));var s={id:"download",text:i.ECM_CA_Download,fonticon:"download",icon:"I_ChangeCnxObjDownload",multisel:!0,handler:function(e){var t=[];e.forEach((function(e){t.push(e.get("objectId").slice(4))}));var n=[];m.getDocuments(t).then((function(e){e.forEach((function(e){"TRUE"===e.dataelements.isDocumentType&&n.push(e.id)})),n.length<t.length&&p.info(i.ECM_CA_Download_Skipped),m.download(n)}))}};n.push(s);var r={id:"mass-update",text:i.ECM_CA_Proposed_Mass_Update,fonticon:"pencil",icon:"I_ChangeCnxObjEdit",multisel:!0,handler:function(t){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("massUpdateMultiSel",arguments)}};a=u.getCurrentModel();UWA.is(a)&&UWA.is(a.get("userAccess"))&&((C=a.get("userAccess"))&&C.AddProposed&&"false"===C.AddProposed||C.AddProposed);var l=e._getStatusCommands(t);if(l.length>0){var c={id:"status-update",text:i.ECM_CA_PROPOSED_PROPOSAL_STATUS,items:l,multisel:!0};n.push(c)}var g={id:"changematurity",text:i.ECM_CA_Change_Maturity,fonticon:"promote",icon:"I_ChangeCnxObjPromote",multisel:!0,handler:function(t){Array.prototype.unshift.call(arguments,t),e.dispatchEvent("changematurityMultiSel",arguments)}},f=!0;UWA.is(a)&&UWA.is(a.get("userAccess"))&&(((C=a.get("userAccess"))&&C.AddProposed&&"false"===C.AddProposed||!C.AddProposed)&&(f=!1));f&&n.push(r),"false"!=d.getGlobalVariable().CHG_CHANGE_MATURITY&&n.push(g);var C,v={id:"ChangeAssessment",text:i.ECM_CA_Proposed_Change_Assessment,fonticon:"component",icon:"I_ChangeCnxObjEdit",multisel:!0,handler:function(e){var t=[],i=[];e.forEach((function(e){var n=e.get("objectId");null!=n&&null!=n&&""!=n||(n=e.get("id")),t.push(n),i.push(n.replace("pid:",""))})),d.getGlobalVariable().isNative?h.DispatchEventToWin("ChangeAssessment",i):u.openRelationalExplorer(t)}};(f&&n.push(v),UWA.is(a)&&UWA.is(a.get("userAccess")))&&(((C=a.get("userAccess"))&&C.DeleteProposed&&"false"===C.DeleteProposed||!C.DeleteProposed)&&(o=!1));return o&&n.push({id:"remove",text:i.ECM_CA_Referential_MultiSelActions_Remove,fonticon:"trash",icon:"I_ChangeCnxObjTrash",multisel:!0,handler:function(t){var n=[],o=!1;t.forEach((function(e){"Flowdown"===e.get("operationActual")?o=!0:n.push(e)})),o&&p.warn(i.ECM_CA_WARN_FLOWDOWN_SKIPPED),Array.prototype.unshift.call(arguments,n),e.dispatchEvent("removeMultiSel",arguments)}}),n},events:{onMultiselOff:function(){t.deactivateMultisel(),d.getGlobalVariable().arrOid&&d.getGlobalVariable().arrOid.length&&d.getGlobalVariable().arrOid.splice(0,d.getGlobalVariable().arrOid.length),e.dispatchEvent("emptySelectedModels",arguments)},onMultiselOn:function(){t.activateMultisel()}}};g.multiSelView=this.proposedMultiSelView=new c(n)},injectSubView:function(e,t){var i=this.container.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e){var t=a.compile(e);return function(){return t()}},domEvents:{"click .accordion-div":function(e){}},_getStatusCommands:function(e){var t=this,n=[],o=!0,a=!0,s=!0,r=!0,l=!0,c=u.getCurrentModel();if(UWA.is(c)&&UWA.is(c.get("userAccess"))){var d=c.get("userAccess");(d&&d.proposedStatusAsComplete&&"false"===d.proposedStatusAsComplete||!d.proposedStatusAsComplete)&&(o=!1),(d&&d.proposedStatusAsPartial&&"false"===d.proposedStatusAsPartial||!d.proposedStatusAsPartial)&&(l=!1),(d&&d.proposedStatusAsIgnored&&"false"===d.proposedStatusAsIgnored||!d.proposedStatusAsIgnored)&&!1,(d&&d.proposedStatusAsNotStarted&&"false"===d.proposedStatusAsNotStarted||!d.proposedStatusAsNotStarted)&&(a=!1),(d&&d.proposedStatusAsRejected&&"false"===d.proposedStatusAsRejected||!d.proposedStatusAsRejected)&&(s=!1),(d&&d.proposedStatusAsStarted&&"false"===d.proposedStatusAsStarted||!d.proposedStatusAsStarted)&&(r=!1)}return a&&n.push({id:"status-not-started",text:i.ECM_PROPOSED_STATUS_NOT_STARTED_COMMAND,handler:function(){t.updateProposedStatus(e,"Not Started")}}),r&&n.push({id:"status-started",text:i.ECM_PROPOSED_STATUS_STARTED_COMMAND,handler:function(){t.updateProposedStatus(e,"Started")}}),o&&n.push({id:"status-complete",text:i.ECM_PROPOSED_STATUS_COMPLETE_COMMAND,handler:function(){t.updateProposedStatus(e,"Complete")}}),l&&n.push({id:"status-partial",text:i.ECM_PROPOSED_STATUS_PARTIAL_COMMAND,handler:function(){t.updateProposedStatus(e,"Partial")}}),s&&n.push({id:"status-rejected",text:i.ECM_PROPOSED_STATUS_REJECT_COMMAND,handler:function(){t.updateProposedStatus(e,"Rejected")}}),n},updateProposedStatus:function(e,t){var i=[],n=[];e.forEach((function(e){var t=e.get("id");i.push(t),n.push(t.replace("pid:",""))}));var o={selectedIDs:i,status:t};this.dispatchEvent("updateStatusFromMultiSel",[o])},destroy:function(){return this.stopListening(),this.myProposedModel=null,this.counterView.destroy(),this.actionsView.destroy(),this.proposedMultiSelView.destroy(),this._parent.apply(this,arguments)}})}};return g})),define("DS/ENOChangeActionUX/scripts/Views/OperationForm",["DS/E6WCommonUI/Views/DetailsDisplayView","UWA/Class/View","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Input/Button","DS/ENOChangeActionUX/scripts/Search","DS/ENOChangeActionUX/scripts/Models/CAProposedModelForDisplayView","DS/ENOChangeActionUX/scripts/Views/CACustomSwitchView","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],(function(e,t,i,n,o,a,s,r,l,c,d,p){"use strict";var u=a.extend({displayViewModel:null,proposedCallback:null,slideInReference:null,selectedOperation:null,detailsView:null,init:function(t){UWA.is(t)&&(this.proposedCallback=t.callback,this.displayViewModel=new l(t,{parse:!0}),this.detailsView=new e,UWA.is(t.selectedOperation)&&(this.selectedOperation=t.selectedOperation,this.isMassUpdate=!0))},getHeading:function(){return this.isMassUpdate?i.ECM_CA_Proposed_Operation_Heading_MassUpdate:this.displayViewModel.get("isEdit")?i.ECM_CA_Proposed_Operation_Heading_Edit:i.ECM_CA_Add_Proposed_Change},getBody:function(){var e=this,t=UWA.createElement("div",{id:"formBody"});t.setAttribute("data-rec-id","formBodyCA");var i=UWA.Class.View.extend({setup:function(){this.listenTo(this.model,"onChange",this.render)},render:function(){UWA.is(arguments[0])&&(arguments[0].hasChanged("reasonForChange")||arguments[0].hasChanged("evolutionName")||arguments[0].hasChanged("createObjectType")||arguments[0].hasChanged("createObjectTitle")||arguments[0].hasChanged("reasonForChangeForActivity"))||(t.setContent(""),e.detailsView.setConfig(e.getConfig()),e.detailsView.model=e.displayViewModel,e.detailsView.tenant=p.getGlobalVariable().tenant,e.detailsView.context=enoviaServer.context,e.detailsView.render().inject(t))}});new i({model:e.displayViewModel}).render();return t},getConfig:function(){var e=[],t=new r({},!1);if(UWA.is(this.selectedOperation)||("true"==p.getGlobalVariable().CHG_ALLOW_CREATE_NEW_PROPOSED&&(this.isMassUpdate||this.displayViewModel.get("isEdit")||e.push({name:"createNewToggle",label:i.ECM_CA_Proposed_Operation_Operation_Create,customView:c})),this.isMassUpdate||this.displayViewModel.get("isCreateOperation")||e.push({readWrite:!UWA.is(this.displayViewModel.id),type:"object",name:"proposedObject",label:i.ECM_CA_Proposed_Operation_ProposedObject,attributeToDisplay:"objectName",singleObjectOnly:!0,searchTitle:i.ECM_CA_Proposed_Change_label,searchTypes:p.getGlobalVariable().proposedSearchType,required:!UWA.is(this.displayViewModel.id),imageAttribute:"image",typeAheadCallback:this.displayViewModel.proposedTypeAheadCallback,fieldHTMLId:"proposedObject",search:t})),!this.displayViewModel.get("isCreateOperation")){var n=!0;this.isMassUpdate&&(n=!1),e.push({readWrite:"true",name:"operationDisplaySelect",label:i.ECM_CA_Proposed_Operation_Operation,type:"select",required:n,values:this.displayViewModel.get("operationDisplayOptions")})}return this.displayViewModel.get("isEvolutionOperation")&&!this.displayViewModel.get("isCreateOperation")&&e.push({readWrite:"true",name:"evolutionName",label:i.ECM_CA_Operation_Evolution_Name,type:"text",required:!0,numberOfEditableLines:1,numberOfDisplayLines:1,fieldHTMLId:"evolutionName"}),this.displayViewModel.get("isCreateOperation")&&e.push({readWrite:"true",name:"createObjectType",label:i.ECM_CA_Operation_Create_ObjectType,type:"text",required:!0,numberOfEditableLines:1,numberOfDisplayLines:1,fieldHTMLId:"createObjectType"}),this.displayViewModel.get("isCreateOperation")&&e.push({readWrite:"true",name:"createObjectTitle",label:i.ECM_CA_Operation_Create_ObjectTitle,type:"text",required:!0,numberOfEditableLines:1,numberOfDisplayLines:1,fieldHTMLId:"createObjectTitle"}),e.push({readWrite:"true",name:"reasonForChange",label:i.ECM_CA_Proposed_Activity_ReasonForChange,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3}),/*!this.isMassUpdate &&*/!UWA.is(this.displayViewModel.get("operationActual"))||this.displayViewModel.get("isCreateOperation")||this.displayViewModel.get("isEdit")||e.push({readWrite:!0,name:"activityDisplaySelect",label:i.ECM_CA_Proposed_Change_Activity,type:"select",values:this.displayViewModel.get("activityDisplayOptions")}),UWA.is(this.displayViewModel.get("activityActual"))&&"NoSelection"!=this.displayViewModel.get("activityActual")&&!this.displayViewModel.get("isCreateOperation")&&e.push({readWrite:"true",name:"reasonForChangeForActivity",label:i.ECM_CA_Proposed_Activity_Description,type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:3}),e},getFooter:function(){var e=UWA.Element("div",{class:"slideinFooterBtns"});if(e.setAttribute("data-rec-id","slideinFooterBtnsCA"),UWA.is(this.selectedOperation))new s({value:i.ECM_CA_Button_Label_Save,className:"primary proposedButtons"}).inject(e).addEvent("onClick",this.onMassUpdateButtonClick.bind(this));else if(UWA.is(this.displayViewModel.id)){if(UWA.is(this.displayViewModel.id)){new s({value:i.ECM_CA_Button_Label_Save,className:"primary proposedButtons"}).inject(e).addEvent("onClick",this.onSaveButtonClick.bind(this))}}else{new s({value:i.ECM_CA_Button_Label_Add,className:"primary proposedButtons add"}).inject(e).addEvent("onClick",this.onAddButtonClick.bind(this)),new s({value:i.ECM_CA_Button_Label_AddAnother,className:"proposedButtons add-another add-cancel-btn"}).inject(e).addEvent("onClick",this.onAddAnotherButtonClick.bind(this))}return e},onAddButtonClick:function(){this.detailsView.isModelValid()?(this.proposedCallback(this.displayViewModel),this.slideInReference.hideSlideIn()):d.error(i.ECM_CA_MandFieldMissing_error)},onAddAnotherButtonClick:function(){this.detailsView.isModelValid()?(this.proposedCallback(this.displayViewModel),this.displayViewModel.clear(),this.displayViewModel.set("canEdit",!0)):d.error(i.ECM_CA_MandFieldMissing_error)},onSaveButtonClick:function(){this.detailsView.isModelValid()?(this.proposedCallback(this.displayViewModel),this.slideInReference.hideSlideIn()):d.error(i.ECM_CA_MandFieldMissing_error)},onMassUpdateButtonClick:function(){this.detailsView.isModelValid()?(this.proposedCallback(this.displayViewModel,this.selectedOperation),this.slideInReference.hideSlideIn()):d.error(i.ECM_CA_MandFieldMissing_error)},OnSearchComplete:function(e){for(var t=e.split("~"),i=[],n=0;n<t.length;n++)i.push(t[n]);for(var o=[],a=0;a<t.length;a++)o.push(i[a].split(","));var s=[];s.push(o[0][0]),this._tempReferenceToWinSearchCallback(s)}});return u})),define("DS/ENOChangeActionUX/scripts/Views/CANewProposedView",["UWA/Class/View","DS/ENOChangeActionUX/scripts/Views/CAProposedHeaderView","DS/ENOChangeActionUX/scripts/Views/CAProposedSearchFilterView","DS/ENOChangeActionUX/scripts/Views/CAProposedOperationView","DS/W3DXComponents/Views/EmptyView","DS/DataDragAndDrop/DataDragAndDrop","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","css!DS/ENOChangeActionUX/ENOChangeActionUX","UWA/Core","DS/PlatformAPI/PlatformAPI","DS/Handlebars/Handlebars4","DS/ENOChangeActionUX/scripts/Collection/CAProposedCollection","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChangeActionUX/scripts/Models/CAProposedModel","DS/ENOChangeActionUX/scripts/Views/CASlideInFormView","DS/ENOChangeActionUX/scripts/Views/OperationForm","DS/ENOChangeActionUX/scripts/Views/ActivityForm","DS/ENOChangeActionUX/scripts/Models/CAProposedActivityModel","DS/ENOChangeActionUX/scripts/Views/CAProposedActivitiesView","DS/UIKIT/DropdownMenu","DS/UIKIT/Popover","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices","DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/ENOChgServices/scripts/services/ChgProposedServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgDependencyServices","DS/ENOChgRouter5/scripts/ChgRouter","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENOChgGovernanceUX/scripts/wrapper/ChgGovBIFilter","DS/ENOChgServices/scripts/services/DefaultPreferencesManager","DS/ENOChgServices/scripts/services/UserPreferenceUtil","require"],(function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,y,b,S,E,_,D,O,N,M,I,x,T,R,V,P,U){"use strict";var W="desc",j={modelsToRemove:[],selectedOperationItems:[],itemsToSort:{},sortingFirstTime:!0,proposedCollection:new p,invokedFrom:"",filteredObjectIds:null,filteredActivities:null,_createView_TestProposed:function(n,o,a,r){return e.extend({name:"changeView",tagName:n,className:o,currModel:null,model:r,ChangeView:null,proposedModel:null,setup:function(){this.template='<div class="'+this.getClassNames("-container")+'">                                            <div class="'+this.getClassNames("-header-container")+'"></div>                                            <div class="'+this.getClassNames("-searchfilter-container")+'"></div>                                            <div class="'+this.getClassNames("-opdetails-container")+'"></div>                                          </div>';var e=this;j.options_copy=r,j.filteredObjectIds=void 0,j.filteredActivities=void 0,c.unsubscribe("ca-proposed-collection-updated"+widget.id),c.unsubscribe("ca-IDCard-on-change-refresh"),c.subscribe("ca-proposed-collection-updated"+widget.id,(function(t){e.render()})),c.unsubscribe(`caProposedChanges:${widget.id}`),c.unsubscribe(`caProposedChanges of ${widget.id}`),c.subscribe(`caProposedChanges:${widget.id}`,(function(){"false"==y.getGlobalVariable().slidePanelTagger&&require(["DS/ENOChgGovernanceUX/scripts/wrapper/ChgGovBIFilter"],(function(e){e._initializationPromiseBIFilter||e.initializeBIFilter(),e._cleanBIFilterProxy(),e.cleanPathTag();for(var t=[],i=j.getProposedCollection(),n=0;n<i.length;n++){var o=i.at(n);if(o){var a=o.get("objectId");a=a.replace("pid:",""),t.push(a)}}e._onSetPathTagsForProposedRealized(t,{options:{id:"caProposedChanges"}})}))})),c.subscribe(`caProposedChanges of ${widget.id}`,(function(e){for(var t=e.matchingIDs,i=[],n=0;n<t.length;n++)i.push("pid:"+t[n]);j.filteredObjectIds=i,j.filterProposedCollection()})),c.subscribe("ca-IDCard-on-change-refresh",(function(e){j.updateProposedCollection(e)})),widget.addEvent("onResize",(function(){if(t.multiSelView)if(y.getGlobalVariable().isNative)null!=t.selectionStateFromNative&&null!=t.selectionStateFromNative&&t.multiSelView.buildMultisel(t.selectionStateFromNative);else{var e={isActive:!0,selectedObjects:[]};t.multiSelView.buildMultisel(e),e.selectedObjects=j.modelsToRemove,t.multiSelView.buildMultisel(e)}})),j.invokedFrom=e.model.invokedFrom;let i={id:e.model.id};j.updateProposedCollection(i)},initSubViews:function(){j.proposedModel=j.getProposedCollection();UWA.is(j.originalProposedCollection)||(j.originalProposedCollection=j.proposedModel);j.proposedModel&&(this._initHeaderView(j.proposedModel),this._initSearchFilterView(j.proposedModel),this._initOperationView(j.proposedModel))},render:function(){j.modelsToRemove=[],j.currModel=this.model,j.ChangeView=this,E.setCurrModel(this.model),"gov"==j.invokedFrom&&(y.getGlobalVariable().IDCard={model:{id:this.model.id}});var e=j.getProposedCollection();j.originalProposedCollection=e,this.containerReference=this.container,this.initSubViews(),this.renderer=this.getTemplate(this.template);var t=this.name,i=null;UWA.is(this.containerReference)&&(i=this.containerReference.getElement(".main-proposed-change-container"),UWA.is(i)&&(i.empty(),i.destroy(),i=null)),j.selectedOperationItems&&j.selectedOperationItems.length&&j.selectedOperationItems.splice(0,j.selectedOperationItems.length),UWA.is(i)||(i=this.mainContainerDiv=UWA.createElement("div",{class:"main-proposed-change-container",styles:{width:"99.9%",height:"100%"}})).setAttribute("data-rec-id","main-proposed-change-container-CA");var n=this.renderer();i.addContent(n),i.inject(this.containerReference);var o=this;setTimeout((function(){o.injectSubView(o.proposedHeaderView,"."+t+"-header-container"),o.injectSubView(o.searchFilterView,"."+t+"-searchfilter-container"),o.injectSubView(o.operationView,"."+t+"-opdetails-container"),u.endWait(o.container)}),0),o.model.isSelected&&"false"==y.getGlobalVariable().slidePanelTagger&&require(["DS/ENOChgGovernanceUX/scripts/wrapper/ChgGovBIFilter"],(function(t){t._initializationPromiseBIFilter||t.initializeBIFilter(),t._cleanBIFilterProxy(),t.cleanPathTag();for(var i=[],n=e,o=0;o<n.length;o++){var a=n.at(o);if(a){var s=a.get("objectId");s=s.replace("pid:",""),i.push(s)}}t._onSetPathTagsForProposedRealized(i,{options:{id:"caProposedChanges"}})})),setTimeout((function(){var e=document.querySelector(".main-proposed-change-container");e&&j.makeDroppable(e)}),1e3)},injectSubView:function(e,t){var i=this.containerReference.getElement(t);e&&i&&i.grab(e.render().getContent())},getTemplate:function(e){var t=d.compile(e);this.data={changes:j.proposedModel};return function(){return t()}},_initHeaderView:function(e){var i=this.proposedHeaderView=new(t._createView_TestHeader("div","operations-header",!1,j.proposedModel,W,this.model)),n=this,o=this._actionsEvents={removeMultiSel:function(e){j.removeSelectedProposed(e)},exploreInContext:function(e){var t=[];e.forEach((function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))})),N.DispatchEventToWin("MultiSelMenu_ExploreInContext_New",t)},exploreInRFLP:function(e){var t=[];e.forEach((function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))})),N.DispatchEventToWin("ExploreInRFLP",t)},exploreInPPR:function(e){var t=[];e.forEach((function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))})),N.DispatchEventToWin("ExploreInPPR",t)},exploreInMsb:function(e){var t=[];e.forEach((function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))})),N.DispatchEventToWin("ExploreInMSB",t)},exploreInParents:function(e){var t=[];e.forEach((function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))})),N.DispatchEventToWin("ExploreParents",t)},open:function(e){var t=[];e.forEach((function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))})),N.DispatchEventToWin("Open",t)},exploreInCollabNApproval:function(e){var t=[];e.forEach((function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))})),N.DispatchEventToWin("ExploreInCollabNApproval",t)},openAdv:function(e){var t=[];e.forEach((function(e,i){UWA.is(e.get("objectId"))&&t.push(e.get("objectId").replace("pid:",""))})),N.DispatchEventToWin("OpenAdv",t)},massUpdateMultiSel:function(e){var t=[],i=null;Array.isArray(e)?i=e:e.selectedObjs&&Array.isArray(e.selectedObjs)&&(i=e.selectedObjs),i.forEach((function(e){"Create"==e.get("operationActual")||"Flowdown"==e.get("operationActual")?S.warn(s.ECM_CA_Proposed_Operation_Create_Massupdate_Forbid):e.get("Access")?e.id?t.push(e.id):e.get("id")&&t.push(e.get("id")):S.warn(s.ECM_CA_Proposed_Operation_NoAccess_Massupdate_Forbid)})),t.length>0&&j.massUpdateMultiSelectedOperations(t)},changematurityMultiSel:function(e){_.changeMaturity(e,this.model,this.massPromoteProposedCallBack)},emptySelectedModels:function(){j.emptySelectedModels()},onActionClick:function(e,t,i,o){var a=i.model.get("id");switch(a){case"sort":var s=document.getElementsByClassName("tooltip")[0];s&&s.destroy(),W="asc"==W?"desc":"asc",j.sortProposed();break;case"search":j.searchProposed(n);break;case"add":j.addProposed();break;case"define":o.stopPropagation(),j.buildDropdownForAddProposed(i);break;case"selectAll":j.selectAll();break;case"unSelectAll":j.unselectAll();break;case"filterOperationView":o.stopPropagation(),j.makeOperationFilter(i);break;case"switchView":j.makeSwitchViewMenu(i);break;default:console.log(a+" is not permitted.")}},updateStatusFromMultiSel:function(e){var t,i=[],n=[];e.selectedIDs&&e.selectedIDs.length>0&&(t=j.updateStatusForNormalProposed(e)),i.push(t),Promise.all(i).then((function(e){e.forEach((function(e){if(e&&e.totalProposed){var t=e.totalProposed,i=O.getCachedFlowdownData();UWA.is(i)&&(t=t.concat(i)),t=j._mappedFlowdownInfo(t);for(var o=[],a=0,s=0;s<t.length;s++)-1==n.indexOf(t[s].where.id)&&(o.push(t[s]),j.itemsToSort[a++]=t[s].id);var r=D.createProposedCollection(o);j.ChangeView.stopListening(j.originalProposedCollection),j.originalProposedCollection=null,j.originalProposedCollection=r,E.enrichCollection(r,"objectId",!0).then((function(e){j.setProposedCollection(r)}))}}))}))}};return this.listenTo(i,o),i},_initSearchFilterView:function(){var e=this.searchFilterView=new i({fromIDCard:!1,collection:j.proposedModel,placeholder:s.ECM_CA_Searchby_NameTitle}),t=this._operationsEvents={keyup:function(e){j.refineProposed(e)}};this.listenTo(e,t)},_initOperationView:function(){this.model.get("id"),this.model.get("synopsis");var e=this.operationView=j.createOperationView(this.model),t=this,i=this._operationsEvents={onCheckboxClick:function(e){j.operationSelected(e)},onItemViewDrag:function(){console.log("in drag of New Proposed");var e={};if(j.modelsToRemove.length)for(var i in j.modelsToRemove){var n=j.modelsToRemove[i];n&&(e[n.get("id")]=n)}else e[arguments[1].get("id")]=arguments[1];arguments[1]=e;var o=j.context,a=[];Array.isArray(o)&&o.forEach((function(e){var t=e.id;t&&a.push(t.substr(4))}));var s={caId:t.model.get("id"),caContextIds:a,typeOfDrag:"Proposed"};E.onItemViewDragForContents(arguments,s)},deleteActivity:function(e,t){var i=[e];j.removeSelectedActivities(i,t)},editActivity:function(e,t){var i={};i.model=new C({id:e.id,what:{operation:e.activityActual,"target state":e.activityTargetState},why:{comment:{text:UWA.String.unescapeHTML(e.activityDesc)}},objectId:e.objectId,operationId:e.operationId},{parse:!0}),i.model.set("operationIdx",t.operationIdx),i.callback=j.editActivityCallback;var n=new f(i),o=new m({invokedFrom:j.invokedFrom});o.buildSlideIn(n),o.showSlideIn()},editProposed:function(e,t,i){j.editSelectedProposed(t)},deleteProposed:function(e,t,i){j.removeSelectedProposed(t)},onHigherRevisionSelected:function(e){var t=e.objectsToAddArr,i=e.proposedToRemove.get("changeReason"),n=(e.proposedToRemove.get("status"),e.proposedToRemove.get("activities")),o=e.proposedToRemove;j.removeSelectedProposed([o],(function(){var e=new UWA.Class.Model,o={objectID:t[0].substr(4)};e.set("proposedObject",o),e.set("operationActual","None"),e.set("reasonForChange",i),e.set("activities",n),j.addProposedbySearch(e,(function(){u.endWait(widget.body)}))}))},OnUpdateProposedStatus:function(e){var t=[],i=j.currModel.get("id"),n="";null!=i&&(n="/resources/modeler/change/changeaction/"+i+"?proposed=1"),""!=n&&b.makeWSCall(n,"PUT","enovia","application/json",JSON.stringify(e),(function(e){var i=e.changeaction.proposed,n=O.getCachedFlowdownData();UWA.is(n)&&(i=i.concat(n)),i=j._mappedFlowdownInfo(i);for(var o=[],a=0,s=0;s<i.length;s++)-1==t.indexOf(i[s].where.id)&&(o.push(i[s]),j.itemsToSort[a++]=i[s].id);var r=D.createProposedCollection(o);j.ChangeView.stopListening(j.originalProposedCollection),j.originalProposedCollection=null,j.originalProposedCollection=r,E.enrichCollection(r,"objectId",!0).then((function(e){j.setProposedCollection(r)}))}),null)},OnAddResolutionItem:function(e){var t=[],i=j.currModel.get("id"),n="";null!=i&&(n="/resources/modeler/change/changeaction/"+i+"?proposed=1"),""!=n&&b.makeWSCall(n,"PUT","enovia","application/json",JSON.stringify(e),(function(e){var i=e.changeaction.proposed,n=O.getCachedFlowdownData();UWA.is(n)&&(i=i.concat(n)),i=j._mappedFlowdownInfo(i);for(var o=[],a=0,s=0;s<i.length;s++)-1==t.indexOf(i[s].where.id)&&(o.push(i[s]),j.itemsToSort[a++]=i[s].id);var r=D.createProposedCollection(o);j.ChangeView.stopListening(j.originalProposedCollection),j.originalProposedCollection=null,j.originalProposedCollection=r,E.enrichCollection(r,"objectId",!0).then((function(e){j.setProposedCollection(r)}))}),null)}};return this.listenTo(e,i),e},domEvents:{},destroy:function(){j.modelsToRemove.splice(0,j.modelsToRemove.length),j.selectedOperationItems.splice(0,j.selectedOperationItems.length),this.stopListening(this.model),this.model=null}})},updateProposedCollection:function(e){let t=e.id;if(null==t)return;var i=y.getGlobalVariable();let n=!1;n=!(!i.isNative||1!=i.Enable_TileView_Native)||widget.getPreference("tileViewPreference").value,!0===n&&O.getDataForProposedFacet(t).then((function(e){if(UWA.is(e)&&UWA.is(e.proposedData)){Array.isArray(e.context)&&e.context.length>0&&(j.context=e.context);let t=D.createProposedCollection(e.proposedData);E.enrichCollection(t,"objectId",!0).then((function(e){e.forEach((function(e){"Flowdown"===e.get("operationActual")&&D.cacheFlowdownModelData(e)})),j.setProposedCollection(e)}))}}))},getProposedCollection:function(){return this.proposedCollection},setProposedCollection:function(e,t){this.proposedCollection=e,1!=t&&c.publish("ca-proposed-collection-updated"+widget.id,{})},createOperationView:function(e){return 0===j.proposedModel.length?new o({icon:"drag-drop",title:s.ECM_CA_Drop_EmptyView}):new(n._createView_TestProposed("div","operations-details",!1,j.proposedModel,e))},getSortedItems:function(e){for(var t=[],i=Object.keys(j.itemsToSort),n=0;n<i.length;n++)for(var o=j.itemsToSort[i[n]],a=0;a<e.length;a++)if(e[a].id===o){t.push(e[a]);break}return t},operationSelected:function(e){var i=j.selectedOperationItems.indexOf(e.cid);if(-1===i?(j.selectedOperationItems.push(e.cid),j.modelsToRemove.push(e)):(j.selectedOperationItems.splice(i,1),j.modelsToRemove.splice(i,1),0===j.modelsToRemove.length&&n.deactivateMultisel()),t.multiSelView){var o={isActive:!0};o.selectedObjects=j.modelsToRemove;t.multiSelView.buildMultisel(o);let e=j.currModel.id.slice(4),i=[];for(let e=0;e<o.selectedObjects.length;e++){let t=o.selectedObjects[e],n={id:t._attributes.objectId.slice(4),type:t._attributes.objectType},a=new T({grid:n});i.push(a)}if(0==o.selectedObjects.length){let e=new T({});i.push(e)}(new x).addRoot(i),0!=o.selectedObjects.length&&i[0].getTreeDocument().selectAll(),I.getDependency("applicationChannel").publish({event:"update-property-panel-data",data:{context:i[0],PhysicalID:e,type:"ChangeAction",load:!0}})}},editActivityCallback:function(e){u.doWait(widget.body);var t=n.getJSONForModifyProposed(),i="";"Modify"==e.get("activityActual")?i={id:e.get("id"),what:{operation:"Modify"},why:{comment:{text:e.get("reasonForChange")}}}:"Release"==e.get("activityActual")?i={id:e.get("id"),what:{operation:"ChangeStatus","target state":"Release"},why:{comment:{text:e.get("reasonForChange")}}}:"Obsolete"==e.get("activityActual")?i={id:e.get("id"),what:{operation:"ChangeStatus","target state":"Obsolete"},why:{comment:{text:e.get("reasonForChange")}}}:"Restore"==e.get("activityActual")&&(i={id:e.get("id"),what:{operation:"ChangeStatus","target state":"Restore"},why:{comment:{text:e.get("reasonForChange")}}});t.changeaction.modify.proposed.push(i);var o=j.currModel.get("id"),a="";null!=o&&(a="/resources/modeler/change/changeaction/"+o+"?proposed=1"),""!=a&&b.makeWSCall(a,"PUT","enovia","application/json",JSON.stringify(t),(function(t){var i=t.changeaction.proposed,o=O.getCachedFlowdownData();UWA.is(o)&&(i=i.concat(o)),i=j._mappedFlowdownInfo(i);var a=D.createProposedCollection(i);j.ChangeView.stopListening(j.originalProposedCollection),j.originalProposedCollection=null,j.originalProposedCollection=a,E.enrichCollection(a,"objectId",!0).then((function(t){setTimeout((function(){j.setProposedCollection(a),n.changeAccordIconAndExpandTile(e.get("operationIdx"))}),100)}))}),null)},removeSelectedActivities:function(e,t){u.doWait(widget.body);var i=[];e.forEach((function(e){e.id?i.push(e.id):e.get("id")&&i.push(e.get("id"))}));var o=j.getJSONForDeleteOperation(i),a="/resources/modeler/change/changeaction/"+j.currModel.get("id")+"?proposed=1";b.makeWSCall(a,"PUT","enovia","application/json",JSON.stringify(o),(function(e){var i=e.changeaction.proposed,o=O.getCachedFlowdownData();UWA.is(o)&&(i=i.concat(o)),i=j._mappedFlowdownInfo(i);var a=[];Object.keys(j.itemsToSort).length&&(a=j.getSortedItems(i)),a=a.length?a:i;var s=D.createProposedCollection(a);j.ChangeView.stopListening(j.originalProposedCollection),j.originalProposedCollection=null,j.originalProposedCollection=s,E.enrichCollection(s,"objectId",!0).then((function(e){j.setProposedCollection(s),n.changeAccordIconAndExpandTile(t.operationIdx)}))}),null)},editSelectedProposed:function(e){var t={};t.model=e[0],t.callback=j.editProposedCallback;var i=new g(t),n=new m({invokedFrom:j.invokedFrom});n.buildSlideIn(i),n.showSlideIn()},editProposedCallback:function(e){u.doWait(widget.body);var t=e.id,i=j.currModel.get("id"),o="";i&&(o="/resources/modeler/change/changeaction/"+i+"?proposed=1");var a={};if(e.get("isCreateOperation"))a.pid=e.id,a.operation="Create",a.objectType=e.get("createObjectType"),a.objectName=e.get("createObjectTitle"),a.operationWHY=e.get("reasonForChange");else{var s=[];s.push(e.id),a.proposedIDArr=s,a.operation=e.get("operationActual"),a.evolutionName=e.get("evolutionName"),a.operationWHY=e.get("reasonForChange"),a.status=e.get("status")}var r=n.getJSONForModifyOperation(a);""!=o&&b.makeWSCall(o,"PUT","enovia","application/json",JSON.stringify(r),(function(e){console.log(t);var i=e.changeaction.proposed,n=O.getCachedFlowdownData();UWA.is(n)&&(i=i.concat(n)),i=j._mappedFlowdownInfo(i);var o=[];Object.keys(j.itemsToSort).length&&(o=j.getSortedItems(i)),o=o.length?o:i;var a=D.createProposedCollection(o);j.ChangeView.stopListening(j.originalProposedCollection),j.originalProposedCollection=null,j.originalProposedCollection=a,E.enrichCollection(a,"objectId",!0).then((function(e){j.setProposedCollection(a);var i=0;for(i=0;i<o.length&&o[i].id!=t;i++);setTimeout((function(){document.getElementById(i).click()}),700)}))}),null)},removeSelectedProposed:function(e,t){u.doWait(widget.body);var i=[];Array.isArray(e)?i=e:e.selectedObjs&&Array.isArray(e.selectedObjs)&&(i=e.selectedObjs);var n=[];Array.isArray(i)&&i.forEach((function(e){n.push(e.get("id"))}));var o=j.getJSONForDeleteOperation(n),a="/resources/modeler/change/changeaction/"+j.currModel.get("id")+"?proposed=1";b.makeWSCall(a,"PUT","enovia","application/json",JSON.stringify(o),(function(e){var n=e.changeaction.proposed,o=O.getCachedFlowdownData();UWA.is(o)&&(n=n.concat(o)),n=j._mappedFlowdownInfo(n);var a=[];Object.keys(j.itemsToSort).length&&(a=j.getSortedItems(n)),a=a.length?a:n;var s=D.createProposedCollection(a);j.ChangeView.stopListening(j.originalProposedCollection),j.originalProposedCollection=null,j.originalProposedCollection=s,E.enrichCollection(s,"objectId",!0).then((function(e){j.setProposedCollection(s)}));for(var r=0;r<i.length;r++){var l=j.modelsToRemove.indexOf(i[r]);l>=0&&(j.modelsToRemove.splice(l,1),r--)}t&&t(),u.endWait(widget.body)}),null)},getJSONForAddOperation:function(e){var t=j.getJSONForAddProposed(),i=e.operation,n=e.operationWHY;if("Create"==i){var o={operation:{name:i,type:e.objectType,"display name":e.objectName},why:{comment:{text:n}},activities:[]};t.changeaction.add.proposed.push(o)}else for(var a=e.proposedIDArr,s=0;s<a.length;s++){o={where:{id:a[s]},operation:{name:i},why:{comment:{text:n}},activities:[]};"NewEvolution"==i&&(o.operation["evolution name"]=e.evolutionName),t.changeaction.add.proposed.push(o)}return t},getJSONForAddProposed:function(){var e=j.getCABaseJSONForOperations();return e.changeaction.add={proposed:[]},e},getJSONForDeleteOperation:function(e){var t=j.getJSONForDeleteProposed();return t.changeaction.delete.proposed=e,t},getJSONForDeleteProposed:function(){var e=j.getCABaseJSONForOperations();return e.changeaction.delete={proposed:[]},e},getCABaseJSONForOperations:function(){return JSON.parse(JSON.stringify({version:"v0",changeaction:{cestamp:"0000",add:{},delete:{},modify:{}}}))},sortDropDown:function(e){var t="";t="asc"==W?"sort-alpha-desc":"sort-alpha-asc";var i=[{text:s.ECM_CA_Abstract,fonticon:t,handler:function(e){j.sortProposed(W),W="asc"==W?"desc":"asc",e.stopPropagation()}}],n=e.container;null!=this.dropDown&&this.dropDown.destroy(),this.dropDown=new A({target:n,items:i}),this.dropDown.show()},buildDropdownForAddProposed:function(e){if(j.isUpstreamFlowdownDependencyAvailable()){var t=[{id:"addproposed",text:s.ECM_CA_Add_ProposedChanges,multisel:!0,handler:function(e){j.defineProposed()}}];E._initDropDown(t,e.container)}else j.defineProposed()},sortProposed:function(e){var t=new UWA.Class.Collection,i=null,n=!0;void 0===e||null==e?0!=(i=document.getElementsByClassName("fonticon fonticon-sort-alpha-asc")).length?n=!1:i=document.getElementsByClassName("fonticon fonticon-sort-alpha-desc"):(n="asc"==e,!(i=document.getElementsByClassName("fonticon fonticon-sort-alpha-asc")).length>0&&(i=document.getElementsByClassName("fonticon fonticon-sort-alpha-desc")));var o=[],a=[],s={};if(j.proposedModel.length>0){var r=[];j.proposedModel.sortBy((function(e,t,i){var n=e.get("objectTitle"),r=(n+e.get("revision")).toLowerCase();s[r]=n,a.push(r),a.sort(),i.length-1===t&&a.forEach((function(e){var t=s[e],i=null;i=j.proposedModel.where({objectTitle:t}),Array.isArray(i)&&i.forEach((function(t){t&&t.get("IdentifierWithRevision").toLowerCase()===e&&o.push(t)}))}))})),r=o,n||r.reverse();t=new UWA.Class.Collection(r);j.proposedModel=t;var l=j.ChangeView,c=l.containerReference.getElement(".changeView-opdetails-container");c.empty(),u.doWait(c),setTimeout((function(){l.operationView&&l.operationView.destroy();var e=l.operationView=l._initOperationView(t);e&&c&&c.grab(e.render().getContent()),u.endWait(c)}),100);var d=l.containerReference.getElement(".changeView-header-container");d.empty();var p=l.proposedHeaderView=l._initHeaderView(t);p&&d&&d.grab(p.render().getContent()),j.modelsToRemove.splice(0,j.modelsToRemove.length),j.selectedOperationItems.splice(0,j.selectedOperationItems.length),j.changeSortIcon(i,n)}},changeSortIcon:function(e,t){e.length>0&&(e[0].className=t?"fonticon fonticon-sort-alpha-asc":"fonticon fonticon-sort-alpha-desc")},searchProposed:function(e){document.getElementsByClassName("search-main-container");var t=e.containerReference.getElement(".search-main-container");if(t&&t.hasClassName("hidden")){t.removeClassName("hidden");var i=t.getElement(".searchfilter-input-container");i.addClassName("highlighted-border"),i.removeClassName("border-without-focus"),t.getElement("input").focus()}else t.addClassName("hidden");var n=t.hasClassName("hidden"),o=e.containerReference.getElement(".operations-main-container");n?o.setStyle("height","calc(100% - 50px)"):o.setStyle("height","calc(100% - 100px)")},selectAll:function(){if(n.activateMultisel(),n||n.container){var e=n.container.container;if(e)for(var t=e.getElements(".checkbox-accord"),i=0;i<t.length;i++){var o=t[i];o.checked||o.click()}}},unselectAll:function(){var e=n.container.container;if(e)for(var i=e.getElements(".checkbox-accord"),o=0;o<i.length;o++){var a=i[o];a.checked&&a.click()}t.multiSelView&&(t.multiSelView.exitMultisel(),t.multiSelView.dispatchEvent("onMultiselOff",[t.multiSelView,!1]))},defineProposed:function(){var e=new h,t={};t.model=e,t.callback=this.addProposedbySearch;var i=new g(t),n=new m({invokedFrom:j.invokedFrom});n.buildSlideIn(i),n.showSlideIn();var o=document.querySelector(".ds-search");o&&o.style.setProperty("padding","1px 0px 1px 0px","important")},addProposed:function(){if(y.getGlobalVariable().isNative){N.DispatchEventToWin("Add_Proposed","AddProposedChange")}else j.SearchObj=E.activateSearch(y.getGlobalVariable().proposedSearchType,"multiple_proposed"),E.search("multiple_proposed",y.getGlobalVariable().proposedSearchType,j.OnSearchComplete,"multiple_proposed",j.SearchObj)},addProposedbySearch:function(e,t){u.doWait(widget.body);var i=[],n=j.currModel.get("id"),o="",a={};n&&(o="/resources/modeler/change/changeaction/"+n+"?proposed=1"),e.get("isCreateOperation")?(a.operation="Create",a.objectType=e.get("createObjectType"),a.objectName=e.get("createObjectTitle"),a.operationWHY=e.get("reasonForChange")):(i.push("pid:"+e.get("proposedObject").objectID),a.proposedIDArr=i,a.operation=e.get("operationActual"),a.operationWHY=e.get("reasonForChange"),a.evolutionName=e.get("evolutionName"));var s=j.getJSONForAddOperation(a);if(t)e.get("activities").forEach((function(e){var t=e.get("activityActual"),i=e.get("activityDesc");if(UWA.is(t)&&"NoSelection"!=t){var n="";"Modify"==t?n={what:{operation:"Modify"},why:{comment:{text:i}}}:"Release"==t?n={what:{operation:"ChangeStatus","target state":"Release"},why:{comment:{text:i}}}:"Obsolete"==t&&(n={what:{operation:"ChangeStatus","target state":"Obsolete"},why:{comment:{text:i}}}),""!=n&&s.changeaction.add.proposed[0].activities.push(n)}}));else if(UWA.is(e.get("activityActual"))&&"NoSelection"!=e.get("activityActual")){var r="";"Modify"==e.get("activityActual")?r={what:{operation:"Modify"},why:{comment:{text:e.get("reasonForChangeForActivity")}}}:"Release"==e.get("activityActual")?r={what:{operation:"ChangeStatus","target state":"Release"},why:{comment:{text:e.get("reasonForChangeForActivity")}}}:"Obsolete"==e.get("activityActual")?r={what:{operation:"ChangeStatus","target state":"Obsolete"},why:{comment:{text:e.get("reasonForChangeForActivity")}}}:"Restore"==e.get("activityActual")&&(r={what:{operation:"ChangeStatus","target state":"Restore"},why:{comment:{text:e.get("reasonForChangeForActivity")}}}),s.changeaction.add.proposed[0].activities.push(r)}""!=o&&(console.log("Time to add Proposed changes::START "+(new Date).getTime()),b.makeWSCall(o,"PUT","enovia","application/json",JSON.stringify(s),(function(e){console.log("Time to add Proposed changes::END "+(new Date).getTime());var t=e.changeaction.proposed,n=O.getCachedFlowdownData();UWA.is(n)&&(t=t.concat(n)),t=j._mappedFlowdownInfo(t);for(var o=[],a=0,s=0;s<t.length;s++)-1!=i.indexOf(t[s].where.id)&&(o.push(t[s]),j.itemsToSort[a++]=t[s].id);for(s=0;s<t.length;s++)-1==i.indexOf(t[s].where.id)&&(o.push(t[s]),j.itemsToSort[a++]=t[s].id);var r=D.createProposedCollection(o);j.ChangeView.stopListening(j.originalProposedCollection),j.originalProposedCollection=null,j.originalProposedCollection=r,E.enrichCollection(r,"objectId",!0).then((function(e){j.setProposedCollection(r)}))}),(function(){u.endWait(widget.body)})))},refineProposed:function(e){var t=e.target.value;j.enteredText=t,j.filterProposed(),void 0===t||0===t.length?(R._activate(),c.publish(`caProposedChanges:${widget.id}`,{})):R._deactivate()},filterProposed:function(){var e;j.bComingFromSearchFilter=!0,e=j.originalProposedCollection.filter(j.filterNameBased);var t=j.ChangeView,i=new UWA.Class.Collection(e);j.proposedCollection=j.proposedModel=i;var n=t.containerReference.getElement(".changeView-opdetails-container");n.empty(),u.doWait(n);var o=t.operationView=t._initOperationView(i);setTimeout((function(){o&&n&&n.grab(o.render().getContent()),u.endWait(n)}),100);var a=t.containerReference.getElement(".changeView-header-container");a.empty();var s=t.proposedHeaderView=t._initHeaderView(i);s&&a&&a.grab(s.render().getContent()),j.modelsToRemove.splice(0,j.modelsToRemove.length),j.selectedOperationItems.splice(0,j.selectedOperationItems.length)},filterNameBased:function(e){var t=!1,i=e.get("objectName"),n=e.get("objectTitle"),o=j.enteredText;if(o&&o.length){i&&(i=i.toLowerCase()),n&&(n=n.toLowerCase()),o=o.toLowerCase();var a=i?i.indexOf(o):-1;a<0&&(a=i?n.indexOf(o):-1),t=a>=0}if(void 0!==o&&0!==o.length||(t=!0),1==t)return e},makeDroppable:function(e){a.droppable(e,{drop:function(e,t,i){if(i.stopPropagation&&i.stopPropagation(),i.preventDefault&&i.preventDefault(),i.dataTransfer&&i.dataTransfer.dropEffect&&(i.dataTransfer.dropEffect="copy"),UWA.is(e)&&""!=e){var n=JSON.parse(e),o=E.checkTenantInforamation(n);if(0!=o.TenantInfoMissing.length)S.error(s.ECM_CA_Pref_PlatformMissing_Error);else if(0!=o.DiffTenantData.length)S.error(s.ECM_CA_Pref_PlatformDoesNotMatch_Error);else{(n=E.removeDuplicatesToBeDroppedObjects(n)).data.items.length>1&&(n=j.excludeAlreadyConnectedProposed(n));var a=E.filterBasedOnServiceId(n);if(a.incorrectServiceInfo&&Array.isArray(a.incorrectServiceInfo)&&a.incorrectServiceInfo.length>0){var r=s.ECM_WARN_DROP_SKIPPED+"<br/>";for(var l in a.incorrectServiceInfo)r+=a.incorrectServiceInfo[l]+"<br/>";S.warn(r,"false")}j.ExecuteDrop(n)}}else u.endWait(widget.body),S.error(s.ECM_CA_Drop_Not_Supported);document.querySelector(".main-proposed-change-container").setStyle("borderWidth","0px")},over:function(){arguments[0].setStyles({borderStyle:"solid",borderColor:"blue",borderWidth:"1px"})},leave:function(){arguments[0].setStyle("borderWidth","0px")}})},excludeAlreadyConnectedProposed:function(e){var t=!1;if(e&&e.data&&e.data.items&&j&&j.originalProposedCollection&&j.originalProposedCollection.proposedArr)for(var i=0;i<j.originalProposedCollection.proposedArr.length;i++)if(j.originalProposedCollection.proposedArr[i].where.id)for(var n=0;n<e.data.items.length;n++)e.data.items[n].objectId==j.originalProposedCollection.proposedArr[i].where.id.replace("pid:","")&&(e.data.items.splice(n,1),n-=1,t=!0);return t&&S.warn(s.ECM_CA_Proposed_Already_Added),e},ExecuteDrop:function(e){if(e){var t=e.data.items;if(UWA.is(t)&&UWA.is(t.length)&&t.length>0){for(var i=[],n=0;n<t.length;n++){var o="pid:"+t[n].objectId;i.push(o)}0!=i.length&&j.addProposedbyDrop(i)}}else u.endWait(widget.body),S.error(s.ECM_CA_Drop_Not_Supported);document.querySelector(".main-proposed-change-container").setStyle("borderWidth","0px")},addProposedbyDrop:function(e){u.doWait(widget.body);y.getGlobalVariable().IDCard.model.id;var t=j.getJSONForAddProposed();e.forEach((function(e){var i={where:{id:e},operation:{name:"Default"}};t.changeaction.add.proposed.push(i)}));var i=j.currModel.get("id"),n="";i&&(n="/resources/modeler/change/changeaction/"+i+"?proposed=1"),""!=n?(console.log("Time to add Proposed changes::START "+(new Date).getTime()),b.makeWSCall(n,"PUT","enovia","application/json",JSON.stringify(t),(function(t){console.log("Time to add Proposed changes::END "+(new Date).getTime());var i=t.changeaction.proposed,n=O.getCachedFlowdownData();UWA.is(n)&&(i=i.concat(n)),i=j._mappedFlowdownInfo(i);for(var o=[],a=0;a<i.length;a++)-1!=e.indexOf(i[a].where.id)&&o.push(i[a]);for(a=0;a<i.length;a++)-1==e.indexOf(i[a].where.id)&&o.push(i[a]);var s=D.createProposedCollection(o);j.ChangeView.stopListening(j.originalProposedCollection),j.originalProposedCollection=null,j.originalProposedCollection=s,E.enrichCollection(s,"objectId",!0).then((function(e){j.setProposedCollection(s)}))}),(function(){}))):u.endWait(widget.body)},filterProposedCollection:function(){var e=j.filteredObjectIds,t=j.filteredActivities,i=[];if(this.originalProposedCollection.toArray().forEach((function(n){var o=!1;if(e&&e.indexOf(n.get("objectId"))>=0||null==e){var a=n.get("operationActual");(t&&(t.indexOf(a)>=0||0==t.length)||null==t)&&(o=!0)}n&&o&&i.push(n)})),i&&i.length){var n=new UWA.Class.Collection(i);if(j.filteredbyTaggerCollection=j.proposedModel=n,j.ChangeView){var o=j.ChangeView,a=o.containerReference.getElement(".changeView-opdetails-container");a&&a.empty(),u.doWait(a),setTimeout((function(){var e=o.operationView=o._initOperationView(n);e&&a&&(a.grab(e.render().getContent()),u.endWait(a))}),100);var s=o.containerReference.getElement(".changeView-header-container");s&&s.empty(),j.selectedOperationItems.splice(0,j.selectedOperationItems.length),j.modelsToRemove.splice(0,j.modelsToRemove.length);var r=o.proposedHeaderView=o._initHeaderView(n);r&&s&&s.grab(r.render().getContent())}}},massUpdateMultiSelectedOperations:function(e){var t=new h,i={};i.model=t,i.callback=this.massUpdateProposedCallback,i.selectedOperation=e;var n=new g(i),o=new m({invokedFrom:j.invokedFrom});o.buildSlideIn(n),o.showSlideIn()},emptySelectedModels:function(){j.modelsToRemove.splice(0,j.modelsToRemove.length),j.selectedOperationItems.splice(0,j.selectedOperationItems.length)},massUpdateProposedCallback:function(e,t){u.doWait(widget.body),j.emptySelectedModels(),j.unselectAll();var i=j.currModel.get("id"),o="";i&&(o="/resources/modeler/change/changeaction/"+i+"?proposed=1");var a={};a.proposedIDArr=t,a.operation=e.get("operationActual"),a.operationWHY=e.get("reasonForChange"),a.evolutionName=e.get("evolutionName"),a.activityActual=e.get("activityActual"),a.reasonForChangeForActivity=e.get("reasonForChangeForActivity");var s=n.getJSONForModifyOperation(a);""!=o&&b.makeWSCall(o,"PUT","enovia","application/json",JSON.stringify(s),(function(e){var t=[],i=e.changeaction.proposed,n=O.getCachedFlowdownData();UWA.is(n)&&(i=i.concat(n)),i=j._mappedFlowdownInfo(i),Object.keys(j.itemsToSort).length&&(t=j.getSortedItems(i)),t=t.length?t:i;var o=D.createProposedCollection(t);j.ChangeView.stopListening(j.originalProposedCollection),j.originalProposedCollection=null,j.originalProposedCollection=o,E.enrichCollection(o,"objectId",!0).then((function(e){j.setProposedCollection(o)}))}),null)},calledFromNativeInterop:function(e){var i={isActive:!0};e.refPid=[e.refPid],i.selectedObjects={selectedObjs:j.operationsToExplore,result:e,length:j.operationsToExplore.length},t.selectionStateFromNative=i,t.multiSelView.buildMultisel(i)},OnSearchComplete:function(e){if(y.getGlobalVariable().isNative){for(var t=e.split("~"),i=[],n=0;n<t.length;n++)i.push(t[n]);for(var o=[],a=0;a<t.length;a++)o.push(i[a].split(","));var s=[];for(n=0;n<o.length;n++){var r=o[n];s.push("pid:"+r[0])}j.addProposedbyDrop(s)}else{for(s=[],n=0;n<e.length;n++){r=e[n];s.push("pid:"+r[0])}j.addProposedbyDrop(s)}},massPromoteProposedCallBack:function(){console.log("massPromoteProposedCallBack")},_mappedFlowdownInfo:function(e){var t=e,i=O.mapping,n=t.map((function(e,t){return{idx:t,proposedId:e.id}})),o=[],a=Object.keys(i);for(var s in a){var r=i[a[s]];if(r&&r.resolution){for(var l in r.resolution){var c=r.resolution[l];if(c&&c.proposedId)for(var d in n){var p=n[d];if(p&&p.proposedId===c.proposedId){o.push(c);var u=t[p.idx];if(u){u.flowdownInfo||(u.flowdownInfo={flowdownFor:[],flowdownFrom:[]});var h={where:{id:c.objectData.id,info:{"display name":c.objectData.info["display name"],type:c.objectData.info.type,typeNLS:c.objectData.info.current}}};u.flowdownInfo.flowdownFor.push(h.where);var m={caID:r.caID,caTitle:r.caTitle,caName:r.caName};u.flowdownInfo.flowdownFrom.push(m)}}}}r.resolution=o}}return t},updateStatusForNormalProposed:function(e){return new Promise((function(t,i){var o=n.getJSONForUpdateStatus(e),a=j.currModel.get("id"),s="";null!=a&&(s="/resources/modeler/change/changeaction/"+a+"?proposed=1"),""!=s&&b.makeWSCall(s,"PUT","enovia","application/json",JSON.stringify(o),(function(e){var i=e.changeaction.proposed;t({totalProposed:i})}),null)}))},isUpstreamFlowdownDependencyAvailable:function(){var e=!1,t=M.changeActionDependencyModel;if(t){var i=t.get("upstreamDependencyObjects");if(i&&i.dependencyLinks&&Array.isArray(i.dependencyLinks)){i.dependencyLinks.forEach((function(t,i){"Flowdown"===t.dependencyValueType&&(e=!0)}))}}return e},getFilterValuesByOperation:function(){for(var e=this.getProposedCollection(),t=new Map,i=0;i<e.length;i++){var n=e.at(i);n&&t.set(n.get("operationActual"),{actDisplayName:n.get("operationDisplay")})}return t},makeOperationFilter:function(e){var t=[];j.getFilterValuesByOperation().forEach((function(e,i){t.push({name:i,text:e.actDisplayName,selected:null!=j.filteredActivities&&j.filteredActivities.includes(i),selectable:!0})})),j.filterOperationViewMenu&&j.filterOperationViewMenu.destroy(),j.filterOperationViewMenu=new A({target:e.container,multiSelect:!0,closeOnClick:!0,items:t,events:{onClick:function(e,t){var i=j.filterOperationViewMenu.getSelectedItems(),n=[];i.forEach((function(e,t){n.push(e.name)})),j.filteredActivities=n,j.filterProposedCollection()}}}),j.filterOperationViewMenu.show()},makeSwitchViewMenu:function(e){j.switchViewMenu&&j.switchViewMenu.destroy(),j.switchViewMenu=new A({target:e.container,multiSelect:!1,closeOnClick:!0,items:[{name:"LTV",text:s.ECM_CA_LTV,fonticon:"view-big-tile",selected:!0,selectable:!0},{name:"DGV",text:s.ECM_CA_DGV,fonticon:"view-list",selected:!1,selectable:!0}],events:{onClick:function(e,t){switch(j.switchViewMenu.getSelectedItems()[0].name){case"LTV":break;case"DGV":c.publish("ECM_GOV_ProposedDGV_ON:"+widget.id,j.options_copy)}}}}),j.switchViewMenu.show()}};return j})),define("DS/ENOChangeActionUX/scripts/CANativeInterop",["DS/ENOChangeActionUX/scripts/Views/OperationForm","DS/ENOChangeActionUX/scripts/Views/CANewProposedView","DS/ENOChangeActionUX/scripts/Views/CANewRealizedView","DS/ENOChangeActionUX/scripts/Controller/CADependencyGridController","DS/ENOChangeActionUX/scripts/Views/CARealizedOperationView","DS/ENOChangeActionUX/scripts/Views/CAProposedOperationView","DS/ENOChangeActionUX/scripts/Views/CARealizedActivitiesView","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices","DS/ENOChangeActionUX/scripts/Services/CADependenciesViewServices","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices","DS/WebappsUtils/WebappsUtils","DS/ENOChgGovernanceUX/scripts/view/facets/issue/ChgIssueDataGridLayout","DS/ENOChgGovernanceUX/scripts/view/changeAction/facets/context/ChgCAcontextDataGridLayout","DS/ENOChgGovernanceUX/scripts/components/attachmentView/ChgAttachmentView","DS/ENOChgGovernanceUX/scripts/view/changeAction/facets/approvals/ChgCAApprovalsView","DS/ENOChgServices/scripts/services/UserPreferenceUtil","DS/ENOChgServices/scripts/services/DefaultPreferencesManager","require","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/PlatformAPI/PlatformAPI","DS/ENOChangeActionUX/scripts/CASpinner","DS/ENOChgGovernanceUX/scripts/components/addMemberPanel/ChgAddMembersForm","DS/ENOChgServices/scripts/services/ChgRealizedServices"],(function(e,t,i,n,o,a,s,r,l,c,d,p,u,h,m,g,f,C,v,A,w,y,b,S,E,_){"use strict";var D={CurrModel:null,issueDGV:m,ContextMenu:{},CrossHighlighting_Native:function(e,t){b.publish("CrossHighlighting:"+widget.id,e),b.publish("CrossHighlighting:proposed"+widget.id,e)},setTileViewPreference:function(e,t){var i=r.getGlobalVariable();"TRUE"===e.toUpperCase()&&(i.Enable_TileView_Native=!0)},Refresh_Native:function(){var e=r.getGlobalVariable().IDCard.model;S.doWait(widget.body);var t={id:e.id};b.publish("ca-IDCard-on-change-refresh",t)},OnSearchComplete:function(o,s){var c="";let d;switch(s){case"ProposedChange":d=v.getUserPreference(A.keys.viewKeys.PROPOSED_DEF_VIEW),UWA.is(d)&&"DGV"===d?b.publish("ECM_GOV_Proposed_Search_Native:"+(widget?widget.id:""),o):c=new e;break;case"AddProposedChange":d=v.getUserPreference(A.keys.viewKeys.PROPOSED_DEF_VIEW),UWA.is(d)&&"DGV"===d?b.publish("ECM_GOV_Proposed_Add_Native:"+(widget?widget.id:""),o):c=t;break;case"AddResolutionItem":d=v.getUserPreference(A.keys.viewKeys.PROPOSED_DEF_VIEW),UWA.is(d)&&"DGV"===d?b.publish("ECM_GOV_ProposedDGV_SearchResolution_Native:"+(widget?widget.id:""),o):c=a;break;case"Add_Dependency":c=n;break;case"SearchCA":c=i;break;case"Add_Flowdown_Dependency":c=p;break;case"SearchFlowdownProposed":b.publish("FDDGV_ADD_PROPOSED_WITH_SEARCH_COMPLETE:"+(widget?widget.id:""),o);break;case"CHG_Add_Member":c=E;break;case"CHG_Add_Attachment":c=f;break;case"CHG_Add_Existing_Issue":c=D.issueDGV;break;case"CHG_Add_Context":c=g;break;case"CHG_Search_Task_Assignee":c=C}if(""==c||!c.prototype||"Add_Member"==s&&"true"==r.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT)if(""!=c&&"Add_Member"===s&&"true"==r.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT){var u=l.getLabelManagerView(this.addMemberBody);u&&u.OnSearchComplete(o)}else""!=c&&c.OnSearchComplete(o);else c.prototype.OnSearchComplete(o)},OnCAStateChange:function(){var e=r.getGlobalVariable().IDCard.model,t=[];t.push(e),d.changeMaturityExecute(t,e)},drop_Native:function(e){if(UWA.is(e)&&UWA.is(e.where))var i="";if("Proposed"===e.where)i=t;""!=i&&i.ExecuteDrop(e)},GetMultiselContextMenu:function(e){if(UWA.is(e)&&""!=e&&UWA.is(e.MultiselectOwnerComp))if("RealizedActivity_CmdChk"==e.MultiselectOwnerComp)s.calledFromNativeInterop(e);else if("RealizedOperation_CmdChk"==e.MultiselectOwnerComp)i.calledFromNativeInterop(e);else if("ProposedOperation_CmdChk"==e.MultiselectOwnerComp)t.calledFromNativeInterop(e);else if("RealizedFlowdownActivity_CmdChk"==e.MultiselectOwnerComp){u.getflowdownActivityPointer().calledFromNativeInterop(e)}else if("RealizedFlowdownOperation_CmdChk"==e.MultiselectOwnerComp){u.getflowdownOperationPointer().calledFromNativeInterop(e)}},GetContextMenu:function(e){if(UWA.is(e)&&UWA.is(e.where))var t="";switch(e.where){case"Proposed":case"Resolution":case"FlowdownFrom":case"FlowdownFor":t=a;break;case"Realized":t=o;break;case"Attachment":t=f}if(""!=t){D.ContextMenu.pid=e.pid;var i=[];UWA.is(D.ContextMenu.explore)||(D.ContextMenu.explore={accelerator:"Ctrl+E",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmSendToNewVPMCmdRoot",icon:"I_SendToVPMNavigator",multisel:!0,text:y.ECM_CA_Command_Explore,handler:function(e){c.DispatchEventToWin("Explore",D.ContextMenu.pid)}},"Referential"==e.where&&"true"!=r.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(D.ContextMenu.explore.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToVPMNavigator.png"))),UWA.is(D.ContextMenu.exploreInPPR)||(D.ContextMenu.exploreInPPR={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInPPR",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:y.ECM_CA_Command_ExploreMfg,handler:function(e){c.DispatchEventToWin("ExploreInPPR",D.ContextMenu.pid)}},"Referential"==e.where&&"true"!=r.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(D.ContextMenu.exploreInPPR.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToPPRNavigatorWithParent.png"))),UWA.is(D.ContextMenu.exploreInMSB)||(D.ContextMenu.exploreInMSB={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInMSB",icon:"I_SendToPPRNavigatorWithParent",multisel:!0,text:y.ECM_CA_Command_ExploreMSB,handler:function(e){o&&o.itemView&&o.itemView.Instanceid?c.DispatchEventToWin("ExploreInMSB",o.itemView.Instanceid):c.DispatchEventToWin("ExploreInMSB",D.ContextMenu.pid)}},"Referential"==e.where&&"true"!=r.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(D.ContextMenu.exploreInMSB.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToPPRNavigatorWithParent.png"))),UWA.is(D.ContextMenu.exploreInRFLP)||(D.ContextMenu.exploreInRFLP={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmMultiDagExploreInCmd",icon:"I_ExploreInRFLPNavigator",multisel:!0,text:y.ECM_CA_Command_ExploreSys,handler:function(e){c.DispatchEventToWin("ExploreInRFLP",D.ContextMenu.pid)}},"Referential"==e.where&&"true"!=r.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(D.ContextMenu.exploreInRFLP.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_ExploreInRFLPNavigator.png")));var n=!1;"true"===r.getGlobalVariable().ECM_EnableExploreInCollabNApprovalForNative&&(n=!0),n&&(UWA.is(D.ContextMenu.exploreInCentral)||(D.ContextMenu.exploreInCentral={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ExploreInCentral",icon:"I_ExploreInCentral_normal",multisel:!0,text:y.ECM_CA_Command_Explore3DSpace,handler:function(e){c.DispatchEventToWin("ExploreInCollabNApproval",D.ContextMenu.pid)}},"Referential"==e.where&&"true"!=r.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(D.ContextMenu.exploreInCentral.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_ExploreInCentral_normal.png")))),UWA.is(D.ContextMenu.exploreParents)||(D.ContextMenu.exploreParents={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreParentsHdr",icon:"I_GetParents",multisel:!0,text:y.ECM_CA_Command_ExploreParents,handler:function(e){c.DispatchEventToWin("ExploreParents",D.ContextMenu.pid)}},"Referential"==e.where&&"true"!=r.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(D.ContextMenu.exploreParents.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_GetParents.png"))),UWA.is(D.ContextMenu.exploreinContext)||(D.ContextMenu.exploreinContext={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"CATImmExploreInContextHdr",icon:"I_FindInContext",multisel:!0,text:y.ECM_CA_Command_ExploreContext,handler:function(e){o&&o.itemView&&o.itemView.Instanceid?c.DispatchEventToWin("ExploreinContext",o.itemView.Instanceid):c.DispatchEventToWin("ExploreinContext",D.ContextMenu.pid)}},"Referential"==e.where&&"true"!=r.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(D.ContextMenu.exploreinContext.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_FindInContext.png"))),UWA.is(D.ContextMenu.Open)||(D.ContextMenu.Open={accelerator:"Ctrl+O",availabilityMode:"Normal=YES CommandSet=YES Editability=YES SmallScale=YES LargeScale=YES ",id:"OpenFromCA",icon:"I_OpenDB",multisel:!0,text:y.ECM_CA_Command_Open,handler:function(e){c.DispatchEventToWin("Open",D.ContextMenu.pid)}},"Referential"==e.where&&"true"!=r.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(D.ContextMenu.Open.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenDB.png"))),UWA.is(D.ContextMenu.OpenCA)||(D.ContextMenu.OpenCA={accelerator:"Ctrl+I",availabilityMode:"Normal=YES CommandSet=YES Editability=YES SmallScale=YES LargeScale=YES ",id:"OpenCAFromCA",icon:"I_OpenDB",multisel:!0,text:y.ECM_CA_Command_Open,handler:function(e){c.DispatchEventToWin("OpenCA",D.ContextMenu.pid)}},"Referential"==e.where&&"true"!=r.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(D.ContextMenu.OpenCA.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenDB.png"))),UWA.is(D.ContextMenu.openAdv)||(D.ContextMenu.openAdv={accelerator:"Ctrl+Shift+O",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ENOVIA_Open_OpenAdvanced",icon:"I_OpenAdvDB",multisel:!0,text:y.ECM_CA_Command_OpenAdv,handler:function(e){c.DispatchEventToWin("OpenAdv",D.ContextMenu.pid)}},"Referential"==e.where&&"true"!=r.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(D.ContextMenu.openAdv.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenAdvDB.png"))),UWA.is(D.ContextMenu.openRO)||(D.ContextMenu.openRO={accelerator:"",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ENOVIA_Open_OpenInSideWaySession",icon:"I_OpenInReadOnly",multisel:!0,text:y.ECM_CA_Command_OpenRO,handler:function(e){c.DispatchEventToWin("OpenReadOnly",D.ContextMenu.pid)}},"Referential"==e.where&&"true"!=r.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(D.ContextMenu.openRO.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenInReadOnly.png"))),UWA.is(D.ContextMenu.Properties)||(D.ContextMenu.Properties={accelerator:"Alt+Enter",availabilityMode:"Normal=YES CommandSet=YES Editability=NO SmallScale=YES LargeScale=YES ",id:"ImmSearchProperty",icon:"I_Properties",multisel:!0,text:"Native_Properties",handler:function(e){c.DispatchEventToWin("Properties",D.ContextMenu.pid)}},"Referential"==e.where&&"true"!=r.getGlobalVariable().CHG_CA_VIEWS_ENHANCEMENT&&(D.ContextMenu.Properties.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_Properties.png")));var s={accelerator:"",availabilityMode:null,id:null,icon:null,items:D.GetSupportedExploreCommands(e),multisel:!0,text:y.ECM_CA_Command_ExploreWith},l={accelerator:"",availabilityMode:null,id:null,icon:null,items:D.GetAllExploreCommands(e),multisel:!0,text:y.ECM_CA_Command_ExploreWith};D.GetSupportedOpenCommands(e),y.ECM_CA_Command_OpenWith_RichClient;"Attachment"==e.where?(i.push(D.ContextMenu.explore),l.items.length>0&&i.push(l),e.hasOwnProperty("openCA")||i.push(D.ContextMenu.Open),e.hasOwnProperty("openCA")&&i.push(D.ContextMenu.OpenCA),i.push(D.ContextMenu.openAdv),i.push(D.ContextMenu.openRO),D.ContextMenu.openRO.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenInReadOnly.png"),D.ContextMenu.exploreParents.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_GetParents.png"),D.ContextMenu.exploreinContext.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_FindInContext.png"),D.ContextMenu.Open.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenDB.png"),D.ContextMenu.OpenCA.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenDB.png"),D.ContextMenu.openAdv.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenAdvDB.png"),D.ContextMenu.explore.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToVPMNavigator.png"),D.ContextMenu.exploreInPPR.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToPPRNavigatorWithParent.png"),D.ContextMenu.exploreInMSB.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToPPRNavigatorWithParent.png"),D.ContextMenu.exploreInRFLP.icon=h.getWebappsAssetUrl("ENOChangeActionUX","images/I_ExploreInRFLPNavigator.png")):(e.hasOwnProperty("explore")&&i.push(D.ContextMenu.explore),l.items.length>0&&i.push(s),e.hasOwnProperty("open")&&i.push(D.ContextMenu.Open),e.hasOwnProperty("openCA")&&i.push(D.ContextMenu.OpenCA),e.hasOwnProperty("exploreInCentral")&&D.ContextMenu.hasOwnProperty("exploreInCentral")&&i.push(D.ContextMenu.exploreInCentral),e.hasOwnProperty("openAdv")&&D.ContextMenu.hasOwnProperty("openAdv")&&i.push(D.ContextMenu.openAdv),e.hasOwnProperty("openRO")&&D.ContextMenu.hasOwnProperty("openRO")&&i.push(D.ContextMenu.openRO)),"Resolution"===e.where?t.displayContextualMenuForSolutionItem(i):"FlowdownFrom"===e.where?t.displayContextualMenuForFlowdownForItem(i):"FlowdownFor"===e.where?t.displayContextualMenuForFlowdownFromItem(i):t.DisplayContextMenu(i)}},GetSupportedExploreCommands:function(e){var t=[];return["exploreInRFLP","exploreInPPR","exploreParents","exploreInMSB","exploreinContext"].forEach((function(i){e.hasOwnProperty(i)&&D.ContextMenu.hasOwnProperty(i)&&t.push(D.ContextMenu[i])})),t},GetAllExploreCommands:function(e){var t=[];return["exploreInRFLP","exploreInPPR","exploreParents","exploreInMSB","exploreinContext"].forEach((function(e){t.push(D.ContextMenu[e])})),t},GetSupportedOpenCommands:function(e){var t=[];return["exploreInCentral","openAdv","openRO"].forEach((function(i){e.hasOwnProperty(i)&&D.ContextMenu.hasOwnProperty(i)&&t.push(D.ContextMenu[i])})),t}};return D})),define("DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices",["UWA/Core","DS/ENOChangeActionUX/scripts/Collection/CAProposedCollection","DS/UIKIT/Popover","DS/ENOChangeActionUX/scripts/Views/CAPopOverBodyView","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/DataGridView/DataGridView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],(function(e,t,i,n,o,a,s,r,l,c){"use strict";var d={createProposedCollection:function(e,i){var n={proposedArr:e,url:"dummyURL"},o=null;return(o=null!=i&&null!=i?i:new t).fetch(n),o},getOperationNameOnUI:function(e){var t="";switch(e){case"None":case"Modify":t=c.ECM_CA_Proposed_Activity_Modify;break;case"NewVersion":t=c.ECM_CA_Proposed_Operation_Revision;break;case"NewMinorVersion":t=c.ECM_CA_Proposed_Operation_MinorRevision;break;case"NewEvolution":t=c.ECM_CA_Proposed_Operation_Evolution;break;case"Create":t=c.ECM_CA_Proposed_Operation_Operation_Create;break;case"ChangeStatus":t=c.ECM_CA_Proposed_Activity_ChangeStatus;break;case"Release":t=c.ECM_CA_Proposed_Activity_State_Release;break;case"Obsolete":t=c.ECM_CA_Proposed_Activity_State_Obsolete;break;case"Restore":t=c.ECM_CA_Proposed_Activity_State_Restore;break;default:t=c.ECM_CA_Proposed_Activity_NoActivity}return t},buildFlowdownData:function(e,t){var i,n=[],o=[],a=[],s=[],r={},l=d.getPreviousFlowdownObjects(),c=e.proposedArrToAdd,p=null;for(var u in c&&(p=Object.keys(c)),p){var h=[],m=[],g=[],f=c[p[u]],C=l["pid:"+p[u]];if(f&&f.participateInflowdown){var v=null;for(var A in"Flowdown Pending"!==f.flowdownStatusValue&&"Flowdown Complete"!==f.flowdownStatusValue||(v={id:"pid:"+p[u],add:{},status:f.flowdownStatusValue},-1===n.indexOf("pid:"+p[u])&&n.push("pid:"+p[u])),f.resolutionItems){var w=f.resolutionItems[A];if(("Flowdown Pending"===f.flowdownStatusValue||"Flowdown Complete"===f.flowdownStatusValue)&&f.isResolutionObjectChanged){if(C&&C.resolutionItems){var y=C.resolutionItems;for(var b in y){var S=y[b];S&&S.flowdownAlreadyResolved&&(S.proposedActivityId?g.push(S.proposedActivityId):S.proposedId&&g.push(S.proposedId))}}if(w&&w.fromAddResolutionTab)-1===(E=w.proposedId).indexOf("pid:")&&(E="pid:"+E);else if(w){var E;-1===(E=w.proposedId).indexOf("pid:")&&(E="pid:"+E),m.push(E)}}}"Analysis Pending"===f.flowdownStatusValue&&a.push("pid:"+p[u]),"Ignored"===f.flowdownStatusValue&&o.push("pid:"+p[u]),(h&&h.length>0||g&&g.length>0||m&&m.length>0)&&(h&&h.length>0&&(v.add.direct=h),m&&m.length>0&&(v.add.proposed=m),g&&g.length>0&&(v.remove=g)),UWA.is(v)&&s.push(v)}}return(r={}).receivingChangeActionId=t,r.originChangeActionId=e.moreInfo.caID,n&&n.length>0&&(r.toFlowdown=n),a&&a.length>0&&(r.toDiscard=a),o&&o.length>0&&(r.toIgnore=o),s&&s.length>0&&(r.resolutionManagement=s),i=JSON.stringify(r),d.resetPreviouslySelectedFlowdownOjects(p),i},cacheFlowdownModelData:function(e){d[e.id]=e,UWA.is(d.cachedFlowdownModels)||(d.cachedFlowdownModels={}),d.cachedFlowdownModels[e.id]=e},setPreviousFlowdownObjects:function(e){d.previousFlowdownObjects=e},getPreviousFlowdownObjects:function(){return d.previousFlowdownObjects},resetPreviouslySelectedFlowdownOjects:function(e){for(var t in e){var i=e[t],n=d.getPreviousFlowdownObjects();n["pid:"+i]=[],delete n["pid:"+i]}d.previousFlowdownObjects=null}};return d})),define("DS/ENOChangeActionUX/scripts/Models/CAProposedModel",["UWA/Class/Model","DS/ENOChangeActionUX/scripts/Models/CAProposedActivityModel","DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","require","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","DS/ENOChgServices/scripts/services/ChgDataProcess"],(function(e,t,i,n,o,a,s){"use strict";return e.extend({idAttribute:"id",setup:function(){},fetch:function(e){var t=e.proposedArr;return e.ajax=function(e,i){myoptions.onComplete(t)},e.url="dummyURL",this._parent(e)},parse:function(e){var i="Cannot be found",n="Access denied",o={},s=e.where.info;if(e.flowdownElements)o=this._parseForFlowdownOperation(e);else if(s){if(o.id=e.id,o.Access=!0,o.operationActual=e.operation.name,o.operationDisplay=this.getOperationNameOnUI(e.operation.name),UWA.is(e.operation.name)&&"Create"==e.operation.name?(o.maturity="",o.policy="",o.revision="",o.type=e.operation.type,o.name=e.operation["display name"],o.objectName=e.operation["display name"],o.objectTitle=e.operation["display name"],o.objectId=e.id):(o.maturity=s.currentNLS,o.policy=s.policy,o.revision=s.revision,o.type=s.typeNLS,o.name=s["display name"],o.objectName=s["display name"],s["display name"]!=i&&s["display name"]!=n?o.objectTitle=s["display name"]:s["display name"]==n?o.objectTitle=a.ECM_CA_Access_Denied:o.objectTitle=a.ECM_CA_Cannot_be_found,o.objectType=s.type,o.objectId=e.where.id,o.evolutionName=e.operation["evolution name"],""!=o.maturity&&o.maturity!=n&&o.maturity!=i&&null!=o.maturity||(o.Access=!1)),e.why.comment&&e.why.comment.text){var r=UWA.String.escapeHTML(e.why.comment.text);o.changeReason=r}else o.changeReason="";if(e.flowdownInfo&&e.flowdownInfo.flowdownFrom&&1===e.flowdownInfo.flowdownFrom.length?(o.flowdownInfo=e.flowdownInfo,o.flowDownFromName=e.flowdownInfo.flowdownFrom[0].caName,o.flowDownFromId=e.flowdownInfo.flowdownFrom[0].caID,o.flowDownFromTitle=e.flowdownInfo.flowdownFrom[0].caTitle,o.flowdownForObjectId=e.flowdownInfo.flowdownFor[0].id,o.flowdownForObjectTitle=e.flowdownInfo.flowdownFor[0].info["display name"],o.flowdownForObjectType=e.flowdownInfo.flowdownFor[0].info.type,o.flowdownForObjectTypeNLS=e.flowdownInfo.flowdownFor[0].info.typeNLS):e.flowdownInfo&&e.flowdownInfo.flowdownFrom&&e.flowdownInfo.flowdownFrom.length>1?o.flowdownInfo=e.flowdownInfo:(o.flowdownForObjectId="",o.flowdownForObjectTitle="",o.flowdownForObjectType="",o.flowdownForObjectTypeNLS="",o.flowDownFromTitle="",o.flowDownFromId="",o.flowDownFromName="",o.flowdownInfo=null),UWA.is(e.activities)&&s["display name"]!=i&&s["display name"]!=n){var l=new UWA.Class.Collection,c=e.activities;Array.isArray(c)&&(c.forEach((function(i){if(i.objectId=e.where.id,i.operationId=e.id,null!=l.get(i.id));else{var n=new t(i,{parse:!0});"??Something went wrong??"!=n.get("activityName")&&l.add(n)}})),this.set("activities",l))}UWA.is(e.resolution)&&Array.isArray(e.resolution)?o.resolutionItems=e.resolution:o.resolutionItems=[],UWA.is(e.status)&&""!=e.status?s["display name"]!=i&&s["display name"]!=n&&(o.status=e.status,"Not Started"===o.status&&(o.statusNLS=a.ECM_PROPOSED_STATUS_NOT_STARTED_COMMAND),"Started"===o.status&&(o.statusNLS=a.ECM_PROPOSED_STATUS_STARTED_COMMAND),"Ignored"===o.status&&(o.statusNLS=a.ECM_PROPOSED_STATUS_IGNORE_COMMAND),"Rejected"===o.status&&(o.statusNLS=a.ECM_PROPOSED_STATUS_REJECT_COMMAND),"Complete"===o.status&&(o.statusNLS=a.ECM_PROPOSED_STATUS_COMPLETE_COMMAND),"Partial"===o.status&&(o.statusNLS=a.ECM_PROPOSED_STATUS_PARTIAL_COMMAND)):o.status=""}else o.Access=!1,o.objectTitle="NOT_TO_BE_SHOWN_MIB";return o},_parseForFlowdownOperation:function(e){var t={},i="Cannot be found",n="Access denied";t.Access=!0,t.id=e.id;var o=e.where.info;t.operationActual="Flowdown",t.operationDisplay=this.getOperationNameOnUI("Flowdown"),t.flowdownInfo=e.flowdownInfo,t.maturity=o.currentNLS,t.policy=o.policy,t.revision=o.revision,t.type=o.typeNLS,t.name=o["display name"],t.objectName=o["display name"],o["display name"]!=i&&o["display name"]!=n?(t.objectTitle=o["display name"],t.flowdownForObjectTitle=o["display name"]):o["display name"]==n?(t.objectTitle=a.ECM_CA_Access_Denied,t.flowdownForObjectTitle=a.ECM_CA_Access_Denied):(t.objectTitle=a.ECM_CA_Cannot_be_found,t.flowdownForObjectTitle=a.ECM_CA_Cannot_be_found),t.objectType=o.type,t.objectId=e.where.id,t.flowdownForObjectId=e.where.id,t.flowdownForObjectType=o.type,t.flowdownForObjectTypeNLS=o.typeNLS;var s=e.flowdownElements,r=(s.map((function(e){return e.elementPointedCAId})),e.flowdownResolutions);if(e.flowdownResolutions.length>0){var l=[];for(var c in r){var d=r[c];d&&d.resolutionObject&&l.push(d.resolutionObject)}t.resolutionItems=l}else t.resolutionItems=[];for(var c in s)if(o["display name"]!=i&&o["display name"]!=n){var p=s[c];p&&(t.flowDownFromTitle=p.elementPointedCATitle,t.flowDownFromId=p.elementPointedCAId,t.amoID=p.elementPointedId,t.flowDownFromName=p.elementPointedCATitle,t.status=p.elementStatus,t.syncStatus=p.elementSyncStatus,"Flowdown Pending"!==t.status&&"Started"!==t.status||(t.statusNLS=a.ECM_PROPOSED_STATUS_STARTED_COMMAND),"Rejected"===t.status&&(t.statusNLS=a.ECM_PROPOSED_STATUS_REJECT_COMMAND),"Flowdown Complete"!==t.status&&"Complete"!==t.status||(t.statusNLS=a.ECM_PROPOSED_STATUS_COMPLETE_COMMAND),"Flowdown Complete"!==t.status&&"Complete"!==t.status||"Updated"!==t.syncStatus&&"Transferred"!==t.syncStatus||(t.statusNLS=a.ECM_PROPOSED_STATUS_STARTED_COMMAND))}return""!=t.maturity&&t.maturity!=n&&t.maturity!=i&&null!=t.maturity||(t.Access=!1),e.why&&e.why.comment&&e.why.comment.text?t.changeReason=e.why.comment.text:t.changeReason="",t},getOperationNameOnUI:function(e){var t="";switch(e){case"None":case"Modify":t=a.ECM_CA_Proposed_Activity_Modify;break;case"NewVersion":t=a.ECM_CA_Proposed_Operation_Revision;break;case"NewMinorVersion":t=a.ECM_CA_Proposed_Operation_MinorRevision;break;case"NewEvolution":t=a.ECM_CA_Proposed_Operation_Evolution;break;case"Create":t=a.ECM_CA_Proposed_Operation_Create;break;case"ChangeStatus":t=a.ECM_CA_Proposed_Activity_ChangeStatus;break;case"Release":t=a.ECM_CA_Proposed_Activity_State_Release;break;case"Obsolete":t=a.ECM_CA_Proposed_Activity_State_Obsolete;break;case"Flowdown":t=a.ECM_CA_Proposed_Operation_Flowdown;break;default:t="??Something went wrong??"}return t}})})),define("DS/ENOChangeActionUX/scripts/Collection/CAProposedCollection",["UWA/Core","UWA/Class/Collection","DS/ENOChangeActionUX/scripts/Models/CAProposedModel"],(function(e,t,i){"use strict";return t.extend({model:i,setup:function(){},fetch:function(e){var t;return t=e.data=this.proposedArr=e.proposedArr,e.ajax=function(e,i){i.onComplete(t)},this.url="dummyURL",this._parent(e)}})})),define("DS/ENOChangeActionUX/scripts/Models/CAProposedModelForDisplayView",["UWA/Class/Model","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction","UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/ENOChgServices/scripts/services/ChgErrors"],(function(e,t,i,n,o,a,s,r){"use strict";return e.extend({idAttribute:"id",setup:function(){this.addEvent("onChange:operationDisplaySelect",(function(e){this.updateOperationDisplayInfo(e)})),this.addEvent("onChange:operationActual",(function(e){this.updateOperationDisplaySelectInfo(e)})),this.addEvent("onChange:activityDisplaySelect",(function(e){this.updateActivityDisplayInfo(e)})),this.addEvent("onChange:activityActual",(function(e){this.updateActivityDisplaySelectInfo(e)})),this.addEvent("onChange:proposedObject",(function(e){this.updateAllowedOperationInfo(e)})),this.addEvent("onChange:createNewToggle",(function(e){UWA.is(e.get("createNewToggle"))&&"TRUE"==e.get("createNewToggle")?e.set("isCreateOperation",!0):e.set("isCreateOperation",!1)}))},parse:function(e){var i=e.model;if(this.set("canEdit",!0),UWA.is(e.selectedOperation)){var n=[{displayValue:"",actualValue:"NoSelection"},{displayValue:s.getOperationNameOnUI("None"),actualValue:"None"},{displayValue:s.getOperationNameOnUI("NewEvolution"),actualValue:"NewEvolution"},{displayValue:s.getOperationNameOnUI("NewMinorVersion"),actualValue:"NewMinorVersion"},{displayValue:s.getOperationNameOnUI("NewVersion"),actualValue:"NewVersion"}];this.set("operationDisplayOptions",n);var o={displayValue:"",actualValue:"NoSelection"};this.set("operationDisplaySelect",o),this.set("operationDisplay",o.displayValue),this.set("operationActual",o.actualValue);var a=[{displayValue:s.getOperationNameOnUI("NoSelection"),actualValue:"NoSelection"},{displayValue:s.getOperationNameOnUI("Modify"),actualValue:"Modify"},{displayValue:t.ECM_CA_Proposed_Activity_ChangeMaturity+": "+s.getOperationNameOnUI("Release"),actualValue:"Release"},{displayValue:t.ECM_CA_Proposed_Activity_ChangeMaturity+": "+s.getOperationNameOnUI("Obsolete"),actualValue:"Obsolete"},{displayValue:t.ECM_CA_Proposed_Activity_ChangeMaturity+": "+s.getOperationNameOnUI("Restore"),actualValue:"Restore"}];this.set("activityDisplayOptions",a);var r={displayValue:s.getOperationNameOnUI("NoSelection"),actualValue:"NoSelection"};this.set("activityDisplaySelect",r),this.set("activityDisplay",r.displayValue),this.set("activityActual",r.actualValue)}else if(UWA.is(i.id)){var l={};this.set("isEdit",!0),this.set("id",i.id),l.objectType=i.get("objectType"),l.objectName=i.get("objectTitle"),l.objectRev=i.get("revision"),l.objectName=l.objectName+" "+l.objectRev,l.objectID=i.get("objectId").replace("pid:",""),l.maturity=i.get("maturity"),l.policy=i.get("policy"),l.image={imageValue:i.get("icon")},this.set("createObjectTitle",i.get("name")),this.set("createObjectType",i.get("type")),this.set("proposedObject",l),this.set("evolutionName",UWA.is(i.get("evolutionName"))?i.get("evolutionName"):""),this.set("operationActual",i.get("operationActual")),"Create"==i.get("operationActual")?this.set("isCreateOperation",!0):this.set("isCreateOperation",!1),"NewEvolution"==i.get("operationActual")?this.set("isEvolutionOperation",!0):this.set("isEvolutionOperation",!1),this.updateOperationDisplaySelectInfo(this),this.updateAllowedOperationInfo(this),this.set("reasonForChange",UWA.String.unescapeHTML(i.get("changeReason")))}},add:function(e,t,i){var n={},o=this,s=t,r=[s];a.getAdditionObjectInfo(r).then((function(t){n.objectType=t.additionObjectInfo[s].type,n.objectName=t.additionObjectInfo[s].objectTitle,n.objectRev=t.additionObjectInfo[s].revision,n.objectName=n.objectName+" "+n.objectRev,n.objectID=t.additionObjectInfo[s].pid,n.policy=t.additionObjectInfo[s].policy,n.image={imageValue:t.additionObjectInfo[s].icon},n.maturity=t.additionObjectInfo[s].stateNLS;var i=o.get(e);UWA.is(i,"object")&&o.unset(e),o.set(e,n)}),(function(e){return console.log("Populate Security Context failed"),Promise.reject(e)}))},remove:function(e,t,i){var n=this.get(e);UWA.is(n,"object")&&(this.unset("operationActual",{silent:!0}),this.unset(e))},updateOperationDisplaySelectInfo:function(e){var t=e.get("operationActual");require(["DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices"],(function(i){var n=i.getOperationNameOnUI(t);e.set("operationDisplaySelect",{displayValue:n,actualValue:t},{silent:!0}),e.set("operationDisplay",n)}))},updateActivityDisplaySelectInfo:function(e){var i=e.get("activityActual");require(["DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices"],(function(n){var o=n.getOperationNameOnUI(i);"Release"!=i&&"Obsolete"!=i&&"Restore"!=i||(o=t.ECM_CA_Proposed_Activity_ChangeMaturity+": "+o),e.set("activityDisplaySelect",{displayValue:o,actualValue:i},{silent:!0}),e.set("activityDisplay",o)}))},updateActivityDisplayInfo:function(e){var t=e.get("activityDisplaySelect");if(UWA.is(t)&&UWA.is(t.actualValue)){t.actualValue;e.set("activityActual",t.actualValue,{silent:!0}),e.set("activityDisplay",t.displayValue)}},updateOperationDisplayInfo:function(e){var t=e.get("operationDisplaySelect");if(UWA.is(t)&&UWA.is(t.actualValue)){var i=t.actualValue;UWA.is(i)&&"Create"==i?e.set("isCreateOperation",!0):e.set("isCreateOperation",!1),UWA.is(i)&&"NewEvolution"==i?e.set("isEvolutionOperation",!0):e.set("isEvolutionOperation",!1),e.set("operationActual",t.actualValue,{silent:!0}),e.set("operationDisplay",t.displayValue);var n;void 0!==(n=e.get("activityDisplayOptions"))&&1==n.length?"Obsolete"==e.get("proposedObject").maturity&&e.set("activityActual","Restore"):e.set("activityActual","NoSelection")}},updateAllowedOperationInfo:function(e){UWA.is(e.get("proposedObject"))&&UWA.is(e.get("proposedObject").objectID)?require(["DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/ENOChgServices/scripts/services/ChgProposedServices"],(function(i,o){var a=e.get("proposedObject").objectID,s=e.id,r=[];r.push("pid:"+a);let l=n.getGlobalVariable().IDCard.model.id;o.getAllowedOperationActivity(r,l,s).then((function(n){var o=[];n.allowedOperationActivity[a].allowedOperation.forEach((function(e){o.push({displayValue:i.getOperationNameOnUI(e),actualValue:e})}));const s=o.some((e=>"Restore"===e.actualValue));if(s&&(o=o.filter((function(e){return"Restore"!=e.actualValue}))),e.set("operationDisplayOptions",o),!e.get("isEdit")){e.set("operationActual",n.allowedOperationActivity[a].defaultOperation);var r=n.allowedOperationActivity[a].defaultActivity;"Obsolete"==e.get("proposedObject").maturity&&s&&(r="Restore"),r=UWA.is(r)?r:"NoSelection",e.set("activityActual",r);var l=[];l.push({displayValue:i.getOperationNameOnUI("NoSelection"),actualValue:"NoSelection"}),n.allowedOperationActivity[a].allowedActivity.forEach((function(n){var o=i.getOperationNameOnUI(n);"Release"==n||"Obsolete"==n?o=t.ECM_CA_Proposed_Activity_ChangeMaturity+": "+o:"Modify"==n&&"Obsolete"==e.get("proposedObject").maturity&&s&&(o=t.ECM_CA_Proposed_Activity_ChangeMaturity+": "+t.ECM_CA_Proposed_Activity_State_Restore),"Modify"==n&&"Obsolete"==e.get("proposedObject").maturity&&s?(l.pop(),l.push({displayValue:o,actualValue:"Restore"})):l.push({displayValue:o,actualValue:n})})),e.set("activityDisplayOptions",l)}}),(function(e){return console.log("Get allowed operation/activity failed"),Promise.reject(e)}))})):(e.unset("operationDisplayOptions"),e.unset("operationActual"),e.unset("activityActual"))},proposedTypeAheadCallback:function(e,t,i){var a="flattenedtaxonomies:(",s=e.searchTypes;(s=s.split(",")).forEach((function(e,t){0!=t&&(a+=" OR "),a+='"types/'+e.trim()+'"'})),a+=")";let l={"3dspace":{SecurityContext:n.getGlobalVariable().getSecurityContext()}};var c={with_indexing_date:!0,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:name","ds6wg:revision"],select_file:["icon","thumbnail_2d"],query:t,order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:["3dspace"],specific_source_parameter:{"3dspace":{additional_query:a}},tenant:n.getGlobalVariable().tenant,login:l},d=(c=JSON.stringify(c),{isfederated:!0});return""!=t.trim()?o.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",c,(function(e){var t=[];if(e.infos&&e.infos.nresults>0)for(var n=e.results,o=0;o<e.infos.nresults;o++){var a=n[o];if(a&&a.attributes){for(var s,r,l,c,d,p=0;p<a.attributes.length;p++){var u=a.attributes[p];u.name.indexOf("type")>=0&&u.value,u.name.indexOf("identifier")>=0&&(s=u.value||""),u.name.indexOf("type_icon_url")>=0&&(r=u.value||""),u.name.indexOf("label")>=0&&(l=u.value||""),u.name.indexOf("resourceid")>=0&&(c=u.value||""),u.name.indexOf("revision")>=0&&(d=u.value||"")}t.push({value:c,label:(l||s)+" "+d,image:r})}}i(t)}),(function(e,t){console.log("failure"),r.error(t.error.errorMessage),i([])}),d):void 0}})})),define("DS/ENOChangeActionUX/scripts/Views/CARealizedActivitiesSelectedProposedView",["UWA/Class/View","UWA/Core","DS/Handlebars/Handlebars4","DS/PlatformAPI/PlatformAPI","DS/ENOChangeActionUX/scripts/Services/CARealizedViewServices","DS/ENOChangeActionUX/scripts/Services/CAProposedViewServices","DS/UIKIT/Popover","DS/ENOChangeActionUX/scripts/Views/CAPopOverBodyView","i18n!DS/ENOChangeActionUX/assets/nls/ChangeAction"],(function(e,t,i,n,o,a,s,r,l){"use strict";return e.extend({clonedContent:[],init:function(e){this.options=e,this.clonedContent=this.options.data,this._parent.call(this,e)},setup:function(){this.template='                <div class="selected-proposed-container">                    <span class="selected-proposed-label">{{selectedProposedLabel}}</span>                    {{#if singleItem}}                    <span class="selected-proposed-label-obejct text" title="{{itemTitle}}">                        <span class="formatted-label"> {{itemTitle}}</span>                        <span class="supp-icon" id={{id}}></span>                    </span>                    {{else}}                    <span><a class="multiple-proposed" id="targetid">{{itemLength}} '+l.ECM_SELECTED_PROPOSED_ITEMS_LABEL+"</a></span>                    {{/if}}                </div>",this.renderer=this.getTemplate()},render:function(){this.container.empty();var e=this.renderer();return this.container.addContent(e),this},getTemplate:function(){var e=i.compile(this.template),t=this;this.data={};var n=this.clonedContent,o="";if(UWA.is(n)&&Array.isArray(n)){if(n&&1===n.length){var a=n[0].proposedTitle,s=n[0].proposedRevision,r=n[0].proposedId.replace("pid:","");o=a+" "+s}else n&&n.length>1&&(o=n.length+" "+l.ECM_SELECTED_PROPOSED_ITEMS_LABEL);this.data={selectedProposedLabel:l.ECM_SELECTED_PROPOSED_OBJECTS,singleItem:1===n.length&&n.length>0,itemTitle:o,itemLength:n.length},UWA.is(r)&&""!=r&&(this.data.id=r)}return function(){return e(t.data)}},domEvents:{"click .multiple-proposed":function(e){e.stopPropagation(),e.preventDefault();var t=this.options.data,i={target:e.target,selectedItems:t,contextObj:this};this.launchMultiplePopover(i)},"click .supp-icon":function(e){this.resetContent(e)}},launchMultiplePopover:function(e){this.proposedPopover&&this.proposedPopover.destroy();var t=this.proposedPopover=new s({className:"selectedPopover",target:e.target,position:"right",trigger:"click touch",autoHideOnClickOutside:!0,title:l.ECM_SELECTED_PROPOSED_OBJECTS,events:{onShow:function(){document.querySelector(".popover")&&document.querySelector(".popover").show()}}}).show(),i={objectsSelected:e.selectedItems,container:t.elements.body,bodyOf:"multipleSelectedProposed"};this.popOverBodyview&&this.popOverBodyview.destroy();var n=this.popOverBodyview=new r(i);n.render();var o=this;this.updateContent=this.updateContent.bind(this);var a={crossClicked:function(e){var t=e,i=o.options.baseAMO;this.updateContent(t);var n={itemObjID:t,amoID:i};this.dispatchEvent("crossClicked",[n])}};this.listenTo(n,a)},resetContent:function(e){this.container.empty(),this.options.statusComboBox.selectedIndex=0,this.options.idOfContextObj&&(o[this.options.idOfContextObj].fromFreeSearch=[],o[this.options.idOfContextObj].fromRelationsTab=[],o[this.options.idOfContextObj].fromAddResolutionTab=[]);var t=this.options.amoBasedInfo;if(t){var i=Object.keys(t);for(var n in i){var a=t[i[n]];a&&a.resolutionItems&&(a.resolutionItems=[],a=null)}}t=null},updateContent:function(e){var t=this.clonedContent.filter((function(t){return e=e.replace("pid:",""),t.proposedId.replace("pid:","")!=e}));if(this.clonedContent=t,1===t.length){var i=t[0].proposedTitle,n=t[0].proposedRevision,o=t[0].proposedId.replace("pid:",""),a=i+" "+n;(s=this.container.getElement(".selected-proposed-container")).innerHTML="",s.innerHTML='                    <span class="selected-proposed-label">'+l.ECM_SELECTED_PROPOSED_OBJECTS+'</span>                        <span class="selected-proposed-label-obejct text">                            <span class="formatted-label">'+a+'</span>                            <span class="supp-icon" id="'+o+'"}></span>                        </span>'}else if(t.length>1){var s;(s=this.container.getElement(".multiple-proposed")).innerHTML="",s.innerHTML=t.length+" "+l.ECM_SELECTED_PROPOSED_ITEMS_LABEL}else this.resetContent()},destroy:function(){}})}));