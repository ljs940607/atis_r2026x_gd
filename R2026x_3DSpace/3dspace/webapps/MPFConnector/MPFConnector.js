define("DS/MPFConnector/MpDataUrlHelper",["DS/PlatformAPI/PlatformAPI","DS/WAFData/WAFData","DS/MPFUrl/UrlUtils"],(function(e,t,r){"use strict";const o=Object.freeze({MARKETPLACE_DATA:"MPDataMgt",MY_3DEXPERIENCE:"My3DEXPERIENCE",COMPASS:"3DCOMPASS",PASSPORT:"3DPASSPORT"}),n=new Map;n.set("marketplace",o.MARKETPLACE_DATA),n.set("my3dexperience",o.MY_3DEXPERIENCE),n.set("3DCompass",o.COMPASS),n.set("3DPassport",o.PASSPORT);const s={};class i{static async getServiceUrl(t="marketplace",r,s){const i=n.get(t);let a=await this._getUrlFromRegistry(i,r,s);if(!a&&i===o.MARKETPLACE_DATA){const t=e.getAllApplicationConfigurations();a=this._getMpUrlFromAppConfiguration(t,"app.urls.myapps","apps"),!a&&(a=this._getMpUrlFromAppConfiguration(t,"app.swymfeature.my3dexp.baseurl","3dswym"))}return a}static async _getUrlFromRegistry(o="MPDataMgt",n,i){if(n=n||window.ds&&window.ds.tenant||r.isSandbox()&&e.getTenant()||e.getApplicationConfiguration("app.mp.tenant"),i||(i=window.ds&&window.ds.registryUrl||e.getApplicationConfiguration("app.urls.registry")),i&&n){let e;return s[i]?e=s[i]:(e=await new Promise(((e,r)=>{t.authenticatedRequest(`${i}/api/v1/platform/instance?id=${n}`,{type:"json",onComplete:e,onFailure:r})})),s[i]=e),e[n]&&e[n][o]&&e[n][o].url}}static _getMpUrlFromAppConfiguration(e,t,r){const o=e.find((e=>e.propertyKey===t));if(o){const e=o.propertyValue;if(e){const t=new URL(e.replace("-"+r+".","-mpdatamgt."));return t.search="",t.hash="",t.pathname="/enovia",t.toString()}}}static resetRegistryCache(){Object.keys(s).forEach((e=>{delete s[e]}))}}return i.RegistryServices=o,i})),define("DS/MPFConnector/ConnectorBackend",[],(function(){"use strict";return Object.freeze({MARKETPLACE:"marketplace",SWYM:"3DSwym"})})),define("DS/MPFConnector/Connector",["UWA/Core","UWA/Class"],(function(e,t){"use strict";return t.extend({url:function(e){},request:function(e,t){}})})),define("DS/MPFConnector/MarketplaceConnector",["UWA/Core","UWA/Utils","UWA/Class","UWA/Promise","DS/MPFConnector/Connector","DS/MPFUtils/MPFUtils","DS/WAFData/WAFData","DS/MPFCompassPlatformServices/CompassPlatformServices","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/PlatformAPI/PlatformAPI","DS/MPFUrl/UrlUtils","DS/MPFServices/MarketplaceServices","DS/MPFConnector/ConnectorBackend","DS/MPFConnector/MpDataUrlHelper"],((e,t,r,o,n,s,i,a,c,l,p,f,u,d)=>{"use strict";const m={},h=n.extend({init(e,t,r){if("string"!=typeof e)throw new Error("Marketplace base URL must be a string");if(r||(r={}),e.length>0){const t=e.slice(-1);this.rootUrl="/"===t?e.slice(0,-1):e}this.platformId=t,this.tenant=this.platformId,this.service=r.service||f.MAKE,this.app=r.app},url(e,r={}){const o=e.split("#"),n=o[0].split("?");let s;s=n.length>1?n[1].split("&"):[],this.service&&s.push("service="+this.service),this.platformId&&s.push("tenant="+this.platformId);const i=r.esid||t.getQueryString(window.location.href,"esid");i&&!1!==r.addESID&&s.push("project="+i);const a=s.join("&");return a&&(n[1]=a),o[0]=n.join("?"),e=o.join("#"),this.rootUrl+e},request(r,o){const n=o.method||"GET",s="number"==typeof o.retry?o.retry:1,a={...o,method:n,type:"json",timeout:18e4,retry:s};if("POST"===n||"PATCH"===n||"PUT"===n){o.data&&Object.prototype.isPrototypeOf.call(FormData.prototype,o.data)||(a.headers||(a.headers={}),a.headers["Content-Type"]="application/json")}e.is(t.Client)&&t.Client.Engine.ie&&"GET"===n&&(r=new p(r).addParameter("iecache",Date.now()).getUrl()),a.onFailure=function(){return a.retry-=1,a.retry>=0?i.authenticatedRequest(r,a):o.onFailure(...arguments)};const c=r.contains("service=clicknbuy");return c&&"POST"===n&&r.contains("/me/carts")?a.onPassportError=(e,t)=>{console.error(e);const r="/welcome/compass-world/3dexperience-collaborative-innovation/3dswymer/buy";let o;o=window.location.pathname.contains("/checkout")?r+"/checkout":window.location.pathname.contains("/cart")?r+"/cart":window.location.pathname;const n=new p(window.location.origin+o+window.location.hash).getUrl();window.location.href=t.replace("/logout","")+"/login?service="+encodeURIComponent(n)+"&theme=clicknbuy"}:c&&"GET"===n&&r.contains("/mdcart/carts/")&&new p(window.location.href).hasParameter("cartId")?a.onPassportError=(e,t)=>{console.error(e),window.location.href=t.replace("/logout","")+"/login?service="+encodeURIComponent(window.location.href)+"&theme=clicknbuy"}:r.contains("/me/cartsV2")?a.onPassportError=e=>{console.error(e)}:"function"!=typeof a.onPassportError&&(a.onPassportError=e=>{if("NetworkError: Invalid, expired or missing CASTGC"===e.message){window.sessionStorage.getItem("mpui-has-reloaded-passport")||(window.sessionStorage.setItem("mpui-has-reloaded-passport",!0),window.location.reload())}}),i.authenticatedRequest(r,a)}});return h.fetchPromise=async function(e={}){e=h._sanitizeOptions(e);const t=s.objectHashCode(e);if(m[t])return m[t];let r,o=e.platformId;if(!o&&window.$nuxt&&window.$nuxt.$env&&window.$nuxt.$env.PLATFORM_ID&&(o=window.$nuxt.$env.PLATFORM_ID),!o&&window.ds&&window.ds.tenant&&(o=window.ds.tenant),!o&&p.isSandbox()&&(o=l.getTenant()||l.getApplicationConfiguration("app.mp.tenant"),!o&&p.isMy3dExperienceSandbox()&&(o=p.getTenantFromSbUrl())),o||console.warn("MarketplaceConnector - no platformId provided or found in configuration"),o&&(r=await d.getServiceUrl(e.backend,o)),!r){const t=await h._fetchServiceDataViaPlatformServices({backend:e.backend,platformId:o});r=t&&t.url,o=t&&t.platformId}if(!(r||e.backend&&"marketplace"!==e.backend)){const e=await h._fetchMyAppsUrl(),t=e&&await h._fetchMarketplaceUrlFromMyApps(e);r=t&&t.url}if(!r)throw new Error(`Unable to find URL for backend ${e.backend||"marketplace"} on tenant ${o}`);e.backend===u.MARKETPLACE&&(r+="/resources");const n=new h(r,o,e);return m[t]=n,n},h._fetchServiceDataViaPlatformServices=async function({backend:e,platformId:t}={}){try{const r=await a.getServiceUrlPromise({platformId:t,serviceName:e}),o=h._extractServiceDetails(r);if(o&&o.url)return o.platformId&&(t=o.platformId),{url:o.url,platformId:t}}catch(e){console.error(e),console.error("Unable to get platform services from i3DXCompassPlatformServices")}},h._fetchMyAppsUrl=async function(){let e;try{if(e=await a.getServiceUrlPromise({serviceName:"3DCompass"}),e&&Array.isArray(e)&&e.length>0)return h._extractFirstServiceWithAnUrlFromArray(e);throw new Error}catch(e){console.warn("Unable to get MyApps url from i3DXCompassPlatformServices")}},h._fetchMarketplaceUrlFromMyApps=function(e){return new o((function(t,r){const o=e.url+"/resources/AppsMngt/api/v1/public/services";i.request(o,{type:"json",onComplete:function(e){const r=e&&e.platforms;if(r){const e=s.findInArray(r,(e=>s.findInArray(e.services,(e=>"marketplace"===e.id))));if(e){const r=s.findInArray(e.services,(function(e){return"marketplace"===e.id}));t({platformId:e.id,url:r.url})}}},onFailure:function(){r(new Error("Unable to get marketplace url from MyApps"))}})}))},h._sanitizeOptions=function(e){const t={};return(e=e||{}).service&&(t.service=e.service),e.platformId&&(t.platformId=e.platformId),t.backend=e.backend||"marketplace",t},h._extractServiceDetails=function(e){const t="string"==typeof e,r=Array.isArray(e);let o={};return t?o.url=e:r?o=h._extractFirstServiceWithAnUrlFromArray(e):o.url="",o},h._extractFirstServiceWithAnUrlFromArray=function(e){const t=s.findInArray(e,(function(e){return e.url})),r={};return t&&(r.platformId=t.platformId,r.url=t.url),r},h.get3DPassportUrl=function(){const e=o.deferred();return c.getPlatformServices({onComplete:function(t){const r=t.filter((function(e){return!!e["3DPassport"]})).pop();if(r){const t=r["3DPassport"];e.resolve(t)}else e.reject("Unable to find a 3DPassport in platform services from i3DXCompassPlatformServices")},onFailure:function(){e.reject("Unable to get platform services from i3DXCompassPlatformServices")}}),e.promise},h.removeInstance=function(e){delete m[e]},h})),define("DS/MPFConnector/SheerIdConnector",["DS/MPFConnector/Connector","DS/WAFData/WAFData"],(function(e,t){"use strict";const r=e.extend({init(){this.rootUrl="https://services.sheerid.com/rest/v2"},request(){return this.fetch(...arguments)},async fetch(e,{method:t="GET",isJson:r=!0,contentType:o,data:n}={}){const s=this._createUrl(e),i={method:t};return r?(i.headers={"Content-Type":"application/json"},i.body=JSON.stringify(n)):o?(i.headers={"Content-Type":o},i.body=n):i.body=n,window.fetch(s,i).then((e=>e.json()))},async fetchProxified(e,{method:r="GET",type:o="json",headers:n,data:s}={}){const i=this._createUrl(e);return new Promise(((e,a)=>{t.proxifiedRequest(i,{method:r,type:o,headers:n,data:s,onComplete(t){e(JSON.parse(t))},onFailure(e){console.error(e),a(e)},onTimeout(e){console.error("Request timed out"),console.error(e),a(e)}})}))},_createUrl(e){return new RegExp("^(?:[a-z]+:)?//","i").test(e)?e:this.rootUrl+e}});return r})),define("DS/MPFConnector/AppsConnector",["DS/MPFConnector/Connector","DS/MPFUrl/UrlUtils","DS/MPFConnector/MpDataUrlHelper","DS/WAFData/WAFData","UWA/Promise","UWA/Core","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],((e,t,r,o,n,s,i)=>{"use strict";const a=e.extend({init(e,t={}){this.rootUrl=e,s.is(t.platformId)&&(this.platformId=t.platformId)},url(e){return new t(this.rootUrl+e).getUrl()},request(e,t){const r={method:t.method||"GET",type:"json",timeout:18e4,onComplete:t.onComplete,onFailure:t.onFailure,data:t.data};return!1===t.authenticated?o.request(e,r):o.authenticatedRequest(e,r)}});return a.fetchPromise=function({platformId:e}={}){const t=n.deferred();return i.getPlatformServices({onComplete:function(o){const n=o.filter((function(t){return!(!t["3DCompass"]||e&&e!==t.platformId)})).shift();if(n){const e=n["3DCompass"]+"/resources/AppsMngt",r=new a(e);t.resolve(r)}else r.getServiceUrl("3DCompass",e).then((e=>{if(e){const r=new a(e+"/resources/AppsMngt");t.resolve(r)}else t.reject("Unable to find a compass in platform services from i3DXCompassPlatformServices")}))},onFailure:function(){t.reject("Unable to get platform services from i3DXCompassPlatformServices")}}),t.promise},a.fetchPromiseSynchro=function(){const e=n.deferred();return i.getPlatformServices({onComplete:function(t){const o=t.filter((function(e){return!!e["3DCompass"]})).shift();if(o){const t=o["3DCompass"]+"/resources/AppsMngtSynchro/api/v1",r=new a(t,{platformId:o.platformId});e.resolve(r)}else r.getServiceUrl("3DCompass").then((t=>{if(t){const r=new a(t+"/resources/AppsMngt");e.resolve(r)}else e.reject("Unable to find a compass in platform services from i3DXCompassPlatformServices")}))},onFailure:function(){e.reject("Unable to get platform services from i3DXCompassPlatformServices")}}),e.promise},a.getUser=function(e){return e||(e={}),i.getUser(e)},a})),define("DS/MPFConnector/NoConnector",["DS/MPFConnector/Connector","DS/MPFUtils/MPFUtils"],(function(e,t){"use strict";let r;const o=e.extend({url:t.doNothing,request:t.doNothing});return o.getInstance=function(){return r||(r=new o),r},Object.freeze(o),o})),define("DS/MPFConnector/MarketplaceAdminConnector",["UWA/Core","UWA/Utils","DS/MPFConnector/Connector","DS/MPFConnector/MpDataUrlHelper","DS/MPFServices/MarketplaceServices","DS/MPFData/MPFData","text!DS/MPFConnector/assets/productionValues.env.json"],((e,t,r,o,n,s,i)=>{"use strict";const a=r.extend({init(e,t,r){if("string"!=typeof e)throw new Error("Marketplace base URL must be a string");if(r||(r={}),e.length>0){const t=e.slice(-1);this.rootUrl="/"===t?e.slice(0,-1):e}this.platformId=t,this.tenant=this.platformId,this.service=r.service||n.MAKE,this.app=r.app},url(e,r={}){const o=e.split("#"),n=o[0].split("?");let s;s=n.length>1?n[1].split("&"):[],this.service&&s.push("service="+this.service),this.platformId&&s.push("tenant="+this.platformId);const i=r.esid||t.getQueryString(window.location.href,"esid");i&&!1!==r.addESID&&s.push("project="+i),s.push("xrequestedwith=xmlhttprequest");const a=s.join("&");return a&&(n[1]=a),o[0]=n.join("?"),e=o.join("#"),this.rootUrl+e},request(t,r){const o=r.method||"GET",n=e.extend({httpVerb:o,type:"json",timeout:18e4,retry:1},r);if("POST"===o||"PATCH"===o||"PUT"===o){r.data&&Object.prototype.isPrototypeOf.call(FormData.prototype,r.data)||(n.headers||(n.headers={}),n.headers["Content-Type"]="application/json")}return n.onFailure=function(){return n.retry-=1,n.retry>=0?s.request(t,n):r.onFailure(...arguments)},n.onPassportError=(e,t)=>{console.error(e),window.location.href=t.replace("/logout","")+"/login?service="+encodeURIComponent(window.location.href)},s.request(t,n)}});return a.fromMpDataMgtUrl=function(e,t){return new a(e.replace(/\/webapps\/[^/]+$/,"/resources"),e.replace(/^https?:\/\/([^-]+).*/,"$1").toUpperCase(),t)},a.get3DPassportUrl=async function(e){const t=JSON.parse(i).registryUrl;return await o.getServiceUrl("3DPassport",e,t)},a})),define("DS/MPFConnector/EchoConnector",["DS/MPFConnector/Connector","DS/MPFUtils/MPFUtils"],(function(e,t){"use strict";let r;const o=e.extend({url:function(e){return e},request:t.doNothing});return o.getInstance=function(){return r||(r=new o),r},Object.freeze(o),o}));