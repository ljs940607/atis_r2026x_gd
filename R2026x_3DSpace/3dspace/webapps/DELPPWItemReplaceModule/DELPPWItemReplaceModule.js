define("DS/DELPPWItemReplaceModule/MfgItemReplaceModule",["UWA/Core","DS/DELPPWInsertCmdModule/InsertUI"],(function(e,t){"use strict";return{behaviors:["UXFactoryBehavior","ModelBehavior","LinkBehavior","ResourceBehavior","SelectionBehavior","SearchBehavior","MfgItemReplaceBehavior","UXFactoryBehavior","WUXNodeModelBehavior","TreeListViewBehavior","MfgItemBehavior","ReplaceWhereUsedBehavior"],creator:function(i,n,o,r,a,l,s,c,u,d,g,f,R){var h,p,v,y,B,I,L={},M=null;return B=function(t,i){e.is(i.newRef)&&c.replace("replaceByNew",i.newRef.id)},function(e,t){t.onComplete=B,t.silent=!0,o.createRefOrInst(e,null,t)},h=function(){I()&&r.getRelations().then((function(e){e.isRelationsLoaded&&c.replace("replaceByLatest")}))},v=function(){I()&&r.getRelations().then((function(e){e.isRelationsLoaded&&c.replace("replaceByNewRevision")}))},p=function(){var t,n,u,d,g=l.getSelectedInsts();I()&&(t=function(t){if(e.is(t,"array")&&t.length>0){let n=o.getReferenceModel(t[0].id);if(e.is(n)&&e.is(n._attributes)){let e=n._attributes.type+".V_ContextualImplementLink";if("TRUE"===n._attributes[e])return void i.warn(a.getNLSValue("NodeModelBehavior.InconsistentLinkError.StopReplaceInfo"))}c.replace("replaceByExisting",t[0].id)}},r.getRelations().then((function(e){var i,r,l;e.isRelationsLoaded&&1===g.length&&(n=g[0],l=(u=o.getReferenceModelFromInstance(n)).get("PPRTYPE"),d=o.getAggregatingReferenceModelFromInstance(n),i=o.getValidChildTypes(d),"OPERATION"!==l&&"SYSTEM"!==l||((r=o.getTypeHierarchy(u.get("type"))).unshift(u.get("type")),i=i.filter((function(e){return r.indexOf(e)>-1}))),s.showSearchDialoguAndActivate(t,{title:a.getNLSValue("Dialog.ReplaceByExisting.Title"),searchTitle:a.getNLSValue("Search.ReplaceByExisting.Title"),types:i}))})))},y=function(){I()&&r.getRelations().then((function(e){e.isRelationsLoaded&&c.replace("replaceByNew")}))},I=function(){var t,i=l.getSelectedInsts(),n=!1;return Array.isArray(i)&&i.length>0&&(t=o.getAggregatingReferenceModelFromInstance(i[0]),e.is(t)&&(t.isProcess()||t.isService()||t.isConstruction())&&(n=!0)),n},{listenTo:function(){return{ReplaceByLatestRevision:h,ReplaceByExisting:p,ReplaceByNewRevision:v,ReplaceByNewReference:y,refreshAll:this.closeDialog}},onStart:function(r,l){L=e.extend(L,r),e.is(L.insertFormAttributeXML)||(i.debug("Insert Module loading failed : insertFormAttributeXML option is undefined"),l()),M=new t(i,n,a,o),l()},onStop:function(){M.isActive()&&M.destroyUI(),M=void 0},closeDialog:function(){e.is(M)&&M.destroyUI()}}}}}));