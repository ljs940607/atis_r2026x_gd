define("DS/DELPPWPropertiesModule/PropertiesModule",["UWA/Core","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/constants/EditPropConstants","DS/DELWebInfrastructureControls/DELWebAddExtensionsWidget"],(function(e,t,n,i,o){"use strict";return{behaviors:["UXFactoryBehavior","SelectionBehavior","ModelBehavior","ResourceBehavior","DocumentBehavior"],creator:function(c,s,a,r,l,u){var d,p,m,f,g,D,S,y,x,E,h,F,P,C,_,R,I,v,b,L,w,A,T,N,W,M=[];return _=function(){var n,o,_,b,L,V,k,U=c.getElement(),O=s.getComponent("WUXDockAreaEnum"),q=s.getComponent("WUXFrameWindowsManager").getFrameWindow(c.getAppContext());e.is(q)&&(n=q.getImmersiveFrame(),e.is(n)&&(k={position:{at:"top right"},side:O.RightDockArea,currentDockArea:O.RightDockArea,title:l.getNLSValue("Cmd.DisplayProperties.Title"),minWidth:450,height:300,content:U,resizableFlag:!0,visibleFlag:!1,collapsibleFlag:!0,floatableFlag:!0,verticallyStretchableFlag:!0},e.is(p)&&(k.domId=p),(d=s.create("Panel",k)).close=function(){c.notify("toggleCmdCheckHeaderState",{cmdName:"DisplayProperties",cmdState:!1})},d.immersiveFrame=n,V=n.getDockingElement(d.currentDockArea),e.is(V)&&(V.collapseDockingZoneFlag=!1),m=new t({className:"DisplayPropertiesPanel",typeOfDisplay:i.ALL,selectionType:i.NO_SELECTION,displayType:i.STANDARD,readOnly:!1,extraNotif:!0,editMode:!1,context:{getSecurityContext:function(){return{SecurityContext:r.getSecurityContext()}}},appId:widget.getValue("appId")}),f=(f=r.get3DSpaceUrl()).endsWith("/")?f.substring(0,f.length-1):f,g=r.getTenant(),(D={}).selectedId=r.getReferenceId(M[0]),D.platformUrl=f,D.platformTenant=g,D.getSecurityContext=function(){return r.getSecurityContext()},D.getSelectedRefId=function(){return w()},D.addDocument=function(e,t){u.addDocument(t,{silent:!0}),u.addDocumentConnection(e,t.id,t.relName,{silent:!0}),c.notify("documentAdded",[[e]]),c.notify("documentAttached",{})},D.deleteDocument=function(t,n,i){if(!e.is(i)){const e=u.getConnectedDocumentPIDs(t);Array.isArray(e)&&e.length>0&&(i=e.includes(`SpecificationDocument|${t}|${n}`)?"SpecificationDocument":"PLMDocConnection")}u.removeDocumentConnection(t,n,i),c.notify("documentAttached",{})},o=r.getReferenceModel(w()),e.is(o)&&!o.isProduct()&&(m.addFacets([{require:"DS/DELPPWEnoDocuments/SpecificationsFacet",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"SpecificationDocuments",icon:"doc-log wux-ui-3ds",text:l.getNLSValue("SpecificationsFacet.Specifications")},options:{appContext:D}},{require:"DS/DELPPWEnoDocuments/AttachmentsFacet",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"RelatedDocuments",icon:"attach",text:l.getNLSValue("AttachmentsFacet.Attachments")},options:{appContext:D}}]),1===a.getSelectedNodesCount()&&(S&&o.isResource()&&T(),y&&o.isProcess()&&(F={appContext:D,maturity:r.getModelMaturity(o),title:o.get("PLMEntity.V_Name")},N(F)),x&&o.isSystem()&&(P={modelPID:R()[0]},W(P)))),E&&m.addFacets([{require:"DS/DELPPWTimeAnalysisInfoFacet/facets/TimeAnalysisPropertiesFacet",alwaysVisible:!1,services:["3DSpace"],facet:{name:"TimeAnalysisProperties",icon:"clock-brush wux-ui-3ds",text:l.getNLSValue("TimeAnalysisFacet.Properties")}}]),S&&(b=m.controller.skeleton.getFacetContent("properties"),_=s.getComponent("Button"),e.is(b)&&b.editPropertiesUI.subscribeEvt("editionSwitched",(function(t){L=!1,1===a.getSelectedNodesCount()&&t&&(o=r.getReferenceModel(w()),e.is(o)&&o.isResource()&&(L=!0)),L?A=new _({domId:"ManageResourceExtnBtn",label:l.getNLSValue("ResourceExtension.ManageCapacityResourceExtension"),onClick:I}).inject(widget.getElement(".TopButtonAdd"),"before"):e.is(A)&&A.remove()}))),h&&m.addFacets([{require:"DS/DELWebViewerCommonFacets/Controllers/DELWkiInstructionsFacet",alwaysVisible:!1,position:0,services:["3DSpace"],facet:{name:"work_instructions",text:l.getNLSValue("WKIFacet.RichText"),icon:"fonticon fonticon-book-open"}}]),m.inject(U),C=v(),m.initDatas(C)))},I=function(){r.webServiceGETRequest("resources/DELWebInfrastructure/v0/interface/getImmediateDerivative?Extensions=DELRmiResourceModel/DELCapacityRscAbstract","GET",(function(t){var n=t.security_ctx,i=null,s={serverName:"",serverUri:"",displayType:"editProp_standard",extraNotif:!1,context:null,events:{},tabId:"properties",eventThread:"CT27.properties",dialogTitle:l.getNLSValue("ResourceExtension.ManageCapacityResourceExtension"),jsonClassInterfaces:{interfaces:[]},multiSelect:!1,addOnReference:!1};e.is(t.Data)&&e.is(t.Data.DELCapacityRscAbstract)&&(t.Data.DELCapacityRscAbstract.forEach((e=>{s.jsonClassInterfaces.interfaces.push(e.name)})),m.controller&&m.controller.getModels&&(i=m.controller.getModels()[0])),s.addOnReference=r.isInstance(i.get("objectId")),new o(window.widget,this._parent,s,n,i,(function(){m.controller.onRefresh()}),(function(e){c.warn(e)}))}),(function(){console.warn(l.getNLSValue("ResourceExtension.ResourceExtensionFailure"))}))},R=function(){return a.getSelections().reduce((function(e,t){return e.concat(t)}),[]).map((e=>e.indexOf("|")<0?e:e.substring(e.lastIndexOf("|")+1)))},w=function(){var e=R()[0];return r.getReferenceId(e)},v=function(){return R().map((function(e){return new n({tenant:r.getTenant(),service:"3DSpace",objectId:e})}))},b=function(){var t,n,i,o,c,s,l,u,d=!1,p=!1,f=!1;e.is(m)&&(1===a.getSelectedNodesCount()&&(n=r.getReferenceModel(w()),e.is(n)&&(S&&(n.isResource()&&(d=!0),i=m.elements.UI.getFacetContent("content_section_resource_parameter"),e.is(i)?d||(i.destroyComponent(),m.removeFacets(["content_section_resource_parameter"])):(m.removeFacets(["content_section_resource_parameter"]),d&&T())),y&&(n.isProcess()&&(p=!0),o=m.elements.UI.getFacetContent("content_section_performance_specifications"),s=m.elements.UI.currentFacetName,e.is(o)&&o.destroyComponent(),m.removeFacets(["content_section_performance_specifications"]),p&&(l={appContext:D,maturity:r.getModelMaturity(n),title:n.get("PLMEntity.V_Name")},N(l),"content_section_performance_specifications"===s&&m.selectFacet("content_section_performance_specifications"))),x&&(n.isSystem()&&(f=!0),c=m.elements.UI.getFacetContent("content_section_richtext"),s=m.elements.UI.currentFacetName,e.is(c)&&c.destroyComponent(),m.removeFacets(["content_section_richtext"]),f&&(u={modelPID:R()[0]},W(u),"content_section_richtext"===s&&m.selectFacet("content_section_richtext"))))),t=v(),m.initDatas(t))},L=function(){b()},T=function(){e.is(m)&&m.addFacets([{require:"DS/DELWebInfrastructureControls/DELWebResourceParameter/DELWebResourceParameterFacet",alwaysVisible:!0,services:["3DSpace"],position:0,facet:{name:"content_section_resource_parameter",text:l.getNLSValue("ResourceParameterFacet.ResourceParameters"),icon:"parameters"}}])},N=function(t){e.is(m)&&m.addFacets([{require:"DS/ENOCharacteristicsApp/commands/ShowPerfSpecFacet",alwaysVisible:!0,services:["3DSpace"],position:0,facet:{name:"content_section_performance_specifications",text:l.getNLSValue("ShowPerfSpecFacet.Performances"),icon:"task-list"},options:{appContext:t.appContext,modelInfo:{maturity:t.maturity,title:t.title}}}])},W=function(t){e.is(m)&&m.addFacets([{require:"DS/DELPPWRichTextFacet/DELRichTextFacet",alwaysVisible:!0,services:["3DSpace"],position:0,facet:{name:"content_section_richtext",text:l.getNLSValue("RichTextFacet.RichText"),icon:"pen-lines"},options:{instancePID:r.isInstance(t.modelPID)?t.modelPID:null}}])},{listenTo:function(){return{select:L}},onStart:function(t){S=!!e.is(t.dispalyResourceParameterExtension)&&t.dispalyResourceParameterExtension,y=!!e.is(t.displayShowPerfSpecExtension)&&t.displayShowPerfSpecExtension,x=!!e.is(t.displayRichTextExtension)&&t.displayRichTextExtension,E=!!e.is(t.displayTimeAnalysisFacet)&&t.displayTimeAnalysisFacet,h=!!e.is(t.displayWorkInstructionFacet)&&t.displayWorkInstructionFacet,e.is(t.identifier)&&(p=t.identifier),_(),e.is(d)&&d.show()},onStop:function(){M=[],e.is(d)&&(d.hide(),e.is(m)&&(m.destroyComponent(),m=null),d.destroy(),d=null)}}}}}));