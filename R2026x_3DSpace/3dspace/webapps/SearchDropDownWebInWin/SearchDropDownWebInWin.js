define("DS/SearchDropDownWebInWin/BroadcastWinSearchDropDownManager",["UWA/Class","UWA/Core","UWA/Event","DS/SNInfraUX/Logger","DS/SNInfraUX/SearchPreferences"],(function(e,n,t,o,i){"use strict";return e.extend(t,{init:function(){o.log("BroadcastWinSearchDropDownManager init"),this._BroadcastsearchDropDown=null,this._SearchDropDownPanelMgr=null,this._parent()},setup:function(e){this._BroadcastsearchDropDown&&this._BroadcastsearchDropDown.close(),this._BroadcastsearchDropDown&&delete this._BroadcastsearchDropDown,this._SearchDropDownPanelMgr=e,this._BroadcastsearchDropDown=new BroadcastChannel("searchDropDownWebInWin"),this._parent(e)},destroy:function(){n.is(this._BroadcastsearchDropDown)&&this._BroadcastsearchDropDown.close(),n.is(this._BroadcastsearchDropDown)&&delete this._BroadcastsearchDropDown,this._parent()},getBroadcastsearchDropDown:function(){return this._BroadcastsearchDropDown},postMessage:function(e){let t;n.is(this._BroadcastsearchDropDown)&&(n.is(e)&&(t=e),this._BroadcastsearchDropDown.postMessage(t),o.log("DS/SearchDropDownWebInWin/BroadcastWinSearchDropDownManager postMessage from: ",t))},listenBroadcast:function(){let e=this;n.is(e._BroadcastsearchDropDown)&&n.is(e._SearchDropDownPanelMgr)&&(e._BroadcastsearchDropDown.onmessage=t=>{if(n.is(t)&&n.is(t.data)){o.log("DS/SearchDropDownWebInWin/BroadcastWinSearchDropDownManager onmessage",t.data);const{type:r="",message:a="",value:s=""}=t.data;if("clickOnDropDown"===r)e._SearchDropDownPanelMgr._SearchDropDown2.onBlur(void 0,!0),e._SearchDropDownPanelMgr._SearchDropDown2.eventManager.dispatchEvent("otherCommand",{value:s});else if("applySettings"===r){let t=JSON.parse(s);i.setItem("search_tabbed_ui",t.search_tabbed_ui),i.setItem("search_double_click_open",t.search_double_click_open),i.setItem("revisionDisplayType",t.revisionDisplayType),i.commit(),i.setPreference({name:"optionMode",value:t.value,tenantId:t.tenantId,onComplete:function(){let t=e._SearchDropDownPanelMgr&&e._SearchDropDownPanelMgr._SearchDropDown2;n.is(t)&&n.is(t._SearchDropDownSettings)&&(t.hideSettingPQs(),t._SearchDropDownSettings._initDefaultSettings(),t.onBlur(void 0,!0))},onFailure:function(e){o.error("DS/SearchDropDownWebInWin/BroadcastWinSearchDropDownManager: Failure, Unable to save preferences :",e)}})}}})}})})),window.onload=function(){require(["UWA/Core","UWA/Drivers/Alone","i18n!DS/SNResultUX/assets/nls/SNResultUX.json"],(function(e,n,t){var o=window.document.getElementById("temp-search-msg-span");if(e.is(o)){var i=e.extendElement(o);e.is(i)&&i.setHTML(t.get("webinwin_dropdown_loading"))}}))},define("DS/SearchDropDownWebInWin/SearchDropDownPanelMgr",["UWA/Drivers/Alone","UWA/Core","UWA/Controls/Abstract","UWA/Class/Debug","UWA/Element","UWA/Event","DS/SNInfraUX/Logger","DS/SearchDropDownWebInWin/BroadcastWinSearchDropDownManager","DS/SNSearchResultsCusto/utils/SearchResultsCustomizationPreferences","i18n!DS/SNResultUX/assets/nls/SearchDropDownWebInWin.json"],(function(e,n,t,o,i,r,a,s,c,l){"use strict";return t.singleton(o,{_SearchDropDown2:null,_Broadcast:null,_historyList:null,_embedded:!1,init:function(){a.log("SearchDropDownPanelMgr init"),this._SearchDropDown2=null,this._Broadcast=null,this._historyList=[],this._embedded=!1;let e=window.location.search.substring(1).indexOf("debug_me")>=0;this.setDebugMode(e),this._Broadcast=new s,this._Broadcast.setup(this),this._Broadcast.listenBroadcast()},destroy:function(){this._Broadcast.close(),this._Broadcast&&delete this._Broadcast,this._Broadcast=null,this._parent()},initView:function(e){let t=this;a.log("Inside initView, view Parameters="+JSON.stringify(e));let o={};o[e.active_tenant]={sources:{cstorage:{displayName:e.tenantDisplayName,url:e.cstorageUrl},hpc:{displayName:e.tenantDisplayName,url:""},search:{displayName:e.tenantDisplayName,url:e.url},swym:{displayName:e.tenantDisplayName,url:e.swymurl},tagger:{displayName:e.tenantDisplayName,url:e.cstorageUrl}}},require(["DS/i3DXCompass/i3DXCompass","DS/i3DXCompass/Data","DS/SNInfraUX/SearchRessources","DS/SNInfraUX/SearchLogin","DS/SNInfraUX/Logger","DS/SNInfraUX/Api/SearchApi","DS/SNInfraUX/SearchUtils","DS/SNInfraUX/SecurityContextManager","DS/SNInfraUX/SearchSettings","text!DS/SNResultUX/assets/WebInWin_settings.json"],(function(i,r,a,s,l,d,D,h,p,S){let u=window.location.search.substring(1);if(u.length>0){let e=u.split("&"),n=[];for(var g=0;g<e.length;g++){let t=e[g].split("=");1==t.length?n[t[0]]=!0:2==t.length&&t[0].length>0&&(n[t[0]]=t[1])}p.urlSettings(n)}p.initialize(JSON.parse(S)),n.is(e.userid)&&(D.setUserId(e.userid),l.log("User id set = "+D.getUserId())),n.is(e.securityContext)&&(h.setSecurityContext(e.securityContext),l.log("securityContext id set = "+h.get3DSpaceLoginSC())),n.is(e.cstorageUrl)&&(D.setserverUrl(e.cstorageUrl),l.log("securityContext id set = "+D.getserverUrl())),n.is(r,"object")&&!n.is(r.getPreferencesUrl,"string")&&n.is(window.COMPASS_CONFIG,"object")&&r.initialize({lang:COMPASS_CONFIG.lang,userId:COMPASS_CONFIG.userId,myAppsBaseUrl:COMPASS_CONFIG.myAppsBaseUrl,myAppsBaseUrl:COMPASS_CONFIG.myAppsBaseUrl,platform:e.active_tenant,passportUrl:"",proxyTicketUrl:""}),i.initialize({lang:COMPASS_CONFIG.lang,userId:COMPASS_CONFIG.userId,myAppsBaseUrl:COMPASS_CONFIG.myAppsBaseUrl,passportUrl:"",proxyTicketUrl:"",compassTarget:"SearchDropDown-Compass",appsTarget:"SearchDropDown-Compass"});let _=new a({active_tenant:e.active_tenant,available_tenants:o});s.login({resources:_,onComplete:function(){l.log("Early /federated/login DONE from SearchDropDownPanelMgr.js")},onFailure:function(){l.log("Early /federated/login FAILED from SearchDropDownPanelMgr.js")}}),d.setResourceMgt(_),n.is(e.historyList)&&(t._historyList=e.historyList),p.getTenantSettings(e.active_tenant).then((function(){require(["DS/SNSearchUX/SearchDropDown2"],(function(o){t.addEvent("favoriteSearches",(function(e){let n=JSON.stringify(e);l.log("sendNotificationWebInWin favoriteSearches: ",e),sendNotificationWebInWin("favoriteSearches",n)})),t.addEvent("myContent",(function(e){let n=JSON.stringify(e);l.log("sendNotificationWebInWin myContent: ",e);t._Broadcast.postMessage({type:"clearLocalGrouping",value:"clearLocalGrouping"}),setTimeout((function(){sendNotificationWebInWin("myContent",n)}),200)})),t.addEvent("advancedSearch",(function(e){let n=JSON.stringify(e);l.log("sendNotificationWebInWin advancedSearch: ",e),sendNotificationWebInWin("advancedSearch",n)})),t.addEvent("tabSelected",(function(e){let n=JSON.stringify(e);l.log("sendNotificationWebInWin tabSelected: ",e),sendNotificationWebInWin("tabSelected",n)})),t.addEvent("onPQ",(function(e){let n=JSON.stringify(e);l.log("sendNotificationWebInWin onPQ: ",e),sendNotificationWebInWin("onPQ",n)})),t.addEvent("onViewSearch",(function(e){let n=JSON.stringify(e);l.log("sendNotificationWebInWin Search: ",e),sendNotificationWebInWin("Search",n),t._SearchDropDown2.setFieldValue(e.displayString),e.displayString.length>=3&&t._SearchDropDown2.switchActiveTabinstantSearchTab(e.displayString,!0)})),t.addEvent("applySettings",(function(e){let n={type:"applySettings",value:JSON.stringify(e)};t._Broadcast.postMessage(n),l.log("sendNotificationWebInWin applySettings: ",e),sendNotificationWebInWin("applySettings",{applySettings:"applySettings"})})),t.addEvent("doubleclickopen",(function(e){l.log("sendNotificationWebInWin doubleclickopen: ",e),sendNotificationWebInWin("doubleclickopen",e.value)})),t.addEvent("removeHistory",(function(e){l.log("sendNotificationWebInWin removeHistory: ",e),sendNotificationWebInWin("removeHistory",e.value)})),t.addEvent("clearHistory",(function(e){l.log("sendNotificationWebInWin clearHistory: ",e),!0===e&&(t._historyList=[]),sendNotificationWebInWin("clearHistory",e)})),t.addEvent("displayClearHistory",(function(){l.log("sendNotificationWebInWin displayClearHistory: "),sendNotificationWebInWin("blockDisplay")})),t.addEvent("onClickBeta",(function(){l.log("sendNotificationWebInWin onClickBeta"),sendNotificationWebInWin("blockDisplay")})),t.addEvent("onGuidedMode",(function(e){l.log("sendNotificationWebInWin onGuidedMode"),sendNotificationWebInWin("onGuidedMode",e)})),t.addEvent("onClickBetaModal",(function(e){l.log("sendNotificationWebInWin onClickBetaModal: ",e),sendNotificationWebInWin("onClickBetaModal",e)})),t.addEvent("otherCommand",(function(e){let n=JSON.stringify(e);sendNotificationWebInWin("blockDisplay",!1),l.log("sendNotificationWebInWin otherCommand: ",n),sendNotificationWebInWin("otherCommandClick",n)})),t.addEvent("Searchfieldenable",(function(e){l.log("sendNotificationWebInWin Searchfieldenable"),sendNotificationWebInWin("Searchfieldenable",e)})),t.addEvent("set_title_only_search",(function(e){let n={type:"set_title_only_search",value:e.is_title_only};t._Broadcast.postMessage(n)}));let r=n.extendElement(document.body).getElement("#SearchDropDown-content"),a="SearchDropDown-view";!0===c.isBETAEnabled()&&(a+=" BETA-Customization");let s=n.createElement("div",{id:"SearchDropDown-view",class:a}).inject(r);t._SearchDropDown2=new o({eventManager:t,SimilarSearch:!(!n.is(e.otherMenu)||!n.is(e.otherMenu.SimilarSearch))||void 0,PartSupply:!(!n.is(e.otherMenu)||!n.is(e.otherMenu.PartSupply))||void 0,Relations:!(!n.is(e.otherMenu)||!n.is(e.otherMenu.Relations))||void 0}).inject(s),t._SearchDropDown2.collection._isCategoryHelperCollection=!0,t._SearchDropDown2.initSources(_),t._SearchDropDown2.maxResultDisplayedMyContent=3,t._SearchDropDown2.getHistoryListFromLocalStorage=function(){return l.log("getHistoryListFromLocalStorage historyList : ",e.historyList),n.is(t._historyList)&&t._historyList.length&&(t._SearchDropDown2.noSearchLaunch=!1),t._historyList},t._SearchDropDown2.displayClearHistoryModal=function(){t._displayClearHistoryModal()};let d=n.clone(t._SearchDropDown2.removeHistoryFromLocalStorage);t._SearchDropDown2.removeHistoryFromLocalStorage=function(e){d.call(t._SearchDropDown2,e),this.eventManager.dispatchEvent("removeHistory",localStorage.SNSearchBoxStore)},t._SearchDropDown2.removeHistoryElement=function(e,o){let i=e.getParent().getText();if(n.is(t._historyList)&&t._historyList.length){const e=t._historyList.indexOf(i);e>-1&&t._historyList.splice(e,1)}0==t._historyList.length&&(t._historyList=[]);let r=t._historyList;this.eventManager.dispatchEvent("removeHistory",{value:r}),t._SearchDropDown2.refreshHistoryList()},t._SearchDropDown2._onClickApp=function(e){i.getAppInfo({appId:e.currentTarget.id,onComplete:function(e){if(e){let n=JSON.stringify(e);l.log("sendNotificationWebInWin onClickApp: ",e),sendNotificationWebInWin("onClickApp",n)}}})},t.addEvent("OnApplication",(function(e){l.log("sendNotificationWebInWin OnApplication: ",e),sendNotificationWebInWin("OnApplication",JSON.stringify(e))})),t.onFocus(),t._SearchDropDown2.refreshHistoryList(),t._initOtherSettings();var D=window.document.getElementById("temp-search-msg");if(n.is(D)){var h=n.extendElement(D);n.is(h)&&D.destroy()}setTimeout((function(){const e=document.getElementById("SearchDropDown-Compass");e&&e.remove()}),2500)}),(function(e){console.error("Cannot load view: "+e.requireModules)}))}))}))},onFocus:function(e){let t=this;a.log("SearchDropDownPanelMgr:onFocus"),n.is(e)&&n.is(e.inputvalue)&&t._SearchDropDown2&&t._SearchDropDown2.setInputValue(e.inputvalue),n.is(e)&&n.is(e.lastsearch)&&"true"===e.lastsearch?sendNotificationWebInWin("blockDisplay",!1):(n.is(e)&&n.is(e.historyList)&&(t._historyList=e.historyList),n.is(e)&&n.is(e.embedded)&&(t._embedded="true"==e.embedded),n.is(e)&&n.is(e.bInContextSearchActivatedInX2A)&&(t._SearchDropDown2._Isx2aIncontext=e.bInContextSearchActivatedInX2A),t._SearchDropDown2&&t._SearchDropDown2.onFocus(),t._SearchDropDown2&&t._SearchDropDown2.refreshHistoryList(),n.is(t._SearchDropDown2)&&t._SearchDropDown2.eventManager.dispatchEvent("onGuidedMode",!0),n.is(e)&&n.is(e.incontext)&&t._SearchDropDown2&&t._SearchDropDown2.setInContextMode("true"===e.incontext),setTimeout((function(){let e=JSON.stringify({displayString:"",query:""});sendNotificationWebInWin("Search",e)}),200))},onClearSearch:function(){let e=this;a.log("SearchDropDownPanelMgr:onClearSearch"),n.is(e._SearchDropDown2)&&(e._SearchDropDown2._setInternalCriteria(null),e._SearchDropDown2.resetSearchField(""),e._SearchDropDown2.hideSettingPQs())},onKeyUp:function(e){let t=this;if(a.log("SearchDropDownPanelMgr:onKeyUp"),!n.is(t._SearchDropDown2)||!n.is(e)||!n.is(e.value))return;let o={srcElement:{value:e.value}};t._SearchDropDown2.setInputValue(e.value),t._SearchDropDown2.onKeyUp(o)},onBlur:function(e){a.log("SearchDropDownPanelMgr:onBlur"),n.is(this._SearchDropDown2)&&this._SearchDropDown2.onBlur(null,!0)},_initOtherSettings:function(){let e=this;a.log("SearchDropDownPanelMgr:_initOtherSettings: "),n.is(e._SearchDropDown2)&&n.is(e._SearchDropDown2.elements.settingsContainer)&&(n.is(e._SearchDropDown2.elements.setting_2_1)||(e._SearchDropDown2.elements.setting_2_1=i.create("div",{class:"setting-container dbl-clk"}).inject(e._SearchDropDown2.elements.settingsContainer),e._SearchDropDown2.elements.settingContainer_2_1=i.create("div",{class:"option-container"}).inject(e._SearchDropDown2.elements.setting_2_1),e._SearchDropDown2.elements.settingCheckbox_2_1=i.create("input",{class:"settings-instant-search-checkbox",type:"checkbox"}).inject(e._SearchDropDown2.elements.settingContainer_2_1),e._SearchDropDown2.elements.settingCheckbox_2_1.addEvent("click",function(e){if(n.is(e)&&n.is(e.target)){let n=e.target.checked;this.eventManager&&this.eventManager.dispatchEvent("doubleclickopen",{value:n})}}.bind(e._SearchDropDown2)),e._SearchDropDown2.elements.settingTitle_2_1=i.create("span",{class:"settings-instant-search-title",text:l.get("search_double_click_open")}).inject(e._SearchDropDown2.elements.settingContainer_2_1)))},_displayClearHistoryModal:function(){let e=this;a.log("SearchDropDownPanelMgr:_displayClearHistoryModal"),n.is(e._SearchDropDown2)&&require(["DS/SNResultUX/utils/ExternalComponentHelpers"],(function(n){n.modal({title:l.get("search.history.delete.title"),content:l.get("search.history.delete.message"),CB:[{buttonKind:"ok",label:l.get("search.history.delete.confirm"),function:()=>{e._historyList=[],e._SearchDropDown2.eventManager.dispatchEvent("clearHistory",!0),setTimeout((function(){e._SearchDropDown2.clearHistoryFromLocalStorage()}),100),n.destroyModal()}},{buttonKind:"cancel",function:()=>{e._SearchDropDown2.noBlur=!1,e._SearchDropDown2.setFocus(),e._SearchDropDown2.eventManager.dispatchEvent("clearHistory",!1),n.destroyModal()}}]}),e._SearchDropDown2.eventManager.dispatchEvent("displayClearHistory")}))}})}));