var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernelTools/VCXAnalyticsTrackerBaseManager",["require","exports","DS/Usage/TrackerAPI","DS/Visualization/ThreeJS_DS","DS/VCXWebComponents/VCXWebComponentBaseExperience"],(function(e,t,n,r,a){"use strict";a=__importDefault(a);class i extends a.default{NewClock(){return new r.Clock}getApplicationId(){return""}isString(e){return"string"==typeof e||e instanceof String}isNumber(e){return"number"==typeof e&&isFinite(e)}isObject(e){return e&&"object"==typeof e&&e.constructor===Object}checkPdPv(e,t){var n=!0;if(!this.isObject(e))return!1;if(0==Object.keys(e).length)return!1;if(Object.keys(e).length>20)return!1;for(var r in e)e.hasOwnProperty(r)&&/^(pd|pv)[0-9]+$/.test(r)?t&&!this.isString(e[r])?(n=!1,e[r]=String(e[r]),console.warn("[Analytics] "+r+" is has a wrong type ! it need to be a string")):t||this.isNumber(e[r])||(n=!1,delete e[r],console.warn("[Analytics] "+r+" is has a wrong type ! it need to be a number")):n=!1;return n}trackEvent({eventCategory:e="",eventAction:t="",eventLabel:r="",eventValue:a,persDim:i,persVal:o}={}){var c=this.getApplicationId();c&&(i&&!this.checkPdPv(i,!0)&&console.warn("[Analytics] Something went wrong with your persDim : "+t+" "+e+" "+r),o&&!this.checkPdPv(o,!1)&&console.warn("[Analytics] Something went wrong with your persVal : "+t+" "+e+" "+r),i||(i={}),o||(o={}),this.fillDefaultInformationsPvPd(i,o),n.trackPageEvent({eventCategory:e,eventAction:t,eventLabel:r,eventValue:a,appID:c,tenant:window.widget&&window.widget.getValue("x3dPlatformId"),persDim:i,persVal:o}))}postInitialize(){}unInitialize(){}}return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXAnalyticsTrackerBaseManager"}}),i}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernelTools/VCXWidgetHelper",["require","exports","DS/VCXWebPlatform/VCX3DSpaceServices","DS/VCXWebPlatform/VCXPlatformServices"],(function(e,t,n,r){"use strict";n=__importDefault(n),r=__importDefault(r);return class{static async generateItemMRU(){if(!widget.getValue("MRUData"))return[];let e=[];const t=await n.default.Get3DSpaceURL();let a=JSON.parse(widget.getValue("MRUData")),i=a.arrayRecentExperiences;for(let n=0;n<i.length;n++){const o=i[n],c=t&&i&&await r.default.getObjectInfo(o,t);c&&e.push({id:o,title:c?.dataelements?.title??"Error",image:c?.dataelements?.image??"",modified:new Date(a[o])})}return e}}})),define("DS/VCXWebKernelTools/VCXAnalyticsTrackerAppManager",["require","exports","DS/CoreEvents/Events","DS/VCXWebKernelTools/VCXAnalyticsTrackerBaseManager"],(function(e,t,n,r){"use strict";class a extends r{constructor(){super(...arguments),this._WUXEventTokens={}}postInitialize(){var e=this._experienceBase.getManager("VCXContextManager"),t="/WUX/AFR/CMD/"+(e&&e.getContext());this._WUXEventTokens.onCommandBegin=n.subscribe({event:t+"/BEGIN"},(e=>{this.trackStartCmdEvent(e?.options?.ID)}))}unInitialize(){for(var e in this._WUXEventTokens)this._WUXEventTokens.hasOwnProperty(e)&&this._WUXEventTokens[e]&&(n.unsubscribe(this._WUXEventTokens[e]),this._WUXEventTokens[e]=null)}getApplicationId(){let e="";this._experienceBase&&(this._experienceBase.getManager("VCXContextManager").getContextFromName("ProdHighMode")&&(e="XCTXPR_AP"));return e}fillDefaultInformationsPvPd(e,t){let n=this._experienceBase?.getManager("VCXEWSManager")?.getExperiencePhysicalProduct();n?e.pd20=n:console.warn("No experience physical product found")}trackImport3dxmlEvent(e,t,n){const r=(n/1048576).toFixed(1);const a={eventCategory:e,eventAction:"import3dxml",eventLabel:"import3dxml",persDim:{pd1:String(t)},persVal:{pv1:Number(r)}};this.trackEvent(a)}trackNewPresentationEvent(e){const t={eventCategory:e,eventAction:"NewPresentation",eventLabel:"NewPresentation"};this.trackEvent(t)}trackNewSceneFromScratchEvent(){this.trackEvent({eventCategory:"xH_NewScene",eventAction:"NewSceneFromScratch"})}trackNewSceneCaptureSceneEvent(){this.trackEvent({eventCategory:"xH_NewScene",eventAction:"CaptureScene"})}trackRecoverPresentationEvent(e,t){const n={eventCategory:e,eventAction:"Recover",eventLabel:"Recover",persDim:{pd1:String(t)}};this.trackEvent(n)}trackOpenPresentationEvent(e){const t={eventCategory:e,eventAction:"OpenPresentation",eventLabel:"OpenPresentation"};this.trackEvent(t)}trackLaunchJobMonitor(e){const t={eventCategory:e,eventAction:"OpenJobMonitor",eventLabel:"OpenJobMonitor"};this.trackEvent(t)}trackGraphicCards(e){const t={eventCategory:"xH_UserHw",eventAction:"graphicCard",eventLabel:"graphicCard",persDim:{pd1:e||""}};this.trackEvent(t)}trackStartCmdEvent(e){const t={eventCategory:"xH_Commands",eventAction:"startCommand",eventLabel:"startCommand",persDim:{pd1:e}};this.trackEvent(t)}trackSkipGuidedTour(e,t){const n={eventCategory:"xH_GuidedTour",eventAction:"SkipGuidedTour",eventLabel:"SkipGuidedTour",eventValue:t,persVal:{pv1:e}};this.trackEvent(n)}trackCompletedGuidedTour(e){const t={eventCategory:"xH_GuidedTour",eventAction:"CompletedGuidedTour",eventLabel:"CompletedGuidedTour",persVal:{pv1:e}};this.trackEvent(t)}trackStopGuidedTour(e){const t={eventCategory:"xH_GuidedTour",eventAction:"StopGuidedTour",eventLabel:"StopGuidedTour",persVal:{pv1:e}};this.trackEvent(t)}trackTimeAndRatioLPR(e,t){const n={eventCategory:"LPR",eventAction:"StartingTimeAndRatio",eventLabel:"StartingTimeAndRatio",eventValue:e,persVal:{pv1:t.height,pv2:t.width}};this.trackEvent(n)}trackPublishImage(e,t,n,r,a){const i={eventCategory:"publish",eventAction:"click",eventLabel:"publish.rasterimage",eventValue:e,persDim:{pd1:t,pd2:n},persVal:{pv1:r,pv2:a}};this.trackEvent(i)}trackPublishImageGI(e,t,n,r,a,i,o,c){const s={eventCategory:"publish",eventAction:"click",eventLabel:"publish.raytracingimage",persDim:{pd1:t,pd2:n,pd3:e,pd4:r,pd5:String(a),pd6:String(i)},persVal:{pv1:o,pv2:c}};this.trackEvent(s)}trackPublishVideo(e,t,n,r){const a={eventCategory:"publish",eventAction:"click",eventLabel:"publish.video",eventValue:e,persDim:{pd1:t,pd2:n,pd3:r}};this.trackEvent(a)}trackComputeVecto(e){const t={eventCategory:"compute",eventAction:"click",eventLabel:"compute.vecto",eventValue:e};this.trackEvent(t)}trackPublishVecto(){this.trackEvent({eventCategory:"publish",eventAction:"click",eventLabel:"publish.vecto"})}trackPublishImageGLTF(){this.trackEvent({eventCategory:"publish",eventAction:"click",eventLabel:"publish.gltf"})}trackPublishImageDSXM(e){const t={eventCategory:"publish",eventAction:"click",eventLabel:"publish.dsxm",persDim:{pd1:e.textureCompression,pd2:String(e.isDraftSwymm),pd3:String(e.onWhatNew),pd4:String(e.typeSwymm),pd5:e.destination,pd6:String(e.immersiveNav),pd7:String(e.showCanvas),pd8:String(e.autplay),pd9:String(e.optimization)}};this.trackEvent(t)}trackSaveExperience(){if(!this._experienceBase)return;let e=this._experienceBase.GetActiveChild();if(e||(e=this._experienceBase),e){const t=e.ComponentsMap,n=t.GetComponentFromType("VCXScenario").length,r=t.GetComponentFromType("Model_VPMReference_Spec").length,a=t.GetComponentFromType("VCXComponentOccurrenceComposer").length-r,i=t.GetComponentFromType("CXPCameraActor_Spec").length,o=t.GetComponentFromType("VCXViewport_Spec").length,c=t.GetComponentFromType("VCXSection_Spec").length,s=t.GetComponentFromType("VCXRedLine_Spec").length,p=t.GetComponentFromType("VCXPolyline_Spec").length,v=t.GetComponentFromType("VCXMagnetLine_Spec").length,l={eventCategory:"dataStats",eventAction:"save",eventLabel:"Experience data stats (during save)",persVal:{pv1:n,pv2:r,pv3:a,pv4:i,pv5:o,pv6:c,pv7:s,pv8:p,pv9:t.GetComponentFromType("VCXMarkup_Spec").length,pv10:t.GetComponentFromType("VCXArrow_Spec").length,pv11:t.GetComponentFromType("VCXCompass_Spec").length,pv12:t.GetComponentFromType("VCXCircle_Spec").length,pv13:t.GetComponentFromType("AmbienceModel_Spec").length,pv14:t.GetComponentFromType("VCXDigger_Spec").length,pv15:this._experienceBase.getManager("VCXMaterialManager").getMaterials().length,pv16:v}};this.trackEvent(l);const u=this._experienceBase.getManager("VCXContextManager").getActiveViewport(),g=u?.QueryInterface("VCXIModifiable"),d=g?.GetPropertyValue("Environment.SSAO"),m=g?.GetPropertyValue("Environment.AA"),h={eventCategory:"visuStats",eventAction:"save",eventLabel:"Experience visu stats (during save)",persVal:{pv1:d,pv2:m}};this.trackEvent(h)}}trackActionsLPR(e){const t={eventCategory:"LPR",eventAction:"TrackUpdateServer",eventLabel:"Experience data stats (during LPR)",persVal:{pv1:e.visibility_actor,pv2:e.update_current_ambience,pv3:e.update_viewport,pv4:e.update_ground,pv5:e.update_paper,pv6:e.update_varpos_actor,pv7:e.update_root}};this.trackEvent(t)}trackReframeCanvas(){this.trackEvent({eventCategory:"Canvas",eventAction:"click",eventLabel:"Reframe Canvas"})}trackSinglePanel(e){const t={eventCategory:"Panels",eventAction:"click",eventLabel:e};this.trackEvent(t)}trackStackingPanel(e){const t={eventCategory:"Panels Stacking",eventAction:"click",eventLabel:e};this.trackEvent(t)}}return Object.defineProperty(a.prototype,"componentType",{enumerable:!0,get:function(){return"VCXAnalyticsTrackerAppManager"}}),a}));