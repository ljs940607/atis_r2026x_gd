define("DS/XCADLoader/XCADModelLoaderPlug",["DS/XCADLoader/IModelLoaderPlug","DS/XCADLoader/XCADLoader","DS/XCADSTEPDocument/STEPInputDocument","DS/XCADSTPDocument/STPInputDocument","DS/XCADSTPZDocument/STPZInputDocument","DS/XCADSTPXDocument/STPXInputDocument","DS/XCADSTPXZDocument/STPXZInputDocument","DS/XCADSTPADocument/STPAInputDocument","DS/XCADSTLDocument/STLInputDocument","DS/XCADIFCDocument/IFCInputDocument","DS/XCADIFCZIPDocument/IFCZIPInputDocument","DS/CoreEvents/Events"],(function(e,t,n,o,r,u,i,c,l,D,p,a){"use strict";var d=2,s=1,A=!1,v=!1,S=new function(e){let t=new Array(e),n=0,o=0,r=!1;this.addValue=function(e,u){r&&n!=t.length&&n++,n==t.length&&(n=0),r&&n==o&&o++,o==t.length&&(o=0),t[n]={x:e,y:u},r=!0},this.findValue=function(e){let u=o,i=0;for(o>n||n==t.length-1?i=t.length:r&&(i=n-o+1);0!=i;){if(null!=t[u]&&e==t[u].x)return t[u].y;u++,u==t.length&&(u=0),i--}return null}}(3),C=function(){this.converter=null;var e=this;a.subscribe({event:"3DPLAY/EXPLODE/START"},(function(t){e.hideAllAnnot(),A=!0})),a.subscribe({event:"3DPLAY/EXPLODE/END"},(function(t){A=!1,e.showAllAnnot()})),a.subscribe({event:"/Default/3DPLAY/HIDE"},(function(e){v=e.data.length>0})),a.subscribe({event:"/Default/3DPLAY/SHOW_ALL"},(function(e){v=!1})),a.subscribe({event:"/VISU/"},(function(t){!1===v&&("@onViewpointBeginMove"==t.eventType?e.hideAllAnnot():"@onViewpointEndMove"==t.eventType&&(A||e.showAllAnnot()))}))};return(C.prototype=Object.create(e)).isManagedType=function(e){var t=e.toUpperCase()+"InputDocument";return"cgr"!=e&&("obj"==e&&(t="XCAD"+e.toUpperCase()+"InputDocument"),void 0!==require("DS/XCAD"+e.toUpperCase()+"Document/"+t))},C.prototype.showAllAnnot=function(){var e=window.debugWebGLV6Viewer;if(null!=e&&(void 0===e.endLoaded||null!=e.endLoaded&&1==e.endLoaded)){var t=e.getRootNode().getChildrenByName("3DPlay_XCAD_Annotation");if(null!=t){for(var n=0;n<t.length;n++)t[n].setVisibility(!0);e.render()}}},C.prototype.hideAllAnnot=function(){var e=window.debugWebGLV6Viewer;if(null!=e){var t=e.getRootNode().getChildrenByName("3DPlay_XCAD_Annotation");if(null!=t){for(var n=0;n<t.length;n++)t[n].setVisibility(!1);e.render()}}},C.prototype.isSuppotedStep=async function(e){let t=!1;return null!=e&&(t=await async function(e){let t=!1;try{const n=await fetch(e);if(!n.ok)throw new Error(n.statusText);const o=await n.text();return S.addValue(e,o),null!=o.match(/#\d*=TESSELLATED_SHAPE_REPRESENTATION/)&&(t=!0),t}catch(e){throw console.error(e),e}}(e)),t},C.prototype.loadModel=function(e,n,o,r,u,i,c,l,D,p,a,A,v){var C=e.toUpperCase()+"InputDocument";"obj"==e&&(C="XCAD"+e.toUpperCase()+"InputDocument");var h=require("DS/XCAD"+e.toUpperCase()+"Document/"+C);if(void 0===h)return!1;window.debugWebGLV6Viewer.endLoaded=void 0;var f=S.findValue(r);null===f&&(f=v),null===this.converter&&(this.converter=new t);var m=new h;return"stpz"==e?(m.zipped=!0,m.zipMethod=d):"stpx"==e?m.sceneGraph=a:"stpxz"==e?m.zipped=!0:"stpa"==e?(m.zipped=!0,m.zipMethod=s):m.zipped="ifczip"==e,m.spec=A,m.url=r,this.converter.load(m,r,u,i,c,l,a,m.zipped,m.requestResponseType,A,f),m=null,!0},C.prototype.getProductStructure=function(e,n,o,r){var u=e.toUpperCase()+"InputDocument";"obj"==e&&(u="XCAD"+e.toUpperCase()+"InputDocument");var i=require("DS/XCAD"+e.toUpperCase()+"Document/"+u);if(void 0===i)return!1;var c=n;null===this.converter&&(this.converter=new t);var l=new i;let D;return l.zipped=!1,l.spec=void 0,l.url=void 0,D=null!=o?this.converter.getProductStructureAsJson(l,c,r):this.converter.getProductStructure(l,c,r),l=null,D},C}));