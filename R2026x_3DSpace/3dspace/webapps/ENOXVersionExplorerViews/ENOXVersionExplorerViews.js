define("DS/ENOXVersionExplorerViews/NodeDropdownMenu",["DS/UIKIT/DropdownMenu","DS/TreeModel/TreeNodeModel","DS/Menu/ContextualMenu","WebappsUtils/WebappsUtils","css!DS/ENOXVersionExplorerViews/styles/NodeDropdownMenu"],(function(e,t,i,o){"use strict";var n={},s=!0,r=function(e){var t=e.dropdownContainer;void 0!==n.menuId&&(t["wux-data-contextual"]&&i.removeEventListener(t,n.menuId),n.menuId=void 0)};return{displayNodeDropdownMenu:function(e){var o=this,l=e.treeNode,a=e.target,d=e.menuList,c=(e.position,e.dropdownContainer);if(!(l instanceof t||Array.isArray(l)))throw Error("NodeDropdownMenu.displayNodeDropdownMenu:incorrect data to display dropdown menu");var u=!1;!0===o.options.useIcons&&(u=!0),n.nodeView=a,n.data=l,n.dat=e,s=!0,r(e),n.menuId=i.addEventListener(c,{callback:function(e){console.log(e),s=!1;for(var t=[],i=0;i<d.length;i++){var l=d[i];l.fonticon&&"string"==typeof l.fonticon&&(l.fonticon={content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+l.fonticon,family:WUXManagedFontIcons.Font3DS}),!0!==u?null!=l.fonticon&&(l.icon=void 0):null!=l.icon&&(l.fonticon=void 0),"divider"===l.id?t.length>0&&"SeparatorItem"===t[t.length-1].type||t.push({type:"SeparatorItem"}):l.submenu&&0!==l.submenu.length?t.push({type:"PushItem",title:l.text,fonticon:l.fonticon,icon:l.icon,id:l.id,state:l.disabledItem?"disabled":"enabled",submenu:l.submenu}):t.push({type:"PushItem",accelerator:l.accelerator,title:l.text,fonticon:l.fonticon,icon:l.icon,id:l.id,state:l.disabledItem?"disabled":"enabled",action:{callback:function(e){var t=e.context.item;"function"==typeof t.event.pubfn?t.event.pubfn(n.data):"string"==typeof t.event&&o["function"==typeof o.publishEvent?"publishEvent":"publish"]({event:t.event,data:n.data})},context:{data:n.data,item:l}}})}return o.options._isODT&&setTimeout((function(){for(var e=[],t=0;t<n.dat.menuList.length;t++){var i=n.dat.menuList[t];"divider"!==i.id&&e.push(i.id)}for(var o=document.getElementsByClassName("wux-menu-overlap"),s=0;s<o.length;s++){var r=o[s].dataset;if(r.hasOwnProperty("wuxMenuItemUid")){var l=parseInt(r.wuxMenuItemUid);l<e.length&&(o[s].id=e[l])}}}),100),r(n.dat),t}}),setTimeout((function(){if(s){var e=n.dat.position.x,t=n.dat.position.y,i=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,view:window,buttons:2,clientX:e,clientY:t});n.dat.dropdownContainer.dispatchEvent(i)}}),200)}}})),define("DS/ENOXVersionExplorerViews/VersionExplorerModal",["UWA/Core","DS/ENOFloatingPanel/ENOFloatingPanel","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerView","i18n!DS/UIKIT/assets/nls/UIKIT"],(function(e,t,i,o){"use strict";return{_dlg:void 0,_dlgDiv:void 0,footerStyle:{none:1,okCancel:2},_closeDlg:function(){if(this._dlg){for(var e=this._dlgDiv.getChildren(),t=e.length,i=0;i<t;i++)this._dlgDiv.remove(e[i]);this._dlg.destroy(),this._dlg=void 0,this._dlgDiv=void 0,this.options&&"function"==typeof this.options.onCloseDlg&&this.options.onCloseDlg()}},displayDialog:function(n){var s=this;s._dlgDiv&&s._dlg&&s._closeDlg(),s._dlgDiv=e.createElement("div",{styles:{width:"100%",height:"100%",overflow:"hidden"}});var r=n.okButtonLabel?n.okButtonLabel:o.ok,l=n.cancelButtonLabel?n.cancelButtonLabel:o.ko;n.className="version-explorer-modal"+("string"==typeof n.className&&n.className.length?" "+n.className:"");var a=e.merge(n,{body:s._dlgDiv,closable:!0,animate:!0,resizable:!0,autocenter:!0,visible:!0,limitParent:!0,footer:n.footerStyle===s.footerStyle.okCancel?'<button type="button" class="btn btn-primary _BTN_OK">'+r+'</button> <button type="button" class="btn btn-default _BTN_CANCEL">'+l+"</button>":void 0,overlay:!0===n.modal,events:{onClose:s._closeDlg.bind(s)},onOK:function(){},onCancel:function(){},title:n.dlgTitle?n.dlgTitle:i.VersionExplorer});s._dlg=new t(a),s._dlg.elements.body.setStyle("padding","0"),n.parentContainer=n.parentContainer||e.extendElement(document.body),s._dlg.inject(n.parentContainer),s._dlgDiv.setContent(n.globalDiv),s._dlg.elements.footer&&(s._dlg.elements.footer.getElement("button._BTN_OK").addEvent("click",(function(e){n.onOK(e),s._closeDlg()})),s._dlg.elements.footer.getElement("button._BTN_CANCEL").addEvent("click",(function(e){s._closeDlg(),n.onCancel(e)}))),n.showMaximized&&s._dlg.maximize(),n.position&&n.position.clientX&&n.position.clientY&&(s._dlg.elements.container.setStyles({top:n.position.clientY.toString()+"px",left:n.position.clientX.toString()+"px"}),s._dlg.initialClient=s._dlg._getCurrentClientPosition(n.position)),this.options=n},setTitle:function(e){void 0!==this._dlg&&this._dlg.setTitle(i.VersionExplorer+("string"==typeof e&&e.length?" - "+e:""))},changeFooterStyle:function(){void 0!==this._dlg&&that._dlg.elements.footer}}})),define("DS/ENOXVersionExplorerViews/NewRevisionDialog",["DS/UIKIT/Form","DS/UIKIT/SuperModal","i18n!DS/ENOXVersionExplorerViews/assets/nls/NewRevisionDialog","css!DS/ENOXVersionExplorerViews/styles/NewVersionDialog"],(function(e,t,i){"use strict";return{displayDialog:function(o){if(!o.derivedFrom||!o.derivedFrom.name||!o.derivedFrom.id)throw Error("derived From Name or ID cannot be null");if("string"!=typeof o.defaultName||!o.defaultName.length)throw Error("Default Name cannot be null");var n=[{type:"text",label:i.revTitle,required:!1,value:o.defaultName||"",name:"newVersionName"},{type:"textarea",label:i.description,required:!1,name:"newVersionDescription"},{type:"text",label:i.derivedFrom,required:!1,disabled:!0,value:o.derivedFrom.name,name:"newVersionBasedOn"}],s=new e({fields:n,className:"newVersionDialog"});new t({renderTo:o.parentContainer||document.body,className:"newVersionSuperModal"}).dialog({title:o.title||i.newRevision,body:s.elements.container,buttons:[{className:"primary",value:i.create,action:function(e){var t=s.getValue("newVersionName"),i=s.getValue("newVersionDescription");e.hide(),o.onOK(t,i)},name:"buttonOK"},{className:"default",value:i.cancel,action:function(e){e.hide()},name:"buttonCancel"}]}),s.getField("newVersionDescription").focus()}}})),define("DS/ENOXVersionExplorerViews/VersionExplorerToolbar",["UWA/Core","DS/UIKIT/Iconbar","DS/ENOXVersionExplorerThumbnailGraphView/TreeDocGraphViewSync","DS/ENOXVersionExplorerUtils/ArrayFunctions","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/UIKIT/SuperModal","DS/WebappsUtils/WebappsUtils","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerToolbar","css!DS/ENOXVersionExplorerViews/styles/VersionExplorerToolbar"],(function(e,t,i,o,n,s,r,l,a){return t.extend({_versionExplorerController:void 0,init:function(t){var r=this;for(var l in r._versionExplorerController=t.versionExplorerController,r.versionExplorerView=t.versionExplorerView,r.customizeToolbarHash=r._versionExplorerController.options.customizeToolbarHash,arr=[],i.OrientationMode)arr.splice(i.OrientationMode[l],0,l);this._circularArray=new o.CircularArray(arr);var d=this,c=n.UserSettings.thumbnailGraphLayout;if(isNaN(c))for(var l in s.THUMBNAIL_GRAPH_LAYOUT)if(s.THUMBNAIL_GRAPH_LAYOUT[l]===c){c=l;break}if(e.extend(t,{className:"versionexplorer-iconbar",items:[{fonticon:"select-on",text:a.multiSelect,id:"menuMultiSelect"},{fonticon:"",text:a.multiSelect,id:"multiSelectCounter"},{fonticon:"open-down",text:"",id:"menuMultiSelectDropdown"},{fonticon:"graph-egraph-down "+c,text:a[c],id:"graphViewDropDown",content:{type:"icondropdown",options:{items:[{selected:"ROOT_ON_RIGHT"===c,fonticon:"graph-egraph-down ROOT_ON_RIGHT",description:a.ROOT_ON_RIGHT,id:"ROOT_ON_RIGHT"},{selected:"ROOT_ON_LEFT"===c,fonticon:"graph-egraph-down ROOT_ON_LEFT",description:a.ROOT_ON_LEFT,id:"ROOT_ON_LEFT"},{selected:"ROOT_ON_BOTTOM"===c,fonticon:"graph-egraph-down ROOT_ON_BOTTOM",description:a.ROOT_ON_BOTTOM,id:"ROOT_ON_BOTTOM"},{selected:"ROOT_ON_TOP"===c,fonticon:"graph-egraph-down",description:a.ROOT_ON_TOP,id:"ROOT_ON_TOP"}],events:{onClick:function(e,t){document.getElementById("graphViewDropDown").getChildren()[0].className=t.elements.container.getChildren()[0].className,d.versionExplorerView.setThumbnailGraphLayout(t.elements.container.id);var i=d.menu.items.find((function(e){return"graphViewDropDown"===e.id}));i&&(i.text=t.description,i.tooltip.setBody(i.text))}}}}},{fonticon:"arrow-double-combo",text:a.zoomToFit,id:"menuZoomToFit"},{fonticon:"map-navigation",text:a.toggleOverview,id:"menuToggleOverview"},{fonticon:"cog",text:a.settings,id:"menuSettings"},{className:"divider",id:"divider"},{fonticon:"help",text:a.help,id:"menuToggleHelp"},{fonticon:"reload",text:a.refresh,id:"menuRefresh"},{fonticon:"legend-eye",text:a.toggleOverview,text:a.legend,id:"menuToggleLegend"},{fonticon:"graph-egraph",text:a.displayThumbnailView,id:"menuDisplayThumbnailView",content:{type:"icondropdown",options:{items:[{selected:!0,fonticon:"graph-egraph selected",id:"DisplayThumbnailView",description:a.displayThumbnailView},{fonticon:"graph-egraph-list ",id:"DisplaySubwayListView",description:a.displaySubwayListView}],events:{onClick:function(e,t){t.elements.container.className="item ",this.elements.container.getChildren()[0].className="item selected",d.setView("menu"+t.id,!0)}}}}},{fonticon:"graph-egraph-list",text:a.displaySubwayListView,id:"menuDisplaySubwayListView",content:{type:"icondropdown",options:{items:[{fonticon:"graph-egraph ",id:"ThumbnailView",description:a.displayThumbnailView},{selected:!0,fonticon:"graph-egraph-list selected",id:"SubwayListView",description:a.displaySubwayListView}],events:{onClick:function(e,t){t.elements.container.className="item ",this.elements.container.getChildren()[1].className="item selected",d.setView("menuDisplay"+t.id,!0)}}}}},{fonticon:"duplicate",text:a.ShowDuplicates,id:"menuToggleDup"},{fonticon:"fonticon-2x fonticon-info",text:a.ShowInformation,id:"menuToggleInformation"}],events:{onClick:r.handleThumbnailGraphToolbar}}),r.customizeToolbarHash)for(var l in r.customizeToolbarHash){var u=r.customizeToolbarHash[l].insertIndex;u&&t.items.splice(u,0,r.customizeToolbarHash[l])}this._parent(t),e.createElement("span",{}).inject(this.getItem("multiSelectCounter").elements.container),this.hideMultiSelect(),this.removeLegendButton()},select:function(){var e,t,i,o,n,s=arguments;null!=s[0]&&(t=void 0===s[1]||s[1],(n=void 0!==s[2]&&s[2])&&t&&this.elements.container.querySelectorAll(".item-active").forEach((function(e){e.removeClassName&&e.removeClassName("item-active")})),n&&t&&this.overflowMenu.getSelectedItems().forEach((function(e){this.overflowMenu.menus[0].toggleSelection(e),e.elements.container.removeClassName("selectable")}),this),(e=this.getItem(s[0]))&&!e.elements.container.hasClassName("divider")&&(e.elements.container[t?"addClassName":"removeClassName"]("item-active"),i=e.elements.container.id,1===(o=this.overflowMenu.items.filter((function(e){return e.elements.container.hasClassName(i)}))).length&&(this.overflowMenu.menus[0].toggleSelection(o[0]),o[0].elements.container.addClassName("selectable"))))},getItemIndex:function(e){var t,i,o,n=!1,s=-1;for(t=0,i=this.menu.items.length;t<i;t+=1){if(n=this.menu.items[t],e&&e.nodeType){if(o=e.hasClassName("item")?e:e.getParent(),n.id===o.id){s=t;break}}else if(t===e||n.id===e||n.name===e){s=t;break}n=!1}return s},addLegendButton:function(e){this.showItem("menuToggleLegend"),this.select("menuToggleLegend",e)},removeLegendButton:function(){this.hideItem("menuToggleLegend")},setView:function(e,t){if(this.viewTYPE!==e){switch(this.viewTYPE=e,e){case"menuDisplayThumbnailView":if(this._versionExplorerController.options.customizeToolbarHash)for(var i in this._versionExplorerController.options.customizeToolbarHash){(o=this._versionExplorerController.options.customizeToolbarHash[i].id)&&"function"==typeof this._versionExplorerController.options.customizeToolbarHash[i].showInTreeView&&(this._versionExplorerController.options.customizeToolbarHash[i].showInTreeView()?this.showItem(o):this.hideItem(o))}0==this._versionExplorerController.options.showViewIcon?this.hideItem("menuDisplayThumbnailView"):this.showItem("menuDisplayThumbnailView"),this.showItem("menuHelp"),this.showItem("menuRefresh"),this.showItem("divider"),this.showItem("graphViewDropDown"),this.showItem("menuZoomToFit"),this.showItem("menuToggleOverview"),this.hideItem("menuDisplaySubwayListView"),!0===this.versionExplorerView._versionModel._DupToggling?this.showItem("menuToggleDup"):this.hideItem("menuToggleDup"),this.hideItem("menuToggleInformation"),!0===t&&this.versionExplorerView._displayThumbnailGraph(!0);break;case"menuDisplaySubwayListView":if(this._versionExplorerController.options.customizeToolbarHash)for(var i in this._versionExplorerController.options.customizeToolbarHash){var o;(o=this._versionExplorerController.options.customizeToolbarHash[i].id)&&"function"==typeof this._versionExplorerController.options.customizeToolbarHash[i].showInListView&&(this._versionExplorerController.options.customizeToolbarHash[i].showInListView()?this.showItem(o):this.hideItem(o))}this.hideItem("menuDisplayThumbnailView"),this.hideItem("graphViewDropDown"),this.hideItem("menuZoomToFit"),this.hideItem("menuToggleOverview"),0==this._versionExplorerController.options.showViewIcon?this.hideItem("menuDisplaySubwayListView"):this.showItem("menuDisplaySubwayListView"),this.showItem("menuRefresh"),this.showItem("menuHelp"),this.showItem("divider"),!0===this.versionExplorerView._versionModel._DupToggling?this.showItem("menuToggleDup"):this.hideItem("menuToggleDup"),this.hideItem("menuToggleInformation"),!0===t&&this.versionExplorerView._displaySubwayGraph()}for(var n=["menuToggleOverview","menuZoomToFit","graphViewDropDown"],s=0;s<n.length;s++)this["menuDisplayThumbnailView"===e?"showItem":"hideItem"](n[s])}},handleThumbnailGraphToolbar:function(e,t){var i=this;switch(t.id){case"menuRefresh":i._versionExplorerController.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:!0});break;case"menuToggleDup":i.select(t.id,!i.getItem(t.id).elements.container.hasClassName("item-active"));var o=this.elements.container.getParent(".version-global-div");n._saveUserSettings("displayDuplicates",i.getItem(t.id).elements.container.hasClassName("item-active"),i.versionExplorerView._versionModel.useGlobalStorage,i.versionExplorerView._versionModel.globalStorageName,i.versionExplorerView._versionModel.webToWinComSocket),i.versionExplorerView.toggleDuplicateMode();break;case"menuToggleInformation":break;case"menuToggleHelp":i.select(t.id,!i.getItem(t.id).elements.container.hasClassName("item-active")),(o=this.elements.container.getParent(".version-global-div"))&&(o=o.getElement(".versionexplorer-help")),o&&o[i.getItem(t.id).elements.container.hasClassName("item-active")?"removeClassName":"addClassName"]("versionexplorer-help-hidden"),n._saveUserSettings("displayHelp",i.getItem(t.id).elements.container.hasClassName("item-active"),i.versionExplorerView._versionModel.useGlobalStorage,i.versionExplorerView._versionModel.globalStorageName,i.versionExplorerView._versionModel.webToWinComSocket);break;case"menuToggleOverview":i.select(t.id,!i.getItem(t.id).elements.container.hasClassName("item-active")),n._saveUserSettings("displayThumbnailOverview",i.getItem(t.id).elements.container.hasClassName("item-active"),i.versionExplorerView._versionModel.useGlobalStorage,i.versionExplorerView._versionModel.globalStorageName,i.versionExplorerView._versionModel.webToWinComSocket),i.versionExplorerView.setThumbnailOverviewVisibility();break;case"menuZoomToFit":i.versionExplorerView.reframeThumbnailGraph();break;case"menuToggleLegend":i.select(t.id,!i.getItem(t.id).elements.container.hasClassName("item-active")),i.versionExplorerView.displayLegend(i.getItem(t.id).elements.container.hasClassName("item-active")),n._saveUserSettings("displayLegend",i.getItem(t.id).elements.container.hasClassName("item-active"),i.versionExplorerView._versionModel.useGlobalStorage,i.versionExplorerView._versionModel.globalStorageName,i.versionExplorerView._versionModel.webToWinComSocket);break;case"menuMultiSelect":this.versionExplorerView._versionModel._USER_SET_MULTI_SELECT=!i.getItem(t.id).elements.container.hasClassName("item-active"),this.versionExplorerView._manageSelect({data:!this.versionExplorerView._versionModel._USER_SET_MULTI_SELECT});break;case"menuMultiSelectDropdown":this.versionExplorerView.onMultiSelectDropdownClick(e);break;case"menuSettings":this.versionExplorerView._customizeColumns();break;default:this._versionExplorerController.options.customizeToolbarHash&&this._versionExplorerController.options.customizeToolbarHash[t.id]&&"function"==typeof this._versionExplorerController.options.customizeToolbarHash[t.id].callback&&this._versionExplorerController.options.customizeToolbarHash[t.id].callback()}},hideItem:function(e){var t=this.getItem(e);t&&t.elements.container.hide()},showItem:function(e){var t=this.getItem(e);t&&t.elements.container.show()},activateItem:function(e){this.select(e,!0)},deactivateItem:function(e){this.select(e,!1)},hideMultiSelect:function(){this.hideItem("menuMultiSelect"),this.hideItem("multiSelectCounter"),this.hideItem("menuMultiSelectDropdown")},showMultiSelect:function(){this.showItem("menuMultiSelect"),this.showItem("divider")},activateMultiSelect:function(){this._multiSelectActive||(this.activateItem("menuMultiSelect"),this.showItem("multiSelectCounter"),this.activateItem("multiSelectCounter"),this.activateItem("menuMultiSelectDropdown"),this._multiSelectActive=!0)},deactivateMultiSelect:function(){this._multiSelectActive&&(this.deactivateItem("menuMultiSelect"),this.hideItem("multiSelectCounter"),this.hideItem("menuMultiSelectDropdown"),this._multiSelectActive=!1)},setMultiSelectCount:function(e){this._multiSelectActive&&this.getItem("multiSelectCounter").elements.container.getElement("span").setContent(e.toString())},showMultiSelectDropdown:function(){this._multiSelectActive&&this.showItem("menuMultiSelectDropdown")},hideMultiSelectDropdown:function(){this.hideItem("menuMultiSelectDropdown")},setSubwayViewRowHeight:function(e){e=e||n.UserSettings.subwayViewMode,this.versionExplorerView.setSubwayRowHeight(s.SUBWAY_VIEW_MODE[e]),n._saveUserSettings("subwayViewMode",e,this.versionExplorerView._versionModel.useGlobalStorage,this.versionExplorerView._versionModel.globalStorageName,this.versionExplorerView._versionModel.webToWinComSocket)},isItemHidden:function(e){var t=this.getItem(e);if(!t)throw Error("VersionExplorerToolbar.isItemHidden: "+t+" not found");return t.elements.container.isHidden()}})})),define("DS/ENOXVersionExplorerViews/NewVersionDialog",["DS/UIKIT/Form","DS/UIKIT/SuperModal","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","i18n!DS/ENOXVersionExplorerViews/assets/nls/NewVersionDialog","css!DS/ENOXVersionExplorerViews/styles/NewVersionDialog"],(function(e,t,i,o){"use strict";return{displayDialog:function(n){if(!n.derivedFrom||!n.derivedFrom.name||!n.derivedFrom.id)throw Error("derived From Name or ID cannot be null");if("string"!=typeof n.defaultName||!n.defaultName.length)throw Error("Default Name cannot be null");var s=n.dataModelType,r=n.semanticTypes,l=!1,a=[{type:"textarea",label:o.description,required:!1,name:"newVersionDescription"}];if(Array.isArray(r)&&r.length){l=!0;var d=r.length;a.push({label:o.semanticRelationship,disabled:!0,className:"semanticTypeText",required:!0,flag:"semanticType"});for(var c=0;c<d;c++)a.push({type:"radio",label:r[c].label,required:!1,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType"})}else switch(s){case i.DATA_MODEL_TYPES.MODEL_P_PRIME:case i.DATA_MODEL_TYPES.MODEL_RDF:l=!0,a.push({label:o.semanticRelationship,disabled:!0,className:"semanticTypeText",required:!0,flag:"semanticType"},{type:"radio",label:o.S,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"S",checked:!0},{type:"radio",label:o.F,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"F"},{type:"radio",label:o.SO,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"SO"},{type:"radio",label:o.SP,name:"version_type",className:"primary semanticTypeRadio",flag:"semanticType",value:"SP"})}a.push({type:"text",label:o.derivedFrom,required:!1,disabled:!0,value:n.derivedFrom.name,name:"newVersionBasedOn"});var u,p=new e({fields:a,className:"newVersionDialog"});(u=(u=p.elements.container.getElement('input[type="text"].semanticTypeText'))?u.getParent("div").getElement("label span"):void 0)&&UWA.createElement("span",{class:"fonticon fonticon-info",events:{mousedown:function(e){}}}).inject(u,"before"),new t({renderTo:n.parentContainer||document.body,className:"newVersionSuperModal"}).dialog({title:n.title||o.newBranch,body:p.elements.container,buttons:[{className:"primary",value:o.create,action:function(e){var t=n.defaultName,i=p.getValue("newVersionDescription"),o=void 0;if(!0===l){var s=p.elements.container.getElements('.semanticTypeRadio input[type="radio"]:checked');o=s&&1==s.length&&s[0].getAttribute("value")}e.hide(),n.onOK(t,i,o)},name:"buttonOK"},{className:"default",value:o.cancel,action:function(e){e.hide()},name:"buttonCancel"}]})}}})),define("DS/ENOXVersionExplorerViews/VersionExplorerPrefsDlg",["UWA/Class","UWA/Core","DS/UIKIT/SuperModal","DS/UIKIT/Input/Toggle","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerPrefsDlg","i18n!DS/UIKIT/assets/nls/UIKIT","css!DS/LifecycleControls/assets/styles/LifecycleModals","css!DS/ENOXVersionExplorerViews/VersionExplorerPrefsDlg"],(function(e,t,i,o,n,s,r,l){"use strict";return e.singleton({init:function(){this._parent({})},showDialog:function(e){var t=this,o=e.onOk,r=e.onShow,l=!1,a=new i({closable:!0,className:"Lifecycle_Modals",events:{onShow:function(){var e=[];t.okButton=this.modals.current.getFooter().children[0],t.cancelButton=this.modals.current.getFooter().children[1],t.resetButton=this.modals.current.getFooter().children[2],e.push(t.okButton),e.push(t.cancelButton),e.push(t.resetButton),this.modals.current.getFooter().removeChild(e[2]),this.modals.current.getFooter().insertBefore(e[2],e[1]),null!=r&&r(t)}},renderTo:e.parent}),d=this.buildDialogBody(e);a.dialog({body:d,className:"Lifecycle_Modals",title:e.title,buttons:[{className:"primary",value:s.ok,action:function(e){var i={},n=e.elements.body.getElement("#compact-view-toggle");n&&(i.compactView=n.checked),i.wasReset=l,void 0!==t.checkboxes&&(i.attributes=t.getSelectedAttributes()),e.hide(),o(i)}},{value:s.ko,action:function(e){e.hide()}},{value:n.Reset,action:function(e){l=!0,t.resetAttributes(e)}}]})},getSelectedAttributes:function(){for(var e=[],t=this.checkboxes.length,i=0;i<t;i++){var o=this.checkboxes[i];o.isChecked()&&e.push(o.getId().replace("@@@",""))}return e},buildDialogBody:function(e){var i=this;i.options=e;var s=t.createElement("div",{styles:{position:"relative",height:"100%",overflow:"hidden"}});if(i.compactDisplayOption=void 0,i.isCompactDisplayOptionChecked=!1,e.showGraphListSettings){i.compactDisplayOption=new o({id:"compact-view-toggle",type:"switch",label:n.UseCompactDisplay,checked:e.compactView}).inject(s),i.isCompactDisplayOptionChecked=e.compactView;t.createElement("div",{html:n.SelectColumns}).inject(s)}if(e.showGraphSettings)t.createElement("div",{html:n.SelectNodeInfo}).inject(s);if(e.showGraphListSettings||e.showGraphSettings){var r=t.createElement("form",{}),l=t.createElement("fieldset",{id:"attribute-preference-content",class:"preferenceSet"});i.attributesSet=l;var a=e.allAttributes.length;this.checkboxes=[],this.resetAttributesArray=[],e.showGraphListSettings?this.resetAttributesArray=e.resetGraphListView:this.resetAttributesArray=e.resetGraphView;var d=e.allAttributes.slice();d.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}));for(var c=0;c<a;c++){var u={displayName:d[c].displayName,isSelected:d[c].isSelected,name:d[c].name};this.resetAttributesArray.findIndex((function(e){return e.name===u.name}))<0&&(u.isSelected=!1,this.resetAttributesArray.push(u))}var p=[];for(c=0;c<a;c++){u=e.allAttributes[c];if(!e.showGraphSettings||"thumbnail"!==u.name)u.isSelected?this.addAttrItem(i.options,l,u):p.push(u)}p.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}));for(c=0;c<p.length;c++){u=p[c];this.addAttrItem(i.options,l,u)}l.inject(r),r.inject(s)}return s},resetAttributes:function(e){if(this.isCompactDisplayOptionChecked=!1,this.options.showGraphListSettings){var t=e.elements.body.getElement("#compact-view-toggle");t&&(t.checked=!1)}this.checkboxes=[],this.attributesSet.empty();for(var i=0;i<this.resetAttributesArray.length;i++){var o=this.resetAttributesArray[i];this.addAttrItem(this.options,this.attributesSet,o)}if(this.options.showGraphSettings){var n=e.getFooter().getElementsByClassName("btn-primary");if(n.length>0){var s=n[0];this.checkboxes.length>0?s.disabled=!1:s.disabled=!0}}},addAttrItem:function(e,t,i){var n=this,s=i.name.replace("@@@","");"thumbnail"===s&&n.compactDisplayOption&&(i.isSelected?n.compactDisplayOption.isDisabled()||(n.isCompactDisplayOptionChecked=n.compactDisplayOption.isChecked(),n.compactDisplayOption.setCheck(!1),n.compactDisplayOption.setDisabled(!0)):(n.compactDisplayOption.setCheck(n.isCompactDisplayOptionChecked),n.compactDisplayOption.setDisabled(!1)));var r=new o({id:"@@@"+s,type:"checkbox",className:"primary",label:i.displayName,checked:i.isSelected,disabled:1==i.disabled,events:{onChange:function(i){t.empty();var o=n.checkboxes;n.checkboxes=[];for(var s=[],r=o.length,l=void 0,a=!1,d=0;d<r;d++){var c=o[d];c===this?a=!0:a&&void 0===l&&(l=c),(p={name:c.options.id,displayName:c.options.label,isSelected:c.options.checked,disabled:c.options.disabled}).isSelected&&c!==this?n.addAttrItem(e,t,p):c!==this&&s.push(p)}void 0===l&&r-2>=0&&(l=o[r-2]);var u=this.isChecked(),p={name:this.options.id,displayName:this.options.label,isSelected:u,disabled:this.options.disabled};u?n.addAttrItem(e,t,p):s.push(p),n.checkboxes.length>0?n.okButton.disabled=!1:n.okButton.disabled=!0,s.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}));for(var h=0;h<s.length;h++)n.addAttrItem(e,t,s[h]);if(null!=l){var m=l.getId(),v=document.getElementById(m);v&&v.scrollIntoViewIfNeeded()}}}}).inject(t);this.checkboxes.push(r)}})})),define("DS/ENOXVersionExplorerViews/VersionExplorerPrefs",["UWA/Class","UWA/Promise","DS/ENOXVersionExplorerViews/VersionExplorerPrefsDlg","DS/LifecycleServices/LifecycleServices","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerPrefsDlg","DS/WidgetServices/WidgetServices","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/WAFData/WAFData"],(function(e,t,i,o,n,s,r,l,a){"use strict";return e.extend({init:function(e,t,i,o,n,s,r,l){this._parent({}),this.allColumns=i,this.defaultCols=o,this.hWidget=e,this.appId=t,this._USE_GLOBAL_STORAGE=s,this._GLOBAL_STORAGE_NAME=r,this._WEBTOWIN_COM_SOCKET=l},getAll:function(){return this.allColumns},getAlldbKeys:function(){return this.allColumns.map((function(e){return e.dbKey}))},loadSettingsPromise:function(){var e=this;return e.loaded=null,new t((function(t,i){s.getCompassUrlAsync({onComplete:function(i){e.hWidget.getValue("x3dPlatformId");var o="X";null!=e._GLOBAL_STORAGE_NAME&&(o=e._GLOBAL_STORAGE_NAME);var n=e.appId.slice(0,e.appId.length-1),s=encodeURI(i+"/resources/AppsMngt/user/getPreferences?name="+(n+o)),r=encodeURI(i+"/resources/AppsMngt/user/getPreferences?name="+e.appId);a.authenticatedRequest(s,{method:"GET",timeout:5e3,headers:{Accept:"application/json",SecurityContext:void 0},cache:!1,onComplete:function(o){console.log("PICK COMPARE DIALOG: success getting universal value"),"[]"===o||null!=o&&""!=o&&o.indexOf("]")<1?e.loaded=[]:null!=o&&""!=o&&(o=o.replaceAll("------","###"),e.loaded=JSON.parse(o)),"[]"===o||null!=e.loaded&&""!=e.loaded?(e.save(e.loaded),t(e.loaded)):a.authenticatedRequest(r,{method:"GET",timeout:5e3,headers:{Accept:"application/json"},onComplete:function(o){if(console.log("PICK COMPARE DIALOG: success getting legacy value"),null!=o&&""!=o&&(e.loaded=JSON.parse(o)),null==e.loaded||""==e.loaded){var s=n+l.DATA_MODEL_TYPES.MODEL_REVISION.toString();if(e.appId===s){var r=n+l.DATA_MODEL_TYPES.MODEL_HISTORY.toString(),d=encodeURI(i+"/resources/AppsMngt/user/getPreferences?name="+r);a.authenticatedRequest(d,{method:"GET",timeout:5e3,headers:{Accept:"application/json",SecurityContext:void 0},cache:!1,onComplete:function(i){console.log("PICK COMPARE DIALOG: success getting legacy history settings"),null!=i&&""!=i&&(e.loaded=JSON.parse(i)),null!=e.loaded&&""!=e.loaded||(e.loaded=e.load()),t(e.loaded)},onFailure:function(e){console.log("PICK COMPARE DIALOG: failed getting value")}})}else e.loaded=e.defaultCols,e.save(e.loaded),t(e.loaded)}else t(e.loaded)},onFailure:function(e){console.log("PICK COMPARE DIALOG: failed getting value")}})},onFailure:function(e){console.log("PICK COMPARE DIALOG: failed getting value")}})}})}))},load:function(){var e=this;e.loaded=null;var t=e.appId.slice(0,e.appId.length-1),i=t+"X";if(e.hWidget&&null==this._WEBTOWIN_COM_SOCKET?e.loaded=e.hWidget.getValue(i):e.loaded=JSON.parse(window.localStorage.getItem(i)),null==e.loaded&&(e.hWidget&&null==this._WEBTOWIN_COM_SOCKET?e.loaded=e.hWidget.getValue(e.appId):e.loaded=JSON.parse(window.localStorage.getItem(e.appId))),null==e.loaded){var o=t+l.DATA_MODEL_TYPES.MODEL_REVISION.toString();if(e.appId===o){var n=t+l.DATA_MODEL_TYPES.MODEL_HISTORY.toString();e.hWidget&&null==this._WEBTOWIN_COM_SOCKET?e.loaded=e.hWidget.getValue(n):e.loaded=JSON.parse(window.localStorage.getItem(n))}}var s=0;if(e.loaded&&e.loaded.length>0&&-1!==e.loaded[0].indexOf("-v-v-v-v-v-")){var r=e.loaded.shift();r=r.replace("-v-v-v-v-v-",""),s=Number(r)}return null==e.loaded?e.loaded=e.defaultCols:0==s&&e.loaded.unshift("tree"),e.save(e.loaded),e.loaded},save:function(e){for(var t=["-v-v-v-v-v-1"],i=0;i<e.length;i++)-1===e[i].indexOf("-v-v-v-v-v-")&&t.push(e[i]);var o=this.appId.slice(0,this.appId.length-1)+"X";if(this.hWidget&&null==this._WEBTOWIN_COM_SOCKET?this.hWidget.setValue(o,t):window.localStorage.setItem(o,JSON.stringify(t)),this._USE_GLOBAL_STORAGE){var n=this;s.getCompassUrlAsync({onComplete:function(e){n.hWidget.getValue("x3dPlatformId");var i="X";null!=n._GLOBAL_STORAGE_NAME&&(i=n._GLOBAL_STORAGE_NAME);var s=e+"/resources/AppsMngt/user/setPreferences?name="+(o=n.appId.slice(0,n.appId.length-1)+i)+"&value="+JSON.stringify(t);s=s.replaceAll("###","------");var r=encodeURI(s);a.authenticatedRequest(r,{method:"GET",timeout:5e3,headers:{Accept:"application/json",SecurityContext:void 0},cache:!1,onComplete:function(e){console.log("PICK COMPARE DIALOG: success setting ")},onFailure:function(e){console.log("PICK COMPARE DIALOG: failed setting ")}})}})}},getAttrDispName:function(e){return"newTarget"==e?n.newTarget:o.getAttributeDisplayName(e)},customizations:function(e){var t=this,o=[];if(this._USE_GLOBAL_STORAGE)this.loadSettingsPromise().then((function(s){for(var r=[],l=!1,a=0,d=s.length;a<d;a++){var c;if(s[a].startsWith("###"))if(!0===e.showGraphSettings)"title"===(c=s[a].substr(3))&&(l=!0),r.push(c);else o.push(s[a]);else if(!0===e.showGraphSettings)o.push(s[a]);else"title"===(c=s[a])&&(l=!0),r.push(s[a])}setTimeout((function(){var s=[],a=!1;!0===e.showGraphSettings&&0==r.length&&(a=!0),l||!0!==e.showGraphSettings||(s=[{name:"tree",displayName:t.getAttrDispName("title"),isSelected:!0===e.showGraphSettings&&a,disabled:!1}]),s.length>0&&!0===e.showGraphSettings&&r.indexOf("tree")>=0&&(s[0].isSelected=!0);for(var d=0,c=r.length;d<c;d++){var u=t.allColumns.find((function(e){return r[d]===e.dbKey}));if(u)s.push({name:u.dbKey,displayName:u.columnNLS,isSelected:!0});else{var p=!0===e.showGraphSettings?"###"+r[d]:r[d];o.push(p)}}var h=t.allColumns.length;for(d=0;d<h;d++){var m=t.allColumns[d].dbKey;-1==r.indexOf(m)&&s.push({name:m,displayName:t.allColumns[d].columnNLS,isSelected:!1})}i.showDialog({title:n.SettingsTitle,parent:document.body,showGraphListSettings:e.showGraphListSettings,showGraphSettings:e.showGraphSettings,compactView:e.compactView,allAttributes:s,resetGraphListView:t.resetGraphListView,resetGraphView:t.resetGraphView,onShow:function(t){void 0!==e.onShowDlg&&null!==e.onShowDlg&&e.onShowDlg(t)},onOk:function(i){var n={};if(void 0!==i.compactView&&(n.compactView=i.compactView),void 0!==i.attributes){n.attributes=[];for(var s=i.attributes.length,r=0;r<s;r++){var l=!0===e.showGraphSettings?"###"+i.attributes[r]:i.attributes[r];n.attributes.push(l)}for(var a=0;a<o.length;a++){var d=!0;!0===i.wasReset&&(o[a].startsWith("###")?!0===e.showGraphSettings&&(d=!1):!1===e.showGraphSettings&&(d=!1)),d&&n.attributes.push(o[a])}t.save(n.attributes)}void 0!==e.onOk&&null!==e.onOk&&e.onOk(n)}})}),500)}));else{for(var s=this.load(),r=[],l=!1,a=0,d=s.length;a<d;a++){if(s[a].startsWith("###"))if(!0===e.showGraphSettings)"tree"===(v=s[a].substr(3))&&(l=!0),r.push(v);else o.push(s[a]);else if(!0===e.showGraphSettings)o.push(s[a]);else"tree"===(v=s[a])&&(l=!0),r.push(s[a])}var c=[],u=!1;!0===e.showGraphSettings&&0==r.length&&(u=!0);var p=!1;l||!0!==e.showGraphSettings||(p=!0,c=[{name:"tree",displayName:this.getAttrDispName("title"),isSelected:!0===e.showGraphSettings&&u,disabled:!1}]),c.length>0&&!0===e.showGraphSettings&&r.indexOf("tree")>=0&&(c[0].isSelected=!0);var h=0;for(d=r.length;h<d;h++){var m=this.allColumns.find((function(e){return r[h]===e.dbKey}));if(m)c.push({name:m.dbKey,displayName:m.columnNLS,isSelected:!0});else{var v=!0===e.showGraphSettings?"###"+r[h]:r[h];o.push(v)}}var g=this.allColumns.length;for(h=0;h<g;h++){var E=this.allColumns[h].dbKey;p&&"tree"===E||-1==r.indexOf(E)&&c.push({name:E,displayName:this.allColumns[h].columnNLS,isSelected:!1})}i.showDialog({title:n.SettingsTitle,parent:document.body,showGraphListSettings:e.showGraphListSettings,showGraphSettings:e.showGraphSettings,compactView:e.compactView,allAttributes:c,resetGraphListView:this.resetGraphListView,resetGraphView:this.resetGraphView,onShow:function(t){void 0!==e.onShowDlg&&null!==e.onShowDlg&&e.onShowDlg(t)},onOk:function(i){var n={};if(void 0!==i.compactView&&(n.compactView=i.compactView),void 0!==i.attributes){n.attributes=[];for(var s=i.attributes.length,r=0;r<s;r++){var l=!0===e.showGraphSettings?"###"+i.attributes[r]:i.attributes[r];n.attributes.push(l)}for(var a=0;a<o.length;a++){var d=!0;!0===i.wasReset&&(o[a].startsWith("###")?!0===e.showGraphSettings&&(d=!1):!1===e.showGraphSettings&&(d=!1)),d&&n.attributes.push(o[a])}t.save(n.attributes)}void 0!==e.onOk&&null!==e.onOk&&e.onOk(n)}})}},setParams:function(e,t,i,o,n){"string"==typeof e&&e.length&&(this.appId=e),Array.isArray(t)&&t.length&&(this.allColumns=t),Array.isArray(i)&&i.length&&(this.defaultCols=i),Array.isArray(o)&&o.length&&(this.resetGraphListView=o),Array.isArray(n)&&n.length&&(this.resetGraphView=n)}})})),define("DS/ENOXVersionExplorerViews/VersionExplorerView",["UWA/Core","UWA/Controls/Abstract","DS/ENOXVersionExplorerThumbnailGraphView/TreeDocGraphViewSync","DS/ENOXVersionExplorerViews/VersionExplorerToolbar","DS/TreeModel/TreeDocument","DS/ENOXVersionExplorerUtils/ArrayFunctions","DS/ENOXVersionExplorerViews/NodeDropdownMenu","DS/ENOXVersionExplorerViews/VersionExplorerModal","DS/ENOXVersionExplorerThumbnailGraphView/NodeEdgeViewsTemplates/DefaultNodeEdgeViewsTemplate","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerSubwayListView/VersionExplorerSubwayListView","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/LifecycleControls/DelayedMask","DS/ENOXVersionExplorerModel/VersionTreeNodeModel","i18n!DS/LifecycleWidget/assets/nls/LifecycleWidgetNls","i18n!DS/ENOXVersionExplorerViews/assets/nls/VersionExplorerView","css!DS/ENOXVersionExplorerViews/styles/VersionExplorer"],(function(e,t,i,o,n,s,r,l,a,d,c,u,p,h,m,v,g){"use strict";return t.extend({_versionModel:void 0,init:function(t){function g(){var e=M.options;O=e.parentContainer,T="boolean"!=typeof e.showToolbar||e.showToolbar,D=e.mapScaleLimits||D,I=e.versionExplorerController,N=e.nodeEdgeViewsTemplate,R=e.customOnDrop,N||(N=new a)}function E(e){var t,i,o=e.displayMode===d.DISPLAY_MODES.THUMBNAIL_VIEW?e.node.data.options.id:e.cellInfos.nodeModel.__MASTER__.options.id,n=M._versionModel.getXSO().get();if(e.displayMode===d.DISPLAY_MODES.THUMBNAIL_VIEW){if(i=e.node,M._versionModel._SELECTION_MODE&d.SELECTION_MODES.WITH_COMMANDS&&(M._versionModel._FILTER_ENABLED&&i.data.getAttribute("__filter__")||!M._versionModel._FILTER_ENABLED)){var s,r,l,a=M._versionModel.searchByID(o);if(i=1===a.length?a[0].__treeGraphNode__:void 0)(l=M._versionModel._USER_SET_MULTI_SELECT?i.grNode.views.main.display.elt.querySelector("."+N.HTMLViewsClasses.nodeDropdownMenuButtonClass).getBoundingClientRect():i.grNode.views.main.display.elt.querySelector("."+N.HTMLViewsClasses.nodeClass).getBoundingClientRect())&&(s=(l.left+l.right)/2,r=(l.top+l.bottom)/2),t={treeNode:i.data,target:i.grNode.views.main.display.elt,selectedNodes:n,position:{x:s,y:r},dropdownContainer:x}}}else{var c=e.cellInfos,u=e.event;i=c.nodeModel.__MASTER__,M._versionModel._SELECTION_MODE&d.SELECTION_MODES.WITH_COMMANDS&&(M._versionModel._FILTER_ENABLED&&i.getAttribute("__filter__")||!M._versionModel._FILTER_ENABLED)&&(t={treeNode:i,target:c.view,selectedNodes:n,position:{x:u.clientX,y:u.clientY},dropdownContainer:x})}M._versionModel._SELECTION_MODE&d.SELECTION_MODES.WITH_COMMANDS&&t&&I.publishEvent("ENOXVersionExplorerDropdownMenu",t)}function _(e){I.publishEvent("ENOXVersionExplorerDoubleClickVersion",e)}function f(e){if(1!=this.manageNodeSelectionOff){var t=e.target;t.options.grid.__checked__=t._isSelected;for(var i=M._versionModel.getXSO().get(),o=0;o<i.length;o++)i[o].options.grid.__checked__=i[o]._isSelected;M._manageSelect({data:!1})}}function S(){x.getElement(".version-subway-canvas").show(),V||(g(),V=new c({container:x.getElement(".version-subway-canvas"),onNodeDropdownMenu:function(e){e.displayMode=d.DISPLAY_MODES.SUBWAY_VIEW,E(e)},onNodeDoubleClick:_,customOnDrop:R,versionExplorerController:I,model:M._versionModel,defaultCellHeight:d.SUBWAY_VIEW_MODE[u.UserSettings.subwayViewMode]}),M._subwayGraphView=V,T&&(A.show(),A.setView("menuDisplaySubwayListView")),M.setSelectionMode()),L!==d.DISPLAY_MODES.SUBWAY_VIEW&&(V.activate(),V.updateSelectionMode(!0),L=d.DISPLAY_MODES.SUBWAY_VIEW)}function w(e){var t=M._subwayGraphView,i=!!M._versionModel.filterHash&&Object.keys(M._versionModel.filterHash).length>0,o=t?t.getColumnManager():void 0,n=!!o&&o.hasFilterColumns();if(t){t.cellSelection="none";var r=t._model.getXSO().get();t._manager.options.selection.canMultiSelect?t.rowSelection="multiple":t.rowSelection="single";for(var l=0;l<r.length;l++)t._model.getXSO().add(r[l])}if(M._getActiveView()===d.DISPLAY_MODES.SUBWAY_VIEW&&t&&(e&&1==e.forceUpdate||t.columnDataModelType!==M._versionModel._DATA_MODEL_TYPE||i&&!n))if(t.columnDataModelType=M._versionModel._DATA_MODEL_TYPE,t.prepareUpdateColumns(),o.empty(),o.addColumns(M.customizeColumns.getAll().map((function(e){return{text:e.columnNLS,dataIndex:e.outputKey}}))),o&&o.updateIntentColumnState(),o.modifyFilterColumns(i),M.customizeColumns._USE_GLOBAL_STORAGE)M.customizeColumns.loadSettingsPromise().then((function(e){if(u.UserSettings.displayMode!=d.DISPLAY_MODES.THUMBNAIL_VIEW){for(var i=[],n=0,r=e.length;n<r;n++)e[n].startsWith("###")||i.push(e[n]);o.showColumns(i);var l=s.intersectionDifference(M.customizeColumns.getAll(),i,(function(e,t){return e.dbKey===t}))[0].difference;o.hideColumns(l.map((function(e){return e.outputKey}))),o.arrangeColumns(i),t.pushUpdateColumns(),M.setSubwayRowHeight(d.SUBWAY_VIEW_MODE[u.UserSettings.subwayViewMode])}}));else{var a=M.customizeColumns.load();if(u.UserSettings.displayMode!=d.DISPLAY_MODES.THUMBNAIL_VIEW){for(var c=[],p=(l=0,a.length);l<p;l++)a[l].startsWith("###")||c.push(a[l]);o.showColumns(c);var h=s.intersectionDifference(M.customizeColumns.getAll(),c,(function(e,t){return e.dbKey===t}))[0].difference;o.hideColumns(h.map((function(e){return e.outputKey}))),o.arrangeColumns(c),t.pushUpdateColumns(),M.setSubwayRowHeight(d.SUBWAY_VIEW_MODE[u.UserSettings.subwayViewMode])}}else t&&t.prepareUpdateColumns(),o&&o.updateIntentColumnState(),!i&&n&&o&&o.modifyFilterColumns(i),t&&t.pushUpdateColumns();if(t&&(t.prepareUpdateView(),t.pushUpdateViewAndUpdateGraph()),t){i=t._manager.elements.header.getElementsByClassName("wux-datagridview-filter").length>0;var m=!1,v=Object.keys(t._model._GraphListViewModel.getFilterManager().getFilters());v.forEach((function(e){var i=t._model._GraphListViewModel.getFilterManager().getFilters()[e];i.isDataFiltered()&&!i.isEmpty()&&(t._model._GraphListViewModel.getFilterManager().reapplyPropertyFilterModel(e),m=!0)})),i&&!m&&v.forEach((function(e){t._model._GraphListViewModel.getFilterManager().reapplyPropertyFilterModel(e)}))}}function b(e){for(var t={},i={},o=0;o<M.customizeColumns.allColumns.length;o++)t[M.customizeColumns.allColumns[o].dbKey]=M.customizeColumns.allColumns[o].outputKey,i[M.customizeColumns.allColumns[o].dbKey]=M.customizeColumns.allColumns[o].columnNLS;for(var n=[],s=[],r=(o=0,e.length);o<r;o++)if(e[o].startsWith("###")){var l=e[o].substr(3),a=void 0===t[l]?"title"===l?l:void 0:t[l],d=void 0===i[l]?"title"===l?v.SettingsTitle:void 0:i[l];void 0!==a&&null!=d&&(n.push(a),s.push(d))}0===n.length&&(n.push("title"),s.push(v.SettingsTitle)),C.sync.document._titleNames=n,C.sync.document._titleLabels=s,C.activate(),M.setFocus()}function y(e){var t;return Array.isArray(e.options.ancestors)&&e.options.ancestors.length&&(e.options.ancestors.sort((function(e,t){return"I"===e.semantic?-1:1})),t=e.options.ancestors.reduce((function(t,i){return"I"!==i.semantic&&("I"===i.semantic||t.nodes.length||i.dontHighlightLink)||(t.nodes.push(i.id),t.links.push([i.id,e.options.id])),t}),{nodes:[],links:[]})),t}e.Class.implement.call(this,{displayLegend:function(e){A&&A.addLegendButton(e),x.getElement(".versionexplorer-legend")[!0===e?"addClassName":"removeClassName"]("versionexplorer-legend-expanded")},removeLegend:function(){x.getElement(".versionexplorer-legend").removeClassName("versionexplorer-legend-expanded"),A&&A.removeLegendButton()},showDialog:function(t,i,o){l.displayDialog(e.merge(t,{globalDiv:x,parentContainer:i,modal:o,persistId:t.persistId,limitParent:!1,footerStyle:M._versionModel._SELECTION_MODE&d.SELECTION_MODES.WITH_COMMANDS?l.footerStyle.none:l.footerStyle.okCancel,position:{clientX:t.clientX,clienty:t.clientY},onCloseDlg:function(){I.cleanup()},onOK:function(e){I.publishEvent("ENOXVersionExplorerModalOK",I.getSelectedNodes())},onCancel:function(){I.publishEvent("ENOXVersionExplorerModalCancel")}}))},hideDialog:function(){l._closeDlg()},setTitle:function(e){l.setTitle(e)},setThumbnailGraphLayout:function(e){C.setRootPosition(i.OrientationMode[e]),u._saveUserSettings("thumbnailGraphLayout",e,M._versionModel.useGlobalStorage,M._versionModel.globalStorageName,M._versionModel.webToWinComSocket),I.publishEvent("ENOXVersionExplorerThumbnailGraphLayoutChanged",e)},reframeThumbnailGraph:function(){L===d.DISPLAY_MODES.THUMBNAIL_VIEW&&C&&C.reframeAll()},getToolbar:function(){return x.getElement(".versionexplorer-toolbar")},isToolBarItemHidden:function(e){return A.isItemHidden(e)},toggleDuplicateMode:function(){u.UserSettings.displayDuplicates?this._versionModel._DATA_MODEL_TYPE=d.DATA_MODEL_TYPES.MODEL_HISTORY:this._versionModel._DATA_MODEL_TYPE=d.DATA_MODEL_TYPES.MODEL_REVISION,!0===this._versionModel.usePersistentColor()&&this._versionModel._circularColorArray.currentIndex||this._versionModel._circularColorArray.resetCurrentIndex(),this._versionModel._forceReset=!0,this._versionModel.items=null;var e=I.subscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",(function(t){I.unsubscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",e),I.resetFilter(),V._manager.layout.invalidate()}));I.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:!0})},setThumbnailOverviewVisibility:function(){C[!0===u.UserSettings.displayThumbnailOverview?"showOverview":"hideOverview"](),x.getElement(".version-thumbnail-canvas").hide(),x.getElement(".version-thumbnail-canvas").show()},updateViewOptions:function(){var e=void 0;switch(function(){let e=x.getElement(".versionexplorer-toolbar");T?(e&&e.show(),!A&&e&&(A=new o({renderTo:e,versionExplorerView:M,versionExplorerController:I})),A&&A.show(),e&&e.show()):e&&e.hide()}(),function(){I.revisionMode&&(x.getElement(".versionexplorer-revisionmode").innerHTML="\n"+v.RevisionMode+"&nbsp:&nbsp"+v.EffectivityBased+"\n",x.getElement(".versionexplorer-revisionmode").show(),x.getElement(".versionexplorer-graphproprietary-container").hide());if("effectivity_based_reused"==I.revisionMode){x.getElement(".versionexplorer-revisionmode").innerHTML="\n"+v.RevisionMode+"&nbsp:&nbsp"+v.EffectivityBasedReuse+"&nbsp";var e=x.getElement(".versionexplorer-graphproprietary");e.innerHTML=I.graphProprietary.label,e.addEventListener("click",(function(){console.log("click");var e={displayName:I.graphProprietary.label,physicalid:I.graphProprietary.id,type:I.graphProprietary.type};I.changeGraphCurrentVersionAndRefresh(e)})),x.getElement(".versionexplorer-graphproprietary-container").show(),e.show()}else"effectivity_based_model"==I.revisionMode&&(x.getElement(".versionexplorer-revisionmode").innerHTML="\n"+v.RevisionMode+"&nbsp:&nbsp"+v.EffectivityBasedModel+"\n")}(),M._versionModel._DATA_MODEL_TYPE){case d.DATA_MODEL_TYPES.MODEL_P:case d.DATA_MODEL_TYPES.MODEL_ER:case d.DATA_MODEL_TYPES.MODEL_REVISION:e={displayThumbnailCollapser:!u.X_DESIGN,displaySemantic:!u.X_DESIGN};break;default:e={displayThumbnailCollapser:!0,displaySemantic:!0}}N&&N.updateViewOptions(e)},displayView:function(t){switch(u.UserSettings.displayMode){case d.DISPLAY_MODES.THUMBNAIL_VIEW:M._displayThumbnailGraph(t);break;case d.DISPLAY_MODES.SUBWAY_VIEW:M._displaySubwayGraph()}!function(){function t(t){var i=void 0;if("object"==typeof t&&Object.keys(t).length)for(var o in i=e.createElement("ul",{class:"iconbar-items-wrap iconbar-items-icons"}),t)i.addContent('<li><div class="symbol">'+o.toString()+'</div><div class="text">'+t[o]+"</div></li>");var n=x.getElement(".versionexplorer-legend ul");n&&n.destroy(),i.inject(x.getElement(".versionexplorer-legend"),"top")}var i=M._versionModel.getLegend();"object"==typeof i&&Object.keys(i).length?(t(i),M.displayLegend(u.UserSettings.displayLegend)):M.removeLegend()}(),A&&A.select("menuToggleHelp",u.UserSettings.displayHelp),x.getElement(".versionexplorer-help")[!0===u.UserSettings.displayHelp?"removeClassName":"addClassName"]("versionexplorer-help-hidden"),(M._versionModel._DupToggling||M._versionModel._DATA_MODEL_TYPE===d.DATA_MODEL_TYPES.MODEL_HISTORY)&&A&&A.select("menuToggleDup",u.UserSettings.displayDuplicates)},setSubwayRowHeight:function(e){var t=V.setRowHeight(e);return M._versionModel._isThumbnailsForListView=t>=80,t},_customizeColumns:function(){M.customizeColumns.customizations({showGraphListSettings:u.UserSettings.displayMode==d.DISPLAY_MODES.SUBWAY_VIEW,showGraphSettings:u.UserSettings.displayMode==d.DISPLAY_MODES.THUMBNAIL_VIEW,compactView:"SUBWAY_COMPACT_VIEW"===u.UserSettings.subwayViewMode,onOk:function(e){var t=!1;if(void 0!==e.compactView){var i=u.UserSettings.subwayViewMode,o=e.compactView?"SUBWAY_COMPACT_VIEW":"SUBWAY_COMFORTABLE_VIEW";o!==i&&(t=!0,u._saveUserSettings("subwayViewMode",o,M._versionModel.useGlobalStorage,M._versionModel.globalStorageName,M._versionModel.webToWinComSocket))}var n={code:"revision",creationDate:"creation",ownerName:"owner",maturity_nls:"maturity",project_nls:"project",policy_nls:"policy",organization_nls:"organization",type_nls:"type",reservedbyName:"reservedby",modified:"modification",title:"label"},r=M._versionModel.objectHash?Object.keys(M._versionModel.objectHash)[0]:void 0,l=r?M._versionModel.objectHash[r]:{};if(V){V.prepareUpdateColumns();var a=M.customizeColumns.getAll(),c=s.intersectionDifference(a,e.attributes,(function(e,t){return e.dbKey===t}))[0].difference.map((function(e){return e.outputKey})),p=a.filter((function(t){return e.attributes.findIndex((function(e){return t.dbKey}))>=0})).map((function(e){return e.outputKey}));V.getColumnManager().hideColumns(c),V.getColumnManager().showColumns(p),V.getColumnManager().arrangeColumns(e.attributes),t&&M.setSubwayRowHeight(d.SUBWAY_VIEW_MODE[o]),V.pushUpdateColumns(!1),t&&(V.prepareUpdateView(),V.pushUpdateViewAndUpdateGraph()),L===d.DISPLAY_MODES.SUBWAY_VIEW&&I.publishEvent("_ENOXVersionExplorerViewChanged",{forceUpdate:!0,activeView:L})}if(L===d.DISPLAY_MODES.THUMBNAIL_VIEW){for(var h=M.customizeColumns.load(),m={},g={},E=0;E<M.customizeColumns.allColumns.length;E++)m[M.customizeColumns.allColumns[E].dbKey]=M.customizeColumns.allColumns[E].outputKey,g[M.customizeColumns.allColumns[E].dbKey]=M.customizeColumns.allColumns[E].columnNLS;for(var _=[],f=[],S=!1,w=(E=0,h.length);E<w;E++)if(h[E].startsWith("###")){var b=h[E].substr(3),y=void 0===m[b]?"tree"===b?b:void 0:m[b],O=void 0===g[b]?"tree"===b?v.SettingsTitle:void 0:g[b];if(void 0!==y&&null!=O){if(l)void 0===l[void 0===n[y]?y:n[y]]&&(S=!0);_.push(y),f.push(O)}}0===_.length&&(_.push("tree"),f.push(v.SettingsTitle)),C.sync.document._titleNames=_,C.sync.document._titleLabels=f,C.activate(),S&&I.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:!0})}},onShowDlg:function(e){}})},_displayThumbnailGraph:function(e){if(!(M._versionModel instanceof n))throw Error("Version Model must be an instance of TreeDocument");S(),x.getElement(".version-subway-canvas").hide(),V&&V.deactivate(),function(){function e(e){e.displayMode=d.DISPLAY_MODES.THUMBNAIL_VIEW,E(e)}if(x.getElement(".version-thumbnail-canvas").show(),!C){var t;if(isNaN(Number(u.UserSettings.thumbnailGraphLayout)))t=i.OrientationMode[u.UserSettings.thumbnailGraphLayout];else for(var o in t=Number(u.UserSettings.thumbnailGraphLayout),d.THUMBNAIL_GRAPH_LAYOUT)if(d.THUMBNAIL_GRAPH_LAYOUT[o]===t){u._saveUserSettings("thumbnailGraphLayout",o,M._versionModel.useGlobalStorage,M._versionModel.globalStorageName,M._versionModel.webToWinComSocket);break}var n={NodeEdgeViewsTemplate:N,orientation:t,onNodeDropdownMenu:e,onNodeDoubleClick:_,onContextualEvent:e};(C=new i.SyncEGraphTree(x.getElement(".version-thumbnail-canvas"),n)).setModel(M._versionModel),C.createOverview(),I.isEffectivityBasedModeOrEffectivityBasedReuseMode()&&C.setHTML5DnD(!1),T&&(A.show(),A.setView("menuDisplayThumbnailView")),M.setSelectionMode(),M._thumbnailGraphView=C,C.setRootPosition(i.OrientationMode[u.UserSettings.thumbnailGraphLayout])}if(L!==d.DISPLAY_MODES.THUMBNAIL_VIEW){if(M.customizeColumns._USE_GLOBAL_STORAGE)M.customizeColumns.loadSettingsPromise().then((function(e){b(e)}));else b(M.customizeColumns.load());L=d.DISPLAY_MODES.THUMBNAIL_VIEW}else C.notifyUpdateNodes("_selectionMode")}(),!0===e&&C.reframeAll(),u._saveUserSettings("displayMode",L,M._versionModel.useGlobalStorage,M._versionModel.globalStorageName,M._versionModel.webToWinComSocket),A&&A.select("menuToggleOverview",u.UserSettings.displayThumbnailOverview),M.setThumbnailOverviewVisibility(),x.getElement(".version-thumbnail-canvas").hide(),x.getElement(".version-thumbnail-canvas").show(),I.publishEvent("_ENOXVersionExplorerViewChanged",{activeView:L})},_displaySubwayGraph:function(){x.getElement(".version-thumbnail-canvas").hide(),C&&(C.deactivate(),C.cleanup(!0)),S(),u._saveUserSettings("displayMode",L,M._versionModel.useGlobalStorage,M._versionModel.globalStorageName,M._versionModel.webToWinComSocket),I.publishEvent("_ENOXVersionExplorerViewChanged",{activeView:L})},_manageSelect:function(e){var t=e.data,i=e.notifyThumbnailUI,o=M._versionModel.getXSO().get();M._versionModel._SELECTION_MODE&d.SELECTION_MODES.MULTI_SELECT_ONLY?(o&&o.length>0||M._versionModel._USER_SET_MULTI_SELECT)&&!t&&M._versionModel._SELECTION_MODE&d.SELECTION_MODES.MULTI_SELECT_ONLY?(M._versionModel._SELECTION_MODE&d.SELECTION_MODES.MULTI_SELECT_ACTIVE||(M._versionModel._SELECTION_MODE|=d.SELECTION_MODES.MULTI_SELECT_ACTIVE),A&&A.activateMultiSelect(),k&&(I.unsubscribeEvent("_ENOXVersionExplorerManageMultiSelect",k),k=void 0),U=U||M._versionModel.getModelEvents().subscribe({event:"select"},f),G=G||M._versionModel.getModelEvents().subscribe({event:"unselect"},f),i=!0,A&&A[o&&o.length>1&&M._versionModel._SELECTION_MODE&d.SELECTION_MODES.WITH_COMMANDS?"showMultiSelectDropdown":"hideMultiSelectDropdown"]()):M._versionModel._USER_SET_MULTI_SELECT||(M._versionModel._SELECTION_MODE&=~d.SELECTION_MODES.MULTI_SELECT_ACTIVE,A&&A.deactivateMultiSelect(),U&&(M._versionModel.getModelEvents().unsubscribe(U),U=void 0),G&&(M._versionModel.getModelEvents().unsubscribe(G),G=void 0),k=k||I.subscribeEvent("_ENOXVersionExplorerManageMultiSelect",M._manageSelect),!0===t&&(M._versionModel.prepareAddDelete(),M._versionModel.unselectAll(),o.forEach((function(e){M._versionModel.getXSO().remove(e),e.options.grid.__checked__=!1})),M._versionModel.pushAddDelete()),i=!0):(M._versionModel._SELECTION_MODE&=~d.SELECTION_MODES.MULTI_SELECT_ACTIVE,M._versionModel._USER_SET_MULTI_SELECT=!1,A&&A.deactivateMultiSelect(),U&&(M._versionModel.getModelEvents().unsubscribe(U),U=void 0),G&&(M._versionModel.getModelEvents().unsubscribe(G),G=void 0),M._versionModel.getXSO().get().length>1&&(M._versionModel.prepareAddDelete(),M._versionModel.unselectAll(),M._versionModel.pushAddDelete()),o.forEach((function(e){e.options.grid.__checked__=!1})),M._versionModel.getXSO().empty(),i=!0),A&&A.setMultiSelectCount(o.length),i&&L===d.DISPLAY_MODES.THUMBNAIL_VIEW&&C&&C.notifyUpdateNodes("_selectionMode"),L===d.DISPLAY_MODES.SUBWAY_VIEW&&V&&V.updateSelectionMode(!0)},setSelectionMode:function(e){e!==M._versionModel._SELECTION_MODE&&(e>=0&&(M._versionModel._SELECTION_MODE=e),A&&A[M._versionModel._SELECTION_MODE&d.SELECTION_MODES.MULTI_SELECT_ONLY&&M._versionModel._SELECTION_MODE&d.SELECTION_MODES.WITH_COMMANDS?"showMultiSelect":"hideMultiSelect"](),this._manageSelect({notifyThumbnailUI:!0}))},onMultiSelectDropdownClick:function(e){var t=I.subscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",(function(i){I.unsubscribeEvent("_ENOXVersionExplorerInternalRefreshCompleted",t);var o=M._versionModel.getXSO().get();I._getMultiSelectMenuListPromise(o).then((function(t){r.displayNodeDropdownMenu.bind(I)({treeNode:o,target:null,menuList:t,position:{x:e.clientX,y:e.clientY},dropdownContainer:x})}))}));I.publishEvent("_ENOXVersionExplorerInternalRefresh",{reframe:!1,contextualMenu:!0})},build:function(){g(),x=e.createElement("div",{class:"version-global-div",html:['<div class="version-explorer-toolbar-revisionmode-container">','<div class="versionexplorer-toolbar" style="display:none">',"</div>",'<div class="version-explorer-revisionmodetext-container">','<div class="versionexplorer-revisionmode" style="display:none">',"</div>",'<div class="versionexplorer-graphproprietary-container" style="display:none">','<div class="versionexplorer-graphproprietary">',"</div>","<div> &nbsp; "+v.Revisions,"</div>","</div>","</div>","</div>",'<div class="modal-header versionexplorer-legend">','   <span class="close fonticon fonticon-cancel" title=""></span>',"</div>",'<div class="modal-header versionexplorer-help  versionexplorer-help-hidden">','   <span class="help-text"> '+v.highlightLinksMessage+"</span>",'   <span class="close fonticon fonticon-cancel" title=""></span>',"</div>",'<div class="version-thumbnail-canvas">',"</div>",'<div class="version-subway-canvas">',"</div>"].join("\n")}),O&&(O=e.extendElement(O)).setContent(x),function(){var e=x.getElement(".version-thumbnail-canvas");e&&e.addEvent("resize",(function(){!function(){var e=x.getElement(".version-thumbnail-canvas");if(e&&"none"!==e.getStyle("display")&&void 0!==C){var t=e.getBoundingClientRect();C&&C.setSize(t.width,t.height)}}()}));x.getElement(".versionexplorer-legend span.close").addEvent("mousedown",(function(e){A&&A.handleThumbnailGraphToolbar(e,A.getItem("menuToggleLegend"))})),x.getElement(".versionexplorer-help span.close").addEvent("mousedown",(function(e){A&&A.handleThumbnailGraphToolbar(e,A.getItem("menuToggleHelp"))})),I.subscribeEvent("ENOXVersionExplorerLoadCompleted",w),I.subscribeEvent("_ENOXVersionExplorerViewChanged",w)}()},_getActiveView:function(){return L},cleanup:function(){C&&C.cleanup(),C=null,V&&V.cleanup(),V=null,L=null},setLoadingMask:function(){P||(P=new p(x,1e3,m.loadingText))},unmask:function(){P&&(P.unmask(),P=null)},setFocus:function(e){var t=e instanceof h?[e]:M._versionModel.getXSO().get();Array.isArray(t)&&t.length>0&&(L===d.DISPLAY_MODES.THUMBNAIL_VIEW?C&&C.reframeOn(t):V&&V.setFocus(t[t.length-1]))},_highlightParents:function(e){if(!0===u.UserSettings.highlightParentConnectionsOnSelect){var t=y(e);!0===u.UserSettings.highlightParentConnectionsOnSelect&&t&&t.links&&this._highlightLinks(t.links)}},_unhighlightParents:function(e){var t=y(e);t&&t.nodes&&this._unhighlightNodes(t.nodes),t&&t.links&&this._unhighlightLinks(t.links)},_highlightNodes:function(e){Array.isArray(e)?e.forEach((function(e){e instanceof h?e.highlight():"string"==typeof e&&1===(e=M._versionModel.searchByID(e)).length&&e[0].highlight()})):"function"==typeof e&&M._versionModel._nodeList.filter(e).forEach((function(e){e.highlight()}))},_unhighlightNodes:function(e){Array.isArray(e)?e.forEach((function(e){e instanceof h?e.unhighlight():"string"==typeof e&&1===(e=M._versionModel.searchByID(e)).length&&e[0].unhighlight()})):"function"==typeof e&&M._versionModel._nodeList.filter(e).forEach((function(e){e.unhighlight()}))},_highlightLinks:function(e){Array.isArray(e)&&e.length&&e.forEach((function(e){M._versionModel.highlightLink(e)}))},_unhighlightLinks:function(e){Array.isArray(e)&&e.length&&e.forEach((function(e){M._versionModel.unhighlightLink(e)}))},updateParentHighlighting:function(e){var t;u._saveUserSettings("highlightParentConnectionsOnSelect",e,M._versionModel.useGlobalStorage,M._versionModel.globalStorageName,M._versionModel.webToWinComSocket),M._versionModel.getXSO().get().forEach((function(i){(t=y(i))&&t.links&&M[!0===e?"_highlightLinks":"_unhighlightLinks"](t.links)}))}});var M=this,O=void 0,T=!0,D={maxScale:1,minScale:.25},I=void 0,C=void 0,V=void 0,N=void 0,L=void 0,A=void 0,x=void 0,U=void 0,G=void 0,k=void 0,R=void 0,P=void 0;M._parent(t),M._versionModel=t.versionModel,M.customizeColumns=t.customizeColumns,t._isODT&&e.Class.implement.call(this,{_ODTGetThumbnailView:function(){return C},_ODTGetSubwayView:function(){return V}})}})}));