define("DS/CATW3DCommands/CATW3DMoveBarUX",["UWA/Class","DS/CATWebUXComponents/CATWebUXNotifBar","i18n!DS/CATW3DCommands/assets/nls/CATW3DMoveBarUX"],(function(e,t,n){"use strict";return e.extend({init:function(e){let o,i,a,l,s;o=n.PositionModifiedLbl,i=n.PositionModifiedOK,a=n.PositionModifiedCancel,l=n.PositionLockedLbl,s=n.PositionLockedLink;var r,c,d,h,u=e.nlsModifLbl||o;this.show=function(){r||(r=new t({className:"c3dMoveCmdDlg"}).inject(e.uiFrame),this.hide(),c=r.add({msgType:"primary",message:u||o,closable:!1,buttons:[{className:"spinner"},{className:"primary",label:i,onClick:e.onSave},{className:"default",label:a,onClick:e.onCancel}]}),this.hideSpinner(),this.hideSave(),(d=r.add({msgType:"warning",message:l,closable:!1,buttons:[{className:"link",label:s,onClick:e.onCancelLocked}]})).hide()),r.getContent().parentElement.parentElement.setStyle({overflow:"hidden"}),r.show()},this.showSave=function(){this.hideSpinner(),c&&(c.buttons[1].show(),h=!0)},this.showSpinner=function(){!1===h&&c.buttons[0].show()},this.showLock=function(){d&&d.show()},this.hide=function(){r&&r.hide()},this.hideSave=function(){c&&(h=!1,c.buttons[1].hide())},this.hideSpinner=function(){c&&c.buttons[0].hide()},this.hideLock=function(){d&&d.hide()},this.getCurrentMoveBar=function(){return r},this.destroy=function(){r&&r.destroy(),r=c=d=null}}})})),define("DS/CATW3DCommands/CATW3DSetIdentityMatrixCmd",["DS/CATWebUXComponents/DMUCommand","DS/Selection/CSOManager","DS/Visualization/ThreeJS_DS","DS/CATW3DMoveManager/CATW3DMoveReferent","DS/CATW3DMoveManager/CATW3DMoveManager","DS/PADUtils/PADContext","DS/CoreEvents/Events"],(function(e,t,n,o,i,a,l){"use strict";return e.extend({init:function(e){this._parent(e,{mode:"shared",isAsynchronous:!1}),this.setRepeatMode(!1),this.beginExecute=function(){l.publish({event:"onCommandStart/BEGIN",data:{_id:"CATW3DSetIdentityPositionHdr"}});var e=[],s=a.get(),r=i.giveMoveManager({context:s}),c=o.getMoveReferentManager({context:s});t.get().forEach((function(t){var n=c.getMoveReferent(t.pathElement);n&&e.push({path:n})})),e.length&&(r.onMoveBegin({objectsMoved:e,from:this,moveMode:"Persistent"}),r.onMove({objectsMoved:e,from:this,leafMatrix:new n.Matrix4}),r.onMoveEnd({from:this,status:"Moved"})),this.done()}}})})),define("DS/CATW3DCommands/CATW3DCmdsUtils",["DS/ENOPAD3DViewer/utils/PAD3DViewerModelServices"],(function(e){"use strict";var t={},n=["PPRContext","Drawing"];return t.isPLMNode=function(t){return t&&e.isPLMNode(t)},t.isPLMReferenceNode=function(t){return t&&e.isReference(t)},t.isPLMInstanceNode=function(t){return t&&e.isInstance(t)},t.isPLMLeafNode=function(t){return t&&e.is3DLeaf(t)},t.getLevelSelectorLevels=function(o){if(o){var i,a,l,s=o.pathElement,r=o.pathElementCurrent,c=o.onInfoCompleted,d=o.context,h=d.getController(),u=["ds6w:label","type_icon_url"];if(s&&d){var f,v,m=[],g=[],C=null,D={levels:m},p=s.clone();for(p.internalPath.length=0,v=p.getLastElement(!0);v;){var M={};if(f=e.getNodeType(v),t.isPLMInstanceNode(v)){if(0===m.length&&1===v.children.length){M.pathElement=p.clone();var E=v.children[0];M.pathElement.addElement(E),g.push(M.idRef=e.getNodeID(E)),g.push(M.idInst=e.getNodeID(v)),C=1}}else if(t.isPLMReferenceNode(v))M.pathElement=p.clone(),g.push(M.idRef=e.getNodeID(v)),l=p.externalPath.length>1?p.externalPath[p.externalPath.length-2]:null,t.isPLMInstanceNode(l)&&g.push(M.idInst=e.getNodeID(l));else if(t.isPLMLeafNode(v)&&(!o.fromFirstRef||p.getParentPath()&&p.getParentPath().isEqual(d.getRootBagPath())))M.pathElement=p.clone(),g.push(M.idRef=e.getNodeID(v));else if(v.getDibInfo&&!a)a=!0,M.pathElement=p.clone(),g.push(M.idRef=v.getDibInfo().id),(l=p.externalPath.length>1?p.externalPath[p.externalPath.length-2]:null)&&l.getDibInfo&&g.push(M.idInst=l.getDibInfo().id);else if(n.indexOf(f)>-1&&t.isPLMNode(v)){var S=p.externalPath.length>1?p.externalPath[p.externalPath.length-2]:null;t.isPLMNode(S)||(M.pathElement=p.clone(),g.push(M.idRef=e.getNodeID(v)))}M.pathElement&&(null===C&&r&&r.isEqual(M.pathElement)&&(C=m.length),m.push(M)),v=(p=p.getParentPath())?p.getLastElement(!0):void 0}return null!==C&&(D.currentLevel=C),h.isColorizeActivated()&&h.isStandalone()&&u.push(i=h.getBIColorMap().predicate),d.getController().getAttributes({ids:g,attributes:u,callbacks:{onComplete:function(e){m.forEach((function(t){t.name=e[t.idRef]?e[t.idRef]["ds6w:label"]:"",t.idInst&&e[t.idInst]&&e[t.idInst]["ds6w:label"]&&(t.name+=" ("+e[t.idInst]["ds6w:label"]+")"),t.icon=e[t.idRef]?e[t.idRef].type_icon_url:void 0,i&&(t.canvasColor=h.getColorValueForPredicate(e[t.idRef][i])),delete t.idRef,delete t.idInst})),c&&c()},onFailure:function(){m.forEach((function(e){delete e.idRef,delete e.idInst}))}}}),D}}},Object.freeze(t)})),define("DS/CATW3DCommands/CATW3DLevelSelectorCmd",["DS/CATWebUXComponents/DMUCommand","DS/LevelSelector/LevelSelector","DS/Selection/CSOManager","DS/Selection/HSOManager","DS/VisuEvents/EventsManager","DS/VisuEvents/ScreenEvent","DS/CATW3DMoveManager/CATW3DMoveReferent","DS/CATW3DCommands/CATW3DCmdsUtils","DS/PADUtils/PADContext","DS/ENOPAD3DViewer/utils/PAD3DViewerModelServices","DS/CoreEvents/Events"],(function(e,t,n,o,i,a,l,s,r,c,d){"use strict";let h,u,f=e.extend({init:function(e){this._parent(e,{mode:"shared",isAsynchronous:!0}),this.options=e;var f,v,m,g,C,D,p,M,E=this,S=r.get(),x=h||"DMULevelSelectorHdr"!==e.ID,P=function(e){C=null,e&&e.from&&1===e.from.length&&e.from[0].event&&"touchend"===e.from[0].event.type&&1===e.from[0].event.changedTouches.length&&(C=e.from[0])};h=x,u=e.ID,i.addEvent(document,"onRelease",P),this.beginExecute=function(){d.publish({event:"onCommandStart/BEGIN",data:{_id:"CATW3DRobotLevelSelectorHdr",cmdClass:this}}),M=!0,g=n.onChange((function(){M=!1,S.getExecutionContext?E.cancelExecute():E.cancel()})),D=[];var e=f;if(!e){var r=n.get();f=r.length>0?r[r.length-1]:void 0,e=f,v=f?f.pathElement:void 0;for(var h=0;h<r.length-1;++h)D.push(r[h])}if(p&&(p=n.get()),e&&e.pathElement){S.getFrameWindow().getContextualUIManager().hideContextualMenus();var u={x:0,y:0};if(C){var P=C.event.changedTouches[0];u.x=P.clientX,u.y=P.clientY}else{var b=i.getMouseEvents(a.MouseButton.NONE);b&&b.length&&(u.x=b[0].event.clientX,u.y=b[0].event.clientY)}C=null;var L=v;if(x){var R=(L=l.getMoveReferentManager({context:S}).getMoveReferent(v))?L.getLastElement(!0):null;R&&c.isInstance(R)&&R.children.length&&L.addElement(R.children[0])}var I={display:{type:"position",x:u.x,y:u.y},uiFrame:S.getFrameWindow().getUIFrame(),getLevels:function(t){var n=s.getLevelSelectorLevels({fromFirstRef:!1,pathElement:e.pathElement,pathElementCurrent:L,onInfoCompleted:t,context:S});if(n&&x){var o=l.getMoveReferentManager({context:S});n.selectColor="#ff821e",n.selectOverColor="#ffb477";for(var i=n.levels.length-1;i>=0;--i){var a=n.levels[i],r=a.pathElement.getLastElement(!0);if(c.isReference(r))if(c.isRepReference(r))a.selection="notCurrent";else o.getMoveReferent(a.pathElement)||(a.selection="notCurrent");else a.selection="notCurrent"}}return n},onHover:function(e){o.empty(),o.add(e)},onLeave:function(e){f&&(o.remove(e),o.add(f))},onSelect:function(e){if(g=n.unsubscribe(g),e&&e.pathElement&&0===e.pathElement.internalPath.length){x&&l.getMoveReferentManager({context:S}).addMoveReferent(e.pathElement),f.pathElement=e.pathElement,o.empty(),p||n.empty();var t=D.concat(p||f),i=m,a=p;setTimeout((function(){o.add(t),a||n.add(t),i&&i(e),S.getExecutionContext?S.getFrameWindow().getContextualUIManager()._showContextualBar({hideWithDistance:!0}):S.getFrameWindow().getContextualUIManager().showContextualBar({hideWithDistance:!0})}),S.getExecutionContext?50:0)}M=!1,S.getExecutionContext?E.cancelExecute():E.cancel()}};t.createView(I)}else S.getExecutionContext?E.cancelExecute():E.cancel()},this.cancelExecute=function(){M&&(p||f)&&(o.empty(),o.add(p||f)),g=n.unsubscribe(g),m=void 0,f=void 0,v=void 0,p=void 0,t.destroyView(),this.done()},this.pauseExecute=function(){E.cancelExecute()},this.resumeExecute=function(){E.beginExecute()},"CATW3DRobotLevelSelectorHdr"===e.ID&&(x=!1,this.setRobotParams=function(e){m=e.selectCB,p=e.doNotModifyCSO,f={pathElement:e.pathContext.clone()},v=e.pathCurrent.clone()}),"DMULevelSelectorHdr"===e.ID&&(this.showReferentLevel=function(e){x=e});var b=this._destroy;this._destroy=function(){E&&(i.removeEvent(document,"onRelease",P),b.call(E),E=S=null)}}});return f.displayReferentLevel=function(e){"DMULevelSelectorHdr"===u&&(h=e)},f}));