define("DS/VCXKeyFramer/VCXObjectAnimation",["require","exports"],(function(e,t){"use strict";class i{constructor(){this._Tracks={},this._AnimatedTracks=[],this._scenario=null}unInitialize(){for(var e in this._scenario=null,this._AnimatedTracks=[],this._Tracks)this._Tracks.hasOwnProperty(e)&&this._Tracks[e].unInitialize()}ResetAnimatedTracks(){this._AnimatedTracks=[]}AddAnimatedTrack(e,t){let i=this._AnimatedTracks[e]??{};i[t]=!0,this._AnimatedTracks[e]=i}GetTracks(){return this._Tracks}SetScenario(e){this._scenario=e}GetScenario(){return this._scenario}SetBoostDirty(){this._AnimatedTracks=[],this._scenario&&this._scenario.SetBoostDirty()}GetListTrackNames(e){for(var t in this._Tracks)if(this._Tracks.hasOwnProperty(t)){var i=t;e.push(i)}}AddTrack(e,t){t&&(this.SetBoostDirty(),this._Tracks[e]=t,t.SetObjectAnimation(this))}GetAnimatedTracksForBlockRange(e){var t={},i=this._AnimatedTracks;if(i&&e)for(var r=e.start;r<=e.end;r++){var a=i[r];for(var s in a)a.hasOwnProperty(s)&&(t[s]=!0)}else for(var s in this._Tracks)this._Tracks.hasOwnProperty(s)&&(t[s]=!0);return t}GetTrack(e){return e in this._Tracks?this._Tracks[e]:null}GetMaxFrame(){var e=0;for(var t in this._Tracks)if(this._Tracks.hasOwnProperty(t)){var i=this._Tracks[t].GetMaxFrame();i>e&&(e=i)}return e}RemoveTrack(e){this.SetBoostDirty();var t=this._Tracks[e];t&&t.SetObjectAnimation(null),delete this._Tracks[e]}GetTrackNumber(){var e=0;for(var t in this._Tracks)this._Tracks.hasOwnProperty(t)&&e++;return e}Clone(){var e=new i,t=[];this.GetListTrackNames(t);for(var r=0;r<t.length;r++){var a=t[r],s=this.GetTrack(a);if(s){var n=s.Clone();e.AddTrack(a,n)}}return e}}return i}));var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXKeyFramer/VCXKeyFramer",["require","exports","DS/VCXWebProperties/VCXPropertyMapNeutrals","DS/VCXWebProperties/VCXPropertyMap","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebTracks/VCXInterpolatorConstant","DS/VCXWebTracks/VCXInterpolatorLinear","DS/VCXWebTracks/VCXInterpolatorCubic","DS/VCXWebProperties/VCXPropertyInfo"],(function(e,t,i,r,a,s,n,o,l,h){"use strict";i=__importDefault(i),r=__importDefault(r),a=__importDefault(a),s=__importDefault(s),n=__importDefault(n),o=__importDefault(o),l=__importDefault(l),h=__importDefault(h);return class{constructor(e){this._LinksCleaned=!1,this._modifiableServer=e,this._restoreSet=new Map,this._Neutrals=new i.default(this._restoreSet),this._DefaultInterpolators=new Map,this._Interpolators=[new n.default,new o.default,new l.default],this._contextMngr=null}unInitialize(){this._modifiableServer?.unInitialize(),this._modifiableServer=null,this._restoreSet=new Map,this._Neutrals=null,this._DefaultInterpolators=new Map,this._Interpolators=[]}SetDefaultInterpolator(e,t){this._DefaultInterpolators.set(e,t)}GetDefaultInterpolator(e){var t=this._DefaultInterpolators.get(e)??1;return this._Interpolators[t]??this._Interpolators[0]}AddNeutrals(e,t){this._modifiableServer?.AddModifiable(e);var i=e.GetHashing();this._Neutrals?.AddOrModifyPropertySet(i,t)}RemoveNeutrals(e){this._Neutrals?.RemovePropertySet(e)}GetNeutrals(e){return this._Neutrals?.GetPropertySet(e)??null}GetNeutralsHash(){let e=[];return this._Neutrals?.GetListModifiables(e),e}GetHashModifiablePresentInRestoreSet(){return Array.from(this._restoreSet.keys())}GetPropertiesNamePresentInRestoreSet(e){return Array.from(this._restoreSet.get(e)?.keys()??[])}RestoreNeutralPropertiesOneModifiable(e,t){var i=this._restoreSet.get(e);if(i){var r=this._modifiableServer?.GetModifiableFromHashing(e);if(r&&!1!==r.IsLiving()){var a=this._Neutrals?.GetPropertySet(e);if(a){for(let e of i.keys())if(i.has(e)){let i=null;if(t){var s=t.GetTrack(e);s&&(i=s.GetKey(0))}if(!i){var n=a.GetProperty(e);if(n){var o=n.GetPropertyValue();r.OnChangeProperty(e,o)}}}var l=r.GetVirtualProperties();for(var h in l)if(l.hasOwnProperty(h)){let e=r.GetInterpolator(h);e||(e=this.GetDefaultInterpolator(h));var d=e.GetInterpolatedValue(a,h,0,null);if(d){r.OnChangeProperty(h,d,{})}}r.OnChangePropertiesEnd(),this.EmptyRestoreSetOneModifiable(r)}else console.log("Properties has been changed but neutrals not found!")}}}AddPropertyToRestoreSet(e,t){let i=this._restoreSet.get(e)??new Map;i.set(t,!0),this._restoreSet.set(e,i)}EmptyRestoreSetOneModifiable(e){if(e){var t=e.GetHashing();if(this._restoreSet.has(t))e.GetRequiredPropertiesForTransition()||this._restoreSet.delete(t)}}InitRestoreSetFromNeutrals(e){var t=[];e?t.push(e):this._Neutrals?.GetListModifiables(t);for(var i=0;i<t.length;i++){var r=t[i],a=this._Neutrals?.GetPropertySet(r);if(a)for(var s in a.map)a.map.hasOwnProperty(s)&&this.AddPropertyToRestoreSet(r,s)}}HasLinksCleaned(){return this._LinksCleaned}SetLinksCleaned(e){return this._LinksCleaned=e}RestoreNeutralProperties(e){var t=[];this._Neutrals?.GetListModifiables(t);for(var i=0;i<t.length;i++){var r=t[i];let a=null;e&&(a=e.GetObjectAnimation(r)),this.RestoreNeutralPropertiesOneModifiable(r,a)}}UpdatePropertiesOneModifiable(e,t,i,r,a){var s=0,n=this._modifiableServer?.GetModifiableFromHashing(i);if(!n)return s;if(!e.HasFilterAnimatedModifiables()&&!1===n.IsLiving())return 0;var l=this._Neutrals?.GetPropertySet(i)??null,h=e.GetObjectAnimation(i);if(h){var d={};if(a)d[a]=!0;else{d=h.GetAnimatedTracksForBlockRange(r);var u=n.GetVirtualProperties();for(var _ in u)u.hasOwnProperty(_)&&(d[_]=!0)}for(var _ in d){var f=n.GetInterpolator(_);if(f||(f=this.GetDefaultInterpolator(_)),"Actor.Pulse.Type"===_&&f.SetRangeChanged(!1),this._contextMngr&&this._contextMngr.getContextFromName("OpenSMGXML")){var p=l?.GetProperty(_);if(!p&&l){var m=n.GetProperty(_);l.AddOrModifyProperty(m),this.AddNeutrals(n,l)}}var c=f.GetInterpolatedValue(l,_,t,h.GetTracks());if(c){var v={};f instanceof o.default&&(v.rangeChanged=f.GetRangeChanged()),n.OnChangeProperty(_,c,v),s++}}s>0&&n.OnChangePropertiesEnd()}return s}UpdateProperties(e,t,i,r){var a=e.GetBlockRangeToJumpToFrame(t);if(i)this.UpdatePropertiesOneModifiable(e,t,i,a,r);else{var s=e.GetAnimatedModifiablesForRange(a);for(var n in s)if(s.hasOwnProperty(n)){var o=this._modifiableServer?.GetModifiableFromHashing(n);o&&this.UpdatePropertiesOneModifiable(e,t,n,a,r)}}}GetModifiableFromHashing(e){return this._modifiableServer?.GetModifiableFromHashing(e)??null}UpdateProperty(e,t,i,r){var a=this._modifiableServer?.GetModifiableFromHashing(i);if(a){var s=this._Neutrals?.GetPropertySet(i);if(s){var n=e.GetObjectAnimation(i);if(n){if(n.GetTrack(r)){var o=a.GetInterpolator(r);o||(o=this.GetDefaultInterpolator(r));var l=o.GetInterpolatedValue(s,r,t,n.GetTracks());l&&a.OnChangeProperty(r,l)}a.OnChangePropertiesEnd()}}}}GetPropertiesAtTimeZero(e){var t=new n.default,i=new r.default;if(!this._modifiableServer)throw new Error("ModifiableServer null");var o=this._modifiableServer.GetHashTable();for(var l in o)if(o.hasOwnProperty(l)){var d=l;let r=null;if(e.GetApplyNeutralAtGoToScenario()&&(r=this._Neutrals?.GetPropertySet(d)??null,r)){var u=new a.default;for(var _ in r.map)r.map.hasOwnProperty(_)&&u.AddOrModifyProperty(r.map[_]);i.AddOrModifyPropertySet(d,u)}var f=e.GetObjectAnimation(d);if(f)for(var p in f.GetTracks())if(f.GetTracks().hasOwnProperty(p)){var m=t.GetInterpolatedValue(r,p,0,f.GetTracks());if(m){var c=new s.default(new h.default(p,0),m);i.AddOrModifyProperty(d,c)}}}return i}GetPropertiesOneModifiableAtTimeZero(e,t){var i=new a.default;if(!t||!e)return i;var r=new n.default,o=t.GetHashing();let l=null;e.GetApplyNeutralAtGoToScenario()&&(l=this._Neutrals?.GetPropertySet(o)??null,l&&(i=l.Clone()));var d=e.GetObjectAnimation(o);if(d)for(var u in d.GetTracks())if(d.GetTracks().hasOwnProperty(u)){var _=r.GetInterpolatedValue(l,u,0,d.GetTracks());if(_){var f=new s.default(new h.default(u,0),_);i.AddOrModifyProperty(f)}}return i}SetContextMngr(e){this._contextMngr=e}}}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXKeyFramer/VCXScenarioVisibility",["require","exports","DS/VCXWebVisibility/VCXIVisibility","DS/VCXWebComponents/VCXWebComponentOccurrence"],(function(e,t,i,r){"use strict";i=__importDefault(i),r=__importDefault(r);class a{constructor(){this._visibilityMap={},this._visibilityMapCollab={},this._mode=a.EVisState.Both}GetMode(){return this._mode}SetMode(e){this._mode=e}Empty(){this._visibilityMap={},this._visibilityMapCollab={}}GetVisibles(){var e=[];for(var t in this._visibilityMap)this._visibilityMap.hasOwnProperty(t)&&this._visibilityMap[t]===i.default.EVisState.Visible&&e.push(t);return e}GetInvisibles(){var e=[];for(var t in this._visibilityMap)this._visibilityMap.hasOwnProperty(t)&&this._visibilityMap[t]===i.default.EVisState.Hidden&&e.push(t);return e}GetVisibleCollabs(){var e=[];for(var t in this._visibilityMapCollab)this._visibilityMapCollab.hasOwnProperty(t)&&this._visibilityMapCollab[t]===i.default.EVisState.Visible&&e.push(t);return e}AddVisibles(e){for(var t=0;t<e.length;t++)this._visibilityMap[e[t]]=i.default.EVisState.Visible}AddInvisibles(e){for(var t=0;t<e.length;t++)this._visibilityMap[e[t]]=i.default.EVisState.Hidden}AddVisibleCollabs(e){for(var t=0;t<e.length;t++)this._visibilityMapCollab[e[t]]=i.default.EVisState.Visible}AddVisibleToGroups(e){if(e){e instanceof r.default&&e.IsRenderable&&e.IsRenderable()||(this._visibilityMap[e.GetID()]=i.default.EVisState.Visible);var t=e.QueryInterface("VCXIModelNavigable")?.getChildren();if(!t)return;for(var a=0;a<t.length;a++){var s=t[a].GetObject();s&&this.AddVisibleToGroups(s)}}}AddVisibleToDescendants(e){if(e){this._visibilityMap[e.GetID()]=i.default.EVisState.Visible;var t=e.QueryInterface("VCXIModelNavigable")?.getChildren();if(!t)return;for(var r=0;r<t.length;r++){var a=t[r].GetObject();a&&this.AddVisibleToDescendants(a.GetObject())}}}AddVisible(e){e&&(this._visibilityMap[e.GetID()]=i.default.EVisState.Visible)}RemoveVisible(e){e&&delete this._visibilityMap[e.GetID()]}AddInvisibleToDescendants(e){if(e){this._visibilityMap[e.GetID()]=i.default.EVisState.Hidden;var t=e.QueryInterface("VCXIModelNavigable")?.getChildren();if(!t)return;for(var r=0;r<t.length;r++){var a=t[r].GetObject();a&&this.AddInvisibleToDescendants(a)}}}AddInvisible(e){e&&(this._visibilityMap[e.GetID()]=i.default.EVisState.Hidden)}RemoveInvisible(e){e&&delete this._visibilityMap[e.GetID()]}AddVisibleCollab(e){this._visibilityMapCollab[e.GetID()]=i.default.EVisState.Visible}RemoveVisibleCollab(e){delete this._visibilityMapCollab[e.GetID()]}FindVisibleCollab(e){return this._visibilityMapCollab[e]===i.default.EVisState.Visible?1:-1}IsVisibleWithParents(e){var t=e.GetID(),r=-1;if(e.IsKindOf("VCXWebComponentOccurrence")&&!e.IsDressup){var a=this._visibilityMap[t];a===i.default.EVisState.Hidden?r=0:a===i.default.EVisState.Visible&&(r=1),-1===r&&(2===this._mode?r=1:1===this._mode?r=0:0===this._mode&&(r=-1))}else this._visibilityMapCollab[t]===i.default.EVisState.Visible&&(r=1);return r}TransfertVisibilityFromID(e,t,i=!1){return void 0!==this._visibilityMap[e]&&(i||(t&&(this._visibilityMap[t]=this._visibilityMap[e]),delete this._visibilityMap[e]),!0)}TransfertVisibilityCollabFromID(e,t,i=!1){return void 0!==this._visibilityMapCollab[e]&&(i||(t&&(this._visibilityMapCollab[t]=this._visibilityMapCollab[e]),delete this._visibilityMapCollab[e]),!0)}Clone(e){var t=new a;return t.SetMode(e.GetMode()),t.AddVisibles(e.GetVisibles()),t.AddInvisibles(e.GetInvisibles()),t.AddVisibleCollabs(e.GetVisibleCollabs()),t}}return function(e){let t;!function(e){e[e.Both=0]="Both",e[e.Visible=1]="Visible",e[e.Invisible=2]="Invisible"}(t=e.EVisState||(e.EVisState={}))}(a||(a={})),a}));__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXKeyFramer/VCXScenario",["require","exports","DS/CoreEvents/Events","DS/VCXKeyFramer/VCXObjectAnimation","DS/VCXKeyFramer/VCXScenarioVisibility","DS/VCXWebTracks/VCXTrack","DS/VCXWebTracks/VCXKey","DS/VCXWebComponents/VCXWebComponentBaseExperience","DS/VCXWebProperties/VCXPropertyValueString"],(function(e,t,i,r,a,s,n,o,l){"use strict";r=__importDefault(r),a=__importDefault(a),s=__importDefault(s),n=__importDefault(n),o=__importDefault(o),l=__importDefault(l);class h extends o.default{constructor(){super(),this._ts=0,this._name="",this._IsEMSDirty=!0,this._animations={},this._visibility=new a.default,this._bApplyNeutralAtGoToScenario=!0,this._bIsTransition=!1,this._bZoomFitAll=!1,this._maxFrameOverride=null,this._maxFrameCache=null,this._CurrentFrame=0,this._PreviousFrame=0,this._sequenceMaxFrame=null,this._markersTrack=new s.default,this._currentMarkerSequence="",this._AnimatedModifiables=[],this._AnimatedModifiablesMaxFrame=0,this._AnimatedModifiablesNbBlocks=200,this._LastBlock=0,this._bIsBounce=!1,this._bIsLoop=!1,this._bIsReverse=!1,this._bIsBouncing=!1,this._speed=1,this._conceal=!1,this._scenarioType=h.EScenarioType.Scenario,this._docId=-1,this._pipDocId=-1,this._docDirty=!1}IsEMSDirty(){return this._IsEMSDirty}SetEMSDirty(e){this._IsEMSDirty=e}unInitialize(){for(var e in this._AnimatedModifiables=[],this._visibility=null,this._animations){if(this._animations.hasOwnProperty(e))this._animations[e].unInitialize()}this._animations={}}SetBoostDirty(){this.SetEMSDirty(!0),this._maxFrameCache=null,this._AnimatedModifiables=[],this._LastBlock=0}SetDocId(e){this._docId=e,this._ts=Date.now()}GetDocId(){return this._docId}SetPIPDocId(e){this._pipDocId=e,this._ts=Date.now()}GetPIPDocId(){return this._pipDocId>=0?{docID:this._pipDocId,timeStamp:this._ts,type:"HR"}:{docID:this._docId,timeStamp:this._ts,type:"TN"}}SetDocDirty(e){this._docDirty!==e&&(this._docDirty=e,i.publish({event:"VCX_SCENARIO_BLURED",data:{scenario:this}}))}GetDocDirty(){return this._docDirty}SetCurrentFrame(e){this._CurrentFrame=e,i.publish({event:"VCX_UPDATE_MARKER_SEQ",data:{time:e,scenarioID:this.GetID()}})}GetCurrentFrame(){return this._CurrentFrame}SetPreviousFrame(e){this._PreviousFrame=e}GetPreviousFrame(){return this._PreviousFrame}SetIsTransition(e){void 0!==e&&(this._bIsTransition=e)}GetIsTransition(){return this._bIsTransition}SetIsBounce(e){void 0!==e&&(this._bIsBounce=e)}GetIsBounce(){return this._bIsBounce}SetIsLoop(e){void 0!==e&&(this._bIsLoop=e)}GetIsLoop(){return this._bIsLoop}SetIsReverse(e){void 0!==e&&(this._bIsReverse=e)}GetIsReverse(){return this._bIsReverse}SetIsBouncing(e){void 0!==e&&(this._bIsBouncing=e)}GetIsBouncing(){return this._bIsBouncing}SetSpeed(e){void 0!==e&&(this._speed=e)}GetSpeed(){return this._speed}GetType(){return this.componentType}GetVisibility(){return this._visibility}SetVisibility(e){this.SetEMSDirty(!0),this._visibility=e}GetConcealed(){return this._conceal}SetConcealed(e){this._conceal=e,i.publish({event:"VCX_SCENARIO_CONCEAL_CHANGED",data:{scenario:this,concealStatus:e}})}SetZoomFitAll(e){this._bZoomFitAll=e}GetZoomFitAll(){return this._bZoomFitAll}SetApplyNeutralAtGoToScenario(e){this._bApplyNeutralAtGoToScenario=e}GetApplyNeutralAtGoToScenario(){return this._bApplyNeutralAtGoToScenario}AddObjectAnimation(e,t){e?(this._animations[e]=t,this.SetBoostDirty(),t&&t.SetScenario(this)):console.log("HASHING EMPTY in VCXScenario::AddObjectAnimation")}RemoveObjectAnimation(e){this.SetBoostDirty();let t=this._animations[e];t&&t.SetScenario(null),delete this._animations[e]}GetObjectAnimation(e){return e in this._animations?this._animations[e]:null}GetListModifiables(e){for(var t in this._animations)if(this._animations.hasOwnProperty(t)){var i=t;e.push(i)}}HasAnimation(){for(var e in this._animations)if(this._animations.hasOwnProperty(e)){var t=this._animations[e],i=[];t.GetListTrackNames(i);for(var r=0;r<i.length;r++){var a=i[r],s=t.GetTrack(a),n=0;if(s)if(1===(n=s.GetSize())){if(null===s.GetPreviousKey(0))return!0}else if(n>1)return!0}}return!1}SetMaxFrame(e){this._maxFrameOverride=e}GetMaxFrame(){if(null!==this._maxFrameOverride)return this._maxFrameOverride;if(this._maxFrameCache)return this._maxFrameCache;var e=0;for(var t in this._animations)if(this._animations.hasOwnProperty(t)){let r=this._animations[t];var i=r?.GetMaxFrame()??0;i>e&&(e=i)}return this._maxFrameCache=e,e}InitForPlay(e){for(var t in this._animations)if(this._animations.hasOwnProperty(t)){var i=this._animations[t],r=e.GetModifiableFromHashing(t);if(!r||!i)continue;var a=[];i.GetListTrackNames(a);for(var s=e.GetNeutrals(t),o=0;o<a.length;o++){var l=a[o],h=i.GetTrack(l);if(h){if(h.GetKey(0))continue;if(s)if(s.GetProperty(l))continue;var d=new n.default(0,r.GetProperty(l).GetPropertyValue().Clone());d.SetIsVolatile(!0),h.AddKey(d)}}}}ClearVolatileKeys(){for(var e in this._animations)if(this._animations.hasOwnProperty(e)){var t=this._animations[e];if(!t)continue;var i=[];t.GetListTrackNames(i);for(var r=0;r<i.length;r++){var a=i[r],s=t.GetTrack(a);if(s){var n=s.GetKey(0);n&&n.GetIsVolatile()&&s.RemoveKey(0)}}}}SetPropertyMapAtFrame(e,t){for(var i in this.SetBoostDirty(),e._map)if(e._map.hasOwnProperty(i)){var a=e.GetPropertySet(i);for(var o in a._map)if(a._map.hasOwnProperty(o)){var l=a.GetProperty(o),h=l.GetPropertyInfo().GetBehaviorType();if(2===h||1===h&&0!==t)continue;var d=l.GetPropertyValue(),u=this.GetObjectAnimation(i);u||(u=new r.default,this.AddObjectAnimation(i,u));var _=u.GetTrack(o);_||(_=new s.default,u.AddTrack(o,_));var f=new n.default(t,d);_.AddKey(f)}}}EmptyObjectAnimation(){this.SetBoostDirty();var e=[];this.GetListModifiables(e);for(var t=0;t<e.length;t++){var i=e[t];this.RemoveObjectAnimation(i)}}Clone(e){e?e.EmptyObjectAnimation():e=this._experienceBase?.Factory?.BuildComponent("VCXScenario");var t=[];this.GetListModifiables(t);for(var i=0;i<t.length;i++){var r=t[i],a=this.GetObjectAnimation(r);if(a){var s=a.Clone();e.AddObjectAnimation(r,s)}}let n=this.GetVisibility();var o=n.Clone(n);e.SetVisibility(o);var l,h=this.QueryInterface("VCXIModifiable");h&&(l=h.GetProperties());var d=e.QueryInterface("VCXIModifiable");if(d){if(l)for(var u in l._map)if(l._map.hasOwnProperty(u)){var _=l.GetProperty(u);d.OnChangeProperty(u,_.GetPropertyValue().Clone())}d.OnChangePropertiesEnd()}return e}ResetRangeCache(){for(var e in this._animations)if(this._animations.hasOwnProperty(e)){var t=e,i=this.GetObjectAnimation(t);if(!i)continue;var r=[];i.GetListTrackNames(r);for(var a=0;a<r.length;a++){var s=r[a];let e=i.GetTrack(s);e?.ResetRangeCache()}}}SetSequenceMaxFrame(e){this._sequenceMaxFrame=e}GetSequenceMaxFrame(){return this._sequenceMaxFrame}SetScenarioType(e){this._scenarioType=e}GetScenarioType(){return this._scenarioType}SetName(e){this._name!==e&&(this._name=e,i.publish({event:"VCX_SCENARIO_NAME_CHANGED",data:this}))}GetName(){return this._name}AddMarker(e,t){var i=new n.default(e,new l.default(t.GetID()));this._markersTrack.AddKey(i)}RemoveMarker(e){this._markersTrack.RemoveKey(e)}GetTrackMarkers(){return this._markersTrack}GetCurrentMarkerSequence(){return this._currentMarkerSequence}SetCurrentMarkerSequence(e){this._currentMarkerSequence=e}InitRestoreSetforPlay(e){for(var t in this._animations)if(this._animations.hasOwnProperty(t)){var i=this._animations[t];if(i){var r=[];i.GetListTrackNames(r);for(var a=0;a<r.length;a++){var s=r[a];e.AddPropertyToRestoreSet(t,s)}}}}HasFilterAnimatedModifiables(){return this._AnimatedModifiables.length>0}GetBlockRangeToJumpToFrame(e){let t=null;if(this.HasFilterAnimatedModifiables()){var i=Math.floor(e*this._AnimatedModifiablesNbBlocks/this._AnimatedModifiablesMaxFrame);if(i>=this._AnimatedModifiablesNbBlocks&&(i=this._AnimatedModifiablesNbBlocks-1),t={start:this._LastBlock,end:i},this._LastBlock=i,t.start>t.end){var r=t.start;t.start=t.end,t.end=r}}return t}GetAnimatedModifiablesForRange(e){let t={};if(this._AnimatedModifiables&&e)for(var i=e.start;i<=e.end;i++){var r=this._AnimatedModifiables[i];for(var a in r)r.hasOwnProperty(a)&&(t[a]=!0)}else for(var a in this._animations)this._animations.hasOwnProperty(a)&&(t[a]=!0);return t}BuildAnimatedModifiablesSets(e){this._AnimatedModifiablesMaxFrame=this.GetMaxFrame();for(var t in this._AnimatedModifiablesNbBlocks=Math.floor(this._AnimatedModifiablesMaxFrame/30*2)+1,this._AnimatedModifiablesNbBlocks>200&&(this._AnimatedModifiablesNbBlocks=200),this._AnimatedModifiables=[],this._animations)if(this._animations.hasOwnProperty(t)){var i=this._animations[t];i.ResetAnimatedTracks();var r=e.GetModifiableFromHashing(t);if(!r?.IsLiving())continue;var a=[];i.GetListTrackNames(a);for(var s=0;s<a.length;s++){var n=a[s],o=i.GetTrack(n);if(o){var l=o.GetIterator(),h=l.next(),d=!0,u=null;if(null!==h){var _=r.GetInterpolator(n);if(_||(_=e.GetDefaultInterpolator(n)),_)if("VCXInterpolatorLinear"!==(u=_.GetType())&&"VCXInterpolatorConstant"!==u)u=null;else{var f=h.GetValue().GetType();"VCXPropertyValueEnum"!==f&&"VCXPropertyValueHyperlinkId"!==f&&"VCXPropertyValueBoolean"!==f&&"VCXPropertyValueString"!==f&&"VCXPropertyValueDocId"!==f&&"VCXPropertyValueBase64"!==f&&"VCXPropertyValueLink"!==f&&"VCXPropertyValuePath"!==f||(u="VCXInterpolatorConstant"),"Actor.Pulse.Type"===n&&(d=!1)}}if(null!==u)for(var p=null;null!==h;){var m=0,c=null;if(0!==h.GetFrame())if(p)m=p.GetFrame(),c=p.GetValue();else{var v=e.GetNeutrals(t);if(v){var b=v.GetProperty(n);b&&(c=b.GetPropertyValue())}}if(d&&null!==c&&c.IsEqualTo(h.GetValue()));else{var y=Math.floor(m*this._AnimatedModifiablesNbBlocks/this._AnimatedModifiablesMaxFrame),G=Math.floor(h.GetFrame()*this._AnimatedModifiablesNbBlocks/this._AnimatedModifiablesMaxFrame)+1;G>this._AnimatedModifiablesNbBlocks&&(G=this._AnimatedModifiablesNbBlocks),"VCXInterpolatorConstant"===u&&(y=G-1);for(S=y;S<G;S++){(M=this._AnimatedModifiables[S])||(M=this._AnimatedModifiables[S]={}),M[t]=!0,i.AddAnimatedTrack(S,n)}}p=h,h=l.next()}else for(var S=0;S<this._AnimatedModifiablesNbBlocks;S++){var M;(M=this._AnimatedModifiables[S]??{})[t]=!0,this._AnimatedModifiables[S]=M,i.AddAnimatedTrack(S,n)}}}}}}return function(e){let t;!function(e){e[e.Scenario=0]="Scenario",e[e.Layer=1]="Layer",e[e.CADView=2]="CADView",e[e.CADCapture=3]="CADCapture"}(t=e.EScenarioType||(e.EScenarioType={}))}(h||(h={})),Object.defineProperty(h.prototype,"componentType",{enumerable:!0,get:()=>"VCXScenario"}),h}));