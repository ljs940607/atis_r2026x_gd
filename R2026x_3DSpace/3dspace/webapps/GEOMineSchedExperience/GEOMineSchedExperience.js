/*!  Copyright 2016 Dassault Systemes. All rights reserved. */
define("DS/GEOMineSchedExperience/GEOMineSchedTablerSelectionManager",["UWA/Core","UWA/Event","DS/Core/Core","DS/CoreEvents/Events","DS/Selection/XSO","DS/Utilities/Object"],(function(e,n,i,r,a,o){"use strict";var s=a.singleton({init:function(e){e={eventChannel:"GEOMineSchedTablerSelection/",areEquals:function(e,n){e._uxid,n._uxid}},this._parent(e)}});return e.namespace("WUX/Selection/GEOMineSchedTablerSelectionManager",s)})),define("DS/GEOMineSchedExperience/GEOMineSchedPlayerHelper",["UWA/Core","UWA/Class","UWA/Element","DS/ApplicationFrame/PlayerElements","DS/ApplicationFrame/AfrPlayerService"],(function(e,n,i,r,a){"use strict";return n.singleton({init:function(e){var n=".wux-controls-playerview {background:rgba(0, 0, 0, 0);} /*.playerBorder .wux-controls-player-button { background: green; position:relative; }.wux-controls-player-button:after { content:attr(data-name);position:absolute; top:0;left:0;}.playerBorder .wux-controls-player-button[data-name=hamburger] { background: yellow; }*/",i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=n:r.appendChild(document.createTextNode(n)),i.appendChild(r)},isVisible:function(e){var n=e.getContent().getStyle("display"),i=e.getContent().getStyle("visibility");return"none"!==n&&"hidden"!==i},getCallbacks:function(e){var n={},i=void 0,r=(a.actions.PLAY,a.actions.PAUSE,a.actions.BACK,a.actions.NEXT,a.actions.BACKWARD,a.actions.FORWARD,a.actions.FIRST,a.actions.LAST,a.actions.STOP,a.actions.PLAYREVERSE,a.actions.SLIDER_CHANGE,a.actions.EDITOR_CHANGE,a.actions.LOOPRC,a.actions.LOOPRCBF,a.actions.LOOPRO,a.actions.PLAYLIST,a.actions.OPTIONS,a.actions.EXIT,function(n){e[n.event]=n,n.data.source.geoCurrentPeriod||(n.data.source.geoCurrentPeriod=0),n.data.source.geoCurrentSpeed||(n.data.source.geoCurrentSpeed=1);let i=1e3/n.data.source.geoCurrentSpeed;var r=e.FrameWindow.getRootNode();if(null!=r.getChildByName("scene")){var a=r.getChildByName("scene").getChildByName("Result3dNode"),o=a.msaResult3d.periods.length;return{INTERVAL_TIME:i,STEP:1/(o-1),periodsSize:o,result3dNode:a}}return{INTERVAL_TIME:i}});return n[a.actions.PLAY]=function(n){0===a._state.progress&&(a._state.state="play");var o=r(n);void 0!==i&&window.clearInterval(i),i=setInterval((function(){var r=n.data.source.geoCurrentPeriod,s=document.getElementById("MSperiod"+r);if(s&&(s.style.backgroundColor="#A2CADF",s.style.color="black"),r>=o.periodsSize-1){n.data.source.geoCurrentPeriod=0;var d=0;window.clearInterval(i),a.setState({state:"pause",progress:d})}else{n.data.source.geoCurrentPeriod=n.data.source.geoCurrentPeriod+1;d=n.data.source.geoCurrentPeriod*o.STEP;a.setState({state:"play",progress:d})}o.result3dNode&&o.result3dNode.msaResult3d&&o.result3dNode.msaResult3d.applyPeriod(n.data.source.geoCurrentPeriod),e.FrameWindow.getViewer().render()}),o.INTERVAL_TIME)},n[a.actions.PAUSE]=function(e){var n=r(e),o=e.data.source.geoCurrentPeriod;void 0!==i&&window.clearInterval(i),a.setState({state:"pause",progress:o*n.STEP})},n[a.actions.STOP]=function(e){r(e);void 0!==i&&window.clearInterval(i),a.setState({state:"pause",progress:0}),e.data.source.geoCurrentPeriod=0},n[a.actions.EXIT]=function(e){a._playerView,r(e);void 0!==i&&window.clearInterval(i),e.data.source.geoCurrentPeriod=0},n[a.actions.SLIDER_CHANGE]=function(n){var i=r(n),o=a.getState().state,s=n.data.source.geoCurrentPeriod,d=n.data.value*(i.periodsSize-1),t=Math.round(d);if(n.data.source.geoCurrentPeriod=t,n.data.source.geoCurrentPeriod!==s&&(i.result3dNode&&i.result3dNode.msaResult3d&&i.result3dNode.msaResult3d.applyPeriod(n.data.source.geoCurrentPeriod),e.FrameWindow.getViewer().render()),Math.abs(t-d)>.01*(i.periodsSize-1)){var c=n.data.source.geoCurrentPeriod*i.STEP;a.setState({state:o,progress:c})}var l=document.getElementById("MSperiod"+s);l&&(l.style.color="black",l.style.backgroundColor="#A2CADF");var m=document.getElementById("MSperiod"+t);m&&(m.style.backgroundColor="#368EC4",m.style.color="white")},n},createPlayerContainer:function(n){e.debug=!0;var r=new i("div",{id:"player",debug:!0});r.inject(n);var o=new i("div",{id:"borderPlayer",class:"playerBorder",styles:{width:"100%"}});return r.playerViewport=o,o.insertPlayer=function(e){e.inject(o),r.playerView=e},o.removePlayer=function(e){if(0!=Object.keys(e).length&&e.constructor!=Object){var i={data:{source:e}},a=e._callbacks;i.data.value=0,a.stop(i),e.remove(),n.removeChild(r)}},o.inject(r),a.registerPlayerContainer(o),r}})})),define("GEOMineSchedExperience/GEOMineSchedExperience",["DS/GEOMineSchedExperience/GEOMineSchedExperience"],(function(e){"use strict";return console.error("This module is deprecated. use DS/GEOMineSchedExperience/GEOMineSchedExperience instead of GEOMineSchedExperience/GEOMineSchedExperience"),console.error("This module is deprecated. use DS/GEOMineSchedExperience/GEOMineSchedExperience instead of GEOMineSchedExperience/GEOMineSchedExperience"),console.error("This module is deprecated. use DS/GEOMineSchedExperience/GEOMineSchedExperience instead of GEOMineSchedExperience/GEOMineSchedExperience"),e})),define("DS/GEOMineSchedExperience/GEOMineSchedExperience",["DS/3DPlayExperienceModule/PlayExperience3D","UWA/Core","DS/ApplicationFrame/FrameWindow3D","DS/GEOMineSchedExperience/GEOMineSchedPlayerHelper","DS/ApplicationFrame/PlayerStyle","DS/ApplicationFrame/AfrPlayerService","DS/ApplicationFrame/CommandsManager","DS/ApplicationFrame/Json2Html","DS/Controls/SpinBox","DS/PlatformAPI/PlatformAPI"],(function(e,n,i,r,a,o,s,d,t,c){"use strict";var l=e.extend({init:function(e){(e=e||{}).FrameWindow=i,""===e.input.asset.filename&&(e.input.asset.filename=e.input.asset.serverurl);var r=this;r._parent(e);var a={workbenchs:[{name:"GEOMineSchedExperienceWkb",module:"GEOMineSchedExperience"}],swapVisible:!0,selection:!0,preSelection:!0,visu:{antiAliasing:!0,useShadowMap:!0,infinitePlane:!0,displayGrid:!1,displayLines:!1,debugShadowLight:!1,debugBSphere:!1,debugBBox:!1,control:"COMBINED",picking:!0,displayPicking:!0,prePicking:!0,displayprePicking:!0,autoUpdatePlane:!0,useMirror:!0,defaultAnimationLoop:!1},ui:{displayTree:!1,displayActionBar:!0}};r.args=n.extend(e,a,!0);var o=r.onModelLoadingCompleted;r.onModelLoadingCompleted=function(e){o(e);var n=s.getCommands(r.args.ctx).GEOMSAnimateCmdHdr;n.beginExecute(),n.execute(),n.endExecute()},r.args.options.callbacks&&r.args.options.callbacks.ui&&(r.onDefaultDDActivation=r.args.options.callbacks.ui.DefaultActivationFinished),r.appSingleton=null},onPreCreate:function(){this.args&&(this.args.visu={showReferenceAxisSystem:!0}),this.mabModel={speeddial:[{id:"AnnotationCommands",rsc:"3DPlay/3DPlayExperience3D"},{id:"Reframe",rsc:"3DPlay/3DPlayExperience3D"}],sections:[{id:"ViewSelector",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"VisibilityCommands",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D"},{id:"EnhancedExplode",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"measure2CmdHdr",nls:"DMUBaseCommands/3DPlayPro",rsc:"DMUBaseCommands/3DPlayPro",hideAB:!0},{id:"section2CmdHdr",nls:"DMUBaseCommands/3DPlayPro",rsc:"DMUBaseCommands/3DPlayPro"},{id:"AnnotationTour",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",hideAB:!0,showBack:!0},{id:"Render",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuShading",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdgesNoSmoothEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingEdgesHiddenEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingMaterialEdges",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingMaterial",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShadingIllustration",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuNoShadingEdges",rsc:"ViewerCommands/ViewerCommands"}]},{id:"Ambiance",nls:"3DPlay/3DPlayExperience3D",rsc:"3DPlay/3DPlayExperience3D",flyout:[{id:"VisuNoEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuV6Env",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuCleanSpaceEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuDarkBlueEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuDarkGreyEnv",rsc:"ViewerCommands/ViewerCommands"},{id:"VisuShinyEnv",rsc:"ViewerCommands/ViewerCommands"}]},{id:"HideShowFilter",nls:"GEOHideShowFilterCmd/GEOHideShowFilterWkb",rsc:"GEOHideShowFilterCmd/GEOHideShowFilterCmd"},{id:"GEOMSAnimateCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSDisplayActivitiesCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSHideActivitiesCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSDisplayStockpilesCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSHideStockpilesCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSAddProductionCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSRemoveProductionCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSSingleProductionCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSHideProductionCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"},{id:"GEOMSRestoreParamCmdHdr",nls:"GEOMSCommands/GEOMSCommands",rsc:"GEOMSCommands/GEOMSCommands"}]}},onPostCreate:function(){var e=this.frmWindow;this.immersiveFrame=e.getImmersiveFrame(),this.frmWindow.getViewer().setGrid(!1)},dispose:function(){document.contains(document.querySelector(".GEOMS_HideAnimate"))&&c.publish("GEOMS_HideAnimate"),this._parent()}});return n.namespace("DS/GEOMineSchedExperience/GEOMineSchedExperience",l)}));