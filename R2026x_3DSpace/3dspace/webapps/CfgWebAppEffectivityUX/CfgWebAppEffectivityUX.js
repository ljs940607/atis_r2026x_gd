define("DS/CfgWebAppEffectivityUX/scripts/CfgProductConfigurationColumn",["UWA/Core","UWA/Class","DS/Utilities/Dom","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgController","DS/EditPropWidget/constants/EditPropConstants","DS/CfgBaseUX/scripts/CfgPropertiesView","DS/Tweakers/TypeRepresentationFactory","DS/Controls/TooltipModel","i18n!DS/CfgWebAppEffectivityUX/assets/nls/CfgEffectivityNLS"],(function(e,t,i,n,o,a,l,r,s,c){"use strict";var d={};function f(e,t,i){if(!e.isHeader)if(e.cellModel.options.value){var n=e.cellView.reuseCellContent(t);n&&(n.innerText=e.cellModel.options.value)}else e.cellView.reuseCellContent(i)}function u(e){if(e.nodeModel)return e.cellModel?"object":"configLoading"}var g=t.singleton({_columnDataIndex:["ProductConfiguration"],_columnDef:{ProductConfiguration:{dataIndex:"ProductConfiguration",text:c.CFG_PRODUCT_CONFIGURATION_HEADER,width:180,minWidth:50,isHidden:!0,onCellRequest:function(e){f(e,"product_configuration_col_value","product_configuration_col_colloader")},xnav_options:{layout:{width:180,minWidth:50,maxWidth:300,removable:!0,hidden:!0},exportable:{lock:!1,value:!0}}}},_columnDefDGV:{},setReadOnlyMode:function(t){let i=!1;e.is(t,"boolean")?i=t:e.is(t,"string")&&(i="true"===t.toLowerCase()),g._columnStateReadOnly=i},init:function(e){this._parent(e),o.init(null,"","3DDashboard")},isAdditionalColumnsAvailable:function(t){if(!1===e.is(t,"function"))throw new Error("A callback function should be defined");!function(t){n.rolesAvailable((function(i){d.ProductConfiguration=c.CFG_PRODUCT_CONFIGURATION_HEADER;var n={dataIndex:"ProductConfiguration",text:c.CFG_PRODUCT_CONFIGURATION_HEADER,width:180,minWidth:50,isHidden:!0,readOnly:!1,onCellRequest:function(e){f(e,"product_configuration_col_value","product_configuration_col_colloader")},xnav_options:{layout:{width:180,minWidth:50,maxWidth:300,removable:!0,hidden:!0},exportable:{lock:!1,value:!0}}},o={dataIndex:"ProductConfiguration",text:c.CFG_PRODUCT_CONFIGURATION_HEADER,width:180,minWidth:50,visibleFlag:!1,isAdditionalColumn:!0,readOnly:!1,getCellTypeRepresentation:u,customisation:{dataIndex:"ProductConfiguration",exportable:{lock:!1,value:!0},layout:{removable:!1}},getCellClassName:function(e){return e&&e.nodeModel&&" "!==e.nodeModel._options.grid.ProductConfiguration&&g&&g.InstantiatedPCInfo?"cfg-pc-col-link":"cfg-pc-col"},onCellRequest:async function(t){var i=new e.Element("div",{styles:{display:"flex"}});const n=new r,o=Object.prototype.hasOwnProperty.call(t.nodeModel._options.grid,"ProductConfiguration")&&Object.prototype.hasOwnProperty.call(t.nodeModel._options.grid.ProductConfiguration,"primary")&&void 0!==t.nodeModel._options.grid.ProductConfiguration.primary?t.nodeModel._options.grid.ProductConfiguration.primary:" ",a=Object.prototype.hasOwnProperty.call(t.nodeModel._options.grid,"ProductConfiguration")&&void 0!==t.nodeModel._options.grid.ProductConfiguration.secondary?t.nodeModel._options.grid.ProductConfiguration.secondary:" ";if(o&&" "!=o&&o.length>1){let e=await n.generateView(o,{typePath:"string",readOnly:!0});e.getContent().addClassName("cfg-pc-col-link"),e.getContent().addEventListener("click",(()=>{g.typeOfLinkClicked="Primary"})),i.addContent(e.getContent()),e.tooltipInfos=new s({shortHelp:o})}if(a&&" "!=a&&a.length>1){let e=await n.generateView(a,{typePath:"string",readOnly:!0});e.getContent().addClassName("cfg-pc-col-link"),e.getContent().addEventListener("click",(()=>{g.typeOfLinkClicked="Secondary"})),i.addContent(e.getContent()),e.tooltipInfos=new s({shortHelp:a})}t.cellView.setReusableContent(i)}};!0===g._columnStateReadOnly&&(n.readOnly=!0,o.readOnly=!0),1!=i.isCHGRoleAvail&&1!=i.isCFGRoleAvail&&1!=i.isCSVRoleAvail||(g._columnDataIndex=["ProductConfiguration"],g._columnDef={ProductConfiguration:n},g._columnDefDGV={ProductConfiguration:o}),t()}))}((function(){t(!0),g.InstantiatedPCInfo={}}))},getName:function(){return"CfgProductConfigurationColumn"},getManagedColumnNames:function(){return this._columnDataIndex},toBeUpdated:function(e,t){var i=!1;return"SyncModelRefresh"!==t&&"OnSyncModel"!==t||(i=!0),void 0!==e.ProductConfiguration&&""!==e.ProductConfiguration||(i=!0),i},updateAttributes:function(t,i){if(!1===e.is(t,"object"))throw new Error("The object ids to modify must be specify");if(!1===e.is(i,"function"))throw new Error("A callback function should be defined");setTimeout((()=>{var e={pids:{},relids:{}},o=0;let a=t.relids;if(t.pids.length>0){for(n.isAdditionalConsoleLog()&&console.log("CfgProductConfigurationColumn original nodesToUpdate = "+JSON.stringify(t)),o=0;o<t.pids.length;o++)e.pids[t.pids[o]]={ProductConfiguration:{primary:" ",secondary:" "}};0==a.length&&i(e)}if(a.length>0){widget.getValue("x3dPlatformId")?enoviaServerFilterWidget.tenant=widget.getValue("x3dPlatformId"):enoviaServerFilterWidget.tenant="OnPremise";let a={instanceIdList:t.relids};n.populate3DSpaceURL().then((function(){n.populateSecurityContext().then((function(){n.getProductConfigurations(a).then((function(a){let l=t.pids;for(o=0;o<l.length;o++)e.pids[l[o]]={ProductConfiguration:{primary:" ",secondary:" "}};for(let t in a)if("version"!=t&&a.hasOwnProperty(t)){let i=" ",n=" ";if("true"==a[t].hasStaticMapping&&null!=a[t].content&&null!=a[t].content.results){let e=a[t].content.results[0].type;if("Product Configuration"==e||"xRevisionElement"==e){let e=" ",n=a[t].content.results[0].computed,o=a[t].content.results[0].basicData;if(null!=o)for(let t=0;t<o.length;t++)if("revision"==o[t].name&&null!=o[t].value){e=o[t].value[0];break}null!=n&&(i=n.label.value[0]+" "+e)}else if("VPMCfgConfiguration"==e){let e=a[t].content.results[0].data;if(null!=e)for(let t=0;t<e.length;t++)if("PLM_ExternalID"==e[t].name&&null!=e[t].value){i=e[t].value[0];break}}g.InstantiatedPCInfo[t]={filterID:a[t].filterID,ProductConfiguration:i},a[t].secondaryFilterId&&(g.InstantiatedPCInfo[t].secondaryFilterId=a[t].secondaryFilterId)}if("true"==a[t].hasStaticMapping&&null!=a[t].secondaryFilterAttributes&&null!=a[t].secondaryFilterAttributes.results){let e=a[t].secondaryFilterAttributes.results[0].type;if("Product Configuration"==e){let e=" ",i=a[t].secondaryFilterAttributes.results[0].computed,o=a[t].secondaryFilterAttributes.results[0].basicData;if(null!=o)for(let t=0;t<o.length;t++)if("revision"==o[t].name&&null!=o[t].value){e=o[t].value[0];break}null!=i&&(n=i.label.value[0]+" "+e)}else if("VPMCfgConfiguration"==e){let e=a[t].secondaryFilterAttributes.results[0].data;if(null!=e)for(let t=0;t<e.length;t++)if("PLM_ExternalID"==e[t].name&&null!=e[t].value){i=e[t].value[0];break}}}e.relids[t]={ProductConfiguration:{primary:i,secondary:n}}}n.isAdditionalConsoleLog()&&console.log("CfgProductConfigurationColumn output response updatedAttributes = "+JSON.stringify(e)),i(e)}),(function(t){console.log("getProductConfigurations error = "+t),i(e)}))}),(function(t){console.log("populateSecurityContext error = "+t),i(e)}))}),(function(t){console.log("populate3DSpaceURL error = "+t),i(e)}))}}),200)},getAdditionalColumnsUX:function(t){for(var i=[],n=0;n<t.length;n++)i.push(t[n].dataIndex);for(var o=0;o<this._columnDataIndex.length;o++){var a=this._columnDataIndex[o],l=e.clone(this._columnDef[a]),r=i.indexOf(a);-1===r?t.push(l):t[r]=e.extend(t[r],l,!0)}},getAdditionalColumnsUXDGV:function(t){for(var i=[],n=0;n<t.length;n++)i.push(t[n].dataIndex);for(var o=0;o<this._columnDataIndex.length;o++){var a=this._columnDataIndex[o],l=e.clone(this._columnDefDGV[a]),r=i.indexOf(a);-1===r?t.push(l):(t[r]=e.extend(t[r],l,!0),t[r].text=d[t[r].dataIndex])}},getTypeRepresentations:function(){return{configLoading:{stdTemplate:"functionIcon",semantics:{className:"relationRefresh",icon:{iconName:"reload wux-ui-3ds-spin",fontIconFamily:WUXManagedFontIcons.Font3DS}}}}},provideDisplayTooltip:function(e){var t=null;if("ProductConfiguration"===e.dataIndex)t=e.cellModel&&e.cellModel.options&&" "==e.cellModel.options.value||" "==e.cellModel?"":e.cellModel;return t},registerReusableCellContent:function(e){e.getManager().registerReusableCellContent({id:"product_configuration_col_colloader",buildContent:function(){return i.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}}),e.getManager().registerReusableCellContent({id:"product_configuration_col_value",buildContent:function(){return i.createElement("span")}})},showInstantiatedConfigurationProperties:function(e){let t=e.nodeModel,i=g.InstantiatedPCInfo[t.getRelationID()].filterID,n=g.InstantiatedPCInfo[t.getRelationID()].secondaryFilterId;"Primary"===g.typeOfLinkClicked?l.createPropertiesComponent({itemID:i,displayType:a.POPUP,readOnly:!0,extraNotif:!1,editMode:!1}):n&&"Secondary"===g.typeOfLinkClicked&&l.createPropertiesComponent({itemID:n,displayType:a.POPUP,readOnly:!0,extraNotif:!1,editMode:!1})},getOnCellClickCB:function(e){let t;return"ProductConfiguration"===e&&(t=e=>{g.showInstantiatedConfigurationProperties(e)}),t}});return g})),define("DS/CfgWebAppEffectivityUX/scripts/CfgEffectivityColumns",["UWA/Core","UWA/Class","DS/UIKIT/Spinner","DS/Utilities/Dom","DS/CfgBaseUX/scripts/CfgUtility","DS/EffectivityInlineEditor/EffectivityInlineEditor","i18n!DS/CfgWebAppEffectivityUX/assets/nls/CfgEffectivityNLS","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","DS/CfgBaseUX/scripts/CfgController","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CfgBaseUX/scripts/CfgDialog","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/EffectivityInlineEditor/utils/CfgAutoCompleteUtils","DS/CfgBaseUX/scripts/CfgData","DS/CoreEvents/ModelEvents","DS/ApplicationFrame/CommandsManager","DS/WebappsUtils/WebappsUtils","DS/UIKIT/Mask","DS/PADUtils/PADContext","DS/CfgTracker/CfgTracker","DS/CfgTracker/CfgDimension","DS/CfgTracker/CfgValue","DS/CfgBaseUX/scripts/CfgUXEnvVariables","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json"],(function(e,t,i,n,o,a,l,r,s,c,d,f,u,g,C,p,v,E,m,y,I,h,_,R){"use strict";var D="E",x={};function b(e,t,i){if(!e.isHeader)if(e.cellModel.options.value){var n=e.cellView.reuseCellContent(t);n&&(n.innerText=e.cellModel.options.value)}else e.cellView.reuseCellContent(i)}function V(e){if(e.nodeModel)return e.cellModel?"string":"configLoading"}var A=t.singleton({_columnDataIndex:["Effectivity"],_columnDef:{Effectivity:{dataIndex:"Effectivity",text:l.CFG_EFFECTIVITY_HEADER,width:100,minWidth:50,maxWidth:300,isHidden:!0,readOnly:!1,onCellRequest:function(e){b(e,"effecivity_col_value","effecivity_col_colloader")},xnav_options:{layout:{width:100,minWidth:50,maxWidth:300,removable:!0,hidden:!0},exportable:{lock:!1,value:!0}}}},_columnDefDGV:{},setReadOnlyMode:function(t){let i=!1;e.is(t,"boolean")?i=t:e.is(t,"string")&&(i="true"===t.toLowerCase()),A._columnStateReadOnly=i},init:function(e){this._parent(e),s.init(null,"","3DDashboard"),this.CfgUXEnvVariables=JSON.parse(R)},isAdditionalColumnsAvailable:function(t){if(!1===e.is(t,"function"))throw new Error("A callback function should be defined");!function(e){o.rolesAvailable((function(t){x.Effectivity=l.CFG_EFFECTIVITY_HEADER;var i={dataIndex:"Effectivity",text:l.CFG_EFFECTIVITY_HEADER,width:100,minWidth:50,maxWidth:300,isHidden:!0,readOnly:!1,onCellRequest:function(e){b(e,"effecivity_col_value","effecivity_col_colloader")},xnav_options:{layout:{width:100,minWidth:50,maxWidth:300,removable:!0,hidden:!0},exportable:{lock:!1,value:!0}}},n={dataIndex:"Effectivity",text:l.CFG_EFFECTIVITY_HEADER,width:100,minWidth:50,maxWidth:300,visibleFlag:!1,isAdditionalColumn:!0,readOnly:!1,getCellTypeRepresentation:V,customisation:{dataIndex:"Effectivity",exportable:{lock:!1,value:!0},layout:{removable:!1}}};x.VariantEffectivity=l.CFG_VARIANT_HEADER;var o={dataIndex:"VariantEffectivity",text:l.CFG_VARIANT_HEADER,width:300,minWidth:50,isHidden:!0,readOnly:!1,onCellRequest:function(e){b(e,"variant_effecivity_col_value","variant_effecivity_col_colloader")},xnav_options:{layout:{width:300,minWidth:200,maxWidth:500,removable:!0,hidden:!0},exportable:{lock:!1,value:!0}}},a={dataIndex:"VariantEffectivity",text:l.CFG_VARIANT_HEADER,width:300,minWidth:50,visibleFlag:!1,isAdditionalColumn:!0,readOnly:!1,getCellTypeRepresentation:V,customisation:{dataIndex:"Effectivity",exportable:{lock:!1,value:!0},layout:{removable:!1}}};x.CurrentEvolutionEffectivity=l.CFG_CURRENT_EVOLUTION_HEADER;var r={dataIndex:"CurrentEvolutionEffectivity",text:l.CFG_CURRENT_EVOLUTION_HEADER,width:300,minWidth:50,isHidden:!0,readOnly:!1,onCellRequest:function(e){b(e,"current_evolution_effecivity_col_value","current_evolution_effecivity_col_colloader")},xnav_options:{layout:{width:300,minWidth:50,maxWidth:500,removable:!0,hidden:!0},exportable:{lock:!1,value:!0}}},s={dataIndex:"CurrentEvolutionEffectivity",text:l.CFG_CURRENT_EVOLUTION_HEADER,width:300,minWidth:50,visibleFlag:!1,isAdditionalColumn:!0,readOnly:!1,getCellTypeRepresentation:V,customisation:{dataIndex:"Effectivity",exportable:{lock:!1,value:!0},layout:{removable:!1}}};x.ProjectedEvolutionEffectivity=l.CFG_PROJECTED_EVOLUTION_HEADER;var c={dataIndex:"ProjectedEvolutionEffectivity",text:l.CFG_PROJECTED_EVOLUTION_HEADER,width:300,minWidth:50,isHidden:!0,readOnly:!1,onCellRequest:function(e){b(e,"projected_evolution_effecivity_col_value","projected_evolution_effecivity_col_colloader")},xnav_options:{layout:{width:300,minWidth:50,maxWidth:500,removable:!0,hidden:!0},exportable:{lock:!1,value:!0}}},d={dataIndex:"ProjectedEvolutionEffectivity",text:l.CFG_PROJECTED_EVOLUTION_HEADER,width:300,minWidth:50,visibleFlag:!1,isAdditionalColumn:!0,readOnly:!1,getCellTypeRepresentation:V,customisation:{dataIndex:"Effectivity",exportable:{lock:!1,value:!0},layout:{removable:!1}}};x.EvolutionEffectivity=l.CFG_EVOLUTION_HEADER;var f={dataIndex:"EvolutionEffectivity",text:l.CFG_EVOLUTION_HEADER,width:300,minWidth:50,isHidden:!0,readOnly:!1,onCellRequest:function(e){b(e,"evolution_effecivity_col_value","evolution_effecivity_col_colloader")},xnav_options:{layout:{width:300,minWidth:50,maxWidth:500,removable:!0,hidden:!0},exportable:{lock:!1,value:!0}}},u={dataIndex:"EvolutionEffectivity",text:l.CFG_EVOLUTION_HEADER,width:300,minWidth:50,visibleFlag:!1,isAdditionalColumn:!0,readOnly:!1,getCellTypeRepresentation:V,customisation:{dataIndex:"Effectivity",exportable:{lock:!1,value:!0},layout:{removable:!1}}};1==t.isCHGRoleAvail?(!0===A._columnStateReadOnly&&(i.readOnly=!0,o.readOnly=!0,r.readOnly=!0,c.readOnly=!0,n.readOnly=!0,a.readOnly=!0,s.readOnly=!0,d.readOnly=!0),D="EE",A._columnDataIndex=["Effectivity","VariantEffectivity","CurrentEvolutionEffectivity","ProjectedEvolutionEffectivity"],A._columnDef={Effectivity:i,VariantEffectivity:o,CurrentEvolutionEffectivity:r,ProjectedEvolutionEffectivity:c},A._columnDefDGV={Effectivity:n,VariantEffectivity:a,CurrentEvolutionEffectivity:s,ProjectedEvolutionEffectivity:d}):1!=t.isCFGRoleAvail&&1!=t.isCSVRoleAvail||(!0===A._columnStateReadOnly&&(i.readOnly=!0,o.readOnly=!0,f.readOnly=!0,n.readOnly=!0,a.readOnly=!0,u.readOnly=!0),D="VE",A._columnDataIndex=["Effectivity","VariantEffectivity","EvolutionEffectivity"],A._columnDef={Effectivity:i,VariantEffectivity:o,EvolutionEffectivity:f},A._columnDefDGV={Effectivity:n,VariantEffectivity:a,EvolutionEffectivity:u}),e()}))}((function(){t(!0)}))},getName:function(){return"CfgEffectivityColumns"},getManagedColumnNames:function(){return this._columnDataIndex},toBeUpdated:function(e,t){var i=!1;return"SyncModelRefresh"!==t&&"OnSyncModel"!==t||(i=!0),"EE"===D?void 0!==e.Effectivity&&""!==e.Effectivity&&void 0!==e.VariantEffectivity&&""!==e.VariantEffectivity&&void 0!==e.CurrentEvolutionEffectivity&&""!==e.CurrentEvolutionEffectivity&&void 0!==e.ProjectedEvolutionEffectivity&&""!==e.ProjectedEvolutionEffectivity||(i=!0):"VE"===D&&(void 0!==e.Effectivity&&""!==e.Effectivity&&void 0!==e.VariantEffectivity&&""!==e.VariantEffectivity&&void 0!==e.EvolutionEffectivity&&""!==e.EvolutionEffectivity||(i=!0)),i},updateAttributes:function(t,i){if(!1===e.is(t,"object"))throw new Error("The object ids to modify must be specify");if(!1===e.is(i,"function"))throw new Error("A callback function should be defined");setTimeout((function(){var e={pids:{},relids:{}},n=0,a=t.relids;if(t.pids.length>0&&o.isAdditionalConsoleLog()&&console.log("CfgEffectivityColumns original nodesToUpdate = "+JSON.stringify(t)),null!=t.pairs){let o=function(e){let t=[];for(let i=0;i<e.pids.length;i++){let n=e.pids[i];e.pairs[n]||t.push(n)}return t}(t);if("EE"===D){if(o.length>0){for(n=0;n<o.length;n++)e.pids[o[n]]={Effectivity:" ",VariantEffectivity:" ",CurrentEvolutionEffectivity:" ",ProjectedEvolutionEffectivity:" "};0==a.length&&i(e)}}else if("VE"===D&&o.length>0){for(n=0;n<o.length;n++)e.pids[o[n]]={Effectivity:" ",VariantEffectivity:" ",EvolutionEffectivity:" "};0==a.length&&i(e)}}else{var r=JSON.parse(R).isCRColumnVisible;if("EE"===D){if(0==r&&t.pids.length>0||1==r&&t.pids.length>0&&0==a.length){for(n=0;n<t.pids.length;n++)e.pids[t.pids[n]]={Effectivity:" ",VariantEffectivity:" ",CurrentEvolutionEffectivity:" ",ProjectedEvolutionEffectivity:" "};0==a.length&&i(e)}}else if("VE"===D&&(0==r&&t.pids.length>0||1==r&&t.pids.length>0&&0==a.length)){for(n=0;n<t.pids.length;n++)e.pids[t.pids[n]]={Effectivity:" ",VariantEffectivity:" ",EvolutionEffectivity:" "};0==a.length&&i(e)}}this.cfgUXEnvVariablesJS=_.getCfgUXEnvVariables();a.length>0&&(widget.getValue("x3dPlatformId")?enoviaServerFilterWidget.tenant=widget.getValue("x3dPlatformId"):enoviaServerFilterWidget.tenant="OnPremise",o.populate3DSpaceURL().then((function(){o.populateSecurityContext().then((function(){var r={InstanceID:a,InstanceLength:a.length,Version:"2.0",TargetFormat:"TXT",withDescription:"YES",View:"ALL",Domains:"ALL"},s=null;"function"==typeof f.getConfigurationRevisionDetails&&(s=f.getConfigurationRevisionDetails().configurationRevision),null!=s&&(r.configurationRev=s),o.getEffectivityJSON(r).then((function(a){if("EE"===D){let i=t.pids;for(n=0;n<i.length;n++)e.pids[i[n]]={Effectivity:" ",VariantEffectivity:" ",CurrentEvolutionEffectivity:" ",ProjectedEvolutionEffectivity:" "};for(var r in a.expressions)if(a.expressions.hasOwnProperty(r))if("NO"==a.expressions[r].hasEffectivity||"NO"==a.expressions[r].hasConfigRevEffectivity)e.relids[r]={Effectivity:l.CFG_EFFECTIVITY_NO,VariantEffectivity:" ",CurrentEvolutionEffectivity:" ",ProjectedEvolutionEffectivity:" "};else if("YES"==a.expressions[r].hasEffectivity){var s=" ",c=" ",d=" ";null!==a.expressions[r].content&&null!==a.expressions[r].content.Variant&&void 0!==a.expressions[r].content.Variant&&""!==a.expressions[r].content.Variant&&(s=(s=a.expressions[r].content.Variant).replace(/[\r\n]+/g," ")),null!==a.expressions[r].content&&null!==a.expressions[r].content.Evolution&&void 0!==a.expressions[r].content.Evolution&&""!==a.expressions[r].content.Evolution&&(c=a.expressions[r].content.Evolution.Current,d=a.expressions[r].content.Evolution.Projected,c=null!=c&&""!==c?c.replace(/[\r\n]+/g," "):" ",d=void 0!==d&&null!=d&&""!==d?d.replace(/[\r\n]+/g," "):" "),e.relids[r]={Effectivity:l.CFG_EFFECTIVITY_YES,VariantEffectivity:s,CurrentEvolutionEffectivity:c,ProjectedEvolutionEffectivity:d}}else if("YES"==a.expressions[r].hasConfigRevEffectivity){s=" ",c=" ",d=" ";null!==a.expressions[r].content&&null!==a.expressions[r].content.Variant&&void 0!==a.expressions[r].content.Variant&&""!==a.expressions[r].content.Variant&&(s=(s=a.expressions[r].content.Variant).replace(/[\r\n]+/g," ")),null!==a.expressions[r].content&&null!==a.expressions[r].content.Evolution&&void 0!==a.expressions[r].content.Evolution&&""!==a.expressions[r].content.Evolution&&(c=null!=(c=d=a.expressions[r].content.Evolution)&&""!==c?c.replace(/[\r\n]+/g," "):" ",d=void 0!==d&&null!=d&&""!==d?d.replace(/[\r\n]+/g," "):" "),e.relids[r]={Effectivity:l.CFG_EFFECTIVITY_YES,VariantEffectivity:s,CurrentEvolutionEffectivity:c,ProjectedEvolutionEffectivity:d}}else"ERROR"!=a.expressions[r].hasEffectivity&&"SUCCESS"==a.expressions[r].status||(e.relids[r]={Effectivity:" ",VariantEffectivity:" ",CurrentEvolutionEffectivity:" ",ProjectedEvolutionEffectivity:" "})}else if("VE"===D){let i=t.pids;for(n=0;n<i.length;n++)e.pids[i[n]]={Effectivity:" ",VariantEffectivity:" ",EvolutionEffectivity:" "};for(var r in a.expressions)if(a.expressions.hasOwnProperty(r))if("NO"==a.expressions[r].hasEffectivity||"NO"==a.expressions[r].hasConfigRevEffectivity)e.relids[r]={Effectivity:l.CFG_EFFECTIVITY_NO,VariantEffectivity:" ",EvolutionEffectivity:" "};else if("YES"==a.expressions[r].hasEffectivity){s=" ";var f=" ";null!==a.expressions[r].content&&null!==a.expressions[r].content.Variant&&void 0!==a.expressions[r].content.Variant&&""!==a.expressions[r].content.Variant&&(s=(s=a.expressions[r].content.Variant).replace(/[\r\n]+/g," ")),null!==a.expressions[r].content&&null!==a.expressions[r].content.Evolution&&void 0!==a.expressions[r].content.Evolution&&""!==a.expressions[r].content.Evolution&&(f=null!=(f=a.expressions[r].content.Evolution.Current)&&""!==f?f.replace(/[\r\n]+/g," "):" "),e.relids[r]={Effectivity:l.CFG_EFFECTIVITY_YES,VariantEffectivity:s,EvolutionEffectivity:f}}else if("YES"==a.expressions[r].hasConfigRevEffectivity){s=" ",f=" ";null!==a.expressions[r].content&&null!==a.expressions[r].content.Variant&&void 0!==a.expressions[r].content.Variant&&""!==a.expressions[r].content.Variant&&(s=(s=a.expressions[r].content.Variant).replace(/[\r\n]+/g," ")),null!==a.expressions[r].content&&null!==a.expressions[r].content.Evolution&&void 0!==a.expressions[r].content.Evolution&&""!==a.expressions[r].content.Evolution&&(f=null!=(f=a.expressions[r].content.Evolution)&&""!==f?f.replace(/[\r\n]+/g," "):" "),e.relids[r]={Effectivity:l.CFG_EFFECTIVITY_YES,VariantEffectivity:s,EvolutionEffectivity:f}}else"ERROR"!=a.expressions[r].hasEffectivity&&"SUCCESS"==a.expressions[r].status||(e.relids[r]={Effectivity:" ",VariantEffectivity:" ",EvolutionEffectivity:" "})}o.isAdditionalConsoleLog()&&console.log("CfgEffectivityColumns output response updatedAttributes = "+JSON.stringify(e)),i(e)}),(function(t){console.log(t),i(e)}))}),(function(t){console.log(t),i(e)}))}),(function(t){console.log(t),i(e)})))}),200)},getAdditionalColumnsUX:function(t){for(var i=[],n=0;n<t.length;n++)i.push(t[n].dataIndex);for(var o=0;o<this._columnDataIndex.length;o++){var a=this._columnDataIndex[o],l=e.clone(this._columnDef[a]),r=i.indexOf(a);-1===r?t.push(l):t[r]=e.extend(t[r],l,!0)}},getAdditionalColumnsUXDGV:function(t){for(var i=[],n=0;n<t.length;n++)i.push(t[n].dataIndex);for(var o=0;o<this._columnDataIndex.length;o++){var a=this._columnDataIndex[o],l=e.clone(this._columnDefDGV[a]),r=i.indexOf(a);-1===r?t.push(l):(t[r]=e.extend(t[r],l,!0),t[r].text=x[t[r].dataIndex])}},getTypeRepresentations:function(){return{configLoading:{stdTemplate:"functionIcon",semantics:{className:"relationRefresh",icon:{iconName:"reload wux-ui-3ds-spin",fontIconFamily:WUXManagedFontIcons.Font3DS}}}}},provideDisplayTooltip:function(e){var t=null;switch(e.dataIndex){case"Effectivity":case"VariantEffectivity":case"CurrentEvolutionEffectivity":case"ProjectedEvolutionEffectivity":t=e.cellModel&&e.cellModel.options&&" "==e.cellModel.options.value||" "==e.cellModel?"":e.cellModel}return t},registerReusableCellContent:function(e){"EE"===D?(e.getManager().registerReusableCellContent({id:"effecivity_col_colloader",buildContent:function(){return n.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}}),e.getManager().registerReusableCellContent({id:"variant_effecivity_col_colloader",buildContent:function(){return n.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}}),e.getManager().registerReusableCellContent({id:"current_evolution_effecivity_col_colloader",buildContent:function(){return n.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}}),e.getManager().registerReusableCellContent({id:"projected_evolution_effecivity_col_colloader",buildContent:function(){return n.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}}),e.getManager().registerReusableCellContent({id:"effecivity_col_value",buildContent:function(){return n.createElement("span")}}),e.getManager().registerReusableCellContent({id:"variant_effecivity_col_value",buildContent:function(){return n.createElement("span")}}),e.getManager().registerReusableCellContent({id:"current_evolution_effecivity_col_value",buildContent:function(){return n.createElement("span")}}),e.getManager().registerReusableCellContent({id:"projected_evolution_effecivity_col_value",buildContent:function(){return n.createElement("span")}})):"VE"===D&&(e.getManager().registerReusableCellContent({id:"effecivity_col_colloader",buildContent:function(){return n.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}}),e.getManager().registerReusableCellContent({id:"variant_effecivity_col_colloader",buildContent:function(){return n.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}}),e.getManager().registerReusableCellContent({id:"evolution_effecivity_col_colloader",buildContent:function(){return n.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}}),e.getManager().registerReusableCellContent({id:"effecivity_col_value",buildContent:function(){return n.createElement("span")}}),e.getManager().registerReusableCellContent({id:"variant_effecivity_col_value",buildContent:function(){return n.createElement("span")}}),e.getManager().registerReusableCellContent({id:"evolution_effecivity_col_value",buildContent:function(){return n.createElement("span")}}))},cancelVariantDialog:function(){A.cfgVarEffectivityInlineEditor.cfgVarDialog.closeDialog(),A.callCommandClickTrackerEvent({mode:"Dashboard",operation:"Cancel"})},subscribeCfgEffInlineEditorActionEvents(){g.cfgEffInlineEditorActionEvents.subscribe({event:"clearIteOptionsOnVarDialogClose"},(()=>{A.ite_options=void 0}))},sendEditVariantTrackerEvent:function(e){let t="",i="",n=e.noOfContext,o=e.noOfReference,a=e.totalVariantLength,l=e.totalVariantValueLength,r=e.totalOptionGroupLength,s=e.totalOptionLength,c=e.totalNotOperatorLength,d=e.variantComplexity,f=e.totalFeaturesLength,u=e.totalFeatureOptionsLength;"Native"==e.mode?(t="Native",i="Web In Win"):(t=widget.data.appId,i=null!=widget.options?widget.options.title:"ODT Environment");let g=y.getDeviceUsedForOperation(),C=y.ConfigOperationMode.CREATE;"Edit"==e.variantMode&&(C=y.ConfigOperationMode.EDIT);let p=y.AuthoringMode.EMPTY;"Empty"!=e.authoringMode&&(p=y.AuthoringMode[e.authoringMode]);let v=y.EditVariantMode.INLINE;y.createEventBuilder({category:y.Category.USAGE,action:y.Events.CLICK,tenant:enoviaServerFilterWidget.tenant}).setLabel(y.Labels.EDIT_VARIANT_EFFECTIVITY).setAppId(t).addDimension(I.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_EFFECTIVITY_WIDGET,i).addDimension(I.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_EFFECTIVITY_MEDIA,g).addDimension(I.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_EFFECTIVITY_MODE,C).addDimension(I.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_AUTHORING_MODE,p).addDimension(I.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_EFFECTIVITY_TYPE_MODE,v).addPersonalValue(h.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_NO_OF_MODEL,n).addPersonalValue(h.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_REFERENCE_SELECTED,o).addPersonalValue(h.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_VARIANT,a).addPersonalValue(h.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_VARIANT_VALUE,l).addPersonalValue(h.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_OPTION_GROUP,r).addPersonalValue(h.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_OPTION,s).addPersonalValue(h.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_TOTAL_NO_NOT_OPERATOR,c).addPersonalValue(h.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_COMPLEXITY,d).addPersonalValue(h.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_DICTIONARY_FEATURES,f).addPersonalValue(h.EDIT_VARIANT_EFFECTIVITY.EDIT_VARIANT_DICTIONARY_FEATURE_OPTIONS,u).send()},callEditVariantTrackerEvent:function(){let e={noOfContext:A.cfgVarEffectivityInlineEditor.ite_options.contextData.length,mode:"Dashboard",variantMode:"Create"};0==A.cfgVarEffectivityInlineEditor.cfgVarDialog.options.isInlineEmptyVariantEffectivity&&(e.variantMode="Edit"),e.authoringMode="Empty",A.cfgVarEffectivityInlineEditor.ite_options.auth.headers.length>0&&("DS-Change-Authoring-Context"==A.cfgVarEffectivityInlineEditor.ite_options.auth.headers[0].key?e.authoringMode="CHANGE":"DS-Configuration-Authoring-Context"==A.cfgVarEffectivityInlineEditor.ite_options.auth.headers[0].key&&(e.authoringMode="EVOLUTION")),e.noOfReference=1,e.totalVariantLength=-1,e.totalVariantValueLength=-1,e.totalOptionGroupLength=-1,e.totalOptionLength=-1,e.totalNotOperatorLength=-1,e.variantComplexity=-1,e.totalFeaturesLength=-1,e.totalFeatureOptionsLength=-1,A.sendEditVariantTrackerEvent(e)},callCommandClickTrackerEvent:function(e){let t="Native",i="Rich Client Applications",n="NATIVEWIW";if(widget&&widget.data&&widget.data.appId&&(t=widget.data.appId),widget&&widget.options&&widget.options.title&&(i=widget.options.title),"Dashboard"==e.mode&&(n="DASHBOARD"),"OK"==e.operation){for(let e=0;e<A.cfgVarEffectivityInlineEditor.probesData.length;e++){let a={AppId:t,AppName:i,CommandOperation:A.cfgVarEffectivityInlineEditor.probesData[e],CommandName:y.Labels.EDIT_VARIANT_EFFECTIVITY,ConfigMode:y.ConfigMode.CONTEXTUAL,ApplicationMode:n};o.sendConfgurationCommandsClickEventForMagicProbes(a)}A.cfgVarEffectivityInlineEditor.clearCommandClickProbesData()}else{let e={AppId:t,AppName:i,CommandOperation:"Edit_Variant_Inline_Cancel",CommandName:y.Labels.EDIT_VARIANT_EFFECTIVITY,ConfigMode:y.ConfigMode.CONTEXTUAL,ApplicationMode:n};o.sendConfgurationCommandsClickEventForMagicProbes(e)}},setVariantEffectivity:function(){E.mask(document.querySelector("#target-container")," ");var e=null,t=A.cfgVarEffectivityInlineEditor.getExpressions();if("ERROR"==t.effectivity)return o.showwarning(l.Syntax_Error,"error"),void E.unmask(document.querySelector("#target-container"));if(""!=(e=0==t.effectivity.length?"":u.VariantJSONtoXMLConverter(t))||null==A.cfgVarEffectivityInlineEditor||null==A.cfgVarEffectivityInlineEditor.ite_options||1!=A.cfgVarEffectivityInlineEditor.ite_options.isInlineEmptyVariantEffectivity){var i=null;A.ite_options.auth.headers.length>0&&(i={operationheader:{key:A.ite_options.auth.headers[0].key,value:A.ite_options.auth.headers[0].value}});var n=function(e){(new Array).push(A.ite_options.node);var t=" ";if(null!=e.GlobalStatus&&"SUCCESS"==e.GlobalStatus){var i=e.results[0],n=i.existing,a=i.new;if(null!=n&&null!=n.pid&&(n.pid,n.pid,null!=n.content&&null!=n.content.Variant)){var s=n.content.Variant;e.results[0].existing.content.displayExpression=o.getDisplayExpressionUsingXSLT(s)}if(null!=a&&null!=a.pid&&(t=a.pid,null!=a.content&&null!=a.content.Variant)){var c=a.content.Variant;e.results[0].new.content.displayExpression=o.getDisplayExpressionUsingXSLT(c)}}if(null!=e.GlobalStatus&&"SUCCESS"==e.GlobalStatus){var d={commandName:"cfgInlineVariant",widgetId:widget.id,response:o.getEventResponse(e),data:{}};o.publishPostProcessingEventForApplications(d)}if(" "!=t&&o.showwarning(l.CFG_Application_Refresh_For_Instance_Evolved,"info"),E.unmask(document.querySelector("#target-container")),A.cfgVarEffectivityInlineEditor.cfgVarDialog.closeDialog(),void 0!==e.GlobalStatus&&"SUCCESS"==e.GlobalStatus||void 0!==e.unset&&("SUCCESS"===e.unset.Variant.status.toUpperCase()||"WARNING"===e.unset.Variant.status.toUpperCase()))o.showwarning(l.Service_OK,"success");else if(void 0!==e.GlobalStatus&&"ERROR"==e.GlobalStatus&&void 0!==e.results[0].errorDetails){if(126==e.results[0].errorCode){let e="";null!=A.cfgVarEffectivityInlineEditor.cfgVarDialog&&null!=A.cfgVarEffectivityInlineEditor.cfgVarDialog.options&&null!=A.cfgVarEffectivityInlineEditor.cfgVarDialog.options.dialogue&&null!=A.cfgVarEffectivityInlineEditor.cfgVarDialog.options.dialogue.header&&2==A.cfgVarEffectivityInlineEditor.cfgVarDialog.options.dialogue.header.split("- ").length&&2==A.cfgVarEffectivityInlineEditor.cfgVarDialog.options.dialogue.header.split("- ").length&&(e=A.cfgVarEffectivityInlineEditor.cfgVarDialog.options.dialogue.header.split("- ")[1]);let t=r.CfgMessageNoEditVariantTitle.replace("{1}",e),i=r.CfgMessageNoEditVariantAction.replace("{1}","<b>"+r.CfgHeaderEditConfigurationContext+"</b>");o.showNotifs("error",t,r.CfgMessageNoEditVariantSubTitle,i)}else e.results[0].message&&""!=e.results[0].message&&o.showwarning(l.Service_Fail+" "+e.results[0].message,"error");console.log("Inline Edit Variant Effectivity operation error = "+e.results[0].errorDetails)}else o.showwarning(l.Service_Fail,"error");A.callEditVariantTrackerEvent(),A.callCommandClickTrackerEvent({mode:"Dashboard",operation:"OK"})},a=function(e){E.unmask(document.querySelector("#target-container")),A.cfgVarEffectivityInlineEditor.cfgVarDialog.closeDialog(),o.isDefined(e)&&o.isDefined(e.errorMessage)?o.showwarning(l.Service_Fail+"\n"+e.errorMessage,"error"):o.showwarning(l.Service_Fail,"error")};if(""==e){var s=[];s.push(A.ite_options.instanceID);var c={version:"2.0",wsOptions:i,unsetList:s,domain:"Variant"};o.unsetVariantEffectivities(c).then((function(e){n(e)}),(function(e){a(e)}))}else c={wsOptions:i,version:"1.1",domain:"Variant",view:"All",expressionList:[{pid:A.ite_options.instanceID,VariantContent:e}]},o.setVariantEffectivities(c).then((function(e){n(e)}),(function(e){a(e)}))}else A.cfgVarEffectivityInlineEditor.cfgVarDialog.closeDialog()},initVariantDialog:function(e){if(g&&!1===g.isEditVariantEnabled)return void o.showwarning(r.Edit_Variant_Disabled,"error");var t=e.options.relationid;if(g.clear(),g.cfgEffInlineEditorActionEvents=new C,this.subscribeCfgEffInlineEditorActionEvents(),A&&A.ite_options)return;var i="";i=e.options.grid["ds6w:label-Instance"]?e.options.grid["ds6w:label-Instance"]:e.options.label;let n="";if(n="function"==typeof e.getRealParent?e.getRealParent().getID():e._parentNode.options.resourceid,t&&""!==t&&window.cfgCmdWidgetData&&!0===window.cfgCmdWidgetData._isDecouplingActivated&&!0===window.cfgCmdWidgetData._isConfigAvailable&&!0===g.isEditVariantEnabled){A.ite_options={node:e,contextData:null,varEffJsonWithLabel:null,parentDiv:null,isInlineEmptyVariantEffectivity:!1,parentID:n,instanceID:t,mode:"ITEOnDashboard",width:800,height:500,minHeight:380,minWidth:240,probesData:[],setVariantEffectivity:A.setVariantEffectivity,cancelVariantDialog:A.cancelVariantDialog,iconModelURL:null,auth:{headers:[]},dialogue:{header:l.CFG_EDIT_VARIANT_HEADER+" - "+i,target:widget.body,buttonArray:null}},A.cfgVarEffectivityInlineEditor=new a,A.cfgVarEffectivityInlineEditor.initVariantDialog(A.ite_options);let r="defaultAppID",s="ODT Environment";widget&&widget.data&&widget.data.appId&&(r=widget.data.appId),widget&&widget.options&&widget.options.title&&(s=widget.options.title);let c={AppId:r,AppName:s,CommandName:y.Labels.EDIT_VARIANT_EFFECTIVITY,CommandOperation:"Edit_Variant_Effectivity_Inline_Dialog_Open",ConfigMode:y.ConfigMode.CONTEXTUAL,ApplicationMode:y.ApplicationMode.DASHBOARD};o.sendConfgurationCommandsClickEventForMagicProbes(c)}},getAdditionalCtxMenu:function(t){if(!1===e.is(t.callback,"function"))throw new Error("A callback function should be defined");if(void 0===t.ctxParams)throw new Error("No Ctx params given");var i=!1;if(t.ctxParams.treeview?(i=t.ctxParams.treeview.isHeader,t.ctxParams.treeview.dataIndex):"datagridview"===t.view&&(i=-1===t.ctxParams.cellInfos.rowID,t.ctxParams.collectionView.getColumnOrGroup(t.ctxParams.cellInfos.columnID).dataIndex),!0===i)t.callback("CfgEffectivityColumnsHeader",[]);else{var n=null,o=(i=!1,t.ctxParams);o.graphview?n=o.graphview.node:o.treeview?(n=o.treeview.nodeModel?o.treeview.nodeModel:o.treeview.cellModel,i=o.treeview.isHeader):n=o.cellInfos?o.cellInfos.nodeModel?o.cellInfos.nodeModel:o.cellInfos.cellModel:null;var a=t.treeDocument.getSelectedNodes();if(n&&(!o.treeview||!o.treeview.isHeader)){var r,s,c,d,f="enabled",u="enabled",g="enabled",C="enabled";null!=(r=p.getCommand("CopyVariantEffectivity"))&&(r._checkSelection(),0==r._isEnabled&&(f="disabled")),null!=(s=p.getCommand("PasteVariantEffectivity"))&&(s._checkSelection(),0==s._isEnabled&&(u="disabled")),null!=(c=p.getCommand("CopyEvolutionEffectivity"))&&(c._checkSelection(),0==c._isEnabled&&(g="disabled")),null!=(d=p.getCommand("PasteEvolutionEffectivity"))&&(d._checkSelection(),0==d._isEnabled&&(C="disabled"));var E={type:"PushItem",icon:"url("+v.getWebappsAssetUrl("CfgWebAppEffectivityUX","icons/I_Copy_Variant_Effectivity.png")+")",title:l.CFG_COPY_VARIANT_EFFECTIVITY,state:f,action:{context:{nodes:a},callback:function(e){r.execute()}}},m={type:"PushItem",icon:"url("+v.getWebappsAssetUrl("CfgWebAppEffectivityUX","icons/I_Paste_Variant_Effectivity.png")+")",title:l.CFG_PASTE_VARIANT_EFFECTIVITY,state:u,action:{context:{nodes:a},callback:function(e){s.execute()}}},y={type:"PushItem",icon:"url("+v.getWebappsAssetUrl("CfgWebAppEffectivityUX","icons/I_Copy_Evolution_Effectivity.png")+")",title:l.CFG_COPY_EVOLUTION_EFFECTIVITY,state:g,action:{context:{nodes:a},callback:function(e){c.execute()}}},I={type:"PushItem",icon:"url("+v.getWebappsAssetUrl("CfgWebAppEffectivityUX","icons/I_Paste_Evolution_Effectivity.png")+")",title:l.CFG_PASTE_EVOLUTION_EFFECTIVITY,state:C,action:{context:{nodes:a},callback:function(e){d.execute()}}}}setTimeout((function(){t.callback("copyVariantEffectivityCtx",E),t.callback("pasteVariantEffectivityCtx",m),t.callback("copyEvolutionEffectivityCtx",y),t.callback("pasteEvolutionEffectivityCtx",I)}),50)}},getOnCellClickCB:function(e){var t,i=this;switch(e){case"Effectivity":t=function(e){};break;case"VariantEffectivity":t=function(e){var t=e.nodeModel;if(m.get&&null!=m.get().getEditMode&&!0===m.get().getEditMode()){!1===A._columnDef.VariantEffectivity.readOnly&&i.initVariantDialog(t)}}}return t}});return A})),define("DS/CfgWebAppEffectivityUX/scripts/CfgConfigurationContextColumn",["UWA/Core","UWA/Class","DS/Utilities/Dom","DS/CfgBaseUX/scripts/CfgUtility","i18n!DS/CfgWebAppEffectivityUX/assets/nls/CfgEffectivityNLS","DS/CfgBaseUX/scripts/CfgController","i18n!DS/CfgXRevisionUX/assets/nls/CfgXRevisionUX","DS/CfgBaseUX/scripts/CfgUXEnvVariables","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","DS/Controls/TooltipModel","css!DS/CfgWebAppEffectivityUX/CfgWebAppEffectivityUX.css"],(function(e,t,i,n,o,a,l,r,s,c){"use strict";var d={};function f(e,t,i){if(!e.isHeader)if(e.cellModel.options.value){var n=e.cellView.reuseCellContent(t);n&&(n.innerText=e.cellModel.options.value)}else e.cellView.reuseCellContent(i)}function u(e){if(e.nodeModel)return e.cellModel!==s.CfgCtxNoReadAccess?"string":e.cellModel===s.CfgCtxNoReadAccess?"noReadAccessBlock":"configLoading"}var g=t.singleton({iconImageMap:null,_columnDataIndex:["ConfigurationContext"],_columnDef:{ConfigurationContext:{dataIndex:"ConfigurationContext",text:o.CFG_CONFIGURATION_CONTEXT_HEADER,width:180,minWidth:50,isHidden:!0,readOnly:!1,onCellRequest:function(e){f(e,"configuration_context_col_value","configuration_context_col_colloader")},xnav_options:{layout:{width:180,minWidth:50,maxWidth:300,removable:!0,hidden:!0},exportable:{lock:!1,value:!0}}}},_columnDefDGV:{},setReadOnlyMode:function(t){let i=!1;e.is(t,"boolean")?i=t:e.is(t,"string")&&(i="true"===t.toLowerCase()),g._columnStateReadOnly=i},init:function(e){this._parent(e),a.init(null,"","3DDashboard"),g.iconImageMap=new Map},isAdditionalColumnsAvailable:function(t){if(!1===e.is(t,"function"))throw new Error("A callback function should be defined");!function(t){n.rolesAvailable((function(i){d.ConfigurationContext=o.CFG_CONFIGURATION_CONTEXT_HEADER;var n={dataIndex:"ConfigurationContext",text:o.CFG_CONFIGURATION_CONTEXT_HEADER,width:180,minWidth:50,isHidden:!0,readOnly:!1,onCellRequest:function(e){f(e,"configuration_context_col_value","configuration_context_col_colloader")},xnav_options:{layout:{width:180,minWidth:50,maxWidth:300,removable:!0,hidden:!0},exportable:{lock:!1,value:!0}}},a={dataIndex:"ConfigurationContext",text:o.CFG_CONFIGURATION_CONTEXT_HEADER,width:180,minWidth:50,visibleFlag:!1,isAdditionalColumn:!0,readOnly:!1,getCellTypeRepresentation:u,customisation:{dataIndex:"ConfigurationContext",exportable:{lock:!1,value:!0},layout:{removable:!1}}};d.RevisionMaster=l.labelRevisionMaster;var s={dataIndex:"RevisionMaster",text:l.labelRevisionMaster,width:180,minWidth:50,isHidden:!0,readOnly:!1,onCellRequest:function(e){f(e,"revision_master_col_value","revision_master_col_colloader")},xnav_options:{layout:{width:180,minWidth:50,maxWidth:300,removable:!0,hidden:!0},exportable:{lock:!1,value:!0}}},C={dataIndex:"RevisionMaster",text:l.labelRevisionMaster,width:180,minWidth:50,visibleFlag:!1,isAdditionalColumn:!0,readOnly:!1,getCellTypeRepresentation:u,customisation:{dataIndex:"RevisionMaster",exportable:{lock:!1,value:!0},layout:{removable:!1}},onCellRequest:function(t){let i=new e.Element("div",{styles:{display:"flex"}});if(t.cellModel&&t.cellModel.length>1){let n=new Image(19,19),o=new e.Element("div",{}),a=new e.Element("div",{});if(g.iconImageMap){let e=" ";n.src=" ",t.nodeModel&&("function"==typeof t.nodeModel.getID?e=t.nodeModel.getID():t.nodeModel.getAttributeValue("id")&&(e=t.nodeModel.getAttributeValue("id")),n.src=g.iconImageMap.get(e)),o.addContent(n),o.addClassName("cfgRevisionMasterIconImage"),i.addContent(o)}a.addContent(t.cellModel),i.addContent(a),t.cellView.tooltipInfos=new c({shortHelp:t.cellModel})}t.cellView.setReusableContent(i)}};d.RevisionMode=l.labelRevisionControl;var p={dataIndex:"RevisionMode",text:l.labelRevisionControl,width:180,minWidth:50,maxWidth:300,isHidden:!0,readOnly:!1,onCellRequest:function(e){f(e,"revision_mode_col_value","revision_mode_col_colloader")},xnav_options:{layout:{width:180,minWidth:50,maxWidth:300,removable:!0,hidden:!0},exportable:{lock:!1,value:!0}}},v={dataIndex:"RevisionMode",text:l.labelRevisionControl,width:180,minWidth:50,maxWidth:300,visibleFlag:!1,isAdditionalColumn:!0,readOnly:!1,getCellTypeRepresentation:u,customisation:{dataIndex:"RevisionMode",exportable:{lock:!1,value:!0},layout:{removable:!1}}};!0===g._columnStateReadOnly&&(n.readOnly=!0,a.readOnly=!0,s.readOnly=!0,C.readOnly=!0,p.readOnly=!0,v.readOnly=!0);let E=r.getCfgUXEnvVariables();1!=i.isCHGRoleAvail&&1!=i.isCFGRoleAvail&&1!=i.isCSVRoleAvail||1==E.isXrevisionColumnsEnabled&&(g._columnDataIndex=["ConfigurationContext","RevisionMaster","RevisionMode"],g._columnDef={ConfigurationContext:n,RevisionMode:p,RevisionMaster:s},g._columnDefDGV={ConfigurationContext:a,RevisionMode:v,RevisionMaster:C}),t()}))}((function(){t(!0)}))},getName:function(){return"CfgConfigurationContextColumn"},getManagedColumnNames:function(){return this._columnDataIndex},toBeUpdated:function(e,t){var i=!1;return"SyncModelRefresh"!==t&&"OnSyncModel"!==t||(i=!0),void 0!==e.ConfigurationContext&&""!==e.ConfigurationContext&&void 0!==e.RevisionMaster&&""!==e.RevisionMaster&&void 0!==e.RevisionMode&&""!==e.RevisionMode||(i=!0),i},updateAttributes:function(t,i){if(!1===e.is(t,"object"))throw new Error("The object ids to modify must be specify");if(!1===e.is(i,"function"))throw new Error("A callback function should be defined");setTimeout((function(){let e={pids:{},relids:{}},o=0;if(widget.getValue("x3dPlatformId")?enoviaServerFilterWidget.tenant=widget.getValue("x3dPlatformId"):enoviaServerFilterWidget.tenant="OnPremise",t.pids.length>0)for(o=0;o<t.pids.length;o++)e.pids[t.pids[o]]={ConfigurationContext:" ",RevisionMaster:" ",RevisionMode:" "};let a={referenceIds:t.pids};n.populate3DSpaceURL().then((function(){n.populateSecurityContext().then((function(){n.getMultipleConfigurationContextInfo(a).then((async function(t){if(t.contextInfo&&t.version){if(t.contextInfo.forEach((function(i){let n,o,a,r,c=[],d="",f="Model";i.content&&i.content.results&&i.content.results[0]&&i.content.results[0].notification&&"ERROR"===i.content.results[0].notification.type?i.contextOf.forEach((function(t){e.pids[t].ConfigurationContext=s.CfgCtxNoReadAccess})):(i.content&&i.content.results&&(c=i.content.results,c[0]&&(d=c[0].type_icon_url,a=c[0].data.find((function(e){return"Marketing Name"===e.name})),a||(r=c[0].basicData.find((function(e){return"name"===e.name}))))),i.descId&&t.description&&t.description[i.descId]&&t.description[i.descId].results&&(c=t.description[i.descId].results,c[0]&&(d=c[0].type_icon_url,a=c[0].data.find((function(e){return"Marketing Name"===e.name})),o=c[0].basicData.find((function(e){return"revision"===e.name})),a||(r=c[0].basicData.find((function(e){return"name"===e.name}))),n=c[0].basicData.find((function(e){return"type"===e.name})),n&&n.value&&n.value[0]&&(f=n.value[0])))),i.contextOf.forEach((function(i){let n=e.pids[i];if(n&&n.ConfigurationContext!==s.CfgCtxNoReadAccess){d&&g.iconImageMap.set(i,enoviaServerFilterWidget.baseURL+d);let e=a&&a.value[0]||r&&r.value[0]||" ";"Model"!==f&&(e=a&&a.value[0]+" "+(o&&o.value[0])||r&&r.value[0]+" "+(o&&o.value[0])||" ");let s=t.referencesInfo.find((function(e){return e.pid===i})),c=s&&s.revisionMode?l["revisionControl"+s.revisionMode.replace(/\s+/g,"")]||s.revisionMode:" ";n.ConfigurationContext=" "!==n.ConfigurationContext?n.ConfigurationContext+", "+e:e,n.RevisionMaster=" "!==n.RevisionMaster?n.RevisionMaster+", "+e:e,n.RevisionMode=c}}))})),t.xRevisionContent){let i=t.xRevisionContent.filter((e=>e.attachedScopes&&e.attachedScopes[0]&&e.attachedScopes[0].attributes&&"Model"!==e.attachedScopes[0].attributes.type)).map((e=>e.attachedScopes[0].modelPID));i=[...new Set(i)];let o=await n.processSearchDataForMultipleIds(i);t.xRevisionContent.forEach((function(t){let i=t.xRevisionGraph&&t.xRevisionGraph.name||" ";e.pids[t.referencePID].RevisionMaster=i,g.iconImageMap.set(t.referencePID,enoviaServerFilterWidget.baseURL+"/snresources/images/icons/small/I_ENOVIA_Baseline.png"),t.attachedScopes?t.attachedScopes.forEach((function(i){if(i&&i.attributes&&i.attributes[0]&&i.attributes[0].notification&&"ERROR"===i.attributes[0].notification.type)e.pids[t.referencePID].ConfigurationContext=s.CfgCtxNoReadAccess;else{let n=i&&i.attributes&&i.attributes[0];"Model"!==n.type&&o.has(i.modelPID)&&(n=o.get(i.modelPID));let a=n&&n.data.find((function(e){return"Marketing Name"===e.name})),l=n&&n.basicData.find((function(e){return"name"===e.name}));if(a||l){let i=a?a.value[0]:l&&l.value[0];e.pids[t.referencePID].ConfigurationContext=" "!==e.pids[t.referencePID].ConfigurationContext?e.pids[t.referencePID].ConfigurationContext+", "+i:i}}})):e.pids[t.referencePID].ConfigurationContext=" "}))}t.referencesInfo&&t.referencesInfo.forEach((function(t){if(t.revisionMode){e.pids[t.pid]||(e.pids[t.pid]={});let i="revisionControl"+t.revisionMode.replace(/\s+/g,"");e.pids[t.pid].RevisionMode=l[i]||t.revisionMode}})),i(e)}}),(function(t){console.log("Get multiple configuration context Info error "+t),i(e)}))}),(function(t){console.log("populateSecurityContext error = "+t),i(e)}))}),(function(t){console.log("populate3DSpaceURL error = "+t),i(e)}))}),200)},getAdditionalColumnsUX:function(t){for(var i=[],n=0;n<t.length;n++)i.push(t[n].dataIndex);for(var o=0;o<this._columnDataIndex.length;o++){var a=this._columnDataIndex[o],l=e.clone(this._columnDef[a]),r=i.indexOf(a);-1===r?t.push(l):t[r]=e.extend(t[r],l,!0)}},getAdditionalColumnsUXDGV:function(t){for(var i=[],n=0;n<t.length;n++)i.push(t[n].dataIndex);for(var o=0;o<this._columnDataIndex.length;o++){var a=this._columnDataIndex[o],l=e.clone(this._columnDefDGV[a]),r=i.indexOf(a);-1===r?t.push(l):(t[r]=e.extend(t[r],l,!0),t[r].text=d[t[r].dataIndex])}},getTypeRepresentations:function(){return{configLoading:{stdTemplate:"functionIcon",semantics:{className:"relationRefresh",icon:{iconName:"reload wux-ui-3ds-spin",fontIconFamily:WUXManagedFontIcons.Font3DS}}},noReadAccessBlock:{stdTemplate:"functionIcon",semantics:{className:"relationBlock",icon:{iconName:"block",fontIconFamily:WUXManagedFontIcons.Font3DS}}}}},provideDisplayTooltip:function(e){var t=null;switch(e.dataIndex){case"RevisionMode":case"ConfigurationContext":t=e.cellModel&&e.cellModel.options&&" "==e.cellModel.options.value||" "==e.cellModel?"":e.cellModel.replaceAll(", ","\r\n")}return t},registerReusableCellContent:function(e){e.getManager().registerReusableCellContent({id:"configuration_context_col_colloader",buildContent:function(){return i.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}}),e.getManager().registerReusableCellContent({id:"configuration_context_col_value",buildContent:function(){return i.createElement("span")}})}});return g})),define("DS/CfgWebAppEffectivityUX/facets/EffectivityFacet",["UWA/Core","DS/EditPropWidget/facets/Common/FacetsBase","DS/EditPropWidget/constants/EditPropConstants","UWA/Class/Model","DS/UIKIT/Mask","i18n!DS/CfgEffectivityViewUX/assets/nls/CfgEffectivityView"],(function(e,t,i,n,o,a){"use strict";var l=t.extend({init:function(){this._parent.apply(this,arguments),this.elements.container||(this.elements.container=e.createElement("div",{styles:{height:"100%"}}))},updateFacet:function(){var e=this;o.mask(this.elements.container),require(["DS/CfgEffectivityViewUX/scripts/CfgEffectivityViewFactory"],(function(t){if(e.elements&&e.elements.container){var i=e.getModel();if(!i)return!1;var n="",l=e.getOccurrence().getOptions("Effectivity");n=l?l.targets[0].id:i.get("objectId");var r=i.getTenant(),s=new t;s.loadEffectivities(n,r).then((function(t){e.elements.container.setContent(""),s.createInstance(t,e.elements.container,!0).render(),o.unmask(e.elements.container),null!=t.effData&&""==t.effData.officialEvolutionExpression&&""==t.effData.variantExpression&&e.elements.container.setHTML(a.NO_EFF_MSG)}),(function(t){return o.unmask(e.elements.container),e.elements.container.setContent(""),console.log("CfgEffectivityViewFactory : loadEffectivities failed"),!1}))}}))},destroyComponent:function(){e.is(this.destroy,"function")&&this.destroy()}});return l})),define("DS/CfgWebAppEffectivityUX/scripts/CfgConfigurationRevisionColumn",["UWA/Core","UWA/Class","DS/Utilities/Dom","DS/CfgBaseUX/scripts/CfgUtility","i18n!DS/CfgWebAppEffectivityUX/assets/nls/CfgEffectivityNLS","DS/CfgBaseUX/scripts/CfgController","DS/PlatformAPI/PlatformAPI","DS/PADUtils/PADContext","DS/CfgBaseUX/scripts/CfgDialog","DS/CfgBaseUX/scripts/CfgData","DS/CoreEvents/ModelEvents","DS/CfgConfigurationRevisionUX/scripts/views/instance/CfgCRCompositionVersionExplorerView","DS/Utilities/TouchUtils","DS/CfgBaseUX/scripts/CfgUXEnvVariables","text!DS/CfgBaseUX/assets/CfgUXEnvVariables.json","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUXNLS","DS/Tweakers/TypeRepresentationFactory","DS/Controls/TooltipModel","css!DS/CfgWebAppEffectivityUX/CfgWebAppEffectivityUX.css"],(function(e,t,i,n,o,a,l,r,s,c,d,f,u,g,C,p,v,E){"use strict";var m={},y=new Map;function I(e){if(e.nodeModel)return e.cellModel!==p.CfgRevAccessDialogForCRCompose?"object":e.cellModel===p.CfgRevAccessDialogForCRCompose?"accessDialogForCRCompose":"configLoading"}y.set("Private",{NLS:p.CfgLabelInPrivate,labelColor:"#9B2C98"}),y.set("In Work",{NLS:p.CfgLabelInWork,labelColor:"#007DA3"}),y.set("Frozen",{NLS:p.CfgLabelInFrozen,labelColor:"#018308"}),y.set("Released",{NLS:p.CfgLabelInReleased,labelColor:"#757575"}),y.set("Obsolete",{NLS:p.CfgLabelInObsolete,labelColor:"#FFFFFF"});var h=t.singleton({_columnDataIndex:["ConfigurationRevision"],_columnDef:{ConfigurationRevision:{dataIndex:"ConfigurationRevision",text:o.CFG_CONFIGURATION_REVISION_HEADER,width:180,minWidth:50,maxWidth:300,isHidden:!0,readOnly:!1,xnav_options:{layout:{width:180,minWidth:50,maxWidth:300,removable:!0,hidden:!0},exportable:{lock:!1,value:!0}}}},_columnDefDGV:{},setReadOnlyMode:function(t){let i=!1;e.is(t,"boolean")?i=t:e.is(t,"string")&&(i="true"===t.toLowerCase()),h._columnStateReadOnly=i},setCRselectedData:function(e){"Set"==e.operation?(h.crDataJSON=e.dataJSON,h.isCRChanged=!0,h.physicalPrdCRDataMap&&(h.physicalPrdCRDataMap.clear(),h.physicalPrdCRDataMap=null),h.isCRManuallyComposed=!1,h.physicalPrdCRDataMap=new Map):"Remove"==e.operation&&(h.crDataJSON=null,h.crData=[],h.physicalPrdCRDataMap&&(h.physicalPrdCRDataMap.clear(),h.physicalPrdCRDataMap=null),h.isCRManuallyComposed=!1)},init:function(e){this._parent(e),a.init(null,"","3DDashboard");var t="";widget&&(t=widget.id),l.subscribe("NGFilter.SetConfigurationRevision_"+t,(function(e){h.setCRselectedData({operation:"Set",dataJSON:e})})),l.subscribe("NGFilter.RemoveConfigurationRevision_"+t,(function(e){h.setCRselectedData({operation:"Remove",dataJSON:e})}))},isAdditionalColumnsAvailable:function(t){if(!1===e.is(t,"function"))throw new Error("A callback function should be defined");!function(t){n.rolesAvailable((function(i){m.ConfigurationRevision=o.CFG_CONFIGURATION_REVISION_HEADER;let n=JSON.parse(C).isCRColumnTitleEnabled;var a={dataIndex:"ConfigurationRevision",text:o.CFG_CONFIGURATION_REVISION_HEADER,width:180,minWidth:50,maxWidth:300,isHidden:!0,readOnly:!1,onCellRequest:function(e){!function(e,t,i){if(!e.isHeader)if(e.cellModel.options.value){var n=e.cellView.reuseCellContent(t);n&&(n.innerText=e.cellModel.options.value)}else e.cellView.reuseCellContent(i)}(e,"configuration_revision_col_value","configuration_revision_col_colloader")},xnav_options:{layout:{width:180,minWidth:50,maxWidth:300,removable:!0,hidden:!0},exportable:{lock:!1,value:!0}}},l={dataIndex:"ConfigurationRevision",text:o.CFG_CONFIGURATION_REVISION_HEADER,width:!0===n?320:180,minWidth:50,maxWidth:!0===n?350:300,visibleFlag:!1,isAdditionalColumn:!0,readOnly:!1,getCellTypeRepresentation:I,customisation:{dataIndex:"ConfigurationRevision",exportable:{lock:!1,value:!0},layout:{removable:!1}},getCellClassName:function(e){return e&&e.nodeModel&&e.nodeModel._options&&e.nodeModel._options.grid&&e.nodeModel._options.grid.ConfigurationRevision&&Array.isArray(e.nodeModel._options.grid.ConfigurationRevision.crValues)&&e.nodeModel._options.grid.ConfigurationRevision.crValues.length>0&&""!==e.nodeModel._options.grid.ConfigurationRevision.crValues[0].value&&h&&h.crDataJSON?!0===h._columnDef.ConfigurationRevision.readOnly?"cfg-rev-col":"cfg-rev-col-link":"cfg-rev-col"},onCellRequest:async function(t){var i=new e.Element("div",{styles:{display:"flex"}});if(h.crDataJSON){{const e=new v,l=t.nodeModel._options.grid.ConfigurationRevision.crValues,r=t.nodeModel._options.grid.ConfigurationRevision.options;if(Array.isArray(l)&&l.length>0&&Array.isArray(r)&&r.length>0){const s=await e.generateView(l[0].value,{typePath:l[0].type,readOnly:r[0].readOnly,semantics:r[0].semantics});if(!0===n?s.getContent().addClassName("crTitle-revision"):s.getContent().addClassName("cr-revision"),i.addContent(s.getContent()),t.cellView.tooltipInfos=new E({shortHelp:"pencil"===l[0].value?p.CfgRevAccessDialogForCRCompose:l[0].value}),l[1]){var o,a;o=l[1].value&&y.get(l[1].value)&&y.get(l[1].value).NLS?y.get(l[1].value).NLS:l[1].value,a=l[1].value&&y.get(l[1].value)&&y.get(l[1].value).labelColor?y.get(l[1].value).labelColor:"#007DA3";const t=await e.generateView([o],{typePath:l[1].type,readOnly:r[1].readOnly,semantics:r[1].semantics});t.getContent().getChildren()[0].setStyle("background",a),"Obsolete"===l[1].value&&t.getContent().getChildren()[0].setStyle("color","#000"),i.addContent(t.getContent())}}}t.cellView.setReusableContent(i)}else t.cellView.tooltipInfos=new E({shortHelp:""}),t.cellView.setReusableContent(i)}};!0===h._columnStateReadOnly&&(a.readOnly=!0,l.readOnly=!0),1!=i.isCHGRoleAvail&&1!=i.isCFGRoleAvail&&1!=i.isCSVRoleAvail||(h._columnDataIndex=["ConfigurationRevision"],h._columnDef={ConfigurationRevision:a},h._columnDefDGV={ConfigurationRevision:l}),t()}))}((function(){var e=JSON.parse(C).isCRColumnVisible;t(null!=e&&1==e)}))},getName:function(){return"CfgConfigurationRevisionColumn"},getManagedColumnNames:function(){return this._columnDataIndex},toBeUpdated:function(e,t){var i=!1;return"SyncModelRefresh"!==t&&"OnSyncModel"!==t||(i=!0),void 0!==e.ConfigurationRevision&&""!==e.ConfigurationRevision||(i=!0),i},updateAttributes:function(t,i){if(!1===e.is(t,"object"))throw new Error("The object ids to modify must be specify");if(!1===e.is(i,"function"))throw new Error("A callback function should be defined");setTimeout((async function(){var e={pids:{},relids:{}},o=0;if(widget.getValue("x3dPlatformId")?enoviaServerFilterWidget.tenant=widget.getValue("x3dPlatformId"):enoviaServerFilterWidget.tenant="OnPremise",t.pids.length>0)for(o=0;o<t.pids.length;o++)e.pids[t.pids[o]]={ConfigurationRevision:{crValues:[{type:"string",value:""},{type:"tag",value:""}],options:[{readOnly:!0},{readOnly:!0,semantics:{allowMultipleValuesFlag:!0,emphasize:"success"}}]}};if(null!=h.crDataJSON&&null!=h.crDataJSON||i(e),null!=h.crDataJSON&&null!=h.crDataJSON){var a=h.crDataJSON;if(null!=h._getInformationResponse&&0==h.isCRChanged)h.computeCRData(h._getInformationResponse,t.pids),e=await h.computeConfigurationRevisionValues(e),i(e);else if(null!=a&&null!=a.configRevision&&1==a.configRevision.length){var l={configurationRevisionId:a.configRevision[0].id};n.populate3DSpaceURL().then((function(){n.populateSecurityContext().then((function(){n.getCRInformation(l).then((async function(n){null!=n&&null!=n.versions&&(h.isCRChanged=!1,h._getInformationResponse=n,h.computeCRData(n,t.pids),e=await h.computeConfigurationRevisionValues(e),i(e))}),(function(t){console.log("getCRInformationResponse error = "+t),i(e)}))}),(function(t){console.log("populateSecurityContext error = "+t),i(e)}))}),(function(t){console.log("populate3DSpaceURL error = "+t),i(e)}))}}}),200)},computeCRData(e,t){try{h.pidsRelatedToFilteredRoot=[];let i={crInfo:e,pIds:t};if(null!=r&&null!=r._context&&null!=r._context.getRoots()&&r._context.getRoots().length>0){let e;for(let t=0;t<r._context.getRoots().length;t++){let i=r._context.getRoots()[t];if(h.crDataJSON.rootId==i.options.resourceid||h.crDataJSON.rootId==i.options.physicalid){e=i;break}}null!=e&&h.computeAllPidsOfFilteredRoot(e),i.pIds=t.filter((e=>h.pidsRelatedToFilteredRoot.includes(e)))}h.isCRManuallyComposed||(h.crData=n.getCRColumnInfo(i)),h.isCRManuallyComposed=!1}catch(e){console.log("Compute CR data for CR column failed",e)}},computeAllPidsOfFilteredRoot(e){null!=e.options.resourceid?h.pidsRelatedToFilteredRoot.push(e.options.resourceid):null!=e.options.physicalid&&h.pidsRelatedToFilteredRoot.push(e.options.physicalid),void 0!==e.options.children&&e.options.children.forEach((e=>h.computeAllPidsOfFilteredRoot(e)))},async computeConfigurationRevisionValues(e){var t=[];try{t=h.crData.filter((e=>"ConfiguredBaseline"!==e.type)).filter((e=>void 0===h.physicalPrdCRDataMap.get(e.pid))).map((e=>({id:e.pid})))}catch(e){console.log("computeConfigurationRevisionValues failed for CR column ",e)}try{if(t.length>0)var i=await n.getAllowedSemanticsForMultipleProducts(t);let a=JSON.parse(C).isCRColumnTitleEnabled;for(let t of h.crData)if(" "===t.revision||" "===t.crID){if(i&&i.allowedSemantics)var o=i.allowedSemantics.find((e=>e.id===t.pid));!1===h._columnDef.ConfigurationRevision.readOnly&&(o&&n.isBaselineMode(t.pid,i)&&0==n.isFirstSemantic(t.pid,i)||h.physicalPrdCRDataMap.get(t.pid)&&h.physicalPrdCRDataMap.get(t.pid).isCRDefined)?(h.physicalPrdCRDataMap.set(t.pid,{isCRDefined:!0}),e.pids[t.pid]={ConfigurationRevision:{crValues:[{type:"icon",value:"pencil"}],options:[{stdTemplate:"functionIcon",semantics:{className:"relationCRCompose",icon:{iconName:"pencil",fontIconFamily:WUXManagedFontIcons.Font3DS}}}]}}):(h.physicalPrdCRDataMap.set(t.pid,{isCRDefined:!1}),e.pids[t.pid]={ConfigurationRevision:{crValues:[{type:"string",value:""},{type:"tag",value:""}],options:[{readOnly:!0},{readOnly:!0,semantics:{allowMultipleValuesFlag:!0,emphasize:"success"}}]}})}else{h.physicalPrdCRDataMap.set(t.pid,{isCRDefined:!0});let i=t.revision;!0===a&&(i=t.title+"  "+i),e.pids[t.pid]={ConfigurationRevision:{crValues:[{type:"string",value:i},{type:"tag",value:t.maturity}],options:[{readOnly:!0},{readOnly:!0,semantics:{allowMultipleValuesFlag:!0,emphasize:"success"}}]}}}}catch(t){console.log("Get allowed semantics web service failure ",t),h.crData.forEach((t=>{" "!==t.revision&&" "!==t.crID?e.pids[t.pid]={ConfigurationRevision:{crValues:[{type:"string",value:t.revision},{type:"tag",value:t.maturity}],options:[{readOnly:!0},{readOnly:!0,semantics:{allowMultipleValuesFlag:!0,emphasize:"success"}}]}}:e.pids[t.pid]={ConfigurationRevision:{crValues:[{type:"string",value:""},{type:"tag",value:""}],options:[{readOnly:!0},{readOnly:!0,semantics:{allowMultipleValuesFlag:!0,emphasize:"success"}}]}}}))}return e},getAdditionalColumnsUX:function(t){for(var i=[],n=0;n<t.length;n++)i.push(t[n].dataIndex);for(var o=0;o<this._columnDataIndex.length;o++){var a=this._columnDataIndex[o],l=e.clone(this._columnDef[a]),r=i.indexOf(a);-1===r?t.push(l):t[r]=e.extend(t[r],l,!0)}},getAdditionalColumnsUXDGV:function(t){for(var i=[],n=0;n<t.length;n++)i.push(t[n].dataIndex);for(var o=0;o<this._columnDataIndex.length;o++){var a=this._columnDataIndex[o],l=e.clone(this._columnDefDGV[a]),r=i.indexOf(a);-1===r?t.push(l):(t[r]=e.extend(t[r],l,!0),t[r].text=m[t[r].dataIndex])}},getTypeRepresentations:function(){return{configLoading:{stdTemplate:"functionIcon",semantics:{className:"relationRefresh",icon:{iconName:"reload wux-ui-3ds-spin",fontIconFamily:WUXManagedFontIcons.Font3DS}}},accessDialogForCRCompose:{stdTemplate:"functionIcon",semantics:{className:"relationCRCompose",icon:{iconName:"pencil",fontIconFamily:WUXManagedFontIcons.Font3DS}}}}},provideDisplayTooltip:function(e){var t=null;if("ConfigurationRevision"===e.dataIndex)t=e.cellModel&&e.cellModel.options&&" "==e.cellModel.options.value||" "==e.cellModel?"":e.cellModel;return t},registerReusableCellContent:function(e){e.getManager().registerReusableCellContent({id:"configuration_revision_col_colloader",buildContent:function(){return i.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reload wux-ui-3ds-spin"})}}),e.getManager().registerReusableCellContent({id:"configuration_revision_col_value",buildContent:function(){return i.createElement("span")}})},getOnCellClickCB:function(e){if(this.cfgUXEnvVariablesJS=g.getCfgUXEnvVariables(),!this.cfgUXEnvVariablesJS.isCFGCRCompositionEnabled)return;if(!0===h._columnDef.ConfigurationRevision.readOnly)return;let t;return"ConfigurationRevision"===e&&h.crDataJSON?t=async e=>{r.get&&null!=r.get().getEditMode&&!0===r.get().getEditMode()&&(h.crDataJSON.rootId!==e.nodeModel.options.resourceid?await this.initCRCompositionDialog(e.nodeModel):n.showwarning(p.CfgErrorCRComposeOnParent,"error"))}:"ConfigurationRevision"!==e||h.crDataJSON||n.showwarning(p.CfgInfoCRComposeFilterStructure,"info"),t},initCRCompositionDialog:async function(e){c.clear(),c.cfgCRCompositionActionEvents=new d,this.subscribeCfgCRCompositionActionEvents();let t=e.options.resourceid;const i=await n.getAllowedSemantics(t);if(n.isBaselineMode(t,i)&&0==n.isFirstSemantic(t,i)){let t=h.getMaturityOfParentCR();!t||"Private"!==t&&"In Work"!==t&&"Frozen"!==t?n.showwarning(p.CfgErrorCRComposeIncorrectParentState,"error"):await this.loadCRCompositionOfProduct(e)}},getMaturityOfParentCR:function(){let e=r.get().getSelectedNodes()[0].options.from,t=h.crData.find((t=>t.pid===e));return t?t.maturity:null},loadCRCompositionOfProduct:async function(e){widget?enoviaServerFilterWidget.tenant=widget.getValue("x3dPlatformId"):enoviaServerFilterWidget.tenant="OnPremise",await n.populate3DSpaceURL(),await n.populateSecurityContext(),await this.createVersionExplorerView(e)},createVersionExplorerView:async function(e){let t,i=e.options.resourceid,n=h.crData.find((e=>e.pid===i));n&&" "!==n.crID&&(t={displayName:n.name,id:n.crID,name:n.name,physicalid:n.crID,revision:n.revision,type:n.type}),this.CfgCRCompositionVersionExplorerViewObj=await new f({physicalIDOfProduct:i,crVersionToBeSelectedInVEObj:t||null}),this.createCRCompositionDialog(e,n)},createCRCompositionDialog:function(t,i){let o=this,a=t.options.resourceid,l=t.options.label;h.existingCRId=i.crID,this.MainContainer=new e.Element("div",{html:this.CfgCRCompositionVersionExplorerViewObj.render(),styles:{width:"100%",height:"100%"}});let c=[{label:"OK",labelValue:p.CfgLabelOK,handler:async function(){var e,i,l;if(o.CfgCRCompositionVersionExplorerViewObj.CfgCRCompositionFactoryObj.getVEObject().getSelectedNodes()[0]){if(t&&t.options&&t.options.grid&&t.options.grid.ConfigurationRevision&&Array.isArray(t.options.grid.ConfigurationRevision.crValues)&&"pencil"===t.options.grid.ConfigurationRevision.crValues[0].value){let e=r.get().getSelectedNodes()[0].options.from;l=h.crData.find((t=>t.pid===e)).crID}else[i,l]=o.computeExistingChildAndParentCRIds(a);e=o.CfgCRCompositionVersionExplorerViewObj.CfgCRCompositionFactoryObj.getVEObject().getSelectedNodes()[0].options.data.physicalid}else{if(t&&t.options&&t.options.grid&&" "===t.options.grid.ConfigurationRevision)return console.log("no operation"),void o.crCompositionDialog.closeDialog();[i,l]=o.computeExistingChildAndParentCRIds(a)}if(i!==e){try{var s=await o.CfgCRCompositionVersionExplorerViewObj.saveCRCompositionContent(i,e,l);if(!s||s.errorID)throw"Edit CR Composition Failure";n.showwarning(p.CfgMessageCRComposeSuccess,"success"),await o.updateCRInfoAfterCRComposition(),h.isCRManuallyComposed=!0,o.sendEventToPSE(s,a)}catch(e){n.showwarning(p.CfgErrorCRComposeFailure,"error")}o.crCompositionDialog.closeDialog()}else o.crCompositionDialog.closeDialog()},className:"primary"},{label:"Cancel",labelValue:p.CfgLabelCancel,handler:function(){o.crCompositionDialog.closeDialog()},className:"secondary"}],d={className:"",title:p.CfgLabelCRComposition,parent:widget.body,body:this.MainContainer,overlay:!0,mode:"DashboardConfigurationContext",closable:!1,animate:!0,resizable:!0,footer:c,persistId:"CfgCRComposition",width:440,height:490,minHeight:100,minWidth:370,style:{"min-height":"350px"},dialogue:{header:l?`${p.CfgLabelCRComposition} - ${l}`:p.CfgLabelCRComposition,buttonArray:c,target:widget.body},touchMode:null!=u.getTouchMode()&&0!=u.getTouchMode()};this.crCompositionDialog=new s(d),this.crCompositionDialog.render(),this.crCompositionDialog.footerButton.Ok.disabled=!0},sendEventToPSE:function(e,t){let i={commandName:"cfgRevManualComposition",widgetId:widget.id,response:e,data:{pids:[t]}};n.publishPostProcessingEventForApplications(i)},updateCRInfoAfterCRComposition:async function(){try{let e={configurationRevisionId:h.crDataJSON.configRevision[0].id},t=await n.getCRInformation(e);t&&t.versions&&(h.isCRChanged=!1,h._getInformationResponse=t,h.computeCRData(t,h.pidsRelatedToFilteredRoot))}catch(e){console.log("Fetching Configuration Revision Details for the selected Configuration Revision in filter is failed")}},computeExistingChildAndParentCRIds:function(e){let t,i;for(let n=0;n<h.crData.length;n++){let o=h.crData[n].children.find((t=>t.ChildPid===e));o&&(t=o.childCrID,i=o.parentCrID)}return[t,i]},subscribeCfgCRCompositionActionEvents:function(){c.cfgCRCompositionActionEvents.subscribe({event:"selectionInCRCompositionDialog"},(e=>{h.existingCRId===e.data.nodeModel.options.id?this.crCompositionDialog.footerButton.Ok.disabled=!0:this.crCompositionDialog.footerButton.Ok.disabled=!1})),c.cfgCRCompositionActionEvents.subscribe({event:"unselectionInCRCompositionDialog"},(()=>{" "===h.existingCRId?this.crCompositionDialog.footerButton.Ok.disabled=!0:this.crCompositionDialog.footerButton.Ok.disabled=!1}))}});return h}));