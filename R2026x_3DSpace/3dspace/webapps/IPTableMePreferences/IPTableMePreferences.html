<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" />
<html>
    <head>
        <!-- Application Metas -->
        <title>Bookmark Editor Grid Customization</title>
        <meta name="author" content="Dassault SystÃ¨mes" />
        <meta name="brand" content="ENOVIA" />
        <meta name="autoRefresh" content="0" />
        <meta name="description" content="ENOVIA Bookmark Editor Grid Customization" />
        <link rel="stylesheet" type="text/css" href="../Core/wux.css" />
        <link rel="stylesheet" type="text/css" href="./IPTableMePreferences.css" />
        <script type="text/javascript" src="../AmdLoader/AmdLoader.js"></script>
        <script type="text/javascript">
            var iframeContentWindow = null;
            var mepOrigin = null;
            var defaultJSON = null;
            var gridCusto = null;
            window.addEventListener("message", function (e) {
                var data = e.data;
                var eventName = "";
                if (data && data.message) eventName = data.message;
                if (eventName == "com.ds.mep:CustomDialogReady_msg") {
                    iframeContentWindow = e.source;
                    mepOrigin = e.origin;
                    defaultJSON = data.jsonData || "{}";
                    let tenantID = data.tenantID;
                    let lockState = data.lockState;
                    let compassConfig = data.compassConfig;
                    require.config({
                        locale: compassConfig.lang
                    });

                    require(["DS/IPTableMePreferences/IPTableMePreferences", "text!DS/IPTableMePreferences/assets/conf/ENOFOL3_IPTableMePreferences_conf.json"], function (
                        IPTableMePreferences,
                        confIPTableMePreferences
                    ) {
                        gridCusto = new IPTableMePreferences({
                            appId: "ENOFOL3_AP",
                            localWindow: window,
                            withUserView: true,
                            withAdminView: true,
                            frameCntWindow: iframeContentWindow,
                            mepOrigin: mepOrigin,
                            defaultJSON: JSON.parse(defaultJSON) || {},
                            defaultConf: JSON.parse(confIPTableMePreferences),
                            targetId: "bookmark-editor-IPTableMePreferences",
                            tenantID: tenantID,
                            lockState: lockState,
                            compassConfig: compassConfig
                        });
                        gridCusto.initialize();
                    });
                }
            });
        </script>
    </head>

    <body>
        <div id="bookmark-editor-IPTableMePreferences">
            <div class="IPTableMePreferences-loader-container">
                <span class="IPTableMePreferences-loader" />
            </div>
        </div>
    </body>
</html>
