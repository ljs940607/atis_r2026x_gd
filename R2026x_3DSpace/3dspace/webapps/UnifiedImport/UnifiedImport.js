define("DS/UnifiedImport/filters/ImportedDataFilter",["DS/TreeModel/BaseFilter"],(e=>e.inherit({isDataFiltered:function(e){return!!this.filterModel.allowedEntries&&!(e.options.label&&e.options.label.search(new RegExp(this.filterModel.allowedEntries,"i"))>-1||e.options.subLabel&&e.options.subLabel.search(new RegExp(this.filterModel.allowedEntries,"i"))>-1)}}))),define("DS/UnifiedImport/views/Hider",["UWA/Class/View"],(e=>e.extend({tagName:"div",className:"unifiedimport-hider",setup:function(){UWA.createElement("span",{text:UWA.i18n("unifiedImport.content.hideProcess"),class:"unifiedimport-hider-text"}).inject(this.container)}}))),define("DS/UnifiedImport/views/results/CommonResultsColumns",["UWA/Class","i18n!DS/UnifiedImport/assets/nls/UnifiedImportResultsNLS"],(function(e,t){"use strict";return UWA.i18n(t),[{text:UWA.i18n("importresults.grid.column.title"),dataIndex:"tree",width:250},{text:UWA.i18n("importresults.grid.column.type"),dataIndex:"type"},{text:UWA.i18n("importresults.grid.column.revision"),dataIndex:"revision",width:100},{text:UWA.i18n("importresults.grid.column.status"),dataIndex:"maturity",typeRepresentation:"tag"},{text:UWA.i18n("importresults.grid.column.created"),dataIndex:"created",typeRepresentation:"datetime",alignment:"near"},{text:UWA.i18n("importresults.grid.column.modified"),dataIndex:"modified",typeRepresentation:"datetime",alignment:"near"},{text:UWA.i18n("importresults.grid.column.description"),dataIndex:"description"},{text:UWA.i18n("importresults.grid.column.name"),dataIndex:"name"},{text:UWA.i18n("importresults.grid.column.owner"),dataIndex:"owner",typeRepresentation:"user"}]})),define("DS/UnifiedImport/views/FilesView",["DS/DataGridView/DataGridView"],(e=>({dgv:void 0,datagrid:function(){let t=new e({defaultColumnDef:{minWidth:105},sortModel:[{dataIndex:"statusValue",sort:"desc"}],columns:[{dataIndex:"fileName",typeRepresentation:"detailedInfo",getCellValue:function(e){if(e.nodeModel)return{icon:{iconName:"doc",iconStyle:1},label:e.nodeModel.getName(),subLabel:e.nodeModel.getFormattedSize()}}},{dataIndex:"status",typeRepresentation:"string",tooltip:"",width:"100px",getCellSemantics:function(e){switch(e.nodeModel.options.grid.statusValue){case 0:return{icon:"block",emphasize:"error"};case 1:return{icon:"status-ok",emphasize:"success"};default:return{icon:"status-ok-ongoing",emphasize:"primary"}}}},{dataIndex:"statusValue",typeRepresentation:"number",visibleFlag:!1}],getCellTooltip:function(e){if(e&&1==e.columnID&&e.cellModel)return{shortHelp:e.nodeModel.tooltipValue}}});return t.layout.cellHeight=40,t.rowSelection="multiple",t.columnSelection="none",t.cellSelection="none",t.layout.columnsHeader=!1,t.layout.rowsHeader=!1,t.showRowIndexFlag=!1,t.showSelectionCheckBoxesFlag=!0,t.layout.collectionView.showRowBorderFlag=!0,t.getContent().style.position="relative",this.dgv=t,t}}))),define("DS/UnifiedImport/utils/NotificationUtils",["UWA/Class","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],((e,t,i)=>e.singleton({Content:{NO_METHOD:{title:"unifiedImport.notification.error.noMethod",subtitle:"unifiedImport.notification.error.noMethod.subtitle",message:"",level:"error"},INVALID_METHOD:{title:"unifiedImport.notification.error.invalidMethod",subtitle:"unifiedImport.notification.error.invalidMethod.subtitle",message:"",level:"error"},CONTENT_DISAPPROVED:{title:"unifiedImport.notification.error.contentDisapproved",subtitle:"unifiedImport.notification.error.contentDisapproved.subtitle",message:"",level:"error"},CONTENT_UPLOADED:{title:"",subtitle:"",message:"unifiedImport.notification.info.contentUploaded",level:"info"},PROCESS_SUCCEEDED:{title:"",subtitle:"",message:"unifiedImport.notification.success.processSucceeded",level:"success"},PROCESS_FAILED:{title:"",subtitle:"",message:"unifiedImport.notification.error.processFailed",level:"error"},CHECKIN_TIMEOUT:{title:"unifiedImport.notification.error.timeout",subtitle:"unifiedImport.notification.error.timeout.subtitle",message:"unifiedImport.notification.error.timeout.message",level:"error"},CHECKIN_FAILED:{title:"",subtitle:"",message:"unifiedImport.notification.error.checkinFailed",level:"error"},CHECKIN_NETWORK_ERROR:{title:"unifiedImport.notification.error.networkError",subtitle:"unifiedImport.notification.error.networkError.subtitle",message:"",level:"error"},CHECKIN_MAX_FILE_SIZE_REACHED:{title:"unifiedImport.notification.error.maxFileSize",subtitle:"unifiedImport.notification.error.maxFileSize.subtitle",message:"",level:"error"},DRIVE_IMPORT_ERROR:{title:"",subtitle:"",message:"unifiedImport.notification.error.driveImportError",level:"error"},ERROR_CONTENT_EMPTY:{title:"",message:"unifiedImport.notification.error.contentEmpty",level:"error"},CHECKIN_FAILED_AT_IMPORTER:{fromImporter:!0,title:"",subtitle:"",message:"",level:"error"},CHECKIN_MAX_NO_OF_FILES_REACHED:{fromImporter:!0,title:"",subtitle:"",message:"",level:"error"}},init:function(arguments){this._parent(arguments),i.setNotificationManager(t),i.setFadeOutPolicy(2),i.setStackingPolicy(5)},formatAlertOpts:(e,t=void 0)=>(e.title&&(t&&t.payLoad&&t.payLoad.title&&t.payLoad.title.length?e.title=UWA.String.format(UWA.i18n(e.title),...t.payLoad.title):e.title=UWA.i18n(e.title)),e.subtitle&&(t&&t.payLoad&&t.payLoad.subtitle&&t.payLoad.subtitle.length?e.subtitle=UWA.String.format(UWA.i18n(e.subtitle),...t.payLoad.subtitle):e.subtitle=UWA.i18n(e.subtitle)),e.message&&(t&&t.payLoad&&t.payLoad.message&&t.payLoad.message.length?e.message=UWA.String.format(UWA.i18n(e.message),...t.payLoad.message):e.message=UWA.i18n(e.message)),e),alert:function(e,i){return e.fromImporter?(e={...e,title:UWA.i18n("unifiedImport.notification.error.failureFromImport"),message:[...i.payLoad.message].join(" ")},i=void 0):e=this.formatAlertOpts(e,i),t.addNotif(e)}}))),define("DS/UnifiedImport/models/SecurityContextModel",["UWA/Class/Model"],(e=>e.extend({parse:function(e){return e.name=e.ctxname,e.role=e.rolename,e.organization=e.orgname,e.collaborativeSpace=e.prjname,e.roleToDisplay=e.roletitle,e.organizationToDisplay=e.orgtitle,e.collaborativeSpaceToDisplay=e.prjtitle,e}}))),define("DS/UnifiedImport/models/SecurityContexts",["UWA/Class/Collection","DS/UnifiedImport/models/SecurityContextModel"],((e,t)=>{const i=["VPLMProjectLeader","3DSRestrictedLeader","VPLMCreator","3DSRestrictedAuthor"];return e.singleton({populate:function(e){let i=this;e.forEach((e=>{i.add(new t(e,{parse:!0}))}))},getHighestRole:function(){let e=[];for(const t of i)this.VPM_ROLES.includes(t)&&e.push(t);return e},getValidSecurityContexts:function(){let e=this;return e.toArray().filter((t=>e.VPM_ROLES.includes(t.get("role"))))},getDefaultSecurityContext:function(){let e=this;if(this.defaultModel=e.find((e=>e.get("isDefault"))),this.defaultModel)return this.defaultModel.get("name");var t=e.getHighestRole(),i=e.toArray();for(let e=0;e<t.length&&(this.defaultModel=i.find((i=>i.get("role")===t[e])),!this.defaultModel);e++);return this.defaultModel&&this.defaultModel.get("name")},getFirstSecurityContext:function(){var e=this.toArray();return e&&e.length&&e[0].get("name")||""},getCollaborativeSpaces:function(){let e=new Set,t=this.toArray().reduce(((t,i)=>(i.get("role")===this.defaultModel.get("role")&&(e.has(i.get("collaborativeSpace"))||(e.add(i.get("collaborativeSpace")),t.push({value:i.get("collaborativeSpace"),label:i.get("collaborativeSpaceToDisplay")}))),t)),[]);return this.sortItems(t)},getOrganizationsByCSpace:function(e){let t=new Set,i=this.toArray().reduce(((i,n)=>(n.get("role")===this.defaultModel.get("role")&&n.get("collaborativeSpace")===e&&(t.has(n.get("organization"))||(t.add(n.get("organization")),i.push({value:n.get("organization"),label:n.get("organizationToDisplay")}))),i)),[]);return this.sortItems(i)},sortItems:function(e){return e.sort(((e,t)=>e.label.localeCompare(t.label)))}})})),define("DS/UnifiedImport/utils/Essentials",["UWA/Class","DS/Utilities/UUID","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/Utilities/WebUXColorEnums","DS/UnifiedImport/models/SecurityContexts","text!DS/UnifiedImport/assets/config/UnifiedImport.json","i18n!DS/UnifiedImport/assets/nls/UnifiedImportNLS"],((e,t,i,n,o,r,s,a)=>{"use strict";UWA.i18n(a);let l=require.toUrl("");return l=l.substr(0,l.lastIndexOf("?")),e.singleton({x3dPlatformId:"undefined"!=typeof widget&&widget.environment?widget.environment.getAllData().x3dPlatformId:void 0,DEPLOYMENT:"/webapps",APP_TITLE_MAIN:"Engineering Import",APP_TITLE_CONTENT_IMPORTED:"Imported Content",SERVICE_DFS:"distributedfilestore",SERVICE_3DSPACE:"3DSpace",URL_BASE:l,URL_CVSERVLET_FETCH:"/cvservlet/fetch/v2",URL_SECURITY_CONTEXTS:"/resources/vplmte/getallctx",URL_FCS:"/fcs/servlet/fcs/checkin",COLLABORATIVESPACE_URL_IMPORT:"/resources/dataexchangeservice/collaborativespaceconfig/getvplmroleconfig?command=vplm::IMPORT",SERVER:{VERB:{GET:"GET",POST:"POST",PATCH:"PATCH",DELETE:"DELETE"},DEFAULT_HEADERS:{Accept:"application/json","Accept-Language":window.widget?window.widget.lang:"en","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}},LANG:window.widget?window.widget.lang:"en",EVENT_CONTENT:"content",EVENT_CONTENT_SELECTED:"contentselected",EVENT_CONTENT_SCAN_START:"contentscanstart",EVENT_CONTENT_SCAN_END:"contentscanend",EVENT_CONTENT_ANALYZED:"contentanalyzed",EVENT_LOAD_METHOD_SUCCEEDED:"loadmethodsucceeded",EVENT_METHOD_SELECTED:"methodselected",EVENT_METHOD_FOUND:"methodfound",EVENT_METHODS_FOUND:"methodsfound",EVENT_METHODS_LISTED:"methodslisted",EVENT_NO_METHOD_FOUND:"nomethodfound",EVENT_LOAD_METHOD_SUCCESS:"loadmethodsuccess",EVENT_LOAD_METHOD_FAILED:"loadmethodfailed",EVENT_NEW_IMPORT:"newimport",EVENT_CONTENT_APPROVED:"contentapproved",EVENT_CONTENT_PARTIALLY_APPROVED:"contentpartiallyapproved",EVENT_CONTENT_DISAPPROVED:"contentdisapproved",EVENT_CHECKIN_URL_FOUND:"checkinurlfound",EVENT_START_CHECKIN:"startcheckin",EVENT_CHECKIN_SUCCEEDED:"checkinsucceeded",EVENT_CHECKIN_PROGRESS:"checkinprogress",EVENT_CHECKIN_FAILED:"checkinfailed",EVENT_CHECKIN_TIMEOUT:"checkintimedout",EVENT_ATTACH_PREVIEW_START:"attach-preview-start",EVENT_ATTACH_PREVIEW_END:"attach-preview-end",EVENT_ATTACH_PREVIEW_PROGRESS:"attach-preview-progress",EVENT_CONTENT_UPLOADED:"contentuploaded",EVENT_FIELDS_VALIDATED:"fields-validated",EVENT_START_EXCHANGE:"startexchange",EVENT_EXCHANGE_REQUEST_SUCCEEDED:"exchangerequestsucceeded",EVENT_EXCHANGE_REQUEST_FAILED:"exchangerequestfailed",EVENT_EXCHANGE_NETWORK_ERROR:"networkerror",EVENT_EXCHANGE_CANCEL:"exchangecancel",EVENT_ERROR_OCCURRED:"erroroccurred",STATUS_CODES:{PRIVATE:{emphasize:"highlight",backgroundColor:o.COLORS_STATUS.COLOR_PURPLE_FOR_WHITE_LABEL,nlsKey:"importresults.grid.column.status.private"},IN_WORK:{emphasize:"primary",nlsKey:"importresults.grid.column.status.inwork"},FROZEN:{emphasize:"success",nlsKey:"importresults.grid.column.status.frozen"},RELEASED:{emphasize:"",nlsKey:"importresults.grid.column.status.released"},OBSOLETE:{emphasize:"highlight",backgroundColor:o.COLORS_STATUS.COLOR_SECTION_GRAY,nlsKey:"importresults.grid.column.status.obsolete"}},MAX_FILE_SIZE_GB:1,MAX_CONTENT_SIZE_BYTES:1073741824,setup:function(){let e=this;return new UWA.Promise.all([e.getPlatformServices().then(e.getSecurityContexts.bind(null,e)).then(e.getGrantedRoles.bind(null,e)).then(e.getVPMRoles.bind(null,e)).then(e.methods.bind(null,e))])},getPlatformServices:function(){let e=this;return new UWA.Promise((function(t,i){n.getPlatformServices({onComplete:e.postGetPlatformServices.bind(null,e,t)})}))},postGetPlatformServices:function(e,t,i){let n=i.find((function(t){return t.platformId==e.x3dPlatformId}));n||(n=i[0]),e.PLATFORM_SERVICES=n,t(e.PLATFORM_SERVICES)},getSecurityContexts:function(e){return new UWA.Promise((function(t,n){i.authenticatedRequest(e.PLATFORM_SERVICES["3DSpace"]+e.URL_SECURITY_CONTEXTS+"?tenant="+e.x3dPlatformId,{method:"GET",type:"json",proxy:"passport",onComplete:e.postGetSecurityContext.bind(null,e,t)})}))},postGetSecurityContext:function(e,t,i){r.populate(i.credentials),t()},getGrantedRoles:function(e){return new UWA.Promise((function(t,i){n.getGrantedRoles(e.postGetGrantedRoles.bind(null,e,t))}))},postGetGrantedRoles:function(e,t,i){e.GRANTED_ROLES=i,t()},getVPMRoles:function(e){return new UWA.Promise((function(t,i){e.server({url:`${e.PLATFORM_SERVICES["3DSpace"]}${e.COLLABORATIVESPACE_URL_IMPORT}`,method:e.SERVER.VERB.GET,headers:{SecurityContext:encodeURIComponent(r.getFirstSecurityContext())},onComplete:e.postGetVPMRolesSuccess.bind(null,e,t,i),onFailure:e.postGetVPMRolesFailures.bind(null,e,i)})}))},postGetVPMRolesSuccess:function(e,t,i,n){var o=UWA.is(n,"string")?JSON.parse(n):n;o&&o.RoleList&&o.RoleList.length>0&&(r.VPM_ROLES=o.RoleList,t()),e.postGetVPMRolesFailures(e,i)},postGetVPMRolesFailures:function(e,t){t(UWA.i18n("unifiedImport.widget.notHaveAccess"))},methods:function(e){e.METHODS=JSON.parse(s),e.METHODS_PREDICTABLE=[],e.METHODS_UNPREDICTABLE=[],e.METHODS.forEach((t=>{if(e.GRANTED_ROLES.some((function(e){return t.roles.indexOf(e.id)>-1})))if(t.import.validate){let i=t.import.validate["limited-availability"];if(i&&!e.hasParam(i))return;t.import.validate.methodIdentifier?e.METHODS_PREDICTABLE.push(t):e.METHODS_UNPREDICTABLE.push(t)}else e.METHODS_UNPREDICTABLE.push(t)}))},extension:function(e){return e.substring(e.lastIndexOf(".")+1,e.length)},dualExtension:function(e){let t=e.split(".");return t[t.length-2].toLowerCase()+"."+t[t.length-1]},server:function(e){let t=this,n={url:e.url,method:e.method||t.SERVER.VERB.GET,data:e.data,dataType:e.dataType||"json",timeout:e.timeout||5e5,cache:e.cache||3600,proxy:e.proxy||void 0,onComplete:e.onComplete,onFailure:e.onFailure,headers:e.headers&&UWA.merge(e.headers,t.SERVER.DEFAULT_HEADERS)||t.SERVER.DEFAULT_HEADERS};return i.authenticatedRequest(n.url,n)},unique:function(){return t.v4().substring(0,10).replaceAll("-","")},noop:function(){},formatBytes:function(e,t=2){if(!+e)return"0 Bytes";const i=t<0?0:t,n=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,n)).toFixed(i))} ${["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}`},hasParam:function(e){let t=window.location.search,i=new URLSearchParams(t);return!(!UWA.is(i)||!i.has("widgetDomain"))&&(i=i.get("widgetDomain"),i=new URL(i),i.searchParams.has(e))},setContext:function(e){this._contextData=Object.assign({},e)}})})),define("DS/UnifiedImport/models/JobNodeModel",["DS/TreeModel/TreeNodeModel","DS/UnifiedImport/utils/Essentials"],((e,t)=>e.extendNode({getImportedData:function(){let e=this,i=e.options.x3DContent.serviceName;return new UWA.Promise(((n,o)=>{let r=null;r=e.options.x3DContent.importerId?t.METHODS.find((t=>e.options.x3DContent.importerId===t.value)):t.METHODS.find((e=>i===e.service&&"3DEXPERIENCE"!==e.value)),r?t.server({url:t.PLATFORM_SERVICES[r.service]+UWA.String.format(r.import.resulturl,e.options.x3DContent.jobId),onComplete:function(e){if(e){const t=JSON.parse(e),i=t&&t["Root Objects"]?t["Root Objects"]:null;i?n(i):o(new Error("no objects found"))}},onFailure:function(e,t){o(t.errormsg)}}):o(new Error("no method found"))}))}}))),define("DS/UnifiedImport/views/DragZone",["UWA/Class/View","DS/Controls/Toolbar","DS/Controls/Button","DS/Core/TooltipModel","DS/WebUAUtils/WebUAUtils","DS/UnifiedImport/utils/Essentials","DS/UnifiedImport/utils/NotificationUtils"],((e,t,i,n,o,r,s)=>{var a,l,d;return e.extend({__private__:{}},{className:"unifiedimport-dragzone",setup:function(e){var t=this;t.treeDocument=e.treeDocument,t.setupDragText(),t.setupToolbar(),t.setupEvents()},setupToolbar:function(){var e=this;e.__private__.toolbar=new t({}),e.__private__.toolbar.inject(a),e.__private__.browseFile=UWA.createElement("input",{class:"unifiedimport-dragzone-input-file",type:"file",multiple:!0}),e.__private__.btnBrowseFiles=new i({emphasize:"primary",label:UWA.i18n("unifiedImport.action.filesOnDisk")}),e.__private__.btnBrowseFiles.tooltipInfos=new n({title:UWA.i18n("unifiedImport.action.filesOnDisk"),shortHelp:UWA.i18n("unifiedImport.action.filesOnDisk.shorthelp"),mouseRelativePosition:!0,moreHelpCB:o.getMoreHelpCallback(topics={helpid:"indexMode",content:{"indexMode.PanelHelp":"ENXUimpUserMap/enxuimp-t-import.htm"}})}),e.__private__.browseFolder=UWA.createElement("input",{class:"unifiedimport-dragzone-input-folder",type:"file",webkitdirectory:!0}),e.__private__.btnBrowseFolder=new i({label:UWA.i18n("unifiedImport.action.folderOnDisk")}),e.__private__.btnBrowseFolder.tooltipInfos=new n({title:UWA.i18n("unifiedImport.action.folderOnDisk"),shortHelp:UWA.i18n("unifiedImport.action.folderOnDisk.shorthelp"),mouseRelativePosition:!0,moreHelpCB:o.getMoreHelpCallback(topics={helpid:"indexMode",content:{"indexMode.PanelHelp":"ENXUimpUserMap/enxuimp-t-import.htm"}})}),e.__private__.toolbar.add("element",{element:e.__private__.btnBrowseFiles.getContent(),position:"center"}),e.__private__.toolbar.add("element",{element:e.__private__.btnBrowseFolder.getContent(),position:"center"})},setupDragText:function(){a=UWA.createElement("div",{class:"unifiedimport-dragzone-gridcontent"}).inject(this.container),l=UWA.createElement("h3",{class:"wux-ui-3ds wux-ui-3ds-drag-drop unifiedimport-dragzone-dragehereicon"}).inject(a),d=UWA.createElement("p",{class:"unifiedimport-dragzone-drageheretext lead",text:UWA.i18n("unifiedImport.action.info.browseContent")}).inject(a)},setupEvents:function(){var e=this;[{key:"dragevent",fn:e.activateZone.bind(null,e)},{key:"dragover",fn:e.activateZone.bind(null,e)},{key:"dragleave",fn:e.deActivateZone.bind(null,e)},{key:"drop",fn:e.drop.bind(null,e)}].forEach((t=>{e.container.addEventListener(t.key,t.fn)})),e.__private__.btnBrowseFiles.addEventListener("click",(function(){e.__private__.browseFile.click()})),e.__private__.browseFile.addEventListener("change",e.change.bind(null,e)),e.__private__.btnBrowseFolder.addEventListener("click",(function(){e.__private__.browseFolder.click()})),e.__private__.browseFolder.addEventListener("change",e.change.bind(null,e))},activateZone:function(e,t){e.container.classList.add("unifiedimport-dragzone-activated"),a.classList.add("unifiedimport-dragzone-gridcontent-activated"),l.classList.add("unifiedimport-dragzone-dragehereicon-activated"),d.classList.add("unifiedimport-dragzone-drageheretext-activated"),t.preventDefault()},deActivateZone:function(e){e.container.classList.remove("unifiedimport-dragzone-activated"),a.classList.remove("unifiedimport-dragzone-gridcontent-activated"),l.classList.remove("unifiedimport-dragzone-dragehereicon-activated"),d.classList.remove("unifiedimport-dragzone-drageheretext-activated")},drop:function(e,t){e.deActivateZone(e),e.change(e,t)},change:function(e,t){var i,n;t.preventDefault();var o=t&&t.dataTransfer&&t.dataTransfer.items;if(o&&o.length){if(t.dataTransfer.getData("text/plain"))(n=JSON.parse(t.dataTransfer.getData("text/plain"))).data.items.length&&e.treeDocument._modelEvents.publish({event:r.EVENT_CONTENT_SELECTED,data:n});else if(o.length){var a=o.length;i=[],e.maxdepth=0;for(var l=0;l<a;l++){var d=o[l],u=d.webkitGetAsEntry(),p=[];if(u&&u.isDirectory)p.push(new UWA.Promise((t=>{e.extractFiles(u).then((i=>{t(i.flat(e.maxdepth))}))})));else{let e=d.getAsFile();e.fullPath=u.fullPath,i.push(e)}}UWA.Promise.all(p).then((function(t){t=t.flat(),(i=i.concat(t)).length>0?e.treeDocument._modelEvents.publish({event:r.EVENT_CONTENT_SELECTED,data:i}):e.treeDocument._modelEvents.publish({event:r.EVENT_ERROR_OCCURRED,data:{errorType:s.Content.ERROR_CONTENT_EMPTY}})}))}}else if(i=t&&t.currentTarget&&t.currentTarget.files){for(let e=0;e<i.length;e++)i[e].fullPath=i[e].webkitRelativePath;e.treeDocument._modelEvents.publish({event:r.EVENT_CONTENT_SELECTED,data:i})}},extractFiles:function(e){var t=this;const i=e.createReader();return new Promise(((e,n)=>{const o=[];!function r(){i.readEntries((i=>{i.length?(o.push(Promise.all(i.map((e=>{var i=e.fullPath,n=i.split("/").length+1;return t.maxdepth<n&&(t.maxdepth=n),e.isFile?new Promise(((t,n)=>e.file((function(e){e.fullPath=i,t(e)}),n))):t.extractFiles(e)})))),r()):Promise.all(o).then((function(i){e(i.flat(t.maxdepth))}))}),(e=>n(e)))}()}))}})})),define("DS/UnifiedImport/views/ImportOptions",["UWA/Class/View","DS/UnifiedExchangeCommons/parameters/ParametersViewFactory","DS/UnifiedImport/models/SecurityContexts","DS/UnifiedImport/utils/Essentials"],((e,t,i,n)=>e.extend({className:"unifiedimport-options",setup:function(){let e=this;e.__private__={},e.hide(),e.setupEvents()},setupEvents:function(){let e=this;e.options.treeDocument._modelEvents.subscribe({event:n.EVENT_CONTENT_APPROVED},e.setupOptions.bind(null,e)),e.options.treeDocument._modelEvents.subscribe({event:n.EVENT_EXCHANGE_REQUEST_SUCCEEDED},(function(){e.__private__.optionsView&&e.__private__.optionsView.store()}))},setupOptions:function(e){let t=[e.getVPLMRoleConfig(),e.getCollaborativeSpaceConfig()],i=e.options.treeDocument.fields||[];e.show(),"function"==UWA.typeOf(i)?i({platformServices:n.PLATFORM_SERVICES,securityContext:n.SECURITY_CONTEXT}).then((i=>{e.buildOptions(t.concat(i))})):e.buildOptions(t.concat(i))},buildOptions:function(e){let i=this;e=i.refineOptions(e);let o=new t({id:`Unified-Import-${i.options.treeDocument.__private__.method.value}`,allow:function(e){i.options.treeDocument.getModelEvents().publish({event:n.EVENT_FIELDS_VALIDATED,data:{validated:!0}}),i.options.treeDocument.__private__.payload.options=e},block:function(){i.options.treeDocument.getModelEvents().publish({event:n.EVENT_FIELDS_VALIDATED,data:{validated:!1}})}});i.__private__.optionsView=o.build(e),i.__private__.optionsView.inject(i.container)},refineOptions:function(e){return e.map((e=>("bookmark"==e.key&&(e={key:"bookmark",label:UWA.i18n("unifiedImport.options.bookmark.label"),help:UWA.i18n("unifiedImport.options.bookmark.help"),type:"DS/UnifiedImport/views/options/BookmarkPicker"}),e)))},getVPLMRoleConfig:function(){return{key:"role",type:"DS/Controls/LineEditor",value:i.defaultModel.get("role"),options:{visibleFlag:!1},persist:!1}},getCollaborativeSpaceConfig:function(){let e=this,t=i.getCollaborativeSpaces(),n={key:"collaborativespace",label:UWA.i18n("unifiedImport.options.collaborativespace.label"),type:"DS/Controls/ComboBox",help:UWA.i18n("unifiedImport.options.collaborativespace.help"),validate:function(){if(!UWA.is(this.getAttributeValue("collaborativespace")))return UWA.i18n("unifiedImport.options.collaborativespace.validate.error")},options:{elementsList:t},successors:function(){if(this.collaborativespace)return e.getOrganizationConfig(this.collaborativespace)}};return 1==t.length&&(n.persist=!1,n.value=t[0].value,n.options.disabled=!0),n},getOrganizationConfig:function(e){let t=i.getOrganizationsByCSpace(e);if(t.length){let e={};return 1===t.length?e={type:"DS/Controls/ComboBox",value:t[0].value,options:{visibleFlag:!1,elementsList:t},persist:!1}:t.length>1&&(e={type:"DS/Controls/ComboBox",label:UWA.i18n("unifiedImport.options.organization.label"),help:UWA.i18n("unifiedImport.options.organization.help"),options:{elementsList:t}},e.validate=function(e){if(!UWA.is(this.getAttributeValue("organization")))return UWA.i18n("unifiedImport.options.organization.validate.error")}),e.key="organization",[e]}}}))),define("DS/UnifiedImport/models/ImportResultNodeModel",["DS/Core/TooltipModel","DS/TreeModel/TreeNodeModel","DS/UnifiedImport/utils/Essentials","DS/SearchDictionaryAccess/SearchDictionaryAccessAPI"],((e,t,i,n)=>{let o={label:"Import-PhysicalID",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:identifier","ds6w:modified","ds6w:created","ds6wg:revision","ds6w:status","ds6w:responsible","owner","ds6w:responsibleUid","ds6wg:filesize","ds6w:project","ds6w:dataSource","ds6w:community","ds6w:originator","dsgeo:referential","ds6w:lastModifiedBy","ds6w:repository","dcterms:title","dcterms:description","ds6w:containerUid","ds6w:description"],select_file:["icon","thumbnail_2d"],physicalid:"",select_snippets:["ds6w:snippet","ds6w:label:snippet","ds6w:responsible:snippet"],source:["3dspace"],tenant:""};return t.extendNode({verbose:function(){var e=this;return new UWA.Promise(((t,n)=>{o.physicalid=e.options.resourceId,o.tenant=i.x3dPlatformId,i.server({url:i.PLATFORM_SERVICES["3DSpace"]+`/cvservlet/fetch/v2?tenant=${i.x3dPlatformId}`,data:JSON.stringify(o),method:"POST",headers:{SecurityContext:i.SECURITY_CONTEXT},onComplete:function(i){i=JSON.parse(i);try{i&&i.results&&i.results.length?e.getNlsOfSearchValuesBySource(i.results[0]).then((n=>{e.updateOptions(e.toNodeOpts(i.results[0],n)),t()})):n()}catch(e){n()}},onFailure:function(){n()}})}))},getNlsOfSearchValuesBySource:function(e){return new Promise((function(t,o){var r=e.attributes,s={"ds6w:type":[{value:(r=r.reduce(((e,t)=>(e[t.name]=t.value,e)),{}))["ds6w:type"],source:["3DSpace"]}]};n.getNlsOfSearchValuesBySource(s,{apiVersion:"R2019x",tenantId:i.x3dPlatformId,lang:i.LANG,onComplete:function(e){t(e)},onFailure:function(){console.warn("NLS Service failed for ds6w:type"),t()}})}))},toNodeOpts:function(t,n){var o=this;o.__private__={};var r=t.attributes;r=r.reduce(((e,t)=>(e[t.name]=t.value,e)),{}),o.__private__.resourceId=r.resourceid,o.__private__.type=r["ds6w:type"],o.__private__.label=r["ds6w:label"];let s=r["ds6w:status"].split(".").pop().toUpperCase();return o.__private__.statusKey=i.STATUS_CODES[s].nlsKey?i.STATUS_CODES[s].nlsKey:void 0,{label:r["ds6w:label"],icon:r.type_icon_url,thumbnail:r.preview_url,subLabel:`${n["ds6w:type"][r["ds6w:type"]]} | ${r["ds6wg:revision"]} | ${r["ds6w:responsible:snippet"]||r["ds6w:responsible"]}`,description:`${r["ds6w:identifier"]} ${r["ds6w:description"]?"| "+r["ds6w:description"]:""}`,contextualMenu:["contextualMenu"],emptyStatusbarVisibleFlag:!0,customTooltip:new e({title:r["ds6w:label"],allowUnsafeHTMLLongHelp:!0,allowUnsafeHTMLContent:!0,longHelp:o.buildTooltipHTML(r,n),reshowDelay:2.5}),grid:{title:{label:r["ds6w:label"],icon:r.preview_url},type:r["ds6w:type"],typeToDisplay:n["ds6w:type"][r["ds6w:type"]],description:r["ds6w:description"],name:r["ds6w:identifier"],modified:r["ds6w:modified"],created:r["ds6w:created"],revision:r["ds6wg:revision"],status:o.__private__.statusKey?UWA.i18n(o.__private__.statusKey):void 0,statusKey:r["ds6w:status"],owner:{label:r["ds6w:responsible"]},contextualMenuData:null}}},buildTooltipHTML(e,t){let i={title:e["ds6w:label:snippet"],type:t["ds6w:type"][e["ds6w:type"]],revision:e["ds6wg:revision"],maturityState:this.__private__.statusKey?UWA.i18n(this.__private__.statusKey):void 0,owner:e["ds6w:responsible"],modified:e["ds6w:modified"],CollaborativeSpace:e["ds6w:project"],name:e["ds6w:identifier"],description:e["ds6w:description"]},n=[];for(const e in i)!["type_icon_url","preview_url"].includes(e)&&i[e]&&(n.push({tag:"span",styles:{"font-weight":"bold"},text:`${UWA.i18n(`importresults.grid.column.${e}`)} : `}),n.push({tag:"span",text:`${i[e]}`}),n.push({tag:"br"}));return UWA.createElement("div",{html:n})},getActionResource:function(){let e=this;return{resourceId:e.__private__.resourceId,type:e.__private__.type,label:e.__private__.label}},setContextualMenuData:function(e){this.options.grid.contextualMenuData={...e}},getGridOpts:function(){return this.options.grid}})})),define("DS/UnifiedImport/models/ImportResultTreeDocument",["DS/TreeModel/TreeDocument","DS/UnifiedImport/models/ImportResultNodeModel","DS/UnifiedImport/filters/ImportedDataFilter"],((e,t,i)=>e.extend({init:function(e){var t=this;t._parent(e),t._private_={dataIndex:0,ids:[]},t.getFilterManager().registerFilter("importedDataFilter",i)},populate:function(e,i){var n=i.map((i=>new UWA.Promise(((n,o)=>{var r=new t({resourceId:i});r.verbose().then((()=>{e.addRoot(r),n()})).fail(o)}))));return new UWA.Promise((function(e,t){UWA.Promise.allSettled(n).then((function(i){i.filter((e=>"fullfilled"===e.state)).length&&e()||t()}))}))},populateV2:function(){var e=this,i={},n=e.options.results.filter((e=>e.from&&e.to)),o=n.map((e=>e.to));e.withTransactionUpdate((function(){e.options.results.forEach((n=>{if(!n.from&&!n.Path){var r=new t({label:n["ds6w:label"],grid:n});i[n.resourceid]=r,o.includes(n.resourceid)||e.addRoot(r)}})),n.forEach((e=>{i[e.from].addChild(i[e.to])})),e.acceptChanges()}))},searchWidget:function(e,t){t&&t.trim()&&t.length?e.setFilterModel({status:{filterId:"importedDataFilter",filterModel:{allowedEntries:t},filterOptions:{ensureVisible:!0,keepChildren:!0}}}):e.resetSearchWidget(e)},resetSearchWidget:function(e){e.setFilterModel({status:{filterId:"importedDataFilter",filterModel:{allowedEntries:void 0}}})}}))),define("DS/UnifiedImport/views/results/ImportResults",["UWA/Core","UWA/Class/View","DS/i3DXCompassPlatformServices/OpenWith","DS/Tweakers/GeneratedToolbar","DS/Tweakers/TypeEnums","DS/UIKIT/Native/Dropdown","DS/DataGridView/DataGridView","DS/CollectionView/ResponsiveTilesCollectionView","DS/UnifiedImport/models/ImportResultTreeDocument","DS/UnifiedImport/utils/Essentials","i18n!DS/UnifiedImport/assets/nls/UnifiedImportResultsNLS","css!DS/UnifiedImport/UnifiedImport"],(function(e,t,i,n,o,r,s,a,l,d,u){return UWA.i18n(u),t.extend({tagName:"div",className:"exchange-results-view-importresults",setup:function(){let e=this;e.container.style.position="relative",e.container.style.height="100%",e.setupToolbar().inject(e.container),e.setupLayout().inject(e.container),e.getImportedData()},setupToolbar:function(){var e=this,t={entries:[{id:"resize",dataElements:{typeRepresentation:"functionIcon",value:e.toggleSize.bind(null,e),icon:{iconName:"resize-full",iconStyle:1,fontIconFamily:1},label:UWA.i18n("importresults.actions.maximize"),position:"far",category:"Resize"}},{id:"layout",position:"far",dataElements:{typeRepresentation:"layout",value:o.Layout.SmallTile,possibleValues:[o.Layout.SmallTile,o.Layout.DataGridView],onNodeUpdate:function(t){var i=t.getAttributeValue("data");e.changeView(i)}}}]},i=n.prototype.createTreeDocument(t);return e.toolbar=new n({touchMode:!1,visibleFlag:!1,overflowManagement:"dropdown",direction:"horizontal",items:i}),e.toolbar},setupLayout:function(){var e=this;e.options.treeDocument=new l({});let t=new a({useDragAndDrop:!0,displayedOptionalCellProperties:["contextualMenu","description"],useProgressBar:!1,displayTitleTooltip:!1,allowUnsafeHTMLContent:!0});return t.onDragStartCell=e.onDragStartCell.bind(null,e),t.onContextualEvent={callback:function(t){e.setOpenWithMenu(e,t)}},t.loadApplicativeModel(e.options.treeDocument),t.displayModalLoader(" "),e.tileView=t,e.tileView},onDragStartCell:function(e,t,i){var n=e.options.treeDocument.getSelectedNodes().map((function(e){return{options:{id:e.options.resourceId,type:e.options.grid.type,name:e.options.label}}})),o=e.setDroppableData(n);t.dataTransfer.setData("text/plain",JSON.stringify(o))},setDroppableData:function(e){return{protocol:"3DXContent",version:"1.1",source:widget.data.appId,widgetId:widget.data.appId,data:{items:e.map((e=>({envId:d.x3dPlatformId,serviceId:"3DSpace",contextId:d.SECURITY_CONTEXT,objectId:e.options.id,objectType:e.options.type,displayName:e.options.name,displayType:e.options.type})))}}},setOpenWithMenu:function(e,t){let n=this;e.ctxMenu&&(e.ctxMenu.destroy(),e.dropdownOptions.target=t.data.target);let o=(new i).set3DXContent({data:{items:[{objectType:""}]}}).render(new r({items:[]}));t&&t.cellInfos&&t.cellInfos.cellModel&&[].push({text:"test",id:"noActionsAvailable"}),e.dropdownOptions={items:[]},e.dropdownOptions.events={onHide:function(){e.ctxMenu=null},onClickOutside:function(){e.ctxMenu=null}},e.dropdownOptions.target=t.data.target,e.dropdownOptions.bound=!1,e.dropdownOptions.removeOnHide=!0,e.dropdownOptions.className="search-ctx-actions-dropdown-container",e.ctxMenu=null,e.ctxMenu=new r(e.dropdownOptions);let s=t.cellInfos.nodeModel.options.grid.contextualMenuData;if(s)return o.set3DXContent(s).setIndex(0).render(e.ctxMenu),e.ctxMenu.show(),e.ctxMenu;n.contextMenuActions(t.cellInfos.nodeModel.getActionResource()).then((i=>(t.cellInfos.nodeModel.setContextualMenuData(i),o.set3DXContent(i).setIndex(0).render(e.ctxMenu),e.ctxMenu.show(),e.ctxMenu))).catch((e=>{console.error("An error occurred:",e)}))},contextMenuActions:function(e){return new UWA.Promise(((t,i)=>{let n={appName:widget.data.appId,objects:[{id:e.resourceId,type:e.type,source:"3dspace",isRecentObject:!1}],platformId:d.x3dPlatformId,applicativeInfo:{incontextMode:!1,clientAppInfo:{identifier:"3DDashboard"},addOpenWith:!0}};d.server({url:d.PLATFORM_SERVICES["3DSpace"]+"/resources/SNAPI/search_delegation/actions",data:JSON.stringify(n),method:"POST",headers:{SecurityContext:d.SECURITY_CONTEXT},onComplete:n=>{if("success"==(n=JSON.parse(n)).status){let i=n.actions[0].actions.find((e=>"3DCompass_#OpenWith"==e.id)),o={protocol:"3DXContent",version:"2.0",source:"X3DSEAR_AP",widgetId:widget.id,data:{items:[{objectId:e.resourceId,objectType:e.type,envId:d.x3dPlatformId,serviceId:"3DSpace",displayName:e.label,displayType:"3D Shape",contextId:d.SECURITY_CONTEXT,objectTaxonomies:i.cmdInfo.type}]}};t(o)}else i()},onFailure:()=>{i("action not completed")}})}))},changeView:function(e){let t=this;if("datagridview"==e){if(t.gridView)t.gridView.show();else{var i=new s({touchMode:!1,showContextualMenuColumnFlag:!0,treeDocument:t.options.treeDocument,placeholder:"",cellDragEnabledFlag:!0,columns:[{text:UWA.i18n("importresults.grid.column.title"),dataIndex:"title",typeRepresentation:"url",width:250},{text:UWA.i18n("importresults.grid.column.type"),dataIndex:"typeToDisplay"},{text:UWA.i18n("importresults.grid.column.revision"),dataIndex:"revision",width:100},{text:UWA.i18n("importresults.grid.column.status"),dataIndex:"status",typeRepresentation:"tag",getCellSemantics:function(e){var t=e.nodeModel.options.grid.statusKey?e.nodeModel.options.grid.statusKey.split(".").pop().toUpperCase():void 0;if(t)return d.STATUS_CODES[t]}},{text:UWA.i18n("importresults.grid.column.created"),dataIndex:"created",typeRepresentation:"datetime",alignment:"near",getCellSemantics:function(e){return{timePickerPrecision:"sec"}}},{text:UWA.i18n("importresults.grid.column.modified"),dataIndex:"modified",typeRepresentation:"datetime",alignment:"near",getCellSemantics:function(e){return{timePickerPrecision:"sec"}}},{text:UWA.i18n("importresults.grid.column.description"),dataIndex:"description"},{text:UWA.i18n("importresults.grid.column.name"),dataIndex:"name"},{text:UWA.i18n("importresults.grid.column.owner"),dataIndex:"owner",typeRepresentation:"user"}],onContextualEvent:function(e){t.setOpenWithMenu(this,e)}}).inject(t.container);i.layout.cellHeight=40,i.layout.collectionView.showAlternateBackgroundFlag=!0,i.layout.rowsHeader=!1,i.layout.collectionView.showRowBorderFlag=!0,i.onDragStartCell=t.onDragStartCell.bind(null,t),t.gridView=i}t.tileView.hide()}else t.gridView&&t.gridView.hide(),t.tileView.show()},getImportedData:function(){var e=this;e.options.rootObjects?d.setup().then((function(){e.onGetDataSuccess(e,e.options.rootObjects)})).fail((function(){UWA.createElement("p",{text:UWA.i18n("unifiedImport.widget.notHaveAccess")})})):e.onGetDataFailure(e)},onGetDataSuccess:function(e,t){e.options.treeDocument.populate(e.options.treeDocument,t).then((function(){e.toolbar.visibleFlag=!0})).fail((function(){e.setAlternateText(UWA.i18n("importresults.data.error2"))})).finally((function(){e.tileView.removeModalLoader(" ")}))},onGetDataFailure:function(e){e.tileView.removeModalLoader(" "),e.setAlternateText(UWA.i18n("importresults.data.error"))},setAlternateText:function(e){this.container.empty(),UWA.createElement("p",{text:e}).inject(this.container)},toggleSize:function(e,t){"resize-full"===t.dsModel.icon.iconName?e.maximize():e.restore()},maximize:function(){var e=this;e.toolbar.updateNodeModel("resize",{label:UWA.i18n("importresults.actions.restore"),icon:{iconName:"resize-small",iconStyle:1,fontIconFamily:1}});var t=UWA.createElement("div",{class:"importresults-actions-resize-overlay"}).inject(widget.body);t.style.height="100%",t.style.width="100%",t.style.zIndex="50000",t.style.position="absolute",t.style.background="#FFFFFF",e.overlay=t,e.overlay.empty(),e.overlay.show(),e.previousParent=e.getContent().getParent(),e.inject(t)},restore:function(){var e=this;e.toolbar.updateNodeModel("resize",{label:UWA.i18n("importresults.actions.maximize"),icon:{iconName:"resize-full",iconStyle:1,fontIconFamily:1}}),e.previousParent&&e.inject(e.previousParent),e.overlay&&(e.overlay.empty(),e.overlay.remove())}})})),define("DS/UnifiedImport/models/BookmarkPickerModel",["UWA/Class/Model","DS/UnifiedImport/utils/Essentials"],((e,t)=>e.extend({fetch:function(e){var i=this;return new UWA.Promise(((n,o)=>{e?t.server({url:`${t.PLATFORM_SERVICES["3DSpace"]}${t.URL_CVSERVLET_FETCH}?tenant=${t.x3dPlatformId}`,method:t.SERVER.VERB.POST,data:JSON.stringify({physicalid:[e],label:`unifiedexchange-${i.APP_ID}-${(new Date).getTime()}`,select_predicate:["ds6w:label"]}),headers:{SecurityContext:t.SECURITY_CONTEXT},onComplete:n,onFailure:o}):o()}))}}))),define("DS/UnifiedImport/views/options/BookmarkPicker",["DS/Controls/Abstract","DS/Controls/Button","DS/Controls/LineEditor","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/FolderActive/FolderActive","DS/UnifiedImport/models/BookmarkPickerModel"],((e,t,i,n,o,r,s)=>e.inherit({name:"bookmarkpicker",publishedProperties:{value:{defaultValue:void 0,type:"string"}},buildView:function(){this._private_={model:new s},this.setupPicker()},postBuildView:function(e){var t=this;e&&e.value?t._private_.model.fetch(e.value).then(t.setPreviouslySelectedValue.bind(null,t)).finally(t.setToDefault.bind(null,t)):t.setToDefault(t)},setPreviouslySelectedValue:function(e,t){var i=(t=JSON.parse(t)).results[0].attributes.find((e=>"ds6w:label"===e.name)).value,n=t.results[0].attributes.find((e=>"resourceid"===e.name)).value;e.value=n,e._private_.lineEditor.value=i,e.fire("change")},setToDefault:function(e){e._private_.lineEditor.placeholder=UWA.i18n("unifiedImport.options.bookmark.placeholder"),e._private_.button.disabled=!1},setupPicker:function(){var e=this,t=UWA.createElement("div",{styles:{display:"flex",gap:1}}).inject(e.elements.container);e.setupLineEditor().inject(t),e.setupBrowse().inject(t)},setupLineEditor:function(){var e=new i({fireOnlyFromUIInteractionFlag:!0,disabled:!0,placeholder:UWA.i18n("unifiedImport.options.bookmark.placeholder.loading")});return e.getContent().style.width="100%",e.getContent().getChildren()[0].style.borderTopRightRadius="0px",e.getContent().getChildren()[0].style.borderBottomRightRadius="0px",this._private_.lineEditor=e,e},setupBrowse:function(){var e=new t({label:UWA.i18n("unifiedImport.options.bookmark.browse"),disabled:!0});return e.addEventListener("buttonclick",this.setupActiveBookmark.bind(null,this)),e.getContent().style.width="100px",e.getContent().style.borderTopLeftRadius="0px",e.getContent().style.borderBottomLeftRadius="0px",this._private_.button=e,e},setupActiveBookmark:function(e){let t;const i=new n({}),s=new r({multiSelectionComponent:{withClassify:!1,inputObjects:{authoring:!0,dialogButtons:!0,favoriteButton:!0,selectionMode:"DefaultSingle"}.objects},selectionMode:"DefaultSingle",authoring:!0,dialogButtons:!0,favoriteButton:!0});s.nestedMenuInContext.addEvent("onClassifyMultiple",(function(t){e._private_.lineEditor.value=s.nestedMenuInContext._selectBookmarkLabel,e.value=t.chosenClasses[0],e.fire("change"),i.remove()})),s.nestedMenuInContext.addEvent("onSelectorCancel",(function(e){i.remove()})),t=new o({title:UWA.i18n("unifiedImport.options.bookmark.browse.title"),immersiveFrame:i,content:s.nestedMenuInContext.getMultiSelectorContainer(),height:300,activeFlag:!1,modalFlag:!0,usePaddingFlag:!0}),t.addEventListener("close",(()=>{t.destroy(),i.destroy()})),i.inject(widget.body)}}))),define("DS/UnifiedImport/views/PotentialMethods",["UWA/Class/View","DS/Controls/Label","DS/Controls/ComboBox","DS/UnifiedExchangeCommons/parameters/ParametersViewFactory","DS/UnifiedImport/utils/Essentials"],((e,t,i,n,o)=>{var r,s;return e.extend({__private__:{}},{className:"unifiedimport-potential-methods",setup:function(e){var t=this;t.container.hide(),r=s=void 0,t.treeDocument=e.treeDocument,(r=UWA.createElement("div",{})).hide(),r.inject(t.container),t.setupEvents()},setupEvents:function(){var e=this;e.treeDocument._modelEvents.subscribe({event:o.EVENT_METHODS_FOUND},e.methodsFound.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:o.EVENT_METHOD_FOUND},e.methodFound.bind(null,e))},methodsFound:function(e,t){e.potentialmethodscombo(t)},methodFound:function(e,t){(t=UWA.clone(t)).selected=!0,e.potentialmethodscombo([t]).disabled=!0},potentialmethodscombo:function(e){var n=this;if(n.container.show(),!s){n.__private__.methods=e,r.show();var o=new t({value:UWA.i18n("unifiedImport.header.title.importmethod")}).inject(r);o.getContent().style.background="transparent",o.getContent().style.fontWeight="bold",(s=new i({placeholder:UWA.i18n("unifiedImport.content.potentialmethods.placeholder"),elementsList:n.__private__.methods})).addEventListener("change",n.methodSelected.bind(null,n)),s.value=1==n.__private__.methods.length&&n.__private__.methods[0].value,s.inject(r),s.getContent().style.width="100%"}return s},methodSelected:function(e,t){t.target.dsModel.disabled=!0;var i=t.target.dsModel.selectedIndex;e.treeDocument._modelEvents.publish({event:o.EVENT_METHOD_SELECTED,data:e.__private__.methods[i]})}})})),define("DS/UnifiedImport/models/FileNodeModel",["UWA/Class","DS/TreeModel/TreeNodeModel","DS/Utilities/UUID","DS/UnifiedImport/utils/Essentials"],((e,t,i,n)=>(t=t.extendNode({setup:function(e,t){if(this.__private__={},this.__private__.isWithDualExtension=t,this.__private__.file=e,this.__private__.name=e.name,t){this.__private__.extension=n.dualExtension(e.name).toLowerCase();var i=e.name.split(".");this.__private__.nameNoExt=i.slice(0,i.length-2).join(".")}else this.__private__.extension=e.name.substring(e.name.lastIndexOf(".")+1,e.name.length).toLowerCase(),this.__private__.nameNoExt=e.name.slice(0,e.name.lastIndexOf("."))},getNameNoExt:function(){return this.__private__.nameNoExt},getName:function(){return this.__private__.name},getFormattedSize:function(){return n.formatBytes(this.__private__.file.size)},getSize:function(){return this.__private__.file.size},getFile:function(){return this.__private__.file},getExtension:function(){return this.__private__.extension},isIterated:function(){return this.iterated},setAsValidated:function(){this.iterated=!0},setTooltipValue:function(e){this.tooltipValue=e},isFileWithDualExtension:function(){return this.__private__.isWithDualExtension},isInPrimaryExtension:function(e,t=!1){const i=this.getExtension();if(t){const[t,n]=i.split(".");return!(!n||!e.includes(t)||n.startsWith("0"))}return e.includes(i)}}),e.singleton({create:function(e,i){var n=new t;return n.setup(e,i),n}})))),define("DS/UnifiedImport/views/results/CommonResults",["UWA/Class/View","DS/Utilities/TouchUtils","DS/Tweakers/GeneratedToolbar","DS/DataGridView/DataGridView","DS/UnifiedImport/models/ImportResultTreeDocument","DS/UnifiedImport/views/results/CommonResultsColumns","i18n!DS/UnifiedImport/assets/nls/UnifiedImportResultsNLS","css!DS/UnifiedImport/UnifiedImport"],(function(e,t,i,n,o,r,s){"use strict";UWA.i18n(s);let a=r;return e.extend({tagName:"div",className:"exchange-results-view-commonresults",setup:function(){let e=this;e.setupToolbar(),e.setupLayout(),e.subscription()},setupToolbar:function(){let e=this,t=[{id:"mass-update",dataElements:{typeRepresentation:"functionIcon",readOnly:!0,icon:{iconName:"multiselect-pencil",fontIconFamily:1},position:"far",label:"Mass Update",value:function(){e.gridView.showModelMassUpdateDialog()}}}];UWA.is(e.options.view.toolbar)&&UWA.is(e.options.view.toolbar.entries)&&(t=[...e.options.view.toolbar.entries,...t]),e.toolbarTreeDocument=i.prototype.createTreeDocument({entries:t}),e.generatedToolbar=new i({overflowManagement:"dropdown",direction:"horizontal",items:e.toolbarTreeDocument}),e.generatedToolbar.getContent().style.paddingBottom="5px",e.generatedToolbar.inject(e.container)},setupLayout:function(){let e=this;e.options.treeDocument=new o({results:e.options.data.results,useAsyncPreExpand:!0}),e.options.treeDocument.setUseChangeTransactionMode(!0);let i=new n({identifier:"unified-import-common-results",treeDocument:e.options.treeDocument,placeholder:"",showOutlineFlag:!0,columns:e.setupColumns(),onContextualEvent:e.setupContextMenuActions.bind(null,e)}).inject(e.container);i.layout.columnsHeader=!0,i.layout.rowsHeader=!0,i.showRowIndexFlag=!1,i.layout.collectionView.showRowBorderFlag=!0,i.layout.collectionView.showColumnBorderFlag=!1,i.getContent().style.top=(t.getTouchMode()?55:45)+"px",e.gridView=i,e.options.treeDocument.populateV2()},setupColumns:function(){let e=this;!1===e.options.defaultColumns&&(a=[]);let t=e.options.view.datagrid.columns,i=a.concat(t),n={};return e.options.treeDocument.setFilterModel({owner:{filterId:"set"},type:{filterId:"set"}}),i=i.map((e=>(n[e.dataIndex]={filterId:"set"},e.filterOptions={mapPossibleValues:function(e){return new UWA.Promise((function(t,i){t(e)}))}},e))),e.options.treeDocument.setFilterModel(n),i},setupContextMenuActions:function(e,t){let i=[];if(t&&t.collectionView){let e={expandCollapse:!0};i=t.collectionView.buildDefaultContextualMenu(t,e)}return i},subscription:function(){let e=this;widget.addEvent("onSearch",(t=>{e.options.treeDocument.search(e.options.treeDocument,t)})),widget.addEvent("onRefresh",(()=>{})),widget.addEvent("onResetSearch",(function(t){e.options.treeDocument.resetSearch(e.options.treeDocument,t)}))},isEditable:function(){let e=this.gridView.columns.find((e=>e.editableFlag));return UWA.is(e)}})})),define("DS/UnifiedImport/utils/Validator",["UWA/Class","UWA/Class/Options","DS/UnifiedImport/utils/Essentials"],((e,t,i)=>e.extend(t,{init:function(e){e=e||{},this.setOptions(e)},getMaxNbOfFiles:function(){return this.options["max-nb-of-files"]},getMaxFileSize:function(){return this.options["max-file-size"]},getMaxFileNameSize:function(){return this.options["max-file-name-length"]},getValidExtensions:function(){return this.options.extensions},validateByMaxNbOfFiles:function(e){const t=this.getMaxNbOfFiles();if(t&&e.length>t)return UWA.String.format(UWA.i18n("unifiedImport.notification.error.maxNoOfFiles"),this.options["max-nb-of-files"])},validateConfig:function(e,t){const n=this.getMaxFileSize(),o=this.getMaxFileNameSize(),r=this.getValidExtensions(),s=e.getNameNoExt(),a=r&&"*"==r[0]||t;return!r||a||r.includes(e.getExtension())?n&&e.getSize()>n?UWA.String.format(UWA.i18n("unifiedImport.content.grid.tooltip.maxFileSize"),i.formatBytes(n)):o&&s.length>o?UWA.String.format(UWA.i18n("unifiedImport.content.grid.tooltip.maxFileNameLength"),o):void 0:UWA.i18n("unifiedImport.content.grid.tooltip.invalidExtension")}}))),define("DS/UnifiedImport/views/Preview",["UWA/Class/View","UWA/Class/Model","DS/Controls/Button","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/UnifiedImport/views/results/CommonResults"],((e,t,i,n,o,r)=>e.extend({tagName:"div",className:"unifiedimport-preview",setup:function(){let e=this;e.__private__={},e.model=new t,e.setupCommonResults()},setupCommonResults:function(){let e=this;e.options.defaultColumns=!1,e.__private__.commonresults=new r(e.options)},showDialog:function(){let e=this;if(e.__private__.dialog)e.__private__.immersiveFrame.show(),e.__private__.dialog.show(),e.__private__.dialog.maximizedFlag=!0;else{e.__private__.immersiveFrame=new o,e.__private__.immersiveFrame.inject(widget.body),e.__private__.dialog=new n({title:UWA.i18n("unifiedImport.content.preview"),content:e.__private__.commonresults,immersiveFrame:e.__private__.immersiveFrame,usePaddingFlag:!0,resizableFlag:!0,closeButtonFlag:!1,maximizeButtonFlag:!1,maximizedFlag:!0}),UWA.is(widget)&&widget.addEvent("onResize",e.adjust.bind(null,e)),e.adjust(e);let t=e.getCancelButton();if(e.__private__.commonresults.isEditable()){let i=e.getApplyButton();e.__private__.dialog.buttons={Ok:i,Cancel:t},e.__private__.commonresults.options.treeDocument.onNodeModelUpdate((function(){e.__private__.btnApply.disabled=!1,e.options.modelEvents&&e.options.modelEvents.publish({event:"nodeModelUpdate",data:arguments[0]})}))}else e.__private__.dialog.buttons={Cancel:t}}},getApplyButton:function(){let e=this;return e.__private__.btnApply=new i({label:UWA.i18n("unifiedImport.footer.action.ok"),disabled:!0,onClick:e.onApply.bind(null,e)}),e.__private__.btnApply},onApply:function(e){e.__private__.commonresults.options.treeDocument.acceptChanges(),e.__private__.btnApply.disabled=!0;let t=e.toJson();e.model.unset("preview"),e.model.set("preview",t),e.__private__.dialog.hide(),e.__private__.immersiveFrame.hide()},getCancelButton:function(){let e=this;return e.__private__.btnCancel=new i({label:UWA.i18n("unifiedImport.footer.action.close"),onClick:e.onCancel.bind(null,e)}),e.__private__.btnCancel},onCancel:function(e,t){e.__private__.commonresults.options.treeDocument.cancelChanges(),e.__private__.btnApply.disabled=!0,e.model.unset("preview"),e.model.set("preview",void 0),e.__private__.dialog.hide(),e.__private__.immersiveFrame.hide()},toJson:function(e,t={data:{results:[]}}){let i=this,n=!1;e?t.data.results.push(e.getGridOpts()):(n=!0,e=i.__private__.commonresults.options.treeDocument);let o=e.getChildren();return UWA.is(o)&&o.length&&o.forEach((o=>{i.toJson(o,t),!n&&t.data.results.push({from:e.getGridOpts().resourceid,to:o.getGridOpts().resourceid})})),t},adjust:function(e){e.__private__.dialog&&(e.__private__.dialog.width=widget&&widget.body.clientWidth>780?780:.9*widget.body.clientWidth,e.__private__.dialog.height=widget&&widget.body.clientHeight>438?438:.9*widget.body.clientHeight)}}))),define("DS/UnifiedImport/models/FileTreeDocument",["DS/PlatformAPI/PlatformAPI","DS/TreeModel/TreeDocument","DS/UnifiedExchangeAnalytics/Tracker","DS/UnifiedExchangeCommons/Upload","DS/UnifiedImport/models/FileNodeModel","DS/UnifiedImport/utils/Validator","DS/UnifiedImport/utils/Essentials","DS/UnifiedImport/utils/NotificationUtils"],((e,t,i,n,o,r,s,a)=>t.extend({toNodes:function(e,t){e.setupSubscription(),e.__private__={uploads:[],validate:{"max-content-size":0},payload:{title:"",rootFile:"",rootFiles:[],fileIds:[],receipts:[],options:{}}},e.validNodes=[],e.invalidNodes=[],e.totalCheckedInNodes=0,e.protocol=t.protocol,t=t.data&&t.data.items||t;var i=new Set,n=new Set,r=t.length;if(r){var l,d,u,p=performance.now();if(e.prepareUpdate(),e.protocol)return void e._modelEvents.publish({event:s.EVENT_ERROR_OCCURRED,data:{errorType:a.Content.DRIVE_IMPORT_ERROR}});for(let p=0;p<r;p++){if(d=t[p],e.__private__.validate["max-content-size"]+=d.size,e.__private__.validate["max-content-size"]>=s.MAX_CONTENT_SIZE_BYTES)return e._modelEvents.publish({event:s.EVENT_ERROR_OCCURRED,data:{errorType:a.Content.CHECKIN_MAX_FILE_SIZE_REACHED}}),void e.cancel(e);u=d.name,/^.+\.\d{1,}$/.test(u)?(l=s.dualExtension(u),n.add(l.toLowerCase())):(l=s.extension(u),i.add(l.toLowerCase()));var c=o.create(d,n.has(l.toLowerCase()));e.addRoot(c)}e.pushUpdate();var _=performance.now();console.log("Build Tree Document - "+(_-p)),e.defaultMethod(Array.from(i),Array.from(n)),e._modelEvents.publish({event:s.EVENT_CONTENT_SCAN_END})}},setupSubscription:function(){var e=this;e._modelEvents.subscribe({event:s.EVENT_METHOD_SELECTED},e.methodSelected.bind(null,e)),e._modelEvents.subscribe({event:s.EVENT_CONTENT_APPROVED},e.contentApproved.bind(null,e)),e._modelEvents.subscribe({event:s.EVENT_CHECKIN_SUCCEEDED},e.checkinSucceeded.bind(null,e)),e._modelEvents.subscribe({event:s.EVENT_CHECKIN_FAILED},e.checkinFailed.bind(null,e)),e._modelEvents.subscribe({event:s.EVENT_CHECKIN_TIMEOUT},e.checkinFailed.bind(null,e))},getMethod:function(e,t){return e.length?e:t.length?t:void 0},defaultMethod:function(e,t){var i=this,n=s.METHODS_PREDICTABLE.filter((e=>{let i=e.import.validate;return t.some((e=>{if(i&&i.withdualextension)return i.methodIdentifier.some((t=>t&&t.primary&&t.primary.toLowerCase()===e.toLowerCase().split(".")[0]))}))})),o=s.METHODS_PREDICTABLE.filter((t=>{let i=t.import.validate;return e.some((e=>{if(i&&!i.withdualextension)return i.methodIdentifier.some((t=>t.primary&&t.primary.toLowerCase()===e.toLowerCase()))}))}));n.length&&(o=[...n,...o]),(o=i.getMethod(o,s.METHODS_UNPREDICTABLE))?(i._modelEvents.publish({event:s.EVENT_NEW_IMPORT}),"array"==UWA.typeOf(o)?i._modelEvents.publish({event:s.EVENT_METHODS_FOUND,data:o}):i._modelEvents.publish({event:s.EVENT_METHOD_FOUND,data:o})):(i.cancel(i),i._modelEvents.publish({event:s.EVENT_NO_METHOD_FOUND}))},methodSelected:function(e,t){e.__private__.method=t,e.switchBaseUrl(t),require([["DS",t.import["import-ui"]["module-directory"],t.import["import-ui"]["module-name"]].join("")],(t=>{e.validate=t.validate?t.validate:null,e.upload=t.upload?t.upload:null,e.fields=t.fields?t.fields:void 0,e.transform=t.transform?t.transform:null,e.parse=t.parse?t.parse:null,e.validateByImporter()}),(t=>{e._modelEvents.publish({event:s.EVENT_LOAD_METHOD_FAILED})}))},isExtensionSelected:function(e,t){return!0===t[e]},matchingFileAny:function(e){let t,i=this,n=i.validate,o=new r(n);const s=e.node.getNameNoExt();let a=e.nodes.find((t=>{let i=o.validateConfig(t);if(i){const e=i||UWA.i18n("unifiedImport.content.grid.tooltip.groupByGeneralErrorMessage");node.setAsValidated(),node.setTooltipValue(e)}else{const i=t.getExtension(),n=t.getNameNoExt();if(e.method.secondary.includes(i)&&n==s)return t}}));return a&&(a.setAsValidated(),i.validNodes.push(e.node,a),t=e.maxNbOfPriors?e.maxNbOfPriors-1:0),e.node.setAsValidated(),t},matchingFileAll:function(e){let t,i=this,n=i.validate,o=new r(n),s=e.method.secondary.reduce(((e,t)=>(e[t]=!1,e)),{});const a=e.node.getNameNoExt();let l=e.nodes.filter((t=>{let i=o.validateConfig(t);if(i){const e=i||UWA.i18n("unifiedImport.content.grid.tooltip.groupByGeneralErrorMessage");node.setAsValidated(),node.setTooltipValue(e)}else{const i=t.getExtension(),n=t.getNameNoExt();if(e.method.secondary.includes(i)&&!1===s[i]&&n==a)return s[i]=!0,t}}));return e.method.secondary.every((e=>i.isExtensionSelected(e,s)))&&(l.forEach((e=>{e.setAsValidated()})),t=e.maxNbOfPriors?e.maxNbOfPriors-1:0,i.validNodes.push(e.node,...l)),e.node.setAsValidated(),t},WithoutMatchingFileFlag:function(e,t,i){let n=this,o=n.validate,s=new r(o),a="*"===i[0];t.forEach((t=>{let o=s.validateConfig(t);if(o){const e=o||UWA.i18n("unifiedImport.content.grid.tooltip.excluded");t.setAsValidated(),t.setTooltipValue(e)}else{const o=t.getExtension();(a||i.includes(o))&&o!==e&&(n.validNodes.push(t),t.setAsValidated())}}))},validateNodeWithoutMaxPrior:function(e,t){let i=this,n=i.validate,o=new r(n),s=n&&n.extensions,a=s&&"*"===s[0],l=UWA.i18n("unifiedImport.content.grid.tooltip.excluded"),d=i.isSelectedMethodHasDualExtension();e.forEach((e=>{const n=e.isInPrimaryExtension(t,d),r=o.validateConfig(e,n),u=r||l;if(d)!n||r?(e.setAsValidated(),e.setTooltipValue(u)):(i.validNodes.push(e),e.setAsValidated());else if(r)e.setAsValidated(),e.setTooltipValue(u);else{(a||s.includes(e.getExtension())||n)&&(i.validNodes.push(e),e.setAsValidated())}}))},isSelectedMethodHasDualExtension:function(){return this.__private__.method.import.validate&&this.__private__.method.import.validate.withdualextension},validateByImporter:function(){let e=this,t=e.validate;var i=new r(t);const n=t&&t.extensions;let o=e.__private__.method.import.validate&&e.__private__.method.import.validate.methodIdentifier;var l=e.__private__.method.import.validate&&e.__private__.method.import.validate["max-nb-of-priors"];let d=e.getRoots();var u=i.validateByMaxNbOfFiles(d);if(u)e._modelEvents.publish({event:s.EVENT_ERROR_OCCURRED,data:{errorType:a.Content.CHECKIN_MAX_NO_OF_FILES_REACHED,payLoad:{message:[u]}}});else{if(n||o){var p=performance.now();if(e.prepareUpdate(),o){const t=o.reduce(((e,t)=>(e.push(t.primary),e)),[]);if(void 0===l)e.validateNodeWithoutMaxPrior(d,t);else for(const i of d){const r=i.getExtension();if(l&&!i.isIterated()&&t.includes(r)){let s=o[t.indexOf(r)];if("any"===s["matching-file"])l=e.matchingFileAny({method:s,node:i,nodes:d,maxNbOfPriors:l});else if("all"===s["matching-file"])l=e.matchingFileAll({method:s,node:i,nodes:d,maxNbOfPriors:l});else if(!UWA.is(s["matching-file"])){const t=n&&n.length;s.primary==r&&(e.validNodes.push(i),this.__private__.priorNode=this.__private__.priorNode||i,i.setAsValidated(),0==(l=l?l-1:0)&&t&&e.WithoutMatchingFileFlag(r,d,n))}}}}else d.forEach((t=>{let n=i.validateConfig(t);if(n){const e=n||UWA.i18n("unifiedImport.content.grid.tooltip.excluded");t.setAsValidated(),t.setTooltipValue(e),t.updateOptions({status:UWA.i18n("unifiedImport.content.grid.tooltip.excluded"),statusValue:0})}else e.validNodes.push(t)}));e.invalidNodes.push(...d.filter(((t,i)=>{if(!e.validNodes.includes(t))return t.tooltipValue||t.setTooltipValue(UWA.i18n("unifiedImport.content.grid.tooltip.WithoutGroupByErrorMessage")),t.setAsValidated(),t.updateOptions({grid:{status:UWA.i18n("unifiedImport.content.grid.tooltip.excluded"),statusValue:0}}),t}))),e.pushUpdate(),e.validNodes.forEach((t=>{e.__private__.payload.rootFiles.push(t.getName())})),e.__private__.payload.rootFile=e.__private__.priorNode&&e.__private__.priorNode.getName();var c=e.__private__.priorNode&&e.__private__.priorNode.getName()||e.validNodes.length&&e.validNodes[0].getName();c=c?c.slice(0,c.lastIndexOf(".")):"",e.validNodes.length>1&&(c=c+" "+UWA.i18n("unifiedImport.footer.action.importTitle1")+" "+(e.validNodes.length-1)+" "+UWA.i18n("unifiedImport.footer.action.importTitle2")),e.__private__.payload.title=c;var _=performance.now()}else e.validNodes=d;e._modelEvents.publish({event:s.EVENT_CONTENT_ANALYZED,data:{validNodes:e.validNodes,invalidNodes:e.invalidNodes}});var m=e.validNodes.length,E=e.invalidNodes.length;m&&E||m?e._modelEvents.publish({event:s.EVENT_CONTENT_APPROVED}):E&&e._modelEvents.publish({event:s.EVENT_CONTENT_DISAPPROVED,data:e.invalidNodes});_=performance.now();console.log("ValidateByImporter - "+(_-p))}},contentApproved:function(e){e.prepareUpdate(),e.validNodes.forEach((e=>{e.updateOptions({grid:{status:"0%"}})})),e.pushUpdate();var t=e.validNodes.length,i=[],o=e.upload.checkinticket;"string"==UWA.typeOf(e.upload.checkinticket)&&(o=[s.PLATFORM_SERVICES[e.__private__.method.service],o,"?maxNumberOfFiles=1"].join(""));for(let o=0;o<t;o++){var r=e.validNodes[o];let t=new n({file:r.getFile(),checkinticket:e.getCheckinTicket(r),success:e.postcheckin.bind(null,e,[r]),progress:e.checkinProgress.bind(null,e,r)});e.__private__.uploads.push(t),i.push(t.upload())}UWA.Promise.all(i).then((function(){e._modelEvents.publish({event:s.EVENT_CONTENT_UPLOADED})})).fail((function(t){switch(!0){case t.message.includes("timedout"):e._modelEvents.publish({event:s.EVENT_ERROR_OCCURRED,data:{errorType:a.Content.CHECKIN_TIMEOUT}}),e.checkinFailed(e);break;case t.message.includes("NetworkError"):e._modelEvents.publish({event:s.EVENT_ERROR_OCCURRED,data:{errorType:a.Content.CHECKIN_NETWORK_ERROR}}),e.checkinFailed(e);break;case t.hasOwnProperty("id"):e._modelEvents.publish({event:s.EVENT_ERROR_OCCURRED,data:{errorType:a.Content.CHECKIN_FAILED_AT_IMPORTER,payLoad:{message:[t.message]}}}),e.checkinFailed(e);break;default:e._modelEvents.publish({event:s.EVENT_CHECKIN_FAILED})}})).finally((()=>{e.__private__.uploads=[]}))},getCheckinTicket:function(e){var t=this.upload.checkinticket;return"string"==UWA.typeOf(t)?t=[s.PLATFORM_SERVICES[this.__private__.method.service],t,"?maxNumberOfFiles=1"].join(""):"function"==UWA.typeOf(t)&&(t=t({platformServices:s.PLATFORM_SERVICES,securityContext:s.SECURITY_CONTEXT,fileNode:e})),t},checkinProgress:function(e,t,i){if(i.lengthComputable){let n=Math.ceil(100*i.loaded/i.total);e._modelEvents.publish({event:s.EVENT_CHECKIN_PROGRESS,data:{currentNodeUploadProgress:n,totalNodes:e.validNodes.length,totalCheckedInNodes:e.totalCheckedInNodes}}),t.updateOptions({grid:{status:`${n} %`}})}},postcheckin:function(e,t,i){e.__private__.payload.receipts.push(i.checkInAnswer.trim()),e.__private__.payload.fileIds.push(i.checkinFileId),e.totalCheckedInNodes+=1,e._modelEvents.publish({event:s.EVENT_CHECKIN_SUCCEEDED,data:{checkedInNodes:t,totalNodes:e.validNodes.length,totalCheckedInNodes:e.totalCheckedInNodes}})},checkinSucceeded:function(e,t){var i=t.checkedInNodes;e.prepareUpdate(),i.forEach((e=>{e.setTooltipValue(UWA.i18n("unifiedImport.content.grid.tooltip.uploaded")),e.updateOptions({grid:{status:UWA.i18n("unifiedImport.content.grid.tooltip.uploaded"),statusValue:1}})})),e.pushUpdate()},checkinFailed:function(e){e.empty()},switchBaseUrl:function(e){let t=this;try{let i=s.PLATFORM_SERVICES[t.__private__.method.service];const n=e.import["import-ui"]["module-deployment-directory"],o=e.import["import-ui"]["module-directory"];if(i){const e={[`DS${o}`]:`${`${i}${n}`}${o}`};require.config({paths:e})}}catch(e){console.log(e)}},setPreview:function(e={data:{results:[]}}){this.__private__.preview=e},save:function(e){e.__private__.importStartTime=(new Date).getTime(),e.attachPreview().then(e.import.bind(null,e))},attachPreview:function(){let e=this;if(UWA.is(e.__private__.preview)){e._modelEvents.publish({event:s.EVENT_ATTACH_PREVIEW_START}),e.__private__.payload.preview=e.__private__.preview;let t=new Blob([JSON.stringify(e.__private__.preview)],{type:"application/json"}),i=new n({content:{blob:t,extension:"json"},checkinticket:e.getCheckinTicket(),success:e.postAttachPreview.bind(null,e),progress:e.attachPreviewProgress.bind(null,e)});return e.__private__.uploads.push(i),i.upload()}return new UWA.Promise((e=>{e()}))},attachPreviewProgress:function(e,t){if(t.lengthComputable){let i=t.loaded/t.total*100;e._modelEvents.publish({event:s.EVENT_ATTACH_PREVIEW_PROGRESS,data:{progress:i}})}},postAttachPreview:function(e,t){e.__private__.payload.preview={fileNames:[t.fileName]},e.__private__.payload.receipts.push(t.checkInAnswer.trim()),e.__private__.payload.fileIds.push(t.checkinFileId)},import:function(e){e._modelEvents.publish({event:s.EVENT_ATTACH_PREVIEW_END}),e._modelEvents.publish({event:s.EVENT_START_EXCHANGE});let t=s.PLATFORM_SERVICES[e.__private__.method.service]+e.__private__.method.import.importurl,i=e.getpayload(),n={SecurityContext:e.__private__.payload.options.securityContext},o={url:t,data:JSON.stringify(i),method:"POST",headers:n,onComplete:e.exchangerequestsucceeded.bind(null,e),onFailure:e.exchangerequestfailed.bind(null,e)};s.server(o)},prepareSecurityContext:function(){let e=this;UWA.is(e.__private__.payload.options.role)&&UWA.is(e.__private__.payload.options.organization)&&UWA.is(e.__private__.payload.options.collaborativespace)&&(e.__private__.payload.options.securityContext=[e.__private__.payload.options.role,e.__private__.payload.options.organization,e.__private__.payload.options.collaborativespace].join("."))},getpayload:function(){let e=this;if(e.prepareSecurityContext(),e.transform)try{return e.transform.call(e.__private__.payload,{platformServices:s.PLATFORM_SERVICES,securityContext:s.SECURITY_CONTEXT})}catch(e){console.log("Issue is payload generation")}return e.__private__.payload},exchangerequestsucceeded:function(t,i){(i=JSON.parse(i)).platform=s.x3dPlatformId,t.track(),t._modelEvents.publish({event:s.EVENT_EXCHANGE_REQUEST_SUCCEEDED,data:{payLoad:{message:[t.__private__.payload.title]}}}),e.publish("ds-unified-exchange-topic-job-created",i)},exchangerequestfailed:function(e){e._modelEvents.publish({event:s.EVENT_EXCHANGE_REQUEST_FAILED,data:{payLoad:{message:[e.__private__.payload.title]}}})},track:function(){var e=this;i.setAppId("ENXUIMP_AP"),i.setTenant(s.x3dPlatformId),i.setSelectionSize(e.validNodes&&e.validNodes.length),i.setUrl(i.VIEW.URL.VALUES.IMPORT),i.setTitle(i.VIEW.TITLE.VALUES.IMPORT),i.setLanguage(s.SERVER.DEFAULT_HEADERS["Accept-Language"]);var t=0;e.validNodes.forEach((e=>{t+=e.getSize()})),i.setContentSize(t),i.setTime(((new Date).getTime()-e.__private__.importStartTime||0)/1e3),i.setOperation(i.EVENT.CATEGORY.VALUES.IMPORT),i.setService(e.__private__.method.service);var n=e.__private__.method.value;e.__private__.priorNode&&(n=e.__private__.priorNode.getExtension()&&e.__private__.priorNode.getExtension().toUpperCase()||e.__private__.method.value),i.setFormat(n),i.sendEvent()},cancelUploads:function(){this.__private__.uploads.forEach((e=>{e.cancel()}))},cancel:function(e){e.prepareUpdate(),e.removeRoots(),e.pushUpdate(),e.cancelUploads(),e._modelEvents.publish({event:s.EVENT_EXCHANGE_CANCEL}),i.clear()}}))),define("DS/UnifiedImport/views/StatusBar",["UWA/Class/View","DS/Tweakers/GeneratedToolbar","DS/UnifiedImport/utils/Essentials"],((e,t,i)=>e.extend({className:"unifiedimport-statusbar",setup:function(e){var t=this;t.treeDocument=e.treeDocument,t.setupStatusBar(),t.setupEvents()},setupStatusBar:function(){var e=this,i=t.prototype.createTreeDocument({entries:[{id:"uploadedNodes",dataElements:{typeRepresentation:"string",readOnly:!0,visibleFlag:!1,icon:{iconName:"status-ok",iconStyle:1},emphasize:"success",position:"far"}},{id:"excludedNodes",dataElements:{typeRepresentation:"string",readOnly:!0,visibleFlag:!1,emphasize:"error",icon:{iconName:"block",iconStyle:1},position:"far"}}]});e.generatedToolbar=new t({overflowManagement:"dropdown",direction:"horizontal",items:i}),e.generatedToolbar.getContent().style.fontWeight="bold",e.generatedToolbar.inject(e.container)},setupEvents:function(){var e=this;e.treeDocument._modelEvents.subscribe({event:i.EVENT_CONTENT_ANALYZED},e.updateStatus.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_CHECKIN_SUCCEEDED},e.updateProgressAndCheckInNodes.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_CHECKIN_FAILED},e.hideToolbar.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_CHECKIN_TIMEOUT},e.hideToolbar.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_ERROR_OCCURRED},e.hideToolbar.bind(null,e))},updateStatus:function(e,t){e.show();var i=t.invalidNodes.length;i&&e.generatedToolbar.updateNodeModel("excludedNodes",{visibleFlag:!0,grid:{visibleFlag:!0,data:`${i} ${UWA.i18n("unifiedImport.content.grid.tooltip.excluded")}`}})},updateProgressAndCheckInNodes:function(e,t){e.generatedToolbar.updateNodeModel("uploadedNodes",{visibleFlag:!0,grid:{data:`${t.totalCheckedInNodes} ${UWA.i18n("unifiedImport.content.grid.tooltip.uploaded")}`},icon:"status-ok",emphasize:"success"})},hideToolbar:function(e){e.generatedToolbar.hide()}}))),define("DS/UnifiedImport/views/Footer",["UWA/Class/View","DS/Controls/Toolbar","DS/Controls/Label","DS/Controls/Button","DS/UnifiedImport/views/Preview","DS/UnifiedImport/utils/Essentials"],((e,t,i,n,o,r)=>e.extend({tagName:"div",className:"unifiedimport-footer",setup:function(e){let i=this;i.__private__={},i.treeDocument=e.treeDocument,i.__private__.toolbar=new t({}),i.__private__.toolbar.inject(i.container),i.setupLeftBarActions(),i.setupRightBarActions(),i.setupEvents()},setupLeftBarActions:function(){let e=this;e.__private__.lblStatus=new i({emphasize:"info"}),e.__private__.lblStatus.getContent().style.background="transparent",e.__private__.lblStatus.getContent().style.color="#368EC4",e.__private__.toolbar.add("element",{element:e.__private__.lblStatus.getContent(),position:"near"})},setupRightBarActions:function(){let e=this;e.__private__.btnPreview=new n({touchMode:!1,label:UWA.i18n("unifiedImport.footer.action.preview")}),e.__private__.btnPreview.hide(),e.__private__.btnCancel=new n({touchMode:!1,label:UWA.i18n("unifiedImport.footer.action.cancel")}),e.__private__.btnImport=new n({touchMode:!1,label:UWA.i18n("unifiedImport.footer.action.import"),emphasize:"primary",disabled:!0}),e.__private__.toolbar.add("element",{element:e.__private__.btnImport.getContent(),position:"far"}),e.__private__.toolbar.add("element",{element:e.__private__.btnPreview.getContent(),position:"far"}),e.__private__.toolbar.add("element",{element:e.__private__.btnCancel.getContent(),position:"far"})},setupEvents:function(){let e=this;e.__private__.btnImport.addEventListener("buttonclick",e.startImport.bind(null,e)),e.__private__.btnCancel.addEventListener("buttonclick",e.treeDocument.cancel.bind(null,e.treeDocument)),e.treeDocument._modelEvents.subscribe({event:r.EVENT_LOAD_METHOD_FAILED},e.invalidMethod.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:r.EVENT_NEW_IMPORT},e.toggleFooter.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:r.EVENT_CONTENT_APPROVED},e.contentApproved.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:r.EVENT_CONTENT_DISAPPROVED},e.contentDisapproved.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:r.EVENT_CONTENT_UPLOADED},e.contentUploaded.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:r.EVENT_FIELDS_VALIDATED},e.fieldsValidated.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:r.EVENT_ATTACH_PREVIEW_END},e.postAttachPreview.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:r.EVENT_EXCHANGE_REQUEST_SUCCEEDED},e.exchangeRequestSucceeded.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:r.EVENT_EXCHANGE_REQUEST_FAILED},e.exchangeRequestFailed.bind(null,e))},toggleFooter:function(e){e.getContent().toggle()},toggleImport:function(e){e.__private__.btnImport.disabled=!(e.__private__.contentUploaded&&e.__private__.contentPreviewed&&e.__private__.fieldsValidated)},startImport:function(e){e.toggleImport(e),e.__private__.btnPreview.disabled=!0,e.__private__.btnCancel.disabled=!0,e.__private__.lblStatus.value=UWA.i18n("unifiedImport.footer.action.attaching"),e.treeDocument.save(e.treeDocument)},invalidMethod:function(e){e.__private__.btnImport.disabled=!0},contentApproved:function(e){e.__private__.lblStatus.value=UWA.i18n("unifiedImport.content.grid.tooltip.uploading")},contentDisapproved:function(e){e.__private__.btnImport.disabled=!0},contentUploaded:function(e){e.__private__.contentUploaded=!0,e.__private__.lblStatus.value="",e.toggleImport(e),r.hasParam("importPreview")&&UWA.is(e.options.treeDocument.parse)?e.previewAllowed():(e.__private__.contentPreviewed=!0,e.toggleImport(e))},fieldsValidated:function(e,t){e.__private__.fieldsValidated=t.data.validated,e.toggleImport(e)},exchangeRequestSucceeded:function(e){e.__private__.lblStatus.value="",e.__private__.btnImport.hide(),e.__private__.btnPreview.hide(),e.__private__.btnCancel.disabled=!1,e.__private__.btnCancel.label=UWA.i18n("unifiedImport.footer.action.done"),e.__private__.btnCancel.show()},exchangeRequestFailed:function(e){e.__private__.lblStatus.value="",e.__private__.btnImport.hide(),e.__private__.btnPreview.hide(),e.__private__.btnCancel.disabled=!1,e.__private__.btnCancel.show()},previewAllowed:function(){let e=this;e.__private__.btnPreview&&(e.__private__.lblStatus.value=UWA.i18n("unifiedImport.footer.action.preview.wait"),e.__private__.btnPreview.disabled=!0,e.__private__.btnPreview.show(),e.options.treeDocument.parse(e.getParseOpts()).then(e.postParse.bind(null,e)).fail(e.postParseFailure.bind(null,e)))},getParseOpts:function(){let e=this;return{files:e.options.treeDocument.validNodes.map((function(e){return e.getFile()})),fileIds:e.options.treeDocument.__private__.payload.fileIds,receipts:e.options.treeDocument.__private__.payload.receipts,rootFile:e.options.treeDocument.__private__.payload.rootFile,rootFiles:e.options.treeDocument.__private__.payload.rootFiles}},postParse:function(e,t){t.defaultColumns=!1,e.__private__.btnPreview.addEventListener("buttonclick",e.showPreview.bind(null,e,t)),e.__private__.btnPreview.displayStyle="primary",e.__private__.btnPreview.label=UWA.i18n("unifiedImport.footer.action.preview"),e.__private__.lblStatus.value="",e.__private__.btnPreview.disabled=!1,e.__private__.contentPreviewed=!0,e.toggleImport(e)},postParseFailure:function(e){e.__private__.lblStatus.value=UWA.i18n("unifiedImport.footer.action.preview.unavailable"),e.__private__.btnPreview.disabled=!0,e.__private__.btnPreview.visibleFlag=!1,e.__private__.contentPreviewed=!1,e.toggleImport(e)},showPreview:function(e,t){e.__private__.preview||(e.__private__.preview=new o(t),e.__private__.preview.listenTo(e.__private__.preview.model,"onChange:preview",(function(t){e.treeDocument.setPreview(t.get("preview"))}))),e.__private__.preview.showDialog()},postAttachPreview:function(e){e.__private__.lblStatus.value=UWA.i18n("unifiedImport.footer.action.importing")}}))),define("DS/UnifiedImport/views/Content",["UWA/Class/View","DS/Controls/Expander","DS/Controls/Loader","DS/UnifiedImport/views/PotentialMethods","DS/UnifiedImport/views/DragZone","DS/UnifiedImport/views/FilesView","DS/UnifiedImport/views/ImportOptions","DS/UnifiedImport/views/StatusBar","DS/UnifiedImport/utils/Essentials"],((e,t,i,n,o,r,s,a,l)=>{var d;return e.extend({__private__:{}},{className:"unifiedimport-content",setup:function(e){var t=this;t.treeDocument=e.treeDocument,t.setupImporters(),t.setupZone(),t.setupFiles(),t.setupEvents()},setupImporters:function(){var e=this,t=new n({treeDocument:e.treeDocument});e.__private__.optionView=new s({treeDocument:e.treeDocument}),t.inject(e.container),e.__private__.optionView.inject(e.container),e.__private__.optionView.hide()},setupZone:function(){(d=new o({treeDocument:this.treeDocument})).inject(this.container)},setupFiles:function(){},setupEvents:function(){let e=this;e.treeDocument._modelEvents.subscribe({event:l.EVENT_CHECKIN_SUCCEEDED},e.applySortOnProcessEnd.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:l.EVENT_NEW_IMPORT},(function(){d.hide(),e.__private__.optionView.show(),e.__private__.myExpander=new t({header:UWA.i18n("unifiedImport.content.accordion.title"),stretchableContentFlag:!0,customHeader:new a({treeDocument:e.treeDocument}),expandedFlag:!0,customHeaderPosition:"near"}).inject(e.container),e.__private__.loaderContainer=UWA.createElement("div",{class:"unifiedimport-loader-viewer"}).inject(e.container),e.__private__.wuxLoader=(new i).inject(e.__private__.loaderContainer),e.__private__.wuxLoader.on(UWA.i18n("unifiedImport.content.grid.loader.analyzingFiles")),e.__private__.myExpander.header=`${UWA.i18n("unifiedImport.content.accordion.title")} (${e.treeDocument.getRoots().length})`;var n=r.datagrid();n.onReady((function(){e.__private__.loaderContainer.hide()})),e.__private__.gridContainer=UWA.createElement("div").inject(e.container),n.treeDocument=e.treeDocument,n.maxVisibleRowCount=e.treeDocument.getRoots().length,e.__private__.myExpander.body=n.getContent()}))},applySortOnProcessEnd:function(){r.dgv.reapplySortModel()}})})),define("DS/UnifiedImport/views/Header",["UWA/Class/View","DS/Controls/ProgressBar","DS/UnifiedImport/utils/Essentials"],((e,t,i)=>e.extend({tagName:"div",className:"unifiedimport-header",setup:function(e){let t=this;t.treeDocument=e.treeDocument,t.setupProgress(),t.setupEvents()},setupProgress:function(){let e=this;e.progressbar=new t({displayStyle:"lite"}),e.progressbar.inject(e.container)},setupEvents:function(){let e=this;e.treeDocument._modelEvents.subscribe({event:i.EVENT_CONTENT_APPROVED},e.contentApproved.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_CHECKIN_PROGRESS},e.checkinProgress.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_CHECKIN_SUCCEEDED},e.checkinSucceeded.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_CHECKIN_FAILED},e.hideView.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_CONTENT_UPLOADED},e.contentUploaded.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_ERROR_OCCURRED},e.hideView.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_ATTACH_PREVIEW_START},e.attachPreviewStart.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_ATTACH_PREVIEW_PROGRESS},e.attachPreviewProgress.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_ATTACH_PREVIEW_END},e.attachPreviewEnd.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_START_EXCHANGE},e.startExchange.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_EXCHANGE_REQUEST_SUCCEEDED},e.hideView.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_EXCHANGE_REQUEST_FAILED},e.hideView.bind(null,e))},contentApproved:function(e){e.show()},checkinProgress:function(e,t){let i=100*(t.totalCheckedInNodes+t.currentNodeUploadProgress/100/t.totalNodes);e.progressbar.value=i},checkinSucceeded:function(e,t){let i=t.totalCheckedInNodes/t.totalNodes*100;e.progressbar.value=i},contentUploaded:function(e){e.progressbar.value=100,e.hide()},attachPreviewStart:function(e){e.progressbar.infiniteFlag=!1,e.progressbar.value=0,e.progressbar.visibleFlag=!0},attachPreviewProgress:function(e,t){e.progressbar.infiniteFlag=!1,e.progressbar.value=t.progress,e.progressbar.visibleFlag=!0},attachPreviewEnd:function(e){e.progressbar.visibleFlag=!1},startExchange:function(e,t){e.progressbar.infiniteFlag=!0,e.progressbar.visibleFlag=!0},hideView:function(e){e.hide()}}))),define("DS/UnifiedImport/views/UnifiedImportProcess",["UWA/Class/View","DS/UnifiedImport/views/Header","DS/UnifiedImport/views/Content","DS/UnifiedImport/views/Footer","DS/UnifiedImport/utils/Essentials","DS/UnifiedImport/utils/NotificationUtils"],((e,t,i,n,o,r)=>e.extend({tagName:"div",className:"unifiedimport-process",setup:function(e){var t=this;t.treeDocument=e.treeDocument,t.setupContent(),t.setupHeader(),t.setupFooter(),t.setupEvents()},setupHeader:function(){var e=this;e.header=new t({treeDocument:e.treeDocument}),e.header.inject(e.container)},setupContent:function(){var e=this;e.content=new i({treeDocument:e.treeDocument}),e.content.inject(e.container)},setupFooter:function(){var e=this;e.footer=new n({treeDocument:e.treeDocument}),e.footer.inject(e.container)},setupEvents:function(){var e=this;e.treeDocument._modelEvents.subscribe({event:o.EVENT_NO_METHOD_FOUND},(function(e){r.alert({...r.Content.NO_METHOD},e)})),e.treeDocument._modelEvents.subscribe({event:o.EVENT_LOAD_METHOD_FAILED},(function(e){r.alert({...r.Content.INVALID_METHOD},e)})),e.treeDocument._modelEvents.subscribe({event:o.EVENT_CONTENT_DISAPPROVED},(function(e){r.alert({...r.Content.CONTENT_DISAPPROVED},e)})),e.treeDocument._modelEvents.subscribe({event:o.EVENT_EXCHANGE_REQUEST_SUCCEEDED},(function(e){var t={...r.Content.PROCESS_SUCCEEDED};r.alert(t,e)})),e.treeDocument._modelEvents.subscribe({event:o.EVENT_EXCHANGE_REQUEST_FAILED},(function(e){r.alert({...r.Content.PROCESS_FAILED},e)})),e.treeDocument._modelEvents.subscribe({event:o.EVENT_CHECKIN_FAILED},(function(e){r.alert({...r.Content.CHECKIN_FAILED},e)})),e.treeDocument._modelEvents.subscribe({event:o.EVENT_ERROR_OCCURRED},(function(e){r.alert({...e.errorType},e)})),e.treeDocument._modelEvents.subscribe({event:o.EVENT_CONTENT_UPLOADED},(function(e){r.alert({...r.Content.CONTENT_UPLOADED},e)}))}}))),define("DS/UnifiedImport/UnifiedImport",["DS/UnifiedImport/models/FileTreeDocument","DS/UnifiedImport/views/UnifiedImportProcess","DS/UnifiedImport/views/Hider","DS/Windows/ImmersiveFrame","DS/UnifiedImport/models/SecurityContexts","DS/UnifiedImport/utils/Essentials","DS/WebUAUtils/WebUAUtils","css!DS/UIKIT/UIKIT.css","css!DS/UnifiedImport/UnifiedImport"],((e,t,i,n,o,r,s)=>{var a={noAccess:function(e){widget.body.empty(),UWA.createElement("p",{class:"unifiedimport-noaccess-error-container",text:e}).inject(widget.body)},gotoHome:function(){widget.body.empty();var o=new UWA.Element("div",{class:"unifiedimport-global-container"});o.setAttribute("style","margin-left: 0px !important; margin-bottom: 0px !important;"),o.inject(widget.body);var l=new n({});l.inject(o),s.setPanelHelpMode({immersiveFrame:l});var d=new UWA.Element("div",{class:"unifiedimport-primary-container"});d.setAttribute("style","height: 100vh !important; width: 100% !important;"),d.inject(l.getFreeZone());var u=new e;(new i).inject(d),new t({treeDocument:u}).inject(d),u._modelEvents.subscribe({event:r.EVENT_CONTENT_SELECTED},u.toNodes.bind(null,u)),u._modelEvents.subscribe({event:r.EVENT_EXCHANGE_CANCEL},a.gotoHome)},postSetup:function(){var e=o.getHighestRole();r.SECURITY_CONTEXT=o.getDefaultSecurityContext(),UWA.is(e)&&r.SECURITY_CONTEXT?(widget.addEvent("onRefresh",r.noop),a.gotoHome()):a.noAccess(UWA.i18n("unifiedImport.widget.notHaveAccess"))},onLoad:function(){return widget.setTitle(""),new UWA.Promise(((e,t)=>{r.setup().then((()=>{a.postSetup(),e("view Initialized")})).fail((e=>{a.noAccess(e)})).catch((e=>{t(e)}))}))}};return a}));