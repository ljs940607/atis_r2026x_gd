define("DS/IPClassifyUtil/PlatformAPIWrapper",["DS/Utilities/UUID"],(e=>{let t=null;async function n(){return t=t||new Promise((e=>{require(["DS/PlatformAPI/PlatformAPI"],e)})),t}function i(){return"/"+(widget?widget.getValue("x3dSharedId")||widget.getValue("x3dAppId")||widget.getValue("appId")+"_"+widget.id:"no_private_channel")}return{getMetadataAppId:i,publish:async function(){let t=await n(),r=arguments[1];r&&!0===r.metadata&&(arguments[1]=function(t){return{metadata:{uid:e.v4(),timestamp:Date.now(),appid:i(),xappid:widget&&widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):"default-app-id",originWidgetId:widget?widget.id:"default-widget-id"},data:t}}(r)),t.publish.apply(this,arguments)},subscribe:async function(e,t){(await n()).subscribe(e,((e,n)=>{e&&e.metadata&&e.data&&(n=e.metadata,e=e.data),t(e,n)}))}}})),define("DS/IPClassifyUtil/IPClassifyModelEvents",["DS/CoreEvents/ModelEvents"],(function(e){"use strict";var t=new e;return{getModelEvents:function(){return t},publish:function(e){return t.publish(e)},subscribe:function(e,n){return t.subscribe(e,n)},subscribeOnce:t.subscribeOnce,unsubscribe:function(e){return t.unsubscribe(e)},unsubscribeAll:function(e){return t.unsubscribeAll(e)},reset:function(){t.destroy(),t=new e}}})),define("DS/IPClassifyUtil/IPContext",["UWA/Class","UWA/Class/Options"],(function(e,t){"use strict";return e.singleton(t,{name:"IPContext",init:function(){this._context=null},set:function(e){null===this._context&&(this._context=e,this._context.toString=function(){return widget.getValue("x3dAppId")})},get:function(){return this._context?this._context:null},reset:function(){this._context=null}})})),define("DS/IPClassifyUtil/IPClassifyAlert",["UWA/Class","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],(function(e,t,n){function i(e,t){let n="";return e&&"string"==typeof e?e.split("<br>").forEach(((e,t)=>{0!=t&&(n+="<br>"),n+=e.escapeHTML()})):t&&"object"==typeof e&&(n=e),n}var r=e.singleton({_notif_manager:null,_debounceTimeout:{},init:function(){},_displayNotification:function(e){null===this._notif_manager&&(this._notif_manager=t,n.setNotificationManager(this._notif_manager),n.setStackingPolicy(5));var r="info";UWA.is(e.className)&&"primary"!==e.className&&(r=e.className);let s=i(e.message,e.allowUnsafeHTML),a=i(e.title,e.allowUnsafeHTML),o=i(e.subtitle,e.allowUnsafeHTML);e.messageHtml&&(s=s?s+"<br>":s,s=UWA.createElement("div",{html:s}),e.messageHtml.inject(s)),this._notif_manager.addNotif({allowUnsafeHTML:!0,level:r,title:a,subtitle:o,message:s,sticky:!!e.sticky&&e.sticky,poNotifId:e.poNotifId})},displayNotification:function(e,t=500){var n=this;if(!0===e.debounce){if(e.id&&this._debounceTimeout[e.id]?clearTimeout(this._debounceTimeout[e.id]):n._displayNotification(e),e.id){var i=setTimeout((function(){delete n._debounceTimeout[e.id]}),t);this._debounceTimeout[e.id]=i}}else n._displayNotification(e)}});return{displayNotification:r.displayNotification.bind(r)}})),define("DS/IPClassifyUtil/ZipUtils",["DS/ZipJS/zip"],(function(e){return{unzip:function(t){return new Promise((function(n){var i=new e.BlobReader(t);e.createReader(i,(function(t){var i=t;i.getEntries((function(t){var r=t.find((function(e){return e}));r&&r.getData(new e.TextWriter,(function(e){try{i.close((function(){n(JSON.parse(e.target.result))}))}catch(e){i.close((function(){n(null)}))}}))}))}),(function(e){console.log("zip error"),console.log(e),n(null)}))}))}}})),define("DS/IPClassifyUtil/IPClassifyUtility",["UWA/Utils","UWA/Core","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/WidgetServices/WidgetServices","DS/PADUtils/PADUtilsServices","DS/Usage/TrackerAPI","DS/PlatformAPI/PlatformAPI","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/ZipJS/deflate","DS/ZipJS/inflate"],(function(e,t,n,i,r,s,a,o){var l=null,c=null,u=null,d=null;function f(e){let t=e.prototype?e.prototype:e,n=Object.getOwnPropertyNames(t),i=Object.getPrototypeOf(t),r=null;return r=i?f(i):{},n.forEach((e=>{r[e]=!0})),r}function g(e,t,{eraseUndefined:n}={}){var i,r=n&&void 0===t?e:t;return Array.isArray(e)&&Array.isArray(t)?(i=t,r=e.concat(i)):"object"==typeof e&&"object"==typeof t&&(r=function(e,t,{eraseUndefined:n}={}){for(var i in t)e[i]=g(e[i],t[i],{eraseUndefined:n});return e}(e,t,{eraseUndefined:n})),UWA.clone(r)}function p(e,t,n){var i=!0,r=!0;return Array.isArray(e)&&Array.isArray(t)?i=function(e,t,n){var i=m(e.length,t.length);if(e.length==t.length)if(n&&!0===n.withoutOrder)i=function(e,t,n){for(var i=!0,r=UWA.clone(e),s=t.length,a=0;a<s;a++){var o=h(r,t[a],n);if(o<0){i=!1;break}r.splice(o,1)}return i}(e,t,n);else for(var r=0;r<e.length;r++)i=p(e[r],t[r],n)&&i;return i}(e,t,n):"object"==typeof e&&"object"==typeof t?i=function(e,t,n){var i=e===t;if(!i&&e&&t){var r=Object.keys(e),s=Object.keys(t);if(i=m(r.length,s.length))for(var a in e){i=p(e[a],t[a],n)&&i}}return i}(e,t,n):typeof e==typeof t?i=m(e,t):r=!1,i=i&&!0===r}function h(e,t,n){var i=-1;return e.every((function(e,r){return p(e,t,n)&&(i=r),-1===i})),i}function m(e,t){return e===t}var w={createSingleton:function(e,{staticProperties:t}={}){let n=f(e);delete n.constructor;let i=null;class r{constructor(){throw new Error(`Utilisez ${Class.name}.getInstance() ou les méthodes statiques directement`)}static _getInstance(){return i||(i=new e),i}static _reset(){i=null}static _isInstantiated(){return null!==i}}return Object.keys(n).forEach((t=>{"function"==typeof e.prototype[t]&&(r[t]=function(){return r._getInstance(),i[t].apply(i,arguments)})})),t&&t.forEach((e=>{Object.defineProperty(r,e,{get:()=>(r._getInstance(),i[e]),set:t=>{r._getInstance(),i[e]=t}})})),r},getUserId:function(){if(void 0===window.dsUserLogin)try{window.dsUserLogin=window.top.dsUserLogin}catch(e){window.dsUserLogin="unknown"}return window.dsUserLogin},getUser:function(){return null==d&&(d=a.getUser()),d},getUserLogin:function(){var e=w.getUser();return e&&e.login?e.login:w.getUserId()},getWorkUnderHeaders:function(){let e=o.get();var t=UWA.is(e)&&UWA.is(e.change.id)?e.change.id:null;return""!=t?{"DS-Change-Authoring-Context":"pid:"+t}:{}},promiseCatcher:function(e){e.catch((e=>{}))},softJsonParser:function(e,t){let n=t?[]:{};try{n=JSON.parse(e)}catch(e){console.log(e)}return n},stringEncode:function(e){var t="";if(e)for(var n=0;n<e.length;++n)t+=e.charCodeAt(n);return t},compareLabels:function(e,t,n){if(e=Array.isArray(e)?e[0]||"":e||"",t=Array.isArray(t)?t[0]||"":t||"",n&&("real"===n||"integer"===n)&&!isNaN(e)&&!isNaN(t))return Number(e)-Number(t);const i=e=>("string"!=typeof e&&(e=String(e)),e.normalize("NFD").replace(/[̀-ͯ]/g,"").toLowerCase()),r=i(e),s=i(t);return r===s?0:r>s?1:-1},jsonZip:function(t){if(t.length>0&&"{"!==t[0]&&"["!==t[0])return t;for(var n=new ArrayBuffer(t.length),i=new Uint8Array(n),r=0;r<t.length;++r)i[r]=t.charCodeAt(r);var s=window.Deflater?new Deflater:new zip.Deflater;s.append(i);var a=s.flush(),o=String.fromCharCode.apply(null,a);return e.base64Encode(o)},jsonUnzip:function(t){if(t.length>0&&("{"===t[0]||"["===t[0]))return t;var n=t;try{n=e.base64Decode(t)}catch(e){}for(var i=new ArrayBuffer(n.length),r=new Uint8Array(i),s=0;s<n.length;++s)r[s]=n.charCodeAt(s);var a=window.Inflater?new Inflater:new zip.Inflater,o=a.append(r);return a.flush(),String.fromCharCode.apply(null,o)},isTouchDevice:function(){return"ontouchstart"in document.documentElement},isIndexedMode:function(){return"index"===this.determineAuthoringMode()},determineAuthoringMode:function(){if(!widget.getValue("useIndexAccleration"))return"authoring";const e=widget.getValue("IPClassify_ModeInfo")||{};if(UWA.is(e.state,"string")&&UWA.is(e.last_editing,"number")){const t=(new Date).getTime(),n=parseInt(widget.getValue("intervalToSwitchMode"));return"index"===e.state||"authoring"===e.state&&e.last_editing+1e3*n<t&&n?"index":"authoring"}return"index"},isCustomizedEnv:function(){var e=this;return void 0===e._isCustomizedEnv&&(e._isCustomizedEnv=!1,n.getGrantedRoles((function(t){for(var n=0;n<t.length;n++)if(t[n]&&"InternalDS"===t[n].id||"PAR"===t[n].id){e._isCustomizedEnv=!0;break}}))),e._isCustomizedEnv},getTenantId:function(){if(i.isNatifEnvironnement()&&!i.isWebInWinEnvironment()){var e=dscef&&dscef.getEnv?dscef.getEnv("MX_ONLINE_INSTANCE"):"";return e&&" "!==e&&""!==e||(e=r.getPlatformId()),e}if(i.isNatifEnvironnement()&&i.isWebInWinEnvironment()){var t=window.library||window.bookmark;return t&&t.params&&t.params.tenant&&" "!=t.params.tenant?t.params.tenant:r.getPlatformId()}return r.getPlatformId()},getTenantAwarePreferenceName:function(e){let t=this.getTenantId();return t&&"OnPremise"!=t?e+"_"+t:e},isOnPremise:function(){let e=this.getTenantId();return!e||"OnPremise"==e},_getSpaceUrl:function(){var e=this;return new Promise((function(t){i.get3DSpaceUrlAsync({platformId:e.getTenantId(),onComplete:function(e){t(e)},onFailure:function(e){t(r.get3DSpaceUrl())}})}))},get3DSpaceUrl:function(){if(c)return c;this._getSpaceUrl().then((function(e){c=e}))},_getSearchUrl:function(){var e=this;return new Promise((function(t){i.get3DSearchUrlAsync({platformId:e.getTenantId(),onComplete:function(e){t(e)},onFailure:function(e){t(r.get3DSearchUrl())}})}))},get3DSearchUrl:function(){if(l)return l;this._getSearchUrl().then((function(e){l=e}))},_getCompassUrl:function(){var e=this;return new Promise((function(t){i.getCompassUrlAsync({platformId:e.getTenantId(),onComplete:function(e){t(e)},onFailure:function(e){t(r.getPlatformURL("3DCompass"))}})}))},get3DCompassUrl:function(){if(u)return u;this._getCompassUrl().then((function(e){u=e}))},initURLS:function(){l=c=u=null,this.get3DSearchUrl(),this.get3DSpaceUrl(),this.get3DCompassUrl()},initURLSAsync:function(){var e=this;return l=c=u=null,new Promise((function(t){var n=[e._getSearchUrl(),e._getSpaceUrl(),e._getCompassUrl()];Promise.all(n).then((function(e){l=e[0],c=e[1],u=e[2],t()})).catch((function(e){console.log("Error while initializing URLs: "+e)}))}))},isWidgetMaximized:function(){return"enopad_odt_wgd"==widget.id||(t.Widgets&&(e=t.Widgets.instances.filter((function(e){return!(!t.is(e,"object")||"maximized"!==e.getView().type&&"fullscreen"!==e.getView().type||e.id!==widget.id)}))),e&&e.length>0);var e},arrayEquals:function(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every(((e,n)=>e===t[n]))},setPCSEntry:function(e,t){if(!this.isOnPremise())try{if(t)window.performance.mark(e+"_Begin");else{var n=window.performance.getEntriesByName(e+"_Begin");n&&n.length>0&&(window.performance.mark(e+"_End"),window.performance.measure(e,e+"_Begin",e+"_End"))}}catch(e){console.log(e)}},sendPCSTracketPageEvent:function(e,t,n){var i=window.performance.getEntriesByName(n).pop(),r=0;i&&(i.length>0?r=void 0!==i[0]?i[0].duration:0:i.duration&&(r=i.duration)),r&&(this.sendTrackerPageEvt("performance",e,{label:t,value:r}),window.performance.clearMeasures())},convertExpandV2toV1:function(e){if(e&&!(e.length<=0)){for(var t=0,n=e.length;t<n;++t){let n=e[t],r={attributes:[]};if(n["ds6w:type"]){for(var i in n)n.hasOwnProperty(i)&&("icon"===i?r.attributes.push({name:"icons",value:n[i]}):r.attributes.push({name:i,value:n[i]}),"resourceid"===i&&(r.attributes.push({name:"physicalid",value:n[i]}),r.attributes.push({name:"did",value:n[i]})));e.push(r)}}return e}},sendTrackerPageEvent:function(e,t){this.sendTrackerPageEvt("usage",e,{label:t})},getAppId:function(){if("undefined"!=typeof widget)return widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):widget.getValue("appId")},getPlatformId:function(){return"undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"false"},sendTrackerPageEvt:function(e,t,{label:n,value:r}){if(!this.isOnPremise())try{let o="ENOFOL4_AP"===widget.data.appId?"ENOFOL3_AP":widget.data.appId;o=o||this.getAppId();let l=i.isCatiaV5Environment()?"catiav5":i.isSolidworksEnvironment()?"solidworks":i.isNatifEnvironnement()&&dscef&&dscef.is3Dx&&dscef.is3Dx()?"3DExperience richclient":i.isNatifEnvironnement()&&dscef&&!0===dscef.isA2X?"A2X":"Dashboard",c={pd1:widget?widget.id:"default_id",pd2:l},u={pv1:void 0};var a={eventCategory:e||"usage",eventAction:t,eventLabel:n,eventValue:r,appID:o,tenant:this.getPlatformId(),persDim:c,persVal:u};s.trackPageEvent(a)}catch(e){console.log(e)}},areSame:m,concatJsonValue:g,compareJsonValue:p};return w})),define("DS/IPClassifyUtil/IPClassifyCommunication",["DS/WidgetServices/WidgetServices"],(function(e){"use strict";var t=function(e,t){var n=JSON.stringify(t);dscef.sendString(e+"="+n)},n=function(e,t){"undefined"!=typeof dscef&&dscef.sendString(JSON.stringify({event:e,content:t}))};return{publish:function(i,r){if(e.isNatifEnvironnement())return e.isWebInWinEnvironment()?n(i,r):t(i,r)}}})),define("DS/IPClassifyUtil/IPSettingsMgr",["DS/PlatformAPI/PlatformAPI","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/IPContext"],(function(e,t,n){"use strict";return t.createSingleton(class{constructor(){this.name="IPSettingsMgr",this._settings={},this._settings.options=new Map,this._settings.settingsValue=new Map}getUniqueId(){return(65536*(1+Math.random())|0).toString(16).substring(1)}getLegacyCredential(){return this.getSetting("pad_security_ctx")}getCredential(e){let t=this.getSetting("xPref_CREDENTIAL")||this.getLegacyCredential();return e&&!0===e.prefixed&&t&&!t.startsWith("ctx::")?"ctx::"+t:t}getWebCredential(){let e=this.getCredential();return e&&!e.startsWith("ctx::")&&(e="ctx::"+e),e}setWidgetSetting(e,t){this.setSetting(e,t,{widgetPreference:!0})}setSetting(e,t,n){let i=n&&(n.init||!1),r=n&&(n.widgetPreference||!1),s=i&&void 0!==widget.getValue(e);s&&(t=widget.getValue(e)),this._settings.settingsValue.set(e,t),s||!widget.hasPreference(e)&&!r||widget.setValue(e,t)}getSetting(e){return widget.getValue(e)||this._settings.settingsValue.get(e)}isCompassInacessible(){return widget.getValue("noCompass")}isWebInWin(){return this.isCompassInacessible()&&!this.isIntegratedIframe()}isIntegratedIframe(){let e=this.getSetting("_integratedIframe");if(void 0===e){if(e=window.top!==window.self,e)try{window.top.location.href;e=!1}catch(t){e=!0}this.setSetting("_integratedIframe",e)}return e}isEmbeddedWidget(){return this.getSetting("embeddedWidget")}updateTenantSettings(e,t,n){if(void 0!==window.widget){var i,r={name:"x3dPlatformId",type:"list",label:"pad_tenant",options:t,onchange:"onPlatformIdChange"};if(1===t.length&&(r.disabled=!0),e&&"OnPremise"!==e)i=!0;else{var s=widget.getValue("x3dPlatformId");s&&"OnPremise"!==s&&(i=!0)}this.isWebInWin()||i&&n&&widget.addPreference(r),widget.setValue("x3dPlatformId",e),this.setSetting("x3dPlatformId",e),widget.setValue("pad_tenant",e),this.setSetting("pad_tenant",e)}else this.setSetting("x3dPlatformId",e),this.setSetting("pad_tenant",e)}updateTenantPreference(e){if(null===this.app_context)throw new Error("Set the app context before using the PADSettingsMgt");var t=this,i=n.get();if(i&&UWA.is(i.empty,"function")){var r=!1;UWA.is(i.getPADTreeDocument,"function")?r=0!==i.getPADTreeDocument().getRoots().length:UWA.is(i.getRoots,"function")?r=0!==i.getRoots().length:console.warn("Unknown context");var s=t.getSetting("x3dPlatformId");if(r){t.getSetting("pad_security_ctx");if(s!==e.value);}else t.setSetting(e.name,e.value),e.value}else t.setSetting(e.name,e.value)}updateWidgetPreferences(e){if(this._dynamicUpdate=null,!e||!1!==e.submitted){if(null===this.app_context)throw new Error("Set the app context before using");var t=this;widget&&widget.getPreferences().forEach((function(e){"x3dPlatformId"===e.name?(console.log("check we are in if condition "),t.updateTenantPreference(e)):t.setSetting(e.name,e.value)}))}}getSpecificWidgetPreference(e){let t=this._settings.options.get(e),n=t?t.preference:{},i=this.getSetting(e);return[UWA.merge({name:e,defaultValue:i},n)]}setPreferences(e,t){this._settings.options.set(e,t)}})})),define("DS/IPClassifyUtil/IPServicesMgr",["DS/PlatformAPI/PlatformAPI","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/IPSettingsMgr","DS/i3DXCompassServices/i3DXCompassPubSub","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","i18n!DS/IPClassifyUtil/assets/nls/IPClassifyUtil"],(function(e,t,n,i,r,s,a){"use strict";let o,l=null;return{getAppId:n.getAppId,getPlatformId:n.getPlatformId,getTenantsPreference:function(){var e=[];if(!UWA.is(o,"array"))throw new Error("Platform services not initialize yet");return o.forEach((function(t){e.push({label:t.displayName,value:t.platformId})})),e},getTenantsPref:async function(){return await this.app_initialization_promise(),this.getTenantsPreference()},getWidgetId:function(){return"undefined"!=typeof widget?widget.id:-1},updatePlatformId:function(e){e&&"undefined"!=typeof widget&&(widget.setValue("x3dPlatformId",e),widget.setValue("pad_tenant",e))},getSharedId:function(){return"undefined"!=typeof widget?widget.getValue("x3dSharedId")?widget.getValue("x3dSharedId"):this.getAppId():-1},buildOpenJson:function(e,t){var n,i,r={version:"1",structures:{references:[],connections:[],trees:{}}},s=[],a="",o=0,l=0,c={},u=[];t&&t.forEach((function(e){u.push(e[e.length-1])}));var d=function(e){var t=c[e];UWA.is(n[t.localid])||(n[t.localid]={},t.selected&&(n[t.localid].selected=t.selected)),n=n[t.localid]},f=function(e){var t=e.isSelected();return u.length&&(t=-1!==u.indexOf(e.getID())),t};return e.forEach((function(e){var t=e.getParents(),u=e.getAllDescendants();for(o=0;o<t.length;o++)(a=t[o].getRelationID()).length>0&&-1===s.indexOf(a)&&(r.structures.connections.push({physicalid:a,localid:l+""}),c[a]={localid:l,selected:f(t[o])},l++,s.push(a)),a=t[o].getID(),-1===s.indexOf(a)&&(r.structures.references.push({physicalid:a,type:t[o].options.type,localid:l+""}),c[a]={localid:l},l++,s.push(a));for((a=e.getRelationID()).length>0&&-1===s.indexOf(a)&&(r.structures.connections.push({physicalid:a,localid:l+""}),c[a]={localid:l,selected:f(e)},l++,s.push(a)),a=e.getID(),-1===s.indexOf(a)&&(r.structures.references.push({physicalid:a,type:e.options.type,localid:l+""}),c[a]={localid:l},e.isRoot()&&f(e)&&(c[a].selected=f(e)),l++,s.push(a)),o=0;o<u.length;o++)(a=u[o].getRelationID()).length>0&&-1===s.indexOf(a)&&(r.structures.connections.push({physicalid:a,localid:l+""}),c[a]={localid:l,selected:f(u[o])},l++,s.push(a)),a=u[o].getID(),-1===s.indexOf(a)&&(r.structures.references.push({physicalid:a,type:u[o].options.type,localid:l+""}),c[a]={localid:l},l++,s.push(a));var g=e.getLeaves();if(g.length>0)for(var p=0;p<g.length;p++)n=r.structures.trees,(i=g[p].getOccurencePath()).forEach(d);else i=e.getOccurencePath(),n=r.structures.trees,i.forEach(d)})),r},setStructure_4_open_in_cv5:function(e){var t,n,s=[];if(!UWA.is(e.nodes_2_open,"array")&&!UWA.is(e.completeselection))throw new Error("setStructure_4_open_in_cv5: Invalid init parameter nodes_2_open");if(e.completeselection)s=e.completeselection;else if(i.getSetting("open_in_v5_v2"))s=this.buildOpenJson(e.nodes_2_open,e.selected_paths);else{var a=[];e.nodes_2_open.forEach((function(e){var i=e.getParents(),r=e.getAllDescendants();for(t=0;t<i.length;t++)n=i[t].getID(),-1===a.indexOf(n)&&(s.push({physicalid:n,isroot:i[t].isRoot()}),a.push(n));if("CgrViewable"!==e.options.grid["ds6w:type"]&&"ThumbnailViewable"!==e.options.grid["ds6w:type"])for(n=e.getID(),-1===a.indexOf(n)&&(s.push({physicalid:n,isroot:e.isRoot()}),a.push(n)),t=0;t<r.length;t++)"CgrViewable"!==r[t].options.grid["ds6w:type"]&&"ThumbnailViewable"!==r[t].options.grid["ds6w:type"]&&(n=r[t].getID(),-1===a.indexOf(n)&&(s.push({physicalid:n,isroot:r[t].isRoot()}),a.push(n)))}))}var o=JSON.stringify(s);r.publish("setStructure",{structure:o})},updateTenantSettings:function(e,t,n){if(void 0!==window.widget){var r,s={name:"x3dPlatformId",type:"list",label:"pad_tenant",defaultValue:e,options:t,onchange:"onPlatformIdChange"};if(1===t.length&&(s.disabled=!0),e&&"OnPremise"!==e)r=!0;else{var a=widget.getValue("x3dPlatformId");a&&"OnPremise"!==a&&(r=!0)}i.isWebInWin()||r&&n&&widget.addPreference(s),widget.setValue("x3dPlatformId",e),i.setSetting("x3dPlatformId",e),widget.setValue("pad_tenant",e),i.setSetting("pad_tenant",e)}else i.setSetting("x3dPlatformId",e),i.setSetting("pad_tenant",e)},app_initialization:function(e){this.app_initialization_promise().then(e)},app_initialization_promise:function(){return this._initializationPromise=this._initializationPromise?this._initializationPromise:new Promise((e=>{let n=this;var r="undefined"==typeof widget||null==widget.data||null==widget.data.addPlatformPref||widget.data.addPlatformPref,l=!1;"undefined"!=typeof widget&&i.isCompassInacessible()&&(l=!0),s.getPlatformServices({onComplete:function(i){o=[];var c=!1;if(!l&&"undefined"!=typeof widget&&i&&i.length>1){var u=i[0].platformId;u&&-1===["OnTenant1","odt_tenant","OnPremise"].indexOf(u)&&(c=!0)}if(c)s.getAppInfo({appId:n.getAppId(),onComplete:function(s){var l=!!s.tenantAware&&s.tenantAware;if(l){for(var c=0;c<s.platforms.length;c++)for(var u=0;u<i.length;u++)if(!l||i[u].platformId===s.platforms[c].id){o.push(i[u]);break}if(0===s.platforms.length)for(u=0;u<i.length;u++)if(!l||i[u].platformId===s.platformId){o.push(i[u]);break}}else o=i;var d=n.getTenantsPreference();if("undefined"!=typeof widget){let e=n.getPlatformId(),i=!0;for(let t=0;t<o.length&&i;t++)o[t].platformId===e&&(i=!1);i&&(n.updatePlatformId(d[0].value),t.displayNotification({message:a.replace(a.notAccessibleTenant,{tenant:e,switchedTenant:d[0].value})}))}var f="undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):d[0].value;1==r&&(console.info("tenants",d),console.info("current_tenant",f),n.updateTenantSettings(f,d,!0)),e({success:!0})},onFailure:function(t){console.error("Cannot retrieve the App Info"),e({success:!1})}});else{o=i;var d=n.getTenantsPreference(),f="undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):d[0].value;1==r&&f&&n.updateTenantSettings(f,d),e({success:!0})}},onFailure:function(t){e({success:!1})}})})),this._initializationPromise},setUser:function(e){l=e},getUser:function(){return null==l&&(l=e.getUser()),l},getUserLogin:function(){var e=this.getUser(),t="";return e&&(t=e.login),t},getUserName:function(){var e=this.getUser(),t="";return e&&(t=e.firstName+" "+e.lastName),t},printWindow:void 0,printWindowOpen:function(){return void 0!==this.printWindow&&null!==this.printWindow&&!1===this.printWindow.closed},printhtml:function(e){this.printWindowOpen()&&this.printWindow.close();setTimeout((function(){this.printWindow=window.open("","PrintWindow","width=1024, height=768"),void 0!==this.printWindow&&(this.printWindow.document.write(e),this.printWindow.document.close(),this.printWindow.focus(),this.printWindow.print(),this.printWindow.close())}),0)},downloadfile:function(e,t,n){var i=document,r=i.createElement("a");if(UWA.is(e)&&UWA.is(t)&&UWA.is(n)){if(n=n||"application/octet-stream",navigator.msSaveBlob&&!this.odtMode)return navigator.msSaveBlob(new Blob([e],{type:n}),t);if("download"in r){var s=URL.createObjectURL(new Blob([e],{type:n}));return r.setAttribute("href",s),r.setAttribute("download",t),r.innerHTML="downloading...",i.body.appendChild(r),setTimeout((function(){r.click(),i.body.removeChild(r),URL.revokeObjectURL(s)}),66),!0}}}}})),define("DS/IPClassifyUtil/service/IPClassifyUtilWebService",["UWA/Core","DS/WAFData/WAFData","i18n!DS/IPClassifyUtil/assets/nls/IPClassifyUtil","DS/PADUtils/PADSettingsMgt","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/IPSettingsMgr","DS/SixwDictionaryAccess/SixwDictionaryAccessAPI"],(function(e,t,n,i,r,s,a){"use strict";return{getUserPreferences:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for LibraryEditorWebService.getUserPreferences");var n=r.get3DCompassUrl()+"/resources/AppsMngt/user/getPreferences";return t.name&&(n+="?name="+t.name),t.method="GET",t.securityContextRequired=!1,this._executeRequest(n,t,"getUserPreferences")},saveUserPreferences:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for LibraryEditorWebService.saveUserPreferences");var n=r.get3DCompassUrl()+"/resources/AppsMngt/user/preference";t.method="PUT",t.headers={"Content-Type":"application/x-www-form-urlencoded"},t.data={name:e.name,value:e.value},t.securityContextRequired=!1,this._executeRequest(n,t,"saveUserPreferences")},_executeRequest:function(e,r,a){var o=Math.round(1e3*Math.random()).toString(),l=widget.id+"_"+widget.getTitle()+"_";window.performance.mark("libraryRequest_begin"+o);var c={};if(UWA.extend(c,r),!c.payload&&e.indexOf("cvservlet")>-1){c.payload={};var u=new Date;c.payload.label=("LibraryWidgetExecute_"+u.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-")}UWA.is(c.onTimeout,"function")||(c.onTimeout=function(){var e={type:"timeout",toString:function(){return n.msg_InfoAction_Timeout}};c.onFailure(e)},c.onComplete=function(e){window.performance.mark("libraryRequest_end"+o);var t=window.performance.getEntriesByName("libraryRequest_begin"+o);t&&1===t.length&&(window.performance.measure(l+"_Request"+a,"libraryRequest_begin"+o,"libraryRequest_end"+o),window.performance.clearMarks("libraryRequest_end"+o),window.performance.clearMarks("libraryRequest_begin"+o)),r.onComplete(e)});var d={Accept:"application/json","Accept-Language":r.acceptLang?r.acceptLang:widget.lang?widget.lang:widget.getValue("lang")};if(!1!==c.securityContextRequired){let e=i.getSetting("pad_security_ctx")||s.getWebCredential(),t=e?encodeURIComponent(e):e;d.SecurityContext=t}return r.headers?c.headers=UWA.extend(d,r.headers):c.headers=d,t.authenticatedRequest(e,c)},fetchClassPredicates:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for IPClassifyUtilWebService.fetchClassPredicates");var t={};UWA.extend(t,e);var n=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/fetchDefinition";return t.method="GET",this._executeRequest(n,t,"fetchClassPredicates")},fetchTypesInfo:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for IPClassifyUtility.fetchTypesInfo");var n=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/getTypesOnRelation";return t.method="GET",this._executeRequest(n,t,"fetchTypesInfo")},fetch:function(e){var t={};if(UWA.extend(t,e),!UWA.is(t,"object"))throw new Error("Invalid inputs for loadThumbnails");var n=e.ids,a=null;if(n.length){var o=r.get3DSpaceUrl()+"/cvservlet/fetch/v2",l=i.getSetting("pad_security_ctx")||s.getWebCredential();o+="?SecurityContext="+encodeURIComponent(l);var c={physicalid:n,label:("LibraryWidgetExecute_"+(new Date).getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-")};e.select_file&&(c.select_file=e.select_file),e.select_predicate&&(c.select_predicate=e.select_predicate),t.query={tenant:i.getSetting("x3dPlatformId")||r.getTenantId()};var u=widget.lang?widget.lang:widget.getValue("lang");t.headers={Accept:"application/json","content-type":"application/json",SecurityToken:r.getUserLogin()+"|"+l+"|preferred","Accept-Language":u},t.method="POST",t.type="json",t.data=UWA.Json.encode(c),a=this._executeRequest(o,t,"loadThumbnails")}return a},getAuthorizedValuesNls:function(e){var t={};UWA.extend(t,e);var n={};n.attribute=e.attribute,n.values=e.values.split(","),n.type=e.type,t.method="POST",t.type="json",t.payload=UWA.Json.encode(n),t.data=UWA.Json.encode(n),t.headers={Accept:"application/json","content-type":"application/json"};var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/getRangeNls",s=this._executeRequest(i,t,"getAuthorizedValuesNls");return console.log(s),s},loadThumbnails:function(e){return e.select_file=["thumbnail_2d"],this.fetch(e)},getPredicates:function(e){return e.serviceName="3dspace",e.lang=widget.lang,e.onlyMappable=e.mappable,e.tenantId=e.tenant,a.get6wProperties(e)},getDimensionsInfos:function(e){return this._executeRequest(r.get3DSpaceUrl()+"/resources/dictionary/dimensions",e,"getDimensionsInfos")},updateClassAttributes:function(e){return this._executeRequest(r.get3DSpaceUrl()+"/resources/dictionary/AttributeModify?tenant="+e.tenant+"&package="+e.package,e,"updateClassAttributes")},updateClassAttributesMql:function(e){return this._executeRequest(r.get3DSpaceUrl()+"/resources/ClassificationAttributesService/attributes/updateAttributes?tenant="+e.tenant,e,"updateClassAttributesMql")},attributeDeleteCheck:function(e){return this._executeRequest(r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/hasClassifiedItems?tenant="+e.tenant,e,"attributeDeleteCheck")},removeClassificationInterfaces:function(e){return this._executeRequest(r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/removeClassificationInterfaces?tenant="+e.tenant,e,"attributeDeleteCheck")},restoreSybolicNames:function(e){return this._executeRequest(r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/restoreSybolicNames?tenant="+e.tenant+"&package="+e.package,e,"restoreSybolicNames")},deleteAttributes:function(e){return this._executeRequest(r.get3DSpaceUrl()+"/resources/dictionary/AttributeDelete?tenant="+e.tenant+"&package="+e.package,e,"deleteAttributes")},checkIfSymbolicNameExists:function(e){return this._executeRequest(r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/checkAttributeUniqueness",e,"checkIfSymbolicNameExists")},createAttributes:function(e){return this._executeRequest(r.get3DSpaceUrl()+"/resources/dictionary/AttributeCreate?tenant="+e.tenant+"&package="+e.package,e,"createAttributes")},upgradeClassAttributes:function(e){return this._executeRequest(r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/upgradeClassAttributes?tenant="+e.tenant,e,"upgradeClassAttributes")},reloadCache:function(e){return this._executeRequest(r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/reloadCachedData?tenant="+e.tenant,e,"reloadCache")},updateAttributeInfos:function(e){return this._executeRequest(r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/UpdateAttributeInfos?tenant="+e.tenant,e,"updateSearchIndex")},launchExport:function(e){var t=r.get3DSpaceUrl()+"/resources/dictionary/ExportData?tenant="+e.tenant+"&package="+e.package;return this._executeRequest(t,e,"launchExport")},launchImport:function(e){return this._executeRequest(r.get3DSpaceUrl()+"/resources/dictionary/ImportData",e,"launchImport")},massupdateAttributeInfos:function(e){return this._executeRequest(r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/MassUpdateAttrsInfos?tenant="+e.tenant,e,"massupdateAttributeInfos")},convertDimensionUnits:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for convertDimensionUnits");var t=r.get3DSpaceUrl()+"/resources/dictionary/dimensions/convertValues",n={};return UWA.extend(n,e),n.payload=e.data,n.method="POST",n.headers={Accept:"application/json","content-type":"application/json"},n.data=UWA.Json.encode(n.payload),this._executeRequest(t,n,"convertToPreferedUnit")}}})),define("DS/IPClassifyUtil/IPClassifyPreference",["UWA/Class","DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassifyUtil/IPClassifyUtility"],(function(e,t,n){return e.singleton({get:function(e,i,r,s){function a(e){if(e)try{s&&(e=n.jsonUnzip(e)),e=JSON.parse(e)}catch(t){e={}}else e={};return e}if(s=!1!==s,r=!1!==r)if(window.dscef&&window.dscef.loadValue)window.dscef.isA2X?(window.dscef.loadValue(e),i({})):window.dscef.loadValue?window.dscef.loadValue(e).then((function(e){o=a(e),i(o)})).catch((function(e){i({})})):i({});else if(widget&&widget.getValue){o=a(o=widget.getValue(e)),i(o)}else{var o;o=a(o=window.nonDsApps),i(o)}else t.getUserPreferences({name:e,onComplete:function(e){o=a(e),i(o)},onFailure:function(e){i()}})},set:function(e,i,r,s){i&&(r=!1!==r,s=!1!==s,i=JSON.stringify(i),s&&(i=n.jsonZip(i)),r?window.dscef&&window.dscef.saveValue?window.dscef.saveValue(e,i):widget&&widget.setValue?widget.setValue(e,i):window.nonDsApps=i:t.saveUserPreferences({name:e,value:i,onComplete:function(){},onFailure:function(t){console.log("Error while saving userpreferences for "+e)}}))}})})),define("DS/IPClassifyUtil/DimensionUtils",["UWA/Class","DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassifyUtil/IPClassifyUtility"],(function(e,t,n){"use strict";return e.singleton({init:function(e){},setUnitPreferedMe:function(e){this.unitPreferedMe=e},getUnitPreferedMe:function(e){return this.unitPreferedMe[e]},getUnitAndNLS:function(e,t){if(this._dimensions&&e){let n=this._dimensions[e];if(!n)return null;let i={};return i.unit=n.mksUnitDBName,i.nls=n.defaultUnit,t&&(i.manipulationNls=n[t]),i}return null},_dimensions:null,getDimensions:function(){var e=this;return this._dimensionPromise=this._dimensionPromise?this._dimensionPromise:new Promise((function(i){e._dimensions?i(e._dimensions):n.initURLSAsync().then((function(){t.getDimensionsInfos({method:"GET",Accept:"application/json","content-type":"application/json",onComplete:function(t){try{t="string"==typeof t?JSON.parse(t):t;var n={};t.results.forEach((function(e){var t={};t.mksUnitDBName=e.MKSUnit;e.Units.forEach((function(e){t[e.Name]=e.NLSName,t.mksUnitDBName==e.Name&&(t.defaultUnit=e.NLSName)})),n[e.Name]=t})),e._dimensions=n,console.info("Dimensions Loaded ..."),i(e._dimensions)}catch(t){console.error("Unexpected error when fetching dimensions"),console.error(t),e._dimensionPromise=null,i(null)}},onFailure:function(t){console.error("Unable to get dimentions : "),console.error(t),e._dimensionPromise=null,i(null)}})}))})),this._dimensionPromise},convertToPreferdUnits:function(e){return new Promise((function(i){n.initURLSAsync().then((function(){t.convertDimensionUnits({data:e,onComplete:function(e){var t=(e="string"==typeof e?JSON.parse(e):e).Response?e.Response:[];i(t)},onFailure:function(e){console.error("Unable to convert dimentions units : "),console.error(e),i(null)}})}))}))}})}));