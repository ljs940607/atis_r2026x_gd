define("DS/CATWebUXCommands/DMUCaptureCmd",["require","exports","DS/CATWebUXComponents/DMUCommand","DS/CATWebUXComponents/CATWebUXNotification","i18n!DS/CATWebUXCommands/assets/nls/CATWebUXCommands"],(function(e,t,n,i,o){"use strict";return class extends n{constructor(e){super(e,"shared",!0),this.executioncontext=e.executioncontext;const t=this,n=this.options.executionContext?this.options.executionContext.getComponent("Viewer").get3DViewer().getContent().getParent():this.getFrameWindow().getUIFrame();let a,r,s=this.getFrameWindow().getViewer();function c(e,t){let n=function(e,t){let n=t||"image/jpeg",i=atob(e),o=i.length,a=new Uint8Array(o);for(let e=0;e<o;e++)a[e]=i.charCodeAt(e);return new Blob([a],{type:n})}(e.split(",")[1],t);return n}this.beginExecute=async function(){var e;await(e="function",new Promise((t=>{let i=new UWA.Element("div",{id:"_ViewScreenShot-Flash",styles:{position:"absolute",top:0,left:0,width:s.SCREEN_WIDTH+"px",height:s.SCREEN_HEIGHT+"px","background-color":"white","z-index":"100002"}}).inject(n),o=1,a=function(){o-=.02,i.setStyle("opacity",o),o<0?(n.removeChild(i),"function"==typeof e&&e()):requestAnimationFrame(a)};a(),t()})));let d,l=await async function(){r=document.createElement("CANVAS");let e=new ImageData(s.SCREEN_WIDTH,s.SCREEN_HEIGHT);s.renderToTarget(e,s.currentViewpoint),r.height=s.SCREEN_HEIGHT,r.width=s.SCREEN_WIDTH;let t=r.getContext("2d");if(t){let n=await createImageBitmap(e,0,0,e.width,e.height);t.clearRect(0,0,r.width,r.height),t.scale(1,-1),t.drawImage(n,0,0,r.width,-r.height),n.close()}let n=new Image;return n.src=r.toDataURL("image/png"),n.src}();if(l){try{d=function(e){if(navigator.clipboard&&navigator.clipboard.write){let t=[new ClipboardItem({"image/png":e})];return navigator.clipboard.write(t),1}}(c(l,"image/png"))}catch(e){window.console.log(e)}var g,m;d&&(g="success",m=o.copiedToClipboard,t&&(a||(a=new i),a.build({body:n,autoHide:!0,type:g,message:m}))),window.require(["DS/DMUBaseExperience/EXPUtils"],(function(e){e._sendUsageProbe("command","CopyScreenshotCmd")})),t.done&&t.done()}else t.done&&t.done()}}}}));