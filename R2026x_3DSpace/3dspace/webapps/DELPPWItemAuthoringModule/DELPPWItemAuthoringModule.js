define("DS/DELPPWItemAuthoringModule/TreeListAuthoringModule",["UWA/Core","DS/DELPPWTreeListAuthoringModule/TreeListAuthoringBaseModule"],(function(e,n){"use strict";return{behaviors:["TreeListViewBehavior","GraphViewBehavior","WUXNodeModelBehavior","DropZoneViewBehavior","ModelBehavior","SelectionBehavior","BIBehavior","SearchBehavior","ResourceBehavior","EditAttributeBehavior","DocumentBehavior","ExportToCSVBehaviour","RefreshBehavior","UXFactoryBehavior","ProductImplementBehavior","ViewBehavior","ExpandFilterBehavior","LoadObjectBehavior","Viewer3DBehavior","AltSubBIBehavior","LinkBehavior","AltSubReplaceBehavior","RootsBehavior","CfgColumnsBehavior","InterWidgetComBehavior","MfgItemQuantityGroupingBehavior","MfgProcessCrossHighlightBehavior"],creator:function(t,i,o,r,a,d,s,c,u,h,f,l,p,g,v,R,A,C,w,y,m,I,B,P,T,S,E,M){var O,V,b,N,L,D,k,x,U,G,W,j,F=new(0,n.creator)(t,i,r,a,d,c,u,h,f,l,p,g,v,R,A,C),X=[],H=[];return L=function(n){var t,i=function(n){var i=!1;return e.is(n)&&e.is(n.get,"function")&&(n.isConnection()?i=H.indexOf(n.get("type"))>-1:(t=d.getPPRType(n),i=X.indexOf(t)>-1)),i};return Array.isArray(n,"array")?n.every((function(e){return i(e)})):i(n)},D=function(){return X.indexOf("PROCESS")>-1||X.indexOf("SERVICE")>-1||X.indexOf("CONSTRUCTION")>-1},k=function(){return X.indexOf("PART")>-1||X.indexOf("PRODUCT")>-1},W=function(){var e=[];r.getSelectedNodes().forEach((function(n){e.push({nodeId:n.getInstancePID()||n.getReferencePID(),isSelected:n.isSelected(),absPath:n.getAbsolutePath()})})),e.length>0&&t.notify("reComputeCrossHighlight",[e])},G=function(n){var a,d,s,c=function(){d=r.getWUXNodeModel(),o.setModel(d),s=o.viewName},u=function(){d=o.getModel(),i.loadDocument(d),s=i.viewName};a=t.getElement(),e.is(n,"boolean")?!0===n?a.hasClassName("showGraphView")||(c(),a.addClassName("showGraphView")):a.hasClassName("showGraphView")&&(u(),a.removeClassName("showGraphView")):(a.hasClassName("showGraphView")?u():c(),a.toggleClassName("showGraphView")),A.setCurrentView({currentView:s}),t.notify("ManageGraphViewCmdAvailablity")},U=function(n){var i=!1;e.is(n.arguments[0])&&e.is(n.arguments[0].sourceModuleId)?n.arguments[0].sourceModuleId!==t.getId()?i=!1:n.arguments[0].sourceModuleId===t.getId()&&(i=!0):i=A.getActiveView()===t.getId(),i&&G()},x=function(){var n,i,r=t.getId();n=t.getPreferenceValue("widgetLayoutStateValues"),e.is(n)&&e.is(n[r])&&n[r].display&&(i=n[r].viewType===o.viewName,G(i))},j=function(e){var n=[];(e=Array.isArray(e)?e:[e]).forEach((function(e){var t=d.getReferenceModel(e[0]);L(t)&&n.push(e)})),n.length>0&&F.onAddOccurrence(n)},{listenTo:function(){return e.extend(F.listenTo(),{referenceAdded:this.onAddReference,connectionAdded:this.onAddConnection,addOccurrece:j,addProductOrPart:this.onAddProductOrPart,referenceRemoved:this.onRemoveRefOrInst,instanceRemoved:this.onRemoveRefOrInst,connectionRemoved:this.onRemoveConnection,referenceChanged:this.onChangeIRPC,instanceChanged:this.onChangeIRPC,addRootNode:this.onRootNodeAdded,connectionChanged:this.onChangeIRPC,EditAttribute:this.onEditAttribute,Quantity:this.onEditAttribute,reparent:this.onReparentInstances,reparentBegin:this.onReparentBegin,reparentEnd:this.onReparentEnd,searchAndAddInstance:this.onSearchAndAddInstance,InsertAsCopy:this.onInsertAsCopy,ToggleGraphView:U,widgetLayoutChanged:x,viewModeChanged:x,select:this.onSelect})},onStart:function(n){if(F.onStart(n),!n.pprTypes||!n.linkTypes)throw new Error(t.getId()+": TreeListAuthoringModule initialization failed");X=n.pprTypes,H=n.linkTypes,O=e.is(n.views)&&e.is(n.views.treeListView)?n.views.treeListView.viewToggleCommand:void 0,V=e.is(n.displayBadgeProductScope)?n.displayBadgeProductScope:null,b=e.is(n.displayBadgePartialProductScope)?n.displayBadgePartialProductScope:null,N=e.is(n.displayBadgeRPL)?n.displayBadgeRPL:null,x(),r.setForceIndexMode(n.forceIndexMode||!1),t.notify("ManageGraphViewCmdAvailablity")},onStop:function(){F.onStop()},onAddReference:function(n,i,o){var a=!1;n=e.is(n,"array")?n:[n],r.withTransactionUpdate((function(){n.forEach((function(n){!function(n){var r={silentMode:!0,withLinksResolved:!1};if(L(n))e.is(o)&&(r=e.merge(o,{silentMode:!0,withLinksResolved:!1})),F.onAddReference(n,i,r),a=!0;else if(D()&&"RESOURCE"===n.get("PPRTYPE"))t.notify("addToAuxiliaryView",[n])}(n)}))})),e.is(O)&&a&&t.notify(O,{state:!0})},onAddConnection:function(n){var t=!1,i=function(n){var i,o,a;L(n)&&(i=n.get("from"),o=n.get("type"),a=i,l.isDocConnection(n)?r.updateDocAttributes(i):(D()&&(r.isNodeAdded(i)&&(r.prepareUpdate(),e.is(V)&&V.linkType===o&&r.updateBadge(a,V.badgeIcon),r.updateAttributes(n),r.pushUpdate()),t=!0),k()&&(t=!0)))};r.withTransactionUpdate((function(){e.is(n,"array")?n.forEach((function(e){i(e)})):i(n),t&&W()}))},onChangeIRPC:function(n){var t=function(e){L(e)&&F.onChangeIRPC(e)};e.is(n,"array")?r.withTransactionUpdate((function(){n.forEach((function(e){t(e)}))})):t(n)},onRemoveRefOrInst:function(n){var t,i=[];t=function(e){L(e)&&i.push(e)},e.is(n,"array")?n.forEach((function(e){t(e)})):t(n),i.length>0&&F.onRemoveRefOrInst(i)},onRemoveConnection:function(n){var i=!1,o=function(n){var o,a;if(e.is(n)){if(L(n))if(a=n.get("from"),l.isDocConnection(n))r.updateDocAttributes(a);else{if(D()){if(o=n.get("type"),!e.is(o,"string"))return void t.debug("Could not get connection type");r.isNodeAdded(a)&&((e.is(V)&&V.linkType===o||e.is(N)&&N.linkType===o||e.is(b)&&b.linkType===o)&&r.updateBadge(a,null),r.updateAttributes(n)),i=!0}k()&&(i=!0)}}else t.debug("ERROR: No model defined")};r.withTransactionUpdate((function(){e.is(n,"array")?n.forEach((function(e){o(e)})):o(n),i&&W()}))},onReparentInstances:function(e){D()&&F.onReparentInstances(e)},onReparentBegin:function(e){D()&&F.onReparentBegin(e)},onReparentEnd:function(e){D()&&F.onReparentEnd(e)},onEditAttribute:function(e,n){D()&&F.onEditAttribute(e,n)},onSearchAndAddInstance:function(){D()&&F.onSearchAndAddInstance()},onInsertAsCopy:function(){D()&&F.onInsertAsCopy()},onRootNodeAdded:function(n,i){var o;const a=i||{},d=!e.is(a.loadRelatedobjectsToView)||a.loadRelatedobjectsToView;if(D()&&e.is(n)&&r.isNodeAdded(n)&&d){const i=R.getScopeLinksOfImplementing(n);if(i.length>0)o=i[0].get("to");else{const e=R.getPartialScopeLinksOfImplementing(n);e.length>0&&(o=e[0].get("to"))}e.is(o)&&t.notify("addProductOrPart",{pid:o})}},onAddProductOrPart:function(n){var i,o;e.is(n)&&e.is(n.pid)?k()&&(r.isNodeAdded(n.pid)||(i=d.getReference(n.pid),e.is(i)?r.addNode(i,{silentMode:!0,withLinksResolved:!1}):(o={forceDBMode:!0,silent:!0,onComplete:function(n){e.is(n)&&r.addNode(n,{silentMode:!0,withLinksResolved:!1})}},d.fetchRoot(n.pid,o)))):t.debug(this.name,"Required input parameters are missing.")},onSelect:function(e){}}}}}));