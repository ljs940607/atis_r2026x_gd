define("DS/DELWebViewerControllerV2/PartFabrication/PartFabricationController",["UWA/Core","DS/Selection/CSOManager","DS/DELWeb3DViewerV2/NodeUtil","text!DS/DELWebViewerControllerV2/assets/json/PartFabricationPayload.json"],(function(e,t,n,r){"use strict";return function(t,i,a,o){const l=o.getOption("mappingKeys"),s="resourceid",c="ds6w:label",u="ds6w:globalType",h="Path",d="ds6w:Instance",p="ro.DELFmiFunctionInstance.V_IsFlexiblePart",f="ro.DELFmiUseCaseExt.V_UseCase",g=["ManufacturingMadeFrom","EngineeringMadeFrom","ManufacturingAssembly"];let b={},m=o.getOption("eventCollection").getViewerCtrlEventHnd(),E=function(t){let n=[];return t&&e.is(t.path,"array")&&t.path.length>0&&(n=e.is(t.path[0],"array")?t.path:[t.path]),n},S=function(t){let n=[];if(e.is(t,"array")&&t.length>0){let e=t[t.length-1],r=i.getContext().getController(),a=function(e,t){let n;return e&&e.getChildren&&e.getChildren().length>0&&t&&e.getChildren().forEach((function(e){let r=t.getUserData({id:e.getInstanceId()});r&&"DELFmiProcessImplementCnx"===r.type&&(n=e)})),n}(r.createReferenceIterator(e),r);if(a){n=[...t];let e=a.getReferenceIterator();n.push(a.getInstanceId()),n.push(e.getReferenceId())}}return n},P=function(t,n){var r;return r=e.is(t,"array")&&t.length>0?i.setGraphicProperties({graphicProperties:function(e,t){return e.map((function(e){return{path:e,visibility:t,visibilityFree:!t}}))}(t,n)},l.SCENEGRAPHKEYS.PARTFABRICATION,!0):Promise.reject("Invalid Paths"),r},y=function(t){let n=!1;if(e.is(t,"array")&&t.length>1&&b&&b[t[0]]){let e=t[t.length-2],r=t[0],i=b[r].instances[e];n=!(!i||!i.isFlexible&&-1===g.indexOf(i.madeFrom))}return n},v=async function(t){var n=t.idPath,l=o.getOption("partFabrication"),g=JSON.parse(r);if(l&&e.is(n,"array")&&n.length>0){let t=await a.getTaxonomies(n);n.forEach((async function(n){let r=a.getPPRType(t[n]),o=i.getContext().getController().getBIProxy().getFilterSpec(n,{V2:{}});if("MBOM"===r||"SBOM"===r){let t=await async function(t,n){let r=await a.getProgressiveExpandData(function(e,t,n){return e.batch.expands[0].root.physical_id=t,n&&(e.batch.expands[0].filter={and:{filters:[n]}}),e}(g.partFabrication,t,n));return function(t){var n={references:{},instances:{},paths:[]};return t&&e.is(t.results,"array")&&t.results.forEach((e=>{e[h]?n.paths.push(e[h]):e[u]===d&&(n.instances[e[s]]={instanceId:e[s],label:e[c],isFlexible:!(!e[p]||"TRUE"!==e[p]),madeFrom:e[f]})})),n}(r)}(n,o);t.paths.length>0&&(b[n]=t,P(t.paths,!1).then((function(){i.render()})))}}))}},w=function(t){let n=[],r=[],a=o.getOption("partFabrication"),s=function(e,t){r.push({path:e,visibility:t,visibilityFree:!t})},c=function(e){e.forEach((e=>function(e){let t=e.length,r=2;for(;t>r;){let i=e.slice(0,t-r),a=S(i);a.length>0&&-1===n.indexOf(i.toString())&&!y(i)&&s(a,!1),r+=2}}(e.slice(0,e.length-2))))};if(a&&t&&e.is(t.graphicData,"array")&&t.graphicData.length>0){let a=function(){let r=[];return t.graphicData.forEach((function(t){if(t&&t.category&&e.is(t.path,"array")&&t.path.length>0){if(y(t.path)){let e=S(t.path);r.push(e)}n.push(t.path.toString())}})),r}();c(a),function(e){let t=Object.keys(b).map((e=>b[e])),n=e.map((e=>e.toString()));t.forEach((function(e){(e&&e.paths&&e.paths.length>0?e.paths:[]).forEach((function(e){-1===n.indexOf(e.toString())&&s(e,!1)}))}))}(a),i.getRoots().forEach((function(e){e.setVisibility(!0),e.setVisibilityFree(!1)})),i.removeSceneGraphOverrideSet(l.SCENEGRAPHKEYS.PARTFABRICATION),i.setGraphicProperties({graphicProperties:r},l.SCENEGRAPHKEYS.BUILDUP).then(i.render)}},V=function(){let t=[];if(o.getOption("partFabrication")){i.getRoots().forEach((function(r){let i=n.getNodeID(r);t=t.concat(function(t){let n=[];return b[t]&&e.is(b[t].paths,"array")&&b[t].paths.length>0&&(n=b[t].paths),n}(i))})),t.length>0&&P(t,!1).then((function(){i.render()}))}};var D;return(D=[{eventName:"onRootAdded",eventHandler:i,callback:v},{eventName:"onRootRemoved",eventHandler:i,callback:function(){o&&o.id&&b&&b[o.id]&&delete b[o.id]}},{eventName:m.events.onGlobalBuildUpComplete,eventHandler:m,callback:w},{eventName:m.events.onGlobalBuildUpRemoved,eventHandler:m,callback:V}],{subscribeEvents:function(){D.forEach((function(e){e.eventHandler.subscribe(e.eventName,e.callback)}))}}).subscribeEvents(),{showMaterial:function(e){var t,n=[],r=[],a=o.getOption("partFabrication"),l=E(e);return a?(l.forEach((function(e){if(y(e)){let t=S(e);t.length>0&&(n.push(t),-1===r.indexOf(t[0])&&r.push(t[0]))}})),n.length>0?(r.forEach((function(e){let t=i.getNode({id:e});t.setVisibility(!1),t.setVisibilityFree(!0)})),t=P(n,!0).then((function(){i.render(),i.reframeOn({path:n}),m.publish(m.events.onShowMaterialComplete,{status:!0})}))):t=Promise.reject("No materials paths found to show")):t=Promise.reject("Out of Scope feature not enabled."),t},hideMaterial:function(t){var n,r,a=[],s=[],c=E(t),u=o.getOption("partFabrication"),h=[];return u?(c.forEach((function(e){if(y(e)){let t=S(e);t.length>0&&(a.push(t),s.push(t.slice(0,t.length-1).toString())),-1===h.indexOf(e[0])&&h.push(e[0])}})),a.length>0?(n=function(e){let t={};return i.getOverrides(l.SCENEGRAPHKEYS.PARTFABRICATION).forEach((function(n){!0===n.getVisibility()&&n.getIdPathes().forEach((function(n){let r=n.ids.slice(1);t[r[0]]||(t[r[0]]=[]),-1!==e.indexOf(r[0])&&-1===s.indexOf(r.toString())&&t[r[0]].push(r)}))})),t}(h),h.forEach((t=>{if(e.is(n[t],"array")&&0===n[t].length){let e=i.getNode({id:t});e.setVisibility(!0),e.setVisibilityFree(!1)}})),r=P(a,!1).then((function(){i.render(),i.reframeOn(),m.publish(m.events.onHideMaterialComplete,{status:!0})}))):r=Promise.reject("No materials paths found to hide")):r=Promise.reject("Out of Scope feature not enabled."),r}}}})),define("DS/DELWebViewerControllerV2/Utils/DataParser",["UWA/Core"],(function(e){"use strict";var t,n=function(){return{getOpenDataFormat:function(t){let n={items:[]};return e.is(t,"array")&&t.forEach((t=>{let r={};t.processId?r={id:t.processId,scopedMfg:{id:t.mfgId,occurrence:e.is(t.installPath,"array")?t.installPath:[],predecessors:e.is(t.predecessors,"array")?t.predecessors:[]},resource:{id:t.resourceId},operation:{id:t.operationId,occurrence:e.is(t.operationPath,"array")?t.operationPath:[]},publishedRep:{id:t.publishedRepId},withFilter:!!e.is(t.withFilter,"boolean")&&t.withFilter,reframe:!e.is(t.reframe,"boolean")||t.reframe}:t.id&&(r={id:t.id,withFilter:!!e.is(t.withFilter,"boolean")&&t.withFilter,reframe:!e.is(t.reframe,"boolean")||t.reframe}),n.items.push(r)})),n},getOpenDataFormatV2:function(t){let n={items:[]};return e.is(t,"array")&&t.forEach((t=>{let r={};t.scopedMfg?r={id:t.id,scopedMfg:e.is(t.scopedMfg,"array")?t.scopedMfg.map((function(e){return{id:e.id,occurrence:e.occurrence,predecessors:e.predecessors}})):[],resource:t.resource,operation:{id:t.operationId,occurrence:e.is(t.operationPath,"array")?t.operationPath:[]},publishedRep:t.publishedRep,withFilter:!!e.is(t.withFilter,"boolean")&&t.withFilter,reframe:!e.is(t.reframe,"boolean")||t.reframe}:t.id&&(r={id:t.id,withFilter:!!e.is(t.withFilter,"boolean")&&t.withFilter,reframe:!e.is(t.reframe,"boolean")||t.reframe}),n.items.push(r)})),n},getInitializeBuildupOptions:function(e){return{id:e.processId,scopedMfg:[{id:e.mfgId,occurrence:e.installPath}],resources:[{id:e.resourceId}],filter:e.filter,publishedRep:{id:e.publishedRepId},displayNotif:e.displayNotif,predecessors:e.predecessors,successors:e.successors,noDependecy:e.noDependecy}},getPublicFilterSpec:function(t,n){let r=null,i=function(t){let r=null;return e.is(t,"array")?t.forEach((e=>{(e.occurrence&&e.occurrence.length>1&&n===e.occurrence[0]||n===e.id)&&(r=e.publicFilterSpec?e.publicFilterSpec:null)})):t&&t.id===n&&(r=t.publicFilterSpec?t.publicFilterSpec:null),r};return r=i(t),r||(r=i(t.scopedMfg)),r||(r=i(t.resource)),r}}};return e.is(t)||(t=new n),t})),define("DS/DELWebViewerControllerV2/BehaviorFactory",[],(function(){"use strict";return function(e,t,n){var r={},i={DrillBehavior:"DS/DELWebViewerControllerV2/Drill/DrillController",ToolbarBehavior:"DS/DELWebViewerToolbarV2/ToolbarController",BuildUpBehavior:"DS/DELWebViewerBuildUpControllerV2/BuildUpController",WorkInstructionBehavior:"DS/DELWebViewerWorkInstructionControllerV2/WorkInstructionController",FTABehavior:"DS/DELWebViewerControllerV2/FTA/FTAController",StatusBarBehavior:"DS/DELWebViewerControllerV2/StatusBar/StatusBarController",PartFabricationBehavior:"DS/DELWebViewerControllerV2/PartFabrication/PartFabricationController"};return{getCreatePromise:function(a){var o=this;return new Promise((function(l,s){var c,u=[null,o,e,t,n].concat(Array.prototype.slice.call(arguments,1));UWA.is(a,"array")&&a.length>0?(c=a.map((function(e){return i[e]})))instanceof Array?require(c,(function(){var e=Array.prototype.slice.call(arguments);e.length>0&&e.forEach((function(e,t){r[a[t]]=new(Function.prototype.bind.apply(e,u))})),l(r)})):s(n.getNLSValue("Error.InvalidInput.Message")):l(r)}))},getInstance:function(e){return e&&r[e]?r[e]:null},reset:function(){Object.values(r).forEach((function(e){e.reset&&e.reset()}))},destroy:function(){Object.values(r).forEach((function(e){e.destroy&&e.destroy()})),r={}}}}})),define("DS/DELWebViewerControllerV2/Drill/DrillController",["UWA/Core","DS/Selection/CSOManager","DS/Selection/HSOManager"],(function(e,t,n){"use strict";return function(r,i,a,o){const l={detailedFasten:"DetailedFasten",manufacturedPart:"ElementaryEndItem"},s=["Drill","NoDrill","PreDrill"],c=-1,u=-2,h=o.getOption("mappingKeys");var d,p={},f=o.getOption("logger"),g=[],b=function(){let t=function(t,n){let r=[];return e.is(t,"array")&&t.length>0&&n&&e.is(n.selected,"array")&&(r=e.is(t[0],"array")?t.map((e=>e.toString())):[t.toString()]),r};return{addSelectedPaths:function(e,n){t(e,n).forEach((function(e){-1===n.selected.indexOf(e.toString())&&n.selected.push(e.toString())}))},removeSelectedPaths:function(e,n){let r=t(e,n);n.selected=n.selected.filter((e=>-1===r.indexOf(e)))},getSelectedPaths:function(){var e=[];return Object.keys(p).forEach((function(t){e=e.concat(p[t].selected)})),e}}}(),m=o.getOption("eventCollection").getViewerCtrlEventHnd(),E=function(t,n,r=!1){e.is(t,"array")&&t.length>0&&i.setGraphicProperties({graphicProperties:function(e,t){return e.map((function(e){return{path:e,visibility:t,visibilityFree:!t,usePathElement:r}}))}(t,n)},h.SCENEGRAPHKEYS.PRIVATE).then((function(){i.render()}))},S=function(t,n=!1){var r=i.getIdPathesLeadingToReference(n?t[t.length-1]:t[t.length-3]),a=[];return e.is(r,"array")&&r.length>0&&r.forEach((function(e){n||(e.ids.push(t[t.length-2]),e.ids.push(t[t.length-1])),a.push(e.ids)})),a},P=function(e){return!(!e||!e.taxonomies)&&Object.values(s).some((t=>-1!==e.taxonomies.indexOf(t)))},y=function(e){return e&&e.pathsr&&e.pathsr.includes("R_51")},v=async function(t){var n,r=t.rootIds;e.is(r,"array")&&r.length>0&&(n=await a.getTaxonomies(r),r.forEach((async function(t){var r,o,l,s,c=a.getPPRType(n[t]),u=i.getContext().getController().getBIProxy().getFilterSpec(t,{V2:{}});"MBOM"!==c&&"SBOM"!==c||(r=await(l=t,s=u?u.filter:null,a.getDrillData({id:l,filter:s})))&&e.is(r.paths,"array")&&r.paths.length>0&&(p[t]=r,p[t].selected=[],o=r.resultingProductDrillPaths,E(o,!1))})))},w=function(r){var a,o,s,h,d=(t.get()||[]).map((e=>i.getRIRPath(e.pathElement).toString())),f=function(){let t=[];return r&&e.is(r.path)&&r.path.length>0&&(t=e.is(r.path[0],"array")?r.path:[r.path]),t}(),g=function(e){let t=S(e).map((e=>e.toString()));return d.find((e=>-1!==t.indexOf(e)))},m=function(e){var t;return e.parentNode.getChildren().forEach((function(n){n.getModelIdentification()===e.instanceObj.instanceId&&(t=n)})),t},v=function(e){let t=e[e.length-1],r=e[e.length-2],a=n.get().map((e=>i.getRIRPath(e.pathElement).toString())),o=e[e.length-3],d=e[e.length-4],p=s&&s.references?s.references[o]:{},f=s&&s.instances?s.instances[d]:{},b={path:e,referenceObj:s&&s.references?s.references[t]:{},instanceObj:s&&s.instances?s.instances[r]:{},parentNode:i.getNode({id:o})},P=function(e){i.getNodeFromPath(e)&&E(S(e).filter((t=>-1===a.indexOf(t.toString())&&t.toString()!==e.toString())),!h,!0)};(y(b.instanceObj)||p.type===l.detailedFasten&&y(f))&&b.parentNode&&(h?(!function(e){let t,n,r,a,o=e.path,l=o.length>2?o.slice(0,o.length-2):o,s=function(e){i.highlightNode({pathElements:[{pathElement:e}],highlight:!0})};m(e)?(E([o],!0,!0),s(i.getPathElementV2(o))):(a=i.getPathElement(l),t=i.createNode({id:e.referenceObj.referenceId,type:e.referenceObj.type,matrix:null,usage:c}),n=i.createNode({id:e.instanceObj.instanceId,type:e.instanceObj.type,matrix:e.instanceObj.matrixtxt,parentMatrix:e.parentMatrix,usage:u}),r=i.createArrowNode({headLength:15,arrowLength:60,arrowWidth:1,headWidthToHeightRatio:.4,viewpoint:i.getContext().getViewer().currentViewpoint,color:{R:1,G:0,B:1},head:1,pickable:!0,globalSelection:!0}),n.addChild(t),t.addChild(r),e.parentNode.addChild(n),i.render(),a&&a.addElement&&(a.addElement(n),a.addElement(t),s(a)))}(b),P(e)):g(e)?E([e],!1,!0):(P(e),function(e){let t=(n.get()||[]).find((t=>t.pathElement.getLastElement().getModelIdentification()===e.referenceObj.referenceId));t&&i.highlightNode({pathElements:[t],highlight:!1}),e.parentNode&&(e.parentNode.removeChild(m(e)),i.render())}(b)))},w=function(e){var t;s=p[e[0]],o=s&&s.references?s.references[e[e.length-1]]:{},s&&P(o)?(o.resultingProductLink?E([e],h):v(e),h?b.addSelectedPaths(e,s):b.removeSelectedPaths(e,s)):s&&o&&o.taxonomies&&Object.values(l).every((e=>-1===o.taxonomies.indexOf(e)))&&(t=o.referenceId,a={resultingProductDrills:s.resultingProductDrillPaths.filter((e=>e[e.length-3]===t)),drills:s.drillPaths.filter((e=>e[e.length-3]===t))},a.drills.forEach((function(e){v(e)})),E(a.resultingProductDrills,h),h?b.addSelectedPaths(a.drills.concat(a.resultingProductDrills),s):b.removeSelectedPaths(a.drills.concat(a.resultingProductDrills),s))};if(!r||!0!==r.doNotProcessDrills){if(r.clear){let e=b.getSelectedPaths().filter((e=>-1===d.indexOf(e)));h=!1,e.forEach((function(e){w(e.split(","))}))}f.length>0&&(h=r.highlight,f.forEach((function(e){w(e)})))}},V=function(e){e&&e.idPath&&v({rootIds:e.idPath})},D=function(e){e&&e.id&&p&&p[e.id]&&delete p[e.id]},I=function(){let n=t.get()||[],r=[],a=function(t,n){e.is(t,"array")&&t.length>0&&t.forEach((function(e){w({path:e,highlight:n})}))};if(n.forEach((e=>r.push(i.getRIRPath(e.pathElement)))),r&&r.length>0){let e;e=b.getSelectedPaths().map((e=>e.split(","))),a(e,!1),a(r,!0)}else if(0===r.length){a(b.getSelectedPaths().map((e=>e.split(","))),!1)}},C=function(){e.is(g,"array")&&g.length>0&&(g.forEach((function(t){let n=t[0],r=p[n],a=r&&r.references?r.references[t[t.length-1]]:{},o=t[t.length-3],s=r&&r.references?r.references[o]:{},c=P(a),u=c&&e.is(t,"array")&&t.length>2?t.slice(0,t.length-2):t,h=i.getNode({id:u[u.length-1]});if(h&&(h.removeChild((d=c?t[t.length-2]:null,h.getChildren().forEach((function(e){e.getModelIdentification()===d&&(f=e)})),f)),c&&s&&s.type===l.detailedFasten||!c)){let e=i.getShapePaths(c?u:t);E(e,!0)}var d,f})),g=[])},O=function(t){try{if(t&&e.is(t.graphicData,"array")&&t.graphicData.length>0){let n=t.graphicData;C(),n.forEach((function(t){if(t&&t.visibility&&t.isSymbolic){let n=t.path,r=n[0],a=p[r],o=a&&a.references?a.references[n[n.length-1]]:{},s=a&&a.instances?a.instances[n[n.length-2]]:{},d=n[n.length-3],f=n[n.length-4],b=a&&a.references?a.references[d]:{},m=a&&a.instances?a.instances[f]:{};const v=function(e){return e.map((e=>({path:e,visibility:!1,visibilityFree:!0,usePathElement:!0})))},w=function(e,t){return e&&e.type===l.detailedFasten&&y(t)},V=function(n,r,a=[]){let l=r&&e.is(n,"array")&&n.length>2?n.slice(0,n.length-2):n,d=v(a),p=i.getNode({id:l[l.length-1]});if(p){g.push(n);let e=i.createArrowNode({headLength:15,arrowLength:60,arrowWidth:1,headWidthToHeightRatio:.4,viewpoint:i.getContext().getViewer().currentViewpoint,color:{R:1,G:0,B:1},head:1,pickable:!0,globalSelection:!0});if(r){let t=i.createNode({id:o.referenceId,type:o.type,matrix:null,usage:c}),n=i.createNode({id:s.instanceId,type:s.type,matrix:s.matrixtxt,usage:u});n.addChild(t),t.addChild(e),p.addChild(n)}else p.addChild(e);t.usePathElement=!0,d.push(t),i.setGraphicProperties({graphicProperties:d},h.SCENEGRAPHKEYS.BUILDUP).then((function(){i.render()}))}},D=function(e,n,r=[]){let a=v(r);g.push([...e]),n||e.push(null),t.path=e,t.usePathElement=!0,a.push(t),i.setGraphicProperties({graphicProperties:a},h.SCENEGRAPHKEYS.BUILDUP).then((function(){i.render()}))},I=function(e,t,n){let r=g.map((e=>e.toString())),i=t.filter((t=>t.toString()!==e.toString())),a=i.filter((e=>-1===r.indexOf(e.toString())));return n||a.forEach((e=>e.push(null))),a.length===i.length?V.bind(null,e,n,a):D.bind(null,e,n,a)},C=function(e,t){let n=S(e,!t);return n.length>1?I.bind(null,e,n,t):V.bind(null,e,t)},O=function(e,t,n){let r=i.getShapePaths(e);return E(r,!1),C.bind(null,t,n)},T=function(e,t,n,r){return w(e,t)?O.bind(null,n,r,!0):null},N=function(e,t,r){return y(e)?V.bind(null,n,!0):T.bind(null,t,r,n.slice(0,n.length-2),n)},A=function(e,t,n){return w(e,t)?O.bind(null,n,n,!1):null},L=function(e,t,n,r){return e&&e.resultingProductLink?null:N.bind(null,t,n,r)};(function e(t){let n=t();n&&e(n)})((function(){return P(o)?L.bind(null,o,s,b,m):A.bind(null,o,s,n)}))}}))}}catch(e){f.error("Error in _onBuildupActivated:",e)}},T=function(){C()};return(d=[{eventName:m.events.onHighlightComplete,eventHandler:m,callback:w},{eventName:"onRootAdded",eventHandler:i,callback:V},{eventName:"onRootRemoved",eventHandler:i,callback:D},{eventName:m.events.onUnHighlightNode,eventHandler:m,callback:I},{eventName:m.events.onSelectNode,eventHandler:m,callback:I},{eventName:m.events.onUnSelectNode,eventHandler:m,callback:I},{eventName:m.events.onGlobalBuildUpComplete,eventHandler:m,callback:O},{eventName:m.events.onGlobalBuildUpRemoved,eventHandler:m,callback:T}],{subscribeEvents:function(){d.forEach((function(e){e.eventHandler.subscribe(e.eventName,e.callback)}))}}).subscribeEvents(),{}}})),define("DS/DELWebViewerControllerV2/FTA/FTAController",[],(function(){"use strict";const e="RepTextTess",t="reqfta.ftaVisu",n="reqfta.ParamName",r="reqfta.ParamType",i="reqfta.ParamString",a="RepTTRS",o="FTASurfaceInstance",l="PLMReqSpecifyHowToCnx",s=-1,c=-2,u="ds6w:label",h="physicalid",d="ds6w:type";return function(p,f,g,b){let m,E=b.getOption("logger"),S=b.getOption("mappingKeys"),P=b.getOption("eventCollection").getViewerCtrlEventHnd(),y=[],v=function(e,t){return f.createNode({id:e.physicalid,usage:t,type:e["ds6w:type"]?e["ds6w:type"]:e.type})},w=function(e,t){let a,o=e[n],l=e[r],s=e[i];for(let e=0,n=-1;e<o.length;e++){if("0"===l[e]&&n++,o[e]===t){a=s[n];break}}return a},V=function(n={}){let r={edgeTransparency:!1,textureInBlack:!0,processText:!1},i=v(n,s);f.addVisualizationToNode(i,n[t],r),f.addVisualizationToNode(i,w(n,e),r);try{!function(){let e,t,l=w(n,a),u=n.physicalid;l&&(t=v({physicalid:`${u}${o}`,type:o},c),e=v({physicalid:`${u}${a}`,type:a},s),f.addVisualizationToNode(e,l,r),t.setVisibility(!1),t.setVisibilityFree(!0),t.addChild(e),i.addChild(t))}()}catch(e){E.debug(e),E.warn(`Unable to create fta surface node for the requirement id - ${n.physicalid}`)}return i.traverse((function(e){return e.setPickParent(!0),!1})),i.setPickParent(!1),i},D=function(e,n){if(e){let r=[];n.forEach((e=>{if(UWA.is(e.elements,"array")&&function(e){return e.elements.some((e=>Object.prototype.hasOwnProperty.call(e,t)))}(e)){let t=v(e.owner,c);e.elements.forEach((e=>{t.addChild(V(e))})),r.push(t)}})),r.forEach((t=>{e.addChild(t)}))}},I=function(e,t){let n=e.getUserData();return!!n&&n.type===t},C=function(e,t){e&&e.length>0&&e.forEach((e=>{e&&UWA.is(e.paths,"array")&&e.paths.forEach((e=>{let n,r=f.getNodeFromPath(e);r&&(I(r,S.FTATYPES.REQUIREMENT)||I(r,S.FTATYPES.GEOMETRYREQUIREMENT))&&(n=r.getChildren().find((e=>I(e,o))),n&&n.setVisibility(t))}))}))},O=function(e){C(e,!0)},T=function(e){C(e,!1)},N=function(e){if(!e&&!e.path)throw E.error("path property is mandatory, please check the input"),new Error(b.getNLSValue("Error.InvalidInput.Message"));return Array.isArray(e.path[0])?e.path:[e.path]},A=function(e,t){e.forEach((e=>{let n=f.getNodeFromPath(e);n?t(n,e):E.warn("Unable to find the item for the path",e)}))},L=function(e,t){let n=!1;return function(e){return e.getChildren().some((e=>I(e,"PLMReqSpecifyHowToCnx")))}(e)&&(e.getChildren().forEach((e=>{I(e,"PLMReqSpecifyHowToCnx")&&(e.setVisibility(t),e.setVisibilityFree(!t))})),n=!0),n};return function(){var e={onSelectNode:O,onUnSelectNode:T};for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&y.push(P.subscribe(P.events[t],e[t]))}(),m={loadFTA:async function(e){E.debug("loadFTA function invoked with params - ",JSON.stringify(e));let t,n,r=N(e),i=[],a=[];return A(r,(function(e,t){L(e,!0)?i.push(t):a.push({path:t,node:e})})),a.length>0&&(t=a.map((e=>e.path[e.path.length-1])),n=await g.getRequirements(t),n.result.forEach((e=>{if(e.outputs.requirements){let t=a.find((t=>t.path[t.path.length-1]===e.input_object.physicalid));D(t.node,e.outputs.requirements),i.push(t.path)}else E.warn("FTA Information not found for the mfg item ",e.input_object.physicalid)}))),f.render(),{path:[i]}},removeFTA:async function(e,t=!0){E.debug("removeFTA function invoked with params - ",JSON.stringify(e));let n=[];return A(N(e),(function(e,t){L(e,!1)&&n.push(t)})),t&&f.render(),{path:n}},fetchFTAData:async function(e){return new UWA.Promise((function(a,o){g.getAttributeForIds(e,[u,h,d,t,r,n,i]).then((function(e){a(e)})).fail((function(e){E.error(e),o(e)}))}))},loadFTAPaths:async function(e){if(UWA.is(e,"array")&&e.length>0){let t=[],n=S.BUILDUPKEYS.FTAGEOMID;if(e.forEach((e=>{f.getNodeFromPath(e.path)||t.push(e)})),t.length>0){let e=t.map((e=>e[n])),r=await this.fetchFTAData(e);t.forEach((e=>{let t=e[n],i=UWA.is(e.path,"array")?e.path:[];if(i.length>0&&t&&r[t]){let e=function(e){let t=[];if(UWA.is(e,"array"))for(let n=0;n<e.length;n+=2)if(!f.getRefIterator(e[n])){t=e.slice(0,n-1);break}return t}(i);if(UWA.is(e,"array")&&e.length>0){let n=f.getNodeFromPath(e),a=i.filter((t=>!e.includes(t))),o=n;if(UWA.is(a,"array")&&a.length>0&&n)for(let e=0;e<a.length>0;e+=2){let n=a[e],i=a[e+1];if(n&&i){let u,h=i===t?S.FTATYPES.GEOMETRYREQUIREMENT:S.FTATYPES.REQUIREMENT,d=v({physicalid:n,type:l},c);if(e===a.length-2){let e=Object.assign({},r[t],{physicalid:i,type:h});u=V(e)}else u=v({physicalid:i,type:h},s);o.addChild(d),d.addChild(u),o=u}else E.warn("Reference ID or Instance ID of FTA is Invalid")}}else E.warn("Mfg item path not found for path :",i)}}))}}},removeFTAPaths:function(e){UWA.is(e,"array")&&e.forEach((e=>{if(UWA.is(e,"array")&&e.length>0){let t=f.getPathElementV2(e);if(t){let e=t.getParentPath(),n=e.getParentPath();for(;I(e.getLastElement(),l)&&(I(n.getLastElement(),S.FTATYPES.GEOMETRYREQUIREMENT)||I(n.getLastElement(),S.FTATYPES.REQUIREMENT));)e=n.getParentPath(),n=e.getParentPath();n&&n.getLastElement&&e&&e.getLastElement&&n.getLastElement().removeChild(e.getLastElement())}else E.debug("Path element not found for path ",e)}}))},reset:function(){},destroy:function(){m.reset(),y.forEach(P.unSubscribe),y=[],P=null}},m}})),define("DS/DELWebViewerControllerV2/DELWebViewerHighlightManager",["UWA/Core","DS/Selection/CSOManager","DS/Selection/HSOManager","DS/Selection/PSOManager","DS/DELWeb3DViewerV2/NodeUtil","DS/DELWebViewerUtils/DELWebViewerSettingsMgt"],(function(e,t,n,r,i,a){"use strict";return function(o,l,s,c){const u="Mouse",h="Touch",d="select",p="unSelect",f="highlight",g="unhighlight",b="preHighlight",m="unPreHighlight";var E=[],S=[],P=[],y=[],v=l.getContext().getViewer(),w=o.getInstance("WorkInstructionBehavior"),V=c.getOption("eventCollection").getViewerCtrlEventHnd(),D=c.getOption("mappingKeys"),I=o.getInstance("BuildUpBehavior"),C=a.getDELViewerSetting("itemProductConnectionTypes"),O=c.getOption("logger"),T=function(t){(t=e.is(t,"array")&&t.length>0?t:[t]).forEach((e=>{!function(e){var t,n,r,a=I&&I.getMfgAndResourceBuildup?I.getMfgAndResourceBuildup():[],o=function(e,t){if(e===D.PICKABILITY.ITEM&&(i.isRootType(t,D.PPRTYPES.MBOM)||i.isRootType(t,D.PPRTYPES.SBOM))){for(;null!==t&&-1===C.indexOf(i.getNodeType(t.getLastElement(!0)));)t=t.getParentPath();t&&(t=t.getParentPath())}return t};if(e.pathElement)if(l.getPickability()===D.PICKABILITY.BUILDUP&&a.length>0&&!i.isFTA(e.pathElement.getLastElement())){for(r=a.length,n=l.getContext().streamPath(e.pathElement).toString(),t=0;t<r;t++)if(!0===a[t].visibility&&-1!==n.indexOf(a[t].path.toString())){let n=o(c.getOption(D.OPTIONS.DEFAULTPICKABILITY),e.pathElement);e.pathElement=l.getContext().unstreamPath(a[t].path),e.pathElement.selectedPathBeforeBuildupPickability=l.getContext().streamPath(n).toString();break}}else e.pathElement=o(l.getPickability(),e.pathElement)}(e)}))},N=function(a,o){var s;if(e.is(a,"array")&&a.length>0)switch(s=function(e){var t=[];return e.forEach((function(e){let n=[],r=[],a=[],o=[],s={},c={paths:n,POIs:r,POIGroups:a,ZOIs:o,attributes:s};if(e=e.pathElement?e.pathElement:e,i.isAModelPath(e))l.streamPathWithType(e,n,s);else if(i.isAPOIPath(e)){let t=i.getPOILayerId(e);l.streamPOI(e,t,r)}else i.isAPOIGroupPath(e)?l.streamPOIGroup(e,a):i.isAZOIPath(e)?l.streamZOI(e,o):i.isADMUPath(e)?w&&w.streamPathWithType(e,n,s):O.warn("Cannot stream path : ",e);t.push(c)})),t}(a),o){case d:t.options.fromAPI||V.publish(V.events.onSelectNode,s);break;case p:t.options.fromAPI||V.publish(V.events.onUnSelectNode,s);break;case f:n.options.fromAPI||V.publish(V.events.onHighlightNode,s);break;case g:n.options.fromAPI||V.publish(V.events.onUnHighlightNode,s);break;case b:r.options.fromAPI||V.publish(V.events.onPreHighlightNode,s);break;case m:r.options.fromAPI||V.publish(V.events.onUnPreHighlightNode,s)}};P.push(t.onPostAdd((function(e){N(e,d)}))),P.push(t.onPostRemove((function(e){N(e,p)}))),E.push(n.onPostAdd((function(e){N(e,f)}))),E.push(n.onPostRemove((function(e){N(e,g)}))),S.push(r.onPostAdd((function(e){N(e,b)}))),S.push(r.onPostRemove((function(e){N(e,m)})));let A=l.subscribe("onRootAdded",(async function(e){let t=await s.getTaxonomies([e.id]),n=s.getPPRType(t[e.id]),r=l.getNode({id:e.id});i.updateUserData(r,{pprType:n})}));return y.push(v.onPreAddRemoveXSO(T)),S.push(r.onPreAdd((function(e){!e.event||u!==e.event.type&&h!==e.event.type||T(e)}))),{destroy:function(){S.length>0&&(S.forEach((e=>r.unsubscribe(e))),S=[]),y.length>0&&(y.forEach((e=>v.unsubscribe(e))),y=[]),E.length>0&&(E.forEach((e=>n.unsubscribe(e))),E=[]),P.length>0&&(P.forEach((e=>t.unsubscribe(e))),P=[]),A&&l.unSubscribe(A),c.setOption(D.OPTIONS.CURRENTPICKABILITY,null)}}}})),define("DS/DELWebViewerControllerV2/Controller",["UWA/Core","UWA/Class/Promise","UWA/Class/Options","DS/DELWebViewerLogger/Logger","DS/DELWebViewerEvents/EventCollection","DS/DELWebViewerModel/ModelInterface","DS/DELWeb3DViewerV2/ViewerInterface","DS/DELWebViewerControllerV2/BehaviorFactory","DS/DELWebViewerPerformaceLogger/PerformaceLogger","DS/DELWebViewerEventManager/ComponentEventHandler","DS/DELWebViewerProxyManagerV2/ProxyManager","DS/DELWebViewerResourceUtils/ResourceUtils","DS/DELWebViewerPreferences/Preferences","DS/DELWebViewerUtils/DELWebViewerSettingsMgt","DS/DELWebViewerUtils/Utils","DS/DELWebViewerControllerV2/DELWebViewerHighlightManager"],(function(e,t,n,r,i,a,o,l,s,c,u,h,d,p,f,g){"use strict";return function(p,f,b,m){var E,S,P,y,v,w,V,D,I,C,O,T,N,A=new n,L=new r,U={MfgItemsViewer:[],ProcessViewer:["BuildUpBehavior","ToolbarBehavior"],WorkInstructionViewer:["BuildUpBehavior","ToolbarBehavior","WorkInstructionBehavior"]},F={removeMaterial:"DrillBehavior",requirementFTA:"FTABehavior",statusBar:"StatusBarBehavior",partFabrication:"PartFabricationBehavior"};return A.setOptions(p),N=(N=localStorage?localStorage.getItem("LoggerSeverity"):null)||A.getOption("loggerSeverity"),L.setLoggerSeverity(N),A.setOption("logger",L),!0!==A.getOption("performanceLogging")&&"true"!==localStorage.getItem("PerformanceLogging")||(s.setOptions(A),s.initPerfObserver()),S=new i(A),A.setOption("eventCollection",S),P=new h(b),Object.assign(A,P),y=new d(P),Object.assign(A,y),V=A.getOption("viewerType"),L.info("********** Viewer Component Initialization Started (Type:%s) **************",Object.keys(U)[V]),s.markStart("DELWebViewerComponent"),T=[function(){return E=new a(A),w=function(e){var t={};Object.entries(f).some((function([n,r]){return r===e&&(t.name=n,t.viewerBehaviors=U[n],!0)}));for(const[e,n]of Object.entries(F))p[e]&&t.viewerBehaviors.push(n);return t}(V),E.getCreatePromise(w.viewerBehaviors)},function(){let t;return m?(v=new o(m,A),t=e.Promise.resolve()):(L.error("ViewerInterface intialization failed, require delweb3dComponent as input"),t=e.Promise.reject("ViewerInterface intialization failed, require delweb3dComponent as input")),t}].map((e=>e())),t.all(T).then((function(){return(D=new l(v,E,A)).getCreatePromise(w.viewerBehaviors)})).then((function(){return new t((function(e){I=new u(D,v,E,A),O=new c(I,A),e(I)}))})).then((function(){C=new g(D,v,E,A);let e=widget.getValue(p.mappingKeys.STARTUPVIEWDATA)||{};S.getComponentEventHnd().publish(S.getComponentEventHnd().events.onReady,e),s.markEnd("DELWebViewerComponent","Time taken to initialize the component"),L.info("********** Viewer Component Initialization Completed (Type:%s) **************",Object.keys(U)[V])})).fail((function(e){L.error("Component initialization failed due to : %o",e)})),{getViewer:function(){return v.getViewerElement()},getEventHnd:function(){return S.getComponentEventHnd()},getViewerBehavior:function(){return I},getFilterBIProxy:function(){return v.getFilterBIProxy()},getNGFUXID:function(){return v.getNGFUXID()},destroy:function(){[I,O,D,C,v,E,S,P].forEach((e=>{e&&e.destroy()})),O=A=null,S=P=D=v=E=L=y=T=C=null,s.dispose()}}}})),define("DS/DELWebViewerControllerV2/StatusBar/StatusBarController",["UWA/Core","DS/DELWebUiComponent/StatusBar/StartUpViewUI","DS/DELWebUiComponent/StatusBar/LastIndexingTime","DS/DELWeb3DViewerV2/NodeUtil","DS/DELWebUiComponent/NotificationUtils","DS/DELWebViewerControllerV2/Utils/DataParser","DS/DELWebViewerUtils/DELWebViewerSettingsMgt"],(function(e,t,n,r,i,a,o){"use strict";return function(l,s,c,u){var h,d,p=u.getOption("statusBar").commands,f=s.getContext(),g=u.getOption("mappingKeys"),b=l.getInstance("BuildUpBehavior"),m=u.getOption("eventCollection").getViewerCtrlEventHnd(),E=u.getOption("logger"),S=function(t,n,r){let i=e.is(t,"array")&&t.length>0?t.map((e=>e.id)):[];f.getController().getAttributes({ids:i,attributes:["ds6w:label","thumbnail_2d"],callbacks:{onComplete:function(e){h.setStartupView(i.map((t=>({id:t,name:e[t]["ds6w:label"],icon:e[t].preview_url})))),n&&n(e)}.bind(this),onFailure:function(){r&&r()}}})},P=function(){var t=c.getDataManager().get("process"),n=[];if(t){let r=b.getCurrentBuildUpContent(),i=r&&e.is(r.pathIds,"array")?r.pathIds:[];t.operationId=i.length>0?i[i.length-1]:"",t.operationPath=i,t.withFilter=!1,t.reframe=!1,n.push(t)}else{s.getRoots().map((e=>r.getNodeID(e))).forEach((e=>n.push({id:e,withFilter:!1,reframe:!1})))}return a.getOpenDataFormatV2(n)},y=function(){return!(!u.getOption("startUpView")||!e.is(u.getOption("startUpView").enable,"boolean"))&&u.getOption("startUpView").enable},v=async function(){let e=widget.getValue(g.STARTUPVIEWDATA),t=s.getMode()===g.VIEWERMODES.WORKINSTRUCTIONS;if(!0===y()){if(b.isBuildUpApplied()&&t)return void i.displayNotification({level:"error",title:u.getNLSValue("Error.StartUpViewNotSupport.Title"),subtitle:u.getNLSValue("Error.StartUpViewNotSupportWKIMode.Message"),sticky:!1});if(e)m.publish(m.events.onStartupViewRemoved,e),widget.deleteValue(g.STARTUPVIEWDATA),h.clearStartupView(),i.displayNotification({level:"success",title:u.getNLSValue("Success.StartupViewRemove.Title"),subtitle:u.getNLSValue("Success.StartupViewRemove.Subtitle"),message:u.getNLSValue("Success.StartupViewRemove.Message"),sticky:!1});else{if(s.getRoots().length>0){let e={viewpoint:(await s.getViewPoint()).viewpoint,...P()};widget.setValue(g.STARTUPVIEWDATA,e),S(e.items,(t=>{let n=e.items.map((e=>t[e.id]["ds6w:label"]));n=n.join(", "),i.displayNotification({level:"success",title:u.getNLSValue("Success.StartUpViewSet.Title"),subtitle:u.getNLSValue("RootsLabel",{rootsLabel:n},"Success","Subtitle"),message:u.getNLSValue("Success.StartUpViewSet.Message"),sticky:!1})})),m.publish(m.events.onStartupViewSet,e)}else i.displayNotification({level:"error",title:u.getNLSValue("Error.StartUpViewNotSupport.Title"),subtitle:u.getNLSValue("Error.StartUpViewNoRoot.Subtitle"),message:u.getNLSValue("Error.StartUpViewNoRoot.Message"),sticky:!1})}}};return e.is(p,"array")&&p.forEach((r=>{let i={container:f.getStatusBar().elements.infoContainer};switch(r){case"LastIndexingTime":i.nls=u.getNLSValue("Info.LastIndex.Title"),d=new n(i),(l=o.getDELViewerSetting("displayLastIndexedTimeStamp"))&&l.value&&s.subscribe(m.events.onExpandCompleted,(function(){c.getIndexingDate(l.service).then((function(t){var n=Number(t[l.service].allvaultsacl);e.is(n)&&d.setIndexingTime(n)})).fail((function(e){E.error(u.getNLSValue(e))}))}));break;case"StartUpView":i.onClick=v,i.nls=u.getNLSValue("Tooltip.StartupView.label"),i.enable=y(),h=new t(i),i.enable&&((a=widget.getValue(g.STARTUPVIEWDATA))?((a="object"!=typeof a?JSON.parse(a):a).viewpoint&&u.getOption("startUpView").setViewpoint&&s.setViewPoint(a.viewpoint),e.is(a.items,"array")&&a.items.length>0&&S(a.items)):h.clearStartupView())}var a,l})),m.subscribe(m.events.onUpdateOptions,(function(t){t&&t.data&&t.data.startUpView&&e.is(t.data.startUpView.enable,"boolean")&&h.setStartUpViewState(t.data.startUpView.enable)})),{destroy:function(){d&&d.destroy(),h&&h.destroy()}}}}));