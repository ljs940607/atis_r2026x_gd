define("DS/DELWKOLinksModule/DELWKOLinksUICloud",["UWA/Core"],(function(e){"use strict";return function(t,n,o,r,s,a,l){var c,d,u,f,g,p,h,m,P,I,b,L,y,E,v,R,S,C,A,k,D,T,w,U={className:"Links WOM-linksUIContainer disableContentselection"},O=o.getNLSValue("LinksUI.PanelTitle"),M={},N=null,V={title:"",labelAttribute:"V_Name",reference:{model:null},instance:{model:null,absPath:""},whereUsed:{isFetched:!1,references:[],instances:[]}};return b=function(){e.is(N)&&(N.title=O+V.title)},L=function(){var i,o,r,s,a=n.getComponent("WUXFrameWindowsManager").getFrameWindow(t.getAppContext());(N=n.create("Panel",{position:{my:"center",at:"center"},domId:"RelationsPanel",immersiveFrame:a.getImmersiveFrame(),resizableFlag:!0,visibleFlag:!1})).close=function(){e.is(d)?t.notify("toggleCmdCheckHeaderState",{cmdName:d,cmdState:!1}):S()},h=n.create("Element","div",{class:U.className}),i=n.create("Element","div",{class:"linksPanel-Container"}),o=n.create("Element","div",{class:"module-messages"}),r=y(),s=E(),o.inject(i),r.inject(i),s.inject(i),i.inject(h)},y=function(){var t;return t=n.create("Element","div",{class:"linkView-toolbar"}),(m=n.create("Filter",{filterToolbarSections:g})).inject(t),m.addEvent("onChange",(function(t,n){var i,o;for(i in o=this.getSelectedItems(),M)M.hasOwnProperty(i)&&(-1===o.indexOf(i)?M[i].pprTypeDiv.hide():(e.is(t,"string")&&"PARENT"===t&&!0===n&&!1===V.whereUsed.isFetched&&C(),M[i].pprTypeDiv.show()))})),t},E=function(){var t,i;for(i in t=n.create("Element","div",{class:"LinksUI-menuDiv"}),(p=n.create("WUXLoader")).inject(t),M)M.hasOwnProperty(i)&&(M[i].pprTypeDiv=new e.Element("div",{class:"pprTypeDiv"}).inject(t));return t},v=function(t,i,s,a,l){var c,d=o.getNLSValue("LinksUI.ConfirmationDialog.Header"),u=o.getNLSValue("LinksUI.ConfirmationDialog.Text");c=function(n){e.is(n,"boolean")&&n&&r.switchScope(t,i,s,a,l)},n.showConfirmation(d,u,null,c)},R=function(t,r){var s,a,l=n.createElement("div",{class:"selectInstance-dialog-container"}),c=[],d=n.getComponent("ComboBox"),u=n.getComponent("Button"),f=o.getNLSValue("LinksUI.SelectInstanceDialog.Header");for(i=0;i<t.length;i++)c.push({label:t[i].get("PLM_ExternalID"),value:t[i]});(a=new d({elementsList:c,enableSearchFlag:!1,actionOnClickFlag:!1})).inject(l),(s=n.create("Dialog",{domId:"selectInstance-dialog",title:f,content:l,resizableFlag:!0,modalFlag:!0,width:400,minWidth:290,buttons:{Cancel:new u({onClick:function(){s.close()}}),Ok:new u({disabled:!1,emphasize:"primary",onClick:function(){s.close(),e.is(r,"function")&&r(a.currentValue)}})}})).close=function(){this.destroy()}},S=function(){N.hide()},C=function(){var n,i=!1,o=!1,a=[],l=[],c=[],d=V.reference.model,u=V.instance.model,f=V.labelAttribute,g=!1,h=null,P=function(){var e,n,r,s;i&&o&&(e=a,n=l,r=c,s={WORKORDER:[],EXECHEADER:[],STEP:[],PRODUCT:[],PPLAN:[],BUILDS:[],PROCESS:[],SYSTEM:[],RESOURCE:[],PART:[],PARENT:[],SERVICE:[]},w(),s=k(e,d,u,f,s),s=D(n,r,d,u,f,s),A(s),p.hide(),t.notify("RelationsPanelLoaded")),g&&t.notify("updateRelationsColumn",h)},I=function(e){i=!0,a=e,P()};n=m.getSelectedItems(),!0!==V.whereUsed.isFetched?e.is(d)?(s.getWhereUsedReferences(d,(function(t,n){o=!0,e.is(V.whereUsed)&&(V.whereUsed.isFetched=!0,V.whereUsed.references=t,V.whereUsed.instances=n),l=t,c=n,P()}),I),V.whereUsed.isFetched=!0):o=!0:(e.is(d)&&-1!==n.indexOf("PARENT")&&(l=V.whereUsed.references||[],c=V.whereUsed.instances||[]),o=!0),e.is(u)&&(g=g||s.needToQueryForConnections(u),e.is(h)||(h=u.get("PID")),!e.is(d)||"STEP"!==d.get("PPRTYPE")&&"EXECHEADER"!==d.get("PPRTYPE")?r.getConnectionsByModel(d,u,{silentMode:!0,onComplete:I}):r.getConnectionsByModel(d,u,{silentMode:!0,relationTypes:["ItemSpecOcc","DELIsSerializedFromOp","AssignedWorkCenterLink"],onComplete:I}))},A=function(t){var i,r,a,l,c,d,u,f,g,p,h;for(a in h=m.getSelectedItems(),t)if(t.hasOwnProperty(a)&&M.hasOwnProperty(a)){if(l=t[a],r=M[a].pprTypeDiv,0===l.length){r.setStyle("display","none");continue}for(h.indexOf(a)>-1?r.show():r.hide(),r.addClassName("pprTypeMarg"),new e.Element("div",{class:"pprTypeTitleDiv",text:M[a].title}).inject(r),i=0;i<t[a].length;i++){if(u=n.create("Element","div",{class:"connectionDiv default"}),p=(c=t[a][i]).type,e.is(p)&&("SecondaryCandidateResourceLink"===p&&(u.className="connectionDiv secondaryRecource"),g=c.iconDirection,e.is(g)&&(-1!==p.indexOf("_inverse")?g.tooltipInfos=n.create("TooltipModel",{shortHelp:o.getNLSValue("LinksUI.BackwardIcon")}):g.tooltipInfos=n.create("TooltipModel",{shortHelp:o.getNLSValue("LinksUI.ForwardIcon")}),g.inject(u)),f=c.icon,e.is(f)&&(f.tooltipInfos=n.create("TooltipModel",{shortHelp:o.getNLSValue(p)}),f.inject(u))),(d=n.create("Element","div",{class:"connectionLabel",text:c.label,styles:{display:"inline-block"}})).tooltipInfos=n.create("TooltipModel",{shortHelp:c.label}),d.inject(u),e.is(V.reference)&&e.is(V.reference.model)){const e=V.reference.model;s.isReferencesHasReadOnlyType(e)}u.inject(r)}}},k=function(n,i,a,d,u){var f,g,p,h,m,P,I,b,L,y,E,v,R,S,C,A,k,D=c,T=e.is(i)?i.id:"",w=e.is(a)?a.id:"";for(f=0;f<n.length;f++){switch(g=(I=n[f]._attributes).type){case"DELIsSerializedFrom":g="DELLmiWorkPlanSystemReference";break;case"PartialProductImplementLink":g="CreateAssembly";break;case"ProductionPlanLink":g="DELLmiProductionPlanReference";break;case"DELIsGeneratedFromProcessFilteredBy":g="Builds";break;case"DELLmiTimeConstraintCnx":g=r.getLinkInfo(n[f]).subType;break;case"DELAsmProcessCanUseCnx":r.getSecondaryRscLinksFromPrimaryLink(n[f]).forEach((function(e){(k=e.clone()).set("from",I.from),n.splice(f+1,0,k)}));break;case"SecondaryCandidateResourceLink":if(A=r.getConnection(I.from),e.is(A)){(k=n[f].clone()).set("from",A.get("from")),n.splice(f+1,0,k),(k=n[f].clone()).set("from",A.get("to")),n.splice(f+1,0,k);continue}}if(E=I.to,!("ProcessImplementLinkOcc"===I.type&&e.is(I.from,"array")&&e.is(I.to,"array")&&e.is(V.instance.absPath))||l.isImplementLinkValidForOccPath(I.from,I.to,V.instance.absPath))if(C=e.is(I.to,"array")&&"ProcessImplementLink"===g?w===I.to[I.to.length-2]:!!e.is(I.to,"array")&&w===I.to[I.to.length-1],T===I.to||w===I.to||C?(E=I.from,L=o.getIconElem("LinkInverse")):L=o.getIconElem("Link"),v=s.getReference(E),e.is(v)||((y=e.is(E,"array")?"ProcessImplementLink"===g?s.getInstance(E[E.length-2]):s.getInstance(E[E.length-1]):s.getInstance(E))?v=s.getReference(y.get("isInstanceOf")||y.get("to")):t.debug("No linked instance !!!")),e.is(v)){if(P=v.get("type"),e.is(D[P])&&e.is(D[P].Attribute)){R=D[P].Attribute,R=e.is(R,"array")?R:[R];const t=D[P].separator||" ";e.is(y)&&"ProcessImplementLink"===g&&(e.is(I.to,"array")||y.id===I.to)?(h="("+y.get("PLM_ExternalID")+") ",h+=R.map((e=>v.get(e.name))).join(t)):h=R.map((e=>v.get(e.name))).join(t)}else h=v.get(d);if(e.is(a)&&e.is(y)&&(h=y.get("PLM_ExternalID"),e.is(D[g])&&e.is(D[g].Attribute))){R=D[g].Attribute,R=e.is(R,"array")?R:[R];const t=D[g].separator||" ";for(m="",S=0;S<R.length;S++)if(0!==S&&(m+=t),"ItemSpecOcc"!==g&&"ProcessImplementLinkOcc"!==g&&"ProcessImplementLinkOcc_inverse"!==g||"V_usage"!==R[S].name)m+=I[R[S].name];else{m+=l.getRoleFromModelOrComputed(I.PID).nlsText}h="("+m+")"+h}b=v.get("PPRTYPE"),e.is(b,"string")?("OPERATION"===b&&(b="SYSTEM"),"RESOURCE"===b&&(g=v.get("V_discipline")),g=v.get("type"),p=o.getIconElem(g),u[b].push({label:h,icon:p,iconDirection:L,pid:I.PID,linkedReferencePID:v.get("PID"),type:g})):t.debug("PPRTYPE is not available for object type:"+P)}else t.debug("No linked reference !!!")}return u},D=function(n,i,r,s,a,l){var d,u,f,g,p,h,m,P,I,b,L=c;for(d=0;d<n.length;d++){if(h=(P=n[d]).get("type"),e.is(L[h])&&e.is(L[h].Attribute))for(b=L[h].Attribute,b=e.is(b,"array")?b:[b],m=L[h].separator||" ",g="",u=0;u<b.length;u++)0!==u&&(g+=m),g+=P.get(b[u].name);else g=P.get(a);for(f=o.getIconElem(h),p="Type."+h,u=0;u<i.length;u++)if(i[u].get("isAggregatedBy")===P.get("PID")){I=i[u];break}e.is(I)?l.PARENT.push({label:g,icon:f,pid:I.get("PID"),linkedReferencePID:P.get("PID"),type:p}):t.debug("Instance of reference id:"+P.get("PID")+" not found.")}return l},P=function(t){var n,i;n=r.getConnection(t),e.is(n)?r.deleteConnection(t):(i=s.getInstance(t),e.is(i)&&s.deleteInstance([i],{askDeleteConfirmation:!1}))},I=function(n){var i,a,l,c,d,u;i=r.getConnection(n),a=!(Array.isArray(i.get("to"))||!e.is(s.getInstance(i.get("to")))),e.is(i)&&(Array.isArray(i.get("to"))?(u=!0,l=i.get("to")[i.get("to").length-1],c=i.get("to")[i.get("to").length-2],l&&c&&v(i.get("from"),l,c,u,i)):a?(u=!0,l=s.getInstance(i.get("to")).get("isInstanceOf"),c=i.get("to"),l&&c&&v(i.get("from"),l,c,u,i)):(u=!1,l=i.get("to"),0!==(d=s.getParentInstancesFromCollection(l)).length?d.length>1?R(d,(function(e){e&&(c=e.get("PID"),l&&c&&r.switchScope(i.get("from"),l,c,u,i))})):d[0].get("isInstanceOf")===l&&(c=d[0].get("PID"),l&&c&&r.switchScope(i.get("from"),l,c,u,i)):t.warn(o.getNLSValue("LinksUI.SwitchScopeCallback.Warn"))))},function(i){var l,c,d,g,p,h,m,b=[],L=this.getData("pid"),y=this.getData("linkedReferencePID"),E=s.getReference(y),v=E.get("PPRTYPE"),R=i.currentTarget.getOffsets().x,S=i.currentTarget.getOffsets().y+25;c=e.is(r.getConnection(L)),d={icon:"url("+o.getIconURLFromKey("GeneralDelete")+")",label:o.getNLSValue("LinksUI.DeleteLink"),sensitivity:c?r.canDeleteRelation(L)?"enabled":"disabled":"enabled",callback:function(){P(L)}},g={icon:"url("+o.getIconURLFromKey("SwitchScope")+")",label:o.getNLSValue("LinksUI.SwitchScope"),sensitivity:"enabled",callback:function(){I(L)}},l={icon:"url("+o.getIconURLFromKey("EditAttribute")+")",label:o.getNLSValue("LinksUI.EditAttribute"),sensitivity:a.hasEditConfiguration(L)?"enabled":"disabled",callback:function(){a.editConfiguredAttributes(L)}},p={icon:"url("+o.getIconURLFromKey("showAuxiliaryView")+")",label:o.getNLSValue("LinksUI.ShowInAuxiliaryView"),sensitivity:"enabled",callback:function(){t.notify("addToAuxiliaryView",E)}},Object.keys(u).indexOf(v)>-1&&(h={icon:"url("+o.getIconURLFromKey(u[v].icon)+")",label:o.getNLSValue("LinksUI.ShowInNaturalView",{view:o.getNLSValue(u[v].view)}),sensitivity:"enabled",callback:function(){t.notify("addReference",[E,null,{withLinksResolved:!0}])}}),m={icon:"url("+o.getIconURLFromKey("ExploreInWebApp")+")",label:o.getNLSValue("ExploreInWebApp",null,"Cmd","Title"),sensitivity:"enabled",callback:function(){t.notify("ExploreInWebApp",[[{referencePID:y}]])}},e.is(r.getConnection(L))?(b.push(d),b.push(l)):e.is(V.reference.model)&&"PRODUCT"!==V.reference.model.get("PPRTYPE")&&b.push(d),"Installation"!==E.get("V_discipline")&&"Transform"!==E.get("V_discipline")||b.push(g),b.push(p),e.is(h,"object")&&b.push(h),r.isExploreWebAppEnabled()&&f&&b.push(m),n.getComponent("ContextualMenuManager").show({nodes:b},[R,S])},T=function(){var e;for(e in M)M.hasOwnProperty(e)&&("PARENT"===e?m.unselectItem(e,!0):m.selectItem(e,!0))},w=function(){Object.values(M).forEach((function(e){e.pprTypeDiv.empty()}))},{init:function(t){U=e.extend(U,t),c=t.relAttributeConfig,d=e.is(t.relatedCmdId)?t.relatedCmdId:null,u=e.is(t.acceptedTypes)?t.acceptedTypes:null,f=!e.is(t.exploreInWebApp)||t.exploreInWebApp,g=e.is(t.filterToolbarSections)?t.filterToolbarSections:null,Array.isArray(g)?g.forEach((function(e){M[e]={title:o.getNLSValue("PPRTYPE."+e)}})):M={PRODUCT:{title:o.getNLSValue("PPRTYPE.PRODUCT")},PROCESS:{title:o.getNLSValue("PPRTYPE.PROCESS")},PPLAN:{title:o.getNLSValue("PPRTYPE.PPLAN")},BUILDS:{title:o.getNLSValue("PPRTYPE.BUILDS")},SYSTEM:{title:o.getNLSValue("PPRTYPE.SYSTEM")},RESOURCE:{title:o.getNLSValue("PPRTYPE.RESOURCE")},PART:{title:o.getNLSValue("PPRTYPE.PART")},SERVICE:{title:o.getNLSValue("PPRTYPE.SERVICE")},PARENT:{title:o.getNLSValue("PPRTYPE.PARENT")}},L()},destroy:function(){this.isActive()&&S(),e.is(N)&&(N.destroy(),N=void 0)},showModal:function(t){V=e.extend(V,t),C(),N.show(),b(),N.content=h},isActive:function(){return!!e.is(N)&&N.visibleFlag},clear:function(){V={title:"",reference:{model:null},instance:{model:null,absPath:""},whereUsed:{isFetched:!1,references:[],instances:[]}},b(),w()},hideUI:function(){N.hide()},updateWhereUsed:function(t){var n,i,o=-1;if(e.is(t)&&(n=t.isInstance()?t.get("isAggregatedBy"):t.get("PID"),e.is(V.whereUsed.references,"array"))){for(i=0;i<V.whereUsed.references.length;++i)if(V.whereUsed.references[i].id===n){o=i;break}-1!==o?V.whereUsed.references.splice(o,1):t.isInstance()&&(V.whereUsed.instances.push(t),V.whereUsed.references.push(s.getReference(n))),C()}},getCurrentModel:function(){return V},updateTitle:function(e){V.title=e,b()},resetFilter:function(){T()}}}})),define("DS/DELWKOLinksModule/DELWKOLinksUI",["UWA/Core"],(function(e){"use strict";return function(t,n,o,r,s,a,l){var c,d,u,f,g,p,h,m,P,I,b,L,y,E,v,R,S,C,A,k,D,T,w,U={className:"Links MGA-linksUIContainer disableContentselection"},O=o.getNLSValue("LinksUI.PanelTitle"),M={},N=null,V={title:"",labelAttribute:"V_Name",reference:{model:null},instance:{model:null,absPath:""},whereUsed:{isFetched:!1,references:[],instances:[]}};return b=function(){e.is(N)&&(N.title=O+V.title)},L=function(){var i,o,r,s,a=n.getComponent("WUXFrameWindowsManager").getFrameWindow(t.getAppContext());(N=n.create("Panel",{position:{my:"center",at:"center"},domId:"RelationsPanel",immersiveFrame:a.getImmersiveFrame(),resizableFlag:!0,visibleFlag:!1})).close=function(){e.is(d)?t.notify("toggleCmdCheckHeaderState",{cmdName:d,cmdState:!1}):S()},h=n.create("Element","div",{class:U.className}),i=n.create("Element","div",{class:"linksPanel-Container"}),o=n.create("Element","div",{class:"module-messages"}),r=y(),s=E(),o.inject(i),r.inject(i),s.inject(i),i.inject(h)},y=function(){var t;return t=n.create("Element","div",{class:"linkView-toolbar"}),(m=n.create("Filter",{filterToolbarSections:g})).inject(t),m.addEvent("onChange",(function(t,n){var i,o;for(i in o=this.getSelectedItems(),M)M.hasOwnProperty(i)&&(-1===o.indexOf(i)?M[i].pprTypeDiv.hide():(e.is(t,"string")&&"PARENT"===t&&!0===n&&!1===V.whereUsed.isFetched&&C(),M[i].pprTypeDiv.show()))})),t},E=function(){var t,i;for(i in t=n.create("Element","div",{class:"LinksUI-menuDiv"}),(p=n.create("WUXLoader")).inject(t),M)M.hasOwnProperty(i)&&(M[i].pprTypeDiv=new e.Element("div",{class:"pprTypeDiv"}).inject(t));return t},v=function(t,i,s,a,l){var c,d=o.getNLSValue("LinksUI.ConfirmationDialog.Header"),u=o.getNLSValue("LinksUI.ConfirmationDialog.Text");c=function(n){e.is(n,"boolean")&&n&&r.switchScope(t,i,s,a,l)},n.showConfirmation(d,u,null,c)},R=function(t,r){var s,a,l=n.createElement("div",{class:"selectInstance-dialog-container"}),c=[],d=n.getComponent("ComboBox"),u=n.getComponent("Button"),f=o.getNLSValue("LinksUI.SelectInstanceDialog.Header");for(i=0;i<t.length;i++)c.push({label:t[i].get("PLM_ExternalID"),value:t[i]});(a=new d({elementsList:c,enableSearchFlag:!1,actionOnClickFlag:!1})).inject(l),(s=n.create("Dialog",{domId:"selectInstance-dialog",title:f,content:l,resizableFlag:!0,modalFlag:!0,width:400,minWidth:290,buttons:{Cancel:new u({onClick:function(){s.close()}}),Ok:new u({disabled:!1,emphasize:"primary",onClick:function(){s.close(),e.is(r,"function")&&r(a.currentValue)}})}})).close=function(){this.destroy()}},S=function(){N.hide()},C=function(){var n,i=!1,o=!1,r=[],a=[],l=[],c=V.reference.model,d=V.instance.model,u=V.labelAttribute,f=function(){var e,n,s,f;i&&o&&(e=r,n=a,s=l,f={WORKORDER:[],EXECHEADER:[],STEP:[],PRODUCT:[],PPLAN:[],BUILDS:[],PROCESS:[],SYSTEM:[],RESOURCE:[],PART:[],PARENT:[],SERVICE:[]},w(),f=k(e,c,d,u,f),f=D(n,s,c,d,u,f),A(f),p.hide(),t.notify("RelationsPanelLoaded"))};n=m.getSelectedItems(),!0!==V.whereUsed.isFetched?e.is(c)?(s.getWhereUsedReferences(c,(function(t,n){o=!0,e.is(V.whereUsed)&&(V.whereUsed.isFetched=!0,V.whereUsed.references=t,V.whereUsed.instances=n),a=t,l=n,f()}),(function(e){i=!0,r=e,f()})),V.whereUsed.isFetched=!0):o=!0:(e.is(c)&&-1!==n.indexOf("PARENT")&&(a=V.whereUsed.references||[],l=V.whereUsed.instances||[]),o=!0)},A=function(t){var i,r,a,l,c,d,u,f,g,p,h;for(a in h=m.getSelectedItems(),t)if(t.hasOwnProperty(a)&&M.hasOwnProperty(a)){if(l=t[a],r=M[a].pprTypeDiv,0===l.length){r.setStyle("display","none");continue}for(h.indexOf(a)>-1?r.show():r.hide(),r.addClassName("pprTypeMarg"),new e.Element("div",{class:"pprTypeTitleDiv",text:M[a].title}).inject(r),i=0;i<t[a].length;i++){if(u=n.create("Element","div",{class:"connectionDiv default"}),p=(c=t[a][i]).type,e.is(p)&&("SecondaryCandidateResourceLink"===p&&(u.className="connectionDiv secondaryRecource"),g=c.iconDirection,e.is(g)&&(-1!==p.indexOf("_inverse")?g.tooltipInfos=n.create("TooltipModel",{shortHelp:o.getNLSValue("LinksUI.BackwardIcon")}):g.tooltipInfos=n.create("TooltipModel",{shortHelp:o.getNLSValue("LinksUI.ForwardIcon")}),g.inject(u)),f=c.icon,e.is(f)&&(f.tooltipInfos=n.create("TooltipModel",{shortHelp:o.getNLSValue(p)}),f.inject(u))),(d=n.create("Element","div",{class:"connectionLabel",text:c.label,styles:{display:"inline-block"}})).tooltipInfos=n.create("TooltipModel",{shortHelp:c.label}),d.inject(u),e.is(V.reference)&&e.is(V.reference.model)){const e=V.reference.model;s.isReferencesHasReadOnlyType(e)}u.inject(r)}}},k=function(n,i,a,d,u){var f,g,p,h,m,P,I,b,L,y,E,v,R,S,C,A=c,k=e.is(i)?i.id:"",D=e.is(a)?a.id:"";for(f=0;f<n.length;f++){switch(g=(P=n[f]._attributes).type){case"DELIsSerializedFrom":g="DELLmiWorkPlanSystemReference";break;case"PartialProductImplementLink":g="CreateAssembly";break;case"ProductionPlanLink":g="DELLmiProductionPlanReference";break;case"DELIsGeneratedFromProcessFilteredBy":g="Builds";break;case"DELLmiTimeConstraintCnx":g=r.getLinkInfo(n[f]).subType;break;case"DELAsmProcessCanUseCnx":r.getSecondaryRscLinksFromPrimaryLink(n[f]).forEach((function(e){(C=e.clone()).set("from",P.from),n.splice(f+1,0,C)}));break;case"SecondaryCandidateResourceLink":if(S=r.getConnection(P.from),e.is(S)){(C=n[f].clone()).set("from",S.get("from")),n.splice(f+1,0,C),(C=n[f].clone()).set("from",S.get("to")),n.splice(f+1,0,C);continue}}if(y=P.to,!("ProcessImplementLinkOcc"===P.type&&e.is(P.from,"array")&&e.is(P.to,"array")&&e.is(V.instance.absPath))||l.isImplementLinkValidForOccPath(P.from,P.to,V.instance.absPath))if(R=e.is(P.to,"array")&&"ProcessImplementLink"===g?D===P.to[P.to.length-2]:!!e.is(P.to,"array")&&D===P.to[P.to.length-1],k===P.to||D===P.to||R?(y=P.from,b=o.getIconElem("LinkInverse")):b=o.getIconElem("Link"),E=s.getReference(y),e.is(E)||((L=e.is(y,"array")?"ProcessImplementLink"===g?s.getInstance(y[y.length-2]):s.getInstance(y[y.length-1]):s.getInstance(y))?E=s.getReference(L.get("isInstanceOf")||L.get("to")):t.debug("No linked instance !!!")),e.is(E)){if(m=E.get("type"),e.is(A[m])&&e.is(A[m].Attribute)){v=A[m].Attribute,v=e.is(v,"array")?v:[v];const t=A[m].separator||" ";e.is(L)&&"ProcessImplementLink"===g&&(e.is(P.to,"array")||L.id===P.to)?(h="("+L.get("PLM_ExternalID")+") ",h+=v.map((e=>E.get(e.name))).join(t)):h=v.map((e=>E.get(e.name))).join(t)}else h=E.get(d);I=E.get("PPRTYPE"),e.is(I,"string")?("OPERATION"===I&&(I="SYSTEM"),"RESOURCE"===I&&(g=E.get("V_discipline")),p=o.getIconElem(g),u[I].push({label:h,icon:p,iconDirection:b,pid:P.PID,linkedReferencePID:E.get("PID"),type:g})):t.debug("PPRTYPE is not available for object type:"+m)}else t.debug("No linked reference !!!")}return u},D=function(n,i,r,s,a,l){var d,u,f,g,p,h,m,P,I,b,L=c;for(d=0;d<n.length;d++){if(h=(P=n[d]).get("type"),e.is(L[h])&&e.is(L[h].Attribute))for(b=L[h].Attribute,b=e.is(b,"array")?b:[b],m=L[h].separator||" ",g="",u=0;u<b.length;u++)0!==u&&(g+=m),g+=P.get(b[u].name);else g=P.get(a);for(f=o.getIconElem(h),p="Type."+h,u=0;u<i.length;u++)if(i[u].get("isAggregatedBy")===P.get("PID")){I=i[u];break}e.is(I)?l.PARENT.push({label:g,icon:f,pid:I.get("PID"),linkedReferencePID:P.get("PID"),type:p}):t.debug("Instance of reference id:"+P.get("PID")+" not found.")}return l},P=function(t){var n,i;n=r.getConnection(t),e.is(n)?r.deleteConnection(t):(i=s.getInstance(t),e.is(i)&&s.deleteInstance([i],{askDeleteConfirmation:!1}))},I=function(n){var i,a,l,c,d,u;i=r.getConnection(n),a=!(Array.isArray(i.get("to"))||!e.is(s.getInstance(i.get("to")))),e.is(i)&&(Array.isArray(i.get("to"))?(u=!0,l=i.get("to")[i.get("to").length-1],c=i.get("to")[i.get("to").length-2],l&&c&&v(i.get("from"),l,c,u,i)):a?(u=!0,l=s.getInstance(i.get("to")).get("isInstanceOf"),c=i.get("to"),l&&c&&v(i.get("from"),l,c,u,i)):(u=!1,l=i.get("to"),0!==(d=s.getParentInstancesFromCollection(l)).length?d.length>1?R(d,(function(e){e&&(c=e.get("PID"),l&&c&&r.switchScope(i.get("from"),l,c,u,i))})):d[0].get("isInstanceOf")===l&&(c=d[0].get("PID"),l&&c&&r.switchScope(i.get("from"),l,c,u,i)):t.warn(o.getNLSValue("LinksUI.SwitchScopeCallback.Warn"))))},function(i){var l,c,d,g,p,h,m,b=[],L=this.getData("pid"),y=this.getData("linkedReferencePID"),E=s.getReference(y),v=E.get("PPRTYPE"),R=i.currentTarget.getOffsets().x,S=i.currentTarget.getOffsets().y+25;c=e.is(r.getConnection(L)),d={icon:"url("+o.getIconURLFromKey("GeneralDelete")+")",label:o.getNLSValue("LinksUI.DeleteLink"),sensitivity:c?r.canDeleteRelation(L)?"enabled":"disabled":"enabled",callback:function(){P(L)}},g={icon:"url("+o.getIconURLFromKey("SwitchScope")+")",label:o.getNLSValue("LinksUI.SwitchScope"),sensitivity:"enabled",callback:function(){I(L)}},l={icon:"url("+o.getIconURLFromKey("EditAttribute")+")",label:o.getNLSValue("LinksUI.EditAttribute"),sensitivity:a.hasEditConfiguration(L)?"enabled":"disabled",callback:function(){a.editConfiguredAttributes(L)}},p={icon:"url("+o.getIconURLFromKey("showAuxiliaryView")+")",label:o.getNLSValue("LinksUI.ShowInAuxiliaryView"),sensitivity:"enabled",callback:function(){t.notify("addToAuxiliaryView",E)}},Object.keys(u).indexOf(v)>-1&&(h={icon:"url("+o.getIconURLFromKey(u[v].icon)+")",label:o.getNLSValue("LinksUI.ShowInNaturalView",{view:o.getNLSValue(u[v].view)}),sensitivity:"enabled",callback:function(){t.notify("addReference",[E,null,{withLinksResolved:!0}])}}),m={icon:"url("+o.getIconURLFromKey("ExploreInWebApp")+")",label:o.getNLSValue("ExploreInWebApp",null,"Cmd","Title"),sensitivity:"enabled",callback:function(){t.notify("ExploreInWebApp",[[{referencePID:y}]])}},e.is(r.getConnection(L))?(b.push(d),b.push(l)):e.is(V.reference.model)&&"PRODUCT"!==V.reference.model.get("PPRTYPE")&&b.push(d),"Installation"!==E.get("V_discipline")&&"Transform"!==E.get("V_discipline")||b.push(g),b.push(p),e.is(h,"object")&&b.push(h),r.isExploreWebAppEnabled()&&f&&b.push(m),n.getComponent("ContextualMenuManager").show({nodes:b},[R,S])},T=function(){var e;for(e in M)M.hasOwnProperty(e)&&("PARENT"===e?m.unselectItem(e,!0):m.selectItem(e,!0))},w=function(){Object.values(M).forEach((function(e){e.pprTypeDiv.empty()}))},{init:function(t){U=e.extend(U,t),c=t.relAttributeConfig,d=e.is(t.relatedCmdId)?t.relatedCmdId:null,u=e.is(t.acceptedTypes)?t.acceptedTypes:null,f=!e.is(t.exploreInWebApp)||t.exploreInWebApp,g=e.is(t.filterToolbarSections)?t.filterToolbarSections:null,Array.isArray(g)?g.forEach((function(e){M[e]={title:o.getNLSValue("PPRTYPE."+e)}})):M={PRODUCT:{title:o.getNLSValue("PPRTYPE.PRODUCT")},PROCESS:{title:o.getNLSValue("PPRTYPE.PROCESS")},PPLAN:{title:o.getNLSValue("PPRTYPE.PPLAN")},BUILDS:{title:o.getNLSValue("PPRTYPE.BUILDS")},SYSTEM:{title:o.getNLSValue("PPRTYPE.SYSTEM")},RESOURCE:{title:o.getNLSValue("PPRTYPE.RESOURCE")},PART:{title:o.getNLSValue("PPRTYPE.PART")},SERVICE:{title:o.getNLSValue("PPRTYPE.SERVICE")},PARENT:{title:o.getNLSValue("PPRTYPE.PARENT")}},L()},destroy:function(){this.isActive()&&S(),e.is(N)&&(N.destroy(),N=void 0)},showModal:function(t){V=e.extend(V,t),C(),N.show(),b(),N.content=h},isActive:function(){return!!e.is(N)&&N.visibleFlag},clear:function(){V={title:"",reference:{model:null},instance:{model:null,absPath:""},whereUsed:{isFetched:!1,references:[],instances:[]}},b(),w()},hideUI:function(){N.hide()},updateWhereUsed:function(t){var n,i,o=-1;if(e.is(t)&&(n=t.isInstance()?t.get("isAggregatedBy"):t.get("PID"),e.is(V.whereUsed.references,"array"))){for(i=0;i<V.whereUsed.references.length;++i)if(V.whereUsed.references[i].id===n){o=i;break}-1!==o?V.whereUsed.references.splice(o,1):t.isInstance()&&(V.whereUsed.instances.push(t),V.whereUsed.references.push(s.getReference(n))),C()}},getCurrentModel:function(){return V},updateTitle:function(e){V.title=e,b()},resetFilter:function(){T()}}}})),define("DS/DELWKOLinksModule/DELWKOLinks",["UWA/Core","DS/DELWKOLinksModule/DELWKOLinksUI"],(function(e,t){"use strict";return{behaviors:["UXFactoryBehavior","ResourceBehavior","SelectionBehavior","LinkBehavior","ModelBehavior","EditAttributeBehavior","ImplementBehavior","ProductFlowLinkBehavior"],creator:function(n,i,o,r,s,a,l,c){var d,u,f,g,p,h,m,P=null,I="V_Name";return g=function(t,n){s.getXMLValues(d.relationsDialogDisplayAttributeConfigXML,(function(n){var i=n.convert("DisplayAttributeDescriptionList.Type","name")||{},o=n.convert("DisplayAttributeDescriptionList.Relation","linkName")||{};u=e.merge(i,o),t()}),(function(e){n(e)}))},p=function(t){var n=!1,i=P.getCurrentModel(),o=e.is(i.reference.model)?i.reference.model.id:"",r=e.is(i.instance.model)?i.instance.model.id:"";return t!==o&&t!==r||(n=!0),n},h=function(t){var i={instModel:{},refModel:{},absPath:""},o=t.id?t.id:t.instancePID,r=t.id?t.id:t.referencePID;return i.instModel=a.getInstance(o),e.is(i.instModel)?(i.absPath=t.path?t.path:t.absPath,i.refModel=a.getReferenceModelFromInstance(i.instModel)):(i.refModel=a.getReference(r),e.is(i.refModel)||n.debug("Object with reference PID:"+o+" and instance PID:"+r+" not found.")),i},f=function(t){var n,i,o,s,a={title:"",reference:{model:null},instance:{model:null,absPath:""},whereUsed:{isFetched:!1,references:[],instances:[]}};return e.is(t)?(n=h(t),i=n.refModel,o=n.instModel,s=n.absPath):1===r.getSelectedNodesCount()&&r.getSelectionsWithPaths().forEach((function(t){e.is(t)&&1===t.length&&t.forEach((function(e){n=h(e),i=n.refModel,o=n.instModel,s=n.absPath}))})),a.title=e.is(i)?i.get(I):"",a.reference.model=i,a.instance.model=o,a.instance.absPath=s,a},m=function(){P.isActive()&&(P.resetFilter(),P.showModal(f()))},{name:"LinksModule",listenTo:function(){return{select:this.onSelect,Relations:this.onShowRelations,addInstance:this.onAddInstance,addConnection:this.onAddConnections,removeConnection:this.onRemoveConnections,removeReference:this.onRemoveRefOrInst,changeReference:this.onChangeRefOrInst,removeInstance:this.onRemoveRefOrInst,refreshImpacted:this.relaodUI,changeConnection:this.relaodUI}},onStart:function(r,p){if(d=r||{},!e.is(d.relationsDialogDisplayAttributeConfigXML))return n.debug("LinksModule loading failed : relationsDialogDisplayAttributeConfigXML options are undefined"),void p();Promise.all([new Promise(g.bind(this))]).then((function(){(P=new t(n,i,o,s,a,l,c)).init({relAttributeConfig:u,relatedCmdId:d.relatedCmdId,acceptedTypes:d.pprTypes,exploreInWebApp:d.exploreInWebApp,filterToolbarSections:d.filterToolbarSections}),P.showModal(f(d.node)),p()}),(function(e){n.debug("LinksModule loading failed :"+e),p()}))},onStop:function(){P.destroy(),P=void 0},onRemoveRefOrInst:function(t){(t=Array.isArray(t)?t:[t]).forEach((function(t){e.is(t)&&P.isActive()&&(p(t.id)?P.clear():P.updateWhereUsed(t))}))},onChangeRefOrInst:function(t){var n;(t=Array.isArray(t)?t:[t]).forEach((function(t){P.isActive()&&e.is(t)&&t.isReference()&&p(t.id)&&(n=t.changedAttributes(),e.is(n)&&n.hasOwnProperty(I)&&P.updateTitle(n[I]))}))},onShowRelations:function(t){var n;n=e.is(t)?e.is(t,"array")?t[0]:t:null,e.is(n)&&P.isActive()&&P.showModal(f(n))},onSelect:function(){m()},onAddConnections:function(t){var n,i,o;P.isActive()&&(o=function(t){return!!(e.is(t)&&(n=t.getAttribute("from"),i=t.getAttribute("to"),p(n)&&p(i)))},(e.is(t,"array")?t.some(o):o(t))&&P.showModal(P.getCurrentModel()))},onRemoveConnections:function(t){var n,i,o;P.isActive()&&(o=function(t){var o,r,a,l;if(e.is(t))if(n=t.getAttribute("from"),i=t.getAttribute("to"),"SecondaryCandidateResourceLink"===t.get("type")){if(o=s.getConnection(n),!e.is(o))return!1;if(r=o.getAttribute("from"),a=o.getAttribute("to"),l=i,p(r)||p(a)||p(l))return!0}else if(p(n)||p(i))return!0;return!1},(e.is(t,"array")?t.some(o):o(t))&&P.showModal(P.getCurrentModel()))},onAddInstance:function(t){e.is(t)&&P.isActive()&&p(t.get("isInstanceOf"))&&P.updateWhereUsed(t)},relaodUI:function(){m()}}}}})),define("DS/DELWKOLinksModule/DELWKOLinksCloud",["UWA/Core","DS/DELWKOLinksModule/DELWKOLinksUICloud"],(function(e,t){"use strict";return{behaviors:["UXFactoryBehavior","ResourceBehavior","SelectionBehavior","LinkBehavior","ModelBehavior","EditAttributeBehavior","ImplementBehavior","ProductFlowLinkBehavior"],creator:function(n,i,o,r,s,a,l,c){var d,u,f,g,p,h,m,P=null,I="V_Name";return g=function(t,n){s.getXMLValues(d.relationsDialogDisplayAttributeConfigXML,(function(n){var i=n.convert("DisplayAttributeDescriptionList.Type","name")||{},o=n.convert("DisplayAttributeDescriptionList.Relation","linkName")||{};u=e.merge(i,o),t()}),(function(e){n(e)}))},p=function(t){var n=!1,i=P.getCurrentModel(),o=e.is(i.reference.model)?i.reference.model.id:"",r=e.is(i.instance.model)?i.instance.model.id:"";return t!==o&&t!==r||(n=!0),n},h=function(t){var i={instModel:{},refModel:{},absPath:""},o=t.id?t.id:t.instancePID,r=t.id?t.id:t.referencePID;return i.instModel=a.getInstance(o),e.is(i.instModel)?(i.absPath=t.path?t.path:t.absPath,i.refModel=a.getReferenceModelFromInstance(i.instModel)):(i.refModel=a.getReference(r),e.is(i.refModel)||n.debug("Object with reference PID:"+o+" and instance PID:"+r+" not found.")),i},f=function(t){var n,i,o,s,a={title:"",reference:{model:null},instance:{model:null,absPath:""},whereUsed:{isFetched:!1,references:[],instances:[]}};return e.is(t)?(n=h(t),i=n.refModel,o=n.instModel,s=n.absPath):1===r.getSelectedNodesCount()&&r.getSelectionsWithPaths().forEach((function(t){e.is(t)&&1===t.length&&t.forEach((function(e){n=h(e),i=n.refModel,o=n.instModel,s=n.absPath}))})),a.title=e.is(i)?i.get(I):"",a.reference.model=i,a.instance.model=o,a.instance.absPath=s,a},m=function(){P.isActive()&&(P.resetFilter(),P.showModal(f()))},{name:"LinksModule",listenTo:function(){return{select:this.onSelect,Relations:this.onShowRelations,addInstance:this.onAddInstance,addConnection:this.onAddConnections,removeConnection:this.onRemoveConnections,removeReference:this.onRemoveRefOrInst,changeReference:this.onChangeRefOrInst,removeInstance:this.onRemoveRefOrInst,refreshImpacted:this.relaodUI,changeConnection:this.relaodUI}},onStart:function(r,p){if(d=r||{},!e.is(d.relationsDialogDisplayAttributeConfigXML))return n.debug("LinksModule loading failed : relationsDialogDisplayAttributeConfigXML options are undefined"),void p();Promise.all([new Promise(g.bind(this))]).then((function(){(P=new t(n,i,o,s,a,l,c)).init({relAttributeConfig:u,relatedCmdId:d.relatedCmdId,acceptedTypes:d.pprTypes,exploreInWebApp:d.exploreInWebApp,filterToolbarSections:d.filterToolbarSections}),P.showModal(f(d.node)),p()}),(function(e){n.debug("LinksModule loading failed :"+e),p()}))},onStop:function(){P.destroy(),P=void 0},onRemoveRefOrInst:function(t){(t=Array.isArray(t)?t:[t]).forEach((function(t){e.is(t)&&P.isActive()&&(p(t.id)?P.clear():P.updateWhereUsed(t))}))},onChangeRefOrInst:function(t){var n;(t=Array.isArray(t)?t:[t]).forEach((function(t){P.isActive()&&e.is(t)&&t.isReference()&&p(t.id)&&(n=t.changedAttributes(),e.is(n)&&n.hasOwnProperty(I)&&P.updateTitle(n[I]))}))},onShowRelations:function(t){var n;n=e.is(t)?e.is(t,"array")?t[0]:t:null,e.is(n)&&P.isActive()&&P.showModal(f(n))},onSelect:function(){m()},onAddConnections:function(t){var n,i,o;P.isActive()&&(o=function(t){return!!(e.is(t)&&(n=t.getAttribute("from"),i=t.getAttribute("to"),p(n)&&p(i)))},(e.is(t,"array")?t.some(o):o(t))&&P.showModal(P.getCurrentModel()))},onRemoveConnections:function(t){var n,i,o;P.isActive()&&(o=function(t){var o,r,a,l;if(e.is(t))if(n=t.getAttribute("from"),i=t.getAttribute("to"),"SecondaryCandidateResourceLink"===t.get("type")){if(o=s.getConnection(n),!e.is(o))return!1;if(r=o.getAttribute("from"),a=o.getAttribute("to"),l=i,p(r)||p(a)||p(l))return!0}else if(p(n)||p(i))return!0;return!1},(e.is(t,"array")?t.some(o):o(t))&&P.showModal(P.getCurrentModel()))},onAddInstance:function(t){e.is(t)&&P.isActive()&&p(t.get("isInstanceOf"))&&P.updateWhereUsed(t)},relaodUI:function(){m()}}}}}));