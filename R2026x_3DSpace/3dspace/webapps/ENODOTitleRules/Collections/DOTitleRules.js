define("DS/ENODOTitleRules/Collections/DOTitleRules",["UWA/Class/Collection","DS/ENODOTitleRules/Models/DOTitleRule","DS/ENODerivedFormatEssentials/Utils/DerivedFormatUtil"],(function(e,t,a){return e.extend({url:"/resources/v1/modeler/conversionAdmin/derivedformatmanagement/derivedoutputtitlerule",model:t,init:function(){this._parent.apply(this,arguments)},fetch:function(e){var t=this;a.maskTitleTabView();var r={url:t.url,onComplete:function(e){t.postAjaxProcess(t,e)},onFailure:function(e){t.postAjaxProcess(t,e)},method:"GET"};a.sendServerRequest(r)},postAjaxProcess:function(e,r){r.dotitlerules?(e.add(new t),r.dotitlerules.forEach((function(a,r){var i=new t(a);e.add(i)})),a.unmaskTitleTabView()):r.error&&(derivedformatmanagementinfra.servererror=!0,a.unmaskTitleTabView(),a.alert().add({className:"error",message:derivedformatmanagementinfra.getNLSData()?derivedformatmanagementinfra.getNLSData().label.serverError:"Server Error"}))},setToBeDeleted:function(e){var t=this;e&&e.length>0&&e.forEach((function(e,a){var r=t.get(e);r.set("action","deleted"),t.add(r)}))},applyRules:function(){var e=this;a.maskTitleTabView();var t=[],r=[];if(e.length>0){for(idx=0;idx<e.length;idx++){var i=e._models[idx],s=i.get("action");t.push(i._attributes),"deployed"!=s&&r.push(i)}var n={method:"POST",url:e.url,data:{dotitlerules:t},onComplete:function(t){e.postApplyProcess(e,t,r)},onFailure:function(e){a.unmaskTitleTabView(),a.alert().add({className:"error",message:derivedformatmanagementinfra.getNLSData().label.applyFailure})}};a.sendServerRequest(n)}},postApplyProcess:function(e,r,i){e.remove(i),r.dotitlerules&&r.dotitlerules.forEach((function(a,r){var i=new t(a);e.add(i)})),a.unmaskTitleTabView(),a.alert().add({className:"success",message:derivedformatmanagementinfra.getNLSData().label.applySuccess})}})}));