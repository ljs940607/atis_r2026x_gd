define("DS/XCADSTLDocument/STLTessellatedRepresentation",["DS/XCADInputDocuments/XCADTessellatedRepresentation","DS/XCADInputDocuments/XCADRepresentation","DS/XCADInputDocuments/XCADFaceData"],(function(e,t,n){"use strict";var r={TESSELLATED_SOLID:e.KindOfNode.NOD_SolidNode,TRIANGULATED_FACE:e.KindOfNode.NOD_GP},o={TRIANGULATED_FACE:e.KindOfGP.GP_Face};return e.extend((function(e,n){this._associatedDocument=e,this._representationType=t.XCAD_TESSELLATED_REPRESENTATION,this._stlRepresentationIndex=n,this._rootNodes=[],this._rootNodes.push("root0")}),{getChild:function(e,t){return"child0"},getChildren:function(e){var t=[];return t.push("child0"),t},getChildCount:function(e){return 1},getCircleData:function(e){throw"Error: not implemented method"},getConeData:function(e){throw"Error: not implemented method"},getCoordinateSystem:function(e){throw"Error: not implemented method"},getCylinderData:function(e){throw"Error: not implemented method"},getEdgeData:function(e){throw"Error: not implemented method"},getFaceData:function(e){var t=new n;return t.vertices=this._associatedDocument.vertices,t.normals=this._associatedDocument.normals,t},getGPType:function(e){return o.TRIANGULATED_FACE},getNodeBoundingSphere:function(e){throw"Error: not implemented method"},getNodeColor:function(e){return[.825,.825,1]},getNodeOrientationMatrix:function(e){throw"Error: not implemented method"},getNodeType:function(e){return"root0"===e?r.TESSELLATED_SOLID:r.TRIANGULATED_FACE},getNodeUID:function(e){throw"Error: not implemented method"},getPlaneData:function(e){throw"Error: not implemented method"},getPointData:function(e){throw"Error: not implemented method"},getPolyLineData:function(e){throw"Error: not implemented method"},getRootNode:function(e){return this._rootNodes[e]},getRootNodesCount:function(){return this._rootNodes.length},getSAG:function(e){throw"Error: not implemented method"},getSphereData:function(e){throw"Error: not implemented method"},isIndexed:function(){return!1}})})),define("DS/XCADSTLDocument/STLInputDocument",["DS/XCADInputDocuments/XCADInputDocument","DS/XCADInputDocuments/XCADRepresentation","DS/XCADSTLDocument/STLTessellatedRepresentation"],(function(e,t,n){"use strict";t.XCAD_TESSELLATED_REPRESENTATION;return e.extend((function(){this.vertices=[],this.normals=[],this.singleTrianglesIndices=[],this.percentBetweenEachProgressCB=20}),{zipped:!1,requestResponseType:"arraybuffer",close:function(){this.vertices=null,this.normals=null,this.singleTrianglesIndices=null},getRepresentation:function(e){var r;return e===t.XCAD_TESSELLATED_REPRESENTATION&&(r=new n(this,"ascii")),r},initialize:function(e){if(""!==e){var t=(new Date).getTime(),n=this._ensureArrayBuffer(e),r=((new Date).getTime(),(new Date).getTime());if(this._isStlBinary(n)){(new Date).getTime()-r;var o=(new Date).getTime();this._parseBinary(n),(new Date).getTime()-o}else{(new Date).getTime()-r;var i=(new Date).getTime(),a=this._ensureString(e);(new Date).getTime()-i;var s=(new Date).getTime();this._parseASCII(a),(new Date).getTime()-s}}},_isStlBinary:function(e){new DataView(e);for(var t=e.slice(0,123),n=new Uint8Array(t),r="",o=0;o<n.length;o++)r+=String.fromCharCode(n[o]);var i=r.match(/solid/i),a=r.match(/facet/i);return!i||-1===i||!a||-1===a},_ensureString:function(e){if("string"!=typeof e){new Map,new WeakMap;var t=65536,n=e.byteLength;if(n<t)return String.fromCharCode.apply(null,new Uint8Array(e));for(var r=0,o="";r<n;)o+=String.fromCharCode.apply(null,new Uint8Array(e.slice(r,r+t))),r+=t;return o}return e},_ensureArrayBuffer:function(e){if("string"==typeof e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer||t}return e},_parseASCII:function(e){if(""!==e){var t=e.split("endfacet").length-1;console.log("STLReader stl file content : ASCII ("+t+" faces)");Math.round(t/(100/this.percentBetweenEachProgressCB));var n=/vertex\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)/i,r=/facet\s+normal\s+([^\s]+)\s+([^\s]+)\s+([^\s]+)/i,o=e.split("\n");e="";for(var i=[],a=0,s=0,l=0;l<o.length;l++){var h,u=null;if(h=o[l].trim(),null!==(u=n.exec(h))){var c=parseFloat(u[1].replace(",",".")),p=parseFloat(u[2].replace(",",".")),d=parseFloat(u[3].replace(",","."));1===s&&(i.push(c),i.push(p),i.push(d),3===++a&&(this._ComputeNormal(i),a=0,s=0,i=null,i=[])),this.vertices.push(parseFloat(u[1].replace(",","."))),this.vertices.push(parseFloat(u[2].replace(",","."))),this.vertices.push(parseFloat(u[3].replace(",",".")))}else if(null!==(u=r.exec(h))){var m=parseFloat(u[1].replace(",",".")),g=parseFloat(u[2].replace(",",".")),f=parseFloat(u[3].replace(",","."));if(0===m&&0===g&&0===f&&(s=1),0===s)for(var D=0;D<3;D++)this.normals.push(m),this.normals.push(g),this.normals.push(f)}}o.length=0,o=null}},_parseBinary:function(e){var t=new DataView(e);e=null;var n=t.getUint32(80,!1),r=t.getUint32(80,!0),o=t.byteLength;o=.02*(o-84),r>0&&n<0?this._ReadLittleEndian(t,r):n>0&&r<0?nbSwat>o?this._ReadBigEndian(t,o):this._ReadBigEndian(t,n):r<=o&&o<n?this._ReadLittleEndian(t,r):n<=o&&o<=r?this._ReadBigEndian(t,n):r<=o&&o<=n?n<r?this._ReadLittleEndian(t,r):this._ReadBigEndian(t,n):o<r&&o<n?r<n?this._ReadLittleEndian(t,o):this._ReadBigEndian(t,o):console.log("Error !!!!!!!!")},_ReadLittleEndian:function(e,t){console.log("STLReader stl file content : BINARY ("+t+" faces)");t=Math.round(t);for(var n=Math.round(t/(100/this.percentBetweenEachProgressCB)),r=0+n,o=0;o<t;o++){var i=84+50*o,a=e.getFloat32(i,!0),s=e.getFloat32(i+4,!0),l=e.getFloat32(i+8,!0),h=0,u=[];0===a&&0===s&&0===l&&(h=1);for(var c=1;c<=3;c++){var p=i+12*c,d=e.getFloat32(p,!0),m=e.getFloat32(p+4,!0),g=e.getFloat32(p+8,!0);this.vertices.push(d),this.vertices.push(m),this.vertices.push(g),0===h?(this.normals.push(a),this.normals.push(s),this.normals.push(l)):(u.push(d),u.push(m),u.push(g)),3,4}1===h&&(this._ComputeNormal(u),h=0,u=null),this.normals.length/9===r&&(r+=n)}},_ReadBigEndian:function(e,t){console.log("STLReader stl file content : BINARY ("+t+" faces)");t=Math.round(t);for(var n=Math.round(t/(100/this.percentBetweenEachProgressCB)),r=0+n,o=0;o<t;o++){var i=84+50*o,a=e.getFloat32(i,!1),s=e.getFloat32(i+4,!1),l=e.getFloat32(i+8,!1),h=0,u=[];0===a&&0===s&&0===l&&(h=1);for(var c=1;c<=3;c++){var p=i+12*c;this.vertices.push(e.getFloat32(p,!1)),this.vertices.push(e.getFloat32(p+4,!1)),this.vertices.push(e.getFloat32(p+8,!1)),0===h?(this.normals.push(a),this.normals.push(s),this.normals.push(l)):(u.push(e.getFloat32(p,!1)),u.push(e.getFloat32(p+4,!1)),u.push(e.getFloat32(p+8,!1))),3,4}1===h&&(this._ComputeNormal(u),h=0,u=null),this.normals.length/9===r&&(r+=n)}},_ComputeNormal:function(e){var t=(new Date).getTime(),n=[],r=[];n[0]=e[3]-e[0],n[1]=e[4]-e[1],n[2]=e[5]-e[2],r[0]=e[6]-e[0],r[1]=e[7]-e[1],r[2]=e[8]-e[2];var o=n[1]*r[2]-n[2]*r[1],i=n[2]*r[0]-n[0]*r[2],a=n[0]*r[1]-n[1]*r[0],s=o*o+i*i+a*a,l=0;0!==s&&(l=1/Math.sqrt(s)),o*=l,i*=l,a*=l;for(var h=0;h<3;h++)this.normals.push(o),this.normals.push(i),this.normals.push(a);return n=null,r=null,(new Date).getTime()-t}})}));