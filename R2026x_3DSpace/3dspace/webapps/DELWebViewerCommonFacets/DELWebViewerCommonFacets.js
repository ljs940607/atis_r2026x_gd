define("DS/DELWebViewerCommonFacets/DELEditPropWidgetUtils",["DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/constants/ConstantsMapping","DS/EditPropWidget/factory/EditPropComponentFactory","DS/EditPropWidget/utils/EditPropUtils"],(function(e,t,n,r){"use strict";return{getEditPropConstants:function(){return e},getConstantsMapping:function(){return t},getEditPropComponentFactory:function(){return n},getEditPropUtils:function(){return r}}})),define("DS/DELWebViewerCommonFacets/Model/DELWkiInstructionsFacetModel",["UWA/Core","DS/DELWebViewerCommon/Webservice","text!DS/DELWebViewerCommon/assets/json/Webservices.json"],(function(e,t,n){"use strict";return function(){return{getData:async function(r){var a,i,o;return"businessobject"!==r.get("metatype")&&"bus"!==r.get("metatype")||(a=r.get("objectId"),i=await async function(r){var a=null,i=`${await t.get3DSpaceUrl()}/cvservlet/fetch/v2`,o={label:widget.getValue("appId")+"_WorkInstruction_Fetch_"+Date.now(),physicalid:[r],locale:"en",select_predicate:["taxonomies"]},s=await t.request({url:i,method:"POST",dataType:"json",payload:o}),c=Object.keys(JSON.parse(n).WorkInstructionsTypes);return s&&e.is(s.results,"array")&&s.results.forEach((t=>{if(e.is(t.attributes,"array"))for(let n of t.attributes)if("taxonomies"===n.name&&e.is(n.value)&&(a=c.find((e=>n.value.includes(e))),e.is(a)))break})),a}(a),o=await async function(e,r){var a,i,o=await t.get3DSpaceUrl(),s=JSON.parse(n).WorkInstructionsTypes;return s[r]&&(a=`${o}${s[r].url.replace("{ID}",e)}`,i=await t.request({url:a,method:"GET",dataType:"json"})),{response:i,type:r}}(a,i)),o},fetchRichTextFromFCSUrl:async function(e){return await t.request({url:e,method:"GET",dataType:"html"})}}}})),define("DS/DELWebViewerCommonFacets/View/WkiInstructionsFacetUI",["UWA/Core","css!DS/DELWebViewerCommonFacets/assets/css/WKIInstructionFacet.css"],(function(e){"use strict";return function(t){var n,r=t;return r&&!r.container&&(r.container=e.createElement("div",{id:"instructions-tab-container",class:"instructions-tab-container"})),{buildView:function(t){var a,i=t.indexOf("<body>"),o=t.indexOf("</body>");a=i>-1&&o>-1?t.slice(i+6,o):t||"",(n=e.createElement("div",{id:"rich-text-container",class:"rich-text-container"})).innerHTML=a,n.inject(r.container)},clean:function(){r&&r.container&&r.container.empty(),n&&n.empty()},destroy:function(){n&&n.destroy(),r&&r.container&&r.container.destroy()}}}})),define("DS/DELWebViewerCommonFacets/View/DataCollectMgmtUI",["UWA/Core","DS/DataGridView/DataGridView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","css!DS/DELWebViewerCommonFacets/assets/css/WKIInstructionFacet.css"],(function(e,t,n,r){"use strict";return function(a){var i,o,s=a||null,c={defaultColumnDef:{editableFlag:!1},rowSelection:"single",columnSelection:"none",cellSelection:"none"},l=new n;return s&&!s.container&&(s.container=e.createElement("div",{id:"instructions-tab-container",class:"instructions-tab-container"})),{buildView:function(n){o=e.createElement("div",{id:"dc-row-container",class:"dc-row-container"}).inject(s.container),l.prepareUpdate(),e.is(n.rows,"array")&&n.rows.forEach((e=>{var t=new r(e);l.addRoot(t)})),l.pushUpdate(),(i=new t(Object.assign({},c,n,{treeDocument:l}))).getContent().inject(o),i.layout.cellHeight=40},clean:function(){s&&s.container&&s.container.empty(),o&&o.empty(),l&&l.empty()},destroy:function(){l&&(l.empty(),l=null),o&&o.destroy(),i&&i.destroy(),s&&s.container&&s.container.destroy()}}}})),define("DS/DELWebViewerCommonFacets/Controllers/DataCollectRowColumnManager",["UWA/Core","UWA/Class","i18n!DS/DELWebViewerCommonFacets/assets/nls/DataCollect"],(function(e,t,n){"use strict";var r,a=function(){var t=function(t,n){let r;if(t&&(r=t.getAttributeValue(n),n.includes("."))){let[a,i]=n.split(".");e.is(t.getAttributeValue(a))&&(r=t.getAttributeValue(a)[i])}return r};return{getCellTypeRepresentation:function(n,r){var a,i;switch(r.isHeader&&(a="string"),e.is(r.nodeModel)&&(i=r.nodeModel),n){case"minValue.value":case"controlMinValue.value":case"controlMaxValue.value":case'maxValue.value"':a="number";break;case"possibleValues":a=e.is(t(i,"minValue.unit"))?"number":"string";break;case"minIncluded":case"controlMinIncluded":case"controlMaxIncluded":case"maxIncluded":a="boolean";break;case"created":case"modified":a="date";break;default:a="string"}return a},getCellValue:function(r,a,i){var o,s,c,l,u;switch(u=i.nodeModel,l=function(e){switch(e){case 1:return n.get("DataCollect.DCTypeReal.Title");case 2:return n.get("DataCollect.DCTypeInteger.Title");case 3:return n.get("DataCollect.DCTypeText.Title");case 4:return n.get("DataCollect.DCTypeBoolean.Title");case 5:return n.get("DataCollect.DCTypeTimestamp.Title");default:return""}},o=function(t){var n,r,a,i,o,s=e.is(t)?t:"";if(0===s.indexOf("<?xml")&&0<s.indexOf("<html")&&(i=s.indexOf("<body>"),o=s.indexOf("</body>"),i>-1&&o>-1)){for(s=(s=s.slice(i+6,o)).replaceAll("<br/>"," ");-1!==s.indexOf("<");)n=s.indexOf("<"),-1!==(r=s.indexOf(">",n)+1)&&(a=s.substring(n,r),s=s.replace(a,""));s=(s=(s=(s=s.replaceAll("&lt;","<")).replaceAll("&gt;",">")).replaceAll("&amp;","&")).replaceAll("&nbsp;"," ")}return s},c=function(n){var r,a="";if(e.is(n,"array"))for(let i of n)if(e.is(t(u,i))){r=t(u,i),e.is(r,"array")?r.forEach(((e,t)=>{a+=e+(t===r.length-1?"":"|")})):a=r;break}return a},r){case"text":s=o(t(u,r));break;case"dcType":s=l(t(u,r));break;case"possibleValues":s=c(a.dataValues);break;default:s=t(u,r)}return s}}};return e.is(r)||(r=new a),r})),define("DS/DELWebViewerCommonFacets/Controllers/DELWkiInstructionsFacetController",["UWA/Core","DS/DELWebViewerCommonFacets/View/DataCollectMgmtUI","DS/DELWebViewerCommonFacets/View/WkiInstructionsFacetUI","DS/DELWebViewerCommonFacets/Model/DELWkiInstructionsFacetModel","DS/DELWebViewerCommonFacets/Controllers/DataCollectRowColumnManager","text!DS/DELWebViewerCommonFacets/assets/json/DataCollectConfig.json","i18n!DS/DELWebViewerCommonFacets/assets/nls/DataCollect"],(function(e,t,n,r,a,i,o){"use strict";return function(s){const c="DELWkiDataCollectPlanReference",l="DELWkiDataCollectChecklistReference";var u={sortableFlag:!1,groupableFlag:!0,displayType:"NonEditable",visibleFlag:!0,width:"auto",minWidth:100,editionPolicy:"EditionOnClick",editableFlag:!1},d=new t(s.elements),m=new n(s.elements),f=new r,p=JSON.parse(i);return{createUI:function(t){f.getData(t).then((async function(t){var n,r;if(!t||t.type!==c&&t.type!==l){if(t&&t.response&&e.is(t.response.member,"array")&&t.response.member.length>0){const e=await async function(e){return e.text?e.text:e.richText?e.richText:e.richTextUrl?await f.fetchRichTextFromFCSUrl(e.richTextUrl):null}(t.response.member[0]);e&&m.buildView(e)}}else t&&t.type&&(n=function(t){var n,r=[];return p[t]&&(n=p[t].Columns,e.is(n,"array")&&n.forEach((e=>{var t={...u};t.dataIndex=e.dataIndex,t.text=o.get("DataCollect."+e.name+".Title"),t.getCellTypeRepresentation=a.getCellTypeRepresentation.bind(null,e.dataIndex),t.getCellValue=a.getCellValue.bind(null,e.dataIndex,e),r.push(t)}))),r}(t.type),r=function(t){var n=[];return t&&e.is(t.member,"array")&&t.member.forEach((e=>{var t={referenceId:e.id?e.id:"",type:e.type?e.type:"",label:e.label?e.label:"",grid:{...e}};n.push(t)})),n}(t.response),d.buildView({columns:n,rows:r}))}))},clean:function(){d.clean(),m.clean()},destroy:function(){d.destroy(),m.destroy()}}}})),define("DS/DELWebViewerCommonFacets/Controllers/DELWkiInstructionsFacet",["UWA/Core","UWA/Controls/Abstract","UWA/Class","DS/EditPropWidget/facets/Common/FacetsBase","DS/DELWebViewerCommonFacets/Controllers/DELWkiInstructionsFacetController"],(function(e,t,n,r,a){"use strict";return n.extend(t,r,{init:function(e){this._parent(e),this._instructionFacetController=new a({elements:this.elements})},updateFacet:function(){this._instructionFacetController.clean(),this._instructionFacetController.createUI(this.getModel())},destroyComponent:function(){this._instructionFacetController.destroy()},onRefresh:function(){this.updateFacet()},show:function(){this.getUI().show()},hide:function(){this.getUI().hide()}})}));