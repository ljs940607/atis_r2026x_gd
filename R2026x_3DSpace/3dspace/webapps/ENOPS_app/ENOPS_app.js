/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
function ENOPS_app(e){"use strict";var t,i="ap_root_pids",n="ap__root_pids_detached",o="ap_struct",s="xsceneStoredObjects",a=!0;function r(e){return"string"==typeof e?JSON.parse(e):null}function l(e,t,i,n){e.section.actions.push({id:n.id,title:n.title,icon:n.icon});let o="ENXViews/WelcomePanel/action/"+n.id;t.subscriptions.push(i.subscribe({event:o},t._launchCmd.bind(t)))}function d(e,t,i,n){let o=new Promise((function(o,s){Promise.all(e).then((function(){n()?require([i],(function(e){e.isAdditionalColumnsAvailable((function(i){!0===i&&t.push(e),o()}))}),(function(){o()})):o()}))}));o.name="Add "+i,e.push(o)}var c=function(e){return UWA.is(e,"string")&&(e=e.replace(/"label":"((\\"|[^"])*)",/gi,"")),e},u=function(e){var t=!1;return UWA.is(e,"boolean")?t=e:UWA.is(e,"string")&&(t="true"===e.toLowerCase()),t},p={v1:{ap_custo:"ap_custo",ap_custoParams:"ap_custoParams",ap_struct:s}},g=function(e){if(self.widget.isDeEnabled){var t=require("DS/PADServices/views/private/AppStructure"),i=t.retrieveData(s);t.addDesignEnv(i,e.designEnvIds),t.addOpenDesignEnv(i,e.designEnvIds),t.persistData(s,i),require("DS/PADServices/utils/GlobalModelEvents").getModelEvents().publish({event:"ENXViews/WelcomePanel/openedObject",data:{kind:"designEnv",designEnv:e.designEnvIds,designExpDetails:e.designExpDetails}})}};var v={widget:null,pad_app:null,setting_names:p.v1,xnav_component_opts:{x3dAppId:null,widget:null,active_view:null,action_bar_opts:null,configuration:{toolbarActivated:!1,toolbarOpts:{definition:"ENOPS_app/assets/configuration/pseToolbar.json"},dynamicCtxActivated:!1,ctxMenuOpts:{definition:"ENOPS_app/assets/configuration/pseCtxMenu.json"},commands:{definition:"ENOPS_app/assets/configuration/pseCmds.json"}},layout:{title_update:!0,view_customization:null,store_roots_in_pref:!0,slidder:!1,root_panel:!0,padshell:!1,withWelcomePanel:!0},settings:null,insert_replace:!0,authorize_setStructure:!0,authorizeChangeControl:!1,amd_custo:{}},configuration:void 0,subscriptions:[],init:function(e){this.pcsPrefix=widget.id+"_"+widget.title,window.top.performance.mark(this.pcsPrefix+"_init"),window.top.performance.measure(this.pcsPrefix+"_call_init","enops_app_load_html",this.pcsPrefix+"_init"),e.odt_settings&&(this._odt_settings=e.odt_settings),this.flags={},this.widget=e.widget,this.configuration=e.configuration,this.widget.addEvent("onLoad",this.onLoad.bind(this)),this.widget.addEvent("onRefresh",this.onRefresh.bind(this))},onRefresh:function(){let e=this;window.top.performance.mark(this.pcsPrefix+"_onload"),window.top.performance.measure(this.pcsPrefix+"_call_onload",this.pcsPrefix+"_init",this.pcsPrefix+"_onload"),this.widget.setValue("tenantAware",!0);let t=function(){e.pad_app&&e.pad_app.refresh()};this.flags.onPlatformIdChange?(delete this.flags.onPlatformIdChange,this._waitingRefresh&&this._waitingRefresh.then((function(e){e&&e.skipRefresh||t()}))):t()},_mePrefPSERepoUpdate:function(e){let t=this;console.log(e),require(["DS/ENOPS_app/tools/MePrefsIntegration"],(function(i){i.partialUpdateApply({json:e,original:t._interpretedMePrefs,widget:widget,appPtr:t})}))},_mePrefDERepoUpdate:function(e){console.log(e)},onLoad:function(){var e=this;null!==this.xnav_component&&void 0!==this.xnav_component||require(["DS/ENOXInterWdgCom/LinkManager","DS/PADUtils/PADSettingsMgt","DS/PADServices/utils/GlobalUtils","DS/ENOPS_app/tools/MePrefsIntegration","text!DS/ENOPS_app/assets/enops_settings.json"],((i,n,o,s,a)=>{function r(s){(e.widget.isDeEnabled=!(!s&&"true"!=o.getURLParameter("enableDesignExp")),e.widget.isDeEnabled)&&(require("DS/PADServices/utils/PADTrackerManager").addCommandHit("DGX-InitializePSEWithDEOption"),e.widget.isCowEnabled="true"==o.getURLParameter("enableDesignExpCOW"),e.widget.isVDRPEnabled="true"==o.getURLParameter("enableDesignExpVDRP"));var r=e.widget.isDeEnabled?function(e){let i=e.padsettings.enops.run_options;return i.type_kind.value.DesignEnv=["ENOExpDesignExperience"],i.authorized_root_types.value.push("ENOExpDesignExperience"),i.autoload_items={value:!0,preference:{type:"boolean",label:"autoload_items_label"},dispatch:!0},e.view_settings.defaultAttributes.unshift({name:"asset-type"}),t=e,e}(JSON.parse(a)):JSON.parse(a);e._odt_settings&&(r.padsettings=UWA.extend(r.padsettings,e._odt_settings,!0)),n.setApp(r.padsettings,"enops",!0),e.widget.isDeEnabled&&(e.widget.authorized_DE_types=r.padsettings.enops.run_options.type_kind.value.DesignEnv),!0===n.getSetting("activateWidgetLink")?i.initializeWidgetLink(widget,n.getSetting("widgetLink_options")).then((()=>{e._init()})):e._init()}s.retrieveAndHook({hooks:{repos:{ProductStructureEditorRepository:e._mePrefPSERepoUpdate.bind(e),DesignExperienceRespository:e._mePrefDERepoUpdate.bind(e)}},settings:[{Repository:"ProductStructureEditorRepository",PreferenceNames:["DEFAULT_TABLE_VIEWS","TABLE_VIEWS","TABLE_DENSITY"]},{Repository:"DesignExperienceRespository",PreferenceNames:["is_design_experience_enabled"]}]}).then((t=>{e._interpretedMePrefs=t,r(t.isDesignEnv)})).catch((t=>{delete e._interpretedMePrefs,r(!1)}))}))},_init:function(){var e=this;window.top.performance.mark(this.pcsPrefix+"_onload"),window.top.performance.measure(this.pcsPrefix+"_call_onload",this.pcsPrefix+"_init",this.pcsPrefix+"_onload"),this.widget.setValue("tenantAware",!0),require(["DS/PADUtils/Configuration","DS/PADServices/utils/GlobalUtils","text!DS/ENOPS_app/assets/ProductStructureConf.json","css!DS/ENOPS_app/ENOPS_app.css"],(function(i,n,o,s){var r,l=e.widget.isDeEnabled?((r=JSON.parse(o)).settings.columnViews.value.unshift({dataIndex:"asset-type",AMD:"DS/ENXNav/views/private/externalColumnsViews/designExpColumn"}),r.columnsCusto.order.unshift("asset-type"),r.columnsCusto.attributes.unshift({dataIndex:"asset-type"}),r):JSON.parse(o);i.mergeConfig(l),e.configuration&&i.mergeConfig(e.configuration),a=i.getConfig("activateWP"),require(["DS/PADUtils/PADWSAccess","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADSharedSettings","DS/PADUtils/PADUtilsServices","DS/PADServices/utils/AttributesMgt","UWA/Core","DS/PADUtils/PADSession","DS/PADServices/utils/WaitingPromise","DS/PADServices/utils/GlobalModelEvents","DS/PADServices/utils/ZipUtils","DS/WebUAUtils/WebUAUtils","DS/ENOPS_app/tools/MePrefsIntegration","text!DS/ENOPS_app/assets/enops_settings.json"],(function(o,s,r,d,g,v,f,m,h,w,P,_,S){if(window.top.performance.mark(e.pcsPrefix+"_require_infra_padutils"),window.top.performance.measure(e.pcsPrefix+"_require_infra",e.pcsPrefix+"_onload",e.pcsPrefix+"_require_infra_padutils"),!e.widget.getValue("x3dSharedId")&&!e.widget.getValue("x3dAppId")){e.widget.addPreference({name:"x3dAppId",type:"hidden",defaultValue:"ENOPAD_appId"})}P.setAppid("ENOPSTE_AP");var D,A=e.widget.isDeEnabled?t:JSON.parse(S);e._odt_settings&&(A.padsettings=UWA.extend(A.padsettings,e._odt_settings,!0)),s.setApp(A.padsettings,"enops",!0),function(e,t){return"true"===e.getURLParameter(t)}(n,"activateMePref")&&s.setSetting("activateMePref",!0),s.getSetting("activateMePref")&&((D=A).action_bar.standard.file="ENOPS_MePrefs.xml",D.action_bar.standard.module="ENOPS_app",D.action_bar.standardCloud.file="ENOPS_MePrefs.xml",D.action_bar.standardCloud.module="ENOPS_app"),_.applyAndClean({modules:{PADSettingsMgt:s,ZipUtils:w},interpretedMePrefs:e._interpretedMePrefs,appPtr:e,widget:widget,preferenceName:[]}),r.addSharedSettings(e.widget,["x3dPlatformId","showWelcomePanel","autoreload","pad_security_ctx","useIndexAccleration","synthesisModeOnInstance","addRemoveMessagePreference","displayConfirmationOnRemove","pgpFromServer","staticMappingEnabled","authoringFilterEnabled","authoringFilterEnabledForMultiRoot","selectOnInsertDisabled"]),e.widget.mergePreferences(s.getWidgetPreferences()),e.widget.addEvent("endEdit",s.updateWidgetPreferences.bind(s)),e.widget.addEvent("onPlatformIdChange",(function(t){e.flags.onPlatformIdChange=!0,e._waitingRefresh=new m})),h.subscribe({event:"ENXApp/tenantDialog/complete"},(function(t){e._waitingRefresh&&e._waitingRefresh.resolve(t)})),e.widget.addEvent("onChangeControlUpdate",(function(t,i){var n="bottom-right";n=sessionStorage.getItem("changeControlPosition")?sessionStorage.getItem("changeControlPosition"):s.getSetting("changeControlPosition");var o=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");if(!1===i){try{o.hide()}catch(e){console.log(e)}e.widget.addPreference({name:"changeControlPosition",type:"hidden",defaultValue:n})}else{try{o.show()}catch(e){console.log(e)}e.widget.addPreference({name:"changeControlPosition",defaultValue:n,type:"list",label:"changeControlPosition_label",options:[{label:"bottom-right_label",value:"bottom-right"},{label:"bottom-left_label",value:"bottom-left"},{label:"top-right_label",value:"top-right"}]})}e.widget.dispatchEvent("onEdit")})),f.softInit(),s.updateWidgetPreferences(),!0===s.getSetting("activateFUN078214")&&e.widget.addEvent("onSearch",e.onSearch.bind(e));var b=e._initializePADComponent_v2.bind(e);if(e.setting_names=p.v1,null===e.pad_app){var E=e.xnav_component_opts;E.x3dAppId=e.widget.getValue("x3dAppId"),E.widget=e.widget,E.lang=e.widget.lang,E.active_view=e.widget.getValue("default_view")?e.widget.getValue("default_view"):"treelistview",s.getSetting("activateMePref")&&(E.mePrefTableCusto=e._interpretedMePrefs.massageForAttrMgt(),e._appCustoObj?E.activeTableView=e._appCustoObj.currentTableView:E.activeTableView=E.mePrefTableCusto.default.ENO2D_VIEW_NAME),E.settings=A,!0===d.isCloud()&&(E.settings.action_bar.standard=E.settings.action_bar.standardCloud,E.settings.action_bar.touch=E.settings.action_bar.touchCloud),!1===a&&(E.settings.action_bar.standard.file=E.settings.action_bar.standard.file.replace(".xml","_NO_WP.xml"),E.settings.action_bar.touch.file=E.settings.action_bar.touch.file.replace(".xml","_NO_WP.xml")),function(e,t,i){e[t.flag]=i.getSetting(t.setting)}(E,{flag:"isPlmNew",setting:"plmnew"},s),E.layout.root_panel=!1,E.layout.padshell=!0,E.layout.propertiesFacet=s.getSetting("propertiesFacet"),!0===s.getSetting("activateDropInviteWithFilter")&&(E.layout.drop_invite="inviteWithFilter"),!0===s.getSetting("authorizeChangeControl")&&(E.authorizeChangeControl=!0,void 0!==e.widget.getValue("changeControlActivation")&&s.setSetting("changeControlActivation",e.widget.getBool("changeControlActivation"))),!0===s.getSetting("activateDGV")&&(E.layout.amdTreeView="datagridview",E.amd_custo.DataGridView="DS/ENOPAD_v2/views/PADDataGridView","treelistview"===E.active_view&&(E.active_view="datagridview")),!0===s.getSetting("activateTXO")&&!0===i.getConfig("WSAccessV2")&&g.updateAttributesList(l.columnsCusto),E.configuration.toolbarActivated=!0===u(n.getURLParameter("activateToolbar")),E.configuration.dynamicCtxActivated=!0!==u(n.getURLParameter("NoCtxEvo"))&&!0!==s.getSetting("FUN103639-NoCtxEvo");var C,y,V=e.widget.getValue(e.setting_names.ap_custoParams);V&&g.updateSelectedParams(JSON.parse(V)),e._migrate_settings();var x=s.getSetting("resetCustomization");if(!x){"null"===(C=e.widget.getValue(e.setting_names.ap_custo))&&(C=null);try{C=w.jsonUnzip(C),(C=c(C))&&(y=JSON.parse(C))}catch(e){x=!0}}s.getSetting("activateMePref")||x||C&&"{"!==C.charAt(0)&&!1===C.startsWith("ZIP:")?(localStorage.removeItem("PADTreeListDefinition."+E.x3dAppId+"_"+widget.getValue("x3dPlatformId")),b(E)):y?(E.layout.view_customization=y,b(E)):d.app_initialization((function(t){t&&t.success?o.getMyAppsTemplate({preference_name:E.x3dAppId+"-"+d.getPlatformId(),onComplete:function(e){var t=null;try{e.length>0&&(e.startsWith("ZIP:")&&(e=w.jsonUnzip(e)),"{"===(e=c(e)).charAt(0)&&(t=JSON.parse(e)).selectedExtensions&&t.selectedTypes&&(g.updateSelectedParams({selectedExtensions:t.selectedExtensions,selectedTypes:t.selectedTypes}),delete t.selectedExtensions,delete t.selectedTypes))}catch(e){}E.layout.view_customization=t,b(E)},onFailure:function(e){b(E)}}):e._initialize_failure()}))}}))}));try{require(["DS/MSFDocumentManagement/WidgetIntegration"],(function(e){widget.MSFDocumentClient=e,widget.MSFDocumentClient.ConnectWidgetWithMSF()}))}catch(e){console.log(e)}},onDestroy:function(){this.pad_app.destroy(),this.pad_app=null;for(var e=require("DS/PADServices/utils/GlobalModelEvents").getModelEvents(),t=0;t<this.subscriptions.length;t++){var i=this.subscriptions[t];e.unsubscribe(i)}for(this.welcome.destroy(),this.welcome=null;this.elements.mainBody.firstChild;)this.elements.mainBody.removeChild(this.elements.mainBody.firstChild);this.elements.mainBody.parentNode&&this.elements.mainBody.parentNode.removeChild(this.elements.mainBody),delete this.elements.mainBody,require("DS/PADUtils/PADSharedSettings").destroy()},_migrate_settings:function(){var e=this.widget.getValue(i),t=this.widget.getValue(n),a=this.widget.getValue(o),l=r(e),d=r(t),c=r(a),u=!1,p={products:{},filters:{}};if(c)for(var g=Object.keys(c),v=0;v<g.length;v++){var f=g[v];if(!p.products[f]){p.products[f]={};c[f];u=!0}}if(l)for(var m=0;m<l.length;m++){var h=l[m];d&&-1!==d.indexOf(h)&&(p.id2detach||(p.id2detach=[]),p.id2detach.push(h)),p.products[h]={},u=!0}u&&this.widget.setValue(s,JSON.stringify(p)),this.widget.deleteValue(i),this.widget.deleteValue(n),this.widget.deleteValue(o),this.widget.deleteValue("saved_filter_ids")},_initializePADComponent_v2:function(e){var t=this;window.top.performance.mark(t.pcsPrefix+"_require_padcomponent_before"),require(["DS/PADServices/views/ENXWelcomePanel","DS/PADServices/utils/GlobalModelEvents","DS/PADServices/utils/GlobalUtils","DS/PADUtils/Configuration","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADProbes","DS/PADUtils/PADSettingsMgt","DS/PADServices/views/private/AppStructure","i18n!DS/ENOPS_app/assets/nls/ENOPS_app","DS/PADServices/utils/Storage","i18n!DS/PADServices/assets/nls/PADServices","DS/UIKIT/Mask"],(function(i,n,o,r,c,p,v,f,m,h,w,P){f.setWidget(t.widget),c.app_initialization((function(){t._buildDOM(),P.mask(t.elements.mainBody,w.welcomePanel.appLoading);var c=n.getModelEvents(),p=t.widget.getValue(t.setting_names.ap_struct);"null"===p&&(p=null),o.getURLParameter("cleanSetting")===t.setting_names.ap_struct?(t.widget.deleteValue(t.setting_names.ap_struct),p={products:{},filters:{}},t.widget.isDeEnabled&&(p.designEnv={})):UWA.is(p,"string")?(p=JSON.parse(p),t.widget.isDeEnabled||(delete p.designEnv,delete p.wasOpenDesignEnv)):(p={products:{},filters:{}},t.widget.isDeEnabled&&(p.designEnv={}));var f=v.getSetting("pad_security_ctx");f?o.setSecurityContext(f):v.addEvent("onPad_security_ctx",(function(e){o.setSecurityContext(e)}));var h=u(widget.getValue("showWelcomePanel")),_=u(widget.getValue("autoreload"))||!1===a,S=t.widget.getValue("X3DContentId"),D=null!=S,A=void 0,b={modelEvents:c,storedObjects:p,readOnlyApp:r.getConfig("readOnlyApp"),wpActivated:a,autoreload:_,structKey:s},E=i.getDefaultActivities();b.defaultActionId=E.defaultActionId;let C={section:{id:"newActivitySection",title:w.welcomePanel.newActivity,actions:[]}};const y=[{id:e.isPlmNew?"ENONewProductHdr":"ActionBar_NewProductCmd",title:m.newProduct,icon:"3dproduct-add"},{id:e.isPlmNew?"ENONewPartHdr":"ActionBar_NewPartCmd",title:m.newPart,icon:"3dpart-add"},{id:e.isPlmNew?"ENONewDrawingHdr":"ActionBar_NewDrawingCmd",title:m.newDrawing,icon:"drawing-add"}];for(let e=0;e<y.length;e++){l(C,t,c,y[e])}E.activities.push(C),t.widget.isDeEnabled&&(E.activities&&E.activities.length>1&&(E.activities[1].section.actions.push({id:"DesignExpCreateCmd",title:m.newDE,icon:"design-experience-add"}),t.subscriptions.push(c.subscribe({event:"ENXViews/WelcomePanel/action/DesignExpCreateCmd"},t._launchCmd.bind(t)))),b.isDeEnabled=t.widget.isDeEnabled,b.authorized_DE_types=t.widget.authorized_DE_types),n.subscribe({event:"ENXModel/DesignEnv/addToRecents"},(function(e){g(e)})),b.activities=E.activities,t.welcome=new i(b),t.welcome.initialize().then((function(){if(!0===h){!1!==_||D||(P.unmask(t.elements.mainBody),t._setActiveView(t.activeBody,t.welcome));var e=require("DS/PADServices/views/private/AppStructure");e.cleanupWasOpens(s);let n=e.retrieveData(s);var i=e.buildReloadList(n);_&&!1===i.hasLoad&&(P.unmask(t.elements.mainBody),t._setActiveView(t.activeBody,t.welcome))}})),_&&(A=p),require(["DS/ENOPAD_v2/PADComponent","DS/PADUtils/PADSettingsMgt"],(function(i,n){var s=[],a=[],r=new Promise((function(e){Promise.all(a).then((function(){if(!0!==n.getSetting("removeCfgColumns")){require(["DS/CfgWebAppEffectivityUX/scripts/CfgEffectivityColumns"],(function(t){t.isAdditionalColumnsAvailable((function(i){!0===i&&s.push(t),e()})),r.name="Add "+t.getName()}),(function(){e()}))}else e()}))}));a.push(r);var l=new Promise((function(e){Promise.all(a).then((function(){if(!0!==n.getSetting("removeCfgColumns")){require(["DS/CfgWebAppEffectivityUX/scripts/CfgConfigurationRevisionColumn"],(function(t){t.isAdditionalColumnsAvailable((function(i){!0===i&&s.push(t),e()})),l.name="Add "+t.getName()}),(function(){e()}))}else e()}))}));a.push(l);var c=new Promise((function(e){Promise.all(a).then((function(){if(!0!==n.getSetting("removeCfgColumns")){require(["DS/CfgWebAppEffectivityUX/scripts/CfgConfigurationContextColumn"],(function(t){t.isAdditionalColumnsAvailable((function(i){!0===i&&s.push(t),e()})),c.name="Add "+t.getName()}),(function(){e()}))}else e()}))}));a.push(c),d(a,s,"DS/CfgWebAppEffectivityUX/scripts/CfgProductConfigurationColumn",(function(){return!0!==n.getSetting("removeCfgColumns")}));var p=new Promise((function(e){Promise.all(a).then((function(){if(!0===n.getSetting("Activate_relationsColumns")){require(["DS/ENORIPE_RelationsColumns/RelationsColumns"],(function(t){t.isAdditionalColumnsAvailable((function(i){!0===i&&(s.push(t),t.setPreferenceProxy()),e()})),p.name="Add "+t.getName()}),(function(){e()}))}else e()}))}));a.push(p),d(a,s,"DS/ENOXCADSynchroStatus/AdditionalColumns",(function(){return!0===n.getSetting("activateXCADSyncStatus")})),d(a,s,"DS/ENOXCADMultiDisciplineApplicativeSemantic/AdditionalColumns",(function(){return!0===n.getSetting("activateXCADMultiDisciplineApplicativeSemantic")})),d(a,s,"DS/ENODOGridColumn/AdditionalColumns",(function(){return!0===n.getSetting("activateDOStatus")}));var g=new Promise((function(r){Promise.all(a).then((function(){!function(s){window.top.performance.mark(t.pcsPrefix+"_require_padcomponent_done"),window.top.performance.measure(t.pcsPrefix+"_require_padcomponent",t.pcsPrefix+"_require_padcomponent_before",t.pcsPrefix+"_require_padcomponent_done");var a=t._retrieveinitializationOpts(),r=UWA.extend(e,a);if(A&&(r.objects2Load=A),s.length&&(r.additionalColumnsModules=s),n.getSetting("modelOcc")||"true"===o.getURLParameter("modelOcc")?(n.setSetting("explorerOcc",!0),n.setSetting("activateExcludeOccurrences",!1),r.amd_custo.TreeDocument="DS/ENOPAD_v2/models/PADDocOcc"):(n.setSetting("explorerOcc",!1),r.amd_custo.TreeDocument="DS/ENOPAD_v2/models/PADDocTree"),!0!==u(o.getURLParameter("enableReadOnly"))&&r.layout.view_customization&&r.layout.view_customization.columnsOptimized){var l=r.layout.view_customization.columnsOptimized.findIndex((({dataIndex:e})=>"read_write"===e));-1!=l&&r.layout.view_customization.columnsOptimized.splice(l,1)}t.widget.isDeEnabled&&(r.isDeEnabled=t.widget.isDeEnabled,r.authorized_DE_types=t.widget.authorized_DE_types),t.xnav_component=new i(r)}(s),r()}))}));g.name="Launch real initialization",a.push(g)}))}))}))},_initialize_failure:function(){var e=this;require(["css!DS/ENXNav/ENXNav","DS/ENXNav/views/xNavInitError","i18n!DS/ENXNav/assets/nls/ENXNav.json"],(function(t,i,n){e.elements||e._buildDOM();var o=e.elements.fakeContainer=UWA.createElement("div",{class:"xnav_component"}),s=new i({msg:n.initialization_error});o.setContent(s),e._setActiveView("failure",e.elements.fakeContainer),e.widget.dispatchEvent("onENOPADReady",e)}))},_processContentID:function(e){var t=this,i=t.widget.getValue("X3DContentId"),n=UWA.is(i,"string")?JSON.parse(i):i;n.source&&["ENOTASK_AP","ENOTASP_AP"].includes(n.source)&&n.data&&n.data.items.length>0&&n.data.items[0].path&&n.data.items[0].objectId&&delete n.data.items[0].path,require(["DS/PADUtils/PADTypesMgt","DS/PADUtils/PADUtilsServices","DS/ENXNav/utils/xNavKindProcessor"],(function(i,o,s){i.retrieveAuthorizedObjects({version:"2.0",X3DContentId:n,callback:function(i){var n=i.authorized_objects[0].envId;o.updatePlatformId(n),s.loadKinds(t.xnav_component,i,"fromx3dContentId",!1,e&&e.callback?e.callback:void 0),-1===t.widget.id.indexOf("preview")&&t.widget.deleteValue("X3DContentId")}})}))},_retrieveinitializationOpts:function(){var e=this;return{events:{onReady:function(t){if(require("DS/UIKIT/Mask").unmask(e.elements.mainBody),window.top.performance.mark(e.pcsPrefix+"_padcomponent_onready"),window.top.performance.measure(e.pcsPrefix+"_padcomponent_ready",e.pcsPrefix+"_require_padcomponent_done",e.pcsPrefix+"_padcomponent_onready"),t.error)return e._setActiveView("app",e.xnav_component),void e.widget.dispatchEvent("onENOPADReady",e);e.pad_app=this;var i=e.widget.getValue("X3DContentId"),n=require("DS/PADServices/utils/GlobalModelEvents");e.widget.id.startsWith("preview-")&&i&&e.widget.deleteValue("autoreloadPreview"),UWA.is(i)&&e._processContentID({callback:function(){e.xnav_component.getRoots().length>0&&(u(widget.getValue("showWelcomePanel"))&&(e._preLoadTs=Date.now()),n.subscribeOnce({event:"ENXViews/WelcomePanel/loadData"},(function(e){n.publish({event:"ENXViews/WelcomePanel/closeLandingPage"})})))}});var o=require("DS/PADUtils/PADSettingsMgt");require("DS/PADServices/ws/WSAccess");let s=Promise.resolve();s=new Promise(((t,i)=>{require(["DS/PADServices/utils/ConfigurationCache","DS/PADServices/utils/GrantedRolesCache","DS/PADServices/utils/PermissionRulesCache"],(function(i,n,s){i.setup({settingsArray:["StaticMappingActivation","xRevisionActivation"]});let a=[];n.setup({}),a.push(i.initialize()),a.push(n.initialize()),a.push(s.initialize()),Promise.allSettled(a).then((function(n){let a=n.map(((e,t)=>({isFail:"rejected"===e.status,isSuccess:"fulfilled"===e.status,index:t}))).filter((e=>!0===e.isFail));for(let e=0;e<a.length;e++){0===a[e].index&&console.error("Configuration settings not retrieved for StaticMapping and xRevActivation. Behaviour will be disabled.")}if(o.setSetting("lockControlByAdmin",s.isEnabled()[1]),o.setSetting("maturityControlByAdmin",s.isEnabled()[0]),!0===o.getSetting("activateFUN153004")&&o.getSetting("lockControlByAdmin")&&e.widget.addPreference({name:"inheritReferenceLock",type:"boolean",label:"inheritReferenceLock_label",defaultValue:!1,dispatch:!0}),!0===o.getSetting("activate_FUN141510")&&(e.widget.addPreference({name:"maturityStateAtContentCreation",type:"boolean",label:"maturityStatusAtContentCreation_Label",defaultValue:!1,dispatch:!0}),o.getSetting("lockControlByAdmin"))){e.widget.addPreference({name:"lockStatusAtContentCreation",type:"boolean",label:"lockStatusAtContentCreation_Label",onchange:"onLockStatusAtContentCreation",defaultValue:!1,dispatch:!0});const t={name:"lockStatusLabels",defaultValue:"0",type:"list",label:"lockStatusLabel",options:[{label:"lockedLabel",value:"1"},{label:"unlockedLabel",value:"0"}]};if(e.widget.hasPreference("lockStatusAtContentCreation")){!1===e.widget.getValue("lockStatusAtContentCreation")&&(t.disabled="true"),e.widget.addPreference(t)}}!0===o.getSetting("activateFUN131228")&&(i.isEnabled("StaticMappingActivation")?(o.setSetting("staticMappingServer","enabled"),e.widget.addPreference({name:"enableProdConfig",type:"boolean",defaultValue:!0}),o.setSetting("enableProdConfig",e.widget.getBool("enableProdConfig")),o.setSetting("xRevisionActivation",i._enableMap.get("xRevisionActivation")),o.setSetting("staticMappingEnabled",e.widget.getBool("enableProdConfig")),e.widget.addEvent("endEdit",(function(t){o.setSetting("staticMappingEnabled",e.widget.getBool("enableProdConfig"))}))):(o.setSetting("staticMappingServer","disabled"),o.setSetting("enableProdConfig",!1),o.setSetting("staticMappingEnabled",!1),o.setSetting("xRevisionActivation",!1),e.widget.addPreference({name:"enableProdConfig",type:"hidden",defaultValue:!1}))),t()}))}))})),s.then((()=>{function i(){var t=e.widget.getPreference("dnd"),i=t?t.value:"MOVE";e.pad_app.setDnDBehavior(i)}function s(){var t=!1;void 0!==e.widget.getPreference("confirmationDialog")&&(t=e.widget.getBool("confirmationDialog")),e.pad_app.setConfirmdDialog(t)}!0===o.getSetting("activateFUN134214")&&(o.setSetting("authoringFilterEnabled",e.widget.getBool("keepFilterAuthoring")),e.widget.addEvent("endEdit",(function(t){o.setSetting("authoringFilterEnabled",e.widget.getBool("keepFilterAuthoring"))}))),!0===o.getSetting("activateFUN160073")&&(o.setSetting("selectOnInsertDisabled",e.widget.getBool("disableSelectionOnInsert")),e.widget.addEvent("endEdit",(function(t){o.setSetting("selectOnInsertDisabled",e.widget.getBool("disableSelectionOnInsert"))}))),!0===o.getSetting("multiRootFilterAuthoring")&&o.setSetting("authoringFilterEnabledForMultiRoot",!0),i(),s(),e.widget.addEvent("onViewChange",e.pad_app.onResize.bind(e.pad_app)),e.widget.addEvent("onResize",e.pad_app.onResize.bind(e.pad_app)),e.pad_app.addEvent("onToggleView",(function(t){e.widget.setValue("default_view",t)}));var r=n.getModelEvents();if(e.subscriptions.push(r.subscribe({event:"ENXViews/Views/showInWidgetBody"},(function(t){t.html?(t.title&&widget.setTitle(t.title),e._setActiveView(t.idView,t.html)):!0===t.restore&&(widget.setTitle(e.xnav_component.getWidgetTitle()),"welcome"===e.previousBody?!0===a?e._setActiveView("welcome",e.welcome):e._setActiveView("app",e.xnav_component):"app"!==e.previousBody&&"app"!==t.idView||e._setActiveView("app",e.xnav_component))}))),e.widget.addEvent("endEdit",i),e.widget.addEvent("endEdit",s),require("DS/PADUtils/PADSharedSettings").resetDebounceFlags(),e.xnav_component.addEvent("onToggleView",(function(t){e.widget.setValue("default_view",t)})),!1===a&&t&&t.addInView&&e._setActiveView("app",e.xnav_component),t&&!0===t.error&&e._initialize_failure(),!0===a){if(e.subscriptions.push(r.subscribe({event:"ENXViews/WelcomePanel/openContent"},(function(t){switch(e._setActiveView("app",e.xnav_component),t.mode){case"welcome":if(e.welcome._currentLoadRequest){if(UWA.equals(e.welcome._currentLoadRequest,t))return void e.welcome.setCurrentLoadRequest(null)}else e.welcome.setCurrentLoadRequest(t);e.xnav_component.openStoredObjects(t).then((function(){e.welcome.setCurrentLoadRequest(null)}));break;case"drop":e.xnav_component.openDroppedObjects(t).then((function(t){if(t&&t.error){require("DS/PADUtils/PADSettingsMgt").getSetting("welcomeonempty")&&!0===a&&e._setActiveView("welcome",e.welcome)}}));break;default:console.error("Unknown mode")}}))),e.subscriptions.push(r.subscribe({event:"ENXViews/WelcomePanel/removeFromStored"},(function(t){if(t.item2remove){var i=t.item2remove,n=[],o=e.widget.getValue(e.setting_names.ap_struct);if("null"===o&&(o=null),UWA.is(o,"string")){o=JSON.parse(o);var s,a,r=i.length,l=!1;for(s=0;s<r;s++){if(o.products&&o.products.hasOwnProperty(i[s]))(u=e.xnav_component.options.model.searchRootById(i[s]))&&n.push(i[s]),delete o.products[i[s]],l=!0;if(o.designEnv&&o.designEnv.hasOwnProperty(i[s]))(u=e.xnav_component.options.model.searchRootById(i[s]))&&n.push(i[s]),delete o.designEnv[i[s]],l=!0;if(o.filters){var d=Object.getOwnPropertyNames(o.filters);for(a=d.length-1;a>=0;a--){var c,u;if(o.filters[d[a]].associatedProduct===i[s]?c=i[s]:d[a]===i[s]&&(c=o.filters[d[a]].associatedProduct),c)(u=e.xnav_component.options.model.searchRootById(c))&&(e.xnav_component.options.model.removeRoot(u),n.push(d[a])),delete o.filters[d[a]],l=!0}}}if(require("DS/PADServices/views/private/AppStructure").removeOpen(o,i).length&&(l=!0),l&&widget.setValue(e.setting_names.ap_struct,JSON.stringify(o)),n.length){var p=require("DS/PADServices/utils/GlobalModelEvents").getModelEvents();p.publish({event:"ENXViews/WelcomePanel/openedObject",data:{kind:"deleteRoots",removeIds:n}}),p.publish({event:"ENXViews/WelcomePanel/removeFromView",data:{item2remove:n}})}}}}))),e.subscriptions.push(r.subscribe({event:"ENXViews/WelcomePanel/activate"},(function(t){r.publish({event:"ENXViews/WelcomePanel/refreshView"}),"fromHome"===t&&(e.welcome.fromHome=!0),e._preLoadTs?(Date.now()-e._preLoadTs<=2e5||e._setActiveView("welcome",e.welcome),delete e._preLoadTs):e._setActiveView("welcome",e.welcome)}))),e.subscriptions.push(r.subscribe({event:"ENXViews/WelcomePanel/closeLandingPage"},(function(){e._setActiveView("app",e.xnav_component)}))),e.subscriptions.push(r.subscribe({event:"ENXViews/WelcomePanel/unselectAllInModel"},(function(){e.xnav_component.getPADTreeDocument().unselectAll()}))),e.subscriptions.push(r.subscribe({event:"ENXViews/WelcomePanel/removeFromView"},(function(t){if(!t.fromWLSync){var i=t.item2remove,n=i?i.length:0,o=e.xnav_component.getPADTreeDocument();o.withTransactionUpdate((function(){for(var e=0;e<n;e++){var t=o.searchRootById(i[e]);t&&o.removeRoot(t)}}))}}))),e.appReady=!0,r.publish({event:"ENXViews/WelcomePanel/appReady"}),e.launchActions&&e.launchActions.length){for(var l=0;l<e.launchActions.length;l++)e._launchAction(e.launchActions[l]);e.launchActions=[]}}else e._setActiveView("app",e.xnav_component);window.top.performance.mark(e.pcsPrefix+"_app_load_complete"),window.top.performance.measure(e.pcsPrefix+"_app_load_completed","enops_app_load_html",e.pcsPrefix+"_app_load_complete"),e.widget.dispatchEvent("onENOPADReady",e),!1===u(widget.getValue("showWelcomePanel"))&&e._setActiveView("app",e.xnav_component),n.publish({event:"ENXViews/WelcomePanel/loadData"})}))},onAddDesignEnv:function(e){g(e)},onAddPaths:function(t){var i=require("DS/PADServices/views/private/AppStructure"),n=i.retrieveData(s);t.addedPaths&&e.widget.isDeEnabled&&this.hasActiveDesignExp()&&this.getPseService().isDesignExpLoading&&this.getPseService().checkBeforeAddingToRecent(t),i.addProductPath(n,t.addedPaths),i.addOpenProduct(n,t.addedPaths),i.persistData(s,n);var o=require("DS/PADServices/utils/GlobalModelEvents").getModelEvents();o.publish({event:"ENXViews/WelcomePanel/openedObject",data:{kind:"products",addedPaths:t.addedPaths}}),o.publish({event:"ENXViews/WelcomePanel/closeLandingPage"})},onAddFilters:function(t){var i=require("DS/PADServices/views/private/AppStructure"),n=i.retrieveData(s);if(a){for(var o={filters:{},filters2Ignore:[]},r=0;r<t.filterIds.length;r++)e.widget.isDeEnabled&&this.hasActiveDesignExp()&&this.getPseService().isDesignExpLoading?this.getPseService().shouldAddFilterToRecent(t.filterIds[r])?(i.addFilter(n,t.filterIds[r],t.rootIds[r]),i.addOpenFilter(n,[t.filterIds[r]])):o.filters2Ignore.push(t.filterIds[r]):(i.addFilter(n,t.filterIds[r],t.rootIds[r]),i.addOpenFilter(n,[t.filterIds[r]])),o.filters[t.filterIds[r]]={associatedProduct:t.rootIds[r],filterName:t.filterNames[r]};var l=require("DS/PADServices/utils/GlobalModelEvents").getModelEvents();l.publish({event:"ENXViews/WelcomePanel/openedObject",data:{kind:"filters",addedFilters:o}}),l.publish({event:"ENXViews/WelcomePanel/closeLandingPage"})}else for(r=0;r<t.rootIds.length;r++)void 0===n.products[t.rootIds[r]]&&(n.products[t.rootIds[r]]={});widget.setValue(e.setting_names.ap_struct,JSON.stringify(n))},onDeleteRoots:function(e){var t=JSON.parse(e.str_removeIds),i=require("DS/PADServices/views/private/AppStructure"),n=i.retrieveData(s),o=i.removeOpen(n,t);i.persistData(s,n);var a=require("DS/PADServices/utils/GlobalModelEvents");a.publish({event:"ENXViews/WelcomePanel/openedObject",data:{kind:"removeFromView",removedFromViewIds:o,fromWLSync:e.fromWLSync}}),e.fromWLSync||a.publish({event:"ENXViews/Model/remove"}),this?.options?.isDeEnabled&&this?.hasActiveDesignExp()&&!this.getRoots().length&&this.getPseService().applyDefaultSort()},onEmptyView:function(){},onCustoViewChange:function(t,i){var n=require("DS/PADServices/utils/ZipUtils").jsonZip(JSON.stringify(t));if(e.widget.setValue(e.setting_names.ap_custo,n),i&&e.widget.setValue(e.setting_names.ap_custoParams,JSON.stringify(i)),e.pad_app&&e.pad_app.options){var o=e.pad_app.options.views.datagridview;o&&(o.columnOrdering=!0)}},onSaveAsTemplate:function(t){t&&t.selectedExtensions&&t.selectedTypes&&e.widget.setValue(e.setting_names.ap_custoParams,JSON.stringify({selectedExtensions:t.selectedExtensions,selectedTypes:t.selectedTypes}));var i=require("DS/PADServices/utils/ZipUtils").jsonZip(JSON.stringify(t));e.widget.setValue(e.setting_names.ap_custo,i),require(["DS/PADUtils/PADUtilsServices","DS/PADUtils/PADWSAccess"],(function(e,t){t.saveMyAppsTemplate({preference_name:widget.getValue("x3dAppId")+"-"+e.getPlatformId(),value:i,onComplete:function(e){},onFailure:function(e){}})}))},onAuthoringCtxAvailable:function(t){var i="DS/PlatformAPI/PlatformAPI",n="DS/PADServices/utils/ZipUtils";require([i,n],(function(i,n){i.subscribe(t.validKey,(function(t){var i=n.jsonZip(JSON.stringify(t));e.widget.setValue("WorkUnderConfigData",i),e.widget.setValue("isWorkUnderWIP",!0)})),i.subscribe("toggleActiveCA"+t.validKey,(function(t){e.widget.setValue("isWorkUnderWIP",!0)})),i.subscribe("toggleDeActiveCA"+t.validKey,(function(t){e.widget.setValue("isWorkUnderWIP",!1)})),i.subscribe("removeAuthCtxEvent"+t.validKey,(function(t){e.widget.setValue("isWorkUnderWIP",!1),e.widget.setValue("WorkUnderConfigData","")})),i.subscribe("sessionEff",(function(i){if(i.PACID===t.validKey){var o=n.jsonZip(JSON.stringify(l.getEvolutionFromAuthoringContext()));e.widget.setValue("WorkUnderConfigData",o),e.widget.setValue("isWorkUnderWIP",!0)}})),i.subscribe("removeAuthCtxSessionEvent"+t.validKey,(function(t){e.widget.setValue("isWorkUnderWIP",!1),e.widget.setValue("WorkUnderConfigData","")})),i.subscribe("toggleActiveSE"+t.validKey,(function(t){e.widget.setValue("isWorkUnderWIP",!0)})),i.subscribe("toggleDeActiveSE"+t.validKey,(function(t){e.widget.setValue("isWorkUnderWIP",!1)}))}));var o=require("DS/PADUtils/PADSettingsMgt"),s=require("DS/PADUtils/PADCommandProxy");e.debouncePrefSynchro=!1,e._proxy=s.create({events:{onPreferenceModification:function(t,i){"changeControlActivation"===t.name&&(e.debouncePrefSynchro=!0,o.setSetting(t.name,t.value,!0))}}}),e.widget.addEvent("endEdit",(function(t){let i=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"),n=o.getSetting("changeControlPosition");if(t&&!1===t.submitted){var s="bottom-right";s=sessionStorage.getItem("changeControlPosition")?sessionStorage.getItem("changeControlPosition"):o.getSetting("changeControlPosition"),!1===e.widget.getBool("changeControlActivation")?(i.hide(),e.widget.addPreference({name:"changeControlPosition",type:"hidden",defaultValue:s})):(i.show(),e.widget.addPreference({name:"changeControlPosition",defaultValue:s,type:"list",label:"changeControlPosition_label",options:[{label:"bottom-right_label",value:"bottom-right"},{label:"bottom-left_label",value:"bottom-left"},{label:"top-right_label",value:"top-right"}]}))}else n!==sessionStorage.getItem("changeControlPosition")&&(i.setPosition(n),sessionStorage.setItem("changeControlPosition",n))}));var a=o.getSetting("changeControlActivation");a=void 0!==e.widget.getValue("changeControlActivation")?e.widget.getBool("changeControlActivation"):t.isAuthoringContextVisible;var r="bottom-right";r=sessionStorage.getItem("changeControlPosition")?sessionStorage.getItem("changeControlPosition"):o.getSetting("changeControlPosition");var l=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");if(l.setPosition(r),e.widget.addPreference({name:"changeControlActivation",defaultValue:a,type:"boolean",label:"changeControlActivation_label",onchange:"onChangeControlUpdate"}),!0===a){if(!0===e.widget.getValue("isWorkUnderWIP")&&""!==e.widget.getValue("WorkUnderConfigData")){n="DS/PADServices/utils/ZipUtils",i="DS/PlatformAPI/PlatformAPI";var d=this;require([n,"DS/PADUtils/views/PADAlert",i,"i18n!DS/ENOPS_app/assets/nls/ENOPS_app"],(function(t,i,n,o){var s=t.jsonUnzip(e.widget.getValue("WorkUnderConfigData"));s=JSON.parse(s),l.set(s,(function(e){d._commandProxy.setCfgContextFrom2d(s),i.displayNotification({eventID:"warning",msg:o.loadWorkUnder})}))}))}else e.widget.setValue("isWorkUnderWIP",!1),e.widget.setValue("WorkUnderConfigData","");l.show(),e.widget.addPreference({name:"changeControlPosition",defaultValue:r,type:"list",label:"changeControlPosition_label",options:[{label:"bottom-right_label",value:"bottom-right"},{label:"bottom-left_label",value:"bottom-left"},{label:"top-right_label",value:"top-right"}]})}else l.hide(),e.widget.addPreference({name:"changeControlPosition",type:"hidden",defaultValue:r});o.addEvent("onChangeControlActivation",e._onChangeControlActivation.bind(e)),l.addEvent&&l.addEvent("onAuthoringCtxVisible",(function(t){o.setSetting("changeControlActivation",t.showAuthoringContext,!0),e._onChangeControlActivation(t.showAuthoringContext)})),o.addEvent("onChangeControlPosition",(function(e){require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext").setPosition(e),sessionStorage.setItem("changeControlPosition",e)}))},onTenantChange:function(t){e.welcome.tenantChange(),require(["DS/PADUtils/PADUtilsServices","DS/PADUtils/PADWSAccess","DS/PADServices/utils/AttributesMgtV2","DS/PADServices/utils/ZipUtils"],(function(i,n,o,s){n.getMyAppsTemplate({preference_name:e.widget.getValue("x3dAppId")+"-"+i.getPlatformId(),onComplete:function(e){var i=null;e.length>0&&(e=s.jsonUnzip(e),(i=JSON.parse(e)).selectedExtensions&&i.selectedTypes&&(o.updateSelectedParams({selectedExtensions:i.selectedExtensions,selectedTypes:i.selectedTypes}),delete i.selectedExtensions,delete i.selectedTypes)),t.updateTreeView(i)},onFailure:function(e){t.updateTreeView()}})}))}}}},onSearch:function(e){this.xnav_component&&this.xnav_component.onSearch({query:e})},_onChangeControlActivation:function(e){var t=this,i=require("DS/PADUtils/PADSettingsMgt"),n=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext");t.debouncePrefSynchro?t.debouncePrefSynchro=!1:t._proxy.preferenceModification({name:"changeControlActivation",value:e});var o="bottom-right";o=sessionStorage.getItem("changeControlPosition")?sessionStorage.getItem("changeControlPosition"):i.getSetting("changeControlPosition"),n.setPosition(o),!0===e?(n.show(),t.widget.addPreference({name:"changeControlPosition",defaultValue:o,type:"list",label:"changeControlPosition_label",options:[{label:"top-right_label",value:"top-right"},{label:"top-left_label",value:"top-left"},{label:"bottom-right_label",value:"bottom-right"},{label:"bottom-left_label",value:"bottom-left"}]})):(n.hide(),t.widget.addPreference({name:"changeControlPosition",type:"hidden",defaultValue:o}))},_buildDOM:function(){if(!this.elements){this.elements={};var e=this.elements.mainBody=UWA.createElement("div");this.elements.mainBody.classList.add("pse-root"),this.elements.mainBody.classList.add("enx-appMainBody"),this.elements.mainBody.style.position="absolute",this.elements.mainBody.style.height="100%",this.elements.mainBody.style.width="100%",self.widget.setBody(e)}},_setActiveView:function(e,t){var i;(this.initDiv||(this.initDiv={}),void 0===e&&(e="default-"+Date.now()),this.previousBody=this.activeBody,this.activeBody=e,!0!==this.initDiv[e])&&(this.elements[e]||(this.elements[e]=document.createElement("div"),this.elements[e].classList.add("pse-"+e),this.elements[e].classList.add("pse-div"),this.elements.mainBody.appendChild(this.elements[e])),"function"==typeof t.render?(i=t.render(),this.initDiv[e]=!0):i=t,this.elements[e].appendChild(i));this._showActiveView(e)},_showActiveView:function(e){for(var t=Object.keys(this.elements),i=0;i<t.length;i++)e===t[i]?this.elements[t[i]].classList.remove("pse-hidden"):"mainBody"!==t[i]&&this.elements[t[i]].classList.add("pse-hidden");window.dispatchEvent(new Event("resize"))},_launchCmd:function(e){var t=require("DS/PADServices/utils/GlobalModelEvents").getModelEvents();!0===this.appReady?this._launchAction({commandHdr:e.id}):(t.publish({event:"ENXViews/WelcomePanel/maskWP"}),this.launchActions||(this.launchActions=[]),this.launchActions.push({commandHdr:e.id}))},_launchAction:function(e){if(void 0!==e.AMD)require([e.AMD],(function(t){t.executeAction(e)}));else{require("DS/PADServices/utils/GlobalModelEvents").getModelEvents().publish({event:"ENXViews/WelcomePanel/setAction",data:"previousContent"});var t=this;require(["DS/ApplicationFrame/CommandsManager"],(function(i){var n=i.getCommand(e.commandHdr);n&&(t.xnav_component.getPADTreeDocument().unselectAll(),"DesignExpCreateCmd"===e.commandHdr&&(self.widget.deCreationFromWP=!0),n.isEnabled()&&(n.begin(),n.disable(),n.onEnd((()=>{n.enable()}))))}))}}};return v.init(e),v}define("DS/ENOPS_app/tools/EnopsMePrefInterpret",[],(function(){"use strict";function e(e,t,i,n,o){let s=i.getSetting(e,t);s&&(n[o]=s.value)}function t(e){this.options=e,this._props={},this._interpret()}return t.prototype={_interpret:function(){let t=this.options.parsed;e("DesignExperienceRespository","is_design_experience_enabled",t,this._props,"isDesignEnv"),t.hasRepo("ProductStructureEditorRepository")&&(e("ProductStructureEditorRepository","DEFAULT_TABLE_VIEWS",t,this._props,"defaultTableViews"),e("ProductStructureEditorRepository","TABLE_VIEWS",t,this._props,"tableViews"),e("ProductStructureEditorRepository","TABLE_DENSITY",t,this._props,"tableDensity"))},merge:function(e){e.tableViews&&(this._props.tableViews=e.tableViews),e.defaultTableViews&&(this._props.defaultTableViews=e.defaultTableViews),e.tableDensity&&(this._props.tableDensity=e.tableDensity)},massageForAttrMgt:function(){return{default:window.structuredClone(this.defaultTableViews.ENO2D_VIEWS[0]),views:window.structuredClone(this.tableViews.ENO2D_VIEWS),TABLE_DENSITY:this.tableDensity}}},Object.defineProperties(t.prototype,{isDesignEnv:{get:function(){return this._props.isDesignEnv}},tableDensity:{get:function(){return this._props.tableDensity}},defaultTableViews:{get:function(){return this._props.defaultTableViews}},tableViews:{get:function(){return this._props.tableViews}}}),t})),define("DS/ENOPS_app/tools/CustomViewSetting",["DS/PADServices/utils/ZipUtils"],(function(e){"use strict";const t="editorCustomView";function i(e){this.options=e,this._value=void 0,this._load()}return i.prototype={_load(){let i,n=this.options.widget.getValue(t);if("null"===n&&(n=null),n)try{let t=e.jsonUnzip(n);"string"==typeof(o=t)&&(o=o.replace(/"label":"((\\"|[^"])*)",/gi,"")),t=o,t&&(i=JSON.parse(t),this._value=i)}catch(e){this._value=void 0}var o},save(){let i=this._value,n=e.jsonZip(JSON.stringify(i));this.options.widget.setValue(t,n)}},Object.defineProperties(i.prototype,{value:{get:function(){return this._value},set:function(e){this._value=e}}}),i})),define("DS/ENOPS_app/tools/MePrefsIntegration",["DS/PADServices/utils/MePrefsAssist","DS/PADServices/utils/AttributesMgtV2","DS/PADServices/utils/GlobalModelEvents","DS/ENOXParser/modules/GenericMePrefParser","DS/ENOPS_app/tools/EnopsMePrefInterpret","DS/ENOPS_app/tools/CustomViewSetting"],(function(e,t,i,n,o,s){"use strict";function a(){this.options={}}let r;return a.prototype={retrieveAndHook:function(t){return i.subscribe({event:"App/Editor/saveView"},this._saveView.bind(this)),i.subscribe({event:"App/Editor/requestView"},this._requestView.bind(this)),new Promise(((i,s)=>{e.hookForUpdates(t.hooks),e.getSettings(t.settings).then((e=>{let t=new n(e),s=new o({parsed:t});i(s)})).catch(s)}))},partialUpdateApply:function(e){let t=new n(e.json),s=new o({parsed:t,isPartial:!0});e.original.merge(s),e.widget.setValue("editorCustoV2",null);let a=e.original.massageForAttrMgt(),r="ENO2D_DEFAULT";if(e.appPtr.xnav_component){e.appPtr.xnav_component.options.mePrefTableCusto=a;let t=e.appPtr.xnav_component.active_table_view;t&&(r=t)}i.publish({event:"DS/ENXViews/SwitchTableView",data:{view:r,updateActiveView:!0}})},applyAndClean:function(e){const n=e.modules.PADSettingsMgt,o=(e.modules.ZipUtils,e.interpretedMePrefs),a=e.widget,r=e.appPtr;if(this.options.widget=a,o&&n.getSetting("activateMePref")){let e,n=o.massageForAttrMgt(),l=a.getValue("Editor_Active_TableView"),d=new s({widget:a});e=d.value;let c="ENO2D_DEFAULT";e&&(e=d.value,e.currentTableView&&(e.currentTableView!==l?e=void 0:(c=e.currentTableView,r._appCustoObj=e))),t.initializeFromMePrefEditor({mePrefsData:n,custoView:e,activeView:c}).then((function(){})),a.addEventOnce("onENOPADReady",(function(){i.publish({event:"ENXViews/DatagridView/changeDensity",data:{layoutDensity:o.tableDensity}})}))}},_saveView:function(e){let t=new s({widget:this.options.widget});t.value=e,t.save()},_requestView:function(e){let t=new s({widget:this.options.widget});i.publish({event:"App/Editor/requestView/response",data:t.value})}},r||(r=new a)}));